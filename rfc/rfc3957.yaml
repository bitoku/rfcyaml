- contents:
  - "          Authentication, Authorization, and Accounting (AAA)\n                   Registration
    Keys for Mobile IPv4\n"
  title: __initial_text__
- contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol
    for the\n   Internet community, and requests discussion and suggestions for\n
    \  improvements.  Please refer to the current edition of the \"Internet\n   Official
    Protocol Standards\" (STD 1) for the standardization state\n   and status of this
    protocol.  Distribution of this memo is unlimited.\n"
  title: Status of this Memo
- contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2005).\n"
  title: Copyright Notice
- contents:
  - "Abstract\n   Authentication, Authorization, and Accounting (AAA) servers, such
    as\n   RADIUS and DIAMETER, are in use within the Internet today to provide\n
    \  authentication and authorization services for dial-up computers.\n   Mobile
    IP for IPv4 requires strong authentication between the mobile\n   node and its
    home agent.  When the mobile node shares an AAA Security\n   Association with
    its home AAA server, however, it is possible to use\n   that AAA Security Association
    to create derived Mobility Security\n   Associations between the mobile node and
    its home agent, and again\n   between the mobile node and the foreign agent currently
    offering\n   connectivity to the mobile node.  This document specifies extensions\n
    \  to Mobile IP registration messages that can be used to create\n   Mobility
    Security Associations between the mobile node and its home\n   agent, and/or between
    the mobile node and a foreign agent.\n"
  title: Abstract
- contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .
    . . . . . .  2\n   2.  Terminology. . . . . . . . . . . . . . . . . . . . . .
    . . . .  4\n   3.  Overview of Operations with Key Generation Nonce Extensions.
    .  5\n   4.  Mobility Security Associations . . . . . . . . . . . . . . . .  7\n
    \  5.  Key Generation Nonce Creation and Key Derivation . . . . . . .  8\n   6.
    \ Key Generation Extensions. . . . . . . . . . . . . . . . . . .  9\n       6.1.
    \ Generalized MN-FA Key Generation Nonce Request Extension 10\n       6.2.  Generalized
    MN-FA Key Generation Nonce Reply Extension . 11\n       6.3.  Generalized MN-HA
    Key Generation Nonce Request Extension 13\n       6.4.  Generalized MN-HA Key
    Generation Nonce Reply Extension . 14\n   7.  Error Values . . . . . . . . . .
    . . . . . . . . . . . . . . . 16\n   8.  IANA Considerations. . . . . . . . .
    . . . . . . . . . . . . . 16\n   9.  Security Considerations. . . . . . . . .
    . . . . . . . . . . . 17\n   10. Acknowledgements . . . . . . . . . . . . . .
    . . . . . . . . . 18\n   11. References . . . . . . . . . . . . . . . . . . .
    . . . . . . . 18\n       11.1. Normative References . . . . . . . . . . . . .
    . . . . . 18\n       11.2. Informative References . . . . . . . . . . . . . .
    . . . 19\n   Appendices . . . . . . . . . . . . . . . . . . . . . . . . . . .
    . 20\n       A. AAA Infrastructure. . . . . . . . . . . . . . . . . . . . . 20\n
    \      B. Message Flow for Requesting and Receiving Registration Keys 24\n   Authors'
    Addresses . . . . . . . . . . . . . . . . . . . . . . . . 26\n   Full Copyright
    Statement . . . . . . . . . . . . . . . . . . . . . 27\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   AAA servers, such as RADIUS [11] and DIAMETER [12], are
    in use within\n   the Internet today to provide authentication and authorization\n
    \  services for dial-up computers.  Such services are likely to be\n   valuable
    for mobile nodes using Mobile IP for IPv4 [1], when the\n   nodes are attempting
    to connect to foreign domains with AAA servers.\n   In this document Mobile IP
    for IPv4 is called \"Mobile IPv4\" or just\n   \"Mobile IP\" for short, since
    no confusion with other versions is\n   expected.  Requirements for interactions
    between AAA and Mobile IP\n   are outlined in RFC 2977 [13]; that document describes
    an\n   infrastructure which enables AAA servers to authenticate and\n   authorize
    network access requests from mobile nodes.  See also\n   appendix A.  The Mobile
    IP Registration Request is considered to be a\n   request for network access.
    \ It is then possible to augment the\n   functionality of the Mobile IP mobility
    agents so that they can\n   translate between Mobile IP registration messages
    and the messages\n   used within the AAA infrastructure, as described in RFC 2977.\n
    \  Mobility agents and AAA servers that conform to the requirements of\n   RFC
    2977 can be considered as appropriate network entities to support\n   the message
    types specified in this document.  Please consult RFC\n   2977 [13] for further
    details.\n   This specification makes use of a single AAA Security Association
    to\n   create derivative Mobility Security Associations.  A Mobility\n   Security
    Association in this specification is a simplex connection\n   that serves to authenticate
    MIPv4 control traffic between a MN and HA\n   and/or a MN and FA.  A Mobility
    Security Association is identified by\n   the two end points, such as a MN IP
    address and a HA IP address, and\n   a SPI.  Two nodes may have one or more Mobility
    Security Associations\n   established between each other; however, typically there
    is no reason\n   to have more than one Mobility Security Association between two\n
    \  nodes.\n   This document specifies extensions to Mobile IP registration messages\n
    \  that can be used to create Mobility Security Associations between the\n   MN
    and FA and/or MN and HA based on the AAA Security Association\n   between the
    MN and AAA server.  These new Mobility Security\n   Associations may then be used
    to calculate the Authentication Data\n   needed by authentication extensions used
    in Mobile IP control\n   messages.\n   It is assumed that the security association
    between the mobile node\n   and its AAA server has been appropriately configured
    so that the AAA\n   server can provide key material to be used as the basis for
    the\n   necessary Mobility Security Association(s) between the mobile node\n   and
    its prospective mobility agents.\n   AAA servers typically use the Network Access
    Identifier (NAI) [2] to\n   uniquely identify the mobile node; the mobile node's
    home address is\n   not always necessary to provide that function.  Thus, it is
    possible\n   for a mobile node to authenticate itself, and be authorized for\n
    \  connection to the foreign domain, without having any home address.\n   However,
    for Mobile IP to work, the mobile node is required to have a\n   home address
    and a Mobility Security Association [1] with its home\n   agent.  When the Mobile
    IP Registration Reply packet is authenticated\n   by the MN-AAA Authentication
    Extension [3], the mobile node can\n   verify that the key material contained
    in the extensions were\n   produced by the AAA server, and thus may be reliably
    used to create\n   Mobility Security Associations with the home agent and/or the
    foreign\n   agent.\n   It is also assumed that the AAA entities involved (i.e.,
    the AAAH,\n   AAAL, and the AAA interface features of the foreign agents and home\n
    \  agents) all have means outside of the scope of this document for\n   exchanging
    keys.  The extensions within this document are intended to\n   work with any AAA
    protocol suite that allows for such key exchange,\n   as long as it satisfies
    the requirements specified in RFC 2977 [13].\n   One such AAA protocol is defined
    within the Diameter framework [14].\n"
  title: 1.  Introduction
- contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\",
    \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\"
    in this\n   document are to be interpreted as described in [4].\n   AAA           Authentication,
    Authorization, and Accounting (see\n                 [10]).\n   AAA entity    A
    network node processing AAA messages according to the\n                 requirements
    for AAA protocols (see [10]).\n   AAA Security Association\n                 A
    security association between a AAA entity and another\n                 node needing
    the services of that AAA entity.  In this\n                 document all AAA Security
    Associations are between a\n                 mobile node and its home AAA server
    (AAAH).  A mobile\n                 node's AAA Security Association with its home
    AAA\n                 server (AAAH) may be based either on the mobile node's\n
    \                IP address or on its NAI [2].  The key is referred to\n                 as
    \"AAA-key\" in this specification.\n   Key           A number, kept secret.  Only
    nodes in possession of the\n                 key have any hope of using the security
    transform to\n                 obtain correct results.\n   Key Generation Nonce\n
    \                Nonce data used for the purpose of creating a key.\n   Mobility
    Security Association\n                 A Mobility Security Association is a simplex
    connection\n                 that applies security services to RFC 3344 MIPv4\n
    \                control traffic between a MN and HA (or MN and FA)\n                 using
    RFC 3344 Authentication Extensions.  A Mobility\n                 Security Association
    is uniquely identified by the peer\n                 source and destination IP
    addresses and an SPI.  Two\n                 nodes may have one or more Mobility
    Security\n                 Associations; however, typically there is no reason
    to\n                 have more than one Mobility Security Association\n                 between
    two nodes, except as a transient condition\n                 during re-keying
    events.\n   Registration Key\n                 A key used in the MN-FA or MN-HA
    Mobility Security\n                 Association.  A registration key is typically
    only used\n                 once or a very few times, and only for the purposes
    of\n                 verifying a small volume of Authentication data.\n   Security
    Algorithm\n                 A set of rules for using input data and a secret key\n
    \                for producing data for use in security protocols.\n   SPI           Security
    Parameters Index.  The SPI is an arbitrary\n                 32-bit value that
    assists in the identification of an\n                 AAA, IP, or Mobility Security
    Association.\n   Other terminology is used as defined in the base Mobile IP\n
    \  specification [1].  Furthermore, in order to simplify the discussion,\n   we
    have used the word \"Extension\" instead of \"Subtype of the\n   Generalized Extension\"
    in many cases.  So, for instance, instead of\n   using the phrase \"The MN-FA
    Key Generation Nonce From AAA Subtype of\n   the Generalized MN-FA Key Generation
    Nonce Reply Extension\", we would\n   instead use the phrase \"The MN-FA Key Generation
    Nonce From AAA\n   Extension\".\n"
  title: 2.  Terminology
- contents:
  - "3.  Overview of Operations with Key Generation Nonce Extensions\n   When a mobile
    node depends on an AAA infrastructure to obtain\n   authorization for network
    connectivity and Mobile IP registration, it\n   may lack any pre-existing Mobility
    Security Associations with either\n   its home agent, or the foreign agent controlling
    the access to the\n   foreign network.  The extensions defined in this document
    allow a AAA\n   entity to supply key material to mobile nodes to be used as the
    basis\n   of its Mobility Security Association with mobile agents.  The AAA\n
    \  entity that will act on these extensions is part of the AAA\n   infrastructure,
    and is typically identified within the foreign domain\n   by methods outside the
    scope of this specification (see appendix A).\n   The key material may be requested
    by the mobile node in new\n   extensions (defined below) to Mobile IP Registration
    Request\n   messages, and supplied to the mobile node in extensions to the Mobile\n
    \  IP Registration Reply messages.  Alternatively, the AAA server MAY\n   provide
    unsolicited key material via mobility agents to mobile nodes;\n   the mobile node
    MUST then calculate new keys and update or create its\n   relevant Mobility Security
    Association.  The method by which key\n   material is supplied to the mobility
    agents themselves is out of\n   scope for this document, and would depend on the
    particular details\n   of the security architecture for the AAA servers in the
    foreign and\n   home domains (see RFC 2977 and appendix A).  For the purposes
    of this\n   document, we assume that there is a suitable AAA infrastructure\n
    \  available to the home and foreign agents, and that the mobile node\n   does
    have an AAA Security Association with at least one AAA server in\n   its home
    domain.\n   When a mobile node travels away from home, it may not have a Mobility\n
    \  Security Association with its home agent, perhaps because it does not\n   yet
    have a home address [5].  The protocol and messages in this\n   document are intended
    to facilitate the following operations which\n   may occur between the mobile
    node, foreign agent, home agent, and AAA\n   servers in the visited (local) domain
    (Authentication, Authorization\n   and Accounting Local or AAAL) and in the home
    domain (Authentication,\n   Authorization, and Accounting Home or AAAH).  In the
    following\n   sequence of messages, the only message flows specified in this\n
    \  document are the Registration Request between the mobile node and the\n   foreign
    agent, and Registration Reply between the foreign agent and\n   the mobile node.
    \ The other messages described here result from the\n   presumed action of the
    AAA entities as described in RFC 2977.  See\n   also appendix B.\n   1.  If the
    mobile node does not have a Mobility Security Association\n       with the foreign
    agent, it SHOULD include an MN-FA Key Generation\n       Nonce Request extension
    (see Section 6.1) as part of its\n       Registration Request that it sends to
    the Foreign Agent.\n   2.  If the mobile node does not have a Mobility Security
    Association\n       with the home agent, it MUST add an MN-HA Key Generation Nonce\n
    \      Request extension (see Section 6.3) as part of its Registration\n       Request
    that it sends to the Foreign Agent.\n   3.  If one or more AAA Key Generation
    Nonce Request extensions were\n       added, the mobile node MUST add the MN-AAA
    Authentication\n       extension to its Registration Request.\n   4.  By action
    of the foreign agent, which is presumed to be also a\n       AAA entity, the mobile
    node's key requests and authentication\n       data are transferred to the local
    AAA server (AAAL), typically\n       after reformatting to fit into the appropriate
    AAA messages,\n       which are out of scope for this document.\n   5.  After
    the information within the MN-AAA Authentication extension\n       is verified
    by the AAA server in the home domain (AAAH), it then\n       also generates the
    key material that has been requested by the\n       mobile node, for the necessary
    Mobility Security Associations.\n   6.  The respective keys for the Mobility Security
    Associations are\n       distributed to the Home Agent and Foreign Agent via the
    AAA\n       protocol.\n   7.  The mobile node receives the Registration Reply
    message from the\n       Foreign Agent.\n   8.  If a MN-HA Key Generation Nonce
    Request From AAA extension is\n       present in the Registration Request message,
    then the mobile node\n       MUST create or update its Mobility Security Association
    with the\n       Home Agent indicated in the corresponding Registration Reply,\n
    \      using the key computed from the key material in the MN-HA Key\n       Generation
    Nonce From AAA extension.  In this case, if no MN-HA\n       Key Generation Nonce
    Reply extension is present, the mobile node\n       MUST discard the Registration
    Reply.\n   9.  Using its (perhaps newly created) Mobility Security Association\n
    \      with the home agent, the mobile node authenticates the\n       Registration
    Reply message by checking the Authentication Data in\n       the Mobile-Home Authentication
    extension.  If the check fails,\n       the MN MUST discard the Registration Reply
    and the new Mobility\n       Security Association, reverting to the old Mobility
    Security\n       Association with the home agent, if any.\n   10. If the Registration
    Reply passes authentication and contains a\n       MN-FA Key Generation Nonce
    From AAA extension (see section 6.2),\n       the mobile node generates the registration
    key using the Key\n       Generation Nonce provided, according to its AAA Security\n
    \      Association with the AAA.  The resulting registration key is used\n       to
    establish the mobile node's Mobility Security Association with\n       its foreign
    agent, and is used to compute the authentication data\n       used in the Mobile-Foreign
    authentication extension.\n       If verification of the Mobile-Foreign authentication
    extension\n       fails, and if the MN-FA Key Generation Nonce Reply extension
    was\n       not protected by another, valid authentication extension, the MN\n
    \      MUST discard the new Mobility Security Association, reverting to\n       the
    old Mobility Security Association with the foreign agent, if\n       any.\n   Any
    registration reply containing the MN-HA Key Generation Nonce From\n   AAA extension
    MUST also contain a subsequent Mobile Home\n   Authentication extension, created
    using the generated MN-HA key.\n   Similarly, a reply containing the MN-FA Key
    Generation Nonce From AAA\n   extension MUST also contain a subsequent Mobile
    Foreign\n   Authentication extension, created using the registration key.\n"
  title: 3.  Overview of Operations with Key Generation Nonce Extensions
- contents:
  - "4.  Mobility Security Associations\n   Mobility Security Associations between
    Mobile IP entities (mobile\n   nodes, home agents, foreign agents) contain both
    the necessary\n   cryptographic key information and a way to identify the cryptographic\n
    \  transform that uses the key to produce the authentication information\n   that
    is present in the Mobile-Home Authentication extension or the\n   Mobile-Foreign
    Authentication extension.  In order for the mobile\n   node to make use of key
    material created by the AAA server, the\n   mobile node also has to be able to
    identify and select the\n   appropriate cryptographic transform that uses the
    key to produce the\n   authentication.\n   The transform identifiers are the same
    as those used in IPsec.  They\n   are tabulated in the list of Authentication
    Algorithms allowable as\n   values for the \"Attribute Type\" (5) (i.e., \"Authentication\n
    \  Algorithm\"), one of the classifications in the tabulated Attribute\n   Types
    for \"IPsec Security Association Attributes\".  See\n   http://www.iana.org/assignments/isakmp-registry
    for the full listing\n   of all Attribute Types and other Attributes for IPsec
    Security\n   Associations.\n   Mobility Security Associations shared between mobile
    nodes and home\n   agents also require a replay protection method.  The following
    table\n   contains the supported replay detection methods.\n      Replay Method
    \      Name           Reference\n      --------------    ------------   --------------\n
    \     0,1               Reserved\n      2                 Timestamps       RFC
    3344 [1]\n      3                 Nonces           RFC 3344 [1]\n      4-65535
    \          Unallocated\n"
  title: 4.  Mobility Security Associations
- contents:
  - "5.  Key Generation Nonce Creation and Key Derivation\n   This section contains
    the procedures followed in the creation of the\n   Key Generation Nonce by AAA
    servers, and the key derivation\n   procedures used by mobile nodes.  Note that
    the AAA servers will also\n   deliver the keys to the mobility agents (home agent,
    foreign agent)\n   via the AAA protocol.  AAA servers that follow these procedures
    will\n   produce results that can be understood by mobile nodes.  The mobility\n
    \  agents will faithfully transcribe the results into the appropriate\n   Mobile
    IP extensions.\n   The following example uses HMAC-SHA1 [6].  All mobile nodes
    and\n   mobility agents implementing Mobile IP [1] and implementing the\n   extensions
    specified in this document MUST implement HMAC-SHA1 [1].\n   Other message authentication
    codes or keyed hash functions MAY also\n   be used.  The particular algorithm
    used is configured as part of the\n   AAA Security Association between the MN
    and the AAAH server, which is\n   in turn indexed by the AAA SPI.\n   The following
    steps are performed on the AAAH server:\n   1. The AAA server identifies the mobile
    node.  If the NAI field is\n      present in the Registration Request, then the
    NAI is used as the\n      mobile node identifier.  Otherwise, the Home Address
    field of the\n      Registration Request is used.\n   2. The AAA server generates
    a random [7] value of at least 128 bits\n      to be used as the Key Generation
    Nonce.\n   3. The AAA server inserts the random value into the Key Generation\n
    \     Nonce Reply extension in the \"Key Generation Nonce\" field.\n   The following
    steps are performed by the mobile node (here ||\n   represents concatenation):\n
    \  1. The mobile node calculates\n         key = HMAC-SHA1 (AAA-key, {Key Generation
    Nonce || mobile node\n         identifier})\n      Here the Key Generation Nonce
    is from the extension in the\n      Registration Reply, and the mobile node identifier
    is the MN's\n      NAI, if present in the Registration Request, or the Home Address\n
    \     from the Registration Request otherwise.\n   2. The mobile node creates
    the Mobility Security Association(s),\n      using the resulting key and the other
    relevant information in the\n      Key Generation Nonce Extension.\n   The secret
    key used within the HMAC-SHA1 computation is indicated by\n   the AAA Security
    Association indexed by the AAA SPI, which has been\n   previously configured as
    the basis for the AAA Security Association\n   between the mobile node and the
    AAA server creating the key material.\n"
  title: 5.  Key Generation Nonce Creation and Key Derivation
- contents:
  - "6.  Key Generation Extensions\n   This section defines new Extensions to Mobile
    IP Registration\n   Requests and Replies [1].\n"
  - contents:
    - "6.1.  Generalized MN-FA Key Generation Nonce Request Extension\n   Figure 1
      illustrates the Generalized MN-FA Key Generation Nonce\n   Request Extension
      (MN-FA KeyGen Request for short).\n    0                   1                   2
      \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
      5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Type      |    Subtype    |            Length             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                       Mobile Node SPI                         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |           MN-FA Key Generation Nonce Request Subtype Data ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \    Figure 1: The Generalized Mobile IP MN-FA Key Generation\n               Nonce
      Request Extension\n   Type             40 (not skippable) (see [1] and section
      8)\n   Subtype          A number assigned to identify the way in which the\n
      \                   MN-FA Key Generation Nonce Request Subtype Data is\n                    to
      be used when generating the registration key.\n   Length           The 16-bit
      Length field indicates the length of the\n                    extension.  It
      is equal to the number of bytes in\n                    the MN-FA Key Generation
      Nonce Request Subtype Data\n                    plus 4 (for the Mobile Node
      SPI field).\n   Mobile Node SPI  The Security Parameters Index that the mobile
      node\n                    will assign for the Mobility Security Association\n
      \                   created for use with the registration key.\n   MN-FA Key
      Generation Nonce Request Subtype Data\n                    Data needed to carry
      out the creation of the\n                    registration key on behalf of the
      mobile node.\n   The MN-FA KeyGen Request defines a set of extensions, identified
      by\n   subtype, which may be used by a mobile node in a Mobile IP\n   Registration
      Request message to request that some other entity create\n   a Registration
      Key for use by the mobile node with the mobile node's\n   new foreign agent.\n
      \  This document defines the subtype 1 for the MN-FA Key Generation\n   Nonce
      >From AAA Request (MN-FA AAA KeyGen Request for short).  The\n   MN-FA AAA KeyGen
      Request has a zero-length Subtype Data field and\n   MUST appear in the Registration
      Request before the MN-AAA\n   Authentication extension.\n"
    title: 6.1.  Generalized MN-FA Key Generation Nonce Request Extension
  - contents:
    - "6.2.  Generalized MN-FA Key Generation Nonce Reply Extension\n   The Generalized
      MN-FA Key Generation Nonce Reply extension (MN-FA\n   KeyGen Reply for short)
      supplies keying material requested by the\n   MN-FA KeyGen Request extension.
      \ Figure 2 illustrates the format of\n   the Generalized MN-FA Key Generation
      Nonce Reply Extension.\n    0                   1                   2                   3\n
      \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Type      |    Subtype    |            Length             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |             MN-FA Key Generation Nonce Reply Subtype Data ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \         Figure 2: The Generalized Mobile IP MN-FA Key\n                    Generation
      Nonce Reply Extension\n   Type       41 (not skippable) (see [1] and section
      8)\n   Subtype    A number assigned to identify the way in which the MN-FA\n
      \             Key Generation Nonce Reply Subtype Data is to be used to\n              obtain
      the registration key.\n   Length     The 16-bit Length field is equal to the
      number of bytes in\n              the MN-FA Key Generation Nonce Reply Subtype
      Data.\n   MN-FA Key Generation Nonce Reply Subtype Data\n              An encoded
      copy of the keying material, along with any\n              other information
      needed by the recipient to create the\n              designated Mobility Security
      Association.\n   For each subtype, the format of the MN-FA Key Generation Nonce
      Reply\n   Subtype Data has to be separately defined according to the particular\n
      \  method required to set up the Mobility Security Association.\n   For the
      subtype defined in this document, the MN-FA Key Generation\n   Nonce supplied
      in the data for a subtype of this extension may come\n   as a result of a request
      which was sent using a subtype of the\n   Generalized MN-FA Key Generation Nonce
      Request Extension.  In such\n   cases, the SPI to be used when employing the
      Mobility Security\n   Association defined by the registration key is the same
      as given in\n   the original request.\n   Once the mobile node creates the Mobility
      Security Association with\n   the foreign agent, by using the transform indexed
      by the AAA SPI, it\n   stores that Mobility Security Association indexed by
      the FA SPI in\n   its list of Mobile Security Associations.\n   If the foreign
      agent receives a Registration Reply that has no MN-FA\n   Key Generation Nonce
      Reply extension, and if it has no existing\n   Mobility Security Association
      with the mobile node, the foreign agent\n   MAY change the Code value of the
      Registration Reply to MISSING_MN_FA\n   (see section 7), effectively causing
      the registration to fail.\n   This document defines subtype 1 of the MN-FA KeyGen
      Reply for the\n   MN-FA Key Generation Nonce From AAA extension (MN-FA AAA KeyGen
      Reply\n   for short), shown in figure 3.\n    0                   1                   2
      \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
      5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                            Lifetime                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                            AAA SPI                            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                             FA SPI                            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |      Algorithm Identifier     |      Key Generation Nonce ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \       Figure 3: The MN-FA Key Generation Nonce From AAA\n                  Subtype-Specific
      Data\n   lifetime   This field indicates the duration of time (in seconds) for\n
      \             which the keying material used to create the registration\n              key
      is valid.\n   AAA SPI    A 32-bit opaque value, indicating the SPI that the
      mobile\n              node must use to determine the transform to use for\n
      \             establishing the Mobility Security Association between the\n              mobile
      node and its prospective foreign agent.\n   FA SPI     The SPI for the Mobility
      Security Association to the FA\n              that the mobile node creates using
      the Key Generation\n              Nonce.\n   Algorithm Identifier\n              This
      field indicates the transform to be used (stored as\n              part of the
      Mobility Security Association with the foreign\n              agent, and selected
      from among the values in the\n              \"Authentication Algorithm\" table
      cited in section 4), for\n              future computations of the Mobile-Foreign
      Authentication\n              Extension.\n   Key Generation Nonce\n              A
      random [7] value of at least 128 bits.\n   The MN-FA AAA KeyGen Reply extension
      MUST appear in the Registration\n   Reply before the Mobile-Foreign Authentication
      extension.\n   The Key Generation Nonce is provided by the AAA server for use
      by the\n   mobile node in creating the registration key, which is used to secure\n
      \  future Mobile IP registrations with the same foreign agent.\n"
    title: 6.2.  Generalized MN-FA Key Generation Nonce Reply Extension
  - contents:
    - "6.3.  Generalized MN-HA Key Generation Nonce Request Extension\n   Figure 4
      illustrates the Generalized MN-HA Key Generation Nonce\n   Request Extension
      (MN-HA KeyGen Request for short).\n   Type             42 (not skippable) (see
      [1] and section 8)\n   Subtype          a number assigned to identify the way
      in which the\n                    MN-HA Key Generation Nonce Request Subtype
      Data is\n                    to be used when generating the registration key.\n
      \  Length           The 16-bit Length field indicates the length of the\n                    extension.
      \ It is equal to the number of bytes in\n                    the MN-HA Key Generation
      Nonce Request.\n    0                   1                   2                   3\n
      \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Type      |    Subtype    |            Length             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                       Mobile Node SPI                         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |            MN-HA Key Generation Nonce Request Subtype Data ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \    Figure 4: The Generalized Mobile IP MN-HA Key Generation\n               Nonce
      Request Extension\n   Subtype Data plus 4 (for the Mobile Node SPI field).\n
      \  Mobile Node SPI  The Security Parameters Index that the mobile node\n                    will
      assign for the Mobility Security Association\n                    created for
      use with the registration key.\n   MN-HA Key Generation Nonce Request Subtype
      Data\n                    Data needed to carry out the creation of the MN-HA\n
      \                   key on behalf of the mobile node.\n   The MN-HA KeyGen Request
      Extension defines a set of extensions,\n   identified by subtype, which may
      be used by a mobile node in a Mobile\n   IP Registration Request message to
      request that some other entity\n   create an MN-HA key for use by the mobile
      node with the mobile node's\n   new home agent.\n   This document defines the
      subtype 1 for the MN-HA Key Generation\n   Nonce from AAA Request (MN-HA AAA
      KeyGen Request for short).  The\n   MN-HA AAA KeyGen Request has a zero-length
      Subtype Data field and\n   MUST appear in the Registration Request before the
      MN-AAA\n   Authentication extension.\n"
    title: 6.3.  Generalized MN-HA Key Generation Nonce Request Extension
  - contents:
    - "6.4.  Generalized MN-HA Key Generation Nonce Reply Extension\n   The Generalized
      MN-HA Key Generation Nonce Reply extension (MN-HA\n   KeyGen Reply for short)
      supplies keying material requested by the\n   MN-HA KeyGen Request extension.
      \ Figure 5 illustrates the format of\n   the Generalized MN-HA Key Generation
      Nonce Reply Extension.\n    0                   1                   2                   3\n
      \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Type      |    Subtype    |            Length             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                            Lifetime                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |              MN-HA Key Generation Nonce Reply Subtype Data ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \         Figure 5: The Generalized Mobile IP MN-HA Key\n                    Generation
      Nonce Reply Extension\n   Type       43 (not skippable) (see [1] and section
      8)\n   Subtype    a number assigned to identify the way in which the MN-HA\n
      \             Key Generation Nonce Reply Subtype Data is to be used to\n              obtain
      the MN-HA key.\n   Length     The 16-bit Length field indicates the length of
      the\n              extension.  It is equal to the number of bytes in the MN-\n
      \             HA Key Generation Nonce Reply Subtype Data plus 4 (for the\n              Lifetime
      field).\n   Lifetime   This field indicates the duration of time (in seconds)
      for\n              which the MN-HA key is valid.\n   MN-HA Key Generation Nonce
      Reply Subtype Data\n              Data used to derive the MN-HA key, along with
      any other\n              information needed by the mobile node to create the\n
      \             designated Mobility Security Association with the home\n              agent.\n
      \  For each subtype, the format of the MN-HA Key Generation Nonce Reply\n   Subtype
      Data has to be separately defined according to the particular\n   method required
      to set up the Mobility Security Association.\n   This document defines subtype
      1 of the MN-HA KeyGen Reply for the\n   MN-HA Key Generation Nonce From AAA
      extension (MN-HA AAA KeyGen Reply\n   for short), shown in figure 6.\n    0
      \                  1                   2                   3\n    0 1 2 3 4
      5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                            AAA SPI                            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                             HA SPI                            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Algorithm Identifier      |         Replay Method         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |                         Key Generation Nonce ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \       Figure 6: The MN-HA Key Generation Nonce From AAA\n                  Subtype-Specific
      Data\n   AAA SPI    A 32-bit opaque value, indicating the SPI that the mobile\n
      \             node must use to determine the transform to use for\n              establishing
      the Mobility Security Association between the\n              mobile node and
      its home agent.\n   HA SPI     The SPI for the Mobility Security Association
      to the HA\n              that the mobile node creates using the Key Generation\n
      \             Nonce.\n   Algorithm Identifier\n              This field indicates
      the transform to be used for future\n              computations of the Mobile-Home
      Authentication Extension\n              (see section 4).\n   Replay Method\n
      \             This field contains the replay method to be used for\n              future
      Registration messages (see section 4).\n   Key Generation Nonce\n              A
      random [7] value of at least 128 bits.\n   The MN-HA AAA KeyGen Reply subtype-specific
      data is shown in figure\n   6.  The Mobile Node calculates the MN-HA key using
      the Key Generation\n   Nonce provided by the AAA server.  The calculation proceeds
      by using\n   the key shared between the mobile node and the AAA server that
      has\n   previously been configured for securing all such communication\n   requirements
      with the AAA server which will be contacted within the\n   AAA infrastructure
      (see appendix A).  The MN-HA key is intended for\n   use by the mobile node
      to secure future Mobile IP registrations with\n   its home agent.  The MN-HA
      AAA KeyGen Reply extension MUST appear in\n   the Registration Reply before
      the MN-HA Authentication extension.\n   Once the mobile node creates the MN-HA
      Key, by using the transform\n   specified in the AAA SPI, it stores the HA Security
      Information\n   indexed by the HA SPI in its list of Mobile Security Associations.\n
      \  The mobile node uses the Identification field data from the\n   Registration
      Reply as its initial synchronization data with the home\n   agent.\n"
    title: 6.4.  Generalized MN-HA Key Generation Nonce Reply Extension
  title: 6.  Key Generation Extensions
- contents:
  - "7.  Error Values\n   Each entry in the following table contains the name of the
    Code [1]\n   value to be returned in a Registration Reply, the value for that\n
    \  Code, and the section in which the error is first mentioned in this\n   specification.\n
    \     Error Name               Value   Section\n      ----------------------   -----
    \  ---------\n      MISSING_MN_FA             107      6.2\n"
  title: 7.  Error Values
- contents:
  - "8.  IANA Considerations\n   This document defines 4 new extensions (see Section
    6) taken from the\n   (non-skippable) numbering space defined for Mobile IP registration\n
    \  extensions defined in RFC 3344 [1] as extended in RFC 2356 [8].  The\n   values
    for these extensions are:\n      Name                   Value   Section\n      ---------------------
    ------- ---------\n      MN-FA-KeyGen Request    40      6.1\n      MN-FA-KeyGen
    Reply      41      6.2\n      MN-HA-KeyGen Request    42      6.3\n      MN-HA-KeyGen
    Reply      43      6.4\n   IANA has created and will maintain a new registry for
    the KeyGen\n   Request/Reply subtypes.  The initial contents of the registry is
    a\n   single entry for the subtypes defined in this document:\n      Name                           Value
    \  Section\n      ----------------------------- ------- ---------\n      KeyGen
    Request/Reply from AAA    1        6\n   New subtypes for these two registries
    are assigned through Standards\n   Action as defined in [9].\n   IANA has assigned
    a code value for error MISSING_MN_FA, listed in\n   section 7.  This value has
    been taken from the space of error values\n   conventionally associated with rejection
    by the foreign agent (i.e.,\n   64-127).\n   IANA has created and will maintain
    a namespace for the Replay Method\n   Identifier.  This specification makes use
    of 2 and 3; all other\n   values other than zero (0) and (1) are available for
    assignment,\n   pending review and approval by a Designated Expert [9].\n"
  title: 8.  IANA Considerations
- contents:
  - "9.  Security Considerations\n   The extensions in this document are intended
    to provide the\n   appropriate level of security for Mobile IP entities (mobile
    node,\n   foreign agent, and home agent) to calculate the Authentication Data\n
    \  needed by authentication extensions used with Mobile IP registration\n   messages.
    \ The Mobility Security Associations resulting from use of\n   these extensions
    do not offer any higher level of security than what\n   is already implicit in
    use of the AAA Security Association between\n   the mobile node and the AAAH.
    \ In order to deny any adversary the\n   luxury of unbounded time to analyze and
    break the secrecy of the AAA\n   Security Association between the mobile node
    and the AAA server, that\n   AAA Security Association MUST be refreshed periodically.\n
    \  The provisioning and refreshing of the AAA key in the MN and AAA\n   server
    is outside the scope of this document.\n   Since the Reply extensions defined
    in this specification only carry\n   Key Generation Nonces, which are used to
    derive keys, they do not\n   expose any data that could be used in an attack aimed
    at recovering\n   the key shared between the mobile node and the AAA.  The authors
    do\n   not believe this specification introduces any new security\n   vulnerability.\n"
  title: 9.  Security Considerations
- contents:
  - "10.  Acknowledgements\n   Thanks to Fredrik Johansson, Tom Hiller, and the members
    of the IESG\n   for their useful comments.  Thanks especially to Tom Hiller who
    has\n   contributed many textual improvements to later revisions of this\n   document.\n"
  title: 10.  Acknowledgements
- contents:
  - '11.  References

    '
  - contents:
    - "11.1.  Normative References\n   [1]  Perkins, C., Ed., \"IP Mobility Support
      for IPv4\", RFC 3344,\n        August 2002.\n   [2]  Aboba, B. and M. Beadles,
      \"The Network Access Identifier\", RFC\n        2486, January 1999.\n   [3]
      \ Perkins, C. and P. Calhoun, \"Mobile IPv4 Challenge/Response\n        Extension\",
      RFC 3012, November 2000.\n   [4]  Bradner, S., \"Key words for use in RFCs to
      Indicate Requirement\n        Levels\", BCP 14, RFC 2119, March 1997.\n   [5]
      \ Calhoun, P. and C. Perkins, \"Mobile IP Network Access Identifier\n        Extension
      for IPv4\", RFC 2794, March 2000.\n   [6]  Krawczyk, H., Bellare, M., and R.
      Canetti, \"HMAC: Keyed-Hashing\n        for Message Authentication\", RFC 2104,
      February 1997.\n   [7]  Eastlake, D., Crocker, S., and J. Schiller, \"Randomness\n
      \       Recommendations for Security\", RFC 1750, December 1994.\n   [8]  Montenegro,
      G. and V. Gupta, \"Sun's SKIP Firewall Traversal for\n        Mobile IP\", RFC
      2356, June 1998.\n   [9]  Narten, T. and H. Alvestrand, \"Guidelines for Writing
      an IANA\n        Considerations Section in RFCs\", BCP 26, RFC 2434, October
      1998.\n"
    title: 11.1.  Normative References
  - contents:
    - "11.2.  Informative References\n   [10] Mitton, D., St.Johns, M., Barkley, S.,
      Nelson, D., Patil, B.,\n        Stevens, M., and B. Wolff, \"Authentication,
      Authorization, and\n        Accounting: Protocol Evaluation\", RFC 3127, June
      2001.\n   [11] Rigney, C., Willens, S., Rubens, A., and A. Simpson, \"Remote\n
      \       Authentication Dial In User Service (RADIUS)\", RFC 2865, June\n        2000.\n
      \  [12] Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko,\n        \"Diameter
      Base Protocol\", RFC 3588, September 2003.\n   [13] Glass, S., Hiller, T., Jacobs,
      S., and C. Perkins, \"Mobile IP\n        Authentication, Authorization, and
      Accounting Requirements\", RFC\n        2977, October 2000.\n   [14] Calhoun,
      P. and C. Perkins, \"DIAMETER mobile IP extensions\",\n        Work in Progress,
      February 2004.\n"
    title: 11.2.  Informative References
  title: 11.  References
- contents:
  - "Appendix A.  AAA Infrastructure\n   In this appendix, we attempt to capture the
    main features of a basic\n   model for operation of AAA servers that is assumed
    for understanding\n   of the use of the Mobile IP registration extensions described
    in this\n   document.  This information has been adapted from the discussion in\n
    \  RFC 2977 [13].\n   Within the Internet, a mobile node belonging to one administrative\n
    \  domain (called the home domain) often needs to use resources provided\n   by
    another administrative domain (called the foreign domain).  A\n   foreign agent
    that handles the mobile node's Registration Request is\n   likely to require that
    the mobile node provide some credentials that\n   can be authenticated before
    access to the resources is permitted.\n   These credentials may be provided as
    part of the Mobile-AAA\n   Authentication extension [3], relying on the existence
    of an AAA\n   infrastructure such as is described in this section, and also\n
    \  described in RFC 2977 and RFC 3012 [3].  Such credentials are\n   typically
    managed by entities within the mobile node's home domain.\n   They may be also
    used for setting up secure communications with the\n   mobile node and the foreign
    agent, or between the mobile node and its\n   home agent if necessary.\n                Local
    Domain                  Home Domain\n              +--------------+           +----------------------+\n
    \             |   +------+   |           |   +------+           |\n              |
    \  |      |   |           |   |      |           |\n              |   | AAAL |
    \  |           |   | AAAH |           |\n              |   |      +-------------------+
    \     |           |\n              |   +---+--+   |           |   +------+           |\n
    \             |       |      |           |                      |\n              |
    \      |      |           +----------------------+\n   +------+   |   +---+--+
    \  |\n   |      |   |   |      |   |       MN   =  mobile node\n   |  MN  |- -|-
    -|  FA  |   |       FA   =  foreign agent\n   |      |   |   |      |   |       AAAL
    =  local authority\n   +------+   |   +------+   |       AAAH =  home authority\n
    \             |              |\n              +--------------+\n          Figure
    7: AAA Servers in Home and Local Domains\n   The foreign agent often does not
    have direct access to the data\n   needed to verify the credentials.  Instead,
    the foreign agent is\n   expected to consult an authority (typically in the same
    foreign\n   domain) in order to request proof that the mobile node has acceptable\n
    \  credentials.  Since the foreign agent and the local authority (AAAL)\n   are
    part of the same administrative domain, they are expected to have\n   established,
    or be able to establish for the necessary lifetime, a\n   secure channel for the
    purposes of exchanging sensitive (access)\n   information, and keeping it private
    from (at least) the visiting\n   mobile node.\n   The local authority (AAAL) itself
    may not have enough information\n   stored locally to carry out the verification
    for the credentials of\n   the mobile node.  In contrast to the foreign agent,
    however, the AAAL\n   is expected to be configured with enough information to
    negotiate the\n   verification of mobile node credentials with its home domain.
    \ The\n   home and foreign domains should be configured with sufficient IP\n   Security
    Associations (i.e., IPsec) and access controls so that they\n   can negotiate
    the authorization, and also enable the mobile node to\n   acquire Mobility Security
    Associations with the mobility agents\n   within the foreign domain.  For the
    purposes of the key exchanges\n   specified within this document, the authorization
    is expected to\n   depend only upon secure authentication of the mobile node's\n
    \  credentials.\n   Once the authorization has been obtained by the local authority,
    and\n   the authority has notified the foreign agent about the successful\n   negotiation,
    the foreign agent can deliver the Registration Reply to\n   the mobile node along
    with the key material.\n   In figure 7, there might be many mobile nodes from
    many different\n   Home Domains.  Each Home Domain provides a AAAH that can check\n
    \  credentials originating from mobile nodes administered by that Home\n   Domain.
    \ There is a security model implicit in figure 7, and it is\n   crucial to identify
    the specific security associations assumed in the\n   security model.  These IP
    Security Associations are illustrated in\n   figure 8, and are considered to be
    relatively long-lived security\n   associations.\n   First, it is natural to assume
    that the mobile node has an AAA\n   Security Association with the AAAH, since
    that is roughly what it\n   means for the mobile node to belong to the home domain.\n
    \  Second, from the model illustrated in figure 7 it is clear that AAAL\n   and
    AAAH have to share an IP Security Association, because otherwise\n   they could
    not rely on the authentication results, authorizations,\n   nor even the accounting
    data which might be transacted between them.\n   Requiring such bilateral IP Security
    Associations is, however, in the\n   end not scalable; the AAA framework must
    provide for more scalable\n   mechanisms, but the methods by which such a broker
    model is to be\n   created are out of scope for this document.  See RFC 2977 for
    more\n   details.\n   Finally, from figure 7, it is clear that the foreign agent
    can\n   naturally share an IP Security Association with the AAAL.  This is\n   necessary
    in order for the model to work because the foreign agent\n   has to have a way
    to find out that it is permissible to allocate the\n   local resources to the
    mobile node, and further to transmit any\n   successful Registration Reply to
    the mobile node.\n   Figure 8 illustrates the IP Security Associations we understand
    from\n   our proposed model.  Note that there may be, by mutual agreement\n   between
    AAAL and AAAH, a third party inserted between AAAL and AAAH\n   to help them arbitrate
    secure transactions in a more scalable\n   fashion.  The broker model which has
    been designed to enable such\n   third-party processing should not have any effect
    on the Mobile IP\n   extensions specified in this document, and so no description
    is\n   provided here; see RFC 2977 [13] for more details.\n                               +------+
    \             +------+\n                               |      |              |
    \     |\n                               | AAAL +--------------+ AAAH |\n                               |
    \     |              |      |\n                               +---+--+              +--+---+\n
    \                                  |                    |\n                                   |
    \                   |\n                               +---+--+              +--+---+\n
    \  MN   =  mobile node         |      |              |      |\n   FA   =  foreign
    agent       |  FA  |              |  MN  |\n   AAAL =  local authority     |      |
    \             |      |\n   AAAH =  home authority      +------+              +------+\n
    \                  Figure 8: IP Security Associations\n   Nodes in two separate
    administrative domains (for instance, AAAH and\n   AAAL) often must take additional
    steps to verify the identity of\n   their communication partners, or alternatively
    to guarantee the\n   privacy of the data making up the communication.  While these\n
    \  considerations lead to important security requirements, as mentioned\n   above
    in the context of security between servers, we consider the\n   exact choice of
    IP Security Associations between the AAA servers to\n   be beyond the scope of
    this document.  The choices are unlikely to\n   depend upon Mobile IP, or any
    specific features of the general model\n   illustrated in figure 7.  On the other
    hand, the Mobility Security\n   Associations needed between Mobile IP entities
    are of central\n   importance in the design of the key derivation extensions in
    this\n   document.\n   One further detail deserves mention.  The Mobility Security\n
    \  Association to be established between the mobile node and the foreign\n   agent
    has to be communicated to the foreign agent as well as to the\n   mobile node.
    \ The following requirements are placed on the mechanism\n   used by the AAA infrastructure
    to effect key distribution:\n   -  The AAAH must establish strong, fresh session
    keys.\n   -  The mechanism must maintain algorithm independence, allowing for\n
    \     the distribution of authentication algorithm identification along\n      with
    the keys.\n   -  The mechanism must include replay detection.\n   -  The mechanism
    must authenticate all parties, including the AAA\n      servers and the FA and
    HA.\n   -  The mechanism must provide for authorization of the client, FA,\n      and
    HA.\n   -  The mechanism must not rely on plaintext passwords.\n   -  The mechanism
    must maintain confidentiality of session keys.\n   -  The mechanism must uniquely
    name session keys.\n   -  The mechanism must be such that the compromise of a
    single FA and\n      HA cannot compromise any other part of the system, including\n
    \     session keys and long-term keys\n   -  The mechanism must bind key(s) to
    an appropriate context\n   -  The mechanism must not expose the keys to entities
    other than the\n      AAAH and FA (or HA in the case of key distribution to the
    HA).\n   The way that the key is distributed to the foreign agent (or home\n   agent)
    is expected to be handled as part of the AAA protocol\n   processing between the
    AAAH and AAAL, and the further AAA protocol\n   processing between the AAAL and
    the foreign agent.  Such processing\n   is outside the scope of this document,
    but must satisfy the above\n   requirements.\n"
  title: Appendix A.  AAA Infrastructure
- contents:
  - "Appendix B.  Message Flow for Requesting and Receiving Registration Keys\n   In
    this section, we show message flows for requesting and receiving a\n   registration
    key from the AAA infrastructure, described in section A.\n   Challenge values,
    as specified in [3], might be added to the\n   Advertisement and Registration
    messages for additional replay\n   protection, but are not illustrated here.\n
    \  Diagram 9 illustrates the message flow for the case when the mobile\n   node
    explicitly requests keying material to create registration keys.\n   MN                     FA
    \                 AAA Infrastructure\n    |                       |                           |\n
    \   |<--- Advertisement-----|                           |\n    |      (if needed)
    \     |                           |\n    |                       |                           |\n
    \   |-- RReq+AAA Key Req.-->|                           |\n    |                       |---
    RReq + AAA Key Req.--->|\n    |                       |                           |\n
    \   |                       |<--- RRep + AAA Key Rep.---|\n    |<-- RRep+AAA Key
    Rep.--|                           |\n    |                       |                           |\n
    \         Figure 9: Message Flows for Requesting and\n                    Receiving
    Key Generation Nonce\n   In diagram 9, the following message flow is illustrated:\n
    \  1. The foreign agent disseminates an Agent Advertisement.  This\n      advertisement
    MAY have been produced after receiving an Agent\n      Solicitation from the mobile
    node (not shown in the diagram).\n   2. The mobile node creates a Registration
    Request including the MN-HA\n      AAA KeyGen Request and/or MN-FA AAA KeyGen
    Request, as needed,\n      along with an authorization-enabling authentication
    extension as\n      required by Mobile IP [1].\n   3. The foreign agent relays
    the Registration Request and/or Key\n      Request(s) to its locally configured
    AAA Infrastructure (see\n      appendix A), according to local policy.\n   4.
    The foreign agent receives a AAA Response with the appropriate\n      indications
    for authorizing connectivity for the mobile node.\n      Along with this AAA Response,
    the foreign agent may also receive\n      key material by some secure method appropriate
    for communications\n      between it and its local AAA infrastructure.  At this
    point if the\n      foreign agent has not relayed the Registration Request, it\n
    \     forwards it directly to the Home Agent and waits for a\n      Registration
    Reply (not shown in the figure).\n   5. The foreign agent relays the Registration
    Reply to the mobile\n      node, along with the new AAA KeyGen Reply extensions
    to be used by\n      the mobile node to establish Mobility Security Associations
    with\n      the relevant mobility agents (foreign agent and/or home agent).\n
    \  Diagram 10 illustrates the message flow for the case when the mobile\n   node
    receives unsolicited keying material from the AAA\n   Infrastructure.\n   MN                     FA
    \                 AAA Infrastructure\n    |                       |                           |\n
    \   |<--- Advertisement-----|                           |\n    |      (if needed)
    \     |                           |\n    |                       |                           |\n
    \   | ------ RReq --------->|                           |\n    |                       |-------
    RReq ------------->|\n    |                       |                           |\n
    \   |                       |<--- RRep + AAA Key Rep.---|\n    |<-- RRep+AAA Key
    Rep.--|                           |\n    |                       |                           |\n
    \     Figure 10: Message Flow for Receiving Unsolicited\n                 Key
    Generation Nonce\n   In diagram 10, the following message flow is illustrated:\n
    \  1. The foreign agent disseminates an Agent Advertisement.  This\n      advertisement
    MAY have been produced after receiving an Agent\n      Solicitation from the mobile
    node (not shown in the diagram).\n   2. The mobile node creates a Registration
    Request including an\n      authorization-enabling authentication extension as
    required by\n      Mobile IP [1].\n   3. The foreign agent sends a AAA Request
    (possibly containing the\n      Registration Request) to its locally configured
    AAA Infrastructure\n      (see appendix A), according to local policy.\n   4.
    The foreign agent receives a AAA Response with the appropriate\n      indications
    for authorizing connectivity for the mobile node.\n      Along with this AAA Response,
    the foreign agent may also receive\n      key material by some secure method appropriate
    for communications\n      between it and its local AAA infrastructure.  At this
    point, if\n      the foreign agent has not relayed the Registration Request, it\n
    \     forwards it directly to the Home Agent and waits for a\n      Registration
    Reply (not shown in the figure).\n   5. The foreign agent relays the Registration
    Reply to the mobile\n      node, along with the new KeyGen Reply extensions to
    be used by the\n      mobile node to establish Mobility Security Associations
    with the\n      relevant mobility agents (foreign agent and/or home agent).\n"
  title: Appendix B.  Message Flow for Requesting and Receiving Registration Keys
- contents:
  - "Authors' Addresses\n   Charles E. Perkins\n   Nokia Research Center\n   313 Fairchild
    Drive\n   Mountain View, California 94043\n   USA\n   Phone:  +1 650 625-2986\n
    \  Fax:    +1 650 625-2502\n   EMail:  charles.perkins@nokia.com\n   Pat R. Calhoun\n
    \  Airespace, Inc.\n   110 Nortech Parkway\n   San Jose, CA 95134\n   USA\n   Phone:
    \ +1 408 635 2000\n   Fax:    +1 408 635 2020\n   EMail:  pcalhoun@airespace.com\n"
  title: Authors' Addresses
- contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2005).\n   This
    document is subject to the rights, licenses and restrictions\n   contained in
    BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n
    \  This document and the information contained herein are provided on an\n   \"AS
    IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n   OR IS SPONSORED
    BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING TASK FORCE
    DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT LIMITED TO
    ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT INFRINGE ANY
    RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
    PURPOSE.\n"
  title: Full Copyright Statement
- contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or
    scope of any\n   Intellectual Property Rights or other rights that might be claimed
    to\n   pertain to the implementation or use of the technology described in\n   this
    document or the extent to which any license under such rights\n   might or might
    not be available; nor does it represent that it has\n   made any independent effort
    to identify any such rights.  Information\n   on the procedures with respect to
    rights in RFC documents can be\n   found in BCP 78 and BCP 79.\n   Copies of IPR
    disclosures made to the IETF Secretariat and any\n   assurances of licenses to
    be made available, or the result of an\n   attempt made to obtain a general license
    or permission for the use of\n   such proprietary rights by implementers or users
    of this\n   specification can be obtained from the IETF on-line IPR repository
    at\n   http://www.ietf.org/ipr.\n   The IETF invites any interested party to bring
    to its attention any\n   copyrights, patents or patent applications, or other
    proprietary\n   rights that may cover technology that may be required to implement\n
    \  this standard.  Please address the information to the IETF at ietf-\n   ipr@ietf.org.\n"
  title: Intellectual Property
- contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided
    by the\n   Internet Society.\n"
  title: Acknowledgement
