- title: __initial_text__
  contents:
  - "  Interoperability Issues between Domain-based Message Authentication,\n    \
    \  Reporting, and Conformance (DMARC) and Indirect Email Flows\n"
- title: Abstract
  contents:
  - "Abstract\n   Domain-based Message Authentication, Reporting, and Conformance\n\
    \   (DMARC) introduces a mechanism for expressing domain-level policies\n   and\
    \ preferences for email message validation, disposition, and\n   reporting.  However,\
    \ the DMARC mechanism enables potentially\n   disruptive interoperability issues\
    \ when messages do not flow directly\n   from the author's administrative domain\
    \ to the final Recipients.\n   Collectively, these email flows are referred to\
    \ as \"indirect email\n   flows\".  This document describes these interoperability\
    \ issues and\n   presents possible methods for addressing them.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 7841.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7960.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2016 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Document Conventions .......................................4\n  \
    \ 2. Causes of Interoperability Issues ...............................4\n    \
    \  2.1. Identifier Alignment .......................................4\n      \
    \     2.1.1. DKIM Identifier(s) ..................................5\n        \
    \   2.1.2. SPF Identifier(s) ...................................6\n          \
    \ 2.1.3. Multiple RFC5322.From Addresses .....................6\n      2.2. Message\
    \ Forwarding .........................................6\n      2.3. Message Modification\
    \ .......................................7\n   3. Internet Mail Architecture,\
    \ DMARC, and Indirect Email Flows .....8\n      3.1. Message Handling System ....................................8\n\
    \           3.1.1. Message Submission Agents ...........................8\n  \
    \         3.1.2. Message Transfer Agents .............................9\n    \
    \              3.1.2.1. Message Encoding ...........................9\n      \
    \            3.1.2.2. Header Standardization ....................10\n        \
    \          3.1.2.3. Content Validation ........................10\n          \
    \ 3.1.3. Message Delivery Agents ............................10\n      3.2. Mediators\
    \ .................................................11\n           3.2.1. Alias\
    \ ..............................................11\n           3.2.2. ReSenders\
    \ ..........................................12\n           3.2.3. Mailing Lists\
    \ ......................................12\n                  3.2.3.1. Mailing\
    \ List Operational Effects ..........13\n           3.2.4. Gateways ...........................................13\n\
    \           3.2.5. Boundary Filters ...................................14\n  \
    \    3.3. Combinations ..............................................15\n   4.\
    \ Possible Mitigations of Interoperability Issues ................15\n      4.1.\
    \ Mitigations in Current Use ................................16\n           4.1.1.\
    \ Mitigations for Senders ............................16\n                  4.1.1.1.\
    \ Identifier Alignment ......................16\n                  4.1.1.2. Message\
    \ Modification ......................17\n           4.1.2. Mitigations for Receivers\
    \ ..........................17\n                  4.1.2.1. Identifier Alignment\
    \ ......................17\n                  4.1.2.2. Policy Override ...........................17\n\
    \           4.1.3. Mitigations for ReSenders ..........................18\n  \
    \                4.1.3.1. Changes to the RFC5322.From ...............18\n    \
    \              4.1.3.2. Avoiding Message Modification .............18\n      \
    \            4.1.3.3. Mailing Lists .............................18\n      4.2.\
    \ Proposed and In-Progress Mitigations ......................20\n           4.2.1.\
    \ Getting More Radical: Requiring New\n                  Communication Paths between\
    \ MUAs ...................21\n   5. Security Considerations ........................................21\n\
    \   6. References .....................................................22\n  \
    \    6.1. Normative References ......................................22\n    \
    \  6.2. Informative References ....................................23\n   Appendix\
    \ A.  Example SPF Bounce ...................................24\n     A.1.  Initial\
    \ Message ...........................................24\n     A.2.  Notification\
    \ Message ......................................25\n   Acknowledgments ...................................................26\n\
    \   Authors' Addresses ................................................27\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   DMARC [RFC7489] introduces a mechanism for expressing domain-level\n\
    \   policies and preferences for message validation, disposition, and\n   reporting.\
    \  The DMARC mechanism, especially when employed with\n   restrictive policies,\
    \ encounters several different types of\n   interoperability issues due to third-party\
    \ message sourcing, message\n   transformation, or rerouting.  In particular,\
    \ DMARC with restrictive\n   policies causes problems for many Mailing Lists.\n\
    \   At the time of writing this document, the DMARC base specification\n   has\
    \ been published as Informational RFC 7489 [RFC7489] and has seen\n   significant\
    \ deployment within the email community.\n   Cases in which email does not flow\
    \ directly from the author's\n   administrative domain to the recipient's domain(s)\
    \ are collectively\n   referred to in this document as \"indirect email flows\"\
    .  Due to\n   existing and increasing adoption of DMARC, the impact of DMARC-based\n\
    \   email rejection policies on indirect email flows can be significant\n   for\
    \ a select subset of general email traffic.\n   Several known causes of interoperability\
    \ issues are presented,\n   followed by a description of components within the\
    \ Internet Mail\n   Architecture [RFC5598] where interoperability issues can arise.\n\
    \   Finally, known and possible methods for addressing interoperability\n   issues\
    \ are presented.  There are often multiple ways to address any\n   given interoperability\
    \ issue.  While this document strives to be\n   comprehensive in its review, it\
    \ should not be treated as complete.\n   Note that some practices that are in\
    \ use at the time of this document\n   may or may not be \"best practices\", especially\
    \ as future standards\n   evolve.\n"
- title: 1.1.  Document Conventions
  contents:
  - "1.1.  Document Conventions\n   The notation used in this document for structured\
    \ fields is taken\n   from [RFC5598], Section 1.3.\n   The term \"notification\
    \ message\" ([RFC5321], Section 4.5.5) is used to\n   refer to a message with\
    \ a null RFC5321.MailFrom.\n   The terms \"Organizational Domain\" and \"Authenticated\
    \ Identifiers\" are\n   specified in DMARC ([RFC7489], Section 3).\n   All words\
    \ that begin with capital letters take their formal meanings\n   from these references.\n"
- title: 2.  Causes of Interoperability Issues
  contents:
  - "2.  Causes of Interoperability Issues\n   Interoperability issues between DMARC\
    \ and indirect email flows arise\n   when conformance to the DMARC specification\
    \ leads a receiving\n   implementation to apply DMARC-based policy restrictions\
    \ to messages\n   that are both compliant with the architecture as specified in\n\
    \   [RFC5598] and viewed as legitimate by the intended Recipient.\n   Note that\
    \ domains that assert a \"p=none\" policy and email messages\n   that pass standard\
    \ DMARC validation do not have any interoperability\n   issues.\n   Email messages\
    \ that do not conform to IETF email specifications but\n   are considered legitimate\
    \ by the intended Recipients are not\n   discussed in this document.\n   The rest\
    \ of this section describes several conceptual causes of\n   interoperability\
    \ issues.\n"
- title: 2.1.  Identifier Alignment
  contents:
  - "2.1.  Identifier Alignment\n   Note to operators and administrators: The identifiers\
    \ that are used\n   by the Sender Policy Framework (SPF) are technical components\
    \ of the\n   transport process for SMTP.  They may or may not, as described below,\n\
    \   bear a meaningful relationship to the content or source of the\n   message\
    \ itself.  This \"relationship by proximity\" can be a point of\n   confusion\
    \ for non-technical end users, either recipients or senders.\n   DMARC relies\
    \ on DomainKeys Identified Mail (DKIM) [RFC6376] and SPF\n   [RFC7208] to perform\
    \ message source validation.  The DMARC [RFC7489]\n   specification refers to\
    \ source domains that are validated by DKIM or\n   SPF as \"Authenticated Identifiers\"\
    .  To be used by DMARC, an\n   \"Authenticated Identifier\" must also be related\
    \ to the domain found\n   in the message's RFC5322.From header field [RFC5322].\
    \  This\n   relationship between an Authenticated Identifier's domain and the\n\
    \   domain of the RFC5322.From is referred to as \"Identifier Alignment\".\n \
    \  DMARC allows for Identifier Alignment to be determined in two\n   different\
    \ modes: strict and relaxed.  Strict mode requires an exact\n   match between\
    \ the domain of any of the Authenticated Identifiers and\n   the message's RFC5322.From\
    \ header field [RFC5322].  Relaxed mode\n   allows for Identifier Alignment if\
    \ Authenticated Identifiers and the\n   message's RFC5322.From header field [RFC5322]\
    \ share the same\n   Organizational Domain.  In general, DMARC interoperability\
    \ issues are\n   the same for both strict and relaxed alignment, but strict alignment\n\
    \   constrains the possible solutions because of the more rigorous\n   matching\
    \ requirement.  Some of the mitigations described in this\n   document only work\
    \ with the relaxed mode of Identifier Alignment.\n"
- title: 2.1.1.  DKIM Identifier(s)
  contents:
  - "2.1.1.  DKIM Identifier(s)\n   DKIM provides a cryptographic means for one or\
    \ more domain\n   identifiers to be associated with a particular message.  As\
    \ a\n   standalone technology, DKIM identifiers are not required to be\n   related\
    \ to the source of the message's content.  However, for a DKIM\n   identifier\
    \ to align in DMARC, the signing domain of a valid signature\n   must be part\
    \ of the same Organizational Domain as the domain in the\n   RFC5322.From header\
    \ field [RFC5322].\n   In addition, DKIM allows for the possibility of multiple\
    \ valid\n   signatures.  These multiple signatures may be from the same or\n \
    \  different domains; there are no restrictions within the DKIM\n   specification.\
    \  The DMARC mechanism will process Authenticated\n   Identifiers that are based\
    \ on DKIM signatures until an aligned\n   Authenticated Identifier is found (if\
    \ any).  However, operational\n   experience has shown that some implementations\
    \ have difficulty\n   processing multiple signatures.  Implementations that cannot\
    \ process\n   multiple DKIM signatures may incorrectly flag messages as \"not\n\
    \   passing\" (DMARC alignment) and erroneously apply DMARC-based policy\n   to\
    \ otherwise conforming messages.\n"
- title: 2.1.2.  SPF Identifier(s)
  contents:
  - "2.1.2.  SPF Identifier(s)\n   The SPF specification [RFC7208] defines two Authenticated\
    \ Identifiers\n   for each message.  These identifiers derive from:\n   a.  the\
    \ RFC5321.MailFrom [RFC5321] domain, and\n   b.  the RFC5321.HELO/.EHLO SMTP domain.\n\
    \   In the SPF specification, the RFC7208.MAILFROM [RFC7208] value is\n   defined\
    \ to be based on RFC5321.MailFrom unless that value is absent\n   (as in the case\
    \ of notification messages), in which case, the second\n   (RFC5321.HELO/.EHLO)\
    \ identifier value is used.  This \"fallback\"\n   definition has occasionally\
    \ been misunderstood by operators of MTA\n   systems since notification messages\
    \ are often an \"automatic\" feature\n   of MTA software.  Some MTA software does\
    \ not provide the ability to\n   apply a DKIM signature to such notification messages.\n\
    \   See Appendix A for an example treatment of this scenario.\n   For the purposes\
    \ of DMARC validation/alignment, the hybrid\n   RFC7208.MAILFROM [RFC7208] identifier's\
    \ domain is used if and only if\n   it is aligned with the RFC5322.From [RFC5322]\
    \ domain.  The alignment\n   of the validated domain is determined based on the\
    \ DMARC record's\n   \"strict\" or \"relaxed\" designation as described above\
    \ for the DKIM\n   identifiers and in [RFC7489].\n"
- title: 2.1.3.  Multiple RFC5322.From Addresses
  contents:
  - "2.1.3.  Multiple RFC5322.From Addresses\n   [RFC5322] permits only one From header\
    \ field, but it may contain\n   multiple mailboxes.  Since this is an extremely\
    \ rare usage, DMARC\n   specifies that the handling of this situation is implementation\n\
    \   dependent.\n   Because the presence of multiple domains can be used by an\
    \ attacker\n   (an attacker could add their domain to the RFC5322.From field,\n\
    \   provide arbitrary new content, and sign the message), the DMARC\n   specification\
    \ recommends that the strictest policy be applied to such\n   messages (Section\
    \ 6.6.1 of [RFC7489]).\n"
- title: 2.2.  Message Forwarding
  contents:
  - "2.2.  Message Forwarding\n   Section 3 describes forwarding behavior as it relates\
    \ to the\n   components of the Internet Mail Architecture.\n   All forwarding\
    \ operations involve the retransmission of email.  As\n   discussed above, in\
    \ order for SPF to yield an Authenticated\n   Identifier that is pertinent to\
    \ DMARC, the domain of the\n   RFC7208.MAILFROM must be in alignment with the\
    \ RFC5322.From header\n   field.  Forwarding introduces specific issues to the\
    \ availability of\n   SPF-based Authenticated Identifiers:\n   o  If the RFC5321.MailFrom\
    \ is present and the forwarder maintains the\n      original RFC5321.MailFrom,\
    \ SPF validation will fail unless the\n      forwarder is an authorized part of\
    \ the originator's email sending\n      infrastructure.  If the forwarder replaces\
    \ the RFC5321.MailFrom\n      with its own domain, SPF might pass, but Identifier\
    \ Alignment with\n      the RFC5322.From header field will fail.\n   o  If the\
    \ RFC5321.MailFrom is empty (as in the case of Delivery\n      Status Notifications),\
    \ the RFC5321.HELO/.EHLO domain of the\n      forwarder will likely be in a different\
    \ Organizational Domain than\n      the original RFC5322.From header field's domain.\
    \  SPF may pass,\n      but Identifier Alignment with the RFC5322.From header\
    \ field will\n      fail.\n   In both cases, SPF cannot yield relevant Authenticated\
    \ Identifiers,\n   and DKIM must be relied upon to produce results that are relevant\
    \ to\n   DMARC.\n"
- title: 2.3.  Message Modification
  contents:
  - "2.3.  Message Modification\n   Modification of email content invalidates most\
    \ DKIM signatures, and\n   many message-forwarding systems modify email content.\
    \  Mailing List\n   processors are a common example of such systems, but other\
    \ forwarding\n   systems also make modifications.\n   Although DKIM provides a\
    \ length flag so that content can be appended\n   without invalidating the signature,\
    \ in practice, particularly with\n   MIME-encoded [RFC2045] messages, a Mailing\
    \ List processor will do\n   more than simply append content (see Section 5.3\
    \ of [RFC5598] for\n   details).  Furthermore, the length flag is seldom used\
    \ due to\n   security issues (see Section 8.2 of [RFC6376] for additional security\n\
    \   considerations).  Therefore, this method is only mentioned here for\n   completeness.\n\
    \   DKIM describes two canonicalizations for use when preparing the\n   header\
    \ and body for DKIM processing: simple and relaxed.  The latter\n   is designed\
    \ to accommodate trivial modifications to whitespace and\n   folding that, at\
    \ least in the header case, generally have no semantic\n   significance.  However,\
    \ the relaxed canonicalization is more\n   computationally intensive and may not\
    \ have been preferred in the\n   early deployment of DKIM, leaving some deployments\
    \ using the less\n   forgiving \"simple\" canonicalization.  While the prevalence\
    \ is\n   unknown, there are some DKIM verifiers that have problems evaluating\n\
    \   relaxed canonicalization correctly.\n"
- title: 3.  Internet Mail Architecture, DMARC, and Indirect Email Flows
  contents:
  - "3.  Internet Mail Architecture, DMARC, and Indirect Email Flows\n   This section\
    \ describes components within the Internet Mail\n   Architecture [RFC5598] where\
    \ interoperability issues between DMARC\n   and indirect email flows can be found.\n"
- title: 3.1.  Message Handling System
  contents:
  - "3.1.  Message Handling System\n   Section 4 of [RFC5598] describes six basic\
    \ components that make up\n   the Message Handling System (MHS):\n   o  Message\n\
    \   o  Message User Agent (MUA)\n   o  Message Submission Agent (MSA)\n   o  Message\
    \ Transfer Agent (MTA)\n   o  Message Delivery Agent (MDA)\n   o  Message Store\
    \ (MS)\n   Of these components, MSA, MTA, and MDA are discussed in relation to\n\
    \   interoperability with DMARC.\n   Section 5 of [RFC5598] also defines a Mediator\
    \ as a hybrid of several\n   component types.  A Mediator is given special consideration\
    \ in this\n   section due to the unique issues they face when attempting to\n\
    \   interoperate with DMARC.\n"
- title: 3.1.1.  Message Submission Agents
  contents:
  - "3.1.1.  Message Submission Agents\n   An MSA accepts messages submitted by a\
    \ Message User Agent (MUA) and\n   enforces the policies of the hosting ADministrative\
    \ Management Domain\n   (ADMD) and the requirements of Internet standards.\n \
    \  MSAs are split into two sub-components:\n   o  Author-focused MSA functions\
    \ (aMSA)\n   o  MHS-focused MSA functions (hMSA)\n   MSA interoperability issues\
    \ with DMARC begin when an aMSA accepts a\n   message where the RFC5322.From header\
    \ field contains a domain that is\n   outside of the ADMD of the MSA.  This situation\
    \ manifests in one of\n   several ways, such as when someone uses a mail service\
    \ with their own\n   domain but has failed to properly configure an SPF record\
    \ or when an\n   MUA attempts to transmit mail as someone else.  Examples of the\n\
    \   latter situation include \"forward-to-friend\" functionality commonly\n  \
    \ found on news/article websites or \"send-as\" functionality present on\n   some\
    \ MUAs.\n   When an hMSA takes responsibility for transit of a message containing\n\
    \   a domain in the RFC5322.From header field that is outside of the\n   hMSA's\
    \ ADMD, the hMSA faces DMARC interoperability issues if the\n   domain publishes\
    \ a DMARC policy of \"quarantine\" or \"reject\".  These\n   issues are marked\
    \ by the inherent difficulty of establishing\n   alignment with the domain present\
    \ in a message's RFC5322.From header\n   field.  Examples of this issue include:\n\
    \   o  Partially open relays - a residential ISP that allows its\n      customers\
    \ to relay non-local domains through its infrastructure.\n   o  Embedded devices\
    \ - cable/DSL modems, firewalls, wireless access\n      points, and printers that\
    \ send email using hardcoded domains.\n   o  Devices that send mail on behalf\
    \ of a user - scanners, security\n      cameras, and alarms that send mail as\
    \ their owner or a device\n      user.\n   o  Email service providers - ESPs that\
    \ service customers who are\n      using domains that publish a DMARC \"reject\"\
    \ policy.\n   o  Calendaring software - an invited member of an event modifies\
    \ the\n      event, causing the calendaring software to emit an update that\n\
    \      claims to come from the creator of the event.\n"
- title: 3.1.2.  Message Transfer Agents
  contents:
  - "3.1.2.  Message Transfer Agents\n   MTAs relay a message until the message reaches\
    \ a destination MDA.\n   Some common message-handling strategies break the integrity\
    \ of DKIM\n   signatures.  A restrictive DMARC policy along with a broken DKIM\n\
    \   signature causes latent interoperability problems to become overt\n   problems.\n"
- title: 3.1.2.1.  Message Encoding
  contents:
  - "3.1.2.1.  Message Encoding\n   An MTA may modify the message encoding, for instance,\
    \ by converting\n   8-bit MIME sections to quoted-printable 7-bit sections.  This\n\
    \   modification is outside the scope of DKIM canonicalization and will\n   invalidate\
    \ DKIM signatures that include message content.\n   An MTA could also re-encode\
    \ the message without changing the encoding\n   type: receiving a MIME-encoded\
    \ message and producing a semantically\n   and semiotically equivalent MIME body\
    \ that is not identical to the\n   original.  This is characteristic of systems\
    \ that use some other\n   message representation internally.\n"
- title: 3.1.2.2.  Header Standardization
  contents:
  - "3.1.2.2.  Header Standardization\n   An MTA may rewrite headers to bring them\
    \ into compliance with\n   existing RFCs.  For example, some common MTAs will\
    \ correct\n   comprehensible but non-compliant date formats to compliant ones.\n\
    \   Header rewriting is outside the scope of DKIM canonicalization and\n   will\
    \ invalidate DKIM signatures.  All downstream DMARC processing\n   with be unable\
    \ to utilize DKIM to yield Authenticated Identifiers due\n   to header rewriting.\n\
    \   Providing solutions for issues relating to non-RFC-compliant emails\n   is\
    \ outside the scope of this document.\n"
- title: 3.1.2.3.  Content Validation
  contents:
  - "3.1.2.3.  Content Validation\n   An MTA may also implement security-motivated\
    \ changes to the content\n   of email messages, dropping or altering sections\
    \ of messages, causing\n   breakage of DKIM signatures.\n"
- title: 3.1.3.  Message Delivery Agents
  contents:
  - "3.1.3.  Message Delivery Agents\n   The MDA transfers a message from the MHS\
    \ to a mailbox.  Like the MSA,\n   the MDA consists of two sub-components:\n \
    \  o  MHS-focused MDA functions (hMDA)\n   o  Recipient-focused MDA functions\
    \ (rMDA)\n   Both the hMDA and the rMDA can redirect a message to an alternative\n\
    \   address.  DMARC interoperability issues related to redirecting of\n   messages\
    \ are described in Section 3.2.\n   Sieve [RFC5228] functionality often lives\
    \ in the rMDA sub-component\n   and can cause DMARC interoperability issues. \
    \ The Sieve 'addheader'\n   and 'deleteheader' filtering actions can modify messages\
    \ and\n   invalidate DKIM signatures, removing DKIM-supplied Authenticated\n \
    \  Identifiers as inputs to the DMARC mechanism.  There are also Sieve\n   extensions\
    \ [RFC5703] that modify the body.  Sieve alterations may\n   only become an issue\
    \ when the email is reintroduced into the\n   transport infrastructure.\n"
- title: 3.2.  Mediators
  contents:
  - "3.2.  Mediators\n   Mediators [RFC5598] forward messages through a re-posting\
    \ process.\n   Mediators share some functionality with basic MTA relaying but\
    \ have\n   greater flexibility in both addressing and content modifications.\n\
    \   DMARC interoperability issues are common within the context of\n   Mediators,\
    \ which are often used precisely for their ability to modify\n   messages.\n \
    \  The DMARC design does not cope with some Mediator functionality such\n   as\
    \ content modifications that invalidate DKIM signatures and\n   RFC5321.MailFrom\
    \ rewriting to support SPF authentication of re-sent\n   mail when the new Recipient\
    \ receives the message from the Mediator\n   rather than the initial organization.\n"
- title: 3.2.1.  Alias
  contents:
  - "3.2.1.  Alias\n   An Alias is a simple re-addressing facility that provides one\
    \ or more\n   new Internet Mail addresses, rather than a single, internal one.\
    \  A\n   message continues through the transfer service for delivery to one or\n\
    \   more alternative addresses.\n   Aliases can be implemented by mailbox-level\
    \ forwarding (e.g., through\n   \"dot-forwarding\"), Sieve-level forwarding (through\
    \ the Sieve\n   \"redirect\" action), or other methods.  When an Alias preserves\n\
    \   message content and does not make significant header changes, DKIM\n   signatures\
    \ may remain valid.  However, Aliases often extend the\n   delivery path outside\
    \ of the scope covered by the originating ADMD's\n   SPF record(s).\n   Examples\
    \ of Aliasing include:\n   o  Forwarding email between free email (freemail) providers\
    \ to try\n      different interfaces while maintaining an original email address;\n\
    \   o  Consolidating many email addresses into a single account to\n      centralize\
    \ processing; and\n   o  Services that provide \"activity-based\", \"role-based\"\
    , \"vanity\", or\n      \"temporary\" email addresses such as universities and\
    \ professional\n      associations.  For instance, professional or alumni institutions\n\
    \      may offer their members an Alias for the duration of their\n      membership\
    \ but may not want to deal with the long-term storage of\n      emails.\n   In\
    \ most cases, the aMSA providing Alias services has no\n   administrative relationship\
    \ to the ADMD of the originator or the\n   Final Recipient, so solutions to Alias-related\
    \ DMARC failure should\n   not assume such a relationship.\n"
- title: 3.2.2.  ReSenders
  contents:
  - "3.2.2.  ReSenders\n   ReSenders \"splice\" a message's addressing information\
    \ to connect the\n   Author of the original message with the Recipient(s) of the\
    \ new\n   message.  The new Recipient sees the message as being from the\n   original\
    \ Author, even if the Mediator adds commentary.\n   Without Authenticated Identifiers\
    \ aligned with the Author's\n   RFC5322.From header field domain, the new Recipient\
    \ has no way to\n   achieve a passing DMARC evaluation.\n   Examples of ReSenders\
    \ include MUA-level forwarding by resending a\n   message to a new Recipient or\
    \ by forwarding a message \"inline\" to a\n   new Recipient (this does not include\
    \ forwarding a message \"as an\n   attachment\").  An additional example comes\
    \ in the form of calendaring\n   software that allows a meeting attendee (not\
    \ the meeting organizer)\n   to modify the content of an invite generating new\
    \ invitations that\n   claim to be reissued from the meeting organizer.\n"
- title: 3.2.3.  Mailing Lists
  contents:
  - "3.2.3.  Mailing Lists\n   A Mailing List receives messages as an explicit addressee\
    \ and then\n   reposts them to a list of subscribed members.  The Mailing List\n\
    \   performs a task that can be viewed as an elaboration of the ReSender\n   actions.\n\
    \   Mailing Lists share the same DMARC interoperability issues as\n   ReSenders\
    \ (Section 3.2.2) and very commonly modify headers or message\n   content in ways\
    \ that will cause DKIM to fail, including:\n   o  prepending the RFC5322.Subject\
    \ header field with a tag, to allow\n      the Recipient to easily identify the\
    \ Mailing List within a subject\n      line listing;\n   o  adding a footer to\
    \ the email body to contain administrative\n      instructions;\n   o  removing\
    \ some MIME-parts from the email or converting the message\n      to text only;\n\
    \   o  encrypting the body with the Recipient's key using PGP (Pretty\n      Good\
    \ Privacy) or S/MIME;\n   o  enforcing community standards by rewriting banned\
    \ words; and\n   o  allowing moderators to add arbitrary commentary to messages\n\
    \      (discussed in [RFC6377]).\n   Any such modifications would invalidate a\
    \ DKIM signature.\n   Header and content modifications are common for many Mailing\
    \ Lists\n   and are often central to present Mailing List functionality and\n\
    \   usage.  Furthermore, MUAs have come to rely on Mailing List message\n   modifications\
    \ to present messages to end users in expected ways.\n"
- title: 3.2.3.1.  Mailing List Operational Effects
  contents:
  - "3.2.3.1.  Mailing List Operational Effects\n   Mailing Lists may also have the\
    \ following DMARC interoperability\n   issues:\n   o  Subscribed members may not\
    \ receive email from members that post\n      using domains that publish a DMARC\
    \ \"p=reject\" policy.\n   o  Mailing Lists may interpret DMARC-related email\
    \ rejections as an\n      inability to deliver email to the Recipients that are\
    \ checking and\n      enforcing DMARC policy.  This processing may cause subscribers\n\
    \      that are checking and enforcing DMARC policy to be inadvertently\n    \
    \  suspended or removed from the Mailing List.\n"
- title: 3.2.4.  Gateways
  contents:
  - "3.2.4.  Gateways\n   A Gateway performs the basic routing and transfer work of\
    \ message\n   relaying, but it is also permitted to modify content, structure,\n\
    \   addressing, and/or other attributes as needed to send the message\n   into\
    \ a messaging environment that operates under different standards\n   or potentially\
    \ incompatible policies.\n   Gateways share the same DMARC interoperability issues\
    \ as ReSenders\n   (Section 3.2.2).\n   Gateways may also share the same DMARC\
    \ interoperability issues as\n   MTAs (Section 3.1.2).\n   Receiver systems on\
    \ the non-SMTP side of a protocol Gateway may be\n   unable to evaluate DKIM and\
    \ SPF.  If a message passes through a\n   second protocol Gateway back into the\
    \ SMTP domain, the\n   transformations commonly break the original DKIM signature(s).\n\
    \   Gateway-level forwarding can introduce DMARC interoperability issues\n   if\
    \ the Gateway is configured to rewrite the message into alternate\n   receiving\
    \ domains.  For example, an acquisition may lead an acquiring\n   company to decide\
    \ to decommission the acquired company's domains by\n   rewriting messages to\
    \ use the domain of the acquiring company.  Since\n   the RFC5322.To header field\
    \ is usually DKIM-signed, this kind of\n   rewriting will invalidate such DKIM\
    \ signatures.\n"
- title: 3.2.5.  Boundary Filters
  contents:
  - "3.2.5.  Boundary Filters\n   To enforce security boundaries, organizations can\
    \ subject messages to\n   analysis for conformance with their safety policies.\
    \  A filter might\n   alter the content to render it safe, such as by removing\
    \ or otherwise\n   altering content deemed unacceptable.\n   Boundary Filters\
    \ share the same DMARC interoperability issues as\n   ReSenders.\n   Issues may\
    \ arise with SPF and DKIM evaluation if performed after\n   filter modifications.\n\
    \   Examples of Boundary Filters include:\n   o  Malware scanning: To protect\
    \ readers and its reputation, an MTA\n      that transfers a message may remove\
    \ content believed to be harmful\n      from messages, reformulate content to\
    \ canonical formats in order\n      to make them more trustworthy or easier to\
    \ scan, and/or add text\n      in the body to indicate the message has been scanned.\
    \  Any such\n      modifications would invalidate a DKIM signature.\n   o  Spam\
    \ filtering: To protect its reputation and assist other MTAs,\n      an MTA may\
    \ modify a message to indicate its decision that the\n      message is likely\
    \ to be unwanted and/or add text in the body to\n      indicate that such filtering\
    \ has been done.\n   o  Other text additions: An MTA may add an organizational\
    \ disclaimer\n      or advertisement, for instance.\n   o  URL alteration: Some\
    \ systems will rewrite or alter embedded URLs\n      as a way to control the potential\
    \ threat from malware.\n   o  Secondary MX services: The secondary MX for an organization\
    \ may be\n      external to the normal mail processing for the organization, and\n\
    \      it may queue and forward to the primary when it becomes available.\n  \
    \    This will not invalidate DKIM but will prevent the primary from\n      validating\
    \ SPF normally.  In this case, however, it is\n      inappropriate for a primary\
    \ MX server to perform an SPF check\n      against its own secondaries.  Rather,\
    \ the secondary MX should\n      perform this function and employ some trusted\
    \ mechanism to\n      communicate the results of the SPF, DKIM, and DMARC evaluation(s)\n\
    \      to the primary MX server.\n"
- title: 3.3.  Combinations
  contents:
  - "3.3.  Combinations\n   Indirect email flows can be combined.  For example, a\
    \ university\n   student may subscribe to a Mailing List (using his university\
    \ email\n   address) while this university email address is configured to forward\n\
    \   all emails to a freemail or a post-education corporate account\n   provider\
    \ where a more permanent email address for this student\n   exists.\n   Within\
    \ an organization, the message may pass through various MTAs\n   (Section 3.1.2),\
    \ each of which performs a different function\n   (authentication, filtering,\
    \ distribution, etc.).\n"
- title: 4.  Possible Mitigations of Interoperability Issues
  contents:
  - "4.  Possible Mitigations of Interoperability Issues\n   Solutions to interoperability\
    \ issues between DMARC and indirect email\n   flows vary widely in their scope\
    \ and implications.  They range from\n   improvements to underlying processing,\
    \ such as proper handling of\n   multiple DKIM signatures, to more radical changes\
    \ to the messaging\n   architecture.  This section describes possible ways to\
    \ address\n   interoperability issues.  Note that these particular mechanisms\
    \ may\n   not be considered \"best practices\" and may, in some cases, violate\n\
    \   various conventions or expectations.\n   Receivers sometimes need to deliver\
    \ email messages that do not\n   conform to any standard or protocol, but are\
    \ otherwise desired by end\n   users.  Mitigating the impact of DMARC on indirect\
    \ email flows is\n   especially important to receivers that operate services where\
    \ ease of\n   use and compatibility with existing email flows is a priority.\n\
    \   DMARC provides a mechanism (local policy) for receivers to make\n   decisions\
    \ about identity alignment acceptability based on information\n   outside DMARC\
    \ and communicate those decisions as \"overrides\" to the\n   sender.  This facility\
    \ can be used to ease some interoperability\n   issues, although care is needed\
    \ to ensure that this does not create\n   loopholes for abuse.\n   To further\
    \ complicate the usage of mitigations, mitigation may not be\n   desired if the\
    \ email in question is of a certain category of high\n   value or high risk (security-related)\
    \ transactional messages (dealing\n   with financial transactions or medical records,\
    \ for example).  In\n   these cases, mitigating the impact of DMARC due to indirect\
    \ email\n   flows may not be desirable (counterproductive or allowing for abuse).\n\
    \   As a final note, mail systems are diverse and widely deployed.\n   Systems\
    \ of various ages and capabilities are expected to preserve\n   interoperability\
    \ with the rest of the SMTP ecosystem.  For instance,\n   Qmail is still used,\
    \ although the base code has not been updated\n   since 1998. ezmlm, a once popular\
    \ MLM, is still deployed but has not\n   been updated since 1997, although a new\
    \ version (ezmlm-idx) exists.\n   Old versions of other open- and closed-source\
    \ MTAs are still commonly\n   in operation.  When dealing with aging or unsupported\
    \ systems, some\n   solutions may be time-consuming and/or disruptive to implement.\n"
- title: 4.1.  Mitigations in Current Use
  contents:
  - "4.1.  Mitigations in Current Use\n   Because DMARC is already widely deployed,\
    \ many operators already have\n   mitigations in use.  These mitigations vary\
    \ in their effectiveness\n   and side effects but have the advantage that they\
    \ are currently\n   available.\n"
- title: 4.1.1.  Mitigations for Senders
  contents:
  - '4.1.1.  Mitigations for Senders

    '
- title: 4.1.1.1.  Identifier Alignment
  contents:
  - "4.1.1.1.  Identifier Alignment\n   o  MTAs handling multiple domains may choose\
    \ to change\n      RFC5321.MailFrom to align with RFC5322.From to improve SPF\n\
    \      usability for DMARC.\n   o  MTAs handling multiple domains may also choose\
    \ to align\n      RFC5321.HELO/.EHLO to RFC5322.From, particularly when sending\n\
    \      notification messages.  Dynamically adjusting the\n      RFC5321.HELO/.EHLO\
    \ based on the RFC5322.From may not be possible\n      for some MTA software.\n\
    \   o  MTAs may choose to DKIM-sign notification messages with an aligned\n  \
    \    domain to allow a DKIM-based DMARC pass.\n   o  MTAs sending email on behalf\
    \ of multiple domains may require\n      Domain Owners to provide DKIM keys to\
    \ use DKIM to avoid SPF\n      validation issues, given the requirement for DMARC\
    \ alignment with\n      the RFC5322.From header field.  Managing DKIM keys with\
    \ a third\n      party has security risks that should be carefully managed (see\n\
    \      also [RFC6376], Section 8).  Methods involving CNAMEs and/or\n      subdomains\
    \ may alleviate some risks.\n   o  Senders who are sending on behalf of users\
    \ in other administrative\n      domains may choose to use an RFC5322.From under\
    \ the sender's\n      control.  The new From can be either a forwarding address\
    \ in a\n      domain controlled by the Sender or a placeholder address, with the\n\
    \      original user's address in an RFC5322.Reply-to header field.\n      However,\
    \ performing this modification may cause the Recipient's\n      MUA to deviate\
    \ from customary behavior.\n   o  When implementing \"forward-to-friend\" functionality,\
    \ one approach\n      to avoid DMARC failures is to pass a well-formed message\
    \ to the\n      user's MUA so that it may fill in an appropriate identity and\n\
    \      submit through its own MSA.\n   o  Senders can use domains with distinct\
    \ DMARC policies for email\n      sent directly and email known to use indirect\
    \ mail flows.\n      However, for most well-known brands, all active domains are\
    \ likely\n      to be targeted equally by abusers.\n"
- title: 4.1.1.2.  Message Modification
  contents:
  - "4.1.1.2.  Message Modification\n   o  Senders can maximize survivability of DKIM\
    \ signatures by limiting\n      the header fields they sign and using relaxed\
    \ canonicalization.\n      Using the DKIM length tag to allow appended signatures\
    \ is\n      discouraged due to the security risk created by allowing arbitrary\n\
    \      content to be appended to legitimate email.\n   o  Senders can also maximize\
    \ survivability by starting with RFC-\n      compliant headers and common body\
    \ formats.\n   o  In order to minimize transport-based conversions, Senders can\n\
    \      convert messages to a lowest denominator MIME content-transfer\n      encoding\
    \ such as quoted-printable or base64 before signing\n      ([RFC6376], Section\
    \ 5.3).\n"
- title: 4.1.2.  Mitigations for Receivers
  contents:
  - '4.1.2.  Mitigations for Receivers

    '
- title: 4.1.2.1.  Identifier Alignment
  contents:
  - "4.1.2.1.  Identifier Alignment\n   o  Receivers should update DKIM handling libraries\
    \ to ensure that\n      they process all valid DKIM signatures and check each\
    \ signature\n      for alignment.\n"
- title: 4.1.2.2.  Policy Override
  contents:
  - "4.1.2.2.  Policy Override\n   o  Receivers can amalgamate data from their user\
    \ base to create lists\n      of forwarders and use such lists to inform DMARC\
    \ local policy\n      overrides.  This process may be easier for large receivers\
    \ where\n      data and resources to create such lists are more readily available\n\
    \      than at smaller sites, where there are fewer accounts that receive\n  \
    \    forwarded mail and other resources may be scarce.\n"
- title: 4.1.3.  Mitigations for ReSenders
  contents:
  - '4.1.3.  Mitigations for ReSenders

    '
- title: 4.1.3.1.  Changes to the RFC5322.From
  contents:
  - "4.1.3.1.  Changes to the RFC5322.From\n   Many ReSender issues can be avoided\
    \ by using an RFC5322.From header\n   field under the ReSender's control, instead\
    \ of the initial\n   RFC5322.From.  This will correct Identifier Alignment issues\
    \ and\n   allow arbitrary message modification as long as the ReSender signs\n\
    \   the message with an aligned domain signature.  When ReSenders change\n   the\
    \ RFC5322.From, it is desirable to preserve the information about\n   the original\
    \ initiator of the message.\n   A first option is to use the Original-From [RFC5703]\
    \ (or X-Original-\n   From) header field for this purpose in various contexts\
    \ (X- header\n   field names are discouraged by [RFC6648]).  However, handling\
    \ of\n   Original-From (or X-Original-From) is not defined anywhere.  It is\n\
    \   not currently used consistently or displayed to the user, and in any\n   situation\
    \ where it is used, it is a new unauthenticated identifier\n   available for exploitation\
    \ unless included within the scope of the\n   new DKIM signature(s).\n   Another\
    \ option for ReSenders is to rewrite the RFC5322.From header\n   field address\
    \ to a locally controlled address that will be forwarded\n   back to the original\
    \ sender (subject to its own ReSender forwarding\n   mitigations).\n"
- title: 4.1.3.2.  Avoiding Message Modification
  contents:
  - "4.1.3.2.  Avoiding Message Modification\n   o  Forwarders can choose to add email\
    \ header fields instead of\n      modifying existing headers or bodies, for instance,\
    \ to indicate a\n      message may be spam.\n   o  Forwarders can minimize the\
    \ circumstances in which they choose to\n      fix messages, preferring to preserve\
    \ non-compliant headers to\n      creating DKIM failures.\n   o  Forwarders can\
    \ choose to reject messages with suspect or harmful\n      content instead of\
    \ modifying them.\n"
- title: 4.1.3.3.  Mailing Lists
  contents:
  - "4.1.3.3.  Mailing Lists\n   [RFC6377] provides some guidance on using DKIM with\
    \ Mailing lists.\n   The following mitigation techniques can be used to ease\n\
    \   interoperability issues with DMARC and Mailing lists:\n   o  Configuring the\
    \ Mailing List Manager (MLM) to alter the\n      RFC5322.From header field to\
    \ use the domain of the MLM is a\n      mitigation policy that is now present\
    \ in several different Mailing\n      List software distributions.  Since most\
    \ list subscribers prefer\n      to know the identity of the Author of the original\
    \ message,\n      typically this information may be provided in the display name\n\
    \      part of the RFC5322.From header field.  This display name needs to\n  \
    \    be carefully crafted so as to not collide with the original\n      display\
    \ name of the Author, nor contain something that looks like\n      an email address\
    \ or domain name.  These modifications may to some\n      extent defeat the purpose\
    \ of DMARC itself.  It may make it\n      difficult to ensure that users of all\
    \ email clients can easily\n      reply to the Author, the list, or all using\
    \ the email client\n      features provided for that purpose.  Use of the RFC5322.Reply-To\n\
    \      header field can alleviate this problem depending on whether the\n    \
    \  Mailing List is configured to reply-to-list, reply-to-author, or\n      reply-to-fixed-address;\
    \ however, it is important to note that this\n      header field can take multiple\
    \ email addresses.  When altering the\n      RFC5322.From, there are three possibilities:\n\
    \      1.  change it to put the Mailing List email address,\n      2.  change\
    \ it to a locally defined address that will be forwarded\n          back to the\
    \ original sender, or\n      3.  \"break\" the address by modifying the domain\
    \ to a non-existent\n          domain (such as by adding a suffix like \".invalid\"\
    ).\n      The latter modification may create issues because it is an invalid\n\
    \      domain name, and some MTAs may pay particular attention to the\n      validity\
    \ of email addresses in RFC5322.From and the reputation of\n      the domains\
    \ present there.\n   o  Configuring the MLM to \"wrap\" the message in a MIME\
    \ message/rfc822\n      part and to send as the Mailing List email address.  Many\
    \ email\n      clients (as of the publication of this document), especially\n\
    \      mobile clients, have difficulty reading such messages, and this is\n  \
    \    not expected to change soon.\n   o  Configuring the MLM to not modify the\
    \ message so that the DKIM\n      signature remains valid.  Some Mailing Lists\
    \ are set up this way\n      and require few additional changes to ensure the\
    \ DKIM signature is\n      preserved.  Moving lists that currently modify mail\
    \ to a policy\n      like this may be too much of a change for the members of\
    \ such\n      lists.\n   o  Rejecting posts or membership requests from domains\
    \ with a DMARC\n      policy other than \"p=none\".  However, members or potential\
    \ members\n      of such Mailing Lists may complain of unfair exclusion.\n   o\
    \  To alleviate unsubscribes to the Mailing List due to the messages\n      bouncing\
    \ because of DMARC, the MLM needs to not act on\n      notification messages due\
    \ to message authentication issues.\n      [RFC3463] specifies Enhanced Mail System\
    \ Status Codes, which help\n      differentiate between various failure conditions.\
    \  Correctly\n      interpreting Extended SMTP error messages is useful in this\
    \ case.\n      In particular, extended status codes for SPF and DKIM causes are\n\
    \      defined in [RFC7372], and DMARC-related failure indications are\n     \
    \ discussed in DMARC ([RFC7489], Section 10.3).\n   All these techniques may provide\
    \ some specific challenges to MUAs and\n   different operational usages for end\
    \ users (like rewriting filters to\n   sort emails in folders).  There will be\
    \ some time before all\n   implications are understood and accommodated.\n"
- title: 4.2.  Proposed and In-Progress Mitigations
  contents:
  - "4.2.  Proposed and In-Progress Mitigations\n   The following mitigations are\
    \ based on Internet-Drafts (I-Ds) that\n   are still in process.  They are described\
    \ here to offer an\n   exploratory path for solutions.  These solutions should\
    \ not be used\n   in a production environment.  Because of the transient nature\
    \ of\n   I-Ds, specific citations are not included because a number of them\n\
    \   will inevitably become obsolete, and those that gain consensus in the\n  \
    \ community will become RFCs and should be discovered as such.\n   o  Third-party\
    \ authorization schemes provide ways to extend\n      Identifier Alignment under\
    \ control of the Domain Owner.\n   o  Ways to canonicalize messages that transit\
    \ Mailing Lists so that\n      their alterations can be isolated from the original\
    \ signed\n      content.\n   o  Mechanisms to record message transformations applied\
    \ at each hop\n      so they can be reversed and the original signed content recovered.\n\
    \   o  \"Conditional\" DKIM signatures, whereby the Author domain indicates\n\
    \      its signature is only good if accompanied by a signature from an\n    \
    \  expected downstream relay.\n   o  Mechanisms to extend Authentication-Results\
    \ [RFC7601] to multiple\n      hops, creating a provable chain of custody as well\
    \ as a view of\n      message authentication results at each handling step.\n"
- title: '4.2.1.  Getting More Radical: Requiring New Communication Paths between'
  contents:
  - "4.2.1.  Getting More Radical: Requiring New Communication Paths between\n   \
    \     MUAs\n   In practice, a number of operators are using strict alignment mode\
    \ in\n   DMARC in order to avoid receiving new and innovative forms of\n   unwanted\
    \ and unauthentic email through systems purporting to be\n   Mailing List handlers.\
    \  The receiving ADMD has no knowledge of which\n   lists the user has subscribed\
    \ to and which they have not.  One avenue\n   of exploration would be for the\
    \ user to authorize Mailing Lists as\n   proxies for authentication, at which\
    \ point the receiving ADMD would\n   be vesting some trust in the Mailing List\
    \ service.  The creators of\n   DKIM foresaw precisely this possibility at the\
    \ time by not tightly\n   binding any semantics to the RFC5322.From header field.\
    \  Some\n   experimental work has taken place in this area, as mentioned above.\n\
    \   Additional work might examine a new communication path to the user to\n  \
    \ authorize some form of transitive trust.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   This document is an analysis of DMARC's impact\
    \ on indirect email\n   flows.  It describes the possibility of accidental denial\
    \ of service\n   that can be created by rejections of messages by DMARC-aware\
    \ mail\n   receivers.\n   Section 4.1.1.1 discusses the importance of appropriate\
    \ DKIM key\n   management vis-a-vis third-party email senders.\n   Section 4.1.3.3\
    \ warns that rewriting the RFC5322.From header field to\n   create an artificial\
    \ domain name should not be done with any domain.\n"
- title: 6.  References
  contents:
  - '6.  References

    '
- title: 6.1.  Normative References
  contents:
  - "6.1.  Normative References\n   [RFC2045]  Freed, N. and N. Borenstein, \"Multipurpose\
    \ Internet Mail\n              Extensions (MIME) Part One: Format of Internet\
    \ Message\n              Bodies\", RFC 2045, DOI 10.17487/RFC2045, November 1996,\n\
    \              <http://www.rfc-editor.org/info/rfc2045>.\n   [RFC3463]  Vaudreuil,\
    \ G., \"Enhanced Mail System Status Codes\",\n              RFC 3463, DOI 10.17487/RFC3463,\
    \ January 2003,\n              <http://www.rfc-editor.org/info/rfc3463>.\n   [RFC5228]\
    \  Guenther, P., Ed. and T. Showalter, Ed., \"Sieve: An Email\n              Filtering\
    \ Language\", RFC 5228, DOI 10.17487/RFC5228,\n              January 2008, <http://www.rfc-editor.org/info/rfc5228>.\n\
    \   [RFC5321]  Klensin, J., \"Simple Mail Transfer Protocol\", RFC 5321,\n   \
    \           DOI 10.17487/RFC5321, October 2008,\n              <http://www.rfc-editor.org/info/rfc5321>.\n\
    \   [RFC5322]  Resnick, P., Ed., \"Internet Message Format\", RFC 5322,\n    \
    \          DOI 10.17487/RFC5322, October 2008,\n              <http://www.rfc-editor.org/info/rfc5322>.\n\
    \   [RFC5598]  Crocker, D., \"Internet Mail Architecture\", RFC 5598,\n      \
    \        DOI 10.17487/RFC5598, July 2009,\n              <http://www.rfc-editor.org/info/rfc5598>.\n\
    \   [RFC5703]  Hansen, T. and C. Daboo, \"Sieve Email Filtering: MIME Part\n \
    \             Tests, Iteration, Extraction, Replacement, and Enclosure\",\n  \
    \            RFC 5703, DOI 10.17487/RFC5703, October 2009,\n              <http://www.rfc-editor.org/info/rfc5703>.\n\
    \   [RFC6376]  Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,\n   \
    \           \"DomainKeys Identified Mail (DKIM) Signatures\", STD 76,\n      \
    \        RFC 6376, DOI 10.17487/RFC6376, September 2011,\n              <http://www.rfc-editor.org/info/rfc6376>.\n\
    \   [RFC6377]  Kucherawy, M., \"DomainKeys Identified Mail (DKIM) and\n      \
    \        Mailing Lists\", BCP 167, RFC 6377, DOI 10.17487/RFC6377,\n         \
    \     September 2011, <http://www.rfc-editor.org/info/rfc6377>.\n   [RFC6648]\
    \  Saint-Andre, P., Crocker, D., and M. Nottingham,\n              \"Deprecating\
    \ the \"X-\" Prefix and Similar Constructs in\n              Application Protocols\"\
    , BCP 178, RFC 6648,\n              DOI 10.17487/RFC6648, June 2012,\n       \
    \       <http://www.rfc-editor.org/info/rfc6648>.\n   [RFC7208]  Kitterman, S.,\
    \ \"Sender Policy Framework (SPF) for\n              Authorizing Use of Domains\
    \ in Email, Version 1\", RFC 7208,\n              DOI 10.17487/RFC7208, April\
    \ 2014,\n              <http://www.rfc-editor.org/info/rfc7208>.\n   [RFC7372]\
    \  Kucherawy, M., \"Email Authentication Status Codes\",\n              RFC 7372,\
    \ DOI 10.17487/RFC7372, September 2014,\n              <http://www.rfc-editor.org/info/rfc7372>.\n"
- title: 6.2.  Informative References
  contents:
  - "6.2.  Informative References\n   [RFC7489]  Kucherawy, M., Ed. and E. Zwicky,\
    \ Ed., \"Domain-based\n              Message Authentication, Reporting, and Conformance\n\
    \              (DMARC)\", RFC 7489, DOI 10.17487/RFC7489, March 2015,\n      \
    \        <http://www.rfc-editor.org/info/rfc7489>.\n   [RFC7601]  Kucherawy, M.,\
    \ \"Message Header Field for Indicating\n              Message Authentication\
    \ Status\", RFC 7601,\n              DOI 10.17487/RFC7601, August 2015,\n    \
    \          <http://www.rfc-editor.org/info/rfc7601>.\n"
- title: Appendix A.  Example SPF Bounce
  contents:
  - "Appendix A.  Example SPF Bounce\n   This example illustrates a notification message\
    \ \"bounce\".\n"
- title: A.1.  Initial Message
  contents:
  - "A.1.  Initial Message\n   Here is the message as it exits the Origin MTA (segv.d1.example):\n\
    \ Return-Path: <jqd@d1.example>\n Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com\
    \ [w.x.y.z])\n     (authenticated bits=0)\n     by segv.d1.example with ESMTP\
    \ id t0FN4a8O084569;\n     Thu, 14 Jan 2015 15:00:01 -0800 (PST)\n DKIM-Signature:\
    \ v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;\n     s=20130426; t=1421363082;\n\
    \     bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;\n     h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:\n\
    \      Content-Transfer-Encoding;\n     b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw\n\
    \      bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl\n  \
    \    gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=\n Message-ID: <54B84785.1060301@d1.example>\n\
    \ Date: Thu, 14 Jan 2015 15:00:01 -0800\n From: John Q Doe <jqd@d1.example>\n\
    \ To: no-recipient@dmarc.org\n Subject: Example 1\n Hey gang,\n This is a test\
    \ message.\n --J.\n"
- title: A.2.  Notification Message
  contents:
  - "A.2.  Notification Message\n   When dmarc.org rejects the message without a DKIM\
    \ signature, it\n   specifies the RFC5321.HELO/.EHLO domain as dmarc.org.local,\
    \ which has\n   no SPF record. dmarc.org has a reject policy in place for such\
    \ non-\n   passing cases.  Since there is no DKIM signature on the notification\n\
    \   message, the failed SPF lookup results in a dmarc=fail, and\n   d1.example\
    \ could be expected to discard the notification message\n   itself:\n Return-Path:\
    \ <>\n Received: from dmarc.org.local (mail.dmarc.org. [192.0.2.1])\n    by mx.d1.example\
    \ with ESMTPS id Lkm25302jJR5\n    for <jqd@d1.example>\n    (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256\
    \ bits=128/128);\n    Thu, 14 Jan 2015 15:00:24 -0800 (PST)\n Authentication-Results:\
    \ mx.d1.example;\n    spf=none (d1.example: dmarc.org.local does not designate\n\
    \    permitted sender hosts) smtp.mail=;\n    dmarc=fail (p=REJECT dis=NONE) header.from=dmarc.org\n\
    \ MIME-Version: 1.0\n Received: from segv.d1.example (segv.d1.example [198.51.100.1])\n\
    \  by 192.0.2.2 with SMTP id u67mr102828634qge33; Thu,\n  14 Jan 2015 15:00:24\
    \ -0800 (PST)\n From: Mail Delivery Subsystem <mailer-daemon@dmarc.org>\n To:\
    \ jqd@d1.example\n Subject: Delivery Status Notification (Failure)\n Message-ID:\
    \ <001a11c16e6a9ead220528df294a@dmarc.org>\n Date: Thu, 14 Jan 2016 23:00:24 +0000\n\
    \ Content-Type: text/plain; charset=UTF-8\n This is an automatically generated\
    \ Delivery Status Notification\n Delivery to the following recipient failed permanently:\n\
    \      no-recipient@dmarc.org\n Technical details of permanent failure:\n Your\
    \ message was rejected by the server for the recipient domain\n   dmarc.org by\
    \ mail.dmarc.org [192.0.2.1].\n The error that the other server returned was:\n\
    \ 550 5.1.1 <no-recipient@dmarc.org>... User unknown\n ----- Original message\
    \ -----\n Return-Path: <jqd@d1.example>\n Received: from [203.252.0.131] (131-0-252-203-dsl.static.example.com\n\
    \     [203.252.0.131]) (authenticated bits=0)\n     by segv.d1.example with ESMTP\
    \ id t0FN4a8O084569;\n     Thu, 14 Jan 2015 15:00:01 -0800 (PST)\n     (envelope-from\
    \ jqd@d1.example)\n DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;\n\
    \     s=20130426; t=1421363082;\n     bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;\n\
    \     h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:\n      Content-Transfer-Encoding;\n\
    \     b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw\n  \
    \    bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl\n    \
    \  gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=\n Message-ID: <54B84785.1060301@d1.example>\n\
    \ Date: Thu, 14 Jan 2015 15:00:01 -0800\n From: John Q Doe <jqd@d1.example>\n\
    \ To: no-recipient@dmarc.org\n Subject: Example 1\n Hey gang,\n This is a test\
    \ message.\n --J.\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   Miles Fidelman, John Levine, David Crocker, Stephen J. Turnbull,\
    \ Rolf\n   E. Sonneveld, Tim Draegen, and Franck Martin contributed to the IETF\n\
    \   DMARC Working Group's wiki page listing all known interoperability\n   issues\
    \ with DMARC and indirect email flows.\n   Tim Draegen created the first draft\
    \ of this document from these\n   contributions and by ham-fistedly mapping contributions\
    \ into the\n   language of [RFC5598].\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Franck Martin (editor)\n   LinkedIn\n   Mountain View,\
    \ CA\n   United States of America\n   Email: fmartin@linkedin.com\n   Eliot Lear\
    \ (editor)\n   Cisco Systems GmbH\n   Richtistrasse 7\n   Wallisellen, ZH  CH-8304\n\
    \   Switzerland\n   Phone: +41 44 878 9200\n   Email: lear@cisco.com\n   Tim Draegen\
    \ (editor)\n   dmarcian, inc.\n   PO Box 1007\n   Brevard, NC  28712\n   United\
    \ States of America\n   Email: tim@dmarcian.com\n   Elizabeth Zwicky (editor)\n\
    \   Yahoo\n   Sunnyvale, CA\n   United States of America\n   Email: zwicky@yahoo-inc.com\n\
    \   Kurt Andersen (editor)\n   LinkedIn\n   2029 Stierlin Court\n   Mountain View,\
    \ CA  94043\n   United States of America\n   Email: kandersen@linkedin.com\n"
