- title: __initial_text__
  contents:
  - "                 The Session Initiation Protocol (SIP)\n               P-User-Database\
    \ Private-Header (P-Header)\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies the Session Initiation Protocol (SIP)\n\
    \   P-User-Database Private-Header (P-header).  This header field is used\n  \
    \ in the 3rd-Generation Partnership Project (3GPP) IMS (IP Multimedia\n   Subsystem)\
    \ to provide SIP registrars and SIP proxy servers with the\n   address of the\
    \ database that contains the user profile of the user\n   that generated a particular\
    \ request.\n"
- title: Table of Contents
  contents:
  - 'Table of Contents

    '
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The 3rd-Generation Partnership Project (3GPP) IMS (IP Multimedia\n\
    \   Subsystem) uses the Session Initiation Protocol (SIP) [2] as its main\n  \
    \ signalling protocol.  (For more information on the IMS, a detailed\n   description\
    \ can be found in 3GPP TS 23.228 [5] and 3GPP TS 24.229\n   [6].) 3GPP has identified\
    \ a set of requirements that can be met,\n   according to the procedures in RFC\
    \ 3427 [3], by defining a new SIP\n   Private-Header (P-header).\n   The remainder\
    \ of this document is organized as follows.  Section 2\n   describes the scenarios\
    \ considered by 3GPP and Section 3 discusses\n   the requirements derived from\
    \ these scenarios.  Section 4 defines the\n   P-User-Database header field, which\
    \ meets those requirements, and\n   Section 5 discusses the applicability and\
    \ scope of this new header\n   field.  Section 6 registers the P-User-Database\
    \ header field with the\n   IANA and Section 7 discusses the security properties\
    \ of the\n   environment where this header field is intended to be used.\n"
- title: 2.  Scenarios
  contents:
  - "2.  Scenarios\n   In the 3GPP IMS, there are two scenarios where a set of proxies\n\
    \   handling a request need to consult the same user database.  These\n   scenarios\
    \ consist of a user registering to the IMS network and an\n   unregistered user\
    \ receiving an incoming request that triggers a\n   service (e.g., a voice mail\
    \ service).\n"
- title: 2.1.  User Registering to the IMS
  contents:
  - "2.1.  User Registering to the IMS\n   In the 3GPP IMS, SIP REGISTER requests\
    \ generated by a User Agent (UA)\n   traverse a set of SIP proxy servers before\
    \ reaching the SIP\n   registrar.  A REGISTER request sent by a UA is routed to\
    \ the outbound\n   proxy of the UA, which is referred to as the P-CSCF (Proxy-\n\
    \   Call/Session Control Function).\n   The P-CSCF routes the REGISTER request\
    \ to another proxy, which is\n   referred to as the I-CSCF (Interrogating-CSCF)\
    \ and is always located\n   in the home domain of the user.  The I-CSCF consults\
    \ the user\n   database of the domain, which is referred to as the Home Subscriber\n\
    \   Server (HSS), in order to choose the registrar that will process the\n   REGISTER\
    \ request.\n   With the information received from the HSS, the I-CSCF routes the\n\
    \   REGISTER request to the appropriate registrar, which is referred to\n   as\
    \ the S-CSCF (Serving-CSCF).  At this point, the S-CSCF needs to\n   contact the\
    \ same HSS that was previously contacted by the I-CSCF in\n   order to fetch the\
    \ user profile of the user that generated the\n   REGISTER request.\n   The interface\
    \ between the I-CSCF and the HSS and between the S-CSCF\n   and the HSS is called\
    \ Cx interface and is based on Diameter [4].\n   When there is a single HSS (i.e.,\
    \ user database) handling all the\n   users in the domain, both the I-CSCF and\
    \ the S-CSCF can be configured\n   with its address so that they contact it when\
    \ necessary.  However,\n   some domains have several HSSs, each of which handles\
    \ a particular\n   set of users.  When dealing with a REGISTER request, the I-CSCF\
    \ and\n   the S-CSCF need to discover which is the HSS that contains the\n   profile\
    \ of the user that generated the REGISTER request.\n   In networks with more than\
    \ one HSS, a Diameter redirect agent\n   referred to as the Subscription Locator\
    \ Function (SLF) is\n   implemented.  The interface between the I-CSCF and the\
    \ SLF and\n   between the S-CSCF and the SLF is called Dx interface and, like\
    \ the\n   CX interface, is based on Diameter.  The SLF provides the I-CSCF and\n\
    \   the S-CSCF with the address of the HSS that handles the user they are\n  \
    \ dealing with.\n   Therefore, in a network with more than one HSS, the SLF is\
    \ consulted\n   twice per REGISTER request, first by the I-CSCF, and later by\
    \ the\n   S-CSCF.  If the I-CSCF could provide the S-CSCF with the address of\n\
    \   the HSS handling the user that generated the REGISTER request, the\n   S-CSCF\
    \ could contact directly that HSS.  That is, the S-CSCF would\n   not need to\
    \ contact the SLF in order to obtain the address of the\n   HSS.\n"
- title: 2.2.  Incoming Request for an Unregistered User
  contents:
  - "2.2.  Incoming Request for an Unregistered User\n   In the 3GPP IMS, incoming\
    \ requests for a user traverse an I-CSCF in\n   the home domain of the user. \
    \ This I-CSCF consults the HSS, using the\n   Diameter-based Cx interface, in\
    \ order to decide which S-CSCF should\n   handle the request.  After consulting\
    \ the HSS, the I-CSCF forwards\n   the request to a S-CSCF, which is also located\
    \ in the home domain of\n   the user.\n   If the user the request is addressed\
    \ to is registered to the IMS\n   network, the S-CSCF receiving the request knows\
    \ which HSS handles the\n   user.  The S-CSCF stored this information when the\
    \ user registered.\n   However, if the user is not registered, the S-CSCF needs\
    \ to consult\n   the SLF (assuming more than one HSS in the network) in order\
    \ to\n   discover the HSS handling the user.\n   Therefore, like in the previous\
    \ scenario, in a network with more than\n   one HSS, the SLF is consulted twice\
    \ per incoming request addresses to\n   an unregistered user.  First by the I-CSCF,\
    \ and later by the S-CSCF.\n   If the I-CSCF could provide the S-CSCF with the\
    \ address of the HSS\n   handling the user that generated the request, the S-CSCF\
    \ could\n   contact directly that HSS.  That is, the S-CSCF would not need to\n\
    \   contact the SLF in order to obtain the address of the HSS.\n"
- title: 3.  Requirements
  contents:
  - "3.  Requirements\n   This section lists the requirements derived from the previous\n\
    \   scenarios:\n   1.  It is necessary to optimize the registration process in\
    \ the 3GPP\n       IMS by reducing the time it takes for a UA to register to the\
    \ IMS\n       network.\n   2.  It is necessary to optimize the handling of incoming\
    \ requests to\n       unregistered users in the 3GPP IMS by reducing the time\
    \ it takes\n       for a domain to handle these requests.\n   3.  It is necessary\
    \ to improve the scalability of SLFs in the 3GPP\n       IMS by reducing the amount\
    \ of traffic the SLF of a network needs\n       to handle.\n"
- title: 4.  P-User-Database Header Field Definition
  contents:
  - "4.  P-User-Database Header Field Definition\n   This document defines the SIP\
    \ P-User-Database P-header.  This header\n   field can be added to requests routed\
    \ from an I-CSCF to an S-CSCF.\n   The P-User-Database P-header contains the address\
    \ of the HSS handling\n   the user that generated the request.\n   The augmented\
    \ Backus-Naur Form (BNF) [1] syntax of the P-User-\n   Database header field is\
    \ the following:\n   P-User-Database     = \"P-User-Database\" HCOLON database\n\
    \                         *( SEMI generic-param )\n   database            = LAQUOT\
    \ DiameterURI RAQUOT\n   DiameterURI is defined in RFC 3588 [4].  HCOLON, LAQUOT,\
    \ RAQUOT, and\n   generic-param are defined in RFC 3261 [2].\n   The following\
    \ is an example of a P-User-Database header field:\n   P-User-Database: <aaa://host.example.com;transport=tcp>\n"
- title: 5.  Applicability
  contents:
  - "5.  Applicability\n   According to RFC 3427 [3], P-headers have a limited applicability.\n\
    \   Specifications of P-headers such as this RFC need to clearly document\n  \
    \ the useful scope of the proposal, and explain its limitations and why\n   it\
    \ is not suitable for the general use of SIP on the Internet.\n   The P-User-Database\
    \ header field is intended to be used in 3GPP IMS\n   networks.  This header field\
    \ carries the address of a user database,\n   which is referred to as HSS, between\
    \ two proxies, which are referred\n   to as I-CSCF and S-CSCF.  The I-CSCF and\
    \ the S-CSCF belong to the\n   same administrative domain and share a common frame\
    \ of reference to\n   the user database.  The I-CSCF inserts the P-User-Database\
    \ header\n   field into a SIP request and the S-CSCF removes it before routing\
    \ the\n   request further.\n   When SIP is used on the Internet, there are typically\
    \ no proxies\n   querying a user database between the UA sending a REGISTER request\n\
    \   and the registrar.  Consequently, the P-User-Database header field\n   does\
    \ not seem useful in a general Internet environment.\n"
- title: 6.  IANA Considerations
  contents:
  - "6.  IANA Considerations\n   This document defines a new SIP header field: P-User-Database.\
    \  This\n   header field has been registered by the IANA in the SIP Parameters\n\
    \   registry under the Header Fields subregistry.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   The P-User-Database defined in this document\
    \ is to be used in an\n   environment where elements are trusted and where attackers\
    \ are not\n   supposed to have access to the protocol messages between those\n\
    \   elements.  Traffic protection between network elements is sometimes\n   achieved\
    \ by using IP Security (IPsec) and sometimes by physically\n   protecting the\
    \ network.  In any case, the environment where the\n   P-User-Database header\
    \ field will be used ensures the integrity and\n   the confidentiality of the\
    \ contents of this header field.\n   There is a slight security risk if a P-User-Database\
    \ header field is\n   allowed to propagate out of the administrative domain where\
    \ it was\n   generated.  No user-sensitive information would be revealed by such\
    \ a\n   breach, but this could result in disclosure of information about the\n\
    \   topology of the operator network that goes beyond the level of\n   disclosure\
    \ explicit in SIP messages without this extension.\n   Consequently, operators\
    \ need to ensure that the P-User-Database\n   header field is removed from requests\
    \ before these are sent to\n   another administrative domain.\n"
- title: 8.  Acknowledgements
  contents:
  - "8.  Acknowledgements\n   Nuria Esteban, Stephen Terrill, and Jeroen van Bemmel\
    \ provided\n   comments on this document.  Dean Willis performed a thorough review\n\
    \   of this document.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [1]  Crocker, D. and P. Overell, \"Augmented BNF\
    \ for Syntax\n        Specifications: ABNF\", RFC 4234, October 2005.\n   [2]\
    \  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,\n        Peterson,\
    \ J., Sparks, R., Handley, M., and E. Schooler, \"SIP:\n        Session Initiation\
    \ Protocol\", RFC 3261, June 2002.\n   [3]  Mankin, A., Bradner, S., Mahy, R.,\
    \ Willis, D., Ott, J., and B.\n        Rosen, \"Change Process for the Session\
    \ Initiation Protocol\n        (SIP)\", BCP 67, RFC 3427, December 2002.\n   [4]\
    \  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko,\n        \"\
    Diameter Base Protocol\", RFC 3588, September 2003.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [5]  3GPP, \"IP Multimedia Subsystem (IMS);\
    \ Stage 2\", 3GPP TS 23.228\n        5.14.0, October 2005.\n   [6]  3GPP, \"Internet\
    \ Protocol (IP) multimedia call control protocol\n        based on Session Initiation\
    \ Protocol (SIP) and Session\n        Description Protocol (SDP); Stage 3\", 3GPP\
    \ TS 24.229 5.14.0,\n        October 2005.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Gonzalo Camarillo\n   Ericsson\n   Hirsalantie 11\n  \
    \ Jorvas  02420\n   Finland\n   EMail: Gonzalo.Camarillo@ericsson.com\n   German\
    \ Blanco\n   Ericsson\n   Via de los Poblados 13\n   Madrid  28035\n   Spain\n\
    \   EMail: german.blanco@ericsson.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
