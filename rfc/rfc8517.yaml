- title: __initial_text__
  contents:
  - ''
- title: Independent Submission                                    D. Dolson, Ed.
  contents:
  - "Independent Submission                                    D. Dolson, Ed.\n  An\
    \ Inventory of Transport-Centric Functions Provided by Middleboxes:\n        \
    \                An Operator Perspective\n"
- title: Abstract
  contents:
  - "Abstract\n   This document summarizes an operator's perception of the benefits\n\
    \   that may be provided by intermediary devices that execute functions\n   beyond\
    \ normal IP forwarding.  Such intermediary devices are often\n   called \"middleboxes\"\
    .\n   RFC 3234 defines a taxonomy of middleboxes and issues in the\n   Internet.\
    \  Most of those middleboxes utilize or modify application-\n   layer data.  This\
    \ document primarily focuses on devices that observe\n   and act on information\
    \ carried in the transport layer, and especially\n   information carried in TCP\
    \ packets.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This is a contribution to\
    \ the RFC Series, independently of any other\n   RFC stream.  The RFC Editor has\
    \ chosen to publish this document at\n   its discretion and makes no statement\
    \ about its value for\n   implementation or deployment.  Documents approved for\
    \ publication by\n   the RFC Editor are not candidates for any level of Internet\
    \ Standard;\n   see Section 2 of RFC 7841.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   https://www.rfc-editor.org/info/rfc8517.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2019 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   3\n     1.1.  Operator Perspective  . . . . . . . . . . . . . .\
    \ . . . .   3\n     1.2.  Scope . . . . . . . . . . . . . . . . . . . . . . .\
    \ . . .   4\n   2.  Measurements  . . . . . . . . . . . . . . . . . . . . . .\
    \ . .   5\n     2.1.  Packet Loss . . . . . . . . . . . . . . . . . . . . . .\
    \ .   5\n     2.2.  Round-Trip Times  . . . . . . . . . . . . . . . . . . . .\
    \   6\n     2.3.  Measuring Packet Reordering . . . . . . . . . . . . . . .  \
    \ 6\n     2.4.  Throughput and Bottleneck Identification  . . . . . . . .   7\n\
    \     2.5.  Congestion Responsiveness . . . . . . . . . . . . . . . .   7\n  \
    \   2.6.  Attack Detection  . . . . . . . . . . . . . . . . . . . .   8\n    \
    \ 2.7.  Packet Corruption . . . . . . . . . . . . . . . . . . . .   8\n     2.8.\
    \  Application-Layer Measurements  . . . . . . . . . . . . .   9\n   3.  Functions\
    \ beyond Measurement: A Few Examples  . . . . . . . .   9\n     3.1.  NAT . .\
    \ . . . . . . . . . . . . . . . . . . . . . . . . .   9\n     3.2.  Firewall \
    \ . . . . . . . . . . . . . . . . . . . . . . . .  10\n     3.3.  DDoS Scrubbing\
    \  . . . . . . . . . . . . . . . . . . . . .  10\n     3.4.  Implicit Identification\
    \ . . . . . . . . . . . . . . . . .  11\n     3.5.  Performance-Enhancing Proxies\
    \ . . . . . . . . . . . . . .  11\n     3.6.  Network Coding  . . . . . . . .\
    \ . . . . . . . . . . . . .  12\n     3.7.  Network-Assisted Bandwidth Aggregation\
    \  . . . . . . . . .  13\n     3.8.  Prioritization and Differentiated Services\
    \  . . . . . . .  13\n     3.9.  Measurement-Based Shaping . . . . . . . . . .\
    \ . . . . . .  14\n     3.10. Fairness to End-User Quota  . . . . . . . . . .\
    \ . . . . .  14\n   4.  IANA Considerations . . . . . . . . . . . . . . . . .\
    \ . . . .  14\n   5.  Security Considerations . . . . . . . . . . . . . . . .\
    \ . . .  14\n     5.1.  Confidentiality and Privacy . . . . . . . . . . . . .\
    \ . .  14\n     5.2.  Active On-Path Attacks  . . . . . . . . . . . . . . . .\
    \ .  15\n     5.3.  Improved Security . . . . . . . . . . . . . . . . . . . .\
    \  15\n   6.  Informative References  . . . . . . . . . . . . . . . . . . .  16\n\
    \   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  21\n  \
    \ Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  21\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   From [RFC3234], \"A middlebox is defined as any intermediary\
    \ device\n   performing functions other than the normal, standard functions of\
    \ an\n   IP router on the datagram path between a source host and destination\n\
    \   host.\"\n   Middleboxes are usually (but not exclusively) deployed at locations\n\
    \   permitting observation of bidirectional traffic flows.  Such\n   locations\
    \ are typically points where leaf networks connect to the\n   Internet, for example:\n\
    \   o  Where a residential or business customer connects to its service\n    \
    \  provider(s), which may include multihoming;\n   o  On the Gi interface where\
    \ a Gateway General Packet Radio Service\n      (GPRS) Support Node (GGSN) connects\
    \ to a Packet Data Network (PDN)\n      (Section 3.1 of [RFC6459]).\n   For the\
    \ purposes of this document (and to be consistent with the\n   definition in RFC\
    \ 3234), middlebox functions may be found in routers\n   and switches in addition\
    \ to dedicated devices.\n   This document itemizes a variety of features provided\
    \ by middleboxes\n   and by ad hoc analysis performed by operators using packet\
    \ analyzers.\n   Many of the techniques described in this document require stateful\n\
    \   analysis of transport streams.  A generic state machine is described\n   in\
    \ [PATH-STATE].\n   This document summarizes an operator's perception of the benefits\n\
    \   that may be provided by middleboxes.  A primary goal is to provide\n   information\
    \ to the Internet community to aid understanding of what\n   might be gained or\
    \ lost by decisions that may affect (or be affected\n   by) middlebox operation\
    \ in the design of new transport protocols.\n   See Section 1.1 for more details.\n"
- title: 1.1.  Operator Perspective
  contents:
  - "1.1.  Operator Perspective\n   Network operators are often the ones first called\
    \ upon when\n   applications fail to function properly, often with user reports\
    \ about\n   application behaviors (not about packet behaviors).  Therefore, it\n\
    \   isn't surprising that operators (wanting to be helpful) desire some\n   visibility\
    \ into flow information to identify how well the problem\n   flows are progressing\
    \ and how well other flows are progressing.\n   Advanced service functions (e.g.,\
    \ Network Address Translators (NATs),\n   firewalls, etc.)  [RFC7498] are widely\
    \ used to achieve various\n   objectives such as IP address sharing, firewalling,\
    \ avoiding covert\n   channels, detecting and protecting against ever-increasing\n\
    \   Distributed Denial of Service (DDoS) attacks, etc.  For example,\n   environment-specific\
    \ designs may require a number of service\n   functions, such as those needed\
    \ at the Gi interface of a mobile\n   infrastructure [USE-CASE].\n   These sophisticated\
    \ service functions are located in the network but\n   also in service platforms\
    \ or intermediate entities (e.g., Content\n   Delivery Networks (CDNs)).  Network\
    \ maintenance and diagnostic\n   operations are complicated, particularly when\
    \ responsibility is\n   shared among various players.\n   Network Providers are\
    \ challenged to deliver differentiated services\n   as a competitive business\
    \ advantage while mastering the complexity of\n   the applications, (continuously)\
    \ evaluating the impacts on\n   middleboxes, and enhancing customers' quality\
    \ of experience.\n   Despite the complexity, removing all those service functions\
    \ is not\n   an option because they are used to address constraints that are often\n\
    \   typical of the current (and changing) Internet.  Operators must deal\n   with\
    \ constraints such as global IPv4 address depletion and support a\n   plethora\
    \ of services with different requirements for QoS, security,\n   robustness, etc.\n"
- title: 1.2.  Scope
  contents:
  - "1.2.  Scope\n   Although many middleboxes observe and manipulate application-layer\n\
    \   content (e.g., session boarder controllers [RFC5853]), they are out\n   of\
    \ scope for this document, the aim being to describe middleboxes\n   using transport-layer\
    \ features.  [RFC8404] describes the impact of\n   pervasive encryption of application-layer\
    \ data on network monitoring,\n   protecting, and troubleshooting.\n   The current\
    \ document is not intended to recommend (or prohibit)\n   middlebox deployment.\
    \  Many operators have found the value provided\n   by middleboxes to outweigh\
    \ the added cost and complexity; this\n   document attempts to provide that perspective\
    \ as a reference in\n   discussion of protocol design trade-offs.\n   This document\
    \ is not intended to discuss issues related to\n   middleboxes.  These issues\
    \ are well known and are recorded in\n   existing documents such as [RFC3234]\
    \ and [RFC6269].  This document\n   aims to elaborate on the motivations leading\
    \ operators to enable such\n   functions in spite of complications.\n   This document\
    \ takes an operator perspective that measurement and\n   management of transport\
    \ connections is of benefit to both parties:\n   the end user receives a better\
    \ quality of experience, and the network\n   operator improves resource usage,\
    \ the former being a consequence of\n   the latter.\n   This document does not\
    \ discuss whether exposing some data to on-path\n   devices for network-assistance\
    \ purposes can be achieved by using\n   in-band or out-of-band mechanisms.\n"
- title: 2.  Measurements
  contents:
  - "2.  Measurements\n   A number of measurements can be made by network devices\
    \ that are\n   either on-path or off-path.  These measurements can be used either\
    \ by\n   automated systems or for manual network troubleshooting purposes\n  \
    \ (e.g., using packet-analysis tools).  The automated systems can\n   further\
    \ be classified into two types: 1) monitoring systems that\n   compute performance\
    \ indicators for single connections or aggregates\n   of connections and generate\
    \ aggregated reports from them; and 2)\n   active systems that make decisions\
    \ also on how to handle packet flows\n   based on these performance indicators.\n\
    \   Long-term trends in these measurements can aid an operator in\n   capacity\
    \ planning.\n   Short-term anomalies revealed by these measurements can identify\n\
    \   network breakages, attacks in progress, or misbehaving devices/\n   applications.\n"
- title: 2.1.  Packet Loss
  contents:
  - "2.1.  Packet Loss\n   It is very useful for an operator to be able to detect\
    \ and isolate\n   packet loss in a network.\n   Network problems and underprovisioning\
    \ can be detected if packet loss\n   is measurable.  TCP packet loss can be detected\
    \ by observing gaps in\n   sequence numbers, retransmitted sequence numbers, and\
    \ selective\n   acknowledgement (SACK) options [RFC2018].  Packet loss can be\n\
    \   detected per direction.\n   Gaps indicate loss upstream of the traffic observation\
    \ point;\n   retransmissions indicate loss downstream of the traffic observation\n\
    \   point.  SACKs can be used to detect either upstream or downstream\n   packet\
    \ loss (although some care needs to be taken to avoid\n   misidentifying packet\
    \ reordering as packet loss) and to distinguish\n   between upstream versus downstream\
    \ losses.\n   Packet-loss measurements on both sides of the measurement point\
    \ are\n   an important component in precisely diagnosing insufficiently\n   dimensioned\
    \ devices or links in networks.  Additionally, packet\n   losses are one of the\
    \ two main ways for congestion to manifest, the\n   others being queuing delay\
    \ or Explicit Congestion Notification (ECN)\n   [RFC3168]; therefore, packet loss\
    \ is an important measurement for any\n   middlebox that needs to make traffic\
    \ handling decisions based on\n   observed levels of congestion.\n"
- title: 2.2.  Round-Trip Times
  contents:
  - "2.2.  Round-Trip Times\n   The ability to measure partial-path round-trip times\
    \ (RTTs) is\n   valuable in diagnosing network issues (e.g., abnormal latency,\n\
    \   abnormal packet loss).  Knowing if latency is poor on one side of the\n  \
    \ observation point or the other provides more information than is\n   available\
    \ at either endpoint, which can only observe full RTTs.\n   For example, a TCP\
    \ packet stream can be used to measure the RTT on\n   each side of the measurement\
    \ point.  During the connection handshake,\n   the SYN, SYN/ACK, and ACK timings\
    \ can be used to establish a baseline\n   RTT in each direction.  Once the connection\
    \ is established, the RTT\n   between the server and the measurement point can\
    \ only reliably be\n   determined using TCP timestamps [RFC7323].  On the side\
    \ between the\n   measurement point and the client, the exact timing of data segments\n\
    \   and ACKs can be used as an alternative.  For this latter method to be\n  \
    \ accurate when packet loss is present, the connection must use\n   selective\
    \ acknowledgements.\n   In many networks, congestion will show up as increasing\
    \ packet\n   queuing, and congestion-induced packet loss will only happen in\n\
    \   extreme cases.  RTTs will also show up as a much smoother signal than\n  \
    \ the discrete packet-loss events.  This makes RTTs a good way to\n   identify\
    \ individual subscribers for whom the network is a bottleneck\n   at a given time\
    \ or geographical sites (such as cellular towers) that\n   are experiencing large-scale\
    \ congestion.\n   The main limit of RTT measurement as a congestion signal is\
    \ the\n   difficulty of reliably distinguishing between the data segments being\n\
    \   queued versus the ACKs being queued.\n"
- title: 2.3.  Measuring Packet Reordering
  contents:
  - "2.3.  Measuring Packet Reordering\n   If a network is reordering packets of transport\
    \ connections, caused\n   perhaps by Equal-Cost Multipath (ECMP) misconfiguration\
    \ (described in\n   [RFC2991] and [RFC7690], for example), the endpoints may react\
    \ as if\n   packet loss is occurring and retransmit packets or reduce forwarding\n\
    \   rates.  Therefore, a network operator desires the ability to diagnose\n  \
    \ packet reordering.\n   For TCP, packet reordering can be detected by observing\
    \ TCP sequence\n   numbers per direction.  See, for example, a number of standard\n\
    \   packet-reordering metrics in [RFC4737] and informational metrics in\n   [RFC5236].\n"
- title: 2.4.  Throughput and Bottleneck Identification
  contents:
  - "2.4.  Throughput and Bottleneck Identification\n   Although throughput to or\
    \ from an IP address can be measured without\n   transport-layer measurements,\
    \ the transport layer provides clues\n   about what the endpoints were attempting\
    \ to do.\n   One way of quickly excluding the network as the bottleneck during\n\
    \   troubleshooting is to check whether the speed is limited by the\n   endpoints.\
    \  For example, the connection speed might instead be\n   limited by suboptimal\
    \ TCP options, the sender's congestion window,\n   the sender temporarily running\
    \ out of data to send, the sender\n   waiting for the receiver to send another\
    \ request, or the receiver\n   closing the receive window.\n   This data is also\
    \ useful for middleboxes used to measure network\n   quality of service.  Connections,\
    \ or portions of connections, that\n   are limited by the endpoints do not provide\
    \ an accurate measure of\n   the network's speed and can be discounted or completely\
    \ excluded in\n   such analyses.\n"
- title: 2.5.  Congestion Responsiveness
  contents:
  - "2.5.  Congestion Responsiveness\n   Congestion control mechanisms continue to\
    \ evolve.  Tools exist that\n   can interpret protocol sequence numbers (e.g.,\
    \ from TCP or RTP) to\n   infer the congestion response of a flow.  Such tools\
    \ can be used by\n   operators to help understand the impact of specific transport\n\
    \   protocols on other traffic that shares their network.  For example,\n   packet\
    \ sequence numbers can be analyzed to help understand whether an\n   application\
    \ flow backs off its load in the face of persistent\n   congestion (as TCP does)\
    \ and, hence, whether the behavior is\n   appropriate for sharing limited network\
    \ capacity.\n   These tools can also be used to determine whether mechanisms are\n\
    \   needed in the network to prevent flows from acquiring excessive\n   network\
    \ capacity under severe congestion (e.g., by deploying rate\n   limiters or network\
    \ transport circuit breakers [RFC8084]).\n"
- title: 2.6.  Attack Detection
  contents:
  - "2.6.  Attack Detection\n   When an application or network resource is under attack,\
    \ it is useful\n   to identify this situation from the network perspective, upstream\
    \ of\n   the attacked resource.\n   Although detection methods tend to be proprietary,\
    \ attack detection\n   from within the network may comprise:\n   o  Identifying\
    \ uncharacteristic traffic volumes or sources;\n   o  Identifying congestion,\
    \ possibly using techniques in Sections 2.1\n      and 2.2;\n   o  Identifying\
    \ incomplete connections or transactions, from attacks\n      that attempt to\
    \ exhaust server resources;\n   o  Fingerprinting based on whatever available\
    \ fields are determined\n      to be useful in discriminating an attack from desirable\
    \ traffic.\n   Two trends in protocol design will make attack detection more\n\
    \   difficult:\n   o  The desire to encrypt transport-layer fields;\n   o  The\
    \ desire to avoid statistical fingerprinting by adding entropy\n      in various\
    \ forms.\n   While improving privacy, those approaches may hinder attack\n   detection.\n"
- title: 2.7.  Packet Corruption
  contents:
  - "2.7.  Packet Corruption\n   One notable source of packet loss is packet corruption.\
    \  This\n   corruption will generally not be detected until the checksums are\n\
    \   validated by the endpoint and the packet is dropped.  This means that\n  \
    \ detecting the exact location where packets are lost is not sufficient\n   when\
    \ troubleshooting networks.  An operator would like to find out\n   where packets\
    \ are being corrupted.  IP and TCP checksum verification\n   allows a measurement\
    \ device to correctly distinguish between upstream\n   packet corruption and normal\
    \ downstream packet loss.\n   Transport protocol designers should consider whether\
    \ a middlebox will\n   be able to detect corrupted or tampered packets.\n"
- title: 2.8.  Application-Layer Measurements
  contents:
  - "2.8.  Application-Layer Measurements\n   Information about network health may\
    \ also be gleaned from\n   application-layer diagnosis, such as:\n   o  DNS response\
    \ times and retransmissions calculated by correlating\n      answers to queries;\n\
    \   o  Various protocol-aware voice and video quality analyses.\n   Could this\
    \ type of information be provided in a transport layer?\n"
- title: '3.  Functions beyond Measurement: A Few Examples'
  contents:
  - "3.  Functions beyond Measurement: A Few Examples\n   This section describes features\
    \ provided by on-path devices that go\n   beyond measurement by modifying, discarding,\
    \ delaying, or\n   prioritizing traffic.\n"
- title: 3.1.  NAT
  contents:
  - "3.1.  NAT\n   Network Address Translators (NATs) allow multiple devices to share\
    \ a\n   public address by dividing the transport-layer port space among the\n\
    \   devices.\n   NAT behavior recommendations are found for UDP in BCP 127 [RFC4787]\n\
    \   and for TCP in BCP 142 [RFC7857].\n   To support NAT, there must be transport-layer\
    \ port numbers that can\n   be modified by the NAT.  Note that required fields\
    \ (e.g., port\n   numbers) are visible in all IETF-defined transport protocols.\n\
    \   The application layer must not assume the port number was left\n   unchanged\
    \ (e.g., by including it in a checksum or signing it).\n   Address sharing is\
    \ also used in the context of IPv6 transition.  For\n   example, DS-Lite Address\
    \ Family Transition Router (AFTR) [RFC6333],\n   NAT64 [RFC6146], or A+P [RFC7596][RFC7597]\
    \ are features that are\n   enabled in the network to allow for IPv4 service continuity\
    \ over an\n   IPv6 network.\n   Further, because of some multihoming considerations,\
    \ IPv6 prefix\n   translation may be enabled by some enterprises by means of IPv6-to-\n\
    \   IPv6 Network Prefix Translation (NPTv6) [RFC6296].\n"
- title: 3.2.  Firewall
  contents:
  - "3.2.  Firewall\n   Firewalls are pervasive and essential components that inspect\n\
    \   incoming and outgoing traffic.  Firewalls are usually the cornerstone\n  \
    \ of a security policy that is enforced in end-user premises and other\n   locations\
    \ to provide strict guarantees about traffic that may be\n   authorized to enter/leave\
    \ the said premises, as well as end users who\n   may be assigned different clearance\
    \ levels regarding which networks\n   and portions of the Internet they access.\n\
    \   An important aspect of a firewall policy is differentiating\n   internally\
    \ initiated from externally initiated communications.\n      For TCP, this is\
    \ easily done by tracking the TCP state machine.\n      Furthermore, the ending\
    \ of a TCP connection is indicated by RST or\n      FIN flags.\n      For UDP,\
    \ the firewall can be opened if the first packet comes from\n      an internal\
    \ user, but the closing is generally done by an idle\n      timer of arbitrary\
    \ duration, which might not match the\n      expectations of the application.\n\
    \   Simple IPv6 firewall capabilities for customer premises equipment\n   (both\
    \ stateless and stateful) are described in [RFC6092].\n   A firewall functions\
    \ better when it can observe the protocol state\n   machine, described generally\
    \ by \"Transport-Independent Path Layer\n   State Management\" [PATH-STATE].\n"
- title: 3.3.  DDoS Scrubbing
  contents:
  - "3.3.  DDoS Scrubbing\n   In the context of a DDoS attack, the purpose of a scrubber\
    \ is to\n   discard attack traffic while permitting useful traffic.  Such a\n\
    \   mitigator is described in [DOTS].\n   When attacks occur against constrained\
    \ resources, some traffic will\n   be discarded before reaching the intended destination.\
    \  A user\n   receives better experience and a server runs more efficiently if\
    \ a\n   scrubber can discard attack traffic, leaving room for legitimate\n   traffic.\n\
    \   Scrubbing must be provided by an on-path network device, because\n   neither\
    \ endpoint of a legitimate connection has any control over the\n   source of the\
    \ attack traffic.\n   Source-spoofed DDoS attacks can be mitigated at the source\
    \ using BCP\n   38 [RFC2827], but it is more difficult if source address filtering\n\
    \   cannot be applied.\n   In contrast to devices in the core of the Internet,\
    \ middleboxes\n   statefully observing bidirectional transport connections can\
    \ reject\n   source-spoofed TCP traffic based on the inability to provide sensible\n\
    \   acknowledgement numbers to complete the three-way handshake.\n   Obviously,\
    \ this requires middlebox visibility into a transport-layer\n   state machine.\n\
    \   Middleboxes may also scrub on the basis of statistical\n   classification:\
    \ testing how likely a given packet is to be\n   legitimate.  As protocol designers\
    \ add more entropy to headers and\n   lengths, this test becomes less useful,\
    \ and the best scrubbing\n   strategy becomes random drop.\n"
- title: 3.4.  Implicit Identification
  contents:
  - "3.4.  Implicit Identification\n   In order to enhance the end user's quality\
    \ of experience, some\n   operators deploy implicit identification features that\
    \ rely upon the\n   correlation of network-related information to access some\
    \ local\n   services.  For example, service portals operated by some operators\n\
    \   may be accessed immediately by end users without any explicit\n   identification\
    \ for the sake of improved service availability.  This\n   is doable thanks to\
    \ on-path devices that inject appropriate metadata\n   that can be used by the\
    \ remote server to enforce per-subscriber\n   policies.  The information can be\
    \ injected at the application layer\n   or at the transport layer (when an address-sharing\
    \ mechanism is in\n   use).\n   An experimental implementation using a TCP option\
    \ is described in\n   [RFC7974].\n   For the intended use of implicit identification,\
    \ it is more secure to\n   have a trusted middlebox mark this traffic than to\
    \ trust end-user\n   devices.\n"
- title: 3.5.  Performance-Enhancing Proxies
  contents:
  - "3.5.  Performance-Enhancing Proxies\n   Performance-Enhancing Proxies (PEPs)\
    \ can improve performance in some\n   types of networks by improving packet spacing\
    \ or generating local\n   acknowledgements; they are most commonly used in satellite\
    \ and\n   cellular networks.  Transport-Layer PEPs are described in\n   Section\
    \ 2.1.1 of [RFC3135].\n   PEPs allow central deployment of congestion control\
    \ algorithms more\n   suited to the specific network, most commonly for delay-based\n\
    \   congestion control.  More advanced TCP PEPs deploy congestion control\n  \
    \ systems that treat all of a single end user's TCP connections as a\n   single\
    \ unit, improving fairness and allowing faster reaction to\n   changing network\
    \ conditions.  For example, it was reported that\n   splitting the TCP connections\
    \ in some network accesses can result in\n   a halved page downloading time [ICCRG].\n\
    \   Local acknowledgements generated by PEPs speed up TCP slow start by\n   splitting\
    \ the effective latency, and they allow for retransmissions\n   to be done from\
    \ the PEP rather than from the actual sender.  Local\n   acknowledgements will\
    \ also allow a PEP to maintain a local buffer of\n   data appropriate to the actual\
    \ network conditions, whereas the actual\n   endpoints would often send too much\
    \ or too little.\n   A PEP function requires transport-layer fields that allow\
    \ chunks of\n   data to be identified (e.g., TCP sequence numbers), acknowledgements\n\
    \   to be identified (e.g., TCP ACK numbers), and acknowledgements to be\n   created\
    \ from the PEP.\n   Note that PEPs are only useful in some types of networks.\
    \  In\n   particular, PEPs are very useful in contexts wherein the congestion\n\
    \   control strategies of the endpoints are inappropriate for the network\n  \
    \ connecting them.  That being said, poor design can result in degraded\n   performances\
    \ when PEPs are deployed.\n"
- title: 3.6.  Network Coding
  contents:
  - "3.6.  Network Coding\n   Network Coding is a technique for improving transmission\
    \ performance\n   over low-bandwidth, long-latency links such as some satellite\
    \ links.\n   Coding may involve lossless compression and/or adding redundancy\
    \ to\n   headers and payload.  A Network Coding Taxonomy is provided by\n   [RFC8406];\
    \ an example of end-to-end coding is FECFRAME [RFC6363].  It\n   is typically\
    \ deployed with network-coding gateways at each end of\n   those links, with a\
    \ network-coding tunnel between them via the\n   slow/lossy/long-latency links.\n\
    \   Network-coding implementations may be specific to TCP, taking\n   advantage\
    \ of known properties of the protocol.\n   The network-coding gateways may employ\
    \ some techniques of PEPs, such\n   as creating acknowledgements of queued data,\
    \ removing\n   retransmissions, and pacing data rates to reduce queue oscillation.\n\
    \   The interest in more network coding in some specific networks is\n   discussed\
    \ in [SATELLITES].\n   Note: This is not to be confused with transcoding, which\
    \ performs\n   lossy compression on transmitted media streams and is not in scope\n\
    \   for this document.\n"
- title: 3.7.  Network-Assisted Bandwidth Aggregation
  contents:
  - "3.7.  Network-Assisted Bandwidth Aggregation\n   The Hybrid Access Aggregation\
    \ Point is a middlebox that allows\n   customers to aggregate the bandwidth of\
    \ multiple access technologies.\n   One of the approaches uses Multipath TCP (MPTCP)\
    \ proxies\n   [TCP-CONVERT] to forward traffic along multiple paths.  The MPTCP\n\
    \   proxy operates at the transport layer while being located in the\n   operator's\
    \ network.\n   The support of multipath transport capabilities by communicating\n\
    \   hosts remains a privileged target design so that such hosts can\n   directly\
    \ use the available resources provided by a variety of access\n   networks they\
    \ can connect to.  Nevertheless, network operators do not\n   control end hosts,\
    \ whereas the support of MPTCP by content servers\n   remains marginal.\n   Network-assisted\
    \ MPTCP deployment models are designed to facilitate\n   the adoption of MPTCP\
    \ for the establishment of multipath\n   communications without making any assumption\
    \ about the support of\n   MPTCP capabilities by communicating peers.  Network-assisted\
    \ MPTCP\n   deployment models rely upon MPTCP Conversion Points (MCPs) that act\n\
    \   on behalf of hosts so that they can take advantage of establishing\n   communications\
    \ over multiple paths [TCP-CONVERT].\n   Note there are cases when end-to-end\
    \ MPTCP cannot be used even though\n   both client and server are MPTCP-compliant.\
    \  An MPTCP proxy can\n   provide multipath utilization in these cases.  Examples\
    \ of such cases\n   are listed below:\n   1.  The use of private IPv4 addresses\
    \ in some access networks.\n       Typically, additional subflows cannot be added\
    \ to the MPTCP\n       connection without the help of an MCP.\n   2.  The assignment\
    \ of IPv6 prefixes only by some networks.  If the\n       server is IPv4-only,\
    \ IPv6 subflows cannot be added to an MPTCP\n       connection established with\
    \ that server, by definition.\n   3.  Subscription to some service offerings is\
    \ subject to volume\n       quota.\n"
- title: 3.8.  Prioritization and Differentiated Services
  contents:
  - "3.8.  Prioritization and Differentiated Services\n   Bulk traffic may be served\
    \ with a higher latency than interactive\n   traffic with no reduction in throughput.\
    \  This fact allows a\n   middlebox function to improve response times in interactive\n\
    \   applications by prioritizing, policing, or remarking interactive\n   transport\
    \ connections differently from bulk-traffic transport\n   connections.  For example,\
    \ gaming traffic may be prioritized over\n   email or software updates.  Configuration\
    \ guidelines for Diffserv\n   service classes are discussed in [RFC4594].\n  \
    \ Middleboxes may identify different classes of traffic by inspecting\n   multiple\
    \ layers of header and length of payload.\n"
- title: 3.9.  Measurement-Based Shaping
  contents:
  - "3.9.  Measurement-Based Shaping\n   Basic traffic-shaping functionality requires\
    \ no transport-layer\n   information.  All that is needed is a way of mapping\
    \ each packet to a\n   traffic shaper quota.  For example, there may be a rate\
    \ limit per\n   5-tuple or per subscriber IP address.  However, such fixed traffic\n\
    \   shaping rules are wasteful as they end up rate-limiting traffic even\n   when\
    \ the network has free resources available.\n   More advanced traffic-shaping\
    \ devices use transport-layer metrics\n   described in Section 2 to detect congestion\
    \ on either a per-site or a\n   per-user level and use different traffic-shaping\
    \ rules when\n   congestion is detected [RFC3272].  This type of device can overcome\n\
    \   limitations of downstream devices that behave poorly (e.g., by\n   excessive\
    \ buffering or suboptimally dropping packets).\n"
- title: 3.10.  Fairness to End-User Quota
  contents:
  - "3.10.  Fairness to End-User Quota\n   Several service offerings rely upon a volume-based\
    \ charging model\n   (e.g., volume-based data plans offered by cellular providers).\n\
    \   Operators may assist end users in conserving their data quota by\n   deploying\
    \ on-path functions that shape traffic that would otherwise\n   be aggressively\
    \ transferred.\n   For example, a fast download of a video that won't be viewed\n\
    \   completely by the subscriber may lead to quick exhaustion of the data\n  \
    \ quota.  Limiting the video download rate conserves quota for the\n   benefit\
    \ of the end user.  Also, discarding unsolicited incoming\n   traffic prevents\
    \ the user's quota from being unfairly exhausted.\n"
- title: 4.  IANA Considerations
  contents:
  - "4.  IANA Considerations\n   This document has no IANA actions.\n"
- title: 5.  Security Considerations
  contents:
  - '5.  Security Considerations

    '
- title: 5.1.  Confidentiality and Privacy
  contents:
  - "5.1.  Confidentiality and Privacy\n   This document intentionally excludes middleboxes\
    \ that observe or\n   manipulate application-layer data.\n   The measurements\
    \ and functions described in this document can all be\n   implemented without\
    \ violating confidentiality [RFC6973].  However,\n   there is always the question\
    \ of whether the fields and packet\n   properties used to achieve operational\
    \ benefits may also be used for\n   harm.\n   In particular, the question is what\
    \ confidentiality is lost by\n   exposing transport-layer fields beyond what can\
    \ be learned by\n   observing IP-layer fields:\n   o  Sequence numbers: an observer\
    \ can learn how much data is\n      transferred.\n   o  Start/Stop indicators:\
    \ an observer can count transactions for some\n      applications.\n   o  Device\
    \ fingerprinting: an observer may be more easily able to\n      identify a device\
    \ type when different devices use different\n      default field values or options.\n"
- title: 5.2.  Active On-Path Attacks
  contents:
  - "5.2.  Active On-Path Attacks\n   An on-path attacker being able to observe sequence\
    \ numbers or session\n   identifiers may make it easier to modify or terminate\
    \ a transport\n   connection.  For example, observing TCP sequence numbers allows\n\
    \   generation of a RST packet that terminates the connection.  However,\n   signing\
    \ transport fields softens this attack.  The attack and\n   solution are described\
    \ for the TCP authentication option [RFC5925].\n   Still, an on-path attacker\
    \ can also drop the traffic flow.\n"
- title: 5.3.  Improved Security
  contents:
  - "5.3.  Improved Security\n   Network maintainability and security can be improved\
    \ by providing\n   firewalls and DDoS mechanisms with some information about transport\n\
    \   connections.  In contrast, it would be very difficult to secure a\n   network\
    \ in which every packet appears unique and filled with random\n   bits (from the\
    \ perspective of an on-path device).\n   Some features providing the ability to\
    \ mitigate/filter attacks owing\n   to a network-assisted mechanism will therefore\
    \ improve security --\n   e.g., by means of Distributed-Denial-of-Service Open\
    \ Threat Signaling\n   (DOTS) [DOTS-SIGNAL].\n"
- title: 6.  Informative References
  contents:
  - "6.  Informative References\n   [DOTS]     Mortensen, A., Andreasen, F., Reddy,\
    \ T., Compton, R., and\n              N. Teague, \"Distributed-Denial-of-Service\
    \ Open Threat\n              Signaling (DOTS) Architecture\", Work in Progress,\n\
    \              draft-ietf-dots-architecture-07, September 2018.\n   [DOTS-SIGNAL]\n\
    \              Reddy, T., Boucadair, M., Patil, P., Mortensen, A., and N.\n  \
    \            Teague, \"Distributed Denial-of-Service Open Threat\n           \
    \   Signaling (DOTS) Signal Channel Specification\", Work in\n              Progress,\
    \ draft-ietf-dots-signal-channel-25, September\n              2018.\n   [ICCRG]\
    \    Kuhn, N., \"MPTCP and BBR performance over Internet\n              satellite\
    \ paths\", IETF 100, 2017,\n              <https://datatracker.ietf.org/meeting/100/materials/\n\
    \              slides-100-iccrg-mptcp-and-bbr-performance-over-satcom-\n     \
    \         links-00>.\n   [PATH-STATE]\n              Kuehlewind, M., Trammell,\
    \ B., and J. Hildebrand,\n              \"Transport-Independent Path Layer State\
    \ Management\", Work\n              in Progress, draft-trammell-plus-statefulness-04,\
    \ November\n              2017.\n   [RFC2018]  Mathis, M., Mahdavi, J., Floyd,\
    \ S., and A. Romanow, \"TCP\n              Selective Acknowledgment Options\"\
    , RFC 2018,\n              DOI 10.17487/RFC2018, October 1996,\n             \
    \ <https://www.rfc-editor.org/info/rfc2018>.\n   [RFC2827]  Ferguson, P. and D.\
    \ Senie, \"Network Ingress Filtering:\n              Defeating Denial of Service\
    \ Attacks which employ IP Source\n              Address Spoofing\", BCP 38, RFC\
    \ 2827, DOI 10.17487/RFC2827,\n              May 2000, <https://www.rfc-editor.org/info/rfc2827>.\n\
    \   [RFC2991]  Thaler, D. and C. Hopps, \"Multipath Issues in Unicast and\n  \
    \            Multicast Next-Hop Selection\", RFC 2991,\n              DOI 10.17487/RFC2991,\
    \ November 2000,\n              <https://www.rfc-editor.org/info/rfc2991>.\n \
    \  [RFC3135]  Border, J., Kojo, M., Griner, J., Montenegro, G., and\n        \
    \      Z. Shelby, \"Performance Enhancing Proxies Intended to\n              Mitigate\
    \ Link-Related Degradations\", RFC 3135,\n              DOI 10.17487/RFC3135,\
    \ June 2001,\n              <https://www.rfc-editor.org/info/rfc3135>.\n   [RFC3168]\
    \  Ramakrishnan, K., Floyd, S., and D. Black, \"The Addition\n              of\
    \ Explicit Congestion Notification (ECN) to IP\",\n              RFC 3168, DOI\
    \ 10.17487/RFC3168, September 2001,\n              <https://www.rfc-editor.org/info/rfc3168>.\n\
    \   [RFC3234]  Carpenter, B. and S. Brim, \"Middleboxes: Taxonomy and\n      \
    \        Issues\", RFC 3234, DOI 10.17487/RFC3234, February 2002,\n          \
    \    <https://www.rfc-editor.org/info/rfc3234>.\n   [RFC3272]  Awduche, D., Chiu,\
    \ A., Elwalid, A., Widjaja, I., and\n              X. Xiao, \"Overview and Principles\
    \ of Internet Traffic\n              Engineering\", RFC 3272, DOI 10.17487/RFC3272,\
    \ May 2002,\n              <https://www.rfc-editor.org/info/rfc3272>.\n   [RFC4594]\
    \  Babiarz, J., Chan, K., and F. Baker, \"Configuration\n              Guidelines\
    \ for DiffServ Service Classes\", RFC 4594,\n              DOI 10.17487/RFC4594,\
    \ August 2006,\n              <https://www.rfc-editor.org/info/rfc4594>.\n   [RFC4737]\
    \  Morton, A., Ciavattone, L., Ramachandran, G., Shalunov,\n              S.,\
    \ and J. Perser, \"Packet Reordering Metrics\", RFC 4737,\n              DOI 10.17487/RFC4737,\
    \ November 2006,\n              <https://www.rfc-editor.org/info/rfc4737>.\n \
    \  [RFC4787]  Audet, F., Ed. and C. Jennings, \"Network Address\n            \
    \  Translation (NAT) Behavioral Requirements for Unicast\n              UDP\"\
    , BCP 127, RFC 4787, DOI 10.17487/RFC4787, January\n              2007, <https://www.rfc-editor.org/info/rfc4787>.\n\
    \   [RFC5236]  Jayasumana, A., Piratla, N., Banka, T., Bare, A., and\n       \
    \       R. Whitner, \"Improved Packet Reordering Metrics\",\n              RFC\
    \ 5236, DOI 10.17487/RFC5236, June 2008,\n              <https://www.rfc-editor.org/info/rfc5236>.\n\
    \   [RFC5853]  Hautakorpi, J., Ed., Camarillo, G., Penfield, R.,\n           \
    \   Hawrylyshen, A., and M. Bhatia, \"Requirements from Session\n            \
    \  Initiation Protocol (SIP) Session Border Control (SBC)\n              Deployments\"\
    , RFC 5853, DOI 10.17487/RFC5853, April 2010,\n              <https://www.rfc-editor.org/info/rfc5853>.\n\
    \   [RFC5925]  Touch, J., Mankin, A., and R. Bonica, \"The TCP\n             \
    \ Authentication Option\", RFC 5925, DOI 10.17487/RFC5925,\n              June\
    \ 2010, <https://www.rfc-editor.org/info/rfc5925>.\n   [RFC6092]  Woodyatt, J.,\
    \ Ed., \"Recommended Simple Security\n              Capabilities in Customer Premises\
    \ Equipment (CPE) for\n              Providing Residential IPv6 Internet Service\"\
    , RFC 6092,\n              DOI 10.17487/RFC6092, January 2011,\n             \
    \ <https://www.rfc-editor.org/info/rfc6092>.\n   [RFC6146]  Bagnulo, M., Matthews,\
    \ P., and I. van Beijnum, \"Stateful\n              NAT64: Network Address and\
    \ Protocol Translation from IPv6\n              Clients to IPv4 Servers\", RFC\
    \ 6146, DOI 10.17487/RFC6146,\n              April 2011, <https://www.rfc-editor.org/info/rfc6146>.\n\
    \   [RFC6269]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and\n    \
    \          P. Roberts, \"Issues with IP Address Sharing\", RFC 6269,\n       \
    \       DOI 10.17487/RFC6269, June 2011,\n              <https://www.rfc-editor.org/info/rfc6269>.\n\
    \   [RFC6296]  Wasserman, M. and F. Baker, \"IPv6-to-IPv6 Network Prefix\n   \
    \           Translation\", RFC 6296, DOI 10.17487/RFC6296, June 2011,\n      \
    \        <https://www.rfc-editor.org/info/rfc6296>.\n   [RFC6333]  Durand, A.,\
    \ Droms, R., Woodyatt, J., and Y. Lee, \"Dual-\n              Stack Lite Broadband\
    \ Deployments Following IPv4\n              Exhaustion\", RFC 6333, DOI 10.17487/RFC6333,\
    \ August 2011,\n              <https://www.rfc-editor.org/info/rfc6333>.\n   [RFC6363]\
    \  Watson, M., Begen, A., and V. Roca, \"Forward Error\n              Correction\
    \ (FEC) Framework\", RFC 6363,\n              DOI 10.17487/RFC6363, October 2011,\n\
    \              <https://www.rfc-editor.org/info/rfc6363>.\n   [RFC6459]  Korhonen,\
    \ J., Ed., Soininen, J., Patil, B., Savolainen,\n              T., Bajko, G.,\
    \ and K. Iisakkila, \"IPv6 in 3rd Generation\n              Partnership Project\
    \ (3GPP) Evolved Packet System (EPS)\",\n              RFC 6459, DOI 10.17487/RFC6459,\
    \ January 2012,\n              <https://www.rfc-editor.org/info/rfc6459>.\n  \
    \ [RFC6973]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,\n          \
    \    Morris, J., Hansen, M., and R. Smith, \"Privacy\n              Considerations\
    \ for Internet Protocols\", RFC 6973,\n              DOI 10.17487/RFC6973, July\
    \ 2013,\n              <https://www.rfc-editor.org/info/rfc6973>.\n   [RFC7323]\
    \  Borman, D., Braden, B., Jacobson, V., and\n              R. Scheffenegger,\
    \ Ed., \"TCP Extensions for High\n              Performance\", RFC 7323, DOI 10.17487/RFC7323,\
    \ September\n              2014, <https://www.rfc-editor.org/info/rfc7323>.\n\
    \   [RFC7498]  Quinn, P., Ed. and T. Nadeau, Ed., \"Problem Statement for\n  \
    \            Service Function Chaining\", RFC 7498,\n              DOI 10.17487/RFC7498,\
    \ April 2015,\n              <https://www.rfc-editor.org/info/rfc7498>.\n   [RFC7596]\
    \  Cui, Y., Sun, Q., Boucadair, M., Tsou, T., Lee, Y., and\n              I. Farrer,\
    \ \"Lightweight 4over6: An Extension to the Dual-\n              Stack Lite Architecture\"\
    , RFC 7596, DOI 10.17487/RFC7596,\n              July 2015, <https://www.rfc-editor.org/info/rfc7596>.\n\
    \   [RFC7597]  Troan, O., Ed., Dec, W., Li, X., Bao, C., Matsushima, S.,\n   \
    \           Murakami, T., and T. Taylor, Ed., \"Mapping of Address and\n     \
    \         Port with Encapsulation (MAP-E)\", RFC 7597,\n              DOI 10.17487/RFC7597,\
    \ July 2015,\n              <https://www.rfc-editor.org/info/rfc7597>.\n   [RFC7690]\
    \  Byerly, M., Hite, M., and J. Jaeggli, \"Close Encounters of\n             \
    \ the ICMP Type 2 Kind (Near Misses with ICMPv6 Packet Too\n              Big\
    \ (PTB))\", RFC 7690, DOI 10.17487/RFC7690, January 2016,\n              <https://www.rfc-editor.org/info/rfc7690>.\n\
    \   [RFC7857]  Penno, R., Perreault, S., Boucadair, M., Ed.,\n              Sivakumar,\
    \ S., and K. Naito, \"Updates to Network Address\n              Translation (NAT)\
    \ Behavioral Requirements\", BCP 127,\n              RFC 7857, DOI 10.17487/RFC7857,\
    \ April 2016,\n              <https://www.rfc-editor.org/info/rfc7857>.\n   [RFC7974]\
    \  Williams, B., Boucadair, M., and D. Wing, \"An Experimental\n             \
    \ TCP Option for Host Identification\", RFC 7974,\n              DOI 10.17487/RFC7974,\
    \ October 2016,\n              <https://www.rfc-editor.org/info/rfc7974>.\n  \
    \ [RFC8084]  Fairhurst, G., \"Network Transport Circuit Breakers\",\n        \
    \      BCP 208, RFC 8084, DOI 10.17487/RFC8084, March 2017,\n              <https://www.rfc-editor.org/info/rfc8084>.\n\
    \   [RFC8404]  Moriarty, K., Ed. and A. Morton, Ed., \"Effects of\n          \
    \    Pervasive Encryption on Operators\", RFC 8404,\n              DOI 10.17487/RFC8404,\
    \ July 2018,\n              <https://www.rfc-editor.org/info/rfc8404>.\n   [RFC8406]\
    \  Adamson, B., Adjih, C., Bilbao, J., Firoiu, V., Fitzek,\n              F.,\
    \ Ghanem, S., Lochin, E., Masucci, A., Montpetit, M-J.,\n              Pedersen,\
    \ M., Peralta, G., Roca, V., Ed., Saxena, P., and\n              S. Sivakumar,\
    \ \"Taxonomy of Coding Techniques for Efficient\n              Network Communications\"\
    , RFC 8406, DOI 10.17487/RFC8406,\n              June 2018, <https://www.rfc-editor.org/info/rfc8406>.\n\
    \   [SATELLITES]\n              Kuhn, N. and E. Lochin, \"Network coding and satellites\"\
    ,\n              Work in Progress, draft-irtf-nwcrg-network-coding-\n        \
    \      satellites-02, November 2018.\n   [TCP-CONVERT]\n              Bonaventure,\
    \ O., Boucadair, M., Gundavelli, S., and S.\n              Seo, \"0-RTT TCP Convert\
    \ Protocol\", Work in Progress,\n              draft-ietf-tcpm-converters-04,\
    \ October 2018.\n   [USE-CASE] Napper, J., Stiemerling, M., Lopez, D., and J.\
    \ Uttaro,\n              \"Service Function Chaining Use Cases in Mobile Networks\"\
    ,\n              Work in Progress, draft-ietf-sfc-use-case-mobility-08,\n    \
    \          May 2018.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   The authors thank Brian Trammell, Brian Carpenter, Mirja\
    \ Kuehlewind,\n   Kathleen Moriarty, Gorry Fairhurst, Adrian Farrel, and Nicolas\
    \ Kuhn\n   for their review and suggestions.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   David Dolson (editor)\n   Email: ddolson@acm.org\n   Juho\
    \ Snellman\n   Email: jsnell@iki.fi\n   Mohamed Boucadair (editor)\n   Orange\n\
    \   4 rue du Clos Courtel\n   Rennes  35000\n   France\n   Email: mohamed.boucadair@orange.com\n\
    \   Christian Jacquenet\n   Orange\n   4 rue du Clos Courtel\n   Rennes  35000\n\
    \   France\n   Email: christian.jacquenet@orange.com\n"
