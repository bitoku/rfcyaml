- title: __initial_text__
  contents:
  - '      Downgrading Mechanism for Email Address Internationalization

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n"
- title: Abstract
  contents:
  - "Abstract\n   Traditional mail systems handle only ASCII characters in SMTP\n\
    \   envelope and mail header fields.  The Email Address\n   Internationalization\
    \ (UTF8SMTP) extension allows UTF-8 characters in\n   SMTP envelope and mail header\
    \ fields.  To avoid rejecting\n   internationalized email messages when a server\
    \ in the delivery path\n   does not support the UTF8SMTP extension, some sort\
    \ of converting\n   mechanism is required.  This document describes a downgrading\n\
    \   mechanism for Email Address Internationalization.  Note that this is\n   a\
    \ way to downgrade, not tunnel.  There is no associated up-conversion\n   mechanism,\
    \ although internationalized email clients might use\n   original internationalized\
    \ addresses or other data when displaying or\n   replying to downgraded messages.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \ 3. New Header Fields Definition ....................................5\n    \
    \  3.1. Envelope Information Preservation Header Fields ............5\n      3.2.\
    \ Address Header Fields' Preservation Header Fields ..........6\n      3.3. Unknown\
    \ Header Fields' Preservation Header Fields ..........6\n   4. SMTP Downgrading\
    \ ................................................7\n      4.1. Path Element Downgrading\
    \ ...................................7\n      4.2. ORCPT downgrading ..........................................8\n\
    \   5. Email Header Fields Downgrading .................................8\n  \
    \    5.1. Downgrading Method for Each ABNF Element ...................8\n    \
    \       5.1.1. RECEIVED Downgrading ................................9\n      \
    \     5.1.2. UNSTRUCTURED Downgrading ............................9\n        \
    \   5.1.3. WORD Downgrading ....................................9\n          \
    \ 5.1.4. COMMENT Downgrading .................................9\n           5.1.5.\
    \ MIME-VALUE Downgrading ..............................9\n           5.1.6. DISPLAY-NAME\
    \ Downgrading ............................9\n           5.1.7. MAILBOX Downgrading\
    \ .................................9\n           5.1.8. ENCAPSULATION Downgrading\
    \ ..........................10\n           5.1.9. TYPED-ADDRESS Downgrading ..........................10\n\
    \      5.2. Downgrading Method for Each Header Field ..................10\n  \
    \         5.2.1. Address Header Fields That Contain <address>s ......10\n    \
    \       5.2.2. Address Header Fields with Typed Addresses .........11\n      \
    \     5.2.3. Downgrading Non-ASCII in Comments ..................11\n        \
    \   5.2.4. Received Header Field ..............................11\n          \
    \ 5.2.5. MIME Content Header Fields .........................12\n           5.2.6.\
    \ Non-ASCII in <unstructured> ........................12\n           5.2.7. Non-ASCII\
    \ in <phrase> ..............................12\n           5.2.8. Other Header\
    \ Fields ................................12\n   6. MIME Body-Part Header Field\
    \ Downgrading ........................12\n   7. Security Considerations ........................................13\n\
    \   8. Implementation Notes ...........................................14\n  \
    \    8.1. RFC 2047 Encoding .........................................14\n    \
    \  8.2. Trivial Downgrading .......................................15\n      8.3.\
    \ 7bit Transport Consideration ..............................15\n   9. IANA Considerations\
    \ ............................................16\n   10. Acknowledgements ..............................................18\n\
    \   11. References ....................................................18\n  \
    \    11.1. Normative References .....................................18\n    \
    \  11.2. Informative References ...................................19\n   Appendix\
    \ A.  Examples .............................................20\n     A.1.  Downgrading\
    \ Example 1 .....................................20\n     A.2.  Downgrading Example\
    \ 2 .....................................22\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Traditional mail systems, which are defined by [RFC5321]\
    \ and\n   [RFC5322], allow ASCII characters in SMTP envelope and mail header\n\
    \   field values.  The UTF8SMTP extension ([RFC4952], [RFC5335], and\n   [RFC5336])\
    \ allows UTF-8 characters in SMTP envelope and mail header\n   field values.\n\
    \   If an envelope address or header field contains non-ASCII characters,\n  \
    \ the message cannot be delivered unless every system in the delivery\n   path\
    \ supports UTF8SMTP.  This document describes a downgrading\n   mechanism to avoid\
    \ rejection of such messages when a server that does\n   not support the UTF8SMTP\
    \ extension is encountered.  This downgrading\n   mechanism converts envelope\
    \ and mail header fields to an all-ASCII\n   representation.\n   [RFC5335] allows\
    \ UTF-8 characters to be used in mail header fields\n   and MIME header fields.\
    \  The downgrading mechanism specified here\n   converts mail header fields and\
    \ MIME header fields to ASCII.\n   This document does not change any protocols\
    \ except by defining new\n   header fields.  It describes the conversion method\
    \ from the\n   internationalized email envelopes/messages that are defined in\n\
    \   [RFC4952], [RFC5335], and [RFC5336] to the traditional email\n   envelopes/messages\
    \ defined in [RFC5321] and [RFC5322].\n   Section 3.2 of [RFC5336] defines when\
    \ downgrading occurs.  If the\n   SMTP client has a UTF8SMTP envelope or an internationalized\
    \ message\n   and the SMTP server doesn't support the UTF8SMTP extension, then\
    \ the\n   SMTP client MUST NOT send a UTF8SMTP envelope or an internationalized\n\
    \   message to the SMTP server.  The section lists 4 choices in this\n   case.\
    \  The fourth choice is downgrading, as described here.\n   Downgrading may be\
    \ implemented in Mail User Agents (MUAs), Mail\n   Submission Agents (MSAs), and\
    \ Mail Transport Agents (MTAs) that act\n   as SMTP clients.  It may also be implemented\
    \ in Message Delivery\n   Agents (MDAs), Post Office Protocol (POP) servers, and\
    \ IMAP servers\n   that store or offer UTF8SMTP envelopes or internationalized\
    \ messages\n   to non-UTF8SMTP-compliant systems, which include message stores.\n\
    \   This document tries to define the downgrading process clearly and it\n   preserves\
    \ the original internationalized email information as much as\n   possible.\n\
    \   Downgrading in UTF8SMTP consists of the following four parts:\n   o  New header\
    \ field definitions\n   o  SMTP downgrading\n   o  Email header field downgrading\n\
    \   o  MIME header field downgrading\n   In Section 3 of this document, many header\
    \ fields starting with\n   \"Downgraded-\" are introduced.  They preserve the\
    \ original envelope\n   information and the original header fields.\n   SMTP downgrading\
    \ is described in Section 4.  It generates ASCII-only\n   envelope information\
    \ from a UTF8SMTP envelope.\n   Email header field downgrading is described in\
    \ Section 5.  It\n   generates ASCII-only header fields.\n   MIME header fields\
    \ are expanded in [RFC5335].  MIME header field\n   downgrading is described in\
    \ Section 6.  It generates ASCII-only MIME\n   header fields.\n   Displaying downgraded\
    \ messages that originally contained\n   internationalized email addresses or\
    \ internationalized header fields\n   is described in an another document ([DISPLAY]).\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [RFC2119].\n   All specialized terms used in this specification are defined\
    \ in the\n   Email Address Internationalization (EAI) overview [RFC4952], in the\n\
    \   mail specifications [RFC5321] [RFC5322], or in the MIME documents\n   [RFC2045]\
    \ [RFC2047] [RFC2183] [RFC2231].  The terms \"ASCII address\",\n   \"internationalized\
    \ email address\", \"non-ASCII address\", \"i18mail\n   address\", \"UTF8SMTP\"\
    , \"message\", and \"mailing list\" are used with the\n   definitions from [RFC4952].\n\
    \   This document depends on [RFC5335], [RFC5336], and [RFC5337].  Key\n   words\
    \ used in those documents are used in this document, too.\n   The term \"non-ASCII\"\
    \ refers to a UTF-8 string that contains at least\n   one non-ASCII character.\n\
    \   A \"UTF8SMTP envelope\" has email originator/recipient addresses\n   expanded\
    \ by [RFC5336] and [RFC5337].\n   A \"UTF8SMTP message\" is an email message expanded\
    \ by [RFC5335].\n"
- title: 3.  New Header Fields Definition
  contents:
  - "3.  New Header Fields Definition\n   New header fields starting with \"Downgraded-\"\
    \ are defined here to\n   preserve those original envelope and mail header field\
    \ values that\n   contain UTF-8 characters.  During downgrading, one new \"Downgraded-\"\
    \n   header field is added for each original envelope or mail header field\n \
    \  that cannot be passed as-is to a server that does not support\n   UTF8SMTP.\
    \  The original envelope or mail header field is removed or\n   rewritten.  Only\
    \ those envelope and mail header fields that contain\n   non-ASCII characters\
    \ are affected.  The result of this process is a\n   message that is compliant\
    \ with existing email specifications\n   [RFC5321] and [RFC5322].  The original\
    \ internationalized information\n   can be retrieved by examining the \"Downgraded-\"\
    \ header fields that\n   were added.\n"
- title: 3.1.  Envelope Information Preservation Header Fields
  contents:
  - "3.1.  Envelope Information Preservation Header Fields\n   SMTP envelope downgraded\
    \ information <downgraded-envelope-addr>\n   consists of the original non-ASCII\
    \ address and the downgraded all-\n   ASCII address.  The ABNF [RFC5234] syntax\
    \ is as follows:\n   downgraded-envelope-addr = [FWS] \"<\" [ A-d-l \":\" ] uMailbox\n\
    \                              FWS \"<\" Mailbox \">\" \">\" [CFWS]\n   <uMailbox>\
    \ is defined in [RFC5336]; <Mailbox> and <A-d-l> are defined\n   in Section 4.1.2\
    \ of [RFC5321].\n   Two header fields, \"Downgraded-Mail-From:\" and \"Downgraded-Rcpt-To:\"\
    ,\n   are defined to preserve SMTP envelope downgraded information.  The\n   header\
    \ field syntax is specified as follows:\n   fields             =/ downgradedmailfrom\
    \ / downgradedrcptto\n   downgradedmailfrom =  \"Downgraded-Mail-From:\" unstructured\
    \ CRLF\n   downgradedrcptto   =  \"Downgraded-Rcpt-To:\"   unstructured CRLF\n\
    \   The unstructured content is downgraded-envelope-addr and treated as\n   if\
    \ it were unstructured, with [RFC2047] encoding (and charset UTF-8)\n   as needed.\n"
- title: 3.2.  Address Header Fields' Preservation Header Fields
  contents:
  - "3.2.  Address Header Fields' Preservation Header Fields\n   The address header\
    \ fields' preservation header fields are defined to\n   preserve the original\
    \ header field.  Their value field holds the\n   original header field value.\
    \  The header field syntax is specified as\n   follows:\n   fields           \
    \        =/ known-downgraded-headers \":\"\n                               unstructured\
    \ CRLF\n   known-downgraded-headers =  \"Downgraded-\" original-headers\n   original-headers\
    \         =  \"From\" / \"Sender\" /\n                               \"To\" /\
    \ \"Cc\" / \"Bcc\" /\n                               \"Reply-To\" /\n        \
    \                       \"Resent-From\" / \"Resent-Sender\" /\n              \
    \                 \"Resent-To\" / \"Resent-Cc\" /\n                          \
    \     \"Resent-Bcc\" / \"Resent-Reply-To\" /\n                               \"\
    Return-Path\" /\n                               \"Disposition-Notification-To\"\
    \n   To preserve a header field in a \"Downgraded-\" header field:\n   1.  Generate\
    \ a new \"Downgraded-\" header field whose value is the\n       original header\
    \ field value.\n   2.  Treat the generated header field content as if it were\n\
    \       unstructured, and then apply [RFC2047] encoding with charset\n       UTF-8\
    \ as necessary so that the result is ASCII.\n"
- title: 3.3.  Unknown Header Fields' Preservation Header Fields
  contents:
  - "3.3.  Unknown Header Fields' Preservation Header Fields\n   The unknown header\
    \ fields' preservation header fields are defined to\n   encapsulate those original\
    \ header fields that contain non-ASCII\n   characters and are not otherwise provided\
    \ for in this specification.\n   The encapsulation header field name is the concatenation\
    \ of\n   \"Downgraded-\" and the original name.  The value field holds the\n \
    \  original header field value.\n   The header field syntax is specified as follows:\n\
    \   fields     =/ unknown-downgraded-headers \":\" unstructured CRLF\n   unknown-downgraded-headers\
    \ = \"Downgraded-\" original-header-field-name\n   original-header-field-name\
    \ = field-name\n   field-name =  1*ftext\n   ftext      =  %d33-57 /         \
    \  ; Any character except\n                 %d59-126            ;  controls, SP,\
    \ and \":\".\n   To encapsulate a header field in a \"Downgraded-\" header field:\n\
    \   1.  Generate a new \"Downgraded-\" header field whose value is the\n     \
    \  original header field value.\n   2.  Treat the generated header field content\
    \ as if it were\n       unstructured, and then apply [RFC2047] encoding with charset\n\
    \       UTF-8 as necessary so the result is ASCII.\n   3.  Remove the original\
    \ header field.\n"
- title: 4.  SMTP Downgrading
  contents:
  - "4.  SMTP Downgrading\n   The targets of downgrading elements in an SMTP envelope\
    \ are below:\n   o  <reverse-path> of MAIL FROM command\n   o  <forward-path>\
    \ of RCPT TO command\n   o  ORCPT parameter of RCPT TO command\n   <reverse-path>\
    \ and <forward-path> are described in [RFC5321] and\n   [RFC5336].  The ORCPT\
    \ parameter is described in [RFC3461] and\n   [RFC5337].\n"
- title: 4.1.  Path Element Downgrading
  contents:
  - "4.1.  Path Element Downgrading\n   Downgrading the <path> of MAIL FROM and RCPT\
    \ TO commands uses the\n   ALT-ADDRESS parameter defined in [RFC5336].  An SMTP\
    \ command is\n   downgradable if the <path> contains a non-ASCII address and the\n\
    \   command has an ALT-ADDRESS parameter that specifies an ASCII address.\n  \
    \ Since only non-ASCII addresses are downgradable, specifying an ALT-\n   ADDRESS\
    \ value for an all-ASCII address is invalid for use with this\n   specification,\
    \ and no interpretation is assigned to it.  This\n   restriction allows for future\
    \ extension of the specification even\n   though no such extensions are currently\
    \ anticipated.\n   Note that even if no downgrading is performed on the envelope,\n\
    \   message header fields and message body MIME header fields that\n   contain\
    \ non-ASCII characters MUST be downgraded.  This is described\n   in Sections\
    \ 5 and 6.\n   When downgrading, replace each <path> that contains a non-ASCII\
    \ mail\n   address with its specified alternative ASCII address, and preserve\n\
    \   the original information using \"Downgraded-Mail-From\" and\n   \"Downgraded-Rcpt-To\"\
    \ header fields as defined in Section 3.  Before\n   replacing, decode the ALT-ADDRESS\
    \ parameter value because it is\n   encoded as xtext [RFC3461].\n   To avoid disclosing\
    \ recipient addresses, the downgrading process MUST\n   NOT add the \"Downgraded-Rcpt-To:\"\
    \ header field if the SMTP\n   downgrading targets multiple recipients.  See Section\
    \ 7 for more\n   details.\n   As a result of the recipient address downgrading,\
    \ the domain part of\n   the recipient address prior to downgrading might be different\
    \ from\n   the domain part of the new recipient address.  If the result of\n \
    \  address resolution for the domain part of the new recipient address\n   contains\
    \ the server at the connection destination of the SMTP session\n   for the recipient\
    \ address prior to downgrading, the SMTP connection\n   is valid for the new recipient\
    \ address.  Otherwise, the downgrading\n   process MUST NOT send the downgraded\
    \ message to the new recipient\n   address via the connection and MUST try to\
    \ send the downgraded\n   message to the new recipient address.\n"
- title: 4.2.  ORCPT downgrading
  contents:
  - "4.2.  ORCPT downgrading\n   The \"RCPT TO\" command can have an ORCPT parameter\
    \ if the Delivery\n   Status Notification (DSN) extension [RFC3461] is supported.\
    \  If the\n   ORCPT parameter contains a \"utf-8\" type address and the address\n\
    \   contains raw non-ASCII characters, the address MUST be converted to\n   utf-8-addr-xtext\
    \ form.  Those forms are described in [RFC5337] and\n   clarified by successor\
    \ documents such as [DSNBIS].\n   Before converting to utf-8-addr-xtext form,\
    \ remove xtext encoding.\n"
- title: 5.  Email Header Fields Downgrading
  contents:
  - "5.  Email Header Fields Downgrading\n   This section defines the conversion method\
    \ to ASCII for each header\n   field that may contain non-ASCII characters.\n\
    \   [RFC5335] expands \"Received:\" header fields; [RFC5322] describes ABNF\n\
    \   elements <mailbox>, <word>, <comment>, <unstructured>; [RFC2045]\n   describes\
    \ ABNF element <value>.\n"
- title: 5.1.  Downgrading Method for Each ABNF Element
  contents:
  - "5.1.  Downgrading Method for Each ABNF Element\n   Header field downgrading is\
    \ defined below for each ABNF element.\n   Downgrading an unknown header field\
    \ is also defined as ENCAPSULATION\n   downgrading.  Converting the header field\
    \ terminates when no non-\n   ASCII characters remain in the header field.\n"
- title: 5.1.1.  RECEIVED Downgrading
  contents:
  - "5.1.1.  RECEIVED Downgrading\n   If the header field name is \"Received:\" and\
    \ the FOR clause contains a\n   non-ASCII address, remove the FOR clause from\
    \ the header field.\n   Other parts (not counting <comment>s) should not contain\
    \ non-ASCII\n   values.\n"
- title: 5.1.2.  UNSTRUCTURED Downgrading
  contents:
  - "5.1.2.  UNSTRUCTURED Downgrading\n   If the header field has an <unstructured>\
    \ field that contains non-\n   ASCII characters, apply [RFC2047] encoding with\
    \ charset UTF-8.\n"
- title: 5.1.3.  WORD Downgrading
  contents:
  - "5.1.3.  WORD Downgrading\n   If the header field has any <word> fields that contain\
    \ non-ASCII\n   characters, apply [RFC2047] encoding with charset UTF-8.\n"
- title: 5.1.4.  COMMENT Downgrading
  contents:
  - "5.1.4.  COMMENT Downgrading\n   If the header field has any <comment> fields\
    \ that contain non-ASCII\n   characters, apply [RFC2047] encoding with charset\
    \ UTF-8.\n"
- title: 5.1.5.  MIME-VALUE Downgrading
  contents:
  - "5.1.5.  MIME-VALUE Downgrading\n   If the header field has any <value> elements\
    \ defined by [RFC2045] and\n   the elements contain non-ASCII characters, encode\
    \ the <value>\n   elements according to [RFC2231] with charset UTF-8 and leave\
    \ the\n   language information empty.  If the <value> element is <quoted-\n  \
    \ string> and it contains <CFWS> outside the DQUOTE, remove the <CFWS>\n   before\
    \ this conversion.\n"
- title: 5.1.6.  DISPLAY-NAME Downgrading
  contents:
  - "5.1.6.  DISPLAY-NAME Downgrading\n   If the header field has any <address> (<mailbox>\
    \ or <group>) elements\n   and they have <display-name> elements that contain\
    \ non-ASCII\n   characters, encode the <display-name> elements according to [RFC2047]\n\
    \   with charset UTF-8.  DISPLAY-NAME downgrading is the same algorithm\n   as\
    \ WORD downgrading.\n"
- title: 5.1.7.  MAILBOX Downgrading
  contents:
  - "5.1.7.  MAILBOX Downgrading\n   The <mailbox> elements have no equivalent format\
    \ for non-ASCII\n   addresses.  If the header field has any <mailbox> elements\
    \ that\n   contain non-ASCII characters, preserve the header field in the\n  \
    \ corresponding \"Downgraded-\" header field, which is defined in\n   Section\
    \ 3.2, and rewrite each <mailbox> element to ASCII-only format.\n   The <mailbox>\
    \ element that contains non-ASCII characters is one of\n   three formats.\n  \
    \ o  [ Display-name ] \"<\" Utf8-addr-spec 1*FCS \"<\" Addr-spec \">>\"\n    \
    \     Rewrite it as:\n         [ Display-name ] \"<\" Addr-spec \">\"\n   o  [\
    \ Display-name ] \"<\" Utf8-addr-spec \">\"\n   o  Utf8-addr-spec\n         Rewrite\
    \ both as:\n         [ Display-name ] \"Internationalized Address \" Encoded-word\n\
    \         \" Removed:;\"\n         where the <Encoded-word> is the original <Utf8-addr-spec>\n\
    \         encoded according to [RFC2047].\n"
- title: 5.1.8.  ENCAPSULATION Downgrading
  contents:
  - "5.1.8.  ENCAPSULATION Downgrading\n   If the header field contains non-ASCII\
    \ characters and is such that no\n   rule is given above, encapsulate it in a\
    \ \"Downgraded-\" header field\n   as described in Section 3.3 as a last resort.\n\
    \   Applying this procedure to \"Received:\" header field is prohibited.\n"
- title: 5.1.9.  TYPED-ADDRESS Downgrading
  contents:
  - "5.1.9.  TYPED-ADDRESS Downgrading\n   If the header field contains <utf-8-type-addr>\
    \ and the <utf-8-type-\n   addr> contains raw non-ASCII characters, it is in utf-8-address\
    \ form.\n   Convert it to utf-8-addr-xtext form as described in Section 4.2.\n\
    \   COMMENT downgrading is also performed in this case.  If the address\n   type\
    \ is unrecognized and the header field contains non-ASCII\n   characters, then\
    \ fall back to using ENCAPSULATION downgrading on the\n   entire header field.\n"
- title: 5.2.  Downgrading Method for Each Header Field
  contents:
  - "5.2.  Downgrading Method for Each Header Field\n   Header fields are listed in\
    \ [RFC4021].  This section describes the\n   downgrading method for each header\
    \ field.\n   If the whole mail header field does not contain non-ASCII characters,\n\
    \   email header field downgrading is not required.  Each header field's\n   downgrading\
    \ method is described below.\n"
- title: 5.2.1.  Address Header Fields That Contain <address>s
  contents:
  - "5.2.1.  Address Header Fields That Contain <address>s\n   From:\n   Sender:\n\
    \   To:\n   Cc:\n   Bcc:\n   Reply-To:\n   Resent-From:\n   Resent-Sender:\n \
    \  Resent-To:\n   Resent-Cc:\n   Resent-Bcc:\n   Resent-Reply-To:\n   Return-Path:\n\
    \   Disposition-Notification-To:\n   If the header field contains <mailbox> elements\
    \ that contain non-\n   ASCII addresses, preserve the header field in a \"Downgraded-\"\
    \ header\n   field before the conversion.  Then perform COMMENT downgrading,\n\
    \   DISPLAY-NAME downgrading, and MAILBOX downgrading.\n"
- title: 5.2.2.  Address Header Fields with Typed Addresses
  contents:
  - "5.2.2.  Address Header Fields with Typed Addresses\n   Original-Recipient:\n\
    \   Final-Recipient:\n   If the header field contains non-ASCII characters, perform\
    \ TYPED-\n   ADDRESS downgrading.\n"
- title: 5.2.3.  Downgrading Non-ASCII in Comments
  contents:
  - "5.2.3.  Downgrading Non-ASCII in Comments\n   Date:\n   Message-ID:\n   Resent-Message-ID:\n\
    \   In-Reply-To:\n   References:\n   Resent-Date:\n   Resent-Message-ID:\n   MIME-Version:\n\
    \   Content-ID:\n   Content-Transfer-Encoding:\n   Content-Language:\n   Accept-Language:\n\
    \   Auto-Submitted:\n   These header fields do not contain non-ASCII characters\
    \ except in\n   comments.  If the header field contains UTF-8 characters in comments,\n\
    \   perform COMMENT downgrading.\n"
- title: 5.2.4.  Received Header Field
  contents:
  - "5.2.4.  Received Header Field\n   Received:\n   Perform COMMENT downgrading and\
    \ RECEIVED downgrading.\n"
- title: 5.2.5.  MIME Content Header Fields
  contents:
  - "5.2.5.  MIME Content Header Fields\n   Content-Type:\n   Content-Disposition:\n\
    \   Perform MIME-VALUE downgrading and COMMENT downgrading.\n"
- title: 5.2.6.  Non-ASCII in <unstructured>
  contents:
  - "5.2.6.  Non-ASCII in <unstructured>\n   Subject:\n   Comments:\n   Content-Description:\n\
    \   Perform UNSTRUCTURED downgrading.\n"
- title: 5.2.7.  Non-ASCII in <phrase>
  contents:
  - "5.2.7.  Non-ASCII in <phrase>\n   Keywords:\n   Perform WORD downgrading.\n"
- title: 5.2.8.  Other Header Fields
  contents:
  - "5.2.8.  Other Header Fields\n   For all other header fields that contain non-ASCII\
    \ characters, are\n   user-defined, and are missing from this document or future\
    \ defined\n   header fields, perform ENCAPSULATION downgrading.\n   If the software\
    \ understands the header field's structure and a\n   downgrading algorithm other\
    \ than ENCAPSULATION is applicable, that\n   software SHOULD use that algorithm;\
    \ ENCAPSULATION downgrading is used\n   as a last resort.\n   Mailing list header\
    \ fields (those that start in \"List-\") are part of\n   this category.\n"
- title: 6.  MIME Body-Part Header Field Downgrading
  contents:
  - "6.  MIME Body-Part Header Field Downgrading\n   MIME body-part header fields\
    \ may contain non-ASCII characters\n   [RFC5335].  This section defines the conversion\
    \ method to ASCII-only\n   header fields for each MIME header field that contains\
    \ non-ASCII\n   characters.  Parse the message body's MIME structure at all levels\n\
    \   and check each MIME header field to see whether it contains non-ASCII\n  \
    \ characters.  If the header field contains non-ASCII characters in the\n   header\
    \ field value, the header field is a target of the MIME body-\n   part header\
    \ field's downgrading.  Each MIME header field's\n   downgrading method is described\
    \ below.  COMMENT downgrading, MIME-\n   VALUE downgrading, and UNSTRUCTURED downgrading\
    \ are described in\n   Section 5.\n   Content-ID:\n      The \"Content-ID:\" header\
    \ field does not contain non-ASCII\n      characters except in comments.  If the\
    \ header field contains UTF-8\n      characters in comments, perform COMMENT downgrading.\n\
    \   Content-Type:\n      Content-Disposition:  Perform MIME-VALUE downgrading\
    \ and COMMENT\n                            downgrading.\n      Content-Description:\
    \  Perform UNSTRUCTURED downgrading.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   A downgraded message's header fields contain\
    \ ASCII characters only.\n   But they still contain MIME-encapsulated header fields\
    \ that contain\n   non-ASCII UTF-8 characters.  Furthermore, the body part may\
    \ contain\n   UTF-8 characters.  Implementations parsing Internet messages need\
    \ to\n   accept UTF-8 body parts and UTF-8 header fields that are MIME-\n   encoded.\
    \  Thus, this document inherits the security considerations of\n   MIME-encoded\
    \ header fields ([RFC2047] and [RFC3629]).\n   Rewriting header fields increases\
    \ the opportunities for undetected\n   spoofing by malicious senders.  However,\
    \ rewritten header fields are\n   preserved into Downgraded-* header fields, and\
    \ parsing Downgraded-*\n   header fields enables the detection of spoofing caused\
    \ by\n   downgrading.\n   Addresses that do not appear in the message header fields\
    \ may appear\n   in the RCPT commands to an SMTP server for a number of reasons.\n\
    \   Copying information from the envelope into the header fields risks\n   inadvertent\
    \ information disclosure (see [RFC5321] and Section 4 of\n   this document). \
    \ Mitigating inadvertent information disclosure is\n   also discussed in these\
    \ locations.\n   The techniques described here invalidate methods that depend\
    \ on\n   digital signatures over the envelope or any part of the message,\n  \
    \ which includes the top-level header fields and body-part header\n   fields.\
    \  Depending on the specific message being downgraded, the\n   following techniques\
    \ are likely to break: DomainKeys Identified Mail\n   (DKIM), and possibly S/MIME\
    \ and Pretty Good Privacy (PGP).  The two\n   obvious mitigations are to stick\
    \ to 7-bit transport when using these\n   techniques (as most/all of them presently\
    \ require) or to make sure to\n   have UTF8SMTP end-to-end when needed.\n   Many\
    \ gateways and servers on the Internet will discard header fields\n   with which\
    \ they are not familiar.  To the extent to which the\n   downgrade procedures\
    \ depend on new header fields (e.g.,\n   \"Downgraded-\") to avoid information\
    \ loss, the risk of having those\n   header fields dropped and subsequent implications\
    \ must be identified.\n   In particular, if the \"Downgraded-\" header fields\
    \ are dropped, there\n   is no possibility of reconstructing the original information\
    \ at any\n   point (before, during, or after delivery).  Such gateways violate\n\
    \   [RFC2979] and can be upgraded to correct the problem.\n   Even though the\
    \ information is not lost, the original message cannot\n   be perfectly reconstructed\
    \ because some downgrading methods remove\n   information (see Sections 5.1.1\
    \ and 5.1.5).  Hence, downgrading is a\n   one-way process.\n   While information\
    \ in any email header field should usually be treated\n   with some suspicion,\
    \ current email systems commonly employ various\n   mechanisms and protocols to\
    \ make the information more trustworthy.\n   Currently, information in the new\
    \ Downgraded-* header fields is\n   usually not inspected by these mechanisms,\
    \ and may be even less\n   trustworthy than the traditional header fields.  Note\
    \ that the\n   Downgraded-* header fields could have been inserted with malicious\n\
    \   intent (and with content unrelated to the traditional header fields).\n  \
    \ If an internationalized MUA would simply try to \"upgrade\" the message\n  \
    \ for display purposes (that is, display the information in the\n   Downgraded-*\
    \ header fields instead of the traditional header fields),\n   the effectiveness\
    \ of the deployed mechanisms and protocols is likely\n   to be reduced, and the\
    \ user may be exposed to additional risks.  More\n   guidance on how to display\
    \ downgraded messages is given in [DISPLAY].\n   Concerns about the trustworthiness\
    \ of the Downgraded-* header fields\n   are not limited to displaying and replying\
    \ in MUAs, and should be\n   carefully considered before using such header fields\
    \ for other\n   purposes as well.\n   See the \"Security Considerations\" section\
    \ in [RFC4952] for more\n   discussion.\n"
- title: 8.  Implementation Notes
  contents:
  - '8.  Implementation Notes

    '
- title: 8.1.  RFC 2047 Encoding
  contents:
  - "8.1.  RFC 2047 Encoding\n   While [RFC2047] has a specific algorithm to deal\
    \ with whitespace in\n   adjacent encoded words, there are a number of deployed\n\
    \   implementations that fail to implement the algorithm correctly.  As a\n  \
    \ result, whitespace behavior is somewhat unpredictable in practice\n   when multiple\
    \ encoded words are used.  While RFC 5322 states that\n   implementations SHOULD\
    \ limit lines to not more than 78 characters,\n   implementations MAY choose to\
    \ allow overly long encoded words in\n   order to work around faulty [RFC2047]\
    \ implementations.\n   Implementations that choose to do so SHOULD have an optional\n\
    \   mechanism to limit line length to 78 characters.\n"
- title: 8.2.  Trivial Downgrading
  contents:
  - "8.2.  Trivial Downgrading\n   Downgrading is an alternative to avoid the rejection\
    \ of messages that\n   require UTF8SMTP support by a server that does not provide\
    \ such\n   support.  Implementing the full specification of this document is\n\
    \   desirable, but a partial implementation is also possible.\n   If a partial\
    \ downgrading implementation confronts an unsupported\n   downgrading target,\
    \ the implementation MUST NOT send the message to a\n   server that does not support\
    \ UTF8SMTP.  Instead, it MUST either\n   reject the message or generate a notification\
    \ of non-deliverability.\n   A partial downgrading, trivial downgrading, is discussed.\
    \  It does\n   not support non-ASCII addresses in SMTP envelope and address header\n\
    \   fields, unknown header field downgrading, or the MIME body-part\n   header\
    \ field downgrading.  It supports:\n   o  some simple header field downgrading:\
    \ Subject\n   o  comments and display name downgrading: From, To, Cc\n   o  trace\
    \ header field downgrading: Received\n   Otherwise, the downgrading fails.\n \
    \  Trivial downgrading targets mail messages that are generated by\n   UTF8SMTP-aware\
    \ MUAs and contain non-ASCII characters in comments,\n   display names, and unstructured\
    \ parts without using non-ASCII email\n   addresses.  These mail messages usually\
    \ do not contain non-ASCII\n   email addresses in the SMTP envelope and its header\
    \ fields.  But it\n   is not deliverable via a UTF8SMTP-unaware SMTP server. \
    \ Implementing\n   full specification downgrading may be hard, but trivial downgrading\n\
    \   saves mail messages without using non-ASCII addresses.\n"
- title: 8.3.  7bit Transport Consideration
  contents:
  - "8.3.  7bit Transport Consideration\n   The SMTP client may encounter a SMTP server\
    \ that does not support the\n   8BITMIME SMTP extension [RFC1652].  The server\
    \ does not support\n   \"8bit\" or \"binary\" data.  Implementers need to consider\
    \ converting\n   \"8bit\" data to \"base64\" or \"quoted-printable\" encoded form\
    \ and adjust\n   the \"Content-Transfer-Encoding\" header field accordingly. \
    \ If the\n   body contains multiple MIME parts, this conversion MUST be performed\n\
    \   for each MIME part.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   IANA has registered the following header fields in\
    \ the Permanent\n   Message Header Field registry, in accordance with the procedures\
    \ set\n   out in [RFC3864].\n   Header field name:  Downgraded-Mail-From\n   Applicable\
    \ protocol:  mail\n   Status:  experimental\n   Author/change controller:  IETF\n\
    \   Specification document(s):  This document (Section 3)\n   Header field name:\
    \  Downgraded-Rcpt-To\n   Applicable protocol:  mail\n   Status:  experimental\n\
    \   Author/change controller:  IETF\n   Specification document(s):  This document\
    \ (Section 3)\n   Header field name:  Downgraded-From\n   Applicable protocol:\
    \  mail\n   Status:  experimental\n   Author/change controller:  IETF\n   Specification\
    \ document(s):  This document (Section 3)\n   Header field name:  Downgraded-Sender\n\
    \   Applicable protocol:  mail\n   Status:  experimental\n   Author/change controller:\
    \  IETF\n   Specification document(s):  This document (Section 3)\n   Header field\
    \ name:  Downgraded-To\n   Applicable protocol:  mail\n   Status:  experimental\n\
    \   Author/change controller:  IETF\n   Specification document(s):  This document\
    \ (Section 3)\n   Header field name:  Downgraded-Cc\n   Applicable protocol: \
    \ mail\n   Status:  experimental\n   Author/change controller:  IETF\n   Specification\
    \ document(s):  This document (Section 3)\n   Header field name:  Downgraded-Bcc\n\
    \   Applicable protocol:  mail\n   Status:  experimental\n   Author/change controller:\
    \  IETF\n   Specification document(s):  This document (Section 3)\n   Header field\
    \ name:  Downgraded-Reply-To\n   Applicable protocol:  mail\n   Status:  experimental\n\
    \   Author/change controller:  IETF\n   Specification document(s):  This document\
    \ (Section 3)\n   Header field name:  Downgraded-Resent-From\n   Applicable protocol:\
    \  mail\n   Status:  experimental\n   Author/change controller:  IETF\n   Specification\
    \ document(s):  This document (Section 3)\n   Header field name:  Downgraded-Resent-Sender\n\
    \   Applicable protocol:  mail\n   Status:  experimental\n   Author/change controller:\
    \  IETF\n   Specification document(s):  This document (Section 3)\n   Header field\
    \ name:  Downgraded-Resent-To\n   Applicable protocol:  mail\n   Status:  experimental\n\
    \   Author/change controller:  IETF\n   Specification document(s):  This document\
    \ (Section 3)\n   Header field name:  Downgraded-Resent-Cc\n   Applicable protocol:\
    \  mail\n   Status:  experimental\n   Author/change controller:  IETF\n   Specification\
    \ document(s):  This document (Section 3)\n   Header field name:  Downgraded-Resent-Bcc\n\
    \   Applicable protocol:  mail\n   Status:  experimental\n   Author/change controller:\
    \  IETF\n   Specification document(s):  This document (Section 3)\n   Header field\
    \ name:  Downgraded-Resent-Reply-To\n   Applicable protocol:  mail\n   Status:\
    \  experimental\n   Author/change controller:  IETF\n   Specification document(s):\
    \  This document (Section 3)\n   Header field name:  Downgraded-Return-Path\n\
    \   Applicable protocol:  mail\n   Status:  experimental\n   Author/change controller:\
    \  IETF\n   Specification document(s):  This document (Section 3)\n   Header field\
    \ name:  Downgraded-Disposition-Notification-To\n   Applicable protocol:  mail\n\
    \   Status:  experimental\n   Author/change controller:  IETF\n   Specification\
    \ document(s):  This document (Section 3)\n   Furthermore, IANA is requested to\
    \ refuse registration of all field\n   names that start with \"Downgraded-\".\
    \  For unknown header fields, use\n   the downgrading method described in Section\
    \ 3.3 to avoid conflicts\n   with existing IETF activity (Email Address Internationalization).\n"
- title: 10.  Acknowledgements
  contents:
  - "10.  Acknowledgements\n   Significant comments and suggestions were received\
    \ from John Klensin,\n   Harald Alvestrand, Chris Newman, Randall Gellens, Charles\
    \ Lindsey,\n   Marcos Sanz, Alexey Melnikov, Frank Ellermann, Edward Lewis, S.\n\
    \   Moonesamy, and JET members.\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC1652]  Klensin, J., Freed, N., Rose, M.,\
    \ Stefferud, E., and D.\n              Crocker, \"SMTP Service Extension for 8bit-MIMEtransport\"\
    ,\n              RFC 1652, July 1994.\n   [RFC2045]  Freed, N. and N. Borenstein,\
    \ \"Multipurpose Internet Mail\n              Extensions (MIME) Part One: Format\
    \ of Internet Message\n              Bodies\", RFC 2045, November 1996.\n   [RFC2047]\
    \  Moore, K., \"MIME (Multipurpose Internet Mail Extensions)\n              Part\
    \ Three: Message Header Extensions for Non-ASCII Text\",\n              RFC 2047,\
    \ November 1996.\n   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n\
    \              Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2183]\
    \  Troost, R., Dorner, S., and K. Moore, \"Communicating\n              Presentation\
    \ Information in Internet Messages: The\n              Content-Disposition Header\
    \ Field\", RFC 2183, August 1997.\n   [RFC2231]  Freed, N. and K. Moore, \"MIME\
    \ Parameter Value and Encoded\n              Word Extensions:\n              Character\
    \ Sets, Languages, and Continuations\", RFC 2231,\n              November 1997.\n\
    \   [RFC2979]  Freed, N., \"Behavior of and Requirements for Internet\n      \
    \        Firewalls\", RFC 2979, October 2000.\n   [RFC3461]  Moore, K., \"Simple\
    \ Mail Transfer Protocol (SMTP) Service\n              Extension for Delivery\
    \ Status Notifications (DSNs)\",\n              RFC 3461, January 2003.\n   [RFC3629]\
    \  Yergeau, F., \"UTF-8, a transformation format of ISO\n              10646\"\
    , STD 63, RFC 3629, November 2003.\n   [RFC3864]  Klyne, G., Nottingham, M., and\
    \ J. Mogul, \"Registration\n              Procedures for Message Header Fields\"\
    , BCP 90, RFC 3864,\n              September 2004.\n   [RFC4021]  Klyne, G. and\
    \ J. Palme, \"Registration of Mail and MIME\n              Header Fields\", RFC\
    \ 4021, March 2005.\n   [RFC4952]  Klensin, J. and Y. Ko, \"Overview and Framework\
    \ for\n              Internationalized Email\", RFC 4952, July 2007.\n   [RFC5234]\
    \  Crocker, D. and P. Overell, \"Augmented BNF for Syntax\n              Specifications:\
    \ ABNF\", STD 68, RFC 5234, January 2008.\n   [RFC5321]  Klensin, J., \"Simple\
    \ Mail Transfer Protocol\", RFC 5321,\n              October 2008.\n   [RFC5322]\
    \  Resnick, P., Ed., \"Internet Message Format\", RFC 5322,\n              October\
    \ 2008.\n   [RFC5335]  Abel, Y., \"Internationalized Email Headers\", RFC 5335,\n\
    \              September 2008.\n   [RFC5336]  Yao, J. and W. Mao, \"SMTP Extension\
    \ for Internationalized\n              Email Addresses\", RFC 5336, September\
    \ 2008.\n   [RFC5337]  Newman, C. and A. Melnikov, \"Internationalized Delivery\n\
    \              Status and Disposition Notifications\", RFC 5337,\n           \
    \   September 2008.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [DISPLAY]  Fujiwara, K., \"Displaying Downgraded\
    \ Messages for Email\n              Address Internationalization\", Work in Progress,\n\
    \              March 2009.\n   [DSNBIS]   Newman, C. and A. Melnikov, \"Internationalized\
    \ Delivery\n              Status and Disposition Notifications\", Work in Progress,\n\
    \              December 2008.\n"
- title: Appendix A.  Examples
  contents:
  - 'Appendix A.  Examples

    '
- title: A.1.  Downgrading Example 1
  contents:
  - "A.1.  Downgrading Example 1\n   This appendix shows an SMTP downgrading example.\
    \  Consider a mail\n   message where:\n   o  The sender address is \"NON-ASCII-local@example.com\"\
    , which is a\n      non-ASCII address.  Its ASCII alternative is\n      \"ASCII-local@example.com\"\
    \ and its display-name is \"DISPLAY-local\".\n   o  The \"To:\" address is \"\
    NON-ASCII-remote1@example.net\", which is a\n      non-ASCII address.  Its ASCII\
    \ alternative is\n      \"ASCII-remote1@example.net\" and its display-name is\
    \ \"DISPLAY-\n      remote1\".\n   o  The \"Cc:\" address is a non-ASCII address,\n\
    \      \"NON-ASCII-remote2@example.org\", without an alternative ASCII\n     \
    \ address.  Its display-name is \"DISPLAY-remote2\".\n   o  Three display names\
    \ contain non-ASCII characters.\n   o  The Subject header field is \"NON-ASCII-SUBJECT\"\
    , which contains\n      non-ASCII characters.\n   o  Assume the \"To:\" recipient's\
    \ MTA (example.net) does not support\n      UTF8SMTP.\n   o  Assume the \"Cc:\"\
    \ recipient's MTA (example.org) supports UTF8SMTP.\n   The first example SMTP\
    \ envelope/message is shown in Figure 1.  In\n   this example, the \"To:\" recipient's\
    \ session is the focus.\n   MAIL FROM: <NON-ASCII-local@example.com>\n       \
    \        ALT-ADDRESS=ASCII-local@example.com\n   RCPT TO: <NON-ASCII-remote1@example.net>\n\
    \             ALT-ADDRESS=ASCII-remote1@example.net\n   RCPT TO: <NON-ASCII-remote2@example.org>\n\
    \   -------------------------------------------------------------\n   Message-Id:\
    \ MESSAGE_ID\n   Mime-Version: 1.0\n   Content-Type: text/plain; charset=\"UTF-8\"\
    \n   Content-Transfer-Encoding: 8bit\n   Subject: NON-ASCII-SUBJECT\n   From:\
    \ DISPLAY-local <NON-ASCII-local@example.com\n    <ASCII-local@example.com>>\n\
    \   To: DISPLAY-remote1 <NON-ASCII-remote1@example.net\n    <ASCII-remote1@example.net>>\n\
    \   Cc: DISPLAY-remote2 <NON-ASCII-remote2@example.org>\n   Date: DATE\n   MAIL_BODY\n\
    \              Figure 1: Original envelope/message (example 1)\n   In this example,\
    \ there are two SMTP recipients; one is \"To:\", the\n   other is \"Cc:\".  The\
    \ SMTP downgrading uses To: session downgrading.\n   Figure 2 shows an SMTP downgraded\
    \ example.\n   MAIL FROM: <ASCII-local@example.com>\n   RCPT TO: <ASCII-remote1@example.net>\n\
    \   -------------------------------------------------------------\n   Downgraded-Mail-From:\
    \ =?UTF-8?Q?<NON-ASCII-local@example.com_?=\n    =?UTF-8?Q?<ASCII-local@example.com>>?=\n\
    \   Downgraded-Rcpt-To: =?UTF-8?Q?<NON-ASCII-remote1@example.net_?=\n    =?UTF-8?Q?<ASCII-remote1@example.net>>?=\n\
    \   Message-Id: MESSAGE_ID\n   Mime-Version: 1.0\n   Content-Type: text/plain;\
    \ charset=\"UTF-8\"\n   Content-Transfer-Encoding: 8bit\n   Subject: NON-ASCII-SUBJECT\n\
    \   From: DISPLAY-local <NON-ASCII-local@example.com\n    <ASCII-local@example.com>>\n\
    \   To: DISPLAY-remote1 <NON-ASCII-remote1@example.net\n    <ASCII-remote1@example.net>>\n\
    \   Cc: DISPLAY-remote2 <NON-ASCII-remote2@example.org>\n   Date: DATE\n   MAIL_BODY\n\
    \          Figure 2: SMTP downgraded envelope/message (example 1)\n   After SMTP\
    \ downgrading, header field downgrading is performed.  The\n   final downgraded\
    \ message is shown in Figure 3.  A Return-Path header\n   field will be added\
    \ by the final destination MTA.\n"
- title: 'Return-Path: <ASCII-local@example.com>'
  contents:
  - 'Return-Path: <ASCII-local@example.com>

    '
- title: 'Downgraded-Mail-From: =?UTF-8?Q?<NON-ASCII-local@example.com_?='
  contents:
  - "Downgraded-Mail-From: =?UTF-8?Q?<NON-ASCII-local@example.com_?=\n =?UTF-8?Q?<ASCII-local@example.com>>?=\n"
- title: 'Downgraded-Rcpt-To: =?UTF-8?Q?<NON-ASCII-remote1@example.net_?='
  contents:
  - "Downgraded-Rcpt-To: =?UTF-8?Q?<NON-ASCII-remote1@example.net_?=\n =?UTF-8?Q?<ASCII-remote1@example.net>>?=\n"
- title: 'Message-Id: MESSAGE_ID'
  contents:
  - 'Message-Id: MESSAGE_ID

    '
- title: 'Mime-Version: 1.0'
  contents:
  - 'Mime-Version: 1.0

    '
- title: 'Content-Type: text/plain; charset="UTF-8"'
  contents:
  - 'Content-Type: text/plain; charset="UTF-8"

    '
- title: 'Content-Transfer-Encoding: 8bit'
  contents:
  - 'Content-Transfer-Encoding: 8bit

    '
- title: 'Subject: =?UTF-8?Q?NON-ASCII-SUBJECT?='
  contents:
  - 'Subject: =?UTF-8?Q?NON-ASCII-SUBJECT?=

    '
- title: 'From: =?UTF-8?Q?DISPLAY-local?= <ASCII-local@example.com>'
  contents:
  - 'From: =?UTF-8?Q?DISPLAY-local?= <ASCII-local@example.com>

    '
- title: 'Downgraded-From: =?UTF-8?Q?DISPLAY-local_<NON-ASCII-local@example.com_?='
  contents:
  - "Downgraded-From: =?UTF-8?Q?DISPLAY-local_<NON-ASCII-local@example.com_?=\n =?UTF-8?Q?<ASCII-local@example.com>>?=\n"
- title: 'To: =?UTF-8?Q?DISPLAY-remote1?= <ASCII-remote1@example.net>'
  contents:
  - 'To: =?UTF-8?Q?DISPLAY-remote1?= <ASCII-remote1@example.net>

    '
- title: 'Downgraded-To: =?UTF-8?Q?DISPLAY-remote1_?='
  contents:
  - "Downgraded-To: =?UTF-8?Q?DISPLAY-remote1_?=\n =?UTF-8?Q?<NON-ASCII-remote1@example.net_<ASCII-remote1@example.net>>?=\n"
- title: 'Cc: =?UTF-8?Q?DISPLAY-remote2?= Internationalized address'
  contents:
  - "Cc: =?UTF-8?Q?DISPLAY-remote2?= Internationalized address\n =?UTF-8?Q?NON-ASCII-remote2@example.org?=\
    \ removed:;\n"
- title: 'Downgraded-Cc: =?UTF-8?Q?DISPLAY-remote2_?='
  contents:
  - "Downgraded-Cc: =?UTF-8?Q?DISPLAY-remote2_?=\n =?UTF-8?Q?<NON-ASCII-remote2@example.org>?=\n"
- title: 'Date: DATE'
  contents:
  - 'Date: DATE

    '
- title: MAIL_BODY
  contents:
  - "MAIL_BODY\n                 Figure 3: Downgraded message (example 1)\n"
- title: A.2.  Downgrading Example 2
  contents:
  - "A.2.  Downgrading Example 2\n   In many cases, the sender wants to use a non-ASCII\
    \ address and the\n   recipient is a traditional mail user.  The SMTP server handing\
    \ mail\n   for the recipient and/or the recipient's MUA does not support\n   UTF8SMTP\
    \ extension.  Consider a mail message where:\n   o  The sender address is \"NON-ASCII-local@example.com\"\
    , which is a\n      non-ASCII address.  Its ASCII alternative is\n      \"ASCII-local@example.com\"\
    .  It has a display-name \"DISPLAY-local\",\n      which contains non-ASCII characters.\n\
    \   o  The \"To:\" address is \"ASCII-remote1@example.net\", which is ASCII-\n\
    \      only.  It has a display-name, \"DISPLAY-remote1\", which contains\n   \
    \   non-ASCII characters.\n   o  The \"Subject:\" header field is \"NON-ASCII-SUBJECT\"\
    , which contains\n      non-ASCII characters.\n   The second example envelope/message\
    \ is shown in Figure 4.\n   MAIL From: <NON-ASCII-local@example.com>\n       \
    \        ALT-ADDRESS=ASCII-local@example.com\n   RCPT TO: <ASCII-remote1@example.net>\n\
    \   -------------------------------------------------------------\n   Message-Id:\
    \ MESSAGE_ID\n   Mime-Version: 1.0\n   Content-Type: text/plain; charset=\"UTF-8\"\
    \n   Content-Transfer-Encoding: 8bit\n   Subject: NON-ASCII-SUBJECT\n   From:\
    \ DISPLAY-local <NON-ASCII-local@example.com\n    <ASCII-local@example.com>>\n\
    \   To: DISPLAY-remote1 <ASCII-remote1@example.net>\n   Date: DATE\n   MAIL_BODY\n\
    \                  Figure 4: Original message (example 2)\n   In this example,\
    \ SMTP session is downgradable.  Figure 5 shows an\n   SMTP downgraded envelope/message.\n\
    \   MAIL From: <ASCII-local@example.com>\n   RCPT TO: <ASCII-remote1@example.net>\n\
    \   -------------------------------------------------------------\n   Downgraded-Mail-From:\
    \ =?UTF-8?Q?<NON-ASCII-local@example.com_?=\n    ?=UTF8?Q?<ASCII-local@example.com>>?=\n\
    \   Message-Id: MESSAGE_ID\n   Mime-Version: 1.0\n   Content-Type: text/plain;\
    \ charset=\"UTF-8\"\n   Content-Transfer-Encoding: 8bit\n   Subject: NON-ASCII-SUBJECT\n\
    \   From: DISPLAY-local <NON-ASCII-local@example.com\n    <ASCII-local@example.com>>\n\
    \   To: DISPLAY-remote1 <ASCII-remote1@example.net>\n   Date: DATE\n   MAIL_BODY\n\
    \          Figure 5: SMTP downgraded envelope/message (example 2)\n   After SMTP\
    \ downgrading, header field downgrading is performed.  The\n   downgraded example\
    \ is shown in Figure 6.\n"
- title: 'Return-Path: <ASCII-local@example.com>'
  contents:
  - 'Return-Path: <ASCII-local@example.com>

    '
- title: 'Downgraded-Mail-From: =?UTF-8?Q?<NON-ASCII-local@example.com_?='
  contents:
  - "Downgraded-Mail-From: =?UTF-8?Q?<NON-ASCII-local@example.com_?=\n =?UTF8?Q?<ASCII-local@example.com>>?=\n"
- title: 'Message-Id: MESSAGE_ID'
  contents:
  - 'Message-Id: MESSAGE_ID

    '
- title: 'Mime-Version: 1.0'
  contents:
  - 'Mime-Version: 1.0

    '
- title: 'Content-Type: text/plain; charset="UTF-8"'
  contents:
  - 'Content-Type: text/plain; charset="UTF-8"

    '
- title: 'Content-Transfer-Encoding: 8bit'
  contents:
  - 'Content-Transfer-Encoding: 8bit

    '
- title: 'Subject: =?UTF-8?Q?NON-ASCII-SUBJECT?='
  contents:
  - 'Subject: =?UTF-8?Q?NON-ASCII-SUBJECT?=

    '
- title: 'Downgraded-From: =?UTF-8?Q?DISPLAY-local_<NON-ASCII-local@example.com_?='
  contents:
  - "Downgraded-From: =?UTF-8?Q?DISPLAY-local_<NON-ASCII-local@example.com_?=\n =?UTF-8?Q?<ASCII-local@example.com>>?=\n"
- title: 'From: =?UTF-8?Q?DISPLAY-local?= <ASCII-local@example.com>'
  contents:
  - 'From: =?UTF-8?Q?DISPLAY-local?= <ASCII-local@example.com>

    '
- title: 'To: =?UTF-8?Q?DISPLAY-remote1?= <ASCII-remote1@example.net>'
  contents:
  - 'To: =?UTF-8?Q?DISPLAY-remote1?= <ASCII-remote1@example.net>

    '
- title: 'Date: DATE'
  contents:
  - 'Date: DATE

    '
- title: MAIL_BODY
  contents:
  - "MAIL_BODY\n                 Figure 6: Downgraded message (example 2)\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Kazunori Fujiwara (editor)\n   Japan Registry Services\
    \ Co., Ltd.\n   Chiyoda First Bldg. East 13F, 3-8-1 Nishi-Kanda\n   Chiyoda-ku,\
    \ Tokyo  101-0065\n   Japan\n   Phone: +81 3 5215 8451\n   EMail: fujiwara@jprs.co.jp\n\
    \   Yoshiro Yoneya (editor)\n   Japan Registry Services Co., Ltd.\n   Chiyoda\
    \ First Bldg. East 13F, 3-8-1 Nishi-Kanda\n   Chiyoda-ku, Tokyo  101-0065\n  \
    \ Japan\n   Phone: +81 3 5215 8451\n   EMail: yone@jprs.co.jp\n"
