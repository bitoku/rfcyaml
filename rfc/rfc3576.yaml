- title: __initial_text__
  contents:
  - "              Dynamic Authorization Extensions to Remote\n              Authentication\
    \ Dial In User Service (RADIUS)\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2003).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes a currently deployed extension to the Remote\n\
    \   Authentication Dial In User Service (RADIUS) protocol, allowing\n   dynamic\
    \ changes to a user session, as implemented by network access\n   server products.\
    \  This includes support for disconnecting users and\n   changing authorizations\
    \ applicable to a user session.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n       1.1.  Applicability. . . . . . . . . . . . . . . . .\
    \ . . . . .  3\n       1.2.  Requirements Language  . . . . . . . . . . . . .\
    \ . . . .  5\n       1.3.  Terminology. . . . . . . . . . . . . . . . . . . .\
    \ . . .  5\n   2.  Overview . . . . . . . . . . . . . . . . . . . . . . . . .\
    \ . .  5\n       2.1.  Disconnect Messages (DM) . . . . . . . . . . . . . . .\
    \ .  5\n       2.2.  Change-of-Authorization Messages (CoA) . . . . . . . . .\
    \  6\n       2.3.  Packet Format. . . . . . . . . . . . . . . . . . . . . .  7\n\
    \   3.  Attributes . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n  \
    \     3.1.  Error-Cause. . . . . . . . . . . . . . . . . . . . . . . 13\n    \
    \   3.2.  Table of Attributes. . . . . . . . . . . . . . . . . . . 16\n   4. \
    \ IANA Considerations. . . . . . . . . . . . . . . . . . . . . . 20\n   5.  Security\
    \ Considerations. . . . . . . . . . . . . . . . . . . . 21\n       5.1.  Authorization\
    \ Issues . . . . . . . . . . . . . . . . . . 21\n       5.2.  Impersonation. .\
    \ . . . . . . . . . . . . . . . . . . . . 22\n       5.3.  IPsec Usage Guidelines\
    \ . . . . . . . . . . . . . . . . . 22\n       5.4.  Replay Protection. . . .\
    \ . . . . . . . . . . . . . . . . 25\n   6.  Example Traces . . . . . . . . .\
    \ . . . . . . . . . . . . . . . 26\n   7.  References . . . . . . . . . . . .\
    \ . . . . . . . . . . . . . . 26\n       7.1.  Normative References . . . . .\
    \ . . . . . . . . . . . . . 26\n       7.2.  Informative References . . . . .\
    \ . . . . . . . . . . . . 27\n   8.  Intellectual Property Statement. . . . .\
    \ . . . . . . . . . . . 28\n   9.  Acknowledgements.  . . . . . . . . . . . .\
    \ . . . . . . . . . . 28\n   10. Authors' Addresses . . . . . . . . . . . . .\
    \ . . . . . . . . . 29\n   11. Full Copyright Statement . . . . . . . . . . .\
    \ . . . . . . . . 30\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The RADIUS protocol, defined in [RFC2865], does not support\n\
    \   unsolicited messages sent from the RADIUS server to the Network\n   Access\
    \ Server (NAS).\n   However, there are many instances in which it is desirable\
    \ for\n   changes to be made to session characteristics, without requiring the\n\
    \   NAS to initiate the exchange.  For example, it may be desirable for\n   administrators\
    \ to be able to terminate a user session in progress.\n   Alternatively, if the\
    \ user changes authorization level, this may\n   require that authorization attributes\
    \ be added/deleted from a user\n   session.\n   To overcome these limitations,\
    \ several vendors have implemented\n   additional RADIUS commands in order to\
    \ be able to support unsolicited\n   messages sent from the RADIUS server to the\
    \ NAS.  These extended\n   commands provide support for Disconnect and Change-of-Authorization\n\
    \   (CoA) messages.  Disconnect messages cause a user session to be\n   terminated\
    \ immediately, whereas CoA messages modify session\n   authorization attributes\
    \ such as data filters.\n"
- title: 1.1.  Applicability
  contents:
  - "1.1.  Applicability\n   This protocol is being recommended for publication as\
    \ an\n   Informational RFC rather than as a standards-track RFC because of\n \
    \  problems that cannot be fixed without creating incompatibilities with\n   deployed\
    \ implementations.  This includes security vulnerabilities, as\n   well as semantic\
    \ ambiguities resulting from the design of the\n   Change-of-Authorization (CoA)\
    \ commands.  While fixes are recommended,\n   they cannot be made mandatory since\
    \ this would be incompatible with\n   existing implementations.\n   Existing implementations\
    \ of this protocol do not support\n   authorization checks, so that an ISP sharing\
    \ a NAS with another ISP\n   could disconnect or change authorizations for another\
    \ ISP's users.\n   In order to remedy this problem, a \"Reverse Path Forwarding\"\
    \ check is\n   recommended.  See Section 5.1. for details.\n   Existing implementations\
    \ utilize per-packet authentication and\n   integrity protection algorithms with\
    \ known weaknesses [MD5Attack].\n   To provide stronger per-packet authentication\
    \ and integrity\n   protection, the use of IPsec is recommended.  See Section\
    \ 5.3. for\n   details.\n   Existing implementations lack replay protection. \
    \ In order to support\n   replay detection, it is recommended that the Event-Timestamp\n\
    \   Attribute be added to all messages in situations where IPsec replay\n   protection\
    \ is not employed.  Implementations should be configurable\n   to silently discard\
    \ messages lacking the Event-Timestamp Attribute.\n   See Section 5.4. for details.\n\
    \   The approach taken with CoA commands in existing implementations\n   results\
    \ in a semantic ambiguity.  Existing implementations of the\n   CoA-Request identify\
    \ the affected session, as well as supply the\n   authorization changes.  Since\
    \ RADIUS Attributes included within\n   existing implementations of the CoA-Request\
    \ can be used for session\n   identification or authorization change, it may not\
    \ be clear which\n   function a given attribute is serving.\n   The problem does\
    \ not exist within [Diameter], in which authorization\n   change is requested\
    \ by a command using Attribute Value Pairs (AVPs)\n   solely for identification,\
    \ resulting in initiation of a standard\n   Request/Response sequence where authorization\
    \ changes are supplied.\n   As a result, in no command can Diameter AVPs have\
    \ multiple potential\n   meanings.\n   Due to differences in handling change-of-authorization\
    \ requests in\n   RADIUS and Diameter, it may be difficult or impossible for a\n\
    \   Diameter/RADIUS gateway to successfully translate existing\n   implementations\
    \ of this specification to equivalent messages in\n   Diameter.  For example,\
    \ a Diameter command changing any attribute\n   used for identification within\
    \ existing CoA-Request implementations\n   cannot be translated, since such an\
    \ authorization change is\n   impossible to carry out in existing implementations.\
    \  Similarly,\n   translation between existing implementations of Disconnect-Request\
    \ or\n   CoA-Request messages and Diameter is tricky because a Disconnect-\n \
    \  Request or CoA-Request message will need to be translated to multiple\n   Diameter\
    \ commands.\n   To simplify translation between RADIUS and Diameter, a Service-Type\n\
    \   Attribute with value \"Authorize Only\" can (optionally) be included\n   within\
    \ a Disconnect-Request or CoA-Request.  Such a Request contains\n   only identification\
    \ attributes.  A NAS supporting the \"Authorize\n   Only\" Service-Type within\
    \ a Disconnect-Request or CoA-Request\n   responds with a NAK containing a Service-Type\
    \ Attribute with value\n   \"Authorize Only\" and an Error-Cause Attribute with\
    \ value \"Request\n   Initiated\".  The NAS will then send an Access-Request containing\
    \ a\n   Service-Type Attribute with a value of \"Authorize Only\".  This usage\n\
    \   sequence is akin to what occurs in Diameter and so is more easily\n   translated\
    \ by a Diameter/RADIUS gateway.\n"
- title: 1.2.  Requirements Language
  contents:
  - "1.2.  Requirements Language\n   In this document, several words are used to signify\
    \ the requirements\n   of the specification.  These words are often capitalized.\
    \  The key\n   words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL\
    \ NOT\", \"SHOULD\",\n   \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\"\
    \ in this document\n   are to be interpreted as described in [RFC2119].\n"
- title: 1.3.  Terminology
  contents:
  - "1.3.  Terminology\n   This document frequently uses the following terms:\n  \
    \ Network Access Server (NAS): The device providing access to the\n          \
    \                      network.\n   service:                     The NAS provides\
    \ a service to the user,\n                                such as IEEE 802 or\
    \ PPP.\n   session:                     Each service provided by the NAS to a\n\
    \                                user constitutes a session, with the\n      \
    \                          beginning of the session defined as the\n         \
    \                       point where service is first provided\n              \
    \                  and the end of the session defined as\n                   \
    \             the point where service is ended.  A\n                         \
    \       user may have multiple sessions in\n                                parallel\
    \ or series if the NAS supports\n                                that.\n   silently\
    \ discard:            This means the implementation discards\n               \
    \                 the packet without further processing.\n                   \
    \             The implementation SHOULD provide the\n                        \
    \        capability of logging the error,\n                                including\
    \ the contents of the silently\n                                discarded packet,\
    \ and SHOULD record the\n                                event in a statistics\
    \ counter.\n"
- title: 2.  Overview
  contents:
  - "2.  Overview\n   This section describes the most commonly implemented features\
    \ of\n   Disconnect and Change-of-Authorization messages.\n"
- title: 2.1.  Disconnect Messages (DM)
  contents:
  - "2.1.  Disconnect Messages (DM)\n   A Disconnect-Request packet is sent by the\
    \ RADIUS server in order to\n   terminate a user session on a NAS and discard\
    \ all associated session\n   context.  The Disconnect-Request packet is sent to\
    \ UDP port 3799, and\n   identifies the NAS as well as the user session to be\
    \ terminated by\n   inclusion of the identification attributes described in Section\
    \ 3.\n   +----------+   Disconnect-Request     +----------+\n   |          | \
    \  <--------------------  |          |\n   |    NAS   |                      \
    \    |  RADIUS  |\n   |          |   Disconnect-Response    |  Server  |\n   |\
    \          |   ---------------------> |          |\n   +----------+          \
    \                +----------+\n   The NAS responds to a Disconnect-Request packet\
    \ sent by a RADIUS\n   server with a Disconnect-ACK if all associated session\
    \ context is\n   discarded and the user session is no longer connected, or a\n\
    \   Disconnect-NAK, if the NAS was unable to disconnect the session and\n   discard\
    \ all associated session context.  A NAS MUST respond to a\n   Disconnect-Request\
    \ including a Service-Type Attribute with value\n   \"Authorize Only\" with a\
    \ Disconnect-NAK; a Disconnect-ACK MUST NOT be\n   sent.  A NAS MUST respond to\
    \ a Disconnect-Request including a\n   Service-Type Attribute with an unsupported\
    \ value with a Disconnect-\n   NAK; an Error-Cause Attribute with value \"Unsupported\
    \ Service\" MAY be\n   included.  A Disconnect-ACK MAY contain the Attribute\n\
    \   Acct-Terminate-Cause (49) [RFC2866] with the value set to 6 for\n   Admin-Reset.\n"
- title: 2.2.  Change-of-Authorization Messages (CoA)
  contents:
  - "2.2.  Change-of-Authorization Messages (CoA)\n   CoA-Request packets contain\
    \ information for dynamically changing\n   session authorizations.  This is typically\
    \ used to change data\n   filters.  The data filters can be of either the ingress\
    \ or egress\n   kind, and are sent in addition to the identification attributes\
    \ as\n   described in section 3.  The port used, and packet format (described\n\
    \   in Section 2.3.), are the same as that for Disconnect-Request\n   Messages.\n\
    \   The following attribute MAY be sent in a CoA-Request:\n   Filter-ID (11) -\
    \ Indicates the name of a data filter list to be\n                    applied\
    \ for the session that the identification\n                    attributes map\
    \ to.\n   +----------+      CoA-Request         +----------+\n   |          |\
    \  <--------------------   |          |\n   |   NAS    |                     \
    \     |  RADIUS  |\n   |          |     CoA-Response         |  Server  |\n  \
    \ |          |   ---------------------> |          |\n   +----------+        \
    \                  +----------+\n   The NAS responds to a CoA-Request sent by\
    \ a RADIUS server with a\n   CoA-ACK if the NAS is able to successfully change\
    \ the authorizations\n   for the user session, or a CoA-NAK if the Request is\
    \ unsuccessful.  A\n   NAS MUST respond to a CoA-Request including a Service-Type\
    \ Attribute\n   with value \"Authorize Only\" with a CoA-NAK; a CoA-ACK MUST NOT\
    \ be\n   sent.  A NAS MUST respond to a CoA-Request including a Service-Type\n\
    \   Attribute with an unsupported value with a CoA-NAK; an Error-Cause\n   Attribute\
    \ with value \"Unsupported Service\" MAY be included.\n"
- title: 2.3.  Packet Format
  contents:
  - "2.3.  Packet Format\n   For either Disconnect-Request or CoA-Request messages\
    \ UDP port 3799\n   is used as the destination port.  For responses, the source\
    \ and\n   destination ports are reversed.  Exactly one RADIUS packet is\n   encapsulated\
    \ in the UDP Data field.\n   A summary of the data format is shown below.  The\
    \ fields are\n   transmitted from left to right.\n   The packet format consists\
    \ of the fields: Code, Identifier, Length,\n   Authenticator, and Attributes in\
    \ Type:Length:Value (TLV) format.  All\n   fields hold the same meaning as those\
    \ described in RADIUS [RFC2865].\n   The Authenticator field MUST be calculated\
    \ in the same way as is\n   specified for an Accounting-Request in [RFC2866].\n\
    \    0                   1                   2                   3\n    0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Code      |  Identifier   |            Length             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   |  \
    \                       Authenticator                         |\n   |        \
    \                                                       |\n   |              \
    \                                                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Attributes ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-\n   Code\n      The Code\
    \ field is one octet, and identifies the type of RADIUS\n      packet.  Packets\
    \ received with an invalid Code field MUST be\n      silently discarded.  RADIUS\
    \ codes (decimal) for this extension are\n      assigned as follows:\n      40\
    \ - Disconnect-Request [RFC2882]\n      41 - Disconnect-ACK [RFC2882]\n      42\
    \ - Disconnect-NAK [RFC2882]\n      43 - CoA-Request [RFC2882]\n      44 - CoA-ACK\
    \ [RFC2882]\n      45 - CoA-NAK [RFC2882]\n   Identifier\n      The Identifier\
    \ field is one octet, and aids in matching requests\n      and replies.  The RADIUS\
    \ client can detect a duplicate request if\n      it has the same server source\
    \ IP address and source UDP port and\n      Identifier within a short span of\
    \ time.\n      Unlike RADIUS as defined in [RFC2865], the responsibility for\n\
    \      retransmission of Disconnect-Request and CoA-Request messages lies\n  \
    \    with the RADIUS server.  If after sending these messages, the\n      RADIUS\
    \ server does not receive a response, it will retransmit.\n      The Identifier\
    \ field MUST be changed whenever the content of the\n      Attributes field changes,\
    \ or whenever a valid reply has been\n      received for a previous request. \
    \ For retransmissions where the\n      contents are identical, the Identifier\
    \ MUST remain unchanged.\n      If the RADIUS server is retransmitting a Disconnect-Request\
    \ or\n      CoA-Request to the same client as before, and the Attributes have\n\
    \      not changed, the same Request Authenticator, Identifier and source\n  \
    \    port MUST be used.  If any Attributes have changed, a new\n      Authenticator\
    \ and Identifier MUST be used.\n      Note that if the Event-Timestamp Attribute\
    \ is included, it will be\n      updated when the packet is retransmitted, changing\
    \ the content of\n      the Attributes field and requiring a new Identifier and\
    \ Request\n      Authenticator.\n      If the Request to a primary proxy fails,\
    \ a secondary proxy must be\n      queried, if available.  Issues relating to\
    \ failover algorithms are\n      described in [AAATransport].  Since this represents\
    \ a new request,\n      a new Request Authenticator and Identifier MUST be used.\
    \  However,\n      where the RADIUS server is sending directly to the client,\n\
    \      failover typically does not make sense, since Disconnect or CoA\n     \
    \ messages need to be delivered to the NAS where the session\n      resides.\n\
    \   Length\n      The Length field is two octets.  It indicates the length of\
    \ the\n      packet including the Code, Identifier, Length, Authenticator and\n\
    \      Attribute fields.  Octets outside the range of the Length field\n     \
    \ MUST be treated as padding and ignored on reception.  If the\n      packet is\
    \ shorter than the Length field indicates, it MUST be\n      silently discarded.\
    \  The minimum length is 20 and the maximum\n      length is 4096.\n   Authenticator\n\
    \      The Authenticator field is sixteen (16) octets.  The most\n      significant\
    \ octet is transmitted first.  This value is used to\n      authenticate the messages\
    \ between the RADIUS server and client.\n   Request Authenticator\n      In Request\
    \ packets, the Authenticator value is a 16 octet MD5\n      [RFC1321] checksum,\
    \ called the Request Authenticator.  The Request\n      Authenticator is calculated\
    \ the same way as for an Accounting-\n      Request, specified in [RFC2866].\n\
    \      Note that the Request Authenticator of a Disconnect or CoA-Request\n  \
    \    cannot be done the same way as the Request Authenticator of a\n      RADIUS\
    \ Access-Request, because there is no User-Password Attribute\n      in a Disconnect-Request\
    \ or CoA-Request.\n   Response Authenticator\n      The Authenticator field in\
    \ a Response packet (e.g. Disconnect-ACK,\n      Disconnect-NAK, CoA-ACK, or CoA-NAK)\
    \ is called the Response\n      Authenticator, and contains a one-way MD5 hash\
    \ calculated over a\n      stream of octets consisting of the Code, Identifier,\
    \ Length, the\n      Request Authenticator field from the packet being replied\
    \ to, and\n      the response Attributes if any, followed by the shared secret.\n\
    \      The resulting 16 octet MD5 hash value is stored in the\n      Authenticator\
    \ field of the Response packet.\n   Administrative note: As noted in [RFC2865]\
    \ Section 3, the secret\n   (password shared between the client and the RADIUS\
    \ server) SHOULD be\n   at least as large and unguessable as a well-chosen password.\
    \  RADIUS\n   clients MUST use the source IP address of the RADIUS UDP packet\
    \ to\n   decide which shared secret to use, so that requests can be proxied.\n\
    \   Attributes\n      In Disconnect and CoA-Request messages, all Attributes are\
    \ treated\n      as mandatory.  A NAS MUST respond to a CoA-Request containing\
    \ one\n      or more unsupported Attributes or Attribute values with a CoA-NAK;\n\
    \      a Disconnect-Request containing one or more unsupported Attributes\n  \
    \    or Attribute values MUST be answered with a Disconnect-NAK.  State\n    \
    \  changes resulting from a CoA-Request MUST be atomic: if the\n      Request\
    \ is successful, a CoA-ACK is sent, and all requested\n      authorization changes\
    \ MUST be made.  If the CoA-Request is\n      unsuccessful, a CoA-NAK MUST be\
    \ sent, and the requested\n      authorization changes MUST NOT be made.  Similarly,\
    \ a state change\n      MUST NOT occur as a result of an unsuccessful Disconnect-Request;\n\
    \      here a Disconnect-NAK MUST be sent.\n      Since within this specification\
    \ attributes may be used for\n      identification, authorization or other purposes,\
    \ even if a NAS\n      implements an attribute for use with RADIUS authentication\
    \ and\n      accounting, it may not support inclusion of that attribute within\n\
    \      Disconnect-Request or CoA-Request messages, given the difference\n    \
    \  in attribute semantics.  This is true even for attributes\n      specified\
    \ within [RFC2865], [RFC2868], [RFC2869] or [RFC3162] as\n      allowable within\
    \ Access-Accept messages.\n      As a result, attributes beyond those specified\
    \ in Section 3.2.\n      SHOULD NOT be included within Disconnect or CoA messages\
    \ since\n      this could produce unpredictable results.\n      When using a forwarding\
    \ proxy, the proxy must be able to alter the\n      packet as it passes through\
    \ in each direction.  When the proxy\n      forwards a Disconnect or CoA-Request,\
    \ it MAY add a Proxy-State\n      Attribute, and when the proxy forwards a response,\
    \ it MUST remove\n      its Proxy-State Attribute if it added one.  Proxy-State\
    \ is always\n      added or removed after any other Proxy-States, but no other\n\
    \      assumptions regarding its location within the list of Attributes\n    \
    \  can be made.  Since Disconnect and CoA responses are authenticated\n      on\
    \ the entire packet contents, the stripping of the Proxy-State\n      Attribute\
    \ invalidates the integrity check - so the proxy needs to\n      recompute it.\
    \  A forwarding proxy MUST NOT modify existing Proxy-\n      State, State, or\
    \ Class Attributes present in the packet.\n      If there are any Proxy-State\
    \ Attributes in a Disconnect-Request or\n      CoA-Request received from the server,\
    \ the forwarding proxy MUST\n      include those Proxy-State Attributes in its\
    \ response to the\n      server.  The forwarding proxy MAY include the Proxy-State\n\
    \      Attributes in the Disconnect-Request or CoA-Request when it\n      forwards\
    \ the request, or it MAY omit them in the forwarded\n      request.  If the forwarding\
    \ proxy omits the Proxy-State Attributes\n      in the request, it MUST attach\
    \ them to the response before sending\n      it to the server.\n"
- title: 3.  Attributes
  contents:
  - "3.  Attributes\n   In Disconnect-Request and CoA-Request packets, certain attributes\
    \ are\n   used to uniquely identify the NAS as well as a user session on the\n\
    \   NAS.  All NAS identification attributes included in a Request message\n  \
    \ MUST match in order for a Disconnect-Request or CoA-Request to be\n   successful;\
    \ otherwise a Disconnect-NAK or CoA-NAK SHOULD be sent.\n   For session identification\
    \ attributes, the User-Name and Acct-\n   Session-Id Attributes, if included,\
    \ MUST match in order for a\n   Disconnect-Request or CoA-Request to be successful;\
    \ other session\n   identification attributes SHOULD match.  Where a mismatch\
    \ of session\n   identification attributes is detected, a Disconnect-NAK or CoA-NAK\n\
    \   SHOULD  be sent.  The ability to use NAS or session identification\n   attributes\
    \ to map to unique/multiple sessions is beyond the scope of\n   this document.\
    \  Identification attributes include NAS and session\n   identification attributes,\
    \ as described below.\n   NAS identification attributes\n   Attribute        \
    \     #    Reference  Description\n   ---------            ---   ---------  -----------\n\
    \   NAS-IP-Address        4    [RFC2865]  The IPv4 address of the NAS.\n   NAS-Identifier\
    \       32    [RFC2865]  String identifying the NAS.\n   NAS-IPv6-Address    \
    \ 95    [RFC3162]  The IPv6 address of the NAS.\n   Session identification attributes\n\
    \   Attribute              #    Reference  Description\n   ---------         \
    \    ---   ---------  -----------\n   User-Name              1    [RFC2865]  The\
    \ name of the user\n                                          associated with\
    \ the session.\n   NAS-Port               5    [RFC2865]  The port on which the\n\
    \                                          session is terminated.\n   Framed-IP-Address\
    \      8    [RFC2865]  The IPv4 address associated\n                         \
    \                 with the session.\n   Called-Station-Id     30    [RFC2865]\
    \  The link address to which\n                                          the session\
    \ is connected.\n   Calling-Station-Id    31    [RFC2865]  The link address from\
    \ which\n                                          the session is connected.\n\
    \   Acct-Session-Id       44    [RFC2866]  The identifier uniquely\n         \
    \                                 identifying the session\n                  \
    \                        on the NAS.\n   Acct-Multi-Session-Id 50    [RFC2866]\
    \  The identifier uniquely\n                                          identifying\
    \ related sessions.\n   NAS-Port-Type         61    [RFC2865]  The type of port\
    \ used.\n   NAS-Port-Id           87    [RFC2869]  String identifying the port\n\
    \                                          where the session is.\n   Originating-Line-Info\
    \ 94    [NASREQ]   Provides information on the\n                             \
    \             characteristics of the line\n                                  \
    \        from which a session\n                                          originated.\n\
    \   Framed-Interface-Id   96    [RFC3162]  The IPv6 Interface Identifier\n   \
    \                                       associated with the session;\n       \
    \                                   always sent with\n                       \
    \                   Framed-IPv6-Prefix.\n   Framed-IPv6-Prefix    97    [RFC3162]\
    \  The IPv6 prefix associated\n                                          with\
    \ the session, always sent\n                                          with Framed-Interface-Id.\n\
    \   To address security concerns described in Section 5.1., the User-Name\n  \
    \ Attribute SHOULD be present in Disconnect-Request or CoA-Request\n   packets;\
    \ one or more additional session identification attributes MAY\n   also be present.\
    \  To address security concerns described in Section\n   5.2., one or more of\
    \ the NAS-IP-Address or NAS-IPv6-Address\n   Attributes SHOULD be present in Disconnect-Request\
    \ or CoA-Request\n   packets; the NAS-Identifier Attribute MAY be present in addition.\n\
    \   If one or more authorization changes specified in a CoA-Request\n   cannot\
    \ be carried out, or if one or more attributes or attribute-\n   values is unsupported,\
    \ a CoA-NAK MUST be sent.  Similarly, if there\n   are one or more unsupported\
    \ attributes or attribute values in a\n   Disconnect-Request, a Disconnect-NAK\
    \ MUST be sent.\n   Where a Service-Type Attribute with value \"Authorize Only\"\
    \ is\n   included within a CoA-Request or Disconnect-Request, attributes\n   representing\
    \ an authorization change MUST NOT be included; only\n   identification attributes\
    \ are permitted.  If attributes other than\n   NAS or session identification attributes\
    \ are included in such a CoA-\n   Request, implementations MUST send a CoA-NAK;\
    \ an Error-Cause\n   Attribute with value \"Unsupported Attribute\" MAY be included.\n\
    \   Similarly, if attributes other than NAS or session identification\n   attributes\
    \ are included in such a Disconnect-Request, implementations\n   MUST send a Disconnect-NAK;\
    \ an Error-Cause Attribute with value\n   \"Unsupported Attribute\" MAY be included.\n"
- title: 3.1.  Error-Cause
  contents:
  - "3.1.  Error-Cause\n   Description\n      It is possible that the NAS cannot honor\
    \ Disconnect-Request or\n      CoA-Request messages for some reason.  The Error-Cause\
    \ Attribute\n      provides more detail on the cause of the problem.  It MAY be\n\
    \      included within Disconnect-ACK, Disconnect-NAK and CoA-NAK\n      messages.\n\
    \      A summary of the Error-Cause Attribute format is shown below.  The\n  \
    \    fields are transmitted from left to right.\n    0                   1   \
    \                2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6\
    \ 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |    Length     |             Value\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \              Value (cont)         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Type\n      101 for Error-Cause\n   Length\n      6\n   Value\n      The Value\
    \ field is four octets, containing an integer specifying\n      the cause of the\
    \ error.  Values 0-199 and 300-399 are reserved.\n      Values 200-299 represent\
    \ successful completion, so that these\n      values may only be sent within Disconnect-ACK\
    \ or CoA-ACK message\n      and MUST NOT be sent within a Disconnect-NAK or CoA-NAK.\
    \  Values\n      400-499 represent fatal errors committed by the RADIUS server,\
    \ so\n      that they MAY be sent within CoA-NAK or Disconnect-NAK messages,\n\
    \      and MUST NOT be sent within CoA-ACK or Disconnect-ACK messages.\n     \
    \ Values 500-599 represent fatal errors occurring on a NAS or RADIUS\n      proxy,\
    \ so that they MAY be sent within CoA-NAK and Disconnect-NAK\n      messages,\
    \ and MUST NOT be sent within CoA-ACK or Disconnect-ACK\n      messages.  Error-Cause\
    \ values SHOULD be logged by the RADIUS\n      server.  Error-Code values (expressed\
    \ in decimal) include:\n    #     Value\n   ---    -----\n   201    Residual Session\
    \ Context Removed\n   202    Invalid EAP Packet (Ignored)\n   401    Unsupported\
    \ Attribute\n   402    Missing Attribute\n   403    NAS Identification Mismatch\n\
    \   404    Invalid Request\n   405    Unsupported Service\n   406    Unsupported\
    \ Extension\n   501    Administratively Prohibited\n   502    Request Not Routable\
    \ (Proxy)\n   503    Session Context Not Found\n   504    Session Context Not\
    \ Removable\n   505    Other Proxy Processing Error\n   506    Resources Unavailable\n\
    \   507    Request Initiated\n   \"Residual Session Context Removed\" is sent\
    \ in response to a\n   Disconnect-Request if the user session is no longer active,\
    \ but\n   residual session context was found and successfully removed.  This\n\
    \   value is only sent within a Disconnect-ACK and MUST NOT be sent\n   within\
    \ a CoA-ACK, Disconnect-NAK or CoA-NAK.\n   \"Invalid EAP Packet (Ignored)\" is\
    \ a non-fatal error that MUST NOT be\n   sent by implementations of this specification.\n\
    \   \"Unsupported Attribute\" is a fatal error sent if a Request contains\n  \
    \ an attribute (such as a Vendor-Specific or EAP-Message Attribute)\n   that is\
    \ not supported.\n   \"Missing Attribute\" is a fatal error sent if critical attributes\n\
    \   (such as NAS or session identification attributes) are missing from a\n  \
    \ Request.\n   \"NAS Identification Mismatch\" is a fatal error sent if one or\
    \ more\n   NAS identification attributes (see Section 3.) do not match the\n \
    \  identity of the NAS receiving the Request.\n   \"Invalid Request\" is a fatal\
    \ error sent if some other aspect of the\n   Request is invalid, such as if one\
    \ or more attributes (such as EAP-\n   Message Attribute(s)) are not formatted\
    \ properly.\n   \"Unsupported Service\" is a fatal error sent if a Service-Type\n\
    \   Attribute included with the Request is sent with an invalid or\n   unsupported\
    \ value.\n   \"Unsupported Extension\" is a fatal error sent due to lack of support\n\
    \   for an extension such as Disconnect and/or CoA messages.  This will\n   typically\
    \ be sent by a proxy receiving an ICMP port unreachable\n   message after attempting\
    \ to forward a Request to the NAS.\n   \"Administratively Prohibited\" is a fatal\
    \ error sent if the NAS is\n   configured to prohibit honoring of Request messages\
    \ for the specified\n   session.\n   \"Request Not Routable\" is a fatal error\
    \ which MAY be sent by a RADIUS\n   proxy and MUST NOT be sent by a NAS.  It indicates\
    \ that the RADIUS\n   proxy was unable to determine how to route the Request to\
    \ the NAS.\n   For example, this can occur if the required entries are not present\n\
    \   in the proxy's realm routing table.\n   \"Session Context Not Found\" is a\
    \ fatal error sent if the session\n   context identified in the Request does not\
    \ exist on the NAS.\n   \"Session Context Not Removable\" is a fatal error sent\
    \ in response to\n   a Disconnect-Request if the NAS was able to locate the session\n\
    \   context, but could not remove it for some reason.  It MUST NOT be\n   sent\
    \ within a CoA-ACK, CoA-NAK or Disconnect-ACK, only within a\n   Disconnect-NAK.\n\
    \   \"Other Proxy Processing Error\" is a fatal error sent in response to a\n\
    \   Request that could not be processed by a proxy, for reasons other\n   than\
    \ routing.\n   \"Resources Unavailable\" is a fatal error sent when a Request\
    \ could\n   not be honored due to lack of available NAS resources (memory, non-\n\
    \   volatile storage, etc.).\n   \"Request Initiated\" is a fatal error sent in\
    \ response to a Request\n   including a Service-Type Attribute with a value of\
    \ \"Authorize Only\".\n   It indicates that the Disconnect-Request or CoA-Request\
    \ has not been\n   honored, but that a RADIUS Access-Request including a Service-Type\n\
    \   Attribute with value \"Authorize Only\" is being sent to the RADIUS\n   server.\n"
- title: 3.2.  Table of Attributes
  contents:
  - "3.2.  Table of Attributes\n   The following table provides a guide to which attributes\
    \ may be found\n   in which packets, and in what quantity.\n   Change-of-Authorization\
    \ Messages\n   Request   ACK      NAK   #   Attribute\n   0-1       0        0\
    \     1   User-Name [Note 1]\n   0-1       0        0     4   NAS-IP-Address [Note\
    \ 1]\n   0-1       0        0     5   NAS-Port [Note 1]\n   0-1       0      \
    \  0-1   6   Service-Type [Note 6]\n   0-1       0        0     7   Framed-Protocol\
    \ [Note 3]\n   0-1       0        0     8   Framed-IP-Address [Note 1]\n   0-1\
    \       0        0     9   Framed-IP-Netmask [Note 3]\n   0-1       0        0\
    \    10   Framed-Routing [Note 3]\n   0+        0        0    11   Filter-ID [Note\
    \ 3]\n   0-1       0        0    12   Framed-MTU [Note 3]\n   0+        0    \
    \    0    13   Framed-Compression [Note 3]\n   0+        0        0    14   Login-IP-Host\
    \ [Note 3]\n   0-1       0        0    15   Login-Service [Note 3]\n   0-1   \
    \    0        0    16   Login-TCP-Port [Note 3]\n   0+        0        0    18\
    \   Reply-Message [Note 2]\n   0-1       0        0    19   Callback-Number [Note\
    \ 3]\n   0-1       0        0    20   Callback-Id [Note 3]\n   0+        0   \
    \     0    22   Framed-Route [Note 3]\n   0-1       0        0    23   Framed-IPX-Network\
    \ [Note 3]\n   0-1       0-1      0-1  24   State [Note 7]\n   0+        0   \
    \     0    25   Class [Note 3]\n   0+        0        0    26   Vendor-Specific\
    \ [Note 3]\n   0-1       0        0    27   Session-Timeout [Note 3]\n   0-1 \
    \      0        0    28   Idle-Timeout [Note 3]\n   0-1       0        0    29\
    \   Termination-Action [Note 3]\n   0-1       0        0    30   Called-Station-Id\
    \ [Note 1]\n   0-1       0        0    31   Calling-Station-Id [Note 1]\n   0-1\
    \       0        0    32   NAS-Identifier [Note 1]\n   0+        0+       0+ \
    \  33   Proxy-State\n   0-1       0        0    34   Login-LAT-Service [Note 3]\n\
    \   0-1       0        0    35   Login-LAT-Node [Note 3]\n   0-1       0     \
    \   0    36   Login-LAT-Group [Note 3]\n   0-1       0        0    37   Framed-AppleTalk-Link\
    \ [Note 3]\n   0+        0        0    38   Framed-AppleTalk-Network [Note 3]\n\
    \   0-1       0        0    39   Framed-AppleTalk-Zone [Note 3]\n   0-1      \
    \ 0        0    44   Acct-Session-Id [Note 1]\n   0-1       0        0    50 \
    \  Acct-Multi-Session-Id [Note 1]\n   0-1       0-1      0-1  55   Event-Timestamp\n\
    \   0-1       0        0    61   NAS-Port-Type [Note 1]\n   Request   ACK    \
    \  NAK   #   Attribute\n   Request   ACK      NAK   #   Attribute\n   0-1    \
    \   0        0    62   Port-Limit [Note 3]\n   0-1       0        0    63   Login-LAT-Port\
    \ [Note 3]\n   0+        0        0    64   Tunnel-Type [Note 5]\n   0+      \
    \  0        0    65   Tunnel-Medium-Type [Note 5]\n   0+        0        0   \
    \ 66   Tunnel-Client-Endpoint [Note 5]\n   0+        0        0    67   Tunnel-Server-Endpoint\
    \ [Note 5]\n   0+        0        0    69   Tunnel-Password [Note 5]\n   0-1 \
    \      0        0    71   ARAP-Features [Note 3]\n   0-1       0        0    72\
    \   ARAP-Zone-Access [Note 3]\n   0+        0        0    78   Configuration-Token\
    \ [Note 3]\n   0+        0-1      0    79   EAP-Message [Note 2]\n   0-1     \
    \  0-1      0-1  80   Message-Authenticator\n   0+        0        0    81   Tunnel-Private-Group-ID\
    \ [Note 5]\n   0+        0        0    82   Tunnel-Assignment-ID [Note 5]\n  \
    \ 0+        0        0    83   Tunnel-Preference [Note 5]\n   0-1       0    \
    \    0    85   Acct-Interim-Interval [Note 3]\n   0-1       0        0    87 \
    \  NAS-Port-Id [Note 1]\n   0-1       0        0    88   Framed-Pool [Note 3]\n\
    \   0+        0        0    90   Tunnel-Client-Auth-ID [Note 5]\n   0+       \
    \ 0        0    91   Tunnel-Server-Auth-ID [Note 5]\n   0-1       0        0 \
    \   94   Originating-Line-Info [Note 1]\n   0-1       0        0    95   NAS-IPv6-Address\
    \ [Note 1]\n   0-1       0        0    96   Framed-Interface-Id [Note 1]\n   0+\
    \        0        0    97   Framed-IPv6-Prefix [Note 1]\n   0+        0      \
    \  0    98   Login-IPv6-Host [Note 3]\n   0+        0        0    99   Framed-IPv6-Route\
    \ [Note 3]\n   0-1       0        0   100   Framed-IPv6-Pool [Note 3]\n   0  \
    \       0        0+  101   Error-Cause\n   Request   ACK      NAK   #   Attribute\n\
    \   Disconnect Messages\n   Request   ACK      NAK   #   Attribute\n   0-1   \
    \    0        0     1   User-Name [Note 1]\n   0-1       0        0     4   NAS-IP-Address\
    \ [Note 1]\n   0-1       0        0     5   NAS-Port [Note 1]\n   0-1       0\
    \        0-1   6   Service-Type [Note 6]\n   0-1       0        0     8   Framed-IP-Address\
    \ [Note 1]\n   0+        0        0    18   Reply-Message [Note 2]\n   0-1   \
    \    0-1      0-1  24   State [Note 7]\n   0+        0        0    25   Class\
    \ [Note 4]\n   0+        0        0    26   Vendor-Specific\n   0-1       0  \
    \      0    30   Called-Station-Id [Note 1]\n   0-1       0        0    31   Calling-Station-Id\
    \ [Note 1]\n   0-1       0        0    32   NAS-Identifier [Note 1]\n   0+   \
    \     0+       0+   33   Proxy-State\n   Request   ACK      NAK   #   Attribute\n\
    \   Request   ACK      NAK   #   Attribute\n   0-1       0        0    44   Acct-Session-Id\
    \ [Note 1]\n   0-1       0-1      0    49   Acct-Terminate-Cause\n   0-1     \
    \  0        0    50   Acct-Multi-Session-Id [Note 1]\n   0-1       0-1      0-1\
    \  55   Event-Timestamp\n   0-1       0        0    61   NAS-Port-Type [Note 1]\n\
    \   0+        0-1      0    79   EAP-Message [Note 2]\n   0-1       0-1      0-1\
    \  80   Message-Authenticator\n   0-1       0        0    87   NAS-Port-Id [Note\
    \ 1]\n   0-1       0        0    94   Originating-Line-Info [Note 1]\n   0-1 \
    \      0        0    95   NAS-IPv6-Address [Note 1]\n   0-1       0        0 \
    \   96   Framed-Interface-Id [Note 1]\n   0+        0        0    97   Framed-IPv6-Prefix\
    \ [Note 1]\n   0         0+       0+  101   Error-Cause\n   Request   ACK    \
    \  NAK   #   Attribute\n   [Note 1] Where NAS or session identification attributes\
    \ are included\n   in Disconnect-Request or CoA-Request messages, they are used\
    \ for\n   identification purposes only.  These attributes MUST NOT be used for\n\
    \   purposes other than identification (e.g. within CoA-Request messages\n   to\
    \ request authorization changes).\n   [Note 2] The Reply-Message Attribute is\
    \ used to present a displayable\n   message to the user.  The message is only\
    \ displayed as a result of a\n   successful Disconnect-Request or CoA-Request\
    \ (where a Disconnect-ACK\n   or CoA-ACK is subsequently sent).  Where EAP is\
    \ used for\n   authentication, an EAP-Message/Notification-Request Attribute is\
    \ sent\n   instead, and Disconnect-ACK or CoA-ACK messages contain an EAP-\n \
    \  Message/Notification-Response Attribute.\n   [Note 3] When included within\
    \ a CoA-Request, these attributes\n   represent an authorization change request.\
    \  When one of these\n   attributes is omitted from a CoA-Request, the NAS assumes\
    \ that the\n   attribute value is to remain unchanged.  Attributes included in\
    \ a\n   CoA-Request replace all existing value(s) of the same attribute(s).\n\
    \   [Note 4] When included within a successful Disconnect-Request (where\n   a\
    \ Disconnect-ACK is subsequently sent), the Class Attribute SHOULD be\n   sent\
    \ unmodified by the client to the accounting server in the\n   Accounting Stop\
    \ packet.  If the Disconnect-Request is unsuccessful,\n   then the Class Attribute\
    \ is not processed.\n   [Note 5] When included within a CoA-Request, these attributes\n\
    \   represent an authorization change request.  Where tunnel attribute(s)\n  \
    \ are sent within a successful CoA-Request, all existing tunnel\n   attributes\
    \ are removed and replaced by the new attribute(s).\n   [Note 6] When included\
    \ within a Disconnect-Request or CoA-Request, a\n   Service-Type Attribute with\
    \ value \"Authorize Only\" indicates that the\n   Request only contains NAS and\
    \ session identification attributes, and\n   that the NAS should attempt reauthorization\
    \ by sending an Access-\n   Request with a Service-Type Attribute with value \"\
    Authorize Only\".\n   This enables a usage model akin to that supported in Diameter,\
    \ thus\n   easing translation between the two protocols.  Support for the\n  \
    \ Service-Type Attribute is optional within CoA-Request and\n   Disconnect-Request\
    \ messages; where it is not included, the Request\n   message may contain both\
    \ identification and authorization attributes.\n   A NAS that does not support\
    \ the Service-Type Attribute with the value\n   \"Authorize Only\" within a Disconnect-Request\
    \ MUST respond with a\n   Disconnect-NAK including no Service-Type Attribute;\
    \ an Error-Cause\n   Attribute with value \"Unsupported Service\" MAY be included.\
    \  A NAS\n   that does not support the Service-Type Attribute with the value\n\
    \   \"Authorize Only\" within a CoA-Request MUST respond with a CoA-NAK\n   including\
    \ no Service-Type Attribute; an Error-Cause Attribute with\n   value \"Unsupported\
    \ Service\" MAY be included.\n   A NAS supporting the \"Authorize Only\" Service-Type\
    \ value within\n   Disconnect-Request or CoA-Request messages MUST respond with\
    \ a\n   Disconnect-NAK or CoA-NAK respectively, containing a Service-Type\n  \
    \ Attribute with value \"Authorize Only\", and an Error-Cause Attribute\n   with\
    \ value \"Request Initiated\".  The NAS then sends an Access-Request\n   to the\
    \ RADIUS server with a Service-Type Attribute with value\n   \"Authorize Only\"\
    .  This Access-Request SHOULD contain the NAS\n   attributes from the Disconnect\
    \ or CoA-Request, as well as the session\n   attributes from the Request legal\
    \ for inclusion in an Access-Request\n   as specified in [RFC2865], [RFC2868],\
    \ [RFC2869] and [RFC3162].  As\n   noted in [RFC2869] Section 5.19, a Message-Authenticator\
    \ attribute\n   SHOULD be included in an Access-Request that does not contain\
    \ a\n   User-Password, CHAP-Password, ARAP-Password or EAP-Message Attribute.\n\
    \   The RADIUS server should send back an Access-Accept to (re-)authorize\n  \
    \ the session or an Access-Reject to refuse to (re-)authorize it.\n   [Note 7]\
    \ The State Attribute is available to be sent by the RADIUS\n   server to the\
    \ NAS in a Disconnect-Request or CoA-Request message and\n   MUST be sent unmodified\
    \ from the NAS to the RADIUS server in a\n   subsequent ACK or NAK message.  If\
    \ a Service-Type Attribute with\n   value \"Authorize Only\" is included in a\
    \ Disconnect-Request or CoA-\n   Request along with a State Attribute, then the\
    \ State Attribute MUST\n   be sent unmodified from the NAS to the RADIUS server\
    \ in the resulting\n   Access-Request sent to the RADIUS server, if any.  The\
    \ State\n   Attribute is also available to be sent by the RADIUS server to the\n\
    \   NAS in a CoA-Request that also includes a Termination-Action\n   Attribute\
    \ with the value of RADIUS-Request.  If the client performs\n   the Termination-Action\
    \ by sending a new Access-Request upon\n   termination of the current session,\
    \ it MUST include the State\n   Attribute unchanged in that Access-Request.  In\
    \ either usage, the\n   client MUST NOT interpret the Attribute locally.  A Disconnect-\n\
    \   Request or CoA-Request packet must have only zero or one State\n   Attribute.\
    \  Usage of the State Attribute is implementation dependent.\n   If the RADIUS\
    \ server does not recognize the State Attribute in the\n   Access-Request, then\
    \ it MUST send an Access-Reject.\n   The following table defines the meaning of\
    \ the above table entries.\n   0   This attribute MUST NOT be present in packet.\n\
    \   0+  Zero or more instances of this attribute MAY be present in\n       packet.\n\
    \   0-1 Zero or one instance of this attribute MAY be present in packet.\n   1\
    \   Exactly one instance of this attribute MUST be present in packet.\n"
- title: 4.  IANA Considerations
  contents:
  - "4.  IANA Considerations\n   This document uses the RADIUS [RFC2865] namespace,\
    \ see\n   <http://www.iana.org/assignments/radius-types>.  There are six\n   updates\
    \ for the section: RADIUS Packet Type Codes.  These Packet\n   Types are allocated\
    \ in [RADIANA]:\n   40 - Disconnect-Request\n   41 - Disconnect-ACK\n   42 - Disconnect-NAK\n\
    \   43 - CoA-Request\n   44 - CoA-ACK\n   45 - CoA-NAK\n   Allocation of a new\
    \ Service-Type value for \"Authorize Only\" is\n   requested.  This document also\
    \ uses the UDP [RFC768] namespace, see\n   <http://www.iana.org/assignments/port-numbers>.\
    \  The authors request\n   a port assignment from the Registered ports range.\
    \  Finally, this\n   specification allocates the Error-Cause Attribute (101) with\
    \ the\n   following decimal values:\n    #     Value\n   ---    -----\n   201\
    \    Residual Session Context Removed\n   202    Invalid EAP Packet (Ignored)\n\
    \   401    Unsupported Attribute\n   402    Missing Attribute\n   403    NAS Identification\
    \ Mismatch\n   404    Invalid Request\n   405    Unsupported Service\n   406 \
    \   Unsupported Extension\n   501    Administratively Prohibited\n   502    Request\
    \ Not Routable (Proxy)\n   503    Session Context Not Found\n   504    Session\
    \ Context Not Removable\n   505    Other Proxy Processing Error\n   506    Resources\
    \ Unavailable\n   507    Request Initiated\n"
- title: 5.  Security Considerations
  contents:
  - '5.  Security Considerations

    '
- title: 5.1.  Authorization Issues
  contents:
  - "5.1.  Authorization Issues\n   Where a NAS is shared by multiple providers, it\
    \ is undesirable for\n   one provider to be able to send Disconnect-Request or\
    \ CoA-Requests\n   affecting the sessions of another provider.\n   A NAS or RADIUS\
    \ proxy MUST silently discard Disconnect-Request or\n   CoA-Request messages from\
    \ untrusted sources.  By default, a RADIUS\n   proxy SHOULD perform a \"reverse\
    \ path forwarding\" (RPF) check to\n   verify that a Disconnect-Request or CoA-Request\
    \ originates from an\n   authorized RADIUS server.  In addition, it SHOULD be\
    \ possible to\n   explicitly authorize additional sources of Disconnect-Request\
    \ or\n   CoA-Request packets relating to certain classes of sessions.  For\n \
    \  example, a particular source can be explicitly authorized to send\n   CoA-Request\
    \ messages relating to users within a set of realms.\n   To perform the RPF check,\
    \ the proxy uses the session identification\n   attributes included in Disconnect-Request\
    \ or CoA-Request messages, in\n   order to determine the RADIUS server(s) to which\
    \ an equivalent\n   Access-Request could be routed.  If the source address of\
    \ the\n   Disconnect-Request or CoA-Request is within this set, then the\n   Request\
    \ is forwarded; otherwise it MUST be silently discarded.\n   Typically the proxy\
    \ will extract the realm from the Network Access\n   Identifier [RFC2486] included\
    \ within the User-Name Attribute, and\n   determine the corresponding RADIUS servers\
    \ in the proxy routing\n   tables.  The RADIUS servers for that realm  are then\
    \ compared against\n   the source address of the packet.  Where no RADIUS proxy\
    \ is present,\n   the RPF check will need to be performed by the NAS itself.\n\
    \   Since authorization to send a Disconnect-Request or CoA-Request is\n   determined\
    \ based on the source address and the corresponding shared\n   secret, the NASes\
    \ or proxies SHOULD configure a different shared\n   secret for each RADIUS server.\n"
- title: 5.2.  Impersonation
  contents:
  - "5.2.  Impersonation\n   [RFC2865] Section 3 states:\n      A RADIUS server MUST\
    \ use the source IP address of the RADIUS UDP\n      packet to decide which shared\
    \ secret to use, so that RADIUS\n      requests can be proxied.\n   When RADIUS\
    \ requests are forwarded by a proxy, the NAS-IP-Address or\n   NAS-IPv6-Address\
    \ Attributes will typically not match the source\n   address observed by the RADIUS\
    \ server.  Since the NAS-Identifier\n   Attribute need not contain an FQDN, this\
    \ attribute may not be\n   resolvable to the source address observed by the RADIUS\
    \ server, even\n   when no proxy is present.\n   As a result, the authenticity\
    \ check performed by a RADIUS server or\n   proxy does not verify the correctness\
    \ of NAS identification\n   attributes.  This makes it possible for a rogue NAS\
    \ to forge NAS-IP-\n   Address, NAS-IPv6-Address or NAS-Identifier Attributes\
    \ within a\n   RADIUS Access-Request in order to impersonate another NAS.  It\
    \ is\n   also possible for a rogue NAS to forge session identification\n   attributes\
    \ such as the Called-Station-Id, Calling-Station-Id, or\n   Originating-Line-Info\
    \ [NASREQ].  This could fool the RADIUS server\n   into sending Disconnect-Request\
    \ or CoA-Request messages containing\n   forged session identification attributes\
    \ to a NAS targeted by an\n   attacker.\n   To address these vulnerabilities RADIUS\
    \ proxies SHOULD check whether\n   NAS identification attributes (see Section\
    \ 3.) match the source\n   address of packets originating from the NAS.  Where\
    \ one or more\n   attributes do not match, Disconnect-Request or CoA-Request messages\n\
    \   SHOULD be silently discarded.\n   Such a check may not always be possible.\
    \  Since the NAS-Identifier\n   Attribute need not correspond to an FQDN, it may\
    \ not be resolvable to\n   an IP address to be matched against the source address.\
    \  Also, where\n   a NAT exists between the RADIUS client and proxy, checking\
    \ the NAS-\n   IP-Address or NAS-IPv6-Address Attributes may not be feasible.\n"
- title: 5.3.  IPsec Usage Guidelines
  contents:
  - "5.3.  IPsec Usage Guidelines\n   In addition to security vulnerabilities unique\
    \ to Disconnect or CoA\n   messages, the protocol exchanges described in this\
    \ document are\n   susceptible to the same vulnerabilities as RADIUS [RFC2865].\
    \  It is\n   RECOMMENDED that IPsec be employed to afford better security.\n \
    \  Implementations of this specification SHOULD support IPsec [RFC2401]\n   along\
    \ with IKE [RFC2409] for key management.  IPsec ESP [RFC2406]\n   with a non-null\
    \ transform SHOULD be supported, and IPsec ESP with a\n   non-null encryption\
    \ transform and authentication support SHOULD be\n   used to provide per-packet\
    \ confidentiality, authentication, integrity\n   and replay protection.  IKE SHOULD\
    \ be used for key management.\n   Within RADIUS [RFC2865], a shared secret is\
    \ used for hiding\n   Attributes such as User-Password, as well as used in computation\
    \ of\n   the Response Authenticator.  In RADIUS accounting [RFC2866], the\n  \
    \ shared secret is used in computation of both the Request\n   Authenticator and\
    \ the Response Authenticator.\n   Since in RADIUS a shared secret is used to provide\
    \ confidentiality as\n   well as integrity protection and authentication, only\
    \ use of IPsec\n   ESP with a non-null transform can provide security services\n\
    \   sufficient to substitute for RADIUS application-layer security.\n   Therefore,\
    \ where IPsec AH or ESP null is used, it will typically\n   still be necessary\
    \ to configure a RADIUS shared secret.\n   Where RADIUS is run over IPsec ESP\
    \ with a non-null transform, the\n   secret shared between the NAS and the RADIUS\
    \ server MAY NOT be\n   configured.  In this case, a shared secret of zero length\
    \ MUST be\n   assumed.  However, a RADIUS server that cannot know whether incoming\n\
    \   traffic is IPsec-protected MUST be configured with a non-null RADIUS\n   shared\
    \ secret.\n   When IPsec ESP is used with RADIUS, per-packet authentication,\n\
    \   integrity and replay protection MUST be used.  3DES-CBC MUST be\n   supported\
    \ as an encryption transform and AES-CBC SHOULD be supported.\n   AES-CBC SHOULD\
    \ be offered as a preferred encryption transform if\n   supported.  HMAC-SHA1-96\
    \ MUST be supported as an authentication\n   transform.  DES-CBC SHOULD NOT be\
    \ used as the encryption transform.\n   A typical IPsec policy for an IPsec-capable\
    \ RADIUS client is\n   \"Initiate IPsec, from me to any destination port UDP 1812\"\
    .  This\n   IPsec policy causes an IPsec SA to be set up by the RADIUS client\n\
    \   prior to sending RADIUS traffic.  If some RADIUS servers contacted by\n  \
    \ the client do not support IPsec, then a more granular policy will be\n   required:\
    \ \"Initiate IPsec, from me to IPsec-Capable-RADIUS-Server,\n   destination port\
    \ UDP 1812.\"\n   For a client implementing this specification, the policy would\
    \ be\n   \"Accept IPsec, from any to me, destination port UDP 3799\".  This\n\
    \   causes the RADIUS client to accept (but not require) use of IPsec.\n   It\
    \ may not be appropriate to require IPsec for all RADIUS servers\n   connecting\
    \ to an IPsec-enabled RADIUS client, since some RADIUS\n   servers may not support\
    \ IPsec.\n   For an IPsec-capable RADIUS server, a typical IPsec policy is \"\
    Accept\n   IPsec, from any to me, destination port 1812\".  This causes the\n\
    \   RADIUS server to accept (but not require) use of IPsec.  It may not\n   be\
    \ appropriate to require IPsec for all RADIUS clients connecting to\n   an IPsec-enabled\
    \ RADIUS server, since some RADIUS clients may not\n   support IPsec.\n   For\
    \ servers implementing this specification, the policy would be\n   \"Initiate\
    \ IPsec, from me to any, destination port UDP 3799\".  This\n   causes the RADIUS\
    \ server to initiate IPsec when sending RADIUS\n   extension traffic to any RADIUS\
    \ client.  If some RADIUS clients\n   contacted by the server do not support IPsec,\
    \ then a more granular\n   policy will be required, such as \"Initiate IPsec,\
    \ from me to IPsec-\n   capable-RADIUS-client, destination port UDP 3799\".\n\
    \   Where IPsec is used for security, and no RADIUS shared secret is\n   configured,\
    \ it is important that the RADIUS client and server perform\n   an authorization\
    \ check.  Before enabling a host to act as a RADIUS\n   client, the RADIUS server\
    \ SHOULD check whether the host is authorized\n   to provide network access. \
    \ Similarly, before enabling a host to act\n   as a RADIUS server, the RADIUS\
    \ client SHOULD check whether the host\n   is authorized for that role.\n   RADIUS\
    \ servers can be configured with the IP addresses (for IKE\n   Aggressive Mode\
    \ with pre-shared keys) or FQDNs (for certificate\n   authentication) of RADIUS\
    \ clients.  Alternatively, if a separate\n   Certification Authority (CA) exists\
    \ for RADIUS clients, then the\n   RADIUS server can configure this CA as a trust\
    \ anchor [RFC3280] for\n   use with IPsec.\n   Similarly, RADIUS clients can be\
    \ configured with the IP addresses\n   (for IKE Aggressive Mode with pre-shared\
    \ keys) or FQDNs (for\n   certificate authentication) of RADIUS servers.  Alternatively,\
    \ if a\n   separate CA exists for RADIUS servers, then the RADIUS client can\n\
    \   configure this CA as a trust anchor for use with IPsec.\n   Since unlike SSL/TLS,\
    \ IKE does not permit certificate policies to be\n   set on a per-port basis,\
    \ certificate policies need to apply to all\n   uses of IPsec on RADIUS clients\
    \ and servers.  In IPsec deployment\n   supporting only certificate authentication,\
    \ a management station\n   initiating an IPsec-protected telnet session to the\
    \ RADIUS server\n   would need to obtain a certificate chaining to the RADIUS\
    \ client CA.\n   Issuing such a certificate might not be appropriate if the management\n\
    \   station was not authorized as a RADIUS client.\n   Where RADIUS clients may\
    \ obtain their IP address dynamically (such as\n   an Access Point supporting\
    \ DHCP), Main Mode with pre-shared keys\n   [RFC2409] SHOULD NOT be used, since\
    \ this requires use of a group\n   pre-shared key; instead, Aggressive Mode SHOULD\
    \ be used.  Where\n   RADIUS client addresses are statically assigned, either\
    \ Aggressive\n   Mode or Main Mode MAY be used.  With certificate authentication,\
    \ Main\n   Mode SHOULD be used.\n   Care needs to be taken with IKE Phase 1 Identity\
    \ Payload selection in\n   order to enable mapping of identities to pre-shared\
    \ keys, even with\n   Aggressive Mode.  Where the ID_IPV4_ADDR or ID_IPV6_ADDR\
    \ Identity\n   Payloads are used and addresses are dynamically assigned, mapping\
    \ of\n   identities to keys is not possible, so that group pre-shared keys are\n\
    \   still a practical necessity.  As a result, the ID_FQDN identity\n   payload\
    \ SHOULD be employed in situations where Aggressive mode is\n   utilized along\
    \ with pre-shared keys and IP addresses are dynamically\n   assigned.  This approach\
    \ also has other advantages, since it allows\n   the RADIUS server and client\
    \ to configure themselves based on the\n   fully qualified domain name of their\
    \ peers.\n   Note that with IPsec, security services are negotiated at the\n \
    \  granularity of an IPsec SA, so that RADIUS exchanges requiring a set\n   of\
    \ security services different from those negotiated with existing\n   IPsec SAs\
    \ will need to negotiate a new IPsec SA.  Separate IPsec SAs\n   are also advisable\
    \ where quality of service considerations dictate\n   different handling RADIUS\
    \ conversations.  Attempting to apply\n   different quality of service to connections\
    \ handled by the same IPsec\n   SA can result in reordering, and falling outside\
    \ the replay window.\n   For a discussion of the issues, see [RFC2983].\n"
- title: 5.4.  Replay Protection
  contents:
  - "5.4.  Replay Protection\n   Where IPsec replay protection is not used, the Event-Timestamp\
    \ (55)\n   Attribute [RFC2869] SHOULD be included within all messages.  When\n\
    \   this attribute is present, both the NAS and the RADIUS server MUST\n   check\
    \ that the Event-Timestamp Attribute is current within an\n   acceptable time\
    \ window.  If the Event-Timestamp Attribute is not\n   current, then the message\
    \ MUST be silently discarded.  This implies\n   the need for time synchronization\
    \ within the network, which can be\n   achieved by a variety of means, including\
    \ secure NTP, as described in\n   [NTPAUTH].\n   Both the NAS and the RADIUS server\
    \ SHOULD be configurable to silently\n   discard messages lacking an Event-Timestamp\
    \ Attribute.  A default\n   time window of 300 seconds is recommended.\n"
- title: 6.  Example Traces
  contents:
  - "6.  Example Traces\n   Disconnect Request with User-Name:\n    0: xxxx xxxx xxxx\
    \ xxxx xxxx 2801 001c 1b23    .B.....$.-(....#\n   16: 624c 3543 ceba 55f1 be55\
    \ a714 ca5e 0108    bL5C..U..U...^..\n   32: 6d63 6869 6261\n   Disconnect Request\
    \ with Acct-Session-ID:\n    0: xxxx xxxx xxxx xxxx xxxx 2801 001e ad0d    .B.....\
    \ ~.(.....\n   16: 8e53 55b6 bd02 a0cb ace6 4e38 77bd 2c0a    .SU.......N8w.,.\n\
    \   32: 3930 3233 3435 3637                        90234567\n   Disconnect Request\
    \ with Framed-IP-Address:\n    0: xxxx xxxx xxxx xxxx xxxx 2801 001a 0bda    .B.....\"\
    2.(.....\n   16: 33fe 765b 05f0 fd9c c32a 2f6b 5182 0806    3.v[.....*/kQ...\n\
    \   32: 0a00 0203\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC1305]      Mills, D., \"Network Time Protocol\
    \ (version 3)\n                  Specification, Implementation and Analysis\"\
    , RFC 1305,\n                  March 1992.\n   [RFC1321]      Rivest, R., \"The\
    \ MD5 Message-Digest Algorithm\", RFC\n                  1321, April 1992.\n \
    \  [RFC2104]      Krawczyk, H., Bellare, M. and R. Canetti, \"HMAC:\n        \
    \          Keyed-Hashing for Message Authentication\", RFC 2104,\n           \
    \       February 1997.\n   [RFC2119]      Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n                  Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC2401]      Kent, S. and R. Atkinson, \"Security Architecture\
    \ for\n                  the Internet Protocol\", RFC 2401, November 1998.\n \
    \  [RFC2406]      Kent, S. and R. Atkinson, \"IP Encapsulating Security\n    \
    \              Payload (ESP)\", RFC 2406, November 1998.\n   [RFC2409]      Harkins,\
    \ D. and D. Carrel, \"The Internet Key Exchange\n                  (IKE)\", RFC\
    \ 2409, November 1998.\n   [RFC2434]      Narten, T. and H. Alvestrand, \"Guidelines\
    \ for Writing\n                  an IANA Considerations Section in RFCs\", BCP\
    \ 26, RFC\n                  2434, October 1998.\n   [RFC2486]      Aboba, B.\
    \ and M. Beadles, \"The Network Access\n                  Identifier\", RFC 2486,\
    \ January 1999.\n   [RFC2865]      Rigney, C., Willens, S., Rubens, A. and W.\
    \ Simpson,\n                  \"Remote Authentication Dial In User Service (RADIUS)\"\
    ,\n                  RFC 2865, June 2000.\n   [RFC2866]      Rigney, C., \"RADIUS\
    \ Accounting\", RFC 2866, June 2000.\n   [RFC2869]      Rigney, C., Willats, W.\
    \ and P. Calhoun, \"RADIUS\n                  Extensions\", RFC 2869, June 2000.\n\
    \   [RFC3162]      Aboba, B., Zorn, G. and D. Mitton, \"RADIUS and IPv6\",\n \
    \                 RFC 3162, August 2001.\n   [RFC3280]      Housley, R., Polk,\
    \ W., Ford, W. and D. Solo, \"Internet\n                  X.509 Public Key Infrastructure\
    \ Certificate and\n                  Certificate Revocation List (CRL) Profile\"\
    , RFC 3280,\n                  April 2002.\n   [RADIANA]      Aboba, B., \"IANA\
    \ Considerations for RADIUS (Remote\n                  Authentication Dial In\
    \ User Service)\", RFC 3575, July\n                  2003.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [RFC2882]      Mitton, D., \"Network Access\
    \ Server Requirements:\n                  Extended RADIUS Practices\", RFC 2882,\
    \ July 2000.\n   [RFC2983]      Black, D. \"Differentiated Services and Tunnels\"\
    , RFC\n                  2983, October 2000.\n   [AAATransport] Aboba,  B. and\
    \ J. Wood, \"Authentication, Authorization\n                  and Accounting (AAA)\
    \ Transport Profile\", RFC 3539,\n                  June 2003.\n   [Diameter]\
    \     Calhoun, P., et al., \"Diameter Base Protocol\", Work in\n             \
    \     Progress.\n   [MD5Attack]    Dobbertin, H., \"The Status of MD5 After a\
    \ Recent\n                  Attack\", CryptoBytes Vol.2 No.2, Summer 1996.\n \
    \  [NASREQ]       Calhoun, P., et al., \"Diameter Network Access Server\n    \
    \              Application\", Work in Progress.\n   [NTPAUTH]      Mills, D.,\
    \ \"Public Key Cryptography for the Network\n                  Time Protocol\"\
    , Work in Progress.\n"
- title: 8.  Intellectual Property Statement
  contents:
  - "8.  Intellectual Property Statement\n   The IETF takes no position regarding\
    \ the validity or scope of any\n   intellectual property or other rights that\
    \ might be claimed to\n   pertain to the implementation or use of the technology\
    \ described in\n   this document or the extent to which any license under such\
    \ rights\n   might or might not be available; neither does it represent that it\n\
    \   has made any effort to identify any such rights.  Information on the\n   IETF's\
    \ procedures with respect to rights in standards-track and\n   standards- related\
    \ documentation can be found in BCP-11.  Copies of\n   claims of rights made available\
    \ for publication and any assurances of\n   licenses to be made available, or\
    \ the result of an attempt made to\n   obtain a general license or permission\
    \ for the use of such\n   proprietary rights by implementers or users of this\
    \ specification can\n   be obtained from the IETF Secretariat.\n   The IETF invites\
    \ any interested party to bring to its attention any\n   copyrights, patents or\
    \ patent applications, or other proprietary\n   rights which may cover technology\
    \ that may be required to practice\n   this standard.  Please address the information\
    \ to the IETF Executive\n   Director.\n"
- title: 9.  Acknowledgments
  contents:
  - "9.  Acknowledgments\n   This protocol was first developed and distributed by\
    \ Ascend\n   Communications.  Example code was distributed in their free server\n\
    \   kit.\n   The authors would like to acknowledge the valuable suggestions and\n\
    \   feedback from the following people:\n      Avi Lior <avi@bridgewatersystems.com>,\n\
    \      Randy Bush <randy@psg.net>,\n      Steve Bellovin <smb@research.att.com>\n\
    \      Glen Zorn <gwz@cisco.com>,\n      Mark Jones <mjones@bridgewatersystems.com>,\n\
    \      Claudio Lapidus <clapidus@hotmail.com>,\n      Anurag Batta <Anurag_Batta@3com.com>,\n\
    \      Kuntal Chowdhury <chowdury@nortelnetworks.com>, and\n      Tim Moore <timmoore@microsoft.com>.\n\
    \      Russ Housley <housley@vigilsec.com>\n"
- title: 10.  Authors' Addresses
  contents:
  - "10.  Authors' Addresses\n   Murtaza Chiba\n   Cisco Systems, Inc.\n   170 West\
    \ Tasman Dr.\n   San Jose CA, 95134\n   EMail: mchiba@cisco.com\n   Phone: +1\
    \ 408 525 7198\n   Gopal Dommety\n   Cisco Systems, Inc.\n   170 West Tasman Dr.\n\
    \   San Jose, CA 95134\n   EMail: gdommety@cisco.com\n   Phone: +1 408 525 1404\n\
    \   Mark Eklund\n   Cisco Systems, Inc.\n   170 West Tasman Dr.\n   San Jose,\
    \ CA 95134\n   EMail: meklund@cisco.com\n   Phone: +1 865 671 6255\n   David Mitton\n\
    \   Circular Logic UnLtd.\n   733 Turnpike Street #154\n   North Andover, MA 01845\n\
    \   EMail: david@mitton.com\n   Phone: +1 978 683 1814\n   Bernard Aboba\n   Microsoft\
    \ Corporation\n   One Microsoft Way\n   Redmond, WA 98052\n   EMail: bernarda@microsoft.com\n\
    \   Phone: +1 425 706 6605\n   Fax:   +1 425 936 7329\n"
- title: 11.  Full Copyright Statement
  contents:
  - "11.  Full Copyright Statement\n   Copyright (C) The Internet Society (2003).\
    \  All Rights Reserved.\n   This document and translations of it may be copied\
    \ and furnished to\n   others, and derivative works that comment on or otherwise\
    \ explain it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assignees.\n\
    \   This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
