- title: __initial_text__
  contents:
  - "                      EXTERIOR GATEWAY PROTOCOL (EGP)\n                     \
    \          Eric C. Rosen\n                       Bolt Beranek and Newman Inc.\n\
    \                               October 1982\n"
- title: It is proposed to establish a standard for Gateway to Gateway procedures
  contents:
  - 'It is proposed to establish a standard for Gateway to Gateway procedures

    '
- title: that allow the Gateways to be mutually suspicious.  This document is a
  contents:
  - 'that allow the Gateways to be mutually suspicious.  This document is a

    '
- title: DRAFT for that standard.  Your comments are strongly encouraged.
  contents:
  - "DRAFT for that standard.  Your comments are strongly encouraged.\n          \
    \                   Table of Contents\n     1   INTRODUCTION..........................................\
    \ 1\n     2   NEIGHBOR ACQUISITION.................................. 8\n     3\
    \   NEIGHBOR REACHABILITY PROTOCOL....................... 11\n     4   NETWORK\
    \ REACHABILITY (NR) MESSAGE.................... 15\n     5   POLLING FOR NR MESSAGES..............................\
    \ 22\n     6   SENDING NR MESSAGES.................................. 25\n    \
    \ 7   INDIRECT NEIGHBORS................................... 27\n     8   HOW TO\
    \ BE A STUB GATEWAY............................. 28\n     9   LIMITATIONS..........................................\
    \ 32\n                                   - i -\n     1  INTRODUCTION\n       \
    \   The DARPA Catenet is expected to be a continuously expanding\n     system,\
    \  with  more  and  more  hosts  on  more and more networks\n     participating\
    \ in it.  Of course, this will require more and  more\n     gateways.   In  the\
    \  past,  such  expansion  has taken place in a\n     relatively unstructured\
    \ manner.  New gateways,  often  containing\n     radically different software\
    \ than the existing gateways, would be\n     added and would immediately begin\
    \  participating  in  the  common\n     routing algorithm via the GGP protocol.\
    \  However, as the internet\n     grows larger and larger, this simple method\
    \ of expansion  becomes\n     less and less feasible.  There are a number of reasons\
    \ for this:\n          - the overhead of the routing algorithm becomes  excessively\n\
    \            large;\n          - the  proliferation   of   radically   different\
    \   gateways\n            participating  in  a single common routing algorithm\
    \ makes\n            maintenance and fault isolation nearly  impossible,  since\n\
    \            it  becomes  impossible  to  regard  the  internet  as  an\n    \
    \        integrated communications system;\n          - the  gateway  software\
    \  and  algorithms,  especially   the\n            routing  algorithm, become\
    \ too rigid and inflexible, since\n            any proposed change must be made\
    \  in  too  many  different\n            places and by too many different people.\n\
    \          In the future, the internet is expected to evolve into a set\n    \
    \ of  separate  domains  or  \"autonomous  systems\",  each  of which\n     consists\
    \ of a set of one or more relatively homogeneous gateways.\n     The  protocols,\
    \  and  in  particular  the routing algorithm which\n     these gateways use among\
    \ themselves, will be  a  private  matter,\n     and  need never be implemented\
    \ in gateways outside the particular\n     domain or system.\n          In the\
    \ simplest case, an autonomous system might consist  of\n     just a single gateway\
    \ connecting, for example, a local network to\n     the ARPANET.  Such a gateway\
    \ might be called  a  \"stub  gateway\",\n     since  its  only purpose is to\
    \ interface the local network to the\n     rest of the internet, and it is  not\
    \  intended  to  be  used  for\n     handling  any traffic which neither originated\
    \ in nor is destined\n     for that particular local network.  In the near-term\
    \  future,  we\n     will  begin  to  think  of  the  internet  as a set of autonomous\n\
    \     systems, one of which consists of the DARPA gateways  on  ARPANET\n    \
    \ and  SATNET,  and  the others of which are stub gateways to local\n     networks.\
    \   The former system, which we  shall  call  the  \"core\"\n     system,  will\
    \ be used as a transport or \"long-haul\" system by the\n     latter systems.\n\
    \          Ultimately, however, the internet may consist of a number of\n    \
    \ co-equal  autonomous  systems,  any  of  which  may be used (with\n     certain\
    \  restrictions  which  will  be  discussed  later)  as   a\n     transport  medium\
    \  for  traffic  originating  in  any  system and\n     destined for any system.\
    \  When this  more  complex  configuration\n     comes  into  being,  it  will\
    \  be inappropriate to regard any one\n     autonomous  system  as  a  \"core\"\
    \  system.   For  the   sake   of\n     concreteness, however, and because the\
    \ initial implementations of\n     the Exterior Gateway Protocol are expected\
    \ to focus  on  the  the\n     case  of  connecting  \"stub  gateways\"  to  the\
    \ DARPA gateways on\n     ARPANET and SATNET, we will often use the term \"core\"\
    \ gateways in\n     our examples and discussion.\n          The purpose of the\
    \ Exterior Gateway  Protocol  (EGP)  is  to\n     enable  one  or  more  autonomous\
    \ systems to be used as transport\n     media for traffic originating in some\
    \ other autonomous system and\n     destined  for yet another, while allowing\
    \ the end-user to see the\n     composite of all the autonomous systems  as  a\
    \  single  internet,\n     with  a  flat, uniform address space.  The route which\
    \ a datagram\n     takes through the internet, and the number of autonomous  systems\n\
    \     which  it  traverses,  are  to  be  transparent  to  the end-user\n    \
    \ (unless, of course, the end-user makes  use  of  the  IP  \"source\n     route\"\
    \ option).\n          In  describing  the  Exterior  Gateway  Protocol,  we  \
    \ have\n     deliberately  left  a great deal of latitude to the designers and\n\
    \     implementers of particular autonomous systems, particularly  with\n    \
    \ regard to timer values.  We have done this because we expect that\n     different\
    \  gateway   implementations   and   different   internet\n     environments \
    \ may  just have different requirements and goals, so\n     that no single strict\
    \ implementation specification could apply to\n     all.   However,  this does\
    \ NOT mean that ANY implementation which\n     conforms to the specification will\
    \ work well, or that  the  areas\n     in  which  we  have left latitude are not\
    \ crucial to performance.\n     The fact that some time-out value, for example,\
    \ is not  specified\n     here does not mean that everything will work no matter\
    \ what value\n     is assigned.\n          Autonomous systems will be  assigned\
    \  16-bit  identification\n     numbers  (in  much  the same ways as network and\
    \ protocol numbers\n     are now assigned), and every EGP message header contains\
    \ one word\n     for  this  number.   Zero  will not be assigned to any autonomous\n\
    \     system; rather, the  presence  of  a  zero  in  this  field  will\n    \
    \ indicate that no number is present.\n          We need to introduce the concept\
    \  of  one  gateway  being  a\n     NEIGHBOR  of  another.   In the simplest and\
    \ most common case, we\n     call two gateways \"neighbors\" if there is a network\
    \ to which each\n     has  an interface.  However, we will need a somewhat more\
    \ general\n     notion of \"neighbor\" to allow the following two cases:\n   \
    \       a) Two gateways may be regarded as  neighbors  if  they  are\n       \
    \      directly  connected  not by a network (in the usual sense\n           \
    \  of the term), but by a simple wire, or HDLC line, or some\n             similar\
    \ means of \"direct connection\".\n          b) Two gateways may be regarded as\
    \  neighbors  if  they  are\n             connected  by an \"internet\" which\
    \ is transparent to them.\n             That is, we would  like  to  be  able\
    \  to  say  that  two\n             gateways  are  neighbors even if they are\
    \ connected by an\n             internet, as long as the gateways utilize no knowledge\
    \ of\n             the  internal  structure  of  that  internet in their own\n\
    \             packet-forwarding algorithms.\n     In order to handle all these\
    \ cases, let us say that two  gateways\n     are NEIGHBORS if they are connected\
    \ by some communications medium\n     whose internal structure is transparent\
    \ to them.   (See  IEN  184\n     for a more general discussion of this notion\
    \ of neighbor.)\n          If two neighbors are part of the same autonomous system,\
    \  we\n     call  them  INTERIOR  NEIGHBORS; if two neighbors are not part of\n\
    \     the same autonomous system, we call them EXTERIOR NEIGHBORS.   In\n    \
    \ order  for  one  system  to  use  another  as a transport medium,\n     gateways\
    \ which are exterior neighbors of each other must be  able\n     to find out which\
    \ networks can be reached through the other.  The\n     Exterior Gateway Protocol\
    \ enables this information to  be  passed\n     between  exterior  neighbors.\
    \  Since it is a polling protocol, it\n     also enables each gateway to control\
    \ the rate at which  it  sends\n     and  receives  network  reachability  information,\
    \  allowing each\n     system to control its own overhead.  It also enables each\
    \  system\n     to  have  an independent routing algorithm whose operation cannot\n\
    \     be disrupted by failures of other systems.\n          It must be clearly\
    \ understood that any autonomous system  in\n     which  routing  needs  to be\
    \ performed among gateways within that\n     system must implement its  own  routing\
    \  algorithm.   (A  routing\n     algorithm  is  not  generally  necessary  for\
    \ a simple autonomous\n     system which consists of a single stub  gateway.)\
    \   The  Exterior\n     Gateway Protocol is NOT a routing algorithm.  It enables\
    \ exterior\n     neighbors to exchange information which is likely to be needed\
    \ by\n     any  routing algorithm, but it does NOT specify what the gateways\n\
    \     are to do with this information.  The \"routing updates\"  of  some\n  \
    \   autonomous  system's interior routing algorithm may or may not be\n     similar\
    \ in  format  to  the  messages  of  the  exterior  gateway\n     protocol.  The\
    \ gateways in the DARPA \"core\" system will initially\n     use the GGP protocol\
    \ (the old Gateway-Gateway protocol) as  their\n     routing  algorithm, but this\
    \ will be subject to change.  Gateways\n     in other autonomous systems may use\
    \ their  own  Interior  Gateway\n     Protocols  (IGPs),  which may or may not\
    \ be similar to the IGP of\n     any other autonomous system.  They may, of course,\
    \ use  GGP,  but\n     will  not  be permitted to exchange GGP messages with gateways\
    \ in\n     other autonomous systems.\n          It must also be clearly understood\
    \ that the Exterior Gateway\n     Protocol  is  NOT  intended to provide information\
    \ which could be\n     used as input  to  a  completely  general  area  or  hierarchical\n\
    \     routing  algorithm.   It  is  intended  for  a  set of autonomous\n    \
    \ systems which are connected in a tree, with no cycles.   It  does\n     not\
    \  enable  the  passing  of  sufficient  information to prevent\n     routing\
    \ loops if cycles in the topology do exist.\n          The Exterior Gateway Protocol\
    \ has three parts: (a)  Neighbor\n     Acquisition Protocol, (b) Neighbor Reachability\
    \ Protocol, and (c)\n     Network  Reachability  determination.   Note  that \
    \ all  messages\n     defined  by EGP are intended to travel only a single \"\
    hop\".  That\n     is, they originate at one gateway and are sent to  a  neighboring\n\
    \     gateway   without  the  mediation  of  any  intervening  gateway.\n    \
    \ Therefore, the time-to-live field should be set to a  very  small\n     value.\
    \   Gateways  which  encounter EGP messages in their message\n     streams which\
    \ are not addressed to them may discard them.\n     2  NEIGHBOR ACQUISITION\n\
    \          Before it is possible to obtain routing information from  an\n    \
    \ exterior  gateway,  it  is necessary to acquire that gateway as a\n     direct\
    \ neighbor.  (The distinction between  direct  and  indirect\n     neighbors \
    \ will  be  made  in a later section.)  In order for two\n     gateways to become\
    \ direct neighbors, they must be  neighbors,  in\n     the  sense  defined  above,\
    \  and  they  must execute the NEIGHBOR\n     ACQUISITION  PROTOCOL,  which  is\
    \  simply  a  standard  three-way\n     handshake.\n          A gateway that wishes\
    \ to initiate neighbor acquisition  with\n     another  sends  it  a Neighbor\
    \ Acquisition Request.  This message\n     should be repeatedly transmitted (at\
    \ a reasonable  rate,  perhaps\n     once  every  30 seconds or so) until a Neighbor\
    \ Acquisition Reply\n     is received.  The Request will contain an  identification\
    \  number\n     which  is  copied into the reply so that request and reply can\
    \ be\n     matched up.\n          A gateway receiving  a  Neighbor  Acquisition\
    \  Request  must\n     determine  whether  it  wishes to become a direct neighbor\
    \ of the\n     source of the Request.  If not, it may, at  its  option,  respond\n\
    \     with   a   Neighbor   Acquisition   Refusal  message,  optionally\n    \
    \ specifying the reason for refusal.  Otherwise, it should  send  a\n     Neighbor\
    \ Acquisition Reply message.  It must also send a Neighbor\n     Acquisition Request\
    \ message, unless it has done so already.\n          Two gateways become direct\
    \ neighbors when each  has  sent  a\n     Neighbor  Acquisition  Message to, and\
    \ received the corresponding\n     Neighbor Acquisition Reply from, the other.\n\
    \          Unmatched Replies or Refusals should be  discarded  after  a\n    \
    \ reasonable  period  of time.  However, information about any such\n     unmatched\
    \ messages may be useful for diagnostic purposes.\n          A Neighbor Acquisition\
    \  Message  from  a  gateway  which  is\n     already a direct neighbor should\
    \ be responded to with a Reply and\n     a Neighbor Acquisition Message.\n   \
    \       If  a  Neighbor  Acquisition  Reply  is  received   from   a\n     prospective\
    \ neighbor, but a period of time passes during which no\n     Neighbor Acquisition\
    \ Message is received  from  that  prospective\n     neighbor,  the  neighbor\
    \  acquisition  protocol  shall  be deemed\n     incomplete.  A Neighbor Cease\
    \ message (see below) should then  be\n     sent.   If  one  gateway  still desires\
    \ to acquire the other as a\n     neighbor, the protocol must be repeated from\
    \ the beginning.\n          If  a  gateway  wishes  to  cease  being  a  neighbor\
    \  of  a\n     particular  exterior  gateway, it sends a Neighbor Cease message.\n\
    \     A gateway  receiving  a  Neighbor  Cease  message  should  always\n    \
    \ respond with a Neighbor Cease Acknowledgment.  It should cease to\n     treat\
    \ the sender of the message as a neighbor in any way.   Since\n     there  is\
    \  a  significant  amount  of protocol run between direct\n     neighbors (see\
    \ below), if some gateway no longer needs  to  be  a\n     direct  neighbor  of\
    \  some other, it is \"polite\" to indicate this\n     fact with a Neighbor Cease\
    \ Message.  The Neighbor  Cease  Message\n     should  be  retransmitted  (up\
    \  to some number of times) until an\n     acknowledgment for it is received.\n\
    \          Once  a  Neighbor  Cease  message  has  been  received,  the\n    \
    \ Neighbor   Reachability  Protocol  (below)  should  cease  to  be\n     executed.\n\
    \          NOTE THAT WE HAVE NOT SPECIFIED THE WAY IN WHICH ONE GATEWAY\n    \
    \ INITIALLY  DECIDES THAT IT WANTS TO BECOME A NEIGHBOR OF ANOTHER.\n     While\
    \ this is hardly a trivial problem, it is  not  part  of  the\n     External Gateway\
    \ Protocol.\n     3  NEIGHBOR REACHABILITY PROTOCOL\n          It is important\
    \ for a gateway to keep real-time  information\n     as  to the reachability of\
    \ its neighbors.  If a gateway concludes\n     that a particular neighbor cannot\
    \ be  reached,  it  should  cease\n     forwarding  traffic to that gateway. \
    \ To make that determination,\n     a NEIGHBOR REACHABILITY protocol is  needed.\
    \   The  EGP  protocol\n     provides two messages types for this purpose -- a\
    \ \"Hello\" message\n     and an \"I Heard You\" message.\n          When a \"\
    Hello\" message is received from a  direct  neighbor,\n     an \"I Heard You\"\
    \ must be returned to that neighbor \"immediately\".\n     The delay between receiving\
    \ a \"Hello\" and returning an  \"I  Heard\n     You\" should never be more than\
    \ a few seconds.\n          At  the  current  time,   the   reachability   determination\n\
    \     algorithm  is  left to the designers of a particular gateway.  We\n    \
    \ have in mind algorithms like the following:\n          A reachable  neighbor\
    \  shall  be  declared  unreachable  if,\n     during the time in which we sent\
    \ our last n \"Hello\"s, we received\n     fewer than k \"I Heard You\"s in return.\
    \  An  unreachable  neighbor\n     shall  be declared reachable if, during the\
    \ time in which we sent\n     our last m \"Hello\"s, we received at least j  \"\
    I  Heard  You\"s  in\n     return.\n          However, the frequency with which\
    \ the \"Hello\"s are sent, and\n     the  values  of the parameters k, n, j, and\
    \ m cannot be specified\n     here.  For best results, this will depend on the\
    \  characteristics\n     of  the  neighbor  and of the network which the neighbors\
    \ have in\n     common.  THIS IMPLIES THAT THE PROPER PARAMETERS MAY NEED  TO\
    \  BE\n     DETERMINED  JOINTLY  BY THE DESIGNERS AND IMPLEMENTERS OF THE TWO\n\
    \     NEIGHBORING  GATEWAYS;  choosing  algorithms  and  parameters  in\n    \
    \ isolation,   without   considering  the  characteristics  of  the\n     neighbor\
    \ and the connecting network, would  not  be  expected  to\n     result in optimum\
    \ reachability determinations.\n          The \"Hello\" and \"I Heard You\" messages\
    \ have a  status  field\n     which  the sending gateway uses to indicate whether\
    \ it thinks the\n     receiving gateway is reachable or not.  This information\
    \  can  be\n     useful  for  diagnostic  purposes.  It also allows one gateway\
    \ to\n     make its reachability determination parasitic on the other:  only\n\
    \     one  gateway  actually  needs  to  send \"Hello\" messages, and the\n  \
    \   other can declare it up or down based on the status field in  the\n     \"\
    Hello\".   That  is,  the  \"passive\" gateway (which sends only \"I\n     Heard\
    \  You\"s)  declares  the  \"active\"  one  (which  sends   only\n     \"Hello\"\
    s)  to  be reachable when the \"Hello\"s from the active one\n     indicate that\
    \ it has declared the passive one  to  be  reachable.\n     Of  course,  this\
    \ can only work if there is prior agreement as to\n     which neighbor is to be\
    \ the active one.  (Ways of coming to  this\n     \"prior agreement\" are not\
    \ part of the Exterior Gateway Protocol.)\n          A  direct  neighbor  gateway\
    \   should   also   be   declared\n     unreachable  if  the  network  connecting\
    \ it supplies lower level\n     protocol information from which this can be deduced.\
    \   Thus,  for\n     example,  if  a gateway receives an 1822 Destination Dead\
    \ message\n     from the ARPANET which indicates that a direct neighbor is  dead,\n\
    \     it should declare that neighbor unreachable.  The neighbor should\n    \
    \ not be declared reachable again until  the  requisite  number  of\n     Hello/I-Heard-You\
    \ packets have been exchanged.\n          A direct neighbor which  has  become\
    \  unreachable  does  not\n     thereby  cease  to  be  a  direct  neighbor. \
    \ The neighbor can be\n     declared reachable again without  any  need  to  go\
    \  through  the\n     neighbor  acquisition  protocol  again.  However, if the\
    \ neighbor\n     remains unreachable for an extremely long period of time, such\
    \ as\n     an  hour,  the  gateway  should  cease to treat it as a neighbor,\n\
    \     i.e., should cease sending Hello messages to  it.   The  neighbor\n    \
    \ acquisition  protocol  would  then  need to be repeated before it\n     could\
    \ become a direct neighbor again.\n          \"Hello\" and \"I Heard You\" messages\
    \ from gateway G to gateway\n     G'  also  carry  the identification number of\
    \ the NR poll message\n     (see below) which G has most recently received from\
    \ G'.\n          \"Hello\" and \"I Heard You\" messages from gateway G to gateway\n\
    \     G'  also  carry  the  minimum interval in minutes with which G is\n    \
    \ willing to be polled by G' for NR messages (see below).\n          \"Hello\"\
    \ messages from sources other  than  direct  neighbors\n     should  simply  be\
    \ ignored.  However, logging the presence of any\n     such messages might provide\
    \ useful diagnostic information.\n          A gateway which is going down, or\
    \  whose  interface  to  the\n     network which connects it to a particular neighbor\
    \ is going down,\n     should send a Gateway Going Down message to all direct\
    \  neighbors\n     which  will  no longer be able to reach it.  It should retransmit\n\
    \     that message (up to some number of times)  until  it  receives  a\n    \
    \ Gateway  Going  Down Acknowledgment.  This provides the neighbors\n     with\
    \ an advance warning of an outage, and enables them to prepare\n     for  it \
    \ in  a  way  which  will  minimize disruption to existing\n     traffic.\n  \
    \   4  NETWORK REACHABILITY (NR) MESSAGE\n          Terminology: Let gateway G\
    \ have an interface to  network  N.\n     We  say  that G is AN APPROPRIATE FIRST\
    \ HOP to network M relative\n     to network N (where M and N are distinct networks)\
    \ if and only if\n     the following condition holds:\n          Traffic which\
    \ is destined for network M, and  which  arrives\n          at gateway G over\
    \ its network N interface, will be forwarded\n          to M by G over a path\
    \  which  does  not  include  any  other\n          gateway with an interface\
    \ to network N.\n          In short, G is  an  appropriate  first  hop  for  network\
    \  M\n     relative  to network N just in case there is no better gateway on\n\
    \     network N through which to route traffic which  is  destined  for\n    \
    \ network  M.   For  optimal routing, traffic in network N which is\n     destined\
    \ for network M ought always to be forwarded to a  gateway\n     which is an appropriate\
    \ first hop.\n          In  order  for  exterior  neighbors  G  and  G'  (which\
    \  are\n     neighbors  over network N) to be able to use each other as packet\n\
    \     switches for forwarding traffic to remote networks, each needs to\n    \
    \ know  the  list of networks for which the other is an appropriate\n     first\
    \ hop.  The Exterior  Gateway  Protocol  defines  a  message,\n     called  the\
    \  Network  Reachability  Message  (or NR message), for\n     transferring this\
    \ information.\n          Let G be a gateway on network N.  Then the NR message\
    \  which\n     G sends about network N must contain the following information:\n\
    \          A list of all the networks for which  G  is  an  appropriate\n    \
    \      first hop relative to network N.\n     If G' can obtain this information\
    \ from exterior neighbor G,  then\n     it  knows  that no traffic destined for\
    \ networks which are NOT in\n     that list should be forwarded to G.  (It cannot\
    \ simply  conclude,\n     however,  that all traffic for any networks in that\
    \ list ought to\n     be forwarded via G, since G' may also have other neighbors\
    \  which\n     are also appropriate first hops to network N.  For example, G and\n\
    \     G'' might each be neighbors of G',  but  might  be  \"equidistant\"\n  \
    \   from  some  network  M.   Then each could be an appropriate first\n     hop.)\n\
    \          For each network in the list, the NR message also contains a\n    \
    \ byte  which  specifies  the  \"distance\" (according to some metric\n     whose\
    \ definition is left  to  the  designers  of  the  autonomous\n     system  of\
    \  which  gateway G is a member) from G to that network.\n     This information\
    \ might (or might not) be useful in  the  interior\n     routing algorithm of\
    \ gateway G', or for diagnostic purposes.\n          The maximum value of distance\
    \ (255.) shall be taken to  mean\n     that  the network is UNREACHABLE.  ALL\
    \ OTHER VALUES WILL BE TAKEN\n     TO MEAN THAT THE NETWORK IS REACHABLE.\n  \
    \        If an NR message from some gateway G fails to  mention  some\n     network\
    \  N which was mentioned in the previous NR message from G,\n     it shall be\
    \ assumed that N is still reachable from  G.   HOWEVER,\n     IF  N IS NOT MENTIONED\
    \ IN TWO SUCCESSIVE NR MESSAGES FROM G, THAT\n     SHALL BE TAKEN TO MEAN THAT\
    \ N IS  NO  LONGER  REACHABLE  FROM  G.\n     This  procedure is necessary to\
    \ ensure that networks which can no\n     longer be  reached,  but  which  are\
    \  never  explicitly  declared\n     unreachable, are timed out and removed from\
    \ the list of reachable\n     networks.\n          It may often be the case that\
    \ where G and  G'  are  exterior\n     neighbors on network N, G knows of many\
    \ more gateway neighbors on\n     network N, and knows for which networks those\
    \ other neighbors are\n     the appropriate first hop.  Since G' may not know\
    \ about all these\n     other neighbors, it is convenient and often more efficient\
    \ for it\n     to be able to obtain this information from G.  Therefore, the EGP\n\
    \     NR message also contains fields which  allow  G  to  specify  the\n    \
    \ following information:\n          a) A list of all neighbors (both interior\
    \ and exterior) of G\n             (on  network  N)  which  G  has reliably determined\
    \ to be\n             reachable.  Gateways should be included in this list only\n\
    \             if  G  is  actively  running  its  neighbor  reachability\n    \
    \         protocol with them.\n          b) For each of those neighbors, the \
    \ list  of  networks  for\n             which that neighbor is an appropriate\
    \ first hop (relative\n             to network N).\n          c) For each such\
    \ <neighbor, network>  pair,  the  \"distance\"\n             from that neighbor\
    \ to that network.\n          Thus the NR message provides a means of allowing\
    \  a  gateway\n     to  \"discover\" new neighbors by seeing whether a neighbor\
    \ that it\n     already knows  of  has  any  additional  neighbors  on  the  same\n\
    \     network.  This information also makes possible the implementation\n    \
    \ of the INDIRECT NEIGHBOR strategy defined below.\n          A  more  precise\
    \  description  of  the  NR  message  is  the\n     following.\n          The\
    \ data portion of the  message  will  consist  largely  of\n     blocks  of data.\
    \  Each block will be headed by a gateway address,\n     which will be the address\
    \  either  of  the  gateway  sending  the\n     message  or  of  one  of  that\
    \ gateway's neighbors.  Each gateway\n     address will be followed by a list\
    \ of the networks for which that\n     gateway  is  an appropriate first hop,\
    \ and the distance from that\n     gateway to each network.\n          Preceding\
    \ the list of data blocks is:\n          a) The address of the network which this\
    \ message  is  about.\n             If  G  and  G' are neighbors on network N,\
    \ then in the NR\n             message going from G  to  G',  this  is  the  address\
    \  of\n             network   N.   For  convenience,  four  bytes  have  been\n\
    \             allocated for this address -- the trailing one,  two,  or\n    \
    \         three bytes should be zero.\n          b) The count (one byte) of the\
    \ number of interior  neighbors\n             of  G  for  which  this message\
    \ contains data blocks.  By\n             convention, this count will include\
    \ the data block for  G\n             itself, which should be the first one to\
    \ appear.\n          c) The count (one byte) of the number of exterior  neighbors\n\
    \             of G for which this message contains data blocks.\n          Then\
    \ follow the data blocks themselves, first the block  for\n     G itself, then\
    \ the blocks for all the interior neighbors of G (if\n     any), then the blocks\
    \ for  the  exterior  neighbors.   Since  all\n     gateways  mentioned  are \
    \ on  the same network, whose address has\n     already been given, the gateway\
    \  addresses  are  given  with  the\n     network  address part (one, two, or\
    \ three bytes) omitted, to save\n     space.\n          Each block includes  a\
    \  one-byte  count  of  the  number  of\n     networks for which that gateway\
    \ is the appropriate first hop.  In\n     the list of networks, each network address\
    \ is either one, two, or\n     three  bytes,  depending  on whether it is a class\
    \ A, class B, or\n     class C network.  No trailing bytes are used.\n       \
    \   It may sometimes be necessary to fragment  the  NR  message.\n     The  NR\
    \  message  contains  a  byte indicating the number of this\n     fragment (fragments\
    \ will be  numbered  from  zero),  and  a  byte\n     containing  the  number\
    \  of  the last fragment (NOT the number of\n     fragments).  If fragmentation\
    \ is not used, these bytes must  both\n     be  zero.   EACH  FRAGMENT  MUST \
    \ BE  A  FULLY  SELF-CONTAINED NR\n     MESSAGE.  That is, each fragment  will\
    \  begin  with  a  count  of\n     interior  and  exterior  neighbors,  and  will\
    \ have some integral\n     number of gateway data blocks.  The number of data\
    \ blocks in each\n     fragment  must correspond to the neighbor counts at the\
    \ beginning\n     of that fragment.  However, only the first fragment should \
    \ begin\n     with a data block describing the sending gateway.\n          This\
    \  scheme  enables  each   fragment   to   be   processed\n     independently,\
    \ and requires no complex reassembly mechanisms.  It\n     also enables processing\
    \ of a message all of whose fragments  have\n     not been received.  If, after\
    \ some amount of time and some number\n     of retransmissions  of  a  poll, \
    \ not  all  fragments  have  been\n     received,  the  fragments which are present\
    \ shall be processed as\n     if they constituted the complete NR message.   (This\
    \  means  that\n     networks  mentioned  only in the missing fragment will retain\
    \ the\n     \"distance\" values they had in the previous NR message  from  that\n\
    \     gateway.   However,  if  no new value for a particular network is\n    \
    \ received in the next NR message from that  gateway,  the  network\n     will\
    \ be declared unreachable.)\n     5  POLLING FOR NR MESSAGES\n          No gateway\
    \ is required to send  NR  messages  to  any  other\n     gateway,  except  as\
    \  a  response  to  an  NR  Poll from a direct\n     neighbor.  However, a gateway\
    \ is required to  respond  to  an  NR\n     Poll  from  a  direct neighbor within\
    \ several seconds (subject to\n     the qualification two paragraphs  hence),\
    \  even  if  the  gateway\n     believes that neighbor to be down.\n         \
    \ The EGP NR Poll message is defined  for  this  purpose.   No\n     gateway \
    \ may  poll another for an NR message more often than once\n     per minute. \
    \ A gateway receiving more than one  poll  per  minute\n     may  simply  ignore\
    \  the  excess  polls,  or  may return an error\n     message.  The Hello and\
    \ I Heard  You  messages  which  gateway  G\n     sends  to  gateway  G' indicate\
    \ the minimum interval which G will\n     accept as the polling interval from\
    \ G'.  That  is,  G'  will  not\n     guarantee  to  respond to polls from G that\
    \ arrive less than that\n     interval apart.\n          Polls must only  be \
    \ sent  to  direct  neighbors  which  are\n     declared reachable by the neighbor\
    \ reachability protocol.\n          An NR Poll message contains an identification\
    \ number  chosen\n     by  the  polling  gateway.   The  polled gateway will return\
    \ this\n     number in the NR message it sends in response  to  the  poll,  to\n\
    \     enable  the polling gateway to match up received NR messages with\n    \
    \ polls.  It will be the responsibility of the polling  gateway  to\n     choose\
    \ an identification number which is sufficiently \"unique\" to\n     allow detection\
    \ of out-of-date NR messages  which  may  still  be\n     floating   around  \
    \ the  network.   Since  polls  are  relatively\n     infrequent, this is  not\
    \  expected  to  be  much  of  a  problem.\n     However,  to  aid in choosing\
    \ an identification number, the Hello\n     and I Heard You messages carry the\
    \ identification number  of  the\n     last  NR  poll received from the neighbor\
    \ to which they are being\n     sent.\n          In general, a poll should be\
    \ retransmitted  some  number  of\n     times  (with a reasonable interval between\
    \ retransmissions) until\n     an NR message is received.  IF NO NR MESSAGE  IS\
    \  RECEIVED  AFTER\n     THE MAXIMUM NUMBER OF RETRANSMISSIONS, THE POLLING GATEWAY\
    \ SHOULD\n     ASSUME THAT THE POLLED GATEWAY IS NOT AN  APPROPRIATE  FIRST  HOP\n\
    \     FOR  ANY  NETWORK  WHATSOEVER.   The  optimum  parameters for the\n    \
    \ polling/retransmission  algorithm  will  be  dependent   on   the\n     characteristics\
    \   of   the  two  neighbors  and  of  the  network\n     connecting them.\n \
    \         If only some fragments of an NR message are  received  after\n     the\
    \  maximum  number  of  retransmissions, the fragments that are\n     present\
    \ shall be treated as constituting  the  whole  of  the  NR\n     message.\n \
    \         Received NR messages whose  identification  numbers  do  not\n     match\
    \  the  identification  number of the most recently sent poll\n     shall be ignored.\
    \  There is no provision for multiple outstanding\n     polls to the same neighbor.\n\
    \     6  SENDING NR MESSAGES\n          In general, NR messages are to be sent\
    \ only in response to a\n     poll.   However,  between  two  successive polls\
    \ from an exterior\n     neighbor, a gateway may send one  and  only  one  unsolicited\
    \  NR\n     message  to  that  neighbor.   This  gives  it limited ability to\n\
    \     quickly announce  network  reachability  changes  that  may  have\n    \
    \ occurred in the interval since the last poll.  Excess unsolicited\n     NR messages\
    \ may be ignored, or an error message may be returned.\n          An NR message\
    \ should be sent within  several  seconds  after\n     receipt  of  a poll.  Failure\
    \ to respond in a timely manner to an\n     NR poll may result in the polling\
    \  gateway's  deciding  that  the\n     polled gateway is not an appropriate first\
    \ hop to any network.\n          NR  messages  sent  in   response   to   polls\
    \   carry   the\n     identification    number   of   the   poll   message   in\
    \   their\n     \"identification number\" fields.  Unsolicited  NR  messages \
    \ carry\n     the identification number of the last poll received, and have the\n\
    \     \"unsolicited\" bit set.  (Note that this allows for only a  single\n  \
    \   unsolicited NR message per polling period.)\n          To facilitate the sending\
    \ of unsolicited NR messages, the NR\n     poll  message  has  a  byte  indicating\
    \  the  polling interval in\n     minutes.\n          Polls from  non-neighbors,\
    \  from  neighbors  which  are  not\n     declared  reachable, or with bad IP\
    \ source network fields, should\n     be responded to with an EGP error message\
    \  with  the  appropriate\n     \"reason\"  field.   If  G  sends  an  NR poll\
    \ to G' with IP source\n     network N, and G' is not a neighbor of  G  on  its\
    \  interface  to\n     network  N  (or G' does not have an interface to network\
    \ N), then\n     the source network field is considered \"bad\".\n          Duplicated\
    \   polls   (successive   polls   with   the   same\n     identification  number)\
    \ should be responded to with duplicates of\n     the same NR message.  If that\
    \ message  is  fragmented,  the  same\n     fragments  shall  be  sent  each \
    \ time.   Note  that  there is no\n     provision for handling multiple outstanding\
    \ polls from  a  single\n     neighbor.   NOTE  THAT  IF  THE  SAME  FRAGMENTS\
    \  ARE NOT SENT IN\n     RESPONSE TO DUPLICATED POLLS, INCORRECT REASSEMBLY  WILL\
    \  BE  THE\n     PROBABLE  RESULT.   If  fragmentation is not being used, however,\n\
    \     then no harm should result from responding to  a  duplicate  poll\n    \
    \ with a different (presumably more recent) NR message.\n     7  INDIRECT NEIGHBORS\n\
    \          Becoming a \"direct neighbor\" of an exterior gateway requires\n  \
    \   three  steps:  (a)  neighbor  acquisition, (b) running a neighbor\n     reachability\
    \ protocol, and (c) polling the neighbor  periodically\n     for NR messages.\
    \  Suppose, however, that gateway G receives an NR\n     message from G', in which\
    \ G'  indicates  the  presence  of  other\n     neighbors  G1, ..., Gn, each of\
    \ which is an appropriate first hop\n     for some set of networks to which G'\
    \ itself is not an appropriate\n     first hop.  Then G should be allowed to forward\
    \ traffic for those\n     networks directly to the appropriate one of G1, ...,\
    \ Gn,  without\n     having to send it to G' first.  In this case, G may be considered\n\
    \     an INDIRECT NEIGHBOR of G1, ..., Gn, since it is  a  neighbor  of\n    \
    \ these  other  gateways for the purpose of forwarding traffic, but\n     does\
    \ not perform neighbor acquisition, neighbor reachability,  or\n     exchange\
    \   of  NR  messages  with  them.   Neighbor  and  network\n     reachability\
    \ information is obtained indirectly via G', hence the\n     designation  \"indirect\
    \  neighbor\".   We say that G is an indirect\n     neighbor of G1, ..., Gn VIA\
    \ G'.\n          If G is an indirect neighbor of  G'  via  G'',  and  then  G\n\
    \     receives  an  NR  message  from  G'' which does not mention G', G\n    \
    \ should treat G' as having become unreachable.\n     8  HOW TO BE A STUB GATEWAY\n\
    \          The most common application of EGP will probably be its  use\n    \
    \ to  enable  a  stub  gateway to communicate with one of the DARPA\n     core\
    \ gateways,  so  as  to  enable  data  flow  between  networks\n     accessible\
    \ only via the stub and networks accessible only via the\n     system of core\
    \ gateways.  As discussed previously, a stub gateway\n     can  be  considered\
    \  to  be a one-gateway internet system with no\n     interior neighbors.  It\
    \ is probably used  to  interface  a  local\n     network  or  networks  to a\
    \ long range transport network (such as\n     ARPANET or SATNET) on which there\
    \ is  a  core  gateway.  In  this\n     case,  the stub will not want the core\
    \ gateways to forward it any\n     traffic other than traffic which is destined\
    \ for the  network  or\n     networks which can be reached only via the stub.\
    \  In general, the\n     stub will not want to  perform  any  services  for  the\
    \  internet\n     transport system which are not needed in order to be able to\
    \ pass\n     traffic to  and  from  the  networks  that  cannot  be  otherwise\n\
    \     reached.\n          The stub should have tables configured in with the addresses\n\
    \     of  a  small  number  of  the  core gateways (no more than two or\n    \
    \ three) with which it has  a  common  network.   It  will  be  the\n     responsibility\
    \  of the stub to initiate neighbor acquisition with\n     these gateways.  When\
    \ a stub and a  core  gateway  become  direct\n     neighbors,  the  core  gateway\
    \ will begin sending Hello messages.\n     When the  stub  declares  the  core\
    \  gateways  which  are  direct\n     neighbors  to  be reachable, it should poll\
    \ those gateways for NR\n     messages at a rate not to exceed once per minute\
    \ (or as specified\n     in the Hello messages from the core gateways).  The core\
    \ gateways\n     will also poll the stub for NR messages.\n          The NR message\
    \ sent by  the  stub  should  be  the  simplest\n     allowable.   That  is, \
    \ it  should have only a single data block,\n     headed by its own address (on\
    \ the network it has in  common  with\n     the neighboring core gateway), listing\
    \ just the networks to which\n     it is an appropriate first hop.  These will\
    \ be just the  networks\n     that can be reached no other way, in general.\n\
    \          The core gateways will send complete NR messages, containing\n    \
    \ information about all other gateways on the common networks, both\n     core\
    \ gateways (which shall be listed as interior  neighbors)  and\n     other  gateways\
    \ (which shall be listed as exterior neighbors, and\n     may include the stub\
    \ itself).  This information will  enable  the\n     stub  to become an indirect\
    \ neighbor of all these other gateways.\n     That is, the stub shall forward\
    \ traffic directly to  these  other\n     gateways  as  appropriate,  but shall\
    \ not become direct neighbors\n     with them.\n          The core gateways will\
    \ report distances less than 128 if the\n     network  can  be  reached  without\
    \ leaving the core system (i.e.,\n     without traversing any gateway other than\
    \ a  core  gateway),  and\n     greater than or equal to 128 otherwise.\n    \
    \      The  stub  should  NEVER  forward  to   any   (directly   or\n     indirectly)\
    \  neighboring  core gateway any traffic for which that\n     gateway is not an\
    \ appropriate first hop, as indicated  in  an  NR\n     message.   Of  course,\
    \ this does not apply to datagrams which are\n     using the source route option;\
    \ any such datagrams  should  always\n     be  forwarded as indicated in the source\
    \ route option field, even\n     if that  requires  forwarding  to  a  gateway\
    \  which  is  not  an\n     appropriate first hop.\n          If the direct neighbors\
    \ of a stub should all fail,  it  will\n     be  the  responsibility  of  the\
    \ stub to acquire at least one new\n     direct neighbor.  It can do  so  by \
    \ choosing  one  of  the  core\n     gateways  which it has had as an indirect\
    \ neighbor, and executing\n     the neighbor acquisition protocol with it.  (It\
    \ is possible  that\n     no  more than one core gateway will ever agree to become\
    \ a direct\n     neighbor with any given stub gateway at any one time.)\n    \
    \      If the stub gateway does not respond in a timely  manner  to\n     Hello\
    \  messages  from  the  core  gateway,  it  may  be  declared\n     unreachable.\
    \  If it does not respond to NR  poll  messages  in  a\n     timely manner, its\
    \ networks may be declared unreachable.  In both\n     these cases, the core gateways\
    \ may discard traffic  destined  for\n     those  networks, returning ICMP \"\
    destination network unreachable\"\n     to the source hosts.\n          The stub\
    \ gateway is  expected  to  fully  execute  the  ICMP\n     protocol,  as  well\
    \  as the EGP protocol.  In particular, it must\n     respond to ICMP echo requests,\
    \ and  must  send  ICMP  destination\n     dead  messages  as appropriate.  It\
    \ is also required to send ICMP\n     Redirect messages as appropriate.\n    \
    \ 9  LIMITATIONS\n          It must be clearly  understood  that  the  Exterior\
    \  Gateway\n     Protocol   does  not  in  itself  constitute  a  network  routing\n\
    \     algorithm.  In addition, it does not provide all the  information\n    \
    \ needed  to  implement  a  general area routing algorithm.  If the\n     topology\
    \ of the set of autonomous systems is not  tree-structured\n     (i.e.,  if it\
    \ has cycles), the Exterior Gateway Protocol does not\n     provide enough topological\
    \ information to prevent loops.\n          If any gateway sends an NR message\
    \ with  false  information,\n     claiming  to be an appropriate first hop to\
    \ a network which it in\n     fact cannot even reach, traffic  destined  to  that\
    \  network  may\n     never be delivered.  Implementers must bear this in mind.\n\
    \                       NEIGHBOR ACQUISITION MESSAGE\n      0                \
    \   1                   2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! EGP Version # !     Type      !     Code      !    Info       !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \      Checksum               !       Autonomous System #     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !       Identification #        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     Description:\n          The Neighbor Acquisition messages are used by interior\
    \ and\n          exterior gateways to become neighbors of each other.\n     EGP\
    \ Version #\n         1\n     Type\n         3\n     Code\n          Code = 0\
    \      Neighbor Acquisition Request\n          Code = 1      Neighbor Acquisition\
    \ Reply\n          Code = 2      Neighbor Acquisition Refusal (see Info field)\n\
    \          Code = 3      Neighbor Cease Message (see Info field)\n          Code\
    \ = 4      Neighbor Cease Acknowledgment\n     Checksum\n         The  EGP checksum\
    \ is the 16-bit one's complement of the one's\n         complement sum of the\
    \  EGP  message  starting  with  the  EGP\n         version  number  field.  \
    \ For  computing  the  checksum,  the\n         checksum field should be zero.\n\
    \     Autonomous System #\n         This   16-bit   number   identifies   the\
    \  autonomous  system\n         containing the gateway which is the source of\
    \ this message.\n     Info\n         For Refusal message, gives reason for refusal:\n\
    \          0  Unspecified\n          1  Out of table space\n          2  Administrative\
    \ prohibition\n         For Cease message, gives reason for ceasing to be neighbor:\n\
    \          0 Unspecified\n          1 Going down\n          2 No longer needed\n\
    \         Otherwise, this field MUST be zero.\n     Identification Number\n  \
    \       An identification number to aid in matching requests and\n         replies.\n\
    \                   NEIGHBOR HELLO/I HEARD YOU MESSAGE\n      0              \
    \     1                   2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! EGP Version # !    Type       !     Code      !    Status     !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \  Checksum                   !    Autonomous System #        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !      Sequence #               !Min Poll Intvl !    Zero       !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \    Last Poll Id #           !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \ Description:\n         Exterior  neighbors  use  EGP  Neighbor Hello and I Heard\
    \ You\n         Messages to determine neighbor connectivity.  When a  gateway\n\
    \         receives  an  EGP  Neighbor  Hello message from a neighbor it\n    \
    \     should respond with an EGP I Heard You message.\n     EGP Version #\n  \
    \       1\n     Type\n         5\n     Code\n          Code = 0 for Hello\n  \
    \        Code = 1 for I Heard you\n     Checksum\n         The  EGP checksum is\
    \ the 16-bit one's complement of the one's\n         complement sum of the  EGP\
    \  message  starting  with  the  EGP\n         version  number  field.   For \
    \ computing  the  checksum,  the\n         checksum field should be zero.\n  \
    \   Autonomous System #\n         This   16-bit   number   identifies   the  autonomous\
    \  system\n         containing the gateway which is the source of this message.\n\
    \     Sequence Number\n         A sequence number to aid in matching requests\
    \ and replies.\n     Status\n          0  No status given\n          1  You appear\
    \ reachable to me\n          2  You appear unreachable to me due to neighbor\n\
    \             reachability protocol\n          3  You appear unreachable to me\
    \ due to network\n             reachability information (such as 1822 \"destination\n\
    \             dead\" messages from ARPANET)\n          4  You appear unreachable\
    \ to me due to problems\n             with my network interface\n     Last Poll\
    \ Id Number\n             The  identification  number of the most recently received\n\
    \             NR poll message from the neighbor to which  this  message\n    \
    \         is being sent.\n     Minimum Polling Interval\n             This  gateway\
    \  should  not be polled for NR messages more\n             often than once in\
    \ this number of minutes.\n                           NR POLL Message\n      0\
    \                   1                   2                   3\n      0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! EGP Version # !    Type       !     Code      !    Unused     !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \  Checksum                   !       Autonomous System #     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !             IP Source Network                 !  Interval     !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \  Identification #           !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \ Description:\n          A  gateway  that  wants  to  receive  an  NR message\
    \ from an\n          Exterior Gateway will send an NR Poll message.  Each gateway\n\
    \          mentioned in the NR message will have an  interface  on  the\n    \
    \      network that is in the IP source network field.\n     EGP Version #\n \
    \        1\n     Type\n         2\n     Code\n         0\n     Checksum\n    \
    \      The EGP checksum is the 16-bit one's complement of the one's\n        \
    \  complement  sum  of  the  EGP  message starting with the EGP\n          version\
    \ number  field.   For  computing  the  checksum,  the\n          checksum field\
    \ should be zero.\n     Autonomous System #\n         This   16-bit   number \
    \  identifies   the  autonomous  system\n         containing the gateway which\
    \ is the source of this message.\n     Identification Number\n          An  identification\
    \  number  to  aid in matching requests and\n          replies.\n     IP Source\
    \ Network\n          Each  gateway  mentioned  in  the  NR  message  will have\
    \ an\n          interface on the network that is in the  IP  source  network\n\
    \          field.   The  IP  source  network  is  coded  as one byte of\n    \
    \      network number followed by two bytes of  zero  for  class  A\n        \
    \  networks,  two  bytes of network number followed by one byte\n          of\
    \ zero for class B networks, and  three  bytes  of  network\n          number\
    \ for class C networks.\n     Interval\n          The polling interval in minutes.\n\
    \                         NETWORK REACHABILITY MESSAGE\n      0              \
    \     1                   2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! EGP Version # !     Type      !   Code        !U! Zeroes      !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \  Checksum                   !       Autonomous System #     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !  Fragment #   !# of last frg. !       Identification #        !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \                    IP Source Network                        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! # of Int Gwys ! # of Ext Gwys !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !  # of Nets    !                                 ; # of nets for\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   Gateway 1\n     ! Gateway\
    \ 1 IP address (without network #)      ! ; 1, 2 or 3 bytes\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !   net 1,1     !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ; 1, 2 or 3 bytes\n  \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     ! distance      !\n\
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !   net 1,2    \
    \ !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ; 1, 2 or 3 bytes\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! distance      !\n     +-+-+-+-+-+-+-+-+\n                  .\n       \
    \           .\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !\
    \   net 1,m     !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  ; m nets reachable\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \  ; via Gateway 1\n                  .\n                  .\n     +-+-+-+-+-+-+-+-+\n\
    \     !  # of nets    !       ;number of nets for Gateway n\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !             Gateway  n IP address (without network #)         !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \ net n,1     !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  ; 1, 2 or 3 bytes\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! distance      !\n     +-+-+-+-+-+-+-+-+\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !   net n,2     !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  ; 1, 2 or 3 bytes\n \
    \    +-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \ ! distance      !    .\n     +-+-+-+-+-+-+-+-+    .\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     !   net n,m     !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  ; m nets reachable\n\
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+  ; via Gateway n\n   \
    \  ! distance      !\n     +-+-+-+-+-+-+-+-+\n     Description:\n          The\
    \  Network  Reachability  message (NR) is used to discover\n     which networks\
    \ may be reached through Exterior Gateways.  The  NR\n     message is sent in\
    \ response to an NR Poll message.\n     EGP Version #\n         1\n     Type\n\
    \         1\n     Code\n         0\n     Checksum\n         The  EGP checksum\
    \ is the 16-bit one's complement of the one's\n         complement sum of the\
    \  EGP  message  starting  with  the  EGP\n         version  number  field.  \
    \ For  computing  the  checksum,  the\n         checksum field should be zero.\n\
    \     Autonomous System #\n         This   16-bit   number   identifies   the\
    \  autonomous  system\n         containing the gateway which is the source of\
    \ this message.\n     U (Unsolicited) bit\n         This bit is set if the NR\
    \ message is being sent unsolicited.\n     Identification Number\n         The\
    \  identification  number  of  the  last  NR  poll  message\n         received\
    \ from the neighbor to whom this NR message  is  being\n         sent.   This\
    \  number  is  used  to  aid in matching polls and\n         replies.\n     Fragment\
    \ Number\n          Which  Fragment  this  is  in  the  NR  Message.   Zero, \
    \ if\n          fragmentation is not used.\n     Number of Last Fragment\n   \
    \       Number  of  the  last  fragment in the NR Message.  Zero, if\n       \
    \   fragmentation is not used.\n     IP Source Network\n          Each  gateway\
    \  mentioned  in  the  NR  message  will have an\n          interface on the network\
    \ that is in the  IP  source  network\n          field.\n     # of Interior Gateways\n\
    \          The  number  of interior gateways that are mentioned in this\n    \
    \      message.\n     # of Exterior Gateways\n          The  number  of exterior\
    \ gateways that are mentioned in this\n          message.\n     # of Networks\n\
    \          The  number  of  networks  for  which  the  gateway whose IP\n    \
    \      address immediately follows is the appropriate first hop.\n     Gateway\
    \ IP address\n          1, 2 or 3 bytes of Gateway IP address (without network\
    \ #).\n     Network address\n          1, 2,  or 3 bytes of network address of\
    \ network which can be\n          reached via the preceding gateway.\n     Distance\n\
    \         1 byte of distance in # of hops.\n                              EGP\
    \ ERROR MESSAGE\n      0                   1                   2             \
    \      3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! EGP Version # !    Type       !     Code      !    Unused     !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \  Checksum                   !       Autonomous System #     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     ! Error Type    !  Error Code   !    Id. # of Erroneous Msg.    !\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     !  \
    \     Sequence #              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \ Description:\n         An  EGP  Error  Message is sent in response to an EGP\
    \ Message\n         that has a bad checksum or has an incorrect value in  one\
    \  of\n         its fields.\n     EGP Version #\n         1\n     Type\n     \
    \    8\n     Code\n         0\n     Checksum\n          The EGP checksum is the\
    \ 16-bit one's complement of the one's\n          complement  sum  of  the  EGP\
    \  message starting with the EGP\n          version number  field.   For  computing\
    \  the  checksum,  the\n          checksum field should be zero.\n     Autonomous\
    \ System #\n         This   16-bit   number   identifies   the  autonomous  system\n\
    \         containing the gateway which is the source of this message.\n     Sequence\
    \ Number\n          A  sequence number assigned by the gateway sending the error\n\
    \          message.\n     Error Type\n          The Type of the EGP message that\
    \ was in error.\n     Error Code\n          The Code of the EGP message that was\
    \ in error.\n     Identification number of erroneous message\n          The Sequence\
    \ number of the EGP message that was in error.\n     Reason\n          The reason\
    \ that the EGP message was in error.  The following reasons\n          are defined:\n\
    \          0  -  unspecified\n          1  -  Bad EGP checksum\n          2  -\
    \  Bad IP Source address in NR Poll or Response\n          3  -  Undefined EGP\
    \ Type or Code\n          4  -  Received poll from non-neighbor\n          5 \
    \ -  Received excess unsolicted NR message\n          6  -  Received excess poll\n\
    \          7  -  Erroneous counts in received NR message\n          8  -  No response\
    \ received to NR poll\n          9  -  Not all fragments of NR message received\n"
