- title: __initial_text__
  contents:
  - " Media Gateway Control Protocol (MGCP) Voiceband Data (VBD) Package and\n   \
    \        General-Purpose Media Descriptor Parameter Package\n"
- title: Abstract
  contents:
  - "Abstract\n   This document defines Media Gateway Control Protocol (MGCP) packages\n\
    \   that enable a Call Agent to authorize and monitor the transition of a\n  \
    \ connection to and from Voiceband Data (VBD) with or without\n   redundancy and\
    \ FEC (forward error correction).  Although the focus is\n   on VBD, the General-Purpose\
    \ Media Descriptor Parameter package can be\n   used to authorize other modes\
    \ of operation, not relevant to VBD, for\n   a particular codec.  In addition\
    \ to defining these new packages, this\n   document describes the use of the Media\
    \ Format Parameter package and\n   Fax package with VBD, redundancy, and FEC.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6498.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Applicability Statement .........................................3\n\
    \   2. Introduction ....................................................3\n  \
    \ 3. Terminology .....................................................5\n   4.\
    \ Voiceband Data Package Definition ...............................5\n      4.1.\
    \ Events and Signals .........................................5\n           4.1.1.\
    \ Gateway Controlled Voiceband Data ...................6\n           4.1.2. No\
    \ Negotiated Procedure for Voiceband Data .........13\n   5. General-Purpose Media\
    \ Descriptor Parameter Package Definition ..16\n      5.1. LocalConnectionOptions\
    \ ....................................16\n           5.1.1. General-Purpose Media\
    \ Descriptor Parameter .........17\n   6. Use of Media Format Parameter Package\
    \ with VBD and Redundancy ..20\n   7. Use of Media Format Parameter Package with\
    \ VBD and FEC .........22\n   8. Use of Fax Package with VBD ....................................23\n\
    \   9. Call Flow Examples .............................................27\n  \
    \    9.1. Modem Call with Gateway Controlled VBD ....................27\n    \
    \  9.2. Fax Call with Gateway Controlled VBD and Call\n           Agent Controlled\
    \ T.38 .....................................33\n   10. Security Considerations\
    \ .......................................42\n   11. IANA Considerations ...........................................44\n\
    \   12. Acknowledgements ..............................................44\n  \
    \ 13. References ....................................................44\n    \
    \  13.1. Normative References .....................................44\n      13.2.\
    \ Informative References ...................................46\n"
- title: 1.  Applicability Statement
  contents:
  - "1.  Applicability Statement\n   This document defines a mechanism that requires\
    \ media stream\n   integrity protection.  The document specifies different alternative\n\
    \   mechanisms but does not choose one of them as mandatory-to-implement.\n  \
    \ Consequently, the use of this specification is only suitable in\n   environments\
    \ that specify and use at least one of these alternative\n   mechanisms.  Please\
    \ see the Security Considerations section for\n   further details.\n"
- title: 2.  Introduction
  contents:
  - "2.  Introduction\n   The term Voiceband Data (or simply VBD) refers to the use\
    \ of a\n   suitable voiceband codec (commonly G.711u or G.711a) for the\n   transport\
    \ of data payloads using RTP as defined in RFC 3550\n   [RFC3550].  This document\
    \ defines Media Gateway Control Protocol\n   (MGCP) [RFC3435] packages that enable\
    \ a Call Agent to authorize and\n   monitor the transition of a connection to\
    \ and from VBD with or\n   without redundancy [RFC2198] and FEC (forward error\
    \ correction)\n   [RFC5109].\n   There are a number of different VBD procedures.\
    \  These procedures\n   vary in terms of how the transition to and from VBD is\
    \ coordinated\n   end to end.  Some coordination techniques are mutually negotiated\
    \ by\n   the two gateways using the Session Description Protocol (SDP)\n   [RFC4566].\
    \  These coordination techniques include\n   o  ITU-T Recommendation V.150.1 State\
    \ Signaling Event (SSE) [V1501]\n   o  ITU-T Recommendation V.152 Payload Type\
    \ Switching [V152]\n   Other coordination techniques are not negotiated.  For\
    \ example, the\n   detection of fax, modem, and text tones in the direction from\
    \ the IP\n   to the General Switched Telephone Network (GSTN) may result in a\n\
    \   switch to VBD or a change (e.g., disable echo cancellation) to the\n   gateway\
    \ controlled VBD procedure already in place.  The IP-side\n   detected tone serves\
    \ as both a VBD stimulus and a coordination\n   technique.\n   RFC 4733 [RFC4733]\
    \ and RFC 4734 [RFC4734] can be used to convey fax\n   and modem events and tones.\
    \  As with IP-side tone detection, the\n   telephone event may serve as both a\
    \ VBD stimulus and a coordination\n   technique.  Note that while the use of RFC\
    \ 4733 and RFC 4734 to\n   convey fax and modem events and tones is negotiated,\
    \ the use of\n   RFC 4733 and RFC 4734 as a gateway VBD coordination technique\
    \ (at\n   present) is not.\n   The Voiceband Data (VBD) package is defined to\
    \ support all VBD\n   procedures.  This document does not address the relative\
    \ merits of\n   different procedures nor does it advocate one procedure over another.\n\
    \   We will use the term VBD to refer to Voiceband Data in general.  In\n   referring\
    \ to VBD in the context of the package, we will use the term\n   VBD package.\
    \  We use the term \"audio\" (with double quotes) to refer\n   to the IANA media\
    \ type.  We use the term audio (without double\n   quotes) to refer to the use\
    \ of the \"audio\" media type for (most\n   commonly) voice.\n   A package is\
    \ defined for the General-Purpose Media Descriptor\n   Parameter [V152].  In the\
    \ context of VBD, the General-Purpose Media\n   Descriptor Parameter (GPMD) package\
    \ is used to authorize the\n   negotiation of a particular codec for use with\
    \ VBD.  The General-\n   Purpose Media Descriptor Parameter is \"general\" in\
    \ nature and may be\n   used in applications other than VBD.\n   The Media Format\
    \ Parameter (FM) package [RFC3660] describes the use\n   of the standard audio\
    \ MIME subtype \"RED\" in conjunction with the\n   \"fmtp\" LocalConnectionOption\
    \ in order to authorize the negotiation of\n   redundancy [RFC2198], to identify\
    \ the levels of redundancy and the\n   media format associated with each redundancy\
    \ level.  This document\n   will further explore the use of the FM package with\
    \ VBD and\n   redundancy.\n   The VBD package is intended to complement the MGCP\
    \ Fax (FXR) package\n   [RFC5347].  This document will explore the use of the\
    \ FXR package\n   with VBD.\n   The VBD package definition is provided in Section\
    \ 4.  The GPMD\n   package definition is provided in Section 5.  In Section 6,\
    \ we\n   discuss the use of the FM package with VBD and redundancy.  In\n   Section\
    \ 7, we discuss the use of the FM package with VBD and FEC.  In\n   Section 8,\
    \ we discuss the use of the FXR package with VBD.  In\n   Section 9, we provide\
    \ two call flow examples showing how to use the\n   VBD and GPMD packages.  Security\
    \ considerations are found in\n   Section 10, followed by the IANA considerations\
    \ (Section 11) and\n   references.\n"
- title: 3.  Terminology
  contents:
  - "3.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [RFC2119].\n"
- title: 4.  Voiceband Data Package Definition
  contents:
  - "4.  Voiceband Data Package Definition\n   This package is defined for Voiceband\
    \ Data (VBD).  The package\n   defines new events as detailed below.\n      Package\
    \ Name:        VBD\n      Package Version:     0\n"
- title: 4.1.  Events and Signals
  contents:
  - "4.1.  Events and Signals\n   The following events are defined in support of the\
    \ above:\n    -------------------------------------------------------------------\n\
    \   | Symbol |   Definition                    |  R  |  S  |  Duration  |\n  \
    \ |--------|---------------------------------|-----|-----|------------|\n   |\
    \ gwvbd  | Gateway Controlled VBD          |  x  |     |            |\n   | nopvbd\
    \ | No Negotiated Procedure for VBD |  x  |     |            |\n    -------------------------------------------------------------------\n\
    \   This is standard MGCP package format as defined in Section 6.6 of\n   RFC\
    \ 3435 [RFC3435].  The definitions of the individual events are\n   provided in\
    \ the following subsections.\n"
- title: 4.1.1.  Gateway Controlled Voiceband Data
  contents:
  - "4.1.1.  Gateway Controlled Voiceband Data\n   The gwvbd procedure can be used\
    \ by the gateway to control and decide\n   how to handle VBD calls without Call\
    \ Agent involvement.  The \"Gateway\n   Controlled Voiceband Data\" (or simply\
    \ \"gwvbd\") event occurs when a\n   gwvbd procedure has been negotiated and VBD\
    \ stimulus is detected.\n   The \"gwvbd\" event may occur when the gwvbd procedure\
    \ is updated\n   (e.g., upon detecting new stimulus) and when the procedure fails.\n\
    \   The \"gwvbd\" event occurs when the gwvbd procedure ends.  The gwvbd\n   procedure\
    \ MUST be negotiated with the other side by passing and\n   recognizing relevant\
    \ parameters via the LocalConnectionDescriptor and\n   RemoteConnectionDescriptor.\n\
    \   The following recommendations from MGCP [RFC3435] apply.\n   In this section,\
    \ we provide a formal description of the protocol\n   syntax, using ABNF as defined\
    \ in \"Augmented BNF for Syntax\n   Specifications: ABNF\" [RFC5234].  The syntax\
    \ makes use of the core\n   rules defined in Appendix B.1 of [RFC5234], which\
    \ are not included\n   here.  Furthermore, the syntax follows the case-sensitivity\
    \ rules of\n   [RFC5234], i.e., MGCP is case-insensitive (but SDP is not).  It\n\
    \   should be noted that ABNF does not provide for implicit specification\n  \
    \ of linear white space, and MGCP messages MUST thus follow the\n   explicit linear\
    \ white space rules provided in the grammar below.\n   However, in line with general\
    \ robustness principles, implementers are\n   strongly encouraged to tolerate\
    \ additional linear white space in\n   messages received.\n   The RequestedEvent\
    \ parameter is encoded as\n      GwVbdReqEvent = \"gwvbd\"\n   The ObservedEvent\
    \ parameter is encoded as\n      GwVbdObsEvent = GwVbdObsEventStart / GwVbdObsEventUpdate\
    \ /\n                      GwVbdObsEventStop / GwVbdObsEventFailure\n      GwVbdObsEventStart\
    \   = \"gwvbd(start\" Rc [Codec] [Coord] [Dir] \")\"\n      GwVbdObsEventUpdate\
    \  = \"gwvbd(update\" Rc [Codec] [Dir] \")\"\n      GwVbdObsEventStop    = \"\
    gwvbd(stop\" [Rc] [Codec] \")\"\n      GwVbdObsEventFailure = \"gwvbd(failure\"\
    \ [Rc] [Codec] \")\"\n      Codec = \",\" *WSP \"codec=\" CodecString\n      CodecString\
    \ = (ALPHA / DIGIT) *(ALPHA / DIGIT / \"-\" / \"_\" /\n                     \"\
    .\" / \"/\")\n      Coord = \",\" *WSP \"coord=\" CoordinationTechnique\n    \
    \  CoordinationTechnique = \"v152ptsw\" / \"v150fw\"\n      Rc = \",\" *WSP \"\
    rc=\" ReasonCode\n      ReasonCode = 1*(ALPHA / DIGIT / \"-\" / \"_\" / \".\"\
    \ / \"/\")\n                   ; Refer to the values listed in the tables below.\n\
    \      Dir = \",\" *WSP \"dir=\" Direction\n      Direction = \"GstnToIp\" / \"\
    IpToGstn\"\n   ABNF does not provide for position-independent parameters.  The\
    \ \"rc\",\n   \"codec\", \"coord\", and \"dir\" parameters, if present, MUST appear\
    \ in\n   the relative order shown.\n   The \"start\", \"update\", \"stop\", and\
    \ \"failure\" ObservedEvent parameters\n   are defined as follows:\n   1) VBD\
    \ Start (start)\n      The gwvbd procedure was initiated.  The Call Agent SHOULD\
    \ refrain\n      from issuing media handling instructions to the gateway until\n\
    \      either a \"gwvbd(stop)\" or \"gwvbd(failure)\" event is generated.\n  \
    \    One and only one \"gwvbd(stop)\" or \"gwvbd(failure)\" event is\n      generated\
    \ corresponding to each \"gwvbd(start)\" event.\n   2) VBD Update (update)\n \
    \     The gwvbd procedure was updated.  The \"gwvbd(update)\" event MUST\n   \
    \   only be generated after a \"gwvbd(start)\" event and before a\n      \"gwvbd(stop)\"\
    \ or \"gwvbd(failure)\" event.\n   3) VBD Stop (stop)\n      The gwvbd procedure\
    \ ended, and the gateway did not detect any\n      errors.  Note that this does\
    \ not necessarily imply a successful\n      fax, modem, or text transmission.\
    \  It merely indicates that the\n      gwvbd procedure has ended and the procedure\
    \ itself did not\n      encounter any errors.  The \"stop\" parameter may correspond\
    \ to a\n      change from VBD to a non-VBD \"audio\" codec or from VBD to another\n\
    \      media type such as \"image\" or \"text\".  This change may be under\n \
    \     Call Agent or gateway control.  For example, the gateway may\n      coordinate\
    \ the switch from VBD to \"image/t38\" through the exchange\n      of SSEs [T38]\
    \ [V152].  For an example involving Call Agent\n      control, refer to the \"\
    MC\" Reason Code.  In both examples, the\n      gwvbd procedure ends with the\
    \ media change.\n   4) VBD Failure (failure)\n      The gwvbd procedure ended\
    \ abnormally.  Some kind of problem was\n      encountered in the gwvbd procedure,\
    \ and the procedure ended.\n   When the \"gwvbd\" event is reported, exactly one\
    \ of the \"start\",\n   \"update\", \"stop\", or \"failure\" parameters MUST be\
    \ present and MUST be\n   the first parameter supplied.\n   The \"rc\", \"codec\"\
    , \"coord\", and \"dir\" ObservedEvent parameters are\n   defined as follows:\n\
    \   1) Reason Code (rc=<ReasonCode>)\n      With the \"start\" and \"update\"\
    \ parameters, the reason for\n      triggering the switch/change to VBD.  With\
    \ the \"stop\" and\n      \"failure\" parameters, the reason for triggering the\
    \ switch from\n      VBD.  The Reason Codes in the following table, which are\
    \ based on\n      the ITU-T Fax/Textphone/Modem Tones Detection package [H2482],\n\
    \      ITU-T V.150.1 Amendment 1 [V1501A1], and ITU-T V.152 [V152], may\n    \
    \  be used with the \"start\" and \"update\" parameters:\n       ---------------------------------------------------------------\n\
    \      | ReasonCode | Description                                      |\n   \
    \   |------------|--------------------------------------------------|\n      |\
    \ CNG        | T.30 fax calling                                 |\n      | V21flag\
    \    | V.21 tone and flags for fax answering            |\n      | CIV18     \
    \ | V.8 CI with V.18 call function                   |\n      | XCI        | V.18\
    \ XCI                                         |\n      | V18txp     | V.18 txp\
    \                                         |\n      | Belltone   | Bell 103 carrier,\
    \ high- or low-frequency channel |\n      |            |   (ITU-T Recommendation\
    \ V.18)                    |\n      | Baudot     | Baudot initial tone and character\
    \ (ITU-T         |\n      |            |   Recommendation V.18)              \
    \             |\n      | Edt        | EDT initial tone and character (ITU-T  \
    \          |\n      |            |   Recommendation V.18)                    \
    \       |\n      | CIdata     | V.8 CI with any data call function           \
    \    |\n      | CT         | V.25 calling tone                               \
    \ |\n      | CIfax      | V.8 CI with fax call function                    |\n\
    \      | V21tone    | V.21 carrier, high- or low-frequency channel     |\n   \
    \   | V23tone    | V.23 carrier, high- or low-frequency channel     |\n      |\
    \ V8bis      | V.8 bis modem handshaking signal                 |\n      | ANS\
    \        | V.25 ANS, equivalent to T.30 CED from answering  |\n      |       \
    \     |   terminal                                       |\n      | /ANS     \
    \  | V.25 ANS with periodic phase reversals           |\n      | ANSam      |\
    \ V.8 ANSam                                        |\n      | /ANSam     | V.8\
    \ ANSam with periodic phase reversals          |\n      | CMFax      | V.8 CM\
    \ sequence indicating fax call function     |\n      | JMFax      | V.8 JM sequence\
    \ indicating fax call function     |\n      | CMData     | V.8 CM sequence indicating\
    \ unspecified data      |\n      |            |   call function              \
    \                    |\n      | JMData     | V.8 JM sequence indicating unspecified\
    \ data      |\n      |            |   call function                          \
    \        |\n      | CMText     | V.8 CM sequence indicating text call function\
    \    |\n      | JMText     | V.8 JM sequence indicating text call function   \
    \ |\n      | PTSW       | Payload type switch as defined in V.152          |\n\
    \       ---------------------------------------------------------------\n    \
    \  For solutions involving textphones using a modulation with\n      interspersed\
    \ text and speech on the same \"channel\", such as Baudot\n      and EDT, the\
    \ Call Agent SHOULD interpret the ReasonCode parameter\n      as part of the \"\
    vbd/gwvbd(start)\" event in order to differentiate\n      between fax, modem,\
    \ and text.  In the case of interspersed text\n      and speech, the Call Agent\
    \ SHOULD remove the notification request\n      for \"vbd/gwvbd\" upon receiving\
    \ the \"vbd/gwvbd(start)\" event in\n      order to avoid large numbers of notifications.\n\
    \      For example,\n         vbd/gwvbd(start, rc=Baudot)\n      With a ReasonCode\
    \ of \"PTSW\", the Call Agent cannot differentiate\n      text from fax/modem.\
    \  In this case, the Call Agent SHOULD adopt a\n      policy that guards against\
    \ large numbers of notifications.  We\n      consider several such policies.\n\
    \      The Call Agent MAY remove the notification request for \"vbd/gwvbd\"\n\
    \      upon receiving the \"vbd/gwvbd(start, rc=PTSW)\" event.  With this\n  \
    \    policy, \"update\", \"stop\", and \"failure\" notifications will not be\n\
    \      generated with text AND fax/modem.\n      The Call Agent MAY wait for a\
    \ subsequent \"vbd/gwvbd(update)\" event\n      that differentiates text from\
    \ fax/modem.  If the ReasonCode\n      indicates interspersed text and speech,\
    \ the Call Agent SHOULD\n      remove the notification request for \"vbd/gwvbd\"\
    .  For example,\n         vbd/gwvbd(update, rc=Edt)\n      The Call Agent MAY\
    \ remove the notification request for \"vbd/gwvbd\"\n      upon receiving a \"\
    vbd/gwvbd(stop)\" event without having\n      differentiated between text and\
    \ fax/modem.\n      The Call Agent MAY remove the notification request for \"\
    vbd/gwvbd\"\n      after having received a number of \"vbd/gwvbd(start)\" events\n\
    \      without having differentiated between text and fax/modem.  The\n      specific\
    \ number of events after which the notification request is\n      removed is considered\
    \ an implementation detail outside the scope\n      of this specification.\n \
    \     Reason Codes applicable with the \"stop\" parameter are listed\n      below:\n\
    \             ------------------------------------------------------\n       \
    \     | ReasonCode | Description                             |\n            |------------|-----------------------------------------|\n\
    \            | SIL        | Bidirectional silence                   |\n      \
    \      | Voice      | Voice signals                           |\n            |\
    \ PTSW       | Payload type switch as defined in V.152 |\n            | MC   \
    \      | Media change                            |\n             ------------------------------------------------------\n\
    \      The \"MC\" Reason Code indicates that the media type has changed\n    \
    \  from \"audio\" (to \"image\", \"text\", ...) or the \"audio\" media format\n\
    \      has changed from a VBD codec (for a reason other than \"PTSW\").\n    \
    \  For example, the gwvbd procedure may be initiated upon detecting\n      called\
    \ terminal identification (CED).  Subsequently, the Call\n      Agent controlled\
    \ T.38 procedure of the MGCP Fax (FXR) package\n      [RFC5347] may be initiated\
    \ upon detecting V.21 flags.  Upon\n      receipt of a \"t38(start)\" event, the\
    \ Call Agent will instruct the\n      gateway to switch from VBD to T.38 through\
    \ the use of a\n      ModifyConnection command involving a LocalConnectionOption\n\
    \      encoding method of \"L:a:image/t38\" and/or a\n      RemoteConnectionDescriptor\
    \ with an \"image/t38\" media description.\n      This stops the gwvbd procedure.\
    \  There is no specific\n      interdependency between the VBD package and the\
    \ FXR package (or\n      any other package).  The gwvbd procedure is stopped as\
    \ a\n      consequence of the media change, not as a direct consequence of\n \
    \     the T.38 procedure being initiated.  Note that in this situation\n     \
    \ the \"t38(start)\" event will be sent before the \"gwvbd(stop)\"\n      event.\
    \  The Call Agent MAY choose to infer that the gwvbd\n      procedure has ended\
    \ upon receiving the \"t38(start)\" event and\n      disable the notification\
    \ of the \"gwvbd\" event.  Refer to the\n      example call flow in Section 9.2.\n\
    \      Reason Codes applicable with the \"failure\" parameter:\n             ----------------------------------------------------\n\
    \            | ReasonCode | Description                           |\n        \
    \    |------------|---------------------------------------|\n            | TO\
    \         | Indicates that a timeout has occurred |\n             ----------------------------------------------------\n\
    \      The list of Reason Codes may be extended to include values with\n     \
    \ meaning mutually understood between the gateway and the Call\n      Agent. \
    \ Obviously, the use of extended values MUST be a\n      provisionable option\
    \ on the gateway in order to ensure\n      interoperability with the Call Agent.\n\
    \   2) Codec String (codec=<CodecString>)\n      With the \"start\" and \"update\"\
    \ parameters, the codec parameter\n      describes the MIME type associated with\
    \ the switch/change to VBD\n      (e.g., \"audio/RED\", \"audio/PCMU\", \"audio/PCMA\"\
    , \"audio/G726-32\",\n      \"audio/clearmode\", ...).  With the \"stop\" and\
    \ \"failure\"\n      parameters, the codec parameter describes the MIME type associated\n\
    \      with the switch from VBD (e.g., \"audio/G729\", \"image/t38\", \"text/\n\
    \      t140\", \"audio/v150mr\", ...).  These strings should be full MIME\n  \
    \    types as listed in http://www.iana.org/assignments/media-types.\n   3) Coordination\
    \ Technique (coord=<CoordinationTechnique>)\n      The technique used to coordinate\
    \ the transition to and from VBD\n      with the remote endpoint.  The coordination\
    \ techniques are\n      summarized in the following table:\n           ------------------------------------------------------\n\
    \          | CoordinationTechnique | Description                  |\n        \
    \  |-----------------------|------------------------------|\n          | v152ptsw\
    \              | V.152 Payload Type Switching |\n          | v150fw          \
    \      | V.150.1 SSE                  |\n           ------------------------------------------------------\n\
    \      With the \"v152ptsw\" coordination technique, payload type switching\n\
    \      [V152] is used to coordinate the transition to and from VBD.\n      With\
    \ the \"v150fw\" coordination technique, state signaling events\n      [V1501]\
    \ are used to coordinate the transition to and from VBD.\n      The list of coordination\
    \ techniques may be extended to include\n      values with meaning mutually understood\
    \ between the gateway and\n      the Call Agent.  Obviously, the use of extended\
    \ values MUST be a\n      provisionable option on the gateway in order to ensure\n\
    \      interoperability with the Call Agent.\n   4) Direction of Stimulus (dir=<Direction>)\n\
    \      With the \"start\" and \"update\" parameters, the \"dir\" parameter\n \
    \     describes the direction of the stimulus that resulted in the\n      switch/change\
    \ to VBD.\n            ---------------------------------------------------\n \
    \          | Direction | Description                            |\n          \
    \ |-----------|------------------------------------    |\n           | GstnToIp\
    \  | Stimulus detected in the direction     |\n           |           | from the\
    \ GSTN to IP network,           |\n           |           | including fax, modem,\
    \ and text tones.  |\n           | IpToGstn  | Stimulus detected in the direction\
    \     |\n           |           | from the IP to GSTN network,           |\n \
    \          |           | including fax, modem, and text tones   |\n          \
    \ |           | (e.g., IP-side tone detection);        |\n           |       \
    \    | RTP packet with VBD payload type       |\n           |           | (e.g.,\
    \ V.152 or V.150.1).              |\n            ----------------------------------------------------\n\
    \   Call Agents and gateways MUST implement the \"start\" and \"stop\"\n   parameters\
    \ and MAY implement the \"update\" and \"failure\" parameters.\n   Call Agents\
    \ and gateways MAY implement the \"coord\", \"codec\", and\n   \"dir\" parameters.\
    \  Call Agents MAY, and gateways MUST, implement the\n   \"rc\" parameter in conjunction\
    \ with the \"start\" and \"update\"\n   parameters.  Call Agents and gateways\
    \ MAY implement the \"rc\"\n   parameter in conjunction with the \"stop\" and\
    \ \"failure\" parameters.  A\n   Call Agent MUST ignore all unknown ObservedEvent\
    \ parameters,\n   including parameters that are defined as part of this specification\n\
    \   and not implemented.\n"
- title: 4.1.1.1.  Gateway Controlled Voiceband Data Examples
  contents:
  - "4.1.1.1.  Gateway Controlled Voiceband Data Examples\n   The following examples\
    \ illustrate the encoding of the \"gwvbd(start)\"\n   event:\n           O: vbd/gwvbd(start,\
    \ rc=ANS)\n           O: vbd/gwvbd(start, rc=ANS, codec=audio/PCMU, coord=v152ptsw)\n\
    \           O: vbd/gwvbd(start, rc=PTSW, codec=audio/RED)\n   The following example\
    \ illustrates the encoding of the \"gwvbd(update)\"\n   event:\n           O:\
    \ vbd/gwvbd(update, rc=/ANSam, dir=IpToGstn)\n   The following examples illustrate\
    \ the encoding of the \"gwvbd(stop)\"\n   event:\n           O: vbd/gwvbd(stop)\n\
    \           O: vbd/gwvbd(stop, rc=SIL, codec=audio/G729)\n           O: vbd/gwvbd(stop,\
    \ rc=MC, codec=image/t38)\n   The following examples illustrate the encoding of\
    \ the\n   \"gwvbd(failure)\" event:\n           O: vbd/gwvbd(failure, codec=audio/G729)\n\
    \           O: vbd/gwvbd(failure, rc=TO, codec=audio/G729)\n"
- title: 4.1.2.  No Negotiated Procedure for Voiceband Data
  contents:
  - "4.1.2.  No Negotiated Procedure for Voiceband Data\n   The \"No Negotiated Procedure\
    \ for Voiceband Data\" (or simply \"nopvbd\")\n   event occurs when a VBD procedure\
    \ has not been negotiated and VBD\n   stimulus is detected.  The \"nopvbd\" event\
    \ may occur when the\n   procedure is updated (e.g., upon detecting new stimulus),\
    \ when the\n   procedure ends, and when the procedure fails.  Even though a\n\
    \   procedure was not negotiated, a VBD handling procedure MAY still be\n   in\
    \ place locally on the endpoint, as described further below.\n   The nopvbd procedure\
    \ MAY involve VBD handling including, but not\n   limited to, adjusting gain and\
    \ jitter, disabling voice activity\n   detection, and DC offset filters.  The\
    \ nopvbd procedure MAY involve\n   switching to another codec.  The Call Agent\
    \ MAY have to issue further\n   commands in response to the \"nopvbd\" event in\
    \ order to ensure a\n   successful VBD call.\n   As with the \"gwvbd\" event,\
    \ the same recommendations from MGCP\n   [RFC3435] regarding ABNF, general robustness\
    \ principles, and white\n   space apply.\n      The RequestedEvent parameter is\
    \ encoded as\n        NopVbdReqEvent = \"nopvbd\"\n      The ObservedEvent parameter\
    \ is encoded as\n        NopVbdObsEvent = NopVbdObsEventStart / NopVbdObsEventUpdate\
    \ /\n                         NopVbdObsEventStop / NopVbdObsEventFailure\n   \
    \     NopVbdObsEventStart   = \"nopvbd(start\" Rc [Codec] [Dir] \")\"\n      \
    \  NopVbdObsEventUpdate  = \"nopvbd(update\" Rc [Codec] [Dir] \")\"\n        NopVbdObsEventStop\
    \    = \"nopvbd(stop\" [Rc] [Codec] \")\"\n        NopVbdObsEventFailure = \"\
    nopvbd(failure\" [Rc] [Codec] \")\"\n   The following ABNF notation is common\
    \ with the \"gwvbd\" ObservedEvent\n   parameter:\n     Codec = \",\" *WSP \"\
    codec=\" CodecString\n     CodecString = (ALPHA / DIGIT) *(ALPHA / DIGIT / \"\
    -\" / \"_\" /\n                    \".\" / \"/\")\n     Rc = \",\" *WSP \"rc=\"\
    \ ReasonCode\n     ReasonCode = 1*(ALPHA / DIGIT / \"-\" / \"_\" / \".\" / \"\
    /\")\n                  ; Refer to the values listed in the tables above.\n  \
    \   Dir = \",\" *WSP \"dir=\" Direction\n     Direction = \"GstnToIp\" / \"IpToGstn\"\
    \n   ABNF does not provide for position-independent parameters.  The \"rc\",\n\
    \   \"codec\", and \"dir\" parameters, if present, MUST appear in the\n   relative\
    \ order shown.\n   The \"start\", \"update\", \"stop\", and \"failure\" ObservedEvent\
    \ parameters\n   are defined as follows:\n   1) VBD Start(start)\n      The nopvbd\
    \ procedure was initiated.  The Call Agent may have to\n      issue further commands\
    \ in order to ensure a successful VBD call\n      (e.g., switch to another codec).\
    \  At most one \"nopvbd(stop)\" or\n      \"nopvbd(failure)\" event MAY be generated\
    \ corresponding to each\n      \"nopvbd(start)\" event.  The Call Agent MAY need\
    \ to infer that the\n      nopvbd procedure has ended.\n   2) VBD Update (update)\n\
    \      The nopvbd procedure was updated.  The \"nopvbd(update)\" event MUST\n\
    \      only be generated after a \"nopvbd(start)\" event and before a\n      \"\
    nopvbd(stop)\" or \"nopvbd(failure)\" event.\n   3) VBD Stop (stop)\n      The\
    \ nopvbd procedure ended, and the gateway did not detect any\n      errors.  Note\
    \ that this does not necessarily imply a successful\n      fax, modem, or text\
    \ transmission.  It merely indicates that the\n      nopvbd procedure has ended\
    \ and the procedure itself did not\n      encounter any errors.  Refer to the\
    \ definition of the \"stop\"\n      parameter from the \"gwvbd\" event in Section\
    \ 4.1.1 for additional\n      information.\n   4) VBD Failure (failure)\n    \
    \  The nopvbd procedure ended abnormally.  Some kind of problem was\n      encountered\
    \ in the nopvbd procedure, and the procedure ended.\n   Call Agents and gateways\
    \ MUST implement the \"start\" parameter and MAY\n   implement the \"update\"\
    , \"stop\", and \"failure\" parameters.  Call\n   Agents MAY, and gateways MUST,\
    \ implement the \"rc\" parameter in\n   conjunction with the \"start\" and \"\
    update\" parameters.  Call Agents\n   and gateways MAY implement the \"rc\" parameter\
    \ in conjunction with the\n   \"stop\" and \"failure\" parameters.  A Call Agent\
    \ MUST ignore all\n   unknown ObservedEvent parameters including parameters that\
    \ are\n   defined as part of this specification and not implemented.\n   The definitions\
    \ of the \"rc\", \"codec\", and \"dir\" ObservedEvent\n   parameters are taken\
    \ from the \"gwvbd\" event.\n   As with the \"gwvbd\" event, the same recommendations\
    \ regarding\n   interspersed text and speech apply.\n"
- title: 4.1.2.1.  No Negotiated Procedure for Voiceband Data Examples
  contents:
  - "4.1.2.1.  No Negotiated Procedure for Voiceband Data Examples\n   The following\
    \ examples illustrate the encoding of the \"nopvbd(start)\"\n   event:\n     \
    \      O: vbd/nopvbd(start, rc=ANS)\n           O: vbd/nopvbd(start, rc=ANS, codec=audio/PCMU)\n\
    \   The following example illustrates the encoding of the\n   \"nopvbd(update)\"\
    \ event:\n           O: vbd/nopvbd(update, rc=/ANSam, dir=IpToGstn)\n   The following\
    \ examples illustrate the encoding of the \"nopvbd(stop)\"\n   event:\n      \
    \     O: vbd/nopvbd(stop)\n           O: vbd/nopvbd(stop, rc=SIL, codec=audio/G729)\n\
    \           O: vbd/nopvbd(stop, rc=MC, codec=image/t38)\n   The following examples\
    \ illustrate the encoding of the\n   \"nopvbd(failure)\" event:\n           O:\
    \ vbd/nopvbd(failure, codec=audio/G729)\n           O: vbd/nopvbd(failure, rc=TO,\
    \ codec=audio/G729)\n"
- title: 5.  General-Purpose Media Descriptor Parameter Package Definition
  contents:
  - "5.  General-Purpose Media Descriptor Parameter Package Definition\n   This package\
    \ is defined for the General-Purpose Media Descriptor\n   Parameter [V152].  The\
    \ package defines a new LocalConnectionOption as\n   detailed below.\n      Package\
    \ Name:        GPMD\n      Package Version:     0\n"
- title: 5.1.  LocalConnectionOptions
  contents:
  - "5.1.  LocalConnectionOptions\n   The following new LocalConnectionOptions field\
    \ is defined in support\n   of the above:\n       ------------------------------------------------------\n\
    \      | Symbol |   Definition                                |\n      |--------|---------------------------------------------|\n\
    \      | gpmd   | General-Purpose Media Descriptor Parameter  |\n       ------------------------------------------------------\n\
    \   The definition of the LocalConnectionOption is provided in the\n   following\
    \ subsection.\n"
- title: 5.1.1.  General-Purpose Media Descriptor Parameter
  contents:
  - "5.1.1.  General-Purpose Media Descriptor Parameter\n   The General-Purpose Media\
    \ Descriptor Parameter LocalConnectionOption\n   is similar to the \"gpmd\" SDP\
    \ [RFC4566] attribute defined in ITU-T\n   Recommendation V.152 [V152] and is\
    \ applicable to all of the same\n   media formats that the corresponding SDP \"\
    gpmd\" attribute could be\n   used with.\n   The General-Purpose Media Descriptor\
    \ Parameter is encoded as the\n   keyword \"gpmd\" or \"o-gpmd\", followed by\
    \ a colon and a quoted string\n   beginning with the media format name (MIME subtype\
    \ only) followed by\n   a space, followed by the media format parameters associated\
    \ with that\n   media format:\n         gpmd/gpmd:\"<format> <parameter list>\"\
    \n   For simplicity, we will use the terms \"codec\" and \"media format\"\n  \
    \ interchangeably in the following.  Multiple media formats may be\n   indicated\
    \ by either repeating the \"gpmd\" LocalConnectionOption\n   multiple times, such\
    \ as\n         L: a:codec1;codec2, gpmd/gpmd:\"codec1 parameterX\",\n        \
    \                     gpmd/gpmd:\"codec2 parameterY\"\n   or alternatively by\
    \ having a single \"gpmd\" keyword followed by a\n   colon, and a semicolon-separated\
    \ list of quoted strings for each\n   General-Purpose Media Descriptor Parameter,\
    \ as in\n         L: a:codec1;codec2, gpmd/gpmd:\"codec1 parameterX\";\n     \
    \                                  \"codec2 parameterY\"\n   The two formats may\
    \ be mixed:\n         L: a:codec1;codec2;codec3, gpmd/gpmd:\"codec1 parameterX\"\
    ,\n                                    gpmd/gpmd:\"codec2 parameterY\";\n    \
    \                                          \"codec3 parameterZ\"\n   The carriage\
    \ returns above are included for formatting reasons only\n   and are not permissible\
    \ in a real implementation.  This holds true\n   for all of the examples in this\
    \ document.\n   If it is possible for the same codec to be requested with and\
    \ without\n   the \"gpmd\" parameter, the following could result:\n         L:\
    \ a:codec1;codec1, gpmd/gpmd:\"codec1 parameterX\"\n   However, it would not be\
    \ clear whether the \"gpmd\" parameter was to be\n   applied to the first or the\
    \ second occurrence of the codec.  The\n   problem is that codec ordering is important\
    \ (i.e., codecs are listed\n   in preferred order), and the above syntax does\
    \ not provide a way to\n   indicate whether \"parameterX\" is preferred (i.e.,\
    \ associated with the\n   first \"codec1\") or not (i.e., associated with the\
    \ second \"codec1\").\n   In order to resolve this dilemma, the codec in the \"\
    gpmd\" media\n   format is followed by a colon and an <order>, where <order> is\
    \ a\n   number from one to N for occurrences of the same codec in the codec\n\
    \   list.  For example,\n         L:a:codec1;codec1, gpmd/gpmd:\"codec1:2 parameterX\"\
    \n   indicates that \"parameterX\" is associated with the second instance of\n\
    \   \"codec1\" in the \"a:codec1;codec1\" list.  If an invalid instance\n   number\
    \ is supplied (e.g., instance 3 where there are only two\n   instances), then\
    \ error code 524 -- inconsistency in local connection\n   options -- will be returned.\
    \  In the absence of an <order>, the first\n   instance is assumed.\n   Prepending\
    \ \"gpmd\" with the string \"o-\" (i.e., \"o-gpmd\") indicates\n   that the parameter\
    \ is optional.  In that case, the gateway may decide\n   not to use the \"gpmd\"\
    \ parameter specified, or only use it in part.\n   If the \"gpmd\" LocalConnectionOption\
    \ parameter is not optional (i.e.,\n   does not have \"o-\" in front of it), and\
    \ the LocalConnectionOption\n   parameter value is either not recognized or not\
    \ supported, then the\n   associated codec is considered \"not supported\".\n\
    \   When auditing capabilities, the \"gpmd\" LocalConnectionOption\n   parameter\
    \ MUST be returned with a semicolon-separated list of\n   supported formats and/or\
    \ multiple independent \"gpmd\" parameters,\n   as in\n         A: a:codec1;codec2,\
    \ gpmd/gpmd:\"codec1 parameterX\";\n                                       \"\
    codec2 parameterY\"\n       or\n         A: a:codec1;codec1, gpmd/gpmd:\"codec1\
    \ parameterX\"\n   One example uses the General-Purpose Media Descriptor Parameter\n\
    \   LocalConnectionOption in conjunction with gateway controlled\n   Voiceband\
    \ Data (or simply VBD) using payload type switching [V152].\n   In the context\
    \ of VBD, the <format> must be an RTP/AVP payload type.\n   The <parameter list>\
    \ is a semicolon-separated list of\n   \"parameter=value\" pairs:\n     L: a:codec1,\
    \ gpmd/gpmd:\"codec1 parameterX=ValueA;parameterY=ValueB\"\n   In the example\
    \ below, G.729 is an audio codec and G.711u is a VBD\n   codec:\n         L: a:G729;PCMU,\
    \ gpmd/gpmd:\"PCMU vbd=yes\"\n   The corresponding media description in the SDP\
    \ as part of the\n   connection request acknowledgment might look like\n     \
    \    m=audio 12345 RTP/AVP 18 96\n         a=rtpmap:96 PCMU/8000\n         a=gpmd:96\
    \ vbd=yes\n   If a request is made to audit the capabilities of an endpoint, and\n\
    \   the endpoint supports G.711u as both an audio and VBD codec, then the\n  \
    \ \"gpmd\" LocalConnectionOption parameter might look like\n         A: a:PCMU,\
    \ p:10-40, e:on, s:on,\n            m:sendonly;recvonly;sendrecv;inactive\n  \
    \       A: a:PCMU, p:10-40, e:on, s:off,\n            m:sendonly;recvonly;sendrecv;inactive,\n\
    \            gpmd/gpmd:\"PCMU vbd=yes\"\n   Given that some parameters, e.g.,\
    \ silence suppression, are only\n   compatible with G.711u as an audio codec,\
    \ then the gateway MUST\n   return different capability sets corresponding to\
    \ audio and VBD.\n   If we combine V.152 and redundancy [RFC2198], an example\n\
    \   LocalConnectionOption might look like the example below.  In this\n   example,\
    \ G.729 is an audio codec and G.711u is a VBD codec with a\n   redundancy level\
    \ of one:\n     L: a:G729;RED;PCMU, gpmd/gpmd:\"PCMU vbd=yes\", fmtp:\"RED PCMU/PCMU\"\
    \n   The corresponding media description in the SDP as part of the\n   connection\
    \ request acknowledgment might look like\n         m=audio 12345 RTP/AVP 18 96\
    \ 97\n         a=rtpmap:96 RED/8000\n         a=fmtp:96 97/97\n         a=rtpmap:97\
    \ PCMU/8000\n         a=gpmd:97 vbd=yes\n   Refer to Section 6 for more examples\
    \ involving V.152 and redundancy.\n"
- title: 6.  Use of Media Format Parameter Package with VBD and Redundancy
  contents:
  - "6.  Use of Media Format Parameter Package with VBD and Redundancy\n   The MGCP\
    \ Media Format Parameter (FM) package [RFC3660] in conjunction\n   with the standard\
    \ audio MIME subtype \"RED\" may be used by the Call\n   Agent to authorize the\
    \ negotiation of redundancy [RFC2198], to\n   identify the levels of redundancy\
    \ and the media format associated\n   with each redundancy level.  An example\
    \ of this was demonstrated in\n   Section 5.\n   The FM package states that the\
    \ \"fmtp\" LocalConnectionOption MUST be\n   returned when auditing capabilities.\
    \  Applying this to VBD and\n   redundancy might result in\n         A: a:PCMU,\
    \ p:10-40, e:on, s:on,\n            m:sendonly;recvonly;sendrecv;inactive\n  \
    \       A: a:RED;PCMU, p:10-40, e:on, s:off,\n            m:sendonly;recvonly;sendrecv;inactive,\n\
    \            gpmd/gpmd:\"PCMU vbd=yes\",\n            fmtp:\"RED PCMU/PCMU\"\n\
    \      The FM package defines \"instance syntax\", in which\n        L:a:codec1;codec1,\
    \ fmtp:\"codec1:2 formatX\"\n   indicates that \"formatX\" is associated with\
    \ the second instance of\n   \"codec1\" in the \"a:codec1;codec1\" list.  The\
    \ examples in the FM\n   package are limited to the use of the instance syntax\
    \ in conjunction\n   with the media format.  We propose the use of the instance\
    \ syntax in\n   conjunction with the media format parameters\n        L:a:codec1;codec2;codec3;codec2,\
    \ fmtp:\"codec3 codec2:2/codec2:2\"\n   Let's build on the example of Section\
    \ 5.  In the example below, G.729\n   is an audio codec, and G.711u is both an\
    \ audio codec and a VBD codec\n   with a redundancy level of one:\n        L:\
    \ a:G729;PCMU;RED;PCMU, gpmd/gpmd:\"PCMU:2 vbd=yes\",\n                      \
    \           fmtp:\"RED PCMU:2/PCMU:2\"\n   The corresponding media description\
    \ in the SDP as part of the\n   connection request acknowledgment might look like\n\
    \        m=audio 12345 RTP/AVP 18 0 96 97\n        a=rtpmap:96 RED/8000\n    \
    \    a=fmtp:96 97/97\n        a=rtpmap:97 PCMU/8000\n        a=gpmd:97 vbd=yes\n\
    \   Note that the relative preference of the LocalConnectionOption\n   encoding\
    \ methods is preserved in the \"audio\" media formats (i.e.,\n   payload types)\
    \ as part of the media description.  In this example,\n   this reflects a preference\
    \ for V.152 with redundancy versus without.\n   No preference is inferred from\
    \ the relative order of the different\n   LocalConnectionOptions, namely \"a\"\
    , \"gpmd/gpmd\", and \"fmtp\".\n   A Call Agent can authorize the negotiation\
    \ of audio codecs and VBD\n   codecs involving different levels of redundancy.\
    \  In the example\n   below, G.711u is a VBD codec with a redundancy level of\
    \ two\n   (preferred) or one:\n        L: a:G729;RED;RED;PCMU, fmtp:\"RED PCMU/PCMU/PCMU\"\
    ,\n                                fmtp:\"RED:2 PCMU/PCMU\",\n               \
    \                 gpmd/gpmd:\"PCMU vbd=yes\"\n   The corresponding media description\
    \ in the SDP as part of the\n   connection request acknowledgment might look like\n\
    \        m=audio 12345 RTP/AVP 18 96 97 98\n        a=rtpmap:96 RED/8000\n   \
    \     a=fmtp:96 98/98/98\n        a=rtpmap:97 RED/8000\n        a=fmtp:97 98/98\n\
    \        a=rtpmap:98 PCMU/8000\n        a=gpmd:98 vbd=yes\n   Redundancy can be\
    \ applied to both audio codecs and VBD codecs.  In\n   the example below, G.729\
    \ is an audio codec with a redundancy level of\n   two and G.711u is a VBD codec\
    \ with a redundancy level of one:\n        L: a:RED;G729;RED;PCMU, fmtp:\"RED\
    \ G729/G729/G729\",\n                                fmtp:\"RED:2 PCMU/PCMU\"\
    ,\n                                gpmd/gpmd:\"PCMU vbd=yes\"\n   The corresponding\
    \ media description in the SDP as part of the\n   connection request acknowledgment\
    \ might look like\n        m=audio 12345 RTP/AVP 96 18 97 98\n        a=rtpmap:96\
    \ RED/8000\n        a=fmtp:96 18/18/18\n        a=rtpmap:97 RED/8000\n       \
    \ a=fmtp:97 98/98\n        a=rtpmap:98 PCMU/8000\n        a=gpmd:98 vbd=yes\n"
- title: 7.  Use of Media Format Parameter Package with VBD and FEC
  contents:
  - "7.  Use of Media Format Parameter Package with VBD and FEC\n   A Call Agent may\
    \ authorize the negotiation of forward error\n   correction (FEC) [RFC5109] with\
    \ the standard audio MIME subtype\n   \"parityfec\":\n        L: a:PCMU;parityfec\n\
    \   By default, we assume that FEC packets are to be sent as a separate\n   stream.\
    \  The corresponding media description in the SDP as part of\n   the connection\
    \ request acknowledgment might look like\n         v=0\n         c=IN IP4 192.0.2.0\n\
    \         m=audio 49170 RTP/AVP 0 96\n         a=rtpmap:96 parityfec/8000\n  \
    \       a=fmtp:96 49172 IN IP4 192.0.2.0\n   If FEC is to be sent as a secondary\
    \ codec in the redundant codec\n   payload format [RFC2198], we again leverage\
    \ the MGCP Media Format\n   Parameter (FM) package [RFC3660] in conjunction with\
    \ the standard\n   audio MIME subtype \"RED\":\n         L: a:G729;RED;PCMU;parityfec,\
    \ gpmd/gpmd:\"PCMU vbd=yes\",\n                                       fmtp:\"\
    RED PCMU/parityfec\"\n      The corresponding media description might look like\n\
    \         v=0\n         c=IN IP4 192.0.2.0\n         m=audio 49170 RTP/AVP 18\
    \ 96 97 98\n         a=rtpmap:96 RED/8000\n         a=fmtp:96 97/98\n        \
    \ a=rtpmap:97 PCMU/8000\n         a=gpmd:97 vbd=yes\n         a=rtpmap:98 parityfec/8000\n\
    \   The FM package states that the \"fmtp\" LocalConnectionOption MUST be\n  \
    \ returned when auditing capabilities.  Applying this to VBD,\n   redundancy and\
    \ FEC might result in\n         A: a:PCMU, p:10-40, e:on, s:on,\n            m:sendonly;recvonly;sendrecv;inactive\n\
    \         A: a:RED;PCMU;parityfec, p:10-40, e:on, s:off,\n            m:sendonly;recvonly;sendrecv;inactive,\n\
    \            gpmd/gpmd:\"PCMU vbd=yes\",\n            fmtp:\"RED PCMU/parityfec\"\
    \n"
- title: 8.  Use of Fax Package with VBD
  contents:
  - "8.  Use of Fax Package with VBD\n   The MGCP Fax (FXR) package [RFC5347] is used\
    \ by a Call Agent to\n   authorize fax handling, including Call Agent controlled\
    \ T.38 and\n   gateway procedures such as V.152.  With the FXR package, VBD falls\n\
    \   into one of two categories: \"special fax handling\" as part of the\n   gateway\
    \ procedure (resulting in the \"gwfax\" event), or \"no special\n   fax handling\"\
    \ as part of the gateway and Off procedures (resulting in\n   the \"nopfax\" event).\
    \  In order for a VBD procedure to fall into the\n   \"special fax handling\"\
    \ category, support for it MUST be negotiated\n   with the other side by passing\
    \ and recognizing relevant parameters\n   via the LocalConnectionDescriptor and\
    \ RemoteConnectionDescriptor.\n   A gateway controlled VBD procedure such as V.152\
    \ MUST fall into the\n   category of gateway controlled mode involving \"special\
    \ fax handling\".\n   The resulting \"gwfax\" event is what informs the Call Agent\
    \ to refrain\n   from issuing media handling instructions that could otherwise\
    \ have a\n   negative impact on the gateway procedure.\n   Consider the following\
    \ example (with shorthand SDP notation):\n           CRCX 2000 ds/ds1-1/2@gw-t.whatever.net\
    \ MGCP 1.0\n           C: 1\n           M: sendrecv\n           L: a:G729;PCMU,\
    \ gpmd/gpmd:\"PCMU vbd=yes\", fxr/fx:t38;gw\n           X: 1\n           R: fxr/t38,\
    \ fxr/gwfax, fxr/nopfax\n           v=0\n           c=IN IP4 192.0.2.1\n     \
    \      m=audio 3456 RTP/AVP 18 96\n           a=rtpmap:96 PCMU/8000\n        \
    \   a=gpmd:96 vbd=yes\n           200 2000 OK\n           I: 1\n           v=0\n\
    \           c=IN IP4 192.0.2.2\n           m=audio 1296 RTP/AVP 18 96\n      \
    \     a=rtpmap:96 PCMU/8000\n           a=gpmd:96 vbd=yes\n   The RemoteConnectionDescriptor\
    \ does not indicate support for \"image/\n   t38\" as a latent capability [RFC3407].\
    \  Consequently, the gateway\n   will not initiate the T.38 strict fax procedure,\
    \ \"t38\", upon\n   detecting fax stimulus (i.e., CNG, V.21 flags, etc.).  However,\
    \ the\n   two endpoints did successfully negotiate a gateway controlled VBD\n\
    \   procedure (e.g., V.152); therefore, a gateway controlled mode\n   involving\
    \ \"special fax handling\" is used.  The \"gwfax(start)\" event\n   will be generated\
    \ upon detecting VBD (including fax) stimulus.\n   A Call Agent can express a\
    \ preference for a gateway procedure\n   involving \"special fax handling\" over\
    \ a T.38 procedure (strict or\n   loose).  For example,\n         L: fxr/fx:gw;t38\n\
    \   and\n         L: fxr/fx:gw;t38-loose\n   However, with the existing syntax\
    \ of the FXR package, a Call Agent\n   cannot express a preference for one gateway\
    \ procedure over another,\n   each with possibly different preferences relative\
    \ to a T.38\n   procedure.\n   The FXR package allows a gateway to implement additional\
    \ fax handling\n   parameters.  We define just such a parameter by qualifying\
    \ the\n   existing \"gw\" parameter with a list of one or more MIME types:\n \
    \       Gateway  = \"gw[\" mimeType 0*(\"|\" mimeType) \"]\"\n        mimeType\
    \ = mimeMediaType \"/\" mimeSubType\n        ; mimeMediaType and mimeSubType from\n\
    \        ;   http://www.iana.org/assignments/media-types/\n   By qualifying the\
    \ \"gw\" parameter with a list of MIME types, we narrow\n   the scope of the gateway\
    \ procedure.  Consider the following examples\n   in which the Call Agent authorizes\
    \ the use of a gateway controlled\n   fax handling procedure:\n       - involving\
    \ \"image/t38\" (e.g., T.38oUDPTL, T.38oTCP):\n         L: a:G729, fxr/fx:gw[image/t38]\n\
    \       - involving VBD (e.g., PCMU and V.152):\n         L: a:G729;PCMU, gpmd/gpmd:\"\
    PCMU vbd=yes\", fxr/fx:gw[audio/PCMU]\n       - involving VBD with redundancy\
    \ (e.g., PCMU, V.152,\n         and RFC 2198):\n         L: a:G729;RED;PCMU, fmtp:\"\
    RED PCMU/PCMU\",\n            gpmd/gpmd:\"PCMU vbd=yes\", fxr/fx:gw[audio/RED|audio/PCMU]\n\
    \   Only \"special fax handling\" involving one of the specified MIME types\n\
    \   is authorized.  Support for \"special fax handling\" involving one of\n  \
    \ the specified MIME types MUST be negotiated, or this \"instance\" of\n   the\
    \ gateway procedure is not initiated.  Consider the following\n   example in which\
    \ the Call Agent authorizes the use of a gateway\n   controlled fax handling procedure:\n\
    \       - involving \"audio/t38\" (e.g., T.38oRTP):\n         L: a:G729;t38, fxr/fx:gw[audio/t38]\n\
    \   In this example, the call will fail if the gateway fails to negotiate\n  \
    \ \"audio/t38\".\n   The \"fx\" LocalConnectionOption MAY now involve multiple\
    \ instances of\n   the \"gw\" parameter, each with a different list of MIME types.\
    \  In\n   order to authorize \"no special fax handling\", the Call Agent MUST\n\
    \   include the \"gw\" parameter without a MIME type, or the \"off\"\n   parameter.\
    \  The instance of the \"gw\" parameter without a MIME type\n   should appear\
    \ as the last instance of the \"gw\" parameter.  In the\n   following example,\n\
    \      L: a:G729;PCMU, fxr/fx:gw[image/t38];gw\n   the Call Agent authorizes the\
    \ use of, and expresses a preference for,\n   1.  Gateway controlled image/t38\
    \ (e.g., T.38oUDPTL)\n   2.  Any other gateway procedure with \"special fax handling\"\
    \n   3.  No special fax handling (this is a function of the \"fxr/fx:gw\"\n  \
    \     parameter as defined in Section 2.1 of the MGCP Fax (FXR) package\n    \
    \   [RFC5347])\n   If present, the \"off\" parameter should appear as the last\
    \ parameter.\n   In the following example,\n      L: a:G729;PCMU;t38, fxr/fx:gw[audio/t38];off\n\
    \   the Call Agent authorizes the use of, and expresses a preference for,\n  \
    \ 1.  Gateway controlled audio/t38 (e.g., T.38oRTP)\n   2.  No special fax handling\n\
    \   We can express relative preferences for different gateway controlled\n   fax\
    \ handling procedures, not only with respect to one another, but\n   with respect\
    \ to T.38 procedures.  Consider the following preferential\n   list of fax handling\
    \ procedures:\n   1.  Gateway controlled audio/t38 (e.g., T.38oRTP)\n   2.  Gateway\
    \ controlled image/t38 (e.g., T.38oUDPTL)\n   3.  Call Agent controlled image/t38\n\
    \   4.  Gateway controlled VBD with redundancy (e.g., PCMU, V.152, and\n     \
    \  RFC 2198)\n   5.  Gateway controlled VBD without redundancy (e.g., PCMU and\
    \ V.152)\n   6.  Any other gateway procedure with \"special fax handling\"\n \
    \  7.  No special fax handling (this is a function of the \"fxr/fx:gw\"\n    \
    \   parameter as defined in Section 2.1 of the MGCP Fax (FXR) package\n      \
    \ [RFC5347])\n   This would be expressed as\n     L: a:G729;PCMU;t38;RED;PCMU,\n\
    \        gpmd/gpmd:\"PCMU:2 vbd=yes\",\n        fmtp:\"RED PCMU:2/PCMU:2\",\n\
    \        fxr/fx:gw[audio/t38|image/t38];t38;gw[audio/RED|audio/PCMU:2];gw\n  \
    \ Note that the bracketed form of the \"gw\" parameter is NOT defined as\n   part\
    \ of the VBD package.  The bracketed form of the \"gw\" parameter is\n   defined\
    \ as an extension to the FXR package.  Gateways that implement\n   the bracketed\
    \ form of the \"gw\" parameter MUST return this form of the\n   parameter when\
    \ capabilities are audited as illustrated by the\n   following example:\n    \
    \    A: fxr/fx:t38;t38-loose;gw[audio/t38|image/t38];gw;off\n   Support for the\
    \ bracketed \"gw\" parameter MAY be spread across\n   multiple capability lines:\n\
    \        A: a:RED;PCMU, p:10-40, e:on, s:off,\n           m:sendonly;recvonly;sendrecv;inactive,\n\
    \           gpmd/gpmd:\"PCMU vbd=yes\",\n             fmtp:\"RED PCMU/PCMU\",\n\
    \             fxr/fx:gw[audio/RED|audio/PCMU]\n        A: a:t38, fxr/fx:gw[audio/t38]\n\
    \        A: a:image/t38, fxr/fx:t38;t38-loose;gw[image/t38]\n   A Call Agent SHOULD\
    \ only attempt to leverage the bracketed form of\n   the \"gw\" parameter in conjunction\
    \ with an endpoint that indicates\n   support for the bracketed syntax as part\
    \ of its capabilities.\n   Call Agents and gateways that do not support this form\
    \ of the \"gw\"\n   parameter MUST ignore the bracketed MIME type information\
    \ consistent\n   with the MGCP grammar [RFC3435].\n"
- title: 9.  Call Flow Examples
  contents:
  - "9.  Call Flow Examples\n   In this section, we provide two call flow examples.\
    \  The first one\n   illustrates a modem call under gateway control using V.152.\
    \  The\n   second one illustrates a fax call under gateway control using V.152\n\
    \   and Call Agent controlled T.38.\n"
- title: 9.1.  Modem Call with Gateway Controlled VBD
  contents:
  - "9.1.  Modem Call with Gateway Controlled VBD\n   In this example, both sides\
    \ support gateway controlled VBD using\n   V.152 with redundancy.  We assume that\
    \ the originating and\n   terminating Call Agents communicate via the Session\
    \ Initiation\n   Protocol (SIP) [RFC3261]:\n    ------------------------------------------------------------------\n\
    \   | #|     GW-o      |     CA-o      |      CA-t     |      GW-t     |\n   |==|===============|===============|===============|===============|\n\
    \   | 1|             <-|CRCX           |               |               |\n   |\
    \ 2|     200(sdp-o)|->             |               |               |\n   | 3|\
    \               |  INVITE(sdp-o)|->             |               |\n   | 4|   \
    \            |               |    CRCX(sdp-o)|->             |\n   | 5|      \
    \         |               |             <-|200 (sdp-t)    |\n   | 6|         \
    \      |             <-|200(sdp-t)     |               |\n   | 7|            \
    \ <-|MDCX(sdp-t)    |               |               |\n   | 8|            200|->\
    \             |               |               |\n   |--|---------------|---------------|---------------|---------------|\n\
    \   | 9|               |               |               |<- ANS/T.30 CED|\n   |10|\
    \               |               |           <- NTFY(gwvbd start)|\n   |11|   \
    \            |               |            200|->             |\n   |12|NTFY(gwvbd\
    \ start) ->           |               |               |\n   |13|             <-|200\
    \            |               |               |\n   |--|---------------|---------------|---------------|---------------|\n\
    \   |14|               |               |               | (modem ends)  |\n   |15|\
    \               |               |           <- NTFY(gwvbd stop) |\n   |16|   \
    \            |               |            200|->             |\n   |17|NTFY(gwvbd\
    \ stop) ->            |               |               |\n   |18|             <-|200\
    \            |               |               |\n    ------------------------------------------------------------------\n\
    \   Step 1:\n      The Call Agent issues a CreateConnection command to the gateway,\n\
    \      instructing it to use G.729 media encoding and to notify it of the\n  \
    \    \"gwvbd\" and \"nopvbd\" events.  The Call Agent authorizes the\n      negotiation\
    \ of G.711u as a VBD codec with a redundancy level\n      of one:\n      CRCX\
    \ 1000 ds/ds1-1/1@gw-o.whatever.net MGCP 1.0\n      C: 1\n      L: a:G729;RED;PCMU,\
    \ gpmd/gpmd:\"PCMU vbd=yes\", fmtp:\"RED PCMU/PCMU\"\n      M: recvonly\n    \
    \  R: vbd/gwvbd, vbd/nopvbd\n      X: 1\n      Q: process, loop\n   Step 2:\n\
    \      The gateway acknowledges the command and includes SDP with codec\n    \
    \  information as well as V.152 and redundancy information:\n           200 1000\
    \ OK\n           I:1\n           v=0\n           o=- 25678 753849 IN IP4 192.0.2.1\n\
    \           s=-\n           c=IN IP4 192.0.2.1\n           t=0 0\n           m=audio\
    \ 3456 RTP/AVP 18 96 97\n           a=rtpmap:96 RED/8000\n           a=fmtp:96\
    \ 97/97\n           a=rtpmap:97 PCMU/8000\n           a=gpmd:97 vbd=yes\n   Step\
    \ 3:\n      The originating Call Agent sends a SIP INVITE message with the SDP\n\
    \      to the terminating Call Agent.\n   Step 4:\n      The terminating Call\
    \ Agent issues a CreateConnection command to\n      the terminating gateway, instructing\
    \ it to use G.729 media\n      encoding and to notify it of the \"gwvbd\" and\
    \ \"nopvbd\" events.\n      Again, the Call Agent authorizes the negotiation of\
    \ G.711u as a\n      VBD codec with a redundancy level of one:\n      CRCX 2000\
    \ ds/ds1-1/2@gw-t.whatever.net MGCP 1.0\n      C: 2\n      L: a:G729;RED;PCMU,\
    \ gpmd/gpmd:\"PCMU vbd=yes\", fmtp:\"RED PCMU/PCMU\"\n      M: sendrecv\n    \
    \  R: vbd/gwvbd, vbd/nopvbd\n      X: 20\n      Q: process, loop\n      v=0\n\
    \      o=- 25678 753849 IN IP4 192.0.2.1\n      s=-\n      c=IN IP4 192.0.2.1\n\
    \      t=0 0\n      m=audio 3456 RTP/AVP 18 96 97\n      a=rtpmap:96 RED/8000\n\
    \      a=fmtp:96 97/97\n      a=rtpmap:97 PCMU/8000\n      a=gpmd:97 vbd=yes\n\
    \   Step 5:\n      The terminating gateway supports V.152 and redundancy, and\
    \ the\n      RemoteConnectionDescriptor included indicates that the other side\n\
    \      supports V.152 and redundancy.  The terminating gateway sends back\n  \
    \    a success response with its SDP, which also includes V.152 and\n      redundancy\
    \ information:\n           200 2000 OK\n           I:2\n           v=0\n     \
    \      o=- 25678 753849 IN IP4 192.0.2.2\n           s=-\n           c=IN IP4\
    \ 192.0.2.2\n           t=0 0\n           m=audio 1296 RTP/AVP 18 96 97\n    \
    \       a=rtpmap:96 RED/8000\n           a=fmtp:96 97/97\n           a=rtpmap:97\
    \ PCMU/8000\n           a=gpmd:97 vbd=yes\n   Step 6:\n      The terminating Call\
    \ Agent sends back a SIP 200 OK response to the\n      originating Call Agent,\
    \ which in turn sends a SIP ACK (not shown).\n   Step 7:\n      The originating\
    \ Call Agent in turn sends a ModifyConnection\n      command to the originating\
    \ gateway:\n           MDCX 1001 ds/ds1-1/1@gw-o.whatever.net MGCP 1.0\n     \
    \      C: 1\n           I: 1\n           M: sendrecv\n           v=0\n       \
    \    o=- 25678 753849 IN IP4 192.0.2.2\n           s=-\n           c=IN IP4 192.0.2.2\n\
    \           t=0 0\n           m=audio 1296 RTP/AVP 18 96 97\n           a=rtpmap:96\
    \ RED/8000\n           a=fmtp:96 97/97\n           a=rtpmap:97 PCMU/8000\n   \
    \        a=gpmd:97 vbd=yes\n      Since the RemoteConnectionDescriptor indicates\
    \ that the other side\n      supports V.152 and redundancy, the gateway will in\
    \ fact be able to\n      use the gateway controlled VBD procedure with redundancy.\
    \  Had\n      there not been any support for V.152 in the\n      RemoteConnectionDescriptor,\
    \ then this command would still have\n      succeeded; however, there would be\
    \ no negotiated procedure for VBD\n      handling.\n   Step 8:\n      The gateway\
    \ acknowledges the command.  At this point, a call is\n      established using\
    \ G.729 encoding, and if a VBD call is detected,\n      the gateway controlled\
    \ VBD procedure will be initiated.\n   Steps 9-10:\n      A modem call now occurs.\
    \  The terminating gateway detects a T.30\n      CED tone (a.k.a. V.25 ANS) in\
    \ the GSTN-to-IP direction and begins\n      transmitting RTP packets with the\
    \ negotiated redundant VBD payload\n      type (96).\n      The \"gwvbd(start)\"\
    \ event occurs, and a Notify command is sent to\n      the Call Agent:\n     \
    \      NTFY 2500 ds/ds1-1/2@gw-t.whatever.net MGCP 1.0\n           O: vbd/gwvbd(start,\
    \ rc=ANS, codec=audio/RED, coord=v152ptsw)\n           X: 20\n   Step 11:\n  \
    \    The Call Agent acknowledges the Notify command:\n           200 2500 OK\n\
    \   Step 12:\n      Upon receiving an RTP packet with the redundant VBD payload\
    \ type\n      (96), the originating gateway begins transmitting RTP packets with\n\
    \      the redundant VBD payload type.\n      The \"gwvbd(start)\" event occurs,\
    \ and a Notify command is sent to\n      the Call Agent:\n           NTFY 1500\
    \ ds/ds1-1/1@gw-o.whatever.net MGCP 1.0\n           O: vbd/gwvbd(start, rc=PTSW,\
    \ codec=audio/RED)\n           X: 1\n   Step 13:\n      The Call Agent acknowledges\
    \ the Notify command:\n           200 1500 OK\n   Steps 14-15:\n      The modem\
    \ call ends.  The terminating gateway detects\n      bidirectional silence and\
    \ begins transmitting RTP packets with the\n      negotiated audio payload type\
    \ (18).\n      The \"gwvbd(stop)\" event occurs, and a Notify command is sent\
    \ to\n      the Call Agent:\n           NTFY 2501 ds/ds1-1/2@gw-t.whatever.net\
    \ MGCP 1.0\n           O: vbd/gwvbd(stop, rc=SIL, codec=audio/G729)\n        \
    \   X: 20\n   Step 16:\n      The Call Agent acknowledges the Notify command:\n\
    \           200 2501 OK\n   Step 17:\n      Upon receiving an RTP packet with\
    \ the audio payload type (18), the\n      originating gateway begins transmitting\
    \ RTP packets with the audio\n      payload type.\n      The \"gwvbd(stop)\" event\
    \ occurs, and a Notify command is sent to\n      the Call Agent:\n           NTFY\
    \ 1501 ds/ds1-1/1@gw-o.whatever.net MGCP 1.0\n           O: vbd/gwvbd(stop, rc=PTSW,\
    \ codec=audio/G729)\n           X: 1\n   Step 18:\n      The Call Agent acknowledges\
    \ the Notify command:\n           200 1501 OK\n   The modem call is now over.\n"
- title: 9.2.  Fax Call with Gateway Controlled VBD and Call Agent Controlled
  contents:
  - "9.2.  Fax Call with Gateway Controlled VBD and Call Agent Controlled\n      T.38\n\
    \   In this example, both sides support gateway controlled VBD using\n   V.152\
    \ with redundancy and Call Agent controlled T.38.  We assume that\n   the originating\
    \ and terminating Call Agent communicate via the\n   Session Initiation Protocol\
    \ (SIP) [RFC3261]:\n    ------------------------------------------------------------------\n\
    \   | #|     GW-o      |     CA-o      |      CA-t     |      GW-t     |\n   |==|===============|===============|===============|===============|\n\
    \   | 1|             <-|CRCX           |               |               |\n   |\
    \ 2|     200(sdp-o)|->             |               |               |\n   | 3|\
    \               |  INVITE(sdp-o)|->             |               |\n   | 4|   \
    \            |               |    CRCX(sdp-o)|->             |\n   | 5|      \
    \         |               |             <-|200 (sdp-t)    |\n   | 6|         \
    \      |             <-|200(sdp-t)     |               |\n   | 7|            \
    \ <-|MDCX(sdp-t)    |               |               |\n   | 8|            200|->\
    \             |               |               |\n   |--|---------------|---------------|---------------|---------------|\n\
    \   | 9|               |               |               |<- ANS/T.30 CED|\n   |10|\
    \               |               |           <- NTFY(gwvbd start)|\n   |11|   \
    \            |               |            200|->             |\n   |12|NTFY(gwvbd\
    \ start) ->           |               |               |\n   |13|             <-|200\
    \            |               |               |\n   |14|               |      \
    \         |               <- V.21 Preamble|\n   |15|               |         \
    \      |             <- NTFY(t38 start)|\n   |16|               |            \
    \   |            200|->             |\n   |17|               |               |\
    \      MDCX(t38)|->             |\n   |18|               |               |   \
    \          <-|200(sdp-t2)    |\n   |19|               |             <-|INVITE(sdp-t2)\
    \ |               |\n   |20|             <-|MDCX(sdp-t2)   |               | \
    \              |\n   |21|    200(sdp-o2)|->             |               |    \
    \           |\n   |22|               |    200(sdp-o2)|->             |       \
    \        |\n   |23|               |               |   MDCX(sdp-o2)|->        \
    \     |\n   |24|               |               |             <-|200          \
    \  |\n   |25| V.21 Preamble |->             |               |               |\n\
    \   |26|NTFY(t38 start)|->             |               |               |\n   |27|\
    \             <-|200            |               |               |\n   |--|---------------|---------------|---------------|---------------|\n\
    \   |28|               |               |               |   (fax ends)  |\n   |29|\
    \               |               |             <-|NTFY(t38 stop) |\n   |30|   \
    \            |               |            200|->             |\n   |31|NTFY(t38\
    \ stop) |->             |               |               |\n   |32|           \
    \  <-|200            |               |               |\n    ------------------------------------------------------------------\n\
    \   Step 1:\n      The Call Agent issues a CreateConnection command to the gateway,\n\
    \      instructing it to use G.729 media encoding and to use either the\n    \
    \  strict T.38 procedure or the gateway procedure.  Consequently, the\n      Call\
    \ Agent requests notification of the \"t38\", \"gwfax\", \"gwvbd\",\n      and\
    \ \"nopvbd\" events.  The Call Agent authorizes the negotiation of\n      G.711u\
    \ as a VBD codec with a redundancy level of one:\n     CRCX 1000 ds/ds1-1/1@gw-o.whatever.net\
    \ MGCP 1.0\n     C: 1\n     L: a:G729;RED;PCMU, gpmd/gpmd:\"PCMU vbd=yes\", fmtp:\"\
    RED PCMU/PCMU\",\n        fxr/fx:t38;gw\n     M: recvonly\n     R: fxr/t38, fxr/gwfax,\
    \ vbd/gwvbd, vbd/nopvbd\n     X: 1\n     Q: process, loop\n   Step 2:\n      The\
    \ gateway acknowledges the command and includes SDP with codec\n      information\
    \ as well as capability, V.152, and redundancy\n      information:\n         \
    \  200 1000 OK\n           I:1\n           v=0\n           o=- 25678 753849 IN\
    \ IP4 192.0.2.1\n           s=-\n           c=IN IP4 192.0.2.1\n           t=0\
    \ 0\n           a=pmft: T38\n           m=audio 3456 RTP/AVP 18 96 97\n      \
    \     a=rtpmap:96 RED/8000\n           a=fmtp:96 97/97\n           a=rtpmap:97\
    \ PCMU/8000\n           a=gpmd:97 vbd=yes\n           a=sqn: 0\n           a=cdsc:\
    \ 1 audio RTP/AVP 18 96 97\n           a=cdsc: 4 image udptl t38\n      Note that\
    \ V.152 requires the use of the session-level \"a=pmft\" SDP\n      attribute\
    \ in order to express a preference for T.38 over V.152 for\n      fax handling.\n\
    \   Step 3:\n      The originating Call Agent sends a SIP INVITE message with\
    \ the SDP\n      to the terminating Call Agent.\n   Step 4:\n      The terminating\
    \ Call Agent issues a CreateConnection command to\n      the terminating gateway,\
    \ instructing it to use G.729 media\n      encoding and to use either the strict\
    \ T.38 procedure or the\n      gateway procedure.  Consequently, the Call Agent\
    \ requests\n      notification of the \"t38\", \"gwfax\", \"gwvbd\", and \"nopvbd\"\
    \ events.\n      Again, the Call Agent authorizes the negotiation of G.711u as\
    \ a\n      VBD codec with a redundancy level of one:\n     CRCX 2000 ds/ds1-1/2@gw-t.whatever.net\
    \ MGCP 1.0\n     C: 2\n     L: a:G729;RED;PCMU, gpmd/gpmd:\"PCMU vbd=yes\", fmtp:\"\
    RED PCMU/PCMU\",\n        fxr/fx:t38;gw\n     M: sendrecv\n     R: fxr/t38, fxr/gwfax,\
    \ vbd/gwvbd, vbd/nopvbd\n     X: 20\n     Q: process, loop\n     v=0\n     o=-\
    \ 25678 753849 IN IP4 192.0.2.1\n     s=-\n     c=IN IP4 192.0.2.1\n     t=0 0\n\
    \     a=pmft: T38\n     m=audio 3456 RTP/AVP 18 96 97\n     a=rtpmap:96 RED/8000\n\
    \     a=fmtp:96 97/97\n     a=rtpmap:97 PCMU/8000\n     a=gpmd:97 vbd=yes\n  \
    \   a=sqn: 0\n     a=cdsc: 1 audio RTP/AVP 18 96 97\n     a=cdsc: 4 image udptl\
    \ t38\n   Step 5:\n      The terminating gateway supports T.38, and the\n    \
    \  RemoteConnectionDescriptor included indicates that the other side\n      supports\
    \ T.38 as well, so the strict T.38 Call Agent controlled\n      procedure requested\
    \ can be used.  The terminating gateway supports\n      V.152 and redundancy,\
    \ and the RemoteConnectionDescriptor included\n      indicates that the other\
    \ side supports V.152 and redundancy, so\n      gateway controlled VBD using V.152\
    \ and redundancy can be used for\n      modem and text transmissions.  The terminating\
    \ gateway sends back\n      a success response with its SDP, which also includes\
    \ capability,\n      V.152, and redundancy information:\n           200 2000 OK\n\
    \           I:2\n           v=0\n           o=- 25678 753849 IN IP4 192.0.2.2\n\
    \           s=-\n           c=IN IP4 192.0.2.2\n           t=0 0\n           a=pmft:\
    \ T38\n           m=audio 1296 RTP/AVP 18 96 97\n           a=rtpmap:96 RED/8000\n\
    \           a=fmtp:96 97/97\n           a=rtpmap:97 PCMU/8000\n           a=gpmd:97\
    \ vbd=yes\n           a=sqn: 0\n           a=cdsc: 1 audio RTP/AVP 18 96 97\n\
    \           a=cdsc: 4 image udptl t38\n   Step 6:\n      The terminating Call\
    \ Agent sends back a SIP 200 OK response to the\n      originating Call Agent,\
    \ which in turn sends a SIP ACK (not shown).\n   Step 7:\n      The originating\
    \ Call Agent in turn sends a ModifyConnection\n      command to the originating\
    \ gateway:\n           MDCX 1001 ds/ds1-1/1@gw-o.whatever.net MGCP 1.0\n     \
    \      C: 1\n           I: 1\n           M: sendrecv\n           v=0\n       \
    \    o=- 25678 753849 IN IP4 192.0.2.2\n           s=-\n           c=IN IP4 192.0.2.2\n\
    \           t=0 0\n           a=pmft: T38\n           m=audio 1296 RTP/AVP 18\
    \ 96 97\n           a=rtpmap:96 RED/8000\n           a=fmtp:96 97/97\n       \
    \    a=rtpmap:97 PCMU/8000\n           a=gpmd:97 vbd=yes\n           a=sqn: 0\n\
    \           a=cdsc: 1 audio RTP/AVP 18 96 97\n           a=cdsc: 4 image udptl\
    \ t38\n      The ModifyConnection command does not repeat the\n      LocalConnectionOptions\
    \ sent previously.  As far as fax handling is\n      concerned, the gateway therefore\
    \ attempts to continue using the\n      current fax handling procedure, i.e.,\
    \ strict Call Agent controlled\n      T.38.  Since the capability information\
    \ indicates that the other\n      side supports T.38, the gateway will in fact\
    \ be able to use the\n      strict Call Agent controlled T.38 procedure.  Since\
    \ the\n      RemoteConnectionDescriptor indicates that the other side supports\n\
    \      V.152 and redundancy, the gateway will in fact be able to use the\n   \
    \   V.152 VBD procedure with redundancy.\n   Step 8:\n      The gateway acknowledges\
    \ the command.  At this point, a call is\n      established using G.729 encoding,\
    \ and if a fax call is detected,\n      the Call Agent controlled T.38 procedure\
    \ will be initiated.  If a\n      modem or text call is detected, the V.152 VBD\
    \ procedure will be\n      initiated.\n   Steps 9-10:\n      The terminating gateway\
    \ detects the T.30 CED tone (a.k.a. V.25\n      ANS).  Since both fax and modem\
    \ calls can start with this\n      sequence, it is not possible to determine that\
    \ this is a fax call\n      until step 14, where the V.21 fax preamble is detected.\
    \  The\n      terminating gateway begins transmitting RTP packets with the\n \
    \     negotiated redundant VBD payload type (96).\n      The \"gwvbd(start)\"\
    \ event occurs, and a Notify command is sent to\n      the Call Agent:\n     \
    \      NTFY 2500 ds/ds1-1/2@gw-t.whatever.net MGCP 1.0\n           O: vbd/gwvbd(start,\
    \ rc=ANS, codec=audio/RED, coord=v152ptsw)\n           X: 20\n   Step 11:\n  \
    \    The Call Agent acknowledges the Notify command:\n           200 2500 OK\n\
    \   Step 12:\n      Upon receiving an RTP packet with the redundant VBD payload\
    \ type\n      (96), the originating gateway begins transmitting RTP packets with\n\
    \      the redundant VBD payload type.\n      The \"gwvbd(start)\" event occurs,\
    \ and a Notify command is sent to\n      the Call Agent:\n           NTFY 1500\
    \ ds/ds1-1/1@gw-o.whatever.net MGCP 1.0\n           O: vbd/gwvbd(start, rc=PTSW,\
    \ codec=audio/RED)\n           X: 1\n   Step 13:\n      The Call Agent acknowledges\
    \ the Notify command:\n           200 1500 OK\n   Steps 14-15:\n      The terminating\
    \ gateway detects the V.21 fax preamble.\n      The terminating gateway is using\
    \ the Call Agent controlled T.38\n      strict procedure for fax calls, so the\
    \ \"t38(start)\" event occurs,\n      and a Notify command is sent to the Call\
    \ Agent:\n           NTFY 2500 ds/ds1-1/2@gw-t.whatever.net MGCP 1.0\n       \
    \    O: fxr/t38(start)\n           X: 20\n   Step 16:\n      The Call Agent acknowledges\
    \ the Notify command:\n           200 2500 OK\n   Step 17:\n      The Call Agent\
    \ then instructs the terminating gateway to change to\n      using the \"image/t38\"\
    \ MIME type instead:\n           MDCX 2002 ds/ds1-1/2@gw-t.whatever.net MGCP 1.0\n\
    \           C: 2\n           I: 2\n           L: a:image/t38\n           R: fxr/t38\n\
    \           X: 21\n      Note that the Call Agent is no longer requesting notification\
    \ of\n      the \"gwvbd\" event.\n   Step 18:\n      The terminating gateway sends\
    \ back a success response with its\n      SDP, which also includes the \"image/t38\"\
    \ media description:\n           200 2002 OK\n           v=0\n           o=- 25678\
    \ 753850 IN IP4 192.0.2.2\n           s=-\n           c=IN IP4 192.0.2.2\n   \
    \        t=0 0\n           m=image 1296 udptl t38\n           a=sqn: 0\n     \
    \      a=cdsc: 1 audio RTP/AVP 18 96 97\n           a=cpar: a=rtpmap:96 RED/8000\n\
    \           a=cpar: a=fmtp:96 97/97\n           a=cpar: a=rtpmap:97 PCMU/8000\n\
    \           a=cpar: a=gpmd:97 vbd=yes\n           a=cdsc: 4 image udptl t38\n\
    \      The gwvbd procedure ends due to the media type change.  The\n      \"gwvbd(stop)\"\
    \ event notification would normally be sent at this\n      point; however, the\
    \ Call Agent is no longer requesting\n      notification of the \"gwvbd\" event.\
    \  The Call Agent would have\n      inferred from the \"t38(start)\" event that\
    \ the gwvbd procedure\n      ended.\n   Step 19:\n      The terminating Call Agent\
    \ sends a re-INVITE to the originating\n      Call Agent with the updated SDP.\n\
    \   Step 20:\n      The originating Call Agent then sends a ModifyConnection command\n\
    \      to the originating gateway:\n           MDCX 1003 ds/ds1-1/1@gw-o.whatever.net\
    \ MGCP 1.0\n           C: 1\n           I: 1\n           R: fxr/t38\n        \
    \   X: 2\n           v=0\n           o=- 25678 753850 IN IP4 192.0.2.2\n     \
    \      s=-\n           c=IN IP4 192.0.2.2\n           t=0 0\n           m=image\
    \ 1296 udptl t38\n           a=sqn: 0\n           a=cdsc: 1 audio RTP/AVP 18 96\
    \ 97\n           a=cpar: a=rtpmap:96 RED/8000\n           a=cpar: a=fmtp:96 97/97\n\
    \           a=cpar: a=rtpmap:97 PCMU/8000\n           a=cpar: a=gpmd:97 vbd=yes\n\
    \           a=cdsc: 4 image udptl t38\n   Step 21:\n      The originating gateway\
    \ changes to T.38 and sends back a success\n      response with the updated SDP:\n\
    \           200 1003 OK\n           v=0\n           o=- 25678 753850 IN IP4 192.0.2.1\n\
    \           s=-\n           c=IN IP4 192.0.2.1\n           t=0 0\n           m=image\
    \ 3456 udptl t38\n           a=sqn: 0\n           a=cdsc: 1 audio RTP/AVP 18 96\
    \ 97\n           a=cpar: a=rtpmap:96 RED/8000\n           a=cpar: a=fmtp:96 97/97\n\
    \           a=cpar: a=rtpmap:97 PCMU/8000\n           a=cpar: a=gpmd:97 vbd=yes\n\
    \           a=cdsc: 4 image udptl t38\n      Again, the gwvbd procedure ends due\
    \ to the media type change.  The\n      \"gwvbd(stop)\" event notification would\
    \ normally be sent at this\n      point; however, the Call Agent is no longer\
    \ requesting\n      notification of the \"gwvbd\" event.\n   Step 22:\n      The\
    \ originating Call Agent sends a SIP 200 OK response with the\n      updated SDP\
    \ to the terminating Call Agent, which in turn sends a\n      SIP ACK (not shown).\n\
    \   Step 23:\n      The terminating Call Agent sends a ModifyConnection with the\n\
    \      updated SDP to the terminating gateway:\n           MDCX 2002 ds/ds1-1/2@gw-t.whatever.net\
    \ MGCP 1.0\n           C: 2\n           I: 2\n           v=0\n           o=- 25678\
    \ 753850 IN IP4 192.0.2.1\n           s=-\n           c=IN IP4 192.0.2.1\n   \
    \        t=0 0\n           m=image 3456 udptl t38\n           a=sqn: 0\n     \
    \      a=cdsc: 1 audio RTP/AVP 18 96 97\n           a=cpar: a=rtpmap:96 RED/8000\n\
    \           a=cpar: a=fmtp:96 97/97\n           a=cpar: a=rtpmap:97 PCMU/8000\n\
    \           a=cpar: a=gpmd:97 vbd=yes\n           a=cdsc: 4 image udptl t38\n\
    \   Steps 24-32:\n      These steps correspond to the Call Agent controlled T.38\
    \ strict\n      procedure as defined in the MGCP Fax (FXR) package [RFC5347].\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   This document defines two new packages, both\
    \ of which have security\n   considerations in two areas:\n   1.  MGCP signaling\
    \ message security\n   2.  Media stream security\n   From an MGCP signaling security\
    \ point of view, the MGCP VBD and GPMD\n   packages define extensions to the basic\
    \ MGCP signaling specification\n   in accordance with the procedures specified\
    \ in MGCP [RFC3435], and\n   hence the MGCP signaling security considerations\
    \ and recommendations\n   provided in Section 5 of [RFC3435] (namely the use of\
    \ IPsec) apply\n   here as well.  Lack of MGCP signaling integrity protection\
    \ can in\n   general be detrimental to any use of MGCP, and the two packages\n\
    \   defined here do not change that.  From a confidentiality point of\n   view,\
    \ the VBD package is not believed to convey any vulnerable or\n   privacy-sensitive\
    \ information.  The GPMD package is slightly\n   different inasmuch as it does\
    \ not define any specific parameters that\n   are believed to require confidentiality;\
    \ however, it is a generic\n   parameter that can carry any codec parameter information,\
    \ and hence\n   it is possible that confidential information is conveyed through\
    \ this\n   parameter.  If confidentiality of any such potential information is\
    \ a\n   concern, confidentiality protection of the MGCP signaling MUST be\n  \
    \ provided as well.  It should be noted that Section 8 of [RFC5406]\n   provides\
    \ considerations for specifying the use of IPsec that are\n   above and beyond\
    \ those provided in [RFC3435]; however, given that the\n   use of IPsec for MGCP\
    \ applies to all of MGCP, and not just the MGCP\n   VBD and GPMD packages, we\
    \ do not specify such additional detail here.\n   From a media stream security\
    \ point of view, the MGCP VBD and GPMD\n   packages again define extensions that\
    \ rely on the general use of\n   media streams defined in MGCP [RFC3435], and\
    \ hence the MGCP media\n   stream security considerations and recommendations\
    \ provided in\n   Section 5.1 of [RFC3435] apply here as well.  Lack of media\
    \ stream\n   security can in general be detrimental to any media stream\n   established\
    \ via MGCP, and the two packages defined here do not change\n   that.  Confidentiality\
    \ concerns apply as for any other media stream.\n   Integrity concerns are further\
    \ compounded by the GPMD package's use\n   of payload type switching, state signaling\
    \ events, and media stream\n   in-band triggers to drive overall Voiceband Data\
    \ operation: Integrity\n   protection with replay protection MUST be used to counter\
    \ these\n   threats.\n   Ideally, there would be a single mandatory-to-implement\
    \ media stream\n   security mechanism to provide this integrity protection, and\
    \ in\n   theory there is, since MGCP [RFC3435] defines a media stream security\n\
    \   mechanism.  However, the standard MGCP media stream security\n   mechanism\
    \ defined in [RFC3435] relies on the encryption key (\"k=\")\n   field defined\
    \ in the original SDP specification [RFC2327], the use of\n   which is no longer\
    \ recommended in the current SDP specification\n   [RFC4566].  In practice, this\
    \ mechanism has also seen very limited\n   implementation, and hence there is\
    \ not much value in relying on it.\n   Still, the integrity protection requirement\
    \ remains, and there are\n   several different ways this can be achieved:\n  \
    \ Secure RTP:   For RTP-based media streams, the use of Secure RTP\n      [RFC3711]\
    \ with an associated key management mechanism is generally\n      preferred at\
    \ the time of this writing; however, such a mechanism\n      has currently not\
    \ been defined for MGCP.\n   PacketCable Security:   The PacketCable Network-Based\
    \ Call Signaling\n      Protocol [NCS] defines another media stream security mechanism\n\
    \      that is generally supported by PacketCable-compliant\n      implementations.\
    \  Implementations targeted for those environments\n      SHOULD implement this\
    \ security mechanism.\n   Lower-Level Security:   In the absence of a common media\
    \ stream\n      security mechanism supported by both endpoints, a lower-level\n\
    \      security mechanism, e.g., IPsec, MUST be used.  Note that since\n     \
    \ there is no inherent MGCP signaling support for such a lower-level\n      security\
    \ mechanism, it MUST be configured by other means.\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   The IANA has registered the following MGCP packages:\n\
    \      Package Title                               Name     Version\n      -------------\
    \                               ----     -------\n      Voiceband Data       \
    \                       VBD      0\n      General-Purpose Media Descriptor Parameter\
    \  GPMD     0\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   Several people have contributed to the development\
    \ of the MGCP VBD\n   and GPMD packages and the use of the MIME subtypes \"RED\"\
    \ and\n   \"parityfec\" with the FM package for VBD with redundancy and FEC. \
    \ In\n   particular, the authors would like to thank Flemming Andreasen, John\n\
    \   Atkinson, Bill Foster, and the CableLabs PacketCable TGCP/NCS focus\n   team\
    \ for their contributions.  Many thanks to Billy Hare for doing a\n   thorough\
    \ review of this document.\n   Joe Stone and Rajesh Kumar are the main authors\
    \ of this document;\n   security considerations and final editor role were provided\
    \ by\n   Flemming Andreasen.  Sandeep Sharma was editor on earlier versions of\n\
    \   the document.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [H2482]    International Telecommunication Union\
    \ - Telecommunication\n              Standardization Sector, \"Gateway control\
    \ protocol:\n              Facsimile, text conversation and call discrimination\n\
    \              packages\", ITU-T Recommendation H.248.2, November 2000.\n   [NCS]\
    \      CableLabs(R), \"PacketCable(TM) 1.5 Specifications:\n              Network-Based\
    \ Call Signaling Protocol, PKT-SP-NCS1.5-I03-\n              070412\", April 2007.\n\
    \   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n        \
    \      Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2198]  Perkins,\
    \ C., Kouvelas, I., Hodson, O., Hardman, V.,\n              Handley, M., Bolot,\
    \ J., Vega-Garcia, A., and S. Fosse-\n              Parisis, \"RTP Payload for\
    \ Redundant Audio Data\", RFC 2198,\n              September 1997.\n   [RFC3407]\
    \  Andreasen, F., \"Session Description Protocol (SDP) Simple\n              Capability\
    \ Declaration\", RFC 3407, October 2002.\n   [RFC3435]  Andreasen, F. and B. Foster,\
    \ \"Media Gateway Control\n              Protocol (MGCP) Version 1.0\", RFC 3435,\
    \ January 2003.\n   [RFC3550]  Schulzrinne, H., Casner, S., Frederick, R., and\
    \ V.\n              Jacobson, \"RTP: A Transport Protocol for Real-Time\n    \
    \          Applications\", STD 64, RFC 3550, July 2003.\n   [RFC3660]  Foster,\
    \ B. and F. Andreasen, \"Basic Media Gateway Control\n              Protocol (MGCP)\
    \ Packages\", RFC 3660, December 2003.\n   [RFC4566]  Handley, M., Jacobson, V.,\
    \ and C. Perkins, \"SDP: Session\n              Description Protocol\", RFC 4566,\
    \ July 2006.\n   [RFC4733]  Schulzrinne, H. and T. Taylor, \"RTP Payload for DTMF\n\
    \              Digits, Telephony Tones, and Telephony Signals\", RFC 4733,\n \
    \             December 2006.\n   [RFC4734]  Schulzrinne, H. and T. Taylor, \"\
    Definition of Events for\n              Modem, Fax, and Text Telephony Signals\"\
    , RFC 4734,\n              December 2006.\n   [RFC5109]  Li, A., Ed., \"RTP Payload\
    \ Format for Generic Forward Error\n              Correction\", RFC 5109, December\
    \ 2007.\n   [RFC5234]  Crocker, D., Ed., and P. Overell, \"Augmented BNF for\n\
    \              Syntax Specifications: ABNF\", STD 68, RFC 5234,\n            \
    \  January 2008.\n   [RFC5347]  Andreasen, F. and D. Hancock, \"Media Gateway\
    \ Control\n              Protocol Fax Package\", RFC 5347, October 2008.\n   [V1501]\
    \    International Telecommunication Union - Telecommunication\n             \
    \ Standardization Sector, \"Modem-over-IP networks:\n              Procedures\
    \ for the end-to-end connection of V-series\n              DCEs\", ITU-T Recommendation\
    \ V.150.1, January 2003.\n   [V1501A1]  International Telecommunication Union\
    \ - Telecommunication\n              Standardization Sector, \"Modem-over-IP networks:\n\
    \              Procedures for the end-to-end connection of V-series DCEs,\n  \
    \            Amendment 1: Modification to SSE reason identifier codes\n      \
    \        to support voice band data and text relay\",\n              ITU-T Recommendation\
    \ V.150.1 Amendment 1, January 2005.\n   [V152]     International Telecommunication\
    \ Union - Telecommunication\n              Standardization Sector, \"Procedures\
    \ for supporting Voice-\n              Band Data over IP Networks\", ITU-T Recommendation\
    \ V.152,\n              January 2005.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [RFC2327]  Handley, M. and V. Jacobson, \"\
    SDP: Session Description\n              Protocol\", RFC 2327, April 1998.\n  \
    \ [RFC3261]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,\n      \
    \        A., Peterson, J., Sparks, R., Handley, M., and E.\n              Schooler,\
    \ \"SIP: Session Initiation Protocol\", RFC 3261,\n              June 2002.\n\
    \   [RFC3711]  Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K.\n   \
    \           Norrman, \"The Secure Real-time Transport Protocol (SRTP)\",\n   \
    \           RFC 3711, March 2004.\n   [RFC5406]  Bellovin, S., \"Guidelines for\
    \ Specifying the Use of IPsec\n              Version 2\", BCP 146, RFC 5406, February\
    \ 2009.\n   [T38]      International Telecommunication Union - Telecommunication\n\
    \              Standardization Sector, \"Procedures for real-time Group 3\n  \
    \            facsimile communication over IP networks\",\n              ITU-T\
    \ Recommendation T.38, April 2004.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Joe Stone\n   Cisco Systems\n   2200 East President George\
    \ Bush Highway\n   Richardson, TX  75082\n   USA\n   EMail: joestone@cisco.com\n\
    \   URI:   http://www.cisco.com/\n   Rajesh Kumar\n   Cisco Systems\n   Mail Stop\
    \ SJCE/1/1\n   190 West Tasman Drive\n   San Jose, CA  95134\n   USA\n   EMail:\
    \ rkumar@cisco.com\n   URI:   http://www.cisco.com/\n   Flemming Andreasen\n \
    \  Cisco Systems\n   Iselin, NJ  08830\n   USA\n   EMail: fandreas@cisco.com\n\
    \   URI:   http://www.cisco.com/\n"
