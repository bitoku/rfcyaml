- title: __initial_text__
  contents:
  - '            Control of Service Context using SIP Request-URI

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2001).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This memo provides information for the Internet community.  It\n\
    \   describes a useful way to conceptualize the use of the standard SIP\n   (Session\
    \ Initiation Protocol) Request-URI (Uniform Resource\n   Identifier) that the\
    \ authors and many members of the SIP community\n   think is suitable as a convention.\
    \  It does not define any new\n   protocol with respect to RFC 2543.\n   In a\
    \ conventional telephony environment, extended service\n   applications often\
    \ use call state information, such as calling party,\n   called party, reason\
    \ for forward, etc, to infer application context.\n   In a SIP/2.0 call, much\
    \ of this information may be either non-\n   existent or unreliable.  This document\
    \ proposes a mechanism to\n   communicate context information to an application.\
    \  Under this\n   proposal, a client or proxy can communicate context through\
    \ the use\n   of a distinctive Request-URI.  This document continues with examples\n\
    \   of how this mechanism could be used in a voice mail application.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.      Introduction . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n   2.      Example Application  . . . . . . . . . . . . . .\
    \ . . . . .  3\n   2.1     Using URIs to Control Voice Mail Service Behavior \
    \ . . . .  3\n   3.      Voice Mail Scenario Descriptions . . . . . . . . . .\
    \ . . .  5\n   3.1     Deposits . . . . . . . . . . . . . . . . . . . . . . .\
    \ . .  5\n   3.1.1   Direct Request to Deposit to a particular mailbox  . . .\
    \ .  5\n   3.1.1.1 SIP source . . . . . . . . . . . . . . . . . . . . . . . .\
    \  5\n   3.1.1.2 Arbitrary PSTN source  . . . . . . . . . . . . . . . . . .  5\n\
    \   3.1.1.3 Recognized PSTN source . . . . . . . . . . . . . . . . . .  6\n  \
    \ 3.1.2   Direct Request to Deposit, mailbox to be determined  . . .  6\n   3.1.2.1\
    \ SIP source . . . . . . . . . . . . . . . . . . . . . . . .  6\n   3.1.2.2 PSTN\
    \ source  . . . . . . . . . . . . . . . . . . . . . . .  6\n   3.1.2.3 Indirect\
    \ Request to Deposit, due to find-me proxy decision  6\n   3.2     Retrievals\
    \ . . . . . . . . . . . . . . . . . . . . . . . .  7\n   3.2.1   Request to Retrieve\
    \ from a particular mailbox  . . . . . .  7\n   3.2.1.1 Trusted SIP source . .\
    \ . . . . . . . . . . . . . . . . . .  7\n   3.2.1.2 Authenticated SIP source\
    \ . . . . . . . . . . . . . . . . .  7\n   3.2.1.3 Unauthenticated SIP source\
    \ . . . . . . . . . . . . . . . .  7\n   3.2.1.4 PSTN source  . . . . . . . .\
    \ . . . . . . . . . . . . . . .  7\n   3.2.2   Request to Retrieve, mailbox to\
    \ be determined  . . . . . .  7\n   3.2.2.1 SIP source . . . . . . . . . . . .\
    \ . . . . . . . . . . . .  7\n   3.2.2.2 Arbitrary PSTN source  . . . . . . .\
    \ . . . . . . . . . . .  8\n   3.2.2.3 Recognized PSTN source . . . . . . . .\
    \ . . . . . . . . . .  8\n   4.      Voice Mail Call Flow Examples  . . . . .\
    \ . . . . . . . . .  8\n   4.1     Generic Scenario . . . . . . . . . . . . .\
    \ . . . . . . . .  8\n   4.1.1   Direct call to the voice mail system . . . .\
    \ . . . . . . .  8\n   4.2     Message Deposit Scenarios  . . . . . . . . . .\
    \ . . . . . . 13\n   4.2.1   Call to known subscriber forwarded on no answer \
    \ . . . . . 13\n   4.2.2   Call to known subscriber forwarded on busy . . . .\
    \ . . . . 19\n   4.2.3   Direct call to a subscriber's mailbox  . . . . . . .\
    \ . . . 24\n   4.3     Message Retrieval Scenarios  . . . . . . . . . . . . .\
    \ . . 29\n   4.3.1   Call to retrieve messages believed to be from a known\n \
    \          subscriber . . . . . . . . . . . . . . . . . . . . . . . . 29\n   4.3.2\
    \   Call to retrieve messages from an authenticated subscriber 33\n   5.     \
    \ Security Considerations  . . . . . . . . . . . . . . . . . 38\n   6.      Acknowledgments\
    \  . . . . . . . . . . . . . . . . . . . . . 38\n           References . . . .\
    \ . . . . . . . . . . . . . . . . . . . . 38\n           Authors' Addresses .\
    \ . . . . . . . . . . . . . . . . . . . 38\n           Full Copyright Statement\
    \ . . . . . . . . . . . . . . . . . 39\n"
- title: 1. Introduction
  contents:
  - "1. Introduction\n   A communication service should make use of the information\
    \ it has at\n   hand when being accessed.  For example, in most current voice\
    \ mail\n   implementations, a subscriber retrieving messages from his own desk\n\
    \   does not have to reenter his voice mailbox number - the service\n   assumes\
    \ that the store being accessed is the one associated with the\n   endpoint being\
    \ used to access the service.  Some services allow the\n   user to validate this\
    \ assumption using IVR techniques before\n   prompting for a PIN.\n   This concept\
    \ of context-awareness can be captured in a voice mail\n   service implementing\
    \ SIP as defined in RFC 2543[1], without\n   modification, through the standard\
    \ use of that protocol's Request-\n   URI.  Furthermore, the concept is applicable\
    \ to any SIP-based service\n   where initial application state should be determined\
    \ from context.\n   This concept is a usage convention of standard SIP as defined\
    \ in RFC\n   2543[1] and does not modify or extend that protocol in any way.\n"
- title: 2. Example Application
  contents:
  - "2. Example Application\n   In this document, we use the example of voice mail\
    \ to illustrate the\n   technique.  One motivation for applying this technique\
    \ to this\n   problem is allowing a proxy or location server to control the initial\n\
    \   state of a voice service.  For example, a voice client might register\n  \
    \ a contact list ending with the URL that would accept voice messages\n   for\
    \ the client.\n"
- title: 2.1 Using URIs to Control Voice Mail Service Behavior
  contents:
  - "2.1 Using URIs to Control Voice Mail Service Behavior\n   Many conventional voice\
    \ mail systems use call state information, such\n   as the calling party, called\
    \ party, reason for forward, etc, to\n   decide the initial application state.\
    \  For example, it might play one\n   outgoing message if the call reached voice\
    \ mail because the called\n   party did not answer and another if the line was\
    \ busy.  It decides\n   whom the message is for based on the called party information.\
    \  If\n   the call originated from a subscriber's phone number, it might\n   authenticate\
    \ the caller and then go directly to the message retrieval\n   and account maintenance\
    \ menu.\n   When a new subscriber is added to a system, a set of identities could\n\
    \   be generated, each given a unique sip URI.  The following tables show\n  \
    \ some of the identities that might be generated (it is not\n   exhaustive). \
    \ The example schemes show that the URIs could, but don't\n   necessarily have\
    \ to, have mnemonic value.\n   In practical applications, it is important that\
    \ an application does\n   not apply semantic rules to the various URIs.  Instead,\
    \ it should\n   allow any arbitrary string to be provisioned, and map the string\
    \ to\n   the desired behavior.  The owner of the system may choose to\n   provision\
    \ mnemonic strings, but the application should not require\n   it.  In any large\
    \ installation, the system owner is likely to have\n   pre-existing rules for\
    \ mnemonic URIs, and any attempt by an\n   application to define its own rules\
    \ may create a conflict.  For our\n   example, this means a voice mail system\
    \ should allow an arbitrary mix\n   of URLs from these schemes, or any other scheme\
    \ that renders valid\n   SIP URIs to be provisioned, rather than enforce one particular\n\
    \   scheme.\n      URI Identity       Example Scheme 1\n                     \
    \         Example Scheme 2\n                                   Example Scheme\
    \ 3\n      Deposit with       sip:sub-rjs-deposit@vm.wcom.com\n      standard\
    \ greeting       sip:677283@vm.wcom.com\n                                   sip:rjs@vm.wcom.com;mode=deposit\n\
    \      Deposit with on    sip:sub-rjs-deposit-busy.vm.wcom.com\n      phone greeting\
    \          sip:677372@vm.wcom.com\n                                   sip:rjs@vm.wcom.com;mode=3991243\n\
    \      Deposit with       sip:sub-rjs-deposit-sg@vm.wcom.com\n      special greeting\
    \        sip:677384@vm.wcom.com\n                                   sip:rjs@vm.wcom.com;mode=sg\n\
    \      Retrieve - SIP     sip:sub-rjs-retrieve@vm.wcom.com\n      authentication\
    \          sip:677405@vm.wcom.com\n                                   sip:rjs@vm.wcom.com;mode=retrieve\n\
    \      Retrieve - prompt  sip:sub-rjs-retrieve-inpin.vm.wcom.com\n      for PIN\
    \ in-band         sip:677415@vm.wcom.com\n                                   sip:rjs@vm.wcom.com;mode=inpin\n\
    \   When a service is first set up, identities such as the following\n   could\
    \ be created.\n      URI Identity       Example Scheme 1\n                   \
    \           Example Scheme 2\n                                   Example Scheme\
    \ 3\n      Deposit -          sip:deposit@vm.wcom.com\n      identify target \
    \        sip:670001@vm.wcom.com\n      mailbox by To:               sip:deposit@vm.wcom.com\n\
    \      Retrieve -         sip:retrieve@vm.wcom.com\n      identify target    \
    \     sip:670002@vm.wcom.com\n      mailbox by SIP               sip:retrieve@vm.wcom.com\n\
    \      authentication\n      Deposit - prompt   sip:deposit-in@vm.wcom.com\n \
    \     for target              sip:670003@vm.wcom.com\n      mailbox in-band  \
    \            sip:deposit@vm.wcom.com;mode=inband\n      Retrieve - prompt  sip:retrieve-in@vm.wcom.com\n\
    \      for target              sip:670004@vm.wcom.com\n      mailbox and PIN \
    \             sip:retrieve@vm.wcom.com;mode=inband\n      in-band\n   In addition\
    \ to providing this set of URIs to the subscriber (to use\n   as he sees fit),\
    \ an integrated service provider could add these to\n   the set of contacts in\
    \ a find-me proxy.  The proxy could then route\n   calls to the appropriate URI\
    \ based on the origin of the request, the\n   subscriber's preferences and current\
    \ state.\n"
- title: 3. Voice Mail Scenario Descriptions
  contents:
  - "3. Voice Mail Scenario Descriptions\n   In each of these scenarios, the PSTN\
    \ gateway is configured to\n   communicate only with a particular proxy-registrar.\n"
- title: 3.1 Deposits
  contents:
  - '3.1 Deposits

    '
- title: 3.1.1 Direct Request to Deposit to a particular mailbox
  contents:
  - '3.1.1 Direct Request to Deposit to a particular mailbox

    '
- title: 3.1.1.1 SIP source
  contents:
  - "3.1.1.1 SIP source\n   A SIP client that knew the URI for a particular deposit\
    \ mailbox\n   (sip:sub-rjs-deposit@vm.wcom.com) could place a direct invitation\
    \ to\n   the voicemail service, or through a protecting proxy.  The proxy\n  \
    \ could restrict access to deposit identities with special greetings by\n   authenticating\
    \ the requester.\n"
- title: 3.1.1.2 Arbitrary PSTN source
  contents:
  - "3.1.1.2 Arbitrary PSTN source\n   The gateway's proxy would map a call from an\
    \ unrecognized PSTN number\n   to a number associated with a subscriber's mailbox\
    \ into an invite to\n   the deposit with standard greeting URI (sip:sub-rjs-\n\
    \   deposit@vm.wcom.com).\n"
- title: 3.1.1.3 Recognized PSTN source
  contents:
  - "3.1.1.3 Recognized PSTN source\n   The gateway's proxy would map a call from\
    \ a recognized (exact or\n   pattern match) PSTN number to a number associated\
    \ with a subscriber's\n   mailbox into an invite to the appropriate special greeting\
    \ URI\n   (sip:sub-rjs-deposit-sg@vm.wcom.com).  The gateway's ability to\n  \
    \ identify the calling party (using calling party number) is trusted,\n   so no\
    \ further authentication of the requester is performed.\n"
- title: 3.1.2 Direct Request to Deposit, mailbox to be determined
  contents:
  - '3.1.2 Direct Request to Deposit, mailbox to be determined

    '
- title: 3.1.2.1 SIP source
  contents:
  - "3.1.2.1 SIP source\n   A voice mail service or its protecting proxy could expose\
    \ a generic\n   deposit URL for use when a caller wished to go directly to voice\n\
    \   mail.  The service would likely play an IVR dialog to determine what\n   message\
    \ store to deposit a message into.\n   An application designer may be tempted\
    \ to attempt to match the To:\n   and From: headers on a call to infer information.\
    \  However, this\n   approach could cause complications when multiple proxy forwards\
    \ occur\n   in a call.  For example, A calls B, who has all calls forwarded to\
    \ C.\n   C forwards the call to her voice mail service.  If the voice mail\n \
    \  service matches the To: header to determine the message store, it\n   will\
    \ get the information for B instead of C.  But there is no reason\n   to assume\
    \ that C's voice mail service has any knowledge of B.\n"
- title: 3.1.2.2 PSTN source
  contents:
  - "3.1.2.2 PSTN source\n   The gateway's proxy would map a call from an unrecognized\
    \ PSTN number\n   to the top level voice mail service access number to an invite\
    \ to the\n   Deposit - prompt for target mailbox in-band URI (sip:deposit-\n \
    \  in@vm.wcom.com for example).  Getting the call to the target mailbox\n   would\
    \ proceed as in the SIP source case.\n"
- title: 3.1.2.3 Indirect Request to Deposit, due to find-me proxy decision
  contents:
  - "3.1.2.3 Indirect Request to Deposit, due to find-me proxy decision\n   A find-me\
    \ proxy could map an invitation to a subscriber\n   (sip:rjs@wcom.com) to the\
    \ appropriate voice mail service URI\n   depending on the subscriber's current\
    \ state.  The normal deposit URI\n   could be chosen if the subscriber's contact\
    \ list has been otherwise\n   exhausted with no answer.  The busy-announcement\
    \ URI would be chosen\n   when a busy everywhere response is received from one\
    \ of the contacts.\n   A DND announcement URI could be selected if the subscriber\
    \ had\n   activated DND. Calls to sip:receptionist@wcom.com could be configured\n\
    \   to roll to sip:deposit@wcom.com\n"
- title: 3.2 Retrievals
  contents:
  - '3.2 Retrievals

    '
- title: 3.2.1 Request to Retrieve from a particular mailbox
  contents:
  - '3.2.1 Request to Retrieve from a particular mailbox

    '
- title: 3.2.1.1 Trusted SIP source
  contents:
  - "3.2.1.1 Trusted SIP source\n   A request to retrieve the contents of a particular\
    \ mailbox (sip:sub-\n   rjs-retrieve@vm.wcom.com) coming from a trusted source\
    \ could be\n   honored without further authentication checks.  A trusted source\
    \ is\n   one with which the voice mail service has secure communications, and\n\
    \   to which it is willing to delegate authentication.  This could be the\n  \
    \ service's protecting proxy for example.\n"
- title: 3.2.1.2 Authenticated SIP source
  contents:
  - "3.2.1.2 Authenticated SIP source\n   A service, or its protecting proxy, could\
    \ choose to honor a retrieve\n   request for a particular mailbox (sip:sub-rjs-retrieve@vm.wcom.com)\n\
    \   based on SIP authentication.  If SIP level authentication failed, the\n  \
    \ service or proxy could be configured to send the call to the in-band\n   pin\
    \ prompting URI (sip:sub-rjs-retrieve-inpin@vm.wcom.com).\n"
- title: 3.2.1.3 Unauthenticated SIP source
  contents:
  - "3.2.1.3 Unauthenticated SIP source\n   A service, or its protecting proxy, receiving\
    \ a retrieve request for\n   a particular mailbox (sip:sub-rjs-retrieve@vm.wcom.com)\
    \ with no other\n   method of authenticating the requestor could send the request\
    \ to the\n   in-band pin prompting URI (sip:sub-rjs-retrieve-inpin@vm.wcom.com).\n"
- title: 3.2.1.4 PSTN source
  contents:
  - "3.2.1.4 PSTN source\n   This scenario assumes that the service provider's network\
    \ has been\n   configured such that a PSTN number could be dialed explicitly for\n\
    \   retrieving messages from a particular mailbox.  Such services\n   currently\
    \ exist, but are not common.  In such a network, the\n   gateway's proxy would\
    \ map the call to the in-band pin prompting URI\n   (sip:sub-rjs-retrieve-inpin@vm.wcom.com).\n"
- title: 3.2.2 Request to Retrieve, mailbox to be determined
  contents:
  - '3.2.2 Request to Retrieve, mailbox to be determined

    '
- title: 3.2.2.1 SIP source
  contents:
  - "3.2.2.1 SIP source\n   As in the Request to Deposit scenario, when a service\
    \ receives a\n   request for the top level retrieve URI it would most likely need\
    \ to\n   use in-band IVR techniques to determine the target mailbox and\n   authenticate\
    \ the caller.\n"
- title: 3.2.2.2 Arbitrary PSTN source
  contents:
  - "3.2.2.2 Arbitrary PSTN source\n   This scenario assumes there is a single PSTN\
    \ number that subscribers\n   dial to access the voice mail service to retrieve\
    \ messages.  This is\n   the most common access method provided by current voice\
    \ mail\n   services.\n   The gateway's proxy would map a call to the top level\
    \ PSTN number to\n   the top level retrieve in-band prompting URI (sip:retrieve-\n\
    \   in@vm.wcom.com).  Once the system identifies the target mailbox, the\n   call\
    \ would be transferred to the appropriate in-band pin prompting\n   URI (sip:sub-rjs-retrieve-inpin@vm.wcom.com).\n"
- title: 3.2.2.3 Recognized PSTN source
  contents:
  - "3.2.2.3 Recognized PSTN source\n   This scenario also assumes there is a single\
    \ PSTN number that\n   subscribers dial to access the voice mail service to retrieve\n\
    \   messages.\n   The gateway's proxy would recognize the calling party number\
    \ as a\n   subscriber, and map the call to the subscriber's in-band prompting\n\
    \   URI (sip:sub-rjs-retrieve-inpin@vm.wcom.com)\n"
- title: 4. Voice Mail Call Flow Examples
  contents:
  - "4. Voice Mail Call Flow Examples\n   The following section describes some example\
    \ call flows for a\n   hypothetical voice mail service, with the host name of\
    \ vm.wcom.com.\n   All the call flows assume that a proxy protects the voice mail\n\
    \   service and that a trust relationship exists between the voice mail\n   service\
    \ and the proxy.\n"
- title: 4.1 Generic Scenario
  contents:
  - '4.1 Generic Scenario

    '
- title: 4.1.1 Direct call to the voice mail system
  contents:
  - "4.1.1 Direct call to the voice mail system\n   User A calls the voice mail system\
    \ directly.  The voice mail system\n   invokes the top-level menu, which might\
    \ prompt the caller for an\n   extension or the first few letters of a name.\n\
    \            User A              Proxy               VM Service\n            \
    \  |                   |                       |\n              |  INVITE F1 \
    \       |                       |\n              |------------------>|       \
    \                |\n              |                   |  INVITE F2           \
    \ |\n              | (100 Trying) F3   |---------------------->|\n           \
    \   |<------------------|                       |\n              |           \
    \        |  180 Ringing F4       |\n              |  180 Ringing F5   |<----------------------|\n\
    \              |<------------------|                       |\n              |\
    \                   |  200 OK F6            |\n              |  200 OK F6    \
    \    |<----------------------|\n              |<------------------|          \
    \             |\n              |                   |                       |\n\
    \              |  ACK F8           |                       |\n              |------------------>|\
    \  ACK F9               |\n              |                   |---------------------->|\n\
    \              |                   |                       |\n              |\
    \      RTP Established- Play top level menu |\n              |<-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m->|\n\
    \              |                   |                       |\n              |\
    \  BYE F10          |                       |\n              |------------------>|\
    \  BYE F11              |\n              |                   |---------------------->|\n\
    \              |                   |                       |\n              |\
    \                   |  200 OK F12           |\n              |               \
    \    |<----------------------|\n              |  200 OK F13       |          \
    \             |\n              |<------------------|                       |\n\
    \              |                   |                       |\n     Flow Id   \
    \                         Comments\n    INVITE F1     INVITE sip:VoiceMail@wcom.com\
    \ SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                \
    \  From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Proxy-Authorization:Digest username=\"UserA\",\n                  realm=\"MCI\
    \ WorldCom SIP\",\n                  nonce=\"ea9c8e88df84f1cc4e341ae6cbe5a359\"\
    , opaque=\"\",\n                  uri=\"sip:VoiceMail@wcom.com\", response=<appropriately\n\
    \                  calculated hash goes here>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserA 2890844526 2890844526 IN IP4 client.here.com\n\
    \                  s=Session SDP\n                  c=IN IP4 100.101.102.103\n\
    \                  t=0 0\n                  m=audio 49170 RTP/AVP 0\n        \
    \          a=rtpmap:0 PCMU/8000\n                  /*Client for A prepares to\
    \ receive data on port 49170\n                  from the network. */\n    INVITE\
    \ F2     INVITE sip:top@vm.wcom.com SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP\
    \ wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  Record-Route: <sip:VoiceMail@wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Content-Type: application/sdp\n                  Content-Length: <appropriate\
    \ value>\n                  v=0\n                  o=UserA 2890844526 2890844526\
    \ IN IP4 client.here.com\n                  s=Session SDP\n                  c=IN\
    \ IP4 100.101.102.103\n                  t=0 0\n                  m=audio 49170\
    \ RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    (100 Trying   SIP/2.0\
    \ 100 Trying\n    F3            Via: SIP/2.0/UDP here.com:5060\n    Proxy->A)\
    \     From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Content-Length: 0\n    180 Ringing   SIP/2.0 180 Ringing\n\
    \    F4            Via: SIP/2.0/UDP wcom.com:5060; branch=1\n    VM->Proxy   \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n      \
    \            Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n  \
    \                Content-Length: 0\n    180 Ringing   SIP/2.0 180 Ringing\n  \
    \  F5            Via: SIP/2.0/UDP here.com:5060\n    Proxy->A      From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Content-Length: 0\n    200 OK F6     SIP/2.0 200 OK\n    VM->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP\
    \ here.com:5060\n                  Record-Route: <sip:VoiceMail@wcom.com>\n  \
    \                From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail\
    \ <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact: VoiceMailSystem\
    \ <sip:top@vm.wcom.com>\n                  Content-Type: application/sdp\n   \
    \               Content-Length: <appropriate value>\n                  v=0\n \
    \                 o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n         \
    \         s=Session SDP\n                  c=IN IP4 110.111.112.114\n        \
    \          t=0 0\n                  m=audio 3456 RTP/AVP 0\n                 \
    \ a=rtpmap:0 PCMU/8000\n    200 OK F7     SIP/2.0 200 OK\n    Proxy->A      Via:\
    \ SIP/2.0/UDP here.com:5060\n                  Record-Route: <sip:VoiceMail@wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact VoiceMailSystem <sip:top@vm.wcom.com>\n\
    \                  Content-Type: application/sdp\n                  Content-Length:\
    \ <appropriate value>\n                  v=0\n                  o=UserB 2890844527\
    \ 2890844527 IN IP4 vm.wcom.com\n                  s=Session SDP\n           \
    \       c=IN IP4 110.111.112.114\n                  t=0 0\n                  m=audio\
    \ 3456 RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    ACK F8        ACK\
    \ sip:VoiceMail@wcom.com SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n\
    \                  Route:<sip:top@vm.wcom.com>\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 ACK\n\
    \                  Content-Length: 0\n    ACK F9        ACK sip:top@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060\n                \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: VoiceMail <sip:VoiceMail@wcom.com>; tag=3145678\n     \
    \             Call-Id: 12345600@here.com\n                  CSeq: 1 ACK\n    \
    \              Content-Length: 0\n                  /* RTP streams are established\
    \ between A and VM.  VM\n                  system starts IVR dialog for top level\
    \ menu */\n                  /* User A Hangs Up with VM system.  Alternatively,\
    \ the\n                  VM system could initiate the BYE*/\n    BYE F10     \
    \  BYE sip:VoiceMail@wcom.com SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n\
    \                  Route:<sip: top@vm.wcom.com>\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    BYE F11       BYE sip: top@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060\n                \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n      \
    \            Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n     \
    \             Content-Length: 0\n    200 OK F12    SIP/2.0 200 OK\n    VM->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    200 OK\
    \ F13    SIP/2.0 200 OK\n    Proxy->A      Via: SIP/2.0/UDP here.com:5060\n  \
    \                From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail\
    \ <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq:  2 BYE\n                  Content-Length: 0\n"
- title: 4.2 Message Deposit Scenarios
  contents:
  - '4.2 Message Deposit Scenarios

    '
- title: 4.2.1 Call to known subscriber forwarded on no answer
  contents:
  - "4.2.1 Call to known subscriber forwarded on no answer\n   User A attempts to\
    \ call UserB, who does not answer.  The call is\n   forwarded to UserB's mailbox,\
    \ and the voice mail system plays UserB's\n   outgoing message for a ring-no-answer.\
    \  The flow assumes that the URL\n   of \"sip:UserB-dep-fna@vm.wcom.com maps\"\
    \ to the desired behavior for\n   depositing a message on a forward-no-answer.\n\
    \      User A            Proxy              User B         VM System\n       \
    \ |                 |                  |                |\n        |  INVITE F1\
    \      |                  |                |\n        |---------------->|  INVITE\
    \ F2       |                |\n        |                 |----------------->|\
    \                |\n        | (100 Trying) F3 |                  |           \
    \     |\n        |<----------------| 180 Ringing F4   |                |\n   \
    \     |                 |<-----------------|                |\n        |  180\
    \ Ringing F5 |                  |                |\n        |<----------------|\
    \ (Request Timeout)|                |\n        |                 |           \
    \       |                |\n        |                 | Cancel F6        |   \
    \             |\n        |                 |----------------->|              \
    \  |\n        |                 |                  |                |\n      \
    \  |                 | 200 OK F7        |                |\n        |        \
    \         |<-----------------|                |\n        |                 | \
    \                 |                |\n        |                 |         INVITE\
    \ F8                 |\n        |                 |---------------------------------->|\n\
    \        |                 |                  |                |\n        |  \
    \               |         200 OK F9|                |\n        |  200 OK F10 \
    \    |<----------------------------------|\n        |<----------------|      \
    \            |                |\n        |                 |                 \
    \ |                |\n        |  ACK F11        |                  |         \
    \       |\n        |---------------->|         ACK F12  |                |\n \
    \       |                 |---------------------------------->|\n        |   \
    \              |                  |                |\n        |    RTP Established\
    \ Both Ways-Deposit Msg for B      |\n        |<-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m->|\n\
    \        |                 |                  |                |\n        |  BYE\
    \ F13        |                  |                |\n        |---------------->|\
    \         BYE F14  |                |\n        |                 |---------------------------------->|\n\
    \        |                 |                  |                |\n        |  \
    \               |         OK F15   |                |\n        |  OK F16     \
    \    |<----------------------------------|\n        |<----------------|      \
    \            |                |\n        |                 |                 \
    \ |                |\n     Flow Id                            Comments\n    INVITE\
    \ F1     INVITE sip:UserB@wcom.com SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP\
    \ here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n    \
    \              To: TheLittleGuy <sip:UserB@wcom.com>\n                  Call-Id:\
    \ 12345600@here.com\n                  CSeq: 1 INVITE\n                  Contact:\
    \ TheBigGuy <sip:UserA@here.com>\n                  Proxy-Authorization:Digest\
    \ username=\"UserA\",\n                  realm=\"MCI WorldCom SIP\",\n       \
    \           nonce=\"ea9c8e88df84f1cec4341ae6cbe5a359\", opaque=\"\",\n       \
    \           uri=\"sip:UserB@wcom.com\", response=<appropriately\n            \
    \      calculated hash goes here>\n                  Content-Type: application/sdp\n\
    \                  Content-Length: <appropriate value>\n                  v=0\n\
    \                  o=UserA 2890844526 2890844526 IN IP4 client.here.com\n    \
    \              s=Session SDP\n                  c=IN IP4 100.101.102.103\n   \
    \               t=0 0\n                  m=audio 49170 RTP/AVP 0\n           \
    \       a=rtpmap:0 PCMU/8000\n                  /*Client for A prepares to receive\
    \ data on port 49170\n                  from the network. */\n    INVITE F2  \
    \   INVITE sip:UserB1@somewhere.wcom.com SIP/2.0\n    Proxy->B1     Via: SIP/2.0/UDP\
    \ wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  Record-Route: <sip:UserB@wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Content-Type: application/sdp\n                  Content-Length: <appropriate\
    \ value>\n                  v=0\n                  o=UserA 2890844526 2890844526\
    \ IN IP4 client.here.com\n                  s=Session SDP\n                  c=IN\
    \ IP4 100.101.102.103\n                  t=0 0\n                  m=audio 49170\
    \ RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    (100 Trying   SIP/2.0\
    \ 100 Trying\n    F3            Via: SIP/2.0/UDP here.com:5060\n    Proxy->A)\
    \     From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>\n                  Call-Id: 12345600@here.com\n       \
    \           CSeq: 1 INVITE\n                  Content-Length: 0\n    180 Ringing\
    \   SIP/2.0 180 Ringing\n    F4            Via: SIP/2.0/UDP wcom.com:5060; branch=1\n\
    \    B1->Proxy     Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Content-Length: 0\n    180 Ringing   SIP/2.0 180 Ringing\n\
    \    F5            Via: SIP/2.0/UDP here.com:5060\n    Proxy->A      From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Content-Length: 0\n                  /* B1 rings for 9 seconds,\
    \ this duration is a\n                  configurable parameter in the Proxy Server.\
    \  Proxy\n                  sends Cancel and proceeds down the list of routes,\n\
    \                  eventually hitting the voice mail URI for forward no\n    \
    \              answer */\n    CANCEL F6     CANCEL sip:UserB1@wcom.com SIP/2.0\n\
    \    Proxy->B1     Via: SIP/2.0/UDP wcom.com:5060; branch=1\n                \
    \  From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 CANCEL\n\
    \                  Content-Length: 0\n    200 OK F7     SIP/2.0 200 OK\n    B1->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060; branch=1\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 CANCEL\n\
    \                  Content-Length: 0\n    INVITE F8     INVITE sip:UserB-dep-fna@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060;branch=2\n       \
    \           Via: SIP/2.0/UDP here.com:5060\n                  Record-Route: <sip:UserB@wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuy <sip:UserB@wcom.com>\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact: TheBigGuy <sip:UserA@here.com>\n\
    \                  Content-Type: application/sdp\n                  Content-Length:\
    \ <appropriate value>\n                  v=0\n                  o=UserA 2890844526\
    \ 2890844526 IN IP4 client.here.com\n                  s=Session SDP\n       \
    \           c=IN IP4 100.101.102.103\n                  t=0 0\n              \
    \    m=audio 49170 RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    200\
    \ OK F9     SIP/2.0 200 OK\n    VM->Proxy     Via: SIP/2.0/UDP wcom.com:5060;\
    \ branch=2\n                  Via: SIP/2.0/UDP here.com:5060\n               \
    \   Record-Route: <sip:UserB@wcom.com>\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n        \
    \          Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n    \
    \              Contact: TheLittleGuyVoiceMail <sip:UserB-dep-\n              \
    \    fna@vm.wcom.com>\n                  Content-Type: application/sdp\n     \
    \             Content-Length: <appropriate value>\n                  v=0\n   \
    \               o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n           \
    \       s=Session SDP\n                  c=IN IP4 110.111.112.114\n          \
    \        t=0 0\n                  m=audio 3456 RTP/AVP 0\n                  a=rtpmap:0\
    \ PCMU/8000\n    200 OK F10    SIP/2.0 200 OK\n    Proxy->A      Via: SIP/2.0/UDP\
    \ here.com:5060\n                  Record-Route: <sip:UserB@wcom.com>\n      \
    \            From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>;tag=123456\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact: TheLittleGuyVoiceMail\
    \ <sip:UserB-dep-\n                  fna@vm.wcom.com>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n\
    \                  s=Session SDP\n                  c=IN IP4 110.111.112.114\n\
    \                  t=0 0\n                  m=audio 3456 RTP/AVP 0\n         \
    \         a=rtpmap:0 PCMU/8000\n    ACK F11       ACK sip:UserB@wcom.com SIP/2.0\n\
    \    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                  Route:<sip:\
    \ UserB-dep-fna@vm.wcom.com>\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n        \
    \          Call-Id: 12345600@here.com\n                  CSeq: 1 ACK\n       \
    \           Content-Length: 0\n    ACK F12       ACK sip:UserB-dep-fna@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060\n                \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n        \
    \          Call-Id: 12345600@here.com\n                  CSeq: 1 ACK\n       \
    \           Content-Length: 0\n                  /* RTP streams are established\
    \ between A and B2.  VM\n                  system starts IVR dialog for message-deposit\
    \ on no-\n                  answer for UserB */\n                  /* User A Hangs\
    \ Up with VM system.  Alternatively, the\n                  VM system could initiate\
    \ the BYE*/\n    BYE F13       BYE sip:UserB@wcom.com SIP/2.0\n    A->Proxy  \
    \    Via: SIP/2.0/UDP here.com:5060\n                  Route:<sip: UserB-dep-fna@vm.wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    BYE F14\
    \       BYE sip: UserB-dep-fna@vm.wcom.com SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP\
    \ wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n          \
    \        From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>;tag=123456\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    200 OK\
    \ F15    SIP/2.0 200 OK\n    VM->Proxy     Via: SIP/2.0/UDP wcom.com:5060\n  \
    \                Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    200 OK F16    SIP/2.0 200 OK\n    Proxy->A\
    \      Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n        \
    \          Call-Id: 12345600@here.com\n                  CSeq:  2 BYE\n      \
    \            Content-Length: 0\n"
- title: 4.2.2 Call to known subscriber forwarded on busy
  contents:
  - "4.2.2 Call to known subscriber forwarded on busy\n   User A attempts to call\
    \ UserB, who is busy.  The call is forwarded to\n   UserB's mailbox, and the voice\
    \ mail system plays UserB's outgoing\n   message for a busy.  This flow assumes\
    \ that \"sip:UserB-dep-\n   fb@vm.wcom.com\" maps to UserB's mailbox and the behavior\
    \ of \"deposit\n   message on busy.\"\n      User A            Proxy         \
    \     User B         VM System\n        |                 |                  |\
    \                |\n        |  INVITE F1      |                  |           \
    \     |\n        |---------------->|  INVITE F2       |                |\n   \
    \     |                 |----------------->|                |\n        | (100\
    \ Trying) F3 |                  |                |\n        |<----------------|\
    \ 486 Busy Here F4 |                |\n        |                 |<-----------------|\
    \                |\n        |                 |                  |           \
    \     |\n        |                 |  ACK F5          |                |\n   \
    \     |                 |----------------->|                |\n        |     \
    \            |                  |                |\n        |                \
    \ |         INVITE F6                 |\n        |                 |---------------------------------->|\n\
    \        |                 |                  |                |\n        |  \
    \               |         200 OK F7|                |\n        |  200 OK F8  \
    \    |<----------------------------------|\n        |<----------------|      \
    \            |                |\n        |                 |                 \
    \ |                |\n        |  ACK F9         |                  |         \
    \       |\n        |---------------->|         ACK F10  |                |\n \
    \       |                 |---------------------------------->|\n        |   \
    \              |                  |                |\n        |    RTP Established\
    \ Both Ways-Deposit Msg for B      |\n        |<-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m->|\n\
    \        |                 |                  |                |\n        |  BYE\
    \ F11        |                  |                |\n        |---------------->|\
    \         BYE F12  |                |\n        |                 |---------------------------------->|\n\
    \        |                 |                  |                |\n        |  \
    \               |         OK F13   |                |\n        |  OK F14     \
    \    |<----------------------------------|\n        |<----------------|      \
    \            |                |\n        |                 |                 \
    \ |                |\n     Flow Id                            Comments\n    INVITE\
    \ F1     INVITE sip:UserB@wcom.com SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP\
    \ here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n    \
    \              To: TheLittleGuy <sip:UserB@wcom.com>\n                  Call-Id:\
    \ 12345600@here.com\n                  CSeq: 1 INVITE\n                  Contact:\
    \ TheBigGuy <sip:UserA@here.com>\n                  Proxy-Authorization:Digest\
    \ username=\"UserA\",\n                  realm=\"MCI WorldCom SIP\",\n       \
    \           nonce=\"ea9c8e88df84f1cec4341ae6cbe5a359\", opaque=\"\",\n       \
    \           uri=\"sip:UserB@wcom.com\", response=<appropriately\n            \
    \      calculated hash goes here>\n                  Content-Type: application/sdp\n\
    \                  Content-Length: <appropriate value>\n                  v=0\n\
    \                  o=UserA 2890844526 2890844526 IN IP4 client.here.com\n    \
    \              s=Session SDP\n                  c=IN IP4 100.101.102.103\n   \
    \               t=0 0\n                  m=audio 49170 RTP/AVP 0\n           \
    \       a=rtpmap:0 PCMU/8000\n                  /*Client for A prepares to receive\
    \ data on port 49170\n                  from the network. */\n    INVITE F2  \
    \   INVITE sip:UserB1@somewhere.wcom.com SIP/2.0\n    Proxy->B1     Via: SIP/2.0/UDP\
    \ wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  Record-Route: <sip:UserB@wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Content-Type: application/sdp\n                  Content-Length: <appropriate\
    \ value>\n                  v=0\n                  o=UserA 2890844526 2890844526\
    \ IN IP4 client.here.com\n                  s=Session SDP\n                  c=IN\
    \ IP4 100.101.102.103\n                  t=0 0\n                  m=audio 49170\
    \ RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    (100 Trying   SIP/2.0\
    \ 100 Trying\n    F3            Via: SIP/2.0/UDP here.com:5060\n    Proxy->A)\
    \     From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>\n                  Call-Id: 12345600@here.com\n       \
    \           CSeq: 1 INVITE\n                  Content-Length: 0\n    486 Busy\
    \      SIP/2.0 486 Busy Here\n    Here F4       Via: SIP/2.0/UDP wcom.com:5060;branch=1\n\
    \    B1->Proxy     Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=123456\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Content-Length: 0\n    ACK F5        ACK sip: UserB1@wcom.com\
    \ SIP/2.0\n    Proxy->B      Via: SIP/2.0/UDP wcom.com:5060; branch=1\n      \
    \            From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>;tag=123456\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 ACK\n                  Content-Length: 0\n    INVITE\
    \ F6     INVITE sip:UserB-dep-fb@vm.wcom.com SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP\
    \ wcom.com:5060;branch=2\n                  Via: SIP/2.0/UDP here.com:5060\n \
    \                 Record-Route: <sip:UserB@wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Content-Type: application/sdp\n                  Content-Length: <appropriate\
    \ value>\n                  v=0\n                  o=UserA 2890844526 2890844526\
    \ IN IP4 client.here.com\n                  s=Session SDP\n                  c=IN\
    \ IP4 100.101.102.103\n                  t=0 0\n                  m=audio 49170\
    \ RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    200 OK F7     SIP/2.0\
    \ 200 OK\n    VM->Proxy     Via: SIP/2.0/UDP wcom.com:5060; branch=2\n       \
    \           Via: SIP/2.0/UDP here.com:5060\n                  Record-Route: <sip:UserB@wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact: TheLittleGuyVoiceMail\
    \ <sip:UserB-dep-\n                  fb@vm.wcom.com>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n\
    \                  s=Session SDP\n                  c=IN IP4 110.111.112.114\n\
    \                  t=0 0\n                  m=audio 3456 RTP/AVP 0\n         \
    \         a=rtpmap:0 PCMU/8000\n    200 OK F8     SIP/2.0 200 OK\n    Proxy->A\
    \      Via: SIP/2.0/UDP here.com:5060\n                  Record-Route: <sip:UserB@wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact TheLittleGuyVoiceMail\
    \ <sip:UserB-dep-\n                  fb@vm.wcom.com>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n\
    \                  s=Session SDP\n                  c=IN IP4 110.111.112.114\n\
    \                  t=0 0\n                  m=audio 3456 RTP/AVP 0\n         \
    \         a=rtpmap:0 PCMU/8000\n    ACK F9        ACK sip:UserB@wcom.com SIP/2.0\n\
    \    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                  Route:<sip:UserB-dep-fb@vm.wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 ACK\n                  Content-Length: 0\n    ACK F10\
    \       ACK sip:UserB-dep-fb@vm.wcom.com SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP\
    \ wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n          \
    \        From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 ACK\n                  Content-Length: 0\n        \
    \          /* RTP streams are established between A and B2.  VM\n            \
    \      system starts IVR dialog for message-deposit on busy\n                \
    \  for UserB */\n                  /* User A Hangs Up with VM system.  Alternatively,\
    \ the\n                  VM system could initiate the BYE*/\n    BYE F11     \
    \  BYE sip:UserB@wcom.com SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n\
    \                  Route: <sip:UserB-dep-fnb@vm.wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    BYE F12       BYE sip: UserB-dep-fnb@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060\n                \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n       \
    \           Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n      \
    \            Content-Length: 0\n    200 OK F13    SIP/2.0 200 OK\n    VM->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuy <sip:UserB@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    200 OK\
    \ F14    SIP/2.0 200 OK\n    Proxy->A      Via: SIP/2.0/UDP here.com:5060\n  \
    \                From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuy\
    \ <sip:UserB@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq:  2 BYE\n                  Content-Length: 0\n"
- title: 4.2.3 Direct call to a subscriber's mailbox
  contents:
  - "4.2.3 Direct call to a subscriber's mailbox\n   User A calls UserB's mailbox\
    \ directly.  This flow assumes that\n   \"sip:UserB-dep@vm.wcom.com\" maps to\
    \ UserB's mailbox and the behavior\n   of \"generic message deposit\"\n      \
    \      User A              Proxy                VM Service\n              |  \
    \                 |                       |\n              |  INVITE F1      \
    \  |                       |\n              |------------------>|            \
    \           |\n              |                   |  INVITE F2            |\n \
    \             | (100 Trying) F3   |---------------------->|\n              |<------------------|\
    \                       |\n              |                   |  200 OK F4    \
    \        |\n              |  200 OK F5        |<----------------------|\n    \
    \          |<------------------|                       |\n              |    \
    \               |                       |\n              |  ACK F6           |\
    \                       |\n              |------------------>|  ACK F7       \
    \        |\n              |                   |---------------------->|\n    \
    \          |                   |                       |\n              |    \
    \  RTP Both Ways - Deposit Msg for B    |\n              |<-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m->|\n\
    \              |                   |                       |\n              |\
    \  BYE F8           |                       |\n              |------------------>|\
    \  BYE F9               |\n              |                   |---------------------->|\n\
    \              |                   |                       |\n              |\
    \                   |  200 OK F10           |\n              |               \
    \    |<----------------------|\n              |  200 OK F11       |          \
    \             |\n              |<------------------|                       |\n\
    \              |                   |                       |\n     Flow Id   \
    \                         Comments\n    INVITE F1     INVITE sip:UserB-VM@vm.wcom.com\
    \ SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                \
    \  From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuyVoiceMail\
    \ <sip:UserB-VM@wcom.com>\n                  Call-Id: 12345600@here.com\n    \
    \              CSeq: 1 INVITE\n                  Contact: TheBigGuy <sip:UserA@here.com>\n\
    \                  Proxy-Authorization:Digest username=\"UserA\",\n          \
    \        realm=\"MCI WorldCom SIP\",\n                  nonce=\"ea9c8e88df84f1cec4341ae6cbe5a359\"\
    , opaque=\"\",\n                  uri=\"sip:UserB-VM@wcom.com\", response=<appropriately\n\
    \                  calculated hash goes here>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserA 2890844526 2890844526 IN IP4 client.here.com\n\
    \                  s=Session SDP\n                  c=IN IP4 100.101.102.103\n\
    \                  t=0 0\n                  m=audio 49170 RTP/AVP 0\n        \
    \          a=rtpmap:0 PCMU/8000\n                  /*Client for A prepares to\
    \ receive data on port 49170\n                  from the network. */\n    INVITE\
    \ F2     INVITE sip:UserB-dep@vm.wcom.com SIP/2.0\n    Proxy->B1     Via: SIP/2.0/UDP\
    \ wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  Record-Route: <sip:UserB-VM@wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuyVoiceMail\
    \ <sip:UserB-VM@vm.wcom.com>\n                  Call-Id: 12345600@here.com\n \
    \                 CSeq: 1 INVITE\n                  Contact: TheBigGuy <sip:UserA@here.com>\n\
    \                  Content-Type: application/sdp\n                  Content-Length:\
    \ <appropriate value>\n                  v=0\n                  o=UserA 2890844526\
    \ 2890844526 IN IP4 client.here.com\n                  s=Session SDP\n       \
    \           c=IN IP4 100.101.102.103\n                  t=0 0\n              \
    \    m=audio 49170 RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    (100\
    \ Trying   SIP/2.0 100 Trying\n    F3            Via: SIP/2.0/UDP here.com:5060\n\
    \    Proxy->A)     From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuyVoiceMail <sip:UserB-VM@wcom.com>\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Content-Length: 0\n    200\
    \ OK F4     SIP/2.0 200 OK\n    VM->Proxy     Via: SIP/2.0/UDP wcom.com:5060;\
    \ branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n               \
    \   Record-Route: <sip:UserB-VM@wcom.com>\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuyVoiceMail <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheLittleGuyVoiceMail <sip:UserB-\n              \
    \    dep@vm.wcom.com>\n                  Content-Type: application/sdp\n     \
    \             Content-Length: <appropriate value>\n                  v=0\n   \
    \               o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n           \
    \       s=Session SDP\n                  c=IN IP4 110.111.112.114\n          \
    \        t=0 0\n                  m=audio 3456 RTP/AVP 0\n                  a=rtpmap:0\
    \ PCMU/8000\n    200 OK F5     SIP/2.0 200 OK\n    Proxy->A      Via: SIP/2.0/UDP\
    \ here.com:5060\n                  Record-Route: <sip:UserB-VM@wcom.com>\n   \
    \               From: TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuyVoiceMail\
    \ <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n                  Call-Id:\
    \ 12345600@here.com\n                  CSeq: 1 INVITE\n                  Contact\
    \ TheLittleGuyVoiceMail <sip:UserB-\n                  dep@vm.wcom.com>\n    \
    \              Content-Type: application/sdp\n                  Content-Length:\
    \ <appropriate value>\n                  v=0\n                  o=UserB 2890844527\
    \ 2890844527 IN IP4 vm.wcom.com\n                  s=Session SDP\n           \
    \       c=IN IP4 110.111.112.114\n                  t=0 0\n                  m=audio\
    \ 3456 RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    ACK F6        ACK\
    \ sip:UserB-VM@wcom.com SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n\
    \                  Route:<sip:UserB-dep@vm.wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: TheLittleGuyVoiceMail\
    \ <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n                  Call-Id:\
    \ 12345600@here.com\n                  CSeq: 1 ACK\n                  Content-Length:\
    \ 0\n    ACK F7        ACK sip:UserB-dep@vm.wcom.com SIP/2.0\n    Proxy->VM  \
    \   Via: SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuyVoiceMail <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 ACK\n\
    \                  Content-Length: 0\n                  /* RTP streams are established\
    \ between A and VM.  VM\n                  system starts IVR dialog for generic\
    \ message-deposit\n                  for UserB */\n                  /* User A\
    \ Hangs Up with VM system.  Alternatively, the\n                  VM system could\
    \ initiate the BYE*/\n    BYE F8        BYE sip:UserB-VM@wcom.com SIP/2.0\n  \
    \  A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                  Route:<sip:UserB-dep@vm.wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuyVoiceMail <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    BYE F9        BYE sip: UserB-dep@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060\n                \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuyVoiceMail <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    200 OK F10    SIP/2.0 200 OK\n    VM->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ TheLittleGuyVoiceMail <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    200 OK F11    SIP/2.0 200 OK\n    Proxy->A\
    \      Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: TheLittleGuyVoiceMail <sip:UserB-\n                  VM@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq:  2 BYE\n\
    \                  Content-Length: 0\n"
- title: 4.3 Message Retrieval Scenarios
  contents:
  - '4.3 Message Retrieval Scenarios

    '
- title: 4.3.1 Call to retrieve messages believed to be from a known subscriber
  contents:
  - "4.3.1 Call to retrieve messages believed to be from a known subscriber\n   Some\
    \ user uses a SIP client on UserA's desk to call the voice mail\n   system to\
    \ retrieve messages.  The SIP client has authenticated itself\n   to the proxy\
    \ using credentials assigned to the device.  The proxy can\n   make a weak assumption\
    \ that the caller is the device owner.  The URI\n   of \"sip:UserA-retrieve@vm.wcom.com\"\
    \ maps to UserA's mailbox and the\n   behavior of \"retrieve messages after prompting\
    \ for and verifying\n   PIN.\" The VM System trusts the proxy, and will not accept\
    \ calls from\n   an untrusted source.  The proxy will not allow direct calls to\n\
    \   UserA-retrieve@vm.wcom.com.  The proxy will forward calls placed to\n   VoiceMail@wcom.com\
    \ to UserA-retrieve@vm.wcom.com only for calls\n   placed from a client device\
    \ assigned to UserA.\n            User A              Proxy                VM\
    \ Service\n              |                   |                       |\n     \
    \         |  INVITE F1        |                       |\n              |------------------>|\
    \                       |\n              |                   |  INVITE F2    \
    \        |\n              | (100 Trying) F3   |---------------------->|\n    \
    \          |<------------------|                       |\n              |    \
    \               |  200 OK F4            |\n              |  200 OK F5        |<----------------------|\n\
    \              |<------------------|                       |\n              |\
    \                   |                       |\n              |  ACK F6       \
    \    |                       |\n              |------------------>|  ACK F7  \
    \             |\n              |                   |---------------------->|\n\
    \              |                   |                       |\n              |\
    \      RTP Both Ways - VM prompts for PIN\n              |<-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m->|\n\
    \              |                   |                       |\n              |\
    \  BYE F8           |                       |\n              |------------------>|\
    \  BYE F9               |\n              |                   |---------------------->|\n\
    \              |                   |                       |\n              |\
    \                   |  200 OK F10           |\n              |               \
    \    |<----------------------|\n              |  200 OK F11       |          \
    \             |\n              |<------------------|                       |\n\
    \              |                   |                       |\n     Flow Id   \
    \                         Comments\n    INVITE F1     INVITE sip:VoiceMail@wcom.com\
    \ SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                \
    \  From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Proxy-Authorization:Digest username=\"UserAPhone\",\n                  realm=\"\
    MCI WorldCom SIP\",\n                  nonce=\"ea9c8e88df84f1cec4341ae6cbe5a359\"\
    , opaque=\"\",\n                  uri=\"sip:VoiceMail@wcom.com\", response=<appropriately\n\
    \                  calculated hash goes here>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserA 2890844526 2890844526 IN IP4 client.here.com\n\
    \                  s=Session SDP\n                  c=IN IP4 100.101.102.103\n\
    \                  t=0 0\n                  m=audio 49170 RTP/AVP 0\n        \
    \          a=rtpmap:0 PCMU/8000\n                  /*Client for A prepares to\
    \ receive data on port 49170\n                  from the network. */\n    INVITE\
    \ F2     INVITE sip:UserA-retrieve@vm.wcom.com SIP/2.0\n    Proxy->B1     Via:\
    \ SIP/2.0/UDP wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  Record-Route: <sip:VoiceMail@wcom.com>\n                  From:\
    \ TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Content-Type: application/sdp\n                  Content-Length: <appropriate\
    \ value>\n                  v=0\n                  o=UserA 2890844526 2890844526\
    \ IN IP4 client.here.com\n                  s=Session SDP\n                  c=IN\
    \ IP4 100.101.102.103\n                  t=0 0\n                  m=audio 49170\
    \ RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    (100 Trying   SIP/2.0\
    \ 100 Trying\n    F3            Via: SIP/2.0/UDP here.com:5060\n    Proxy->A)\
    \     From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Content-Length: 0\n    200 OK F4     SIP/2.0 200 OK\n    VM->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP\
    \ here.com:5060\n                  Record-Route: <sip:VoiceMail@wcom.com>\n  \
    \                From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail\
    \ <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact: VoiceMailSystem\
    \ <sip:UserA-\n                  retrieve@vm.wcom.com>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n\
    \                  s=Session SDP\n                  c=IN IP4 110.111.112.114\n\
    \                  t=0 0\n                  m=audio 3456 RTP/AVP 0\n         \
    \         a=rtpmap:0 PCMU/8000\n    200 OK F5     SIP/2.0 200 OK\n    Proxy->A\
    \      Via: SIP/2.0/UDP here.com:5060\n                  Record-Route: <sip:VoiceMail@wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact VoiceMailSystem <sip:\
    \ UserA-\n                  retrieve@vm.wcom.com>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n\
    \                  s=Session SDP\n                  c=IN IP4 110.111.112.114\n\
    \                  t=0 0\n                  m=audio 3456 RTP/AVP 0\n         \
    \         a=rtpmap:0 PCMU/8000\n    ACK F6        ACK sip:VoiceMail@wcom.com SIP/2.0\n\
    \    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                  Route:<sip:UserA-retrieve@vm.wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 ACK\n                  Content-Length: 0\n    ACK F7\
    \        ACK sip:UserA-retrieve@vm.wcom.com SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP\
    \ wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n          \
    \        From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail\
    \ <sip:VoiceMail@wcom.com>; tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 ACK\n                  Content-Length: 0\n        \
    \          /* RTP streams are established between A and VM.  VM\n            \
    \      determines that the call is likely from UserA, and\n                  starts\
    \ a message retrieval session, prompting for\n                  PIN*/\n      \
    \            /* User A Hangs Up with VM system.  Alternatively, the\n        \
    \          VM system could initiate the BYE*/\n    BYE F8        BYE sip: VoiceMail@wcom.com\
    \ SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                \
    \  Route:<sip:UserA-retrieve@vm.wcom.com>\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n      \
    \            Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n     \
    \             Content-Length: 0\n    BYE F9        BYE sip: UserA-retrieve@vm.wcom.com\
    \ SIP/2.0\n    Proxy->VM     Via: SIP/2.0/UDP wcom.com:5060\n                \
    \  Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n      \
    \            Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n     \
    \             Content-Length: 0\n    200 OK F10    SIP/2.0 200 OK\n    VM->Proxy\
    \     Via: SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    200 OK\
    \ F11    SIP/2.0 200 OK\n    Proxy->A      Via: SIP/2.0/UDP here.com:5060\n  \
    \                From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail\
    \ <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq:  2 BYE\n                  Content-Length: 0\n"
- title: 4.3.2 Call to retrieve messages from an authenticated subscriber
  contents:
  - "4.3.2 Call to retrieve messages from an authenticated subscriber\n   UserA to\
    \ call the voice mail system to retrieve messages.\n   Assumptions: The caller\
    \ is authenticated using UserA's credentials.\n   \"sip:UserA-retrieve-auth@vm.wcom.com\"\
    \ maps to UserA's mailbox and the\n   behavior of \"retrieve messages.\" The voice\
    \ mail service trusts the\n   proxy not to forward any calls to that URI unless\
    \ the call is\n   authenticated to be from UserA.\n   Given these assumptions,\
    \ The VM service may choose not require a PIN\n   for calls to this URI.\n   \
    \         User A              Proxy                VM Service\n              |\
    \                   |                       |\n              |  INVITE F1    \
    \    |                       |\n              |------------------>|          \
    \             |\n              |                   |  INVITE F2            |\n\
    \              | (100 Trying) F3   |---------------------->|\n              |<------------------|\
    \                       |\n              |                   |  200 OK F4    \
    \        |\n              |  200 OK F5        |<----------------------|\n    \
    \          |<------------------|                       |\n              |    \
    \               |                       |\n              |  ACK F6           |\
    \                       |\n              |------------------>|  ACK F7       \
    \        |\n              |                   |---------------------->|\n    \
    \          |                   |                       |\n              |    \
    \  RTP Both Ways - Deposit Msg for B    |\n              |<-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m-m->|\n\
    \              |                   |                       |\n              |\
    \  BYE F8           |                       |\n              |------------------>|\
    \  BYE F9               |\n              |                   |---------------------->|\n\
    \              |                   |                       |\n              |\
    \                   |  200 OK F10           |\n              |               \
    \    |<----------------------|\n              |  200 OK F11       |          \
    \             |\n              |<------------------|                       |\n\
    \              |                   |                       |\n     Flow Id   \
    \                         Comments\n    INVITE F1     INVITE sip:VoiceMail@wcom.com\
    \ SIP/2.0\n    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                \
    \  From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: TheBigGuy <sip:UserA@here.com>\n                 \
    \ Proxy-Authorization:Digest username=\"UserA\",\n                  realm=\"MCI\
    \ WorldCom SIP\",\n                  nonce=\"ea9c8e88df84f1cec4341ae6cbe5a359\"\
    , opaque=\"\",\n                  uri=\"sip:VoiceMail@wcom.com\", response=<appropriately\n\
    \                  calculated hash goes here>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserA 2890844526 2890844526 IN IP4 client.here.com\n\
    \                  s=Session SDP\n                  c=IN IP4 100.101.102.103\n\
    \                  t=0 0\n                  m=audio 49170 RTP/AVP 0\n        \
    \          a=rtpmap:0 PCMU/8000\n                  /*Client for A prepares to\
    \ receive data on port 49170\n                  from the network. */\n    INVITE\
    \ F2     INVITE sip:UserA-retrieve-auth@vm.wcom.com SIP/2.0\n    Proxy->B1   \
    \  Via: SIP/2.0/UDP wcom.com:5060; branch=1\n                  Via: SIP/2.0/UDP\
    \ here.com:5060\n                  Record-Route: <sip:VoiceMail@wcom.com>\n  \
    \                From: TheBigGuy <sip:UserA@here.com>\n                  To: VoiceMail\
    \ <sip:VoiceMail@wcom.com>\n                  Call-Id: 12345600@here.com\n   \
    \               CSeq: 1 INVITE\n                  Contact: TheBigGuy <sip:UserA@here.com>\n\
    \                  Content-Type: application/sdp\n                  Content-Length:\
    \ <appropriate value>\n                  v=0\n                  o=UserA 2890844526\
    \ 2890844526 IN IP4 client.here.com\n                  s=Session SDP\n       \
    \           c=IN IP4 100.101.102.103\n                  t=0 0\n              \
    \    m=audio 49170 RTP/AVP 0\n                  a=rtpmap:0 PCMU/8000\n    (100\
    \ Trying   SIP/2.0 100 Trying\n    F3            Via: SIP/2.0/UDP here.com:5060\n\
    \    Proxy->A)     From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Content-Length: 0\n    200\
    \ OK F4     SIP/2.0 200 OK\n    VM->Proxy     Via: SIP/2.0/UDP wcom.com:5060;\
    \ branch=1\n                  Via: SIP/2.0/UDP here.com:5060\n               \
    \   Record-Route: <sip:VoiceMail@wcom.com>\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 1 INVITE\n\
    \                  Contact: VoiceMailSystem <sip:UserA-retrieve-\n           \
    \       auth@vm.wcom.com>\n                  Content-Type: application/sdp\n \
    \                 Content-Length: <appropriate value>\n                  v=0\n\
    \                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n        \
    \          s=Session SDP\n                  c=IN IP4 110.111.112.114\n       \
    \           t=0 0\n                  m=audio 3456 RTP/AVP 0\n                \
    \  a=rtpmap:0 PCMU/8000\n    200 OK F5     SIP/2.0 200 OK\n    Proxy->A      Via:\
    \ SIP/2.0/UDP here.com:5060\n                  Record-Route: <sip:VoiceMail@wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 INVITE\n                  Contact VoiceMailSystem <sip:\
    \ UserA-retrieve-\n                  auth@vm.wcom.com>\n                  Content-Type:\
    \ application/sdp\n                  Content-Length: <appropriate value>\n   \
    \               v=0\n                  o=UserB 2890844527 2890844527 IN IP4 vm.wcom.com\n\
    \                  s=Session SDP\n                  c=IN IP4 110.111.112.114\n\
    \                  t=0 0\n                  m=audio 3456 RTP/AVP 0\n         \
    \         a=rtpmap:0 PCMU/8000\n    ACK F6        ACK sip:VoiceMail@wcom.com SIP/2.0\n\
    \    A->Proxy      Via: SIP/2.0/UDP here.com:5060\n                  Route: <sip:UserA-retrieve-auth@vm.wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 1 ACK\n                  Content-Length: 0\n    ACK F7\
    \        ACK sip:UserA-retrieve-auth@vm.wcom.com SIP/2.0\n    Proxy->VM     Via:\
    \ SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>; tag=3145678\n                  Call-Id:\
    \ 12345600@here.com\n                  CSeq: 1 ACK\n                  Content-Length:\
    \ 0\n                  /* RTP streams are established between A and VM.  VM\n\
    \                  determines that the call is likely from UserA, and\n      \
    \            starts a message retrieval session.  Since the proxy\n          \
    \        has already authenticated the identity of UserA, the\n              \
    \    VM does not need to prompt for PIN. */\n                  /* User A Hangs\
    \ Up with VM system.  Alternatively, the\n                  VM system could initiate\
    \ the BYE*/\n    BYE F8        BYE sip:VoiceMail@wcom.com SIP/2.0\n    A->Proxy\
    \      Via: SIP/2.0/UDP here.com:5060\n                  Route:<sip:UserA-retrieve-auth@vm.wcom.com>\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    BYE F9\
    \        BYE sip: UserA-retrieve-auth@vm.wcom.com SIP/2.0\n    Proxy->VM     Via:\
    \ SIP/2.0/UDP wcom.com:5060\n                  Via: SIP/2.0/UDP here.com:5060\n\
    \                  From: TheBigGuy <sip:UserA@here.com>\n                  To:\
    \ VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n                  Call-Id: 12345600@here.com\n\
    \                  CSeq: 2 BYE\n                  Content-Length: 0\n    200 OK\
    \ F10    SIP/2.0 200 OK\n    VM->Proxy     Via: SIP/2.0/UDP wcom.com:5060\n  \
    \                Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy\
    \ <sip:UserA@here.com>\n                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n\
    \                  Call-Id: 12345600@here.com\n                  CSeq: 2 BYE\n\
    \                  Content-Length: 0\n    200 OK F11    SIP/2.0 200 OK\n    Proxy->A\
    \      Via: SIP/2.0/UDP here.com:5060\n                  From: TheBigGuy <sip:UserA@here.com>\n\
    \                  To: VoiceMail <sip:VoiceMail@wcom.com>;tag=3145678\n      \
    \            Call-Id: 12345600@here.com\n                  CSeq:  2 BYE\n    \
    \              Content-Length: 0\n"
- title: 5. Security Considerations
  contents:
  - "5. Security Considerations\n   This document discusses a usage of SIP/2.0 as\
    \ defined by RFC 2543[1].\n   It introduces no additions, modifications, or restrictions\
    \ to the\n   protocol defined therein.  Any implementation of the concepts in\
    \ this\n   document is subject to the issues discussed there.\n"
- title: 6. Acknowledgments
  contents:
  - "6. Acknowledgments\n   The authors would like to thank Chris Cunningham, Steve\
    \ Donovan, Alan\n   Johnston, Henry Sinnreich, Kevin Summers, John Truetken, and\
    \ Dean\n   Willis for their discussion of and contribution to this work.\n"
- title: References
  contents:
  - "References\n   [1] Handley, M., Schulzrinne, H., Schooler, E. and J. Rosenberg,\n\
    \       \"SIP: Session Initiation Protocol\", RFC 2543, March 1999.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ben Campbell\n   dynamicsoft\n   5100 Tennyson Parkway\n\
    \   Suite 1200\n   Plano, TX  75024\n   EMail: bcampbell@dynamicsoft.com\n   Robert\
    \ J. Sparks\n   dynamicsoft\n   5100 Tennyson Parkway\n   Suite 1200\n   Plano,\
    \ TX  75024\n   EMail: rsparks@dynamicsoft.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2001).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
