- title: __initial_text__
  contents:
  - '   Resource Public Key Infrastructure (RPKI) Validation Reconsidered

    '
- title: Abstract
  contents:
  - "Abstract\n   This document specifies an alternative to the certificate validation\n\
    \   procedure specified in RFC 6487 that reduces aspects of operational\n   fragility\
    \ in the management of certificates in the Resource Public\n   Key Infrastructure\
    \ (RPKI), while retaining essential security\n   features.\n   The procedure specified\
    \ in RFC 6487 requires that Resource\n   Certificates are rejected entirely if\
    \ they are found to overclaim any\n   resources not contained on the issuing certificate,\
    \ whereas the\n   validation process defined here allows an issuing Certification\n\
    \   Authority (CA) to chose to communicate that such Resource\n   Certificates\
    \ should be accepted for the intersection of their\n   resources and the issuing\
    \ certificate.\n   It should be noted that the validation process defined here\
    \ considers\n   validation under a single trust anchor (TA) only.  In particular,\n\
    \   concerns regarding overclaims where multiple configured TAs claim\n   overlapping\
    \ resources are considered out of scope for this document.\n   This choice is\
    \ signaled by a set of alternative Object Identifiers\n   (OIDs) per \"X.509 Extensions\
    \ for IP Addresses and AS Identifiers\"\n   (RFC 3779) and \"Certificate Policy\
    \ (CP) for the Resource Public Key\n   Infrastructure (RPKI)\" (RFC 6484).  It\
    \ should be noted that in case\n   these OIDs are not used for any certificate\
    \ under a trust anchor, the\n   validation procedure defined here has the same\
    \ outcome as the\n   procedure defined in RFC 6487.\n   Furthermore, this document\
    \ provides an alternative to Route Origin\n   Authorization (ROA) (RFC 6482) and\
    \ BGPsec Router Certificate (BGPsec\n   PKI Profiles -- publication requested)\
    \ validation.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8360.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2018 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Overview  . . . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   4\n     1.1.  Requirements Notation . . . . . . . . . . . . . .\
    \ . . . .   4\n   2.  Certificate Validation in the RPKI  . . . . . . . . . .\
    \ . . .   4\n   3.  Operational Considerations  . . . . . . . . . . . . . . .\
    \ . .   5\n   4.  An Amended RPKI Certification Validation Process  . . . . .\
    \ .   7\n     4.1.  Verified Resource Sets  . . . . . . . . . . . . . . . . .\
    \   7\n     4.2.  Differences with Existing Standards . . . . . . . . . . .  \
    \ 7\n       4.2.1.  Certificate Policy (CP) for Use with Validation\n        \
    \       Reconsidered in the RPKI  . . . . . . . . . . . . . .   7\n       4.2.2.\
    \  An Alternative to X.509 Extensions for IP Addresses\n               and AS\
    \ Identifiers (RFC 3779) . . . . . . . . . . . .   8\n       4.2.3.  Addendum\
    \ to RFC 6268  . . . . . . . . . . . . . . . .  12\n       4.2.4.  An Alternative\
    \ to the Profile for X.509 PKIX Resource\n               Certificates  . . . .\
    \ . . . . . . . . . . . . . . . .  14\n       4.2.5.  An Alternative ROA Validation\
    \ . . . . . . . . . . . .  18\n       4.2.6.  An Alternative to BGPsec Router\
    \ Certificate\n               Validation  . . . . . . . . . . . . . . . . . .\
    \ . . .  18\n   5.  Validation Examples . . . . . . . . . . . . . . . . . . .\
    \ . .  19\n     5.1.  Example 1 -- An RPKI Tree Using the Old OIDs Only . . .\
    \ .  19\n     5.2.  Example 2 -- An RPKI Tree Using the New OIDs Only . . . .\
    \  21\n     5.3.  Example 3 -- An RPKI Tree Using a Mix of Old and New OIDs  23\n\
    \   6.  Deployment Considerations . . . . . . . . . . . . . . . . . .  25\n  \
    \ 7.  Security Considerations . . . . . . . . . . . . . . . . . . .  26\n   8.\
    \  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  26\n   9.  References\
    \  . . . . . . . . . . . . . . . . . . . . . . . . .  27\n     9.1.  Normative\
    \ References  . . . . . . . . . . . . . . . . . .  27\n     9.2.  Informative\
    \ References  . . . . . . . . . . . . . . . . .  28\n   Acknowledgements  . .\
    \ . . . . . . . . . . . . . . . . . . . . . .  28\n   Authors' Addresses  . .\
    \ . . . . . . . . . . . . . . . . . . . . .  28\n"
- title: 1.  Overview
  contents:
  - "1.  Overview\n   This document specifies an alternative to the certificate validation\n\
    \   procedure specified in RFC 6487.  Where the procedure specified in\n   RFC\
    \ 6487 will require that Resource Certificates be rejected entirely\n   if they\
    \ are found to overclaim any resources not contained on the\n   issuing certificate,\
    \ the procedure defined here dictates that these\n   Resource Certificates be\
    \ accepted for the intersection of their\n   resources and the issuing certificate\
    \ only.\n   The outcome of both procedures is the same as long as no overclaims\n\
    \   occur.  Furthermore, the new procedure can never lead to the\n   acceptance\
    \ of resources that are not validly held on the path of\n   issuing certificates.\n\
    \   However, the procedure defined here will limit the impact in case\n   resources\
    \ are no longer validly held on the path of issuing\n   certificates to attestations,\
    \ such as Route Origin Authorizations\n   [RFC6482] that refer to these resources\
    \ only.\n"
- title: 1.1.  Requirements Notation
  contents:
  - "1.1.  Requirements Notation\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted\
    \ as described in\n   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear\
    \ in all\n   capitals, as shown here.\n"
- title: 2.  Certificate Validation in the RPKI
  contents:
  - "2.  Certificate Validation in the RPKI\n   As currently defined in Section 7.2\
    \ of [RFC6487], validation of PKIX\n   certificates that conform to the RPKI profile\
    \ relies on the use of a\n   path validation process where each certificate in\
    \ the validation path\n   is required to meet the certificate validation criteria.\n\
    \   These criteria require, in particular, that the Internet Number\n   Resources\
    \ (INRs) of each certificate in the validation path are\n   \"encompassed\" by\
    \ INRs on the issuing certificate.  The first\n   certificate in the path is required\
    \ to be a trust anchor, and its\n   resources are considered valid by definition.\n\
    \   For example, in the following sequence:\n   Certificate 1 (trust anchor):\n\
    \   Issuer TA,\n   Subject TA,\n   Resources 192.0.2.0/24, 198.51.100.0/24,\n\
    \         2001:db8::/32, AS64496-AS64500\n   Certificate 2:\n   Issuer TA,\n \
    \  Subject CA1,\n   Resources 192.0.2.0/24, 198.51.100.0/24, 2001:db8::/32\n \
    \  Certificate 3:\n   Issuer CA1,\n   Subject CA2,\n   Resources 192.0.2.0/24,\
    \ 198.51.100.0/24, 2001:db8::/32\n   ROA 1:\n   Embedded Certificate 4 (EE certificate):\n\
    \   Issuer CA2,\n   Subject R1,\n   Resources 192.0.2.0/24\n   Prefix 192.0.2.0/24,\
    \ Max Length 24, ASN 64496\n   All certificates in this scenario are considered\
    \ valid since the INRs\n   of each certificate are encompassed by those of the\
    \ issuing\n   certificate.  ROA1 is valid because the specified prefix is\n  \
    \ encompassed by the embedded end entity (EE) certificate, as required\n   by\
    \ [RFC6482].\n"
- title: 3.  Operational Considerations
  contents:
  - "3.  Operational Considerations\n   The allocations recorded in the RPKI change\
    \ as a result of resource\n   transfers.  For example, the CAs involved in transfer\
    \ might choose to\n   modify CA certificates in an order that causes some of these\n\
    \   certificates to \"overclaim\" temporarily.  A certificate is said to\n   \"\
    overclaim\" if it includes INRs not contained in the INRs of the CA\n   that issued\
    \ the certificate in question.\n   It may also happen that a child CA does not\
    \ voluntarily request a\n   shrunk Resource Certificate when resources are being\
    \ transferred or\n   reclaimed by the parent.  Furthermore, operational errors\
    \ that may\n   occur during management of RPKI databases also may create CA\n\
    \   certificates that, temporarily, no longer encompass all of the INRs\n   of\
    \ subordinate certificates.\n   Consider the following sequence:\n   Certificate\
    \ 1 (trust anchor):\n   Issuer TA,\n   Subject TA,\n   Resources 192.0.2.0/24,\
    \ 198.51.100.0/24,\n        2001:db8::/32, AS64496-AS64500\n   Certificate 2:\n\
    \   Issuer TA,\n   Subject CA1,\n   Resources 192.0.2.0/24, 2001:db8::/32\n  \
    \ Certificate 3 (invalid):\n   Issuer CA1,\n   Subject CA2,\n   Resources 192.0.2.0/24,\
    \ 198.51.100.0/24, 2001:db8::/32\n   ROA 1 (invalid):\n   Embedded Certificate\
    \ 4 (EE certificate, invalid):\n   Issuer CA2,\n   Subject R1,\n   Resources 192.0.2.0/24\n\
    \   Prefix 192.0.2.0/24, Max Length 24, ASN 64496\n   Here, Certificate 2 from\
    \ the previous example was reissued by TA to\n   CA1, and the prefix 198.51.100.0/24\
    \ was removed.  However, CA1 failed\n   to reissue a new Certificate 3 to CA2.\
    \  As a result, Certificate 3 is\n   now overclaiming and considered invalid;\
    \ by recursion, the embedded\n   Certificate 4 used for ROA1 is also invalid.\
    \  And ROA1 is invalid\n   because the specified prefix contained in the ROA is\
    \ no longer\n   encompassed by a valid embedded EE certificate, as required by\n\
    \   [RFC6482].\n   However, it should be noted that ROA1 does not make use of\
    \ any of the\n   address resources that were removed from CA1's certificate; thus,\
    \ it\n   would be desirable if ROA1 could still be viewed as valid.\n   Technically,\
    \ CA1 should reissue a Certificate 3 to CA2 without\n   198.51.100.0/24, and then\
    \ ROA1 would be considered valid according to\n   [RFC6482].  But as long as CA1\
    \ does not take this action, ROA1\n   remains invalid.  It would be preferable\
    \ if ROA1 could be considered\n   valid, since the assertion it makes was not\
    \ affected by the reduced\n   scope of CA1's certificate.\n"
- title: 4.  An Amended RPKI Certification Validation Process
  contents:
  - '4.  An Amended RPKI Certification Validation Process

    '
- title: 4.1.  Verified Resource Sets
  contents:
  - "4.1.  Verified Resource Sets\n   The problem described above can be considered\
    \ a low probability\n   problem today.  However, the potential impact on routing\
    \ security\n   would be high if an overclaiming occurred near the apex of the\
    \ RPKI\n   hierarchy, as this would invalidate the entirety of the subtree\n \
    \  located below this point.\n   The changes specified here to the validation\
    \ procedure in [RFC6487]\n   do not change the probability of this problem, but\
    \ they do limit the\n   impact to just the overclaimed resources.  This revised\
    \ validation\n   algorithm is intended to avoid causing CA certificates to be\
    \ treated\n   as completely invalid as a result of overclaims.  However, these\n\
    \   changes are designed to not degrade the security offered by the RPKI.\n  \
    \ Specifically, ROAs and router certificates will be treated as valid\n   only\
    \ if all of the resources contained in them are encompassed by all\n   superior\
    \ certificates along a path to a trust anchor.\n   The way this is achieved conceptually\
    \ is by maintaining a Verified\n   Resource Set (VRS) for each certificate that\
    \ is separate from the\n   INRs found in the resource extension [RFC3779] in the\
    \ certificate.\n"
- title: 4.2.  Differences with Existing Standards
  contents:
  - '4.2.  Differences with Existing Standards

    '
- title: 4.2.1.  Certificate Policy (CP) for Use with Validation Reconsidered in
  contents:
  - "4.2.1.  Certificate Policy (CP) for Use with Validation Reconsidered in\n   \
    \     the RPKI\n   Note that Section 1.2 of [RFC6484] defines the \"Certificate\
    \ Policy\n   (CP) for the Resource PKI (RPKI)\" with the following OID:\n   id-cp-ipAddr-asNumber\
    \ OBJECT IDENTIFIER ::= { iso(1)\n           identified-organization(3) dod(6)\
    \ internet(1)\n           security(5) mechanisms(5) pkix(7) cp(14) 2 }\n   Per\
    \ this document, a new OID for an alternative \"Certificate Policy\n   (CP) for\
    \ use with validation reconsidered in the Resource PKI (RPKI)\"\n   has been assigned\
    \ as follows:\n   id-cp-ipAddr-asNumber-v2 OBJECT IDENTIFIER ::= { iso(1)\n  \
    \         identified-organization(3) dod(6) internet(1)\n           security(5)\
    \ mechanisms(5) pkix(7) cp(14) 3 }\n   This alternative Certificate Policy is\
    \ the same as the Certificate\n   Policy described in [RFC6484], except that it\
    \ is used to drive the\n   decision in Step 8 of the validation procedure described\
    \ in\n   Section 4.2.4.4.\n"
- title: 4.2.2.  An Alternative to X.509 Extensions for IP Addresses and AS
  contents:
  - "4.2.2.  An Alternative to X.509 Extensions for IP Addresses and AS\n        Identifiers\
    \ (RFC 3779)\n   This document defines an alternative to [RFC3779].  All\n   specifications\
    \ and procedures described in [RFC3779] apply, with the\n   notable exceptions\
    \ described in the following subsections.\n"
- title: 4.2.2.1.  OID for id-pe-ipAddrBlocks-v2
  contents:
  - "4.2.2.1.  OID for id-pe-ipAddrBlocks-v2\n   Per this document, an OID has been\
    \ assigned for the extension\n   id-pe-ipAddrBlocks-v2 (id-pe 28).  This OID MUST\
    \ only be used in\n   conjunction with the alternative Certificate Policy OID\
    \ defined in\n   Section 4.2.1.\n   The following is an amended specification\
    \ to be used as an\n   alternative to the specification in Section 2.2.1 of [RFC3779].\n\
    \   The OID for this extension is id-pe-ipAddrBlocks-v2.\n   id-pe-ipAddrBlocks-v2\
    \  OBJECT IDENTIFIER ::= { id-pe 28 }\n   where [RFC5280] defines:\n   id-pkix\
    \  OBJECT IDENTIFIER ::= { iso(1) identified-organization(3)\n          dod(6)\
    \ internet(1) security(5) mechanisms(5) pkix(7) }\n   id-pe    OBJECT IDENTIFIER\
    \ ::= { id-pkix 1 }\n"
- title: 4.2.2.2.  Syntax for id-pe-ipAddrBlocks-v2
  contents:
  - "4.2.2.2.  Syntax for id-pe-ipAddrBlocks-v2\n   id-pe-ipAddrBlocks-v2      OBJECT\
    \ IDENTIFIER ::= { id-pe 28 }\n   IPAddrBlocks        ::= SEQUENCE OF IPAddressFamily\n\
    \   IPAddressFamily     ::= SEQUENCE {    -- AFI & optional SAFI --\n   addressFamily\
    \        OCTET STRING (SIZE (2..3)),\n   ipAddressChoice      IPAddressChoice\
    \ }\n   IPAddressChoice     ::= CHOICE {\n   inherit              NULL, -- inherit\
    \ from issuer --\n   addressesOrRanges    SEQUENCE OF IPAddressOrRange }\n   IPAddressOrRange\
    \    ::= CHOICE {\n   addressPrefix        IPAddress,\n   addressRange       \
    \  IPAddressRange }\n   IPAddressRange      ::= SEQUENCE {\n   min           \
    \       IPAddress,\n   max                  IPAddress }\n   IPAddress        \
    \   ::= BIT STRING\n   Note that the descriptions of objects referenced in the\
    \ syntax above\n   are defined in Sections 2.2.3.1 through 2.2.3.9 of [RFC3779].\n"
- title: 4.2.2.3.  OID for id-pe-autonomousSysIds-v2
  contents:
  - "4.2.2.3.  OID for id-pe-autonomousSysIds-v2\n   Per this document, an OID has\
    \ been assigned for the extension id-pe-\n   autonomousSysIds-v2 (id-pe 29). \
    \ This OID MUST only be used in\n   conjunction with the alternative Certificate\
    \ Policy OID defined in\n   Section 4.2.1.\n   The following is an amended specification\
    \ to be used as an\n   alternative to the specification in Section 3.2.1 of [RFC3779].\n\
    \   The OID for this extension is id-pe-autonomousSysIds-v2.\n   id-pe-autonomousSysIds-v2\
    \  OBJECT IDENTIFIER ::= { id-pe 29 }\n   where [RFC5280] defines:\n   id-pkix\
    \  OBJECT IDENTIFIER ::= { iso(1) identified-organization(3)\n          dod(6)\
    \ internet(1) security(5) mechanisms(5) pkix(7) }\n   id-pe    OBJECT IDENTIFIER\
    \ ::= { id-pkix 1 }\n"
- title: 4.2.2.4.  Syntax for id-pe-autonomousSysIds-v2
  contents:
  - "4.2.2.4.  Syntax for id-pe-autonomousSysIds-v2\n   id-pe-autonomousSysIds-v2\
    \  OBJECT IDENTIFIER ::= { id-pe 29 }\n   ASIdentifiers       ::= SEQUENCE {\n\
    \   asnum               [0] EXPLICIT ASIdentifierChoice OPTIONAL,\n   rdi    \
    \             [1] EXPLICIT ASIdentifierChoice OPTIONAL}\n   ASIdentifierChoice\
    \  ::= CHOICE {\n   inherit              NULL, -- inherit from issuer --\n   asIdsOrRanges\
    \        SEQUENCE OF ASIdOrRange }\n   ASIdOrRange         ::= CHOICE {\n   id\
    \                  ASId,\n   range               ASRange }\n   ASRange       \
    \      ::= SEQUENCE {\n   min                 ASId,\n   max                 ASId\
    \ }\n   ASId                ::= INTEGER\n"
- title: 4.2.2.5.  Amended IP Address Delegation Extension Certification Path
  contents:
  - "4.2.2.5.  Amended IP Address Delegation Extension Certification Path\n      \
    \    Validation\n   Certificate path validation is performed as specified in\n\
    \   Section 4.2.4.4.\n"
- title: 4.2.2.6.  Amended Autonomous System Identifier Delegation Extension
  contents:
  - "4.2.2.6.  Amended Autonomous System Identifier Delegation Extension\n       \
    \   Certification Path Validation\n   Certificate path validation is performed\
    \ as specified in\n   Section 4.2.4.4.\n"
- title: 4.2.2.7.  Amended ASN.1 Module
  contents:
  - "4.2.2.7.  Amended ASN.1 Module\n   Per this document, an OID has been assigned\
    \ for\n   id-mod-ip-addr-and-as-ident-v2, as follows:\n   IPAddrAndASCertExtn-v2\
    \ { iso(1) identified-organization(3) dod(6)\n      internet(1) security(5) mechanisms(5)\
    \ pkix(7) mod(0)\n      id-mod-ip-addr-and-as-ident-v2(90) }\n   The following\
    \ is an amended specification to be used as an\n   alternative to the specification\
    \ in Appendix A of [RFC3779].\n   This normative appendix describes the extensions\
    \ for IP address and\n   AS identifier delegation used by conforming PKI components\
    \ in ASN.1\n   syntax.\n   IPAddrAndASCertExtn-v2 { iso(1) identified-organization(3)\
    \ dod(6)\n      internet(1) security(5) mechanisms(5) pkix(7) mod(0)\n      id-mod-ip-addr-and-as-ident-v2(90)\
    \ }\n   DEFINITIONS EXPLICIT TAGS ::=\n   BEGIN\n   -- EXPORTS ALL --\n   IMPORTS\n\
    \   -- PKIX specific OIDs and arcs --\n   id-pe FROM PKIX1Explicit88 { iso(1)\
    \ identified-organization(3)\n        dod(6) internet(1) security(5) mechanisms(5)\
    \ pkix(7)\n        id-mod(0) id-pkix1-explicit(18) }\n   -- IP Address Block and\
    \ AS Identifiers Syntax --\n   IPAddrBlocks, ASIdentifiers FROM  IPAddrAndASCertExtn\
    \ { iso(1)\n      identified-organization(3) dod(6) internet(1) security(5)\n\
    \      mechanisms(5) pkix(7) mod(0) id-mod-ip-addr-and-as-ident(30) }\n   ;\n\
    \   -- Validation Reconsidered IP Address Delegation Extension OID --\n   id-pe-ipAddrBlocks-v2\
    \  OBJECT IDENTIFIER ::= { id-pe 28 }\n   -- Validation Reconsidered IP Address\
    \ Delegation Extension Syntax --\n   -- Syntax is imported from RFC 3779 --\n\
    \   -- Validation Reconsidered Autonomous System Identifier --\n   --     Delegation\
    \ Extension OID                         --\n   id-pe-autonomousSysIds-v2  OBJECT\
    \ IDENTIFIER ::= { id-pe 29 }\n   -- Validation Reconsidered Autonomous System\
    \ Identifier --\n   --     Delegation Extension Syntax                      --\n\
    \   -- Syntax is imported from RFC 3779 --\n   END\n"
- title: 4.2.3.  Addendum to RFC 6268
  contents:
  - "4.2.3.  Addendum to RFC 6268\n   Per this document, an OID has been assigned\
    \ for\n   id-mod-ip-addr-and-as-ident-2v2 as follows:\n   IPAddrAndASCertExtn-2010v2\
    \ { iso(1) identified-organization(3) dod(6)\n            internet(1) security(5)\
    \ mechanisms(5) pkix(7) mod(0)\n            id-mod-ip-addr-and-as-ident-2v2(91)\
    \ }\n   [RFC6268] is an informational RFC that updates some auxiliary ASN.1\n\
    \   modules to conform to the 2008 version of ASN.1; the 1988 ASN.1\n   modules\
    \ in Section 4.2.2.7 remain the normative version.\n   The following is an additional\
    \ module conforming to the 2008 version\n   of ASN.1 to be used with the extensions\
    \ defined in Sections 4.2.2.1\n   and 4.2.2.3.\n  IPAddrAndASCertExtn-2010v2 {\
    \ iso(1) identified-organization(3) dod(6)\n           internet(1) security(5)\
    \ mechanisms(5) pkix(7) mod(0)\n           id-mod-ip-addr-and-as-ident-2v2(91)\
    \ }\n    DEFINITIONS EXPLICIT TAGS ::=\n    BEGIN\n       EXPORTS ALL;\n     \
    \  IMPORTS\n       -- PKIX specific OIDs and arcs --\n       id-pe\n       FROM\
    \ PKIX1Explicit-2009\n         { iso(1) identified-organization(3) dod(6) internet(1)\n\
    \           security(5) mechanisms(5) pkix(7) id-mod(0)\n           id-mod-pkix1-explicit-02(51)}\n\
    \       EXTENSION\n       FROM PKIX-CommonTypes-2009\n         { iso(1) identified-organization(3)\
    \ dod(6) internet(1)\n           security(5) mechanisms(5) pkix(7) id-mod(0)\n\
    \           id-mod-pkixCommon-02(57)}\n    -- IP Address Block and AS Identifiers\
    \ Syntax --\n       IPAddrBlocks, ASIdentifiers\n       FROM IPAddrAndASCertExtn-2010\n\
    \          { iso(1) identified-organization(3) dod(6)\n            internet(1)\
    \ security(5) mechanisms(5) pkix(7) mod(0)\n            id-mod-ip-addr-and-as-ident-2(72)\
    \ }\n       ;\n       --\n       -- Extensions contain the set of extensions defined\
    \ in this\n       -- module\n       --\n       -- These are intended to be placed\
    \ in public key certificates\n       -- and thus should be added to the CertExtensions\
    \ extension\n       -- set in PKIXImplicit-2009 defined for RFC 5280\n       --\n\
    \       Extensions EXTENSION ::= {\n          ext-pe-ipAddrBlocks-v2 | ext-pe-autonomousSysIds-v2\n\
    \       }\n       -- Validation Reconsidered IP Address Delegation Extension OID\
    \ --\n       ext-pe-ipAddrBlocks-v2 EXTENSION ::= {\n         SYNTAX IPAddrBlocks\n\
    \         IDENTIFIED BY id-pe-ipAddrBlocks-v2\n       }\n       id-pe-ipAddrBlocks-v2\
    \  OBJECT IDENTIFIER ::= { id-pe 28 }\n       -- Validation Reconsidered IP Address\
    \ Delegation --\n       --      Extension Syntax                         --\n\
    \       -- Syntax is imported from RFC 6268 --\n       -- Validation Reconsidered\
    \ Autonomous System Identifier --\n       --      Delegation Extension OID   \
    \                     --\n       ext-pe-autonomousSysIds-v2 EXTENSION ::= {\n\
    \         SYNTAX ASIdentifiers\n         IDENTIFIED BY id-pe-autonomousSysIds-v2\n\
    \       }\n       id-pe-autonomousSysIds OBJECT IDENTIFIER ::= { id-pe 29 }\n\
    \    -- Validation Reconsidered Autonomous System Identifier --\n    --      Delegation\
    \ Extension Syntax                     --\n    -- Syntax is imported from RFC\
    \ 6268 --\n    END\n"
- title: 4.2.4.  An Alternative to the Profile for X.509 PKIX Resource
  contents:
  - "4.2.4.  An Alternative to the Profile for X.509 PKIX Resource\n        Certificates\n\
    \   This document defines an alternative profile for X.509 PKIX Resource\n   Certificates.\
    \  This profile follows all definitions and procedures\n   described in [RFC6487]\
    \ with the following notable exceptions.\n"
- title: 4.2.4.1.  Amended Certificate Policies
  contents:
  - "4.2.4.1.  Amended Certificate Policies\n   The following is an amended specification\
    \ to be used in this profile,\n   in place of Section 4.8.9 of [RFC6487].\n  \
    \ This extension MUST be present and MUST be marked critical.  It MUST\n   include\
    \ exactly one policy of type id-cp-ipAddr-asNumber-v2, as\n   specified in the\
    \ updated RPKI CP in Section 4.2.1.\n"
- title: 4.2.4.2.  Amended IP Resources
  contents:
  - "4.2.4.2.  Amended IP Resources\n   The following is an amended specification\
    \ to be used in this profile,\n   in place of Section 4.8.10 of [RFC6487].\n \
    \  Either the IP resources extension or the AS resources extension, or\n   both,\
    \ MUST be present in all RPKI certificates and MUST be marked\n   critical.\n\
    \   This extension contains the list of IP address resources as per\n   Section\
    \ 4.2.2.1.  The value may specify the \"inherit\" element for a\n   particular\
    \ Address Family Identifier (AFI) value.  In the context of\n   Resource Certificates\
    \ describing public number resources for use in\n   the public Internet, the Subsequent\
    \ AFI (SAFI) value MUST NOT be\n   used.\n   This extension MUST either specify\
    \ a non-empty set of IP address\n   records or use the \"inherit\" setting to\
    \ indicate that the IP address\n   resource set of this certificate is inherited\
    \ from that of the\n   certificate's issuer.\n"
- title: 4.2.4.3.  Amended AS Resources
  contents:
  - "4.2.4.3.  Amended AS Resources\n   The following is an amended specification\
    \ to be used in this profile,\n   in place of Section 4.8.11 of [RFC6487].\n \
    \  Either the AS resources extension or the IP resources extension, or\n   both,\
    \ MUST be present in all RPKI certificates and MUST be marked\n   critical.\n\
    \   This extension contains the list of AS number resources as per\n   Section\
    \ 4.2.2.3, or it may specify the \"inherit\" element.  Routing\n   Domain Identifier\
    \ (RDI) values are NOT supported in this profile and\n   MUST NOT be used.\n \
    \  This extension MUST either specify a non-empty set of AS number\n   records\
    \ or use the \"inherit\" setting to indicate that the AS number\n   resource set\
    \ of this certificate is inherited from that of the\n   certificate's issuer.\n"
- title: 4.2.4.4.  Amended Resource Certificate Path Validation
  contents:
  - "4.2.4.4.  Amended Resource Certificate Path Validation\n   The following is an\
    \ amended specification for path validation to be\n   used in place of Section\
    \ 7.2 of [RFC6487], which allows for the\n   validation of both certificates following\
    \ the profile defined in\n   [RFC6487], as well as certificates following the\
    \ profile described\n   above.\n   The following algorithm is employed to validate\
    \ CA and EE resource\n   certificates.  It is modeled on the path validation algorithm\
    \ from\n   [RFC5280] but is modified to make use of the IP Address Delegation\n\
    \   and AS Identifier Delegation extensions from [RFC3779].\n   There are two\
    \ inputs to the validation algorithm:\n   1.  a trust anchor\n   2.  a certificate\
    \ to be validated\n   The algorithm is initialized with two new variables for\
    \ use in the\n   RPKI: Verified Resource Set-IP (VRS-IP) and Verified Resource\
    \ Set-AS\n   (VRS-AS).  These sets are used to track the set of INRs (IP address\n\
    \   space and AS numbers) that are considered valid for each CA\n   certificate.\
    \  The VRS-IP and VRS-AS sets are initially set to the IP\n   Address Delegation\
    \ and AS Identifier Delegation values, respectively,\n   from the trust anchor\
    \ used to perform validation.\n   This path validation algorithm verifies, among\
    \ other things, that a\n   prospective certification path (a sequence of n certificates)\n\
    \   satisfies the following conditions:\n   a.  for all 'x' in {1, ..., n-1},\
    \ the subject of certificate 'x' is\n       the issuer of certificate ('x' + 1);\n\
    \   b.  certificate '1' is issued by a trust anchor;\n   c.  certificate 'n' is\
    \ the certificate to be validated; and\n   d.  for all 'x' in {1, ..., n}, certificate\
    \ 'x' is valid.\n   Certificate validation requires verifying that all of the\
    \ following\n   conditions hold, in addition to the certification path validation\n\
    \   criteria specified in Section 6 of [RFC5280].\n   1.  The signature of certificate\
    \ x (x>1) is verified using the public\n       key of the issuer's certificate\
    \ (x-1), using the signature\n       algorithm specified for that public key (in\
    \ certificate x-1).\n   2.  The current time lies within the interval defined\
    \ by the\n       NotBefore and NotAfter values in the Validity field of\n    \
    \   certificate x.\n   3.  The Version, Issuer, and Subject fields of certificate\
    \ x satisfy\n       the constraints established in Sections 4.1 to 4.7 of RFC\
    \ 6487.\n   4.  If certificate x uses the Certificate Policy defined in\n    \
    \   Section 4.8.9 of [RFC6487], then the certificate MUST contain all\n      \
    \ extensions defined in Section 4.8 of [RFC6487] that must be\n       present.\
    \  The value(s) for each of these extensions MUST satisfy\n       the constraints\
    \ established for each extension in the respective\n       sections.  Any extension\
    \ not thus identified MUST NOT appear in\n       certificate x.\n   5.  If certificate\
    \ x uses the Certificate Policy defined in\n       Section 4.2.4.1, then all extensions\
    \ defined in Section 4.8 of\n       [RFC6487], except Sections 4.8.9, 4.8.10,\
    \ and 4.8.11 MUST be\n       present.  The certificate MUST contain an extension\
    \ as defined in\n       Sections 4.2.4.2 or 4.2.4.3, or both.  The value(s) for\
    \ each of\n       these extensions MUST satisfy the constraints established for\n\
    \       each extension in the respective sections.  Any extension not\n      \
    \ thus identified MUST NOT appear in certificate x.\n   6.  Certificate x MUST\
    \ NOT have been revoked, i.e., it MUST NOT\n       appear on a Certificate Revocation\
    \ List (CRL) issued by the CA\n       represented by certificate x-1.\n   7. \
    \ Compute the VRS-IP and VRS-AS set values as indicated below:\n       *  If the\
    \ IP Address Delegation extension is present in\n          certificate x and x=1,\
    \ set the VRS-IP to the resources found\n          in this extension.\n      \
    \ *  If the IP Address Delegation extension is present in\n          certificate\
    \ x and x>1, set the VRS-IP to the intersection of\n          the resources between\
    \ this extension and the value of the\n          VRS-IP computed for certificate\
    \ x-1.\n       *  If the IP Address Delegation extension is absent in\n      \
    \    certificate x, set the VRS-IP to NULL.\n       *  If the IP Address Delegation\
    \ extension is present in\n          certificate x and x=1, set the VRS-IP to\
    \ the resources found\n          in this extension.\n       *  If the AS Identifier\
    \ Delegation extension is present in\n          certificate x and x>1, set the\
    \ VRS-AS to the intersection of\n          the resources between this extension\
    \ and the value of the\n          VRS-AS computed for certificate x-1.\n     \
    \  *  If the AS Identifier Delegation extension is absent in\n          certificate\
    \ x, set the VRS-AS to NULL.\n   8.  If there is any difference in resources in\
    \ the VRS-IP and the IP\n       Address Delegation extension on certificate x,\
    \ or the VRS-AS and\n       the AS Identifier Delegation extension on certificate\
    \ x, then:\n       *  If certificate x uses the Certificate Policy defined in\n\
    \          Section 4.2.4.1, a warning listing the overclaiming resources\n   \
    \       for certificate x SHOULD be issued.\n       *  If certificate x uses the\
    \ Certificate Policy defined in\n          Section 4.8.9 of [RFC6487], then certificate\
    \ x MUST be\n          rejected.\n   These rules allow a CA certificate to contain\
    \ resources that are not\n   present in (all of) the certificates along the path\
    \ from the trust\n   anchor to the CA certificate.  If none of the resources in\
    \ the CA\n   certificate are present in all certificates along the path, no\n\
    \   subordinate certificates could be valid.  However, the certificate is\n  \
    \ not immediately rejected as this may be a transient condition.  Not\n   immediately\
    \ rejecting the certificate does not result in a security\n   problem because\
    \ the associated VRS sets accurately reflect the\n   resources validly associated\
    \ with the certificate in question.\n"
- title: 4.2.5.  An Alternative ROA Validation
  contents:
  - "4.2.5.  An Alternative ROA Validation\n   Section 4 of [RFC6482] currently has\
    \ the following text on the\n   validation of resources on a ROA:\n      The IP\
    \ address delegation extension [RFC3779] is present in the\n      end-entity (EE)\
    \ certificate (contained within the ROA), and each\n      IP address prefix(es)\
    \ in the ROA is contained within the set of IP\n      addresses specified by the\
    \ EE certificate's IP address delegation\n      extension.\n   If the end entity\
    \ certificate uses the Certificate Policy defined in\n   Section 4.2.4.1, then\
    \ the following approach must be used instead.\n      The amended IP Address Delegation\
    \ extension described in\n      Section 4.2.4.2 is present in the end entity (EE)\
    \ certificate\n      (contained within the ROA), and each IP address prefix(es)\
    \ in the\n      ROA is contained within the VRS-IP set that is specified as an\n\
    \      outcome of EE certificate validation described in Section 4.2.4.4.\n  \
    \ Note that this ensures that ROAs can be valid only if all IP address\n   prefixes\
    \ in the ROA are encompassed by the VRS-IP of all certificates\n   along the path\
    \ to the trust anchor used to verify it.\n   Operators MAY issue separate ROAs\
    \ for each IP address prefix, so that\n   the loss of one or more IP address prefixes\
    \ from the VRS-IP of any\n   certificate along the path to the trust anchor would\
    \ not invalidate\n   authorizations for other IP address prefixes.\n"
- title: 4.2.6.  An Alternative to BGPsec Router Certificate Validation
  contents:
  - "4.2.6.  An Alternative to BGPsec Router Certificate Validation\n   If a BGPsec\
    \ Router Certificate [RFC8209] uses the Certificate Policy\n   defined in Section\
    \ 4.2.4.1, then in addition to the BGPsec Router\n   Certificate Validation defined\
    \ in Section 3.3 of [RFC8209], the\n   following constraint MUST be met:\n   o\
    \  The VRS-AS of BGPsec Router Certificates MUST encompass all\n      Autonomous\
    \ System Numbers (ASNs) in the AS Resource Identifier\n      Delegation extension.\n\
    \   Operators MAY issue separate BGPsec Router Certificates for different\n  \
    \ ASNs, so that the loss of an ASN from the VRS-AS of any certificate\n   along\
    \ the path to the trust anchor would not invalidate router keys\n   for other\
    \ ASNs.\n"
- title: 5.  Validation Examples
  contents:
  - "5.  Validation Examples\n   In this section, we will demonstrate the outcome\
    \ of RPKI validation\n   performed using the algorithm and procedures described\
    \ in Sections\n   4.2.4.4, 4.2.5, and 4.2.6, under three deployment scenarios:\n\
    \   o  An RPKI tree consisting of certificates using the old OIDs only\n   o \
    \ An RPKI tree consisting of certificates using the new OIDs only\n   o  An RPKI\
    \ tree consisting of a mix of certificates using either the\n      old or the\
    \ new OIDs\n   In this context, we refer to a certificate as using the 'old' OIDs,\n\
    \   if the certificate uses a combination of the OIDs defined in\n   Section 1.2\
    \ of [RFC6484], Section 2.2.1 of [RFC3779], and/or\n   Section 3.2.1 of [RFC3779].\
    \  We refer to a certificate as using the\n   'new' OIDS, if the certificate uses\
    \ a combination of OIDs defined in\n   Sections 4.2.4.1, 4.2.2.1, and/or Section\
    \ 4.2.2.3.\n"
- title: 5.1.  Example 1 -- An RPKI Tree Using the Old OIDs Only
  contents:
  - "5.1.  Example 1 -- An RPKI Tree Using the Old OIDs Only\n   Consider the following\
    \ example:\n     Certificate 1 (trust anchor):\n      Issuer: TA,\n      Subject:\
    \ TA,\n      OIDs: OLD,\n      Resources: 0/0, ::0, AS0-4294967295 (all resources)\n\
    \       Verified Resource Set: 0/0, ::0, AS0-4294967295 (all resources)\n    \
    \   Warnings: none\n     Certificate 2:\n      Issuer: TA,\n      Subject: CA1,\n\
    \      OIDs: OLD,\n      Resources: 192.0.2.0/24, 2001:db8::/32, AS64496\n   \
    \    Verified Resource Set: 192.0.2.0/24,\n                              2001:db8::/32,\
    \ AS64496\n       Warnings: none\n     Certificate 3 (invalid):\n      Issuer:\
    \ CA1,\n      Subject: CA2,\n      OIDs: OLD,\n      Resources: 192.0.2.0/24,\
    \ 198.51.100.0/24, AS64496\n       Verified Resource Set: 192.0.2.0/24, AS64496\n\
    \       Certificate 3 is considered invalid because resources\n       contains\
    \ 198.51.100.0/24, which is not found in the\n       Verified Resource Set.\n\
    \     ROA 1 (invalid):\n      Embedded Certificate 4 (EE certificate invalid):\n\
    \       Issuer: CA2,\n       Subject: R1,\n       OIDs: OLD,\n       Resources:\
    \ 192.0.2.0/24\n         Prefix 192.0.2.0/24, Max Length 24, ASN 64496\n     \
    \  ROA1 is considered invalid because Certificate 3 is invalid.\n     ROA 2 (invalid):\n\
    \      Embedded Certificate 5 (EE certificate invalid):\n       Issuer: CA2,\n\
    \       Subject: R2,\n       OIDs: OLD,\n       Resources: 198.51.100.0/24\n \
    \       Prefix 198.51.100.0/24, Max Length 24, ASN 64496\n       ROA2 is considered\
    \ invalid because Certificate 3 is invalid.\n     BGPsec Certificate 1 (invalid):\n\
    \      Issuer: CA2,\n      Subject: ROUTER-64496,\n      OIDs: NEW,\n      Resources:\
    \ AS64496\n       BGPsec Certificate 1 is invalid because Certificate 3 is invalid.\n\
    \     BGPsec Certificate 2 (invalid):\n      Issuer: CA2,\n      Subject: ALL-ROUTERS,\n\
    \      OIDs: NEW,\n      Resources: AS64496-AS64497\n       BGPsec Certificate\
    \ 2 is invalid because Certificate 3 is invalid.\n"
- title: 5.2.  Example 2 -- An RPKI Tree Using the New OIDs Only
  contents:
  - "5.2.  Example 2 -- An RPKI Tree Using the New OIDs Only\n   Consider the following\
    \ example under the amended approach:\n     Certificate 1 (trust anchor):\n  \
    \    Issuer: TA,\n      Subject: TA,\n      OIDs: NEW,\n      Resources: 0/0,\
    \ ::0, AS0-4294967295 (all resources)\n       Verified Resource Set: 0/0, ::0,\
    \ AS0-4294967295 (all resources)\n       Warnings: none\n     Certificate 2:\n\
    \      Issuer: TA,\n      Subject: CA1,\n      OIDs: NEW,\n      Resources: 192.0.2.0/24,\
    \ 2001:db8::/32, AS64496\n       Verified Resource Set: 192.0.2.0/24,\n      \
    \                        2001:db8::/32, AS64496\n       Warnings: none\n     Certificate\
    \ 3:\n      Issuer: CA1,\n      Subject: CA2,\n      OIDs: NEW,\n      Resources:\
    \ 192.0.2.0/24, 198.51.100.0/24, AS64496\n       Verified Resource Set: 192.0.2.0/24,\
    \ AS64496\n       Warnings: overclaim for 198.51.100.0/24\n     ROA 1 (valid):\n\
    \      Embedded Certificate 4 (EE certificate):\n       Issuer: CA2,\n       Subject:\
    \ R1,\n       OIDs: NEW,\n       Resources: 192.0.2.0/24\n        Prefix 192.0.2.0/24,\
    \ Max Length 24, ASN 64496\n        Verified Resource Set: 192.0.2.0/24\n    \
    \    Warnings: none\n       ROA1 is considered valid because the prefix matches\
    \ the Verified\n       Resource Set on the embedded EE certificate.\n     ROA\
    \ 2 (invalid):\n      Embedded Certificate 5 (EE certificate invalid):\n     \
    \  Issuer: CA2,\n       Subject: R2,\n       OIDs: NEW,\n       Resources: 198.51.100.0/24\n\
    \         Prefix 198.51.100.0/24, Max Length 24, ASN 64496\n         Verified\
    \ Resource Set: none (empty set)\n         Warnings: 198.51.100.0/24\n       ROA2\
    \ is considered invalid because the ROA prefix 198.51.100.0/24\n       is not\
    \ contained in the Verified Resource Set.\n     BGPsec Certificate 1 (valid):\n\
    \      Issuer: CA2,\n      Subject: ROUTER-64496,\n      OIDs: NEW,\n      Resources:\
    \ AS64496\n       Verified Resource Set: AS64496\n       Warnings: none\n    \
    \ BGPsec Certificate 2 (invalid):\n      Issuer: CA2,\n      Subject: ALL-ROUTERS,\n\
    \      OIDs: NEW,\n      Resources: AS64496-AS64497\n        Verified Resource\
    \ Set: AS64496\n       BGPsec Certificate 2 is invalid because not all of its\
    \ resources\n       are contained in the Verified Resource Set.\n       Note that\
    \ this problem can be mitigated by issuing separate\n       certificates for each\
    \ AS number.\n"
- title: 5.3.  Example 3 -- An RPKI Tree Using a Mix of Old and New OIDs
  contents:
  - "5.3.  Example 3 -- An RPKI Tree Using a Mix of Old and New OIDs\n   In the following\
    \ example, new OIDs are used only for CA certificates\n   where the issuing CA\
    \ anticipates that an overclaim could occur and\n   has a desire to limit the\
    \ impact of this to just the overclaimed\n   resources in question:\n   Certificate\
    \ 1 (trust anchor):\n    Issuer: TA,\n    Subject: TA,\n    OIDs: OLD,\n    Resources:\
    \ 0/0, ::0, AS0-4294967295 (all resources)\n     Verified Resource Set: 0/0, ::0,\
    \ AS0-4294967295 (all resources)\n     Warnings: none\n     Note that a trust\
    \ anchor certificate cannot be found to\n     overclaim.  So, using the new OIDs\
    \ here would not change\n     anything with regards to the validity of this certificate.\n\
    \   Certificate 2:\n    Issuer: TA,\n    Subject: CA1,\n    OIDs: OLD,\n    Resources:\
    \ 192.0.2.0/24, 2001:db8::/32, AS64496\n     Verified Resource Set: 192.0.2.0/24,\n\
    \                            2001:db8::/32, AS64496\n     Warnings: none\n   \
    \  Note that since the TA certificate claims all resources, it\n     is impossible\
    \ to issue a certificate below it that could be\n     found to be overclaiming.\
    \  Therefore, there is no benefit\n     in using the new OIDs for Certificate\
    \ 2.\n   Certificate 3:\n    Issuer: CA1,\n    Subject: CA2,\n    OIDs: NEW,\n\
    \    Resources: 192.0.2.0/24, 198.51.100.0/24, AS64496\n     Verified Resource\
    \ Set: 192.0.2.0/24, AS64496\n     Warnings: overclaim for 198.51.100.0/24\n \
    \    Note that CA1 anticipated that it might invalid Certificate 3\n     issued\
    \ to CA2, if its own resources on Certificate 2 were\n     modified and old OIDs\
    \ were used on Certificate 3.\n   ROA 1 (valid):\n    Embedded Certificate 4 (EE\
    \ certificate):\n     Issuer: CA2,\n     Subject: R1,\n     OIDs: OLD,\n     Resources:\
    \ 192.0.2.0/24\n      Prefix 192.0.2.0/24, Max Length 24, ASN 64496\n      Verified\
    \ Resource Set: 192.0.2.0/24\n      Warnings: none\n     ROA1 is considered valid\
    \ because the prefix matches the Verified\n     Resource Set on the embedded EE\
    \ certificate.\n   ROA 2 (invalid):\n    Embedded Certificate 5 (EE certificate\
    \ invalid):\n     Issuer: CA2,\n     Subject: R2,\n     OIDs: OLD,\n     Resources:\
    \ 198.51.100.0/24\n       Prefix 198.51.100.0/24, Max Length 24, ASN 64496\n \
    \      Verified Resource Set: none (empty set)\n     ROA2 is considered invalid\
    \ because resources on its EE\n     certificate contains 198.51.100.0/24, which\
    \ is not contained\n     in its Verified Resource Set.\n     Note that if new\
    \ OIDs were used here (as in example 2), ROA 2\n     would be considered invalid\
    \ because the prefix is not\n     contained in the Verified Resource Set.\n  \
    \   So, if there is no difference in the validity outcome, one could\n     argue\
    \ that using old OIDs here is clearest, because any\n     overclaim of ROA prefixes\
    \ MUST result in it being considered\n     invalid (as described in Section 4.2.5).\n\
    \   BGPsec Certificate 1 (valid):\n    Issuer: CA2,\n    Subject: ROUTER-64496,\n\
    \    OIDs: OLD,\n    Resources: AS64496\n     Verified Resource Set: AS64496\n\
    \     Warnings: none\n   BGPsec Certificate 2 (invalid):\n    Issuer: CA2,\n \
    \   Subject: ALL-ROUTERS,\n    OIDs: OLD,\n    Resources: AS64496-AS64497\n  \
    \    Verified Resource Set: AS64496\n     BGPsec Certificate 2 is considered invalid\
    \ because resources\n     contains AS64497, which is not contained in its Verified\
    \ Resource\n     Set.\n     Note that if new OIDs were used here (as in example\
    \ 2), BGPsec\n     Certificate 2 would be considered invalid because the prefix\
    \ is not\n     contained in the Verified Resource Set.\n     So, if there is no\
    \ difference in the validity outcome, one could\n     argue that using old OIDs\
    \ here is the clearest, because any\n     overclaim on this certificate MUST result\
    \ in it being considered\n     invalid (as described in Section 4.2.6).\n    \
    \ Also note that, as in example 2, this problem can be mitigated by\n     issuing\
    \ separate certificates for each AS number.\n"
- title: 6.  Deployment Considerations
  contents:
  - "6.  Deployment Considerations\n   This document defines an alternative RPKI validation\
    \ algorithm, but\n   it does not dictate how this algorithm will be deployed.\
    \  This should\n   be discussed as a separate effort.  That said, the following\n\
    \   observations may help this discussion.\n   Because this document introduces\
    \ new OIDs and an alternative to the\n   profile for X.509 PKIX Resource Certificates\
    \ described in [RFC6487],\n   the use of such certificates in the global RPKI\
    \ will lead to the\n   rejection of such certificates by Relying Party tools that\
    \ do not\n   (yet) implement the alternative profile described in this document.\n\
    \   For this reason, it is important that such tools are updated before\n   Certification\
    \ Authorities start to use this specification.\n   However, because the OIDs are\
    \ defined in each RPKI certificate, there\n   is no strict requirement for all\
    \ Certification Authorities, or even\n   for all the certificates they issue,\
    \ to migrate to the new OIDs at\n   the same time.  The example in Section 5.3\
    \ illustrates a possible\n   deployment where the new OIDs are used only in CA\
    \ certificates where\n   an accidental overclaim may occur.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   The authors believe that the revised validation\
    \ algorithm introduces\n   no new security vulnerabilities into the RPKI, because\
    \ it cannot lead\n   to any ROA and/or router certificates to be accepted if they\
    \ contain\n   resources that are not held by the issuer.\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   IANA has added the following to the \"SMI Security\
    \ for PKIX\n   Certificate Policies\" registry:\n         Decimal  Description\
    \                       References\n           3     id-cp-ipAddr-asNumber-v2\
    \           Section 4.2.1\n   IANA has added the following to the \"SMI Security\
    \ for PKIX\n   Certificate Extension\" registry:\n         Decimal  Description\
    \                       References\n           28     id-pe-ipAddrBlocks-v2  \
    \           Section 4.2.2.1\n           29     id-pe-autonomousSysIds-v2     \
    \    Section 4.2.2.3\n   IANA has added the following to the \"SMI Security for\
    \ PKIX Module\n   Identifier\" registry:\n         Decimal  Description      \
    \                 References\n           90   id-mod-ip-addr-and-as-ident-v2 \
    \     Section 4.2.2.7\n           91   id-mod-ip-addr-and-as-ident-2v2     Section\
    \ 4.2.3\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n  \
    \            DOI 10.17487/RFC2119, March 1997,\n              <https://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC3779]  Lynn, C., Kent, S., and K. Seo, \"X.509 Extensions for IP\n   \
    \           Addresses and AS Identifiers\", RFC 3779,\n              DOI 10.17487/RFC3779,\
    \ June 2004,\n              <https://www.rfc-editor.org/info/rfc3779>.\n   [RFC5280]\
    \  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,\n              Housley,\
    \ R., and W. Polk, \"Internet X.509 Public Key\n              Infrastructure Certificate\
    \ and Certificate Revocation List\n              (CRL) Profile\", RFC 5280, DOI\
    \ 10.17487/RFC5280, May 2008,\n              <https://www.rfc-editor.org/info/rfc5280>.\n\
    \   [RFC6482]  Lepinski, M., Kent, S., and D. Kong, \"A Profile for Route\n  \
    \            Origin Authorizations (ROAs)\", RFC 6482,\n              DOI 10.17487/RFC6482,\
    \ February 2012,\n              <https://www.rfc-editor.org/info/rfc6482>.\n \
    \  [RFC6484]  Kent, S., Kong, D., Seo, K., and R. Watro, \"Certificate\n     \
    \         Policy (CP) for the Resource Public Key Infrastructure\n           \
    \   (RPKI)\", BCP 173, RFC 6484, DOI 10.17487/RFC6484, February\n            \
    \  2012, <https://www.rfc-editor.org/info/rfc6484>.\n   [RFC6487]  Huston, G.,\
    \ Michaelson, G., and R. Loomans, \"A Profile for\n              X.509 PKIX Resource\
    \ Certificates\", RFC 6487,\n              DOI 10.17487/RFC6487, February 2012,\n\
    \              <https://www.rfc-editor.org/info/rfc6487>.\n   [RFC8174]  Leiba,\
    \ B., \"Ambiguity of Uppercase vs Lowercase in RFC\n              2119 Key Words\"\
    , BCP 14, RFC 8174, DOI 10.17487/RFC8174,\n              May 2017, <https://www.rfc-editor.org/info/rfc8174>.\n\
    \   [RFC8209]  Reynolds, M., Turner, S., and S. Kent, \"A Profile for\n      \
    \        BGPsec Router Certificates, Certificate Revocation Lists,\n         \
    \     and Certification Requests\", RFC 8209,\n              DOI 10.17487/RFC8209,\
    \ September 2017,\n              <https://www.rfc-editor.org/info/rfc8209>.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [RFC6268]  Schaad, J. and S. Turner, \"Additional\
    \ New ASN.1 Modules\n              for the Cryptographic Message Syntax (CMS)\
    \ and the Public\n              Key Infrastructure Using X.509 (PKIX)\", RFC 6268,\n\
    \              DOI 10.17487/RFC6268, July 2011,\n              <https://www.rfc-editor.org/info/rfc6268>.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   The authors would like to thank Stephen Kent for reviewing\
    \ and\n   contributing to this document.  We would like to thank Rob Austein\n\
    \   for suggesting that separate OIDs should be used to make the behavior\n  \
    \ of Relying Party tools deterministic, and we would like to thank Russ\n   Housley,\
    \ Sean Turner, and Tom Petch for their contributions on OID\n   and ASN.1 updates.\
    \  Finally, we would like to thank Tom Harrison for\n   a general review of this\
    \ document.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Geoff Huston\n   Asia Pacific Network Information Centre\n\
    \   6 Cordelia St\n   South Brisbane, QLD  4101\n   Australia\n   Phone: +61 7\
    \ 3858 3100\n   Email: gih@apnic.net\n   George Michaelson\n   Asia Pacific Network\
    \ Information Centre\n   6 Cordelia St\n   South Brisbane, QLD  4101\n   Australia\n\
    \   Phone: +61 7 3858 3100\n   Email: ggm@apnic.net\n   Carlos M. Martinez\n \
    \  Latin American and Caribbean Internet Address Registry\n   Rambla Mexico 6125\n\
    \   Montevideo  11400\n   Uruguay\n   Phone: +598 2604 2222\n   Email: carlos@lacnic.net\n\
    \   Tim Bruijnzeels\n   RIPE Network Coordination Centre\n   Singel 258\n   Amsterdam\
    \  1016 AB\n   The Netherlands\n   Email: tim@ripe.net\n   Andrew Lee Newton\n\
    \   American Registry for Internet Numbers\n   3635 Concorde Parkway\n   Chantilly,\
    \ VA  20151\n   United States of America\n   Email: andy@arin.net\n   Daniel Shaw\n\
    \   African Network Information Centre (AFRINIC)\n   11th Floor, Standard Chartered\
    \ Tower\n   Cybercity, Ebene\n   Mauritius\n   Phone: +230 403 51 00\n   Email:\
    \ daniel@afrinic.net\n"
