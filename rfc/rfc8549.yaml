- title: __initial_text__
  contents:
  - "                 Export of BGP Community Information in\n                   IP\
    \ Flow Information Export (IPFIX)\n"
- title: Abstract
  contents:
  - "Abstract\n   By introducing new Information Elements (IEs), this document extends\n\
    \   the existing BGP-related IEs to enable IP Flow Information Export\n   (IPFIX)\
    \ to export BGP community information, including the BGP\n   Standard Communities\
    \ defined in RFC 1997, BGP Extended Communities\n   defined in RFC 4360, and BGP\
    \ Large Communities defined in RFC 8092.\n   According to the network operator's\
    \ BGP community planning, network\n   traffic information can then be accumulated\
    \ and analyzed at the BGP\n   community granularity, which represents the traffic\
    \ of different\n   kinds of customers, services, or geographical regions.  Network\n\
    \   traffic information at the BGP community granularity is useful for\n   network\
    \ traffic analysis and engineering.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8549.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2019 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................5\n  \
    \ 3. Traffic Collection Based on BGP Community .......................6\n   4.\
    \ IEs for BGP Standard Community ..................................7\n   5. IEs\
    \ for BGP Extended Community ..................................8\n   6. IEs for\
    \ BGP Large Community .....................................8\n   7. Operational\
    \ Considerations ......................................9\n   8. Security Considerations\
    \ ........................................10\n   9. IANA Considerations ............................................11\n\
    \   10. References ....................................................13\n  \
    \    10.1. Normative References .....................................13\n    \
    \  10.2. Informative References ...................................14\n   Appendix\
    \ A.  Encoding Example .....................................16\n     A.1.  Template\
    \ Record ...........................................16\n     A.2.  Data Set ..................................................17\n\
    \   Acknowledgements ..................................................18\n  \
    \ Authors' Addresses ................................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   IP Flow Information Export (IPFIX) [RFC7011] provides network\n\
    \   administrators with traffic flow information using the Information\n   Elements\
    \ (IEs) defined in the \"IPFIX Information Elements\" registry\n   [IANA-IPFIX].\
    \  Based on the traffic flow information, network\n   administrators know the\
    \ amount and direction of the traffic in their\n   network and can then optimize\
    \ the network when needed.  For example,\n   the collected information could be\
    \ used for traffic monitoring and,\n   optionally, for traffic optimization according\
    \ to the operator's\n   policy.\n   The \"IPFIX Information Elements\" registry\
    \ [IANA-IPFIX] defines the\n   following IEs for traffic flow information export\
    \ in different\n   granularities: sourceIPv4Address, sourceIPv4Prefix,\n   destinationIPv4Address,\
    \ destinationIPv4Prefix, bgpSourceAsNumber,\n   bgpDestinationAsNumber, bgpNextHopIPv4Address,\
    \ etc.  In some\n   circumstances, however, traffic flow information based on\
    \ these IEs\n   may not be completely suitable or sufficient, especially when\
    \ traffic\n   engineering and optimization are executed in Tier 1 or Tier 2\n\
    \   operators' backbone networks.  For example, flow information based on\n  \
    \ IP address or IP prefix may provide much too fine granularity for a\n   large\
    \ network.  On the contrary, flow information based on Autonomous\n   System Number\
    \ (ASN) may be too coarse.\n   BGP community is a BGP path attribute that includes\
    \ Standard\n   Communities [RFC1997], Extended Communities [RFC4360], and Large\n\
    \   Communities [RFC8092].  The BGP community attribute has a variety of\n   use\
    \ cases, one of which is to use BGP community with planned specific\n   values\
    \ to represent groups of customers, services, and geographical\n   or topological\
    \ regions, as used by operators in their networks.\n   Detailed examples can be\
    \ found in [RFC4384], [RFC8195], and Section 3\n   of this document.  To understand\
    \ the traffic generated 1) by\n   different kinds of customers, 2) from different\
    \ geographical or\n   topological regions, or 3) by different kinds of customers\
    \ from\n   different regions, we need the community information corresponding\
    \ to\n   the traffic flow information exported by IPFIX.  Network traffic\n  \
    \ statistics at the BGP community granularity are useful not only for\n   traffic\
    \ analysis, but also for use by other applications, such as\n   traffic optimization\
    \ applications located in an IPFIX Collector,\n   Software-Defined Networking\
    \ (SDN) controller, or PCE.  [COMMUNITY-TE]\n   also states that analyzing network\
    \ traffic information at the BGP\n   community granularity is preferred for inbound\
    \ traffic engineering.\n   However, the \"IPFIX Information Elements\" registry\
    \ [IANA-IPFIX]\n   lacked IEs defined for the BGP community attribute.\n   Flow\
    \ information based on the BGP community attribute may be\n   collected by an\
    \ IPFIX Mediator (defined in [RFC6183]).  The IPFIX\n   Mediator is responsible\
    \ for the correlation between flow information\n   and the BGP community attribute.\
    \  However, no IEs are defined in\n   [RFC6183] for exporting BGP community information\
    \ in IPFIX.\n   Furthermore, to correlate the BGP community attribute with the\
    \ flow\n   information, the IPFIX Mediator needs to learn BGP routes and perform\n\
    \   lookups in the BGP routing table to get the matching entry for a\n   specific\
    \ flow.  BGP route learning and routing table lookup are not\n   trivial for an\
    \ IPFIX Mediator.  The IPFIX Mediator is mainly\n   introduced to reduce the performance\
    \ requirement for the Exporter\n   [RFC5982].  In fact, to obtain information\
    \ for the already-defined\n   BGP-related IEs, such as bgpSourceAsNumber, bgpDestinationAsNumber,\n\
    \   and bgpNextHopIPv4Address, etc., the Exporter has to hold the up-to-\n   date\
    \ BGP routing table and perform lookups in the table.  The\n   Exporter can obtain\
    \ the BGP community information in the same\n   procedure; thus, the additional\
    \ load added by exporting BGP community\n   information is minimal if the Exporter\
    \ is already exporting the\n   existing BGP-related IEs.  It is RECOMMENDED that\
    \ the BGP community\n   information be exported by the Exporter directly using\
    \ IPFIX.\n   By running BGP [RFC4271] or the BGP Monitoring Protocol (BMP)\n \
    \  [RFC7854] and performing lookups in the BGP routing table to\n   correlate\
    \ the matching entry for a specific flow, IPFIX Collectors\n   and other applications,\
    \ such as an SDN controller or PCE, can\n   determine the network traffic at the\
    \ BGP community granularity.\n   However, running BGP or BMP and performing routing\
    \ table lookup are\n   not trivial for the IPFIX Collectors and other applications.\n\
    \   Moreover, correlation between IPFIX flow information and the BGP RIB\n   on\
    \ the Exporter (such as a router) is more accurate compared to the\n   correlation\
    \ on a Collector, since the BGP routing table may be\n   updated when the IPFIX\
    \ Collectors and other applications receive the\n   IPFIX flow information.  As\
    \ stated above, the Exporter can obtain the\n   BGP community information during\
    \ the same procedure when it obtains\n   other BGP-related information.  Therefore,\
    \ exporting the BGP\n   community information directly by the Exporter to the\
    \ Collector is\n   both efficient and accurate.  If the IPFIX Collectors and other\n\
    \   applications only want to determine the network traffic at the BGP\n   community\
    \ granularity, they do not need to run the full BGP or BMP\n   protocols when\
    \ the BGP community information can be obtained by\n   IPFIX.  However, BMP has\
    \ its own application scenario, and the\n   mechanism introduced in this document\
    \ is not meant to replace it.\n   By introducing new IEs, this document extends\
    \ the existing BGP-\n   related IEs to enable IPFIX [RFC7011] to export BGP community\n\
    \   information, including the BGP Standard Communities [RFC1997], BGP\n   Extended\
    \ Communities [RFC4360], and BGP Large Communities [RFC8092].\n   Flow information\
    \ (including packetDeltaCount [RFC7011] [RFC7012],\n   octetDeltaCount [RFC7011]\
    \ [RFC7012], etc.) can then be accumulated\n   and analyzed by the Collector or\
    \ other applications, such as an SDN\n   controller or PCE [RFC4655], at the BGP\
    \ community granularity.  This\n   is useful for measuring the traffic generated\
    \ 1) by different kinds\n   of customers or 2) from different geographical or\
    \ topological regions\n   according to the operator's BGP community plan.  Flow\
    \ information can\n   then be used by the traffic engineering or traffic optimization\n\
    \   applications, especially in the backbone network.\n   The IEs introduced in\
    \ this document are applicable to both IPv4 and\n   IPv6 traffic.  Both the Exporter\
    \ and the IPFIX Mediator can use these\n   IEs to export BGP community information\
    \ in IPFIX.  When needed, the\n   IPFIX Mediator or Collector can use these IEs\
    \ to report BGP\n   community-related traffic flow information it gets either\
    \ from\n   Exporters or through local correlation to other IPFIX devices.\n  \
    \ As stated above, the method introduced in this document is not the\n   sole,\
    \ definitive one for obtaining BGP community information related\n   to a specific\
    \ traffic flow, but it is possible, efficient, and\n   accurate.\n   No new BGP\
    \ community attributes are defined in this document.\n   Note that this document\
    \ does not update the IPFIX specification\n   [RFC7011] or information model [RFC7012].\
    \  Rather, the \"IPFIX\n   Information Elements\" registry [IANA-IPFIX] contains\
    \ the current\n   complete reference for IPFIX Information Elements, per Section\
    \ 1 of\n   [RFC7012].\n   Please refer to the \"IPFIX Information Elements\" registry\n\
    \   [IANA-IPFIX] for the complete list of BGP-related IEs.\n   Please refer to\
    \ Appendix A of this document for the encoding example\n   and Section 3 for a\
    \ detailed use case.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\"\
    , \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described\
    \ in\n   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n\
    \   capitals, as shown here.\n   The IPFIX-specific terminology used in this document\
    \ is defined in\n   Section 2 of [RFC7011] and Section 2 of [RFC6183].\n   This\
    \ document uses the term \"BGP Standard Community\" to refer to the\n   BGP community\
    \ attribute defined in [RFC1997] in order to distinguish\n   it from BGP Extended\
    \ Community [RFC4360] and Large Community\n   [RFC8092].\n"
- title: 3.  Traffic Collection Based on BGP Community
  contents:
  - "3.  Traffic Collection Based on BGP Community\n   [RFC4384] introduces the mechanism\
    \ of using BGP Standard Community\n   and Extended Community to collect geographical\
    \ and topological\n   information in the BGP routing system.  [RFC8195] gives\
    \ some examples\n   of the application of BGP Large Communities to represent the\n\
    \   geographical regions.  Since the network traffic at the BGP community\n  \
    \ granularity represents the traffic generated 1) by different kinds of\n   customers\
    \ or 2) from different geographical regions according to the\n   network operator's\
    \ BGP community plan, it is useful for network\n   operators to analyze and optimize\
    \ the network traffic among different\n   customers and regions.  This section\
    \ gives a use case in which the\n   network operator uses traffic information\
    \ based on BGP community to\n   adjust the network paths for different traffic\
    \ flows.\n   Consider the following scenario.  Autonomous System (AS) C provides\
    \ a\n   transit connection between ASes A and B.  By tagging different BGP\n \
    \  communities, the routes of AS A and B are categorized into several\n   groups\
    \ in the operator's plan.  For example, communities A:X and A:Y\n   are used for\
    \ routes that originated from different geographical\n   regions in AS A, and\
    \ communities B:M and B:N are used for routes\n   representing the different kinds\
    \ of customers in AS B (e.g., B:M is\n   for mobile customers and B:N is for fixed\
    \ line customers).  By\n   default, all traffic originating from AS A and destined\
    \ for AS B\n   (i.e., traffic A-B) goes through path C1-C2-C3 (i.e., Path-1) in\
    \ AS\n   C.  When the link between C1 and C2 is congested, we cannot simply\n\
    \   steer all the traffic A-B from Path-1 to Path C1-C4-C3 (i.e., Path-2)\n  \
    \ because it will cause congestion in Path-2.\n                              \
    \  +----------+\n                                | PCE/SDN  |\n              \
    \          +-------|Controller|-------+\n                        |       +----------+\
    \       |\n                        |                          |\n            \
    \            |           AS C           |\n                |       |       +----------+\
    \       |       |\n                |       |   +---|Router C2 |---+   |      \
    \ |\n                |       |   |   +----------+   |   |       |\n       AS A\
    \     |       |   |100             50|   |       |     AS B\n    +--------+  |\
    \  +---------+                +---------+  |  +--------+\n    |Router A|--|--|Router\
    \ C1|                |Router C3|--|--|Router B|\n    +--------+  |  +---------+\
    \                +---------+  |  +--------+\n    Community:  |           |100\
    \            100|           |  Community:\n        A:X     |           |   +----------+\
    \   |           |     B:M\n        A:Y     |           +---|Router C4 |---+  \
    \         |     B:N\n                                +----------+\n          \
    \  Figure 1: Traffic Collection Based on BGP Community\n   If the PCE/SDN controller\
    \ in AS C can obtain network traffic\n   information at the BGP community granularity,\
    \ it can steer some\n   traffic related to some BGP communities (when we consider\
    \ only the\n   source or destination of the traffic) or some BGP community pairs\n\
    \   (when we consider both the source and the destination of the traffic)\n  \
    \ from Path-1 to Path-2 according to the utilization of different\n   paths. \
    \ For instance, it can steer the traffic generated by community\n   A:X from Path-1\
    \ to Path-2 by deploying a route policy at Router C1 or\n   steer the traffic\
    \ from community A:Y to community B:M from Path-1 to\n   Path-2.  Using the IEs\
    \ defined in this document, IPFIX can export the\n   BGP community information\
    \ related to a specific traffic flow together\n   with other flow information.\
    \  The traffic information can then be\n   accumulated at the BGP community granularity\
    \ and used by the PCE/SDN\n   controller to steer the appropriate traffic from\
    \ Path-1 to Path-2.\n"
- title: 4.  IEs for BGP Standard Community
  contents:
  - "4.  IEs for BGP Standard Community\n   [RFC1997] defines the BGP community attribute\
    \ (referred to as \"BGP\n   Standard Community\" in this document), which describes\
    \ a group of\n   routes sharing some common properties.  BGP Standard Community\
    \ is\n   treated as a 32-bit value, as stated in [RFC1997].\n   In order to export\
    \ BGP Standard Community information along with\n   other flow information defined\
    \ by IPFIX, this document introduces\n   three new IEs:\n   o  bgpCommunity -\
    \ used to identify that the value in this IE is a BGP\n      Standard Community.\n\
    \   o  bgpSourceCommunityList - a basicList [RFC6313] of bgpCommunity\n      used\
    \ to export BGP Standard Community information corresponding to\n      a specific\
    \ flow's source IP address.\n   o  bgpDestinationCommunityList - a basicList [RFC6313]\
    \ of\n      bgpCommunity used to export BGP Standard Community information\n \
    \     corresponding to a specific flow's destination IP address.\n   See Section\
    \ 9 (\"IANA Considerations\") for detailed information about\n   these three new\
    \ IEs.\n"
- title: 5.  IEs for BGP Extended Community
  contents:
  - "5.  IEs for BGP Extended Community\n   [RFC4360] defines the BGP Extended Communities\
    \ attribute, which\n   provides a mechanism for labeling the information carried\
    \ in BGP.\n   Each Extended Community is encoded as an 8-octet quantity with the\n\
    \   format defined in [RFC4360].\n   In order to export BGP Extended Community\
    \ information together with\n   other flow information by IPFIX, this document\
    \ introduces three new\n   IEs:\n   o  bgpExtendedCommunity - used to identify\
    \ that the value in this IE\n      is a BGP Extended Community.\n   o  bgpSourceExtendedCommunityList\
    \ - a basicList [RFC6313] of\n      bgpExtendedCommunity used to export the BGP\
    \ Extended Community\n      information corresponding to a specific flow's source\
    \ IP address.\n   o  bgpDestinationExtendedCommunityList - a basicList [RFC6313]\
    \ of\n      bgpExtendedCommunity used to export the BGP Extended Community\n \
    \     information corresponding to a specific flow's destination IP\n      address.\n\
    \   See Section 9 (\"IANA Considerations\") for detailed information about\n \
    \  these three new IEs.\n"
- title: 6.  IEs for BGP Large Community
  contents:
  - "6.  IEs for BGP Large Community\n   [RFC8092] defines the BGP Large Communities\
    \ attribute, which is\n   suitable for use with all Autonomous System Numbers\
    \ (ASNs), including\n   4-octet ASNs.  Each BGP Large Community is encoded as\
    \ a 12-octet\n   quantity with the format defined in [RFC8092].\n   In order to\
    \ export BGP Large Community information together with\n   other flow information\
    \ by IPFIX, this document introduces three new\n   IEs:\n   o  bgpLargeCommunity\
    \ - used to identify that the value in this IE is\n      a BGP Large Community.\n\
    \   o  bgpSourceLargeCommunityList - a basicList [RFC6313] of\n      bgpLargeCommunity\
    \ used to export the BGP Large Community\n      information corresponding to a\
    \ specific flow's source IP address.\n   o  bgpDestinationLargeCommunityList -\
    \ a basicList [RFC6313] of\n      bgpLargeCommunity used to export the BGP Large\
    \ Community\n      information corresponding to a specific flow's destination\
    \ IP\n      address.\n   See Section 9 (\"IANA Considerations\") for detailed\
    \ information about\n   these three new IEs.\n"
- title: 7.  Operational Considerations
  contents:
  - "7.  Operational Considerations\n   The maximum length of an IPFIX message is\
    \ 65535 bytes as per\n   [RFC7011], and the maximum length of a normal BGP message\
    \ is 4096\n   bytes as per [RFC4271].  Since BGP communities, including Standard,\n\
    \   Extended, and Large Communities, are BGP path attributes carried in\n   BGP\
    \ Update messages, the total length of these attributes cannot\n   exceed the\
    \ length of a BGP message, i.e., 4096 bytes.  Therefore, one\n   IPFIX message\
    \ with a maximum length of 65535 bytes has enough space\n   to fit all the communities\
    \ relating to a specific flow's source and\n   destination IP address.\n   [EXT-MSG]\
    \ extends the maximum size of a BGP Update message to 65535\n   bytes.  In that\
    \ case, the BGP community information related to a\n   specific flow could theoretically\
    \ exceed the length of one IPFIX\n   message.  However, according to information\
    \ regarding actual networks\n   in the field, the number of BGP communities in\
    \ one BGP route is\n   usually no more than ten.  Nevertheless, BGP speakers that\
    \ support\n   the extended message SHOULD only convey as many communities as\n\
    \   possible without exceeding the 65535-byte limit of an IPFIX message.\n   The\
    \ Collector, which receives an IPFIX message with the maximum\n   length and BGP\
    \ communities contained in its data set, SHOULD generate\n   a warning or log\
    \ message to indicate that the BGP communities may be\n   truncated due to limited\
    \ message space.  In this case, it is\n   recommended that the export policy of\
    \ BGP communities be configured\n   to limit the BGP communities by including\
    \ or excluding specific\n   communities.\n   If needed, the IPFIX message length\
    \ can be extended from 16 bits to\n   32 bits to solve this problem completely.\
    \  The details about\n   increasing the IPFIX message length is out of scope of\
    \ this document.\n   To align with the sizes of the BGP Extended Community and\
    \ Large\n   Community attributes, the sizes of bgpExtendedCommunity and\n   bgpLargeCommunity\
    \ are 8 octets and 12 octets, respectively.  In the\n   event that the bgpExtendedCommunity\
    \ or bgpLargeCommunity IE is not\n   the expected size, the IPFIX Collector SHOULD\
    \ ignore it.  This is\n   intended to protect implementations using BGP logic\
    \ from calling\n   their parsing routines with invalid lengths.\n   To properly\
    \ process the Exporter when it receives the template\n   requesting to report\
    \ the BGP community information (refer to\n   Appendix A for an example), the\
    \ Exporter SHOULD obtain the\n   corresponding BGP community information through\
    \ a BGP lookup using\n   the corresponding source or destination IP address of\
    \ the specific\n   traffic flow.  When exporting the IPFIX information to the\
    \ Collector,\n   the Exporter SHOULD include the corresponding BGP communities\
    \ in the\n   IPFIX message.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   This document defines new IEs for IPFIX.  The\
    \ same security\n   considerations as for the IPFIX protocol specification [RFC7011]\
    \ and\n   information model [RFC7012] apply.\n   Systems processing BGP community\
    \ information collected by IPFIX\n   Collectors need to be aware of the use of\
    \ communities as an attack\n   vector [WEAPONIZING-BGP] and only include BGP community\
    \ information\n   in decisions where they are confident of its validity.  Thus,\
    \ we\n   cannot assume that all BGP community information collected by IPFIX\n\
    \   Collectors is credible and accurate.  It is RECOMMENDED to use only\n   the\
    \ IPFIX-collected BGP community information that the processing\n   system can\
    \ trust, for example, the BGP communities generated by the\n   consecutive neighboring\
    \ ASes within the same trust domain as the\n   processing system (i.e., the consecutive\
    \ neighboring ASes and the\n   processing system are operated by one carrier).\n\
    \   [RFC7011] notes that the storage of the information collected by\n   IPFIX\
    \ must be protected and its visibility confined to authorized\n   users via technical\
    \ as well as policy means to ensure the privacy of\n   the information collected.\
    \  [RFC7011] also provides mechanisms to\n   ensure the confidentiality and integrity\
    \ of IPFIX data transferred\n   from an Exporting Process to a Collecting Process.\
    \  The mechanism to\n   authenticate IPFIX Collecting and Exporting Processes\
    \ is also\n   provided in [RFC7011].  If sensitive information is contained in\
    \ the\n   community information, the above recommendations and mechanisms are\n\
    \   recommended.  No additional privacy risks are introduced by this\n   document.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   This document specifies IPFIX IEs to enable export\
    \ of BGP community\n   information along with other flow information.  IANA has\
    \ assigned the\n   following ElementIDs for these IEs in the \"IPFIX Information\n\
    \   Elements\" registry [IANA-IPFIX]:\n  ----------------------------------------------------------------------\n\
    \  |ElementID|            Name           |Abstract    |    Data Type    |\n  |\
    \         |                           |Data Type   |    Semantics    |\n  |--------------------------------------------------------------------|\n\
    \  |   483   |        bgpCommunity       |unsigned32  |     identifier  |\n  |--------------------------------------------------------------------|\n\
    \  |   484   |  bgpSourceCommunityList   | basicList  |        list     |\n  |--------------------------------------------------------------------|\n\
    \  |   485   |bgpDestinationCommunityList| basicList  |        list     |\n  |--------------------------------------------------------------------|\n\
    \  |   486   |     bgpExtendedCommunity  |octetArray  |       default   |\n  |--------------------------------------------------------------------|\n\
    \  |   487   |      bgpSourceExtended    |            |                 |\n  |\
    \         |        CommunityList      | basicList  |        list     |\n  |--------------------------------------------------------------------|\n\
    \  |   488   |  bgpDestinationExtended   |            |                 |\n  |\
    \         |       CommunityList       | basicList  |        list     |\n  |--------------------------------------------------------------------|\n\
    \  |   489   |     bgpLargeCommunity     |octetArray  |       default   |\n  |--------------------------------------------------------------------|\n\
    \  |   490   |bgpSourceLargeCommunityList| basicList  |        list     |\n  |--------------------------------------------------------------------|\n\
    \  |   491   |    bgpDestinationLarge    |            |                 |\n  |\
    \         |       CommunityList       | basicList  |        list     |\n  |--------------------------------------------------------------------|\n\
    \  ----------------------------------------------------------\n  |ElementID| \
    \                Description                  |\n  |---------------------------------------------------------\n\
    \  |   483   |    BGP community as defined in [RFC1997]     |\n  |---------------------------------------------------------\n\
    \  |         |  basicList of zero or more bgpCommunity IEs, |\n  |   484   | \
    \ containing the BGP communities corresponding|\n  |         |  with source IP\
    \ address of a specific flow   |\n  |---------------------------------------------------------\n\
    \  |         |  basicList of zero or more bgpCommunity IEs, |\n  |   485   |containing\
    \ the BGP communities corresponding  |\n  |         |with destination IP address\
    \ of a specific flow|\n  |---------------------------------------------------------\n\
    \  |   486   |BGP Extended Community as defined in RFC 4360;|\n  |         |the\
    \ size of this IE MUST be 8 octets          |\n  |---------------------------------------------------------\n\
    \  |         |basicList of zero or more bgpExtendedCommunity|\n  |   487   |IEs,\
    \ containing the BGP Extended Communities  |\n  |         |corresponding with\
    \ source IP address of       |\n  |         |               a specific flow  \
    \              |\n  |---------------------------------------------------------\n\
    \  |         |basicList of zero or more bgpExtendedCommunity|\n  |   488   |IEs,\
    \ containing the BGP Extended Communities  |\n  |         |  corresponding with\
    \ destination IP address   |\n  |         |              of a specific flow  \
    \            |\n  |---------------------------------------------------------\n\
    \  |   489   | BGP Large Community as defined in [RFC8092]; |\n  |         | the\
    \ size of this IE MUST be 12 octets        |\n  |---------------------------------------------------------\n\
    \  |         |  basicList of zero or more bgpLargeCommunity |\n  |         | \
    \ IEs, containing the BGP Large Communities   |\n  |   490   |    corresponding\
    \ with source IP address      |\n  |         |             of a specific flow\
    \               |\n  |---------------------------------------------------------\n\
    \  |         |  basicList of zero or more bgpLargeCommunity |\n  |         | \
    \ IEs, containing the BGP Large Communities   |\n  |   491   |   corresponding\
    \ with destination IP address  |\n  |         |              of a specific flow\
    \              |\n  |---------------------------------------------------------\n\
    \  ----------------------------------------------------------\n  |ElementID| \
    \   References        | Requester  | Revision |\n  |---------------------------------------------------------\n\
    \  |   483   |    RFC 1997          | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   484   |  RFC 6313, RFC 1997  | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   485   |  RFC 6313, RFC 1997  | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   486   |     RFC 4360         | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   487   |  RFC 6313, RFC 4360  | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   488   |  RFC 6313, RFC 4360  | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   489   |      RFC 8092        | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   490   |  RFC 6313, RFC 8092  | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \  |   491   |  RFC 6313, RFC 8092  | RFC 8549   |    0     |\n  |---------------------------------------------------------\n\
    \        Figure 2: Updates to \"IPFIX Information Elements\" Registry\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n  \
    \            DOI 10.17487/RFC2119, March 1997,\n              <https://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC6313]  Claise, B., Dhandapani, G., Aitken, P., and S. Yates,\n       \
    \       \"Export of Structured Data in IP Flow Information Export\n          \
    \    (IPFIX)\", RFC 6313, DOI 10.17487/RFC6313, July 2011,\n              <https://www.rfc-editor.org/info/rfc6313>.\n\
    \   [RFC7011]  Claise, B., Ed., Trammell, B., Ed., and P. Aitken,\n          \
    \    \"Specification of the IP Flow Information Export (IPFIX)\n             \
    \ Protocol for the Exchange of Flow Information\", STD 77,\n              RFC\
    \ 7011, DOI 10.17487/RFC7011, September 2013,\n              <https://www.rfc-editor.org/info/rfc7011>.\n\
    \   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC\n     \
    \         2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,\n        \
    \      May 2017, <https://www.rfc-editor.org/info/rfc8174>.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [COMMUNITY-TE]\n              Shao, W., Devienne,\
    \ F., Iannone, L., and J. Rougier, \"On\n              the use of BGP communities\
    \ for fine-grained inbound\n              traffic engineering\", Computer Science:\
    \ Networking and\n              Internet Architecture, November 2015,\n      \
    \        <https://arxiv.org/abs/1511.08336>.\n   [EXT-MSG]  Bush, R., Patel, K.,\
    \ and D. Ward, \"Extended Message\n              support for BGP\", Work in Progress,\
    \ draft-ietf-idr-bgp-\n              extended-messages-30, March 2019.\n   [IANA-IPFIX]\n\
    \              IANA, \"IP Flow Information Export (IPFIX) Entities\",\n      \
    \        <http://www.iana.org/assignments/ipfix/>.\n   [RFC1997]  Chandra, R.,\
    \ Traina, P., and T. Li, \"BGP Communities\n              Attribute\", RFC 1997,\
    \ DOI 10.17487/RFC1997, August 1996,\n              <https://www.rfc-editor.org/info/rfc1997>.\n\
    \   [RFC4271]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., \"A\n       \
    \       Border Gateway Protocol 4 (BGP-4)\", RFC 4271,\n              DOI 10.17487/RFC4271,\
    \ January 2006,\n              <https://www.rfc-editor.org/info/rfc4271>.\n  \
    \ [RFC4360]  Sangli, S., Tappan, D., and Y. Rekhter, \"BGP Extended\n        \
    \      Communities Attribute\", RFC 4360, DOI 10.17487/RFC4360,\n            \
    \  February 2006, <https://www.rfc-editor.org/info/rfc4360>.\n   [RFC4384]  Meyer,\
    \ D., \"BGP Communities for Data Collection\", BCP 114,\n              RFC 4384,\
    \ DOI 10.17487/RFC4384, February 2006,\n              <https://www.rfc-editor.org/info/rfc4384>.\n\
    \   [RFC4655]  Farrel, A., Vasseur, J., and J. Ash, \"A Path Computation\n   \
    \           Element (PCE)-Based Architecture\", RFC 4655,\n              DOI 10.17487/RFC4655,\
    \ August 2006,\n              <https://www.rfc-editor.org/info/rfc4655>.\n   [RFC5982]\
    \  Kobayashi, A., Ed. and B. Claise, Ed., \"IP Flow\n              Information\
    \ Export (IPFIX) Mediation: Problem Statement\",\n              RFC 5982, DOI\
    \ 10.17487/RFC5982, August 2010,\n              <https://www.rfc-editor.org/info/rfc5982>.\n\
    \   [RFC6183]  Kobayashi, A., Claise, B., Muenz, G., and K. Ishibashi,\n     \
    \         \"IP Flow Information Export (IPFIX) Mediation: Framework\",\n     \
    \         RFC 6183, DOI 10.17487/RFC6183, April 2011,\n              <https://www.rfc-editor.org/info/rfc6183>.\n\
    \   [RFC7012]  Claise, B., Ed. and B. Trammell, Ed., \"Information Model\n   \
    \           for IP Flow Information Export (IPFIX)\", RFC 7012,\n            \
    \  DOI 10.17487/RFC7012, September 2013,\n              <https://www.rfc-editor.org/info/rfc7012>.\n\
    \   [RFC7854]  Scudder, J., Ed., Fernando, R., and S. Stuart, \"BGP\n        \
    \      Monitoring Protocol (BMP)\", RFC 7854,\n              DOI 10.17487/RFC7854,\
    \ June 2016,\n              <https://www.rfc-editor.org/info/rfc7854>.\n   [RFC8092]\
    \  Heitz, J., Ed., Snijders, J., Ed., Patel, K., Bagdonas,\n              I.,\
    \ and N. Hilliard, \"BGP Large Communities Attribute\",\n              RFC 8092,\
    \ DOI 10.17487/RFC8092, February 2017,\n              <https://www.rfc-editor.org/info/rfc8092>.\n\
    \   [RFC8195]  Snijders, J., Heasley, J., and M. Schmidt, \"Use of BGP\n     \
    \         Large Communities\", RFC 8195, DOI 10.17487/RFC8195, June\n        \
    \      2017, <https://www.rfc-editor.org/info/rfc8195>.\n   [WEAPONIZING-BGP]\n\
    \              Streibelt, F., Lichtblau, F., Beverly, R., Pelsser, C.,\n     \
    \         Smaragdakis, G., Bush, R., and A. Feldmann, \"Weaponizing\n        \
    \      BGP Using Communities\", November 2018,\n              <https://datatracker.ietf.org/meeting/103/materials/\n\
    \              slides-103-grow-bgp-communities-spread-their-wings-01>.\n"
- title: Appendix A.  Encoding Example
  contents:
  - "Appendix A.  Encoding Example\n   In this section, we provide an example to show\
    \ the encoding format\n   for the newly introduced IEs.\n   Flow information,\
    \ including BGP communities, is shown in the\n   following table.  In this example,\
    \ all the fields are reported by\n   IPFIX.\n  ----------------------------------------------------------------------\n\
    \  |  Source |Destination|    BGP community       |    BGP community    |\n  |\
    \   IP    |    IP     |  corresponding with    | corresponding with  |\n  |  \
    \       |           |      Source IP         |   Destination IP    |\n  ----------------------------------------------------------------------\n\
    \  | 1.1.1.1 |  2.2.2.2  | 1:1001, 1:1002, 8:1001 |   2:1002, 8:1001    |\n  ----------------------------------------------------------------------\n\
    \  | 3.3.3.3 |  4.4.4.4  | 3:1001, 3:1002, 8:1001 |   4:1001, 8:1001    |\n  ----------------------------------------------------------------------\n\
    \           Figure 3: Flow Information Including BGP Communities\n"
- title: A.1.  Template Record
  contents:
  - "A.1.  Template Record\n    0                   1                   2        \
    \           3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          SET ID = 2           |       Length = 24             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Template ID = 256        |        Field Count = 4        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |0|    SourceIPv4Address = 8    |        Field Length = 4       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |0| DestinationIPv4Address = 12 |        Field Length = 4       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |0| bgpSourceCommunityList=484  |      Field Length = 0xFFFF    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |0| bgpDestinationCommunityList |      Field Length = 0xFFFF    |\n   | |\
    \          = 485              |                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 4: Template Record Encoding Format\n   In this example,\
    \ the Template ID is 256, which will be used in the\n   Data Record.  The field\
    \ length for bgpSourceCommunityList and\n   bgpDestinationCommunityList is 0xFFFF,\
    \ which means the length of this\n   IE is variable, and the actual length of\
    \ this IE is indicated by the\n   List Length field in the basicList format as\
    \ per [RFC6313].\n"
- title: A.2.  Data Set
  contents:
  - "A.2.  Data Set\n   The data set is represented as follows:\n    0           \
    \        1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         SET ID = 256          |           Length = 92         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                  SourceIPv4Address = 1.1.1.1                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |               DestinationIPv4Address = 2.2.2.2                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      255      |        List Length = 17       |semantic=allof |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      bgpCommunity = 483       |         Field Length = 4      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |        BGP Source Community Value 1 = 1:1001                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |        BGP Source Community Value 2 = 1:1002                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |        BGP Source Community Value 3 = 8:1001                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     255       |        List Length = 13       |semantic=allof |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      bgpCommunity = 483       |         Field Length = 4      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         BGP Destination Community Value 1 = 2:1002            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         BGP Destination Community Value 2 = 8:1001            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                  SourceIPv4Address = 3.3.3.3                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |               DestinationIPv4Address = 4.4.4.4                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     255       |        List Length = 17       | semantic=allof|\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      bgpCommunity = 483       |         Field Length = 4      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |        BGP Source Community Value 1 = 3:1001                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |        BGP Source Community Value 2 = 3:1002                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |        BGP Source Community Value 3 = 8:1001                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     255       |        List Length = 13       | semantic=allof|\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      bgpCommunity = 483       |         Field Length = 4      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         BGP Destination Community Value 1 = 4:1001            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         BGP Destination Community Value 2 = 8:1001            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                    Figure 5: Data Set Encoding Format\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   The authors would like to thank Benoit Claise and Paul Aitken\
    \ for\n   their comments and suggestions to promote this document.  The authors\n\
    \   would also like thank Tianran Zhou, Warren Kumari, Jeffrey Haas,\n   Ignas\
    \ Bagdonas, Stewart Bryant, Paolo Lucente, Job Snijders, Jared\n   Mauch, Rudiger\
    \ Volk, and Andrew Malis for their discussion, comments,\n   and suggestions for\
    \ improving this document.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Zhenqiang Li\n   China Mobile\n   32 Xuanwumen West Ave,\
    \ Xicheng District\n   Beijing  100053\n   China\n   Email: li_zhenqiang@hotmail.com\n\
    \   Rong Gu\n   China Mobile\n   32 Xuanwumen West Ave, Xicheng District\n   Beijing\
    \  100053\n   China\n   Email: gurong_cmcc@outlook.com\n   Jie Dong\n   Huawei\
    \ Technologies\n   Huawei Campus, No. 156 Beiqing Rd.\n   Beijing  100095\n  \
    \ China\n   Email: jie.dong@huawei.com\n"
