- title: __initial_text__
  contents:
  - '                  Fast Handovers for Proxy Mobile IPv6

    '
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv6 (MIPv6; RFC 3775) provides a mobile node with IP mobility\n\
    \   when it performs a handover from one access router to another, and\n   fast\
    \ handovers for Mobile IPv6 (FMIPv6) are specified to enhance the\n   handover\
    \ performance in terms of latency and packet loss.  While\n   MIPv6 (and FMIPv6\
    \ as well) requires the participation of the mobile\n   node in the mobility-related\
    \ signaling, Proxy Mobile IPv6 (PMIPv6;\n   RFC 5213) provides IP mobility to\
    \ nodes that either have or do not\n   have MIPv6 functionality without such involvement.\
    \  Nevertheless, the\n   basic performance of PMIPv6 in terms of handover latency\
    \ and packet\n   loss is considered no different from that of MIPv6.\n   When\
    \ the fast handover is considered in such an environment, several\n   modifications\
    \ are needed to FMIPv6 to adapt to the network-based\n   mobility management.\
    \  This document specifies the usage of fast\n   handovers for Mobile IPv6 (FMIPv6;\
    \ RFC 5568) when Proxy Mobile IPv6\n   is used as the mobility management protocol.\
    \  Necessary extensions\n   are specified for FMIPv6 to support the scenario when\
    \ the mobile node\n   does not have IP mobility functionality and hence is not\
    \ involved\n   with either MIPv6 or FMIPv6 operations.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc5949.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.  This document is subject\
    \ to\n   BCP 78 and the IETF Trust's Legal Provisions Relating to IETF\n   Documents\
    \ (http://trustee.ietf.org/license-info) in effect on the\n   date of publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Requirements Notation ...........................................4\n  \
    \ 3. Terminology .....................................................4\n   4.\
    \ Proxy-Based FMIPv6 Protocol Overview ............................5\n      4.1.\
    \ Protocol Operation .........................................7\n      4.2. Inter-AR\
    \ Tunneling Operation ..............................14\n      4.3. IPv4 Support\
    \ Considerations ...............................16\n   5. PMIPv6-Related Fast\
    \ Handover Issues ............................16\n      5.1. Manageability Considerations\
    \ ..............................16\n      5.2. Expedited Packet Transmission .............................17\n\
    \   6. Message Formats ................................................18\n  \
    \    6.1. Mobility Header ...........................................18\n    \
    \       6.1.1. Handover Initiate (HI) .............................18\n      \
    \     6.1.2. Handover Acknowledge (HAck) ........................20\n      6.2.\
    \ Mobility Options ..........................................22\n           6.2.1.\
    \ Context Request Option .............................22\n           6.2.2. Local\
    \ Mobility Anchor Address (LMAA) Option ........23\n           6.2.3. Mobile Node\
    \ Link-Local Address Interface\n                  Identifier (MN LLA-IID) Option\
    \ .....................24\n           6.2.4. Home Network Prefix Option .........................25\n\
    \           6.2.5. Link-Local Address Option ..........................25\n  \
    \         6.2.6. GRE Key Option .....................................25\n    \
    \       6.2.7. IPv4 Address Option ................................25\n      \
    \     6.2.8. Vendor-Specific Mobility Option ....................25\n   7. Security\
    \ Considerations ........................................26\n   8. IANA Considerations\
    \ ............................................26\n   9. Acknowledgments ................................................28\n\
    \   10. References ....................................................28\n  \
    \    10.1. Normative References .....................................28\n    \
    \  10.2. Informative References ...................................29\n   Appendix\
    \ A. Applicable Use Cases ..................................30\n      A.1. PMIPv6\
    \ Handoff Indication .................................30\n      A.2. Local Routing\
    \ .............................................31\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Proxy Mobile IPv6 (PMIPv6) [RFC5213] provides IP mobility\
    \ to a mobile\n   node that does not support Mobile IPv6 (MIPv6) [RFC3775] mobile\
    \ node\n   functionality.  A proxy agent in the network performs the mobility\n\
    \   management signaling on behalf of the mobile node.  This model\n   transparently\
    \ provides mobility for nodes within a PMIPv6 domain.\n   Nevertheless, the basic\
    \ performance of PMIPv6 in terms of handover\n   latency and packet loss is considered\
    \ no different from that of\n   Mobile IPv6.\n   Fast handovers for Mobile IPv6\
    \ (FMIPv6) [RFC5568] describes the\n   protocol to reduce the handover latency\
    \ for Mobile IPv6 by allowing a\n   mobile node to send packets as soon as it\
    \ detects a new subnet link\n   and by delivering packets to the mobile node as\
    \ soon as its\n   attachment is detected by the new access router.  This document\n\
    \   extends FMIPv6 for Proxy MIPv6 operation to minimize handover delay\n   and\
    \ packet loss as well as to transfer network-resident context for a\n   PMIPv6\
    \ handover.  [RFC5568] is normative for this document, except\n   where this document\
    \ specifies new or revised functions and messages.\n"
- title: 2.  Requirements Notation
  contents:
  - "2.  Requirements Notation\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 3.  Terminology
  contents:
  - "3.  Terminology\n   This document reuses terminology from [RFC5213], [RFC5568],\
    \ and\n   [RFC3775].  The following terms and abbreviations are additionally\n\
    \   used in this document.\n   Access Network (AN):\n      A network composed\
    \ of link-layer access devices such as access\n      points or base stations providing\
    \ access to a Mobile Access\n      Gateway (MAG) connected to it.\n   Previous\
    \ Access Network (P-AN):\n      The access network to which the Mobile Node (MN)\
    \ is attached\n      before handover.\n   New Access Network (N-AN):\n      The\
    \ access network to which the Mobile Node (MN) is attached after\n      handover.\n\
    \   Previous Mobile Access Gateway (PMAG):\n      The MAG that manages mobility-related\
    \ signaling for the mobile\n      node before handover.  In this document, the\
    \ MAG and the Access\n      Router are co-located.\n   New Mobile Access Gateway\
    \ (NMAG):\n      The MAG that manages mobility-related signaling for the mobile\n\
    \      node after handover.  In this document, the MAG and the Access\n      Router\
    \ (AR) are co-located.\n   Local Mobility Anchor (LMA):\n      The topological\
    \ anchor point for the mobile node's home network\n      prefix(es) and the entity\
    \ that manages the mobile node's binding\n      state.  This specification does\
    \ not alter any capability or\n      functionality defined in [RFC5213].\n   Handover\
    \ indication:\n      A generic signaling message, sent from the P-AN to the PMAG,\
    \ that\n      indicates a mobile node's handover.  While this signaling is\n \
    \     dependent on the access technology, it is assumed that Handover\n      indication\
    \ can carry the information to identify the mobile node\n      and to assist the\
    \ PMAG in resolving the NMAG (and the new access\n      point or base station)\
    \ to which the mobile node is moving.  The\n      details of this message are\
    \ outside the scope of this document.\n"
- title: 4.  Proxy-Based FMIPv6 Protocol Overview
  contents:
  - "4.  Proxy-Based FMIPv6 Protocol Overview\n   This specification describes fast\
    \ handover protocols for the network-\n   based mobility management protocol called\
    \ Proxy Mobile IPv6 (PMIPv6)\n   [RFC5213].  The core functional entities defined\
    \ in PMIPv6 are the\n   Local Mobility Anchor (LMA) and the Mobile Access Gateway\
    \ (MAG).  The\n   LMA is the topological anchor point for the mobile node's home\n\
    \   network prefix(es).  The MAG acts as an access router (AR) for the\n   mobile\
    \ node and performs the mobility management procedures on its\n   behalf.  The\
    \ MAG is responsible for detecting the mobile node's\n   movements to and from\
    \ the access link and for initiating binding\n   registrations to the mobile node's\
    \ local mobility anchor.  If the\n   MAGs can be informed of the detachment and/or\
    \ attachment of the\n   mobile node in a timely manner via, e.g., lower-layer\
    \ signaling, it\n   will become possible to optimize the handover procedure, which\n\
    \   involves establishing a connection on the new link and signaling\n   between\
    \ mobility agents, compared to the baseline specification of\n   PMIPv6.\n   In\
    \ order to further improve the performance during the handover, this\n   document\
    \ specifies a bidirectional tunnel between the Previous MAG\n   (PMAG) and the\
    \ New MAG (NMAG) to tunnel packets meant for the mobile\n   node.  In order to\
    \ enable the NMAG to send the Proxy Binding Update\n   (PBU), the Handover Initiate\
    \ (HI) and Handover Acknowledge (HAck)\n   messages in [RFC5568] are extended\
    \ for context transfer, in which\n   parameters such as the mobile node's Network\
    \ Access Identifier (NAI),\n   Home Network Prefix (HNP), and IPv4 Home Address\
    \ are transferred from\n   the PMAG.  New flags, 'P' and 'F', are defined for\
    \ the HI and HAck\n   messages to distinguish from those in [RFC5568] and to request\
    \ packet\n   forwarding, respectively.\n   In this document, the Previous Access\
    \ Router (PAR) and New Access\n   Router (NAR) are interchangeable with the PMAG\
    \ and NMAG,\n   respectively.  The reference network is illustrated in Figure\
    \ 1.  The\n   access networks in the figure (i.e., P-AN and N-AN) are composed\
    \ of\n   Access Points (APs) defined in [RFC5568], which are often referred to\n\
    \   as base stations in cellular networks.\n   Since a mobile node is not directly\
    \ involved with IP mobility\n   protocol operations, it follows that the mobile\
    \ node is not directly\n   involved with fast handover procedures either.  Hence,\
    \ the messages\n   involving the mobile node in [RFC5568] are not used when PMIPv6\
    \ is in\n   use.  More specifically, the Router Solicitation for Proxy\n   Advertisement\
    \ (RtSolPr), the Proxy Router Advertisement (PrRtAdv),\n   Fast Binding Update\
    \ (FBU), Fast Binding Acknowledgment (FBack), and\n   the Unsolicited Neighbor\
    \ Advertisement (UNA) messages are not\n   applicable in the PMIPv6 context. \
    \ A MAG that receives a RtSolPr or\n   FBU message from a mobile node SHOULD behave\
    \ as if they do not\n   implement FMIPv6 as defined in [RFC5568] at all -- continuing\
    \ to\n   operate according to this specification within the network -- or\n  \
    \ alternatively, start serving that particular mobile node as specified\n   in\
    \ [RFC5568].\n                                +----------+\n                 \
    \               |   LMA    |\n                                |          |\n \
    \                               +----------+\n                               \
    \   /      \\\n                                 /        \\\n                \
    \                /          \\\n                    +........../..+      +..\\\
    ..........+\n                    . +-------+-+ .______. +-+-------+ .\n      \
    \              . |  PMAG   |()_______)|  NMAG   | .\n                    . | \
    \ (PAR)  | .      . |  (NAR)  | .\n                    . +----+----+ .      .\
    \ +----+----+ .\n                    .      |      .      .      |      .\n  \
    \                  .   ___|___   .      .   ___|___   .\n                    .\
    \  /       \\  .      .  /       \\  .\n                    . (  P-AN   ) .  \
    \    . (  N-AN   ) .\n                    .  \\_______/  .      .  \\_______/\
    \  .\n                    .      |      .      .      |      .\n             \
    \       .   +----+    .      .   +----+    .\n                    .   | MN | \
    \ ---------->  | MN |    .\n                    .   +----+    .      .   +----+\
    \    .\n                    +.............+      +.............+\n           \
    \    Figure 1: Reference Network for Fast Handover\n"
- title: 4.1.  Protocol Operation
  contents:
  - "4.1.  Protocol Operation\n   There are two modes of operation in FMIPv6 [RFC5568].\
    \  In the\n   predictive mode of fast handover, a bidirectional tunnel between\
    \ the\n   PMAG (PAR) and NMAG (NAR) is established prior to the mobile node's\n\
    \   attachment to the NMAG.  In the reactive mode, this tunnel\n   establishment\
    \ takes place after the mobile node attaches to the NMAG.\n   In order to alleviate\
    \ the packet loss during a mobile node's handover\n   (especially when the mobile\
    \ node is detached from both links), the\n   downlink packets for the mobile node\
    \ need to be buffered either at\n   the PMAG or NMAG, depending on when the packet\
    \ forwarding is\n   performed.  It is hence REQUIRED that all MAGs have the capability\n\
    \   and enough resources to buffer packets for the mobile nodes\n   accommodated\
    \ by them.  The buffer size to be prepared and the rate at\n   which buffered\
    \ packets are drained are addressed in Section 5.4 of\n   [RFC5568].  Note that\
    \ the protocol operation specified in the\n   document is transparent to the local\
    \ mobility anchor (LMA); hence\n   there is no new functional requirement or change\
    \ on the LMA.\n   Unlike MIPv6, the mobile node in the PMIPv6 domain is not involved\n\
    \   with IP mobility signaling; therefore, in order for the predictive\n   fast\
    \ handover to work effectively, it is REQUIRED that the mobile\n   node is capable\
    \ of reporting lower-layer information to the AN at a\n   short enough interval,\
    \ and that the AN is capable of sending the\n   Handover indication to the PMAG\
    \ at an appropriate timing.  The\n   sequence of events for the predictive fast\
    \ handover is illustrated in\n   Figure 2.\n                                 \
    \           PMAG        NMAG\n          MN         P-AN       N-AN        (PAR)\
    \       (NAR)     LMA\n          |           |          |            |       \
    \    |        |\n     (a)  |--Report-->|          |            |           | \
    \       |\n          |           |          |            |           |       \
    \ |\n          |           |       Handover        |           |        |\n  \
    \   (b)  |           |------indication------>|           |        |\n        \
    \  |           |          |            |           |        |\n          |   \
    \        |          |            |           |        |\n     (c)  |         \
    \  |          |            |----HI---->|        |\n          |           |   \
    \       |            |           |        |\n          |           |         \
    \ |            |           |        |\n     (d)  |           |          |    \
    \        |<---HAck---|        |\n          |           |          |          \
    \  |           |        |\n          |           |          |            |   \
    \        |        |\n          |           |          |            |HI/HAck(optional)\
    \   |\n     (e)  |           |          |            |<- - - - ->|        |\n\
    \          |           |          |          #=|<===================|\n     (f)\
    \  |           |          |          #====DL data=>|        |\n          |  Handover\
    \ |       Handover        |           |        |\n     (g)  |<-command--|<------command---------|\
    \           |        |\n         ~~~          |          |            |      \
    \     |        |\n         ~~~          |          |            |           |\
    \        |\n          |   MN-AN connection   |    AN-MAG connection   |      \
    \  |\n     (h)  |<---establishment---->|<----establishment----->|        |\n \
    \         |           |          |  (substitute for UNA)  |        |\n       \
    \   |           |          |            |           |        |\n     (i)  |<==================DL\
    \ data=====================|        |\n          |           |          |    \
    \        |           |        |\n     (j)  |===================UL data====================>|=#\
    \      |\n          |           |          |          #=|<============#      |\n\
    \          |           |          |          #=====================>|\n     /\
    \    |           |          |            |           |        | \\\n     |(k)\
    \ |           |          |            |           |--PBU-->| |\n     |    |  \
    \         |          |            |           |        | |\n     |(l) |      \
    \     |          |            |           |<--PBA--| |\n     |    |<==================DL\
    \ data=====================|<=======| |\n     |    |           |          |  \
    \          |           |        | |\n     \\    |===================UL data====================>|=======>|\
    \ /\n          UL        Uplink\n          DL        Downlink\n          PBA \
    \      Proxy Binding Acknowledgment\n     Figure 2: Predictive Fast Handover for\
    \ PMIPv6 (Initiated by PMAG)\n   The detailed descriptions are as follows:\n \
    \  (a)  The mobile node detects that a handover is imminent and reports\n    \
    \    its identifier (MN ID) and the New Access Point Identifier (New\n       \
    \ AP ID) [RFC5568] to which the mobile node is most likely to\n        move. \
    \ The MN ID could be the NAI, link-layer address, or any\n        other suitable\
    \ identifier, but the MAG SHOULD be able to map any\n        access-specific identifier\
    \ to the NAI as the MN ID.  In some\n        cases, the previous access network\
    \ (P-AN) will determine the New\n        AP ID for the mobile node.  This step\
    \ is access technology\n        specific, and details are outside the scope of\
    \ this document.\n   (b)  The previous access network, to which the mobile node\
    \ is\n        currently attached, indicates the handover of the mobile node to\n\
    \        the previous mobile access gateway (PMAG), with the MN ID and\n     \
    \   New AP ID.  Detailed definition and specification of this\n        message\
    \ are outside the scope of this document.\n   (c)  The previous MAG derives the\
    \ new mobile access gateway (NMAG)\n        from the New AP ID, which is a similar\
    \ process to that of\n        constructing an [AP ID, AR-Info] tuple in [RFC5568].\
    \  The\n        previous MAG then sends the Handover Initiate (HI) message to\n\
    \        the new MAG.  The HI message MUST have the 'P' flag set and\n       \
    \ include the MN ID, the HNP(s), and the address of the local\n        mobility\
    \ anchor that is currently serving the mobile node.  If\n        there is a valid\
    \ (non-zero) MN Link-layer Identifier (MN LL-ID),\n        that information MUST\
    \ also be included.  With some link layers,\n        the MN Link-local Address\
    \ Interface Identifier (MN LLA-IID) can\n        also be included (see Section\
    \ 6.2.3).\n   (d)  The new MAG sends the Handover Acknowledge (HAck) message back\n\
    \        to the previous MAG with the 'P' flag set.\n   (e)  If it is preferred\
    \ that the timing of buffering or forwarding\n        should be later than step\
    \ (c), the new MAG MAY optionally\n        request that the previous MAG buffer\
    \ or forward packets at a\n        later and appropriate time, by setting the\
    \ 'U' flag [RFC5568] or\n        the 'F' flag in the HI message, respectively.\n\
    \   (f)  If the 'F' flag is set in the previous step, a bidirectional\n      \
    \  tunnel is established between the previous MAG and new MAG, and\n        packets\
    \ destined for the mobile node are forwarded from the\n        previous MAG to\
    \ the new MAG over this tunnel.  After\n        decapsulation, those packets MAY\
    \ be buffered at the new MAG.  If\n        the connection between the new access\
    \ network and new MAG has\n        already been established, those packets MAY\
    \ be forwarded towards\n        the new access network, which then becomes responsible\
    \ for them\n        (e.g., buffering or delivering, depending on the condition\
    \ of\n        the mobile node's attachment); this is access technology\n     \
    \   specific.\n   (g)  When handover is ready on the network side, the mobile\
    \ node is\n        triggered to perform handover to the new access network.  This\n\
    \        step is access technology specific, and details are outside the\n   \
    \     scope of this document.\n   (h)  The mobile node establishes a physical-layer\
    \ connection with the\n        new access network (e.g., radio channel assignment),\
    \ which in\n        turn triggers the establishment of a link-layer connection\n\
    \        between the new access network and new MAG if not yet\n        established.\
    \  An IP-layer connection setup may be performed at\n        this time (e.g.,\
    \ PPP IPv6 Control Protocol) or at a later time\n        (e.g., stateful or stateless\
    \ address autoconfiguration).  This\n        step can be a substitute for the\
    \ Unsolicited Neighbor\n        Advertisement (UNA) in [RFC5568].  If the new\
    \ MAG acquires a\n        valid new MN LL-ID via the new access network and a\
    \ valid old MN\n        LL-ID from the previous MAG at step (c), these IDs SHOULD\
    \ be\n        compared to determine whether the same interface is used before\n\
    \        and after handover.  When the connection between the mobile node\n  \
    \      and new MAG is PPP and the same interface is used for the\n        handover,\
    \ the new MAG SHOULD confirm that the same interface\n        identifier is used\
    \ for the mobile node's link-local address\n        (this is transferred from\
    \ the previous MAG using the MN LLA-IID\n        option at step (c), and sent\
    \ to the mobile node during the\n        Configure-Request/Ack exchange).\n  \
    \ (i)  The new MAG starts to forward packets destined for the mobile\n       \
    \ node via the new access network.\n   (j)  The uplink packets from the mobile\
    \ node are sent to the new MAG\n        via the new access network, and the new\
    \ MAG forwards them to the\n        previous MAG.  The previous MAG then sends\
    \ the packets to the\n        local mobility anchor that is currently serving\
    \ the mobile node.\n   (k)  The new MAG sends the Proxy Binding Update (PBU) to\
    \ the local\n        mobility anchor, whose address is provided in step (c). \
    \ Steps\n        (k) and (l) are not part of the fast handover procedure but are\n\
    \        shown for reference.\n   (l)  The local mobility anchor sends back the\
    \ Proxy Binding\n        Acknowledgment (PBA) to the new MAG.  From this time\
    \ on, the\n        packets to/from the mobile node go through the new MAG instead\n\
    \        of the previous MAG.\n   According to Section 4 of [RFC5568], the previous\
    \ MAG establishes a\n   binding between the Previous Care-of Address (PCoA) and\
    \ New Care-of\n   Address (NCoA) to forward packets for the mobile node to the\
    \ new MAG,\n   and the new MAG creates a proxy neighbor cache entry to receive\
    \ those\n   packets for the NCoA before the mobile node arrives.  In the case\
    \ of\n   PMIPv6, however, the only address that is used by the mobile node is\n\
    \   the Mobile Node's Home Address (MN-HoA), so the PMAG forwards the\n   mobile\
    \ node's packets to the NMAG instead of the NCoA.  The NMAG then\n   simply decapsulates\
    \ those packets and delivers them to the mobile\n   node.  FMIPv4 [RFC4988] specifies\
    \ forwarding when the mobile node\n   uses the home address as its on-link address\
    \ rather than the care-of\n   address.  The usage in PMIPv6 is similar to that\
    \ in FMIPv4, where the\n   address(es) used by the mobile node is/are based on\
    \ its HNP(s).\n   Since the NMAG can obtain the link-layer address (MN LL-ID)\
    \ and\n   HNP(s) via the HI message (also the interface identifier of the\n  \
    \ mobile node's link-local address (MN LLA-ID), if available), it can\n   create\
    \ a neighbor cache entry for the link-local address and the\n   routes for the\
    \ whole HNP(s), even before the mobile node performs\n   Neighbor Discovery. \
    \ For the uplink packets from the mobile node\n   after handover in step (j),\
    \ the NMAG forwards the packets to the PMAG\n   through the tunnel established\
    \ in step (f).  The PMAG then\n   decapsulates and sends them to the local mobility\
    \ anchor.\n   The timing of the context transfer and that of packet forwarding\
    \ may\n   be different.  Thus, a new flag 'F' and Option Code values for it in\n\
    \   the HI and HAck messages are defined to request forwarding.  To\n   request\
    \ buffering, the 'U' flag has already been defined in\n   [RFC5568].  If the PMAG\
    \ receives the HI message with the 'F' flag\n   set, it starts forwarding packets\
    \ for the mobile node.  The HI\n   message with the 'U' flag set MAY be sent earlier\
    \ if the timing of\n   buffering is different from that of forwarding.  If packet\
    \ forwarding\n   is completed, the PMAG MAY send the HI message with the 'F' flag\
    \ set\n   and the Option Code value set to 2.  Via this message, the ARs on\n\
    \   both ends can tear down the forwarding tunnel synchronously.\n   The IP addresses\
    \ in the headers of those user packets are summarized\n   below:\n   In step (f),\n\
    \      Inner source address: IP address of the correspondent node\n      Inner\
    \ destination address: HNP or Mobile Node's IPv4 Home Address\n      (IPv4-MN-HoA)\n\
    \      Outer source address: IP address of the PMAG\n      Outer destination address:\
    \ IP address of the NMAG\n   In step (i),\n      Source address: IP address of\
    \ the correspondent node\n      Destination address: HNP or IPv4-MN-HoA\n   In\
    \ step (j),\n      - from the mobile node to the NMAG,\n        Source address:\
    \ HNP or IPv4-MN-HoA\n        Destination address: IP address of the correspondent\
    \ node\n      - from the NMAG to the PMAG,\n        Inner source address: HNP\
    \ or IPv4-MN-HoA\n        Inner destination address: IP address of the correspondent\
    \ node\n        Outer source address: IP address of the NMAG\n        Outer destination\
    \ address: IP address of the PMAG\n      - from the PMAG to the LMA,\n       \
    \ Inner source address: HNP or IPv4-MN-HoA\n        Inner destination address:\
    \ IP address of the correspondent node\n        Outer source address: IP address\
    \ of the PMAG\n        Outer destination address: IP address of the LMA\n   In\
    \ the case of the reactive handover for PMIPv6, since the mobile\n   node does\
    \ not send either the FBU or UNA, it would be more natural\n   that the NMAG send\
    \ the HI message to the PMAG after the mobile node\n   has moved to the new link.\
    \  The NMAG then needs to obtain the\n   information of the PMAG beforehand. \
    \ Such information could be\n   provided, for example, by the mobile node sending\
    \ the AP-ID on the\n   old link and/or by the lower-layer procedures between the\
    \ P-AN and\n   N-AN.  The exact method is not specified in this document.  Figure\
    \ 3\n   illustrates the reactive fast handover procedures for PMIPv6, where\n\
    \   the bidirectional tunnel establishment is initiated by the NMAG.\n       \
    \                                  PMAG            NMAG\n          MN       P-AN\
    \      N-AN        (PAR)           (NAR)     LMA\n          |         |      \
    \   |            |               |        |\n     (a) ~~~        |         | \
    \           |               |        |\n         ~~~        |         |      \
    \      |               |        |\n          |  MN-AN connection |       AN-MAG\
    \ connection    |        |\n     (b)  |<--establishment-->|<-------establishment------>|\
    \        |\n          |         |         |(substitute for UNA and FBU)|     \
    \   |\n          |         |         |            |               |        |\n\
    \          |         |         |            |               |        |\n     (c)\
    \  |         |         |            |<-----HI-------|        |\n          |  \
    \       |         |            |               |        |\n          |       \
    \  |         |            |               |        |\n     (d)  |         |  \
    \       |            |-----HAck----->|        |\n          |         |       \
    \  |            |               |        |\n          |         |         |  \
    \          |               |        |\n     (e)  |         |         |       \
    \   #=|<=======================|\n          |         |         |          #================>|=#\
    \      |\n          |<====================DL data======================#     \
    \ |\n          |         |         |            |               |        |\n \
    \    (f)  |=====================UL data===================>|=#      |\n      \
    \    |         |         |          #=|<================#      |\n          |\
    \         |         |          #=========================>|\n          |     \
    \    |         |            |               |        |\n     /    |         |\
    \         |            |               |        | \\\n     |(g) |         |  \
    \       |            |               |--PBU-->| |\n     |    |         |     \
    \    |            |               |        | |\n     |(h) |         |        \
    \ |            |               |<--PBA--| |\n     |    |<====================DL\
    \ data====================|<=======| |\n     |    |         |         |      \
    \      |               |        | |\n     \\    |=====================UL data===================>|=======>|\
    \ /\n      Figure 3: Reactive Fast Handover for PMIPv6 (Initiated by NMAG)\n \
    \  The detailed descriptions are as follows:\n   (a)  The mobile node undergoes\
    \ handover from the previous access\n        network to the new access network.\n\
    \   (b)  The mobile node establishes a connection (e.g., radio channel)\n    \
    \    with the new access network, which triggers the establishment of\n      \
    \  the connection between the new access network and new MAG.  The\n        MN\
    \ ID is transferred to the new MAG at this step for the\n        subsequent procedures.\
    \  The AP-ID on the old link (Old AP ID),\n        which will be provided by either\
    \ the mobile node or the new\n        access network, is also transferred to the\
    \ new MAG to help\n        identify the previous MAG on the new link.  This can\
    \ be regarded\n        as a substitute for the UNA and FBU.\n   (c)  The new MAG\
    \ sends the HI message to the previous MAG.  The HI\n        message MUST have\
    \ the 'P' flag set and include the MN ID.  The\n        Context Request option\
    \ MAY be included to request additional\n        context information on the mobile\
    \ node to the previous MAG.\n   (d)  The previous MAG sends the HAck message back\
    \ to the new MAG with\n        the 'P' flag set.  The HAck message MUST include\
    \ the HNP(s)\n        and/or IPv4-MN-HoA that corresponds to the MN ID in the\
    \ HI\n        message and SHOULD include the MN LL-ID, only if it is valid\n \
    \       (non-zero), and the local mobility anchor address that is\n        currently\
    \ serving the mobile node.  The context information\n        requested by the\
    \ new MAG MUST be included.  If the requested\n        context is not available\
    \ for some reason, the previous MAG MUST\n        return the HAck message with\
    \ the Code value 131.  If the 'F'\n        flag is set in the HI message at step\
    \ (c) and forwarding is\n        nevertheless not executable for some reason,\
    \ the previous MAG\n        MUST return the HAck message with the Code value 132.\n\
    \   (e)  If the 'F' flag in the HI message is set at step (c), a\n        bidirectional\
    \ tunnel is established between the previous MAG and\n        new MAG, and packets\
    \ destined for the mobile node are forwarded\n        from the previous MAG to\
    \ the new MAG over this tunnel.  After\n        decapsulation, those packets are\
    \ delivered to the mobile node\n        via the new access network.\n   (f)  The\
    \ uplink packets from the mobile node are sent to the new MAG\n        via the\
    \ new access network, and the new MAG forwards them to the\n        previous MAG.\
    \  The previous MAG then sends the packets to the\n        local mobility anchor\
    \ that is currently serving the mobile node.\n   Steps (g)-(h) are the same as\
    \ steps (k)-(l) in the predictive fast\n   handover procedures.\n   In step (c),\
    \ the IP address of the PMAG needs to be resolved by the\n   NMAG to send the\
    \ HI message to the PMAG.  This information may come\n   from the N-AN or some\
    \ database that the NMAG can access.\n"
- title: 4.2.  Inter-AR Tunneling Operation
  contents:
  - "4.2.  Inter-AR Tunneling Operation\n   When the PMAG (PAR) or NMAG (NAR), depending\
    \ on the fast handover\n   mode, receives the HI message with the 'F' flag set,\
    \ it prepares to\n   send/receive the mobile node's packets to/from the other\
    \ MAG and\n   returns the HAck message with the same sequence number.  Both MAGs\n\
    \   SHOULD support the following encapsulation modes for the user\n   packets,\
    \ which are also defined for the tunnel between the local\n   mobility anchor\
    \ and MAG:\n   o  IPv4-or-IPv6-over-IPv6 [RFC5844]\n   o  IPv4-or-IPv6-over-IPv4\
    \ [RFC5844]\n   o  IPv4-or-IPv6-over-IPv4-UDP [RFC5844]\n   o  TLV-header UDP\
    \ tunneling [RFC5845]\n   o  Generic Routing Encapsulation (GRE) tunneling with\
    \ or without GRE\n      key(s) [RFC5845]\n   The PMAG and the NMAG MUST use the\
    \ same tunneling mechanism for the\n   data traffic tunneled between them.  The\
    \ encapsulation mode to be\n   employed SHOULD be configurable.  It is RECOMMENDED\
    \ that:\n   1.  As the default behavior, the inter-MAG tunnel uses the same\n\
    \       encapsulation mechanism as that for the PMIPv6 tunnel between the\n  \
    \     local mobility anchor and the MAGs.  The PMAG and NMAG\n       automatically\
    \ start using the same encapsulation mechanism\n       without a need for a special\
    \ configuration on the MAGs or a\n       dynamic tunneling mechanism negotiation\
    \ between them.\n   2.  Configuration on the MAGs can override the default mechanism\n\
    \       specified in scenario #1 above.  The PMAG and NMAG MUST be\n       configured\
    \ with the same mechanism, and this configuration is\n       most likely to be\
    \ uniform throughout the PMIPv6 domain.  If the\n       packets on the PMIPv6\
    \ tunnel cannot be uniquely mapped on to the\n       configured inter-MAG tunnel,\
    \ this scenario is not applicable, and\n       scenario #3 below SHOULD directly\
    \ be applied.\n   3.  An implicit or explicit tunnel negotiation mechanism between\
    \ the\n       MAGs can override the default mechanism specified in scenario #1\n\
    \       above.  The employed tunnel negotiation mechanism is outside the\n   \
    \    scope of this document.\n   The necessary information MUST be transferred\
    \ in the HI/HAck messages\n   to determine whether a mobile node's packets should\
    \ be forwarded\n   immediately or at a later time.  Such information includes\
    \ the HNP(s)\n   (or IPv4-MN-HoA) and/or GRE key(s).  In the case of GRE tunneling\n\
    \   with GRE keys being used, for each mobility session, the NMAG selects\n  \
    \ the GRE key for the downlink packets, and the PMAG selects the GRE\n   key for\
    \ the uplink packets.  These GRE keys are exchanged between the\n   PMAG and the\
    \ NMAG using the GRE Key option as described in [RFC5845];\n   e.g., in the case\
    \ of the reactive mode as shown in Figure 3, the DL\n   GRE key is communicated\
    \ in the HI message while the UL GRE key is\n   sent in the HAck message.  In\
    \ the case of downlink packets, the PMAG\n   redirects the mobile node's packets\
    \ from the local mobility anchor\n   towards the NMAG, and if the mobile node\
    \ is ready to receive those\n   packets or the N-AN can handle them regardless\
    \ of the state of the\n   mobile node, the NMAG SHOULD immediately send them towards\
    \ the N-AN;\n   otherwise, it SHOULD buffer them until the mobile node is ready.\
    \  In\n   the case of uplink packets, the NMAG SHOULD reverse-tunnel them from\n\
    \   the mobile node towards the PMAG, and the PMAG will then send them to\n  \
    \ the local mobility anchor.\n   When the PMAG or NMAG receives the HI message\
    \ with the 'U' flag set,\n   it prepares to buffer the mobile node's packets and\
    \ returns the HAck\n   message with the same sequence number.  It MUST be followed\
    \ by\n   another HI message with the 'F' flag set at an appropriate time to\n\
    \   forward the buffered packets.\n   If the MAG that received the HI message\
    \ encounters an erroneous\n   situation (e.g., insufficient buffer space), it\
    \ SHOULD immediately\n   send the HAck message with the cause of the error and\
    \ cancel all\n   tunneling operations.\n"
- title: 4.3.  IPv4 Support Considerations
  contents:
  - "4.3.  IPv4 Support Considerations\n   The motivation and usage scenarios of IPv4\
    \ protocol support by PMIPv6\n   are described in [RFC5844].  The scope of IPv4\
    \ support covers the\n   following two features:\n   o  IPv4 Home Address Mobility\
    \ Support, and\n   o  IPv4 Transport Support.\n   As for IPv4 Home Address Mobility\
    \ Support, the mobile node acquires\n   the IPv4 Home Address (IPv4-MN-HoA), and\
    \ in the case of handover, the\n   PMAG needs to transfer IPv4-MN-HoA to the NMAG,\
    \ which is the inner\n   destination address of the packets forwarded on the downlink.\
    \  For\n   this purpose, the IPv4 Address option described in Section 6.2.7 is\n\
    \   used.  In order to provide IPv4 Transport Support, the NMAG needs to\n   know\
    \ the IPv4 address of the local mobility anchor (IPv4-LMAA) to\n   send PMIPv6\
    \ signaling messages to the local mobility anchor in the\n   IPv4 transport network.\
    \  For this purpose, a new option called the\n   LMA Address (LMAA) option is\
    \ defined in Section 6.2.2 so as to convey\n   IPv4-LMAA from the PMAG to the\
    \ NMAG.\n"
- title: 5.  PMIPv6-Related Fast Handover Issues
  contents:
  - '5.  PMIPv6-Related Fast Handover Issues

    '
- title: 5.1.  Manageability Considerations
  contents:
  - "5.1.  Manageability Considerations\n   This specification does not require any\
    \ additional IP-level\n   functionality on the local mobility anchor and the mobile\
    \ node\n   running in the PMIPv6 domain.  A typical network interface that the\n\
    \   mobile node could be assumed to have is one with the cellular\n   network,\
    \ where the network controls the movement of the mobile node.\n   Different types\
    \ of interfaces could be involved, such as different\n   generations (3G and 3.9G)\
    \ or different radio access systems.  This\n   specification supports a mobile\
    \ node with the single radio mode,\n   where only one interface is active at any\
    \ given time.  The assigned\n   IP address is preserved whether the physical interface\
    \ changes or\n   not, and the mobile node can identify which interface should\
    \ be used\n   if there are multiple ones.\n"
- title: 5.2.  Expedited Packet Transmission
  contents:
  - "5.2.  Expedited Packet Transmission\n   The protocol specified in this document\
    \ enables the NMAG to obtain\n   parameters that would otherwise be available\
    \ only by communicating\n   with the local mobility anchor.  For instance, the\
    \ HNP(s) and/or\n   IPv4-MN-HoA of a mobile node are made available to the NMAG\
    \ through\n   context transfer.  This allows the NMAG to perform some procedures\n\
    \   that may be beneficial.  The NMAG, for example, SHOULD send a Router\n   Advertisement\
    \ (RA) with prefix information to the mobile node as soon\n   as its link attachment\
    \ is detected (e.g., via receipt of a Router\n   Solicitation message).  Such\
    \ an RA is recommended, for example, in\n   scenarios where the mobile node uses\
    \ a new radio interface while\n   attaching to the NMAG; since the mobile node\
    \ does not have\n   information regarding the new interface, it will not be able\
    \ to\n   immediately send packets without first receiving an RA with HNP(s).\n\
    \   Especially in the reactive fast handover, the NMAG gets to know the\n   HNP(s)\
    \ assigned to the mobile node on the previous link at step (d)\n   in Figure 3.\
    \  In order to reduce the communication disruption time,\n   the NMAG SHOULD expect\
    \ the mobile node to keep using the same HNP and\n   to send uplink packets before\
    \ that step upon the mobile node's\n   request.  However, if the HAck message\
    \ from the PMAG returns a\n   different HNP or the subsequent PMIPv6 binding registration\
    \ for the\n   HNP fails for some reason, then the NMAG MUST withdraw the advertised\n\
    \   HNP by sending another RA with zero prefix lifetime for the HNP in\n   question.\
    \  This operation is the same as that described in\n   Section 6.12 of [RFC5213].\n\
    \   The protocol specified in this document is applicable regardless of\n   whether\
    \ link-layer addresses are used between a mobile node and its\n   MAG.  A mobile\
    \ node should be able to continue sending packets on the\n   uplink even when\
    \ it changes link.  When link-layer addresses are\n   used, the mobile node performs\
    \ Neighbor Unreachability Detection\n   (NUD) [RFC4861], after attaching to a\
    \ new link, probing the\n   reachability of its default router.  The new router\
    \ should respond to\n   the NUD probe, providing its link-layer address in the\
    \ solicited\n   Neighbor Advertisement, which is common in the PMIPv6 domain.\n\
    \   Implementations should allow the mobile node to continue to send\n   uplink\
    \ packets while it is performing NUD.\n"
- title: 6.  Message Formats
  contents:
  - "6.  Message Formats\n   This document defines new Mobility Header messages for\
    \ the extended\n   HI and HAck, and new mobility options for conveying context\n\
    \   information.\n"
- title: 6.1.  Mobility Header
  contents:
  - '6.1.  Mobility Header

    '
- title: 6.1.1.  Handover Initiate (HI)
  contents:
  - "6.1.1.  Handover Initiate (HI)\n   This section defines extensions to the HI\
    \ message in [RFC5568].  The\n   format of the Message Data field in the Mobility\
    \ Header is as\n   follows:\n      0                   1                   2 \
    \                  3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n                                     +-------------------------------+\n\
    \                                     |           Sequence #          |\n    \
    \ +-+-+-+-+-------+---------------+-------------------------------+\n     |S|U|P|F|Resv'd\
    \ |      Code     |                               |\n     +-+-+-+-+-------+---------------+\
    \                               |\n     |                                    \
    \                           |\n     .                                        \
    \                       .\n     .                       Mobility options     \
    \                   .\n     .                                                \
    \               .\n     |                                                    \
    \           |\n     +---------------------------------------------------------------+\n\
    \     (Note: P=1)\n   IP Fields:\n   Source Address\n               The IP address\
    \ of the PMAG or NMAG\n   Destination Address\n               The IP address of\
    \ the peer MAG\n   Message Data:\n   Sequence #  Same as [RFC5568].\n   'S' flag\
    \    Defined in [RFC5568], and MUST be set to zero in this\n               specification.\n\
    \   'U' flag    Buffer flag.  Same as [RFC5568].\n   'P' flag    Proxy flag. \
    \ Used to distinguish the message from that\n               defined in [RFC5568],\
    \ and MUST be set in all new message\n               formats defined in this document\
    \ when using this protocol\n               extension.\n   'F' flag    Forwarding\
    \ flag.  Used to request to forward the packets\n               for the mobile\
    \ node.\n   Reserved    Same as [RFC5568].\n   Code        [RFC5568] defines this\
    \ field and its values, 0 and 1.  In\n               this specification, with\
    \ the 'P' flag set, this field can\n               be set to zero by default,\
    \ or to the following values:\n                  2: Indicate the completion of\
    \ forwarding\n                  3: All available context transferred\n       \
    \        Code value 3 is set when the transfer of all necessary\n            \
    \   context information is completed with this message.  This\n              \
    \ Code value is used both in cases where the context\n               information\
    \ is fragmented into several pieces and the\n               last fragment is contained\
    \ in this message, and where the\n               whole information is transferred\
    \ in one piece.\n   Mobility options:\n   This field contains one or more mobility\
    \ options, whose encoding and\n   formats are defined in [RFC3775].\n   Required\
    \ option\n      In order to uniquely identify the target mobile node, the mobile\n\
    \      node identifier MUST be contained in the Mobile Node Identifier\n     \
    \ option.\n   The transferred context MUST be for one mobile node per message.\
    \  In\n   addition, the NMAG can request necessary mobility options via the\n\
    \   Context Request option defined in this document.\n   Context Request Option\n\
    \      This option MAY be present to request context information,\n      typically\
    \ by the NMAG to the PMAG in the NMAG-initiated fast\n      handover.\n"
- title: 6.1.2.  Handover Acknowledge (HAck)
  contents:
  - "6.1.2.  Handover Acknowledge (HAck)\n   This section defines extensions to the\
    \ HAck message in [RFC5568].\n   The format of the Message Data field in the Mobility\
    \ Header is as\n   follows:\n      0                   1                   2 \
    \                  3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n                                     +-------------------------------+\n\
    \                                     |           Sequence #          |\n    \
    \ +-+-+-+---------+---------------+-------------------------------+\n     |U|P|F|Reserved\
    \ |      Code     |                               |\n     +-+-+-+---------+---------------+\
    \                               |\n     |                                    \
    \                           |\n     .                                        \
    \                       .\n     .                       Mobility options     \
    \                   .\n     .                                                \
    \               .\n     |                                                    \
    \           |\n     +---------------------------------------------------------------+\n\
    \     (Note: P=1)\n   IP Fields:\n   Source Address\n      Copied from the destination\
    \ address of the Handover Initiate\n      message to which this message is a response.\n\
    \   Destination Address\n      Copied from the source address of the Handover\
    \ Initiate message to\n      which this message is a response.\n   Message Data:\n\
    \   The usages of Sequence # and Reserved fields are exactly the same as\n   those\
    \ in [RFC5568].\n   'U' flag    Same as defined in Section 6.1.1.\n   'P' flag\
    \    Same as defined in Section 6.1.1.  Used to distinguish\n               the\
    \ message from that defined in [RFC5568], and MUST be\n               set in all\
    \ new message formats defined in this document\n               when using this\
    \ protocol extension.\n   'F' flag    Same as defined in Section 6.1.1.\n   Code\
    \        Code values 0 through 4 and 128 through 130 are defined\n           \
    \    in [RFC5568].  When the 'P' flag is set, the meaning of\n               Code\
    \ value 0 is as defined in this specification; 128\n               through 130\
    \ are reused; and 5, 6, 131, and 132 are newly\n               defined.\n    \
    \           0: Handover Accepted or Successful\n               5: Context Transfer\
    \ Accepted or Successful\n               6: All available Context Transferred\n\
    \               128: Handover Not Accepted, reason unspecified\n             \
    \  129: Administratively prohibited\n               130: Insufficient resources\n\
    \               131: Requested Context Not Available\n               132: Forwarding\
    \ Not Available\n   Mobility options:\n   This field contains one or more mobility\
    \ options, whose encoding and\n   formats are defined in [RFC3775].  The mobility\
    \ option that uniquely\n   identifies the target mobile node MUST be copied from\
    \ the\n   corresponding HI message, and the transferred context MUST be for one\n\
    \   mobile node per message.\n   Required option(s)\n      All the context information\
    \ requested by the Context Request\n      option in the HI message SHOULD be present\
    \ in the HAck message.\n      The other cases are described below.\n   In the\
    \ case of the PMAG-initiated fast handover, when the PMAG sends\n   the HI message\
    \ to the NMAG with the context information and the NMAG\n   successfully receives\
    \ it, the NMAG returns the HAck message with Code\n   value 5.  In the case of\
    \ the NMAG-initiated fast handover, when the\n   NMAG sends the HI message to\
    \ the PMAG with or without the Context\n   Request option, the PMAG returns the\
    \ HAck message with the requested\n   or default context information (if any).\
    \  If all available context\n   information is transferred, the PMAG sets the\
    \ Code value in the HAck\n   message to 6.  If more context information is available,\
    \ the PMAG\n   sets the Code value in the HAck message to 5, and the NMAG MAY\
    \ send\n   new HI message(s) to retrieve the rest of the available context\n \
    \  information.  If none of the requested context information is\n   available,\
    \ the PMAG returns the HAck message with Code value 131\n   without any context\
    \ information.\n"
- title: 6.2.  Mobility Options
  contents:
  - '6.2.  Mobility Options

    '
- title: 6.2.1.  Context Request Option
  contents:
  - "6.2.1.  Context Request Option\n   This option is sent in the HI message to request\
    \ context information\n   on the mobile node.  If a default set of context information\
    \ is\n   defined and always sufficient, this option is not used.  This option\n\
    \   is more useful to retrieve additional or dynamically selected context\n  \
    \ information.\n   The Context Request option is typically used for the reactive\
    \ (NMAG-\n   initiated) fast handover mode to retrieve the context information\n\
    \   from the PMAG.  When this option is included in the HI message, all\n   the\
    \ requested context information SHOULD be included in the HAck\n   message in\
    \ the corresponding mobility option(s) (e.g., HNP, LMAA, or\n   MN LL-ID mobility\
    \ options).\n   The default context information to request is the Home Network\
    \ Prefix\n   option.  If the Mobile Node link layer is available and used, the\n\
    \   Mobile Node Link-layer Identifier option MUST also be requested.\n      0\
    \                   1                   2                   3\n      0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +---------------+---------------+---------------+---------------+\n\
    \     |  Option-Type  | Option-Length |           Reserved            |\n    \
    \ +---------------+---------------+-------------------------------+\n     |  Req-type-1\
    \   | Req-length-1  |  Req-type-2   | Req-length-2  |\n     +---------------------------------------------------------------+\n\
    \     |  Req-type-3   | Req-length-3  |          Req-option-3         |\n    \
    \ +---------------------------------------------------------------+\n     |  \
    \                            ...                              |\n   Option-Type\
    \    40\n   Option-Length  The length in octets of this option, not including\
    \ the\n                  Option Type and Option Length fields.\n   Reserved  \
    \     This field is unused.  It MUST be initialized to zero\n                \
    \  by the sender and MUST be ignored by the receiver.\n   Req-type-n     The type\
    \ value for the nth requested option.\n   Req-length-n   The length of the nth\
    \ requested option, excluding the\n                  Req-type-n and Req-length-n\
    \ fields.\n   Req-option-n   The optional data to uniquely identify the requested\n\
    \                  context for the nth requested option.\n   In the case where\
    \ there are only Req-type-n and Req-length-n fields,\n   the value of Req-length-n\
    \ is set to zero.  If additional information\n   besides Req-type-n is necessary\
    \ to uniquely specify the requested\n   context, such information follows after\
    \ Req-length-n.  For example,\n   when the requested contexts start with the HNP\
    \ option (type=22), the\n   MN Link-layer ID option (type=25), and the Vendor-Specific\
    \ option\n   (type=19), the required option format looks as follows:\n     | \
    \                             ...                              |\n     +---------------+---------------+---------------+---------------+\n\
    \     |Option-Type=CRO| Option-Length |           Reserved            |\n    \
    \ +---------------+---------------+---------------+---------------+\n     | Req-type-n=22\
    \ | Req-length-n=0| Req-type-n=25 | Req-length-n=0|\n     +---------------+---------------+-------------------------------+\n\
    \     | Req-type-n=19 | Req-length-n=5|           Vendor-ID           |\n    \
    \ +-------------------------------+---------------+---------------+\n     |  \
    \         Vendor-ID           |   Sub-Type    |               |\n     +-----------------------------------------------+\
    \               |\n     |                              ...                   \
    \           |\n     Note: CRO = Context Request Option\n   The first two options\
    \ can uniquely identify the requested contexts\n   (i.e., the HNP and MN Link-layer\
    \ ID) by the Req-type, so the\n   Req-length is set to zero; however, the subsequent\
    \ Vendor-Specific\n   option further needs the Vendor-ID and Sub-Type to identify\
    \ the\n   requested context, so these parameters follow, and the Req-length is\n\
    \   set to 5.  Note that the exact values in the Vendor-ID and Sub-Type\n   follow\
    \ [RFC5094].\n"
- title: 6.2.2.  Local Mobility Anchor Address (LMAA) Option
  contents:
  - "6.2.2.  Local Mobility Anchor Address (LMAA) Option\n   This option is used to\
    \ transfer the Local Mobility Anchor IPv6\n   Address (LMAA) or its IPv4 Address\
    \ (IPv4-LMAA) with which the mobile\n   node is currently registered.  The detailed\
    \ definition of the LMAA is\n   described in [RFC5213].\n      0             \
    \      1                   2                   3\n      0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |  Option-Type  | Option-Length |  Option-Code  |   Reserved    |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \            Local Mobility Anchor Address ...                |\n   Option-Type\
    \    41\n   Option-Length  18 or 6\n   Option-Code    0  Reserved\n          \
    \        1  IPv6 address of the local mobility anchor (LMAA)\n               \
    \   2  IPv4 address of the local mobility anchor\n                  (IPv4-LMAA)\n\
    \   Reserved       This field is unused.  It MUST be initialized to zero\n   \
    \               by the sender and MUST be ignored by the receiver.\n   Local Mobility\
    \ Anchor Address\n                  If the Option-Code is 1, the LMA IPv6 address\
    \ (LMAA)\n                  is inserted.  If the Option-Code is 2, the LMA IPv4\n\
    \                  address (IPv4-LMA) is inserted.\n"
- title: 6.2.3.  Mobile Node Link-Local Address Interface Identifier (MN LLA-IID)
  contents:
  - "6.2.3.  Mobile Node Link-Local Address Interface Identifier (MN LLA-IID)\n  \
    \      Option\n   This option is used to transfer the interface identifier of\
    \ the\n   mobile node's IPv6 Link-local Address that is used in the P-AN.  In\n\
    \   deployments where the interface identifier is assigned by the network\n  \
    \ or is known to the network, this option is used to transfer this\n   identifier\
    \ from the PMAG to the NMAG.\n      0                   1                   2\
    \                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     | Option-Type   | Option-Length |            Reserved           |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                                                             |\n     +      \
    \                Interface Identifier                     +\n     |          \
    \                                                     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Option-Type    42\n   Option-Length  10\n   Reserved       This field is unused.\
    \  It MUST be initialized to zero\n                  by the sender and MUST be\
    \ ignored by the receiver.\n   Interface Identifier\n                  The Interface\
    \ Identifier value used for the mobile\n                  node's IPv6 Link-local\
    \ address in the P-AN.\n"
- title: 6.2.4.  Home Network Prefix Option
  contents:
  - "6.2.4.  Home Network Prefix Option\n   This option, as defined in [RFC5213],\
    \ is used to transfer the home\n   network prefix that is assigned to the mobile\
    \ node in the P-AN.\n"
- title: 6.2.5.  Link-Local Address Option
  contents:
  - "6.2.5.  Link-Local Address Option\n   This option, as defined in [RFC5213], is\
    \ used to transfer the link-\n   local address of the PMAG.\n"
- title: 6.2.6.  GRE Key Option
  contents:
  - "6.2.6.  GRE Key Option\n   This option is used to transfer the GRE Key for the\
    \ mobile node's\n   data flow over the bidirectional tunnel between the PMAG and\
    \ NMAG.\n   The message format of this option follows that of the GRE Key option\n\
    \   defined in [RFC5845].  The GRE Key value uniquely identifies each\n   flow,\
    \ and the sender of this option expects to receive packets of the\n   flow from\
    \ the peer AR with this value.\n"
- title: 6.2.7.  IPv4 Address Option
  contents:
  - "6.2.7.  IPv4 Address Option\n   As described in Section 4.3, if the mobile node\
    \ runs in IPv4-only\n   mode or dual-stack mode, it requires the IPv4 home address\n\
    \   (IPv4-MN-HoA).  This option is used to transfer the IPv4 home address\n  \
    \ if assigned on the previous link.  The format of this option follows\n   that\
    \ of the IPv4 Home Address Request option defined in [RFC5844].\n"
- title: 6.2.8.  Vendor-Specific Mobility Option
  contents:
  - "6.2.8.  Vendor-Specific Mobility Option\n   This option is used to transfer any\
    \ other information defined in this\n   document.  The format and used values\
    \ of this option follow those of\n   the Vendor-Specific Mobility option defined\
    \ in [RFC5094].\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   Security issues for this document follow those\
    \ for PMIPv6 [RFC5213]\n   and FMIPv6 [RFC5568].  In PMIPv6, the MAG and local\
    \ mobility anchor\n   are assumed to share security associations.  In FMIPv6,\
    \ the access\n   routers (i.e., the PMAG and NMAG in this document) are assumed\
    \ to\n   share security associations.\n   The Handover Initiate (HI) and Handover\
    \ Acknowledge (HAck) messages\n   exchanged between the PMAG and NMAG MUST be\
    \ protected using end-to-\n   end security association(s) offering integrity and\
    \ data origin\n   authentication.  The PMAG and the NMAG MUST implement IPsec\
    \ [RFC4301]\n   for protecting the HI and HAck messages.  IPsec Encapsulating\n\
    \   Security Payload (ESP) [RFC4303] in transport mode with mandatory\n   integrity\
    \ protection SHOULD be used for protecting the signaling\n   messages.  Confidentiality\
    \ protection SHOULD be used if sensitive\n   context related to the mobile node\
    \ is transferred.\n   IPsec ESP [RFC4303] in tunnel mode SHOULD be used to protect\
    \ the\n   mobile node's packets at the time of forwarding if the link between\n\
    \   the PMAG and NMAG exposes the mobile node's packets to more threats\n   than\
    \ if they had followed their normal routed path.\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   This document defines new flags and status codes\
    \ in the HI and HAck\n   messages, as well as three new mobility options.  The\
    \ Type values for\n   these mobility options are assigned from the same numbering\
    \ space as\n   that allocated for the other mobility options defined in [RFC3775].\n\
    \   Those for the flags and status codes are assigned from the\n   corresponding\
    \ numbering space defined in [RFC5568], and have been\n   created as new tables\
    \ in the IANA registry (marked with asterisks).\n   New values for these registries\
    \ can be allocated by Standards Action\n   or IESG approval [RFC5226].\n    Mobility\
    \ Options\n    Value  Description                                Reference\n \
    \   -----  -------------------------------------      -------------\n    40  \
    \   Context Request Option                     Section 6.2.1\n    41     Local\
    \ Mobility Anchor Address Option       Section 6.2.2\n    42     Mobile Node Link-local\
    \ Address\n                    Interface Identifier Option       Section 6.2.3\n\
    \    Handover Initiate Flags (*)\n    Registration Procedures: Standards Action\
    \ or IESG Approval\n    Flag  Value  Description                          Reference\n\
    \    ----  -----  -----------------------------------  -------------\n      S\
    \   0x80   Assigned Address Configuration flag  [RFC5568]\n      U   0x40   Buffer\
    \ flag                          [RFC5568]\n      P   0x20   Proxy flag       \
    \                    Section 6.1.1\n      F   0x10   Forwarding flag         \
    \             Section 6.1.1\n    Handover Acknowledge Flags (*)\n    Registration\
    \ Procedures: Standards Action or IESG Approval\n    Flag  Value  Description\
    \                          Reference\n    ----  -----  -------------------------------\
    \      -------------\n      U   0x80   Buffer flag                          Section\
    \ 6.1.2\n      P   0x40   Proxy flag                           Section 6.1.2\n\
    \      F   0x20   Forwarding flag                      Section 6.1.2\n    Handover\
    \ Initiate Status Codes (*)\n    Registration Procedures: Standards Action or\
    \ IESG Approval\n    Code  Description                                 Reference\n\
    \    ----  --------------------------------------      -------------\n      0\
    \   FBU with the PCoA as source IP address      [RFC5568]\n      1   FBU whose\
    \ source IP address is not PCoA     [RFC5568]\n      2   Indicate the completion\
    \ of forwarding       Section 6.1.1\n      3   All available context transferred\
    \           Section 6.1.1\n    4-255 Unassigned\n    Handover Acknowledge Status\
    \ Codes (*)\n    Registration Procedures: Standards Action or IESG Approval\n\
    \    Code    Description                                 Reference\n    ---- \
    \   ---------------------------------------     -------------\n      0     Handover\
    \ Accepted or Successful\n               (when 'P' flag is set)              \
    \     Section 6.1.2\n            Handover Accepted with NCoA valid           [RFC5568]\n\
    \      1     Handover Accepted, NCoA not valid           [RFC5568]\n      2  \
    \   Handover Accepted, NCoA assigned            [RFC5568]\n      3     Handover\
    \ Accepted, use PCoA                 [RFC5568]\n      4     Message sent unsolicited\
    \                    [RFC5568]\n      5     Context Transfer Accepted or Successful\
    \     Section 6.1.2\n      6     All available Context Transferred           Section\
    \ 6.1.2\n    7-127   Unassigned\n    128     Handover Not Accepted, reason unspecified\
    \   [RFC5568]\n    129     Administratively prohibited                 [RFC5568]\n\
    \    130     Insufficient resources                      [RFC5568]\n    131  \
    \   Requested Context Not Available             Section 6.1.2\n    132     Forwarding\
    \ Not Available                    Section 6.1.2\n   133-255  Unassigned\n"
- title: 9.  Acknowledgments
  contents:
  - "9.  Acknowledgments\n   The authors would like to specially thank Vijay Devarapalli\
    \ and Sri\n   Gundavelli for their thorough reviews of this document.\n   The\
    \ authors would also like to thank Charlie Perkins, Desire Oulai,\n   Ahmad Muhanna,\
    \ Giaretta Gerardo, Domagoj Premec, Marco Liebsch, Fan\n   Zhao, Julien Laganier,\
    \ and Pierrick Seite for their passionate\n   discussions in the MIPSHOP working\
    \ group mailing list.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC2119]   Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n               Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC3775]   Johnson, D., Perkins, C., and J. Arkko, \"Mobility\
    \ Support\n               in IPv6\", RFC 3775, June 2004.\n   [RFC4301]   Kent,\
    \ S. and K. Seo, \"Security Architecture for the\n               Internet Protocol\"\
    , RFC 4301, December 2005.\n   [RFC4303]   Kent, S., \"IP Encapsulating Security\
    \ Payload (ESP)\",\n               RFC 4303, December 2005.\n   [RFC5094]   Devarapalli,\
    \ V., Patel, A., and K. Leung, \"Mobile IPv6\n               Vendor Specific Option\"\
    , RFC 5094, December 2007.\n   [RFC5213]   Gundavelli, S., Leung, K., Devarapalli,\
    \ V., Chowdhury,\n               K., and B. Patil, \"Proxy Mobile IPv6\", RFC\
    \ 5213,\n               August 2008.\n   [RFC5226]   Narten, T. and H. Alvestrand,\
    \ \"Guidelines for Writing an\n               IANA Considerations Section in RFCs\"\
    , BCP 26, RFC 5226,\n               May 2008.\n   [RFC5568]   Koodli, R., \"Mobile\
    \ IPv6 Fast Handovers\", RFC 5568,\n               July 2009.\n   [RFC5844]  \
    \ Wakikawa, R. and S. Gundavelli, \"IPv4 Support for Proxy\n               Mobile\
    \ IPv6\", RFC 5844, May 2010.\n   [RFC5845]   Muhanna, A., Khalil, M., Gundavelli,\
    \ S., and K. Leung,\n               \"Generic Routing Encapsulation (GRE) Key\
    \ Option for Proxy\n               Mobile IPv6\", RFC 5845, June 2010.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [RFC4861]   Narten, T., Nordmark, E., Simpson,\
    \ W., and H. Soliman,\n               \"Neighbor Discovery for IP version 6 (IPv6)\"\
    , RFC 4861,\n               September 2007.\n   [RFC4988]   Koodli, R. and C.\
    \ Perkins, \"Mobile IPv4 Fast Handovers\",\n               RFC 4988, October 2007.\n"
- title: Appendix A.  Applicable Use Cases
  contents:
  - 'Appendix A.  Applicable Use Cases

    '
- title: A.1.  PMIPv6 Handoff Indication
  contents:
  - "A.1.  PMIPv6 Handoff Indication\n   PMIPv6 [RFC5213] defines the Handoff Indicator\
    \ option and also\n   describes the type of handoff and values that can be set\
    \ for this\n   option.  This document proposes one approach to determining the\n\
    \   handoff type by the NMAG when the handoff of the mobile node is\n   executed.\n\
    \   According to [RFC5213], the following handoff types are defined:\n      0)\
    \ Reserved\n      1) Attachment over a new interface\n      2) Handoff between\
    \ two different interfaces of the mobile node\n      3) Handoff between mobile\
    \ access gateways for the same interface\n      4) Handoff state unknown\n   \
    \   5) Handoff state not changed (Re-registration)\n   Assuming that there is\
    \ a valid MN Link-layer Identifier (MN LL-ID),\n   the following solution can\
    \ be considered.  When the NMAG receives the\n   MN LL-ID from the PMAG in the\
    \ MN LL-ID option via the HI or HAck\n   message, the NMAG compares it with the\
    \ new MN LL-ID that is obtained\n   from the mobile node in the N-AN.  If these\
    \ two MN LL-IDs are the\n   same, the handoff type falls into type 3 (defined\
    \ above) and the\n   Handoff Indicator value is set to 3.  If these two MN LL-IDs\
    \ are\n   different, the handoff is likely to be type 2 (defined above) since\n\
    \   the HI/HAck message exchange implies that this is a handoff rather\n   than\
    \ a multihoming, and therefore the Handoff Indicator value can be\n   set to 2.\
    \  If there is no HI/HAck exchange performed prior to the\n   network attachment\
    \ of the mobile node in the N-AN, the NMAG may infer\n   that this is a multi-homing\
    \ case and set the Handoff Indicator value\n   to 1.  In the case of re-registration,\
    \ the MAG, to which the mobile\n   node is attached, can determine if the handoff\
    \ state is not changed,\n   so the MAG can set the HI value to 5 without any additional\n\
    \   information.  If no handoff type can be assumed or if there is no\n   valid\
    \ MN LL-ID available, the NMAG may set the value to 4.\n"
- title: A.2.  Local Routing
  contents:
  - "A.2.  Local Routing\n   As described in Section 6.10.3 of [RFC5213], if the\n\
    \   EnableMAGLocalRouting flag is set, when two mobile nodes are attached\n  \
    \ to one MAG, the traffic between them may be locally routed.  If one\n   mobile\
    \ node moves from this MAG (PMAG) to another MAG (NMAG) and if\n   the PMAG does\
    \ not detect the mobile node's detachment, it will\n   continue to forward packets\
    \ locally forever.  This situation is more\n   likely to happen in the reactive\
    \ fast handover with Wireless Local\n   Area Network (WLAN) access, which does\
    \ not have the capability to\n   detect the detachment of the mobile node in a\
    \ timely manner.  This\n   specification can be applied to handle this case. \
    \ When the mobile\n   node attaches to the NMAG, the NMAG sends the HI message\
    \ to the PMAG\n   with the 'F' flag set, which makes the PMAG realize the detachment\
    \ of\n   the mobile node and establish the inter-MAG tunnel.  The PMAG\n   immediately\
    \ stops the local routing and sends the packets for the\n   mobile node to the\
    \ NMAG via that tunnel; the packets are then\n   delivered to the mobile node\
    \ on the new link.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Hidetoshi Yokota\n   KDDI Lab\n   2-1-15 Ohara, Fujimino\n\
    \   Saitama  356-8502\n   Japan\n   EMail: yokota@kddilabs.jp\n   Kuntal Chowdhury\n\
    \   Cisco Systems\n   30 International Place\n   Tewksbury, MA  01876\n   USA\n\
    \   EMail: kchowdhu@cisco.com\n   Rajeev Koodli\n   Cisco Systems\n   170 W. Tasman\
    \ Drive\n   San Jose, CA  95134\n   USA\n   EMail: rkoodli@cisco.com\n   Basavaraj\
    \ Patil\n   Nokia\n   6000 Connection Drive\n   Irving, TX  75039\n   USA\n  \
    \ EMail: basavaraj.patil@nokia.com\n   Frank Xia\n   Huawei USA\n   1700 Alma\
    \ Dr. Suite 500\n   Plano, TX  75075\n   USA\n   EMail: xiayangsong@huawei.com\n"
