- title: __initial_text__
  contents:
  - '         Hierarchical Mobile IPv6 (HMIPv6) Mobility Management

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document introduces extensions to Mobile IPv6 and IPv6 Neighbour\n\
    \   Discovery to allow for local mobility handling.  Hierarchical\n   mobility\
    \ management for Mobile IPv6 is designed to reduce the amount\n   of signalling\
    \ between the mobile node, its correspondent nodes, and\n   its home agent.  The\
    \ Mobility Anchor Point (MAP) described in this\n   document can also be used\
    \ to improve the performance of Mobile IPv6\n   in terms of handover speed.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \ 3. Overview of HMIPv6 ..............................................5\n    \
    \  3.1. HMIPv6 Operations ..........................................6\n   4. Mobile\
    \ IPv6 Extension - Local Binding Update ....................9\n   5. Neighbour\
    \ Discovery Extension: The MAP Option ...................9\n   6. Protocol Operation\
    \ .............................................10\n      6.1. Mobile Node Operation\
    \ .....................................11\n           6.1.1. Sending Packets to\
    \ Correspondent Nodes .............12\n      6.2. MAP Operations ............................................13\n\
    \      6.3. Home Agent Operations .....................................13\n  \
    \    6.4. Correspondent Node Operations .............................13\n    \
    \  6.5. Local Mobility Management Optimisation within a\n           MAP Domain\
    \ ................................................14\n      6.6. Location Privacy\
    \ ..........................................14\n   7. MAP Discovery ..................................................15\n\
    \      7.1. Mobile Node Operation .....................................15\n  \
    \ 8. Updating Previous MAPs .........................................16\n   9.\
    \ Note on MAP Selection by the Mobile Node .......................16\n      9.1.\
    \ MAP Selection in Distributed MAP Environment ..............17\n      9.2. MAP\
    \ Selection in a Flat Mobility Architecture .............18\n   10. Detection\
    \ and Recovery from MAP Failures ......................18\n   11. Tunelling Impacts\
    \ on MTU ......................................19\n   12. Security Considerations\
    \ .......................................19\n      12.1. Mobile Node - MAP Security\
    \ ...............................20\n      12.2. Mobile Node - Correspondent Node\
    \ Security ................22\n      12.3. Mobile Node - Home Agent Security ........................22\n\
    \   13. IANA Considerations ...........................................22\n  \
    \ 14. Acknowledgements ..............................................22\n   15.\
    \ References ....................................................23\n      15.1.\
    \ Normative References .....................................23\n      15.2. Informative\
    \ References ...................................23\n   Appendix A. Changes from\
    \ RFC 4140 .................................24\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This specification introduces the concept of a hierarchical\
    \ Mobile\n   IPv6 network, utilising a new node called the Mobility Anchor Point\n\
    \   (MAP).\n   Mobile IPv6 [RFC3775] allows nodes to move within the Internet\n\
    \   topology while maintaining reachability and ongoing connections\n   between\
    \ mobile and correspondent nodes.  To do this, a mobile node\n   sends binding\
    \ updates (BUs) to its home agent (HA) every time it\n   moves.\n   The mobile\
    \ node may send data packets via its home agent immediately\n   after sending\
    \ the binding update, but the home agent will not be able\n   to route traffic\
    \ back to the mobile node before it receives the\n   binding update.  This incurs\
    \ at least half a round-trip delay before\n   packets are again forwarded to the\
    \ right place.  There is an\n   additional delay for sending data packets if the\
    \ mobile node chooses\n   to wait for a binding acknowledgement (BA).  The round-trip\
    \ times can\n   be relatively long if the mobile node and its home agent are in\n\
    \   different parts of the world.\n   Additional delay is also incurred if the\
    \ mobile node employs route\n   optimisation.  Authenticating binding updates\
    \ requires approximately\n   1.5 round-trip times between the mobile node and\
    \ each correspondent\n   node (for the entire return routability procedure in\
    \ a best-case\n   scenario, i.e., no packet loss).  This can be done in parallel\
    \ with\n   sending binding updates to the home agent, and there are further\n\
    \   optimisations that reduce the required 1.5 round-trips [RFC4449]\n   [RFC4651]\
    \ [RFC4866].\n   Nevertheless, the signalling exchanges required to update your\n\
    \   location will always cause some disruption to active connections.\n   Some\
    \ packets will be lost.  Together with link layer and IP layer\n   connection\
    \ setup delays, there may be effects to upper-layer\n   protocols.  Reducing these\
    \ delays during the time-critical handover\n   period will improve the performance\
    \ of Mobile IPv6.\n   Moreover, in the case of wireless links, such a solution\
    \ reduces the\n   number of messages sent over the air interface to all correspondent\n\
    \   nodes and the home agent.  A local anchor point will also allow\n   Mobile\
    \ IPv6 to benefit from reduced mobility signalling with external\n   networks.\n\
    \   For these reasons, a new Mobile IPv6 node, called the Mobility Anchor\n  \
    \ Point, is used and can be located at any level in a hierarchical\n   network\
    \ of routers, including the Access Router (AR).  The MAP will\n   limit the amount\
    \ of Mobile IPv6 signalling outside the local domain.\n   The introduction of\
    \ the MAP provides a solution to the issues\n   outlined earlier, in the following\
    \ way:\n   o  The mobile node sends binding updates to the local MAP rather than\n\
    \      the home agent (HA) (which is typically further away) and\n      correspondent\
    \ nodes (CNs).\n   o  Only one binding update message needs to be transmitted\
    \ by the\n      mobile node (MN) before traffic from the HA and all CNs is\n \
    \     re-routed to its new location.  This is independent of the number\n    \
    \  of CNs with which the MN is communicating.\n   A MAP is essentially a local\
    \ home agent.  The aim of introducing the\n   hierarchical mobility management\
    \ model in Mobile IPv6 is to enhance\n   the performance of Mobile IPv6 while\
    \ minimising the impact on Mobile\n   IPv6 or other IPv6 protocols.  Furthermore,\
    \ HMIPv6 allows mobile\n   nodes to hide their location from correspondent nodes\
    \ and home\n   agents, while using Mobile IPv6 route optimisation.  The security\n\
    \   differences between the MAP and the home agent are described in\n   Section\
    \ 12.\n   It is pertinent to note that the use of the MAP does not rely on, or\n\
    \   assume the presence of, a permanent home agent.  In other words, a\n   mobile\
    \ node need not have a permanent home address or home agent in\n   order to be\
    \ HMIPv6-aware or use the features in this specification.\n   A MAP may be used\
    \ by a mobile node in a nomadic manner to achieve\n   mobility management within\
    \ a local domain.  Section 6.5 describes\n   such a scenario.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n\
    \   In addition, the following terms are introduced:\n   Access Router (AR)\n\
    \      The AR is the mobile node's default router.  The AR aggregates the\n  \
    \    outbound traffic of mobile nodes.\n   Mobility Anchor Point (MAP)\n     \
    \ A Mobility Anchor Point is a router located in a network visited\n      by the\
    \ mobile node.  The MAP is used by the MN as a local HA.  One\n      or more MAPs\
    \ can exist within a visited network.\n   Regional Care-of Address (RCoA)\n  \
    \    An RCoA is an address allocated by the MAP to the mobile node.\n   HMIPv6-Aware\
    \ Mobile Node\n      An HMIPv6-aware mobile node is a mobile node that can receive\
    \ and\n      process the MAP option received from its default router.  An\n  \
    \    HMIPv6-aware mobile node must also be able to send local binding\n      updates\
    \ (binding update with the M flag set).\n   On-Link Care-of Address\n      The\
    \ LCoA is the on-link CoA configured on a mobile node's\n      interface based\
    \ on the prefix advertised by its default router.\n      In [RFC3775], this is\
    \ simply referred to as the care-of address.\n      However, in this memo LCoA\
    \ is used to distinguish it from the\n      RCoA.\n   Local Binding Update\n \
    \     The MN sends a local binding update to the MAP in order to\n      establish\
    \ a binding between the RCoA and LCoA.\n"
- title: 3.  Overview of HMIPv6
  contents:
  - "3.  Overview of HMIPv6\n   This hierarchical Mobile IPv6 scheme introduces a\
    \ new function, the\n   MAP, and minor extensions to the mobile node operation.\
    \  The\n   correspondent node and home agent operations will not be affected.\n\
    \   Just like Mobile IPv6, this solution is independent of the underlying\n  \
    \ access technology, allowing mobility within or between different\n   types of\
    \ access networks.\n   A mobile node entering a MAP domain will receive Router\n\
    \   Advertisements containing information about one or more local MAPs.\n   The\
    \ MN can bind its current location (on-link CoA) with an address on\n   the MAP's\
    \ subnet (RCoA).  Acting as a local HA, the MAP will receive\n   all packets on\
    \ behalf of the mobile node it is serving and will\n   encapsulate and forward\
    \ them directly to the mobile node's current\n   address.  If the mobile node\
    \ changes its current address within a\n   local MAP domain (LCoA), it only needs\
    \ to register the new address\n   with the MAP.  Hence, only the Regional CoA\
    \ (RCoA) needs to be\n   registered with correspondent nodes and the HA.  The\
    \ RCoA does not\n   change as long as the MN moves within a MAP domain (see below\
    \ for\n   definition).  This makes the mobile node's mobility transparent to\n\
    \   correspondent nodes it communicates with.\n   A MAP domain's boundaries are\
    \ defined by the Access Routers (ARs)\n   advertising the MAP information to the\
    \ attached mobile nodes.  The\n   detailed extensions to Mobile IPv6 and operations\
    \ of the different\n   nodes will be explained later in this document.\n   It\
    \ should be noted that the HMIPv6 concept is simply an extension to\n   the Mobile\
    \ IPv6 protocol.  An HMIPv6-aware mobile node with an\n   implementation of Mobile\
    \ IPv6 SHOULD choose to use the MAP when\n   discovering such capability in a\
    \ visited network.  However, in some\n   cases the mobile node may prefer to simply\
    \ use the standard Mobile\n   IPv6 implementation.  For instance, the mobile node\
    \ may be located in\n   a visited network within its home site.  In this case,\
    \ the HA is\n   located near the visited network and could be used instead of\
    \ a MAP.\n   In this scenario, the mobile node would only update the HA whenever\n\
    \   it moves.  The method to determine whether the HA is in the vicinity\n   of\
    \ the MN (e.g., same site) is outside the scope of this document.\n"
- title: 3.1.  HMIPv6 Operations
  contents:
  - "3.1.  HMIPv6 Operations\n   The network architecture shown in Figure 1 illustrates\
    \ an example of\n   the use of the MAP in a visited network.\n   In Figure 1,\
    \ the MAP can help in providing seamless mobility for the\n   mobile node as it\
    \ moves from Access Router 1 (AR1) to Access Router 2\n   (AR2), while communicating\
    \ with the correspondent node.  A\n   multi-level hierarchy is not required for\
    \ a higher handover\n   performance.  Hence, it is sufficient to locate one or\
    \ more MAPs\n   (possibly covering the same domain) at any position in the operator's\n\
    \   network.\n   +-------+\n   |  HA   |\n   +-------+       +----+\n       |\
    \           | CN |\n       |           +----+\n       |             |\n      \
    \ +-------+-----+\n                     |\n                     |RCoA\n      \
    \           +-------+\n                 |  MAP  |\n                 +-------+\n\
    \                 |      |\n                 |      +--------+\n             \
    \    |               |\n                 |               |\n               +-----+\
    \          +-----+\n               | AR1 |          | AR2 |\n               +-----+\
    \          +-----+\n               LCoA1             LCoA2\n               +----+\n\
    \               | MN |\n               +----+   ------------>\n              \
    \           Movement\n                 Figure 1: Hierarchical Mobile IPv6 domain\n\
    \   Upon arrival in a visited network, the mobile node will discover the\n   global\
    \ address of the MAP.  This address is stored in the Access\n   Routers and communicated\
    \ to the mobile node via Router Advertisements\n   (RAs).  A new option for RAs\
    \ is defined later in this specification.\n   This is needed to inform mobile\
    \ nodes about the presence of the MAP\n   (MAP Discovery).  The discovery phase\
    \ will also inform the mobile\n   node of the distance of the MAP from the mobile\
    \ node.  For example,\n   the MAP function could be implemented as shown in Figure\
    \ 1, and, at\n   the same time, also be implemented in AR1 and AR2.  In this case,\
    \ the\n   mobile node can choose the first hop MAP or one further up in the\n\
    \   hierarchy of routers.  The details on how to choose a MAP are\n   provided\
    \ in Section 10.\n   The process of MAP Discovery continues as the mobile node\
    \ moves from\n   one subnet to the next.  Every time the mobile node detects movement,\n\
    \   it will also detect whether it is still in the same MAP domain.  The\n   Router\
    \ Advertisement used to detect movement will also inform the\n   mobile node,\
    \ through Neighbour Discovery [RFC4861] and the MAP\n   option, whether it is\
    \ still in the same MAP domain.  As the mobile\n   node roams within a MAP domain,\
    \ it will continue to receive the same\n   MAP option included in Router Advertisements\
    \ from its AR.  If a\n   change in the advertised MAP's address is received, the\
    \ mobile node\n   MUST act on the change by sending binding updates to its HA\
    \ and\n   correspondent nodes.\n   If the mobile node is not HMIPv6-aware, then\
    \ no MAP Discovery will be\n   performed, resulting in the mobile node using the\
    \ Mobile IPv6\n   [RFC3775] protocol for its mobility management.  On the other\
    \ hand,\n   if the mobile node is HMIPv6-aware it SHOULD choose to use its HMIPv6\n\
    \   implementation.  If so, the mobile node will first need to register\n   with\
    \ a MAP by sending it a BU containing its home address and on-link\n   address\
    \ (LCoA).  The home address used in the BU is the RCoA, which\n   the mobile node\
    \ acquires via RFC 4877 [RFC4877] Section 9 mechanisms\n   when it first contacts\
    \ a given MAP.  The MAP MUST store this\n   information in its binding cache to\
    \ be able to forward packets to\n   their final destination when received from\
    \ the different\n   correspondent nodes or HAs.\n   The mobile node will always\
    \ need to know the original sender of any\n   received packets to determine if\
    \ route optimisation is required.\n   This information will be available to the\
    \ mobile node because the MAP\n   does not modify the contents of the original\
    \ packet.  Normal\n   processing of the received packets (as described in [RFC3775])\
    \ will\n   give the mobile node the necessary information.\n   To use the network\
    \ bandwidth in a more efficient manner, a mobile\n   node may decide to register\
    \ with more than one MAP simultaneously and\n   to use each MAP address for a\
    \ specific group of correspondent nodes.\n   For example, in Figure 1, if the\
    \ correspondent node happens to exist\n   on the same link as the mobile node,\
    \ it would be more efficient to\n   use the first hop MAP (in this case assume\
    \ it is AR1) for\n   communication between them.  This will avoid sending all\
    \ packets via\n   the \"highest\" MAP in the hierarchy and thus will result in\
    \ more\n   efficient usage of network bandwidth.  The mobile node can also use\n\
    \   its current on-link address (LCoA) as a CoA, as specified in\n   [RFC3775].\
    \  Note that the mobile node MUST NOT present an RCoA from a\n   MAP's subnet\
    \ as an LCoA in a binding update sent to another MAP.  The\n   LCoA included in\
    \ the binding update MUST be the mobile node's\n   address, derived from the prefix\
    \ advertised on its link.\n"
- title: 4.  Mobile IPv6 Extension - Local Binding Update
  contents:
  - "4.  Mobile IPv6 Extension - Local Binding Update\n   This section outlines the\
    \ extensions proposed to the binding update\n   specified in [RFC3775].\n   A\
    \ new flag is added: the M flag, which indicates MAP registration.\n   When a\
    \ mobile node registers with the MAP, the M and A flags MUST be\n   set to distinguish\
    \ this registration from a BU being sent to the HA\n   or a correspondent node.\n\
    \    0                   1                   2                   3\n    0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Sequence #         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |A|H|L|K|M|      Reserved       |            Lifetime           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                      Figure 2: Local Binding Update\n   M\n      If set to 1,\
    \ it indicates a MAP registration.\n"
- title: '5.  Neighbour Discovery Extension: The MAP Option'
  contents:
  - "5.  Neighbour Discovery Extension: The MAP Option\n    0                   1\
    \                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |    Length     |  Dist |  Pref |R|  Reserved   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                      Valid Lifetime                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                                                             +\n   |        \
    \                                                       |\n   +              \
    \    Global IP Address for MAP                    +\n   |                    \
    \                                           |\n   +                          \
    \                                     +\n   |                                \
    \                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                         Figure 3: The MAP option\n   Type\n      IPv6 Neighbour\
    \ Discovery option. Its value is 23.\n   Length\n      8-bit unsigned integer.\
    \  The length of the option and MUST be set\n      to 3.\n   Dist\n      A 4-bit\
    \ unsigned integer identifying the distance between MAP and\n      the receiver\
    \ of the advertisement, measure in the number of hops\n      and starting from\
    \ 1 if the MAP is on the same link as the mobile\n      node.  A distance value\
    \ of zero MUST NOT be used.\n   Pref\n      The preference field, used as an indicator\
    \ of operator preference.\n      A 4-bit unsigned integer.  A decimal value of\
    \ 15 indicates the\n      highest preference.  When comparing two potential MAPs,\
    \ the mobile\n      node SHOULD inspect this field as a tie-breaker for MAPs that\
    \ have\n      equal Dist values.\n   R\n      When set to 1, it indicates that\
    \ the mobile node is allocated the\n      RCoA by the MAP based on Section 9 of\
    \ [RFC4877].\n   Valid Lifetime\n      The minimum value (in seconds) of both\
    \ the valid lifetime of the\n      prefix used to form the MAP's address and that\
    \ used to form the\n      RCoA.  This value indicates the validity of the MAP's\
    \ address and\n      the RCoA.\n   Global Address\n      One of the MAP's global\
    \ addresses.\n"
- title: 6.  Protocol Operation
  contents:
  - "6.  Protocol Operation\n   This section describes the HMIPv6 protocol.  In HMIPv6,\
    \ the mobile\n   node has two addresses, an RCoA on the MAP's link and an on-link\
    \ CoA\n   (LCoA).  This RCoA is formed in a stateless manner by combining the\n\
    \   mobile node's interface identifier and the subnet prefix received in\n   the\
    \ MAP option.\n   As illustrated in this section, this protocol requires updating\
    \ the\n   mobile nodes' implementation only.  The HA and correspondent node are\n\
    \   unchanged.  The MAP performs the function of a \"local\" HA that binds\n \
    \  the mobile node's RCoA to an LCoA.\n"
- title: 6.1.  Mobile Node Operation
  contents:
  - "6.1.  Mobile Node Operation\n   When a mobile node moves into a new MAP domain\
    \ (i.e., its MAP\n   changes), it needs to configure two CoAs: an RCoA on the\
    \ MAP's link\n   and an on-link CoA (LCoA).  After employing [RFC4877] to acquire\
    \ an\n   RCoA, the mobile node sends a local BU to the MAP with the A and M\n\
    \   flags set.  The local BU is a BU defined in [RFC3775] and includes\n   the\
    \ mobile node's RCoA in the Home Address option.  No alternate-CoA\n   option\
    \ is needed in this message.  The LCoA is used as the source\n   address of the\
    \ BU.  This BU will bind the mobile node's RCoA (similar\n   to a home address)\
    \ to its LCoA.  The MAP (acting as an HA) will then\n   return a binding acknowledgement\
    \ to the MN.  This acknowledgement\n   either identifies the binding as successful\
    \ or contains the\n   appropriate fault code.  No new error codes need to be supported\
    \ by\n   the mobile node for this operation.  The mobile node MUST silently\n\
    \   ignore binding acknowledgements that do not contain a routing header\n   type\
    \ 2, which includes the mobile node's RCoA.\n   Following a successful registration\
    \ with the MAP, a bi-directional\n   tunnel between the mobile node and the MAP\
    \ is established.  All\n   packets sent by the mobile node are tunnelled to the\
    \ MAP.  The outer\n   header contains the mobile node's LCoA in the source address\
    \ field,\n   and the MAP's address in the destination address field.  The inner\n\
    \   header contains the mobile node's RCoA in the source address field,\n   and\
    \ the peer's address in the destination address field.  Similarly,\n   all packets\
    \ addressed to the mobile node's RCoA are intercepted by\n   the MAP and tunnelled\
    \ to the mobile node's LCoA.\n   This specification allows a mobile node to use\
    \ more than one RCoA if\n   it received more than one MAP option.  In this case,\
    \ the mobile node\n   MAY perform the binding update procedure for each RCoA.\
    \  In addition,\n   the mobile node MUST NOT use one RCoA (e.g., RCoA1) derived\
    \ from a\n   MAP's prefix (e.g., MAP1) as a care-of address in its binding update\n\
    \   to another MAP (e.g., MAP2).  This would force packets to be\n   encapsulated\
    \ several times (twice in this example) on their path to\n   the mobile node.\
    \  This form of multi-level hierarchy will reduce the\n   protocol's efficiency\
    \ and performance.\n   After registering with the MAP, the mobile node MUST register\
    \ its new\n   RCoA with its HA by sending a BU that specifies the binding (RCoA,\n\
    \   home address), as in Mobile IPv6.  The mobile node's home address is\n   used\
    \ in the Home Address option and the RCoA is used as the care-of\n   address in\
    \ the source address field.  The mobile node may also send a\n   similar BU (i.e.,\
    \ that specifies the binding between the home address\n   and the RCoA) to its\
    \ current correspondent nodes.\n   The mobile node SHOULD wait for the binding\
    \ acknowledgement from the\n   MAP before registering the RCoA with other nodes\
    \ (e.g., CN or HA, if\n   available).  It should be noted that when binding the\
    \ RCoA with the\n   HA and correspondent nodes, the binding lifetime MUST NOT\
    \ be larger\n   than the mobile node's binding lifetime with the MAP, which is\n\
    \   received in the binding acknowledgement.\n   In order to speed up the handover\
    \ between MAPs and reduce packet\n   loss, a mobile node SHOULD send a local BU\
    \ to its previous MAP,\n   specifying its new LCoA.  Packets in transit that reach\
    \ the previous\n   MAP are then forwarded to the new LCoA.\n   The MAP will receive\
    \ packets addressed to the mobile node's RCoA\n   (from the HA or correspondent\
    \ nodes).  Packets will be tunnelled from\n   the MAP to the mobile node's LCoA.\
    \  The mobile node will de-capsulate\n   the packets and process them in the normal\
    \ manner.\n   When the mobile node moves within the same MAP domain, it should\
    \ only\n   register its new LCoA with its MAP.  In this case, the RCoA remains\n\
    \   unchanged.\n   Note that a mobile node may send a BU containing its LCoA (instead\
    \ of\n   its RCoA) to correspondent nodes.  If these nodes are connected to\n\
    \   the same link, packets will then be routed directly, without going\n   through\
    \ the MAP.\n"
- title: 6.1.1.  Sending Packets to Correspondent Nodes
  contents:
  - "6.1.1.  Sending Packets to Correspondent Nodes\n   The mobile node can communicate\
    \ with a correspondent node through the\n   HA, or in a route-optimised manner,\
    \ as described in [RFC3775].  When\n   communicating through the HA, the message\
    \ formats in [RFC3775] are\n   used.\n   If the mobile node communicates directly\
    \ with the correspondent node\n   (i.e., the CN has a binding cache entry for\
    \ the mobile node), the\n   mobile node MUST use the same care-of address used\
    \ to create a\n   binding cache entry in the correspondent node (RCoA) as a source\n\
    \   address.  According to [RFC3775], the mobile node MUST also include a\n  \
    \ Home Address option in outgoing packets.  The Home Address option\n   MUST contain\
    \ the mobile node's home address.\n"
- title: 6.2.  MAP Operations
  contents:
  - "6.2.  MAP Operations\n   The MAP acts like an HA; it intercepts all packets addressed\
    \ to\n   registered mobile nodes and tunnels them to the corresponding LCoA,\n\
    \   which is stored in its binding cache.\n   A MAP has no knowledge of the mobile\
    \ node's home address.  The mobile\n   node will send a local BU to the MAP with\
    \ the M and A flags set.  The\n   aim of this BU is to bind the RCoA (contained\
    \ in the BU as a home\n   address) to the mobile node's LCoA.  If successful,\
    \ the MAP MUST\n   return a binding acknowledgement to the mobile node, indicating\
    \ a\n   successful registration.  This is identical to the HA operation in\n \
    \  [RFC3775].  No new error codes are introduced for HMIPv6.  The\n   binding\
    \ acknowledgement MUST include a routing header type 2 that\n   contains the mobile\
    \ node's RCoA.\n   The MAP MUST be able to accept packets tunnelled from the mobile\n\
    \   node, with the mobile node being the tunnel entry point and the MAP\n   being\
    \ the tunnel exit point.\n   The MAP employs [RFC4877] Section 9 procedures for\
    \ the allocation of\n   RCoA, and subsequently acts as an HA for the RCoA.  Packets\
    \ addressed\n   to the RCoA are intercepted by the MAP, using proxy Neighbour\n\
    \   Advertisement, and then encapsulated and routed to the mobile node's\n   LCoA.\
    \  This operation is identical to that of the HA described in\n   [RFC3775].\n\
    \   A MAP MAY be configured with the list of valid on-link prefixes that\n   mobile\
    \ nodes can use to derive LCoAs.  This is useful for network\n   operators that\
    \ need to stop mobile nodes from continuing to use the\n   MAP after moving to\
    \ a different administrative domain.  If a mobile\n   node sent a binding update\
    \ containing an LCoA that is not in the\n   MAP's \"valid on-link prefixes\" list,\
    \ the MAP could reject the binding\n   update using existing error code 129 (administratively\
    \ prohibited).\n"
- title: 6.3.  Home Agent Operations
  contents:
  - "6.3.  Home Agent Operations\n   The support of HMIPv6 is completely transparent\
    \ to the HA's\n   operation.  Packets addressed to a mobile node's home address\
    \ will be\n   forwarded by the HA to its RCoA, as described in [RFC3775].\n"
- title: 6.4.  Correspondent Node Operations
  contents:
  - "6.4.  Correspondent Node Operations\n   HMIPv6 is completely transparent to correspondent\
    \ nodes.\n"
- title: 6.5.  Local Mobility Management Optimisation within a MAP Domain
  contents:
  - "6.5.  Local Mobility Management Optimisation within a MAP Domain\n   In [RFC3775],\
    \ it is stated that for short-term communication,\n   particularly communication\
    \ that may easily be retried upon failure,\n   the mobile node MAY choose to directly\
    \ use one of its care-of\n   addresses as the source of the packet, thus not requiring\
    \ the use of\n   a Home Address option in the packet.  Such use of the CoA will\
    \ reduce\n   the overhead of sending each packet due to the absence of additional\n\
    \   options.  In addition, it will provide an optimal route between the\n   mobile\
    \ node and correspondent node.\n   HMIPv6-aware mobile nodes can use their RCoA\
    \ as the source address\n   without using a Home Address option.  In other words,\
    \ the RCoA can be\n   used as a source address for upper layers.  Using this feature,\
    \ the\n   mobile node will be seen by the correspondent node as a fixed node\n\
    \   while moving within a MAP domain.\n   This usage of the RCoA does not have\
    \ the cost of Mobile IPv6 (i.e.,\n   no bindings or Home Address options are sent\
    \ over the Internet), but\n   still provides local mobility management to the\
    \ mobile nodes with\n   near-optimal routing.  Although such use of RCoA does\
    \ not provide\n   global mobility (i.e., communication is broken when a mobile\
    \ node\n   changes its RCoA), it would be useful for several applications (e.g.,\n\
    \   web browsing).  The validity of the RCoA as a source address used by\n   applications\
    \ will depend on the size of a MAP domain and the speed of\n   the mobile node.\
    \  Furthermore, because the support for BU processing\n   in correspondent nodes\
    \ is not mandated in [RFC3775], this mechanism\n   can provide a way of obtaining\
    \ route optimisation without sending BUs\n   to the correspondent nodes.\n   Enabling\
    \ this mechanism can be done by presenting the RCoA as a\n   temporary home address\
    \ for the mobile node.  This may require an\n   implementation to augment its\
    \ source address selection algorithm with\n   the knowledge of the RCoA in order\
    \ to use it for the appropriate\n   applications.\n"
- title: 6.6.  Location Privacy
  contents:
  - "6.6.  Location Privacy\n   In HMIPv6, a mobile node hides its LCoA from its correspondent\
    \ nodes\n   and its home agent by using its RCoA in the source field of the\n\
    \   packets that it sends.  As a result, address-based location tracking\n   of\
    \ a mobile node by its correspondent nodes or its home agent is more\n   difficult\
    \ because they only know its RCoA and not its LCoA.\n"
- title: 7.  MAP Discovery
  contents:
  - "7.  MAP Discovery\n   This section describes how a mobile node obtains the MAP\
    \ address and\n   subnet prefix, and how ARs in a domain discover MAPs.\n   This\
    \ specification requires network administrators to manually\n   configure the\
    \ MAP option information in ARs; future mechanisms may be\n   defined to allow\
    \ MAPs to be discovered dynamically.\n"
- title: 7.1.  Mobile Node Operation
  contents:
  - "7.1.  Mobile Node Operation\n   When an HMIPv6-aware mobile node receives a Router\
    \ Advertisement, it\n   should search for the MAP option.  One or more options\
    \ may be found\n   for different MAP IP addresses.  A mobile node SHOULD register\
    \ with\n   the MAP having the highest preference value.  A MAP with a preference\n\
    \   value of zero SHOULD NOT be used for new local BUs (i.e., the mobile\n   node\
    \ can refresh existing bindings but cannot create new ones).\n   However, a mobile\
    \ node MAY choose to register with one MAP over\n   another, depending on the\
    \ value received in the distance field,\n   provided that the preference value\
    \ is above zero.\n   A MAP option containing a valid lifetime value of zero means\
    \ that\n   this MAP MUST NOT be selected by the MN.  A valid lifetime of zero\n\
    \   indicates a MAP failure.  When this option is received, a mobile node\n  \
    \ MUST choose another MAP and create new bindings.  Any existing\n   bindings\
    \ with this MAP can be assumed to be lost.  If no other MAP is\n   available,\
    \ the mobile node MUST NOT attempt to use HMIPv6.\n   If a multi-homed mobile\
    \ node has access to several ARs simultaneously\n   (on different interfaces),\
    \ it SHOULD use an LCoA on the link defined\n   by the AR that advertises its\
    \ current MAP.\n   A mobile node MUST store the received option(s) in order to\
    \ choose at\n   least one MAP to register with.  Storing the options is essential,\
    \ as\n   they will be compared to other options received later for the purpose\n\
    \   of the movement detection algorithm.\n   If the R flag is set, the mobile\
    \ node MUST place its RCoA in place of\n   the home address in the binding update\
    \ message.  This causes the RCoA\n   to be bound to the LCoA in the MAP's binding\
    \ cache.\n   A mobile node MAY choose to register with more than one MAP\n   simultaneously,\
    \ or use both the RCoA and its LCoA as care-of\n   addresses simultaneously with\
    \ different correspondent nodes.\n"
- title: 8.  Updating Previous MAPs
  contents:
  - "8.  Updating Previous MAPs\n   When a mobile node moves into a new MAP domain,\
    \ the mobile node may\n   send a BU to the previous MAP requesting it to forward\
    \ packets\n   addressed to the mobile node's new CoA.  An administrator MAY\n\
    \   restrict the MAP from forwarding packets to LCoAs outside the MAP's\n   domain.\
    \  However, it is RECOMMENDED that MAPs be allowed to forward\n   packets to LCoAs\
    \ associated with some of the ARs in neighbouring MAP\n   domains, provided that\
    \ they are located within the same\n   administrative domain.\n   For instance,\
    \ a MAP could be configured to forward packets to LCoAs\n   associated with ARs\
    \ that are geographically adjacent to ARs on the\n   boundary of its domain. \
    \ This will allow for a smooth inter-MAP\n   handover as it allows the mobile\
    \ node to continue to receive packets\n   while updating the new MAP, its HA and,\
    \ potentially, correspondent\n   nodes.\n"
- title: 9.  Note on MAP Selection by the Mobile Node
  contents:
  - "9.  Note on MAP Selection by the Mobile Node\n   HMIPv6 provides a flexible mechanism\
    \ for local mobility management\n   within a visited network.  As explained earlier,\
    \ a MAP can exist\n   anywhere in the operator's network (including the AR). \
    \ Several MAPs\n   can be located within the same domain independently of each\
    \ other.\n   In addition, overlapping MAP domains are also allowed and\n   recommended.\
    \  Both static and dynamic hierarchies are supported.\n   When the mobile node\
    \ receives a Router Advertisement including a MAP\n   option, it should perform\
    \ actions according to the following movement\n   detection mechanisms.  In a\
    \ hierarchical Mobile IP network, such as\n   the one described in this document,\
    \ the mobile node should be:\n   o  \"Eager\" to perform new bindings.\n   o \
    \ \"Lazy\" in releasing existing bindings.\n   The above means that the mobile\
    \ node should register with any \"new\"\n   MAP advertised by the AR (Eager).\
    \  The method by which the mobile\n   node determines whether the MAP is a \"\
    new\" MAP is described in\n   Section 9.1.  The mobile node should not release\
    \ existing bindings\n   until it no longer receives the MAP option (or receives\
    \ it with a\n   lifetime of zero) or the lifetime of its existing binding expires\n\
    \   (Lazy).  This Eager-Lazy approach, described above, will assist in\n   providing\
    \ a fallback mechanism in case of the failure of one of the\n   MAP routers, as\
    \ it will reduce the time it takes for a mobile node to\n   inform its correspondent\
    \ nodes and HA about its new care-of address.\n"
- title: 9.1.  MAP Selection in Distributed MAP Environment
  contents:
  - "9.1.  MAP Selection in Distributed MAP Environment\n   The mobile node needs\
    \ to consider several factors to optimally select\n   one or more MAPs, where\
    \ several MAPs are available in the same\n   domain.\n   There are no benefits\
    \ foreseen in selecting more than one MAP and\n   forcing packets to be sent from\
    \ the higher MAP down through a\n   hierarchy of MAPs.  This approach may add\
    \ forwarding delays and\n   eliminate the robustness of IP routing between the\
    \ highest MAP and\n   the mobile node; therefore, it is prohibited by this specification.\n\
    \   Allowing more than one MAP (\"above\" the AR) within a network should\n  \
    \ not imply that the mobile node forces packets to be routed down the\n   hierarchy\
    \ of MAPs.  However, placing more than one MAP \"above\" the AR\n   can be used\
    \ for redundancy and as an optimisation for the different\n   mobility scenarios\
    \ experienced by mobile nodes.  The MAPs are used\n   independently of each other\
    \ by the MN (e.g., each MAP is used for\n   communication to a certain set of\
    \ CNs).\n   In terms of the distance-based selection in a network with several\n\
    \   MAPs, a mobile node may choose to register with the furthest MAP to\n   avoid\
    \ frequent re-registrations.  This is particularly important for\n   fast mobile\
    \ nodes that will perform frequent handoffs.  In this\n   scenario, the choice\
    \ of a more distant MAP would reduce the\n   probability of having to change a\
    \ MAP and informing all correspondent\n   nodes and the HA.\n   In a scenario\
    \ where several MAPs are discovered by the mobile node in\n   one domain, the\
    \ mobile node may need sophisticated algorithms to be\n   able to select the appropriate\
    \ MAP.  These algorithms would have the\n   mobile node speed as an input (for\
    \ distance-based selection) combined\n   with the preference field in the MAP\
    \ option.  However, this\n   specification proposes that the mobile node use the\
    \ following\n   algorithm as a default, where other optimised algorithms are not\n\
    \   available.  The following algorithm is simply based on selecting the\n   MAP\
    \ that is most distant, provided that its preference value did not\n   reach a\
    \ value of zero.  The mobile node operation is shown below:\n   1.  Receive and\
    \ parse all MAP options.\n   2.  Arrange MAPs in a descending order, starting\
    \ with the furthest\n       MAP (i.e., MAP option having largest Dist field).\n\
    \   3.  Select first MAP in list.\n   4.  If either the preference value or the\
    \ valid lifetime fields are\n       set to zero, select the following MAP in the\
    \ list.\n   5.  Repeat step (4) while new MAP options still exist, until a MAP\
    \ is\n       found with a non-zero preference value and a non-zero valid\n   \
    \    lifetime.\n   Implementing the steps above would result in mobile nodes selecting,\n\
    \   by default, the most distant or furthest available MAP.  This will\n   continue\
    \ until the preference value reduces to zero.  Following this,\n   mobile nodes\
    \ will start selecting another MAP.\n"
- title: 9.2.  MAP Selection in a Flat Mobility Architecture
  contents:
  - "9.2.  MAP Selection in a Flat Mobility Architecture\n   Network operators may\
    \ choose a flat architecture in some cases where\n   a Mobile IPv6 handover may\
    \ be considered a rare event.  In these\n   scenarios, operators may choose to\
    \ include the MAP function in ARs\n   only.  The inclusion of the MAP function\
    \ in ARs can still be useful\n   to reduce the time required to update all correspondent\
    \ nodes and the\n   HA.  In this scenario, a mobile node may choose a MAP (in\
    \ the AR) as\n   an anchor point when performing a handoff.  This kind of dynamic\n\
    \   hierarchy (or anchoring) is only recommended for cases where inter-AR\n  \
    \ movement is not frequent.\n"
- title: 10.  Detection and Recovery from MAP Failures
  contents:
  - "10.  Detection and Recovery from MAP Failures\n   This specification introduces\
    \ a MAP that can be seen as a local home\n   agent in a visited network.  A MAP,\
    \ like a home agent, is a single\n   point of failure.  If a MAP fails, its binding\
    \ cache content will be\n   lost, resulting in loss of communication between mobile\
    \ and\n   correspondent nodes.  This situation may be avoided by using more\n\
    \   than one MAP on the same link and by utilising a form of context\n   transfer\
    \ protocol between them.  However, MAP redundancy is outside\n   the scope of\
    \ this document.\n   In cases where such protocols are not supported, the mobile\
    \ node\n   would need to detect MAP failures.  The mobile node can detect this\n\
    \   situation when it receives a Router Advertisement containing a MAP\n   option\
    \ with a lifetime of zero.  The mobile node should then start\n   the MAP Discovery\
    \ process and attempt to register with another MAP.\n   After it has selected\
    \ and registered with another MAP, it will also\n   need to inform correspondent\
    \ nodes and the home agent if its RCoA has\n   changed.  Note that in the presence\
    \ of a protocol that transfers\n   binding cache entries between MAPs for redundancy\
    \ purposes, a new MAP\n   may be able to provide the same RCoA to the mobile node\
    \ (e.g., if\n   both MAPs advertise the same prefix in the MAP option).  This\
    \ would\n   save the mobile node from updating correspondent nodes and the home\n\
    \   agent.\n   Access Routers can be triggered to advertise a MAP option with\
    \ a\n   lifetime of zero (indicating MAP failure) in different ways:\n   o  By\
    \ manual intervention.\n   o  In a dynamic manner.\n   One way of performing dynamic\
    \ detection of MAP failure can be done by\n   probing the MAP regularly (e.g.,\
    \ every 10 seconds).  If no response\n   is received, an AR MAY try to aggressively\
    \ probe the MAP for a short\n   period of time (e.g., once every 5 seconds for\
    \ 15 seconds); if no\n   reply is received, a MAP option may be sent with a valid\
    \ lifetime\n   value of zero.  The exact mechanisms for probing MAPs is outside\
    \ the\n   scope of this document.  The above text simply shows one example of\n\
    \   detecting failures.\n   This specification does not mandate a particular recovery\
    \ mechanism.\n   However, any mechanism between the MAP and an AR SHOULD be secure\
    \ to\n   allow for message authentication, integrity protection, and\n   protection\
    \ against replay attacks.\n   Note that the above suggestion for detecting MAP\
    \ failure may not\n   detect MAP failures that might take place between probes,\
    \ i.e.,if a\n   MAP reboots between probes.\n"
- title: 11.  Tunelling Impacts on MTU
  contents:
  - "11.  Tunelling Impacts on MTU\n   This specification requires the mobile node\
    \ to tunnel outgoing\n   traffic to the MAP.  Similarly, the MAP tunnels inbound\
    \ packets to\n   the mobile node.  If the mobile node has a home agent elsewhere\
    \ on\n   the Internet, this will result in double encapsulations of inbound\n\
    \   and outbound packets.  This may have impacts on the mobile node's\n   path\
    \ MTU.  Hence, mobile nodes MUST consider the encapsulation of\n   traffic between\
    \ the node and the MAP when calculating the available\n   MTU for upper layers.\n"
- title: 12.  Security Considerations
  contents:
  - "12.  Security Considerations\n   This specification introduces a new concept\
    \ to Mobile IPv6, namely, a\n   Mobility Anchor Point that acts as a local home\
    \ agent.  It is crucial\n   that the security relationship between the mobile\
    \ node and the MAP is\n   strong; it MUST involve mutual authentication, integrity\
    \ protection,\n   and protection against replay attacks.  Confidentiality may\
    \ be needed\n   for payload traffic, such as when the mobile node is unwilling\
    \ to\n   reveal any traffic to the access network beyond what is needed for\n\
    \   the mobile node to attach to the network and communicate with a MAP.\n   Confidentiality\
    \ is not required for binding updates to the MAP.  The\n   absence of any of these\
    \ protections may lead to malicious mobile\n   nodes impersonating other legitimate\
    \ ones or impersonating a MAP.\n   Any of these attacks will undoubtedly cause\
    \ undesirable impacts to\n   the mobile node's communication with all correspondent\
    \ nodes having\n   knowledge of the mobile node's RCoA.\n   Three different relationships\
    \ (related to securing binding updates)\n   need to be considered:\n   1.  The\
    \ mobile node - MAP\n   2.  The mobile node - correspondent node\n   3.  The mobile\
    \ node - home agent\n"
- title: 12.1.  Mobile Node - MAP Security
  contents:
  - "12.1.  Mobile Node - MAP Security\n   In order to allow a mobile node to use\
    \ the MAP's forwarding service,\n   initial authorisation (specifically for the\
    \ service, not for the\n   RCoA) MAY be needed.  Authorising a mobile node to\
    \ use the MAP\n   service can be done based on the identity of the mobile node\n\
    \   exchanged during the security association (SA) negotiation process.\n   The\
    \ authorisation may be granted based on the mobile node's identity\n   or based\
    \ on the identity of a Certificate Authority (CA) that the MAP\n   trusts.  For\
    \ instance, if the mobile node presents a certificate\n   signed by a trusted\
    \ entity (e.g., a CA that belongs to the same\n   administrative domain, or another\
    \ trusted roaming partner), it would\n   be sufficient for the MAP to authorise\
    \ the use of its service.  Note\n   that this level of authorisation is independent\
    \ of authorising the\n   use of a particular RCoA.  Similarly, the mobile node\
    \ trusts the MAP\n   if it presents a certificate signed by the same CA or by\
    \ another CA\n   that the mobile node is configured to trust (e.g., a roaming\n\
    \   partner).  It is likely that some deployments would be satisfied with\n  \
    \ the use of self-signed certificates for either the mobile node or the\n   MAP\
    \ or both.  This guarantees that the mobile node and the MAP are\n   authenticated\
    \ for address allocation and future binding updates\n   without the need for identity\
    \ authentication.  Hence, the use of\n   trusted third-party certificates is not\
    \ required by this\n   specification.\n   It is important to note that in this\
    \ specification, authentication\n   and authorisation are effectively the same\
    \ thing.  All the MAP needs\n   in order to allocate the mobile node an RCoA is\
    \ to authenticate the\n   mobile node and verify that it belongs to a trusted\
    \ group (based on\n   its certificate).\n   IKEv2 MUST be supported by the mobile\
    \ node and the MAP.  IKEv2 allows\n   the use of Extensible Authentication Protocol\
    \ (EAP) as a mechanism to\n   bootstrap the security association between the communicating\
    \ peers.\n   Hence, EAP can be used with IKEv2 to leverage the Authentication,\n\
    \   Authorization, and Accounting (AAA) infrastructure to bootstrap the\n   SA\
    \ between the mobile node and the MAP.  Such a mechanism is useful\n   in scenarios\
    \ where an administrator wishes to avoid the configuration\n   and management\
    \ of certificates on mobile nodes.  A MAP MAY support\n   the use of EAP over\
    \ IKEv2.\n   If EAP is used with IKEv2, the EAP method runs between the mobile\n\
    \   node and a AAA server.  Following a successful authentication, the\n   resulting\
    \ keying material can be used to bootstrap IKEv2 between the\n   MAP and the mobile\
    \ node.  The specification of which EAP methods\n   should be used or how keys\
    \ are transported between the MAP and the\n   AAA server is outside the scope\
    \ of this document.\n   HMIPv6 uses an additional registration between the mobile\
    \ node and\n   its current MAP.  As explained in this document, when a mobile\
    \ node\n   moves into a new domain (i.e., served by a new MAP), it obtains an\n\
    \   RCoA and an LCoA and registers the binding between these two\n   addresses\
    \ with the new MAP.  The MAP then verifies the BU and creates\n   a binding cache\
    \ entry with the RCoA and LCoA.  Whenever the mobile\n   node gets a new LCoA,\
    \ it needs to send a new BU that specifies the\n   binding between its RCoA and\
    \ its new LCoA.  This BU needs to be\n   authenticated; otherwise, any host could\
    \ send a BU for the mobile\n   node's RCoA and hijack the mobile node's packets.\n\
    \   The MAP does not need to have prior knowledge of the identity of the\n   mobile\
    \ node or its home address.  As a result, the SA between the\n   mobile node and\
    \ the MAP can be established using any key\n   establishment protocols such as\
    \ IKEv2.  A return routability test is\n   not necessary.\n   The MAP needs to\
    \ set the SA for the RCoA (not the LCoA).  This can be\n   performed with IKEv2\
    \ [RFC4306].  The mobile node uses its LCoA as the\n   source address, but specifies\
    \ that the RCoA should be used in the SA.\n   This is achieved by using the RCoA\
    \ as the identity in the IKE\n   CHILD_SA negotiation.  This step is identical\
    \ to the use of the home\n   address in IKE CHILD_SA when negotiating with the\
    \ home agent.\n   The IPsec Peer Authorization Database (PAD) entries and configuration\n\
    \   payloads described in [RFC4877] for allocating dynamic home addresses\n  \
    \ SHOULD be used by the MAP to allocate the RCoA for mobile nodes.\n   Binding\
    \ updates between the MAP and the mobile node MUST be protected\n   with either\
    \ Authentication Header (AH) or Encapsulating Security\n   Payload (ESP) in transport\
    \ mode.  When ESP is used, a non-null\n   authentication algorithm MUST be used.\n\
    \   The Security Policy Database (SPD) entries in both the home agent and\n  \
    \ the mobile node are identical to those set up for the home agent and\n   mobile\
    \ node, respectively, as outlined in [RFC4877].\n"
- title: 12.2.  Mobile Node - Correspondent Node Security
  contents:
  - "12.2.  Mobile Node - Correspondent Node Security\n   Mobile IPv6 [RFC3775] defines\
    \ a return routability procedure that\n   allows mobile and correspondent nodes\
    \ to authenticate binding updates\n   and acknowledgements.  This specification\
    \ does not impact the return\n   routability test defined in [RFC3775].  However,\
    \ it is important to\n   note that mobile node implementers need to be careful\
    \ when selecting\n   the source address of the HoTI and CoTI messages, defined\
    \ in\n   [RFC3775].  The source address used in HoTI messages SHOULD be the\n\
    \   mobile node's home address unless the mobile node wishes to use the\n   RCoA\
    \ for route optimisation.  The packet containing the HoTI message\n   is encapsulated\
    \ twice.  The inner encapsulating header contains the\n   RCoA in the source address\
    \ field and the home agent's address in the\n   destination address field.  The\
    \ outer encapsulating header contains\n   the mobile node's LCoA in the source\
    \ address field and the MAP's\n   address in the destination field.\n"
- title: 12.3.  Mobile Node - Home Agent Security
  contents:
  - "12.3.  Mobile Node - Home Agent Security\n   The security relationship between\
    \ the mobile node and its home agent,\n   as discussed in [RFC3775], is not impacted\
    \ by this specification.\n   The relationship between the MAP and the mobile node\
    \ is not impacted\n   by the presence of a home agent.\n"
- title: 13.  IANA Considerations
  contents:
  - "13.  IANA Considerations\n   Both the MAP option and M flag were allocated for\
    \ RFC 4140 and will\n   continue to be used by this specification.\n"
- title: 14.  Acknowledgements
  contents:
  - "14.  Acknowledgements\n   The authors would like to thank Conny Larsson (Ericsson)\
    \ and Mattias\n   Pettersson (Ericsson) for their valuable input to this document.\
    \  The\n   authors would also like to thank the members of the French RNRT\n \
    \  MobiSecV6 project (BULL, France Telecom, and INRIA) for testing the\n   first\
    \ implementation and for their valuable feedback.  The INRIA\n   HMIPv6 project\
    \ is partially funded by the French government.\n   In addition, the authors would\
    \ like to thank the following members of\n   the working group, in alphabetical\
    \ order: Samita Chakrabarti (Sun),\n   Gregory Daley, Gopal Dommety (Cisco), Francis\
    \ Dupont (GET/Enst\n   Bretagne), Eva Gustaffson (Ericsson), Dave Johnson (Rice\
    \ University),\n   Annika Jonsson (Ericsson), James Kempf (Docomo labs), Martti\n\
    \   Kuparinen (Ericsson), Fergal Ladley, Gabriel Montenegro (Microsoft),\n   Nick\
    \ \"Sharkey\" Moore, Vidya Narayanan (Qualcomm), Erik Nordmark\n   (Sun), Basavaraj\
    \ Patil (Nokia), Brett Pentland (NEC), Thomas Schmidt,\n   and Alper Yegin (Samsung)\
    \ for their comments on the document.\n"
- title: 15.  References
  contents:
  - '15.  References

    '
- title: 15.1.  Normative References
  contents:
  - "15.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC3775]  Johnson, D., Perkins, C., and J. Arkko, \"Mobility Support\n\
    \              in IPv6\", RFC 3775, June 2004.\n   [RFC4306]  Kaufman, C., Ed.,\
    \ \"Internet Key Exchange (IKEv2)\n              Protocol\", RFC 4306, December\
    \ 2005.\n   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,\n\
    \              \"Neighbor Discovery for IP version 6 (IPv6)\", RFC 4861,\n   \
    \           September 2007.\n   [RFC4877]  Devarapalli, V. and F. Dupont, \"Mobile\
    \ IPv6 Operation with\n              IKEv2 and the Revised IPsec Architecture\"\
    , RFC 4877, April\n              2007.\n"
- title: 15.2.  Informative References
  contents:
  - "15.2.  Informative References\n   [RFC4449]  Perkins, C., \"Securing Mobile IPv6\
    \ Route Optimization\n              Using a Static Shared Key\", RFC 4449, June\
    \ 2006.\n   [RFC4651]  Vogt, C. and J. Arkko, \"A Taxonomy and Analysis of\n \
    \             Enhancements to Mobile IPv6 Route Optimization\", RFC 4651,\n  \
    \            February 2007.\n   [RFC4866]  Arkko, J., Vogt, C., and W. Haddad,\
    \ \"Enhanced Route\n              Optimization for Mobile IPv6\", RFC 4866, May\
    \ 2007.\n"
- title: Appendix A.  Changes from RFC 4140
  contents:
  - "Appendix A.  Changes from RFC 4140\n   o  Dynamic MAP Discovery was removed.\n\
    \   o  Updated the security section to use IKEv2 instead of IKEv1.\n   o  The\
    \ document clarified that HMIPv6 can be used without the need\n      for a home\
    \ agent.\n   o  Several editorials throughout the document.\n   o  IKEv2 only\
    \ is now used to allocate the RCoA.\n   RFC 4140 was implemented and interop tested\
    \ by at least two different\n   organisations.  A test suite including test cases\
    \ for RFC 4140 was\n   also developed by Ericsson and run against both implementations.\
    \  No\n   major issues were found.  The scalability of Dynamic MAP Discovery,\n\
    \   defined in RFC 4140, was seen as inappropriate for large-scale\n   deployments\
    \ and prone to loops.  It was removed from this\n   specification.\n   At this\
    \ time, there is no publicly known deployment of this\n   specification.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Hesham Soliman\n   Elevate Technologies\n   EMail: hesham@elevatemobile.com\n\
    \   Claude Castelluccia\n   INRIA\n   Phone: +33 4 76 61 52 15\n   EMail: claude.castelluccia@inria.fr\n\
    \   Karim ElMalki\n   Athonet\n   EMail: karim@elmalki.homeip.net\n   Ludovic\
    \ Bellier\n   INRIA\n   EMail: ludovic.bellier@inria.fr\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2008).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
