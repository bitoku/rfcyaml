- title: __initial_text__
  contents:
  - '              Softwire Security Analysis and Requirements

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes security guidelines for the softwire \"\
    Hubs\n   and Spokes\" and \"Mesh\" solutions.  Together with discussion of the\n\
    \   softwire deployment scenarios, the vulnerability to security attacks\n   is\
    \ analyzed to provide security protection mechanisms such as\n   authentication,\
    \ integrity, and confidentiality to the softwire\n   control and data packets.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n   2.  Terminology  . . . . . . . . . . . . . . . . . . . .\
    \ . . . . .  4\n     2.1.  Abbreviations  . . . . . . . . . . . . . . . . . .\
    \ . . . .  4\n     2.2.  Requirements Language  . . . . . . . . . . . . . . .\
    \ . . .  5\n   3.  Hubs and Spokes Security Guidelines  . . . . . . . . . . .\
    \ . .  5\n     3.1.  Deployment Scenarios . . . . . . . . . . . . . . . . . .\
    \ .  5\n     3.2.  Trust Relationship . . . . . . . . . . . . . . . . . . . .\
    \  7\n     3.3.  Softwire Security Threat Scenarios . . . . . . . . . . . .  8\n\
    \     3.4.  Softwire Security Guidelines . . . . . . . . . . . . . . . 11\n  \
    \     3.4.1.  Authentication . . . . . . . . . . . . . . . . . . . . 12\n    \
    \   3.4.2.  Softwire Security Protocol . . . . . . . . . . . . . . 13\n     3.5.\
    \  Guidelines for Usage of IPsec in Softwire  . . . . . . . . 13\n       3.5.1.\
    \  Authentication Issues  . . . . . . . . . . . . . . . . 14\n       3.5.2.  IPsec\
    \ Pre-Shared Keys for Authentication . . . . . . . 15\n       3.5.3.  Inter-Operability\
    \ Guidelines . . . . . . . . . . . . . 15\n       3.5.4.  IPsec Filtering Details\
    \  . . . . . . . . . . . . . . . 16\n   4.  Mesh Security Guidelines . . . . .\
    \ . . . . . . . . . . . . . . 19\n     4.1.  Deployment Scenario  . . . . . .\
    \ . . . . . . . . . . . . . 19\n     4.2.  Trust Relationship . . . . . . . .\
    \ . . . . . . . . . . . . 20\n     4.3.  Softwire Security Threat Scenarios .\
    \ . . . . . . . . . . . 20\n     4.4.  Applicability of Security Protection Mechanism\
    \ . . . . . . 21\n       4.4.1.  Security Protection Mechanism for Control Plane\
    \  . . . 21\n       4.4.2.  Security Protection Mechanism for Data Plane . . .\
    \ . . 22\n   5.  Security Considerations  . . . . . . . . . . . . . . . . . .\
    \ . 23\n   6.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . .\
    \ 23\n   7.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n\
    \     7.1.  Normative References . . . . . . . . . . . . . . . . . . . 23\n  \
    \   7.2.  Informative References . . . . . . . . . . . . . . . . . . 24\n   Appendix\
    \ A.  Examples  . . . . . . . . . . . . . . . . . . . . . . 26\n     A.1.  IPv6-over-IPv4\
    \ Softwire with L2TPv2 Example for IKE  . . . 26\n     A.2.  IPv4-over-IPv6 Softwire\
    \ with Example for IKE . . . . . . . 26\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The Softwire Working Group specifies the standardization\
    \ of\n   discovery, control, and encapsulation methods for connecting IPv4\n \
    \  networks across IPv6 networks and IPv6 networks across IPv4 networks.\n   The\
    \ softwire provides connectivity to enable the global reachability\n   of both\
    \ address families by reusing or extending existing technology.\n   The Softwire\
    \ Working Group is focusing on the two scenarios that\n   emerged when discussing\
    \ the traversal of networks composed of\n   differing address families.  This\
    \ document provides the security\n   guidelines for two such softwire solution\
    \ spaces: the \"Hubs and\n   Spokes\" and \"Mesh\" scenarios.  The \"Hubs and\
    \ Spokes\" and \"Mesh\"\n   problems are described in [RFC4925] Sections 2 and\
    \ 3, respectively.\n   The protocols selected for softwire connectivity require\
    \ security\n   considerations on more specific deployment scenarios for each\n\
    \   solution.  The scope of this document provides analysis on the\n   security\
    \ vulnerabilities for the deployment scenarios and specifies\n   the proper usage\
    \ of the security mechanisms that are applied to the\n   softwire deployment.\n\
    \   The Layer Two Tunneling Protocol (L2TPv2) is selected as the phase 1\n   protocol\
    \ to be deployed in the \"Hubs and Spokes\" solution space.  If\n   L2TPv2 is\
    \ used in the unprotected network, it will be vulnerable to\n   various security\
    \ attacks and MUST be protected by an appropriate\n   security protocol, such\
    \ as IPsec as described in [RFC3193].  The new\n   implementation SHOULD use IKEv2\
    \ (Internet Key Exchange Protocol\n   version 2) as the key management protocol\
    \ for IPsec because it is a\n   more reliable protocol than IKEv1 and integrates\
    \ the required\n   protocols into a single platform.  This document provides\n\
    \   implementation guidance and specifies the proper usage of IPsec as\n   the\
    \ security protection mechanism by considering the security\n   vulnerabilities\
    \ in the \"Hubs and Spokes\" scenario.  The document also\n   addresses cases\
    \ where the security protocol is not necessarily\n   mandated.\n   The softwire\
    \ \"Mesh\" solution MUST support various levels of security\n   mechanisms to\
    \ protect the data packets being transmitted on a\n   softwire tunnel from the\
    \ access networks with one address family\n   across the transit core operating\
    \ with a different address family\n   [RFC4925].  The security mechanism for the\
    \ control plane is also\n   required to be protected from control-data modification,\
    \ spoofing\n   attacks, etc.  In the \"Mesh\" solution, BGP is used for distributing\n\
    \   softwire routing information in the transit core; meanwhile, security\n  \
    \ issues for BGP are being discussed in other working groups.  This\n   document\
    \ provides the proper usage of security mechanisms for\n   softwire mesh deployment\
    \ scenarios.\n"
- title: 2.  Terminology
  contents:
  - '2.  Terminology

    '
- title: 2.1.  Abbreviations
  contents:
  - "2.1.  Abbreviations\n   The terminology is based on the \"Softwire Problem Statement\"\
    \n   [RFC4925].\n   AF(i) - Address Family.  IPv4 or IPv6.  Notation used to indicate\n\
    \   that prefixes, a node, or network only deal with a single IP AF.\n   AF(i,j)\
    \ - Notation used to indicate that a node is dual-stack or that\n   a network\
    \ is composed of dual-stack nodes.\n   Address Family Border Router (AFBR) - A\
    \ dual-stack router that\n   interconnects two networks that use either the same\
    \ or different\n   address families.  An AFBR forms peering relationships with\
    \ other\n   AFBRs, adjacent core routers, and attached Customer Edge (CE)\n  \
    \ routers; performs softwire discovery and signaling; advertises client\n   ASF(i)\
    \ reachability information; and encapsulates/decapsulates\n   customer packets\
    \ in softwire transport headers.\n   Customer Edge (CE) - A router located inside\
    \ an AF access island that\n   peers with other CE routers within the access island\
    \ network and with\n   one or more upstream AFBRs.\n   Customer Premise Equipment\
    \ (CPE) - An equipment, host or router,\n   located at a subscriber's premises\
    \ and connected with a carrier's\n   access network.\n   Provider Edge (PE) -\
    \ A router located at the edge of a transit core\n   network that interfaces with\
    \ the CE in an access island.\n   Softwire Concentrator (SC) - The node terminating\
    \ the softwire in the\n   service provider network.\n   Softwire Initiator (SI)\
    \ - The node initiating the softwire within the\n   customer network.\n   Softwire\
    \ Encapsulation Set (SW-Encap) - A softwire encapsulation set\n   contains tunnel\
    \ header parameters, order of preference of the tunnel\n   header types, and the\
    \ expected payload types (e.g., IPv4) carried\n   inside the softwire.\n   Softwire\
    \ Next_Hop (SW-NHOP) - This attribute accompanies client AF\n   reachability advertisements\
    \ and is used to reference a softwire on\n   the ingress AFBR leading to the specific\
    \ prefixes.  It contains a\n   softwire identifier value and a softwire next_hop\
    \ IP address denoted\n   as <SW ID:SW-NHOP address>.  Its existence in the presence\
    \ of client\n   AF prefixes (in advertisements or entries in a routing table)\
    \ infers\n   the use of softwire to reach that prefix.\n"
- title: 2.2.  Requirements Language
  contents:
  - "2.2.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 3.  Hubs and Spokes Security Guidelines
  contents:
  - '3.  Hubs and Spokes Security Guidelines

    '
- title: 3.1.  Deployment Scenarios
  contents:
  - "3.1.  Deployment Scenarios\n   To provide the security guidelines, discussion\
    \ of the possible\n   deployment scenario and the trust relationship in the network\
    \ is\n   important.\n   The softwire initiator (SI) always resides in the customer\
    \ network.\n   The node in which the SI resides can be the CPE access device,\n\
    \   another dedicated CPE router behind the original CPE access device,\n   or\
    \ any kind of host device, such as a PC, appliance, sensor, etc.\n   However,\
    \ the host device may not always have direct access to its\n   home carrier network,\
    \ to which the user has subscribed.  For example,\n   the SI in the laptop PC\
    \ can access various access networks such as\n   Wi-Fi hot-spots, visited office\
    \ networks, etc.  This is the nomadic\n   case, which the softwire SHOULD support.\n\
    \   As the softwire deployment model, the following three cases as shown\n   in\
    \ Figure 1 should be considered.  Cases 2 and 3 are typical for a\n   nomadic\
    \ node, but are also applicable to a stationary node.  In order\n   to securely\
    \ connect a legitimate SI and SC to each other, the\n   authentication process\
    \ between SI and SC is normally performed using\n   Authentication, Authorization,\
    \ and Accounting (AAA) servers.\n            visited network            visited\
    \ network\n            access provider            service provider\n         \
    \          +---------------------------------+\n                   |         \
    \                        |\n            +......v......+    +.....................|......+\n\
    \            .             .    .                     v      .\n   +------+  .\
    \  (case 3)   .    .  +------+      +--------+  .\n   |      |=====================.==|\
    \      |      |        |  .\n   |  SI  |__.________     .    .  |  SC  |<---->|\
    \  AAAv  |  .\n   |      |---------- \\    .    .  |      |      |        |  .\n\
    \   +------+  .        \\\\   .    .  +------+      +--------+  .\n          \
    \  .         \\\\  .    .                     ^      .\n     ^      +..........\\\
    \\.+    +.....................|......+\n     |                  \\\\         \
    \                  |\n     |          (case 2) \\\\                          |\n\
    \     |                    \\\\                         |\n     |            \
    \         \\\\                        |\n     |      +............+  \\\\ +.....................|......+\n\
    \            .            .   \\\\.                     v      .\n   +------+\
    \  .            .    \\\\__+------+      +--------+  .\n   |      |  . (case 1)\
    \   .     ---|      |      |        |  .\n   |  SI  |=====================.==|\
    \  SC  |<---->|  AAAh  |  .\n   |      |  .            .     .  |      |     \
    \ |        |  .\n   +------+  .            .     .  +------+      +--------+ \
    \ .\n            .            .     .                            .\n         \
    \   +............+     +............................+\n             home network\
    \                home network\n            access provider            service\
    \ provider\n            Figure 1: Authentication Model for Hubs and Spokes\n \
    \  The AAA server shown in Figure 1 interacts with the SC, which acts as\n   a\
    \ AAA client.  The AAA may consists of multiple AAA servers, and the\n   proxy\
    \ AAA may be intermediate between the SC and the AAA servers.\n   This document\
    \ refers to the AAA server in the home network service\n   provider as the home\
    \ AAA server (AAAh) and to that in the visited\n   network service provider as\
    \ the visited AAA server (AAAv).\n   The \"Softwire Problem Statement\" [RFC4925]\
    \ states that the softwire\n   solution must be able to be integrated with commonly\
    \ deployed AAA\n   solutions.  L2TPv2 used in softwire supports PPP and L2TP\n\
    \   authentications that can be integrated with common AAA servers.\n   When the\
    \ softwire is used in an unprotected network, a stronger\n   authentication process\
    \ is required (e.g., IKEv2).  The proper\n   selection of the authentication processes\
    \ is discussed in Section 3.4\n   with respect to the various security threats.\n\
    \   Case 1: The SI connects to the SC that belongs to the home network\n   service\
    \ provider via the home access provider network that operates a\n   different\
    \ address family.  It is assumed that the home access\n   provider network and\
    \ the home network service provider for the SC are\n   under the same administrative\
    \ system.\n   Note that the IP address of the host device, in which the SI resides,\n\
    \   is static or dynamic depending on the subscribed service.  The\n   discovery\
    \ of the SC may be automatic.  But in this document, the\n   information on the\
    \ SC, e.g., the DNS name or IP address, is assumed\n   to be configured by the\
    \ user or the provider of the SI in advance.\n   Case 2: The SI connects to the\
    \ SC that belongs to the home network\n   service provider via the visited access\
    \ network.  For the nomadic\n   case, the SI/user does not subscribe to the visited\
    \ access provider.\n   For network access through the public network, such as\
    \ Wi-Fi hot-\n   spots, the home network service provider does not have a trust\n\
    \   relationship with the access network.\n   Note that the IP address of the\
    \ host device, in which the SI resides,\n   may be changed periodically due to\
    \ the home network service\n   provider's policy.\n   Case 3: The SI connects\
    \ to the SC that belongs to the visited network\n   service provider via the visited\
    \ access network.  This is typical of\n   the nomadic access case.  When the SI\
    \ is mobile, it may roam from the\n   home ISP providing the home access network\
    \ to the visited access\n   network, e.g., Wi-Fi hot-spot network provided by\
    \ the different ISP.\n   The SI does not connect to the SC in the home network,\
    \ for example,\n   due to geographical reasons.  The SI/user does not subscribe\
    \ to the\n   visited network service provider, but the visited network service\n\
    \   provider has some roaming agreement with the home network service\n   provider.\n\
    \   Note that the IP address of the host, in which the SI resides, is\n   provided\
    \ with the visited network service provider's policy.\n"
- title: 3.2.  Trust Relationship
  contents:
  - "3.2.  Trust Relationship\n   The establishment of a trust relationship between\
    \ the SI and SC is\n   different for three cases.  The security considerations\
    \ must be taken\n   into account for each case.\n   In Case 1, the SC and the\
    \ home AAA server in the same network service\n   provider MUST have a trust relationship\
    \ and communications between\n   them MUST be secured.  When the SC authenticates\
    \ the SI, the SC\n   transmits the authentication request message to the home\
    \ AAA server\n   and obtains the accept message together with the Attribute Value\
    \ Pair\n   for the SI authentication.  Since the SI is in the service provider\n\
    \   network, the provider can take measures to protect the entities\n   (e.g.,\
    \ SC, AAA servers) against a number of security threats,\n   including the communication\
    \ between them.\n   In Case 2, when the SI is mobile, access to the home network\
    \ service\n   provider through the visited access network provider is allowed.\
    \  The\n   trust relationship between the SI and the SC in the home network MUST\n\
    \   be established.  When the visited access network is a public network,\n  \
    \ various security attacks must be considered.  Especially for SI to\n   connect\
    \ to the legitimate SC, the authentication from SI to SC MUST\n   be performed\
    \ together with that from SC to SI.\n   In Case 3, if the SI roams into a different\
    \ network service\n   provider's administrative domain, the visited AAA server\
    \ communicates\n   with the home AAA server to obtain the information for SI\n\
    \   authentication.  The visited AAA server MUST have a trust\n   relationship\
    \ with the home AAA server and the communication between\n   them MUST be secured\
    \ in order to properly perform the roaming\n   services that have been agreed\
    \ upon under specified conditions.\n   Note that the path for the communications\
    \ between the home AAA server\n   and the visited AAA server may consist of several\
    \ AAA proxies.  In\n   this case, the AAA proxy threat model SHOULD be considered\
    \ [RFC2607].\n   A malicious AAA proxy may launch passive or active security attacks.\n\
    \   The trustworthiness of proxies in AAA proxy chains will weaken when\n   the\
    \ hop counts of the proxy chain is longer.  For example, the\n   accounting information\
    \ exchanged among AAA proxies is attractive for\n   an adversary.  The communication\
    \ between a home AAA server and a\n   visited AAA server MUST be protected.\n"
- title: 3.3.  Softwire Security Threat Scenarios
  contents:
  - "3.3.  Softwire Security Threat Scenarios\n   Softwire can be used to connect\
    \ IPv6 networks across public IPv4\n   networks and IPv4 networks across public\
    \ IPv6 networks.  The control\n   and data packets used during the softwire session\
    \ are vulnerable to\n   the security attacks.\n   A complete threat analysis of\
    \ softwire requires examination of the\n   protocols used for the softwire setup,\
    \ the encapsulation method used\n   to transport the payload, and other protocols\
    \ used for configuration\n   (e.g., router advertisements, DHCP).\n   The softwire\
    \ solution uses a subset of the Layer Two Tunneling\n   Protocol (L2TPv2) functionality\
    \ ([RFC2661], [RFC5571]).  In the\n   softwire \"Hubs and Spokes\" model, L2TPv2\
    \ is used in a voluntary\n   tunnel model only.  The SI acts as an L2TP Access\
    \ Concentrator (LAC)\n   and PPP endpoint.  The L2TPv2 tunnel is always initiated\
    \ from the SI.\n   The generic threat analysis done for L2TP using IPsec [RFC3193]\
    \ is\n   applicable to softwire \"Hubs and Spokes\" deployment.  The threat\n\
    \   analysis for other protocols such as MIPv6 (Mobile IPv6) [RFC4225],\n   PANA\
    \ (Protocol for Carrying Authentication for Network Access)\n   [RFC4016], NSIS\
    \ (Next Steps in Signaling) [RFC4081], and Routing\n   Protocols [RFC4593] are\
    \ applicable here as well and should be used as\n   references.\n   First, the\
    \ SI that resides in the customer network sends a Start-\n   Control-Connection-Request\
    \ (SCCRQ) packet to the SC for the\n   initiation of the softwire.  L2TPv2 offers\
    \ an optional tunnel\n   authentication system (which is similar to CHAP -- the\
    \ Challenge\n   Handshake Authentication Protocol) during control connection\n\
    \   establishment.  This requires a shared secret between the SI and SC\n   and\
    \ no key management is offered for this L2TPv2.\n   When the L2TPv2 control connection\
    \ is established, the SI and SC\n   optionally enter the authentication phase\
    \ after completing PPP Link\n   Control Protocol (LCP) negotiation.  PPP authentication\
    \ supports one-\n   way or two-way CHAP authentication, and can leverage existing\
    \ AAA\n   infrastructure.  PPP authentication does not provide per-packet\n  \
    \ authentication.\n   PPP encryption is defined but PPP Encryption Control Protocol\
    \ (ECP)\n   negotiation does not provide for a protected cipher suite\n   negotiation.\
    \  PPP encryption provides a weak security solution\n   [RFC3193].  PPP ECP implementation\
    \ cannot be expected.  PPP\n   authentication also does not provide scalable key\
    \ management.\n   Once the L2TPv2 tunnel and PPP configuration are successfully\n\
    \   established, the SI is connected and can start using the connection.\n   These\
    \ steps are vulnerable to man-in-the-middle (MITM), denial-of-\n   service (DoS),\
    \ and service-theft attacks, which are caused by the\n   following adversary actions.\n\
    \   Adversary attacks on softwire include:\n   1.  An adversary may try to discover\
    \ identities and other\n       confidential information by snooping data packets.\n\
    \   2.  An adversary may try to modify both control and data packets.\n      \
    \ This type of attack involves integrity violations.\n   3.  An adversary may\
    \ try to eavesdrop and collect control messages.\n       By replaying these messages,\
    \ an adversary may successfully hijack\n       the L2TP tunnel or the PPP connection\
    \ inside the tunnel.  An\n       adversary might mount MITM, DoS, and theft-of-service\
    \ attacks.\n   4.  An adversary can flood the softwire node with bogus signaling\n\
    \       messages to cause DoS attacks by terminating L2TP tunnels or PPP\n   \
    \    connections.\n   5.  An adversary may attempt to disrupt the softwire negotiation\
    \ in\n       order to weaken or remove confidentiality protection.\n   6.  An\
    \ adversary may wish to disrupt the PPP LCP authentication\n       negotiation.\n\
    \   When AAA servers are involved in softwire tunnel establishment, the\n   security\
    \ attacks can be mounted on the communication associated with\n   AAA servers.\
    \  Specifically, for Case 3 stated in Section 3.2, an\n   adversary may eavesdrop\
    \ on the packets between AAA servers in the\n   home and visited network and compromise\
    \ the authentication data.  An\n   adversary may also disrupt the communication\
    \ between the AAA servers,\n   causing a service denial.  Security of AAA server\
    \ communications is\n   out of scope of this document.\n   In environments where\
    \ the link is shared without cryptographic\n   protection and weak authentication\
    \ or one-way authentication is used,\n   these security attacks can be mounted\
    \ on softwire control and data\n   packets.\n   When there is no prior trust relationship\
    \ between the SI and SC, any\n   node can pretend to be a SC.  In this case, an\
    \ adversary may\n   impersonate the SC to intercept traffic (e.g., \"rogue\" softwire\n\
    \   concentrator).\n   The rogue SC can introduce a denial-of-service attack by\
    \ blackholing\n   packets from the SI.  The rogue SC can also eavesdrop on all\
    \ packets\n   sent from or to the SI.  Security threats of a rogue SC are similar\n\
    \   to a compromised router.\n   The deployment of ingress filtering is able to\
    \ control malicious\n   users' access [RFC4213].  Without specific ingress filtering\
    \ checks\n   in the decapsulator at the SC, it would be possible for an attacker\n\
    \   to inject a false packet, leaving the system vulnerable to attacks\n   such\
    \ as DoS.  Using ingress filtering, invalid inner addresses can be\n   rejected.\
    \  Without ingress filtering of inner addresses, another kind\n   of attack can\
    \ happen.  The malicious users from another ISP could\n   start using its tunneling\
    \ infrastructure to get free inner-address\n   connectivity, effectively transforming\
    \ the ISP into an inner-address\n   transit provider.\n   Ingress filtering does\
    \ not provide complete protection in the case\n   that address spoofing has happened.\
    \  In order to provide better\n   protection against address spoofing, authentication\
    \ with binding\n   between the legitimate address and the authenticated identity\
    \ MUST be\n   implemented.  This can be implemented between the SC and the SI\
    \ using\n   IPsec.\n"
- title: 3.4.  Softwire Security Guidelines
  contents:
  - "3.4.  Softwire Security Guidelines\n   Based on the security threat analysis\
    \ in Section 3.3 of this\n   document, the softwire security protocol MUST support\
    \ the following\n   protections.\n   1.  Softwire control messages between the\
    \ SI and SC MUST be protected\n       against eavesdropping and spoofing attacks.\n\
    \   2.  The softwire security protocol MUST be able to protect itself\n      \
    \ against replay attacks.\n   3.  The softwire security protocol MUST be able\
    \ to protect the device\n       identifier against the impersonation when it is\
    \ exchanged between\n       the SI and the SC.\n   4.  The softwire security protocol\
    \ MUST be able to securely bind the\n       authenticated session to the device\
    \ identifier of the client, to\n       prevent service theft.\n   5.  The softwire\
    \ security protocol MUST be able to protect disconnect\n       and revocation\
    \ messages.\n   The softwire security protocol requirement is comparable to\n\
    \   [RFC3193].\n   For softwire control packets, authentication, integrity, and\
    \ replay\n   protection MUST be supported, and confidentiality SHOULD be\n   supported.\n\
    \   For softwire data packets, authentication, integrity, and replay\n   protection\
    \ SHOULD be supported, and confidentiality MAY be supported.\n   The \"Softwire\
    \ Problem Statement\" [RFC4925] provides some requirements\n   for the \"Hubs\
    \ and Spoke\" solution that are taken into account in\n   defining the security\
    \ protection mechanisms.\n   1.  The control and/or data plane MUST be able to\
    \ provide full\n       payload security when desired.\n   2.  The deployed technology\
    \ MUST be very strongly considered.\n   This additional security protection must\
    \ be separable from the\n   softwire tunneling mechanism.\n   Note that the scope\
    \ of this security is on the L2TP tunnel between\n   the SI and SC.  If end-to-end\
    \ security is required, a security\n   protocol SHOULD be used in the payload\
    \ packets.  But this is out of\n   scope of this document.\n"
- title: 3.4.1.  Authentication
  contents:
  - "3.4.1.  Authentication\n   The softwire security protocol MUST support user authentication\
    \ in\n   the control plane in order to authorize access to the service and\n \
    \  provide adequate logging of activity.  Although several\n   authentication\
    \ protocols are available, security threats must be\n   considered to choose the\
    \ protocol.\n   For example, consider the SI/user using Password Authentication\n\
    \   Protocol (PAP) access to the SC with a cleartext password.  In many\n   circumstances,\
    \ this represents a large security risk.  The adversary\n   may spoof as a legitimate\
    \ user by using the stolen password.  The\n   Challenge Handshake Authentication\
    \ Protocol (CHAP) [RFC1994] encrypts\n   a password with a \"challenge\" sent\
    \ from the SC.  The theft of\n   password can be mitigated.  However, as CHAP\
    \ only supports\n   unidirectional authentication, the risk of a man-in-the-middle\
    \ or\n   rogue SC cannot be avoided.  Extensible Authentication Protocol-\n  \
    \ Transport Layer Security (EAP-TLS) [RFC5216] mandates mutual\n   authentication\
    \ and avoids the rogue SC.\n   When the SI established a connection to the SC\
    \ through a public\n   network, the SI may want proof of the SC identity.  Softwire\
    \ MUST\n   support mutual authentication to allow for such a scenario.\n   In\
    \ some circumstances, however, the service provider may decide to\n   allow non-authenticated\
    \ connection [RFC5571].  For example, when the\n   customer is already authenticated\
    \ by some other means, such as closed\n   networks, cellular networks at Layer\
    \ 2, etc., the service provider\n   may decide to turn authentication off.  If\
    \ no authentication is\n   conducted on any layer, the SC acts as a gateway for\
    \ anonymous\n   connections.  Running such a service MUST be configurable by the\
    \ SC\n   administrator and the SC SHOULD take some security measures, such as\n\
    \   ingress filtering and adequate logging of activity.  It should be\n   noted\
    \ that anonymous connection service cannot provide the security\n   functionalities\
    \ described in this document (e.g., integrity, replay\n   protection, and confidentiality).\n\
    \   L2TPv2 selected as the softwire phase 1 protocol supports PPP\n   authentication\
    \ and L2TPv2 authentication.  PPP authentication and\n   L2TPv2 have various security\
    \ threats, as stated in Section 3.3.  They\n   will be used in the limited condition\
    \ as described in the next\n   subsections.\n"
- title: 3.4.1.1.  PPP Authentication
  contents:
  - "3.4.1.1.  PPP Authentication\n   PPP can provide mutual authentication between\
    \ the SI and SC using\n   CHAP [RFC1994] during the connection-establishment phase\
    \ (via the\n   Link Control Protocol, LCP).  PPP CHAP authentication can be used\n\
    \   when the SI and SC are on a trusted, non-public IP network.\n   Since CHAP\
    \ does not provide per-packet authentication, integrity, or\n   replay protection,\
    \ PPP CHAP authentication MUST NOT be used\n   unprotected on a public IP network.\
    \  If other appropriate protected\n   mechanisms have been already applied, PPP\
    \ CHAP authentication MAY be\n   used.\n   Optionally, other authentication methods\
    \ such as PAP, MS-CHAP, and\n   EAP MAY be supported.\n"
- title: 3.4.1.2.  L2TPv2 Authentication
  contents:
  - "3.4.1.2.  L2TPv2 Authentication\n   L2TPv2 provides an optional CHAP-like tunnel\
    \ authentication during\n   the control connection establishment [RFC2661], Section\
    \ 5.1.1.\n   L2TPv2 authentication MUST NOT be used unprotected on a public IP\n\
    \   network, similar to the same restriction applied to PPP CHAP\n   authentication.\n"
- title: 3.4.2.  Softwire Security Protocol
  contents:
  - "3.4.2.  Softwire Security Protocol\n   To meet the above requirements, all softwire-security-compliant\n\
    \   implementations MUST implement the following security protocols.\n   IPsec\
    \ ESP [RFC4303] in transport mode is used for securing softwire\n   control and\
    \ data packets.  The Internet Key Exchange (IKE) protocol\n   [RFC4306] MUST be\
    \ supported for authentication, security association\n   negotiation, and key\
    \ management for IPsec.  The applicability of\n   different versions of IKE is\
    \ discussed in Section 3.5.\n   The softwire security protocol MUST support NAT\
    \ traversal.  UDP\n   encapsulation of IPsec ESP packets[RFC3948] and negotiation\
    \ of NAT-\n   traversal in IKE [RFC3947] MUST be supported when IPsec is used.\n"
- title: 3.5.  Guidelines for Usage of IPsec in Softwire
  contents:
  - "3.5.  Guidelines for Usage of IPsec in Softwire\n   When the softwire \"Hubs\
    \ and Spokes\" solution implemented by L2TPv2 is\n   used in an untrustworthy\
    \ network, softwire MUST be protected by\n   appropriate security protocols, such\
    \ as IPsec.  This section provides\n   guidelines for the usage of IPsec in L2TPv2-based\
    \ softwire.\n   [RFC3193] discusses how L2TP can use IKE [RFC2409] and IPsec\n\
    \   [RFC2401] to provide tunnel authentication, privacy protection,\n   integrity\
    \ checking, and replay protection.  Since the publication of\n   [RFC3193], the\
    \ revisions to IPsec protocols have been published\n   (IKEv2 [RFC4306], ESP [RFC4303],\
    \ NAT-traversal for IKE [RFC3947], and\n   ESP [RFC3948]).\n   Given that deployed\
    \ technology must be very strongly considered\n   [RFC4925] for the 'time-to-market'\
    \ solution, [RFC3193] MUST be\n   supported.  However, the new implementation\
    \ SHOULD use IKEv2\n   [RFC4306] for IPsec because of the numerous advantages\
    \ it has over\n   IKE [RFC2409].  In new deployments, IKEv2 SHOULD be used as\
    \ well.\n   Although [RFC3193] can be applied in the softwire \"Hubs and Spokes\"\
    \n   solution, softwire requirements such as NAT-traversal, NAT-traversal\n  \
    \ for IKE [RFC3947], and ESP [RFC3948] MUST be supported.\n   Meanwhile, IKEv2\
    \ [RFC4306] integrates NAT-traversal.  IKEv2 also\n   supports EAP authentication,\
    \ with the authentication using shared\n   secrets (pre-shared key) or a public\
    \ key signature (certificate).\n   The selection of pre-shared key or certificate\
    \ depends on the scale\n   of the network for which softwire is to be deployed,\
    \ as described in\n   Section 3.5.2.  However, pre-shared keys and certificates\
    \ only\n   support the machine authentication.  When both machine and user\n \
    \  authentications are required as, for example, in the nomadic case,\n   EAP\
    \ SHOULD be used.\n   Together with EAP, IKEv2 [RFC4306] supports legacy authentication\n\
    \   methods that may be useful in environments where username- and\n   password-based\
    \ authentication is already deployed.\n   IKEv2 is a more reliable protocol than\
    \ IKE [RFC2409] in terms of\n   replay-protection capability, DoS-protection-enabled\
    \ mechanism, etc.\n   Therefore, new implementations SHOULD use IKEv2 over IKE.\n\
    \   The following sections will discuss using IPsec to protect L2TPv2 as\n   applied\
    \ in the softwire \"Hubs and Spokes\" model.  Unless otherwise\n   stated, IKEv2\
    \ and the new IPsec architecture [RFC4301] is assumed.\n"
- title: 3.5.1.  Authentication Issues
  contents:
  - "3.5.1.  Authentication Issues\n   IPsec implementation using IKE only supports\
    \ machine authentication.\n   There is no way to verify a user identity and to\
    \ segregate the tunnel\n   traffic among users in the multi-user machine environment.\
    \  IKEv2 can\n   support user authentication with EAP payload by leveraging the\n\
    \   existing authentication infrastructure and credential database.  This\n  \
    \ enables traffic segregation among users when user authentication is\n   used\
    \ by combining the legacy authentication.  The user identity\n   asserted within\
    \ IKEv2 will be verified on a per-packet basis.\n   If the AAA server is involved\
    \ in security association establishment\n   between the SI and SC, a session key\
    \ can be derived from the\n   authentication between the SI and the AAA server.\
    \  Successful EAP\n   exchanges within IKEv2 run between the SI and the AAA server\
    \ to\n   create a session key, which is securely transferred to the SC from\n\
    \   the AAA server.  The trust relationship between the involved entities\n  \
    \ follows Section 3.2 of this document.\n"
- title: 3.5.2.  IPsec Pre-Shared Keys for Authentication
  contents:
  - "3.5.2.  IPsec Pre-Shared Keys for Authentication\n   With IPsec, when the identity\
    \ asserted in IKE is authenticated, the\n   resulting derived keys are used to\
    \ provide per-packet authentication,\n   integrity, and replay protection.  As\
    \ a result, the identity verified\n   in the IKE is subsequently verified on reception\
    \ of each packet.\n   Authentication using pre-shared keys can be used when the\
    \ number of\n   SI and SC is small.  As the number of SI and SC grows, pre-shared\n\
    \   keys become increasingly difficult to manage.  A softwire security\n   protocol\
    \ MUST provide a scalable approach to key management.\n   Whenever possible, authentication\
    \ with certificates is preferred.\n   When pre-shared keys are used, group pre-shared\
    \ keys MUST NOT be used\n   because of its vulnerability to man-in-the-middle\
    \ attacks ([RFC3193],\n   Section 5.1.4).\n"
- title: 3.5.3.  Inter-Operability Guidelines
  contents:
  - "3.5.3.  Inter-Operability Guidelines\n   The L2TPv2/IPsec inter-operability concerning\
    \ tunnel teardown,\n   fragmentation, and per-packet security checks given in\
    \ [RFC3193],\n   Section 3 must be taken into account.\n   Although the L2TP specification\
    \ allows the responder (SC in softwire)\n   to use a new IP address or to change\
    \ the port number when sending the\n   Start-Control-Connection-Request-Reply\
    \ (SCCRP), a softwire\n   concentrator implementation SHOULD NOT do this ([RFC3193],\
    \ Section\n   4).\n   However, for some reasons, for example, \"load-balancing\"\
    \ between SCs,\n   the IP address change is required.  To signal an IP address\
    \ change,\n   the SC sends a StopCCN message to the SI using the Result and Error\n\
    \   Code AVP in an L2TPv2 message.  A new IKE_SA and CHILD_SA MUST be\n   established\
    \ to the new IP address.\n   Since ESP transport mode is used, the UDP header\
    \ carrying the L2TP\n   packet will have an incorrect checksum due to the change\
    \ of parts of\n   the IP header during transit.  Section 3.1.2 of [RFC3948] defines\
    \ 3\n   procedures that can be used to fix the checksum.  A softwire\n   implementation\
    \ MUST NOT use the \"incremental update of checksum\"\n   (option 1 described\
    \ in [RFC3948]) because IKEv2 does not have the\n   information required (NAT-OA\
    \ payload) to compute that checksum.\n   Since ESP is already providing validation\
    \ on the L2TP packet, a\n   simple approach is to use the \"do not check\" approach\
    \ (option 3 in\n   [RFC3948]).\n"
- title: 3.5.4.  IPsec Filtering Details
  contents:
  - "3.5.4.  IPsec Filtering Details\n   If the old IPsec architecture [RFC2401] and\
    \ IKE [RFC2409] are used,\n   the security policy database (SPD) examples in [RFC3193],\
    \ Appendix A\n   can be applied to softwire model.  In that case, the initiator\
    \ is\n   always the client (SI), and the responder is the SC.  IPsec SPD\n   examples\
    \ for IKE [RFC2409] are also given in Appendix A of this\n   document.\n   The\
    \ revised IPsec architecture [RFC4301] redefined the SPD entries to\n   provide\
    \ more flexibility (multiple selectors per entry, list of\n   address range, peer\
    \ authentication database (PAD), \"populate from\n   packet\" (PFP) flag, etc.).\
    \  The Internet Key Exchange (IKE) has also\n   been revised and simplified in\
    \ IKEv2 [RFC4306].  The following\n   sections provide the SPD examples for softwire\
    \ to use the revised\n   IPsec architecture and IKEv2.\n"
- title: 3.5.4.1.  IPv6-over-IPv4 Softwire L2TPv2 Example for IKEv2
  contents:
  - "3.5.4.1.  IPv6-over-IPv4 Softwire L2TPv2 Example for IKEv2\n   If IKEv2 is used\
    \ as the key management protocol, [RFC4301] provides\n   the guidance of the SPD\
    \ entries.  In IKEv2, we can use the PFP flag\n   to specify the SA, and the port\
    \ number can be selected with the TSr\n   (Traffic Selector - Responder) payload\
    \ during CREATE_CHILD_SA.  The\n   following describes PAD entries on the SI and\
    \ SC, respectively.  The\n   PAD entries are only example configurations.  The\
    \ PAD entry on the SC\n   matches user identities to the L2TP SPD entry.  This\
    \ is done using a\n   symbolic name type specified in [RFC4301].\n   SI PAD:\n\
    \   - IF remote_identity = SI_identity\n        Then authenticate (shared secret/certificate/)\n\
    \        and authorize CHILD_SA for remote address SC_address\n   SC PAD:\n  \
    \ - IF remote_identity = user_1\n        Then authenticate (shared secret/certificate/EAP)\n\
    \        and authorize CHILD_SAs for symbolic name \"l2tp_spd_entry\"\n   The\
    \ following describes the SPD entries for the SI and SC,\n   respectively.  Note\
    \ that IKEv2 and ESP traffic MUST be allowed\n   (bypass).  These include IP protocol\
    \ 50 and UDP port 500 and 4500.\n   The IPv4 packet format when ESP protects and\
    \ L2TPv2 carries an IPv6\n   packet is shown in Table 1, which is similar to Table\
    \ 1 in [RFC4891].\n   +----------------------------+------------------------------------+\n\
    \   | Components (first to last) |              Contains              |\n   +----------------------------+------------------------------------+\n\
    \   |         IPv4 header        |   (src = IPv4-SI, dst = IPv4-SC)   |\n   |\
    \         ESP header         |                                    |\n   |    \
    \     UDP header         |   (src port=1701, dst port=1701)   |\n   |        \
    \ L2TPv2 header      |                                    |\n   |         PPP\
    \ header         |                                    |\n   |         IPv6 header\
    \        |                                    |\n   |         (payload)      \
    \    |                                    |\n   |         ESP ICV            |\
    \                                    |\n   +----------------------------+------------------------------------+\n\
    \    Table 1: Packet Format for L2TPv2 with ESP Carrying IPv6 Packet\n   SPD for\
    \ Softwire Initiator:\n   Softwire Initiator SPD-S\n   - IF local_address=IPv4-SI\n\
    \        remote_address=IPv4-SC\n        Next Layer Protocol=UDP\n        local_port=1701\n\
    \        remote_port=ANY (PFP=1)\n    Then use SA ESP transport mode\n    Initiate\
    \ using IDi = user_1 to address IPv4-SC\n   SPD for Softwire Concentrator:\n \
    \  Softwire Concentrator SPD-S\n   - IF name=\"l2tp_spd_entry\"\n        local_address=IPv4-SC\n\
    \        remote_address=ANY (PFP=1)\n        Next Layer Protocol=UDP\n       \
    \ local_port=1701\n        remote_port=ANY (PFP=1)\n    Then use SA ESP transport\
    \ mode\n"
- title: 3.5.4.2.  IPv4-over-IPv6 Softwire L2TPv2 Example for IKEv2
  contents:
  - "3.5.4.2.  IPv4-over-IPv6 Softwire L2TPv2 Example for IKEv2\n   The PAD entries\
    \ for SI and SC are shown as examples.  These example\n   configurations are similar\
    \ to those in Section 3.5.4.1 of this\n   document.\n   SI PAD:\n   - IF remote_identity\
    \ = SI_identity\n        Then authenticate (shared secret/certificate/)\n    \
    \    and authorize CHILD_SA for remote address SC_address\n   SC PAD:\n   - IF\
    \ remote_identity = user_2\n        Then authenticate (shared secret/certificate/EAP)\n\
    \        and authorize CHILD_SAs for symbolic name \"l2tp_spd_entry\"\n   The\
    \ following describes the SPD entries for the SI and SC,\n   respectively.  In\
    \ this example, the SI and SC are denoted with IPv6\n   addresses IPv6-SI and\
    \ IPv6-SC, respectively.  Note that IKEv2 and ESP\n   traffic MUST be allowed\
    \ (bypass).  These include IP protocol 50 and\n   UDP port 500 and 4500.\n   The\
    \ IPv6 packet format when ESP protects and L2TPv2 carries an IPv4\n   packet is\
    \ shown in Table 2, which is similar to Table 1 in [RFC4891].\n   +----------------------------+------------------------------------+\n\
    \   | Components (first to last) |              Contains              |\n   +----------------------------+------------------------------------+\n\
    \   |         IPv6 header        |   (src = IPv6-SI, dst = IPv6-SC)   |\n   |\
    \         ESP header         |                                    |\n   |    \
    \     UDP header         |   (src port=1701, dst port=1701)   |\n   |        \
    \ L2TPv2 header      |                                    |\n   |         PPP\
    \ header         |                                    |\n   |         IPv4 header\
    \        |                                    |\n   |         (payload)      \
    \    |                                    |\n   |         ESP ICV            |\
    \                                    |\n   +----------------------------+------------------------------------+\n\
    \    Table 2: Packet Format for L2TPv2 with ESP Carrying IPv4 Packet\n   SPD for\
    \ Softwire Initiator:\n   Softwire Initiator SPD-S\n   - IF local_address=IPv6-SI\n\
    \        remote_address=IPv6-SC\n        Next Layer Protocol=UDP\n        local_port=1701\n\
    \        remote_port=ANY (PFP=1)\n    Then use SA ESP transport mode\n    Initiate\
    \ using IDi = user_2 to address IPv6-SC\n   SPD for Softwire Concentrator:\n \
    \  Softwire Concentrator SPD-S\n   - IF name=\"l2tp_spd_entry\"\n        local_address=IPv6-SC\n\
    \        remote_address=ANY (PFP=1)\n        Next Layer Protocol=UDP\n       \
    \ local_port=1701\n        remote_port=ANY (PFP=1)\n    Then use SA ESP transport\
    \ mode\n"
- title: 4.  Mesh Security Guidelines
  contents:
  - '4.  Mesh Security Guidelines

    '
- title: 4.1.  Deployment Scenario
  contents:
  - "4.1.  Deployment Scenario\n   In the softwire \"Mesh\" solution ([RFC4925], [RFC5565]),\
    \ it is\n   required to establish connectivity to access network islands of one\n\
    \   address family type across a transit core of a differing address\n   family\
    \ type.  To provide reachability across the transit core, AFBRs\n   are installed\
    \ between the access network island and transit core\n   network.  These AFBRs\
    \ can perform as Provider Edge routers (PE)\n   within an autonomous system or\
    \ perform peering across autonomous\n   systems.  The AFBRs establish and encapsulate\
    \ softwires in a mesh to\n   the other islands across the transit core network.\
    \  The transit core\n   network consists of one or more service providers.\n \
    \  In the softwire \"Mesh\" solution, a pair of PE routers (AFBRs) use BGP\n \
    \  to exchange routing information.  AFBR nodes in the transit network\n   are\
    \ Internal BGP speakers and will peer with each other directly or\n   via a route\
    \ reflector to exchange SW-encap sets, perform softwire\n   signaling, and advertise\
    \ AF access island reachability information\n   and SW-NHOP information.  If such\
    \ information is advertised within an\n   autonomous system, the AFBR node receiving\
    \ them from other AFBRs does\n   not forward them to other AFBR nodes.  To exchange\
    \ the information\n   among AFBRs, the full mesh connectivity will be established.\n\
    \   The connectivity between CE and PE routers includes dedicated\n   physical\
    \ circuits, logical circuits (such as Frame Relay and ATM),\n   and shared medium\
    \ access (such as Ethernet-based access).\n   When AFBRs are PE routers located\
    \ at the edge of the provider core\n   networks, this architecture is similar\
    \ to the L3VPN described in\n   [RFC4364].  The connectivity between a CE router\
    \ in an access island\n   network and a PE router in a transit network is established\n\
    \   statically.  The access islands are enterprise networks accommodated\n   through\
    \ PE routers in the provider's transit network.  In this case,\n   the access\
    \ island networks are administrated by the provider's\n   autonomous system.\n\
    \   The AFBRs may have multiple connections to the core network, and also\n  \
    \ may have connections to multiple client access networks.  The client\n   access\
    \ networks may connect to each other through private networks or\n   through the\
    \ Internet.  When the client access networks have their own\n   AS number, a CE\
    \ router located inside access islands forms a private\n   BGP peering with an\
    \ AFBR.  Further, an AFBR may need to exchange full\n   Internet routing information\
    \ with each network to which it connects.\n"
- title: 4.2.  Trust Relationship
  contents:
  - "4.2.  Trust Relationship\n   All AFBR nodes in the transit core MUST have a trust\
    \ relationship or\n   an agreement with each other to establish softwires.  When\
    \ the\n   transit core consists of a single administrative domain, it is\n   assumed\
    \ that all nodes (e.g., AFBR, PE, or Route Reflector, if\n   applicable) are trusted\
    \ by each other.\n   If the transit core consists of multiple administrative domains,\n\
    \   intermediate routers between AFBRs may not be trusted.\n   There MUST be a\
    \ trust relationship between the PE in the transit core\n   and the CE in the\
    \ corresponding island, although the link(s) between\n   the PE and the CE may\
    \ not be protected.\n"
- title: 4.3.  Softwire Security Threat Scenarios
  contents:
  - "4.3.  Softwire Security Threat Scenarios\n   As the architecture of the softwire\
    \ mesh solution is very similar to\n   that of the provider-provisioned VPN (PPVPN).\
    \  The security threat\n   considerations on the PPVPN operation are applicable\
    \ to those in the\n   softwire mesh solution [RFC4111].\n   Examples of attacks\
    \ to data packets being transmitted on a softwire\n   tunnel include:\n   1. \
    \ An adversary may try to discover confidential information by\n       sniffing\
    \ softwire packets.\n   2.  An adversary may try to modify the contents of softwire\
    \ packets.\n   3.  An adversary may try to spoof the softwire packets that do\
    \ not\n       belong to the authorized domains and to insert copies of once-\n\
    \       legitimate packets that have been recorded and replayed.\n   4.  An adversary\
    \ can launch denial-of-service (DoS) attacks by\n       deleting softwire data\
    \ traffic.  DoS attacks of the resource\n       exhaustion type can be mounted\
    \ against the data plane by spoofing\n       a large amount of non-authenticated\
    \ data into the softwire from\n       the outside of the softwire tunnel.\n  \
    \ 5.  An adversary may try to sniff softwire packets and to examine\n       aspects\
    \ or meta-aspects of them that may be visible even when the\n       packets themselves\
    \ are encrypted.  An attacker might gain useful\n       information based on the\
    \ amount and timing of traffic, packet\n       sizes, source and destination addresses,\
    \ etc.\n   The security attacks can be mounted on the control plane as well. \
    \ In\n   the softwire mesh solution, softwire encapsulation will be set up by\n\
    \   using BGP.  As described in [RFC4272], BGP is vulnerable to various\n   security\
    \ threats such as confidentiality violation; replay attacks;\n   insertion, deletion,\
    \ and modification of BGP messages; man-in-the-\n   middle attacks; and denial-of-service\
    \ attacks.\n"
- title: 4.4.  Applicability of Security Protection Mechanism
  contents:
  - "4.4.  Applicability of Security Protection Mechanism\n   Given that security\
    \ is generally a compromise between expense and\n   risk, it is also useful to\
    \ consider the likelihood of different\n   attacks.  There is at least a perceived\
    \ difference in the likelihood\n   of most types of attacks being successfully\
    \ mounted in different\n   deployment.\n   The trust relationship among users\
    \ in access networks, transit core\n   providers, and other parts of networks\
    \ described in Section 4.2 is a\n   key element in determining the applicability\
    \ of the security\n   protection mechanism for the specific softwire mesh deployment.\n"
- title: 4.4.1.  Security Protection Mechanism for Control Plane
  contents:
  - "4.4.1.  Security Protection Mechanism for Control Plane\n   The \"Softwire Problem\
    \ Statement\" [RFC4925] states that the softwire\n   mesh setup mechanism to advertise\
    \ the softwire encapsulation MUST\n   support authentication, but the transit\
    \ core provider may decide to\n   turn it off in some circumstances.\n   The BGP\
    \ authentication mechanism is specified in [RFC2385].  The\n   mechanism defined\
    \ in [RFC2385] is based on a one-way hash function\n   (MD5) and use of a secret\
    \ key.  The key is shared between a pair of\n   peer routers and is used to generate\
    \ 16-byte message authentication\n   code values that are not readily computed\
    \ by an attacker who does not\n   have access to the key.\n   However, the security\
    \ mechanism for BGP transport (e.g., TCP-MD5) is\n   inadequate in some circumstances\
    \ and also requires operator\n   interaction to maintain a respectable level of\
    \ security.  The current\n   deployments of TCP-MD5 exhibit some shortcomings\
    \ with respect to key\n   management as described in [RFC3562].\n   Key management\
    \ can be especially cumbersome for operators.  The\n   number of keys required\
    \ and the maintenance of keys (issue/revoke/\n   renew) has had an additive effect\
    \ as a barrier to deployment.  Thus,\n   automated means of managing keys, to\
    \ reduce operational burdens, is\n   available in the BGP security system ([BGP-SEC],\
    \ [RFC4107]).\n   Use of IPsec counters the message insertion, deletion, and\n\
    \   modification attacks, as well as man-in-the-middle attacks by\n   outsiders.\
    \  If routing data confidentiality is desired, the use of\n   IPsec ESP could\
    \ provide that service.  If eavesdropping attacks are\n   identified as a threat,\
    \ ESP can be used to provide confidentiality\n   (encryption), integrity, and\
    \ authentication for the BGP session.\n"
- title: 4.4.2.  Security Protection Mechanism for Data Plane
  contents:
  - "4.4.2.  Security Protection Mechanism for Data Plane\n   To transport data packets\
    \ across the transit core, the mesh solution\n   defines multiple encapsulations:\
    \ L2TPv3, IP-in-IP, MPLS (LDP-based\n   and RSVP-TE based), and GRE.  To securely\
    \ transport such data\n   packets, the softwire MUST support IPsec tunnel.\n \
    \  IPsec can provide authentication and integrity.  The implementation\n   MUST\
    \ support ESP with null encryption [RFC4303] or else AH (IP\n   Authentication\
    \ Header) [RFC4302].  If some part of the transit core\n   network is not trusted,\
    \ ESP with encryption MAY be applied.\n   Since the softwires are created dynamically\
    \ by BGP, the automated key\n   distribution MUST be performed by IKEv2 [RFC4306]\
    \ with either pre-\n   shared key or public key management.  For dynamic softwire\
    \ IPsec\n   tunnel creation, the pre-shared key will be the same in all routers.\n\
    \   Namely, pre-shared key indicates here \"group key\" instead of\n   \"pairwise-shared\"\
    \ key.\n   If security policy requires a stronger key management, the public key\n\
    \   SHOULD be used.  If a public key infrastructure is not available, the\n  \
    \ IPsec Tunnel Authentication sub-TLV specified in [RFC5566] MUST be\n   used\
    \ before SA is established.\n   If the link(s) between the user's site and the\
    \ provider's PE is not\n   trusted, then encryption MAY be used on the PE-CE link(s).\n\
    \   Together with the cryptographic security protection, the access-\n   control\
    \ technique reduces exposure to attacks from outside the\n   service provider\
    \ networks (transit networks).  The access-control\n   technique includes packet-by-packet\
    \ or packet-flow-by-packet-flow\n   access control by means of filters as well\
    \ as by means of admitting a\n   session for a control/signaling/management protocol\
    \ that is being\n   used to implement softwire mesh.\n   The access-control technique\
    \ is an important protection against\n   security attacks of DoS, etc., and a\
    \ necessary adjunct to\n   cryptographic strength in encapsulation.  Packets that\
    \ match the\n   criteria associated with a particular filter may be either discarded\n\
    \   or given special treatment to prevent an attack or to mitigate the\n   effect\
    \ of a possible future attack.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   This document discusses various security threats\
    \ for the softwire\n   control and data packets in the \"Hubs and Spokes\" and\
    \ \"Mesh\" time-to-\n   market solutions.  With these discussions, the softwire\
    \ security\n   protocol implementations are provided by referencing \"Softwire\n\
    \   Problem Statement\" [RFC4925], \"Securing L2TP using IPsec\" [RFC3193],\n\
    \   \"Security Framework for PPVPNs\" [RFC4111], and \"Guidelines for\n   Specifying\
    \ the Use of IPsec\" [RFC5406].  The guidelines for the\n   security protocol\
    \ employment are also given considering the specific\n   deployment context.\n\
    \   Note that this document discusses softwire tunnel security protection\n  \
    \ and does not address end-to-end protection.\n"
- title: 6.  Acknowledgments
  contents:
  - "6.  Acknowledgments\n   The authors would like to thank Tero Kivinen for reviewing\
    \ the\n   document and Francis Dupont for substantive suggestions.\n   Acknowledgments\
    \ to Jordi Palet Martinez, Shin Miyakawa, Yasuhiro\n   Shirasaki, and Bruno Stevant\
    \ for their feedback.\n   We would like also to thank the authors of the Softwire\
    \ Hub & Spoke\n   Deployment Framework document [RFC5571] for providing the text\n\
    \   concerning security.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC1994]  Simpson, W., \"PPP Challenge Handshake\
    \ Authentication\n              Protocol (CHAP)\", RFC 1994, August 1996.\n  \
    \ [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n          \
    \    Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2385]  Heffernan,\
    \ A., \"Protection of BGP Sessions via the TCP MD5\n              Signature Option\"\
    , RFC 2385, August 1998.\n   [RFC2661]  Townsley, W., Valencia, A., Rubens, A.,\
    \ Pall, G., Zorn,\n              G., and B. Palter, \"Layer Two Tunneling Protocol\
    \ \"L2TP\"\",\n              RFC 2661, August 1999.\n   [RFC3193]  Patel, B.,\
    \ Aboba, B., Dixon, W., Zorn, G., and S. Booth,\n              \"Securing L2TP\
    \ using IPsec\", RFC 3193, November 2001.\n   [RFC3947]  Kivinen, T., Swander,\
    \ B., Huttunen, A., and V. Volpe,\n              \"Negotiation of NAT-Traversal\
    \ in the IKE\", RFC 3947,\n              January 2005.\n   [RFC3948]  Huttunen,\
    \ A., Swander, B., Volpe, V., DiBurro, L., and M.\n              Stenberg, \"\
    UDP Encapsulation of IPsec ESP Packets\",\n              RFC 3948, January 2005.\n\
    \   [RFC4107]  Bellovin, S. and R. Housley, \"Guidelines for Cryptographic\n \
    \             Key Management\", BCP 107, RFC 4107, June 2005.\n   [RFC4301]  Kent,\
    \ S. and K. Seo, \"Security Architecture for the\n              Internet Protocol\"\
    , RFC 4301, December 2005.\n   [RFC4302]  Kent, S., \"IP Authentication Header\"\
    , RFC 4302,\n              December 2005.\n   [RFC4303]  Kent, S., \"IP Encapsulating\
    \ Security Payload (ESP)\",\n              RFC 4303, December 2005.\n   [RFC4306]\
    \  Kaufman, C., \"Internet Key Exchange (IKEv2) Protocol\",\n              RFC\
    \ 4306, December 2005.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [BGP-SEC]  Christian, B. and T. Tauber, \"BGP\
    \ Security Requirements\",\n              Work in Progress, November 2008.\n \
    \  [RFC2401]  Kent, S. and R. Atkinson, \"Security Architecture for the\n    \
    \          Internet Protocol\", RFC 2401, November 1998.\n   [RFC2409]  Harkins,\
    \ D. and D. Carrel, \"The Internet Key Exchange\n              (IKE)\", RFC 2409,\
    \ November 1998.\n   [RFC2607]  Aboba, B. and J. Vollbrecht, \"Proxy Chaining\
    \ and Policy\n              Implementation in Roaming\", RFC 2607, June 1999.\n\
    \   [RFC3562]  Leech, M., \"Key Management Considerations for the TCP MD5\n  \
    \            Signature Option\", RFC 3562, July 2003.\n   [RFC4016]  Parthasarathy,\
    \ M., \"Protocol for Carrying Authentication\n              and Network Access\
    \ (PANA) Threat Analysis and Security\n              Requirements\", RFC 4016,\
    \ March 2005.\n   [RFC4081]  Tschofenig, H. and D. Kroeselberg, \"Security Threats\
    \ for\n              Next Steps in Signaling (NSIS)\", RFC 4081, June 2005.\n\
    \   [RFC4111]  Fang, L., \"Security Framework for Provider-Provisioned\n     \
    \         Virtual Private Networks (PPVPNs)\", RFC 4111, July 2005.\n   [RFC4213]\
    \  Nordmark, E. and R. Gilligan, \"Basic Transition Mechanisms\n             \
    \ for IPv6 Hosts and Routers\", RFC 4213, October 2005.\n   [RFC4225]  Nikander,\
    \ P., Arkko, J., Aura, T., Montenegro, G., and E.\n              Nordmark, \"\
    Mobile IP Version 6 Route Optimization Security\n              Design Background\"\
    , RFC 4225, December 2005.\n   [RFC4272]  Murphy, S., \"BGP Security Vulnerabilities\
    \ Analysis\",\n              RFC 4272, January 2006.\n   [RFC4364]  Rosen, E.\
    \ and Y. Rekhter, \"BGP/MPLS IP Virtual Private\n              Networks (VPNs)\"\
    , RFC 4364, February 2006.\n   [RFC4593]  Barbir, A., Murphy, S., and Y. Yang,\
    \ \"Generic Threats to\n              Routing Protocols\", RFC 4593, October 2006.\n\
    \   [RFC4891]  Graveman, R., Parthasarathy, M., Savola, P., and H.\n         \
    \     Tschofenig, \"Using IPsec to Secure IPv6-in-IPv4 Tunnels\",\n          \
    \    RFC 4891, May 2007.\n   [RFC4925]  Li, X., Dawkins, S., Ward, D., and A.\
    \ Durand, \"Softwire\n              Problem Statement\", RFC 4925, July 2007.\n\
    \   [RFC5216]  Simon, D., Aboba, B., and R. Hurst, \"The EAP-TLS\n           \
    \   Authentication Protocol\", RFC 5216, March 2008.\n   [RFC5406]  Bellovin,\
    \ S., \"Guidelines for Specifying the Use of IPsec\n              Version 2\"\
    , BCP 146, RFC 5406, February 2009.\n   [RFC5565]  Wu, J., Cui, Y., Metz, C.,\
    \ and E. Rosen, \"Softwire Mesh\n              Framework\", RFC 5565, June 2009.\n\
    \   [RFC5566]  Berger, L., White, R., and E. Rosen, \"BGP IPsec Tunnel\n     \
    \         Encapsulation Attribute\", RFC 5566, June 2009.\n   [RFC5571]  Storer,\
    \ B., Pignataro, C., Dos Santos, M., Stevant, B.,\n              Toutain, L.,\
    \ and J. Tremblay, \"Softwire Hub and Spoke\n              Deployment Framework\
    \ with Layer Two Tunneling Protocol\n              Version 2 (L2TPv2)\", RFC 5571,\
    \ June 2009.\n"
- title: Appendix A.  Examples
  contents:
  - "Appendix A.  Examples\n   If the old IPsec architecture [RFC2401] and IKE [RFC2409]\
    \ are used,\n   the SPD examples in [RFC3193] are applicable to the \"Hub & Spokes\"\
    \n   model.  In this model, the initiator is always the client (SI), and\n   the\
    \ responder is the SC.\n"
- title: A.1.  IPv6-over-IPv4 Softwire with L2TPv2 Example for IKE
  contents:
  - "A.1.  IPv6-over-IPv4 Softwire with L2TPv2 Example for IKE\n   IPv4 addresses\
    \ of the softwire initiator and concentrator are denoted\n   by IPv4-SI and IPv4-SC,\
    \ respectively.  If NAT traversal is used in\n   IKE, UDP source and destination\
    \ ports are 4500.  In this SPD entry,\n   IKE refers to UDP port 500. * denotes\
    \ wildcard and indicates ANY port\n   or address.\n      Local     Remote    \
    \ Protocol                  Action\n      -----     ------     --------      \
    \            ------\n      IPV4-SI   IPV4-SC      ESP                     BYPASS\n\
    \      IPV4-SI   IPV4-SC      IKE                     BYPASS\n      IPv4-SI  \
    \ IPV4-SC      UDP, src 1701, dst 1701 PROTECT(ESP,\n                        \
    \                             transport)\n      IPv4-SC   IPv4-SI      UDP, src\
    \   * , dst 1701 PROTECT(ESP,\n                                              \
    \       transport)\n                          Softwire Initiator SPD\n       Remote\
    \   Local      Protocol                  Action\n       ------   ------     --------\
    \                  ------\n         *      IPV4-SC      ESP                  \
    \   BYPASS\n         *      IPV4-SC      IKE                     BYPASS\n    \
    \     *      IPV4-SC      UDP, src * , dst 1701   PROTECT(ESP,\n             \
    \                                        transport)\n                        \
    \ Softwire Concentrator SPD\n"
- title: A.2.  IPv4-over-IPv6 Softwire with Example for IKE
  contents:
  - "A.2.  IPv4-over-IPv6 Softwire with Example for IKE\n   IPv6 addresses of the\
    \ softwire initiator and concentrator are denoted\n   by IPv6-SI and IPv6-SC,\
    \ respectively.  If NAT traversal is used in\n   IKE, UDP source and destination\
    \ ports are 4500.  In this SPD entry,\n   IKE refers to UDP port 500. * denotes\
    \ wildcard and indicates ANY port\n   or address.\n      Local     Remote    \
    \ Protocol                   Action\n      -----     ------     --------     \
    \              ------\n      IPV6-SI   IPV6-SC      ESP                      BYPASS\n\
    \      IPV6-SI   IPV6-SC      IKE                      BYPASS\n      IPv6-SI \
    \  IPV6-SC      UDP, src 1701, dst 1701  PROTECT(ESP,\n                      \
    \                                transport)\n      IPv6-SC   IPv6-SI      UDP,\
    \ src * , dst 1701    PROTECT(ESP,\n                                         \
    \             transport)\n                          Softwire Initiator SPD\n \
    \      Remote   Local      Protocol                   Action\n       ------  \
    \ ------     --------                   ------\n         *      IPV6-SC      ESP\
    \                      BYPASS\n         *      IPV6-SC      IKE              \
    \        BYPASS\n         *      IPV6-SC      UDP, src * , dst 1701    PROTECT(ESP,\n\
    \                                                      transport)\n          \
    \               Softwire Concentrator SPD\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Shu Yamamoto\n   NICT/KDDI R&D Labs\n   1-13-16 Hakusan,\
    \ Bunkyo-ku\n   Tokyo  113-0001\n   Japan\n   Phone: +81-3-3868-6913\n   EMail:\
    \ shu@nict.go.jp\n   Carl Williams\n   KDDI R&D Labs\n   Palo Alto, CA  94301\n\
    \   USA\n   Phone: +1-650-279-5903\n   EMail: carlw@mcsr-labs.org\n   Hidetoshi\
    \ Yokota\n   KDDI R&D Labs\n   2-1-15 Ohara\n   Fujimino, Saitama  356-8502\n\
    \   Japan\n   Phone: +81-49-278-7894\n   EMail: yokota@kddilabs.jp\n   Florent\
    \ Parent\n   Beon Solutions\n   Quebec, QC\n   Canada\n   EMail: Florent.Parent@beon.ca\n"
