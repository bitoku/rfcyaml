- title: __initial_text__
  contents:
  - '  A Framework for Integrated Services Operation over Diffserv Networks

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2000).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   The Integrated Services (Intserv) architecture provides a means\
    \ for\n   the delivery of end-to-end Quality of Service (QoS) to applications\n\
    \   over heterogeneous networks.  To support this end-to-end model, the\n   Intserv\
    \ architecture must be supported over a wide variety of\n   different types of\
    \ network elements.  In this context, a network that\n   supports Differentiated\
    \ Services (Diffserv) may be viewed as a\n   network element in the total end-to-end\
    \ path.  This document\n   describes a framework by which Integrated Services\
    \ may be supported\n   over Diffserv networks.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction .................................................\
    \  3\n   1.1 Integrated Services Architecture ............................  3\n\
    \   1.2 RSVP ........................................................  3\n   1.3\
    \ Diffserv ....................................................  4\n   1.4 Roles\
    \ of Intserv, RSVP and Diffserv .........................  4\n   1.5 Components\
    \ of Intserv, RSVP and Diffserv ....................  5\n   1.6 The Framework\
    \ ...............................................  6\n   1.7 Contents ....................................................\
    \  6\n   2. Benefits of Using Intserv with Diffserv ......................  7\n\
    \   2.1 Resource Based Admission Control ............................  7\n   2.2\
    \ Policy Based Admission Control ..............................  8\n   2.3 Assistance\
    \ in Traffic Identification/Classification .........  8\n   2.3.1 Host Marking\
    \ ..............................................  9\n   2.3.2 Router Marking ............................................\
    \  9\n   2.4 Traffic Conditioning ........................................ 10\n\
    \   3. The Framework ................................................ 10\n   3.1\
    \ Reference Network ........................................... 11\n   3.1.1 Hosts\
    \ ..................................................... 11\n   3.1.2 End-to-End\
    \ RSVP Signaling ................................. 12\n   3.1.3 Edge Routers ..............................................\
    \ 12\n   3.1.4 Border Routers ............................................ 12\n\
    \   3.1.5 Diffserv Network Region ................................... 13\n   3.1.6\
    \ Non-Diffserv Network Regions .............................. 13\n   3.2 Service\
    \ Mapping ............................................. 13\n   3.2.1 Default Mapping\
    \ ........................................... 14\n   3.2.2 Network Driven Mapping\
    \ .................................... 14\n   3.2.3 Microflow Separation ......................................\
    \ 14\n   3.3 Resource Management in Diffserv Regions ..................... 15\n\
    \   4. Detailed Examples of the Operation of\n      Intserv over Diffserv Regions\
    \ ................................ 16\n   4.1 Statically Provisioned Diffserv\
    \ Network Region .............. 16\n   4.1.1 Sequence of Events in Obtaining End-to-end\
    \ QoS ............ 16\n   4.2 RSVP-Aware Diffserv Network Region ..........................\
    \ 18\n   4.2.1 Aggregated or Tunneled RSVP ............................... 19\n\
    \   4.2.3 Per-flow RSVP ............................................. 20\n   4.2.4\
    \ Granularity of Deployment of RSVP Aware Routers ........... 20\n   4.3 Dynamically\
    \ Provisioned, Non-RSVP-aware Diffserv Region ..... 21\n   5. Implications of\
    \ the Framework for Diffserv Network Regions ... 21\n   5.1 Requirements from\
    \ Diffserv Network Regions .................. 21\n   5.2 Protection of Intserv\
    \ Traffic from Other Traffic ............ 22\n   6. Multicast ....................................................\
    \ 22\n   6.1 Remarking of packets in branch point routers ................ 24\n\
    \   6.2 Multicast SLSs and Heterogeneous Trees ...................... 25\n   7.\
    \ Security Considerations ...................................... 26\n   7.1 General\
    \ RSVP Security ....................................... 26\n   7.2 Host Marking\
    \ ................................................ 26\n   8. Acknowledgments ..............................................\
    \ 27\n   9. References ................................................... 27\n\
    \   10. Authors' Addresses .......................................... 29\n   11.\
    \  Full Copyright Statement ................................... 31\n"
- title: 1. Introduction
  contents:
  - "1. Introduction\n   Work on QoS-enabled IP networks has led to two distinct approaches:\n\
    \   the Integrated Services architecture (Intserv) [10] and its\n   accompanying\
    \ signaling protocol, RSVP [1], and the Differentiated\n   Services architecture\
    \ (Diffserv) [8].  This document describes ways\n   in which a Diffserv network\
    \ can be used in the context of the Intserv\n   architecture to support the delivery\
    \ of end-to-end QOS.\n"
- title: 1.1 Integrated Services Architecture
  contents:
  - "1.1 Integrated Services Architecture\n   The integrated services architecture\
    \ defined a set of extensions to\n   the traditional best effort model of the\
    \ Internet with the goal of\n   allowing end-to-end QOS to be provided to applications.\
    \  One of the\n   key components of the architecture is a set of service definitions;\n\
    \   the current set of services consists of the controlled load and\n   guaranteed\
    \ services.  The architecture assumes that some explicit\n   setup mechanism is\
    \ used to convey information to routers so that they\n   can provide requested\
    \ services to flows that require them.  While\n   RSVP is the most widely known\
    \ example of such a setup mechanism, the\n   Intserv architecture is designed\
    \ to accommodate other mechanisms.\n   Intserv services are implemented by \"\
    network elements\".  While it is\n   common for network elements to be individual\
    \ nodes such as routers or\n   links, more complex entities, such as ATM \"clouds\"\
    \ or 802.3 networks\n   may also function as network elements.  As discussed in\
    \ more detail\n   below, a Diffserv network (or \"cloud\") may be viewed as a\
    \ network\n   element within a larger Intserv network.\n"
- title: 1.2 RSVP
  contents:
  - "1.2 RSVP\n   RSVP is a signaling protocol that applications may use to request\n\
    \   resources from the network.  The network responds by explicitly\n   admitting\
    \ or rejecting RSVP requests.  Certain applications that have\n   quantifiable\
    \ resource requirements express these requirements using\n   Intserv parameters\
    \ as defined in the appropriate Intserv service\n   specification.  As noted above,\
    \ RSVP and Intserv are separable.  RSVP\n   is a signaling protocol which may\
    \ carry Intserv information.  Intserv\n   defines the models for expressing service\
    \ types, quantifying resource\n   requirements and for determining the availability\
    \ of the requested\n   resources at relevant network elements (admission control).\n\
    \   The current prevailing model of RSVP usage is based on a combined\n   RSVP/Intserv\
    \ architecture.  In this model, RSVP signals per-flow\n   resource requirements\
    \ to network elements, using Intserv parameters.\n   These network elements apply\
    \ Intserv admission control to signaled\n   requests.  In addition, traffic control\
    \ mechanisms on the network\n   element are configured to ensure that each admitted\
    \ flow receives the\n   service requested in strict isolation from other traffic.\
    \  To this\n   end, RSVP signaling configures microflow (MF) [8] packet classifiers\n\
    \   in Intserv capable routers along the path of the traffic flow.  These\n  \
    \ classifiers enable per-flow classification of packets based on IP\n   addresses\
    \ and port numbers.\n   The following factors have impeded deployment of RSVP\
    \ (and the\n   Intserv architecture) in the Internet at large:\n   1. The use\
    \ of per-flow state and per-flow processing raises\n      scalability concerns\
    \ for large networks.\n   2. Only a small number of hosts currently generate RSVP\
    \ signaling.\n      While this number is expected to grow dramatically, many\n\
    \      applications may never generate RSVP signaling.\n   3. The necessary policy\
    \ control mechanisms -- access control,\n      authentication, and accounting\
    \ -- have only recently become\n      available [17].\n"
- title: 1.3 Diffserv
  contents:
  - "1.3 Diffserv\n   In contrast to the per-flow orientation of RSVP, Diffserv networks\n\
    \   classify packets into one of a small number of aggregated flows or\n   \"\
    classes\", based on the Diffserv codepoint (DSCP) in the packet's IP\n   header.\
    \  This is known as behavior aggregate (BA) classification [8].\n   At each Diffserv\
    \ router, packets are subjected to a \"per-hop\n   behavior\" (PHB), which is\
    \ invoked by the DSCP.  The primary benefit\n   of Diffserv is its scalability.\
    \  Diffserv eliminates the need for\n   per-flow state and per-flow processing\
    \ and therefore scales well to\n   large networks.\n"
- title: 1.4 Roles of Intserv, RSVP and Diffserv
  contents:
  - "1.4 Roles of Intserv, RSVP and Diffserv\n   We view Intserv, RSVP and Diffserv\
    \ as complementary technologies in\n   the pursuit of end-to-end QoS.  Together,\
    \ these mechanisms can\n   facilitate deployment of applications such as IP-telephony,\
    \ video-\n   on-demand, and various non-multimedia mission-critical applications.\n\
    \   Intserv enables hosts to request per-flow, quantifiable resources,\n   along\
    \ end-to-end data paths and to obtain feedback regarding\n   admissibility of\
    \ these requests.  Diffserv enables scalability across\n   large networks.\n"
- title: 1.5 Components of Intserv, RSVP and Diffserv
  contents:
  - "1.5 Components of Intserv, RSVP and Diffserv\n   Before proceeding, it is helpful\
    \ to identify the following components\n   of the QoS technologies described:\n\
    \   RSVP signaling - This term refers to the standard RSVP signaling\n   protocol.\
    \  RSVP signaling is used by hosts to signal application\n   resource requirements\
    \ to the network (and to each other).  Network\n   elements use RSVP signaling\
    \ to return an admission control decision\n   to hosts.  RSVP signaling may or\
    \ may not carry Intserv parameters.\n   Admission control at a network element\
    \ may or may not be based on the\n   Intserv model.\n   MF traffic control - This\
    \ term refers to traffic control which is\n   applied independently to individual\
    \ traffic flows and therefore\n   requires recognizing individual traffic flows\
    \ via MF classification.\n   Aggregate traffic control - This term refers to traffic\
    \ control which\n   is applied collectively to sets of traffic flows.  These sets\
    \ of\n   traffic flows are recognized based on BA (DSCP) classification.  In\n\
    \   this document, we use the terms \"aggregate traffic control\" and\n   \"Diffserv\"\
    \ interchangeably.\n   Aggregate RSVP.  While the existing definition of RSVP\
    \ supports only\n   per-flow reservations, extensions to RSVP are being developed\
    \ to\n   enable RSVP reservations to be made for aggregated traffic, i.e.,\n \
    \  sets of flows that may be recognized by BA classification.  This use\n   of\
    \ RSVP may be useful in controlling the allocation of bandwidth in\n   Diffserv\
    \ networks.\n   Per-flow RSVP.  The conventional usage of RSVP to perform resource\n\
    \   reservations for individual microflows.\n   RSVP/Intserv - This term is used\
    \ to refer to the prevailing model of\n   RSVP usage which includes RSVP signaling\
    \ with Intserv parameters,\n   Intserv admission control and per-flow traffic\
    \ control at network\n   elements.\n   Diffserv Region.  A set of contiguous routers\
    \ which support BA\n   classification and traffic control.  While such a region\
    \ may also\n   support MF classification, the goal of this document is to describe\n\
    \   how such a region may be used in delivery of end-to-end QOS when only\n  \
    \ BA classification is performed inside the Diffserv region.\n   Non-Diffserv\
    \ Region.  The portions of the network outside the\n   Diffserv region.  Such\
    \ a region may also offer a variety of different\n   types of classification and\
    \ traffic control.\n   Note that, for the purposes of this document, the defining\
    \ features\n   of a Diffserv region is the type of classification and traffic\n\
    \   control that is used for the delivery of end-to-end QOS for a\n   particular\
    \ application.  Thus, while it may not be possible to\n   identify a certain region\
    \ as \"purely Diffserv\" with respect to all\n   traffic flowing through the region,\
    \ it is possible to define it in\n   this way from the perspective of the treatment\
    \ of traffic from a\n   single application.\n"
- title: 1.6 The Framework
  contents:
  - "1.6 The Framework\n   In the framework we present, end-to-end, quantitative QoS\
    \ is provided\n   by applying the Intserv model end-to-end across a network containing\n\
    \   one or more Diffserv regions.  The Diffserv regions may, but are not\n   required\
    \ to, participate in end-to-end RSVP signaling for the purpose\n   of optimizing\
    \ resource allocation and supporting admission control.\n   From the perspective\
    \ of Intserv, Diffserv regions of the network are\n   treated as virtual links\
    \ connecting Intserv capable routers or hosts\n   (much as an 802.1p network region\
    \ is treated as a virtual link in\n   [5]).  Within the Diffserv regions of the\
    \ network routers implement\n   specific PHBs (aggregate traffic control).  The\
    \ total amount of\n   traffic that is admitted into the Diffserv region that will\
    \ receive a\n   certain PHB may be limited by policing at the edge.  As a result\
    \ we\n   expect that the Diffserv regions of the network will be able to\n   support\
    \ the Intserv style services requested from the periphery.  In\n   our framework,\
    \ we address the support of end-to-end Integrated\n   Services over the Diffserv\
    \ regions of the network.  Our goal is to\n   enable seamless inter-operation.\
    \  As a result, the network\n   administrator is free to choose which regions\
    \ of the network act as\n   Diffserv regions.  In one extreme the Diffserv region\
    \ is pushed all\n   the way to the periphery, with hosts alone having full Intserv\n\
    \   capability.  In the other extreme, Intserv is pushed all the way to\n   the\
    \ core, with no Diffserv region.\n"
- title: 1.7 Contents
  contents:
  - "1.7 Contents\n   In section 3 we discuss the benefits that can be realized by\
    \ using\n   the aggregate traffic control provided by Diffserv network regions\
    \ in\n   the broader context of the Intserv architecture.  In section 4, we\n\
    \   present the framework and the reference network.  Section 5 details\n   two\
    \ possible realizations of the framework.  Section 6 discusses the\n   implications\
    \ of the framework for Diffserv.  Section 7 presents some\n   issues specific\
    \ to multicast flows.\n"
- title: 2. Benefits of Using Intserv with Diffserv
  contents:
  - "2. Benefits of Using Intserv with Diffserv\n   The primary benefit of Diffserv\
    \ aggregate traffic control is its\n   scalability.  In this section, we discuss\
    \ the benefits that\n   interoperation with Intserv can bring to a Diffserv network\
    \ region.\n   Note that this discussion is in the context of servicing quantitative\n\
    \   QoS applications specifically.  By this we mean those applications\n   that\
    \ are able to quantify their traffic and QoS requirements.\n"
- title: 2.1 Resource Based Admission Control
  contents:
  - "2.1 Resource Based Admission Control\n   In Intserv networks, quantitative QoS\
    \ applications use an explicit\n   setup mechanism (e.g., RSVP) to request resources\
    \ from the network.\n   The network may accept or reject these requests in response.\
    \  This is\n   \"explicit admission control\".  Explicit and dynamic admission\
    \ control\n   helps to assure that network resources are optimally used.  To\n\
    \   further understand this issue, consider a Diffserv network region\n   providing\
    \ only aggregate traffic control with no signaling.  In the\n   Diffserv network\
    \ region, admission control is applied in a relatively\n   static way by provisioning\
    \ policing parameters at network elements.\n   For example, a network element\
    \ at the ingress to a Diffserv network\n   region could be provisioned to accept\
    \ only 50 Kbps of traffic for the\n   EF DSCP.\n   While such static forms of\
    \ admission control do protect the network\n   to some degree, they can be quite\
    \ ineffective.  For example, consider\n   that there may be 10 IP telephony sessions\
    \ originating outside the\n   Diffserv network region, each requiring 10 Kbps\
    \ of EF service from\n   the Diffserv network region.  Since the network element\
    \ protecting\n   the Diffserv network region is provisioned to accept only 50\
    \ Kbps of\n   traffic for the EF DSCP, it will discard half the offered traffic.\n\
    \   This traffic will be discarded from the aggregation of traffic marked\n  \
    \ EF, with no regard to the microflow from which it originated.  As a\n   result,\
    \ it is likely that of the ten IP telephony sessions, none will\n   obtain satisfactory\
    \ service when in fact, there are sufficient\n   resources available in the Diffserv\
    \ network region to satisfy five\n   sessions.\n   In the case of explicitly signaled,\
    \ dynamic admission control, the\n   network will signal rejection in response\
    \ to requests for resources\n   that would exceed the 50 Kbps limit.  As a result,\
    \ upstream network\n   elements (including originating hosts) and applications\
    \ will have the\n   information they require to take corrective action.  The application\n\
    \   might respond by refraining from transmitting, or by requesting\n   admission\
    \ for a lesser traffic profile.  The host operating system\n   might respond by\
    \ marking the application's traffic for the DSCP that\n   corresponds to best-effort\
    \ service.  Upstream network elements might\n   respond by re-marking packets\
    \ on the rejected flow to a lower service\n   level.  In some cases, it may be\
    \ possible to reroute traffic over\n   alternate paths or even alternate networks\
    \ (e.g., the PSTN for voice\n   calls).  In any case, the integrity of those flows\
    \ that were admitted\n   would be preserved, at the expense of the flows that\
    \ were not\n   admitted.  Thus, by appointing an Intserv-conversant admission\n\
    \   control agent for the Diffserv region of the network it is possible\n   to\
    \ enhance the service that the network can provide to quantitative\n   QoS applications.\n"
- title: 2.2 Policy Based Admission Control
  contents:
  - "2.2 Policy Based Admission Control\n   In network regions where RSVP is used,\
    \ resource requests can be\n   intercepted by RSVP-aware network elements and\
    \ can be reviewed\n   against policies stored in policy databases.  These resource\
    \ requests\n   securely identify the user and the application for which the\n\
    \   resources are requested.  Consequently, the network element is able\n   to\
    \ consider per-user and/or per-application policy when deciding\n   whether or\
    \ not to admit a resource request.  So, in addition to\n   optimizing the use\
    \ of resources in a Diffserv network region (as\n   discussed in 3.1) RSVP conversant\
    \ admission control agents can be\n   used to apply specific customer policies\
    \ in determining the specific\n   customer traffic flows entitled to use the Diffserv\
    \ network region's\n   resources.  Customer policies can be used to allocate resources\
    \ to\n   specific users and/or applications.\n   By comparison, in Diffserv network\
    \ regions without RSVP signaling,\n   policies are typically applied based on\
    \ the Diffserv customer network\n   from which traffic originates, not on the\
    \ originating user or\n   application within the customer network.\n"
- title: 2.3 Assistance in Traffic Identification/Classification
  contents:
  - "2.3 Assistance in Traffic Identification/Classification\n   Within Diffserv network\
    \ regions, traffic is allotted service based on\n   the DSCP marked in each packet's\
    \ IP header.  Thus, in order to obtain\n   a particular level of service within\
    \ the Diffserv network region, it\n   is necessary to effect the marking of the\
    \ correct DSCP in packet\n   headers.  There are two mechanisms for doing so,\
    \ host marking and\n   router marking.  In the case of host marking, the host\
    \ operating\n   system marks the DSCP in transmitted packets.  In the case of\
    \ router\n   marking, routers in the network are configured to identify specific\n\
    \   traffic (typically based on MF classification) and to mark the DSCP\n   as\
    \ packets transit the router.  There are advantages and\n   disadvantages to each\
    \ scheme.  Regardless of the scheme used,\n   explicit signaling offers significant\
    \ benefits.\n"
- title: 2.3.1 Host Marking
  contents:
  - "2.3.1 Host Marking\n   In the case of host marking, the host operating system\
    \ marks the DSCP\n   in transmitted packets.  This approach has the benefit of\
    \ shifting\n   per-flow classification and marking to the source of the traffic,\n\
    \   where it scales best.  It also enables the host to make decisions\n   regarding\
    \ the mark that is appropriate for each transmitted packet\n   and hence the relative\
    \ importance attached to each packet.  The host\n   is generally better equipped\
    \ to make this decision than the network.\n   Furthermore, if IPSEC encryption\
    \ is used, the host may be the only\n   device in the network that is able to\
    \ make a meaningful determination\n   of the appropriate marking for each packet,\
    \ since various fields such\n   as port numbers would be unavailable to routers\
    \ for MF\n   classification.\n   Host marking requires that the host be aware\
    \ of the interpretation of\n   DSCPs by the network.  This information can be\
    \ configured into each\n   host.  However, such configuration imposes a management\
    \ burden.\n   Alternatively, hosts can use an explicit signaling protocol such\
    \ as\n   RSVP to query the network to obtain a suitable DSCP or set of DSCPs\n\
    \   to apply to packets for which a certain Intserv service has been\n   requested.\
    \  An example of how this can be achieved is described in\n   [14].\n"
- title: 2.3.2 Router Marking
  contents:
  - "2.3.2 Router Marking\n   In the case of router marking, MF classification criteria\
    \ must be\n   configured in the router in some way.  This may be done dynamically\n\
    \   (e.g., using COPS provisioning), by request from the host operating\n   system,\
    \ or statically via manual configuration or via automated\n   scripts.\n   There\
    \ are significant difficulties in doing so statically.  In many\n   cases, it\
    \ is desirable to allot service to traffic based on the\n   application and/or\
    \ user originating the traffic.  At times it is\n   possible to identify packets\
    \ associated with a specific application\n   by the IP port numbers in the headers.\
    \  It may also be possible to\n   identify packets originating from a specific\
    \ user by the source IP\n   address.  However, such classification criteria may\
    \ change\n   frequently.  Users may be assigned different IP addresses by DHCP.\n\
    \   Applications may use transient ports.  To further complicate matters,\n  \
    \ multiple users may share an IP address.  These factors make it very\n   difficult\
    \ to manage static configuration of the classification\n   information required\
    \ to mark traffic in routers.\n   An attractive alternative to static configuration\
    \ is to allow host\n   operating systems to signal classification criteria to\
    \ the router on\n   behalf of users and applications.  As we will show later in\
    \ this\n   document, RSVP signaling is ideally suited for this task.  In\n   addition\
    \ to enabling dynamic and accurate updating of MF\n   classification criteria,\
    \ RSVP signaling enables classification of\n   IPSEC [13] packets (by use of the\
    \ SPI) which would otherwise be\n   unrecognizable.\n"
- title: 2.4 Traffic Conditioning
  contents:
  - "2.4 Traffic Conditioning\n   Intserv-capable network elements are able to condition\
    \ traffic at a\n   per-flow granularity, by some combination of shaping and/or\
    \ policing.\n   Pre-conditioning traffic in this manner before it is submitted\
    \ to the\n   Diffserv region of the network is beneficial.  In particular, it\n\
    \   enhances the ability of the Diffserv region of the network to provide\n  \
    \ quantitative services using aggregate traffic control.\n"
- title: 3. The Framework
  contents:
  - "3. The Framework\n   In the general framework we envision an Internet in which\
    \ the\n   Integrated Services architecture is used to deliver end-to-end QOS to\n\
    \   applications.  The network includes some combination of Intserv\n   capable\
    \ nodes (in which MF classification and per-flow traffic\n   control is applied)\
    \ and Diffserv regions (in which aggregate traffic\n   control is applied).  Individual\
    \ routers may or may not participate\n   in RSVP signaling regardless of where\
    \ in the network they reside.\n   We will consider two specific realizations of\
    \ the framework. In the\n   first, resources within the Diffserv regions of the\
    \ network are\n   statically provisioned and these regions include no RSVP aware\n\
    \   devices.  In the second, resources within the Diffserv region of the\n   network\
    \ are dynamically provisioned and select devices within the\n   Diffserv network\
    \ regions participate in RSVP signaling.\n"
- title: 3.1 Reference Network
  contents:
  - "3.1 Reference Network\n   The two realizations of the framework will be discussed\
    \ in the\n   context of the following reference network:\n             ________\
    \         ______________         ________\n            /        \\       /   \
    \           \\       /        \\\n           /          \\     /             \
    \   \\     /          \\\n    |---| |        |---|   |---|          |---|   |---|\
    \        | |---|\n    |Tx |-|        |ER1|---|BR1|          |BR2|---|ER2|    \
    \    |-|Rx |\n    |---| |        |-- |   |---|          |---|   |---|        |\
    \ |---|\n           \\          /     \\                /     \\          /\n\
    \            \\________/       \\______________/       \\________/\n        Non-Diffserv\
    \ region   Diffserv region     Non-Diffserv region\n                 Figure 1:\
    \ Sample Network Configuration\n   The reference network includes a Diffserv region\
    \ in the middle of a\n   larger network supporting Intserv end-to-end.  The Diffserv\
    \ region\n   contains a mesh of routers, at least some of which provide aggregate\n\
    \   traffic control.  The regions outside the Diffserv region (non-\n   Diffserv\
    \ regions) contain meshes of routers and attached hosts, at\n   least some of\
    \ which support the Integrated Services architecture.\n   In the interest of simplicity\
    \ we consider a single QoS sender, Tx\n   communicating across this network with\
    \ a single QoS receiver, Rx.\n   The edge routers (ER1, ER2) which are adjacent\
    \ to the Diffserv region\n   interface to the border routers (BR1, BR2) within\
    \ the Diffserv\n   region.\n   From an economic viewpoint, we may consider that\
    \ the Diffserv region\n   sells service to the network outside the Diffserv region,\
    \ which in\n   turn provides service to hosts.  Thus, we may think of the non-\n\
    \   Diffserv regions as clients or customers of the Diffserv region.  In\n   the\
    \ following, we use the term \"customer\" for the non-Diffserv\n   regions.  Note\
    \ that the boundaries of the regions may or may not\n   align with administrative\
    \ domain boundaries, and that a single region\n   might contain multiple administrative\
    \ domains.\n   We now define the major components of the reference network.\n"
- title: 3.1.1 Hosts
  contents:
  - "3.1.1 Hosts\n   We assume that both sending and receiving hosts use RSVP to\n\
    \   communicate the quantitative QoS requirements of QoS-aware\n   applications\
    \ running on the host.  In principle, other mechanisms may\n   be used to establish\
    \ resource reservations in Intserv-capable nodes,\n   but RSVP is clearly the\
    \ prevalent mechanism for this purpose.\n   Typically, a QoS process within the\
    \ host operating system generates\n   RSVP signaling on behalf of applications.\
    \  This process may also\n   invoke local traffic control.\n   As discussed above,\
    \ traffic control in the host may mark the DSCP in\n   transmitted packets, and\
    \ shape transmitted traffic to the\n   requirements of the Intserv service in\
    \ use.  Alternatively, the first\n   Intserv-capable router downstream from the\
    \ host may provide these\n   traffic control functions.\n"
- title: 3.1.2 End-to-End RSVP Signaling
  contents:
  - "3.1.2 End-to-End RSVP Signaling\n   We assume that RSVP signaling messages travel\
    \ end-to-end between\n   hosts Tx and Rx to support RSVP/Intserv reservations\
    \ outside the\n   Diffserv network region.  We require that these end-to-end RSVP\n\
    \   messages are at least carried across the Diffserv region.  Depending\n   on\
    \ the specific realization of the framework, these messages may be\n   processed\
    \ by none, some or all of the routers in the Diffserv region.\n"
- title: 3.1.3 Edge Routers
  contents:
  - "3.1.3 Edge Routers\n   ER1 and ER2 are edge routers, residing adjacent to the\
    \ Diffserv\n   network regions.  The functionality of the edge routers varies\n\
    \   depending on the specific realization of the framework.  In the case\n   in\
    \ which the Diffserv network region is RSVP unaware, edge routers\n   act as admission\
    \ control agents to the Diffserv network.  They\n   process signaling messages\
    \ from both Tx and Rx, and apply admission\n   control based on resource availability\
    \ within the Diffserv network\n   region and on customer defined policy.  In the\
    \ case in which the\n   Diffserv network region is RSVP aware, the edge routers\
    \ apply\n   admission control based on local resource availability and on\n  \
    \ customer defined policy.  In this case, the border routers act as the\n   admission\
    \ control agent to the Diffserv network region.\n   We will later describe the\
    \ functionality of the edge routers in\n   greater depth for each of the two realizations\
    \ of the framework.\n"
- title: 3.1.4 Border Routers
  contents:
  - "3.1.4 Border Routers\n   BR1 and BR2 are border routers, residing in the Diffserv\
    \ network\n   region.  The functionality of the border routers varies depending\
    \ on\n   the specific realization of the framework.  In the case in which the\n\
    \   Diffserv network region is RSVP-unaware, these routers act as pure\n   Diffserv\
    \ routers.  As such, their sole responsibility is to police\n   submitted traffic\
    \ based on the service level specified in the DSCP\n   and the agreement negotiated\
    \ with the customer (aggregate\n   trafficcontrol).  In the case in which the\
    \ Diffserv network region is\n   RSVP-aware, the border routers participate in\
    \ RSVP signaling and act\n   as admission control agents for the Diffserv network\
    \ region.\n   We will later describe the functionality of the border routers in\n\
    \   greater depth for each of the two realizations of the framework.\n"
- title: 3.1.5 Diffserv Network Region
  contents:
  - "3.1.5 Diffserv Network Region\n   The Diffserv network region supports aggregate\
    \ traffic control and is\n   assumed not to be capable of MF classification. \
    \ Depending on the\n   specific realization of the framework, some number of routers\
    \ within\n   the Diffserv region may be RSVP aware and therefore capable of per-\n\
    \   flow signaling and admission control.  If devices in the Diffserv\n   region\
    \ are not RSVP aware, they will pass RSVP messages transparently\n   with negligible\
    \ performance impact (see [6]).\n   The Diffserv network region provides two or\
    \ more levels of service\n   based on the DSCP in packet headers.  It may be a\
    \ single\n   administrative domain or may span multiple domains.\n"
- title: 3.1.6 Non-Diffserv Network Regions
  contents:
  - "3.1.6 Non-Diffserv Network Regions\n   The network outside of the Diffserv region\
    \ consists of Intserv\n   capable hosts and other network elements.  Other elements\
    \ may include\n   routers and perhaps various types of network (e.g., 802, ATM,\
    \ etc.).\n   These network elements may reasonably be assumed to support Intserv,\n\
    \   although this might not be required in the case of over-provisioning.\n  \
    \ Even if these elements are not Intserv capable, we assume that they\n   will\
    \ pass RSVP messages unhindered.  Routers outside of the Diffserv\n   network\
    \ region are not precluded from providing aggregate traffic\n   control to some\
    \ subset of the traffic passing through them.\n"
- title: 3.2 Service Mapping
  contents:
  - "3.2 Service Mapping\n   Intserv service requests specify an Intserv service type\
    \ and a set of\n   quantitative parameters known as a \"flowspec\".  At each hop\
    \ in an\n   Intserv network, the Intserv service requests are interpreted in a\n\
    \   form meaningful to the specific link layer medium.  For example at an\n  \
    \ 802.1 hop, the Intserv parameters are mapped to an appropriate 802.1p\n   priority\
    \ level [5].\n   In our framework, Diffserv regions of the network are analogous\
    \ to\n   the 802.1p capable switched segments described in [5].  Requests for\n\
    \   Intserv services must be mapped onto the underlying capabilities of\n   the\
    \ Diffserv network region.  Aspects of the mapping include:\n    - selecting an\
    \ appropriate PHB, or set of PHBs, for the requested\n      service;\n    - performing\
    \ appropriate policing (including, perhaps, shaping or\n      remarking) at the\
    \ edges of the Diffserv region;\n    - exporting Intserv parameters from the Diffserv\
    \ region (e.g., for\n      the updating of ADSPECs);\n    - performing admission\
    \ control on the Intserv requests that takes\n      into account the resource\
    \ availability in the Diffserv region.\n   Exactly how these functions are performed\
    \ will be a function of the\n   way bandwidth is managed inside the Diffserv network\
    \ region, which is\n   a topic we discuss in Section 4.3.\n   When the PHB (or\
    \ set of PHBs) has been selected for a particular\n   Intserv flow, it may be\
    \ necessary to communicate the choice of DSCP\n   for the flow to other network\
    \ elements. Two schemes may be used to\n   achieve this end, as discussed below.\n"
- title: 3.2.1 Default Mapping
  contents:
  - "3.2.1 Default Mapping\n   In this scheme, there is some standard, well-known\
    \ mapping from\n   Intserv service type to a DSCP that will invoke the appropriate\n\
    \   behavior in the Diffserv network.\n"
- title: 3.2.2 Network Driven Mapping
  contents:
  - "3.2.2 Network Driven Mapping\n   In this scheme, RSVP conversant routers in the\
    \ Diffserv network\n   region (perhaps at its edge) may override the well-known\
    \ mapping\n   described in 4.2.1.  In the case that DSCPs are marked at the ingress\n\
    \   to the Diffserv region, the DSCPs can simply be remarked at the\n   boundary\
    \ routers.  However, in the case that DSCP marking occurs\n   upstream of the\
    \ Diffserv region, either in a host or a router, then\n   the appropriate mapping\
    \ needs to be communicated upstream, to the\n   marking device.  This may be accomplished\
    \ using RSVP, as described in\n   [14].\n   The decision regarding where to mark\
    \ DSCP and whether to override the\n   well-known service mapping is a mater of\
    \ policy to be decided by the\n   administrator of the Diffserv network region\
    \ in cooperation with the\n   administrator of the network adjacent to the Diffserv\
    \ region.\n"
- title: 3.2.3 Microflow Separation
  contents:
  - "3.2.3 Microflow Separation\n   Boundary routers residing at the edge of the Diffserv\
    \ region will\n   typically police traffic submitted from the outside the Diffserv\n\
    \   region in order to protect resources within the Diffserv region.\n   This\
    \ policing will be applied on an aggregate basis, with no regard\n   for the individual\
    \ microflows making up each aggregate.  As a result,\n   it is possible for a\
    \ misbehaving microflow to claim more than its\n   fair share of resources within\
    \ the aggregate, thereby degrading the\n   service provided to other microflows.\
    \  This problem may be addressed\n   by:\n   1. Providing per microflow policing\
    \ at the edge routers - this is\n   generally the most appropriate location for\
    \ microflow policing, since\n   it pushes per-flow work to the edges of the network,\
    \ where it scales\n   better.  In addition, since Intserv-capable routers outside\
    \ the\n   Diffserv region are responsible for providing microflow service to\n\
    \   their customers and the Diffserv region is responsible for providing\n   aggregate\
    \ service to its customers, this distribution of\n   functionality mirrors the\
    \ distribution of responsibility.\n   2. Providing per microflow policing at the\
    \ border routers - this\n   approach tends to be less scalable than the previous\
    \ approach.  It\n   also imposes a management burden on the Diffserv region of\
    \ the\n   network.  However, it may be appropriate in certain cases, for the\n\
    \   Diffserv boundary routers to offer per microflow policing as a\n   value-add\
    \ to its Intserv customers.\n   3. Relying on upstream shaping and policing -\
    \ in certain cases, the\n   customer may trust the shaping of certain groups of\
    \ hosts\n   sufficiently to not warrant reshaping or policing at the boundary\
    \ of\n   the Diffserv region.  Note that, even if the hosts are shaping\n   microflows\
    \ properly, these shaped flows may become distorted as they\n   transit through\
    \ the non-Diffserv region of the network.  Depending on\n   the degree of distortion,\
    \ it may be necessary to somewhat over-\n   provision the aggregate capacities\
    \ in the Diffserv region, or to re-\n   police using either 1 or 2 above.  The\
    \ choice of one mechanism or\n   another is a matter of policy to be decided by\
    \ the administrator of\n   the network outside the Diffserv region.\n"
- title: 3.3 Resource Management in Diffserv Regions
  contents:
  - "3.3 Resource Management in Diffserv Regions\n   A variety of options exist for\
    \ management of resources (e.g.,\n   bandwidth) in the Diffserv network regions\
    \ to meet the needs of end-\n   to-end Intserv flows.  These options include:\n\
    \    - statically provisioned resources;\n    - resources dynamically provisioned\
    \ by RSVP;\n    - resources dynamically provisioned by other means (e.g., a form\
    \ of\n      Bandwidth Broker).\n   Some of the details of using each of these\
    \ different approaches are\n   discussed in the following section.\n"
- title: 4. Detailed Examples of the Operation of Intserv over Diffserv Regions
  contents:
  - "4. Detailed Examples of the Operation of Intserv over Diffserv Regions\n   In\
    \ this section we provide detailed examples of our framework in\n   action.  We\
    \ discuss two examples, one in which the Diffserv network\n   region is RSVP unaware,\
    \ the other in which the Diffserv network\n   region is RSVP aware.\n"
- title: 4.1 Statically Provisioned Diffserv Network Region
  contents:
  - "4.1 Statically Provisioned Diffserv Network Region\n   In this example, no devices\
    \ in the Diffserv network region are RSVP\n   aware.  The Diffserv network region\
    \ is statically provisioned.  The\n   customer(s) of the Diffserv network regions\
    \ and the owner of the\n   Diffserv network region have negotiated a static contract\
    \ (service\n   level specification, or SLS) for the transmit capacity to be provided\n\
    \   to the customer at each of a number of standard Diffserv service\n   levels.\
    \  The \"transmit capacity\" may be simply an amount of bandwidth\n   or it could\
    \ be a more complex \"profile\" involving a number of factors\n   such as burst\
    \ size, peak rate, time of day etc.\n   It is helpful to consider each edge router\
    \ in the customer network as\n   consisting of two halves, a standard Intserv\
    \ half, which interfaces\n   to the customer's network regions and a Diffserv\
    \ half which\n   interfaces to the Diffserv network region.  The Intserv half\
    \ is able\n   to identify and process traffic on per-flow granularity.\n   The\
    \ Diffserv half of the router can be considered to consist of a\n   number of\
    \ virtual transmit interfaces, one for each Diffserv service\n   level negotiated\
    \ in the SLS.  The router contains a table that\n   indicates the transmit capacity\
    \ provisioned, per the SLS at each\n   Diffserv service level.  This table, in\
    \ conjunction with the default\n   mapping described in 4.2.1, is used to perform\
    \ admission control\n   decisions on Intserv flows which cross the Diffserv network\
    \ region.\n"
- title: 4.1.1 Sequence of Events in Obtaining End-to-end QoS
  contents:
  - "4.1.1 Sequence of Events in Obtaining End-to-end QoS\n   The following sequence\
    \ illustrates the process by which an\n   application obtains end-to-end QoS when\
    \ RSVP is used by the hosts.\n   1. The QoS process on the sending host Tx generates\
    \ an RSVP PATH\n   message that describes the traffic offered by the sending\n\
    \   application.\n   2. The PATH message is carried toward the receiving host,\
    \ Rx.  In the\n   network region to which the sender is attached, standard RSVP/Intserv\n\
    \   processing is applied at capable network elements.\n   3. At the edge router\
    \ ER1, the PATH message is subjected to standard\n   RSVP processing and PATH\
    \ state is installed in the router.  The PATH\n   message is sent onward to the\
    \ Diffserv network region.\n   4. The PATH message is ignored by routers in the\
    \ Diffserv network\n   region and then processed at ER2 according to standard\
    \ RSVP\n   processing rules.\n   5. When the PATH message reaches the receiving\
    \ host Rx, the operating\n   system generates an RSVP RESV message, indicating\
    \ interest in offered\n   traffic of a certain Intserv service type.\n   6. The\
    \ RESV message is carried back towards the Diffserv network\n   region and the\
    \ sending host.  Consistent with standard RSVP/Intserv\n   processing, it may\
    \ be rejected at any RSVP-capable node in the path\n   if resources are deemed\
    \ insufficient to carry the traffic requested.\n   7. At ER2, the RESV message\
    \ is subjected to standard RSVP/Intserv\n   processing.  It may be rejected if\
    \ resources on the downstream\n   interface of ER2 are deemed insufficient to\
    \ carry the resources\n   requested.  If it is not rejected, it will be carried\
    \ transparently\n   through the Diffserv network region, arriving at ER1.\n  \
    \ 8. In ER1, the RESV message triggers admission control processing.\n   ER1 compares\
    \ the resources requested in the RSVP/Intserv request to\n   the resources available\
    \ in the Diffserv network region at the\n   corresponding Diffserv service level.\
    \  The corresponding service\n   level is determined by the Intserv to Diffserv\
    \ mapping discussed\n   previously.  The availability of resources is determined\
    \ by the\n   capacity provisioned in the SLS.  ER1 may also apply a policy\n \
    \  decision such that the resource request may be rejected based on the\n   customer's\
    \ specific policy criteria, even though the aggregate\n   resources are determined\
    \ to be available per the SLS.\n   9. If ER1 approves the request, the RESV message\
    \ is admitted and is\n   allowed to continue upstream towards the sender.  If\
    \ it rejects the\n   request, the RESV is not forwarded and the appropriate RSVP\
    \ error\n   messages are sent.  If the request is approved, ER1 updates its\n\
    \   internal tables to indicate the reduced capacity available at the\n   admitted\
    \ service level on its transmit interface.\n   10. The RESV message proceeds through\
    \ the network region to which the\n   sender is attached.  Any RSVP node in this\
    \ region may reject the\n   reservation request due to inadequate resources or\
    \ policy.  If the\n   request is not rejected, the RESV message will arrive at\
    \ the sending\n   host, Tx.\n   11. At Tx, the QoS process receives the RESV message.\
    \  It interprets\n   receipt of the message as indication that the specified traffic\
    \ flow\n   has been admitted for the specified Intserv service type (in the\n\
    \   Intserv-capable nodes).  It may also learn the appropriate DSCP\n   marking\
    \ to apply to packets for this flow from information provided\n   in the RESV.\n\
    \   12. Tx may mark the DSCP in the headers of packets that are\n   transmitted\
    \ on the admitted traffic flow.  The DSCP may be the\n   default value which maps\
    \ to the Intserv service type specified in the\n   admitted RESV message, or it\
    \ may be a value explicitly provided in\n   the RESV.\n   In this manner, we obtain\
    \ end-to-end QoS through a combination of\n   networks that support RSVP/Intserv\
    \ and networks that support\n   Diffserv.\n"
- title: 4.2 RSVP-Aware Diffserv Network Region
  contents:
  - "4.2 RSVP-Aware Diffserv Network Region\n   In this example, the customer's edge\
    \ routers are standard RSVP\n   routers.  The border router, BR1 is RSVP aware.\
    \  In addition, there\n   may be other routers within the Diffserv network region\
    \ which are\n   RSVP aware.  Note that although these routers are able to participate\n\
    \   in some form of RSVP signaling, they classify and schedule traffic in\n  \
    \ aggregate, based on DSCP, not on the per-flow classification criteria\n   used\
    \ by standard RSVP/Intserv routers.  It can be said that their\n   control-plane\
    \ is RSVP while their data-plane is Diffserv.  This\n   approach exploits the\
    \ benefits of RSVP signaling while maintaining\n   much of the scalability associated\
    \ with Diffserv.\n   In the preceding example, there is no signaling between the\
    \ Diffserv\n   network region and network elements outside it.  The negotiation\
    \ of\n   an SLS is the only explicit exchange of resource availability\n   information\
    \ between the two network regions.  ER1 is configured with\n   the information\
    \ represented by the SLS and as such, is able to act as\n   an admission control\
    \ agent for the Diffserv network region.  Such\n   configuration does not readily\
    \ support dynamically changing SLSs,\n   since ER1 requires reconfiguration each\
    \ time the SLS changes.  It is\n   also difficult to make efficient use of the\
    \ resources in the Diffserv\n   network region.  This is because admission control\
    \ does not consider\n   the availability of resources in the Diffserv network\
    \ region along\n   the specific path that would be impacted.\n   By contrast,\
    \ when the Diffserv network region is RSVP aware, the\n   admission control agent\
    \ is part of the Diffserv network.  As a\n   result, changes in the capacity available\
    \ in the Diffserv network\n   region can be indicated to the Intserv-capable nodes\
    \ outside the\n   Diffserv region via RSVP.  By including routers interior to\
    \ the\n   Diffserv network region in RSVP signaling, it is possible to\n   simultaneously\
    \ improve the efficiency of resource usage within the\n   Diffserv region and\
    \ to improve the level of confidence that the\n   resources requested at admission\
    \ control are indeed available at this\n   particular point in time.  This is\
    \ because admission control can be\n   linked to the availability of resources\
    \ along the specific path that\n   would be impacted.  We refer to this benefit\
    \ of RSVP signaling as\n   \"topology aware admission control\".  A further benefit\
    \ of supporting\n   RSVP signaling within the Diffserv network region is that\
    \ it is\n   possible to effect changes in the provisioning of the Diffserv\n \
    \  network region (e.g., allocating more or less bandwidth to the EF\n   queue\
    \ in a router) in response to resource requests from outside of\n   the Diffserv\
    \ region.\n   Various mechanisms may be used within the Diffserv network region\
    \ to\n   support dynamic provisioning and topology aware admission control.\n\
    \   These include aggregated RSVP, per-flow RSVP and bandwidth brokers,\n   as\
    \ described in the following paragraphs.\n"
- title: 4.2.1 Aggregated or Tunneled RSVP
  contents:
  - "4.2.1 Aggregated or Tunneled RSVP\n   A number of documents [3,6,15,16] propose\
    \ mechanisms for extending\n   RSVP to reserve resources for an aggregation of\
    \ flows between edges\n   of a network.  Border routers may interact with core\
    \ routers and\n   other border routers using aggregated RSVP to reserve resources\n\
    \   between edges of the Diffserv network region.  Initial reservation\n   levels\
    \ for each service level may be established between major border\n   routers,\
    \ based on anticipated traffic patterns.  Border routers could\n   trigger changes\
    \ in reservation levels as a result of the cumulative\n   per-flow RSVP requests\
    \ from the non-Diffserv regions reaching high or\n   low-water marks.\n   In this\
    \ approach, admission of per-flow RSVP requests from nodes\n   outside the Diffserv\
    \ region would be counted against the appropriate\n   aggregate reservations for\
    \ the corresponding service level.  The size\n   of the aggregate reservations\
    \ may or may not be dynamically adjusted\n   to deal with the changes in per-flow\
    \ reservations.\n   The advantage of this approach is that it offers dynamic,\
    \ topology\n   aware admission control to the Diffserv network region without\n\
    \   requiring the level of RSVP signaling processing that would be\n   required\
    \ to support per-flow RSVP.\n   We note that resource management of a Diffserv\
    \ region using\n   aggregated RSVP is most likely to be feasible only within a\
    \ single\n   administrative domain, as each domain will probably choose its own\n\
    \   mechanism to manage its resources.\n"
- title: 4.2.3 Per-flow RSVP
  contents:
  - "4.2.3 Per-flow RSVP\n   In this approach, described in [3], routers in the Diffserv\
    \ network\n   region respond to the standard per-flow RSVP signaling originating\n\
    \   from the Intserv-capable nodes outside the Diffserv region.  This\n   approach\
    \ provides the benefits of the previous approach (dynamic,\n   topology aware\
    \ admission control) without requiring aggregated RSVP\n   support.  Resources\
    \ are also used more efficiently as a result of the\n   per-flow admission control.\
    \  However, the demands on RSVP signaling\n   resources within the Diffserv network\
    \ region may be significantly\n   higher than in an aggregated RSVP approach.\n\
    \   Note that per-flow RSVP and aggregated RSVP are not mutually\n   exclusive\
    \ in a single Diffserv region. It is possible to use per-flow\n   RSVP at the\
    \ edges of the Diffserv region and aggregation only in some\n   \"core\" region\
    \ within the Diffserv region.\n"
- title: 4.2.4 Granularity of Deployment of RSVP Aware Routers
  contents:
  - "4.2.4 Granularity of Deployment of RSVP Aware Routers\n   In 4.2.2 and 4.2.3\
    \ some subset of the routers within the Diffserv\n   network is RSVP signaling\
    \ aware (though traffic control is aggregated\n   as opposed to per-flow).  The\
    \ relative number of routers in the core\n   that participate in RSVP signaling\
    \ is a provisioning decision that\n   must be made by the network administrator.\n\
    \   In one extreme case, only the border routers participate in RSVP\n   signaling.\
    \  In this case, either the Diffserv network region must be\n   extremely over-provisioned\
    \ and therefore, inefficiently used, or else\n   it must be carefully and statically\
    \ provisioned for limited traffic\n   patterns.  The border routers must enforce\
    \ these patterns.\n   In the other extreme case, each router in the Diffserv network\
    \ region\n   might participate in RSVP signaling.  In this case, resources can\
    \ be\n   used with optimal efficiency, but signaling processing requirements\n\
    \   and associated overhead increase.  As noted above, RSVP aggregation\n   is\
    \ one way to limit the signaling overhead at the cost of some loss\n   of optimality\
    \ in resource utilization.\n   It is likely that some network administrators will\
    \ compromise by\n   enabling RSVP signaling on some subset of routers in the Diffserv\n\
    \   network region.  These routers will likely represent major traffic\n   switching\
    \ points with over-provisioned or statically provisioned\n   regions of RSVP unaware\
    \ routers between them.\n"
- title: 4.3 Dynamically Provisioned, Non-RSVP-aware Diffserv Region
  contents:
  - "4.3 Dynamically Provisioned, Non-RSVP-aware Diffserv Region\n   Border routers\
    \ might not use any form of RSVP signaling within the\n   Diffserv network region\
    \ but might instead use custom protocols to\n   interact with an \"oracle\". \
    \ The oracle is an agent that has\n   sufficient knowledge of resource availability\
    \ and network topology to\n   make admission control decisions.  The set of RSVP\
    \ aware routers in\n   the previous two examples can be considered collectively\
    \ as a form of\n   distributed oracle.  In various definitions of the \"bandwidth\
    \ broker\"\n   [4], it is able to act as a centralized oracle.\n"
- title: 5. Implications of the Framework for Diffserv Network Regions
  contents:
  - "5. Implications of the Framework for Diffserv Network Regions\n   We have described\
    \ a framework in which RSVP/Intserv style QoS can be\n   provided across end-to-end\
    \ paths that include Diffserv network\n   regions.  This section discusses some\
    \ of the implications of this\n   framework for the Diffserv network region.\n"
- title: 5.1 Requirements from Diffserv Network Regions
  contents:
  - "5.1 Requirements from Diffserv Network Regions\n   A Diffserv network region\
    \ must meet the following requirements in\n   order for it to support the framework\
    \ described in this document.\n   1. A Diffserv network region must be able to\
    \ provide support for the\n   standard Intserv QoS services between its border\
    \ routers.  It must be\n   possible to invoke these services by use of standard\
    \ PHBs within the\n   Diffserv region and appropriate behavior at the edge of\
    \ the Diffserv\n   region.\n   2. Diffserv network regions must provide admission\
    \ control\n   information to their \"customer\" (non-Diffserv) network regions.\
    \  This\n   information can be provided by a dynamic protocol or through static\n\
    \   service level agreements enforced at the edges of the Diffserv\n   region.\n\
    \   3. Diffserv network regions must be able to pass RSVP messages, in\n   such\
    \ a manner that they can be recovered at the egress of the\n   Diffserv network\
    \ region.  The Diffserv network region may, but is not\n   required to, process\
    \ these messages.  Mechanisms for transparently\n   carrying RSVP messages across\
    \ a transit network are described in\n   [3,6,15,16].\n   To meet these requirements,\
    \ additional work is required in the areas\n   of:\n   1. Mapping Intserv style\
    \ service specifications to services that can\n   be provided by Diffserv network\
    \ regions.\n   2. Definition of the functionality required in network elements\
    \ to\n   support RSVP signaling with aggregate traffic control (for network\n\
    \   elements residing in the Diffserv network region).\n   3. Definition of mechanisms\
    \ to efficiently and dynamically provision\n   resources in a Diffserv network\
    \ region (e.g., aggregated RSVP,\n   tunneling, MPLS, etc.).  This might include\
    \ protocols by which an\n   \"oracle\" conveys information about resource availability\
    \ within a\n   Diffserv region to border routers.  One example of such a mechanism\n\
    \   is the so-called \"bandwidth broker\" proposed in [19,20,21].\n"
- title: 5.2 Protection of Intserv Traffic from Other Traffic
  contents:
  - "5.2 Protection of Intserv Traffic from Other Traffic\n   Network administrators\
    \ must be able to share resources in the\n   Diffserv network region between three\
    \ types of traffic:\n   a. End-to-end Intserv traffic.  This is typically traffic\
    \ associated\n   with quantitative QoS applications.  It requires a specific quantity\n\
    \   of resources with a high degree of assurance.\n   b. Non-Intserv traffic.\
    \  The Diffserv region may allocate resources\n   to traffic that does not make\
    \ use of Intserv techniques to quantify\n   its requirements, e.g., through the\
    \ use of static provisioning and\n   SLSs enforced at the edges of the region.\
    \  Such traffic might be\n   associated with applications whose QoS requirements\
    \ are not readily\n   quantifiable but which require a \"better than best-effort\"\
    \ level of\n   service.\n   c. All other (best-effort) traffic.  These three classes\
    \ of traffic\n   must be isolated from each other by the appropriate configuration\
    \ of\n   policers and classifiers at ingress points to the Diffserv network\n\
    \   region, and by appropriate provisioning within the Diffserv network\n   region.\
    \  To provide protection for Intserv traffic in Diffserv\n   regions of the network,\
    \ we suggest that the DSCPs assigned to such\n   traffic not overlap with the\
    \ DSCPs assigned to other traffic.\n"
- title: 6. Multicast
  contents:
  - "6. Multicast\n   The use of integrated services over Diffserv networks is\n \
    \  significantly more complex for multicast sessions than for unicast\n   sessions.\
    \  With respect to a multicast connection, each participating\n   region has a\
    \ single ingress router and zero, one or several egress\n   routers.  The difficulties\
    \ of multicast are associated with Diffserv\n   regions that contain several egress\
    \ routers.  (Support of multicast\n   functionality outside the Diffserv region\
    \ is relatively\n   straightforward since every Intserv-capable router along the\n\
    \   multicast tree stores state for each flow.)\n   Consider the following reference\
    \ network:\n                                          Non-Diffserv region 2\n\
    \                                                    ________\n              \
    \                                     /        \\\n                          \
    \                        |          | |---|\n             ________         _____________\
    \       |          |-|Rx1|\n            /        \\       /          |--\\   \
    \   |---|      | |---|\n           /          \\     /          /|BR2\\-----\\\
    ER2|     /\n    |---| |        |---|   |---|  |--|/ |---|      \\--|____/\n  \
    \  |Tx |-|        |ER1|---|BR1|--|RR|      |       ________\n    |---| |     \
    \   |-- |   |---|  |--|\\ |---|      /--|     \\\n           \\          /   \
    \  \\          \\|BR3/-----|ER3|      | |---|\n            \\________/       \\\
    __________|--/      |---|      |-|Rx2|\n                                     \
    \             |          | |---|\n    Non-Diffserv region 1   Diffserv region\
    \        \\        /\n                                                    \\______/\n\
    \                                          Non-Diffserv region 3\n           Figure\
    \ 2: Sample Multicast Network Configuration\n   The reference network is similar\
    \ to that of Figure 1.  However, in\n   Figure 2, copies of the packets sent by\
    \ Tx are delivered to several\n   receivers outside of the Diffserv region, namely\
    \ to Rx1 and Rx2.\n   Moreover, packets are copied within the Diffserv region\
    \ in a \"branch\n   point\" router RR.  In the reference network BR1 is the ingress\
    \ router\n   to the Diffserv region whereas BR2 and BR3 are the egress routers.\n\
    \   In the simplest case the receivers, Rx1 and Rx2 in the reference\n   network,\
    \ require identical reservations.  The Diffserv framework [18]\n   supports service\
    \ level specifications (SLS) from an ingress router to\n   one, some or all of\
    \ the egress routers.  This calls for a \"one to\n   many\" SLS within the Diffserv\
    \ region, from BR1 to BR2 and BR3.  Given\n   that the SLS is granted by the Diffserv\
    \ region, the ingress router\n   BR1, or perhaps an upstream node such as ER1,\
    \ marks packets entering\n   the Diffserv region with the appropriate DSCP.  The\
    \ packets are\n   routed to the egresses of the Diffserv domain using the original\n\
    \   multicast address.\n   The two major problems, explained in the following,\
    \ are associated\n   with heterogeneous multicast trees containing branch points\
    \ within\n   the Diffserv region, i.e., multicast trees where the level of\n \
    \  resource requirement is not uniform among all receivers.  An example\n   of\
    \ such a scenario in the network of Figure 2 is the case where both\n   Rx1 and\
    \ Rx2 need to receive multicast data from Tx1 but only one of\n   the receivers\
    \ has requested a level of service above best effort.  We\n   consider such scenarios\
    \ in the following paragraphs.\n"
- title: 6.1 Remarking of packets in branch point routers
  contents:
  - "6.1 Remarking of packets in branch point routers\n   In the above scenario, the\
    \ packets that arrive at BR1 are marked with\n   an appropriate DSCP for the requested\
    \ Intserv service and are sent to\n   RR.  Packets arriving at the branch point\
    \ must be sent towards BR2\n   with the same DSCP otherwise the service to Rx1\
    \ is degraded.\n   However, the packets going from RR towards BR3 need not maintain\
    \ the\n   high assurance level anymore.  They may be demoted to best effort so\n\
    \   that the QoS provided to other packets along this branch of the tree\n   is\
    \ not disrupted.  Several problems can be observed in the given\n   scenario:\n\
    \        - In the Diffserv region, DSCP marking is done at edge routers\n    \
    \      (ingress), whereas a branch point router might be a core\n          router,\
    \ which does not mark packets.\n        - Being a core Diffserv router, RR classifies\
    \ based on\n          aggregate traffic streams (BA), as opposed to per flow (MF)\n\
    \          classification.  Hence, it does not necessarily have the\n        \
    \  capability to distinguish those packets which belong to a\n          specific\
    \ multicast tree and require demotion from the other\n          packets in the\
    \ behavior aggregate, which carry the same DSCP.\n        - Since RR may be RSVP-unaware,\
    \ it may not participate in the\n          admission control process, and would\
    \ thus not store any per-\n          flow state about the reservations for the\
    \ multicast tree.\n          Hence, even if RR were able to perform MF classification\
    \ and\n          DSCP remarking, it would not know enough about downstream\n \
    \         reservations to remark the DSCP intelligently.\n   These problems could\
    \ be addressed by a variety of mechanisms.  We\n   list some below, while noting\
    \ that none is ideal in all cases and\n   that further mechanisms may be developed\
    \ in the future:\n   1. If some Intserv-capable routers are placed within the\
    \ Diffserv\n   region, it might be possible to administer the network topology\
    \ and\n   routing parameters so as to ensure that branch points occur only\n \
    \  within such routers.  These routers would support MF classification\n   and\
    \ remarking and hold per-flow state for the heterogeneous\n   reservations for\
    \ which they are the branch point.  Note that in this\n   case, branch point routers\
    \ would have essentially the same\n   functionality as ingress routers of an RSVP-aware\
    \ Diffserv domain.\n   2. Packets sent on the \"non-reserved\" branch (from RR\
    \ towards BR3)\n   are marked with the \"wrong\" DSCP; that is, they are not demoted\
    \ to\n   best effort but retain their DSCP.  This in turn requires over\n   reservation\
    \ of resources along that link or runs the risk of\n   degrading service to packets\
    \ that legitimately bear the same DSCP\n   along this path.  However, it allows\
    \ the Diffserv routers to remain\n   free of per-flow state.\n   3. A combination\
    \ of mechanism 1 and 2 may be an effective compromise.\n   In this case, there\
    \ are some Intserv-capable routers in the core of\n   the network, but the network\
    \ cannot be administered so that ALL\n   branch points fall at such routers.\n\
    \   4. Administrators of Diffserv regions may decide not to enable\n   heterogeneous\
    \ sub-trees in their domains.  In the case of different\n   downstream reservations,\
    \ a ResvErr message would be sent according to\n   the RSVP rules.  This is similar\
    \ to the approach taken for Intserv\n   over IEEE 802 Networks [2,5].\n   5. In\
    \ [3], a scheme was introduced whereby branch point routers in\n   the interior\
    \ of the aggregation region (i.e., the Diffserv region)\n   keep reduced state\
    \ information regarding the reservations by using\n   measurement based admission\
    \ control.  Under this scheme, packets are\n   tagged by the more knowledgeable\
    \ Intserv edges routers with\n   scheduling information that is used in place\
    \ of the detailed Intserv\n   state.  If the Diffserv region and branch point\
    \ routers are designed\n   following that framework, demotion of packets becomes\
    \ possible.\n"
- title: 6.2 Multicast SLSs and Heterogeneous Trees
  contents:
  - "6.2 Multicast SLSs and Heterogeneous Trees\n   Multicast flows with heterogeneous\
    \ reservations present some\n   challenges in the area of SLSs.  For example,\
    \ a common example of an\n   SLS is one where a certain amount of traffic is allowed\
    \ to enter a\n   Diffserv region marked with a certain DSCP, and such traffic\
    \ may be\n   destined to any egress router of that region.  We call such an SLS\
    \ a\n   homogeneous, or uniform, SLS.  However, in a multicast environment, a\n\
    \   single packet that is admitted to the Diffserv region may consume\n   resources\
    \ along many paths in the region as it is replicated and\n   forwarded towards\
    \ many egress routers; alternatively, it may flow\n   along a single path.  This\
    \ situation is further complicated by the\n   possibility described above and\
    \ depicted in Figure 2, in which a\n   multicast packet might be treated as best\
    \ effort along some branches\n   while receiving some higher QOS treatment along\
    \ others.  We simply\n   note here that the specification of meaningful SLSs which\
    \ meet the\n   needs of heterogeneous flows and which can be met be providers\
    \ is\n   likely to be challenging.\n   Dynamic SLSs may help to address these\
    \ issues.  For example, by using\n   RSVP to signal the resources that are required\
    \ along different\n   branches of a multicast tree, it may be possible to more\
    \ closely\n   approach the goal of allocating appropriate resources only where\
    \ they\n   are needed rather than overprovisioning or underprovisioning along\n\
    \   certain branches of a tree.  This is essentially the approach\n   described\
    \ in [15].\n"
- title: 7. Security Considerations
  contents:
  - '7. Security Considerations

    '
- title: 7.1 General RSVP Security
  contents:
  - "7.1 General RSVP Security\n   We are proposing that RSVP signaling be used to\
    \ obtain resources in\n   both Diffserv and non-Diffserv regions of a network.\
    \  Therefore, all\n   RSVP security considerations apply [9].  In addition, network\n\
    \   administrators are expected to protect network resources by\n   configuring\
    \ secure policers at interfaces with untrusted customers.\n"
- title: 7.2 Host Marking
  contents:
  - "7.2 Host Marking\n   Though it does not mandate host marking of the DSCP, our\
    \ proposal\n   does allow it.  Allowing hosts to set the DSCP directly may alarm\n\
    \   network administrators.  The obvious concern is that hosts may\n   attempt\
    \ to \"steal\" resources.  In fact, hosts may attempt to exceed\n   negotiated\
    \ capacity in Diffserv network regions at a particular\n   service level regardless\
    \ of whether they invoke this service level\n   directly (by setting the DSCP)\
    \ or indirectly (by submitting traffic\n   that classifies in an intermediate\
    \ marking router to a particular\n   DSCP).\n   In either case, it will generally\
    \ be necessary for each Diffserv\n   network region to protect its resources by\
    \ policing to assure that\n   customers do not use more resources than they are\
    \ entitled to, at\n   each service level (DSCP).  The exception to this rule is\
    \ when the\n   host is known to be trusted, e.g., a server that is under the control\n\
    \   of the network administrators.  If an untrusted sending host does not\n  \
    \ perform DSCP marking, the boundary router (or trusted intermediate\n   routers)\
    \ must provide MF classification, mark and police.  If an\n   untrusted sending\
    \ host does perform marking, the boundary router\n   needs only to provide BA\
    \ classification and to police to ensure that\n   the customer is not exceeding\
    \ the aggregate capacity negotiated for\n   the service level.\n   In summary,\
    \ there are no additional security concerns raised by\n   marking the DSCP at\
    \ the edge of the network since Diffserv providers\n   will have to police at\
    \ their boundaries anyway.  Furthermore, this\n   approach reduces the granularity\
    \ at which border routers must police,\n   thereby pushing finer grain shaping\
    \ and policing responsibility to\n   the edges of the network, where it scales\
    \ better and provides other\n   benefits described in Section 3.3.1.  The larger\
    \ Diffserv network\n   regions are thus focused on the task of protecting their\
    \ networks,\n   while the Intserv-capable nodes are focused on the task of shaping\n\
    \   and policing their own traffic to be in compliance with their\n   negotiated\
    \ Intserv parameters.\n"
- title: 8. Acknowledgments
  contents:
  - "8. Acknowledgments\n   Authors thank the following individuals for their comments\
    \ that led\n   to improvements to the previous version(s) of this document: David\n\
    \   Oran, Andy Veitch, Curtis Villamizer, Walter Weiss, Francois le\n   Faucheur\
    \ and Russell White.\n   Many of the ideas in this document have been previously\
    \ discussed in\n   the original Intserv architecture document [10].\n"
- title: 9. References
  contents:
  - "9. References\n   [1]  Braden, R., Zhang, L., Berson, S., Herzog, S. and S. Jamin,\n\
    \        \"Resource Reservation Protocol (RSVP) Version 1 Functional\n       \
    \ Specification\", RFC 2205, September 1997.\n   [2]  Yavatkar, R., Hoffman, D.,\
    \ Bernet, Y., Baker, F. and M. Speer,\n        \"SBM (Subnet Bandwidth Manager):\
    \ A Protocol For RSVP-based\n        Admission Control Over IEEE 802 Style Networks\"\
    , RFC 2814, May\n        2000.\n   [3]  Berson, S. and R. Vincent, \"Aggregation\
    \ of Internet Integrated\n        Services State\", Work in Progress.\n   [4]\
    \  Nichols, K., Jacobson, V. and L. Zhang, \"A Two-bit\n        Differentiated\
    \ Services Architecture for the Internet\", RFC\n        2638, July 1999.\n  \
    \ [5]  Seaman, M., Smith, A., Crawley, E. and J. Wroclawski,\n        \"Integrated\
    \ Service Mappings on IEEE 802 Networks\", RFC 2815,\n        May 2000.\n   [6]\
    \  Guerin, R., Blake, S. and Herzog, S., \"Aggregating RSVP based\n        QoS\
    \ Requests\", Work in Progress.\n   [7]  Nichols, K., Blake, S., Baker, F. and\
    \ D. Black, \"Definition of\n        the Differentiated Services Field (DS Field)\
    \ in the IPv4 and\n        IPv6 Headers\", RFC 2474, December 1998.\n   [8]  Blake,\
    \ S., Black, D., Carlson, M., Davies, E., Wang, Z. and W.\n        Weiss, \"An\
    \ Architecture for Differentiated Services\", RFC 2475,\n        December 1998.\n\
    \   [9]  Baker, F., Lindell, B. and M. Talwar, \"RSVP Cryptographic\n        Authentication\"\
    , RFC 2747, January 2000.\n   [10] Braden, R., Clark, D. and S. Shenker, \"Integrated\
    \ Services in\n        the Internet Architecture: an Overview\", RFC 1633, June\
    \ 1994.\n   [11] Garrett, M. and M. Borden, \"Interoperation of Controlled-Load\n\
    \        Service and Guaranteed Service with ATM\", RFC 2381, August 1998.\n \
    \  [12] Weiss, Walter, Private communication, November 1998.\n   [13] Kent, S.\
    \ and R. Atkinson, \"Security Architecture for the\n        Internet Protocol\"\
    , RFC 2401, November 1998.\n   [14] Bernet, Y., \"Format of the RSVP DCLASS Object\"\
    , RFC 2996,\n        November 2000.\n   [15] Baker, F., Iturralde, C., le Faucheur,\
    \ F., and Davie, B. \"RSVP\n        Reservation Aggregation\", Work in Progress.\n\
    \   [16] Terzis, A., Krawczyk, J., Wroclawski, J. and L. Zhang, \"RSVP\n     \
    \   Operation Over IP Tunnels\", RFC 2746, January 2000.\n   [17] Boyle, J., Cohen,\
    \ R., Durham, D., Herzog, S., Rajan, D. and A.\n        Sastry, \"COPS Usage for\
    \ RSVP\", RFC 2749, January 2000.\n   [18] Bernet, Y., \"A Framework for Differentiated\
    \ Services\", Work in\n        Progress.\n   [19] Jacobson Van, \"Differentiated\
    \ Services Architecture\", talk in\n        the Int-Serv WG at the Munich IETF,\
    \ August 1997.\n   [20] Jacobson, V., Nichols K. and L. Zhang, \"A Two-bit Differentiated\n\
    \        Services Architecture for the Internet\", RFC 2638, June 1999.\n   [21]\
    \ First Internet2 bandwidth broker operability event\n        http://www.merit.edu/internet/working.groups/i2-qbone-bb/\n\
    \        inter-op/index.htm\n"
- title: 10. Authors' Addresses
  contents:
  - "10. Authors' Addresses\n   Yoram Bernet\n   Microsoft\n   One Microsoft Way\n\
    \   Redmond, WA 98052\n   Phone: +1 425-936-9568\n   EMail: yoramb@microsoft.com\n\
    \   Raj Yavatkar\n   Intel Corporation\n   JF3-206 2111 NE 25th. Avenue\n   Hillsboro,\
    \ OR 97124\n   Phone: +1 503-264-9077\n   EMail: raj.yavatkar@intel.com\n   Peter\
    \ Ford\n   Microsoft\n   One Microsoft Way\n   Redmond, WA 98052\n   Phone: +1\
    \ 425-703-2032\n   EMail: peterf@microsoft.com\n   Fred Baker\n   Cisco Systems\n\
    \   519 Lado Drive\n   Santa Barbara, CA 93111\n   Phone: +1 408-526-4257\n  \
    \ EMail: fred@cisco.com\n   Lixia Zhang\n   UCLA\n   4531G Boelter Hall\n   Los\
    \ Angeles, CA 90095\n   Phone: +1 310-825-2695\n   EMail: lixia@cs.ucla.edu\n\
    \   Michael Speer\n   Sun Microsystems\n   901 San Antonio Road, UMPK15-215\n\
    \   Palo Alto, CA 94303\n   Phone: +1 650-786-6368\n   EMail: speer@Eng.Sun.COM\n\
    \   Bob Braden\n   USC/Information Sciences Institute\n   4676 Admiralty Way\n\
    \   Marina del Rey, CA 90292-6695\n   Phone: +1 310-822-1511\n   EMail: braden@isi.edu\n\
    \   Bruce Davie\n   Cisco Systems\n   250 Apollo Drive\n   Chelmsford, MA 01824\n\
    \   Phone: +1 978-244-8000\n   EMail: bsd@cisco.com\n   Eyal Felstaine\n   SANRAD\
    \ Inc.\n   24 Raul Wallenberg st\n   Tel Aviv, Israel\n   Phone: +972-50-747672\n\
    \   Email: eyal@sanrad.com\n   John Wroclawski\n   MIT Laboratory for Computer\
    \ Science\n   545 Technology Sq.\n   Cambridge, MA  02139\n   Phone: +1 617-253-7885\n\
    \   EMail: jtw@lcs.mit.edu\n"
- title: 11.  Full Copyright Statement
  contents:
  - "11.  Full Copyright Statement\n   Copyright (C) The Internet Society (2000).\
    \  All Rights Reserved.\n   This document and translations of it may be copied\
    \ and furnished to\n   others, and derivative works that comment on or otherwise\
    \ explain it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
