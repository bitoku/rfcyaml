- contents:
  - "         Using IPsec to Protect Mobile IPv6 Signaling Between\n                      Mobile
    Nodes and Home Agents\n"
  title: __initial_text__
- contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol
    for the\n   Internet community, and requests discussion and suggestions for\n
    \  improvements.  Please refer to the current edition of the \"Internet\n   Official
    Protocol Standards\" (STD 1) for the standardization state\n   and status of this
    protocol.  Distribution of this memo is unlimited.\n"
  title: Status of this Memo
- contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2004).\n"
  title: Copyright Notice
- contents:
  - "Abstract\n   Mobile IPv6 uses IPsec to protect signaling between the home agent\n
    \  and the mobile node.  Mobile IPv6 base document defines the main\n   requirements
    these nodes must follow.  This document discusses these\n   requirements in more
    depth, illustrates the used packet formats,\n   describes suitable configuration
    procedures, and shows how\n   implementations can process the packets in the right
    order.\n"
  title: Abstract
- contents:
  - "Table of Contents\n   1.    Introduction . . . . . . . . . . . . . . . . . .
    . . . . . .  3\n   2.    Terminology  . . . . . . . . . . . . . . . . . . . .
    . . . .  5\n   3.    Packet Formats . . . . . . . . . . . . . . . . . . . . .
    . .  5\n         3.1   Binding Updates and Acknowledgements . . . . . . . . .
    \ 5\n         3.2   Return Routability Signaling . . . . . . . . . . . . .  7\n
    \        3.3   Prefix Discovery . . . . . . . . . . . . . . . . . . .  8\n         3.4
    \  Payload Packets  . . . . . . . . . . . . . . . . . . .  9\n   4.    Requirements
    . . . . . . . . . . . . . . . . . . . . . . . .  9\n         4.1   Mandatory Support
    \ . . . . . . . . . . . . . . . . . . 10\n         4.2   Policy Requirements  .
    . . . . . . . . . . . . . . . . 10\n         4.3   IPsec Protocol Processing  .
    . . . . . . . . . . . . . 13\n         4.4   Dynamic Keying . . . . . . . . .
    . . . . . . . . . . . 15\n   5.    Example Configurations . . . . . . . . . .
    . . . . . . . . . 16\n         5.1   Format . . . . . . . . . . . . . . . . .
    . . . . . . . 17\n         5.2   Manual Configuration . . . . . . . . . . . .
    . . . . . 18\n               5.2.1 Binding Updates and Acknowledgements . . .
    . . . 18\n               5.2.2 Return Routability Signaling . . . . . . . . .
    . 19\n               5.2.3 Prefix Discovery . . . . . . . . . . . . . . . . 20\n
    \              5.2.4 Payload Packets  . . . . . . . . . . . . . . . . 21\n         5.3
    \  Dynamic Keying . . . . . . . . . . . . . . . . . . . . 22\n               5.3.1
    Binding Updates and Acknowledgements . . . . . . 22\n               5.3.2 Return
    Routability Signaling . . . . . . . . . . 23\n               5.3.3 Prefix Discovery
    . . . . . . . . . . . . . . . . 24\n               5.3.4 Payload Packets  . .
    . . . . . . . . . . . . . . 25\n   6.    Processing Steps within a Node . . .
    . . . . . . . . . . . . 25\n         6.1   Binding Update to the Home Agent .
    . . . . . . . . . . 25\n         6.2   Binding Update from the Mobile Node  .
    . . . . . . . . 26\n         6.3   Binding Acknowledgement to the Mobile Node
    . . . . . . 27\n         6.4   Binding Acknowledgement from the Home Agent  .
    . . . . 28\n         6.5   Home Test Init to the Home Agent . . . . . . . . .
    . . 29\n         6.6   Home Test Init from the Mobile Node  . . . . . . . . .
    30\n         6.7   Home Test to the Mobile Node . . . . . . . . . . . . . 30\n
    \        6.8   Home Test from the Home Agent  . . . . . . . . . . . . 31\n         6.9
    \  Prefix Solicitation Message to the Home Agent  . . . . 31\n         6.10  Prefix
    Solicitation Message from the Mobile Node . . . 31\n         6.11  Prefix Advertisement
    Message to the Mobile Node  . . . 32\n         6.12  Prefix Advertisement Message
    from the Home Agent . . . 32\n         6.13  Payload Packet to the Home Agent
    . . . . . . . . . . . 32\n         6.14  Payload Packet from the Mobile Node  .
    . . . . . . . . 32\n         6.15  Payload Packet to the Mobile Node  . . . .
    . . . . . . 32\n         6.16  Payload Packet from the Home Agent . . . . . .
    . . . . 32\n         6.17  Establishing New Security Associations . . . . . .
    . . 32\n         6.18  Rekeying Security Associations . . . . . . . . . . . .
    33\n         6.19  Movements and Dynamic Keying . . . . . . . . . . . . . 34\n
    \  7.    Implementation Considerations  . . . . . . . . . . . . . . . 35\n         7.1
    \  IPsec  . . . . . . . . . . . . . . . . . . . . . . . . 35\n         7.2   IKE
    \ . . . . . . . . . . . . . . . . . . . . . . . . . 36\n         7.3   Bump-in-the-Stack
    \ . . . . . . . . . . . . . . . . . . 37\n   8.    IANA Considerations  . . .
    . . . . . . . . . . . . . . . . . 37\n   9.    Security Considerations  . . .
    . . . . . . . . . . . . . . . 37\n   10    References . . . . . . . . . . . .
    . . . . . . . . . . . . . 38\n         10.1  Normative References . . . . . .
    . . . . . . . . . . . 38\n         10.2  Informative References . . . . . . .
    . . . . . . . . . 38\n   11.   Acknowledgements . . . . . . . . . . . . . . .
    . . . . . . . 39\n   12.   Authors' Addresses . . . . . . . . . . . . . . . .
    . . . . . 39\n   13.   Full Copyright Statement . . . . . . . . . . . . . . .
    . . . 40\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   This document illustrates the use of IPsec in securing Mobile
    IPv6\n   [7] traffic between mobile nodes and home agents.  In Mobile IPv6, a\n
    \  mobile node is always expected to be addressable at its home address,\n   whether
    it is currently attached to its home link or is away from\n   home.  The \"home
    address\" is an IP address assigned to the mobile\n   node within its home subnet
    prefix on its home link.  While a mobile\n   node is at home, packets addressed
    to its home address are routed to\n   the mobile node's home link.\n   While a
    mobile node is attached to some foreign link away from home,\n   it is also addressable
    at a care-of address.  A care-of address is an\n   IP address associated with
    a mobile node that has a subnet prefix\n   from a particular foreign link.  The
    association between a mobile\n   node's home address and care-of address is known
    as a \"binding\" for\n   the mobile node.  While away from home, a mobile node
    registers its\n   primary care-of address with a router on its home link, requesting\n
    \  this router to function as the \"home agent\" for the mobile node.  The\n   mobile
    node performs this binding registration by sending a \"Binding\n   Update\" message
    to the home agent.  The home agent replies to the\n   mobile node by returning
    a \"Binding Acknowledgement\" message.\n   Any other nodes communicating with
    a mobile node are referred to as\n   \"correspondent nodes\".  Mobile nodes can
    provide information about\n   their current location to correspondent nodes, again
    using Binding\n   Updates and Acknowledgements.  Additionally, return routability
    test\n   is performed between the mobile node, home agent, and the\n   correspondent
    node in order to authorize the establishment of the\n   binding.  Packets between
    the mobile node and the correspondent node\n   are either tunneled via the home
    agent, or sent directly if a binding\n   exists in the correspondent node for
    the current location of the\n   mobile node.\n   Mobile IPv6 tunnels payload packets
    between the mobile node and the\n   home agent in both directions.  This tunneling
    uses IPv6\n   encapsulation [6].  Where these tunnels need to be secured, they
    are\n   replaced by IPsec tunnels [2].\n   Mobile IPv6 also provides support for
    the reconfiguration of the home\n   network.  Here, the home subnet prefixes may
    change over time.\n   Mobile nodes can learn new information about home subnet
    prefixes\n   through the \"prefix discovery\" mechanism.\n   This document discusses
    security mechanisms for the control traffic\n   between the mobile node and the
    home agent.  If this traffic is not\n   protected, mobile nodes and correspondent
    nodes are vulnerable to\n   man-in-the-middle, hijacking, passive wiretapping,
    impersonation, and\n   denial-of-service attacks.  Any third parties are also
    vulnerable to\n   denial-of-service attacks, for instance if an attacker could
    direct\n   the traffic flowing through the home agent to a innocent third party.\n
    \  These attacks are discussed in more detail in Section 15.1 of the\n   Mobile
    IPv6 base specification [7].\n   In order to avoid these attacks, the base specification
    uses IPsec\n   Encapsulating Security Payload (ESP) [3] to protect control traffic\n
    \  between the home agent and the mobile node.  This control traffic\n   consists
    of various messages carried by the Mobility Header protocol\n   in IPv6 [5].  The
    traffic takes the following forms:\n   o  Binding Update and Acknowledgement messages
    exchanged between the\n      mobile node and the home agent, as described in Sections
    10.3.1,\n      10.3.2, 11.7.1, and 11.7.3 of the base specification [7].\n   o
    \ Return routability messages Home Test Init and Home Test that pass\n      through
    the home agent on their way to a correspondent node, as\n      described in Section
    10.4.6 of the base specification [7].\n   o  ICMPv6 messages exchanged between
    the mobile node and the home\n      agent for the purposes of prefix discovery,
    as described in\n      Sections 10.6 and 11.4 of the base specification [7].\n
    \  The nodes may also optionally protect payload traffic passing through\n   the
    home agent, as described in Section 5.5 of the base specification\n   [7].  If
    multicast group membership control protocols or stateful\n   address autoconfiguration
    protocols are supported, payload data\n   protection support is required.\n   The
    control traffic between the mobile node and the home agent\n   requires message
    authentication, integrity, correct ordering and\n   anti-replay protection.  The
    mobile node and the home agent must have\n   an IPsec security association to
    protect this traffic.  IPsec does\n   not proving correct ordering of messages.
    \ Correct ordering of the\n   control traffic is ensured by a sequence number
    in the Binding Update\n   and Binding Acknowledgement messages.  The sequence
    number in the\n   Binding Updates also provides protection to a certain extent.
    \ It\n   fails in some scenarios, for example, if the Home Agent loses the\n   Binding
    Cache state.  Full protection against replay attacks is\n   possible only when
    IKE is used.\n   Great care is needed when using IKE [4] to establish security\n
    \  associations to Mobile IPv6 home agents.  The right kind of addresses\n   must
    be used for transporting IKE.  This is necessary to avoid\n   circular dependencies
    in which the use of a Binding Update triggers\n   the need for an IKE exchange
    that cannot complete prior to the\n   Binding Update having been completed.\n
    \  The mobile IPv6 base document defines the main requirements the\n   mobile
    nodes and home agents must follow when securing the above\n   traffic.  This document
    discusses these requirements in more depth,\n   illustrates the used packet formats,
    describes suitable configuration\n   procedures, and shows how implementations
    can process the packets in\n   the right order.\n   We begin our description by
    showing the required wire formats for the\n   protected packets in Section 3.
    \ Section 4 describes rules which\n   associated Mobile IPv6, IPsec, and IKE implementations
    must observe.\n   Section 5 discusses how to configure either manually keyed IPsec\n
    \  security associations or how to configure IKE to establish them\n   automatically.
    \ Section 6 shows examples of how packets are processed\n   within the nodes.\n
    \  All implementations of Mobile IPv6 mobile node and home agent MUST\n   support
    at least the formats described in Section 3 and obey the\n   rules in Section
    4.\n   The configuration and processing sections are informative, and should\n
    \  only be considered as one possible way of providing the required\n   functionality.\n
    \  Note that where this document indicates a feature MUST be supported\n   and
    SHOULD be used, this implies that all implementations must be\n   capable of using
    the specified feature, but there may be cases where,\n   for instance, a configuration
    option disables to use of the feature\n   in a particular situation.\n"
  title: 1.  Introduction
- contents:
  - "2.  Terminology\n   The keywords \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\",
    \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\"
    in this\n   document are to be interpreted as described in RFC 2119 [1].\n"
  title: 2.  Terminology
- contents:
  - '3.  Packet Formats

    '
  - contents:
    - "3.1.  Binding Updates and Acknowledgements\n   When the mobile node is away
      from its home, the BUs sent by it to the\n   home agent MUST support at least
      the following headers in the\n   following order:\n      IPv6 header (source
      = care-of address,\n                   destination = home agent)\n      Destination
      Options header\n         Home Address option (home address)\n      ESP header
      in transport mode\n      Mobility header\n         Binding Update\n            Alternate
      Care-of Address option (care-of address)\n   Note that the Alternate Care-of
      Address option is used to ensure that\n   the care-of address is protected by
      ESP.  The home agent considers\n   the address within this option as the current
      care-of address for the\n   mobile node.  The home address is not protected
      by ESP directly, but\n   the use of a specific home address with a specific
      security\n   association is required by policy.\n   The Binding Acknowledgements
      sent back to the mobile node when it is\n   away from home MUST support at least
      the following headers in the\n   following order:\n      IPv6 header (source
      = home agent,\n                   destination = care-of address)\n      Routing
      header (type 2)\n         home address\n      ESP header in transport mode\n
      \     Mobility header\n         Binding Acknowledgement\n   When the mobile
      node is at home, the above rules are different as the\n   mobile node can use
      its home address as a source address.  This\n   typically happens for the de-registration
      Binding Update when the\n   mobile is returning home.  In this situation, the
      Binding Updates\n   MUST support at least the following headers in the following
      order:\n      IPv6 header (source = home address,\n                   destination
      = home agent)\n      ESP header in transport mode\n      Mobility header\n         Binding
      Update\n   The Binding Acknowledgement messages sent to the home address MUST\n
      \  support at least the following headers in the following order:\n      IPv6
      header (source = home agent,\n                   destination = home address)\n
      \     ESP header in transport mode\n      Mobility header\n         Binding
      Acknowledgement\n"
    title: 3.1.  Binding Updates and Acknowledgements
  - contents:
    - "3.2.  Return Routability Signaling\n   When the Home Test Init messages tunneled
      to the home agent are\n   protected by IPsec, they MUST support at least the
      following headers\n   in the following order:\n      IPv6 header (source = care-of
      address,\n                   destination = home agent)\n      ESP header in
      tunnel mode\n      IPv6 header (source = home address,\n                   destination
      = correspondent node)\n      Mobility Header\n         Home Test Init\n   This
      format assumes that the mobile node's current care-of address is\n   used as
      the outer header destination address in the security\n   association.  As discussed
      in Section 4.3, this requires the home\n   agent to update the destination address
      when the mobile node moves.\n   Policy entries and security association selectors
      stay the same,\n   however, as the inner packets do not change upon movements.\n
      \  Note that there are trade-offs in using care-of addresses as the\n   destination
      addresses versus using the home address and attaching an\n   additional Home
      Address destination option and/or Routing header to\n   the packets.  The basis
      for requiring support for at least the\n   care-of address case has been discussed
      in Section 7.\n   Similarly, when the Home Test messages tunneled from the home
      agent\n   are protected by IPsec, they MUST support at least the following\n
      \  headers in the following order:\n      IPv6 header (source = home agent,\n
      \                  destination = care-of address)\n      ESP header in tunnel
      mode\n      IPv6 header (source = correspondent node,\n                   destination
      = home address)\n      Mobility Header\n         Home Test\n   The format used
      to protect return routability packets relies on the\n   destination of the tunnel
      packets to change for the mobile node as it\n   moves.  The home agent's address
      stays the same, but the mobile\n   node's address changes upon movements, as
      if the security\n   association's outer header destination address had changed.
      \ When the\n   mobile node adopts a new care-of address, it adopts also a new
      source\n   address for outgoing tunnel packets.  The home agent accepts packets\n
      \  sent like this, as the outer source address in tunnel packets is not\n   checked
      according to the rules in RFC 2401.  (We note, however, that\n   some implementations
      are known to make source address checks.) For a\n   discussion of the role of
      source addresses in outer tunnel headers,\n   see Section 5.1.2.1 of RFC 2401
      [2].  Note also that the home agent\n   requires the packets to be authenticated
      regardless of the source\n   address change, hence the \"new\" sender must possess
      the same keys for\n   the security association as it had in the previous location.
      \ This\n   proves that the sender is the same entity, regardless of the changes\n
      \  in the addresses.\n   The process is more complicated in the home agent side,
      as the home\n   agent has stored the previous care-of address in its Security\n
      \  Association Database as the outer header destination address.  When\n   IKE
      is being used, the mobile node runs it on top of its current\n   care-of address,
      and the resulting tunnel-mode security associations\n   will use the same addresses
      as IKE run over.  In order for the home\n   agent to be able to tunnel a Home
      Test message to the mobile node, it\n   uses the current care-of address as
      the destination of the tunnel\n   packets, as if the home agent had modified
      the outer header\n   destination address in the security association used for
      this\n   protection.  This implies that the same security association can be\n
      \  used in multiple locations, and no new configuration or\n   re-establishment
      of IKE phases is needed per movement.  Section 5.2.2\n   discusses the security
      policy and security association database\n   entries that are needed to accomplish
      this.\n"
    title: 3.2.  Return Routability Signaling
  - contents:
    - "3.3.  Prefix Discovery\n   If IPsec is used to protect prefix discovery, requests
      for prefixes\n   from the mobile node to the home agent MUST support at least
      the\n   following headers in the following order.\n      IPv6 header (source
      = care-of address,\n                   destination = home agent)\n      Destination
      Options header\n         Home Address option (home address)\n      ESP header
      in transport mode\n      ICMPv6\n         Mobile Prefix Solicitation\n   Again
      if IPsec is used, solicited and unsolicited prefix information\n   advertisements
      from the home agent to the mobile node MUST support at\n   least the following
      headers in the following order.\n      IPv6 header (source = home agent,\n                   destination
      = care-of address)\n      Routing header (type 2)\n         home address\n      ESP
      header in transport mode\n      ICMPv6\n         Mobile Prefix Advertisement\n"
    title: 3.3.  Prefix Discovery
  - contents:
    - "3.4.  Payload Packets\n   If IPsec is used to protect payload packets tunneled
      to the home\n   agent from the mobile node, we use a format similar to the one
      in\n   Section 3.2.  However, instead of the MobilityHeader, these packets\n
      \  may contain any legal IPv6 protocol(s):\n      IPv6 header (source = care-of
      address,\n                   destination = home agent)\n      ESP header in
      tunnel mode\n      IPv6 header (source = home address,\n                   destination
      = correspondent node)\n      Any protocol\n   Similarly, when the payload packets
      are tunneled from the home agent\n   to the mobile node with ESP encapsulation,
      they MUST support at least\n   the following headers in the following order:\n
      \     IPv6 header (source = home agent,\n                   destination = care-of
      address)\n      ESP header in tunnel mode\n      IPv6 header (source = correspondent
      node,\n                   destination = home address)\n      Any protocol\n"
    title: 3.4.  Payload Packets
  title: 3.  Packet Formats
- contents:
  - "4.  Requirements\n   This section describes mandatory rules for all Mobile IPv6
    mobile\n   nodes and home agents.  These rules are necessary in order for it to\n
    \  be possible to enable IPsec communications despite movements,\n   guarantee
    sufficient security, and to ensure correct processing order\n   of packets.\n
    \  The rules in the following sections apply only to the communications\n   between
    home agents and mobile nodes.  They should not be taken as\n   requirements on
    how IPsec in general is used by mobile nodes.\n"
  - contents:
    - "4.1.  Mandatory Support\n   The following requirements apply to both home agents
      and mobile\n   nodes:\n   o  Manual configuration of IPsec security associations
      MUST be\n      supported.  The configuration of the keys is expected to take\n
      \     place out-of-band, for instance at the time the mobile node is\n      configured
      to use its home agent.\n   o  Automatic key management with IKE [4] MAY be supported.
      \ Only\n      IKEv1 is discussed in this document.  Other automatic key\n      management
      mechanisms exist and will appear beyond IKEv1, but this\n      document does
      not address the issues related to them.\n   o  ESP encapsulation of Binding
      Updates and Acknowledgements between\n      the mobile node and home agent MUST
      be supported and MUST be used.\n   o  ESP encapsulation of the Home Test Init
      and Home Test messages\n      tunneled between the mobile node and home agent
      MUST be supported\n      and SHOULD be used.\n   o  ESP encapsulation of the
      ICMPv6 messages related to prefix\n      discovery MUST be supported and SHOULD
      be used.\n   o  ESP encapsulation of the payload packets tunneled between the\n
      \     mobile node and home agent MAY be supported and used.\n   o  If multicast
      group membership control protocols or stateful\n      address autoconfiguration
      protocols are supported, payload data\n      protection MUST be supported for
      those protocols.\n"
    title: 4.1.  Mandatory Support
  - contents:
    - "4.2.  Policy Requirements\n   The following requirements apply to both home
      agents and mobile\n   nodes:\n   o  As required in the base specification [7],
      when a packet destined\n      to the receiving node is matched against IPsec
      security policy or\n      selectors of a security association, an address appearing
      in a\n      Home Address destination option is considered as the source\n      address
      of the packet.\n      Note that the home address option appears before IPsec
      headers.\n      Section 11.3.2 of the base specification describes one possible\n
      \     implementation approach for this: The IPsec policy operations can\n      be
      performed at the time when the packet has not yet been modified\n      per Mobile
      IPv6 rules, or has been brought back to its normal form\n      after Mobile
      IPv6 processing.  That is, the processing of the Home\n      Address option
      is seen as a fixed transformation of the packets\n      that does not affect
      IPsec processing.\n   o  Similarly, a home address within a Type 2 Routing header
      destined\n      to the receiving node is considered as the destination address
      of\n      the packet, when a packet is matched against IPsec security policy\n
      \     or selectors of a security association.\n      Similar implementation
      considers apply to the Routing header\n      processing as was described above
      for the Home Address destination\n      option.\n   o  When IPsec is used to
      protect return routability signaling or\n      payload packets, this protection
      MUST only be applied to the\n      return routability packets entering the IPv6
      encapsulated tunnel\n      interface between the mobile node and the home agent.
      \ This can be\n      achieved, for instance, by defining the security policy
      database\n      entries specifically for the tunnel interface.  That is, the\n
      \     policy entries are not generally applied on all traffic on the\n      physical
      interface(s) of the nodes, but rather only on traffic\n      that enters this
      tunnel.\n   o  The authentication of mobile nodes MAY be based either on machine\n
      \     or user credentials.  Note that multi-user operating systems\n      typically
      allow all users of a node to use any of the IP addresses\n      assigned to
      the node.  This limits the capability of the home\n      agent to restrict the
      use of a home address to a particular user\n      in such environment.  Where
      user credentials are applied in a\n      multi-user environment, the configuration
      should authorize all\n      users of the node to control all home addresses
      assigned to the\n      node.\n   o  When the mobile node returns home and de-registers
      with the Home\n      Agent, the tunnel between the home agent and the mobile
      node's\n      care-of address is torn down.  The security policy entries, which\n
      \     were used for protecting tunneled traffic between the mobile node\n      and
      the home agent MUST be made inactive (for instance, by\n      removing them
      and installing them back later through an API).  The\n      corresponding security
      associations could be kept as they are or\n      deleted depending on how they
      were created.  If the security\n      associations were created dynamically
      using IKE, they are\n      automatically deleted when they expire.  If the security\n
      \     associations were created through manual configuration, they MUST\n      be
      retained and used later when the mobile node moves away from\n      home again.
      \ The security associations protecting Binding Updates\n      and Acknowledgements,
      and prefix discovery SHOULD NOT be deleted\n      as they do not depend on care-of
      addresses and can be used again.\n   The following rules apply to mobile nodes:\n
      \  o  The mobile node MUST use the Home Address destination option in\n      Binding
      Updates and Mobile Prefix Solicitations, sent to the home\n      agent from
      a care-of address.\n   o  When the mobile node receives a changed set of prefixes
      from the\n      home agent during prefix discovery, there is a need to configure\n
      \     new security policy entries, and there may be a need to configure\n      new
      security associations.  It is outside the scope of this\n      specification
      to discuss automatic methods for this.\n   The following rules apply to home
      agents:\n   o  The home agent MUST use the Type 2 Routing header in Binding\n
      \     Acknowledgements and Mobile Prefix Advertisements sent to the\n      mobile
      node, again due to the need to have the home address\n      visible when the
      policy checks are made.\n   o  It is necessary to avoid the possibility that
      a mobile node could\n      use its security association to send a Binding Update
      on behalf of\n      another mobile node using the same home agent.  In order
      to do\n      this, the security policy database entries MUST unequivocally\n
      \     identify a single security association for protecting Binding\n      Updates
      between any given home address and home agent when\n      manually keyed IPsec
      security associations are used.  When dynamic\n      keying is used, the security
      policy database entries MUST\n      unequivocally identify the IKE phase 1 credentials
      which can be\n      used to authorize the creation of security associations
      for\n      protecting Binding Updates for a particular home address.  How\n
      \     these mappings are maintained is outside the scope of this\n      specification,
      but they may be maintained, for instance, as a\n      locally administered table
      in the home agent.  If the phase 1\n      identity is a Fully Qualified Domain
      Name (FQDN), secure forms of\n      DNS may also be used.\n   o  When the set
      of prefixes advertised by the home agent changes,\n      there is a need to
      configure new security policy entries, and\n      there may be a need to configure
      new security associations.  It is\n      outside the scope of this specification
      to discuss automatic\n      methods for this, if new home addresses are required.\n"
    title: 4.2.  Policy Requirements
  - contents:
    - "4.3.  IPsec Protocol Processing\n   The following requirements apply to both
      home agents and mobile\n   nodes:\n   o  When securing Binding Updates, Binding
      Acknowledgements, and\n      prefix discovery, both the mobile nodes and the
      home agents MUST\n      support and SHOULD use the Encapsulating Security Payload
      (ESP)\n      [3] header in transport mode and MUST use a non-null payload\n
      \     authentication algorithm to provide data origin authentication,\n      connectionless
      integrity and optional anti-replay protection.\n      Mandatory support for
      encryption and integrity protection\n      algorithms is as defined in RFC 2401
      [2], RFC 2402 [8], and RFC\n      2406 [3].  Care is needed when selecting suitable
      encryption\n      algorithms for ESP, however.  Currently available integrity\n
      \     protection algorithms are in general considered to be secure.  The\n      encryption
      algorithm, DES, mandated by the current IPsec standards\n      is not, however.
      \ This is particularly problematic when IPsec\n      security associations are
      configured manually, as the same key is\n      used for a long time.\n   o  Tunnel
      mode IPsec ESP MUST be supported and SHOULD be used for the\n      protection
      of packets belonging to the return routability\n      procedure.  A non-null
      encryption transform and a non-null\n      authentication algorithm MUST be
      applied.\n      Note that the return routability procedure involves two message\n
      \     exchanges from the mobile node to the correspondent node.  The\n      purpose
      of these exchanges is to assure that the mobile node is\n      live at the claimed
      home and care-of addresses.  One of the\n      exchanges is sent directly to
      and from the correspondent node,\n      while another one is tunneled through
      the home agent.  If an\n      attacker is on the mobile node's link and the
      mobile node's\n      current link is an unprotected wireless link, the attacker
      would\n      able to see both sets of messages, and launch attacks based on
      it\n      (these attacks are discussed further in Section 15.4 of the base\n
      \     specification [7].)  One can prevent the attack by making sure\n      that
      the packets tunneled through the home agent are encrypted.\n      Note that
      this specification concerns itself only with on-the-wire\n      formats, and
      does not dictate specific implementations mechanisms.\n      In the case of
      IPsec tunnel mode, the use of IP-in-IP\n      encapsulation followed by IPsec
      transport mode encapsulation may\n      also be possible.\n   The following
      rules apply to mobile nodes:\n   o  When ESP is used to protect Binding Updates,
      there is no\n      protection for the care-of address which appears in the IPv6\n
      \     header outside the area protected by ESP.  It is important for the\n      home
      agent to verify that the care-of address has not been\n      tampered with.
      \ As a result, the attacker would have redirected\n      the mobile node's traffic
      to another address.  In order to prevent\n      this, Mobile IPv6 implementations
      MUST use the Alternate Care-of\n      Address mobility option in Binding Updates
      sent by mobile nodes\n      while away from home.  The exception to this is
      when the mobile\n      node returns home and sends a Binding Update to the home
      agent in\n      order to de-register.  In this case no Alternate Care-of Address\n
      \     option is needed, as described in Section 3.1.\n      When IPsec is used
      to protect return routability signaling or\n      payload packets, the mobile
      node MUST set the source address it\n      uses for the outgoing tunnel packets
      to the current primary care-\n      of address.  The mobile node starts to use
      a new primary care-of\n      address immediately after sending a Binding Update
      to the home\n      agent to register this new address.  Similarly, it starts
      to use\n      the new address as the required destination address of tunneled\n
      \     packets received from the home agent.\n   The following rules apply to
      home agents:\n   o  When IPsec is used to protect return routability signaling
      or\n      payload packets, IPsec security associations are needed to provide\n
      \     this protection.  When the care-of address for the mobile node\n      changes
      as a result of an accepted Binding Update, special\n      treatment is needed
      for the next packets sent using these security\n      associations.  The home
      agent MUST set the new care-of address as\n      the destination address of
      these packets, as if the outer header\n      destination address in the security
      association had changed.\n      Similarly, the home agent starts to expect the
      new source address\n      in the tunnel packets received from the mobile node.\n
      \     Such address changes can be implemented, for instance, through an\n      API
      from the Mobile IPv6 implementation to the IPsec\n      implementation.  It
      should be noted that the use of such an API\n      and the address changes MUST
      only be done based on the Binding\n      Updates received by the home agent
      and protected by the use of\n      IPsec.  Address modifications based on other
      sources, such as\n      Binding Updates to the correspondent nodes protected
      by return\n      routability, or open access to an API from any application
      may\n      result in security vulnerabilities.\n"
    title: 4.3.  IPsec Protocol Processing
  - contents:
    - "4.4.  Dynamic Keying\n   The following requirements apply to both home agents
      and mobile\n   nodes:\n   o  If anti-replay protection is required, dynamic
      keying MUST be\n      used.  IPsec can provide anti-replay protection only if
      dynamic\n      keying is used (which may not always be the case).  IPsec also\n
      \     does not guarantee correct ordering of packets, only that they\n      have
      not been replayed.  Because of this, sequence numbers within\n      the Mobile
      IPv6 messages are used to ensure correct ordering.\n      However, if the 16
      bit Mobile IPv6 sequence number space is cycled\n      through, or the home
      agent reboots and loses its state regarding\n      the sequence numbers, replay
      and reordering attacks become\n      possible.  The use of dynamic keying, IPsec
      anti-replay\n      protection, and the Mobile IPv6 sequence numbers can together\n
      \     prevent such attacks.\n   o  If IKE version 1 is used with preshared secrets
      in main mode, it\n      determines the shared secret to use from the IP address
      of the\n      peer.  With Mobile IPv6, however, this may be a care-of address\n
      \     and does not indicate which mobile node attempts to contact the\n      home
      agent.  Therefore, if preshared secret authentication is used\n      in IKEv1
      between the mobile node and the home agent then\n      aggressive mode MUST
      be used.  Note also that care needs to be\n      taken with phase 1 identity
      selection.  Where the ID_IPV6_ADDR\n      Identity Payloads is used, unambiguous
      mapping of identities to\n      keys is not possible.  (The next version of
      IKE may not have these\n      limitations.)\n   Note that the difficulties with
      main mode and preshared secrets in\n   IKE version 1 are well known for dynamic
      addresses.  With static\n   addresses, there has not been a problem.  With Mobile
      IPv6, however,\n   the use of the care-of addresses to run IKE to the home agent\n
      \  presents a problem even when the home address stays stable.  Further\n   discussion
      about the use of care-of addresses in this way appears in\n   Section 7.\n   The
      following rules apply to mobile nodes:\n   o  In addition to the rules above,
      if dynamic keying is used, the key\n      management protocol MUST use the care-of
      address as the source\n      address in the protocol exchanges with the mobile
      node's home\n      agent.\n   o  However, the IPsec security associations with
      the mobile node's\n      home agent use home addresses.  That is, the IPsec
      security\n      associations MUST be requested from the key management protocol\n
      \     using the home address of the mobile node as the client identity.\n      The
      security associations for protecting Binding Updates and\n      Acknowledgements
      are requested for the Mobility header protocol in\n      transport mode and
      for specific IP addresses as endpoints.  No\n      other selectors are used.
      \ Similarly, the security associations\n      for protecting prefix discovery
      are requested for the ICMPv6\n      protocol and the specific IP addresses,
      again without other\n      selectors.  Security associations for payload and
      return\n      routability protection are requested for a specific tunnel\n      interface
      and either the payload protocol or the Mobility header\n      protocol, in tunnel
      mode.  In this case one requested endpoint is\n      an IP address and the other
      one is a wildcard, and there are no\n      other selectors.\n   o  If the mobile
      node has used IKE version 1 to establish security\n      associations with its
      home agent, it should follow the procedures\n      discussed in Section 11.7.1
      and 11.7.3 of the base specification\n      [7] to determine whether the IKE
      endpoints can be moved or if IKE\n      phase 1 has to be re-established.\n
      \  The following rules apply to home agents:\n   o  If the home agent has used
      IKE version 1 to establish security\n      associations with the mobile node,
      it should follow the procedures\n      discussed in Section 10.3.1 and 10.3.2
      of the base specification\n      [7] to determine whether the IKE endpoints
      can be moved or if IKE\n      phase 1 has to be re-established.\n"
    title: 4.4.  Dynamic Keying
  title: 4.  Requirements
- contents:
  - "5.  Example Configurations\n   In the following we describe the Security Policy
    Database (SPD) and\n   Security Association Database (SAD) entries necessary to
    protect\n   Binding Updates and Binding Acknowledgements exchanged between the\n
    \  mobile node and the home agent.\n   Section 5.1 introduces the format we use
    in the description of the\n   SPD and the SAD.  Section 5.2 describes how to configure
    manually\n   keyed IPsec security associations without dynamic keying, and Section\n
    \  5.3 describes how to use dynamic keying.\n"
  - contents:
    - "5.1.  Format\n   The format used in the examples is as follows.  The SPD description\n
      \  has the format\n     <node> \"SPD OUT:\"\n       \"-\" <spdentry>\n       \"-\"
      <spdentry>\n       ...\n       \"-\" <spdentry>\n     <node> \"SPD IN:\"\n       \"-\"
      <spdentry>\n       \"-\" <spdentry>\n       ...\n       \"-\" <spdentry>\n   Where
      <node> represents the name of the node, and <spdentry> has the\n   following
      format:\n     \"IF\" <condition> \"THEN USE SA \" <sa> |\n     \"IF\" <condition>
      \"THEN USE SA \" <pattern> |\n   Where <condition> is a boolean expression about
      the fields of the\n   IPv6 packet, <sa> is the name of a specific security association,
      and\n   <pattern> is a specification for a security association to be\n   negotiated
      via IKE [4].  The SAD description has the format\n     <node> \"SAD:\"\n       \"-\"
      <sadentry>\n       \"-\" <sadentry>\n       ...\n       \"-\" <sadentry>\n   Where
      <node> represents the name of the node, and <sadentry> has the\n   following
      format:\n     <sa> \"(\" <dir> \",\"\n              <spi> \",\"\n              <destination>
      \",\"\n              <ipsec-proto> \",\"\n              <mode> \")\" \":\"\n
      \         <rule>\n   Where <dir> is \"IN\" or \"OUT\", <spi> is the SPI of the
      security\n   association, <destination> is its destination, <ipsec-proto> is
      in\n   our case \"ESP\", <mode> is either \"TUNNEL\" or \"TRANSPORT\", and <rule>\n
      \  is an expression which describes the IPsec selectors, i.e., which\n   fields
      of the IPv6 packet must have which values.\n   We will be using an example mobile
      node in this section with the home\n   address \"home_address_1\".  The user's
      identity in this mobile node is\n   \"user_1\".  The home agent's address is
      \"home_agent_1\".\n"
    title: 5.1.  Format
  - contents:
    - '5.2.  Manual Configuration

      '
    - contents:
      - "5.2.1.  Binding Updates and Acknowledgements\n   Here are the contents of
        the SPD and SAD for protecting Binding\n   Updates and Acknowledgements:\n
        \    mobile node SPD OUT:\n       - IF source = home_address_1 & destination
        = home_agent_1 &\n            proto = MH\n         THEN USE SA SA1\n     mobile
        node SPD IN:\n       - IF source = home_agent_1 & destination = home_address_1
        &\n            proto = MH\n         THEN USE SA SA2\n     mobile node SAD:\n
        \      - SA1(OUT, spi_a, home_agent_1, ESP, TRANSPORT):\n         source =
        home_address_1 & destination = home_agent_1 &\n         proto = MH\n       -
        SA2(IN, spi_b, home_address_1, ESP, TRANSPORT):\n         source = home_agent_1
        & destination = home_address_1 &\n         proto = MH\n     home agent SPD
        OUT:\n       - IF source = home_agent_1 & destination = home_address_1 &\n
        \           proto = MH\n         THEN USE SA SA2\n     home agent SPD IN:\n
        \      - IF source = home_address_1 & destination = home_agent_1 &\n            proto
        = MH\n         THEN USE SA SA1\n     home agent SAD:\n       - SA2(OUT, spi_b,
        home_address_1, ESP, TRANSPORT):\n         source = home_agent_1 & destination
        = home_address_1 &\n         proto = MH\n       - SA1(IN, spi_a, home_agent_1,
        ESP, TRANSPORT):\n         source = home_address_1 & destination = home_agent_1
        &\n         proto = MH\n   In the above, \"MH\" refers to the protocol number
        for the Mobility\n   Header [7].\n"
      title: 5.2.1.  Binding Updates and Acknowledgements
    - contents:
      - "5.2.2.  Return Routability Signaling\n   In the following we describe the
        necessary SPD and SAD entries to\n   protect return routability signaling
        between the mobile node and the\n   home agent.  Note that the rules in the
        SPD are ordered, and the ones\n   in the previous section must take precedence
        over these ones.  In\n   other words, the higher precedence entries must occur
        first in the\n   RFC 2401 [2] ordered list of SPD entries.\n     mobile node
        SPD OUT:\n       - IF interface = IPv6 IPv6 tunnel to home_agent_1 &\n            source
        = home_address_1 & destination = any &\n            proto = MH\n         THEN
        USE SA SA3\n     mobile node SPD IN:\n       - IF interface = IPv6 tunnel
        from home_agent_1 &\n            source = any & destination = home_address_1
        &\n            proto = MH\n         THEN USE SA SA4\n     mobile node SAD:\n
        \      - SA3(OUT, spi_c, home_agent_1, ESP, TUNNEL):\n         source = home_address_1
        & destination = any & proto = MH\n       - SA4(IN, spi_d, care_of_address_1,
        ESP, TUNNEL):\n         source = any & destination = home_address_1 & proto
        = MH\n     home agent SPD OUT:\n       - IF interface = IPv6 tunnel to home_address_1
        &\n            source = any & destination = home_address_1 &\n            proto
        = MH\n         THEN USE SA SA4\n     home agent SPD IN:\n       - IF interface
        = IPv6 tunnel from home_address_1 &\n            source = home_address_1 &
        destination = any &\n            proto = MH\n         THEN USE SA SA3\n     home
        agent SAD:\n       - SA4(OUT, spi_d, care_of_address_1, ESP, TUNNEL):\n         source
        = any & destination = home_address_1 & proto = MH\n       - SA3(IN, spi_c,
        home_agent_1, ESP, TUNNEL):\n         source = home_address_1 & destination
        = any & proto = MH\n   The security association from the home agent to the
        mobile node uses\n   the current care-of address as the destination.  As discussed\n
        \  earlier, this address is updated in the SAD as the mobile node moves.\n
        \  It can be initialized to the home address before the mobile node has\n
        \  registered.\n"
      title: 5.2.2.  Return Routability Signaling
    - contents:
      - "5.2.3.  Prefix Discovery\n   In the following we describe some additional
        SPD and SAD entries to\n   protect prefix discovery.  Note that the SPDs described
        above protect\n   all ICMPv6 traffic between the mobile node and the home
        agent, as\n   IPsec may not have the ability to distinguish between different\n
        \  ICMPv6 types.\n     mobile node SPD OUT:\n       - IF source = home_address_1
        & destination = home_agent_1 &\n            proto = ICMPv6\n         THEN
        USE SA SA5.\n     mobile node SPD IN:\n       - IF source = home_agent_1 &
        destination = home_address_1 &\n            proto = ICMPv6\n         THEN
        USE SA SA6\n     mobile node SAD:\n       - SA5(OUT, spi_e, home_agent_1,
        ESP, TRANSPORT):\n         source = home_address_1 & destination = home_agent_1
        &\n         proto = ICMPv6\n       - SA6(IN, spi_f, home_address_1, ESP, TRANSPORT):\n
        \        source = home_agent_1 & destination = home_address_1 &\n         proto
        = ICMPv6\n     home agent SPD OUT:\n       - IF source = home_agent_1 & destination
        = home_address_1 &\n            proto = ICMPv6\n         THEN USE SA SA6\n
        \    home agent SPD IN:\n       - IF source = home_address_1 & destination
        = home_agent_1 &\n            proto = ICMPv6\n         THEN USE SA SA5\n     home
        agent SAD:\n       - SA6(OUT, spi_f, home_address_1, ESP, TRANSPORT):\n         source
        = home_agent_1 & destination = home_address_1 &\n         proto = ICMPv6\n
        \      - SA5(IN, spi_e, home_agent_1, ESP, TRANSPORT):\n         source =
        home_address_1 & destination = home_agent_1 &\n         proto = ICMPv6\n"
      title: 5.2.3.  Prefix Discovery
    - contents:
      - "5.2.4.  Payload Packets\n   It is also possible to perform some additional,
        optional, protection\n   of tunneled payload packets.  This protection takes
        place in a\n   similar manner to the return routability protection above,
        but\n   requires a different value for the protocol field.  The necessary
        SPD\n   and SAD entries are shown below.  It is assumed that the entries for\n
        \  protecting Binding Updates and Acknowledgements, and the entries to\n   protect
        Home Test Init and Home Test messages take precedence over\n   these entries.\n
        \    mobile node SPD OUT:\n       - IF interface = IPv6 tunnel to home_agent_1
        &\n            source = home_address_1 & destination = any &\n            proto
        = X\n         THEN USE SA SA7\n     mobile node SPD IN:\n       - IF interface
        = IPv6 tunnel from home_agent_1 &\n            source = any & destination
        = home_address_1 &\n            proto = X\n         THEN USE SA SA8\n     mobile
        node SAD:\n       - SA7(OUT, spi_g, home_agent_1, ESP, TUNNEL):\n         source
        = home_address_1 & destination = any & proto = X\n       - SA8(IN, spi_h,
        care_of_address_1, ESP, TUNNEL):\n         source = any & destination = home_address_1
        & proto = X\n     home agent SPD OUT:\n       - IF interface = IPv6 tunnel
        to home_address_1 &\n            source = any & destination = home_address_1
        &\n            proto = X\n         THEN USE SA SA8\n     home agent SPD IN:\n
        \      - IF interface = IPv6 tunnel from home_address_1 &\n            source
        = home_address_1 & destination = any &\n            proto = X\n         THEN
        USE SA SA7\n     home agent SAD:\n       - SA8(OUT, spi_h, care_of_address_1,
        ESP, TUNNEL):\n         source = any & destination = home_address_1 & proto
        = X\n       - SA7(IN, spi_g, home_agent_1, ESP, TUNNEL):\n         source
        = home_address_1 & destination = any & proto = X\n   If multicast group membership
        control protocols such as MLDv1 [9] or\n   MLDv2 [11] need to be protected,
        these packets may use a link-local\n   address rather than the home address
        of the mobile node.  In this\n   case the source and destination can be left
        as a wildcard and the SPD\n   entries will work solely based on the used interface
        and the\n   protocol, which is ICMPv6 for both MLDv1 and MLDv2.\n   Similar
        problems are encountered when stateful address\n   autoconfiguration protocols
        such as DHCPv6 [10] are used.  The same\n   approach is applicable for DHCPv6
        as well.  DHCPv6 uses the UDP\n   protocol.\n   Support for multiple layers
        of encapsulation (such as ESP\n   encapsulated in ESP) is not required by
        RFC 2401 [2] and is also\n   otherwise often problematic.  It is therefore
        useful to avoid setting\n   the protocol X in the above entries to either
        AH or ESP.\n"
      title: 5.2.4.  Payload Packets
    title: 5.2.  Manual Configuration
  - contents:
    - "5.3.  Dynamic Keying\n   In this section we show an example configuration that
      uses IKE to\n   negotiate security associations.\n"
    - contents:
      - "5.3.1.  Binding Updates and Acknowledgements\n   Here are the contents of
        the SPD for protecting Binding Updates and\n   Acknowledgements:\n     mobile
        node SPD OUT:\n       - IF source = home_address_1 & destination = home_agent_1
        &\n            proto = MH\n         THEN USE SA ESP TRANSPORT: local phase
        1 identity = user_1\n     mobile node SPD IN:\n       - IF source = home_agent_1
        & destination = home_address_1 &\n            proto = MH\n         THEN USE
        SA ESP TRANSPORT: local phase 1 identity = user_1\n     home agent SPD OUT:\n
        \      - IF source = home_agent_1 & destination = home_address_1 &\n            proto
        = MH\n         THEN USE SA ESP TRANSPORT: peer phase 1 identity = user_1\n
        \    home agent SPD IN:\n       - IF source = home_address_1 & destination
        = home_agent_1 &\n            proto = MH\n         THEN USE SA ESP TRANSPORT:
        peer phase 1 identity = user_1\n   We have omitted details of the proposed
        transforms in the above, and\n   all details related to the particular authentication
        method such as\n   certificates beyond listing a specific identity that must
        be used.\n   We require IKE version 1 to be run using the care-of addresses
        but\n   still negotiate IPsec SAs that use home addresses.  The extra\n   conditions
        set by the home agent SPD for the peer phase 1 identity to\n   be \"user_1\"
        must be verified by the home agent.  The purpose of the\n   condition is to
        ensure that the IKE phase 2 negotiation for a given\n   user's home address
        can not be requested by another user.  In the\n   mobile node, we simply set
        our local identity to be \"user_1\".\n   These checks also imply that the
        configuration of the home agent is\n   user-specific: every user or home address
        requires a specific\n   configuration entry.  It would be possible to alleviate
        the\n   configuration tasks by using certificates that have home addresses
        in\n   the Subject AltName field.  However, it is not clear if all IKE\n   implementations
        allow one address to be used for carrying the IKE\n   negotiations when another
        address is mentioned in the used\n   certificates.  In any case, even this
        approach would have required\n   user-specific tasks in the certification
        authority.\n"
      title: 5.3.1.  Binding Updates and Acknowledgements
    - contents:
      - "5.3.2.  Return Routability Signaling\n   Protection for the return routability
        signaling can be configured in\n   a similar manner as above.\n     mobile
        node SPD OUT:\n       - IF interface = IPv6 tunnel to home_agent_1 &\n            source
        = home_address_1 & destination = any &\n            proto = MH\n         THEN
        USE SA ESP TUNNEL: outer destination = home_agent_1 &\n                                 local
        phase 1 identity = user_1\n     mobile node SPD IN:\n       - IF interface
        = IPv6 tunnel from home_agent_1 &\n            source = any & destination
        = home_address_1 &\n            proto = MH\n         THEN USE SA ESP TUNNEL:
        outer destination = home_agent_1 &\n                                 local
        phase 1 identity = user_1\n     home agent SPD OUT:\n       - IF interface
        = IPv6 tunnel to home_address_1 &\n            source = any & destination
        = home_address_1 &\n            proto = MH\n         THEN USE SA ESP TUNNEL:
        outer destination = home_address_1 &\n                                 peer
        phase 1 identity = user_1\n     home agent SPD IN:\n       - IF interface
        = IPv6 tunnel from home_address_1 &\n            source = home_address_1 &
        destination = any &\n            proto = MH\n         THEN USE SA ESP TUNNEL:
        outer destination = home_address_1 &\n                                 peer
        phase 1 identity = user_1\n   The security association from the home agent
        to the mobile node uses\n   the current care-of address as the destination.
        \ As discussed\n   earlier, this address is updated in the SAD as the mobile
        node moves.\n   The SPD entries can be written using the home address (as
        above), if\n   the care-of address update in the SAD is also done upon the
        creation\n   of security associations.\n"
      title: 5.3.2.  Return Routability Signaling
    - contents:
      - "5.3.3.  Prefix Discovery\n   In the following we describe some additional
        SPD entries to protect\n   prefix discovery with IKE.  (Note that when actual
        new prefixes are\n   discovered, there may be a need to enter new manually
        configured SPD\n   entries to specify the authorization policy for the resulting
        new\n   home addresses.)\n     mobile node SPD OUT:\n       - IF source =
        home_address_1 & destination = home_agent_1 &\n            proto = ICMPv6\n
        \        THEN USE SA ESP TRANSPORT: local phase 1 identity = user_1\n     mobile
        node SPD IN:\n       - IF source = home_agent_1 & destination = home_address_1
        &\n            proto = ICMPv6\n         THEN USE SA ESP TRANSPORT: local phase
        1 identity = user_1\n     home agent SPD OUT:\n       - IF source = home_agent_1
        & destination = home_address_1 &\n            proto = ICMPv6\n         THEN
        USE SA ESP TRANSPORT: peer phase 1 identity = user_1\n     home agent SPD
        IN:\n       - IF source = home_address_1 & destination = home_agent_1 &\n
        \           proto = ICMPv6\n         THEN USE SA ESP TRANSPORT: peer phase
        1 identity = user_1\n"
      title: 5.3.3.  Prefix Discovery
    - contents:
      - "5.3.4.  Payload Packets\n   Protection for the payload packets happens similarly
        to the\n   protection of return routability signaling.  As in the manually
        keyed\n   case, these SPD entries have lower priority than the above ones.\n
        \     mobile node SPD OUT:\n        - IF interface = IPv6 tunnel to home_agent_1
        &\n             source = home_address_1 & destination = any &\n             proto
        = X\n          THEN USE SA ESP TUNNEL: outer destination = home_agent_1 &\n
        \                                 local phase 1 identity = user_1\n      mobile
        node SPD IN:\n        - IF interface = IPv6 tunnel from home_agent_1 &\n             source
        = any & destination = home_address_1 &\n             proto = X\n          THEN
        USE SA ESP TUNNEL: outer destination = home_agent_1 &\n                                  local
        phase 1 identity = user_1\n      home agent SPD OUT:\n        - IF interface
        = IPv6 tunnel to home_address_1 &\n             source = any & destination
        = home_address_1 &\n             proto = X\n          THEN USE SA ESP TUNNEL:
        outer destination = home_address_1 &\n                                  peer
        phase 1 identity = user_1\n      home agent SPD IN:\n        - IF interface
        = IPv6 tunnel from home_address_1 &\n             source = home_address_1
        & destination = any &\n             proto = X\n          THEN USE SA ESP TUNNEL:
        outer destination = home_address_1 &\n                                  peer
        phase 1 identity = user_1\n"
      title: 5.3.4.  Payload Packets
    title: 5.3.  Dynamic Keying
  title: 5.  Example Configurations
- contents:
  - '6.  Processing Steps within a Node

    '
  - contents:
    - "6.1.  Binding Update to the Home Agent\n   Step 1.  At the mobile node, Mobile
      IPv6 module first produces the\n   following packet:\n      IPv6 header (source
      = home address,\n                   destination = home agent)\n      Mobility
      header\n         Binding Update\n   Step 2.  This packet is matched against
      the IPsec SPD on the mobile\n   node and we make a note that IPsec must be applied.\n
      \  Step 3.  Then, we add the necessary Mobile IPv6 options but do not\n   change
      the addresses yet, as described in Section 11.3.2 of the base\n   specification
      [7].  This results in:\n      IPv6 header (source = home address,\n                   destination
      = home agent)\n      Destination Options header\n         Home Address option
      (care-of address)\n      Mobility header\n         Binding Update\n   Step 4.
      \ Finally, IPsec headers are added and the necessary\n   authenticator values
      are calculated:\n      IPv6 header (source = home address,\n                   destination
      = home agent)\n      Destination Options header\n         Home Address option
      (care-of address)\n      ESP header (SPI = spi_a)\n      Mobility header\n         Binding
      Update\n   Here spi_a is the SPI value that was either configured manually,
      or\n   agreed upon in an earlier IKE negotiation.\n   Step 5.  Before sending
      the packet, the addresses in the IPv6 header\n   and the Destination Options
      header are changed:\n      IPv6 header (source = care-of address,\n                   destination
      = home agent)\n      Destination Options header\n         Home Address option
      (home address)\n      ESP header (SPI = spi_a)\n      Mobility header\n         Binding
      Update\n"
    title: 6.1.  Binding Update to the Home Agent
  - contents:
    - "6.2.  Binding Update from the Mobile Node\n   Step 1.  The following packet
      is received at the home agent:\n      IPv6 header (source = care-of address,\n
      \                  destination = home agent)\n      Destination Options header\n
      \        Home Address option (home address)\n      ESP header (SPI = spi_a)\n
      \     Mobility header\n         Binding Update\n   Step 2.  The home address
      option is processed first, which results in\n      IPv6 header (source = home
      address,\n                   destination = home agent)\n      Destination Options
      header\n         Home Address option (care-of address)\n      ESP header (SPI
      = spi_a)\n      Mobility header\n         Binding Update\n   Step 3.  ESP header
      is processed next, resulting in\n       IPv6 header (source = home address,\n
      \                   destination = home agent)\n       Destination Options header\n
      \         Home Address option (care-of address)\n       Mobility header\n          Binding
      Update\n   Step 4.  This packet matches the policy required for this security\n
      \  association (source = home address, destination = home agent, proto =\n   MH).\n
      \  Step 5.  Mobile IPv6 processes the Binding Update.  The Binding\n   Update
      is delivered to the Mobile IPv6 module.\n   Step 6.  If there are any security
      associations in the security\n   association database for the protection of
      return routability or\n   payload packets for this mobile node, those security
      associations are\n   updated with the new care-of address.\n"
    title: 6.2.  Binding Update from the Mobile Node
  - contents:
    - "6.3.  Binding Acknowledgement to the Mobile Node\n   Step 1.  Mobile IPv6 produces
      the following packet:\n      IPv6 header (source = home agent,\n                   destination
      = home address)\n      Mobility header\n         Binding Acknowledgement\n   Step
      2.  This packet matches the IPsec policy entries, and we\n   remember that IPsec
      has to be applied.\n   Step 3.  Then, we add the necessary Route Headers but
      do not change\n   the addresses yet, as described in Section 9.5.4 of the base\n
      \  specification [7].  This results in:\n      IPv6 header (source = home agent,\n
      \                  destination = home address)\n      Routing header (type 2)\n
      \        care-of address\n      Mobility header\n         Binding Acknowledgement\n
      \  Step 4.  We apply IPsec:\n      IPv6 header (source = home agent,\n                   destination
      = home address)\n      Routing header (type 2)\n         care-of address\n      ESP
      header (SPI = spi_b)\n      Mobility header\n         Binding Acknowledgement\n
      \  Step 5.  Finally, before sending the packet out we change the\n   addresses
      in the IPv6 header and the Route header:\n      IPv6 header (source = home agent,\n
      \                  destination = care-of address)\n      Routing header (type
      2)\n         home address\n      ESP header (SPI = spi_b)\n      Mobility header\n
      \        Binding Acknowledgement\n"
    title: 6.3.  Binding Acknowledgement to the Mobile Node
  - contents:
    - "6.4.  Binding Acknowledgement from the Home Agent\n   Step 1.  The following
      packet is received at the mobile node\n      IPv6 header (source = home agent,\n
      \                  destination = care-of address)\n      Routing header (type
      2)\n         home address\n      ESP header (SPI = spi_b)\n      Mobility header\n
      \        Binding Acknowledgement\n   Step 2.  After the routing header is processed
      the packet becomes\n      IPv6 header (source = home agent,\n                   destination
      = home address)\n      Routing header (type 2)\n         care-of address\n      ESP
      header (SPI = spi_b)\n      Mobility header\n         Binding Acknowledgement\n
      \  Step 3.  ESP header is processed next, resulting in:\n      IPv6 header (source
      = home agent,\n                   destination = home address)\n      Routing
      header (type 2)\n         care-of address\n      Mobility header\n         Binding
      Acknowledgement\n   Step 4.  This packet matches the policy required for this
      security\n   association (source = home agent, destination = home address, proto
      =\n   MH).\n   Step 5.  The Binding Acknowledgement is delivered to the Mobile
      IPv6\n   module.\n"
    title: 6.4.  Binding Acknowledgement from the Home Agent
  - contents:
    - "6.5.  Home Test Init to the Home Agent\n   Step 1.  The mobile node constructs
      a Home Test Init message:\n      IPv6 header (source = home address,\n                   destination
      = correspondent node)\n      Mobility header\n         Home Test Init\n   Step
      2.  Mobile IPv6 determines that this packet should go to the\n   tunnel to the
      home agent.\n   Step 3.  The packet is matched against IPsec policy entries
      for the\n   interface, and we find that IPsec needs to be applied.\n   Step
      4.  IPsec tunnel mode headers are added.  Note that we use a\n   care-of address
      as a source address for the tunnel packet.\n      IPv6 header (source = care-of
      address,\n                   destination = home agent)\n      ESP header (SPI
      = spi_c)\n      IPv6 header (source = home address,\n                   destination
      = correspondent node)\n      Mobility header\n         Home Test Init\n   Step
      5.  The packet is sent directly to the home agent using IPsec\n   encapsulation.\n"
    title: 6.5.  Home Test Init to the Home Agent
  - contents:
    - "6.6.  Home Test Init from the Mobile Node\n   Step 1.  The home agent receives
      the following packet:\n      IPv6 header (source = care-of address,\n                   destination
      = home agent)\n      ESP header (SPI = spi_c)\n      IPv6 header (source = home
      address,\n                   destination = correspondent node)\n      Mobility
      Header\n         Home Test Init\n   Step 2.  IPsec processing is performed,
      resulting in:\n      IPv6 header (source = home address,\n                   destination
      = correspondent node)\n      Mobility Header\n         Home Test Init\n   Step
      3.  The resulting packet matches the policy required for this\n   security association
      and the packet can be processed further.\n   Step 4.  The packet is then forwarded
      to the correspondent node.\n"
    title: 6.6.  Home Test Init from the Mobile Node
  - contents:
    - "6.7.  Home Test to the Mobile Node\n   Step 1.  The home agent receives a Home
      Test packet from the\n   correspondent node:\n      IPv6 header (source = correspondent
      node,\n                   destination = home address)\n      Mobility Header\n
      \        Home Test Init\n   Step 2.  The home agent determines that this packet
      is destined to a\n   mobile node that is away from home, and decides to tunnel
      it.\n   Step 3.  The packet matches the IPsec policy entries for the tunnel\n
      \  interface, and we note that IPsec needs to be applied.\n   Step 4.  IPsec
      is applied, resulting in a new packet.  Note that the\n   home agent must keep
      track of the location of the mobile node, and\n   update the tunnel endpoint
      address in the security association(s)\n   accordingly.\n      IPv6 header (source
      = home agent,\n                   destination = care-of address)\n      ESP
      header (SPI = spi_d)\n      IPv6 header (source = correspondent node,\n                   destination
      = home address)\n      Mobility Header\n         Home Test Init\n   Step 5.
      \ The packet is sent directly to the care-of address using\n   IPsec encapsulation.\n"
    title: 6.7.  Home Test to the Mobile Node
  - contents:
    - "6.8.  Home Test from the Home Agent\n   Step 1.  The mobile node receives the
      following packet:\n      IPv6 header (source = home agent,\n                   destination
      = care-of address)\n      ESP header (SPI = spi_d)\n      IPv6 header (source
      = correspondent node,\n                   destination = home address)\n      Mobility
      Header\n         Home Test Init\n   Step 2.  IPsec is processed, resulting in:\n
      \     IPv6 header (source = correspondent node,\n                   destination
      = home address)\n      Mobility Header\n         Home Test Init\n   Step 3.
      \ This matches the policy required for this security\n   association (source
      = any, destination = home address).\n   Step 4.  The packet is given to Mobile
      IPv6 processing.\n"
    title: 6.8.  Home Test from the Home Agent
  - contents:
    - "6.9.  Prefix Solicitation Message to the Home Agent\n   This procedure is similar
      to the one presented in Section 6.1.\n"
    title: 6.9.  Prefix Solicitation Message to the Home Agent
  - contents:
    - "6.10.  Prefix Solicitation Message from the Mobile Node\n   This procedure
      is similar to the one presented in Section 6.2.\n"
    title: 6.10.  Prefix Solicitation Message from the Mobile Node
  - contents:
    - "6.11.  Prefix Advertisement Message to the Mobile Node\n   This procedure is
      similar to the one presented in Section 6.3.\n"
    title: 6.11.  Prefix Advertisement Message to the Mobile Node
  - contents:
    - "6.12.  Prefix Advertisement Message from the Home Agent\n   This procedure
      is similar to the one presented in Section 6.4.\n"
    title: 6.12.  Prefix Advertisement Message from the Home Agent
  - contents:
    - "6.13.  Payload Packet to the Home Agent\n   This procedure is similar to the
      one presented in Section 6.5.\n"
    title: 6.13.  Payload Packet to the Home Agent
  - contents:
    - "6.14.  Payload Packet from the Mobile Node\n   This procedure is similar to
      the one presented in Section 6.6.\n"
    title: 6.14.  Payload Packet from the Mobile Node
  - contents:
    - "6.15.  Payload Packet to the Mobile Node\n   This procedure is similar to the
      one presented in Section 6.7.\n"
    title: 6.15.  Payload Packet to the Mobile Node
  - contents:
    - "6.16.  Payload Packet from the Home Agent\n   This procedure is similar to
      the one presented in Section 6.8.\n"
    title: 6.16.  Payload Packet from the Home Agent
  - contents:
    - "6.17.  Establishing New Security Associations\n   Step 1.  The mobile node
      wishes to send a Binding Update to the home\n   agent.\n     IPv6 header (source
      = home address,\n                  destination = home agent)\n     Mobility
      header\n        Binding Update\n   Step 2.  There is no existing security association
      to protect the\n   Binding Update, so the mobile node initiates IKE.  The IKE
      packets\n   are sent as shown in the following examples.  The first packet is
      an\n   example of an IKE packet sent from the mobile node, and the second\n
      \  one is from the home agent.  The examples shows also that the phase 1\n   identity
      used for the mobile node is a FQDN.\n     IPv6 header (source = care-of address,\n
      \                 destination = home agent)\n        UDP\n        IKE\n           ...
      IDii = ID_FQDN mn123.ha.net ...\n     IPv6 header (source = home agent\n                  destination
      = care-of address)\n        UDP\n        IKE\n           ... IDir = ID_FQDN
      ha.net ...\n   Step 3.  IKE phase 1 completes, and phase 2 is initiated to request\n
      \  security associations for protecting traffic between the mobile\n   node's
      home address and the home agent.  These addresses will be used\n   as selectors.
      \ This involves sending and receiving additional IKE\n   packets.  The below
      example shows again one packet sent by the mobile\n   node and another sent
      by the home agent.  The example shows also that\n   the phase 2 identity used
      for the mobile node is the mobile node's\n   home address.\n     IPv6 header
      (source = care-of address,\n                  destination = home agent)\n        UDP\n
      \       IKE\n           ... IDci = ID_IPV6_ADDR home address ...\n     IPv6
      header (source = home agent,\n                  destination = care-of address)\n
      \       UDP\n        IKE\n           ... IDcr = ID_IPV6_ADDR home agent ...\n
      \  Step 4.  The remaining steps are as shown in Section 6.1.\n"
    title: 6.17.  Establishing New Security Associations
  - contents:
    - "6.18.  Rekeying Security Associations\n   Step 1.  The mobile node and the
      home agent have existing security\n   associations.  Either side may decide
      at any time that the security\n   associations need to be rekeyed, for instance,
      because the specified\n   lifetime is approaching.\n   Step 2.  Mobility header
      packets sent during rekey may be protected\n   by the existing security associations.\n
      \  Step 3.  When the rekeying is finished, new security associations are\n   established.
      \ In practice there is a time interval during which an\n   old, about-to-expire
      security association and newly established\n   security association will both
      exist.  The new ones should be used as\n   soon as they become available.\n
      \  Step 4.  A notification of the deletion of the old security\n   associations
      is received.  After this, only the new security\n   associations can be used.\n
      \  Note that there is no requirement that the existence of the IPsec and\n   IKE
      security associations is tied to the existence of bindings.  It\n   is not necessary
      to delete a security association if a binding is\n   removed, as a new binding
      may soon be established after this.\n   Since cryptographic acceleration hardware
      may only be able to handle\n   a limited number of active security associations,
      security\n   associations may be deleted via IKE in order to keep the number
      of\n   active cryptographic contexts to a minimum.  Such deletions should\n
      \  not be interpreted as a sign of losing a contact to the peer or as a\n   reason
      to remove a binding.  Rather, if additional traffic needs to\n   be sent, it
      is preferable to bring up another security association to\n   protect it.\n"
    title: 6.18.  Rekeying Security Associations
  - contents:
    - "6.19.  Movements and Dynamic Keying\n   In this section we describe the sequence
      of events that relate to\n   movement with IKE-based security associations.
      \ In the initial state,\n   the mobile node is not registered in any location
      and has no security\n   associations with the home agent.  Depending on whether
      the peers\n   will be able to move IKE endpoints to new care-of addresses, the\n
      \  actions taken in Step 9 and 10 are different.\n   Step 1.  Mobile node with
      the home address A moves to care-of address\n   B.\n   Step 2.  Mobile node
      runs IKE from care-of address B to the home\n   agent, establishing a phase
      1.  The home agent can only act as the\n   responder before it knows the current
      location of the mobile node.\n   Step 3.  Protected by this phase 1, mobile
      node establishes a pair of\n   security associations for protecting Mobility
      Header traffic to and\n   from the home address A.\n   Step 4.  Mobile node
      sends a Binding Update and receives a Binding\n   Acknowledgement using the
      security associations created in Step 3.\n   Step 5.  Mobile node establishes
      a pair of security associations for\n   protecting return routability packets.
      \ These security associations\n   are in tunnel mode and their endpoint in the
      mobile node side is\n   care-of address B.  For the purposes of our example,
      this step uses\n   the phase 1 connection established in Step 2.  Multiple phase
      1\n   connections are also possible.\n   Step 6.  The mobile node uses the security
      associations created in\n   Step 5 to run return routability.\n   Step 7.  The
      mobile node moves to a new location and adopts a new\n   care-of address C.\n
      \  Step 8.  Mobile node sends a Binding Update and receives a Binding\n   Acknowledgement
      using the security associations created in Step 3.\n   The home agent ensures
      that the next packets sent using the security\n   associations created in Step
      5 will have the new care-of address as\n   their destination address, as if
      the outer header destination address\n   in the security association had changed.\n
      \  Step 9.  If the mobile node and the HA have the capability to change\n   the
      IKE endpoints, they change the address to C.  If they do not have\n   the capability,
      both nodes remove their phase 1 connections created\n   on top of the care-of
      address B and will establish a new IKE phase 1\n   on top of the care-of address
      C.  This capability to change the IKE\n   phase 1 end points is indicated through
      setting the Key Management\n   Mobility Capability (K) flag [7] in the Binding
      Update and Binding\n   Acknowledgement messages.\n   Step 10.  If a new IKE
      phase 1 connection was setup after movement,\n   the MN will not be able to
      receive any notifications delivered on top\n   of the old IKE phase 1 security
      association.  Notifications delivered\n   on top of the new security association
      are received and processed\n   normally.  If the mobile node and HA were able
      to update the IKE\n   endpoints, they can continue using the same IKE phase
      1 connection.\n"
    title: 6.19.  Movements and Dynamic Keying
  title: 6.  Processing Steps within a Node
- contents:
  - '7.  Implementation Considerations

    '
  - contents:
    - "7.1.  IPsec\n   Note that packet formats and header ordering discussed in Section
      3\n   must be supported, but implementations may also support other\n   formats.
      \ In general, the use of formats not required here may lead\n   to incorrect
      processing of the packets by the peer (such as silently\n   discarding them),
      unless support for these formats has been verified\n   off-line.  Such verification
      can take place at the same time the\n   parameters of the security associations
      are agreed upon.  In some\n   cases, however, basic IPv6 specifications call
      for support of options\n   not discussed here.  In these cases, such a verification
      step might\n   be unnecessary as long as the peer fully supports the relevant
      IPv6\n   specifications.  However, no claims are made in this document about\n
      \  the validity of these other formats in the context of Mobile IPv6.\n   It
      is also likely that systems that support Mobile IPv6 have been\n   tested more
      extensively with the required formats.\n   We have chosen to require an encapsulation
      format for return\n   routability and payload packet protection which can only
      be realized\n   if the destination of the IPsec packets sent from the home agent
      can\n   be changed as the mobile node moves.  One of the main reasons for\n
      \  choosing such a format is that it removes the overhead of twenty four\n   bytes
      when a home address option or routing header is added to the\n   tunneled packet.
      \ Such an overhead would not be significant for the\n   protection of the return
      routability packets, but would create an\n   additional overhead if IPsec is
      used to protect the tunneling of\n   payload packets to the home agent.  This
      overhead may be significant\n   for real-time traffic.  Given that the use of
      the shorter packet\n   formats for any traffic requires the existence of suitable
      APIs, we\n   have chosen to require support for the shorter packet formats both\n
      \  for payload and return routability packets.\n   In order to support the care-of
      address as the destination address on\n   the mobile node side, the home agent
      must act as if the outer header\n   destination address in the security association
      to the mobile node\n   would have changed upon movements.  Implementations are
      free to\n   choose any particular method to make this change, such as using
      an\n   API to the IPsec implementation to change the parameters of the\n   security
      association, removing the security association and\n   installing a new one,
      or modification of the packet after it has gone\n   through IPsec processing.
      \ The only requirement is that after\n   registering a new binding at the home
      agent, the next IPsec packets\n   sent on this security association will be
      addressed to the new\n   care-of address.\n   We have chosen to require policy
      entries that are specific to a\n   tunnel interface.  This means that implementations
      have to regard the\n   Home Agent - Mobile Node tunnel as a separate interface
      on which\n   IPsec SPDs can be based.  A further complication of the IPsec\n
      \  processing on a tunnel interface is that this requires access to the\n   BITS
      implementation before the packet actually goes out.\n"
    title: 7.1.  IPsec
  - contents:
    - "7.2.  IKE\n   We have chosen to require that a dynamic key management protocol
      must\n   be able to make an authorization decision for IPsec security\n   association
      creation with different addresses than with what the key\n   management protocol
      is run.  We expect this to be done typically by\n   configuring the allowed
      combinations of phase 1 user identities and\n   home addresses.\n   When certificate
      authentication is used, IKE fragmentation can be\n   encountered.  This can
      occur when certificate chains are used, or\n   even with single certificates
      if they are large.  Many firewalls do\n   not handle fragments properly, and
      may drop them.  Routers in the\n   path may also discard fragments after the
      initial one, since they\n   typically will not contain full IP headers that
      can be compared\n   against an access list.  Where fragmentation occurs, the
      endpoints\n   will not always be able to establish a security association.\n
      \  Fortunately, typical Mobile IPv6 deployment uses short certificate\n   chains,
      as the mobile node is communicating directly with its home\n   network.  Where
      the problem appears, it may be difficult (at least\n   away from home) to replace
      the firewalls or routers with equipment\n   that can properly support fragments.
      \ It may help to store the peer\n   certificates locally, or to obtain them
      through other means.\n"
    title: 7.2.  IKE
  - contents:
    - "7.3.  Bump-in-the-Stack\n   Mobile IPv6 sets high requirements for a so-called
      Bump-In-The-Stack\n   (BITS) implementation model of IPsec.  As Mobile IPv6
      specific\n   modifications of the packets are required before or after IPsec\n
      \  processing, the BITS implementation has to perform also some tasks\n   related
      to mobility.  This may increase the complexity of the\n   implementation, even
      if it already performs some tasks of the IP\n   layer (such as fragmentation).\n
      \  Specifically, Bump-in-the-Stack implementations may have to deal with\n   the
      following issues:\n   o  Processing the Home Address destination option and
      Routing header\n      type 2 to a form suitable for IPsec processing to take
      place.\n      This is needed, among other things, for the security association\n
      \     and policy lookups.  While relatively straightforward, the\n      required
      processing may have a hardware effect in BITS\n      implementations, if they
      use hardware support beyond the\n      cryptographic operations.\n   o  Detecting
      packets sent between the mobile node and its home agent\n      using IPv6 encapsulation.\n
      \  o  Offering the necessary APIs for updating the IPsec and IKE\n      security
      association endpoints.\n"
    title: 7.3.  Bump-in-the-Stack
  title: 7.  Implementation Considerations
- contents:
  - "8.  IANA Considerations\n   No IANA actions are necessary based on this document.
    \ IANA actions\n   for the Mobile IPv6 protocol itself have been covered in [7].\n"
  title: 8.  IANA Considerations
- contents:
  - "9.  Security Considerations\n   The Mobile IPv6 base specification [7] requires
    strong security\n   between the mobile node and the home agent.  This memo discusses
    how\n   that security can be arranged in practice, using IPsec.  The security\n
    \  considerations related to this are documented in the base\n   specification,
    including a discussion of the implications of using\n   either manual or dynamic
    keying.\n"
  title: 9.  Security Considerations
- contents:
  - '10.  References

    '
  - contents:
    - "10.1.  Normative References\n   [1]  Bradner, S., \"Key words for use in RFCs
      to Indicate Requirement\n        Levels\", BCP 14, RFC 2119, March 1997.\n   [2]
      \ Kent, S. and R. Atkinson, \"Security Architecture for the\n        Internet
      Protocol\", RFC 2401, November 1998.\n   [3]  Kent, S. and R. Atkinson, \"IP
      Encapsulating Security Payload\n        (ESP)\", RFC 2406, November 1998.\n
      \  [4]  Harkins, D. and D. Carrel, \"The Internet Key Exchange (IKE)\",\n        RFC
      2409, November 1998.\n   [5]  Deering, S. and R. Hinden, \"Internet Protocol,
      Version 6 (IPv6)\n        Specification\", RFC 2460, December 1998.\n   [6]
      \ Conta, A. and S. Deering, \"Generic Packet Tunneling in IPv6\n        Specification\",
      RFC 2473, December 1998.\n   [7]  Johnson, D., Perkins, C. and J. Arkko, \"Mobility
      Support in\n        IPv6\", RFC 3775, June 2004.\n"
    title: 10.1.  Normative References
  - contents:
    - "10.2.  Informative References\n   [8]  Kent, S. and R. Atkinson, \"IP Authentication
      Header\", RFC 2402,\n        November 1998.\n   [9]  Deering, S., Fenner, W.
      and B. Haberman, \"Multicast Listener\n        Discovery (MLD) for IPv6\", RFC
      2710, October 1999.\n   [10] Droms, R., Ed., Bound, J., Volz, B., Lemon, T.,
      Perkins, C. and\n        M. Carney, \"Dynamic Host Configuration Protocol for
      IPv6\n        (DHCPv6)\", RFC 3315, July 2003.\n   [11] Vida, R. and L. Costa,
      Eds., \"Multicast Listener Discovery\n        Version 2 (MLDv2) for IPv6\",
      RFC 3810, June 2004.\n"
    title: 10.2.  Informative References
  title: 10.  References
- contents:
  - "11.  Acknowledgements\n   The authors would like to thank Greg O'Shea, Michael
    Thomas, Kevin\n   Miles, Cheryl Madson, Bernard Aboba, Erik Nordmark, Gabriel\n
    \  Montenegro, Steven Kent, and Santeri Paavolainen for interesting\n   discussions
    in this problem space.\n"
  title: 11.  Acknowledgements
- contents:
  - "12.  Authors' Addresses\n   Jari Arkko\n   Ericsson\n   02420  Jorvas\n   Finland\n
    \  EMail: jari.arkko@ericsson.com\n   Vijay Devarapalli\n   Nokia Research Center\n
    \  313 Fairchild Drive\n   Mountain View  CA 94043\n   USA\n   EMail: vijayd@iprg.nokia.com\n
    \  Francis Dupont\n   ENST Bretagne\n   Campus de Rennes\n   2, rue de la Chataigneraie\n
    \  CS 17607\n   35576 Cesson-Sevigne Cedex\n   France\n   EMail: Francis.Dupont@enst-bretagne.fr\n"
  title: 12.  Authors' Addresses
- contents:
  - "13.  Full Copyright Statement\n   Copyright (C) The Internet Society (2004).
    \ This document is subject\n   to the rights, licenses and restrictions contained
    in BCP 78, and\n   except as set forth therein, the authors retain all their rights.\n
    \  This document and the information contained herein are provided on an\n   \"AS
    IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n   OR IS SPONSORED
    BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING TASK FORCE
    DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT LIMITED TO
    ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT INFRINGE ANY
    RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
    PURPOSE.\n"
  title: 13.  Full Copyright Statement
- contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or
    scope of any\n   Intellectual Property Rights or other rights that might be claimed
    to\n   pertain to the implementation or use of the technology described in\n   this
    document or the extent to which any license under such rights\n   might or might
    not be available; nor does it represent that it has\n   made any independent effort
    to identify any such rights.  Information\n   on the procedures with respect to
    rights in RFC documents can be\n   found in BCP 78 and BCP 79.\n   Copies of IPR
    disclosures made to the IETF Secretariat and any\n   assurances of licenses to
    be made available, or the result of an\n   attempt made to obtain a general license
    or permission for the use of\n   such proprietary rights by implementers or users
    of this\n   specification can be obtained from the IETF on-line IPR repository
    at\n   http://www.ietf.org/ipr.\n   The IETF invites any interested party to bring
    to its attention any\n   copyrights, patents or patent applications, or other
    proprietary\n   rights that may cover technology that may be required to implement\n
    \  this standard.  Please address the information to the IETF at ietf-\n   ipr@ietf.org.\n"
  title: Intellectual Property
- contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided
    by the\n   Internet Society.\n"
  title: Acknowledgement
