- title: __initial_text__
  contents:
  - '  Interworking between the Session Initiation Protocol (SIP) and QSIG

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet Best Current Practices\
    \ for the\n   Internet Community, and requests discussion and suggestions for\n\
    \   improvements.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies interworking between the Session Initiation\n\
    \   Protocol (SIP) and QSIG within corporate telecommunication networks\n   (also\
    \ known as enterprise networks).  SIP is an Internet\n   application-layer control\
    \ (signalling) protocol for creating,\n   modifying, and terminating sessions\
    \ with one or more participants.\n   These sessions include, in particular, telephone\
    \ calls.  QSIG is a\n   signalling protocol for creating, modifying, and terminating\n\
    \   circuit-switched calls (in particular, telephone calls) within\n   Private\
    \ Integrated Services Networks (PISNs).  QSIG is specified in a\n   number of\
    \ Ecma Standards and published also as ISO/IEC standards.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \   2. Terminology .....................................................5\n  \
    \ 3. Definitions .....................................................5\n    \
    \  3.1. External Definitions .......................................5\n      3.2.\
    \ Other definitions ..........................................5\n           3.2.1.\
    \ Corporate Telecommunication Network (CN) ............5\n           3.2.2. Gateway\
    \ .............................................6\n           3.2.3. IP Network\
    \ ..........................................6\n           3.2.4. Media Stream\
    \ ........................................6\n           3.2.5. Private Integrated\
    \ Services Network (PISN) ..........6\n           3.2.6. Private Integrated Services\
    \ Network Exchange\n                  (PINX) ..............................................6\n\
    \   4. Acronyms ........................................................6\n  \
    \ 5. Background and Architecture .....................................7\n   6.\
    \ Overview .......................................................10\n   7. General\
    \ Requirements ...........................................11\n   8. Message Mapping\
    \ Requirements ...................................12\n      8.1. Message Validation\
    \ and Handling of Protocol Errors ........12\n      8.2. Call Establishment from\
    \ QSIG to SIP .......................14\n           8.2.1. Call Establishment\
    \ from QSIG to SIP Using\n                  En Bloc Procedures .................................14\n\
    \           8.2.2. Call Establishment from QSIG to SIP Using\n               \
    \   Overlap Procedures .................................16\n      8.3. Call Establishment\
    \ from SIP to QSIG .......................20\n           8.3.1. Receipt of SIP\
    \ INVITE Request for a New Call .......20\n           8.3.2. Receipt of QSIG CALL\
    \ PROCEEDING Message ............21\n           8.3.3. Receipt of QSIG PROGRESS\
    \ Message ...................22\n           8.3.4. Receipt of QSIG ALERTING Message\
    \ ...................22\n           8.3.5. Inclusion of SDP Information in a SIP\
    \ 18x\n                  Provisional Response ...............................23\n\
    \           8.3.6. Receipt of QSIG CONNECT Message ....................24\n  \
    \         8.3.7. Receipt of SIP PRACK Request .......................25\n    \
    \       8.3.8. Receipt of SIP ACK Request .........................25\n      \
    \     8.3.9. Receipt of a SIP INVITE Request for a Call\n                  Already\
    \ Being ......................................25\n      8.4. Call Clearing and\
    \ Call Failure ............................26\n           8.4.1. Receipt of a\
    \ QSIG DISCONNECT, RELEASE, or\n                  RELEASE COMPLETE ...................................26\n\
    \           8.4.2. Receipt of a SIP BYE Request .......................29\n  \
    \         8.4.3. Receipt of a SIP CANCEL Request ....................29\n    \
    \       8.4.4. Receipt of a SIP 4xx-6xx Response to an\n                  INVITE\
    \ Request .....................................29\n           8.4.5. Gateway-Initiated\
    \ Call Clearing ....................32\n      8.5. Request to Change Media Characteristics\
    \ ...................32\n   9. Number Mapping .................................................32\n\
    \      9.1. Mapping from QSIG to SIP ..................................33\n  \
    \         9.1.1. Using Information from the QSIG Called\n                  Party\
    \ Number Information Element ...................33\n           9.1.2. Using Information\
    \ from the QSIG Calling\n                  Party Number Information Element ...................33\n\
    \           9.1.3. Using Information from the QSIG Connected\n               \
    \   Number Information Element .........................35\n      9.2. Mapping\
    \ from SIP to QSIG ..................................36\n           9.2.1. Generating\
    \ the QSIG Called Party Number\n                  Information Element ................................36\n\
    \           9.2.2. Generating the QSIG Calling Party Number\n                \
    \  Information Element ................................37\n           9.2.3. Generating\
    \ the QSIG Connected Number\n                  Information Element ................................38\n\
    \   10. Requirements for Support of Basic Services ....................39\n  \
    \    10.1. Derivation of QSIG Bearer Capability Information\n            Element\
    \ ..................................................39\n      10.2. Derivation\
    \ of Media Type in SDP ..........................39\n   11. Security Considerations\
    \ .......................................40\n      11.1. General ..................................................40\n\
    \      11.2. Calls from QSIG to Invalid or Restricted Numbers .........40\n  \
    \    11.3. Abuse of SIP Response Code ...............................41\n    \
    \  11.4. Use of the To Header URI .................................41\n      11.5.\
    \ Use of the From Header URI ...............................41\n      11.6. Abuse\
    \ of Early Media .....................................42\n      11.7. Protection\
    \ from Denial-of-Service Attacks ................42\n   12. Acknowledgements ..............................................43\n\
    \   13. Normative References ..........................................43\n  \
    \ Appendix A. Example Message Sequences .............................45\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document specifies signalling interworking between\
    \ QSIG and the\n   Session Initiation Protocol (SIP) in support of basic services\
    \ within\n   a corporate telecommunication network (CN) (also known as enterprise\n\
    \   network).\n   QSIG is a signalling protocol that operates between Private\n\
    \   Integrated Services eXchanges (PINX) within a Private Integrated\n   Services\
    \ Network (PISN).  A PISN provides circuit-switched basic\n   services and supplementary\
    \ services to its users.  QSIG is specified\n   in Ecma Standards; in particular,\
    \ [2] (call control in support of\n   basic services), [3] (generic functional\
    \ protocol for the support of\n   supplementary services), and a number of standards\
    \ specifying\n   individual supplementary services.\n   NOTE: The name QSIG was\
    \ derived from the fact that it is used for\n   signalling at the Q reference\
    \ point.  The Q reference point is a\n   point of demarcation between two PINXs.\n\
    \   SIP is an application-layer protocol for establishing, terminating,\n   and\
    \ modifying multimedia sessions.  It is typically carried over IP\n   [15], [16].\
    \  Telephone calls are considered a type of multimedia\n   session where just\
    \ audio is exchanged.  SIP is defined in [10].\n   As the support of telephony\
    \ within corporate networks evolves from\n   circuit-switched technology to Internet\
    \ technology, the two\n   technologies will coexist in many networks for a period,\
    \ perhaps\n   several years.  Therefore, there is a need to be able to establish,\n\
    \   modify, and terminate sessions involving a participant in the SIP\n   network\
    \ and a participant in the QSIG network.  Such calls are\n   supported by gateways\
    \ that perform interworking between SIP and QSIG.\n   This document specifies\
    \ SIP-QSIG signalling interworking for basic\n   services that provide a bi-directional\
    \ transfer capability for\n   speech, DTMF, facsimile, and modem media between\
    \ a PISN employing\n   QSIG and a corporate IP network employing SIP.  Other aspects\
    \ of\n   interworking, e.g., the use of RTP and SDP, will differ according to\n\
    \   the type of media concerned and are outside the scope of this\n   specification.\n\
    \   Call-related and call-independent signalling in support of\n   supplementary\
    \ services is outside the scope of this specification,\n   but support for certain\
    \ supplementary services (e.g., call transfer,\n   call diversion) could be the\
    \ subject of future work.\n   Interworking between QSIG and SIP permits a call\
    \ originating at a\n   user of a PISN to terminate at a user of a corporate IP\
    \ network, or a\n   call originating at a user of a corporate IP network to terminate\
    \ at\n   a user of a PISN.\n   Interworking between a PISN employing QSIG and\
    \ a public IP network\n   employing SIP is outside the scope of this specification.\
    \  However,\n   the functionality specified in this specification is in principle\n\
    \   applicable to such a scenario when deployed in conjunction with other\n  \
    \ relevant functionality (e.g., number translation, security functions,\n   etc.).\n\
    \   This specification is applicable to any interworking unit that can\n   act\
    \ as a gateway between a PISN employing QSIG and a corporate IP\n   network employing\
    \ SIP.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   In this document, the key words \"MUST\", \"MUST NOT\", \"\
    REQUIRED\",\n   \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\",\n   and \"OPTIONAL\" are to be interpreted as described in RFC 2119\
    \ [4] and\n   indicate requirement levels for compliant SIP implementations.\n"
- title: 3.  Definitions
  contents:
  - "3.  Definitions\n   For the purposes of this specification, the following definitions\n\
    \   apply.\n"
- title: 3.1.  External Definitions
  contents:
  - "3.1.  External Definitions\n   The definitions in [2] and [10] apply as appropriate.\n"
- title: 3.2.  Other definitions
  contents:
  - '3.2.  Other definitions

    '
- title: 3.2.1.  Corporate Telecommunication Network (CN)
  contents:
  - "3.2.1.  Corporate Telecommunication Network (CN)\n   Sets of privately-owned\
    \ or carrier-provided equipment that are\n   located at geographically dispersed\
    \ locations and are interconnected\n   to provide telecommunication services to\
    \ a defined group of users.\n   NOTE: A CN can comprise a PISN, a private IP network\
    \ (intranet), or a\n   combination of the two.\n"
- title: 3.2.2.  Gateway
  contents:
  - "3.2.2.  Gateway\n   An entity that performs interworking between a PISN using\
    \ QSIG and an\n   IP network using SIP.\n"
- title: 3.2.3.  IP Network
  contents:
  - "3.2.3.  IP Network\n   A network (unless otherwise stated, a corporate network)\
    \ offering\n   connectionless packet-mode services based on the Internet Protocol\n\
    \   (IP) as the network-layer protocol.\n"
- title: 3.2.4.  Media Stream
  contents:
  - "3.2.4.  Media Stream\n   Audio or other user information transmitted in UDP packets,\
    \ typically\n   containing RTP, in a single direction between the gateway and\
    \ a peer\n   entity participating in a session established using SIP.\n   NOTE:\
    \ Normally a SIP session establishes a pair of media streams, one\n   in each\
    \ direction.\n"
- title: 3.2.5.  Private Integrated Services Network (PISN)
  contents:
  - "3.2.5.  Private Integrated Services Network (PISN)\n   A CN or part of a CN that\
    \ employs circuit-switched technology.\n"
- title: 3.2.6.  Private Integrated Services Network Exchange (PINX)
  contents:
  - "3.2.6.  Private Integrated Services Network Exchange (PINX)\n   A PISN nodal\
    \ entity comprising switching and call handling functions\n   and supporting QSIG\
    \ signalling in accordance with [2].\n"
- title: 4.  Acronyms
  contents:
  - "4.  Acronyms\n   DNS   Domain Name Service\n   IP    Internet Protocol\n   PINX\
    \  Private Integrated services Network eXchange\n   PISN  Private Integrated Services\
    \ Network\n   RTP   Real-time Transport Protocol\n   SCTP  Stream Control Transmission\
    \ Protocol\n   SDP   Session Description Protocol\n   SIP   Session Initiation\
    \ Protocol\n   TCP   Transmission Control Protocol\n   TLS   Transport Layer Security\n\
    \   TU    Transaction User\n   UA    User Agent\n   UAC   User Agent Client\n\
    \   UAS   User Agent Server\n   UDP   User Datagram Protocol\n"
- title: 5.  Background and Architecture
  contents:
  - "5.  Background and Architecture\n   During the 1980s, corporate voice telecommunications\
    \ adopted\n   technology similar in principle to Integrated Services Digital\n\
    \   Networks (ISDN).  Digital circuit switches, commonly known as Private\n  \
    \ Branch eXchanges (PBX) or more formally as Private Integrated\n   services Network\
    \ eXchanges (PINX) have been interconnected by digital\n   transmission systems\
    \ to form Private Integrated Services Networks\n   (PISN).  These digital transmission\
    \ systems carry voice or other\n   payload in fixed-rate channels, typically 64\
    \ Kbit/s, and signalling\n   in a separate channel.  A technique known as common\
    \ channel\n   signalling is employed, whereby a single signalling channel\n  \
    \ potentially controls a number of payload channels or bearer channels.\n   A\
    \ typical arrangement is a point-to-point transmission facility at T1\n   or E1\
    \ rate providing a 64 Kbit/s signalling channel and 23 or 30\n   bearer channels,\
    \ respectively.  Other arrangements are possible and\n   have been deployed, including\
    \ the use of multiple transmission\n   facilities for a signalling channel and\
    \ its logically associated\n   bearer channels.  Also, arrangements involving\
    \ bearer channels at\n   sub-64 Kbit/s have been deployed, where voice payload\
    \ requires the\n   use of codecs that perform compression.\n   QSIG is the internationally-standardized\
    \ message-based signalling\n   protocol for use in networks as described above.\
    \  It runs in a\n   signalling channel between two PINXs and controls calls on\
    \ a number\n   of logically associated bearer channels between the same two PINXs.\n\
    \   The signalling channel and its logically associated bearer channels\n   are\
    \ collectively known as an inter-PINX link.  QSIG is independent of\n   the type\
    \ of transmission capabilities over which the signalling\n   channel and bearer\
    \ channels are provided.  QSIG is also independent\n   of the transport protocol\
    \ used to transport QSIG messages reliably\n   over the signalling channel.\n\
    \   QSIG provides a means for establishing and clearing calls that\n   originate\
    \ and terminate on different PINXs.  A call can be routed\n   over a single inter-PINX\
    \ link connecting the originating and\n   terminating PINX, or over several inter-PINX\
    \ links in series with\n   switching at intermediate PINXs known as transit PINXs.\
    \  A call can\n   originate or terminate in another network, in which case it\
    \ enters or\n   leaves the PISN environment through a gateway PINX.  Parties are\n\
    \   identified by numbers, in accordance with either [17] or a private\n   numbering\
    \ plan.  This basic call capability is specified in [2].  In\n   addition to basic\
    \ call capability, QSIG specifies a number of further\n   capabilities supporting\
    \ the use of supplementary services in PISNs.\n   More recently, corporate telecommunications\
    \ networks have started to\n   exploit IP in various ways.  One way is to migrate\
    \ part of the\n   network to IP using SIP.  This might, for example, be a new\
    \ branch\n   office with a SIP proxy and SIP endpoints instead of a PINX.\n  \
    \ Alternatively, SIP equipment might be used to replace an existing\n   PINX or\
    \ PINXs.  The new SIP environment needs to interwork with the\n   QSIG-based PISN\
    \ in order to support calls originating in one\n   environment and terminating\
    \ in the other.  Interworking is achieved\n   through a gateway.\n   Interworking\
    \ between QSIG and SIP at gateways can also be used where\n   a SIP network interconnects\
    \ different parts of a PISN, thereby\n   allowing calls between the different\
    \ parts.  A call can enter the SIP\n   network at one gateway and leave at another.\
    \  Each gateway would\n   behave in accordance with this specification.\n   Another\
    \ way of connecting two parts of a PISN would be to encapsulate\n   QSIG signalling\
    \ in SIP messages for calls between the two parts.\n   This is outside the scope\
    \ of this specification but could be the\n   subject of future work.\n   This\
    \ document specifies signalling protocol interworking aspects of a\n   gateway\
    \ between a PISN employing QSIG signalling and an IP network\n   employing SIP\
    \ signalling.  The gateway appears as a PINX to other\n   PINXs in the PISN. \
    \ The gateway appears as a SIP endpoint to other\n   SIP entities in the IP network.\
    \  The environment is shown in Figure\n   1.\n        +------+   IP network  \
    \                PISN\n        |      |\n        |SIP   |                    \
    \                         +------+\n        |Proxy |                         \
    \                   /|      |\n        |      |                              \
    \             / |PINX  |\n        +---+--+             *-----------+         \
    \       /  |      |\n            |                |           |        +-----+/\
    \   +------+\n            |                |           |        |     |\n    \
    \        |                |           |        |PINX |\n   ---+-----+-------+--------+\
    \  Gateway  +--------|     |\n      |             |        |           |     \
    \   |     |\\\n      |             |        |           |        +-----+ \\\n\
    \      |             |        |           |                 \\ +------+\n    \
    \  |             |        |           |                  \\|      |\n   +--+---+\
    \      +--+---+    *-----------+                   |PINX  |\n   |SIP   |     \
    \ |SIP   |                                    |      |\n   |End-  |      |End-\
    \  |                                    +------+\n   |point |      |point |\n\
    \   +------+      +------+\n                          Figure 1: Environment\n\
    \   In addition to the signalling interworking functionality specified in\n  \
    \ this specification, it is assumed that the gateway also includes the\n   following\
    \ functionality:\n   - one or more physical interfaces on the PISN side supporting\
    \ one or\n     more inter-PINX links, each link providing one or more constant\
    \ bit\n     rate channels for media streams and a reliable layer 2 connection\n\
    \     (e.g., over a fixed rate physical channel) for transporting QSIG\n     signalling\
    \ messages; and\n   - one or more physical interfaces on the IP network side supporting,\n\
    \     through layer 1 and layer 2 protocols, IP as the network layer\n     protocol\
    \ and UDP [6] and TCP [5] as transport layer protocols,\n     these being used\
    \ for the transport of SIP signalling messages and,\n     in the case of UDP,\
    \ also for media streams;\n   - optionally the support of TLS [7] and/or SCTP\
    \ [9] as additional\n     transport layer protocols on the IP network side, these\
    \ being used\n     for the transport of SIP signalling messages; and\n   - a means\
    \ of transferring media streams in each direction between the\n     PISN and the\
    \ IP network, including as a minimum packetization of\n     media streams sent\
    \ to the IP network and de-packetization of media\n     streams received from\
    \ the IP network.\n   NOTE: [10] mandates support for both UDP and TCP for the\
    \ transport of\n   SIP messages and allows optional support for TLS and/or SCTP\
    \ for this\n   same purpose.\n   The protocol model relevant to signalling interworking\
    \ functionality\n   of a gateway is shown in Figure 2.\n   +---------------------------------------------------------+\n\
    \   |                   Interworking function                 |\n   |        \
    \                                                 |\n   +-----------------------+---------+-----------------------+\n\
    \   |                       |         |                       |\n   |        SIP\
    \            |         |                       |\n   |                       |\
    \         |                       |\n   +-----------------------+         |  \
    \                     |\n   |                       |         |              \
    \         |\n   |  UDP/TCP/TLS/SCTP     |         |        QSIG           |\n\
    \   |                       |         |                       |\n   +-----------------------+\
    \         |                       |\n   |                       |         |  \
    \                     |\n   |        IP             |         |              \
    \         |\n   |                       |         |                       |\n\
    \   +-----------------------+         +-----------------------+\n   |    IP network\
    \         |         |        PISN           |\n   |    lower layers       |  \
    \       |    lower layers       |\n   |                       |         |    \
    \                   |\n   +-----------------------+         +-----------------------+\n\
    \                    Figure 2: Protocol model\n   In Figure 2, the SIP box represents\
    \ SIP syntax and encoding, the SIP\n   transport layer, and the SIP transaction\
    \ layer.  The Interworking\n   function includes SIP Transaction User (TU) functionality.\n"
- title: 6.  Overview
  contents:
  - "6.  Overview\n   The gateway maps received QSIG messages, where appropriate,\
    \ to SIP\n   messages and vice versa and maintains an association between a QSIG\n\
    \   call and a SIP dialog.\n   A call from QSIG to SIP is initiated when a QSIG\
    \ SETUP message\n   arrives at the gateway.  The QSIG SETUP message initiates\
    \ QSIG call\n   establishment, and an initial response message (e.g., CALL\n \
    \  PROCEEDING) completes negotiation of the bearer channel to be used\n   for\
    \ that call.  The gateway then sends a SIP INVITE request, having\n   translated\
    \ the QSIG called party number to a URI suitable for\n   inclusion in the Request-URI.\
    \  The SIP INVITE request and the\n   resulting SIP dialog, if successfully established,\
    \ are associated\n   with the QSIG call.  The SIP 2xx response to the INVITE request\
    \ is\n   mapped to a QSIG CONNECT message, signifying answer of the call.\n  \
    \ During establishment, media streams established by SIP and SDP are\n   connected\
    \ to the bearer channel.\n   A call from SIP to QSIG is initiated when a SIP INVITE\
    \ request\n   arrives at the gateway.  The gateway sends a QSIG SETUP message\
    \ to\n   initiate QSIG call establishment, having translated the SIP Request-\n\
    \   URI to a number suitable for use as the QSIG called party number.\n   The\
    \ resulting QSIG call is associated with the SIP INVITE request and\n   with the\
    \ eventual SIP dialog.  Receipt of an initial QSIG response\n   message completes\
    \ negotiation of the bearer channel to be used,\n   allowing media streams established\
    \ by SIP and SDP to be connected to\n   that bearer channel.  The QSIG CONNECT\
    \ message is mapped to a SIP 200\n   OK response to the INVITE request.\n   Appendix\
    \ A gives examples of typical message sequences that can\n   arise.\n"
- title: 7.  General Requirements
  contents:
  - "7.  General Requirements\n   In order to conform to this specification, a gateway\
    \ SHALL support\n   QSIG in accordance with [2] as a gateway and SHALL support\
    \ SIP in\n   accordance with [10] as a UA.  In particular, the gateway SHALL\n\
    \   support SIP syntax and encoding, the SIP transport layer, and the SIP\n  \
    \ transaction layer in accordance with [10].  In addition, the gateway\n   SHALL\
    \ support SIP TU behaviour for a UA in accordance with [10]\n   except where stated\
    \ otherwise in Sections 8, 9, and 10 of this\n   specification.\n   NOTE: [10]\
    \ mandates that a SIP entity support both UDP and TCP as\n   transport layer protocols\
    \ for SIP messages.  Other transport layer\n   protocols can also be supported.\n\
    \   The gateway SHALL also support SIP reliable provisional responses in\n   accordance\
    \ with [11] as a UA.\n   NOTE: [11] makes provision for recovering from loss of\
    \ provisional\n   responses (other than 100) to INVITE requests when using unreliable\n\
    \   transport services in the IP network.  This is important for ensuring\n  \
    \ delivery of responses that map to essential QSIG messages.\n   The gateway SHALL\
    \ support SDP in accordance with [8] and its use in\n   accordance with the offer/answer\
    \ model in [12].\n   Section 9 also specifies optional use of the Privacy header\
    \ in\n   accordance with [13] and the P-Asserted-Identity header in accordance\n\
    \   with [14].\n   The gateway SHALL support calls from QSIG to SIP and calls\
    \ from SIP\n   to QSIG.\n   SIP methods not defined in [10] or [11] are outside\
    \ the scope of this\n   specification but could be the subject of other specifications\
    \ for\n   interworking with QSIG, e.g., for interworking in support of\n   supplementary\
    \ services.\n   As a result of DNS lookup by the gateway in order to determine\
    \ where\n   to send a SIP INVITE request, a number of candidate destinations can\n\
    \   be attempted in sequence.  The way in which this is handled by the\n   gateway\
    \ is outside the scope of this specification.  However, any\n   behaviour specified\
    \ in this document on receipt of a SIP 4xx or 5xx\n   final response to an INVITE\
    \ request SHOULD apply only when there are\n   no more candidate destinations\
    \ to try or when overlap signalling\n   applies in the SIP network (see 8.2.2.2).\n"
- title: 8.  Message Mapping Requirements
  contents:
  - '8.  Message Mapping Requirements

    '
- title: 8.1.  Message Validation and Handling of Protocol Errors
  contents:
  - "8.1.  Message Validation and Handling of Protocol Errors\n   The gateway SHALL\
    \ validate received QSIG messages in accordance with\n   the requirements of [2]\
    \ and SHALL act in accordance with [2] on\n   detection of a QSIG protocol error.\
    \  The requirements of this section\n   for acting on a received QSIG message\
    \ apply only to a received QSIG\n   message that has been successfully validated\
    \ and that satisfies one\n   of the following conditions:\n   -the QSIG message\
    \ is a SETUP message and indicates a destination in\n   the IP network and a bearer\
    \ capability for which the gateway is able\n   to provide interworking; or\n \
    \  -the QSIG message is a message other than SETUP and contains a call\n   reference\
    \ that identifies an existing call for which the gateway is\n   providing interworking\
    \ between QSIG and SIP.\n   The processing of any valid QSIG message that does\
    \ not satisfy any of\n   these conditions is outside the scope of this specification.\
    \  Also,\n   the processing of any QSIG message relating to call-independent\n\
    \   signalling connections or connectionless transport, as specified in\n   [3],\
    \ is outside the scope of this specification.\n   If segmented QSIG messages are\
    \ received, the gateway SHALL await\n   receipt of all segments of a message and\
    \ SHALL validate and act on\n   the complete reassembled message.\n   The gateway\
    \ SHALL validate received SIP messages (requests and\n   responses) in accordance\
    \ with the requirements of [10] and SHALL act\n   in accordance with [10] on detection\
    \ of a SIP protocol error.\n   Requirements of this section for acting on a received\
    \ SIP message\n   apply only to a received message that has been successfully\
    \ validated\n   and that satisfies one of the following conditions:\n   - the\
    \ SIP message is an INVITE request that contains no tag parameter\n     in the\
    \ To header field, does not match an ongoing transaction\n     (i.e., is not a\
    \ merged request; see Section 8.2.2.2 of [10]), and\n     indicates a destination\
    \ in the PISN for which the gateway is able\n     to provide interworking; or\n\
    \   - the SIP message is a request that relates to an existing dialog\n     representing\
    \ a call for which the gateway is providing interworking\n     between QSIG and\
    \ SIP; or\n   - the SIP message is a CANCEL request that relates to a received\n\
    \     INVITE request for which the gateway is providing interworking with\n  \
    \   QSIG but for which the only response sent is informational (1xx),\n     no\
    \ dialog having been confirmed; or\n   - the SIP message is a response to a request\
    \ sent by the gateway in\n     accordance with this section.\n   The processing\
    \ of any valid SIP message that does not satisfy any of\n   these conditions is\
    \ outside the scope of this specification.\n   NOTE: These rules mean that an\
    \ error detected in a received message\n   will not be propagated to the other\
    \ side of the gateway.  However,\n   there can be an indirect impact on the other\
    \ side of the gateway,\n   e.g., the initiation of call clearing procedures.\n\
    \   The gateway SHALL run QSIG protocol timers as specified in [2] and\n   SHALL\
    \ act in accordance with [2] if a QSIG protocol timer expires.\n   Any other action\
    \ on expiry of a QSIG protocol timer is outside the\n   scope of this specification,\
    \ except that if it results in the\n   clearing of the QSIG call, the gateway\
    \ SHALL also clear the SIP call\n   in accordance with Section 8.4.5.\n   The\
    \ gateway SHALL run SIP protocol timers as specified in [10] and\n   SHALL act\
    \ in accordance with [10] if a SIP protocol timer expires.\n   Any other action\
    \ on expiry of a SIP protocol timer is outside the\n   scope of this specification,\
    \ except that if it results in the\n   clearing of the SIP call, the gateway SHALL\
    \ also clear the QSIG call\n   in accordance with Section 8.4.5.\n"
- title: 8.2.  Call Establishment from QSIG to SIP
  contents:
  - '8.2.  Call Establishment from QSIG to SIP

    '
- title: 8.2.1.  Call Establishment from QSIG to SIP Using En Bloc Procedures
  contents:
  - "8.2.1.  Call Establishment from QSIG to SIP Using En Bloc Procedures\n   The\
    \ following procedures apply when the gateway receives a QSIG SETUP\n   message\
    \ containing a Sending Complete information element or the\n   gateway receives\
    \ a QSIG SETUP message and is able to determine that\n   the number in the Called\
    \ party number information element is\n   complete.\n   NOTE: In the absence of\
    \ a Sending Complete information element, the\n   means by which the gateway determines\
    \ the number to be complete is an\n   implementation matter.  It can involve knowledge\
    \ of the numbering\n   plan and/or use of inter-digit timer expiry.\n"
- title: 8.2.1.1.  Receipt of QSIG SETUP Message
  contents:
  - "8.2.1.1.  Receipt of QSIG SETUP Message\n   On receipt of a QSIG SETUP message\
    \ containing a number that the\n   gateway determines to be complete in the Called\
    \ party number\n   information element, or containing a Sending complete information\n\
    \   element and a number that could potentially be complete, the gateway\n   SHALL\
    \ map the QSIG SETUP message to a SIP INVITE request.  The\n   gateway SHALL also\
    \ send a QSIG CALL PROCEEDING message.\n   The gateway SHALL generate the SIP\
    \ Request-URI, To, and From fields\n   in the SIP INVITE request in accordance\
    \ with Section 9.  The gateway\n   SHALL include in the INVITE request a Supported\
    \ header containing\n   option tag 100rel, to indicate support for [11].\n   The\
    \ gateway SHALL include SDP offer information in the SIP INVITE\n   request as\
    \ described in Section 10.  It SHOULD also connect the\n   incoming media stream\
    \ to the user information channel of the inter-\n   PINX link, to allow the caller\
    \ to hear in-band tones or announcements\n   and prevent speech clipping on answer.\
    \  Because of forking, the\n   gateway may receive more than one media stream,\
    \ in which case it\n   SHOULD select one (e.g., the first received).  If the gateway\
    \ is able\n   to correlate an unselected media stream with a particular early\n\
    \   dialog established using a reliable provisional response, it MAY use\n   the\
    \ UPDATE method [19] to stop that stream and then use the UPDATE\n   method to\
    \ start that stream again if a 2xx response is received on\n   that dialog.\n\
    \   On receipt of a QSIG SETUP message containing a Sending complete\n   information\
    \ element and a number that the gateway determines to be\n   incomplete in the\
    \ Called party number information element, the\n   gateway SHALL initiate QSIG\
    \ call clearing procedures using cause\n   value 28, \"invalid number format (address\
    \ incomplete)\".\n   If information in the QSIG SETUP message is unsuitable for\
    \ generating\n   any of the mandatory fields in a SIP INVITE request (e.g., if\
    \ a\n   Request-URI cannot be derived from the QSIG Called party number\n   information\
    \ element) or for generating SDP information, the gateway\n   SHALL NOT issue\
    \ a SIP INVITE request and SHALL initiate QSIG call\n   clearing procedures in\
    \ accordance with [2].\n"
- title: 8.2.1.2.  Receipt of SIP 100 (Trying) Response to an INVITE Request
  contents:
  - "8.2.1.2.  Receipt of SIP 100 (Trying) Response to an INVITE Request\n   A SIP\
    \ 100 response SHALL NOT trigger any QSIG messages.  It only\n   serves the purpose\
    \ of suppressing INVITE request retransmissions.\n"
- title: 8.2.1.3.  Receipt of SIP 18x provisional response to an INVITE request
  contents:
  - "8.2.1.3.  Receipt of SIP 18x provisional response to an INVITE request\n   The\
    \ gateway SHALL map a received SIP 18x response to an INVITE\n   request to a\
    \ QSIG PROGRESS or ALERTING message based on the following\n   conditions.\n \
    \  - If a SIP 180 response is received and no QSIG ALERTING message has\n   been\
    \ sent, the gateway SHALL generate a QSIG ALERTING message.  The\n   gateway MAY\
    \ supply ring-back tone on the user information channel of\n   the inter-PINX\
    \ link, in which case the gateway SHALL include progress\n   description number\
    \ 8 in the QSIG ALERTING message.  Otherwise the\n   gateway SHALL NOT include\
    \ progress description number 8 in the QSIG\n   ALERTING message unless the gateway\
    \ is aware that in-band information\n   (e.g., ring-back tone) is being transmitted.\n\
    \   - If a SIP 181/182/183 response is received, no QSIG ALERTING message\n  \
    \ has been sent, and no message containing progress description number\n   1 has\
    \ been sent, the gateway SHALL generate a QSIG PROGRESS message\n   containing\
    \ progress description number 1.\n   NOTE: This will ensure that QSIG timer T310\
    \ is stopped if running at\n   the Originating PINX.\n   In all other scenarios,\
    \ the gateway SHALL NOT map the SIP 18x\n   response to a QSIG message.\n   If\
    \ the SIP 18x response contains a Require header with option tag\n   100rel, the\
    \ gateway SHALL send back a SIP PRACK request in accordance\n   with [11].\n"
- title: 8.2.1.4.  Receipt of SIP 2xx Response to an INVITE Request
  contents:
  - "8.2.1.4.  Receipt of SIP 2xx Response to an INVITE Request\n   If the gateway\
    \ receives a SIP 2xx response as the first SIP 2xx\n   response to a SIP INVITE\
    \ request, the gateway SHALL map the SIP 2xx\n   response to a QSIG CONNECT message.\
    \  The gateway SHALL also send a\n   SIP ACK request to acknowledge the 2xx response.\
    \  The gateway SHALL\n   NOT include any SDP information in the SIP ACK request.\
    \  If the\n   gateway receives further 2xx responses, it SHALL respond to each\
    \ in\n   accordance with [10], SHOULD issue a BYE request for each, and SHALL\n\
    \   NOT generate any further QSIG messages.\n   Media streams will normally have\
    \ been established in the IP network\n   in each direction.  If so, the gateway\
    \ SHALL connect the media\n   streams to the corresponding user-information channel\
    \ on the inter-\n   PINX link if it has not already done so and stop any local\
    \ ring-back\n   tone.\n   If the SIP 2xx response is received in response to the\
    \ SIP PRACK\n   request, the gateway SHALL NOT map this message to any QSIG message.\n\
    \   NOTE: A SIP 2xx response to the INVITE request can be received later\n   on\
    \ a different dialog as a result of a forking proxy.\n"
- title: 8.2.1.5.  Receipt of SIP 3xx Response to an INVITE Request
  contents:
  - "8.2.1.5.  Receipt of SIP 3xx Response to an INVITE Request\n   On receipt of\
    \ a SIP 3xx response to an INVITE request, the gateway\n   SHALL act in accordance\
    \ with [10].\n   NOTE: This will normally result in sending a new SIP INVITE request.\n\
    \   Unless the gateway supports the QSIG Call Diversion Supplementary\n   Service,\
    \ no QSIG message SHALL be sent.  The definition of Call\n   Diversion Supplementary\
    \ Service for QSIG to SIP interworking is\n   beyond the scope of this specification.\n"
- title: 8.2.2.  Call Establishment from QSIG to SIP Using Overlap Procedures
  contents:
  - "8.2.2.  Call Establishment from QSIG to SIP Using Overlap Procedures\n   SIP\
    \ uses en bloc signalling, and it is strongly RECOMMENDED to avoid\n   using overlap\
    \ signalling in a SIP network.  A SIP/QSIG gateway\n   dealing with overlap signalling\
    \ SHOULD perform a conversion from\n   overlap to en bloc signalling method using\
    \ one or more of the\n   following mechanisms:\n      - timers;\n      - numbering\
    \ plan information;\n      - the presence of a Sending complete information element\
    \ in a\n        received QSIG INFORMATION message.\n   If the gateway performs\
    \ a conversion from overlap to en bloc\n   signalling in the SIP network, then\
    \ the procedures defined in Section\n   8.2.2.1 SHALL apply.\n   However, for\
    \ some applications it might be impossible to avoid using\n   overlap signalling\
    \ in the SIP network.  In this case, the procedures\n   defined in Section 8.2.2.2\
    \ SHALL apply.\n"
- title: 8.2.2.1.  En Bloc Signalling in SIP Network
  contents:
  - '8.2.2.1.  En Bloc Signalling in SIP Network

    '
- title: 8.2.2.1.1.  Receipt of QSIG SETUP Message
  contents:
  - "8.2.2.1.1.  Receipt of QSIG SETUP Message\n   On receipt of a QSIG SETUP message\
    \ containing no Sending complete\n   information element and a number in the Called\
    \ party number\n   information element that the gateway cannot determine to be\
    \ complete,\n   the gateway SHALL send back a QSIG SETUP ACKNOWLEDGE message,\
    \ start\n   QSIG timer T302, and await further number digits.\n"
- title: 8.2.2.1.2.  Receipt of QSIG INFORMATION Message
  contents:
  - "8.2.2.1.2.  Receipt of QSIG INFORMATION Message\n   On receipt of each QSIG INFORMATION\
    \ message containing no Sending\n   complete information element and containing\
    \ a number that the gateway\n   cannot determine to be complete, QSIG timer T302\
    \ SHALL be restarted.\n   When QSIG timer T302 expires or a QSIG INFORMATION message\
    \ containing\n   a Sending complete information element is received, the gateway\
    \ SHALL\n   send a SIP INVITE request as described in Section 8.2.1.1.  The\n\
    \   Request-URI and To fields (see Section 9) SHALL be generated from the\n  \
    \ concatenation of information in the Called party number information\n   element\
    \ in the received QSIG SETUP and INFORMATION messages.  The\n   gateway SHALL\
    \ also send a QSIG CALL PROCEEDING message.\n"
- title: 8.2.2.1.3.  Receipt of SIP Responses to INVITE Requests
  contents:
  - "8.2.2.1.3.  Receipt of SIP Responses to INVITE Requests\n   SIP responses to\
    \ INVITE requests SHALL be mapped as described in\n   8.2.1.\n"
- title: 8.2.2.2.  Overlap Signalling in SIP Network
  contents:
  - "8.2.2.2.  Overlap Signalling in SIP Network\n   The procedures below for using\
    \ overlap signalling in the SIP network\n   are in accordance with the principles\
    \ described in [18] for using\n   overlap sending when interworking with ISDN\
    \ User Part (ISUP).  In\n   [18], there is discussion of some potential problems\
    \ arising from the\n   use of overlap sending in the SIP network.  These potential\
    \ problems\n   are applicable also in the context of QSIG-SIP interworking and\
    \ can\n   be avoided if overlap sending in the QSIG network is terminated at\n\
    \   the gateway, in accordance with Section 8.2.2.1.  The procedures\n   below\
    \ should be used only where it is not feasible to use the\n   procedures of Section\
    \ 8.2.2.1.\n"
- title: 8.2.2.2.1.  Receipt of QSIG SETUP Message
  contents:
  - "8.2.2.2.1.  Receipt of QSIG SETUP Message\n   On receipt of a QSIG SETUP message\
    \ containing no Sending complete\n   information element and a number in the Called\
    \ party number\n   information element that the gateway cannot determine to be\
    \ complete,\n   the gateway SHALL send back a QSIG SETUP ACKNOWLEDGE message and\n\
    \   start QSIG timer T302.  If the QSIG SETUP message contains the\n   minimum\
    \ number of digits required to route the call in the IP\n   network, the gateway\
    \ SHALL send a SIP INVITE request as specified in\n   Section 8.2.1.1.  Otherwise,\
    \ the gateway SHALL wait for more digits\n   to arrive in QSIG INFORMATION messages.\n"
- title: 8.2.2.2.2.  Receipt of QSIG INFORMATION Message
  contents:
  - "8.2.2.2.2.  Receipt of QSIG INFORMATION Message\n   On receipt of a QSIG INFORMATION\
    \ message, the gateway SHALL handle\n   the QSIG timer T302 in accordance with\
    \ [2].\n   NOTE: [2] requires the QSIG timer to be stopped if the INFORMATION\n\
    \   message contains a Sending complete information element or to be\n   restarted\
    \ otherwise.\n   Further behaviour of the gateway SHALL depend on whether or not\
    \ it\n   has already sent a SIP INVITE request.  If the gateway has not sent a\n\
    \   SIP INVITE request and it now has the minimum number of digits\n   required\
    \ to route the call, it SHALL send a SIP INVITE request as\n   specified in Section\
    \ 8.2.2.1.2.  If the gateway still does not have\n   the minimum number of digits\
    \ required, it SHALL wait for more QSIG\n   INFORMATION messages to arrive.\n\
    \   If the gateway has already sent one or more SIP INVITE requests,\n   whether\
    \ or not final responses to those requests have been received,\n   it SHALL send\
    \ a new SIP INVITE request in accordance with Section 3.2\n   of [18].  The updated\
    \ Request-URI and To fields (see Section 9) SHALL\n   be generated from the concatenation\
    \ of information in the Called\n   party number information element in the received\
    \ QSIG SETUP and\n   INFORMATION messages.\n   NOTE: [18] requires the new request\
    \ to have the same Call-ID and the\n   same From header (including tag) as in\
    \ the previous INVITE request.\n   [18] recommends that the CSeq header should\
    \ contain a value higher\n   than that in the previous INVITE request.\n"
- title: 8.2.2.2.3.  Receipt of SIP 100 (Trying) Response to an INVITE Request
  contents:
  - "8.2.2.2.3.  Receipt of SIP 100 (Trying) Response to an INVITE Request\n   The\
    \ requirements of Section 8.2.1.2 SHALL apply.\n"
- title: 8.2.2.2.4.  Receipt of SIP 18x Provisional Response to an INVITE Request
  contents:
  - "8.2.2.2.4.  Receipt of SIP 18x Provisional Response to an INVITE Request\n  \
    \ The requirements of Section 8.2.1.3 SHALL apply.\n"
- title: 8.2.2.2.5.  Receipt of SIP 2xx Response to an INVITE Request
  contents:
  - "8.2.2.2.5.  Receipt of SIP 2xx Response to an INVITE Request\n   The requirements\
    \ of Section 8.2.1.4 SHALL apply.  In addition, the\n   gateway SHALL send a SIP\
    \ CANCEL request in accordance with Section\n   3.4 of [18] to cancel any SIP\
    \ INVITE transactions for which no final\n   response has been received.\n"
- title: 8.2.2.2.6.  Receipt of SIP 3xx Response to an INVITE Request
  contents:
  - "8.2.2.2.6.  Receipt of SIP 3xx Response to an INVITE Request\n   The requirements\
    \ of Section 8.2.1.5 SHALL apply.\n"
- title: 8.2.2.2.7.  Receipt of a SIP 4xx, 5xx, or 6xx Final Response to an
  contents:
  - "8.2.2.2.7.  Receipt of a SIP 4xx, 5xx, or 6xx Final Response to an\n        \
    \    INVITE Request\n   On receipt of a SIP 4xx, 5xx, or 6xx final response to\
    \ an INVITE\n   request, the gateway SHALL send back a SIP ACK request.  Unless\
    \ the\n   gateway is able to retry the INVITE request to avoid the problem\n \
    \  (e.g., by supplying authentication in the case of a 401 or 407\n   response),\
    \ the gateway SHALL also send a QSIG DISCONNECT message\n   (8.4.4) if no further\
    \ QSIG INFORMATION messages are expected and\n   final responses have been received\
    \ to all transmitted SIP INVITE\n   requests.\n   NOTE: Further QSIG INFORMATION\
    \ messages will not be expected after\n   QSIG timer T302 has expired or after\
    \ a Sending complete information\n   element has been received.\n   In all other\
    \ cases, the receipt of a SIP 4xx, 5xx, or 6xx final\n   response to an INVITE\
    \ request SHALL NOT trigger the sending of any\n   QSIG message.\n   NOTE: If\
    \ further QSIG INFORMATION messages arrive, these will result\n   in further SIP\
    \ INVITE requests being sent, one of which might result\n   in successful call\
    \ establishment.  For example, initial INVITE\n   requests might produce 484 (Address\
    \ Incomplete) or 404 (Not Found)\n   responses because the Request-URIs derived\
    \ from incomplete numbers\n   cannot be routed, yet a subsequent INVITE request\
    \ with a routable\n   Request-URI might produce a 2xx final response or a more\
    \ meaningful\n   4xx, 5xx, or 6xx final response.\n"
- title: 8.2.2.2.8.  Receipt of Multiple SIP Responses to an INVITE Request
  contents:
  - "8.2.2.2.8.  Receipt of Multiple SIP Responses to an INVITE Request\n   Section\
    \ 3.3 of [18] applies.\n"
- title: 8.2.2.2.9.  Cancelling Pending SIP INVITE Transactions
  contents:
  - "8.2.2.2.9.  Cancelling Pending SIP INVITE Transactions\n   As stated in Section\
    \ 3.4 of [18], when a gateway sends a new SIP\n   INVITE request containing new\
    \ digits, it SHOULD NOT send a SIP CANCEL\n   request to cancel a previous SIP\
    \ INVITE transaction that has not had\n   a final response.  This SIP CANCEL request\
    \ could arrive at an egress\n   gateway before the new SIP INVITE request and\
    \ trigger premature call\n   clearing.\n   NOTE: Previous SIP INVITE transactions\
    \ can be expected to result in\n   SIP 4xx class responses, which terminate the\
    \ transaction.  In Section\n   8.2.2.2.5, there is provision for cancelling any\
    \ transactions still\n   in progress after a SIP 2xx response has been received.\n"
- title: 8.2.2.2.10.  QSIG Timer T302 Expiry
  contents:
  - "8.2.2.2.10.  QSIG Timer T302 Expiry\n   If QSIG timer T302 expires and the gateway\
    \ has received 4xx, 5xx, or\n   6xx responses to all transmitted SIP INVITE requests,\
    \ the gateway\n   SHALL send a QSIG DISCONNECT message.  If T302 expires and the\n\
    \   gateway has not received 4xx, 5xx, or 6xx responses to all\n   transmitted\
    \ SIP INVITE requests, the gateway SHALL ignore any further\n   QSIG INFORMATION\
    \ messages but SHALL NOT send a QSIG DISCONNECT\n   message at this stage.\n \
    \  NOTE: A QSIG DISCONNECT request will be sent when all outstanding SIP\n   INVITE\
    \ requests have received 4xx, 5xx, or 6xx responses.\n"
- title: 8.3.  Call Establishment from SIP to QSIG
  contents:
  - '8.3.  Call Establishment from SIP to QSIG

    '
- title: 8.3.1.  Receipt of SIP INVITE Request for a New Call
  contents:
  - "8.3.1.  Receipt of SIP INVITE Request for a New Call\n   On receipt of a SIP\
    \ INVITE request for a new call, if a suitable\n   channel is available on the\
    \ inter-PINX link, the gateway SHALL\n   generate a QSIG SETUP message from the\
    \ received SIP INVITE request.\n   The gateway SHALL generate the Called party\
    \ number and Calling party\n   number information elements in accordance with\
    \ Section 9 and SHALL\n   generate the Bearer capability information element in\
    \ accordance with\n   Section 10.  If the gateway can determine that the number\
    \ placed in\n   the Called party number information element is complete, the gateway\n\
    \   MAY include the Sending complete information element.\n   NOTE: The means\
    \ by which the gateway determines the number to be\n   complete is an implementation\
    \ matter.  It can involve knowledge of\n   the numbering plan and/or use of the\
    \ inter-digit timer.\n   The gateway SHOULD send a SIP 100 (Trying) response.\n\
    \   If information in the SIP INVITE request is unsuitable for generating\n  \
    \ any of the mandatory information elements in a QSIG SETUP message\n   (e.g.,\
    \ if a QSIG Called party number information element cannot be\n   derived from\
    \ SIP Request-URI field) or if no suitable channel is\n   available on the inter-PINX\
    \ link, the gateway SHALL NOT issue a QSIG\n   SETUP message and SHALL send a\
    \ SIP 4xx, 5xx, or 6xx response.  If no\n   suitable channel is available, the\
    \ gateway should use response code\n   503 (Service Unavailable).\n   If the SIP\
    \ INVITE request does not contain SDP information and does\n   not contain either\
    \ a Required header or a Supported header with\n   option tag 100rel, the gateway\
    \ SHOULD still proceed as above,\n   although an implementation can instead send\
    \ a SIP 488 (Not Acceptable\n   Here) response, in which case it SHALL NOT issue\
    \ a QSIG SETUP\n   message.\n   NOTE: The absence of SDP offer information in\
    \ the SIP INVITE request\n   means that the gateway might need to send SDP offer\
    \ information in a\n   provisional response and receive SDP answer information\
    \ in a SIP\n   PRACK request (in accordance with [11]) in order to ensure that\
    \ tones\n   and announcements from the PISN are transmitted. SDP offer\n   information\
    \ cannot be sent in an unreliable provisional response\n   because SDP answer\
    \ information would need to be returned in a SIP\n   PRACK request.  The recommendation\
    \ above still to proceed with call\n   establishment in this situation reflects\
    \ the desire to maximise the\n   chances of a successful call.  However, if important\
    \ in-band\n   information is likely to be denied in this situation, a gateway\
    \ can\n   choose not to proceed.\n   NOTE: If SDP offer information is present\
    \ in the INVITE request, the\n   issuing of a QSIG SETUP message is not dependent\
    \ on the presence of a\n   Required header or a Supported header with option tag\
    \ 100rel.\n   On receipt of a SIP INVITE request relating to a call that has\n\
    \   already been established from SIP to QSIG, the procedures of 8.3.9\n   SHALL\
    \ apply.\n"
- title: 8.3.2.  Receipt of QSIG CALL PROCEEDING Message
  contents:
  - "8.3.2.  Receipt of QSIG CALL PROCEEDING Message\n   The receipt of a QSIG CALL\
    \ PROCEEDING message SHALL NOT result in any\n   SIP message being sent.\n"
- title: 8.3.3.  Receipt of QSIG PROGRESS Message
  contents:
  - "8.3.3.  Receipt of QSIG PROGRESS Message\n   A QSIG PROGRESS message can be received\
    \ in the event of interworking\n   on the remote side of the PISN or if the PISN\
    \ is unable to complete\n   the call and generates an in-band tone or announcement.\
    \  In the\n   latter case, a Cause information element is included in the QSIG\n\
    \   PROGRESS message.\n   The gateway SHALL map a received QSIG PROGRESS message\
    \ to a SIP 183\n   (Session Progress) response to the INVITE request.  If the\
    \ SIP INVITE\n   request contained either a Require header or a Supported header\
    \ with\n   option tag 100rel, the gateway SHALL include in the SIP 183 response\n\
    \   a Require header with option tag 100rel.\n   NOTE: In accordance with [11],\
    \ inclusion of option tag 100rel in a\n   provisional response instructs the UAC\
    \ to acknowledge the provisional\n   response by sending a PRACK request.  [11]\
    \ also specifies procedures\n   for repeating a provisional response with option\
    \ tag 100rel if no\n   PRACK is received.\n   If the QSIG PROGRESS message contained\
    \ a Progress indicator\n   information element with Progress description number\
    \ 1 or 8, the\n   gateway SHALL connect the media streams to the corresponding\
    \ user\n   information channel of the inter-PINX link if it has not already done\n\
    \   so, provided that SDP answer information is included in the\n   transmitted\
    \ SIP response to the INVITE request or has already been\n   sent or received.\
    \  Inclusion of SDP offer or answer information in\n   the 183 provisional response\
    \ SHALL be in accordance with Section\n   8.3.5.\n   If the QSIG PROGRESS message\
    \ is received with a Cause information\n   element, the gateway SHALL either wait\
    \ until the tone/announcement is\n   complete or has been applied for sufficient\
    \ time before initiating\n   call clearing, or wait for a SIP CANCEL request.\
    \  If call clearing is\n   initiated, the cause value in the QSIG PROGRESS message\
    \ SHALL be used\n   to derive the response to the SIP INVITE request in accordance\
    \ with\n   Table 1.\n"
- title: 8.3.4.  Receipt of QSIG ALERTING Message
  contents:
  - "8.3.4.  Receipt of QSIG ALERTING Message\n   The gateway SHALL map a QSIG ALERTING\
    \ message to a SIP 180 (Ringing)\n   response to the INVITE request.  If the SIP\
    \ INVITE request contained\n   either a Require header or a Supported header with\
    \ option tag 100rel,\n   the gateway SHALL include in the SIP 180 response a Require\
    \ header\n   with option tag 100rel.\n   NOTE: In accordance with [11], inclusion\
    \ of option tag 100rel in a\n   provisional response instructs the UAC to acknowledge\
    \ the provisional\n   response by sending a PRACK request.  [11] also specifies\
    \ procedures\n   for repeating a provisional response with option tag 100rel if\
    \ no\n   PRACK is received.\n   If the QSIG ALERTING message contained a Progress\
    \ indicator\n   information element with Progress description number 1 or 8, the\n\
    \   gateway SHALL connect the media streams to the corresponding user\n   information\
    \ channel of the inter-PINX link if it has not already done\n   so, provided that\
    \ SDP answer information is included in the\n   transmitted SIP response or has\
    \ already been sent or received.\n   Inclusion of SDP offer or answer information\
    \ in the 180 provisional\n   response SHALL be in accordance with Section 8.3.5.\n"
- title: 8.3.5.  Inclusion of SDP Information in a SIP 18x Provisional Response
  contents:
  - "8.3.5.  Inclusion of SDP Information in a SIP 18x Provisional Response\n   When\
    \ sending a SIP 18x provisional response to the INVITE request, if\n   a QSIG\
    \ message containing a Progress indicator information element\n   with progress\
    \ description number 1 or 8 has been received the gateway\n   SHALL include SDP\
    \ information.  Otherwise, the gateway MAY include\n   SDP information.  If SDP\
    \ information is included, it shall be in\n   accordance with the following rules.\n\
    \   If the SIP INVITE request contained a Required or Supported header\n   with\
    \ option tag 100rel, and if SDP offer and answer information has\n   already been\
    \ exchanged, no SDP information SHALL be included in the\n   SIP 18x provisional\
    \ response.\n   If the SIP INVITE request contained a Required or Supported header\n\
    \   with option tag 100rel, and if SDP offer information was received in\n   the\
    \ SIP INVITE request but no SDP answer information has been sent,\n   SDP answer\
    \ information SHALL be included in the SIP 18x provisional\n   response.\n   If\
    \ the SIP INVITE request contained a Required or Supported header\n   with option\
    \ tag 100rel, and if no SDP offer information was received\n   in the SIP INVITE\
    \ request and no SDP offer information has already\n   been sent, SDP offer information\
    \ SHALL be included in the SIP 18x\n   provisional response.\n   NOTE: In this\
    \ case, SDP answer information can be expected in the SIP\n   PRACK.\n   If the\
    \ SIP INVITE request contained neither a Required nor a\n   Supported header with\
    \ option tag 100rel, SDP answer information SHALL\n   be included in the SIP 18x\
    \ provisional response.\n   NOTE: Because the provisional response is unreliable,\
    \ SDP answer\n   information needs to be repeated in each provisional response\
    \ and in\n   the final SIP 2xx response.\n   NOTE: If the SIP INVITE request contained\
    \ no SDP offer information\n   and neither a Required nor a Supported header with\
    \ option tag 100rel,\n   it should have been rejected in accordance with Section\
    \ 8.3.1.\n"
- title: 8.3.6.  Receipt of QSIG CONNECT Message
  contents:
  - "8.3.6.  Receipt of QSIG CONNECT Message\n   The gateway SHALL map a QSIG CONNECT\
    \ message to a SIP 200 (OK) final\n   response for the SIP INVITE request.  The\
    \ gateway SHALL also send a\n   QSIG CONNECT ACKNOWLEDGE message.\n   If the SIP\
    \ INVITE request contained a Required or Supported header\n   with option tag\
    \ 100rel, and if SDP offer and answer information has\n   already been exchanged,\
    \ no SDP information SHALL be included in the\n   SIP 200 response.\n   If the\
    \ SIP INVITE request contained a Required or Supported header\n   with option\
    \ tag 100rel, and if SDP offer information was received in\n   the SIP INVITE\
    \ request but no SDP answer information has been sent,\n   SDP answer information\
    \ SHALL be included in the SIP 200 response.\n   If the SIP INVITE request contained\
    \ a Required or Supported header\n   with option tag 100rel, and if no SDP offer\
    \ information was received\n   in the SIP INVITE request and no SDP offer information\
    \ has already\n   been sent, SDP offer information SHALL be included in the SIP\
    \ 200\n   response.\n   NOTE: In this case, SDP answer information can be expected\
    \ in the SIP\n   ACK.\n   If the SIP INVITE request contained neither a Required\
    \ nor a\n   Supported header with option tag 100rel, SDP answer information SHALL\n\
    \   be included in the SIP 200 response.\n   NOTE: Because the provisional response\
    \ is unreliable, SDP answer\n   information needs to be repeated in each provisional\
    \ response and in\n   the final 2xx response.\n   NOTE: If the SIP INVITE request\
    \ contained no SDP offer information\n   and neither a Required nor a Supported\
    \ header with option tag 100rel,\n   it may have been rejected in accordance with\
    \ Section 8.3.1.\n   The gateway SHALL connect the media streams to the corresponding\
    \ user\n   information channel of the inter-PINX link if it has not already done\n\
    \   so, provided that SDP answer information is included in the\n   transmitted\
    \ SIP response or has already been sent or received.\n"
- title: 8.3.7.  Receipt of SIP PRACK Request
  contents:
  - "8.3.7.  Receipt of SIP PRACK Request\n   The receipt of a SIP PRACK request acknowledging\
    \ a reliable\n   provisional response SHALL NOT result in any QSIG message being\
    \ sent.\n   The gateway SHALL send back a SIP 200 (OK) response to the SIP PRACK\n\
    \   request.\n   If the SIP PRACK contains SDP answer information and a QSIG message\n\
    \   containing a Progress indicator information element with progress\n   description\
    \ number 1 or 8 has been received, the gateway SHALL\n   connect the media streams\
    \ to the corresponding user information\n   channel of the inter-PINX link.\n"
- title: 8.3.8.  Receipt of SIP ACK Request
  contents:
  - "8.3.8.  Receipt of SIP ACK Request\n   The receipt of a SIP ACK request SHALL\
    \ NOT result in any QSIG message\n   being sent.\n   If the SIP ACK contains SDP\
    \ answer information, the gateway SHALL\n   connect the media streams to the corresponding\
    \ user information\n   channel of the inter-PINX link if it has not already done\
    \ so.\n"
- title: 8.3.9.  Receipt of a SIP INVITE Request for a Call Already Being
  contents:
  - "8.3.9.  Receipt of a SIP INVITE Request for a Call Already Being\n        Established\n\
    \   A gateway can receive a call from SIP using overlap procedures.  This\n  \
    \ should occur when the UAC for the INVITE request is a gateway from a\n   network\
    \ that employs overlap procedures (e.g., an ISUP gateway or\n   another QSIG gateway)\
    \ and the gateway has not absorbed overlap.\n   For a call from SIP using overlap\
    \ procedures, the gateway will\n   receive multiple SIP INVITE requests that belong\
    \ to the same call but\n   have different Request-URI and To fields.  Each SIP\
    \ INVITE request\n   belongs to a different dialog.\n   A SIP INVITE request is\
    \ considered to be for the purpose of overlap\n   sending if, compared to a previously\
    \ received SIP INVITE request, it\n   has:\n      - the same Call-ID header;\n\
    \      - the same From header (including the tag);\n      - no tag in the To header;\n\
    \      - an updated Request-URI from which can be derived a called party\n   \
    \     number with a superset of the digits derived from the previously\n     \
    \   received SIP INVITE request;\n      and if\n      - the gateway has not yet\
    \ sent a final response other than 484 to\n        the previously received SIP\
    \ INVITE request.\n   If a gateway receives a SIP INVITE request for the purpose\
    \ of overlap\n   sending, it SHALL generate a QSIG INFORMATION message using the\
    \ call\n   reference of the existing QSIG call instead of a new QSIG SETUP\n \
    \  message and containing only the additional digits in the Called party\n   number\
    \ information element.  It SHALL also respond to the SIP INVITE\n   request received\
    \ previously with a SIP 484 Address Incomplete\n   response.\n   If a gateway\
    \ receives a SIP INVITE request that meets all of the\n   conditions for a SIP\
    \ INVITE request for the purpose of overlap\n   sending except the condition concerning\
    \ the Request-URI, the gateway\n   SHALL respond to the new request with a SIP\
    \ 485 (Ambiguous) response.\n"
- title: 8.4.  Call Clearing and Call Failure
  contents:
  - '8.4.  Call Clearing and Call Failure

    '
- title: 8.4.1.  Receipt of a QSIG DISCONNECT, RELEASE, or RELEASE COMPLETE
  contents:
  - "8.4.1.  Receipt of a QSIG DISCONNECT, RELEASE, or RELEASE COMPLETE\n        Message\n\
    \   On receipt of QSIG DISCONNECT, RELEASE, or RELEASE COMPLETE message\n   as\
    \ the first QSIG call clearing message, gateway behaviour SHALL\n   depend on\
    \ the state of call establishment.\n   1) If the gateway has sent a SIP 200 (OK)\
    \ response to a SIP INVITE\n      request and received a SIP ACK request, or if\
    \ it has received a\n      SIP 200 (OK) response to a SIP INVITE request and sent\
    \ a SIP ACK\n      request, the gateway SHALL send a SIP BYE request to clear\
    \ the\n      call.\n   2) If the gateway has sent a SIP 200 (OK) response to a\
    \ SIP INVITE\n      request (indicating that call establishment is complete) but\
    \ has\n      not received a SIP ACK request, the gateway SHALL wait until a SIP\n\
    \      ACK is received and then send a SIP BYE request to clear the call.\n  \
    \ 3) If the gateway has sent a SIP INVITE request and received a SIP\n      provisional\
    \ response but not a SIP final response, the gateway\n      SHALL send a SIP CANCEL\
    \ request to clear the call.\n      NOTE 1: In accordance with [10], if after\
    \ sending a SIP CANCEL\n      request a SIP 2xx response is received to the SIP\
    \ INVITE request,\n      the gateway will need to send a SIP BYE request.\n  \
    \ 4) If the gateway has sent a SIP INVITE request but received no SIP\n      response,\
    \ the gateway SHALL NOT send a SIP message.  If a SIP\n      final or provisional\
    \ response is subsequently received, the\n      gateway SHALL then act in accordance\
    \ with 1, 2, or 3 above,\n      respectively.\n   5) If the gateway has received\
    \ a SIP INVITE request but not sent a\n      SIP final response, the gateway SHALL\
    \ send a SIP final response\n      chosen according to the cause value in the\
    \ received QSIG message\n      as specified in Table 1.  SIP response 500 (Server\
    \ internal error)\n      SHALL be used as the default for cause values not shown\
    \ in\n      Table 1.\n   NOTE 2: It is not necessarily appropriate to map some\
    \ QSIG cause\n   values to SIP messages because these cause values are meaningful\
    \ only\n   at the gateway.  A good example of this is cause value 44, \"Requested\n\
    \   circuit or channel not available\", which signifies that the channel\n   number\
    \ in the transmitted QSIG SETUP message was not acceptable to\n   the peer PINX.\
    \  The appropriate behavior in this case is for the\n   gateway to send another\
    \ SETUP message indicating a different channel\n   number.  If this is not possible,\
    \ the gateway should treat it either\n   as a congestion situation (no channels\
    \ available; see Section 8.3.1)\n   or as a gateway failure situation (in which\
    \ case the default SIP\n   response code applies).\n   In all cases, the gateway\
    \ SHALL also disconnect media streams, if\n   established, and allow QSIG and\
    \ SIP signalling to complete in\n   accordance with [2] and [10], respectively.\n\
    \   Table 1: Mapping of QSIG Cause Value to SIP 4xx-6xx responses to an\n   INVITE\
    \ request\n   QSIG Cause value               SIP response\n   ----------------------------------------------------------------\n\
    \   1  Unallocated number          404 Not found\n   2  No route to specified\
    \       404 Not found\n      transit network\n   3  No route to destination  \
    \   404 Not found\n   16 Normal call clearing        (NOTE 3)\n   17 User busy\
    \                   486 Busy here\n   18 No user responding          408 Request\
    \ timeout\n   19 No answer from the user     480 Temporarily unavailable\n   20\
    \ Subscriber absent           480 Temporarily unavailable\n   21 Call rejected\
    \               603 Decline, if location field\n                             \
    \         in Cause information element\n                                     \
    \ indicates user.  Otherwise:\n                                      403 Forbidden\n\
    \   22 Number changed              301 Moved permanently, if\n               \
    \                       information in diagnostic field\n                    \
    \                  of Cause information element is\n                         \
    \             suitable for generating a SIP\n                                \
    \      Contact header.  Otherwise:\n                                      410\
    \ Gone\n   23 Redirection to new          410 Gone\n      destination\n   27 Destination\
    \ out of order    502 Bad gateway\n   28 Address incomplete          484 Address\
    \ incomplete\n   29 Facility rejected           501 Not implemented\n   31 Normal,\
    \ unspecified         480 Temporarily unavailable\n   34 No circuit/channel  \
    \        503 Service unavailable\n      available\n   38 Network out of order\
    \        503 Service unavailable\n   41 Temporary failure           503 Service\
    \ unavailable\n   42 Switching equipment         503 Service unavailable\n   \
    \   congestion\n   47 Resource unavailable,       503 Service unavailable\n  \
    \    unspecified\n   55 Incoming calls barred       403 Forbidden\n      within\
    \ CUG\n   57 Bearer capability not       403 Forbidden\n      authorized\n   58\
    \ Bearer capability not       503 Service unavailable\n      presently available\n\
    \   65 Bearer capability not       488 Not acceptable here (NOTE 4)\n      implemented\n\
    \   69 Requested facility not      501 Not implemented\n      implemented\n  \
    \ 70 Only restricted digital     488 Not acceptable here (NOTE 4)\n      information\
    \ available\n   79 Service or option not       501 Not implemented\n      implemented,\
    \ unspecified\n   87 User not member of CUG      403 Forbidden\n   88 Incompatible\
    \ destination    503 Service unavailable\n   102 Recovery on timer expiry   504\
    \ Server time-out\n   NOTE 3: A QSIG call clearing message containing cause value\
    \ 16 will\n   normally result in the sending of a SIP BYE or CANCEL request.\n\
    \   However, if a SIP response is to be sent to the INVITE request, the\n   default\
    \ response code should be used.\n   NOTE 4: The gateway may include a SIP Warning\
    \ header if diagnostic\n   information in the QSIG Cause information element allows\
    \ a suitable\n   warning code to be selected.\n"
- title: 8.4.2.  Receipt of a SIP BYE Request
  contents:
  - "8.4.2.  Receipt of a SIP BYE Request\n   On receipt of a SIP BYE request, the\
    \ gateway SHALL send a QSIG\n   DISCONNECT message with cause value 16 (normal\
    \ call clearing).  The\n   gateway SHALL also disconnect media streams, if established,\
    \ and\n   allow QSIG and SIP signalling to complete in accordance with [2] and\n\
    \   [10], respectively.\n   NOTE: When responding to a SIP BYE request, in accordance\
    \ with [10],\n   the gateway is also required to respond to any other outstanding\n\
    \   transactions, e.g., with a SIP 487 (Request Terminated) response.\n   This\
    \ applies in particular if the gateway has not yet returned a\n   final response\
    \ to the SIP INVITE request.\n"
- title: 8.4.3.  Receipt of a SIP CANCEL Request
  contents:
  - "8.4.3.  Receipt of a SIP CANCEL Request\n   On receipt of a SIP CANCEL request\
    \ to clear a call for which the\n   gateway has not sent a SIP final response\
    \ to the received SIP INVITE\n   request, the gateway SHALL send a QSIG DISCONNECT\
    \ message with cause\n   value 16 (normal call clearing).  The gateway SHALL also\
    \ disconnect\n   media streams, if established, and allow QSIG and SIP signalling\
    \ to\n   complete in accordance with [2] and [10], respectively.\n"
- title: 8.4.4.  Receipt of a SIP 4xx-6xx Response to an INVITE Request
  contents:
  - "8.4.4.  Receipt of a SIP 4xx-6xx Response to an INVITE Request\n   Except where\
    \ otherwise specified in the context of overlap sending\n   (8.2.2.2), on receipt\
    \ of a SIP final response (4xx-6xx) to a SIP\n   INVITE request, unless the gateway\
    \ is able to retry the INVITE\n   request to avoid the problem (e.g., by supplying\
    \ authentication in\n   the case of a 401 or 407 response), the gateway SHALL\
    \ transmit a QSIG\n   DISCONNECT message.  The cause value in the QSIG DISCONNECT\
    \ message\n   SHALL be derived from the SIP 4xx-6xx response according to Table\
    \ 2.\n   Cause value 31 (Normal, unspecified) SHALL be used as the default for\n\
    \   SIP responses not shown in Table 2.  The gateway SHALL also\n   disconnect\
    \ media streams, if established, and allow QSIG and SIP\n   signalling to complete\
    \ in accordance with [2] and [10], respectively.\n   When generating a QSIG Cause\
    \ information element, the location field\n   SHOULD contain the value \"user\"\
    , if generated as a result of a SIP\n   response code 6xx, or the value \"Private\
    \ network serving the remote\n   user\" in other circumstances.\n   Table 2: Mapping\
    \ of SIP 4xx-6xx responses to an INVITE request to\n   QSIG Cause values\n   SIP\
    \ response                        QSIG Cause value (NOTE 6)\n   ------------------------------------------------------------------\n\
    \   400 Bad request                     41  Temporary failure\n   401 Unauthorized\
    \                    21  Call rejected (NOTE 5)\n   402 Payment required     \
    \           21  Call rejected\n   403 Forbidden                       21  Call\
    \ rejected\n   404 Not found                       1   Unallocated number\n  \
    \ 405 Method not allowed              63  Service or option\n                \
    \                           unavailable, unspecified\n   406 Not acceptable  \
    \                79  Service or option not\n                                 \
    \          implemented, unspecified\n   407 Proxy Authentication required   21\
    \  Call rejected (NOTE 5)\n   408 Request timeout                 102 Recovery\
    \ on timer expiry\n   410 Gone                            22  Number changed\n\
    \   413 Request entity too large        127 Interworking, unspecified\n      \
    \                                     (NOTE 6)\n   414 Request-URI too long  \
    \          127 Interworking, unspecified\n                                   \
    \        (NOTE 6)\n   415 Unsupported media type          79  Service or option\
    \ not\n                                           implemented, unspecified\n \
    \                                          (NOTE 6)\n   416 Unsupported URI scheme\
    \          127 Interworking, unspecified\n                                   \
    \        (NOTE 6)\n   420 Bad extension                   127 Interworking, unspecified\n\
    \                                           (NOTE 6)\n   421 Extension required\
    \              127 Interworking, unspecified\n                               \
    \            (NOTE 6)\n   423 Interval too brief              127 Interworking,\
    \ unspecified\n                                           (NOTE 6)\n   480 Temporarily\
    \ unavailable         18  No user responding\n   481 Call/transaction does not\
    \ exist 41  Temporary failure\n   482 Loop detected                   25  Exchange\
    \ routing error\n   483 Too many hops                   25  Exchange routing error\n\
    \   484 Address incomplete              28  Invalid number format\n          \
    \                                 (NOTE 6)\n   485 Ambiguous                 \
    \      1   Unallocated Number\n   486 Busy here                       17  User\
    \ busy\n   487 Request terminated              (NOTE 7)\n   488 Not Acceptable\
    \ Here             65  Bearer capability not\n                               \
    \            implemented or 31 Normal,\n                                     \
    \      unspecified (NOTE 8)\n   500 Server internal error           41  Temporary\
    \ failure\n   501 Not implemented                 79  Service or option not\n\
    \                                           implemented, unspecified\n   502 Bad\
    \ gateway                     38  Network out of order\n   503 Service unavailable\
    \             41  Temporary failure\n   504 Gateway time-out                102\
    \ Recovery on timer expiry\n   505 Version not supported           127 Interworking,\
    \ unspecified\n                                           (NOTE 6)\n   513 Message\
    \ too large               127 Interworking, unspecified\n                    \
    \                       (NOTE 6)\n   600 Busy everywhere                 17  User\
    \ busy\n   603 Decline                         21  Call rejected\n   604 Does\
    \ not exist anywhere         1   Unallocated number\n   606 Not acceptable   \
    \               65  Bearer capability not\n                                  \
    \         implemented or\n                                       31  Normal, unspecified\
    \ (NOTE 8)\n   NOTE 5: In some cases, it may be possible for the gateway to provide\n\
    \   credentials to the SIP UAS that is rejecting an INVITE due to\n   authorization\
    \ failure.  If the gateway can authenticate itself, then\n   obviously it should\
    \ do so and proceed with the call.  Only if the\n   gateway cannot authorize itself\
    \ should the gateway clear the call in\n   the QSIG network with this cause value.\n\
    \   NOTE 6: For some response codes, the gateway may be able to retry the\n  \
    \ INVITE request in order to work around the problem.  In particular,\n   this\
    \ may be the case with response codes indicating a protocol error.\n   The gateway\
    \ SHOULD clear the call in the QSIG network with the\n   indicated cause value\
    \ only if retry is not possible or fails.\n   NOTE 7: The circumstances in which\
    \ SIP response code 487 can be\n   expected to arise do not require it to be mapped\
    \ to a QSIG cause\n   code, since the QSIG call will normally already be cleared\
    \ or in the\n   process of clearing.  If QSIG call clearing does, however, need\
    \ to be\n   initiated, the default cause value should be used.\n   NOTE 8: When\
    \ the Warning header is present in a SIP 606 or 488\n   message, the warning code\
    \ should be examined to determine whether it\n   is reasonable to generate cause\
    \ value 65.  This cause value should be\n   generated only if there is a chance\
    \ that a new call attempt with\n   different content in the Bearer capability\
    \ information element will\n   avoid the problem.  In other circumstances, the\
    \ default cause value\n   should be used.\n"
- title: 8.4.5 Gateway-Initiated Call Clearing
  contents:
  - "8.4.5 Gateway-Initiated Call Clearing\n   If the gateway initiates clearing of\
    \ the QSIG call owing to QSIG\n   timer expiry, QSIG protocol error, or use of\
    \ the QSIG RESTART message\n   in accordance with [2], the gateway SHALL also\
    \ initiate clearing of\n   the SIP call in accordance with Section 8.4.1.  If\
    \ this involves the\n   sending of a final response to a SIP INVITE request, the\
    \ gateway\n   SHALL use response code 480 (Temporarily Unavailable) if optional\n\
    \   QSIG timer T301 has expired or, otherwise, response code 408 (Request\n  \
    \ timeout) or 500 (Server internal error), as appropriate.\n   If the gateway\
    \ initiates clearing of the SIP call owing to SIP timer\n   expiry or SIP protocol\
    \ error in accordance with [10], the gateway\n   SHALL also initiate clearing\
    \ of the QSIG call in accordance with [2]\n   using cause value 102 (Recovery\
    \ on timer expiry) or 41 (Temporary\n   failure), as appropriate.\n"
- title: 8.5.  Request to Change Media Characteristics
  contents:
  - "8.5.  Request to Change Media Characteristics\n   If after a call has been successfully\
    \ established the gateway\n   receives a SIP INVITE request to change the media\
    \ characteristics of\n   the call in a way that would be incompatible with the\
    \ bearer\n   capability in use within the PISN, the gateway SHALL send back a\
    \ SIP\n   488 (Not Acceptable Here) response and SHALL NOT change the media\n\
    \   characteristics of the existing call.\n"
- title: 9.  Number Mapping
  contents:
  - "9.  Number Mapping\n   In QSIG, users are identified by numbers, as defined in\
    \ [1].  Numbers\n   are conveyed within the Called party number, Calling party\
    \ number,\n   and Connected number information elements.  The Calling party number\n\
    \   and Connected number information elements also contain a presentation\n  \
    \ indicator, which can indicate that privacy is required (presentation\n   restricted),\
    \ and a screening indicator, which indicates the source\n   and authentication\
    \ status of the number.\n   In SIP, users are identified by Universal Resource\
    \ Identifiers (URIs)\n   conveyed within the Request-URI and various headers,\
    \ including the\n   From and To headers specified in [10] and optionally the P-Asserted-\n\
    \   Identity header specified in [14].  In addition, privacy is indicated\n  \
    \ by the Privacy header specified in [13].\n   This clause specifies the mapping\
    \ between QSIG Called party number,\n   Calling party number, and Connected number\
    \ information elements and\n   corresponding elements in SIP.\n   A gateway MAY\
    \ implement the P-Asserted-Identity header in accordance\n   with [14].  If a\
    \ gateway implements the P-Asserted-Identity header,\n   it SHALL also implement\
    \ the Privacy header in accordance with [13].\n   If a gateway does not implement\
    \ the P-Asserted-Identity header, it\n   MAY implement the Privacy header.\n"
- title: 9.1.  Mapping from QSIG to SIP
  contents:
  - "9.1.  Mapping from QSIG to SIP\n   The method used to convert a number to a URI\
    \ is outside the scope of\n   this specification.  However, the gateway SHOULD\
    \ take account of the\n   Numbering Plan (NPI) and Type Of Number (TON) fields\
    \ in the QSIG\n   information element concerned when interpreting a number.\n\
    \   Some aspects of mapping depend on whether the gateway is in the same\n   trust\
    \ domain (as defined in [14]) as the next hop SIP node (i.e., the\n   proxy or\
    \ UA to which the INVITE request is sent or from which INVITE\n   request is received)\
    \ to honour requests for identity privacy in the\n   Privacy header.  This will\
    \ be network-dependent, and it is\n   RECOMMENDED that gateways supporting the\
    \ P-Asserted-Identity header\n   hold a configurable list of next hop nodes that\
    \ are to be trusted in\n   this respect.\n"
- title: 9.1.1.  Using Information from the QSIG Called Party Number Information
  contents:
  - "9.1.1.  Using Information from the QSIG Called Party Number Information\n   \
    \     Element\n   When mapping a QSIG SETUP message to a SIP INVITE request, the\n\
    \   gateway SHALL convert the number in the QSIG Called party number\n   information\
    \ to a URI and include that URI in the SIP Request-URI and\n   in the To header.\n"
- title: 9.1.2.  Using Information from the QSIG Calling Party Number Information
  contents:
  - "9.1.2.  Using Information from the QSIG Calling Party Number Information\n  \
    \      Element\n   When mapping a QSIG SETUP message to a SIP INVITE request,\
    \ the\n   gateway SHALL use the Calling party number information element, if\n\
    \   present, as follows.\n   If the information element contains a number, the\
    \ gateway SHALL\n   attempt to derive a URI from that number.  Further behaviour\
    \ depends\n   on whether a URI has been derived and the value of the presentation\n\
    \   indication.\n"
- title: 9.1.2.1.  No URI derived, and presentation indicator does not have value
  contents:
  - "9.1.2.1.  No URI derived, and presentation indicator does not have value\n  \
    \        \"presentation restricted\"\n   In this case (including the case where\
    \ the Calling party number\n   information element is absent), the gateway SHALL\
    \ include a URI\n   identifying the gateway in the From header.  Also, if the\
    \ gateway\n   supports the mechanism defined in [14], the gateway SHALL NOT\n\
    \   generate a P-Asserted-Identity header.\n"
- title: 9.1.2.2.  No URI derived, and presentation indicator has value
  contents:
  - "9.1.2.2.  No URI derived, and presentation indicator has value\n          \"\
    presentation restricted\"\n   In this case, the gateway SHALL generate an anonymous\
    \ From header.\n   Also, if the gateway supports the mechanism defined in [14],\
    \ the\n   gateway SHALL generate a Privacy header field with parameter\n   priv-value\
    \ = \"id\" and SHALL NOT generate a P-Asserted-Identity\n   header.  The inclusion\
    \ of additional values of the priv-value\n   parameter in the Privacy header is\
    \ outside the scope of this\n   specification.\n"
- title: 9.1.2.3.  URI derived, and presentation indicator has value
  contents:
  - "9.1.2.3.  URI derived, and presentation indicator has value\n          \"presentation\
    \ restricted\"\n   If the gateway supports the P-Asserted-Identity header and\
    \ trusts the\n   next hop proxy to honour the Privacy header, the gateway SHALL\n\
    \   generate a P-Asserted-Identity header containing the derived URI,\n   SHALL\
    \ generate a Privacy header with parameter priv-value = \"id\", and\n   SHALL\
    \ generate an anonymous From header.  The inclusion of additional\n   values of\
    \ the priv-value parameter in the Privacy header is outside\n   the scope of this\
    \ specification.\n   If the gateway does not support the P-Asserted-Identity header\
    \ or\n   does not trust the proxy to honour the Privacy header, the gateway\n\
    \   SHALL behave as in Section 9.1.2.2.\n"
- title: 9.1.2.4.  URI derived, and presentation indicator does not have value
  contents:
  - "9.1.2.4.  URI derived, and presentation indicator does not have value\n     \
    \     \"presentation restricted\"\n   In this case, the gateway SHALL generate\
    \ a P-Asserted-Identity header\n   containing the derived URI if the gateway supports\
    \ this header, SHALL\n   NOT generate a Privacy header, and SHALL include the\
    \ derived URI in\n   the From header.  In addition, the gateway MAY use S/MIME,\
    \ as\n   described in Section 23 of [10], to sign a copy of the From header\n\
    \   included in a message/sipfrag body of the INVITE request as described\n  \
    \ in [20].\n"
- title: 9.1.3.  Using Information from the QSIG Connected Number Information
  contents:
  - "9.1.3.  Using Information from the QSIG Connected Number Information\n      \
    \  Element\n   When mapping a QSIG CONNECT message to a SIP 200 (OK) response\
    \ to an\n   INVITE request, the gateway SHALL use the Connected number\n   information\
    \ element, if present, as follows.\n   If the information element contains a number,\
    \ the gateway SHALL\n   attempt to derive a URI from that number.  Further behaviour\
    \ depends\n   on whether a URI has been derived and the value of the presentation\n\
    \   indication.\n"
- title: 9.1.3.1.  No URI derived, and presentation indicator does not have value
  contents:
  - "9.1.3.1.  No URI derived, and presentation indicator does not have value\n  \
    \        \"presentation restricted\"\n   In this case (including the case where\
    \ the Connected number\n   information element is absent), the gateway SHALL NOT\
    \ generate a\n   P-Asserted-Identity header and SHALL NOT generate a Privacy header.\n"
- title: 9.1.3.2.  No URI derived, and presentation indicator has value
  contents:
  - "9.1.3.2.  No URI derived, and presentation indicator has value\n          \"\
    presentation restricted\"\n   In this case, if the gateway supports the mechanism\
    \ defined in [14],\n   the gateway SHALL generate a Privacy header field with\
    \ parameter\n   priv-value = \"id\" and SHALL NOT generate a P-Asserted-Identity\n\
    \   header.  The inclusion of additional values of the priv-value\n   parameter\
    \ in the Privacy header is outside the scope of this\n   specification.\n"
- title: 9.1.3.3.  URI derived, and presentation indicator has value
  contents:
  - "9.1.3.3.  URI derived, and presentation indicator has value\n          \"presentation\
    \ restricted\"\n   If the gateway supports the P-Asserted-Identity header and\
    \ trusts the\n   next hop proxy to honour the Privacy header, the gateway SHALL\n\
    \   generate a P-Asserted-Identity header containing the derived URI and\n   SHALL\
    \ generate a Privacy header with parameter priv-value = \"id\".\n   The inclusion\
    \ of additional values of the priv-value parameter in the\n   Privacy header is\
    \ outside the scope of this specification.\n   If the gateway does not support\
    \ the P-Asserted-Identity header or\n   does not trust the proxy to honour the\
    \ Privacy header, the gateway\n   SHALL behave as in Section 9.1.3.2.\n"
- title: 9.1.3.4.  URI derived, and presentation indicator does not have value
  contents:
  - "9.1.3.4.  URI derived, and presentation indicator does not have value\n     \
    \     \"presentation restricted\"\n   In this case, the gateway SHALL generate\
    \ a P-Asserted-Identity header\n   containing the derived URI if the gateway supports\
    \ this header and\n   SHALL NOT generate a Privacy header.  In addition, the gateway\
    \ MAY\n   use S/MIME, as described in Section 23 of [10], to sign a To header\n\
    \   containing the derived URI, the To header being included in a\n   message/sipfrag\
    \ body of the INVITE response as described in [20].\n   NOTE: The To header in\
    \ the message/sipfrag body may differ from the\n   to header in the response's\
    \ headers.\n"
- title: 9.2.  Mapping from SIP to QSIG
  contents:
  - "9.2.  Mapping from SIP to QSIG\n   The method used to convert a URI to a number\
    \ is outside the scope of\n   this specification.  However, NPI and TON fields\
    \ in the QSIG\n   information element concerned SHALL be set to appropriate values\
    \ in\n   accordance with [1].\n   Some aspects of mapping depend on whether the\
    \ gateway trusts the next\n   hop SIP node (i.e., the proxy or UA to which the\
    \ INVITE request is\n   sent or from which INVITE request is received) to provide\
    \ accurate\n   information in the P-Asserted-Identity header.  This will be\n\
    \   network-dependent, and it is RECOMMENDED that gateways hold a\n   configurable\
    \ list of next hop nodes that are to be trusted in this\n   respect.\n   Some\
    \ aspects of mapping depend on whether the gateway is prepared to\n   use a URI\
    \ in the From header to derive a number for the Calling party\n   number information\
    \ element.  The default behaviour SHOULD be not to\n   use an unsigned or unvalidated\
    \ From header for this purpose, since in\n   principle the information comes from\
    \ an untrusted source (the remote\n   UA).  However, it is recognised that some\
    \ network administrations may\n   believe that the benefits to be derived from\
    \ supplying a calling\n   party number outweigh any risks of supplying false information.\n\
    \   Therefore, a gateway MAY be configurable to use an unsigned or\n   unvalidated\
    \ From header for this purpose.\n"
- title: 9.2.1.  Generating the QSIG Called Party Number Information Element
  contents:
  - "9.2.1.  Generating the QSIG Called Party Number Information Element\n   When\
    \ mapping a SIP INVITE request to a QSIG SETUP message, the\n   gateway SHALL\
    \ convert the URI in the SIP Request-URI to a number and\n   include that number\
    \ in the QSIG Called party number information\n   element.\n   NOTE: The To header\
    \ should not be used for this purpose.  This is\n   because re-targeting of the\
    \ request in the SIP network can change the\n   Request-URI but leave the To header\
    \ unchanged.  It is important that\n   routing in the QSIG network be based on\
    \ the final target from the SIP\n   network.\n"
- title: 9.2.2.  Generating the QSIG Calling Party Number Information Element
  contents:
  - "9.2.2.  Generating the QSIG Calling Party Number Information Element\n   When\
    \ mapping a SIP INVITE request to a QSIG SETUP message, the\n   gateway SHALL\
    \ generate a Calling party number information element as\n   follows.\n   If the\
    \ SIP INVITE request contains an S/MIME signed message/sipfrag\n   body [20] containing\
    \ a From header, and if the gateway supports this\n   capability and can verify\
    \ the authenticity and trustworthiness of\n   this information, the gateway SHALL\
    \ attempt to derive a number from\n   the URI in that header.  If no number is\
    \ derived from a\n   message/sipfrag body, if the SIP INVITE request contains\
    \ a P-\n   Asserted-Identity header, and if the gateway supports that header and\n\
    \   trusts the information therein, the gateway SHALL attempt to derive a\n  \
    \ number from the URI in that header.  If a number is derived from one\n   of\
    \ these headers, the gateway SHALL include it in the Calling party\n   number\
    \ information element and include value \"network provided\" in\n   the screening\
    \ indicator.\n   If no number is derivable as described above and if the gateway\
    \ is\n   prepared to use the unsigned or unvalidated From header, the gateway\n\
    \   SHALL attempt to derive a number from the URI in the From header.  If\n  \
    \ a number is derived from the From header, the gateway SHALL include\n   it in\
    \ the Calling party number information element and include value\n   \"user provided,\
    \ not screened\" in the screening indicator.\n   If no number is derivable, the\
    \ gateway SHALL NOT include a number in\n   the Calling party number information\
    \ element.\n   If the SIP INVITE request contains a Privacy header with value\
    \ \"id\"\n   in parameter priv-value and the gateway supports this header, or\
    \ if\n   the value in the From header indicates anonymous, the gateway SHALL\n\
    \   include value \"presentation restricted\" in the presentation\n   indicator.\
    \  Based on local policy, the gateway MAY use the presence\n   of other priv-values\
    \ to set the presentation indicator to\n   \"presentation restricted\".  Otherwise\
    \ the gateway SHALL include value\n   \"presentation allowed\" if a number is\
    \ present or \"not available due\n   to interworking\" if no number is present.\n\
    \   If the resulting Calling party number information element contains no\n  \
    \ number and contains value \"not available due to interworking\" in the\n   presentation\
    \ indicator, the gateway MAY omit the information element\n   from the QSIG SETUP\
    \ message.\n"
- title: 9.2.3.  Generating the QSIG Connected Number Information Element
  contents:
  - "9.2.3.  Generating the QSIG Connected Number Information Element\n   When mapping\
    \ a SIP 2xx response to an INVITE request to a QSIG\n   CONNECT message, the gateway\
    \ SHALL generate a Connected number\n   information element as follows.\n   If\
    \ the SIP 2xx response contains an S/MIME signed message/sipfrag\n   [20] body\
    \ containing a To header and the gateway supports this\n   capability and can\
    \ verify the authenticity and trustworthiness of\n   this information, the gateway\
    \ SHALL attempt to derive a number from\n   the URI in that header.  If no number\
    \ is derived from a\n   message/sipfrag body, if the SIP 2xx response contains\
    \ a\n   P-Asserted-Identity header, and if the gateway supports that header\n\
    \   and trusts the information therein, the gateway SHALL attempt to\n   derive\
    \ a number from the URI in that header.  If a number is derived\n   from one of\
    \ these headers, the gateway SHALL include it in the\n   Connected number information\
    \ element and include value \"network\n   provided\" in the screening indicator.\n\
    \   If no number is derivable as described above, the gateway SHOULD NOT\n   include\
    \ a number in the Connected number information element.\n   If the SIP 2xx response\
    \ contains a Privacy header with value \"id\" in\n   parameter priv-value and\
    \ the gateway supports this header, the\n   gateway SHALL include value \"presentation\
    \ restricted\" in the\n   presentation indicator.  Based on local policy, the\
    \ gateway MAY use\n   the presence of other priv-values to set the presentation\
    \ indicator\n   to \"presentation restricted\".  Otherwise, the gateway SHALL\
    \ include\n   value \"presentation allowed\" if a number is present or \"not available\n\
    \   due to interworking\" if no number is present.\n   If the resulting Connected\
    \ number information element contains no\n   number and value \"not available\
    \ due to interworking\" in the\n   presentation indicator, the gateway MAY omit\
    \ the information element\n   from the QSIG CONNECT message.\n"
- title: 10.  Requirements for Support of Basic Services
  contents:
  - "10.  Requirements for Support of Basic Services\n   This document specifies signalling\
    \ interworking for basic services\n   that provide a bi-directional transfer capability\
    \ for speech,\n   facsimile, and modem media between the two networks.\n"
- title: 10.1.  Derivation of QSIG Bearer Capability Information Element
  contents:
  - "10.1.  Derivation of QSIG Bearer Capability Information Element\n   The gateway\
    \ SHALL generate the Bearer Capability Information Element\n   in the QSIG SETUP\
    \ message based on SDP offer information received\n   along with the SIP INVITE\
    \ request.  If the SIP INVITE request does\n   not contain SDP offer information\
    \ or the media type in the SDP offer\n   information is only 'audio', then the\
    \ Bearer capability information\n   element SHALL BE generated according to Table\
    \ 3.  Coding of the\n   Bearer capability information element for other media\
    \ types is\n   outside the scope of this specification.\n   In addition, the gateway\
    \ MAY include a Low layer compatibility\n   information element and/or High layer\
    \ compatibility information in\n   the QSIG SETUP message if the gateway is able\
    \ to derive relevant\n   information from the SDP offer information.  Specific\
    \ mappings are\n   outside the scope of this specification.\n      Table 3: Bearer\
    \ capability encoding for 'audio' transfer\n   Field                         \
    \ Value\n   -----------------------------------------------------------------\n\
    \   Coding Standard                \"CCITT standardized coding\" (00)\n   Information\
    \ transfer           \"3,1 kHz audio\" (10000)\n   capability\n   Transfer mode\
    \                  \"circuit mode\" (00)\n   Information transfer rate      \"\
    64 Kbits/s\" (10000)\n   Multiplier                     Octet omitted\n   User\
    \ information layer 1       Generated by gateway based on\n   protocol       \
    \                Information of the PISN.  Supported\n                       \
    \           values are\n                                  \"CCITT recommendation\
    \ G.711 mu-law\"\n                                  (00010)\n                \
    \                  \"CCITT recommendation G.711 A-law\"\n                    \
    \              (00011)\n"
- title: 10.2.  Derivation of Media Type in SDP
  contents:
  - "10.2.  Derivation of Media Type in SDP\n   The gateway SHALL generate SDP offer\
    \ information to include in the\n   SIP INVITE request based on information in\
    \ the QSIG SETUP message.\n   The gateway MAY take account of QSIG Low layer compatibility\
    \ and/or\n   High layer compatibility information elements, if present in the\
    \ QSIG\n   SETUP message, when deriving SDP offer information, in which case\n\
    \   specific mappings are outside the scope of this specification.\n   Otherwise,\
    \ the gateway shall generate SDP offer information based\n   only on the Bearer\
    \ capability information element in the QSIG SETUP\n   message, in which case\
    \ the media type SHALL be derived according to\n   Table 4.\n      Table 4: Media\
    \ type setting in SDP based on Bearer capability\n      information element\n\
    \   Information transfer capability in          Media type in SDP\n   Bearer capability\
    \ information element\n   ---------------------------------------------------------------\n\
    \   \"speech\" (00000)                            audio\n   \"3,1 kHz audio\"\
    \ (10000)                     audio\n"
- title: 11.  Security Considerations
  contents:
  - '11.  Security Considerations

    '
- title: 11.1.  General
  contents:
  - "11.1.  General\n   Normal considerations apply for UA use of SIP security measures,\n\
    \   including digest authentication, TLS, and S/MIME as described in\n   [10].\n\
    \   The translation of QSIG information elements into SIP headers can\n   introduce\
    \ some privacy and security concerns.  For example, care\n   needs to be taken\
    \ to provide adequate privacy for a user requesting\n   presentation restriction\
    \ if the Calling party number information\n   element is openly mapped to the\
    \ From header.  Procedures for dealing\n   with this particular situation are\
    \ specified in Section 9.1.2.\n   However, since the mapping specified in this\
    \ document is mainly\n   concerned with translating information elements into\
    \ the headers and\n   fields used to route SIP requests, gateways consequently\
    \ reveal\n   (through this translation process) the minimum possible amount of\n\
    \   information.\n   There are some concerns, however, that arise from the other\
    \ direction\n   of mapping, the mapping of SIP headers to QSIG information elements,\n\
    \   which are enumerated in the following paragraphs.\n"
- title: 11.2.  Calls from QSIG to Invalid or Restricted Numbers
  contents:
  - "11.2.  Calls from QSIG to Invalid or Restricted Numbers\n   When end users dial\
    \ numbers in a PISN, their selections populate the\n   Called party number information\
    \ element in the QSIG SETUP message.\n   Similarly, the SIP URI or tel URL and\
    \ its optional parameters in the\n   Request-URI of a SIP INVITE request, which\
    \ can be created directly by\n   end users of a SIP device, map to that information\
    \ element at a\n   gateway.  However, in a PISN, policy can prevent the user from\n\
    \   dialing certain (invalid or restricted) numbers.  Thus, gateway\n   implementers\
    \ may wish to provide a means for gateway administrators\n   to apply policies\
    \ restricting the use of certain SIP URIs or tel\n   URLs, or SIP URI or tel URL\
    \ parameters, when authorizing a call from\n   SIP to QSIG.\n"
- title: 11.3.  Abuse of SIP Response Code
  contents:
  - "11.3.  Abuse of SIP Response Code\n   Some additional risks may result from the\
    \ mapping of SIP response\n   codes to QSIG cause values.  SIP user agents could\
    \ conceivably\n   respond to an INVITE request from a gateway with any arbitrary\
    \ SIP\n   response code, and thus they can dictate (within the boundaries of\n\
    \   the mappings supported by the gateway) the Q.850 cause code that will\n  \
    \ be sent by the gateway in the resulting QSIG call clearing message.\n   Generally\
    \ speaking, the manner in which a call is rejected is\n   unlikely to provide\
    \ any avenue for fraud or denial of service (e.g.,\n   by signalling that a call\
    \ should not be billed, or that the network\n   should take critical resources\
    \ off-line).  However, gateway\n   implementers may wish to make provision for\
    \ gateway administrators to\n   modify the response code to cause value mappings\
    \ to avoid any\n   undesirable network-specific behaviour resulting from the mappings\n\
    \   recommended in Section 8.4.4.\n"
- title: 11.4.  Use of the To Header URI
  contents:
  - "11.4.  Use of the To Header URI\n   This specification requires the gateway to\
    \ map the Request-URI rather\n   than the To header in a SIP INVITE request to\
    \ the Called party number\n   information element in a QSIG SETUP message.  Although\
    \ a SIP UA is\n   expected to put the same URI in the To header and in the Request-URI,\n\
    \   this is not policed by other SIP entities.  Therefore, a To header\n   URI\
    \ that differs from the Request-URI received at the gateway cannot\n   be used\
    \ as a reliable indication that the call has been re-targeted\n   in the SIP network\
    \ or as a reliable indication of the original\n   target. Gateway implementers\
    \ making use of the To header for mapping\n   to QSIG elements (e.g., as part\
    \ of QSIG call diversion signalling)\n   may wish to make provision for disabling\
    \ this mapping when deployed\n   in situations where the reliability of the QSIG\
    \ elements concerned is\n   important.\n"
- title: 11.5.  Use of the From Header URI
  contents:
  - "11.5.  Use of the From Header URI\n   The arbitrary population of the From header\
    \ of requests by SIP user\n   agents has some well-understood security implications\
    \ for devices\n   that rely on the From header as an accurate representation of\
    \ the\n   identity of the originator.  Any gateway that intends to use an\n  \
    \ unsigned or unverified From header to populate the Calling party\n   number\
    \ information element of a QSIG SETUP message should\n   authenticate the originator\
    \ of the request and make sure that it is\n   authorized to assert that calling\
    \ number (or make use of some more\n   secure method to ascertain the identity\
    \ of the caller).  Note that\n   gateways, like all other SIP user agents, MUST\
    \ support Digest\n   authentication as described in [10].  Similar considerations\
    \ apply to\n   the use of the SIP P-Asserted-Identity header for mapping to the\
    \ QSIG\n   Calling party number or Connected number information element, i.e.,\n\
    \   the source of this information should be authenticated.  Use of a\n   signed\
    \ message/sipfrag body to derive a QSIG Calling party number or\n   Connected\
    \ number information element is another secure alternative.\n"
- title: 11.6.  Abuse of Early Media
  contents:
  - "11.6.  Abuse of Early Media\n   There is another class of potential risk that\
    \ is related to the cut-\n   through of the backwards media path before the call\
    \ is answered.\n   Several practices described in this document involve the connection\n\
    \   of media streams to user information channels on inter-PINX links and\n  \
    \ the sending of progress description number 1 or 8 in a backward QSIG\n   message.\
    \  This can result in media being cut through end-to-end, and\n   it is possible\
    \ for the called user agent then to play arbitrary audio\n   to the caller for\
    \ an indefinite period of time before transmitting a\n   final response (in the\
    \ form of a 2xx or higher response code) to an\n   INVITE request.  This is useful\
    \ since it also permits network\n   entities (particularly legacy networks that\
    \ are incapable of\n   transmitting Q.850 cause values) to play tones and announcements\
    \ to\n   indicate call failure or call progress, without triggering charging\n\
    \   by transmitting a 2xx response.  Also, early cut-through can help\n   prevent\
    \ clipping of the initial media when the call is answered.\n   There are conceivable\
    \ respects in which this capability could be used\n   fraudulently by the called\
    \ user agent for transmitting arbitrary\n   information without answering the\
    \ call or before answering the call.\n   However, in corporate networks, charging\
    \ is often not an issue, and\n   for calls arriving at a corporate network from\
    \ a carrier network, the\n   carrier network normally takes steps to prevent fraud.\n\
    \   The usefulness of this capability appears to outweigh any risks\n   involved,\
    \ which may in practice be no greater than in existing\n   PISN/ISDN environments.\
    \  However, gateway implementers may wish to\n   make provision for gateway administrators\
    \ to turn off cut-through or\n   minimise its impact (e.g., by imposing a time\
    \ limit) when deployed in\n   situations where problems can arise.\n"
- title: 11.7.  Protection from Denial-of-Service Attacks
  contents:
  - "11.7.  Protection from Denial-of-Service Attacks\n   Unlike a traditional PISN\
    \ phone, a SIP user agent can launch multiple\n   simultaneous requests in order\
    \ to reach a particular resource.  It\n   would be trivial for a SIP user agent\
    \ to launch 100 SIP INVITE\n   requests at a 100 port gateway, thereby tying up\
    \ all of its ports.  A\n   malicious user could choose to launch requests to telephone\
    \ numbers\n   that are known never to answer, or, where overlap signalling is\
    \ used,\n   to incomplete addresses.  This could saturate resources at the\n \
    \  gateway indefinitely, potentially without incurring any charges.\n   Gateway\
    \ implementers may therefore wish to provide means of\n   restricting according\
    \ to policy the number of simultaneous requests\n   originating from the same\
    \ authenticated source, or similar mechanisms\n   to address this possible denial-of-service\
    \ attack.\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   This document is a product of the authors' activities\
    \ in Ecma\n   (www.ecma-international.org) on interoperability of QSIG with IP\n\
    \   networks.  An earlier version is published as Standard ECMA-339.\n   Ecma\
    \ has made this work available to the IETF as the basis for\n   publishing an\
    \ RFC.\n   The authors wish to acknowledge the assistance of Francois Audet,\n\
    \   Adam Roach, Jean-Francois Rey, Thomas Stach, and members of Ecma\n   TC32-TG17\
    \ in preparing and commenting on this document.\n"
- title: 13.  Normative References
  contents:
  - "13.  Normative References\n   [1]  International Standard ISO/IEC 11571 \"Private\
    \ Integrated\n        Services Networks (PISN) - Addressing\" (also published\
    \ by Ecma\n        as Standard ECMA-155).\n   [2]  International Standard ISO/IEC\
    \ 11572 \"Private Integrated\n        Services Network - Circuit-mode Bearer Services\
    \ - Inter-Exchange\n        Signalling Procedures and Protocol\" (also published\
    \ by Ecma as\n        Standard ECMA-143).\n   [3]  International Standard ISO/IEC\
    \ 11582 \"Private Integrated\n        Services Network - Generic Functional Protocol\
    \ for the Support\n        of Supplementary Services - Inter-Exchange Signalling\
    \ Procedures\n        and Protocol\" (also published by Ecma as Standard ECMA-165).\n\
    \   [4]  Bradner, S., \"Key words for use in RFCs to Indicate Requirement\n  \
    \      Levels\", BCP 14, RFC 2119, March 1997.\n   [5]  Postel, J., \"Transmission\
    \ Control Protocol\", STD 7, RFC 793,\n        September 1981.\n   [6]  Postel,\
    \ J., \"User Datagram Protocol\", STD 6, RFC 768, August\n        1980.\n   [7]\
    \  Dierks, T. and C. Allen, \"The TLS Protocol Version 1.0\", RFC\n        2246,\
    \ January 1999.\n   [8]  Handley, M. and V. Jacobson, \"SDP: Session Description\n\
    \        Protocol\", RFC 2327, April 1998.\n   [9]  Stewart, R., Xie, Q., Morneault,\
    \ K., Sharp, C., Schwarzbauer,\n        H., Taylor, T., Rytina, I., Kalla, M.,\
    \ Zhang, L., and V. Paxson,\n        \"Stream Control Transmission Protocol\"\
    , RFC 2960, October 2000.\n   [10] Rosenberg, J., Schulzrinne, H., Camarillo,\
    \ G., Johnston, A.,\n        Peterson, J., Sparks, R., Handley, M., and E. Schooler,\
    \ \"SIP:\n        Session Initiation Protocol\", RFC 3261, June 2002.\n   [11]\
    \ Rosenberg, J. and H. Schulzrinne, \"Reliability of Provisional\n        Responses\
    \ in Session Initiation Protocol (SIP)\", RFC 3262, June\n        2002.\n   [12]\
    \ Rosenberg, J. and H. Schulzrinne, \"An Offer/Answer Model with\n        Session\
    \ Description Protocol (SDP)\", RFC 3264, June 2002.\n   [13] Peterson, J., \"\
    A Privacy Mechanism for the Session Initiation\n        Protocol (SIP)\", RFC\
    \ 3323, November 2002.\n   [14] Jennings, C., Peterson, J., and M. Watson, \"\
    Private Extensions\n        to the Session Initiation Protocol (SIP) for Asserted\
    \ Identity\n        within Trusted Networks\", RFC 3325, November 2002.\n   [15]\
    \ Postel, J., \"Internet Protocol\", STD 5, RFC 791, September 1981.\n   [16]\
    \ Deering, S. and R. Hinden, \"Internet Protocol, Version 6 (IPv6)\n        Specification\"\
    , RFC 2460, December 1998.\n   [17] ITU-T Recommendation E.164, \"The International\
    \ Public\n        Telecommunication Numbering Plan\", (1997-05).\n   [18] Camarillo,\
    \ G., Roach, A., Peterson, J., and L. Ong, \"Mapping of\n        Integrated Services\
    \ Digital Network (ISDN) User Part (ISUP)\n        Overlap Signalling to the Session\
    \ Initiation Protocol (SIP)\",\n        RFC 3578, August 2003.\n   [19] Rosenberg,\
    \ J., \"The Session Initiation Protocol (SIP) UPDATE\n        Method\", RFC 3311,\
    \ October 2002.\n   [20] Sparks, R., \"Internet Media Type message/sipfrag\",\
    \ RFC 3420,\n        November 2002.\n"
- title: Appendix A.  Example Message Sequences
  contents:
  - 'Appendix A.  Example Message Sequences

    '
- title: A.1.  Introduction
  contents:
  - "A.1.  Introduction\n   This appendix shows some typical message sequences that\
    \ can occur for\n   an interworking between QSIG and SIP.  It is informative.\n\
    \   NOTE: For all message sequence diagrams, there is no message mapping\n   between\
    \ QSIG and SIP unless explicitly indicated by dotted lines.\n   Also, if there\
    \ are no dotted lines connecting two messages, this\n   means that these are independent\
    \ of each other in terms of the time\n   when they occur.\n   NOTE: Numbers prefixing\
    \ SIP method names and response codes in the\n   diagrams represent sequence numbers.\
    \  Messages bearing the same\n   number will have the same value in the CSeq header.\n\
    \   NOTE: In these examples, SIP provisional responses (other than 100)\n   are\
    \ shown as being sent reliably, using the PRACK method for\n   acknowledgement.\n"
- title: A.2.  Message Sequences for Call Establishment from QSIG to SIP
  contents:
  - "A.2.  Message Sequences for Call Establishment from QSIG to SIP\n   Below are\
    \ typical message sequences for successful call establishment\n   from QSIG to\
    \ SIP\n"
- title: A.2.1.  QSIG to SIP, using en bloc procedures on both QSIG and SIP
  contents:
  - "A.2.1.  QSIG to SIP, using en bloc procedures on both QSIG and SIP\n        \
    \                   +-------------------+\n                           |      \
    \             |\n                           |     GATEWAY       |\n        PISN\
    \               |                   |        IP NETWORK\n        |           \
    \       +-----+------+------+                 |\n        |                   \
    \     |      |                        |\n        |                        |  \
    \    |                        |\n        |   QSIG SETUP           |      |   \
    \     1-INVITE        |\n       1|----------------------->|......|----------------------->|\
    \ 2\n        |                        |      |                        |\n    \
    \    |                        |      |                        |\n        | QSIG\
    \ CALL PROCEEDING   |      |        1-100 TRYING    |\n       3|<-----------------------|\
    \      |<-----------------------+ 4\n        |                        |      |\
    \                        |\n        |                        |      |        \
    \                |\n        |   QSIG ALERTING        |      |        1-180 RINGING\
    \   |\n       8|<-----------------------|......|<-----------------------+ 5\n\
    \        |                        |      |                        |\n        |\
    \                        |      |        2-PRACK         |\n        |        \
    \                |      |----------------------->| 6\n        |              \
    \          |      |        2-200 OK        |\n        |                      \
    \  |      |<-----------------------+ 7\n        |                        |   \
    \   |                        |\n        |   QSIG CONNECT         |      |    \
    \    1-200 OK        |\n      11|<-----------------------|......|<-----------------------+\
    \ 9\n        |                        |      |                        |\n    \
    \    |   QSIG CONNECT ACK     |      |        1-ACK           |\n      12|----------------------->|\
    \      |----------------------->| 10\n        |                        |     \
    \ |                        |\n        |<======================>|      |<======================>|\n\
    \        |        AUDIO           |      |         AUDIO          |\n   Figure\
    \ 3: Typical message sequence for successful call establishment\n   from QSIG\
    \ to SIP, using en bloc procedures on both QSIG and SIP\n   1  The PISN sends\
    \ a QSIG SETUP message to the gateway to begin a\n      session with a SIP UA.\n\
    \   2  On receipt of the QSIG SETUP message, the gateway generates a SIP\n   \
    \   INVITE request and sends it to an appropriate SIP entity in the IP\n     \
    \ network based on the called number.\n   3  The gateway sends a QSIG CALL PROCEEDING\
    \ message to the PISN; no\n      more QSIG INFORMATION messages will be accepted.\n\
    \   4  The IP network sends a SIP 100 (Trying) response to the gateway.\n   5\
    \  The IP network sends a SIP 180 (Ringing) response.\n   6  The gateway may send\
    \ back a SIP PRACK request to the IP network\n      based on the inclusion of\
    \ a Require header or a Supported header\n      with option tag 100rel in the\
    \ initial SIP INVITE request.\n   7  The IP network sends a SIP 200 (OK) response\
    \ to the gateway to\n      acknowledge the SIP PRACK request\n   8  The gateway\
    \ maps this SIP 180 (Ringing) response to a QSIG\n      ALERTING message and sends\
    \ it to the PISN.\n   9  The IP network sends a SIP 200 (OK) response when the\
    \ call is\n      answered.\n   10 The gateway sends a SIP ACK request to acknowledge\
    \ the SIP 200\n      (OK) response.\n   11 The gateway maps this SIP 200 (OK)\
    \ response to a QSIG CONNECT\n      message and sends it to the PISN.\n   12 The\
    \ PISN sends a QSIG CONNECT ACKNOWLEDGE message in response to\n      the QSIG\
    \ CONNECT message.\n"
- title: A.2.2.  QSIG to SIP, using overlap receiving on QSIG and en bloc sending
  contents:
  - "A.2.2.  QSIG to SIP, using overlap receiving on QSIG and en bloc sending\n  \
    \      on SIP\n                        +------------------------+\n     PISN \
    \              |         GATEWAY        |      IP NETWORK\n                  \
    \      |                        |\n     |  QSIG SETUP      +--------+-------+-------+\
    \                |\n    1|-------------------------->|       |               \
    \         |\n     |                           |       |                      \
    \  |\n     |  QSIG SETUP ACK           |       |                        |\n  \
    \  2|<--------------------------|       |                        |\n     |   \
    \                        |       |                        |\n     | QSIG INFORMATION\
    \          |       |                        |\n    3|-------------------------->|\
    \       |                        |\n     |                           |       |\
    \                        |\n     | QSIG INFORMATION          |       |  1-INVITE\
    \              |\n   3a|-------------------------->|.......|----------------------->|4\n\
    \     | QSIG CALL PROCEEDING      |       |  1-100 TRYING          |\n    5|<--------------------------|\
    \       |<-----------------------|6\n     |                           |      \
    \ |                        |\n     | QSIG ALERTING             |       |  1-180\
    \ RINGING         |\n   10|<--------------------------|.......|<-----------------------|7\n\
    \     |                           |       |  2-PRACK               |\n     | \
    \                          |       |----------------------->|8\n     |       \
    \                    |       |  2-200 OK              |\n     |              \
    \             |       |<-----------------------|9\n     | QSIG CONNECT       \
    \       |       |  1-200 OK              |\n   13|<--------------------------|.......|<-----------------------|11\n\
    \     |                           |       |                        |\n     | QSIG\
    \ CONNECT ACK          |       |  1-ACK                 |\n   14|-------------------------->|\
    \       |----------------------->|12\n     |          AUDIO            |     \
    \  |           AUDIO        |\n     |<=========================>|       |<======================>|\n\
    \   Figure 4: Typical message sequence for successful call establishment\n   from\
    \ QSIG to SIP, using overlap receiving on QSIG and en bloc sending\n   on SIP\n\
    \   1  The PISN sends a QSIG SETUP message to the gateway to begin a\n      session\
    \ with a SIP UA.  The QSIG SETUP message does not contain a\n      Sending Complete\
    \ information element.\n   2  The gateway sends a QSIG SETUP ACKNOWLEDGE message\
    \ to the PISN.\n      More digits are expected.\n   3  More digits are sent from\
    \ the PISN within a QSIG INFORMATION\n      message.\n   3a More digits are sent\
    \ from the PISN within a QSIG INFORMATION\n      message.  The QSIG INFORMATION\
    \ message contains a Sending Complete\n      information element.\n   4  The Gateway\
    \ generates a SIP INVITE request and sends it to an\n      appropriate SIP entity\
    \ in the IP network, based on the called\n      number.\n   5  The gateway sends\
    \ a QSIG CALL PROCEEDING message to the PISN; no\n      more QSIG INFORMATION\
    \ messages will be accepted.\n   6  The IP network sends a SIP 100 (Trying) response\
    \ to the gateway.\n   7  The IP network sends a SIP 180 (Ringing) response.\n\
    \   8  The gateway may send back a SIP PRACK request to the IP network\n     \
    \ based on the inclusion of a Require header or a Supported header\n      with\
    \ option tag 100rel in the initial SIP INVITE request.\n   9  The IP network sends\
    \ a SIP 200 (OK) response to the gateway to\n      acknowledge the SIP PRACK request.\n\
    \   10 The gateway maps this SIP 180 (Ringing) response to a QSIG\n      ALERTING\
    \ message and sends it to the PINX.\n   11 The IP network sends a SIP 200 (OK)\
    \ response when the call is\n      answered.\n   12 The gateway sends an SIP ACK\
    \ request to acknowledge the SIP 200\n      (OK) response.\n   13 The gateway\
    \ maps this SIP 200 (OK) response to a QSIG CONNECT\n      message and sends it\
    \ to the PINX.\n   14 The PISN sends a QSIG CONNECT ACKNOWLEDGE message in response\
    \ to\n      the QSIG CONNECT message.\n"
- title: A.2.3.  QSIG to SIP, using overlap procedures on both QSIG and SIP
  contents:
  - "A.2.3.  QSIG to SIP, using overlap procedures on both QSIG and SIP\n        \
    \                +----------------------+\n     PISN               |        GATEWAY\
    \       |         IP NETWORK\n                        |                      |\n\
    \     |  QSIG SETUP      +-------+-------+------+                  |\n   1 |------------------------->|\
    \       |                         |\n     |                          |       |\
    \                         |\n     |  QSIG SETUP ACK          |       |       \
    \                  |\n   2 |<-------------------------|       |              \
    \           |\n     |                          |       |                     \
    \    |\n     | QSIG INFORMATION         |       |                         |\n\
    \   3 |------------------------->|       |                         |\n     | QSIG\
    \ INFORMATION         |       | 1-INVITE                |\n   3 |------------------------->|.......|------------------------>|4\n\
    \     |                          |       | 1-484                   |\n     | \
    \                         |       |<------------------------|5\n     |       \
    \                   |       | 1-ACK                   |\n     |              \
    \            |       |------------------------>|6\n     | QSIG INFORMATION   \
    \      |       | 2-INVITE                |\n   7 |------------------------->|.......|------------------------>|4\n\
    \     |                          |       | 2-484                   |\n     | \
    \                         |       |<------------------------|5\n     |       \
    \                   |       | 2-ACK                   |\n     |              \
    \            |       |------------------------>|6\n     |                    \
    \      |       |                         |\n     | QSIG INFORMATION         |\
    \       |                         |\n     | Sending Complete IE      |       |\
    \ 3-INVITE                |\n   8 |------------------------->|.......|------------------------>|10\n\
    \     | QSIG CALL PROCEEDING     |       | 3-100 TRYING            |\n   9 |<-------------------------|\
    \       |<------------------------|11\n     |                          |     \
    \  |                         |\n     | QSIG ALERTING            |       | 3-180\
    \ RINGING           |\n   15|<-------------------------|.......|<------------------------|12\n\
    \     |                          |       | 4-PRACK                 |\n     | \
    \                         |       |------------------------>|13\n     |      \
    \                    |       | 4-200 OK                |\n     |             \
    \             |       |<------------------------|14\n     | QSIG CONNECT     \
    \        |       | 3-200 OK                |\n   18|<-------------------------|.......|<------------------------|16\n\
    \     |                          |       |                         |\n     | QSIG\
    \ CONNECT ACK         |       | 3-ACK                   |\n   19|------------------------->|\
    \       |------------------------>|17\n     |         AUDIO            |     \
    \  |         AUDIO           |\n     |<========================>|       |<=======================>|\n\
    \     |                          |       |                         |\n   Figure\
    \ 5: Typical message sequence for successful call establishment\n   from QSIG\
    \ to SIP, using overlap procedures on both QSIG and SIP\n   1  The PISN sends\
    \ a QSIG SETUP message to the gateway to begin a\n      session with a SIP UA.\
    \  The QSIG SETUP message does not contain a\n      Sending complete information\
    \ element.\n   2  The gateway sends a QSIG SETUP ACKNOWLEDGE message to the PISN.\n\
    \      More digits are expected.\n   3  More digits are sent from the PISN within\
    \ a QSIG INFORMATION\n      message.\n   4  When the gateway receives the minimum\
    \ number of digits required to\n      route the call, it generates a SIP INVITE\
    \ request and sends it to\n      an appropriate SIP entity in the IP network based\
    \ on the called\n      number\n   5  Due to an insufficient number of digits,\
    \ the IP network will\n      return a SIP 484 (Address Incomplete) response.\n\
    \   6  The SIP 484 (Address Incomplete) response is acknowledged.\n   7  More\
    \ digits are received from the PISN in a QSIG INFORMATION\n      message.  A new\
    \ INVITE is sent with the same Call-ID and From\n      values but an updated Request-URI.\n\
    \   8  More digits are received from the PISN in a QSIG INFORMATION\n      message.\
    \  The QSIG INFORMATION message contains a Sending Complete\n      information\
    \ element.\n   9  The gateway sends a QSIG CALL PROCEEDING message to the PISN;\
    \ no\n      more information will be accepted.\n   10 The gateway sends a new\
    \ SIP INVITE request with an updated\n      Request-URI field.\n   11 The IP network\
    \ sends a SIP 100 (Trying) response to the gateway.\n   12 The IP network sends\
    \ a SIP 180 (Ringing) response.\n   13 The gateway may send back a SIP PRACK request\
    \ to the IP network\n      based on the inclusion of a Require header or a Supported\
    \ header\n      with option tag 100rel in the initial SIP INVITE request.\n  \
    \ 14 The IP network sends a SIP 200 (OK) response to the gateway to\n      acknowledge\
    \ the SIP PRACK request.\n   15 The gateway maps this SIP 180 (Ringing) response\
    \ to a QSIG\n      ALERTING message and sends it to the PISN.\n   16 The IP network\
    \ sends a SIP 200 (OK) response when the call is\n      answered.\n   17 The gateway\
    \ sends a SIP ACK request to acknowledge the SIP 200\n      (OK) response.\n \
    \  18 The gateway maps this SIP 200 (OK) response to a QSIG CONNECT\n      message.\n\
    \   19 The PISN sends a QSIG CONNECT ACKNOWLEDGE message in response to\n    \
    \  the QSIG CONNECT message.\n"
- title: A.3.  Message sequences for call establishment from SIP to QSIG
  contents:
  - "A.3.  Message sequences for call establishment from SIP to QSIG\n   Below are\
    \ typical message sequences for successful call establishment\n   from SIP to\
    \ QSIG\n"
- title: A.3.1.  SIP to QSIG, using en bloc procedures
  contents:
  - "A.3.1.  SIP to QSIG, using en bloc procedures\n                        +----------------------+\n\
    \     IP NETWORK         |        GATEWAY       |              PISN\n        \
    \                |                      |\n     |                  +-------+-------+------+\
    \                  |\n     |                          |       |              \
    \           |\n     |                          |       |                     \
    \    |\n     |     1-INVITE             |       | QSIG SETUP              |\n\
    \   1 |------------------------->|.......|------------------------>|3\n     |\
    \     1-100 TRYING         |       | QSIG CALL PROCEEDING    |\n   2 |<-------------------------|\
    \       |<------------------------|4\n     |     1-180 RINGING        |      \
    \ | QSIG ALERTING           |\n   6 |<-------------------------|.......|<------------------------|5\n\
    \     |                          |       |                         |\n     | \
    \                         |       |                         |\n     |     2-PRACK\
    \              |       |                         |\n   7 |------------------------->|\
    \       |                         |\n     |     2-200 OK             |       |\
    \                         |\n   8 |<-------------------------|       |       \
    \                  |\n     |     1-200 OK             |       | QSIG CONNECT \
    \           |\n   11|<-------------------------|.......|<------------------------|9\n\
    \     |                          |       |                         |\n     | \
    \    1-ACK                |       | QSIG CONNECT ACK        |\n   12|------------------------->|\
    \       |------------------------>|10\n     |         AUDIO            |     \
    \  |         AUDIO           |\n     |<========================>|       |<=======================>|\n\
    \     |                          |       |                         |\n   Figure\
    \ 6: Typical message sequence for successful call establishment\n   from SIP to\
    \ QSIG, using en bloc procedures\n   1  The IP network sends a SIP INVITE request\
    \ to the gateway.\n   2  The gateway sends a SIP 100 (Trying) response to the\
    \ IP network.\n   3  On receipt of the SIP INVITE request, the gateway sends a\
    \ QSIG\n      SETUP message.\n   4  The PISN sends a QSIG CALL PROCEEDING message\
    \ to the gateway.\n   5  A QSIG ALERTING message is returned to indicate that\
    \ the end user\n      in the PISN is being alerted.\n   6  The gateway maps the\
    \ QSIG ALERTING message to a SIP 180 (Ringing)\n      response.\n   7  The IP\
    \ network can send back a SIP PRACK request to the IP network\n      based on\
    \ the inclusion of a Require header or a Supported header\n      with option tag\
    \ 100rel in the initial SIP INVITE request.\n   8  The gateway sends a SIP 200\
    \ (OK) response to acknowledge the SIP\n      PRACK request.\n   9  The PISN sends\
    \ a QSIG CONNECT message to the gateway when the call\n      is answered.\n  \
    \ 10 The gateway sends a QSIG CONNECT ACKNOWLEDGE message to\n      acknowledge\
    \ the QSIG CONNECT message.\n   11 The QSIG CONNECT message is mapped to a SIP\
    \ 200 (OK) response.\n   12 The IP network, upon receiving a SIP INVITE final\
    \ response (200),\n      will send a SIP ACK request to acknowledge receipt.\n"
- title: A.3.2.  SIP to QSIG, using overlap receiving on SIP and en bloc sending
  contents:
  - "A.3.2.  SIP to QSIG, using overlap receiving on SIP and en bloc sending\n   \
    \     on QSIG\n                        +----------------------+\n     IP NETWORK\
    \         |        GATEWAY       |               PISN\n                      \
    \  |                      |\n     | 1-INVITE         +-------+-------+------+\
    \                  |\n   1 |------------------------->|       |              \
    \           |\n     |     1-484                |       |                     \
    \    |\n   2 |<-------------------------|       |                         |\n\
    \     |     1-ACK                |       |                         |\n   3 |------------------------->|\
    \       |                         |\n     |     2-INVITE             |       |\
    \                         |\n   1 |------------------------->|       |       \
    \                  |\n     |     2-484                |       |              \
    \           |\n   2 |<-------------------------|       |                     \
    \    |\n     |     2- ACK               |       |                         |\n\
    \   3 |------------------------->|       |                         |\n     | \
    \    3-INVITE             |       | QSIG SETUP              |\n   4 |------------------------->|.......|------------------------>|6\n\
    \     |     3-100 TRYING         |       | QSIG CALL PROCEEDING    |\n   5 |<-------------------------|\
    \       |<------------------------|7\n     |     3-180 RINGING        |      \
    \ | QSIG ALERTING           |\n   9 |<-------------------------|.......|<------------------------|8\n\
    \     |                          |       |                         |\n     | \
    \                         |       |                         |\n     |     4-PRACK\
    \              |       |                         |\n   10|------------------------->|\
    \       |                         |\n     |     4-200 OK             |       |\
    \                         |\n   11|<-------------------------|       |       \
    \                  |\n     |     3-200 OK             |       | QSIG CONNECT \
    \           |\n   14|<-------------------------|.......|<------------------------|12\n\
    \     |                          |       |                         |\n     | \
    \    3-ACK                |       | QSIG CONNECT ACK        |\n   15|------------------------->|\
    \       |------------------------>|13\n     |         AUDIO            |     \
    \  |         AUDIO           |\n     |<========================>|       |<=======================>|\n\
    \     |                          |       |                         |\n   Figure\
    \ 7: Typical message sequence for successful call establishment\n   from SIP to\
    \ QSIG, using overlap receiving on SIP and en bloc sending\n   on QSIG\n   1 \
    \ The IP network sends a SIP INVITE request to the gateway.\n   2  Due to an insufficient\
    \ number of digits, the gateway returns a SIP\n      484 (Address Incomplete)\
    \ response.\n   3  The IP network acknowledges the SIP 484 (Address Incomplete)\n\
    \      response.\n   4  The IP network sends a new SIP INVITE request with the\
    \ same Call-\n      ID and updated Request-URI.\n   5  The gateway now has all\
    \ the digits required to route the call to\n      the PISN.  The gateway sends\
    \ back a SIP 100 (Trying) response.\n   6  The gateway sends a QSIG SETUP message.\n\
    \   7  The PISN sends a QSIG CALL PROCEEDING message to the gateway.\n   8  A\
    \ QSIG ALERTING message is returned to indicate that the end user\n      in the\
    \ PISN is being alerted.\n   9  The gateway maps the QSIG ALERTING message to\
    \ a SIP 180 (Ringing)\n      response.\n   10 The IP network can send back a SIP\
    \ PRACK request to the IP network\n      based on the inclusion of a Require header\
    \ or a Supported header\n      with option tag 100rel in the initial SIP INVITE\
    \ request.\n   11 The gateway sends a SIP 200 (OK) response to acknowledge the\
    \ SIP\n      PRACK request.\n   12 The PISN sends a QSIG CONNECT message to the\
    \ gateway when the call\n      is answered.\n   13 The gateway sends a QSIG CONNECT\
    \ ACKNOWLEDGE message to\n      acknowledge the CONNECT message.\n   14 The QSIG\
    \ CONNECT message is mapped to a SIP 200 (OK) response.\n   15 The IP network,\
    \ upon receiving a SIP INVITE final response (200),\n      will send a SIP ACK\
    \ request to acknowledge receipt.\n"
- title: A.3.3.  SIP to QSIG, using overlap procedures on both SIP and QSIG
  contents:
  - "A.3.3.  SIP to QSIG, using overlap procedures on both SIP and QSIG\n        \
    \                +----------------------+\n     IP NETWORK         |        GATEWAY\
    \       |               PISN\n                        |                      |\n\
    \     | 1-INVITE         +-------+-------+------+                  |\n   1 |------------------------->|\
    \       |                         |\n     |     1-484                |       |\
    \                         |\n   2 |<-------------------------|       |       \
    \                  |\n     |     1-ACK                |       |              \
    \           |\n   3 |------------------------->|       |                     \
    \    |\n     |     2-INVITE             |       | QSIG SETUP              |\n\
    \   4 |------------------------->|.......|------------------------>|6\n     |\
    \     2-100 TRYING         |       | QSIG SETUP ACK          |\n   5 |<-------------------------|\
    \       |<------------------------|7\n     |     3- INVITE            |      \
    \ | QSIG INFORMATION        |\n   8 |------------------------->|.......|------------------------>|10\n\
    \     |     3-100 TRYING         |       |                         |\n   9 |<-------------------------|\
    \       | QSIG CALL PROCEEDING    |\n     |                          |       |<------------------------|11\n\
    \   13|     3-180 RINGING        |       | QSIG ALERTING           |\n     |<-------------------------|.......|<------------------------|12\n\
    \     |     2-484                |       |                         |\n   14|<-------------------------|\
    \       |                         |\n     |     2-ACK                |       |\
    \                         |\n   15|------------------------->|       |       \
    \                  |\n     |     4-PRACK              |       |              \
    \           |\n   16|------------------------->|       |                     \
    \    |\n     |     4-200 OK             |       |                         |\n\
    \   17|<-------------------------|       |                         |\n     | \
    \    3-200 OK             |       | QSIG CONNECT            |\n   20|<-------------------------|.......|<------------------------|18\n\
    \     |                          |       |                         |\n     | \
    \    3-ACK                |       | QSIG CONNECT ACK        |\n   21|------------------------->|\
    \       |------------------------>|19\n     |         AUDIO            |     \
    \  |         AUDIO           |\n     |<========================>|       |<=======================>|\n\
    \     |                          |       |                         |\n   Figure\
    \ 8: Typical message sequence for successful call establishment\n   from SIP to\
    \ QSIG, using overlap procedures on both SIP and QSIG\n   1  The IP network sends\
    \ a SIP INVITE request to the gateway.\n   2  Due to an insufficient number of\
    \ digits, the gateway returns a SIP\n      484 (Address Incomplete) response.\n\
    \   3  The IP network acknowledges the SIP 484 (Address Incomplete)\n      response.\n\
    \   4  The IP network sends a new SIP INVITE request with the same\n      Call-ID\
    \ and updated Request-URI.\n   5  The gateway now has all the digits required\
    \ to route the call to\n      the PISN.  The gateway sends back a SIP 100 (Trying)\
    \ response to\n      the IP network.\n   6  The gateway sends a QSIG SETUP message.\n\
    \   7  The PISN needs more digits to route the call and sends a QSIG\n      SETUP\
    \ ACKNOWLEDGE message to the gateway.\n   8  The IP network sends a new SIP INVITE\
    \ request with the same\n      Call-ID and From values and updated Request-URI.\n\
    \   9  The gateway sends back a SIP 100 (Trying) response to the IP\n      network.\n\
    \   10 The gateway maps the new SIP INVITE request to a QSIG INFORMATION\n   \
    \   message.\n   11 The PISN has all the digits required and sends back a QSIG\
    \ CALL\n      PROCEEDING message to the gateway.\n   12 A QSIG ALERTING message\
    \ is returned to indicate that the end user\n      in the PISN is being alerted.\n\
    \   13 The gateway maps the QSIG ALERTING message to a SIP 180 (Ringing)\n   \
    \   response.\n   14 The gateway sends a SIP 484 (Address Incomplete) response\
    \ for the\n      previous SIP INVITE request.\n   15 The IP network acknowledges\
    \ the SIP 484 (Address Incomplete)\n      response.\n   16 The IP network can\
    \ send back a SIP PRACK request to the IP network\n      based on the inclusion\
    \ of a Require header or a Supported header\n      with option tag 100rel in the\
    \ initial SIP INVITE request.\n   17 The gateway sends a SIP 200 (OK) response\
    \ to acknowledge the SIP\n      PRACK request.\n   18 The PISN sends a QSIG CONNECT\
    \ message to the gateway when the call\n      is answered.\n   19 The gateway\
    \ sends a QSIG CONNECT ACKNOWLEDGE message to\n      acknowledge the QSIG CONNECT\
    \ message.\n   20 The QSIG CONNECT message is mapped to a SIP 200 (OK) response.\n\
    \   21 The IP network, upon receiving a SIP INVITE final response (200),\n   \
    \   will send a SIP ACK request to acknowledge receipt.\n"
- title: A.4.  Message Sequence for Call Clearing from QSIG to SIP
  contents:
  - "A.4.  Message Sequence for Call Clearing from QSIG to SIP\n   Below are typical\
    \ message sequences for Call Clearing from QSIG to\n   SIP\n"
- title: A.4.1.  QSIG to SIP, subsequent to call establishment
  contents:
  - "A.4.1.  QSIG to SIP, subsequent to call establishment\n                     \
    \    +-------------------+\n                         |                   |\n \
    \                        |     GATEWAY       |\n     PISN                |   \
    \                |         IP NETWORK\n      |                  +-----+------+------+\
    \                 |\n      |                        |      |                 \
    \       |\n      |                        |      |                        |\n\
    \      |     QSIG DISCONNECT    |      |   2- BYE               |\n     1|----------------------->|......|----------------------->|4\n\
    \      |     QSIG RELEASE       |      |        2-200 OK        |\n     2|<-----------------------|\
    \      |<-----------------------|5\n      |     QSIG RELEASE COMP  |      |  \
    \                      |\n     3|----------------------->|      |            \
    \            |\n      |                        |      |                      \
    \  |\n      |                        |      |                        |\n     \
    \ |                        |      |                        |\n   Figure 9: Typical\
    \ message sequence for call clearing from QSIG to\n   SIP, subsequent to call\
    \ establishment\n   1  The PISN sends a QSIG DISCONNECT message to the gateway.\n\
    \   2  The gateway sends back a QSIG RELEASE message to the PISN in\n      response\
    \ to the QSIG DISCONNECT message.\n   3  The PISN sends a QSIG RELEASE COMPLETE\
    \ message in response.  All\n      PISN resources are now released.\n   4  The\
    \ gateway maps the QSIG DISCONNECT message to a SIP BYE request.\n   5  The IP\
    \ network sends back a SIP 200 (OK) response to the SIP BYE\n      request.  All\
    \ IP resources are now released.\n"
- title: A.4.2.  QSIG to SIP, during establishment of a call from SIP to QSIG
  contents:
  - "A.4.2.  QSIG to SIP, during establishment of a call from SIP to QSIG\n      \
    \                        +-------------------+\n                             \
    \ |                   |\n                              |     GATEWAY       |\n\
    \           PISN               |                   |       IP NETWORK\n      \
    \     |                  +-----+------+------+                |\n           |\
    \                        |      |                       |\n           |      \
    \                  |      |                       |\n           |     QSIG DISCONNECT\
    \    |      |   1- 4XX / 6XX        |\n          1|----------------------->|......|---------------------->|4\n\
    \           |     QSIG RELEASE       |      |        1- ACK         |\n      \
    \    2|<-----------------------|      |<----------------------|5\n           |\
    \     QSIG RELEASE COMP  |      |                       |\n          3|----------------------->|\
    \      |                       |\n           |                        |      |\
    \                       |\n           |                        |      |      \
    \                 |\n   Figure 10: Typical message sequence for call clearing\
    \ from QSIG to\n   SIP, during establishment of a call from SIP to QSIG (gateway\
    \ has\n   not sent a final response to the SIP INVITE request)\n   1  The PISN\
    \ sends a QSIG DISCONNECT message to the gateway\n   2  The gateway sends back\
    \ a QSIG RELEASE message to the PISN in\n      response to the QSIG DISCONNECT\
    \ message\n   3  The PISN sends a QSIG RELEASE COMPLETE message in response. \
    \ All\n      PISN resources are now released.\n   4  The gateway maps the QSIG\
    \ DISCONNECT message to a SIP 4xx-6xx\n      response\n   5  The IP network sends\
    \ back a SIP ACK request in response to the SIP\n      4xx-6xx response.  All\
    \ IP resources are now released\n"
- title: A.4.3.  QSIG to SIP, during establishment of a call from QSIG to SIP
  contents:
  - "A.4.3.  QSIG to SIP, during establishment of a call from QSIG to SIP\n      \
    \                       +-------------------+\n                             |\
    \                   |\n                             |     GATEWAY       |\n  \
    \       PISN                |                   |         IP NETWORK\n       \
    \   |                  +-----+------+------+                 |\n          |  \
    \                      |      |                        |\n          |        \
    \                |      |                        |\n          |     QSIG DISCONNECT\
    \    |      |   1- CANCEL            |\n         1|----------------------->|......|----------------------->|4\n\
    \          |     QSIG RELEASE       |      |1-487 Request Terminated|\n      \
    \   2|<-----------------------|      |<-----------------------|5\n          |\
    \     QSIG RELEASE COMP  |      |                        |\n         3|----------------------->|\
    \      |   1- ACK               |\n          |                        |      |----------------------->|6\n\
    \          |                        |      |                        |\n      \
    \    |                        |      |   1- 200 OK            |\n          | \
    \                       |      |<-----------------------|7\n          |      \
    \                  |      |                        |\n   Figure 11: Typical message\
    \ sequence for call clearing from QSIG to\n   SIP, during establishment of a call\
    \ from QSIG to SIP (gateway has\n   received a provisional response to the SIP\
    \ INVITE request but not a\n   final response)\n   1  The PISN sends a QSIG DISCONNECT\
    \ message to the gateway.\n   2  The gateway sends back a QSIG RELEASE message\
    \ to the PISN in\n      response to the QSIG DISCONNECT message.\n   3  The PISN\
    \ sends a QSIG RELEASE COMPLETE message in response.  All\n      PISN resources\
    \ are now released.\n   4  The gateway maps the QSIG DISCONNECT message to a SIP\
    \ CANCEL\n      request (subject to receipt of a provisional response, but not\
    \ of\n      a final response).\n   5  The IP network sends back a SIP 487 (Request\
    \ Terminated) response\n      to the SIP INVITE request.\n   6  The gateway, on\
    \ receiving a SIP final response (487) to the SIP\n      INVITE request, sends\
    \ back a SIP ACK request to acknowledge\n      receipt.\n   7  The IP network\
    \ sends back a SIP 200 (OK) response to the SIP\n      CANCEL request.  All IP\
    \ resources are now released.\n"
- title: A.5.  Message Sequence for Call Clearing from SIP to QSIG
  contents:
  - "A.5.  Message Sequence for Call Clearing from SIP to QSIG\n   Below are typical\
    \ message sequences for Call Clearing from SIP to\n   QSIG\n"
- title: A.5.1.  SIP to QSIG, subsequent to call establishment
  contents:
  - "A.5.1.  SIP to QSIG, subsequent to call establishment\n                     \
    \        +-------------------+\n                             |               \
    \    |\n                             |     GATEWAY       |\n          IP NETWORK\
    \         |                   |              PISN\n          |               \
    \   +-----+------+------+                 |\n          |                     \
    \   |      |                        |\n          |                        |  \
    \    |                        |\n          |   2- BYE               |      | \
    \    QSIG DISCONNECT    |\n         1|----------------------->|......|----------------------->|3\n\
    \          |                        |      |     QSIG RELEASE       |\n      \
    \    |                        |      |<-----------------------|4\n          |\
    \        2-200 OK        |      |     QSIG RELEASE COMP  |\n         2|<-----------------------|\
    \      |----------------------->|5\n          |                        |     \
    \ |                        |\n          |                        |      |    \
    \                    |\n   Figure 12: Typical message sequence for call clearing\
    \ from SIP to\n   QSIG, subsequent to call establishment\n   1  The IP network\
    \ sends a SIP BYE request to the gateway.\n   2  The gateway sends back a SIP\
    \ 200 (OK) response to the SIP BYE\n      request.  All IP resources are now released.\n\
    \   3  The gateway maps the SIP BYE request to a QSIG DISCONNECT message.\n  \
    \ 4  The PISN sends back a QSIG RELEASE message to the gateway in\n      response\
    \ to the QSIG DISCONNECT message.\n   5  The gateway sends a QSIG RELEASE COMPLETE\
    \ message in response.\n      All PISN resources are now released.\n"
- title: A.5.2.  SIP to QSIG, during establishment of a call from QSIG to SIP
  contents:
  - "A.5.2.  SIP to QSIG, during establishment of a call from QSIG to SIP\n      \
    \                       +-------------------+\n                             |\
    \                   |\n                             |     GATEWAY       |\n  \
    \        IP NETWORK         |                   |              PISN\n        \
    \  |                  +-----+------+------+                 |\n          |   \
    \                     |      |                        |\n          |         \
    \               |      |                        |\n          |   1- 4XX / 6XX\
    \         |      |     QSIG DISCONNECT    |\n         1|----------------------->|......|----------------------->|3\n\
    \          |                        |      |     QSIG RELEASE       |\n      \
    \    |                        |      |<-----------------------|4\n          |\
    \        1- ACK          |      |     QSIG RELEASE COMP  |\n         2|<-----------------------|\
    \      |----------------------->|5\n          |                        |     \
    \ |                        |\n          |                        |      |    \
    \                    |\n          |                        |      |          \
    \              |\n   Figure 13: Typical message sequence for call clearing from\
    \ SIP to\n   QSIG, during establishment of a call from QSIG to SIP (gateway has\n\
    \   not previously received a final response to the SIP INVITE request)\n   1\
    \  The IP network sends a SIP 4xx-6xx response to the gateway.\n   2  The gateway\
    \ sends back a SIP ACK request in response to the SIP\n      4xx-6xx response.\
    \  All IP resources are now released.\n   3  The gateway maps the SIP 4xx-6xx\
    \ response to a QSIG DISCONNECT\n      message.\n   4  The PISN sends back a QSIG\
    \ RELEASE message to the gateway in\n      response to the QSIG DISCONNECT message.\n\
    \   5  The gateway sends a QSIG RELEASE COMPLETE message in response.\n      All\
    \ PISN resources are now released.\n"
- title: A.5.3.  SIP to QSIG, during establishment of a call from SIP to QSIG
  contents:
  - "A.5.3.  SIP to QSIG, during establishment of a call from SIP to QSIG\n      \
    \                       +-------------------+\n                             |\
    \                   |\n                             |     GATEWAY       |\n  \
    \       IP NETWORK          |                   |              PISN\n        \
    \  |                  +-----+------+------+                 |\n          |   \
    \                     |      |                        |\n          |         \
    \               |      |                        |\n          |   1- CANCEL   \
    \         |      |     QSIG DISCONNECT    |\n         1|----------------------->|......|----------------------->|4\n\
    \          |                        |      |     QSIG RELEASE       |\n      \
    \    |                        |      |<-----------------------|5\n          |1-487\
    \ Request Terminated|      |     QSIG RELEASE COMP  |\n         2|<-----------------------|\
    \      |----------------------->|6\n          |                        |     \
    \ |                        |\n          |   1- ACK               |      |    \
    \                    |\n         3|----------------------->|      |          \
    \              |\n          |                        |      |                \
    \        |\n          |   1- 200 OK            |      |                      \
    \  |\n         4|<-----------------------|      |                        |\n \
    \  Figure 14: Typical message sequence for call clearing from SIP to\n   QSIG,\
    \ during establishment of a call from SIP to QSIG (gateway has\n   sent a provisional\
    \ response to the SIP INVITE request but not a final\n   response)\n   1  The\
    \ IP network sends a SIP CANCEL request to the gateway.\n   2  The gateway sends\
    \ back a SIP 487 (Request Terminated) response to\n      the SIP INVITE request.\n\
    \   3  The IP network, on receiving a SIP final response (487) to the SIP\n  \
    \    INVITE request, sends back a SIP ACK request to acknowledge\n      receipt.\n\
    \   4  The gateway sends back a SIP 200 (OK) response to the SIP CANCEL\n    \
    \  request.  All IP resources are now released.\n   5  The gateway maps the SIP\
    \ 4xx-6xx response to a QSIG DISCONNECT\n      message.\n   6  The PISN sends\
    \ back a QSIG RELEASE message to the gateway in\n      response to the QSIG DISCONNECT\
    \ message.\n   7  The gateway sends a QSIG RELEASE COMPLETE message in response.\n\
    \      All PISN resources are now released.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   John Elwell\n   Siemens plc\n   Technology Drive\n   Beeston\n\
    \   Nottingham, UK, NG9 1LA\n   EMail: john.elwell@siemens.com\n   Frank Derks\n\
    \   NEC Philips Unified Solutions\n   Anton Philipsweg 1\n   1223 KZ Hilversum\n\
    \   The Netherlands\n   EMail: frank.derks@nec-philips.com\n   Olivier Rousseau\n\
    \   Alcatel Business Systems\n   32,Avenue Kleber\n   92700 Colombes\n   France\n\
    \   EMail: Olivier.Rousseau@alcatel.fr\n   Patrick Mourot\n   Alcatel Business\
    \ Systems\n   1,Rue Dr A.  Schweitzer\n   67400 Illkirch\n   France\n   EMail:\
    \ Patrick.Mourot@alcatel.fr\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
