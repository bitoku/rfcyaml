- title: __initial_text__
  contents:
  - '  Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The IETF Trust (2007).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes Mobile IPv6 operation with the revised IPsec\n\
    \   architecture and IKEv2.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n   2.  Terminology  . . . . . . . . . . . . . . . . . . . .\
    \ . . . . .  3\n   3.  Packet Formats . . . . . . . . . . . . . . . . . . . .\
    \ . . . .  4\n   4.  Requirements . . . . . . . . . . . . . . . . . . . . . .\
    \ . . .  4\n     4.1.  General Requirements . . . . . . . . . . . . . . . . .\
    \ . .  5\n     4.2.  Policy Requirements  . . . . . . . . . . . . . . . . . .\
    \ .  5\n     4.3.  IPsec Protocol Processing Requirements . . . . . . . . . .\
    \  7\n     4.4.  Dynamic Keying Requirements  . . . . . . . . . . . . . . .  9\n\
    \   5.  Selector Granularity Considerations  . . . . . . . . . . . . . 10\n  \
    \ 6.  Manual Configuration . . . . . . . . . . . . . . . . . . . . . 11\n    \
    \ 6.1.  Binding Updates and Acknowledgements . . . . . . . . . . . 12\n     6.2.\
    \  Return Routability Messages  . . . . . . . . . . . . . . . 13\n     6.3.  Mobile\
    \ Prefix Discovery Messages . . . . . . . . . . . . . 14\n     6.4.  Payload Packets\
    \  . . . . . . . . . . . . . . . . . . . . . 14\n   7.  Dynamic Configuration\
    \  . . . . . . . . . . . . . . . . . . . . 15\n     7.1.  Peer Authorization Database\
    \ Entries  . . . . . . . . . . . 15\n     7.2.  Security Policy Database Entries\
    \ . . . . . . . . . . . . . 15\n       7.2.1.  Binding Updates and Acknowledgements\
    \ . . . . . . . . . 16\n       7.2.2.  Return Routability Messages  . . . . .\
    \ . . . . . . . . 17\n       7.2.3.  Mobile Prefix Discovery Messages . . . .\
    \ . . . . . . . 17\n       7.2.4.  Payload Packets  . . . . . . . . . . . . .\
    \ . . . . . . 18\n     7.3.  Security Association Negotiation Using IKEv2 . .\
    \ . . . . . 18\n     7.4.  Movements and Dynamic Keying . . . . . . . . . . .\
    \ . . . . 20\n   8.  The Use of EAP Authentication  . . . . . . . . . . . . .\
    \ . . . 21\n   9.  Dynamic Home Address Configuration . . . . . . . . . . . .\
    \ . . 22\n   10. Security Considerations  . . . . . . . . . . . . . . . . . .\
    \ . 23\n   11. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .\
    \ 24\n   12. References . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n\
    \     12.1. Normative References . . . . . . . . . . . . . . . . . . . 24\n  \
    \   12.2. Informative References . . . . . . . . . . . . . . . . . . 24\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   RFC 3776 describes how IPsec, as described in RFC 2401 [11],\
    \ is used\n   with Mobile IPv6 [2] to protect the signaling messages.  It also\n\
    \   illustrates examples of Security Policy Database and Security\n   Association\
    \ Database entries that can be used to protect Mobile IPv6\n   signaling messages.\n\
    \   The IPsec architecture has been revised in RFC 4301 [5].  Among the\n   many\
    \ changes, the list of selectors has been expanded to include the\n   Mobility\
    \ Header message type.  This has an impact on how security\n   policies and security\
    \ associations are configured for protecting\n   mobility header messages.  It\
    \ becomes easier to differentiate between\n   the various Mobility Header messages\
    \ based on the type value instead\n   of checking if a particular mobility header\
    \ message is being sent on\n   a tunnel interface between the mobile node and\
    \ the home agent, as it\n   was in RFC 3776.  The revised IPsec architecture specification\
    \ also\n   includes ICMP message type and code as selectors.  This makes it\n\
    \   possible to protect Mobile Prefix Discovery messages without applying\n  \
    \ the same security associations to all ICMPv6 messages.\n   This document discusses\
    \ new requirements for the home agent and the\n   mobile node to use the revised\
    \ IPsec architecture and IKEv2.\n   Section 4 lists the requirements.  Sections\
    \ 6 and 7 describe the\n   required Security Policy Database (SPD) and Security\
    \ Association\n   Database (SAD) entries.\n   The Internet Key Exchange (IKE)\
    \ protocol has also been substantially\n   revised and simplified [4].  Section\
    \ 7.3 of this document describes\n   how IKEv2 can be used to set up security\
    \ associations for Mobile\n   IPv6.\n   The use of EAP within IKEv2 is allowed\
    \ to authenticate the mobile\n   node to the home agent.  This is described in\
    \ Section 8.  A method\n   for dynamically configuring a home address from the\
    \ home agent using\n   the Configuration Payload in IKEv2 is described in Section\
    \ 9.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [1].\n"
- title: 3.  Packet Formats
  contents:
  - "3.  Packet Formats\n   The mobile node and the home agent MUST support the packet\
    \ formats as\n   defined in Section 3 of RFC 3776.\n   In case the mobile node\
    \ reverse tunnels all traffic including Mobile\n   IPv6 signaling messages exchanged\
    \ between the mobile node and the\n   home agent, then the Home Address Option\
    \ is not required to be\n   present in the messages sent to the home agent.  The\
    \ packet format\n   for the binding update when sent in the tunnel mode looks\
    \ as follows.\n      IPv6 hdr (source = care-of address,\n                destination\
    \ = home agent)\n      ESP header in tunnel mode\n      IPv6 hdr (source = home\
    \ address,\n                destination = home agent)\n      Mobility Header\n\
    \         Binding Update\n           Alternate Care-of Address option (care-of\
    \ address)\n   The binding acknowledgement sent to the mobile node when it is\
    \ away\n   from the home link looks as follows.\n      IPv6 hdr (source = home\
    \ agent,\n                destination = care-of address)\n      ESP header in\
    \ tunnel mode\n      IPv6 hdr (source = home agent,\n                destination\
    \ = home address)\n      Mobility Header\n         Binding Acknowledgement\n \
    \  The packet formats for tunneled mobile prefix discovery messages are\n   very\
    \ similar to the tunneled Binding Update and Binding\n   Acknowledgment with the\
    \ with the home address as the source address\n   in the inner IP header.\n  \
    \ The support for the above tunneled packet format is optional on the\n   mobile\
    \ node and the home agent.\n"
- title: 4.  Requirements
  contents:
  - "4.  Requirements\n   This section describes mandatory rules and requirements\
    \ for all\n   Mobile IPv6 mobile nodes and home agents so that IPsec, with IKEv2\
    \ as\n   the key management protocol, can be used to protect traffic between\n\
    \   the mobile node and the home agent.  Many of the requirements are\n   repeated\
    \ from RFC 3776 to make this document self-contained and\n   complete.\n"
- title: 4.1.  General Requirements
  contents:
  - "4.1.  General Requirements\n   o  RFC 3775 states that manual configuration of\
    \ IPsec security\n      associations MUST be supported, and automated key management\
    \ MAY\n      be supported.  This document does not make any recommendations\n\
    \      regarding the support of manual IPsec configuration and dynamic\n     \
    \ IPsec configuration.  This document just describes the use of\n      manually\
    \ created IPsec security associations and the use of IKEv2\n      as the automated\
    \ IPsec key management protocol for protecting\n      Mobile IPv6 signaling messages.\n\
    \   o  ESP encapsulation for Binding Updates and Binding Acknowledgements\n  \
    \    MUST be supported and used.\n   o  ESP encapsulation in tunnel mode for the\
    \ Home Test Init (HoTi) and\n      Home Test (HoT) messages tunneled between the\
    \ mobile node and the\n      home agent MUST be supported and SHOULD be used.\n\
    \   o  ESP encapsulation of the ICMPv6 messages related to mobile prefix\n   \
    \   discovery MUST be supported and SHOULD be used.\n   o  ESP encapsulation of\
    \ the payload packets tunneled between the\n      mobile node and the home agent\
    \ MAY be supported and used.\n   o  If multicast group membership control protocols\
    \ or stateful\n      address autoconfiguration protocols are supported, payload\
    \ data\n      protection MUST be supported for those protocols.\n   o  The home\
    \ agent and the mobile node MAY support authentication\n      using EAP in IKEv2\
    \ as described in Section 8.\n   o  The home agent and the mobile node MAY support\
    \ remote\n      configuration of the home address as described in Section 9. \
    \ When\n      the home agent receives a configuration payload with a CFG_REQUEST\n\
    \      for INTERNAL_IP6_ADDRESS, it must reply with a valid home address\n   \
    \   for the mobile node.  The home agent can pick a home address from\n      a\
    \ local database or from a DHCPv6 server on the home link.\n"
- title: 4.2.  Policy Requirements
  contents:
  - "4.2.  Policy Requirements\n   The following requirements are related to the configuration\
    \ of the\n   security policy database on the home agent and the mobile node.\n\
    \   o  RFC 3776 required configuration of the security policies per\n      interface\
    \ in order to be able to differentiate between mobility\n      header messages\
    \ sent to the home agent and those tunneled through\n      the home agent to the\
    \ correspondent node.  Since the Mobility\n      Header message type is a selector,\
    \ it is now easy to differentiate\n      between HoTi and HoT messages from other\
    \ mobility header messages.\n      Therefore per-interface configuration of security\
    \ policies is not\n      required for protecting mobility header messages.  Note\
    \ that\n      without per-interface security policies, payload packet protection\n\
    \      is limited to packets originating/terminating at the home address.\n  \
    \    Traffic using a link local address within the Mobile IP tunnel\n      cannot\
    \ be provided IPsec protection without per-interface security\n      policies.\n\
    \   o  The home agent MUST be able to prevent a mobile node from using\n     \
    \ its security association to send a Binding Update on behalf of\n      another\
    \ mobile node.  With manual IPsec configuration, the home\n      agent MUST be\
    \ able to verify that a security association was\n      created for a particular\
    \ home address.  With dynamic keying, the\n      home agent MUST be able to verify\
    \ that the identity presented in\n      the IKE_AUTH exchange is allowed to create\
    \ security associations\n      for a particular home address.\n   o  The home\
    \ agent uses the Peer Authorization Database (PAD) [5] to\n      store per-mobile\
    \ node state.  More specifically the per-mobile\n      state stores information\
    \ that is used to authenticate the mobile\n      node and the authorization information\
    \ that ties the mobile node's\n      identity to the home address of the mobile\
    \ node.  This will allow\n      the home agent to prevent a mobile node from creating\
    \ IPsec\n      security associations for another mobile node's home address. \
    \ In\n      case of dynamic home address assignment, the home agent creates a\n\
    \      temporary PAD entry linking the authenticated peer identity and\n     \
    \ the newly allocated home address.\n   o  As required in the base specification\
    \ [2], when a packet destined\n      to the receiving node is matched against\
    \ IPsec security policy or\n      selectors of a security association, an address\
    \ appearing in a\n      Home Address destination option is considered as the source\n\
    \      address of the packet.\n      Note that the home address option appears\
    \ before IPsec headers.\n      Section 11.3.2 of the base specification describes\
    \ one possible\n      implementation approach for this: The IPsec policy operations\
    \ can\n      be performed at the time when the packet has not yet been modified\n\
    \      per Mobile IPv6 rules, or has been brought back to its normal form\n  \
    \    after Mobile IPv6 processing.  That is, the processing of the Home\n    \
    \  Address option is seen as a fixed transformation of the packets\n      that\
    \ does not affect IPsec processing.\n   o  Similarly, a home address within a\
    \ Type 2 Routing header destined\n      to the receiving node is considered as\
    \ the destination address of\n      the packet, when a packet is matched against\
    \ IPsec security policy\n      or selectors of a security association.\n     \
    \ Similar implementation considerations apply to the Routing header\n      processing\
    \ as was described above for the Home Address destination\n      option.\n   o\
    \  When the mobile node returns home and de-registers with the Home\n      Agent,\
    \ the tunnel between the home agent and the mobile node's\n      care-of address\
    \ is torn down.  The security policy entries, which\n      were used for protecting\
    \ tunneled traffic between the mobile node\n      and the home agent, SHOULD be\
    \ made inactive (for instance, by\n      removing them and installing them back\
    \ later through an API).  The\n      corresponding security associations could\
    \ be kept as they are or\n      deleted depending on how they were created.  If\
    \ the security\n      associations were created dynamically using IKE, they are\n\
    \      automatically deleted when they expire.  If the security\n      associations\
    \ were created through manual configuration, they MUST\n      be retained and\
    \ used later when the mobile node moves away from\n      home again.  The security\
    \ associations protecting Binding Updates,\n      Binding Acknowledgements and\
    \ Mobile Prefix Discovery messages\n      SHOULD NOT be deleted as they do not\
    \ depend on care-of addresses\n      and can be used again.\n   o  The mobile\
    \ node MUST use the Home Address destination option in\n      Binding Updates\
    \ and Mobile Prefix Solicitations when transport\n      mode IPsec protection\
    \ is used, so that the home address is visible\n      when the IPsec policy checks\
    \ are made.\n   o  The home agent MUST use the Type 2 Routing header in Binding\n\
    \      Acknowledgements and Mobile Prefix Advertisements sent to the\n      mobile\
    \ node when transport mode IPsec protection is used, again\n      due to the need\
    \ to have the home address visible when the policy\n      checks are made.\n"
- title: 4.3.  IPsec Protocol Processing Requirements
  contents:
  - "4.3.  IPsec Protocol Processing Requirements\n   The following lists requirements\
    \ for IPsec processing at the Home\n   Agent and the mobile node.\n   o  The home\
    \ agent and mobile node SHOULD support Mobility Header\n      message type as\
    \ an IPsec selector.\n   o  The home agent and mobile node SHOULD support ICMPv6\
    \ message type\n      as an IPsec selector.\n   o  The home agent MUST be able\
    \ to distinguish between HoTi messages\n      sent to itself (when it is acting\
    \ as a Correspondent Node) and\n      those sent to Correspondent Nodes (when\
    \ it is acting as a home\n      agent) based on the destination address of the\
    \ packet.\n   o  When securing Binding Updates, Binding Acknowledgements, and\n\
    \      Mobile Prefix Discovery messages, both the mobile node and the\n      home\
    \ agent MUST support the use of the Encapsulating Security\n      Payload (ESP)\
    \ [6] header in transport mode and MUST use a non-null\n      payload authentication\
    \ algorithm to provide data origin\n      authentication, connectionless integrity,\
    \ and optional anti-replay\n      protection.  The use of sequence number in the\
    \ ESP header to\n      provide anti-replay protection is optional because the\
    \ sequence\n      numbers in the Binding Updates provide anti-replay protection.\n\
    \      However, the anti-replay protection fails if the home agent loses\n   \
    \   the binding cache state, for example, due to a reboot.  Since the\n      IPsec\
    \ security association state can also be assumed to be lost,\n      ESP cannot\
    \ provide anti-replay protection in this case.  Complete\n      anti-replay protection\
    \ can only be provided by the use of a\n      dynamic keying mechanism, like IKEv2.\n\
    \      Support for protecting these messages using ESP in tunnel mode is\n   \
    \   optional.\n   o  Tunnel mode IPsec ESP MUST be supported and SHOULD be used\
    \ for the\n      protection of packets belonging to the return routability\n \
    \     procedure.  A non-null encryption transform and a non-null\n      authentication\
    \ algorithm MUST be applied.\n   o  When ESP is used to protect Binding Updates,\
    \ there is no\n      protection for the care-of address that appears in the IPv6\
    \ header\n      outside the area protected by ESP.  It is important for the home\n\
    \      agent to verify that the care-of address has not been tampered\n      with.\
    \  As a result, the attacker would have redirected the mobile\n      node's traffic\
    \ to another address.  In order to prevent this,\n      Mobile IPv6 implementations\
    \ MUST use the Alternate Care-of Address\n      mobility option in Binding Updates\
    \ sent by mobile nodes while away\n      from home.  The exception to this is\
    \ when the mobile node returns\n      home and sends a Binding Update to the home\
    \ agent in order to de-\n      register.\n      When IPsec is used to protect\
    \ return routability signaling or\n      payload packets, the mobile node MUST\
    \ set the source address it\n      uses for the outgoing tunnel packets to the\
    \ current primary\n      care-of address.\n   o  When IPsec is used to protect\
    \ return routability signaling or\n      payload packets, IPsec security associations\
    \ are needed to provide\n      this protection.  When the care-of address for\
    \ the mobile node\n      changes as a result of an accepted Binding Update, special\n\
    \      treatment is needed for the next packets sent using these security\n  \
    \    associations.  The home agent MUST set the new care-of address as\n     \
    \ the destination address of these packets, as if the outer header\n      destination\
    \ address in the security association had changed.\n      Similarly, the home\
    \ agent starts to expect the new source address\n      in the tunnel packets received\
    \ from the mobile node.\n      Such address changes can be implemented, for instance,\
    \ through an\n      API from the Mobile IPv6 implementation to the IPsec\n   \
    \   implementation.  One such API is described in [12].  It should be\n      noted\
    \ that the use of such an API and the address changes MUST\n      only be done\
    \ based on the Binding Updates received by the home\n      agent and protected\
    \ by the use of IPsec.  Address modifications\n      based on other sources, such\
    \ as Binding Updates to the\n      correspondent nodes protected by return routability,\
    \ or open\n      access to an API from any application may result in security\n\
    \      vulnerabilities.\n"
- title: 4.4.  Dynamic Keying Requirements
  contents:
  - "4.4.  Dynamic Keying Requirements\n   The following requirements are related\
    \ to the use of a dynamic key\n   management protocol by the mobile node and the\
    \ home agent.\n   Section 7.3 describes the use of IKEv2 as the dynamic key management\n\
    \   protocol.\n   o  The mobile node MUST use its care-of address as source address\
    \ in\n      protocol exchanges, when using dynamic keying.\n   o  The mobile node\
    \ and the home agent MUST create security\n      associations based on the home\
    \ address, so that the security\n      associations survive changes in care-of\
    \ address.  When using IKEv2\n      as the key exchange protocol, the home address\
    \ should be carried\n      as the initiator IP address in the TSi payload during\
    \ the\n      CREATE_CHILD_SA exchange [4].\n   o  If the mobile node has used\
    \ IKEv2 to establish security\n      associations with its home agent, it should\
    \ follow the procedures\n      discussed in Sections 11.7.1 and 11.7.3 of the\
    \ base specification\n      [2] to determine whether the IKE endpoints can be\
    \ moved or if the\n      SAs, including the IKEv2 SA, have to be re-established.\n\
    \   o  If the home agent has used IKEv2 to establish security\n      associations\
    \ with the mobile node, it should follow the procedures\n      discussed in Section\
    \ 10.3.1 and 10.3.2 of the base specification\n      [2] to determine whether\
    \ the IKE endpoints can be moved or if the\n      SAs, including the IKEv2 SA,\
    \ have to be re-established.\n"
- title: 5.  Selector Granularity Considerations
  contents:
  - "5.  Selector Granularity Considerations\n   IPsec implementations are compatible\
    \ with this document even if they\n   do not support fine-grain selectors such\
    \ as the Mobility Header\n   message type and ICMPv6 message type.  Note that\
    \ such IPsec\n   implementations are not compliant with RFC 4301 [5].  For various\n\
    \   reasons, some implementations may choose to support only coarse-grain\n  \
    \ selectors (i.e., addresses and in some cases the protocol field) for\n   forwarded\
    \ traffic.  As finer-grain selectors give better control,\n   i.e., the protection\
    \ is only applied when required, the examples in\n   this document always use\
    \ the finest granularity.\n   The following describes different ways of setting\
    \ up IPsec policies\n   for protecting Mobile IPv6 messages:\n   1.  The IPsec\
    \ implementations on the mobile node and the home agent\n       support fine-grain\
    \ selectors, including the Mobility Header\n       message type.  This is the\
    \ case assumed in the IPsec SPD and SAD\n       examples in this document.\n \
    \  2.  The IPsec implementations only support selectors at a protocol\n      \
    \ level.  Such an IPsec implementation can only identify mobility\n       header\
    \ traffic and cannot identify the individual mobility header\n       messages.\
    \  In this case, the protection of Return Routability\n       Messages uses a\
    \ setup similar to the regular payload packets sent\n       to the correspondent\
    \ node with the protocol selector set to\n       Mobility Header.  All tunneled\
    \ Mobility Header messages will be\n       protected.\n   3.  The third case is\
    \ where the protocol selector is not available in\n       the IPsec implementation.\
    \  In this case, all traffic sent by the\n       mobile node that is reverse tunneled\
    \ through the home agent is\n       protected using ESP in tunnel mode.  This\
    \ case is also applicable\n       when the mobile node, due to privacy considerations,\
    \ tunnels all\n       traffic to the home agent.  This includes Mobile IPv6 signaling\n\
    \       messages exchanged between the mobile node and the home agent and\n  \
    \     all traffic exchanged between the mobile node and the\n       correspondent\
    \ node.  This case uses IPsec tunnel mode SA with the\n       protocol selector\
    \ set to 'any'.\n   The third case where all tunneled traffic is protected introduces\n\
    \   some additional considerations:\n   o  If there is just one IPsec SA providing\
    \ protection for all\n      traffic, then the SA MUST fulfill the requirements\
    \ for protecting\n      the Return Routability messages which require confidentiality\n\
    \      protection.  If the third case is being used for privacy\n      considerations,\
    \ then there can also be separate tunnel mode SPD\n      entries for protecting\
    \ the Return Routability messages with a\n      higher priority in the SPD so\
    \ that the SPD entry with the higher\n      priority gets applied first.\n   o\
    \  The receipt of a Binding Update from the new care-of address\n      updates\
    \ the tunnel endpoint of the IPsec SA as described in\n      Section 4.3.  Since\
    \ the Binding Update that updates the tunnel\n      endpoint is received through\
    \ the same tunnel interface that needs\n      to be updated, special care should\
    \ be taken on the home agent to\n      ensure that the Binding Update is not dropped.\
    \  This can be\n      achieved either by performing the source address check on\
    \ the\n      outer IPv6 header after the binding update is processed or by\n \
    \     having exception handling to check the inner packet for a Binding\n    \
    \  Update when the source address match on the outer source address\n      fails.\
    \  Typical IPsec processing does not check the outer source\n      address when\
    \ the originator of the packet has already been\n      authenticated.\n"
- title: 6.  Manual Configuration
  contents:
  - "6.  Manual Configuration\n   This section describes the SPD and SAD entries that\
    \ can be used to\n   protect Mobile IPv6 signaling messages.  The SPD and SAD\
    \ entries are\n   only example configurations.  A particular mobile node implementation\n\
    \   and a home agent implementation could configure different SPD and SAD\n  \
    \ entries as long as they provide the required security of the Mobile\n   IPv6\
    \ signaling messages.\n   For the examples described in this document, a mobile\
    \ node with home\n   address, \"home_address_1\", primary care-of address,\n \
    \  \"care_of_address_1\", a home agent with address, \"home_agent_1\" and a\n\
    \   user of the mobile node with identity \"user_1\" are assumed.  If the\n  \
    \ home address of the mobile node changes, the SPD and SAD entries need\n   to\
    \ be re-created or updated for the new home address.\n   The Peer Authorization\
    \ Database is not used when manual IPsec\n   configuration is used for setting\
    \ up security associations for\n   protecting Mobile IPv6 signaling messages.\n"
- title: 6.1.  Binding Updates and Acknowledgements
  contents:
  - "6.1.  Binding Updates and Acknowledgements\n   The following are the SPD and\
    \ SAD entries on the mobile node and the\n   home agent to protect Binding Updates\
    \ and Acknowledgements.\n        mobile node SPD-S:\n          - IF local_address\
    \ = home_address_1 &\n               remote_address = home_agent_1 & proto = MH\
    \ &\n               local_mh_type = BU & remote_mh_type = BAck\n            Then\
    \ use SA SA1 (OUT) and SA2 (IN)\n        mobile node SAD:\n          - SA1(OUT,\
    \ spi_a, home_agent_1, ESP, TRANSPORT):\n            local_address = home_address_1\
    \ &\n            remote_address = home_agent_1 &\n            proto = MH & mh_type\
    \ = BU\n          - SA2(IN, spi_b, home_address_1, ESP, TRANSPORT):\n        \
    \    local_address = home_agent_1 &\n            remote_address = home_address_1\
    \ &\n            proto = MH & mh_type = BAck\n        home agent SPD-S:\n    \
    \      - IF local_address = home_agent_1 &\n               remote_address = home_address_1\
    \ & proto = MH &\n               local_mh_type = BAck & remote_mh_type = BU\n\
    \            Then use SA SA2 (OUT) and SA1 (IN)\n        home agent SAD:\n   \
    \       - SA2(OUT, spi_b, home_address_1, ESP, TRANSPORT):\n            local_address\
    \ = home_agent_1 &\n            remote_address = home_address_1 &\n          \
    \  proto = MH & mh_type = BAck\n          - SA1(IN, spi_a, home_agent_1, ESP,\
    \ TRANSPORT):\n            local_address = home_address_1 &\n            remote_address\
    \ = home_agent_1 &\n            proto = MH & mh_type = BU\n"
- title: 6.2.  Return Routability Messages
  contents:
  - "6.2.  Return Routability Messages\n   The following are the SPD and SAD entries\
    \ on the mobile node and the\n   home agent to protect Return Routability messages.\n\
    \        mobile node SPD-S:\n          - IF local_address = home_address_1 & remote_address\
    \ = any &\n            proto = MH & local_mh_type = HoTi & remote_mh_type = HoT\n\
    \            Then use SA SA3 (OUT) and SA4 (IN)\n        mobile node SAD:\n  \
    \        - SA3(OUT, spi_c, home_agent_1, ESP, TUNNEL):\n            local_address\
    \ = home_address_1 & remote_address = any &\n            proto = MH & mh_type\
    \ = HoTi\n          - SA4(IN, spi_d, care_of_address_1, ESP, TUNNEL):\n      \
    \      local_address = any & remote_address = home_address_1 &\n            proto\
    \ = MH & mh_type = HoT\n        home agent SPD-S:\n          - IF remote_address\
    \ = home_address_1 & local_address = any &\n            proto = MH & local_mh_type\
    \ = HoT & remote_mh_type = HoTi\n            Then use SA SA4 (OUT) and SA3 (IN)\n\
    \        home agent SAD:\n          - SA4(OUT, spi_d, care_of_address_1, ESP,\
    \ TUNNEL):\n            local_address = any & remote_address = home_address_1\
    \ &\n            proto = MH & mh_type = HoT\n          - SA3(IN, spi_c, home_agent_1,\
    \ ESP, TUNNEL):\n            local_address = home_address_1 & remote_address =\
    \ any &\n            proto = MH & mh_type = HoTi\n"
- title: 6.3.  Mobile Prefix Discovery Messages
  contents:
  - "6.3.  Mobile Prefix Discovery Messages\n   The following are the SPD and SAD\
    \ entries used to protect Mobile\n   Prefix Discovery messages.\n        mobile\
    \ node SPD-S:\n          - IF local_address = home_address_1 &\n             \
    \  remote_address = home_agent_1 & proto = ICMPv6 &\n               local_icmp6_type\
    \ = MPS & remote_icmp6_type = MPA\n            Then use SA SA5 (OUT) and SA6 (IN)\n\
    \        mobile node SAD:\n          - SA5(OUT, spi_e, home_agent_1, ESP, TRANSPORT):\n\
    \            local_address = home_address_1 &\n            remote_address = home_agent_1\
    \ &\n            proto = ICMPv6 & icmp6_type = MPS\n          - SA6(IN, spi_f,\
    \ home_address_1, ESP, TRANSPORT):\n            local_address = home_agent_1 &\n\
    \            remote_address = home_address_1 &\n            proto = ICMPv6 & icmp6_type\
    \ = MPA\n        home agent SPD-S:\n          - IF local_address = home_agent_1\
    \ &\n               remote_address = home_address_1 & proto = ICMPv6 &\n     \
    \          local_icmp6_type = MPA & remote_icmp6_type = MPS\n            Then\
    \ use SA SA6 (OUT) and SA5 (IN)\n        home agent SAD:\n          - SA6(OUT,\
    \ spi_f, home_address_1, ESP, TRANSPORT):\n            local_address = home_agent_1\
    \ &\n            remote_address = home_address_1 &\n            proto = ICMPv6\
    \ & icmp6_type = MPA\n          - SA5(IN, spi_e, home_agent_1, ESP, TRANSPORT):\n\
    \            local_address = home_address_1 &\n            remote_address = home_agent_1\
    \ &\n            proto = ICMPv6 & icmp6_type = MPS\n"
- title: 6.4.  Payload Packets
  contents:
  - "6.4.  Payload Packets\n   Regular payload traffic between the mobile node and\
    \ the correspondent\n   node tunneled through the home agent can be protected\
    \ by IPsec, if\n   required.  The mobile node and the home agent use ESP in tunnel\
    \ mode\n   to protect the tunneled traffic.  The SPD and SAD entries shown in\n\
    \   Section 5.2.4 of [3] are applicable here.\n"
- title: 7.  Dynamic Configuration
  contents:
  - "7.  Dynamic Configuration\n   This section describes the use of IKEv2 to set\
    \ up the required\n   security associations.\n"
- title: 7.1.  Peer Authorization Database Entries
  contents:
  - "7.1.  Peer Authorization Database Entries\n   The following describes PAD entries\
    \ on the mobile node and the home\n   agent.  The PAD entries are only example\
    \ configurations.  Note that\n   the PAD is a logical concept; a particular mobile\
    \ node and a home\n   agent can implement the PAD in an implementation-specific\
    \ manner.\n   The PAD state may also be distributed across various databases in\
    \ a\n   specific implementation.\n       mobile node PAD:\n         - IF remote_identity\
    \ = home_agent_identity_1\n              Then authenticate (shared secret/certificate/)\n\
    \              and authorize CHILD_SA for remote address home_agent_1\n      \
    \ home agent PAD:\n         - IF remote_identity = user_1\n              Then\
    \ authenticate (shared secret/certificate/EAP)\n              and authorize CHILD_SAs\
    \ for remote address home_address_1\n   The list of authentication mechanisms\
    \ in the above examples is not\n   exhaustive.  There could be other credentials\
    \ used for authentication\n   stored in the PAD.\n   In case of dynamic home address\
    \ assignment, the home agent creates a\n   temporary PAD entry linking the authenticated\
    \ peer identity and the\n   newly allocated home address.\n"
- title: 7.2.  Security Policy Database Entries
  contents:
  - "7.2.  Security Policy Database Entries\n   The following sections describe the\
    \ security policy entries on the\n   mobile node and the home agent.  The SPD\
    \ entries are only example\n   configurations.  A particular mobile node implementation\
    \ and a Home\n   Agent implementation could configure different SPD entries as\
    \ long as\n   they provide the required security of the Mobile IPv6 signaling\n\
    \   messages.\n   In the examples shown below, the identity of the user of the\
    \ mobile\n   node is assumed to be user_1, the home address of the mobile node\
    \ is\n   assumed to be home_address_1, the primary care-of address of the\n  \
    \ mobile node is assumed to be care_of_address_1, and the IPv6 address\n   of\
    \ the Home Agent is assumed to be home_agent_1.\n"
- title: 7.2.1.  Binding Updates and Acknowledgements
  contents:
  - "7.2.1.  Binding Updates and Acknowledgements\n   The following are the SPD entries\
    \ on the mobile node and the home\n   agent for protecting Binding Updates and\
    \ Acknowledgements.\n       mobile node SPD-S:\n         - IF local_address =\
    \ home_address_1 &\n              remote_address = home_agent_1 &\n          \
    \    proto = MH & local_mh_type = BU & remote_mh_type = BAck\n           Then\
    \ use SA ESP transport mode\n           Initiate using IDi = user_1 to address\
    \ home_agent_1\n       home agent SPD-S:\n         - IF local_address = home_agent_1\
    \ &\n              remote_address = home_address_1 &\n              proto = MH\
    \ & local_mh_type = BAck & remote_mh_type = BU\n           Then use SA ESP transport\
    \ mode\n   In the examples shown above, the home address of the mobile node\n\
    \   might not be available all the time.  For instance, the mobile node\n   might\
    \ not have configured a home address yet.  When the mobile node\n   acquires a\
    \ new home address, it must either add the address to the\n   corresponding SPD\
    \ entries or create the SPD entries for the home\n   address.\n   The home agent\
    \ should have named SPD entries per mobile node, based\n   on the identity of\
    \ the mobile node.  The identity of the mobile node\n   is stored in the \"Name\"\
    \ selector in the SPD [5].  The home address\n   presented by the mobile node\
    \ during the IKE negotiation is stored as\n   the remote IP address in the resultant\
    \ IPsec security associations.\n   If the mobile node dynamically configures a\
    \ home agent and the home\n   address, the home agent may not know which mobile\
    \ nodes it is\n   supposed to be serving.  Therefore, the home agent cannot have\
    \ SPD\n   entries configured per mobile node.  Instead, the home agent should\n\
    \   have generic SPD entries to prevent mobility header traffic that\n   requires\
    \ IPsec protection from bypassing the IPsec filters.  Once a\n   mobile node authenticates\
    \ to the home agent and configures a home\n   address, appropriate SPD entries\
    \ are created for the mobile node.\n   The Mobility Header message type is negotiated\
    \ by placing it in the\n   most significant eight bits of the 16-bit local \"\
    port\" selector\n   during IKEv2 exchange.  For more details, refer to [5].  The\
    \ TSi and\n   TSr payloads in the above examples will contain many other selectors\n\
    \   apart from home_address_1.  For the sake of brevity, we show only\n   those\
    \ values that are relevant for Mobile IPv6.\n"
- title: 7.2.2.  Return Routability Messages
  contents:
  - "7.2.2.  Return Routability Messages\n   The following are the SPD entries on\
    \ the mobile node and the home\n   agent for protecting the Return Routability\
    \ messages.\n       mobile node SPD-S:\n         - IF local_address = home_address_1\
    \ & remote_address = any &\n              proto = MH & local_mh_type = HoTi &\
    \ remote_mh_type = HoT\n           Then use SA ESP tunnel mode\n           Initiate\
    \ using IDi = user_1 to address home_agent_1\n       home agent SPD-S:\n     \
    \    - IF local_address = any & remote_address = home_address_1 &\n          \
    \    proto = MH & local_mh_type = HoT & remote_mh_type = HoTi\n           Then\
    \ use SA ESP tunnel mode\n   When the mobile node's care-of address changes, the\
    \ SPD entries on\n   both the mobile node and the home agent must be updated.\
    \  The home\n   agent knows about the change in care-of address of the mobile\
    \ node\n   when it receives a Binding Update from the mobile node.\n"
- title: 7.2.3.  Mobile Prefix Discovery Messages
  contents:
  - "7.2.3.  Mobile Prefix Discovery Messages\n   The following are the SPD entries\
    \ on the mobile node and the home\n   agent for protecting Mobile Prefix Discovery\
    \ messages.\n       mobile node SPD-S:\n         - IF local_address = home_address_1\
    \ &\n              remote_address = home_agent_1 &\n              proto = ICMPv6\
    \ & local_icmp6_type = MPS &\n              remote_icmp6_type = MPA\n        \
    \   Then use SA ESP transport mode\n           Initiate using IDi = user_1 to\
    \ address home_agent_1\n        home agent SPD-S:\n         - IF local_address\
    \ = home_agent_1 &\n              remote_address = home_address_1 &\n        \
    \      proto = ICMPv6 & local_icmp6_type = MPA &\n              remote_icmp6_type\
    \ = MPS\n           Then use SA ESP transport mode\n   In the examples shown above,\
    \ the home address of the mobile node\n   might not be available all the time.\
    \  When the mobile node acquires a\n   new home address, it must add the address\
    \ to the corresponding SPD\n   entries.\n   The TSi and TSr payloads in the above\
    \ examples will contain many\n   other selectors apart from home_address_1.  For\
    \ brevity, they are not\n   shown here.\n"
- title: 7.2.4.  Payload Packets
  contents:
  - "7.2.4.  Payload Packets\n   The following are the SPD entries on the mobile node\
    \ and the home\n   agent if payload traffic exchanged between the mobile node\
    \ and its\n   Correspondent Node needs to be protected.  The SPD entries are\n\
    \   similar to the entries for protecting Return Routability messages and\n  \
    \ have lower priority than the above SPD entries.\n       mobile node SPD-S:\n\
    \         - IF interface = IPv6 tunnel to home_agent_1 &\n           source =\
    \ home_address_1 & destination = any & proto = X\n           Then use SA ESP tunnel\
    \ mode\n           Initiate using IDi = user_1 to address home_agent_1\n     \
    \  home agent SPD-S:\n         - IF interface = IPv6 tunnel to home_address_1\
    \ &\n           source = any & destination = home_address_1 & proto = X\n    \
    \       Then use SA ESP tunnel mode\n"
- title: 7.3.  Security Association Negotiation Using IKEv2
  contents:
  - "7.3.  Security Association Negotiation Using IKEv2\n   Mobile IPv6 signaling\
    \ messages are typically initiated by the mobile\n   node.  The mobile node sends\
    \ a Binding Update to the home agent\n   whenever it moves and acquires a new\
    \ care-of address.\n   The mobile node initiates an IKEv2 protocol exchange if\
    \ the required\n   security associations are not present.  A possible mechanism\
    \ used for\n   mutual authentication is a shared secret between the mobile node\
    \ and\n   the home agent.  The home agent uses the identity of the mobile node\n\
    \   to identify the corresponding shared secret.  When a public-key-based\n  \
    \ mechanism is available, it should be the preferred mechanism for\n   mutual\
    \ authentication.\n   If a shared secret is being used, the mobile node uses the\
    \ shared\n   secret to generate the AUTH payload in the IKE_AUTH exchange.  If\
    \ the\n   mobile node is using a public-key-based mechanism, then it uses its\n\
    \   private key to generate the AUTH payload in the IKE_AUTH exchange.\n     \
    \   Mobile Node                      Home Agent\n        -----------         \
    \             ----------\n        HDR, SAi1, KEi, Ni      -->\n              \
    \                 <--      HDR, SAr1, KEr, Nr, [CERTREQ]\n        HDR, SK {IDi,\
    \ [CERT,] [CERTREQ,] [IDr,]\n                 AUTH, SAi2, TSi, TSr}\n        \
    \                        -->\n                               <--      HDR, SK\
    \ {IDr, [CERT,] AUTH,\n                                                  SAr2,\
    \ TSi, TSr}\n   The mobile node always includes its identity in the IDi payload\
    \ in\n   the IKE_AUTH exchange.  The mobile node could use the following\n   different\
    \ types of identities to identify itself to the home agent.\n   o  Home Address\
    \ - The mobile node could use its statically configured\n      home address as\
    \ its identity.  In this case the ID Type field is\n      set to ID_IPV6_ADDR.\n\
    \   o  FQDN - The mobile node can use a Fully Qualified Domain Name as\n     \
    \ the identifier and set the ID Type field to ID_FQDN.\n   o  RFC 822 identifier\
    \ - If the mobile node uses a RFC 822 identifier\n      [9], it sets the ID Type\
    \ field to ID_RFC822_ADDR.\n   The above list of identities is not exhaustive.\n\
    \   In the IKE_AUTH exchange, the mobile node includes the home address\n   and\
    \ the appropriate selectors in the TSi (Traffic Selector-initiator)\n   payload\
    \ to negotiate IPsec security associations for protecting the\n   Binding Update\
    \ and Binding Acknowledgement messages.  The mobile node\n   MAY use a range of\
    \ selectors that includes the mobility message types\n   for Binding Update and\
    \ Binding Acknowledgement to use the same pair\n   of IPsec security associations\
    \ for both messages.\n   After the IKE_AUTH exchange completes, the mobile node\
    \ initiates\n   CREATE_CHILD_SA exchanges to negotiate additional security\n \
    \  associations for protecting Return Routability signaling, Mobile\n   Prefix\
    \ Discovery messages, and (optionally) payload traffic.  The\n   CREATE_CHILD_SA\
    \ exchanges are protected by IKEv2 security\n   associations created during the\
    \ IKE_SA_INIT exchange.  If a\n   correspondent node, that is also a mobile node,\
    \ initiates the return\n   routability exchange, then the home agent initiates\
    \ the\n   CREATE_CHILD_SA exchange to negotiate security associations for\n  \
    \ protecting Return Routabilty messages.\n   It is important that the security\
    \ associations are created based on\n   the home address of the mobile node, so\
    \ that the security\n   associations survive care-of address change.  The mobile\
    \ node MUST\n   use its home address as the initiator IP address in the TSi payload\n\
    \   in the CREATE_CHILD_SA exchange in order to create the IPsec security\n  \
    \ associations for the home address.\n        Mobile Node                    \
    \  Home Agent\n        -----------                      ----------\n        HDR,\
    \ SK {[N], SA, Ni, [KEi],\n                 [TSi, TSr]}    -->\n             \
    \                   <--      HDR, SK {SA, Nr, [KEr],\n                       \
    \                           [TSi, TSr]}\n   When PKI-based authentication is used\
    \ between the mobile node and the\n   Home Agent, the identity presented by the\
    \ mobile node in the IDi\n   payload MUST correspond to the identity in the certificate\
    \ obtained\n   by the Home Agent.  The home agent uses the identity presented\
    \ in the\n   IDi payload to lookup the policy and the certificate that corresponds\n\
    \   to the mobile node.  If the mobile node presents its home address in\n   the\
    \ IDi payload, then the home agent MUST verify that the home\n   address matches\
    \ the address in an iPAddress field in the\n   SubjectAltName extension [8].\n\
    \   When the mobile node uses its home address in the IDi field,\n   implementations\
    \ are not required to match the source address in the\n   outermost IP header\
    \ with the IP address in the IDi field.  According\n   to RFC 4306 [4], the IP\
    \ header fields in the IKEv2 messages are\n   ignored and used only in the IP\
    \ headers for IKEv2 messages sent as\n   replies.\n"
- title: 7.4.  Movements and Dynamic Keying
  contents:
  - "7.4.  Movements and Dynamic Keying\n   If the mobile node moves and its care-of\
    \ address changes, the IKEv2\n   SA might not be valid.  RFC 3775 defines a mechanism\
    \ based on the\n   successful exchange of Binding Update and Binding Acknowledgement\n\
    \   messages.  The mobile node establishes the IKE SA with the home agent\n  \
    \ using its primary care-of address.  The IKE SA endpoints are updated\n   on\
    \ the home agent when it receives the Binding Update from the mobile\n   node's\
    \ new care-of address and on the mobile node when it sends the\n   Binding Update\
    \ to the home agent or when it receives the Binding\n   acknowledgement sent by\
    \ the home agent.  This capability to change\n   IKE endpoints is indicated through\
    \ setting the Key Management\n   Capability (K) flag [2] in the Binding Update\
    \ and Binding\n   Acknowledgement messages.  If the mobile node or the home agent\
    \ does\n   not support this capability, and has no other means to update the\n\
    \   addresses, then an IKEv2 exchange MUST be initiated to re-establish a\n  \
    \ new IKE SA.\n"
- title: 8.  The Use of EAP Authentication
  contents:
  - "8.  The Use of EAP Authentication\n   In addition to using public key signatures\
    \ and shared secrets, EAP\n   [10] can be used with IKEv2 for authenticating the\
    \ mobile node to the\n   home agent.\n   The mobile node indicates that it wants\
    \ to use EAP by including the\n   IDi payload but leaving out the AUTH payload\
    \ in the first message\n   during the IKE_AUTH exchange.  The home agent then\
    \ includes an EAP\n   payload if it is willing to use an extensible authentication\
    \ method.\n   Security associations are not created until the subsequent IKE_AUTH\n\
    \   exchange after successful EAP authentication.  The use of EAP adds at\n  \
    \ least two round trips to the IKE negotiation.  The number of round\n   trips\
    \ depends on the EAP method used.\n        Mobile Node                     Home\
    \ Agent\n        ------------                    ----------\n        HDR, SAi1,\
    \ KEi, Ni      -->\n                                <--     HDR, SAr1, KEr, Nr,\
    \ [CERTREQ]\n        HDR, SK {IDi, [CERTREQ,] [IDr,]\n                 SAi2, TSi,\
    \ TSr}-->\n                                <--     HDR, SK {IDr, [CERT,] AUTH,\n\
    \                                                 EAP }\n                    \
    \             .\n                                 .\n                        \
    \         .\n        HDR, SK {EAP}           -->\n                           \
    \     <--     HDR, SK {EAP (success)}\n        HDR, SK {AUTH}          -->\n \
    \                               <--     HDR, SK {AUTH, SAr2, TSi,\n          \
    \                                       TSr}\n   When EAP is used, the identity\
    \ presented by the mobile node in the\n   IDi field may not be the actual identity\
    \ of the mobile node.  It\n   could be set to an identity that is used only for\
    \ Authentication,\n   Authorization, and Accounting (AAA) routing purposes and\
    \ selecting\n   the right EAP method.  It is possible that the actual identity\
    \ is\n   carried inside EAP, invisible to the home agent.  While IKEv2 does\n\
    \   not allow an EAP Identity Request/Response message exchange, EAP\n   methods\
    \ may exchange identities within themselves.  In this case, the\n   home agent\
    \ MUST acquire the mobile node's identity from the\n   corresponding AAA server.\
    \  How the home agent acquires the mobile\n   node's identity is out of scope\
    \ for this document.\n   Some EAP methods, when used with IKEv2, generate a shared\
    \ key on the\n   mobile node and the Home Agent once the EAP authentication succeeds.\n\
    \   This shared key is used to generate the AUTH payloads in the\n   subsequent\
    \ IKEv2 messages.  The shared key, if used to generate the\n   AUTH payloads,\
    \ MUST NOT be used for any other purpose.  For more\n   details, refer to [4].\n\
    \   The use of EAP between the mobile node and the home agent might\n   require\
    \ the home agent to contact an authorization server like the\n   AAA Home server,\
    \ on the home link, to authenticate the mobile node.\n   Please refer to [7] for\
    \ more details.\n"
- title: 9.  Dynamic Home Address Configuration
  contents:
  - "9.  Dynamic Home Address Configuration\n   The mobile node can dynamically configure\
    \ a home address by including\n   a Configuration Payload in the IKE_AUTH exchange,\
    \ with a request for\n   an address from the home link.  The mobile node should\
    \ include a\n   zero-length INTERNAL_IP6_ADDRESS attribute in the CFG_REQUEST\n\
    \   Payload.  The mobile node MAY include multiple instances of the\n   INTERNAL_IP6_ADDRESS\
    \ to request multiple home address to the assigned\n   by the home agent.\n  \
    \ When the home agent receives a configuration payload with a\n   CFG_REQUEST\
    \ for INTERNAL_IP6_ADDRESS, it replies with a valid home\n   address for the mobile\
    \ node.  The INTERNAL_IP6_ADDRESS attribute in\n   the CFG_REPLY contains the\
    \ prefix length of the home prefix in\n   addition to a 128 bit home address.\
    \  The home agent could use a local\n   database or contact a DHCPv6 server on\
    \ the home link to allocate a\n   home address.  The duration for which the home\
    \ address is allocated\n   to the mobile node is the same as the duration for\
    \ which an IKEv2\n   security association exists between the mobile node and the\
    \ home\n   agent.  If the IKEv2 security association is rekeyed, the home\n  \
    \ address lifetime is also extended.\n        Mobile Node                    \
    \    Home Agent\n        -----------                        ----------\n     \
    \   HDR, SK {IDi, [CERT,] [CERTREQ,]\n                 [IDr,] AUTH, CP(CFG_REQUEST),\n\
    \                 SAi2, TSi, TSr}\n                                 -->\n    \
    \                             <--   HDR, SK {IDr, [CERT,] AUTH,\n            \
    \                                    CP(CFG_REPLY), SAr2,\n                  \
    \                              TSi, TSr}\n   The mobile node could suggest a home\
    \ address that it wants to use in\n   the CFG_REQUEST.  For example, this could\
    \ be a home address that was\n   allocated for the mobile node before or an address\
    \ that the mobile\n   node auto-configured from the IPv6 prefix on the home link.\
    \  The Home\n   Agent could let the mobile node use the same home address by setting\n\
    \   the INTERNAL_IP6_ADDRESS attribute in the CFG_REPLY payload to the\n   same\
    \ home address.  If the home agent wants the mobile node to use a\n   different\
    \ home address, it sends a new home address in the\n   INTERNAL_IP6_ADDRESS attribute\
    \ in the CFG_REPLY payload.  The Mobile\n   Node MUST stop using its old home\
    \ address and start using the newly\n   allocated home address.\n   In case the\
    \ home agent is unable to allocate a home address for the\n   mobile node during\
    \ the IKE_AUTH exchange, it MUST send a Notify\n   Payload with an INTERNAL_ADDRESS_FAILURE\
    \ message.  When the mobile\n   node receives a Notify Payload with an INTERNAL_ADDRESS_FAILURE\n\
    \   message, it SHOULD terminate the IKE_AUTH exchange.  The mobile node\n   then\
    \ should initiate a new IKE_SA_INIT and IKE_AUTH exchange and try\n   to auto-configure\
    \ a home address as described in [13].  The mobile\n   node MAY also switch to\
    \ another home agent.  The new home agent\n   address can be obtained by consulting\
    \ a home agent list received\n   during a previous home agent discovery phase\
    \ or, if such list is\n   empty or not available, by attempting a new home agent\
    \ discovery.\n   If the mobile node wants to configure a DNS server from the home\n\
    \   link, it can request the DNS server information by including an\n   INTERNAL_IP6_DNS\
    \ attribute in the CFG_REQUEST payload.\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   This document describes how IPsec can be used\
    \ to secure Mobile IPv6\n   signaling messages.  Please refer to RFC 3775 [2]\
    \ for security\n   considerations related to the use of IPsec with Mobile IPv6.\n\
    \   A misbehaving mobile node could create IPsec security associations\n   for\
    \ a home address that belongs to another mobile node.  Therefore,\n   the home\
    \ agent should check if a particular mobile node is authorized\n   to use a home\
    \ address before creating IPsec security associations for\n   the home address.\
    \  If the home address is assigned as described in\n   Section 9, the home agent\
    \ MUST associate the home address with the\n   identity used in IKE negotiation.\
    \  The home agent MAY store the\n   assigned home address in the SPD entries created\
    \ for the mobile node.\n   The use of EAP for authenticating the mobile node to\
    \ the home agent\n   is described in Section 8.  Security considerations related\
    \ to the\n   use of EAP with IKEv2 are described in [4].\n"
- title: 11.  Acknowledgements
  contents:
  - "11.  Acknowledgements\n   The authors would like to thank Mika Joutsenvirta,\
    \ Pasi Eronen, Jari\n   Arkko, Gerardo Giaretta, Shinta Sugimoto, Tero Kivinen,\
    \ Steve\n   Bellovin, Kilian Weniger, and Vijay Gurbani for reviewing the\n  \
    \ document.\n   Many of the requirements listed in Section 4 are copied from RFC\n\
    \   3776.  Therefore, the authors of RFC 3776 are acknowledged.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [1]   Bradner, S., \"Key words for use in RFCs\
    \ to Indicate Requirement\n         Levels\", BCP 14, RFC 2119, March 1997.\n\
    \   [2]   Johnson, D., Perkins, C., and J. Arkko, \"Mobility Support in\n    \
    \     IPv6\", RFC 3775, June 2004.\n   [3]   Arkko, J., Devarapalli, V., and F.\
    \ Dupont, \"Using IPsec to\n         Protect Mobile IPv6 Signaling Between Mobile\
    \ Nodes and Home\n         Agents\", RFC 3776, June 2004.\n   [4]   Kaufman, C.,\
    \ \"Internet Key Exchange (IKEv2) Protocol\",\n         RFC 4306, December 2005.\n\
    \   [5]   Kent, S. and K. Seo, \"Security Architecture for the Internet\n    \
    \     Protocol\", RFC 4301, December 2005.\n   [6]   Kent, S., \"IP Encapsulating\
    \ Security Payload (ESP)\", RFC 4303,\n         December 2005.\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [7]   Giaretta, G., \"AAA Goals for Mobile\
    \ IPv6\", Work in Progress,\n         September 2006.\n   [8]   Korver, B., \"\
    The Internet IP Security PKI Profile of IKEv1/\n         ISAKMP, IKEv2, and PKIX\"\
    , Work in Progress, February 2007.\n   [9]   Crocker, D., \"Standard for the format\
    \ of ARPA Internet text\n         messages\", STD 11, RFC 822, August 1982.\n\
    \   [10]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.\n        \
    \ Levkowetz, \"Extensible Authentication Protocol (EAP)\",\n         RFC 3748,\
    \ June 2004.\n   [11]  Kent, S. and R. Atkinson, \"Security Architecture for the\n\
    \         Internet Protocol\", RFC 2401, November 1998.\n   [12]  Sugimoto, S.,\
    \ \"PF_KEY Extension as an Interface between Mobile\n         IPv6 and IPsec/IKE\"\
    , Work in Progress, September 2006.\n   [13]  Giaretta, G., \"Mobile IPv6 bootstrapping\
    \ in split scenario\",\n         Work in Progress, December 2006.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Vijay Devarapalli\n   Azaire Networks\n   3121 Jay Street\n\
    \   Santa Clara, CA  95054\n   USA\n   EMail: vijay.devarapalli@azairenet.com\n\
    \   Francis Dupont\n   CELAR\n   EMail: Francis.Dupont@fdupont.fr\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
