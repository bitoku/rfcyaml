- title: __initial_text__
  contents:
  - " RSVP-TE Signaling Extension for LSP Handover from the Management Plane\n   \
    \    to the Control Plane in a GMPLS-Enabled Transport Network\n"
- title: Abstract
  contents:
  - "Abstract\n   In a transport network scenario, Data Plane connections controlled\
    \ by\n   either a Generalized Multiprotocol Label Switching (GMPLS) Control\n\
    \   Plane (Soft Permanent Connections - SPC) or a Management System\n   (Permanent\
    \ Connections - PC) may independently coexist.  The ability\n   of transforming\
    \ an existing PC into an SPC and vice versa -- without\n   actually affecting\
    \ Data Plane traffic being carried over it -- is a\n   requirement.  The requirements\
    \ for the conversion between permanent\n   connections and switched connections\
    \ in a GMPLS Network are defined\n   in RFC 5493.\n   This memo describes an extension\
    \ to GMPLS Resource Reservation\n   Protocol - Traffic Engineering (RSVP-TE) signaling\
    \ that enables the\n   transfer of connection ownership between the Management\
    \ and the\n   Control Planes.  Such a transfer is referred to as a Handover. \
    \ This\n   document defines all Handover-related procedures.  This includes the\n\
    \   handling of failure conditions and subsequent reversion to original\n   state.\
    \  A basic premise of the extension is that the Handover\n   procedures must never\
    \ impact an already established Data Plane\n   connection.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc5852.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. Dedication .................................................4\n  \
    \ 2. Terminology .....................................................4\n   3.\
    \ Motivation ......................................................4\n   4. Procedures\
    \ ......................................................5\n      4.1. MP-to-CP\
    \ Handover: LSP Ownership Transfer from\n           Management Plane to Control\
    \ Plane ..........................6\n      4.2. MP-to-CP Handover Procedure Failure\
    \ Handling ...............7\n           4.2.1. MP-to-CP Handover Failure - Path\
    \ Failure ............8\n                  4.2.1.1. MP-to-CP Handover Failure\
    \ - Path\n                           Message and Data Plane Failure .............8\n\
    \                  4.2.1.2. MP-to-CP Handover Failure - Path\n               \
    \            Message and Communication Failure ..........8\n           4.2.2.\
    \ MP-to-CP Handover Failure - Resv Error ..............9\n                  4.2.2.1.\
    \ MP-to-CP Handover Failure - Resv\n                           Error and Data\
    \ Plane Failure ...............9\n                  4.2.2.2. MP-to-CP Handover\
    \ Failure - Resv\n                           Error and Communication Failure ...........10\n\
    \                  4.2.2.3. MP-to-CP Handover Failure - Node\n               \
    \            Graceful Restart ..........................12\n      4.3. CP-to-MP\
    \ Handover: LSP Ownership Transfer from\n           Control Plane to Management\
    \ Plane .........................15\n      4.4. CP-to-MP Handover Procedure Failure\
    \ .......................16\n   5. Minimum Information for MP-to-CP Handover ......................17\n\
    \   6. RSVP Message Formats ...........................................19\n  \
    \ 7. Objects Modification ...........................................19\n    \
    \  7.1. Administrative Status Object ..............................19\n      7.2.\
    \ Error Spec Object .........................................19\n   8. Compatibility\
    \ ..................................................20\n   9. Security Considerations\
    \ ........................................20\n   10. IANA Considerations ...........................................20\n\
    \   11. Acknowledgments ...............................................21\n  \
    \ 12. Contributors ..................................................21\n   13.\
    \ References ....................................................21\n      13.1.\
    \ Normative References .....................................21\n      13.2. Informative\
    \ References ...................................22\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   In a typical traditional transport network scenario, Data\
    \ Plane (DP)\n   connections between two endpoints are controlled by means of\
    \ a\n   Network Management System (NMS) operating within the Management Plane\n\
    \   (MP).  NMS/MP is the owner of such transport connections, being\n   responsible\
    \ for their setup, teardown, and maintenance.\n   The adoption of a Generalized\
    \ MPLS (GMPLS) [RFC3945] Control Plane\n   (CP) in a network that is already in\
    \ service -- controlled by the NMS\n   at the MP level -- introduces the need\
    \ for a procedure able to\n   coordinate a controlled Handover of a Data Plane\
    \ connection from the\n   MP to the CP.\n   In addition, the control Handover\
    \ in the opposite direction, from CP\n   to MP should be possible as well.  The\
    \ procedures described in this\n   memo can be applied to a Label Switched Path\
    \ (LSP) in any DP\n   switching technology and any network architecture.\n   This\
    \ memo describes an extension to GMPLS Resource reSerVation\n   Protocol - Traffic\
    \ Engineering (RSVP-TE) [RFC3471] [RFC3473]\n   signaling that enables the Handover\
    \ of connection ownership between\n   the Management and the Control Planes. \
    \ All Handover-related\n   procedures are defined below.  This includes the handling\
    \ of failure\n   conditions and subsequent reversion to original state.  A basic\n\
    \   premise of the extension is that the Handover procedures must never\n   impact\
    \ the exchange of user data on LSPs that are already established\n   in the DP.\n"
- title: 1.1.  Dedication
  contents:
  - "1.1.  Dedication\n   We would like to dedicate this work to our friend and colleague\
    \ Dino\n   Bramanti, who passed away at the early age of 38.  Dino has been\n\
    \   involved in this work since its beginning.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n"
- title: 3.  Motivation
  contents:
  - "3.  Motivation\n   The main motivation behind this work is the definition of\
    \ a simple\n   and very low-impact procedure that satisfies the requirements defined\n\
    \   in [RFC5493].  Such a procedure is aimed at giving the transport\n   network\
    \ operators the chance to hand over the ownership of existing\n   LSPs provisioned\
    \ by NMS from the MP to the CP without disrupting user\n   traffic flowing on\
    \ them.  Handover from the MP to the CP (i.e., when\n   existing DP connection\
    \ ownership and control is passed from the MP to\n   the CP) has been defined\
    \ as a mandatory requirement, while the\n   opposite operation, CP-to-MP Handover,\
    \ has been considered as a nice-\n   to-have feature that can be seen as an emergency\
    \ procedure to disable\n   the CP and take manual control of the LSP.  For more\
    \ details on\n   requirements and motivations, please refer to [RFC5493].\n"
- title: 4.  Procedures
  contents:
  - "4.  Procedures\n   The modification defined in this document refers only to the\n\
    \   ADMIN_STATUS Object, that is, the message flow is left unmodified for\n  \
    \ both LSP setup and deletion.  Moreover, a new Error Value is defined\n   to\
    \ identify the failure of a Handover procedure.\n   The following paragraphs give\
    \ detailed description of the \"MP-to-CP\n   Handover\" and \"CP-to-MP Handover\"\
    \ procedures, based on the use of a\n   newly defined bit called \"H bit\".\n\
    \   Just as when setting up an LSP using the CP [RFC3473], the Path\n   message\
    \ may contain full information about the explicit route\n   including the links\
    \ and labels traversed by the LSP.  This\n   information is encoded in the Explicit\
    \ Route Object (ERO), and must\n   be supplied by the MP using details recorded\
    \ when the LSP was\n   provisioned, or collected by the MP by inspecting the nodes\
    \ along the\n   path.\n   Alternatively, and also just as when setting up an LSP\
    \ using the CP\n   [RFC3473], the ERO may include less information such that the\
    \ details\n   of the next hop have to be determined by each node along the LSP\
    \ as\n   it processes the Path message.  This approach may be desirable when\n\
    \   the full information is not available to the MP or cannot be passed\n   to\
    \ the head-end node when initiating the Handover from the MP to the\n   CP.\n\
    \   This section (Section 4) describes the general procedures and\n   protocol\
    \ extensions for MP-to-CP Handover, and it uses the case of a\n   fully detailed\
    \ ERO to describe the mechanism.  Section 5 describes\n   how each node behaves\
    \ in the case of a limited amount of information\n   in the ERO.\n   Note that\
    \ when Handover is being performed for a bidirectional LSP\n   and the ERO contains\
    \ full information including labels, the ERO\n   SHOULD include both upstream\
    \ and downstream labels.  Per Section\n   5.1.1 of [RFC3473], the labels are indicated\
    \ on an output basis; this\n   means that the labels are used by the upstream\
    \ node to create the\n   LABEL_SET Object and, for bidirectional LSPs, the UPSTREAM_LABEL\n\
    \   Object used in the outgoing Path message.\n"
- title: '4.1.  MP-to-CP Handover: LSP Ownership Transfer from Management Plane to'
  contents:
  - "4.1.  MP-to-CP Handover: LSP Ownership Transfer from Management Plane to\n  \
    \    Control Plane\n   The MP-to-CP Handover procedure MUST create an RSVP-TE\
    \ session along\n   the path of the LSP to be moved from the MP to the CP, associating\
    \ it\n   with the existing cross-connected resources owned by the MP (e.g.,\n\
    \   lambdas, time slots, or reserved bandwidth) and at the same time\n   transferring\
    \ their ownership to the CP.\n   The operator instructs the ingress node to hand\
    \ over control of the\n   LSP from the MP to the CP.  In this Handover mode, it\
    \ supplies the\n   exact path of the LSP including any resource reservation and\
    \ label\n   information.\n   The ingress MUST check that no corresponding Path\
    \ state exists and\n   that corresponding Data Plane state does exist.  If there\
    \ is an\n   error, this MUST be reported to the operator and further protocol\n\
    \   action MUST NOT be taken.\n   The ingress signals the LSP using a Path message\
    \ with the H bit and R\n   bit set in the ADMIN_STATUS Object.  In this mode of\
    \ Handover, the\n   Path message also carries an ERO that includes Label subobjects\n\
    \   indicating the labels used by the LSP at each hop.  The ingress MUST\n   start\
    \ the Expiration timer (see Section 4.2.1.2 for expiration of\n   this timer).\
    \  Such a timer SHOULD be configurable per LSP and have a\n   default value of\
    \ 30 seconds.\n   Each Label Switching Router (LSR) that receives a Path message\
    \ with\n   the H bit set checks to see whether there is any matching Path state.\n\
    \   o  If matching Path state is found with the H bit set, this is a Path\n  \
    \    refresh and should be treated accordingly [RFC3473].\n   o  If matching Path\
    \ state is found with the H bit clear, this is an\n      error and MUST be treated\
    \ according to the error case description\n      in Section 4.2.1.1.\n   o  If\
    \ no Path state is found, the LSR goes on to check whether there\n      is any\
    \ matching Data Plane state.\n   o  If no matching Data Plane state is found (including\
    \ only partially\n      matching Data Plane state), this is an error or a race\
    \ condition.\n      It MUST be handled according to the description in Section\n\
    \      4.2.1.1.\n   o  If matching Data Plane state is found, the LSR MUST save\
    \ the Path\n      state (including the set H bit), and it MUST forward the Path\n\
    \      message to the egress.  The LSR MUST retain any MP state\n      associated\
    \ with the LSP at this point.\n   An egress LSR MUST act as any other LSR, except\
    \ that there is no\n   downstream node to which to forward the Path message. \
    \ If all checks\n   are passed, the egress MUST respond with a Resv with the H\
    \ bit set.\n   A transit LSR MUST process each Resv according to the normal rules\
    \ of\n   [RFC3473].\n   When an ingress LSR receives a Resv message carrying the\
    \ H bit set,\n   it checks the Expiration timer.\n   o  If the timer is not running,\
    \ the Resv is treated as a refresh and\n      no special action is taken [RFC3473].\n\
    \   o  If the timer is running, the ingress MUST cancel the timer and\n      SHOULD\
    \ notify the operator that the first stage of Handover is\n      complete.  The\
    \ ingress MUST send a Path message that is no\n      different from the previous\
    \ message except that the H bit MUST be\n      clear.\n   The Path message with\
    \ the H bit clear will travel the length of the\n   LSP and will result in the\
    \ return of a Resv with the H bit clear\n   according to normal processing [RFC3473].\
    \  As a result, the H bit\n   will be cleared in the stored Path state at each\
    \ transit LSR and at\n   the egress LSR.  Each LSR SHOULD release any associated\
    \ MP state\n   associated with the LSP when it receives the Path message with\
    \ H bit\n   clear, but MAY retain the information according to local policy for\n\
    \   use in future MP processing.\n   When the ingress receives a Resv with the\
    \ H bit clear, the Handover\n   is completed.  The ingress SHOULD notify the operator\
    \ that the\n   Handover is correctly completed.\n"
- title: 4.2.  MP-to-CP Handover Procedure Failure Handling
  contents:
  - "4.2.  MP-to-CP Handover Procedure Failure Handling\n   In the case of MP-to-CP\
    \ Handover, two different failure scenarios can\n   happen: Path Failure and Resv\
    \ Failure.  Moreover, each failure can be\n   due to two different causes: DP\
    \ Failure or Communication Failure.  In\n   any case, the LSP ownership MUST be\
    \ immediately rolled back to the\n   one previous to the Handover procedure. \
    \ A section for each\n   combination will be analyzed in the following.\n"
- title: 4.2.1.  MP-to-CP Handover Failure - Path Failure
  contents:
  - '4.2.1.  MP-to-CP Handover Failure - Path Failure

    '
- title: 4.2.1.1.  MP-to-CP Handover Failure - Path Message and Data Plane
  contents:
  - "4.2.1.1.  MP-to-CP Handover Failure - Path Message and Data Plane\n         \
    \ Failure\n   In the following paragraph, we will analyze the case where the\n\
    \   Handover procedure fails during the Path message processing.\n     |     \
    \ Path      |                |                |\n     |--------------->|     \
    \ Path      |                |\n     |                |---------------X|     \
    \           |\n     |                |    PathErr     |                |\n   \
    \  |    PathErr     |<---------------|                |\n     |<---------------|\
    \                |                |\n     |                |                |\
    \                |\n   Ingress LER      LSR A            LSR B       Egress LER\n\
    \                 Figure 1: MP2CP - Path Msg and DP Failure\n   If an error occurs,\
    \ the node detecting the error MUST respond to the\n   received Path message with\
    \ a PathErr message, and MUST abort the\n   Handover procedure.  The PathErr message\
    \ SHOULD have the\n   Path_State_Removed flag set [RFC3473], but implementations\
    \ MAY retain\n   their local state and wait for Path state timeout as per normal\
    \ RSVP\n   processing.\n   Nodes receiving a PathErr message MUST follow standard\
    \ PathErr\n   message processing and the associated DP resources MUST NOT be\n\
    \   impacted.  If the local CP state indicates that a Handover is in\n   progress\
    \ (based on the H bit in the Path message), the LSR MUST\n   revert the LSP ownership\
    \ to the MP.\n"
- title: 4.2.1.2.  MP-to-CP Handover Failure - Path Message and Communication
  contents:
  - "4.2.1.2.  MP-to-CP Handover Failure - Path Message and Communication\n      \
    \    Failure\n   Other possible scenarios are shown in the following figures and\
    \ are\n   based on the inability to reach a node along the path of the LSP.\n\
    \   The below scenario postulates the use of a reliable message delivery\n   based\
    \ on the mechanism defined in [RFC2961].\n     |      Path      |            \
    \    |                |\n     |--------------->|      Path      |            \
    \    |\n     |                |---------------X|                |\n     |    \
    \            |---------------X|                |\n     |                |    \
    \  ...       |                |\n     |                |---------------X|    \
    \            |\n     |                |                |                |\n  \
    \ Ingress LER      LSR A            LSR B       Egress LER\n           Figure\
    \ 2: MP2CP - Path Msg and Communication Failure\n                            (Reliable\
    \ Delivery)\n   The Path message sent from LSR A towards LSR B is lost or does\
    \ not\n   reach the destination for any reason.  As a reliable delivery\n   mechanism\
    \ is implemented, LSR A retransmits the Path message for a\n   configurable number\
    \ of times, and if no ack is received, the Handover\n   procedure will be aborted\
    \ (via the Expiration timer).\n   In the next scenario RSVP-TE messages are sent\
    \ without reliable\n   message delivery, that is, no [RFC2961] MessageID procedure\
    \ is used.\n        |      Path      |                |                |\n   \
    \     |--------------->|      Path      |                |\n        |        \
    \        |----------X     |                |\n        |                |     \
    \           |                |\n   TIMER EXPIRES         |                |  \
    \              |\n        |   Path Tear    |   Path Tear    |   Path Tear    |\n\
    \        |--------------->|--------------->|--------------->|\n        |     \
    \           |                |                |\n      Ingress LER      LSR A\
    \            LSR B       Egress LER\n           Figure 3: MP2CP - Path Msg and\
    \ Communication Failure\n                          (No Reliable Delivery)\n  \
    \ If the Resv message is not received before the expiration of the\n   Expiration\
    \ timer, the Handover procedure is aborted as described in\n   Section 4.2.1.1.\
    \  Please note that any node that has forwarded a Path\n   (LSR A), i.e., has\
    \ installed local path state, will send a PathTear\n   when that state is removed\
    \ (according to [RFC2205]).\n"
- title: 4.2.2.  MP-to-CP Handover Failure - Resv Error
  contents:
  - '4.2.2.  MP-to-CP Handover Failure - Resv Error

    '
- title: 4.2.2.1.  MP-to-CP Handover Failure - Resv Error and Data Plane Failure
  contents:
  - "4.2.2.1.  MP-to-CP Handover Failure - Resv Error and Data Plane Failure\n   In\
    \ the case of a failure occurrence during the Resv message\n   processing (in\
    \ case there has been any change in the Data Plane\n   during the signaling),\
    \ the node MUST send a PathErr message [RFC2205]\n   in the upstream direction.\
    \  The PathErr message is constructed and\n   processed as defined above in Section\
    \ 4.2.1.1.  The failure detection\n   node MUST also send a PathTear message downstream.\
    \  The PathTear\n   message is constructed and processed as defined above in\n\
    \   Section 4.2.1.1.\n     |      Path      |      Path      |      Path     \
    \ |\n     |--------------->|--------------->|--------------->|\n     |       \
    \         |                |      Resv      |\n     |                |      Resv\
    \      |<---------------|\n     |                |X---------------|          \
    \      |\n     |    PathErr     |    PathTear    |    PathTear    |\n     |<---------------|--------------->|--------------->|\n\
    \     |                |                |                |\n   Ingress LER   \
    \   LSR A            LSR B       Egress LER\n                Figure 4: MP2CP -\
    \ Resv Error and DP Failure\n   In the case shown in Figure 4, the failure occurs\
    \ in LSR A.  A\n   PathTear message is sent towards B and a PathErr message (with\n\
    \   ErrorCode set to \"Handover Procedure Failure\") is sent in the\n   upstream\
    \ direction.  The PathErr and PathTear messages remove the\n   Path state established\
    \ by the Path messages along the nodes of the\n   LSP and abort the Handover procedure.\n\
    \   Please note that the failure occurred after the Handover procedure\n   was\
    \ successfully completed in LSR B, but Handover state will still be\n   maintained\
    \ locally as, per Section 4.1, a Path message with the H bit\n   clear will have\
    \ not yet been sent or received.  A node that receives\n   a PathTear when it\
    \ has Path state with the H bit set MUST remove Path\n   state, but MUST NOT change\
    \ Data Plane state.  It MUST return LSP\n   ownership to the MP.\n"
- title: 4.2.2.2.  MP-to-CP Handover Failure - Resv Error and Communication
  contents:
  - "4.2.2.2.  MP-to-CP Handover Failure - Resv Error and Communication\n        \
    \  Failure\n   When a Resv message cannot reach one or more of the upstream nodes,\n\
    \   the procedure is quite similar to the one previously seen about the\n   Path\
    \ message.  Even in this case, it is possible to distinguish two\n   different\
    \ scenarios.\n   In the first scenario we consider the utilization of a reliable\n\
    \   message delivery based on the mechanism defined in [RFC2961].  After\n   a\
    \ correct forwarding of the Path message along the nodes of the LSP,\n   the Egress\
    \ LSR sends a Resv message in the opposite direction.  It\n   might happen that\
    \ the Resv message does not reach the ingress Label\n   Edge Router (LER) or an\
    \ LSR, say LSR A.  LSR B MUST send a Resv\n   message again for a configurable\
    \ number of times and then, if the\n   delivery does not succeed, the adoption\
    \ procedure will be aborted\n   (via the Expiration timer).\n     |      Path\
    \      |      Path      |      Path      |\n     |--------------->|--------------->|--------------->|\n\
    \     |                |                |      Resv      |\n     |           \
    \     |      Resv      |<---------------|\n     |                |      X---------|\
    \                |\n     |                |      X---------|                |\n\
    \     |                |      ...       |                |\n     |           \
    \     |      X---------|                |\n     |                |           \
    \     |                |\n   Ingress\n         LSR A            LSR B       Egress\
    \ LER\n          Figure 5: MP2CP - Resv Error and Communication Failure\n    \
    \                        (Reliable Delivery)\n   Considering that the Resv message\
    \ did not manage to reach LSR A, it\n   is highly probable that the PathErr would\
    \ fail too.  Due to this\n   fact, the Expiration timer is used on the ingress\
    \ LER after sending\n   the path and on LSR A after forwarding it.  When the timer\
    \ expires,\n   if no Resv or PathErr message is received, the Handover procedure\
    \ is\n   aborted as described in Section 4.2.1.1 and the LSP ownership is\n  \
    \ returned to the Management Plane.\n   Figure 6, on the other hand, shows the\
    \ scenario in which no reliable\n   delivery mechanism is implemented.\n     \
    \      |      Path      |      Path      |      Path      |\n           |--------------->|--------------->|--------------->|\n\
    \           |                |                |      Resv      |\n           |\
    \                |      Resv      |<---------------|\n           |           \
    \     |      X---------|                |\n   TIMER EXPIRES            |     \
    \           |                |\n           |   Path Tear    |   Path Tear    |\
    \   Path Tear    |\n           |--------------->|--------------->|--------------->|\n\
    \           |                |                |                |\n      Ingress\
    \ LER      LSR A            LSR B       Egress LER\n          Figure 6: MP2CP\
    \ - Resv Error and Communication Failure\n                          (No Reliable\
    \ Delivery)\n   If no Resv message is received before the Expiration timer expires,\n\
    \   the ingress LER follows the same procedure defined in Section 4.1.\n"
- title: 4.2.2.3.  MP-to-CP Handover Failure - Node Graceful Restart
  contents:
  - "4.2.2.3.  MP-to-CP Handover Failure - Node Graceful Restart\n   If node restart\
    \ and graceful restart are enabled, then one of the\n   following scenarios will\
    \ happen.\n   Case I - Finite Restart Time\n   In this case, the Restart Time\
    \ (see [RFC3473]) is finite, i.e., not a\n   value of 0xffffffff.  In the sequence\
    \ diagram below, assume LSR A\n   restarts.  If the ingress LER does not receive\
    \ the Resv message in\n   time, it MUST abort the Handover process by generating\
    \ a PathTear\n   message downstream.  Also, if LSR A does not complete the restart\n\
    \   process within the restart time interval, then LSR B MUST start\n   tearing\
    \ down all LSPs between LSR A and LSR B and this includes the\n   LSP that is\
    \ being used to carry out the Handover of MP resources to\n   the CP.  LSP B MUST\
    \ generate a PathTear message downstream and a\n   PathErr message upstream. \
    \ Both LSR B and the egress LER MUST NOT\n   release the DP resources because,\
    \ in both nodes, the H bit is set in\n   the local Path state.\n     |      Path\
    \      |      Path      |      Path      |\n     |--------------->|--------------->|--------------->|\n\
    \     |                |                |      Resv      |\n     |           \
    \     |      Resv      |<---------------|\n     |                X      X---------|\
    \                |\n     |   PathTear                      |                |\n\
    \     |-------X                   Restart Timer          |\n     |           \
    \                   Expires             |\n     |                     PathErr\
    \     |    PathTear    |\n     |                        X--------|--------------->|\n\
    \     |                                 |                |\n     |           \
    \     X                |                |\n     |                |           \
    \     |                |\n   Ingress LER      LSR A            LSR B       Egress\
    \ LER\n             Figure 7: MP2CP - Node Graceful Restart - Case I\n   Case\
    \ II - Infinite Restart Time\n   In this case, the Restart Time (see [RFC3473])\
    \ indicates that the\n   restart of the sender's Control Plane may occur over\
    \ an indeterminate\n   interval, i.e., is 0xffffffff.  The sequence is quite similar\
    \ to the\n   previous one.  In this sequence, the restart timer will not expire\
    \ in\n   LSR B since it is run infinitely.  Instead, after LSR A restarts, LSR\n\
    \   B MUST start the recovery timer.  The recovery timer will expire\n   since\
    \ there will be no Path message with the RECOVERY LABEL received\n   from LSR\
    \ A given the ingress node had already removed the local Path\n   state after\
    \ it aborts the Handover process.  Thus, LSR B MUST tear\n   down the specific\
    \ LSP that is being used to convert the MP resources\n   to CP by generating a\
    \ PathTear message downstream and PathErr message\n   upstream.  Similarly to\
    \ the previous case, both LSR B and the egress\n   LER MUST NOT release the DP\
    \ resources because the H bit is set in the\n   local Path state.\n     |    \
    \  Path      |      Path      |      Path      |\n     |--------------->|--------------->|--------------->|\n\
    \     |                |                |      Resv      |\n     |           \
    \     |      Resv      |<---------------|\n     |                X      X---------|\
    \                |\n     |   PathTear                      |                |\n\
    \     |-------X                         |                |\n     |           \
    \                      |                |\n     |                X           \
    \     |                |\n     |                |                |           \
    \     |\n     |                |          Recovery Timer         |\n     |   \
    \             |             Expires             |\n     |    PathErr     |   \
    \ PathErr     |    PathTear    |\n     |<---------------|<---------------|--------------->|\n\
    \     |                |                |                |\n   Ingress LER   \
    \   LSR A            LSR B       Egress LER\n             Figure 8: MP2CP - Node\
    \ Graceful Restart - Case II\n   Case III\n   In this case, the ingress LER does\
    \ not abort the Handover process.\n   When LSR A restarts, the ingress LER detects\
    \ the restart and MUST\n   re-generate the Path message with the H bit set in\
    \ order to restart\n   the Handover.\n   When LSR B receives the Path message,\
    \ it sees the H-bit set on the\n   message and also sees that it has the H-bit\
    \ set in its own state and\n   that it has sent the Resv.  But it is also aware\
    \ that LSR A has\n   restarted and could have sent a Path message with a RECOVERY\
    \ LABEL\n   object.  LSR B may attempt to resume the Handover process or may\n\
    \   abort the Handover.  This choice is made according to local policy.\n   If\
    \ resuming the Handover, LSR B MUST treat the received Path message\n   as a retransmission,\
    \ and MUST retransmit its Resv.  If aborting\n   Handover, LSR B MUST return a\
    \ PathErr and MUST send a PathTear\n   downstream.  In both cases, LSR B MUST\
    \ NOT modify the DP state.\n     |      Path      |      Path      |      Path\
    \      |\n     |--------------->|--------------->|--------------->|\n     |  \
    \              |                |      Resv      |\n     |                |  \
    \    Resv      |<---------------|\n     |                X      X---------|  \
    \              |\n     |                                 |                |\n\
    \     |                X                |                |\n     |           \
    \     |                |                |\n     |      Path      |      Path \
    \     |                |\n     |--------------->|--------------->|           \
    \     |\n     |    PathErr     |    PathErr     |    PathTear    |\n     |<---------------|<---------------|--------------->|\n\
    \     |                |                |                |\n   Ingress LER   \
    \   LSR A            LSR B       Egress LER\n            Figure 9: MP2CP - Node\
    \ Graceful Restart - Case III\n"
- title: '4.3.  CP-to-MP Handover: LSP Ownership Transfer from Control Plane to'
  contents:
  - "4.3.  CP-to-MP Handover: LSP Ownership Transfer from Control Plane to\n     \
    \ Management Plane\n   Let's now consider the case of LSP ownership transfer from\
    \ Control\n   Plane to Management Plane.  Also in this section, we will analyze\
    \ the\n   Handover procedure success and failure.\n   The scenario is still a\
    \ DP connection between two nodes acting as\n   ingress and egress for a LSP,\
    \ but in this case, the CP has the\n   ownership and control of the LSP.  The\
    \ CP-to-MP Handover procedure\n   MUST delete the existing RSVP-TE session information\
    \ and MUST NOT\n   affect the cross-connected resources, but just move their ownership\n\
    \   to the MP.\n   In other words, after LSP ownership transfer from CP to MP,\
    \ the LSP\n   is no longer under the control of RSVP-TE, which is no more able\
    \ to\n   \"see\" the LSP itself.  The CP-to-MP Handover procedure MUST be a\n\
    \   standard LSP deletion procedure as described in Section 7.2.1 of\n   [RFC3473].\
    \  The procedure is initiated at the ingress node of the LSP\n   by an MP entity.\
    \  The ingress node and MP exchange the relevant\n   information for this task\
    \ and then propagate it over CP by means of\n   RSVP-TE tear down signaling as\
    \ described below.\n   The ingress node MUST send a Path message in the downstream\
    \ direction\n   with Handover and Reflect bits set in the ADMIN_STATUS Object.\
    \  No\n   action is taken over the DP and transit LSRs must forward such\n   message\
    \ towards the egress node.  All of the nodes MUST keep track of\n   the procedure\
    \ storing the H bit in their local Path and Resv states.\n   Then, every node\
    \ waits for the H bit to be received within the\n   related Resv message.  After\
    \ the Resv message is received by the\n   ingress LER, it MUST send a PathTear\
    \ message in order to clear the\n   whole LSP information recorded on the RSVP-TE\
    \ data structures of the\n   nodes.  Downstream nodes processing a PathTear message\
    \ that follows a\n   Path message with the H bit set, MUST NOT remove any associated\
    \ Data\n   Plane state.  In other words, a normal LSP tear down signaling is\n\
    \   exchanged between nodes traversed by the LSP, but the H bit set in\n   the\
    \ Path message indicates that no DP action has to correspond to CP\n   signaling.\n"
- title: 4.4.  CP-to-MP Handover Procedure Failure
  contents:
  - "4.4.  CP-to-MP Handover Procedure Failure\n   Failures during CP-to-MP Handover\
    \ procedure MUST NOT result in the\n   removal of any associated Data Plane state.\
    \  To that end, when a Resv\n   message containing an ADMIN_STATUS Object with\
    \ the H bit not received\n   during the period of time described in Section 7.2.2.\
    \ of [RFC3473]\n   different processing is required.  While the H bit is set in\
    \ the Path\n   state, a node MUST NOT send a PathTear when a failure is detected.\n\
    \   Instead, the failure is reported upstream using a PathErr.  The only\n   node\
    \ that can send a PathTear is the ingress node, and it can only do\n   this as\
    \ a step in the procedures specified in this document.  This\n   applies to both\
    \ MP-to-CP and CP-to-MP Handover.  The ingress node MAY\n   choose to report the\
    \ failure in the CP-to-MP Handover procedure via\n   the MP.\n   The CP-to-MP\
    \ Handover procedure can also fail due to two causes:\n   PathTear lost or node\
    \ down.  In the former case, if the LSP is not\n   under MP control after the\
    \ Expiration timer elapses, a manual\n   intervention from the network operator\
    \ is requested, while in the\n   latter case, different scenarios may happen:\n\
    \   - CASE I - Path message and node down\n           |      Path      |     \
    \ Path      X                |\n           |--------------->|--------------X \
    \                 |\n           |                |                           \
    \      |\n           |                |                X                |\n  \
    \         |                |                |                |\n           | \
    \               |                |                |\n      Ingress LER      LSR\
    \ A            LSR B       Egress LER\n              Figure 10: Case I - Path\
    \ Message and Node Down\n   Per [RFC3473], Section 7.2.2, the ingress node should\
    \ wait for a\n   configurable amount of time (30 seconds by default) and then\
    \ send a\n   PathTear message.  In this case, the normal deletion procedure MUST\n\
    \   NOT be followed.  When the Expiration timer elapses, a manual\n   intervention\
    \ from network operator is requested and normal, i.e.,\n   pre-CP-to-MP Handover,\
    \ LSP processing continues.\n   - CASE II - Resv message and node down\n     \
    \      |      Path      |      Path      |      Path      |\n           |--------------->|--------------->|--------------->|\n\
    \           |                |                |      Resv      |\n           |\
    \                |      Resv      |<---------------|\n           |           \
    \     X      X---------|                |\n           |                      \
    \           |                |\n           |                X                |\
    \                |\n           |                |                |           \
    \     |\n      Ingress LER      LSR A            LSR B       Egress LER\n    \
    \          Figure 11: Case II - Resv Message and Node Down\n   The procedure to\
    \ be followed is the same depicted in CASE I.  The\n   network operator can ask\
    \ for the automatic CP-to-MP procedure again\n   after the failed node comes back\
    \ up.  Per [RFC3473], section 7.2, the\n   nodes will forward the new Path and\
    \ Resv messages correctly.\n   - CASE III - PathTear message and node down\n \
    \          |      Path      |      Path      |      Path      |\n           |--------------->|--------------->|--------------->|\n\
    \           |      Resv      |      Resv      |      Resv      |\n           |<---------------|<---------------|<---------------|\n\
    \           |    PathTear    |                |                |\n           |--------------->|\
    \    PathTear    X                |\n           |                |------------X\
    \                    |\n           |                |                X       \
    \         |\n           |                |                |                |\n\
    \      Ingress LER      LSR A            LSR B       Egress LER\n           Figure\
    \ 12: Case III - PathTear Message and Node Down\n   This scenario can be managed\
    \ as a normal PathTear lost described\n   above in this section.\n"
- title: 5.  Minimum Information for MP-to-CP Handover
  contents:
  - "5.  Minimum Information for MP-to-CP Handover\n   As described in Section 4,\
    \ it is also possible for the ERO to contain\n   less than the full set of path\
    \ information for the LSP being handed\n   over.  This arises when only a minimal\
    \ set of information is handed\n   to the CP by the MP at the LSP's head-end.\
    \  Instead of collecting all\n   of the LSP information (including the labels)\
    \ and formatting it into\n   an ERO, as described in Section 4, it is possible\
    \ to start with a\n   minimum amount of information.  The full ERO method and\
    \ the\n   partial/no ERO method are not mutually exclusive; support of both\n\
    \   methods is required.\n   At the ingress node, the information needed to specify\
    \ the LSP is the\n   outgoing interface ID, upstream label, and downstream label\
    \ of this\n   interface and egress node ID.  The remaining information about an\n\
    \   existing LSP can then be collected hop by hop, as the signaling is\n   going\
    \ on, by looking up the cross-connection table in the DP at each\n   node along\
    \ the LSP path.\n   Starting from the information available at the ingress LER\
    \ about the\n   outgoing interface ID of that ingress node, the incoming interface\
    \ ID\n   of the next hop can be found by looking up the link resource table/\n\
    \   database in the LER itself.\n   The Path message is hence built with the LABEL_SET\
    \ Object ([RFC3473])\n   and the UPSTREAM_LABEL Object ([RFC3473]), where the\
    \ upstream label\n   and downstream label of ingress outgoing interface of the\
    \ LSP are\n   included in these two objects.  In addition to the above mentioned\n\
    \   objects, the Path message MUST include the ADMIN_STATUS Object with\n   the\
    \ H bit set, as already defined in previous chapters for the\n   detailed ERO-based\
    \ way of proceeding.  Such a Handover Path is sent\n   to the incoming interface\
    \ of the next hop.  When this Path message\n   reaches the second node along the\
    \ LSP, the information about incoming\n   interface ID and the upstream and downstream\
    \ labels of this interface\n   is extracted from it, and it is used to find next\
    \ hop outgoing\n   interface ID and the upstream/downstream labels by looking\
    \ up the DP\n   cross-connection table.\n   After having determined, in this way,\
    \ the parameters describing the\n   LSPs next hop, the outgoing Path message to\
    \ be sent is built\n   replacing the LABEL_SET Object and UPSTREAM_LABEL Object\
    \ content with\n   the looked-up values of upstream and downstream labels.\n \
    \  By repeating this procedure for each transit node along the LSP, it\n   is\
    \ possible to make the Handover Path message reach the egress node,\n   exactly\
    \ following the LSP that is in place over DP.  The ERO MAY, in\n   this case,\
    \ be included in the Path message as an optional object, and\n   MAY be filled\
    \ with the LSP-relevant information down to either the\n   port level with the\
    \ interface ID or the label level with upstream and\n   downstream labels.  The\
    \ ERO can be used to check the consistency of\n   resource in the DP down to the\
    \ port level or label level at each\n   intermediate node along the LSP.\n   Where\
    \ the DP path continues beyond the egress, by indicating the\n   Egress label\
    \ at the head-end of an LSP, the traffic can be directed\n   to the right destination.\
    \  The GMPLS signaling procedure for egress\n   control is described in [RFC4003]\n"
- title: 6.  RSVP Message Formats
  contents:
  - "6.  RSVP Message Formats\n   This memo does not introduce any modification in\
    \ RSVP messages object\n   composition.\n"
- title: 7.  Objects Modification
  contents:
  - "7.  Objects Modification\n   The modifications required concern two RSVP objects:\
    \ the ADMIN_STATUS\n   and ERROR_SPEC Objects.\n"
- title: 7.1.  Administrative Status Object
  contents:
  - "7.1.  Administrative Status Object\n   This memo introduces a new flag into the\
    \ ADMIN_STATUS Object.  The\n   ADMIN_STATUS Object is defined in [RFC3473]. \
    \ This document uses the\n   H bit of the ADMIN_STATUS Object.  The bit is bit\
    \ number 25.\n"
- title: 7.2.  Error Spec Object
  contents:
  - "7.2.  Error Spec Object\n   It is possible that a failure, such as the loss of\
    \ the Data\n   Communication Network (DCN) connection or the restart of a node,\n\
    \   occurs during the LSP ownership handing over.  In this case, the LSP\n   Handover\
    \ procedure is interrupted, the ownership of the LSP must\n   remain with the\
    \ ownership prior to the initiation of the Handover\n   procedure.  It is important\
    \ that the transaction failure not affect\n   the DP.  The LSP is kept in place\
    \ and no traffic hit occurs.\n   The failure is signaled by a PathErr message\
    \ in the upstream\n   direction and PathTear messages in the downstream direction.\
    \  The\n   PathErr messages include an ERROR_SPEC Object specifying the causes\n\
    \   of the failure.\n   This memo introduces a new Error Code (with different\
    \ Error Values)\n   into the ERROR_SPEC Object, defined in [RFC2205].\n   The\
    \ defined Error Code is \"Handover Procedure Failure\", and its value\n   is 35.\
    \  For this Error Code, the following Error Value sub-codes are\n   defined:\n\
    \      1 = Cross-connection mismatch\n      2 = Other failure\n"
- title: 8.  Compatibility
  contents:
  - "8.  Compatibility\n   The main requirement for the Handover procedure to work\
    \ is that all\n   nodes along the path MUST support the extension defined in this\n\
    \   document.  This requirement translates to an administrative\n   requirement\
    \ as it is not enforced at the protocol level.  As defined,\n   non-supporting\
    \ nodes will simply propagate the H bit without setting\n   local state.  This\
    \ may result in an impact on data traffic during the\n   Handover procedure.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   The procedures described in this document rely\
    \ completely on RSVP-TE\n   messages and mechanism.  The use of the H bit being\
    \ set in the\n   ADMIN_STATUS Object basically informs the receiving entity that\
    \ no\n   operations are to be done over the DP as a consequence of such\n   special\
    \ signaling flow.  Using specially flagged signaling messages,\n   we want to\
    \ limit the function of setup and teardown messages to the\n   CP, making them\
    \ ineffective over related DP resource usage.\n   However, the Handover procedures\
    \ allow the Control Plane to be used\n   to take an LSP out of the control of\
    \ the Management Plane.  This\n   could cause considerable disruption and could\
    \ introduce a new\n   security concern.  As a consequence, the use of GMPLS security\n\
    \   techniques is more important.  For RSVP-TE security, please refer to\n   [RFC3473],\
    \ for the GMPLS security framework, please refer to\n   [sec-fwk].\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   IANA manages the bit allocations for the ADMIN_STATUS\
    \ Object\n   ([RFC3473]).  This document requires the allocation of the Handover\n\
    \   bit: the H bit.  IANA has allocated a bit for this purpose.\n   Bit Number\
    \  Hex Value    Name                               Reference\n   ----------  -----------\
    \  ---------------------------------  ---------\n   25          0x00000040   Handover\
    \ (H)                       [RFC5852]\n   IANA has also allocated a new Error\
    \ Code:\n     35  Handover failure\n         This Error Code has the following\
    \ globally defined Error\n         Value sub-codes:\n             1 =  Cross-connection\
    \ mismatch\n             2 =  Other failure\n"
- title: 11.  Acknowledgments
  contents:
  - "11.  Acknowledgments\n   We wish to thank Adrian Farrel, Lou Berger, Alan Elder,\
    \ and Ben\n   Campbell for their assistance and precious advice to prepare this\n\
    \   document for publication.  We also wish to thank Nicola Ciulli\n   (Nextworks)\
    \ who contributed to the initial stage of this document.\n"
- title: 12.  Contributors
  contents:
  - "12.  Contributors\n   Shan Zhu\n   Fujitsu Network Communications Inc.\n   2801\
    \ Telecom Parkway,\n   Richardson, TX 75082\n   USA\n   EMail: Shan.Zhu@us.fujitsu.com\n\
    \   Tel: +1-972-479-2041\n   Igor Bryskin\n   ADVA Optical Networking Inc\n  \
    \ 7926 Jones Branch Drive, Suite 615\n   McLean, VA 22102\n   USA\n   EMail: ibryskin@advaoptical.com\n\
    \   Francesco Fondelli\n   Ericsson\n   Via Negrone 1A\n   Genova - 16145\n  \
    \ Italy\n   EMail: francesco.fondelli@ericsson.com\n   Lou Berger\n   LabN Consulting,\
    \ LLC\n   Phone: +1 301 468 9228\n   EMail: lberger@labn.net\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC2205]  Braden, B., Zhang, L., Berson, S., Herzog, S., and S.\n\
    \              Jamin, \"Resource ReSerVation Protocol (RSVP) -- Version 1\n  \
    \            Functional Specification\", RFC 2205, September 1997.\n   [RFC2961]\
    \  Berger, L., Gan, D., Swallow, G., Pan, P., Tommasi, F.,\n              and\
    \ S. Molendini, \"RSVP Refresh Overhead Reduction\n              Extensions\"\
    , RFC 2961, April 2001.\n   [RFC3471]  Berger, L., \"Generalized Multi-Protocol\
    \ Label Switching\n              (GMPLS) Signaling Functional Description\", RFC\
    \ 3471,\n              January 2003.\n   [RFC3473]  Berger, L., \"Generalized\
    \ Multi-Protocol Label Switching\n              (GMPLS) Signaling Resource ReserVation\
    \ Protocol-Traffic\n              Engineering (RSVP-TE) Extensions\", RFC 3473,\
    \ January 2003.\n   [RFC3945]  Mannie, E., \"Generalized Multi-Protocol Label\
    \ Switching\n              (GMPLS) Architecture\", RFC 3945, October 2004.\n \
    \  [RFC4003]  Berger, L., \"GMPLS Signaling Procedure for Egress\n           \
    \   Control\", RFC 4003, February 2005.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [RFC5493]  Caviglia, D., Bramanti, D., Li,\
    \ D., and D. McDysan,\n              \"Requirements for the Conversion between\
    \ Permanent\n              Connections and Switched Connections in a Generalized\n\
    \              Multiprotocol Label Switching (GMPLS) Network\", RFC 5493,\n  \
    \            April 2009.\n   [sec-fwk]  Fang, L. and M. Behringer, \"Security\
    \ Framework for MPLS\n              and GMPLS Networks\", Work in Progress, March\
    \ 2010.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Diego Caviglia\n   Ericsson\n   Via A. Negrone 1A\n  \
    \ Genova - Sestri Ponente  16153\n   Italy\n   EMail: diego.caviglia@ericsson.com\n\
    \   Daniele Ceccarelli\n   Ericsson\n   Via A. Negrone 1A\n   Genova - Sestri\
    \ Ponente  16153\n   Italy\n   EMail: daniele.ceccarelli@ericsson.com\n   Dino\
    \ Bramanti\n   Ericsson\n   Dan Li\n   Huawei Technologies\n   F3-5-B R&D Center,\
    \ Huawei Base\n   Shenzhen  518129\n   P.R. China\n   EMail: danli@huawei.com\n\
    \   Snigdho Bardalai\n   Fujitsu Network\n   2801 Telecom Parkway\n   Richardson,\
    \ TX  75082\n   USA\n   EMail: sbardalai@gmail.com\n"
