- title: __initial_text__
  contents:
  - '                  Low-Latency Handoffs in Mobile IPv4

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The IETF Trust (2007).\n"
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv4 describes how a Mobile Node can perform IPv4-layer\n\
    \   handoffs between subnets served by different Foreign Agents.  In\n   certain\
    \ cases, the latency involved in these handoffs can be above\n   the threshold\
    \ required for the support of delay-sensitive or real-\n   time services.  The\
    \ aim of this document is to present two methods to\n   achieve low-latency Mobile\
    \ IPv4 handoffs.  In addition, a combination\n   of these two methods is described.\
    \  The described techniques allow\n   greater support for real-time services on\
    \ a Mobile IPv4 network by\n   minimizing the period of time when a Mobile Node\
    \ is unable to send or\n   receive IPv4 packets due to the delay in the Mobile\
    \ IPv4 Registration\n   process.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n      3.6. Movement Detection, MN, and FA Considerations .............19\n\
    \      3.7. L2 Address Considerations .................................21\n  \
    \    3.8. Applicability of PRE-REGISTRATION Handoff .................21\n   4.\
    \ The POST-REGISTRATION Handoff Method ...........................23\n      4.1.\
    \ Two-Party Handoff .........................................24\n      4.2. Three-Party\
    \ Handoff .......................................28\n      4.3. Renewal or Termination\
    \ of Tunneling Service ...............34\n      4.4. When Will the MN Perform\
    \ a Mobile IPv4 Registration? ......34\n      4.5. Handoff Request (HRqst) Message\
    \ Format ....................36\n      4.6. Handoff Reply (HRply) Message Format\
    \ ......................38\n      4.7. Handoff to Third (HTT) Message Format .....................40\n\
    \      4.8. Applicability of POST-REGISTRATION Handoff Method .........40\n  \
    \ 5. Combined Handoff Method ........................................41\n   6.\
    \ Layer 2 and Layer 3 Handoff Timing Considerations ..............42\n   7. Reverse\
    \ Tunneling Support ......................................42\n   8. Handoff Signaling\
    \ Failure Recovery .............................43\n      8.1. PRE-REGISTRATION\
    \ Signaling Failure Recovery ...............43\n           8.1.1. Failure of PrRtSol\
    \ and PrRtAdv .....................43\n           8.1.2. Failure of Inter-FA Solicitation\
    \ and\n                  Advertisement ......................................44\n\
    \      8.2. POST-REGISTRATION Signaling Failure Recovery ..............44\n  \
    \         8.2.1. HRqst Message Dropped ..............................44\n    \
    \       8.2.2. HRply Message Dropped ..............................45\n   9. Generalized\
    \ Link Layer and IPv4 Address (LLA) Extension ........46\n      9.1. 3GPP2 IMSI\
    \ Link Layer Address and Connection ID\n           Extension .................................................47\n\
    \      9.2. 3GPP IMSI Link Layer Address Extension ....................48\n  \
    \    9.3. Ethernet Link Layer Address Extension .....................49\n    \
    \  9.4. IEEE 64-Bit Global Identifier (EUI-64) Address Extension ..50\n      9.5.\
    \ Solicited IPv4 Address Extension ..........................51\n      9.6. Access\
    \ Point Identifier Extension .........................52\n      9.7. FA IPv4 Address\
    \ Extension .................................53\n   10. IANA Considerations ...........................................53\n\
    \      10.1. New Extension Values .....................................53\n  \
    \    10.2. Generalized Link Layer and IP Address Identifier (LLA) ...54\n    \
    \  10.3. New Message Type and Code ................................54\n   11.\
    \ Security Considerations .......................................55\n   12. Acknowledgements\
    \ ..............................................57\n   13. References ....................................................57\n\
    \      13.1. Normative References .....................................57\n  \
    \    13.2. Informative References ...................................58\n   Appendix\
    \ A - Gateway Foreign Agents................................59\n   Appendix B\
    \ - Low Latency Handoffs for Multiple-Interface MNs.......60\n   Appendix C -\
    \ PRE_REGISTRATION Message Summary......................61\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv4 [1] describes how a Mobile Node (MN) can perform\
    \ IPv4-\n   layer handoff between subnets served by different Foreign Agents\n\
    \   (FAs).  In certain cases, the latency involved in handoff can be\n   above\
    \ the threshold required for the support of delay-sensitive or\n   real-time services.\
    \  The aim of this document is to present two\n   techniques to achieve low-latency\
    \ Mobile IPv4 handoff during movement\n   between FAs.  A further combination\
    \ of these two techniques is also\n   described.  The presented techniques allow\
    \ greater support for real-\n   time services on a Mobile IPv4 network by minimizing\
    \ the period of\n   time during which an MN is unable to send or receive IPv4\
    \ packets due\n   to the delay in the Mobile IPv4 Registration process.  One or\
    \ more of\n   these techniques may be required to achieve fast Mobile IPv4 handoffs\n\
    \   over different wireless technologies (e.g., WLAN, Cellular, WiMAX,\n   Flash-OFDM,\
    \ etc.).  Each wireless technology has different layer 2\n   handoff procedures,\
    \ and the best low-latency technique for each\n   scenario should be used to optimize\
    \ the handoff performance.  Further\n   deployment and experimentation are required\
    \ to determine which\n   technique is best suited to the wireless technologies\
    \ in terms of\n   implementation and performance.  Therefore, the authors encourage\n\
    \   further performance measurements and work on low-latency-over-foo\n   specifications\
    \ in collaboration with the appropriate wireless\n   technology fora to describe\
    \ the applicability to different wireless\n   layer 2s.\n   In the rest of this\
    \ section, terminology used throughout the document\n   is presented, the handoff\
    \ techniques are briefly described, and the\n   use of link-layer information\
    \ is outlined.  In Section 2, a brief\n   description of requirements is presented.\
    \  Section 3 describes the\n   details of the PRE-REGISTRATION handoff technique,\
    \ and Section 4\n   describes the details of the POST-REGISTRATION handoff technique.\
    \  In\n   Section 5, a combined method using the two handoff techniques\n   together\
    \ is presented.  Section 6 discusses layer 2 and layer 3\n   handoff timing considerations.\
    \  Section 7 discusses reverse tunneling\n   support, Section 8 describes mechanisms\
    \ to recover from message\n   failures, and Section 9 describes protocol extensions\
    \ required by the\n   handoff techniques.  Sections 10 and 11 discuss IANA and\
    \ security\n   considerations.  Finally, the three appendices discuss additional\n\
    \   material related to the handoff techniques.  Appendix A gives a short\n  \
    \ introduction to Regional Registrations [11], which can be used\n   together\
    \ with low-latency handoffs.  Appendix B discusses low-latency\n   handoff when\
    \ an MN has multiple wireless L2 interfaces, in which case\n   the techniques\
    \ in this document may not be necessary.  Appendix C\n   provides a summary of\
    \ the messages used in PRE-REGISTRATION.\n"
- title: 1.1.  Terminology
  contents:
  - "1.1.  Terminology\n   This section presents a few terms used throughout the document.\n\
    \      oFA - old Foreign Agent (FA), the FA involved in handling the\n       \
    \  care-of address (CoA) of a Mobile Node (MN) prior to a layer 3\n         (L3)\
    \ handoff.\n      nFA - new Foreign Agent, the FA anticipated to be handling an\
    \ MN's\n         care-of address after completion of an L3 handoff.\n      aFA\
    \ - anchor Foreign Agent, the FA that is currently handling the\n         network\
    \ end of the tunnel in POST-REGISTRATION.\n      L2 handoff - Movement of an MN's\
    \ point of layer 2 (L2) connection\n         from one wireless access point to\
    \ another.\n      L3 handoff - Movement of an MN between FAs that involves changing\n\
    \         the care-of address at Layer 3 (L3).\n      L2 trigger - Information\
    \ from L2 that informs L3 of particular\n         events before and after L2 handoff.\
    \  The descriptions of L2\n         triggers in this document are not specific\
    \ to any particular\n         L2, but rather represent generalizations of L2 information\n\
    \         available from a wide variety of L2 protocols.\n      L2-MT - An L2\
    \ trigger that occurs at the MN, informing of movement\n         to a certain\
    \ nFA (Mobile Trigger).\n      L2-ST or source trigger - An L2 trigger that occurs\
    \ at oFA,\n         informing the oFA that L2 handoff is about to occur.\n   \
    \   L2-TT or target trigger - An L2 trigger that occurs at nFA,\n         informing\
    \ the nFA that an MN is about to be handed off to nFA.\n      L2-LU - An L2 trigger\
    \ that occurs at the MN or nFA, informing that\n         the L2 link between MN\
    \ and nFA is established.\n      L2-LD - An L2 trigger that occurs at the oFA,\
    \ informing the oFA\n         that the L2 link between MN and oFA is lost.\n \
    \     low-latency handoff - L3 handoff in which the period of time\n         during\
    \ which the MN is unable to receive packets is minimized.\n      low-loss handoff\
    \ - L3 handoff in which the number of packets\n         dropped or delayed is\
    \ minimized.  Low-loss handoff is often\n         called smooth handoff.\n   \
    \   seamless handoff - L3 handoff that is both low latency and low\n         loss.\n\
    \      bidirectional edge tunnel (BET) -  A bidirectional tunnel\n         established\
    \ between two FAs for purposes of temporarily routing\n         an MN's traffic\
    \ to/from it on a new subnet without requiring\n         the MN to change CoA.\n\
    \      ping-pong - Rapid back-and-forth movement between two wireless\n      \
    \   access points often due to failure of L2 handoff.  Ping-pong\n         can\
    \ occur if radio conditions for both the old and new access\n         points are\
    \ about equivalent and less than optimal for\n         establishing a good, low-error\
    \ L2 connection.\n      network-initiated handoff - L3 handoff in which oFA or\
    \ nFA\n         initiates the handoff.\n      mobile-initiated handoff - L3 handoff\
    \ in which the MN initiates\n         the handoff.\n      MN or FA identifier\
    \ - An IPv4 address of an MN or FA, or an L2\n         identifier that can be\
    \ resolved to the IPv4 address of an MN or\n         FA.  If the identifier is\
    \ an L2 identifier, it may be specific\n         to the L2 technology.\n"
- title: 1.2.  The Techniques
  contents:
  - "1.2.  The Techniques\n   Mobile IPv4 was originally designed without any assumptions\
    \ about the\n   underlying link layers over which it would operate so that it\
    \ could\n   have the widest possible applicability.  This approach has the\n \
    \  advantage of facilitating a clean separation between L2 and L3 of the\n   protocol\
    \ stack, but it has negative consequences for handoff latency.\n   The strict\
    \ separation between L2 and L3 results in the following\n   built-in sources of\
    \ delay:\n      - The MN may only communicate with a directly connected FA.  This\n\
    \        implies that an MN may only begin the registration process after\n  \
    \      an L2 handoff to nFA (new FA) has completed.\n      - The registration\
    \ process takes some non-zero time to complete as\n        the Registration Requests\
    \ propagate through the network.  During\n        this period of time, the MN\
    \ is not able to send or receive IPv4\n        packets.\n   This document presents\
    \ techniques for reducing these built-in delay\n   components of Mobile IPv4.\
    \  The techniques can be divided into two\n   general categories, depending on\
    \ which of the above problems they are\n   attempting to address:\n      - Allow\
    \ the MN to communicate with the nFA while still connected\n        to the oFA.\n\
    \      - Provide for data delivery to the MN at the nFA even before the\n    \
    \    formal registration process has completed.\n   The first category of techniques\
    \ allows the MN to \"pre-build\" its\n   registration state on the nFA prior to\
    \ an underlying L2 handoff.  The\n   second category of techniques allows for\
    \ service to continue\n   uninterrupted while the handoff is being processed by\
    \ the network\n   without requiring the MN's involvement.\n   Three methods are\
    \ presented in this document to achieve low-latency\n   L3 handoff, one for each\
    \ category described above and one as a\n   combination of the two:\n      - PRE-REGISTRATION\
    \ handoff method,\n      - POST-REGISTRATION handoff method, and\n      - combined\
    \ handoff method.\n   The PRE-REGISTRATION handoff method allows the MN to be\
    \ involved in\n   an anticipated IPv4-layer handoff.  The MN is assisted by the\
    \ network\n   in performing an L3 handoff before it completes the L2 handoff.\
    \  The\n   L3 handoff can be either network-initiated or mobile-initiated.\n \
    \  Accordingly, L2 triggers are used both in the MN and in the FA to\n   trigger\
    \ particular L3 handoff events.  The PRE-REGISTRATION method\n   coupled with\
    \ L2 mobility helps to achieve seamless handoffs between\n   FAs.  The basic Mobile\
    \ IPv4 concept involving advertisement followed\n   by registration is supported,\
    \ and the PRE-REGISTRATION handoff method\n   relies on Mobile IPv4 security.\
    \  No new messages are proposed, except\n   for an extension to the Agent Solicitation\
    \ message in the mobile-\n   initiated case.\n   The POST-REGISTRATION handoff\
    \ method proposes extensions to the\n   Mobile IPv4 protocol to allow the oFA\
    \ (old FA) and nFA (new FA) to\n   utilize L2 triggers to set up a bidirectional\
    \ tunnel between oFA and\n   nFA that allows the MN to continue using its oFA\
    \ while on nFA's\n   subnet.  This enables a rapid establishment of service at\
    \ the new\n   point of attachment, which minimizes the impact on real-time\n \
    \  applications.  The MN must eventually perform a formal Mobile IPv4\n   Registration\
    \ after L2 communication with the new FA is established,\n   but this can be delayed\
    \ as required by the MN or FA.  Until the MN\n   performs registration, the FAs\
    \ will set up and move bidirectional\n   tunnels as required to give the MN continued\
    \ connectivity.\n   The combined method involves running a PRE-REGISTRATION and\
    \ a POST-\n   REGISTRATION handoff in parallel.  If the PRE-REGISTRATION handoff\n\
    \   can be performed before the L2 handoff completes, the combined method\n  \
    \ resolves to a PRE-REGISTRATION handoff.  However, if the PRE-\n   REGISTRATION\
    \ handoff does not complete within an access technology\n   dependent time period,\
    \ the oFA starts forwarding traffic for the MN\n   to the nFA as specified in\
    \ the POST-REGISTRATION handoff method.\n   This provides for a useful backup\
    \ mechanism when completion of a\n   PRE-REGISTRATION handoff cannot always be\
    \ guaranteed before the L2\n   handoff completion.\n   It should be noted that\
    \ the methods described in this document may be\n   applied to MNs having a single\
    \ interface (e.g., Wireless LAN\n   interface) or multiple interfaces (e.g., one\
    \ WLAN and one cellular\n   interface).  However, the case of multiply-interfaced\
    \ MNs needs\n   special consideration, since the handoff methods described in\
    \ this\n   document may not be required in all cases (see Appendix B).\n"
- title: 1.3.  L2 Triggers
  contents:
  - "1.3.  L2 Triggers\n   An L2 trigger is a signal of an L2 event.  In this document,\
    \ the L2\n   events relate to the L2 handoff process.  One possible event is early\n\
    \   notice of an upcoming change in the L2 point of attachment of the\n   mobile\
    \ node to the access network.  Another possible event is the\n   completion of\
    \ relocation of the mobile node's L2 point of attachment\n   to a new L2 access\
    \ point.  This information may come explicitly from\n   L2 in a solicited or unsolicited\
    \ manner, or it may be derived from L2\n   messages.  Although the protocols outlined\
    \ in this document make use\n   of specific L2 information, Mobile IPv4 should\
    \ be kept independent of\n   any specific L2.  L2 triggers are an abstraction\
    \ mechanism for a\n   technology-specific trigger.  Therefore, an L2 trigger that\
    \ is made\n   available to the Mobile IPv4 stack is assumed to be generic and\n\
    \   technology independent.  The precise format of these triggers is not\n   covered\
    \ in this document, but the information required to be\n   contained in the L2\
    \ triggers for low-latency handoffs is specified.\n   In order to properly abstract\
    \ from the L2, it is assumed that one of\n   the three entities -- the MN, oFA,\
    \ or nFA -- is made aware of the\n   need for an L2 handoff and that the nFA or\
    \ MN can optionally also be\n   made aware that an L2 handoff has completed. \
    \ A specific L2 will\n   often dictate when a trigger is received and which entity\
    \ will\n   receive it.  Certain L2s provide advance triggers on the network\n\
    \   side, while others provide advance triggers on the MN.  Also, the\n   particular\
    \ timing of the trigger with respect to the actual L2\n   handoff may differ from\
    \ technology to technology.  For example, some\n   wireless links may provide\
    \ such a trigger well in advance of the\n   actual handoff.  In contrast, other\
    \ L2s may provide little or no\n   information in anticipation of the L2 handoff.\n\
    \   An L2 trigger may be categorized according to whether it is received\n   by\
    \ the MN, oFA, or nFA.  Table 1 gives such a categorization along\n   with information\
    \ contained in the trigger.  The methods presented in\n   this document operate\
    \ based on different types of L2 triggers as\n   shown in Table 1.  Once the L2\
    \ trigger is received, the handoff\n   processes described hereafter are initiated.\
    \  The three triggers,\n   L2-ST, L2-TT, and L2-MT, are independent of each other\
    \ and are not\n   expected to occur together since each will trigger a different\
    \ type\n   of handoff behaviour.\n   +-------------+----------------------+------------------------------+\n\
    \   | L2 Trigger  |       Mobile         |           Source             |\n  \
    \ |             |       Trigger        |           Trigger            |\n   |\
    \             |       (L2-MT)        |           (L2-ST)            |\n   +-------------+----------------------+------------------------------+\n\
    \   | Recipient   |          MN          |             oFA              |\n  \
    \ +-------------+----------------------+--------------+---------------+\n   |\
    \ Method      | PRE                  | PRE          | POST          |\n   |  \
    \           | mobile-initiated     | network-     | source        |\n   |    \
    \         |                      | initiated    | trigger       |\n   +-------------+----------------------+--------------+---------------+\n\
    \   | When?       | sufficiently before  | sufficiently | sufficiently  |\n  \
    \ |             | the L2 handoff       | before L2    | before L2     |\n   |\
    \             | so that MN can       | handoff for  | handoff for   |\n   |  \
    \           | solicit PrRtAdv      | FA to send   | oFA & nFA to  |\n   |    \
    \         | from oFA             | PrRtAdv      | exchange      |\n   |      \
    \       |                      | to MN        | HRqst/HRply   |\n   +-------------+----------------------+--------------+---------------+\n\
    \   | Parameters  | nFA identifier       | nFA identifier, MN identifier|\n  \
    \ +-------------+----------------------+------------------------------+\n    \
    \                        Table 1 - L2 Trigger\n                          (continued\
    \ on next page)\n   +------------+----------------------+---------------+---------------+\n\
    \   | L2 Trigger |       Target         |  Link-Up      |  Link-Down    |\n  \
    \ |            |       Trigger        |  (L2-LU)      |   (L2-LD)     |\n   |\
    \            |       (L2-TT)        |               |               |\n   |------------+----------------------+---------------+---------------+\n\
    \   | Recipient  |          nFA         |  MN or nFA    |     oFA       |\n  \
    \ |------------+-----------+----------+---------------+---------------+\n   |\
    \ Method     | PRE       |  POST    |  PRE & POST   |    POST       |\n   |  \
    \          | network-  |  target  |               |               |\n   |    \
    \        | initiated |  trigger |               |               |\n   |------------+----------------------+---------------+---------------+\n\
    \   | When?      |                      | when radio    |  when radio   |\n  \
    \ |            |   same as            | link between  |  link between |\n   |\
    \            |   source trigger     | MN & nFA  is  |  MN and oFA   |\n   |  \
    \          |                      | established   |  is lost      |\n   |------------+----------------------+---------------+---------------+\n\
    \   | Parameters | oFA identifier       | @MN: nFA IPv4 | MN identifier |\n  \
    \ |            | MN identifier        | or L2 addr.   |               |\n   |\
    \            |                      | @nFA: MN IPv4 |               |\n   |  \
    \          |                      | or L2 addr.   |               |\n   +------------+----------------------+---------------+---------------+\n\
    \                           Table 1 - L2 Trigger\n"
- title: 1.4.  Requirements Language
  contents:
  - "1.4.  Requirements Language\n   In this document, the key words \"MAY\", \"MUST\"\
    , \"MUST NOT\",\n   \"OPTIONAL\", \"RECOMMENDED\", \"SHOULD\", and \"SHOULD NOT\"\
    \ are to be\n   interpreted as described in [2].\n"
- title: 2.  Requirements
  contents:
  - "2.  Requirements\n   The following requirements are applicable to low-latency\
    \ handoff\n   techniques and are supported by the methods in this document:\n\
    \      - to provide low-latency and low-loss handoff for real-time\n        services,\n\
    \      - to have no dependence on a wireless L2 technology,\n      - to support\
    \ inter- and intra-access technology handoffs, and\n      - to limit wireless\
    \ bandwidth usage.\n"
- title: 3.  The PRE-REGISTRATION Handoff Method
  contents:
  - "3.  The PRE-REGISTRATION Handoff Method\n   The PRE-REGISTRATION handoff method\
    \ is based on the normal Mobile\n   IPv4 handoff procedure specified in [1], according\
    \ to which:\n      - an advertisement for an FA is received by an MN,\n      -\
    \ the advertisement allows the MN to perform movement detection,\n        and\n\
    \      - the MN registers with the FA.\n   The basic messages specified in [1]\
    \ are extended to carry information\n   required to achieve fast handoffs.  The\
    \ PRE-REGISTRATION method\n   allows both the MN and FA to initiate the layer\
    \ 3 handoff and it can\n   make use of L2 triggers on either the FA or MN side,\
    \ depending on\n   whether network-initiated or mobile-initiated handoff occurs.\n\
    \   PRE-REGISTRATION supports the normal Mobile IPv4 model [1] and\n   optionally\
    \ also the Regional Registration model [11].  There can be\n   advantages in implementing\
    \ [11] together with low-latency handoff\n   mechanisms, in particular in cases\
    \ where the Home Agent (HA) is at a\n   distance (in terms of delay) from the\
    \ nFA.  The time required for the\n   handoff procedure to complete can be reduced\
    \ by using a closer local\n   HA, called Gateway Foreign Agent (GFA) in [11].\
    \  However,\n   implementation of [11] is not required by PRE-REGISTRATION.  PRE-\n\
    \   REGISTRATION also supports movement where a new Authentication,\n   Authorization,\
    \ and Accounting (AAA) transaction must occur to\n   authenticate the MN with\
    \ a new domain.\n"
- title: 3.1.  Operation
  contents:
  - "3.1.  Operation\n   The PRE-REGISTRATION handoff mechanism is summarized in Figure\
    \ 1.\n                            +---------+\n                            | HA\
    \ (GFA)|<---------+\n                            +---------+          | 4.  (Reg)RegReq\n\
    \                                                 | 5.  (Reg)RegReply\n      \
    \                                           v\n                   +-----+    1a.\
    \  PrRtSol    +-----+\n                   |     | -----------------> | nFA |\n\
    \                   | oFA |    1b.  PrRtAdv    |     |\n                   +-----+\
    \ <----------------- +-----+\n                    ^   |                      \
    \ ^\n      (2a.  PrRtSol)|   | 2b                    |\n                    |\
    \   | PrRtAdv               | 3.  (Reg)RegReq\n                    |   |     \
    \                  |\n                    |   v   --------------------+\n    \
    \               +-----+ /\n                   | MN  |\n                   +-----+\
    \    - - - - - ->\n                                Movement\n            Figure\
    \ 1 - PRE-REGISTRATION Handoff Protocol\n   The following steps provide more detail\
    \ on the protocol:\n      1. Message 1a is a Proxy Router (Agent) Solicitation\
    \ (PrRtSol)\n         from oFA to nFA.  It is a Mobile IP agent solicitation\n\
    \         containing an identifier for the nFA (i.e., IP address or L2\n     \
    \    address) in a Generalized Link Layer and IP Address Extension\n         (see\
    \ Section 9).  When message 1a is received by the nFA\n         containing nFA's\
    \ correct identifier in the LLA extension, the\n         nFA MUST return the Proxy\
    \ Router Advertisement (Agent\n         Advertisement) in message 1b.  Message\
    \ 1b is simply nFA's Agent\n         Advertisement containing the nFA layer 2\
    \ address in a\n         Generalized Link Layer and IP Address (LLA) Extension\
    \ (see\n         Section 9.3).  Messages 1a and 1b SHOULD occur in advance of\n\
    \         the PRE-REGISTRATION handoff in order not to delay the handoff.\n  \
    \       For this to occur, oFA SHOULD solicit and cache advertisements\n     \
    \    from neighboring nFAs using messages 1a and 1b, thus decoupling\n       \
    \  the timing of this exchange from the rest of the PRE-\n         REGISTRATION\
    \ handoff.  When the L3 handoff is initiated by a\n         target L2 trigger\
    \ at nFA (L2-TT), message 1b equals message 2b\n         and is sent unsolicited\
    \ directly to MN (tunneled by nFA to MN\n         through oFA) instead of being\
    \ relayed by oFA.\n      2. Message 2a is a Proxy Router Solicitation (PrRtSol)\
    \ from MN to\n         oFA.  It is different from a normal Router (Agent) Solicitation\n\
    \         since it is soliciting an advertisement from a router different\n  \
    \       from the one receiving this message.  It is a Mobile IP Agent\n      \
    \   Solicitation containing an identifier for the nFA (i.e., IP\n         address\
    \ or L2 address) in a Generalized Link Layer and IP\n         Address Extension\
    \ (see Section 9).  The presence of message 2a\n         indicates that the handoff\
    \ is mobile-initiated and its absence\n         means that the handoff is network-initiated.\
    \  In mobile-\n         initiated handoff, message 2a occurs if there is an L2\
    \ trigger\n         in the MN to solicit for a Proxy Router Advertisement\n  \
    \       (PrRtAdv).  When message 2a is received by the oFA, it MUST\n        \
    \ return the Proxy Router Advertisement (Agent Advertisement) in\n         message\
    \ 2b.  This is simply nFA's Agent Advertisement\n         containing the nFA layer\
    \ 2 address in a Generalized Link Layer\n         and IP Address (LLA) Extension\
    \ (see Section 9.3).  In network-\n         initiated source-triggered handoff,\
    \ the L2 trigger occurs at\n         oFA, and oFA MUST relay the Agent Advertisement\
    \ in message 2b\n         without the need for the MN to solicit.  Note that it\
    \ is also\n         possible for nFA to advertise directly to the MN in the\n\
    \         network-initiated target-triggered case (see Section 3.2).\n      3.\
    \ The MN performs movement detection upon receipt of a solicited\n         or\
    \ unsolicited Agent Advertisement and, if required, it sends a\n         Registration\
    \ Request (RegReq) message [1] in message 3 to nFA.\n         When a local Gateway\
    \ Foreign Agent (GFA) is present, this\n         message can optionally be a Regional\
    \ Registration Request\n         (RegRegReq) [11].  Message 3 is routed through\
    \ oFA since the MN\n         is not directly connected to nFA prior to the L2\
    \ handoff.\n      4. Messages 4 and 5 complete the standard Mobile IPv4 Registration\n\
    \         [1] or optionally Regional Registration [11] initiated with\n      \
    \   message 3.  The Registration Request MUST contain the MN's\n         layer\
    \ 2 address in a Generalized Link Layer and IP Address\n         Extension (see\
    \ Sections 3.7 and 9).  This identifier may be a\n         plain Ethernet address\
    \ or an identifier specific to the\n         wireless technology.  If the MN is\
    \ not already connected to\n         nFA, the Registration Reply in message 5\
    \ MUST be buffered by\n         the nFA and unicast to the MN on-link as soon\
    \ as the MN\n         connects to nFA (i.e., L2-LU trigger at nFA, which can be\n\
    \         implemented by the MN sending an Agent Solicitation or\n         optionally\
    \ using special layer 2 techniques, which are outside\n         the scope of this\
    \ document).  This is necessary since the MN\n         may have to detach from\
    \ oFA, due to the wireless L2 connection,\n         before it receives the reply.\
    \  The MN's L2 address is obtained\n         using the extensions in Section 9,\
    \ as described in Section 3.7.\n         Figures 2 and 3 illustrate this procedure.\n\
    \      5. If the registration is successful, packets for the MN are\n        \
    \ tunneled from the HA (or GFA) to the nFA and then to the MN.\n   PRE-REGISTRATION\
    \ is not dependent on [11].  However, if the HA is at\n   a distance (in terms\
    \ of delay) from the nFA, the use of a local GFA\n   may reduce the time required\
    \ for the handoff procedure to complete.\n   The time at which the L2 trigger\
    \ is received by the oFA or MN,\n   thereby triggering the PRE-REGISTRATION handoff,\
    \ compared to the time\n   at which the actual L2 handoff occurs is important\
    \ for the optimal\n   performance of the low-latency handoff.  That is, in the\
    \ optimal\n   case, the L2 trigger will be received and the four messaging steps\
    \ of\n   PRE-REGISTRATION described above will be completed (i.e., up to when\n\
    \   the Registration Request is processed by HA or GFA) before the MN\n   moves.\
    \  Optimally, the Registration Reply and the first packet\n   redirected by the\
    \ HA (or GFA) to nFA will reach the MN at the moment\n   in which the MN's L2\
    \ link to nFA is fully established.  The MN would\n   therefore not suffer any\
    \ disruption due to the L3 handoff.  This\n   cannot always be guaranteed unless\
    \ particular implementation\n   techniques are used.  To alleviate a part of this\
    \ timing problem, the\n   MN MAY set the S bit [1] in low-latency Registration\
    \ Requests sent by\n   the MN.  This allows the MN to receive packets at both\
    \ oFA and nFA\n   during the short layer 2 handoff time.  Other techniques may\
    \ be\n   required, such as L2 techniques or buffering, but these are outside\n\
    \   the scope of this document.  In addition, further handoff smoothing\n   considerations\
    \ may be required to prevent the loss of packets in-\n   flight between HA (or\
    \ GFA) and oFA while the MN performs a PRE-\n   REGISTRATION handoff.  These are\
    \ also outside the scope of this\n   document.\n   Figures 2, 3, and 4 contain\
    \ message timing diagrams for the network-\n   initiated and mobile-initiated\
    \ PRE-REGISTRATION handoff procedures.\n"
- title: 3.2.  Network-Initiated Handoff
  contents:
  - "3.2.  Network-Initiated Handoff\n   As described in Table 1, a PRE-REGISTRATION\
    \ handoff can be initiated\n   at oFA by a source trigger or at nFA by a target\
    \ trigger.  Figures 2\n   and 3 contain message timing diagrams for PRE-REGISTRATION\
    \ network-\n   initiated handoff for source and target triggers.\n   A source-triggered,\
    \ network-initiated handoff occurs when an L2\n   trigger is received at the oFA\
    \ informing it of a certain MN's\n   upcoming movement from oFA to nFA.  The L2\
    \ trigger contains\n   information including the MN's identifier (i.e., the IPv4\
    \ address\n   itself or an identifier that can be resolved to the IPv4 address)\
    \ and\n   the nFA's identifier.  An identifier may be an IPv4 address or\n   something\
    \ specific to the wireless technology (e.g., Base Station or\n   Access Point\
    \ Identifier).  A target-triggered, network-initiated\n   handoff occurs when\
    \ an L2 trigger is received at the nFA informing it\n   of a certain MN's upcoming\
    \ movement from oFA.  This type of trigger\n   is also shown in Table 1 and contains\
    \ information including the MN's\n   and the oFA's identifier.\n   MN        \
    \            oFA                 nFA                 HA/GFA\n    |           \
    \          |<~~~~~~ L2-Source  |                    |\n    |                 \
    \    |           Trigger |                    |\n    |<--------------------| \
    \                  |                    |\n    |     PrRtAdv         |       \
    \            |                    |\n    |                     |             \
    \      |                    |\n    |---------------------------------------->|\
    \                    |\n    |   RegReq or         |                   |      \
    \              |\n    |   RegRegReq (routed via oFA)            |------------------->|\n\
    \    |                                         | RegReq or RegRegReq|\n    | \
    \                                        |                    |\n    |       \
    \                   Buffered ~~~~~>|<-------------------|\n    |---------------------------------------->|\
    \    (Reg)RegReply   |\n    | Agent Solicitation                      |      \
    \              |\n    | (sent when MN connects to nFA)          |            \
    \        |\n    |                                         |                  \
    \  |\n    |<----------------------------------------|                    |\n \
    \   |              (Reg)RegReply              |                    |\n    |  \
    \            (sent when nFA receives Solicitation or L2-LU)  |\n         Figure\
    \ 2 - PRE-REGISTRATION Handoff Message Timing Diagram\n                     (Network-Initiated,\
    \ Source Trigger)\n   In a source-triggered handoff, when oFA receives the trigger\
    \ (L2-ST),\n   it MUST send message 2b, the Proxy Router Advertisement (PrRtAdv),\
    \ to\n   the MN.  The PrRtAdv is nFA's Agent Advertisement [1] with one of the\n\
    \   link-layer extensions described in Section 9.  The use of the\n   contents\
    \ of this extension is described in Section 3.7.  Messages 1a\n   and 1b SHOULD\
    \ be exchanged by oFA and nFA before the L2 trigger is\n   received (see Section\
    \ 3.4.1).  Message 2a is not used.\n   MN                    oFA             \
    \    nFA                 HA/GFA\n    |                     | L2-Target~~~~~~~~>|\
    \                    |\n    |                     |    Trigger        |      \
    \              |\n    |                     |...................|            \
    \        |\n    |<--------------------------------------- |                  \
    \  |\n    |     (PrRtAdv)       |...................|                    |\n \
    \   |                     | Tunneled Agent Advertisement           |\n    |  \
    \                   |                   |                    |\n    |---------------------------------------->|\
    \                    |\n    |   RegReq. or        |                   |      \
    \              |\n    |   RegRegReq (routed via oFA)            |------------------->|\n\
    \    |                                         | RegReq or RegRegReq|\n    | \
    \                                        |                    |\n    |       \
    \                   Buffered ~~~~~>|<-------------------|\n    |---------------------------------------->|\
    \    (Reg)RegReply   |\n    | Agent Solicitation                      |      \
    \              |\n    | (sent when MN connects to nFA)          |            \
    \        |\n    |                                         |                  \
    \  |\n    |<----------------------------------------|                    |\n \
    \   |              (Reg)RegReply              |                    |\n    |  \
    \            (sent when nFA receives Solicitation or L2-LU)  |\n         Figure\
    \ 3 - PRE-REGISTRATION Handoff Message Timing Diagram\n                     (Network-Initiated,\
    \ Target Trigger)\n   In a target-triggered handoff, when nFA receives the trigger\
    \ (L2-TT),\n   it MUST tunnel an Agent Advertisement to the MN through oFA to\n\
    \   initiate the L3 handoff.  The inner advertisement is unicast by nFA\n   to\
    \ MN, thus nFA treats the target trigger as a Router (Agent)\n   Solicitation.\
    \  This advertisement is tunneled to oFA, which functions\n   as a normal router,\
    \ decapsulating the advertisement and forwarding it\n   to the MN.  This message\
    \ MUST be authenticated to prevent attacks\n   (see Section 3.4.2).\n"
- title: 3.3.  Mobile-Initiated Handoff
  contents:
  - "3.3.  Mobile-Initiated Handoff\n   As shown in Table 1, a mobile-initiated handoff\
    \ occurs when an L2\n   trigger is received at the MN informing that it will shortly\
    \ move to\n   nFA.  The L2 trigger contains information such as the nFA's\n  \
    \ identifier (i.e., nFA's IPv4 address or an identifier that can be\n   resolved\
    \ to the nFA's IPv4 address).  As an example, a Wireless LAN\n   MN may perform\
    \ a scan to obtain the Base Station Identifier (BSSID)\n   of the access point\
    \ that is a potential handoff target (i.e., its\n   signal is becoming stronger).\
    \  The message timing diagram is shown in\n   Figure 4.\n   MN               \
    \     oFA                 nFA               HA/GFA\n    |<~~~~~ L2-Trigger   \
    \ |                   |                    |\n    |                     |    \
    \               |                    |\n    |-------------------->|          \
    \         |                    |\n    |      PrRtSol        |                \
    \   |                    |\n    |                     |                   |  \
    \                  |\n    |<--------------------|                   |        \
    \            |\n    |      PrRtAdv        |                   |              \
    \      |\n    |                     |                   |                    |\n\
    \    |---------------------------------------->|                    |\n    | \
    \  RegReq or         |                   |                    |\n    |   RegRegReq\
    \ (routed via oFA)            |------------------->|\n    |                  \
    \                       | RegReq or RegRegReq|\n    |                        \
    \                 |                    |\n    |                          Buffered\
    \ ~~~~~>|<-------------------|\n    |---------------------------------------->|\
    \    (Reg)RegReply   |\n    | Agent Solicitation                      |      \
    \              |\n    | (sent when MN connects to nFA)          |            \
    \        |\n    |                                         |                  \
    \  |\n    |<----------------------------------------|                    |\n \
    \   |              (Reg)RegReply              |                    |\n    |  \
    \            (sent when nFA receives Solicitation or L2-LU)  |\n         Figure\
    \ 4 - PRE-REGISTRATION Handoff Message Timing Diagram\n                      \
    \       (Mobile-Initiated)\n   As a consequence of the L2 trigger (L2-MT), the\
    \ MN MUST send message\n   1a, the Proxy Router Solicitation (PrRtSol).  This\
    \ message is a\n   unicast Agent Solicitation to oFA for a Proxy Router Advertisement\n\
    \   (PrRtAdv).  This solicitation MUST have a TTL=1 as in [1].  The Proxy\n  \
    \ Router Advertisement Solicitation unicast to oFA is an Agent\n   Solicitation\
    \ with a special extension.  The solicitation MUST have an\n   extension containing\
    \ an FA identifier (i.e., IPv4 address or L2\n   address contained in an LLA extension,\
    \ see Section 9) because the MN\n   is soliciting another specific FA's advertisement\
    \ from the oFA.  This\n   specific FA will be the MN's nFA.  The identifier is\
    \ the IPv4 address\n   of the nFA or another identifier that can be used by the\
    \ oFA to\n   resolve to nFA's IPv4 address.  If the identifier is not an IPv4\n\
    \   address, it MAY be specific to the underlying wireless technology,\n   for\
    \ example, an access point or Base Station Identifier (e.g., WLAN\n   BSSID) that\
    \ can be mapped by oFA to the nFA IPv4 address as described\n   in Section 3.4.1.\
    \  The extension containing the identifier is a sub-\n   type of the Generalized\
    \ Link Layer Address Extension described in\n   Section 9.\n   Two extension sub-types\
    \ have been defined to contain the nFA's IPv4\n   address and an access point\
    \ identifier.  They are called the\n   Solicited Agent IPv4 Address Extension\
    \ and the Access Point\n   Identifier Extension, and are described in Sections\
    \ 9.5 and 9.6.\n   These two extensions SHOULD NOT be present in the same PrRtSol\n\
    \   message.\n   When oFA receives the PrRtSol message, it MUST reply to the MN\
    \ with\n   the Proxy Router Advertisement (PrRtAdv, message 2b).  The PrRtAdv\
    \ is\n   simply the Agent Advertisement for the requested nFA, proxied by oFA.\n\
    \   In order to expedite the handoff, the actual nFA advertisement SHOULD\n  \
    \ be cached by the oFA following a previous exchange with nFA, shown in\n   messages\
    \ 1a and 1b, as specified in Section 3.5.  The PrRtAdv message\n   MUST contain\
    \ the nFA's L2 address (using the LLA extension in Section\n   9.3).  This is\
    \ further described in Section 3.7.\n"
- title: 3.4.  Obtaining and Proxying nFA Advertisements
  contents:
  - "3.4.  Obtaining and Proxying nFA Advertisements\n   Since L2 triggers are involved\
    \ in initiating PRE-REGISTRATION\n   handoff, the trigger timing SHOULD be arranged\
    \ such that a full L3\n   PRE-REGISTRATION handoff can complete before the L2\
    \ handoff process\n   completes.  That is, the L2 handoff should be completed\
    \ after the\n   MN's registration with the nFA is performed (message 3 in Figure\
    \ 1).\n   The registration MAY be transmitted in more than one copy (default\n\
    \   recommendation: 2) to reduce the probability that it is lost due to\n   errors\
    \ on the wireless link.  This would not apply to reliable\n   wireless links where\
    \ retransmissions are performed at layer 2 in case\n   of error to guarantee packet\
    \ delivery.\n   A PRE-REGISTRATION handoff in this case requires the MN to receive\
    \ an\n   Agent Advertisement from the nFA through the old wireless access\n  \
    \ point.  How to achieve this is discussed in the following\n   subsections. \
    \ Messages exchanged between FAs MUST be authenticated to\n   prevent impersonation\
    \ attacks.  The minimal requirement is that all\n   FAs involved in low-latency\
    \ handoffs MUST support manual pre-\n   configuration of security associations\
    \ with other neighboring FAs,\n   involving shared keys and the default algorithms\
    \ of [1] (see the\n   Security Considerations of this document).\n"
- title: 3.4.1.  Inter-FA Solicitation
  contents:
  - "3.4.1.  Inter-FA Solicitation\n   This applies to the network-initiated source-triggered\
    \ (L2-ST) and\n   mobile-initiated (L2-MT) cases only.  Inter-FA solicitation\
    \ assumes\n   that oFA has access to the IPv4 address of the nFA.  The IPv4 address\n\
    \   of nFA is obtained by means of an L2 trigger at oFA in the network-\n   initiated\
    \ case (see Section 3.2) or by means of the extension to the\n   Proxy Router\
    \ Solicitation (PrRtSol) from the MN in the mobile-\n   initiated case (see Section\
    \ 3.3).  This extension to the PrRtSol may\n   contain an IPv4 address or another\
    \ identifier, for example, an\n   identifier of a Wireless Base Station such as\
    \ the WLAN BSSID.  In the\n   latter case, the oFA must implement a mechanism\
    \ to resolve the Base\n   Station Identifier to an IPv4 address.  The default\
    \ mechanism is to\n   use a configured table of neighboring Base Station Identifiers\
    \ (e.g.,\n   BSSID) to FA IPv4 address mappings in each FA.  Other automated\n\
    \   discovery mechanisms may also be used.\n   If oFA does not cache advertisements\
    \ (see Section 3.5) once it\n   receives an L2 trigger and obtains the address\
    \ of the nFA for a\n   specific MN, it MUST send a unicast Agent Solicitation\
    \ (PrRtSol) to\n   nFA.  The nFA replies to the oFA by unicasting an Agent Advertisement\n\
    \   with appropriate extensions (PrRtAdv).  This method removes the TTL\n   limitation\
    \ of [1] for Mobile IPv4 messages (i.e., TTL=1 is not\n   applicable here).  The\
    \ TTL limitation cannot be applied since oFA and\n   nFA may be more than one\
    \ hop away and since it is unnecessary for a\n   secured unicast message.  The\
    \ ICMP solicitations and advertisements\n   MUST be authenticated and integrity\
    \ protected.  These messages MUST\n   be protected using Encapsulating Security\
    \ Payload (ESP) [10] to\n   prevent attacks (see the Security Considerations section\
    \ of this\n   document).  An FA MUST NOT accept ICMP solicitations or\n   advertisements\
    \ from sources that are not authenticated.\n   As a practical matter, oFA SHOULD\
    \ pre-solicit and cache\n   advertisements from known neighboring FAs (see section\
    \ 3.5) to avoid\n   performing the solicitation during an actual handoff procedure.\n"
- title: 3.4.2.  Tunneled nFA Advertisements
  contents:
  - "3.4.2.  Tunneled nFA Advertisements\n   This applies to the network-initiated\
    \ target-triggered (L2-TT) case\n   only.  Following a target trigger (L2-TT)\
    \ the nFA MUST send a\n   tunneled Agent Advertisement to the MN through oFA.\
    \  Tunneling nFA\n   advertisements assumes that the nFA is aware of the IPv4\
    \ address for\n   oFA and the MN.  These IPv4 addresses are obtained by means\
    \ of the FA\n   and MN identifiers contained in an L2 trigger received at nFA\
    \ in the\n   network-initiated case (see Section 3.2).  However, in [1] the TTL\n\
    \   must be 1 on Agent Advertisements from the nFA.  Therefore, tunneling\n  \
    \ advertisements is applicable if the TTL limitation of [1] is relaxed.\n   For\
    \ this purpose, a pre-established security association between oFA\n   and nFA\
    \ MUST be in place to authenticate this message and relax the\n   TTL limitation.\
    \  If the implementation requires this, a tunnel SHOULD\n   be configured when\
    \ the inter-FA security association is established.\n   The tunneled ICMP advertisement\
    \ MUST be secured using tunnel mode ESP\n   [10] between nFA and oFA.  An FA MUST\
    \ NOT accept tunneled ICMP\n   packets destined to it from sources that are not\
    \ authenticated.\n"
- title: 3.5.  Caching Router Advertisements
  contents:
  - "3.5.  Caching Router Advertisements\n   In the mobile-initiated (L2-MT) case\
    \ and the network-initiated\n   source-triggered (L2-ST) case, the message exchange\
    \ 1 in Figure 1\n   could impose an additional latency on the L3 handoff process\
    \ if done\n   as part of the handoff procedure.  In order to remove this source\
    \ of\n   latency, the inter-FA Router (Agent) Solicitation and Advertisement\n\
    \   exchange SHOULD be performed in advance of handoff.  A process SHOULD\n  \
    \ be in place at the oFA to solicit its neighboring nFAs at a\n   predefined time\
    \ interval (MIN_SOLICITATION_INTERVAL).  This interval\n   SHOULD NOT be set too\
    \ small to avoid unnecessary consumption of\n   network bandwidth and nFA processing\
    \ resources.  The minimum value of\n   MIN_SOLICITATION_INTERVAL is 1 second.\
    \  If the FA Challenge/Response\n   mechanism in [7] is used, then the MIN_SOLICITATION_INTERVAL\
    \ MUST be\n   set to a value smaller then the window of time in which a challenge\n\
    \   remains valid so that the nFA challenge does not expire before the MN\n  \
    \ issues the Registration Request.  Therefore, the recommended default\n   value\
    \ for the MIN_SOLICITATION_INTERVAL in oFA is (0.5 * nFA's\n   CHALLENGE_WINDOW\
    \ * nFA's Agent Advertisement interval).  The\n   CHALLENGE_WINDOW and Agent Advertisement\
    \ interval are defined in [7]\n   and [1] respectively.  The minimum requirement\
    \ is that the\n   MIN_SOLICITATION_INTERVAL MUST be manually configurable, while\n\
    \   possible autoconfiguration mechanisms are outside the scope of this\n   document.\
    \  To allow advertisement caching in certain implementations\n   and in cases\
    \ where the nFA advertisement interval is very small, it\n   MAY be necessary\
    \ for the implementation in nFA to allow different\n   CHALLENGE_WINDOW and Agent\
    \ Advertisement interval settings for its\n   nFA-oFA interface.\n   The oFA SHOULD\
    \ cache the most recent advertisement from its\n   neighboring nFAs.  This advertisement\
    \ MUST be sent to the MN in\n   message 2b with a TTL=1.  The oFA SHOULD also\
    \ have a mechanism in\n   place to create a list of neighboring nFAs.  The minimum\
    \ requirement\n   for each FA is that it SHOULD allow manual configuration of\
    \ a list of\n   nFA addresses that an MN could possibly perform an L3 handoff\
    \ to.\n   The FA addresses in this list will depend on deployment and radio\n\
    \   coverage.  It is also possible to specify another protocol to achieve\n  \
    \ nFA discovery, but this is outside the scope of this document.\n"
- title: 3.6.  Movement Detection, MN, and FA Considerations
  contents:
  - "3.6.  Movement Detection, MN, and FA Considerations\n   When the MN receives\
    \ an Agent Advertisement with a Mobility Agent\n   extension, it performs actions\
    \ according to the following movement\n   detection mechanism: the MN SHOULD be\
    \ \"Eager\" to perform new\n   bindings.  This means that the MN SHOULD perform\
    \ registrations with\n   any new FA from which it receives an advertisement (i.e.,\
    \ MN is\n   Eager), as long as there are no locally-defined policies in the MN\n\
    \   that discourage the use of the discovered FA.  For example, the MN\n   could\
    \ have a policy based on the cost of service.  The method by\n   which the MN\
    \ determines whether the FA is a new FA is described in\n   [1] and MAY use an\
    \ FA-NAI extension [11].  By being \"Eager\" to\n   perform registrations, the\
    \ MN reduces latency times.\n   The MN also needs to change its default router\
    \ from oFA to nFA.  The\n   MN MUST change its default router to nFA as soon as\
    \ the PRE-\n   REGISTRATION procedure has completed (i.e., Registration Reply\
    \ is\n   received by MN) as described in [1].\n   Overall, the MN behaves as described\
    \ in [1] with the following\n   changes: the specified movement detection mechanism\
    \ mentioned above\n   and the ability to use the L2-MT to initiate an Agent Solicitation\n\
    \   with a special extension (PrRtSol).  Also, when the MN receives an\n   L2-LU\
    \ trigger (i.e., new interface or link is up), it MUST\n   immediately send an\
    \ Agent Solicitation [1] on that interface.  An nFA\n   that receives an Agent\
    \ Solicitation [1] will use it as an L2-LU\n   trigger event, and according to\
    \ [1] it will record the MN's\n   IPv4/layer 2 addresses (i.e., the Address Resolution\
    \ Protocol (ARP)\n   entry).  At that point, the nFA starts delivering data to\
    \ the MN\n   including the previously buffered Registration Reply.  The nFA MAY\n\
    \   also use other L2 mechanisms to detect earlier that the MN has\n   attached\
    \ to the new link and to start forwarding data to it.  The MN\n   SHOULD NOT attempt\
    \ to retransmit a low-latency Registration Request\n   (i.e., Registration Request\
    \ containing an LLA extension described in\n   Section 9.) when it does not receive\
    \ the Registration Reply.\n   When moving from a PRE-REGISTRATION network to a\
    \ normal Mobile IPv4\n   [1] network, the MN will no longer receive PrRtAdv messages\
    \ (i.e.,\n   Agent Advertisements with the LLA extension).  If the MN still\n\
    \   receives L2-MTs, it will attempt to send PrRtSol messages.  The\n   normal\
    \ FA will reply with a normal Agent Advertisement [1].  If the\n   MN does not\
    \ receive a PrRtAdv in reply to its PrRtSol, it MAY\n   retransmit the PrRtSol\
    \ message once after PRE_SOL_INTERVAL seconds\n   and then for another PRE_SOL_ATTEMPTS\
    \ times with exponential backoff\n   of the transmission interval.  If a PrRtAdv\
    \ is not received within\n   PRE_SOL_INTERVAL seconds after the last PrRtSol attempt,\
    \ the MN MUST\n   stop sending PrRtSol messages until after a registration with\
    \ a new\n   FA is performed.  The default value for PRE_SOL_ATTEMPTS is 2, and\n\
    \   for PRE_SOL_INTERVAL, it is 1 second.  It should be noted that the\n   performance\
    \ of the movement detection mechanism mandated in PRE-\n   REGISTRATION (i.e.,\
    \ eager to register) may have sub-optimal behaviour\n   in a standard Mobile IPv4\
    \ [1] network.  Therefore, standard movement\n   detection mechanisms [1] should\
    \ be used in plain Mobile IPv4\n   networks.  Instead, when the MN moves from\
    \ a normal Mobile IPv4 [1]\n   network to a PRE-REGISTRATION network, the MN starts\
    \ receiving L2-MT\n   triggers or PrRtAdv messages.  When the MN receives L2-MT\
    \ triggers or\n   PrRtAdv messages, it SHOULD follow the PRE-REGISTRATION procedure.\n\
    \   If there is uncertainty as to which mode to choose (e.g., MN receives\n  \
    \ messages from both PRE-REGISTRATION and normal FAs), the MN decides\n   based\
    \ on its registration status with the current FA.  If the MN\n   already has a\
    \ valid normal Mobile IPv4 Registration [1] with the\n   advertising FA, it SHOULD\
    \ give priority to the PRE-REGISTRATION\n   procedure.  Otherwise it SHOULD give\
    \ priority to normal Mobile IPv4\n   [1] Registration procedure.  The MN SHOULD\
    \ NOT attempt to perform\n   PRE-REGISTRATION and standard Mobile IPv4 [1] Registrations\
    \ in\n   parallel.\n"
- title: 3.7.  L2 Address Considerations
  contents:
  - "3.7.  L2 Address Considerations\n   Some special considerations should be taken\
    \ with respect to the\n   wireless system on which this handoff method is being\
    \ implemented.\n   Consider an Ethernet-like system such as IEEE 802.11, for example.\n\
    \   In PRE-REGISTRATION, the MN is registering with an FA (nFA) that is\n   not\
    \ its current first-hop router; therefore, the L2 address of the\n   Ethernet\
    \ frame containing the MN's Registration Request reaching the\n   nFA is not the\
    \ MN's address.  Therefore, the FA MUST NOT use the\n   Ethernet address of the\
    \ incoming Registration Request as the MN's L2\n   address as specified in [1].\
    \  This applies to the cases where the\n   wireless access points are bridges\
    \ or routers and independently of\n   whether the FA is implemented in the wireless\
    \ access points\n   themselves.  In this case, the MN's Registration Request (or\
    \ Regional\n   Registration Request) MUST use an L2 address extension to the\n\
    \   registration message.  Such an L2 address is either the same L2\n   address\
    \ that remains constant as the MN moves, or it is the MN's L2\n   address at nFA.\
    \  To communicate its L2 address, the MN includes a\n   Generalized Link Layer\
    \ and IP Address Extension (see Section 9) with\n   its Registration Request (or\
    \ Regional Registration Request) message.\n   If this extension is present, the\
    \ FA MUST use the L2 address\n   contained in the extension to communicate with\
    \ the MN.  If a\n   particular wireless L2 technology has defined a special interface\
    \ to\n   the wireless network that allows the FA to resolve the mapping\n   between\
    \ an MN's IPv4 address and its L2 address without the need to\n   use the extension,\
    \ the L2 address extension contents may be\n   discarded.  For the same reasons\
    \ above, the MN MUST NOT use the\n   source L2 address of the Agent Advertisement\
    \ message (PrRtAdv) as its\n   default router's L2 address.  Therefore, the nFA\
    \ MUST include a\n   Generalized Link Layer and IP Address Extension (see Section\
    \ 9.3)\n   with its Agent Advertisement (PrRtAdv) messages.\n"
- title: 3.8.  Applicability of PRE-REGISTRATION Handoff
  contents:
  - "3.8.  Applicability of PRE-REGISTRATION Handoff\n   The PRE-REGISTRATION handoff\
    \ method is applicable to scenarios where\n   a period of service disruption due\
    \ to layer 3 is not acceptable, for\n   example, when performing real-time communications,\
    \ and therefore\n   where an anticipation of the layer 3 handoff is required.\
    \  Security\n   for the PRE-REGISTRATION handoff method is based on the same security\n\
    \   model as [1] including the use of AAA.  A prerequisite for PRE-\n   REGISTRATION\
    \ is that the FA or MN is able to obtain an L2 trigger\n   informing it of a pending\
    \ L2 handoff procedure.  The target of the L2\n   handoff is another access point\
    \ or radio network that is in the\n   coverage area of a new FA.  The L2 trigger\
    \ information may be in the\n   form of identifiers that need to be resolved to\
    \ IPv4 addresses using\n   methods that may be specific to the wireless network\
    \ and are not\n   considered here.  If, for example, the oFA or MN determines\
    \ that the\n   IPv4 address of the new FA matches oFA's address, then the PRE-\n\
    \   REGISTRATION handoff SHOULD NOT be initiated.\n   The L2 trigger must allow\
    \ enough time for the PRE-REGISTRATION\n   handoff procedure to be performed.\
    \  In many wireless L2 technologies,\n   the L2 handoff procedure involves a number\
    \ of message exchanges\n   before the effective L2 handoff is performed.  For\
    \ such technologies,\n   PRE-REGISTRATION handoff can be initiated at the beginning\
    \ of the L2\n   handoff procedure and completed before the L2 handoff is completed.\n\
    \   It is efficient to engineer the network such that this succession of\n   events\
    \ is ensured.\n   The PRE-REGISTRATION handoff method is applicable in the following\n\
    \   cases:\n      - when the MN has locally defined policies that determine a\n\
    \        preference for one access over another, for example, due to\n       \
    \ service cost within the same or different technology, and\n        therefore\
    \ where it is necessary to allow the MN to select the\n        appropriate FA\
    \ with which to connect.\n      - when L2 security between the MN and the FA is\
    \ either not present\n        or cannot be relied upon to provide adequate security.\n\
    \      - when the trigger to initiate the handoff is received at the MN.\n   In\
    \ the first case, it is necessary to involve eventual local MN\n   policies in\
    \ the movement detection procedure as described in Section\n   3.6.\n"
- title: 4.  The POST-REGISTRATION Handoff Method
  contents:
  - "4.  The POST-REGISTRATION Handoff Method\n   The POST-REGISTRATION handoff method\
    \ uses bidirectional edge tunnels\n   (BETs) or unidirectional tunnels to perform\
    \ low-latency change in the\n   L2 point of attachment for the MN without requiring\
    \ any involvement\n   by the MN.  Figure 5 illustrates the basic POST-REGISTRATION\
    \ handoff.\n                      +------+\n                      |  CN  |\n \
    \                     +------+\n                         |\n                 \
    \       ...\n                         |\n                      +------+   BET\
    \    +------+\n                      | aFA  |==========| nFA  |\n            \
    \          +------+          +------+\n                                      \
    \      | wireless link\n                                            |\n      \
    \                      movement    +------+\n                           --------->\
    \   |  MN  |\n                                        +------+\n             \
    \   Figure 5 - POST-REGISTRATION Concept\n   Following a successful Mobile IPv4\
    \ Registration between MN and oFA,\n   the oFA becomes the mobility anchor point\
    \ for the MN, called the\n   anchor FA (aFA).  When the MN moves from oFA to nFA,\
    \ rather than\n   performing signaling over the wireless link to register with\
    \ the nFA,\n   the MN can defer the L3 handoff and continue to use its aFA (i.e.,\n\
    \   oFA in this case).  If the MN moves to a third FA before registering\n   with\
    \ the nFA, in certain cases described later, the third FA signals\n   aFA to move\
    \ the wireless link end of the BET from nFA to it.  The\n   network end of the\
    \ BET remains anchored at aFA until the MN performs\n   the Mobile IPv4 Registration.\n\
    \   Messages between oFA/aFA and nFA MUST be authenticated.  The minimal\n   requirement\
    \ is that all FAs involved in low-latency handoffs MUST\n   support manual pre-configuration\
    \ of security associations with other\n   neighboring FAs, involving shared keys\
    \ and the default algorithms of\n   [1].  POST-REGISTRATION FAs MUST implement\
    \ the inter-FA\n   authentication extension (FA-FA authentication extension) specified\n\
    \   in [11] and MAY additionally use other security mechanisms.\n"
- title: 4.1.  Two-Party Handoff
  contents:
  - "4.1.  Two-Party Handoff\n   Two-party handoff occurs when the MN moves from oFA\
    \ to nFA.\n   Normally, this movement would result in a new Mobile IPv4\n   Registration\
    \ at nFA.  However, in POST-REGISTRATION, the MN and nFA\n   MAY delay this but\
    \ maintain connectivity using the BET (or\n   alternatively unidirectional tunnel)\
    \ between oFA and nFA.  The\n   protocol is shown in Figure 6.\n         1a) L2-ST\
    \ ~~~~> +------+ 2) HRqst +------+ <~~~ 1b) L2-TT\n                         |\
    \ oFA  |<-------->| nFA  |\n             4a) L2-LD~> +------+ 3) HRply +------+\
    \ <~~~ 4b) L2-LU\n                            ^                  ^\n         \
    \         old L2    |                  |     new L2\n                        \
    \    +-------+    +-----+\n                                    |    |\n      \
    \                              |    |\n                                    V \
    \   V\n                                   +------+  movement\n               \
    \     4c) L2-LU ---> |  MN  | --------->\n                                   +------+\n\
    \            Figure 6 - Two-Party Handoff (POST-REGISTRATION)\n   The following\
    \ describes the progress of a two-party handoff.  The\n   numbered items refer\
    \ to steps in Figure 6.  The source-triggered\n   HRqst/HRply message for tunnel\
    \ creation, the target-triggered\n   HRqst/HRply message for tunnel creation,\
    \ and the HRqst/HRply to\n   extend or terminate a BET (or unidirectional tunnel)\
    \ are identified\n   using the suffixes (s), (t), and (r), respectively.\n   \
    \   1) Either the oFA or nFA receives an L2 trigger informing it that\n      \
    \   a certain MN is about to move from oFA to nFA.  The two cases\n         are:\n\
    \         a) The L2 trigger is a source trigger (L2-ST) at oFA.  The\n       \
    \     trigger contains the MN's L2 address and an identifier for\n           \
    \ the nFA (the IPv4 address itself or an L2 address that can\n            be resolved\
    \ to the IPv4 address of the nFA).\n         b) The L2 trigger is a target trigger\
    \ (L2-TT) at nFA.  The\n            trigger contains the MN's L2 address and an\
    \ identifier for\n            the oFA (the IPv4 address itself or an L2 address\
    \ that can\n            be resolved to the IPv4 address of the oFA).\n      2)\
    \ The FA receiving the trigger sends a Handoff Request (HRqst) to\n         the\
    \ other FA.  There are two cases:\n         a) If oFA is sending the HRqst, the\
    \ H bit is set and the N bit\n            is unset, indicating it is an HRqst(s).\
    \  The HRqst(s)\n            contains the lifetime of the tunnel the oFA is willing\
    \ to\n            support, the MN's IPv4 home address, the MN's HA address,\n\
    \            and an LLA option with the MN's L2 address.  If the lifetime\n  \
    \          is zero and the T bit is not set, the oFA is not willing to\n     \
    \       tunnel any packets for MN.  A positive lifetime and a set T\n        \
    \    bit indicate that the oFA is willing to tunnel for the\n            indicated\
    \ time.  Section 4.5 describes the HRqst(s) and\n            Section 9 describes\
    \ the LLA option.\n         b) If nFA is sending the HRqst, the N bit is set and\
    \ the H bit\n            is unset, indicating that it is an HRqst(t).  If the\
    \ T bit\n            is set, nFA has requested a reverse tunnel and the HRqst(t)\n\
    \            contains the lifetime of the tunnel the nFA is requesting.\n    \
    \        The HRqst(t) also contains an LLA option with the MN's L2\n         \
    \   address.  The MN's IPv4 home address and HA address are not\n            sent,\
    \ unless they are discovered by some means outside the\n            scope of this\
    \ document (for example, as part of the L2-TT).\n            Section 4.5 describes\
    \ the HRqst(t).\n      3) The FA receiving the HRqst sends a Handoff Reply (HRply)\
    \ to the\n         other FA.  There are two cases:\n         a) If oFA is sending\
    \ the HRply, the N bit is set and the H and\n            R bits are unset, indicating\
    \ that the reply is in response\n            to a HRqst(t), i.e., it is an HRply(t).\
    \  If the T bit is\n            set, the HRply(t) contains the tunnel lifetime\
    \ the oFA is\n            willing to provide; otherwise, the tunnel lifetime is\
    \ set to\n            zero indicating that the oFA is not willing to provide\n\
    \            tunnel service.  If both HRply(t) and HRqst(t) have the T\n     \
    \       bit set and non-zero lifetime, a BET is established.  The\n          \
    \  HRply(t) also contains the MN's home subnet IPv4 address,\n            the\
    \ MN's HA address, and an LLA option containing the MN's\n            L2 address.\
    \  Section 4.6 describes the HRply(t).\n         b) If nFA sends the HRply, the\
    \ H bit is set and the N and R\n            bits are unset, indicating that this\
    \ is a response to\n            HRqst(s), i.e., it is an HRply(s).  If the T bit\
    \ is set, the\n            nFA indicates that it requests a reverse tunnel, and\
    \ the\n            lifetime field is set with the requested tunnel lifetime.\n\
    \            The T bit can be set in HRply only if the oFA had set the T\n   \
    \         bit in the corresponding HRqst or if the nFA is required to\n      \
    \      reverse tunnel incoming packets to oFA because ingress\n            filtering\
    \ is enabled on its network.  This establishes a\n            BET.  The tunnel\
    \ lifetime requested by the nFA must be less\n            than or equal to the\
    \ tunnel lifetime offered by oFA in the\n            HRqst(s).  Section 4.6 describes\
    \ the HRply(s).\n      4) The point during the L2 handoff in which the MN is no\
    \ longer\n         connected on a given link is signaled by an L2-LD trigger at\n\
    \         oFA and MN.  Completion of L2 handoff is signaled by an L2-LU\n    \
    \     trigger at nFA and MN.  The trigger is handled as follows:\n         a)\
    \ When oFA receives the L2-LD trigger, it begins forwarding\n            MN-bound\
    \ packets through the forward tunnel to nFA.\n         b) When the nFA receives\
    \ the L2-LU trigger, it begins\n            delivering packets tunneled from oFA\
    \ to MN and forwards\n            outbound packets from MN using normal routing\
    \ mechanisms or\n            through a reverse tunnel to oFA or HA.  The nFA at\
    \ this\n            point may not yet be the default router of the MN (see\n \
    \           Section 4.4); therefore, to receive all outbound packets\n       \
    \     from the MN the nFA must send a unicast proxy ARP message\n            (used\
    \ in [1]) to the MN upon receiving an L2-LU trigger.\n            This proxy ARP\
    \ message is an ARP Reply [5] sent by the nFA\n            on behalf of oFA, therefore\
    \ supplying the nFA link-layer\n            address in the Sender Hardware Address\
    \ field and the oFA\n            IPv4 address in the Target Protocol Address field.\n\
    \         c) When the MN receives the L2-LU, it MAY initiate the Mobile\n    \
    \        IPv4 Registration process by soliciting an Agent\n            Advertisement\
    \ as described in [1].  If the registration is\n            successful, the nFA\
    \ takes over the role of anchor FA (aFA)\n            from the oFA.  Alternatively,\
    \ the MN MAY defer the Mobile\n            IPv4 Registration (see Section 4.4).\n\
    \      5) The oFA becomes an aFA if the MN moves to a third FA before\n      \
    \   having performed a Mobile IPv4 Registration with nFA.\n      6) Should L2\
    \ handoff fail in Step 4 (due to L2 reasons) and a\n         ping-pong situation\
    \ arise, the oFA may be able to determine\n         this case through the trigger\
    \ mechanism (i.e., FA sees\n         successive L2-ST/L2-TT followed by L2-LD\
    \ and then L2-LU).  The\n         FA that originated the HRqst can in this case\
    \ cancel the tunnel\n         by sending an HRqst(r) to the other FA with lifetime\
    \ zero.  It\n         will then simply continue delivering packets to MN exactly\
    \ as\n         if no handoff had been pending.  Section 4.5 describes the\n  \
    \       HRqst(r).\n   If the oFA sets the B bit in HRqst/HRply and the nFA has\
    \ not\n   requested a reverse tunnel by setting the T bit, the nFA SHOULD\n  \
    \ tunnel outgoing packets from the MN to the HA because the MN has\n   requested\
    \ this service from the oFA.  The nFA SHOULD offer this\n   service only if no\
    \ security between the nFA and the MN's HA is\n   required, or if there is an\
    \ existing nFA-HA security association.\n   The actual timing of BET or unidirectional\
    \ tunnel placement depends\n   on the available L2 triggers.  The forward tunnel\
    \ from oFA to nFA is\n   constructed using one of the tunneling procedures described\
    \ in [1]\n   for the HA to FA tunnel with the difference that the ends of the\n\
    \   tunnel are at the oFA and nFA, respectively.  The reverse tunnel from\n  \
    \ nFA to oFA is constructed as described in [3] with the difference\n   that the\
    \ network end of the tunnel is at the oFA instead of the HA.\n   If both forward\
    \ and reverse tunnels are established, then a BET has\n   been established.  With\
    \ optimal L2 trigger information, as described\n   above, the FAs can set up the\
    \ BET immediately when the L2 handoff is\n   initiated, start tunneling MN-bound\
    \ data when the link to the MN goes\n   down, and the nFA can use the link-up\
    \ trigger to start delivering\n   packets.  In the absence of optimal L2 trigger\
    \ information, the HRply\n   can act as the trigger to start tunneling MN-bound\
    \ data, but in this\n   case, the period of packet delivery disruption to the\
    \ MN could still\n   be present and additional measures may be required to provide\n\
    \   uninterrupted service.  Particular implementation and deployment\n   scenarios\
    \ could require techniques to smooth the handoff by providing\n   a means to convey\
    \ packets arriving during the L2 handoff.  The exact\n   techniques are outside\
    \ the scope of this document.\n   Figures 7 and 8 show timing diagrams for source\
    \ trigger (L2-ST) and\n   target trigger (L2-TT) two-party handoffs, respectively.\n\
    \              MN                    nFA                 oFA\n               |\
    \                     |                   |\n               |                \
    \     |     HRqst(s)      |<~~~ L2-ST\n               |                     |<------------------|\n\
    \               |                     |     HRply(s)      |\n               |\
    \                     |------------------>|\n               |                \
    \     |                   |\n              --------------------------------------------<~~~\
    \ L2-LD\n                                L2 Handoff\n              --------------------------------------------<~~~\
    \ L2-LU\n               |                     |                   |\n        \
    \       |<------------------->|                   |\n               |    MN's\
    \ traffic     |                   |\n            Figure 7 - Two-Party Source Trigger\
    \ Handoff Timing\n              MN                    nFA                 oFA\n\
    \               |                     |                   |\n               |\
    \           L2-TT ~~~>|     HRqst(t)      |\n               |                \
    \     |------------------>|\n               |                     |     HRply(t)\
    \      |\n               |                     |<------------------|\n       \
    \        |                     |                   |\n              --------------------------------------------<~~~\
    \ L2-LD\n                                L2 Handoff\n              --------------------------------------------<~~~\
    \ L2-LU\n               |                     |                   |\n        \
    \       |<------------------->|                   |\n               |    MN's\
    \ traffic     |                   |\n            Figure 8 - Two-Party Target Trigger\
    \ Handoff Timing\n   Once the tunnel between aFA and the current FA is in place,\
    \ it is\n   torn down by one of the following events:\n      1) The aFA decides\
    \ to stop tunneling because the lifetime it sent\n         expires and was not\
    \ renewed, or the aFA or current FA decide to\n         terminate tunnel service\
    \ prematurely for some other reason\n         (refer to Section 4.3).\n      2)\
    \ The MN completes the process by performing a Mobile IPv4\n         Registration\
    \ with the current FA.  This may be initiated by the\n         FA that sends an\
    \ Agent Advertisement or by the MN that solicits\n         for an Agent Advertisement\
    \ as in [1].\n      3) The MN moves to a third FA (see Section 4.2)\n"
- title: 4.2.  Three-Party Handoff
  contents:
  - "4.2.  Three-Party Handoff\n   Three-party handoff is applicable when an MN, which\
    \ has already\n   established an aFA and is receiving tunneled packets through\
    \ its\n   current FA, moves to a new FA without performing a Mobile IPv4\n   Registration.\n\
    \   The need for the three-party handoff function depends on the wireless\n  \
    \ system in which POST-REGISTRATION is being implemented.  For radio L2\n   protocols\
    \ in which it is possible for the MN to move so rapidly from\n   one FA to another\
    \ such that a probability exists that the Mobile IPv4\n   Registration with nFA\
    \ will not complete before the MN moves on, HTT\n   (Handoff to Third) SHOULD\
    \ be implemented.  Certain wireless systems\n   and implementations do not allow\
    \ such fast movement between FAs and\n   may force the Mobile IPv4 Registration\
    \ to occur soon after L2\n   handoff, in which case three-party handoff is not\
    \ applicable.  If\n   this three-party handoff feature is not implemented, the\
    \ FA SHOULD\n   send an Agent Advertisement to the MN after L2 handoff has completed\n\
    \   (L2-LU at nFA) and/or the MN SHOULD solicit an Agent Advertisement\n   after\
    \ L2 handoff (L2-LU at MN).\n                                  +------+\n    \
    \                         +--->| aFA  |<---+\n                             | \
    \   +------+    |\n                4b) HRqst(r) |                | 3) HRqst(t)\n\
    \                    HRply(r) |                |    HRply(t)\n               \
    \              |                |\n                             v    2a) HRqst\
    \   v\n          1a) L2-ST ~~~> +------+     HTT  +------+ <~~~ 1b) L2-TT\n  \
    \                       | oFA  |<-------->| nFA  |\n         4a) L2-LD ~~~>  +------+\
    \ 2b) HTT  +------+ <~~~ 5a) L2-LU\n                            ^         HRply\
    \    ^\n                    old L2  |                  |  new L2\n           \
    \                 +-------+    +-----+\n                                    |\
    \    |\n                                    |    |\n                         \
    \           V    V\n                                   +------+  movement\n  \
    \                  5b) L2-LU ~~~> |  MN  | --------->\n                      \
    \             +------+\n                       Figure 9 - Three-Party Handoff\n\
    \   The L3 handoff can be deferred either because of a decision by the\n   MN/FA\
    \ (i.e., MN does not send Agent Solicitations and FA does not\n   send Agent Advertisements),\
    \ or it may result from rapid movement\n   between oFA and nFA that does not allow\
    \ enough time for the\n   registration to complete.  This scenario is shown in\
    \ Figure 9.  In\n   this case, oFA must inform nFA (i.e., the third FA) to contact\
    \ aFA\n   about moving the radio end of the tunnel.  This is performed with the\n\
    \   HTT message.  The general idea behind the three-party handoff\n   procedure\
    \ is that the oFA supplies nFA with the same information it\n   would have obtained\
    \ via an L2-TT if handoff had occurred from aFA to\n   nFA; then, the nFA performs\
    \ an HRqst(t)/HRply(t) sequence with aFA in\n   order to move the BET to nFA.\
    \  When the L2 handoff is complete, oFA\n   sends an HRqst(r) to aFA to terminate\
    \ the previous BET.\n   The following describes the progress of a three-party\
    \ handoff.  The\n   numbered items refer to steps in Figure 9.\n      1) Either\
    \ the oFA or nFA receives an L2 trigger informing it that\n         a certain\
    \ MN is about to be moved.  The two cases are:\n         a) The L2 trigger is\
    \ a source trigger (L2-ST) at oFA.  The\n            trigger contains the MN's\
    \ L2 address and an identifier for\n            the nFA (the IPv4 address itself\
    \ or an L2 address that can\n            be mapped to the IPv4 address of the\
    \ nFA).\n         b) The L2 trigger is a target trigger (L2-TT) at nFA.  The\n\
    \            trigger contains the MN's L2 address and an identifier for\n    \
    \        the oFA (the IPv4 address itself or an L2 address that can\n        \
    \    be resolved to the IPv4 address of the oFA).\n      2) The oFA and nFA exchange\
    \ an HTT/HRply or HRqst/HTT pair.  HTT\n         is indicated by setting both\
    \ the H and N bits in the HRqst or\n         HRply.  The HTT message MUST NOT\
    \ have any tunnel flag bits set,\n         because the tunnel is negotiated between\
    \ the aFA and nFA, not\n         oFA and nFA.  There are two cases:\n        \
    \ a) The L2 trigger is an L2-ST.  The oFA sends HTT to nFA\n            containing\
    \ the MN's home IPv4 address, the MN's HA address,\n            an LLA containing\
    \ the aFA's IPv4 address, and an LLA\n            containing the L2 address of\
    \ the MN.  This is enough\n            information for nFA to perform a target-triggered\
    \ handoff\n            with aFA.  The nFA responds with an HRply(s).  Section\
    \ 4.7\n            describes the HTT.\n         b) The L2 trigger is an L2-TT.\
    \  The nFA sends HRqst(t) to oFA,\n            exactly as if a two-party handoff\
    \ were occurring.  The oFA\n            responds with HTT containing the same\
    \ information as in a)\n            above.  This is enough information for nFA\
    \ to perform a\n            target-triggered handoff with aFA.\n      3) Upon\
    \ receipt of the HTT, the nFA first checks its Visitor Cache\n         to see\
    \ whether it is already tunneling for MN.  If so, Step 6\n         is performed.\
    \  If not, nFA performs a target-triggered handoff\n         with aFA, exactly\
    \ as in Section 4.1, exchanging an\n         HRqst(t)/HRply(t) pair.  Because\
    \ aFA receives no L2 trigger\n         indicating when L2 handoff starts, it may\
    \ start tunneling to\n         nFA upon transmission of the HRply(t).\n      4)\
    \ Once the L2 handoff is under way and the MN gets disconnected\n         at L2,\
    \ aFA and oFA exchange messages canceling tunnel service\n         between aFA\
    \ and oFA and allowing aFA to start the tunnel with\n         nFA.\n         a)\
    \ The point in the L2 handoff process where the MN gets\n            disconnected\
    \ from oFA is signaled at oFA by L2-LD.\n         b) The oFA exchanges an HRqst(r)/HRply(r)\
    \ pair having lifetime\n            zero with aFA.  This cancels tunnel service\
    \ between oFA and\n            aFA.  If aFA has not already established a tunnel\
    \ to nFA, it\n            must do so immediately upon receipt of the HRqst(r).\
    \  The\n            aFA provides tunneling service exactly as described in\n \
    \           Section 4.1, Step 4a.\n      5) Completion of L2 handoff is signaled\
    \ by an L2-LU trigger at nFA\n         and/or MN.  The nFA and MN handle the trigger\
    \ as follows:\n         a) The nFA provides packet delivery service to the MN\
    \ exactly\n            as described in Section 4.1, Step 4b.\n         b) The\
    \ MN either defers or initiates Mobile IPv4 Registration\n            when it\
    \ receives the L2-LU, as in Section 4.1.\n      6) In the special case where nFA\
    \ and aFA are the same (i.e., the\n         MN is moving back to the original\
    \ anchor FA), aFA recognizes\n         that it is tunneling to oFA when it checks\
    \ its Visitor Cache in\n         Step 3.  In this case, there is no need for aFA\
    \ to send the\n         HRqst(t)/HRply(t) in Step 3.  Upon receipt of the L2-LU\
    \ trigger\n         on handoff completion, the aFA begins routing packets to MN\
    \ and\n         the tunnel to nFA is torn down.  The oFA still exchanges the\n\
    \         HRqst(r)/HRply(r) with aFA in Step 4b because oFA cannot know a\n  \
    \       priori that aFA and nFA are the same, but they are redundant.\n   Figures\
    \ 10 and 11 show timing diagrams for source trigger (L2-ST) and\n   target trigger\
    \ (L2-TT) three-party handoff, respectively.\n             MN               nFA\
    \            oFA              aFA\n              |                |   L2-ST ~~~>\
    \ |                |\n              |                |              |        \
    \        |\n              |                |<-------------|                |\n\
    \              |                |       HTT    |                |\n          \
    \    |                |------------->|                |\n              |     \
    \           |    HRply(s)  |                |\n              |               \
    \ |------------------------------>|\n              |                |   HRqst(t)\
    \   |                |\n              |                |<------------------------------|\n\
    \              |                |    HRply(t)  |                |\n          \
    \    |                |              |                |\n             ----------------------------------<~~~\
    \ L2-LD      |\n                                              |--------------->|\n\
    \                           L2 Handoff         |     HRqst(r)   |\n          \
    \                                    |                |\n                    \
    \                          |<---------------|\n                              \
    \                |     HRply(r)   |\n                                        \
    \      |                |\n             ----------------------------------<~~~\
    \ L2-LU      |\n              | MN's traffic   |              |              \
    \  |\n              |<-------------->|              |                |\n     \
    \       Figure 10 - Three-Party Source Trigger Handoff Timing\n             MN\
    \               nFA            oFA              aFA\n              |         \
    \       |              |                |\n              |                |<~~~\
    \ L2-TT    |                |\n              |                |------------->|\
    \                |\n              |                |    HRqst(t)  |          \
    \      |\n              |                |<-------------|                |\n \
    \             |                |    HTT       |                |\n           \
    \   |                |------------------------------>|\n              |      \
    \          |   HRqst(t)   |                |\n              |                |<------------------------------|\n\
    \              |                |    HRply(t)  |                |\n          \
    \    |                |              |                |\n             ----------------------------------<~~~\
    \ L2-LD      |\n                                              |--------------->|\n\
    \                           L2 Handoff         |     HRqst(r)   |\n          \
    \                                    |                |\n                    \
    \                          |<---------------|\n                              \
    \                |     HRply(r)   |\n                                        \
    \      |                |\n             ----------------------------------<~~~\
    \ L2-LU      |\n              | MN's traffic   |              |              \
    \  |\n              |<-------------->|              |                |\n     \
    \       Figure 11 - Three-Party Target Trigger Handoff Timing\n   Unlike two-party\
    \ handoff, the timing of BET establishment between aFA\n   and nFA cannot fully\
    \ depend on the availability of L2 trigger\n   information because aFA does not\
    \ receive an L2 trigger signaling L2\n   handoff.  The two timing extremes at\
    \ which aFA can place the BET with\n   nFA are:\n      1) At the earliest, aFA\
    \ MAY start tunneling packets using the BET\n         to nFA after sending the\
    \ HRply(t) to nFA in response to the\n         request for target-triggered handoff.\n\
    \      2) At the latest, aFA MAY start tunneling packets using the BET to\n  \
    \       nFA and tear down the BET with oFA when receiving the HRqst(r)\n     \
    \    from oFA indicating that the MN has disconnected.\n   In addition, aFA MAY\
    \ continue tunneling to oFA if 1) is selected,\n   until the HRqst(r) is received.\
    \  In this case, the result may be\n   duplicated packets at the MN because the\
    \ MN will receive packets\n   through oFA on the old L2 until it disconnects (L2-LD).\
    \  If 2) is\n   selected, the additional latency will add to the MN's L3 service\n\
    \   disruption period.  Of course, aFA can choose to place the BET\n   sometime\
    \ between 1) and 2) if reliable bounds are available on the\n   duration of time\
    \ between L2-ST/L2-TT and the MN's disconnection (L2-\n   LD).  The exact selection\
    \ of when to establish the BET is likely to\n   be influenced by network engineering\
    \ and implementation\n   considerations, including whether a handoff smoothing\
    \ solution is\n   used, and is beyond the scope of this specification.\n"
- title: 4.3.  Renewal or Termination of Tunneling Service
  contents:
  - "4.3.  Renewal or Termination of Tunneling Service\n   To prevent a BET from expiring\
    \ when its lifetime runs out, the MN's\n   current FA signals the aFA to either\
    \ renew or terminate the BET.\n   This may be the case when the MN defers Mobile\
    \ IPv4 Registration.  If\n   no such signal is received, the aFA will terminate\
    \ the BET when the\n   lifetime expires.  In addition, the current FA or aFA may\
    \ need to\n   terminate the BET prior to the lifetime expiring.  In order to avoid\n\
    \   error conditions in which tunnels do not expire even though the MN to\n  \
    \ which they apply is no longer reachable, FAs SHOULD set the tunnel\n   lifetime\
    \ field to some value other that 0xffff, which indicates \"good\n   until canceled\"\
    .\n   Figure 12 illustrates the message exchange that occurs between the FA\n\
    \   needing to terminate or extend the tunnel (designated FA(1) in the\n   figure)\
    \ and the other FA (designated FA(2) in the figure).  The\n   HRqst(r)/HRply(r)\
    \ is indicated by setting the R bit in the\n   HRqst/HRply messages.  If the HRqst(r)\
    \ is renewing a BET, then it\n   contains a non-zero lifetime; otherwise, if the\
    \ lifetime is set to\n   zero, it indicates tunnel termination.  The aFA has complete\
    \ control\n   over whether a tunnel is extended or terminated, and it MAY reply\
    \ to\n   a request for extension with a shorter lifetime than was requested.\n\
    \                               HRqst(r)\n                      +------+ <--------\
    \  +------+\n                      | FA(2)| ---------> | FA(1)|\n            \
    \          +------+ HRply(r)   +------+\n                Figure 12 - BET Renewal\
    \ or Termination\n"
- title: 4.4.  When Will the MN Perform a Mobile IPv4 Registration?
  contents:
  - "4.4.  When Will the MN Perform a Mobile IPv4 Registration?\n   The MN/FA have\
    \ control over when to perform the Mobile IPv4\n   Registration.  Although the\
    \ MN/FA may decide to defer Mobile IPv4\n   Registration for a certain period,\
    \ three possible events can lead to\n   the need to terminate tunneling service.\
    \  If this occurs, the MN MUST\n   perform the Mobile IPv4 Registration.  These\
    \ events are:\n      1) The end of life for the BET is pending and a request by\
    \ the\n         current FA to aFA for renewal has been denied, or alternatively\n\
    \         the current FA or aFA needs to terminate the BET prematurely.\n    \
    \     The FA in this case MUST initiate the Mobile IPv4 Registration\n       \
    \  by sending an Agent Advertisement to the MN as in [1].\n      2) The MN itself\
    \ decides to perform a Mobile IPv4 Registration and\n         initiates it by\
    \ sending an Agent Solicitation as in [1].\n      3) During a source-triggered\
    \ handoff, the oFA attempts to perform\n         BET handoff but nFA is not capable\
    \ of performing it.  The FA in\n         this case MUST initiate the Mobile IPv4\
    \ Registration by sending\n         the MN an Agent Advertisement as in [1]. \
    \ Note that this\n         situation will never arise during target-triggered\
    \ handoff\n         because an HRqst(t) will not be sent to oFA by an nFA that\n\
    \         doesn't support POST-REGISTRATION.\n   Some detailed scenarios relating\
    \ to case 2) will be described\n   hereafter.  According to [1], when using an\
    \ FA care-of address, the\n   MN MAY use the FA as its default router.  Otherwise,\
    \ it MUST choose\n   its default router from those advertised in the ICMP Router\n\
    \   Advertisement portion of the Agent Advertisement.  Here we assume\n   that\
    \ the FA router is also the MN's default router.  In POST-\n   REGISTRATION, when\
    \ a tunnel is established between oFA and nFA and\n   the MN has moved to nFA,\
    \ the oFA MUST NOT send Agent Advertisements\n   to the MN.  In this case, it\
    \ is possible that the MN will not receive\n   Agent Advertisements for extended\
    \ periods of time.  According to [8],\n   hosts will remove default router entries\
    \ if the lifetime of the\n   Router Advertisement expires and no further advertisements\
    \ are\n   received.  Note that the ICMP Router Advertisement lifetime is not\n\
    \   related to the Registration Lifetime in the Mobility Agent\n   Advertisement\
    \ extension [1].  To avoid this disruption, the MN MUST\n   solicit the default\
    \ router (i.e., FA) before the lifetime of its\n   active default router entry\
    \ runs out, or alternatively, the FA MUST\n   advertise as soon as the MN-nFA\
    \ link is up (L2-LU).  This effectively\n   means that the MN will at most be\
    \ able to defer Mobile IPv4\n   Registration for as long as the remaining lifetime\
    \ of the active\n   default router, as configured in the ICMP Router Advertisements.\
    \  The\n   MN MUST perform a Mobile IPv4 Registration [1] when it receives an\n\
    \   Agent Advertisement following a POST-REGISTRATION handoff.\n"
- title: 4.5.  Handoff Request (HRqst) Message Format
  contents:
  - "4.5.  Handoff Request (HRqst) Message Format\n   This is a new Mobile IPv4 message\
    \ carried on UDP (destination port\n   434) [1].  The UDP header is followed by\
    \ the fields below.\n    0                   1                   2           \
    \        3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  \
    \ |     Type      |H|N|R|M|G|T|B|            Reserved             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Lifetime           |          Reserved             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                        MN Home Address                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          HA Address                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                       Identification                        +\n   |        \
    \                                                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | Extensions ...\n   +-+-+-+-+-+-+-+-\n      Type              16 (Handoff\
    \ Request)\n      H                 Source-triggered handoff request.  When set\
    \ and\n                        the N bit is unset, indicates that the request\n\
    \                        was the result of an L2-ST at oFA.\n      N         \
    \        Target triggered handoff request.  When set and\n                   \
    \     the H bit is unset, indicates that the request\n                       \
    \ was the result of an L2-TT at nFA.\n      R                 Set if the request\
    \ is an HRqst(r) (i.e., a\n                        request to renew the tunnel,\
    \ H and N bits must\n                        be unset).\n      M             \
    \    The FA issuing the HRqst will use Minimal\n                        Encapsulation\
    \ as defined in [1,5] for the\n                        tunnel.\n      G      \
    \           The FA issuing the HRqst will use Generic\n                      \
    \  Routing Encapsulation (GRE) [4] as defined in\n                        [1,5]\
    \ for the tunnel.  Extensions of HRqst\n                        containing GRE\
    \ type and key Fields are outside\n                        the scope of this document.\n\
    \      T                 For an HRqst(s), indicates that the oFA is\n        \
    \                willing to support both forward and reverse\n               \
    \         tunnel service.  For an HRqst(t), indicates that\n                 \
    \       the nFA is requesting reverse tunnel service.\n      B               \
    \  When sent in an HRqst(s), indicates that the MN\n                        has\
    \ requested a reverse tunnel to the HA and\n                        that the nFA\
    \ SHOULD use a reverse tunnel to the\n                        HA if it will not\
    \ be reverse tunneling to the\n                        oFA.\n      Lifetime  \
    \        The lifetime of the tunnel in seconds.  If this\n                   \
    \     is an HRqst(t), then the lifetime represents a\n                       \
    \ request by nFA for a reverse tunnel.  If this is\n                        an\
    \ HRqst(s), then the lifetime represents the\n                        maximum\
    \ amount of time that oFA is willing to\n                        maintain both\
    \ forward and reverse tunnels.  If\n                        this is an HRqst(r),\
    \ then the lifetime\n                        represents a request for the amount\
    \ of time to\n                        renew the tunnel's lifetime.  A value of\
    \ 0 on an\n                        HRqst(s) indicates that the oFA is unwilling\
    \ to\n                        grant tunnel service.  A value of 0 on an\n    \
    \                    HRqst(t) indicates that the nFA does not require\n      \
    \                  reverse tunnel service.  A value of 0 on an\n             \
    \           HRqst(r) indicates that the tunnel should be\n                   \
    \     terminated.  A value of 0xffff indicates\n                        infinity.\n\
    \      MN Home Address   For HRqst(s), the home address of the MN.\n      HA Addr\
    \           For HRqst(s), the HA address of the mobile node.\n      Identification\
    \    As defined in [1].\n      Extensions        The message MUST include an LLA\
    \ (see Section 9)\n                        containing the MN's L2 address and\
    \ an L2 address\n                        that can be mapped to an IPv4 address\
    \ for the\n                        FA.  This message MUST contain the FA-FA\n\
    \                        Authentication Extension [11] that is used to\n     \
    \                   secure the HRqst message.\n"
- title: 4.6.  Handoff Reply (HRply) Message Format
  contents:
  - "4.6.  Handoff Reply (HRply) Message Format\n   This is a new Mobile IPv4 message\
    \ carried on UDP (destination port\n   434) [1].  The UDP header is followed by\
    \ the fields below.\n    0                   1                   2           \
    \        3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  \
    \ |     Type      |H|N|R|M|G|T|B|    Reserved     |    Code       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Lifetime             |         Reserved              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                        MN Home Address                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          HA Address                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                       Identification                        +\n   |        \
    \                                                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | Extensions ...\n   +-+-+-+-+-+-+-+-\n      Type              17 (Handoff\
    \ Reply)\n      Code              A value indicating the result of the Handoff\n\
    \                        Request.  Only two codes are currently\n            \
    \            supported, 0, indicating success, and 1,\n                      \
    \  indicating that the handoff cannot be performed.\n                        The\
    \ remaining values are for future use.\n      Lifetime          The lifetime,\
    \ in seconds, for which the\n                        bidirectional tunnel for\
    \ the MN will be\n                        maintained.  If this is an HRply(s),\
    \ then the\n                        lifetime represents a request by nFA, and\
    \ it can\n                        be any value up to the maximum value sent in\
    \ the\n                        HRqst(s).  Larger values are assumed to default\n\
    \                        to oFA's maximum.  If this is an HRply(t), then\n   \
    \                     the lifetime represents the maximum amount of\n        \
    \                time that the oFA will grant to the nFA.  If\n              \
    \          this is an HRply(r), then the lifetime\n                        represents\
    \ the amount of time by which the\n                        tunnel life will be\
    \ extended.  If the Code field\n                        indicates that handoff\
    \ failed, the Lifetime\n                        field will be ignored and SHOULD\
    \ be set to zero.\n                        A value of 0 on an HRply(t) indicates\
    \ that the\n                        oFA is unwilling to grant service.  A value\
    \ of 0\n                        on an HRply(s) indicates that the nFA does not\n\
    \                        require service.  A value of 0 on an HRply(r)\n     \
    \                   indicates that the tunnel lifetime will be\n             \
    \           terminated.  A value of 0xffff indicates an\n                    \
    \    infinite lifetime.\n      H                 Source-triggered handoff reply.\
    \  When set and\n                        the N bit is unset, indicates that the\
    \ reply is\n                        in response to an HRqst(s).\n      N     \
    \            Target-triggered handoff reply.  When set and\n                 \
    \       the H bit is unset, indicates that the reply is\n                    \
    \    in response to an HRqst(t).\n      R                 Set if the reply is\
    \ an HRply(r).  Neither the H\n                        nor the N bit are set.\n\
    \      M                 The FA issuing the HRqst will use Minimal\n         \
    \               Encapsulation as defined in [1,5] for the\n                  \
    \      tunnel.\n      G                 The FA issuing the HRqst will use GRE\
    \ [4]\n                        Encapsulation as defined in [1,5] for the\n   \
    \                     tunnel.  When this flag bit is set, the HRply\n        \
    \                may require extensions containing the GRE type\n            \
    \            and key fields, but they are outside the scope\n                \
    \        of this document.\n      T                 For an HRply(s), indicates\
    \ that the nFA is\n                        requesting to reverse tunnel service.\
    \  For an\n                        HRply(t), indicates that the oFA is willing\
    \ to\n                        provide both forward and reverse tunnel service.\n\
    \      B                 When sent in an HRply(t), indicates that the MN\n   \
    \                     has requested a reverse tunnel to the HA and\n         \
    \               that the nFA SHOULD use a reverse tunnel to the\n            \
    \            HA if it will not be reverse tunneling to the\n                 \
    \       oFA.  It can be set in HRply(t) only if the T\n                      \
    \  bit was unset in the corresponding HRqst(t).\n      MN Home Address   For HRply(t),\
    \ the home IPv4 address of the MN.\n      HA Addr           For HRply(t), the\
    \ HA IPv4 address of the MN.\n      Identification    As defined in [1].\n   \
    \   Extensions        This Message MUST contain the FA-FA\n                  \
    \      Authentication Extension [11] that is used to\n                       \
    \ secure the HRply message.\n"
- title: 4.7.  Handoff to Third (HTT) Message Format
  contents:
  - "4.7.  Handoff to Third (HTT) Message Format\n   The Handoff to Third message\
    \ has the same format as the Handoff\n   Request and Handoff Reply messages, except\
    \ both the H and N bits are\n   set.  If the HTT message is in response to an\
    \ L2-ST and is sent to\n   initiate a handoff, then, with the exception of the\
    \ H and N bits, the\n   message has the same fields set and includes the same\
    \ extensions as\n   an HRqst(s).  If the HTT message is sent in response to an\
    \ HRqst(t),\n   then, with the exception of the H and N bits, the message has\
    \ the\n   same fields set and includes the same extensions as an HRply(t).  The\n\
    \   tunnel bits MUST NOT be set in the HTT message because BET\n   construction\
    \ is not negotiated between oFA and nFA; it is negotiated\n   between nFA and\
    \ aFA in the ensuing HRqst(t)/HRply(t).\n   In addition, the HTT MUST contain\
    \ the following extensions in the\n   specified order:\n      Solicited IPv4 Address\
    \ Option: containing aFA's Address\n      LLA Option: containing the L2 address\
    \ of the MN.\n"
- title: 4.8.  Applicability of POST-REGISTRATION Handoff Method
  contents:
  - "4.8.  Applicability of POST-REGISTRATION Handoff Method\n   The POST-REGISTRATION\
    \ handoff approach allows FAs to communicate\n   directly about a pending handoff,\
    \ and does not require any IPv4-layer\n   messages to be sent to or from an MN\
    \ prior to the L2 handoff event.\n   Therefore, it eliminates a possible source\
    \ of handoff latency.  This\n   may be required when the link layer imposes hard\
    \ deadlines on the\n   time at which a handoff must occur, such as when an MN\
    \ is rapidly\n   moving out of a radio coverage area.  Consequently, POST-REGISTRATION\n\
    \   is primarily of interest in handoff between FAs that support the same\n  \
    \ radio access technology.  Handoff between heterogeneous radio\n   technologies\
    \ will, of necessity, require interaction between the MN\n   and the network,\
    \ and so is not a domain of applicability for POST-\n   REGISTRATION.\n   Because\
    \ a POST-REGISTRATION handoff is triggered by an unspecified\n   mechanism that\
    \ informs the oFA or nFA that an L2 handoff is pending,\n   the POST-REGISTRATION\
    \ approach is only applicable to networks where\n   such a mechanism is available.\
    \  For example, an L2 may provide\n   indications of radio signal quality that\
    \ cause the oFA or nFA to send\n   the POST-REGISTRATION handoff messages.  Any\
    \ such indications must\n   also provide each FA involved in the handoff with\
    \ the identity of the\n   other, so that messages can be sent to the right place.\
    \  This may\n   involve mapping L2 information onto FA IPv4 addresses.  Also,\
    \ the FAs\n   involved in a handoff must have pre-provisioned security arrangements\n\
    \   so that the POST-REGISTRATION messages can be authenticated.  If a\n   handoff\
    \ is to be completed as a result of the POST-REGISTRATION\n   messaging, any L2\
    \ handoff indications must also be securely\n   authenticated so that traffic\
    \ to the old point of attachment is not\n   improperly halted.\n   POST-REGISTRATION\
    \ handoff is appropriate in the following cases:\n      - L2 triggers are available\
    \ on the network to indicate that L2\n        handoff is pending.\n      - Pre-provisioned\
    \ security mechanisms are in place to allow fast\n        and secure messaging\
    \ between the FAs and between the MN and an\n        FA.\n      - Access point\
    \ choice by the MN is not a concern or the choice\n        requires user intervention\
    \ and therefore is not on the critical\n        path for handoff.\n"
- title: 5.  Combined Handoff Method
  contents:
  - "5.  Combined Handoff Method\n   The combined method uses both PRE-REGISTRATION\
    \ and POST-REGISTRATION\n   handoff.  If PRE-REGISTRATION does not complete prior\
    \ to the\n   expiration of a timer on the nFA, the POST-REGISTRATION mechanism\
    \ is\n   used to create the tunnel between oFA and nFA.  This protects the MN\n\
    \   from delays caused by errors such as loss of the Mobile IPv4\n   Registration\
    \ Reply message involved in PRE-REGISTRATION for the\n   mobile-initiated and\
    \ network-initiated source-triggered cases.  It\n   also protects the MN from\
    \ delays caused by errors or the loss of any\n   of the Mobile IPv4 messages involved\
    \ in PRE-REGISTRATION for the\n   network-initiated target-triggered case.\n \
    \  When the nFA receives a target trigger, it will follow the PRE-\n   REGISTRATION\
    \ procedure.  When the combined method is used, the nFA\n   MUST also start a\
    \ timer when it receives a target trigger.  The timer\n   should be set to a small\
    \ value (default for target trigger case: 1\n   second).\n   According to PRE-REGISTRATION,\
    \ the nFA will receive the Registration\n   Request from the MN.  When the combined\
    \ method is used, this\n   Registration Request sent by the MN MUST contain the\
    \ IPv4 address of\n   the oFA in an FA IPv4 address LLA extension (see Section\
    \ 9.7).  This\n   same Registration Request message will contain multiple LLA\n\
    \   extensions, since it will also contain the MN's layer 2 address in an\n  \
    \ LLA extension as described for PRE-REGISTRATION (see Sections 3.7 and\n   9).\
    \  When the nFA has not started the handoff procedure using a\n   target trigger\
    \ (i.e., mobile-initiated or network-initiated target-\n   triggered cases), the\
    \ nFA MUST start a timer as soon as it receives\n   the low-latency Registration\
    \ Request from the MN.  This timer should\n   be set to a small value (default:\
    \ 1 second).\n   In all cases, the timer MUST be reset when the Registration Reply\n\
    \   message is received by nFA.  If the timer expires before the\n   Registration\
    \ Reply is received, the nFA MUST initiate the POST-\n   REGISTRATION procedure.\
    \  The nFA utilizes the oFA IPv4 address\n   (previously received in the extension\
    \ to the Registration Request\n   message) as the destination of the POST-REGISTRATION\
    \ HRqst message to\n   create the tunnel between nFA and oFA.  The nFA MAY tear\
    \ down this\n   tunnel when it receives and forwards a successful Registration\
    \ Reply\n   for that MN.\n"
- title: 6.  Layer 2 and Layer 3 Handoff Timing Considerations
  contents:
  - "6.  Layer 2 and Layer 3 Handoff Timing Considerations\n   In the optimal cases\
    \ considered in the PRE-REGISTRATION and POST-\n   REGISTRATION handoffs, it was\
    \ assumed that a timely L2 trigger would\n   be received in such a way that packets\
    \ could be delivered to the MN\n   via its nFA immediately upon connection.  In\
    \ this way, the MN does\n   not suffer disruption due to the L3 handoff.  However,\
    \ such precise\n   timing of the L2 trigger and handoff mechanism with respect\
    \ to the\n   actual L2 handoff event will not be possible in all wireless systems\n\
    \   and may depend on particular implementation techniques.  Therefore,\n   some\
    \ uncertainty may exist at L3 as to exactly when the L2 connection\n   between\
    \ the MN and the nFA becomes fully established and can be used\n   for L3 traffic.\
    \  It is possible that in certain implementations\n   traffic will be re-routed\
    \ too early or too late with respect to the\n   moment when the connection between\
    \ the MN and the nFA becomes fully\n   established.  The techniques that may solve\
    \ this problem and allow\n   the MN to receive traffic independently of the timing\
    \ of the L2\n   handoff event include buffering and simultaneous bindings (i.e.,\n\
    \   bicasting: setting the S bit [1] in Registration Requests).  However,\n  \
    \ these are optional and are not mandated.\n"
- title: 7.  Reverse Tunneling Support
  contents:
  - "7.  Reverse Tunneling Support\n   The handoff methods all support reverse tunneling.\
    \  The MN may\n   request reverse tunneling [3] by setting the T bit in its\n\
    \   Registration Request.  In the case of POST-REGISTRATION, if the MN\n   had\
    \ requested reverse tunneling previously at oFA, the handoff\n   message from\
    \ oFA (see Section 4) includes the T bit enabled to inform\n   nFA to establish\
    \ a BET for the visitor entry.  Typically, the T bit\n   will always be set to\
    \ ensure that any delays in the MN receiving its\n   new care-of address do not\
    \ result in any delay in uplink packet\n   transmission from the MN, but local\
    \ policies and particular L2\n   technologies may allow the reverse tunnel to\
    \ be turned off.\n"
- title: 8.  Handoff Signaling Failure Recovery
  contents:
  - "8.  Handoff Signaling Failure Recovery\n   In general and to a greater extent\
    \ in wireless networks, packets\n   carrying handoff signaling may be dropped\
    \ or lost due to errors on\n   the link.  In this section, we consider mechanisms\
    \ for recovery from\n   handoff signaling failures.\n"
- title: 8.1.  PRE-REGISTRATION Signaling Failure Recovery
  contents:
  - "8.1.  PRE-REGISTRATION Signaling Failure Recovery\n   Failure of PRE-REGISTRATION\
    \ signaling breaks down into three cases:\n      1) Loss of messages PrRtSol and\
    \ PrRtAdv on the air link.\n      2) Loss of the solicitation by an FA to obtain\
    \ another neighboring\n         FA's Advertisement or loss of the neighboring\
    \ FA's\n         advertisement.\n      3) Failure of the standard Mobile IPv4\
    \ Registration.\n   Of these, case 3) is handled by standard Mobile IPv4 mechanisms\n\
    \   described in [1].  Case 2) is expected to be a rare event because\n   spontaneous\
    \ packet drop rates on the fixed network are caused by\n   congestion or router\
    \ failure.  Since bit error rates on wireless\n   links are higher than on fixed\
    \ links, case 1) is more likely to\n   occur.  In the following subsections, cases\
    \ 1) and 2) are considered.\n"
- title: 8.1.1.  Failure of PrRtSol and PrRtAdv
  contents:
  - "8.1.1.  Failure of PrRtSol and PrRtAdv\n   PRE-REGISTRATION handoff can fail\
    \ in network-initiated handoff when\n   the PrRtAdv sent by oFA in response to\
    \ the source trigger (L2-ST) or\n   the advertisement sent by nFA in response\
    \ to the target trigger (L2-\n   TT) fails to reach the MN.  PRE-REGISTRATION\
    \ handoff can also fail in\n   mobile-initiated handoff when either the PrRtSol\
    \ sent from the MN or\n   return PrRtAdv sent from the oFA is dropped.  To reduce\
    \ the\n   probability that PrRtAdv and PrRtSol are lost, the MN and FA MAY\n \
    \  transmit multiple copies of these messages.  Should these messages\n   fail\
    \ anyway, in both cases the MN connects to the nFA without having\n   received\
    \ any prior signaling.  In this case, the MN solicits an FA\n   Advertisement\
    \ when it connects to nFA at L2 (L2-LU), as described in\n   Section 3.6, and\
    \ performs a standard Mobile IPv4 Registration with\n   the nFA as specified in\
    \ [1].\n"
- title: 8.1.2.  Failure of Inter-FA Solicitation and Advertisement
  contents:
  - "8.1.2.  Failure of Inter-FA Solicitation and Advertisement\n   The solicitation\
    \ from an FA to another neighboring FA may fail or the\n   corresponding advertisement\
    \ from the neighboring FA may be lost.  To\n   reduce the probability that these\
    \ messages are lost, the FAs MAY\n   transmit multiple copies of these messages.\
    \  If a failure occurs\n   anyway, the FA soliciting the Agent Advertisement is\
    \ unable to send a\n   PrRtAdv in response to a source trigger or to a mobile-initiated\n\
    \   PrRtSol.  In these cases, when the MN does not receive a notification\n  \
    \ or confirmation of a PRE-REGISTRATION handoff, the MN MUST perform a\n   standard\
    \ Mobile IPv4 Registration as soon as it connects to the nFA\n   (L2-LU) as described\
    \ in Section 8.1.1.\n"
- title: 8.2.  POST-REGISTRATION Signaling Failure Recovery
  contents:
  - "8.2.  POST-REGISTRATION Signaling Failure Recovery\n   Failure occurs in POST-REGISTRATION\
    \ when either the HRqst or HRply\n   message is dropped.  The effects of the failure\
    \ and the recovery\n   procedure depend on which message is dropped, and whether\
    \ the handoff\n   is source or target triggered.  Since all of the POST-REGISTRATION\n\
    \   signaling is going over the fixed network, it can be expected that\n   spontaneous\
    \ dropping of packets in the absence of congestion and\n   router failure should\
    \ be a relatively rare event.  Nevertheless,\n   failure recovery mechanisms SHOULD\
    \ be implemented.\n"
- title: 8.2.1.  HRqst Message Dropped
  contents:
  - "8.2.1.  HRqst Message Dropped\n   If the HRqst message is dropped, the effect\
    \ is the same for both\n   source- and target-triggered handoffs.  In either case,\
    \ the FA to\n   which the HRqst was destined will never respond with an HRply\n\
    \   message.  If the handoff is source triggered, then the nFA never\n   learns\
    \ of the handoff, and the oFA never receives confirmation.  If\n   the handoff\
    \ is target-triggered, then the oFA never learns of the\n   handoff, and the nFA\
    \ never receives confirmation.\n   The recovery procedure in this case is as follows:\
    \ the oFA MUST NOT\n   construct a forward tunnel when the MN moves off-link (L2-LD)\
    \ if the\n   handoff is source-triggered, and the nFA MUST NOT construct a reverse\n\
    \   tunnel if the handoff is target triggered.  If the nFA was not\n   informed\
    \ of the handoff by an HRqst message (corresponding to failure\n   of source-triggered\
    \ handoff) or if the handoff was not confirmed by\n   an HRply message (corresponding\
    \ to failure of target-triggered\n   handoff), the nFA MUST unicast an Agent Advertisement\
    \ to the MN as\n   soon as its L2 connection is established (L2-LU at nFA).\n"
- title: 8.2.2.  HRply Message Dropped
  contents:
  - "8.2.2.  HRply Message Dropped\n   If the HRply message is dropped, the FA sending\
    \ the HRply will assume\n   that the handoff has been confirmed, but the FA that\
    \ is expecting to\n   receive the HRply does not receive confirmation.  In this\
    \ case, the\n   failure recovery procedure is different for source-triggered and\n\
    \   target-triggered handoffs.\n   In a target-triggered handoff, the oFA assumes\
    \ that the handoff is\n   confirmed because it has sent the HRply, but the nFA\
    \ has not received\n   it so it does not have confirmation.  The oFA starts tunneling\n\
    \   packets to the nFA when the MN moves from its link (L2-LD).  The nFA\n   MUST\
    \ send an FA Advertisement to the MN as soon as its L2 link is up\n   (L2-LU at\
    \ nFA) and MAY drop the tunneled packets.  The nFA SHOULD\n   send an ICMP Destination\
    \ Unreachable [9] message to the oFA.  When\n   the oFA receives this message,\
    \ it will terminate the tunnel and stop\n   forwarding packets.  If reverse tunneling\
    \ was requested, the nFA MUST\n   NOT reverse tunnel because it has not received\
    \ handoff confirmation.\n   In source-triggered handoff, the nFA assumes that\
    \ the handoff is\n   confirmed because it has sent the HRply, but the oFA has\
    \ not received\n   it so it does not have confirmation.  Without failure recovery,\
    \ the\n   MN could move to the nFA without the oFA being able to start the\n \
    \  forward tunnel for the MN's packets, and the MN would not be able to\n   initiate\
    \ a Mobile IPv4 Registration because it does not know that the\n   handoff has\
    \ failed.  In this situation, the oFA MUST send out an\n   HRqst message to the\
    \ nFA with lifetime zero as soon as the MN leaves\n   its link (L2-LD).  The oFA\
    \ SHOULD continue to retransmit the HRqst\n   message, with exponential backoff\
    \ for CONFIG-HFAIL seconds or until\n   it receives an HRply acknowledging the\
    \ request to cancel the tunnel.\n   The default value for CONFIG-HFAIL is 10 seconds.\
    \  When the nFA\n   receives the HRqst, it MUST immediately send an Agent Advertisement\n\
    \   to the MN, as is the case whenever a tunnel is canceled.  In\n   addition,\
    \ the oFA MUST also drop any packets received through the\n   reverse tunnel from\
    \ the nFA.  The oFA SHOULD NOT send the ICMP\n   Destination Unreachable message\
    \ to the nFA because the nFA has been\n   informed by the HRqst message to cancel\
    \ the tunnel.  However, if the\n   nFA receives an ICMP Destination Unreachable\
    \ message for the tunnel\n   prior to receiving the HRqst canceling the tunnel,\
    \ it MUST send an FA\n   Advertisement to the MN and cancel the tunnel.\n"
- title: 9.  Generalized Link Layer and IPv4 Address (LLA) Extension
  contents:
  - "9.  Generalized Link Layer and IPv4 Address (LLA) Extension\n   This section\
    \ defines the Generalized Link Layer and IPv4 Address\n   (LLA) Extension, used\
    \ by any node that needs to communicate link\n   layer and IPv4 addresses.  The\
    \ format of the extension relies on\n   sub-types, where each sub-type defines\
    \ its own sub-structure.  This\n   document defines six sub-types.  Future RFCs\
    \ should allocate their\n   own sub-type and define their own address formats.\n\
    \       0                   1                   2                   3\n      \
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Sub-Type    |    LLA ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Type\n        138 (skippable) [1]  - when used in Registration Requests\n\
    \        140 (skippable) [1]  - when used in Agent Advertisements\n      Length\n\
    \        The length of the Link Layer Address + the one-octet Sub-Type\n     \
    \   field\n      Sub-Type\n        This field contains the Link Layer sub-type\
    \ identifier\n      LLA\n        Contains the Link Layer Address\n      In this\
    \ document, seven sub-types are defined:\n            1        3GPP2 International\
    \ Mobile Station Identity and\n                     Connection ID [13]\n     \
    \       2        3GPP International Mobile Subscriber Identity [15]\n        \
    \    3        Ethernet 48-bit MAC address [5]\n            4        64-bit Global\
    \ ID, EUI-64 [6]\n            5        Solicited IPv4 Address\n            6 \
    \       Access Point Identifier\n            7        FA IPv4 Address\n   The\
    \ following subsections describe the extensions.\n"
- title: 9.1.  3GPP2 IMSI Link Layer Address and Connection ID Extension
  contents:
  - "9.1.  3GPP2 IMSI Link Layer Address and Connection ID Extension\n   The IMSI\
    \ Link Layer Address Extension contains the International\n   Mobile Station Identity\
    \ (IMSI).\n       0                   1                   2                  \
    \ 3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |     Type      |   Length      |   Sub-Type    |    IMSI ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Type\n            1 (skippable) [1]\n         Length\n            The\
    \ length of the IMSI field + the one-octet Sub-Type field\n         Sub-Type\n\
    \            1\n         IMSI\n            Contains the IMSI, in the form:\n \
    \                      <IMSI>:<Connection Id>\n            Where the <IMSI> is\
    \ an ASCII-based representation of the\n            International Mobile Station\
    \ Identity, most significant\n            digit first, \":\" is ASCII 0x3a, and\
    \ the Connection ID is the\n            ASCII representation of a small, decimal\
    \ number used for\n            distinguishing different link-layer connections\
    \ from the\n            same mobile device.\n"
- title: 9.2.  3GPP IMSI Link Layer Address Extension
  contents:
  - "9.2.  3GPP IMSI Link Layer Address Extension\n   The IMSI Link Layer Address\
    \ Extension contains the International\n   Mobile Station Identity.\n       0\
    \                   1                   2                   3\n       0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Sub-Type    |    IMSI ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Type\n            2 (skippable) [1]\n         Length\n            The\
    \ length of the IMSI field + the one-octet Sub-Type field\n         Sub-Type\n\
    \            2\n         IMSI\n            Contains the IMSI, a number composed\
    \ of 15 digits or less,\n            coded as described in [15].\n"
- title: 9.3.  Ethernet Link Layer Address Extension
  contents:
  - "9.3.  Ethernet Link Layer Address Extension\n   The Ethernet Link Layer Address\
    \ Extension contains the 48-bit\n   Ethernet MAC Address, as defined in [5].\n\
    \       0                   1                   2                   3\n      \
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Sub-Type    |    MAC ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Type\n            3 (skippable) [1]\n         Length\n            7\
    \ (includes the Sub-Type field)\n         Sub-Type\n            3\n         MAC\n\
    \            Contains the 48-bit Ethernet MAC Address.\n"
- title: 9.4.  IEEE 64-Bit Global Identifier (EUI-64) Address Extension
  contents:
  - "9.4.  IEEE 64-Bit Global Identifier (EUI-64) Address Extension\n   The 64-bit\
    \ Global Identifier (EUI-64) Address Extension contains the\n   64-bit address,\
    \ as defined in [6].\n       0                   1                   2       \
    \            3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Sub-Type    |    MAC ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Type\n            4 (skippable) [1]\n         Length\n            9\
    \ (includes the Sub-Type field)\n         Sub-Type\n            4\n         MAC\n\
    \            Contains the 64-bit Global Identifier Address.\n"
- title: 9.5.  Solicited IPv4 Address Extension
  contents:
  - "9.5.  Solicited IPv4 Address Extension\n   The 32-bit Solicited IPv4 Address\
    \ Extension contains the IPv4 address\n   of the agent (FA) being solicited. \
    \ This extension MAY be present in\n   an ICMP Agent Solicitation as explained\
    \ in Section 3.3.\n       0                   1                   2          \
    \         3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Sub-Type    |    IPv4 addr ...\n  \
    \    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     \
    \    Type\n            5 (skippable) [1]\n         Length\n            5 (includes\
    \ the Sub-Type field)\n         Sub-Type\n            5\n         IPv4 Address\n\
    \            Contains the 32-bit IPv4 Address of the solicited node.\n"
- title: 9.6.  Access Point Identifier Extension
  contents:
  - "9.6.  Access Point Identifier Extension\n   The 32-bit Access Point Identifier\
    \ Extension contains an identifier\n   of the access point to which the MN will\
    \ move.  This may be a\n   wireless L2 identifier.  The MN is able to solicit\
    \ an advertisement\n   from the FA servicing a certain access point by using this\
    \ extension\n   with Agent Solicitations as explained in Section 3.3.\n      \
    \ 0                   1                   2                   3\n       0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Sub-Type    |    AP ID...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Type\n            6 (skippable) [1]\n         Length\n            5\
    \ (includes the Sub-Type field)\n         Sub-Type\n            6\n         AP\
    \ ID\n            Contains the 32-bit Access Point Identifier.\n"
- title: 9.7.  FA IPv4 Address Extension
  contents:
  - "9.7.  FA IPv4 Address Extension\n   The 32-bit FA IPv4 Address Extension contains\
    \ the IPv4 address of the\n   agent (FA).  This extension MAY be present in a\
    \ Registration Request\n   message to identify the oFA as explained in Section\
    \ 5.\n       0                   1                   2                   3\n \
    \      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      | \
    \    Type      |   Length      |   Sub-Type    |    IPv4 addr ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Type\n            7 (skippable) [1]\n         Length\n            5\
    \ (includes the Sub-Type field)\n         Sub-Type\n            7\n         IPv4\
    \ Address\n            Contains the 32-bit IPv4 Address of the FA node.\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document defines one new extension to Mobile\
    \ IPv4 Control\n   messages and one new extension to Mobile IPv4 Router Discovery\n\
    \   messages already maintained by IANA.  This document also defines a\n   new\
    \ Mobile IPv4 Control message type to be used between FAs.  To\n   ensure correct\
    \ interoperation based on this specification, IANA must\n   reserve values in\
    \ the Mobile IPv4 number space for two new extensions\n   and one new message\
    \ type.  IANA must also manage the numbering spaces\n   created by the two new\
    \ extensions, the message type, and its\n   associated Code field.\n"
- title: 10.1.  New Extension Values
  contents:
  - "10.1.  New Extension Values\n   Section 9 introduces two extensions.\n   Generalized\
    \ Link Layer and IPv4 Address (LLA) Extension for Router\n   Discovery messages:\
    \ A new Mobile IPv4 extension that follows after\n   Mobile IPv4 ICMP Router Discovery\
    \ messages (e.g., Mobile IP Agent\n   Advertisements).  The type value of this\
    \ extension belongs to the\n   Mobile IPv4 number space for Router Discovery messages\
    \ maintained by\n   IANA.  The value assigned by IANA is 140.  This new extension\
    \ uses\n   the Link Layer and IPv4 Address Identifier (LLA) sub-type numbering\n\
    \   space that requires IANA management (see Section 10.2).\n   Generalized Link\
    \ Layer and IPv4 Address (LLA) Extension for Mobile IP\n   Control messages: A\
    \ new Mobile IPv4 extension appended to Mobile IP\n   Control messages (e.g.,\
    \ Registration Request).  The type value of\n   this extension belongs to the\
    \ Mobile IPv4 number space for extensions\n   to Mobile IPv4 Control messages\
    \ maintained by IANA.  It MUST be in\n   the skippable (128-255) range as defined\
    \ in [1].  The value assigned\n   is 138 by IANA.  This new extension uses the\
    \ Link Layer and IP\n   Address Identifier (LLA) sub-type numbering space that\
    \ requires IANA\n   management (see Section 10.2).\n"
- title: 10.2.  Generalized Link Layer and IP Address Identifier (LLA)
  contents:
  - "10.2.  Generalized Link Layer and IP Address Identifier (LLA)\n       Sub-type\
    \ Values\n   This section describes the sub-type values that are applicable to\n\
    \   both the Generalized LLA Extensions for Mobile IP Control and Router\n   Discovery\
    \ messages.  This specification makes use of the sub-type\n   values 1-7, and\
    \ all other values other than zero (reserved) are\n   available for assignment\
    \ via IETF consensus [14].  The seven sub-type\n   values defined in this specification\
    \ are:\n         1        3GPP2 International Mobile Station Identity and\n  \
    \                Connection ID [13]\n         2        3GPP International Mobile\
    \ Subscriber Identity [15]\n         3        Ethernet 48-bit MAC address [5]\n\
    \         4        64-bit Global ID, EUI-64 [6]\n         5        Solicited IPv4\
    \ Address\n         6        Access Point Identifier\n         7        FA IPv4\
    \ Address\n"
- title: 10.3.  New Message Type and Code
  contents:
  - "10.3.  New Message Type and Code\n   Sections 4.5 and 4.6 define two new Mobile\
    \ IPv4 message types:\n   Handoff Request and Handoff Reply.  These require two\
    \ type numbers to\n   be assigned by IANA from the Mobile IPv4 Control message\
    \ type address\n   space.  The Handoff Reply message also introduces its own Code\
    \ field\n   that requires IANA to manage a new Code address space.  This\n   specification\
    \ makes use of the Code values 0-1, where 0 identifies a\n   successful handoff\
    \ and 1 defines a generic handoff failure.  All\n   other values are available\
    \ for assignment via IETF consensus [14].\n   Code Values for Mobile IP Handoff\
    \ Reply Messages\n   0          Successful Handoff\n   1          Generic Handoff\
    \ Failure\n   2-255      Unallocated\n"
- title: 11.  Security Considerations
  contents:
  - "11.  Security Considerations\n   For the PRE-REGISTRATION method, as discussed\
    \ in Section 3.8, the oFA\n   and nFA MUST share a security association to authenticate\
    \ and\n   integrity protect messages transported between them.  In addition,\n\
    \   oFA must be authorized to solicit nFA based on the security\n   association.\
    \  The minimal requirement to establish a security\n   association between FAs\
    \ is that both FAs support manual pre-\n   configuration of security associations\
    \ involving shared keys.  Other\n   mechanisms to establish security associations\
    \ using IKE [16] based on\n   shared secrets or public keys may also be used.\
    \  The inter-FA ICMP\n   messages (solicitations and advertisements) MUST be authenticated\
    \ and\n   integrity protected using ESP [10].  The default ESP authentication\n\
    \   algorithm for use in this specification is HMAC-SHA1-96 [12].  The\n   absence\
    \ of this security would allow denial-of-service attacks from\n   malicious nodes\
    \ at any distance from the FA.  To secure Registration\n   Request and Reply messages,\
    \ PRE-REGISTRATION uses the security\n   mechanisms already described in [1] and\
    \ optionally [11].\n   POST-REGISTRATION introduces a new change to Mobile IPv4,\
    \ which is\n   the possibility that an MN may receive packets from an FA with\
    \ which\n   it has not yet performed a Mobile IPv4 Registration.  It is not\n\
    \   recommended that the MN drop packets from unknown FAs since it would\n   effectively\
    \ eliminate the advantages of POST-REGISTRATION.  From a\n   security viewpoint,\
    \ dropping packets from unknown FAs would not\n   provide significant protection\
    \ for an MN from any attack.  This is\n   because any malicious host may use the\
    \ MN's home address to send\n   packets to the MN through its current known FA;\
    \ therefore, processing\n   packets received from unknown FAs would not provide\
    \ worse security\n   than with normal Mobile IPv4.\n   In a similar way to PRE-REGISTRATION,\
    \ in POST-REGISTRATION, oFA and\n   nFA MUST share a security association required\
    \ to protect the Handoff\n   Request and Reply messages.  The minimal requirement\
    \ to establish a\n   security association between FAs is that the FAs support\
    \ manual pre-\n   configuration of security associations involving shared keys.\
    \  Other\n   mechanisms to establish security associations using IKE [16] based\
    \ on\n   shared secrets or public keys may also be used.  The Handoff Request\n\
    \   and Reply messages MUST be authenticated using the FA-FA\n   authentication\
    \ extension [11] that uses the default algorithm\n   specified in [7].  The absence\
    \ of this security would allow\n   impersonation attacks and denial-of-service\
    \ attacks.\n   The minimal requirement is that all FAs involved in low latency\n\
    \   handoffs MUST support manual pre-configuration of peer-to-peer\n   security\
    \ associations with neighboring FAs, involving shared secrets\n   and are already\
    \ required to support the default algorithms of [1].\n   Other mechanisms to establish\
    \ security associations using IKE [16]\n   based on shared or public keys may\
    \ also be used.\n   Since the techniques outlined in this document depend on particular\n\
    \   L2 information (triggers) to optimize performance, some level of L2\n   security\
    \ is assumed.  Both PRE- and POST-REGISTRATION techniques\n   depend on L2 triggers,\
    \ but the L2 security implications are different\n   for the two techniques.\n\
    \   In particular, in POST-REGISTRATION, the L2 triggers initiate the\n   establishment\
    \ of tunnels that route IPv4 packets for the MN to its\n   new location.  Therefore,\
    \ the L2 triggers MUST be secured against any\n   tampering by malicious nodes,\
    \ either mobile or within the wired\n   network.  The L2 addresses or IPv4 addresses\
    \ for the MN and the FAs\n   that appear in the L2 triggers MUST correspond to\
    \ the actual nodes\n   that are participating in the handoff.  If there is any\
    \ possibility\n   that tampering may occur, the recipient of an L2 trigger MUST\
    \ have\n   some way of authenticating the L2 information.  Wireless networks\n\
    \   that do not provide such features will be subject to impersonation\n   attacks,\
    \ where malicious nodes could cause FAs to believe that an MN\n   has moved to\
    \ other service areas or to allow a bogus MN to obtain\n   unauthorized service\
    \ from an FA prior to performing a Mobile IPv4\n   Registration.  In POST-REGISTRATION,\
    \ the L2 triggers would typically\n   be sent between a wireless base station\
    \ and the FA.  No standard\n   protocol exists at this time to communicate the\
    \ L2 trigger\n   information, but it is important that any future protocol used\
    \ for\n   this purpose provides adequate security.  If the wireless base\n   station\
    \ and FA were integrated, then this security threat would not\n   apply.  Also\
    \ the layer 2 control messages on the wireless link must\n   be secured appropriately\
    \ to prevent a malicious node from running\n   impersonation attacks and causing\
    \ unwanted L2 triggers to be\n   generated.  Integrity and replay protection would\
    \ be required to\n   avoid impersonation threats and resource consumption threats\
    \ where a\n   malicious node replays old messages to cause resource consumption.\n\
    \   This depends on the type of L2 security of the wireless link.  For\n   example,\
    \ in cellular technologies, the control messages are secured,\n   although the\
    \ type of security varies depending on the cellular\n   standard, but this is\
    \ not typically the case in WLAN IEEE 802.11\n   networks.\n   In PRE-REGISTRATION,\
    \ the security of L2 triggers has different\n   implications.  The PRE-REGISTRATION\
    \ technique depends on Mobile IPv4\n   security between MN and FA, so the same\
    \ security considerations in\n   [1] apply.  Should malicious nodes be able to\
    \ generate or modify L2\n   trigger information (i.e., L2-ST or L2-TT), this would\
    \ cause\n   advertisements to be sent to the MN.  They would consume wireless\n\
    \   resources and processing in the MN, but would not allow an\n   impersonation\
    \ attack.  In order to prevent such denial-of-service\n   attacks, there should\
    \ be a limit on the number of advertisements that\n   an FA (oFA) will relay to\
    \ the MN as a result of the reception of L2\n   triggers.  This number will depend\
    \ on the L2 technology, and the\n   default limit is 10 per second.\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   The authors want to thank Lennart Bang, Bryan Hartwell,\
    \ Joel\n   Hortelius, Gianluca Verin, and Jonathan Wood for valuable comments\n\
    \   and suggestions on the whole document.  The authors also thank the\n   Mobile\
    \ IPv4 WG chairs, Phil Roberts and Basavaraj Patil, for their\n   input.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [1]  Perkins, C., Ed., \"IP Mobility Support\
    \ for IPv4\", RFC 3344,\n        August 2002.\n   [2]  Bradner, S., \"Key words\
    \ for use in RFCs to Indicate Requirement\n        Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [3]  Montenegro, G., Ed., \"Reverse Tunneling for Mobile IP,\
    \ revised\",\n        RFC 3024, January 2001.\n   [4]  Farinacci, D., Li, T.,\
    \ Hanks, S., Meyer, D., and P. Traina,\n        \"Generic Routing Encapsulation\
    \ (GRE)\", RFC 2784, March 2000.\n   [5]  Plummer, D., \"Ethernet Address Resolution\
    \ Protocol: Or\n        Converting Network Protocol Addresses to 48.bit Ethernet\
    \ Address\n        for Transmission on Ethernet Hardware\", STD 37, RFC 826,\n\
    \        November 1982.\n   [6]  IEEE, \"Guidelines for 64-bit Global Identifier\
    \ (EUI-64)\n        Registration Authority\",\n        http://standards.ieee.org/regauth/oui/tutorials/EUI64.html,\n\
    \        March 1997.\n   [7]  Perkins, C., Calhoun, P., and J. Bharatia, \"Mobile\
    \ IPv4\n        Challenge/Response Extensions (Revised)\", RFC 4721, January\n\
    \        2007.\n   [8]  Deering, S., Ed., \"ICMP Router Discovery Messages\",\
    \ RFC 1256,\n        September 1991.\n   [9]  Postel, J., \"Internet Control Message\
    \ Protocol\", STD 5, RFC 792,\n        September 1981.\n   [10] Kent, S., \"IP\
    \ Encapsulating Security Payload (ESP)\", RFC 4303,\n        December 2005.\n\
    \   [11] Fogelstroem, E., Jonsson, A., and C. Perkins, \"Mobile IPv4\n       \
    \ Regional Registration\", RFC 4857, June 2007.\n   [12] Madson, C. and R. Glenn,\
    \ \"The Use of HMAC-SHA-1-96 within ESP\n        and AH\", RFC 2404, November\
    \ 1998.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [13] TIA/EIA/IS-2000.\n   [14] Narten, T. and\
    \ H. Alvestrand, \"Guidelines for Writing an IANA\n        Considerations Section\
    \ in RFCs\", BCP 26, RFC 2434, October 1998.\n   [15] 3GPP TS 23.003 (www.3gpp.org).\n\
    \   [16] Kaufman, C., Ed., \"Internet Key Exchange (IKEv2) Protocol\", RFC\n \
    \       4306, December 2005.\n"
- title: Appendix A - Gateway Foreign Agents
  contents:
  - "Appendix A - Gateway Foreign Agents\n   The Mobile IPv4 Regional Registration\
    \ specification [11] introduces\n   the Gateway Foreign Agent (GFA), as a mobility\
    \ agent that two FAs\n   providing service to an MN have in common.  Figure A.1\
    \ provides an\n   example of an MN's initial registration through the GFA.  If\
    \ this is\n   the first registration message, the message MUST be forwarded to\
    \ the\n   HA.  All packets sent to the MN will be delivered to the GFA, which\n\
    \   in turn will forward the packets to the FA servicing the MN.\n           \
    \     RegReq    +-----+   RegReq\n             +----------->| oFA |--------------+\n\
    \             |            +-----+              |\n             |            \
    \                     v\n          +----+                            +-----+ RegReq\
    \  +----+\n          | MN |                            | GFA |<------->| HA |\n\
    \          +----+                            +-----+         +----+\n        \
    \                   +-----+\n                           | nFA |\n            \
    \               +-----+\n            Figure A.1 - Initial Registrations through\
    \ GFA\n   If the MN moves to an nFA that is serviced by a GFA common with oFA,\n\
    \   the MN MAY issue a Regional Registration Request (see Figure A.2).\n   The\
    \ Regional Registration message does not need to be forwarded to\n   the HA, since\
    \ the MN's traffic can still be delivered to the same\n   GFA.  This optimized\
    \ approach effectively reduces the latency\n   involved in the registration process.\n\
    \                           +-----+\n                           | oFA |\n    \
    \                       +-----+\n          +----+                            +-----+\
    \         +----+\n          | MN |                            | GFA |        \
    \ | HA |\n          +----+                            +-----+         +----+\n\
    \             |                                 ^\n             |            \
    \ +-----+             |\n             +------------>| nFA |-------------+\n  \
    \             RegRegReq   +-----+  RegRegReq\n           Figure A.2 - Regional\
    \ Registration through GFA\n   Note that the GFA may also be the MN's first-hop\
    \ router.\n"
- title: Appendix B - Low-Latency Handoffs for Multiple-Interface MNs
  contents:
  - "Appendix B - Low-Latency Handoffs for Multiple-Interface MNs\n   For MNs that\
    \ have two wireless network interfaces, either on the same\n   wireless network\
    \ or on wireless networks having different wireless L2\n   technologies, the techniques\
    \ discussed in this document may be\n   unnecessary if the Mobile IPv4 stack on\
    \ the MN allows switching an\n   IPv4 address binding between interfaces.  This\
    \ Appendix discusses how\n   multiple wireless interfaces can aid low-latency\
    \ handoff.\n            +------+        +---------+\n            |  HA  |--------|\
    \  (GFA)  |\n            +------+        +---------+\n                       \
    \       /     \\\n                           ...       ...\n                 \
    \           /         \\\n                           /           \\\n        \
    \               +------+      +------+\n                       | oFA  |      |\
    \ nFA  |\n                       +------+      +------+\n                    \
    \      |             |\n                       +------+      +------+\n      \
    \                 | RN1  |      | RN2  |\n                       +------+    \
    \  +------+\n                       +------+\n                       |  MN  |\
    \ --------->\n                       +------+\n                              \
    \  Movement\n        Figure B.1 - Network Model for Mobile IPv4 with Multi-Access\n\
    \   Figure B.1 illustrates the normal and hierarchical MIPv4 models.  As\n   shown\
    \ in the figure, assume that the MN is connected to Radio Network\n   1 (RN1)\
    \ and is registered with oFA through which it is receiving\n   traffic.  Suppose\
    \ MN enters the coverage area of RN2 and nFA and that\n   it prefers connectivity\
    \ to this network for reasons beyond the scope\n   of this document (e.g., user\
    \ preferences, cost, QoS available, etc.).\n   The MN activates the interface\
    \ to RN2 but continues communicating\n   through RN1.  The MN may solicit advertisements\
    \ from nFA through the\n   interface connected to RN1 to speed up the handoff\
    \ process, provided\n   there is no TTL restriction, or it can solicit advertisements\
    \ through\n   the interface connected to RN2 if it has been configured for IPv4\n\
    \   traffic.\n   Once the MN is registered with nFA and is successfully receiving\
    \ and\n   transmitting through the new network, it tears down the interface to\n\
    \   RN1.  If the MN has enough time to complete this procedure without\n   incurring\
    \ degraded service or disconnection, the MN would experience\n   a seamless multi-access\
    \ handoff, but it may not be possible in all\n   cases, due to network coverage\
    \ or for other reasons.  Should multiple\n   interface handoff be possible, then\
    \ the low-latency methods described\n   in this document are not necessary.\n\
    \   In order to support the possible failure of the connectivity with the\n  \
    \ new network (RN2/nFA) in the short period following handoff, the MN\n   may\
    \ use the S bit in its Mobile IPv4 Registration Request to maintain\n   simultaneous\
    \ bindings with both its existing (HA or GFA) binding with\n   oFA and a new binding\
    \ with nFA.\n"
- title: Appendix C - PRE-REGISTRATION Message Summary
  contents:
  - "Appendix C - PRE-REGISTRATION Message Summary\n   This appendix contains a quick\
    \ reference for IPv4 and layer 2\n   addresses to be used in PRE-REGISTRATION\
    \ messages.\n   Proxy Router Advertisement (PrRtAdv)\n   This is a standard Router/Agent\
    \ Advertisement [1] with the following\n   characteristics:\n      Source IPv4\
    \ Address: nFA IPv4 Address\n      Source Layer 2 Address: oFA L2 Address\n  \
    \    Destination IPv4 Address: MN IPv4 Address (from PrRtSol)\n      Destination\
    \ Layer 2 Address: MN L2 Address (from PrRtSol)\n      LLA Extension (defined\
    \ in this spec): containing nFA Layer 2\n      Address.\n   Proxy Router Solicitation\
    \ (PrRtSol)\n   This is a standard Router/Agent Solicitation [1] with the following\n\
    \   characteristics:\n      Source IPv4 Address: MN Address\n      Source Layer\
    \ 2 Address: MN Address\n      Destination IPv4 Address: oFA Address (from source\
    \ address of\n      previous Router Advertisement or PrRtAdv)\n      Destination\
    \ Layer 2 Address: oFA Address (from source address of\n      previous Router\
    \ Advertisement or PrRtAdv LLA)\n      LLA Extension (defined in this spec): depends\
    \ on the layer 2\n      technology (e.g., typically for WLAN, this would be the\
    \ BSSID of\n      the new WLAN Access Point)\n   Registration Request (as seen\
    \ on MN-oFA link)\n   This is a Mobile IPv4 Registration Request message [1] with\
    \ the\n   following characteristics:\n      Source IPv4 Address: MN Address\n\
    \      Source Layer 2 Address: MN Address\n      Destination IPv4 Address: nFA\
    \ Address (from source addr of\n      PrRtAdv)\n      Destination Layer 2 Address:\
    \ Default Router (i.e., oFA Address)\n      LLA Extension (defined in this spec):\
    \ containing the MN's L2\n      address that must be used by nFA.  This will typically\
    \ be an\n      Ethernet MAC address but other types can be used as specified in\n\
    \      Section 9 of this document.\n   Although this is not mandated, an MN implementation\
    \ may set the S bit\n   (see Section 6) in Registration Request messages to improve\
    \ the\n   handoff and avoid problems due to failed layer 2 handoffs and layer\
    \ 2\n   ping-pong effects between two base stations.\n   Registration Reply (as\
    \ seen on oFA-MN link)\n   This is a Mobile IPv4 Registration Reply message [1]\
    \ with the\n   following characteristics:\n      Source IPv4 Address: nFA Address\n\
    \      Source Layer 2 Address: oFA Address\n      Destination IPv4 Address: MN\
    \ Address (from source of Registration\n      Request)\n      Destination Layer\
    \ 2 Address: MN Address (from source of\n      Registration Request)\n"
- title: Contributing Authors
  contents:
  - "Contributing Authors\n   Pat Calhoun\n   Cisco Systems\n   EMail: pcalhoun@cisco.com\n\
    \   Tom Hiller\n   Lucent Technologies\n   EMail: tom.hiller@lucent.com\n   James\
    \ Kempf\n   NTT DoCoMo USA Labs\n   EMail: kempf@docomolabs-usa.com\n   Peter\
    \ J. McCann\n   Motorola Labs\n   EMail: pete.mccann@motorola.com\n   Ajoy Singh\n\
    \   Motorola\n   EMail: asingh1@email.mot.com\n   Hesham Soliman\n   Elevate Technologies\n\
    \   EMail: Hesham@elevatemobile.com\n   Sebastian Thalanany\n   US Cellular\n\
    \   EMail: Sebastian.thalanany@uscellular.com\n"
- title: Editor's Address
  contents:
  - "Editor's Address\n   Karim El Malki\n   Athonet\n   EMail: karim@athonet.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
