- contents:
  - "                 Encapsulation Methods for Transport of\n                Fibre
    Channel Traffic over MPLS Networks\n"
  title: __initial_text__
- contents:
  - "Abstract\n   A Fibre Channel pseudowire (PW) is used to carry Fibre Channel\n
    \  traffic over an MPLS network.  This enables service providers to take\n   advantage
    of MPLS to offer \"emulated\" Fibre Channel services.  This\n   document specifies
    the encapsulation of Fibre Channel traffic within\n   a pseudowire.  It also specifies
    the common procedures for using a PW\n   to provide a Fibre Channel service.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    5741.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6307.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n
    \     1.1. Transparency ...............................................3\n      1.2.
    Bandwidth Efficiency .......................................4\n      1.3. Reliability
    ................................................5\n      1.4. Conventions Used
    in This Document ..........................5\n   2. Reference Model .................................................6\n
    \  3. Encapsulation ...................................................8\n      3.1.
    The Control Word ..........................................10\n      3.2. MTU
    Requirements ..........................................11\n      3.3. Mapping
    of FC Traffic to PW Packets........................11\n           3.3.1. FC Data
    Frames (PT=0) and FC Login Frames (PT=1) ...11\n           3.3.2. FC Primitive
    Sequences and Primitive\n                  Signals (PT=2) .....................................12\n
    \          3.3.3. FC PW Control Frames (PT=6) ........................14\n      3.4.
    PW Failure Mapping ........................................15\n   4. Signaling
    of FC Pseudowires ....................................15\n   5. Timing Considerations
    ..........................................15\n   6. Security Considerations ........................................17\n
    \  7. Applicability Statement ........................................17\n   8.
    IANA Considerations ............................................18\n   9. Acknowledgments
    ................................................19\n   10. Normative References
    ..........................................19\n   11. Informative References ........................................20\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   Fibre Channel (FC) is a high-speed communications technology,
    used\n   primarily for Storage Area Networks (SANs).  Within a single site\n   (e.g.,
    data center), an FC-based SAN connects servers to storage\n   systems, and FC
    can be extended across sites.  When FC is extended\n   across multiple sites,
    the most common usage is storage replication\n   in support of recovery from disasters
    (e.g., flood or fire that takes\n   a site out of operation).  This is particularly
    the case over longer\n   distances where network latency results in unacceptable
    performance\n   for a server whose storage is not at the same site.  Fibre Channel
    is\n   standardized by the INternational Committee for Information\n   Technology
    Standards (INCITS) Technical Committee T11 [T11], and\n   multiple methods for
    encapsulating and transporting FC traffic over\n   other networks have been developed
    [FC-BB-6].\n   Fibre Channel Over TCP/IP (FCIP), as described in [RFC3821] and\n
    \  [FC-BB-6], interconnects otherwise isolated FC SANs over IP Networks.\n   FCIP
    uses FC Frame Encapsulation [RFC3643] to encapsulate FC frames\n   for tunneling
    over an IP-based network.  Since IP networks may drop\n   or reorder packets,
    FCIP relies on TCP to retransmit dropped frames\n   and restore the delivery order
    of reordered frames.  Due to possible\n   delay variation and TCP timeouts, special
    timing mechanisms are\n   required to ensure correct Fibre Channel operation over
    FCIP\n   [FC-BB-6].\n   MPLS networks can be provisioned and operated with very
    low loss\n   rates and very low probability of reordering, making it possible
    to\n   directly interconnect Fibre Channel ports over MPLS.  A Fibre Channel\n
    \  pseudowire (FC PW) is a method to transparently transport FC traffic\n   over
    an MPLS network resulting in behavior similar to a pair of FC\n   ports that are
    directly connected by a physical FC link.  The result\n   is simpler control processing
    in comparison to FCIP.\n   This document specifies the encapsulation of FC traffic
    into an MPLS\n   pseudowire and related PW procedures to transport FC traffic
    over\n   MPLS PWs.  The complete FC pseudowire specification consists of this\n
    \  document and the FC PW portion of the T11 [FC-BB-5/AM1] standard.\n   The following
    subsections describe some of the requirements for\n   transporting FC traffic
    over an MPLS network.\n"
  - contents:
    - "1.1.  Transparency\n   Transparent extension of an FC link is a key requirement
      for\n   transporting FC traffic over a PW.  This requires the FC PW to\n   emulate
      an FC link between two FC ports, similar to the approach\n   defined for FC
      over GFPT in [FC-BB-6].  GFPT is an Asynchronous\n   Transparent Generic Framing
      Procedure specified by ITU-T; see\n   [FC-BB-6] for details and reference to
      the ITU-T specifications.\n   This results in transparent forwarding of FC traffic
      over the MPLS\n   network from both the FC fabric and the network operator points
      of\n   view.\n   Transparency distinguishes the FC PW approach from FCIP.  An
      FC PW\n   logically connects the FC port on the FC link attached to one end
      of\n   the PW directly with the FC port on the far end of the FC link\n   attached
      to the other end of the PW, whereas FCIP introduces FC\n   B_Ports at both ends
      of the extended FC link; each FC B_Port is\n   connected to an FC E_Port in
      an FC switch on the same side of the\n   link extension.\n"
    title: 1.1.  Transparency
  - contents:
    - "1.2.  Bandwidth Efficiency\n   The bandwidth allocated to a PW may be less
      than the rate of the\n   attached FC port.  When there is no data exchange on
      a native FC\n   link, Idle Primitive Signals are continuously exchanged between
      the\n   two FC ports.  In order to improve the bandwidth efficiency across\n
      \  the MPLS network, it is necessary for the FC PW Provider Edge (PE) to\n   suppress
      (or drop) the Idle Primitive Signals generated by its\n   adjacent FC ports.
      \ The far-end FC PW PE regenerates Idle Primitive\n   Signals to send to its
      adjacent FC port as required; see\n   [FC-BB-5/AM1].\n   FC link control protocols
      require an FC port to continuously send the\n   same FC Primitive Sequence [FC-FS-2]
      until a reply is received or\n   some other event occurs.  To improve bandwidth
      efficiency, the FC PW\n   PE encapsulates a subset of repeated FC Primitive
      Sequences to send\n   across the WAN [FC-BB-5/AM1].  For example, in a sequence
      of\n   identical received primitives, only every fourth primitive may be\n   sent
      across the MPLS network.  Alternatively, a time-based approach\n   may be used
      to send a copy of the repeated FC Primitive Sequence once\n   every few milliseconds.
      \ The far-end FC PW PE regenerates the FC link\n   behavior by continuously
      sending the Primitive Sequence most recently\n   received from the WAN until
      a new primitive signal, primitive\n   sequence, or data frame is received from
      the WAN.\n   The sending FC PW PE may unilaterally choose any convenient subset\n
      \  for sending the same FC Primitive Sequence.  This is acceptable\n   because
      the receiving FC PW PE generates a continuous stream of the\n   most recently
      received FC Primitive Sequence on the outgoing native\n   FC link, independent
      of the arrival rate of that FC Primitive\n   Sequence from the WAN.  In practice,
      a 10:1 reduction in FC Primitive\n   Sequence transmission rate achieves 90%
      of the bandwidth benefits\n   without loss of FC functionality, and sending
      a copy every few\n   milliseconds does not pose a serious risk of exceeding
      the timeouts\n   specified in Section 5 below.\n   These bandwidth-efficiency
      techniques may cause changes in the FC\n   traffic that traverses an FC PW (e.g.,
      number of Idle Primitive\n   Signals or number of identical Primitive Sequences),
      but the far-end\n   FC PW PE's regeneration of FC link behavior on the attached
      FC port\n   is transparent to the FC ports connected to each PW PE.\n"
    title: 1.2.  Bandwidth Efficiency
  - contents:
    - "1.3.  Reliability\n   Fibre Channel does not employ a native frame retransmission
      protocol\n   and treats most frame delivery failures as errors.  FC SAN traffic\n
      \  requires a very low frame loss rate because the typical result of a\n   failure
      to deliver a frame is an I/O operation failure.  Recovery\n   from such I/O
      failures involves I/O operation retries after what may\n   be a significant
      delay (30-second and 60-second timeouts are common).\n   In addition, such retries
      are likely to be logged as errors\n   indicating possible problems with FC equipment
      or cables.  Hence,\n   drops, errors, and discards of FC frames must be very
      rare for an FC\n   PW.\n   FC SAN implementations have limited tolerance for
      frame reordering.\n   Any reordering affecting more than a few frames within
      a single\n   higher-level operation (e.g., a read or write I/O) is usually treated\n
      \  as an error by the destination FC port, resulting in discards of the\n   frames
      involved; some deployed FC implementations treat all such\n   within-operation
      frame reordering as errors that result in frame\n   discards.  As a result,
      FC frame reordering must be minimized for an\n   FC PW.\n   The FC PW does not
      compensate for frame drops, discards, or\n   reordering.  The MPLS network that
      hosts the FC PW is expected to be\n   designed and operated in a fashion that
      makes such events very rare.\n   In contrast to the Time to Live (TTL) field
      in an IP packet, FC uses\n   a constant delivery timeout value (R_A_TOV) for
      which 10 seconds is\n   the default.  Each FC frame must be delivered or discarded
      within\n   that timeout period after it is sent; see Section 5.\n"
    title: 1.3.  Reliability
  - contents:
    - "1.4.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST
      NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\",
      \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted
      as described in [RFC2119].\n"
    title: 1.4.  Conventions Used in This Document
  title: 1.  Introduction
- contents:
  - "2.  Reference Model\n   An FC PW extends a native FC link over an MPLS network.
    \ This\n   document specifies the PW encapsulation for FC.  Figure 1 describes\n
    \  the reference models (derived from [RFC3985]) that support the FC PW.\n   FC
    traffic is received by PE1's FC attachment channel, encapsulated\n   at PE1, transported
    across MPLS network, decapsulated at PE2, and\n   transmitted onward via the PE2's
    FC attachment channel.  This\n   document assumes that a pseudowire can be provisioned
    statically or\n   via a signaling protocol as defined in [RFC4447].\n           |<--------------
    Emulated Service ----------------->|\n           |                                                   |\n
    \          |          |<------- Pseudowire -------->|          |\n           |
    \         |                             |          |\n           |          |
    \   |<-- MPLS Tunnel -->|    |          |\n           |          V    V                   V
    \   V          |\n           V   AC     +----+                   +----+    AC
    \   V\n     +-----+    |     | PE1|===================| PE2|     |    +-----+\n
    \    |     |----------|............PW1..............|----------|     |\n     |
    CE1 |    |     |    |                   |    |     |    | CE2 |\n     |     |----------|............PW2..............|----------|
    \    |\n     +-----+  ^ |     |    |===================|    |     | ^  +-----+\n
    \          ^  |       +----+                   +----+     | |  ^\n           |
    \ |   Provider Edge 1          Provider Edge 2  |  |\n           |  |                                             |
    \ |\n     Customer |                                             | Customer\n
    \    Edge 1   |                                             | Edge 2\n              |
    \                                            |\n              |                                             |\n
    \      Native FC service                             Native FC service\n           Figure
    1 - PWE3 FC Interface Reference Configuration\n   The following reference model
    describes the termination point of each\n   end of the PW within the PE:\n               +-----------------------------------+\n
    \              |                PE                 |\n       +---+   +-+  +-----+
    \ +------+  +------+  +-+\n       |   |   |P|  |     |  |PW ter|  | MPLS |  |P|\n
    \      |   |<==|h|<=| NSP |<=|minati|<=|Tunnel|<=|h|<== From network\n       |
    \  |   |y|  |     |  |on    |  |      |  |y|\n       | C |   +-+  +-----+  +------+
    \ +------+  +-+\n       | E |   |                                   |\n       |
    \  |   +-+  +-----+  +------+  +------+  +-+\n       |   |   |P|  |     |  |PW
    ter|  | MPLS |  |P|\n       |   |==>|h|=>| NSP |=>|minati|=>|Tunnel|=>|h|==> To
    network\n       |   |   |y|  |     |  |on    |  |      |  |y|\n       +---+   +-+
    \ +-----+  +------+  +------+  +-+\n               |                                   |\n
    \              +-----------------------------------+\n               Figure 2
    - PW Reference Diagram\n   The Native Service Processing (NSP) function includes
    the following\n   functionality:\n   o  Idle Suppression: any FC Idle Primitive
    Signals received from the\n      source PE's attached FC port are suppressed and
    regenerated at the\n      destination PE to send on its attached FC port when
    there is no\n      other FC traffic to send;\n   o  FC Primitive Sequence Reduction:
    a subset of repetitive FC\n      Primitive Sequences received from the attached
    FC port at the\n      source PE is selected for WAN transmission, with the destination\n
    \     PE sending the FC Primitive Sequence most recently received from\n      the
    WAN on the destination PE's attached FC port continuously\n      until a new packet
    is received from the WAN; and\n   o  Flow Control: the Alternate Simple Flow Control
    (ASFC) protocol is\n      used for buffer management in concert with the peer
    PW PE's NSP\n      function so that FC traffic is not dropped.  ASFC is a simple\n
    \     pause/resume protocol that allows operation repetition; the\n      receiver
    responds to the first pause or resume operation in an\n      identical sequence
    of operations and ignores the rest of the\n      sequence.\n   The NSP flow control
    functionality is required to extend FC's credit-\n   based flow control to address
    situations where the number of buffer\n   credits available to an FC link is insufficient
    to utilize the\n   available bandwidth over the additional distance and latency\n
    \  represented by the FC pseudowire.  The NSPs avoid this problem by\n   inserting
    ASFC into FC's link flow control used on the attached FC\n   ports; see [FC-BB-5/AM1].\n
    \  In contrast, Idle Suppression and FC Primitive Sequence Reduction are\n   bandwidth
    optimizations that are included in the NSP for clarity in\n   this document.  Analogous
    optimizations are not treated as part of\n   the NSP by other pseudowires (e.g.,
    Asynchronous Transfer Mode (ATM)\n   idle frame suppression is not considered
    to be an NSP function by\n   [RFC4717]).\n   The NSP function is specified in
    detail by [FC-BB-5/AM1].\n"
  title: 2.  Reference Model
- contents:
  - "3.  Encapsulation\n   This specification provides port-to-port transport of FC-encapsulated\n
    \  traffic.  There are a number of port types defined by Fibre Channel,\n   including:\n
    \  o  N_port:  a port on the node (e.g., host or storage device) used\n      with
    both FC-P2P (Point to Point) or FC-SW (switched fabric)\n      topologies.  Also
    known as a Node port.\n   o  NL_port:  a port on the node used with an FC-AL (Arbitrated
    Loop)\n      topology.  Also known as a Node Loop port.\n   o  F_port:  a port
    on the switch that connects to a node point- to-\n      point (i.e., connects
    to an N_port).  Also known as a Fabric port.\n      An F_port is not loop capable.\n
    \  o  FL_port:  a port on the switch that connects to an FC-AL loop\n      (i.e.,
    to NL_ports).  Also known as a Fabric Loop port.\n   o  E_port:  a port used to
    connect two Fibre Channel switches.  Also\n      known as an Expansion port.  When
    E_ports between two switches are\n      connected to form a link, that link is
    referred to as an inter-\n      switch link (ISL).\n   Among the port types listed
    above, only the following FC connections\n   (as specified in [FC-BB-5/AM1]) are
    supported by an FC PW over MPLS:\n   o  N_Port to N_Port, established by an FC
    PLOGI (Port Login)\n      operation\n   o  N_Port to F_Port, established by an
    FC FLOGI (Fabric Login)\n      operation\n   o  E_Port to E_Port, established
    by an FC ELP (Exchange Link\n      Parameters) operation\n   FC traffic flowing
    over an FC PW is subdivided into four payload\n   types (PTs) that are encoded
    in the PW Control Word (see Section\n   3.1):\n   1.  FC login traffic (PT = 1):
    FC login operations and responses that\n       establish connections between FC
    ports.  The three FC login\n       operations are PLOGI, FLOGI, and ELP.  These
    operations and their\n       responses may require the NSP to allocate buffer
    resources.  See\n       the specification of Login Exchange Monitors in [FC-BB-5/AM1].\n
    \  2.  FC data traffic (PT = 0): All FC frames other than those involved\n       in
    an FC login operation.\n   3.  FC Primitive Sequences and Signals (PT = 2): Native
    FC link\n       control operations; 4-character primitive sequences and signals\n
    \      that are not encapsulated in FC frames.  See [FC-BB-5/AM1] and\n       [FC-FS-2].\n
    \  4.  FC PW Control (PT = 6): FC PW control operations exchanged only\n       between
    the endpoints of the PW.  FC PW control operations are\n       used for ASFC flow
    control, ping (e.g., for round-trip latency\n       measurement), and reporting
    native FC link errors.  See\n       [FC-BB-5/AM1].\n   This FC PW specification
    is limited to use with FC service classes 2,\n   3, and F; see [FC-FS-2].  Other
    FC service classes (e.g., 1, 4, and\n   6) MUST NOT be used with an FC PW.  Numbered
    FC service classes are\n   used for end-to-end FC traffic, whereas service class
    F is used for\n   inter-switch traffic in an FC switched fabric.\n   This FC PW
    specification is limited to native FC attachment links\n   that employ an 8b/10b
    transmission code (see [FC-FS-2]).  The\n   protocol specified in this document
    converts a received 10b code to\n   its 8b counterpart for PW encapsulation and
    hence does not support\n   attached FC links that use a 64b/66b transmission code
    (e.g., 10GFC\n   and 16GFC); such links MUST NOT be attached to an FC PW PE unless\n
    \  their link speed can be negotiated to one that uses 8b/10b encoding.\n   If
    an invalid 10b code that cannot be converted to an 8b code is\n   received from
    an FC link, the PE sends an FC PW control frame to\n   report the error (see [FC-BB-5/AM1]).\n"
  - contents:
    - "3.1.  The Control Word\n   The Generic PW Control Word, as defined in \"Pseudowire
      Emulation\n   Edge-to-Edge (PWE3) Control Word for Use over an MPLS PSN\" [RFC4385],\n
      \  MUST be used for FC PW to facilitate the transport of short packets\n   (by
      setting the Length field as detailed below) and convey the flag\n   bits defined
      below.  The structure of the Control Word for the FC PW\n   is as follows:\n
      \                          1                   2                   3\n       0
      1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \     |0 0 0 0| PT  |X|0 0|  Length   |     Sequence Number           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \                    Figure 3 - Control Word Structure\n   The first four bits
      of the PW Control Word MUST be set to 0 by the\n   ingress PE to indicate PW
      data.\n   Three of the four flag bits are used to convey the Payload Type (PT)\n
      \  indication.  The 3-bit binary value in this field identifies the\n   payload
      type carried by a PW packet.  The following types are\n   defined:\n            PT
      = 0: FC data frame.\n            PT = 1: FC login frame.\n            PT = 2:
      FC Primitive Sequence(s) and/or Primitive Signal(s).\n            PT = 6: FC
      PW control frame (refer to [FC-BB-5/AM1] for\n            usage).\n   Packets
      with other values in the PT field are not valid for the FC PW\n   and MUST be
      discarded by the receiving FC PW PE.\n   The X flag bit is not used by this
      version of the protocol.  It\n   SHOULD be set to zero by the sender and MUST
      be ignored by the\n   receiver.\n   The fragmentation bits (bits 8-9) are not
      used by the FC PW protocol.\n   These bits may be used in the future for FC-specific
      indications as\n   defined in [RFC4385].  The fragmentation bits SHOULD be set
      to zero\n   by the ingress PE and MUST be ignored by the egress PE.\n   The
      Length field enables recovery of the original pseudowire packet\n   when a short
      packet is padded to the minimum 64-octet packet size\n   required for Ethernet;
      see [RFC4385].  The Length field MUST be used\n   for packets shorter than 64
      octets, MUST be set to zero for longer\n   packets, and MUST be processed according
      to the rules specified in\n   [RFC4385].\n   The sequence number is not used
      for the FC PW; it MUST be set to 0 by\n   the ingress PE and MUST be ignored
      by the egress PE.\n"
    title: 3.1.  The Control Word
  - contents:
    - "3.2.  MTU Requirements\n   The MPLS network MUST be able to transport the largest
      Fibre Channel\n   frame after encapsulation, including the overhead associated
      with the\n   encapsulation.  The maximum FC frame size is 2164 octets without
      PW\n   and MPLS labels (refer to Figure 4); this maximum size is a constant\n
      \  value that is required for all FC implementations [FC-FS-2].  The\n   MPLS
      network SHOULD accommodate frames of up to 2500 octets in order\n   to support
      possible future increases in the maximum FC frame size.\n   Fragmentation, as
      described in [RFC4623], SHALL NOT be used for an FC\n   PW; therefore, the network
      MUST be configured with a minimum MTU that\n   is sufficient to transport the
      largest encapsulated FC frame.\n"
    title: 3.2.  MTU Requirements
  - contents:
    - "3.3.  Mapping of FC Traffic to PW Packets\n   FC frames, Primitive Sequences,
      and Primitive Signals are transported\n   over the PW.  All packet types are
      carried over a single PW.  In\n   addition to the PW Control Word, an FC Encapsulation
      Header is\n   included in the PW packet.  This FC Encapsulation Header is not
      used\n   in this version of the protocol; it SHOULD be set to zero by the\n
      \  sender and MUST be ignored by the receiver.\n"
    - contents:
      - "3.3.1.  FC Data Frames (PT=0) and FC Login Frames (PT=1)\n   FC data frames
        and FC login frames share a common encapsulation\n   format, except that the
        PT field in the FC PW Control Word is set to\n   0 for data frames and is
        set to 1 for login frames.  An FC login\n   frame contains an FC PLOGI, FLOGI,
        or ELP operation or response that\n   requires special processing by the NSP
        in support of flow control;\n   see [FC-BB-5/AM1].\n   Each FC data frame
        or login frame is mapped to a PW packet, including\n   the Start Of Frame
        (SOF) delimiter, frame header, Cyclic Redundancy\n   Check (CRC) field, and
        the End Of Frame (EOF) delimiter, as shown in\n   Figure 4.\n                           1
        \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +---------------------------------------------------------------+\n
        \     |                    FC PW Control Word                         |\n
        \     +---------------------------------------------------------------+\n
        \     |                  FC Encapsulation Header                      |\n
        \     +---------------+-----------------------------------------------+\n
        \     |     SOF Code  |             Reserved                          |\n
        \     +---------------+-----------------------------------------------+\n
        \     |                                                               |\n
        \     +-----                        FC Frame                      ----+\n
        \     |                                                               |\n
        \     +---------------------------------------------------------------+\n
        \     |                              CRC                              |\n
        \     +---------------+-----------------------------------------------+\n
        \     |     EOF Code  |                Reserved                       |\n
        \     +---------------+-----------------------------------------------+\n
        \     Figure 4 - FC Frame (SOF/Data/CRC/EOF) Encapsulation in PW Packet\n
        \  The SOF and EOF frame delimiters are each encoded into a single octet\n
        \  as specified in [RFC3643], except that the codes for delimiters that\n
        \  apply only to FC service class 4 (SOFi4, SOFc4, SOFn4, EOFdt, EOFdti,\n
        \  EOFrt, and EOFrti -- see [FC-FS-2]) MUST NOT be used.\n   The CRC in the
        frame is obtained directly from the FC attachment\n   channel, so that the
        PW PE is not required to recalculate the CRC or\n   to check the CRC in the
        received frame.  The CRC will be checked by\n   the FC port that receives
        the frame, ensuring that coverage is\n   provided for data errors that occur
        between the PW endpoints.  This\n   CRC behavior differs from the Frame Check
        Sequence (FCS) retention\n   technique for PWs defined in [RFC4720], which
        states that \"as usual,\n   the FCS MUST be examined at the ingress PE, and
        errored frames MUST\n   be discarded\".\n"
      title: 3.3.1.  FC Data Frames (PT=0) and FC Login Frames (PT=1)
    - contents:
      - "3.3.2.  FC Primitive Sequences and Primitive Signals (PT=2)\n   FC Primitive
        Sequences and Primitive Signals are FC Ordered Sets.  On\n   an 8b/10b-coded
        FC link, an Ordered Set consists of four 10b\n   characters, starting with
        the K28.5 character, followed by three\n   Dxx.y data characters.  All FC
        Ordered Sets start with a K28.5\n   control character, but the three following
        Dxx.y data characters\n   differ depending on the Ordered Set.  A Kxx.y control
        character has a\n   different 10b code from the corresponding Dxx.y data character
        but\n   uses the same 8b code (e.g., K28.5 and D28.5 both use the 8b code\n
        \  0xBC).  Here are two examples of Ordered Sets:\n   o  Idle (IDLE) is K28.5
        - D21.4 - D21.5 - D21.5.  This FC Primitive\n      Signal is sent when the
        FC link is idle; it is suppressed by the\n      FC PW NSP and not sent over
        the WAN.\n   o  Link Reset Response (LRR) is K28.5 - D21.1 - D31.5 - D9.2.
        \ This\n      FC Primitive Sequence is used as part of FC link initialization\n
        \     and recovery.\n   Each Ordered Set is encapsulated in a PW packet containing
        the\n   encoded K28.5 control character [FC-BB-5/AM1], followed by three\n
        \  encoded data characters, as shown in Figure 5.\n                           1
        \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +---------------------------------------------------------------+\n
        \     |                    FC PW Control Word                         |\n
        \     +---------------------------------------------------------------+\n
        \     |                  FC Encapsulation Header                      |\n
        \     +---------------+---------------+---------------+---------------+\n
        \     |     K28.5     |     Dxx.y     |     Dxx.y     |     Dxx.y     |\n
        \     +---------------+---------------+---------------+---------------+\n
        \     |                                                               |\n
        \     +----                                                       ----+\n
        \     |                                                               |\n
        \     +---------------+---------------+---------------+---------------+\n
        \     |     K28.5     |     Dxx.y     |     Dxx.y     |     Dxx.y     |\n
        \     +---------------+---------------+---------------+---------------+\n
        \            Figure 5 - FC Ordered Sets Encapsulation in PW Packet\n   The
        K28.5 10b control character received from the PE's attached FC\n   link is
        encoded for the FC PW as its 8b counterpart (0xBC).  Because\n   the same
        8b value (0xBC) is used to encode a D28.5 data word, the\n   receiving FC
        PW PE:\n   o  MUST check for presence of an 8b K28.5 value (0xBC) at the start\n
        \     of each Ordered Set (see Figure 5) and MUST send that value as a\n      10b
        K28.5 character on the attached FC link.\n   o  MUST send the following three
        Dxx.y 8b values as Dxx.y 10b\n      characters on the attached FC link and
        MUST NOT send any of these\n      Dxx.y 8b values as 10b Kxx.y characters
        on the attached FC link.\n   A PW packet may contain one or more encoded FC
        Ordered Sets\n   [FC-BB-5/AM1].  The Length field in the FC PW Control Word
        is used to\n   indicate the packet length when the PW packet contains multiple\n
        \  Ordered Sets.  For this reason, FC PW packets that contain FC Ordered\n
        \  Sets MUST NOT be larger than 60 octets (8 octets of header words plus\n
        \  at most 13 Ordered Sets), in order to ensure that the Length field\n   contains
        a non-zero value (see [RFC4385]).\n   Idle Primitive Signals could be carried
        over the PW in the same\n   manner as Primitive Sequences.  However, [FC-BB-5/AM1]
        requires that\n   Idle Primitive Signals be dropped by the Ingress PE and
        regenerated\n   by the egress PE in order to reduce bandwidth consumption
        (see\n   [FC-BB-5/AM1] for further details).\n   The egress PE extracts the
        Primitive Sequence or Primitive Signal\n   from the received PW packet.  For
        a Primitive Sequence, the PE\n   continues transmitting the same FC Ordered
        Set to its attached FC\n   port until an FC frame or another Ordered Set is
        received over the\n   PW; see Section 1.2 above for discussion of ingress
        PE transmission\n   behavior for Primitive Sequences.  A Primitive Signal
        is sent once,\n   except that Idle Primitive Signals are sent continuously
        when there\n   is nothing else to send.\n"
      title: 3.3.2.  FC Primitive Sequences and Primitive Signals (PT=2)
    - contents:
      - "3.3.3.  FC PW Control Frames (PT=6)\n   FC PW control frames are transported
        over the PW by encapsulating\n   each frame in a PW packet with PT=6 in the
        Control Word.  FC PW\n   control frame payloads are generated and terminated
        by the\n   corresponding FC entity.  FC PW control frames are used for FC
        PW\n   flow control (ASFC), ping, and transmission of error indications.\n
        \  [FC-BB-5/AM1] specifies the generation and processing of FC PW\n   control
        frames.  FC PW control frames are always shorter than 64\n   octets, and hence
        the Length field in the FC Control Word indicates\n   their length.\n                           1
        \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +---------------------------------------------------------------+\n
        \     |                    FC PW Control Word                         |\n
        \     +---------------------------------------------------------------+\n
        \     |                  FC Encapsulation Header                      |\n
        \     +---------------------------------------------------------------+\n
        \     |                                                               |\n
        \     +-----              FC PW Control Frame                     ----+\n
        \     |                                                               |\n
        \     +---------------------------------------------------------------+\n
        \            Figure 6 - FC PW Control Frame Encapsulation in PW Packet\n"
      title: 3.3.3.  FC PW Control Frames (PT=6)
    title: 3.3.  Mapping of FC Traffic to PW Packets
  - contents:
    - "3.4.  PW Failure Mapping\n   PW failures are detected through PW signaling
      failure, PW status\n   notifications as defined in [RFC4447], or PW Operations,\n
      \  Administration, and Maintenance (OAM) mechanisms and MUST be mapped\n   to
      emulated signal failure indications.  Sending the FC link failure\n   indication
      to its attached FC link is performed by the NSP, as\n   defined by [FC-BB-5/AM1].\n"
    title: 3.4.  PW Failure Mapping
  title: 3.  Encapsulation
- contents:
  - "4.  Signaling of FC Pseudowires\n   [RFC4447] specifies the use of the MPLS Label
    Distribution Protocol\n   (LDP) as a protocol for setting up and maintaining pseudowires.
    \ This\n   section describes the use of specific fields and error codes used to\n
    \  control FC PW.\n   The PW Type field in the PWid Forwarding Equivalence Class
    (FEC)\n   element and PW generalized ID FEC elements MUST be set to the \"FC\n
    \  Port Mode\" value in Section 8.\n   The Control Word is REQUIRED for FC pseudowires.
    \ Therefore, the\n   C-Bit in the PWid FEC element and PW generalized ID FEC elements
    MUST\n   be set.  If the C-Bit is not set, the pseudowire MUST NOT be\n   established,
    and a Label Release MUST be sent with an \"Illegal C-Bit\"\n   status code [RFC4447].\n
    \  The Fragmentation Indicator (Parameter ID = 0x09) is specified in\n   [RFC4446],
    and its usage is defined in [RFC4623].  Since\n   fragmentation is not used in
    FC PW, the fragmentation indicator\n   parameter MUST be omitted from the Interface
    Parameter Sub-TLV.\n   The Interface MTU Parameter (Parameter ID = 0x01) is specified
    in\n   [RFC4447].  Since all FC interfaces have the same MTU, this parameter\n
    \  MUST be omitted from the Interface Parameter Sub-TLV.\n   The FCS Retention
    Indicator (Parameter ID = 0x0A) is specified in\n   [RFC4720].  Since the CRC
    treatment defined in this document differs\n   from one that is specified in [RFC4720],
    this parameter MUST be\n   omitted from the Interface Parameter Sub-TLV.\n"
  title: 4.  Signaling of FC Pseudowires
- contents:
  - "5.  Timing Considerations\n   Correct Fibre Channel link operation requires that
    the FC link\n   latency between CE1 and CE2 (refer to Figure 1) be:\n   o  no
    more than one-half of the R_T_TOV (Receiver Transmitter Timeout\n      Value,
    default value: 100 milliseconds) of the attached devices\n      for Primitive
    Sequences;\n   o  no more than one-half of the E_D_TOV (Error Detect Timeout Value,\n
    \     default value: 2 seconds) of the attached devices for frames; and\n   o
    \ within the R_A_TOV (Resource Allocation Timeout Value, default\n      value:
    10 seconds) of the attached fabric(s), if any.  The FC\n      standards require
    that the E_D_TOV value for each FC link be set\n      so that the R_A_TOV value
    for the fabric is respected when the\n      worst-case latency occurs for each
    link (see [FC-FS-2]).\n   An FC PW MUST adhere to these three timing requirements
    and MUST NOT\n   be used in environments where high or variable latency may cause\n
    \  these requirements to be violated.\n   These three timeout values are ordered
    (R_T_TOV < E_D_TOV < R_A_TOV),\n   so adherence to one-half of R_T_TOV for all
    FC PW traffic is\n   sufficient.  See [FC-FS-2] for definitions of the FC timeout
    values.\n   The R_T_TOV is used by the FC link initialization protocol.  If an
    FC\n   PW's latency exceeds one-half R_T_TOV, initialization of the FC link\n
    \  that is encapsulated by the FC PW may fail, leaving that FC link in a\n   non-operational
    state.\n   The E_D_TOV is used to detect failures of operational FC links.  If\n
    \  an FC PW's latency exceeds the one-half E_D_TOV requirement, the FC\n   link
    that is encapsulated by the FC PW may fail.  The usual FC\n   response to such
    a link failure is to attempt to recover the FC link\n   by initializing it.  That
    initialization will also fail if the FC PW\n   latency exceeds one-half R_T_TOV
    (a tighter requirement).\n   The R_A_TOV is used to determine when FC communication
    resources\n   (e.g., values that identify FC frames) may be reused.  If an FC
    PW's\n   violation of the one-half E_D_TOV requirement is sufficient to also\n
    \  cause the FC fabric to violate the R_A_TOV requirement, then FC reuse\n   of
    frame identification values after an R_A_TOV timeout may result in\n   multiple
    FC frames with the same identification values, causing\n   incorrect Fibre Channel
    operation.  For example, if two such frames\n   are swapped between I/O operations,
    the result may corrupt data in\n   the I/O operations.\n   The PING and PING_ACK
    FC PW control frames defined in Section 6.4.7\n   of [FC-BB-5/AM1] SHOULD be used
    to measure the current FC pseudowire\n   latency between the Customer Edge (CE)
    devices.  If the measured\n   latency violates any of the timing requirements,
    then the FC PW PE\n   MUST generate a WAN Down event as specified in [FC-BB-5/AM1].\n
    \  The WAN Down event causes the PE to continuously send NOS (an FC\n   Primitive
    Sequence) on the native FC link to the FC port at the other\n   end of that link
    (typically an E_Port on a switch in this case).\n   This immediately causes the
    FC link that is carried by the PW to\n   become non-operational, halting transmission
    of FC traffic.  However,\n   it is not necessary to tear down the pseudowire itself
    in this\n   situation (e.g., destroy the MPLS path set up by LDP).\n   The Transparent
    FC-BB initialization state machine in [FC-BB-5/AM1]\n   specifies the protocol
    used to attempt to recover from a WAN Down\n   event (i.e., bring the WAN back
    up).  If that protocol brings the WAN\n   back up, FC traffic will resume and
    the standard FC link recovery\n   protocol will bring the encapsulated FC link
    back up.  If the\n   previous pseudowire was destroyed, attempts will be made
    to\n   re-establish the path via LDP as part of recovering from the WAN Down\n
    \  event.  If the PW round-trip latency remains above R_T_TOV, the\n   initialization
    protocol for the FC PW will repeatedly time out in\n   attempting to recover from
    the WAN Down event, preventing recovery of\n   the FC link carried by the PW;
    see [FC-BB-5/AM1].\n"
  title: 5.  Timing Considerations
- contents:
  - "6.  Security Considerations\n   The FC PW is an MPLS pseudowire; for MPLS pseudowire
    security\n   considerations, see the security considerations sections of [RFC3985]\n
    \  and [RFC4385].\n   The protocols used to implement security in a Fibre Channel
    fabric\n   are defined in [FC-SP].  These protocols operate at higher layers of\n
    \  the FC hierarchy and are transparent to the FC PW.\n   The FC timing requirements
    (see Section 5) create an exposure of the\n   FC PW to inserted latency.  Injection
    of latency sufficient to cause\n   the round-trip time for an FC PW to exceed
    R_T_TOV (default: 100 ms)\n   may cause the FC PW to fail in an active fashion
    because the FC link\n   initialization protocol repeatedly times out.  OAM functionality
    for\n   deployed FC PWs SHOULD monitor for persistence of this situation and\n
    \  respond accordingly (e.g., shut down the FC PW in order to avoid\n   wasting
    WAN bandwidth on an FC PW whose FC link cannot be\n   successfully initialized
    due to excessive latency).\n"
  title: 6.  Security Considerations
- contents:
  - "7.  Applicability Statement\n   FC PW allows the transparent transport of FC
    traffic between Fibre\n   Channel ports while saving network bandwidth by removing
    FC Idle\n   Primitive Signals and reducing the number of FC Primitive Sequences.\n
    \  o  The pair of CE devices operates as if they were directly connected\n      by
    an FC link.  In particular, they react to Primitive Sequences\n      on their
    local FC links as specified by the FC standards.\n   o  The FC PW carries only
    FC data frames, FC Primitive Signals, and a\n      subset of the copies of an
    FC Primitive Sequence.  Idle Primitive\n      Signals are suppressed, and long
    streams of the same Primitive\n      Sequence are reduced over the PW, thus saving
    bandwidth.\n   o  The PW PE MUST generate Idle Primitive Signals to the attached
    FC\n      link when there is no other traffic to transmit on the attached FC\n
    \     link [FC-FS-2].\n   o  The PW PE MUST send Primitive Sequences continuously
    to the\n      attached FC port, as required by the FC standards [FC-FS-2].\n   FC
    PW traffic should only traverse MPLS networks that are provisioned\n   based on
    traffic engineering to provide dedicated bandwidth for FC PW\n   traffic.  The
    MPLS network should enforce ingress traffic policing so\n   that delivery of FC
    PW traffic can be assured.  To extend FC across a\n   network that does not satisfy
    these requirements, FCIP SHOULD be used\n   instead of an FC PW (see [RFC3821]
    and [FC-BB-6]).\n   This document does not provide any mechanisms for protecting
    an FC PW\n   against network outages.  As a consequence, resilience of the\n   emulated
    FC service to such outages is dependent upon the underlying\n   MPLS network,
    which should be protected against failures.  When a\n   network outage is detected,
    the PE SHOULD use a WAN Down event (as\n   specified in [FC-BB-5/AM1]) to convey
    the PW status to the CE and\n   enable faster outage handling.\n"
  title: 7.  Applicability Statement
- contents:
  - "8.  IANA Considerations\n   IANA has assigned a new MPLS Pseudowire (PW) type
    as follows:\n      PW type      Description           Reference\n      --------
    \    --------------        ----------\n      0x001F       FC Port Mode          RFC
    6307\n   IANA has reserved the following Pseudowire Interface Parameters\n   Sub-TLV
    Types.  These Sub-TLV types were used for the FC PW Selective\n   Retransmission
    protocol, which the PWE3 working group has decided to\n   eliminate.  This action
    prevents future use of these values for other\n   purposes, as there is at least
    one implementation of the Selective\n   Retransmission protocol that has been
    deployed.\n      Parameter  ID Length  Description  Reference\n      ---------
    \ ---------  -----------  ---------\n      0x12                  Reserved     RFC
    6307\n      0x13                  Reserved     RFC 6307\n      0x14                  Reserved
    \    RFC 6307\n      0x15                  Reserved     RFC 6307\n"
  title: 8.  IANA Considerations
- contents:
  - "9.  Acknowledgments\n   Previous versions of this document were authored by Moran
    Roth, Ronen\n   Solomon, and Munefumi Tsurusawa; their efforts and contributions
    are\n   gratefully acknowledged.  The authors would like to thank Stewart\n   Bryant,
    Elwyn Davies, Steve Hanna, Dave Peterson, Yaakov Stein,\n   Alexander Vainshtein,
    and the members of the IESG for helpful\n   comments on this document.\n   The
    protocol specified in this document is intended to be used in\n   conjunction
    with the Fibre Channel pseudowire portion of the FC-BB-5\n   Amendment 1 specification
    developed by INCITS Technical Committee\n   T11.  The authors would like to thank
    the members of both the IETF\n   and T11 organizations who have supported and
    contributed to this\n   work.\n"
  title: 9.  Acknowledgments
- contents:
  - "10.  Normative References\n   [FC-BB-5/AM1]  \"Fibre Channel - Backbone-5 / Amendment
    1\", INCITS\n                  462-2010/AM 1-2012, June 2012.\n   [FC-FS-2]      \"Fibre
    Channel - Framing and Signaling-2 (FC-FS-2)\",\n                  ANSI INCITS
    424:2007, August 2007.\n   [RFC2119]      Bradner, S., \"Key words for use in
    RFCs to Indicate\n                  Requirement Levels\", BCP 14, RFC 2119, March
    1997.\n   [RFC3643]      Weber, R., Rajagopal, M., Travostino, F., O'Donnell,\n
    \                 M., Monia, C., and M. Merhar, \"Fibre Channel (FC)\n                  Frame
    Encapsulation\", RFC 3643, December 2003.\n   [RFC3985]      Bryant, S., Ed.,
    and P. Pate, Ed., \"Pseudo Wire\n                  Emulation Edge-to-Edge (PWE3)
    Architecture\", RFC 3985,\n                  March 2005.\n   [RFC4385]      Bryant,
    S., Swallow, G., Martini, L., and D.\n                  McPherson, \"Pseudowire
    Emulation Edge-to-Edge (PWE3)\n                  Control Word for Use over an
    MPLS PSN\", RFC 4385,\n                  February 2006.\n   [RFC4446]      Martini,
    L., \"IANA Allocations for Pseudowire Edge to\n                  Edge Emulation
    (PWE3)\", BCP 116, RFC 4446, April 2006.\n   [RFC4447]      Martini, L., Ed.,
    Rosen, E., El-Aawar, N., Smith, T.,\n                  and G. Heron, \"Pseudowire
    Setup and Maintenance Using\n                  the Label Distribution Protocol
    (LDP)\", RFC 4447,\n                  April 2006.\n   [RFC4623]      Malis, A.
    and M. Townsley, \"Pseudowire Emulation Edge-\n                  to-Edge (PWE3)
    Fragmentation and Reassembly\", RFC\n                  4623, August 2006.\n   [RFC4720]
    \     Malis, A., Allan, D., and N. Del Regno, \"Pseudowire\n                  Emulation
    Edge-to-Edge (PWE3) Frame Check Sequence\n                  Retention\", RFC 4720,
    November 2006.\n"
  title: 10.  Normative References
- contents:
  - "11.  Informative References\n   [FC-BB-6]      \"Fibre Channel Backbone-6\" (FC-BB-6),
    T11 Project\n                  2159-D, Rev 1.04, Work in Progress, January 2012.\n
    \  [FC-SP]        \"Fibre Channel - Security Protocols\" (FC-SP), ANSI\n                  INCITS
    426:2007, February 2007.\n   [RFC3821]      Rajagopal, M., Rodriguez, E., and
    R. Weber, \"Fibre\n                  Channel Over TCP/IP (FCIP)\", RFC 3821, July
    2004.\n   [RFC4717]      Martini, L., Jayakumar, J., Bocci, M., El-Aawar, N.,\n
    \                 Brayley, J., and G. Koleyni, \"Encapsulation Methods\n                  for
    Transport of Asynchronous Transfer Mode (ATM) over\n                  MPLS Networks\",
    RFC 4717, December 2006.\n   [T11]          INCITS Technical Committee T11, http://www.t11.org,\n
    \                 January 2011.\n"
  title: 11.  Informative References
- contents:
  - "Authors' Addresses\n   David L. Black (editor)\n   EMC Corporation\n   176 South
    Street\n   Hopkinton, MA 01748\n   USA\n   Phone: +1 (508) 293-7953\n   EMail:
    david.black@emc.com\n   Linda Dunbar (editor)\n   Huawei Technologies\n   1700
    Alma Drive, Suite 500\n   Plano, TX 75075\n   USA\n   Phone: +1 (972) 543-5849\n
    \  EMail: ldunbar@huawei.com\n   Moran Roth\n   Infinera Corporation\n   169 Java
    Drive\n   Sunnyvale, CA 94089\n   USA\n   Phone: (408) 572-5200\n   EMail: MRoth@infinera.com\n
    \  Ronen Solomon\n   Orckit-Corrigent Systems\n   126, Yigal Alon st.\n   Tel
    Aviv\n   Israel\n   Phone: +972-3-6945316\n   EMail: ronens@corrigent.com\n"
  title: Authors' Addresses
