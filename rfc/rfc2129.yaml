- title: __initial_text__
  contents:
  - '  Toshiba''s Flow Attribute Notification Protocol (FANP) Specification

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  This memo\n   does not specify an Internet standard of any kind.  Distribution\
    \ of\n   this memo is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   This memo discusses Flow Attribute Notification Protocol (FANP),\n\
    \   which is a protocol between neighbor nodes for the management of\n   cut-through\
    \ packet forwarding functionalities. In cut-through packet\n   forwarding, a router\
    \ doesn't have to perform conventional IP packet\n   processing for received packets.\
    \  FANP indicates mapping information\n   between a datalink connection and a\
    \ packet flow to the neighbor node\n   and helps a pair of nodes manage the mapping\
    \ information.  By using\n   FANP, routers (e.g., CSR; Cell Switch Router) can\
    \ forward incoming\n   packets based on their datalink-level connection identifiers,\n\
    \   bypassing usual IP packet processing.  The design policy of the FANP\n   is;\n\
    \       (1)  soft-state cut-through path (Dedicated-VC) management\n       (2)\
    \  protocol between neighbor nodes instead of end-to-end\n       (3)  applicable\
    \ to any connection oriented datalink platform\n"
- title: 1.  Background
  contents:
  - "1.  Background\n   Due to the scalability requirement, connection oriented (CO)\
    \ datalink\n   platforms, e.g., ATM and Frame Relay, are going to be used as well\
    \ as\n   connection less (CL) datalink platforms, e.g., Ethernet and FDDI.\n \
    \  One of the important features of the CO datalink is the presence of a\n   datalink-level\
    \ connection identifier.  In the CO datalink, we can\n   establish multiple virtual\
    \ connections (VCs) with their VC\n   identifiers among the nodes. When we aggregate\
    \ packets that have the\n   same direction (e.g., having the same destination\
    \ IP address) into a\n   single VC, we can forward the packets in the VC without\
    \ IP\n   processing.  With this configuration, routers can decide which node\n\
    \   is the next-hop for the packets based on the VC identifier.  CSRs [1]\n  \
    \ can forward the incoming packets using an ATM switch engine bypassing\n   the\
    \ conventional IP processing.  According to the ingress VPI/VCI\n   value with\
    \ ingress interface information, CSR determines the egress\n   interface and egress\
    \ VPI/VCI value.\n   In order to configure the cut-through packet forwarding state,\
    \ a pair\n   of neighbor nodes have to share the mapping information between the\n\
    \   packet flow and the datalink VC.  FANP (Flow Attribute Notification\n   Protocol)\
    \ described in this memo is the protocol to configure and\n   manage the cut-through\
    \ packet forwarding state.\n"
- title: 2.  Protocol Requirements and Future Enhancement
  contents:
  - '2.  Protocol Requirements and Future Enhancement

    '
- title: 2.1 Protocol Requirements
  contents:
  - "2.1 Protocol Requirements\n   The followings are the protocol requirements for\
    \ FANP.\n   (1) Applicable to various types of CO datalink platforms\n   (2) Available\
    \ with various connection types (i.e., SVC, PVC, VP)\n   (3) Robust operation\n\
    \       The system should operate correctly even under the following\n       conditions.\n\
    \        (a) VC failure\n            Some systems can detect VC failure as the\
    \ function of\n            datalink (e.g., OAM function in the ATM).  However,\
    \ we can\n            not assume all nodes in the system can detect VC failure.\n\
    \            The system has to operate correctly, assuming that every\n      \
    \      node can not detect VC failure.\n        (b) Message loss\n           \
    \ Control messages in the FANP may be lost.  The system has to\n            operate\
    \ correctly, even when some control messages are lost.\n        (c Node failure\n\
    \            A node may be down without any explicit notification to its\n   \
    \         neighbors.  The system has to operate correctly, even with\n       \
    \     node failure.\n   Though FANP is not the protocol only for ATM, the following\n\
    \   discussion assumes that the datalink is an ATM network.\n"
- title: 2.2  Future Enhancement
  contents:
  - "2.2  Future Enhancement\n   The followings are the future enhancements to be\
    \ done.\n        (1) Aggregated flow\n          In this memo, we define the flow\
    \ which contain source and\n          destination IP address.  As this may require\
    \ many VC\n          resources, we also need a new definition of aggregated flow\n\
    \          which includes several end-to-end flows.  The concrete\n          definition\
    \ of the aggregated flow is for future study.\n        (2) Providing multicast\
    \ service\n        (3) Supporting IP level QOS signaling like RSVP\n        (4)\
    \ Supporting IPv6\n"
- title: 3. Terminology and Definition
  contents:
  - "3. Terminology and Definition\n   o VCID (Virtual Connection IDentifier)\n  \
    \    Since VPI/VCI values at the origination and the termination points\n    \
    \  of a VC (and VP) may not be the same, we need an identifier to\n      uniquely\
    \ identify the datalink connection between neighbor nodes.\n      We define this\
    \ identifier as a VCID.  Currently, only one type of\n      VCID is defined. \
    \ This VCID contains the ESI (End System\n      Identifier) of a source node and\
    \ the unique identifier within a\n      source node.\n   o Flow ID (Flow IDentifier)\n\
    \      IP level packet flow is identified by some parameters in a packet.\n  \
    \    Currently, only one type of flow ID is defined.  This flow ID\n      contains\
    \ a source IP address and a destination IP address.  Note\n      that flow ID\
    \ used in this specification is not the same as the\n      flow-id specified in\
    \ IPv6.\n   o Cut-through packet forwarding\n      Packets are forwarded without\
    \ any IP processing at the router\n      using the datalink level information\
    \ (e.g.,VPI/VCI).\n      Internetworking level information (e.g., destination\
    \ IP address)\n      is mapped to the corresponding datalink-level identifier\
    \ by using\n      the FANP.\n   o Hop-by-Hop packet forwarding\n      Packets\
    \ are forwarded using IP level information like conventional\n      routers. \
    \ In ATM, cells are re-assembled into packets at the\n      router to analyze\
    \ the IP header.\n   o Default-VC\n      Default-VC is used for hop-by-hop packet\
    \ forwarding.  Cells\n      received from the Default-VC are reassembled into\
    \ IP packets.\n      Conventional IP processing is performed for these packets.\
    \  The\n      encapsulation over the Default-VC is LLC for routed non-ISO\n  \
    \    protocols defined by RFC1483 [3].\n   o Dedicated-VC\n      Dedicated-VC\
    \ is used for the specific IP packet flow identified by\n      the flow-ID.  When\
    \ the flow-ID for an incoming VC and an outgoing\n      VC are the same at a CSR,\
    \ it can forward the packets belonging to\n      the flow through the cut-through\
    \ packet forwarding.  The\n      encapsulation over the Dedicated-VC is LLC for\
    \ routed non-ISO\n      protocols defined by RFC1483 [3].\n   o Cut-through trigger\n\
    \      When a FANP capable node receives a trigger packet, it tries to\n     \
    \ establish Dedicated-VC and to notify the mapping information\n      between\
    \ the Dedicated-VC and the IP packet flow which the received\n      trigger packet\
    \ belongs to.  Trigger packets are defined by the\n      port-ID of TCP/UDP with\
    \ the local policy of each FANP capable\n      node.  In general, they would be\
    \ the port-ID's of sessions with a\n      long life-time and/or with large amount\
    \ of packets; e.g., http,\n      ftp and nntp.  Future implementation will include\
    \ other triggers\n      such as an arrival of resource reservation request.\n"
- title: 4. Protocol Overview
  contents:
  - "4. Protocol Overview\n   Figure 1 shows an operational overview of FANP.  In\
    \ the figure, a\n   cut-through packet forwarding path is established from host\
    \ 1 (H1) to\n   host 2 (H2) using two Dedicated-VCs.  H1 and H2 are connected\
    \ to\n   Ethernets, and R1, R2 and R3 are routers which can speak FANP.  R1\n\
    \   and R3 have both an ATM interface and an Ethernet interface.  R2 has\n   two\
    \ ATM interfaces.\n   When R1 receives an IP packet from H1, R1 analyzes the payload\
    \ of the\n   received IP packet whether it is a trigger packet or not.  When the\n\
    \   received packet is a trigger packet, R1 fetches a Dedicated-VC to its\n  \
    \ downstream neighbor(R2) and sends FANP messages.  FANP is effective\n   between\
    \ the neighboring nodes only.  The same procedure would be\n   performed between\
    \ R2 and R3 independently from the procedure between\n   R1 and R2.  The flow-ID\
    \ of the packet flow from H1 to H2 is\n   represented as id(H1,H2).  Here, id(H1,H2)\
    \ is the set of the IP\n   address of H1 and that of H2.\n   The Dedicated-VC\
    \ is released when no packet is transferred on it for\n   a given period.  We\
    \ do not need to explicitly indicate release of the\n   Dedicated-VC to the neighbor\
    \ node, since the state management in FANP\n   is of soft-state, rather than of\
    \ hard-state.\n    +--+ Ethernet +--+   +-----+   +--+   +-----+   +--+ Ethernet\
    \ +--+\n    |H1|----------|R1|---| ATM |---|R2|---| ATM |---|R3|----------|H2|\n\
    \    +--+          +--+   +-----+   +--+   +-----+   +--+          +--+\n    \
    \   trigger pkt\n       |----------> trigger packet\n                    |------------->\
    \   trigger packet\n                       FANP          |-------------->  trigger\
    \ pkt\n                    <=============>        FANP        |----------->\n\
    \                                     <==============>\n                    |=============|\n\
    \                     Dedicated-VC    |==============|\n                     \
    \                  Dedicated-VC\n             Figure 1. Trigger packet and FANP\
    \ initiation\n"
- title: 5. Protocol Sequence
  contents:
  - "5. Protocol Sequence\n   FANP has the following five procedures, that are (1)\
    \ Dedicated-VC\n   selection, (2) VCID negotiation, (3) flow-ID notification,\
    \ (4)\n   Dedicated-VC refresh and (5) Dedicated-VC release.  Procedures (2),\n\
    \   (3) and (4) have nothing to do with the kind of the Dedicated-\n   VC;i.e.,SVC,PVC\
    \ or VP.  On the contrary, the procedures (1) and (5)\n   with SVC are different\
    \ from the procedures with PVC and with VP.\n   The detailed procedures are described\
    \ in the following subsections.\n"
- title: 5.1 Dedicated-VC Selection Procedure
  contents:
  - "5.1 Dedicated-VC Selection Procedure\n   A VC is picked up in order to use as\
    \ a Dedicated-VC.  The ways of\n   picking up the Dedicated-VC is either of the\
    \ followings.\n   (1) A number of VCs are prepared in advance, and registered\
    \ into an\n      un-used VC list.  When a Dedicated-VC is needed, one of them\
    \ is\n      picked up from the un-used VC list.\n   (2) A new VC is established\
    \ through ATM signaling on demand.\n   With ATM PVC/VP configuration, a Dedicated-VC\
    \ is activated by the\n   procedure (1).\n   With ATM SVC configuration, a Dedicated-VC\
    \ is activated by the\n   procedure (1) or (2).  When the procedure (1) is used,\
    \ some number of\n   VCs are prepared in advance through ATM signaling.  These\
    \ VCs are\n   registered into the un-used VC list.  When a Dedicated-VC is needed,\n\
    \   a VC is picked up from the un-used VC list.  When the procedure (2)\n   is\
    \ used, a Dedicated-VC is established through ATM signaling each\n   time it is\
    \ required.\n   The procedure (1) can decrease a time to activate a Dedicated-VC.\n\
    \   But the necessary VC resource will increase as it need to prepare\n   additional\
    \ VCs.  Which procedure should be applied to is a matter of\n   local decision\
    \ in each node, taking the economical requirement and\n   the system responsiveness\
    \ into account.\n   A Dedicated-VC is used as a uni-directional VC, although it\
    \ is\n   generally bi-directional.  This means that packets are transferred\n\
    \   only from upstream node to downstream node in the Dedicated-VC. The\n   packets\
    \ from downstream node to upstream node are transferred through\n   the Default-VC\
    \ or through another Dedicated-VC.\n"
- title: 5.2 VCID Negotiation Procedure
  contents:
  - "5.2 VCID Negotiation Procedure\n   After the Dedicated-VC selection procedure,\
    \ the upstream node\n   transmits the PROPOSE message to the downstream node through\
    \ the\n   Dedicated-VC.  The PROPOSE message contains a VCID for the\n   Dedicated-VC\
    \ and IP address (target IP address) of downstream node.\n   When the downstream\
    \ node accepts the PROPOSE message, it transmits\n   the PROPOSE ACK message to\
    \ the upstream node through the Default-VC.\n   With this procedure, the upstream\
    \ and the downstream nodes (both\n   end-points of the Dedicated-VC) can share\
    \ the same indicator \"VCID\"\n   for the Dedicated-VC.  When the downstream node\
    \ can not accept the\n   proposal from the upstream node with some reason (e.g.,\
    \ policy), the\n   downstream node sends an ERROR message to the upstream node\
    \ through\n   the Default-VC.\n   The procedure at the downstream node which has\
    \ received PROPOSE\n   message is;\n    1. if(Target IP address of the PROPOSE\
    \ message isn't equal to my IP\n          address)\n       then Goto end.\n  \
    \  2. if(The PROPOSE message should be refused)\n       then  Send an ERROR(refuse\
    \ by policy) message. Go to end.\n    3. if(VCID Type in the PROPOSE message isn't\
    \ known)\n       then Send an ERROR(unknown VCID Type) message. Go to end.\n \
    \   4. if(The VCID in the PROPOSE message is  the same as the VCID which\n   \
    \    has already been registered for another Dedicated-VC in the node)\n     \
    \  then Delete the registered VCID.\n       Release the old Dedicated-VC.\n  \
    \  5. if(A VCID is registered for the Dedicated-VC which has received\n      \
    \ the PROPOSE message)\n       then Delete the registered VCID.\n    6. Register\
    \ the mapping between VCID and  I/F, VPI, VCI for the\n       Dedicated-VC.\n\
    \    7. if(The mapping is successful)\n       then Send a PROPOSE ACK.\n     \
    \  else Send an ERROR(resource unavailable).\n   The upstream node retransmits\
    \ the PROPOSE message when it neither\n   receive PROPOSE ACK message nor ERROR\
    \ message.  When the upstream\n   node has received neither of the messages even\
    \ with five\n   retransmissions of the PROPOSE message, the Dedicated-VC picked\
    \ up\n   through the Dedicated-VC selection procedure should be released.\n  \
    \ Here, the number of retransmissions (five in this specification)is\n   recommended\
    \ value and can be modified in the future.\n   The purpose of the VCID negotiation\
    \ procedure is not only to share\n   the VCID information regarding the Dedicated-VC,\
    \ but also to confirm\n   whether the Dedicated-VC is available and whether the\
    \ neighbor node\n   operates correctly.\n   If the VCID negotiation procedure\
    \ with a neighbor node always fails,\n   it is considered that the node may not\
    \ be FANP-capable node.\n   Therefore the upstream node should not try the VCID\
    \ negotiation\n   procedure to that node for a certain time period.\n"
- title: 5.3 Flow-ID Notification Procedure
  contents:
  - "5.3 Flow-ID Notification Procedure\n   After the VCID negotiation procedure,\
    \ the upstream node transmits an\n   OFFER message to the downstream node through\
    \ the Default-VC.  The\n   OFFER message contains the VCID of the Dedicated-VC,\
    \ the flow-ID of\n   the packet flow transferred through the Dedicated-VC and\
    \ the refresh\n   interval of a READY message.\n   When the downstream node receives\
    \ the OFFER message from the upstream\n   node, it transmits the READY message\
    \ to the upstream node through the\n   Default-VC in order to indicate that the\
    \ OFFER message issued by the\n   upstream node is accepted.  By the reception\
    \ of the READY message,\n   the upstream node realizes that the downstream node\
    \ can receive IP\n   packets transferred through the Dedicated-VC.\n   The upstream\
    \ node retransmits the OFFER message when it does not\n   receive a READY message\
    \ from the downstream node.  When the upstream\n   node has not receive a READY\
    \ message even with five retransmissions,\n   the Dedicated-VC should be released.\
    \  Here, the number of\n   retransmissions (i.e., five in this specification)\
    \ is a recommended\n   value and may be modified in the future.\n   The node transmits\
    \ an ERROR message to its neighbor in the following\n   cases.  When the node\
    \ receives the ERROR message, the Dedicated-VC\n   should be released.\n    (a)\
    \ unknown VCID: The VCID in the message is unknown.\n    (b) unknown VCID Type:\
    \ The VCID Type is unknown.\n    (c) unknown flow-ID Type: the flow-ID Type is\
    \ unknown.\n   When the downstream node accepts the OFFER message from the upstream\n\
    \   node, it must send a READY message to the upstream node within the\n   refresh\
    \ interval offered by the upstream node.  If it can not, the\n   downstream node\
    \ sends the ERROR message (this refresh interval is not\n   supported) to the\
    \ upstream node.  The downstream node should accept\n   the refresh interval larger\
    \ than 120 seconds.  Therefore the\n   downstream node shouldn't send the ERROR\
    \ message (this refresh\n   interval is not supported) when the refresh interval\
    \ in the OFFER\n   message is larger than 120 seconds.\n   The following describes\
    \ the procedure of the node which has received\n   an OFFER message.\n    1. if(unknown\
    \ version in the OFFER message)\n       then Discard the message.  Goto end.\n\
    \    2. if(unknown VCID Type in the OFFER message)\n       then Send an ERROR\
    \ (unknown VCID Type) message.  Goto end.\n    3. if(VCID in the OFFER message\
    \ has not been registered)\n       then Send an ERROR (unknown VCID) message.\
    \  Goto end.\n    4. if(unknown Flow ID Type in the OFFER message)\n       then\
    \ Send an ERROR (unknown Flow ID Type) message.  Goto end.\n    5. if(refuse Flow\
    \ ID in the OFFER message)\n       then Send an ERROR (refused by policy) message.\
    \  Goto end.\n    6. if(refuse refresh interval in the OFFER message)\n      \
    \ then Send an ERROR(This refresh interval is not supported)\n       message.\
    \  Goto end.\n    7. if(the mapping between Flow ID and VCID already exists and\n\
    \          Flow ID in the OFFER message is different from the registered\n   \
    \       Flow ID for the corresponding VCID)\n       then Do Flow-ID removal procedure.\
    \  Goto end.\n    8. Do the procedure of receiving the OFFER message.\n    7.\
    \ if(successful)\n       then Send a READY message.\n       else Send an ERROR\
    \ (resource unavailable) message.\n    8. end.\n   The procedure of the node which\
    \ has received a READY message is\n   described.\n    1. if(unknown version in\
    \ the READY message)\n       then Discard the message.  Goto end.\n    2. if(unknown\
    \ VCID Type in the READY message)\n       then Send an ERROR (unknown VCID Type)\
    \ message.  Goto end.\n    3. if(VCID in the READY message has not been registered)\n\
    \       then Send an ERROR (unknown VCID) message.  Goto end.\n    4. if(unknown\
    \ Flow ID Type in the READY message)\n       then Send an ERROR (unknown Flow\
    \ ID Type) message.  Goto end.\n    5. if((the mapping between Flow ID and VCID\
    \ doesn't exist)||\n          (the mapping between Flow ID and VCID already exists\
    \ and\n           Flow ID in the READY message is different from registered Flow\n\
    \           ID for the corresponding VCID))\n       then Send an ERROR (unknown\
    \ VCID) message.  Goto end.\n    6. Do the procedure of receiving the READY message.\n\
    \    7. end.\n"
- title: 5.4 Flow ID Refresh Procedure
  contents:
  - "5.4 Flow ID Refresh Procedure\n   While the downstream node receives IP packets\
    \ through the Dedicated-\n   VC, it should periodically (with a refresh interval)\
    \ send the READY\n   message to the upstream node.  When the downstream node does\
    \ not\n   receive any IP packet during the refresh interval, it does not send\n\
    \   the READY message to the upstream node.\n   While the upstream node continues\
    \ to receive READY messages, it\n   realizes that it can transmit the IP packets\
    \ through the Dedicated-\n   VC.  When it does not receive a READY message at\
    \ all for a\n   predetermined period (dead interval), it removes the mapping between\n\
    \   the Flow IP and VCID.  The dead interval is defined below.\n   When the upstream\
    \ node falls into failure without the Flow ID removal\n   procedure for a Dedicated-VC,\
    \ its mapping must be removed by the\n   downstream node.  The downstream node\
    \ removes the mapping between the\n   Flow ID and VCID for the Dedicated-VC when\
    \ it does not receive any IP\n   packet for a \"removal period\" (=refresh interval\
    \ times m).\n   The refresh interval, the dead interval and the removal period\
    \ should\n   satisfy the following equation.\n    refresh interval < dead interval\
    \ < removal period (=refresh\n    interval times m)\n    The recommended values\
    \ are:\n        refresh interval =  2 minutes\n        dead interval    =  6 minutes\
    \ (=refresh interval x 3)\n        removal period  = 20 minutes (=refresh interval\
    \ x 10)\n"
- title: 5.5 Flow ID Removal Procedure
  contents:
  - "5.5 Flow ID Removal Procedure\n   When the upstream node realizes that the Dedicated-VC\
    \ is not used, it\n   performs a Flow ID removal procedure.\n   The Flow ID removal\
    \ procedure differs between the case of PVC/VP\n   configuration and the case\
    \ of SVC configuration.\n   With the PVC/VP configuration, the upstream node issues\
    \ a REMOVE\n   message to the downstream node, and the downstream node sends back\
    \ a\n   REMOVE ACK message to the upstream node.  The upstream node\n   retransmits\
    \ REMOVE messages when it does not receive a REMOVE ACK\n   message.  The upstream\
    \ node assumes that the downstream node is in\n   failure state when it dose not\
    \ receive any REMOVE ACK message from\n   the downstream node even with five REMOVE\
    \ message retransmissions.\n   With SVC configuration, two procedures are possible.\
    \  One is that the\n   mapping between the Flow ID and the VCID is removed without\
    \ the\n   release of the ATM connection, which is the same procedure as the\n\
    \   PVC/VP configuration.  The other procedure is that the mapping\n   between\
    \ the Flow ID and the VCID is removed by releasing the VC\n   through ATM signaling.\
    \  The former procedure can promptly create and\n   delete the mapping between\
    \ Flow ID and VCID, since the ATM signaling\n   does not have to be performed\
    \ each time.  However, an un-used ATM\n   connections have to be maintained by\
    \ the node.  Which procedure is\n   applied to is a matter of each CSR's local\
    \ decision, taking the VC\n   resource cost and responsiveness into account.\n\
    \   The downstream node may want to remove the mapping between the Flow\n   ID\
    \ and the VCID.  When the upstream node receives the REMOVE message,\n   it sends\
    \ a REMOVE ACK message to the downstream node.\n             +--+            \
    \                  +--+\n             |R1|------------------------------|R2|\n\
    \             +--+                              +--+\n               |       \
    \    PROPOSE              |\n               |===============================>|\n\
    \      VCID     |       [VCID, target IP]        |\n  negotiation  |         \
    \ PROPOSE ACK           |\n               |<===============================|\n\
    \               |            [VCID]              |\n               |         \
    \                       |\n               |            OFFER               |\n\
    \               |===============================>|\n     Flow-ID   |       [VCID,\
    \ flow-ID]          |\n  notification |            READY               |\n   \
    \            |<===============================|\n               |       [VCID,\
    \ flow-ID]          |\n               |                                |\n   \
    \                 :         :           :\n                    :         :   \
    \        :\n               |           READY                |\n              \
    \ |<===============================|\n  Dedicated-VC |       [VCID, flow-ID] \
    \         |\n  refresh      |           READY                |\n             \
    \  |<===============================|\n               |       [VCID, flow-ID]\
    \          |\n          Figure 2. Flow ID notification and refresh procedure\n\
    \             +--+                              +--+\n             |R1|------------------------------|R2|\n\
    \             +--+                              +--+\n               |       \
    \                          |\n               |             REMOVE            \
    \  |\n               |================================>|\n               |   \
    \          [VCID]              |\n               |                           \
    \      |\n               |           REMOVE ACK            |\n               |<================================|\n\
    \               |             [VCID]              |\n          (a) Flow ID removal\
    \ (independent of ATM signaling)\n             +--+                          \
    \    +--+\n             |R1|------------------------------|R2|\n             +--+\
    \                              +--+\n               |          ATM signaling \
    \         |\n               |           (release)             |\n            \
    \   |<===============================>|\n               |                    \
    \             |\n            (b) Flow ID removal through ATM signaling\n     \
    \        Figure 3.  Flow ID removal procedure\n"
- title: 6. Message Format
  contents:
  - "6. Message Format\n   FANP control procedure includes seven messages described\
    \ from 6.2 to\n   6.8.  Among them, a PROPOSE message used for VCID negotiation\n\
    \   procedure uses an extended ATM ARP message format defined in RFC1577\n   [2].\
    \  The other messages are encapsulated into IP packets.\n   The destination IP\
    \ address in the IP packet header signifies the\n   neighbor node's IP address\
    \ and the source IP address signifies\n   sender's IP address.  Currently, the\
    \ protocol ID for these messages\n   is 110(decimal).  This protocol ID must be\
    \ registered by IANA.\n   The reserved field in the following packet format must\
    \ be zero.\n"
- title: 6.1 Field Format
  contents:
  - '6.1 Field Format

    '
- title: 6.1.1 VCID field
  contents:
  - "6.1.1 VCID field\n   VCID type value decides VCID field format.  Currently, only\
    \ type \"1\"\n   is defined.  The VCID field format of VCID type 1 is shown below.\n\
    \     0                   1                   2                   3\n     0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                    ESI of upstream node                       |\n    +\
    \                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    |     \
    \                          |                               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \                               +\n    |                              ID     \
    \                          |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       ESI field: ESI of upstream node\n       ID       : upstream node decides\
    \ unique identifier.\n"
- title: 6.1.2 Flow ID field
  contents:
  - "6.1.2 Flow ID field\n   Flow ID type value decides flow-ID field format.  Currently,\
    \ flow-ID\n   type \"0\" and \"1\" are defined.  The flow ID type value \"0\"\
    \ signifies\n   that the flow ID field is null.  When flow ID type value is \"\
    1\", the\n   format shown below is used.\n     0                   1         \
    \          2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                   Source IP address                           |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                   Destination IP address                      |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       Source IP address      : source IP address of flow\n       Destination\
    \ IP address : destination IP address of flow\n"
- title: 6.2 PROPOSE message
  contents:
  - "6.2 PROPOSE message\n   PROPOSE message uses the extended ATM-ARP message format\
    \ [2] to which\n   the VCID type and the VCID field are added.  Type & Length\
    \ fields are\n   set to zero, because the messages don't need sender/target ATM\n\
    \   address.  This message is transferred from the upstream node to the\n   downstream\
    \ node through the Dedicated-VC.\n   PROPOSE message is transferred from the upstream\
    \ node to the\n   downstream node through the Dedicated-VC.\n     0          \
    \         1                   2                   3\n     0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Hardware Type = 0x13          |  Protocol Type = 0x0800       |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Type&Length 1 | Type&Length 2 |      Opereation Code          |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |    Length 1   | Type&Length 3 | Type&Length 4 |   Length 2    |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                     Sender IP Address                         |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                     Target IP Address                         |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |   VCID Type   |VCID Length    |       Reserved                |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                        VCID                                   |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Type&Length 1 ; Type & Length of sender ATM number = 0\n    Type&Length 2\
    \ ; Type & Length of sender ATM subnumber = 0\n    Type&Length 3 ; Type & Length\
    \ of sender ATM number = 0\n    Type&Length 4 ; Type & Length of sender ATM subnumber\
    \ =0\n    Length 1      ; Source IP address length\n    Length 2      ; Target\
    \ IP address length\n    Operation code\n             0x10 = PROPOSE\n    VCID\
    \ Type:   Currently , VCID Type = 1 is defined.\n    VCID Length: Length of VCID\
    \ field\n    VCID :       VCID described previous\n"
- title: 6.3 PROPOSE ACK
  contents:
  - "6.3 PROPOSE ACK\n   PROPOSE ACK messages is transferred through the Default-VC.\n\
    \     0                   1                   2                   3\n     0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Version       |Op code = 1    |        Checksum               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | VCID type     |Flow-ID type=0 |         Reserved              |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           VCID                                |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Version\n        This field indicates the version   number of FANP.    Currently,\n\
    \        Version = 1\n    Operation Code\n        This field  indicates the operation\
    \ code   of the message. There\n        are five operation codes, below.\n   \
    \     operation code = 1 : PROPOSE ACK message\n    Checksum\n        This field\
    \ is the 16 bits checksum for whole body of FANP message.\n        The checksum\
    \ algorithm is same as the IP header.\n    VCID Type\n        This field indicates\
    \ the VCID type.  Currently, only \"1\" is\n        defined.\n"
- title: 6.4 OFFER message
  contents:
  - "6.4 OFFER message\n   OFFER message is transferred from an upstream node to a\
    \ downstream\n   node.  The following is the message format.\n     0         \
    \          1                   2                   3\n     0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Version = 1   | Op Code = 2   |        Checksum               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | VCID type     |Flow-ID type   |     Refresh Interval          |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           VCID                                |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                         Flow-ID                               |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Refresh Interval\n        This field indicates the interval of refresh timer.\
    \  The refresh\n        interval is represented by second in integer.  This field\
    \ is\n        used only in OFFER message.  Recommended value is 120 (second).\n"
- title: 6.5 READY message
  contents:
  - "6.5 READY message\n   READY message is transfered from a downstream node to an\
    \ upstream\n   node. This message is transferred when the downstream node receives\n\
    \   OFFER message. And this message is transferred periodically in each\n   refresh\
    \ interval. The following is the message format.\n     0                   1 \
    \                  2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Version = 1   | Op Code = 3   |        Checksum               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | VCID type     |Flow-ID type   |     Reserved                  |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           VCID                                |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                         Flow-ID                               |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n"
- title: 6.6 ERROR message
  contents:
  - "6.6 ERROR message\n   ERROR message is transfered from a downstream node to an\
    \ upstream\n   node or from an upstream node to a downstream node. This message\
    \ is\n   transferred when some of the fields in the receive message is unknown\n\
    \   or refused.  When the receive message is the ERROR message, ERROR\n   message\
    \ isn't sent.  VCID type ,VCID, Flow ID Type and Flow ID field\n   in the ERROR\
    \ message are filled with the same field in the receive\n   message.\n   The following\
    \ is the message format.\n     0                   1                   2     \
    \              3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Version = 1   | Op Code = 4   |        Checksum               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | VCID type     |Flow-ID type   |     Error code                |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           VCID                                |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                         Flow-ID                               |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Error Code = 1 : unknown VCID type\n               = 2 : unknown Flow-ID\
    \ type\n               = 3 : unknown VCID\n               = 4 : resource is unavailable\n\
    \               = 5 : unavailable refresh interval is offered\n              \
    \ = 6 : refuse by policy\n"
- title: 6.7 REMOVE message
  contents:
  - "6.7 REMOVE message\n   REMOVE message is transfered from a downstream node to\
    \ an upstream\n   node or vice versa.  This message is transferred to remove the\n\
    \   mapping relationship between the flow ID and and the VCID. The node\n   which\
    \ receives REMOVE message must send REMOVE ACK message, even when\n   VCID in\
    \ the receive message isn't known .\n   The following is the message format.\n\
    \     0                   1                   2                   3\n     0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Version = 1   | Op Code = 5   |        Checksum               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | VCID type     |Flow-ID type   |     Reserved                  |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           VCID                                |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n"
- title: 6.8 REMOVE ACK message
  contents:
  - "6.8 REMOVE ACK message\n   REMOVE ACK message is transferred from a downstream\
    \ node to an\n   upstream node or from an upstream node to a downstream node.\
    \  The\n   following is the message format.\n     0                   1      \
    \             2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | Version = 1   | Op Code = 6   |        Checksum               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | VCID type     |Flow-ID type   |     Reserved                  |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           VCID                                |\n    /\
    \                                                               /\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n"
- title: 7. Security Considerations
  contents:
  - "7. Security Considerations\n   Security issues are not discussed in this memo.\n"
- title: 8. References
  contents:
  - "8. References\n   [1] Katsube, Y., Nagami, K., and H. Esaki, \"Router Architecture\n\
    \       Extensions for ATM; overview\", Work in Progress.\n   [2] Laubach, M.,\
    \ \"Classical IP and ARP over ATM\", RFC 1577,\n       October 1993.\n   [3] Heinanen,\
    \ J., \"Multiprotocol Encapsulation over ATM Adaptation\n       Layer 5\", RFC\
    \ 1483, July 1993.\n   Ethernet is a registered trademark of Xerox Corp.  All\
    \ other product\n   names mentioned herein may be trademarks of their respective\n\
    \   companies.\n"
- title: 9. Authors' Addresses
  contents:
  - "9. Authors' Addresses\n   Ken-ichi Nagami\n   R&D Center, Toshiba\n   1 Komukai\
    \ Toshiba-cho, Saiwai-ku, Kawasaki 210 Japan\n   Phone : +81-44-549-2238\n   EMail\
    \ : nagami@isl.rdc.toshiba.co.jp\n   Yasuhiro Katsube\n   R&D Center, Toshiba\n\
    \   1 Komukai Toshiba-cho, Saiwai-ku, Kawasaki 210 Japan\n   Phone : +81-44-549-2238\n\
    \   EMail : katsube@isl.rdc.toshiba.co.jp\n   Yasuro Shobatake\n   R&D Center,\
    \ Toshiba\n   1 Komukai Toshiba-cho, Saiwai-ku, Kawasaki 210 Japan\n   Phone :\
    \ +81-44-549-2238\n   Email : masahata@csl.rdc.toshiba.co.jp\n   Akiyoshi Mogi\n\
    \   R&D Center, Toshiba\n   1 Komukai Toshiba-cho, Saiwai-ku, Kawasaki 210 Japan\n\
    \   Phone : +81-44-549-2238\n   EMail : mogi@isl.rdc.toshiba.co.jp\n   Shigeo\
    \ Matsuzawa\n   R&D Center, Toshiba\n   1 Komukai Toshiba-cho, Saiwai-ku, Kawasaki\
    \ 210 Japan\n   Phone : +81-44-549-2238\n   EMail : shigeom@isl.rdc.toshiba.co.jp\n\
    \   Tatsuya Jinmei\n   R&D Center, Toshiba\n   1 Komukai Toshiba-cho, Saiwai-ku,\
    \ Kawasaki 210 Japan\n   Phone : +81-44-549-2238\n   EMail : jinmei@isl.rdc.toshiba.co.jp\n\
    \   Hiroshi Esaki\n   R&D Center, Toshiba\n   1 Komukai Toshiba-cho, Saiwai-ku,\
    \ Kawasaki 210 Japan\n   Phone : +81-44-549-2238\n   EMail : hiroshi@isl.rdc.toshiba.co.jp\n"
