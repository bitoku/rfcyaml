- title: __initial_text__
  contents:
  - "         Keying and Authentication for Routing Protocols (KARP)\n           \
    \       Overview, Threats, and Requirements\n"
- title: Abstract
  contents:
  - "Abstract\n   Different routing protocols employ different mechanisms for securing\n\
    \   protocol packets on the wire.  While most already have some method\n   for\
    \ accomplishing cryptographic message authentication, in many cases\n   the existing\
    \ methods are dated, vulnerable to attack, and employ\n   cryptographic algorithms\
    \ that have been deprecated.  The \"Keying and\n   Authentication for Routing\
    \ Protocols\" (KARP) effort aims to overhaul\n   and improve these mechanisms.\
    \  This document does not contain\n   protocol specifications.  Instead, it defines\
    \ the areas where\n   protocol specification work is needed.  This document is\
    \ a companion\n   document to RFC 6518, \"Keying and Authentication for Routing\n\
    \   Protocols (KARP) Design Guidelines\"; together they form the guidance\n  \
    \ and instruction KARP design teams will use to review and overhaul\n   routing\
    \ protocol transport security.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6862.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2013 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n     1.1.  Terminology  . . . . . . . . . . . . . . . . . .\
    \ . . . . .  4\n     1.2.  Requirements Language  . . . . . . . . . . . . . .\
    \ . . . .  7\n   2.  KARP Effort Overview . . . . . . . . . . . . . . . . . .\
    \ . . .  7\n     2.1.  KARP Scope . . . . . . . . . . . . . . . . . . . . . .\
    \ . .  7\n     2.2.  Incremental Approach . . . . . . . . . . . . . . . . . .\
    \ .  8\n     2.3.  Goals  . . . . . . . . . . . . . . . . . . . . . . . . . .\
    \  9\n     2.4.  Non-Goals  . . . . . . . . . . . . . . . . . . . . . . . . 12\n\
    \     2.5.  Audience . . . . . . . . . . . . . . . . . . . . . . . . . 12\n  \
    \ 3.  Threats  . . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n    \
    \ 3.1.  Threat Sources . . . . . . . . . . . . . . . . . . . . . . 13\n      \
    \ 3.1.1.  OUTSIDERS  . . . . . . . . . . . . . . . . . . . . . . 13\n       3.1.2.\
    \  Unauthorized Key Holder  . . . . . . . . . . . . . . . 14\n         3.1.2.1.\
    \  Terminated Employee  . . . . . . . . . . . . . . . 15\n       3.1.3.  BYZANTINE\
    \  . . . . . . . . . . . . . . . . . . . . . . 15\n     3.2.  Threat Actions In\
    \ Scope  . . . . . . . . . . . . . . . . . 16\n     3.3.  Threat Actions Out of\
    \ Scope  . . . . . . . . . . . . . . . 17\n   4.  Requirements for KARP Work Phase\
    \ 1: Update to a Routing\n       Protocol's Existing Transport Security . . .\
    \ . . . . . . . . . 18\n   5.  Security Considerations  . . . . . . . . . . .\
    \ . . . . . . . . 23\n   6.  Acknowledgements . . . . . . . . . . . . . . . .\
    \ . . . . . . . 24\n   7.  References . . . . . . . . . . . . . . . . . . . .\
    \ . . . . . . 24\n     7.1.  Normative References . . . . . . . . . . . . . .\
    \ . . . . . 24\n     7.2.  Informative References . . . . . . . . . . . . . .\
    \ . . . . 24\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   In March 2006, the Internet Architecture Board (IAB) held\
    \ a workshop\n   on the topic \"Unwanted Internet Traffic\".  The report from\
    \ that\n   workshop is documented in [RFC4948].  Section 8.1 of that document\n\
    \   states, \"A simple risk analysis would suggest that an ideal attack\n   target\
    \ of minimal cost but maximal disruption is the core routing\n   infrastructure\"\
    .  Section 8.2 calls for \"[t]ightening the security of\n   the core routing infrastructure\"\
    .  Four main steps were identified\n   for that tightening:\n   o  Create secure\
    \ mechanisms and practices for operating routers.\n   o  Clean up the Internet\
    \ Routing Registry (IRR) repository, and\n      secure both the database and the\
    \ access to it, so that it can be\n      used for routing verification.\n   o\
    \  Create specifications for cryptographic validation of routing\n      message\
    \ content.\n   o  Secure the routing protocols' packets on the wire\n   The first\
    \ bullet is being addressed in the OPSEC working group.  The\n   second bullet\
    \ should be addressed through liaisons with those running\n   the IRR's globally.\
    \  The third bullet is being addressed in other\n   efforts within the IETF. \
    \ For example, BGP message content validity\n   is being addressed in the SIDR\
    \ working group.\n   This document addresses the last item in the list above,\
    \ securing the\n   transmission of routing protocol packets on the wire.  More\n\
    \   precisely, it focuses on securing the transport systems employed by\n   routing\
    \ protocols, including any mechanisms built into the protocols\n   themselves\
    \ to authenticate packets.  This effort is referred to as\n   Keying and Authentication\
    \ for Routing Protocols, or \"KARP\".  KARP is\n   concerned with issues and techniques\
    \ for protecting the messages\n   between directly communicating peers.  This\
    \ type of protection may\n   overlap with, but is strongly distinct from, protection\
    \ designed to\n   ensure that routing information is properly authorized relative\
    \ to\n   the source of the information.  Such assurances are provided by other\n\
    \   mechanisms and are outside the scope of this document.\n   This document is\
    \ one of two that together form the guidance and\n   instructions for KARP design\
    \ teams working to overhaul routing\n   protocol transport security.  The other\
    \ document is the KARP Design\n   Guide [RFC6518].\n   This document does not\
    \ contain protocol specifications.  Instead, its\n   goal is to define the areas\
    \ where protocol specification work is\n   needed and to provide a set of requirements\
    \ for KARP design teams to\n   follow as they update a routing protocol's existing\
    \ transport\n   security (see Work Phase 1 in Section 4.1 of [RFC6518]).\n   This\
    \ document has three main parts.  The first part, found in Section\n   2, provides\
    \ an overview of the KARP effort.  The second part, in\n   Section 3, lists the\
    \ threats from \"Generic Threats To Routing\n   Protocols\" [RFC4593] that are\
    \ in scope for per-packet authentication\n   for routing protocol transport systems.\
    \  Therefore, this document\n   does not contain a complete threat model; it simply\
    \ points to the\n   parts of the governing threat model that KARP design teams\
    \ must\n   address and explicitly states which parts are out of scope for KARP\n\
    \   design teams.  The third part, in Section 4, enumerates the\n   requirements\
    \ that routing protocol specifications must meet when\n   addressing the threats\
    \ related to KARP's Work Phase 1, the update to\n   a routing protocol's existing\
    \ transport security.  (\"Work Phase 2\", a\n   framework and usage of a Key Management\
    \ Protocol (KMP), will be\n   addressed in a future document[s]).\n"
- title: 1.1.  Terminology
  contents:
  - "1.1.  Terminology\n   This document uses the terminology \"on the wire\" to refer\
    \ to the\n   information used by routing protocols' transport systems.  This term\n\
    \   is widely used in RFCs, but is used in several different ways.  In\n   this\
    \ document, it is used to refer both to information exchanged\n   between routing\
    \ protocol instances and to underlying protocols that\n   may also need to be\
    \ protected in specific circumstances.  Individual\n   protocol analysis documents\
    \ will need to be more specific in their\n   use of this phrase.\n   Additionally,\
    \ within the scope of this document, the following words,\n   when beginning with\
    \ a capital letter, or spelled in all capital\n   letters, hold the meanings described\
    \ in this section.  If the same\n   word is used uncapitalized, then it is intended\
    \ to have its common\n   English definition.\n   Identifier\n      The type and\
    \ value used by a peer of an authenticated message\n      exchange to signify\
    \ who it is to another peer.  The Identifier is\n      used by the receiver as\
    \ an index into a table containing further\n      information about the peer that\
    \ is required to continue processing\n      the message, for example a Security\
    \ Association (SA) or keys.\n   Identity Authentication\n      Once the identity\
    \ is verified, there must be a cryptographic proof\n      of that identity, to\
    \ ensure that the peer really is who it asserts\n      to be.  Proof of identity\
    \ can be arranged among peers in a few\n      ways, for example, symmetric and\
    \ asymmetric pre-shared keys, or an\n      asymmetric key contained in a certificate.\
    \  Certificates can be\n      used in ways that require no additional supporting\
    \ systems\n      external to the routers themselves.  An example of this is using\n\
    \      self-signed certificates and a flat file list of \"approved\n      thumbprints\"\
    .  The different identity verification mechanisms vary\n      in ease of deployment,\
    \ ease of ongoing management, startup effort,\n      security strength, and consequences\
    \ from loss of secrets from one\n      part of the system to the rest of the system.\
    \  For example, they\n      differ in resistance to a security breach, and the\
    \ effort required\n      to recover in the event of such a breach.  The point\
    \ here is that\n      there are options, many of which are quite simple to employ\
    \ and\n      deploy.\n   KDF (Key Derivation Function)\n      A KDF is a function\
    \ in which an input key and other input data are\n      used to generate keying\
    \ material that can be employed by\n      cryptographic algorithms.  The key that\
    \ is input to a KDF is\n      called a key derivation key.  KDFs can be used to\
    \ generate one or\n      more keys from (i) a random or pseudorandom seed value,\
    \ or (ii)\n      the result of the Diffie-Hellman exchange, or (iii) a non-uniform\n\
    \      random source (e.g., from a non-deterministic random bit\n      generator),\
    \ or (iv) a pre-shared key that may or may not be\n      memorable by a human.\n\
    \   KMP (Key Management Protocol)\n      KMP is a protocol that establishes a\
    \ shared symmetric key between\n      a pair (or among a group) of users.  It\
    \ determines how secret keys\n      are made available to the users, and in some\
    \ cases also determines\n      how the secret keys are generated.  In some routing\
    \ protocols, the\n      routing protocol derives the traffic keys from a master\
    \ key.  In\n      this case, KMP is responsible for the master-key generation\
    \ and\n      for determining when the master key should be renewed.  In other\n\
    \      cases, there are only traffic keys (and no master key); in such a\n   \
    \   case, KMP is responsible for the traffic key generation and\n      renewal\
    \ mechanism.\n   KMP Function\n      Any KMP used in the general KARP solution\
    \ framework.\n   Peer Key\n      Peer keys are keys that are used among peers\
    \ as a basis for\n      identifying one another.  These keys may or may not be\
    \ connection\n      specific, depending on how they were established, and what\
    \ forms\n      of identity and identity authentication mechanism are used in the\n\
    \      system.  A peer key generally would be provided by a KMP and would\n  \
    \    later be used to derive fresh traffic keys.\n   PSK (Pre-Shared Key)\n  \
    \    A PSK is a key used to communicate with one or more peers in a\n      secure\
    \ configuration.  It is always distributed out of band prior\n      to a first\
    \ connection.\n   Replayed Messages\n      Replayed messages are genuine messages\
    \ that have been re-sent by\n      an attacker.  Messages may be replayed within\
    \ a session (i.e.,\n      intra-session) or replayed from a different session\
    \ (i.e., inter-\n      session).  For non-TCP-based protocols like OSPF [RFC2328]\
    \ and\n      IS-IS [RFC1195], two routers are said to have a session up if they\n\
    \      are able to exchange protocol packets (i.e., the peers have an\n      adjacency).\
    \  Messages replayed during an adjacency are intra-\n      session replays, while\
    \ a message replayed between two peers who\n      re-establish an adjacency after\
    \ a reboot or loss of connectivity\n      are inter-session replays.\n   Routing\
    \ Protocol\n      This term refers to a Routing Protocol on which a KARP team\
    \ is\n      working to improve the security of its packets on the wire.\n   SA\
    \ (Security Association)\n      An SA is a relationship established between two\
    \ or more entities\n      to enable them to protect the data they exchange.  Examples\
    \ of\n      attributes that may be associated with an SA include Identifier,\n\
    \      PSK, Traffic Key, cryptographic algorithms, and key lifetimes.\n   Threat\
    \ Source\n      A threat source is a motivated, capable adversary.\n   Traffic\
    \ Key\n      A Traffic Key is the key (or one of a set of keys) used for\n   \
    \   protecting the routing protocol traffic.  A traffic key should not\n     \
    \ be a fixed value in a device configuration.  A traffic key should\n      be\
    \ known only to the participants in a connection, so that a\n      compromise\
    \ of a stored key (possibly available to a terminated or\n      turned employee)\
    \ does not result in disclosure of traffic keys.\n      If a server or other data\
    \ store is stolen or compromised, the\n      attackers gain no access to current\
    \ traffic keys.  They may gain\n      access to key-derivation material, like\
    \ a PSK, but not traffic\n      keys currently in use.\n   Additional terminology\
    \ specific to threats are listed and defined\n   below in Section 3.\n"
- title: 1.2.  Requirements Language
  contents:
  - "1.2.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n   When used in lower case, these words convey their\
    \ typical use in\n   common language, and are not to be interpreted as described\
    \ in RFC\n   2119.\n"
- title: 2.  KARP Effort Overview
  contents:
  - '2.  KARP Effort Overview

    '
- title: 2.1.  KARP Scope
  contents:
  - "2.1.  KARP Scope\n   Three basic principles can be used to secure any piece of\
    \ data as it\n   is transmitted over the wire: confidentiality, authenticity,\
    \ and\n   integrity.  The focus for the KARP working group will be message\n \
    \  authentication and message integrity only.  At this time, this work\n   explicitly\
    \ excludes confidentiality.  Non-repudiation is also\n   excluded as a goal at\
    \ this time.  Since the objective of most routing\n   protocols is to broadly\
    \ advertise the routing topology, routing\n   protocol packets are commonly sent\
    \ in the clear; confidentiality is\n   not normally required for routing protocols.\
    \  However, ensuring that\n   routing peers are authentically identified and that\
    \ no rogue peers or\n   unauthenticated packets can compromise the stability of\
    \ the routing\n   environment are critical and thus in scope.  Confidentiality\
    \ and non-\n   repudiation may be addressed in future work.\n   OSPF [RFC5709],\
    \ IS-IS [RFC5310], LDP [RFC5036], and RIP [RFC2453]\n   [RFC4822] already incorporate\
    \ mechanisms for cryptographically\n   authenticating and integrity checking the\
    \ messages on the wire.\n   Products and code that incorporate these mechanisms\
    \ have been\n   produced and have been optimized for these existing security\n\
    \   mechanisms.  Rather than turn away from these mechanisms, this\n   document\
    \ aims to enhance them, updating them to modern and more\n   secure levels.\n\
    \   Therefore, the scope of KARP's roadmap of work includes:\n   o  Making use\
    \ of existing routing protocol transport security\n      mechanisms, where they\
    \ have been specified, and enhancing or\n      updating them as necessary for\
    \ modern cryptographic best\n      practices. [RFC6518], Section 4.1 labels this\
    \ KARP's Work Phase 1.\n   o  Developing a framework for using automatic key management\
    \ in order\n      to ease deployment, lower cost of operation, and allow for rapid\n\
    \      responses to security breaches.  [RFC6518], Section 4.1 labels\n      this\
    \ KARP's Work Phase 2.\n   o  Specifying an automated key management protocol\
    \ that may be\n      combined with Routing Protocol mechanisms.  [RFC6518], Section\
    \ 4.1\n      labels this KARP's Work Phase 2.\n   Neither this document nor [RFC6518]\
    \ contains protocol specifications.\n   Instead, they define the areas in which\
    \ protocol specification work\n   is needed, and they set a direction, a set of\
    \ requirements, and\n   priorities for addressing that specification work.\n \
    \  There are a set of threats to routing protocols that are considered\n   in\
    \ scope for KARP, and a set considered out of scope.  These are\n   described\
    \ in detail in Section 3.\n"
- title: 2.2.  Incremental Approach
  contents:
  - "2.2.  Incremental Approach\n   This document serves as an agreement between the\
    \ Routing Area and the\n   Security Area about the priorities and work plan for\
    \ incrementally\n   delivering the work described in the KARP roadmap above. \
    \ The\n   principle of \"crawl, walk, run\" will be employed.  Thus routing\n\
    \   protocol authentication mechanisms may not go immediately from their\n   current\
    \ state to a state reflecting the best possible, most modern\n   security practices.\
    \  This point is important as there will be times\n   when the best security possible\
    \ will give way to security that is\n   vastly improved over current security\
    \ but that is admittedly not the\n   best security possible, in order that incremental\
    \ progress toward a\n   more secure Internet may be achieved.  As such, this document\
    \ will\n   call out places where agreement has been reached on such trade-offs.\n\
    \   Incremental steps will need to be taken for a few very practical\n   reasons.\
    \  First, there are a considerable number of deployed routing\n   devices in operating\
    \ networks that will not be able to run the most\n   modern cryptographic mechanisms\
    \ without significant and unacceptable\n   performance penalties.  The roadmap\
    \ for any routing protocol MUST\n   allow for incremental improvements on existing\
    \ operational devices.\n   Second, current routing protocol performance on deployed\
    \ devices has\n   been achieved over the last 20 years through extensive tuning\
    \ of\n   software and hardware elements, and is a constant focus for\n   improvement\
    \ by vendors and operators alike.  The introduction of new\n   security mechanisms\
    \ affects this performance balance.  The\n   performance impact of any incremental\
    \ security improvement will need\n   to be weighed by the community and introduced\
    \ in such a way that\n   allows the vendor and operator community a path to adoption\
    \ that\n   upholds reasonable performance metrics.  Therefore, certain\n   specification\
    \ elements may be introduced carrying the \"SHOULD\"\n   guidance, with the intention\
    \ that the same mechanism will carry a\n   \"MUST\" in a future release of the\
    \ specification.  This approach gives\n   the vendors and implementors the guidance\
    \ they need to tune their\n   software and hardware appropriately over time. \
    \ Last, some security\n   mechanisms require the build-out of other operational\
    \ support\n   systems, which will take time.\n   An example where these three\
    \ steps were at play in an incremental\n   improvement roadmap was the improvement\
    \ of BGP's [RFC4271] security\n   via the TCP Authentication Option (TCP-AO) [RFC5925]\
    \ effort.  It\n   would have been ideal, and would have reflected best common\
    \ security\n   practice, to have a fully specified key management protocol for\n\
    \   negotiating the TCP-AO keying material, e.g., using certificates for\n   peer\
    \ authentication.  However, in the spirit of incremental\n   deployment, the IETF\
    \ first addressed issues like cryptographic\n   algorithm agility, replay attacks,\
    \ and the resetting of TCP sessions\n   in the base TCP-AO protocol, and then\
    \ later began work to layer key\n   management on top of these.\n"
- title: 2.3.  Goals
  contents:
  - "2.3.  Goals\n   The goals and general guidance for the KARP work follow:\n  \
    \ 1.  Provide authentication and integrity protection for messages on\n      \
    \ the wire for existing routing protocols.\n   2.  Define a path to incrementally\
    \ improve security of the routing\n       infrastructure as explained in Section\
    \ 2.2.\n   3.  Ensure that the improved security solutions are deployable on\n\
    \       current routing infrastructure.  This requires consideration of\n    \
    \   the current state of processing power available on routers in the\n      \
    \ network today.\n   4.  Operational deployability - A solution's acceptability\
    \ also will\n       be measured by how deployable the solution is by operator\
    \ teams,\n       with consideration for their deployment processes and\n     \
    \  infrastructures.  Specifically, KARP design teams will try to\n       make\
    \ these solutions fit as well as possible into current\n       operational practices\
    \ and router deployment methodologies.  Doing\n       so will depend heavily on\
    \ operator input during KARP design\n       efforts.  Hopefully, operator input\
    \ will lead to a more\n       deployable solution, which will, in turn, lead to\
    \ more production\n       deployments.  Deployment of incrementally more secure\
    \ routing\n       infrastructure in the Internet is the final measure of success.\n\
    \       We would like to see an increase in the number of respondents to\n   \
    \    surveys such as [ISR2008] to report deployment of the updated\n       authentication\
    \ and integrity mechanisms in their networks, as\n       well as see a sharp rise\
    \ in usage of these mechanisms across a\n       greater percentage of their network's\
    \ routers.\n       Interviews with operators show several points about routing\n\
    \       security.  First, according to [ISR2008], over 70% of operators\n    \
    \   have deployed transport connection protection via TCP MD5\n       [RFC3562]\
    \ on their External Border Gateway Protocol (eBGP)\n       sessions.  Over 55%\
    \ also deploy TCP MD5 on their Internal Border\n       Gateway Protocol (iBGP)\
    \ connections, and 50% make use of TCP MD5\n       offered on some other internal\
    \ gateway protocol (IGP).  The same\n       survey states that \"a considerable\
    \ increase was observed over\n       previous editions of the survey for use of\
    \ TCP MD5 with external\n       peers (eBGP), internal peers (iBGP) and MD5 extensions\
    \ for IGPs.\"\n       Though the data is not captured in the report, the authors\n\
    \       believe anecdotally that of those who have deployed TCP MD5\n       somewhere\
    \ in their network, only about 25-30% of the routers in\n       their network\
    \ are deployed with the authentication enabled.  None\n       report using IPsec\
    \ [RFC4301] to protect the routing protocol,\n       which was a decline from\
    \ the few that reported doing so in the\n       previous year's report.  Anecdotal\
    \ evidence from operators using\n       MD5 shows that almost all report using\
    \ one manually distributed\n       key throughout the entire network.  These same\
    \ operators report\n       that the single key has not been changed since it was\
    \ originally\n       installed, sometimes five or more years ago.  When asked\
    \ why,\n       particularly for the case of protecting BGP sessions using TCP\n\
    \       MD5, the following reasons were often given:\n       A. Changing the keys\
    \ triggers a TCP reset, and thus the links/\n          adjacencies bounce, undermining\
    \ Service Level Agreements\n          (SLAs).\n       B. For external peers, it\
    \ is difficult to coordinate with the\n          other organization, and in practice\
    \ the coordination is very\n          cumbersome and tedious to execute.  Once\
    \ the operator finds\n          the correct contact at the other organization\
    \ (not always so\n          easy), the coordination function is serialized and\
    \ performed\n          on a per-peer or per-AS basis.\n       C. Keys must be\
    \ changed at precisely the same time, or at least\n          within 60 seconds\
    \ (as supported by two major vendors) in order\n          to limit the duration\
    \ of a connectivity outage.  This is\n          incredibly difficult to do, operationally,\
    \ especially between\n          different organizations.\n       D. Key change\
    \ is perceived as a relatively low priority compared\n          to other operational\
    \ issues.\n       E. Staff levels are insufficient to implement the changes on\
    \ a\n          device-by-device basis.\n       F. There are three use cases for\
    \ operational peering at play:\n          peers and interconnection with other\
    \ operators, iBGP and other\n          routing sessions within a single operator,\
    \ and operator-to-\n          customer devices.  All three have very different\
    \ properties,\n          and all are reported as cumbersome to manage securely.\
    \  One\n          operator reported that the same key is used for all customer\n\
    \          premise equipment (CPE).  The same operator reported that if\n    \
    \      the customer mandated it, a unique key could be created,\n          although\
    \ the last time this occurred, it created such an\n          operational headache\
    \ that the administrators now usually tell\n          customers that the option\
    \ doesn't even exist, to avoid the\n          difficulties.  These customer-unique\
    \ keys are never changed,\n          unless the customer demands so.  The main\
    \ threat here is that\n          a terminated employee from such an operator who\
    \ had access to\n          the one (or several) keys used for authentication in\
    \ these\n          environments could wage an attack.  Alternatively, the\n  \
    \        operator could offer the keys to others who would wage the\n        \
    \  attack.  In either case, the attacker could then bring down\n          many\
    \ of the adjacencies, thus destabilizing the routing\n          system.\n   5.\
    \  Whatever mechanisms KARP specifies need to be easier to deploy\n       than\
    \ the current methods and should provide obvious operational\n       efficiency\
    \ gains along with significantly better security.  This\n       combination of\
    \ value may be enough to drive much broader\n       adoption.\n   6.  Address\
    \ the threats enumerated below in \"Threats\" (Section 3) for\n       each routing\
    \ protocol.  Not all threats may be able to be\n       addressed in the first\
    \ specification update for any one protocol.\n       Roadmaps will be defined\
    \ so that both the Security Area and the\n       Routing Area agree on how the\
    \ threats will be addressed\n       completely over time.\n   7.  Create a reusable\
    \ architecture, framework, and guidelines for\n       various IETF working groups\
    \ that will address these security\n       improvements for various Routing Protocols.\
    \  The crux of the KARP\n       work is to reuse the architecture, framework,\
    \ and guidelines as\n       much as possible across relevant Routing Protocols.\
    \  For example,\n       designers should aim to reuse the key management protocol\
    \ that\n       will be defined for BGP, which will establish keys for TCP-AO,\n\
    \       for as many other routing protocols with similar characteristics\n   \
    \    and properties as possible.\n   8.  Bridge any gaps between the IETF Routing\
    \ and Security Areas by\n       recording agreements on work items, roadmaps,\
    \ and guidance from\n       the cognizant Area Directors and the Internet Architecture\
    \ Board\n       (IAB).\n"
- title: 2.4.  Non-Goals
  contents:
  - "2.4.  Non-Goals\n   The following goals are considered out of scope for this\
    \ effort:\n   o  Confidentiality and non-repudiation of the packets on the wire.\n\
    \      Once the goals of this roadmap are realized, work on\n      confidentiality\
    \ may be considered.\n   o  Non-repudiation of the packets on the wire.\n   o\
    \  Message content validity (routing database validity).  This work\n      is\
    \ being addressed in other IETF efforts.  For example, BGP\n      message content\
    \ validity is being addressed in the SIDR working\n      group.\n"
- title: 2.5.  Audience
  contents:
  - "2.5.  Audience\n   The audience for this document includes:\n   o  Routing Area\
    \ working group chairs and participants - These people\n      are charged with\
    \ updating Routing Protocol specifications.  Any\n      and all cryptographic\
    \ authentication work on these specifications\n      will occur in Routing Area\
    \ working groups, in close partnership\n      with the Security Area.  Co-advisors\
    \ from the Security Area may\n      often be named for these partnership efforts.\n\
    \   o  Security Area reviewers of Routing Area documents - These people\n    \
    \  are tasked by the Security Area Directors to perform reviews on\n      routing\
    \ protocol specifications as they pass through working group\n      last call\
    \ or IESG review.  Their particular attention to the use\n      of cryptographic\
    \ authentication and newly specified security\n      mechanisms for the routing\
    \ protocols is appreciated.  They also\n      help to ensure that incremental\
    \ security improvements are being\n      made, in line with this roadmap.\n  \
    \ o  Security Area engineers - These people partner with Routing Area\n      authors/designers\
    \ on the security mechanisms in routing protocol\n      specifications.  Some\
    \ of these Security Area engineers will be\n      assigned by the Security Area\
    \ Directors, while others will be\n      interested parties in the relevant working\
    \ groups.\n   o  Operators - The operators are a key audience for this work, as\
    \ the\n      work is considered to have succeeded only if operators deploy the\n\
    \      technology.  It is anticipated that deployment will take place\n      only\
    \ if operators perceive that the improved security offered by\n      the Routing\
    \ Protocol updates warrants the complexity and cost of\n      deployment and operation.\
    \  Conversely, the work will be considered\n      a failure if operators do not\
    \ deploy it, either due to a lack of\n      perceived value or due to perceived\
    \ operational complexity.  As a\n      result, the GROW and OPSEC working groups\
    \ should be kept squarely\n      in the loop as well.\n"
- title: 3.  Threats
  contents:
  - "3.  Threats\n   This document uses the definition of \"threat\" from RFC 4949\n\
    \   [RFC4949]: \"[a] potential for violation of security, which exists\n   when\
    \ there is an entity, circumstance, capability, action, or event\n   that could\
    \ cause harm.\"\n   This section defines the threats that are in scope for the\
    \ KARP\n   effort.  It also lists those threats that are explicitly out of scope\n\
    \   for the KARP effort.  Threats are discussed assuming that no\n   protection\
    \ (i.e., message authentication and message integrity) has\n   been applied to\
    \ routing protocol messages.\n   This document leverages the model described in\
    \ \"Generic Threats to\n   Routing Protocols\" [RFC4593].  Specifically, the threats\
    \ listed below\n   were derived by reviewing [RFC4593], analyzing how the threats\n\
    \   applied to the KARP problem space, and listing the threats that are\n   applicable\
    \ to the work for the KARP design team.  This document\n   categorizes [RFC4593]\
    \ threats into those in scope and those out of\n   scope for KARP.  Each in-scope\
    \ threat is discussed below, and its\n   applicability to the KARP problem space\
    \ is described.  As such, the\n   following text intentionally is not a comprehensive\
    \ threat analysis.\n   Rather, it describes the applicability of the existing\
    \ threat\n   analysis in [RFC4593] to KARP.\n   Note: terms from [RFC4593] appear\
    \ capitalized below -- e.g.\n   OUTSIDERS -- so as to make explicit the term's\
    \ origin, and to enable\n   rapid cross referencing to the source RFC.\n   For\
    \ convenience, a terse definition of most [RFC4593] terms is\n   offered here.\
    \  Those interested in a more thorough description of\n   routing protocol threat\
    \ sources, motivations, consequences, and\n   actions will want to read [RFC4593]\
    \ before continuing here.\n"
- title: 3.1.  Threat Sources
  contents:
  - '3.1.  Threat Sources

    '
- title: 3.1.1.  OUTSIDERS
  contents:
  - "3.1.1.  OUTSIDERS\n   One of the threats that will be addressed in this roadmap\
    \ is the\n   situation in which the source is an OUTSIDER.  An OUTSIDER attacker\n\
    \   may reside anywhere in the Internet, may have the ability to send IP\n   traffic\
    \ to the router, may be able to observe the router's replies,\n   and may even\
    \ control the path for a legitimate peer's traffic.\n   OUTSIDERS are not legitimate\
    \ participants in the routing protocol.\n   The use of message authentication\
    \ and integrity protection\n   specifically aims to identify packets originating\
    \ from OUTSIDERS.\n   KARP design teams will consider two specific use cases of\
    \ OUTSIDERS:\n   those on path, and those off path.\n   o  On Path - These attackers\
    \ have control of a network resource or a\n      tap that sits along the path\
    \ between two routing peers.  A \"Man in\n      the Middle\" (MitM) is an on-path\
    \ attacker.  From this vantage\n      point, the attacker can conduct either active\
    \ or passive attacks.\n      An active attack occurs when the attacker places\
    \ packets on the\n      network as part of the attack.  One active MitM attack\
    \ relevant to\n      KARP, an active wiretapping attack, occurs when the attacker\n\
    \      tampers with packets moving between two legitimate router peers in\n  \
    \    such a way that both peers think they are talking to each other\n      directly,\
    \ when in fact they are actually talking to the attacker.\n      Protocols conforming\
    \ to this roadmap will use cryptographic\n      mechanisms to detect MitM attacks\
    \ and reject packets from such\n      attacks (i.e., discard them as being not\
    \ authentic).  Passive on-\n      path attacks occur when the attacker silently\
    \ gathers data and\n      analyzes it to gain advantage.  Passive activity by\
    \ an on-path\n      attacker may lead to an active attack.\n   o  Off Path - These\
    \ attackers sit on some network outside of that\n      over which the packets\
    \ between two routing peers run.  The source\n      may be one or several hops\
    \ away.  Off-path attackers can launch\n      active attacks, such as SPOOFING\
    \ or denial-of-service (DoS)\n      attacks, to name a few.\n"
- title: 3.1.2.  Unauthorized Key Holder
  contents:
  - "3.1.2.  Unauthorized Key Holder\n   This threat source exists when an unauthorized\
    \ entity somehow manages\n   to gain access to keying material.  Using this material,\
    \ the attacker\n   could send packets that pass the authenticity checks based\
    \ on Message\n   Authentication Codes (MACs).  The resulting traffic might appear\
    \ to\n   come from router A and be destined for router B, and thus the\n   attacker\
    \ could impersonate an authorized peer.  The attacker could\n   then adversely\
    \ affect network behavior by sending bogus messages that\n   appear to be authentic.\
    \  The attack source possessing the\n   unauthorized keys could be on path, off\
    \ path, or both.\n   The obvious mitigation for an unauthorized key holder is\
    \ to change\n   the keys currently in use by the legitimate routing peers.  This\n\
    \   mitigation can be either reactive or proactive.  Reactive mitigation\n   occurs\
    \ when keys are changed only after one has discovered that the\n   previous keys\
    \ have fallen into the possession of unauthorized users.\n   The reactive mitigation\
    \ case is highlighted here in order to explain\n   a common operational situation\
    \ where new keying material will need to\n   be put in place with little or no\
    \ advanced warning.  In such a case,\n   new keys must be able to be installed\
    \ and put into use very quickly,\n   and with little operational expense.  Proactive\
    \ mitigation occurs\n   when an operator assumes that unauthorized possession\
    \ will occur from\n   time to time without being discovered, and the operator\
    \ moves to new\n   keying material in order to cut short an attacker's window\
    \ of\n   opportunity to use the stolen keys effectively.\n   KARP design teams\
    \ can address this type of attack by creating\n   specifications that make it\
    \ practical for the operator to quickly\n   change keys without disruption to\
    \ the routing system and with minimal\n   operational overhead.  Operators can\
    \ further mitigate threats from\n   unauthorized key holders by regularly changing\
    \ keys.\n"
- title: 3.1.2.1.  Terminated Employee
  contents:
  - "3.1.2.1.  Terminated Employee\n   A terminated employee is an important example\
    \ of an unauthorized key\n   holder.  Staff attrition is a reality in routing\
    \ operations and is\n   therefore a potential threat source.  The threat source\
    \ risk arises\n   when a network operator who had been granted access to keys\
    \ ceases to\n   be an employee.  If new keys are deployed immediately, the situation\n\
    \   of a terminated employee can become an \"unauthorized key holder,\n   proactive\"\
    \ case, as described above, rather than an \"unauthorized key\n   holder, reactive\
    \ mitigation\" case.  It behooves the operator to\n   change the keys, to enforce\
    \ the revocation of authorization of the\n   old keys, in order to minimize the\
    \ threat source's window of\n   opportunity.\n   A terminated employee is a valid\
    \ unauthorized key holder threat\n   source for KARP, and designs should address\
    \ the associated threats.\n   For example, new keys must be able to be installed\
    \ and made\n   operational in the routing protocols very quickly, with zero impact\n\
    \   to the routing system, and with little operational expense.  The\n   threat\
    \ actions associated with a terminated employee also motivate\n   the need to\
    \ change the keys quickly, also with little operational\n   expense.\n"
- title: 3.1.3.  BYZANTINE
  contents:
  - "3.1.3.  BYZANTINE\n   According to [RFC4593], Section 3.1.1.2, BYZANTINE \"attackers\
    \ are\n   faulty, misconfigured, or subverted routers; i.e., legitimate\n   participants\
    \ in the routing protocol\", whose messages cause routing\n   to malfunction.\n\
    \   [RFC4593] goes on to say that \"[s]ome adversaries can subvert\n   routers,\
    \ or the management workstations used to control these\n   routers.  These Byzantine\
    \ failures represent the most serious form of\n   attack capability in that they\
    \ result in emission of bogus traffic by\n   legitimate routers.\"\n   [RFC4593]\
    \ explains that \"[d]eliberate attacks are mimicked by\n   failures that are random\
    \ and unintentional.  In particular, a\n   Byzantine failure in a router may occur\
    \ because the router is faulty\n   in hardware or software or is misconfigured\"\
    , and thus routing\n   malfunctions unintentionally.  Although not malicious,\
    \ such\n   occurrences still disrupt network operation.\n   Whether faulty, misconfigured,\
    \ or subverted, Byzantine routers have\n   an empowered position from which to\
    \ provide believable yet bogus\n   routing messages that are damaging to the network.\n"
- title: 3.2.  Threat Actions In Scope
  contents:
  - "3.2.  Threat Actions In Scope\n   The following THREAT ACTIONS are in scope for\
    \ KARP:\n   o  SPOOFING - when an unauthorized device assumes the identity of\
    \ an\n      authorized one.  Spoofing is special in that it can be used to\n \
    \     carry out other threat actions that cause other threat\n      consequences.\
    \  SPOOFING can be used, for example, to inject\n      malicious routing information\
    \ that causes the disruption of\n      network services.  SPOOFING can also be\
    \ used to cause a neighbor\n      relationship to form that subsequently denies\
    \ the formation of the\n      relationship with a legitimate router.\n   o  DoS\
    \ attacks\n      A.  At the transport layer - This occurs when an attacker sends\n\
    \          packets aimed at halting or preventing the underlying protocol\n  \
    \        over which the routing protocol runs.  The attacker could use\n     \
    \     SPOOFING, FALSIFICATION, or INTERFERENCE (see below) to\n          produce\
    \ the DoS attack.  For example, BGP running over\n          Transport Layer Security\
    \ (TLS) will still not solve the\n          problem of an attacker being able\
    \ to send a spoofed TCP FIN or\n          TCP RST and causing the BGP session\
    \ to go down.  Since these\n          attacks depend on spoofing, operators are\
    \ encouraged to deploy\n          proper authentication mechanisms to prevent\
    \ them.\n          Specification work should ensure that Routing Protocols can\n\
    \          operate over transport subsystems in a fashion that is\n          resilient\
    \ to such DoS attacks.\n      B.  Using the authentication mechanism - This includes\
    \ an attacker\n          causing INTERFERENCE, which inhibits exchanges of legitimate\n\
    \          routers.  The attack is often perpetrated by sending packets\n    \
    \      that confuse or overwhelm a security mechanism itself.  An\n          example\
    \ is initiating an overwhelming load of spoofed routing\n          protocol packets\
    \ that contain a MAC (i.e., INSERTING\n          MESSAGES), so that the receiver\
    \ spends substantial CPU\n          resources on the processing cycles to check\
    \ the MAC, only to\n          discard the spoofed packet.  Other types of INTERFERENCE\n\
    \          include REPLAYING OUT-DATED PACKETS, CORRUPTING MESSAGES, and\n   \
    \       BREAKING SYNCHRONIZATION.\n   o  FALSIFICATION - An action whereby an\
    \ attacker sends false routing\n      information.  This document targets only\
    \ FALSIFICATION from\n      OUTSIDERS that may occur from tampering with packets\
    \ in flight or\n      sending entirely false messages.  FALSIFICATION from BYZANTINES\n\
    \      (see Section 3.3) are not addressed by the KARP effort.\n   o  Brute-Force\
    \ Attacks Against Password/Keys - This includes either\n      online or offline\
    \ attacks in which attempts are made repeatedly\n      using different keys/passwords\
    \ until a match is found.  While it\n      is impossible to make brute-force attacks\
    \ on keys completely\n      unsuccessful, proper design can make it much harder\
    \ for such\n      attacks to succeed.  For example, current guidance for the\n\
    \      security strength of an algorithm with a particular key length\n      should\
    \ be deemed acceptable for a period of 10 years.  (Section 10\n      of [SP.800-131A]\
    \ is one source for guidance.)  Using per-session\n      keys is another widely\
    \ used method for reducing the number of\n      brute-force attacks, as this would\
    \ make it difficult to guess the\n      keys.\n"
- title: 3.3.  Threat Actions Out of Scope
  contents:
  - "3.3.  Threat Actions Out of Scope\n   BYZANTINE sources -- be they faulty, misconfigured,\
    \ or subverted --\n   are out of scope for this roadmap.  KARP works to cryptographically\n\
    \   ensure that received routing messages originated from authorized\n   peers\
    \ and that the message was not altered in transit.  Formation of\n   a bogus message\
    \ by a valid and authorized peer falls outside the KARP\n   scope.  Any of the\
    \ attacks described in Section 3.2 that may be\n   levied by a BYZANTINE source\
    \ are therefore also out of scope, e.g.\n   FALSIFICATION from BYZANTINE sources\
    \ or unauthorized message content\n   by a legitimate authorized peer.\n   In\
    \ addition, these other attack actions are out of scope for this\n   work:\n \
    \  o  SNIFFING (passive wiretapping) - Passive observation of route\n      message\
    \ contents in flight.  Data confidentiality, as achieved by\n      data encryption,\
    \ is the common mechanism for preventing SNIFFING.\n      While useful, especially\
    \ to prevent the gathering of data needed\n      to perform an off-path packet\
    \ injection attack, data encryption is\n      out of scope for KARP.\n   o  INTERFERENCE\
    \ due to:\n      A.  NOT FORWARDING PACKETS - Cannot be prevented with\n     \
    \     cryptographic authentication.  Note: If sequence numbers with\n        \
    \  sliding windows are used in the solution (as is done, for\n          example,\
    \ in Bidirectional Forwarding Detection (BFD)\n          [RFC5880]), a receiver\
    \ can at least detect the occurrence of\n          this attack.\n      B.  DELAYING\
    \ MESSAGES - Cannot be prevented with cryptographic\n          authentication.\
    \  Note: Timestamps can be used to detect\n          delays.\n      C.  DENIAL\
    \ OF RECEIPT (non-repudiation) - Cannot be prevented with\n          cryptographic\
    \ authentication.\n      D.  UNAUTHORIZED MESSAGE CONTENT - Covered by the work\
    \ of the\n          IETF's SIDR working group\n          (http://www.ietf.org/html.charters/sidr-charter.html).\n\
    \      E.  DoS attacks not involving the routing protocol.  For example,\n   \
    \       a flood of traffic that fills the link ahead of the router, so\n     \
    \     that the router is rendered unusable and unreachable by valid\n        \
    \  packets is NOT an attack that KARP will address.  Many such\n          examples\
    \ could be contrived.\n"
- title: '4.  Requirements for KARP Work Phase 1: Update to a Routing Protocol''s'
  contents:
  - "4.  Requirements for KARP Work Phase 1: Update to a Routing Protocol's\n    Existing\
    \ Transport Security\n   Section 4.1 of the KARP Design Guide [RFC6518] describes\
    \ two distinct\n   work phases for the KARP effort.  This section addresses requirements\n\
    \   for the first work phase only, Work Phase 1, the update to a routing\n   protocol's\
    \ existing transport security.  Work Phase 2, the framework\n   and usage of a\
    \ KMP, will be addressed in a future document(s).\n   The following list of requirements\
    \ SHOULD be addressed by a KARP Work\n   Phase 1 security update to any Routing\
    \ Protocol (according to section\n   4.1 of the KARP Design Guide [RFC6518]document).\
    \  IT IS RECOMMENDED\n   that any Work Phase 1 security update to a Routing Protocol\
    \ contain a\n   section of the specification document that describes how each\
    \ of the\n   following requirements are met.  It is further RECOMMENDED that\n\
    \   justification be presented for any requirements that are NOT\n   addressed.\n\
    \   1.   Clear definitions of which elements of the transmitted data\n       \
    \ (frame, packet, segment, etc.) are protected by an\n        authentication/integrity\
    \ mechanism.\n   2.   Strong cryptographic algorithms, as defined and accepted\
    \ by the\n        IETF security community, MUST be specified.  The use of non-\n\
    \        standard or unpublished algorithms MUST be avoided.\n   3.   Algorithm\
    \ agility for the cryptographic algorithms used in the\n        authentication\
    \ MUST be specified, and protocol specifications\n        MUST be clear regarding\
    \ how new algorithms are specified and\n        used within the protocol.  This\
    \ requirement exists because\n        research identifying weaknesses in cryptographic\
    \ algorithms can\n        cause the security community to reduce confidence in\
    \ some\n        algorithms.  Breaking a cipher isn't a matter of if, but when\
    \ it\n        will occur.  Having the ability to specify alternate algorithms\n\
    \        (algorithm agility) within the protocol specification to support\n  \
    \      such an event is essential.  Additionally, more than one\n        algorithm\
    \ MUST be specified.  Mandating support for two\n        algorithms (i.e., one\
    \ mandatory to implement algorithm and one\n        or more backup algorithms\
    \ to guide transition) provides both\n        redundancy, and a mechanism for\
    \ enacting that redundancy.\n   4.   Secure use of PSKs, offering both operational\
    \ convenience and a\n        baseline level of security, MUST be specified.\n\
    \   5.   Routing Protocols (or the transport or network mechanism\n        protecting\
    \ routing protocols) SHOULD be able to detect and\n        reject replayed intra-session\
    \ and inter-session messages.\n        Packets captured from one session MUST\
    \ NOT be able to be resent\n        and accepted during a later session (i.e.,\
    \ inter-session\n        replay).  Additionally, replay mechanisms MUST work correctly\n\
    \        even in the presence of routing protocol packet prioritization\n    \
    \    by the router.\n        There is a specific case of replay attack combined\
    \ with spoofing\n        that must be addressed.  Several routing protocols (e.g.,\
    \ OSPF\n        [RFC2328], IS-IS [RFC1195], BFD [RFC5880], RIP [RFC2453], etc.),\n\
    \        require all speakers to share the same authentication and\n        message\
    \ association key on a broadcast segment.  It is important\n        that an integrity\
    \ check associated with a message fail if an\n        attacker has replayed the\
    \ message with a different origin.\n   6.   A change of security parameters MUST\
    \ force a change of session\n        traffic keys.  The specific security parameters\
    \ for the various\n        routing protocols will differ and will be defined by\
    \ each\n        protocol design team.  Some examples may include master key, key\n\
    \        lifetime, and cryptographic algorithm.  If one of these\n        configured\
    \ parameters changes, then a new session traffic key\n        MUST immediately\
    \ be established using the updated parameters.\n        The routing protocol security\
    \ mechanisms MUST support this\n        behavior.\n   7.   Security mechanisms\
    \ MUST specify a means to affect intra-session\n        rekeying without disrupting\
    \ a routing session.  This should be\n        accomplished without data loss,\
    \ if possible.  Keys may need to\n        be changed periodically based on policy\
    \ or when an administrator\n        who had access to the keys leaves an organization.\
    \  A rekeying\n        mechanism enables the operators to execute the change without\n\
    \        productivity loss.\n   8.   Rekeying SHOULD be supported in such a way\
    \ that it can occur\n        during a session without the peer needing to use\
    \ multiple keys\n        to validate a given packet.  The rare exception will\
    \ occur if a\n        routing protocol's design team can find no other way to\
    \ rekey\n        and still adhere to the other requirements in this section. \
    \ The\n        specification SHOULD include a key identifier, which allows\n \
    \       receivers to choose the correct key (or determine that they are\n    \
    \    not in possession of the correct key).\n   9.   New mechanisms MUST resist\
    \ DoS attacks described as in scope in\n        Section 3.2.  Routers protect\
    \ the control plane by implementing\n        mechanisms to reject completely or\
    \ rate-limit traffic not\n        required at the control-plane level (i.e., unwanted\
    \ traffic).\n        Typically, line-rate packet-filtering capabilities look at\n\
    \        information in the IP and transport (TCP or UDP) headers, but do\n  \
    \      not include higher-layer information.  Therefore, the new\n        mechanisms\
    \ should neither hide nor encrypt the information\n        carried in the IP and\
    \ transport layers in control-plane packets.\n   10.  Mandatory cryptographic\
    \ algorithms and mechanisms MUST be\n        specified for each routing protocol\
    \ security mechanism.\n        Further, the protocol specification MUST define\
    \ default security\n        mechanism settings for all implementations to use\
    \ when no\n        explicit configuration is provided.  To understand the need\
    \ for\n        this requirement, consider the case where a routing protocol\n\
    \        mandates three different cryptographic algorithms for a MAC\n       \
    \ operation.  If company A implements algorithm 1 as the default\n        for\
    \ this protocol, while company B implements algorithm 2 as the\n        default,\
    \ then two operators who enable the security mechanism\n        with no explicit\
    \ configuration other than a PSK will experience\n        a connection failure.\
    \  It is not enough that each implementation\n        implement the three mandatory\
    \ algorithms; one default must\n        further be specified in order to gain\
    \ maximum out-of-the-box\n        interoperability.\n   11.  For backward-compatibility\
    \ reasons, manual keying MUST be\n        supported.\n   12.  The specification\
    \ MUST consider and allow for future use of a\n        KMP.\n   13.  The authentication\
    \ mechanism in a Routing Protocol MUST be\n        decoupled from the key management\
    \ system used.  The\n        authentication protocol MUST include a specification\
    \ for\n        agreeing on keying material.  This will accommodate both manual\n\
    \        keying and the use of KMPs.\n   14.  Convergence times of the Routing\
    \ Protocols SHOULD NOT be\n        materially affected.  Changes in the convergence\
    \ time will be\n        immediately and independently verifiable by convergence\n\
    \        performance test beds already in use (e.g. those maintained by\n    \
    \    router vendors, service providers, and researchers).  An\n        increase\
    \ in convergence time in excess of 5% is likely to be\n        considered to have\
    \ materially affected convergence by network\n        operators.  A number of\
    \ other factors can also change\n        convergence over time (e.g., speed of\
    \ processors used on\n        individual routing peers, processing power increases\
    \ due to\n        Moore's law, and implementation specifics), and implementors\n\
    \        will need to take into account the effect of an authentication\n    \
    \    mechanism on Routing Protocols.  Protocol designers should\n        consider\
    \ the impact on convergence times as a function of both\n        the total number\
    \ of protocol packets that must be exchanged and\n        the required computational\
    \ processing of individual messages in\n        the specification, understanding\
    \ that the operator community's\n        threshold for an increase in convergence\
    \ times is very low, as\n        stated above.\n   15.  The changes to or addition\
    \ of security mechanisms SHOULD NOT\n        cause a refresh of route advertisements\
    \ or cause additional\n        route advertisements to be generated.\n   16. \
    \ Router implementations provide prioritized treatment for certain\n        protocol\
    \ packets.  For example, OSPF Hello and Acknowledgement\n        packets are prioritized\
    \ for processing above other OSPF packets.\n        The security mechanism SHOULD\
    \ NOT interfere with the ability to\n        observe and enforce such prioritization.\
    \  Any effect on such\n        priority mechanisms MUST be explicitly documented\
    \ and justified.\n        Replay protection mechanisms provided by the routing\
    \ protocols\n        MUST work even if certain protocol packets are offered\n\
    \        prioritized treatment.\n   17.  The Routing Protocol MUST send minimal\
    \ information regarding the\n        authentication mechanisms and associated\
    \ parameters in its\n        protocol packets.  This keeps the Routing Protocols\
    \ as clean and\n        focused as possible, and loads security negotiations into\
    \ the\n        KMP as much as possible.  This also avoids exposing any security\n\
    \        negotiation information unnecessarily to possible attackers on\n    \
    \    the path.\n   18.  Routing Protocols that rely on the IP header (or information\n\
    \        separate from routing protocol payload) to identify the neighbor\n  \
    \      that originated the packet MUST either protect the IP header or\n     \
    \   provide some other means to authenticate the neighbor.\n        [RFC6039]\
    \ describes some attacks that motivate this requirement.\n   19.  Every new KARP-developed\
    \ security mechanisms MUST support\n        incremental deployment.  It will not\
    \ be feasible to deploy a new\n        Routing Protocol authentication mechanism\
    \ throughout a network\n        instantaneously.  Indeed, it may not actually\
    \ be feasible to\n        deploy such a mechanism to all routers in a large autonomous\n\
    \        system (AS) in a bounded timeframe.  Proposed solutions MUST\n      \
    \  support an incremental deployment method that benefits those who\n        participate.\
    \  Because of this, there are several requirements\n        that any proposed\
    \ KARP mechanism should consider.\n        A.  The Routing Protocol security mechanism\
    \ MUST enable each\n            router to configure use of the security mechanism\
    \ on a per-\n            peer basis where the communication is peer to peer\n\
    \            (unicast).\n        B.  Every new KARP-developed security mechanism\
    \ MUST provide\n            backward compatibility with respect to message formatting,\n\
    \            transmission, and processing of routing information carried\n   \
    \         through secure and non-secure security environments.\n            Message\
    \ formatting in a fully secured environment MAY be\n            handled in a non-backward-compatible\
    \ fashion, though care\n            must be taken to ensure that routing protocol\
    \ packets can\n            traverse intermediate routers that don't support the\
    \ new\n            format.\n        C.  In an environment where both secured and\
    \ non-secured routers\n            are interoperating, a mechanism MUST exist\
    \ for secured\n            systems to identify whether a peer intended the messages\
    \ to\n            be secured.\n        D.  In an environment where secured service\
    \ is in the process of\n            being deployed, a mechanism MUST exist to\
    \ support a\n            transition free of service interruption (caused by the\n\
    \            deployment per se).\n   20.  The introduction of mechanisms to improve\
    \ routing security may\n        increase the processing performed by a router.\
    \  Since most of\n        the currently deployed routers do not have hardware\
    \ to\n        accelerate cryptographic operations, these operations could\n  \
    \      impose a significant processing burden under some circumstances.\n    \
    \    Thus, proposed solutions SHOULD be evaluated carefully with\n        regard\
    \ to the processing burden they may impose, since\n        deployment may be impeded\
    \ if network operators perceive that a\n        solution will impose a processing\
    \ burden that either incurs\n        substantial capital expense or threatens\
    \ to degrade router\n        performance.\n   21.  New authentication and security\
    \ mechanisms should not rely on\n        systems external to the routing system\
    \ (the equipment that is\n        performing forwarding) in order for the routing\
    \ system to be\n        secure.  In order to ensure the rapid initialization and/or\n\
    \        return to service of failed nodes, it is important to reduce\n      \
    \  reliance on these external systems to the greatest extent\n        possible.\
    \  Proposed solutions SHOULD NOT require connections to\n        external systems,\
    \ beyond those directly involved in peering\n        relationships, in order to\
    \ return to full service.  It is,\n        however, acceptable for the proposed\
    \ solutions to require post-\n        initialization synchronization with external\
    \ systems in order to\n        fully synchronize security associations.\n    \
    \    If authentication and security mechanisms rely on systems\n        external\
    \ to the routing system, then there MUST be one or more\n        options available\
    \ to avoid circular dependencies.  It is not\n        acceptable to have a routing\
    \ protocol (e.g., unicast routing)\n        depend upon correct operation of a\
    \ security protocol that, in\n        turn, depends upon correct operation of\
    \ the same instance of\n        that routing protocol (i.e., the unicast routing).\
    \  However, it\n        is acceptable to have operation of a routing protocol\
    \ (e.g.,\n        multicast routing) depend upon operation of a security protocol,\n\
    \        which depends upon an independent routing protocol (e.g.,\n        unicast\
    \ routing).  Similarly, it would be okay to have the\n        operation of a routing\
    \ protocol depend upon a security protocol,\n        which in turn uses an out-of-band\
    \ network to exchange\n        information with remote systems.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   This document is mostly about security considerations\
    \ for the KARP\n   efforts, both threats and the requirements for addressing those\n\
    \   threats.  More detailed security considerations are provided in the\n   Security\
    \ Considerations section of the KARP Design Guide\n   [RFC6518]document.\n   The\
    \ use of a group key between a set of Routing Protocol peers has\n   special security\
    \ considerations.  Possession of the group key itself\n   is used for identity\
    \ validation; no other identity check is used.\n   Under these conditions, an\
    \ attack exists when one peer masquerades as\n   a neighbor by using the neighbor's\
    \ source IP address.  This type of\n   attack has been well documented in the\
    \ group-keying problem space,\n   and it is non-trivial to solve.  Solutions exist\
    \ within the group-\n   keying realm, but they come with significant increases\
    \ in complexity\n   and computational intensity.\n"
- title: 6.  Acknowledgements
  contents:
  - "6.  Acknowledgements\n   The majority of the text for initial draft of this document\
    \ was taken\n   from \"Roadmap for Cryptographic Authentication of Routing Protocol\n\
    \   Packets on the Wire\", authored by Gregory M. Lebovitz.\n   Brian Weis provided\
    \ significant assistance in handling the many\n   comments that came back during\
    \ IESG review, including making textual\n   edits directly to the XML.  For his\
    \ extensive efforts he was added as\n   an author.\n   We would like to thank\
    \ the following people for their thorough\n   reviews and comments: Brian Weis,\
    \ Yoshifumi Nishida, Stephen Kent,\n   Vishwas Manral, Barry Leiba, Sean Turner,\
    \ and Uma Chunduri.\n   Author Gregory M. Lebovitz was employed at Juniper Networks,\
    \ Inc. for\n   much of the time he worked on this document, though not at the\
    \ time\n   of its publishing.  Thus, Juniper sponsored much of this effort.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC2119]      Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                  Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC4593]      Barbir, A., Murphy, S., and Y. Yang, \"Generic\
    \ Threats\n                  to Routing Protocols\", RFC 4593, October 2006.\n\
    \   [RFC4948]      Andersson, L., Davies, E., and L. Zhang, \"Report from\n  \
    \                the IAB workshop on Unwanted Traffic March 9-10,\n          \
    \        2006\", RFC 4948, August 2007.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [ISR2008]      McPherson, D. and C. Labovitz,\
    \ \"Worldwide\n                  Infrastructure Security Report\", October 2008,\n\
    \                  <http://pages.arbornetworks.com/rs/arbor/images/\n        \
    \          ISR2008_EN.pdf>.\n   [RFC1195]      Callon, R., \"Use of OSI IS-IS\
    \ for routing in TCP/IP\n                  and dual environments\", RFC 1195,\
    \ December 1990.\n   [RFC2328]      Moy, J., \"OSPF Version 2\", STD 54, RFC 2328,\n\
    \                  April 1998.\n   [RFC2453]      Malkin, G., \"RIP Version 2\"\
    , STD 56, RFC 2453,\n                  November 1998.\n   [RFC3562]      Leech,\
    \ M., \"Key Management Considerations for the TCP\n                  MD5 Signature\
    \ Option\", RFC 3562, July 2003.\n   [RFC4271]      Rekhter, Y., Ed., Li, T.,\
    \ Ed., and S. Hares, Ed., \"A\n                  Border Gateway Protocol 4 (BGP-4)\"\
    , RFC 4271,\n                  January 2006.\n   [RFC4301]      Kent, S. and K.\
    \ Seo, \"Security Architecture for the\n                  Internet Protocol\"\
    , RFC 4301, December 2005.\n   [RFC4822]      Atkinson, R. and M. Fanto, \"RIPv2\
    \ Cryptographic\n                  Authentication\", RFC 4822, February 2007.\n\
    \   [RFC4949]      Shirey, R., \"Internet Security Glossary, Version 2\",\n  \
    \                FYI 36, RFC 4949, August 2007.\n   [RFC5036]      Andersson,\
    \ L., Ed., Minei, I., Ed., and B. Thomas,\n                  Ed., \"LDP Specification\"\
    , RFC 5036, October 2007.\n   [RFC5310]      Bhatia, M., Manral, V., Li, T., Atkinson,\
    \ R., White,\n                  R., and M. Fanto, \"IS-IS Generic Cryptographic\n\
    \                  Authentication\", RFC 5310, February 2009.\n   [RFC5709]  \
    \    Bhatia, M., Manral, V., Fanto, M., White, R., Barnes,\n                 \
    \ M., Li, T., and R. Atkinson, \"OSPFv2 HMAC-SHA\n                  Cryptographic\
    \ Authentication\", RFC 5709, October 2009.\n   [RFC5880]      Katz, D. and D.\
    \ Ward, \"Bidirectional Forwarding\n                  Detection (BFD)\", RFC 5880,\
    \ June 2010.\n   [RFC5925]      Touch, J., Mankin, A., and R. Bonica, \"The TCP\n\
    \                  Authentication Option\", RFC 5925, June 2010.\n   [RFC6039]\
    \      Manral, V., Bhatia, M., Jaeggli, J., and R. White,\n                  \"\
    Issues with Existing Cryptographic Protection Methods\n                  for Routing\
    \ Protocols\", RFC 6039, October 2010.\n   [RFC6518]      Lebovitz, G. and M.\
    \ Bhatia, \"Keying and Authentication\n                  for Routing Protocols\
    \ (KARP) Design Guidelines\",\n                  RFC 6518, February 2012.\n  \
    \ [SP.800-131A]  Barker, E. and A. Roginsky, \"Transitions:\n                \
    \  Recommendation for Transitioning the Use of\n                  Cryptographic\
    \ Algorithms and Key Lengths\", United\n                  States of America, National\
    \ Institute of Science and\n                  Technology, NIST Special Publication\
    \ 800-131A,\n                  January 2011.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Gregory Lebovitz\n   Aptos, California  95003\n   United\
    \ States\n   EMail: gregory.ietf@gmail.com\n   Manav Bhatia\n   Alcatel-Lucent\n\
    \   Bangalore,\n   India\n   EMail: manav.bhatia@alcatel-lucent.com\n   Brian\
    \ Weis\n   Cisco Systems\n   170 W. Tasman Drive\n   San Jose, California  95134-1706\n\
    \   United States\n   EMail: bew@cisco.com\n   URI:   http://www.cisco.com\n"
