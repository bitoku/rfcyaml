- title: __initial_text__
  contents:
  - ' Quality of Service (QoS) Signaling in a Nested Virtual Private Network

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The IETF Trust (2007).\n"
- title: Abstract
  contents:
  - "Abstract\n   Some networks require communication between an interior and exterior\n\
    \   portion of a Virtual Private Network (VPN) or through a concatenation\n  \
    \ of such networks resulting in a nested VPN, but have sensitivities\n   about\
    \ what information is communicated across the boundary,\n   especially while providing\
    \ quality of service to communications with\n   different precedence.  This note\
    \ seeks to outline the issues and the\n   nature of the proposed solutions based\
    \ on the framework for\n   Integrated Services operation over Diffserv networks\
    \ as described in\n   RFC 2998.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Problem Statement ..........................................3\n  \
    \    1.2. Background Information and Terminology .....................4\n    \
    \  1.3. Nested VPNs ................................................5\n      1.4.\
    \ Signaled QoS Technology ....................................7\n      1.5. The\
    \ Resource Reservation Protocol (RSVP) ...................9\n      1.6. Logical\
    \ Structure of a VPN Router .........................10\n   2. Reservation and\
    \ Preemption in a Nested VPN .....................13\n      2.1. Reservation in\
    \ a Nested VPN ...............................14\n      2.2. Preemption in a Nested\
    \ VPN ................................16\n      2.3. Working through an Example\
    \ ................................17\n           2.3.1. Initial Routine Reservations\
    \ - Generating\n                  Network State ......................................18\n\
    \           2.3.2. Initial Routine Reservations - Request\n                  Reservation\
    \ ........................................19\n           2.3.3. Installation of\
    \ a Reservation Using Precedence .....20\n           2.3.4. Installation of a\
    \ Reservation Using Preemption .....21\n   3. Data Flows within a VPN Router .................................24\n\
    \      3.1. VPN Routers That Carry Data across the\n           Cryptographic Boundary\
    \ ....................................24\n           3.1.1. Plaintext to Ciphertext\
    \ Data Flows .................24\n           3.1.2. Ciphertext to Plaintext Data\
    \ Flows .................27\n      3.2. VPN Routers That Use the Network Guard\
    \ for\n           Signaling across the Cryptographic Boundary ...............28\n\
    \           3.2.1. Signaling Flow .....................................29\n  \
    \         3.2.2. Use Case with Network Guard ........................30\n   4.\
    \ Security Considerations ........................................33\n   5. Acknowledgements\
    \ ...............................................34\n   6. References .....................................................34\n\
    \      6.1. Normative References ......................................34\n  \
    \    6.2. Informative References ....................................35\n"
- title: 1.  Introduction
  contents:
  - '1.  Introduction

    '
- title: 1.1.  Problem Statement
  contents:
  - "1.1.  Problem Statement\n   More and more networks wish to guarantee secure transmission\
    \ of IP\n   traffic across public LANs or WANs and therefore use Virtual Private\n\
    \   Networks.  Some networks require communication between an interior\n   and\
    \ exterior portion of a VPN or through a concatenation of such\n   networks resulting\
    \ in a nested VPN, but have sensitivities about what\n   information is communicated\
    \ across the boundary, especially while\n   providing quality of service to communications\
    \ with different\n   precedence.  This note seeks to outline the issues and the\
    \ nature of\n   the proposed solutions.  The outline of the QoS solution for real-\n\
    \   time traffic has been described at a high level in [RFC4542].  The\n   key\
    \ characteristics of this proposal are that\n   o  it uses standardized protocols,\n\
    \   o  it includes reservation setup and teardown for guaranteed and\n      controlled\
    \ load services using the standardized protocols,\n   o  it is independent of\
    \ link delay, and therefore consistent with\n      high delay*bandwidth networks\
    \ as well as the more common variety,\n   o  it has no single point of failure,\
    \ such as a central reservation\n      manager,\n   o  it provides for the preemption\
    \ of established data flows,\n   o  in that preemption, it not only permits a\
    \ policy-admitted data\n      flow in, but selects a specific data flow to exclude\
    \ based upon\n      control input rather than simply accepting a loss of service\n\
    \      dictated at the discretion of the network control function, and\n   o \
    \ it interoperates directly with SIP Proxies, H.323 Gatekeepers, or\n      other\
    \ call management subsystems to present the other services\n      required in\
    \ a preemptive or preferential telephone network.\n   The thrust of the memo surrounds\
    \ VPNs that use encryption in some\n   form, such as IPsec and their subsequent\
    \ nesting across multiple\n   network domains.  This specific type of VPNs is\
    \ further clarified in\n   Section 1.3, which describes the nested VPN as an example\
    \ of an IPsec\n   or IPsec like VPN under the context of a 'customer provisioned'\
    \ VPN.\n   As a result, we will discuss the VPN router supporting \"plaintext\"\
    \n   and \"ciphertext\" interfaces.  However, the concept extends readily to\n\
    \   any form of aggregation, including the concept proposed in [RFC3175]\n   of\
    \ the IP traffic entering and leaving a network at identified\n   points, and\
    \ the use of other kinds of tunnels including Generic\n   Routing Encapsulation\
    \ (GRE), IP/IP, MPLS, and so on.\n"
- title: 1.2.  Background Information and Terminology
  contents:
  - "1.2.  Background Information and Terminology\n   A note on the use of the words\
    \ \"priority\" and \"precedence\" in this\n   document is in order.  The term\
    \ \"priority\" has been used in this\n   context with a variety of meanings, resulting\
    \ in a great deal of\n   confusion.  The term \"priority\" is used in this document\
    \ to identify\n   one of several possible datagram scheduling algorithms.  A scheduler\n\
    \   is used when deciding which datagram will be sent next on a computer\n   interface;\
    \ a priority scheduler always chooses a datagram from the\n   highest priority\
    \ class (queue) that is occupied, shielding one class\n   of traffic from most\
    \ of the jitter by passing jitter it would\n   otherwise have experienced to another\
    \ class.  [RFC3181] applies the\n   term to a reservation, in a sense that this\
    \ document will refer to as\n   \"precedence\".  The term \"precedence\" is used\
    \ in the sense implied in\n   the phrase \"Multi-Level Precedence and Preemption\"\
    \ [ITU.MLPP.1990];\n   some classes of sessions take precedence over others, which\
    \ may\n   result in bandwidth being admitted that might not otherwise have been\n\
    \   or may result in the prejudicial termination of a lower-precedence\n   session\
    \ under a stated set of circumstances.  For the purposes of the\n   present discussion,\
    \ \"priority\" is a set of algorithms applied to\n   datagrams, where \"precedence\"\
    \ is a policy attribute of sessions.  The\n   techniques of priority comparisons\
    \ are used in a router or a policy\n   decision point to implement precedence,\
    \ but they are not the same\n   thing.\n   Along the same lines, it is important\
    \ for the reader to understand\n   the difference between QoS policies and policies\
    \ based on the\n   \"precedence\" or \"importance\" of data to the person or function\
    \ using\n   it.  Voice, regardless of the precedence level of the call, is\n \
    \  impeded by high levels of variation in network-induced delay.  As a\n   result,\
    \ voice is often serviced using a priority queue, transferring\n   jitter from\
    \ that application's traffic to other applications.  This\n   is as true of voice\
    \ for routine calls as it is for flash traffic.\n   There are classes of application\
    \ traffic that require bounded delay.\n   That is a different concept than \"\
    no jitter\"; they can accept jitter\n   within stated bounds.  Routing protocols\
    \ such as OSPF or BGP are\n   critical to the correct functioning of network infrastructure.\
    \  While\n   they are designed to work well with moderate loss levels, they are\n\
    \   not helped by them, and even a short period of high loss can result\n   in\
    \ dramatic network events.  Variation in delay, however, is not at\n   all an\
    \ issue if it is within reasonable bounds.  As a result, it is\n   common for\
    \ routers to treat routing protocol datagrams in a way that\n   limits the probability\
    \ of loss, accepting relatively high delay in\n   some cases, even though the\
    \ traffic is absolutely critical to the\n   network.  Telephone call setup exchanges\
    \ have this characteristic as\n   well: faced with a choice between loss and delay,\
    \ protocols like SIP\n   and H.323 far prefer the latter, as the call setup time\
    \ is far less\n   than it would be if datagrams had to be retransmitted, and this\
    \ is\n   true regardless of whether the call is routine or of high precedence.\n\
    \   As such, QoS markings tell us how to provide good service to an\n   application\
    \ independent of how \"important\" it may be at the current\n   time, while \"\
    importance\" can be conveyed separately in many cases.\n"
- title: 1.3.  Nested VPNs
  contents:
  - "1.3.  Nested VPNs\n   One could describe a nested VPN network in terms of three\
    \ network\n   diagrams.  Figure 1 shows a simple network stretched across a VPN\n\
    \   connection.  The VPN router (where, following [RFC2460], a \"router\"\n  \
    \ is \"a node that forwards packets not explicitly addressed to\n   itself\"),\
    \ performs the following steps:\n   o  receives an IP datagram from a plaintext\
    \ interface,\n   o  determines what remote enclave and therefore other VPN router\
    \ to\n      forward it to,\n   o  ensures that it has a tunnel mode security association\
    \ (as\n      generally defined in [RFC4301], Section 4) with that router,\n  \
    \ o  encloses the encrypted datagram within another VPN (e.g., IPsec)\n      and\
    \ IP header, and\n   o  forwards the encapsulated datagram toward the remote VPN\
    \ router.\n      The receiving VPN router reverses the steps:\n   o  determines\
    \ what security association the datagram was received\n      from,\n   o  decrypts\
    \ the interior datagram,\n   o  forwards the now-decapsulated datagram on a plaintext\
    \ interface.\n   The use of IPsec in this manner is described as the tunnel mode\
    \ of\n   [RFC4301] and [RFC4303].\n           Host  Host  Host       Host  Host\
    \  Host\n       /------------------/   /------------------/\n                \
    \ Router -------Router\n                            |\n                      \
    \  VPN-Router\n                            ||\n                            ||\
    \   IPsec Tunnel through routed network\n                            ||\n    \
    \                    VPN-Router\n                            |\n             \
    \     Router -------Router\n       /------------------/   /------------------/\n\
    \         Host  Host  Host       Host  Host  Host\n                      Figure\
    \ 1: VPN-Connected Enclave\n   An important point to understand is that the VPN\
    \ tunnel, like other\n   features of the routed network, are invisible to the\
    \ host.  The host\n   can infer that \"something out there\" is affecting the\
    \ Path MTU,\n   introducing delay, or otherwise affecting its data stream, but\
    \ if\n   properly implemented, it should be able to adapt to these.  The words\n\
    \   \"if properly implemented\" are the bane of every network manager,\n   however;\
    \ substandard implementations do demonstrably exist.\n   Outside of the enclave,\
    \ the hosts are essentially invisible.  The\n   communicating enclaves look like\
    \ a simple data exchange between peer\n   hosts across a routed network, as shown\
    \ in Figure 2.\n                                   Hosts Not Visible\n       \
    \                          /==================/\n                            \
    \           Router\n                                          |\n            \
    \                         VPN-Router\n                               /---------------------/\n\
    \                                     Inner Domain\n                         \
    \     /---------------------/\n                                      VPN-Router\n\
    \                                          |\n                               \
    \        Router\n                                /==================/\n      \
    \                           Hosts Not Visible\n         Figure 2: VPN-Connected\
    \ Enclave from Exterior Perspective\n   Such networks can be nested and re-used\
    \ in a complex manner.  As\n   shown in Figure 3, a pair of enclaves might communicate\
    \ across a\n   ciphertext network that, for various reasons, is itself re-encrypted\n\
    \   and transmitted across a larger ciphertext network.  The reasons for\n   doing\
    \ this vary, but they relate to information-hiding in the wider\n   network, different\
    \ levels of security required for different enclosed\n   enclaves, and so on.\n\
    \             Host  Host  Host       Host  Host  Host\n          /------------------/\
    \   /------------------/\n                     Router -------Router\n        \
    \                       |\n                       VPN-Router VPN-Router      VPN-Router\n\
    \                    /---------------------/    /----------/\n               \
    \              Router -------------Router\n                                  \
    \      |\n                                      VPN-Router      VPN-Router\n \
    \                                    /-----------/   /----------/\n          \
    \                                Router -------Router\n                      \
    \                      |\n                                            |\n    \
    \                                      Router -------Router\n                \
    \                     /-----------/   /----------/\n                         \
    \             VPN-Router      VPN-Router\n                                   \
    \     |\n                              Router ------------Router\n           \
    \         /---------------------/   /----------/\n                     VPN-Router\
    \ VPN-Router     VPN-Router\n                               |\n              \
    \       Router -------Router\n          /------------------/   /------------------/\n\
    \            Host  Host  Host       Host  Host  Host\n                       \
    \    Figure 3: Nested VPN\n   The key question this document explores is \"how\
    \ do reservations, and\n   preemption of reservations, work in such an environment?\"\
    \n"
- title: 1.4.  Signaled QoS Technology
  contents:
  - "1.4.  Signaled QoS Technology\n   The Integrated Services model for networking\
    \ was originally proposed\n   in [RFC1633].  In short, it divides all applications\
    \ into two broad\n   classes: those that will adapt themselves to any available\
    \ bandwidth,\n   and those that will not or cannot.  In the words of [RFC1633]:\n\
    \        One class of applications needs the data in each packet by a\n      \
    \  certain time and, if the data has not arrived by then, the data\n        is\
    \ essentially worthless; we call these \"real-time\"\n        applications.  Another\
    \ class of applications will always wait\n        for data to arrive; we call\
    \ these \"elastic\" applications.\n   The Integrated Services model defines data\
    \ flows supporting\n   applications as either \"real-time\" or \"elastic\".  It\
    \ should be noted\n   that \"real-time\" traffic is also referred to as \"inelastic\"\
    \ traffic,\n   and that elastic traffic is occasionally referred to as \"non-real-\n\
    \   time\".\n   In this view, the key issue is the so-called \"playback point\"\
    : a\n   real-time application is considered to have a certain point in time\n\
    \   at which data describing the next sound, picture, or whatever to be\n   delivered\
    \ to a display device or forfeit its utility, while an\n   elastic application\
    \ has no such boundary.  Another way to look at the\n   difference is that real-time\
    \ applications have an irreducible lower\n   bound on their bandwidth requirements.\
    \  For example, the typical\n   G.711 payload is delivered in 160-byte samples\
    \ (plus 40 bytes of IP/\n   UDP/RTP headers) at 20 millisecond intervals.  This\
    \ will yield 80\n   kbps of bandwidth, without silence suppression, and not accounting\n\
    \   for the layer 2 overhead.  To operate in real-time, a G.711 codec\n   requires\
    \ the network over which its data will be delivered to support\n   communications\
    \ at 80 kbps at the IP layer with roughly constant end-\n   to-end delay and nominal\
    \ or no loss.  If this is not possible (if\n   there is significant loss or wide\
    \ variations in delay), voice quality\n   will suffer.  On the other hand, if\
    \ many megabits of capacity are\n   available, the G.711 codec will not increase\
    \ its bandwidth\n   requirements either.  Although adaptive codecs exist (e.g.,\
    \ G.722.2\n   or G.726), the adaptive mechanism can either require greater or\n\
    \   lesser bandwidth and can adapt only within a certain range of\n   bandwidth\
    \ requirements beyond which the quality of the data flow\n   required is not met.\
    \  Elastic applications, however, will generally\n   adapt themselves to any network:\
    \ if the bottleneck provides 9600 bits\n   per second, a Web transfer or electronic\
    \ mail exchange will happen at\n   9600 bits per second, and if hundreds of megabits\
    \ are available, the\n   TCP (or SCTP) transport will increase their transfer\
    \ rate in an\n   attempt to reduce the time required to accomplish the transfer.\n\
    \   For real-time applications, those that require data to be delivered\n   end\
    \ to end with at least a certain rate and with delays varying\n   between stated\
    \ bounds, the Integrated Services architecture proposes\n   the use of a signaling\
    \ protocol that allows the communicating\n   applications and the network to communicate\
    \ about the application\n   requirements and the network's capability to deliver\
    \ them.  Several\n   such protocols have been developed or are under development,\
    \ notably\n   including the Resource Reservation Protocol (RSVP) and Next Steps\
    \ in\n   Signaling (NSIS).  The present discussion is limited to RSVP,\n   although\
    \ any protocol that delivers a similar set of capabilities\n   could be considered.\n"
- title: 1.5.  The Resource Reservation Protocol (RSVP)
  contents:
  - "1.5.  The Resource Reservation Protocol (RSVP)\n   RSVP is initially defined\
    \ in [RFC2205] with a set of datagram\n   processing rules defined in [RFC2209]\
    \ and datagram details for\n   Integrated Services [RFC2210].  Conceptually, this\
    \ protocol specifies\n   a way to identify data flows from a source application\
    \ to a\n   destination application and request specific resources for them.  The\n\
    \   source may be a single machine or a set of machines listed explicitly\n  \
    \ or implied, whereas the destination may be a single machine or a\n   multicast\
    \ group (and therefore all of the machines in it).  Each\n   application is specified\
    \ by a transport protocol number in the IP\n   protocol field, or may additionally\
    \ include destination and perhaps\n   source port numbers.  The protocol is defined\
    \ for both IPv4 [RFC0791]\n   and IPv6 [RFC2460].  It was recognized immediately\
    \ that it was also\n   necessary to provide a means to perform the same function\
    \ for various\n   kinds of tunnels, which implies a relationship between what\
    \ is inside\n   and what is outside the tunnel.  Definitions were therefore developed\n\
    \   for IPsec [RFC2207] and [RFC4860] and for more generic forms of\n   tunnels\
    \ [RFC2746].  With the later development of the Differentiated\n   Services Architecture\
    \ [RFC2475], definitions were added to specify\n   the Differentiated Services\
    \ Code Point (DSCP) [RFC2474] to be used by\n   a standard RSVP data flow in [RFC2996]\
    \ and to use a pair of IP\n   addresses and a DSCP as the identifying information\
    \ for a data flow\n   [RFC3175].\n   In addition, the initial definition of the\
    \ protocol included a\n   placeholder for policy information, and for preemption\
    \ of\n   reservations.  This placeholder was later specified in detail in\n  \
    \ [RFC2750] with a view to associating a policy [RFC2872] with an\n   identity\
    \ [RFC3182] and thereby enabling the network to provide a\n   contracted service\
    \ to an authenticated and authorized user.  This was\n   integrated with the Session\
    \ Initiation Protocol [RFC3261] in\n   [RFC3312].  Preemption of a reservation\
    \ is specified as in [RFC3181]\n   -- a reservation that is installed in the network\
    \ using an Preemption\n   Priority and retained using a separate Defending Priority\
    \ may be\n   removed by the network via an RESV Error signal that removes the\n\
    \   entire reservation.  This has issues, however, in that the matter is\n   often\
    \ not quite so black and white.  If the issue is that an existing\n   reservation\
    \ for 80 kbps can no longer be sustained but a 60 kbps\n   reservation could,\
    \ it is possible that a VoIP sender could change\n   from a G.711 codec to a G.729\
    \ codec and achieve that.  Or, if there\n   are multiple sessions in a tunnel\
    \ or other aggregate, one of the\n   calls could be eliminated leaving capacity\
    \ for the others.  [RFC4495]\n   seeks to address this issue.\n   In a similar\
    \ way, a capability was added to limit the possibility of\n   control signals\
    \ being spoofed or otherwise attacked [RFC2747]\n   [RFC3097].\n   [RFC3175] describes\
    \ several features that are unusual in RSVP, being\n   specifically set up to\
    \ handle aggregates in a service provider\n   network.  It describes three key\
    \ components:\n   o  The RFC 3175 session object, which identifies not the IP\
    \ addresses\n      of the packets that are identified, but the IP addresses of\
    \ the\n      ingress and egress devices in the network, and the DSCP that the\n\
    \      traffic will use.\n   o  The function of a reservation \"aggregator\",\
    \ which operates in the\n      ingress router and accepts individual reservations\
    \ from the\n      \"customer\" network.  It aggregates the reservations into the\
    \ ISP\n      core in a tunnel or an MPLS LSP, or as a traffic stream that is\n\
    \      known to leave at the deaggregator.\n   o  The function of a reservation\
    \ \"deaggregator\", which operates in\n      the egress router and breaks the\
    \ aggregate reservation and data\n      streams back out into individual data\
    \ streams that may be passed\n      to other networks.\n   In retrospect, the\
    \ Session Object specified by RFC 3175 is useful but\n   not intrinsically necessary.\
    \  If the ISP network uses tunnels, such\n   as MPLS LSPs, IP/IP or GRE tunnels\
    \ or enclosing IPsec Security\n   Associations, the concepts of an aggregator\
    \ and a deaggregator work\n   in the same manner, although the reservation mechanism\
    \ would be that\n   of [RFC3473] and [RFC3474], [RFC2207], [RFC4860], or [RFC2746].\n"
- title: 1.6.  Logical Structure of a VPN Router
  contents:
  - "1.6.  Logical Structure of a VPN Router\n   The conceptual structure of a VPN\
    \ router is similar to that of any\n   other router.  In its simplest form, it\
    \ is physically a two or more\n   port device (similar to that shown in Figure\
    \ 4), which has one or\n   more interfaces to the protected enclave(s) and one\
    \ or more\n   interfaces to the outside world.  On the latter, it structures some\n\
    \   number of tunnels (in the case of an IPsec tunnel, having security\n   associations)\
    \ that it can treat as point-to-point interfaces from a\n   routing perspective.\n\
    \          +---------+  +-------+   +----+----+       +---------+\n          |\
    \   RSVP  |  |Routing|   |Net Guard|        |IPsec Mgr|\n          +----+----+\
    \  +---+---+   +----+----+       +----+----+\n               |           |   \
    \         |                 |\n          +----+-----------+------------+-----------------+----+\n\
    \          |                         IP                         |\n          +-----------+--------------------+------------+------+\n\
    \                      |                    |            |\n                 \
    \     |              +-----+-----+ +----+------+\n                      |    \
    \          | Encrypt/  | | Encrypt/  |\n                      |              |Decrypt\
    \ for| |Decrypt for|\n                      |              | Security  | | Security\
    \  |\n                      |              |Association| |Association|\n     \
    \                 |              +-----+-----+ +----+------+\n               \
    \       |                    |            |\n          +-----------+------------+\
    \ +-----+------------+------+\n          |       Plaintext        | |       Ciphertext\
    \        |\n          |       Interface        | |       Interface         |\n\
    \          +------------------------+ +-------------------------+\n          \
    \      Figure 4: Logical Structure of a VPN Router\n   The encrypt/decrypt unit\
    \ may be implemented as a function of the\n   plaintext router, as a function\
    \ on its interface card, or as a\n   function of an external device with a private\
    \ interface to the IP\n   routing functionality of the plaintext router.  These\
    \ are\n   conceptually equivalent, although there are practical differences in\n\
    \   implementation.  The key issue is that when IP routing presents a\n   message\
    \ to the encrypt/decrypt unit for transmission, it must also be\n   presented\
    \ with the IP address of the plaintext routing peer, whether\n   host or router,\
    \ to which the security association must be\n   established.  This IP Address\
    \ is used to select (and perhaps create)\n   the security association, and in\
    \ turn select the appropriate set of\n   security parameters.  This could also\
    \ be implemented by presenting\n   the local Security Parameter Index (SPI) for\
    \ the data, if it has been\n   created out of band by the Network Management Process.\n\
    \   In addition, it is necessary for aggregated signaling to be generated\n  \
    \ for the ciphertext domain.  This may be accomplished in several ways:\n   o\
    \  by having the RSVP process on the plaintext router generate the\n      messages\
    \ and having the encrypt/decrypt unit bypass them into the\n      ciphertext network\n\
    \   o  by having the plaintext RSVP process advise a process in the\n      encrypt/decrypt\
    \ implementation of what needs to be generated using\n      some local exchange,\
    \ and having it generate such messages, or\n   o  by having a separate parallel\
    \ network management system\n      intermediate between the plaintext and ciphertext\
    \ routers, in\n      which case, the encrypt/decrypt unit and the parallel network\n\
    \      system must use the same address, and the ciphertext router must\n    \
    \  distinguish between traffic for them based on SPI or the presence\n      of\
    \ encryption.\n   Control plane signaling using this additional path is described\
    \ in\n   Section 3.2.  The information flow between the plaintext and\n   ciphertext\
    \ domains includes\n   o  IP datagrams via the encrypt/decrypt unit,\n   o  RSVP\
    \ signaling via the bypass path,\n   o  Control information coordinating security\
    \ associations, and\n   o  precious little else.\n"
- title: 2.  Reservation and Preemption in a Nested VPN
  contents:
  - "2.  Reservation and Preemption in a Nested VPN\n                        /   \
    \                        \\\n                       (       +--+   +--+   enclave\
    \ )   ,---------.\n         .----------.   \\      |H2+---+R2|          / ,-'\
    \           `\n          +--+   +--+`--.\\     +--+   ++-+         / /   +--+\
    \   +--+\n          |H1+---+R1|    \\`.           |         ,' /    |R3+---+H3|\n\
    \          +--+   +-++     ) '--.    +----++  _.-'  (     ++-+   +--+\n      \
    \             |     /    _.`---|VPN2||''-.     \\     |\n         enclave +----+-i.--''\
    \      +----++    `----.\\ +----+ enclave\n         --------|VPN1|'          \
    \    |              ``|VPN3|       ,\n                ,+----+               |\
    \                +----+------'\n              ,' --+-------+----------+------------------+---`.\n\
    \            ,'            ++-+                                 `.\n         \
    \ ,'              |R7+--------+                          `.\n         / interface\
    \      +--+        |                            \\\n           domain 1      \
    \           +-+--+                          \\\n                          _.--------|VPN7|--------.\n\
    \                  ,-----''          +--+-+         `------.         .\n     \
    \    `-.   ,-'                     |                   `-.   .-'\n           \
    \ `-:  inner domain        +-++                     `.'\n            (       \
    \                 |R9|                       )\n            .'.              \
    \        ++-+                     ;-.\n          .'   `-.                    |\
    \                    ,-'   `-.\n         '        `------.          +-+--+   \
    \      _.-----'         `\n           interface      `---------|VPN8|-------''\n\
    \           domain 2                 +-+--+                          /\n     \
    \    \\                            |          +--+              /\n          `.\
    \                          +----------+R8|            ,'\n            `.     \
    \                              ++-+          ,'\n              `. --+------------------+-----------+------+--\
    \ ,'\n           ,-----+----+               |                +----+------.\n \
    \        ,'      |VPN6|.              |              _.|VPN4|       `\n      \
    \           +----+.`----.      +----+     _.--'' ,+----+\n                  |\
    \     \\     `--=.-|VPN5|---:'      /    |\n          +--+   ++-+    :   ,-''\
    \   +----+    `--.  ;    ++-+   +--+\n          |H6+---+R6|    | ,'          |\
    \          `.|    |R4+---+H4|\n          +--+   +--+    ;/    +--+   ++-+    \
    \      :    +--+   +--+\n                        //     |H5+---+R5|          \
    \ \\\n          enclave     ,'(      +--+   +--+            `.     enclave\n \
    \        `.         ,'   \\                 enclave   /  '-.         ,\n     \
    \      `-------'      \\                         /      `-------'\n          \
    \        Figure 5: Reservations in a Nested VPN\n   Let us discuss how a resource\
    \ reservation protocol, and specifically\n   RSVP, might be used in a nested virtual\
    \ private network.\n"
- title: 2.1.  Reservation in a Nested VPN
  contents:
  - "2.1.  Reservation in a Nested VPN\n   A reservation in a nested VPN is very much\
    \ like a reservation in any\n   other network, with one exception: it is composed\
    \ of multiple\n   reservations that must be coordinated.  These include a reservation\n\
    \   within the originating and receiving enclaves and a reservation at\n   each\
    \ layer of the VPN, as shown in Figure 5.\n   Thus, when a host in one enclave\
    \ opens a reservation to a host in\n   another enclave, a reservation of the appropriate\
    \ type and size is\n   created end to end.  As it traverses the VPN router leaving\
    \ its\n   enclave, the reservation information and the data are placed within\n\
    \   the appropriate tunnel (e.g., the IPsec Security Association for its\n   precedence\
    \ level to the appropriate remote VPN router).  At the\n   remote VPN router,\
    \ it is extracted from the tunnel and passed on its\n   way to the target system.\
    \  The data in the enclave will be marked\n   with a DSCP appropriate to its application\
    \ and (if there is a\n   difference) precedence level, and the signaling datagrams\
    \ (PATH and\n   RESV) are marked with a DCLASS object indicating that value. \
    \ RSVP\n   signaling datagrams (PATH and RESV) are marked with a DCLASS object\n\
    \   indicating the value used for the corresponding data.  The DSCP on\n   the\
    \ signaling datagrams, however, is a DSCP for signaling, and has\n   the one provision\
    \ that if routing varies by DSCP, then it must be a\n   DSCP that is routed the\
    \ same way as the relevant data.  The [RFC2872]\n   policy object specifies the\
    \ applicable policy (e.g., \"routine service\n   for voice traffic\") and asserts\
    \ a [RFC3182] credential indicating its\n   user (which may be a person or a class\
    \ of persons).  As specified in\n   [RFC3181], it also specifies its Preemption\
    \ Priority and its\n   Defending Priority; these enable the Preemption Priority\
    \ of a new\n   session to be compared with the Defending Priority of previously\n\
    \   admitted sessions.\n   On the ciphertext side of the VPN router, no guarantees\
    \ result unless\n   the VPN router likewise sets up a reservation to the peer\
    \ VPN Router\n   across the ciphertext domain.  Thus, the VPN router sets up an\n\
    \   [RFC2207], [RFC4860], or [RFC3175] reservation to its peer.\n   The Session\
    \ Object defined by [RFC2207] or [RFC4860] contains a field\n   called a \"virtual\
    \ destination port\", which allows the multiplexing of\n   many reservations over\
    \ a common security association and, in the\n   latter case, a common DSCP value.\
    \  Thus, the voice traffic at every\n   precedence level might use the Expedited\
    \ Forwarding (EF) DSCP and\n   service as described in [RFC3246], but the reservations\
    \ would be for\n   \"the aggregate of voice sessions at precedence Pn between\
    \ these VPN\n   routers\".  This would allow the network administration to describe\n\
    \   policies with multiple thresholds, such as \"a new session at\n   precedence\
    \ Pn may be accepted if the total reserved bandwidth does\n   not exceed threshold\
    \ Qn; if it is necessary and sufficient to accept\n   the reservation, existing\
    \ reservations at lower precedences may be\n   preemptively reduced to make acceptance\
    \ of the new session possible\".\n   In the [RFC3175] case, since the DSCP must\
    \ be used to identify both\n   the reservation and the corresponding data stream,\
    \ the aggregate\n   reservations for different precedence levels require different\
    \ DSCP\n   values.\n   In either case, the fundamental necessity is for one VPN\
    \ router to\n   act as what [RFC3175] calls the \"aggregator\" and another to\
    \ act as\n   the \"deaggregator\", and extend a VPN tunnel between them.  If the\
    \ VPN\n   Tunnel is an IPsec Security Association between the VPN routers and\n\
    \   the IP packet is entirely contained within (such as is used to cross\n   a\
    \ firewall), then the behavior of [RFC2746] is required of the\n   tunnel.  That\
    \ bearer will have the following characteristics:\n   o  it will have a DSCP corollary\
    \ to the DSCP for the data or the same\n      DSCP as the data it carries,\n \
    \  o  the reservations and data will be carried in security associations\n   \
    \   between the VPN routers, and\n   o  the specification for the reservation\
    \ for the tunnel itself will\n      not be less than the sum of the requirements\
    \ of the aggregated\n      reservations.\n   The following requirements relationships\
    \ apply between the set of\n   enclosed reservations and the tunnel reservation:\n\
    \   o  The sum of the average rates of the contained reservations, having\n  \
    \    been adjusted for the additional IP headers, will be less than or\n     \
    \ equal to the average rate of the tunnel reservation.\n   o  The sum of the peak\
    \ rates of the contained reservations, having\n      been adjusted for the additional\
    \ IP headers, will be less than or\n      equal to the peak rate of the tunnel\
    \ reservation.\n   o  The sum of the burst sizes of the contained reservations,\
    \ having\n      been adjusted for the additional IP headers, will be less than\
    \ or\n      equal to the burst size of the tunnel reservation.\n   o  The Preemption\
    \ Priority of a tunnel reservation is identical to\n      that of the individual\
    \ reservations it aggregates.\n   o  The Defending Priority of a tunnel reservation\
    \ is identical to\n      that of the individual reservations it aggregates.\n\
    \   This would differ only in the case that measurement-based admission\n   is\
    \ in use in the tunnel but not in the end system.  In that case, the\n   tunnel's\
    \ average bandwidth specification would be greater than or\n   equal to the actual\
    \ average offered traffic.  Such systems are beyond\n   the scope of this specification.\n\
    \   As a policy matter, it may be useful to note a quirk in the way\n   Internet\
    \ QoS works.  If the policies for various precedence levels\n   specify different\
    \ thresholds (e.g., \"to accept a new routine call,\n   the total reserved bandwidth\
    \ after admission may not exceed X; to\n   accept a call with a higher precedence\
    \ level, the total reserved\n   bandwidth after admission may not exceed X+Y,\
    \ and this may be\n   achieved by preempting a call with a lower precedence level\"\
    ), the\n   bandwidth Y effectively comes from the bandwidth in use by elastic\n\
    \   traffic rather than forcing a preemption event.\n"
- title: 2.2.  Preemption in a Nested VPN
  contents:
  - "2.2.  Preemption in a Nested VPN\n   As discussed in Section 1.5, preemption\
    \ is specified in [RFC3181] and\n   further addressed in [RFC4495].  The issue\
    \ is that in many cases the\n   need is to reduce the bandwidth of a reservation\
    \ due to a change in\n   the network, not simply to remove the reservation.  In\
    \ the case of an\n   end-system-originated reservation, the end system might be\
    \ able to\n   accommodate the need through a change of codec; in the case of an\n\
    \   aggregate of some kind, it could reduce the bandwidth it is sending\n   by\
    \ dropping one or more reservations entirely.\n   In a nested VPN or other kind\
    \ of aggregated reservation, this means\n   that the deaggregator (the VPN router\
    \ initiating the RESV signal for\n   the tunnel) must\n   o  receive the RESV\
    \ Error signaling it to reduce its bandwidth,\n   o  re-issue its RESV accordingly,\n\
    \   o  identify one or more of its aggregated reservations, enough to do\n   \
    \   the job, and\n   o  signal them to reduce their bandwidth accordingly.\n \
    \  It is possible, of course, that it is signaling them to reduce their\n   bandwidth\
    \ to zero, which is functionally equivalent to removing the\n   reservation as\
    \ described in [RFC3181].\n   In the routers in the core, an additional case arises.\
    \  One could\n   imagine that some enclave presents the VPN with a single session,\
    \ and\n   that session has a higher precedence level.  If some interior link is\n\
    \   congested (e.g., the reserved bandwidth will exceed policy if the\n   call\
    \ is admitted), a session between a different pair of VPN routers\n   must be\
    \ preempted.  More generally, in selecting a reservation to\n   preempt, the core\
    \ router must always select a reservation at the\n   lowest available Defending\
    \ Priority.  This is the reason that various\n   precedence levels must be kept\
    \ separate in the core.\n"
- title: 2.3.  Working through an Example
  contents:
  - "2.3.  Working through an Example\n   The network in Figure 5 shows three security\
    \ layers: six plaintext\n   enclaves around the periphery, two ciphertext domains\
    \ connecting them\n   at one layer (referred to in the diagram as an \"interface\
    \ domain\"),\n   and a third ciphertext domain connecting the first two (referred\
    \ to\n   in the diagram as an \"inner domain\").  The following distribution of\n\
    \   information exists:\n   o  Each enclave has access to general routing information\
    \ concerning\n      other enclaves it is authorized to communicate with: systems\
    \ in it\n      can translate a DNS name for a remote host or domain and obtain\n\
    \      the corresponding address or prefix.\n   o  Each enclave router also has\
    \ specific routing information\n      regarding its own enclave.\n   o  A default\
    \ route is distributed within the enclave, pointing to its\n      VPN router.\n\
    \   o  VPN Routers 1-6 are able to translate remote enclave prefixes to\n    \
    \  the appropriate remote enclave's VPN router addresses.\n   o  Each interface\
    \ domain has access to general routing information\n      concerning the other\
    \ interface domains, but not the enclaves.\n      Systems in an interface domain\
    \ can translate a DNS name for a\n      remote interface domain and obtain the\
    \ corresponding address or\n      prefix.\n   o  Each interface domain router\
    \ also has specific routing information\n      regarding its own interface domain.\n\
    \   o  A default route is distributed within the interface domain,\n      pointing\
    \ to the \"inner\" VPN router.\n   o  VPN Routers 7 and 8 are able to translate\
    \ remote interface domain\n      prefixes to remote VPN router addresses.\n  \
    \ o  Routers in the inner domain have routing information for that\n      domain\
    \ only.\n   While the example shows three levels, there is nothing magic about\n\
    \   the number three.  The model can be extended to any number of\n   concentric\
    \ layers.\n   Note that this example places unidirectional reservations in the\n\
    \   forward direction.  In voice and video applications, one generally\n   has\
    \ a reservation in each direction.  The reverse direction is not\n   discussed,\
    \ for the sake of clarity, but operates in the same way in\n   the reverse direction\
    \ and uses the same security associations.\n"
- title: 2.3.1.  Initial Routine Reservations - Generating Network State
  contents:
  - "2.3.1.  Initial Routine Reservations - Generating Network State\n   Now let us\
    \ install a set of reservations from H1 to H4, H2 to H5, and\n   H3 to H6, and\
    \ for the sake of argument, let us presume that these are\n   at the \"routine\"\
    \ precedence.  H1, H2, and H3 each initiate a PATH\n   signal describing their\
    \ traffic.  For the sake of argument, let us\n   presume that H1's reservation\
    \ is for an [RFC2205] session, H2's\n   reservation is for a session encrypted\
    \ using IPsec, and therefore\n   depends on [RFC2207], and H3 (which is a Public\
    \ Switched Telephone\n   Network (PSTN) gateway) sends an [RFC3175] reservation\
    \ comprising a\n   number of distinct sessions.  Since these are going to H4,\
    \ H5, and\n   H6, respectively, the default route leads them to VPN1, VPN2, and\n\
    \   VPN3, respectively.\n   The VPN routers each ensure that they have an appropriate\
    \ security\n   association or tunnel open to the indicated remote VPN router (VPN4,\n\
    \   VPN5, or VPN6).  This will be a security association or tunnel for\n   the\
    \ indicated application at the indicated precedence level.  Having\n   accomplished\
    \ that, it will place the PATH signal into the security\n   association and forward\
    \ it.  If such does not already exist,\n   following [RFC3175]'s aggregation model,\
    \ it will now open a\n   reservation (send a PATH signal) for the tunnel/SA within\
    \ the\n   interface domain; if the reservation does exist, the VPN router will\n\
    \   increase the bandwidth indicated in the ADSPEC appropriately.  In\n   this\
    \ example, these tunnel/SA reservations will follow the default\n   route to VPN7.\n\
    \   VPN7 ensures that it has an appropriate security association or\n   tunnel\
    \ open to VPN8.  This will be a security association or tunnel\n   for the indicated\
    \ application at the indicated precedence level.\n   Having accomplished that,\
    \ it will place the PATH signal into the\n   security association and forward\
    \ it.  If such does not already exist,\n   following [RFC3175]'s aggregation model,\
    \ it will now open a\n   reservation (send a PATH signal) for the tunnel/SA within\
    \ the\n   interface domain; if the reservation does exist, the VPN router will\n\
    \   increase the bandwidth indicated in the ADSPEC appropriately.  In\n   this\
    \ example, this tunnel/SA reservation is forwarded to VPN8.\n   VPN8 acts as an\
    \ [RFC3175] deaggregator for the inner domain.  This\n   means that it receives\
    \ the PATH signal for the inner domain\n   reservation and stores state, decrypts\
    \ the data stream from VPN7,\n   operates on the RSVP signals as an RSVP-configured\
    \ router, and\n   forwards the received IP datagrams (including the updated PATH\n\
    \   signals) into its interface domain.  The PATH signals originated by\n   VPN1,\
    \ VPN2, and VPN3 are therefore forwarded towards VPN4, VPN5, and\n   VPN6 according\
    \ to the routing of the interface domain.\n   VPN4, VPN5, and VPN6 each act as\
    \ an [RFC3175] deaggregator for the\n   interface domain.  This means that it\
    \ receives the PATH signal for\n   the interface domain reservation and stores\
    \ state, decrypts the data\n   stream from its peer, operates on the RSVP signals\
    \ as an RSVP-\n   configured router, and forwards the received IP datagrams (including\n\
    \   the updated PATH signals) into its enclave.  The PATH signals\n   originated\
    \ by H1, H2, and H3 are therefore forwarded towards H4, H5,\n   and H6 according\
    \ to the routing of the enclave.\n   H4, H5, and H6 now receive the original PATH\
    \ signals and deliver them\n   to their application.\n"
- title: 2.3.2.  Initial Routine Reservations - Request Reservation
  contents:
  - "2.3.2.  Initial Routine Reservations - Request Reservation\n   The application\
    \ in H4, H5, and H6 decides to install the indicated\n   reservations, meaning\
    \ that they now reply with RESV signals.  These\n   signals request the bandwidth\
    \ reservation.  Following the trail left\n   by the PATH signals, the RESV signals\
    \ traipse back to their\n   respective sources.  The state left by the PATH signals\
    \ leads them to\n   VPN4, VPN5, and VPN6, respectively.  If the routers in the\
    \ enclaves\n   are configured for RSVP, this will be explicitly via R4, R5, or\
    \ R6;\n   if they are not, routing will lead them through those routers.\n   The\
    \ various RSVP-configured routers en route in the enclave\n   (including the VPN\
    \ router on the \"enclave\" side) will verify that\n   there is sufficient bandwidth\
    \ on their links and that any other\n   stated policy is also met.  Having accomplished\
    \ that, each will\n   update its reservation state and forward the RESV signal\
    \ to the next.\n   The VPN routers will also each generate an RESV for the reservation\n\
    \   within the interface domain, attempting to set or increase the\n   bandwidth\
    \ of the reservation appropriately.\n   The various RSVP-configured routers en\
    \ route in the interface domain\n   (including VPN8) will verify that there is\
    \ sufficient bandwidth on\n   their links and that any other stated policy is\
    \ also met.  Having\n   accomplished that, each will update its reservation state\
    \ and forward\n   the RESV signal to the next.  VPN8 will also generate an RESV\
    \ for the\n   reservation within the inner domain, attempting to set or increase\n\
    \   the bandwidth of the reservation appropriately.  This gets the\n   reservation\
    \ to the inner deaggregator, VPN8.\n   The various RSVP-configured routers en\
    \ route in the inner domain\n   (including VPN7) will verify that there is sufficient\
    \ bandwidth on\n   their links and that any other stated policy is also met. \
    \ Having\n   accomplished that, each will update its reservation state and forward\n\
    \   the RESV signal to the next.  This gets the signal to VPN7.\n   VPN7 acts\
    \ as an [RFC3175] aggregator for the inner domain.  This\n   means that it receives\
    \ the RESV signal for the inner domain\n   reservation and stores state, decrypts\
    \ the data stream from VPN8,\n   operates on the RSVP signals as an RSVP-configured\
    \ router, and\n   forwards the received IP datagrams (including the updated RESV\n\
    \   signals) into its interface domain.  The RESV signals originated by\n   VPN4,\
    \ VPN5, and VPN6 are therefore forwarded towards VPN1, VPN2, and\n   VPN3 through\
    \ the interface domain.\n   VPN1, VPN2, and VPN3 each act as an [RFC3175] aggregator\
    \ for the\n   interface domain.  This means that it receives the RESV signal for\n\
    \   the interface domain reservation and stores state, decrypts the data\n   stream\
    \ from its peer, operates on the RSVP signals as an RSVP-\n   configured router,\
    \ and forwards the received IP datagrams (including\n   the updated RESV signals)\
    \ into its enclave.  The RESV signals\n   originated by H4, H5, and H6 are therefore\
    \ forwarded towards H1, H2,\n   and H3 according to the routing of the enclave.\n\
    \   H1, H2, and H3 now receive the original RESV signals and deliver them\n  \
    \ to their application.\n"
- title: 2.3.3.  Installation of a Reservation Using Precedence
  contents:
  - "2.3.3.  Installation of a Reservation Using Precedence\n   Without going through\
    \ the details called out in Sections 2.3.1 and\n   2.3.2, if sufficient bandwidth\
    \ exists to support them, reservations\n   of other precedence levels or other\
    \ applications may also be\n   installed across this network.  If the \"routine\"\
    \ reservations already\n   described are for voice, for example, and sufficient\
    \ bandwidth is\n   available under the relevant policy, a reservation for voice\
    \ at the\n   \"priority\" precedence level might be installed.  Due to the mechanics\n\
    \   of preemption, however, this would not expand the existing \"routine\"\n \
    \  reservations in the interface and inner domains, as doing this causes\n   loss\
    \ of information - how much of the reservation is now \"routine\"\n   and how\
    \ much is \"priority\"?  Rather, this new reservation will open\n   up a separate\
    \ set of tunnels or security associations for traffic of\n   its application class\
    \ at its precedence between that aggregator and\n   deaggregator.\n   As a side\
    \ note, there is an opportunity here that does not exist in\n   the PSTN.  In\
    \ the PSTN, all circuits are potentially usable by any\n   PSTN application under\
    \ a certain set of rules (H channels, such as\n   those used by video streams,\
    \ must be contiguous and ordered).  As\n   such, if a channel is not made available\
    \ to routine traffic but is\n   made available to priority traffic, the operator\
    \ is potentially\n   losing revenue on the reserved bandwidth and deserves remuneration.\n\
    \   However, in the IP Internet, some bandwidth must be kept for basic\n   functions\
    \ such as routing, and, in general, policies will not permit\n   100% of the bandwidth\
    \ on an interface to be allocated to one\n   application at one precedence.  As\
    \ a result, it may be acceptable to\n   permit a certain portion (e.g., 50%) to\
    \ be used by routine voice and\n   a larger amount (e.g., 60%) to be used by voice\
    \ at a higher\n   precedence level.  Under such a policy, a higher precedence\n\
    \   reservation for voice might not result in the preemption of a routine\n  \
    \ call, but rather impact elastic traffic, and might be accepted at a\n   time\
    \ that a new reservation of lower precedence might be denied.\n   In microwave\
    \ networks, such as satellite or mobile ad hoc, one could\n   also imagine network\
    \ management intervention that could change the\n   characteristics of the radio\
    \ signal to increase the bandwidth under\n   some appropriate policy.\n"
- title: 2.3.4.  Installation of a Reservation Using Preemption
  contents:
  - "2.3.4.  Installation of a Reservation Using Preemption\n   So we now have a number\
    \ of reservations across the network described\n   in Figure 5 including several\
    \ reservations at \"routine\" precedence\n   and one at \"priority\" precedence.\
    \  For sake of argument, let us\n   presume that the link from VPN7 to R9 is now\
    \ fully utilized - all of\n   the bandwidth allocated by policy to voice at the\
    \ routine or priority\n   level has been reserved.  Let us further imagine that\
    \ a new\n   \"priority\" reservation is now placed from H3 to H6.\n   The process\
    \ described in Section 2.3.1 is followed, resulting in PATH\n   state across the\
    \ network for the new reservation.  This is installed\n   even though it is not\
    \ possible to install a new reservation on VPN7-\n   R9, as it does not install\
    \ any reservation and the network does not\n   know whether H6 will ultimately\
    \ require a reservation.\n   The process described in Section 2.3.2 is also followed.\
    \  The\n   application in H6 decides to install the indicated reservation,\n \
    \  meaning that it now replies with an RESV signal.  Following the trail\n   left\
    \ by the PATH signal, the RESV signal traipses back towards H3.\n   VPN6 and (if\
    \ RSVP was configured) R6 verify that there is sufficient\n   bandwidth on their\
    \ links and that any other stated policy is also\n   met.  Having accomplished\
    \ that, each will update its reservation\n   state and forward the RESV signal\
    \ to the next.  VPN6 also generates\n   an RESV for the reservation within the\
    \ interface domain, attempting\n   to set or increase the bandwidth of the reservation\
    \ appropriately.\n   VPN6, R8, and VPN8's \"interface domain\" sides now verify\
    \ that there\n   is sufficient bandwidth on their links and that any other stated\n\
    \   policy is also met.  Having accomplished that, each will update its\n   reservation\
    \ state and forward the RESV signal to the next.  VPN8 will\n   also generate\
    \ an RESV for the reservation within the inner domain,\n   attempting to set or\
    \ increase the bandwidth of the reservation\n   appropriately.  This gets the\
    \ reservation to the inner deaggregator,\n   VPN8.\n   VPN8's \"inner domain\"\
    \ side and R9 now verify that there is sufficient\n   bandwidth on their links\
    \ and that any other stated policy is also\n   met.  At R9, a problem is detected\
    \ - there is not sufficient\n   bandwidth under the relevant policy.  In the absence\
    \ of precedence,\n   R9 would now return an RESV Error indicating that the reservation\n\
    \   could not be increased or installed.  In such a case, if a\n   preexisting\
    \ reservation of lower bandwidth already existed, the\n   previous reservation\
    \ would remain in place but the new bandwidth\n   would not be granted, and the\
    \ originator (H6) would be informed.  Let\n   us clarify what it means to be at\
    \ a stated precedence: it means that\n   the POLICY_DATA object in the RESV contains\
    \ a Preemption Priority and\n   a Defending Priority with values specified in\
    \ some memo.  With\n   precedence, [RFC4495]'s algorithm would have the Preemption\
    \ Priority\n   of the new reservation compared to the Defending Priority of extant\n\
    \   reservations in the router, of which there are two: one VPN7->VPN8 at\n  \
    \ \"routine\" precedence and one VPN7->VPN8 at \"priority\" precedence.\n   Since\
    \ the Defending Priority of routine reservation is less than the\n   Preemption\
    \ Priority of a \"priority\" reservation, the \"routine\"\n   reservation is selected.\
    \  R9 determines that it will accept the\n   increase in its \"priority\" reservation\
    \ VPN7->VPN8 and reduce the\n   corresponding \"routine\" reservation.  Two processes\
    \ now occur in\n   parallel:\n   o  The routine reservation is reduced following\
    \ the algorithms in\n      [RFC4495] and\n   o  The priority reservation continues\
    \ according to the usual rules.\n   R9 reduces its \"routine\" reservation by\
    \ sending an RESV Error\n   updating its internal state to reflect the reduced\
    \ reservation and\n   sending an RESV Error to VPN8 requesting that it reduce\
    \ its\n   reservation to a number less than or equal to the relevant threshold\n\
    \   less the sum of the competing reservations.  VPN8, acting as a\n   deaggregator,\
    \ makes two changes.  On the \"inner domain\" side, it\n   marks its reservation\
    \ down to the indicated rate (the most it is now\n   permitted to reserve), so\
    \ that if an RESV Refresh event happens, it\n   will request the specified rate.\
    \  On the \"interface domain\" side, it\n   selects one or more of the relevant\
    \ reservations by an algorithm of\n   its choosing and requests that it likewise\
    \ reduce its rate.  For the\n   sake of argument, let us imagine that the selected\
    \ reservation is the\n   one to VPN5.  The RESV Error now makes its way through\
    \ R8 to VPN5,\n   which similarly reduces its bandwidth request to the stated\
    \ amount\n   and passes a RESV Error signal on the \"enclave\" side requesting\
    \ that\n   the reservation be appropriately reduced.\n   H5 is now faced with\
    \ a decision.  If the request is to reduce its\n   reservation to zero, that is\
    \ equivalent to tearing down the\n   reservation.  In this simple case, it sends\
    \ an RESV Tear to tear down\n   the reservation entirely and advises its application\
    \ to adjust its\n   expectations of the session accordingly, which may mean shutting\
    \ down\n   the session.  If the request is to reduce it below a certain value,\n\
    \   however, it may be possible for the application to do so and remain\n   viable.\
    \  For example, if a VoIP application using a G.711 codec (80\n   kbps) is asked\
    \ to reduce its bandwidth below 70 kbps, it may be\n   possible to renegotiate\
    \ the codec in use to G.729 or some other\n   codec.  In such a case, the originating\
    \ application should re-reserve\n   at the stated bandwidth (in this case, 70\
    \ kbps), initiate the\n   application level change, and let the application change\
    \ the\n   reservation again (perhaps to 60 kbps) when it has completed that\n\
    \   process.\n   At the time the reservation is being processed at R9, for the\n\
    \   \"priority\" reservation, R9 believes that it has sufficient bandwidth\n \
    \  and that any other stated policy is also met, and it forwards the\n   RESV\
    \ to VPN7.  Each will update its reservation state and forward the\n   RESV signal\
    \ to the next.  VPN7 now acts as an [RFC3175] aggregator\n   for the inner domain.\
    \  This means that it receives the RESV signal\n   for the inner domain reservation\
    \ and stores state, decrypts the data\n   stream from VPN8, operates on the RSVP\
    \ signals as an RSVP-configured\n   router, and forwards the received IP datagrams\
    \ (including the updated\n   RESV signals) into its interface domain.  The RESV\
    \ signals originated\n   by VPN4, VPN5, and VPN6 are therefore forwarded towards\
    \ VPN1, VPN2,\n   and VPN3 through the interface domain.\n   VPN3 now acts as\
    \ an [RFC3175] aggregator for the interface domain.\n   This means that it receives\
    \ the RESV signal for the interface domain\n   reservation and stores state, decrypts\
    \ the data stream from its peer,\n   operates on the RSVP signals as an RSVP-configured\
    \ router, and\n   forwards the received IP datagrams (including the updated RESV\n\
    \   signals) into its enclave.  The RESV signal originated by H6 is\n   therefore\
    \ forwarded towards H3 according to the routing of the\n   enclave.\n   H3 now\
    \ receives the original RESV signals and delivers it to the\n   relevant application.\n"
- title: 3.  Data Flows within a VPN Router
  contents:
  - "3.  Data Flows within a VPN Router\n   This section details the data flows within\
    \ a VPN router, in the\n   context of sessions as described in Section 2.  It\
    \ specifically\n   identifies the signaling flow at a given VPN boundary and\n\
    \   additionally elaborates the signaling mechanism with the aid of a\n   Network\
    \ Guard.  A use case describing the proposal in the context of\n   an operational\
    \ scenario is presented herein.\n"
- title: 3.1.  VPN Routers That Carry Data across the Cryptographic Boundary
  contents:
  - '3.1.  VPN Routers That Carry Data across the Cryptographic Boundary

    '
- title: 3.1.1.  Plaintext to Ciphertext Data Flows
  contents:
  - "3.1.1.  Plaintext to Ciphertext Data Flows\n          +-----------------------+\
    \    +----------------------+\n          | +--------------------+|    |+--------------------+|\n\
    \          | |RSVP                ||    ||Aggregate RSVP      ||\n          |\
    \ |                    ||    ||                    ||\n          | |Per session:\
    \        || ID ||Agg. Session        ||\n          | |  Destination       ||--->||\
    \  Agg. Destination  ||\n          | |  Source            ||    ||  Agg. Source=\
    \ self ||\n          | |  potential SPI     ||    ||  Agg. SPI generated||\n \
    \         | |  DSCP             ---------> DSCP              ||\n          | |\
    \  vPort or protocol---------> vPort             ||\n          | |           and\
    \ port ||    ||                    ||\n          | |  Mean rate        --------->\
    \ Sum of mean rates ||\n          | |  Peak rate        ---------> f(Peak rates)\
    \     ||\n          | |  Burst Size       ---------> Sum of Burst sizes||\n  \
    \        | |                    ||    ||                    ||\n          | +--------------------+|\
    \    |+--------------------+|\n          | +--------------------+|    |+--------------------+|\n\
    \          | |      IP            ||    ||       IP           ||\n          |\
    \ +--------------------+|    |+--------------------+|\n          | +--------------------+|\
    \    |+--------------------+|\n          | | Plaintext Interface||    ||Ciphertext\
    \ Interface||\n          | +--------------------+|    |+--------------------+|\n\
    \          +-----------------------+    +----------------------+\n           \
    \    Figure 6: Data Flows in a VPN Router Outbound\n   Parameters on a reservation\
    \ include:\n   Destination Address:  On the plaintext side, the VPN router\n \
    \     participates in the end-to-end reservations being installed for\n      plaintext\
    \ sessions.  These may include individual flows as\n      described in [RFC2205],\
    \ IPsec data flows [RFC2207], aggregate\n      reservations [RFC3175], or other\
    \ types.  It passes an identifier\n      for the ciphertext side of the deaggregator\
    \ to its ciphertext\n      unit.\n   DSCP:  The DSCP of the plaintext data flow\
    \ is provided to the cipher\n      text side.\n   Virtual Port:  The virtual destination\
    \ port is provided to the cipher\n      text side.  This may be derived from an\
    \ [RFC2207] session object\n      or from policy information.\n   Mean Rate: \
    \ The sum of the plaintext mean rates is provided to the\n      ciphertext unit.\n\
    \   Peak Rate:  A function of the plaintext peak rates is provided to the\n  \
    \    ciphertext unit.  This function is less than or equal to the sum\n      of\
    \ the peak rates.\n   Burst Size:  The sum of the burst sizes is provided to the\
    \ cipher\n      text unit.\n   Messages include:\n   Path:  The plaintext PATH\
    \ message is sent as encrypted data to the\n      ciphertext unit.  In parallel,\
    \ a trigger needs to be sent to the\n      ciphertext unit that results in it\
    \ generating the corresponding\n      aggregated PATH message for the ciphertext\
    \ side.\n   Path Error:  This indicates that a PATH message sent to the remote\n\
    \      enclave was in error.  In the error case, the message itself is\n     \
    \ sent on as encrypted data, but a signal is sent to the ciphertext\n      side\
    \ in case the error affects the ciphertext reservation (such as\n      removing\
    \ or changing state).\n   Path Tear:  The PATH Tear message is sent as encrypted\
    \ data to the\n      ciphertext unit.  In parallel, a signal is sent to the cipher\
    \ text\n      side; it will trigger a Path Tear on its reservation in the event\n\
    \      that this is the last aggregated session, or change the\n      SENDER_TSPEC\
    \ of the aggregated session.\n   RESV:  The plaintext RESV message is sent as\
    \ encrypted data to the\n      ciphertext unit.  In parallel, a trigger needs\
    \ to be sent to the\n      ciphertext unit that results in it generating the corresponding\n\
    \      aggregated RESV message for the ciphertext side.\n   RESV Error:  This\
    \ indicates that a RESV message that was received as\n      data and forwarded\
    \ into the enclave was in error or needed to be\n      preempted as described\
    \ in [RFC3181] or [RFC4495].  In the error\n      case, the message itself is\
    \ sent on as encrypted data, but a\n      signal is sent to the ciphertext side\
    \ in case the error affects\n      the ciphertext reservation (such as removing\
    \ or changing state).\n   RESV Tear:  The RESV Tear message is sent as encrypted\
    \ data to the\n      ciphertext unit.  In parallel, a signal is sent to the cipher\
    \ text\n      side; it will trigger a RESV Tear on its reservation in the event\n\
    \      that this is the last aggregated session, or reduce the bandwidth\n   \
    \   of an existing reservation.\n   RESV Confirm:  This indicates that a RESV\
    \ message received as data\n      and forwarded into the enclave, and is now being\
    \ confirmed.  This\n      message is sent as encrypted data to the ciphertext\
    \ side, and, in\n      parallel, a signal is sent to potentially trigger an RESV\
    \ Confirm\n      on the aggregate reservation.\n"
- title: 3.1.2.  Ciphertext to Plaintext Data Flows
  contents:
  - "3.1.2.  Ciphertext to Plaintext Data Flows\n           +-----------------------+\
    \    +----------------------+\n           | +--------------------+|    |+--------------------+|\n\
    \           | |RSVP                ||    ||Aggregate RSVP      ||\n          \
    \ | |                    ||    ||  terminated        ||\n           | |Per session:\
    \        |+    ||                    ||\n           | |  Destination       ||\
    \    ||                    ||\n           | |  Source          <---------Decrypted\
    \ RSVP      ||\n           | |  potential SPI     ||    ||  message sent to  \
    \ ||\n           | |  DSCP              ||    ||  Plaintext unit    ||\n     \
    \      | |  vPort or protocol ||    ||  *as data* for     ||\n           | | \
    \          and port ||    ||  normal processing ||\n           | |  Mean rate\
    \         ||    ||                    ||\n           | |  Peak rate         ||\
    \    ||                    ||\n           | |  Burst Size        ||    ||    \
    \                ||\n           | |                    ||    ||              \
    \      ||\n           | +--------------------+|    |+--------------------+|\n\
    \           | +--------------------+|    |+--------------------+|\n          \
    \ | |      IP            ||    ||       IP           ||\n           | +--------------------+|\
    \    |+--------------------+|\n           | +--------------------+|    |+--------------------+|\n\
    \           | |Plaintext Interface ||    ||Ciphertext Interface||\n          \
    \ | +--------------------+|    |+--------------------+|\n           +-----------------------+\
    \    +----------------------+\n               Figure 7: Data Flows in a VPN Router\
    \ Inbound\n   The aggregate reservation is terminated by the ciphertext side of\
    \ the\n   VPN router.  The RSVP messages related to the subsidiary sessions are\n\
    \   carried in the encrypted tunnel as data, and therefore arrive at the\n   plaintext\
    \ side with other data.  As the plaintext side participates\n   in these reservations,\
    \ some information is returned to the ciphertext\n   size to parameterize the\
    \ aggregate reservation as described in\n   Section 3.1.1 in the processing of\
    \ the outbound messages.\n"
- title: 3.2.  VPN Routers That Use the Network Guard for Signaling across the
  contents:
  - "3.2.  VPN Routers That Use the Network Guard for Signaling across the\n     \
    \ Cryptographic Boundary\n   As described in Section 1.6 the Network Guard provides\
    \ an additional\n   path for the reservation signaling between the plaintext and\
    \ cipher\n   text domains.\n                                 _.------------.\n\
    \                            ,--'' Plaintext Domain--.\n                     \
    \    ,-' +--------+  +--------+  `-.\n                       ,'    |  Host  |\
    \  | Host   |     `.\n                     ,'      +--------+  +--------+    \
    \   `.\n                    ;                                       :\n      \
    \              |         +----------------------+      |\n                   \
    \ :         |  +--------+          |      |\n                     `.       | \
    \ | Router |          |    ,'\n                       `.     |  +---+----+   \
    \       |  ,'\n                         `-   |      +----------+    | ,'\n   \
    \                        ---|    +-+--+  +-+--+--+ |'\n                      \
    \        |----|E/D |--|Net Grd| | VPN Router\n                           ,-'|\
    \    +-+--+  +-+--+--+ |\\\n                          ,   |      +----------+\
    \    | \\\n                        ,'    |  +---+----+          |  `.\n      \
    \                ,'      |  | Router |          |    |\n                     /\
    \        |  +--------+          |     \\\n                    ;         +----------------------+\
    \      :\n                    |                                       |\n    \
    \                :            Ciphertext Domain          ;\n                 Figure\
    \ 8: RSVP Passage via Network Guard\n   In this context, the VPN router is composed\
    \ of a plaintext router, a\n   ciphertext router, an encrypt/decrypt implementation\
    \ (such as a line\n   card or interface device), and a network management process\
    \ that\n   manages the encrypt/decrypt implementation and potentially passes\n\
    \   defined information flows between the plaintext and ciphertext\n   domains.\
    \  If the Network Guard is implemented as a software process\n   that exchanges\
    \ configuration instructions between the routers, this\n   is simple to understand.\
    \  If it is built as a separate systems\n   exchanging datagrams, it is somewhat\
    \ more complex, but conceptually\n   equivalent.  For example, the ciphertext\
    \ router would consider an IP\n   datagram received via the Network Guard (control\
    \ plane) as having\n   been received from and concerning the interface used in\
    \ the data\n   plane to the encrypt/decrypt unit.\n"
- title: 3.2.1.  Signaling Flow
  contents:
  - "3.2.1.  Signaling Flow\n   Encrypt/decrypt units may not be capable of terminating\
    \ and\n   originating flows as described in Section 3.1, and policy may prevent\n\
    \   knowledge of the ciphertext network addresses in the plaintext\n   router.\
    \  In such a case, the plaintext and ciphertext routers may use\n   the Network\
    \ Guard as the path for the signaling flows.  The Network\n   Guard performs the\
    \ following functions to enable the flow of\n   reservation signaling across the\
    \ cryptographic domain\n   o  transforms plaintext session identifiers into ciphertext\
    \ session\n      identifiers and vice-versa in IP datagrams and RSVP objects (e.g.\n\
    \      IP addresses)\n   o  performs resource management of aggregated reservations\
    \ (e.g.,\n      including ciphertext encapsulation overhead to resources\n   \
    \   requested)\n   o  reads and writes configuration on the encrypt/decrypt units\
    \ as\n      necessary (e.g., reads plaintext to ciphertext IP address mapping)\n\
    \   In addition, the plaintext and ciphertext routers must support a\n   routing\
    \ function or local interface that ensures that aggregated RSVP\n   messages flow\
    \ via the Network Guard.  However, the signaling flow\n   across the entire VPN\
    \ router at a cryptographic boundary remains\n   identical to the description\
    \ in Section 3.1.\n   A reader may note that the VPN router described in Figure\
    \ 8 can be\n   collapsed into a single router with two halves, or the Network\
    \ Guard\n   and the encrypt/decrypt units can be part of the plaintext router.\n\
    \   The details of alternate logical and physical architectures for the\n   VPN\
    \ router are beyond the scope of this document.\n"
- title: 3.2.2.  Use Case with Network Guard
  contents:
  - "3.2.2.  Use Case with Network Guard\n                   ........................................\n\
    \                   :              VPN Router A            :\n               \
    \    :                                      :\n                   :+-----------++----------++-----------+:\n\
    \     +------+ RSVP :|           || NetGrd-A ||           |:\n     |Host A|<---->:|PT-Router-A|+----------+|CT-Router-A|::::::::\n\
    \     +------+      :|           ||   E/D-A  ||           |:     ::\n        \
    \           :+-----------++----------++-----------+:     ::\n                \
    \   :                A-RSVP                :     ::\n                   :    \
    \        <:::::::::::::>           :     ::\n                   :......................................:\
    \     ::\n                                                         A-RSVP ::\n\
    \                                                               ,---.\n      \
    \                                                       ,'     `.\n          \
    \                                                  /         \\\n            \
    \                                               ; Interface :\n              \
    \                                             |  Domain   |\n                \
    \                                           :           ;\n                  \
    \                                          \\         /\n                    \
    \                                         `.     ,'\n                        \
    \                                       '---'\n                              \
    \                           A-RSVP ::\n                   ........................................\
    \     ::\n                   :              VPN Router B            :     ::\n\
    \                   :                                      :     ::\n        \
    \           :+-----------++----------++-----------+:     ::\n     +------+ RSVP\
    \ :|           || NetGrd-B ||           |:     ::\n     |Host B|<---->:|PT-Router-B|+----------+|CT-Router-B|::::::::\n\
    \     +------+      :|           ||   E/D-B  ||           |:\n               \
    \    :+-----------++----------++-----------+:\n                   :          \
    \      A-RSVP                :\n                   :            <:::::::::::::>\
    \           :\n                   :......................................:\n \
    \               Figure 9: Aggregated RSVP via Network Guard\n   The above figure\
    \ depicts a simple use case for aggregated signaling\n   with the Network Guard.\
    \  In this scenario, Host A initiates RSVP\n   signaling to Host B for a reservation.\
    \  The RSVP signaling between\n   the hosts is encapsulated by the VPN routers\
    \ into encrypted tunnels.\n   Aggregated RSVP signaling is triggered by VPN routers,\
    \ and flows into\n   the CT-Routers, as well as the interface domains, to reserve\n\
    \   resources at RSVP-capable routers on the path.  The aggregation/\n   deaggregation\
    \ point for RSVP reservations in this use case are the\n   PT-Routers.  The signaling\
    \ aggregation of RSVP into A-RSVP at the\n   PT-Router is similar to the data\
    \ flow described in Section 3.1.  The\n   Network Guard performs the additional\
    \ functions described in Section\n   3.2.1 to transform plaintext A-RSVP messages\
    \ into suitable ciphertext\n   A-RSVP messages.  A typical reservation set up\
    \ in this case would\n   follow these steps.\n   o  Host A sends RSVP PATH message\
    \ to Host B.\n   o  PT-Router-A encapsulates RSVP PATH message in encrypted tunnel\
    \ to\n      VPN Router B.\n   o  CT Routers and Interface domain carry encrypted\
    \ RSVP PATH message\n      (like any other encrypted data message).\n   o  PT-Router-B\
    \ decrypts RSVP Path Message and sends an E2E PathErr\n      message to PT-Router-A\
    \ in the encrypted tunnel.\n   o  PT-Router-B forwards decrypted plaintext RSVP\
    \ PATH message to Host\n      B.\n   o  PT-Router-A receives E2E PathErr and sends\
    \ an aggregated RSVP PATH\n      message towards PT-Router-B via the Network Guard.\n\
    \   o  The NetGrd-A transforms the plaintext aggregate RSVP into the\n      ciphertext\
    \ aggregate RSVP message as described in Section 3.2.1\n      and sends it to\
    \ the CT-Router-A.\n   o  The ciphertext aggregated RSVP message travels through\
    \ ciphertext\n      routers in the interface domain.\n   o  CT-Router-B receives\
    \ the ciphertext aggregate RSVP message and\n      sends it to the NetGrd-B.\n\
    \   o  The NetGrd-B transforms the ciphertext aggregate RSVP into the\n      plaintext\
    \ aggregate RSVP message as described in Section 3.2.1 and\n      sends it to\
    \ the PT-Router-B.\n   The subsequent RSVP and Aggregate RSVP signaling follows\
    \ a similar\n   flow, as described in detail in [RFC3175] and [RFC4860]to aggregate\n\
    \   each plaintext reservation into a corresponding ciphertext\n   reservation.\
    \  This ensures that RSVP-capable ciphertext routers\n   reserve the required\
    \ resources for a plaintext end-to-end\n   reservation.  Subsequent mechanisms,\
    \ such as preemption or the\n   increase and decrease of resources reserved, may\
    \ be applied to these\n   reservations as described before in this document. \
    \ The RSVP data\n   flow as described in Section 3.1 within the VPN router (from\
    \ the\n   plaintext router to the ciphertext router via the Guard) provides\n\
    \   necessary and sufficient information to routers in the ciphertext\n   domain\
    \ to implement the QoS solution presented in the document.\n   In this description,\
    \ we have described the Network Guard as being\n   separate from the encrypt/decrypt\
    \ unit.  This separation exists\n   because in certain implementations, it is\
    \ mandated by those who\n   specify the devices.  The separation does not come\
    \ for free, however;\n   the separation of the devices for system-engineering\
    \ purposes is\n   expensive, and it imposes architectural problems.  For example,\
    \ when\n   the Guard is used to aggregate RSVP messages or Protocol Independent\n\
    \   Multicast (PIM) routing, the traffic is destined to the remote VPN\n   router.\
    \  This means that the Guard must somehow receive and respond\n   to, on behalf\
    \ of the VPN Router, messages that are not directed to\n   it.  Several possible\
    \ solutions exist; they should be selected\n   carefully based on the security\
    \ and implementation needs of the\n   environment.  They are as follows:\n   o\
    \  In the simplest case, the Network Guard and encrypt/decrypt unit\n      can\
    \ be two independent functions that utilize a common network and\n      MAC layer.\
    \  This can allow the two functions to share a common MAC\n      and IP address,\
    \ so that traffic destined for one function is also\n      received by the other.\
    \  In the case that these two functions are\n      physically separated on two\
    \ devices, they can still share a common\n      MAC and IP address; however, additional\
    \ modifications may be\n      required on the Guard to filter and not process\
    \ IP traffic not\n      destined for itself.\n   o  The ciphertext interface of\
    \ the Guard could be placed into\n      promiscuous mode, allowing it to receive\
    \ all messages and discard\n      all but the few it is interested in.  The security\
    \ considerations\n      on putting a device in promiscuous mode at the VPN boundary\
    \ needs\n      to be taken into account in this method.\n   o  The Guard could\
    \ be engineered to receive all from the ciphertext\n      router and pass the\
    \ bulk of it on to the VPN router through\n      another interface.  In this case,\
    \ the Guard and the VPN router\n      would use the same IP address.  This mechanism\
    \ puts the load of\n      all data and management traffic destined for the VPN\
    \ router upon\n      the Guard.\n   o  The VPN router could be engineered to receive\
    \ all traffic from the\n      ciphertext router and pass any unencrypted traffic\
    \ it receives to\n      the Guard through another interface.  In this case, the\
    \ Guard and\n      the VPN router would use the same IP address.\n   o  All the\
    \ VPN router functions, as shown in Figure 9, could be\n      incorporated into\
    \ a single chassis, with appropriate internal\n      traffic management to send\
    \ some traffic into the plaintext enclave\n      and some to the Guard.  In this\
    \ case, the Guard and the VPN router\n      would be -- at least, functionally\
    \ -- the same system.\n   Of these, clearly the last is the simplest architecturally\
    \ and the\n   one that most minimizes the attendant risk.\n"
- title: 4.  Security Considerations
  contents:
  - "4.  Security Considerations\n   The typical security concerns of datagram integrity,\
    \ node and user\n   authentication are implicitly met by the security association\
    \ that\n   exists between the VPN routers.  The secure data stream that flows\n\
    \   between the VPN routers is also used for the reservation signaling\n   datagrams\
    \ flowing between VPN routers.  Information that is contained\n   in these signaling\
    \ datagrams receives the same level of encryption\n   that is received by the\
    \ data streams.\n   One of the reasons cited for the nesting of VPN routes in\
    \ Section 1.3\n   is the different levels of security across the nested VPN routers.\n\
    \   If the security level decreases from one VPN router to the next VPN\n   Router\
    \ in the nested path, the reservation signaling datagrams will,\n   by default,\
    \ receive the lower security-level treatment.  For most\n   cases, the lower security\
    \ treatment is acceptable.  In certain\n   networks, however, the reservation\
    \ signaling across the entire nested\n   path must receive the highest security-level\
    \ treatment (e.g.,\n   encryption, authentication of signaling nodes).  For example,\
    \ the\n   highest precedence level may only be signaled to VPN routers that can\n\
    \   provide the highest security levels.  If any VPN router in the nested\n  \
    \ path is incapable of providing the highest security level, it cannot\n   participate\
    \ in the reservation mechanism.\n   In the general case, the nested path may contain\
    \ routers that are\n   either incapable of participating in VPNs or providing\
    \ required\n   security levels.  These routers can participate in the reservation\n\
    \   only if the lower security level is acceptable (as configured by\n   policy)\
    \ for the signaling of reservation datagrams.\n   VPN routers encapsulate encrypted\
    \ IP packets and prepend an extra\n   header on each packet.  These packets, whether\
    \ used for signaling or\n   data, should be identifiable, at a minimum by the\
    \ IP addresses and\n   DSCP value.  Therefore, the prepended header should contain,\
    \ at a\n   minimum, the DSCP value corresponding to the signaled reservation in\n\
    \   each packet.  This may literally be the same DSCP as is used for the\n   data\
    \ (forcing control plane traffic to receive the same QoS treatment\n   as its\
    \ data), or a different DSCP that is routed identically\n   (separating control\
    \ and data-plane traffic QoS but not routing).\n   Additionally security considerations\
    \ as described in [RFC4860] and\n   [RFC3175] are also applicable in this environment;\
    \ they include the\n   integrity of RSVP messages can be ensured via mechanisms\
    \ described in\n   [RFC2747] and [RFC3097] and related key management (through\
    \ manual\n   configuration or a key management protocol) at nodes between any\n\
    \   aggregator and deaggregator pair that processes the messages.  In\n   addition,\
    \ confidentiality can be provided between hops by employing\n   IPsec.  Further\
    \ work in the IETF MSEC Working Group may be applicable\n   in these environments\
    \ for key management and confidentiality.\n"
- title: 5.  Acknowledgements
  contents:
  - "5.  Acknowledgements\n   Doug Marquis, James Polk, Mike Tibodeau, Pete Babendreier,\
    \ Roger\n   Levesque, and Subha Dhesikan gave early review comments.\n   Comments\
    \ by Sean O'Keefe, Tony De Simone, Julie Tarr, Chris Christou,\n   and their associates\
    \ resulted in Section 3.2.\n   Francois Le Faucheur, Bruce Davie, and Chris Christou\
    \ (with Pratik\n   Bose) added [RFC4860], which clarified the interaction of this\n\
    \   approach with the DSCP.\n"
- title: 6.  References
  contents:
  - '6.  References

    '
- title: 6.1.  Normative References
  contents:
  - "6.1.  Normative References\n   [RFC2205]       Braden, B., Zhang, L., Berson,\
    \ S., Herzog, S., and S.\n                   Jamin, \"Resource ReSerVation Protocol\
    \ (RSVP) --\n                   Version 1 Functional Specification\", RFC 2205,\n\
    \                   September 1997.\n   [RFC2207]       Berger, L. and T. O'Malley,\
    \ \"RSVP Extensions for\n                   IPSEC Data Flows\", RFC 2207, September\
    \ 1997.\n   [RFC2746]       Terzis, A., Krawczyk, J., Wroclawski, J., and L.\n\
    \                   Zhang, \"RSVP Operation Over IP Tunnels\", RFC 2746,\n   \
    \                January 2000.\n   [RFC2750]       Herzog, S., \"RSVP Extensions\
    \ for Policy Control\", RFC\n                   2750, January 2000.\n   [RFC2996]\
    \       Bernet, Y., \"Format of the RSVP DCLASS Object\", RFC\n              \
    \     2996, November 2000.\n   [RFC3175]       Baker, F., Iturralde, C., Le Faucheur,\
    \ F., and B.\n                   Davie, \"Aggregation of RSVP for IPv4 and IPv6\n\
    \                   Reservations\", RFC 3175, September 2001.\n   [RFC4495]  \
    \     Polk, J. and S. Dhesikan, \"A Resource Reservation\n                   Protocol\
    \ (RSVP) Extension for the Reduction of\n                   Bandwidth of a Reservation\
    \ Flow\", RFC 4495, May 2006.\n   [RFC4542]       Baker, F. and J. Polk, \"Implementing\
    \ an Emergency\n                   Telecommunications Service (ETS) for Real-Time\n\
    \                   Services in the Internet Protocol Suite\", RFC 4542,\n   \
    \                May 2006.\n   [RFC4860]       Le Faucheur, F., Davie, B., Bose,\
    \ P., Christou, C.,\n                   and M. Davenport, \"Generic Aggregate\
    \ Resource\n                   ReSerVation Protocol (RSVP) Reservations\", RFC\
    \ 4860,\n                   May 2007.\n"
- title: 6.2.  Informative References
  contents:
  - "6.2.  Informative References\n   [ITU.MLPP.1990] International Telecommunications\
    \ Union, \"Multilevel\n                   Precedence and Preemption Service\"\
    , ITU-T\n                   Recommendation I.255.3, 1990.\n   [RFC0791]      \
    \ Postel, J., \"Internet Protocol\", STD 5, RFC 791,\n                   September\
    \ 1981.\n   [RFC1633]       Braden, B., Clark, D., and S. Shenker, \"Integrated\n\
    \                   Services in the Internet Architecture: an Overview\",\n  \
    \                 RFC 1633, June 1994.\n   [RFC2209]       Braden, B. and L. Zhang,\
    \ \"Resource ReSerVation\n                   Protocol (RSVP) -- Version 1 Message\
    \ Processing\n                   Rules\", RFC 2209, September 1997.\n   [RFC2210]\
    \       Wroclawski, J., \"The Use of RSVP with IETF Integrated\n             \
    \      Services\", RFC 2210, September 1997.\n   [RFC2460]       Deering, S. and\
    \ R. Hinden, \"Internet Protocol,\n                   Version 6 (IPv6) Specification\"\
    , RFC 2460, December\n                   1998.\n   [RFC2474]       Nichols, K.,\
    \ Blake, S., Baker, F., and D. Black,\n                   \"Definition of the\
    \ Differentiated Services Field (DS\n                   Field) in the IPv4 and\
    \ IPv6 Headers\", RFC 2474,\n                   December 1998.\n   [RFC2475] \
    \      Blake, S., Black, D., Carlson, M., Davies, E., Wang,\n                \
    \   Z., and W. Weiss, \"An Architecture for Differentiated\n                 \
    \  Services\", RFC 2475, December 1998.\n   [RFC2747]       Baker, F., Lindell,\
    \ B., and M. Talwar, \"RSVP\n                   Cryptographic Authentication\"\
    , RFC 2747, January\n                   2000.\n   [RFC2872]       Bernet, Y. and\
    \ R. Pabbati, \"Application and Sub\n                   Application Identity Policy\
    \ Element for Use with\n                   RSVP\", RFC 2872, June 2000.\n   [RFC3097]\
    \       Braden, R. and L. Zhang, \"RSVP Cryptographic\n                   Authentication\
    \ -- Updated Message Type Value\", RFC\n                   3097, April 2001.\n\
    \   [RFC3181]       Herzog, S., \"Signaled Preemption Priority Policy\n      \
    \             Element\", RFC 3181, October 2001.\n   [RFC3182]       Yadav, S.,\
    \ Yavatkar, R., Pabbati, R., Ford, P.,\n                   Moore, T., Herzog,\
    \ S., and R.  Hess, \"Identity\n                   Representation for RSVP\",\
    \ RFC 3182, October 2001.\n   [RFC3246]       Davie, B., Charny, A., Bennet, J.,\
    \ Benson, K., Le\n                   Boudec, J., Courtney, W., Davari, S., Firoiu,\
    \ V., and\n                   D.  Stiliadis, \"An Expedited Forwarding PHB (Per-Hop\n\
    \                   Behavior)\", RFC 3246, March 2002.\n   [RFC3261]       Rosenberg,\
    \ J., Schulzrinne, H., Camarillo, G.,\n                   Johnston, A., Peterson,\
    \ J., Sparks, R., Handley, M.,\n                   and E.  Schooler, \"SIP: Session\
    \ Initiation Protocol\",\n                   RFC 3261, June 2002.\n   [RFC3312]\
    \       Camarillo, G., Marshall, W., and J.  Rosenberg,\n                   \"\
    Integration of Resource Management and Session\n                   Initiation\
    \ Protocol (SIP)\", RFC 3312, October 2002.\n   [RFC3473]       Berger, L., \"\
    Generalized Multi-Protocol Label\n                   Switching (GMPLS) Signaling\
    \ Resource ReserVation\n                   Protocol-Traffic Engineering (RSVP-TE)\
    \ Extensions\",\n                   RFC 3473, January 2003.\n   [RFC3474]    \
    \   Lin, Z. and D. Pendarakis, \"Documentation of IANA\n                   assignments\
    \ for Generalized MultiProtocol Label\n                   Switching (GMPLS) Resource\
    \ Reservation Protocol -\n                   Traffic Engineering (RSVP-TE) Usage\
    \ and Extensions\n                   for Automatically Switched Optical Network\
    \ (ASON)\",\n                   RFC 3474, March 2003.\n   [RFC4301]       Kent,\
    \ S. and K. Seo, \"Security Architecture for the\n                   Internet\
    \ Protocol\", RFC 4301, December 2005.\n   [RFC4303]       Kent, S., \"IP Encapsulating\
    \ Security Payload (ESP)\",\n                   RFC 4303, December 2005.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Fred Baker\n   Cisco Systems\n   1121 Via Del Rey\n  \
    \ Santa Barbara, California  93117\n   USA\n   Phone: +1-408-526-4257\n   Fax:\
    \   +1-413-473-2403\n   EMail: fred@cisco.com\n   Pratik Bose\n   Lockheed Martin\n\
    \   700 North Frederick Ave\n   Gaithersburg, Maryland  20871\n   USA\n   Phone:\
    \ +1-301-240-7041\n   Fax:   +1-301-240-5748\n   EMail: pratik.bose@lmco.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
