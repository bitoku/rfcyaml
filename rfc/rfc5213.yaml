- title: __initial_text__
  contents:
  - '                           Proxy Mobile IPv6

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   Network-based mobility management enables IP mobility for a host\n\
    \   without requiring its participation in any mobility-related\n   signaling.\
    \  The network is responsible for managing IP mobility on\n   behalf of the host.\
    \  The mobility entities in the network are\n   responsible for tracking the movements\
    \ of the host and initiating the\n   required mobility signaling on its behalf.\
    \  This specification\n   describes a network-based mobility management protocol\
    \ and is\n   referred to as Proxy Mobile IPv6.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction .................................................\
    \  4\n   2.  Conventions and Terminology  .................................  5\n\
    \     2.1.  Conventions Used in This Document  .......................  5\n  \
    \   2.2.  Terminology  .............................................  5\n   3.\
    \  Proxy Mobile IPv6 Protocol Overview  .........................  9\n   4.  Proxy\
    \ Mobile IPv6 Protocol Security  ......................... 15\n     4.1.  Peer\
    \ Authorization Database (PAD) Example Entries  ....... 16\n     4.2.  Security\
    \ Policy Database (SPD) Example Entries ........... 17\n   5.  Local Mobility\
    \ Anchor Operation  ............................. 17\n     5.1.  Extensions to\
    \ Binding Cache Entry Data Structure ......... 18\n     5.2.  Supported Home Network\
    \ Prefix Models ..................... 19\n     5.3.  Signaling Considerations\
    \ ................................. 20\n       5.3.1.  Processing Proxy Binding\
    \ Updates ..................... 20\n       5.3.2.  Initial Binding Registration\
    \ (New Mobility Session) .. 22\n       5.3.3.  Binding Lifetime Extension (No\
    \ Handoff)  ............. 23\n       5.3.4.  Binding Lifetime Extension (After\
    \ Handoff) ........... 24\n       5.3.5.  Binding De-Registration  .............................\
    \ 24\n       5.3.6.  Constructing the Proxy Binding Acknowledgement\n        \
    \       Message  ............................................. 25\n     5.4. \
    \ Multihoming Support  ..................................... 27\n       5.4.1.\
    \  Binding Cache Entry Lookup Considerations  ........... 28\n     5.5.  Timestamp\
    \ Option for Message Ordering  ................... 34\n     5.6.  Routing Considerations\
    \ ................................... 37\n       5.6.1.  Bi-Directional Tunnel\
    \ Management ..................... 37\n       5.6.2.  Forwarding Considerations\
    \  ........................... 38\n       5.6.3.  Explicit Congestion Notification\
    \ (ECN)\n               Considerations for Proxy Mobile IPv6 Tunnels .........\
    \ 39\n     5.7.  Local Mobility Anchor Address Discovery  ................. 40\n\
    \     5.8.  Mobile Prefix Discovery Considerations ................... 40\n  \
    \   5.9.  Route Optimization Considerations  ....................... 41\n   6.\
    \  Mobile Access Gateway Operation  ............................. 41\n     6.1.\
    \  Extensions to Binding Update List Entry Data Structure ... 42\n     6.2.  Mobile\
    \ Node's Policy Profile ............................. 43\n     6.3.  Supported\
    \ Access Link Types  ............................. 44\n     6.4.  Supported Address\
    \ Configuration Modes  ................... 44\n     6.5.  Access Authentication\
    \ and Mobile Node Identification ..... 45\n     6.6.  Acquiring Mobile Node's\
    \ Identifier ....................... 45\n     6.7.  Home Network Emulation ...................................\
    \ 46\n     6.8.  Link-local and Global Address Uniqueness ................. 46\n\
    \     6.9.  Signaling Considerations ................................. 48\n  \
    \     6.9.1.  Binding Registrations  ............................... 48\n    \
    \   6.9.2.  Router Solicitation Messages ......................... 56\n      \
    \ 6.9.3.  Default-Router ....................................... 57\n       6.9.4.\
    \  Retransmissions and Rate Limiting  ................... 58\n       6.9.5.  Path\
    \ MTU Discovery ................................... 59\n     6.10. Routing Considerations\
    \ ................................... 60\n       6.10.1. Transport Network  ...................................\
    \ 60\n       6.10.2. Tunneling and Encapsulation Modes  ................... 61\n\
    \       6.10.3. Local Routing  ....................................... 62\n  \
    \     6.10.4. Tunnel Management  ................................... 62\n    \
    \   6.10.5. Forwarding Rules ..................................... 62\n     6.11.\
    \ Supporting DHCP-Based Address Configuration on the\n           Access Link \
    \ ............................................. 64\n     6.12. Home Network Prefix\
    \ Renumbering  ......................... 66\n     6.13. Mobile Node Detachment\
    \ Detection and Resource Cleanup  ... 66\n     6.14. Allowing Network Access to\
    \ Other IPv6 Nodes  ............. 67\n   7.  Mobile Node Operation  .......................................\
    \ 67\n     7.1.  Moving into a Proxy Mobile IPv6 Domain ................... 67\n\
    \     7.2.  Roaming in the Proxy Mobile IPv6 Domain  ................. 69\n  \
    \ 8.  Message Formats  ............................................. 69\n    \
    \ 8.1.  Proxy Binding Update Message ............................. 69\n     8.2.\
    \  Proxy Binding Acknowledgement Message  ................... 71\n     8.3.  Home\
    \ Network Prefix Option ............................... 72\n     8.4.  Handoff\
    \ Indicator Option ................................. 73\n     8.5.  Access Technology\
    \ Type Option  ........................... 74\n     8.6.  Mobile Node Link-layer\
    \ Identifier Option ................. 76\n     8.7.  Link-local Address Option\
    \  ............................... 77\n     8.8.  Timestamp Option .........................................\
    \ 77\n     8.9.  Status Values  ........................................... 78\n\
    \   9.  Protocol Configuration Variables ............................. 80\n  \
    \   9.1.  Local Mobility Anchor - Configuration Variables  ......... 80\n    \
    \ 9.2.  Mobile Access Gateway - Configuration Variables  ......... 81\n     9.3.\
    \  Proxy Mobile IPv6 Domain - Configuration Variables ....... 82\n   10. IANA\
    \ Considerations  ......................................... 83\n   11. Security\
    \ Considerations  ..................................... 84\n   12. Acknowledgements\
    \ ............................................. 85\n   13. References ...................................................\
    \ 86\n     13.1. Normative References ..................................... 86\n\
    \     13.2. Informative References ................................... 87\n  \
    \ Appendix A.  Proxy Mobile IPv6 Interactions with AAA\n                Infrastructure\
    \  ..................................... 89\n   Appendix B.  Routing State .......................................\
    \ 89\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   IP mobility for IPv6 hosts is specified in Mobile IPv6 [RFC3775].\n\
    \   Mobile IPv6 requires client functionality in the IPv6 stack of a\n   mobile\
    \ node.  Exchange of signaling messages between the mobile node\n   and home agent\
    \ enables the creation and maintenance of a binding\n   between the mobile node's\
    \ home address and its care-of address.\n   Mobility as specified in [RFC3775]\
    \ requires the IP host to send IP\n   mobility management signaling messages to\
    \ the home agent, which is\n   located in the network.\n   Network-based mobility\
    \ is another approach to solving the IP mobility\n   challenge.  It is possible\
    \ to support mobility for IPv6 nodes without\n   host involvement by extending\
    \ Mobile IPv6 [RFC3775] signaling\n   messages between a network node and a home\
    \ agent.  This approach to\n   supporting mobility does not require the mobile\
    \ node to be involved\n   in the exchange of signaling messages between itself\
    \ and the home\n   agent.  A proxy mobility agent in the network performs the\
    \ signaling\n   with the home agent and does the mobility management on behalf\
    \ of the\n   mobile node attached to the network.  Because of the use and\n  \
    \ extension of Mobile IPv6 signaling and home agent functionality, this\n   protocol\
    \ is referred to as Proxy Mobile IPv6 (PMIPv6).\n   Network deployments that are\
    \ designed to support mobility would be\n   agnostic to the capability in the\
    \ IPv6 stack of the nodes that it\n   serves.  IP mobility for nodes that have\
    \ mobile IP client\n   functionality in the IPv6 stack as well as those nodes\
    \ that do not,\n   would be supported by enabling Proxy Mobile IPv6 protocol\n\
    \   functionality in the network.  The advantages of developing a\n   network-based\
    \ mobility protocol based on Mobile IPv6 are:\n   o  Reuse of home agent functionality\
    \ and the messages/format used in\n      mobility signaling.  Mobile IPv6 is a\
    \ mature protocol with several\n      implementations that have undergone interoperability\
    \ testing.\n   o  A common home agent would serve as the mobility agent for all\n\
    \      types of IPv6 nodes.\n   The problem statement and the need for a network-based\
    \ mobility\n   protocol solution has been documented in [RFC4830].  Proxy Mobile\n\
    \   IPv6 is a solution that addresses these issues and requirements.\n"
- title: 2.  Conventions and Terminology
  contents:
  - '2.  Conventions and Terminology

    '
- title: 2.1.  Conventions Used in This Document
  contents:
  - "2.1.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n"
- title: 2.2.  Terminology
  contents:
  - "2.2.  Terminology\n   All the general mobility-related terms used in this document\
    \ are to\n   be interpreted as defined in the Mobile IPv6 base specification\n\
    \   [RFC3775].\n   This document adopts the terms, Local Mobility Anchor (LMA)\
    \ and\n   Mobile Access Gateway (MAG) from the NETLMM Goals document [RFC4831].\n\
    \   This document also provides the following context-specific\n   explanation\
    \ to the following terms used in this document.\n   Proxy Mobile IPv6 Domain (PMIPv6-Domain)\n\
    \      Proxy Mobile IPv6 domain refers to the network where the mobility\n   \
    \   management of a mobile node is handled using the Proxy Mobile IPv6\n     \
    \ protocol as defined in this specification.  The Proxy Mobile IPv6\n      domain\
    \ includes local mobility anchors and mobile access gateways\n      between which\
    \ security associations can be set up and\n      authorization for sending Proxy\
    \ Binding Updates on behalf of the\n      mobile nodes can be ensured.\n   Local\
    \ Mobility Anchor (LMA)\n      Local Mobility Anchor is the home agent for the\
    \ mobile node in a\n      Proxy Mobile IPv6 domain.  It is the topological anchor\
    \ point for\n      the mobile node's home network prefix(es) and is the entity\
    \ that\n      manages the mobile node's binding state.  The local mobility\n \
    \     anchor has the functional capabilities of a home agent as defined\n    \
    \  in Mobile IPv6 base specification [RFC3775] with the additional\n      capabilities\
    \ required for supporting Proxy Mobile IPv6 protocol as\n      defined in this\
    \ specification.\n   Mobile Access Gateway (MAG)\n      Mobile Access Gateway\
    \ is a function on an access router that\n      manages the mobility-related signaling\
    \ for a mobile node that is\n      attached to its access link.  It is responsible\
    \ for tracking the\n      mobile node's movements to and from the access link\
    \ and for\n      signaling the mobile node's local mobility anchor.\n   Mobile\
    \ Node (MN)\n      Throughout this document, the term mobile node is used to refer\
    \ to\n      an IP host or router whose mobility is managed by the network.\n \
    \     The mobile node may be an IPv4-only node, IPv6-only node, or a\n      dual-stack\
    \ node and is not required to participate in any IP\n      mobility related signaling\
    \ for achieving mobility for an IP\n      address that is obtained in that Proxy\
    \ Mobile IPv6 domain.\n   LMA Address (LMAA)\n      The global address that is\
    \ configured on the interface of the\n      local mobility anchor and is the transport\
    \ endpoint of the bi-\n      directional tunnel established between the local\
    \ mobility anchor\n      and the mobile access gateway.  This is the address to\
    \ which the\n      mobile access gateway sends the Proxy Binding Update messages.\n\
    \      When supporting IPv4 traversal, i.e., when the network between the\n  \
    \    local mobility anchor and the mobile access gateway is an IPv4\n      network,\
    \ this address will be an IPv4 address and will be referred\n      to as IPv4-LMAA,\
    \ as specified in [IPV4-PMIP6].\n   Proxy Care-of Address (Proxy-CoA)\n      Proxy-CoA\
    \ is the global address configured on the egress interface\n      of the mobile\
    \ access gateway and is the transport endpoint of the\n      tunnel between the\
    \ local mobility anchor and the mobile access\n      gateway.  The local mobility\
    \ anchor views this address as the\n      care-of address of the mobile node and\
    \ registers it in the Binding\n      Cache entry for that mobile node.  When the\
    \ transport network\n      between the mobile access gateway and the local mobility\
    \ anchor is\n      an IPv4 network and if the care-of address that is registered\
    \ at\n      the local mobility anchor is an IPv4 address, the term, IPv4-\n  \
    \    Proxy-CoA is used, as specified in [IPV4-PMIP6].\n   Mobile Node's Home Network\
    \ Prefix (MN-HNP)\n      The MN-HNP is a prefix assigned to the link between the\
    \ mobile\n      node and the mobile access gateway.  More than one prefix can\
    \ be\n      assigned to the link between the mobile node and the mobile access\n\
    \      gateway, in which case, all of the assigned prefixes are managed\n    \
    \  as a set associated with a mobility session.  The mobile node\n      configures\
    \ its interface with one or more addresses from its home\n      network prefix(es).\
    \  If the mobile node connects to the Proxy\n      Mobile IPv6 domain through\
    \ multiple interfaces, simultaneously,\n      each of the attached interfaces\
    \ will be assigned a unique set of\n      home network prefixes, and all the prefixes\
    \ assigned to a given\n      interface of a mobile node will be managed under\
    \ one mobility\n      session.  For example, home network prefixes P1 and P2 assigned\
    \ to\n      interface I1 will be managed under one mobility session and\n    \
    \  prefixes P3, P4, and P5 assigned to interface I2 of the mobile\n      node\
    \ will be managed under a different mobility session.\n      Additionally, in\
    \ some configurations the assigned prefix can be of\n      128-bit prefix length.\n\
    \   Mobile Node's Home Address (MN-HoA)\n      MN-HoA is an address from a mobile\
    \ node's home network prefix.\n      The mobile node will be able to use this\
    \ address as long as it is\n      attached to the access network that is in the\
    \ scope of that Proxy\n      Mobile IPv6 domain.  If the mobile node uses more\
    \ than one address\n      from its home network prefix(es), any one of these addresses\
    \ is\n      referred to as mobile node's home address.  Unlike in Mobile IPv6\n\
    \      where the home agent is aware of the home address of the mobile\n     \
    \ node, in Proxy Mobile IPv6, the mobility entities are only aware\n      of the\
    \ mobile node's home network prefix(es) and are not always\n      aware of the\
    \ exact address(es) that the mobile node configured on\n      its interface from\
    \ its home network prefix(es).  However, in some\n      configurations and based\
    \ on the enabled address configuration\n      modes on the access link, the mobility\
    \ entities in the network can\n      be certain about the exact address(es) configured\
    \ by the mobile\n      node.\n   Mobile Node's Home Link\n      This is the link\
    \ on which the mobile node obtained its layer-3\n      address configuration for\
    \ the attached interface after it moved\n      into that Proxy Mobile IPv6 domain.\
    \  This is the link that\n      conceptually follows the mobile node.  The network\
    \ will ensure the\n      mobile node always sees this link with respect to the\
    \ layer-3\n      network configuration, on any access link that it attaches to\
    \ in\n      that Proxy Mobile IPv6 domain.\n   Multihomed Mobile Node\n      A\
    \ mobile node that connects to the same Proxy Mobile IPv6 domain\n      through\
    \ more than one interface and uses these interfaces\n      simultaneously is referred\
    \ to as a multihomed mobile node.\n   Mobile Node Identifier (MN-Identifier)\n\
    \      The identity of a mobile node in the Proxy Mobile IPv6 domain.\n      This\
    \ is the stable identifier of a mobile node that the mobility\n      entities\
    \ in a Proxy Mobile IPv6 domain can always acquire and use\n      for predictably\
    \ identifying a mobile node.  This is typically an\n      identifier such as a\
    \ Network Access Identifier (NAI) [RFC4282] or\n      other identifier such as\
    \ a Media Access Control (MAC) address.\n   Mobile Node Link-layer Identifier\
    \ (MN-LL-Identifier)\n      An identifier that identifies the attached interface\
    \ of a mobile\n      node.  For those interfaces that have a link-layer identifier,\n\
    \      this identifier can be based on that.  The link-layer identifier,\n   \
    \   in some cases, is generated by the mobile node and conveyed to the\n     \
    \ mobile access gateway.  This identifier of the attached interface\n      must\
    \ be stable, as seen by any of the mobile access gateways in a\n      given Proxy\
    \ Mobile IPv6 domain.  In some other cases, there might\n      not be any link-layer\
    \ identifier associated with the mobile node's\n      interface.  An identifier\
    \ value of ALL_ZERO is not considered a\n      valid identifier and cannot be\
    \ used as an interface identifier.\n   Policy Profile\n      Policy Profile is\
    \ an abstract term for referring to a set of\n      configuration parameters that\
    \ are configured for a given mobile\n      node.  The mobility entities in the\
    \ Proxy Mobile IPv6 domain\n      require access to these parameters for providing\
    \ the mobility\n      management to a given mobile node.  The specific details\
    \ on how\n      the network entities obtain this policy profile is outside the\n\
    \      scope of this document.\n   Proxy Binding Update (PBU)\n      A request\
    \ message sent by a mobile access gateway to a mobile\n      node's local mobility\
    \ anchor for establishing a binding between\n      the mobile node's home network\
    \ prefix(es) assigned to a given\n      interface of a mobile node and its current\
    \ care-of address (Proxy-\n      CoA).\n   Proxy Binding Acknowledgement (PBA)\n\
    \      A reply message sent by a local mobility anchor in response to a\n    \
    \  Proxy Binding Update message that it received from a mobile access\n      gateway.\n\
    \   Per-MN-Prefix and Shared-Prefix Models\n      The term Per-MN-Prefix model\
    \ is used to refer to an addressing\n      model where there is a unique network\
    \ prefix or prefixes assigned\n      for each node.  The term Shared-Prefix model\
    \ is used to refer to\n      an addressing model where the prefix(es) are shared\
    \ by more than\n      one node.  This specification supports the Per-MN-Prefix\
    \ model and\n      does not support the Shared-Prefix model.\n   Mobility Session\n\
    \      In the context of Proxy Mobile IPv6 specification, the term\n      mobility\
    \ session refers to the creation or existence of state\n      associated with\
    \ the mobile node's mobility binding on the local\n      mobility anchor and on\
    \ the serving mobile access gateway.\n   DHCP\n      Throughout this document,\
    \ the acronym DHCP refers to DHCP for\n      IPv6, as defined in [RFC3315].\n\
    \   ALL_ZERO and NON_ZERO\n      Protocol message fields initialized with value\
    \ 0 in each byte of\n      the field.  For example, an 8-byte link-layer identifier\
    \ field\n      with the value set to 0 in each of the 8 bytes, or an IPv6 address\n\
    \      with the value 0 in all of the 16 bytes.  Conversely, the term\n      NON_ZERO\
    \ is used to refer to any value other than an ALL_ZERO\n      value.\n"
- title: 3.  Proxy Mobile IPv6 Protocol Overview
  contents:
  - "3.  Proxy Mobile IPv6 Protocol Overview\n   This specification describes a network-based\
    \ mobility management\n   protocol.  It is called Proxy Mobile IPv6 and is based\
    \ on Mobile IPv6\n   [RFC3775].\n   Proxy Mobile IPv6 protocol is intended for\
    \ providing network-based IP\n   mobility management support to a mobile node,\
    \ without requiring the\n   participation of the mobile node in any IP mobility\
    \ related\n   signaling.  The mobility entities in the network will track the\n\
    \   mobile node's movements and will initiate the mobility signaling and\n   set\
    \ up the required routing state.\n   The core functional entities in the NETLMM\
    \ infrastructure are the\n   Local Mobility Anchor (LMA) and the Mobile Access\
    \ Gateway (MAG).  The\n   local mobility anchor is responsible for maintaining\
    \ the mobile\n   node's reachability state and is the topological anchor point\
    \ for the\n   mobile node's home network prefix(es).  The mobile access gateway\
    \ is\n   the entity that performs the mobility management on behalf of a\n   mobile\
    \ node, and it resides on the access link where the mobile node\n   is anchored.\
    \  The mobile access gateway is responsible for detecting\n   the mobile node's\
    \ movements to and from the access link and for\n   initiating binding registrations\
    \ to the mobile node's local mobility\n   anchor.  There can be multiple local\
    \ mobility anchors in a Proxy\n   Mobile IPv6 domain each serving a different\
    \ group of mobile nodes.\n   The architecture of a Proxy Mobile IPv6 domain is\
    \ shown in Figure 1.\n              +----+                +----+\n           \
    \   |LMA1|                |LMA2|\n              +----+                +----+\n\
    \       LMAA1 -> |                      | <-- LMAA2\n                |       \
    \               |\n                \\\\                    //\\\\\n          \
    \       \\\\                  //  \\\\\n                  \\\\               \
    \ //    \\\\\n               +---\\\\------------- //------\\\\----+\n       \
    \       (     \\\\  IPv4/IPv6 //        \\\\    )\n              (      \\\\ \
    \ Network //          \\\\   )\n               +------\\\\--------//------------\\\
    \\-+\n                       \\\\      //              \\\\\n                \
    \        \\\\    //                \\\\\n                         \\\\  //   \
    \               \\\\\n             Proxy-CoA1--> |                      | <--\
    \ Proxy-CoA2\n                        +----+                 +----+\n        \
    \                |MAG1|-----{MN2}       |MAG2|\n                        +----+\
    \    |            +----+\n                          |       |               |\n\
    \             MN-HNP1 -->  |     MN-HNP2           | <-- MN-HNP3, MN-HNP4\n  \
    \                      {MN1}                   {MN3}\n                    Figure\
    \ 1: Proxy Mobile IPv6 Domain\n   When a mobile node enters a Proxy Mobile IPv6\
    \ domain and attaches to\n   an access link, the mobile access gateway on that\
    \ access link, after\n   identifying the mobile node and acquiring its identity,\
    \ will\n   determine if the mobile node is authorized for the network-based\n\
    \   mobility management service.\n   If the network determines that the mobile\
    \ node is authorized for\n   network-based mobility service, the network will\
    \ ensure that the\n   mobile node using any of the address configuration mechanisms\n\
    \   permitted by the network will be able to obtain the address\n   configuration\
    \ on the connected interface and move anywhere in that\n   Proxy Mobile IPv6 domain.\
    \  The obtained address configuration\n   includes the address(es) from its home\
    \ network prefix(es), the\n   default-router address on the link, and other related\
    \ configuration\n   parameters.  From the perspective of each mobile node, the\
    \ entire\n   Proxy Mobile IPv6 domain appears as a single link, the network\n\
    \   ensures that the mobile node does not detect any change with respect\n   to\
    \ its layer-3 attachment even after changing its point of attachment\n   in the\
    \ network.\n   The mobile node may be an IPv4-only node, IPv6-only node, or a\
    \ dual-\n   stack (IPv4/v6) node.  Based on the policy profile information that\n\
    \   indicates the type of address or prefixes to be assigned for the\n   mobile\
    \ node in the network, the mobile node will be able to obtain an\n   IPv4, IPv6,\
    \ or dual IPv4/IPv6 address and move anywhere in that Proxy\n   Mobile IPv6 domain.\
    \  However, this specification only supports IPv6\n   address/prefix mobility\
    \ with the transport network being IPv6.  The\n   support for IPv4 addressing\
    \ or an IPv4 transport network is specified\n   in the companion document [IPV4-PMIP6].\n\
    \   If the mobile node connects to the Proxy Mobile IPv6 domain through\n   multiple\
    \ interfaces and over multiple access networks, the network\n   will allocate\
    \ a unique set of home network prefixes for each of the\n   connected interfaces.\
    \  The mobile node will be able to configure\n   address(es) on those interfaces\
    \ from the respective home network\n   prefix(es).  However, if the mobile node\
    \ performs a handoff by moving\n   its address configuration from one interface\
    \ to the other, and if the\n   local mobility anchor receives a handoff hint from\
    \ the serving mobile\n   access gateway about the same, the local mobility anchor\
    \ will assign\n   the same home network prefix(es) that it previously assigned\
    \ prior to\n   the handoff.  The mobile node will also be able to perform a handoff\n\
    \   by changing its point of attachment from one mobile access gateway to\n  \
    \ a different mobile access gateway using the same interface and will\n   be able\
    \ to retain the address configuration on the attached\n   interface.\n  +-----+\
    \                +-----+                +-----+\n  | MN  |                | MAG\
    \ |                | LMA |\n  +-----+                +-----+                +-----+\n\
    \     |                      |                      |\n MN Attached          \
    \      |                      |\n     |                      |               \
    \       |\n     |       MN Attached Event from MN/Network     |\n     |      \
    \  (Acquire MN-Id and Profile)          |\n     |                      |     \
    \                 |\n     |--- Rtr Sol --------->|                      |\n  \
    \   |                      |                      |\n     |                  \
    \    |--- PBU ------------->|\n     |                      |                 \
    \     |\n     |                      |                  Accept PBU\n     |   \
    \                   | (Allocate MN-HNP(s), Setup BCE and Tunnel)\n     |     \
    \                 |                      |\n     |                      |<-------------\
    \ PBA ---|\n     |                      |                      |\n     |     \
    \            Accept PBA                  |\n     |          (Set Up Tunnel and\
    \ Routing)        |\n     |                      |                      |\n  \
    \   |                      |==== Bi-Dir Tunnel ===|\n     |                  \
    \    |                      |\n     |<--------- Rtr Adv ---|                 \
    \     |\n     |                      |                      |\n  IP Address  \
    \              |                      |\n Configuration              |       \
    \               |\n     |                      |                      |\n    \
    \      Figure 2: Mobile Node Attachment - Signaling Call Flow\n   Figure 2 shows\
    \ the signaling call flow when the mobile node enters\n   the Proxy Mobile IPv6\
    \ domain.  The Router Solicitation message from\n   the mobile node may arrive\
    \ at any time after the mobile node's\n   attachment and has no strict ordering\
    \ relation with the other\n   messages in the call flow.\n   For updating the\
    \ local mobility anchor about the current location of\n   the mobile node, the\
    \ mobile access gateway sends a Proxy Binding\n   Update message to the mobile\
    \ node's local mobility anchor.  Upon\n   accepting this Proxy Binding Update\
    \ message, the local mobility\n   anchor sends a Proxy Binding Acknowledgement\
    \ message including the\n   mobile node's home network prefix(es).  It also creates\
    \ the Binding\n   Cache entry and sets up its endpoint of the bi-directional tunnel\
    \ to\n   the mobile access gateway.\n   The mobile access gateway on receiving\
    \ the Proxy Binding\n   Acknowledgement message sets up its endpoint of the bi-directional\n\
    \   tunnel to the local mobility anchor and also sets up the forwarding\n   for\
    \ the mobile node's traffic.  At this point, the mobile access\n   gateway has\
    \ all the required information for emulating the mobile\n   node's home link.\
    \  It sends Router Advertisement messages to the\n   mobile node on the access\
    \ link advertising the mobile node's home\n   network prefix(es) as the hosted\
    \ on-link prefix(es).\n   The mobile node, on receiving these Router Advertisement\
    \ messages on\n   the access link, attempts to configure its interface using either\n\
    \   stateful or stateless address configuration modes, based on the modes\n  \
    \ that are permitted on that access link as indicated in Router\n   Advertisement\
    \ messages.  At the end of a successful address\n   configuration procedure, the\
    \ mobile node has one or more addresses\n   from its home network prefix(es).\n\
    \   After address configuration, the mobile node has one or more valid\n   addresses\
    \ from its home network prefix(es) at the current point of\n   attachment.  The\
    \ serving mobile access gateway and the local mobility\n   anchor also have proper\
    \ routing states for handling the traffic sent\n   to and from the mobile node\
    \ using any one or more of the addresses\n   from its home network prefix(es).\n\
    \   The local mobility anchor, being the topological anchor point for the\n  \
    \ mobile node's home network prefix(es), receives any packets that are\n   sent\
    \ to the mobile node by any node in or outside the Proxy Mobile\n   IPv6 domain.\
    \  The local mobility anchor forwards these received\n   packets to the mobile\
    \ access gateway through the bi-directional\n   tunnel.  The mobile access gateway\
    \ on other end of the tunnel, after\n   receiving the packet, removes the outer\
    \ header and forwards the\n   packet on the access link to the mobile node.  However,\
    \ in some\n   cases, the traffic sent from a correspondent node that is locally\n\
    \   connected to the mobile access gateway may not be received by the\n   local\
    \ mobility anchor and may be routed locally by the mobile access\n   gateway (refer\
    \ to Section 6.10.3).\n   The mobile access gateway acts as the default router\
    \ on the point-to-\n   point link shared with the mobile node.  Any packet that\
    \ the mobile\n   node sends to any correspondent node will be received by the\
    \ mobile\n   access gateway and will be sent to its local mobility anchor through\n\
    \   the bi-directional tunnel.  The local mobility anchor on the other\n   end\
    \ of the tunnel, after receiving the packet, removes the outer\n   header and\
    \ routes the packet to the destination.  However, in some\n   cases, the traffic\
    \ sent to a correspondent node that is locally\n   connected to the mobile access\
    \ gateway may be locally routed by the\n   mobile access gateway (refer to Section\
    \ 6.10.3).\n    +-----+          +-----+          +-----+          +-----+\n \
    \   | MN  |          |p-MAG|          | LMA |          |n-MAG|\n    +-----+  \
    \        +-----+          +-----+          +-----+\n       |                |\
    \                |                |\n       |                |==Bi-Dir Tunnel=|\
    \                |\n   MN Detached          |                |               \
    \ |\n       |         MN Detached Event       |                |\n       |   \
    \             |                |                |\n       |                |--\
    \ DeReg PBU -->|                |\n       |                |                |\
    \                |\n       |                |            Accept PBU          \
    \ |\n       |                |   (Start MinDelayBeforeBCEDelete Timer)\n     \
    \  |                |                |                |\n       |            \
    \    |<-------- PBA --|                |\n       |                |          \
    \      |                |\n   MN Attached          |                |        \
    \        |\n       |                |                |   MN Attached event received\n\
    \       |                |                |     from MN or from network\n    \
    \   |                |                |   (Acquire MN-Id and Profile)\n      \
    \ |                |                |                |\n       |--- Rtr Sol ------------------------------------->|\n\
    \                               ....\n                                    Registration\
    \ steps as in Fig. 2.\n                               ....\n       |         \
    \       |                |==Bi-Dir Tunnel=|\n       |                |       \
    \         |                |\n       |<------------------------------------ Rtr\
    \ Adv ----|\n       |                |                |                |\n   MN\
    \ retains HoA/HNP(s)\n       |                |                |             \
    \   |\n            Figure 3: Mobile Node Handoff - Signaling Call Flow\n   Figure\
    \ 3 shows the signaling call flow for the mobile node's handoff\n   from the previously\
    \ attached mobile access gateway (p-MAG) to the\n   newly attached mobile access\
    \ gateway (n-MAG).  This call flow only\n   reflects a specific message ordering,\
    \ it is possible the registration\n   message from the n-MAG may arrive before\
    \ the de-registration message\n   from the p-MAG arrives.\n   After obtaining\
    \ the initial address configuration in the Proxy Mobile\n   IPv6 domain, if the\
    \ mobile node changes its point of attachment, the\n   mobile access gateway on\
    \ the previous link will detect the mobile\n   node's detachment from the link.\
    \  It will signal the local mobility\n   anchor and will remove the binding and\
    \ routing state for that mobile\n   node.  The local mobility anchor, upon receiving\
    \ this request, will\n   identify the corresponding mobility session for which\
    \ the request was\n   received, and accepts the request after which it waits for\
    \ a certain\n   amount of time to allow the mobile access gateway on the new link\
    \ to\n   update the binding.  However, if it does not receive any Proxy\n   Binding\
    \ Update message within the given amount of time, it will\n   delete the binding\
    \ cache entry.\n   The mobile access gateway on the new access link, upon detecting\
    \ the\n   mobile node on its access link, will signal the local mobility anchor\n\
    \   to update the binding state.  After completion of the signaling, the\n   serving\
    \ mobile access gateway will send the Router Advertisements\n   containing the\
    \ mobile node's home network prefix(es), and this will\n   ensure the mobile node\
    \ will not detect any change with respect to the\n   layer-3 attachment of its\
    \ interface.\n"
- title: 4.  Proxy Mobile IPv6 Protocol Security
  contents:
  - "4.  Proxy Mobile IPv6 Protocol Security\n   The signaling messages, Proxy Binding\
    \ Update, and Proxy Binding\n   Acknowledgement, exchanged between the mobile\
    \ access gateway and the\n   local mobility anchor, MUST be protected using end-to-end\
    \ security\n   association(s) offering integrity and data origin authentication.\n\
    \   The mobile access gateway and the local mobility anchor MUST\n   implement\
    \ IPsec for protecting the Proxy Mobile IPv6 signaling\n   messages [RFC4301].\
    \  IPsec is a mandatory-to-implement security\n   mechanism.  However, additional\
    \ documents may specify alternative\n   mechanisms and the mobility entities can\
    \ enable a specific mechanism\n   for securing Proxy Mobile IPv6 signaling messages,\
    \ based on either a\n   static configuration or after a dynamic negotiation using\
    \ any\n   standard security negotiation protocols.  As in Mobile IPv6\n   [RFC3775],\
    \ the use of IPsec for protecting a mobile node's data\n   traffic is optional.\n\
    \   IPsec Encapsulating Security Payload (ESP) [RFC4303] in transport\n   mode\
    \ with mandatory integrity protection SHOULD be used for\n   protecting the signaling\
    \ messages.  Confidentiality protection of\n   these messages is not required.\n\
    \   IPsec ESP [RFC4303] in tunnel mode MAY be used to protect the mobile\n   node's\
    \ tunneled data traffic, if protection of data traffic is\n   required.\n   Internet\
    \ Key Exchange Protocol version 2 (IKEv2) [RFC4306] SHOULD be\n   used to set\
    \ up security associations between the mobile access\n   gateway and the local\
    \ mobility anchor to protect the Proxy Binding\n   Update and Proxy Binding Acknowledgement\
    \ messages.  The mobile access\n   gateway and the local mobility anchor can use\
    \ any of the\n   authentication mechanisms, as specified in [RFC4306], for mutual\n\
    \   authentication.\n   The Mobile IPv6 specification [RFC3775] requires the home\
    \ agent to\n   prevent a mobile node from creating security associations or creating\n\
    \   binding cache entries for another mobile node's home address.  In the\n  \
    \ protocol described in this document, the mobile node is not involved\n   in\
    \ creating security associations for protecting the signaling\n   messages or\
    \ sending binding updates.  Therefore, the local mobility\n   anchor MUST restrict\
    \ the creation and manipulation of proxy bindings\n   to specifically authorized\
    \ mobile access gateways and prefixes.  The\n   local mobility anchor MUST be\
    \ locally configurable to authorize such\n   specific combinations.  Additional\
    \ mechanisms, such as a policy store\n   or Authentication, Authorization, and\
    \ Accounting (AAA) may be\n   employed, but these are outside the scope of this\
    \ specification.\n   Unlike in Mobile IPv6 [RFC3775], these signaling messages\
    \ do not\n   carry either the Home Address destination option or the Type 2\n\
    \   Routing header, and hence the policy entries and security association\n  \
    \ selectors stay the same and require no special IPsec related\n   considerations.\n"
- title: 4.1.  Peer Authorization Database (PAD) Example Entries
  contents:
  - "4.1.  Peer Authorization Database (PAD) Example Entries\n   This section describes\
    \ PAD entries [RFC4301] on the mobile access\n   gateway and the local mobility\
    \ anchor.  The PAD entries are only\n   example configurations.  Note that the\
    \ PAD is a logical concept and a\n   particular mobile access gateway or a local\
    \ mobility anchor\n   implementation can implement the PAD in any implementation-specific\n\
    \   manner.  The PAD state may also be distributed across various\n   databases\
    \ in a specific implementation.\n   In the example shown below, the identity of\
    \ the local mobility anchor\n   is assumed to be lma_identity_1 and the identity\
    \ of the mobile access\n   gateway is assumed to be mag_identity_1.\n       mobile\
    \ access gateway PAD:\n         - IF remote_identity = lma_identity_1\n      \
    \        Then authenticate (shared secret/certificate/EAP)\n              and\
    \ authorize CHILD_SAs for remote address lma_address_1\n       local mobility\
    \ anchor PAD:\n         - IF remote_identity = mag_identity_1\n              Then\
    \ authenticate (shared secret/certificate/EAP)\n              and authorize CHILD_SAs\
    \ for remote address mag_address_1\n                           Figure 4: PAD Entries\n\
    \   The list of authentication mechanisms in the above examples is not\n   exhaustive.\
    \  There could be other credentials used for authentication\n   stored in the\
    \ PAD.\n"
- title: 4.2.  Security Policy Database (SPD) Example Entries
  contents:
  - "4.2.  Security Policy Database (SPD) Example Entries\n   This section describes\
    \ the security policy entries [RFC4301] on the\n   mobile access gateway and the\
    \ local mobility anchor required to\n   protect the Proxy Mobile IPv6 signaling\
    \ messages.  The SPD entries\n   are only example configurations.  A particular\
    \ mobile access gateway\n   or a local mobility anchor implementation could configure\
    \ different\n   SPD entries as long as they provide the required security.\n \
    \  In the example shown below, the identity of the mobile access gateway\n   is\
    \ assumed to be mag_identity_1, the address of the mobile access\n   gateway is\
    \ assumed to be mag_address_1, and the address of the local\n   mobility anchor\
    \ is assumed to be lma_address_1.  The acronym MH\n   represents the protocol\
    \ number for the Mobility Header [RFC3775],\n   while the terms local_mh_type\
    \ and remote_mh_type stand for local\n   mobility header type and remote mobility\
    \ header type, respectively.\n      mobile access gateway SPD-S:\n        - IF\
    \ local_address = mag_address_1 &\n             remote_address = lma_address_1\
    \ &\n             proto = MH & (local_mh_type = BU | remote_mh_type = BA)\n  \
    \        Then use SA ESP transport mode\n          Initiate using IDi = mag_identity_1\
    \ to address lma_address_1\n      local mobility anchor SPD-S:\n        - IF local_address\
    \ = lma_address_1 &\n             remote_address = mag_address_1 &\n         \
    \    proto = MH & (local_mh_type = BA | remote_mh_type = BU)\n          Then use\
    \ SA ESP transport mode\n                           Figure 5: SPD Entries\n"
- title: 5.  Local Mobility Anchor Operation
  contents:
  - "5.  Local Mobility Anchor Operation\n   The local mobility anchor MUST support\
    \ the home agent function as\n   defined in [RFC3775] and the extensions defined\
    \ in this\n   specification.  A home agent with these modifications and enhanced\n\
    \   capabilities for supporting the Proxy Mobile IPv6 protocol is\n   referred\
    \ to as a local mobility anchor.\n   This section describes the operational details\
    \ of the local mobility\n   anchor.\n"
- title: 5.1.  Extensions to Binding Cache Entry Data Structure
  contents:
  - "5.1.  Extensions to Binding Cache Entry Data Structure\n   Every local mobility\
    \ anchor MUST maintain a Binding Cache entry for\n   each currently registered\
    \ mobile node.  A Binding Cache entry is a\n   conceptual data structure, described\
    \ in Section 9.1 of [RFC3775].\n   For supporting this specification, the Binding\
    \ Cache Entry data\n   structure needs to be extended with the following additional\
    \ fields.\n   o  A flag indicating whether or not this Binding Cache entry is\n\
    \      created due to a proxy registration.  This flag is set to value 1\n   \
    \   for Binding Cache entries that are proxy registrations and is set\n      to\
    \ value 0 for all other entries.\n   o  The identifier of the registered mobile\
    \ node, MN-Identifier.  This\n      identifier is obtained from the Mobile Node\
    \ Identifier Option\n      [RFC4283] present in the received Proxy Binding Update\
    \ message.\n   o  The link-layer identifier of the mobile node's connected interface\n\
    \      on the access link.  This identifier can be acquired from the\n      Mobile\
    \ Node Link-layer Identifier option, present in the received\n      Proxy Binding\
    \ Update message.  If the option was not present in\n      the request, this variable\
    \ length field MUST be set to two\n      (octets) and MUST be initialized to a\
    \ value of ALL_ZERO.\n   o  The link-local address of the mobile access gateway\
    \ on the point-\n      to-point link shared with the mobile node.  This is generated\
    \ by\n      the local mobility anchor after accepting the initial Proxy\n    \
    \  Binding Update message.\n   o  A list of IPv6 home network prefixes assigned\
    \ to the mobile node's\n      connected interface.  The home network prefix(es)\
    \ may have been\n      statically configured in the mobile node's policy profile,\
    \ or,\n      they may have been dynamically allocated by the local mobility\n\
    \      anchor.  Each one of these prefix entries will also include the\n     \
    \ corresponding prefix length.\n   o  The tunnel interface identifier (tunnel-if-id)\
    \ of the bi-\n      directional tunnel between the local mobility anchor and the\n\
    \      mobile access gateway where the mobile node is currently anchored.\n  \
    \    This is internal to the local mobility anchor.  The tunnel\n      interface\
    \ identifier is acquired during the tunnel creation.\n   o  The access technology\
    \ type, by which the mobile node is currently\n      attached.  This is obtained\
    \ from the Access Technology Type\n      option, present in the Proxy Binding\
    \ Update message.\n   o  The 64-bit timestamp value of the most recently accepted\
    \ Proxy\n      Binding Update message sent for this mobile node.  This is the\n\
    \      time of day on the local mobility anchor, when the message was\n      received.\
    \  If the Timestamp option is not present in the Proxy\n      Binding Update message\
    \ (i.e., when the sequence-number-based\n      scheme is in use), the value MUST\
    \ be set to ALL_ZERO.\n   Typically, any one of the mobile node's home network\
    \ prefixes from\n   its mobility session may be used as a key for locating its\
    \ Binding\n   Cache entry in all cases except when there has been a handoff of\
    \ the\n   mobile node's session to a new mobile access gateway, and that mobile\n\
    \   access gateway is unaware of the home network prefix(es) assigned to\n   that\
    \ mobility session.  In such handoff cases, the Binding Cache\n   entry can be\
    \ located under the considerations specified in Section\n   5.4.1.\n"
- title: 5.2.  Supported Home Network Prefix Models
  contents:
  - "5.2.  Supported Home Network Prefix Models\n   This specification supports the\
    \ Per-MN-Prefix model and does not\n   support the Shared-Prefix model.  According\
    \ to the Per-MN-Prefix\n   model, home network prefix(es) assigned to a mobile\
    \ node are for that\n   mobile node's exclusive use and no other node shares an\
    \ address from\n   that prefix (other than the Subnet-Router anycast address [RFC4291]\n\
    \   that is used by the mobile access gateway hosting that prefix on that\n  \
    \ link).\n   There may be more than one prefix assigned to a given interface of\n\
    \   the mobile node; all of those assigned prefixes MUST be unique to\n   that\
    \ mobile node, and all are part of exactly one mobility session.\n   If the mobile\
    \ node simultaneously attaches to the Proxy Mobile IPv6\n   domain through multiple\
    \ interfaces, each of the attached interfaces\n   MUST be assigned one or more\
    \ unique prefixes.  Prefixes that are not\n   assigned to the same interface MUST\
    \ NOT be managed under the same\n   mobility session.\n   The mobile node's home\
    \ network prefix(es) assigned to a given\n   interface of a mobile node (part\
    \ of a mobility session) will be\n   hosted on the access link where the mobile\
    \ node is attached (using\n   that interface).  The local mobility anchor is not\
    \ required to\n   perform any proxy Neighbor Discovery (ND) operations [RFC4861]\
    \ for\n   defending the mobile node's home address(es), as the prefixes are not\n\
    \   locally hosted on the local mobility anchor.  However, from the\n   routing\
    \ perspective, the home network prefix(es) is topologically\n   anchored on the\
    \ local mobility anchor.\n"
- title: 5.3.  Signaling Considerations
  contents:
  - "5.3.  Signaling Considerations\n   This section provides the rules for processing\
    \ the signaling\n   messages.  The processing rules specified in this section\
    \ and other\n   related sections are chained and are in a specific order.  When\n\
    \   applying these considerations for processing the signaling messages,\n   the\
    \ specified order MUST be maintained.\n"
- title: 5.3.1.  Processing Proxy Binding Updates
  contents:
  - "5.3.1.  Processing Proxy Binding Updates\n   1.   The received Proxy Binding\
    \ Update message (a Binding Update\n        message with the (P) flag set to value\
    \ of 1, format specified in\n        Section 8.1) MUST be authenticated as described\
    \ in Section 4.\n        When IPsec is used for message authentication, the Security\n\
    \        Parameter Index (SPI) in the IPsec header [RFC4306] of the\n        received\
    \ packet is needed for locating the security association,\n        for authenticating\
    \ the Proxy Binding Update message.\n   2.   The local mobility anchor MUST observe\
    \ the rules described in\n        Section 9.2 of [RFC3775] when processing the\
    \ Mobility Header in\n        the received Proxy Binding Update message.\n   3.\
    \   The local mobility anchor MUST ignore the check, specified in\n        Section\
    \ 10.3.1 of [RFC3775], related to the presence of the Home\n        Address destination\
    \ option in the Proxy Binding Update message.\n   4.   The local mobility anchor\
    \ MUST identify the mobile node from the\n        identifier present in the Mobile\
    \ Node Identifier option\n        [RFC4283] of the Proxy Binding Update message.\
    \  If the Mobile\n        Node Identifier option is not present in the Proxy Binding\n\
    \        Update message, the local mobility anchor MUST reject the\n        request\
    \ and send a Proxy Binding Acknowledgement message with\n        Status field\
    \ set to MISSING_MN_IDENTIFIER_OPTION (Missing Mobile\n        Node Identifier\
    \ option) and the identifier in the Mobile Node\n        Identifier option carried\
    \ in the message MUST be set to a zero\n        length identifier.\n   5.   The\
    \ local mobility anchor MUST apply the required policy checks,\n        as explained\
    \ in Section 4, to verify that the sender is a\n        trusted mobile access\
    \ gateway authorized to send Proxy Binding\n        Update messages on behalf\
    \ of this mobile node.\n   6.   If the local mobility anchor determines that the\
    \ requesting node\n        is not authorized to send Proxy Binding Update messages\
    \ for the\n        identified mobile node, it MUST reject the request and send\
    \ a\n        Proxy Binding Acknowledgement message with the Status field set\n\
    \        to MAG_NOT_AUTHORIZED_FOR_PROXY_REG (not authorized to send\n       \
    \ proxy binding updates).\n   7.   If the local mobility anchor cannot identify\
    \ the mobile node\n        based on the identifier present in the Mobile Node\
    \ Identifier\n        option [RFC4283] of the Proxy Binding Update message, it\
    \ MUST\n        reject the request and send a Proxy Binding Acknowledgement\n\
    \        message with the Status field set to\n        NOT_LMA_FOR_THIS_MOBILE_NODE\
    \ (Not a local mobility anchor for\n        this mobile node).\n   8.   If the\
    \ local mobility anchor determines that the mobile node is\n        not authorized\
    \ for the network-based mobility management\n        service, it MUST reject the\
    \ request and send a Proxy Binding\n        Acknowledgement message with the Status\
    \ field set to\n        PROXY_REG_NOT_ENABLED (Proxy Registration not enabled).\n\
    \   9.   The local mobility anchor MUST apply the considerations\n        specified\
    \ in Section 5.5 for processing the Sequence Number\n        field and the Timestamp\
    \ option (if present) in the Proxy Binding\n        Update message.\n   10.  If\
    \ there is no Home Network Prefix option(s) (with any value)\n        present\
    \ in the Proxy Binding Update message, the local mobility\n        anchor MUST\
    \ reject the request and send a Proxy Binding\n        Acknowledgement message\
    \ with the Status field set to\n        MISSING_HOME_NETWORK_PREFIX_OPTION (Missing\
    \ Home Network Prefix\n        option).\n   11.  If the Handoff Indicator option\
    \ is not present in the Proxy\n        Binding Update message, the local mobility\
    \ anchor MUST reject\n        the request and send a Proxy Binding Acknowledgement\
    \ message\n        with the Status field set to MISSING_HANDOFF_INDICATOR_OPTION\n\
    \        (Missing Handoff Indicator option).\n   12.  If the Access Technology\
    \ Type option is not present in the Proxy\n        Binding Update message, the\
    \ local mobility anchor MUST reject\n        the request and send a Proxy Binding\
    \ Acknowledgement message\n        with the Status field set to MISSING_ACCESS_TECH_TYPE_OPTION\n\
    \        (Missing Access Technology Type option).\n   13.  Considerations specified\
    \ in Section 5.4.1 MUST be applied for\n        performing the Binding Cache entry\
    \ existence test.  If those\n        checks specified in Section 5.4.1 result\
    \ in associating the\n        received Proxy Binding Update message to a new mobility\
    \ session\n        creation request, considerations from Section 5.3.2 (Initial\n\
    \        Binding Registration - New Mobility Session), MUST be applied.\n    \
    \    If those checks result in associating the request to an existing\n      \
    \  mobility session, the following checks determine the next set of\n        processing\
    \ rules that need to be applied.\n        *  If the received Proxy Binding Update\
    \ message has the lifetime\n           value of zero, considerations from Section\
    \ 5.3.5 (Binding De-\n           Registration) MUST be applied.\n        *  If\
    \ the Proxy-CoA in the Binding Cache entry matches the\n           source address\
    \ of the request (or the address in the\n           Alternate Care-of Address\
    \ option, if the option is present),\n           considerations from Section 5.3.3\
    \ (Binding LIfetime Extension\n           - No handoff) MUST be applied.\n   \
    \     *  For all other cases, considerations from Section 5.3.4\n           (Binding\
    \ Lifetime Extension - After handoff) MUST be applied.\n   14.  When sending the\
    \ Proxy Binding Acknowledgement message with any\n        Status field value,\
    \ the message MUST be constructed as specified\n        in Section 5.3.6.\n"
- title: 5.3.2.  Initial Binding Registration (New Mobility Session)
  contents:
  - "5.3.2.  Initial Binding Registration (New Mobility Session)\n   1.  If there\
    \ is at least one instance of the Home Network Prefix\n       option present in\
    \ the Proxy Binding Update message with the\n       prefix value set to ALL_ZERO,\
    \ the local mobility anchor MUST\n       allocate one or more home network prefixes\
    \ to the mobile node and\n       assign it to the new mobility session created\
    \ for the mobile\n       node.  The local mobility anchor MUST ensure the allocated\n\
    \       prefix(es) is not in use by any other node or mobility session.\n    \
    \   The decision on how many prefixes to be allocated for the\n       attached\
    \ interface can be based on a global policy or a policy\n       specific to that\
    \ mobile node.  However, when stateful address\n       autoconfiguration using\
    \ DHCP is supported on the link,\n       considerations from Section 6.11 MUST\
    \ be applied for the prefix\n       assignment.\n   2.  If the local mobility\
    \ anchor is unable to allocate any home\n       network prefix for the mobile\
    \ node, it MUST reject the request\n       and send a Proxy Binding Acknowledgement\
    \ message with the Status\n       field set to 130 (Insufficient resources).\n\
    \   3.  If there are one or more Home Network Prefix options present in\n    \
    \   the Proxy Binding Update message (with each of the prefixes set\n       to\
    \ a NON_ZERO value), the local mobility anchor, before accepting\n       that\
    \ request, MUST ensure each one of those prefixes is owned by\n       the local\
    \ mobility anchor, and further that the mobile node is\n       authorized to use\
    \ these prefixes.  If the mobile node is not\n       authorized to use any one\
    \ or more of those prefixes, the local\n       mobility anchor MUST reject the\
    \ request and send a Proxy Binding\n       Acknowledgement message with the Status\
    \ field set to\n       NOT_AUTHORIZED_FOR_HOME_NETWORK_PREFIX (mobile node not\n\
    \       authorized for one or more of the requesting home network\n       prefixes).\n\
    \   4.  Upon accepting the request, the local mobility anchor MUST create\n  \
    \     a Binding Cache entry for the mobile node.  It must set the\n       fields\
    \ in the Binding Cache entry to the accepted values for that\n       registration.\n\
    \   5.  If there is no existing bi-directional tunnel to the mobile\n       access\
    \ gateway that sent the request, the local mobility anchor\n       MUST establish\
    \ a bi-directional tunnel to that mobile access\n       gateway.  Considerations\
    \ from Section 5.6.1 MUST be applied for\n       managing the dynamically created\
    \ bi-directional tunnel.\n   6.  The local mobility anchor MUST create a prefix\
    \ route(s) over the\n       tunnel to the mobile access gateway for forwarding\
    \ any traffic\n       received for the mobile node's home network prefix(es) associated\n\
    \       with this mobility session.  The created tunnel and the routing\n    \
    \   state MUST result in the forwarding behavior on the local\n       mobility\
    \ anchor as specified in Section 5.6.2.\n   7.  The local mobility anchor MUST\
    \ send the Proxy Binding\n       Acknowledgement message with the Status field\
    \ set to 0 (Proxy\n       Binding Update Accepted).  The message MUST be constructed\
    \ as\n       specified in Section 5.3.6.\n"
- title: 5.3.3.  Binding Lifetime Extension (No Handoff)
  contents:
  - "5.3.3.  Binding Lifetime Extension (No Handoff)\n   1.  Upon accepting the Proxy\
    \ Binding Update message for extending the\n       binding lifetime, received\
    \ from the same mobile access gateway\n       (if the Proxy-CoA in the Binding\
    \ Cache entry is the same as the\n       Proxy-CoA in the request) that last updated\
    \ the binding, the\n       local mobility anchor MUST update the Binding Cache\
    \ entry with\n       the accepted registration values.\n   2.  The local mobility\
    \ anchor MUST send the Proxy Binding\n       Acknowledgement message with the\
    \ Status field set to 0 (Proxy\n       Binding Update Accepted).  The message\
    \ MUST be constructed as\n       specified in Section 5.3.6.\n"
- title: 5.3.4.  Binding Lifetime Extension (After Handoff)
  contents:
  - "5.3.4.  Binding Lifetime Extension (After Handoff)\n   1.  Upon accepting the\
    \ Proxy Binding Update message for extending the\n       binding lifetime, received\
    \ from a new mobile access gateway (if\n       the Proxy-CoA in the Binding Cache\
    \ entry does not match the\n       Proxy-CoA in the request) where the mobile\
    \ node's mobility\n       session is handed off, the local mobility anchor MUST\
    \ update the\n       Binding Cache entry with the accepted registration values.\n\
    \   2.  The local mobility anchor MUST remove the previously created\n       route(s)\
    \ for the mobile node's home network prefix(es) associated\n       with this mobility\
    \ session.  Additionally, if there are no other\n       mobile nodes sharing the\
    \ dynamically created bi-directional\n       tunnel to the previous mobile access\
    \ gateway, the tunnel SHOULD\n       be deleted, applying considerations from\
    \ section 5.6.1 (if the\n       tunnel is a dynamically created tunnel and not\
    \ a fixed pre-\n       established tunnel).\n   3.  If there is no existing bi-directional\
    \ tunnel to the mobile\n       access gateway that sent the request, the local\
    \ mobility anchor\n       MUST establish a bi-directional tunnel to that mobile\
    \ access\n       gateway.  Considerations from Section 5.6.1 MUST be applied for\n\
    \       managing the dynamically created bi-directional tunnel.\n   4.  The local\
    \ mobility anchor MUST create prefix route(s) over the\n       tunnel to the mobile\
    \ access gateway for forwarding any traffic\n       received for the mobile node's\
    \ home network prefix(es) associated\n       with that mobility session.  The\
    \ created tunnel and routing state\n       MUST result in the forwarding behavior\
    \ on the local mobility\n       anchor as specified in Section 5.6.2.\n   5. \
    \ The local mobility anchor MUST send the Proxy Binding\n       Acknowledgement\
    \ message with the Status field set to 0 (Proxy\n       Binding Update Accepted).\
    \  The message MUST be constructed as\n       specified in Section 5.3.6.\n"
- title: 5.3.5.  Binding De-Registration
  contents:
  - "5.3.5.  Binding De-Registration\n   1.  If the received Proxy Binding Update\
    \ message with the lifetime\n       value of zero, has a Source Address in the\
    \ IPv6 header (or the\n       address in the Alternate Care-of Address option,\
    \ if the option is\n       present) different from what is present in the Proxy-CoA\
    \ field in\n       the Binding Cache entry, the local mobility anchor MUST ignore\n\
    \       the request.\n   2.  Upon accepting the Proxy Binding Update message,\
    \ with the\n       lifetime value of zero, the local mobility anchor MUST wait\
    \ for\n       MinDelayBeforeBCEDelete amount of time, before it deletes the\n\
    \       Binding Cache entry.  However, it MUST send the Proxy Binding\n      \
    \ Acknowledgement message with the Status field set to 0 (Proxy\n       Binding\
    \ Update Accepted).  The message MUST be constructed as\n       specified in Section\
    \ 5.3.6.\n       *  During this wait period, the local mobility anchor SHOULD\
    \ drop\n          the mobile node's data traffic.\n       *  During this wait\
    \ period, if the local mobility anchor receives\n          a valid Proxy Binding\
    \ Update message for the same mobility\n          session with the lifetime value\
    \ of greater than zero, and if\n          that request is accepted, then the Binding\
    \ Cache entry MUST\n          NOT be deleted, but must be updated with the newly\
    \ accepted\n          registration values, and the wait period should be ended.\n\
    \       *  By the end of this wait period, if the local mobility anchor\n    \
    \      did not receive any valid Proxy Binding Update messages for\n         \
    \ this mobility session, then it MUST delete the Binding Cache\n          entry\
    \ and remove the routing state created for that mobility\n          session. \
    \ The local mobility anchor can potentially reassign\n          the prefix(es)\
    \ associated with this mobility session to other\n          mobile nodes.\n"
- title: 5.3.6.  Constructing the Proxy Binding Acknowledgement Message
  contents:
  - "5.3.6.  Constructing the Proxy Binding Acknowledgement Message\n   o  The local\
    \ mobility anchor, when sending the Proxy Binding\n      Acknowledgement message\
    \ to the mobile access gateway, MUST\n      construct the message as specified\
    \ below.\n          IPv6 header (src=LMAA, dst=Proxy-CoA)\n            Mobility\
    \ header\n               - BA    /* P flag must be set to value of 1 */\n    \
    \          Mobility Options\n               - Mobile Node Identifier option  \
    \          (mandatory)\n               - Home Network Prefix option(s)       \
    \     (mandatory)\n               - Handoff Indicator option                 (mandatory)\n\
    \               - Access Technology Type option            (mandatory)\n     \
    \          - Timestamp option                         (optional)\n           \
    \    - Mobile Node Link-layer Identifier option (optional)\n               - Link-local\
    \ Address option                (optional)\n            Figure 6: Proxy Binding\
    \ Acknowledgement Message Format\n   o  The Source Address field in the IPv6 header\
    \ of the message MUST be\n      set to the destination address of the received\
    \ Proxy Binding\n      Update message.\n   o  The Destination Address field in\
    \ the IPv6 header of the message\n      MUST be set to the source address of the\
    \ received Proxy Binding\n      Update message.  When there is no Alternate Care-of\
    \ Address option\n      present in the request, the destination address is the\
    \ same as the\n      Proxy-CoA; otherwise, the address may not be the same as\
    \ the\n      Proxy-CoA.\n   o  The Mobile Node Identifier option [RFC4283] MUST\
    \ be present.  The\n      identifier field in the option MUST be copied from the\
    \ Mobile Node\n      Identifier option in the received Proxy Binding Update message.\n\
    \      If the option was not present in the request, the identifier in\n     \
    \ the option MUST be set to a zero length identifier.\n   o  At least one Home\
    \ Network Prefix option MUST be present.\n      *  If the Status field is set\
    \ to a value greater than or equal to\n         128, i.e., if the Proxy Binding\
    \ Update is rejected, all the\n         Home Network Prefix options that were\
    \ present in the request\n         (along with their prefix values) MUST be present\
    \ in the reply.\n         But, if there was no Home Network Prefix option present\
    \ in the\n         request, then there MUST be only one Home Network Prefix option\n\
    \         with the value in the option set to ALL_ZERO.\n      *  For all other\
    \ cases, there MUST be a Home Network Prefix option\n         for each of the\
    \ assigned home network prefixes (for that\n         mobility session), and with\
    \ the prefix value in the option set\n         to the allocated prefix value.\n\
    \   o  The Handoff Indicator option MUST be present.  The handoff\n      indicator\
    \ field in the option MUST be copied from the Handoff\n      Indicator option\
    \ in the received Proxy Binding Update message.  If\n      the option was not\
    \ present in the request, the value in the option\n      MUST be set to zero.\n\
    \   o  The Access Technology Type option MUST be present.  The access\n      technology\
    \ type field in the option MUST be copied from the Access\n      Technology Type\
    \ option in the received Proxy Binding Update\n      message.  If the option was\
    \ not present in the request, the value\n      in the option MUST be set to zero.\n\
    \   o  The Timestamp option MUST be present only if the same option was\n    \
    \  present in the received Proxy Binding Update message and MUST NOT\n      be\
    \ present otherwise.  Considerations from Section 5.5 must be\n      applied for\
    \ constructing the Timestamp option.\n   o  The Mobile Node Link-layer Identifier\
    \ option MUST be present only\n      if the same option was present in the received\
    \ Proxy Binding\n      Update message and MUST NOT be present otherwise.  The\
    \ link-layer\n      identifier value MUST be copied from the Mobile Node Link-layer\n\
    \      Identifier option present in the received Proxy Binding Update\n      message.\n\
    \   o  The Link-local Address option MUST be present only if the same\n      option\
    \ was present in the received Proxy Binding Update message\n      and MUST NOT\
    \ be present otherwise.  If the Status field in the\n      reply is set to a value\
    \ greater than or equal to 128, i.e., if the\n      Proxy Binding Update is rejected,\
    \ then the link-local address from\n      the request MUST be copied to the Link-local\
    \ Address option in the\n      reply, otherwise the following considerations apply.\n\
    \      *  If the received Proxy Binding Update message has the Link-local\n  \
    \       Address option with ALL_ZERO value and if there is an existing\n     \
    \    Binding Cache entry associated with this request, then the\n         link-local\
    \ address from the Binding Cache entry MUST be copied\n         to the Link-local\
    \ Address option in the reply.\n      *  If the received Proxy Binding Update\
    \ message has the Link-local\n         Address option with ALL_ZERO value and\
    \ if there is no existing\n         Binding Cache entry associated with this request,\
    \ then the\n         local mobility anchor MUST generate the link-local address\
    \ that\n         the mobile access gateway can use on the point-to-point link\n\
    \         shared with the mobile node.  This generated address MUST be\n     \
    \    copied to the Link-local Address option in the reply.  The same\n       \
    \  address MUST also be copied to the link-local address field of\n         Binding\
    \ Cache entry created for this mobility session.\n      *  If the received Proxy\
    \ Binding Update message has the Link-local\n         Address option with NON_ZERO\
    \ value, then the link-local address\n         from the request MUST be copied\
    \ to the Link-local Address\n         option in the reply.  The same address MUST\
    \ also be copied to\n         the link-local address field of the Binding Cache\
    \ entry\n         associated with this request (after creating the Binding Cache\n\
    \         entry, if one does not exist).\n   o  If IPsec is used for protecting\
    \ the signaling messages, the\n      message MUST be protected using the security\
    \ association existing\n      between the local mobility anchor and the mobile\
    \ access gateway.\n   o  Unlike in Mobile IPv6 [RFC3775], the Type 2 Routing header\
    \ MUST\n      NOT be present in the IPv6 header of the packet.\n"
- title: 5.4.  Multihoming Support
  contents:
  - "5.4.  Multihoming Support\n   This specification allows mobile nodes to connect\
    \ to a Proxy Mobile\n   IPv6 domain through multiple interfaces for simultaneous\
    \ access.  The\n   following are the key aspects of this multihoming support.\n\
    \   o  When a mobile node connects to a Proxy Mobile IPv6 domain through\n   \
    \   multiple interfaces for simultaneous access, the local mobility\n      anchor\
    \ MUST allocate a mobility session for each of the attached\n      interfaces.\
    \  Each mobility session should be managed under a\n      separate Binding Cache\
    \ entry and with its own lifetime.\n   o  The local mobility anchor MAY allocate\
    \ more than one home network\n      prefix for a given interface of the mobile\
    \ node.  However, all the\n      prefixes associated with a given interface MUST\
    \ be managed as part\n      of one mobility session, associated with that interface.\n\
    \   o  The local mobility anchor MUST allow for a handoff between two\n      different\
    \ interfaces of a mobile node.  In such a scenario, all\n      the home network\
    \ prefixes associated with one interface (part of\n      one mobility session)\
    \ will be associated with a different\n      interface of the mobile node.  The\
    \ decision on when to create a\n      new mobility session and when to update\
    \ an existing mobility\n      session MUST be based on the Handover hint present\
    \ in the Proxy\n      Binding Update message and under the considerations specified\
    \ in\n      this section.\n"
- title: 5.4.1.  Binding Cache Entry Lookup Considerations
  contents:
  - "5.4.1.  Binding Cache Entry Lookup Considerations\n   There can be multiple Binding\
    \ Cache entries for a given mobile node.\n   When doing a lookup for a mobile\
    \ node's Binding Cache entry for\n   processing a received Proxy Binding Update\
    \ message, the local\n   mobility anchor MUST apply the following multihoming\
    \ considerations\n   (in the below specified order, starting with Section 5.4.1.1).\
    \  These\n   rules are chained with the processing rules specified in Section\
    \ 5.3.\n"
- title: 5.4.1.1.  Home Network Prefix Option (NON_ZERO Value) Present in the
  contents:
  - "5.4.1.1.  Home Network Prefix Option (NON_ZERO Value) Present in the\n      \
    \    Request\n +=====================================================================+\n\
    \ |                Registration/De-Registration Message                 |\n +=====================================================================+\n\
    \ |             At least one HNP Option with NON_ZERO Value             |\n +=====================================================================+\n\
    \ |                                 ATT                                 |\n +=====================================================================+\n\
    \ |   MN-LL-Identifier Opt Present   | MN-LL-Identifier Opt Not Present |\n +=====================================================================+\n\
    \ |                                 HI                                  |\n +==================================+==================================+\n\
    \ | BCE Lookup Key: Any of the Home Network Prefixes from the request   |\n +=====================================================================+\n\
    \   Figure 7: Binding Cache Entry (BCE) Lookup Using Home Network Prefix\n   If\
    \ there is at least one Home Network Prefix option present in the\n   request\
    \ with a NON_ZERO prefix value and irrespective of the presence\n   of the Mobile\
    \ Node Link-layer Identifier option in the request, the\n   following considerations\
    \ MUST be applied.  If there is more than one\n   instance of the Home Network\
    \ Prefix option, any one of the Home\n   Network Prefix options present in the\
    \ request (with NON_ZERO prefix\n   value) can be used for locating the Binding\
    \ Cache entry.\n   1.  The local mobility anchor MUST verify if there is an existing\n\
    \       Binding Cache entry with one of its home network prefixes\n       matching\
    \ the prefix value in one of the Home Network Prefix\n       options of the received\
    \ Proxy Binding Update message.\n   2.  If a Binding Cache entry does not exist\
    \ (with one of its home\n       network prefixes in the Binding Cache entry matching\
    \ the prefix\n       value in one of the Home Network Prefix options of the received\n\
    \       Proxy Binding Update message), the request MUST be considered as\n   \
    \    a request for creating a new mobility session.\n   3.  If there exists a\
    \ Binding Cache entry (with one of its home\n       network prefixes in the Binding\
    \ Cache entry matching the prefix\n       value in one of the Home Network Prefix\
    \ options of the received\n       Proxy Binding Update message), but if the mobile\
    \ node identifier\n       in the entry does not match the mobile node identifier\
    \ in the\n       Mobile Node Identifier option of the received Proxy Binding\n\
    \       Update message, the local mobility anchor MUST reject the request\n  \
    \     with the Status field value set to\n       NOT_AUTHORIZED_FOR_HOME_NETWORK_PREFIX\
    \ (mobile node is not\n       authorized for one or more of the requesting home\
    \ network\n       prefixes).\n   4.  If there exists a Binding Cache entry (matching\
    \ MN-Identifier and\n       one of its home network prefixes in the Binding Cache\
    \ entry\n       matching the prefix value in one of the Home Network Prefix\n\
    \       options of the received Proxy Binding Update message), but if all\n  \
    \     the prefixes in the request do not match all the prefixes in the\n     \
    \  Binding Cache entry, or if they do not match in count, then the\n       local\
    \ mobility anchor MUST reject the request with the Status\n       field value\
    \ set to BCE_PBU_PREFIX_SET_DO_NOT_MATCH (all the home\n       network prefixes\
    \ listed in the BCE do not match all the prefixes\n       in the received PBU).\n\
    \   5.  If there exists a Binding Cache entry (matching MN-Identifier and\n  \
    \     all the home network prefixes in the Binding Cache entry matching\n    \
    \   all the home network prefixes in the received Proxy Binding\n       Update\
    \ message) and if any one or more of these below stated\n       conditions are\
    \ true, the request MUST be considered as a request\n       for updating that\
    \ Binding Cache entry.\n       *  If there is a Mobile Node Link-layer Identifier\
    \ option present\n          in the request and if the link-layer identifier in\
    \ the option\n          matches the link-layer identifier of the Binding Cache\
    \ entry\n          and the access technology type in the Access Technology Type\n\
    \          option present in the request matches the access technology\n     \
    \     type in the Binding Cache entry.\n       *  If the Handoff Indicator field\
    \ in the Handoff Indicator option\n          present in the request is set to\
    \ a value of 2 (Handoff between\n          two different interfaces of the mobile\
    \ node).\n       *  If there is no Mobile Node Link-layer Identifier option\n\
    \          present in the request, the link-layer identifier value in the\n  \
    \        Binding Cache entry is set to ALL_ZERO, the access technology\n     \
    \     type field in the Access Technology Type option present in the\n       \
    \   request matches the access technology type in the Binding\n          Cache\
    \ entry, and if the Handoff Indicator field in the Handoff\n          Indicator\
    \ option present in the request is set to a value of 3\n          (Handoff between\
    \ mobile access gateways for the same\n          interface).\n       *  If the\
    \ Proxy-CoA in the Binding Cache entry matches the source\n          address of\
    \ the request (or the address in the Alternate\n          Care-of Address option,\
    \ if the option is present) and if the\n          access technology type field\
    \ in the Access Technology Type\n          option present in the request matches\
    \ the access technology\n          type in the Binding Cache entry.\n   6.  For\
    \ all other cases, the message MUST be considered as a request\n       for creating\
    \ a new mobility session.  However, if the received\n       Proxy Binding Update\
    \ message has the lifetime value of zero and\n       if the request cannot be\
    \ associated with any existing mobility\n       session, the message MUST be silently\
    \ ignored.\n"
- title: 5.4.1.2.  Mobile Node Link-layer Identifier Option Present in the
  contents:
  - "5.4.1.2.  Mobile Node Link-layer Identifier Option Present in the\n         \
    \ Request\n +=====================================================================+\n\
    \ |                   Registration/De-Registration Message              |\n +=====================================================================+\n\
    \ |                  No HNP option with a NON_ZERO Value                |\n +=====================================================================+\n\
    \ |                                 ATT                                 |\n +=====================================================================+\n\
    \ |         MN-LL-Identifier Option Present (NON_ZERO Value)            |\n +=====================================================================+\n\
    \ |                                 HI                                  |\n +==================================+==================================+\n\
    \ |  BCE Lookup Keys: (MN-Identifier + ATT + MN-LL-Identifier)          |\n +=====================================================================+\n\
    \             Figure 8: BCE Lookup Using Link-layer Identifier\n   If there is\
    \ no Home Network Prefix option present in the request with\n   a NON_ZERO prefix\
    \ value, but if there is a Mobile Node Link-layer\n   Identifier option present\
    \ in the request, then the following\n   considerations MUST be applied for locating\
    \ the Binding Cache entry.\n   1.  The local mobility anchor MUST verify if there\
    \ is an existing\n       Binding Cache entry, with the mobile node identifier\
    \ matching the\n       identifier in the received Mobile Node Identifier option,\
    \ access\n       technology type matching the value in the received Access\n \
    \      Technology Type option, and the link-layer identifier value\n       matching\
    \ the identifier in the received Mobile Node Link-layer\n       Identifier option.\n\
    \   2.  If there exists a Binding Cache entry (matching MN-Identifier,\n     \
    \  Access Technology Type (ATT), and MN-LL-Identifier), the request\n       MUST\
    \ be considered as a request for updating that Binding Cache\n       entry.\n\
    \   3.  If there does not exist a Binding Cache entry (matching MN-\n       Identifier,\
    \ ATT, and MN-LL-Identifier) and the Handoff Indicator\n       field in the Handoff\
    \ Indicator option present in the request is\n       set to a value of 2 (Handoff\
    \ between two different interfaces of\n       the mobile node).  The local mobility\
    \ anchor MUST apply the\n       following additional considerations.\n       *\
    \  The local mobility anchor MUST verify if there exists one and\n          only\
    \ one Binding Cache entry with the mobile node identifier\n          matching\
    \ the identifier in the Mobile Node Identifier option\n          present in the\
    \ request and for any link-layer identifier\n          value.  If there exists\
    \ only one such entry (matching the MN-\n          Identifier), the request MUST\
    \ be considered as a request for\n          updating that Binding Cache entry.\n\
    \   4.  If there does not exist a Binding Cache entry (matching MN-\n       Identifier,\
    \ ATT, and MN-LL-Identifier) and if the Handoff\n       Indicator field in the\
    \ Handoff Indicator option present in the\n       request is set to a value of\
    \ 4 (Handoff state unknown), the local\n       mobility anchor MUST apply the\
    \ following additional\n       considerations.\n       *  The local mobility anchor\
    \ MUST verify if there exists one and\n          only one Binding Cache entry\
    \ with the mobile node identifier\n          matching the identifier in the Mobile\
    \ Node Identifier option\n          present in the request and for any link-layer\
    \ identifier\n          value.  If there exists only one such entry (matching\
    \ the MN-\n          Identifier), the local mobility anchor SHOULD wait until\
    \ the\n          existing Binding Cache entry is de-registered by the\n      \
    \    previously serving mobile access gateway, before the request\n          can\
    \ be considered as a request for updating that Binding Cache\n          entry.\
    \  However, if there is no de-registration message that\n          is received\
    \ within MaxDelayBeforeNewBCEAssign amount of time,\n          the local mobility\
    \ anchor, upon accepting the request, MUST\n          consider the request as\
    \ a request for creating a new mobility\n          session.  The local mobility\
    \ anchor MAY also choose to create\n          a new mobility session without waiting\
    \ for a de-registration\n          message, and this should be configurable on\
    \ the local mobility\n          anchor.\n   5.  For all other cases, the message\
    \ MUST be considered as a request\n       for creating a new mobility session.\
    \  However, if the received\n       Proxy Binding Update message has the lifetime\
    \ value of zero and\n       if the request cannot be associated with any existing\
    \ mobility\n       session, the message MUST be silently ignored.\n"
- title: 5.4.1.3.  Mobile Node Link-layer Identifier Option Not Present in the
  contents:
  - "5.4.1.3.  Mobile Node Link-layer Identifier Option Not Present in the\n     \
    \     Request\n +=====================================================================+\n\
    \ |                 Registration/De-Registration Message                |\n +=====================================================================+\n\
    \ |                 No HNP option with a NON_ZERO Value                 |\n +=====================================================================+\n\
    \ |                                 ATT                                 |\n +=====================================================================+\n\
    \ |                 MN-LL-Identifier Option Not Present                 |\n +=====================================================================+\n\
    \ |                                 HI                                  |\n +==================================+==================================+\n\
    \ |                   BCE Lookup Key: (MN-Identifier)                   |\n +=====================================================================+\n\
    \             Figure 9: BCE Lookup Using Mobile Node Identifier\n   If there is\
    \ no Home Network Prefix option present in the request with\n   a NON_ZERO prefix\
    \ value and if there is also no Mobile Node Link-\n   layer Identifier option\
    \ present in the request, then the following\n   considerations MUST be applied\
    \ for locating the Binding Cache entry.\n   1.  The local mobility anchor MUST\
    \ verify if there exists one and\n       only one Binding Cache entry with the\
    \ mobile node identifier\n       matching the identifier in the Mobile Node Identifier\
    \ option\n       present in the request.\n   2.  If there exists only one such\
    \ entry (matching the MN-Identifier)\n       and the Handoff Indicator field in\
    \ the Handoff Indicator option\n       present in the request is set to a value\
    \ of 2 (Handoff between\n       two different interfaces of the mobile node) or\
    \ set to a value of\n       3 (Handoff between mobile access gateways for the\
    \ same\n       interface), then the request MUST be considered as a request for\n\
    \       updating that Binding Cache entry.\n   3.  If there exists only one such\
    \ entry (matching the MN-Identifier)\n       and the Handoff Indicator field in\
    \ the Handoff Indicator option\n       present in the request is set to a value\
    \ of 4 (Handoff state\n       unknown), the local mobility anchor SHOULD wait\
    \ until the\n       existing Binding Cache entry is de-registered by the previously\n\
    \       serving mobile access gateway before the request can be\n       considered\
    \ as a request for updating that Binding Cache entry.\n       However, if there\
    \ is no de-registration message that is received\n       within MaxDelayBeforeNewBCEAssign\
    \ amount of time, the local\n       mobility anchor, upon accepting the request,\
    \ MUST consider the\n       request as a request for creating a new mobility session.\
    \  The\n       local mobility anchor MAY also choose to create a new mobility\n\
    \       session without waiting for a de-registration message, and this\n    \
    \   should be configurable on the local mobility anchor.\n   4.  For all other\
    \ cases, the message MUST be considered as a request\n       for creating a new\
    \ mobility session.  However, if the received\n       Proxy Binding Update message\
    \ has the lifetime value of zero and\n       if the request cannot be associated\
    \ with any existing mobility\n       session, the message MUST be silently ignored.\n"
- title: 5.5.  Timestamp Option for Message Ordering
  contents:
  - "5.5.  Timestamp Option for Message Ordering\n   Mobile IPv6 [RFC3775] uses the\
    \ Sequence Number field in binding\n   registration messages as a way for the\
    \ home agent to process the\n   binding updates in the order they were sent by\
    \ a mobile node.  The\n   home agent and the mobile node are required to manage\
    \ this counter\n   over the lifetime of a binding.  However, in Proxy Mobile IPv6,\
    \ as\n   the mobile node moves from one mobile access gateway to another and\n\
    \   in the absence of mechanisms such as context transfer between the\n   mobile\
    \ access gateways, the serving mobile access gateway will be\n   unable to determine\
    \ the sequence number that it needs to use in the\n   signaling messages.  Hence,\
    \ the sequence number scheme, as specified\n   in [RFC3775], will be insufficient\
    \ for Proxy Mobile IPv6.\n   If the local mobility anchor cannot determine the\
    \ sending order of\n   the received Proxy Binding Update messages, it may potentially\n\
    \   process an older message sent by a mobile access gateway where the\n   mobile\
    \ node was previously anchored, but delivered out of order,\n   resulting in incorrectly\
    \ updating the mobile node's Binding Cache\n   entry and creating a routing state\
    \ for tunneling the mobile node's\n   traffic to the previous mobile access gateway.\n\
    \   For solving this problem, this specification adopts two alternative\n   solutions.\
    \  One is based on timestamps and the other based on\n   sequence numbers, as\
    \ defined in [RFC3775].\n   The basic principle behind the use of timestamps in\
    \ binding\n   registration messages is that the node generating the message inserts\n\
    \   the current time of day, and the node receiving the message checks\n   that\
    \ this timestamp is greater than all previously accepted\n   timestamps.  The\
    \ timestamp-based solution may be used when the\n   serving mobile access gateways\
    \ in a Proxy Mobile IPv6 domain do not\n   have the ability to obtain the last\
    \ sequence number that was sent in\n   a Proxy Binding Update message for updating\
    \ a given mobile node's\n   binding.\n   Clock drift reduces the effectiveness\
    \ of the timestamp mechanism.\n   The time required for reconnection is the total\
    \ of the time required\n   for the mobile node to roam between two mobile access\
    \ gateways and\n   the time required for the serving mobile access gateway to\
    \ detect the\n   mobile node on its access link and construct the Proxy Binding\
    \ Update\n   message.  If the clock skew on any one of these two neighboring\n\
    \   mobile access gateways (relative to the common time source used for\n   clock\
    \ synchronization) is more than half this reconnection time, the\n   timestamp\
    \ solution will not predictably work in all cases and hence\n   SHOULD NOT be\
    \ used.\n   As an alternative to the Timestamp-based approach, the specification\n\
    \   also allows the use of Sequence-Number-based scheme, as specified in\n   [RFC3775].\
    \  However, for this scheme to work, the serving mobile\n   access gateway in\
    \ a Proxy Mobile IPv6 domain MUST have the ability to\n   obtain the last sequence\
    \ number that was sent in a binding\n   registration message for that mobility\
    \ session.  The sequence number\n   MUST be maintained on a mobile node's per\
    \ mobility session basis and\n   MUST be available to the serving mobile access\
    \ gateway.  This may be\n   achieved by using context transfer schemes or by maintaining\
    \ the\n   sequence number in a policy store.  However, the specific details on\n\
    \   how the mobile node's sequence number is made available to the\n   serving\
    \ mobile access gateway prior to sending the Proxy Binding\n   Update message\
    \ is outside the scope of this document.\n   Using the Timestamp-Based Approach:\n\
    \   1.  A local mobility anchor implementation MUST support the Timestamp\n  \
    \     option.  If the Timestamp option is present in the received Proxy\n    \
    \   Binding Update message, then the local mobility anchor MUST\n       include\
    \ a valid Timestamp option in the Proxy Binding\n       Acknowledgement message\
    \ that it sends to the mobile access\n       gateway.\n   2.  All the mobility\
    \ entities in a Proxy Mobile IPv6 domain that are\n       exchanging binding registration\
    \ messages using the Timestamp\n       option MUST have adequately synchronized\
    \ time-of-day clocks.\n       This is the essential requirement for this solution\
    \ to work.  If\n       this requirement is not met, the solution will not predictably\n\
    \       work in all cases.\n   3.  The mobility entities in a Proxy Mobile IPv6\
    \ domain SHOULD\n       synchronize their clocks to a common time source.  For\n\
    \       synchronizing the clocks, the nodes MAY use the Network Time\n       Protocol\
    \ [RFC4330].  Deployments MAY also adopt other approaches\n       suitable for\
    \ that specific deployment.  Alternatively, if there\n       is a mobile node\
    \ generated timestamp that is increasing at every\n       attachment to the access\
    \ link and if that timestamp is available\n       to the mobile access gateway\
    \ (e.g., the Timestamp option in the\n       SEND [RFC3971] messages that the\
    \ mobile node sends), the mobile\n       access gateway can use this timestamp\
    \ or sequence number in the\n       Proxy Binding Update messages and does not\
    \ have to depend on any\n       external clock source.  However, the specific\
    \ details on how this\n       is achieved are outside the scope of this document.\n\
    \   4.  When generating the timestamp value for building the Timestamp\n     \
    \  option, the mobility entities MUST ensure that the generated\n       timestamp\
    \ is the elapsed time past the same reference epoch, as\n       specified in the\
    \ format for the Timestamp option (Section 8.8).\n   5.  If the Timestamp option\
    \ is present in the received Proxy Binding\n       Update message, the local mobility\
    \ anchor MUST ignore the\n       sequence number field in the message.  However,\
    \ it MUST copy the\n       sequence number from the received Proxy Binding Update\
    \ message to\n       the Proxy Binding Acknowledgement message.\n   6.  Upon receipt\
    \ of a Proxy Binding Update message with the Timestamp\n       option, the local\
    \ mobility anchor MUST check the timestamp field\n       for validity.  In order\
    \ for it to be considered valid, the\n       following MUST be true.\n       *\
    \  The timestamp value contained in the Timestamp option MUST be\n          close\
    \ enough (within TimestampValidityWindow amount of time\n          difference)\
    \ to the local mobility anchor's time-of-day clock.\n          However, if the\
    \ flag MobileNodeGeneratedTimestampInUse is set\n          to a value of 1, the\
    \ local mobility anchor MUST ignore this\n          check and perform only the\
    \ following check.\n       *  The timestamp MUST be greater than all previously\
    \ accepted\n          timestamps in the Proxy Binding Update messages sent for\
    \ that\n          mobile node.\n   7.  If the timestamp value in the received\
    \ Proxy Binding Update is\n       valid (validity as specified in the above considerations)\
    \ or if\n       the flag MobileNodeGeneratedTimestampInUse is set to value of\
    \ 1,\n       the local mobility anchor MUST return the same timestamp value in\n\
    \       the Timestamp option included in the Proxy Binding\n       Acknowledgement\
    \ message that it sends to the mobile access\n       gateway.\n   8.  If the timestamp\
    \ value in the received Proxy Binding Update is\n       lower than the previously\
    \ accepted timestamp in the Proxy Binding\n       Update messages sent for that\
    \ mobility binding, the local\n       mobility anchor MUST reject the Proxy Binding\
    \ Update message and\n       send a Proxy Binding Acknowledgement message with\
    \ the Status\n       field set to TIMESTAMP_LOWER_THAN_PREV_ACCEPTED (Timestamp\
    \ lower\n       than previously accepted timestamp).  The message MUST also\n\
    \       include the Timestamp option with the value set to the current\n     \
    \  time of day on the local mobility anchor.\n   9.  If the timestamp value in\
    \ the received Proxy Binding Update is\n       not valid (validity as specified\
    \ in the above considerations),\n       the local mobility anchor MUST reject\
    \ the Proxy Binding Update\n       and send a Proxy Binding Acknowledgement message\
    \ with the Status\n       field set to TIMESTAMP_MISMATCH (Timestamp mismatch).\
    \  The\n       message MUST also include the Timestamp option with the value set\n\
    \       to the current time of day on the local mobility anchor.\n   Using the\
    \ Sequence-Number-Based Approach:\n   1.  If the Timestamp option is not present\
    \ in the received Proxy\n       Binding Update message, the local mobility anchor\
    \ MUST fall back\n       to the Sequence-Number-based scheme.  It MUST process\
    \ the\n       sequence number field as specified in [RFC3775].  Also, it MUST\n\
    \       NOT include the Timestamp option in the Proxy Binding\n       Acknowledgement\
    \ messages that it sends to the mobile access\n       gateway.\n   2.  An implementation\
    \ MUST support the Sequence-Number-based scheme,\n       as specified in [RFC3775].\n\
    \   3.  The Sequence-Number-based approach can be used only when there is\n  \
    \     some mechanism (such as context transfer procedure between mobile\n    \
    \   access gateways) that allows the serving mobile access gateway to\n      \
    \ obtain the last sequence number that was sent in a Proxy Binding\n       Update\
    \ message for updating a given mobile node's binding.\n"
- title: 5.6.  Routing Considerations
  contents:
  - '5.6.  Routing Considerations

    '
- title: 5.6.1.  Bi-Directional Tunnel Management
  contents:
  - "5.6.1.  Bi-Directional Tunnel Management\n   The bi-directional tunnel MUST be\
    \ used for routing the mobile node's\n   data traffic between the mobile access\
    \ gateway and the local mobility\n   anchor.  A tunnel hides the topology and\
    \ enables a mobile node to use\n   address(es) from its home network prefix(es)\
    \ from any access link in\n   that Proxy Mobile IPv6 domain.  A tunnel may be\
    \ created dynamically\n   when needed and removed when not needed.  However, implementations\n\
    \   MAY choose to use static pre-established tunnels instead of\n   dynamically\
    \ creating and tearing them down on a need basis.  The\n   following considerations\
    \ MUST be applied when using dynamically\n   created tunnels.\n   o  A bi-directional\
    \ tunnel MUST be established between the local\n      mobility anchor and the\
    \ mobile access gateway and the local\n      mobility anchor with IPv6-in-IPv6\
    \ encapsulation, as described in\n      [RFC2473].  The tunnel endpoints are the\
    \ Proxy-CoA and LMAA.\n      However, when using IPv4 transport, the endpoints\
    \ of the tunnel\n      are IPv4-LMAA and IPv4-Proxy-CoA with the encapsulation\
    \ mode as\n      specified in [IPV4-PMIP6].\n   o  Implementations MAY use a software\
    \ timer for managing the tunnel\n      lifetime and a counter for keeping a count\
    \ of all the mobile nodes\n      that are sharing the tunnel.  The timer value\
    \ can be set to the\n      accepted binding lifetime and can be updated after\
    \ each periodic\n      re-registration for extending the lifetime.  If the tunnel\
    \ is\n      shared for multiple mobile nodes, the tunnel lifetime must be set\n\
    \      to the highest binding lifetime that is granted to any one of\n      those\
    \ mobile nodes sharing that tunnel.\n   o  The tunnel SHOULD be deleted when either\
    \ the tunnel lifetime\n      expires or when there are no mobile nodes sharing\
    \ the tunnel.\n"
- title: 5.6.2.  Forwarding Considerations
  contents:
  - "5.6.2.  Forwarding Considerations\n   Intercepting Packets Sent to the Mobile\
    \ Node's Home Network:\n   o  When the local mobility anchor is serving a mobile\
    \ node, it MUST\n      be able to receive packets that are sent to the mobile\
    \ node's home\n      network.  In order for it to receive those packets, it MUST\n\
    \      advertise a connected route in to the Routing Infrastructure for\n    \
    \  the mobile node's home network prefix(es) or for an aggregated\n      prefix\
    \ with a larger scope.  This essentially enables IPv6 routers\n      in that network\
    \ to detect the local mobility anchor as the last-\n      hop router for the mobile\
    \ node's home network prefix(es).\n   Forwarding Packets to the Mobile Node:\n\
    \   o  On receiving a packet from a correspondent node with the\n      destination\
    \ address matching a mobile node's home network\n      prefix(es), the local mobility\
    \ anchor MUST forward the packet\n      through the bi-directional tunnel set\
    \ up for that mobile node.\n   o  The format of the tunneled packet is shown below.\
    \  Considerations\n      from [RFC2473] MUST be applied for IPv6 encapsulation.\
    \  However,\n      when using IPv4 transport, the format of the packet is as\n\
    \      described in [IPV4-PMIP6].\n        IPv6 header (src= LMAA, dst= Proxy-CoA\
    \  /* Tunnel Header */\n           IPv6 header (src= CN, dst= MN-HOA )  /* Packet\
    \ Header */\n              Upper layer protocols             /* Packet Content*/\n\
    \                  Figure 10: Tunneled Packet from LMA to MAG\n   o  The format\
    \ of the tunneled packet is shown below, when payload\n      protection using\
    \ IPsec is enabled for the mobile node's data\n      traffic.  However, when using\
    \ IPv4 transport, the format of the\n      packet is as described in [IPV4-PMIP6].\n\
    \        IPv6 header (src= LMAA, dst= Proxy-CoA     /* Tunnel Header */\n    \
    \       ESP Header in tunnel mode               /* ESP Header */\n           \
    \   IPv6 header (src= CN, dst= MN-HoA )  /* Packet Header */\n               \
    \  Upper layer protocols             /* Packet Content*/\n      Figure 11: Tunneled\
    \ Packet from LMA to MAG with Payload Protection\n   Forwarding Packets Sent by\
    \ the Mobile Node:\n   o  All the reverse tunneled packets that the local mobility\
    \ anchor\n      received from the mobile access gateway, after removing the tunnel\n\
    \      header MUST be routed to the destination specified in the inner\n     \
    \ packet header.  These routed packets will have the Source Address\n      field\
    \ set to the mobile node's home address.  Considerations from\n      [RFC2473]\
    \ MUST be applied for IPv6 decapsulation.\n"
- title: 5.6.3.  Explicit Congestion Notification (ECN) Considerations for Proxy
  contents:
  - "5.6.3.  Explicit Congestion Notification (ECN) Considerations for Proxy\n   \
    \     Mobile IPv6 Tunnels\n   This section describes how the ECN information needs\
    \ to be handled by\n   the mobility agents at the tunnel entry and exit points.\
    \  The ECN\n   considerations for IP tunnels are specified in [RFC3168], and the\n\
    \   same considerations apply to Proxy Mobile IPv6 tunnels (using IPv6-\n   in-IPv6\
    \ encapsulation mode).  Specifically, the full-functionality\n   option MUST be\
    \ supported.  The relevant ECN considerations from\n   [RFC3168] are summarized\
    \ here for convenience.\n   Encapsulation Considerations:\n   o  If the Explicit\
    \ Congestion Notification (ECN) field in the inner\n      header is set to ECT(0)\
    \ or ECT(1), where ECT stands for ECN-\n      Capable Transport (ECT), the ECN\
    \ field from the inner header MUST\n      be copied to the outer header.  Additionally,\
    \ when payload\n      protection using IPsec is enabled for the mobile node's\
    \ data\n      traffic, the ECN considerations from [RFC4301] MUST be applied.\n\
    \   Decapsulation Considerations:\n   o  If the Explicit Congestion Notification\
    \ (ECN) field in the inner\n      header is set to ECT(0) or ECT(1), and if the\
    \ ECN field in the\n      outer header is set to Congestion Experienced (CE),\
    \ then the ECN\n      field in the inner header MUST be set to CE.  Otherwise,\
    \ the ECN\n      field in the inner header MUST NOT be modified.  Additionally,\n\
    \      when payload protection using IPsec is enabled for the mobile\n      node's\
    \ data traffic, the ECN considerations from [RFC4301] MUST be\n      applied.\n"
- title: 5.7.  Local Mobility Anchor Address Discovery
  contents:
  - "5.7.  Local Mobility Anchor Address Discovery\n   Dynamic Home Agent Address\
    \ Discovery (DHAAD), as explained in Section\n   10.5 of [RFC3775], allows a mobile\
    \ node to discover all the home\n   agents on its home link by sending an ICMP\
    \ Home Agent Address\n   Discovery Request message to the Mobile IPv6 Home Agent's\
    \ anycast\n   address, derived from its home network prefix.\n   The DHAAD message\
    \ in the current form cannot be used in Proxy Mobile\n   IPv6 for discovering\
    \ the address of the mobile node's local mobility\n   anchor.  In Proxy Mobile\
    \ IPv6, the local mobility anchor will not be\n   able to receive any messages\
    \ sent to the Mobile IPv6 Home Agent's\n   anycast address corresponding to the\
    \ mobile node's home network\n   prefix(es), as the prefix(es) is not hosted on\
    \ any of its interfaces.\n   Further, the mobile access gateway will not predictably\
    \ be able to\n   locate the serving local mobility anchor that has the mobile\
    \ node's\n   binding cache entry.  Hence, this specification does not support\n\
    \   Dynamic Home Agent Address Discovery protocol.\n   In Proxy Mobile IPv6, the\
    \ address of the local mobility anchor\n   configured to serve a mobile node can\
    \ be discovered by the mobility\n   access gateway entity via other means.  The\
    \ LMA to be assigned to a\n   mobile node may be a configured entry in the mobile\
    \ node's policy\n   profile, or it may be obtained through mechanisms outside\
    \ the scope\n   of this document.\n"
- title: 5.8.  Mobile Prefix Discovery Considerations
  contents:
  - "5.8.  Mobile Prefix Discovery Considerations\n   This specification does not\
    \ support mobile prefix discovery.  The\n   mobile prefix discovery mechanism\
    \ as specified in [RFC3775] is not\n   applicable to Proxy Mobile IPv6.\n"
- title: 5.9.  Route Optimization Considerations
  contents:
  - "5.9.  Route Optimization Considerations\n   The Route Optimization in Mobile\
    \ IPv6, as defined in [RFC3775],\n   enables a mobile node to communicate with\
    \ a correspondent node\n   directly using its care-of address and further the\
    \ Return Routability\n   procedure enables the correspondent node to have reasonable\
    \ trust\n   that the mobile node is reachable at both its home address and\n \
    \  care-of address.\n   This specification does not support the Route Optimization\
    \ specified\n   in Mobile IPv6 [RFC3775].  However, this specification does support\n\
    \   another form of route optimization, as specified in Section 6.10.3.\n"
- title: 6.  Mobile Access Gateway Operation
  contents:
  - "6.  Mobile Access Gateway Operation\n   The Proxy Mobile IPv6 protocol described\
    \ in this document introduces\n   a new functional entity, the mobile access gateway\
    \ (MAG).  The mobile\n   access gateway is the entity that is responsible for\
    \ detecting the\n   mobile node's movements to and from the access link and sending\
    \ the\n   Proxy Binding Update messages to the local mobility anchor.  In\n  \
    \ essence, the mobile access gateway performs mobility management on\n   behalf\
    \ of a mobile node.\n   The mobile access gateway is a function that typically\
    \ runs on an\n   access router.  However, implementations MAY choose to split\
    \ this\n   function and run it across multiple systems.  The specifics on how\n\
    \   that is achieved or the signaling interactions between those\n   functional\
    \ entities are beyond the scope of this document.\n   The mobile access gateway\
    \ has the following key functional roles:\n   o  It is responsible for detecting\
    \ the mobile node's movements on the\n      access link and for initiating the\
    \ mobility signaling with the\n      mobile node's local mobility anchor.\n  \
    \ o  Emulation of the mobile node's home link on the access link by\n      sending\
    \ Router Advertisement messages containing the mobile node's\n      home network\
    \ prefix(es), each prefix carried using the Prefix\n      Information option [RFC4861].\n\
    \   o  Responsible for setting up the forwarding for enabling the mobile\n   \
    \   node to configure one or more addresses from its home network\n      prefix(es)\
    \ and use it from the attached access link.\n"
- title: 6.1.  Extensions to Binding Update List Entry Data Structure
  contents:
  - "6.1.  Extensions to Binding Update List Entry Data Structure\n   Every mobile\
    \ access gateway MUST maintain a Binding Update List.\n   Each entry in the Binding\
    \ Update List represents a mobile node's\n   mobility binding with its local mobility\
    \ anchor.  The Binding Update\n   List is a conceptual data structure, described\
    \ in Section 11.1 of\n   [RFC3775].\n   For supporting this specification, the\
    \ conceptual Binding Update List\n   entry data structure needs be extended with\
    \ the following additional\n   fields.\n   o  The identifier of the attached mobile\
    \ node, MN-Identifier.  This\n      identifier is acquired during the mobile node's\
    \ attachment to the\n      access link through mechanisms outside the scope of\
    \ this document.\n   o  The link-layer identifier of the mobile node's connected\n\
    \      interface.  This can be acquired from the received Router\n      Solicitation\
    \ messages from the mobile node or during the mobile\n      node's attachment\
    \ to the access network.  This is typically a\n      link-layer identifier conveyed\
    \ by the mobile node; however, the\n      specific details on how that is conveyed\
    \ is out of scope for this\n      specification.  If this identifier is not available,\
    \ this variable\n      length field MUST be set to two (octets) and MUST be initialized\n\
    \      to a value of ALL_ZERO.\n   o  A list of IPv6 home network prefixes assigned\
    \ to the mobile node's\n      connected interface.  The home network prefix(es)\
    \ may have been\n      statically configured in the mobile node's policy profile,\
    \ or, may\n      have been dynamically allocated by the local mobility anchor.\n\
    \      Each of these prefix entries will also include the corresponding\n    \
    \  prefix length.\n   o  The Link-local address of the mobile access gateway on\
    \ the access\n      link shared with the mobile node.\n   o  The IPv6 address\
    \ of the local mobility anchor serving the attached\n      mobile node.  This\
    \ address is acquired from the mobile node's\n      policy profile or from other\
    \ means.\n   o  The interface identifier (if-id) of the point-to-point link\n\
    \      between the mobile node and the mobile access gateway.  This is\n     \
    \ internal to the mobile access gateway and is used to associate the\n      Proxy\
    \ Mobile IPv6 tunnel to the access link where the mobile node\n      is attached.\n\
    \   o  The tunnel interface identifier (tunnel-if-id) of the bi-\n      directional\
    \ tunnel between the mobile node's local mobility anchor\n      and the mobile\
    \ access gateway.  This is internal to the mobile\n      access gateway.  The\
    \ tunnel interface identifier is acquired\n      during the tunnel creation.\n"
- title: 6.2.  Mobile Node's Policy Profile
  contents:
  - "6.2.  Mobile Node's Policy Profile\n   A mobile node's policy profile contains\
    \ the essential operational\n   parameters that are required by the network entities\
    \ for managing the\n   mobile node's mobility service.  These policy profiles\
    \ are stored in\n   a local or a remote policy store.  The mobile access gateway\
    \ and the\n   local mobility anchor MUST be able to obtain a mobile node's policy\n\
    \   profile.  The policy profile MAY also be handed over to a serving\n   mobile\
    \ access gateway as part of a context transfer procedure during\n   a handoff\
    \ or the serving mobile access gateway MAY be able to\n   dynamically generate\
    \ this profile.  The exact details on how this\n   achieved is outside the scope\
    \ of this document.  However, this\n   specification requires that a mobile access\
    \ gateway serving a mobile\n   node MUST have access to its policy profile.\n\
    \   The following are the mandatory fields of the policy profile:\n   o  The mobile\
    \ node's identifier (MN-Identifier)\n   o  The IPv6 address of the local mobility\
    \ anchor (LMAA)\n   The following are the optional fields of the policy profile:\n\
    \   o  The mobile node's IPv6 home network prefix(es) assigned to the\n      mobile\
    \ node's connected interface.  These prefixes have to be\n      maintained on\
    \ a per-interface basis.  There can be multiple unique\n      entries for each\
    \ interface of the mobile node.  The specific\n      details on how the network\
    \ maintains this association between the\n      prefix set and the interfaces,\
    \ specially during the mobility\n      session handoff between interfaces, is\
    \ outside the scope of this\n      document.\n   o  The mobile node's IPv6 home\
    \ network Prefix lifetime.  This\n      lifetime will be the same for all the\
    \ hosted prefixes on the link,\n      as they all are part of one mobility session.\
    \  This value can also\n      be the same for all the mobile node's mobility sessions.\n\
    \   o  Supported address configuration procedures (Stateful, Stateless,\n    \
    \  or both) for the mobile node in the Proxy Mobile IPv6 domain\n"
- title: 6.3.  Supported Access Link Types
  contents:
  - "6.3.  Supported Access Link Types\n   This specification supports only point-to-point\
    \ access link types,\n   and thus, it assumes that the mobile node and the mobile\
    \ access\n   gateway are the only two nodes on the access link.  The link is\n\
    \   assumed to have multicast capability.\n   This protocol may also be used on\
    \ other link types, as long as the\n   link is configured in such a way that it\
    \ emulates point-to-point\n   delivery between the mobile node and the mobile\
    \ access gateway for\n   all the protocol traffic.\n   It is also necessary to\
    \ be able to identify mobile nodes attaching to\n   the link.  Requirements relating\
    \ to this are covered in Section 6.6.\n   Finally, while this specification can\
    \ operate without link-layer\n   indications of node attachment and detachment\
    \ to the link, the\n   existence of such indications either on the network or\
    \ mobile node\n   side improves the resulting performance.\n"
- title: 6.4.  Supported Address Configuration Modes
  contents:
  - "6.4.  Supported Address Configuration Modes\n   A mobile node in the Proxy Mobile\
    \ IPv6 domain can configure one or\n   more global IPv6 addresses on its interface\
    \ (using Stateless,\n   Stateful address autoconfiguration procedures or manual\
    \ address\n   configuration) from the hosted prefix(es) on that link.  The Router\n\
    \   Advertisement messages sent on the access link specify the address\n   configuration\
    \ methods permitted on that access link for that mobile\n   node.  However, the\
    \ advertised flags, with respect to the address\n   configuration, will be consistent\
    \ for a mobile node, on any of the\n   access links in that Proxy Mobile IPv6\
    \ domain.  Typically, these\n   configuration settings will be based on the domain-wide\
    \ policy or\n   based on a policy specific to each mobile node.\n   When stateless\
    \ address autoconfiguration is supported on the access\n   link, the mobile node\
    \ can generate one or more IPv6 addresses from\n   the hosted prefix(es) by standard\
    \ IPv6 mechanisms such as Stateless\n   Autoconfiguration [RFC4862] or Privacy\
    \ extensions [RFC4941].\n   When stateful address autoconfiguration is supported\
    \ on the link, the\n   mobile node can obtain the address configuration from the\
    \ DHCP server\n   located in the Proxy Mobile IPv6 domain, by standard DHCP mechanisms,\n\
    \   as specified in [RFC3315].  The obtained address(es) will be from its\n  \
    \ home network prefix(es).  Section 6.11 specifies the details on how\n   this\
    \ configuration can be achieved.\n   Additionally, other address configuration\
    \ mechanisms specific to the\n   access link between the mobile node and the mobile\
    \ access gateway may\n   also be used for delivering the address configuration\
    \ to the mobile\n   node.  This specification does not modify the behavior of\
    \ any of the\n   standard IPv6 address configuration mechanisms.\n"
- title: 6.5.  Access Authentication and Mobile Node Identification
  contents:
  - "6.5.  Access Authentication and Mobile Node Identification\n   When a mobile\
    \ node attaches to an access link connected to the mobile\n   access gateway,\
    \ the deployed access security protocols on that link\n   SHOULD ensure that the\
    \ network-based mobility management service is\n   offered only after authenticating\
    \ and authorizing the mobile node for\n   that service.  The exact specifics on\
    \ how this is achieved or the\n   interactions between the mobile access gateway\
    \ and the access\n   security service are outside the scope of this document.\
    \  This\n   specification goes with the stated assumption of having an\n   established\
    \ trust between the mobile node and the mobile access\n   gateway before the protocol\
    \ operation begins.\n"
- title: 6.6.  Acquiring Mobile Node's Identifier
  contents:
  - "6.6.  Acquiring Mobile Node's Identifier\n   All the network entities in a Proxy\
    \ Mobile IPv6 domain MUST be able\n   to identify a mobile node, using its MN-Identifier.\
    \  This identifier\n   MUST be stable and unique across the Proxy Mobile IPv6\
    \ domain.  The\n   mobility entities in the Proxy Mobile IPv6 domain MUST be able\
    \ to use\n   this identifier in the signaling messages and unambiguously identify\n\
    \   a given mobile node.  The following are some of the considerations\n   related\
    \ to this MN-Identifier.\n   o  The MN-Identifier is typically obtained as part\
    \ of the access\n      authentication or from a notified network attachment event.\
    \  In\n      cases where the user identifier authenticated during access\n   \
    \   authentication uniquely identifies a mobile node, the MN-\n      Identifier\
    \ MAY be the same as the user identifier.  However, the\n      user identifier\
    \ MUST NOT be used if it identifies a user account\n      that can be used from\
    \ more than one mobile node operating in the\n      same Proxy Mobile IPv6 domain.\n\
    \   o  In some cases, the obtained identifier, as part of the access\n      authentication,\
    \ can be a temporary identifier and further that\n      temporary identifier may\
    \ be different at each re-authentication.\n      However, the mobile access gateway\
    \ MUST be able to use this\n      temporary identifier and obtain the mobile node's\
    \ stable\n      identifier from the policy store.  For instance, in AAA-based\n\
    \      systems, the Remote Authentication Dial-In User Service (RADIUS)\n    \
    \  attribute, Chargeable-User-Identifier [RFC4372] may be used, as\n      long\
    \ as it uniquely identifies a mobile node, and not a user\n      account that\
    \ can be used with multiple mobile nodes.\n   o  In some cases and for privacy\
    \ reasons, the MN-Identifier that the\n      policy store delivers to the mobile\
    \ access gateway may not be the\n      true identifier of the mobile node.  However,\
    \ the mobility access\n      gateway MUST be able to use this identifier in the\
    \ signaling\n      messages exchanged with the local mobility anchor.\n   o  The\
    \ mobile access gateway MUST be able to identify the mobile node\n      by its\
    \ MN-Identifier, and it MUST be able to associate this\n      identity to the\
    \ point-to-point link shared with the mobile node.\n"
- title: 6.7.  Home Network Emulation
  contents:
  - "6.7.  Home Network Emulation\n   One of the key functions of a mobile access\
    \ gateway is to emulate the\n   mobile node's home network on the access link.\
    \  It must ensure the\n   mobile node does not detect any change with respect\
    \ to its layer-3\n   attachment even after it changes its point of attachment\
    \ in that\n   Proxy Mobile IPv6 domain.\n   For emulating the mobile node's home\
    \ link on the access link, the\n   mobile access gateway must be able to send\
    \ Router Advertisement\n   messages advertising the mobile node's home network\
    \ prefix(es)\n   carried using the Prefix Information option(s) [RFC4861] and\
    \ with\n   other address configuration parameters consistent with its home link\n\
    \   properties.  Typically, these configuration settings will be based on\n  \
    \ the domain-wide policy or based on a policy specific to each mobile\n   node.\n\
    \   Typically, the mobile access gateway learns the mobile node's home\n   network\
    \ prefix(es) details from the received Proxy Binding\n   Acknowledgement message,\
    \ or it may obtain them from the mobile node's\n   policy profile.  However, the\
    \ mobile access gateway SHOULD send the\n   Router Advertisements advertising\
    \ the mobile node's home network\n   prefix(es) only after successfully completing\
    \ the binding\n   registration with the mobile node's local mobility anchor.\n\
    \   When advertising the home network prefix(es) in the Router\n   Advertisement\
    \ messages, the mobile access gateway MAY set the prefix\n   lifetime value for\
    \ the advertised prefix(es) to any chosen value at\n   its own discretion.  An\
    \ implementation MAY choose to tie the prefix\n   lifetime to the mobile node's\
    \ binding lifetime.  The prefix lifetime\n   can also be an optional configuration\
    \ parameter in the mobile node's\n   policy profile.\n"
- title: 6.8.  Link-local and Global Address Uniqueness
  contents:
  - "6.8.  Link-local and Global Address Uniqueness\n   A mobile node in the Proxy\
    \ Mobile IPv6 domain, as it moves from one\n   mobile access gateway to the other,\
    \ will continue to detect its home\n   network and does not detect a change of\
    \ layer-3 attachment.  Every\n   time the mobile node attaches to a new link,\
    \ the event related to the\n   interface state change will trigger the mobile\
    \ node to perform\n   Duplicate Address Detection (DAD) operation on the link-local\
    \ and\n   global address(es).  However, if the mobile node is Detecting Network\n\
    \   Attachment in IPv6 (DNAv6) enabled, as specified in [DNAV6], it may\n   not\
    \ detect the link change due to DNAv6 optimizations and may not\n   trigger the\
    \ duplicate address detection (DAD) procedure for its\n   existing addresses,\
    \ which may potentially lead to address collisions\n   after the mobile node's\
    \ handoff to a new link.\n   The issue of address collision is not relevant to\
    \ the mobile node's\n   global address(es).  Since the assigned home network prefix(es)\
    \ are\n   for the mobile node's exclusive usage, no other node shares an\n   address\
    \ (other than Subnet-Router anycast address that is configured\n   by the mobile\
    \ access gateway) from the prefix(es), and so the\n   uniqueness for the mobile\
    \ node's global address is assured on the\n   access link.\n   The issue of address\
    \ collision is however relevant to the mobile\n   node's link-local addresses\
    \ since the mobile access gateway and the\n   mobile node will have link-local\
    \ addresses configured from the same\n   link-local prefix (FE80::/64).  This\
    \ leaves a room for link-local\n   address collision between the two neighbors\
    \ (i.e., the mobile node\n   and the mobile access gateway) on that access link.\
    \  For solving this\n   problem, this specification requires that the link-local\
    \ address that\n   the mobile access gateway configures on the point-to-point\
    \ link\n   shared with a given mobile node be generated by the local mobility\n\
    \   anchor and be stored in the mobile node's Binding Cache entry.  This\n   address\
    \ will not change for the duration of that mobile node's\n   mobility session\
    \ and can be provided to the serving mobile access\n   gateway at every mobile\
    \ node's handoff, as part of the Proxy Mobile\n   IPv6 signaling messages.  The\
    \ specific method by which the local\n   mobility anchor generates the link-local\
    \ address is out of scope for\n   this specification.\n   It is highly desirable\
    \ that the access link on the mobile access\n   gateway shared with the mobile\
    \ node be provisioned in such a way that\n   before the mobile node completes\
    \ the DAD operation [RFC4862] on its\n   link-local address, the mobile access\
    \ gateway on that link is aware\n   of its own link-local address provided by\
    \ the local mobility anchor\n   that it needs to use on that access link.  This\
    \ essentially requires\n   a successful completion of the Proxy Mobile IPv6 signaling\
    \ by the\n   mobile access gateway before the mobile node completes the DAD\n\
    \   operation.  This can be achieved by ensuring that link-layer\n   attachment\
    \ does not complete until the Proxy Mobile IPv6 signaling is\n   completed.  Alternatively,\
    \ network and local mobility anchor capacity\n   and signaling retransmission\
    \ timers can be provisioned in such a way\n   that signaling is likely to complete\
    \ during the default waiting\n   period associated with the DAD process.\n   Optionally,\
    \ implementations MAY choose to configure a fixed link-\n   local address across\
    \ all the access links in a Proxy Mobile IPv6\n   domain and without a need for\
    \ carrying this address from the local\n   mobility anchor to the mobile access\
    \ gateway in the Proxy Mobile IPv6\n   signaling messages.  The configuration\
    \ variable\n   FixedMAGLinkLocalAddressOnAllAccessLinks determines the enabled\
    \ mode\n   in that Proxy Mobile IPv6 domain.\n"
- title: 6.9.  Signaling Considerations
  contents:
  - '6.9.  Signaling Considerations

    '
- title: 6.9.1.  Binding Registrations
  contents:
  - '6.9.1.  Binding Registrations

    '
- title: 6.9.1.1.  Mobile Node Attachment and Initial Binding Registration
  contents:
  - "6.9.1.1.  Mobile Node Attachment and Initial Binding Registration\n   1.   After\
    \ detecting a new mobile node on its access link, the mobile\n        access gateway\
    \ MUST identify the mobile node and acquire its MN-\n        Identifier.  If it\
    \ determines that the network-based mobility\n        management service needs\
    \ to be offered to the mobile node, it\n        MUST send a Proxy Binding Update\
    \ message to the local mobility\n        anchor.\n   2.   The Proxy Binding Update\
    \ message MUST include the Mobile Node\n        Identifier option [RFC4283], carrying\
    \ the MN-Identifier for\n        identifying the mobile node.\n   3.   The Home\
    \ Network Prefix option(s) MUST be present in the Proxy\n        Binding Update\
    \ message.  If the mobile access gateway learns the\n        mobile node's home\
    \ network prefix(es) either from its policy\n        store or from other means,\
    \ the mobile access gateway MAY choose\n        to request the local mobility\
    \ anchor to allocate the specific\n        prefix(es) by including a Home Network\
    \ Prefix option for each of\n        those requested prefixes.  The mobile access\
    \ gateway MAY also\n        choose to include just one Home Network Prefix option\
    \ with the\n        prefix value of ALL_ZERO, for requesting the local mobility\n\
    \        anchor to do the prefix assignment.  However, when including a\n    \
    \    Home Network Prefix option with the prefix value of ALL_ZERO,\n        there\
    \ MUST be only one instance of the Home Network prefix\n        option in the\
    \ request.\n   4.   The Handoff Indicator option MUST be present in the Proxy\n\
    \        Binding Update message.  The Handoff Indicator field in the\n       \
    \ Handoff Indicator option MUST be set to a value indicating the\n        handoff\
    \ hint.\n        *  The Handoff Indicator field MUST be set to a value of 1\n\
    \           (Attachment over a new interface) if the mobile access\n         \
    \  gateway determines (under the Handoff Indicator\n           considerations\
    \ specified in this section) that the mobile\n           node's current attachment\
    \ to the network over this interface\n           is not as a result of a handoff\
    \ of an existing mobility\n           session (over the same interface or through\
    \ a different\n           interface), but as a result of an attachment over a\
    \ new\n           interface.  This essentially serves as a request to the local\n\
    \           mobility anchor to create a new mobility session and not\n       \
    \    update any existing Binding Cache entry created for the same\n          \
    \ mobile node connected to the Proxy Mobile IPv6 domain through\n           a\
    \ different interface.\n        *  The Handoff Indicator field MUST be set to\
    \ a value of 2\n           (Handoff between two different interfaces of the mobile\
    \ node)\n           if the mobile access gateway definitively knows the mobile\n\
    \           node's current attachment is due to a handoff of an existing\n   \
    \        mobility session between two different interfaces of the\n          \
    \ mobile node.\n        *  The Handoff Indicator field MUST be set to a value\
    \ of 3\n           (Handoff between mobile access gateways for the same\n    \
    \       interface) if the mobile access gateway definitively knows\n         \
    \  the mobile node's current attachment is due to a handoff of\n           an\
    \ existing mobility session between two mobile access\n           gateways and\
    \ for the same interface of the mobile node.\n        *  The Handoff Indicator\
    \ field MUST be set to a value of 4\n           (Handoff state unknown) if the\
    \ mobile access gateway cannot\n           determine if the mobile node's current\
    \ attachment is due to a\n           handoff of an existing mobility session.\n\
    \   5.   The mobile access gateway MUST apply the below considerations\n     \
    \   when choosing the value for the Handoff Indicator field.\n        *  The mobile\
    \ access gateway can choose to use the value 2\n           (Handoff between two\
    \ different interfaces of the mobile\n           node), only when it knows that\
    \ the mobile node has, on\n           purpose, switched from one interface to\
    \ another, and the\n           previous interface is going to be disabled.  It\
    \ may know this\n           due to a number of factors.  For instance, most cellular\n\
    \           networks have controlled handovers where the network knows\n     \
    \      that the host is moving from one attachment to another.  In\n         \
    \  this situation, the link-layer mechanism can inform the\n           mobility\
    \ functions that this is indeed a movement, not a new\n           attachment.\n\
    \        *  Some link layers have link-layer identifiers that can be used\n  \
    \         to distinguish (a) the movement of a particular interface to\n     \
    \      a new attachment from (b) the attachment of a new interface\n         \
    \  from the same host.  Option value 3 (Handoff between mobile\n           access\
    \ gateways for the same interface) is appropriate in\n           case (a) and\
    \ a value of 1 (Attachment over a new interface)\n           in case (b).\n  \
    \      *  The mobile access gateway MUST NOT set the option value to 2\n     \
    \      (Handoff between two different interfaces of the mobile node)\n       \
    \    or 3 (Handoff between mobile access gateways for the same\n           interface)\
    \ if it cannot be determined that the mobile node\n           can move the address\
    \ between the interfaces involved in the\n           handover or that it is the\
    \ same interface that has moved.\n           Otherwise, Proxy Mobile IPv6-unaware\
    \ hosts that have multiple\n           physical interfaces to the same domain\
    \ may suffer unexpected\n           failures.\n        *  Where no support from\
    \ the link layer exists, the host and the\n           network would need to inform\
    \ each other about the intended\n           movement.  The Proxy Mobile IPv6 protocol\
    \ does not specify\n           this and simply requires that knowledge about movements\
    \ can\n           be derived either from the link-layer or from somewhere else.\n\
    \           The method by which this is accomplished is outside the scope\n  \
    \         of this specification.\n   6.   Either the Timestamp option or a valid\
    \ sequence number\n        maintained on a per mobile node's mobility session\
    \ basis as\n        specified in [RFC3775] (if the Sequence-Number-based scheme\
    \ is\n        in use) MUST be present.  This can be determined based on the\n\
    \        value of the configuration flag TimestampBasedApproachInUse.\n      \
    \  When Timestamp option is added to the message, the mobile access\n        gateway\
    \ SHOULD also set the Sequence Number field to a value of\n        a monotonically\
    \ increasing counter (maintained at each mobile\n        access gateway and not\
    \ to be confused with the per mobile node\n        sequence number specified in\
    \ [RFC3775]).  The local mobility\n        anchor will ignore this field when\
    \ there is a Timestamp option\n        present in the request, but will return\
    \ the same value in the\n        Proxy Binding Acknowledgement message.  This\
    \ will be useful for\n        matching the reply to the request message.\n   7.\
    \   The Mobile Node Link-layer Identifier option carrying the link-\n        layer\
    \ identifier of the currently attached interface MUST be\n        present in the\
    \ Proxy Binding Update message, if the mobile\n        access gateway is aware\
    \ of the same.  If the link-layer\n        identifier of the currently attached\
    \ interface is not known or\n        if the identifier value is ALL_ZERO, this\
    \ option MUST NOT be\n        present.\n   8.   The Access Technology Type option\
    \ MUST be present in the Proxy\n        Binding Update message.  The access technology\
    \ type field in the\n        option SHOULD be set to the type of access technology\
    \ by which\n        the mobile node is currently attached to the mobile access\n\
    \        gateway.\n   9.   The Link-local Address option MUST be present in the\
    \ Proxy\n        Binding Update message only if the value of the configuration\n\
    \        variable FixedMAGLinkLocalAddressOnAllAccessLinks is set to a\n     \
    \   value of ALL_ZERO; otherwise, the Link-local Address option MUST\n       \
    \ NOT be present in the request.  Considerations from Section 6.8\n        MUST\
    \ be applied when using the Link-local Address option.\n        *  For querying\
    \ the local mobility anchor to provide the link-\n           local address that\
    \ it should use on the point-to-point link\n           shared with the mobile\
    \ node, this option MUST be set to\n           ALL_ZERO value.  This essentially\
    \ serves as a request to the\n           local mobility anchor to provide the\
    \ link-local address that\n           it can use on the access link shared with\
    \ the mobile node.\n   10.  The Proxy Binding Update message MUST be constructed\
    \ as\n        specified in Section 6.9.1.5.\n   11.  If there is no existing Binding\
    \ Update List entry for that\n        mobile node, the mobile access gateway MUST\
    \ create a Binding\n        Update List entry for the mobile node upon sending\
    \ the Proxy\n        Binding Update message.\n"
- title: 6.9.1.2.  Receiving Proxy Binding Acknowledgement
  contents:
  - "6.9.1.2.  Receiving Proxy Binding Acknowledgement\n   On receiving a Proxy Binding\
    \ Acknowledgement message (format\n   specified in Section 8.2) from the local\
    \ mobility anchor, the mobile\n   access gateway MUST process the message as specified\
    \ below.\n   1.   The received Proxy Binding Acknowledgement message (a Binding\n\
    \        Acknowledgement message with the (P) flag set to value of 1)\n      \
    \  MUST be authenticated as described in Section 4.  When IPsec is\n        used\
    \ for message authentication, the SPI in the IPsec header\n        [RFC4306] of\
    \ the received packet is needed for locating the\n        security association,\
    \ for authenticating the Proxy Binding\n        Acknowledgement message.\n   2.\
    \   The mobile access gateway MUST observe the rules described in\n        Section\
    \ 9.2 of [RFC3775] when processing Mobility Headers in the\n        received Proxy\
    \ Binding Acknowledgement message.\n   3.   The mobile access gateway MUST apply\
    \ the considerations\n        specified in Section 5.5 for processing the Sequence\
    \ Number\n        field and the Timestamp option (if present) in the message.\n\
    \   4.   The mobile access gateway MUST ignore any checks, specified in\n    \
    \    [RFC3775], related to the presence of a Type 2 Routing header in\n      \
    \  the Proxy Binding Acknowledgement message.\n   5.   The mobile access gateway\
    \ MAY use the mobile node identifier\n        present in the Mobile Node Identifier\
    \ option for matching the\n        response to the request messages that it sent\
    \ recently.\n        However, if there is more than one request message in its\n\
    \        request queue for the same mobile node, the sequence number\n       \
    \ field can be used for identifying the exact message from those\n        messages.\
    \  There are other ways to achieve this and\n        implementations are free\
    \ to adopt the best approach that suits\n        their implementation.  Additionally,\
    \ if the received Proxy\n        Binding Acknowledgement message does not match\
    \ any of the Proxy\n        Binding Update messages that it sent recently, the\
    \ message MUST\n        be ignored.\n   6.   If the received Proxy Binding Acknowledgement\
    \ message has any\n        one or more of the following options, Handoff Indicator\
    \ option,\n        Access Technology Type option, Mobile Node Link-layer Identifier\n\
    \        option, Mobile Node Identifier option, carrying option values\n     \
    \   that are different from the option values present in the\n        corresponding\
    \ request (Proxy Binding Update) message, the\n        message MUST be ignored\
    \ as the local mobility anchor is expected\n        to echo back all these listed\
    \ options and with the same option\n        values in the reply message.  In this\
    \ case, the mobile access\n        gateway MUST NOT retransmit the Proxy Binding\
    \ Update message\n        until an administrative action is taken.\n   7.   If\
    \ the received Proxy Binding Acknowledgement message has the\n        Status field\
    \ value set to PROXY_REG_NOT_ENABLED (Proxy\n        registration not enabled\
    \ for the mobile node), the mobile access\n        gateway SHOULD NOT send a Proxy\
    \ Binding Update message again for\n        that mobile node until an administrative\
    \ action is taken.  It\n        MUST deny the mobility service to that mobile\
    \ node.\n   8.   If the received Proxy Binding Acknowledgement message has the\n\
    \        Status field value set to TIMESTAMP_LOWER_THAN_PREV_ACCEPTED\n      \
    \  (Timestamp value lower than previously accepted value), the\n        mobile\
    \ access gateway SHOULD try to register again to reassert\n        the mobile\
    \ node's presence on its access link.  The mobile\n        access gateway is not\
    \ specifically required to synchronize its\n        clock upon receiving this\
    \ error code.\n   9.   If the received Proxy Binding Acknowledgement message has\
    \ the\n        Status field value set to TIMESTAMP_MISMATCH (Invalid timestamp\n\
    \        value), the mobile access gateway SHOULD try to register again\n    \
    \    only after it has synchronized its clock to a common time source\n      \
    \  that is used by all the mobility entities in that domain for\n        their\
    \ clock synchronization.  The mobile access gateway SHOULD\n        NOT synchronize\
    \ its clock to the local mobility anchor's system\n        clock, based on the\
    \ timestamp present in the received message.\n   10.  If the received Proxy Binding\
    \ Acknowledgement message has the\n        Status field value set to NOT_AUTHORIZED_FOR_HOME_NETWORK_PREFIX\n\
    \        (The mobile node is not authorized for one or more of the\n        requesting\
    \ home network prefixes), the mobile access gateway\n        SHOULD NOT request\
    \ the same prefix(es) again, but MAY request\n        the local mobility anchor\
    \ to do the assignment of prefix(es) by\n        including only one Home Network\
    \ Prefix option with the prefix\n        value set to ALL_ZERO.\n   11.  If the\
    \ received Proxy Binding Acknowledgement message has the\n        Status field\
    \ value set to any value greater than or equal to 128\n        (i.e., if the binding\
    \ is rejected), the mobile access gateway\n        MUST NOT advertise the mobile\
    \ node's home network prefix(es) in\n        the Router Advertisement messages\
    \ sent on that access link and\n        MUST deny the mobility service to the\
    \ mobile node by not\n        forwarding any packets received from the mobile\
    \ node using an\n        address from the home network prefix(es).  It MAY also\
    \ tear down\n        the point-to-point link shared with the mobile node.\n  \
    \ 12.  If the received Proxy Binding Acknowledgement message has the\n       \
    \ Status field value set to 0 (Proxy Binding Update accepted), the\n        mobile\
    \ access gateway MUST establish a bi-directional tunnel to\n        the local\
    \ mobility anchor (if there is no existing bi-\n        directional tunnel to\
    \ that local mobility anchor).\n        Considerations from Section 5.6.1 MUST\
    \ be applied for managing\n        the dynamically created bi-directional tunnel.\n\
    \   13.  The mobile access gateway MUST set up the route for forwarding\n    \
    \    the packets received from the mobile node using address(es) from\n      \
    \  its home network prefix(es) through the bi-directional setup for\n        that\
    \ mobile node.  The created tunnel and the routing state MUST\n        result\
    \ in the forwarding behavior on the mobile access gateway\n        as specified\
    \ in Section 6.10.5.\n   14.  The mobile access gateway MUST also update the Binding\
    \ Update\n        List entry to reflect the accepted binding registration values.\n\
    \        It MUST also advertise the mobile node's home network prefix(es)\n  \
    \      as the hosted on-link prefixes, by including them in the Router\n     \
    \   Advertisement messages that it sends on that access link.\n   15.  If the\
    \ received Proxy Binding Acknowledgement message has the\n        address in the\
    \ Link-local Address option set to a NON_ZERO\n        value, the mobile access\
    \ gateway SHOULD configure that link-\n        local address on that point-to-point\
    \ link and SHOULD NOT\n        configure any other link-local address without\
    \ performing a DAD\n        operation [RFC4862].  This will avoid any potential\
    \ link-local\n        address collisions on that access link.  However, if the\
    \ link-\n        local address generated by the local mobility anchor happens\
    \ to\n        be already in use by the mobile node on that link, the mobile\n\
    \        access gateway MUST NOT use that address, but SHOULD configure a\n  \
    \      different link-local address.  It SHOULD also upload this link-\n     \
    \   local address to the local mobility anchor by immediately\n        sending\
    \ a Proxy Binding Update message and by including this\n        address in the\
    \ Link-local Address option.\n"
- title: 6.9.1.3.  Extending Binding Lifetime
  contents:
  - "6.9.1.3.  Extending Binding Lifetime\n   1.  For extending the lifetime of a\
    \ currently registered mobile node\n       (i.e., after a successful initial binding\
    \ registration from the\n       same mobile access gateway), the mobile access\
    \ gateway can send a\n       Proxy Binding Update message to the local mobility\
    \ anchor with a\n       new lifetime value.  This re-registration message MUST\
    \ be\n       constructed with the same set of options as the initial Proxy\n \
    \      Binding Update message, under the considerations specified in\n       Section\
    \ 6.9.1.1.  However, the following exceptions apply.\n   2.  There MUST be a Home\
    \ Network Prefix option for each of the\n       assigned home network prefixes\
    \ assigned for that mobility session\n       and with the prefix value in the\
    \ option set to that respective\n       prefix value.\n   3.  The Handoff Indicator\
    \ field in the Handoff Indicator option MUST\n       be set to a value of 5 (Handoff\
    \ state not changed - Re-\n       Registration).\n"
- title: 6.9.1.4.  Mobile Node Detachment and Binding De-Registration
  contents:
  - "6.9.1.4.  Mobile Node Detachment and Binding De-Registration\n   1.  If at any\
    \ point the mobile access gateway detects that the mobile\n       node has moved\
    \ away from its access link, or if it decides to\n       terminate the mobile\
    \ node's mobility session, it SHOULD send a\n       Proxy Binding Update message\
    \ to the local mobility anchor with\n       the lifetime value set to zero.  This\
    \ de-registration message\n       MUST be constructed with the same set of options\
    \ as the initial\n       Proxy Binding Update message, under the considerations\
    \ specified\n       in Section 6.9.1.1.  However, the following exceptions apply.\n\
    \   2.  There MUST be a Home Network Prefix option for each of the\n       assigned\
    \ home network prefixes assigned for that mobility session\n       and with the\
    \ prefix value in the option set to the respective\n       prefix value.\n   3.\
    \  The Handoff Indicator field in the Handoff Indicator option MUST\n       be\
    \ set to a value of 4 (Handoff state unknown).\n   Either upon receipt of a Proxy\
    \ Binding Acknowledgement message from\n   the local mobility anchor with the\
    \ Status field set to 0 (Proxy\n   Binding Update Accepted), or after INITIAL_BINDACK_TIMEOUT\
    \ [RFC3775]\n   timeout waiting for the reply, the mobile access gateway MUST\
    \ do the\n   following:\n   1.  It MUST remove the Binding Update List entry for\
    \ the mobile node\n       from its Binding Update List.\n   2.  It MUST remove\
    \ the created routing state for tunneling the mobile\n       node's traffic.\n\
    \   3.  If there is a dynamically created tunnel to the mobile node's\n      \
    \ local mobility anchor and if there are not other mobile nodes for\n       which\
    \ the tunnel is being used, then the tunnel MUST be deleted.\n   4.  It MUST tear\
    \ down the point-to-point link shared with the mobile\n       node.  This action\
    \ will force the mobile node to remove any IPv6\n       address configuration\
    \ on the interface connected to this point-\n       to-point link.\n"
- title: 6.9.1.5.  Constructing the Proxy Binding Update Message
  contents:
  - "6.9.1.5.  Constructing the Proxy Binding Update Message\n   o  The mobile access\
    \ gateway, when sending the Proxy Binding Update\n      message to the local mobility\
    \ anchor, MUST construct the message\n      as specified below.\n          IPv6\
    \ header (src=Proxy-CoA, dst=LMAA)\n            Mobility header\n            \
    \   - BU /* P & A flags MUST be set to value 1 */\n              Mobility Options\n\
    \               - Mobile Node Identifier option            (mandatory)\n     \
    \          - Home Network Prefix option(s)            (mandatory)\n          \
    \     - Handoff Indicator option                 (mandatory)\n               -\
    \ Access Technology Type option            (mandatory)\n               - Timestamp\
    \ option                         (optional)\n               - Mobile Node Link-layer\
    \ Identifier option (optional)\n               - Link-local Address option   \
    \             (optional)\n                Figure 12: Proxy Binding Update Message\
    \ Format\n   o  The Source Address field in the IPv6 header of the message MUST\
    \ be\n      set to the global address configured on the egress interface of\n\
    \      the mobile access gateway.  When there is no Alternate Care-of\n      Address\
    \ option present in the request, this address will be\n      considered as the\
    \ Proxy-CoA for this Proxy Binding Update message.\n      However, when there\
    \ is an Alternate Care-of Address option present\n      in the request, this address\
    \ will be not be considered as the\n      Proxy-CoA, but the address in the Alternate\
    \ Care-of Address option\n      will be considered as the Proxy-CoA.\n   o  The\
    \ Destination Address field in the IPv6 header of the message\n      MUST be set\
    \ to the local mobility anchor address.\n   o  The Mobile Node Identifier option\
    \ [RFC4283] MUST be present.\n   o  At least one Home Network Prefix option MUST\
    \ be present.\n   o  The Handoff Indicator option MUST be present.\n   o  The\
    \ Access Technology Type option MUST be present.\n   o  The Timestamp option MAY\
    \ be present.\n   o  The Mobile Node Link-layer Identifier option MAY be present.\n\
    \   o  The Link-local Address option MAY be present.\n   o  If IPsec is used for\
    \ protecting the signaling messages, the\n      message MUST be protected, using\
    \ the security association existing\n      between the local mobility anchor and\
    \ the mobile access gateway.\n   o  Unlike in Mobile IPv6 [RFC3775], the Home\
    \ Address option [RFC3775]\n      MUST NOT be present in the IPv6 Destination\
    \ Options extension\n      header of the Proxy Binding Update message.\n"
- title: 6.9.2.  Router Solicitation Messages
  contents:
  - "6.9.2.  Router Solicitation Messages\n   A mobile node may send a Router Solicitation\
    \ message on the access\n   link shared with the mobile access gateway.  The Router\
    \ Solicitation\n   message that the mobile node sends is as specified in [RFC4861].\
    \  The\n   mobile access gateway, on receiving the Router Solicitation message\n\
    \   or before sending a Router Advertisement message, MUST apply the\n   following\
    \ considerations.\n   1.  The mobile access gateway, on receiving the Router Solicitation\n\
    \       message, SHOULD send a Router Advertisement message containing\n     \
    \  the mobile node's home network prefix(es) as the on-link\n       prefix(es).\
    \  However, before sending the Router Advertisement\n       message containing\
    \ the mobile node's home network prefix(es), it\n       SHOULD complete the binding\
    \ registration process with the mobile\n       node's local mobility anchor.\n\
    \   2.  If the local mobility anchor rejects the Proxy Binding Update\n      \
    \ message, or, if the mobile access gateway failed to complete the\n       binding\
    \ registration process for whatever reason, the mobile\n       access gateway\
    \ MUST NOT advertise the mobile node's home network\n       prefix(es) in the\
    \ Router Advertisement messages that it sends on\n       the access link.  However,\
    \ it MAY choose to advertise a local\n       visited network prefix to enable\
    \ the mobile node for regular IPv6\n       access.\n   3.  The mobile access gateway\
    \ SHOULD add the MTU option, as specified\n       in [RFC4861], to the Router\
    \ Advertisement messages that it sends\n       on the access link.  This will\
    \ ensure the mobile node on the link\n       uses the advertised MTU value.  The\
    \ MTU value SHOULD reflect the\n       tunnel MTU for the bi-directional tunnel\
    \ between the mobile\n       access gateway and the local mobility anchor.  Considerations\n\
    \       from Section 6.9.5 SHOULD be applied for determining the tunnel\n    \
    \   MTU value.\n"
- title: 6.9.3.  Default-Router
  contents:
  - "6.9.3.  Default-Router\n   In Proxy Mobile IPv6, the mobile access gateway is\
    \ the IPv6 default-\n   router for the mobile node on the access link.  However,\
    \ as the\n   mobile node moves from one access link to another, the serving mobile\n\
    \   access gateway on those respective links will send the Router\n   Advertisement\
    \ messages.  If these Router Advertisements are sent\n   using a different link-local\
    \ address or a different link-layer\n   address, the mobile node will always detect\
    \ a new default-router\n   after every handoff.  For solving this problem, this\
    \ specification\n   requires all the mobile access gateways in the Proxy Mobile\
    \ IPv6\n   domain to use the same link-local and link-layer address on any of\n\
    \   the access links wherever the mobile node attaches.  These addresses\n   can\
    \ be fixed addresses across the entire Proxy Mobile IPv6 domain,\n   and all the\
    \ mobile access gateways can use these globally fixed\n   address on any of the\
    \ point-to-point links.  The configuration\n   variables FixedMAGLinkLocalAddressOnAllAccessLinks\
    \ and\n   FixedMAGLinkLayerAddressOnAllAccessLinks SHOULD be used for this\n \
    \  purpose.  Additionally, this specification allows the local mobility\n   anchor\
    \ to generate the link-local address and provide it to the\n   mobile access gateway\
    \ as part of the signaling messages.\n   However, both of these approaches (a\
    \ link-local address generated by\n   the local mobility anchor or when using\
    \ a globally fixed link-local\n   address) have implications on the deployment\
    \ of SEcure Neighbor\n   Discovery (SEND) [RFC3971].  In SEND, routers have certificates\
    \ and\n   public key pairs, and their Router Advertisements are signed with the\n\
    \   private keys of these key pairs.  When a number of different routers\n   use\
    \ the same addresses, the routers either all have to be able to\n   construct\
    \ these signatures for the same key pair, or the used key\n   pair and the router's\
    \ cryptographic identity must change after a\n   movement.  Both approaches are\
    \ problematic.  Sharing of private key\n   information across multiple nodes in\
    \ a PMIP6 domain is poor design\n   from a security perspective.  And changing\
    \ even the cryptographic\n   identity of the router goes against the general idea\
    \ of the Proxy\n   Mobile IPv6 being as invisible to the hosts as possible.\n\
    \   There is, however, ongoing work in the IETF to revise the SEND\n   specifications.\
    \  It is suggested that these revisions also address\n   the above problem.  Other\
    \ revisions are needed to deal with other\n   problematic cases (such as Neighbor\
    \ Discovery proxies) before wide-\n   spread deployment of SEND.\n"
- title: 6.9.4.  Retransmissions and Rate Limiting
  contents:
  - "6.9.4.  Retransmissions and Rate Limiting\n   The mobile access gateway is responsible\
    \ for retransmissions and rate\n   limiting the Proxy Binding Update messages\
    \ that it sends to the local\n   mobility anchor.  The Retransmission and the\
    \ Rate Limiting rules are\n   as specified in [RFC3775].  However, the following\
    \ considerations\n   MUST be applied.\n   1.  When the mobile access gateway sends\
    \ a Proxy Binding Update\n       message, it should use the constant, INITIAL_BINDACK_TIMEOUT\n\
    \       [RFC3775], for configuring the retransmission timer, as specified\n  \
    \     in Section 11.8 [RFC3775].  However, the mobile access gateway is\n    \
    \   not required to use a longer retransmission interval of\n       InitialBindackTimeoutFirstReg,\
    \ as specified in [RFC3775], for the\n       initial Proxy Binding Update message.\n\
    \   2.  If the mobile access gateway fails to receive a valid matching\n     \
    \  response for a registration or re-registration message within the\n       retransmission\
    \ interval, it SHOULD retransmit the message until a\n       response is received.\
    \  However, the mobile access gateway MUST\n       ensure the mobile node is still\
    \ attached to the connected link\n       before retransmitting the message.\n\
    \   3.  As specified in Section 11.8 of [RFC3775], the mobile access\n       gateway\
    \ MUST use an exponential back-off process in which the\n       timeout period\
    \ is doubled upon each retransmission, until either\n       the node receives\
    \ a response or the timeout period reaches the\n       value MAX_BINDACK_TIMEOUT\
    \ [RFC3775].  The mobile access gateway\n       MAY continue to send these messages\
    \ at this slower rate\n       indefinitely.\n   4.  If the Timestamp-based scheme\
    \ is in use, the retransmitted Proxy\n       Binding Update messages MUST use\
    \ the latest timestamp.  If the\n       Sequence Number scheme is in use, the\
    \ retransmitted Proxy Binding\n       Update messages MUST use a Sequence Number\
    \ value greater than\n       that was used for the previous transmission of this\
    \ Proxy Binding\n       Update message, just as specified in [RFC3775].\n"
- title: 6.9.5.  Path MTU Discovery
  contents:
  - "6.9.5.  Path MTU Discovery\n   It is important that mobile node, mobile access\
    \ gateway, and local\n   mobility anchor have a correct understanding of MTUs.\
    \  When the\n   mobile node uses the correct MTU, it can send packets that do\
    \ not\n   exceed the local link MTU and do not cause the tunneled packets from\n\
    \   the mobile access gateway to be fragmented.  This is important both\n   from\
    \ the perspective of efficiency, as well as preventing hard-to-\n   diagnose MTU\
    \ problems.  The following are some of the considerations\n   related to Path\
    \ MTU discovery.\n   o  The local mobility anchor and mobile access gateway MAY\
    \ use the\n      Path MTU discovery mechanisms, as specified in [RFC1981] or in\n\
    \      [RFC4821], for determining the Path MTU (PMTU) for the (LMA-MAG)\n    \
    \  paths.  The specific discovery mechanism to be used in a given\n      deployment\
    \ can be configurable.\n   o  The mobility entities MUST implement and SHOULD\
    \ support ICMP-based\n      Path MTU discovery mechanism, as specified in [RFC1981].\
    \  However,\n      this mechanism may not work correctly if the Proxy Mobile IPv6\n\
    \      network does not deliver or process ICMP Packet Too Big messages.\n   o\
    \  The mobility entities MAY implement Packetization Layer Path MTU\n      discovery\
    \ mechanisms, as specified in [RFC4821], and use any\n      application traffic\
    \ as a payload for the PMTU discovery.  Neither\n      the Proxy Mobile IPv6 protocol\
    \ or the tunnel between the mobile\n      access gateway and local mobility agent\
    \ can easily be used for\n      this purpose.  However, implementations SHOULD\
    \ support at least\n      the use of an explicit ICMP Echo Request/Response for\
    \ this\n      purpose.\n   o  The mobility entities MAY choose to perform Path\
    \ MTU discovery for\n      all the (LMA-MAG) paths at the boot time and may repeat\
    \ this\n      operation periodically to ensure the Path MTU values have not\n\
    \      changed for those paths.  If the dynamic PMTU discovery mechanisms\n  \
    \    fail to determine the Path MTU, an administratively configured\n      default\
    \ value MUST be used.\n   o  The IPv6 tunnel MTU for an established tunnel between\
    \ the local\n      mobility anchor and the mobile access gateway MUST be computed\n\
    \      based on the determined Path MTU value for that specific path and\n   \
    \   the computation should be as specified in Section 6.7 of\n      [RFC2473].\n\
    \   o  The mobile access gateway SHOULD use the determined tunnel Path\n     \
    \ MTU value (for the tunnel established with the mobile node's local\n      mobility\
    \ anchor) as the MTU value in the MTU option that it sends\n      in the Router\
    \ Advertisements on the access link shared with the\n      mobile node.  But,\
    \ if the MTU value of the access link shared with\n      the mobile node is lower\
    \ than the determined Path MTU value, then\n      the MTU of the access link MUST\
    \ be used in the MTU option.\n   o  If the mobile access gateway detects a change\
    \ in the MTU value for\n      any of the paths (LMA-MAG) and at any point of time,\
    \ the\n      corresponding tunnel MTU value MUST be updated to reflect the\n \
    \     change in Path MTU value.  The adjusted tunnel MTU value (lower of\n   \
    \   the Path MTU and the access link MTU) SHOULD be notified to the\n      impacted\
    \ mobile nodes by sending additional Router Advertisement\n      messages.  Additionally,\
    \ the adjusted tunnel MTU value MUST be\n      used in all the subsequent Router\
    \ Advertisement messages as well.\n"
- title: 6.10.  Routing Considerations
  contents:
  - "6.10.  Routing Considerations\n   This section describes how the mobile access\
    \ gateway handles the\n   traffic to/from the mobile node that is attached to\
    \ one of its access\n   interfaces.\n                 Proxy-CoA              \
    \     LMAA\n                    |                          |\n    +--+       \
    \   +---+                      +---+          +--+\n    |MN|----------|MAG|======================|LMA|----------|CN|\n\
    \    +--+          +---+                      +---+          +--+\n          \
    \                  IPv6 Tunnel\n                    Figure 13: Proxy Mobile IPv6\
    \ Tunnel\n"
- title: 6.10.1.  Transport Network
  contents:
  - "6.10.1.  Transport Network\n   As per this specification, the transport network\
    \ between the local\n   mobility anchor and the mobile access gateway is an IPv6\
    \ network.\n   The document [IPV4-PMIP6] specifies the required extensions for\n\
    \   negotiating IPv4 transport and the corresponding encapsulation mode.\n"
- title: 6.10.2.  Tunneling and Encapsulation Modes
  contents:
  - "6.10.2.  Tunneling and Encapsulation Modes\n   An IPv6 address that a mobile\
    \ node uses from its home network\n   prefix(es) is topologically anchored at\
    \ the local mobility anchor.\n   For a mobile node to use this address from an\
    \ access network attached\n   to a mobile access gateway, proper tunneling techniques\
    \ have to be in\n   place.  Tunneling hides the network topology and allows the\
    \ mobile\n   node's IPv6 datagram to be encapsulated as a payload of another IPv6\n\
    \   packet and to be routed between the local mobility anchor and the\n   mobile\
    \ access gateway.  The Mobile IPv6 base specification [RFC3775]\n   defines the\
    \ use of IPv6-over-IPv6 tunneling [RFC2473] between the\n   home agent and the\
    \ mobile node, and this specification extends the\n   use of the same tunneling\
    \ mechanism for use between the local\n   mobility anchor and the mobile access\
    \ gateway.\n   On most operating systems, a tunnel is implemented as a virtual\n\
    \   point-to-point interface.  The source and the destination address of\n   the\
    \ two endpoints of this virtual interface along with the\n   encapsulation mode\
    \ are specified for this virtual interface.  Any\n   packet that is routed over\
    \ this interface gets encapsulated with the\n   outer header as specified for\
    \ that point-to-point tunnel interface.\n   For creating a point-to-point tunnel\
    \ to any local mobility anchor,\n   the mobile access gateway may implement a\
    \ tunnel interface with the\n   Source Address field set to a global address on\
    \ its egress interface\n   (Proxy-CoA) and the destination address field set to\
    \ the global\n   address of the local mobility anchor (LMAA).\n   The following\
    \ is the supported packet encapsulation mode that can be\n   used by the mobile\
    \ access gateway and the local mobility anchor for\n   routing mobile node's IPv6\
    \ datagrams.\n   o  IPv6-In-IPv6 - IPv6 datagram encapsulated in an IPv6 packet\n\
    \      [RFC2473].\n   The companion document [IPV4-PMIP6] specifies other encapsulation\n\
    \   modes for supporting IPv4 transport.\n   o  IPv6-In-IPv4 - IPv6 datagram encapsulation\
    \ in an IPv4 packet.  The\n      details on how this mode is negotiated are specified\
    \ in\n      [IPV4-PMIP6].\n   o  IPv6-In-IPv4-UDP - IPv6 datagram encapsulation\
    \ in an IPv4 UDP\n      packet.  This mode is specified in [IPV4-PMIP6].\n   o\
    \  IPv6-In-IPv4-UDP-TLV - IPv6 datagram encapsulation in an IPv4 UDP\n      packet\
    \ with a TLV header.  This mode is specified in [IPV4-PMIP6].\n"
- title: 6.10.3.  Local Routing
  contents:
  - "6.10.3.  Local Routing\n   If there is data traffic between a visiting mobile\
    \ node and a\n   correspondent node that is locally attached to an access link\n\
    \   connected to the mobile access gateway, the mobile access gateway MAY\n  \
    \ optimize on the delivery efforts by locally routing the packets and\n   by not\
    \ reverse tunneling them to the mobile node's local mobility\n   anchor.  The\
    \ flag EnableMAGLocalRouting MAY be used for controlling\n   this behavior.  However,\
    \ in some systems, this may have an\n   implication on the mobile node's accounting\
    \ and policy enforcement as\n   the local mobility anchor is not in the path for\
    \ that traffic and it\n   will not be able to apply any traffic policies or do\
    \ any accounting\n   for those flows.\n   This decision of path optimization SHOULD\
    \ be based on the policy\n   configured on the mobile access gateway, but enforced\
    \ by the mobile\n   node's local mobility anchor.  The specific details on how\
    \ this is\n   achieved are beyond of the scope of this document.\n"
- title: 6.10.4.  Tunnel Management
  contents:
  - "6.10.4.  Tunnel Management\n   All the considerations mentioned in Section 5.6.1\
    \ for the tunnel\n   management on the local mobility anchor apply for the mobile\
    \ access\n   gateway as well.\n"
- title: 6.10.5.  Forwarding Rules
  contents:
  - "6.10.5.  Forwarding Rules\n   Forwarding Packets Sent to the Mobile Node's Home\
    \ Network:\n   o  On receiving a packet from the bi-directional tunnel established\n\
    \      with the mobile node's local mobility anchor, the mobile access\n     \
    \ gateway MUST use the destination address of the inner packet for\n      forwarding\
    \ it on the interface where the destination network\n      prefix is hosted. \
    \ The mobile access gateway MUST remove the outer\n      header before forwarding\
    \ the packet.  Considerations from\n      [RFC2473] MUST be applied for IPv6 decapsulation.\
    \  If the mobile\n      access gateway cannot find the connected interface for\
    \ that\n      destination address, it MUST silently drop the packet.  For\n  \
    \    reporting an error in such a scenario, in the form of an ICMP\n      control\
    \ message, the considerations from [RFC2473] MUST be\n      applied.\n   o  On\
    \ receiving a packet from a correspondent node that is connected\n      to the\
    \ mobile access gateway as a regular IPv6 host (see Section\n      6.14) destined\
    \ to a mobile node that is also locally attached, the\n      mobile access gateway\
    \ MUST check the flag EnableMAGLocalRouting to\n      determine if the packet\
    \ can be delivered directly to the mobile\n      node.  If the mobile access gateway\
    \ is not allowed to route the\n      packet directly, it MUST route the packet\
    \ towards the local\n      mobility anchor where the destination address is topologically\n\
    \      anchored, else it can route the packet directly to the mobile\n      node.\n\
    \   Forwarding Packets Sent by the Mobile Node:\n   o  On receiving a packet from\
    \ a mobile node connected to its access\n      link, the mobile access gateway\
    \ MUST ensure that there is an\n      established binding for that mobile node\
    \ with its local mobility\n      anchor before forwarding the packet directly\
    \ to the destination or\n      before tunneling the packet to the mobile node's\
    \ local mobility\n      anchor.\n   o  On receiving a packet from a mobile node\
    \ connected to its access\n      link for a destination that is locally connected,\
    \ the mobile\n      access gateway MUST check the flag EnableMAGLocalRouting,\
    \ to\n      ensure the mobile access gateway is allowed to route the packet\n\
    \      directly to the destination.  If the mobile access gateway is not\n   \
    \   allowed to route the packet directly, it MUST route the packet\n      through\
    \ the bi-directional tunnel established between itself and\n      the mobile node's\
    \ local mobility anchor.  Otherwise, it MUST route\n      the packet directly\
    \ to the destination.\n   o  On receiving a packet from a mobile node connected\
    \ to its access\n      link, to a destination that is not directly connected,\
    \ the packet\n      MUST be forwarded to the local mobility anchor through the\
    \ bi-\n      directional tunnel established between itself and the mobile\n  \
    \    node's local mobility anchor.  However, the packets that are sent\n     \
    \ with the link-local source address MUST NOT be forwarded.\n   o  The format\
    \ of the tunneled packet is shown below.  Considerations\n      from [RFC2473]\
    \ MUST be applied for IPv6 encapsulation.  However,\n      when using IPv4 transport,\
    \ the format of the tunneled packet is as\n      described in [IPV4-PMIP6].\n\
    \        IPv6 header (src= Proxy-CoA, dst= LMAA  /* Tunnel Header */\n       \
    \    IPv6 header (src= MN-HoA, dst= CN )  /* Packet Header */\n              Upper\
    \ layer protocols             /* Packet Content*/\n                  Figure 14:\
    \ Tunneled Packet from MAG to LMA\n   o  The format of the tunneled packet is\
    \ shown below, when payload\n      protection using IPsec is enabled for the mobile\
    \ node's data\n      traffic.  However, when using IPv4 transport, the format\
    \ of the\n      packet is as described in [IPV4-PMIP6].\n        IPv6 header (src=\
    \ Proxy-CoA, dst= LMAA     /* Tunnel Header */\n           ESP Header in tunnel\
    \ mode               /* ESP Header */\n              IPv6 header (src= MN-HoA,\
    \ dst= CN )  /* Packet Header */\n                 Upper layer protocols     \
    \        /* Packet Content*/\n      Figure 15: Tunneled Packet from MAG to LMA\
    \ with Payload Protection\n"
- title: 6.11.  Supporting DHCP-Based Address Configuration on the Access Link
  contents:
  - "6.11.  Supporting DHCP-Based Address Configuration on the Access Link\n   This\
    \ section explains how Stateful Address Configuration using DHCP\n   support can\
    \ be enabled in a Proxy Mobile IPv6 domain.  It also\n   identifies the required\
    \ configuration in DHCP and mobility\n   infrastructures for supporting this address\
    \ configuration mode and\n   also identifies the protocol interactions between\
    \ these two systems.\n   o  For supporting Stateful Address Configuration using\
    \ DHCP, the DHCP\n      relay agent [RFC3315] service MUST be supported on all\
    \ the mobile\n      access gateways in the Proxy Mobile IPv6 domain.  Further,\
    \ as\n      specified in Section 20 of [RFC3315], the DHCP relay agent should\n\
    \      be configured to use a list of destination addresses, which MAY\n     \
    \ include unicast addresses, the All_DHCP_Servers multicast address,\n      or\
    \ other addresses as required in a given deployment.\n   o  The DHCP infrastructure\
    \ needs to be configured to assign addresses\n      from each of the prefixes\
    \ assigned to a link in that Proxy Mobile\n      IPv6 domain.  The DHCP relay\
    \ agent indicates the link to which the\n      mobile node is attached by including\
    \ an IPv6 address from any of\n      the prefixes assigned to that link in the\
    \ link-address field of\n      the Relay Forward message.  Therefore, for each\
    \ link in the Mobile\n      IPv6 domain, the DHCP infrastructure will:\n     \
    \ *  be configured with a list of all of the prefixes associated\n         with\
    \ that link;\n      *  identify the link to which the mobile node is attached\
    \ by\n         looking up the prefix for the link-address field in the Relay\n\
    \         Forward message in the list of prefixes associated with each\n     \
    \    link;\n      *  assign to the host an address from each prefix associated\
    \ with\n         the link to which the mobile node is attached.\n      This DHCP\
    \ infrastructure configuration requirement is identical to\n      other IPv6 networks;\
    \ other than receiving DHCP messages from a\n      mobile node through different\
    \ relay agents (MAGs) over time, the\n      DHCP infrastructure will be unaware\
    \ of the mobile node's\n      capability with respect to mobility support.\n \
    \  o  The local mobility anchor needs to have the same awareness with\n      respect\
    \ to the links along with the associated prefixes in a Proxy\n      Mobile IPv6\
    \ domain.  When a local mobility anchor assigns\n      prefix(es) to a mobile\
    \ node, it MUST assign all the prefixes\n      associated with a given link and\
    \ all of those assigned prefixes\n      will remain as the home network prefixes\
    \ for that mobile node\n      throughout the life of that mobility session.  The\
    \ serving mobile\n      access gateway that hosts these prefixes is physically\
    \ connected\n      to that link and can function as the DHCP relay agent.  This\n\
    \      common understanding between DHCP and mobility entities about all\n   \
    \   the links in the domain along with the associated prefixes\n      provides\
    \ the required coordination for allowing mobility entities\n      to perform prefix\
    \ assignment dynamically to a mobile node and\n      still allow the DHCP infrastructure\
    \ to perform address assignment\n      for that mobile node only from its home\
    \ network prefixes.\n   o  When a mobile node sends a DHCP request message, the\
    \ DHCP relay\n      agent function on the mobile access gateway will set the link-\n\
    \      address field in the DHCP message to an address in the mobile\n      node's\
    \ home network prefix (any one of the mobile node's home\n      network prefixes\
    \ assigned to that mobile node's attached\n      interface).  The mobile access\
    \ gateway can generate an\n      autoconfiguration address from one of the mobile\
    \ node's home\n      network prefixes [RFC4862] and can use this address link-address\n\
    \      option, so as to provide a hint to the DHCP Server for the link\n     \
    \ identification.  The DHCP server, on receiving the request from\n      the mobile\
    \ node, will allocate addresses from all the prefixes\n      associated with that\
    \ link (identified using the link-address field\n      of the request).\n   o\
    \  Once the mobile node obtains address(es), moves to a different\n      link,\
    \ and sends a DHCP request (at any time) for extending the\n      DHCP lease,\
    \ the DHCP relay agent on the new link will set the\n      link-address field\
    \ in the DHCP Relay Forward message to one of the\n      mobile node's home network\
    \ prefixes.  The DHCP server will\n      identify the client from the Client-DUID\
    \ option and will identify\n      the link from the link-address option present\
    \ in the request and\n      will allocate the same address(es) as before.\n  \
    \ o  For correct operation of the model of network-based mobility\n      management\
    \ in which the host does not participate in any mobility\n      management, the\
    \ mobile node MUST always be assigned an identical\n      set of IPv6 addresses\
    \ regardless of the access link to which the\n      mobile node is attached. \
    \ For example, the mobile access gateways\n      in the Proxy Mobile IPv6 domain\
    \ should be configured so that DHCP\n      messages from a mobile node will always\
    \ be handled by the same\n      DHCP server or by a server from the same group\
    \ of coordinated DHCP\n      servers serving that domain.  DHCP-based address\
    \ configuration is\n      not recommended for deployments in which the local mobility\
    \ anchor\n      and the mobile access gateway are located in different\n     \
    \ administrative domains.\n"
- title: 6.12.  Home Network Prefix Renumbering
  contents:
  - "6.12.  Home Network Prefix Renumbering\n   If the mobile node's home network\
    \ prefix(es) gets renumbered or\n   becomes invalid during the middle of a mobility\
    \ session, the mobile\n   access gateway MUST withdraw the prefix(es) by sending\
    \ a Router\n   Advertisement message on the access link with zero prefix lifetime\n\
    \   for the prefix(es) that is being renumbered.  Also, the local\n   mobility\
    \ anchor and the mobile access gateway MUST delete the created\n   routing state\
    \ for the renumbered prefix(es).  However, the specific\n   details on how the\
    \ local mobility anchor notifies the mobile access\n   gateway about the mobile\
    \ node's home network prefix(es) renumbering\n   are outside the scope of this\
    \ document.\n"
- title: 6.13.  Mobile Node Detachment Detection and Resource Cleanup
  contents:
  - "6.13.  Mobile Node Detachment Detection and Resource Cleanup\n   Before sending\
    \ a Proxy Binding Update message to the local mobility\n   anchor for extending\
    \ the lifetime of a currently existing binding of\n   a mobile node, the mobile\
    \ access gateway MUST make sure the mobile\n   node is still attached to the connected\
    \ link by using some reliable\n   method.  If the mobile access gateway cannot\
    \ predictably detect the\n   presence of the mobile node on the connected link,\
    \ it MUST NOT\n   attempt to extend the registration lifetime of the mobile node.\n\
    \   Further, in such a scenario, the mobile access gateway SHOULD\n   terminate\
    \ the binding of the mobile node by sending a Proxy Binding\n   Update message\
    \ to the mobile node's local mobility anchor with\n   lifetime value set to 0.\
    \  It MUST also remove any local state such as\n   the Binding Update List entry\
    \ created for that mobile node.\n   The specific detection mechanism of the loss\
    \ of a visiting mobile\n   node on the connected link is specific to the access\
    \ link between the\n   mobile node and the mobile access gateway and is outside\
    \ the scope of\n   this document.  Typically, there are various link-layer-specific\n\
    \   events specific to each access technology that the mobile access\n   gateway\
    \ can depend on for detecting the node loss.  In general, the\n   mobile access\
    \ gateway can depend on one or more of the following\n   methods for the detection\
    \ presence of the mobile node on the\n   connected link:\n   o  Link-layer event\
    \ specific to the access technology\n   o  Session termination event on point-to-point\
    \ link types\n   o  IPv6 Neighbor Unreachability Detection event from IPv6 stack\n\
    \   o  Notification event from the local mobility anchor\n"
- title: 6.14.  Allowing Network Access to Other IPv6 Nodes
  contents:
  - "6.14.  Allowing Network Access to Other IPv6 Nodes\n   In some Proxy Mobile IPv6\
    \ deployments, network operators may\n   provision the mobile access gateway to\
    \ offer network-based mobility\n   management service only to some visiting mobile\
    \ nodes and enable just\n   regular IP access to some other nodes.  This requires\
    \ the network to\n   have control on when to enable network-based mobility management\n\
    \   service to a mobile node and when to enable regular IPv6 access.\n   This\
    \ specification does not disallow such configuration.\n   Upon detecting a mobile\
    \ node on its access link and after policy\n   considerations, the mobile access\
    \ gateway MUST determine if network-\n   based mobility management service should\
    \ be offered to that mobile\n   node.  If the mobile node is entitled to network-based\
    \ mobility\n   management service, then the mobile access gateway must ensure\
    \ the\n   mobile node does not detect any change with respect to its layer-3\n\
    \   attachment, as explained in various sections of this specification.\n   If\
    \ the mobile node is not entitled to the network-based mobility\n   management\
    \ service, as determined from the policy considerations, the\n   mobile access\
    \ gateway MAY choose to offer regular IPv6 access to the\n   mobile node, and\
    \ in such a scenario, the normal IPv6 considerations\n   apply.  If IPv6 access\
    \ is enabled, the mobile node SHOULD be able to\n   obtain IPv6 address(es) using\
    \ the normal IPv6 address configuration\n   procedures.  The obtained address(es)\
    \ must be from a local visitor\n   network prefix(es).  This essentially ensures\
    \ that the mobile access\n   gateway functions as a normal access router to a\
    \ mobile node attached\n   to its access link and without impacting its host-based\
    \ mobility\n   protocol operation.\n"
- title: 7.  Mobile Node Operation
  contents:
  - "7.  Mobile Node Operation\n   This non-normative section explains the mobile\
    \ node's operation in a\n   Proxy Mobile IPv6 domain.\n"
- title: 7.1.  Moving into a Proxy Mobile IPv6 Domain
  contents:
  - "7.1.  Moving into a Proxy Mobile IPv6 Domain\n   When a mobile node enters a\
    \ Proxy Mobile IPv6 domain and attaches to\n   an access network, the mobile access\
    \ gateway on the access link\n   detects the attachment of the mobile node and\
    \ completes the binding\n   registration with the mobile node's local mobility\
    \ anchor.  If the\n   binding update operation is successfully performed, the\
    \ mobile access\n   gateway will create the required state and set up the forwarding\
    \ for\n   the mobile node's data traffic.\n   When a mobile node attaches to the\
    \ access link, it will typically\n   send a Router Solicitation message [RFC4861].\
    \  The mobile access\n   gateway on the access link will respond to the Router\
    \ Solicitation\n   message with a Router Advertisement message.  The Router\n\
    \   Advertisement message will carry the mobile node's home network\n   prefix(es),\
    \ default-router address, and other address configuration\n   parameters.\n  \
    \ If the mobile access gateway on the access link receives a Router\n   Solicitation\
    \ message from the mobile node, before it completes the\n   signaling with the\
    \ mobile node's local mobility anchor, the mobile\n   access gateway may not know\
    \ the mobile node's home network prefix(es)\n   and may not be able to emulate\
    \ the mobile node's home link on the\n   access link.  In such a scenario, the\
    \ mobile node may notice a delay\n   before it receives a Router Advertisement\
    \ message.  This will also\n   affect mobile nodes that would be capable of handling\
    \ their own\n   mobility, or mobile nodes that do not need to maintain the same\
    \ IP\n   address through movements.\n   If the received Router Advertisement message\
    \ has the Managed Address\n   Configuration flag set, the mobile node, as it would\
    \ normally do,\n   will send a DHCP Request [RFC3315].  The DHCP relay service\
    \ enabled\n   on that access link will ensure the mobile node can obtain one or\n\
    \   more addresses from its home network prefix(es).\n   If the received Router\
    \ Advertisement message does not have the\n   Managed Address Configuration flag\
    \ set and if the mobile node is\n   allowed to use autoconfigured address(es),\
    \ the mobile node will be\n   able to obtain IPv6 address(es) from each of its\
    \ home network\n   prefixes using any of the standard IPv6 address configuration\n\
    \   mechanisms permitted for that mode.\n   If the mobile node is IPv4-enabled\
    \ and if the network permits, it\n   will be able to obtain the IPv4 address configuration,\
    \ as specified\n   in the companion document [IPV4-PMIP6].\n   Once the address\
    \ configuration is complete, the mobile node can\n   continue to use this address\
    \ configuration as long as it is attached\n   to the network that is in the scope\
    \ of that Proxy Mobile IPv6 domain.\n"
- title: 7.2.  Roaming in the Proxy Mobile IPv6 Domain
  contents:
  - "7.2.  Roaming in the Proxy Mobile IPv6 Domain\n   After obtaining the address\
    \ configuration in the Proxy Mobile IPv6\n   domain, as the mobile node moves\
    \ and changes its point of attachment\n   from one mobile access gateway to the\
    \ other, it can still continue to\n   use the same address configuration.  As\
    \ long as the attached access\n   link is in the scope of that Proxy Mobile IPv6\
    \ domain, the mobile\n   node will always detect the same router advertising itself\
    \ as a\n   default-router and advertising the mobile node's home network\n   prefix(es)\
    \ on each connected link.  If the mobile node has address\n   configuration that\
    \ it obtained using DHCP, it will be able to retain\n   the address configuration\
    \ and extend the lease lifetime.\n"
- title: 8.  Message Formats
  contents:
  - "8.  Message Formats\n   This section defines extensions to the Mobile IPv6 [RFC3775]\
    \ protocol\n   messages.\n"
- title: 8.1.  Proxy Binding Update Message
  contents:
  - "8.1.  Proxy Binding Update Message\n       0               1               2\
    \               3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1\n                                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                      |            Sequence #         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |A|H|L|K|M|R|P|\
    \  Reserved       |            Lifetime           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   .                                                               .\n      .\
    \                        Mobility options                       .\n      .   \
    \                                                            .\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   A Binding Update message that is sent by a mobile access gateway to a\n  \
    \ local mobility anchor is referred to as the \"Proxy Binding Update\"\n   message.\
    \  A new flag (P) is included in the Binding Update message.\n   The rest of the\
    \ Binding Update message format remains the same as\n   defined in [RFC3775] and\
    \ with the additional (R) and (M) flags, as\n   specified in [RFC3963] and [RFC4140],\
    \ respectively.\n   Proxy Registration Flag (P)\n      A new flag (P) is included\
    \ in the Binding Update message to\n      indicate to the local mobility anchor\
    \ that the Binding Update\n      message is a proxy registration.  The flag MUST\
    \ be set to the\n      value of 1 for proxy registrations and MUST be set to 0\
    \ for direct\n      registrations sent by a mobile node.\n   Mobility Options\n\
    \      Variable-length field of such length that the complete Mobility\n     \
    \ Header is an integer multiple of 8 octets long.  This field\n      contains\
    \ zero or more TLV-encoded mobility options.  The encoding\n      and format of\
    \ defined options are described in Section 6.2 of\n      [RFC3775].  The local\
    \ mobility anchor MUST ignore and skip any\n      options that it does not understand.\n\
    \      As per this specification, the following mobility options are\n      valid\
    \ in a Proxy Binding Update message.  These options can be\n      present in the\
    \ message in any order.  There can be one or more\n      instances of the Home\
    \ Network Prefix options present in the\n      message.  However, there cannot\
    \ be more than one instance of any\n      of the following options.\n        \
    \ Mobile Node Identifier option\n         Home Network Prefix option\n       \
    \  Handoff Indicator option\n         Access Technology Type option\n        \
    \ Timestamp option\n         Mobile Node Link-layer Identifier option\n      \
    \   Link-local Address option\n      Additionally, there can be one or more instances\
    \ of the Vendor-\n      Specific Mobility option [RFC5094].\n   For descriptions\
    \ of other fields present in this message, refer to\n   Section 6.1.7 of [RFC3775].\n"
- title: 8.2.  Proxy Binding Acknowledgement Message
  contents:
  - "8.2.  Proxy Binding Acknowledgement Message\n       0                   1   \
    \                2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                      |   Status      |K|R|P|Reserved |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \         Sequence #            |           Lifetime            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   .                                                               .\n      .\
    \                        Mobility options                       .\n      .   \
    \                                                            .\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   A Binding Acknowledgement message that is sent by a local mobility\n   anchor\
    \ to a mobile access gateway is referred to as the \"Proxy\n   Binding Acknowledgement\"\
    \ message.  A new flag (P) is included in the\n   Binding Acknowledgement message.\
    \  The rest of the Binding\n   Acknowledgement message format remains the same\
    \ as defined in\n   [RFC3775] and with the additional (R) flag as specified in\
    \ [RFC3963].\n   Proxy Registration Flag (P)\n      A new flag (P) is included\
    \ in the Binding Acknowledgement message\n      to indicate that the local mobility\
    \ anchor that processed the\n      corresponding Proxy Binding Update message\
    \ supports proxy\n      registrations.  The flag is set to a value of 1 only if\
    \ the\n      corresponding Proxy Binding Update had the Proxy Registration Flag\n\
    \      (P) set to value of 1.\n   Mobility Options\n      A variable-length field\
    \ of such length that the complete Mobility\n      Header is an integer multiple\
    \ of 8 octets long.  This field\n      contains zero or more TLV-encoded mobility\
    \ options.  The encoding\n      and format of defined options are described in\
    \ Section 6.2 of\n      [RFC3775].  The mobile access gateway MUST ignore and\
    \ skip any\n      options that it does not understand.\n      As per this specification,\
    \ the following mobility options are\n      valid in a Proxy Binding Acknowledgement\
    \ message.  These options\n      can be present in the message in any order. \
    \ There can be one or\n      more instances of the Home Network Prefix options\
    \ present in the\n      message.  However, there cannot be more than one instance\
    \ of any\n      of the following options.\n         Mobile Node Identifier option\n\
    \         Home Network Prefix option\n         Handoff Indicator option\n    \
    \     Access Technology Type option\n         Timestamp option\n         Mobile\
    \ Node Link-layer Identifier option\n         Link-local Address option\n    \
    \  Additionally, there can be one or more instances of the Vendor-\n      Specific\
    \ Mobility option [RFC5094].\n   Status\n      An 8-bit unsigned integer indicating\
    \ the disposition of the Proxy\n      Binding Update.  Values of the Status field\
    \ less than 128 indicate\n      that the Proxy Binding Update was accepted by\
    \ the local mobility\n      anchor.  Values greater than or equal to 128 indicate\
    \ that the\n      Proxy Binding Update message was rejected by the local mobility\n\
    \      anchor.  Section 8.9 defines the Status values that can used in\n     \
    \ Proxy Binding Acknowledgement message.\n   For descriptions of other fields\
    \ present in this message, refer to\n   Section 6.1.8 of [RFC3775].\n"
- title: 8.3.  Home Network Prefix Option
  contents:
  - "8.3.  Home Network Prefix Option\n   A new option, Home Network Prefix option\
    \ is defined for use with the\n   Proxy Binding Update and Proxy Binding Acknowledgement\
    \ messages\n   exchanged between a local mobility anchor and a mobile access\n\
    \   gateway.  This option is used for exchanging the mobile node's home\n   network\
    \ prefix information.  There can be multiple Home Network\n   Prefix options present\
    \ in the message.\n   The Home Network Prefix Option has an alignment requirement\
    \ of 8n+4.\n   Its format is as follows:\n       0                   1       \
    \            2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Type     |   Length      |   Reserved    | Prefix Length |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                                                            +\n      |      \
    \                                                         |\n      +         \
    \           Home Network Prefix                        +\n      |            \
    \                                                   |\n      +               \
    \                                                +\n      |                  \
    \                                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       Type\n           22\n       Length\n           8-bit unsigned integer\
    \ indicating the length of the option\n           in octets, excluding the type\
    \ and length fields.  This field\n           MUST be set to 18.\n       Reserved\
    \ (R)\n           This 8-bit field is unused for now.  The value MUST be\n   \
    \        initialized to 0 by the sender and MUST be ignored by the\n         \
    \  receiver.\n       Prefix Length\n           8-bit unsigned integer indicating\
    \ the prefix length of the\n           IPv6 prefix contained in the option.\n\
    \       Home Network Prefix\n           A sixteen-byte field containing the mobile\
    \ node's IPv6 Home\n           Network Prefix.\n"
- title: 8.4.  Handoff Indicator Option
  contents:
  - "8.4.  Handoff Indicator Option\n   A new option, Handoff Indicator option is\
    \ defined for use with the\n   Proxy Binding Update and Proxy Binding Acknowledgement\
    \ messages\n   exchanged between a local mobility anchor and a mobile access\n\
    \   gateway.  This option is used for exchanging the mobile node's\n   handoff-related\
    \ hints.\n   The Handoff Indicator option has no alignment requirement.  Its\n\
    \   format is as follows:\n    0                   1                   2     \
    \              3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |   Length      |  Reserved (R) |       HI      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Type\n        23\n    Length\n        8-bit unsigned integer indicating the\
    \ length of the option\n        in octets, excluding the type and length fields.\
    \  This field\n        MUST be set to 2.\n    Reserved (R)\n        This 8-bit\
    \ field is unused for now.  The value MUST be\n        initialized to 0 by the\
    \ sender and MUST be ignored by the\n        receiver.\n    Handoff Indicator\
    \ (HI)\n        An 8-bit field that specifies the type of handoff.  The values\n\
    \        (0 - 255) will be allocated and managed by IANA.  The following\n   \
    \     values are currently defined.\n        0: Reserved\n        1: Attachment\
    \ over a new interface\n        2: Handoff between two different interfaces of\
    \ the mobile node\n        3: Handoff between mobile access gateways for the same\
    \ interface\n        4: Handoff state unknown\n        5: Handoff state not changed\
    \ (Re-registration)\n"
- title: 8.5.  Access Technology Type Option
  contents:
  - "8.5.  Access Technology Type Option\n   A new option, Access Technology Type\
    \ option is defined for use with\n   the Proxy Binding Update and Proxy Binding\
    \ Acknowledgement messages\n   exchanged between a local mobility anchor and a\
    \ mobile access\n   gateway.  This option is used for exchanging the type of the\
    \ access\n   technology by which the mobile node is currently attached to the\n\
    \   mobile access gateway.\n   The Access Technology Type Option has no alignment\
    \ requirement.  Its\n   format is as follows:\n    0                   1     \
    \              2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |   Length      |  Reserved (R) |      ATT      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Type\n        24\n    Length\n        8-bit unsigned integer indicating the\
    \ length of the option\n        in octets, excluding the type and length fields.\
    \  This field\n        MUST be set to 2.\n    Reserved (R)\n        This 8-bit\
    \ field is unused for now.  The value MUST be\n        initialized to 0 by the\
    \ sender and MUST be ignored by the\n        receiver.\n    Access Technology\
    \ Type (ATT)\n        An 8-bit field that specifies the access technology through\n\
    \        which the mobile node is connected to the access link on the\n      \
    \  mobile access gateway.\n        The values (0 - 255) will be allocated and\
    \ managed by IANA.  The\n        following values are currently reserved for the\
    \ below specified\n        access technology types.\n        0: Reserved     \
    \    (\"Reserved\")\n        1: Virtual          (\"Logical Network Interface\"\
    )\n        2: PPP              (\"Point-to-Point Protocol\")\n        3: IEEE\
    \ 802.3       (\"Ethernet\")\n        4: IEEE 802.11a/b/g (\"Wireless LAN\")\n\
    \        5: IEEE 802.16e     (\"WIMAX\")\n"
- title: 8.6.  Mobile Node Link-layer Identifier Option
  contents:
  - "8.6.  Mobile Node Link-layer Identifier Option\n   A new option, Mobile Node\
    \ Link-layer Identifier option is defined for\n   use with the Proxy Binding Update\
    \ and Proxy Binding Acknowledgement\n   messages exchanged between a local mobility\
    \ anchor and a mobile\n   access gateway.  This option is used for exchanging\
    \ the mobile node's\n   link-layer identifier.\n   The format of the Link-layer\
    \ Identifier option is shown below.  Based\n   on the size of the identifier,\
    \ the option MUST be aligned\n   appropriately, as per mobility option alignment\
    \ requirements\n   specified in [RFC3775].\n     0                   1       \
    \            2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |   Type        |    Length     |          Reserved             |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    +\
    \                        Link-layer Identifier                  +\n    .     \
    \                         ...                              .\n    |          \
    \                                                     |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     Type\n         25\n     Length\n         8-bit unsigned integer indicating\
    \ the length of the option\n         in octets, excluding the type and length\
    \ fields.\n     Reserved\n         This field is unused for now.  The value MUST\
    \ be initialized to\n         0 by the sender and MUST be ignored by the receiver.\n\
    \     Link-layer Identifier\n         A variable length field containing the mobile\
    \ node's link-layer\n         identifier.\n         The content and format of\
    \ this field (including byte and bit\n         ordering) is as specified in Section\
    \ 4.6 of [RFC4861] for\n         carrying link-layer addresses.  On certain access\
    \ links, where\n         the link-layer address is not used or cannot be determined,\n\
    \         this option cannot be used.\n"
- title: 8.7.  Link-local Address Option
  contents:
  - "8.7.  Link-local Address Option\n   A new option, Link-local Address option is\
    \ defined for use with the\n   Proxy Binding Update and Proxy Binding Acknowledgement\
    \ messages\n   exchanged between a local mobility anchor and a mobile access\n\
    \   gateway.  This option is used for exchanging the link-local address\n   of\
    \ the mobile access gateway.\n   The Link-local Address option has an alignment\
    \ requirement of 8n+6.\n   Its format is as follows:\n       0               \
    \    1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                                  \
    \    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                                     \
    \ |   Type        |    Length     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                                                               +\n      |\
    \                                                               |\n      +   \
    \               Link-local Address                           +\n      |      \
    \                                                         |\n      +         \
    \                                                      +\n      |            \
    \                                                   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       Type\n           26\n       Length\n           8-bit unsigned integer\
    \ indicating the length of the option\n           in octets, excluding the type\
    \ and length fields.  This field\n           MUST be set to 16.\n       Link-local\
    \ Address\n           A sixteen-byte field containing the link-local address.\n"
- title: 8.8.  Timestamp Option
  contents:
  - "8.8.  Timestamp Option\n   A new option, Timestamp option is defined for use\
    \ in the Proxy\n   Binding Update and Proxy Binding Acknowledgement messages.\n\
    \   The Timestamp option has an alignment requirement of 8n+2.  Its\n   format\
    \ is as follows:\n     0                   1                   2             \
    \      3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \                                 |      Type     |   Length      |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                                                               |\n    \
    \ +                          Timestamp                            +\n     |  \
    \                                                             |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Type\n          27\n      Length\n          8-bit unsigned integer indicating\
    \ the length in octets of\n          the option, excluding the type and length\
    \ fields.  The value\n          for this field MUST be set to 8.\n      Timestamp\n\
    \          A 64-bit unsigned integer field containing a timestamp.  The\n    \
    \      value indicates the number of seconds since January 1, 1970,\n        \
    \  00:00 UTC, by using a fixed point format.  In this format, the\n          integer\
    \ number of seconds is contained in the first 48 bits of\n          the field,\
    \ and the remaining 16 bits indicate the number of\n          1/65536 fractions\
    \ of a second.\n"
- title: 8.9.  Status Values
  contents:
  - "8.9.  Status Values\n   This document defines the following new Status values\
    \ for use in\n   Proxy Binding Acknowledgement messages.  These values are to\
    \ be\n   allocated from the same number space, as defined in Section 6.1.8 of\n\
    \   [RFC3775].\n   Status values less than 128 indicate that the Proxy Binding\
    \ Update\n   message was accepted by the local mobility anchor.  Status values\n\
    \   greater than 128 indicate that the Proxy Binding Update was rejected\n   by\
    \ the local mobility anchor.\n   PROXY_REG_NOT_ENABLED: 152\n      Proxy registration\
    \ not enabled for the mobile node\n   NOT_LMA_FOR_THIS_MOBILE_NODE: 153\n    \
    \  Not local mobility anchor for this mobile node\n   MAG_NOT_AUTHORIZED_FOR_PROXY_REG:\
    \ 154\n      The mobile access gateway is not authorized to send proxy binding\n\
    \      updates\n   NOT_AUTHORIZED_FOR_HOME_NETWORK_PREFIX: 155\n      The mobile\
    \ node is not authorized for one or more of the\n      requesting home network\
    \ prefixes\n   TIMESTAMP_MISMATCH: 156\n      Invalid timestamp value (the clocks\
    \ are out of sync)\n   TIMESTAMP_LOWER_THAN_PREV_ACCEPTED: 157\n      The timestamp\
    \ value is lower than the previously accepted value\n   MISSING_HOME_NETWORK_PREFIX_OPTION:\
    \ 158\n      Missing home network prefix option\n   BCE_PBU_PREFIX_SET_DO_NOT_MATCH:\
    \ 159\n      All the home network prefixes listed in the BCE do not match all\n\
    \      the prefixes in the received PBU\n   MISSING_MN_IDENTIFIER_OPTION: 160\n\
    \      Missing mobile node identifier option\n   MISSING_HANDOFF_INDICATOR_OPTION:\
    \ 161\n      Missing handoff indicator option\n   MISSING_ACCESS_TECH_TYPE_OPTION:\
    \ 162\n      Missing access technology type option\n   Additionally, the following\
    \ Status values defined in [RFC3775] can\n   also be used in a Proxy Binding Acknowledgement\
    \ message.\n      0 Proxy Binding Update accepted\n      128 Reason unspecified\n\
    \      129 Administratively prohibited\n      130 Insufficient resources\n"
- title: 9.  Protocol Configuration Variables
  contents:
  - '9.  Protocol Configuration Variables

    '
- title: 9.1.  Local Mobility Anchor - Configuration Variables
  contents:
  - "9.1.  Local Mobility Anchor - Configuration Variables\n   The local mobility\
    \ anchor MUST allow the following variables to be\n   configured by the system\
    \ management.  The configured values for these\n   protocol variables MUST survive\
    \ server reboots and service restarts.\n   MinDelayBeforeBCEDelete\n      This\
    \ variable specifies the amount of time in milliseconds the\n      local mobility\
    \ anchor MUST wait before it deletes a Binding Cache\n      entry of a mobile\
    \ node, upon receiving a Proxy Binding Update\n      message from a mobile access\
    \ gateway with a lifetime value of 0.\n      During this wait time, if the local\
    \ mobility anchor receives a\n      Proxy Binding Update for the same mobility\
    \ binding, with a\n      lifetime value greater than 0, then it must update the\
    \ binding\n      cache entry with the accepted binding values.  By the end of\
    \ this\n      wait-time, if the local mobility anchor did not receive any valid\n\
    \      Proxy Binding Update message for that mobility binding, it MUST\n     \
    \ delete the Binding Cache entry.  This delay essentially ensures a\n      mobile\
    \ node's Binding Cache entry is not deleted too quickly and\n      allows some\
    \ time for the new mobile access gateway to complete the\n      signaling for\
    \ the mobile node.\n      The default value for this variable is 10000 milliseconds.\n\
    \   MaxDelayBeforeNewBCEAssign\n      This variable specifies the amount of time\
    \ in milliseconds the\n      local mobility anchor MUST wait for the de-registration\
    \ message\n      for an existing mobility session before it decides to create\
    \ a new\n      mobility session.\n      The default value for this variable is\
    \ 1500 milliseconds.\n      Note that there is a dependency between this value\
    \ and the values\n      used in the retransmission algorithm for Proxy Binding\
    \ Updates.\n      The retransmissions need to happen before\n      MaxDelayBeforeNewBCEAssign\
    \ runs out, as otherwise there are\n      situations where a de-registration from\
    \ a previous mobile access\n      gateway may be lost, and the local mobility\
    \ anchor creates,\n      needlessly, a new mobility session and new prefixes for\
    \ the mobile\n      node.  However, this affects situations where there is no\n\
    \      information from the lower layers about the type of a handoff or\n    \
    \  other parameters that can be used for identifying the mobility\n      session.\n\
    \   TimestampValidityWindow\n      This variable specifies the maximum amount\
    \ of time difference in\n      milliseconds between the timestamp in the received\
    \ Proxy Binding\n      Update message and the current time of day on the local\
    \ mobility\n      anchor, that is allowed by the local mobility anchor for the\n\
    \      received message to be considered valid.\n      The default value for this\
    \ variable is 300 milliseconds.  This\n      variable must be adjusted to suit\
    \ the deployments.\n"
- title: 9.2.  Mobile Access Gateway - Configuration Variables
  contents:
  - "9.2.  Mobile Access Gateway - Configuration Variables\n   The mobile access gateway\
    \ MUST allow the following variables to be\n   configured by the system management.\
    \  The configured values for these\n   protocol variables MUST survive server\
    \ reboots and service restarts.\n   EnableMAGLocalRouting\n      This flag indicates\
    \ whether or not the mobile access gateway is\n      allowed to enable local routing\
    \ of the traffic exchanged between a\n      visiting mobile node and a correspondent\
    \ node that is locally\n      connected to one of the interfaces of the mobile\
    \ access gateway.\n      The correspondent node can be another visiting mobile\
    \ node as\n      well, or a local fixed node.\n      The default value for this\
    \ flag is set to a value of 0, indicating\n      that the mobile access gateway\
    \ MUST reverse tunnel all the traffic\n      to the mobile node's local mobility\
    \ anchor.\n      When the value of this flag is set to a value of 1, the mobile\n\
    \      access gateway MUST route the traffic locally.\n      This aspect of local\
    \ routing MAY be defined as policy on a per\n      mobile basis and when present\
    \ will take precedence over this flag.\n"
- title: 9.3.  Proxy Mobile IPv6 Domain - Configuration Variables
  contents:
  - "9.3.  Proxy Mobile IPv6 Domain - Configuration Variables\n   All the mobile entities\
    \ (local mobility anchors and mobile access\n   gateways) in a Proxy Mobile IPv6\
    \ domain MUST allow the following\n   variables to be configured by the system\
    \ management.  The configured\n   values for these protocol variables MUST survive\
    \ server reboots and\n   service restarts.  These variables MUST be globally fixed\
    \ for a given\n   Proxy Mobile IPv6 domain resulting in the same values being\
    \ enforced\n   on all the mobility entities in that domain.\n   TimestampBasedApproachInUse\n\
    \      This flag indicates whether or not the timestamp-based approach\n     \
    \ for message ordering is in use in that Proxy Mobile IPv6 domain.\n      When\
    \ the value for this flag is set to 1, all the mobile access\n      gateways in\
    \ that Proxy Mobile IPv6 domain MUST apply the\n      timestamp-based considerations\
    \ listed in Section 5.5.  When the\n      value of this flag is set to 0, sequence-number-based\n\
    \      considerations listed in Section 5.5 MUST be applied.  The default\n  \
    \    value for this flag is set to value of 1, indicating that the\n      timestamp-based\
    \ mechanism is in use in that Proxy Mobile IPv6\n      domain.\n   MobileNodeGeneratedTimestampInUse\n\
    \      This flag indicates whether or not the mobile-node-generated\n      timestamp\
    \ approach is in use in that Proxy Mobile IPv6 domain.\n      When the value for\
    \ this flag is set to 1, the local mobility\n      anchors and mobile access gateways\
    \ in that Proxy Mobile IPv6\n      domain MUST apply the mobile node generated\
    \ timestamp\n      considerations as specified in Section 5.5.\n      This flag\
    \ is relevant only when timestamp-based approach is in\n      use.  The value\
    \ for this flag MUST NOT be set to value of 1, if\n      the value of the TimestampBasedApproachInUse\
    \ flag is set to 0.\n      The default value for this flag is set to value of\
    \ 0, indicating\n      that the mobile node generated timestamp mechanism is not\
    \ in use\n      in that Proxy Mobile IPv6 domain.\n   FixedMAGLinkLocalAddressOnAllAccessLinks\n\
    \      This variable indicates the link-local address value that all the\n   \
    \   mobile access gateways SHOULD use on any of the access links\n      shared\
    \ with any of the mobile nodes in that Proxy Mobile IPv6\n      domain.  If this\
    \ variable is initialized to ALL_ZERO value, it\n      implies the use of fixed\
    \ link-local address mode is not enabled\n      for that Proxy Mobile IPv6 domain.\n\
    \   FixedMAGLinkLayerAddressOnAllAccessLinks\n      This variable indicates the\
    \ link-layer address value that all the\n      mobile access gateways SHOULD use\
    \ on any of the access links\n      shared with any of the mobile nodes in that\
    \ Proxy Mobile IPv6\n      domain.  For access technologies where there is no\
    \ link-layer\n      address, this variable MUST be initialized to ALL_ZERO value.\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document defines six new Mobility Header options,\
    \ the Home\n   Network Prefix Option, Handoff Indicator Option, Access Technology\n\
    \   Type Option, Mobile Node Link-layer Identifier Option, Link-local\n   Address\
    \ Option, and Timestamp Option.  These options are described in\n   Section 8.\
    \  The Type value for these options has been assigned from\n   the same numbering\
    \ space as allocated for the other mobility options,\n   as defined in [RFC3775].\n\
    \   The Handoff Indicator Option, defined in Section 8.4 of this\n   document,\
    \ introduces a new Handoff Indicator (HI) numbering space,\n   where the values\
    \ from 0 to 5 have been reserved by this document.\n   Approval of new Handoff\
    \ Indicator type values are to be made through\n   IANA Expert Review.\n   The\
    \ Access Technology Type Option, defined in Section 8.5 of this\n   document,\
    \ introduces a new Access Technology type (ATT) numbering\n   space, where the\
    \ values from 0 to 5 have been reserved by this\n   document.  Approval of new\
    \ Access Technology type values are to be\n   made through IANA Expert Review.\n\
    \   This document also defines new Binding Acknowledgement status values,\n  \
    \ as described in Section 8.9.  The status values MUST be assigned from\n   the\
    \ same number space used for Binding Acknowledgement status values,\n   as defined\
    \ in [RFC3775].  The allocated values for each of these\n   status values must\
    \ be greater than 128.\n   This document creates a new registry for the flags\
    \ in the Binding\n   Update message called the \"Binding Update Flags\".\n   The\
    \ following flags are reserved:\n      (A) 0x8000 [RFC3775]\n      (H) 0x4000\
    \ [RFC3775]\n      (L) 0x2000 [RFC3775]\n      (K) 0x1000 [RFC3775]\n      (M)\
    \ 0x0800 [RFC4140]\n      (R) 0x0400 [RFC3963]\n   This document reserves a new\
    \ flag (P) as follows:\n      (P) 0x0200\n   The rest of the values in the 16-bit\
    \ field are reserved.  New values\n   can be assigned by Standards Action or IESG\
    \ approval.\n   This document also creates a new registry for the flags in the\n\
    \   Binding Acknowledgment message called the \"Binding Acknowledgment\n   Flags\"\
    .  The following values are reserved.\n      (K) 0x80 [RFC3775]\n      (R) 0x40\
    \ [RFC3963]\n   This document reserves a new flag (P) as follows:\n      (P) 0x20\n\
    \   The rest of the values in the 8-bit field are reserved.  New values\n   can\
    \ be assigned by Standards Action or IESG approval.\n"
- title: 11.  Security Considerations
  contents:
  - "11.  Security Considerations\n   The potential security threats against any network-based\
    \ mobility\n   management protocol are described in [RFC4832].  This section\n\
    \   explains how Proxy Mobile IPv6 protocol defends itself against those\n   threats.\n\
    \   Proxy Mobile IPv6 protocol recommends the signaling messages, Proxy\n   Binding\
    \ Update and Proxy Binding Acknowledgement, exchanged between\n   the mobile access\
    \ gateway and the local mobility anchor to be\n   protected using IPsec using\
    \ the established security association\n   between them.  This essentially eliminates\
    \ the threats related to the\n   impersonation of the mobile access gateway or\
    \ the local mobility\n   anchor.\n   This specification allows a mobile access\
    \ gateway to send binding\n   registration messages on behalf of a mobile node.\
    \  If proper\n   authorization checks are not in place, a malicious node may be\
    \ able\n   to hijack a mobile node's mobility session or may carry out a denial-\n\
    \   of-service attack.  To prevent this attack, this specification\n   requires\
    \ the local mobility anchor to allow only authorized mobile\n   access gateways\
    \ that are part of that Proxy Mobile IPv6 domain to\n   send Proxy Binding Update\
    \ messages on behalf of a mobile node.\n   To eliminate the threats on the interface\
    \ between the mobile access\n   gateway and the mobile node, this specification\
    \ requires an\n   established trust between the mobile access gateway and the\
    \ mobile\n   node and to authenticate and authorize the mobile node before it\
    \ is\n   allowed to access the network.  Further, the established\n   authentication\
    \ mechanisms enabled on that access link will ensure\n   that there is a secure\
    \ binding between the mobile node's identity and\n   its link-layer address. \
    \ The mobile access gateway will definitively\n   identify the mobile node from\
    \ the packets that it receives on that\n   access link.\n   To address the threat\
    \ related to a compromised mobile access gateway,\n   the local mobility anchor,\
    \ before accepting a Proxy Binding Update\n   message for a given mobile node,\
    \ may ensure that the mobile node is\n   attached to the mobile access gateway\
    \ that sent the Proxy Binding\n   Update message.  This may be accomplished by\
    \ contacting a trusted\n   entity, which is able to track the mobile node's current\
    \ point of\n   attachment.  However, the specific details of the actual mechanisms\n\
    \   for achieving this is outside the scope of this document.\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   The authors would like to specially thank Jari Arkko,\
    \ Julien\n   Laganier, Christian Vogt, Dave Thaler, Pasi Eronen, Pete McCann,\n\
    \   Brian Haley, Ahmad Muhanna, JinHyeock Choi, and Elwyn Davies for\n   their\
    \ thorough reviews of this document.\n   The authors would also like to thank\
    \ Alex Petrescu, Alice Qinxia,\n   Alper Yegin, Ashutosh Dutta, Behcet Sarikaya,\
    \ Charles Perkins,\n   Domagoj Premec, Fred Templin, Genadi Velev, George Tsirtsis,\
    \ Gerardo\n   Giaretta, Henrik Levkowetz, Hesham Soliman, James Kempf, Jean-Michel\n\
    \   Combes, John Jason Brzozowski, Jun Awano, John Zhao, Jong-Hyouk Lee,\n   Jonne\
    \ Soininen, Jouni Korhonen, Kalin Getov, Kilian Weniger, Lars\n   Eggert, Magnus\
    \ Westerlund, Marco Liebsch, Mohamed Khalil, Nishida\n   Katsutoshi, Pierrick\
    \ Seite, Phil Roberts, Ralph Droms, Ryuji\n   Wakikawa, Sangjin Jeong, Suresh\
    \ Krishnan, Tero Kauppinen, Uri\n   Blumenthal, Ved Kafle, Vidya Narayanan, Youn-Hee\
    \ Han, and many others\n   for their passionate discussions in the working group\
    \ mailing list on\n   the topic of localized mobility management solutions.  These\n\
    \   discussions stimulated much of the thinking and shaped the document\n   to\
    \ the current form and we acknowledge that!\n   The authors would also like to\
    \ thank Ole Troan, Akiko Hattori, Parviz\n   Yegani, Mark Grayson, Michael Hammer,\
    \ Vojislav Vucetic, Jay Iyer, Tim\n   Stammers, Bernie Volz, and Josh Littlefield\
    \ for their input on this\n   document.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [RFC2119]     Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                 Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC2473]     Conta, A. and S. Deering, \"Generic Packet Tunneling\
    \ in\n                 IPv6 Specification\", RFC 2473, December 1998.\n   [RFC3168]\
    \     Ramakrishnan, K., Floyd, S., and D. Black, \"The\n                 Addition\
    \ of Explicit Congestion Notification (ECN) to\n                 IP\", RFC 3168,\
    \ September 2001.\n   [RFC3315]     Droms, R., Bound, J., Volz, B., Lemon, T.,\
    \ Perkins, C.,\n                 and M. Carney, \"Dynamic Host Configuration Protocol\
    \ for\n                 IPv6 (DHCPv6)\", RFC 3315, July 2003.\n   [RFC3775]  \
    \   Johnson, D., Perkins, C., and J. Arkko, \"Mobility\n                 Support\
    \ in IPv6\", RFC 3775, June 2004.\n   [RFC4282]     Aboba, B., Beadles, M., Arkko,\
    \ J., and P. Eronen, \"The\n                 Network Access Identifier\", RFC\
    \ 4282, December 2005.\n   [RFC4283]     Patel, A., Leung, K., Khalil, M., Akhtar,\
    \ H., and K.\n                 Chowdhury, \"Mobile Node Identifier Option for\
    \ Mobile\n                 IPv6 (MIPv6)\", RFC 4283, November 2005.\n   [RFC4291]\
    \     Hinden, R. and S. Deering, \"IP Version 6 Addressing\n                 Architecture\"\
    , RFC 4291, February 2006.\n   [RFC4301]     Kent, S. and K. Seo, \"Security Architecture\
    \ for the\n                 Internet Protocol\", RFC 4301, December 2005.\n  \
    \ [RFC4303]     Kent, S., \"IP Encapsulating Security Payload (ESP)\",\n     \
    \            RFC 4303, December 2005.\n   [RFC4861]     Narten, T., Nordmark,\
    \ E., Simpson, W., and H. Soliman,\n                 \"Neighbor Discovery for\
    \ IP version 6 (IPv6)\", RFC 4861,\n                 September 2007.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [RFC1981]     McCann, J., Deering, S., and\
    \ J. Mogul, \"Path MTU\n                 Discovery for IP version 6\", RFC 1981,\
    \ August 1996.\n   [RFC2865]     Rigney, C., Willens, S., Rubens, A., and W. Simpson,\n\
    \                 \"Remote Authentication Dial In User Service (RADIUS)\",\n \
    \                RFC 2865, June 2000.\n   [RFC3588]     Calhoun, P., Loughney,\
    \ J., Guttman, E., Zorn, G., and\n                 J. Arkko, \"Diameter Base Protocol\"\
    , RFC 3588,\n                 September 2003.\n   [RFC3963]     Devarapalli, V.,\
    \ Wakikawa, R., Petrescu, A., and P.\n                 Thubert, \"Network Mobility\
    \ (NEMO) Basic Support\n                 Protocol\", RFC 3963, January 2005.\n\
    \   [RFC3971]     Arkko, J., Kempf, J., Zill, B., and P. Nikander,\n         \
    \        \"SEcure Neighbor Discovery (SEND)\", RFC 3971,\n                 March\
    \ 2005.\n   [RFC4140]     Soliman, H., Castelluccia, C., El Malki, K., and L.\n\
    \                 Bellier, \"Hierarchical Mobile IPv6 Mobility Management\n  \
    \               (HMIPv6)\", RFC 4140, August 2005.\n   [RFC4306]     Kaufman,\
    \ C., \"Internet Key Exchange (IKEv2) Protocol\",\n                 RFC 4306,\
    \ December 2005.\n   [RFC4330]     Mills, D., \"Simple Network Time Protocol (SNTP)\
    \ Version\n                 4 for IPv4, IPv6 and OSI\", RFC 4330, January 2006.\n\
    \   [RFC4372]     Adrangi, F., Lior, A., Korhonen, J., and J. Loughney,\n    \
    \             \"Chargeable User Identity\", RFC 4372, January 2006.\n   [RFC4821]\
    \     Mathis, M. and J. Heffner, \"Packetization Layer Path\n                \
    \ MTU Discovery\", RFC 4821, March 2007.\n   [RFC4830]     Kempf, J., \"Problem\
    \ Statement for Network-Based\n                 Localized Mobility Management\
    \ (NETLMM)\", RFC 4830,\n                 April 2007.\n   [RFC4831]     Kempf,\
    \ J., \"Goals for Network-Based Localized Mobility\n                 Management\
    \ (NETLMM)\", RFC 4831, April 2007.\n   [RFC4832]     Vogt, C. and J. Kempf, \"\
    Security Threats to Network-\n                 Based Localized Mobility Management\
    \ (NETLMM)\",\n                 RFC 4832, April 2007.\n   [RFC4862]     Thomson,\
    \ S., Narten, T., and T. Jinmei, \"IPv6 Stateless\n                 Address Autoconfiguration\"\
    , RFC 4862, September 2007.\n   [RFC4941]     Narten, T., Draves, R., and S. Krishnan,\
    \ \"Privacy\n                 Extensions for Stateless Address Autoconfiguration\
    \ in\n                 IPv6\", RFC 4941, September 2007.\n   [RFC5094]     Devarapalli,\
    \ V., Patel, A., and K. Leung, \"Mobile IPv6\n                 Vendor Specific\
    \ Option\", RFC 5094, December 2007.\n   [IPV4-PMIP6]  Wakikawa, R. and S. Gundavelli,\
    \ \"IPv4 Support for Proxy\n                 Mobile IPv6\", Work in Progress,\
    \ May 2008.\n   [DNAV6]       Narayanan, S., Ed., \"Detecting Network Attachment\
    \ in\n                 IPv6 Networks (DNAv6)\", Work in Progress,\n          \
    \       February 2008.\n"
- title: Appendix A.  Proxy Mobile IPv6 Interactions with AAA Infrastructure
  contents:
  - "Appendix A.  Proxy Mobile IPv6 Interactions with AAA Infrastructure\n   Every\
    \ mobile node that roams in a proxy Mobile IPv6 domain would\n   typically be\
    \ identified by an identifier, MN-Identifier, and that\n   identifier will have\
    \ an associated policy profile that identifies the\n   mobile node's home network\
    \ prefix(es) on a per-interface basis,\n   permitted address configuration modes,\
    \ roaming policy, and other\n   parameters that are essential for providing network-based\
    \ mobility\n   management service.  This information is typically configured in\
    \ AAA.\n   In some cases, the home network prefix(es) may be dynamically\n   assigned\
    \ to the mobile node's interface, after its initial attachment\n   to the Proxy\
    \ Mobile IPv6 domain over that interface and may not be\n   configured in the\
    \ mobile node's policy profile.\n   The network entities in the proxy Mobile IPv6\
    \ domain, while serving a\n   mobile node, will have access to the mobile node's\
    \ policy profile and\n   these entities can query this information using RADIUS\
    \ [RFC2865] or\n   DIAMETER [RFC3588] protocols.\n"
- title: Appendix B.  Routing State
  contents:
  - "Appendix B.  Routing State\n   The following section explains the routing state\
    \ created for a mobile\n   node on the mobile access gateway.  This routing state\
    \ reflects only\n   one specific way of implementation, and one MAY choose to\
    \ implement\n   it in other ways.  The policy based route defined below acts as\
    \ a\n   traffic selection rule for routing a mobile node's traffic through a\n\
    \   specific tunnel created between the mobile access gateway and that\n   mobile\
    \ node's local mobility anchor and with the specific\n   encapsulation mode, as\
    \ negotiated.\n   The below example identifies the routing state for two visiting\n\
    \   mobile nodes, MN1 and MN2, with their respective local mobility\n   anchors,\
    \ LMA1 and LMA2.\n   For all traffic from the mobile node, identified by the mobile\
    \ node's\n   MAC address, ingress interface or source prefix (MN-HNP) to\n   _ANY_DESTINATION_\
    \ route via interface tunnel0, next-hop LMAA.\n   +==================================================================+\n\
    \   |  Packet Source    | Destination Address  | Destination Interface |\n   +==================================================================+\n\
    \   | MAC_Address_MN1,  | _ANY_DESTINATION_    |     Tunnel0           |\n   |\
    \ (IPv6 Prefix or   |----------------------------------------------|\n   |  Input\
    \ Interface) | Locally Connected    |     Tunnel0           |\n   +------------------------------------------------------------------+\n\
    \   | MAC_Address_MN2,  | _ANY_DESTINATION_    |     Tunnel1           |\n   +\
    \ (IPv6 Prefix or   -----------------------------------------------|\n   |  Input\
    \ Interface  | Locally Connected    |     direct            |\n   +------------------------------------------------------------------+\n\
    \                    Example - Policy-Based Route Table\n   +==================================================================+\n\
    \   | Interface | Source Address | Destination Address | Encapsulation |\n   +==================================================================+\n\
    \   | Tunnel0   |   Proxy-CoA    |        LMAA1         | IPv6-in-IPv6 |\n   +------------------------------------------------------------------+\n\
    \   | Tunnel1   |   Proxy-CoA    |        LMAA2         | IPv6-in-IPv6 |\n   +------------------------------------------------------------------+\n\
    \                     Example - Tunnel Interface Table\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Sri Gundavelli (editor)\n   Cisco\n   170 West Tasman\
    \ Drive\n   San Jose, CA  95134\n   USA\n   EMail: sgundave@cisco.com\n   Kent\
    \ Leung\n   Cisco\n   170 West Tasman Drive\n   San Jose, CA  95134\n   USA\n\
    \   EMail: kleung@cisco.com\n   Vijay Devarapalli\n   Wichorus\n   3590 North\
    \ First Street\n   San Jose, CA  95134\n   USA\n   EMail: vijay@wichorus.com\n\
    \   Kuntal Chowdhury\n   Starent Networks\n   30 International Place\n   Tewksbury,\
    \ MA\n   EMail: kchowdhury@starentnetworks.com\n   Basavaraj Patil\n   Nokia\n\
    \   6000 Connection Drive\n   Irving, TX  75039\n   USA\n   EMail: basavaraj.patil@nokia.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2008).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
