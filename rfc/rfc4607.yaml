- title: __initial_text__
  contents:
  - '                    Source-Specific Multicast for IP

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: Abstract
  contents:
  - "Abstract\n   IP version 4 (IPv4) addresses in the 232/8 (232.0.0.0 to\n   232.255.255.255)\
    \ range are designated as source-specific multicast\n   (SSM) destination addresses\
    \ and are reserved for use by source-\n   specific applications and protocols.\
    \  For IP version 6 (IPv6), the\n   address prefix FF3x::/32 is reserved for source-specific\
    \ multicast\n   use.  This document defines an extension to the Internet network\n\
    \   service that applies to datagrams sent to SSM addresses and defines\n   the\
    \ host and router requirements to support this extension.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Semantics of Source-Specific Multicast Addresses ................5\n  \
    \ 3. Terminology .....................................................6\n   4.\
    \ Host Requirements ...............................................7\n      4.1.\
    \ Extensions to the IP Module Interface ......................7\n      4.2. Requirements\
    \ on the Host IP Module .........................8\n      4.3. Allocation of Source-Specific\
    \ Multicast Addresses ..........9\n   5. Router Requirements ............................................10\n\
    \      5.1. Packet Forwarding .........................................10\n  \
    \    5.2. Protocols .................................................10\n   6.\
    \ Link-Layer Transmission of Datagrams ...........................11\n   7. Security\
    \ Considerations ........................................12\n      7.1. IPsec\
    \ and SSM .............................................12\n      7.2. SSM and\
    \ RFC 2401 IPsec Caveats ............................12\n      7.3. Denial of\
    \ Service .........................................13\n      7.4. Spoofed Source\
    \ Addresses ..................................13\n      7.5. Administrative Scoping\
    \ ....................................14\n   8. Transition Considerations ......................................14\n\
    \   9. IANA Considerations ............................................15\n  \
    \ 10. Acknowledgements ..............................................15\n   11.\
    \ Normative References ..........................................16\n   12. Informative\
    \ References ........................................17\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The Internet Protocol (IP) multicast service model is defined\
    \ in RFC\n   1112 [RFC1112].  RFC 1112 specifies that a datagram sent to an IP\n\
    \   multicast address (224.0.0.0 through 239.255.255.255) G is delivered\n   to\
    \ each \"upper-layer protocol module\" that has requested reception of\n   datagrams\
    \ sent to address G.  RFC 1112 calls the network service\n   identified by a multicast\
    \ destination address G a \"host group\".  This\n   model supports both one-to-many\
    \ and many-to-many group communication.\n   This document uses the term \"Any-Source\
    \ Multicast\" (ASM) to refer to\n   model of multicast defined in RFC 1112.  RFC\
    \ 3513 [RFC3513] specifies\n   the form of IPv6 multicast addresses with ASM semantics.\n\
    \   IPv4 addresses in the 232/8 (232.0.0.0 to 232.255.255.255) range are\n   currently\
    \ designated as source-specific multicast (SSM) destination\n   addresses and\
    \ are reserved for use by source-specific applications\n   and protocols [IANA-ALLOC].\n\
    \   For IPv6, the address prefix FF3x::/32 is reserved for source-\n   specific\
    \ multicast use, where 'x' is any valid scope identifier, by\n   [IPv6-UBM]. \
    \ Using the terminology of [IPv6-UBM], all SSM addresses\n   must have P=1, T=1,\
    \ and plen=0.  [IPv6-MALLOC] mandates that the\n   network prefix field of an\
    \ SSM address also be set to zero, hence all\n   SSM addresses fall in the FF3x::/96\
    \ range.  Future documents may\n   allow a non-zero network prefix field if, for\
    \ instance, a new IP-\n   address-to-MAC-address mapping is defined.  Thus, address\
    \ allocation\n   should occur within the FF3x::/96 range, but a system should\
    \ treat\n   all of FF3x::/32 as SSM addresses, to allow for compatibility with\n\
    \   possible future uses of the network prefix field.\n   Addresses in the range\
    \ FF3x::4000:0001 through FF3x::7FFF:FFFF are\n   reserved in [IPv6-MALLOC] for\
    \ allocation by IANA.  Addresses in the\n   range FF3x::8000:0000 through FF3x::FFFF:FFFF\
    \ are allowed for dynamic\n   allocation by a host, as described in [IPv6-MALLOC].\
    \  Addresses in\n   the range FF3x::0000:0000 through FF3x::3FFF:FFFF are invalid\
    \ IPv6\n   SSM addresses.  ([IPv6-MALLOC] indicates that FF3x::0000:0001 to\n\
    \   FF3x::3FFF:FFFF must set P=0 and T=0, but for SSM, [IPv6-UBM]\n   mandates\
    \ that  P=1 and T=1, hence their designation as invalid.)  The\n   treatment of\
    \ a packet sent to such an invalid address is undefined --\n   a router or host\
    \ MAY choose to drop such a packet.\n   Source-specific multicast delivery semantics\
    \ are provided for a\n   datagram sent to an SSM address.  That is, a datagram\
    \ with source IP\n   address S and SSM destination address G is delivered to each\
    \ upper-\n   layer \"socket\" that has specifically requested the reception of\n\
    \   datagrams sent to address G by source S, and only to those sockets.\n   The\
    \ network service identified by (S,G), for SSM address G and source\n   host address\
    \ S, is referred to as a \"channel\".  In contrast to the\n   ASM model of RFC\
    \ 1112, SSM provides network-layer support for one-\n   to-many delivery only.\n\
    \   The benefits of source-specific multicast include:\n      Elimination of cross-delivery\
    \ of traffic when two sources\n      simultaneously use the same source-specific\
    \ destination address.\n      The simultaneous use of an SSM destination address\
    \ by multiple\n      sources and different applications is explicitly supported.\n\
    \      Avoidance of the need for inter-host coordination when choosing\n     \
    \ source-specific addresses, as a consequence of the above.\n      Avoidance of\
    \ many of the router protocols and algorithms that are\n      needed to provide\
    \ the ASM service model.  For instance, the\n      \"shared trees\" and Rendezvous\
    \ Points of the PIM - Sparse Mode\n      (PIM-SM) protocol [PIM-SM] are not necessary\
    \ to support the\n      source-specific model.  The router mechanisms required\
    \ to support\n      SSM are in fact largely a subset of those that are used to\
    \ support\n      ASM.  For example, the shortest-path tree mechanism of the PIM-SM\n\
    \      protocol can be adapted to provide SSM semantics.\n   Like ASM, the set\
    \ of receivers is unknown to an SSM sender.  An SSM\n   source is provided with\
    \ neither the identity of receivers nor their\n   number.\n   SSM is particularly\
    \ well-suited to dissemination-style applications\n   with one or more senders\
    \ whose identities are known before the\n   application begins.  For instance,\
    \ a data dissemination application\n   that desires to provide a secondary data\
    \ source in case the primary\n   source fails over might implement this by using\
    \ one channel for each\n   source and advertising both of them to receivers. \
    \ SSM can be used to\n   build multi-source applications where all participants'\
    \ identities\n   are not known in advance, but the multi-source \"rendezvous\"\
    \n   functionality does not occur in the network layer in this case.  Just\n \
    \  like in an application that uses unicast as the underlying transport,\n   this\
    \ functionality can be implemented by the application or by an\n   application-layer\
    \ library.\n   Multicast resource discovery of the form in which a client sends\
    \ a\n   multicast query directly to a \"service location group\" to which\n  \
    \ servers listen is not directly supported by SSM.\n   The key words \"MUST\"\
    , \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD\
    \ NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to\
    \ be interpreted as described in RFC 2119 [RFC2119].\n   This document defines\
    \ the semantics of source-specific multicast\n   addresses and specifies the policies\
    \ governing their use.  In\n   particular, it defines an extension to the Internet\
    \ network service\n   that applies to datagrams sent to SSM addresses and defines\
    \ host\n   extensions to support the network service.  Hosts, routers,\n   applications,\
    \ and protocols that use these addresses MUST comply with\n   the policies outlined\
    \ in this document.  Failure of a host to comply\n   may prevent that host or\
    \ other hosts on the same LAN from receiving\n   traffic sent to an SSM channel.\
    \  Failure of a router to comply may\n   cause SSM traffic to be delivered to\
    \ parts of the network where it is\n   unwanted, unnecessarily burdening the network.\n"
- title: 2.  Semantics of Source-Specific Multicast Addresses
  contents:
  - "2.  Semantics of Source-Specific Multicast Addresses\n   The source-specific\
    \ multicast service is defined as follows:\n      A datagram sent with source\
    \ IP address S and destination IP\n      address G in the SSM range is delivered\
    \ to each host socket that\n      has specifically requested delivery of datagrams\
    \ sent by S to G,\n      and only to those sockets.\n   Where, using the terminology\
    \ of [IGMPv3],\n      \"socket\" is an implementation-specific parameter used\
    \ to\n      distinguish among different requesting entities (e.g., programs or\n\
    \      processes or communication end-points within a program or process)\n  \
    \    within the requesting host; the socket parameter of BSD Unix\n      system\
    \ calls is a specific example.\n   Any host may send a datagram to any SSM address,\
    \ and delivery is\n   provided according to the above semantics.\n   The IP module\
    \ interface to upper-layer protocols is extended to allow\n   a socket to \"Subscribe\"\
    \ to or \"Unsubscribe\" from a particular channel\n   identified by an SSM destination\
    \ address and a source IP address.\n   The extended interface is defined in Section\
    \ 4.1.  It is meaningless\n   for an application or host to request reception\
    \ of datagrams sent to\n   an SSM destination address G, as is supported in the\
    \ any-source\n   multicast model, without also specifying a corresponding source\n\
    \   address, and routers MUST ignore any such request.\n   Multiple source applications\
    \ on different hosts can use the same SSM\n   destination address G without conflict\
    \ because datagrams sent by each\n   source host Si are delivered only to those\
    \ sockets that requested\n   delivery of datagrams sent to G specifically by Si.\n\
    \   The key distinguishing property of the model is that a channel is\n   identified\
    \ (addressed) by the combination of a unicast source address\n   and a multicast\
    \ destination address in the SSM range.  So, for\n   example, the channel\n  \
    \    S,G = (192.0.2.1, 232.7.8.9)\n   differs from\n      S,G = (192.0.2.2, 232.7.8.9),\n\
    \   even though they have the same destination address portion.\n   Similarly,\
    \ for IPv6,\n      S,G = (2001:3618::1, FF33::1234)\n   and\n      S,G = (2001:3618::2,\
    \ FF33::1234)\n   are different channels.\n"
- title: 3.  Terminology
  contents:
  - "3.  Terminology\n   To reduce confusion when talking about the any-source and\
    \ source-\n   specific multicast models, we use different terminology when\n \
    \  discussing them.\n   We use the term \"channel\" to refer to the service associated\
    \ with an\n   SSM address.  A channel is identified by the combination of an SSM\n\
    \   destination address and a specific source, e.g., an (S,G) pair.\n   We use\
    \ the term \"host group\" (used in RFC 1112) to refer to the\n   service associated\
    \ with \"regular\" ASM multicast addresses (excluding\n   those in the SSM range).\
    \  A host group is identified by a single\n   multicast address.\n   Any host\
    \ can send to a host group, and similarly, any host can send\n   to an SSM destination\
    \ address.  A packet sent by a host S to an ASM\n   destination address G is delivered\
    \ to the host group identified by G.\n   A packet sent by host S to an SSM destination\
    \ address G is delivered\n   to the channel identified by (S,G).  The receiver\
    \ operations allowed\n   on a host group are called \"join(G)\" and \"leave(G)\"\
    \ (as per RFC\n   1112).  The receiver operations allowed on a channel are called\n\
    \   \"Subscribe(S,G)\" and \"Unsubscribe(S,G)\".\n   The following table summarizes\
    \ the terminology:\n      Service Model:        any-source          source-specific\n\
    \      Network Abstraction:  group               channel\n      Identifier:  \
    \         G                   S,G\n      Receiver Operations:  Join, Leave   \
    \      Subscribe, Unsubscribe\n   We note that, although this document specifies\
    \ a new service model\n   available to applications, the protocols and techniques\
    \ necessary to\n   support the service model are largely a subset of those used\
    \ to\n   support ASM.\n"
- title: 4.  Host Requirements
  contents:
  - "4.  Host Requirements\n   This section describes requirements on hosts that support\
    \ source-\n   specific multicast, including:\n      - Extensions to the IP Module\
    \ Interface\n      - Extensions to the IP Module\n      - Allocation of SSM Addresses\n"
- title: 4.1.  Extensions to the IP Module Interface
  contents:
  - "4.1.  Extensions to the IP Module Interface\n   The IP module interface to upper-layer\
    \ protocols is extended to allow\n   protocols to request reception of all datagrams\
    \ sent to a particular\n   channel.\n      Subscribe ( socket, source-address,\
    \ group-address, interface )\n      Unsubscribe ( socket, source-address, group-address,\
    \ interface )\n   where\n      \"socket\" is as previously defined in Section\
    \ 2,\n   and, paraphrasing [IGMPv3],\n      \"interface\" is a local identifier\
    \ of the network interface on\n      which reception of the channel identified\
    \ by the (source-\n      address,group-address) pair is to be enabled or disabled.\
    \  A\n      special value may be used to indicate a \"default\" interface.  If\n\
    \      reception of the same channel is desired on multiple interfaces,\n    \
    \  Subscribe is invoked once for each.\n   The above are strictly abstract functional\
    \ interfaces -- the\n   functionality can be provided in an implementation-specific\
    \ way.  On\n   a host that supports the multicast source filtering application\n\
    \   programming interface of [MSFAPI], for instance, the Subscribe and\n   Unsubscribe\
    \ interfaces may be supported via that API.  When a host\n   has been configured\
    \ to know the SSM address range (whether the\n   configuration mechanism is manual\
    \ or through a protocol), the host's\n   operating system SHOULD return an error\
    \ to an application that makes\n   a non-source-specific request to receive multicast\
    \ sent to an SSM\n   destination address.\n   A host that does not support these\
    \ IP module interfaces (e.g., ASM-\n   only hosts) and their underlying protocols\
    \ cannot expect to reliably\n   receive traffic sent on an SSM channel.  As specified\
    \ below in\n   Section 5.2, routers will not set up SSM forwarding state or forward\n\
    \   datagrams in response to an ASM join request.\n   Widespread implementations\
    \ of the IP packet reception interface\n   (e.g., the recvfrom() system call in\
    \ BSD Unix) do not allow a\n   receiver to determine the destination address to\
    \ which a datagram was\n   sent.  On a host with such an implementation, the destination\
    \ address\n   of a datagram cannot be inferred when the socket on which the\n\
    \   datagram is received is Subscribed to multiple channels.  Host\n   operating\
    \ systems SHOULD provide a way for a host to determine both\n   the source and\
    \ the destination address to which a datagram was sent.\n   (As one example, the\
    \ Linux operating system provides the destination\n   of a packet as part of the\
    \ response to the recvmsg() system call.)\n   Until this capability is present,\
    \ applications may be forced to use\n   higher-layer mechanisms to identify the\
    \ channel to which a datagram\n   was sent.\n"
- title: 4.2.  Requirements on the Host IP Module
  contents:
  - "4.2.  Requirements on the Host IP Module\n   An incoming datagram destined to\
    \ an SSM address MUST be delivered by\n   the IP module to all sockets that have\
    \ indicated (via Subscribe) a\n   desire to receive data that matches the datagram's\
    \ source address,\n   destination address, and arriving interface.  It MUST NOT\
    \ be\n   delivered to other sockets.\n   When the first socket on host H subscribes\
    \ to a channel (S,G) on\n   interface I, the host IP module on H sends a request\
    \ on interface I\n   to indicate to neighboring routers that the host wishes to\
    \ receive\n   traffic sent by source S to source-specific multicast destination\
    \ G.\n   Similarly, when the last socket on a host unsubscribes from a channel\n\
    \   on interface I, the host IP module sends an unsubscription request\n   for\
    \ that channel to interface I.\n   These requests will typically be Internet Group\
    \ Management Protocol\n   version 3 (IGMPv3) messages for IPv4, or Multicast Listener\
    \ Discovery\n   Version 2 (MLDv2) messages for IPv6 [IGMPv3,MLDv2].  A host that\n\
    \   supports the SSM service model MUST implement the host portion of\n   [IGMPv3]\
    \ for IPv4 and [MLDv2] for IPv6.  It MUST also conform to the\n   IGMPv3/MLDv2\
    \ behavior described in [GMP-SSM].\n"
- title: 4.3.  Allocation of Source-Specific Multicast Addresses
  contents:
  - "4.3.  Allocation of Source-Specific Multicast Addresses\n   The SSM destination\
    \ address 232.0.0.0 is reserved, and it must not be\n   used as a destination\
    \ address.  Similarly, FF3x::4000:0000 is also\n   reserved.  The goal of reserving\
    \ these two addresses is to preserve\n   one invalid SSM destination for IPv4\
    \ and IPv6, which can be useful in\n   an implementation as a null value.  The\
    \ address range 232.0.0.1 -\n   232.0.0.255 is currently reserved for allocation\
    \ by IANA.  SSM\n   destination addresses in the range FF3x::4000:0001 through\n\
    \   FF3x::7FFF:FFFF are similarly reserved for IANA allocation\n   [IPv6-MALLOC].\
    \  The motivation to reserve these addresses is outlined\n   below in Section\
    \ 9, \"IANA Considerations\".\n   The policy for allocating the rest of the SSM\
    \ addresses to sending\n   applications is strictly locally determined by the\
    \ sending host.\n   When allocating SSM addresses dynamically, a host or host\
    \ operating\n   system MUST NOT allocate sequentially starting at the first allowed\n\
    \   address.  It is RECOMMENDED to allocate SSM addresses to applications\n  \
    \ randomly, while ensuring that allocated addresses are not given\n   simultaneously\
    \ to multiple applications (and avoiding the reserved\n   addresses).  For IPv6,\
    \ the randomization should apply to the lowest\n   31 bits of the address.\n \
    \  As described in Section 6, the mapping of an IP packet with SSM\n   destination\
    \ address onto a link-layer multicast address does not take\n   into account the\
    \ datagram's source IP address (on commonly-used link\n   layers like Ethernet).\
    \  If all hosts started at the first allowed\n   address, then with high probability,\
    \ many source-specific channels on\n   shared-medium local area networks would\
    \ use the same link-layer\n   multicast address.  As a result, traffic destined\
    \ for one channel\n   subscriber would be delivered to another's IP module, which\
    \ would\n   then have to discard the datagram.\n   A host operating system SHOULD\
    \ provide an interface to allow an\n   application to request a unique allocation\
    \ of a channel destination\n   address in advance of a session's commencement,\
    \ and this allocation\n   database SHOULD persist across host reboots.  By providing\
    \ persistent\n   allocations, a host application can advertise the session in\
    \ advance\n   of its start time on a web page or in another directory.  (We note\n\
    \   that this issue is not specific to SSM applications -- the same\n   problem\
    \ arises for ASM.)\n   This document neither defines the interfaces for requesting\
    \ or\n   returning addresses nor specifies the host algorithms for storing\n \
    \  those allocations.  One plausible abstract API is defined in RFC 2771\n   [RFC2771].\
    \  Note that RFC 2771 allows an application to request an\n   address within a\
    \ specific range of addresses.  If this interface is\n   used, the starting address\
    \ of the range SHOULD be selected at random\n   by the application.\n   For IPv6,\
    \ administratively scoped SSM channel addresses are created\n   by choosing an\
    \ appropriate scope identifier for the SSM destination\n   address.  Normal IPv6\
    \ multicast scope boundaries [SCOPINGv6] are\n   applied to traffic sent to an\
    \ SSM destination address, including any\n   relevant boundaries applied to both\
    \ the source and destination\n   address.\n   No globally agreed-upon administratively-scoped\
    \ address range\n   [ADMIN-SCOPE] is currently defined for IPv4 source-specific\n\
    \   multicast.  For IPv4, administrative scoping of SSM addresses can be\n   implemented\
    \ within an administrative domain by filtering outgoing SSM\n   traffic sent to\
    \ a scoped address at the domain's boundary routers.\n"
- title: 5.  Router Requirements
  contents:
  - '5.  Router Requirements

    '
- title: 5.1.  Packet Forwarding
  contents:
  - "5.1.  Packet Forwarding\n   A router that receives an IP datagram with a source-specific\n\
    \   destination address MUST silently drop it unless a neighboring host\n   or\
    \ router has communicated a desire to receive packets sent from the\n   source\
    \ and to the destination address of the received packet.\n"
- title: 5.2.  Protocols
  contents:
  - "5.2.  Protocols\n   Certain IP multicast routing protocols already have the ability\
    \ to\n   communicate source-specific joins to neighboring routers (in\n   particular,\
    \ PIM-SM [PIM-SM]), and these protocols can, with slight\n   modifications, be\
    \ used to provide source-specific semantics.  A\n   router that supports the SSM\
    \ service model MUST implement the PIM-SSM\n   subset of the PIM-SM protocol from\
    \ [PIM-SM] and MUST implement the\n   router portion of [IGMPv3] for IPv4 and\
    \ [MLDv2] for IPv6.  An SSM\n   router MUST also conform to the IGMPv3/MLDv2 behavior\
    \ described in\n   [GMP-SSM].\n   With PIM-SSM, successful establishment of an\
    \ (S,G) forwarding path\n   from the source S to any receiver depends on hop-by-hop\
    \ forwarding of\n   the explicit join request from the receiver toward the source.\
    \  The\n   protocol(s) and algorithms that are used to select the forwarding\n\
    \   path for this explicit join must provide a loop-free path.  When\n   using\
    \ PIM-SSM, the PIM-SSM implementation MUST (at least) support the\n   ability\
    \ to use the unicast topology database for this purpose.\n   A network can concurrently\
    \ support SSM in the SSM address range and\n   any-source multicast in the rest\
    \ of the multicast address space, and\n   it is expected that this will be commonplace.\
    \  In such a network, a\n   router may receive a non-source-specific, or \"(*,G)\"\
    \ in conventional\n   terminology, request for delivery of traffic in the SSM\
    \ range from a\n   neighbor that does not implement source-specific multicast\
    \ in a\n   manner compliant with this document.  A router that receives such a\n\
    \   non-source-specific request for data in the SSM range MUST NOT use\n   the\
    \ request to establish forwarding state and MUST NOT propagate the\n   request\
    \ to other neighboring routers.  A router MAY log an error in\n   such a case.\
    \  This applies both to any request received from a host\n   (e.g., an IGMPv1\
    \ or IGMPv2 [IGMPv2] host report) and to any request\n   received from a routing\
    \ protocol (e.g., a PIM-SM (*,G) join).  The\n   inter-router case is further\
    \ discussed in Section 8, \"Transition\n   Considerations\".\n   It is essential\
    \ that all routers in the network give source-specific\n   semantics to the same\
    \ range of addresses in order to achieve the full\n   benefit of SSM.  To comply\
    \ with this specification, a router MUST\n   treat ALL IANA-allocated SSM addresses\
    \ with source-specific\n   semantics.\n"
- title: 6.  Link-Layer Transmission of Datagrams
  contents:
  - "6.  Link-Layer Transmission of Datagrams\n   Source-specific multicast packets\
    \ are transmitted on link-layer\n   networks as specified in RFC 1112 for IPv4\
    \ and as in [ETHERv6] for\n   IPv6.  On most shared-medium link-layer networks\
    \ that support\n   multicast (e.g., Ethernet), the IP source address is not used\
    \ in the\n   selection of the link-layer destination address.  Consequently, on\n\
    \   such a network, all packets sent to destination address G will be\n   delivered\
    \ to any host that has subscribed to any channel (S,G),\n   regardless of S. \
    \ Therefore, the IP module MUST filter packets it\n   receives from the link layer\
    \ before delivering them to the socket\n   layer.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   This section outlines security issues pertaining\
    \ to SSM.  The\n   following topics are addressed: IPsec, denial-of-service attacks,\n\
    \   source spoofing, and security issues related to administrative\n   scoping.\n"
- title: 7.1.  IPsec and SSM
  contents:
  - "7.1.  IPsec and SSM\n   The IPsec Authentication Header (AH) and Encapsulating\
    \ Security\n   Payload (ESP) can be used to secure SSM traffic, if a multicast-\n\
    \   capable implementation of IPsec (as required in [RFC4301]) is used by\n  \
    \ the receivers.\n"
- title: 7.2.  SSM and RFC 2401 IPsec Caveats
  contents:
  - "7.2.  SSM and RFC 2401 IPsec Caveats\n   For existing implementations of RFC\
    \ 2401 IPsec (now superseded by\n   [RFC4301]), there are a few caveats related\
    \ to SSM.  They are listed\n   here.  In RFC 2401 IPsec, the source address is\
    \ not used as part of\n   the key in the SAD lookup.  As a result, two senders\
    \ that happen to\n   use the same SSM destination address and the same Security\
    \ Parameter\n   Index (SPI) will \"collide\" in the SAD at any host that is receiving\n\
    \   both channels.  Because the channel addresses and SPIs are both\n   allocated\
    \ autonomously by the senders, there is no reasonable means\n   to ensure that\
    \ each sender uses a unique destination address or SPI.\n   A problem arises if\
    \ a receiver subscribes simultaneously to two\n   unrelated channels using IPsec\
    \ whose sources happen to be using the\n   same IP destination address (IPDA)\
    \ and the same IPsec SPI.  Because\n   the channel destination addresses are allocated\
    \ autonomously by the\n   senders, any two hosts can simultaneously use the same\
    \ destination\n   address, and there is no reasonable means to ensure that this\
    \ does\n   not happen.  The <IPDA,SPI> tuple, however, consists of 56 bits that\n\
    \   are generally randomly chosen (24 bits of the IP destination and 32\n   bits\
    \ of the SPI), and a conflict is unlikely to occur through random\n   chance.\n\
    \   If such a collision occurs, a receiver will not be able to\n   simultaneously\
    \ receive IPsec-protected traffic from the two colliding\n   sources.  A receiver\
    \ can detect this condition by noticing that it is\n   receiving traffic from\
    \ two different sources with the same SPI and\n   the same SSM destination address.\n"
- title: 7.3.  Denial of Service
  contents:
  - "7.3.  Denial of Service\n   A subscription request creates (S,G) state in a router\
    \ to record the\n   subscription, invokes processing on that router, and possibly\
    \ causes\n   processing at neighboring routers.  A host can mount a denial-of-\n\
    \   service attack by requesting a large number of subscriptions.  Denial\n  \
    \ of service can result if:\n      - a large amount of traffic arrives when it\
    \ was otherwise\n        undesired, consuming network resources to deliver it\
    \ and host\n        resources to drop it;\n      - a large amount of source-specific\
    \ multicast state is created in\n        network routers, using router memory\
    \ and CPU resources to store\n        and process the state; or\n      - a large\
    \ amount of control traffic is generated to manage the\n        source-specific\
    \ state, using router CPU and network bandwidth.\n   To reduce the damage from\
    \ such an attack, a router MAY have\n   configuration options to limit, for example,\
    \ the following items:\n      - The total rate at which all hosts on any one interface\
    \ are\n        allowed to initiate subscriptions (to limit the damage caused by\n\
    \        forged source-address attacks).\n      - The total number of subscriptions\
    \ that can be initiated from any\n        single interface or host.\n   Any decision\
    \ by an implementor to artificially limit the rate or\n   number of subscriptions\
    \ should be taken carefully, however, as future\n   applications may use large\
    \ numbers of channels.  Tight limits on the\n   rate or number of channel subscriptions\
    \ would inhibit the deployment\n   of such applications.\n   A router SHOULD verify\
    \ that the source of a subscription request is a\n   valid address for the interface\
    \ on which it was received.  Failure to\n   do so would exacerbate a spoofed-source\
    \ address attack.\n   We note that these attacks are not unique to SSM -- they\
    \ are also\n   present for any-source multicast.\n"
- title: 7.4.  Spoofed Source Addresses
  contents:
  - "7.4.  Spoofed Source Addresses\n   By forging the source address in a datagram,\
    \ an attacker can\n   potentially violate the SSM service model by transmitting\
    \ datagrams\n   on a channel belonging to another host.  Thus, an application\n\
    \   requiring strong authentication should not assume that all packets\n   that\
    \ arrive on a channel were sent by the requested source without\n   higher-layer\
    \ authentication mechanisms.  The IPSEC Authentication\n   Header [RFC2401, RFC4301]\
    \ may be used to authenticate the source of\n   an SSM transmission, for instance.\n\
    \   Some degree of protection against spoofed source addresses in\n   multicast\
    \ is already fairly widespread, because the commonly deployed\n   IP multicast\
    \ routing protocols [PIM-DM, PIM-SM, DVMRP] incorporate a\n   \"reverse-path forwarding\
    \ check\" that validates that a multicast\n   packet arrived on the expected interface\
    \ for its source address.\n   Routing protocols used for SSM SHOULD incorporate\
    \ such a check.\n   Source Routing [RFC791] (both Loose and Strict) in combination\
    \ with\n   source address spoofing may be used to allow an impostor of the true\n\
    \   channel source to inject packets onto an SSM channel.  An SSM router\n   SHOULD\
    \ by default disallow source routing to an SSM destination\n   address.  A router\
    \ MAY have a configuration option to allow source\n   routing.  Anti-source spoofing\
    \ mechanisms, such as source address\n   filtering at the edges of the network,\
    \ are also strongly encouraged.\n"
- title: 7.5.  Administrative Scoping
  contents:
  - "7.5.  Administrative Scoping\n   Administrative scoping should not be relied\
    \ upon as a security\n   measure [ADMIN-SCOPE]; however, in some cases it is part\
    \ of a\n   security solution.  It should be noted that no administrative scoping\n\
    \   exists for IPv4 source-specific multicast.  An alternative approach\n   is\
    \ to manually configure traffic filters to create such scoping if\n   necessary.\n\
    \   Furthermore, for IPv6, neither source nor destination address scoping\n  \
    \ should be used as a security measure.  In some currently-deployed\n   IPv6 routers\
    \ (those that do not conform to [SCOPINGv6]), scope\n   boundaries are not always\
    \ applied to all source address (for\n   instance, an implementation may filter\
    \ link-local addresses but\n   nothing else).  Such a router may incorrectly forward\
    \ an SSM channel\n   (S,G) through a scope boundary for S.\n"
- title: 8.  Transition Considerations
  contents:
  - "8.  Transition Considerations\n   A host that complies with this document will\
    \ send ONLY source-\n   specific host reports for addresses in the SSM range.\
    \  As stated\n   above, a router that receives a non-source-specific (e.g., IGMPv1\
    \ or\n   IGMPv2 or MLDv1 [RFC2710]) host report for a source-specific\n   multicast\
    \ destination address MUST ignore these reports.  Failure to\n   do so would violate\
    \ the SSM service model promised to the sender:\n   that a packet sent to (S,G)\
    \ would only be delivered to hosts that\n   specifically requested delivery of\
    \ packets sent to G by S.\n   During a transition period, it would be possible\
    \ to deliver SSM\n   datagrams in a domain where the routers do not support SSM\
    \ semantics\n   by simply forwarding any packet destined to G to all hosts that\
    \ have\n   requested subscription of (S,G) for any S.  However, this\n   implementation\
    \ risks unduly burdening the network infrastructure by\n   delivering (S,G) datagrams\
    \ to hosts that did not request them.  Such\n   an implementation for addresses\
    \ in the SSM range is specifically not\n   compliant with Section 5.2 of this\
    \ document.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   IANA allocates IPv4 addresses in the range 232.0.0.1\
    \ through\n   232.0.0.255 and IPv6 addresses in the range FF3x:4000:0001 to\n\
    \   FF3x::7FFF:FFFF.  These addresses are allocated according to IETF\n   Consensus\
    \ [IANA-CONSID].  These address ranges are reserved for\n   services with wide\
    \ applicability that either require that or would\n   strongly benefit if all\
    \ hosts use a well-known SSM destination\n   address for that service.  Any proposal\
    \ for allocation must consider\n   the fact that, on an Ethernet network, all\
    \ datagrams sent to any SSM\n   destination address will be transmitted with the\
    \ same link-layer\n   destination address, regardless of the source.  Furthermore,\
    \ the fact\n   that SSM destinations in 232.0.0.0/24 and 232.128.0.0/24 use the\
    \ same\n   link-layer addresses as the reserved IP multicast group range\n   224.0.0.0/24\
    \ must also be considered.  Similar consideration should\n   be given to the IPv6\
    \ reserved multicast addresses.  232.0.0.0 and\n   FF3x::4000:0000 should not\
    \ be allocated, as suggested above.\n   Except for the aforementioned addresses,\
    \ IANA SHALL NOT allocate any\n   SSM destination address to a particular entity\
    \ or application.  To do\n   so would compromise one of the important benefits\
    \ of the source-\n   specific model: the ability for a host to simply and autonomously\n\
    \   allocate a source-specific multicast address from a large flat\n   address\
    \ space.\n"
- title: 10.  Acknowledgements
  contents:
  - "10.  Acknowledgements\n   The SSM service model draws on a variety of prior work\
    \ on alternative\n   approaches to IP multicast, including the EXPRESS multicast\
    \ model of\n   Holbrook and Cheriton [EXPRESS], Green's [SMRP], and the Simple\n\
    \   Multicast proposal of Perlman, et al. [SIMPLE].  We would also like\n   to\
    \ thank Jon Postel and David Cheriton for their support in\n   reassigning the\
    \ 232/8 address range to SSM.  Brian Haberman\n   contributed to the IPv6 portion\
    \ of this document.  Thanks to Pekka\n   Savola for a careful review.\n"
- title: 11. Normative References
  contents:
  - "11. Normative References\n   [ETHERv6]     Crawford, M., \"Transmission of IPv6\
    \ Packets over\n                 Ethernet Networks\", RFC 2464, December 1998.\n\
    \   [GMP-SSM]     Holbrook, H. and B. Cain, \"Using Internet Group\n         \
    \        Management Protocol Version 3 (IGMPv3) and Multicast\n              \
    \   Listener Discovery Protocol Version 2 (MLDv2) for\n                 Source-Specific\
    \ Multicast\", RFC 4604, August 2006.\n   [IGMPv3]      Cain, B., Deering, S.,\
    \ Kouvelas, I., Fenner, B., and A.\n                 Thyagarajan, \"Internet Group\
    \ Management Protocol,\n                 Version 3\", RFC 3376, October 2002.\n\
    \   [IPv6-UBM]    Haberman, B. and D. Thaler, \"Unicast-Prefix-based IPv6\n  \
    \               Multicast Addresses\", RFC 3306, August 2002.\n   [IPv6-MALLOC]\
    \ Haberman, B., \"Allocation Guidelines for IPv6 Multicast\n                 Addresses\"\
    , RFC 3307, August 2002.\n   [MLDv2]       Vida, R. and L. Costa, \"Multicast\
    \ Listener Discovery\n                 Version 2 (MLDv2) for IPv6\", RFC 3810,\
    \ June 2004.\n   [PIM-SM]      Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas.\n\
    \                 \"Protocol Independent Multicast - Sparse Mode (PIM-SM):\n \
    \                Protocol Specification (Revised)\", RFC 4601, August\n      \
    \           2006.\n   [RFC791]      Postel, J., \"Internet Protocol\", STD 5,\
    \ RFC 791,\n                 September 1981.\n   [RFC1112]     Deering, S., \"\
    Host extensions for IP multicasting\", STD\n                 5, RFC 1112, August\
    \ 1989.\n   [RFC2401]     Kent, S. and R. Atkinson, \"Security Architecture for\n\
    \                 the Internet Protocol\", RFC 2401, November 1998.\n   [RFC3513]\
    \     Hinden, R. and S. Deering, \"Internet Protocol Version 6\n             \
    \    (IPv6) Addressing Architecture\", RFC 3513, April 2003.\n   [RFC4301]   \
    \  Kent, S. and K. Seo, \"Security Architecture for the\n                 Internet\
    \ Protocol\", RFC 4301, December 2005.\n"
- title: 12.  Informative References
  contents:
  - "12.  Informative References\n   [ADMIN-SCOPE] Meyer, D., \"Administratively Scoped\
    \ IP Multicast\", BCP\n                 23, RFC 2365, July 1998.\n   [DVMRP] \
    \      Waitzman, D., Partridge, C., and S. Deering, \"Distance\n             \
    \    Vector Multicast Routing Protocol\", RFC 1075, November\n               \
    \  1988.\n   [EXPRESS]     Holbrook, H., and Cheriton, D.  \"Explicitly Requested\n\
    \                 Source-Specific Multicast: EXPRESS support for Large-\n    \
    \             scale Single-source Applications.\"  Proceedings of ACM\n      \
    \           SIGCOMM '99, Cambridge, MA, September 1999.\n   [IANA-ALLOC]  Internet\
    \ Assigned Numbers Authority,\n                 http://www.iana.org/assignments/multicast-addresses.\n\
    \   [IANA-CONSID] Narten, T. and H. Alvestrand, \"Guidelines for Writing\n   \
    \              an IANA Considerations Section in RFCs\", BCP 26, RFC\n       \
    \          2434, October 1998.\n   [IGMPv2]      Fenner, W., \"Internet Group\
    \ Management Protocol,\n                 Version 2\", RFC 2236, November 1997.\n\
    \   [MSFAPI]      Thaler, D., Fenner, B., and B. Quinn, \"Socket Interface\n \
    \                Extensions for Multicast Source Filters\", RFC 3678,\n      \
    \           January 2004.\n   [PIM-DM]      Adams, A., Nicholas, J., and W. Siadak,\
    \ \"Protocol\n                 Independent Multicast - Dense Mode (PIM-DM): Protocol\n\
    \                 Specification (Revised)\", RFC 3973, January 2005.\n   [RFC2119]\
    \     Bradner, S., \"Key words for use in RFCs to Indicate\n                 Requirement\
    \ Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2710]     Deering, S., Fenner,\
    \ W., and B. Haberman, \"Multicast\n                 Listener Discovery (MLD)\
    \ for IPv6\", RFC 2710, October\n                 1999.\n   [RFC2771]     Finlayson,\
    \ R., \"An Abstract API for Multicast Address\n                 Allocation\",\
    \ RFC 2771, February 2000.\n   [SCOPINGv6]   Deering, S., Haberman, B., Jinmei,\
    \ T., Nordmark, E.,\n                 and B. Zill, \"IPv6 Scoped Address Architecture\"\
    , RFC\n                 4007, March 2005.\n   [SIMPLE]      R. Perlman, C-Y. Lee,\
    \ A. Ballardie, J. Crowcroft, Z.\n                 Wang, T. Maufer, C. Diot, and\
    \ M. Green, \"Simple\n                 Multicast: A Design for Simple, Low-Overhead\n\
    \                 Multicast\", Work in Progress, October 1999.\n   [SMRP]    \
    \    Green, M.  \"Method and System of Multicast Routing for\n               \
    \  Groups with a Single Transmitter.\"  United States\n                 Patent\
    \ Number 5,517,494.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Brad Cain\n   Acopia Networks\n   EMail: bcain99@gmail.com\n\
    \   Hugh Holbrook\n   Arastra, Inc.\n   P.O. Box 10905\n   Palo Alto, CA 94303\n\
    \   Phone: +1 650 331-1620\n   EMail: holbrook@arastra.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
