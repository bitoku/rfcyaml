- title: __initial_text__
  contents:
  - '          DomainKeys Identified Mail (DKIM) and Mailing Lists

    '
- title: Abstract
  contents:
  - "Abstract\n   DomainKeys Identified Mail (DKIM) allows an ADministrative Management\n\
    \   Domain (ADMD) to assume some responsibility for a message.  Based on\n   deployment\
    \ experience with DKIM, this document provides guidance for\n   the use of DKIM\
    \ with scenarios that include Mailing List Managers\n   (MLMs).\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo documents an Internet Best Current Practice.\n\
    \   This document is a product of the Internet Engineering Task Force\n   (IETF).\
    \  It represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   BCPs is available in Section\
    \ 2 of RFC 5741.\n   Information about the current status of this document, any\
    \ errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6377.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n     1.1.  Background . . . . . . . . . . . . . . . . . . .\
    \ . . . . .  4\n     1.2.  MLMs in Infrastructure . . . . . . . . . . . . . .\
    \ . . . .  4\n     1.3.  Feedback Loops and Other Bilateral Agreements  . . .\
    \ . . .  5\n     1.4.  Document Scope and Goals . . . . . . . . . . . . . . .\
    \ . .  6\n   2.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . .\
    \ .  6\n     2.1.  Key Words  . . . . . . . . . . . . . . . . . . . . . . . .\
    \  6\n     2.2.  Messaging Terms  . . . . . . . . . . . . . . . . . . . . .  6\n\
    \     2.3.  DKIM-Specific References . . . . . . . . . . . . . . . . .  6\n  \
    \   2.4.  'DKIM-Friendly'  . . . . . . . . . . . . . . . . . . . . .  7\n    \
    \ 2.5.  Message Streams  . . . . . . . . . . . . . . . . . . . . .  7\n   3. \
    \ Mailing Lists and DKIM . . . . . . . . . . . . . . . . . . . .  7\n     3.1.\
    \  Roles and Realities  . . . . . . . . . . . . . . . . . . .  7\n     3.2.  Types\
    \ of Mailing Lists . . . . . . . . . . . . . . . . . .  8\n     3.3.  Current\
    \ MLM Effects on Signatures  . . . . . . . . . . . . 10\n   4.  Non-Participating\
    \ MLMs . . . . . . . . . . . . . . . . . . . . 11\n     4.1.  Author-Related Signing\
    \ . . . . . . . . . . . . . . . . . . 12\n     4.2.  Verification Outcomes at\
    \ Receivers . . . . . . . . . . . . 12\n     4.3.  Handling Choices at Receivers\
    \  . . . . . . . . . . . . . . 13\n     4.4.  Wrapping a Non-Participating MLM\
    \ . . . . . . . . . . . . . 13\n   5.  Participating MLMs . . . . . . . . . .\
    \ . . . . . . . . . . . . 13\n     5.1.  General  . . . . . . . . . . . . . .\
    \ . . . . . . . . . . . 13\n     5.2.  DKIM Author Domain Signing Practices .\
    \ . . . . . . . . . . 14\n     5.3.  Subscriptions  . . . . . . . . . . . . .\
    \ . . . . . . . . . 15\n     5.4.  Exceptions to ADSP Recommendations . . . .\
    \ . . . . . . . . 15\n     5.5.  Author-Related Signing . . . . . . . . . . .\
    \ . . . . . . . 16\n     5.6.  Verification Outcomes at MLMs  . . . . . . . .\
    \ . . . . . . 16\n     5.7.  Signature Removal Issues . . . . . . . . . . . .\
    \ . . . . . 17\n     5.8.  MLM Signatures . . . . . . . . . . . . . . . . . .\
    \ . . . . 19\n     5.9.  Verification Outcomes at Final Receiving Sites . . .\
    \ . . . 20\n     5.10. Use with FBLs  . . . . . . . . . . . . . . . . . . . .\
    \ . . 20\n     5.11. Handling Choices at Receivers  . . . . . . . . . . . . .\
    \ . 21\n   6.  DKIM Reporting . . . . . . . . . . . . . . . . . . . . . . . .\
    \ 22\n   7.  Security Considerations  . . . . . . . . . . . . . . . . . . . 22\n\
    \     7.1.  Security Considerations from DKIM and ADSP . . . . . . . . 22\n  \
    \   7.2.  Authentication Results When Relaying . . . . . . . . . . . 23\n   8.\
    \  References . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n     8.1.\
    \  Normative References . . . . . . . . . . . . . . . . . . . 23\n     8.2.  Informative\
    \ References . . . . . . . . . . . . . . . . . . 23\n   Appendix A.  Acknowledgements\
    \  . . . . . . . . . . . . . . . . . . 25\n   Appendix B.  Example Scenarios .\
    \ . . . . . . . . . . . . . . . . . 25\n     B.1.  MLMs and ADSP  . . . . . .\
    \ . . . . . . . . . . . . . . . . 25\n     B.2.  MLMs and FBLs  . . . . . . .\
    \ . . . . . . . . . . . . . . . 25\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   DomainKeys Identified Mail [DKIM] allows an ADministrative\
    \ Management\n   Domain (ADMD) to take some responsibility for a [MAIL] message.\
    \  Such\n   responsibility can be taken by an Author's organization, an\n   operational\
    \ relay (Mail Transfer Agent, or MTA), or one of their\n   agents.  Assertion\
    \ of responsibility is made through a cryptographic\n   signature.  Message transit\
    \ from Author to recipient is through\n   relays that typically make no substantive\
    \ change to the message\n   content and thus preserve the validity of the DKIM\
    \ signature.\n   In contrast to relays, there are intermediaries, such as Mailing\
    \ List\n   Managers (MLMs), that actively take delivery of messages, reformat\n\
    \   them, and repost them, often invalidating DKIM signatures.  The goal\n   for\
    \ this document is to explore the use of DKIM for scenarios that\n   include intermediaries\
    \ and recommend best current practices based on\n   acquired experience.  Questions\
    \ that will be discussed include:\n   o  Under what circumstances is it advisable\
    \ for an Author, or its\n      organization, to apply DKIM to mail sent to mailing\
    \ lists?\n   o  What are the trade-offs regarding having an MLM verify and use\n\
    \      DKIM identifiers?\n   o  What are the trade-offs regarding having an MLM\
    \ remove existing\n      DKIM signatures prior to reposting the message?\n   o\
    \  What are the trade-offs regarding having an MLM add its own DKIM\n      signature?\n\
    \   These are open questions for which there may be no definitive\n   answers.\
    \  However, based on experience since the publication of the\n   original version\
    \ of [DKIM] and its gradual deployment, there are some\n   views that are useful\
    \ to consider and some recommended procedures.\n   In general, there are two categories\
    \ of MLMs in relation to DKIM:\n   participating and non-participating.  As each\
    \ type has its own issues\n   regarding DKIM-signed messages that are either handled\
    \ or produced by\n   them (or both), the types are discussed in separate sections.\n\
    \   The best general recommendation for dealing with MLMs is that the MLM\n  \
    \ or an MTA in the MLM's domain apply its own DKIM signature to each\n   message\
    \ it forwards and that assessors on the receiving end consider\n   the MLM's domain\
    \ signature in making their assessments.  (See\n   Section 5, especially Section\
    \ 5.2.)\n   With the understanding that this is not always possible or practical\n\
    \   and the consideration that it might not always be sufficient, this\n   document\
    \ provides additional guidance.\n"
- title: 1.1.  Background
  contents:
  - "1.1.  Background\n   DKIM signatures permit an agent of the email architecture\
    \ (see\n   [EMAIL-ARCH]) to make a claim of responsibility for a message by\n\
    \   affixing a validated domain-level identifier to the message as it\n   passes\
    \ through a relay.  Although not the only possibility, this is\n   most commonly\
    \ done as a message passes through a boundary Mail\n   Transport Agent (MTA) as\
    \ it departs an ADministrative Management\n   Domain (ADMD) across the open Internet.\n\
    \   A DKIM signature will fail to verify if a portion of the message\n   covered\
    \ by one of its hashes is altered.  An MLM commonly alters\n   messages to provide\
    \ information specific to the mailing list for\n   which it is providing service.\
    \  Common modifications are enumerated\n   and described in Section 3.3.  However,\
    \ note that MLMs vary widely in\n   behavior and often allow subscribers to select\
    \ individual behaviors.\n   Further, the MTA might make changes that are independent\
    \ of those\n   applied by the MLM.\n   The DKIM Signatures specification [DKIM]\
    \ deliberately rejects the\n   notion of tying the signing domain (the \"d=\"\
    \ tag in a DKIM signature)\n   to any other identifier within a message; any ADMD\
    \ that handles a\n   message could sign it, regardless of its origin or Author\
    \ domain.  In\n   particular, DKIM does not define any meaning to the occurrence\
    \ of a\n   match between the content of a \"d=\" tag and the value of, for\n \
    \  example, a domain name in the RFC5322.From field, nor is there any\n   obvious\
    \ degraded value to a signature where they do not match.  Since\n   any DKIM signature\
    \ is merely an assertion of \"some\" responsibility by\n   an ADMD, a DKIM signature\
    \ added by an MLM has no more or less meaning\n   than a signature with any other\
    \ \"d=\" value.\n"
- title: 1.2.  MLMs in Infrastructure
  contents:
  - "1.2.  MLMs in Infrastructure\n   An MLM is an autonomous agent that takes delivery\
    \ of a message and\n   can repost it as a new message or construct a digest of\
    \ it along with\n   other messages to the members of the list (see [EMAIL-ARCH],\
    \ Section\n   5.3).  However, the fact that the RFC5322.From field of such a\n\
    \   message (in the non-digest case) is typically the same as that of the\n  \
    \ original message, and that recipients perceive the message as \"from\"\n   the\
    \ original Author rather than the MLM, creates confusion about\n   responsibility\
    \ and autonomy for the reposted message.  This has\n   important implications\
    \ for the use of DKIM.\n   Section 3.3 describes some of the things MLMs commonly\
    \ do that\n   produce broken signatures, thus reducing the perceived value of\
    \ DKIM.\n   Further, while there are published standards that are specific to\
    \ MLM\n   behavior (e.g., [MAIL], [LIST-ID], and [LIST-URLS]), their adoption\n\
    \   has been spotty at best.  Hence, efforts to specify the use of DKIM\n   in\
    \ the context of MLMs need to be incremental and value-based.\n   Some MLM behaviors\
    \ are well-established and their effects on DKIM\n   signature validity can be\
    \ argued as frustrating wider DKIM adoption.\n   Still, those behaviors are not\
    \ standards violations.  Hence, this\n   memo specifies practices for all parties\
    \ involved, defining the\n   minimum changes possible to MLMs themselves.\n  \
    \ A DKIM signature on a message is an expression of some responsibility\n   for\
    \ the message taken by the signing domain.  An open issue that is\n   addressed\
    \ by this document is the ways a signature might be used by a\n   recipient's\
    \ evaluation module, after the message has gone through a\n   mailing list and\
    \ might or might not have been rendered invalid.  The\n   document also considers\
    \ how invalidation might have happened.\n   Note that where in this document there\
    \ is discussion of an MLM\n   conducting validation of DKIM signatures or Author\
    \ Domain Signing\n   Practices ([ADSP]) policies, the actual implementation could\
    \ be one\n   where the validation is done by the MTA or an agent attached to it,\n\
    \   and the results of that work are relayed by a trusted channel not\n   specified\
    \ here.  See [AUTH-RESULTS] for a discussion of this.  This\n   document does\
    \ not favor any particular arrangement of these agents\n   over another; it merely\
    \ talks about the MLM itself doing the work as\n   a matter of simplicity.\n"
- title: 1.3.  Feedback Loops and Other Bilateral Agreements
  contents:
  - "1.3.  Feedback Loops and Other Bilateral Agreements\n   A Feedback Loop (FBL)\
    \ is a bilateral agreement between two parties to\n   exchange reports of abuse.\
    \  Typically, a sender registers with a\n   receiving site to receive abuse reports\
    \ from that site for mail\n   coming from the sender.\n   An FBL reporting address\
    \ (i.e., an address to which FBL reports are\n   sent) is part of this bilateral\
    \ registration.  Some FBLs require DKIM\n   use by the registrant.\n   See Section\
    \ 6 for additional discussion.\n   FBLs tend to use the [ARF] or the [IODEF] formats.\n"
- title: 1.4.  Document Scope and Goals
  contents:
  - "1.4.  Document Scope and Goals\n   This document provides discussion on the above\
    \ issues to improve the\n   handling of possible interactions between DKIM and\
    \ MLMs.  In general,\n   the preference is to impose changes to behavior at the\
    \ Signer and\n   Verifier rather than at the MLM.\n   Wherever possible, the document's\
    \ discussion of MLMs is conceptually\n   decoupled from MTAs despite the very\
    \ tight integration that is\n   sometimes observed in implementation.  This is\
    \ done to emphasize the\n   functional independence of MLM services and responsibilities\
    \ from\n   those of an MTA.\n   Parts of this document explore possible changes\
    \ to common practice by\n   Signers, Verifiers, and MLMs.  The suggested enhancements\
    \ are largely\n   predictive in nature, taking into account the current email\n\
    \   infrastructure, the facilities DKIM can provide as it gains wider\n   deployment,\
    \ and working group consensus.  There is no substantial\n   implementation history\
    \ upon which these suggestions are based, and\n   their efficacy, performance,\
    \ and security characteristics have not\n   yet been fully explored.\n"
- title: 2.  Definitions
  contents:
  - '2.  Definitions

    '
- title: 2.1.  Key Words
  contents:
  - "2.1.  Key Words\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\"\
    , \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described\
    \ in\n   [KEYWORDS].\n"
- title: 2.2.  Messaging Terms
  contents:
  - "2.2.  Messaging Terms\n   See [EMAIL-ARCH] for a general description of the current\
    \ messaging\n   architecture and for definitions of various terms used in this\n\
    \   document.\n"
- title: 2.3.  DKIM-Specific References
  contents:
  - "2.3.  DKIM-Specific References\n   Readers are encouraged to become familiar\
    \ with [DKIM] and [ADSP],\n   which are core specification documents, as well\
    \ as [DKIM-OVERVIEW]\n   and [DKIM-DEPLOYMENT], which are DKIM's primary tutorial\
    \ documents.\n"
- title: 2.4.  'DKIM-Friendly'
  contents:
  - "2.4.  'DKIM-Friendly'\n   The term \"DKIM-friendly\" is used to describe an email\
    \ intermediary\n   that, when handling a message, makes no changes to the message\
    \ that\n   cause valid [DKIM] signatures present on the message on input to fail\n\
    \   to verify on output.\n   Various features of MTAs and MLMs seen as helpful\
    \ to users often have\n   side effects that do render DKIM signatures unverifiable.\
    \  These\n   would not qualify for this label.\n"
- title: 2.5.  Message Streams
  contents:
  - "2.5.  Message Streams\n   A \"message stream\" identifies a group of messages\
    \ originating from\n   within an ADMD that are distinct in intent, origin, and/or\
    \ use and\n   partitions them somehow (e.g., via changing the value in the \"\
    d=\" tag\n   value in the context of DKIM) so as to keep them associated to users\n\
    \   yet distinct in terms of their evaluation and handling by Verifiers\n   or\
    \ Receivers.\n   A good example might be user mail generated by a company's employees,\n\
    \   versus operational or transactional mail that comes from automated\n   sources\
    \ or marketing or sales campaigns.  Each of these could have\n   different sending\
    \ policies imposed against them, or there might be a\n   desire to insulate one\
    \ from the other (e.g., a marketing campaign\n   that gets reported by many spam\
    \ filters could cause the marketing\n   stream's reputation to degrade without\
    \ automatically punishing the\n   transactional or user streams).\n"
- title: 3.  Mailing Lists and DKIM
  contents:
  - "3.  Mailing Lists and DKIM\n   It is important to make some distinctions among\
    \ different styles of\n   intermediaries, their typical implementations, and the\
    \ effects they\n   have in a DKIM-aware environment.\n"
- title: 3.1.  Roles and Realities
  contents:
  - "3.1.  Roles and Realities\n   Across DKIM activities, there are several key roles\
    \ in the transit of\n   a message.  Most of these are defined in [EMAIL-ARCH]\
    \ but are\n   reviewed here for quick reference.\n   Author:  The agent that provided\
    \ the content of the message being\n      sent through the system.  The Author\
    \ delivers that content to the\n      Originator in order to begin a message's\
    \ journey to its intended\n      final recipients.  The Author can be a human\
    \ using an MUA (Mail\n      User Agent) or an automated process that may send\
    \ mail (for\n      example, the \"cron\" Unix system utility).\n   Originator:\
    \  The agent that accepts a message from the Author,\n      ensures it conforms\
    \ to the relevant standards such as [MAIL], and\n      then sends it toward its\
    \ destination(s).  This is often referred\n      to as the Mail Submission Agent\
    \ (MSA).\n   Signer:  Any agent that affixes one or more DKIM signature(s) to\
    \ a\n      message on its way toward its ultimate destination.  There is\n   \
    \   typically a Signer running at the MTA that sits between the\n      Author's\
    \ ADMD and the general Internet.  The Originator and/or\n      Author might also\
    \ be a Signer.\n   Verifier:  Any agent that conducts DKIM signature validation.\
    \  One is\n      typically running at the MTA that sits between the public Internet\n\
    \      and the Receiver's ADMD.  Note that any agent that handles a\n      signed\
    \ message can conduct verification; this document only\n      considers that action\
    \ and its outcomes either at an MLM or at the\n      Receiver.  Filtering decisions\
    \ could be made by this agent based\n      on verification results.\n   Receiver:\
    \  The agent that is the final transit relay for the message\n      and performs\
    \ final delivery to the recipient(s) of the message.\n      Filtering decisions\
    \ based on results made by the Verifier could be\n      applied by the Receiver.\
    \  The Verifier and the Receiver could be\n      the same agent.  This is sometimes\
    \ the same as or coupled with the\n      Mail Delivery Agent (MDA).\n   In the\
    \ case of simple user-to-user mail, these roles are fairly\n   straightforward.\
    \  However, when one is sending mail to a list and the\n   mail then gets relayed\
    \ to all of that list's subscribers, the roles\n   are often less clear to the\
    \ general user as particular agents may\n   hold multiple important but separable\
    \ roles.  The above definitions\n   are intended to enable more precise discussion\
    \ of the mechanisms\n   involved.\n"
- title: 3.2.  Types of Mailing Lists
  contents:
  - "3.2.  Types of Mailing Lists\n   There are four common MLM implementation modes:\n\
    \   aliasing:  An aliasing MLM (see Section 5.1 of [EMAIL-ARCH]) is one\n    \
    \  that makes no changes to the message itself as it redistributes;\n      any\
    \ modifications are constrained to changes to the [SMTP]\n      envelope recipient\
    \ list (RCPT commands) only.  There are no\n      changes to the message header\
    \ or body at all, except for the\n      addition of [MAIL] trace header fields.\
    \  The output of such an MLM\n      is considered to be a continuation of the\
    \ Author's original\n      message transit.  An example of such an MLM is an address\
    \ that\n      expands directly in the MTA, such as a list of local system\n  \
    \    administrators used for relaying operational or other internal-\n      only\
    \ messages.  See also Section 3.9.2 of [SMTP].\n   resending:  A resending MLM\
    \ (see Sections 5.2 and 5.3 of\n      [EMAIL-ARCH]) is one that may make changes\
    \ to a message.  The\n      output of such an MLM is considered to be a new message;\
    \ delivery\n      of the original has been completed prior to distribution of\
    \ the\n      reposted message.  Such messages are often reformatted, such as\n\
    \      with list-specific header fields or other properties, to\n      facilitate\
    \ discussion among list subscribers.\n   authoring:  An authoring MLM is one that\
    \ creates the content being\n      sent as well as initiating its transport, rather\
    \ than basing it on\n      one or more messages received earlier.  This is not\
    \ a \"mediator\"\n      in terms of [EMAIL-ARCH] since it originates the message,\
    \ but\n      after creation, its message processing and posting behavior\n   \
    \   otherwise do match the MLM paradigm.  Typically, replies are not\n      generated,\
    \ or if they are, they go to a specific recipient and not\n      back to the list's\
    \ full set of recipients.  Examples include\n      newsletters and bulk marketing\
    \ mail.\n   digesting:  A special case of the resending MLM is one that sends\
    \ a\n      single message comprising an aggregation of recent MLM\n      submissions,\
    \ which might be a message of [MIME] type \"multipart/\n      digest\" (see [MIME-TYPES]).\
    \  This is obviously a new message, but\n      it may contain a sequence of original\
    \ messages that may themselves\n      have been DKIM-signed.\n   In the remainder\
    \ of this document, we distinguish two relevant steps\n   corresponding to the\
    \ following SMTP transactions:\n   MLM Input:  Originating user is Author; originating\
    \ ADMD is\n      Originator and Signer; MLM's ADMD is Verifier; MLM's input\n\
    \      function is Receiver.\n   MLM Output:  MLM (sending its reconstructed copy\
    \ of the originating\n      user's message) is Author; MLM's ADMD is Originator\
    \ and Signer;\n      the ADMD of each subscriber of the list is a Verifier; each\n\
    \      subscriber is a Receiver.\n   Much of this document focuses on the resending\
    \ class of MLM as it has\n   the most direct conflict operationally with DKIM.\n\
    \   The dissection of the overall MLM operation into these two distinct\n   phases\
    \ allows the DKIM-specific issues with respect to MLMs to be\n   isolated and\
    \ handled in a logical way.  The main issue is that the\n   repackaging and reposting\
    \ of a message by an MLM is actually the\n   construction of a completely new\
    \ message, and as such, the MLM is\n   introducing new content into the email\
    \ ecosystem, consuming the\n   Author's copy of the message, and creating its\
    \ own.  When considered\n   in this way, the dual role of the MLM and its ADMD\
    \ becomes clear.\n   Some issues about these activities are discussed in Section\
    \ 3.6.4 of\n   [MAIL] and in Section 3.4.1 of [EMAIL-ARCH].\n"
- title: 3.3.  Current MLM Effects on Signatures
  contents:
  - "3.3.  Current MLM Effects on Signatures\n   As described above, an aliasing MLM\
    \ does not affect any existing\n   signature, and an authoring MLM is always creating\
    \ new content; thus,\n   there is never an existing signature.  However, the changes\
    \ a\n   resending MLM typically makes affect the RFC5322.Subject header\n   field,\
    \ the addition of some list-specific header fields, and/or the\n   modification\
    \ of the message body.  The effects of each of these on\n   DKIM verification\
    \ are discussed below.\n   Subject tags:  A popular feature of MLMs is the \"\
    tagging\" of an\n      RFC5322.Subject field by prefixing the field's contents\
    \ with the\n      name of the list, such as \"[example]\" for a list called \"\
    example\".\n      Altering the RFC5322.Subject field on new submissions by adding\
    \ a\n      list-specific prefix or suffix will invalidate the Signer's\n     \
    \ signature if that header field was included in the hash when\n      creating\
    \ that signature.  Section 5.5 of [DKIM] lists\n      RFC5322.Subject as one that\
    \ should be covered as it contains\n      important user-visible text, so this\
    \ is expected to be an issue\n      for any list that makes such changes.\n  \
    \ List-specific header fields:  Some lists will add header fields\n      specific\
    \ to list administrative functions such as those defined in\n      [LIST-ID] and\
    \ [LIST-URLS] or the \"Resent-\" fields defined in\n      [MAIL].  It is unlikely\
    \ that a typical MUA would include such\n      fields in an original message,\
    \ and DKIM is resilient to the\n      addition of header fields in general (see\
    \ notes about the \"h=\" tag\n      in Section 3.5 of [DKIM]).  Therefore, this\
    \ is not seen as a\n      concern.\n   Other header fields:  Some lists will add\
    \ or replace header fields\n      such as \"Reply-To\" or \"Sender\" in order\
    \ to establish that the\n      message is being sent in the context of the mailing\
    \ list, so that\n      the list is identified (\"Sender\") and any user replies\
    \ go to the\n      list (\"Reply-To\").  If these fields were included in the\
    \ original\n      message, it is possible that one or more of them may have been\n\
    \      included in the signature hash, and those signatures will thus be\n   \
    \   broken.\n   Minor body changes:  Some lists prepend or append a few lines\
    \ to each\n      message to remind subscribers of an administrative URL for\n\
    \      subscription issues, of list policy, etc.  Changes to the body\n      will\
    \ alter the body hash computed at the DKIM Verifier, so these\n      will render\
    \ any existing signatures that cover those portions of\n      the message body\
    \ unverifiable.  [DKIM] includes the capability to\n      limit the length of\
    \ the body covered by its body hash so that\n      appended text will not interfere\
    \ with signature validation, but\n      this has security implications.\n   Major\
    \ body changes:  There are some MLMs that make more substantial\n      changes\
    \ to message bodies when preparing them for redistribution,\n      such as adding,\
    \ deleting, reordering, or reformatting [MIME]\n      parts, \"flattening\" HTML\
    \ messages into plain text, or inserting\n      headers or footers within HTML\
    \ messages.  Most or all of these\n      changes will invalidate a DKIM signature.\n\
    \   MIME part removal:  Some MLMs that are MIME-aware will remove large\n    \
    \  MIME parts from submissions and replace them with URLs to reduce\n      the\
    \ size of the distributed form of the message and to prevent\n      inadvertent\
    \ automated malware delivery.  Except in some cases\n      where a body length\
    \ limit is applied in generation of the DKIM\n      signature, the signature will\
    \ be broken.\n   There reportedly still exist some mailing lists in operation\
    \ that are\n   actually run manually by a human list manager, whose workings in\n\
    \   preparing a message for distribution could include the above or even\n   some\
    \ other changes.\n   In general, absent a general movement by MLM developers and\
    \ operators\n   toward more DKIM-friendly practices, an MLM subscriber cannot\
    \ expect\n   signatures applied before the message was processed by the MLM to\
    \ be\n   valid on delivery to a Receiver.  Such an evolution is not expected\n\
    \   in the short term due to general development and deployment inertia.\n   Moreover,\
    \ even if an MLM currently passes messages unmodified such\n   that Author signatures\
    \ validate, it is possible that a configuration\n   change or software upgrade\
    \ to that MLM will cause that no longer to\n   be true.\n"
- title: 4.  Non-Participating MLMs
  contents:
  - "4.  Non-Participating MLMs\n   This section contains a discussion of issues regarding\
    \ sending DKIM-\n   signed mail to or through an MLM that is not DKIM-aware.\n\
    \   Specifically, the header fields introduced by [DKIM] and\n   [AUTH-RESULTS]\
    \ carry no special meaning to such an MLM.\n"
- title: 4.1.  Author-Related Signing
  contents:
  - "4.1.  Author-Related Signing\n   In an idealized world, if an Author knows that\
    \ the MLM to which a\n   message is being sent is a non-participating resending\
    \ MLM, the\n   Author needs to be cautious when deciding whether or not to send\
    \ a\n   signed message to the list.  The MLM could make a change that would\n\
    \   invalidate the Author's signature but not remove it prior to\n   redistribution.\
    \  Hence, list recipients would receive a message\n   purportedly from the Author\
    \ but bearing a DKIM signature that would\n   not verify.  Some mail filtering\
    \ software incorrectly penalizes a\n   message containing a DKIM signature that\
    \ fails verification.  This\n   may have detrimental effects outside of the Author's\
    \ control.\n   (Additional discussion of this is below.)  This problem can be\n\
    \   compounded if there are Receivers that apply signing policies (e.g.,\n   [ADSP])\
    \ and the Author publishes any kind of strict policy, i.e., a\n   policy that\
    \ requests that Receivers reject or otherwise deal severely\n   with non-compliant\
    \ messages.\n   For domains that do publish strict ADSP policies, the originating\n\
    \   site SHOULD use a separate message stream (see Section 2.5), such as\n   a\
    \ signing and Author subdomain, for the \"personal\" mail -- a\n   subdomain that\
    \ is different from domain(s) used for other mail\n   streams.  This allows each\
    \ to develop an independent reputation, and\n   more stringent policies (including\
    \ ADSP) can be applied to the mail\n   stream(s) that do not go through mailing\
    \ lists or perhaps do not get\n   signed at all.\n   However, all of this presupposes\
    \ a level of infrastructure\n   understanding that is not expected to be common.\
    \  Thus, it will be\n   incumbent upon site administrators to consider how support\
    \ of users\n   wishing to participate in mailing lists might be accomplished as\
    \ DKIM\n   achieves wider adoption.\n   In general, the stricter practices and\
    \ policies are likely to be\n   successful only for the mail streams subject to\
    \ the most end-to-end\n   control by the originating organization.  That typically\
    \ excludes\n   mail going through MLMs.  Therefore, site administrators wishing\
    \ to\n   employ ADSP with a \"discardable\" setting SHOULD separate the\n   controlled\
    \ mail stream warranting this handling from other mail\n   streams that are less\
    \ controlled, such as personal mail that transits\n   MLMs.  (See also Section\
    \ 5.7 below.)\n"
- title: 4.2.  Verification Outcomes at Receivers
  contents:
  - "4.2.  Verification Outcomes at Receivers\n   There is no reliable way to determine\
    \ that a piece of mail arrived\n   via a non-participating MLM.  Sites whose users\
    \ subscribe to non-\n   participating MLMs SHOULD ensure that such user mail streams\
    \ are not\n   subject to strict DKIM-related handling policies.\n"
- title: 4.3.  Handling Choices at Receivers
  contents:
  - "4.3.  Handling Choices at Receivers\n   In order to exempt some mail from the\
    \ expectation of signature\n   verification, as discussed in Section 4.1, receiving\
    \ ADMDs would need\n   to register non-participating lists and confirm that mail\
    \ transited\n   them.  However, such an approach requires excessive effort and\
    \ even\n   then is likely to be unreliable.  Hence, it is not a scalable\n   solution.\n\
    \   Any treatment of a verification failure as having special meaning is\n   a\
    \ violation of the basic DKIM Signatures specification [DKIM].  The\n   only valid,\
    \ standardized basis for going beyond that specification is\n   with specific\
    \ ADSP direction.\n   Use of restrictive domain policies such as [ADSP] \"discardable\"\
    \n   presents an additional challenge.  In that case, when a message is\n   unsigned\
    \ or the signature can no longer be verified, discarding of\n   the message is\
    \ requested.  There is no exception in the policy for a\n   message that may have\
    \ been altered by an MLM, nor is there a reliable\n   way to identify such mail.\
    \  Therefore, participants SHOULD honor the\n   policy and disallow the message.\n"
- title: 4.4.  Wrapping a Non-Participating MLM
  contents:
  - "4.4.  Wrapping a Non-Participating MLM\n   One approach for adding DKIM support\
    \ to an otherwise non-\n   participating MLM is to \"wrap\" the MLM or, in essence,\
    \ place it\n   between other DKIM-aware components (such as MTAs) that provide\
    \ some\n   DKIM services.  For example, the ADMD operating a non-participating\n\
    \   MLM could have its DKIM Verifier act on messages from list\n   subscribers,\
    \ enforcing some of the features and recommendations of\n   Section 5 on behalf\
    \ of the MLM, and the MTA or MSA receiving the MLM\n   Output could also add a\
    \ DKIM signature for the MLM's domain.\n"
- title: 5.  Participating MLMs
  contents:
  - "5.  Participating MLMs\n   This section contains a discussion of issues regarding\
    \ DKIM-signed\n   mail that transits an MLM that is DKIM-aware.\n"
- title: 5.1.  General
  contents:
  - "5.1.  General\n   Changes that merely add new header fields, such as those specified\
    \ by\n   [LIST-ID], [LIST-URLS], and [MAIL], are generally the most friendly\n\
    \   to a DKIM-participating email infrastructure.  Their addition by an\n   MLM\
    \ will not affect any existing DKIM signatures unless those fields\n   were already\
    \ present and covered by a signature's hash, or a\n   signature was created specifically\
    \ to disallow their addition (see\n   the note about \"h=\" in Section 3.5 of\
    \ [DKIM]).\n   However, the practice of applying headers and footers to message\n\
    \   bodies is common and not expected to fade regardless of what\n   documents\
    \ any standards body might produce.  This sort of change will\n   invalidate the\
    \ signature on a message where the body hash covers the\n   entire message.  Thus,\
    \ the following sections also discuss and\n   suggest other processing alternatives.\n\
    \   A possible mitigation to this incompatibility is use of the \"l=\" tag\n \
    \  to bound the portion of the body covered by the DKIM body hash, but\n   this\
    \ is not workable for [MIME] messages; moreover, it has security\n   considerations\
    \ (see Section 3.5 of [DKIM]).  Therefore, its use is\n   discouraged.\n   Expressions\
    \ of list-specific policy (e.g., rules for participation,\n   small advertisements,\
    \ etc.) are often added to outgoing messages by\n   MLM operators.  There is currently\
    \ no header field proposed for\n   relaying such general operational MLM details\
    \ apart from what\n   [LIST-URLS] already supports.  This sort of information\
    \ is commonly\n   included footer text appended to the body of the message or\
    \ header\n   text prepended above the original body.  It is RECOMMENDED that\n\
    \   periodic, automatic mailings to the list are sent to remind\n   subscribers\
    \ of list policy.  It is also RECOMMENDED that standard\n   header fields, rather\
    \ than body changes, be used to express list\n   operation parameters.  These\
    \ periodic mailings will be repetitive, of\n   course, but by being generally\
    \ the same each time, they can be easily\n   filtered if desired.\n"
- title: 5.2.  DKIM Author Domain Signing Practices
  contents:
  - "5.2.  DKIM Author Domain Signing Practices\n   ADSP presents a particular challenge.\
    \  An Author domain posting a\n   policy of \"discardable\" imposes a very tight\
    \ restriction on the use\n   of mailing lists, essentially constraining that domain's\
    \ users to\n   lists operated by aliasing MLMs only; any MLM that alters a message\n\
    \   from such a domain or removes its signature subjects the message to\n   severe\
    \ action by Verifiers or Receivers.  A resending MLM SHOULD\n   reject outright\
    \ any mail from an Author whose domain posts such a\n   policy, as those messages\
    \ are likely to be discarded or rejected by\n   any ADSP-aware recipients.  See\
    \ also the discussion in Section 5.3.\n   Where such rejection of \"discardable\"\
    \ mail is not enforced, and such\n   mail arrives to a Verifier that applies ADSP\
    \ checks that fail, the\n   message SHOULD be either discarded (i.e., accept the\
    \ message at the\n   [SMTP] level but discard it without delivery) or rejected\
    \ by\n   returning a 5xx error code.  In the latter case, some advice for how\n\
    \   to conduct the rejection in a potentially meaningful way can be found\n  \
    \ in Section 5.11.\n   The reason for these recommendations is best illustrated\
    \ by example.\n   Suppose the following:\n   o  users U1 and U2 are subscribers\
    \ of list L;\n   o  U1 is within an ADMD that advertises a \"discardable\" policy\
    \ using\n      ADSP;\n   o  L alters submissions prior to resending in a way that\
    \ invalidates\n      the DKIM signature added by U1's ADMD;\n   o  U2's ADMD enforces\
    \ ADSP at the border by issuing an SMTP error\n      code; and\n   o  L is configured\
    \ to remove subscribers whose mail is bouncing.\n   It follows then that a submission\
    \ to L from U1 will be received at\n   U2, but since the DKIM signature fails\
    \ to verify, U2's ADMD will\n   reject it based on the ADSP protocol.  That rejection\
    \ is received at\n   L, which proceeds to remove U2 from the list.\n   See also\
    \ Appendix B.5 of [ADSP] for further discussion.\n"
- title: 5.3.  Subscriptions
  contents:
  - "5.3.  Subscriptions\n   At subscription time, an ADSP-aware MLM SHOULD check\
    \ for a published\n   ADSP record for the new subscriber's domain.  If the policy\
    \ specifies\n   \"discardable\", the MLM SHOULD disallow the subscription or present\
    \ a\n   warning that the subscriber's submissions to the mailing list might\n\
    \   not be deliverable to some recipients because of the published policy\n  \
    \ of the subscriber's ADMD.\n   Of course, such a policy record could be created\
    \ after subscription,\n   so this is not a universal solution.  An MLM implementation\
    \ MAY do\n   periodic checks of its subscribers and issue warnings where such\
    \ a\n   policy is detected or simply check upon each submission.\n"
- title: 5.4.  Exceptions to ADSP Recommendations
  contents:
  - "5.4.  Exceptions to ADSP Recommendations\n   Where an ADMD has established some\
    \ out-of-band trust agreement with\n   another ADMD such that an Authentication-Results\
    \ field applied by one\n   is trusted by the other, the above recommendations\
    \ for MLM operation\n   with respect to ADSP do not apply because it is then possible\
    \ to\n   establish whether or not a valid Author signature can be inferred\n \
    \  even if one is not present on receipt.\n   For example, suppose domains example.com\
    \ and example.net have an\n   explicit agreement to trust one another's authentication\
    \ assertions.\n   Now, consider a message with an RFC5322.From domain of \"example.org\"\
    \n   that is also bearing a valid DKIM signature by the same domain, which\n \
    \  arrives at a mailing list run by example.com.  Upon evaluation,\n   example.com\
    \ validates the signature and adds an [AUTH-RESULTS] field\n   indicating this.\
    \  However, the MLM also makes changes to the message\n   body that invalidate\
    \ the signature.  The MLM then re-signs the\n   modified message using DKIM and\
    \ sends it on to the list's\n   subscribers, one of whom is at example.net.\n\
    \   On arrival at example.net, the DKIM signature for example.org is no\n   longer\
    \ valid, so ADSP would generally fail.  However, example.net\n   trusts the assertion\
    \ of example.com's Authentication-Results field\n   that indicated that there\
    \ was a valid signature from example.org, so\n   the ADSP failure can be ignored.\n"
- title: 5.5.  Author-Related Signing
  contents:
  - "5.5.  Author-Related Signing\n   An important consideration is that Authors rarely\
    \ have any direct\n   influence over the management of an MLM.  Specifically,\
    \ the behavior\n   of an intermediary (e.g., an MLM that is not careful about\
    \ filtering\n   out junk mail or being diligent about unsubscription requests)\
    \ can\n   trigger recipient complaints that reflect back on those agents that\n\
    \   appear to be responsible for the message, in this case an Author via\n   the\
    \ address found in the RFC5322.From field.  In the future, as DKIM\n   signature\
    \ outputs (i.e., the signing domain) are used as inputs to\n   reputation modules,\
    \ there may be a desire to insulate one's\n   reputation from influence by the\
    \ unknown results of sending mail\n   through an MLM.  In that case, Authors SHOULD\
    \ create a mail stream\n   specifically used for generating DKIM signatures when\
    \ sending traffic\n   to MLMs.\n   This suggestion can be made more general. \
    \ Mail that is of a\n   transactional or generally end-to-end nature, and not\
    \ likely to be\n   forwarded around by either MLMs or users, SHOULD be signed\
    \ with a\n   mail stream identifier different from that used for a stream that\n\
    \   serves more varied uses.\n"
- title: 5.6.  Verification Outcomes at MLMs
  contents:
  - "5.6.  Verification Outcomes at MLMs\n   MLMs typically attempt to authenticate\
    \ messages posted through them.\n   They usually do this through the trivial (and\
    \ insecure) means of\n   verifying the RFC5322.From field email address (or, less\
    \ frequently,\n   the RFC5321.MailFrom parameter) against a list subscription\
    \ registry.\n   DKIM enables a stronger form of authentication: the MLM can require\n\
    \   that messages using a given RFC5322.From address also have a DKIM\n   signature\
    \ with a corresponding \"d=\" domain.  This feature would be\n   somewhat similar\
    \ to using ADSP, except that the requirement for it\n   would be imposed by the\
    \ MLM and not the Author's organization.\n   (Note, however, that this goes beyond\
    \ DKIM's documented semantics.\n   It is presented as a possible workable enhancement.)\n\
    \   As described, the MLM might conduct DKIM verification of a signed\n   message\
    \ to attempt to confirm the identity of the Author.  Although\n   it is a common\
    \ and intuitive conclusion, few signed messages will\n   include an Author signature\
    \ (see [ADSP]).  MLM implementers adding\n   such support would have to accommodate\
    \ this.  For example, an MLM\n   might be designed to accommodate a list of possible\
    \ signing domains\n   (the \"d=\" portion of a DKIM signature) for a given Author\
    \ and\n   determine at verification time if any of those are present.  This\n\
    \   enables a more reliable method of authentication at the expense of\n   having\
    \ to store a mapping of authorized signing domains for\n   subscribers and trusting\
    \ that it will be kept current.\n   A message that cannot be thus authenticated\
    \ MAY be held for\n   moderation or rejected outright.\n   This logic could apply\
    \ to any list operation, not just list\n   submission.  In particular, this improved\
    \ authentication MAY apply to\n   subscription, unsubscription, and/or changes\
    \ to subscriber options\n   that are sent via email rather than through an authenticated,\n\
    \   interactive channel such as the web.\n   In the case of verification of signatures\
    \ on submissions, MLMs SHOULD\n   add an [AUTH-RESULTS] header field to indicate\
    \ the signature(s)\n   observed on the submission as it arrived at the MLM and\
    \ what the\n   outcome of the evaluation was.  Downstream agents might or might\
    \ not\n   trust the content of that header field depending on their own a\n  \
    \ priori knowledge of the operation of the ADMD generating (and,\n   preferably,\
    \ signing) that header field.  See [AUTH-RESULTS] for\n   further discussion.\n"
- title: 5.7.  Signature Removal Issues
  contents:
  - "5.7.  Signature Removal Issues\n   A message that arrives signed with DKIM means\
    \ some domain prior to\n   MLM Input has made a claim of some responsibility for\
    \ the message.\n   An obvious benefit to leaving the input-side signatures intact,\
    \ then,\n   is to preserve that original assertion of responsibility for the\n\
    \   message so that the Receivers of the final message have an\n   opportunity\
    \ to evaluate the message with that information available\n   to them.\n   However,\
    \ if the MLM is configured to make changes to the message\n   prior to reposting\
    \ that would invalidate the original signature(s),\n   further action is RECOMMENDED\
    \ to prevent invalidated signatures from\n   arriving at final recipients, possibly\
    \ triggering unwarranted filter\n   actions.  (Note, however, that such filtering\
    \ actions are plainly\n   wrong; [DKIM] stipulates that an invalid signature is\
    \ to be treated\n   as no signature at all.)\n   A possible solution would be\
    \ to:\n   1.  Attempt verification of all DKIM signatures present on the input\n\
    \       message;\n   2.  Apply local policy to authenticate the identity of the\
    \ Author;\n   3.  Remove all existing [AUTH-RESULTS] fields (optional);\n   4.\
    \  Add an [AUTH-RESULTS] header field to the message to indicate the\n       results\
    \ of the above;\n   5.  Remove all previously evaluated DKIM signatures;\n   6.\
    \  Affix a new signature that includes in its hashes the entire\n       message\
    \ on the output side, including the Authentication-Results\n       header field\
    \ just added (see Section 5.8).\n   Removing the original signature(s) seems particularly\
    \ appropriate\n   when the MLM knows it is likely to invalidate any or all of\
    \ them due\n   to the nature of the reformatting it will do.  This avoids false\n\
    \   negatives for list subscribers in their roles as Receivers of the\n   message;\
    \ although [DKIM] stipulates that an invalid signature is the\n   same as no signature,\
    \ it is anticipated that there will be some\n   implementations that ignore this\
    \ advice.\n   The MLM could re-evaluate existing signatures after making its\n\
    \   message changes to determine whether or not any of them have been\n   invalidated.\
    \  The cost of this is reduced by the fact that,\n   presumably, the necessary\
    \ public keys have already been downloaded\n   and one or both of the message\
    \ hashes could be reused.\n   Per the discussion in [AUTH-RESULTS], a Receiver's\
    \ choice to put any\n   faith in the veracity of the header field requires an\
    \ a priori\n   assessment of the agent that created it.  Absent that assessment,\
    \ a\n   Receiver cannot interpret the field as valid.  Thus, the final\n   recipients\
    \ of the message have no way to verify on their own the\n   authenticity of the\
    \ Author's identity on that message.  However, if\n   that field is the only one\
    \ on the message when the Verifier gets it,\n   and the Verifier explicitly trusts\
    \ the Signer that included the\n   Authentication-Results field in its header\
    \ hash (in this case, the\n   MLM), the Verifier is in a position to believe that\
    \ a valid Author\n   signature was present on the message.\n   This can be generalized\
    \ as follows: a Receiver SHOULD consider only\n   [AUTH-RESULTS] fields bearing\
    \ an authserv-id that appears in a list\n   of sites the Receiver trusts and that\
    \ is also included in the header\n   hash of a [DKIM] signature added by a domain\
    \ in the same trusted\n   list.\n   Since an aliasing MLM makes no substantive\
    \ changes to a message, it\n   need not consider the issue of signature removal\
    \ as the original\n   signatures should at least arrive to the next MTA unmodified.\
    \  It is\n   possible that future domain-based reputations would prefer a richer\n\
    \   data set on receipt of a message, and, in that case, signature\n   removal\
    \ would be undesirable.\n   An authoring MLM is closed to outside submitters;\
    \ thus, much of this\n   discussion does not apply in that case.\n"
- title: 5.8.  MLM Signatures
  contents:
  - "5.8.  MLM Signatures\n   DKIM-aware resending MLMs and authoring MLMs SHOULD\
    \ affix their own\n   signatures when distributing messages.  The MLM is responsible\
    \ for\n   the alterations it makes to the original messages it is resending and\n\
    \   should express this via a signature.  This is also helpful for\n   getting\
    \ feedback from any FBLs that might be set up so that undesired\n   list mail\
    \ can generate appropriate action.\n   MLM signatures will likely be used by recipient\
    \ systems to recognize\n   list mail, and they give the MLM's ADMD an opportunity\
    \ to develop a\n   good reputation for the list itself.\n   A signing MLM, as\
    \ any other MLM, is free to omit redistribution of a\n   message if that message\
    \ was not signed in accordance with its own\n   local configuration or policy.\
    \  It could also redistribute but not\n   sign such mail.  However, selective\
    \ signing is NOT RECOMMENDED;\n   essentially that would create two message streams\
    \ from the MLM, one\n   signed and one not, which can confuse DKIM-aware Verifiers\
    \ and\n   Receivers.\n   A signing MLM could add a List-Post: header field (see\
    \ [LIST-URLS])\n   using the DNS domain matching the one used in the \"d=\" tag\
    \ of the\n   DKIM signature that is added by the MLM.  This can be used by\n \
    \  Verifiers or Receivers to identify the DKIM signature that was added\n   by\
    \ the MLM.  This is not required, however; it is believed the\n   reputation of\
    \ the Signer will be a more critical data point than this\n   suggested binding.\
    \  Furthermore, this is not a binding recognized by\n   any current specification\
    \ document.\n   A DKIM-aware resending MLM SHOULD sign the entire message after\
    \ the\n   message is prepared for distribution (i.e., the MLM Output from\n  \
    \ Section 3.2).  Any other configuration might generate signatures that\n   will\
    \ not validate.\n   DKIM-aware authoring MLMs sign the mail they send according\
    \ to the\n   regular signing guidelines given in [DKIM].\n   One concern is that\
    \ having an MLM apply its signature to unsigned\n   mail might cause some Verifiers\
    \ or Receivers to interpret the\n   signature as conferring more authority or\
    \ authenticity to the message\n   content than is defined by [DKIM].  This is\
    \ an issue beyond MLMs and\n   primarily entails receive-side processing outside\
    \ of the scope of\n   [DKIM].  It is, nevertheless, worth noting here.\n"
- title: 5.9.  Verification Outcomes at Final Receiving Sites
  contents:
  - "5.9.  Verification Outcomes at Final Receiving Sites\n   In general, Verifiers\
    \ and Receivers SHOULD treat a signed message\n   from an MLM like any other signed\
    \ message; indeed, it would be\n   difficult to discern any difference since specifications\
    \ such as\n   [LIST-URLS] and [LIST-ID] are not universally deployed and can be\n\
    \   trivially spoofed.\n   However, because the Author domain will commonly be\
    \ different from\n   the MLM's signing domain, there may be a conflict with [ADSP]\
    \ as\n   discussed in Sections 4.3 and 5.7, especially where an ADMD has\n   misused\
    \ ADSP.\n"
- title: 5.10.  Use with FBLs
  contents:
  - "5.10.  Use with FBLs\n   An FBL operator might wish to act on a complaint from\
    \ a user about a\n   message sent to a list.  Some FBLs could choose to generate\
    \ feedback\n   reports based on DKIM verifications in the subject message.  Such\n\
    \   operators SHOULD send a report to each domain with a valid signature\n   that\
    \ has an FBL agreement established, as DKIM signatures are claims\n   of some\
    \ responsibility for that message.  Because Authors generally\n   have limited\
    \ control over the operation of a list, this point makes\n   MLM signing all the\
    \ more important.\n   MLM operators SHOULD register with FBLs from major service\
    \ providers.\n   In the context of DKIM, there SHOULD be an exchange of information\n\
    \   with the FBL provider including what signing domain the MLM will use,\n  \
    \ if any.\n   Where the FBL wishes to be more specific, it MAY act solely on a\
    \ DKIM\n   signature where the signing domain matches the DNS domain found in\
    \ a\n   List-Post: header field (or similar).\n   Use of FBLs in this way SHOULD\
    \ be made explicit to list subscribers.\n   For example, if it is the policy of\
    \ the MLM's ADMD to handle an FBL\n   item by unsubscribing the user that was\
    \ the apparent sender of the\n   offending message, advising subscribers of this\
    \ in advance would help\n   to avoid surprises later.\n   A DKIM-signed message\
    \ sent to an MLM, and then distributed to all of\n   a list's recipients, could\
    \ result in a complaint from one of the\n   final recipients for some reason.\
    \  This could be an actual complaint\n   from some subscriber that finds the message\
    \ abusive or otherwise\n   undesirable, or it could be an automated complaint\
    \ such as Receiver\n   detection of an invalidated DKIM signature or some other\
    \ condition.\n   It could also be a complaint that results from antagonistic behavior,\n\
    \   such as is common when a subscriber to a list is having trouble\n   unsubscribing\
    \ and then begins issuing complaints about all\n   submissions to the list.  This\
    \ would result in a complaint being\n   generated in the context of an FBL report\
    \ back to the message Author.\n   However, the original Author has no involvement\
    \ in operation of the\n   MLM itself, meaning the FBL report is not actionable\
    \ and is thus\n   undesirable.\n"
- title: 5.11.  Handling Choices at Receivers
  contents:
  - "5.11.  Handling Choices at Receivers\n   A recipient that explicitly trusts signatures\
    \ from a particular MLM\n   MAY wish to extend that trust to an [AUTH-RESULTS]\
    \ header field\n   signed by that MLM.  The recipient MAY then do additional processing\n\
    \   of the message, using the results recorded in the Authentication-\n   Results\
    \ header field instead of the original Author's DKIM signature.\n   This includes\
    \ possibly processing the message as per ADSP\n   requirements.\n   Receivers\
    \ SHOULD ignore or remove all unsigned externally applied\n   Authentication-Results\
    \ header fields and those not signed by an ADMD\n   that can be trusted by the\
    \ Receiver.  See Sections 5 and 7 of\n   [AUTH-RESULTS] for further discussion.\n\
    \   Upon DKIM and ADSP evaluation during an SMTP session (a common\n   implementation),\
    \ an agent MAY decide to reject a message during an\n   SMTP session.  If this\
    \ is done, [SMTP] stipulates that 550 is the\n   correct response code.  However,\
    \ if the SMTP server supports\n   [ENHANCED] status codes, a status code not normally\
    \ used for \"user\n   unknown\" (5.1.1) is preferred; therefore, a 5.7.0 code\
    \ SHOULD be\n   used.  If the rejecting SMTP server supports this, it thus makes\
    \ a\n   distinction between messages rejected deliberately due to policy\n   decisions\
    \ rather than those rejected because of other delivery\n   issues.  In particular,\
    \ a policy rejection SHOULD be relayed using\n   the above enhanced status code\
    \ and some appropriate wording in the\n   text part of the reply.  Those MLMs\
    \ that automatically attempt to\n   remove users with prolonged delivery problems\
    \ (such as account\n   deletion) SHOULD thus detect the difference between policy\
    \ rejection\n   and other delivery failures and act accordingly.  It would also\
    \ be\n   beneficial for SMTP servers doing so to use appropriate wording in\n\
    \   the text portion of the reply, perhaps explicitly using the string\n   \"\
    ADSP\" to facilitate searching for relevant data in logs.\n   The preceding paragraph\
    \ does not apply to an [ADSP] policy of\n   \"discardable\".  In such cases where\
    \ the submission fails that test,\n   the Receiver or Verifier SHOULD discard\
    \ the message but return an\n   SMTP success code, i.e., accept the message but\
    \ drop it without\n   delivery.  An SMTP rejection of such mail instead of the\
    \ requested\n   discard action causes more harm than good.\n"
- title: 6.  DKIM Reporting
  contents:
  - "6.  DKIM Reporting\n   As mechanisms become available for reporting forensic\
    \ details about\n   DKIM verification failures, MLMs will benefit from their use.\n\
    \   MLMs SHOULD apply DKIM failure-reporting mechanisms as a method for\n   providing\
    \ feedback to Signers about issues with DKIM infrastructure.\n   This is especially\
    \ important for MLMs that implement DKIM\n   verification as a mechanism for authentication\
    \ of list configuration\n   commands and submissions from subscribers.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   This document provides suggested or best current\
    \ practices for use\n   with DKIM and, as such, does not introduce any new technologies\
    \ for\n   consideration.  However, the following security issues should be\n \
    \  considered when implementing the practices described in this\n   document.\n"
- title: 7.1.  Security Considerations from DKIM and ADSP
  contents:
  - "7.1.  Security Considerations from DKIM and ADSP\n   Readers should be familiar\
    \ with the material in the \"Security\n   Considerations\" sections in [DKIM],\
    \ [ADSP], and [AUTH-RESULTS] as\n   appropriate.\n"
- title: 7.2.  Authentication Results When Relaying
  contents:
  - "7.2.  Authentication Results When Relaying\n   Section 5 advocates addition of\
    \ an [AUTH-RESULTS] header field to\n   indicate authentication status of a message\
    \ received as MLM Input.\n   Per Section 7.2 of [AUTH-RESULTS], Receivers generally\
    \ should not\n   trust such data without a good reason to do so, such as an a\
    \ priori\n   agreement with the MLM's ADMD.\n   Such agreements are strongly advised\
    \ to include a requirement that\n   those header fields be covered by a [DKIM]\
    \ signature added by the\n   MLM's ADMD.\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.  Normative References
  contents:
  - "8.1.  Normative References\n   [ADSP]     Allman, E., Fenton, J., Delany, M.,\
    \ and J. Levine,\n              \"DomainKeys Identified Mail (DKIM) Author Domain\
    \ Signing\n              Practices (ADSP)\", RFC 5617, August 2009.\n   [AUTH-RESULTS]\n\
    \              Kucherawy, M., \"Message Header Field for Indicating\n        \
    \      Message Authentication Status\", RFC 5451, April 2009.\n   [DKIM]     Crocker,\
    \ D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,\n              \"DomainKeys\
    \ Identified Mail (DKIM) Signatures\", RFC 6376,\n              September 2011.\n\
    \   [EMAIL-ARCH]\n              Crocker, D., \"Internet Mail Architecture\", RFC\
    \ 5598,\n              July 2009.\n   [KEYWORDS] Bradner, S., \"Key words for\
    \ use in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [MAIL]     Resnick, P., Ed., \"Internet Message Format\", RFC\
    \ 5322,\n              October 2008.\n"
- title: 8.2.  Informative References
  contents:
  - "8.2.  Informative References\n   [ARF]      Shafranovich, Y., Levine, J., and\
    \ M. Kucherawy, \"An\n              Extensible Format for Email Feedback Reports\"\
    , RFC 5965,\n              August 2010.\n   [DKIM-DEPLOYMENT]\n              Hansen,\
    \ T., Siegel, E., Hallam-Baker, P., and D. Crocker,\n              \"DomainKeys\
    \ Identified Mail (DKIM) Development,\n              Deployment, and Operations\"\
    , RFC 5863, May 2010.\n   [DKIM-OVERVIEW]\n              Hansen, T., Crocker,\
    \ D., and P. Hallam-Baker, \"DomainKeys\n              Identified Mail (DKIM)\
    \ Service Overview\", RFC 5585,\n              July 2009.\n   [ENHANCED] Vaudreuil,\
    \ G., \"Enhanced Mail System Status Codes\",\n              RFC 3463, January\
    \ 2003.\n   [IODEF]    Danyliw, R., Meijer, J., and Y. Demchenko, \"The Incident\n\
    \              Object Description Exchange Format\", RFC 5070,\n             \
    \ December 2007.\n   [LIST-ID]  Chandhok, R. and G. Wenger, \"List-Id: A Structured\
    \ Field\n              and Namespace for the Identification of Mailing Lists\"\
    ,\n              RFC 2919, March 2001.\n   [LIST-URLS]\n              Neufeld,\
    \ G. and J. Baer, \"The Use of URLs as Meta-Syntax\n              for Core Mail\
    \ List Commands and their Transport through\n              Message Header Fields\"\
    , RFC 2369, July 1998.\n   [MIME]     Freed, N. and N. Borenstein, \"Multipurpose\
    \ Internet Mail\n              Extensions (MIME) Part One: Format of Internet\
    \ Message\n              Bodies\", RFC 2045, November 1996.\n   [MIME-TYPES]\n\
    \              Freed, N. and N. Borenstein, \"Multipurpose Internet Mail\n   \
    \           Extensions (MIME) Part Two: Media Types\", RFC 2046,\n           \
    \   November 1996.\n   [SMTP]     Klensin, J., \"Simple Mail Transfer Protocol\"\
    , RFC 5321,\n              October 2008.\n"
- title: Appendix A.  Acknowledgements
  contents:
  - "Appendix A.  Acknowledgements\n   The author wishes to acknowledge the following\
    \ individuals for their\n   review and constructive criticism of this document:\
    \ Serge Aumont,\n   Daniel Black, Dave Crocker, J.D. Falk, Tony Hansen, Eliot\
    \ Lear,\n   Charles Lindsey, John Levine, Jeff Macdonald, S. Moonesamy, Rolf E.\n\
    \   Sonneveld, and Alessandro Vesely.\n"
- title: Appendix B.  Example Scenarios
  contents:
  - "Appendix B.  Example Scenarios\n   This section describes a few MLM-related DKIM\
    \ scenarios that were\n   part of the impetus for this work and the recommended\
    \ resolutions for\n   each.\n"
- title: B.1.  MLMs and ADSP
  contents:
  - "B.1.  MLMs and ADSP\n   Problem:\n   o  Author ADMD advertises an ADSP policy\
    \ of \"dkim=discardable\"\n   o  Author sends DKIM-signed mail to a non-participating\
    \ MLM, which\n      invalidates the signature\n   o  Receiver MTA checks DKIM\
    \ and ADSP at SMTP time and is configured\n      to reject ADSP failures, so rejects\
    \ this message\n   o  process repeats a few times, after which the MLM unsubscribes\
    \ the\n      Receiver\n   Solution: MLMs should refuse mail from domains advertising\
    \ ADSP\n   policies of \"discardable\" unless the MLMs are certain they make no\n\
    \   changes that invalidate DKIM signatures.\n"
- title: B.2.  MLMs and FBLs
  contents:
  - "B.2.  MLMs and FBLs\n   Problem:\n   o  subscriber sends signed mail to a non-participating\
    \ MLM that does\n      not invalidate the signature\n   o  a recipient reports\
    \ the message as spam\n   o  FBL at recipient ADMD sends report to contributor\
    \ rather than list\n      manager\n   Solution: MLMs should sign mail they send\
    \ and might also strip\n   existing signatures.  FBLs should report to list operators\
    \ instead of\n   subscribers where such can be distinguished; otherwise, FBLs\
    \ should\n   report to all parties with valid signatures.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Murray S. Kucherawy\n   Cloudmark\n   128 King St., 2nd\
    \ Floor\n   San Francisco, CA  94107\n   USA\n   Phone: +1 415 946 3800\n   EMail:\
    \ msk@cloudmark.com\n"
