- title: __initial_text__
  contents:
  - '  La Posta Elettronica Certificata - Italian Certified Electronic Mail

    '
- title: Abstract
  contents:
  - "Abstract\n   Since 1997, the Italian laws have recognized electronic delivery\n\
    \   systems as legally usable.  In 2005, after two years of technical\n   tests,\
    \ the characteristics of an official electronic delivery\n   service, named certified\
    \ electronic mail (in Italian \"Posta\n   Elettronica Certificata\") were defined,\
    \ giving the system legal\n   standing.\n   The design of the entire system was\
    \ carried out by the National\n   Center for Informatics in the Public Administration\
    \ of Italy\n   (DigitPA), followed by efforts for the implementation and testing\
    \ of\n   the service.  The DigitPA has given the Italian National Research\n \
    \  Council (CNR), and in particular the Institute of Information Science\n   and\
    \ Technologies at the CNR (ISTI), the task of running tests on\n   providers of\
    \ the service to guarantee the correct implementation and\n   interoperability.\
    \  This document describes the certified email system\n   adopted in Italy.  It\
    \ represents the system as it is at the moment of\n   writing, following the technical\
    \ regulations that were written based\n   upon the Italian Law DPR.  November\
    \ 2, 2005.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It has been approved for\
    \ publication by the Internet\n   Engineering Steering Group (IESG).  Not all\
    \ documents approved by the\n   IESG are a candidate for any level of Internet\
    \ Standard; see Section\n   2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6109.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................5\n\
    \      1.1. Scope ......................................................5\n  \
    \    1.2. Notational Conventions .....................................6\n    \
    \       1.2.1. Requirement Conventions .............................6\n      \
    \     1.2.2. Acronyms ............................................6\n        \
    \   1.2.3. Terminology and Definitions .........................7\n   2. PEC Model\
    \ .......................................................8\n      2.1. System-Generated\
    \ Messages ..................................8\n           2.1.1. Message Types\
    \ ......................................10\n      2.2. Basic Structure ...........................................12\n\
    \           2.2.1. Access Point .......................................12\n  \
    \         2.2.2. Incoming Point .....................................14\n    \
    \       2.2.3. Delivery Point .....................................16\n      \
    \     2.2.4. Storage ............................................17\n        \
    \   2.2.5. Provider Service Mailbox ...........................17\n          \
    \ 2.2.6. Provider Service Email Address .....................17\n      2.3. Log\
    \ .......................................................17\n   3. Message Processing\
    \ .............................................18\n      3.1. Access Point ..............................................18\n\
    \           3.1.1. Formal Checks on Messages ..........................18\n  \
    \         3.1.2. Non-Acceptance PEC Notification Due to\n                  Formal\
    \ Exceptions ..................................19\n           3.1.3. Non-Acceptance\
    \ PEC Notification Due to\n                  Virus Detection ....................................20\n\
    \           3.1.4. Server-User Acceptance PEC Notification ............20\n  \
    \         3.1.5. PEC Transport Envelope .............................21\n    \
    \       3.1.6. Timeout Delivery Error PEC Notification ............23\n      3.2.\
    \ Incoming Point ............................................24\n           3.2.1.\
    \ Server-Server Acceptance PEC Notification ..........24\n           3.2.2. PEC\
    \ Anomaly Envelope ...............................25\n           3.2.3. Virus\
    \ Detection PEC Notification ...................27\n           3.2.4. Virus-Induced\
    \ Delivery Error PEC notification ......28\n      3.3. Delivery Point ............................................29\n\
    \           3.3.1. Checks on Incoming Messages ........................29\n  \
    \         3.3.2. Delivery PEC Notification ..........................29\n    \
    \       3.3.3. Non-Delivery PEC Notification ......................34\n      3.4.\
    \ Sender and Receiver Belonging to the Same Domain ..........34\n      3.5. Example:\
    \ Complete Transaction between Two PEC Domains .....34\n   4. Formats ........................................................35\n\
    \      4.1. Temporal Reference ........................................35\n  \
    \    4.2. User Date/Time ............................................36\n    \
    \  4.3. Format of a PEC Message Body ..............................36\n      \
    \     4.3.1. User Readable Text .................................37\n        \
    \   4.3.2. Original Message ...................................37\n          \
    \ 4.3.3. Certification Data .................................37\n      4.4. Certification\
    \ Data Scheme .................................37\n      4.5. PEC Providers Directory\
    \ Scheme ............................39\n           4.5.1. providerCertificateHash\
    \ Attribute ..................41\n           4.5.2. providerCertificate Attribute\
    \ ......................41\n           4.5.3. providerName Attribute .............................41\n\
    \           4.5.4. mailReceipt Attribute ..............................42\n  \
    \         4.5.5. managedDomains Attribute ...........................42\n    \
    \       4.5.6. LDIFLocationURL Attribute ..........................43\n      \
    \     4.5.7. providerUnit Attribute .............................43\n        \
    \   4.5.8. LDIFLocationURLObject Object Class .................44\n          \
    \ 4.5.9. Provider Object Class ..............................44\n           4.5.10.\
    \ LDIF File Example .................................44\n   5. Security-Related\
    \ Aspects .......................................48\n      5.1. Digital Signature\
    \ .........................................48\n      5.2. Authentication ............................................48\n\
    \      5.3. Secure Interaction ........................................49\n  \
    \    5.4. Virus .....................................................49\n    \
    \  5.5. S/MIME Certificate ........................................49\n      \
    \     5.5.1. Provider-Related Information (Subject) .............50\n        \
    \   5.5.2. Certificate Extensions .............................50\n          \
    \ 5.5.3. Example ............................................51\n      5.6. PEC\
    \ Providers Directory ...................................55\n   6. PEC System\
    \ Client Technical and Functional Prerequisites .......55\n   7. Security Considerations\
    \ ........................................55\n   8. IANA Considerations ............................................56\n\
    \      8.1. Registration of PEC Message Header Fields .................56\n  \
    \         8.1.1. Header Field: X-Riferimento-Message-ID: ............56\n    \
    \       8.1.2. Header Field: X-Ricevuta: ..........................56\n      \
    \     8.1.3. Header Field: X-VerificaSicurezza: .................57\n        \
    \   8.1.4. Header Field: X-Trasporto: .........................57\n          \
    \ 8.1.5. Header Field: X-TipoRicevuta: ......................57\n           8.1.6.\
    \ Header Field: X-Mittente: ..........................58\n      8.2. Registration\
    \ of LDAP Object Identifier Descriptors ........58\n           8.2.1. Registration\
    \ of Object Classes and\n                  Attribute Types ....................................58\n\
    \   9. References .....................................................59\n  \
    \    9.1. Normative References ......................................59\n    \
    \  9.2. Informative References ....................................61\n   10.\
    \ Acknowledgments ...............................................62\n   Appendix\
    \ A. Italian Fields and Values in English ..................63\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Since 1997, the Italian laws have recognized electronic\
    \ delivery\n   systems as legally usable.  In 2005, after two years of technical\n\
    \   tests, the characteristics of an official electronic delivery\n   service,\
    \ named certified electronic mail (in Italian Posta\n   Elettronica Certificata,\
    \ from now on \"PEC\") were defined, giving the\n   system legal standing.\n \
    \  This document represents the English version of the Italian\n   specifications\n\
    \   (http://www.digitpa.gov.it/sites/default/files/normativa/\n   Pec_regole_tecniche_DM_2-nov-2005.pdf);\
    \ the Italian version is the\n   normative PEC reference.\n   IETF review did\
    \ not result in community consensus.  Since this\n   specification describes existing\
    \ deployment and implementation, the\n   issues identified by the IETF community\
    \ have not been addressed in\n   this document.  However, these issues would need\
    \ to be addressed\n   before a successor to this document could be published.\
    \  At a\n   minimum, the successor document would need to include:\n   * A clear\
    \ statement of the requirements/goals that need to be\n      satisfied by the\
    \ protocol;\n   * A comprehensive diagram and description of the overall message\
    \ flow\n      and delivery sequence required to achieve the requirements;\n  \
    \ * Alignment with traditional terminology for IETF email and security\n   * A\
    \ review of prior art; and\n   * A replacement of the unregistered LDAP DN name\
    \ space used in this\n      specification, which may lead to conflict with other\
    \ registered or\n      unregistered names, with a registered name space.\n"
- title: 1.1.  Scope
  contents:
  - "1.1.  Scope\n   To ensure secure transactions over the Internet, cryptography\
    \ can be\n   associated with electronic messages in order to provide some\n  \
    \ guarantee on sender identity, message integrity, confidentiality, and\n   non-repudiation\
    \ of origin.  Many end-to-end techniques exist to\n   accomplish such goals, and\
    \ some offer a high level of security.  The\n   downside of end-to-end cryptography\
    \ is the need for an extensive\n   penetration of technology in society, because\
    \ it is essential for\n   every user to have asymmetric keys and certificates\
    \ signed by a\n   Certification Authority.  Along with that, users would need\
    \ to have\n   an adequate amount of knowledge regarding the use of such technology.\n\
    \   PEC, on the other hand, uses applications running on servers to\n   digitally\
    \ sign messages, thus avoiding the complexity end-to-end\n   systems bring about.\
    \  By doing so, the user need only have an\n   ordinary mail client with which\
    \ to interact.  The downside is that\n   the level of security drops, since the\
    \ protection does not cover the\n   entire transaction.  Nonetheless, application\
    \ is simpler and does not\n   require specific user skills, making it easily more\
    \ widespread among\n   users.\n   This document describes PEC's technical aspects\
    \ and features.  It\n   presents the details of the protocol and the messages\
    \ that are sent\n   between service providers, introducing the system adopted\
    \ by the\n   Italian government for the exchange of certified emails.\n"
- title: 1.2.  Notational Conventions
  contents:
  - '1.2.  Notational Conventions

    '
- title: 1.2.1.  Requirement Conventions
  contents:
  - "1.2.1.  Requirement Conventions\n   The key words \"MUST\", \"MUST NOT\", \"\
    REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [REQ].\n"
- title: 1.2.2.  Acronyms
  contents:
  - "1.2.2.  Acronyms\n      CMS:      Cryptographic Message Syntax\n      CNIPA:\
    \    Italian National Agency for Digital Administration\n                (Centro\
    \ Nazionale per l'Informatica nella Pubblica\n                Amministrazione)\n\
    \      CNR:      Italian National Research Council (Consiglio Nazionale\n    \
    \            delle Ricerche)\n      CRL:      Certificate Revocation List\n  \
    \    CRL DP:   Certificate Revocation List Distribution Point\n      DNS:    \
    \  Domain Name Service\n      DTD:      Document Type Definition\n      FQDN:\
    \     Fully Qualified Domain Name\n      ISTI:     The Institute of Information\
    \ Science and Technologies\n                at the CNR (Istituto di Scienza e\
    \ Tecnologie\n                dell'Informazione \"A.Faedo\")\n      LDAP:    \
    \ Lightweight Directory Access Protocol\n      LDIF:     LDAP Data Interchange\
    \ Format\n      MIME:     Multipurpose Internet Mail Extensions\n      PEC:  \
    \    Certified Electronic Mail (Posta Elettronica\n                Certificata)\n\
    \      S/MIME:   Secure/MIME\n      SMTP:     Simple Mail Transfer Protocol\n\
    \      TLS:      Transport Layer Security\n      XML:      eXtensible Markup Language\n"
- title: 1.2.3.  Terminology and Definitions
  contents:
  - "1.2.3.  Terminology and Definitions\n   Certification data: A set of data certified\
    \ by the sender's PEC\n   provider that describes the original message.  It includes\
    \ the date\n   and time of dispatch, sender email address, recipient(s) email\n\
    \   address(es), subject, and message identifier.\n   Certified electronic mail:\
    \ A service based on electronic mail, as\n   defined by the [EMAIL] and [SMTP]\
    \ standards and extensions, which\n   permits the transmission of documents produced\
    \ with informatics\n   tools.\n   DigitPA: Ex-CNIPA.\n   Holder: The person or\
    \ organization to whom a PEC mailbox is assigned.\n   Message sent: A PEC message\
    \ is considered sent when the sender's PEC\n   provider, after several checks,\
    \ accepts the email and returns a\n   server-user acceptance PEC notification\
    \ to the sender.\n   Message received: A PEC message is considered received when\
    \ it is\n   stored in the receiver's mailbox, after which the receiver PEC\n \
    \  provider returns a delivery PEC notification to the sender.\n   Msgid: Is the\
    \ message identifier generated by the email client, as\n   defined in [EMAIL],\
    \ before the message is submitted to the PEC\n   system.\n   Ordinary mail: Non-PEC\
    \ email messages.\n   Original message: Is the user-generated message before its\
    \ arrival to\n   the sender Access Point.  The original message is delivered to\
    \ the\n   recipient inside a PEC transport envelope.\n   PEC domain: Corresponds\
    \ to a DNS domain dedicated to the holders'\n   mailboxes.\n   PEC mailbox: An\
    \ electronic mailbox for which delivery PEC\n   notifications are issued upon\
    \ reception of PEC messages.  Such a\n   mailbox can be defined exclusively within\
    \ a PEC domain.\n   PEC msgid: Is a unique identifier generated by the PEC system,\
    \ which\n   will substitute the msgid.\n   PEC provider: The entity that handles\
    \ one or more PEC domains with\n   their relative points of Access, Reception,\
    \ and Delivery.  It is the\n   holder of the key that is used for signing PEC\
    \ notifications and\n   envelopes, and it interacts with other PEC providers for\n\
    \   interoperability with other holders.\n   PEC provider's key: Is a key released\
    \ by DigitPA to every PEC\n   provider.  It is used to sign PEC notifications\
    \ and envelopes and to\n   authorize access to the PEC providers directory.\n\
    \   PEC providers directory: Is an LDAP server positioned in an area\n   reachable\
    \ by all PEC service providers.  It constitutes the technical\n   structure related\
    \ to the public list of PEC service providers and\n   contains the list of PEC\
    \ domains and service providers with relevant\n   certificates.\n   Service mailbox:\
    \ A mailbox for the sole use of the provider,\n   dedicated for the reception\
    \ of server-server acceptance and virus\n   detection PEC notifications.\n   Time\
    \ stamp: Digital evidence with which a temporal reference, that\n   can't be repudiated,\
    \ is attributed to one or more documents.\n"
- title: 2.  PEC Model
  contents:
  - '2.  PEC Model

    '
- title: 2.1.  System-Generated Messages
  contents:
  - "2.1.  System-Generated Messages\n   The PEC system generates messages in MIME\
    \ format composed of a\n   descriptive textual part and other [MIME1] parts, the\
    \ number and\n   content of which varies according to the type of message generated.\n\
    \   A system-generated message falls into one of the following\n   categories:\n\
    \   o  Notifications;\n   o  Envelopes.\n   The message is inserted in an S/MIME\
    \ v3 structure in CMS format and\n   signed with the PEC provider's private key.\
    \  The X.509v3 certificate\n   associated with the key MUST be included in the\
    \ aforementioned\n   structure.  The S/MIME format used to sign system-generated\
    \ messages\n   is the \"multipart/signed\" format (.p7s), as described in section\n\
    \   3.4.3 of [SMIMEV3].\n   To guarantee the verifiability of signatures on as\
    \ many mail clients\n   as possible, X.509v3 certificates used by certified email\
    \ systems\n   MUST abide by the profile found in section 6.5.\n   In order for\
    \ the receiving mail client to verify the signature, the\n   sender address MUST\
    \ coincide with the one indicated within the\n   X.509v3 certificate.  For this\
    \ mechanism, PEC transport envelopes\n   MUST indicate in the \"From:\" field\
    \ a single author's address which is\n   different from the one contained in the\
    \ original message.  To allow\n   for better message usability by the receiving\
    \ user, the author's mail\n   address in the original message is inserted as a\
    \ \"display name\".  For\n   example, a \"From:\" field such as:\n         From:\
    \ \"John Smith\" <john.smith@domain.example.com>\n   would result in the following\
    \ \"From:\" value in the respective PEC\n   transport envelope:\n         From:\
    \ \"On behalf of: john.smith@domain.example.com\"\n                          \
    \        <certified-mail@provider.example.com>\n   Both \"From:\" and \"Sender:\"\
    \ fields MUST contain the same value.  In\n   order for replies to be correctly\
    \ sent back to the proper\n   destination, the \"Reply-To:\" field in the PEC\
    \ transport envelope MUST\n   contain the same unaltered value of the original\
    \ message's\n   \"Reply-To:\" field.  When it is not explicitly specified in the\n\
    \   original message, the system that generates the PEC transport\n   envelope\
    \ creates it by extracting the information from the \"From:\"\n   field in the\
    \ original message.\n   When PEC notifications are sent, the system MUST use the\
    \ original\n   message sender's address as the destination address, as is specified\n\
    \   in the reverse path data of the SMTP protocol.  PEC notifications\n   MUST\
    \ be sent to the sender's PEC mailbox without taking into account\n   the \"Reply-To:\"\
    \ field, which might be present in the original\n   message's header.\n   All\
    \ system-generated PEC messages are identifiable for having a\n   specific header\
    \ defined in PEC according to the type of message\n   generated.\n   To determine\
    \ the certification data, the elements used for the actual\n   routing of the\
    \ message are employed.  In SMTP dialog phases, the\n   reverse path and forward\
    \ path data (\"MAIL FROM\" and \"RCPT TO\"\n   commands) are thus considered certification\
    \ data of both the sender\n   and the recipients, respectively.  Addressing data\
    \ present in the\n   message body (\"To:\" and \"Cc:\" fields) are used solely\
    \ in order to\n   discriminate between primary and carbon copy recipients when\n\
    \   necessary; addressing data present in the \"Bcc:\" field MUST be\n   considered\
    \ invalid by the system.\n"
- title: 2.1.1.  Message Types
  contents:
  - "2.1.1.  Message Types\n   All system-generated messages inherit their header\
    \ fields and values\n   from the original message, with extra fields added according\
    \ to the\n   type of message generated.\n"
- title: 2.1.1.1.  PEC Notifications
  contents:
  - "2.1.1.1.  PEC Notifications\n   They have the purpose of informing the sending\
    \ user and interacting\n   providers of the progress the message is making within\
    \ the PEC\n   network.\n"
- title: 2.1.1.1.1.  Success PEC Notifications
  contents:
  - "2.1.1.1.1.  Success PEC Notifications\n   These notifications indicate an acknowledgment\
    \ on the provider's side\n   for the reception or handling of a PEC message. \
    \ More specifically,\n   it can indicate one of three situations: server-user\
    \ acceptance,\n   server-server acceptance, or delivery.\n   Added header fields\
    \ are:\n   o  X-Ricevuta:\n   o  X-Riferimento-Message-ID:\n   The field \"X-Ricevuta:\"\
    \ indicates the type of PEC notification\n   contained in the message, whereas\
    \ \"X-Riferimento-Message-ID:\"\n   contains the message identifier generated\
    \ by the mail client (msgid).\n   Body contents differ according to notification\
    \ type.  This is\n   described more thoroughly in section 3.\n   o  A server-user\
    \ acceptance PEC notification informs the user that\n      his provider has accepted\
    \ the message and will be taking care of\n      passing it on to the provider(s)\
    \ of the addressee(s).\n   o  A server-server acceptance PEC notification is an\
    \ inter-provider\n      communication only, it MUST NOT be sent to the users.\
    \  With this\n      notification, the receiving provider simply informs the sending\n\
    \      one that it has received a PEC message, and will take the\n      responsibility\
    \ of forwarding it to the addressee(s).  From then\n      on, the sender provider\
    \ is no longer held responsible as to the\n      whereabouts of the message, but\
    \ is limited to notifying its user\n      of the success or failure of delivery.\n\
    \   o  Delivery PEC notifications take place as the final communication\n    \
    \  of a transaction, indicating overall success in handing the\n      message\
    \ over to the addressee(s).\n"
- title: 2.1.1.1.2.  Delay PEC Notifications
  contents:
  - "2.1.1.1.2.  Delay PEC Notifications\n   Delay PEC notifications are sent out\
    \ 12 hours after a message has\n   been dispatched from the sending provider,\
    \ and no server-server\n   acceptance or delivery PEC notification has been received.\
    \  These\n   have the sole purpose of notifying the user of the delay.\n   If\
    \ another 12 hours go by without any sign of a server-server\n   acceptance or\
    \ delivery PEC notification (amounting to a 24-hour\n   delay), another delay\
    \ PEC notification is dispatched to the user\n   informing him of the possible\
    \ delivery failure.  The provider will\n   not keep track of the delay any further.\n"
- title: 2.1.1.1.3.  Failure PEC Notifications
  contents:
  - "2.1.1.1.3.  Failure PEC Notifications\n   They are sent when there is some error\
    \ in transmission or reception.\n   More specifically, a failure PEC notification\
    \ can indicate either a\n   formal-exception error or a virus detection.\n   Added\
    \ header fields are:\n   o  X-Ricevuta:\n   o  X-Riferimento-Message-ID:\n   o\
    \  X-VerificaSicurezza: [optional]\n   \"X-Ricevuta:\" and \"X-Riferimento-Message-ID:\"\
    \ have the same role as\n   indicated in section 2.1.1.1.1 (Success Notifications).\n\
    \   \"X-VerificaSicurezza:\" (security verification) is an optional header\n \
    \  field, used for virus-related PEC notifications.\n   Body contents differ according\
    \ to notification type.  This is\n   described more thoroughly in section 3.\n"
- title: 2.1.1.2.  PEC Envelopes
  contents:
  - "2.1.1.2.  PEC Envelopes\n   Messages entering the PEC network are inserted within\
    \ specific PEC\n   messages, called envelopes, before they are allowed to circulate\n\
    \   further within the network.  These envelopes MUST inherit the\n   following\
    \ header fields, along with their unmodified values, from the\n   message itself:\n\
    \   o  Received:\n   o  To:\n   o  Cc:\n   o  Return-Path:\n   o  Reply-To: (if\
    \ present)\n   Depending on the type of message requesting admission into the\
    \ PEC\n   network, it will be inserted in either a PEC transport envelope or a\n\
    \   PEC anomaly envelope.  Distinction will be possible through the\n   addition\
    \ of the \"X-Trasporto:\" header field.\n"
- title: 2.2.  Basic Structure
  contents:
  - "2.2.  Basic Structure\n                +-------------+               +------------+\n\
    \                |    +--+     |               |            |\n              \
    \  |    |AP|     |      PEC      |            |\n      +----+    |    +--+   \
    \  |   messages &  | +---+ +--+ |    +----+\n      |user|<-->|             |<------------->|\
    \ |InP| |DP| |<-->|user|\n      +----+    | +--+  +---+ | notifications | +---+\
    \ +--+ |    +----+\n                | |DP|  |InP| |               |          \
    \  |\n                | +--+  +---+ |               |            |\n         \
    \       +-------------+               +------------+\n                     PEC\
    \                            PEC\n                    sender                 \
    \       receiver\n                   provider                       provider\n\
    \      where:\n      AP = Access Point\n      DP = Delivery Point\n      InP =\
    \ Incoming Point\n"
- title: 2.2.1.  Access Point
  contents:
  - "2.2.1.  Access Point\n   This is what the user client at the sender side interacts\
    \ with,\n   giving the user access to PEC services set up by the provider.\n \
    \  Such access MUST be preceded by user authentication on the system\n   (see\
    \ section 5.2).  The Access Point receives the original messages\n   its user\
    \ wishes to send, runs some formal checks, and acts according\n   to the outcome:\n\
    \   o  if the message passes all checks, the Access Point generates a\n      server-user\
    \ acceptance PEC notification and inserts the original\n      message inside a\
    \ PEC transport envelope;\n   o  if a formal exception is detected, the Access\
    \ Point refuses the\n      message and emits the relevant non-acceptance PEC notification\n\
    \      (see section 3.1.1);\n   o  if a virus is detected, the Access Point generates\
    \ a non-\n      acceptance PEC notification and inserts the original message as\
    \ is\n      in the provider's special store.\n   Generation of the server-user\
    \ acceptance notification indicates to\n   the user that the message was accepted\
    \ by the system, certifying also\n   the date and time of the event.  The notification\
    \ MUST contain user-\n   readable text, and an XML part containing the certification\
    \ data.\n   The notification MAY also contain other attachments for extra\n  \
    \ features offered by the provider.\n   Using the data available in the PEC providers\
    \ directory (see section\n   4.5), the Access Point runs checks on every recipient\
    \ in the \"To:\"\n   and \"Cc:\" fields present in the original message to verify\
    \ whether\n   they belong to the PEC infrastructure or to non-PEC domains.  Such\n\
    \   checks are done by verifying the existence, through a case-\n   insensitive\
    \ search, of the recipients' domains in the\n   \"managedDomains\" attribute found\
    \ within the PEC providers directory.\n   Therefore, the server-user acceptance\
    \ PEC notification (and relevant\n   certification data) relates to, for each\
    \ address, the typology of its\n   domain; PEC or non-PEC.\n   The message identifier\
    \ (PEC msgid) of accepted original messages\n   within the PEC infrastructure\
    \ MUST be unambiguous in order to consent\n   correct tracking of messages and\
    \ relative PEC notifications.  The\n   format of such an identifier is:\n    \
    \    [alphanumeric string]@[provider mail domain]\n   or:\n        [alphanumeric\
    \ string]@[FQDN mail server]\n   Therefore, both the original message and the\
    \ corresponding PEC\n   transport envelope MUST contain the following header field:\n\
    \        Message-ID: <[unique identifier]>\n   When an email client that is interacting\
    \ with the Access Point has\n   already inserted a message identifier (msgid)\
    \ in the original\n   message, that msgid SHALL be substituted by a PEC msgid.\
    \  In order to\n   allow the sender to link the message sent with the relative\
    \ PEC\n   notifications, the msgid MUST be inserted in the original message as\n\
    \   well as the relative PEC notifications and transport envelope.  If\n   present,\
    \ the msgid is REQUIRED in the original message's header by\n   adding the following\
    \ header field:\n        X-Riferimento-Message-ID: <[msgid]>\n   which will also\
    \ be inserted in the PEC transport envelope and\n   notifications, and related\
    \ in the certification data (see section\n   4.4).\n"
- title: 2.2.2.  Incoming Point
  contents:
  - "2.2.2.  Incoming Point\n   This point permits the exchange of PEC messages and\
    \ notifications\n   between PEC providers.  It is also the point through which\
    \ ordinary\n   mail messages can be inserted within the system of certified mail.\n\
    \   The exchange of messages between providers takes place through SMTP-\n   based\
    \ transactions, as defined in [SMTP].  If SMTP communication\n   errors occur,\
    \ they MAY be handled using the standard error\n   notification mechanisms, as\
    \ provided by SMTP in [SMTP] and\n   [SMTP-DSN].  The same mechanism is also adopted\
    \ for handling\n   transitory errors, that result in long idling periods, during\
    \ an SMTP\n   transmission phase.  In order to guarantee that an error is returned\n\
    \   to the user, as defined in section 3.3.3, the system that handles PEC\n  \
    \ traffic MUST adopt a time limit for message idleness equal to 24\n   hours.\n\
    \   Once a message arrives, the Incoming Point runs the following list of\n  \
    \ checks and operations:\n   o  verifies correctness and type of the incoming\
    \ message;\n   o  if the incoming message is a correct and undamaged PEC transport\n\
    \      envelope:\n      - emits a server-server acceptance PEC notification towards\
    \ the\n        sender provider (section 3.2.1);\n      - forwards the PEC transport\
    \ envelope to the Delivery Point\n        (section 3.3).\n   o  if the incoming\
    \ message is a correct and undamaged PEC\n      notification, forwards the notification\
    \ to the Delivery Point.\n   o  if the incoming message does not conform to the\
    \ prerequisites of a\n      correct and undamaged PEC transport envelope or notification,\
    \ but\n      comes from a PEC provider, i.e., passes the verifications\n     \
    \ regarding existence, origin, and validity of the signature, then\n      the\
    \ message MUST be propagated towards the recipient.\n      Therefore, the Incoming\
    \ Point:\n      -  inserts the incoming message in a PEC anomaly envelope (section\n\
    \         3.2.2);\n      -  forwards the PEC anomaly envelope to the Delivery\
    \ Point.\n   o  if the incoming message does not originate from a PEC system,\n\
    \      i.e., fails verifications regarding existence, origin, and\n      validity\
    \ of the signature, then the message will be treated as\n      ordinary email,\
    \ and, if propagated to the recipient:\n      - is inserted in a PEC anomaly envelope\
    \ (section 3.2.2);\n      - the PEC anomaly envelope is forwarded to the Delivery\
    \ Point.\n      The server-server acceptance PEC notification is generated by\
    \ the\n      receiving provider and sent to the sending provider.  Its purpose\n\
    \      is to keep track of the message in its transition from one\n      provider\
    \ to another, and is therefore strictly intra-provider\n      communication; the\
    \ end user knows nothing about it.\n      To check the correctness and integrity\
    \ of a PEC transport envelope\n      or notification, the Incoming Point runs\
    \ the following tests:\n   o  Signature existence - the system verifies the presence\
    \ of an\n      S/MIME signature structure within the incoming message;\n   o \
    \ Signature origin - the system verifies whether or not the\n      signature belongs\
    \ to a PEC provider by extracting the certificate\n      used for signing and\
    \ verifying its presence in the PEC providers\n      directory.  To ease the check,\
    \ it is possible to calculate the\n      certificate's [SHA1] hash value and perform\
    \ a case-insensitive\n      search of its hexadecimal representation within the\n\
    \      \"providerCertificateHash\" attribute found in the PEC providers\n    \
    \  directory.  This operation allows one to easily identify the\n      sender\
    \ provider for subsequent and necessary matching checks\n      between the extracted\
    \ certificate and the one present in the\n      provider's record;\n   o  Signature\
    \ validity - S/MIME signature correctness is verified by\n      recalculating\
    \ the signature value, checking the entire\n      certification path, and verifying\
    \ the [CRL] and temporal validity\n      of the certificate.  In case some caching\
    \ mechanism is used for\n      CRL contents, an update interval MUST be adopted\
    \ so that the most\n      up-to-date data is guaranteed, thus minimizing the possible\
    \ delay\n      between a publication revocation by the Certification Authority\n\
    \      and the variation acknowledgment by the provider;\n   o  Formal correctness\
    \ - the provider performs sufficient and\n      necessary checks to guarantee\
    \ that the incoming message is\n      compliant with the formats specified in\
    \ this document (PEC\n      transport envelope and notifications).\n      If a\
    \ virus-infected PEC transport envelope passes the checks just\n      mentioned,\
    \ it is still considered correct and undamaged.  The\n      presence of the virus\
    \ will be detected in a second phase, during\n      which the contents of the\
    \ PEC transport envelope are verified.\n      Thus, the Incoming Point will refrain\
    \ from forwarding the message\n      to the recipient, instead sending the appropriate\
    \ PEC notification\n      of non-delivery and storing the virus-infected message\
    \ in the\n      provider's special storage.\n      In case ordinary mail messages\
    \ are received, the PEC provider\n      SHALL perform virus checks in order to\
    \ prevent the infiltration of\n      potentially dangerous mail messages within\
    \ the PEC system.  If a\n      virus is detected in an ordinary mail message,\
    \ the latter can be\n      discarded at the Incoming Point before it enters the\
    \ PEC system.\n      In other words, no special treatment is reserved for the\
    \ error; it\n      is handled in a manner that is conformant to the procedures\n\
    \      usually followed for messages going through the Internet.\n      When the\
    \ receiving provider detects a virus inside a PEC transport\n      envelope during\
    \ the reception phase, it emits a virus detection\n      PEC notification to the\
    \ sending provider, which then realizes its\n      checks failed to detect that\
    \ virus.  When this happens, the\n      sending provider MUST:\n   o  check what\
    \ virus typologies were not detected by its own antivirus\n      to verify the\
    \ possibility of interventions\n   o  send a virus-induced non-delivery PEC notification\
    \ to the sender's\n      mailbox.\n"
- title: 2.2.3.  Delivery Point
  contents:
  - "2.2.3.  Delivery Point\n   This point is the point that receives messages from\
    \ the Incoming\n   Point and forwards them to the final recipient.\n   It MUST\
    \ run a series of tests on received messages before forwarding\n   them to the\
    \ user (see section 3.3.1).  It first verifies the typology\n   of the message\
    \ and decides whether or not a PEC notification should\n   be issued to the sender.\
    \  The delivery PEC notification (section\n   3.3.2) is emitted after the message\
    \ was delivered to the recipient's\n   PEC mailbox and only at reception of a\
    \ valid PEC transport envelope\n   (sections 2.2.2 and 3.1.5).\n   In all other\
    \ cases, such as PEC anomaly envelopes and PEC\n   notifications, the delivery\
    \ PEC notification is not emitted.\n   Regardless, the message received from the\
    \ Delivery Point MUST be\n   delivered unmodified to the recipient's mailbox.\n\
    \   The delivery PEC notification indicates to the sender that the\n   message\
    \ sent was in fact conveyed to the specified recipient's\n   mailbox and certifies\
    \ the date and time of delivery through use of\n   user-readable text and an XML\
    \ part containing certification data,\n   along with other possible attachments\
    \ added for extra features\n   offered by the provider.\n   If a PEC transport\
    \ envelope received at the Delivery Point can't be\n   delivered to the destination\
    \ mailbox, the Delivery Point emits a non-\n   delivery PEC notification (section\
    \ 3.3.3).  If, on the other hand,\n   the delivery error concerns a message that\
    \ arrives from Internet\n   (i.e., a non-PEC message), no such notification is\
    \ emitted.\n"
- title: 2.2.4.  Storage
  contents:
  - "2.2.4.  Storage\n   Each provider MUST dedicate a special storage for the deposition\
    \ of\n   any virus-infected messages encountered.  Whether the virus be\n   detected\
    \ by the sender's Access Point or the receiver's Incoming\n   Point, the provider\
    \ that detects it MUST store the mail message in\n   its own storage, and keep\
    \ it for 30 months.\n"
- title: 2.2.5.  Provider Service Mailbox
  contents:
  - "2.2.5.  Provider Service Mailbox\n   For exclusive use of the provider, dedicated\
    \ to the reception of PEC\n   notifications in two cases only:\n   o  server-server\
    \ acceptance notification; and\n   o  virus detection notification.\n"
- title: 2.2.6.  Provider Service Email Address
  contents:
  - "2.2.6.  Provider Service Email Address\n   Each provider MUST register a special\
    \ purpose email address for use\n   when sending PEC transport envelopes and notifications,\
    \ as delineated\n   in section 3.  This address MAY coincide with that of the\
    \ service\n   mailbox described in section 2.2.5.\n"
- title: 2.3.  Log
  contents:
  - "2.3.  Log\n   The server administrator MUST keep track of any and all operations\n\
    \   carried out in a specific message log file.  The information kept in\n   the\
    \ log for each operation is the following:\n   o  message identifier (msgid)\n\
    \   o  date and time of event\n   o  sender of original message\n   o  recipient(s)\
    \ of original message\n   o  subject of original message\n   o  event type (reception,\
    \ delivery, PEC notification emission, etc.)\n   o  message identifiers of related\
    \ generated messages\n   o  sending provider\n   The service provider MUST store\
    \ this data and preserve it unmodified.\n   Italian laws have specified that the\
    \ service provider retain the data\n   for 30 months.\n"
- title: 3.  Message Processing
  contents:
  - '3.  Message Processing

    '
- title: 3.1.  Access Point
  contents:
  - "3.1.  Access Point\n   The Access Point acts as a submission service as defined\
    \ in\n   [SUBMISSION].\n"
- title: 3.1.1.  Formal Checks on Messages
  contents:
  - "3.1.1.  Formal Checks on Messages\n   When the Access Point receives a message\
    \ the user wishes to send, it\n   MUST guarantee said message's formal conformity\
    \ as defined in\n   [EMAIL], and verify that the:\n   o  [EMAIL] header section\
    \ contains a \"From:\" header field holding an\n      [EMAIL] compliant email\
    \ address;\n   o  [EMAIL] header section contains a \"To:\" header field holding\
    \ one\n      or more [EMAIL] compliant email addresses;\n   o  sender's address,\
    \ specified in the SMTP reverse path, coincides\n      with the one in the message's\
    \ \"From:\" header field;\n   o  recipients' addresses specified in the SMTP forward\
    \ path coincide\n      with the ones present in the \"To:\" or \"Cc:\" header\
    \ fields of the\n      message;\n   o  \"Bcc:\" header field does not contain\
    \ any value;\n   o  total message size falls within the limits accepted by the\n\
    \      provider.  Such limits apply depending on the number of recipients\n  \
    \    as well; by multiplying it to the message size, the outcome MUST\n      fall\
    \ within the limits accepted by the provider.  Italian laws\n      have specified\
    \ this limit as being 30 MB.\n   If the message does not pass the tests, the Access\
    \ Point MUST NOT\n   accept the message within the PEC system, thus emitting the\
    \ relative\n   PEC notification of non-acceptance.\n"
- title: 3.1.2.  Non-Acceptance PEC Notification Due to Formal Exceptions
  contents:
  - "3.1.2.  Non-Acceptance PEC Notification Due to Formal Exceptions\n   When the\
    \ Access Point cannot forward the message received due to\n   failure in passing\
    \ formal checks, the sender is notified of such an\n   outcome.  If the error\
    \ is caused by the message failing size checks,\n   a non-acceptance PEC notification\
    \ is sent as long as the size remains\n   bound by a certain limit.  If the size\
    \ exceeds said limit, error\n   handling is left to SMTP.\n   The notification\
    \ header will contain the following fields:\n        X-Ricevuta: non-accettazione\n\
    \        Date: [date of notification emission]\n        Subject: AVVISO DI NON\
    \ ACCETTAZIONE: [original subject]\n        From: posta-certificata@[mail domain]\n\
    \        To: [original sender]\n        X-Riferimento-Message-ID: [msgid]\n  \
    \ The notification body will contain a text part that constitutes the\n   actual\
    \ notification in readable format according to a model that\n   relates the following\
    \ information:\n      Error in message acceptance\n      On [date] at [time] ([time\
    \ zone]), in the message \"[subject]\"\n      originating from \"[original sender]\"\
    \ and addressed to:\n      [recipient_1]\n      [recipient_2]\n      [recipient_n]\n\
    \      a problem was detected that prevents its acceptance due to\n      [error\
    \ description].\n      The message was not accepted.\n      Message identifier:\
    \ [PEC msgid of corresponding\n      PEC transport envelope]\n   The same certification\
    \ information is inserted in an XML file to be\n   added to the notification body,\
    \ thus allowing automatic checks on the\n   message (section 4.4).  Parsing MUST\
    \ be done on the XML part only.\n   Additional parts MAY be included by the provider\
    \ for provider-\n   specific services.  Regardless, the original message MUST\
    \ NOT be\n   included.  The message MUST follow the format described in section\n\
    \   4.3.\n"
- title: 3.1.3.  Non-Acceptance PEC Notification Due to Virus Detection
  contents:
  - "3.1.3.  Non-Acceptance PEC Notification Due to Virus Detection\n   The Access\
    \ Point MUST run some tests on the content of messages it\n   receives from its\
    \ users and reject them if a virus is detected.  In\n   which case, a virus-detection-induced\
    \ non-acceptance PEC notification\n   MUST be emitted to clearly inform the user\
    \ of the reason the message\n   was refused.\n   The notification header contains\
    \ the following fields:\n      X-Ricevuta: non-accettazione\n      X-VerificaSicurezza:\
    \ errore\n      Date: [notification emission date]\n      Subject: AVVISO DI NON\
    \ ACCETTAZIONE PER VIRUS: [original\n               subject]\n      From: posta-certificata@[mail\
    \ domain]\n      To: [original sender]\n      X-Riferimento-Message-ID: [msgid]\n\
    \   The body contains a readable text part according to the following\n   model:\n\
    \      Error in message acceptance due to virus presence\n      On [date] at [time]\
    \ ([time zone]), in the message \"[subject]\"\n      originating from \"[original\
    \ sender]\" and addressed to:\n      [recipient_1]\n      [recipient_2]\n    \
    \  [recipient_n]\n      a security problem was detected [ID of detected content\
    \ type].\n      The message was not accepted.\n      Message identifier: [PEC\
    \ msgid of corresponding\n      PEC transport envelope]\n   The same certification\
    \ data is inserted in an XML file added to the\n   notification to allow for automatic\
    \ checks (section 4.4).  Parsing\n   MUST be done on the XML part only.  Additional\
    \ parts MAY be included\n   by the provider for provider-specific services.  Regardless,\
    \ the\n   original message MUST NOT be included.  The message MUST follow the\n\
    \   format described in section 4.3.\n"
- title: 3.1.4.  Server-User Acceptance PEC Notification
  contents:
  - "3.1.4.  Server-User Acceptance PEC Notification\n   The server-user acceptance\
    \ PEC notification is a message sent to the\n   sender by his server, containing\
    \ date and time of message acceptance\n   into the system, sender and recipient\
    \ data, and subject.\n   The header contains the following fields:\n      X-Ricevuta:\
    \ accettazione\n      Date: [actual date of server-user acceptance]\n      Subject:\
    \ ACCETTAZIONE: [original subject]\n      From: posta-certificata@[mail domain]\n\
    \      To: [original sender]\n      X-Riferimento-Message-ID: [msgid]\n   The\
    \ message body contains a text part that constitutes the\n   notification in readable\
    \ format, according to a model that relates\n   the following information:\n \
    \     Server-User Acceptance PEC notification\n      On [date] at [time] ([time\
    \ zone]), the message \"[subject]\"\n       originating from \"[original sender]\"\
    \ and addressed to:\n      [recipient_1] ([\"certified mail\" | \"ordinary mail\"\
    ])\n      [recipient_2] ([\"certified mail\" | \"ordinary mail\"])\n      [recipient_n]\
    \ ([\"certified mail\" | \"ordinary mail\"])\n      was accepted by the system\
    \ and forwarded to the recipient(s).\n      Message identifier: [PEC msgid of\
    \ corresponding\n      PEC transport envelope]\n   The same certification data\
    \ is inserted in an XML file added to the\n   notification message, allowing automatic\
    \ checks on it (section 4.4).\n   Parsing MUST be done on the XML part only. \
    \ Additional parts MAY be\n   included by the provider for provider-specific services.\
    \  The message\n   MUST follow the format described in section 4.3.\n"
- title: 3.1.5.  PEC Transport Envelope
  contents:
  - "3.1.5.  PEC Transport Envelope\n   A PEC transport envelope is a message generated\
    \ by the Access Point\n   that contains the original message as well as certification\
    \ data.\n   As mentioned in section 2.1.1.2, the PEC transport envelope inherits\n\
    \   from the original message the values of the following header fields,\n   which\
    \ MUST be related unmodified:\n   o  Received:\n   o  To:\n   o  Cc:\n   o  Return-Path:\n\
    \   o  Reply-To: (if present)\n   On the other hand, the following fields MUST\
    \ be modified, or inserted\n   if necessary:\n      X-Trasporto: posta-certificata\n\
    \      Date: [actual date of server-user acceptance]\n      Subject: POSTA CERTIFICATA:\
    \ [original subject]\n      From: \"On behalf of: [original sender]\"\n      \
    \                     <certified-mail@[mail_domain]>\n      Reply-To: [original\
    \ sender] (inserted only if not present)\n      Message-ID: [PEC msgid generated\
    \ as in section 2.2.1]\n      X-Riferimento-Message-ID: [msgid]\n      X-TipoRicevuta:\
    \ [completa/breve/sintetica]\n   The \"X-TipoRicevuta:\" field indicates the type\
    \ of delivery PEC\n   notification the sender wishes to receive -- complete, brief,\
    \ or\n   concise.\n   The body of the PEC transport envelope contains a text part\
    \ that\n   constitutes the readable format of the message according to a model\n\
    \   that relates the following certification data:\n      Certified mail message\n\
    \      On [date] at [time] ([time zone]), the message \"[subject]\" was\n    \
    \  sent by \"[original sender]\" and addressed to:\n      [recipient_1]\n    \
    \  [recipient_2]\n      [recipient_n]\n      The original message is included\
    \ in attachment.\n      Message identifier: [PEC msgid of corresponding\n    \
    \  PEC transport envelope]\n   Within the PEC transport envelope, the entire,\
    \ non-modified original\n   message is inserted in a format compliant with [EMAIL]\
    \ (except for\n   what has been said regarding the message identifier), as well\
    \ as an\n   XML part, which contains the certification data that was already\n\
    \   related in text format, and information on the type of message and\n   PEC\
    \ notification requested (section 4.4).  Parsing MUST be done on\n   the XML part\
    \ only.  Additional parts MAY be included by the provider\n   for provider-specific\
    \ services.  The message MUST follow the format\n   described in section 4.3.\n\
    \   Note that the routing data of the PEC transport envelope (forward and\n  \
    \ reverse paths) remain unaltered.\n"
- title: 3.1.6.  Timeout Delivery Error PEC Notification
  contents:
  - "3.1.6.  Timeout Delivery Error PEC Notification\n   If the sending provider doesn't\
    \ receive a server-server acceptance or\n   delivery PEC notification from the\
    \ receiving provider within 12 hours\n   of the message dispatch, it informs the\
    \ user that the recipient's\n   provider might not be able to deliver the message.\
    \  In case the\n   sending provider doesn't receive a delivery PEC notification\
    \ within\n   24 hours after message dispatch, it emits another non-delivery PEC\n\
    \   notification to the user by the 24-hour timeout, but not before 22\n   hours\
    \ have passed.\n   Such a communication takes place through a PEC notification\
    \ of non-\n   delivery due to timeout, the header of which contains the following\n\
    \   fields:\n      X-Ricevuta: preavviso-errore-consegna\n      Date: [date of\
    \ notification emission]\n      Subject: AVVISO DI MANCATA CONSEGNA PER SUP. \
    \ TEMPO MASSIMO:\n               [original subject]\n      From: posta-certificata@[mail\
    \ domain]\n      To: [original recipient]\n      X-Riferimento-Message-ID: [msgid]\n\
    \   The body of the first non-delivery PEC notification (12-hour timeout)\n  \
    \ contains a text part that represents the readable format of the\n   notification\
    \ which will relate the following data:\n      Non-delivery PEC notification\n\
    \      On [date] at [time] ([time zone]), the message\n      \"[subject]\" originating\
    \ from \"[original sender]\"\n      and addressed to \"[recipient]\"\n      has\
    \ not been delivered within the first 12 hours following\n      its dispatch.\
    \  Not excluding that the message might eventually\n      be delivered, it is\
    \ deemed useful to consider that dispatch\n      might not have a positive outcome.\
    \  The system will see to\n      sending another non-delivery PEC notification\
    \ if in the\n      following twelve hours no confirmation is received from the\n\
    \      recipient.\n      Message identifier: [PEC msgid of corresponding\n   \
    \   PEC transport envelope]\n   On the other hand, 24-hour-timeout induced PEC\
    \ notifications, which\n   have the same header as described above, will have\
    \ the following text\n   in their body:\n      Non-delivery PEC notification\n\
    \      On [date] at [time] ([time zone]), the message\n      \"[subject]\" originating\
    \ from \"[original sender]\"\n      and addressed to \"[recipient]\"\n      has\
    \ not been delivered within 24 hours of its dispatch.\n      The transaction is\
    \ deemed to be considered terminated with a\n      negative outcome.\n      Message\
    \ identifier: [PEC msgid of corresponding\n      PEC transport envelope]\n   The\
    \ same certification data is inserted in an XML file added to both\n   PEC notification\
    \ types to allow automatic checks (section 4.4).\n   Parsing MUST be done on the\
    \ XML part only.  Additional parts MAY be\n   added for services supplied by the\
    \ PEC provider.  Regardless, the\n   original message MUST NOT be included.  The\
    \ message MUST follow the\n   format described in section 4.3.\n   A timeout PEC\
    \ notification is generated if one of the following\n   scenarios occurs:\n  \
    \ o  the sending provider receives a server-server acceptance PEC\n      notification\
    \ during the first 12 hours following message dispatch,\n      but does not receive\
    \ a delivery PEC notification at all.  In this\n      case, it would be a 24-hour\
    \ timeout PEC notification.\n   o  the sending provider does not receive a server-server\
    \ acceptance\n      PEC notification, but receives a delivery PEC notification\
    \ after\n      12 hours and before the 24-hour timeout.  In this case it would\
    \ be\n      a 12-hour timeout PEC notification.\n   o  the sending provider doesn't\
    \ receive either a server-server\n      acceptance or a delivery PEC notification.\
    \  In this case, two\n      timeout PEC notifications are generated; a 12-hour\
    \ and a 24-hour\n      timeout PEC notification.\n"
- title: 3.2.  Incoming Point
  contents:
  - '3.2.  Incoming Point

    '
- title: 3.2.1.  Server-Server Acceptance PEC Notification
  contents:
  - "3.2.1.  Server-Server Acceptance PEC Notification\n   When correct PEC transport\
    \ envelopes (as defined in section 2.2.2.)\n   are exchanged between PEC providers,\
    \ the receiver MUST send a server-\n   server acceptance PEC notification to the\
    \ sender.  The single\n   dispatched notification concerns all recipients who\
    \ belong to the\n   same provider, and to whom the incoming message was addressed,\
    \ as\n   stated in the routing data (forward and reverse paths) of the SMTP\n\
    \   transaction.  Within the certification data of a single server-server\n  \
    \ acceptance PEC notification, all recipients of the message to which\n   it refers\
    \ are listed.  In general, when receiving a PEC transport\n   envelope, each provider\
    \ MUST emit one or more server-server\n   acceptance PEC notifications to cover,\
    \ in absence of SMTP transport\n   errors, all the recipients in its jurisdiction.\n\
    \   The header of a server-server acceptance PEC notification contains\n   the\
    \ following fields:\n      X-Ricevuta: presa-in-carico\n      Date: [date of server-server\
    \ acceptance]\n      Subject: PRESA IN CARICO: [original subject]\n      From:\
    \ posta-certificata@[mail domain]\n      To: [sender provider service mailbox]\n\
    \      X-Riferimento-Message-ID: [msgid]\n   The provider's service email address\
    \ is obtained from the PEC\n   providers directory during the necessary queries\
    \ made in the\n   signature verification stage.\n   The body contains a text part\
    \ that follows the underlying model:\n      Server-server acceptance PEC notification\n\
    \      On [date] at [time] ([time zone]), the message \"[subject]\"\n      originating\
    \ from \"[original sender]\" and addressed to:\n      [recipient_1]\n      [recipient_2]\n\
    \      [recipient_n]\n      was accepted by the system.\n      Message identifier:\
    \ [PEC msgid of corresponding\n      PEC transport envelope]\n   The same certification\
    \ data is inserted in an XML file which is added\n   to the notification message\
    \ to allow for automatic checks (section\n   4.4).  Parsing MUST be done on the\
    \ XML part only.  Additional parts\n   MAY be added by the provider for provider-specific\
    \ services.  The\n   message MUST follow the format described in section 4.3.\n"
- title: 3.2.2.  PEC Anomaly Envelope
  contents:
  - "3.2.2.  PEC Anomaly Envelope\n   If the tests on an incoming message detect an\
    \ error, or the message\n   is identified as being ordinary mail and the provider\
    \ is set to\n   forward it to the recipient, the system MUST insert such a message\
    \ in\n   a PEC anomaly envelope.  Before delivery, the entire message received\n\
    \   at the Incoming Point is inserted in a format compliant with [EMAIL]\n   as\
    \ a [MIME1] part inside a new message that MUST inherit the\n   unmodified values\
    \ for the following header fields from the received\n   message:\n   o  Received:\n\
    \   o  To:\n   o  Cc:\n   o  Return-Path:\n   o  Message-ID:\n   Whereas, the\
    \ following header fields MUST be modified or inserted:\n      X-Trasplorto: errore\n\
    \      Date: [mlessage arrival date]\n      Subject: ANOMALIA MESSAGGIO: [original\
    \ subject]\n      From: \"On behalf of: [original sender]\"\n                \
    \             <posta-certificata@[mail_domain]>\n      Reply-To: [original sender\
    \ (inserted only if not already\n                present)]\n   The body contains\
    \ a user-readable text part according to a model that\n   relates the following\
    \ data:\n      Message anomaly\n      On [date] at [time] ([time zone]), the message\
    \ \"[subject]\"\n      originating from \"[original sender]\" and addressed to:\n\
    \      [recipient_1]\n      [recipient_2]\n      [recipient_n]\n      was received.\n\
    \      The data has not been certified due to the following error:\n      [concise\
    \ description of error]\n      The original message is attached.\n   Due to uncertainty\
    \ regarding origin and/or conformity of the message\n   received, the PEC anomaly\
    \ envelope MUST NOT contain [MIME1] parts\n   other than the entire message that\
    \ arrived at the Incoming Point.\n   Note that the routing data of such an envelope\
    \ (forward and reverse\n   paths) remain unaltered.  Doing so guarantees both\
    \ message forwarding\n   to the recipients, and reception of SMTP error notifications,\
    \ if any\n   occur, by the sender (as specified in [SMTP] and [SMTP-DSN]).\n"
- title: 3.2.3.  Virus Detection PEC Notification
  contents:
  - "3.2.3.  Virus Detection PEC Notification\n   If the Incoming Point receives virus-infected\
    \ PEC messages, it MUST\n   NOT forward them.  Rather it MUST inform the sending\
    \ provider, which\n   will in turn inform the sending user, of the failed transmission.\
    \  A\n   separate PEC notification of virus detection MUST be sent on behalf\n\
    \   of every recipient within the provider's domain.\n   In case a virus is detected\
    \ during the reception phase of a message\n   whose origin was asserted through\
    \ sender signature verification, the\n   system generates a virus-detected PEC\
    \ notification indicating the\n   error found, and sends it to the sending provider's\
    \ service mailbox.\n   The header of this PEC notification contains the following\
    \ fields:\n      X-Ricevuta: rilevazione-virus\n      X-Mittente: [original sender]\n\
    \      Date: [date of notification emission]\n      Subject: PROBLEMA DI SICUREZZA:\
    \ [original subject]\n      From: posta-certificata@[mail domain]\n      To: [sender\
    \ provider notifications]\n      X-Riferimento-Message-ID: [msgid]\n   The body\
    \ contains a readable text part according to a model that\n   relates the following\
    \ data:\n      Virus detection PEC notification\n      On [date] at [time] ([time\
    \ zone]), in the message \"[subject]\"\n      originating from \"[original sender]\"\
    \ and addressed to\n      \"[recipient]\"\n      a security problem was detected\
    \ [ID of content type detected].\n      Message identifier: [PEC msgid of corresponding\n\
    \      PEC transport envelope]\n   The same certification data is inserted in\
    \ an XML file and added to\n   the notification to allow for automatic checks\
    \ (section 4.4).\n   Parsing MUST be done on the XML part only.  Additional parts\
    \ MAY be\n   included by the provider for provider-specific services.  Regardless,\n\
    \   the original message MUST NOT be included.  The message MUST follow\n   the\
    \ format described in section 4.3.\n   The message body MUST contain the reason\
    \ for which the transmission\n   could not be completed.\n"
- title: 3.2.4.  Virus-Induced Delivery Error PEC notification
  contents:
  - "3.2.4.  Virus-Induced Delivery Error PEC notification\n   At the reception of\
    \ a virus detection PEC notification from the\n   receiving provider, the sender\
    \ provider emits a non-delivery PEC\n   notification to the sending user.\n  \
    \ The header for this notification contains the following fields:\n      X-Ricevuta:\
    \ errore-consegna\n      X-VerificaSicurezza: errore\n      Date: [date of notification\
    \ emission]\n      Subject: AVVISO DI MANCATA CONSEGNA PER VIRUS: [original\n\
    \               subject]\n      From: posta-certificata@[mail domain]\n      To:\
    \ [original sender]\n      X-Riferimento-Message-ID: [msgid]\n   The body contains\
    \ a readable text part according to a model that\n   relates the following data:\n\
    \      Delivery error PEC notification due to virus\n      On [date] at [time]\
    \ ([time zone]), in the message \"[subject]\"\n      addressed to \"[recipient]\"\
    \n      a security problem was detected [ID of content type detected\n      by\
    \ the anti-virus].\n      The message was not delivered.\n      Message identifier:\
    \ [PEC msgid of corresponding\n      PEC transport envelope]\n   All the information\
    \ necessary for the construction of such a PEC\n   notification can be obtained\
    \ from the correlated virus-detected PEC\n   notification.\n   The same certification\
    \ data is inserted in an XML file and added to\n   the notification message to\
    \ allow for automatic checks (section 4.4).\n   Parsing MUST be done on the XML\
    \ part only.  Additional parts MAY be\n   included by the provider for provider-specific\
    \ services.  The reason\n   the transaction was not completed MUST be specified\
    \ in the message,\n   which MUST follow the format described in section 4.3.\n"
- title: 3.3.  Delivery Point
  contents:
  - '3.3.  Delivery Point

    '
- title: 3.3.1.  Checks on Incoming Messages
  contents:
  - "3.3.1.  Checks on Incoming Messages\n   When a message arrives at the Delivery\
    \ Point, the system verifies:\n   o  message type\n   o  whether or not a PEC\
    \ notification has to be returned.\n"
- title: 3.3.2.  Delivery PEC Notification
  contents:
  - "3.3.2.  Delivery PEC Notification\n   A delivery PEC notification is issued only\
    \ after a correct PEC\n   transport envelope (sections 2.2.2 and 3.1.5) has been\
    \ delivered to\n   the recipient's mailbox.\n   In all other cases (e.g., PEC\
    \ anomaly envelopes, PEC notifications),\n   the delivery PEC notification is\
    \ not issued.  Regardless, the message\n   received at the Delivery Point MUST\
    \ be delivered to the recipient's\n   mailbox unchanged.\n   This notification\
    \ tells the user that his/her message has been\n   successfully delivered to the\
    \ specified recipient.  It includes\n   readable text that certifies the date\
    \ and time of delivery, sender\n   and receiver data, and the subject.  It also\
    \ contains an XML\n   certification data file and other optional parts for functionalities\n\
    \   offered by the provider.\n   The following fields are inserted in the header:\n\
    \      X-Ricevuta: avvenuta-consegna\n      Date: [delivery date]\n      Subject:\
    \ CONSEGNA: [original subject]\n      From: posta-certificata@[mail domain]\n\
    \      To: [original sender]\n      X-Riferimento-Message-ID: [msgid]\n   The\
    \ value of the \"X-TipoRicevuta:\" header field in the PEC transport\n   envelope\
    \ is derived from the original message, thus allowing the\n   sender to determine\
    \ the type of delivery PEC notification requested\n   from the primary recipients\
    \ of the original message.  The\n   notification MUST follow the format described\
    \ in section 4.3.\n"
- title: '3.3.2.1.  Delivery PEC Notification: Complete'
  contents:
  - "3.3.2.1.  Delivery PEC Notification: Complete\n   This is the default value for\
    \ delivery PEC notifications.  When no\n   value for \"X-TipoRicevuta:\" is specified,\
    \ or when it contains the\n   value \"completa\" (complete), the system will require\
    \ a complete\n   delivery PEC notification from addressees in the \"To:\" field,\
    \ while a\n   concise PEC notification (section 3.3.2.3) will be required from\n\
    \   those in the \"Cc:\" field.  The distinction between primary recipients\n\
    \   and those in carbon copy is done through an analysis of the \"To:\" and\n\
    \   \"Cc:\" fields.  For PEC notifications sent on behalf of primary\n   recipients,\
    \ a complete copy of the original message along with any\n   attachments is inserted\
    \ in the notification.  In case the system in\n   charge of delivery is not able\
    \ to determine the recipient type due to\n   ambiguity problems in the \"To:\"\
    \ and \"Cc:\" fields, delivery MUST be\n   considered as if addressed to a primary\
    \ recipient and include the\n   complete copy of the original message.\n   The\
    \ notification body contains a readable text part that relates\n   certification\
    \ data according to the following model:\n      Delivery PEC notification\n  \
    \    On [date] at [time] ([time zone]), the message \"[subject]\"\n      originating\
    \ from \"[original sender]\" and addressed to\n      \"[recipient]\"\n      was\
    \ placed in the destination's mailbox.\n      Message identifier: [PEC msgid of\
    \ corresponding\n      PEC transport envelope]\n   The same certification data\
    \ is inserted in an XML file and added to\n   the notification (section 4.4),\
    \ along with any other parts that MAY\n   be inserted by the provider for provider-specific\
    \ services.  Parsing\n   MUST be done on the XML part only.  The delivery PEC\
    \ notification\n   MUST be issued on behalf of every recipient of the message,\
    \ and MUST\n   follow the format described in section 4.3.\n"
- title: '3.3.2.2.  Delivery PEC Notification: Brief'
  contents:
  - "3.3.2.2.  Delivery PEC Notification: Brief\n   In order to decrease the amount\
    \ of data flowing, it is possible for\n   the sender to ask for a delivery PEC\
    \ notification in \"brief\" format.\n   The brief delivery PEC notification contains\
    \ the original message and\n   a ciphered hash value for each of its parts.  The\
    \ hash value SHOULD\n   be calculated on base64 encoded parts.  As specified in\
    \ section 5.3,\n   PEC messages MUST transit only on machines that belong to the\
    \ PEC\n   network and that MUST NOT alter the encoding of the message during\n\
    \   its transition/processing.\n   NOTE: Even though PEC uses these relaxed specifications,\
    \ PEC\n   interoperability tests between over 20 service providers have never\n\
    \   revealed any problems.  This is probably due to mail servers leaning\n   more\
    \ towards leaving the messages they receive intact without\n   applying any changes.\
    \  But issues might arise if a server decides to\n   modify encoded parts; for\
    \ example, change the base64 line length,\n   whose hash value calculated at the\
    \ receiver's end would then differ\n   from that at the sender's side.\n   To\
    \ be able to verify the transmitted contents it is necessary for the\n   sender\
    \ to keep the unaltered original copy of the part(s) to which\n   the hash values\
    \ refer.\n   If the PEC transport envelope contains the header:\n        X-TipoRicevuta:\
    \ breve\n   the Delivery Point emits a brief delivery PEC notification on behalf\n\
    \   of the primary recipients, and a concise one (section 3.3.2.3) on\n   behalf\
    \ of carbon copy recipients.  The value of the header field in\n   the PEC transport\
    \ envelope is derived from the original message.\n   The notification body contains\
    \ a readable text part according to a\n   model that relates the following certification\
    \ data:\n      Brief delivery PEC notification\n      On [date] at [time] ([time\
    \ zone]), the message \"[subject]\"\n      originating from \"[original sender]\"\
    \ and addressed to\n      \"[recipient]\"\n      was placed in the destination's\
    \ mailbox.\n      Message identifier: [PEC msgid of corresponding\n      PEC transport\
    \ envelope]\n   The same certification data is inserted in an XML file and added\
    \ to\n   the notification (section 4.4), along with other parts that MAY be\n\
    \   included for specific provider-supplied services.  Parsing MUST be\n   done\
    \ on the XML part only.  The delivery PEC notification is issued\n   on behalf\
    \ of every recipient of the message, and MUST follow the\n   format described\
    \ in section 4.3.\n   The MIME structure of the original message is unaltered\
    \ as it is\n   added to the notification, but each MIME part with a \"name\" parameter\n\
    \   in the header field \"Content-Type:\" or a \"filename\" parameter in the\n\
    \   header field \"Content-Disposition:\" MUST be substituted by a text\n   file\
    \ containing that MIME part's hash value.\n   When the original message has an\
    \ S/MIME format, it is necessary not\n   to alter the integrity of the message\
    \ structure.  Verification of the\n   S/MIME part in the original message takes\
    \ place when the MIME type of\n   the top-level entity (which coincides with the\
    \ message itself) is\n   checked.  An S/MIME message MAY have the following MIME\
    \ types (as per\n   [SMIMEV3]):\n   o  multipart/signed\n      Represents an original\
    \ message signed by the sender using the\n      structure described in [MIME-SECURE].\
    \  The message is made up of\n      two MIME parts: the first is the message itself\
    \ before the\n      application of the sender's signature, whereas the second\
    \ contains\n      signature data.  The second part (generally of type\n      \"\
    application/pkcs7-signature\" or \"application/x-pkcs-signature\")\n      contains\
    \ data added during the signing phase and MUST be left\n      unchanged to avoid\
    \ compromising the overall message structure;\n   o  \"application/pkcs7-mime\"\
    \ or \"application/x-pkcs7-mime\"\n      The message is composed of a sole CMS\
    \ object within the MIME part.\n      Given that attachments cannot be separated\
    \ from the CMS object,\n      the MIME part is left intact (i.e., it is not replaced\
    \ by the hash\n      value); therefore, the brief PEC notification is the same\
    \ as the\n      complete PEC notification.\n   If the original message contains\
    \ parts whose \"Content-Type:\" is\n   \"message/rfc822\", i.e., contains an email\
    \ message as attachment, the\n   entire attached message is substituted with its\
    \ corresponding hash\n   value.\n   Therefore, when emitting a brief delivery\
    \ PEC notification, the\n   provider MUST:\n   1. identify and extract all the\
    \ parts from the first MIME part of the\n     multipart/signed S/MIME message;\n\
    \   2. calculate the hash values of all the files attached by the sender\n   \
    \  to the original message;\n   3. substitute originals with their hash values.\n\
    \   In general, in the case of original messages in S/MIME format, the\n   copy\
    \ of the message inserted within the brief delivery PEC\n   notification will\
    \ have the following characteristics:\n   o  if the original message is signed,\
    \ the S/MIME structure and\n      signature-relative data will remain unchanged.\
    \  The message will\n      generate an error in a future signature integrity verification\n\
    \      phase following the substitution of attachments with the\n      corresponding\
    \ hash values.\n   o  if the original message contains the \"application/pkcs7-mime\"\
    \ or\n      \"application/x-pkcs7-mime\" MIME type, attachments present in the\n\
    \      message will not be substituted by their hash values, due to\n      impossibility\
    \ of identification within a CMS structure.  The\n      content of the brief delivery\
    \ PEC notification will coincide with\n      that of a normal delivery PEC notification.\n\
    \   The algorithm used for hash calculation is the [SHA1], calculated on\n   the\
    \ entire content of the part.  To allow distinction between hash\n   files and\
    \ the files to which they refer, the suffix \".hash\" is added\n   to the original\
    \ filename.  The hash value is written in the file\n   using a hexadecimal representation\
    \ as a single sequence of 40\n   characters.  The MIME type of these attachments\
    \ is set to\n   \"text/plain\" to highlight their textual nature.\n"
- title: '3.3.2.3.  Delivery PEC Notification: Concise'
  contents:
  - "3.3.2.3.  Delivery PEC Notification: Concise\n   If the PEC transport envelope\
    \ contains the header:\n        X-TipoRicevuta: sintetica\n   the Delivery Point\
    \ emits, both to primary and carbon copy recipients,\n   a concise delivery PEC\
    \ notification that does not contain the\n   original message.\n   The message\
    \ body of the notification contains a readable text part\n   according to a model\
    \ that relates the following certification data:\n      Concise delivery PEC notification\n\
    \      On [date] at [time] ([time zone]), the message \"[subject]\"\n      originating\
    \ from \"[original sender]\" and addressed to\n      \"[recipient]\"\n      was\
    \ placed in the destination's mailbox.\n      Message identifier: [PEC msgid of\
    \ corresponding\n      PEC transport envelope]\n   The same certification data\
    \ is inserted within an XML file and added\n   to the notification (section 4.4),\
    \ along with additional parts that\n   MAY be included for provider-specific services.\
    \  Parsing MUST be done\n   on the XML part only.  The notification is sent to\
    \ each one of the\n   recipients to whom the message is delivered, and MUST follow\
    \ the\n   format described in section 4.3.\n   The concise delivery PEC notification\
    \ follows the same emission rules\n   as the delivery PEC notification; added\
    \ to it is only the XML file\n   containing the certification data, not the original\
    \ message.\n"
- title: 3.3.3.  Non-Delivery PEC Notification
  contents:
  - "3.3.3.  Non-Delivery PEC Notification\n   If an error occurs during the delivery\
    \ of a correct PEC transport\n   message, the system returns to the sender a non-delivery\
    \ PEC\n   notification that indicates the error condition.\n   The header will\
    \ contain the following fields:\n      X-Ricevuta: errore-consegna\n      Date:\
    \ [date of notification emission]\n      Subject: AVVISO DI MANCATA CONSEGNA:\
    \ [original subject]\n      From: posta-certificata@[mail domain]\n      To: [original\
    \ sender]\n      X-Riferimento-Message-ID: [msgid]\n   The notification body contains\
    \ a readable text part according to a\n   model that relates the following data:\n\
    \      Non-delivery PEC notification\n      On [date] at [time] ([time zone]),\
    \ in the message \"[subject]\"\n      originating from \"[original sender]\" and\
    \ addressed to\n      \"[recipient]\"\n      an error was detected [brief error\
    \ description].\n      The message was refused by the system.\n      Message identifier:\
    \ [PEC msgid of corresponding\n      PEC transport envelope]\n   The same certification\
    \ data is inserted within an XML file and added\n   to the notification in order\
    \ to allow for automatic checks (section\n   4.4).  Parsing MUST be done on the\
    \ XML part only.  Additional parts\n   MAY be included by the PEC provider for\
    \ provider-specific services.\n   The notification MUST follow the format described\
    \ in section 4.3.\n"
- title: 3.4.  Sender and Receiver Belonging to the Same Domain
  contents:
  - "3.4.  Sender and Receiver Belonging to the Same Domain\n   PEC messages MUST\
    \ be processed even if both sender and receiver(s)\n   belong to the same PEC\
    \ domain.\n"
- title: '3.5.  Example: Complete Transaction between Two PEC Domains'
  contents:
  - "3.5.  Example: Complete Transaction between Two PEC Domains\n   A correct transaction\
    \ between two PEC domains goes through the\n   following steps:\n   o  The sending\
    \ user sends an email to his provider's Access Point;\n   o  The Access Point\
    \ runs all checks and emits a server-user\n      acceptance PEC notification to\
    \ the user;\n   o  The Access Point creates a PEC transport envelope and forwards\
    \ it\n      to the Incoming Point of the receiving provider;\n   o  The receiver's\
    \ Incoming Point verifies the PEC transport envelope\n      and creates a server-server\
    \ acceptance PEC notification to be sent\n      to the sending provider;\n   o\
    \  The sender's Incoming Point verifies the validity of the server-\n      server\
    \ acceptance PEC notification and forwards it to the Delivery\n      Point;\n\
    \   o  The sender's Delivery Point saves the server-server acceptance PEC\n  \
    \    notification in the provider's service mailbox;\n   o  The receiver's Incoming\
    \ Point forwards the PEC transport envelope\n      to the receiver's Delivery\
    \ Point;\n   o  The receiver's Delivery Point verifies the contents of the PEC\n\
    \      transport envelope and saves it in the recipient's mailbox;\n   o  The\
    \ receiver's Delivery Point creates a delivery PEC notification\n      and sends\
    \ it to the sender's Incoming Point;\n   o  The sender's Incoming Point verifies\
    \ the validity of the delivery\n      PEC notification and forwards it to the\
    \ sender's Delivery Point;\n   o  The sender's Delivery Point saves the delivery\
    \ PEC notification in\n      the sending user's mailbox;\n   o  The receiving\
    \ user has the message at his disposition.\n   NOTE: Some of these steps might\
    \ occur in parallel, thus the\n   interaction might complete in a different order.\n"
- title: 4.  Formats
  contents:
  - '4.  Formats

    '
- title: 4.1.  Temporal Reference
  contents:
  - "4.1.  Temporal Reference\n   For all operations carried out during message, notification,\
    \ and log\n   elaboration processes by the Access, Incoming, and Delivery Points,\n\
    \   it is necessary to have an accurate temporal reference available.\n   All\
    \ events (generation of PEC notifications, transport envelopes,\n   logs, etc.)\
    \ that constitute the transaction of message elaboration at\n   the Access, Incoming,\
    \ and Delivery Points MUST employ a sole temporal\n   value obtained from within\
    \ the transaction itself.\n   Doing this renders the instant of message elaboration\
    \ unambiguous\n   within PEC logs, notifications, messages, etc., generated by\
    \ the\n   server.\n"
- title: 4.2.  User Date/Time
  contents:
  - "4.2.  User Date/Time\n   Temporal indications supplied by the service in readable\
    \ format (text\n   in PEC notifications, transport envelopes, etc.) are provided\
    \ with\n   reference to the legal time at the moment of the operation.\n   Following\
    \ is the specification using the syntax description notation\n   defined in [ABNF].\n\
    \   date-fullyear   = 4DIGIT\n   date-month      = 2DIGIT  ; 01-12\n   date-mday\
    \       = 2DIGIT  ; 01-28, 01-29, 01-30, 01-31 based on\n                    \
    \         ; month/year\n   time-hour       = 2DIGIT  ; 00-23\n   time-minute \
    \    = 2DIGIT  ; 00-59\n   time-second     = 2DIGIT  ; 00-58, 00-59, 00-60 based\
    \ on leap second\n                             ; rules\n   time-offset     = \"\
    (\" (\"+\" / \"-\") time-hour \":\" time-minute \")\"\n   partial-time    = time-hour\
    \ \":\" time-minute \":\" time-second\n   full-date       = date-mday \"/\" date-month\
    \ \"/\" date-fullyear\n   full-time       = partial-time time-offset\n   NOTE:\
    \ For number of days in a month, leap year, and leap second\n         restrictions\
    \ see section 5.7 of [TIMESTAMP].\n"
- title: 4.3.  Format of a PEC Message Body
  contents:
  - "4.3.  Format of a PEC Message Body\n   This section describes the characteristics\
    \ of the various components\n   of PEC messages and notifications generated by\
    \ a PEC system.  If one\n   of the message parts contains characters with values\
    \ outside of the\n   range 0-127 (7-bit ASCII), that part will have to be adequately\n\
    \   encoded so that 7-bit transportation compatibility is guaranteed\n   (e.g.,\
    \ quoted-printable, base64 as per [MIME1]).\n   Before applying the signature,\
    \ the message body has Content-Type:\n   multipart/mixed.  Each part is described\
    \ in the sections below.  The\n   first part is the user readable text generated\
    \ by the PEC system,\n   while the second and third parts are interchangeable\
    \ in order and\n   contain the original message and the XML file for the certification\n\
    \   data.\n"
- title: 4.3.1.  User Readable Text
  contents:
  - "4.3.1.  User Readable Text\n   Character set: ISO-8859-1 (Latin-1)\n   MIME type:\
    \ text/plain or multipart/alternative\n   The multipart/alternative MIME type\
    \ MAY be used to add an HTML\n   version of the body of system-generated messages.\
    \  In this case, two\n   sub-parts MUST be present: one of type text/plain, the\
    \ other\n   text/html.  For the HTML part:\n   o  it MUST contain the same information\
    \ as related in the text part;\n   o  it MUST NOT contain references to elements\
    \ (e.g., images, sounds,\n      font, style sheets), neither internal to the message\
    \ (added MIME\n      parts) nor external (e.g., hosted on the provider's server);\n\
    \   o  it MUST NOT have active content (e.g., JavaScript, VBscript, Plug-\n  \
    \    in, ActiveX).\n"
- title: 4.3.2.  Original Message
  contents:
  - "4.3.2.  Original Message\n   MIME type: message/rfc822\n   Attachment name: postacert.eml\n"
- title: 4.3.3.  Certification Data
  contents:
  - "4.3.3.  Certification Data\n   Character set: UTF-8\n   MIME type: application/xml\n\
    \   Attachment name: certdata.xml\n"
- title: 4.4.  Certification Data Scheme
  contents:
  - "4.4.  Certification Data Scheme\n   Following is the DTD relative to the [XML]\
    \ file that contains\n   certification data attached to PEC notifications.\n \
    \  <!--Use the element \"postacert\" as root-->\n   <!--\"tipo\" indicates the\
    \ typology of the PEC message-->\n   <!--The attribute \"errore\" can have the\
    \ following values-->\n   <!--\"nessuno\" = no error-->\n   <!--\"no-dest\" (with\
    \ type=\"errore-consegna\") = -->\n   <!--                                   \
    \     wrong recipient-->\n   <!--\"no-dominio\" (with type=\"errore-consegna\"\
    ) = -->\n   <!--                                           wrong domain-->\n \
    \  <!--\"virus\" (with type=\"errore-consegna\") = virus-->\n   <!--\"virus\"\
    \ (with type=\"non-accettazione\") = virus-->\n   <!--\"altro\" = generic error-->\n\
    \   <!ELEMENT postacert (intestazione, dati)>\n   <!ATTLIST postacert\n      \
    \   tipo (accettazione |\n               non-accettazione |\n               presa-in-carico\
    \ |\n               avvenuta-consegna |\n               posta-certificata |\n\
    \               errore-consegna |\n               preavviso-errore-consegna |\n\
    \               rilevazione-virus) #REQUIRED\n         errore (nessuno |\n   \
    \              no-dest |\n                 no-dominio |\n                 virus\
    \ |\n                 altro) \"nessuno\">\n   <!--Header of the original message-->\n\
    \   <!ELEMENT intestazione (mittente,\n                           destinatari+,\n\
    \                           risposte,\n                           oggetto?)>\n\
    \   <!--Sender (\"From:\" field) of the original message-->\n   <!ELEMENT mittente\
    \ (#PCDATA)>\n   <!--Complete list of recipients (\"To:\" and \"Cc:\" fields)-->\n\
    \   <!--of the original message-->\n   <!--\"tipo\" indicates the typology of\
    \ the recipient-->\n   <!ELEMENT destinatari (#PCDATA)>\n   <!ATTLIST destinatari\n\
    \         tipo (certificato | esterno) \"certificato\">\n   <!--Value of the \"\
    Reply-To:\" field of the original message-->\n   <!ELEMENT risposte (#PCDATA)>\n\
    \   <!--Value of the \"Subject:\" field of the original message-->\n   <!ELEMENT\
    \ oggetto (#PCDATA)>\n   <!--PEC message data-->\n   <!ELEMENT dati (gestore-emittente,\n\
    \                   data,\n                   identificativo,\n              \
    \     msgid?,\n                   ricevuta?,\n                   consegna?,\n\
    \                   ricezione*,\n                   errore-esteso?)>\n   <!--Descriptive\
    \ string of the provider that certifies -->\n   <!--the data-->\n   <!ELEMENT\
    \ gestore-emittente (#PCDATA)>\n   <!--Date/time of message elaboration-->\n \
    \  <!--\"zona\" is the difference between local time and UTC in -->\n   <!--\"\
    [+|-]hhmm\" format-->\n   <!ELEMENT data (giorno, ora)>\n   <!ATTLIST data\n \
    \        zona CDATA #REQUIRED>\n   <!--Day in \"dd/mm/yyyy\" format-->\n   <!ELEMENT\
    \ giorno (#PCDATA)>\n   <!--Local hour in \"hh:mm:ss\" format-->\n   <!ELEMENT\
    \ ora (#PCDATA)>\n   <!--PEC msgid-->\n   <!ELEMENT identificativo (#PCDATA)>\n\
    \   <!--msgid of the original message before modifications-->\n   <!ELEMENT msgid\
    \ (#PCDATA)>\n   <!--For PEC transport envelopes and delivery notifications-->\n\
    \   <!--indicate the type of PEC notification requested by the-->\n   <!--sender-->\n\
    \   <!ELEMENT ricevuta EMPTY>\n   <!ATTLIST ricevuta\n         tipo (completa\
    \ |\n               breve   |\n               sintetica ) #REQUIRED>\n   <!--For\
    \ delivery, non-delivery, virus-induced non-delivery, -->\n   <!-- virus detection,\
    \ and timeout PEC notifications-->\n   <!--Recipient address to which delivery\
    \ has been carried -->\n   <!--out/tried-->\n   <!ELEMENT consegna (#PCDATA)>\n\
    \   <!--For server-server acceptance PEC notifications-->\n   <!--recipients for\
    \ whom it is the relative PEC notification-->\n   <!ELEMENT ricezione (#PCDATA)>\n\
    \   <!--In case of error-->\n   <!--brief description of the error-->\n   <!ELEMENT\
    \ errore-esteso (#PCDATA)>\n"
- title: 4.5.  PEC Providers Directory Scheme
  contents:
  - "4.5.  PEC Providers Directory Scheme\n   The PEC providers directory is created\
    \ through a centralized LDAP\n   server that contains the providers' data and\
    \ their corresponding PEC\n   mail domains.\n   The following are the directory\
    \ scheme's attributes:\n   - providerCertificateHash: hash of provider's certificate\n\
    \   - providerCertificate: provider certificate\n   - providerName: provider name\n\
    \   - mailReceipt: provider reception email address\n   - managedDomains: managed\
    \ domains\n   - LDIFLocationURL: provider LDIF record URL\n   - providerUnit:\
    \ secondary operating environment name\n   The directory's base root is \"o=postacert\"\
    \ and the\n   \"DistinguishedName\" of single records is of the type\n   \"<providerName=<name>,o=postacert>\"\
    .  Search within the directory is\n   carried out mainly in case-sensitive mode\
    \ using the\n   \"providerCertificateHash\" attribute (during envelope signature\n\
    \   verification phase) or the \"managedDomains\" attribute (during message\n\
    \   acceptance phase).  It is possible for the record of a single\n   provider\
    \ to contain multiple \"providerCertificate\" attributes with\n   the related\
    \ \"providerCertificateHash\" attributes in order to allow\n   the handling of\
    \ the renewal of expiring certificates.  The provider\n   MUST make sure to update\
    \ its record with sufficient advance before\n   the certificate expiration date,\
    \ by adding a new certificate whose\n   validity overlaps that of the previous\
    \ one.\n   The data of all PEC providers is encompassed in a [LDIF] file, which\n\
    \   is available as an [HTTPS] object and can be found at the URL to\n   which\
    \ the 'LDIFLocationURL' attribute in the \"dn: o=postacert\" record\n   points\
    \ (see section 4.5.6).  To guarantee authenticity, that file\n   MUST be signed\
    \ by the provider for the operations regarding its PEC\n   services using the\
    \ method described for single providers.  The file,\n   the signature, and the\
    \ X.509v3 certificate MUST be inserted in a\n   PKCS#7 structure in binary ASN.1\
    \ DER format as a file with \".p7m\"\n   extension.  The centralized [LDAP] system\
    \ downloads that file on a\n   daily basis and, after suitable verifications of\
    \ the signature,\n   applies it to the provider's record.\n   Through the [LDIF]\
    \ file, single providers MUST keep a copy of the\n   directory locally, updated\
    \ on a daily basis, in order to improve\n   system performance by avoiding continuous\
    \ request dispatches to the\n   central system for every message elaboration phase.\n\
    \   If secondary environments are present, the [LDIF] file indicated in\n   the\
    \ main environment's record MUST relate the contents of all the\n   provider-relevant\
    \ records.\n      NOTE: This specification uses an unregistered LDAP DN name space\n\
    \            that may lead to conflict with other registered or\n            unregistered\
    \ names.\n"
- title: 4.5.1.  providerCertificateHash Attribute
  contents:
  - "4.5.1.  providerCertificateHash Attribute\n   The 'providerCertificateHash' attribute\
    \ is a hexadecimal\n   representation of the hash in SHA1 format of the X.509v3\
    \ certificate\n   used by the provider for PEC notifications and envelope signatures.\n\
    \   ( 1.3.6.1.4.1.16572.2.2.1  NAME 'providerCertificateHash'\n     DESC 'Hash\
    \ SHA1 of X.509 certificate in hexadecimal format'\n     EQUALITY caseIgnoreIA5Match\n\
    \     SYNTAX 1.3.6.1.4.1.1466.115.121.1.26 )\n   The IA5String ( 1.3.6.1.4.1.1466.115.121.1.26\
    \ ) syntax is defined in\n   [LDAP-SYNTAXES].\n"
- title: 4.5.2.  providerCertificate Attribute
  contents:
  - "4.5.2.  providerCertificate Attribute\n   The 'providerCertificate' attribute\
    \ holds a set of certificate(s)\n   used by the provider to sign PEC notifications\
    \ and transport\n   envelopes.\n   ( 1.3.6.1.4.1.16572.2.2.2  NAME 'providerCertificate'\n\
    \     DESC 'X.509 certificate in ASN.1 DER binary format'\n     SYNTAX 1.3.6.1.4.1.1466.115.121.1.8\
    \ )\n   The Certificate syntax ( 1.3.6.1.4.1.1466.115.121.1.8 ) is defined in\n\
    \   [RFC4523].\n   As required by this attribute type's syntax, values of this\
    \ attribute\n   are requested and transferred using the attribute description\n\
    \   \"providerCertificate;binary\" [RFC4522].\n"
- title: 4.5.3.  providerName Attribute
  contents:
  - "4.5.3.  providerName Attribute\n   The 'providerName' attribute contains the\
    \ name of the PEC provider.\n   All records MUST contain their provider's name\
    \ in this attribute.\n   ( 1.3.6.1.4.1.16572.2.2.3  NAME 'providerName'\n    \
    \ DESC 'PEC provider name'\n     EQUALITY caseIgnoreMatch\n     SUBSTR caseIgnoreSubstringsMatch\n\
    \     SYNTAX 1.3.6.1.4.1.1466.115.121.1.15\n     SINGLE-VALUE )\n   The Directory\
    \ String ( 1.3.6.1.4.1.1466.115.121.1.15 ) syntax is\n   defined in [LDAP-SYNTAXES].\n"
- title: 4.5.4.  mailReceipt Attribute
  contents:
  - "4.5.4.  mailReceipt Attribute\n   The 'mailReceipt' attribute contains the provider's\
    \ email address\n   within the provider to which server-server acceptance and\
    \ virus\n   detection PEC notifications are sent.  This address is a limited\n\
    \   version of the addr-spec construct described in [EMAIL] (without\n   angle\
    \ brackets); it only permits the dot-atom-text form on both the\n   left- and\
    \ right-hand sides of the \"@\", and does not have internal\n   CFWS.\n   ( 1.3.6.1.4.1.16572.2.2.4\
    \ NAME 'mailReceipt'\n     DESC 'E-mail address of the service mailbox'\n    \
    \ EQUALITY caseIgnoreIA5Match\n     SUBSTR caseIgnoreIA5SubstringsMatch\n    \
    \ SYNTAX 1.3.6.1.4.1.1466.115.121.1.26\n     SINGLE-VALUE )\n   The IA5String\
    \ ( 1.3.6.1.4.1.1466.115.121.1.26 ) syntax is defined in\n   [LDAP-SYNTAXES].\n"
- title: 4.5.5.  managedDomains Attribute
  contents:
  - "4.5.5.  managedDomains Attribute\n   The 'managedDomains' attribute holds a set\
    \ of domains [SMTP] that are\n   handled by a PEC provider.  Domains are limited\
    \ to dot-atom form\n   ([RFC1034], [EMAIL]).\n   ( 1.3.6.1.4.1.16572.2.2.5 NAME\
    \ 'managedDomains'\n     DESC 'Domains handled by the PEC provider'\n     EQUALITY\
    \ caseIgnoreIA5Match\n     SUBSTR caseIgnoreIA5SubstringsMatch\n     SYNTAX 1.3.6.1.4.1.1466.115.121.1.26\
    \ )\n   The IA5String ( 1.3.6.1.4.1.1466.115.121.26 ) syntax is defined in\n \
    \  [LDAP-SYNTAXES].\n   The 'managedDomains' attribute holds a set of domains\
    \ [SMTP] that are\n   handled by a PEC provider.  Domains are limited to dot-atom\
    \ form\n   ([RFC1034], [EMAIL]).\n"
- title: 4.5.6.  LDIFLocationURL Attribute
  contents:
  - "4.5.6.  LDIFLocationURL Attribute\n   The 'LDIFLocationURL' attribute contains\
    \ an [HTTPS] URL that points\n   to the location of the [LDIF] file defining the\
    \ provider's record.\n   When the attribute is present in the record \"dn: o=postacert\"\
    , then\n   it contains the definition of the entire directory in [LDIF] format.\n\
    \   The LDIF file will have a MIME type of application/pkcs7-mime, with\n   the\
    \ parameter smime-type/signed-data.  [SMIMEV3] The LDIF file is\n   encoded using\
    \ the UTF-8 character set.\n   Secondary environment records MUST NOT contain\
    \ the 'LDIFLocationURL'\n   attribute which is obtained from the main environment's\
    \ attributes\n   for all records connected to the provider.\n   ( 1.3.6.1.4.1.16572.2.2.6\
    \ NAME 'LDIFLocationURL'\n     DESC 'URL of the LDIF file that defines the entry'\n\
    \     EQUALITY caseExactMatch\n     SYNTAX 1.3.6.1.4.1.1466.115.121.1.15\n   \
    \  SINGLE-VALUE )\n   The Directory String ( 1.3.6.1.4.1.1466.115.121.1.15 ) syntax\
    \ is\n   defined in [LDAP-SYNTAXES].\n"
- title: 4.5.7.  providerUnit Attribute
  contents:
  - "4.5.7.  providerUnit Attribute\n   The 'providerUnit' attribute contains the\
    \ name of secondary operating\n   environments -- an attribute not present for\
    \ the main environment.\n   It is possible for the provider to define several\
    \ distinct records,\n   each indicating a single, different, secondary operating\
    \ environment,\n   for which it is possible to declare specific attributes that\
    \ are, if\n   need be, distinct from those relative to the main and other\n  \
    \ environments.\n   The \"DistinguishedName\" of the records relative to the secondary\n\
    \   operating environments are of the type\n   \"<providerUnits=<environment>,providerName=<name>,o=postacert>\"\
    .\n   Every provider MUST have a record associated to its own main\n   environment,\
    \ distinguishable for the absence of the \"providerUnit\"\n   attribute within\
    \ the record and the DistinguishedName.\n   ( 1.3.6.1.4.1.16572.2.2.7 NAME 'providerUnit'\n\
    \     DESC 'Name of the secondary operative environment'\n     EQUALITY caseIgnoreMatch\n\
    \     SUBSTR caseIgnoreSubstringsMatch\n     SYNTAX 1.3.6.1.4.1.1466.115.121.1.15\n\
    \     SINGLE-VALUE )\n   The Directory String ( 1.3.6.1.4.1.1466.115.121.1.15\
    \ ) syntax is\n   defined in [LDAP-SYNTAXES].\n"
- title: 4.5.8.  LDIFLocationURLObject Object Class
  contents:
  - "4.5.8.  LDIFLocationURLObject Object Class\n   The schema definition of the 'LDIFLocationURLObject'\
    \ object class:\n   ( 1.3.6.1.4.1.16572.2.1.1 NAME 'LDIFLocationURLObject'\n \
    \    SUP top AUXILIARY\n     MAY ( LDIFLocationURL ) )\n"
- title: 4.5.9.  Provider Object Class
  contents:
  - "4.5.9.  Provider Object Class\n   The schema definition of the 'provider' object\
    \ class:\n   ( 1.3.6.1.4.1.16572.2.1.2 NAME 'provider'\n     SUP top STRUCTURAL\n\
    \     MUST ( providerCertificateHash\n            providerCertificate\n      \
    \      providerName\n            mailReceipt\n            managedDomains )\n \
    \    MAY ( description\n           LDIFLocationURL\n           providerUnit )\n"
- title: 4.5.10.  LDIF File Example
  contents:
  - "4.5.10.  LDIF File Example\n   The following LDIF file represents an example\
    \ of a providers'\n   directory, containing a base root and two fictitious providers.\
    \  The\n   inserted certificates are two self-signed certificates used for\n \
    \  example purposes only:\n       dn: o=postacert\n       objectclass: top\n \
    \      objectclass: organization\n       objectClass: LDIFLocationURLObject\n\
    \       o: postacert\n       LDIFLocationURL: https://igpec.rupa.example.com/igpec.ldif.p7m\n\
    \       description: Base root for the PEC providers directory\n       dn: providerName=Anonymous\
    \ Certified Mail S.p.A.,o=postacert\n       objectclass: top\n       objectclass:\
    \ provider\n       providerName: Anonymous Certified Mail S.p.A.\n       providerCertificateHash:\n\
    \        7E7AEF1059AE0F454F2643A95F69EC3556009239\n       providerCertificate;binary::\n\
    \        MIIDBjCCAm+gAwIBAgIBADANBgkqhkiG9w0BAQQFADBmMQswCQYDVQQGEw\n        JJVDEpMCcGA1UEChMgQW5vbmltYSBQb3N0YSBDZXJ0aWZpY2F0YSBTLnAu\n\
    \        QS4xLDAqBgkqhkiG9w0BCQEWHXBvc3RhLWNlcnRpZmljYXRhQGFucG9jZX\n        J0Lml0MB4XDTAyMTIwOTE3MjQxNVoXDTAzMTIwOTE3MjQxNVowZjELMAkG\n\
    \        A1UEBhMCSVQxKTAnBgNVBAoTIEFub25pbWEgUG9zdGEgQ2VydGlmaWNhdG\n        EgUy5wLkEuMSwwKgYJKoZIhvcNAQkBFh1wb3N0YS1jZXJ0aWZpY2F0YUBh\n\
    \        bnBvY2VydC5pdDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAr8J+qK\n        KdxV9LzDMPqwnEy0P8H/KwbI0Szs8p6UZajZdpeUK0Ncbrv1QyXZNNtSMC\n\
    \        2uL09HDyx8agjgZWdhypnehguiSK3busha15RSpMGhiqxmz2b0HhOG73Gf\n        alZelqrwqmElna4MNUaLhbOvTd/sqPUS378w5IaIhWxzy34XcCAwEAAaOB\n\
    \        wzCBwDAdBgNVHQ4EFgQUN8lC0znQWEs0xspZ/aBzsaGvRZMwgZAGA1UdIw\n        SBiDCBhYAUN8lC0znQWEs0xspZ/aBzsaGvRZOhaqRoMGYxCzAJBgNVBAYT\n\
    \        AklUMSkwJwYDVQQKEyBBbm9uaW1hIFBvc3RhIENlcnRpZmljYXRhIFMucC\n        5BLjEsMCoGCSqGSIb3DQEJARYdcG9zdGEtY2VydGlmaWNhdGFAYW5wb2Nl\n\
    \        cnQuaXSCAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQQFAAOBgQA58B\n        Z+q1qSKpuffzTBpMtbeFkDIxMqMa+ycnxdMNvcWgCm1A9ZiFJsvqYhDDqA\n\
    \        XxfHjkrzXuSZkYq6WiQCsLp0aYVy40QCIwbOunhrvsxh3vsG5CgN76JzZ9\n        5Z/1OCFNhLfqf1VH2NSS8TaYCCi/VO7W1Q1KkcA2VlxlQP7McSUw==\n\
    \       mailReceipt: ssacceptance@postalser.example.com\n       LDIFLocationURL:\
    \ https://anpocert.example.com/anpocert.ldif.p7m\n       managedDomains: mail.anpocert.example.com\n\
    \       managedDomains: cert.company.example.com\n       managedDomains: costmec.example.com\n\
    \       description: Certified mail services for companies\n       dn: providerName=Postal\
    \ Services S.p.A,o=postacert\n       objectclass: top\n       objectclass: provider\n\
    \       providerName: Postal Services S.p.A\n       providerCertificateHash:\n\
    \        e00fdd9d88be0e2cc766b893315caf93d5701a6a\n       providerCertificate;binary::\n\
    \        MIIDHjCCAoegAwIBAgIBADANBgkqhkiG9w0BAQQFADBuMQswCQYDVQQGEw\n        JJVDEfMB0GA1UEChMWU2Vydml6aSBQb3N0YWxpIFMuci5sLjEPMA0GA1UE\n\
    \        CxMGRC5DLkMuMS0wKwYJKoZIhvcNAQkBFh5wb3N0YS1jZXJ0aWZpY2F0YU\n        BzZXJwb3N0YWwuaXQwHhcNMDIxMjA5MTczMjE2WhcNMDMxMjA5MTczMjE2\n\
    \        WjBuMQswCQYDVQQGEwJJVDEfMB0GA1UEChMWU2Vydml6aSBQb3N0YWxpIF\n        Muci5sLjEPMA0GA1UECxMGRC5DLkMuMS0wKwYJKoZIhvcNAQkBFh5wb3N0\n\
    \        YS1jZXJ0aWZpY2F0YUBzZXJwb3N0YWwuaXQwgZ8wDQYJKoZIhvcNAQEBBQ\n        ADgY0AMIGJAoGBAKoc7n6zA+sO8NATMcfJ+U2aoDEsrj/cObG3QAN6Sr+l\n\
    \        ygWxYXLBZNfSDWqL1K4edLr4gCZIDFsq0PIEaYZhYRGjhbcuJ9H/ZdtWdX\n        xcwEWN4mwFzlsASogsh5JeqS8db3A1JWkvhO9EUfaCYk8YMAkXYdCtLD9s\n\
    \        9tCYZeTE2ut9AgMBAAGjgcswgcgwHQYDVR0OBBYEFHPw7VJIoIM3VYhuHa\n        eAwpPF5leMMIGYBgNVHSMEgZAwgY2AFHPw7VJIoIM3VYhuHaeAwpPF5leM\n\
    \        oXKkcDBuMQswCQYDVQQGEwJJVDEfMB0GA1UEChMWU2Vydml6aSBQb3N0YW\n        xpIFMuci5sLjEPMA0GA1UECxMGRC5DLkMuMS0wKwYJKoZIhvcNAQkBFh5w\n\
    \        b3N0YS1jZXJ0aWZpY2F0YUBzZXJwb3N0YWwuaXSCAQAwDAYDVR0TBAUwAw\n        EB/zANBgkqhkiG9w0BAQQFAAOBgQApqeXvmOyEjwhMrXezPAXELMZwv4qq\n\
    \        r5ri4XuxTq6sS9jRsEbZrS+NmbcJ7S7eFwNQMNxYFVJqdWoLh8qExsTLXn\n        sKycSnHbCfuphrKvXjQvR2da75U4zGSkroiyvJ2s9TtiCcT3lQtIjmvrFb\n\
    \        aSBiyzj+za7foFUCQmxCLtDaA==\n       mailReceipt: takecharge@postalser.example.com\n\
    \       LDIFLocationURL: https://postalser.example.com/ldif.txt.p7m\n       managedDomains:\
    \ postal-services.example.com\n       managedDomains: receivedmail.example.com\n\
    \       description: Certified mail services for the public\n   The following\
    \ LDIF file represents an example of a PEC providers'\n   directory, containing\
    \ a base root and two fictitious providers, the\n   first of which handles a secondary\
    \ environment as well.  The\n   certificates inserted are two self-signed certificates\
    \ used for\n   example purposes only:\n       dn: o=postacert\n       objectclass:\
    \ top\n       objectclass: organization\n       objectClass: LDIFLocationURLObject\n\
    \       o: postacert\n       LDIFLocationURL: https://igpec.rupa.example.com/igpec.ldif.p7m\n\
    \       description: Base root for the PEC providers directory\n       dn: providerName=Anonymous\
    \ Certified Mail S.p.A.,o=postacert\n       objectclass: top\n       objectclass:\
    \ provider\n       providerName: Anonymous Certified Mail S.p.A.\n       providerCertificateHash:\n\
    \        7E7AEF1059AE0F454F2643A95F69EC3556009239\n       providerCertificate;binary::\n\
    \        MIIDBjCCAm+gAwIBAgIBADANBgkqhkiG9w0BAQQFADBmMQswCQYDVQQGEw\n        JJVDEpMCcGA1UEChMgQW5vbmltYSBQb3N0YSBDZXJ0aWZpY2F0YSBTLnAu\n\
    \        QS4xLDAqBgkqhkiG9w0BCQEWHXBvc3RhLWNlcnRpZmljYXRhQGFucG9jZX\n        J0Lml0MB4XDTAyMTIwOTE3MjQxNVoXDTAzMTIwOTE3MjQxNVowZjELMAkG\n\
    \        A1UEBhMCSVQxKTAnBgNVBAoTIEFub25pbWEgUG9zdGEgQ2VydGlmaWNhdG\n        EgUy5wLkEuMSwwKgYJKoZIhvcNAQkBFh1wb3N0YS1jZXJ0aWZpY2F0YUBh\n\
    \        bnBvY2VydC5pdDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAr8J+qK\n        KdxV9LzDMPqwnEy0P8H/KwbI0Szs8p6UZajZdpeUK0Ncbrv1QyXZNNtSMC\n\
    \        2uL09HDyx8agjgZWdhypnehguiSK3busha15RSpMGhiqxmz2b0HhOG73Gf\n        alZelqrwqmElna4MNUaLhbOvTd/sqPUS378w5IaIhWxzy34XcCAwEAAaOB\n\
    \        wzCBwDAdBgNVHQ4EFgQUN8lC0znQWEs0xspZ/aBzsaGvRZMwgZAGA1UdIw\n        SBiDCBhYAUN8lC0znQWEs0xspZ/aBzsaGvRZOhaqRoMGYxCzAJBgNVBAYT\n\
    \        AklUMSkwJwYDVQQKEyBBbm9uaW1hIFBvc3RhIENlcnRpZmljYXRhIFMucC\n        5BLjEsMCoGCSqGSIb3DQEJARYdcG9zdGEtY2VydGlmaWNhdGFAYW5wb2Nl\n\
    \        cnQuaXSCAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQQFAAOBgQA58B\n        Z+q1qSKpuffzTBpMtbeFkDIxMqMa+ycnxdMNvcWgCm1A9ZiFJsvqYhDDqA\n\
    \        XxfHjkrzXuSZkYq6WiQCsLp0aYVy40QCIwbOunhrvsxh3vsG5CgN76JzZ9\n        5Z/1OCFNhLfqf1VH2NSS8TaYCCi/VO7W1Q1KkcA2VlxlQP7McSUw==\n\
    \       mailReceipt: notifications@anpocert.it.example\n       LDIFLocationURL:\
    \ http://anpocert.example.com/anpocert.ldif.p7m\n       managedDomains: mail.anpocert.example.com\n\
    \       managedDomains: cert.company.example.com\n       managedDomains: costmec.example.com\n\
    \       description: Certified mail services for companies\n       dn: providerUnit=Secondary\
    \ Environment, providerName=Anonymous\n        Certified Mail S.p.A.,o=postacert\n\
    \       objectclass: top\n       objectclass: provider\n       providerName: Certified\
    \ Mail S.p.A.\n       providerUnit: Secondary Environment\n       providerCertificateHash:\n\
    \        7E7AEF1059AE0F454F2643A95F69EC3556009239\n       providerCertificate;binary::\n\
    \        MIIDBjCCAm+gAwIBAgIBADANBgkqhkiG9w0BAQQFADBmMQswCQYDVQQGEw\n        JJVDEpMCcGA1UEChMgQW5vbmltYSBQb3N0YSBDZXJ0aWZpY2F0YSBTLnAu\n\
    \        QS4xLDAqBgkqhkiG9w0BCQEWHXBvc3RhLWNlcnRpZmljYXRhQGFucG9jZX\n        J0Lml0MB4XDTAyMTIwOTE3MjQxNVoXDTAzMTIwOTE3MjQxNVowZjELMAkG\n\
    \        A1UEBhMCSVQxKTAnBgNVBAoTIEFub25pbWEgUG9zdGEgQ2VydGlmaWNhdG\n        EgUy5wLkEuMSwwKgYJKoZIhvcNAQkBFh1wb3N0YS1jZXJ0aWZpY2F0YUBh\n\
    \        bnBvY2VydC5pdDCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAr8J+qK\n        KdxV9LzDMPqwnEy0P8H/KwbI0Szs8p6UZajZdpeUK0Ncbrv1QyXZNNtSMC\n\
    \        2uL09HDyx8agjgZWdhypnehguiSK3busha15RSpMGhiqxmz2b0HhOG73Gf\n        alZelqrwqmElna4MNUaLhbOvTd/sqPUS378w5IaIhWxzy34XcCAwEAAaOB\n\
    \        wzCBwDAdBgNVHQ4EFgQUN8lC0znQWEs0xspZ/aBzsaGvRZMwgZAGA1UdIw\n        SBiDCBhYAUN8lC0znQWEs0xspZ/aBzsaGvRZOhaqRoMGYxCzAJBgNVBAYT\n\
    \        AklUMSkwJwYDVQQKEyBBbm9uaW1hIFBvc3RhIENlcnRpZmljYXRhIFMucC\n        5BLjEsMCoGCSqGSIb3DQEJARYdcG9zdGEtY2VydGlmaWNhdGFAYW5wb2Nl\n\
    \        cnQuaXSCAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQQFAAOBgQA58B\n        Z+q1qSKpuffzTBpMtbeFkDIxMqMa+ycnxdMNvcWgCm1A9ZiFJsvqYhDDqA\n\
    \        XxfHjkrzXuSZkYq6WiQCsLp0aYVy40QCIwbOunhrvsxh3vsG5CgN76JzZ9\n        5Z/1OCFNhLfqf1VH2NSS8TaYCCi/VO7W1Q1KkcA2VlxlQP7McSUw==\n\
    \       mailReceipt: notifications@secondary.anpocert.example.com\n       managedDomains:\
    \ management.anpocert.example.com\n       managedDomains: personnel.anpocert.example.com\n\
    \       description: Corporate internal services\n       dn: providerName=Postal\
    \ Services S.r.l.,o=postacert\n       objectclass: top\n       objectclass: provider\n\
    \       providerName: Postal Services S.r.l.\n       providerCertificateHash:\n\
    \        e00fdd9d88be0e2cc766b893315caf93d5701a6a\n       providerCertificate;binary::\n\
    \        MIIDHjCCAoegAwIBAgIBADANBgkqhkiG9w0BAQQFADBuMQswCQYDVQQGEw\n        JJVDEfMB0GA1UEChMWU2Vydml6aSBQb3N0YWxpIFMuci5sLjEPMA0GA1UE\n\
    \        CxMGRC5DLkMuMS0wKwYJKoZIhvcNAQkBFh5wb3N0YS1jZXJ0aWZpY2F0YU\n        BzZXJwb3N0YWwuaXQwHhcNMDIxMjA5MTczMjE2WhcNMDMxMjA5MTczMjE2\n\
    \        WjBuMQswCQYDVQQGEwJJVDEfMB0GA1UEChMWU2Vydml6aSBQb3N0YWxpIF\n        Muci5sLjEPMA0GA1UECxMGRC5DLkMuMS0wKwYJKoZIhvcNAQkBFh5wb3N0\n\
    \        YS1jZXJ0aWZpY2F0YUBzZXJwb3N0YWwuaXQwgZ8wDQYJKoZIhvcNAQEBBQ\n        ADgY0AMIGJAoGBAKoc7n6zA+sO8NATMcfJ+U2aoDEsrj/cObG3QAN6Sr+l\n\
    \        ygWxYXLBZNfSDWqL1K4edLr4gCZIDFsq0PIEaYZhYRGjhbcuJ9H/ZdtWdX\n        xcwEWN4mwFzlsASogsh5JeqS8db3A1JWkvhO9EUfaCYk8YMAkXYdCtLD9s\n\
    \        9tCYZeTE2ut9AgMBAAGjgcswgcgwHQYDVR0OBBYEFHPw7VJIoIM3VYhuHa\n        eAwpPF5leMMIGYBgNVHSMEgZAwgY2AFHPw7VJIoIM3VYhuHaeAwpPF5leM\n\
    \        oXKkcDBuMQswCQYDVQQGEwJJVDEfMB0GA1UEChMWU2Vydml6aSBQb3N0YW\n        xpIFMuci5sLjEPMA0GA1UECxMGRC5DLkMuMS0wKwYJKoZIhvcNAQkBFh5w\n\
    \        b3N0YS1jZXJ0aWZpY2F0YUBzZXJwb3N0YWwuaXSCAQAwDAYDVR0TBAUwAw\n        EB/zANBgkqhkiG9w0BAQQFAAOBgQApqeXvmOyEjwhMrXezPAXELMZwv4qq\n\
    \        r5ri4XuxTq6sS9jRsEbZrS+NmbcJ7S7eFwNQMNxYFVJqdWoLh8qExsTLXn\n        sKycPSnHbCfuphrKvXjQvR2da75U4zGSkroiyvJ2s9TtiCcT3lQtIjmvrF\n\
    \        baSBiyzj+za7foFUCQmxCLtDaA==\n       mailReceipt: ssacceptance@postalser.example.com\n\
    \       LDIFLocationURL: http://postalser.example.com/ldif.txt.p7m\n       managedDomains:\
    \ postal-services.example.com\n       managedDomains: receivedmail.example.com\n\
    \       description: Certified mail services for the public\n"
- title: 5.  Security-Related Aspects
  contents:
  - '5.  Security-Related Aspects

    '
- title: 5.1.  Digital Signature
  contents:
  - "5.1.  Digital Signature\n   It is recommended that a dedicated hardware module\
    \ be used to handle\n   private key and signature operations, the specifications\
    \ of which are\n   outside the scope of this document.  It's up to the PEC providers\
    \ to\n   conform to security requisites expected for the service.\n"
- title: 5.2.  Authentication
  contents:
  - "5.2.  Authentication\n   User access to PEC services through the Access Point\
    \ MUST be allowed\n   only upon successful user authentication on the system.\n\
    \   For example, authentication might use user-ID and password, or, if\n   available\
    \ and considered necessary for the type of service provided,\n   an electronic\
    \ ID card or the national services card.  Choice of\n   authentication method\
    \ is left to the better judgment of the service\n   provider.  Authentication\
    \ is necessary to guarantee as much as\n   possible that the message is sent by\
    \ a PEC user whose identification\n   data is congruent with the specified sender,\
    \ so as to avoid\n   falsification of the latter.\n"
- title: 5.3.  Secure Interaction
  contents:
  - "5.3.  Secure Interaction\n   To guarantee that the original message remains unaltered\
    \ during\n   transaction, envelopment and signature are applied on outgoing\n\
    \   messages at the Access Point, and subsequent verification of incoming\n  \
    \ messages is done at the Incoming Point.\n   All communications within the PEC\
    \ network MUST use secure channels.\n   Integrity and confidentiality of connections\
    \ between PEC provider and\n   user MUST be guaranteed through the use of secure\
    \ protocols, such as\n   those based on [TLS] and those that create a secure transport\
    \ channel\n   on which non-secure protocols can transmit (e.g., IPsec).\n   The\
    \ interaction between providers MUST take place using SMTP on\n   [TLS], as per\
    \ [SMTP-TLS].  The Incoming Point MUST provide and\n   announce its support for\
    \ the STARTTLS extension, as well as accept\n   both unencrypted connections (for\
    \ ordinary mail) and protected ones.\n   To guarantee complete traceability in\
    \ the flow of PEC messages, these\n   MUST NOT transit on systems external to\
    \ the PEC network.  When\n   exchanging messages between different providers,\
    \ all transactions\n   MUST take place between machines that belong to the PEC\
    \ network or\n   are directly managed by the provider.  An \"MX\" type record\
    \ MAY be\n   associated to each PEC domain defined within the system for name\n\
    \   resolution, in which case secondary reception systems specified in\n   that\
    \ record MUST be under direct control of the provider.  All in\n   conformance\
    \ with [SMTP].\n"
- title: 5.4.  Virus
  contents:
  - "5.4.  Virus\n   Another important security aspect that concerns the PEC system,\
    \ is\n   related to the technical and functional architecture that MUST block\n\
    \   the presence of viruses from endangering the security of all handled\n   messages.\
    \  It is therefore REQUIRED to have installations and\n   continuous updates of\
    \ anti-virus systems that hinder infections as\n   much as possible without intervening\
    \ on the content of the certified\n   mail, in compliance with what has been discussed\
    \ thus far.\n"
- title: 5.5.  S/MIME Certificate
  contents:
  - "5.5.  S/MIME Certificate\n   In this document the S/MIME certificate profile\
    \ is defined for use in\n   the certification of PEC messages done by the providers.\
    \  The\n   proposed profile of the S/MIME certificate is based on the IETF\n \
    \  standards [SMIMECERT] and [CRL], which in turn are based on the\n   standard\
    \ ISO/IEC 9594-8:2001.\n"
- title: 5.5.1.  Provider-Related Information (Subject)
  contents:
  - "5.5.1.  Provider-Related Information (Subject)\n   The information related to\
    \ the PEC provider holder of the certificate\n   MUST be inserted in the Subject\
    \ field (Subject DN).  More precisely,\n   the Subject DN MUST contain the PEC\
    \ provider's name as it is in the\n   \"providerName\" attribute published in\
    \ the PEC providers directory\n   (section 4.5), but the Subject DN does not have\
    \ to match the Provider\n   entry DN in the LDIF.  The providerName MUST be present\
    \ in the\n   CommonName or OrganizationName attributes of the \"Subject:\" field\
    \ in\n   the certificate.\n   Certificates MUST contain an Internet mail address,\
    \ which MUST have a\n   value in the subjectAltName extension, and SHOULD NOT\
    \ be present in\n   the Subject Distinguished Name.\n   Valid subjectDN are:\n\
    \        C=IT, O=AcmePEC S.p.A, CN=Posta Certificata\n        C=IT, O=ServiziPEC\
    \ S.p.A, CN=Posta Certificata\n   Valorization of other attributes in the Subject\
    \ DN, if present, MUST\n   be done in compliance with [CRL].\n"
- title: 5.5.2.  Certificate Extensions
  contents:
  - "5.5.2.  Certificate Extensions\n   Extensions that MUST be present in the S/MIME\
    \ certificate are:\n   o  Key Usage\n   o  Authority Key Identifier\n   o  Subject\
    \ Key Identifier\n   o  Subject Alternative Name\n   The Basic Constraints extension\
    \ (Object ID:2.5.29.19) MUST NOT be\n   present.\n   The valorization of the above\
    \ listed extensions for the described\n   profile follows.\n   The Key Usage extension\
    \ (Object ID: 2.5.29.15) MUST have the\n   digitalSignature bit (bit 0) activated\
    \ and MUST be marked as\n   critical.  The extension MAY contain other active\
    \ bits corresponding\n   to different Key Usage, as long as that doesn't contrast\
    \ with the\n   indications in [CRL].\n   The Authority Key Identifier (Object\
    \ ID: 2.5.29.35) MUST contain at\n   least the keyIdentifier field and MUST NOT\
    \ be marked as critical.\n   The Subject Key Identifier extension (Object ID:\
    \ 2.5.29.14) MUST\n   contain at least the keyIdentifier field and MUST NOT be\
    \ marked as\n   critical.\n   The Subject Alternative Name (Object ID: 2.5.29.17)\
    \ MUST contain at\n   least the rfc822Name field and MUST NOT be marked as critical.\n\
    \   Adding other extensions that have not been described in this document\n  \
    \ is to be considered OPTIONAL, as long as it remains compliant with\n   [CRL];\
    \ such added extensions MUST NOT be marked as critical.\n"
- title: 5.5.3.  Example
  contents:
  - "5.5.3.  Example\n   Following is an example of an S/MIME certificate compliant\
    \ with the\n   minimal requisites described in this profile.  Values used are\
    \ of\n   fictitious providers generated for example purposes only.\n"
- title: 5.5.3.1.  General-Use Certificate in Annotated Version
  contents:
  - "5.5.3.1.  General-Use Certificate in Annotated Version\n   An asterisk near the\
    \ label of an extension means that such an\n   extension has been marked as critical.\n\
    \       VERSION: 3\n       SERIAL: 11226 (0x2bda)\n       INNER SIGNATURE:\n \
    \        ALG. ID: id-sha1-with-rsa-encryption\n         PARAMETER: 0\n       ISSUER:\n\
    \         Country Name: IT\n         Organization Name: Certifier 1\n        \
    \ Organizational Unit Name: Certification Service Provider\n         Common Name:\
    \ Certifier S.p.A.\n       VALIDITY:\n         Not Before: Oct 5, 04 09:04:23\
    \ GMT\n         Not After: Oct 5, 05 09:04:23 GMT\n       SUBJECT:\n         Country\
    \ Name: IT\n         Organization Name: AcmePEC S.p.A.\n         Common Name:\
    \ Certified Mail\n       PUBLIC KEY: (key size is 1024 bits)\n       ALGORITHM:\n\
    \         ALG. ID: id-rsa-encryption\n         PARAMETER: 0\n       MODULUS: 0x00afbeb4\
    \ 5563198a aa9bac3f 1b29b5be\n                7f691945 89d01569 ca0d555b 5c33d7e9\n\
    \                ...\n                d15ff128 6792def5 b3f884e6 54b326db\n  \
    \              cf\n       EXPONENT: 0x010001\n       EXTENSIONS:\n         Subject\
    \ Alt Name:\n         RFC Name: posta-certificata@acmepec.it\n         Key Usage*:\
    \ Digital Signature\n         Authority Key Identifier: 0x12345678 aaaaaaaa bbbbbbbb\n\
    \                                   cccccccc dddddddd\n         Subject Key Identifier:\
    \ 0x3afae080 6453527a 3e5709d8 49a941a8\n                                 a3a70ae1\n\
    \       SIGNATURE:\n         ALG. ID: id-sha1-with-rsa-encryption\n         PARAMETER:\
    \ 0\n         VALUE: 0x874b4d25 70a46180 c9770a85 fe7923ce\n                b22d2955\
    \ 2f3af207 142b2aba 643aaa61\n                ...\n                d8fd10b4 c9e00ebc\
    \ c089f7a3 549a1907\n                ff885220 ce796328 b0f8ecac 86ffb1cc\n"
- title: 5.5.3.2.  General-Use Certificate in Dump ASN.1
  contents:
  - "5.5.3.2.  General-Use Certificate in Dump ASN.1\n   0 30  794: SEQUENCE {\n \
    \  4 30  514:  SEQUENCE {\n   8 A0   3:   [0] {\n   10 02  1:    INTEGER 2\n \
    \      :      }\n   13 02  2:   INTEGER 11226\n   17 30   13:  SEQUENCE {\n  \
    \ 19 06  9:    OBJECT IDENTIFIER\n         :      sha1withRSAEncryption (1 2 840\
    \ 113549 1 1 5)\n   30 05  0:    NULL\n         :    }\n   32 30  101:  SEQUENCE\
    \ {\n   34 31   11:   SET {\n   36 30   9:     SEQUENCE {\n   38 06   3:     \
    \ OBJECT IDENTIFIER countryName (2 5 4 6)\n   43 13   2:      PrintableString\
    \ 'IT'\n         :      }\n         :    }\n   47 31   28:   SET {\n   49 30 \
    \  26:    SEQUENCE {\n   51 06   3:      OBJECT IDENTIFIER organizationName (2\
    \ 5 4 10)\n   56 13   19:     PrintableString 'Certificatore 1'\n         :  \
    \    }\n         :    }\n   77 31   22:   SET {\n   79 30   20:    SEQUENCE {\n\
    \   81 06   3:   OBJECT IDENTIFIER organizationalUnitName (2 5 4 11)\n   86 13\
    \   13:    PrintableString 'Certification Service Provider'\n         :      }\n\
    \         :    }\n   101 31  32:   SET {\n   103 30  30:    SEQUENCE {\n   105\
    \ 06  3:      OBJECT IDENTIFIER commonName (2 5 4 3)\n   110 13  23:     PrintableString\
    \ 'Certificatore S.p.A.'\n         :      }\n         :    }\n         :  }\n\
    \   135 30  30:  SEQUENCE {\n   137 17  13:   UTCTime '041005090423Z'\n   152\
    \ 17  13:   UTCTime '051005090423Z'\n         :     }\n   167 30  66:  SEQUENCE\
    \ {\n   169 31  11:   SET {\n   171 30  9:     SEQUENCE {\n   173 06  3:     \
    \ OBJECT IDENTIFIER countryName (2 5 4 6)\n   178 13  2:      PrintableString\
    \ 'IT'\n         :      }\n         :    }\n   182 31  23:  SET {\n   184 30 \
    \ 21:   SEQUENCE {\n   186 06  3:     OBJECT IDENTIFIER organizationName (2 5\
    \ 4 10)\n   191 13  14:    PrintableString 'AcmePEC S.p.A.'\n         :      }\n\
    \         :    }\n   207 31  26:  SET {\n   209 30  24:   SEQUENCE {\n   211 06\
    \  3:     OBJECT IDENTIFIER commonName (2 5 4 3)\n   216 13  17:    PrintableString\
    \ 'Posta Certificata'\n         :      }\n         :    }\n         :  }\n   235\
    \ 30  159: SEQUENCE {\n   238 30  13:   SEQUENCE {\n   240 06  9:     OBJECT IDENTIFIER\
    \ rsaEncryption (1 2 840 113549\n                  1 1 1)\n   251 05  0:     NULL\n\
    \         :      }\n   253 03  141:  BIT STRING 0 unused bits\n         :    \
    \ 30 81 89 02 81 81 00 AF BE B4 55 63 19 8A AA 9B\n         :     AC 3F 1B 29\
    \ B5 BE 7F 69 19 45 89 D0 15 69 CA 0D\n         :     55 5B 5C 33 D7 E9 C8 6E\
    \ FC 14 46 C3 C3 09 47 DD\n         :     CD 10 74 1D 76 4E 71 14 E7 69 42 BE\
    \ 1C 47 61 85\n         :     4D 74 76 DD 0B B5 78 4F 1E 84 DD B4 86 7F 96 DF\n\
    \         :     5E 7B AF 0E CE EA 12 57 0B DF 9B 63 67 4D F9 37\n         :  \
    \   B7 48 35 27 C2 89 F3 C3 54 66 F7 DA 6C BE 4F 5D\n         :     85 55 07 A4\
    \ 97 8C D1 5F F1 28 67 92 DE F5 B3 F8\n         :         [ Another 12 bytes skipped\
    \ ]\n         :    }\n   397 A3  123: [3] {\n   399 30  121:  SEQUENCE {\n   401\
    \ 30  39:    SEQUENCE {\n   403 06  3:      OBJECT IDENTIFIER subjectAltName (2\
    \ 5 29 17)\n   408 04  32:     OCTET STRING\n         :      30 1E 81 1C 70 6F\
    \ 73 74 61 2D 63 65 72 74 69 66\n         :      69 63 61 74 61 40 61 63 6D 65\
    \ 70 65 63 2E 69 74\n         :     }\n   442 30  14:   SEQUENCE {\n   444 06\
    \  3:     OBJECT IDENTIFIER keyUsage (2 5 29 15)\n   449 01  1:     BOOLEAN TRUE\n\
    \   452 04  4:     OCTET STRING\n         :      03 02 07 80\n         :     \
    \ }\n   458 30  31:   SEQUENCE {\n   460 06  3:  OBJECT IDENTIFIER authorityKeyIdentifier\
    \ (2 5 29 35)\n   465 04  24:    OCTET STRING\n         :     30 16 11 11 11 11\
    \ AA AA AA AA AA BB BB BB BB CC CC\n         :     CC CC DD DD DD DD\n       \
    \  :      }\n   491 30  29:   SEQUENCE {\n   493 06  3:    OBJECT IDENTIFIER subjectKeyIdentifier\
    \ (2 5 29 14)\n   498 04  22:    OCTET STRING\n         :      04 14 3A FA E0\
    \ 80 64 53 52 7A 3E 57 09 D8 49 A9\n         :      41 A8 A3 A7 0A E1\n      \
    \   :      }\n         :     }\n         :    }\n         :   }\n   522 30  13:\
    \ SEQUENCE {\n   524 06  9:   OBJECT IDENTIFIER\n         :      sha1withRSAEncryption\
    \ (1 2 840 113549 1 1 5)\n   535 05  0:   NULL\n         :    }\n   537 03  257:\
    \ BIT STRING 0 unused bits\n         :     87 4B 4D 25 70 A4 61 80 C9 77 0A 85\
    \ FE 79 23 CE\n         :     B2 2D 29 55 2F 3A F2 07 14 2B 2A BA 64 3A AA 61\n\
    \         :     1F F0 E7 3F C4 E6 13 E2 09 3D F0 E1 83 A0 C0 F2\n         :  \
    \   C6 71 7F 3A 1C 80 7F 15 B3 D6 1E 22 79 B8 AC 91\n         :     51 83 F2 3A\
    \ 84 86 B6 07 2B 22 E8 01 52 2D A4 50\n         :     9F C6 42 D4 7C 38 B1 DD\
    \ 88 CD FC E8 C3 12 C3 62\n         :     64 0F 16 BF 70 15 BC 01 16 78 30 2A\
    \ DA FA F3 70\n         :     E2 D3 0F 00 B0 FD 92 11 6C 55 45 48 F5 64 ED 98\n\
    \         :         [ Another 128 bytes skipped ]\n         : }\n"
- title: 5.6.  PEC Providers Directory
  contents:
  - "5.6.  PEC Providers Directory\n   The contents of the PEC providers directory\
    \ MUST be queried via\n   [HTTP] on a Secure Socket Layer (SSL), as described\
    \ in [TLS],\n   exclusively by licensed providers that have the necessary user\n\
    \   certificates; this access modality guarantees authenticity,\n   integrity,\
    \ and confidentiality of data.  Each provider downloads the\n   LDIF file through\
    \ an [HTTPS] session, which is authenticated by\n   checking the X.509 certificate\
    \ issued by a certification authority.\n"
- title: 6.  PEC System Client Technical and Functional Prerequisites
  contents:
  - "6.  PEC System Client Technical and Functional Prerequisites\n   This section\
    \ lists the prerequisites that must be respected by a\n   client in order to guarantee\
    \ the minimal operative functionalities to\n   the user of a general PEC system:\n\
    \   o  handling of Access and Delivery Points through secure channels;\n   o \
    \ handling of user authentication in message dispatch and reception\n      which\
    \ make use of standard protocols, such as [IMAP], [POP3], and\n      [HTTP];\n\
    \   o  support for MIME format according to [MIME1] and [MIME5];\n   o  support\
    \ for \"ISO-8859-1 (Latin-1)\" character set;\n   o  support for S/MIME v3 standard,\
    \ as in [SMIMEV3], for verification\n      of signatures applied to PEC envelopes\
    \ and notifications.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   All security considerations from [CMS] and [SMIMEV3]\
    \ apply to\n   applications that use procedures described in this document.\n\
    \   The centralized LDAP server is a critical point for the security of\n   the\
    \ whole PEC system.  An attack could compromise the whole PEC\n   system.  PEC\
    \ providers that periodically download the LDIF file\n   SHOULD use the best security\
    \ technology to protect it from local\n   attacks.  A PEC provider could be compromised\
    \ if an attacker changed\n   a certificate or modified the list of domains associated\
    \ to it in the\n   LDIF file that was copied to the PEC provider system.\n   When\
    \ verifying the validity of the signature of a message, the\n   recipient system\
    \ SHOULD verify that the certificate included in the\n   [CMS] message is present\
    \ in the LDIF file (section 4.5) and that the\n   domain extracted by the [EMAIL]\
    \ \"From:\" header is listed in the\n   managedDomains attribute associated to\
    \ said certificate.\n"
- title: 8.  IANA Considerations
  contents:
  - '8.  IANA Considerations

    '
- title: 8.1.  Registration of PEC Message Header Fields
  contents:
  - "8.1.  Registration of PEC Message Header Fields\n   This document defines new\
    \ header fields used in the messages that\n   transit in the PEC network.  As\
    \ specified and required by\n   [HEADERS-IANA], this document registers new header\
    \ fields as\n   Provisional Message Header Fields as follows.\n"
- title: '8.1.1.  Header Field: X-Riferimento-Message-ID:'
  contents:
  - "8.1.1.  Header Field: X-Riferimento-Message-ID:\n   Applicable protocol: mail\
    \ [EMAIL]\n   Status: provisional\n   Author/Change controller:\n      Claudio\
    \ Petrucci\n      DigitPA\n      Viale Carlo Marx 31/49\n      00137 Roma\n  \
    \    Italy\n      EMail: PETRUCCI@digitpa.gov.it\n   Specification document: this\
    \ document, section 2.2.1, Appendix A.\n"
- title: '8.1.2.  Header Field: X-Ricevuta:'
  contents:
  - "8.1.2.  Header Field: X-Ricevuta:\n   Applicable protocol: mail [EMAIL]\n   Status:\
    \ provisional\n   Author/Change controller:\n      Claudio Petrucci\n      DigitPA\n\
    \      Viale Carlo Marx 31/49\n      00137 Roma\n      Italy\n      EMail: PETRUCCI@digitpa.gov.it\n\
    \   Specification document: this document, sections 2.1.1.1.1, 3.1.2,\n      \
    \                     3.1.3, 3.1.4, 3.1.6, 3.2.1, 3.2.3, 3.2.4,\n            \
    \               3.3.2, 3.3.3, Appendix A.\n"
- title: '8.1.3.  Header Field: X-VerificaSicurezza:'
  contents:
  - "8.1.3.  Header Field: X-VerificaSicurezza:\n   Applicable protocol: mail [EMAIL]\n\
    \   Status: provisional\n   Author/Change controller:\n      Claudio Petrucci\n\
    \      DigitPA\n      Viale Carlo Marx 31/49\n      00137 Roma\n      Italy\n\
    \      EMail: PETRUCCI@digitpa.gov.it\n   Specification document: this document,\
    \ sections 2.1.1.1.3, 3.1.3,\n                           3.2.4, Appendix A.\n"
- title: '8.1.4.  Header Field: X-Trasporto:'
  contents:
  - "8.1.4.  Header Field: X-Trasporto:\n   Applicable protocol: mail [EMAIL]\n  \
    \ Status: provisional\n   Author/Change controller:\n      Claudio Petrucci\n\
    \      DigitPA\n      Viale Carlo Marx 31/49\n      00137 Roma\n      Italy\n\
    \      EMail: PETRUCCI@digitpa.gov.it\n   Specification document: this document,\
    \ sections 3.1.5, 3.2.2,\n                           Appendix A.\n"
- title: '8.1.5.  Header Field: X-TipoRicevuta:'
  contents:
  - "8.1.5.  Header Field: X-TipoRicevuta:\n   Applicable protocol: mail [EMAIL]\n\
    \   Status: provisional\n   Author/Change controller:\n      Claudio Petrucci\n\
    \      DigitPA\n      Viale Carlo Marx 31/49\n      00137 Roma\n      Italy\n\
    \      EMail: PETRUCCI@digitpa.gov.it\n   Specification document: this document,\
    \ sections 3.1.5, 3.3.2,\n                           3.3.2.1, 3.3.2.2, 3.3.2.3,\
    \ Appendix A.\n"
- title: '8.1.6.  Header Field: X-Mittente:'
  contents:
  - "8.1.6.  Header Field: X-Mittente:\n   Applicable protocol: mail [EMAIL]\n   Status:\
    \ provisional\n   Author/Change controller:\n      Claudio Petrucci\n      DigitPA\n\
    \      Viale Carlo Marx 31/49\n      00137 Roma\n      Italy\n      EMail: PETRUCCI@digitpa.gov.it\n\
    \   Specification document: this document, sections 3.2.3, Appendix A.\n"
- title: 8.2.  Registration of LDAP Object Identifier Descriptors
  contents:
  - "8.2.  Registration of LDAP Object Identifier Descriptors\n   This document defines\
    \ new LDAP attributes and object classes for\n   object identifier descriptors.\
    \  As specified and required by\n   [LDAP-IANA], this document registers new descriptors\
    \ as follows per\n   the Expert Review.\n"
- title: 8.2.1.  Registration of Object Classes and Attribute Types
  contents:
  - "8.2.1.  Registration of Object Classes and Attribute Types\n   Subject: Request\
    \ for LDAP Descriptor Registration\n   Descriptor (short name): See comments\n\
    \   Object Identifier: See comments\n   Person & email address to contact for\
    \ further information:\n      See \"Author/Change Controller\"\n   Usage: See\
    \ comments\n   Specification: (I-D)\n   Author/Change Controller:\n      Claudio\
    \ Petrucci\n      DigitPA\n      Viale Carlo Marx 31/49\n      00137 Roma\n  \
    \    Italy\n      EMail: PETRUCCI@digitpa.gov.it\n   Comments:\n      The following\
    \ object identifiers and associated object classes/\n      attribute types are\
    \ requested to be registered.\n   OID                         Descriptor     \
    \         Usage\n   ------------------------    ---------------------   ------\n\
    \   1.3.6.1.4.1.16572.2.1.1     LDIFLocationURLObject      O\n   1.3.6.1.4.1.16572.2.1.2\
    \     provider                   O\n   1.3.6.1.4.1.16572.2.2.1     providerCertificateHash\
    \    A\n   1.3.6.1.4.1.16572.2.2.2     providerCertificate        A\n   1.3.6.1.4.1.16572.2.2.3\
    \     providerName               A\n   1.3.6.1.4.1.16572.2.2.4     mailReceipt\
    \                A\n   1.3.6.1.4.1.16572.2.2.5     managedDomains            \
    \ A\n   1.3.6.1.4.1.16572.2.2.6     LDIFLocationURL            A\n   1.3.6.1.4.1.16572.2.2.7\
    \     providerUnit               A\n   Legend\n   -------------------\n   O =>\
    \ Object Class\n   A => Attribute Type\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [ABNF]          Crocker, D., Ed., and P. Overell,\
    \ \"Augmented BNF for\n                   Syntax Specifications: ABNF\", STD 68,\
    \ RFC 5234,\n                   January 2008.\n   [CMS]           Housley, R.,\
    \ \"Cryptographic Message Syntax (CMS)\",\n                   STD 70, RFC 5652,\
    \ September 2009.\n   [CRL]           Cooper, D., Santesson, S., Farrell, S.,\
    \ Boeyen, S.,\n                   Housley, R., and W. Polk, \"Internet X.509 Public\
    \ Key\n                   Infrastructure Certificate and Certificate Revocation\n\
    \                   List (CRL) Profile\", RFC 5280, May 2008.\n   [EMAIL]    \
    \     Resnick, P., Ed., \"Internet Message Format\", RFC\n                   5322,\
    \ October 2008.\n   [HEADERS-IANA]  Klyne, G., Nottingham, M., and J. Mogul,\n\
    \                   \"Registration Procedures for Message Header Fields\",\n \
    \                  BCP 90, RFC 3864, September 2004.\n   [HTTP]          Fielding,\
    \ R., Gettys, J., Mogul, J., Frystyk, H.,\n                   Masinter, L., Leach,\
    \ P., and T. Berners-Lee,\n                   \"Hypertext Transfer Protocol --\
    \ HTTP/1.1\", RFC 2616,\n                   June 1999.\n   [HTTPS]         Rescorla,\
    \ E., \"HTTP Over TLS\", RFC 2818, May 2000.\n   [IMAP]          Crispin, M.,\
    \ \"INTERNET MESSAGE ACCESS PROTOCOL -\n                   VERSION 4rev1\", RFC\
    \ 3501, March 2003.\n   [LDAP]          Zeilenga, K., Ed., \"Lightweight Directory\
    \ Access\n                   Protocol (LDAP): Technical Specification Road Map\"\
    ,\n                   RFC 4510, June 2006.\n   [LDAP-IANA]     Zeilenga, K., \"\
    Internet Assigned Numbers Authority\n                   (IANA) Considerations\
    \ for the Lightweight Directory\n                   Access Protocol (LDAP)\",\
    \ BCP 64, RFC 4520, June 2006.\n   [LDAP-SYNTAXES] Legg, S., Ed., \"Lightweight\
    \ Directory Access Protocol\n                   (LDAP): Syntaxes and Matching\
    \ Rules\", RFC 4517, June\n                   2006.\n   [LDIF]          Good,\
    \ G., \"The LDAP Data Interchange Format (LDIF) -\n                   Technical\
    \ Specification\", RFC 2849, June 2000.\n   [MIME1]         Freed, N. and N. Borenstein,\
    \ \"Multipurpose Internet\n                   Mail Extensions (MIME) Part One:\
    \ Format of Internet\n                   Message Bodies\", RFC 2045, November\
    \ 1996.\n   [MIME5]         Freed, N. and N. Borenstein, \"Multipurpose Internet\n\
    \                   Mail Extensions (MIME) Part Five: Conformance\n          \
    \         Criteria and Examples\", RFC 2049, November 1996.\n   [SUBMISSION] \
    \   Gellens, R. and J. Klensin, \"Message Submission for\n                   Mail\"\
    , RFC 4409, April 2006.\n   [POP3]          Myers, J. and M. Rose, \"Post Office\
    \ Protocol -\n                   Version 3\", STD 53, RFC 1939, May 1996.\n  \
    \ [REQ]           Bradner, S., \"Key words for use in RFCs to Indicate\n     \
    \              Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [SHA1]\
    \          Eastlake 3rd, D. and P. Jones, \"US Secure Hash\n                 \
    \  Algorithm 1 (SHA1)\", RFC 3174, September 2001.\n   [MIME-SECURE]   Galvin,\
    \ J., Murphy, S., Crocker, S., and N. Freed,\n                   \"Security Multiparts\
    \ for MIME: Multipart/Signed and\n                   Multipart/Encrypted\", RFC\
    \ 1847, October 1995.\n   [SMIMEV3]       Ramsdell, B. and S. Turner, \"Secure/Multipurpose\n\
    \                   Internet Mail Extensions (S/MIME) Version 3.2 Message\n  \
    \                 Specification\", RFC 5751, January 2010.\n   [SMIMECERT]   \
    \  Ramsdell, B. and S. Turner, \"Secure/Multipurpose\n                   Internet\
    \ Mail Extensions (S/MIME) Version 3.2\n                   Certificate Handling\"\
    , RFC 5750, January 2010.\n   [SMTP]          Klensin, J., \"Simple Mail Transfer\
    \ Protocol\", RFC\n                   5321, October 2008.\n   [SMTP-DSN]     \
    \ Moore, K., \"Simple Mail Transfer Protocol (SMTP)\n                   Service\
    \ Extension for Delivery Status Notifications\n                   (DSNs)\", RFC\
    \ 3461, January 2003.\n   [SMTP-TLS]      Hoffman, P., \"SMTP Service Extension\
    \ for Secure SMTP\n                   over Transport Layer Security\", RFC 3207,\
    \ February\n                   2002.\n   [TIMESTAMP]     Klyne, G. and C. Newman,\
    \ \"Date and Time on the\n                   Internet: Timestamps\", RFC 3339,\
    \ July 2002.\n   [TLS]           Dierks, T. and E. Rescorla, \"The Transport Layer\n\
    \                   Security (TLS) Protocol Version 1.2\", RFC 5246,\n       \
    \            August 2008.\n   [XML]           W3C, \"Extensible Markup Language\
    \ (XML) 1.0 (Fifth\n                   Edition)\", W3C Recommendation, November\
    \ 2008,\n                   <http://www.w3.org/TR/2006/REC-xml-20060816/>.\n"
- title: 9.2. Informative References
  contents:
  - "9.2. Informative References\n   [RFC1034]       Mockapetris, P., \"Domain names\
    \ - concepts and\n                   facilities\", STD 13, RFC 1034, November\
    \ 1987.\n   [RFC4522]       Legg, S., \"Lightweight Directory Access Protocol\n\
    \                   (LDAP): The Binary Encoding Option\", RFC 4522, June\n   \
    \                2006.\n   [RFC4523]      Zeilenga, K., \"Lightweight Directory\
    \ Access Protocol\n                   (LDAP) Schema Definitions for X.509 Certificates\"\
    ,\n                   RFC 4523, June 2006.\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   The Italian document on which this document is based,\
    \ is a product of\n   the collaboration of many with the supervision of the National\
    \ Center\n   for Informatics in the Public Administration of Italy (DigitPA).\n"
- title: Appendix A.  Italian Fields and Values in English
  contents:
  - "Appendix A.  Italian Fields and Values in English\n   NOTE: The right column\
    \ represents a translation of the Italian fields\n         for readability's sake\
    \ only.  Header fields that MUST be used\n         are the ones in the left column.\n\
    \    X-Riferimento-Message-ID        Reference Message Identifier\n    X-Ricevuta\
    \                      Notification\n      non-accettazione                non\
    \ acceptance\n      accettazione                    server-user acceptance\n \
    \     preavviso-errore-consegna       delivery error advance notice\n      presa-in-carico\
    \                 server-server acceptance\n      rilevazione-virus          \
    \     virus detection\n      errore-consegna                 delivery error\n\
    \      avvenuta-consegna               message delivered\n    X-Mittente     \
    \                 Sender\n    X-VerificaSicurezza             Security Verification\n\
    \      errore                          error\n    X-Trasporto                \
    \     Transport\n      posta-certificata               certified mail\n      errore\
    \                          error\n    X-TipoRicevuta                  Notification\
    \ Type\n      completa                        complete\n      breve          \
    \                 brief\n      sintetica                       concise\n    certificatore\
    \                   certificator\n    Subject values:\n      Accettazione    \
    \               SERVER-USER ACCEPTANCE\n      Posta certificata              CERTIFIED\
    \ MAIL\n      Presa in carico                SERVER-SERVER ACCEPTANCE\n      Consegna\
    \                       DELIVERY\n      Anomalia messaggio             MESSAGE\
    \ ANOMALY\n      Problema di sicurezza          SECURITY PROBLEM\n      Avviso\
    \ di non accettazione     NON ACCEPTANCE PEC NOTIFICATION\n      Avviso di non\
    \ accettazione     VIRUS DETECTION INDUCED NON\n      per virus              \
    \        ACCEPTANCE PEC NOTIFICATION\n      Avviso di mancata consegna     NON\
    \ DELIVERY PEC NOTIFICATION\n      Avviso di mancata consegna     NON DELIVERY\
    \ DUE TO VIRUS PEC\n      per virus                      NOTIFICATION\n      Avviso\
    \ di mancata consegna     NON DELIVERY DUE TO TIMEOUT PEC\n      per sup. tempo\
    \ massimo         NOTIFICATION\n   Italian terms in the DTD relative to the certification\
    \ XML file:\n      accettazione                   server-user acceptance\n   \
    \   altro                          other\n      avvenuta-consegna            \
    \  delivered\n      certificato                    certificate\n      consegna\
    \                       delivery\n      data                           date\n\
    \      dati                           data\n      destinatari                \
    \    recipients\n      esterno                        external\n      errore \
    \                        error\n      errore-consegna                delivery\
    \ error\n      errore-esteso                  extensive error\n      gestore-emittente\
    \              transmitting provider\n      giorno                         day\n\
    \      identificativo                 identifier\n      intestazione         \
    \          header\n      mittente                       sender\n      no-dest(inatario)\
    \              no recipient\n      no-dominio                     no domain\n\
    \      non-accettazione               non acceptance\n      nessuno          \
    \              none\n      oggetto                        subject\n      ora \
    \                           hour\n      posta-certificata              certified\
    \ mail\n      preavviso-errore-consegna      delivery error advance notice\n \
    \     presa-in-carico                server-server acceptance\n      ricevuta\
    \                       notification\n      ricezione                      receipt\
    \ (the act of receiving)\n      rilevazione-virus              virus detection\n\
    \      risposte                       replies\n      tipo                    \
    \       type\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Claudio Petrucci\n   DigitPA\n   Viale Marx 31/49\n  \
    \ 00137 Roma\n   Italy\n   EMail: petrucci@digitpa.gov.it\n   Francesco Gennai\n\
    \   ISTI-CNR\n   Via Moruzzi, 1\n   56126 Pisa\n   Italy\n   EMail: francesco.gennai@isti.cnr.it\n\
    \   Alba Shahin\n   ISTI-CNR\n   Via Moruzzi, 1\n   56126 Pisa\n   Italy\n   EMail:\
    \ alba.shahin@isti.cnr.it\n   Alessandro Vinciarelli\n   Via delle Vigne di Morena\
    \ 113\n   00118 Roma\n   Italy\n   EMail: alessandro.vinciarelli@gmail.com\n"
