- title: __initial_text__
  contents:
  - '                Multiple Care-of Addresses Registration

    '
- title: Abstract
  contents:
  - "Abstract\n   According to the current Mobile IPv6 specification, a mobile node\
    \ may\n   have several care-of addresses but only one, called the primary\n  \
    \ care-of address, can be registered with its home agent and the\n   correspondent\
    \ nodes.  However, for matters of cost, bandwidth, delay,\n   etc, it is useful\
    \ for the mobile node to get Internet access through\n   multiple accesses simultaneously,\
    \ in which case the mobile node would\n   be configured with multiple active IPv6\
    \ care-of addresses.  This\n   document proposes extensions to the Mobile IPv6\
    \ protocol to register\n   and use multiple care-of addresses.  The extensions\
    \ proposed in this\n   document can be used by mobile routers using the NEMO (Network\n\
    \   Mobility) Basic Support protocol as well.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright and License Notice
  contents:
  - "Copyright and License Notice\n   Copyright (c) 2009 IETF Trust and the persons\
    \ identified as the\n   document authors.  All rights reserved.\n   This document\
    \ is subject to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF\
    \ Documents\n   (http://trustee.ietf.org/license-info) in effect on the date of\n\
    \   publication of this document.  Please review these documents\n   carefully,\
    \ as they describe your rights and restrictions with respect\n   to this document.\
    \  Code Components extracted from this document must\n   include Simplified BSD\
    \ License text as described in Section 4.e of\n   the Trust Legal Provisions and\
    \ are provided without warranty as\n   described in the BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................3\n  \
    \ 3. Protocol Overview ...............................................4\n   4.\
    \ Mobile IPv6 Extensions .........................................10\n      4.1.\
    \ Binding Cache Structure and Binding Update List ...........10\n      4.2. Binding\
    \ Update Message ....................................10\n      4.3. Binding Identifier\
    \ Mobility Option ........................11\n      4.4. New Status Values for\
    \ Binding Acknowledgement .............13\n   5. Mobile Node Operation ..........................................14\n\
    \      5.1. Management of Care-of Address(es) and Binding\n           Identifier(s)\
    \ .............................................14\n      5.2. Binding Registration\
    \ ......................................15\n      5.3. Bulk Registration .........................................16\n\
    \      5.4. Binding De-Registration ...................................16\n  \
    \    5.5. Returning Home with Complete Binding\n           De-Registration: Using\
    \ a Single Interface .................17\n           5.5.1. Using Only the Interface\
    \ Attached to the\n                  Home Link ..........................................17\n\
    \           5.5.2. Using Only the Interface Attached to the\n                \
    \  Visited Link .......................................17\n      5.6. Returning\
    \ Home: Simultaneous Home and Visited Link\n           Operation .................................................18\n\
    \           5.6.1. Problems of Simultaneous Home and Foreign\n               \
    \   Attachments ........................................18\n           5.6.2.\
    \ Overview and Approach ..............................18\n           5.6.3. Home\
    \ Binding Support ...............................19\n           5.6.4. Sending\
    \ Packets from the Home Link .................20\n           5.6.5. Leaving from\
    \ the Home Link .........................20\n      5.7. Receiving Binding Acknowledgement\
    \ .........................21\n      5.8. Receiving Binding Refresh Request .........................22\n\
    \      5.9. Bootstrapping .............................................22\n  \
    \ 6. Home Agent and Correspondent Node Operation ....................22\n    \
    \  6.1. Searching Binding Cache with Binding Identifier ...........22\n      6.2.\
    \ Processing Binding Update .................................23\n      6.3. Sending\
    \ a Binding Acknowledgement for Home Link\n           Registration ..............................................25\n\
    \      6.4. Sending Binding Refresh Request ...........................27\n  \
    \    6.5. Receiving Packets from Mobile Node ........................27\n   7.\
    \ Network Mobility Applicability .................................27\n   8. DSMIPv6\
    \ Applicability ..........................................27\n      8.1. IPv4\
    \ Care-of Address Registration .........................28\n      8.2. IPv4 Home\
    \ Address Management ..............................29\n   9. IPsec and IKEv2 Interaction\
    \ ....................................30\n      9.1. Use of Care-of Address in\
    \ the IKEv2 Exchange ..............31\n      9.2. Transport Mode IPsec-Protected\
    \ Messages ...................31\n      9.3. Tunnel Mode IPsec-Protected Messages\
    \ ......................31\n           9.3.1. Tunneled Home Test Init and Home\
    \ Test Messages .....31\n           9.3.2. Tunneled Payload Traffic ...........................32\n\
    \   10. Security Considerations .......................................33\n  \
    \ 11. IANA Considerations ...........................................34\n   12.\
    \ Acknowledgements ..............................................35\n   13. References\
    \ ....................................................35\n      13.1. Normative\
    \ References .....................................35\n      13.2. Informative\
    \ References ...................................35\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   A mobile node may use various types of network interfaces\
    \ to obtain\n   durable and wide area network connectivity.  This has increasingly\n\
    \   become true with mobile nodes having multiple interfaces, such as\n   802.2,\
    \ 802.11, 802.16, cellular radios, etc.  The motivations for and\n   benefits\
    \ of using multiple points of attachment are discussed in\n   [MOTIVATION].  When\
    \ a mobile node with multiple interfaces uses\n   Mobile IPv6 [RFC3775] for mobility\
    \ management, it cannot use its\n   multiple interfaces to send and receive packets\
    \ while taking\n   advantage of session continuity provided by Mobile IPv6.  This\
    \ is\n   because Mobile IPv6 allows the mobile node to bind only one care-of\n\
    \   address at a time with its home address.  See [MIP6ANALYSIS] for a\n   further\
    \ analysis of using multiple interfaces and addresses with\n   Mobile IPv6.\n\
    \   This document proposes extensions to Mobile IPv6 to allow a mobile\n   node\
    \ to register multiple care-of addresses for a home address and\n   create multiple\
    \ binding cache entries.  A new Binding Identification\n   (BID) number is created\
    \ for each binding the mobile node wants to\n   create and is sent in the Binding\
    \ Update.  The home agent that\n   receives this Binding Update creates a separate\
    \ binding for each BID.\n   The BID information is stored in the corresponding\
    \ binding cache\n   entry.  The BID information can now be used to identify individual\n\
    \   bindings.  The same extensions can also be used in Binding Updates\n   sent\
    \ to the correspondent nodes.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n\
    \   Terms used in this document are defined in [RFC3775], [RFC3753], and\n   [RFC4885].\
    \  In addition to or as a replacement of these, the\n   following terms are defined\
    \ or redefined:\n   Binding Identification Number (BID)\n      The BID is an identification\
    \ number used to distinguish multiple\n      bindings registered by the mobile\
    \ node.  Assignment of distinct\n      BIDs allows a mobile node to register multiple\
    \ binding cache\n      entries for a given home address.  BIDs assigned to the\
    \ same home\n      address must not be duplicated at the same time.  The value\
    \ zero\n      is reserved for future extensions.  Each BID is generated and\n\
    \      managed by a mobile node.  The BID is stored in the Binding Update\n  \
    \    List and is sent by the mobile node in the Binding Update.  A\n      mobile\
    \ node may change the value of a BID at any time according to\n      its administrative\
    \ policy -- for instance, to protect its privacy.\n      An implementation must\
    \ carefully assign the BID so as to keep\n      using the same BID for the same\
    \ binding even when the status of\n      the binding is changed.  More details\
    \ can be found in Section 5.1.\n   Binding Identifier Mobility Option\n      The\
    \ Binding Identifier mobility option is used to carry the BID\n      information.\n\
    \   Bulk Registration\n      A mobile node can register multiple bindings at once\
    \ by sending a\n      single Binding Update.  A mobile node can also replace some\
    \ or all\n      of the bindings available at the home agent with the new bindings\n\
    \      by using the bulk registration.  Bulk registration is supported\n     \
    \ only for home registration (i.e., with the home agent) as\n      explained in\
    \ Section 5.3.  A mobile node must not perform the bulk\n      registration mechanism\
    \ described in this specification with a\n      correspondent node.\n"
- title: 3.  Protocol Overview
  contents:
  - "3.  Protocol Overview\n   A new extension called the Binding Identification number\
    \ (BID) is\n   introduced to distinguish between multiple bindings pertaining\
    \ to the\n   same home address.  If a mobile node configures several IPv6 global\n\
    \   addresses on one or more of its interfaces, it can register these\n   addresses\
    \ with its home agent as care-of addresses.  If the mobile\n   node wants to register\
    \ multiple bindings, it MUST generate a BID for\n   each care-of address and store\
    \ the BID in the Binding Update List.  A\n   mobile node can manipulate each binding\
    \ independently by using the\n   BIDs.  The mobile node then registers its care-of\
    \ addresses by\n   sending a Binding Update with a Binding Identifier mobility\
    \ option.\n   The BID is included in the Binding Identifier mobility option. \
    \ After\n   receiving the Binding Update with a Binding Identifier mobility\n\
    \   option, the home agent MUST copy the BID from the Binding Identifier\n   mobility\
    \ option to the corresponding field in the binding cache\n   entry.  If there\
    \ is an existing binding cache entry for the mobile\n   node, and if the BID in\
    \ the Binding Update does not match the one\n   with the existing entry, the home\
    \ agent MUST create a new binding\n   cache entry for the new care-of address\
    \ and BID.  The mobile node can\n   either register multiple care-of addresses\
    \ at once in a single\n   Binding Update or independently in individual Binding\
    \ Updates.\n   If the mobile host wishes to register its binding with a\n   correspondent\
    \ node, it must perform return routability operations as\n   described in [RFC3775].\
    \  This includes managing a Care-of Keygen\n   token per care-of address and exchanging\
    \ Care-of Test Init and Care-\n   of Test messages with the correspondent node\
    \ for each care-of\n   address.  The mobile node MAY use the same BID that it\
    \ used with the\n   home agent for a particular care-of address.  For protocol\n\
    \   simplicity, bulk registration to correspondent nodes is not supported\n  \
    \ in this document.  This is because the return routability mechanism\n   introduced\
    \ in [RFC3775] cannot be easily extended to verify multiple\n   care-of addresses\
    \ stored in a single Binding Update.\n   Figure 1 illustrates the configuration\
    \ where the mobile node obtains\n   multiple care-of addresses at foreign links.\
    \  The mobile node can\n   utilize all the care-of addresses.  In Figure 1, the\
    \ home address of\n   the mobile node (MN) is 2001:db8::EUI.  The mobile node\
    \ has 3\n   different interfaces and possibly acquires care-of addresses 1-3\n\
    \   (CoA1, CoA2, CoA3).  The mobile node assigns BID1, BID2, and BID3 to\n   each\
    \ care-of address.\n                       +----+\n                       | CN\
    \ |\n                       +--+-+\n                          |\n            \
    \          +---+------+          +----+\n               +------+ Internet |----------+\
    \ HA |\n               |      +----+---+-+          +--+-+\n           CoA2| \
    \          |   |               |   Home Link\n            +--+--+        |   |\
    \         ------+------\n            |  MN +--------+   |\n            +--+--+\
    \ CoA1       |\n           CoA3|               |\n               +---------------+\n\
    \        Binding Cache Database:\n           home agent's binding (Proxy neighbor\
    \ advertisement is active)\n                 binding [2001:db8::EUI  BID1 care-of\
    \ address1]\n                 binding [2001:db8::EUI  BID2 care-of address2]\n\
    \                 binding [2001:db8::EUI  BID3 care-of address3]\n           correspondent\
    \ node's binding\n                 binding [2001:db8::EUI  BID1 care-of address1]\n\
    \                 binding [2001:db8::EUI  BID2 care-of address2]\n           \
    \      binding [2001:db8::EUI  BID3 care-of address3]\n           Figure 1: Multiple\
    \ Care-of Addresses Registration\n   If the mobile node decides to act as a regular\
    \ mobile node compliant\n   with [RFC3775], it sends a Binding Update without\
    \ any Binding\n   Identifier mobility options.  The receiver of the Binding Update\n\
    \   deletes all the bindings registered with a BID and registers only a\n   single\
    \ binding for the mobile node.  Note that the mobile node can\n   continue using\
    \ the BID even if it has only a single binding that is\n   active.\n   Binding\
    \ cache lookup is done based on the home address and BID\n   information if a\
    \ BID is available.  This is different from RFC 3775,\n   where only the home\
    \ address is used for binding cache lookup.\n   Binding cache lookup is operated\
    \ for either protocol signaling or\n   data packets.  For protocol signaling such\
    \ as a Binding Update, BID\n   should be always carried by a BID sub-option in\
    \ a protocol signaling.\n   Therefore, a correspondent binding cache that matches\
    \ the specified\n   BID MUST be found from the binding cache database.  On the\
    \ other\n   hand, for the data packets, no BID information is carried in a\n \
    \  packet.  The binding cache lookup may involve policy or flow filters\n   to\
    \ retrieve a correspondent BID per packet in cases where some policy\n   or flow\
    \ filters are used to direct a certain packet or flow to a\n   particular care-of\
    \ address.  However, the binding cache lookup using\n   policy or flow filters\
    \ is out of scope for this document.  If no such\n   mechanism is available and\
    \ no BID is found for a packet, a node\n   SHOULD use the binding that was last\
    \ verified by receiving data\n   packets or signaling from the mobile node.  In\
    \ case the binding cache\n   lookup for data packets, using the combination of\
    \ home address and\n   BID, does not return a valid binding cache entry, the home\
    \ agent\n   SHOULD perform the lookup based on only the home address as described\n\
    \   in [RFC3775].\n   In any case, to avoid problems with upper-layer protocols\
    \ and TCP in\n   particular, a single packet flow as identified by the 5-tuple\
    \ SHOULD\n   only be sent to a single care-of address at a time.\n   The mobile\
    \ node may return to the home link through one of its\n   interfaces.  There are\
    \ two options possible for the mobile node when\n   it returns home.  Sections\
    \ 5.5.1 and 5.6 describe the returning-home\n   procedures in more detail.\n \
    \  1.  The mobile node uses only the interface with which it attaches to\n   \
    \    the home link and takes back full ownership of its HoA (home\n       address)\
    \ on the home link.  This is illustrated in Figure 2.  It\n       de-registers\
    \ all bindings with the home agent related to all\n       care-of addresses. \
    \ The interfaces still attached to the visited\n       link(s) are no longer going\
    \ to be receiving any encapsulated\n       traffic from the home agent.  On the\
    \ other hand, the mobile node\n       can continue communicating with the correspondent\
    \ nodes from the\n       other interfaces attached to foreign links by using route\n\
    \       optimization.  Even if the mobile node is attached to the home\n     \
    \  link, it can still send Binding Updates for other active care-of\n       addresses\
    \ (CoA1 and CoA2) to correspondent nodes.  Since the\n       correspondent node\
    \ has bindings, packets are routed from and to\n       each care-of address directly.\n\
    \                       +----+\n                       | CN |\n              \
    \         +--+-+\n                          |\n                      +---+------+\
    \          +----+\n               +------+ Internet |----------+ HA |\n      \
    \         |      +----+-----+          +--+-+\n           CoA2|           |  \
    \                 |   Home Link\n            +--+--+        |             --+---+------\n\
    \            |  MN +--------+               |\n            +--+--+ CoA1      \
    \             |\n               |                           |\n              \
    \ +---------------------------+\n        Binding Cache Database:\n           home\
    \ agent's binding\n                 none\n           correspondent node's binding\n\
    \                 binding [2001:db8::EUI  BID1 care-of address1]\n           \
    \      binding [2001:db8::EUI  BID2 care-of address2]\n       Figure 2: Using\
    \ Only an Interface Attached to the Home Link\n   2.  The mobile node may simultaneously\
    \ use both the interface\n       attached to the home link and the interfaces\
    \ still attached to\n       the visited link(s) as shown in Figure 3.  There are\
    \ two possible\n       topologies, depending on whether or not the home agent\
    \ is the\n       only router on the home link.  The operation of Neighbor\n  \
    \     Discovery [RFC4861] is different in the two topologies.  More\n       details\
    \ can be found in Section 5.6.  The home agent and the\n       correspondent node\
    \ have the binding entries listed in Figure 3 in\n       their binding cache database\
    \ in both topologies.  The home agent\n       also knows that the mobile node\
    \ is attached to the home link.\n       All the traffic from the Internet is intercepted\
    \ by the home\n       agent first and routed to either the interface attached\
    \ to the\n       home link or to one of the foreign links.  How the home agent\n\
    \       decides to route a particular flow to the interface attached to\n    \
    \   the home link or foreign link is out of scope for this document.\n      Topology-a)\n\
    \                       +----+\n                       | CN |\n              \
    \         +--+-+\n                          |\n                      +---+------+\
    \          +----+\n               +------+ Internet |----------+ HA |\n      \
    \         |      +----+-----+          +--+-+\n           CoA2|           |  \
    \                 |   Home Link\n            +--+--+        |             --+---+------\n\
    \            |  MN +--------+               |\n            +--+--+ CoA1      \
    \             |\n               |                           |\n              \
    \ +---------------------------+\n      Topology-b)\n                       +----+\n\
    \                       | CN |\n                       +--+-+\n              \
    \            |\n                      +---+------+    Router    +----+\n     \
    \          +------+ Internet |-------R      | HA |\n               |      +----+-----+\
    \       |      +--+-+\n           CoA2|           |             |         |  \
    \ Home Link\n            +--+--+        |           --+-+-------+------\n    \
    \        |  MN +--------+               |\n            +--+--+ CoA1          \
    \         |\n               |                           |\n               +---------------------------+\n\
    \        Binding Cache Database:\n           home agent's binding\n          \
    \       binding [2001:db8::EUI  BID1 care-of address1]\n                 binding\
    \ [2001:db8::EUI  BID2 care-of address2]\n           correspondent node's binding\n\
    \                 binding [2001:db8::EUI  BID1 care-of address1]\n           \
    \      binding [2001:db8::EUI  BID2 care-of address2]\n          Figure 3: Simultaneous\
    \ Home and Visited Link Operation\n   This specification keeps backwards compatibility\
    \ with [RFC3775].  If\n   a receiver (either home agent or correspondent node)\
    \ does not support\n   this specification, it does not understand the Binding\
    \ Identifier\n   mobility option.  The receiver skips the unknown mobility option\n\
    \   (i.e., the Binding Identifier mobility option) and processes the\n   Binding\
    \ Update as defined in [RFC3775].  In order to keep backwards\n   compatibility\
    \ with [RFC3775], when a mobile node sends a Binding\n   Update message with extensions\
    \ described in this document, the\n   receiver needs to reflect the Binding Identifier\
    \ mobility option in\n   the Binding Acknowledgement.  If the mobile node finds\
    \ no Binding\n   Identifier mobility options in the received Binding Acknowledgement,\n\
    \   it assumes the other end node does not support this specification.\n   In\
    \ such case, the mobile node needs to fall back to the legacy\n   [RFC3775]-compliant\
    \ mobile node.  If it is the home registration, the\n   mobile node MAY try to\
    \ discover another home agent that supports the\n   Binding Identifier mobility\
    \ option for the home registration.\n"
- title: 4.  Mobile IPv6 Extensions
  contents:
  - "4.  Mobile IPv6 Extensions\n   This section summarizes the extensions to Mobile\
    \ IPv6 that are\n   necessary to manage multiple bindings.\n"
- title: 4.1.  Binding Cache Structure and Binding Update List
  contents:
  - "4.1.  Binding Cache Structure and Binding Update List\n   The BID is required\
    \ to be stored in the binding cache and Binding\n   Update List structure.\n \
    \  The sequence number value MUST be shared among all the Binding Update\n   List\
    \ entries related to Binding Updates sent to a particular home\n   agent or correspondent\
    \ node.  Whenever a mobile node sends either an\n   individual or a bulk Binding\
    \ Update, the sequence number is\n   incremented.  When a home agent receives\
    \ an individual Binding\n   Update, it should update the sequence number for all\
    \ the bindings for\n   a particular mobile node, with the sequence number in the\
    \ received\n   Binding Update.\n"
- title: 4.2.  Binding Update Message
  contents:
  - "4.2.  Binding Update Message\n   This specification extends the Binding Update\
    \ message with a new\n   flag.  The flag is shown and described below.\n     \
    \                                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n       \
    \                                |          Sequence #           |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       |A|H|L|K|M|R|P|F|T|O| Reserved  |           Lifetime            |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |                                                               |\n      \
    \ .                                                               .\n       .\
    \                        Mobility options                       .\n       .  \
    \                                                             .\n       |    \
    \                                                           |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                     Figure 4: Binding Update Message\n   Overwrite (O) flag\n\
    \      When this flag is set, all the binding cache entries for a mobile\n   \
    \   node are replaced by new entries registering with this Binding\n      Update\
    \ message.  This flag is only used when the BID mobility\n      option is carried\
    \ with the Binding Update.\n   Reserved\n      6-bit Reserved field.\n"
- title: 4.3.  Binding Identifier Mobility Option
  contents:
  - "4.3.  Binding Identifier Mobility Option\n   The Binding Identifier mobility\
    \ option is included in the Binding\n   Update, Binding Acknowledgement, Binding\
    \ Refresh Request, and Care-of\n   Test Init and Care-of Test messages.  The Binding\
    \ Identifier mobility\n   option has an alignment requirement of 2n if the Care-of\
    \ Address\n   field is not present.  Otherwise, it has the alignment requirement\
    \ of\n   8n + 2.\n                            1                   2          \
    \         3\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n                                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                       |   Type = 35   |     Length    |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |       Binding ID (BID)        |     Status    |H|   Reserved  |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-------------------------------+\n       +\
    \                                                               +\n       :  \
    \               IPv4 or IPv6 care-of address (CoA)            :\n       +    \
    \                                                           +\n       +---------------------------------------------------------------+\n\
    \                       Figure 5: BID Mobility Option\n   Type\n      Type value\
    \ for Binding Identifier is 35.\n   Length\n      8-bit unsigned integer.  Length\
    \ of the option, in octets,\n      excluding the Type and Length fields.  It MUST\
    \ be set to either 4,\n      8, or 20 depending on the Care-of Address field.\
    \  When the care-of\n      address is not carried by this option, the length value\
    \ MUST be\n      set to 4.  If the IPv4 care-of address is stored in the Care-of\n\
    \      Address field, the length MUST be 8.  Otherwise, the length value\n   \
    \   MUST be set to 20 for IPv6 care-of addresses.\n   Binding ID (BID)\n     \
    \ The BID that is assigned to the binding indicated by the care-of\n      address\
    \ in the Binding Update or the Binding Identifier mobility\n      option.  The\
    \ BID is a 16-bit unsigned integer.  The value of zero\n      is reserved and\
    \ SHOULD NOT be used.\n   Status\n      The Status field is an 8-bit unsigned\
    \ integer.  When the Binding\n      Identifier mobility option is included in\
    \ a Binding\n      Acknowledgement, this field overwrites the Status field in\
    \ the\n      Binding Acknowledgement only for this BID.  If this field is set\n\
    \      to zero, the receiver ignores this field and uses the registration\n  \
    \    status stored in the Binding Acknowledgement message.  The\n      receiver\
    \ MUST ignore this field if the Binding Identifier mobility\n      option is not\
    \ carried within either the Binding Acknowledgement or\n      the Care-of Test\
    \ messages.  The possible status codes are the same\n      as the status codes\
    \ of the Binding Acknowledgement.  This Status\n      field is also used to carry\
    \ error information related to the\n      care-of address test in the Care-of\
    \ Test message.\n   Simultaneous Home and Foreign Binding (H) flag\n      This\
    \ flag indicates that the mobile node registers multiple\n      bindings to the\
    \ home agent while it is attached to the home link.\n      This flag is valid\
    \ only for a Binding Update sent to the home\n      agent.\n   Reserved\n    \
    \  7-bit Reserved field.  The value MUST be initialized to zero by\n      the\
    \ sender, and SHOULD be ignored by the receiver.\n   Care-of Address\n      If\
    \ a Binding Identifier mobility option is included in a Binding\n      Update\
    \ for the home registration, either IPv4 or IPv6 care-of\n      addresses for\
    \ the corresponding BID can be stored in this field.\n      For the binding registration\
    \ to correspondent nodes (i.e., route\n      optimization), only IPv6 care-of\
    \ addresses can be stored in this\n      field.  If no address is specified in\
    \ this field, the length of\n      this field MUST be zero (i.e., not appear in\
    \ the option).  If the\n      option is included in any messages other than a\
    \ Binding Update,\n      the length of this field MUST also be zero.\n"
- title: 4.4.  New Status Values for Binding Acknowledgement
  contents:
  - "4.4.  New Status Values for Binding Acknowledgement\n   New status values for\
    \ the Status field in a Binding Acknowledgement\n   are defined for handling the\
    \ multiple care-of addresses registration:\n   MCOA NOTCOMPLETE (4)\n      In\
    \ bulk registration, not all the Binding Identifier mobility\n      options were\
    \ successfully registered.  Some of them were rejected.\n      The error status\
    \ value of the failed mobility option is\n      individually stored in the Status\
    \ field of the Binding Identifier\n      mobility option.\n   MCOA RETURNHOME\
    \ WO/NDP (5)\n      When a mobile node returns home, it MUST NOT use the Neighbor\n\
    \      Discovery Protocol (NDP) for the home address on the home link.\n     \
    \ This is explained in more detail in Section 5.6.\n   MCOA MALFORMED (164)\n\
    \      Registration failed because the Binding Identifier mobility option\n  \
    \    was not formatted correctly.  This value is used in the following\n     \
    \ cases:\n      *  when the wrong length value is specified (neither 4, 8, nor\
    \ 20)\n         in the Length field of the Binding Identifier mobility option.\n\
    \      *  when a unicast routable address is not specified in the Care-of\n  \
    \       Address field of the Binding Identifier mobility option.\n      *  when\
    \ a care-of address does not appear in the Care-of Address\n         field of\
    \ the Binding Identifier mobility option stored in an\n         IPsec Encapsulating\
    \ Security Payload (ESP)-protected Binding\n         Update.\n   MCOA NON-MCOA\
    \ BINDING EXISTS (165)\n      Indicates that a bootstrapping multiple care-of\
    \ addresses\n      registration was performed without the 'O' flag set.\n   MCOA\
    \ UNKOWN COA (167)\n      Indicates that a Binding Identifier mobility option\
    \ did not\n      include a Care-of Address field and that the receiver has no\n\
    \      record for the Binding ID indicated in the same option.\n   MCOA PROHIBITED\
    \ (166)\n      Implies that the multiple care-of addresses registration is\n \
    \     administratively prohibited.\n   MCOA BULK REGISTRATION PROHIBITED (168)\n\
    \      Bulk binding registration is either not permitted or not\n      supported.\
    \  Note that the bulk registration is an optional\n      procedure and might not\
    \ be available on a home agent.\n   MCOA SIMULTANEOUS HOME AND FOREIGN PROHIBITED\
    \ (169)\n      Simultaneous home and foreign attachment is neither supported nor\n\
    \      permitted.\n"
- title: 5.  Mobile Node Operation
  contents:
  - '5.  Mobile Node Operation

    '
- title: 5.1.  Management of Care-of Address(es) and Binding Identifier(s)
  contents:
  - "5.1.  Management of Care-of Address(es) and Binding Identifier(s)\n   There are\
    \ two cases when a mobile node might acquire several care-of\n   addresses.  A\
    \ mixture of the two cases is also possible.  Note that a\n   mobile node can\
    \ use BID regardless of the number of interfaces and\n   care-of addresses.  Whether\
    \ or not a mobile node uses BID is\n   determined by a local configuration.\n\
    \   1.  A mobile node is using several physical network interfaces and\n     \
    \  acquires a care-of address on each of its interfaces.\n   2.  A mobile node\
    \ uses a single physical network interface but\n       receives advertisements\
    \ for multiple prefixes on the link to\n       which the interface is attached.\
    \  This will result in the mobile\n       node configuring several global addresses\
    \ on the interface from\n       each of the announced prefixes.\n   The difference\
    \ between the above two cases is only in the number of\n   physical network interfaces\
    \ and is therefore irrelevant in this\n   document.  What is of significance is\
    \ the fact that the mobile node\n   has several addresses it can use as care-of\
    \ addresses.\n   A mobile node assigns a BID to each care-of address when it wants\
    \ to\n   register them simultaneously with its home address.  The BID MUST be\n\
    \   unique for a given home address.  The value is an integer between 1\n   and\
    \ 65535.  A zero value SHOULD NOT be used as a BID.  If a mobile\n   node has\
    \ only one care-of address, the assignment of a BID is not\n   needed until it\
    \ has multiple care-of addresses with which to\n   register, at which time all\
    \ of the care-of addresses MUST be mapped\n   to BIDs.\n   When a mobile node\
    \ registers a given BID for the first time, it MUST\n   include the Care-of Address\
    \ field in the Binding Identifier mobility\n   option.  For any subsequent registrations\
    \ that either re-register or\n   de-register the same BID, the MN need not include\
    \ the Care-of Address\n   field in the Binding Identifier mobility option.\n"
- title: 5.2.  Binding Registration
  contents:
  - "5.2.  Binding Registration\n   For the multiple care-of addresses registration,\
    \ the mobile node MUST\n   include a Binding Identifier mobility option(s) in\
    \ the Binding Update\n   as shown in Figure 6.\n   When IPsec ESP is used for\
    \ protecting the Binding Update, a care-of\n   address MUST be carried in an alternate\
    \ Care-of Address mobility\n   option as described in [RFC4877].  However, in\
    \ this specification,\n   the care-of address MUST be carried in the Care-of Address\
    \ field of\n   the Binding Identifier mobility option.  In order to save bits\
    \ of the\n   Binding Update, the alternate Care-of Address option MUST NOT be\n\
    \   included.\n   For binding registration to a correspondent node, the mobile\
    \ node\n   MUST have both active Home and Care-of Keygen tokens for Kbm (binding\n\
    \   management key; see Section 5.2.5 of [RFC3775]) before sending the\n   Binding\
    \ Update.  The care-of Keygen tokens MUST be maintained for\n   each care-of address\
    \ that the mobile node wants to register to the\n   correspondent node.  The Binding\
    \ Update to the correspondent node is\n   protected by the Binding Authorization\
    \ Data mobility option that is\n   placed after the Binding Identifier mobility\
    \ option.\n             IPv6 header (src=Care-of Address, dst=Home Agent Address)\n\
    \                  IPv6 Home Address Option\n                  ESP Header*\n \
    \                 Mobility header\n                      Binding Update\n    \
    \                 Mobility Options\n                        Binding Identifier\
    \ mobility option\n                        Binding Authorization mobility option+\n\
    \      (*) if necessary, for home registration\n      (+) if necessary, for route\
    \ optimization\n           Figure 6: Binding Update for Binding Registration\n\
    \   If the mobile node wants to replace existing registered bindings on\n   the\
    \ home agent with the single binding in the sent Binding Update, it\n   sets the\
    \ 'O' flag.  If the 'O' flag is not set, then the binding will\n   be added to\
    \ existing bindings in the home agent.  The single binding\n   will be registered\
    \ with the assigned BID.  Section 6.2 describes this\n   registration procedure\
    \ in detail.\n"
- title: 5.3.  Bulk Registration
  contents:
  - "5.3.  Bulk Registration\n   Bulk registration is an optimization for binding\
    \ multiple care-of\n   addresses to a home address using a single Binding Update.\
    \  This is\n   very useful if the mobile node, for instance, does not want to\
    \ send a\n   lot of signaling messages through an interface where the bandwidth\
    \ is\n   scarce.  This document specifies bulk registration only for the\n   mobile\
    \ node's home registration.  A mobile node performing bulk\n   registration with\
    \ a correspondent node is out of scope.\n   To use bulk registration, the mobile\
    \ node includes a Binding\n   Identifier mobility option for each BID it wants\
    \ to register in the\n   same Binding Update message.  As with single registrations\
    \ (see\n   Section 5.1), the Care-of Address field is included for each BID\n\
    \   registered for the first time.  This is shown in Figure 7.  The rest\n   of\
    \ the fields and options in the Binding Update (such as Lifetime,\n   Sequence\
    \ Number, and the flags in the Binding Update) are common\n   across all care-of\
    \ addresses.\n           IPv6 header (src=Care-of Address, dst=Home Agent Address)\n\
    \                IPv6 Home Address Option\n                ESP Header\n      \
    \          Mobility header\n                    Binding Update\n             \
    \      Mobility Options\n                      Binding Identifier1 (including\
    \ Care-of Address)\n                      Binding Identifier2 (including Care-of\
    \ Address)\n                      Binding Identifier3 (no Care-of Address)\n \
    \                     Binding IdentifierN (no Care-of Address)\n             \
    \                 :\n           Figure 7: Binding Update for Bulk Registration\n\
    \   As with regular registrations, if the mobile node wants to replace\n   existing\
    \ registered bindings on the home agent with the multiple\n   bindings in the\
    \ sent Binding Update, it sets the 'O' flag in the\n   Binding Update; otherwise,\
    \ the bindings are added to the existing\n   bindings in the home agent.\n"
- title: 5.4.  Binding De-Registration
  contents:
  - "5.4.  Binding De-Registration\n   When a mobile node decides to delete all the\
    \ bindings for its home\n   address, it sends a regular de-registration Binding\
    \ Update with\n   lifetime set to zero as defined in [RFC3775].  The Binding Identifier\n\
    \   mobility option is not required.\n   If a mobile node wants to delete a particular\
    \ binding(s) from its\n   home agent and correspondent nodes, the mobile node\
    \ sends a Binding\n   Update with lifetime set to zero and includes a Binding\
    \ Identifier\n   mobility option(s) with the BID(s) it wants to de-register. \
    \ The\n   receiver will remove only the care-of address(es) that match(es) the\n\
    \   specified BID(s).  Since de-registration attempts to remove a BID\n   that\
    \ already exists, the Care-of Address field in each Binding\n   Identifier option\
    \ can be omitted by the sender as defined in Section\n   5.1.\n"
- title: '5.5.  Returning Home with Complete Binding De-Registration: Using a'
  contents:
  - "5.5.  Returning Home with Complete Binding De-Registration: Using a\n      Single\
    \ Interface\n   The mobile node may return to the home link by attaching to the\
    \ home\n   link through one of its interfaces.  When the mobile node wants to\n\
    \   return home, it should be configured with information on what\n   interface\
    \ it needs to use.\n"
- title: 5.5.1.  Using Only the Interface Attached to the Home Link
  contents:
  - "5.5.1.  Using Only the Interface Attached to the Home Link\n   The mobile node\
    \ returns home and de-registers all the bindings it has\n   with the home agent,\
    \ as shown in Figure 2 and as defined in\n   [RFC3775].  After the de-registration\
    \ step, all the packets routed by\n   the home agent are only forwarded to the\
    \ interface attached to the\n   home link, even if there are other active interfaces\
    \ attached to the\n   visited link(s).  While the mobile node de-registers all\
    \ the bindings\n   from the home agent, it may continue registering, to the\n\
    \   correspondent node, bindings for interfaces attached to visited links\n  \
    \ as shown in Figure 2.\n"
- title: 5.5.2.  Using Only the Interface Attached to the Visited Link
  contents:
  - "5.5.2.  Using Only the Interface Attached to the Visited Link\n   The mobile\
    \ node returns home physically but shuts down the interface\n   attached to the\
    \ home link.  As a result, a mobile node does not\n   return home even though\
    \ it attaches to the home link by one of the\n   interfaces.  Before shutting\
    \ down the interface, any binding for the\n   care-of address previously associated\
    \ with the interface should be\n   deleted as defined in Section 5.4.\n   In this\
    \ scenario, despite the fact that the mobile node is connected\n   to its home\
    \ link, all of its traffic is sent and received via the\n   home agent and its\
    \ foreign links.\n"
- title: '5.6.  Returning Home: Simultaneous Home and Visited Link Operation'
  contents:
  - '5.6.  Returning Home: Simultaneous Home and Visited Link Operation

    '
- title: 5.6.1.  Problems of Simultaneous Home and Foreign Attachments
  contents:
  - "5.6.1.  Problems of Simultaneous Home and Foreign Attachments\n   The mobile\
    \ node returns home and continues using all the interfaces\n   attached to both\
    \ foreign and home links as shown in Figure 3.\n   In [RFC3775], the home agent\
    \ intercepts packets meant for the mobile\n   node using proxy Neighbor Discovery\
    \ [RFC4861] while the mobile node\n   is away from the home link.  When the mobile\
    \ node returns home, the\n   home agent deletes the binding cache and stops proxying\
    \ for the home\n   address so that a mobile node can configure its home address\
    \ on the\n   interface attached to the home link.  In this specification, a mobile\n\
    \   node may return home and configure the home address on the interface\n   attached\
    \ to the home link, but still use the interfaces attached to\n   the foreign links.\
    \  In this case, a possible conflict arises when\n   both the home agent and the\
    \ mobile node try to defend the home\n   address.  If the home agent stops proxying\
    \ for the home address, the\n   packets are always routed to the interface attached\
    \ to the home link\n   and are never routed to the interfaces attached to the\
    \ visited links.\n   Deployments making use of multiple care-of addresses are\
    \ required to\n   avoid configuration conflict between the home agent and the\
    \ mobile\n   node, while still allowing the simultaneous use of home and foreign\n\
    \   links.  The following describes the mechanism for achieving this.\n"
- title: 5.6.2.  Overview and Approach
  contents:
  - "5.6.2.  Overview and Approach\n   The home agent MUST intercept all the packets\
    \ meant for the mobile\n   node, whether or not the mobile node is attached to\
    \ the home link,\n   and decide whether to send the traffic directly to the home\
    \ address\n   on the link or tunnel to the care-of address.\n   Two scenarios\
    \ are illustrated in Figure 3, depending on whether or\n   not the home agent\
    \ is the only router at the home link.  The\n   difference is on who defends the\
    \ home address by (Proxy) Neighbor\n   Discovery on the home link.\n   1.  Mobile\
    \ node defends the home address by the regular Neighbor\n       Discovery protocol\
    \ (illustrated as topology-a in Figure 3).  The\n       home agent is the only\
    \ router on the home link.  Therefore, the\n       home agent is capable of intercepting\
    \ packets without relying on\n       the proxy Neighbor Discovery protocol, and\
    \ the mobile node can\n       manage the neighbor cache entry of the home address\
    \ on the home\n       link as a regular IPv6 node.  However, there is one limitation\
    \ of\n       this scenario.  If a correspondent node is located at the home\n\
    \       link, the home agent may not intercept the packets destined to\n     \
    \  the mobile node.  These packets are routed only via the home\n       link,\
    \ but this is the most optimal path for the mobile node to\n       communicate\
    \ with nodes on the home link.\n   2.  If there are routers other than the home\
    \ agent on the home link,\n       then it cannot be guaranteed that all packets\
    \ meant for the\n       mobile node are routed to the home agent.  In this case,\
    \ the\n       mobile node MUST NOT operate the Neighbor Discovery protocol for\n\
    \       the home address on the home link.  This allows the home agent to\n  \
    \     keep using proxy Neighbor Discovery, and thus it keeps receiving\n     \
    \  all the packets sent to the mobile node's home address.  If the\n       home\
    \ agent, according to its local policy, needs to deliver\n       packets to the\
    \ mobile node over the home link, an issue arises\n       with respect to how\
    \ the home agent discovers the mobile node's\n       link local address.  This\
    \ specification uses the Mobility Header\n       Link-Layer Address option defined\
    \ in [RFC5568] in order to carry\n       the mobile node's link-layer address\
    \ in the Binding Update.\n       Likewise, the mobile node would also know the\
    \ link-layer address\n       of the default router address to send packets from\
    \ the home link\n       without Neighbor Discovery.  The link-layer address is\
    \ used to\n       transmit packets from and to the mobile node on the home link.\n\
    \       The packets are transmitted without the Neighbor Discovery\n       protocol\
    \ by constructing the link-layer header manually.  This\n       operation is similar\
    \ to Mobile IPv6 [RFC3775] when a mobile node\n       sends a de-registration\
    \ Binding Update to the home agent's link-\n       layer address in the operation\
    \ for returning home.\n"
- title: 5.6.3.  Home Binding Support
  contents:
  - "5.6.3.  Home Binding Support\n   When the home binding is used, the mobile node\
    \ MUST send a\n   registering Binding Update with a Binding Identifier mobility\
    \ option\n   with the 'H' flag set.  The lifetime MUST be set to a non-zero\n\
    \   lifetime of the home binding, and the Care-of Address field MUST be\n   set\
    \ to the home address.  The mobile node registers only one home\n   binding at\
    \ a time, even if it attaches to the home link by multiple\n   interfaces.\n \
    \  The mobile node SHOULD include the Mobility Header Link-Layer Address\n   option\
    \ [RFC5568] to notify the mobile node's link-layer address to\n   the home agent,\
    \ too.  The option code of the Mobility Header Link-\n   Layer Address option\
    \ MUST be set to '2' (link-layer address of the\n   mobile node).  This link-layer\
    \ address is required for the home agent\n   to send the Binding Acknowledgement\
    \ and to forward the mobile node's\n   packet.\n   According to [RFC3775], the\
    \ mobile node MUST start responding to\n   Neighbor Solicitation for its home\
    \ address right after it sends the\n   de-registration Binding Update to the home\
    \ agent.  However, in this\n   specification, the mobile node MUST NOT respond\
    \ to Neighbor\n   Solicitation before receiving a Binding Acknowledgement, since\
    \ the\n   home agent may continue proxying for the home address.  If the mobile\n\
    \   node receives [MCOA RETURNHOME WO/NDP (5)] status value in the\n   received\
    \ Binding Acknowledgment, it MUST NOT respond to Neighbor\n   Solicitation even\
    \ after the Binding Acknowledgement.\n   The management of the home binding is\
    \ the same as the binding\n   management described in this specification.  The\
    \ home binding can be\n   included in a bulk binding registration (Section 5.3).\
    \  The MN SHOULD\n   refresh the lifetime of the home binding by sending appropriate\n\
    \   Binding Updates as with any other binding.\n"
- title: 5.6.4.  Sending Packets from the Home Link
  contents:
  - "5.6.4.  Sending Packets from the Home Link\n   o  When the mobile node receives\
    \ the Binding Acknowledgement with the\n      status value 'Binding Update Accepted'\
    \ and the BID option, it can\n      configure its home address to the interface\
    \ attached to the home\n      link and start operating Neighbor Discovery for\
    \ the home address\n      on the home link.  Packets can be transmitted from and\
    \ to the\n      mobile node as if the mobile node were a regular IPv6 node.\n\
    \   o  If the mobile node receives the status [MCOA RETURNHOME WO/NDP] in\n  \
    \    the Binding Acknowledgement, it MUST NOT operate Neighbor\n      Discovery\
    \ for the home address.  When the mobile node sends\n      packets from the interface\
    \ attached to the home link, it MUST\n      learn the link-layer address of the\
    \ next hop (i.e., default router\n      of the mobile node).  A mobile node learns\
    \ the default router's\n      link-layer address from a Source Link-Layer Address\
    \ option in\n      Router Advertisements.  The mobile node sends packets directly\
    \ to\n      the default router's link-layer address.  This is done by\n      constructing\
    \ the packet to include a link-layer header with the\n      learned link-layer\
    \ address of the default router.  The home agent\n      also forwards the packet\
    \ to the mobile node on the home link by\n      using the mobile node's link-layer\
    \ address.  The link-layer\n      address SHOULD be cached when the home agent\
    \ receives the\n      de-registration Binding Update message.  Note that the default\n\
    \      router MUST NOT cache the mobile node's link-layer address in the\n   \
    \   neighbor cache when it forwards the packet from the mobile node to\n     \
    \ the home agent.\n"
- title: 5.6.5.  Leaving from the Home Link
  contents:
  - "5.6.5.  Leaving from the Home Link\n   When the mobile node detaches from the\
    \ home link, it SHOULD\n   immediately send a Binding Update for one of the active\
    \ care-of\n   addresses with the 'H' flag unset.  When the 'H' flag of the BID\n\
    \   option is unset in any Binding Update, the home agent stops\n   forwarding\
    \ the mobile node's packets to the home link.\n"
- title: 5.7.  Receiving Binding Acknowledgement
  contents:
  - "5.7.  Receiving Binding Acknowledgement\n   The verification of a Binding Acknowledgement\
    \ is the same as Mobile\n   IPv6 (Section 11.7.3 of [RFC3775]).  The operation\
    \ for sending a\n   Binding Acknowledgement is described in Section 6.2.\n   If\
    \ a mobile node includes a Binding Identifier mobility option in a\n   Binding\
    \ Update with the 'A' flag set, a Binding Acknowledgement\n   SHOULD carry a Binding\
    \ Identifier mobility option.  According to\n   [RFC3775], the receiver of the\
    \ Binding Update ignores unknown\n   mobility options and processes the Binding\
    \ Update without the unknown\n   mobility option.  Therefore, if no such mobility\
    \ option is included\n   in the Binding Acknowledgement in response to a Binding\
    \ Update for a\n   multiple care-of addresses registration, this indicates that\
    \ the\n   originating node of the Binding Acknowledgement does not support\n \
    \  processing the Binding Identifier mobility option regardless of\n   status\
    \ value.  In such case, the receiver of the Binding Update may\n   create a regular\
    \ binding.  The mobile node then SHOULD no longer\n   attempt a multiple care-of\
    \ addresses registration with that node.  If\n   this occurs with home registration,\
    \ the mobile node MAY attempt to\n   discover another home agent that supports\
    \ the Binding Identifier\n   mobility option for the home registration.\n   If\
    \ a Binding Identifier mobility option is present in the received\n   Binding\
    \ Acknowledgement, the mobile node checks the Status field in\n   the option.\
    \  If the status value in the Binding Identifier mobility\n   option is zero,\
    \ the mobile node uses the value in the Status field of\n   the Binding Acknowledgement.\
    \  Otherwise, it uses the value in the\n   Status field of the Binding Identifier\
    \ mobility option.\n   If the status code is greater than or equal to 128, the\
    \ mobile node\n   starts relevant operations according to the error code.  Otherwise,\n\
    \   the mobile node assumes that the originator (home agent or\n   correspondent\
    \ node) successfully registered the binding information\n   and BID for the mobile\
    \ node.\n   o  If the status value is [MCOA PROHIBITED], the mobile node MUST\n\
    \      stop registering multiple bindings with the node that sent the\n      Binding\
    \ Acknowledgement.\n   o  If the status value is [MCOA BULK REGISTRATION PROHIBITED],\
    \ the\n      mobile node needs to stop using bulk registrations with the node\n\
    \      that sent the Binding Acknowledgement.  It should assume that none\n  \
    \    of the attempted registrations were successful.\n   o  If [MCOA MALFORMED]\
    \ is specified, it indicates that the Binding\n      Identifier mobility option\
    \ is formatted wrong, presumably due to a\n      programming error or major packet\
    \ corruption.\n   o  If [MCOA NON-MCOA BINDING EXISTS] is specified, it means\
    \ that\n      there is a non-MCoA binding entry in the receiver.  The mobile\n\
    \      node MUST set 'O' flag so that all the registered bindings are\n      replaced\
    \ by an MCoA registration as described in Section 5.9.\n   o  If [MCOA UNKNOWN\
    \ COA] is specified, it means that the mobile node\n      sent a Binding Identifier\
    \ mobility option without a Care-of\n      Address field, but the receiver could\
    \ not find an entry for the\n      BID indicated.  If the mobile node is trying\
    \ to de-register a BID,\n      it need not do anything further.  If the mobile\
    \ node is trying to\n      refresh a binding, it SHOULD send a Binding Identifier\
    \ mobility\n      option including the Care-of Address field.\n"
- title: 5.8.  Receiving Binding Refresh Request
  contents:
  - "5.8.  Receiving Binding Refresh Request\n   The verification of a Binding Refresh\
    \ Request is the same as in\n   Mobile IPv6 (Section 11.7.4 of [RFC3775]).  The\
    \ operation of sending\n   a Binding Refresh Request is described in Section 6.4.\n\
    \   If a mobile node receives a Binding Refresh Request with a Binding\n   Identifier\
    \ mobility option, it indicates that the node sending the\n   Binding Refresh\
    \ Request message is requesting that the mobile node\n   send a new Binding Update\
    \ for the BID.  The mobile node SHOULD then\n   send a Binding Update at least\
    \ for the respective binding, as\n   described in Sections 5.2 and 5.3.\n"
- title: 5.9.  Bootstrapping
  contents:
  - "5.9.  Bootstrapping\n   When a mobile node bootstraps and registers multiple\
    \ bindings for the\n   first time, it MUST set the 'O' flag in the Binding Update\
    \ message.\n   If old bindings still exist at the home agent, the mobile node\
    \ has no\n   knowledge of which bindings still exist at the home agent.  This\n\
    \   scenario happens when a mobile node reboots and loses state regarding\n  \
    \ the registrations.  If the 'O' flag is set, all the bindings are\n   replaced\
    \ by the new binding(s).\n"
- title: 6.  Home Agent and Correspondent Node Operation
  contents:
  - '6.  Home Agent and Correspondent Node Operation

    '
- title: 6.1.  Searching Binding Cache with Binding Identifier
  contents:
  - "6.1.  Searching Binding Cache with Binding Identifier\n   If either a correspondent\
    \ node or a home agent has multiple bindings\n   for a mobile node in their binding\
    \ cache database, it can use any of\n   the bindings to communicate with the mobile\
    \ node.  This section\n   explains how to retrieve the desired binding for the\
    \ binding\n   management.  This document does not provide any mechanism to select\n\
    \   the suitable binding for forwarding data packets.\n   A node that is either\
    \ a correspondent node or a home agent SHOULD use\n   both the home address and\
    \ the BID as the search key of the binding\n   cache if it knows the corresponding\
    \ BID (for example, when processing\n   signaling messages).  In the example below,\
    \ if a node searches the\n   binding with the home address and BID2, it gets binding2\
    \ for this\n   mobile node.\n           binding1 [2001:db8::EUI,  care-of address1,\
    \  BID1]\n           binding2 [2001:db8::EUI,  care-of address2,  BID2]\n    \
    \       binding3 [2001:db8::EUI,  care-of address3,  BID3]\n                 Figure\
    \ 8: Searching the Binding Cache\n   The node learns the BID when it receives\
    \ a Binding Identifier\n   mobility option.  At that time, the node MUST look\
    \ up its binding\n   cache database with the home address and the BID retrieved\
    \ from the\n   Binding Update.  If the node does not know the BID, it searches\
    \ for a\n   binding with only the home address.  In such a case, the first\n \
    \  matched binding is found.  If the node does not desire to use\n   multiple\
    \ bindings for a mobile node, it can simply ignore the BID.\n"
- title: 6.2.  Processing Binding Update
  contents:
  - "6.2.  Processing Binding Update\n   If a Binding Update does not contain a Binding\
    \ Identifier mobility\n   option, its processing is the same as in [RFC3775].\
    \  If the receiver\n   already has multiple bindings for the home address, it\
    \ MUST replace\n   all the existing bindings with the received binding.  If the\n\
    \   [RFC3775] Binding Update is for de-registration, the receiver MUST\n   delete\
    \ all existing bindings from its binding cache.\n   If the Binding Update contains\
    \ Binding Identifier mobility option(s),\n   it is first validated according to\
    \ Section 9.5.1 of [RFC3775].  Then\n   the receiver processes the Binding Identifier\
    \ mobility option(s) as\n   described in the following steps.\n   o  The length\
    \ value is examined.  The length value MUST be either 4,\n      8, or 20 depending\
    \ on the Care-of Address field.  If the length is\n      incorrect, the receiver\
    \ MUST reject the Binding Update and return\n      the status value set to [MCOA\
    \ MALFORMED].\n   o  When the length value is either 8 or 20, the care-of address\
    \ MUST\n      be present in the Binding Identifier mobility option.  If the\n\
    \      unicast routable address [RFC3775] is not present in the Care-of\n    \
    \  Address field, the receiver MUST reject the Binding Identifier\n      mobility\
    \ option and return the status value set to [MCOA\n      MALFORMED].\n   o  When\
    \ multiple Binding Identifier mobility options are present in\n      the Binding\
    \ Update, it is treated as bulk registration.  If the\n      receiving node is\
    \ a correspondent node, it MUST reject the Binding\n      Update and return the\
    \ status value set to [MCOA BULK REGISTRATION\n      PROHIBITED] in the binding\
    \ Acknowledgement.\n   o  If the Lifetime field in the Binding Update is set to\
    \ zero, the\n      receiving node deletes the binding entry that corresponds to\
    \ the\n      BID in the Binding Identifier mobility option.  If the receiving\n\
    \      node does not have an appropriate binding for the BID, it MUST\n      reject\
    \ the Binding Update and send a Binding Acknowledgement with\n      status set\
    \ to 133 [not home agent for this mobile node].\n   o  If the 'O' flag is set\
    \ in the de-registering Binding Update, it is\n      ignored.  If the 'H' flag\
    \ is set, the home agent stores a home\n      address in the Care-of Address field\
    \ of the binding cache entry.\n      The home agent MUST follow the descriptions\
    \ described in Section\n      5.6.\n   o  If the Lifetime field is not set to\
    \ zero, the receiving node\n      registers a binding with the specified BID as\
    \ a mobile node's\n      binding.  The care-of address is obtained from the Binding\
    \ Update\n      packet as follows:\n      *  If the length value of the Binding\
    \ Identifier mobility option\n         is 20, the care-of address is the IPv6\
    \ address copied from the\n         Care-of Address field in the Binding Identifier\
    \ mobility\n         option.\n      *  When the length value is 8, the address\
    \ MUST be the IPv4 valid\n         address.  How to obtain an IPv4 care-of address\
    \ is described in\n         Section 8.\n      *  When the length value is 4 and\
    \ the Binding Identifier is\n         present in the binding cache, the receiving\
    \ node MUST update\n         the associated binding entry.  Otherwise, the receiving\
    \ node\n         MUST reject that Binding Identifier mobility option and send\
    \ a\n         Binding Acknowledgement with the status for that Binding\n     \
    \    Identifier mobility option set to [MCOA UNKNOWN].\n   o  Once the care-of\
    \ address(es) have been retrieved from the Binding\n      Update, the receiving\
    \ nodes create new binding(s).\n      *  If the 'O' flag is set in the Binding\
    \ Update, the receiving\n         node removes all the existing bindings and registers\
    \ the\n         received binding(s).\n      *  If the 'O' flag is unset in the\
    \ Binding Update and the receiver\n         has a regular binding that does not\
    \ have a BID for the mobile\n         node, it must not process the Binding Update.\
    \  The receiver\n         should send a Binding Acknowledgement with status set\
    \ to [MCOA\n         NON-MCOA BINDING EXISTS].\n      *  If the receiver already\
    \ has a binding with the same BID but\n         different care-of address, it\
    \ MUST update the binding and\n         respond with a Binding Acknowledgement\
    \ with status set to 0\n         [Binding Update accepted].\n      *  If the receiver\
    \ does not have a binding entry for the BID, it\n         registers a new binding\
    \ for the BID and responds with a Binding\n         Acknowledgement with status\
    \ set to 0 [Binding Update accepted].\n   If all the above operations are successfully\
    \ completed and the 'A'\n   flag is set in the Binding Update, a Binding Acknowledgement\n\
    \   containing the Binding Identifier mobility options MUST be sent to\n   the\
    \ mobile node.  Whenever a Binding Acknowledgement is sent, all the\n   Binding\
    \ Identifier mobility options stored in the Binding Update MUST\n   be copied\
    \ to the Binding Acknowledgement except the Status field.\n   The Care-of Address\
    \ field in each Binding Identifier mobility option,\n   however, MAY be omitted,\
    \ because the mobile node can match a\n   corresponding Binding Update List entry\
    \ using the BID.\n   When a correspondent node sends a Binding Acknowledgement,\
    \ the status\n   value MUST always be stored in the Status field of the Binding\n\
    \   Acknowledgement and the Status field of the Binding Identifier\n   mobility\
    \ option MUST always be set to zero.\n   When the home agent sends a Binding Acknowledgement,\
    \ the status value\n   can be stored in the Status field of either a Binding Acknowledgement\n\
    \   or a Binding Identifier mobility option.  If the status value is\n   specific\
    \ to one of the bindings in the bulk registration, the status\n   value MUST be\
    \ stored in the Status field in the corresponding Binding\n   Identifier mobility\
    \ option.  In this case, the Status field of the\n   Binding Acknowledgement MUST\
    \ be set to [MCOA NOTCOMPLETE], so that\n   the receiver can examine the Status\
    \ field of each Binding Identifier\n   mobility option for further operations.\
    \  Otherwise, the Status field\n   of the Binding Identifier mobility option MUST\
    \ be set to zero and the\n   home agent Status field of the Binding Acknowledgement\
    \ is used.\n"
- title: 6.3.  Sending a Binding Acknowledgement for Home Link Registration
  contents:
  - "6.3.  Sending a Binding Acknowledgement for Home Link Registration\n   The operations\
    \ described in this section are related to returning\n   home with simultaneous\
    \ use of home and foreign links.\n   o  When the home agent sends the Binding\
    \ Acknowledgement after\n      successfully processing the home binding registration,\
    \ it MUST set\n      the status value to either 0 [Binding Update Accepted] or\
    \ [MCOA\n      RETURNHOME WO/NDP (5)] in the Status field of the Binding\n   \
    \   Acknowledgment, depending on home agent configuration at the home\n      link.\
    \  The new values are:\n      *  Binding Update Accepted (0): The Neighbor Discovery\
    \ protocol is\n         permitted for the home address at the home link.  This\
    \ is the\n         regular returning home operation of [RFC3775].\n      *  MCOA\
    \ RETURNHOME WO/NDP (5): The Neighbor Discovery protocol is\n         prohibited\
    \ for the home address at the home link.\n         The respective Binding Identifier\
    \ mobility options need to be\n         included in the Binding Acknowledgement.\n\
    \   o  If the Binding Update is rejected, the appropriate error value\n      MUST\
    \ be set in the Status field.  In this case, the home agent\n      operation is\
    \ the same as in [RFC3775].\n   o  Only if the home agent is the only router in\
    \ the home link MAY it\n      turn off Neighbor Discovery for the requested home\
    \ address and\n      respond with the [Binding Update Accepted] status value to\
    \ the\n      mobile node.  Since the mobile node will not reply to Neighbor\n\
    \      Solicitation for the home address before receiving the Binding\n      Acknowledgement,\
    \ the home agent SHOULD use the link-layer address\n      carried by the Mobility\
    \ Header Link-Layer Address option [RFC5568]\n      in the received Binding Update.\
    \  After the completion of the home\n      binding registration, the mobile node\
    \ starts regular Neighbor\n      Discovery operations for the home address on\
    \ the home link.  The\n      neighbor cache entry for the home address is created\
    \ by the\n      regular exchange of Neighbor Solicitation and Neighbor\n     \
    \ Advertisement.\n   o  If the home agent is not the only router in the home link,\
    \ the\n      home agent returns [MCOA RETURNHOME WO/NDP] value in the Status\n\
    \      field of the Binding Identifier mobility option.  The home agent\n    \
    \  learns the mobile node's link-layer address by receiving the\n      Mobility\
    \ Header Link-Layer Address option carried by the Binding\n      Update.  It stores\
    \ the link-layer address as a neighbor cache\n      entry for the mobile node\
    \ so that it can send the packets to the\n      mobile node's link-layer address.\n\
    \   o  Note that the use of proxy Neighbor Discovery is an easier way to\n   \
    \   intercept the mobile nodes' packets instead of IP routing in some\n      deployment\
    \ scenarios.  Therefore, even if a home agent is the only\n      router, it is\
    \ an implementation and operational choice whether the\n      home agent returns\
    \ [Binding Update Accepted] or [MCOA RETURNHOME\n      WO/NDP].\n   o  If the\
    \ BID option is not included in the Binding Acknowledgement,\n      the home agent\
    \ might not recognize the home registration.  The\n      home agent might have\
    \ processed the home registration Binding\n      Update as a regular de-registration,\
    \ as described in [RFC3775],\n      and deleted all the registered binding cache\
    \ entries for the\n      mobile node.  Thus, the mobile node SHOULD stop using\
    \ the\n      interface attached to the foreign link and use only the interface\n\
    \      attached to the home link.\n"
- title: 6.4.  Sending Binding Refresh Request
  contents:
  - "6.4.  Sending Binding Refresh Request\n   When a node (home agent or correspondent\
    \ node) sends a Binding\n   Refresh Request for a particular binding created with\
    \ the BID, the\n   node SHOULD include the Binding Identifier mobility option\
    \ in the\n   Binding Refresh Request.  The node MAY include multiple Binding\n\
    \   Identifier mobility options if there are multiple bindings that need\n   to\
    \ be refreshed.\n"
- title: 6.5.  Receiving Packets from Mobile Node
  contents:
  - "6.5.  Receiving Packets from Mobile Node\n   When a node receives packets with\
    \ a Home Address destination option\n   from a mobile node, it MUST check that\
    \ the care-of address that\n   appears in the Source Address field of the IPv6\
    \ header is equal to\n   one of the care-of addresses in the binding cache entry.\
    \  If no\n   binding is found, the packets MUST be discarded.  The node MUST also\n\
    \   send a Binding Error message as specified in [RFC3775].  This\n   verification\
    \ MUST NOT be done for a Binding Update.\n"
- title: 7.  Network Mobility Applicability
  contents:
  - "7.  Network Mobility Applicability\n   The binding management mechanisms are\
    \ the same for a mobile host that\n   uses Mobile IPv6 and for a mobile router\
    \ that is using the NEMO Basic\n   Support protocol [RFC3963].  Therefore, the\
    \ extensions described in\n   this document can also be used to support a mobile\
    \ router with\n   multiple care-of addresses.  [RFC4980] contains an analysis\
    \ of NEMO\n   multihoming.\n"
- title: 8.  DSMIPv6 Applicability
  contents:
  - "8.  DSMIPv6 Applicability\n   Dual Stack Mobile IPv6 (DSMIPv6) [RFC5555] extends\
    \ Mobile IPv6 to\n   register an IPv4 care-of address instead of the IPv6 care-of\
    \ address\n   when the mobile node is attached to an IPv4-only access network.\
    \  It\n   also allows the mobile node to acquire an IPv4 home address in\n   addition\
    \ to an IPv6 home address for use with IPv4-only correspondent\n   nodes.  This\
    \ section describes how the multiple care-of addresses\n   registration works\
    \ with IPv4 care-of and home addresses.\n"
- title: 8.1.  IPv4 Care-of Address Registration
  contents:
  - "8.1.  IPv4 Care-of Address Registration\n   The mobile node can use the extensions\
    \ described in the document to\n   register multiple care-of addresses, even if\
    \ some of the care-of\n   addresses are IPv4 addresses.\n   Bulk registration\
    \ MUST NOT be used for the initial binding\n   registration from an IPv4 care-of\
    \ address.  This is because the\n   Binding Update and Binding Acknowledgement\
    \ exchange is used to detect\n   NAT on the path between the mobile node and the\
    \ home agent.  So the\n   mobile node needs to check for a NAT between each IPv4\
    \ care-of\n   address and the home agent.\n   The Binding Update MUST be sent\
    \ to the IPv4 home agent address by\n   using UDP and IPv4 headers as shown in\
    \ Figure 9.  It is similar to\n   [RFC5555] except that the IPv4 care-of address\
    \ option MUST NOT be\n   used when the BID mobility option is used.\n        \
    \      IPv4 header (src=V4ADDR, dst=HA_V4ADDR)\n                UDP Header\n \
    \                 IPv6 header (src=V6HoA, dst=HAADDR)\n                      \
    \ ESP Header\n                       Mobility header\n                       \
    \    -Binding Update\n                          Mobility Options\n           \
    \                 - Binding Identifier (IPv4 CoA)\n          *V4ADDR, HA_V4ADDR,\
    \ V6HOA, HAADDR are defined in [RFC5555]\n         Figure 9: Initial Binding Update\
    \ for IPv4 Care-of Address\n   If a NAT is not detected, the mobile node can update\
    \ the IPv4 care-of\n   address by using bulk registration.  The mobile node can\
    \ register the\n   IPv4 care-of address along with other IPv4 and IPv6 care-of\n\
    \   addresses.  Figure 10 shows the Binding Update format when the mobile\n  \
    \ node sends a Binding Update from one of its IPv6 care-of addresses.\n   If the\
    \ mobile node sends a Binding Update from an IPv4 care-of\n   address, it MUST\
    \ follow the format described in Figure 9.  Note that\n   the IPv4 care-of address\
    \ must be registered by a non-bulk binding\n   registration whenever it is changed.\n\
    \   As shown in Figure 9, the IPv4 care-of address will appear in the\n   Binding\
    \ Identifier mobility option.  The IPv4 Care-of Address\n   mobility option defined\
    \ in [RFC5555] MUST always be omitted.  The\n   receiver of the Binding Update\
    \ message for an IPv4 care-of address\n   MUST treat the IPv4 address stored in\
    \ the Binding Identifier mobility\n   option as the one in the IPv4 Care-of Address\
    \ mobility option of\n   [RFC5555].  If the IPv4 address in the Binding Identifier\
    \ mobility\n   option is different from one in the Source Address field in the\
    \ IPv4\n   header of the Binding Update (i.e., V4ADDR in Figure 9), the source\n\
    \   address is used as an IPv4 care-of address.  Otherwise, the IPv4\n   address\
    \ in the Binding Identifier mobility option is used as an IPv4\n   care-of address.\n\
    \          IPv6 header (src=Care-of Address, dst=Home Agent Address)\n       \
    \        IPv6 Home Address Option\n               ESP Header\n               Mobility\
    \ header\n                   -Binding Update\n                  Mobility Options\n\
    \                     - Binding Identifier (IPv6/v4 CoA)\n                   \
    \  - Binding Identifier (IPv6/v4 CoA)\n                     - ...\n     Figure\
    \ 10: Binding Bulk Registration for an IPv4 Care-of Address\n   When the home\
    \ agent returns a Binding Acknowledgement for the IPv4\n   care-of address registration,\
    \ it SHOULD NOT use the IPv4 Address\n   Acknowledgement mobility option and SHOULD\
    \ use only the Binding\n   Identifier mobility option.  The registration status\
    \ for the IPv4\n   care-of address is stored in the Status field of the Binding\n\
    \   Identifier mobility option.  However, if the home agent needs to\n   store\
    \ the status value specially defined for the IPv4 Address\n   Acknowledgement\
    \ mobility option, it MUST store the status value in\n   the IPv4 Address Acknowledgement\
    \ mobility option and MUST NOT store\n   it in the Binding Identifier mobility\
    \ option.  In such case, the home\n   agent MUST include both the IPv4 Address\
    \ Acknowledgement mobility\n   option and the Binding Identifier mobility option.\n"
- title: 8.2.  IPv4 Home Address Management
  contents:
  - "8.2.  IPv4 Home Address Management\n   When the mobile node wants to configure\
    \ an IPv4 home address in\n   addition to the IPv6 home address, it can request\
    \ one using the IPv4\n   Home Address option in the Binding Update.  If the home\
    \ agent accepts\n   the Binding Update, the mobile node can now register multiple\
    \ care-of\n   addresses for the IPv4 home address in addition to the IPv6 home\n\
    \   address.  The mobile node MUST always use the IPv4 Home Address\n   mobility\
    \ option for any purposes of the IPv4 home address management.\n   The same set\
    \ of care-of addresses will be registered for both IPv6\n   and IPv4 home addresses.\
    \  The mobile node cannot bind a different set\n   of care-of addresses to each\
    \ home address.\n   According to [RFC5555], the home agent includes the IPv4 Address\n\
    \   Acknowledgement option in the Binding Acknowledgement only if the\n   mobile\
    \ node had requested an IPv4 home address in the corresponding\n   Binding Update.\
    \  The IPv4 Address Acknowledgement option MUST be\n   present before any Binding\
    \ Identifier mobility option.  The Status\n   field of the IPv4 Address Acknowledgement\
    \ option contains only the\n   error code defined in Section 3.2.1 of [RFC5555].\
    \  The home agent\n   MUST always include the IPv4 Address Acknowledgement mobility\
    \ option\n   in the Binding Acknowledgement for the IPv4 home address\n   registration.\n"
- title: 9.  IPsec and IKEv2 Interaction
  contents:
  - "9.  IPsec and IKEv2 Interaction\n   Mobile IPv6 [RFC3775] and the NEMO protocol\
    \ [RFC3963] require the use\n   of IPsec to protect signaling messages, including\
    \ Binding Updates,\n   Binding Acknowledgements, and return routability messages.\
    \  IPsec may\n   also be used to protect all tunneled data traffic.  The Mobile\
    \ IPv6-\n   IKEv2 specification [RFC4877] specifies how IKEv2 can be used to set\n\
    \   up the required IPsec security associations.  The following\n   assumptions\
    \ were made in [RFC3775], [RFC3963], and [RFC4877] with\n   respect to the use\
    \ of IKEv2 and IPsec.\n   o  There is only one primary care-of address per mobile\
    \ node.\n   o  The primary care-of address is stored in the IPsec database for\n\
    \      tunnel encapsulation and decapsulation.\n   o  When the home agent receives\
    \ a packet from the mobile node, the\n      source address is verified against\
    \ the care-of address in the\n      corresponding binding cache entry.  If the\
    \ packet is a reverse-\n      tunneled packet from the mobile node, the care-of\
    \ address check is\n      done against the source address on the outer IPv6 header.\
    \  The\n      reverse-tunneled packet could either be a tunneled Home Test Init\n\
    \      message or tunneled data traffic to the correspondent node.\n   o  The\
    \ mobile node runs IKEv2 (or IKEv1) with the home agent using\n      the care-of\
    \ address.  The IKE SA is based on the care-of address\n      of the mobile node.\n\
    \   The above assumptions may not be valid when multiple care-of\n   addresses\
    \ are used by the mobile node.  In the following sections,\n   the main issues\
    \ with the use of multiple care-of addresses with IPsec\n   are addressed.\n"
- title: 9.1.  Use of Care-of Address in the IKEv2 Exchange
  contents:
  - "9.1.  Use of Care-of Address in the IKEv2 Exchange\n   For each home address\
    \ for which the mobile node sets up security\n   associations with the home agent,\
    \ the mobile node must pick one\n   care-of address and use that as the source\
    \ address for all IKEv2\n   messages exchanged to create and maintain the IPsec\
    \ security\n   associations associated with the home address.  The resultant IKEv2\n\
    \   security association is created based on this care-of address.\n   If the\
    \ mobile node needs to change the care-of address, it just sends\n   a Binding\
    \ Update with the care-of address it wants to use, with the\n   corresponding\
    \ Binding Identifier mobility option, and with the 'K'\n   bit set.  This will\
    \ force the home agent to update the IKEv2 security\n   association to use the\
    \ new care-of address.  If the 'K' bit is not\n   supported on the mobile node\
    \ or the home agent, the mobile node MUST\n   re-establish the IKEv2 security\
    \ association with the new care-of\n   address.  This will also result in new\
    \ IPsec security associations\n   being set up for the home address.\n"
- title: 9.2.  Transport Mode IPsec-Protected Messages
  contents:
  - "9.2.  Transport Mode IPsec-Protected Messages\n   For Mobile IPv6 signaling message\
    \ protected using IPsec in transport\n   mode, the use of a particular care-of\
    \ address among multiple care-of\n   addresses does not matter for IPsec processing.\n\
    \   The home agent processes Mobile Prefix Discovery messages with the\n   same\
    \ rules of data packets described in Section 6.5.\n"
- title: 9.3.  Tunnel Mode IPsec-Protected Messages
  contents:
  - "9.3.  Tunnel Mode IPsec-Protected Messages\n   The use of IPsec in tunnel mode\
    \ with multiple care-of addresses\n   introduces a few issues that require changes\
    \ to how the mobile node\n   and the home agent send and receive tunneled traffic.\
    \  The route\n   optimization mechanism described in [RFC3775] mandates the use\
    \ of\n   IPsec protection in tunnel mode for the Home Test Init and Home Test\n\
    \   messages.  The mobile node and the home agent may also choose to\n   protect\
    \ all reverse-tunneled payload traffic with IPsec in tunnel\n   mode.  The following\
    \ sections address multiple care-of address\n   support for these two types of\
    \ messages.\n"
- title: 9.3.1.  Tunneled Home Test Init and Home Test Messages
  contents:
  - "9.3.1.  Tunneled Home Test Init and Home Test Messages\n   The mobile node MAY\
    \ use the same care-of address for all Home Test\n   Init messages sent reverse\
    \ tunneled through the home agent.  The\n   mobile node may use the same care-of\
    \ address irrespective of which\n   correspondent node the Home Test Init message\
    \ is being to.  RFC 3775\n   requires the home agent to verify that the mobile\
    \ node is using the\n   care-of address that is in the binding cache entry when\
    \ it receives a\n   reverse-tunneled Home Test Init message.  If a different address\
    \ is\n   used as the source address, the message is silently dropped by the\n\
    \   home agent.  This document requires the home agent implementation to\n   decapsulate\
    \ and forward the Home Test Init message as long as the\n   source address is\
    \ one of the care-of addresses in the binding cache\n   entry for the mobile node.\n\
    \   When the home agent tunnels a Home Test message to the mobile node,\n   the\
    \ care-of address used in the outer IPv6 header is not relevant to\n   the Home\
    \ Test message.  So regular IPsec tunnel encapsulation with\n   the care-of address\
    \ known to the IPsec implementation on the home\n   agent is sufficient.\n"
- title: 9.3.2.  Tunneled Payload Traffic
  contents:
  - "9.3.2.  Tunneled Payload Traffic\n   When the mobile node sends and receives\
    \ multiple traffic flows\n   protected by IPsec to different care-of addresses,\
    \ the use of the\n   correct care-of address for each flow becomes important.\
    \  Support for\n   this requires the following two considerations on the home\
    \ agent.\n   o  When the home agent receives a reverse-tunneled payload message\n\
    \      protected by IPsec in tunnel mode, the source address used in the\n   \
    \   outer IPv6 header is irrelevant to IPsec, since the tunnel mode\n      security\
    \ association is based on the addresses in the inner IPv6\n      header.  Therefore,\
    \ the same IPsec security association can be\n      used for payload traffic tunneled\
    \ from any of the care-of\n      addresses.  Note that the care-of address used\
    \ in the reverse-\n      tunneled traffic can be different from the care-of address\
    \ used as\n      the source address in the IKEv2 exchange.  However, this does\
    \ not\n      cause an issue due to the above-mentioned reason.\n   o  For tunneled\
    \ IPsec traffic from the home agent to the mobile node,\n      the IPsec implementation\
    \ on the home agent will not be aware of\n      which care-of address to use when\
    \ performing IPsec tunnel\n      encapsulation.  The Mobile IP stack on the home\
    \ agent, based on\n      the binding cache entries created by the mobile node,\
    \ knows to\n      which care-of address the packet belonging to a particular flow\n\
    \      needs to be tunneled.  The destination address for the outer IP\n     \
    \ header must either be conveyed dynamically per packet to the IPsec\n      stack\
    \ when it performs the encapsulation or the Mobile IPv6 stack\n      must get\
    \ access to the packet after IPsec processing is done and\n      modify the destination\
    \ address.  The first option requires changes\n      to the IPsec implementation.\
    \  In the second option, there is a\n      need for special processing in the\
    \ forwarding function to replace\n      the destination address on the outer header\
    \ with the correct\n      care-of address.  The exact technique to achieve the\
    \ above is\n      implementation specific.\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   The security considerations for securing the\
    \ Binding Update and\n   Binding Acknowledgement messages with multiple care-of\
    \ addresses are\n   very similar to the security considerations for securing the\
    \ Binding\n   Update and Binding Acknowledgement.  Please see [RFC3775] for more\n\
    \   information.  The Binding Update and Binding Acknowledgement messages\n  \
    \ with multiple care-of addresses are securely exchanged as described\n   in [RFC3775],\
    \ [RFC4877], and Section 9 of this document.  Additional\n   security considerations\
    \ are described below.\n   With simultaneous binding support, it is possible for\
    \ a malicious\n   mobile node to successfully bind a number of victims' addresses\
    \ as\n   valid care-of addresses for the mobile node with its home agent.\n  \
    \ Once these addresses have been bound, the malicious mobile node can\n   perform\
    \ a re-direction attack by instructing the home agent (e.g.,\n   setting filtering\
    \ rules to direct a large file transfer) to tunnel\n   packets to the victims'\
    \ addresses.  Such risk is highlighted in\n   [MIP6ANALYSIS].  These attacks are\
    \ possible because the care-of\n   addresses sent by the mobile node in the Binding\
    \ Update messages are\n   not verified by the home agent, i.e., the home agent\
    \ does not check\n   if the mobile node is at the care-of address at which it\
    \ claims to\n   be.  The security model for Mobile IPv6 assumes that there is\
    \ a trust\n   relationship between the mobile node and its home agent.  Any\n\
    \   malicious attack by the mobile node is traceable by the home agent.\n   This\
    \ acts as a deterrent for the mobile node to launch such attacks.\n   Although\
    \ such a risk exists in Mobile IPv6, the risk level is\n   increased when simultaneous\
    \ multiple care-of address bindings are\n   performed.  In Mobile IPv6, a mobile\
    \ node can only have a single\n   care-of address binding per home address at\
    \ a given time.  However,\n   for simultaneous multiple care-of address bindings,\
    \ a mobile node can\n   have more than one care-of address binding per home address\
    \ at a\n   given time.  This implies that a mobile node using simultaneous\n \
    \  binding support can effectively bind more than a single victim's\n   address.\
    \  Another difference is the degree of risk involved.  In the\n   single care-of\
    \ address binding case, once the re-direction attack is\n   initiated, a malicious\
    \ mobile node would be unable to use its home\n   address for communications (such\
    \ as to receive control packets\n   pertaining to the file transfer).  However,\
    \ in the simultaneous\n   binding support case, a malicious mobile node could\
    \ bind a valid\n   care-of address in addition to multiple victims addresses.\
    \  This\n   valid care-of address could then be used by the malicious mobile node\n\
    \   to set up flow filtering rules at its home agent, thereby controlling\n  \
    \ and/or launching new re-direction attacks.\n   Thus, in view of such risks,\
    \ it is advisable for a home agent to\n   employ some form of care-of address\
    \ verification mechanism before\n   using the care-of addresses as a valid routing\
    \ path to a mobile node.\n   These mechanisms are out of scope for this document.\n\
    \   In the binding registration of Mobile IPv6, a care-of address is\n   always\
    \ verified by its reachability by a home agent.  This\n   reachability test may\
    \ decrease the above risks.  However, when bulk\n   registration is used, a home\
    \ agent cannot verify reachability of\n   care-of addresses carried in a Binding\
    \ Identifier mobility option.\n   Therefore, the home agent can choose to reject\
    \ bulk registration by\n   using [MCOA BULK REGISTRATION PROHIBITED] in a Binding\n\
    \   Acknowledgement.  Alternatively, when a mobile node first registers a\n  \
    \ care-of address, it uses the individual Binding Updates for the first\n   appeared\
    \ care-of address.  During the initial binding registration, a\n   home agent\
    \ can verify the address reachability for that given care-of\n   address.  After\
    \ that, the mobile node uses bulk registration to\n   refresh the care-of address.\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   The following Extension Types have been assigned\
    \ by IANA:\n   o  Binding Identifier mobility option type: (35) has been assigned\n\
    \      from the same space as the mobility option in [RFC3775].\n   o  New Successful\
    \ Status of Binding Acknowledgement: These status\n      codes have been assigned\
    \ from the same space as the Binding\n      Acknowledgement status codes in [RFC3775].\n\
    \      *  MCOA NOTCOMPLETE (4)\n      *  MCOA RETURNHOME WO/NDP (5)\n   o  New\
    \ Unsuccessful Status of Binding Acknowledgement: These status\n      codes have\
    \ also been assigned from the same space as the Binding\n      Acknowledgement\
    \ status codes in [RFC3775].\n      *  MCOA MALFORMED (164)\n      *  MCOA NON-MCOA\
    \ BINDING EXISTS (165)\n      *  MCOA PROHIBITED (166)\n      *  MCOA UNKNOWN\
    \ COA (167)\n      *  MCOA BULK REGISTRATION PROHIBITED (168)\n      *  MCOA SIMULTANEOUS\
    \ HOME AND FOREIGN PROHIBITED (169)\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   Ryuji Wakikawa and Thierry Ernst are grateful to Keio\
    \ University for\n   its initial support on this specification at the time when\
    \ they were\n   working there.  In addition, the authors would like to thank Masafumi\n\
    \   Aramoto, Keigo Aso, Julien Charbon, Tero Kauppinen, Martti Kuparinen,\n  \
    \ Romain Kuntz, Benjamin Lim, Heikki Mahkonen, Nicolas Montavont, and\n   Chan-Wah\
    \ Ng for their discussions and inputs.  Thanks to Susumu\n   Koshiba, Hiroki Matutani,\
    \ Koshiro Mitsuya, Koji Okada, Keisuke\n   Uehara, Masafumi Watari, and Jun Murai\
    \ for earlier work on this\n   subject.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [RFC2119]      Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                  Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC4861]      Narten, T., Nordmark, E., Simpson, W., and H.\
    \ Soliman,\n                  \"Neighbor Discovery for IP version 6 (IPv6)\",\
    \ RFC\n                  4861, September 2007.\n   [RFC3775]      Johnson, D.,\
    \ Perkins, C., and J. Arkko, \"Mobility\n                  Support in IPv6\",\
    \ RFC 3775, June 2004.\n   [RFC4877]      Devarapalli, V. and F. Dupont, \"Mobile\
    \ IPv6 Operation\n                  with IKEv2 and the Revised IPsec Architecture\"\
    , RFC\n                  4877, April 2007.\n   [RFC3963]      Devarapalli, V.,\
    \ Wakikawa, R., Petrescu, A., and P.\n                  Thubert, \"Network Mobility\
    \ (NEMO) Basic Support\n                  Protocol\", RFC 3963, January 2005.\n\
    \   [RFC5555]      Soliman, H., Ed., \"Mobile IPv6 Support for Dual Stack\n  \
    \                Hosts and Routers\", RFC 5555, June 2009.\n   [RFC5568]     \
    \ Koodli, R., Ed., \"Mobile IPv6 Fast Handovers\", RFC\n                  5568,\
    \ July 2009.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [MOTIVATION]   Ernst, T., Montavont, N., Wakikawa,\
    \ R., Ng, C., and K.\n                  Kuladinithi, \"Motivations and Scenarios\
    \ for Using\n                  Multiple Interfaces and Global Addresses\", Work\
    \ in\n                  Progress, May 2008.\n   [RFC4980]      Ng, C., Ernst,\
    \ T., Paik, E., and M. Bagnulo, \"Analysis\n                  of Multihoming in\
    \ Network Mobility Support\", RFC 4980,\n                  October 2007.\n   [MIP6ANALYSIS]\
    \ Montavont, N., Wakikawa, R., Ernst, T., Ng, C., and K.\n                  Kuladinithi,\
    \ \"Analysis of Multihoming in Mobile IPv6\",\n                  Work in Progress,\
    \ May 2008.\n   [RFC3753]      Manner, J., Ed., and M. Kojo, Ed., \"Mobility Related\n\
    \                  Terminology\", RFC 3753, June 2004.\n   [RFC4885]      Ernst,\
    \ T. and H-Y. Lach, \"Network Mobility Support\n                  Terminology\"\
    , RFC 4885, July 2007.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ryuji Wakikawa (Editor)\n   TOYOTA InfoTechnology Center\
    \ Co., Ltd.\n   EMail: ryuji.wakikawa@gmail.com (ryuji@jp.toyota-itc.com)\n  \
    \ Vijay Devarapalli\n   Wichorus\n   EMail: vijay@wichorus.com\n   George Tsirtsis\n\
    \   Qualcomm\n   EMail: Tsirtsis@gmail.com\n   Thierry Ernst\n   INRIA\n   EMail:\
    \ thierry.ernst@inria.fr\n   Kenichi Nagami\n   INTEC NetCore Inc.\n   EMail:\
    \ nagami@inetcore.com\n"
