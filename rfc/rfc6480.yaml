- title: __initial_text__
  contents:
  - '          An Infrastructure to Support Secure Internet Routing

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes an architecture for an infrastructure to\n\
    \   support improved security of Internet routing.  The foundation of\n   this\
    \ architecture is a Resource Public Key Infrastructure (RPKI) that\n   represents\
    \ the allocation hierarchy of IP address space and\n   Autonomous System (AS)\
    \ numbers; and a distributed repository system\n   for storing and disseminating\
    \ the data objects that comprise the\n   RPKI, as well as other signed objects\
    \ necessary for improved routing\n   security.  As an initial application of this\
    \ architecture, the\n   document describes how a legitimate holder of IP address\
    \ space can\n   explicitly and verifiably authorize one or more ASes to originate\n\
    \   routes to that address space.  Such verifiable authorizations could\n   be\
    \ used, for example, to more securely construct BGP route filters.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6480.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Terminology ................................................4\n  \
    \ 2. Public Key Infrastructure for Internet Number Resources .........4\n    \
    \  2.1. Role in the Overall Architecture ...........................5\n      2.2.\
    \ CA Certificates ............................................6\n      2.3. End-Entity\
    \ (EE) Certificates ...............................7\n      2.4. Trust Anchors\
    \ ..............................................8\n   3. Route Origination Authorizations\
    \ ................................9\n      3.1. Role in the Overall Architecture\
    \ ...........................9\n      3.2. Syntax and Semantics ......................................10\n\
    \   4. Repositories ...................................................11\n  \
    \    4.1. Role in the Overall Architecture ..........................12\n    \
    \  4.2. Contents and Structure ....................................12\n      4.3.\
    \ Access Protocols ..........................................14\n      4.4. Access\
    \ Control ............................................15\n   5. Manifests ......................................................15\n\
    \      5.1. Syntax and Semantics ......................................15\n  \
    \ 6. Local Cache Maintenance ........................................16\n   7.\
    \ Common Operations ..............................................17\n      7.1.\
    \ Certificate Issuance ......................................17\n      7.2. CA\
    \ Key Rollover ...........................................18\n      7.3. ROA Management\
    \ ............................................19\n           7.3.1. Single-Homed\
    \ Subscribers ...........................20\n           7.3.2. Multi-Homed Subscribers\
    \ ............................20\n           7.3.3. Provider-Independent Address\
    \ Space .................21\n   8. Security Considerations ........................................21\n\
    \   9. IANA Considerations ............................................21\n  \
    \ 10. Acknowledgments ...............................................22\n   11.\
    \ References ....................................................22\n      11.1.\
    \ Normative References .....................................22\n      11.2. Informative\
    \ References ...................................23\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document describes an architecture for an infrastructure\
    \ to\n   support improved security for BGP routing [RFC4271] for the Internet.\n\
    \   The architecture encompasses three principle elements:\n      o  Resource\
    \ Public Key Infrastructure (RPKI)\n      o  digitally signed routing objects\
    \ to support routing security\n      o  a distributed repository system to hold\
    \ the PKI objects and the\n         signed routing objects\n   The architecture\
    \ described by this document enables an entity to\n   verifiably assert that it\
    \ is the legitimate holder of a set of IP\n   addresses or a set of Autonomous\
    \ System (AS) numbers.  As an initial\n   application of this architecture, the\
    \ document describes how a\n   legitimate holder of IP address space can explicitly\
    \ and verifiably\n   authorize one or more ASes to originate routes to that address\
    \ space.\n   Such verifiable authorizations could be used, for example, to more\n\
    \   securely construct BGP route filters.  In addition to this initial\n   application,\
    \ the infrastructure defined by this architecture also is\n   intended to provide\
    \ future support for security protocols such as\n   Secure BGP [S-BGP] or Secure\
    \ Origin BGP [soBGP].  This architecture\n   is applicable to the routing of both\
    \ IPv4 and IPv6 datagrams.  IPv4\n   and IPv6 are currently the only address families\
    \ supported by this\n   architecture.  Thus, for example, use of this architecture\
    \ with MPLS\n   labels is beyond the scope of this document.\n   In order to facilitate\
    \ deployment, the architecture takes advantage\n   of existing technologies and\
    \ practices.  The structure of the PKI\n   element of the architecture corresponds\
    \ to the existing resource\n   allocation structure.  Thus management of this\
    \ PKI is a natural\n   extension of the resource-management functions of the organizations\n\
    \   that are already responsible for IP address and AS number resource\n   allocation.\
    \  Likewise, existing resource allocation and revocation\n   practices have well-defined\
    \ correspondents in this architecture.\n   Note that while the initial focus of\
    \ this architecture is routing\n   security applications, the PKI described in\
    \ this document could be\n   used to support other applications that make use\
    \ of attestations of\n   IP address or AS number resource holdings.\n   To ease\
    \ implementation, existing IETF standards are used wherever\n   possible; for\
    \ example, extensive use is made of the X.509 certificate\n   profile defined\
    \ by the Public Key Infrastructure using X.509 (PKIX)\n   [RFC5280] working group\
    \ and the extensions for IP addresses and AS\n   numbers representation defined\
    \ in RFC 3779 [RFC3779].  Also,\n   Cryptographic Message Syntax (CMS) [RFC5652]\
    \ is used as the syntax\n   for the newly defined signed objects [RFC6488] required\
    \ by this\n   infrastructure.\n   As noted above, the architecture is comprised\
    \ of three main\n   components: an X.509 PKI in which certificates attest to holdings\
    \ of\n   IP address space and AS numbers; non-certificate signed objects\n   (including\
    \ route origination authorizations and manifests) used by\n   the infrastructure;\
    \ and a distributed repository system that makes\n   all of these signed objects\
    \ available for use by ISPs in making\n   routing decisions.  These three basic\
    \ components enable several\n   security functions; most notably the cryptographic\
    \ validation that an\n   autonomous system is authorized to originate routes to\
    \ a given prefix\n   [RFC6483].\n"
- title: 1.1.  Terminology
  contents:
  - "1.1.  Terminology\n   It is assumed that the reader is familiar with the terms\
    \ and concepts\n   described in \"Internet X.509 Public Key Infrastructure Certificate\n\
    \   and Certificate Revocation List (CRL) Profile\" [RFC5280] and \"X.509\n  \
    \ Extensions for IP Addresses and AS Identifiers\" [RFC3779].\n   Throughout this\
    \ document, we use the terms \"address space holder\" or\n   \"holder of IP address\
    \ space\" interchangeably to refer to a legitimate\n   holder of IP address space\
    \ who has received this address space\n   through the standard IP address allocation\
    \ hierarchy.  That is, the\n   address space holder has either directly received\
    \ the address space\n   as an allocation from a Regional Internet Registry (RIR)\
    \ or IANA; or\n   else the address space holder has received the address space\
    \ as a\n   sub-allocation from a National Internet Registry (NIR) or Local\n \
    \  Internet Registry (LIR).  We use the term \"resource holder\" to refer\n  \
    \ to a legitimate holder of either IP address or AS number resources.\n   Throughout\
    \ this document, we use the terms \"registry\" and \"ISP\" to\n   refer to an\
    \ entity that has an IP address space and/or AS number\n   allocation that it\
    \ is permitted to sub-allocate.\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted\
    \ as described in RFC\n   2119 [RFC2119].\n"
- title: 2.  Public Key Infrastructure for Internet Number Resources
  contents:
  - "2.  Public Key Infrastructure for Internet Number Resources\n   Because the holder\
    \ of a block of IP address space is entitled to\n   define the topological destination\
    \ of IP datagrams whose destinations\n   fall within that block, decisions about\
    \ inter-domain routing are\n   inherently based on knowledge of the allocation\
    \ of the IP address\n   space.  Thus, a basic function of this architecture is\
    \ to provide\n   cryptographically verifiable attestations as to these allocations.\n\
    \   In current practice, the allocation of IP addresses is hierarchical.\n   The\
    \ root of the hierarchy is IANA.  Below IANA are five Regional\n   Internet Registries\
    \ (RIRs), each of which manages address and AS\n   number allocation within a\
    \ defined geopolitical region.  In some\n   regions, the third tier of the hierarchy\
    \ includes National Internet\n   Registries (NIRs) as well as Local Internet Registries\
    \ (LIRs) and\n   subscribers with so-called provider-independent (\"portable\"\
    )\n   allocations.  (The term \"LIR\" is used in some regions to refer to\n  \
    \ what other regions define as an ISP.  Throughout the rest of this\n   document,\
    \ we will use the term \"LIR/ISP\" to simplify references to\n   these entities.)\
    \  In other regions, the third tier consists only of\n   LIRs/ISPs and subscribers\
    \ with provider-independent allocations.\n   In general, the holder of a block\
    \ of IP address space may sub-\n   allocate portions of that block, either to\
    \ itself (e.g., to a\n   particular unit of the same organization), or to another\n\
    \   organization, subject to contractual constraints established by the\n   registries.\
    \  Because of this structure, IP address allocations can be\n   described naturally\
    \ by a hierarchic public key infrastructure, in\n   which each certificate attests\
    \ to an allocation of IP addresses, and\n   issuance of subordinate certificates\
    \ corresponds to sub-allocation of\n   IP addresses.  The above reasoning holds\
    \ true for AS number resources\n   as well, with the difference that, by convention,\
    \ AS numbers may not\n   be sub-allocated except by RIRs or NIRs.  Thus, allocations\
    \ of both\n   IP addresses and AS numbers can be expressed by the same PKI.  Such\
    \ a\n   PKI, which is henceforth referred to as the \"Resource Public Key\n  \
    \ Infrastructure (RPKI)\", is a central component of this architecture.\n"
- title: 2.1.  Role in the Overall Architecture
  contents:
  - "2.1.  Role in the Overall Architecture\n   Certificates in this PKI are called\
    \ resource certificates, and\n   conform to the certificate profile for such certificates\
    \ [RFC6487].\n   Resource certificates attest to the allocation by the (certificate)\n\
    \   issuer of IP addresses or AS numbers to the subject.  They do this by\n  \
    \ binding the public key contained in the resource certificate to the\n   IP addresses\
    \ or AS numbers included in the certificate's IP Address\n   Delegation or AS\
    \ Identifier Delegation extensions, respectively, as\n   defined in RFC 3779 [RFC3779].\n\
    \   An important property of this PKI is that certificates do not attest\n   to\
    \ the identity of the subject.  Therefore, the subject names used in\n   certificates\
    \ are not intended to be \"descriptive\".  That is, the\n   resource PKI is intended\
    \ to provide authorization, but not\n   authentication.  This is in contrast to\
    \ most PKIs where the issuer\n   ensures that the descriptive subject name in\
    \ a certificate is\n   properly associated with the entity that holds the private\
    \ key\n   corresponding to the public key in the certificate.  Because issuers\n\
    \   need not verify the right of an entity to use a subject name in a\n   certificate,\
    \ they avoid the costs and liabilities of such\n   verification.  This makes it\
    \ easier for these entities to take on the\n   additional role of Certification\
    \ Authority (CA).\n   Most of the certificates in the PKI assert the basic facts\
    \ on which\n   the rest of the infrastructure operates.  CA certificates within\
    \ the\n   PKI attest to IP address space and AS number holdings.  End-entity\n\
    \   (EE) certificates are issued by resource holder CAs to delegate the\n   authority\
    \ attested by their allocation certificates.  The primary use\n   for EE certificates\
    \ is the validation of Route Origination\n   Authorizations (ROAs), signed objects\
    \ which provide an explicit\n   authorization by an address holder that a given\
    \ AS is permitted to\n   originate routes to a set of addresses (see Section 3).\
    \  End-entity\n   certificates are also used to verify other signed objects, such\
    \ as\n   manifests, which will be used to help ensure the integrity of the\n \
    \  repository system (see Section 5).\n"
- title: 2.2.  CA Certificates
  contents:
  - "2.2.  CA Certificates\n   Any resource holder who is authorized to sub-allocate\
    \ these resources\n   must be able to issue resource certificates to correspond\
    \ to these\n   sub-allocations.  Thus, for example, CA certificates will be\n\
    \   associated with IANA and each of the RIRs, NIRs, and LIRs/ISPs.\n   Also,\
    \ a CA certificate is required to enable a resource holder to\n   issue ROAs,\
    \ because it must issue the corresponding end-entity\n   certificate used to validate\
    \ each ROA.  Thus, some entities that do\n   not sub-allocate their resources\
    \ also will need to have CA\n   certificates for their allocations, e.g., a multi-homed\
    \ subscriber\n   with a provider-independent allocation, to enable them to issue\
    \ ROAs.\n   (A subscriber who is not multi-homed, whose allocation comes from\
    \ an\n   LIR/ISP, and who has not moved to a different LIR/ISP, need not be\n\
    \   represented in the PKI.  Moreover, a multi-homed subscriber with an\n   allocation\
    \ from an LIR/ISP may or may not need to be explicitly\n   represented, as discussed\
    \ in Section 7.3.2).\n   Unlike in most PKIs, the distinguished name of the subject\
    \ in a CA\n   certificate is chosen by the certificate issuer.  The subject's\n\
    \   distinguished name must not attempt to convey the identity of the\n   subject\
    \ in a descriptive fashion.  The subject's distinguished name\n   must include\
    \ the CommonName attribute and may additionally include\n   the serial attribute.\n\
    \   In this PKI, the certificate issuer, being an RIR, NIR, or LIR/ISP,\n   is\
    \ not in the business of verifying the legal right of the subject to\n   assert\
    \ a particular identity.  Therefore, selecting a distinguished\n   name that does\
    \ not convey the identity of the subject in a\n   descriptive fashion minimizes\
    \ the opportunity for the subject to\n   misuse the certificate to assert an identity,\
    \ and thus minimizes the\n   legal liability of the issuer.  Since all CA certificates\
    \ are issued\n   to subjects with whom the issuer has an existing relationship,\
    \ it is\n   recommended that the issuer select a subject name that enables the\n\
    \   issuer to easily link the certificate to existing database records\n   associated\
    \ with the subject.  For example, an authority may use\n   internal database keys\
    \ or subscriber IDs as the subject's common name\n   in issued certificates.\n\
    \   Although the subject's common name in a certificate does not convey\n   identity,\
    \ it is still the case that the common name must be unique\n   among all subjects\
    \ to whom a certification authority issues\n   certificates.  That is, a CA must\
    \ not issue certificates to two\n   different entities that use the same common\
    \ name for the subject.\n   Each resource certificate attests to an allocation\
    \ of resources to a\n   resource holder, so entities that have allocations from\
    \ multiple\n   sources will have multiple CA certificates.  Note that when an\
    \ entity\n   receives multiple certificates from different issuers, the subject\n\
    \   names in these certificates will generally be different.  A CA also\n   may\
    \ issue distinct certificates for each distinct allocation to the\n   same entity,\
    \ if the CA and the resource holder agree that such an\n   arrangement will facilitate\
    \ management and use of the certificates.\n   For example, an LIR/ISP may have\
    \ several certificates issued to it by\n   one registry, each describing a distinct\
    \ set of address blocks,\n   because the LIR/ISP desires to treat the allocations\
    \ as separate.\n"
- title: 2.3.  End-Entity (EE) Certificates
  contents:
  - "2.3.  End-Entity (EE) Certificates\n   The private key corresponding to a public\
    \ key contained in an EE\n   certificate is not used to sign other certificates\
    \ in a PKI.  The\n   primary function of end-entity certificates in this PKI is\
    \ the\n   verification of signed objects that relate to the usage of the\n   resources\
    \ described in the certificate, e.g., ROAs and manifests.\n   For ROAs and manifests,\
    \ there will be a one-to-one correspondence\n   between end-entity certificates\
    \ and signed objects, i.e., the private\n   key corresponding to each end-entity\
    \ certificate is used to sign\n   exactly one object, and each object is signed\
    \ with only one key.\n   This property allows the PKI to be used to revoke these\
    \ signed\n   objects, rather than creating a new revocation mechanism.  When the\n\
    \   end-entity certificate used to sign an object has been revoked, the\n   signature\
    \ on that object (and any corresponding assertions) will be\n   considered invalid,\
    \ so a signed object can be effectively revoked by\n   revoking the end-entity\
    \ certificate used to sign it.\n   A secondary advantage to this one-to-one correspondence\
    \ is that the\n   private key corresponding to the public key in a certificate\
    \ is used\n   exactly once in its lifetime, and thus can be destroyed after it\
    \ has\n   been used to sign its one object.  This fact should simplify key\n \
    \  management, since there is no requirement to protect these private\n   keys\
    \ for an extended period of time.\n   The EE certificate used to verify a signed\
    \ object appears in the\n   Cryptographic Message Syntax (CMS) wrapper (see [RFC6488])\
    \ of the\n   signed object.  Therefore, it is not necessary to transmit the EE\n\
    \   certificate separately from the signed object.  Likewise, it is not\n   necessary\
    \ for the EE certificate to appear in the RPKI repository\n   system except as\
    \ part of the corresponding signed object.\n   Although this document describes\
    \ only two uses for end-entity\n   certificates, additional uses will likely be\
    \ defined in the future.\n   For example, end-entity certificates could be used\
    \ as a more general\n   authorization for their subjects to act on behalf of the\
    \ specified\n   resource holder.  This could facilitate authentication of inter-ISP\n\
    \   interactions, or authentication of interactions with the repository\n   system.\
    \  These additional uses for end-entity certificates may\n   require retention\
    \ of the corresponding private keys, even though such\n   retention is not required\
    \ for keys used to sign ROAs and manifests.\n"
- title: 2.4.  Trust Anchors
  contents:
  - "2.4.  Trust Anchors\n   In any PKI, each relying party (RP) chooses its own set\
    \ of trust\n   anchors (TAs).  This general property of PKIs applies here as well.\n\
    \   There is an extant IP address space and AS number allocation\n   hierarchy,\
    \ and thus IANA and/or the five RIRs are obvious candidates\n   to be default\
    \ TAs here.  Nonetheless, each RP ultimately chooses the\n   set of trust anchors\
    \ it will use for certificate validation.\n   For example, an RP (e.g., an LIR/ISP)\
    \ could create a trust anchor to\n   which all address space and/or all AS numbers\
    \ are assigned, and for\n   which the RP knows the corresponding private key.\
    \  The RP could then\n   issue certificates under this trust anchor to whatever\
    \ entities in\n   the PKI it wishes, with the result that the certification paths\n\
    \   terminating at this locally installed trust anchor will satisfy the\n   validation\
    \ requirements specified in RFC 3779.  A large ISP that uses\n   private IP address\
    \ space (i.e., RFC 1918) and runs BGP internally\n   will need to create this\
    \ sort of trust anchor to accommodate a CA to\n   which all private address space\
    \ is assigned.  The RP could then issue\n   certificates under this CA that correspond\
    \ to the RP's internal use\n   of private address space.\n   Note that an RP who\
    \ elects to create and manage its own set of trust\n   anchors may fail to detect\
    \ allocation errors that arise under such\n   circumstances, but the resulting\
    \ vulnerability is local to the RP.\n   It is expected that some parties within\
    \ the extant IP address space\n   and AS number allocation hierarchy may wish\
    \ to publish trust anchor\n   material for possible use by relying parties.  A\
    \ standard profile for\n   the publication of trust anchor material for this public\
    \ key\n   infrastructure can be found in [RFC6490].\n"
- title: 3.  Route Origination Authorizations
  contents:
  - "3.  Route Origination Authorizations\n   The information on IP address allocation\
    \ provided by the PKI is not,\n   in itself, sufficient to guide routing decisions.\
    \  In particular, BGP\n   is based on the assumption that the AS that originates\
    \ routes for a\n   particular prefix is authorized to do so by the holder of that\
    \ prefix\n   (or an address block encompassing the prefix); the PKI contains no\n\
    \   information about these authorizations.  A Route Origination\n   Authorization\
    \ (ROA) makes such authorization explicit, allowing a\n   holder of IP address\
    \ space to create an object that explicitly and\n   verifiably asserts that an\
    \ AS is authorized to originate routes to a\n   given set of prefixes.\n"
- title: 3.1.  Role in the Overall Architecture
  contents:
  - "3.1.  Role in the Overall Architecture\n   A ROA is an attestation that the holder\
    \ of a set of prefixes has\n   authorized an autonomous system to originate routes\
    \ for those\n   prefixes.  A ROA is structured according to the format described\
    \ in\n   [RFC6482].  The validity of this authorization depends on the signer\n\
    \   of the ROA being the holder of the prefix(es) in the ROA; this fact\n   is\
    \ asserted by an end-entity certificate from the PKI, whose\n   corresponding\
    \ private key is used to sign the ROA.\n   ROAs may be used by relying parties\
    \ to verify that the AS that\n   originates a route for a given IP address prefix\
    \ is authorized by the\n   holder of that prefix to originate such a route.  For\
    \ example, an ISP\n   might use validated ROAs as inputs to route filter construction\
    \ for\n   use by its BGP routers.  (See [RFC6483] for information on the use of\n\
    \   ROAs to validate the origination of BGP routes.)\n   Initially, the repository\
    \ system will be the primary mechanism for\n   disseminating ROAs, since these\
    \ repositories will hold the\n   certificates and CRLs needed to verify ROAs.\
    \  In addition, ROAs also\n   could be distributed in BGP UPDATE messages or via\
    \ other\n   communication paths, if needed to meet timeliness requirements.\n"
- title: 3.2.  Syntax and Semantics
  contents:
  - "3.2.  Syntax and Semantics\n   A ROA constitutes an explicit authorization for\
    \ a single AS to\n   originate routes to one or more prefixes, and is signed by\
    \ the holder\n   of those prefixes.  Conceptually, the ROA syntax consists of\
    \ two\n   parts, a general CMS template common to all RPKI signed objects\n  \
    \ [RFC6488] and an encapsulated content specific to the ROA that\n   expresses\
    \ the authorization [RFC6482].\n   At a high level, the ROA's content contains\
    \ (1) an AS number; (2) a\n   list of IP address prefixes; and, optionally, (3)\
    \ for each prefix,\n   the maximum length of more specific (longer) prefixes that\
    \ the AS is\n   also authorized to advertise.  (This last element facilitates\
    \ a\n   compact authorization to advertise, for example, any prefixes of\n   length\
    \ 20 to 24 bits contained within a given length 20 prefix.)\n   Note that a ROA\
    \ contains only a single AS number.  Thus, if an ISP\n   has multiple AS numbers\
    \ that will be authorized to originate routes\n   to the prefix(es) in the ROA,\
    \ an address space holder will need to\n   issue multiple ROAs to authorize the\
    \ ISP to originate routes from any\n   of these ASes.\n   A ROA is signed using\
    \ the private key corresponding to the public key\n   in an end-entity (EE) certificate\
    \ in the PKI.  In order for a ROA to\n   be valid, its corresponding end-entity\
    \ certificate must be valid, and\n   the IP address prefixes of the ROA must exactly\
    \ match the IP address\n   prefix(es) specified in the EE certificate's RFC 3779\
    \ extension.\n   Therefore, the validity interval of the ROA is implicitly the\n\
    \   validity interval of its corresponding certificate.  A ROA is revoked\n  \
    \ by revoking the corresponding EE certificate.  There is no\n   independent method\
    \ of revoking a ROA.  One might worry that this\n   revocation model could lead\
    \ to long CRLs for the CA certification\n   that is signing the EE certificates.\
    \  However, routing announcements\n   on the public Internet are generally quite\
    \ long lived.  Therefore, as\n   long as the EE certificates used to verify a\
    \ ROA are given a validity\n   interval of several months, the likelihood that\
    \ many ROAs would need\n   to be revoked within that time is quite low.\n    \
    \         ---------                ---------\n             |  RIR  |         \
    \       |  NIR  |\n             |  CA   |                |  CA   |\n         \
    \    ---------                ---------\n                 |                  \
    \      |\n                 |                        |\n                 |    \
    \                    |\n             ---------                ---------\n    \
    \         |  ISP  |                |  ISP  |\n             |  CA 1 |         \
    \       |  CA 2 |\n             ---------                ---------\n         \
    \     |     \\                      |\n              |      -----            \
    \     |\n              |           \\                |\n          ---------- \
    \   ----------      ----------\n          |  ISP   |    |  ISP   |      |  ISP\
    \   |\n          |  EE 1a |    |  EE 1b |      |  EE 2  |\n          ----------\
    \    ----------      ----------\n              |             |               |\n\
    \              |             |               |\n              |             |\
    \               |\n          ----------    ----------      ----------\n      \
    \    | ROA 1a |    | ROA 1b |      | ROA 2  |\n          ----------    ----------\
    \      ----------\n   Figure 1: This figure illustrates an ISP with allocations\
    \ from two\n   sources (an RIR and an NIR).  It needs two CA certificates due\
    \ to the\n   rules defined in RFC 3779.\n   Because each ROA is associated with\
    \ a single end-entity certificate,\n   the set of IP prefixes contained in a ROA\
    \ must be drawn from an\n   allocation by a single source, i.e., a ROA cannot\
    \ combine allocations\n   from multiple sources.  Address space holders who have\
    \ allocations\n   from multiple sources, and who wish to authorize an AS to originate\n\
    \   routes for these allocations, must issue multiple ROAs to the AS.\n"
- title: 4.  Repositories
  contents:
  - "4.  Repositories\n   Initially, an LIR/ISP will make use of the resource PKI\
    \ by acquiring\n   and validating every ROA, to create a table of the prefixes\
    \ for which\n   each AS is authorized to originate routes.  To validate all ROAs,\
    \ an\n   LIR/ISP needs to acquire all the certificates and CRLs.  The primary\n\
    \   function of the distributed repository system described here is to\n   store\
    \ these signed objects and to make them available for download by\n   LIRs/ISPs.\
    \  Note that this repository system provides a mechanism by\n   which relying\
    \ parties can pull fresh data at whatever frequency they\n   deem appropriate.\
    \  However, it does not provide a mechanism for\n   pushing fresh data to relying\
    \ parties (e.g., by including resource\n   PKI objects in BGP or other protocol\
    \ messages) and such a mechanism\n   is beyond the scope of the current document.\n\
    \   The digital signatures on all objects in the repository ensure that\n   unauthorized\
    \ modification of valid objects is detectable by relying\n   parties.  Additionally,\
    \ the repository system uses manifests (see\n   Section 5) to ensure that relying\
    \ parties can detect the deletion of\n   valid objects and the insertion of out-of-date,\
    \ valid signed objects.\n   The repository system is also a point of enforcement\
    \ for access\n   controls for the signed objects stored in it, e.g., ensuring\
    \ that\n   records related to an allocation of resources can be manipulated only\n\
    \   by authorized parties.  The use of access controls prevents denial-\n   of-service\
    \ attacks based on deletion of or tampering with repository\n   objects.  Indeed,\
    \ although relying parties can detect tampering with\n   objects in the repository,\
    \ it is preferable that the repository\n   system prevent such unauthorized modifications\
    \ to the greatest extent\n   possible.\n"
- title: 4.1.  Role in the Overall Architecture
  contents:
  - "4.1.  Role in the Overall Architecture\n   The repository system is the untrusted\
    \ clearing-house for all signed\n   objects that must be globally accessible to\
    \ relying parties.  When\n   certificates and CRLs are created, they are uploaded\
    \ to this\n   repository, and then downloaded for use by relying parties (primarily\n\
    \   LIRs/ISPs).  ROAs and manifests are additional examples of such\n   objects,\
    \ but other types of signed objects may be added to this\n   architecture in the\
    \ future.  This document briefly describes the way\n   signed objects (certificates,\
    \ CRLs, ROAs, and manifests) are managed\n   in the repository system.  As other\
    \ types of signed objects are added\n   to the repository system, it will be necessary\
    \ to modify the\n   description, but it is anticipated that most of the design\
    \ principles\n   will still apply.  The repository system is described in detail\
    \ in\n   [RFC6481].\n"
- title: 4.2.  Contents and Structure
  contents:
  - "4.2.  Contents and Structure\n   Although there is a single repository system\
    \ that is accessed by\n   relying parties, it is comprised of multiple databases.\
    \  These\n   databases will be distributed among registries (RIRs, NIRs,\n   LIRs/ISPs).\
    \  At a minimum, the database operated by each registry\n   will contain all CA\
    \ and EE certificates, CRLs, and manifests signed\n   by the CA(s) associated\
    \ with that registry.  Repositories operated by\n   LIRs/ISPs also will contain\
    \ ROAs.  Registries are encouraged to\n   maintain copies of repository data from\
    \ their customers, and their\n   customer's customers (etc.), to facilitate retrieval\
    \ of the whole\n   repository contents by relying parties.  Ideally, each RIR\
    \ will hold\n   PKI data from all entities within its geopolitical scope.\n  \
    \ For every certificate in the PKI, there will be a corresponding file\n   system\
    \ directory in the repository that is the authoritative\n   publication point\
    \ for all objects (certificates, CRLs, ROAs, and\n   manifests) verifiable via\
    \ this certificate.  A certificate's Subject\n   Information Access (SIA) extension\
    \ [RFC5280] contains a URI that\n   references this directory.  Additionally,\
    \ a certificate's Authority\n   Information Access (AIA) extension [RFC5280] contains\
    \ a URI that\n   references the authoritative location for the CA certificate\
    \ under\n   which the given certificate was issued.  That is, if certificate A\
    \ is\n   used to verify certificate B, then the AIA extension of certificate B\n\
    \   points to certificate A, and the SIA extension of certificate A\n   points\
    \ to a directory containing certificate B (see Figure 2).\n                  \
    \       +--------+\n              +--------->| Cert A |<----+\n              |\
    \          | CRLDP  |     |\n              |          |  AIA   |     |\n     \
    \         |  +--------- SIA   |     |\n              |  |       +--------+   \
    \  |\n              |  |                      |\n              |  |          \
    \            |\n              |  |                      |\n              |  |\
    \  +-------------------|------------------+\n              |  |  |           \
    \        |                  |\n              |  +->|   +--------+      |   +--------+\
    \     |\n              |     |   | Cert B |      |   | Cert C |     |\n      \
    \        |     |   | CRLDP ----+   |   | CRLDP -+-+   |\n              +-----------\
    \ AIA   |  |   +----- AIA   | |   |\n                    |   |  SIA   |  |   \
    \    |  SIA   | |   |\n                    |   +--------+  |       +--------+\
    \ |   |\n                    |               V                  |   |\n      \
    \              |           +---------+            |   |\n                    |\
    \           | A's CRL |<-----------+   |\n                    |           +---------+\
    \                |\n                    | A's Repository Publication Directory\
    \ |\n                    +--------------------------------------+\n          \
    \ Figure 2: Use of SIA and AIA extensions in the RPKI\n   In Figure 2, certificates\
    \ B and C are issued by CA A.  Therefore, the\n   AIA extensions of certificates\
    \ B and C point to (certificate) A, and\n   the SIA extension of certificate A\
    \ points to the repository\n   publication point of CA A's subordinate products,\
    \ which includes\n   certificates B and C, as well as the CRL issued by A.  The\
    \ CRL\n   Distribution Points (CRLDP) extension in certificates B and C both\n\
    \   point to the CRL issued by A.\n   If a CA certificate is reissued with the\
    \ same public key, it should\n   not be necessary to reissue (with an updated\
    \ AIA URI) all\n   certificates signed by the certificate being reissued.  Therefore,\
    \ a\n   certification authority SHOULD use a persistent URI naming scheme for\n\
    \   issued certificates.  That is, reissued certificates should use the\n   same\
    \ publication point as previously issued certificates having the\n   same subject\
    \ and public key, and should overwrite such certificates.\n"
- title: 4.3.  Access Protocols
  contents:
  - "4.3.  Access Protocols\n   Repository operators will choose one or more access\
    \ protocols that\n   relying parties can use to access the repository system.\
    \  These\n   protocols will be used by numerous participants in the infrastructure\n\
    \   (e.g., all registries, ISPs, and multi-homed subscribers) to maintain\n  \
    \ their respective portions of it.  In order to support these\n   activities,\
    \ certain basic functionality is required of the suite of\n   access protocols,\
    \ as described below.  No single access protocol\n   needs to implement all of\
    \ these functions (although that may be the\n   case), but each function MUST\
    \ be implemented by at least one access\n   protocol deployed by a repository\
    \ operator.\n   Download: Access protocols must support the bulk download of\n\
    \   repository contents and subsequent download of changes to the\n   downloaded\
    \ contents, since this will be the most common way in which\n   relying parties\
    \ interact with the repository system.  Other types of\n   download interactions\
    \ (e.g., download of a single object) may also be\n   supported.\n   Upload/change/delete:\
    \ Access protocols must also support mechanisms\n   for the issuers of certificates,\
    \ CRLs, and other signed objects to\n   add them to the repository, and to remove\
    \ them.  Mechanisms for\n   modifying objects in the repository may also be provided.\
    \  All access\n   protocols that allow modification to the repository (through\n\
    \   addition, deletion, or modification of its contents) must support\n   verification\
    \ of the authorization of the entity performing the\n   modification, so that\
    \ appropriate access controls can be applied (see\n   Section 4.4).\n   To ensure\
    \ all relying parties are able to acquire all RPKI signed\n   objects, all publication\
    \ points MUST be accessible via rsync (see\n   [RFC5781] and [RSYNC]), although\
    \ other download protocols MAY also be\n   supported.  A repository publication\
    \ point may provide\n   update/change/delete functionality via (set of) access\
    \ protocols that\n   it desires, provided that the supported protocols are clearly\n\
    \   communicated to all certification authorities publishing data at a\n   given\
    \ publication point.\n"
- title: 4.4.  Access Control
  contents:
  - "4.4.  Access Control\n   In order to maintain the integrity of information in\
    \ the repository,\n   controls must be put in place to prevent the addition, deletion,\
    \ or\n   modification of objects in the repository by unauthorized parties.\n\
    \   The identities of parties attempting to make such changes can be\n   authenticated\
    \ through the relevant access protocols.  Although\n   specific access control\
    \ policies are subject to the local control of\n   repository operators, it is\
    \ RECOMMENDED that repositories allow only\n   the issuers of signed objects to\
    \ add, delete, or modify them.\n   Alternatively, it may be advantageous in the\
    \ future to define a\n   formal delegation mechanism to allow resource holders\
    \ to authorize\n   other parties to act on their behalf, as suggested in Section\
    \ 2.3.\n"
- title: 5.  Manifests
  contents:
  - "5.  Manifests\n   A manifest is a signed object listing of all of the signed\
    \ objects\n   (except for the manifest itself) issued by an authority responsible\n\
    \   for a publication in the repository system.  For each unexpired\n   certificate,\
    \ CRL, or ROA issued by the authority, the manifest\n   contains both the name\
    \ of the file containing the object, and a hash\n   of the file content.\n   As\
    \ with ROAs, a manifest is signed by a private key, for which the\n   corresponding\
    \ public key appears in an end-entity certificate.  This\n   EE certificate, in\
    \ turn, is signed by the CA in question.  Since the\n   private key in an EE certificate\
    \ is used to sign only a single\n   manifest, then the manifest can be revoked\
    \ by revoking the EE\n   certificate.  In such a case, to avoid needless CRL growth,\
    \ the EE\n   certificate used to validate a manifest SHOULD expire at the same\n\
    \   time that the manifest expires.\n   Manifests may be used by relying parties\
    \ when constructing a local\n   cache (see Section 6) to mitigate the risk of\
    \ an attacker who deletes\n   files from a repository or replaces current signed\
    \ objects with stale\n   versions of the same object.  Such protection is needed\
    \ because,\n   although all objects in the repository system are signed, the\n\
    \   repository system itself is untrusted.\n"
- title: 5.1.  Syntax and Semantics
  contents:
  - "5.1.  Syntax and Semantics\n   A manifest constitutes a list of (the hashes of)\
    \ all the files in a\n   repository point at a particular point in time.  A detailed\n\
    \   specification of the manifest's content is provided in [RFC6486] but,\n  \
    \ at a high level, a manifest consists of (1) a manifest number; (2)\n   the time\
    \ the manifest was issued; (3) the time of the next planned\n   update; and (4)\
    \ a list of filename and hash value pairs.\n   The manifest number is a sequence\
    \ number that is incremented each\n   time a manifest is issued by the authority.\
    \  An authority is REQUIRED\n   to issue a new manifest any time it alters any\
    \ of its items in the\n   repository, or when the specified time of the next update\
    \ is reached.\n   A manifest is thus valid until the specified time of the next\
    \ update\n   or until a manifest is issued with a greater manifest number,\n \
    \  whichever comes first.  (Note that when an EE certificate is used to\n   sign\
    \ only a single manifest, whenever the authority issues the new\n   manifest,\
    \ the CA MUST also issue a new CRL that includes the EE\n   certificate corresponding\
    \ to the old manifest.  The revoked EE\n   certificate for the old manifest will\
    \ be removed from the CRL when it\n   expires; thus, this procedure ought not\
    \ to result in significant CRL\n   growth.)\n"
- title: 6.  Local Cache Maintenance
  contents:
  - "6.  Local Cache Maintenance\n   In order to utilize signed objects issued under\
    \ this PKI, a relying\n   party must first obtain a local copy of the valid EE\
    \ certificates for\n   the PKI.  To do so, the relying party performs the following\
    \ steps:\n      1. Query the repository system to obtain a copy of all\n     \
    \    certificates, manifests, and CRLs issued under the PKI.\n      2. For each\
    \ CA certificate in the PKI, verify the signature on the\n         corresponding\
    \ manifest.  Additionally, verify that the current\n         time is earlier than\
    \ the time indicated in the nextUpdate field\n         of the manifest.\n    \
    \  3. For each manifest, verify that certificates and CRLs issued\n         under\
    \ the corresponding CA certificate match the hash values\n         contained in\
    \ the manifest.  Additionally, verify that no\n         certificate or manifest\
    \ listed on the manifest is missing from\n         the repository.  If the hash\
    \ values do not match, or if any\n         certificate or CRL is missing, notify\
    \ the appropriate\n         repository administrator that the repository data\
    \ has been\n         corrupted.\n      4. Validate each EE certificate by constructing\
    \ and verifying a\n         certification path for the certificate (including\
    \ checking\n         relevant CRLs) to the locally configured set of TAs.  (See\n\
    \         [RFC6487] for more details.)\n   Note that since relying parties will\
    \ perform these operations\n   regularly, it is more efficient for the relying\
    \ party to request from\n   the repository system only those objects that have\
    \ changed since the\n   relying party last updated its local cache.\n   Note also\
    \ that by checking all issued objects against the appropriate\n   manifest, the\
    \ relying party can be certain that it is not missing an\n   updated version of\
    \ any object.\n"
- title: 7.  Common Operations
  contents:
  - "7.  Common Operations\n   Creating and maintaining the infrastructure described\
    \ above will\n   entail additional operations as \"side effects\" of normal resource\n\
    \   allocation and routing authorization procedures.  For example, a\n   subscriber\
    \ with provider-independent (\"portable\") address space who\n   enters a relationship\
    \ with an ISP will need to issue one or more ROAs\n   identifying that ISP, in\
    \ addition to conducting any other necessary\n   technical or business procedures.\
    \  The current primary use of this\n   infrastructure is for route filter construction;\
    \ using ROAs, route\n   filters can be constructed in an automated fashion with\
    \ high\n   assurance that the holder of the advertised prefix has authorized the\n\
    \   origin AS to originate an advertised route.\n"
- title: 7.1.  Certificate Issuance
  contents:
  - "7.1.  Certificate Issuance\n   There are several operational scenarios that require\
    \ certificates to\n   be issued.  Any allocation that may be sub-allocated requires\
    \ a CA\n   certificate, e.g., so that certificates can be issued as necessary\n\
    \   for the sub-allocations.  Holders of provider-independent IP address\n   space\
    \ allocations also must have certificates, so that a ROA can be\n   issued to\
    \ each ISP that is authorized to originate a route to the\n   allocation (since\
    \ the allocation does not come from any ISP).\n   Additionally, multi-homed subscribers\
    \ may require certificates for\n   their allocations if they intend to issue the\
    \ ROAs for their\n   allocations (see Section 7.3.2).  Other resource holders\
    \ need not be\n   issued CA certificates within the PKI.\n   In the long run,\
    \ a resource holder will not request resource\n   certificates, but rather receive\
    \ a certificate as a side effect of\n   the allocation process for the resource.\
    \  However, initial deployment\n   of the RPKI will entail issuance of certificates\
    \ to existing resource\n   holders as an explicit event.  Note that in all cases,\
    \ the authority\n   issuing a CA certificate will be the entity who allocates\
    \ resources\n   to the subject.  This differs from most PKIs in which a subject\
    \ can\n   request a certificate from any certification authority.\n   If a resource\
    \ holder receives multiple allocations over time, it may\n   accrue a collection\
    \ of resource certificates to attest to them.  If a\n   resource holder receives\
    \ multiple allocations from the same source,\n   the set of resource certificates\
    \ may be combined into a single\n   resource certificate, if both the issuer and\
    \ the resource holder\n   agree.  This is accomplished by consolidating the IP\
    \ Address\n   Delegation and AS Identifier Delegation extensions into a single\n\
    \   extension (of each type) in a new certificate.  However, if these\n   certificates\
    \ attest to allocations that are valid for different\n   periods of time, creating\
    \ a certificate that combines them might\n   create problems, as the combined\
    \ certificate can express only a\n   single validity interval.\n   If a resource\
    \ holder's allocations come from different sources, they\n   will be signed by\
    \ different CAs and cannot be combined.  When a set\n   of resources is no longer\
    \ allocated to a resource holder, any\n   certificates attesting to such an allocation\
    \ MUST be revoked.  A\n   resource holder SHOULD NOT use the same public key in\
    \ multiple CA\n   certificates that are issued by the same or differing authorities,\
    \ as\n   reuse of a key pair complicates path construction.  Note that since\n\
    \   the subject's distinguished name is chosen by the issuer, a subject\n   who\
    \ receives allocations from two sources generally will receive\n   certificates\
    \ with different subject names.\n"
- title: 7.2.  CA Key Rollover
  contents:
  - "7.2.  CA Key Rollover\n   Whenever a certification authority wishes to change\
    \ the public key\n   (and corresponding private key) associated with its RPKI\
    \ CA\n   certificate, it MUST perform a key rollover procedure.  Key rollover\n\
    \   is typically performed on a periodic basis, where the frequency of\n   key\
    \ rollovers is specified in the certification practice statement of\n   the given\
    \ CA.  Additionally, unscheduled rollovers may be required in\n   the event of\
    \ suspected key compromises.\n   Note that rollover is only required when the\
    \ CA's key actually\n   changes; it is not required in cases where a new CA certificate\
    \ is\n   issued with the same key as the previous certificate for this CA.\n \
    \  For example, a new CA certificate must be issued if the CA gains or\n   relinquishes\
    \ a resource, or if the validity period of the resource\n   allocation is extended.\
    \  However, in such cases, the new certificate\n   will generally use the same\
    \ public (and private) key as the previous\n   certificate; thus, key rollover\
    \ is not required.\n   The document [RFC6489] specifies a conservative key rollover\n\
    \   procedure that should be used by a certification authority when it\n   changes\
    \ the public (and private) keys associated with its RPKI CA\n   certificate. \
    \ At a high level, the two key properties of the rollover\n   procedure are as\
    \ follows.  First, as data from RPKI signed objects\n   may be used in routing\
    \ operations, the procedure ensures that at any\n   point in the rollover procedure,\
    \ a relying party will never reach\n   incorrect conclusions about the validity\
    \ of a signed object.  Note in\n   particular, that the CA cannot assume that\
    \ a relying party will use\n   any particular algorithm for constructing a certificate\
    \ path from an\n   EE certificate to (one of) the relying party's trust anchor(s);\n\
    \   therefore, the key rollover procedure is designed to preserve the\n   integrity\
    \ of the SIA and AIA points within the RPKI hierarchy to the\n   greatest extent\
    \ possible.  Second, the key rollover procedure is\n   designed so that the reissuance\
    \ of all certificates below the CA in\n   the RPKI hierarchy is not required.\
    \  Of course, it is necessary to\n   re-sign all certificates issued directly\
    \ under the CA whose key is\n   changing.  However, the SIA and AIA pointers within\
    \ the certificates\n   are populated so that no further reissuance is required.\n"
- title: 7.3.  ROA Management
  contents:
  - "7.3.  ROA Management\n   Whenever a holder of IP address space wants to authorize\
    \ an AS to\n   originate routes for a prefix within his holdings, he MUST issue\
    \ an\n   end-entity certificate containing that prefix in an IP Address\n   Delegation\
    \ extension.  He then uses the corresponding private key to\n   sign a ROA containing\
    \ the designated prefix and the AS number for the\n   AS.  The resource holder\
    \ MAY include more than one prefix in the EE\n   certificate and corresponding\
    \ ROA if desired.  As a prerequisite,\n   then, any address space holder that\
    \ issues ROAs for a prefix must\n   have a resource certificate for an allocation\
    \ containing that prefix.\n   The standard procedure for issuing a ROA is as follows:\n\
    \      1. Create an end-entity certificate containing the prefix(es) to\n    \
    \     be authorized in the ROA.\n      2. Construct the payload of the ROA, including\
    \ the prefixes in the\n         end-entity certificate and the AS number to be\
    \ authorized.\n      3. Sign the ROA using the private key corresponding to the\
    \ end-\n         entity certificate (the ROA is comprised of the payload\n   \
    \      encapsulated in a CMS signed message [RFC5652]).\n      4. Upload the end-entity\
    \ certificate and the ROA to the repository\n         system.\n   The standard\
    \ procedure for revoking a ROA is to revoke the\n   corresponding end-entity certificate\
    \ by creating an appropriate CRL\n   and uploading it to the repository system.\
    \  The revoked ROA and end-\n   entity certificate SHOULD be removed from the\
    \ repository system.\n   Care must be taken when revoking ROAs in that revoking\
    \ a ROA may\n   cause a relying party to treat routing advertisements corresponding\n\
    \   to the prefixes and origin AS number in the ROA as unauthorized (and\n   potentially\
    \ even change routing behavior to no longer forward packets\n   based on those\
    \ advertisements).  In particular, resource holders\n   should adhere to the principle\
    \ of \"make before break\" as follows.\n   Before revoking a ROA corresponding\
    \ to a prefix that the resource\n   holder wishes to be routable on the Internet,\
    \ it is very important\n   for the resource holder to ensure that there exists\
    \ another valid\n   alternative ROA that lists the same prefix (possibly indicating\
    \ a\n   different AS number).  Additionally, the resource holder should\n   ensure\
    \ that the AS indicated in the valid alternative ROA is actually\n   originating\
    \ routing advertisements to the prefixes in question.\n   Furthermore, a relying\
    \ party must fetch new ROAs from the repository\n   system before taking any routing\
    \ action in response to a ROA\n   revocation.\n"
- title: 7.3.1.  Single-Homed Subscribers
  contents:
  - "7.3.1.  Single-Homed Subscribers\n   In BGP, a single-homed subscriber with Provider\
    \ Aggregatable (PA)\n   address space does not need to explicitly authorize routes\
    \ to be\n   originated for the prefix(es) it is using, since its ISP will already\n\
    \   advertise a more general prefix and route traffic for the\n   subscriber's\
    \ prefix as an internal function.  Since no routes are\n   originated specifically\
    \ for prefixes held by these subscribers, no\n   ROAs need to be issued under\
    \ their allocations; rather, the\n   subscriber's ISP will issue any necessary\
    \ ROAs for its more general\n   prefixes under resource certificates from its\
    \ own allocation.  Thus,\n   a single-homed subscriber with an IP address allocation\
    \ from his\n   service provider is not included in the RPKI, i.e., it does not\n\
    \   receive a CA certificate, nor issue EE certificates or ROAs.\n"
- title: 7.3.2.  Multi-Homed Subscribers
  contents:
  - "7.3.2.  Multi-Homed Subscribers\n   Here we consider a subscriber who receives\
    \ Provider Aggregatable (PA)\n   IP address space from a primary ISP (i.e., the\
    \ IP addresses used by\n   the subscriber are a subset of ISP A's IP address space\
    \ allocation)\n   and receives redundant upstream connectivity from one or more\n\
    \   secondary ISPs, in addition to the primary ISP.  The preferred option\n  \
    \ for such a multi-homed subscriber is for the  subscriber to obtain an\n   AS\
    \ number and run BGP with each of its upstream providers.  In such a\n   case,\
    \ there are two RECOMMENDED ways for ROA management to be\n   handled.  The first\
    \ is that the primary ISP issues a CA certificate\n   to the subscriber, and the\
    \ subscriber issues a ROA to containing the\n   subscriber's AS number and the\
    \ subscriber's IP address prefixes. The\n   second possibility is that the primary\
    \ ISP does not issue a CA\n   certificate to the subscriber, and instead issues\
    \ a ROA on the\n   subscriber's behalf that contains the subscriber's AS number\
    \ and the\n   subscriber's IP address prefixes.\n   If the subscriber is unable\
    \ or unwilling to obtain an AS number and\n   run BGP, the another option is that\
    \ the multi-homed subscriber can\n   request that the primary ISP create a ROA\
    \ for each secondary ISP that\n   authorizes the secondary ISP to originate routes\
    \ to the subscriber's\n   prefixes.  The primary ISP will also create a ROA containing\
    \ its own\n   AS number and the subscriber's prefixes, as it is likely in such\
    \ a\n   case that the primary ISP wishes to advertise precisely the\n   subscriber's\
    \ prefixes and not an encompassing aggregate.  Note that\n   this approach results\
    \ in inconsistent origin AS numbers for the\n   subscriber's prefixes that are\
    \ considered undesirable on the public\n   Internet; thus, this approach is NOT\
    \ RECOMMENDED.\n"
- title: 7.3.3.  Provider-Independent Address Space
  contents:
  - "7.3.3.  Provider-Independent Address Space\n   A resource holder is said to have\
    \ provider-independent (portable)\n   address space if the resource holder received\
    \ its allocation directly\n   from a RIR or NIR.  Because the prefixes represented\
    \ in such\n   allocations are not taken from an allocation held by an ISP, there\
    \ is\n   no ISP that holds and advertises a more general prefix.  A holder of\n\
    \   a portable IP address space allocation MUST authorize one or more\n   ASes\
    \ to originate routes to these prefixes.  Thus, the resource\n   holder MUST generate\
    \ one or more EE certificates and associated ROAs\n   to enable the AS(es) to\
    \ originate routes for the prefix(es) in\n   question.  This ROA is required because\
    \ none of the ISP's existing\n   ROAs authorize it to originate routes to the\
    \ subscriber's provider-\n   independent allocation.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   The focus of this document is security; hence,\
    \ security\n   considerations permeate this specification.\n   The security mechanisms\
    \ provided by and enabled by this architecture\n   depend on the integrity and\
    \ availability of the infrastructure it\n   describes.  The integrity of objects\
    \ within the infrastructure is\n   ensured by appropriate controls on the repository\
    \ system, as\n   described in Section 4.4.  Likewise, because the repository system\
    \ is\n   structured as a distributed database, it should be inherently\n   resistant\
    \ to denial-of-service attacks; nonetheless, appropriate\n   precautions should\
    \ also be taken, both through replication and backup\n   of the constituent databases\
    \ and through the physical security of\n   database servers.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   Instructions for IANA's participation in the RPKI\
    \ are provided in\n   [RFC6491].\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   The architecture described in this document is derived\
    \ from the\n   collective ideas and work of a large group of individuals.  This\
    \ work\n   would not have been possible without the intellectual contributions\n\
    \   of George Michaelson, Robert Loomans, Sanjaya and Geoff Huston of\n   APNIC,\
    \ Robert Kisteleki and Henk Uijterwaal of the RIPE NCC, Tim\n   Christensen and\
    \ Cathy Murphy of ARIN, Rob Austein of ISC, and Randy\n   Bush of IIJ.\n   Although\
    \ we are indebted to everyone who has contributed to this\n   architecture, we\
    \ would like to especially thank Rob Austein for the\n   concept of a manifest,\
    \ Geoff Huston for the concept of managing\n   object validity through single-use\
    \ EE certificate key pairs, and\n   Richard Barnes for help in preparing an early\
    \ version of this\n   document.\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC3779]  Lynn, C., Kent, S., and K. Seo, \"X.509 Extensions for\
    \ IP\n              Addresses and AS Identifiers\", RFC 3779, June 2004.\n   [RFC4271]\
    \  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., \"A\n              Border\
    \ Gateway Protocol 4 (BGP-4)\", RFC 4271, January\n              2006.\n   [RFC5280]\
    \  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,\n              Housley,\
    \ R., and W. Polk, \"Internet X.509 Public Key\n              Infrastructure Certificate\
    \ and Certificate Revocation List\n              (CRL) Profile\", RFC 5280, May\
    \ 2008.\n   [RFC5652]  Housley, R., \"Cryptographic Message Syntax (CMS)\", STD\
    \ 70,\n              RFC 5652, September 2009.\n   [RFC5781]  Weiler, S., Ward,\
    \ D., and R. Housley, \"The rsync URI\n              Scheme\", RFC 5781, February\
    \ 2010.\n   [RFC6481]  Huston, G., Loomans, R., and G. Michaelson, \"A Profile\
    \ for\n              Resource Certificate Repository Structure\", RFC 6481,\n\
    \              February 2012.\n   [RFC6482]  Lepinski, M., Kent, S., and D. Kong,\
    \ \"A Profile for Route\n              Origin Authorizations (ROAs)\", RFC 6482,\
    \ February 2012.\n   [RFC6486]  Austein, R., Huston., G., Kent, S., and M. Lepinski,\n\
    \              \"Manifests for the Resource Public Key Infrastructure\",\n   \
    \           RFC 6486, February 2012.\n   [RFC6487]  Huston, G., Michaelson, G.,\
    \ and R. Loomans, \"A Profile for\n              X.509 PKIX Resource Certificates\"\
    , RFC 6487, February\n              2012.\n   [RFC6488]  Lepinski, M., Chi, A.,\
    \ and S. Kent, \"Signed Object\n              Template for the Resource Public\
    \ Key Infrastructure\", RFC\n              6488, February 2012.\n   [RFC6491]\
    \  Manderson, T., Vegoda, L., and S. Kent, \"Resource Public\n              Key\
    \ Infrastructure (RPKI) Objects Issued by IANA\", RFC\n              6491, February\
    \ 2012.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [RFC6483]  Huston, G. and G. Michaelson, \"\
    Validation of Route\n              Origination Using the Resource Certificate\
    \ Public Key\n              Infrastructure (PKI) and Route Origin Authorizations\n\
    \              (ROAs)\", RFC 6483, February 2012.\n   [RFC6489]  Huston, G., Michaelson,\
    \ G., and S. Kent, \"Certification\n              Authority (CA) Key Rollover\
    \ in the Resource Public Key\n              Infrastructure (RPKI)\", BCP 174,\
    \ RFC 6489, February 2012.\n   [RFC6490]  Huston, G., Weiler, S., Michaelson,\
    \ G., and S. Kent,\n              \"Resource Public Key Infrastructure (RPKI)\
    \ Trust Anchor\n              Locator\", RFC 6490, February 2012.\n   [RSYNC]\
    \    rsync web pages, <http://rsync.samba.org/>.\n   [S-BGP]    Kent, S., Lynn,\
    \ C., and Seo, K., \"Secure Border Gateway\n              Protocol (Secure-BGP)\"\
    , IEEE Journal on Selected Areas in\n              Communications Vol. 18, No.\
    \ 4, April 2000.\n   [soBGP]    White, R., \"soBGP\", May 2005,\n            \
    \  <ftp://ftp-eng.cisco.com/sobgp/index.html>\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Matt Lepinski\n   BBN Technologies\n   10 Moulton St.\n\
    \   Cambridge, MA 02138\n   EMail: mlepinski@bbn.com\n   Stephen Kent\n   BBN\
    \ Technologies\n   10 Moulton St.\n   Cambridge, MA 02138\n   EMail: kent@bbn.com\n"
