- title: __initial_text__
  contents:
  - '             Requirements for IPsec Remote Access Scenarios

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2003).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   IPsec offers much promise as a secure remote access mechanism.\n\
    \   However, there are a number of differing remote access scenarios,\n   each\
    \ having some shared and some unique requirements.  A thorough\n   understanding\
    \ of these requirements is necessary in order to\n   effectively evaluate the\
    \ suitability of a specific set of mechanisms\n   for any particular remote access\
    \ scenario.  This document enumerates\n   the requirements for a number of common\
    \ remote access scenarios.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . .   2\n      1.1 Requirements Terminology . . . . . . . . . . . . . .\
    \ . .  3\n      1.2 Reader Prerequisites . . . . . . . . . . . . . . . . . . \
    \ 3\n      1.3 General Terminology  . . . . . . . . . . . . . . . . . .  4\n \
    \     1.4 Document Content and Organization  . . . . . . . . . . .  4\n   2. Overview\
    \  . . . . . . . . . . . . . . . . . . . . . . . . .   5\n      2.1 Endpoint Authentication\
    \ . . . . . . . . . . . . . . . .   6\n         2.1.1 Machine-Level Authentication\
    \ . . . . . . . . . . .   7\n         2.1.2 User-Level Authentication  . . . .\
    \ . . . . . . . .   7\n         2.1.3 Combined User/Machine Authentication . .\
    \ . . . . .   8\n         2.1.4 Remote Access Authentication . . . . . . . . .\
    \ . .   8\n         2.1.5 Compatibility With Legacy Remote Access Mechanisms \
    \  9\n      2.2 Remote Host Configuration  . . . . . . . . . . . . . . . 10\n\
    \      2.3 Security Policy Configuration  . . . . . . . . . . . . . 11\n     \
    \ 2.4 Auditing . . . . . . . . . . . . . . . . . . . . . . . . 12\n      2.5 Intermediary\
    \ Traversal . . . . . . . . . . . . . . . . . 13\n   3. Scenarios . . . . . .\
    \ . . . . . . . . . . . . . . . . . . .  13\n      3.1 Telecommuters (Dialup/DSL/Cablemodem)\
    \  . . . . . . . . . 14\n         3.1.1 Endpoint Authentication Requirements .\
    \ . . . . . .  15\n         3.1.2 Device Configuration Requirements  . . . . .\
    \ . . .  16\n         3.1.3 Policy Configuration Requirements  . . . . . . . .\
    \  17\n         3.1.4 Auditing Requirements  . . . . . . . . . . . . . .  18\n\
    \         3.1.5 Intermediary Traversal Requirements  . . . . . . .  18\n     \
    \ 3.2 Corporate to Remote Extranet . . . . . . . . . . . . . . 19\n         3.2.1\
    \ Authentication Requirements  . . . . . . . . . . .  19\n         3.2.2 Device\
    \ Configuration Requirements  . . . . . . . .  20\n         3.2.3 Policy Configuration\
    \ Requirements  . . . . . . . .  21\n         3.2.4 Auditing Requirements  . .\
    \ . . . . . . . . . . . .  21\n         3.2.5 Intermediary Traversal Requirements\
    \  . . . . . . .  21\n      3.3 Extranet Laptop to Home Corporate Net . . . .\
    \ . . . . .  22\n         3.3.1 Authentication Requirements  . . . . . . . . .\
    \ . .  22\n         3.3.2 Device Configuration Requirements  . . . . . . . . \
    \ 23\n         3.3.3 Policy Configuration Requirements  . . . . . . . .  23\n\
    \         3.3.4 Auditing Requirements  . . . . . . . . . . . . . .  24\n     \
    \    3.3.5 Intermediary Traversal Requirements  . . . . . . .  24\n      3.4 Extranet\
    \ Desktop to Home Corporate Net . . . . . . . . . 25\n         3.4.1 Authentication\
    \ Requirements  . . . . . . . . . . .  25\n         3.4.2 Device Configuration\
    \ Requirements  . . . . . . . .  26\n         3.4.3 Policy Configuration Requirements\
    \  . . . . . . . .  26\n         3.4.4 Auditing Requirements  . . . . . . . .\
    \ . . . . . .  26\n         3.4.5 Intermediary Traversal Requirements  . . . .\
    \ . . .  26\n      3.5 Public System to Target Network . . . . . . . . . . . .\
    \  27\n         3.5.1 Authentication Requirements  . . . . . . . . . . .  27\n\
    \         3.5.2 Device Configuration Requirements  . . . . . . . .  28\n     \
    \    3.5.3 Policy  Configuration Requirements . . . . . . . .  28\n         3.5.4\
    \ Auditing Requirements  . . . . . . . . . . . . . .  29\n         3.5.5 Intermediary\
    \ Traversal Requirements  . . . . . . .  29\n   4. Scenario Commonalities  . .\
    \ . . . . . . . . . . . . . . . .  29\n   5. Security Considerations . . . . .\
    \ . . . . . . . . . . . . .  30\n   6. References  . . . . . . . . . . . . . .\
    \ . . . . . . . . . .  30\n   7. Acknowledgements  . . . . . . . . . . . . . .\
    \ . . . . . . .  30\n   8. Editors' Addresses. . . . . . . . . . . . . . . . .\
    \ . . . .  30\n   9. Full Copyright Statement  . . . . . . . . . . . . . . . .\
    \ .  31\n"
- title: 1. Introduction
  contents:
  - "1. Introduction\n   Until recently, remote access has typically been characterized\
    \ by\n   dial-up users accessing the target network via the Public Switched\n\
    \   Telephone Network (PSTN), with the dial-up connection terminating at\n   a\
    \ Network Access Server (NAS) within the target domain.  The\n   protocols facilitating\
    \ this have usually been PPP-based, and access\n   control, authorization, and\
    \ accounting functions have typically been\n   provided using one or more of a\
    \ number of available mechanisms,\n   including RADIUS [RADIUS].\n   Note that\
    \ for such access, it has often been assumed that the\n   communications infrastructure\
    \ supporting the ISP connection (the\n   PSTN) is relatively secure, and poses\
    \ no significant threats to\n   communications integrity or confidentiality. \
    \ Based on this\n   assumption, connection security has been limited to access\
    \ control at\n   the NAS based on username/passphrase pairs.  In reality, PSTN\
    \ dialup\n   connections have never been impervious to a determined adversary.\n\
    \   The availability of widespread broadband access, in concert with the\n   desire\
    \ to reduce the cost of PSTN toll access, have driven the\n   development of Internet-based\
    \ remote access mechanisms.  In some\n   cases, PPP-based tunneling mechanisms\
    \ have been used to provide\n   remote access by allowing the dial user to first\
    \ access a local ISP\n   account, and then tunnel an additional PPP connection\
    \ over the\n   Internet into the target network.  In the case of broadband users,\n\
    \   such connections are tunneled directly over the Internet.  While\n   these\
    \ mechanisms have been lacking in terms of security features, the\n   increasing\
    \ availability of IPsec renders it possible to provide more\n   secure remote\
    \ access to the remote resources via the Internet.\n   Remote access via the Internet\
    \ has numerous benefits, financial and\n   otherwise.  However, security is paramount,\
    \ and this presents strong\n   incentives for migration from the old dial-up model\
    \ to a more secure\n   IPsec-based remote access model.  Meeting the security\
    \ requirements\n   of various classes of remote access users presents a number\
    \ of\n   challenges.  It is the aim of this document to explore and enumerate\n\
    \   the requirements of various IPsec remote access scenarios, without\n   suggesting\
    \ particular solutions for them.\n"
- title: 1.1 Requirements Terminology
  contents:
  - "1.1 Requirements Terminology\n   The keywords MUST, MUST NOT, REQUIRED, SHALL,\
    \ SHALL NOT, SHOULD,\n   SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they\
    \ appear in this\n   document, are to be interpreted as described in [3].\n"
- title: 1.2 Reader Prerequisites
  contents:
  - "1.2 Reader Prerequisites\n   Reader familiarity with RFCs 2401-2412 is a minimum\
    \ prerequisite to\n   understanding the concepts discussed here.  Familiarity\
    \ with concepts\n   relating to Public Key Infrastructures (PKIs) is also necessary.\n\
    \   Familiarity with RADIUS, PPP, PPTP, L2F, L2TP, and other remote\n   access\
    \ support protocols will also be helpful, though not strictly\n   necessary.\n"
- title: 1.3 General Terminology
  contents:
  - "1.3 General Terminology\n   o  Remote Access - this term is used to refer to\
    \ the case in which\n      the remote user does not necessarily reside at a fixed\
    \ location,\n      i.e., in which the user's IP address is not fixed, and therefore\n\
    \      usually not known prior to connection establishment.\n   o  Secure Remote\
    \ Access - this term refers to remote access which is\n      secured using elements\
    \ of the IPsec protocol suite.\n   o  IPsec Remote Access Client (IRAC)- this\
    \ term is used to refer to\n      the remote access user's system.\n   o  IPsec\
    \ Remote Access Server (IRAS) - this term refers to the device\n      providing\
    \ access to the target network.  An alternative term is\n      \"Security Gateway\"\
    .\n   o  Security GateWay (SGW) - this refers to the device providing\n      access\
    \ to the target network.  An alternative term is IRAS.\n   o  Virtual IP address\
    \ (VIP) - this term describes an address from a\n      subnet local to the target\
    \ network which is assigned to a remote\n      client, giving the appearance that\
    \ the remote client actually\n      resides on the target network.\n   o  Machine-Level\
    \ Authentication - this term describes the case where\n      the identity of a\
    \ machine is verified by virtue of the machine's\n      possession and application\
    \ of some combination of authenticators.\n      For a more complete definition,\
    \ see section 2.\n   o  User-Level Authentication - this term describes the case\
    \ where the\n      identity of a user (as opposed to that of a machine) is verified\n\
    \      by virtue of the user's possession and application of some\n      combination\
    \ of authenticators.  For a more complete definition,\n      see section 2.\n\
    \   o  NAPT - Network Address/Port Translation\n"
- title: 1.4 Document Content and Organization
  contents:
  - "1.4 Document Content and Organization\n   This document, while initially intended\
    \ to simply outline\n   requirements for various remote access scenarios, has\
    \ come to include\n   somewhat more than this.  This document has evolved from\
    \ discussion\n   within the IPsec Remote Access (IPSRA) working group.  As a result,\n\
    \   it in some respects documents the evolution of this thought process.\n   While\
    \ this represents a departure from the typical form of a\n   requirements document,\
    \ the associated historical context should prove\n   useful in interpreting the\
    \ conclusions reached in the IPSRA working\n   group.\n   The balance of this\
    \ document is organized as follows: First, there is\n   a general overview of\
    \ the basic requirements categories, including\n   definitions relevant to these\
    \ categories.  Following this is a\n   section devoted to each remote access scenario.\
    \  Within each of these\n   sections there are subsections detailing requirements\
    \ specific to\n   that scenario in each of the following areas: endpoint\n   authentication,\
    \ remote host configuration, policy configuration,\n   auditing, and intermediary\
    \ traversal.\n"
- title: 2. Overview
  contents:
  - "2. Overview\n   In a very general sense, all secure remote access scenarios have\
    \ a\n   similar high-level appearance:\n                                     \
    \    target network\n                                              |\n       \
    \                                       |   +---+\n   +-------------+        \
    \     +-----------+  |---|   |\n   |remote access|  Internet   | security  | \
    \ |   +---+\n   |   client    |=============| gateway   |--|\n   |   (IRAC)  \
    \  |             |(SGW/IRAS) |  |   +---+\n   +-------------+             +-----------+\
    \  |---|   |\n                                              |   +---+\n   In all\
    \ cases, a remote client wishes to securely access resources\n   either behind\
    \ a SGW or on an IPsec-protected host, and/or wishes to\n   provide other (specific)\
    \ systems with secure access to the client's\n   own resources.  There are numerous\
    \ details which may differ,\n   depending on the particular scenario.  For example,\
    \ the IRAC may be\n   within another corporate network, or connected to an ISP\
    \ via dialup,\n   DSL, or CATV media.  There may be additional intermediaries\
    \ between\n   the remote client and the security gateway, but ultimately, all\
    \ of\n   these configurations may be viewed somewhat equivalently from a high\n\
    \   level.\n   In general, there are several basic categories of requirements\n\
    \   relevant to secure remote access scenarios, including endpoint\n   authentication,\
    \ remote host configuration, security policy\n   configuration, auditing, and\
    \ intermediary traversal.  Endpoint\n   authentication refers to verification\
    \ of the identities of the\n   communication partners (e.g., the IRAC and the\
    \ IRAS).  Remote host\n   configuration refers to the device configuration parameters\
    \ of the\n   IRAC system.  Security policy configuration refers to IPsec policy\n\
    \   configuration of both the security gateway and the remote host, and\n   might\
    \ also be termed \"access control and authorization\n   configuration\".  Auditing\
    \ refers to the generation and collection of\n   connection status information\
    \ which is required for the purpose of\n   maintaining the overall security and\
    \ integrity of the connected\n   networks.  Intermediary traversal refers to the\
    \ ability to pass\n   secured traffic across intermediaries, some of which may\
    \ modify the\n   packets in some manner.  Such intermediaries include NAPT and\n\
    \   firewall devices.  These various categories are treated in more\n   detail\
    \ below.\n"
- title: 2.1 Endpoint Authentication
  contents:
  - "2.1 Endpoint Authentication\n   Before discussing endpoint authentication with\
    \ respect to remote\n   access, it is important to distinguish between data source\n\
    \   authentication and end user authentication.  Data source\n   authentication\
    \ in the IPsec context consists in providing assurance\n   that a network packet\
    \ originates from a specific endpoint, typically\n   a user, host, or application.\
    \  IPsec offers mechanisms for this via\n   AH or ESP.  End user authentication\
    \ within the IPsec context consists\n   in providing assurance that the endpoint\
    \ is what or who it claims to\n   be.  IPsec currently offers mechanisms for this\
    \ as part of IKE\n   [IKE].\n   While the two types of authentication differ,\
    \ they are not unrelated.\n   In fact, data source authentication relies upon\
    \ endpoint\n   authentication, because it is possible to inject packets with a\n\
    \   particular IP address into the Internet from many arbitrary\n   locations.\
    \  In many instances, we cannot be certain that a packet\n   actually originates\
    \ from a particular host, or even from the network\n   upon which that host resides.\
    \  To resolve this, one must first\n   authenticate the particular endpoint somehow,\
    \ and then bind the\n   addressing information (e.g., IP address, protocol, port)\
    \ of this\n   endpoint into the trust relationship established by the\n   authentication\
    \ process.\n   In the context of secure remote access, the authenticated entity\
    \ may\n   be a machine, a user (application), or both.  The authentication\n \
    \  methods currently supported by IPsec range from preshared secrets to\n   various\
    \ signature and encryption schemes employing private keys and\n   their corresponding\
    \ public key certificates.  These mechanisms may be\n   used to authenticate the\
    \ end user alone, the device alone, or both\n   the end user and the device. \
    \ These are each discussed in more detail\n   below.\n"
- title: 2.1.1 Machine-Level Authentication
  contents:
  - "2.1.1 Machine-Level Authentication\n   In the case where no user input is required\
    \ in order for an\n   authentication credential to be used, the entity authenticated\
    \ will\n   primarily be the device in which the credential is stored and the\n\
    \   level of derived assurance regarding this authentication is directly\n   related\
    \ to how securely the machine's credential is maintained during\n   both storage\
    \ and use.  That is, a shared secret or a private key\n   corresponding to a public\
    \ key certificate may be either stored within\n   the device or contained in another\
    \ device which is securely\n   accessible by the device (e.g., a smartcard). \
    \ If the knowledge\n   required for the use of such authentication credentials\
    \ is entirely\n   contained within the subject device (i.e., no user input is\n\
    \   required), then it is problematic to state that such credential usage\n  \
    \ authenticates anything other than the subject device.\n   In some cases, a user\
    \ may be required to satisfy certain criteria\n   prior to being given access\
    \ to stored credentials.  In such cases,\n   the level of user authentication\
    \ provided by the use of such\n   credentials is somewhat difficult to derive.\
    \  If sufficiently strong\n   access controls exist for the system housing the\
    \ credential, then\n   there may be a strong binding between the authorized system\
    \ user and\n   the credential.  However, at the time the credential is presented,\n\
    \   the IRAS itself has no such assurance.  That is, the IRAS in\n   isolation\
    \ may have some level of assurance that a particular device\n   (the one in which\
    \ the credential resides) is the one from which\n   access is being attempted,\
    \ but there is no explicit assurance\n   regarding the identity of the user of\
    \ the system.  In order for the\n   IRAS to derive additional assurance regarding\
    \ the user identity, an\n   additional user credential of some sort would be required.\
    \  This is\n   discussed further below.\n"
- title: 2.1.2 User-Level Authentication
  contents:
  - "2.1.2 User-Level Authentication\n   In some cases, the user may possess an authentication\
    \ token\n   (preshared key, private key, passphrase, etc.), and may provide this\n\
    \   or some derivative of this whenever authentication is required.  If\n   this\
    \ token or derivative is delivered directly to the other endpoint\n   without\
    \ modification by the IRAC system, and if the IRAC system\n   provides no further\
    \ credentials of its own, then it is the user alone\n   which has been authenticated.\
    \  That is, while there may be some\n   assurance as to the network address from\
    \ which the user is\n   originating packets, there is no assurance as to the particular\n\
    \   machine from which the user is attempting access.\n"
- title: 2.1.3 Combined User/Machine Authentication
  contents:
  - "2.1.3 Combined User/Machine Authentication\n   To authenticate both the user\
    \ and the system, user input of some sort\n   is required in addition to a credential\
    \ which is securely stored upon\n   the device.  In some cases, such user input\
    \ may be used in order to\n   \"complete\" the credential stored on the device\
    \ (e.g., a private key\n   is password-encrypted), while in others the user's\
    \ input is supplied\n   independently of the stored credential.  In the case where\
    \ the\n   passphrase is applied to the credential prior to use, the level of\n\
    \   assurance derived from successful application of the credential\n   varies\
    \ according to your viewpoint.\n   From the perspective of a system consisting\
    \ of user, IRAC, IRAS, and\n   a collection of system protections and security\
    \ procedures, it may be\n   said that the user has been authenticated to an extent\
    \ which depends\n   upon the strength of the security procedures and system protections\n\
    \   which are in place.  However, from the perspective of the IRAS alone,\n  \
    \ there is little assurance with respect to user identity.  That is,\n   schemes\
    \ requiring that stored credentials be modified by user input\n   prior to use\
    \ may only be said to provide user-level authentication\n   within the context\
    \ of the larger system, and then, the level of\n   assurance derived is directly\
    \ proportional to the weakest security\n   attribute of the entire system.\n \
    \  When considering remote access from a general perspective,\n   assumptions\
    \ regarding the overall system are liable to prove\n   incorrect.  This is because\
    \ the IRAS and the IRAC may not be within\n   the same domain of control; extranet\
    \ scenarios are a good example of\n   this.  Hence, the most desirable joint user/machine\
    \ authentication\n   mechanisms in this context are those which provide a high\
    \ level of\n   assurance to both the IRAS and the IRAC, independently of the larger\n\
    \   system of which the user, IRAS, and IRAC are a part.\n"
- title: 2.1.4 Remote Access Authentication
  contents:
  - "2.1.4 Remote Access Authentication\n   In the general case for remote access,\
    \ authentication requirements\n   are typically asymmetric.  From the IRAC's perspective,\
    \ it is\n   important to ensure that the IRAS at the other end of the connection\n\
    \   is indeed what it seems to be, and not some rogue system masquerading\n  \
    \ as the SGW.  That is, the IRAC requires machine-level authentication\n   for\
    \ the IRAS.  This is fairly straightforward, given the\n   authentication mechanisms\
    \ supported by IKE and IPsec.  Further, this\n   sort of authentication tends\
    \ to persist through time, although the\n   extent of this persistence depends\
    \ upon the mechanism chosen.\n   While machine-level authentication for the IRAS\
    \ is sufficient, this\n   is not the case for the IRAC.  Here, it is often important\
    \ to know\n   that the entity at the other end of the connection is one who is\n\
    \   authorized to access local resources rather than someone who happened\n  \
    \ upon an unoccupied but otherwise authorized system, or a malicious\n   Trojan\
    \ horse application on that user's system, or some other\n   unauthorized entity.\
    \  Authenticating the user presents different\n   requirements than authenticating\
    \ the user's machine; this requires\n   some form of user input, and often the\
    \ authentication must be\n   periodically renewed.\n   In situations where a high\
    \ level of physical security does not exist,\n   it is common to require a user-input\
    \ secret as part of the\n   authentication process, and then to periodically renew\
    \ the\n   authentication.  Furthermore, since such circumstances may include\n\
    \   the possibility of the presence of a Trojan horse application on the\n   IRAC\
    \ system, one-time passphrase mechanisms are often advisable.\n   Choosing passphrase\
    \ mechanisms and renewal intervals which provide an\n   acceptable level of risk,\
    \ but which do not annoy the user too much,\n   may be challenging.  It should\
    \ be obvious that even this approach\n   offers limited assurance in many cases.\n\
    \   Clearly, there are variable assurance levels which are attainable\n   with\
    \ the various endpoint authentication techniques, and none of the\n   techniques\
    \ discussed offer absolute assurance.  Also, there are\n   variations in the authentication\
    \ requirements among different remote\n   access scenarios.  This means there\
    \ is no \"cookie cutter\" solution\n   for this problem, and that individual scenarios\
    \ must be carefully\n   examined in order to derive specific requirements for\
    \ each.  These\n   are examined on a case by case basis below in the detailed\
    \ scenario\n   descriptions.\n"
- title: 2.1.5 Compatibility With Legacy Remote Access Mechanisms
  contents:
  - "2.1.5 Compatibility With Legacy Remote Access Mechanisms\n   There are a number\
    \ of currently deployed remote access mechanisms\n   which were installed prior\
    \ to the deployment of IPsec.  Typically,\n   these are dialup systems which rely\
    \ upon RADIUS for user\n   authentication and accounting, but there are other\
    \ mechanisms as\n   well.  An ideal IPsec remote access solution might utilize\
    \ the\n   components of the underlying framework without modification.\n   Inasmuch\
    \ as this is possible, this should be a goal.  However, there\n   may be cases\
    \ where this simply cannot be accomplished, due to\n   security and/or other considerations.\
    \  In such cases, the IPsec\n   remote access framework should be designed to\
    \ accommodate migration\n   from these mechanisms as painlessly as is possible.\n\
    \   In general, proposed IPsec remote access mechanisms should meet the\n   following\
    \ goals:\n      o  should provide direct support for legacy user authentication\n\
    \         and accounting systems such as RADIUS\n      o  should encourage migration\
    \ from existing low-entropy\n         password-based systems to more secure authentication\
    \ systems\n      o  if legacy user authentication support cannot be provided\n\
    \         without some sort of migration, the impact of such migration\n     \
    \    should be minimized\n      o  user authentication information must be protected\
    \ against\n         eavesdropping and replay (including the user identity)\n \
    \     o  single sign-on capability should be provided in configurations\n    \
    \     employing load-balancing and/or redundancy\n      o  n-factor authentication\
    \ mechanisms should be supported\n"
- title: 2.2 Remote Host Configuration
  contents:
  - "2.2 Remote Host Configuration\n   Remote host configuration refers to the network-related\
    \ device\n   configuration of the client system.  This configuration may be fixed\n\
    \   or dynamic.  It may be completely provided by the administrator of\n   the\
    \ network upon which the remote user currently resides (e.g., the\n   ISP), or\
    \ it may be partially provided by that administrator, with the\n   balance provided\
    \ by an entity on the remote corporate network which\n   the client is accessing.\
    \  In general, this configuration may include\n   the following:\n      o IP address(es)\n\
    \      o Subnet mask(s)\n      o Broadcast address(es)\n      o Host name\n  \
    \    o Domain name\n      o Time offset\n      o Servers (e.g., SMTP, POP, WWW,\
    \ DNS/NIS, LPR,\n        syslog, WINS, NTP, etc. )\n      o Router(s)\n      o\
    \ Router discovery options\n      o Static routes\n      o MTU\n      o Default\
    \ TTL\n      o Source routing options\n      o IP Forwarding enable/disable\n\
    \      o PMTU options\n      o ARP cache timeout\n      o X Windows options\n\
    \      o NIS options\n      o NetBIOS options\n      o Vendor-specific options\n\
    \      o (other options)\n   Cases where such configuration is fixed are uninteresting;\
    \ it is the\n   cases where specific IRAC configuration occurs as a result of\
    \ remote\n   access with which we are concerned.  For example, in some cases the\n\
    \   IRAC may be assigned a \"virtual address\", giving the appearance that\n \
    \  it resides on the target network:\n                                       \
    \   target net\n    +------------------+                      |\n    |  Remote\
    \ Access   |        +--------+    |   ( ~ ~ ~ ~ ~ )\n    |+-------+ Client  |\
    \        |        |    |   (   IRAC    )\n    ||virtual|         |        |security|\
    \    |~~~(  virtual  )\n    || host  |         |--------|gateway |    |   (  presence\
    \ )\n    ||       |<================>|        |----|     ~ ~ ~ ~ ~\n    |+-------+\
    \         |--------|        |    |\n    +------------------+   ^    +--------+\
    \    |   +--------+\n                           |                  |---|  local\
    \ |\n                         IPsec tunnel         |   |   host |\n          \
    \               with encapsulated    |   +--------+\n                        \
    \ traffic inside\n   In this case, the IRAC system begins with an externally routable\n\
    \   address.  An additional target network address is assigned to the\n   IRAC,\
    \ and packets containing this assigned address are encapsulated,\n   with the\
    \ outer headers containing the IRAC's routable address, and\n   forwarded to the\
    \ IRAS through the tunnel.  This provides the IRAC\n   with a virtual presence\
    \ on the target network via an IPsec tunnel.\n   Note that the IRAC now has two\
    \ active addresses: the ISP-assigned\n   address, and the VIP.\n   Having obtained\
    \ this virtual presence on the corporate network, the\n   IRAC may now require\
    \ other sorts of topology-related configuration,\n   e.g., default routers, DNS\
    \ server(s), etc., just as a dynamically\n   configured host which physically\
    \ resides upon the target network\n   would.  It is this sort of configuration\
    \ with which this requirements\n   category is concerned.\n"
- title: 2.3 Security Policy Configuration
  contents:
  - "2.3 Security Policy Configuration\n   Security policy configuration refers to\
    \ IPsec access policies for\n   both the remote access client and the security\
    \ gateway.  It may be\n   desirable to configure access policies on connecting\
    \ IRAC systems\n   which will protect the target network.  For example, since\
    \ a client\n   has access to the Internet (via its routable address), other systems\n\
    \   on the Internet also have some level of reciprocal access to the\n   client.\
    \  In some cases, it may be desirable to block this Internet\n   access (or force\
    \ it to pass through the tunnel) while the client has\n   a tunneled connection\
    \ to the target network.  This is a matter of\n   client security policy configuration.\n\
    \   For the security gateway, it may also be desirable to dynamically\n   adjust\
    \ policies based upon the user with which a connection has been\n   established.\
    \  For example, say there are two remote users, named\n   Alice and Bob.  We wish\
    \ to provide Alice with unrestricted access to\n   the target network, while we\
    \ wish to restrict Bob's access to\n   specific segments.  One way to accomplish\
    \ this would be to statically\n   assign internal \"virtual\" addresses to each\
    \ user in a one-to-one\n   mapping, so that each user always has the same address.\
    \  Then, a\n   particular user's access could be controlled via policies based\
    \ upon\n   the particular address.  However, this does not scale well.\n   A more\
    \ scalable solution for remote client access control would be to\n   dynamically\
    \ assign IP addresses from a specific pool based upon the\n   authenticated endpoint\
    \ identity, with access to specific resources\n   controlled by address-based\
    \ policies in the SGW.  This is very\n   similar to the static mapping described\
    \ above, except that a given\n   group of users (those with identical access controls)\
    \ would share a\n   given pool of IP addresses (those which are granted the required\n\
    \   access), rather than a given user always mapping to a given address.\n   However,\
    \ this also has scaling issues, though not as pronounced as\n   for the static\
    \ mapping.\n   Alternatively, an arbitrary address could be assigned to a user,\
    \ with\n   the security gateway's policy being dynamically updated based upon\n\
    \   the identity of the remote client (and its assigned virtual address)\n   to\
    \ permit access to particular resources.  In these cases, the\n   relevant security\
    \ policy configuration is specific to the IRAS,\n   rather than to the IRAC. \
    \ Both IRAS and IRAC security policy\n   configuration are encompassed by this\
    \ requirements category.\n"
- title: 2.4 Auditing
  contents:
  - "2.4 Auditing\n   Auditing is used here to refer to the collection and reporting\
    \ of\n   connection status information by the IRAS, for the purpose of\n   maintaining\
    \ the security and integrity of the IRAS protected network.\n   For remote access,\
    \ the following auditing information is useful from\n   a security perspective:\n\
    \      o connection start time\n      o connection end time\n   Note that the\
    \ requirement for a connection-end-time attribute implies\n   the need for a connection\
    \ heartbeat mechanism of some sort so that\n   the IRAS can accurately determine\
    \ this quantity in cases where the\n   IRAC does not explicitly terminate the\
    \ connection.  Also note that\n   the heartbeat mechanism in this case is always\
    \ directed from the IRAC\n   to the IRAS.\n   In some cases, use of a heartbeat\
    \ may negatively influence a\n   connection.  For example, if the heartbeat interval\
    \ is very short,\n   and the connection is reset after loss of very few heartbeat\
    \ packets,\n   there is a possibility that network congestion could lead to\n\
    \   unnecessary connection resets.  The heartbeat interval and reset\n   threshold\
    \ should be chosen with this in mind, and it should be\n   possible to adjust\
    \ these quantities either through configuration or\n   negotiation.\n"
- title: 2.5 Intermediary Traversal
  contents:
  - "2.5 Intermediary Traversal\n   Intermediary traversal is used here to refer to\
    \ passing a secured\n   data stream through an intermediary such as a firewall\
    \ or NAPT\n   device.  In the case of firewalls, numerous deployed products do\
    \ not\n   recognize the IPsec protocol suite, making it difficult (sometimes\n\
    \   impossible) to configure them to pass it through.  In such cases, a\n   mechanism\
    \ is required for making the data stream appear to be of a\n   type which the\
    \ firewall is capable of managing.\n   In the case of NAPT devices, there are\
    \ a number of issues with\n   attempting to pass an encrypted or authenticated\
    \ data stream.  For\n   example, NAPT devices typically modify the source IP address\
    \ and\n   UDP/TCP port of outgoing packets, and the destination IP address and\n\
    \   UDP/TCP port of incoming packets, and in some cases, they modify\n   additional\
    \ fields in the data portion of the packet.  Such\n   modifications render the\
    \ use of the AH protocol impossible.  In the\n   case of ESP, the UDP/TCP port\
    \ fields are sometimes unreadable and\n   always unmodifiable, making meaningful\
    \ translation by the NAPT device\n   impossible.  There are numerous other protocol-field\
    \ combinations\n   which suffer similarly.  This requirements category is concerned\
    \ with\n   these issues.\n"
- title: 3. Scenarios
  contents:
  - "3. Scenarios\n   There are numerous remote access scenarios possible using IPsec.\n\
    \   This section contains a brief summary enumeration of these, followed\n   by\
    \ a subsection devoted to each which explores the various\n   requirements in\
    \ terms of the categories defined above.\n   The following scenarios are discussed:\n\
    \   o  dialup/dsl/cablemodem telecommuters using their systems to access\n   \
    \   remote resources\n   o  extranet users using local corporate systems to access\
    \ the remote\n      company network of a business partner\n   o  extranet users\
    \ using their own system within another company's\n      network to access their\
    \ home corporate network\n   o  extranet users using a business partner's system\
    \ (located on that\n      partner's network) to access their home corporate network\n\
    \   o  remote users using a borrowed system (e.g., an airport kiosk) to\n    \
    \  access target network resources\n"
- title: 3.1 Telecommuters (Dialup/DSL/Cablemodem)
  contents:
  - "3.1 Telecommuters (Dialup/DSL/Cablemodem)\n   The telecommuter scenario is one\
    \ of the more common remote access\n   scenarios.  The convenience and wide availability\
    \ of Internet access\n   makes this an attractive option under many circumstances.\
    \  Users may\n   access the Internet from the comfort of their homes or hotel\
    \ rooms,\n   and using this Internet connection, access the resources of a target\n\
    \   network.  In some cases, dialup accounts are used to provide the\n   initial\
    \ Internet access, while in others some type of \"always-on\"\n   connection such\
    \ as a DSL or CATV modem is used.\n   The dialup and always-on cases are very\
    \ similar, with two significant\n   differences: address assignment mechanism\
    \ and connection duration.\n   In most dialup cases, the IRAC's IP address is\
    \ dynamically assigned\n   as part of connection setup, and with fairly high likelihood,\
    \ it is\n   different each time the IRAC connects.  DSL/CATV users, on the other\n\
    \   hand, often have static IP addresses assigned to them, although\n   dynamic\
    \ assignment is on the increase.  As for connection duration,\n   dialup remote\
    \ access connections are typically short-lived, while\n   always-on connections\
    \ may maintain remote access connections for\n   significantly longer periods\
    \ of time.\n   The general configuration in either case looks like this:\n   \
    \                                        corporate net\n                     \
    \                             |  +----+\n     +-----+   +-----+      /---/ Internet\
    \ +---+  |--|    |\n     |IRAC |---|modem|------|ISP|==========|SGW|--|  +----+\n\
    \     +-----+   +-----+      /---/          +---+  |\n                       \
    \                           |\n   An alternative to this configuration entails\
    \ placing a security\n   gateway between the user's system and the modem, in which\
    \ case this\n   added SGW becomes the IRAC.  This is currently most common in\
    \ cases\n   where DSL/CATV connections are used.\n"
- title: 3.1.1 Endpoint Authentication Requirements
  contents:
  - "3.1.1 Endpoint Authentication Requirements\n   The authentication requirements\
    \ of this scenario depend in part upon\n   the general security requirements of\
    \ the network to which access is\n   to be provided.  Assuming that the corporate\
    \ SGW is physically\n   secure, machine authentication for the SGW is sufficient.\
    \  If this\n   assumption regarding physical security is incorrect, it is not\
    \ clear\n   that stronger authentication for the SGW could be guaranteed, and\n\
    \   derivation of an effective mechanism for that case is beyond the\n   scope\
    \ of this document.\n   For the IRAC, there are numerous threats to the integrity\
    \ of the user\n   authentication process.  Due to the open nature of common consumer\n\
    \   operating systems, some of these threats are quite difficult to\n   protect\
    \ against.  For example, it is very difficult to assert, with\n   any level of\
    \ certainty, that a single user system which permits the\n   downloading and running\
    \ of arbitrary applications from the Internet\n   has not been compromised, and\
    \ that a covert application is not\n   monitoring and interacting with the user's\
    \ data at any point in time.\n   However, there are 2 general threats we might\
    \ realistically hope to\n   somehow mitigate with appropriate authentication mechanisms\
    \ if we can\n   assume that the system has not been compromised in this manner.\n\
    \   First, there is the possibility that a secure connection is\n   established\
    \ for a particular user, but that someone other than the\n   intended user is\
    \ currently using that connection.  Second, there is\n   the possibility that\
    \ the user's credential (password, hardware token,\n   etc.)  has been somehow\
    \ compromised, and is being used by someone\n   other than the authorized user\
    \ to gain access.\n   Mitigation of the first threat, the possibility that someone\
    \ other\n   than the authorized user is currently using the connection,  requires\n\
    \   periodic renewal of user authentication.  It should be clear that\n   machine\
    \ authentication will not suffice in this case, and that\n   requiring periodic\
    \ re-entry of an unchanging user password (which may\n   be written on a post-it\
    \ note which is stuck to the user's monitor)\n   will have limited effectiveness.\
    \  Convincing verification of the\n   continued presence of the authorized user\
    \ will, in many cases,\n   require periodic application of a time-variant credential.\n\
    \   Mitigation of the second threat, credential compromise, is difficult,\n  \
    \ and depends upon a number of factors.  If the IRAC system is running\n   a highly\
    \ secure operating system, then a time-variant credential may\n   again offer\
    \ some value.  A static password is clearly deficient in\n   this scenario, since\
    \ it may be subject to either online or offline\n   guessing, and eventually compromised\
    \ - which is the threat we are\n   attempting to mitigate.  However, if the IRAC\
    \ operating system is not\n   hardened,  the use of a time-variant credential\
    \ is only effective if\n   simultaneous access from more than one location is\
    \ forbidden, and if\n   the credential generation mechanism is not easily compromised.\n\
    \   A second approach to the credential compromise problem entails using\n   a\
    \ PKI-based credential which is stored within a secure container of\n   some sort,\
    \ and which requires some user interaction prior to\n   operation (e.g., a smartcard).\
    \  If such a credential requires\n   periodic user interaction to continue operating\
    \ (e.g., pin re-entry),\n   this may help to limit the access of an unauthorized\
    \ user who happens\n   upon a connected but unattended systems.  However, choosing\
    \ an\n   acceptable refresh interval is a difficult problem, and if the pin is\n\
    \   not\n   time-variant, this provides limited additional assurance.\n   To summarize,\
    \ the following are the authentication requirements for\n   the IRAS and IRAC:\n\
    \   IRAS\n   ----\n   o  machine authentication MUST be provided.\n   IRAC\n \
    \  ----\n   o  support for user authentication SHOULD be provided\n   o  support\
    \ for either user or machine authentication MUST be provided\n   o  support for\
    \ user authentication MUST be provided if protection\n      from unauthorized\
    \ connection use is desired.\n   o  if user authentication is provided for short-lived\
    \ dialup\n      connections, periodic renewal MAY occur\n   o  if user authentication\
    \ is provided for always-on connections,\n      periodic renewal SHOULD occur\n"
- title: 3.1.2 Device Configuration Requirements
  contents:
  - "3.1.2 Device Configuration Requirements\n   There are 2 possibilities for device\
    \ configuration in the\n   telecommuter scenario: either access to the target\
    \ network is\n   permitted for the native ISP-assigned address of the telecommuter's\n\
    \   system, or the telecommuter's system is assigned a virtual address\n   from\
    \ within the target address space.  In the first case, there are\n   no device\
    \ configuration requirements which are not already satisfied\n   by the ISP. \
    \ However, this case is the exception, rather than the\n   rule.\n   The second\
    \ case is far more common, due to the numerous benefits\n   derived by providing\
    \ the IRAC with a virtual presence on the target\n   network.  For example, the\
    \ virtual presence allows the client to\n   receive subnet broadcasts, which permits\
    \ it to use WINS on the target\n   network.  In addition, if the IRAC tunnels\
    \ all traffic to the target\n   network, then the target policy can be applied\
    \ to Internet traffic\n   to/from the IRAC.\n   In this case, the IRAC requires,\
    \ at minimum, assignment of an IP\n   address from the target network.  Typically,\
    \ the IRAC requires\n   anywhere from several more to many more elements of configuration\n\
    \   information, depending upon the corporate network's level of\n   topological\
    \ complexity.  For a fairly complete list, see section 2.2.\n   To summarize,\
    \ the following are the device configuration requirements\n   for the IRAC:\n\
    \      o  support for a virtual IP (VIP) address MAY be provided\n      o  if\
    \ VIP support is provided, support for all device-related\n         parameters\
    \ listed in section 2.2 above SHOULD be provided\n      o  support for address\
    \ assignment based upon authenticated\n         identity MAY be provided\n   \
    \   o  if authenticated address assignment is not supported, an\n         identity-based\
    \ dynamic policy update mechanism such as is\n         described in [ARCH] MUST\
    \ be supported.\n"
- title: 3.1.3 Policy Configuration Requirements
  contents:
  - "3.1.3 Policy Configuration Requirements\n   In terms of IRAC policy configuration,\
    \ the most important issue\n   pertains to whether the IRAC has direct Internet\
    \ access enabled (for\n   browsing, etc.) while a connection to the target network\
    \ exists.\n   This is important since the fact that the IRAC has access to sites\
    \ on\n   the Internet implies that those sites have some level of reciprocal\n\
    \   access to the IRAC.  It may be desirable to completely eliminate this\n  \
    \ type of access while a tunnel is active.\n   Alternatively, the risks may be\
    \ mitigated somewhat by forcing all\n   Internet-bound packets leaving the IRAC\
    \ to first traverse the tunnel\n   to the target network, where they may be subjected\
    \ to target network\n   policy.  A second approach which carries a bit less overhead\
    \ entails\n   modifying the IRAC's policy configuration to reflect that of the\n\
    \   target network during the time the IRAC is connected.  In this case,\n   traffic\
    \ is not forced to loop through the target site prior to\n   exiting or entering\
    \ the IRAC.  This requires some sort of policy\n   download (or modification)\
    \ capability as part of the SA establishment\n   process.  A third approach is\
    \ to provide a configuration variable for\n   the IRAC which permits specification\
    \ of \"tunnel-all\", or \"block all\n   traffic not destined for the target network\
    \ while the SA is up\".\n   In terms of IRAS configuration, it may be necessary\
    \ to dynamically\n   update the security policy database (SPD) when the remote\
    \ user\n   connects.  This is because transit selectors must be based upon\n \
    \  network address parameters, but these cannot be known a priori in the\n   remote\
    \ access case.  As is noted above, this may be avoided by\n   provision of a mechanism\
    \ which permits address assignment based upon\n   authenticated identity.\n  \
    \ To summarize, the following are the policy configuration requirements\n   for\
    \ the IRAS and IRAC:\n   IRAS\n   ----\n      o  dynamic policy update mechanism\
    \ based upon identity and\n         assigned address MAY be supported.\n     \
    \ o  if address assignment-based policy update mechanism is not\n         supported,\
    \ address assignment based upon authenticated identity\n         SHOULD be supported.\n\
    \   IRAC\n   ----\n      o  IRAC SHOULD provide ability to configure for \"tunnel-all\"\
    \n         and/or \"block-all\" for traffic not destined for the remote\n    \
    \     network to which IPsec remote access is being provided.\n      o  support\
    \ for dynamic IRAS update of IRAC policy MAY be provided.\n"
- title: 3.1.4 Auditing Requirements
  contents:
  - "3.1.4 Auditing Requirements\n   For telecommuter sessions, session start/end\
    \ times must be collected.\n   Reliable derivation of session end time requires\
    \ that the IRAC\n   somehow periodically signify that the connection remains active.\n\
    \   This is implied if the IRAS receives data from the IRAC over the\n   connection,\
    \ but in cases where no data is sent for some period of\n   time, a signaling\
    \ mechanism is required by which the IRAC indicates\n   that the connection remains\
    \ in use.\n"
- title: 3.1.5 Intermediary Traversal Requirements
  contents:
  - "3.1.5 Intermediary Traversal Requirements\n   If the address assigned by the\
    \ ISP to the IRAC system is globally\n   routable, and no intermediate devices\
    \ between the IRAC and the IRAS\n   perform NAPT operations on the data stream,\
    \ then there are no\n   additional requirements.  If NAPT operations are performed\
    \ on the\n   data stream, some mechanism must be provided in order to render these\n\
    \   modifications transparent to the IPsec implementation.\n"
- title: 3.2 Corporate to Remote Extranet
  contents:
  - "3.2 Corporate to Remote Extranet\n   Extranets are becoming increasingly common,\
    \ especially as IPsec\n   becomes more widely deployed.  In this scenario, a user\
    \ from one\n   corporation uses a local corporate system to access resources on\n\
    \   another corporation's network.  Typically, these corporations are\n   cooperating\
    \ on some level, but not to the degree that unbridled\n   access between the two\
    \ networks would be acceptable.  Hence, this\n   scenario is characterized by\
    \ limited access.  The general topological\n   appearance is similar to this:\n\
    \          CORP A                                CORP B\n             |      \
    \                                |\n    +----+   |                           \
    \           |  +-----+\n    |USER|---|                                      |--|\
    \ S1  |\n    +----+   |   +------++              ++------+   |  +-----+\n    \
    \         |---|SGW/FW||===Internet===||SGW/FW|---|\n             |   +------++\
    \              ++------+   |  +-----+\n             |     SGW-A              \
    \     SGW-B    |--| S2  |\n             |                                    \
    \  |  +-----+\n   This is purposely simplified in order to illustrate some basic\n\
    \   characteristics without getting bogged down in details.  At the edge\n   of\
    \ each network is a combination security gateway and firewall\n   device.  These\
    \ are labeled \"SGW-A\" and \"SGW-B\".  In this diagram,\n   corporation B wishes\
    \ to provide a user from corporation A with access\n   to servers S1 and/or S2.\
    \  This may be accomplished in one of several\n   different ways:\n   1) an end-to-end\
    \ SA is formed from USER to S1 or S2\n   2) a tunnel-mode SA is formed between\
    \ SGW-A and SGW-B which only\n      permits traffic between S1/S2 and USER.\n\
    \   3) a tunnel-mode SA is formed between USER and SGW-B which only\n      permits\
    \ traffic between S1/S2 and USER.\n   These various cases are individually discussed\
    \ with respect to each\n   requirements category below.\n"
- title: 3.2.1 Authentication Requirements
  contents:
  - "3.2.1 Authentication Requirements\n   For the corporate extranet scenario, the\
    \ authentication requirements\n   vary slightly depending upon the manner in which\
    \ the connection is\n   accomplished.  If only a particular user is permitted\
    \ to access\n   S1/S2, then user-level authentication is required.  If connection\n\
    \   types (1) or (3) are used, this may be accomplished in the same\n   manner\
    \ as it would be for a telecommuter.  If connection type (2) is\n   used, one\
    \ of two things must occur: either SGW-A must provide some\n   local mechanism\
    \ for authenticating USER and SGW-B must trust this\n   mechanism, or SGW-B must\
    \ have some mechanism for authenticating USER\n   independently of SGW-A.\n  \
    \ If access is permitted for anyone within corporation A, then machine\n   authentication\
    \ will suffice.  However, this is highly unlikely.  A\n   slightly more likely\
    \ situation might be one in which access is\n   permitted to anyone within a particular\
    \ organizational unit in\n   corporation A.  This case is very similar the single\
    \ user access case\n   discussed above, and essentially has the same requirements\
    \ in terms\n   of the mechanism required for SGW-A, although machine authentication\n\
    \   might suffice if the organizational unit which is permitted access\n   has\
    \ a sufficient level of physical security.  Again, this requires\n   that corporation\
    \ B trust corporation A in this regard.\n   To summarize, the following are the\
    \ authentication requirements for\n   the IRAS and IRAC:\n   IRAS\n   ----\n \
    \     o  machine authentication MUST be provided.\n   IRAC\n   ----\n      o \
    \ support for either user or machine authentication MUST be\n         provided\n\
    \      o  support for a combination of user and machine authentication\n     \
    \    SHOULD be provided\n      o  if user authentication is used, periodic renewal\
    \ SHOULD occur\n"
- title: 3.2.2 Device Configuration Requirements
  contents:
  - "3.2.2 Device Configuration Requirements\n   It is possible that corporation B\
    \ would want to assign a virtual\n   address to USER for the duration of the connection.\
    \  The only way\n   this could be accomplished would be if USER were a tunnel\
    \ endpoint\n   (e.g., in cases (1) and (3)).  It is not clear what benefits, if\
    \ any,\n   this would offer.\n   To summarize, the following are the device configuration\
    \ requirements\n   for the IRAC:\n      o  support for a virtual address MAY be\
    \ provided\n      o  if VIP support is provided, support for all device-related\n\
    \         parameters listed in section 2.2 above SHOULD be supported\n      o\
    \  support for address assignment based upon authenticated\n         identity\
    \ SHOULD be supported\n      o  if authenticated address assignment is not supported,\
    \ an\n         identity-based dynamic policy update mechanism such as is\n   \
    \      described in [ARCH] MUST be supported.\n"
- title: 3.2.3 Policy Configuration Requirements
  contents:
  - "3.2.3 Policy Configuration Requirements\n   Any of the cases discussed above\
    \ would present some static policy\n   configuration requirements.  Case (1) would\
    \ require that SGW-A and\n   SGW-B permit IPsec traffic to pass between USER and\
    \ S1/S2.  Case (3)\n   would have similar requirements, except that the IPsec\
    \ traffic would\n   be between USER and SGW-B.  Case (2) would require that the\n\
    \   appropriate transit traffic be secured between USER and S1/S2.\n   None of\
    \ these cases require dynamic policy configuration.\n"
- title: 3.2.4 Auditing Requirements
  contents:
  - "3.2.4 Auditing Requirements\n   For cases (1) and (3),  session start/end times\
    \ must be collected.\n   Reliable derivation of session end time requires that\
    \ the IRAC\n   somehow periodically signify that the connection remains active.\n\
    \   This is implied if the IRAS receives data from the IRAC over the\n   connection,\
    \ but in cases where no data is sent for some period of\n   time, a signaling\
    \ mechanism is required by which the IRAC indicates\n   that the connection remains\
    \ in use.\n   For case (2), the type(s) of required auditing data would depend\
    \ upon\n   whether traffic from multiple users were aggregated within a single\n\
    \   tunnel or not.  If so, the notion of individual connection start/stop\n  \
    \ times would be lost.  If such measures are desired, this requires\n   that per-user\
    \ tunnels be set up between SGW-A and SGW-B, and that\n   some sort of timeout\
    \ interval be used to cause tunnel teardown when\n   traffic does not flow for\
    \ some interval of time.\n"
- title: 3.2.5 Intermediary Traversal Requirements
  contents:
  - "3.2.5 Intermediary Traversal Requirements\n   If the address assigned by the\
    \ host network to the IRAC system is\n   globally routable, and no intermediate\
    \ devices between the IRAC and\n   the IRAS perform NAPT operations on the data\
    \ stream, then there are\n   no additional requirements in this regard.  If NAPT\
    \ operations are\n   performed on the data stream, some mechanism must be provided\
    \ in\n   order to render these modifications transparent to the IPsec\n   implementation.\n\
    \   If a firewall situated at the edge of the host network cannot be\n   configured\
    \ to pass protocols in the IPsec suite, then some mechanism\n   must be provided\
    \ which converts the data stream to one which the\n   firewall may be configured\
    \ to pass.  If the firewall can be\n   configured to pass IPsec protocols, then\
    \ this must be accomplished\n   prior to connection establishment.\n"
- title: 3.3 Extranet Laptop to Home Corporate Net
  contents:
  - "3.3 Extranet Laptop to Home Corporate Net\n   The use of a laptop while visiting\
    \ another corporation presents\n   another increasingly common extranet scenario.\
    \  In this case, a user\n   works temporarily within another corporation, perhaps\
    \ as part of a\n   service agreement of some sort.  The user brings along a CORP-A\n\
    \   laptop which is assigned a CORP-B address either statically or\n   dynamically,\
    \ and the user wishes to securely access resources on\n   CORP-A's network using\
    \ this laptop.  This scenario has the following\n   appearance:\n          CORP\
    \ A                                CORP B\n             |                    \
    \                  |\n    +----+   |                                      |  +--------+\n\
    \    |POP |---|                                      |--| CORP-A |\n    +----+\
    \   |   +------++              ++------+   |  | laptop |\n             |---|SGW/FW||===Internet===||SGW/FW|---|\
    \  +--------+\n             |   +------++              ++------+   |\n    +----+\
    \   |     SGW-A                   SGW-B    |\n    |FTP |---|                 \
    \                     |\n    +----+   |                                      |\n\
    \   This is very similar to the telecommuter scenario, but it differs in\n   several\
    \ important ways.  First, in this case there is often a SGW\n   and/or firewall\
    \ at the edge of CORP-B's site.  Second, there may be a\n   significantly increased\
    \ risk that a long-lived connection could\n   become accessible to someone other\
    \ than the intended user.\n"
- title: 3.3.1 Authentication Requirements
  contents:
  - "3.3.1 Authentication Requirements\n   In most cases, the only acceptable connections\
    \ from CORP-A's\n   perspective are between the laptop and either SGW-A or the\
    \ CORP-A\n   servers the laptop wishes to access.  Most of the considerations\n\
    \   applied to the telecommuter also apply here, and user-level\n   authentication\
    \ is required to provide assurance that the user who\n   initiated the connection\
    \ is still the active user.  As an added\n   precaution, a combination of user-level\
    \ and machine-level\n   authentication may be warranted in some cases.  Further,\
    \ in either\n   case this authentication should be renewed frequently.\n   To\
    \ summarize, the following are the authentication requirements for\n   the IRAS\
    \ and IRAC:\n   IRAS\n   ----\n      o  machine authentication MUST be provided.\n\
    \   IRAC\n   ----\n      o  support for machine authentication SHOULD be provided\n\
    \      o  support for user authentication MUST be provided\n      o  support for\
    \ a combination of user and machine authentication\n         SHOULD be provided\n\
    \      o  periodic renewal of user authentication MUST occur\n"
- title: 3.3.2 Device Configuration Requirements
  contents:
  - "3.3.2 Device Configuration Requirements\n   The device configuration requirements\
    \ in this scenario are the same\n   as for the telecommuter, i.e., the laptop\
    \ may be assigned a virtual\n   presence on the corporate network, and if so,\
    \ will require full\n   infrastructure configuration.\n   To summarize, the following\
    \ are the device configuration requirements\n   for the IRAC:\n      o  support\
    \ for a virtual address MAY be provided\n      o  if VIP support is provided,\
    \ support for all device-related\n         parameters listed in section 2.2 above\
    \ SHOULD be supported\n      o  support for address assignment based upon authenticated\n\
    \         identity SHOULD be supported\n      o  if authenticated address assignment\
    \ is not supported, an\n         identity-based dynamic policy update mechanism\
    \ such as is\n         described in [ARCH] MUST be supported.\n"
- title: 3.3.3 Policy Configuration Requirements
  contents:
  - "3.3.3 Policy Configuration Requirements\n   The policy configuration requirements\
    \ in this scenario differ from\n   those of the telecommuter, in that the laptop\
    \ cannot be assigned a\n   policy which requires all traffic to be forwarded to\
    \ CORP-A via the\n   tunnel.  This is due to the fact that the laptop has a CORP-B\n\
    \   address, and as such, may have traffic destined to CORP-B.  If this\n   traffic\
    \ were tunneled to CORP-A, there might be no return path to\n   CORP-B except\
    \ via the laptop.  On the other hand, Internet-bound\n   traffic could be subjected\
    \ to this restriction if desired, and/or all\n   traffic other than that between\
    \ CORP-A and the laptop could be\n   blocked for the duration of the connection.\n\
    \   IRAC\n   ----\n      o  support for IRAS update of IRAC policy MAY be provided.\n\
    \      o  if IRAS update of IRAC policy is not supported, IRAC MAY\n         support\
    \ IRAS directives to \"block-all\" for non-tunneled\n         traffic.\n     \
    \ o  IRAC SHOULD provide ability to configure for \"tunnel-all\"\n         and/or\
    \ \"block-all\" for traffic not destined for the remote\n         network to which\
    \ IPsec remote access is being provided.\n"
- title: 3.3.4 Auditing Requirements
  contents:
  - "3.3.4 Auditing Requirements\n   The auditing requirements in this scenario are\
    \ the same as for the\n   telecommuter scenario.  Session start/end times must\
    \ be collected.\n   Reliable derivation of session end time requires that the\
    \ IRAC\n   somehow periodically signify that the connection remains active.\n\
    \   This is implied if the IRAS receives data from the IRAC over the\n   connection,\
    \ but in cases where no data is sent for some period of\n   time, a signaling\
    \ mechanism is required by which the IRAC indicates\n   that the connection remains\
    \ in use.\n"
- title: 3.3.5 Intermediary Traversal Requirements
  contents:
  - "3.3.5 Intermediary Traversal Requirements\n   If the address assigned by the\
    \ host network to the IRAC system is\n   globally routable, and no intermediate\
    \ devices between the IRAC and\n   the IRAS perform NAPT operations on the data\
    \ stream, then there are\n   no additional requirements in this regard.  If NAPT\
    \ operations are\n   performed on the data stream, some mechanism must be provided\
    \ in\n   order to render these modifications transparent to the IPsec\n   implementation.\n\
    \   If a firewall situated at the edge of the host network cannot be\n   configured\
    \ to pass protocols in the IPsec suite, then some mechanism\n   must be provided\
    \ which converts the data stream to one which the\n   firewall may be configured\
    \ to pass.  If the firewall can be\n   configured to pass IPsec protocols, then\
    \ this must be accomplished\n   prior to connection establishment.\n"
- title: 3.4 Extranet Desktop to Home Corporate Net
  contents:
  - "3.4 Extranet Desktop to Home Corporate Net\n   This is very similar to the extranet\
    \ laptop scenario discussed above,\n   except that a higher degree of trust for\
    \ CORP-B is required by\n   CORP-A.  This scenario has the following appearance:\n\
    \           CORP A                                CORP B\n             |     \
    \                                 |\n    +----+   |                          \
    \            |  +--------+\n    |POP |---|                                   \
    \   |--| CORP-B |\n    +----+   |   +------++              ++------+   |  |desktop\
    \ |\n             |---|SGW/FW||===Internet===||SGW/FW|---|  +--------+\n     \
    \        |   +------++              ++------+   |\n    +----+   |     SGW-A  \
    \                 SGW-B    |\n    |FTP |---|                                 \
    \     |\n    +----+   |                                      |\n"
- title: 3.4.1 Authentication Requirements
  contents:
  - "3.4.1 Authentication Requirements\n   The authentication requirements for the\
    \ desktop extranet scenario are\n   very similar to those of the extranet laptop\
    \ scenario discussed\n   above.  The primary difference lies in the authentication\
    \ type which\n   may be used, i.e., in the laptop case, CORP-A can derive some\n\
    \   assurance that the connection is coming from one of CORP-A's systems\n   if\
    \ a securely stored machine credential is stored on and used by on\n   the laptop.\
    \  In the desktop case this is not possible, since CORP-A\n   does not own the\
    \ IRAC system.\n   To summarize, the following are the authentication requirements\
    \ for\n   the IRAS and IRAC:\n   IRAS\n   ----\n     o machine authentication\
    \ MUST be provided.\n   IRAC\n   ----\n      o  support for machine authentication\
    \ MAY be provided\n      o  support for user authentication MUST be provided\n\
    \      o  support for a combination of user and machine authentication\n     \
    \    MAY be provided\n      o  periodic renewal of user authentication MUST occur\n"
- title: 3.4.2 Device Configuration Requirements
  contents:
  - "3.4.2 Device Configuration Requirements\n   The device configuration requirements\
    \ in this scenario are the same\n   as for the laptop extranet scenario, i.e.,\
    \ the desktop system may be\n   assigned a virtual presence on the corporate network,\
    \ and if so, will\n   require full infrastructure configuration.  However, this\
    \ seems less\n   likely than in the laptop scenario, given CORP-A's lack of control\n\
    \   over the software configuration of CORP-B's desktop system.\n"
- title: 3.4.3 Policy Configuration Requirements
  contents:
  - "3.4.3 Policy Configuration Requirements\n   The policy configuration requirements\
    \ are quite similar to those of\n   the extranet laptop, except that in this scenario\
    \ there is even less\n   control over CORP-B's desktop than there would be over\
    \ the laptop.\n   This means it may not be possible to restrict traffic in any\
    \ way at\n   the desktop system.\n"
- title: 3.4.4 Auditing Requirements
  contents:
  - "3.4.4 Auditing Requirements\n   The auditing requirements in this scenario are\
    \ the same as for the\n   telecommuter scenario.  Session start/end times must\
    \ be collected.\n   Reliable derivation of session end time requires that the\
    \ IRAC\n   somehow periodically signify that the connection remains active.\n\
    \   This is implied if the IRAS receives data from the IRAC over the\n   connection,\
    \ but in cases where no data is sent for some period of\n   time, a signaling\
    \ mechanism is required by which the IRAC indicates\n   that the connection remains\
    \ in use.\n"
- title: 3.4.5 Intermediary Traversal Requirements
  contents:
  - "3.4.5 Intermediary Traversal Requirements\n   If the address assigned by the\
    \ host network to the IRAC system is\n   globally routable, and no intermediate\
    \ devices between the IRAC and\n   the IRAS perform NAPT operations on the data\
    \ stream, then there are\n   no additional requirements in this regard.  If NAPT\
    \ operations are\n   performed on the data stream, some mechanism must be provided\
    \ in\n   order to render these modifications transparent to the IPsec\n   implementation.\n\
    \   If a firewall situated at the edge of the host network cannot be\n   configured\
    \ to pass protocols in the IPsec suite, then some mechanism\n   must be provided\
    \ which converts the data stream to one which the\n   firewall may be configured\
    \ to pass.  If the firewall can be\n   configured to pass IPsec protocols, then\
    \ this must be accomplished\n   prior to connection establishment.\n"
- title: 3.5 Public System to Target Network
  contents:
  - "3.5 Public System to Target Network\n   This scenario entails a traveling user\
    \ connecting to the target\n   network using a public system owned by someone\
    \ else.  A commonly\n   cited example is an airport kiosk.  This looks very similar\
    \ to the\n   extranet desktop scenario, except that in the extranet scenario,\n\
    \   CORP-A might have a trust relationship with CORP-B, whereas in this\n   scenario,\
    \ CORP-A may not trust a publicly accessible system.  Note\n   that a trust relationship\
    \ between CORP-A and the owner of the public\n   system may exist, but in many\
    \ cases will not.\n"
- title: 3.5.1 Authentication Requirements
  contents:
  - "3.5.1 Authentication Requirements\n   There are two variations to this scenario.\
    \  In the first, no trust\n   relationship exists between the target network and\
    \ the borrowed\n   system.  In the second, some trust relationship does exist.\
    \  In the\n   case where no trust relationship exists, machine authentication\
    \ is\n   out of the question, as it is meaningless in this context.  Further,\n\
    \   since such a system could easily capture a passphrase, use of a\n   static\
    \ passphrase from such a system would seem to be ill-advised.\n   If a one-time\
    \ passphrase were used, this would mitigate the risk of\n   passphrase capture\
    \ by the public system.  On the other hand, if it is\n   acknowledged that such\
    \ capture is a real threat (i.e., the system\n   itself is malicious), then it\
    \ must also be recognized that any data\n   transmitted and received via the resulting\
    \ session would not be\n   confidential or reliable with respect to this malicious\
    \ system, and\n   that the system could not be trusted to have actually disconnected\n\
    \   when the user walks away.  This suggests that accessing non-trivial\n   information\
    \ from such a system would be imprudent.\n   Another possible user authentication\
    \ option would be a smartcard.\n   However, many smartcards require a pin or passphrase\
    \ to \"unlock\"\n   them, which requires some level of trust in the kiosk to not\
    \ record\n   the pin.  Hence, this approach suffers from drawbacks similar to\n\
    \   those of the static passphrase in this regard.  The primary\n   difference\
    \ would be that the pin/passphrase could not be used alone\n   for access in the\
    \ smartcard case.\n   In cases where a trust relationship with the owner of the\
    \ public\n   system exists, the trust level would modulate the risk levels\n \
    \  discussed above.  For example, if a sufficient level of trust for the\n   system\
    \ owner exists, use of a static passphrase might present no more\n   risk than\
    \ if this were permitted from a system owned by the accessed\n   target.  However,\
    \ the primary benefit of such a trust relationship\n   would be derived from the\
    \ ability to authenticate the machine from\n   which the user is attempting access.\
    \  For example, a security policy\n   requiring that remote access only be permitted\
    \ with combined\n   user/machine authentication might be effected, with further\
    \ control\n   regarding which machines were allowed.\n   An additional issue to\
    \ be dealt with in either case pertains to\n   verification of the identity of\
    \ the IRAS.  If the IRAC were to be\n   misdirected somehow, a man in the middle\
    \ attack could be effected,\n   with the obtained password being then used for\
    \ malicious access to\n   the true IRAS.  Note that even a one-time password mechanism\
    \ offers\n   little protection in this case.  In order to avert such an attack,\n\
    \   the IRAC must possess some certifiable or secret knowledge of the\n   IRAS\
    \ prior to attempting to connect.  Note that in the case where no\n   trust relationship\
    \ exists, this is not possible.\n   To summarize, the following are the authentication\
    \ requirements for\n   the IRAS and IRAC:\n   IRAS\n   ----\n      o  machine\
    \ authentication MUST be provided.\n   IRAC\n   ----\n      o  in cases where\
    \ no trust relationship exists between the\n         accessed network and the\
    \ system owner, sensitive data SHOULD\n         NOT be transmitted in either direction.\n\
    \      o  in cases where a trust relationship exists between the accessed\n  \
    \       network and the system owner, machine authentication SHOULD be\n     \
    \    supported.\n      o  in cases where a trust relationship exists between the\
    \ accessed\n         network and the system owner, a static passphrase MAY be\
    \ used\n         in conjunction with machine-level authentication of the IRAC\n\
    \         system.\n      o  frequent renewal of user authentication MUST occur\n"
- title: 3.5.2 Device Configuration Requirements
  contents:
  - "3.5.2 Device Configuration Requirements\n   None.\n"
- title: 3.5.3 Policy  Configuration Requirements
  contents:
  - "3.5.3 Policy  Configuration Requirements\n   None.\n"
- title: 3.5.4 Auditing Requirements
  contents:
  - "3.5.4 Auditing Requirements\n   The auditing requirements in this scenario are\
    \ the same as for the\n   telecommuter scenario.  Session start/end times must\
    \ be collected.\n   Reliable derivation of session end time requires that the\
    \ IRAC\n   somehow periodically signify that the connection remains active.\n\
    \   This is implied if the IRAS receives data from the IRAC over the\n   connection,\
    \ but in cases where no data is sent for some period of\n   time, a signaling\
    \ mechanism is required by which the IRAC indicates\n   that the connection remains\
    \ in use.\n"
- title: 3.5.5 Intermediary Traversal Requirements
  contents:
  - "3.5.5 Intermediary Traversal Requirements\n   If the address of the IRAC system\
    \ is globally routable, and no\n   intermediate devices between the IRAC and the\
    \ IRAS perform NAPT\n   operations on the data stream, then there are no additional\n\
    \   requirements in this regard.  If NAPT operations are performed on the\n  \
    \ data stream, some mechanism must be provided in order to render these\n   modifications\
    \ transparent to the IPsec implementation.\n"
- title: 4. Scenario Commonalities
  contents:
  - "4. Scenario Commonalities\n   As we examine the various remote access scenarios,\
    \ a general set of\n   common requirements emerge.  Following is a summary:\n\
    \   o  Support for user authentication is required in almost all\n      scenarios\n\
    \   o  Machine authentication for the IRAS is required in all scenarios\n   o\
    \  A mechanism for providing device configuration for the IRAC is\n      required\
    \ in most scenarios.  Such a mechanism must be extensible.\n   o  Machine authentication\
    \ for IRAC is generally only useful when\n      combined with user authentication.\
    \  Combined user and machine\n      authentication is useful in some scenarios.\n\
    \   o  Dynamic IRAC policy configuration is useful in several scenarios.\n   o\
    \  Most scenarios require auditing for session start/stop times.\n   o  An intermediary\
    \ traversal mechanism may be required in any of the\n      scenarios.\n"
- title: 5. Security Considerations
  contents:
  - "5. Security Considerations\n   The topic of this document is secure remote access.\
    \  Security\n   considerations are discussed throughout the document.\n"
- title: 6. References
  contents:
  - "6. References\n   [ARCH]      Kent, S. and R. Atkinson, \"Security Architecture\
    \ for the\n               Internet Protocol\", RFC 2401, November 1998.\n   [KEYWORDS]\
    \  Bradner, S., \"Key Words for use in RFCs to Indicate\n               Requirement\
    \ Levels\", BCP 14, RFC 2119, March 1997.\n   [RADIUS]    Rigney, C., Rubens,\
    \ A., Simpson, W. and S. Willens,\n               \"Remote Authentication Dial\
    \ In User Service (RADIUS)\",\n               RFC 2865, June 2000.\n   [IKE] \
    \      Harkins, D. and D. Carrel, \"The Internet Key Exchange\n              \
    \ (IKE)\", RFC 2409, November 1998.\n"
- title: 7. Acknowledgements
  contents:
  - "7. Acknowledgements\n   The editors would like to acknowledge the many helpful\
    \ comments of\n   Sara Bitan, Steve Kent, Mark Townsley, Bernard Aboba, Mike Horn,\
    \ and\n   other members of the ipsra working group who have made helpful\n   comments\
    \ on this work.\n"
- title: 8. Editors' Addresses
  contents:
  - "8. Editors' Addresses\n   Scott Kelly\n   Airespace\n   110 Nortech Pkwy\n  \
    \ San Jose CA 95134 USA\n   Phone: +1 (408) 941-0500\n   EMail: scott@hyperthought.com\n\
    \   Sankar Ramamoorthi\n   Juniper Networks\n   1194 North Mathilda Ave\n   Sunnyvale\
    \ CA 94089-1206 USA\n   Phone: +1 (408) 936-2630\n   EMail: sankarr@juniper.net\n"
- title: 9. Full Copyright Statement
  contents:
  - "9. Full Copyright Statement\n   Copyright (C) The Internet Society (2003).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
