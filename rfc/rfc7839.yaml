- contents:
  - '                Access-Network-Identifier Option in DHCP

    '
  title: __initial_text__
- contents:
  - "Abstract\n   This document specifies the format and mechanism that is to be used\n
    \  for encoding Access-Network Identifiers in DHCPv4 and DHCPv6 messages\n   by
    defining new Access-Network-Identifier options and sub-options.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    7841.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc7839.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2016 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .
    . . . . .   3\n   2.  Motivation  . . . . . . . . . . . . . . . . . . . . . .
    . . .   3\n   3.  Terminology . . . . . . . . . . . . . . . . . . . . . . . .
    .   4\n   4.  DHCPv4 Access-Network-Identifier Option . . . . . . . . . . .   5\n
    \    4.1.  DHCPv4 Access-Network-Identifier Sub-options  . . . . . .   5\n     4.2.
    \ DHCPv4 Access-Technology-Type Sub-option  . . . . . . . .   6\n     4.3.  DHCPv4
    Network-Identifier Sub-options . . . . . . . . . .   7\n       4.3.1.  DHCPv4
    Network-Name Sub-option  . . . . . . . . . . .   7\n       4.3.2.  DHCPv4 Access-Point-Name
    Sub-option . . . . . . . . .   8\n       4.3.3.  DHCPv4 Access-Point-BSSID Sub-option
    \ . . . . . . . .   9\n     4.4.  DHCPv4 Operator-Identifier Sub-options  . .
    . . . . . . .   9\n       4.4.1.  DHCPv4 Operator-Identifier Sub-option . . .
    . . . . .   9\n       4.4.2.  DHCPv4 Operator-Realm Sub-option  . . . . . . .
    . . .  10\n   5.  DHCPv6 Access-Network-Identifier Options  . . . . . . . . .
    .  10\n     5.1.  DHCPv6 Access-Technology-Type Option  . . . . . . . . . .  11\n
    \    5.2.  DHCPv6 Network-Identifier Options . . . . . . . . . . . .  11\n       5.2.1.
    \ DHCPv6 Network-Name Option  . . . . . . . . . . . . .  12\n       5.2.2.  DHCPv6
    Access-Point-Name Option . . . . . . . . . . .  12\n       5.2.3.  DHCPv6 Access-Point-BSSID
    Option  . . . . . . . . . .  13\n     5.3.  DHCPv6 Operator-Identifier Options
    \ . . . . . . . . . . .  13\n       5.3.1.  DHCPv6 Operator-Identifier Option
    . . . . . . . . . .  13\n       5.3.2.  DHCPv6 Operator-Realm Option  . . . .
    . . . . . . . .  14\n   6.  Relay Agent Behavior  . . . . . . . . . . . . . .
    . . . . . .  14\n   7.  Server Behavior . . . . . . . . . . . . . . . . . . .
    . . . .  15\n   8.  IANA Considerations . . . . . . . . . . . . . . . . . . .
    . .  16\n   9.  Security Considerations . . . . . . . . . . . . . . . . . . .
    \ 17\n   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  18\n
    \    10.1.  Normative References . . . . . . . . . . . . . . . . . .  18\n     10.2.
    \ Informative References . . . . . . . . . . . . . . . . .  18\n   Acknowledgements
    \ . . . . . . . . . . . . . . . . . . . . . . . .  19\n   Authors' Addresses  .
    . . . . . . . . . . . . . . . . . . . . . .  20\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   Access-network identification of a network device has a
    range of\n   applications.  For example, the Local Mobility Anchor (LMA) in a\n
    \  Proxy Mobile IPv6 (PMIPv6) domain is able to provide service\n   treatment
    for the mobile node's traffic based on the access network\n   to which the mobile
    node is attached.\n   This document specifies the Dynamic Host Configuration Protocol
    for\n   IPv4 (DHCPv4) [RFC2131] and the Dynamic Host Configuration Protocol\n
    \  for IPv6 (DHCPv6) [RFC3315] options for access-network identification\n   that
    is added by the relay agent in the DHCPv4 or DHCPv6 messages\n   sent towards
    the server.  The scope of applicability for this option\n   is between a DHCP
    relay agent and a mobile access gateway where the\n   same operator typically
    operates both these functions\n   A DHCP relay agent that is aware of the access
    network and access\n   operator adds this information in the DHCP messages.  This\n
    \  information can be used to provide differentiated services and\n   policing
    of traffic based on the access network to which a client is\n   attached.  Examples
    of how this information can be used in mobile\n   networks can be found in [RFC6757].\n"
  title: 1.  Introduction
- contents:
  - "2.  Motivation\n   PMIPv6 [RFC5213] can be used for supporting network-based
    mobility\n   management in various types of network deployments.  The network\n
    \  architectures, such as service provider Wi-Fi access aggregation or\n   WLAN
    integrated mobile packet core, are examples where PMIPv6 is a\n   component of
    the overall architecture.  Some of these architectures\n   require the ability
    of the LMA [RFC5213] to provide differentiated\n   services and policing of traffic
    to the mobile nodes based on the\n   access network to which they are attached.
    \ Policy systems in\n   mobility architectures, such as Policy and Charging Control
    (PCC)\n   [TS23203] and Access Network Discovery and Selection Function (ANDSF)\n
    \  [TS23402] in the 3GPP system, allow configuration of policy rules\n   with
    conditions based on the access-network information.  For\n   example, the service
    treatment for the mobile node's traffic may be\n   different when they are attached
    to an access network owned by the\n   home operator than when owned by a roaming
    partner.  In the case of\n   access networks based on IEEE 802.11, the service
    treatment can also\n   be different based on the configured Service Set Identifiers
    (SSIDs).\n   Other examples of services include the operator's ability to apply\n
    \  tariff based on the location.\n   The PMIPv6 extension as specified in [RFC6757]
    defines PMIPv6 options\n   to carry Access-Network Identifiers in PMIPv6 signaling
    from the\n   Mobile Access Gateway (MAG) to the LMA.  The MAG can learn this\n
    \  information from the DHCP options as inserted by the DHCP relay agent\n   in
    the access network.  If the MAG relays the DHCP messages to the\n   LMA as specified
    in [RFC5844], this information can be inserted by\n   the MAG towards the LMA
    in the forwarded DHCP messages.\n   Figure 1 illustrates an example of PMIPv6
    deployment.  In this\n   example, the access network is based on IEEE 802.11 technology,
    the\n   DHCP relay agent function is located on the Access Point (AP), and\n   the
    DHCP server function is located on the MAG.  The MAG delivers the\n   information
    elements related to the access network to the LMA over\n   PMIPv6 signaling messages.
    \ The MAG obtains these information\n   elements from the DHCP relay agent as
    per this specification.  The\n   information elements related to the access network
    include the SSID\n   of the used IEEE 802.11 network, the geo-location of the
    access\n   network to which the mobile node is attached, and the identity of the\n
    \  operator running the IEEE 802.11 access-network infrastructure.\n          SSID:
    IETF-1\n          Operator-Identifier: provider1.example\n          +--+\n          |AP|-----------.
    \                   {Access-Specific Policies)\n          +--+           | (DHCP
    Server)   _-----_             |\n          (DHCP Relay) +-----+           _(       )_
    \       +-----+\n                       | MAG |-=========(   PMIPv6  )======-|
    LMA |-\n                       +-----+           (_ Tunnel_)        +-----+\n
    \         +--+           |                 '-----'\n          |AP|-----------'\n
    \         +--+\n          (DHCP Relay)\n          SSID: IETF-2\n          Operator-Identifier:
    provider2.example\n                      Access Networks Attached to MAG\n"
  title: 2.  Motivation
- contents:
  - "3.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\",
    \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\"
    in this\n   document are to be interpreted as described in [RFC2119].\n   All
    the DHCP-related terms used in this document are to be\n   interpreted as defined
    in DHCPv4 [RFC2131] and DHCPv6 [RFC3315]\n   specifications.  \"DHCP message\"
    refers to both DHCPv4 and DHCPv6\n   messages throughout this document.\n   All
    the mobility-related terms used in this document are to be\n   interpreted as
    defined in the PMIPv6 specifications [RFC5213] and\n   [RFC5844].  Additionally,
    this document uses the following\n   abbreviations:\n   Service Set Identifier
    (SSID)\n      The Service Set Identifier (SSID) identifies the name of the IEEE\n
    \     802.11 network.  The SSID differentiates from one network to the\n      other.\n
    \  Operator-Identifier\n      The Operator-Identifier is the Structure of Management
    Information\n      (SMI) Network Management Private Enterprise Code of the IANA-\n
    \     maintained \"Private Enterprise Numbers\" registry [SMI].  It\n      identifies
    the operator running the access network where the\n      client is attached.\n"
  title: 3.  Terminology
- contents:
  - "4.  DHCPv4 Access-Network-Identifier Option\n   The Access-Network Identifier
    (ANI) carries information related to\n   the identity of the access network to
    which the client is attached.\n   This information includes access-technology
    type, network identifier,\n   and access network operator identifiers.\n   Relay
    agents that include ANI information include one or more sub-\n   options (see
    Section 4.1) in the Relay Agent Information option\n   [RFC3046].\n"
  - contents:
    - "4.1.  DHCPv4 Access-Network-Identifier Sub-options\n   The Access-Network-Identifier
      information will be defined in multiple\n   sub-options allocated from the \"DHCP
      Relay Agent Sub-Option Codes\"\n   registry.\n   ANI Sub-options: The ANI sub-options
      consist of a sequence of Sub-\n   Option Code, Length, and Value tuples for
      each sub-option, encoded in\n   the following manner:\n       Subopt  Len     Sub-option
      Data\n      +------+------+------+------+------+------+--...-+------+\n      |
      code |   N  |  s1  |  s2  |  s3  |  s4  |      |  sN  |\n      +------+------+------+------+------+------+--...-+------+\n
      \  Subopt code\n      The 1-octet code for the sub-options defined in the following\n
      \     sections.\n   Len\n      An unsigned 8-bit integer giving the length of
      the Sub-option Data\n      field in this sub-option in octets.\n   Sub-option
      Data (s1 to sN)\n      The data area for the sub-option.\n   The initial assignment
      of the DHCP Access-Network-Identifier sub-\n   options is as follows:\n      +=================+=======================================+\n
      \     | SUB-OPTION CODE |      SUB-OPTION DESCRIPTION           |\n      +=================+=======================================+\n
      \     |       13        | Access-Technology-Type Sub-option     |\n      +=========================================================+\n
      \     |       14        | Access-Network-Name Sub-option        |\n      +=========================================================+\n
      \     |       15        | Access-Point-Name Sub-option          |\n      +=========================================================+\n
      \     |       16        | Access-Point-BSSID Sub-option         |\n      +=========================================================+\n
      \     |       17        | Operator-Identifier Sub-option        |\n      +=========================================================+\n
      \     |       18        | Operator-Realm Sub-option             |\n      +=========================================================+\n"
    title: 4.1.  DHCPv4 Access-Network-Identifier Sub-options
  - contents:
    - "4.2.  DHCPv4 Access-Technology-Type Sub-option\n   This sub-option is used
      for exchanging the type of the access\n   technology of the network to which
      the client is attached.  Its\n   format is as follows:\n       0                   1
      \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3
      4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \     |  Subopt Code  |     Length    |   Reserved    |      ATT      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  Subopt Code\n      13\n   Length\n      2\n   Reserved\n      An 8-bit field
      that is unused for now.  The value MUST be\n      initialized to 0 by the sender
      and MUST be ignored by the\n      receiver.\n   Access-Technology-Type (ATT)\n
      \     An 8-bit field that specifies the access technology through which\n      the
      client is connected to the access link from the IANA name\n      space \"Access
      Technology Type Option type values\" registry defined\n      in [RFC5213].\n"
    title: 4.2.  DHCPv4 Access-Technology-Type Sub-option
  - contents:
    - "4.3.  DHCPv4 Network-Identifier Sub-options\n   These sub-options are used
      for carrying the name of the access\n   network (e.g., an SSID in the case of
      an IEEE 802.11 access network\n   or a Public Land-based Mobile Network (PLMN)
      Identifier [TS23003] in\n   the case of a 3GPP access network) and the Access-Point
      Name to which\n   the client is attached.  The format of these sub-options is
      defined\n   in the following sections.  The Network-Identifier sub-options are\n
      \  only for the currently known access-technology types.\n"
    - contents:
      - "4.3.1.  DHCPv4 Network-Name Sub-option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |  Subopt Code  |     Length    |                               |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n
        \     .                                                               .\n
        \     .                     Network-Name (e.g., SSID or PLMNID)       .\n
        \     .                                                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Subopt Code\n      14\n   Length\n      The length of the Network-Name
        field.\n   Network-Name\n      The name of the access network to which the
        mobile node is\n      attached.  The encoding MUST be UTF-8 as described in
        [RFC3629].\n      The type of the Network-Name is dependent on the access
        technology\n      to which the mobile node is attached.  For networks based
        on IEEE\n      802.11, the Network-Name will be the SSID of the network.  For\n
        \     3GPP access-based networks, it is the PLMN Identifier of the\n      access
        network, and for 3GPP2 access, the Network-Name is the ANI\n      [ANI].\n
        \     When encoding the PLMN Identifier, both the Mobile Network Code\n      (MNC)
        [TS23003] and Mobile Country Code (MCC) [TS23003] MUST be\n      three digits.
        \ If the MNC in use only has two digits, then it MUST\n      be preceded with
        a '0'.\n"
      title: 4.3.1.  DHCPv4 Network-Name Sub-option
    - contents:
      - "4.3.2.  DHCPv4 Access-Point-Name Sub-option\n       0                   1
        \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |  Subopt Code  |     Length    |                               |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n
        \     .                                                               .\n
        \     .                        Access-Point-Name                      .\n
        \     .                                                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Subopt Code\n      15\n   Length\n      The length of the Access-Point-Name
        field.\n   Access-Point-Name\n      The name of the access point (physical
        device name) to which the\n      mobile node is attached.  This is the identifier
        that uniquely\n      identifies the access point.  While the Network-Name
        (e.g., SSID)\n      identifies the operator's access network, the Access-Point-Name\n
        \     identifies a specific network device in the network to which the\n      mobile
        node is attached.  In some deployments, the Access-Point-\n      Name can
        be set to the string representation of the Media Access\n      Control (MAC)
        address of the device as specified in [RFC6991] (see\n      mac-address typedef)
        or some unique identifier that can be used by\n      the policy systems in
        the operator network to unambiguously\n      identify the device.  The encoding
        MUST be UTF-8 as described in\n      [RFC3629].\n"
      title: 4.3.2.  DHCPv4 Access-Point-Name Sub-option
    - contents:
      - "4.3.3.  DHCPv4 Access-Point-BSSID Sub-option\n       0                   1
        \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |  Subopt Code  |     Length    |                               |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n
        \     |                        Access-Point-BSSID                     |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Subopt Code\n      16\n   Length\n      6\n   Access-Point-BSSID\n      The
        48-bit Basic SSSID (BSSID) of the access point to which the\n      mobile
        node is attached.\n"
      title: 4.3.3.  DHCPv4 Access-Point-BSSID Sub-option
    title: 4.3.  DHCPv4 Network-Identifier Sub-options
  - contents:
    - "4.4.  DHCPv4 Operator-Identifier Sub-options\n   The Operator-Identifier sub-options
      can be used for carrying the\n   Operator-Identifiers of the access network
      to which the client is\n   attached.  The format of these sub-options is defined
      below.\n"
    - contents:
      - "4.4.1.  DHCPv4 Operator-Identifier Sub-option\n       0                   1
        \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |  Subopt Code  |     Length    |                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     .      Operator-Identifier      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Subopt Code\n      17\n   Length\n      4\n   Operator-Identifier\n      The
        Operator-Identifier is a variable-length Private Enterprise\n      Number
        (PEN) [SMI] encoded in a network byte order.  Please refer\n      to Section
        3.1.3 of [RFC6757] for additional details.\n"
      title: 4.4.1.  DHCPv4 Operator-Identifier Sub-option
    - contents:
      - "4.4.2.  DHCPv4 Operator-Realm Sub-option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |  Subopt Code  |     Length    |                               |\n
        \     |-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |\n
        \     .                                                               .\n
        \     .                        Operator-Realm                         .\n
        \     .                                                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Subopt Code\n      18\n   Length\n      The length of the Operator-Realm
        field.\n   Operator-Realm\n      Realm of the operator (e.g., EXAMPLE.COM).
        \ Please refer to\n      Section 3.1.3 of [RFC6757] for additional details.\n"
      title: 4.4.2.  DHCPv4 Operator-Realm Sub-option
    title: 4.4.  DHCPv4 Operator-Identifier Sub-options
  title: 4.  DHCPv4 Access-Network-Identifier Option
- contents:
  - "5.  DHCPv6 Access-Network-Identifier Options\n   The Access-Network-Identifier
    options defined here may be added by\n   the DHCPv6 relay agent in Relay-forward
    messages.\n      +=================+=======================================+\n
    \     |    OPTION CODE  |      OPTION DESCRIPTION               |\n      +=================+=======================================+\n
    \     |       105       | OPTION_ANI_ATT                        |\n      +=========================================================+\n
    \     |       106       | OPTION_ANI_NETWORK_NAME               |\n      +=========================================================+\n
    \     |       107       | OPTION_ANI_AP_NAME                    |\n      +=========================================================+\n
    \     |       108       | OPTION_ANI_AP_BSSID                   |\n      +=========================================================+\n
    \     |       109       | OPTION_ANI_OPERATOR_ID                |\n      +=========================================================+\n
    \     |       110       | OPTION_ANI_OPERATOR_REALM             |\n      +=========================================================+\n"
  - contents:
    - "5.1.  DHCPv6 Access-Technology-Type Option\n   This option is used for exchanging
      the type of access technology the\n   client uses to attach to the network.
      \ Its format is as follows:\n        0                   1                   2
      \                  3\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
      3 4 5 6 7 8 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \      |         OPTION_ANI_ATT        |           Option-Len          |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \      |   Reserved    |       ATT     |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  Option-Code\n      OPTION_ANI_ATT (105)\n   Option-Len\n      2\n   Reserved\n
      \     An 8-bit field that is unused for now.  The value MUST be\n      initialized
      to 0 by the sender and MUST be ignored by the\n      receiver.\n   Access-Technology-Type
      (ATT):\n      The contents of this field are the same as the ATT field described\n
      \     in Section 4.2.\n"
    title: 5.1.  DHCPv6 Access-Technology-Type Option
  - contents:
    - "5.2.  DHCPv6 Network-Identifier Options\n   These options can be used for carrying
      the name of the access network\n   (e.g., an SSID in the case of an IEEE 802.11
      access network or a PLMN\n   Identifier [TS23003] in the case of a 3GPP access
      network) and an\n   Access-Point Name to which the client is attached.  The
      format of\n   these options is defined below.\n"
    - contents:
      - "5.2.1.  DHCPv6 Network-Name Option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |    OPTION_ANI_NETWORK_NAME    |           Option-Len          |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     .                                                               .\n
        \     .                     Network-Name (e.g., SSID or PLMNID)       .\n
        \     .                                                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Option-Code\n      OPTION_ANI_NETWORK_NAME (106)\n   Option-Len\n      The
        length of the Network-Name field.\n   Network-Name\n      The contents of
        this field are the same as the Network-Name field\n      described in Section
        4.3.1.\n"
      title: 5.2.1.  DHCPv6 Network-Name Option
    - contents:
      - "5.2.2.  DHCPv6 Access-Point-Name Option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |       OPTION_ANI_AP_NAME      |           Option-Len          |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     .                                                               .\n
        \     .                        Access-Point-Name                      .\n
        \     .                                                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Option-Code\n      OPTION_ANI_AP_NAME (107)\n   Option-Len\n      The length
        of the Access-Point-Name field.\n   Access-Point-Name\n      The contents
        of this field are the same as the Access-Point-Name\n      field described
        in Section 4.3.2.\n"
      title: 5.2.2.  DHCPv6 Access-Point-Name Option
    - contents:
      - "5.2.3.  DHCPv6 Access-Point-BSSID Option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |       OPTION_ANI_AP_BSSID     |           Option-Len          |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |                        Access-Point-BSSID                     |\n
        \     +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Option-Code\n      OPTION_ANI_AP_BSSID (108)\n   Option-Len\n      6\n
        \  Access-Point-BSSID\n      The contents of this field are the same as the
        Access-Point-BSSID\n      field described in Section 4.3.3.\n"
      title: 5.2.3.  DHCPv6 Access-Point-BSSID Option
    title: 5.2.  DHCPv6 Network-Identifier Options
  - contents:
    - "5.3.  DHCPv6 Operator-Identifier Options\n   The Operator-Identifier options
      can be used for carrying the\n   Operator-Identifier of the access network to
      which the client is\n   attached.  The format of these options is defined below.\n"
    - contents:
      - "5.3.1.  DHCPv6 Operator-Identifier Option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |     OPTION_ANI_OPERATOR_ID    |           Option-Len          |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |                      Operator-Identifier                      |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Option-Code\n      OPTION_ANI_OPERATOR_ID (109)\n   Option-Len\n      4\n
        \  Operator-Identifier\n      The contents of this field are the same as the
        DHCPv4 Operator-\n      Identifier Sub-option field described in Section 4.4.1.\n"
      title: 5.3.1.  DHCPv6 Operator-Identifier Option
    - contents:
      - "5.3.2.  DHCPv6 Operator-Realm Option\n       0                   1                   2
        \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     |   OPTION_ANI_OPERATOR_REALM   |           Option-Len          |\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     .                                                               .\n
        \     .                        Operator-Realm                         .\n
        \     .                                                               .\n
        \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  Option-Code\n      OPTION_ANI_OPERATOR_REALM (110)\n   Option-Len\n      The
        length of the Operator-Realm field.\n   Operator-Realm\n      The contents
        of this field are the same as the Operator-Realm\n      field described in
        Section 4.4.2.\n"
      title: 5.3.2.  DHCPv6 Operator-Realm Option
    title: 5.3.  DHCPv6 Operator-Identifier Options
  title: 5.  DHCPv6 Access-Network-Identifier Options
- contents:
  - "6.  Relay Agent Behavior\n   DHCPv4 relay agents MAY include sub-options as defined
    in Section 4.2\n   through 4.4 of [RFC3046] in the Relay Agent Information option
    for\n   providing information about the access network over which DHCP\n   messages
    from the client are received.\n   The DHCPv4 relay agent MUST include the DHCPv4
    Access-Technology-Type\n   Sub-option (Section 4.2) when including any of these
    sub-options in\n   the DHCP message: DHCPv4 Network-Name Sub-option (Section 4.3.1),\n
    \  DHCPv4 Access-Point-Name Sub-option (Section 4.3.2), and DHCPv4\n   Access-Point-BSSID
    Sub-option (Section 4.3.3).\n   DHCPv6 Relay Agents MAY include options (defined
    in Section 5) in the\n   Relay-forward message when forwarding any DHCPv6 message
    type from\n   clients to the servers to provide information about the access\n
    \  network over which DHCPv6 messages from the client are received.\n   The DHCPv6
    relay agent MUST include the DHCPv6 Access-Technology-Type\n   Option (Section
    5.1) when including any of these options in the DHCP\n   message: DHCPv6 Network-Name
    Option (Section 5.2.1), DHCPv6 Access-\n   Point-Name Option (Section 5.2.2),
    and DHCPv6 Access-Point-BSSID\n   Option (Section 5.2.3).\n"
  title: 6.  Relay Agent Behavior
- contents:
  - "7.  Server Behavior\n   The DHCPv4 base specification [RFC2131] requires that
    the DHCPv4\n   server ignore the DHCPv4 Access-Network-Identifier Option if it
    does\n   not understand the option.\n   If the DHCPv4 server does not understand
    the received sub-option\n   defined in Sections 4.1 through 4.4 of [RFC3046],
    the DHCPv4 Relay-\n   Agent-Information Option, it MUST ignore those sub-options
    only.  If\n   the DHCPv4 server is able to process the DHCPv4 Access-Network-\n
    \  Identifier sub-options defined in Sections 4.1 through 4.4 of\n   [RFC3046],
    the DHCPv4 Relay-Agent-Information Option, it MAY use this\n   information obtained
    from the sub-option for address pool selection\n   or for policy decisions as
    per its configured policy.  This\n   information obtained from the sub-option
    SHOULD NOT be stored unless\n   it is absolutely needed.  However, if it is stored,
    the information\n   MUST be deleted as quickly as possible to eliminate any possibility\n
    \  of the information getting exposed to an intruder.\n   The DHCPv4 server MUST
    ignore the received DHCPv4 Access-Network-\n   Identifier Option and process the
    rest of the message as per the base\n   DHCPv4 specifications if the received
    DHCPv4 message does not include\n   the DHCPv4 Access-Technology-Type Sub-option
    (Section 4.2) but does\n   include any one of these other options: DHCPv4 Network
    Name Sub-\n   option (Section 4.3.1), DHCPv4 Access-Point-Name Sub-option\n   (Section
    4.3.2), or DHCPv4 Access-Point-BSSID Sub-option\n   (Section 4.3.3).\n   DHCPv6
    base specification [RFC3315] requires that the DHCPv6 server\n   ignore the DHCPv6
    Access-Network-Identifier Option if it does not\n   understand the option.\n   If
    the DHCPv6 server receives the options defined in Section 5 and is\n   configured
    to use the options defined in Section 5, it SHOULD look\n   for the DHCPv6 Access-Network-Identifier
    options in the Relay-forward\n   message of the DHCPv6 relay agent(s) based on
    its configured policy.\n   The server MAY use received ANI options for its address
    pool\n   selection policy decisions as per its configured policy.  This\n   information
    obtained from the options SHOULD NOT be stored unless it\n   is absolutely needed.
    \ However, if it is stored, the information MUST\n   be deleted as quickly as
    possible to eliminate any possibility of the\n   information getting exposed to
    an intruder.\n   The DHCPv6 server MUST ignore the received DHCPv6 Access-Network-\n
    \  Identifier Option and process the rest of the message as per the base\n   DHCPv6
    specifications if the received DHCPv6 message does not include\n   the DHCPv6
    Access-Technology-Type Option (Section 5.1) but it does\n   includes any one of
    these other options: DHCPv6 Network-Name Option\n   (Section 5.2.1), DHCPv6 Access-Point-Name
    Option (Section 5.2.2), or\n   DHCPv6 Access-Point-BSSID Option (Section 5.2.3).\n"
  title: 7.  Server Behavior
- contents:
  - "8.  IANA Considerations\n   IANA has assigned sub-option codes for the following
    DHCPv4 sub-\n   options from the \"DHCP Relay Agent Sub-Option Codes\" registry,\n
    \  <http://www.iana.org/assignments/bootp-dhcp-parameters>:\n      +=================+=======================================+\n
    \     | SUB-OPTION CODE |     SUB-OPTION DESCRIPTION            |\n      +=================+=======================================+\n
    \     |       13        | Access-Technology-Type Sub-option     |\n      +=========================================================+\n
    \     |       14        | Access-Network-Name Sub-option        |\n      +=========================================================+\n
    \     |       15        | Access-Point-Name Sub-option          |\n      +=========================================================+\n
    \     |       16        | Access-Point-BSSID Sub-option         |\n      +=========================================================+\n
    \     |       17        | Operator-Identifier Sub-option        |\n      +=========================================================+\n
    \     |       18        | Operator-Realm Sub-option             |\n      +=========================================================+\n
    \  IANA has assigned option codes for the following DHCPv6 options from\n   the
    \"Option Codes\" registry for DHCPv6,\n   <http://www.iana.org/assignments/dhcpv6-parameters>,
    as specified in\n   [RFC3315]:\n      +=================+=======================================+\n
    \     |   OPTION CODE   |      OPTION DESCRIPTION               |\n      +=================+=======================================+\n
    \     |       105       | OPTION_ANI_ATT                        |\n      +=========================================================+\n
    \     |       106       | OPTION_ANI_NETWORK_NAME               |\n      +=========================================================+\n
    \     |       107       | OPTION_ANI_AP_NAME                    |\n      +=========================================================+\n
    \     |       108       | OPTION_ANI_AP_BSSID                   |\n      +=========================================================+\n
    \     |       109       | OPTION_ANI_OPERATOR_ID                |\n      +=========================================================+\n
    \     |       110       | OPTION_ANI_OPERATOR_REALM             |\n      +=========================================================+\n"
  title: 8.  IANA Considerations
- contents:
  - "9.  Security Considerations\n   Since there is no privacy protection for DHCP
    messages, an\n   eavesdropper who can monitor the link between the DHCP server
    and\n   relay agent can discover access-network information.\n   [RFC3118] and
    [RFC3315] describe many of the threats in using DHCP.\n   [RFC3118] and [RFC3315]
    each provide a solution; the Authentication\n   Option for DHCPv4 and DHCPv6 (respectively).
    \ However, neither of\n   these options are in active use and therefore are not
    a viable\n   mitigation option.  DHCP itself is inherently insecure and thus link-\n
    \  layer confidentiality and integrity protection SHOULD be employed to\n   reduce
    the risk of disclosure and tampering.\n   It is possible for a rogue DHCP relay
    agent to insert or overwrite\n   with incorrect Access-Network-Identifier options
    for malicious\n   purposes.  A DHCP client can also pose as a rogue DHCP relay
    agent by\n   sending incorrect Access-Network-Identifier options.  While the\n
    \  introduction of fraudulent DHCP relay agent information options can\n   be
    prevented by a perimeter defense that blocks these options unless\n   the DHCP
    relay agent is trusted, a deeper defense using the\n   authentication sub-option
    for the DHCPv4 Relay-Agent-Information\n   Option [RFC4030] SHOULD be deployed
    as well.  Administrators SHOULD\n   configure DHCP servers that use this option
    to communicate with their\n   relay agents using IPsec, as described in Section
    21.1 of [RFC3315].\n   The information elements that this document is exposing
    are the\n   client's access-network information.  These pertain to the access\n
    \  network to which the client is attached, such as Access-Technology\n   Type
    (e.g., WLAN, Ethernet, etc.), Access-Point Identity (Name,\n   BSSID), and Operator-Identifier
    and Operator-Realm.  In deployments\n   where this information cannot be secured
    using IPsec [RFC4301] or\n   other security protocols, administrators SHOULD disable
    the\n   capability specified in this document on the DHCP entities.\n"
  title: 9.  Security Considerations
- contents:
  - '10.  References

    '
  - contents:
    - "10.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use
      in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n
      \             DOI 10.17487/RFC2119, March 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n
      \  [RFC2131]  Droms, R., \"Dynamic Host Configuration Protocol\",\n              RFC
      2131, DOI 10.17487/RFC2131, March 1997,\n              <http://www.rfc-editor.org/info/rfc2131>.\n
      \  [RFC3046]  Patrick, M., \"DHCP Relay Agent Information Option\",\n              RFC
      3046, DOI 10.17487/RFC3046, January 2001,\n              <http://www.rfc-editor.org/info/rfc3046>.\n
      \  [RFC3315]  Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,\n              C.,
      and M. Carney, \"Dynamic Host Configuration Protocol\n              for IPv6
      (DHCPv6)\", RFC 3315, DOI 10.17487/RFC3315, July\n              2003, <http://www.rfc-editor.org/info/rfc3315>.\n"
    title: 10.1.  Normative References
  - contents:
    - "10.2.  Informative References\n   [ANI]      \"Interoperability Specification
      (IOS) for High Rate Packet\n              Data (HRPD) Radio Access Network Interfaces
      with Session\n              Control in the Access Network\", 3GPP2 A.S0008-C
      v4.0,\n              April 2011.\n   [RFC3118]  Droms, R., Ed. and W. Arbaugh,
      Ed., \"Authentication for\n              DHCP Messages\", RFC 3118, DOI 10.17487/RFC3118,
      June 2001,\n              <http://www.rfc-editor.org/info/rfc3118>.\n   [RFC3629]
      \ Yergeau, F., \"UTF-8, a transformation format of ISO\n              10646\",
      STD 63, RFC 3629, DOI 10.17487/RFC3629, November\n              2003, <http://www.rfc-editor.org/info/rfc3629>.\n
      \  [RFC4030]  Stapp, M. and T. Lemon, \"The Authentication Suboption for\n              the
      Dynamic Host Configuration Protocol (DHCP) Relay Agent\n              Option\",
      RFC 4030, DOI 10.17487/RFC4030, March 2005,\n              <http://www.rfc-editor.org/info/rfc4030>.\n
      \  [RFC4301]  Kent, S. and K. Seo, \"Security Architecture for the\n              Internet
      Protocol\", RFC 4301, DOI 10.17487/RFC4301,\n              December 2005, <http://www.rfc-editor.org/info/rfc4301>.\n
      \  [RFC5213]  Gundavelli, S., Ed., Leung, K., Devarapalli, V.,\n              Chowdhury,
      K., and B. Patil, \"Proxy Mobile IPv6\",\n              RFC 5213, DOI 10.17487/RFC5213,
      August 2008,\n              <http://www.rfc-editor.org/info/rfc5213>.\n   [RFC5844]
      \ Wakikawa, R. and S. Gundavelli, \"IPv4 Support for Proxy\n              Mobile
      IPv6\", RFC 5844, DOI 10.17487/RFC5844, May 2010,\n              <http://www.rfc-editor.org/info/rfc5844>.\n
      \  [RFC6757]  Gundavelli, S., Ed., Korhonen, J., Ed., Grayson, M.,\n              Leung,
      K., and R. Pazhyannur, \"Access Network Identifier\n              (ANI) Option
      for Proxy Mobile IPv6\", RFC 6757,\n              DOI 10.17487/RFC6757, October
      2012,\n              <http://www.rfc-editor.org/info/rfc6757>.\n   [RFC6991]
      \ Schoenwaelder, J., Ed., \"Common YANG Data Types\",\n              RFC 6991,
      DOI 10.17487/RFC6991, July 2013,\n              <http://www.rfc-editor.org/info/rfc6991>.\n
      \  [SMI]      IANA, \"PRIVATE ENTERPRISE NUMBERS, SMI Network Management\n              Private
      Enterprise Codes\", March 2016,\n              <https://www.iana.org/assignments/enterprise-numbers>.\n
      \  [TS23003]  3GPP, \"Numbering, addressing and identification\", 3GPP\n              TS
      23.003 13.4.0, December 2015.\n   [TS23203]  3GPP, \"Policy and charging control
      architecture\", 3GPP\n              TS 23.203 13.6.0, December 2015.\n   [TS23402]
      \ 3GPP, \"Architecture enhancements for non-3GPP accesses\",\n              3GPP
      TS 23.402 13.4.0, December 2015.\n"
    title: 10.2.  Informative References
  title: 10.  References
- contents:
  - "Acknowledgements\n   The authors would like to thank Kim Kinnear, Ted Lemon,
    Gaurav\n   Halwasia, Hidetoshi Yokota, Sheng Jiang, and Francis Dupont for their\n
    \  valuable input.  Also, thank you to Tomek Mrugalski for a thorough\n   review
    of the document.\n"
  title: Acknowledgements
- contents:
  - "Authors' Addresses\n   Shwetha Bhandari\n   Cisco Systems\n   Cessna Business
    Park, Sarjapura Marathalli Outer Ring Road\n   Bangalore, KARNATAKA  560 087\n
    \  India\n   Phone: +91 80 4426 0474\n   Email: shwethab@cisco.com\n   Sri Gundavelli\n
    \  Cisco Systems\n   170 West Tasman Drive\n   San Jose, CA  95134\n   United
    States\n   Email: sgundave@cisco.com\n   Mark Grayson\n   Cisco Systems\n   11
    New Square Park\n   Bedfont Lakes, FELTHAM  TW14 8HA\n   England\n   Email: mgrayson@cisco.com\n
    \  Bernie Volz\n   Cisco Systems\n   1414 Massachusetts Ave\n   Boxborough, MA
    \ 01719\n   United States\n   Email: volz@cisco.com\n   Jouni Korhonen\n   Broadcom
    Limited\n   3151 Zanker Rd\n   San Jose, CA  95134\n   United States\n   Email:
    jouni.nospam@gmail.com\n"
  title: Authors' Addresses
