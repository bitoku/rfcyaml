- title: __initial_text__
  contents:
  - ' An Architecture for Multi-Segment Pseudowire Emulation Edge-to-Edge

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes an architecture for extending pseudowire\n\
    \   emulation across multiple packet switched network (PSN) segments.\n   Scenarios\
    \ are discussed where each segment of a given edge-to-edge\n   emulated service\
    \ spans a different provider's PSN, as are other\n   scenarios where the emulated\
    \ service originates and terminates on the\n   same provider's PSN, but may pass\
    \ through several PSN tunnel segments\n   in that PSN.  It presents an architectural\
    \ framework for such multi-\n   segment pseudowires, defines terminology, and\
    \ specifies the various\n   protocol elements and their functions.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright and License Notice
  contents:
  - "Copyright and License Notice\n   Copyright (c) 2009 IETF Trust and the persons\
    \ identified as the\n   document authors.  All rights reserved.\n   This document\
    \ is subject to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF\
    \ Documents\n   (http://trustee.ietf.org/license-info) in effect on the date of\n\
    \   publication of this document.  Please review these documents\n   carefully,\
    \ as they describe your rights and restrictions with respect\n   to this document.\
    \  Code Components extracted from this document must\n   include Simplified BSD\
    \ License text as described in Section 4.e of\n   the Trust Legal Provisions and\
    \ are provided without warranty as\n   described in the BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Motivation and Context .....................................3\n  \
    \    1.2. Non-Goals of This Document .................................6\n    \
    \  1.3. Terminology ................................................6\n   2. Applicability\
    \ ...................................................8\n   3. Protocol Layering\
    \ Model .........................................8\n      3.1. Domain of MS-PW\
    \ Solutions ..................................9\n      3.2. Payload Types ..............................................9\n\
    \   4. Multi-Segment Pseudowire Reference Model ........................9\n  \
    \    4.1. Intra-Provider Connectivity Architecture ..................11\n    \
    \       4.1.1. Intra-Provider Switching Using ACs .................11\n      \
    \     4.1.2. Intra-Provider Switching Using PWs .................11\n      4.2.\
    \ Inter-Provider Connectivity Architecture ..................11\n           4.2.1.\
    \ Inter-Provider Switching Using ACs .................12\n           4.2.2. Inter-Provider\
    \ Switching Using PWs .................12\n   5. PE Reference Model .............................................13\n\
    \      5.1. Pseudowire Pre-Processing .................................13\n  \
    \         5.1.1. Forwarding .........................................13\n    \
    \       5.1.2. Native Service Processing ..........................14\n   6. Protocol\
    \ Stack Reference Model .................................14\n   7. Maintenance\
    \ Reference Model ....................................15\n   8. PW Demultiplexer\
    \ Layer and PSN Requirements ....................16\n      8.1. Multiplexing ..............................................16\n\
    \      8.2. Fragmentation .............................................17\n  \
    \ 9. Control Plane ..................................................17\n    \
    \  9.1. Setup and Placement of MS-PWs .............................17\n      9.2.\
    \ Pseudowire Up/Down Notification ...........................18\n      9.3. Misconnection\
    \ and Payload Type Mismatch ...................18\n   10. Management and Monitoring\
    \ .....................................18\n   11. Congestion Considerations .....................................19\n\
    \   12. Security Considerations .......................................20\n  \
    \ 13. Acknowledgments ...............................................23\n   14.\
    \ References ....................................................23\n      14.1.\
    \ Normative References .....................................23\n      14.2. Informative\
    \ References ...................................23\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   RFC 3985 [1] defines the architecture for pseudowires, where\
    \ a\n   pseudowire (PW) both originates and terminates on the edge of the\n  \
    \ same packet switched network (PSN).  The PW label is unchanged\n   between the\
    \ originating and terminating provider edges (PEs).  This\n   is now known as\
    \ a single-segment pseudowire (SS-PW).\n   This document extends the architecture\
    \ in RFC 3985 to enable point-\n   to-point pseudowires to be extended through\
    \ multiple PSN tunnels.\n   These are known as multi-segment pseudowires (MS-PWs).\
    \  Use cases for\n   multi-segment pseudowires (MS-PWs), and the consequent requirements,\n\
    \   are defined in RFC 5254 [5].\n"
- title: 1.1.  Motivation and Context
  contents:
  - "1.1.  Motivation and Context\n   RFC 3985 addresses the case where a PW spans\
    \ a single segment between\n   two PEs.  Such PWs are termed single-segment pseudowires\
    \ (SS-PWs) and\n   provide point-to-point connectivity between two edges of a\
    \ provider\n   network.  However, there is now a requirement to be able to construct\n\
    \   multi-segment pseudowires.  These requirements are specified in RFC\n   5254\
    \ [5] and address three main problems:\n   i.   How to constrain the density of\
    \ the mesh of PSN tunnels when the\n        number of PEs grows to many hundreds\
    \ or thousands, while\n        minimizing the complexity of the PEs and P-routers.\n\
    \   ii.  How to provide PWs across multiple PSN routing domains or areas\n   \
    \     in the same provider.\n   iii. How to provide PWs across multiple provider\
    \ domains and\n        different PSN types.\n   Consider a single PW domain, such\
    \ as that shown in Figure 1.  There\n   are 4 PEs, and PWs must be provided from\
    \ any PE to any other PE.\n   PWs can be supported by establishing a full mesh\
    \ of PSN tunnels\n   between the PEs, requiring a full mesh of LDP signaling adjacencies\n\
    \   between the PEs.  PWs can therefore be established between any PE and\n  \
    \ any other PE via a single, direct PSN tunnel that is switched only by\n   intermediate\
    \ P-routers (not shown in the figure).  In this case, each\n   PW is an SS-PW.\
    \  A PE must terminate all the pseudowires that are\n   carried on the PSN tunnels\
    \ that terminate on that PE, according to\n   the architecture of RFC 3985.  This\
    \ solution is adequate for small\n   numbers of PEs, but the number of PEs, PSN\
    \ tunnels, and signaling\n   adjacencies will grow in proportion to the square\
    \ of the number of\n   PEs.\n   For reasons of economy, the edge PEs that terminate\
    \ the attachment\n   circuits (ACs) are often small devices built to very low\
    \ cost with\n   limited processing power.  Consider an example where a particular\
    \ PE,\n   residing at the edge of a provider network, terminates N PWs to/from\n\
    \   N different remote PEs.  This needs N PW signaling adjacencies to be\n   set\
    \ up and maintained.  If the edge PE attaches to a single\n   intermediate PE\
    \ that is able to switch the PW, that edge PE only\n   needs a single adjacency\
    \ to signal and maintain all N PWs.  The\n   intermediate switching PE (which\
    \ is a larger device) needs M\n   signaling adjacencies, but statistically this\
    \ is less than tN, where\n   t is the number of edge PEs that it is serving. \
    \ Similarly, if the\n   PWs are running over TE PSN tunnels, there is a statistical\
    \ reduction\n   in the number of TE PSN tunnels that need to be set up and maintained\n\
    \   between the various PEs.\n   One possible solution that is more efficient\
    \ for large numbers of\n   PEs, in particular for the control plane, is therefore\
    \ to support a\n   partial mesh of PSN tunnels between the PEs, as shown in Figure\
    \ 1.\n   For example, consider a PW service whose endpoints are PE1 and PE4.\n\
    \   Pseudowires for this can take the path PE1->PE2->PE4 and, rather than\n  \
    \ terminating at PE2, be switched between ingress and egress PSN\n   tunnels on\
    \ that PE.  This requires a capability in PE2 that can\n   concatenate PW segments\
    \ PE1-PE2 to PW segments PE2-PE4.  The end-to-\n   end PW is known as a multi-segment\
    \ PW.\n                                   ,,..--..,,_\n                      \
    \         .-``           `'.,\n                       +-----+`               \
    \    '+-----+\n                       | PE1 |---------------------| PE2 |\n  \
    \                     |     |---------------------|     |\n                  \
    \     +-----+      PSN Tunnel     +-----+\n                       / ||       \
    \                   || \\\n                      /  ||                       \
    \   ||  \\\n                     |   ||                          ||   |\n    \
    \                 |   ||         PSN              ||   |\n                   \
    \  |   ||                          ||   |\n                      \\  ||      \
    \                    ||  /\n                       \\ ||                     \
    \     || /\n                        \\||                          ||/\n      \
    \                 +-----+                     +-----+\n                      \
    \ | PE3 |---------------------| PE4 |\n                       |     |---------------------|\
    \     |\n                       +-----+`'.,_           ,.'` +-----+\n        \
    \                           `'''---''``\n   Figure 1: PWs Spanning a Single PSN\
    \ with Partial Mesh of PSN Tunnels\n   Figure 1 shows a simple, flat PSN topology.\
    \  However, large provider\n   networks are typically not flat, consisting of\
    \ many domains that are\n   connected together to provide edge-to-edge services.\
    \  The elements in\n   each domain are specialized for a particular role, for\
    \ example,\n   supporting different PSN types or using different routing protocols.\n\
    \   An example application is shown in Figure 2.  Here, the provider's\n   network\
    \ is divided into three domains: two access domains and the\n   core domain. \
    \ The access domains represent the edge of the provider's\n   network at which\
    \ services are delivered.  In the access domain,\n   simplicity is required in\
    \ order to minimize the cost of the network.\n   The core domain must support\
    \ all of the aggregated services from the\n   access domains, and the design requirements\
    \ here are for scalability,\n   performance, and information hiding (i.e., minimal\
    \ state).  The core\n   must not be exposed to the state associated with large\
    \ numbers of\n   individual edge-to-edge flows.  That is, the core must be simple\
    \ and\n   fast.\n   In a traditional layer 2 network, the interconnection points\
    \ between\n   the domains are where services in the access domains are aggregated\n\
    \   for transport across the core to other access domains.  In an IP\n   network,\
    \ the interconnection points could also represent interworking\n   points between\
    \ different types of IP networks, e.g., those with MPLS\n   and those without,\
    \ and points where network policies can be applied.\n            <-------- Edge\
    \ to Edge Emulated Services ------->\n                ,'    .      ,-`       `',\
    \       ,'    .\n               /       \\   .`             `,    /       \\\n\
    \              /        \\  /                 ,  /        \\\n       AC  +----+\
    \     +----+               +----+       +----+    AC\n        ---| PE |-----|\
    \ PE |---------------| PE |-------| PE |---\n           |  1 |     |  2 |    \
    \           | 3  |       | 4  |\n           +----+     +----+               +----+\
    \       +----+\n              \\        /  \\                 /  \\        /\n\
    \               \\       /  \\      Core       `   \\       /\n              \
    \  `,    `     .             ,`     `,    `\n                  '-'`       `.,\
    \       _.`         '-'`\n               Access 1         `''-''`         Access\
    \ 2\n                   Figure 2: Multi-Domain Network Model\n   A similar model\
    \ can also be applied to inter-provider services, where\n   a single PW spans\
    \ a number of separate provider networks in order to\n   connect ACs residing\
    \ on PEs in disparate provider networks.  In this\n   case, each provider will\
    \ typically maintain their own PE at the\n   border of their network in order\
    \ to apply policies such as security\n   and Quality of Service (QoS) to PWs entering\
    \ their network.  Thus,\n   the connection between the domains will normally be\
    \ a link between\n   two PEs on the border of each provider's network.\n   Consider\
    \ the application of this model to PWs.  PWs use tunneling\n   mechanisms such\
    \ as MPLS to enable the underlying PSN to emulate\n   characteristics of the native\
    \ service.  One solution to the multi-\n   domain network model above is to extend\
    \ PSN tunnels edge-to-edge\n   between all of the PEs in access domain 1 and all\
    \ of the PEs in\n   access domain 2, but this requires a large number of PSN tunnels,\
    \ as\n   described above, and also exposes the access and the core of the\n  \
    \ network to undesirable complexity.  An alternative is to constrain\n   the complexity\
    \ to the network domain interconnection points (PE2 and\n   PE3 in the example\
    \ above).  Pseudowires between PE1 and PE4 would\n   then be switched between\
    \ PSN tunnels at the interconnection points,\n   enabling PWs from many PEs in\
    \ the access domains to be aggregated\n   across only a few PSN tunnels in the\
    \ core of the network.  PEs in the\n   access domains would only need to maintain\
    \ direct signaling sessions\n   and PSN tunnels, with other PEs in their own domain,\
    \ thus minimizing\n   complexity of the access domains.\n"
- title: 1.2.  Non-Goals of This Document
  contents:
  - "1.2.  Non-Goals of This Document\n   The following are non-goals for this document:\n\
    \   o The on-the-wire specification of PW encapsulations.\n   o The detailed specification\
    \ of mechanisms for establishing and\n     maintaining multi-segment pseudowires.\n"
- title: 1.3.  Terminology
  contents:
  - "1.3.  Terminology\n   The terminology specified in RFC 3985 [1] and RFC 4026\
    \ [2] applies.\n   In addition, we define the following terms:\n   o PW Terminating\
    \ Provider Edge (T-PE).  A PE where the customer-\n     facing attachment circuits\
    \ (ACs) are bound to a PW forwarder.  A\n     terminating PE is present in the\
    \ first and last segments of an MS-\n     PW.  This incorporates the functionality\
    \ of a PE as defined in RFC\n     3985.\n   o Single-Segment Pseudowire (SS-PW).\
    \  A PW set up directly between\n     two T-PE devices.  The PW label is unchanged\
    \ between the\n     originating and terminating T-PEs.\n   o Multi-Segment Pseudowire\
    \ (MS-PW).  A static or dynamically\n     configured set of two or more contiguous\
    \ PW segments that behave\n     and function as a single point-to-point PW.  Each\
    \ end of an MS-PW,\n     by definition, terminates on a T-PE.\n   o PW Segment.\
    \  A part of a single-segment or multi-segment PW, which\n     traverses one PSN\
    \ tunnel in each direction between two PE devices,\n     T-PEs, and/or S-PEs (switching\
    \ PE).\n   o PW Switching Provider Edge (S-PE).  A PE capable of switching the\n\
    \     control and data planes of the preceding and succeeding PW segments\n  \
    \   in an MS-PW.  The S-PE terminates the PSN tunnels of the preceding\n     and\
    \ succeeding segments of the MS-PW.  It therefore includes a PW\n     switching\
    \ point for an MS-PW.  A PW switching point is never the\n     S-PE and the T-PE\
    \ for the same MS-PW.  A PW switching point runs\n     necessary protocols to\
    \ set up and manage PW segments with other PW\n     switching points and terminating\
    \ PEs.  An S-PE can exist anywhere a\n     PW must be processed or policy applied.\
    \  It is therefore not\n     limited to the edge of a provider network.\n    \
    \ Note that it was originally anticipated that S-PEs would only be\n     deployed\
    \ at the edge of a provider network where they would be used\n     to switch the\
    \ PWs of different service providers.  However, as the\n     design of MS-PW progressed,\
    \ other applications for MS-PW were\n     recognized.  By this time S-PE had become\
    \ the accepted term for the\n     equipment, even though they were no longer universally\
    \ deployed at\n     the provider edge.\n   o PW Switching.  The process of switching\
    \ the control and data planes\n     of the preceding and succeeding PW segments\
    \ in a MS-PW.\n   o PW Switching Point.  The reference point in an S-PE where\
    \ the\n     switching takes place, e.g., where PW label swap is executed.\n  \
    \ o Eligible S-PE or T-PE.  An eligible S-PE or T-PE is a PE that meets\n    \
    \ the security and privacy requirements of the MS-PW, according to\n     the network\
    \ operator's policy.\n   o Trusted S-PE or T-PE.  A trusted S-PE or T-PE is a\
    \ PE that is\n     understood to be eligible by its next-hop S-PE or T-PE, while\
    \ a\n     trust relationship exists between two S-PEs or T-PEs if they\n     mutually\
    \ consider each other to be eligible.\n"
- title: 2.  Applicability
  contents:
  - "2.  Applicability\n   An MS-PW is a single PW that, for technical or administrative\n\
    \   reasons, is segmented into a number of concatenated hops.  From the\n   perspective\
    \ of a Layer 2 Virtual Private Network (L2VPN), an MS-PW is\n   indistinguishable\
    \ from an SS-PW.  Thus, the following are equivalent\n   from the perspective\
    \ of the T-PE:\n    +----+                                                  +----+\n\
    \    |TPE1+--------------------------------------------------+TPE2|\n    +----+\
    \                                                  +----+\n    |<---------------------------PW----------------------------->|\n\
    \    +----+              +---+           +---+               +----+\n    |TPE1+--------------+SPE+-----------+SPE+---------------+TPE2|\n\
    \    +----+              +---+           +---+               +----+\n        \
    \               Figure 3: MS-PW Equivalence\n   Although an MS-PW may require\
    \ services such as node discovery and\n   path signaling to construct the PW,\
    \ it should not be confused with an\n   L2VPN system, which also requires these\
    \ services.  A Virtual Private\n   Wire Service (VPWS) connects its endpoints\
    \ via a set of PWs.  MS-PW\n   is a mechanism that abstracts the construction\
    \ of complex PWs from\n   the construction of a L2VPN.  Thus, a T-PE might be\
    \ an edge device\n   optimized for simplicity and an S-PE might be an aggregation\
    \ device\n   designed to absorb the complexity of continuing the PW across the\n\
    \   core of one or more service provider networks to another T-PE located\n  \
    \ at the edge of the network.\n   As well as supporting traditional L2VPNs, an\
    \ MS-PW is applicable to\n   providing connectivity across a transport network\
    \ based on packet\n   switching technology, e.g., the MPLS Transport Profile (MPLS-TP)\
    \ [6],\n   [8].  Such a network uses pseudowires to support the transport and\n\
    \   aggregation of all services.  This application requires deterministic\n  \
    \ characteristics and behavior from the network.  The operational\n   requirements\
    \ of such networks may need pseudowire segments that can\n   be established and\
    \ maintained in the absence of a control plane, and\n   may also need the operational\
    \ independence of PW maintenance from the\n   underlying PSN.\n"
- title: 3.  Protocol Layering Model
  contents:
  - "3.  Protocol Layering Model\n   The protocol layering model specified in RFC\
    \ 3985 applies to MS-PWs\n   with the following clarification: the pseudowires\
    \ may be considered\n   to be a separate layer to the PSN tunnel.  That is, although\
    \ a PW\n   segment will follow the path of the PSN tunnel between S-PEs, the\n\
    \   MS-PW is independent of the PSN tunnel routing, operations,\n   signaling,\
    \ and maintenance.  The design of PW routing domains should\n   not imply that\
    \ the underlying PSN routing domains are the same.\n   However, MS-PWs will reuse\
    \ the protocols of the PSN and may, if\n   applicable, use information that is\
    \ extracted from the PSN, e.g.,\n   reachability.\n"
- title: 3.1.  Domain of MS-PW Solutions
  contents:
  - "3.1.  Domain of MS-PW Solutions\n   PWs provide the Encapsulation Layer, i.e.,\
    \ the method of carrying\n   various payload types, and the interface to the PW\
    \ Demultiplexer\n   Layer.  Other layers provide the following:\n      o PSN tunnel\
    \ setup, maintenance, and routing\n      o T-PE discovery\n   Not all PEs may\
    \ be capable of providing S-PE functionality.\n   Connectivity to the next-hop\
    \ S-PE or T-PE must be provided by a PSN\n   tunnel, according to [1].  The selection\
    \ of which set of S-PEs to use\n   to reach a given T-PE is considered to be within\
    \ the scope of MS-PW\n   solutions.\n"
- title: 3.2.  Payload Types
  contents:
  - "3.2.  Payload Types\n   MS-PWs are applicable to all PW payload types.  Encapsulations\n\
    \   defined for SS-PWs are also used for MS-PW without change.  Where the\n  \
    \ PSN types for each segment of an MS-PW are identical, the PW types of\n   each\
    \ segment must also be identical.  However, if different segments\n   run over\
    \ different PSN types, the encapsulation may change but the PW\n   segments must\
    \ be of an equivalent PW type, i.e., the S-PE must not\n   need to process the\
    \ PW payload to provide translation.\n"
- title: 4.  Multi-Segment Pseudowire Reference Model
  contents:
  - "4.  Multi-Segment Pseudowire Reference Model\n   The pseudowire emulation edge-to-edge\
    \ (PWE3) reference architecture\n   for the single-segment case is shown in [1].\
    \  This architecture\n   applies to the case where a PSN tunnel extends between\
    \ two edges of a\n   single PSN domain to transport a PW with endpoints at these\
    \ edges.\n       Native  |<------Multi-Segment Pseudowire------>|  Native\n  \
    \     Service |         PSN              PSN         |  Service\n        (AC)\
    \   |     |<-Tunnel->|     |<-Tunnel->|    |   (AC)\n          |    V     V  \
    \   1    V     V    2     V    V     |\n          |    +----+           +-----+\
    \          +----+     |\n   +----+ |    |TPE1|===========|SPE1 |==========|TPE2|\
    \     | +----+\n   |    |------|..... PW.Seg't1....X....PW.Seg't3.....|-------|\
    \    |\n   | CE1| |    |    |           |     |          |    |     | |CE2 |\n\
    \   |    |------|..... PW.Seg't2....X....PW.Seg't4.....|-------|    |\n   +----+\
    \ |    |    |===========|     |==========|    |     | +----+\n        ^      +----+\
    \           +-----+          +----+       ^\n        |   Provider Edge 1     \
    \   ^        Provider Edge 2   |\n        |                          |       \
    \                   |\n        |                          |                  \
    \        |\n        |                  PW switching point                 |\n\
    \        |                                                     |\n        |<------------------\
    \ Emulated Service --------------->|\n                     Figure 4: MS-PW Reference\
    \ Model\n   Figure 4 extends this architecture to show a multi-segment case. \
    \ The\n   PEs that provide services to CE1 and CE2 are Terminating PE1 (T-PE1)\n\
    \   and Terminating PE2 (T-PE2), respectively.  A PSN tunnel extends from\n  \
    \ T-PE1 to Switching PE1 (S-PE1) across PSN1, and a second PSN tunnel\n   extends\
    \ from S-PE1 to T-PE2 across PSN2.  PWs are used to connect the\n   attachment\
    \ circuits (ACs) attached to PE1 to the corresponding ACs\n   attached to T-PE2.\n\
    \   Each PW segment on the tunnel across PSN1 is switched to a PW segment\n  \
    \ in the tunnel across PSN2 at S-PE1 to complete the multi-segment PW\n   (MS-PW)\
    \ between T-PE1 and T-PE2.  S-PE1 is therefore the PW switching\n   point.  PW\
    \ segment 1 and PW segment 3 are segments of the same MS-PW,\n   while PW segment\
    \ 2 and PW segment 4 are segments of another MS-PW.\n   PW segments of the same\
    \ MS-PW (e.g., PW segment 1 and PW segment 3)\n   must be of equivalent PW types,\
    \ as described in Section 3.2, while\n   PSN tunnels (e.g., PSN1 and PSN2) may\
    \ be of the same or different PSN\n   types.  An S-PE switches an MS-PW from one\
    \ segment to another based\n   on the PW demultiplexer, i.e., a PW label that\
    \ may take one of the\n   forms defined in Section 5.4.1 of RFC 3985 [1].\n  \
    \ Note that although Figure 4 only shows a single S-PE, a PW may\n   transit more\
    \ than one S-PE along its path.  This architecture is\n   applicable when the\
    \ S-PEs are statically chosen, or when they are\n   chosen using a dynamic path-selection\
    \ mechanism.  Both directions of\n   an MS-PW must traverse the same set of S-PEs\
    \ on a reciprocal path.\n   Note that although the S-PE path is therefore reciprocal,\
    \ the path\n   taken by the PSN tunnels between the T-PEs and S-PEs might not\
    \ be\n   reciprocal due to choices made by the PSN routing protocol.\n"
- title: 4.1.  Intra-Provider Connectivity Architecture
  contents:
  - "4.1.  Intra-Provider Connectivity Architecture\n   There is a requirement to\
    \ deploy PWs edge-to-edge in large service\n   provider networks (RFC 5254 [5]).\
    \  Such networks typically encompass\n   hundreds or thousands of aggregation\
    \ devices at the edge, each of\n   which would be a PE.  These networks may be\
    \ partitioned into separate\n   metro and core PW domains, where the PEs are interconnected\
    \ by a\n   sparse mesh of tunnels.\n   Whether or not the network is partitioned\
    \ into separate PW domains,\n   there is also a requirement to support a partial\
    \ mesh of traffic-\n   engineered PSN tunnels.\n   The architecture shown in Figure\
    \ 4 can be used to support such cases.\n   PSN1 and PSN2 may be in different administrative\
    \ domains or access\n   regions, core regions, or metro regions within the same\
    \ provider's\n   network.  PSN1 and PSN2 may also be of different types.  For\
    \ example,\n   S-PEs may be used to connect PW segments traversing metro networks\
    \ of\n   one technology, e.g., statically allocated labels, with segments\n  \
    \ traversing an MPLS core network.\n   Alternatively, T-PE1, S-PE1, and T-PE2\
    \ may reside at the edges of the\n   same PSN.\n"
- title: 4.1.1.  Intra-Provider Switching Using ACs
  contents:
  - "4.1.1.  Intra-Provider Switching Using ACs\n   In this model, the PW reverts\
    \ to the native service AC at the domain\n   boundary PE.  This AC is then connected\
    \ to a separate PW on the same\n   PE.  In this case, the reference models of\
    \ RFC 3985 apply to each\n   segment and to the PEs.  The remaining PE architectural\n\
    \   considerations in this document do not apply to this case.\n"
- title: 4.1.2.  Intra-Provider Switching Using PWs
  contents:
  - "4.1.2.  Intra-Provider Switching Using PWs\n   In this model, PW segments are\
    \ switched between PSN tunnels that span\n   portions of a provider's network,\
    \ without reverting to the native\n   service at the boundary.  For example, in\
    \ Figure 4, PSN1 and PSN2\n   would be portions of the same provider's network.\n"
- title: 4.2.  Inter-Provider Connectivity Architecture
  contents:
  - "4.2.  Inter-Provider Connectivity Architecture\n   Inter-provider PWs may need\
    \ to be switched between PSN tunnels at the\n   provider boundary in order to\
    \ minimize the number of tunnels required\n   to provide PW-based services to\
    \ CEs attached to each provider's\n   network.  In addition, the following may\
    \ need to be implemented on a\n   per-PW basis at the provider boundary:\n   \
    \   o Operations, Administration, and Maintenance (OAM).  Note that\n        this\
    \ is synonymous with 'Operations and Maintenance' referred to\n        in RFC\
    \ 5254 [5].\n      o Authentication, Authorization, and Accounting (AAA)\n   \
    \   o Security mechanisms\n   Further security-related architectural considerations\
    \ are described\n   in Section 12.\n"
- title: 4.2.1.  Inter-Provider Switching Using ACs
  contents:
  - "4.2.1.  Inter-Provider Switching Using ACs\n   In this model, the PW reverts\
    \ to the native service at the provider\n   boundary PE.  This AC is then connected\
    \ to a separate PW at the peer\n   provider boundary PE.  In this case, the reference\
    \ models of RFC 3985\n   apply to each segment and to the PEs.  This is similar\
    \ to the case in\n   Section 4.1.1, except that additional security and policy\
    \ enforcement\n   measures will be required.  The remaining PE architectural\n\
    \   considerations in this document do not apply to this case.\n"
- title: 4.2.2.  Inter-Provider Switching Using PWs
  contents:
  - "4.2.2.  Inter-Provider Switching Using PWs\n   In this model, PW segments are\
    \ switched between PSN tunnels in each\n   provider's network, without reverting\
    \ to the native service at the\n   boundary.  This architecture is shown in Figure\
    \ 5.  Here, S-PE1 and\n   S-PE2 are provider border routers.  PW segment 1 is\
    \ switched to PW\n   segment 2 at S-PE1.  PW segment 2 is then carried across\
    \ an inter-\n   provider PSN tunnel to S-PE2, where it is switched to PW segment\
    \ 3 in\n   PSN2.\n                |<------Multi-Segment Pseudowire------>|\n \
    \               |       Provider         Provider      |\n           AC   |  \
    \  |<----1---->|     |<----2--->|    |  AC\n            |   V    V           V\
    \     V          V    V  |\n            |   +----+     +-----+     +----+    \
    \ +----+  |\n   +----+   |   |    |=====|     |=====|    |=====|    |  |    +----+\n\
    \   |    |-------|......PW.....X....PW.....X...PW.......|-------|    |\n   | CE1|\
    \   |   |    |Seg 1|     |Seg 2|    |Seg 3|    |  |    |CE2 |\n   +----+   | \
    \  |    |=====|     |=====|    |=====|    |  |    +----+\n        ^       +----+\
    \     +-----+     +----+     +----+       ^\n        |       T-PE1       S-PE1\
    \       S-PE2     T-PE2        |\n        |                     ^          ^ \
    \                    |\n        |                     |          |           \
    \          |\n        |                  PW switching points                 |\n\
    \        |                                                      |\n        | \
    \                                                     |\n        |<-------------------\
    \ Emulated Service --------------->|\n                 Figure 5: Inter-Provider\
    \ Reference Model\n"
- title: 5.  PE Reference Model
  contents:
  - '5.  PE Reference Model

    '
- title: 5.1.  Pseudowire Pre-Processing
  contents:
  - "5.1.  Pseudowire Pre-Processing\n   Pseudowire pre-processing is applied in the\
    \ T-PEs as specified in RFC\n   3985.  Processing at the S-PEs is specified in\
    \ the following\n   sections.\n"
- title: 5.1.1.  Forwarding
  contents:
  - "5.1.1.  Forwarding\n   Each forwarder in the S-PE forwards packets from one PW\
    \ segment on\n   the ingress PSN-facing interface of the S-PE to one PW segment\
    \ on the\n   egress PSN-facing interface of the S-PE.\n   The forwarder selects\
    \ the egress segment PW based on the ingress PW\n   label.  The mapping of ingress\
    \ to egress PW label may be statically\n   or dynamically configured.  Figure\
    \ 6 shows how a single forwarder is\n   associated with each PW segment at the\
    \ S-PE.\n               +------------------------------------------+\n       \
    \        |                S-PE Device               |\n               +------------------------------------------+\n\
    \     Ingress   |             |             |              |   Egress\n   PW instance\
    \ |   Single    |             |    Single    | PW Instance\n   <==========>X PW\
    \ Instance +  Forwarder  + PW Instance  X<==========>\n               |      \
    \       |             |              |\n               +------------------------------------------+\n\
    \                     Figure 6: Point-to-Point Service\n   Other mappings of PW-to-forwarder\
    \ are for further study.\n"
- title: 5.1.2.  Native Service Processing
  contents:
  - "5.1.2.  Native Service Processing\n   There is no native service processing in\
    \ the S-PEs.\n"
- title: 6.  Protocol Stack Reference Model
  contents:
  - "6.  Protocol Stack Reference Model\n   Figure 7 illustrates the protocol stack\
    \ reference model for multi-\n   segment PWs.\n   +-----------+              \
    \                    +-----------+\n   |  Emulated |                         \
    \         |  Emulated |\n   |  Service  |                                  | \
    \ Service  |\n   |(e.g., ATM)|<======= Emulated Service =======>|(e.g., ATM)|\n\
    \   +-----------+                                  +-----------+\n   | Payload\
    \   |                                  | Payload   |\n   |  Encap.   |<=== Multi-segment\
    \ Pseudowire ===>|  Encap.   |\n   +-----------+            +--------+       \
    \     +-----------+\n   | PW Demux  |<PW Segment>|PW Demux|<PW Segment>| PW Demux\
    \  |\n   +-----------+            +--------+            +-----------+\n   |PSN\
    \ Tunnel,|<PSN Tunnel>|  PSN   |<PSN Tunnel>|PSN Tunnel,|\n   | PSN & PHY |  \
    \          |Physical|            | PSN & PHY |\n   | Layers    |            |\
    \ Layers |            |  Layers   |\n   +----+------+            +--------+  \
    \          +-----+-----+\n        |            ..........   |   ..........   \
    \     |\n        |           /          \\  |  /          \\       |\n       \
    \ +==========/    PSN     \\===/    PSN     \\======+\n                   \\ \
    \ domain 1  /   \\  domain 2  /\n                    \\__________/     \\__________/\n\
    \                     ``````````       ``````````\n                Figure 7: Multi-Segment\
    \ PW Protocol Stack\n   The MS-PW provides the CE with an emulated physical or\
    \ virtual\n   connection to its peer at the far end.  Native service PDUs from\
    \ the\n   CE are passed through an Encapsulation Layer and a PW demultiplexer\n\
    \   is added at the sending T-PE.  The PDU is sent over PSN domain via\n   the\
    \ PSN transport tunnel.  The receiving S-PE swaps the existing PW\n   demultiplexer\
    \ for the demultiplexer of the next segment and then\n   sends the PDU over transport\
    \ tunnel in PSN2.  Where the ingress and\n   egress PSN domains of the S-PE are\
    \ of the same type, e.g., they are\n   both MPLS PSNs, a simple label swap operation\
    \ is performed, as\n   described in Section 3.13 of RFC 3031 [3].  However, where\
    \ the\n   ingress and egress PSNs are of different types, e.g., MPLS and\n   L2TPv3,\
    \ the ingress PW demultiplexer is removed (or popped), and a\n   mapping to the\
    \ egress PW demultiplexer is performed and then inserted\n   (or pushed).\n  \
    \ Policies may also be applied to the PW at this point.  Examples of\n   such\
    \ policies include admission control, rate control, QoS mappings,\n   and security.\
    \  The receiving T-PE removes the PW demultiplexer and\n   restores the payload\
    \ to its native format for transmission to the\n   destination CE.\n   Where the\
    \ encapsulation format is different, e.g., MPLS and L2TPv3,\n   the payload encapsulation\
    \ may be translated at the S-PE.\n"
- title: 7.  Maintenance Reference Model
  contents:
  - "7.  Maintenance Reference Model\n   Figure 8 shows the maintenance reference\
    \ model for multi-segment\n   pseudowires.\n        |<------------- CE (end-to-end)\
    \ Signaling ------------>|\n        |                                        \
    \              |\n        |       |<-------- MS-PW/T-PE Maintenance ----->|  \
    \    |\n        |       |  |<---PW Seg't-->| |<--PW Seg't--->|  |      |\n   \
    \     |       |  |   Maintenance | | Maintenance   |  |      |\n        |    \
    \   |  |               | |               |  |      |\n        |       |  |   \
    \  PSN       | |     PSN       |  |      |\n        |       |  | |<-Tunnel1->|\
    \ | | |<-Tunnel2->| |  |      |\n        |       V  V V Signaling V V V V Signaling\
    \ V V  V      |\n        V       +----+           +-----+           +----+   \
    \   V\n   +----+       |TPE1|===========|SPE1 |===========|TPE2|      +----+\n\
    \   |    |-------|......PW.Seg't1....X....PW Seg't3......|------|    |\n   | CE1|\
    \       |    |           |     |           |    |      |CE2 |\n   |    |-------|......PW.Seg't2....X....PW\
    \ Seg't4......|------|    |\n   +----+       |    |===========|     |===========|\
    \    |      +----+\n     ^          +----+           +-----+           +----+\
    \         ^\n     |        Terminating           ^            Terminating    \
    \  |\n     |      Provider Edge 1         |          Provider Edge 2    |\n  \
    \   |                              |                             |\n     |   \
    \                   PW switching point                    |\n     |          \
    \                                                  |\n     |<---------------------\
    \ Emulated Service ------------------->|\n               Figure 8: MS-PW Maintenance\
    \ Reference Model\n   RFC 3985 specifies the use of CE (end-to-end) and PSN tunnel\n\
    \   signaling as well as PW/PE maintenance.  CE and PSN tunnel signaling\n   is\
    \ as specified in RFC 3985.  However, in the case of MS-PWs,\n   signaling between\
    \ the PEs now has both an edge-to-edge and a hop-by-\n   hop context.  That is,\
    \ signaling and maintenance between T-PEs and\n   S-PEs and between adjacent S-PEs\
    \ is used to set up, maintain, and\n   tear down the MS-PW segments, which includes\
    \ the coordination of\n   parameters related to each switching point as well as\
    \ to the MS-PW\n   endpoints.\n"
- title: 8.  PW Demultiplexer Layer and PSN Requirements
  contents:
  - '8.  PW Demultiplexer Layer and PSN Requirements

    '
- title: 8.1.  Multiplexing
  contents:
  - "8.1.  Multiplexing\n   The purpose of the PW Demultiplexer Layer at the S-PE\
    \ is to\n   demultiplex PWs from ingress PSN tunnels and to multiplex them into\n\
    \   egress PSN tunnels.  Although each PW may contain multiple native\n   service\
    \ circuits, e.g., multiple ATM virtual circuits (VCs), the\n   S-PEs do not have\
    \ visibility of, and hence do not change, this level\n   of multiplexing because\
    \ they contain no Native Service Processor\n   (NSP).\n"
- title: 8.2.  Fragmentation
  contents:
  - "8.2.  Fragmentation\n   If fragmentation is to be used in an MS-PW, T-PEs and\
    \ S-PEs must\n   satisfy themselves that fragmented PW payloads can be correctly\n\
    \   reassembled for delivery to the destination attachment circuit.\n   An S-PE\
    \ is not required to make any attempt to reassemble a\n   fragmented PW payload.\
    \  However, it may choose to do so if, for\n   example, it knows that a downstream\
    \ PW segment does not support\n   reassembly.\n   An S-PE may fragment a PW payload\
    \ using [4].\n"
- title: 9.  Control Plane
  contents:
  - '9.  Control Plane

    '
- title: 9.1.  Setup and Placement of MS-PWs
  contents:
  - "9.1.  Setup and Placement of MS-PWs\n   For multi-segment pseudowires, the intermediate\
    \ PW switching points\n   may be statically provisioned or chosen dynamically.\n\
    \   For the static case, there are two options for exchanging the PW\n   labels:\n\
    \   o By configuration at the T-PEs or S-PEs.\n   o By signaling across each segment\
    \ using a dynamic maintenance\n     protocol.\n   A multi-segment pseudowire may\
    \ thus consist of segments where the\n   labels are statically configured and\
    \ segments where the labels are\n   signaled.\n   For the case of dynamic choice\
    \ of the PW switching points, there are\n   two options for selecting the path\
    \ of the MS-PW:\n   o T-PEs determine the full path of the PW through intermediate\n\
    \     switching points.  This may be either static or based on a dynamic\n   \
    \  PW path-selection mechanism.\n   o Each T-PE and S-PE makes a local decision\
    \ as to which next-hop S-PE\n     to choose to reach the target T-PE.  This choice\
    \ is made either\n     using locally configured information or by using a dynamic\
    \ PW\n     path-selection mechanism.\n"
- title: 9.2.  Pseudowire Up/Down Notification
  contents:
  - "9.2.  Pseudowire Up/Down Notification\n   Since a multi-segment PW consists of\
    \ a number of concatenated PW\n   segments, the emulated service can only be considered\
    \ as being up\n   when all of the constituting PW segments and PSN tunnels are\n\
    \   functional and operational along the entire path of the MS-PW.\n   If a native\
    \ service requires bi-directional connectivity, the\n   corresponding emulated\
    \ service can only be signaled as being up when\n   the PW segments and PSN tunnels\
    \ (if used), are functional and\n   operational in both directions.\n   RFC 3985\
    \ describes the architecture of failure and other status\n   notification mechanisms\
    \ for PWs.  These mechanisms are also needed in\n   multi-segment pseudowires.\
    \  In addition, if a failure notification\n   mechanism is provided for consecutive\
    \ segments of the same PW, the\n   S-PE must propagate such notifications between\
    \ the consecutive\n   concatenated segments.\n"
- title: 9.3.  Misconnection and Payload Type Mismatch
  contents:
  - "9.3.  Misconnection and Payload Type Mismatch\n   Misconnection and payload type\
    \ mismatch can occur with PWs.\n   Misconnection can breach the integrity of the\
    \ system.  Payload\n   mismatch can disrupt the customer network.  In both instances,\
    \ there\n   are security and operational concerns.\n   The services of the underlying\
    \ tunneling mechanism or the PW control\n   and OAM protocols can be used to ensure\
    \ that the identity of the PW\n   next hop is as expected.  As part of the PW\
    \ setup, a PW-TYPE\n   identifier is exchanged.  This is then used by the forwarder\
    \ and the\n   NSP of the T-PEs to verify the compatibility of the ACs.  This can\n\
    \   also be used by S-PEs to ensure that concatenated segments of a given\n  \
    \ MS-PW are compatible or that an MS-PW is not misconnected into a\n   local AC.\
    \  In addition, it is possible to perform an end-to-end\n   connection verification\
    \ to check the integrity of the PW, to verify\n   the identity of S-PEs and check\
    \ the correct connectivity at S-PEs,\n   and to verify the identity of the T-PE.\n"
- title: 10.  Management and Monitoring
  contents:
  - "10.  Management and Monitoring\n   The management and monitoring as described\
    \ in RFC 3985 applies here.\n   The MS-PW architecture introduces additional considerations\
    \ related\n   to management and monitoring, which need to be reflected in the\n\
    \   design of maintenance tools and additional management objects for\n   MS-PWs.\n\
    \   The first is that each S-PE is a new point at which defects may occur\n  \
    \ along the path of the PW.  In order to troubleshoot MS-PWs,\n   management and\
    \ monitoring should be able to operate on a subset of\n   the segments of an MS-PW,\
    \ as well as edge-to-edge.  That is,\n   connectivity verification mechanisms\
    \ should be able to troubleshoot\n   and differentiate the connectivity between\
    \ T-PEs and intermediate\n   S-PEs, as well as the connectivity between T-PE and\
    \ T-PE.\n   The second is that the set of S-PEs and P-routers along the MS-PW\n\
    \   path may be less optimal than a path between the T-PEs chosen solely\n   by\
    \ the underlying PSN routing protocols.  This is because the S-PEs\n   are chosen\
    \ by the MS-PW path selection mechanism and not by the PSN\n   routing protocols.\
    \  Troubleshooting mechanisms should therefore be\n   provided to verify the set\
    \ of S-PEs that are traversed by an MS-PW to\n   reach a T-PE.\n   Some of the\
    \ S-PEs and the T-PEs for an MS-PW may reside in a\n   different service provider's\
    \ PSN domain from that of the operator who\n   initiated the establishment of\
    \ the MS-PW.  These situations may\n   necessitate the use of remote management\
    \ of the MS-PW, which is able\n   to securely operate across provider boundaries.\n"
- title: 11.  Congestion Considerations
  contents:
  - "11.  Congestion Considerations\n   The following congestion considerations apply\
    \ to MS-PWs.  These are\n   in addition to the considerations for PWs described\
    \ in RFC 3985 [1],\n   [7], and the respective RFCs specifying each PW type.\n\
    \   The control plane and the data plane fate-share in traditional IP\n   networks.\
    \  The implication of this is that congestion in the data\n   plane can cause\
    \ degradation of the operation of the control plane.\n   Under quiescent operating\
    \ conditions, it is expected that the network\n   will be designed to avoid such\
    \ problems.  However, MS-PW mechanisms\n   should also consider what happens when\
    \ congestion does occur, when\n   the network is stretched beyond its design limits,\
    \ for example,\n   during unexpected network failure conditions.\n   Although\
    \ congestion within a single provider's network can be\n   mitigated by suitable\
    \ engineering of the network so that the traffic\n   imposed by PWs can never\
    \ cause congestion in the underlying PSN, a\n   significant number of MS-PWs are\
    \ expected to be deployed for inter-\n   provider services.  In this case, there\
    \ may be no way of a provider\n   who initiates the establishment of an MS-PW\
    \ at a T-PE guaranteeing\n   that it will not cause congestion in a downstream\
    \ PSN.  A specific\n   PSN may be able to protect itself from excess PW traffic\
    \ by policing\n   all PWs at the S-PE at the provider border.  However, this may\
    \ not be\n   effective when the PSN tunnel across a provider utilizes the transit\n\
    \   services of another provider that cannot distinguish PW traffic from\n   ordinary,\
    \ TCP-controlled IP traffic.\n   Each segment of an MS-PW therefore needs to implement\
    \ congestion\n   detection and congestion control mechanisms where it is not possible\n\
    \   to explicitly provision sufficient capacity to avoid congestion.\n   In many\
    \ cases, only the T-PEs may have sufficient information about\n   each PW to fairly\
    \ apply congestion control.  Therefore, T-PEs need to\n   be aware of which of\
    \ their PWs are causing congestion in a downstream\n   PSN and of their native\
    \ service characteristics, and to apply\n   congestion control accordingly.  S-PEs\
    \ therefore need to propagate\n   PSN congestion state information between their\
    \ downstream and\n   upstream directions.  If the MS-PW transits many S-PEs, it\
    \ may take\n   some time for congestion state information to propagate from the\n\
    \   congested PSN segment to the source T-PE, thus delaying the\n   application\
    \ of congestion control.  Congestion control in the S-PE at\n   the border of\
    \ the congested PSN can enable a more rapid response and\n   thus potentially\
    \ reduce the duration of congestion.\n   In addition to protecting the operation\
    \ of the underlying PSN,\n   consistent QoS and traffic engineering mechanisms\
    \ should be used on\n   each segment of an MS-PW to support the requirements of\
    \ the emulated\n   service.  The QoS treatment given to a PW packet at an S-PE\
    \ may be\n   derived from context information of the PW (e.g., traffic or QoS\n\
    \   parameters signaled to the S-PE by an MS-PW control protocol) or from\n  \
    \ PSN-specific QoS flags in the PSN tunnel label or PW demultiplexer,\n   e.g.,\
    \ TC bits in either the label switched path (LSP) or PW label for\n   an MPLS\
    \ PSN or the DS field of the outer IP header for L2TPv3.\n"
- title: 12.  Security Considerations
  contents:
  - "12.  Security Considerations\n   The security considerations described in RFC\
    \ 3985 [1] apply here.\n   Detailed security requirements for MS-PWs are specified\
    \ in RFC 5254\n   [5].  This section describes the architectural implications\
    \ of those\n   requirements.\n   The security implications for T-PEs are similar\
    \ to those for PEs in\n   single-segment pseudowires.  However, S-PEs represent\
    \ a point in the\n   network where the PW label is exposed to additional processing.\
    \  An\n   S-PE or T-PE must trust that the context of the MS-PW is maintained\n\
    \   by a downstream S-PE.  OAM tools must be able to verify the identity\n   of\
    \ the far end T-PE to the satisfaction of the network operator.\n   Additional\
    \ consideration needs to be given to the security of the\n   S-PEs, both at the\
    \ data plane and the control plane, particularly\n   when these are dynamically\
    \ selected and/or when the MS-PW transits\n   the networks of multiple operators.\n\
    \   An implicit trust relationship exists between the initiator of an\n   MS-PW,\
    \ the T-PEs, and the S-PEs along the MS-PW's path.  That is, the\n   T-PE trusts\
    \ the S-PEs to process and switch PWs without compromising\n   the security or\
    \ privacy of the PW service.  An S-PE should not select\n   a next-hop S-PE or\
    \ T-PE unless it knows it would be considered\n   eligible, as defined in Section\
    \ 1.3, by the originator of the MS-PW.\n   For dynamically placed MS-PWs, this\
    \ can be achieved by allowing the\n   T-PE to explicitly specify the path of the\
    \ MS-PW.  When the MS-PW is\n   dynamically created by the use of a signaling\
    \ protocol, an S-PE or\n   T-PE should determine the authenticity of the peer\
    \ entity from which\n   it receives the request and the compliance of that request\
    \ with\n   policy.\n   Where an MS-PW crosses a border between one provider and\
    \ another\n   provider, the MS-PW segment endpoints (S-PEs or T-PEs) or, for the\n\
    \   PSN tunnel, P-routers typically reside on the same nodes as the\n   Autonomous\
    \ System Border Router (ASBRs) interconnecting the two\n   providers.  In either\
    \ case, an S-PE in one provider is connected to a\n   limited number of trusted\
    \ T-PEs or S-PEs in the other provider.  The\n   number of such trusted T-PEs\
    \ or S-PEs is bounded and not anticipated\n   to create a scaling issue for the\
    \ control plane authentication\n   mechanisms.\n   Directly interconnecting the\
    \ S-PEs/T-PEs using a physically secure\n   link and enabling signaling and routing\
    \ authentication between the\n   S-PEs/T-PEs eliminates the possibility of receiving\
    \ an MS-PW\n   signaling message or packet from an untrusted peer.  The S-PEs/T-PEs\n\
    \   represent security policy enforcement points for the MS-PW, while the\n  \
    \ ASBRs represent security policy enforcement points for the provider's\n   PSNs.\
    \  This architecture is illustrated in Figure 9.\n                  |<-------------\
    \ MS-PW ---------------->|\n                  |       Provider         Provider\
    \      |\n             AC   |    |<----1---->|     |<----2--->|    |  AC\n   \
    \           |   V    V           V     V          V    V  |\n              | \
    \  +----+     +-----+     +----+     +----+  |\n      +---+   |   |    |=====|\
    \     |=====|    |=====|    |  |    +---+\n      |   |-------|......PW.....X....PW.....X...PW.......|-------|\
    \   |\n      |CE1|   |   |    |Seg 1|     |Seg 2|    |Seg 3|    |  |    |CE2|\n\
    \      +---+   |   |    |=====|     |=====|    |=====|    |  |    +---+\n    \
    \      ^       +----+     +-----+  ^  +----+     +----+       ^\n          | \
    \      T-PE1       S-PE1   |   S-PE2     T-PE2        |\n          |         \
    \           ASBR   |    ASBR                  |\n          |                 \
    \          |                          |\n          |                  Physically\
    \ secure link              |\n          |                                    \
    \                  |\n          |                                            \
    \          |\n          |<------------------- Emulated Service --------------->|\n\
    \       Figure 9: Directly Connected Inter-Provider Reference Model\n   Alternatively,\
    \ the P-routers for the PSN tunnel may reside on the\n   ASBRs, while the S-PEs\
    \ or T-PEs reside behind the ASBRs within each\n   provider's network.  A limited\
    \ number of trusted inter-provider PSN\n   tunnels interconnect the provider networks.\
    \  This is illustrated in\n   Figure 10.\n                |<-------------- MS-PW\
    \ -------------------->|\n                |          Provider          Provider\
    \       |\n            AC  |    |<------1----->|   |<-----2------->|   |  AC\n\
    \             |  V    V              V   V               V   V  |\n          \
    \   |  +---+     +---+  +--+   +--+  +---+     +---+  |\n      +---+  |  |   |=====|\
    \   |===============|   |=====|   |  |   +---+\n      |   |-----|.....PW....X.......PW..............PW....X.|------|\
    \   |\n      |CE1|  |  |   |Seg 1|   |    Seg 2      |   |Seg 3|   |  |   |CE2|\n\
    \      +---+  |  |   |=====|   |===============|   |=====|   |  |   +---+\n  \
    \        ^     +---+     +---+  +--+ ^ +--+  +---+     +---+      ^\n        \
    \  |      T-PE1    S-PE1  ASBR | ASBR  S-PE2     T-PE2      |\n          |   \
    \                        |                            |\n          |         \
    \                  |                            |\n          |               \
    \ Trusted Inter-AS PSN Tunnel             |\n          |                     \
    \                                   |\n          |                           \
    \                             |\n          |<------------------- Emulated Service\
    \ ----------------->|\n      Figure 10: Indirectly Connected Inter-Provider Reference\
    \ Model\n   Particular consideration needs to be given to Quality of Service\n\
    \   requests because the inappropriate use of priority may impact any\n   service\
    \ guarantees given to other PWs.  Consideration also needs to\n   be given to\
    \ the avoidance of spoofing the PW demultiplexer.\n   Where an S-PE provides interconnection\
    \ between different providers,\n   security considerations that are similar to\
    \ the security\n   considerations for ASBRs apply.  In particular, peer entity\n\
    \   authentication should be used.\n   Where an S-PE also supports T-PE functionality,\
    \ mechanisms should be\n   provided to ensure that MS-PWs are switched correctly\
    \ to the\n   appropriate outgoing PW segment, rather than to a local AC.  Other\n\
    \   mechanisms for PW endpoint verification may also be used to confirm\n   the\
    \ correct PW connection prior to enabling the attachment circuits.\n"
- title: 13.  Acknowledgments
  contents:
  - "13.  Acknowledgments\n   The authors gratefully acknowledge the input of Mustapha\
    \ Aissaoui,\n   Dimitri Papadimitrou, Sasha Vainshtein, and Luca Martini.\n"
- title: 14.  References
  contents:
  - '14.  References

    '
- title: 14.1.  Normative References
  contents:
  - "14.1.  Normative References\n   [1] Bryant, S., Ed., and P. Pate, Ed., \"Pseudo\
    \ Wire Emulation Edge-\n       to-Edge (PWE3) Architecture\", RFC 3985, March\
    \ 2005.\n   [2] Andersson, L. and T. Madsen, \"Provider Provisioned Virtual\n\
    \       Private Network (VPN) Terminology\", RFC 4026, March 2005.\n   [3] Rosen,\
    \ E., Viswanathan, A., and R. Callon, \"Multiprotocol Label\n       Switching\
    \ Architecture\", RFC 3031, January 2001.\n   [4] Malis, A. and M. Townsley, \"\
    Pseudowire Emulation Edge-to-Edge\n       (PWE3) Fragmentation and Reassembly\"\
    , RFC 4623, August 2006.\n"
- title: 14.2.  Informative References
  contents:
  - "14.2.  Informative References\n   [5] Bitar, N., Ed., Bocci, M., Ed., and L.\
    \ Martini, Ed.,\n       \"Requirements for Multi-Segment Pseudowire Emulation\
    \ Edge-to-Edge\n       (PWE3)\", RFC 5254, October 2008.\n   [6] Niven-Jenkins,\
    \ B., Ed., Brungard, D., Ed., Betts, M., Ed.,\n       Sprecher, N., and S. Ueno,\
    \ \"Requirements of an MPLS Transport\n       Profile\", RFC 5654, September 2009.\n\
    \   [7] Bryant, S., Davie, B., Martini, L., and E. Rosen, \"Pseudowire\n     \
    \  Congestion Control Framework\", Work in Progress, June 2009.\n   [8] Bocci,\
    \ M., Bryant, S., and L. Levrau, \"A Framework for MPLS in\n       Transport Networks\"\
    , Work in Progress, August 2009.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Matthew Bocci\n   Alcatel-Lucent\n   Voyager Place, Shoppenhangers\
    \ Road,\n   Maidenhead, Berks, UK\n   Phone: +44 1633 413600\n   EMail: matthew.bocci@alcatel-lucent.com\n\
    \   Stewart Bryant\n   Cisco Systems\n   250, Longwater,\n   Green Park,\n   Reading,\
    \ RG2 6GB,\n   United Kingdom\n   EMail: stbryant@cisco.com\n"
