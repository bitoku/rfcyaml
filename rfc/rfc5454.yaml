- title: __initial_text__
  contents:
  - '                         Dual-Stack Mobile IPv4

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n"
- title: Abstract
  contents:
  - "Abstract\n   This specification provides IPv6 extensions to the Mobile IPv4\n\
    \   protocol.  The extensions allow a dual-stack node to use IPv4 and\n   IPv6\
    \ home addresses as well as to move between IPv4 and dual stack\n   network infrastructures.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Requirements Notation ......................................3\n  \
    \    1.2. Goals ......................................................3\n    \
    \  1.3. Non-Goals ..................................................4\n      1.4.\
    \ Implicit and Explicit Modes ................................4\n   2. Extension\
    \ Formats ...............................................4\n      2.1. IPv6 Prefix\
    \ Request Extension ..............................4\n      2.2. IPv6 Prefix Reply\
    \ Extension ................................5\n      2.3. IPv6 Tunneling Mode\
    \ Extension ..............................7\n   3. Mobile IP Registrations .........................................8\n\
    \      3.1. Registration Request .......................................8\n  \
    \    3.2. Registration Reply .........................................8\n    \
    \  3.3. Home Agent Considerations ..................................9\n      \
    \     3.3.1. IPv6 Reachability ..................................10\n        \
    \   3.3.2. Processing Intercepted IPv6 Packets ................10\n          \
    \ 3.3.3. IPv6 Multicast Membership Control ..................12\n      3.4. Foreign\
    \ Agent Considerations ..............................12\n      3.5. Mobile Node\
    \ Considerations ................................12\n      3.6. Tunneling Impacts\
    \ .........................................13\n      3.7. IPv6 Prefixes .............................................14\n\
    \           3.7.1. Dynamic IPv6 Prefix Delegation .....................14\n  \
    \    3.8. Deregistration of IPv6 Prefix .............................15\n    \
    \  3.9. Registration with a Private CoA ...........................15\n   4. Security\
    \ Considerations ........................................15\n   5. IANA Considerations\
    \ ............................................16\n   6. Acknowledgements ...............................................16\n\
    \   7. References .....................................................16\n  \
    \    7.1. Normative References ......................................16\n    \
    \  7.2. Informative References ....................................17\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv4 [RFC3344] allows a mobile node with an IPv4\
    \ address to\n   maintain communications while moving in an IPv4 network.\n  \
    \ Extensions defined in this document allow a node that has IPv4 and\n   IPv6\
    \ addresses [RFC2460] to maintain communications through any of\n   its addresses\
    \ while moving in IPv4 or dual stack networks.\n   Essentially, this specification\
    \ separates the Mobile IPv4 signaling\n   from the IP version of the traffic it\
    \ tunnels.  Mobile IPv4 with the\n   present extensions remains a signaling protocol\
    \ that runs over IPv4,\n   and yet can set up both IPv4 and IPv6 tunnels over\
    \ IPv4.\n   The aim is two-fold:\n      On one hand, Mobile IPv4 with the present\
    \ extensions becomes a\n      useful transition mechanism, allowing automated\
    \ but controlled\n      tunneling of IPv6 traffic over IPv4 tunnels.  Dual-stack\
    \ nodes in\n      dual-stack home networks can now roam to and from legacy IPv4\n\
    \      networks, while IPv4 mobile nodes and networks can migrate to IPv6\n  \
    \    without changing mobility management, and without upgrading all\n      network\
    \ nodes to IPv6 at once.\n      On the other hand, and more importantly, it allows\
    \ dual-stack\n      mobile nodes and networks to utilize a single protocol for\
    \ the\n      movement of both IPv4 and IPv6 stacks in the network topology.\n\
    \   Note that features like Mobile IPv6 [RFC3775] style route\n   optimization\
    \ will not be possible with this solution as it still\n   relies on Mobile IPv4\
    \ signaling, which does not provide route\n   optimization.\n"
- title: 1.1.  Requirements Notation
  contents:
  - "1.1.  Requirements Notation\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 1.2.  Goals
  contents:
  - "1.2.  Goals\n   a.  The solution supports the registration of IPv6 home prefix(es)\
    \ in\n       addition to regular IPv4 home address (HoA) registration.\n   b.\
    \  The solution supports static and dynamic IPv6 prefix delegation.\n"
- title: 1.3.  Non-Goals
  contents:
  - "1.3.  Non-Goals\n   a.  The solution does not provide support for IPv6 care-of\
    \ address\n       (CoA) registration.\n"
- title: 1.4.  Implicit and Explicit Modes
  contents:
  - "1.4.  Implicit and Explicit Modes\n   As defined in Network Mobility (NEMO) [RFC3963],\
    \ this specification\n   also supports two modes of operation; the implicit mode\
    \ and the\n   explicit mode.\n   In the implicit mode, the mobile node does not\
    \ include any IPv6\n   prefix request extensions in the registration request.\
    \  The home\n   agent can use any mechanism (not defined in this document) to\n\
    \   determine the IPv6 prefix(es) owned by the mobile node and to set up\n   forwarding\
    \ for these prefixes.  In this mode of operation, all\n   traffic to and from\
    \ the IPv6 prefixes MUST be encapsulated over the\n   IPv4 tunnel between the\
    \ mobile node's IPv4 home address and the IPv4\n   address of the home agent,\
    \ and as such, it is transparent to any\n   foreign agent in the path.  This IPv4\
    \ tunnel is established by\n   mechanisms that are out of the scope of this document\
    \ on both the\n   mobile node and home agent when operating in the implicit mode.\n\
    \   In the explicit mode, IPv6 bindings are signaled explicitly.  The\n   mobile\
    \ node includes one or more IPv6 prefix request extensions in\n   the registration\
    \ request, while the home agent returns corresponding\n   IPv6 prefix reply extensions\
    \ to accept/reject the IPv6 bindings.\n   Additionally, in the explicit mode,\
    \ the mobile node (when co-located\n   mode of operation is used) can indicate\
    \ whether IPv6 traffic should\n   be tunneled to the care-of address or the home\
    \ address of the mobile\n   node.\n   The rest of this specification is primarily\
    \ defining the explicit\n   mode.\n"
- title: 2.  Extension Formats
  contents:
  - "2.  Extension Formats\n   The following extensions are defined according to this\
    \ specification.\n"
- title: 2.1.  IPv6 Prefix Request Extension
  contents:
  - "2.1.  IPv6 Prefix Request Extension\n   A new skippable extension to the Mobile\
    \ IPv4 registration request\n   message in accordance to the short extension format\
    \ of [RFC3344] is\n   defined here.\n   This extension contains a Mobile IPv6\
    \ network prefix and its prefix\n   length.\n       0                   1    \
    \               2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Type     |   Length      |   Subtype     | Prefix Length |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                                                            +\n      |      \
    \                                                         |\n      +         \
    \          Mobile IPv6 Network Prefix                  +\n      |            \
    \                                                   |\n      +               \
    \                                                +\n      |                  \
    \                                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 1:  IPv6 Prefix Request Extension\n   Type\n      152\
    \ (Dual-Stack Mobile IPv4 (DSMIPv4) Extension)\n   Length\n      18\n   Subtype\n\
    \      1 (IPv6 Prefix Request)\n   Prefix Length\n      A sixteen-byte field containing\
    \ the Mobile IPv6 Network Prefix;\n      all insignificant (low-order) bits (beyond\
    \ the Prefix Length) MUST\n      be set to 0 by the originator of the option and\
    \ ignored by the\n      receiver.\n   Mobile IPv6 Network Prefix\n      A sixteen-byte\
    \ field containing the Mobile IPv6 Network Prefix\n"
- title: 2.2.  IPv6 Prefix Reply Extension
  contents:
  - "2.2.  IPv6 Prefix Reply Extension\n   A new skippable extension to the Mobile\
    \ IPv4 registration reply\n   message in accordance to the short extension format\
    \ of [RFC3344] is\n   defined here.\n   This extension defines a Mobile IPv6 Network\
    \ Prefix and its prefix\n   length, as well as a code.\n       0             \
    \      1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |   Subtype     |     Code      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \ Prefix Length |    Reserved   |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \                               +\n      |                                   \
    \                            |\n      +                                      \
    \                         +\n      |                                         \
    \                      |\n      +                   Mobile IPv6 Network Prefix\
    \                  +\n      |                                                \
    \               |\n      +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                   Figure 2: IPv6 Prefix Reply Extension\n   Type\n      152\
    \ (DSMIPv4 Extension)\n   Length\n      20\n   Subtype\n      2 (IPv6 Prefix Reply)\n\
    \   Code\n      A value indicating the result of the registration request with\n\
    \      respect to the IPv6 home prefix registration.  See below for\n      currently\
    \ defined Codes.\n   Prefix Length\n      Indicates the prefix length of the prefix\
    \ included in the Mobile\n      IPv6 Network Prefix field.  A value of 255 indicates\
    \ that a link-\n      local address is included in the Mobile IPv6 Network Prefix\
    \ field.\n   Reserved\n      Set to 0 by the sender, ignored by the receiver\n\
    \   Mobile IPv6 Network Prefix\n      A sixteen-byte field containing the Mobile\
    \ IPv6 Network Prefix;\n      all insignificant (low-order) bits (beyond the Prefix\
    \ Length) MUST\n      be set to 0 by the originator of the option and ignored\
    \ by the\n      receiver.\n   The following values are defined for use as a Code\
    \ value in the above\n   extension:\n      0 registration accepted, IPv6 to be\
    \ tunneled to HoA\n      1 registration accepted, IPv6 to be tunneled to CoA\n\
    \      8 registration rejected, reason unspecified\n      9 registration rejected,\
    \ administratively prohibited\n   Note that a registration reply that does not\
    \ include an IPv6 prefix\n   reply extension, when received in response to a registration\
    \ request\n   carrying at least one instance of the IPv6 prefix request extension,\n\
    \   indicates that the home agent does not support IPv6 extensions and\n   thus\
    \ has ignored such extensions in the registration request.\n"
- title: 2.3.  IPv6 Tunneling Mode Extension
  contents:
  - "2.3.  IPv6 Tunneling Mode Extension\n   A new skippable extension to the Mobile\
    \ IPv4 registration request\n   message in accordance to the short extension format\
    \ of [RFC3344] is\n   defined here.\n   By including this extension in a registration\
    \ request, the sender\n   indicates that IPv6 traffic can be tunneled to the mobile\
    \ node's CoA.\n   0                   1                   2                  \
    \ 3\n   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |   Length      |    Subtype    |   Reserved    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                  Figure 3: IPv6 Tunneling Mode Extension\n   Type\n      152\
    \ (DSMIPv4 Extension)\n   Length\n      2\n   Subtype\n      3 (IPv6 Tunneling\
    \ Mode)\n   Reserved\n      Set to 0 by the sender, ignored by the receiver\n"
- title: 3.  Mobile IP Registrations
  contents:
  - '3.  Mobile IP Registrations

    '
- title: 3.1.  Registration Request
  contents:
  - "3.1.  Registration Request\n   A mobile node MAY include in a registration request\
    \ one or more IPv6\n   prefix request extensions defined in this specification.\n\
    \   A mobile node MAY also include exactly one IPv6 tunneling mode\n   extension\
    \ when it uses the co-located care-of address mode of\n   [RFC3344].\n   When\
    \ IPv6 prefix and/or IPv6 tunneling mode extensions are used by\n   the mobile\
    \ IP client, they MUST be placed after the registration\n   request header and\
    \ before the mobile -- home authentication extension\n   so they MUST be included\
    \ in the computation of any authentication\n   extension.\n"
- title: 3.2.  Registration Reply
  contents:
  - "3.2.  Registration Reply\n   The mechanism described in this specification depends\
    \ on skippable\n   extensions.  For that reason, a registration reply that does\
    \ not\n   include an IPv6 prefix reply extension, in response to a registration\n\
    \   request including an IPv6 prefix request extension, indicates that\n   the\
    \ home agent does not support IPv6 extensions and has ignored the\n   request.\n\
    \   If an IPv6 prefix reply extension is included in a registration\n   reply,\
    \ then the extension indicates the success or failure of the\n   IPv6 prefix registration.\
    \  The IPv6 prefix reply extension does not\n   affect, in any way, the code value\
    \ in the registration reply header\n   but it is superseded by it.  In other words,\
    \ if the code field in the\n   registration reply header is set to a reject code,\
    \ then all IPv6\n   prefix request extensions are also rejected.  If the code\
    \ field in\n   the registration reply header, however, is set to an accept code,\n\
    \   then an IPv6 prefix reply extension with a code field set to a reject\n  \
    \ code only rejects the binding for the specific IPv6 prefix indicated\n   in\
    \ the same extension.\n   Note that a rejecting IPv6 prefix reply extension has\
    \ the same effect\n   as not including such an extension at all, in the sense\
    \ that, in both\n   cases, the mobile node must act as if the corresponding IPv6\
    \ prefix\n   request extension included in the registration request was rejected.\n\
    \   Of course, the inclusion of the IPv6 prefix reply extension allows\n   the\
    \ home agent to indicate why a given IPv6 prefix request extension\n   was rejected.\
    \  A detailed description of how the mobile node handles\n   different IPv6 prefix\
    \ reply extension code values and the absence of\n   IPv6 prefix reply extensions\
    \ is given in Section 3.5.\n"
- title: 3.3.  Home Agent Considerations
  contents:
  - "3.3.  Home Agent Considerations\n   The dual-stack home agent defined in this\
    \ specification is a Mobile\n   IPv4 home agent in that, it MUST operate as defined\
    \ in MIPv4\n   [RFC3344].  In addition to that, the following mechanisms are defined\n\
    \   in this specification.\n   For each IPv6 prefix request extension included\
    \ in a valid\n   registration request, a home agent that supports this specification\n\
    \   SHOULD include a corresponding IPv6 prefix reply extension in the\n   registration\
    \ reply message.  The home agent MUST NOT include more\n   than one IPv6 prefix\
    \ reply extension for the same prefix.  For each\n   accepted IPv6 prefix, the\
    \ home agent MUST decide the tunneling mode\n   it is going to use and set the\
    \ code field of the IPv6 prefix reply\n   extension to the appropriate value.\
    \  The IPv6 prefix field of each of\n   the IPv6 prefix reply extensions included\
    \ in the registration reply\n   MUST match the IPv6 prefix field of an IPv6 prefix\
    \ request extension\n   included in the corresponding registration request message.\n\
    \   When the home agent sends a successful registration reply to the\n   mobile\
    \ node, with the code field of a corresponding IPv6 prefix reply\n   extension\
    \ set to one of the \"registration accepted\" values, the home\n   agent indicates\
    \ that the IPv6 prefix is registered for the lifetime\n   granted for the binding.\
    \  It also indicates the tunneling mode used\n   i.e., tunneling to home address\
    \ or care-of address, based on the\n   value of the code field used in the IPv6\
    \ prefix reply extension.\n   Note that since only IPv6 prefixes (and not addresses)\
    \ are supported\n   by this specification, there is no need for Duplicate Address\n\
    \   Detection.  The home agent, however, MUST check that registered\n   prefixes\
    \ are not overlapping so that all addresses under each\n   registered prefix belong\
    \ to a single mobile node at any one time.\n   These prefixes MUST NOT appear\
    \ as on-link to any other node (e.g.,\n   via Router Advertisements).\n"
- title: 3.3.1.  IPv6 Reachability
  contents:
  - "3.3.1.  IPv6 Reachability\n   For each registered IPv6 prefix, the home agent\
    \ MUST advertise its\n   reachability as defined in NEMO Section 6.3 of [RFC3963].\n"
- title: 3.3.2.  Processing Intercepted IPv6 Packets
  contents:
  - "3.3.2.  Processing Intercepted IPv6 Packets\n   A dual-stack home agent that\
    \ supports the IPv6 extensions defined in\n   this specification MUST keep track\
    \ of the following IPv6 related\n   state for the mobile nodes it supports, in\
    \ addition to the state\n   defined in [RFC3344].\n   - Registered IPv6 prefix(es)\
    \ and prefix length(s).\n   - Tunneling mode for IPv6 traffic:\n      - Tunnel\
    \ to IPv4 HoA and accept IPv6 tunneled from IPv4 HoA.\n      - Tunnel to CoA and\
    \ accept IPv6 tunneled from CoA.\n   When IPv6 traffic is encapsulated over the\
    \ tunnel between the home\n   agent (HA) and the mobile node's care-of address,\
    \ the tunneling\n   mechanism used should be the same as the mechanism negotiated\
    \ by the\n   Mobile IP header as defined in MIPv4 [RFC3344].  In that case, when\n\
    \   IPinIP encapsulation is negotiated, IPv6 is tunneled over IPv4\n   according\
    \ to [RFC4213].  Generic Routing Encapsulation (GRE) also\n   allows tunneling\
    \ of IPv6 packets by setting the Protocol Type\n   [RFC2784] field, to the appropriate\
    \ payload type defined for IPv6 by\n   IANA.  Minimal Encapsulation [RFC2004]\
    \ cannot be used, since the\n   second (inner) IP header is IPv6, which is not\
    \ supported by\n   [RFC2004].\n   When IPv6 traffic is encapsulated over the tunnel\
    \ between the HA and\n   the mobile node's home address, IPv6 is always tunneled\
    \ over IPv4\n   according to [RFC4213].  The resulting IPv4 packet is then delivered\n\
    \   just like any other IPv4 packet addressed to the IPv4 HoA (using the\n   tunneling\
    \ for normal IPv4 traffic, possibly going via the foreign\n   agent (FA)).\n \
    \  Tunneling mode selection for IPv6 traffic depends on the following\n   parameters\
    \ in a successful registration request:\n   1)  A registration request is received\
    \ with one or more IPv6 prefix\n       request extensions.  An IPv6 tunneling\
    \ mode extension is not\n       included.\n          All IPv6 packets destined\
    \ to the registered IPv6 prefix(es)\n          MUST be tunneled by the home agent\
    \ to the registered IPv4 home\n          address of the mobile node.  The home\
    \ agent first encapsulates\n          the IPv6 packet, addressing it to the mobile\
    \ node's IPv4 home\n          address, and then tunnels this encapsulated packet\
    \ to the\n          foreign agent.  This extra level of encapsulation is required\n\
    \          so that IPv6 routing remains transparent to a foreign agent\n     \
    \     that does not support IPv6.  When received by the foreign\n          agent,\
    \ the unicast encapsulated packet is de-tunneled and\n          delivered to the\
    \ mobile node in the same way as any other\n          packet.  The mobile node\
    \ must decapsulate the received IPv4\n          packet in order to recover the\
    \ original IPv6 packet.\n          Additionally, the home agent MUST be prepared\
    \ to accept\n          reverse-tunneled packets from the IPv4 home address of\
    \ the\n          mobile node encapsulating IPv6 packets sent by that mobile\n\
    \          node.\n   2)  A registration request is received with one or more IPv6\
    \ prefix\n       request extensions.  An IPv6 tunneling mode extension is\n  \
    \     included.\n          All IPv6 packets destined to the registered IPv6 prefix(es)\n\
    \          SHOULD be tunneled by the home agent to the registered care-of\n  \
    \        address of the mobile node.  Additionally, the home agent\n         \
    \ SHOULD be prepared to accept reverse-tunneled packets from the\n          care-of\
    \ address of the mobile node encapsulating IPv6 packets\n          sent by that\
    \ mobile node.  The home agent MAY ignore the\n          presence of the IPv6\
    \ tunneling mode extension and act as in\n          case (1) above.\n   The home\
    \ agent MUST check that all inner IPv6 packets received from\n   the mobile node\
    \ over a tunnel with the mobile node's home address or\n   the care-of address\
    \ as the outer source address, include a source\n   address that falls under the\
    \ registered IPv6 prefix(es) for that\n   mobile node.  If the source address\
    \ of the outer header of a tunneled\n   packet is not the registered IPv4 care-of\
    \ address or the registered\n   IPv4 home addresses, the packet SHOULD be dropped.\
    \  If the source\n   address of the inner header of an tunneled packet does not\
    \ match any\n   of the registered prefixes, the packet SHOULD be dropped.\n  \
    \ Multicast packets addressed to a group to which the mobile node has\n   successfully\
    \ subscribed, MUST be tunneled to the mobile node.\n"
- title: 3.3.3.  IPv6 Multicast Membership Control
  contents:
  - "3.3.3.  IPv6 Multicast Membership Control\n   IPv6 multicast membership control\
    \ is provided as defined in MIPv6\n   [RFC3775], Section 10.4.3.  The only clarification\
    \ required for the\n   purpose of this specification is that all Multicast Listener\n\
    \   Discovery (MLD) [RFC2710] or MLDv2 [RFC3810] messages between the\n   mobile\
    \ node and the home agent MUST be tunneled over an IPv4 tunnel\n   between the\
    \ mobile node's IPv4 home address and the home agent's IPv4\n   address, bypassing\
    \ the foreign agent.  Note that if tunneling to the\n   care-of address has been\
    \ negotiated for other traffic, then the rest\n   of the traffic continues using\
    \ this tunnel.\n"
- title: 3.4.  Foreign Agent Considerations
  contents:
  - "3.4.  Foreign Agent Considerations\n   This specification does not affect the\
    \ operation of the foreign\n   agent.\n"
- title: 3.5.  Mobile Node Considerations
  contents:
  - "3.5.  Mobile Node Considerations\n   A dual-stack mobile node that supports the\
    \ extensions described in\n   this document MAY use these extensions to register\
    \ its IPv6\n   prefix(es) while moving between access routers.\n   The mobile\
    \ node MAY include one or more IPv6 prefix request\n   extension(s) in the registration\
    \ request.\n   In this case, the mobile node MUST take the following action\n\
    \   depending on the extensions included in the registration reply it\n   receives\
    \ in response to the registration request:\n   1)  The registration reply does\
    \ not include any IPv6 prefix reply\n       extensions.\n          The mobile\
    \ node MUST assume that the home agent does not\n          support the extensions\
    \ defined in this specification.  The\n          mobile node SHOULD continue to\
    \ operate according to MIPv4\n          [RFC3344].\n   2)  The registration reply\
    \ includes one or more IPv6 prefix reply\n       extensions.\n          The mobile\
    \ node MUST match each IPv6 prefix reply extension\n          with one of the\
    \ IPv6 prefix request extensions included\n          earlier in the corresponding\
    \ registration request message.\n          If a matching IPv6 prefix reply extension\
    \ is not included for\n          one or more of corresponding IPv6 prefix request\
    \ extensions\n          included in the registration request message, the mobile\
    \ node\n          MUST assume that these IPv6 prefixes are rejected.\n       \
    \   For each matching IPv6 prefix reply extension, the mobile node\n         \
    \ MUST inspect the code field.  If the field is set to a\n          rejection\
    \ code, then the corresponding IPv6 prefix\n          registration has been rejected.\
    \  If the code field is set to\n          an acceptance code, then the corresponding\
    \ IPv6 prefix\n          registration has been accepted.\n          If the code\
    \ field is set to \"0\", then the mobile node MUST be\n          prepared to send/receive\
    \ IPv6 packets encapsulated in the\n          bidirectional tunnel between the\
    \ home agent address and the\n          registered IPv4 home address of the mobile\
    \ node.\n          If the code field is set to \"1\", then the mobile node MUST\
    \ act\n          as follows:\n          -  Assuming the co-located care-of address\
    \ mode is used, the\n             mobile node MUST be prepared to send/receive\
    \ IPv6 packets\n             over the bidirectional tunnel between the home agent\n\
    \             address and its co-located care-of address.  Otherwise, the\n  \
    \           mobile node SHOULD act as in the case where the code field\n     \
    \        is set to \"0\".\n   The mobile node SHOULD include exactly one IPv6\
    \ tunneling mode\n   extension if it uses the co-located care-of address model\
    \ and it\n   wants to request that IPv6 packets are tunneled to its co-located\n\
    \   care-of address.  If the mobile node uses the co-located care-of\n   address\
    \ model but it does not include the IPv6 tunneling mode\n   extension, the home\
    \ agent will tunnel IPv6 traffic to the mobile\n   node's IPv4 home address. \
    \ The mobile node MUST NOT include an IPv6\n   tunneling mode extension if it\
    \ uses the foreign agent care-of address\n   mode of operation.  Note that if\
    \ the mobile node includes an IPv6\n   tunneling mode extension in this case,\
    \ IPv6 packets could be tunneled\n   to the FA by the HA.  The FA is then likely\
    \ to drop them since it\n   will not have appropriate state to process them.\n"
- title: 3.6.  Tunneling Impacts
  contents:
  - "3.6.  Tunneling Impacts\n   When IPv6 runs over an IPv4 tunnel, the IPv6 tunnel\
    \ endpoints can\n   treat the IPv4 tunnel as a single hop link as defined in [RFC4213].\n\
    \   The two tunnel endpoints, e.g., mobile node and home agent, MUST\n   configure\
    \ link-local IPv6 addresses as defined in Section 3.7 of\n   [RFC4213], while\
    \ they MUST also adhere to the neighbor discovery\n   requirements of the same\
    \ specification, Section 3.8, and the hop\n   limit requirements of Section 3.3.\n\
    \   With respect to the Tunnel MTU, an implementation MUST support the\n   Static\
    \ Tunnel MTU approach as defined in Section 3.2 of [RFC4213].\n   Implementation\
    \ and use of the Dynamic Tunnel MTU method defined in\n   the same section of\
    \ [RFC4213] is OPTIONAL.\n   To accommodate traffic that uses Explicit Congestion\
    \ Notification\n   (ECN), it is RECOMMENDED that the ECN and Diffserv Code Point\
    \ (DSCP)\n   information is copied between the inner and outer header as defined\n\
    \   in [RFC3168] and [RFC2983].  It is RECOMMENDED that the full-\n   functionality\
    \ option defined in Section 9.1.1 of [RFC3168] be used to\n   deal with ECN.\n"
- title: 3.7.  IPv6 Prefixes
  contents:
  - "3.7.  IPv6 Prefixes\n   An implementation can use any number of mechanisms to\
    \ allocate IPv6\n   prefixes to a mobile node.  Once one or more IPv6 prefixes\
    \ are\n   allocated, they can be registered using the extensions and mechanism\n\
    \   already described in this specification.\n   How a home agent decides to accept\
    \ an IPv6 prefix for a given mobile\n   node is out of scope of this specification.\
    \  Local configuration or\n   external authorization via an authorization system,\
    \ e.g., Diameter\n   [RFC3588], or other mechanisms may be used to make such\n\
    \   determination.\n"
- title: 3.7.1.  Dynamic IPv6 Prefix Delegation
  contents:
  - "3.7.1.  Dynamic IPv6 Prefix Delegation\n   A dual-stack mobile node MAY use prefix\
    \ delegation as defined in\n   DHCPv6 Prefix Delegation [RFC3633] to get access\
    \ to IPv6 prefixes.\n   In that case, if the mobile node is not directly attached\
    \ to its home\n   agent, the mobile node MUST first register its IPv4 home address\
    \ as\n   per MIPv4 [RFC3344].  When that is done, the mobile node can generate\n\
    \   a link-local IPv6 address as per Section 3.7 of [RFC4213].  The\n   mobile\
    \ node then sends a registration request to its home agent,\n   including an IPv6\
    \ prefix request extension with the prefix length\n   field set to 255 and setting\
    \ the Mobile IPv6 Network Prefix field to\n   the locally generated link-local\
    \ address.  If the registration reply\n   message includes an IPv6 prefix reply\
    \ extension with the code field\n   set to a success code, the mobile node can\
    \ use the tunnel to send and\n   receive IPv6 link-local packets.  The mobile\
    \ node can now send DHCPv6\n   messages according to [RFC3633].  All IPv6 messages\
    \ at this stage\n   MUST be tunneled over the IPv4 tunnel between the mobile node's\
    \ IPv4\n   home address and the home agent's IPv4 address.\n   Once prefixes are\
    \ delegated, and assuming explicit mode is used, the\n   mobile node SHOULD send\
    \ a registration request with the appropriate\n   IPv6 prefix request extensions\
    \ to the home agent to register the\n   delegated prefixes.\n"
- title: 3.8.  Deregistration of IPv6 Prefix
  contents:
  - "3.8.  Deregistration of IPv6 Prefix\n   The mobile IP registration lifetime included\
    \ in the registration\n   request header is valid for all the bindings created\
    \ by the\n   registration request, which may include bindings for IPv6 prefix(es).\n\
    \   A registration request with a zero lifetime can be used to remove all\n  \
    \ bindings from the home agent.\n   A re-registration request with non-zero lifetime\
    \ can be used to\n   deregister some of the registered IPv6 prefixes by not including\n\
    \   corresponding IPv6 prefix request extensions in the registration\n   request\
    \ message.\n"
- title: 3.9.  Registration with a Private CoA
  contents:
  - "3.9.  Registration with a Private CoA\n   If the care-of address is a private\
    \ address, then Mobile IP NAT\n   Traversal as [RFC3519] MAY be used in combination\
    \ with the extensions\n   described in this specification.  In that case, to transport\
    \ IPv6\n   packets, the next header field of the Mobile Tunnel Data message\n\
    \   header [RFC3519] MUST be set to the value for IPv6.  Note that in\n   that\
    \ case, the encapsulation field of the UDP Tunnel Request\n   Extension defined\
    \ in [RFC3519] MUST be set to zero.\n"
- title: 4.  Security Considerations
  contents:
  - "4.  Security Considerations\n   This specification operates in the security constraints\
    \ and\n   requirements of [RFC3344].  It extends the operations defined in\n \
    \  [RFC3344] for IPv4 home addresses to cover home IPv6 prefixes and\n   provides\
    \ the same level of security for both IP address versions.\n   Home agents MUST\
    \ perform appropriate checks for reverse-tunneled IPv6\n   packets similar to\
    \ what is defined in [RFC3024] for IPv4 packets.\n   The check defined in [RFC3024]\
    \ requires that the outer header's\n   source address is set to a registered care-of\
    \ address for the mobile\n   node and as such the same check protects from attacks\
    \ whether the\n   encapsulated (inner) header is IPv4 or IPv6.\n   In addition\
    \ to that, the home agent MUST check that the source\n   address of the inner\
    \ header is a registered IPv4 home address or IPv6\n   prefix for this mobile\
    \ node.  If that is not the case, the home agent\n   SHOULD silently discard the\
    \ packet and log the event as a security\n   exception.\n   Security devices should\
    \ look for IPv6 packets encapsulated over IPv4\n   either directly to the mobile\
    \ node's care-of address or via double\n   encapsulation first to the mobile node's\
    \ IPv4 home address and then\n   to the mobile node's care-of address.  Interactions\
    \ with Mobile IPv4\n   and IPsec have been covered elsewhere, for instance in\
    \ [RFC5265] and\n   [RFC5266].\n"
- title: 5.  IANA Considerations
  contents:
  - "5.  IANA Considerations\n   A new type number (152) for DSMIPv4 extensions has\
    \ been registered\n   from the space of numbers for skippable mobility extensions\
    \ (i.e.,\n   128-255), defined for Mobile IPv4 [RFC3344].  This registry is\n\
    \   available from http://www.iana.org under \"Extensions appearing in\n   Mobile\
    \ IP control messages\".\n   A new subtype space for the type number of this extension\
    \ has been\n   created: \"DSMIPv4 Extension subtypes\".  The subtype values 1,\
    \ 2, and\n   3 are defined in this specification, while the rest of the subtypes\n\
    \   are reserved and available for allocation based on Expert Review.\n   Finally,\
    \ a new space for the code field of the IPv6 prefix reply\n   extension has been\
    \ created: \"IPv6 Prefix Reply Extension Codes\".\n   Values 0, 1, 8, and 9 are\
    \ defined in this specification.  Values 2-7\n   are reserved for accept codes,\
    \ and values 10-255 are reserved for\n   reject codes.\n   Similar to the procedures\
    \ specified for Mobile IPv4 [RFC3344] number\n   spaces, future allocations from\
    \ the two number spaces require Expert\n   Review [RFC5226].\n"
- title: 6.  Acknowledgements
  contents:
  - "6.  Acknowledgements\n   Thanks to Pat Calhoun, Paal Engelstad, Tom Hiller, and\
    \ Pete McCann\n   for earlier work on this subject.  Thanks also to Alex Petrescu\
    \ for\n   various suggestions.  Special thanks also to Sri Gundavelli and Kent\n\
    \   Leung for their thorough review and suggestions.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC2460]  Deering, S. and R. Hinden, \"Internet Protocol, Version\
    \ 6\n              (IPv6) Specification\", RFC 2460, December 1998.\n   [RFC3024]\
    \  Montenegro, G., \"Reverse Tunneling for Mobile IP,\n              revised\"\
    , RFC 3024, January 2001.\n   [RFC3344]  Perkins, C., \"IP Mobility Support for\
    \ IPv4\", RFC 3344,\n              August 2002.\n   [RFC3519]  Levkowetz, H. and\
    \ S. Vaarala, \"Mobile IP Traversal of\n              Network Address Translation\
    \ (NAT) Devices\", RFC 3519,\n              April 2003.\n   [RFC3633]  Troan,\
    \ O. and R. Droms, \"IPv6 Prefix Options for Dynamic\n              Host Configuration\
    \ Protocol (DHCP) version 6\", RFC 3633,\n              December 2003.\n   [RFC3775]\
    \  Johnson, D., Perkins, C., and J. Arkko, \"Mobility Support\n              in\
    \ IPv6\", RFC 3775, June 2004.\n   [RFC3963]  Devarapalli, V., Wakikawa, R., Petrescu,\
    \ A., and P.\n              Thubert, \"Network Mobility (NEMO) Basic Support Protocol\"\
    ,\n              RFC 3963, January 2005.\n   [RFC4213]  Nordmark, E. and R. Gilligan,\
    \ \"Basic Transition Mechanisms\n              for IPv6 Hosts and Routers\", RFC\
    \ 4213, October 2005.\n   [RFC5226]  Narten, T. and H. Alvestrand, \"Guidelines\
    \ for Writing an\n              IANA Considerations Section in RFCs\", BCP 26,\
    \ RFC 5226,\n              May 2008.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [RFC2004]  Perkins, C., \"Minimal Encapsulation\
    \ within IP\", RFC 2004,\n              October 1996.\n   [RFC2710]  Deering,\
    \ S., Fenner, W., and B. Haberman, \"Multicast\n              Listener Discovery\
    \ (MLD) for IPv6\", RFC 2710,\n              October 1999.\n   [RFC2784]  Farinacci,\
    \ D., Li, T., Hanks, S., Meyer, D., and P.\n              Traina, \"Generic Routing\
    \ Encapsulation (GRE)\", RFC 2784,\n              March 2000.\n   [RFC2983]  Black,\
    \ D., \"Differentiated Services and Tunnels\",\n              RFC 2983, October\
    \ 2000.\n   [RFC3168]  Ramakrishnan, K., Floyd, S., and D. Black, \"The Addition\n\
    \              of Explicit Congestion Notification (ECN) to IP\",\n          \
    \    RFC 3168, September 2001.\n   [RFC3588]  Calhoun, P., Loughney, J., Guttman,\
    \ E., Zorn, G., and J.\n              Arkko, \"Diameter Base Protocol\", RFC 3588,\
    \ September 2003.\n   [RFC3810]  Vida, R. and L. Costa, \"Multicast Listener Discovery\n\
    \              Version 2 (MLDv2) for IPv6\", RFC 3810, June 2004.\n   [RFC5265]\
    \  Vaarala, S. and E. Klovning, \"Mobile IPv4 Traversal across\n             \
    \ IPsec-Based VPN Gateways\", RFC 5265, June 2008.\n   [RFC5266]  Devarapalli,\
    \ V. and P. Eronen, \"Secure Connectivity and\n              Mobility Using Mobile\
    \ IPv4 and IKEv2 Mobility and\n              Multihoming (MOBIKE)\", BCP 136,\
    \ RFC 5266, June 2008.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   George Tsirtsis\n   Qualcomm\n   EMail: tsirtsis@googlemail.com\n\
    \   Vincent Park\n   Qualcomm\n   Phone: +908-947-7084\n   EMail: vpark@qualcomm.com\n\
    \   Hesham Soliman\n   Elevate Technologies\n   Phone: +614-111-410-445\n   EMail:\
    \ hesham@elevatemobile.com\n"
