- title: __initial_text__
  contents:
  - '                     BGP Monitoring Protocol (BMP)

    '
- title: Abstract
  contents:
  - "Abstract\n   This document defines the BGP Monitoring Protocol (BMP), which can\
    \ be\n   used to monitor BGP sessions.  BMP is intended to provide a\n   convenient\
    \ interface for obtaining route views.  Prior to the\n   introduction of BMP,\
    \ screen scraping was the most commonly used\n   approach to obtaining such views.\
    \  The design goals are to keep BMP\n   simple, useful, easily implemented, and\
    \ minimally service affecting.\n   BMP is not suitable for use as a routing protocol.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc7854.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2016 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   4\n     1.1.  Requirements Language . . . . . . . . . . . . . .\
    \ . . . .   4\n   2.  Definitions . . . . . . . . . . . . . . . . . . . . . .\
    \ . . .   4\n   3.  Overview of BMP Operation . . . . . . . . . . . . . . . .\
    \ . .   4\n     3.1.  BMP Messages  . . . . . . . . . . . . . . . . . . . . .\
    \ .   4\n     3.2.  Connection Establishment and Termination  . . . . . . . .\
    \   5\n     3.3.  Lifecycle of a BMP Session  . . . . . . . . . . . . . . .  \
    \ 6\n   4.  BMP Message Format  . . . . . . . . . . . . . . . . . . . . .   7\n\
    \     4.1.  Common Header . . . . . . . . . . . . . . . . . . . . . .   7\n  \
    \   4.2.  Per-Peer Header . . . . . . . . . . . . . . . . . . . . .   8\n    \
    \ 4.3.  Initiation Message  . . . . . . . . . . . . . . . . . . .  10\n     4.4.\
    \  Information TLV . . . . . . . . . . . . . . . . . . . . .  10\n     4.5.  Termination\
    \ Message . . . . . . . . . . . . . . . . . . .  11\n     4.6.  Route Monitoring\
    \  . . . . . . . . . . . . . . . . . . . .  12\n     4.7.  Route Mirroring . .\
    \ . . . . . . . . . . . . . . . . . . .  12\n     4.8.  Stats Reports . . . .\
    \ . . . . . . . . . . . . . . . . . .  13\n     4.9.  Peer Down Notification \
    \ . . . . . . . . . . . . . . . . .  16\n     4.10. Peer Up Notification  . .\
    \ . . . . . . . . . . . . . . . .  17\n   5.  Route Monitoring  . . . . . . .\
    \ . . . . . . . . . . . . . . .  18\n   6.  Route Mirroring . . . . . . . . .\
    \ . . . . . . . . . . . . . .  19\n   7.  Stat Reports  . . . . . . . . . . .\
    \ . . . . . . . . . . . . .  19\n   8.  Other Considerations  . . . . . . . .\
    \ . . . . . . . . . . . .  20\n     8.1.  Multiple Instances  . . . . . . . .\
    \ . . . . . . . . . . .  20\n     8.2.  Locally Originated Routes . . . . . .\
    \ . . . . . . . . . .  20\n   9.  Using BMP . . . . . . . . . . . . . . . . .\
    \ . . . . . . . . .  20\n   10. IANA Considerations . . . . . . . . . . . . .\
    \ . . . . . . . .  21\n     10.1.  BMP Message Types  . . . . . . . . . . . .\
    \ . . . . . . .  21\n     10.2.  BMP Peer Types . . . . . . . . . . . . . . .\
    \ . . . . . .  21\n     10.3.  BMP Peer Flags . . . . . . . . . . . . . . . .\
    \ . . . . .  22\n     10.4.  BMP Statistics Types . . . . . . . . . . . . . .\
    \ . . . .  22\n     10.5.  BMP Initiation Message TLVs  . . . . . . . . . . .\
    \ . . .  23\n     10.6.  BMP Termination Message TLVs . . . . . . . . . . . .\
    \ . .  23\n     10.7.  BMP Termination Message Reason Codes . . . . . . . . .\
    \ .  23\n     10.8.  BMP Peer Down Reason Codes . . . . . . . . . . . . . . .\
    \  24\n     10.9.  Route Mirroring TLVs . . . . . . . . . . . . . . . . . .  24\n\
    \     10.10. BMP Route Mirroring Information Codes  . . . . . . . . .  24\n  \
    \ 11. Security Considerations . . . . . . . . . . . . . . . . . . .  25\n   12.\
    \ References  . . . . . . . . . . . . . . . . . . . . . . . . .  25\n     12.1.\
    \  Normative References . . . . . . . . . . . . . . . . . .  25\n     12.2.  Informative\
    \ References . . . . . . . . . . . . . . . . .  26\n   Acknowledgements  . . .\
    \ . . . . . . . . . . . . . . . . . . . . .  27\n   Authors' Addresses  . . .\
    \ . . . . . . . . . . . . . . . . . . . .  27\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Many researchers and network operators wish to have access\
    \ to the\n   contents of routers' BGP Routing Information Bases (RIBs) as well\
    \ as\n   a view of protocol updates the router is receiving.  This monitoring\n\
    \   task cannot be realized by standard protocol mechanisms.  Prior to\n   the\
    \ introduction of BMP, this data could only be obtained through\n   screen scraping.\n\
    \   BMP provides access to the Adj-RIB-In of a peer on an ongoing basis\n   and\
    \ a periodic dump of certain statistics the monitoring station can\n   use for\
    \ further analysis.  From a high level, BMP can be thought of\n   as the result\
    \ of multiplexing together the messages received on the\n   various monitored\
    \ BGP sessions.\n"
- title: 1.1.  Requirements Language
  contents:
  - "1.1.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted\
    \ as described in RFC\n   2119 [RFC2119].\n"
- title: 2.  Definitions
  contents:
  - "2.  Definitions\n   o  Adj-RIB-In: As defined in [RFC4271], \"The Adj-RIBs-In\
    \ contains\n      unprocessed routing information that has been advertised to\
    \ the\n      local BGP speaker by its peers.\"  This is also referred to as the\n\
    \      pre-policy Adj-RIB-In in this document.\n   o  Post-Policy Adj-RIB-In:\
    \ The result of applying inbound policy to\n      an Adj-RIB-In, but prior to\
    \ the application of route selection to\n      form the Loc-RIB.\n"
- title: 3.  Overview of BMP Operation
  contents:
  - '3.  Overview of BMP Operation

    '
- title: 3.1.  BMP Messages
  contents:
  - "3.1.  BMP Messages\n   The following are the messages provided by BMP:\n   o\
    \  Route Monitoring (RM): Used to provide an initial dump of all\n      routes\
    \ received from a peer, as well as an ongoing mechanism that\n      sends the\
    \ incremental routes advertised and withdrawn by a peer to\n      the monitoring\
    \ station.\n   o  Peer Down Notification: A message sent to indicate that a peering\n\
    \      session has gone down with information indicating the reason for\n    \
    \  the session disconnect.\n   o  Stats Reports (SR): An ongoing dump of statistics\
    \ that can be used\n      by the monitoring station as a high-level indication\
    \ of the\n      activity going on in the router.\n   o  Peer Up Notification:\
    \ A message sent to indicate that a peering\n      session has come up.  The message\
    \ includes information regarding\n      the data exchanged between the peers in\
    \ their OPEN messages, as\n      well as information about the peering TCP session\
    \ itself.  In\n      addition to being sent whenever a peer transitions to the\n\
    \      Established state, a Peer Up Notification is sent for each peer in\n  \
    \    the Established state when the BMP session itself comes up.\n   o  Initiation:\
    \ A means for the monitored router to inform the\n      monitoring station of\
    \ its vendor, software version, and so on.\n   o  Termination: A means for the\
    \ monitored router to inform the\n      monitoring station of why it is closing\
    \ a BMP session.\n   o  Route Mirroring: A means for the monitored router to send\
    \ verbatim\n      duplicates of messages as received.  Can be used to exactly\
    \ mirror\n      a monitored BGP session.  Can also be used to report malformed\
    \ BGP\n      Protocol Data Units (PDUs).\n"
- title: 3.2.  Connection Establishment and Termination
  contents:
  - "3.2.  Connection Establishment and Termination\n   BMP operates over TCP.  All\
    \ options are controlled by configuration\n   on the monitored router.  No BMP\
    \ message is ever sent from the\n   monitoring station to the monitored router.\
    \  The monitored router MAY\n   take steps to prevent the monitoring station from\
    \ sending data (for\n   example, by half-closing the TCP session or setting its\
    \ window size\n   to 0) or it MAY silently discard any data sent by the monitoring\n\
    \   station.\n   The router may be monitored by one or more monitoring stations.\
    \  With\n   respect to each (router and monitoring station) pair, one party is\n\
    \   active with respect to TCP session establishment, and the other party\n  \
    \ is passive.  Which party is active and which is passive is controlled\n   by\
    \ configuration.\n   The passive party is configured to listen on a particular\
    \ TCP port\n   and the active party is configured to establish a connection to\
    \ that\n   port.  If the active party is unable to connect to the passive party,\n\
    \   it periodically retries the connection.  Retries MUST be subject to\n   some\
    \ variety of backoff.  Exponential backoff with a default initial\n   backoff\
    \ of 30 seconds and a maximum of 720 seconds is suggested.\n   The router MAY\
    \ restrict the set of IP addresses from which it will\n   accept connections.\
    \  It SHOULD restrict the number of simultaneous\n   connections it will permit\
    \ from a given IP address.  The default\n   value for this restriction SHOULD\
    \ be 1, though an implementation MAY\n   permit this restriction to be disabled\
    \ in configuration.  The router\n   MUST also restrict the rate at which sessions\
    \ may be established.  A\n   suggested default is an establishment rate of 2 sessions\
    \ per minute.\n   A router (or management station) MAY implement logic to detect\n\
    \   redundant connections, as might occur if both parties are configured\n   to\
    \ be active, and MAY elect to terminate redundant connections.  A\n   Termination\
    \ reason code is defined for this purpose.\n   Once a connection is established,\
    \ the router sends messages over it.\n   There is no initialization or handshaking\
    \ phase, messages are simply\n   sent as soon as the connection is established.\n\
    \   If the monitoring station intends to end or restart BMP processing,\n   it\
    \ simply drops the connection.\n"
- title: 3.3.  Lifecycle of a BMP Session
  contents:
  - "3.3.  Lifecycle of a BMP Session\n   A router is configured to speak BMP to one\
    \ or more monitoring\n   stations.  It MAY be configured to send monitoring information\
    \ for\n   only a subset of its BGP peers.  Otherwise, all BGP peers are assumed\n\
    \   to be monitored.\n   A BMP session begins when the active party (either router\
    \ or\n   management station, as determined by configuration) successfully\n  \
    \ opens a TCP session (the \"BMP session\").  Once the session is up, the\n  \
    \ router begins to send BMP messages.  It MUST begin by sending an\n   Initiation\
    \ message.  It subsequently sends a Peer Up message over the\n   BMP session for\
    \ each of its monitored BGP peers that is in the\n   Established state.  It follows\
    \ by sending the contents of its Adj-\n   RIBs-In (pre-policy, post-policy, or\
    \ both, see Section 5)\n   encapsulated in Route Monitoring messages.  Once it\
    \ has sent all the\n   routes for a given peer, it MUST send an End-of-RIB message\
    \ for that\n   peer; when End-of-RIB has been sent for each monitored peer, the\n\
    \   initial table dump has completed.  (A monitoring station that only\n   wants\
    \ to gather a table dump could close the connection once it has\n   gathered an\
    \ End-of-RIB or Peer Down message corresponding to each\n   Peer Up message.)\n\
    \   Following the initial table dump, the router sends incremental\n   updates\
    \ encapsulated in Route Monitoring messages.  It MAY\n   periodically send Stats\
    \ Reports or even new Initiation messages,\n   according to configuration.  If\
    \ any new monitored BGP peer becomes\n   Established, a corresponding Peer Up\
    \ message is sent.  If any BGP\n   peers for which Peer Up messages were sent\
    \ transition out of the\n   Established state, corresponding Peer Down messages\
    \ are sent.\n   A BMP session ends when the TCP session that carries it is closed\
    \ for\n   any reason.  The router MAY send a Termination message prior to\n  \
    \ closing the session.\n"
- title: 4.  BMP Message Format
  contents:
  - '4.  BMP Message Format

    '
- title: 4.1.  Common Header
  contents:
  - "4.1.  Common Header\n   The following common header appears in all BMP messages.\
    \  The rest of\n   the data in a BMP message is dependent on the Message Type\
    \ field in\n   the common header.\n      0                   1               \
    \    2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+\n     |    Version    |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                        Message Length                         |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \ Msg. Type   |\n     +---------------+\n   o  Version (1 byte): Indicates the\
    \ BMP version.  This is set to '3'\n      for all messages defined in this specification.\
    \ ('1' and '2' were\n      used by draft versions of this document.)  Version\
    \ 0 is reserved\n      and MUST NOT be sent.\n   o  Message Length (4 bytes):\
    \ Length of the message in bytes\n      (including headers, data, and encapsulated\
    \ messages, if any).\n   o  Message Type (1 byte): This identifies the type of\
    \ the BMP\n      message.  A BMP implementation MUST ignore unrecognized message\n\
    \      types upon receipt.\n      *  Type = 0: Route Monitoring\n      *  Type\
    \ = 1: Statistics Report\n      *  Type = 2: Peer Down Notification\n      * \
    \ Type = 3: Peer Up Notification\n      *  Type = 4: Initiation Message\n    \
    \  *  Type = 5: Termination Message\n      *  Type = 6: Route Mirroring Message\n"
- title: 4.2.  Per-Peer Header
  contents:
  - "4.2.  Per-Peer Header\n   The per-peer header follows the common header for most\
    \ BMP messages.\n   The rest of the data in a BMP message is dependent on the\
    \ Message\n   Type field in the common header.\n      0                   1  \
    \                 2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |   Peer Type   |  Peer Flags   |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |         Peer Distinguisher (present based on peer type)       |\n    \
    \ |                                                               |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                 Peer Address (16 bytes)                       |\n    \
    \ ~                                                               ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                           Peer AS                             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                       Peer BGP ID                           |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                    Timestamp (seconds)                        |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                Timestamp (microseconds)                     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   o  Peer Type (1 byte): Identifies the type of peer.  Currently, three\n  \
    \    types of peers are identified:\n      *  Peer Type = 0: Global Instance Peer\n\
    \      *  Peer Type = 1: RD Instance Peer\n      *  Peer Type = 2: Local Instance\
    \ Peer\n   o  Peer Flags (1 byte): These flags provide more information about\n\
    \      the peer.  The flags are defined as follows:\n                        \
    \      0 1 2 3 4 5 6 7\n                             +-+-+-+-+-+-+-+-+\n     \
    \                        |V|L|A| Reserved|\n                             +-+-+-+-+-+-+-+-+\n\
    \      *  The V flag indicates that the Peer address is an IPv6 address.\n   \
    \      For IPv4 peers, this is set to 0.\n      *  The L flag, if set to 1, indicates\
    \ that the message reflects\n         the post-policy Adj-RIB-In (i.e., its path\
    \ attributes reflect\n         the application of inbound policy).  It is set\
    \ to 0 if the\n         message reflects the pre-policy Adj-RIB-In.  Locally sourced\n\
    \         routes also carry an L flag of 1.  See Section 5 for further\n     \
    \    detail.  This flag has no significance when used with route\n         mirroring\
    \ messages (Section 4.7).\n      *  The A flag, if set to 1, indicates that the\
    \ message is\n         formatted using the legacy 2-byte AS_PATH format.  If set\
    \ to 0,\n         the message is formatted using the 4-byte AS_PATH format\n \
    \        [RFC6793].  A BMP speaker MAY choose to propagate the AS_PATH\n     \
    \    information as received from its peer, or it MAY choose to\n         reformat\
    \ all AS_PATH information into a 4-byte format\n         regardless of how it\
    \ was received from the peer.  In the latter\n         case, AS4_PATH or AS4_AGGREGATOR\
    \ path attributes SHOULD NOT be\n         sent in the BMP UPDATE message.  This\
    \ flag has no significance\n         when used with route mirroring messages (Section\
    \ 4.7).\n      *  The remaining bits are reserved for future use.  They MUST be\n\
    \         transmitted as 0 and their values MUST be ignored on receipt.\n   o\
    \  Peer Distinguisher (8 bytes): Routers today can have multiple\n      instances\
    \ (example: Layer 3 Virtual Private Networks (L3VPNs)\n      [RFC4364]).  This\
    \ field is present to distinguish peers that\n      belong to one address domain\
    \ from the other.\n      If the peer is a \"Global Instance Peer\", this field\
    \ is zero-\n      filled.  If the peer is a \"RD Instance Peer\", it is set to\
    \ the\n      route distinguisher of the particular instance the peer belongs\n\
    \      to.  If the peer is a \"Local Instance Peer\", it is set to a\n      unique,\
    \ locally defined value.  In all cases, the effect is that\n      the combination\
    \ of the Peer Type and Peer Distinguisher is\n      sufficient to disambiguate\
    \ peers for which other identifying\n      information might overlap.\n   o  Peer\
    \ Address: The remote IP address associated with the TCP\n      session over which\
    \ the encapsulated PDU was received.  It is 4\n      bytes long if an IPv4 address\
    \ is carried in this field (with the\n      12 most significant bytes zero-filled)\
    \ and 16 bytes long if an\n      IPv6 address is carried in this field.\n   o\
    \  Peer AS: The Autonomous System number of the peer from which the\n      encapsulated\
    \ PDU was received.  If a 16-bit AS number is stored in\n      this field [RFC6793],\
    \ it should be padded with zeroes in the 16\n      most significant bits.\n  \
    \ o  Peer BGP ID: The BGP Identifier of the peer from which the\n      encapsulated\
    \ PDU was received.\n   o  Timestamp: The time when the encapsulated routes were\
    \ received\n      (one may also think of this as the time when they were installed\n\
    \      in the Adj-RIB-In), expressed in seconds and microseconds since\n     \
    \ midnight (zero hour), January 1, 1970 (UTC).  If zero, the time is\n      unavailable.\
    \  Precision of the timestamp is implementation-\n      dependent.\n"
- title: 4.3.  Initiation Message
  contents:
  - "4.3.  Initiation Message\n   The initiation message provides a means for the\
    \ monitored router to\n   inform the monitoring station of its vendor, software\
    \ version, and so\n   on.  An initiation message MUST be sent as the first message\
    \ after\n   the TCP session comes up.  An initiation message MAY be sent at any\n\
    \   point thereafter, if warranted by a change on the monitored router.\n   The\
    \ initiation message consists of the common BMP header followed by\n   two or\
    \ more Information TLVs (Section 4.4) containing information\n   about the monitored\
    \ router.  The sysDescr and sysName Information\n   TLVs MUST be sent, any others\
    \ are optional.  The string TLV MAY be\n   included multiple times.\n"
- title: 4.4.  Information TLV
  contents:
  - "4.4.  Information TLV\n   The Information TLV is used by the Initiation (Section\
    \ 4.3) and Peer\n   Up (Section 4.10) messages.\n      0                   1 \
    \                  2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |          Information Type     |       Information Length      |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \               Information (variable)                        |\n     ~      \
    \                                                         ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   o  Information Type (2 bytes): Type of information provided.  Defined\n  \
    \    types are:\n      *  Type = 0: String.  The Information field contains a\
    \ free-form\n         UTF-8 string whose length is given by the Information Length\n\
    \         field.  The value is administratively assigned.  There is no\n     \
    \    requirement to terminate the string with a null (or any other\n         particular)\
    \ character -- the Information Length field gives its\n         termination. \
    \ If multiple strings are included, their ordering\n         MUST be preserved\
    \ when they are reported.\n      *  Type = 1: sysDescr.  The Information field\
    \ contains an ASCII\n         string whose value MUST be set to be equal to the\
    \ value of the\n         sysDescr MIB-II [RFC1213] object.\n      *  Type = 2:\
    \ sysName.  The Information field contains an ASCII\n         string whose value\
    \ MUST be set to be equal to the value of the\n         sysName MIB-II [RFC1213]\
    \ object.\n   o  Information Length (2 bytes): The length of the following\n \
    \     Information field, in bytes.\n   o  Information (variable): Information\
    \ about the monitored router,\n      according to the type.\n"
- title: 4.5.  Termination Message
  contents:
  - "4.5.  Termination Message\n   The termination message provides a way for a monitored\
    \ router to\n   indicate why it is terminating a session.  Although use of this\n\
    \   message is RECOMMENDED, a monitoring station must always be prepared\n   for\
    \ the session to terminate with no message.  Once the router has\n   sent a termination\
    \ message, it MUST close the TCP session without\n   sending any further messages.\
    \  Likewise, the monitoring station MUST\n   close the TCP session after receiving\
    \ a termination message.\n   The termination message consists of the common BMP\
    \ header followed by\n   one or more TLVs containing information about the reason\
    \ for the\n   termination, as follows:\n      0                   1          \
    \         2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |          Information Type     |       Information Length      |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \               Information (variable)                        |\n     ~      \
    \                                                         ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   o  Information Type (2 bytes): Type of information provided.  Defined\n  \
    \    types are:\n      *  Type = 0: String.  The Information field contains a\
    \ free-form\n         UTF-8 string whose length is given by the Information Length\n\
    \         field.  Inclusion of this TLV is optional.  It MAY be used to\n    \
    \     provide further detail for any of the defined reasons.\n         Multiple\
    \ String TLVs MAY be included in the message.\n      *  Type = 1: Reason.  The\
    \ Information field contains a 2-byte code\n         indicating the reason that\
    \ the connection was terminated.  Some\n         reasons may have further TLVs\
    \ associated with them.  Inclusion\n         of this TLV is REQUIRED.  Defined\
    \ reasons are:\n         +  Reason = 0: Session administratively closed.  The\
    \ session\n            might be re-initiated.\n         +  Reason = 1: Unspecified\
    \ reason.\n         +  Reason = 2: Out of resources.  The router has exhausted\n\
    \            resources available for the BMP session.\n         +  Reason = 3:\
    \ Redundant connection.  The router has determined\n            that this connection\
    \ is redundant with another one.\n         +  Reason = 4: Session permanently\
    \ administratively closed,\n            will not be re-initiated.  Monitoring\
    \ station should reduce\n            (potentially to 0) the rate at which it attempts\n\
    \            reconnection to the monitored router.\n   o  Information Length (2\
    \ bytes): The length of the following\n      Information field, in bytes.\n  \
    \ o  Information (variable): Information about the monitored router,\n      according\
    \ to the type.\n"
- title: 4.6.  Route Monitoring
  contents:
  - "4.6.  Route Monitoring\n   Route Monitoring messages are used for initial synchronization\
    \ of the\n   ADJ-RIBs-In.  They are also used for ongoing monitoring of the\n\
    \   ADJ-RIB-In state.  Route monitoring messages are state-compressed.\n   This\
    \ is all discussed in more detail in Section 5.\n   Following the common BMP header\
    \ and per-peer header is a BGP Update\n   PDU.\n"
- title: 4.7.  Route Mirroring
  contents:
  - "4.7.  Route Mirroring\n   Route Mirroring messages are used for verbatim duplication\
    \ of\n   messages as received.  A possible use for mirroring is exact\n   mirroring\
    \ of one or more monitored BGP sessions, without state\n   compression.  Another\
    \ possible use is the mirroring of messages that\n   have been treated-as-withdraw\
    \ [RFC7606], for debugging purposes.\n   Mirrored messages may be sampled, or\
    \ may be lossless.  The Messages\n   Lost Information code is provided to allow\
    \ losses to be indicated.\n   Section 6 provides more detail.\n   Following the\
    \ common BMP header and per-peer header is a set of TLVs\n   that contain information\
    \ about a message or set of messages.  Each\n   TLV comprises a 2-byte type code,\
    \ a 2-byte length field, and a\n   variable-length value.  Inclusion of any given\
    \ TLV is OPTIONAL;\n   however, at least one TLV SHOULD be included, otherwise\
    \ there's no\n   point in sending the message.  Defined TLVs are as follows:\n\
    \   o  Type = 0: BGP Message.  A BGP PDU.  This PDU may or may not be an\n   \
    \   Update message.  If the BGP Message TLV occurs in the Route\n      Mirroring\
    \ message, it MUST occur last in the list of TLVs.\n   o  Type = 1: Information.\
    \  A 2-byte code that provides information\n      about the mirrored message or\
    \ message stream.  Defined codes are:\n      *  Code = 0: Errored PDU.  The contained\
    \ message was found to have\n         some error that made it unusable, causing\
    \ it to be treated-as-\n         withdraw [RFC7606].  A BGP Message TLV MUST also\
    \ occur in the\n         TLV list.\n      *  Code = 1: Messages Lost.  One or\
    \ more messages may have been\n         lost.  This could occur, for example,\
    \ if an implementation runs\n         out of available buffer space to queue mirroring\
    \ messages.\n   A Route Mirroring message may be sent any time it would be legal\
    \ to\n   send a Route Monitoring message.\n"
- title: 4.8.  Stats Reports
  contents:
  - "4.8.  Stats Reports\n   These messages contain information that could be used\
    \ by the\n   monitoring station to observe interesting events that occur on the\n\
    \   router.\n   Transmission of SR messages could be timer triggered or event\
    \ driven\n   (for example, when a significant event occurs or a threshold is\n\
    \   reached).  This specification does not impose any timing restrictions\n  \
    \ on when and on what event these reports have to be transmitted.  It\n   is left\
    \ to the implementation to determine transmission timings --\n   however, configuration\
    \ control should be provided of the timer and/or\n   threshold values.  This document\
    \ only specifies the form and content\n   of SR messages.\n   Following the common\
    \ BMP header and per-peer header is a 4-byte field\n   that indicates the number\
    \ of counters in the stats message where each\n   counter is encoded as a TLV.\n\
    \      0                   1                   2                   3\n      0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                        Stats Count                            |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   Each counter\
    \ is encoded as follows:\n      0                   1                   2    \
    \               3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6\
    \ 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |         Stat Type             |          Stat Len             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                      Stat Data                              |\n     ~      \
    \                                                         ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   o  Stat Type (2 bytes): Defines the type of the statistic carried in\n   \
    \   the Stat Data field.\n   o  Stat Len (2 bytes): Defines the length of the\
    \ Stat Data field.\n   This specification defines the following statistics.  A\
    \ BMP\n   implementation MUST ignore unrecognized stat types on receipt, and\n\
    \   likewise MUST ignore unexpected data in the Stat Data field.\n   Stats are\
    \ either counters or gauges, defined as follows after the\n   examples in Section\
    \ 3.2.3.3 of [RFC1155] and Section 4 of [RFC2856],\n   respectively:\n   32-bit\
    \ Counter: A non-negative integer that monotonically increases\n   until it reaches\
    \ a maximum value, when it wraps around and starts\n   increasing again from 0.\
    \  It has a maximum value of 2^32-1\n   (4294967295 decimal).\n   64-bit Gauge:\
    \ A non-negative integer that may increase or decrease,\n   but shall never exceed\
    \ a maximum value, nor fall below a minimum one.\n   The maximum value cannot\
    \ be greater than 2^64-1 (18446744073709551615\n   decimal), and the minimum value\
    \ cannot be smaller than 0.  The value\n   has its maximum value whenever the\
    \ information being modeled is\n   greater than or equal to its maximum value,\
    \ and has its minimum value\n   whenever the information being modeled is smaller\
    \ than or equal to\n   its minimum value.  If the information being modeled subsequently\n\
    \   decreases below the maximum value (or increases above the minimum\n   value),\
    \ the 64-bit Gauge also decreases (or increases).\n   o  Stat Type = 0: (32-bit\
    \ Counter) Number of prefixes rejected by\n      inbound policy.\n   o  Stat Type\
    \ = 1: (32-bit Counter) Number of (known) duplicate prefix\n      advertisements.\n\
    \   o  Stat Type = 2: (32-bit Counter) Number of (known) duplicate\n      withdraws.\n\
    \   o  Stat Type = 3: (32-bit Counter) Number of updates invalidated due\n   \
    \   to CLUSTER_LIST loop.\n   o  Stat Type = 4: (32-bit Counter) Number of updates\
    \ invalidated due\n      to AS_PATH loop.\n   o  Stat Type = 5: (32-bit Counter)\
    \ Number of updates invalidated due\n      to ORIGINATOR_ID.\n   o  Stat Type\
    \ = 6: (32-bit Counter) Number of updates invalidated due\n      to AS_CONFED\
    \ loop.\n   o  Stat Type = 7: (64-bit Gauge) Number of routes in Adj-RIBs-In.\n\
    \   o  Stat Type = 8: (64-bit Gauge) Number of routes in Loc-RIB.\n   o  Stat\
    \ Type = 9: Number of routes in per-AFI/SAFI Adj-RIB-In.  The\n      value is\
    \ structured as: 2-byte Address Family Identifier (AFI),\n      1-byte Subsequent\
    \ Address Family Identifier (SAFI), followed by a\n      64-bit Gauge.\n   o \
    \ Stat Type = 10: Number of routes in per-AFI/SAFI Loc-RIB.  The\n      value\
    \ is structured as: 2-byte AFI, 1-byte SAFI, followed by a\n      64-bit Gauge.\n\
    \   o  Stat Type = 11: (32-bit Counter) Number of updates subjected to\n     \
    \ treat-as-withdraw treatment [RFC7606].\n   o  Stat Type = 12: (32-bit Counter)\
    \ Number of prefixes subjected to\n      treat-as-withdraw treatment [RFC7606].\n\
    \   o  Stat Type = 13: (32-bit Counter) Number of duplicate update\n      messages\
    \ received.\n   Although the current specification only specifies 4-byte counters\
    \ and\n   8-byte gauges as \"Stat Data\", this does not preclude future versions\n\
    \   from incorporating more complex TLV-type \"Stat Data\" (for example,\n   one\
    \ that can carry prefix-specific data).  SR messages are optional.\n   However,\
    \ if an SR message is transmitted, at least one statistic MUST\n   be carried\
    \ in it.\n"
- title: 4.9.  Peer Down Notification
  contents:
  - "4.9.  Peer Down Notification\n   This message is used to indicate that a peering\
    \ session was\n   terminated.\n      0                   1                   2\
    \                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+\n     |    Reason     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |            Data (present if Reason = 1, 2 or 3)               |\n    \
    \ ~                                                               ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Reason indicates why the session was closed.  Defined values are:\n   o  Reason\
    \ 1: The local system closed the session.  Following the\n      Reason is a BGP\
    \ PDU containing a BGP NOTIFICATION message that\n      would have been sent to\
    \ the peer.\n   o  Reason 2: The local system closed the session.  No notification\n\
    \      message was sent.  Following the reason code is a 2-byte field\n      containing\
    \ the code corresponding to the Finite State Machine\n      (FSM) Event that caused\
    \ the system to close the session (see\n      Section 8.1 of [RFC4271]).  Two\
    \ bytes both set to 0 are used to\n      indicate that no relevant Event code\
    \ is defined.\n   o  Reason 3: The remote system closed the session with a notification\n\
    \      message.  Following the Reason is a BGP PDU containing the BGP\n      NOTIFICATION\
    \ message as received from the peer.\n   o  Reason 4: The remote system closed\
    \ the session without a\n      notification message.  This includes any unexpected\
    \ termination of\n      the transport session, so in some cases both the local\
    \ and remote\n      systems might consider this to apply.\n   o  Reason 5: Information\
    \ for this peer will no longer be sent to the\n      monitoring station for configuration\
    \ reasons.  This does not,\n      strictly speaking, indicate that the peer has\
    \ gone down, but it\n      does indicate that the monitoring station will not\
    \ receive updates\n      for the peer.\n   A Peer Down message implicitly withdraws\
    \ all routes that were\n   associated with the peer in question.  A BMP implementation\
    \ MAY omit\n   sending explicit withdraws for such routes.\n"
- title: 4.10.  Peer Up Notification
  contents:
  - "4.10.  Peer Up Notification\n   The Peer Up message is used to indicate that\
    \ a peering session has\n   come up (i.e., has transitioned into the Established\
    \ state).\n   Following the common BMP header and per-peer header is the following:\n\
    \      0                   1                   2                   3\n      0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                 Local Address (16 bytes)                      |\n    \
    \ ~                                                               ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |         Local Port            |        Remote Port            |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                  Sent OPEN Message                          |\n     ~      \
    \                                                         ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                  Received OPEN Message                        |\n    \
    \ ~                                                               ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                 Information (variable)                        |\n    \
    \ ~                                                               ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   o  Local Address: The local IP address associated with the peering\n     \
    \ TCP session.  It is 4 bytes long if an IPv4 address is carried in\n      this\
    \ field, as determined by the V flag (with the 12 most\n      significant bytes\
    \ zero-filled) and 16 bytes long if an IPv6\n      address is carried in this\
    \ field.\n   o  Local Port: The local port number associated with the peering\
    \ TCP\n      session, or 0 if no TCP session actually exists (see Section 8.2).\n\
    \   o  Remote Port: The remote port number associated with the peering\n     \
    \ TCP session, or 0 if no TCP session actually exists (see\n      Section 8.2).\
    \  (The remote address can be found in the Peer\n      Address field of the fixed\
    \ header.)\n   o  Sent OPEN Message: The full OPEN message transmitted by the\n\
    \      monitored router to its peer.\n   o  Received OPEN Message: The full OPEN\
    \ message received by the\n      monitored router from its peer.\n   o  Information:\
    \ Information about the peer, using the Information TLV\n      (Section 4.4) format.\
    \  Only the string type is defined in this\n      context; it may be repeated.\
    \  Inclusion of the Information field\n      is OPTIONAL.  Its presence or absence\
    \ can be inferred by\n      inspection of the Message Length in the common header.\n"
- title: 5.  Route Monitoring
  contents:
  - "5.  Route Monitoring\n   In BMP's normal operating mode, after the BMP session\
    \ is up, Route\n   Monitoring messages are used to provide a snapshot of the Adj-RIB-In\n\
    \   of each monitored peer.  This is done by sending all routes stored in\n  \
    \ the Adj-RIB-In of those peers using standard BGP Update messages,\n   encapsulated\
    \ in Route Monitoring messages.  There is no requirement\n   on the ordering of\
    \ messages in the peer dumps.  When the initial dump\n   is completed for a given\
    \ peer, this MUST be indicated by sending an\n   End-of-RIB marker for that peer\
    \ (as specified in Section 2 of\n   [RFC4724], plus the BMP encapsulation header).\
    \  See also Section 9.\n   A BMP speaker may send pre-policy routes, post-policy\
    \ routes, or\n   both.  The selection may be due to implementation constraints\
    \ (it is\n   possible that a BGP implementation may not store, for example, routes\n\
    \   that have been filtered out by policy).  Pre-policy routes MUST have\n   their\
    \ L flag clear in the BMP header (see Section 4), post-policy\n   routes MUST\
    \ have their L flag set.  When an implementation chooses to\n   send both pre-\
    \ and post-policy routes, it is effectively multiplexing\n   two update streams\
    \ onto the BMP session.  The streams are\n   distinguished by their L flags.\n\
    \   If the implementation is able to provide information about when\n   routes\
    \ were received, it MAY provide such information in the BMP\n   Timestamp field.\
    \  Otherwise, the BMP Timestamp field MUST be set to\n   0, indicating that time\
    \ is not available.\n   Ongoing monitoring is accomplished by propagating route\
    \ changes in\n   BGP Update PDUs and forwarding those PDUs to the monitoring station,\n\
    \   again using RM messages.  When a change occurs to a route, such as an\n  \
    \ attribute change, the router must update the monitoring station with\n   the\
    \ new attribute.  As discussed above, it MAY generate either an\n   update with\
    \ the L flag clear, with it set, or two updates, one with\n   the L flag clear\
    \ and the other with the L flag set.  When a route is\n   withdrawn by a peer,\
    \ a corresponding withdraw is sent to the\n   monitoring station.  The withdraw\
    \ MUST have its L flag set to\n   correspond to that of any previous announcement;\
    \ if the route in\n   question was previously announced with L flag both clear\
    \ and set, the\n   withdraw MUST similarly be sent twice, with L flag clear and\
    \ set.\n   Multiple changed routes MAY be grouped into a single BGP UPDATE PDU\n\
    \   when feasible, exactly as in the standard BGP protocol.\n   It's important\
    \ to note that RM messages are not replicated messages\n   received from a peer.\
    \  (Route mirroring (Section 6) is provided if\n   this is required.)  While the\
    \ router should attempt to generate\n   updates promptly, there is a finite time\
    \ that could elapse between\n   reception of an update, the generation an RM message,\
    \ and its\n   transmission to the monitoring station.  If there are state changes\n\
    \   in the interim for that prefix, it is acceptable that the router\n   generate\
    \ the final state of that prefix to the monitoring station.\n   This is sometimes\
    \ known as \"state compression\".  The actual PDU\n   generated and transmitted\
    \ to the station might also differ from the\n   exact PDU received from the peer,\
    \ for example, due to differences\n   between how different implementations format\
    \ path attributes.\n"
- title: 6.  Route Mirroring
  contents:
  - "6.  Route Mirroring\n   Route Mirroring messages are provided for two primary\
    \ reasons: First,\n   to enable an implementation to operate in a mode where it\
    \ provides a\n   full-fidelity view of all messages received from its peers, without\n\
    \   state compression.  As we note in Section 5, BMP's normal operational\n  \
    \ mode cannot provide this.  Implementors are strongly cautioned that\n   without\
    \ state compression, an implementation could require unbounded\n   storage to\
    \ buffer messages queued to be mirrored.  Route Mirroring is\n   unlikely to be\
    \ suitable for implementation in conventional routers,\n   and its use is NOT\
    \ RECOMMENDED except in cases where implementors\n   have carefully considered\
    \ the tradeoffs.  These tradeoffs include:\n   router resource exhaustion, the\
    \ potential to interfere with the\n   transmission or reception of BGP UPDATE\
    \ messages, and the slowing of\n   routing convergence.\n   The second application\
    \ for Route Mirroring is for error reporting and\n   diagnosis.  When Revised\
    \ Error Handling for BGP UPDATE messages\n   [RFC7606] is in use, a router can\
    \ process BGP messages that are\n   determined to contain errors, without resetting\
    \ the BGP session.\n   Such messages MAY be mirrored.  The buffering used for\
    \ such mirroring\n   SHOULD be limited.  If an errored message is unable to be\
    \ mirrored\n   due to buffer exhaustion, a message with the \"Messages Lost\"\
    \ code\n   SHOULD be sent to indicate this.  (This implies that a buffer should\n\
    \   be reserved for this use.)\n"
- title: 7.  Stat Reports
  contents:
  - "7.  Stat Reports\n   As outlined above, SR messages are used to monitor specific\
    \ events\n   and counters on the monitored router.  One type of monitoring could\n\
    \   be to find out if there are an undue number of route advertisements\n   and\
    \ withdraws happening (churn) on the monitored router.  Another\n   metric is\
    \ to evaluate the number of looped AS_PATHs on the router.\n   While this document\
    \ proposes a small set of counters to begin with,\n   the authors envision that\
    \ this list may grow in the future with new\n   applications that require BMP-style\
    \ monitoring.\n"
- title: 8.  Other Considerations
  contents:
  - '8.  Other Considerations

    '
- title: 8.1.  Multiple Instances
  contents:
  - "8.1.  Multiple Instances\n   Some routers may support multiple instances of the\
    \ BGP protocol, for\n   example, as \"logical routers\" or through some other\
    \ facility.  The\n   BMP protocol relates to a single instance of BGP; thus, if\
    \ a router\n   supports multiple BGP instances it should also support multiple\
    \ BMP\n   instances (one per BGP instance).  Different BMP instances SHOULD\n\
    \   generate Initiation Messages that are distinct from one another, for\n   example,\
    \ by using distinguishable sysNames or by the inclusion of\n   instance-identifying\
    \ information in a string TLV.\n"
- title: 8.2.  Locally Originated Routes
  contents:
  - "8.2.  Locally Originated Routes\n   Some consideration is required for routes\
    \ originated into BGP by the\n   local router, whether as a result of redistribution\
    \ from another\n   protocol or for some other reason.\n   Such routes can be modeled\
    \ as having been sent by the router to\n   itself, placing the router's own address\
    \ in the Peer Address field of\n   the header.  It is RECOMMENDED that when doing\
    \ so, the router should\n   use the same address it has used as its local address\
    \ for the BMP\n   session.  Since in this case no transport session actually exists,\n\
    \   the Local and Remote Port fields of the Peer Up message MUST be set\n   to\
    \ 0.  Clearly, the OPEN Message fields of the Peer Up message will\n   equally\
    \ not have been transmitted physically, but should represent\n   the relevant\
    \ capabilities of the local router.\n   Also, recall that the L flag is used to\
    \ indicate locally sourced\n   routes, see Section 4.2.\n"
- title: 9.  Using BMP
  contents:
  - "9.  Using BMP\n   Once the BMP session is established, route monitoring starts\
    \ dumping\n   the current snapshot as well as incremental changes simultaneously.\n\
    \   It is fine to have these operations occur concurrently.  If the\n   initial\
    \ dump visits a route and subsequently a withdraw is received,\n   this will be\
    \ forwarded to the monitoring station that would have to\n   correlate and reflect\
    \ the deletion of that route in its internal\n   state.  This is an operation\
    \ that a monitoring station would need to\n   support, regardless.\n   If the\
    \ router receives a withdraw for a prefix even before the peer\n   dump procedure\
    \ visits that prefix, then the router would clean up\n   that route from its internal\
    \ state and will not forward it to the\n   monitoring station.  In this case,\
    \ the monitoring station may receive\n   a bogus withdraw it can safely ignore.\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   IANA has created registries for the following BMP\
    \ parameters, which\n   are organized in a new group \"BGP Monitoring Protocol\
    \ (BMP)\n   Parameters\".\n"
- title: 10.1.  BMP Message Types
  contents:
  - "10.1.  BMP Message Types\n   This document defines seven message types for transferring\
    \ BGP\n   messages between cooperating systems (Section 4):\n   o  Type 0: Route\
    \ Monitoring\n   o  Type 1: Statistics Report\n   o  Type 2: Peer Down Notification\n\
    \   o  Type 3: Peer Up Notification\n   o  Type 4: Initiation\n   o  Type 5: Termination\n\
    \   o  Type 6: Route Mirroring\n   Type values 0 through 127 MUST be assigned\
    \ using the \"Standards\n   Action\" policy, and values 128 through 250 using\
    \ the \"Specification\n   Required\" policy defined in [RFC5226].  Values 251\
    \ through 254 are\n   Experimental, and value 255 is Reserved.\n"
- title: 10.2.  BMP Peer Types
  contents:
  - "10.2.  BMP Peer Types\n   This document defines three types of peers for purposes\
    \ of\n   interpreting the Peer Distinguisher field (Section 4.2):\n   o  Peer\
    \ Type = 0: Global Instance Peer\n   o  Peer Type = 1: RD Instance Peer\n   o\
    \  Peer Type = 2: Local Instance Peer\n   Peer Type values 0 through 127 MUST\
    \ be assigned using the \"Standards\n   Action\" policy, and values 128 through\
    \ 250 using the \"Specification\n   Required\" policy, defined in [RFC5226]. \
    \ Values 251 through 254 are\n   Experimental, and value 255 is Reserved.\n"
- title: 10.3.  BMP Peer Flags
  contents:
  - "10.3.  BMP Peer Flags\n   This document defines three bit flags in the Peer Flags\
    \ field of the\n   per-peer header (Section 4.2).  The bits are numbered from\
    \ 0 (the\n   high-order, or leftmost, bit) to 7 (the low-order, or rightmost,\n\
    \   bit):\n   o  Flag 0: V flag\n   o  Flag 1: L flag\n   o  Flag 2: A flag\n\
    \   Flags 3 through 7 are unassigned.  The registration procedure for the\n  \
    \ registry is \"Standards Action\".\n"
- title: 10.4.  BMP Statistics Types
  contents:
  - "10.4.  BMP Statistics Types\n   This document defines fourteen statistics types\
    \ for statistics\n   reporting (Section 4.8):\n   o  Stat Type = 0: Number of\
    \ prefixes rejected by inbound policy\n   o  Stat Type = 1: Number of (known)\
    \ duplicate prefix advertisements\n   o  Stat Type = 2: Number of (known) duplicate\
    \ withdraws\n   o  Stat Type = 3: Number of updates invalidated due to CLUSTER_LIST\n\
    \      loop\n   o  Stat Type = 4: Number of updates invalidated due to AS_PATH\
    \ loop\n   o  Stat Type = 5: Number of updates invalidated due to ORIGINATOR_ID\n\
    \   o  Stat Type = 6: Number of updates invalidated due to a loop found\n    \
    \  in AS_CONFED_SEQUENCE or AS_CONFED_SET\n   o  Stat Type = 7: Number of routes\
    \ in Adj-RIBs-In\n   o  Stat Type = 8: Number of routes in Loc-RIB\n   o  Stat\
    \ Type = 9: Number of routes in per-AFI/SAFI Adj-RIB-In\n   o  Stat Type = 10:\
    \ Number of routes in per-AFI/SAFI Loc-RIB\n   o  Stat Type = 11: Number of updates\
    \ subjected to treat-as-withdraw\n   o  Stat Type = 12: Number of prefixes subjected\
    \ to treat-as-withdraw\n   o  Stat Type = 13: Number of duplicate update messages\
    \ received\n   Stat Type values 0 through 32767 MUST be assigned using the\n \
    \  \"Standards Action\" policy, and values 32768 through 65530 using the\n   \"\
    Specification Required\" policy, defined in [RFC5226].  Values 65531\n   through\
    \ 65534 are Experimental, and value 65535 is Reserved.\n"
- title: 10.5.  BMP Initiation Message TLVs
  contents:
  - "10.5.  BMP Initiation Message TLVs\n   This document defines three types for\
    \ information carried in the\n   Initiation message (Section 4.3):\n   o  Type\
    \ = 0: String\n   o  Type = 1: sysDescr\n   o  Type = 2: sysName\n   Information\
    \ type values 0 through 32767 MUST be assigned using the\n   \"Standards Action\"\
    \ policy, and values 32768 through 65530 using the\n   \"Specification Required\"\
    \ policy, defined in [RFC5226].  Values 65531\n   through 65534 are Experimental,\
    \ and value 65535 is reserved.\n"
- title: 10.6.  BMP Termination Message TLVs
  contents:
  - "10.6.  BMP Termination Message TLVs\n   This document defines two types for information\
    \ carried in the\n   Termination message (Section 4.5):\n   o  Type = 0: String\n\
    \   o  Type = 1: Reason\n   Information type values 0 through 32767 MUST be assigned\
    \ using the\n   \"Standards Action\" policy, and values 32768 through 65530 using\
    \ the\n   \"Specification Required\" policy, defined in [RFC5226].  Values 65531\n\
    \   through 65534 are Experimental, and value 65535 is Reserved.\n"
- title: 10.7.  BMP Termination Message Reason Codes
  contents:
  - "10.7.  BMP Termination Message Reason Codes\n   This document defines five types\
    \ for information carried in the\n   Termination message (Section 4.5) Reason\
    \ code:\n   o  Type = 0: Administratively closed\n   o  Type = 1: Unspecified\
    \ reason\n   o  Type = 2: Out of resources\n   o  Type = 3: Redundant connection\n\
    \   o  Type = 4: Permanently administratively closed\n   Information type values\
    \ 0 through 32767 MUST be assigned using the\n   \"Standards Action\" policy,\
    \ and values 32768 through 65530 using the\n   \"Specification Required\" policy,\
    \ defined in [RFC5226].  Values 65531\n   through 65534 are Experimental, and\
    \ value 65535 is Reserved.\n"
- title: 10.8.  BMP Peer Down Reason Codes
  contents:
  - "10.8.  BMP Peer Down Reason Codes\n   This document defines five types for information\
    \ carried in the Peer\n   Down Notification (Section 4.9) Reason code (and reserves\
    \ one further\n   type):\n   o  Type = 0 is Reserved.\n   o  Type = 1: Local system\
    \ closed, NOTIFICATION PDU follows\n   o  Type = 2: Local system closed, FSM Event\
    \ follows\n   o  Type = 3: Remote system closed, NOTIFICATION PDU follows\n  \
    \ o  Type = 4: Remote system closed, no data\n   o  Type = 5: Peer de-configured\n\
    \   Information type values 0 through 32767 MUST be assigned using the\n   \"\
    Standards Action\" policy, and values 32768 through 65530 using the\n   \"Specification\
    \ Required\" policy, defined in [RFC5226].  Values 65531\n   through 65534 are\
    \ Experimental, and values 0 and 65535 are Reserved.\n"
- title: 10.9.  Route Mirroring TLVs
  contents:
  - "10.9.  Route Mirroring TLVs\n   This document defines two types for information\
    \ carried in the Route\n   Mirroring message (Section 4.7):\n   o  Type = 0: BGP\
    \ Message\n   o  Type = 1: Information\n   Information type values 0 through 32767\
    \ MUST be assigned using the\n   \"Standards Action\" policy, and values 32768\
    \ through 65530 using the\n   \"Specification Required\" policy, defined in [RFC5226].\
    \  Values 65531\n   through 65534 are Experimental, and value 65535 is Reserved.\n"
- title: 10.10.  BMP Route Mirroring Information Codes
  contents:
  - "10.10.  BMP Route Mirroring Information Codes\n   This document defines two types\
    \ for information carried in the Route\n   Mirroring Information (Section 4.7)\
    \ code:\n   o  Type = 0: Errored PDU\n   o  Type = 1: Messages Lost\n   Information\
    \ type values 0 through 32767 MUST be assigned using the\n   \"Standards Action\"\
    \ policy, and values 32768 through 65530 using the\n   \"Specification Required\"\
    \ policy, defined in [RFC5226].  Values 65531\n   through 65534 are Experimental,\
    \ and value 65535 is Reserved.\n"
- title: 11.  Security Considerations
  contents:
  - "11.  Security Considerations\n   This document defines a mechanism to obtain\
    \ a full dump or provide\n   continuous monitoring of a BGP speaker's BGP routes,\
    \ including\n   received BGP messages.  This capability could allow an outside\
    \ party\n   to obtain information not otherwise obtainable.  For example,\n  \
    \ although it's hard to consider the content of BGP routes in the\n   public Internet\
    \ to be confidential, BGP is used in private contexts\n   as well, for example,\
    \ for L3VPN [RFC4364].  As another example, a\n   clever attacker might be able\
    \ to infer the content of the monitored\n   router's import policy by comparing\
    \ the pre-policy routes exposed by\n   BMP, to post-policy routes exported in\
    \ BGP.\n   Implementations of this protocol SHOULD require manual configuration\n\
    \   of the monitored and monitoring devices.\n   Unless a transport that provides\
    \ mutual authentication is used, an\n   attacker could masquerade as the monitored\
    \ router and trick a\n   monitoring station into accepting false information,\
    \ or they could\n   masquerade as a monitoring station and gain unauthorized access\
    \ to\n   BMP data.  Unless a transport that provides confidentiality is used,\n\
    \   a passive or active attacker could gain access to, or tamper with,\n   the\
    \ BMP data in flight.\n   Where the security considerations outlined above are\
    \ a concern, users\n   of this protocol should use IPsec [RFC4303] in tunnel mode\
    \ with pre-\n   shared keys.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [RFC1213]  McCloghrie, K. and M. Rose, \"Management\
    \ Information Base\n              for Network Management of TCP/IP-based internets:\
    \ MIB-II\",\n              STD 17, RFC 1213, DOI 10.17487/RFC1213, March 1991,\n\
    \              <http://www.rfc-editor.org/info/rfc1213>.\n   [RFC2119]  Bradner,\
    \ S., \"Key words for use in RFCs to Indicate\n              Requirement Levels\"\
    , BCP 14, RFC 2119,\n              DOI 10.17487/RFC2119, March 1997,\n       \
    \       <http://www.rfc-editor.org/info/rfc2119>.\n   [RFC4271]  Rekhter, Y.,\
    \ Ed., Li, T., Ed., and S. Hares, Ed., \"A\n              Border Gateway Protocol\
    \ 4 (BGP-4)\", RFC 4271,\n              DOI 10.17487/RFC4271, January 2006,\n\
    \              <http://www.rfc-editor.org/info/rfc4271>.\n   [RFC4724]  Sangli,\
    \ S., Chen, E., Fernando, R., Scudder, J., and Y.\n              Rekhter, \"Graceful\
    \ Restart Mechanism for BGP\", RFC 4724,\n              DOI 10.17487/RFC4724,\
    \ January 2007,\n              <http://www.rfc-editor.org/info/rfc4724>.\n   [RFC5226]\
    \  Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n              IANA\
    \ Considerations Section in RFCs\", BCP 26, RFC 5226,\n              DOI 10.17487/RFC5226,\
    \ May 2008,\n              <http://www.rfc-editor.org/info/rfc5226>.\n   [RFC6793]\
    \  Vohra, Q. and E. Chen, \"BGP Support for Four-Octet\n              Autonomous\
    \ System (AS) Number Space\", RFC 6793,\n              DOI 10.17487/RFC6793, December\
    \ 2012,\n              <http://www.rfc-editor.org/info/rfc6793>.\n   [RFC7606]\
    \  Chen, E., Ed., Scudder, J., Ed., Mohapatra, P., and K.\n              Patel,\
    \ \"Revised Error Handling for BGP UPDATE Messages\",\n              RFC 7606,\
    \ DOI 10.17487/RFC7606, August 2015,\n              <http://www.rfc-editor.org/info/rfc7606>.\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [RFC1155]  Rose, M. and K. McCloghrie, \"Structure\
    \ and identification\n              of management information for TCP/IP-based\
    \ internets\",\n              STD 16, RFC 1155, DOI 10.17487/RFC1155, May 1990,\n\
    \              <http://www.rfc-editor.org/info/rfc1155>.\n   [RFC2856]  Bierman,\
    \ A., McCloghrie, K., and R. Presuhn, \"Textual\n              Conventions for\
    \ Additional High Capacity Data Types\",\n              RFC 2856, DOI 10.17487/RFC2856,\
    \ June 2000,\n              <http://www.rfc-editor.org/info/rfc2856>.\n   [RFC4303]\
    \  Kent, S., \"IP Encapsulating Security Payload (ESP)\",\n              RFC 4303,\
    \ DOI 10.17487/RFC4303, December 2005,\n              <http://www.rfc-editor.org/info/rfc4303>.\n\
    \   [RFC4364]  Rosen, E. and Y. Rekhter, \"BGP/MPLS IP Virtual Private\n     \
    \         Networks (VPNs)\", RFC 4364, DOI 10.17487/RFC4364, February\n      \
    \        2006, <http://www.rfc-editor.org/info/rfc4364>.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   Thanks to Ebben Aries, Michael Axelrod, Serpil Bayraktar,\
    \ Tim Evens,\n   Pierre Francois, Jeffrey Haas, John Ioannidis, John Kemp, Mack\n\
    \   McBride, Danny McPherson, David Meyer, Dimitri Papadimitriou, Tom\n   Petch,\
    \ Robert Raszuk, Erik Romijn, Peter Schoenmaker, and the members\n   of the GROW\
    \ working group for their comments.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   John Scudder (editor)\n   Juniper Networks\n   1194 N.\
    \ Mathilda Ave.\n   Sunnyvale, CA  94089\n   United States\n   Email: jgs@juniper.net\n\
    \   Rex Fernando\n   Cisco Systems\n   170 W. Tasman Dr.\n   San Jose, CA  95134\n\
    \   United States\n   Email: rex@cisco.com\n   Stephen Stuart\n   Google\n   1600\
    \ Amphitheatre Parkway\n   Mountain View, CA  94043\n   United States\n   Email:\
    \ sstuart@google.com\n"
