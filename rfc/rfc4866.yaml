- title: __initial_text__
  contents:
  - '              Enhanced Route Optimization for Mobile IPv6

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The IETF Trust (2007).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies an enhanced version of Mobile IPv6 route\n\
    \   optimization, providing lower handoff delays, increased security, and\n  \
    \ reduced signaling overhead.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n      4.4. Receiving Binding Acknowledgment Messages .................23\n\
    \      4.5. Sending CGA Parameters ....................................25\n  \
    \    4.6. Receiving CGA Parameters ..................................26\n    \
    \  4.7. Sending Permanent Home Keygen Tokens ......................27\n      4.8.\
    \ Receiving Permanent Home Keygen Tokens ....................28\n      4.9. Renewing\
    \ Permanent Home Keygen Tokens .....................28\n      4.10. Handling Payload\
    \ Packets .................................28\n      4.11. Credit Aging .............................................31\n\
    \      4.12. Simultaneous Movements ...................................32\n  \
    \ 5. Option Formats and Status Codes ................................32\n    \
    \  5.1. CGA Parameters Option .....................................32\n      5.2.\
    \ Signature Option ..........................................33\n      5.3. Permanent\
    \ Home Keygen Token Option ........................34\n      5.4. Care-of Test\
    \ Init Option ..................................35\n      5.5. Care-of Test Option\
    \ .......................................35\n      5.6. CGA Parameters Request\
    \ Option .............................36\n      5.7. Status Codes ..............................................36\n\
    \   6. Security Considerations ........................................38\n  \
    \    6.1. Home Address Ownership ....................................39\n    \
    \  6.2. Care-of Address Ownership .................................41\n      6.3.\
    \ Credit-Based Authorization ................................43\n      6.4. Time\
    \ Shifting Attacks .....................................46\n      6.5. Replay\
    \ Attacks ............................................47\n      6.6. Resource\
    \ Exhaustion .......................................47\n      6.7. IP Address\
    \ Ownership of Correspondent Node ................47\n   7. Protocol Constants\
    \ and Configuration Variables .................49\n   8. IANA Considerations ............................................50\n\
    \   9. Acknowledgments ................................................50\n  \
    \ 10. References ....................................................51\n    \
    \  10.1. Normative References .....................................51\n      10.2.\
    \ Informative References ...................................51\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv6 route optimization [1] enables mobile and correspondent\n\
    \   nodes to communicate via a direct routing path despite changes in IP\n   connectivity\
    \ on the mobile node side.  Both end nodes use a stable\n   \"home address\" in\
    \ identifying the mobile node at stack layers above\n   IP, while payload packets\
    \ are sent or received via a \"care-of\n   address\" that routes to the mobile\
    \ node's current network attachment.\n   Mobile IPv6 swaps the home and care-of\
    \ addresses when a payload\n   packet traverses the IP layer.  The association\
    \ between a mobile\n   node's home address and care-of address is called a \"\
    binding\" for the\n   mobile node.  It is the responsibility of the mobile node\
    \ to update\n   its binding at the correspondent node through a \"correspondent\n\
    \   registration\" when it changes IP connectivity.  A correspondent\n   registration\
    \ further involves the mobile node's home agent, which\n   proxies the mobile\
    \ node at the home address and mainly serves as a\n   relay for payload packets\
    \ exchanged with correspondent nodes that do\n   not support route optimization.\
    \  The mobile node keeps the home agent\n   up to date about its current care-of\
    \ address by means of \"home\n   registrations\".\n   From a security perspective,\
    \ the establishment of a binding during a\n   correspondent registration requires\
    \ the correspondent node to verify\n   the mobile node's ownership of both the\
    \ home address and the care-of\n   address.  Unprecedented impersonation and flooding\
    \ threats [5] would\n   arise if correspondent nodes took liberties with respect\
    \ to these\n   obligations.  A correspondent registration hence incorporates a\
    \ \"home\n   address test\" and a \"care-of address test\", collectively called\
    \ the\n   \"return routability procedure\".  These tests allow the correspondent\n\
    \   node to probe the mobile node's reachability at the home and care-of\n   addresses\
    \ in an ad hoc, non-cryptographic manner.  Successful\n   reachability verification\
    \ at both IP addresses indicates (though it\n   does not guarantee) the mobile\
    \ node's ownership of the IP addresses,\n   and hence that a binding between the\
    \ home address and the care-of\n   address is legitimate.\n   The advantage of\
    \ the return routability procedure is that it is\n   lightweight and does not\
    \ depend on a public-key infrastructure or on\n   a preexisting relationship between\
    \ the mobile node and the\n   correspondent node.  This facilitates a broad deployment.\
    \  On the\n   other hand, the procedure has an adverse impact on handoff delays\n\
    \   since both the home address test and the care-of address test consist\n  \
    \ of an end-to-end message exchange between the mobile node and the\n   correspondent\
    \ node.  The latency of the home address test may be\n   particularly high because\
    \ it routes through the home agent.  The\n   return routability procedure is also\
    \ vulnerable to attackers that are\n   in a position where they can interpose\
    \ in the home or care-of address\n   test.  The value of interposing is limited\
    \ in that the return\n   routability procedure must be repeated in intervals of\
    \ at most 7\n   minutes, even in the absence of changes in IP connectivity on\
    \ the\n   mobile node side.  But this comes at the cost of an increased\n   signaling\
    \ overhead.  Much effort has therefore gone into improvements\n   for Mobile IPv6\
    \ route optimization [6] that mitigate these\n   disadvantages.\n   This document\
    \ specifies Enhanced Route Optimization, an amendment to\n   route optimization\
    \ in base Mobile IPv6.  Enhanced Route Optimization\n   secures a mobile node's\
    \ home address against impersonation through an\n   interface identifier that\
    \ is cryptographically and verifiably bound\n   [2] to the public component of\
    \ the mobile node's public/private-key\n   pair.  The mobile node proves ownership\
    \ of the home address by\n   providing evidence that it knows the corresponding\
    \ private key.  An\n   initial home address test validates the home address prefix;\n\
    \   subsequent home address tests are unnecessary.  Enhanced Route\n   Optimization\
    \ further allows mobile and correspondent nodes to resume\n   bidirectional communications\
    \ in parallel with pursuing a care-of\n   address test.  The latency of the home\
    \ and care-of address tests are\n   therefore eliminated in most cases.  The use\
    \ of cryptographically\n   generated home addresses also mitigates the threat\
    \ of impersonators\n   that can interpose on the home address test and thereby\
    \ facilitate\n   longer binding lifetimes.  This leads to increased security and\
    \ a\n   reduction in signaling overhead.  Cryptographically generated home\n \
    \  addresses and concurrent care-of address tests are preferably applied\n   together,\
    \ but a mobile node may choose to use only one of these\n   enhancements.\n  \
    \ The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\"\
    ,\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in\
    \ this\n   document are to be interpreted as described in [3].\n"
- title: 2.  Objectives
  contents:
  - "2.  Objectives\n   The design of route optimization in base Mobile IPv6 is in\
    \ many ways\n   conservative, leaving room to optimize handoff delay, security,\
    \ and\n   signaling overhead.  Enhanced Route Optimization tackles these issues\n\
    \   and thus constitutes a more progressive variant of Mobile IPv6.\n   Despite\
    \ any Mobile IPv6 optimizations, it is important to take into\n   account that\
    \ mobility-related activities elsewhere in the protocol\n   stack may have their\
    \ own impact.  For example, attachment procedures,\n   access control, and authentication\
    \ at the link layer contribute their\n   own handoff delays.  So do IP layer tasks\
    \ such as router discovery,\n   neighbor discovery, movement detection, and IP\
    \ address configuration.\n   The handoff delays and signaling overhead of Mobile\
    \ IPv6 are\n   typically small compared to the total delay and overhead.  The\n\
    \   improvements of Enhanced Route Optimization hence ought to be seen in\n  \
    \ view of the entire protocol stack.\n"
- title: 2.1.  Handoff Latency
  contents:
  - "2.1.  Handoff Latency\n   The typical handoff delay in base Mobile IPv6 route\
    \ optimization is\n   one round-trip time between the mobile node and the home\
    \ agent for\n   the home registration, one round-trip time between the mobile\
    \ node\n   and the home agent plus one round-trip time between the home agent\n\
    \   and the correspondent node for the return routability procedure, and\n   one\
    \ one-way time from the mobile node to the correspondent node for\n   the propagation\
    \ of the Binding Update message.  (The assumption here\n   is that the latency\
    \ of the return routability procedure is dominated\n   by the home address test.)\
    \  The first payload packet sent to the new\n   care-of address requires one additional\
    \ one-way time to propagate\n   from the correspondent node to the mobile node.\
    \  The mobile node can\n   resume transmissions right after it has dispatched\
    \ the Binding Update\n   message.  But if it requests a Binding Acknowledgment\
    \ message from\n   the correspondent node, communications are usually delayed\
    \ until this\n   is received.\n   Handoff delays in base Mobile IPv6 route optimization\
    \ are additive to\n   other delays at the IP layer or link layer.  They can cause\n\
    \   perceptible quality degradations for interactive and real-time\n   applications.\
    \  TCP bulk-data transfers are likewise affected since\n   long handoff latencies\
    \ may lead to successive retransmission timeouts\n   and degraded throughput [7].\
    \  An objective of Enhanced Route\n   Optimization is hence a reduction of the\
    \ handoff latency.\n"
- title: 2.2.  Security
  contents:
  - "2.2.  Security\n   The return routability procedure was designed with the objective\
    \ to\n   provide a level of security that compares to that of today's non-\n \
    \  mobile Internet [5].  As such, it protects against impersonation,\n   denial-of-service,\
    \ and flooding threats that do not exist in the non-\n   mobile Internet, but\
    \ that the introduction of mobility would\n   introduce in the absence of appropriate\
    \ countermeasures.  In\n   particular, the return routability procedure satisfies\
    \ the following\n   requirements:\n   o  An attacker off the path from a correspondent\
    \ node to a victim\n      should not be able to trick a correspondent node into\
    \ redirecting\n      packets, which should normally be delivered to a victim,\
    \ to\n      itself, or to a third IP address.  The attacker could otherwise\n\
    \      impersonate the victim to the correspondent node or cause denial\n    \
    \  of service against the victim.  The attacker may launch these\n      attacks\
    \ from an arbitrary position, which would not necessarily\n      have to be on\
    \ the path between the victim and the correspondent\n      node.\n   o  An attacker\
    \ off the path from a correspondent node to a victim\n      should not be able\
    \ to trick the correspondent node into\n      redirecting packets, which should\
    \ normally be delivered to the\n      attacker itself, to the victim.  The attacker\
    \ could otherwise\n      flood the victim with unrequested packets.  Such \"redirection-\n\
    \      based flooding\" may be appealing to the attacker because the\n      burden\
    \ of generating the flooding packets and sending them to the\n      victim would\
    \ be on the correspondent node rather than on the\n      attacker.  The attacker\
    \ could spoof multiple correspondent nodes\n      into flooding the same victim.\
    \  This would enable the attacker to\n      impact the victim much stronger than\
    \ with a direct flooding\n      attack, where the attacker itself would generate\
    \ and send the\n      flooding packets.  Comparable amplification is today only\
    \ possible\n      through an army of compromised nodes [8].  One way to cause\n\
    \      redirection-based flooding is this: The attacker could accomplish\n   \
    \   the initial TCP handshake for a voluminous file download through\n      its\
    \ own IP address, and subsequently bind the victim's IP address\n      (as a care-of\
    \ address) to the attacker's own IP address (or home\n      address).  The correspondent\
    \ node thereby redirects the download\n      to the victim.  The attacker could\
    \ spoof acknowledgments on behalf\n      of the victim based on the sequence numbers\
    \ it learned during the\n      initial handshake in order to maintain or accelerate\
    \ the download.\n      The acknowledgments would be smaller and typically less\
    \ than the\n      full-sized segments that the correspondent node generates, hence\n\
    \      facilitating the amplification.\n   o  Attackers should not be able to\
    \ cause denial of service against\n      mobile or correspondent nodes through\
    \ exploiting expensive\n      computations involved in the mobility protocol.\n\
    \   The return routability procedure precludes impersonation, denial of\n   service,\
    \ and redirection-based flooding by attackers that are not on\n   the path from\
    \ a correspondent node to a victim, and it is\n   sufficiently lightweight not\
    \ to expose expensive operations.  But the\n   return routability procedure fails\
    \ to protect against attackers that\n   are located on the path from the correspondent\
    \ node to the victim.\n   Applications that require a higher security level are\
    \ generally\n   advised to use end-to-end protection such as IP security (IPsec)\
    \ or\n   Transport Layer Security (TLS).  But even then are they vulnerable to\n\
    \   denial of service or flooding.  Furthermore, end-to-end security\n   mechanisms\
    \ generally require mobile and correspondent nodes to be\n   preconfigured with\
    \ authentication credentials, or they depend on a\n   public-key infrastructure.\
    \  Both would hinder a wide deployment of\n   Mobile IPv6 route optimization if\
    \ it was a prerequisite for the\n   protocol.  An objective of Enhanced Route\
    \ Optimization is hence to\n   securely authenticate mobile nodes without preconfigured\
    \ credentials\n   or a public-key infrastructure, even in the presence of attackers\
    \ on\n   the path from the correspondent node to the victim.\n"
- title: 2.3.  Signaling Overhead
  contents:
  - "2.3.  Signaling Overhead\n   A complete correspondent registration involves six\
    \ message\n   transmissions at the mobile node, totaling about 376 bytes [9].\
    \  This\n   signaling overhead may be acceptable if movements are infrequent.\n\
    \   For example, a mobile node that moves once every 30 minutes generates\n  \
    \ an average of 1.7 bits/s of signaling traffic.  Higher mobility\n   causes more\
    \ substantial overhead, however.  A cell size of 100 meters\n   and a speed of\
    \ 120 km/h yields a change in IP connectivity every 3 s\n   and about 1,000 bits/s\
    \ of signaling traffic.  This is significant\n   compared to a highly compressed\
    \ voice stream with a typical data rate\n   of 10,000 to 30,000 bits/s.\n   Furthermore,\
    \ base Mobile IPv6 requires mobile nodes to renew a\n   correspondent registration\
    \ at least every 7 minutes.  The signaling\n   overhead amounts to 7.16 bits/s\
    \ if the mobile node communicates with\n   a stationary node [9].  It doubles\
    \ if both peers are mobile.  This\n   overhead may be negligible when the nodes\
    \ communicate, but it can be\n   an issue for mobile nodes that are inactive and\
    \ stay at the same\n   location for a while.  These nodes typically prefer to\
    \ go to standby\n   mode to conserve battery power.  Also, the periodic refreshments\n\
    \   consume a fraction of the wireless bandwidth that one could use more\n   efficiently.\
    \  These observations lead to the objective of Enhanced\n   Route Optimization\
    \ to reduce the signaling overhead of a base Mobile\n   IPv6 correspondent registrations\
    \ as much as possible, in particular\n   when the mobile node does not move for\
    \ a while.\n"
- title: 3.  Protocol Design
  contents:
  - "3.  Protocol Design\n   Enhanced Route Optimization consists of a set of optimizations\
    \ that\n   collectively afford the achievement of the objectives discussed in\n\
    \   Section 2.  These optimizations are summarized in the following.\n"
- title: 3.1.  Cryptographically Generated Home Addresses
  contents:
  - "3.1.  Cryptographically Generated Home Addresses\n   A Mobile IPv6 binding is\
    \ conceptually a packet redirection from a\n   home address to a care-of address.\
    \  The home address is the source of\n   the redirection and the care-of address\
    \ is the destination.  The\n   packets to be redirected can hence be identified\
    \ based on the home\n   address.  This motivates a cryptographic ownership proof\
    \ for the home\n   address.  Enhanced Route Optimization applies cryptographically\n\
    \   generated home addresses for this purpose [10][11].  In general, a\n   Cryptographically\
    \ Generated Address (CGA) provides a strong,\n   cryptographic binding between\
    \ its interface identifier and the CGA\n   owner's public key.  This facilitates\
    \ a cryptographic home address\n   ownership proof without a public-key infrastructure,\
    \ enabling other\n   nodes to securely and autonomously authenticate the CGA owner\
    \ as\n   such, modulo the correctness of the CGA's subnet prefix.\n   Cryptographically\
    \ generated home addresses can supersede home address\n   tests with the exception\
    \ of an initial test for validating the home\n   address prefix.  This facilitates\
    \ lower handoff delays and longer\n   binding lifetimes, as well as reduced signaling\
    \ overhead for mobile\n   nodes that temporarily do not move.  Enhanced Route\
    \ Optimization also\n   optionally enables the correspondent node to prove ownership\
    \ of its\n   IP address.\n"
- title: 3.2.  Non-Cryptographic Care-of Addresses
  contents:
  - "3.2.  Non-Cryptographic Care-of Addresses\n   In contrast to a home address,\
    \ a care-of address does not have\n   identifying functionality.  There is hence\
    \ little benefit in a\n   cryptographic ownership proof of a care-of address.\
    \  Given that the\n   care-of address is the destination of a packet redirection,\
    \ it is\n   rather the mobile node's reachability at the care-of address that\n\
    \   matters.  Enhanced Route Optimization uses care-of address tests for\n   this\
    \ purpose, but allows correspondent nodes to send packets to a new\n   care-of\
    \ address before the mobile node has been found to be reachable\n   there.\n"
- title: 3.3.  Semi-Permanent Security Associations
  contents:
  - "3.3.  Semi-Permanent Security Associations\n   CGA-based authentication involves\
    \ public-key cryptography and is\n   hence computationally much less efficient\
    \ than authentication through\n   a shared secret key.  The technique further\
    \ requires a substantial\n   amount of supplementary CGA parameters to be piggybacked\
    \ onto\n   protected messages.  Enhanced Route Optimization mitigates these\n\
    \   disadvantages in that it utilizes an initial CGA-based authentication\n  \
    \ to securely exchange a secret permanent home keygen token between a\n   mobile\
    \ node and a correspondent node.  The permanent home keygen\n   token is used\
    \ to authenticate the mobile node more efficiently in\n   subsequent correspondent\
    \ registrations.  Mobile and correspondent\n   nodes renew the permanent home\
    \ keygen token on an infrequent basis.\n   The token is therefore neither constant\
    \ nor short-lived, which is why\n   the security association between the mobile\
    \ node and the\n   correspondent node is called \"semi-permanent\".\n"
- title: 3.4.  Initial Home Address Tests
  contents:
  - "3.4.  Initial Home Address Tests\n   An initial home address test is necessary\
    \ despite a cryptographic\n   proof of home address ownership to protect against\
    \ spoofed subnet\n   prefixes in home addresses.  In the complete absence of home\
    \ address\n   tests, a malicious node could cryptographically generate a home\n\
    \   address with the subnet prefix of a victim network, and request a\n   correspondent\
    \ node to register a binding between this spoofed home\n   address and the attacker's\
    \ own care-of address.  The attacker then\n   tricks the correspondent node into\
    \ sending a stream of packets to the\n   care-of address and subsequently deregisters\
    \ the binding or lets it\n   expire.  The consequence is that the correspondent\
    \ node redirects the\n   packet stream \"back\" to the home address, causing the\
    \ victim network\n   to be flooded with unrequested packets.  To preclude such\
    \ misuse, an\n   initial home address test is required for the mobile node and\
    \ the\n   correspondent node to establish a semi-permanent security\n   association.\
    \  The home address test is, if possible, executed in\n   proactive manner so\
    \ as to save a potentially costly message exchange\n   via the home agent during\
    \ the critical handoff period.  The home\n   address test does not need to be\
    \ repeated upon subsequent movements.\n"
- title: 3.5.  Concurrent Care-of Address Tests
  contents:
  - "3.5.  Concurrent Care-of Address Tests\n   Enhanced Route Optimization allows\
    \ a correspondent node to send\n   payload packets to a mobile node's new care-of\
    \ address before the\n   mobile node has been found to be reachable at the care-of\
    \ address.\n   When the mobile node changes IP connectivity, it first updates\
    \ its\n   binding at the correspondent node to the new care-of address without\n\
    \   providing a proof of reachability.  The correspondent node registers\n   the\
    \ new care-of address on a tentative basis and sets it to\n   UNVERIFIED state.\
    \  Payload packets can then be exchanged\n   bidirectionally via the new care-of\
    \ address, while the mobile node's\n   reachability at the new care-of address\
    \ is verified concurrently.\n   The correspondent node moves the care-of address\
    \ to VERIFIED state\n   once reachability verification completes.\n"
- title: 3.6.  Credit-Based Authorization
  contents:
  - "3.6.  Credit-Based Authorization\n   Concurrent care-of address tests without\
    \ additional protection would\n   enable an attacker to trick a correspondent\
    \ node into temporarily\n   redirecting payload packets, which would otherwise\
    \ be addressed to\n   the attacker itself, to the IP address of a victim.  Such\n\
    \   \"redirection-based flooding\" [5] may be appealing to the attacker\n   because\
    \ the correspondent node (not the attacker) generates the\n   flooding packets\
    \ and sends them to the victim.  This enables the\n   attacker to amplify the\
    \ strength of the attack to a significant\n   degree compared to a direct flooding\
    \ attack where the attacker itself\n   would generate the flooding packets.\n\
    \   Enhanced Route Optimization protects against redirection-based\n   flooding\
    \ attacks through the use of Credit-Based Authorization.\n   Credit-Based Authorization\
    \ manages the effort that a correspondent\n   node expends in sending payload\
    \ packets to a care-of address in\n   UNVERIFIED state so as to ensure that a\
    \ redirection-based flooding\n   attack cannot be more effective than direct flooding.\
    \  The ability to\n   send unrequested packets is an inherent property of packet-oriented\n\
    \   networks, and direct flooding is a threat that results from this.\n   Since\
    \ direct flooding exists with and without mobility support, and\n   redirection-based\
    \ flooding attacks cannot be any more efficient than\n   this, Credit-Based Authorization\
    \ increases the security level\n   provided by Enhanced Route Optimization with\
    \ respect to flooding to\n   that of the non-mobile Internet.  Enhanced Route\
    \ Optimization\n   therefore satisfies the objective to provide a security level\n\
    \   comparable to that of the non-mobile Internet.\n   The measuring and limiting\
    \ of effort are technically realized through\n   the concept of \"credit\", which\
    \ a correspondent node maintains to put\n   its own effort in relation to the\
    \ effort that a mobile node expends\n   during regular communications with the\
    \ correspondent node.  The\n   correspondent node increases the credit for payload\
    \ packets it\n   receives from a care-of address of the mobile node in VERIFIED\
    \ state,\n   and it reduces the credit in proportion to its own effort for sending\n\
    \   payload packets to a care-of address of the mobile node in UNVERIFIED\n  \
    \ state.\n"
- title: 3.7.  Parallel Home and Correspondent Registrations
  contents:
  - "3.7.  Parallel Home and Correspondent Registrations\n   Enhanced Route Optimization\
    \ enables mobile nodes to pursue a\n   correspondent registration in parallel\
    \ with the respective home\n   registration.  This reduces handoff delays compared\
    \ to base Mobile\n   IPv6, which requires mobile nodes to wait for a Binding\n\
    \   Acknowledgment message indicating a successful home registration\n   before\
    \ they initiate a correspondent registration.\n"
- title: 4.  Protocol Operation
  contents:
  - "4.  Protocol Operation\n   Enhanced Route Optimization allows a mobile node to\
    \ securely\n   authenticate to a correspondent node based on the CGA property\
    \ of its\n   home address, and to request a concurrent care-of address test for\n\
    \   increased handoff efficiency.  Depending on whether the mobile node\n   wishes\
    \ to take advantage of either or both of these enhancements, the\n   messages\
    \ exchanged during a correspondent registration are different.\n   This is described\
    \ in the following.\n"
- title: 4.1.  Sending Binding Update Messages
  contents:
  - "4.1.  Sending Binding Update Messages\n   A mobile node may initiate a correspondent\
    \ registration for any of\n   the following reasons:\n   o  To establish a new\
    \ binding at a correspondent node while away from\n      its home link so that\
    \ subsequent packets will be route-optimized\n      and no longer be routed through\
    \ the mobile node's home agent.\n   o  To update an existing binding at the correspondent\
    \ node while\n      moving from one point of IP attachment to another.\n   o \
    \ To follow up an early Binding Update message with a complete\n      Binding\
    \ Update message after receiving a Binding Acknowledgment\n      message with\
    \ a Care-of Test option.\n   o  To refresh an existing binding at the correspondent\
    \ node without\n      changing the current point of IP attachment.\n   o  To request\
    \ the correspondent node to renew an existing permanent\n      home keygen token\
    \ shared between the mobile node and the\n      correspondent node (see Section\
    \ 4.5).\n   o  To request the correspondent node to deregister an existing\n \
    \     binding.\n     Mobile node               Home agent           Correspondent\
    \ node\n         |                         |                         |\n     \
    \    |                         |                         |\n         ~ Handoff\
    \                 |                         |\n         |                    \
    \     |                         |\n         |-Binding Update--------->|      \
    \                   |\n         |-early Binding Update + Care-of Test Init option-->|\n\
    \         |                         |                         |\n         |  \
    \                       |                         |\n         |<------------Binding\
    \ Ack-|                         |\n         |<----------early Binding Ack + Care-of\
    \ Test option-|\n         |                         |                        \
    \ |\n         |                         |                         |\n        \
    \ |-Binding Update----------------------------------->|\n         |          \
    \               |                         |\n         |                      \
    \   |                         |\n         |<--------------------------------------Binding\
    \ Ack-|\n         |                         |                         |\n    Figure\
    \ 1: Correspondent registration with authentication by a proof\n     of the mobile\
    \ node's knowledge of a permanent home keygen token;\n                      concurrent\
    \ care-of address test\n   In any of these cases, the mobile node sends a Binding\
    \ Update message\n   to the correspondent node.  The Binding Update message is\n\
    \   authenticated by one of the following three authentication methods:\n   o\
    \  If the mobile node's home address is a CGA, but the mobile node\n      does\
    \ not have a permanent home keygen token in its Binding Update\n      List entry\
    \ for the correspondent node, the mobile node SHOULD\n      authenticate the Binding\
    \ Update message based on the CGA property\n      of its home address.  This requires\
    \ the mobile node to send its\n      CGA parameters and signature to the correspondent\
    \ node and to pass\n      a check of reachability at the home address.\n   o \
    \ If the mobile node's home address is a CGA, and the mobile node\n      has a\
    \ permanent home keygen token in its Binding Update List entry\n      for the\
    \ correspondent node, the mobile node MUST authenticate the\n      Binding Update\
    \ message by a proof of its knowledge of the\n      permanent home keygen token.\n\
    \   o  If the mobile node's home address is not a CGA, the mobile node\n     \
    \ MUST authenticate the Binding Update message through a proof of\n      reachability\
    \ at its home address.\n   The lifetime requested by the mobile node in the Lifetime\
    \ field of\n   the Binding Update message MUST NOT exceed MAX_CGA_BINDING_LIFETIME\n\
    \   (see Section 7) if the Binding Update message is to be authenticated\n   based\
    \ on the CGA property of the mobile node's home address or by a\n   proof of the\
    \ mobile node's knowledge of a permanent home keygen\n   token.  If the selected\
    \ authentication method is a proof of the\n   mobile node's reachability at the\
    \ home address, the lifetime MUST NOT\n   exceed MAX_RR_BINDING_LIFETIME [1].\
    \  It is RECOMMENDED in all cases\n   that the mobile node requests the maximum\
    \ permitted lifetime in order\n   to avoid unnecessary binding refreshes and thus\
    \ reduce signaling\n   overhead.  The Lifetime field of a Binding Update message\
    \ that\n   requests the deletion of an existing binding at the correspondent\n\
    \   node MUST be set to zero.\n   If the selected authentication method is by\
    \ way of the CGA property\n   of the mobile node's home address, the mobile node\
    \ includes its CGA\n   parameters and signature in the Binding Update message\
    \ by adding one\n   or more CGA Parameters options (see Section 5.1) directly\
    \ followed by\n   a Signature option (see Section 5.2).  This is described in\n\
    \   Section 4.5.  Once a permanent home keygen token has been obtained\n   from\
    \ the correspondent node, the mobile node MUST authenticate all\n   subsequent\
    \ Binding Update messages by a proof of its knowledge of\n   this permanent home\
    \ keygen token until either the binding lifetime\n   expires, the permanent home\
    \ keygen token is renewed, or the mobile\n   node explicitly deregisters the binding\
    \ at the correspondent node.\n   This ensures that an attacker on the path from\
    \ the correspondent node\n   to the mobile node's home address cannot downgrade\
    \ the mobile node's\n   chosen authentication method to a proof of reachability\
    \ at the home\n   address.  The mobile node MAY choose to ignore the CGA property\
    \ of\n   its home address and authenticate Binding Update messages through a\n\
    \   proof of reachability at the home address.  However, this behavior\n   increases\
    \ the vulnerability to on-path attackers and is therefore NOT\n   RECOMMENDED.\n\
    \     Mobile node              Home agent          Correspondent node\n      \
    \   |                         |                         |\n         |        \
    \                 |                         |\n         |-Home Test Init--------->|------------------------>|\n\
    \         |                         |                         |\n         |<------------------------|<--------------Home\
    \ Test-|\n         |                         |                         |\n   \
    \      |                         |                         |\n         ~ Handoff\
    \                 |                         |\n         |                    \
    \     |                         |\n         |-Binding Update--------->|      \
    \                   |\n         |-early Binding Update + Care-of Test Init option-->|\n\
    \         |                         |                         |\n         |  \
    \                       |                         |\n         |<------------Binding\
    \ Ack-|                         |\n         |<----------early Binding Ack + Care-of\
    \ Test option-|\n         |                         |                        \
    \ |\n         |                         |                         |\n        \
    \ |-Binding Update----------------------------------->|\n         |          \
    \               |                         |\n         |                      \
    \   |                         |\n         |<--------------------------------------Binding\
    \ Ack-|\n         |                         |                         |\n    \
    \ Figure 2: Correspondent registration with authentication based on\n     reachability\
    \ verification at the home address; concurrent care-of\n                     \
    \          address test\n   The mobile node also includes its CGA parameters in\
    \ the Binding\n   Update message when it intends to renew an existing permanent\
    \ home\n   keygen token shared with the correspondent node.  This is\n   accomplished,\
    \ as before, by adding to the message one or more CGA\n   Parameters options and\
    \ a Signature option.\n   The authenticator for the Binding Update message is\
    \ calculated based\n   on a permanent or temporary home keygen token.  Which type\
    \ of home\n   keygen token the mobile node uses in calculating the authenticator\n\
    \   depends on the authentication method:\n   o  If the Binding Update message\
    \ is to be authenticated based on the\n      CGA property of the mobile node's\
    \ home address, the mobile node\n      MUST use a temporary home keygen token\
    \ from the correspondent\n      node.  The mobile node may already have a valid\
    \ temporary home\n      keygen token in its Binding Update List entry for the\n\
    \      correspondent node, or it may retrieve one through the exchange of\n  \
    \    a Home Test Init message and a Home Test message.\n   o  If the Binding Update\
    \ message is to be authenticated by a proof of\n      the mobile node's knowledge\
    \ of a permanent home keygen token, the\n      mobile node MUST use the permanent\
    \ home keygen token that is has\n      in its Binding Update List entry for the\
    \ correspondent node.\n   o  If the Binding Update message is to be authenticated\
    \ through a\n      proof of reachability at the home address, the mobile node\
    \ MUST\n      use a temporary home keygen token from the correspondent node. \
    \ As\n      before, the mobile node may already have a valid temporary home\n\
    \      keygen token in its Binding Update List entry for the\n      correspondent\
    \ node, or it may retrieve one through the exchange of\n      a Home Test Init\
    \ message and a Home Test message.\n   Unless the purpose of the Binding Update\
    \ message is to delete an\n   existing binding at the correspondent node, the\
    \ authenticator is also\n   calculated based on a care-of keygen token.  The mobile\
    \ node selects\n   this as follows:\n   o  If the mobile node has a valid care-of\
    \ keygen token for the to-be-\n      registered care-of address in its Binding\
    \ Update List entry for\n      the correspondent node, the mobile node MUST use\
    \ this in\n      calculating the authenticator for the Binding Update message.\
    \  The\n      Binding Update message is in this case \"complete\".\n   o  If the\
    \ mobile node does not have a valid care-of keygen token in\n      its Binding\
    \ Update List entry for the correspondent node, the\n      mobile node SHOULD\
    \ define the care-of keygen token to be zero and\n      use this in calculating\
    \ the authenticator for the Binding Update\n      message.  The Binding Update\
    \ message is in this case \"early\".\n   o  If the mobile node does not have a\
    \ valid care-of keygen token in\n      its Binding Update List entry for the correspondent\
    \ node, the\n      mobile node MAY choose to retrieve a care-of keygen token through\n\
    \      the exchange of a Care-of Test Init message and a Care-of Test\n      message,\
    \ as defined in [1], without sending an early Binding\n      Update message. \
    \ In this case, the mobile node waits for receipt\n      of the Care-of Test message\
    \ and uses the care-of\n      keygen token contained therein in calculating the\
    \ authenticator\n      for a complete Binding Update message.  This approach increases\n\
    \      the handoff latency, however, and is therefore NOT RECOMMENDED.\n   For\
    \ reduced handoff delays, the mobile node SHOULD simultaneously\n   initiate home\
    \ and correspondent registrations for a particular\n   care-of address.  The mobile\
    \ node SHOULD also pursue home and\n   correspondent deregistrations in parallel\
    \ if it wishes to discontinue\n   Mobile IPv6 service while away from its home\
    \ link.  However, when the\n   mobile node commits home and correspondent deregistrations\
    \ after\n   returning back to the home link after a period of roaming, the mobile\n\
    \   node MUST initiate the home deregistration first, and it MUST wait\n   for\
    \ a Binding Acknowledgment message indicating a successful home\n   deregistration\
    \ before it initiates the correspondent deregistration.\n   This behavior ensures\
    \ that the home agent does not proxy the mobile\n   node's home address while\
    \ the mobile node is on the home link, hence\n   preventing interference between\
    \ the mobile node and the home agent\n   during Duplicate Address Detection. \
    \ Since a home deregistration\n   consumes only a link-local round-trip time when\
    \ the mobile node\n   pursues it from the home link, the cost of not parallelizing\
    \ it with\n   a correspondent deregistration, in terms of increased handoff delay,\n\
    \   is typically negligible.\n   Moreover, when the Binding Update message for\
    \ the correspondent\n   registration is to be authenticated based on the CGA property\
    \ of the\n   mobile node's home address or through a proof of reachability at\
    \ the\n   home address, the mobile node SHOULD initiate the exchange of Home\n\
    \   Test Init and Home Test messages prior to handoff in order to\n   proactively\
    \ elicit a fresh home keygen token from the correspondent\n   node.  This reduces\
    \ handoff delays further.  A Home Test Init message\n   may be sent periodically\
    \ whenever the home keygen token previously\n   acquired from the correspondent\
    \ node is about to expire.  Tokens are\n   valid for 3.5 minutes [1], so the interval\
    \ between successive Home\n   Test Init messages should be a little less.  Alternatively,\
    \ the\n   mobile node may be able to send the Home Test Init message right in\n\
    \   time if its link layer provides a trigger announcing imminent\n   handoff.\
    \  Proactive home address tests are technically feasible\n   because a home address\
    \ does not change across handoffs.\n   If the mobile node initiates the home address\
    \ test from the home\n   link, it MUST address the Home Test Init message directly\
    \ to the\n   correspondent node.  The Home Test message will then be received\n\
    \   directly from the correspondent node.  If the home address test is\n   initiated\
    \ from a visited link, the mobile node MUST tunnel the Home\n   Test Init message\
    \ to the home agent.  The Home Test message will then\n   be tunneled back to\
    \ the mobile node by the home agent.  A home\n   address test SHOULD NOT overlap\
    \ with a home registration or home\n   deregistration since this could result\
    \ in the loss of the Home Test\n   Init or Home Test message.\n   If the Binding\
    \ Update message is early, the mobile node MUST add a\n   Care-of Test Init option\
    \ (see Section 5.4) to the message, requesting\n   the correspondent node to return\
    \ a new care-of keygen token.  The\n   Care-of Test Init option MUST follow the\
    \ CGA Parameters and Signature\n   options, if those exist in the Binding Update\
    \ message.  Once a\n   responding Binding Acknowledgment message with a Care-of\
    \ Test option\n   (see Section 5.5) is received, the mobile node MUST use the\
    \ care-of\n   keygen token contained therein in calculating the authenticator\
    \ for a\n   complete Binding Update message and send this message to the\n   correspondent\
    \ node.\n   If the Binding Update message is authenticated based on the CGA\n\
    \   property of the mobile node's home address, the mobile node MAY add a\n  \
    \ CGA Parameters Request option (see Section 5.6) to the Binding Update\n   message\
    \ so as to request the correspondent node to prove ownership of\n   its IP address\
    \ within the Binding Acknowledgment message.  This\n   ownership proof enables\
    \ the mobile node to verify that the permanent\n   home keygen token returned\
    \ in the Binding Acknowledgment message was\n   generated by the right correspondent\
    \ node.\n   The mobile node includes the nonce indices associated with the\n \
    \  selected home and care-of keygen tokens in the Binding Update message\n   using\
    \ a Nonce Indices option [1].  The home nonce index is thereby\n   determined\
    \ as follows:\n   o  If the Binding Update message is to be authenticated based\
    \ on the\n      CGA property of the mobile node's home address, the mobile node\n\
    \      uses a temporary home keygen token to calculate the authenticator\n   \
    \   for the Binding Update message, and the associated home nonce\n      index\
    \ MUST be taken from the Home Test message with which the home\n      keygen token\
    \ was obtained.\n   o  If the Binding Update message is to be authenticated by\
    \ a proof of\n      the mobile node's knowledge of a permanent home keygen token,\
    \ the\n      home nonce index MUST be set to zero.\n   o  If the Binding Update\
    \ message is to be authenticated through a\n      proof of the mobile node's reachability\
    \ at the home address, the\n      mobile node uses a temporary home keygen token\
    \ to calculate the\n      authenticator for the Binding Update message, and the\
    \ associated\n      home nonce index MUST be taken from the Home Test message\
    \ with\n      which the home keygen token was obtained.\n   The care-of nonce\
    \ index is determined according to the following\n   rules:\n   o  If the Binding\
    \ Update message is complete, the care-of nonce index\n      is taken from the\
    \ Care-of Test option or Care-of Test message with\n      which the care-of keygen\
    \ token (used to calculate the\n      authenticator for the Binding Update message)\
    \ was obtained.\n   o  If the Binding Update message is early, the care-of nonce\
    \ index\n      MUST be set to zero.\n   o  If the purpose of the Binding Update\
    \ message is to delete a\n      binding at the correspondent node, the care-of\
    \ nonce index MUST be\n      set to zero.\n   The Nonce Indices option follows\
    \ the CGA Parameters, Signature,\n   Care-of Test Init, and CGA Parameters Request\
    \ options if those are\n   included in the Binding Update message as well.\n \
    \  The mobile node finally calculates an authenticator for the Binding\n   Update\
    \ message based on the selected home and care-of keygen tokens,\n   following\
    \ the rules described in Section 5.2 and Section 6.2.7 of\n   [1].  For a Binding\
    \ Update message that requests the deletion of an\n   existing binding at the\
    \ correspondent node, the authenticator is\n   calculated based on only a home\
    \ keygen token, and it does not\n   incorporate a care-of keygen token.  The authenticator\
    \ is placed into\n   the Authenticator field of a Binding Authorization Data option\
    \ [1],\n   which the mobile node adds to the Binding Update message as the last\n\
    \   option.\n     Mobile node               Home agent           Correspondent\
    \ node\n         |                         |                         |\n     \
    \    |                         |                         |\n         ~ Handoff\
    \                 |                         |\n         |                    \
    \     |                         |\n         |-Binding Update--------->|      \
    \                   |\n         |-Care-of Test Init-------------------------------->|\n\
    \         |                         |                         |\n         |  \
    \                       |                         |\n         |<------------Binding\
    \ Ack-|                         |\n         |<-------------------------------------Care-of\
    \ Test-|\n         |                         |                         |\n   \
    \      |                         |                         |\n         |-Binding\
    \ Update----------------------------------->|\n         |                    \
    \     |                         |\n         |                         |      \
    \                   |\n         |<--------------------------------------Binding\
    \ Ack-|\n         |                         |                         |\n    Figure\
    \ 3: Correspondent registration with authentication by a proof\n     of the mobile\
    \ node's knowledge of a permanent home keygen token;\n                       explicit\
    \ care-of address test\n   The time-sequence diagrams in Figure 1 through Figure\
    \ 3 illustrate\n   the operation of Enhanced Route Optimization based on a few\
    \ selected\n   message exchanges.  Figure 1 shows the messages exchanged for a\n\
    \   correspondent registration where an early Binding Update message is\n   authenticated\
    \ by a proof of the mobile node's knowledge of a\n   permanent home keygen token.\
    \  A Care-of Test Init option in the early\n   Binding Update message requests\
    \ the correspondent node to add to the\n   Binding Acknowledgment message a fresh\
    \ care-of keygen token in a\n   Care-of Test option.  The mobile node finally\
    \ concludes the\n   correspondent registration with a complete Binding Update\
    \ message.\n   Figure 2 shows the procedure of a correspondent registration where\n\
    \   the Binding Update message is authenticated with a proof of\n   reachability\
    \ at the home address.  The home address test is\n   proactively performed prior\
    \ to handoff, permitting the mobile node to\n   issue a Binding Update message\
    \ directly after the handoff.  The\n   Binding Update message is again early,\
    \ and a care-of keygen token is\n   delivered to the mobile node along with the\
    \ Binding Acknowledgment\n   message.  Figure 3 depicts a correspondent registration\
    \ where the\n   mobile node initially obtains a fresh care-of keygen token through\n\
    \   the dedicated exchange of Care-of Test Init and Care-of Test\n   messages.\
    \  It subsequently issues a complete Binding Update message\n   that is authenticated\
    \ with the CGA property of the home address.\n"
- title: 4.2.  Receiving Binding Update Messages
  contents:
  - "4.2.  Receiving Binding Update Messages\n   When the correspondent node receives\
    \ a Binding Update message, it\n   must first verify whether the sending mobile\
    \ node is the legitimate\n   owner of the home address specified in the message.\
    \  The\n   correspondent node selects the authentication method based on the\n\
    \   home nonce index given in the Nonce Indices option of the Binding\n   Update\
    \ message, and on the existence of CGA Parameters and Signature\n   options in\
    \ the Binding Update message:\n   o  If the home nonce index is set to a non-null\
    \ value and the Binding\n      Update message includes one or more CGA Parameters\
    \ options\n      followed by a Signature option, the correspondent node MUST\n\
    \      authenticate the Binding Update message based on the CGA property\n   \
    \   of the mobile node's home address.\n   o  If the home nonce index is zero\
    \ and the Binding Update message\n      does not include one or more CGA Parameters\
    \ options followed by a\n      Signature option, the correspondent node MUST authenticate\
    \ the\n      Binding Update message by a proof of the mobile node's knowledge\n\
    \      of a permanent home keygen token.\n   o  If the home nonce index is set\
    \ to a non-null value and the Binding\n      Update message does not include one\
    \ or more CGA Parameters options\n      followed by a Signature option, the correspondent\
    \ node MUST\n      authenticate the Binding Update message through a proof of\
    \ the\n      mobile node's reachability at the home address.\n   In addition to\
    \ the validation procedure for Binding Update messages\n   specified in [1], the\
    \ correspondent node must take the following\n   additional steps to reject Binding\
    \ Update messages that are\n   inappropriately authenticated:\n   o  If the Binding\
    \ Update message includes one or more CGA Parameters\n      options followed by\
    \ a Signature option and the home nonce index is\n      zero, the correspondent\
    \ node MUST send a Binding Acknowledgment\n      message with status code 150\
    \ (\"Non-null home nonce index\n      expected\").  This ensures that a Binding\
    \ Update message that is\n      authenticated based on the CGA property of the\
    \ mobile node's home\n      address must also provide a proof of the mobile node's\n\
    \      reachability at the home address.\n   o  If the Binding Update message\
    \ is to be authenticated by a proof of\n      the mobile node's knowledge of a\
    \ permanent home keygen token, the\n      correspondent node MUST verify that\
    \ it has a Binding Cache entry\n      for the mobile node that includes a permanent\
    \ home keygen token.\n      In case the correspondent node does not have a Binding\
    \ Cache entry\n      for the mobile node, or if the existing Binding Cache entry\
    \ for\n      the mobile node does not include a permanent home keygen token,\n\
    \      the correspondent node MUST reject the Binding Update message by\n    \
    \  sending a Binding Acknowledgment message with status code 147\n      (\"Permanent\
    \ home keygen token unavailable\").\n   o  If the Binding Update message is to\
    \ be authenticated through a\n      proof of the mobile node's reachability at\
    \ the home address, the\n      correspondent node MUST verify that it does not\
    \ have a permanent\n      home keygen token in its Binding Cache entry for the\
    \ mobile node.\n      If the correspondent node has a permanent home keygen token\
    \ in its\n      Binding Cache entry for the mobile node, it MUST reject the\n\
    \      Binding Update message by sending a Binding Acknowledgment message\n  \
    \    with status code 149 (\"Permanent home keygen token exists\").  This\n  \
    \    ensures that an attacker cannot downgrade the authentication\n      method\
    \ to hijack the binding of a legitimate mobile node.\n   The authenticator for\
    \ the Binding Update message is calculated based\n   on a permanent or temporary\
    \ home keygen token.  Which type of home\n   keygen token the correspondent node\
    \ uses in validating the\n   authenticator, and how it retrieves or recomputes\
    \ the home keygen\n   token, depends on the authentication method:\n   o  If the\
    \ Binding Update message is to be authenticated based on the\n      CGA property\
    \ of the mobile node's home address, the correspondent\n      node MUST recompute\
    \ the temporary home keygen token defined by the\n      (non-null) home nonce\
    \ index in the Nonce Indices option of the\n      Binding Update message, and\
    \ it MUST use this recomputed token in\n      validating the authenticator of\
    \ the message.\n   o  If the Binding Update message is to be authenticated by\
    \ a proof of\n      the mobile node's knowledge of a permanent home keygen token,\
    \ the\n      correspondent node MUST use the permanent home keygen token that\n\
    \      it has in its Binding Cache entry for the mobile node in\n      validating\
    \ the authenticator of the Binding Update message.\n   o  If the Binding Update\
    \ message is to be authenticated through\n      verification of the mobile node's\
    \ reachability at the home\n      address, the correspondent node MUST recompute\
    \ the temporary home\n      keygen token defined by the (non-null) home nonce\
    \ index in the\n      Nonce Indices option of the Binding Update message, and\
    \ it MUST\n      use this recomputed token in validating the authenticator of\
    \ the\n      message.\n   Unless the purpose of the Binding Update message is\
    \ to delete an\n   existing binding at the correspondent node, the authenticator\
    \ is also\n   calculated based on a care-of keygen token.  Which care-of keygen\n\
    \   token the correspondent node uses in validating the authenticator\n   depends\
    \ on whether the Binding Update message is complete or early:\n   o  If the care-of\
    \ nonce index in the Nonce Indices option of the\n      Binding Update message\
    \ is set to a non-null value, the Binding\n      Update message is complete. \
    \ In this case, the correspondent node\n      MUST recompute the care-of keygen\
    \ token that is identified by the\n      care-of nonce index, and it MUST use\
    \ this recomputed token in\n      validating the authenticator of the message.\n\
    \   o  If the care-of nonce index in the Nonce Indices option of the\n      Binding\
    \ Update message is zero, the Binding Update message is\n      early.  The care-of\
    \ keygen token to be used by the correspondent\n      node in validating the authenticator\
    \ of the Binding Update message\n      is zero in this case.\n   The correspondent\
    \ node finally validates the authenticator in the\n   Binding Update message based\
    \ on the selected home and care-of keygen\n   tokens, following the algorithm\
    \ described in Section 9.5.1 of [1].\n   If the validation fails, the correspondent\
    \ node MUST discard the\n   Binding Update message.  The correspondent node may\
    \ have to send a\n   Binding Acknowledgment message with a status code indicating\
    \ the\n   failure, as described in [1].\n   Provided that the validation of the\
    \ authenticator in the Binding\n   Update message succeeds, the correspondent\
    \ node registers the mobile\n   node's new care-of address, either updating an\
    \ existing Binding Cache\n   entry, if one exists, or creating a new Binding Cache\
    \ entry.  The\n   lifetime granted for the binding depends on the lifetime requested\
    \ by\n   the mobile node in the Lifetime field of the Binding Update message\n\
    \   and the method by which the Binding Update message is authenticated.\n   If\
    \ the Binding Update message is authenticated based on the CGA\n   property of\
    \ the mobile node's home address or by a proof of the\n   mobile node's knowledge\
    \ of a permanent home keygen token, the\n   lifetime for the binding SHOULD be\
    \ set to the maximum of\n   MAX_CGA_BINDING_LIFETIME and the value specified in\
    \ the Lifetime\n   field of the Binding Update message.  If the Binding Update\
    \ message\n   is authenticated through a proof of the mobile node's reachability\
    \ at\n   the home address, then the lifetime for the binding SHOULD be set to\n\
    \   the maximum of MAX_RR_BINDING_LIFETIME [1] and the value specified in\n  \
    \ the Lifetime field of the Binding Update message.  The correspondent\n   node\
    \ may in either case grant a further reduced lifetime, but it MUST\n   NOT accept\
    \ a higher lifetime.\n   The state of the new care-of address depends on whether\
    \ the Binding\n   Update message is complete or early:\n   o  If the Binding Update\
    \ message is complete, the new care-of address\n      is set to VERIFIED state.\
    \  The correspondent node may then\n      immediately send packets to the new\
    \ care-of address without\n      restrictions.\n   o  If the Binding Update message\
    \ is early, the new care-of address is\n      set to UNVERIFIED state.  The correspondent\
    \ node MUST then follow\n      the rules defined in Section 4.10 for sending packets\
    \ to this\n      care-of address until the care-of address is set in VERIFIED\n\
    \      state.\n   If the Binding Update message contains one or multiple CGA Parameters\n\
    \   options, the mobile node is requesting the correspondent node to\n   accept\
    \ the included CGA parameters either for establishing a new, or\n   for renewing\
    \ an existing permanent home keygen token shared between\n   the mobile node and\
    \ the correspondent node.  The correspondent node\n   MUST in this case check\
    \ if the CGA Parameters options are directly\n   followed by a Signature option\
    \ and, if so, validate the CGA\n   parameters and signature as described in Section\
    \ 4.6.\n   If the CGA Parameters option is not directly followed by a Signature\n\
    \   option, or the validation of the included CGA parameters and\n   signature\
    \ fails, the correspondent node MUST discard the Binding\n   Update message and\
    \ send a Binding Acknowledgment message with status\n   code 148 (\"CGA and signature\
    \ verification failed\") to the mobile\n   node.\n   Provided that the signature\
    \ included in the Signature option is\n   correct, the correspondent node generates\
    \ a permanent home keygen\n   token to be shared with the mobile node and stores\
    \ it in its Binding\n   Cache entry for the mobile node.  The permanent home keygen\
    \ token is\n   sent to the mobile node within a Binding Acknowledgment message\
    \ as\n   described in Section 4.3.\n"
- title: 4.3.  Sending Binding Acknowledgment Messages
  contents:
  - "4.3.  Sending Binding Acknowledgment Messages\n   Upon receipt of a valid Binding\
    \ Update message, the correspondent\n   node returns to the mobile node a Binding\
    \ Acknowledgment message in\n   any of the following cases:\n   o  The Acknowledge\
    \ flag in the Binding Update message is set.\n   o  The Binding Update message\
    \ contains one or multiple CGA Parameters\n      options directly followed by\
    \ a Signature option, and the signature\n      included in the latter was determined\
    \ to be correct.\n   o  The Binding Update message is early and includes a Care-of\
    \ Test\n      Init option.\n   If the Binding Update message further contains\
    \ a CGA Parameters\n   Request option and the correspondent node's IP address\
    \ is a CGA, the\n   correspondent node MUST include its CGA parameters and signature\
    \ in\n   the Binding Acknowledgment message by adding one or more CGA\n   Parameters\
    \ options directly followed by a Signature option.  The\n   correspondent node's\
    \ CGA parameters and signature enable the mobile\n   node to verify that the permanent\
    \ home keygen token received in the\n   Binding Acknowledgment message was generated\
    \ by the right\n   correspondent node.  If the Binding Update message contains\
    \ a CGA\n   Parameters Request option, but the correspondent node's IP address\
    \ is\n   not a CGA, the correspondent node ignores the CGA Parameters Request\n\
    \   option and processes the Binding Update message further as described\n   below.\n\
    \   If the Binding Update message contains one or multiple CGA Parameters\n  \
    \ options directly followed by a Signature option, and the signature\n   included\
    \ in the latter was determined to be correct, the\n   correspondent node MUST\
    \ add a Permanent Home Keygen Token option (see\n   Section 5.3) with a new permanent\
    \ home keygen token to the Binding\n   Acknowledgment message.  The correspondent\
    \ node also stores this\n   permanent home keygen token in its Binding Cache entry\
    \ for the mobile\n   node.\n   If the Binding Update message includes a Care-of\
    \ Test Init option,\n   the correspondent node MUST append to the Binding Acknowledgment\n\
    \   message a Care-of Test option with a pseudo-random value in the\n   Care-of\
    \ Keygen Token field.  The Care-of Test option MUST appear\n   after the Permanent\
    \ Home Keygen Token option in case both options are\n   present in the Binding\
    \ Acknowledgment message.\n   A Binding Authorization Data option must be added\
    \ to the Binding\n   Acknowledgment message as a last option, as described in\
    \ Section 5.2\n   and Section 6.2.7 of [1].\n"
- title: 4.4.  Receiving Binding Acknowledgment Messages
  contents:
  - "4.4.  Receiving Binding Acknowledgment Messages\n   A mobile node first verifies\
    \ a received Binding Acknowledgment\n   message according to the rules specified\
    \ in [1].  Provided that the\n   Binding Acknowledgment message is not rejected\
    \ based on these rules,\n   the mobile node takes the following additional steps.\n\
    \   If the mobile node included a CGA Parameters Request option in the\n   Binding\
    \ Update message and the Binding Acknowledgment message\n   contains a Permanent\
    \ Home Keygen Token option, the mobile node first\n   processes any CGA Parameters\
    \ and Signature options in the Binding\n   Acknowledgment message in the following\
    \ manner.  If the Binding\n   Acknowledgment message contains one or more CGA\
    \ Parameters options\n   that are directly followed by a Signature option, the\
    \ mobile node\n   MUST check the ownership of the correspondent node's IP address\
    \ by\n   verifying the included CGA parameters and signature as described in\n\
    \   Section 4.6.  If the validation of the CGA parameters and signature\n   fails,\
    \ the mobile node MUST silently discard the Binding\n   Acknowledgment message.\
    \  The mobile node MUST also silently discard\n   the Binding Acknowledgment message\
    \ if the message includes one or\n   more CGA Parameters options that are not\
    \ directly followed by a\n   Signature option, or if the Binding Acknowledgment\
    \ message lacks any\n   CGA Parameters options in the presence of a Signature\
    \ option.\n   If the mobile node did not include a CGA Parameters Request option\
    \ in\n   the Binding Update message or the Binding Acknowledgment message does\n\
    \   not contain a Permanent Home Keygen Token option, the mobile node\n   ignores\
    \ any CGA Parameters and Signature options that the Binding\n   Acknowledgment\
    \ message may contain.  Careful use of the CGA\n   Parameters Request option in\
    \ Binding Update messages enables the\n   mobile node to control the processing\
    \ resources it spends on the\n   verification of a correspondent node's CGA as\
    \ well as to disable such\n   verification in the case of persistent verification\
    \ failures, which\n   may be due to misconfigured or outdated CGA software [12]\
    \ on the\n   correspondent node side or at the mobile node itself.  Specifically,\n\
    \   if the mobile node repeatedly fails to receive a Binding\n   Acknowledgment\
    \ message including valid CGA Parameters and Signature\n   options in response\
    \ to sending a Binding Update message with a CGA\n   Parameters Request option,\
    \ the mobile node SHOULD refrain from\n   including a CGA Parameters Request option\
    \ in future Binding Update\n   messages for the same correspondent node.\n   If\
    \ the mobile node included a CGA Parameters Request option in the\n   Binding\
    \ Update message, but the Binding Acknowledgment message does\n   not contain\
    \ any CGA Parameters or Signature options, the mobile node\n   cannot be sure\
    \ if the correspondent node's IP address is simply not a\n   CGA, or if the Binding\
    \ Acknowledgment message originates from an\n   attacker on the path from the\
    \ mobile node to the correspondent node.\n   To avoid accepting a permanent home\
    \ keygen token from an on-path\n   attacker, the mobile node MUST give precedence\
    \ to Binding\n   Acknowledgment messages that include valid CGA Parameters and\n\
    \   Signature options over Binding Acknowledgment messages without such\n   options.\
    \  One possible algorithm for the mobile node to follow in\n   this regard is\
    \ to always accept the Binding Acknowledgment message\n   received first, and\
    \ if this message does not contain valid CGA\n   Parameters or Signature options\
    \ and another Binding Acknowledgment\n   message including such options is received\
    \ later on, to revert any\n   state changes involved in accepting the first Binding\
    \ Acknowledgment\n   in favor of this subsequent Binding Acknowledgment message.\
    \  Giving\n   precedence to Binding Acknowledgment messages with valid CGA\n \
    \  Parameters and Signature options over Binding Acknowledgment messages\n   without\
    \ such options enables the mobile node to communicate with\n   correspondent nodes\
    \ that do not use a CGA, and at the same time\n   protects against most on-path\
    \ attackers.  The strategy does not\n   protect against an attacker that can intercept\
    \ Binding Acknowledgment\n   messages from the correspondent node, but such an\
    \ attacker could\n   preclude mobility management between the mobile node and\
    \ the\n   correspondent node anyway.  When the mobile node has permanently\n \
    \  accepted a Binding Acknowledgment message without valid CGA\n   Parameters\
    \ and Signature options, the mobile node SHOULD refrain from\n   including a CGA\
    \ Parameters Request option in future Binding Update\n   messages for the same\
    \ correspondent node.\n   If the Binding Acknowledgment message contains a Permanent\
    \ Home\n   Keygen Token option, the mobile node extracts the permanent home\n\
    \   keygen token included in this option and stores it in its Binding\n   Update\
    \ List entry for the correspondent node.  Future Binding Update\n   messages will\
    \ then be authenticated by a proof of the mobile node's\n   knowledge of this\
    \ permanent home keygen token.\n   If the Binding Acknowledgment message contains\
    \ a Care-of Test option,\n   the mobile node extracts the care-of keygen token\
    \ included in this\n   option, stores the token in its Binding Update List entry\
    \ for the\n   correspondent node, and sends the correspondent node a complete\n\
    \   Binding Update message as defined in Section 4.1.  Note that the\n   complete\
    \ Binding Update message will be authenticated based on the\n   CGA property of\
    \ the mobile node's home address if the Binding\n   Acknowledgment message also\
    \ includes a Permanent Home Keygen Token\n   option.  This is independent of the\
    \ authentication method that was\n   used for the corresponding early Binding\
    \ Update message.\n   A mobile node MUST ensure that, while it has a binding for\
    \ a certain\n   home address at a correspondent node, it also has a valid binding\
    \ at\n   its home agent for the same home address.  This may at times require\n\
    \   the mobile node to extend the binding lifetime at the home agent,\n   request\
    \ a correspondent node to use a binding lifetime less than the\n   permitted maximum,\
    \ or explicitly deregister an existing binding at a\n   correspondent node.\n\
    \   If the mobile node authenticates Binding Update messages for a\n   particular\
    \ correspondent node by proving its knowledge of a permanent\n   home keygen token,\
    \ but registrations at this correspondent node\n   persistently fail, the mobile\
    \ node SHOULD renew the permanent home\n   keygen token by sending a Binding Update\
    \ message that is\n   authenticated based on the CGA property of its home address.\
    \  This\n   Binding Update message includes the mobile node's CGA parameters and\n\
    \   signature, and it requests the correspondent node to generate a new\n   permanent\
    \ home keygen token and send this to the mobile node within a\n   Binding Acknowledgment\
    \ message.\n   If the mobile node persistently receives Binding Acknowledgment\n\
    \   messages with status code 148 (\"CGA and signature verification\n   failed\"\
    ) from a correspondent node, the mobile node SHOULD\n   authenticate future Binding\
    \ Update messages for the same\n   correspondent nodes through a proof of its\
    \ reachability at the home\n   address.  This enables the mobile node to recover\
    \ from misconfigured\n   or outdated CGA software [12] on the correspondent node\
    \ side or at\n   the mobile node itself.\n"
- title: 4.5.  Sending CGA Parameters
  contents:
  - "4.5.  Sending CGA Parameters\n   A mobile node includes its CGA parameters and\
    \ signature in a Binding\n   Update message for a correspondent node in any of\
    \ the following\n   situations:\n   o  To acquire a permanent home keygen token\
    \ if the mobile node's home\n      address is a CGA, and the mobile node does\
    \ not yet have a\n      permanent home keygen token from the correspondent node.\n\
    \   o  To extend the lifetime of an existing binding if the mobile node\n    \
    \  already has a permanent home keygen token from the correspondent\n      node,\
    \ and the lifetime of the binding at the correspondent node is\n      about to\
    \ expire.\n   o  To renew an existing permanent home keygen token to prevent replay\n\
    \      attacks in the imminent event of a sequence number rollover, or\n     \
    \ for improved protection against cryptanalysis.\n   A correspondent node whose\
    \ IP address is a CGA includes its CGA\n   parameters and signature in a Binding\
    \ Acknowledgment message for the\n   mobile node when it receives a Binding Update\
    \ message with a CGA\n   Parameters Request option.\n   CGA parameters are transmitted\
    \ in the format of the CGA Parameters\n   data structure defined in [2].  The\
    \ CGA Parameters data structure is\n   split over one or more CGA Parameters options\
    \ as described in\n   Section 5.1.  The last CGA Parameters option MUST be directly\n\
    \   followed by a Signature option.\n   The value for the Signature field in the\
    \ Signature option is\n   calculated according to the signature generation algorithm\
    \ defined in\n   Section 6 of [2].  The value is calculated with the mobile or\n\
    \   correspondent node's private key over the following sequence of\n   octets:\n\
    \      mobility data =\n         care-of address | correspondent node IP address\
    \ | MH data\n   where \"|\" denotes concatenation.  \"Care-of address\" is the\
    \ mobile\n   node's care-of address, and \"correspondent node IP address\" is\
    \ the IP\n   address of the correspondent node that is visible to protocol layers\n\
    \   above IP.  In case the correspondent node is mobile, \"correspondent\n   node\
    \ IP address\" refers to the correspondent node's home address.\n   \"MH data\"\
    \ is the content of the Binding Update or Binding\n   Acknowledgment message including\
    \ the mobility header and all options\n   up to the last CGA Parameters option.\
    \  That is, \"MH data\" excludes\n   the IPv6 header and any IPv6 extension headers\
    \ other than the\n   mobility header itself.  The \"mobility data\" constitutes\
    \ what is\n   referred to as the \"message\" in Section 6 of [2].\n   The value\
    \ for the Signature field is calculated as if the Checksum\n   field in the mobility\
    \ header was zero.  The Checksum field in the\n   transmitted packet is still\
    \ calculated in the usual manner, with the\n   calculated value in the Signature\
    \ field being a part of the packet\n   protected by the checksum.\n"
- title: 4.6.  Receiving CGA Parameters
  contents:
  - "4.6.  Receiving CGA Parameters\n   Mobile and correspondent nodes that receive\
    \ a Binding Update or\n   Binding Acknowledgment message including one or more\
    \ CGA Parameters\n   options directly followed by a Signature option first process\
    \ the\n   message as described in [1].  This includes a verification of the\n\
    \   authenticator in the Authenticator field of the Binding Authorization\n  \
    \ Data option.  If the Binding Update or Binding Acknowledgment message\n   is\
    \ rejected due to an incorrect authenticator or for any other\n   reason, the\
    \ message is not processed further.\n   Otherwise, if the validation of the Binding\
    \ Update or Binding\n   Acknowledgment message succeeds, the mobile or correspondent\
    \ node\n   reassembles the CGA Parameters data structure from the CGA Parameters\n\
    \   options included in the message as described in Section 5.1, and\n   executes\
    \ the CGA verification algorithm defined in Section 5 of [2].\n   The CGA verification\
    \ algorithm takes the to-be-verified CGA and the\n   reassembled CGA Parameters\
    \ data structure as input.  The to-be-\n   verified CGA is the mobile node's home\
    \ address when the CGA\n   verification algorithm is executed by the correspondent\
    \ node.  When\n   the mobile node executes the CGA verification algorithm, the\
    \ to-be-\n   verified CGA is the correspondent node's IP address that is visible\n\
    \   to protocol layers above IP.  This is the correspondent node's home\n   address\
    \ in case the correspondent node is mobile.  The following\n   steps are skipped\
    \ if the CGA verification fails.\n   If the CGA verification succeeds, the mobile\
    \ or correspondent node\n   performs a more time-consuming check of the signature.\
    \  It extracts\n   the signature from the Signature field in the Signature option\
    \ and\n   executes the signature verification algorithm defined in Section 6 of\n\
    \   [2].  The signature verification algorithm takes as input the to-be-\n   verified\
    \ CGA as defined above, the reassembled CGA Parameters data\n   structure, the\
    \ MH data as defined in Section 4.5, the CGA Message\n   Type tag of Enhanced\
    \ Route Optimization as defined in Section 7, and\n   the signature itself.\n"
- title: 4.7.  Sending Permanent Home Keygen Tokens
  contents:
  - "4.7.  Sending Permanent Home Keygen Tokens\n   A correspondent node assigns a\
    \ mobile node a new permanent home\n   keygen token after it has received from\
    \ the mobile node a Binding\n   Update message with included CGA Parameters and\
    \ Signature options,\n   and these options have been successfully validated as\
    \ described in\n   Section 4.6.  The permanent home keygen token is a 64-bit value\n\
    \   randomly generated by the correspondent node.  The correspondent node\n  \
    \ stores the permanent home keygen token in the binding cache entry\n   that it\
    \ maintains for the mobile node.\n   The correspondent node sends the permanent\
    \ home keygen token to the\n   mobile node in encrypted form within a Permanent\
    \ Home Keygen Token\n   option in a Binding Acknowledgment message.  It sends\
    \ this message\n   even if the Acknowledge flag in the corresponding Binding Update\n\
    \   message was clear.  The correspondent node encrypts the permanent\n   home\
    \ keygen token with the mobile node's public key using the\n   RSAES-PKCS1-v1_5\
    \ format [4], and places the ciphertext into the\n   Permanent Home Keygen Token\
    \ field of the Permanent Home Keygen Token\n   option.\n   The Binding Authorization\
    \ Data option MUST be the last option in the\n   Binding Acknowledgment message.\
    \  That is, the authenticator in the\n   Binding Authorization Data option covers\
    \ the Permanent Home Keygen\n   Token option.\n"
- title: 4.8.  Receiving Permanent Home Keygen Tokens
  contents:
  - "4.8.  Receiving Permanent Home Keygen Tokens\n   A mobile node that receives\
    \ a Binding Acknowledgment message first\n   processes the message as described\
    \ in [1], independent of whether the\n   message includes a Permanent Home Keygen\
    \ Token option.  This includes\n   a verification of the authenticator in the\
    \ Authenticator field of the\n   Binding Authorization Data option.  If the Binding\
    \ Acknowledgment\n   message is rejected due to an incorrect authenticator or\
    \ for any\n   other reason, the mobile node does not process the message further.\n\
    \   Otherwise, if the mobile node accepts the Binding Acknowledgment\n   message\
    \ and the message includes a Permanent Home Keygen Token\n   option, the mobile\
    \ node extracts the ciphertext from the Permanent\n   Home Keygen Token field\
    \ in this option and decrypts it with its\n   private key using the RSAES-PKCS1-v1_5\
    \ format [4].  The result of the\n   encryption is the permanent home keygen token\
    \ to be used in further\n   registrations with the correspondent node.  The mobile\
    \ node stores\n   the permanent home keygen token in the Binding Update List entry\
    \ that\n   it maintains for the correspondent node.\n"
- title: 4.9.  Renewing Permanent Home Keygen Tokens
  contents:
  - "4.9.  Renewing Permanent Home Keygen Tokens\n   A mobile node that shares a permanent\
    \ home keygen token with a\n   correspondent node MUST NOT use the same sequence\
    \ number twice with\n   this permanent home keygen token in order to protect against\
    \ replay\n   attacks.  The mobile node MUST renew the permanent home keygen token\n\
    \   by including its CGA parameters and signature in a Binding Update\n   message\
    \ for the correspondent node when a sequence number rollover is\n   imminent.\
    \  In addition, the mobile node MAY renew its permanent home\n   keygen token\
    \ at any time.  Periodic renewal of the permanent home\n   keygen token provides\
    \ increased protection against cryptanalysis.\n   Finally, the mobile node may\
    \ in most cases want to renew the\n   permanent home keygen token when the lifetime\
    \ of its binding at the\n   correspondent node expires.\n"
- title: 4.10.  Handling Payload Packets
  contents:
  - "4.10.  Handling Payload Packets\n   The immediate exchange of an early Binding\
    \ Update message after a\n   handoff on the mobile node side enables mobile and\
    \ correspondent\n   nodes to quickly reestablish route-optimized communications\
    \ via the\n   mobile node's new care-of address.  The mobile node may send payload\n\
    \   packets to the correspondent node from the new care-of address as\n   soon\
    \ as it has dispatched the early Binding Update message.  The\n   correspondent\
    \ node redirects outgoing payload packets for the mobile\n   node to the new care-of\
    \ address once it has received the early\n   Binding Update message and registered\
    \ the new care-of address.  Here,\n   a \"payload packet\" is defined as a packet\
    \ that originates at a\n   protocol layer above IP.\n           Inbound\n    \
    \    payload packet\n              |\n              |\n              V\n     \
    \ _________________                           _____________________\n     /  \
    \               \\                         |                     |\n    /  Care-of\
    \ address  \\     Yes                |   Increase credit   |\n   |         in\
    \          |---------------------> |     counter by      |\n    \\  VERIFIED state?\
    \  /                        | payload packet size |\n     \\_________________/\
    \                         |_____________________|\n              |           \
    \                                  |\n              |                        \
    \                     |\n              | No                                  \
    \        |\n              |                                             V\n  \
    \            |                                   _____________________\n     \
    \         |                                  |                     |\n       \
    \       |                                  |   Deliver payload   |\n         \
    \     +--------------------------------> |   packet to upper-  |\n           \
    \                                      |    layer protocol   |\n             \
    \                                    |_____________________|\n               \
    \ Figure 4: Handling outbound payload packets\n   A new care-of address that was\
    \ registered with an early Binding\n   Update message is maintained in UNVERIFIED\
    \ state by the correspondent\n   node until the correspondent node receives a\
    \ complete Binding Update\n   message from the mobile node.  The correspondent\
    \ node then sets the\n   care-of address to VERIFIED state.  The state of the\
    \ care-of address\n   determines the maximum amount of data that the correspondent\
    \ node is\n   allowed to send to the care-of address, as is necessary to prevent\n\
    \   amplified, redirection-based flooding attacks.  For this purpose, the\n  \
    \ correspondent node maintains a \"credit counter\" for each mobile node\n   with\
    \ an entry in its Binding Cache.  Whenever a payload packet\n   arrives from a\
    \ mobile node with a care-of address in VERIFIED state,\n   the correspondent\
    \ node SHOULD increase the mobile node's credit\n   counter by the size of the\
    \ received payload packet.  The\n   correspondent node MAY be restricted by policy\
    \ to increase the credit\n   counter by a lower value or not to increase the credit\
    \ at all.  The\n   credit counter does not change when an inbound payload packet\
    \ is\n   received from a care-of address in UNVERIFIED state.  Figure 4 shows\n\
    \   a flow chart of this procedure.\n           Outbound\n        payload packet\n\
    \              |\n              |\n              V\n      _________________  \
    \                         _____________________\n     /                 \\   \
    \                      |                     |\n    /  Care-of address  \\   \
    \  Yes                |    Send payload     |\n   |         in          |--------------------->\
    \ |      packet to      |\n    \\  VERIFIED state?  /                        |\
    \   care-of address   |\n     \\_________________/                         |_____________________|\n\
    \              |\n              |                                   _____________________\n\
    \              | No                               |                     |\n  \
    \            |                                  |   Discard payload   |\n    \
    \          |                      +---------> |        packet       |\n      \
    \        |                      |           |     immediately     |\n        \
    \      V                      |           |_____________________|\n      _________________\
    \              |            _____________________\n     /                 \\ \
    \            |           |                     |\n    /  Credit counter   \\ \
    \  Yes     / \\          |    Send payload     |\n   |  less than payload  |------->\
    \ |   |-------> |      packet to      |\n    \\   packet size?    /          \
    \ \\ /          |    home address     |\n     \\_________________/           \
    \  |           |_____________________|\n              |                      |\
    \            _____________________\n              |                      |   \
    \        |                     |\n              | No                   |     \
    \      |   Buffer payload    |\n              |                      +--------->\
    \ |     packet for      |\n              |                                  |\
    \ later transmission  |\n              |                                  |_____________________|\n\
    \              V\n    _____________________                         _____________________\n\
    \   |                     |                       |                     |\n  \
    \ |    Reduce credit    |                       |    Send payload     |\n   |\
    \     counter by      |---------------------> |      packet to      |\n   | payload\
    \ packet size |                       |   care-of address   |\n   |_____________________|\
    \                       |_____________________|\n                Figure 5: Handling\
    \ outbound payload packets\n   When the correspondent node has a payload packet\
    \ to send to the\n   mobile node, further treatment of the payload packet depends\
    \ on the\n   state of the mobile node's care-of address and the current value\
    \ of\n   the mobile node's credit counter, as illustrated in Figure 5: The\n \
    \  correspondent node MUST send the payload packet to the mobile node's\n   care-of\
    \ address if the care-of address is in VERIFIED state.  If the\n   care-of address\
    \ is in UNVERIFIED state and the value of the credit\n   counter is higher than\
    \ or equal to the size of the payload packet,\n   the correspondent node MUST\
    \ reduce the mobile node's credit counter\n   by the size of the payload packet\
    \ and send the payload packet to the\n   care-of address as well.  However, if\
    \ the care-of address is in\n   UNVERIFIED state and the credit counter is less\
    \ than the size of the\n   payload packet, the payload packet MUST NOT be sent\
    \ to the mobile\n   node's care-of address.  The correspondent node SHOULD then\
    \ discard\n   the payload packet, although it MAY alternatively buffer the payload\n\
    \   packet until the care-of address moves to VERIFIED state, or send the\n  \
    \ payload packet to the mobile node's home address.  The credit counter\n   of\
    \ the mobile node does not change when the correspondent node sends\n   a payload\
    \ packet to the mobile node's care-of address while the\n   care-of address is\
    \ in VERIFIED state.\n   The amount of data that the mobile node may send to the\
    \ correspondent\n   node is never restricted due to the state of the mobile node's\n\
    \   care-of address.  The care-of address state also does not change the\n   addressing\
    \ and routing of payload packets in either traffic\n   direction: All payload\
    \ packets that originate from the mobile node\n   have the care-of address in\
    \ the Source Address field of the IPv6\n   header and the home address in the\
    \ Home Address option of the IPv6\n   Destination Options extension header.  Vice\
    \ versa, all payload\n   packets from the correspondent node have the care-of\
    \ address in the\n   Destination Address field of the IPv6 header and the home\
    \ address in\n   the IPv6 Routing extension header.\n"
- title: 4.11.  Credit Aging
  contents:
  - "4.11.  Credit Aging\n   A correspondent node ensures that all credit counters\
    \ that it\n   maintains gradually decrease over time.  Each credit counter is\n\
    \   multiplied with a factor, CreditAgingFactor, of less than one in\n   fixed\
    \ time intervals of CreditAgingInterval length.  Such \"credit\n   aging\" limits\
    \ the total credit that a mobile node can earn, provided\n   that the replenishing\
    \ rate for the credit is constant or nearly\n   constant.  It thereby enforces\
    \ an upper bound on the rate at which\n   the correspondent node can durably sent\
    \ to the mobile node's care-of\n   address while the care-of address is in UNVERIFIED\
    \ state.  In the\n   absence of credit aging, a malicious node with poor up-link\
    \ capacity\n   could adopt the role of a mobile node, build up credit at a very\
    \ slow\n   speed and over a long period, and spend this credit during a much\n\
    \   shorter period on redirecting a burst of payload packets to the IP\n   address\
    \ of a victim.\n   Choosing appropriate values for CreditAgingFactor and\n   CreditAgingInterval\
    \ is important to facilitate applications where the\n   correspondent node sends\
    \ at a higher rate than the mobile node.  If\n   CreditAgingFactor or CreditAgingInterval\
    \ is too small, the credit\n   counter might persistently prevent the transmission\
    \ of payload\n   packets to a care-of address in UNVERIFIED state.  The values\
    \ given\n   in Section 7 are RECOMMENDED as they work well when the correspondent\n\
    \   node transfers a file to the mobile node via a TCP connection and the\n  \
    \ end-to-end round-trip time does not exceed 500 milliseconds.\n"
- title: 4.12.  Simultaneous Movements
  contents:
  - "4.12.  Simultaneous Movements\n   As specified in [1], Binding Update messages\
    \ are sent to a mobile\n   correspondent node's home address.  This makes it possible\
    \ for two\n   mobile nodes to continue communications even if both of them change\n\
    \   IP connectivity at the same time.\n"
- title: 5.  Option Formats and Status Codes
  contents:
  - "5.  Option Formats and Status Codes\n   Enhanced Route Optimization uses a set\
    \ of new mobility options and\n   status codes in addition to the mobility options\
    \ and status codes\n   defined in [1].  These are described below.\n"
- title: 5.1.  CGA Parameters Option
  contents:
  - "5.1.  CGA Parameters Option\n   The CGA Parameters option is used in Binding\
    \ Update and Binding\n   Acknowledgment messages.  It contains part of the mobile\
    \ or\n   correspondent node's CGA parameters. [1] limits mobility header\n   options\
    \ to a maximum length of 255 bytes, excluding the Option Type\n   and Option Length\
    \ fields.  Since the CGA parameters are likely to\n   exceed this limit, multiple\
    \ CGA Parameters options may have to be\n   concatenated to carry all CGA parameters.\n\
    \   The format of the CGA Parameters option is as follows:\n      0          \
    \         1                   2                   3\n      0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                              \
    \       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                                  \
    \   |  Option Type  | Option Length |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                                                               |\n    \
    \ :                                                               :\n     :  \
    \                        CGA Parameters                       :\n     :      \
    \                                                         :\n     |          \
    \                                                     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Option Type\n      8-bit identifier of the type of this mobility option. \
    \ Its value\n      is 12.\n   Option Length\n      8-bit unsigned integer representing\
    \ the length of the CGA\n      Parameters field in octets.\n   CGA Parameters\n\
    \      This field contains up to 255 bytes of the CGA Parameters data\n      structure\
    \ defined in [2].  The concatenation of all CGA Parameters\n      options in the\
    \ order they appear in the Binding Update message\n      MUST result in the original\
    \ CGA Parameters data structure.  All\n      CGA Parameters options in the Binding\
    \ Update message except the\n      last one MUST contain exactly 255 bytes in\
    \ the CGA Parameters\n      field, and the Option Length field MUST be set to\
    \ 255 accordingly.\n      All CGA Parameters options MUST appear directly one\
    \ after another,\n      that is, a mobility option of a different type MUST NOT\
    \ be placed\n      in between two CGA Parameters options.\n"
- title: 5.2.  Signature Option
  contents:
  - "5.2.  Signature Option\n   The Signature option is used in Binding and Binding\
    \ Acknowledgment\n   Update messages.  It contains a signature that the mobile\
    \ or\n   correspondent node generates with its private key over one or more\n\
    \   preceding CGA Parameters options.\n   The format of the Signature option is\
    \ as follows:\n      0                   1                   2               \
    \    3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \                                 |  Option Type  | Option Length |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                                                               |\n    \
    \ :                                                               :\n     :  \
    \                          Signature                          :\n     :      \
    \                                                         :\n     |          \
    \                                                     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Option Type\n      8-bit identifier of the type of this mobility option. \
    \ Its value\n      is 13.\n   Option Length\n      8-bit unsigned integer representing\
    \ the length of the Signature\n      field in octets.\n   Signature\n      This\
    \ field contains the mobile or correspondent node's signature,\n      generated\
    \ with the mobile or correspondent node's private key as\n      specified in Section\
    \ 4.5.\n"
- title: 5.3.  Permanent Home Keygen Token Option
  contents:
  - "5.3.  Permanent Home Keygen Token Option\n   The Permanent Home Keygen Token\
    \ option is used in Binding\n   Acknowledgment messages.  It contains a permanent\
    \ home keygen token,\n   which the correspondent node sends to the mobile node\
    \ after it has\n   received a Binding Update message containing one or more CGA\n\
    \   Parameters options directly followed by a Signature option from the\n   mobile\
    \ node.\n   The format of the Permanent Home Keygen Token option is as follows:\n\
    \      0                   1                   2                   3\n      0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n            \
    \                         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                \
    \                     |  Option Type  | Option Length |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                                                               |\n    \
    \ :                                                               :\n     :  \
    \                Permanent Home Keygen Token                  :\n     :      \
    \                                                         :\n     |          \
    \                                                     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Option Type\n      8-bit identifier of the type of this mobility option. \
    \ Its value\n      is 14.\n   Option Length\n      8-bit unsigned integer representing\
    \ the length of the Permanent\n      Home Keygen Token field in octets.\n   Permanent\
    \ Home Keygen Token\n      This field contains the permanent home keygen token\
    \ generated by\n      the correspondent node.  The content of this field MUST\
    \ be\n      encrypted with the mobile node's public key as defined in\n      Section\
    \ 4.7.  The length of the permanent home keygen token is 8\n      octets before\
    \ encryption, though the ciphertext [4] and, hence,\n      the Permanent Home\
    \ Keygen Token field may be longer.\n"
- title: 5.4.  Care-of Test Init Option
  contents:
  - "5.4.  Care-of Test Init Option\n   The Care-of Test Init option is included in\
    \ Binding Update messages.\n   It requests a correspondent node to return a Care-of\
    \ Test option with\n   a fresh care-of keygen token in the Binding Acknowledgment\
    \ message.\n   The format of the Care-of Test Init option is as follows:\n   \
    \   0                   1                   2                   3\n      0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                \
    \                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                    \
    \                 |  Option Type  | Option Length |\n                        \
    \             +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   Option Type\n      8-bit identifier\
    \ of the type of this mobility option.  Its value\n      is 15.\n   Option Length\n\
    \      This field MUST be set to zero.\n"
- title: 5.5.  Care-of Test Option
  contents:
  - "5.5.  Care-of Test Option\n   The Care-of Test option is used in Binding Acknowledgment\
    \ messages.\n   It contains a fresh care-of keygen token, which the correspondent\n\
    \   node sends to the mobile node after it has received a Care-of Test\n   Init\
    \ option in a Binding Update message.\n   The format of the Care-of Test option\
    \ is as follows:\n      0                   1                   2            \
    \       3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1\n                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                     |  Option Type  | Option Length |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                                                             |\n     +      \
    \               Care-of Keygen Token                      +\n     |          \
    \                                                     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Option Type\n      8-bit identifier of the type of this mobility option. \
    \ Its value\n      is 16.\n   Option Length\n      This field MUST be set to 8.\
    \  It represents the length of the\n      Care-of Keygen Token field in octets.\n\
    \   Care-of Keygen Token\n      This field contains the care-of keygen token generated\
    \ by the\n      correspondent node, as specified in Section 4.3.\n"
- title: 5.6.  CGA Parameters Request Option
  contents:
  - "5.6.  CGA Parameters Request Option\n   The CGA Parameters Request option is\
    \ included in Binding Update\n   messages that are authenticated based on the\
    \ CGA property of the\n   mobile node's home address.  It requests a correspondent\
    \ node to\n   return its CGA parameters and signature in the Binding Acknowledgment\n\
    \   message, enabling the mobile node to verify that the permanent home\n   keygen\
    \ token returned in the Binding Acknowledgment message was\n   generated by the\
    \ right correspondent node.\n   The format of the CGA Parameters Request option\
    \ is as follows:\n      0                   1                   2            \
    \       3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1\n                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                     |  Option Type  | Option Length |\n    \
    \                                 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   Option\
    \ Type\n      8-bit identifier of the type of this mobility option.  Its value\n\
    \      is 11.\n   Option Length\n      This field MUST be set to zero.\n"
- title: 5.7.  Status Codes
  contents:
  - "5.7.  Status Codes\n   Enhanced Route Optimization uses the following four new\
    \ status codes\n   for Binding Acknowledgment messages in addition to the status\
    \ codes\n   defined in [1]:\n   Permanent home keygen token unavailable (147)\n\
    \      A correspondent node returns a Binding Acknowledgment message with\n  \
    \    status code 147 to a mobile node if it has received from the\n      mobile\
    \ node a Binding Update message that was authenticated\n      through the CGA\
    \ property of the mobile node's home address, but\n      the correspondent node\
    \ either does not have a Binding Cache entry\n      for the mobile node, or the\
    \ existing Binding Cache entry for the\n      mobile node does not contain a permanent\
    \ home keygen token.  A\n      Binding Acknowledgment message with status code\
    \ 147 indicates to\n      the mobile node that it should request a new permanent\
    \ home keygen\n      token from the correspondent node by sending the correspondent\n\
    \      node a Binding Update message including its CGA parameters and\n      signature.\
    \  This in particular enables the mobile node to quickly\n      recover from state\
    \ loss at the correspondent node.\n      [1] does not allow a correspondent node\
    \ to send a Binding\n      Acknowledgment message with a status code indicating\
    \ failure when\n      the authenticator of a received Binding Update message turns\
    \ out\n      to be incorrect.  This causes additional handoff latency with high\n\
    \      probability because the mobile node can detect the problem only\n     \
    \ after the expiration of a retransmission timer.  The mobile node\n      is furthermore\
    \ likely to assume packet loss and resend the\n      incorrectly authenticated\
    \ Binding Update message additional times.\n      A Binding Acknowledgment message\
    \ with status code 147 helps the\n      mobile node to identify the underlying\
    \ problem more efficiently\n      when the correspondent node could not verify\
    \ the CGA property of\n      the mobile node's home address.\n   CGA and signature\
    \ verification failed (148)\n      A correspondent node returns a Binding Acknowledgment\
    \ message with\n      status code 148 to a mobile node if it has received from\
    \ the\n      mobile node a Binding Update message that includes one or more CGA\n\
    \      Parameters options directly followed by a Signature option, but\n     \
    \ either the CGA property of the home address cannot be verified\n      based\
    \ on the contents of the CGA Parameters options, or the\n      verification of\
    \ the signature in the Signature option has failed.\n   Permanent home keygen\
    \ token exists (149)\n      A correspondent node returns a Binding Acknowledgment\
    \ message with\n      status code 149 to a mobile node if it has received from\
    \ the\n      mobile node a Binding Update message that was authenticated\n   \
    \   through verification of the mobile node's reachability at the home\n     \
    \ address and does not include one or more CGA Parameters options\n      directly\
    \ followed by a Signature option, but the correspondent\n      node has a permanent\
    \ home keygen token in its Binding Cache entry\n      for the mobile node.  The\
    \ Binding Update message is processed\n      further if it includes one or more\
    \ CGA Parameters options directly\n      followed by a Signature option.  This\
    \ enables a mobile node to\n      obtain a new permanent home keygen token from\
    \ the correspondent\n      node in case it has lost the existing one, for instance,\
    \ due to a\n      reboot.  Whether the correspondent node accepts the Binding\
    \ Update\n      message in this case depends on the verification of the CGA\n\
    \      parameters and the signature provided in the Binding Update\n      message.\n\
    \   Non-null home nonce index expected (150)\n      A correspondent node returns\
    \ a Binding Acknowledgment message with\n      status code 150 to a mobile node\
    \ if it has received from the\n      mobile node a Binding Update message that\
    \ includes one or more CGA\n      Parameters options directly followed by a Signature\
    \ option, but\n      the home nonce index specified in the Nonce Indices option\
    \ is\n      zero.  This behavior ensures that a Binding Update message that is\n\
    \      authenticated based on the CGA property of the mobile node's home\n   \
    \   address must also provide a proof of the mobile node's\n      reachability\
    \ at the home address.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   Enhanced Route Optimization differs from base\
    \ Mobile IPv6 in that it\n   applies a set of optimizations for increased handoff\
    \ performance,\n   stronger security, and reduced signaling overhead.  These\n\
    \   optimizations entail the following conceptual changes to the security\n  \
    \ model [5] of base Mobile IPv6:\n   o  Base Mobile IPv6 conducts periodic tests\
    \ of a mobile node's\n      reachability at the home address as a proof of home\
    \ address\n      ownership.  Enhanced Route Optimization applies an initial\n\
    \      cryptographic home address ownership proof in combination with a\n    \
    \  verification of the mobile node's reachability at the home address\n      in\
    \ order to securely exchange a secret permanent home keygen\n      token.  The\
    \ permanent home keygen token is used for cryptographic\n      authentication\
    \ of the mobile node during subsequent correspondent\n      registrations, so\
    \ that these later correspondent registrations can\n      be securely bound to\
    \ the initial home address ownership proof.  No\n      further periodic reachability\
    \ verification at the home address\n      tests is performed.\n   o  Base Mobile\
    \ IPv6 requires a mobile node to prove its reachability\n      at a new care-of\
    \ address during a correspondent registration.\n      This implies that the mobile\
    \ node and the correspondent node must\n      exchange Care-of Test Init and Care-of\
    \ Test messages before the\n      mobile node can initiate the binding update\
    \ proper.  Enhanced\n      Route Optimization allows the mobile node to initiate\
    \ the binding\n      update first and follow up with a proof of reachability at\
    \ the\n      care-of address.  Mobile and correspondent nodes can so resume\n\
    \      communications early on after a handoff, while reachability\n      verification\
    \ proceeds concurrently.  The amount of data that the\n      correspondent node\
    \ is permitted to send to the care-of address\n      until reachability verification\
    \ completes is governed by Credit-\n      Based Authorization.\n   o  The maximum\
    \ binding lifetime for correspondent registrations is 7\n      minutes in base\
    \ Mobile IPv6.  A mobile node must hence\n      periodically refresh a correspondent\
    \ registration in cases where\n      it does not change IP connectivity for a\
    \ while.  This protocol\n      increases the maximum binding lifetime to 24 hours,\
    \ reducing the\n      need for periodic refreshes to a negligible degree.\n  \
    \ The ensuing discussion addresses the implications that these\n   conceptual\
    \ changes of the Mobile IPv6 security model have.  The\n   discussion ought to\
    \ be seen in context with the security\n   considerations of [1], [2], and [5].\n"
- title: 6.1.  Home Address Ownership
  contents:
  - "6.1.  Home Address Ownership\n   Enhanced Route Optimization requires a mobile\
    \ node to deliver a\n   strong cryptographic proof [2] that it is the legitimate\
    \ owner of the\n   home address it wishes to use.  The proof is based on the true\
    \ home\n   address owner's knowledge of the private component in a public/\n \
    \  private-key pair with the following two properties:\n   o  As an input to an\
    \ irreversible CGA generation function along with\n      a set of auxiliary CGA\
    \ parameters, the public key results in the\n      mobile node's home address.\n\
    \   o  Among the CGA parameters that are fed into the CGA generation\n      function\
    \ is a modifier that, as an input to an irreversible hash\n      extension function\
    \ along with the public key, results in a string\n      with a certain minimum\
    \ number of leading zeroes.  Three reserved\n      bits in the home address encode\
    \ this minimum number.\n   The first property cryptographically binds the home\
    \ address to the\n   mobile node's public key and, by virtue of public-key cryptography,\n\
    \   to the private key.  It allows the mobile node to claim ownership of\n   the\
    \ home address by proving its knowledge of the private key.  The\n   second property\
    \ increases the cost of searching in brute-force manner\n   for a public/private-key\
    \ pair that suffices the first property.  This\n   increases the security of a\
    \ cryptographically generated home address\n   despite its limitation to 59 bits\
    \ with cryptographic significance.\n   Solely enforcing the first property would\
    \ otherwise allow an attacker\n   to find a suitable public/private-key pair in\
    \ O(2^59) steps.  By\n   addition of the second property, the complexity of a\
    \ brute-force\n   search can be increased to O(2^(59+N)) steps, where N is the\
    \ minimum\n   number of leading zeroes that the result of the hash extension\n\
    \   function is required to have.\n   In practice, for a legitimate mobile node\
    \ to cryptographically\n   generate a home address, the mobile node must first\
    \ accomplish a\n   brute-force search for a suitable modifier, and then use this\n\
    \   modifier to execute the CGA generation function.  An attacker who is\n   willing\
    \ to spoof the mobile node's home address, so-called \"IP\n   address stealing\"\
    \ [5], then has two options: It could either generate\n   its own public/private-key\
    \ pair and perform a brute-force search for\n   a modifier which, in combination\
    \ with the generated public key,\n   suffices the initially described two properties;\
    \ or it could integer-\n   factor the mobile node's public key, deduce the corresponding\
    \ private\n   key, and copy the mobile node's modifier without a brute-force\n\
    \   search.  The cost of the attack can be determined by the mobile node\n   in\
    \ either case: Integer-factoring a public key becomes increasingly\n   complex\
    \ as the length of the public key grows, and the key length is\n   at the discretion\
    \ of the mobile node.  The cost of a brute-force\n   search for a suitable modifier\
    \ increases with the number of leading\n   zeroes that the result of the hash\
    \ extension function is required to\n   have.  This number, too, is a parameter\
    \ that the mobile node can\n   choose.  Downgrading attacks, where the attacker\
    \ reduces the cost of\n   spoofing a cryptographically generated home address\
    \ by choosing a set\n   of CGA parameters that are less secure than the CGA parameters\
    \ the\n   mobile node has used to generate the home address, are hence\n   impossible.\n\
    \   The CGA specification [2] requires the use of RSA public and private\n   keys,\
    \ and it stipulates a minimum key length of 384 bits.  This\n   requirement that\
    \ was tailored to Secure Neighbor Discovery for IPv6\n   [13], the original CGA\
    \ application.  Enhanced Route Optimization does\n   not increase the minimum\
    \ key length because, in the absence of\n   downgrading attacks as explained before,\
    \ the ability to use short\n   keys does not compromise the security of home addresses\
    \ that were\n   cryptographically generated using longer keys.  Moreover, extensions\n\
    \   to [2] may eventually permit the use of public/private-key classes\n   other\
    \ than RSA.  Such extensions are compatible with the CGA\n   application of Enhanced\
    \ Route Optimization.  Care must be taken in\n   selecting an appropriate key\
    \ class and length, however.  Home\n   addresses are typically rather stable in\
    \ nature, so the chosen\n   parameters must be secure for a potentially long home\
    \ address\n   lifetime.  Where RSA keys are used, a minimum key length of 1024\
    \ bits\n   is therefore RECOMMENDED.\n   While the CGA generation function cryptographically\
    \ ties the\n   interface identifier of a home address to the subnet prefix of\
    \ the\n   home address, the function accepts any subnet prefix and hence does\n\
    \   not prevent a node from cryptographically generating a home address\n   with\
    \ a spoofed subnet prefix.  As a consequence, the CGA property of\n   a home address\
    \ does not guarantee the owner's reachability at the\n   home address.  This could\
    \ be misused for a \"return-to-home flooding\n   attack\" [5], where the attacker\
    \ uses its own public key to\n   cryptographically generate a home address with\
    \ a subnet prefix from a\n   victim network, requests a correspondent node to\
    \ bind this to the\n   attacker's current care-of address, initiates the download\
    \ of a large\n   file via the care-of address, and finally deregisters the binding\
    \ or\n   lets it expire.  The correspondent node would then redirect the\n   packets\
    \ being downloaded to the victim network identified by the\n   subnet prefix of\
    \ the attacker's spoofed home address.  The protocol\n   defined in this document\
    \ performs a reachability test for the home\n   address at the time the home address\
    \ is first registered with the\n   correspondent node.  This precludes return-to-home\
    \ flooding.\n   The verification of the CGA property of a mobile node's home address\n\
    \   involves asymmetric public-key cryptography, which is relatively\n   complex\
    \ compared to symmetric cryptography.  Enhanced Route\n   Optimization mitigates\
    \ this disadvantage through the use of symmetric\n   cryptography after an initial\
    \ public-key-based verification of the\n   mobile node's home address has been\
    \ performed.  Specifically, the\n   correspondent node assigns the mobile node\
    \ a permanent home keygen\n   token during the initial correspondent registration\
    \ based on which\n   the mobile node can authenticate to the correspondent node\
    \ during\n   subsequent correspondent registrations.  Such authentication enables\n\
    \   the correspondent node to bind a subsequent correspondent\n   registration\
    \ back to the initial public-key-based verification of the\n   mobile node's home\
    \ address.  The permanent home keygen token is never\n   sent in plain text; it\
    \ is encrypted with the mobile node's public key\n   when initially assigned,\
    \ and irreversibly hashed during subsequent\n   correspondent registrations.\n"
- title: 6.2.  Care-of Address Ownership
  contents:
  - "6.2.  Care-of Address Ownership\n   A secure proof of home address ownership\
    \ can mitigate the threat of\n   IP address stealing, but an attacker may still\
    \ bind a correct home\n   address to a false care-of address and thereby trick\
    \ a correspondent\n   node into redirecting packets, which would otherwise be\
    \ delivered to\n   the attacker itself, to a third party.  Neglecting to verify\
    \ a mobile\n   node's reachability at its claimed care-of address could therefore\n\
    \   cause one or multiple correspondent nodes to unknowingly contribute\n   to\
    \ a redirection-based flooding attack against a victim chosen by the\n   attacker.\n\
    \   Redirection-based flooding attacks may target a single node, a link,\n   or\
    \ a router or other critical network device upstream of an entire\n   network.\
    \  Accordingly, the attacker's spoofed care-of address may be\n   the IP address\
    \ of a node, a random IP address from a subnet prefix of\n   a particular link,\
    \ or the IP address of a router or other network\n   device.  An attack against\
    \ a network potentially impacts a larger\n   number of nodes than an attack against\
    \ a specific node, although\n   neighbors of a victim node on a broadcast link\
    \ typically suffer the\n   same damage as the victim itself.\n   Requiring mobile\
    \ nodes to cryptographically generate care-of\n   addresses in the same way as\
    \ they generate home addresses would\n   mitigate the threat of redirection-based\
    \ flooding only marginally.\n   While it would prevent an attacker from registering\
    \ as its care-of\n   address the IP address of a specific victim node, the attacker\
    \ could\n   still generate a different CGA-based care-of address with the same\n\
    \   subnet prefix as that of the victim's IP address.  Flooding packets\n   redirected\
    \ towards this care-of address would then not have to be\n   received and processed\
    \ by any specific node, but they would impact an\n   entire link or network and\
    \ thus cause comparable damage.  CGA-based\n   care-of addresses therefore have\
    \ little effectiveness with respect to\n   flooding protection.  On the other\
    \ hand, they would require a\n   computationally expensive, public-key-based ownership\
    \ proof whenever\n   the care-of address changes.  For these reasons, Enhanced\
    \ Route\n   Optimization uses regular IPv6 care-of addresses.\n   A common misconception\
    \ is that a strong proof of home address\n   ownership would mitigate the threat\
    \ of redirection-based flooding and\n   consequently eliminate the need to verify\
    \ a mobile node's\n   reachability at a new care-of address.  This notion may\
    \ originate\n   from the specification of a base Mobile IPv6 home registration\
    \ in\n   [1], which calls for the authentication of a mobile node based on an\n\
    \   IPsec security association, but does not require this to be\n   supplemented\
    \ by a verification of the mobile node's reachability at\n   the care-of address.\
    \  However, the reason not to mandate reachability\n   verification for a home\
    \ registration is in this case the existence of\n   an administrative relationship\
    \ between the home agent and the mobile\n   node, rather than the fact that the\
    \ home agent can securely verify\n   the mobile node's home address ownership,\
    \ or that the home\n   registration is IPsec-protected.  The administrative relationship\n\
    \   with the mobile node allows the home agent, first, to trust in the\n   correctness\
    \ of a mobile node's care-of address and, second, to\n   quickly identify the\
    \ mobile node should it still start behaving\n   maliciously, for example, due\
    \ to infection by malware.  Section 15.3\n   in [1] and Section 1.3.2 in [5] explain\
    \ these prerequisites.\n   Assuming trust, an administrative relationship between\
    \ the mobile\n   node and its home agent is viable, given that the home agent\
    \ is an\n   integral part of the mobility services that a mobile user typically\n\
    \   subscribes to, sets up her- or himself, or receives based on a\n   business\
    \ relationship.  A Mobile IPv6 extension [14] that leverages a\n   shared authentication\
    \ key, preconfigured on the mobile node and the\n   correspondent node, preassumes\
    \ the same relationship between the\n   mobile node and a correspondent node.\
    \  While this assumption limits\n   the applicability of the protocol (Section\
    \ 2 of [14] acknowledges\n   this), it permits omission of care-of address reachability\n\
    \   verification as in the case of the home registration.  Enhanced\n   Router\
    \ Optimization does not make assumptions on the relationship\n   between mobile\
    \ and correspondent nodes.  This renders the protocol\n   applicable to arbitrary\
    \ scenarios, but necessitates that\n   correspondent nodes must verify a mobile\
    \ node's reachability at every\n   new care-of address.\n"
- title: 6.3.  Credit-Based Authorization
  contents:
  - "6.3.  Credit-Based Authorization\n   Enhanced Route Optimization enables mobile\
    \ and correspondent nodes to\n   resume bidirectional communications after a handoff\
    \ on the mobile-\n   node side before the mobile node's reachability at the new\
    \ care-of\n   address has been verified by the correspondent node.  Such\n   concurrency\
    \ would in the absence of appropriate protection\n   reintroduce the threat of\
    \ redirection-based flooding, which\n   reachability verification was originally\
    \ designed to eliminate: Given\n   that the correspondent node is in general unaware\
    \ of the round-trip\n   time to the mobile node, and since reachability verification\
    \ may fail\n   due to packet loss, the correspondent node must accept a sufficiently\n\
    \   long concurrency period for reachability verification to complete.\n   An\
    \ attacker could misuse this to temporarily trick the correspondent\n   node into\
    \ redirecting packets to the IP address of a victim.  The\n   attacker may also\
    \ successively postpone reachability verification in\n   that it registers with\
    \ the correspondent node anew, possibly with a\n   different spoofed care-of address,\
    \ shortly before the correspondent\n   node's maximum permitted concurrency period\
    \ elapses and the\n   correspondent node switches to waiting for the completion\
    \ of\n   reachability verification without sending further packets.  This\n  \
    \ behavior cannot necessarily be considered malicious on the\n   correspondent\
    \ node side since even a legitimate mobile node's\n   reachability may fail to\
    \ become verified before the mobile node's\n   care-of address changes again.\
    \  This may be due to high mobility on\n   the mobile node side, or to persistent\
    \ packet loss on the path\n   between the mobile node and the correspondent node.\
    \  It is generally\n   non-trivial to decide on the correspondent node side whether\
    \ the\n   party at the other end behaves legitimately under adverse conditions\n\
    \   or maliciously.\n   Enhanced Route Optimization eliminates the threat of redirection-\n\
    \   based flooding despite concurrent reachability verification through\n   the\
    \ use of Credit-Based Authorization.  Credit-Based Authorization\n   manages the\
    \ effort that a correspondent node expends in sending\n   payload packets to a\
    \ care-of address in UNVERIFIED state.  This is\n   accomplished based on the\
    \ following three hypotheses:\n   1.  A flooding attacker typically seeks to shift\
    \ the burden of\n       assembling and sending flooding packets to a third party.\n\
    \       Bandwidth is an ample resource for many attractive victims, so\n     \
    \  the effort for sending the high rate of flooding packets required\n       to\
    \ impair the victim's ability to communicate may exceed the\n       attacker's\
    \ own capacities.\n   2.  The attacker can always flood a victim directly by generating\n\
    \       bogus packets itself and sending those to the victim.  Such an\n     \
    \  attack is not amplified, so the attacker must be provisioned\n       enough\
    \ to generate a packet flood sufficient to bring the victim\n       down.\n  \
    \ 3.  Consequently, the additional effort required to set up and\n       coordinate\
    \ a redirection-based flooding attack pays off for the\n       attacker only if\
    \ the correspondent node can be tricked into\n       contributing to and amplifying\
    \ the attack.\n   Non-amplified redirection-based flooding is hence, from an attacker's\n\
    \   perspective, no more attractive than pure direct flooding, where the\n   attacker\
    \ itself sends bogus packets to the victim.  It is actually\n   less attractive\
    \ given that the attacker needs to maintain a context\n   for mobility management\
    \ in order to coordinate the redirection.  On\n   this basis, Credit-Based Authorization\
    \ extinguishes the motivation\n   for redirection-based flooding by preventing\
    \ the amplification that\n   could be reached through it, rather than eliminating\
    \ malicious packet\n   redirection in the first place.  The ability to send unrequested\n\
    \   packets is an inherent property of packet-oriented networks, and\n   direct\
    \ flooding is a threat that results from this.  Since direct\n   flooding exists\
    \ with and without mobility support, it constitutes a\n   reasonable measure in\
    \ comparing the security provided by Enhanced\n   Route Optimization to the security\
    \ of the non-mobile Internet.\n   Through the use of Credit-Based Authorization,\
    \ Enhanced Route\n   Optimization satisfies the objective to provide a security\
    \ level\n   comparable to that of the non-mobile Internet.\n   Since the perpetrator\
    \ of a redirection-based flooding attack would\n   take on the role of a mobile\
    \ node, Credit-Based Authorization must be\n   enforced on the correspondent node\
    \ side.  The correspondent node\n   continuously monitors the effort that the\
    \ mobile node spends in\n   communicating with the correspondent node.  The mobile\
    \ node's effort\n   is then taken as a limit on the effort that the correspondent\
    \ node\n   may spend in sending payload packets when the mobile node's care-of\n\
    \   address is in UNVERIFIED state.  The permission for the correspondent\n  \
    \ node to send a limited amount of payload packets to a care-of address\n   in\
    \ UNVERIFIED state enables immediate resumption of bidirectional\n   communications\
    \ once the mobile node has registered a new IP address\n   with the correspondent\
    \ node after a handoff.\n   If what appears to be a mobile node is in fact an\
    \ attacker who tricks\n   the correspondent node into redirecting payload packets\
    \ to the IP\n   address of a victim, Credit-Based Authorization ensures that the\n\
    \   stream of flooding packets ceases before the effort that the\n   correspondent\
    \ node spends on generating the stream exceeds the effort\n   that the attacker\
    \ has recently spent itself.  The flooding attack is\n   therefore at most as\
    \ effective as a direct flooding attack, and\n   consequently fails to produce\
    \ any amplification.\n   Another property of Credit-Based Authorization is that\
    \ it does not\n   assign a mobile node credit while its care-of addresses is in\n\
    \   UNVERIFIED state.  This deserves justification since it would\n   technically\
    \ be feasible to assign credit independent of the state of\n   the mobile node's\
    \ care-of address.  However, the assignment of credit\n   for packets received\
    \ from a care-of address in UNVERIFIED state would\n   introduce a vulnerability\
    \ to sustained reflection attacks.\n   Specifically, an attacker could cause a\
    \ correspondent node to\n   redirect packets for the attacker to the IP address\
    \ of a victim, and\n   sustain the packet flow towards the victim in that it continuously\n\
    \   replenishes its credit by sending packets to the correspondent node.\n   Although\
    \ such a redirection-based reflection attack would fail to\n   produce any amplification,\
    \ it may still be appealing to an attacker\n   who wishes to pursue an initial\
    \ transport protocol handshake with the\n   correspondent node -- which typically\
    \ requires the attacker to\n   receive some unguessable data -- and redirect the\
    \ download to the\n   victim's IP address afterwards.  Credit-Based Authorization\
    \ ensures\n   that the attacker in this case cannot acquire additional credit\
    \ once\n   the download has been redirected, and thereby forces the attack to\n\
    \   end quickly.\n"
- title: 6.4.  Time Shifting Attacks
  contents:
  - "6.4.  Time Shifting Attacks\n   Base Mobile IPv6 limits the lifetime of a correspondent\
    \ registration\n   to 7 minutes and so arranges that a mobile node's reachability\
    \ at its\n   home and care-of addresses is reverified periodically.  This ensures\n\
    \   that the return routability procedure's vulnerability to\n   eavesdropping\
    \ cannot be exploited by an attacker that is only\n   temporarily on the path\
    \ between the correspondent node and the\n   spoofed home or care-of address.\
    \  Such \"time shifting attacks\" [5]\n   could otherwise be misused for off-path\
    \ IP address stealing, return-\n   to-home flooding, or flooding against care-of\
    \ addresses.\n   Enhanced Route Optimization repeats neither the initial home\
    \ address\n   test nor any care-of address test in order to decrease handoff delays\n\
    \   and signaling overhead.  This does not limit the protocol's\n   robustness\
    \ to IP address stealing attacks because the required CGA-\n   based ownership\
    \ proof for home addresses already eliminates such\n   attacks.  Reachability\
    \ verification does not add further protection\n   in this regard.  On the other\
    \ hand, the restriction to an initial\n   reachability verification facilitates\
    \ time-shifted, off-path flooding\n   attacks -- either against home addresses\
    \ with incorrect prefixes or\n   against spoofed care-of addresses -- if the perpetrator\
    \ can interpose\n   in the exchange before it moves to a different location.\n\
    \   The design choice against repeated home and care-of address tests was\n  \
    \ made based on the observation that time shifting attacks are already\n   an\
    \ existing threat in the non-mobile Internet of today.\n   Specifically, an attacker\
    \ can temporarily move onto the path between\n   a victim and a correspondent\
    \ node, request a stream of packets from\n   the correspondent node on behalf\
    \ of the victim, and then move to a\n   different location.  Most transport protocols\
    \ do not verify an\n   initiator's reachability at the claimed IP address after\
    \ an initial\n   verification during connection establishment.  It enables an\
    \ attacker\n   to participate only in connection establishment and then move to\
    \ an\n   off-path position, from where it can spoof acknowledgments to feign\n\
    \   continued presence at the victim's IP address.  The threat of time\n   shifting\
    \ hence already applies to the non-mobile Internet.\n   It should still be acknowledged\
    \ that the time at which Enhanced Route\n   Optimization verifies a mobile node's\
    \ reachability at a home or\n   care-of address may well antecede the establishment\
    \ of any transport\n   layer connection.  This gives an attacker more time to\
    \ move away from\n   the path between the correspondent node and the victim and\
    \ so makes a\n   time shifting attack more practicable.  If the lack of periodic\n\
    \   reachability verification is considered too risky, a correspondent\n   node\
    \ may enforce reruns of home or care-of address tests by limiting\n   the registration\
    \ lifetime, or by sending Binding Refresh Request\n   messages to a mobile node.\n"
- title: 6.5.  Replay Attacks
  contents:
  - "6.5.  Replay Attacks\n   The protocol specified in this document relies on 16-bit\
    \ base Mobile\n   IPv6 sequence numbers and periodic rekeying to avoid replay\
    \ attacks.\n   Rekeying allows mobile and correspondent nodes to reuse sequence\n\
    \   numbers without exposing themselves to replay attacks.  It must be\n   pursued\
    \ at least once every 24 hours due to the maximum permitted\n   binding lifetime\
    \ for correspondent registrations.  Mobile and\n   correspondent nodes also rekey\
    \ whenever a rollover in sequence number\n   space becomes imminent.  This is\
    \ unlikely to happen frequently,\n   however, given that available sequence numbers\
    \ are sufficient for up\n   to 32768 correspondent registrations, each consisting\
    \ of an early and\n   a complete Binding Update message.  The sequence number\
    \ space thus\n   permits an average rate of 22 correspondent registrations per\
    \ minute\n   without exposing a need to rekey throughout the 24-hour binding\n\
    \   lifetime.\n"
- title: 6.6.  Resource Exhaustion
  contents:
  - "6.6.  Resource Exhaustion\n   While a CGA-based home address ownership proof\
    \ provides protection\n   against unauthenticated Binding Update messages, it\
    \ can expose a\n   correspondent node to denial-of-service attacks since it requires\n\
    \   computationally expensive public-key cryptography.  Enhanced Route\n   Optimization\
    \ limits the use of public-key cryptography to only the\n   first correspondent\
    \ registration and if/when rekeying is needed.  It\n   is RECOMMENDED that correspondent\
    \ nodes in addition track the amount\n   of processing resources they spend on\
    \ CGA-based home address\n   ownership verification, and that they reject new\
    \ correspondent\n   registrations that involve public-key cryptography when these\n\
    \   resources exceed a predefined limit. [2] discusses the feasibility of\n  \
    \ CGA-based resource exhaustion attacks in depth.\n"
- title: 6.7.  IP Address Ownership of Correspondent Node
  contents:
  - "6.7.  IP Address Ownership of Correspondent Node\n   Enhanced Route Optimization\
    \ enables mobile nodes to authenticate a\n   received Binding Acknowledgment message\
    \ based on a CGA property of\n   the correspondent node's IP address, provided\
    \ that the correspondent\n   node has a CGA.  The mobile node requests this authentication\
    \ by\n   including a CGA Parameters Request option in the Binding Update\n   message\
    \ that it sends to the correspondent node, and the\n   correspondent node responds\
    \ by adding its CGA parameters and\n   signature to the Binding Acknowledgment\
    \ message within CGA Parameters\n   and Signature options.  Proving ownership\
    \ of the correspondent node's\n   IP address protects the mobile node from accepting\
    \ a spoofed Binding\n   Acknowledgment message and from storing the included permanent\
    \ home\n   keygen token for use during future correspondent registrations.  Such\n\
    \   an attack would result in denial of service against the mobile node\n   because\
    \ it would prevent the mobile node from transacting any binding\n   updates with\
    \ the obtained permanent home keygen token.  Enhanced\n   Route Optimization recommends\
    \ renewal of a permanent home keygen\n   token in case of persistent correspondent\
    \ registration failures,\n   allowing mobile nodes to recover from denial-of-service\
    \ attacks that\n   involve spoofed permanent home keygen tokens.\n   The threat\
    \ of the described denial-of-service attack is to some\n   extent mitigated by\
    \ requirements on the attacker's location: A\n   Binding Update message that requests\
    \ a correspondent node to provide\n   a permanent home keygen token is authenticated\
    \ based on the CGA\n   property of the mobile node's home address.  This authentication\n\
    \   method involves a home address test, providing the mobile node with a\n  \
    \ home keygen token based on which it can calculate the authenticator\n   of the\
    \ Binding Update message.  Since the mobile node expects the\n   authenticator\
    \ of the returning Binding Acknowledgment message to be\n   calculated with the\
    \ same home keygen token, an attacker that is\n   willing to spoof a Binding Acknowledgment\
    \ message that includes a\n   permanent home keygen token must eavesdrop on the\
    \ home address test.\n   The attacker must hence be present on the path from the\
    \ correspondent\n   node to the mobile node's home agent while the home address\
    \ test\n   proceeds.  Moreover, if the Binding Update message requesting the\n\
    \   permanent home keygen token is complete, its authenticator is further\n  \
    \ calculated based on a care-of keygen token.  The attacker must then\n   also\
    \ know this care-of keygen token to generate the authenticator of\n   the Binding\
    \ Acknowledgment message.  This requires the attacker to be\n   on the path from\
    \ the correspondent node to the mobile node's current\n   IP attachment at the\
    \ time the correspondent node sends the care-of\n   keygen token to the mobile\
    \ node within a Care-of Test message or the\n   Care-of Test option of a Binding\
    \ Acknowledgment message.\n   Since a mobile node in general does not know whether\
    \ a particular\n   correspondent node's IP address is a CGA, the mobile node must\
    \ be\n   prepared to receive a Binding Acknowledgment message without CGA\n  \
    \ Parameters and Signature options in response to sending a Binding\n   Update\
    \ message with an included CGA Parameters Request option.  Per\n   se, this mandatory\
    \ behavior may enable downgrading attacks where the\n   attacker would send, on\
    \ the correspondent node's behalf, a Binding\n   Acknowledgment message without\
    \ CGA Parameters and Signature options,\n   claiming that the correspondent node's\
    \ IP address is not a CGA.\n   Enhanced Route Optimization mitigates this threat\
    \ in that it calls\n   for mobile nodes to prioritize Binding Acknowledgment messages\
    \ with\n   valid CGA Parameters and Signature options over Binding\n   Acknowledgment\
    \ messages without such options.  This protects against\n   downgrading attacks\
    \ unless the attacker can intercept Binding\n   Acknowledgment messages from the\
    \ correspondent node.  Given that the\n   attacker must be on the path from the\
    \ correspondent node to the\n   mobile node's home agent at roughly the same time\
    \ as explained above,\n   the attacker may not be able to intercept the correspondent\
    \ node's\n   Binding Acknowledgment messages.  On the other hand, an attacker\
    \ that\n   can intercept Binding Acknowledgment messages from the correspondent\n\
    \   node is anyway in a position where it can pursue denial of service\n   against\
    \ the mobile node and the correspondent node.  This is a threat\n   that already\
    \ exists in the non-mobile Internet, and it is not\n   specific to Enhanced Route\
    \ Optimization.\n   External mechanisms may enable the mobile node to obtain certainty\n\
    \   about whether a particular correspondent node's IP address is a CGA.\n   The\
    \ mobile node may then insist on an IP address ownership proof from\n   the correspondent\
    \ node, in which case it would discard any received\n   Binding Acknowledgment\
    \ messages that do not contain valid CGA\n   Parameters and Signature options.\
    \  One conceivable means for mobile\n   nodes to distinguish between standard\
    \ IPv6 addresses and CGAs might\n   be an extension to the Domain Name System.\n"
- title: 7.  Protocol Constants and Configuration Variables
  contents:
  - "7.  Protocol Constants and Configuration Variables\n   [2] defines a CGA Message\
    \ Type namespace from which CGA applications\n   draw CGA Message Type tags to\
    \ be used in signature calculations.\n   Enhanced Route Optimization uses the\
    \ following constant, randomly\n   generated CGA Message Type tag:\n      0x5F27\
    \ 0586 8D6C 4C56 A246 9EBB 9B2A 2E13\n   [1] bounds the lifetime for bindings\
    \ that were established with\n   correspondent nodes by way of the return routability\
    \ procedure to\n   MAX_RR_BINDING_LIFETIME.  Enhanced Route Optimization adopts\
    \ this\n   limit for bindings that are authenticated through a proof of the\n\
    \   mobile node's reachability at the home address.  However, the binding\n  \
    \ lifetime is limited to the more generous constant value of\n   MAX_CGA_BINDING_LIFETIME\
    \ when the binding is authenticated through\n   the CGA property of the mobile\
    \ node's home address:\n      MAX_CGA_BINDING_LIFETIME   86400 seconds\n   Credit\
    \ aging incorporates two configuration variables to gradually\n   decrease a mobile\
    \ node's credit counter over time.  It is RECOMMENDED\n   that a correspondent\
    \ node uses the following values:\n      CreditAgingFactor          7/8\n    \
    \  CreditAgingInterval        5 seconds\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   This document defines the following six new mobility\
    \ options, which\n   must be assigned type values within the mobility option numbering\n\
    \   space of [1]:\n   o  CGA Parameters Request mobility option (11)\n   o  CGA\
    \ Parameters mobility option (12)\n   o  Signature mobility option (13)\n   o\
    \  Permanent Home Keygen Token mobility option (14)\n   o  Care-of Test Init mobility\
    \ option (15)\n   o  Care-of Test mobility option (16)\n   This document allocates\
    \ the following four new status codes for\n   Binding Acknowledgment messages:\n\
    \   o  \"Permanent home keygen token unavailable\" (147)\n   o  \"CGA and signature\
    \ verification failed\" (148)\n   o  \"Permanent home keygen token exists\" (149)\n\
    \   o  \"Non-null home nonce index expected\" (150)\n   The values to be assigned\
    \ for these status codes must all be greater\n   than or equal to 128, indicating\
    \ that the respective Binding Update\n   message was rejected by the receiving\
    \ correspondent node.\n   This document also defines a new 128-bit value under\
    \ the CGA Message\n   Type namespace [2].\n"
- title: 9.  Acknowledgments
  contents:
  - "9.  Acknowledgments\n   The authors would like to thank Tuomas Aura, Gabriel\
    \ Montenegro,\n   Pekka Nikander, Mike Roe, Greg O'Shea, Vesa Torvinen (in alphabetical\n\
    \   order) for valuable and interesting discussions around\n   cryptographically\
    \ generated addresses.\n   The authors would also like to thank Marcelo Bagnulo,\
    \ Roland Bless,\n   Zhen Cao, Samita Chakrabarti, Greg Daley, Vijay Devarapalli,\
    \ Mark\n   Doll, Lakshminath Dondeti, Francis Dupont, Lars Eggert, Eric Gray,\n\
    \   Manhee Jo, James Kempf, Suresh Krishnan, Tobias Kuefner, Lila Madour,\n  \
    \ Vidya Narayanan, Mohan Parthasarathy, Alice Qinxia, and Behcet\n   Sarikaya\
    \ (in alphabetical order) for their reviews of and important\n   comments on this\
    \ document and the predecessors of this document.\n   Finally, the authors would\
    \ also like to emphasize that [15] pioneered\n   the use of cryptographically\
    \ generated addresses in the context of\n   Mobile IPv6 route optimization, and\
    \ that this document consists\n   largely of material from [16], [17], and [18]\
    \ and the contributions\n   of their authors.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [1]   Johnson, D., Perkins, C., and J. Arkko,\
    \ \"Mobility Support in\n         IPv6\", RFC 3775, June 2004.\n   [2]   Aura,\
    \ T., \"Cryptographically Generated Addresses (CGA)\",\n         RFC 3972, March\
    \ 2005.\n   [3]   Bradner, S., \"Key Words for Use in RFCs to Indicate Requirement\n\
    \         Levels\", IETF BCP 14, RFC 2119, March 1997.\n   [4]   Jonsson, J. and\
    \ B. Kaliski, \"Public-Key Cryptography Standards\n         (PKCS) #1: RSA Cryptography\
    \ Specifications Version 2.1\",\n         RFC 3447, February 2003.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [5]   Nikander, P., Arkko, J., Aura, T., Montenegro,\
    \ G., and E.\n         Nordmark, \"Mobile IP Version 6 Route Optimization Security\n\
    \         Design Background\", RFC 4225, December 2005.\n   [6]   Vogt, C. and\
    \ J. Arkko, \"A Taxonomy and Analysis of Enhancements\n         to Mobile IPv6\
    \ Route Optimization\", RFC 4651, February 2007.\n   [7]   Vogt, C. and M. Doll,\
    \ \"Efficient End-to-End Mobility Support in\n         IPv6\", Proceedings of\
    \ the IEEE Wireless Communications and\n         Networking Conference, IEEE,\
    \ April 2006.\n   [8]   Mirkovic, J. and P. Reiher, \"A Taxonomy of DDoS Attack\
    \ and DDoS\n         Defense Mechanisms\", ACM SIGCOMM Computer Communication\
    \ Review,\n         Vol. 34, No. 2, ACM Press, April 2004.\n   [9]   Arkko, J.\
    \ and C. Vogt, \"Credit-Based Authorization for Binding\n         Lifetime Extension\"\
    , Work in Progress, May 2004.\n   [10]  O'Shea, G. and M. Roe, \"Child-Proof Authentication\
    \ for MIPv6\n         (CAM)\", ACM SIGCOMM Computer Communication Review, ACM\
    \ Press,\n         Vol. 31, No. 2, April 2001.\n   [11]  Nikander, P., \"Denial-of-Service,\
    \ Address Ownership, and Early\n         Authentication in the IPv6 World\", Revised\
    \ papers from the\n         International Workshop on Security Protocols, Springer-Verlag,\n\
    \         April 2002.\n   [12]  Bagnulo, M. and J. Arkko, \"Support for Multiple\
    \ Hash Algorithms\n         in Cryptographically Generated Addresses (CGAs)\"\
    , Work\n         in Progress, April 2007.\n   [13]  Arkko, J., Kempf, J., Zill,\
    \ B., and P. Nikander, \"SEcure\n         Neighbor Discovery (SEND)\", RFC 3971,\
    \ March 2005.\n   [14]  Perkins, C., \"Securing Mobile IPv6 Route Optimization\
    \ Using a\n         Static Shared Key\", RFC 4449, June 2006.\n   [15]  Roe, M.,\
    \ Aura, T., O'Shea, G., and J. Arkko, \"Authentication of\n         Mobile IPv6\
    \ Binding Updates and Acknowledgments\", Work\n         in Progress, March 2002.\n\
    \   [16]  Haddad, W., Madour, L., Arkko, J., and F. Dupont, \"Applying\n     \
    \    Cryptographically Generated Addresses to Optimize MIPv6  (CGA-\n        \
    \ OMIPv6)\", Work Progress, May 2005.\n   [17]  Vogt, C., Bless, R., Doll, M.,\
    \ and T. Kuefner, \"Early Binding\n         Updates for Mobile IPv6\", Work in\
    \ Progress, February 2004.\n   [18]  Vogt, C., Arkko, J., Bless, R., Doll, M.,\
    \ and T. Kuefner,\n         \"Credit-Based Authorization for Mobile IPv6 Early\
    \ Binding\n         Updates\", Work in Progress, May 2004.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Jari Arkko\n   Ericsson Research NomadicLab\n   FI-02420\
    \ Jorvas\n   Finland\n   EMail: jari.arkko@ericsson.com\n   Christian Vogt\n \
    \  Institute of Telematics\n   Universitaet Karlsruhe (TH)\n   P.O. Box 6980\n\
    \   76128 Karlsruhe\n   Germany\n   EMail: chvogt@tm.uka.de\n   Wassim Haddad\n\
    \   Ericsson Research\n   8400, Decarie Blvd\n   Town of Mount Royal\n   Quebec\
    \ H4P 2N2, Canada\n   EMail: wassim.haddad@ericsson.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
