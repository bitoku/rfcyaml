Abstract This document describes procedures for conveying access network ownership and location information based on civic and geospatial location formats in Remote Authentication Dial
In User Service (RADIUS) and Diameter.
The distribution of location information is a privacy sensitive task.
Dealing with mechanisms to preserve the user's privacy is important and is addressed in this document.
This document defines attributes within RADIUS and Diameter that can be used to convey location related information within authentication and accounting exchanges.
Location information may be useful in a number of scenarios.
Wireless networks (including wireless LAN) are being deployed in public places such as airports, hotels, shopping malls, and coffee shops by a diverse set of operators such as cellular network operators, Wireless Internet Service Providers (WISPs), and fixed broadband operators.
In these situations, the home network may need to know the location of the user in order to enable location aware billing, location aware authorization, or other location aware services.
Location information can also prove useful in other situations (such as wired networks) where operator network ownership and location information may be needed by the home network.
In order to preserve user privacy, location information needs to be protected against unauthorized access and distribution.
Requirements for access to location information are defined in [RFC3693].
The model includes a Location Generator (LG) that creates location information, a Location Server (LS) that authorizes access to location information, a Location Recipient (LR)
that requests and receives information, and a Rule Maker (RM) that provides authorization policies to the LS, which enforces access control policies on requests to location information.
In Appendix A, the requirements for a GEOPRIV using protocol [RFC3693] are compared to the functionality provided by this document.
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC2119].
RADIUS specific terminology is borrowed from [RFC2865] and [RFC2866].
Terminology related to privacy issues, location information, and authorization policy rules is taken from [RFC3693].
Delivery Methods for Location Information
The following exchanges show how location information is conveyed in RADIUS.
In describing the usage scenarios, we assume that privacy policies allow location to be conveyed in RADIUS; however, as noted in Section 6, similar exchanges can also take place within Diameter.
Privacy issues are discussed in Section 7.2.
Location Delivery Based on Out of Band Agreements Figure 1 shows an example message flow for delivering location information during the network access authentication and authorization procedure.
Upon a network authentication request from an access network client, the Network Access Server (NAS) submits a RADIUS Access Request message that contains Location Information Attributes among other required attributes.
In this scenario, location information is attached to the Access Request message without an explicit request from the RADIUS server.
Note that such an approach with a prior agreement between the RADIUS client and the RADIUS server is only applicable in certain environments, such as in situations where the RADIUS client and server are within the same administrative domain.
The Basic Location Policy Rules Attribute is populated based on the defaults described in Section 4.4, unless it has been explicitly configured otherwise.
Based on Out of Band Agreements 3.2.
Location Delivery Based on Initial Request
If the RADIUS client provides a Location Capable Attribute in the Access Request, then the RADIUS server MAY request location information from the RADIUS client if it requires that information for authorization and if location information was not provided in the Access Request.
This exchange is shown in Figure 2.
The inclusion of the Location Capable Attribute in an Access Request message indicates that the NAS is capable of providing location data in response to an Access Challenge.
The subsequent Access Challenge message sent from the RADIUS server to the NAS provides a hint regarding the type of desired Location Information Attributes.
The NAS treats the Basic Location Policy Rules and Extended Location
Policy Rules Attributes as opaque data (e.g., it echoes these rules provided by the server within the Access Challenge back in the Access Request).
In the shown message flow, the location attributes are then provided in the subsequent Access Request message.
When evaluating this Access Request message, the authorization procedure at the RADIUS server might be based on a number of criteria, including the newly defined attributes listed in Section 4.
Based on Initial Request 3.3.
Location Delivery Based on Mid Session Request
The on demand, mid session location delivery method utilizes the Change of Authorization Request (CoA Request) message and the CoA NAK (CoA Negative Acknowledgement), defined in [RFC5176].
At any time during the session, the Dynamic Authorization Client MAY send a CoA  Request containing session identification attributes to the NAS (i.e., Dynamic Authorization Server).
In order to enable the on demand, mid session location delivery method, the RADIUS server MUST return an instance of the Requested  Location Info Attribute with the 'FUTURE REQUESTS' flag set and instances of the Basic Location Policy Rules and Extended Location
Policy Rules Attributes in the Access Accept message for the session.
Upon receipt of a CoA Request message containing a Service Type Attribute with value "Authorize Only" for the same session, the NAS MUST include location information and echo the previously received Basic Location Policy Rules and Extended Location Policy Rules Attributes in the subsequent Access Request message.
Upon receiving the Access Request message containing the Service Type Attribute with a value of Authorize Only from the NAS, the RADIUS server responds with either an Access Accept or an Access Reject message.
The use of dynamic authorization [RFC5176] is necessary when location information is needed on demand and cannot be obtained from accounting information in a timely fashion.
Figure 3 shows the above described approach graphically.
Based on CoA with Service Type 'Authorize Only' When the Dynamic Authorization Client wants to change the values of the requested location information, or set the values of the requested location information for the first time, it may do so without triggering a reauthorization.
Assuming that the NAS had previously sent an Access Request containing a Location Capable Attribute, the Dynamic Authorization Client (DAC) can send a CoA  Request to the NAS without a Service Type Attribute, but include the NAS identifiers and session identifiers as per [RFC5176] and the Requested Location Info, Basic Location Policy Rules, and Extended  Location Policy Rules Attributes.
The Requested Location Info, Basic Location Policy Rules, and Extended Location Policy Rules Attributes MUST NOT be used for session identification.
Figure 4 shows this approach graphically.
Location Delivery in Accounting Messages Location information may also be reported in accounting messages.
Accounting messages are generated when the session starts, when the session stops, and periodically during the lifetime of the session.
Accounting messages may also be generated when the user roams during handoff.
Accounting information may be needed by the billing system to calculate the user's bill.
For example, there may be different tariffs or tax rates applied based on the location.
If the RADIUS server needs to obtain location information in accounting messages, then it needs to include a Requested Location  Info Attribute with the Access Accept message.
The Basic Location  Policy Rules and the Extended Location Policy Rules Attributes are to be echoed in the Accounting Request if indicated in the Access  Accept.
Figure 5 shows the message exchange.
Figure 5: Location Delivery in Accounting Messages 4.
It is important to note that the location specific parts of the attributes defined below are not meant to be processed by the RADIUS server.
Instead, a location server specific component used in combination with the RADIUS server is responsible for receiving, processing, and further distributing location information (in combination with proper access control and privacy protection).
As such, from a RADIUS server point of view, location information is treated as opaque data.
This attribute carries the operator namespace identifier and the operator name.
The operator name is combined with the namespace identifier to uniquely identify the owner of an access network.
The value of the Operator Name is a non NULL terminated text whose length MUST NOT exceed 253 bytes.
The Operator Name Attribute SHOULD be sent in Access Request and Accounting Request messages where the Acc Status Type is set to Start, Interim, or Stop.
A summary of the Operator Name Attribute is shown below.
Type: 126 Operator Name Length:
4 Text: The format is shown below.
The data type of this field is a text.
All fields are transmitted from left to right:
Namespace ID: The value within this field contains the operator namespace identifier.
The Namespace ID value is encoded in ASCII.
Example: '1' (0x31) for REALM Operator Name: The text field of variable length contains an Access Network Operator Name.
This field is a RADIUS based data type of Text.
The Namespace ID field provides information about the operator namespace.
This document defines four values for this attribute, which are listed below.
Additional namespace identifiers must be registered with IANA (see Section 8.1) and must be associated with an organization responsible for managing the namespace.
: This namespace can be used to indicate operator names based on Transferred Account Data Interchange Group (TADIG) codes, as defined in [GSM].
TADIG codes are assigned by the TADIG Working Group within the Global System for Mobile Communications (GSM) Association.
The TADIG code consists of two fields, with a total length of five ASCII characters consisting of a three character country code and a two character alphanumeric operator (or company)
The REALM operator namespace can be used to indicate operator names based on any registered domain name.
Such names are required to be unique, and the rights to use a given realm name are obtained coincident with acquiring the rights to use a particular Fully Qualified Domain Name (FQDN).
Since this operator is limited to ASCII, any registered domain name that contains non ASCII characters must be converted to ASCII.
The Punycode encoding [RFC3492] is used for this purpose.
E212 ('2' (0x32)): The E212 namespace can be used to indicate operator names based on the Mobile Country Code (MCC) and Mobile Network Code (MNC) defined in [ITU212].
The MCC/MNC values are assigned by the Telecommunications Standardization Bureau (TSB) within the ITU T and by designated administrators in different countries.
The E212 value consists of three ASCII digits containing the MCC, followed by two or three ASCII digits containing the MNC.
ICC ('3' (0x33)): The ICC namespace can be used to indicate operator names based on International Telecommunication Union (ITU)
Carrier Codes (ICC) defined in [ITU1400].
ICC values are assigned by national regulatory authorities and are coordinated by the Telecommunication Standardization Bureau (TSB) within the ITU Telecommunication Standardization Sector (ITU T).
When using the ICC namespace, the attribute consists of three uppercase ASCII characters containing a three letter alphabetic country code, as defined in [ISO], followed by one to six uppercase alphanumeric ASCII characters containing the ICC itself.
The Location Information Attribute MAY be sent in the Access Request message, the Accounting Request message, both of these messages, or no message.
For the Accounting Request message, the Acc Status Type may be set to Start, Interim, or Stop.
The Location Information Attribute provides meta data about the location information, such as sighting time, time to live, location  determination method, etc.
The format is shown below.
Type: 127 Location Information Length:
23 String: The format is shown below.
The data type of this field is a string.
All fields are transmitted from left to right:
The 16 bit unsigned integer value allows this attribute to provide information relating to the information included in the Location  Data Attribute to which it refers (via the Index).
Code (8 bits): This field indicates the content of the location profile carried in the Location Data Attribute.
Two profiles are defined in this document   namely, a civic location profile (see Section 4.3.1) that uses value (0) and a geospatial location profile (see Section 4.3.2) that uses the value (1).
Entity (8 bits): This field encodes which location this attribute
refers to as an unsigned 8 bit integer value.
Location information can refer to different entities.
This document registers two entity values, namely: Value (0) describes the location of the user's client device.
Value (1) describes the location of the RADIUS client.
The registry used for these values is established by this document, see Section 8.4.
This field indicates when the location information was accurate.
The data type of this field is a string, and the content is expressed in the 64 bit Network Time Protocol (NTP) timestamp format [RFC1305].
Time to Live (64 bits): This field gives a hint regarding for how long location information should be considered current.
The data type of this field is a string and the content is expressed in the 64 bit Network Time Protocol (NTP) timestamp format [RFC1305].
Note that the Time to Live field is different than the Retention Expires field used in the Basic Location Policy Rules Attribute
The Retention Expires field indicates the time the recipient is no longer permitted to possess the location information.
: Describes the way that the location information was determined.
This field MUST contain the value of exactly one IANA registered 'method' token [RFC4119].
The length of the Location Information Attribute MUST NOT exceed 253 octets.
The Location Data Attribute MAY be sent in Access Request and Accounting Request messages.
For the Accounting Request message, the Acc Status Type may be set to Start, Interim, or Stop.
The format is shown below.
Type: 128 Location Data Length:
String: The format is shown below.
The data type of this field is a string.
All fields are transmitted from left to right:
The 16 bit unsigned integer value allows this attribute to associate the Location Data Attribute with the Location  Information Attributes.
The format of the location data depends on the location profile.
This document defines two location profiles.
Details of the location profiles are described below.
Civic Location Profile Civic location is a popular way to describe the location of an entity.
This section defines the civic location information profile corresponding to the value (0) indicated in the Code field of the Location Information Attribute.
The location format is based on the encoding format defined in Section 3.1 of [RFC4776], whereby the first 3 octets are not put into the Location field of the above  described RADIUS Location Data Attribute (i.e., the code for the DHCP option, the length of the DHCP option, and the 'what' element are not included).
This section defines the geospatial location information profile corresponding to the value (1) indicated in the Code field of the Location Information Attribute.
Geospatial location information is encoded as an opaque object, and the format is based on the Location Configuration Information (LCI) format defined in Section 2 of [RFC3825] but starts with the third octet (i.e., the code for the DHCP option and the length field is not included).
Basic Location Policy Rules Attribute
The Basic Location Policy Rules Attribute MAY be sent in Access  Request, Access Accept, Access Challenge, Change of Authorization, and Accounting Request messages.
Policy rules control the distribution of location information.
In order to understand and process the Basic Location Policy Rules Attribute, RADIUS clients are obligated to utilize a default value of Basic Location Policy Rules, unless explicitly configured otherwise, and to echo the Basic Location Policy Rules Attribute that they receive from a server.
As a default, the Note
Well field does not carry a pointer to human readable privacy policies, the retransmission allowed is set to zero (0), i.e., further distribution is not allowed, and the Retention Expires field is set to 24 hours.
With regard to authorization policies, this document reuses work done in [RFC4119] and encodes those policies in a non XML format.
Two fields ('Sighting Time' and 'Time to Live') are additionally included in the Location Information Attribute to conform to the GEOPRIV requirements [RFC3693], Section 2.7.
The format of the Basic Location Policy Rules Attribute is shown below. 0
Type: 129 Basic Location Policy Rules Length:
12 String: The format is shown below.
The data type of this field is a string.
All fields are transmitted from left to right:
This document reuses fields from the RFC 4119
These fields have the following meaning: Flags (16 bits):
The Flags field is a bit mask.
All reserved bits MUST be zero.
When the value of the Retransmission Allowed field is set to zero (0), then the recipient of this Location Object is not permitted to share the enclosed location information, or the object as a whole, with other parties.
The value of '1' allows this attribute to share the location information with other parties by considering the extended policy rules.
Retention Expires (64 bits): This field specifies an absolute date at which time the Recipient is no longer permitted to possess the location information.
The data type of this field is a string and the format is a 64 bit NTP timestamp [RFC1305].
Well (variable): This field contains a URI that points to human readable privacy instructions.
The data type of this field is a string.
This field is useful when location information is distributed to third  party entities, which can include humans in a location based service.
RADIUS entities are not supposed to process this field.
Whenever a Location Object leaves the RADIUS ecosystem, the URI in the Note
Well Attribute MUST be expanded to the human readable text.
For example, when the Location Object is transferred to a SIP based environment, then the human readable text is placed into the 'note well' element of the 'usage rules' element contained in the PIDF LO (Presence Information Data Format Location Object) document (see [RFC4119]).
Well field may be empty.
Extended Location Policy Rules Attribute
The Extended Location Policy Rules Attribute MAY be sent in Access  Request, Access Accept, Access Challenge, Access Reject, Change of  Authorization, and Accounting Request messages.
The Ruleset Reference field of this attribute is of variable length.
It contains a URI that indicates where the richer ruleset can be found.
This URI SHOULD use the HTTPS URI scheme.
As a deviation from [RFC4119], this field only contains a reference and does not carry an attached, extended ruleset.
This modification is motivated by the size limitations imposed by RADIUS.
In order to understand and process the Extended Location Policy Rules Attribute, RADIUS clients are obligated to attach the URI to the Extended Location Policy Rules Attribute when they are explicitly configured to do so, and to echo the Extended Location Policy Rules Attribute that they receive from a server.
There is no expectation that RADIUS clients will need to retrieve data at the URL specified in the attribute or to parse the XML policies.
The format of the Extended Location Policy Rules Attribute is shown below. 0
130 Extended Location Policy Rules Length: >
3 String: This field is at least two octets in length, and the format is shown below.
The data type of this field is a string.
The fields are transmitted from left to right:
Ruleset Reference: This field contains a URI that points to the policy rules.
The Location Capable Attribute allows an NAS (or client function of a proxy server) to indicate support for the functionality specified in this document.
The Location Capable Attribute with the value for 'Location Capable' MUST be sent with the Access Request messages, if the NAS supports the functionality described in this document and is capable of sending location information.
A RADIUS server MUST NOT challenge for location information unless the Location Capable Attribute has been sent to it. 0
Type: 131 Location Capable Attribute Length:
The content of the Integer field encodes the requested capabilities.
Each capability value represents a bit position.
This document specifies the following capabilities.
: The RADIUS client uses the CIVIC LOCATION to indicate that it is able to return civic location based on the location profile defined in Section 4.3.1.
A numerical value of this token is '1'.
: The RADIUS client uses the GEO LOCATION to indicate that it is able to return geodetic location based on the location profile defined in Section 4.3.2.
A numerical value of this token is '2'.
The numerical value representing USERS LOCATION indicates that the RADIUS client is able to provide a Location Information Attribute with the Entity Attribute expressing the value of zero (0), i.e., the RADIUS client is capable of returning the location information of the user's client device.
A numerical value of this token is '4'.
The numerical value representing NAS LOCATION indicates that the RADIUS client is able to provide a Location Information Attribute that contains location information with the Entity Attribute expressing the value of one (1), i.e., the RADIUS client is capable of returning the location information of the NAS.
A numerical value of this token is '8'.
The Requested Location Info Attribute allows the RADIUS server to indicate which location information about which entity it wants to receive.
The latter aspect refers to the entities that are indicated in the Entity field of the Location Information Attribute.
The Requested Location Info Attribute MAY be sent in an Access  Accept, Access Challenge, or Change of Authorization packet.
If the RADIUS server wants to dynamically decide on a per request basis to ask for location information from the RADIUS client, then the following cases need to be differentiated.
If the RADIUS client and the RADIUS server have agreed out of band to mandate the transfer of location information for every network access authentication request, then the processing listed below is not applicable.
If the RADIUS server requires location information for computing the authorization decision and the RADIUS client does not provide it with the Access Request message, then the Requested Location  Info Attribute is attached to the Access Challenge with a hint about what is required.
If the RADIUS server does not receive the requested information in response to the Access Challenge (including the Requested  Location Info Attribute), then the RADIUS server may respond with an Access Reject message with an Error Cause Attribute (including the "Location Info Required" value).
If the RADIUS server would like location information in the Accounting Request message but does not require it for computing an authorization decision, then the Access Accept message MUST include a Required Info Attribute.
This is typically the case when location information is used only for billing.
The RADIUS client SHOULD attach location information, if available, to the Accounting Request (unless authorization policies dictate something different).
If the RADIUS server does not send a Requested Location Info Attribute, then the RADIUS client MUST NOT attach location information to messages towards the RADIUS server.
The user's authorization policies, if available, MUST be consulted by the RADIUS server before requesting location information delivery from the RADIUS client.
Figure 6 shows a simple protocol exchange where the RADIUS server indicates the desire to obtain location information, namely civic location information of the user, to grant access.
Since the Requested Location Info Attribute is attached to the Access  Challenge, the RADIUS server indicates that location information is required for computing an authorization decision.
RADIUS Server Requesting Location Information
The Requested Location Info Attribute MUST be sent by the RADIUS server, in the absence of an out of band agreement, if it wants the RADIUS client to return location information and if authorization policies permit it.
This Requested Location Info Attribute MAY appear in the Access Accept or in the Access Challenge message.
A summary of the attribute is shown below.
Type: 132 Requested Location Info Attribute Length:
The content of the Integer field encodes the requested information attributes.
Each capability value represents a bit position.
This document specifies the following capabilities:
The RADIUS server uses the Requested Location Info Attribute with the value set to CIVIC LOCATION to request specific location information from the RADIUS client.
The numerical value representing CIVIC LOCATION requires the RADIUS client to attach civic location attributes.
CIVIC LOCATION refers to the location profile defined in Section 4.3.1.
A numerical value of this token is '1'.
: The RADIUS server uses the Requested Location Info Attribute with the value set to GEO LOCATION to request specific location information from the RADIUS client.
The numerical value representing GEO LOCATION requires the RADIUS client to attach geospatial location attributes.
GEO LOCATION refers to the location profile described in Section 4.3.2.
A numerical value of this token is '2'.
The numerical value representing USERS LOCATION indicates that the RADIUS client MUST send a Location Information Attribute with the Entity Attribute expressing the value of zero (0).
Hence, there is a one to one relationship between the USERS LOCATION token and the value of zero (0) of the Entity Attribute inside the Location  Information Attribute.
A value of zero indicates that the location information in the Location Information Attribute refers to the user's client device.
A numerical value of this token is '4'.
The numerical value representing NAS LOCATION indicates that the RADIUS client MUST send a Location Information Attribute that contains location information with the Entity Attribute expressing the value of one (1).
Hence, there is a one to one relationship between the NAS LOCATION token and the value of one (1) of the Entity Attribute inside the Location Information Attribute.
A value of one indicates that the location information in the Location Information Attribute refers to the RADIUS client.
A numerical value of this token is '8'.
The numerical value representing FUTURE REQUESTS indicates that the RADIUS client MUST provide future Access Requests for the same session with the same type of information as returned in the initial Access Request message.
A numerical value of this token is '16'.
The RADIUS server uses this token to request that the RADIUS client stop sending location information.
A numerical value of this token is '32'.
If neither the NAS LOCATION nor the USERS LOCATION bit is set, then per default the location of the user's client device is returned (if authorization policies allow it).
If both the NAS LOCATION and the USERS LOCATION bits are set, then the returned location information has to be put into separate attributes.
If neither the CIVIC LOCATION nor the GEO LOCATION bit is set in the Requested  Location Info Attribute, then no location information is returned.
If both the CIVIC LOCATION and the GEO LOCATION bits are set, then the location information has to be put into separate attributes.
The value of NAS LOCATION and USERS LOCATION refers to the location information requested via CIVIC LOCATION and GEO LOCATION.
As an example, if the bits for NAS LOCATION, USERS LOCATION, and GEO LOCATION are set, then the location information of the RADIUS client and the users' client device are returned in a geospatial  location format.
The following table provides a guide to which attributes may be found in which RADIUS messages, and in what quantity.
Request Accept Reject Challenge Accounting
( ) Note: The Error Cause Attribute contains the value for the 'Location Info Required' error.
Basic Location Policy Rules 0
Extended Location Policy Rules 0
Requested Location Info Legend: 0
This attribute MUST NOT be present. 0
Zero or more instances of this attribute MAY be present. 0
1   Zero or one instance of this attribute MAY be present.
Exactly one instance of this attribute MUST be present.
One or more of these attributes MUST be present.
Figure 7: Table of Attributes
The Error Cause Attribute is defined in [RFC5176].
The Location Information and the Location Data Attribute MAY appear more than once.
For example, if the server asks for civic and geospatial location information, two Location Information Attributes need to be sent.
The attributes defined in this document are not used in any messages other than the ones listed in Figure 7.
IANA allocated a new value (509) from the Error Cause registry with the semantics of 'Location Info Required'.
When used in Diameter, the attributes defined in this specification can be used as Diameter attribute value pairs (AVPs) from the code space 1 255 (RADIUS attribute compatibility space).
No additional Diameter code values are therefore allocated.
The RADIUS attributes in this specification have no special translation requirements for Diameter to RADIUS or RADIUS to Diameter gateways; they are copied as is, except for changes relating to headers, alignment, and padding.
See also Section 4.1 of [RFC3588] and
What this specification says about the applicability of the attributes for RADIUS Access Request packets applies in Diameter to AA Request [RFC4005] or Diameter EAP Request [RFC4072].
What is said about Access Challenge applies in Diameter to AA Answer [RFC4005] or Diameter EAP Answer [RFC4072] with the Result Code AVP set to DIAMETER MULTI ROUND AUTH.
What is said about Access Accept applies in Diameter to AA Answer or Diameter EAP Answer messages that indicate success.
Similarly, what is said about RADIUS Access Reject packets applies in Diameter to AA Answer or Diameter EAP Answer messages that indicate failure.
What is said about CoA Request applies in Diameter to Re Auth Request [RFC4005].
What is said about Accounting Request applies in Diameter to Accounting Request [RFC4005] as well.
Note that these AVPs may be used by Diameter applications other than RFC 4005
The above mentioned applications are, however, likely to be relevant in the context of this document.
A number of security aspects are relevant for the distribution of location information via RADIUS.
These aspects are discussed in separate subsections.
Communication Security Requirements for the protection of a Location Object are defined in [RFC3693]   namely, mutual end point authentication, data object integrity, data object confidentiality, and replay protection.
If no authentication, integrity, and replay protection between the participating RADIUS entities is provided, then adversaries can spoof and modify transmitted attributes.
Two security mechanisms are proposed for RADIUS:  [RFC2865] proposes the usage of a static key that raised concerns regarding the lack of dynamic key management.
At the time of writing, work is ongoing to address some shortcomings of the [RFC2865] attribute regarding security protection.
[RFC3579] enables the use of standard key  management mechanisms, such as Kerberized Internet Negotiation of Keys (KINK), the Internet Key Exchange Protocol (IKE), and IKEv2 [RFC4306], to establish IPsec security associations.
Confidentiality protection MUST be used to prevent an eavesdropper from gaining access to location information.
Confidentiality protection is already present for other reasons in many environments, such as for the transport of keying material in the context of Extensible Authentication Protocol (EAP) authentication and authorization.
Hence, this requirement is, in many environments, already fulfilled.
Mutual authentication MUST be provided between neighboring RADIUS entities to prevent man in  the middle attacks.
Since mutual authentication is already required for key transport within RADIUS messages, it does not represent a deployment obstacle.
Since IPsec protection is already suggested as a mechanism to protect RADIUS, no additional considerations need to be addressed beyond those described in [RFC3579].
In case IPsec protection is not available for some reason and RADIUS  specific security mechanisms have to be used, then the following considerations apply.
The Access Request message is not integrity protected.
This would allow an adversary to change the contents of the Location Object or to insert, modify, and delete attributes or individual fields.
To address these problems, the Message  Authenticator (80) can be used to integrity protect the entire Access Request packet.
The Message Authenticator (80) is also required when EAP is used and, hence, is supported by many modern RADIUS servers.
Access Request packets including location attribute(s) without a Message Authenticator (80) Attribute SHOULD be silently discarded by the RADIUS server.
A RADIUS server supporting location attributes MUST calculate the correct value of the Message Authenticator (80) and MUST silently discard the packet if it does not match the value sent.
Access Accept messages, including location attribute(s), without a Message Authenticator (80) Attribute SHOULD be silently discarded by the NAS.
An NAS supporting location attributes MUST calculate the correct value of a received Message Authenticator (80) and MUST silently discard the packet if it does not match the value sent.
RADIUS and Diameter make some assumptions about the trust between traversed RADIUS entities in the sense that object level security is not provided by either RADIUS or Diameter.
Hence, some trust has to be placed on the RADIUS entities to behave according to the defined rules.
Furthermore, the RADIUS protocol does not involve the user in their protocol interaction except for tunneling authentication information (such as EAP messages) through their infrastructure.
RADIUS and Diameter have even become a de facto protocol for key distribution for network access authentication applications.
Hence, in the past there were some concerns about the trust placed into the infrastructure   particularly from the security area   when it comes to keying.
The EAP keying infrastructure is described in [RFC4282].
This section discusses privacy implications for the distribution of location information within RADIUS.
Note also that it is possible for the RADIUS server to obtain some amount of location information from the NAS identifier.
This document, however, describes procedures to convey more accurate location information about the end host and/or the network.
In a number of deployment environments, location information about the network also reveals the current location of the user with a certain degree of precision, depending on the location determination mechanism used, the update frequency, the size of the network, and other factors, such as movement traces.
Three types of use cases have to be differentiated:
The RADIUS server does not want to receive location information from the RADIUS client.
In case there is an out of band agreement between the entity responsible for the NAS and the entity operating the RADIUS server, location information may be sent without an explicit request from the RADIUS server.
The RADIUS server dynamically requests location information from the NAS.
The RADIUS client MUST behave according to the following guidelines:
If neither an out of band agreement exists nor location information is requested by the RADIUS server, then location information is not disclosed by the RADIUS client.
The RADIUS client MUST pass location information to other entities (e.g., when information is written to a local database or to the log files) only together with the policy rules.
The entity receiving the location information (together with the policies) MUST follow the guidance given with these rules.
A RADIUS client MUST include Basic Location Policy Rules and Extended Location Policy Rules Attributes that are configured within an Access Request packet.
NAS implementations supporting this specification, which are configured to provide location information, MUST echo Basic  Location Policy Rules and Extended Location Policy Rules Attributes unmodified within a subsequent Access Request packet.
In addition, an Access Request packet sent with a Service Type value of "Authorize Only" MUST include the Basic Location Policy  Rules or Extended Location Policy Rules Attributes that were received in a previous Access Accept if the FUTURE REQUESTS flag was set in the Requested Location Info Attribute.
The RADIUS server is a natural place for storing authorization policies since the user typically has some sort of trust relationship with the entity operating the RADIUS server.
Once the infrastructure is deployed and location aware applications are available, there might be a strong desire to use location information for other purposes as well.
The Common Policy framework [RFC4745] that was extended for geolocation privacy [GEO POLICY] is tailored for this purpose.
The Extensible Markup Language (XML) Configuration Access Protocol (XCAP) [RFC4825] gives users the ability to change their privacy policies using a standardized protocol.
These policies are an important tool for limiting further distribution of the user's location to other location based services.
The RADIUS server MUST behave according to the following guidelines:  The RADIUS server MUST attach available rules to the Access  Accept, Access Reject, or Access Challenge message when the RADIUS client is supposed to provide location information.
When location information is made available to other entities (e.g., writing to stable storage for later billing processing), then the RADIUS server MUST attach the privacy rules to location information.
RADIUS Proxy A RADIUS proxy, behaving as a combined RADIUS client and RADIUS server, MUST follow the rules described in Sections 7.2.1 and 7.2.2.
Identity Information and Location Information For the envisioned usage scenarios,
the identity of the user and his device is tightly coupled to the transfer of location information.
If the identity can be determined by the visited network or RADIUS brokers, then it is possible to correlate location information with a particular user.
As such, it allows the visited network and brokers to learn the movement patterns of users.
The user's identity can be "leaked" to the visited network or RADIUS brokers in a number of ways:  The user's device may employ a fixed Media Access Control (MAC) address or base its IP address on such an address.
This enables the correlation of the particular device to its different locations.
Techniques exist to avoid the use of an IP address that is based on a MAC address [RFC4941].
Some link layers make it possible to avoid MAC addresses or change them dynamically.
Network access authentication procedures, such as the PPP Challenge Handshake Authentication Protocol (CHAP)
[RFC1994] or EAP [RFC4187], may reveal the user's identity as a part of the authentication procedure.
Techniques exist to avoid this problem in EAP methods, for instance by employing private Network Access Identifiers (NAIs)
[RFC4282] in the EAP Identity Response message and by method specific private identity exchanges in the EAP method (e.g., [RFC4187], [RFC5281], [PEAP], and [RFC5106]).
Support for identity privacy within CHAP is not available.
RADIUS may return information from the home network to the visited one in a manner that makes it possible to either identify the user or at least correlate his session with other sessions, such as the use of static data in a Class Attribute [RFC2865] or in some accounting attribute usage scenarios [RFC4372].
Mobility protocols may reveal some long term identifier, such as a home address.
Application layer protocols may reveal other permanent identifiers.
To prevent the correlation of identities with location information, it is necessary to prevent leakage of identity information from all sources, not just one.
Unfortunately, most users are not educated about the importance of identity confidentiality, and some protocols lack support for identity privacy mechanisms.
This problem is made worse by the fact that users may be unable to choose particular protocols, as the choice is often dictated by the type of network operator they use, the type of network they wish to access, the kind of equipment they have, or the type of authentication method they are using.
A scenario where the user is attached to the home network is, from a privacy point of view, simpler than a scenario where a user roams into a visited network, since the NAS and the home RADIUS server are in the same administrative domain.
No direct relationship between the visited and the home network operator may be available, and some RADIUS brokers need to be consulted.
With subscription based network access as used today, the user has a contractual relationship with the home network provider that could (theoretically) allow higher privacy considerations to be applied (including policy rules stored at the home network itself, for the purpose of restricting further distribution).
In many cases it is necessary to secure the transport of location information along the RADIUS infrastructure.
Mechanisms to achieve this functionality are discussed in Section 7.1.
The Attribute Types and Attribute Values defined in this document have been registered by the Internet Assigned Numbers Authority (IANA) from the RADIUS namespaces as described in the "IANA Considerations" section of RFC 3575 [RFC3575], in accordance with BCP 26 [RFC5226].
Additionally, the Attribute Type has been registered in the Diameter namespace.
For RADIUS attributes and registries created by this document, IANA placed them in the Radius Types registry.
This document defines the following attributes:
Operator Name Location Information Location Data Basic Location Policy Rules
Extended Location Policy Rules Location Capable Requested Location Info Please refer to Section 5 for the registered list of numbers.
IANA has also assigned a new value (509) for the Error Cause Attribute [RFC5176] of "Location Info Required" according to this document.
Additionally, IANA created the following new registries listed in the subsections below.
This document also defines an Operator Namespace Identifier registry (used in the Namespace ID field of the Operator Name Attribute).
Note that this document requests IANA only to maintain a registry of existing namespaces for use in this identifier field, and not to establish any namespaces or place any values within namespaces.
IANA added the following values to the Operator Namespace Identifier registry using a numerical identifier (allocated in sequence), a token for the operator namespace, and a contact person for the registry.
Identifier  Operator Namespace   Contact Person
Note that the above identifier values represent the ASCII value '0' (decimal 48 or hex 0x30), '1' (decimal 49, or hex 0x31), '2' (decimal 50, or hex 0x32), and '3' (decimal 51, or hex 0x33).
This encoding was chosen to simplify parsing.
Requests to IANA for a new value for a Namespace ID, i.e., values from 0x34 to 0xFE, will be approved by Expert Review.
A designated expert will be appointed by the IESG.
The Expert Reviewer should ensure that a new entry is indeed required or could fit within an existing database, e.g., whether there is a real requirement to provide a token for a Namespace ID because one is already up and running, or whether the REALM identifier plus the name should be recommended to the requester.
In addition, the Expert Reviewer should ascertain to some reasonable degree of diligence that a new entry is a correct reference to an operator namespace whenever a new one is registered.
Location Profiles Section 4.2 defines the Location Information Attribute and a Code field that contains an 8 bit integer value.
Two values, zero and one, are defined in this document, namely: Value (0):
Civic location profile described in Section 4.3.1 Value (1):
Geospatial location profile described in Section 4.3.2
The remaining values are reserved for future use.
Following the policies outlined in [RFC3575], the available bits with a description of their semantics will be assigned after the Expert Review process.
Updates can be provided based on expert approval only.
Based on expert approval, it is possible to mark entries as "deprecated".
A designated expert will be appointed by the IESG.
Each registration must include the value and the corresponding semantics of the defined location profile.
New Registry: Location Capable Attribute Section 4.6 defines the Location Capable Attribute that contains a bit map.
32 bits are available, from which 4 bits are defined by this document.
This document creates a new IANA registry for the Location Capable Attribute.
IANA added the following values to this registry:
Following the policies outlined in [RFC3575], the available bits with a description of their semantics will be assigned after the Expert Review process.
Updates can be provided based on expert approval only.
Based on expert approval, it is possible to mark entries as "deprecated".
A designated expert will be appointed by the IESG.
Each registration must include: Name: Capability Token (i.e., an identifier of the capability)
Brief description indicating the meaning of the 'info' element.
A numerical value that is placed into the Capability Attribute representing a bit in the bit string of the Requested Location  Info Attribute.
Entity Types Section 4.2 defines the Location Information Attribute that contains an 8 bit Entity field.
Two values are registered by this document, namely: Value (0) describes the location of the user's client device.
Value (1) describes the location of the RADIUS client.
All other values are reserved for future use.
Following the policies outlined in [RFC3575], the available bits with a description of their semantics will be assigned after the Expert Review process.
Updates can be provided based on expert approval only.
Based on expert approval, it is possible to mark entries as "deprecated".
A designated expert will be appointed by the IESG.
Each registration must include the value and a corresponding description.
Privacy Flags Section 4.4 defines the Basic Location Policy Rules Attribute that contains flags indicating privacy settings.
16 bits are available, from which a single bit, bit (0), indicating 'retransmission allowed' is defined by this document.
Bits 1 15 are reserved for future use.
Following the policies outline in [RFC3575], the available bits with a description of their semantics will be assigned after the Expert Review process.
Updates can be provided based on expert approval only.
Based on expert approval, it is possible to mark entries as "deprecated".
A designated expert will be appointed by the IESG.
Each registration must include the bit position and the semantics of the bit.
Requested Location Info Attribute Section 4.7 defines the Requested Location Info Attribute that contains a bit map.
32 bits are available, from which 6 bits are defined by this document.
This document creates a new IANA registry for the Requested Location Info Attribute.
IANA added the following values to this registry:
The semantics of these values are defined in Section 4.7.
Following the policies outlined in [RFC3575], new Capability Tokens, with a description of their semantics for usage with the Requested  Location Info Attribute, will be assigned after the Expert Review process.
Updates can be provided based on expert approval only.
Based on expert approval, it is possible to mark entries as "deprecated".
A designated expert will be appointed by the IESG.
Each registration must include: Name: Capability Token (i.e., an identifier of the capability)
Brief description indicating the meaning of the 'info' element.
A numerical value that is placed into the Capability Attribute representing a bit in the bit string of the Requested Location  Info Attribute.
Appendix A.  Matching with GEOPRIV Requirements
This section compares the requirements for a GEOPRIV using protocol, described in [RFC3693], against the approach of distributing Location Objects with RADIUS.
In Appendices A.1 and A.2, we discuss privacy implications when RADIUS entities make location information available to other parties.
In Appendix A.3, the requirements are matched against these two scenarios.
Distribution of Location Information at the User's Home Network
When location information is conveyed from the RADIUS client to the RADIUS server, then it might subsequently be made available for different purposes.
This section discusses the privacy implications for making location information available to other entities.
To use a more generic scenario, we assume that the visited RADIUS and the home RADIUS server belong to different administrative domains.
The Location Recipient obtains location information about a particular Target via protocols specified outside the scope of this document (e.g., SIP, HTTP, or an API).
The subsequent figure shows the interacting entities graphically.
The term 'Rule Holder' in Figure 8 denotes the entity that creates the authorization ruleset.
Distribution of Location Information at the Visited Network
This section describes a scenario where location information is made available to Location Recipients by a Location Server in the visited network.
Some identifier needs to be used as an index within the location database.
One possible identifier is the Network Access Identifier.
[RFC4372] provide background regarding whether entities in the visited network can obtain the user's NAI in cleartext.
The visited network provides location information to a Location Recipient (e.g., via SIP or HTTP).
This document enables the NAS to obtain the user's privacy policy via the interaction with the RADIUS server.
Otherwise, only default policies, which are very restrictive, are available.
This allows the Location Server in the visited network to ensure they act according to the user's policies.
The subsequent figure shows the interacting entities graphically.
This document enables the RADIUS client to obtain these policies.
The Location Server can subsequently act according to these policies to provide access control using the Extended Location Policy Rules and to adhere to the privacy statements in the Basic Location Policy  Rules.
Requirements Matching Section 7.1 of [RFC3693] details the requirements of a "Location Object".
We discuss these requirements in the subsequent list.
Regarding requirement 1.1, the syntax and semantics of the Location Object are taken from [RFC3825] and [RFC4776].
It is furthermore possible to convert it to the format used in the Geography Markup Language (GMLv3) [GMLv3], as used with PIDF LO [RFC4119].
Regarding requirement 1.2, a number of fields in the civic location information format are optional.
Regarding requirement 1.3, the inclusion of type of place item (CAtype 29) used in the DHCP civic format gives a further classification of the location.
This attribute can be seen as an extension.
Regarding requirement 1.4, this document does not define the format of the location information.
Regarding requirement 1.5, location information is only sent from the RADIUS client to the RADIUS server.
Regarding requirement 1.6, the Location Object contains both location information and privacy rules.
Location information is described in Sections 4.2, 4.3.1, and 4.3.2.
The corresponding privacy rules are detailed in Sections 4.4 and 4.5.
Regarding requirement 1.7, the Location Object is usable in a variety of protocols.
The format of the object is reused from other documents, as detailed in Sections 4.2, 4.3.1, 4.3.2, 4.4, and 4.5.
Regarding requirement 1.8, the encoding of the Location Object has an emphasis on a lightweight encoding format to be used with RADIUS.
Regarding requirement 2.1, the target identifier is carried within the network access authentication protocol (e.g., within the EAP Identity Response when EAP is used and/or within the EAP method itself).
As described in Section 7.2 of this document, it has a number of advantages if this identifier is not carried in clear.
This is possible with certain EAP methods whereby the identity in the EAP Identity Response only contains information relevant for routing the response to the user's home network.
The user identity is protected by the authentication and key exchange protocol.
Regarding requirement 2.2, the Location Recipient is, in the main scenario, the home RADIUS server.
For a scenario where the Location Recipient is obtaining location information from the Location Server via HTTP or SIP, the respective mechanisms defined in these protocols are used to identify the recipient.
The Location Generator cannot, a priori, know the recipients if they are not defined in this protocol.
Regarding requirement 2.3, the credentials of the Location Recipient are known to the RADIUS entities based on the security mechanisms defined in the RADIUS protocol itself.
Section 7 of this document describes these security mechanisms offered by the RADIUS protocol.
The same is true for requirement 2.4.
Regarding requirement 2.5, Sections 4.2, 4.3.1, and 4.3.2 describe the content of the Location fields.
Since the location format itself is not defined in this document, motion and direction vectors as listed in requirement 2.6 are not defined.
Regarding requirement 2.6, this document provides the capability for the RADIUS server to indicate what type of location information it would like to see from the RADIUS client.
Regarding requirement 2.7, timing information is provided with the 'Sighting Time' and 'Time to Live' fields defined in Section 4.2.
Regarding requirement 2.8, a reference to an external (more detailed ruleset) is provided with the Extended Location  Policy Rules Attribute in Section 4.5.
Regarding requirement 2.9, security headers and trailers are provided as part of the RADIUS protocol or even as part of IPsec.
Regarding requirement 2.10, a version number in RADIUS is provided with the IANA registration of the attributes.
New attributes are assigned a new IANA number.
Regarding requirement 3.1, this document reuses civic and geospatial location information as described in Sections 4.3.2 and 4.3.1.
With the support of civic and geospatial location information, support of requirement 3.2 is fulfilled.
Regarding requirement 3.3, the geospatial location information used by this document only refers to absolute coordinates.
However, the granularity of the location information can be reduced with the help of the AltRes, LoRes, and LaRes fields described in [RFC3825].
Regarding requirement 3.4, further Location Data Types can be added via new coordinate reference systems (CRSs   see the Datum field in [RFC3825])
and via extensions to [RFC3825] and [RFC4776].
Section 7.2 of [RFC3693] details the requirements of a "using protocol".
These requirements are listed below.
The using protocol has to obey the privacy and security instructions coded in the Location Object (LO) regarding the transmission and storage of the LO.
This document requires that entities that aim to make location information available to third parties be required to obey the privacy instructions.
The using protocol will typically facilitate that the keys associated with the credentials are transported to the respective parties, that is, key establishment is the responsibility of the using protocol.
Section 7 of this document specifies how security mechanisms are used in RADIUS and how they can be reused to provide security protection for the Location Object.
Additionally, the privacy considerations (see Section 7.2) are also relevant for this requirement.
In particular, for tracking of small target devices, the design should allow a single message/ packet transmission of location as a complete transaction.
The encoding of the Location Object is specifically tailored towards the inclusion into a single message that even respects the (Path) MTU size.
Section 7.3 of [RFC3693] details the requirements of a "Rule based Location Data Transfer".
These requirements are listed below.
With the scenario shown in Figure 8, the decision of a Location Server to provide a Location Recipient access to location information is based on Rule Maker defined privacy rules that are stored at the home network.
With regard to the scenario shown in Figure 9, the Rule Maker defined privacy rules are sent from the RADIUS server to the NAS (see Sections 4.4, 4.5, and 7.2 for more details).
For all usage scenarios, it is possible to consider the privacy rule before transmitting location information from the NAS to the RADIUS server or even to third parties.
In the case of an out of band agreement between the owner of the NAS and the owner of the RADIUS server, privacy might be applied on a higher granularity.
For the scenario shown in Figure 8, the visited network is already in possession of the user's location information prior to the authentication and authorization of the user.
A correlation between the location and the user identity might, however, still not be possible for the visited network (as explained in Section 7.2).
A Location Server in the visited network has to evaluate available rulesets.
The Rule Maker might define (via mechanisms outside the scope of this document) which policy rules are disclosed to other entities.
GEOPRIV has defined a rule language capable of expressing a wide range of privacy rules that is applicable in the area of the distribution of Location Objects.
A basic ruleset is provided with the Basic Location Policy Rules Attribute (Section 4.4).
A reference to the extended ruleset is carried in Section 4.5.
The format of these rules is described in [RFC4745] and [GEO POLICY].
A limited (or basic) ruleset is provided by the Policy Information Attribute in Section 4.4 (and as introduced with PIDF LO [RFC4119]).
Section 7.4 of [RFC3693] details the requirements of a "Location Object Privacy and Security".
These requirements are listed below.
Support for unlinkable pseudonyms is provided by the usage of a corresponding authentication and key  exchange protocol.
Such protocols are available, for example, with the support of EAP as network access authentication methods.
Some EAP methods support passive user identity confidentiality, whereas others even support active user identity confidentiality.
This issue is further discussed in Section 7.
The importance for user identity confidentiality and identity protection has already been recognized as an important property (see, for example, a document on EAP method requirements for wireless LANs [RFC4017]).
(Credential Requirements):  As described in Section 7 , RADIUS signaling messages can be protected with IPsec.
This allows a number of authentication and key exchange protocols to be used as part of IKE, IKEv2, or KINK.
GEOPRIV defines a few security requirements for the protection of Location Objects, such as mutual end point authentication, data object integrity, data object confidentiality, and replay protection.
As described in Section 7, these requirements are fulfilled with the usage of IPsec if mutual authentication refers to the RADIUS entities (acting as various GEOPRIV entities) that directly communicate with each other.
A minimum of security mechanisms are mandated by the usage of RADIUS.
Communication security for Location Objects between RADIUS infrastructure elements is provided by the RADIUS protocol (including IPsec and its dynamic key management framework), rather than relying on object security via S/SIME (which is not available with RADIUS).
