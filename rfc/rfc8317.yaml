- title: __initial_text__
  contents:
  - "       Ethernet-Tree (E-Tree) Support in Ethernet VPN (EVPN) and\n          \
    \     Provider Backbone Bridging EVPN (PBB-EVPN)\n"
- title: Abstract
  contents:
  - "Abstract\n   The MEF Forum (MEF) has defined a rooted-multipoint Ethernet service\n\
    \   known as Ethernet-Tree (E-Tree).  A solution framework for supporting\n  \
    \ this service in MPLS networks is described in RFC 7387, \"A Framework\n   for\
    \ Ethernet-Tree (E-Tree) Service over a Multiprotocol Label\n   Switching (MPLS)\
    \ Network\".  This document discusses how those\n   functional requirements can\
    \ be met with a solution based on RFC 7432,\n   \"BGP MPLS Based Ethernet VPN\
    \ (EVPN)\", with some extensions and a\n   description of how such a solution\
    \ can offer a more efficient\n   implementation of these functions than that of\
    \ RFC 7796,\n   \"Ethernet-Tree (E-Tree) Support in Virtual Private LAN Service\n\
    \   (VPLS)\".  This document makes use of the most significant bit of the\n  \
    \ Tunnel Type field (in the P-Multicast Service Interface (PMSI) Tunnel\n   attribute)\
    \ governed by the IANA registry created by RFC 7385; hence,\n   it updates RFC\
    \ 7385 accordingly.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8317.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2018 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   4\n   2.  Terminology . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .   5\n     2.1.  Specification of Requirements . . . . . . . . . . .\
    \ . . .   5\n     2.2.  Terms and Abbreviations . . . . . . . . . . . . . . .\
    \ . .   5\n   3.  E-Tree Scenarios  . . . . . . . . . . . . . . . . . . . . .\
    \ .   6\n     3.1.  Scenario 1: Leaf or Root Site(s) per PE . . . . . . . . .\
    \   6\n     3.2.  Scenario 2: Leaf or Root Site(s) per AC . . . . . . . . .  \
    \ 7\n     3.3.  Scenario 3: Leaf or Root Site(s) per MAC Address  . . . .   8\n\
    \   4.  Operation for EVPN  . . . . . . . . . . . . . . . . . . . . .   9\n  \
    \   4.1.  Known Unicast Traffic . . . . . . . . . . . . . . . . . .   9\n    \
    \ 4.2.  BUM Traffic . . . . . . . . . . . . . . . . . . . . . . .  10\n      \
    \ 4.2.1.  BUM Traffic Originated from a Single-Homed Site on a\n             \
    \  Leaf AC . . . . . . . . . . . . . . . . . . . . . . .  11\n       4.2.2.  BUM\
    \ Traffic Originated from a Single-Homed Site on a\n               Root AC . .\
    \ . . . . . . . . . . . . . . . . . . . . .  11\n       4.2.3.  BUM Traffic Originated\
    \ from a Multihomed Site on a\n               Leaf AC . . . . . . . . . . . .\
    \ . . . . . . . . . . .  12\n       4.2.4.  BUM Traffic Originated from a Multihomed\
    \ Site on a\n               Root AC . . . . . . . . . . . . . . . . . . . . .\
    \ . .  12\n     4.3.  E-Tree Traffic Flows for EVPN . . . . . . . . . . . . .\
    \ .  12\n       4.3.1.  E-Tree with MAC Learning  . . . . . . . . . . . . . .\
    \  13\n       4.3.2.  E-Tree without MAC Learning . . . . . . . . . . . . .  14\n\
    \   5.  Operation for PBB-EVPN  . . . . . . . . . . . . . . . . . . .  14\n  \
    \   5.1.  Known Unicast Traffic . . . . . . . . . . . . . . . . . .  15\n    \
    \ 5.2.  BUM Traffic . . . . . . . . . . . . . . . . . . . . . . .  15\n     5.3.\
    \  E-Tree without MAC Learning . . . . . . . . . . . . . . .  16\n   6.  BGP Encoding\
    \  . . . . . . . . . . . . . . . . . . . . . . . .  16\n     6.1.  E-Tree Extended\
    \ Community . . . . . . . . . . . . . . . .  16\n     6.2.  PMSI Tunnel Attribute\
    \ . . . . . . . . . . . . . . . . . .  17\n   7.  Security Considerations . .\
    \ . . . . . . . . . . . . . . . . .  18\n   8.  IANA Considerations . . . . .\
    \ . . . . . . . . . . . . . . . .  19\n     8.1.  Considerations for PMSI Tunnel\
    \ Types  . . . . . . . . . .  19\n   9.  References  . . . . . . . . . . . . .\
    \ . . . . . . . . . . . .  20\n     9.1.  Normative References  . . . . . . .\
    \ . . . . . . . . . . .  20\n     9.2.  Informative References  . . . . . . .\
    \ . . . . . . . . . .  21\n   Appendix A.  Multiple Bridge Tables per E-Tree Service\
    \ Instance .  22\n   Acknowledgements  . . . . . . . . . . . . . . . . . . . .\
    \ . . . .  23\n   Authors' Addresses  . . . . . . . . . . . . . . . . . . . .\
    \ . . .  23\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The MEF Forum (MEF) has defined a rooted-multipoint Ethernet\
    \ service\n   known as Ethernet-Tree (E-Tree) [MEF6.1].  In an E-Tree service,\
    \ a\n   customer site that is typically represented by an Attachment Circuit\n\
    \   (AC) (e.g., an 802.1Q VLAN tag [IEEE.802.1Q]), is labeled as either a\n  \
    \ Root or a Leaf site.  A customer site may also be represented by a\n   Media\
    \ Access Control (MAC) address along with a VLAN tag.  Root sites\n   can communicate\
    \ with all other customer sites (both Root and Leaf\n   sites).  However, Leaf\
    \ sites can communicate with Root sites but not\n   with other Leaf sites.  In\
    \ this document, unless explicitly mentioned\n   otherwise, a site is always represented\
    \ by an AC.\n   [RFC7387] describes a solution framework for supporting E-Tree\n\
    \   service in MPLS networks.  This document identifies the functional\n   components\
    \ of an overall solution to emulate E-Tree services in MPLS\n   networks and supplements\
    \ the multipoint-to-multipoint Ethernet LAN\n   (E-LAN) services specified in\
    \ [RFC7432] and [RFC7623].\n   [RFC7432] defines EVPN, a solution for multipoint\
    \ Layer 2 Virtual\n   Private Network (L2VPN) services with advanced multihoming\n\
    \   capabilities that uses BGP for distributing customer/client MAC\n   address\
    \ reachability information over the MPLS/IP network.  [RFC7623]\n   combines the\
    \ functionality of EVPN with [IEEE.802.1ah] Provider\n   Backbone Bridging (PBB)\
    \ for MAC address scalability.\n   This document discusses how the functional\
    \ requirements for E-Tree\n   service can be met with a solution based on EVPN\
    \ [RFC7432] and\n   PBB-EVPN [RFC7623] with some extensions to their procedures\
    \ and BGP\n   attributes.  Such a solution based on PBB-EVPN or EVPN can offer\
    \ a\n   more efficient implementation of these functions than that of\n   [RFC7796],\
    \ \"Ethernet-Tree (E-Tree) Support in Virtual Private LAN\n   Service (VPLS)\"\
    .  This efficiency is achieved by performing filtering\n   of unicast traffic\
    \ at the ingress Provider Edge (PE) nodes as opposed\n   to egress filtering where\
    \ the traffic is sent through the network and\n   gets filtered and discarded\
    \ at the egress PE nodes.  The details of\n   this ingress filtering are described\
    \ in Section 4.1.  Since this\n   document specifies a solution based on [RFC7432],\
    \ the knowledge of\n   that document is a prerequisite.  This document makes use\
    \ of the most\n   significant bit of the Tunnel Type field (in the PMSI Tunnel\n\
    \   attribute) governed by the IANA registry created by [RFC7385]; hence,\n  \
    \ it updates [RFC7385] accordingly.  Section 3 discusses E-Tree\n   scenarios,\
    \ Sections 4 and 5 describe E-Tree solutions for EVPN and\n   PBB-EVPN (respectively),\
    \ and Section 6 covers BGP encoding for E-Tree\n   solutions.\n"
- title: 2.  Terminology
  contents:
  - '2.  Terminology

    '
- title: 2.1.  Specification of Requirements
  contents:
  - "2.1.  Specification of Requirements\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be\
    \ interpreted as described in\n   BCP 14 [RFC2119] [RFC8174] when, and only when,\
    \ they appear in all\n   capitals, as shown here.\n"
- title: 2.2.  Terms and Abbreviations
  contents:
  - "2.2.  Terms and Abbreviations\n   Broadcast Domain:  In a bridged network, the\
    \ broadcast domain\n      corresponds to a Virtual LAN (VLAN), where a VLAN is\
    \ typically\n      represented by a single VLAN ID (VID) but can be represented\
    \ by\n      several VIDs where Shared VLAN Learning (SVL) is used per\n      [IEEE.802.1ah].\n\
    \   Bridge Table:  An instantiation of a broadcast domain on a MAC-VRF.\n   CE:\
    \  A Customer Edge device, e.g., a host, router, or switch.\n   EVI:  An EVPN\
    \ Instance spanning the Provider Edge (PE) devices\n      participating in that\
    \ EVPN.\n   MAC-VRF:  A Virtual Routing and Forwarding table for Media Access\n\
    \      Control (MAC) addresses on a PE.\n   ES:  When a customer site (device\
    \ or network) is connected to one or\n      more PEs via a set of Ethernet links,\
    \ then that set of links is\n      referred to as an \"Ethernet Segment\".\n \
    \  ESI:  An Ethernet Segment Identifier is a unique non-zero identifier\n    \
    \  that identifies an ES.\n   Ethernet Tag:  An Ethernet Tag identifies a particular\
    \ broadcast\n      domain, e.g., a VLAN.  An EVPN instance consists of one or\
    \ more\n      broadcast domains.\n   P2MP:  Point-to-Multipoint.\n   PE:  Provider\
    \ Edge device.\n"
- title: 3.  E-Tree Scenarios
  contents:
  - "3.  E-Tree Scenarios\n   This document categorizes E-Tree scenarios into the\
    \ following three\n   categories, depending on the nature of the Root/Leaf site\n\
    \   association:\n   Scenario 1:  either Leaf or Root site(s) per PE;\n   Scenario\
    \ 2:  either Leaf or Root site(s) per Attachment Circuit (AC);\n             \
    \   or,\n   Scenario 3:  either Leaf or Root site(s) per MAC address.\n"
- title: '3.1.  Scenario 1: Leaf or Root Site(s) per PE'
  contents:
  - "3.1.  Scenario 1: Leaf or Root Site(s) per PE\n   In this scenario, a PE may\
    \ receive traffic from either Root ACs or\n   Leaf ACs for a given MAC-VRF/bridge\
    \ table, but not both.  In other\n   words, a given EVPN Instance (EVI) on a Provider\
    \ Edge (PE) device is\n   either associated with Root(s) or Leaf(s).  The PE may\
    \ have both Root\n   and Leaf ACs, albeit for different EVIs.\n              \
    \     +---------+            +---------+\n                   |   PE1   |     \
    \       |   PE2   |\n    +---+          |  +---+  |  +------+  |  +---+  |   \
    \         +---+\n    |CE1+---AC1----+--+   |  |  | MPLS |  |  |   +--+----AC2-----+CE2|\n\
    \    +---+  (Root)  |  |MAC|  |  |  /IP |  |  |MAC|  |   (Leaf)   +---+\n    \
    \               |  |VRF|  |  |      |  |  |VRF|  |\n                   |  |  \
    \ |  |  |      |  |  |   |  |            +---+\n                   |  |   |  |\
    \  |      |  |  |   +--+----AC3-----+CE3|\n                   |  +---+  |  +------+\
    \  |  +---+  |   (Leaf)   +---+\n                   +---------+            +---------+\n\
    \                           Figure 1: Scenario 1\n   In this scenario, tailored\
    \ BGP Route Target (RT) import/export\n   policies among the PEs belonging to\
    \ the same EVI can be used to\n   prevent communication among Leaf PEs.  To prevent\
    \ communication among\n   Leaf ACs connected to the same PE and belonging to the\
    \ same EVI,\n   split-horizon filtering is used to block traffic from one Leaf\
    \ AC to\n   another Leaf AC on a MAC-VRF for a given E-Tree EVI.  The purpose\
    \ of\n   this topology constraint is to avoid having PEs with only Leaf sites\n\
    \   importing and processing BGP MAC routes from each other.  To support\n   such\
    \ a topology constraint in EVPN, two BGP RTs are used for every\n   EVI: one RT\
    \ is associated with the Root sites (Root ACs) and the\n   other is associated\
    \ with the Leaf sites (Leaf ACs).  On a per-EVI\n   basis, every PE exports the\
    \ single RT associated with its type of\n   site(s).  Furthermore, a PE with a\
    \ Root site(s) imports both Root and\n   Leaf RTs, whereas a PE with a Leaf site(s)\
    \ only imports the Root RT.\n   For this scenario, if it is desired to use only\
    \ a single RT per EVI\n   (just like E-LAN services in [RFC7432]), then approach\
    \ B in Scenario\n   2 (described below) needs to be used.\n"
- title: '3.2.  Scenario 2: Leaf or Root Site(s) per AC'
  contents:
  - "3.2.  Scenario 2: Leaf or Root Site(s) per AC\n   In this scenario, a PE can\
    \ receive traffic from both Root ACs and\n   Leaf ACs for a given EVI.  In other\
    \ words, a given EVI on a PE can be\n   associated with both Root(s) and Leaf(s).\n\
    \                     +---------+            +---------+\n                   \
    \  |   PE1   |            |   PE2   |\n    +---+            |  +---+  |  +------+\
    \  |  +---+  |        +---+\n    |CE1+-----AC1----+--+   |  |  |      |  |  |\
    \   +--+---AC2--+CE2|\n    +---+    (Leaf)  |  |MAC|  |  | MPLS |  |  |MAC|  |\
    \ (Leaf) +---+\n                     |  |VRF|  |  |  /IP |  |  |VRF|  |\n    \
    \                 |  |   |  |  |      |  |  |   |  |        +---+\n          \
    \           |  |   |  |  |      |  |  |   +--+---AC3--+CE3|\n                \
    \     |  +---+  |  +------+  |  +---+  | (Root) +---+\n                     +---------+\
    \            +---------+\n                           Figure 2: Scenario 2\n  \
    \ In this scenario, (as in Scenario 1 Section 3.1), two RTs (one for\n   Root\
    \ and another for Leaf) can be used.  However, the difference is\n   that on a\
    \ PE with both Root and Leaf ACs, all remote MAC routes are\n   imported; thus,\
    \ in order to apply the proper ingress filtering, there\n   needs to be a way\
    \ to differentiate remote MAC routes associated with\n   Leaf ACs versus the ones\
    \ associated with Root ACs.\n   In order to recognize the association of a destination\
    \ MAC address to\n   a Leaf or Root AC and, thus, support ingress filtering on\
    \ the ingress\n   PE with both Leaf and Root ACs, MAC addresses need to be colored\
    \ with\n   a Root or Leaf-Indication before advertising to other PEs.  There are\n\
    \   two approaches for such coloring:\n   (A)  to always use two RTs (one to designate\
    \ Leaf RT and another for\n        Root RT), or\n   (B)  to allow for a single\
    \ RT to be used per EVI, just like\n        [RFC7432], and, thus, color MAC addresses\
    \ via a \"color\" flag in\n        a new extended community as detailed in Section\
    \ 6.1.\n   Approach A would require the same data-plane enhancements as approach\n\
    \   B if MAC-VRF and bridge tables used per VLAN are to remain consistent\n  \
    \ with Section 6 of [RFC7432].  In order to avoid data-plane\n   enhancements\
    \ for approach A, multiple bridge tables per VLAN may be\n   considered; however,\
    \ this has major drawbacks (as described in\n   Appendix A); thus, it is not recommended.\n\
    \   Given that both approaches A and B would require the same data-plane\n   enhancements,\
    \ approach B is chosen here in order to allow for RT\n   usage consistent with\
    \ baseline EVPN [RFC7432] and for better\n   generality.  It should be noted that\
    \ if one wants to use RT\n   constraints in order to avoid MAC advertisements\
    \ associated with a\n   Leaf AC to PEs with only Leaf ACs, then two RTs (one for\
    \ Root and\n   another for Leaf) can still be used with approach B; however, in\
    \ such\n   applications, Leaf/Root RTs will be used to constrain MAC\n   advertisements\
    \ and are not used to color the MAC routes for ingress\n   filtering (i.e., in\
    \ approach B, the coloring is always done via the\n   new extended community).\n\
    \   If, for a given EVI, a significant number of PEs have both Leaf and\n   Root\
    \ sites attached (even though they may start as Root-only or Leaf-\n   only PEs),\
    \ then a single RT per EVI should be used.  The reason for\n   such a recommendation\
    \ is to alleviate the configuration overhead\n   associated with using two RTs\
    \ per EVI at the expense of having some\n   unwanted MAC addresses on the Leaf-only\
    \ PEs.\n"
- title: '3.3.  Scenario 3: Leaf or Root Site(s) per MAC Address'
  contents:
  - "3.3.  Scenario 3: Leaf or Root Site(s) per MAC Address\n   In this scenario,\
    \ a customer Root or Leaf site is represented by a\n   MAC address on an AC and\
    \ a PE may receive traffic from both Root and\n   Leaf sites on that AC for an\
    \ EVI.  This scenario is not covered in\n   either [RFC7387] or [MEF6.1]; however,\
    \ it is covered in this document\n   for the sake of completeness.  In this scenario,\
    \ since an AC carries\n   traffic from both Root and Leaf sites, the granularity\
    \ at which Root\n   or Leaf sites are identified is on a per-MAC-address basis.\
    \  This\n   scenario is considered in this document for EVPN service with only\n\
    \   known unicast traffic because the Designated Forwarder (DF) filtering\n  \
    \ per [RFC7432] would not be compatible with the required egress\n   filtering;\
    \ that is, Broadcast, Unknown Unicast, and Multicast (BUM)\n   traffic is not\
    \ supported in this scenario; it is dropped by the\n   ingress PE.\n   For this\
    \ scenario, the approach B in Scenario 2 is used in order to\n   allow for single\
    \ RT usage by service providers.\n                     +---------+           \
    \ +---------+\n                     |   PE1   |            |   PE2   |\n    +---+\
    \            |  +---+  |  +------+  |  +---+  |            +---+\n    |CE1+-----AC1----+--+\
    \   |  |  |      |  |  |   +--+-----AC2----+CE2|\n    +---+    (Root)  |  | E\
    \ |  |  | MPLS |  |  | E |  | (Leaf/Root)+---+\n                     |  | V |\
    \  |  |  /IP |  |  | V |  |\n                     |  | I |  |  |      |  |  |\
    \ I |  |            +---+\n                     |  |   |  |  |      |  |  |  \
    \ +--+-----AC3----+CE3|\n                     |  +---+  |  +------+  |  +---+\
    \  |   (Leaf)   +---+\n                     +---------+            +---------+\n\
    \                           Figure 3: Scenario 3\n   In conclusion, the approach\
    \ B in scenario 2 is the recommended\n   approach across all the above three scenarios,\
    \ and the corresponding\n   solution is detailed in the following sections.\n"
- title: 4.  Operation for EVPN
  contents:
  - "4.  Operation for EVPN\n   [RFC7432] defines the notion of the Ethernet Segment\
    \ Identifier (ESI)\n   MPLS label used for split-horizon filtering of BUM traffic\
    \ at the\n   egress PE.  Such egress filtering capabilities can be leveraged in\n\
    \   provision of E-Tree services, as it will be seen shortly for BUM\n   traffic.\
    \  For known unicast traffic, additional extensions to\n   [RFC7432] are needed\
    \ (i.e., a new BGP extended community for Leaf-\n   Indication described in Section\
    \ 6.1) in order to enable ingress\n   filtering as described in detail in the\
    \ following sections.\n"
- title: 4.1.  Known Unicast Traffic
  contents:
  - "4.1.  Known Unicast Traffic\n   In EVPN, MAC learning is performed in the control\
    \ plane via\n   advertisement of BGP routes.  Because of this, the filtering needed\n\
    \   by an E-Tree service for known unicast traffic can be performed at\n   the\
    \ ingress PE, thus providing very efficient filtering and avoiding\n   sending\
    \ known unicast traffic over the MPLS/IP core to be filtered at\n   the egress\
    \ PE, as is done in traditional E-Tree solutions (i.e.,\n   E-Tree for VPLS [RFC7796]).\n\
    \   To provide such ingress filtering for known unicast traffic, a PE\n   MUST\
    \ indicate to other PEs what kind of sites (Root or Leaf) its MAC\n   addresses\
    \ are associated with.  This is done by advertising a Leaf-\n   Indication flag\
    \ (via an extended community) along with each of its\n   MAC/IP Advertisement\
    \ routes learned from a Leaf site.  The lack of\n   such a flag indicates that\
    \ the MAC address is associated with a Root\n   site.  This scheme applies to\
    \ all scenarios described in Section 3.\n   Tagging MAC addresses with a Leaf-Indication\
    \ enables remote PEs to\n   perform ingress filtering for known unicast traffic;\
    \ that is, on the\n   ingress PE, the MAC destination address lookup yields (in\
    \ addition to\n   the forwarding adjacency) a flag that indicates whether or not\
    \ the\n   target MAC is associated with a Leaf site.  The ingress PE cross-\n\
    \   checks this flag with the status of the originating AC, and if both\n   are\
    \ Leafs, then the packet is not forwarded.\n   In a situation where MAC moves\
    \ are allowed among Leaf and Root sites\n   (e.g., non-static MAC), PEs can receive\
    \ multiple MAC/IP Advertisement\n   routes for the same MAC address with different\
    \ Root or Leaf-\n   Indications (and possibly different ESIs for multihoming scenarios).\n\
    \   In such situations, MAC mobility procedures (see Section 15 of\n   [RFC7432])\
    \ take precedence to first identify the location of the MAC\n   before associating\
    \ that MAC with a Root or a Leaf site.\n   To support the above ingress filtering\
    \ functionality, a new E-Tree\n   extended community with a Leaf-Indication flag\
    \ is introduced (see\n   Section 6.1).  This new extended community MUST be advertised\
    \ with\n   MAC/IP Advertisement routes learned from a Leaf site.  Besides MAC/IP\n\
    \   Advertisement routes, no other EVPN routes are required to carry this\n  \
    \ new extended community for the purpose of known unicast traffic.\n"
- title: 4.2.  BUM Traffic
  contents:
  - "4.2.  BUM Traffic\n   This specification does not provide support for filtering\
    \ Broadcast,\n   Unknown Unicast, and Multicast (BUM) traffic on the ingress PE;\
    \ due\n   to the multidestination nature of BUM traffic, it is not possible to\n\
    \   perform filtering of the same on the ingress PE.  As such, the\n   solution\
    \ relies on egress filtering.  In order to apply the proper\n   egress filtering,\
    \ which varies based on whether a packet is sent from\n   a Leaf AC or a Root\
    \ AC, the MPLS-encapsulated frames MUST be tagged\n   with an indication of when\
    \ they originated from a Leaf AC (i.e., to\n   be tagged with a Leaf label as\
    \ specified in Section 6.1).  This Leaf\n   label allows for disposition PE (e.g.,\
    \ egress PE) to perform the\n   necessary egress filtering function in a data\
    \ plane similar to the\n   ESI label in [RFC7432].  The allocation of the Leaf\
    \ label is on a\n   per-PE basis (e.g., independent of ESI and EVI) as described\
    \ in the\n   following sections.\n   The Leaf label can be upstream assigned for\
    \ Point-to-Multipoint\n   (P2MP) Label Switched Path (LSP) or downstream assigned\
    \ for Ingress\n   Replication tunnels.  The main difference between a downstream-\
    \ and\n   upstream-assigned Leaf label is that, in the case of downstream-\n \
    \  assigned Leaf labels, not all egress PE devices need to receive the\n   label\
    \ in MPLS-encapsulated BUM packets, just like the ESI label for\n   Ingress Replication\
    \ procedures defined in [RFC7432].\n   On the ingress PE, the PE needs to place\
    \ all its Leaf ACs for a given\n   bridge domain in a single split-horizon group\
    \ in order to prevent\n   intra-PE forwarding among its Leaf ACs.  This intra-PE\
    \ split-horizon\n   filtering applies to BUM traffic as well as known unicast\
    \ traffic.\n   There are four scenarios to consider as follows.  In all these\n\
    \   scenarios, the ingress PE imposes the right MPLS label associated\n   with\
    \ the originated Ethernet Segment (ES) depending on whether the\n   Ethernet frame\
    \ originated from a Root or a Leaf site on that Ethernet\n   Segment (ESI label\
    \ or Leaf label).  The mechanism by which the PE\n   identifies whether a given\
    \ frame originated from a Root or a Leaf\n   site on the segment is based on the\
    \ AC identifier for that segment\n   (e.g., Ethernet Tag of the frame for 802.1Q\
    \ frames [IEEE.802.1Q]).\n   Other mechanisms for identifying Root or Leaf sites,\
    \ such as the use\n   of the source MAC address of the receiving frame, are optional.\
    \  The\n   scenarios below are described in context of a Root/Leaf AC, however,\n\
    \   they can be extended to the Root/Leaf MAC address if needed.\n"
- title: 4.2.1.  BUM Traffic Originated from a Single-Homed Site on a Leaf AC
  contents:
  - "4.2.1.  BUM Traffic Originated from a Single-Homed Site on a Leaf AC\n   In this\
    \ scenario, the ingress PE adds a Leaf label advertised using\n   the E-Tree extended\
    \ community (see Section 6.1), which indicates a\n   Leaf site.  This Leaf label,\
    \ used for single-homing scenarios, is not\n   on a per-ES basis but rather on\
    \ a per PE basis (i.e., a single Leaf\n   MPLS label is used for all single-homed\
    \ ESs on that PE).  This Leaf\n   label is advertised to other PE devices using\
    \ the E-Tree extended\n   community (see Section 6.1) along with an Ethernet Auto-Discovery\
    \ per\n   ES (EAD-ES) route with an ESI of zero and a set of RTs corresponding\n\
    \   to all EVIs on the PE where each EVI has at least one Leaf site.\n   Multiple\
    \ EAD-ES routes will need to be advertised if the number of\n   RTs that need\
    \ to be carried exceed the limit on a single route per\n   [RFC7432].  The ESI\
    \ for the EAD-ES route is set to zero to indicate\n   single-homed sites.\n  \
    \ When a PE receives this special Leaf label in the data path, it\n   blocks the\
    \ packet if the destination AC is of type Leaf; otherwise,\n   it forwards the\
    \ packet.\n"
- title: 4.2.2.  BUM Traffic Originated from a Single-Homed Site on a Root AC
  contents:
  - "4.2.2.  BUM Traffic Originated from a Single-Homed Site on a Root AC\n   In this\
    \ scenario, the ingress PE does not add any ESI or Leaf labels\n   and it operates\
    \ per the procedures in [RFC7432].\n"
- title: 4.2.3.  BUM Traffic Originated from a Multihomed Site on a Leaf AC
  contents:
  - "4.2.3.  BUM Traffic Originated from a Multihomed Site on a Leaf AC\n   In this\
    \ scenario, it is assumed that while different ACs (VLANs) on\n   the same ES\
    \ could have a different Root/Leaf designation (some being\n   Roots and some\
    \ being Leafs), the same VLAN does have the same Root/\n   Leaf designation on\
    \ all PEs on the same ES.  Furthermore, it is\n   assumed that there is no forwarding\
    \ among subnets (i.e., the service\n   is EVPN L2 and not EVPN Integrated Routing\
    \ and Bridging (IRB)\n   [EVPN-INTEGRATED]).  IRB use cases described in [EVPN-INTEGRATED]\
    \ are\n   outside the scope of this document.\n   In this scenario, if a multicast\
    \ or broadcast packet is originated\n   from a Leaf AC, then it only needs to\
    \ carry a Leaf label as described\n   in Section 4.2.1.  This label is sufficient\
    \ in providing the\n   necessary egress filtering of BUM traffic from getting\
    \ sent to Leaf\n   ACs, including the Leaf AC on the same ES.\n"
- title: 4.2.4.  BUM Traffic Originated from a Multihomed Site on a Root AC
  contents:
  - "4.2.4.  BUM Traffic Originated from a Multihomed Site on a Root AC\n   In this\
    \ scenario, both the ingress and egress PE devices follow the\n   procedure defined\
    \ in [RFC7432] for adding and/or processing an ESI\n   MPLS label; that is, existing\
    \ procedures for BUM traffic in [RFC7432]\n   are sufficient and there is no need\
    \ to add a Leaf label.\n"
- title: 4.3.  E-Tree Traffic Flows for EVPN
  contents:
  - "4.3.  E-Tree Traffic Flows for EVPN\n   Per [RFC7387], a generic E-Tree service\
    \ supports all of the following\n   traffic flows:\n   -  known unicast traffic\
    \ from Root to Roots & Leafs\n   -  known unicast traffic from Leaf to Roots\n\
    \   -  BUM traffic from Root to Roots & Leafs\n   -  BUM traffic from Leaf to\
    \ Roots\n   A particular E-Tree service may need to support all of the above\n\
    \   types of flows or only a select subset, depending on the target\n   application.\
    \  In the case where only multicast and broadcast flows\n   need to be supported,\
    \ the L2VPN PEs can avoid performing any MAC\n   learning function.\n   The following\
    \ subsections will describe the operation of EVPN to\n   support E-Tree service\
    \ with and without MAC learning.\n"
- title: 4.3.1.  E-Tree with MAC Learning
  contents:
  - "4.3.1.  E-Tree with MAC Learning\n   The PEs implementing an E-Tree service must\
    \ perform MAC learning when\n   unicast traffic flows must be supported among\
    \ Root and Leaf sites.\n   In this case, the PE(s) with Root sites performs MAC\
    \ learning in the\n   data path over the ESs and advertises reachability in EVPN\
    \ MAC/IP\n   Advertisement routes.  These routes will be imported by all PEs for\n\
    \   that EVI (i.e., PEs that have Leaf sites as well as PEs that have\n   Root\
    \ sites).  Similarly, the PEs with Leaf sites perform MAC learning\n   in the\
    \ data path over their ESs and advertise reachability in EVPN\n   MAC/IP Advertisement\
    \ routes.  For scenarios where two different RTs\n   are used per EVI (one to\
    \ designate a Root site and another to\n   designate a Leaf site), the MAC/IP\
    \ Advertisement routes are imported\n   only by PEs with at least one Root site\
    \ in the EVI (i.e., a PE with\n   only Leaf sites will not import these routes).\
    \  PEs with Root and/or\n   Leaf sites may use the Ethernet Auto-Discovery per\
    \ EVI (EAD-EVI)\n   routes for aliasing (in the case of multihomed segments) and\
    \ EAD-ES\n   routes for mass MAC withdrawal per [RFC7432].\n   To support multicast/broadcast\
    \ from Root to Leaf sites, either a P2MP\n   tree rooted at the PE(s) with the\
    \ Root site(s) (e.g., Root PEs) or\n   Ingress Replication can be used (see Section\
    \ 16 of [RFC7432]).  The\n   multicast tunnels are set up through the exchange\
    \ of the EVPN\n   Inclusive Multicast route, as defined in [RFC7432].\n   To support\
    \ multicast/broadcast from Leaf to Root sites, either\n   Ingress Replication\
    \ tunnels from each Leaf PE or a P2MP tree rooted\n   at each Leaf PE can be used.\
    \  The following two paragraphs describe\n   when each of these tunneling schemes\
    \ can be used and how to signal\n   them.\n   When there are only a few Root PEs\
    \ with small amount of multicast/\n   broadcast traffic from Leaf PEs toward Root\
    \ PEs, then Ingress\n   Replication tunnels from Leaf PEs toward Root PEs should\
    \ be\n   sufficient.  Therefore, if a Root PE needs to support a P2MP tunnel\n\
    \   in the transmit direction from itself to Leaf PEs, and, at the same\n   time,\
    \ it wants to support Ingress Replication tunnels in the receive\n   direction,\
    \ the Root PE can signal it efficiently by using a new\n   composite tunnel type\
    \ defined in Section 6.2.  This new composite\n   tunnel type is advertised by\
    \ the Root PE to simultaneously indicate a\n   P2MP tunnel in the transmit direction\
    \ and an Ingress Replication\n   tunnel in the receive direction for the BUM traffic.\n\
    \   If the number of Root PEs is large, P2MP tunnels (e.g., Multipoint\n   LDP\
    \ (mLDP) or RSVP-TE) originated at the Leaf PEs may be used; thus,\n   there will\
    \ be no need to use the modified PMSI Tunnel attribute and\n   the composite tunnel\
    \ type values defined in Section 6.2.\n"
- title: 4.3.2.  E-Tree without MAC Learning
  contents:
  - "4.3.2.  E-Tree without MAC Learning\n   The PEs implementing an E-Tree service\
    \ need not perform MAC learning\n   when the traffic flows between Root and Leaf\
    \ sites are mainly\n   multicast or broadcast.  In this case, the PEs do not exchange\
    \ EVPN\n   MAC/IP Advertisement routes.  Instead, the Inclusive Multicast\n  \
    \ Ethernet Tag route is used to support BUM traffic.  In such\n   scenarios, the\
    \ small amount of unicast traffic (if any) is sent as\n   part of BUM traffic.\n\
    \   The fields of this route are populated per the procedures defined in\n   [RFC7432],\
    \ and the multicast tunnel setup criteria are as described\n   in the previous\
    \ section.\n   Just as in the previous section, if the number of Root PEs are\
    \ only a\n   few and, thus, Ingress Replication is desired from Leaf PEs to these\n\
    \   Root PEs, then the modified PMSI attribute and the composite tunnel\n   type\
    \ values defined in Section 6.2 should be used.\n"
- title: 5.  Operation for PBB-EVPN
  contents:
  - "5.  Operation for PBB-EVPN\n   In PBB-EVPN, the PE advertises a Root or Leaf-Indication\
    \ along with\n   each Backbone MAC (B-MAC) Advertisement route to indicate whether\
    \ the\n   associated B-MAC address corresponds to a Root or a Leaf site.  Just\n\
    \   like the EVPN case, the new E-Tree extended community defined in\n   Section\
    \ 6.1 is advertised with each EVPN MAC/IP Advertisement route.\n   In the case\
    \ where a multihomed ES has both Root and Leaf sites\n   attached, two B-MAC addresses\
    \ are advertised: one B-MAC address is\n   per ES (as specified in [RFC7623])\
    \ and implicitly denotes Root, and\n   the other B-MAC address is per PE and explicitly\
    \ denotes Leaf.  The\n   former B-MAC address is not advertised with the E-Tree\
    \ extended\n   community, but the latter B-MAC denoting Leaf is advertised with\
    \ the\n   new E-Tree extended community where a \"Leaf-indication\" flag is set.\n\
    \   In multihoming scenarios where an ES has both Root and Leaf ACs, it\n   is\
    \ assumed that while different ACs (VLANs) on the same ES could have\n   a different\
    \ Root/Leaf designation (some being Roots and some being\n   Leafs), the same\
    \ VLAN does have the same Root/Leaf designation on all\n   PEs on the same ES.\
    \  Furthermore, it is assumed that there is no\n   forwarding among subnets (i.e.,\
    \ the service is L2 and not IRB).  An\n   IRB use case is outside the scope of\
    \ this document.\n   The ingress PE uses the right B-MAC source address depending\
    \ on\n   whether the Ethernet frame originated from the Root or Leaf AC on\n \
    \  that ES.  The mechanism by which the PE identifies whether a given\n   frame\
    \ originated from a Root or Leaf site on the segment is based on\n   the Ethernet\
    \ Tag associated with the frame.  Other mechanisms of\n   identification, beyond\
    \ the Ethernet Tag, are outside the scope of\n   this document.\n   Furthermore,\
    \ a PE advertises two special global B-MAC addresses, one\n   for Root and another\
    \ for Leaf, and tags the Leaf one as such in the\n   MAC Advertisement route.\
    \  These B-MAC addresses are used as source\n   addresses for traffic originating\
    \ from single-homed segments.  The\n   B-MAC address used for indicating Leaf\
    \ sites can be the same for both\n   single-homed and multihomed segments.\n"
- title: 5.1.  Known Unicast Traffic
  contents:
  - "5.1.  Known Unicast Traffic\n   For known unicast traffic, the PEs perform ingress\
    \ filtering: on the\n   ingress PE, the Customer/Client MAC (C-MAC) [RFC7623]\
    \ destination\n   address lookup yields, in addition to the target B-MAC address\
    \ and\n   forwarding adjacency, a flag that indicates whether the target B-MAC\n\
    \   is associated with a Root or a Leaf site.  The ingress PE also checks\n  \
    \ the status of the originating site; if both are Leafs, then the\n   packet is\
    \ not forwarded.\n"
- title: 5.2.  BUM Traffic
  contents:
  - "5.2.  BUM Traffic\n   For BUM traffic, the PEs must perform egress filtering.\
    \  When a PE\n   receives an EVPN MAC/IP Advertisement route (which will be used\
    \ as a\n   source B-MAC for BUM traffic), it updates its egress filtering (based\n\
    \   on the source B-MAC address) as follows:\n   -  If the EVPN MAC/IP Advertisement\
    \ route indicates that the\n      advertised B-MAC is a Leaf, and the local ES\
    \ is a Leaf as well,\n      then the source B-MAC address is added to its B-MAC\
    \ list used for\n      egress filtering (i.e., to block traffic from that B-MAC\
    \ address).\n      Otherwise, the B-MAC filtering list is not updated.\n   - \
    \ If the EVPN MAC/IP Advertisement route indicates that the\n      advertised\
    \ B-MAC has changed its designation from a Leaf to a\n      Root, and the local\
    \ ES is a Leaf, then the source B-MAC address is\n      removed from the B-MAC\
    \ list corresponding to the local ES used for\n      egress filtering (i.e., to\
    \ unblock traffic from that B-MAC\n      address).\n   When the egress PE receives\
    \ the packet, it examines the B-MAC source\n   address to check whether it should\
    \ filter or forward the frame.  Note\n   that this uses the same filtering logic\
    \ as the split-horizon\n   filtering described in Section 6.2.1.3 of [RFC7623]\
    \ and does not\n   require any additional flags in the data plane.\n   Just as\
    \ in Section 4.2, the PE places all Leaf ESs of a given bridge\n   domain in a\
    \ single split-horizon group in order to prevent intra-PE\n   forwarding among\
    \ Leaf segments.  This split-horizon function applies\n   to BUM traffic as well\
    \ as known unicast traffic.\n"
- title: 5.3.  E-Tree without MAC Learning
  contents:
  - "5.3.  E-Tree without MAC Learning\n   In scenarios where the traffic of interest\
    \ is only multicast and/or\n   broadcast, the PEs implementing an E-Tree service\
    \ do not need to do\n   any MAC learning.  In such scenarios, the filtering must\
    \ be performed\n   on egress PEs.  For PBB-EVPN, the handling of such traffic\
    \ is per\n   Section 5.2 without the need for C-MAC learning (in the data plane)\n\
    \   in the I-component (C-bridge table) of PBB-EVPN PEs (at both ingress\n   and\
    \ egress PEs).\n"
- title: 6.  BGP Encoding
  contents:
  - "6.  BGP Encoding\n   This document defines a new BGP extended community for EVPN.\n"
- title: 6.1.  E-Tree Extended Community
  contents:
  - "6.1.  E-Tree Extended Community\n   This extended community is a new transitive\
    \ extended community\n   [RFC4360] having a Type field value of 0x06 (EVPN) and\
    \ the Sub-Type\n   0x05.  It is used for Leaf-Indication of known unicast and\
    \ BUM\n   traffic.  It indicates that the frame is originated from a Leaf site.\n\
    \   The E-Tree extended community is encoded as an 8-octet value as\n   follows:\n\
    \        0                   1                   2                   3\n     \
    \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       | Type=0x06     | Sub-Type=0x05 | Flags(1 Octet)|  Reserved=0   |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |  Reserved=0   |           Leaf Label                          |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        \
    \            Figure 4: E-Tree Extended Community\n   The Flags field has the following\
    \ format:\n          0 1 2 3 4 5 6 7\n         +-+-+-+-+-+-+-+-+\n         | \
    \    MBZ     |L|     (MBZ = MUST Be Zero)\n         +-+-+-+-+-+-+-+-+\n   This\
    \ document defines the following flags:\n      + Leaf-Indication (L)\n   A value\
    \ of one indicates a Leaf AC/site.  The rest of the flag bits\n   are reserved\
    \ and should be set to zero.\n   When this extended community is advertised along\
    \ with the MAC/IP\n   Advertisement route (for known unicast traffic) per Section\
    \ 4.1, the\n   Leaf-Indication flag MUST be set to one and the Leaf label SHOULD\
    \ be\n   set to zero.  The receiving PE MUST ignore Leaf label and only\n   process\
    \ the Leaf-Indication flag.  A value of zero for the Leaf-\n   Indication flag\
    \ is invalid when sent along with a MAC/IP\n   Advertisement route, and an error\
    \ should be logged.\n   When this extended community is advertised along with\
    \ the EAD-ES\n   route (with an ESI of zero) for BUM traffic to enable egress\n\
    \   filtering on disposition PEs per Sections 4.2.1 and 4.2.3, the Leaf\n   label\
    \ MUST be set to a valid MPLS label (i.e., a non-reserved,\n   assigned MPLS label\
    \ [RFC3032]) and the Leaf-Indication flag SHOULD be\n   set to zero.  The value\
    \ of the 20-bit MPLS label is encoded in the\n   high-order 20 bits of the Leaf\
    \ label field.  The receiving PE MUST\n   ignore the Leaf-Indication flag.  A\
    \ non-valid MPLS label, when sent\n   along with the EAD-ES route, should be ignored\
    \ and logged as an\n   error.\n   The reserved bits SHOULD be set to zero by the\
    \ transmitter and MUST\n   be ignored by the receiver.\n"
- title: 6.2.  PMSI Tunnel Attribute
  contents:
  - "6.2.  PMSI Tunnel Attribute\n   [RFC6514] defines the PMSI Tunnel attribute,\
    \ which is an optional\n   transitive attribute with the following format:\n \
    \              +-------------------------------------------+\n               |\
    \ Flags (1 octet)                           |\n               +-------------------------------------------+\n\
    \               | Tunnel Type (1 octet)                     |\n              \
    \ +-------------------------------------------+\n               | Ingress Replication\
    \ MPLS Label (3 octets) |\n               +-------------------------------------------+\n\
    \               | Tunnel Identifier (variable)              |\n              \
    \ +-------------------------------------------+\n                      Table 1:\
    \ PMSI Tunnel Attribute\n   This document defines a new composite tunnel type\
    \ by introducing a\n   new 'composite tunnel' bit in the Tunnel Type field and\
    \ adding an\n   MPLS label to the Tunnel Identifier field of the PMSI Tunnel\n\
    \   attribute, as detailed below.  All other fields remain as defined in\n   [RFC6514].\
    \  Composite tunnel type is advertised by the Root PE to\n   simultaneously indicate\
    \ a non-Ingress-Replication tunnel (e.g., P2MP\n   tunnel) in the transmit direction\
    \ and an Ingress Replication tunnel\n   in the receive direction for the BUM traffic.\n\
    \   When receiver Ingress Replication labels are needed, the high-order\n   bit\
    \ of the Tunnel Type field (composite tunnel bit) is set while the\n   remaining\
    \ low-order seven bits indicate the Tunnel Type as before\n   (for the existing\
    \ Tunnel Types).  When this composite tunnel bit is\n   set, the \"tunnel identifier\"\
    \ field begins with a three-octet label,\n   followed by the actual tunnel identifier\
    \ for the transmit tunnel.\n   PEs that don't understand the new meaning of the\
    \ high-order bit treat\n   the Tunnel Type as an undefined Tunnel Type and treat\
    \ the PMSI Tunnel\n   attribute as a malformed attribute [RFC6514].  That is why\
    \ the\n   composite tunnel bit is allocated in the Tunnel Type field rather\n\
    \   than the Flags field.  For the PEs that do understand the new meaning\n  \
    \ of the high-order, if Ingress Replication is desired when sending BUM\n   traffic,\
    \ the PE will use the label in the Tunnel Identifier field\n   when sending its\
    \ BUM traffic.\n   Using the composite tunnel bit for Tunnel Types 0x00 'no tunnel\n\
    \   information present' and 0x06 'Ingress Replication' is invalid.  A PE\n  \
    \ that receives a PMSI Tunnel attribute with such information considers\n   it\
    \ malformed, and it SHOULD treat this Update as though all the\n   routes contained\
    \ in this Update had been withdrawn per Section 6 of\n   [RFC6514].\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   Since this document uses the EVPN constructs\
    \ of [RFC7432] and\n   [RFC7623], the same security considerations in these documents\
    \ are\n   also applicable here.  Furthermore, this document provides an\n   additional\
    \ security check by allowing sites (or ACs) of an EVPN\n   instance to be designated\
    \ as a \"Root\" or \"Leaf\" by the network\n   operator / service provider and\
    \ thus prevent any traffic exchange\n   among \"Leaf\" sites of that VPN through\
    \ ingress filtering for known\n   unicast traffic and egress filtering for BUM\
    \ traffic.  Since (by\n   default and for the purpose of backward compatibility)\
    \ an AC that\n   doesn't have a Leaf designation is considered a Root AC, in order\
    \ to\n   avoid any traffic exchange among Leaf ACs, the operator SHOULD\n   configure\
    \ the AC with a proper role (Leaf or Root) before activating\n   the AC.\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   IANA has allocated sub-type value 5 in the \"EVPN\
    \ Extended Community\n   Sub-Types\" registry defined in [RFC7153] as follows:\n\
    \         SUB-TYPE VALUE     NAME                        Reference\n         --------------\
    \     -------------------------   -------------\n         0x05               E-Tree\
    \ Extended Community   This document\n   This document creates a one-octet registry\
    \ called \"E-Tree Flags\".\n   New registrations will be made through the \"RFC\
    \ Required\" procedure\n   defined in [RFC8126].  Initial registrations are as\
    \ follows:\n         Bit               Name                         Reference\n\
    \         ----              --------------               -------------\n     \
    \    0-6               Unassigned\n         7                 Leaf-Indication\
    \              This document\n"
- title: 8.1.  Considerations for PMSI Tunnel Types
  contents:
  - "8.1.  Considerations for PMSI Tunnel Types\n   The \"P-Multicast Service Interface\
    \ (PMSI) Tunnel Types\" registry in\n   the \"Border Gateway Protocol (BGP) Parameters\"\
    \ registry has been\n   updated to reflect the use of the most significant bit\
    \ as the\n   \"composite tunnel\" bit (see Section 6.2).\n   For this purpose,\
    \ this document updates [RFC7385] by changing the\n   previously unassigned values\
    \ (i.e., 0x08 - 0xFA) as follows:\n   Value          Meaning                 \
    \           Reference\n   ---------      -----------------------------      --------------\n\
    \   0x0C-0x7A      Unassigned\n   0x7B-0x7E      Experimental                \
    \       This Document\n   0x7F           Reserved                           This\
    \ Document\n   0x80-0xFA      Reserved for Composite Tunnel      This Document\n\
    \   0xFB-0xFE      Experimental                       [RFC7385]\n   0xFF     \
    \      Reserved                           [RFC7385]\n   The allocation policy\
    \ for values 0x08-0x7A is per IETF Review\n   [RFC8126].  The range for \"Experimental\"\
    \ has been expanded to include\n   the previously assigned range of 0xFB-0xFE\
    \ and the new range of\n   0x7B-0x7E.  The values in these ranges are not to be\
    \ assigned.  The\n   value 0x7F, which is the mirror image of (0xFF), is reserved\
    \ in this\n   document.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [MEF6.1]   MEF Forum, \"Ethernet Services Definitions\
    \ - Phase 2\",\n              MEF 6.1, April 2008, <https://mef.net/PDF_Documents/\n\
    \              technical-specifications/MEF6-1.pdf>.\n   [RFC2119]  Bradner, S.,\
    \ \"Key words for use in RFCs to Indicate\n              Requirement Levels\"\
    , BCP 14, RFC 2119,\n              DOI 10.17487/RFC2119, March 1997,\n       \
    \       <https://www.rfc-editor.org/info/rfc2119>.\n   [RFC4360]  Sangli, S.,\
    \ Tappan, D., and Y. Rekhter, \"BGP Extended\n              Communities Attribute\"\
    , RFC 4360, DOI 10.17487/RFC4360,\n              February 2006, <https://www.rfc-editor.org/info/rfc4360>.\n\
    \   [RFC6514]  Aggarwal, R., Rosen, E., Morin, T., and Y. Rekhter, \"BGP\n   \
    \           Encodings and Procedures for Multicast in MPLS/BGP IP\n          \
    \    VPNs\", RFC 6514, DOI 10.17487/RFC6514, February 2012,\n              <https://www.rfc-editor.org/info/rfc6514>.\n\
    \   [RFC7153]  Rosen, E. and Y. Rekhter, \"IANA Registries for BGP\n         \
    \     Extended Communities\", RFC 7153, DOI 10.17487/RFC7153,\n              March\
    \ 2014, <https://www.rfc-editor.org/info/rfc7153>.\n   [RFC7385]  Andersson, L.\
    \ and G. Swallow, \"IANA Registry for\n              P-Multicast Service Interface\
    \ (PMSI) Tunnel Type Code\n              Points\", RFC 7385, DOI 10.17487/RFC7385,\
    \ October 2014,\n              <https://www.rfc-editor.org/info/rfc7385>.\n  \
    \ [RFC7387]  Key, R., Ed., Yong, L., Ed., Delord, S., Jounay, F., and\n      \
    \        L. Jin, \"A Framework for Ethernet Tree (E-Tree) Service\n          \
    \    over a Multiprotocol Label Switching (MPLS) Network\",\n              RFC\
    \ 7387, DOI 10.17487/RFC7387, October 2014,\n              <https://www.rfc-editor.org/info/rfc7387>.\n\
    \   [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N., Isaac, A.,\n       \
    \       Uttaro, J., Drake, J., and W. Henderickx, \"BGP MPLS-Based\n         \
    \     Ethernet VPN\", RFC 7432, DOI 10.17487/RFC7432, February\n             \
    \ 2015, <https://www.rfc-editor.org/info/rfc7432>.\n   [RFC7623]  Sajassi, A.,\
    \ Ed., Salam, S., Bitar, N., Isaac, A., and W.\n              Henderickx, \"Provider\
    \ Backbone Bridging Combined with\n              Ethernet VPN (PBB-EVPN)\", RFC\
    \ 7623, DOI 10.17487/RFC7623,\n              September 2015, <https://www.rfc-editor.org/info/rfc7623>.\n\
    \   [RFC8126]  Cotton, M., Leiba, B., and T. Narten, \"Guidelines for\n      \
    \        Writing an IANA Considerations Section in RFCs\", BCP 26,\n         \
    \     RFC 8126, DOI 10.17487/RFC8126, June 2017,\n              <https://www.rfc-editor.org/info/rfc8126>.\n\
    \   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC\n     \
    \         2119 Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,\n        \
    \      May 2017, <https://www.rfc-editor.org/info/rfc8174>.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [EVPN-INTEGRATED]\n              Sajassi, A.,\
    \ Salam, S., Thoria, S., Drake, J., Rabadan,\n              J., and L. Yong, \"\
    Integrated Routing and Bridging in\n              EVPN\", Work in Progress, draft-ietf-bess-evpn-inter-\n\
    \              subnet-forwarding-03, February 2017.\n   [IEEE.802.1ah]\n     \
    \         IEEE, \"IEEE Standard for Local and metropolitan area\n            \
    \  networks - Media Access Control (MAC) Bridges and Virtual\n              Bridged\
    \ Local Area Networks\", Clauses 25 and 26, IEEE\n              Std 802.1Q, DOI\
    \ 10.1109/IEEESTD.2011.6009146.\n   [IEEE.802.1Q]\n              IEEE, \"IEEE\
    \ Standard for Local and metropolitan area\n              networks - Bridges and\
    \ Bridged Networks - Media Access\n              Control (MAC) Bridges and Virtual\
    \ Bridged Local Area\n              Networks\", IEEE Std 802.1Q,\n           \
    \   DOI 10.1109/IEEESTD.2011.6009146.\n   [RFC3032]  Rosen, E., Tappan, D., Fedorkow,\
    \ G., Rekhter, Y.,\n              Farinacci, D., Li, T., and A. Conta, \"MPLS\
    \ Label Stack\n              Encoding\", RFC 3032, DOI 10.17487/RFC3032, January\
    \ 2001,\n              <https://www.rfc-editor.org/info/rfc3032>.\n   [RFC7796]\
    \  Jiang, Y., Ed., Yong, L., and M. Paul, \"Ethernet-Tree\n              (E-Tree)\
    \ Support in Virtual Private LAN Service (VPLS)\",\n              RFC 7796, DOI\
    \ 10.17487/RFC7796, March 2016,\n              <https://www.rfc-editor.org/info/rfc7796>.\n"
- title: Appendix A.  Multiple Bridge Tables per E-Tree Service Instance
  contents:
  - "Appendix A.  Multiple Bridge Tables per E-Tree Service Instance\n   When two\
    \ MAC-VRFs (two bridge tables per VLAN) are used for an E-Tree\n   service (one\
    \ for Root ACs and another for Leaf ACs) on a given PE,\n   then the following\
    \ complications in a data-plane path can result.\n   Maintaining two MAC-VRFs\
    \ (two bridge tables) per VLAN (when both Leaf\n   and Root ACs exists for that\
    \ VLAN) would require either that two\n   lookups be performed per MAC address\
    \ in each direction in case of a\n   miss or that the duplication of many MAC\
    \ addresses between the two\n   bridge tables belonging to the same VLAN (same\
    \ E-Tree instance) be\n   made.  Unless two lookups are made, duplication of MAC\
    \ addresses\n   would be needed for both locally learned and remotely learned\
    \ MAC\n   addresses.  Locally learned MAC addresses from Leaf ACs need to be\n\
    \   duplicated onto a Root bridge table, and locally learned MAC\n   addresses\
    \ from Root ACs need to be duplicated onto a Leaf bridge\n   table.  Remotely\
    \ learned MAC addresses from Root ACs need to be\n   copied onto both Root and\
    \ Leaf bridge tables.  Because of potential\n   inefficiencies associated with\
    \ data-plane implementation of\n   additional MAC lookup or duplication of MAC\
    \ entries, this option is\n   not believed to be implementable without data-plane\
    \ performance\n   inefficiencies in some platforms; thus, this document introduces\
    \ the\n   coloring as described in Section 3.2 and detailed in Section 4.1.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   We would like to thank Eric Rosen, Jeffrey Zhang, Wen Lin,\
    \ Aldrin\n   Issac, Wim Henderickx, Dennis Cai, and Antoni Przygienda for their\n\
    \   valuable comments and contributions.  The authors would also like to\n   thank\
    \ Thomas Morin for shepherding this document and providing\n   valuable comments.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ali Sajassi (editor)\n   Cisco\n   Email: sajassi@cisco.com\n\
    \   Samer Salam\n   Cisco\n   Email: ssalam@cisco.com\n   John Drake\n   Juniper\n\
    \   Email: jdrake@juniper.net\n   Jim Uttaro\n   AT&T\n   Email: ju1738@att.com\n\
    \   Sami Boutros\n   VMware\n   Email: sboutros@vmware.com\n   Jorge Rabadan\n\
    \   Nokia\n   Email: jorge.rabadan@nokia.com\n"
