- title: __initial_text__
  contents:
  - "  Cleartext Considered Obsolete: Use of Transport Layer Security (TLS)\n    \
    \                for Email Submission and Access\n"
- title: Abstract
  contents:
  - "Abstract\n   This specification outlines current recommendations for the use\
    \ of\n   Transport Layer Security (TLS) to provide confidentiality of email\n\
    \   traffic between a Mail User Agent (MUA) and a Mail Submission Server\n   or\
    \ Mail Access Server.  This document updates RFCs 1939, 2595, 3501,\n   5068,\
    \ 6186, and 6409.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8314.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2018 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. How This Document Updates Previous RFCs ....................3\n  \
    \ 2. Conventions and Terminology Used in This Document ...............4\n   3.\
    \ Implicit TLS ....................................................5\n      3.1.\
    \ Implicit TLS for POP .......................................5\n      3.2. Implicit\
    \ TLS for IMAP ......................................5\n      3.3. Implicit TLS\
    \ for SMTP Submission ...........................6\n      3.4. Implicit TLS Connection\
    \ Closure for POP, IMAP, and\n           SMTP Submission ............................................7\n\
    \   4. Use of TLS by Mail Access Servers and Message Submission\n      Servers\
    \ .........................................................7\n      4.1. Deprecation\
    \ of Services Using Cleartext and TLS Versions\n           Less Than 1.1 ..............................................8\n\
    \      4.2. Mail Server Use of Client Certificate Authentication .......9\n  \
    \    4.3. Recording TLS Ciphersuite in \"Received\" Header Field .......9\n  \
    \    4.4. TLS Server Certificate Requirements .......................10\n    \
    \  4.5. Recommended DNS Records for Mail Protocol Servers .........11\n      \
    \     4.5.1. MX Records .........................................11\n        \
    \   4.5.2. SRV Records ........................................11\n          \
    \ 4.5.3. DNSSEC .............................................11\n           4.5.4.\
    \ TLSA Records .......................................11\n      4.6. Changes to\
    \ Internet-Facing Servers ........................11\n   5. Use of TLS by Mail\
    \ User Agents .................................12\n      5.1. Use of SRV Records\
    \ in Establishing Configuration ..........13\n      5.2. Minimum Confidentiality\
    \ Level .............................14\n      5.3. Certificate Validation ....................................15\n\
    \      5.4. Certificate Pinning .......................................15\n  \
    \    5.5. Client Certificate Authentication .........................16\n   6.\
    \ Considerations Related to Antivirus/Antispam Software\n      and Services ...................................................17\n\
    \   7. IANA Considerations ............................................17\n  \
    \    7.1. POP3S Port Registration Update ............................17\n    \
    \  7.2. IMAPS Port Registration Update ............................18\n      7.3.\
    \ Submissions Port Registration .............................18\n      7.4. Additional\
    \ Registered Clauses for \"Received\" Fields .......19\n   8. Security Considerations\
    \ ........................................19\n   9. References .....................................................20\n\
    \      9.1. Normative References ......................................20\n  \
    \    9.2. Informative References ....................................22\n   Appendix\
    \ A. Design Considerations .................................24\n   Acknowledgements\
    \ ..................................................26\n   Authors' Addresses\
    \ ................................................26\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Software that provides email service via the Internet Message\
    \ Access\n   Protocol (IMAP) [RFC3501], the Post Office Protocol (POP) [RFC1939],\n\
    \   and/or Simple Mail Transfer Protocol (SMTP) Submission [RFC6409]\n   usually\
    \ has Transport Layer Security (TLS) [RFC5246] support but\n   often does not\
    \ use it in a way that maximizes end-user\n   confidentiality.  This specification\
    \ describes current\n   recommendations for the use of TLS in interactions between\
    \ Mail User\n   Agents (MUAs) and Mail Access Servers, and also between MUAs and\
    \ Mail\n   Submission Servers.\n   In brief, this memo now recommends that:\n\
    \   o  TLS version 1.2 or greater be used for all traffic between MUAs\n     \
    \ and Mail Submission Servers, and also between MUAs and Mail Access\n      Servers.\n\
    \   o  MUAs and Mail Service Providers (MSPs) (a) discourage the use of\n    \
    \  cleartext protocols for mail access and mail submission and\n      (b) deprecate\
    \ the use of cleartext protocols for these purposes as\n      soon as practicable.\n\
    \   o  Connections to Mail Submission Servers and Mail Access Servers be\n   \
    \   made using \"Implicit TLS\" (as defined below), in preference to\n      connecting\
    \ to the \"cleartext\" port and negotiating TLS using the\n      STARTTLS command\
    \ or a similar command.\n   This memo does not address the use of TLS with SMTP\
    \ for message relay\n   (where Message Submission [RFC6409] does not apply). \
    \ Improving the\n   use of TLS with SMTP for message relay requires a different\
    \ approach.\n   One approach to address that topic is described in [RFC7672];\
    \ another\n   is provided in [MTA-STS].\n   The recommendations in this memo do\
    \ not replace the functionality of,\n   and are not intended as a substitute for,\
    \ end-to-end encryption of\n   electronic mail.\n"
- title: 1.1.  How This Document Updates Previous RFCs
  contents:
  - "1.1.  How This Document Updates Previous RFCs\n   This document updates POP (RFC\
    \ 1939), IMAP (RFC 3501), and Submission\n   (RFC 6409, RFC 5068) in two ways:\n\
    \   1.  By adding Implicit TLS ports as Standards Track ports for these\n    \
    \   protocols as described in Section 3.\n   2.  By updating TLS best practices\
    \ that apply to these protocols as\n       described in Sections 4 and 5.\n  \
    \ This document updates RFC 2595 by replacing Section 7 of RFC 2595\n   with the\
    \ preference for Implicit TLS as described in Sections 1 and 3\n   of this document,\
    \ as well as by updating TLS best practices that\n   apply to the protocols in\
    \ RFC 2595 as described in Sections 4 and 5\n   of this document.\n   This document\
    \ updates RFC 6186 as described herein, in Section 5.1.\n"
- title: 2.  Conventions and Terminology Used in This Document
  contents:
  - "2.  Conventions and Terminology Used in This Document\n   The key words \"MUST\"\
    , \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD\
    \ NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in\
    \ this document are to be interpreted as described in\n   BCP 14 [RFC2119] [RFC8174]\
    \ when, and only when, they appear in all\n   capitals, as shown here.\n   The\
    \ term \"Implicit TLS\" refers to the automatic negotiation of TLS\n   whenever\
    \ a TCP connection is made on a particular TCP port that is\n   used exclusively\
    \ by that server for TLS connections.  The term\n   \"Implicit TLS\" is intended\
    \ to contrast with the use of STARTTLS and\n   similar commands in POP, IMAP,\
    \ SMTP Message Submission, and other\n   protocols, that are used by the client\
    \ and the server to explicitly\n   negotiate TLS on an established cleartext TCP\
    \ connection.\n   The term \"Mail Access Server\" refers to a server for POP,\
    \ IMAP, and\n   any other protocol used to access or modify received messages,\
    \ or to\n   access or modify a mail user's account configuration.\n   The term\
    \ \"Mail Submission Server\" refers to a server for the protocol\n   specified\
    \ in [RFC6409] (or one of its predecessors or successors) for\n   submission of\
    \ outgoing messages for delivery to recipients.\n   The term \"Mail Service Provider\"\
    \ (or \"MSP\") refers to an operator of\n   Mail Access Servers and/or Mail Submission\
    \ Servers.\n   The term \"Mail Account\" refers to a user's identity with an MSP,\
    \ that\n   user's authentication credentials, any user email that is stored by\n\
    \   the MSP, and any other per-user configuration information maintained\n   by\
    \ the MSP (for example, instructions for filtering spam).  Most MUAs\n   support\
    \ the ability to access multiple Mail Accounts.\n   For each account that an MUA\
    \ accesses on its user's behalf, it must\n   have the server names, ports, authentication\
    \ credentials, and other\n   configuration information specified by the user.\
    \  This information,\n   which is used by the MUA, is referred to as \"Mail Account\n\
    \   Configuration\".\n   This specification expresses syntax using the Augmented\
    \ Backus-Naur\n   Form (ABNF) as described in [RFC5234], including the core rules\n\
    \   provided in Appendix B of [RFC5234] and the rules provided in\n   [RFC5322].\n"
- title: 3.  Implicit TLS
  contents:
  - "3.  Implicit TLS\n   Previous standards for the use of email protocols with TLS\
    \ used the\n   STARTTLS mechanism: [RFC2595], [RFC3207], and [RFC3501].  With\n\
    \   STARTTLS, the client establishes a cleartext application session and\n   determines\
    \ whether to issue a STARTTLS command based on server\n   capabilities and client\
    \ configuration.  If the client issues a\n   STARTTLS command, a TLS handshake\
    \ follows that can upgrade the\n   connection.  Although this mechanism has been\
    \ deployed, an alternate\n   mechanism where TLS is negotiated immediately at\
    \ connection start on\n   a separate port (referred to in this document as \"\
    Implicit TLS\") has\n   been deployed more successfully.  To encourage more widespread\
    \ use of\n   TLS and to also encourage greater consistency regarding how TLS is\n\
    \   used, this specification now recommends the use of Implicit TLS for\n   POP,\
    \ IMAP, SMTP Submission, and all other protocols used between an\n   MUA and an\
    \ MSP.\n"
- title: 3.1.  Implicit TLS for POP
  contents:
  - "3.1.  Implicit TLS for POP\n   When a TCP connection is established for the \"\
    pop3s\" service (default\n   port 995), a TLS handshake begins immediately.  Clients\
    \ MUST\n   implement the certificate validation mechanism described in\n   [RFC7817].\
    \  Once the TLS session is established, POP3 [RFC1939]\n   protocol messages are\
    \ exchanged as TLS application data for the\n   remainder of the TCP connection.\
    \  After the server sends an +OK\n   greeting, the server and client MUST enter\
    \ the AUTHORIZATION state,\n   even if a client certificate was supplied during\
    \ the TLS handshake.\n   See Sections 5.5 and 4.2 for additional information on\
    \ client\n   certificate authentication.  See Section 7.1 for port registration\n\
    \   information.\n"
- title: 3.2.  Implicit TLS for IMAP
  contents:
  - "3.2.  Implicit TLS for IMAP\n   When a TCP connection is established for the\
    \ \"imaps\" service (default\n   port 993), a TLS handshake begins immediately.\
    \  Clients MUST\n   implement the certificate validation mechanism described in\n\
    \   [RFC7817].  Once the TLS session is established, IMAP [RFC3501]\n   protocol\
    \ messages are exchanged as TLS application data for the\n   remainder of the\
    \ TCP connection.  If a client certificate was\n   provided during the TLS handshake\
    \ that the server finds acceptable,\n   the server MAY issue a PREAUTH greeting,\
    \ in which case both the\n   server and the client enter the AUTHENTICATED state.\
    \  If the server\n   issues an OK greeting, then both the server and the client\
    \ enter the\n   NOT AUTHENTICATED state.\n   See Sections 5.5 and 4.2 for additional\
    \ information on client\n   certificate authentication.  See Section 7.2 for port\
    \ registration\n   information.\n"
- title: 3.3.  Implicit TLS for SMTP Submission
  contents:
  - "3.3.  Implicit TLS for SMTP Submission\n   When a TCP connection is established\
    \ for the \"submissions\" service\n   (default port 465), a TLS handshake begins\
    \ immediately.  Clients MUST\n   implement the certificate validation mechanism\
    \ described in\n   [RFC7817].  Once the TLS session is established, Message Submission\n\
    \   protocol data [RFC6409] is exchanged as TLS application data for the\n   remainder\
    \ of the TCP connection.  (Note: The \"submissions\" service\n   name is defined\
    \ in Section 7.3 of this document and follows the usual\n   convention that the\
    \ name of a service layered on top of Implicit TLS\n   consists of the name of\
    \ the service as used without TLS, with an \"s\"\n   appended.)\n   The STARTTLS\
    \ mechanism on port 587 is relatively widely deployed due\n   to the situation\
    \ with port 465 (discussed in Section 7.3).  This\n   differs from IMAP and POP\
    \ services where Implicit TLS is more widely\n   deployed on servers than STARTTLS.\
    \  It is desirable to migrate core\n   protocols used by MUA software to Implicit\
    \ TLS over time, for\n   consistency as well as for the additional reasons discussed\
    \ in\n   Appendix A.  However, to maximize the use of encryption for\n   submission,\
    \ it is desirable to support both mechanisms for Message\n   Submission over TLS\
    \ for a transition period of several years.  As a\n   result, clients and servers\
    \ SHOULD implement both STARTTLS on\n   port 587 and Implicit TLS on port 465\
    \ for this transition period.\n   Note that there is no significant difference\
    \ between the security\n   properties of STARTTLS on port 587 and Implicit TLS\
    \ on port 465 if\n   the implementations are correct and if both the client and\
    \ the server\n   are configured to require successful negotiation of TLS prior\
    \ to\n   Message Submission.\n   Note that the \"submissions\" port provides access\
    \ to a Message\n   Submission Agent (MSA) as defined in [RFC6409], so requirements\
    \ and\n   recommendations for MSAs in that document, including the requirement\n\
    \   to implement SMTP AUTH [RFC4954] and the requirements of Email\n   Submission\
    \ Operations [RFC5068], also apply to the submissions port.\n   See Sections 5.5\
    \ and 4.2 for additional information on client\n   certificate authentication.\
    \  See Section 7.3 for port registration\n   information.\n"
- title: 3.4.  Implicit TLS Connection Closure for POP, IMAP, and SMTP Submission
  contents:
  - "3.4.  Implicit TLS Connection Closure for POP, IMAP, and SMTP Submission\n  \
    \ When a client or server wishes to close the connection, it SHOULD\n   initiate\
    \ the exchange of TLS close alerts before TCP connection\n   termination.  The\
    \ client MAY, after sending a TLS close alert,\n   gracefully close the TCP connection\
    \ (e.g., call the close() function\n   on the TCP socket or otherwise issue a\
    \ TCP CLOSE ([RFC793],\n   Section 3.5)) without waiting for a TLS response from\
    \ the server.\n"
- title: 4.  Use of TLS by Mail Access Servers and Message Submission Servers
  contents:
  - "4.  Use of TLS by Mail Access Servers and Message Submission Servers\n   The\
    \ following requirements and recommendations apply to Mail Access\n   Servers\
    \ and Mail Submission Servers, or, if indicated, to MSPs:\n   o  MSPs that support\
    \ POP, IMAP, and/or Message Submission MUST\n      support TLS access for those\
    \ protocol servers.\n   o  Servers provided by MSPs other than POP, IMAP, and/or\
    \ Message\n      Submission SHOULD support TLS access and MUST support TLS access\n\
    \      for those servers that support authentication via username and\n      password.\n\
    \   o  MSPs that support POP, IMAP, and/or Message Submission SHOULD\n      provide\
    \ and support instances of those services that use Implicit\n      TLS.  (See\
    \ Section 3.)\n   o  For compatibility with existing MUAs and existing MUA\n \
    \     configurations, MSPs SHOULD also, in the near term, provide\n      instances\
    \ of these services that support STARTTLS.  This will\n      permit legacy MUAs\
    \ to discover new availability of TLS capability\n      on servers and may increase\
    \ the use of TLS by such MUAs.  However,\n      servers SHOULD NOT advertise STARTTLS\
    \ if the use of the STARTTLS\n      command by a client is likely to fail (for\
    \ example, if the server\n      has no server certificate configured).\n   o \
    \ MSPs SHOULD advertise their Mail Access Servers and Mail\n      Submission Servers,\
    \ using DNS SRV records according to [RFC6186].\n      (In addition to making\
    \ correct configuration easier for MUAs, this\n      provides a way by which MUAs\
    \ can discover when an MSP begins to\n      offer TLS-based services.)  Servers\
    \ supporting TLS SHOULD be\n      advertised in preference to cleartext servers\
    \ (if offered).  In\n      addition, servers using Implicit TLS SHOULD be advertised\
    \ in\n      preference to servers supporting STARTTLS (if offered).  (See also\n\
    \      Section 4.5.)\n   o  MSPs SHOULD deprecate the use of cleartext Mail Access\
    \ Servers and\n      Mail Submission Servers as soon as practicable.  (See\n \
    \     Section 4.1.)\n   o  MSPs currently supporting such use of cleartext SMTP\
    \ (on port 25)\n      as a means of Message Submission by their users (whether\
    \ or not\n      requiring authentication) SHOULD transition their users to using\n\
    \      TLS (either Implicit TLS or STARTTLS) as soon as practicable.\n   o  Mail\
    \ Access Servers and Mail Submission Servers MUST support\n      TLS 1.2 or later.\n\
    \   o  All Mail Access Servers and Mail Submission Servers SHOULD\n      implement\
    \ the recommended TLS ciphersuites described in [RFC7525]\n      or a future BCP\
    \ or Standards Track revision of that document.\n   o  As soon as practicable,\
    \ MSPs currently supporting Secure Sockets\n      Layer (SSL) 2.x, SSL 3.0, or\
    \ TLS 1.0 SHOULD transition their users\n      to TLS 1.1 or later and discontinue\
    \ support for those earlier\n      versions of SSL and TLS.\n   o  Mail Submission\
    \ Servers accepting mail using TLS SHOULD include in\n      the Received field\
    \ of the outgoing message the TLS ciphersuite of\n      the session in which the\
    \ mail was received.  (See Section 4.3.)\n   o  All Mail Access Servers and Mail\
    \ Submission Servers implementing\n      TLS SHOULD log TLS cipher information\
    \ along with any connection or\n      authentication logs that they maintain.\n\
    \   Additional considerations and details appear below.\n"
- title: 4.1.  Deprecation of Services Using Cleartext and TLS Versions
  contents:
  - "4.1.  Deprecation of Services Using Cleartext and TLS Versions\n      Less Than\
    \ 1.1\n   The specific means employed for deprecation of cleartext Mail Access\n\
    \   Servers and Mail Submission Servers MAY vary from one MSP to the next\n  \
    \ in light of their user communities' needs and constraints.  For\n   example,\
    \ an MSP MAY implement a gradual transition in which, over\n   time, more and\
    \ more users are forbidden to authenticate to cleartext\n   instances of these\
    \ servers, thus encouraging those users to migrate\n   to Implicit TLS.  Access\
    \ to cleartext servers should eventually be\n   either (a) disabled or (b) limited\
    \ strictly for use by legacy systems\n   that cannot be upgraded.\n   After a\
    \ user's ability to authenticate to a server using cleartext is\n   revoked, the\
    \ server denying such access MUST NOT provide any\n   indication over a cleartext\
    \ channel of whether the user's\n   authentication credentials were valid.  An\
    \ attempt to authenticate as\n   such a user using either invalid credentials\
    \ or valid credentials\n   MUST both result in the same indication of access being\
    \ denied.\n   Also, users previously authenticating with passwords sent as\n \
    \  cleartext SHOULD be required to change those passwords when migrating\n   to\
    \ TLS, if the old passwords were likely to have been compromised.\n   (For any\
    \ large community of users using the public Internet to access\n   mail without\
    \ encryption, the compromise of at least some of those\n   passwords should be\
    \ assumed.)\n   Transition of users from SSL or TLS 1.0 to later versions of TLS\
    \ MAY\n   be accomplished by a means similar to that described above.  There\n\
    \   are multiple ways to accomplish this.  One way is for the server to\n   refuse\
    \ a ClientHello message from any client sending a\n   ClientHello.version field\
    \ corresponding to any version of SSL or\n   TLS 1.0.  Another way is for the\
    \ server to accept ClientHello\n   messages from some client versions that it\
    \ does not wish to support\n   but later refuse to allow the user to authenticate.\
    \  The latter\n   method may provide a better indication to the user of the reason\
    \ for\n   the failure but (depending on the protocol and method of\n   authentication\
    \ used) may also risk exposure of the user's password\n   over a channel that\
    \ is known to not provide adequate confidentiality.\n   It is RECOMMENDED that\
    \ new users be required to use TLS version 1.1\n   or greater from the start.\
    \  However, an MSP may find it necessary to\n   make exceptions to accommodate\
    \ some legacy systems that support only\n   earlier versions of TLS or only cleartext.\n"
- title: 4.2.  Mail Server Use of Client Certificate Authentication
  contents:
  - "4.2.  Mail Server Use of Client Certificate Authentication\n   Mail Submission\
    \ Servers and Mail Access Servers MAY implement client\n   certificate authentication\
    \ on the Implicit TLS port.  Such servers\n   MUST NOT request a client certificate\
    \ during the TLS handshake unless\n   the server is configured to accept some\
    \ client certificates as\n   sufficient for authentication and the server has\
    \ the ability to\n   determine a mail server authorization identity matching such\n\
    \   certificates.  How to make this determination is presently\n   implementation\
    \ specific.\n   If the server accepts the client's certificate as sufficient for\n\
    \   authorization, it MUST enable the Simple Authentication and Security\n   Layer\
    \ (SASL) EXTERNAL mechanism [RFC4422].  An IMAPS server MAY issue\n   a PREAUTH\
    \ greeting instead of enabling SASL EXTERNAL.\n"
- title: 4.3.  Recording TLS Ciphersuite in "Received" Header Field
  contents:
  - "4.3.  Recording TLS Ciphersuite in \"Received\" Header Field\n   The ESMTPS transmission\
    \ type [RFC3848] provides trace information\n   that can indicate that TLS was\
    \ used when transferring mail.  However,\n   TLS usage by itself is not a guarantee\
    \ of confidentiality or\n   security.  The TLS ciphersuite provides additional\
    \ information about\n   the level of security made available for a connection.\
    \  This section\n   defines a new SMTP \"tls\" Received header additional-registered-clause\n\
    \   that is used to record the TLS ciphersuite that was negotiated for\n   the\
    \ connection.  This clause SHOULD be included whenever a Submission\n   server\
    \ generates a Received header field for a message received via\n   TLS.  The value\
    \ included in this additional clause SHOULD be the\n   registered ciphersuite\
    \ name (e.g.,\n   TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) included in the \"TLS\
    \ Cipher\n   Suite Registry\".  In the event that the implementation does not\
    \ know\n   the name of the ciphersuite (a situation that should be remedied\n\
    \   promptly), a four-digit hexadecimal ciphersuite identifier MAY be\n   used.\
    \  In addition, the Diffie-Hellman group name associated with the\n   ciphersuite\
    \ MAY be included (when applicable and known) following the\n   ciphersuite name.\
    \  The ABNF for the field follows:\n   tls-cipher-clause  =  CFWS \"tls\" FWS\
    \ tls-cipher\n                         [ CFWS tls-dh-group-clause ]\n   tls-cipher\
    \         =  tls-cipher-name / tls-cipher-hex\n   tls-cipher-name    =  ALPHA\
    \ *(ALPHA / DIGIT / \"_\")\n   ; as registered in the IANA \"TLS Cipher Suite\
    \ Registry\"\n   ; <https://www.iana.org/assignments/tls-parameters>\n   tls-cipher-hex\
    \     =  \"0x\" 4HEXDIG\n   tls-dh-group-clause = \"group\" FWS dh-group\n   ;\
    \ not to be used except immediately after tls-cipher\n   dh-group           =\
    \ ALPHA *(ALPHA / DIGIT / \"_\" / \"-\")\n   ; as registered in the IANA \"TLS\
    \ Supported Groups Registry\"\n   ; <https://www.iana.org/assignments/tls-parameters>\n"
- title: 4.4.  TLS Server Certificate Requirements
  contents:
  - "4.4.  TLS Server Certificate Requirements\n   MSPs MUST maintain valid server\
    \ certificates for all servers.  See\n   [RFC7817] for the recommendations and\
    \ requirements necessary to\n   achieve this.\n   If a protocol server provides\
    \ service for more than one mail domain,\n   it MAY use a separate IP address\
    \ for each domain and/or a server\n   certificate that advertises multiple domains.\
    \  This will generally be\n   necessary unless and until it is acceptable to impose\
    \ the constraint\n   that the server and all clients support the Server Name Indication\n\
    \   (SNI) extension to TLS [RFC6066].  Mail servers supporting the SNI\n   need\
    \ to support the post-SRV hostname to interoperate with MUAs that\n   have not\
    \ implemented [RFC6186].  For more discussion of this problem,\n   see Section\
    \ 5.1 of [RFC7817].\n"
- title: 4.5.  Recommended DNS Records for Mail Protocol Servers
  contents:
  - "4.5.  Recommended DNS Records for Mail Protocol Servers\n   This section discusses\
    \ not only the DNS records that are recommended\n   but also implications of DNS\
    \ records for server configuration and TLS\n   server certificates.\n"
- title: 4.5.1.  MX Records
  contents:
  - "4.5.1.  MX Records\n   It is recommended that MSPs advertise MX records for the\
    \ handling of\n   inbound mail (instead of relying entirely on A or AAAA records)\
    \ and\n   that those MX records be signed using DNSSEC [RFC4033].  This is\n \
    \  mentioned here only for completeness, as the handling of inbound mail\n   is\
    \ out of scope for this document.\n"
- title: 4.5.2.  SRV Records
  contents:
  - "4.5.2.  SRV Records\n   MSPs SHOULD advertise SRV records to aid MUAs in determining\
    \ the\n   proper configuration of servers, per the instructions in [RFC6186].\n\
    \   MSPs SHOULD advertise servers that support Implicit TLS in preference\n  \
    \ to servers that support cleartext and/or STARTTLS operation.\n"
- title: 4.5.3.  DNSSEC
  contents:
  - "4.5.3.  DNSSEC\n   All DNS records advertised by an MSP as a means of aiding\
    \ clients in\n   communicating with the MSP's servers SHOULD be signed using DNSSEC\
    \ if\n   and when the parent DNS zone supports doing so.\n"
- title: 4.5.4.  TLSA Records
  contents:
  - "4.5.4.  TLSA Records\n   MSPs SHOULD advertise TLSA records to provide an additional\
    \ trust\n   anchor for public keys used in TLS server certificates.  However,\n\
    \   TLSA records MUST NOT be advertised unless they are signed using\n   DNSSEC.\n"
- title: 4.6.  Changes to Internet-Facing Servers
  contents:
  - "4.6.  Changes to Internet-Facing Servers\n   When an MSP changes the Internet-facing\
    \ Mail Access Servers and Mail\n   Submission Servers, including SMTP-based spam/virus\
    \ filters, it is\n   generally necessary to support the same and/or a newer version\
    \ of TLS\n   than the one previously used.\n"
- title: 5.  Use of TLS by Mail User Agents
  contents:
  - "5.  Use of TLS by Mail User Agents\n   The following requirements and recommendations\
    \ apply to MUAs:\n   o  MUAs SHOULD be capable of using DNS SRV records to discover\
    \ Mail\n      Access Servers and Mail Submission Servers that are advertised by\n\
    \      an MSP for an account being configured.  Other means of\n      discovering\
    \ server configuration information (e.g., a database\n      maintained by the\
    \ MUA vendor) MAY also be supported.  (See\n      Section 5.1 for more information.)\n\
    \   o  MUAs SHOULD be configurable to require a minimum level of\n      confidentiality\
    \ for any particular Mail Account and refuse to\n      exchange information via\
    \ any service associated with that Mail\n      Account if the session does not\
    \ provide that minimum level of\n      confidentiality.  (See Section 5.2.)\n\
    \   o  MUAs MUST NOT treat a session as meeting a minimum level of\n      confidentiality\
    \ if the server's TLS certificate cannot be\n      validated.  (See Section 5.3.)\n\
    \   o  MUAs MAY impose other minimum confidentiality requirements in the\n   \
    \   future, e.g., in order to discourage the use of TLS versions or\n      cryptographic\
    \ algorithms in which weaknesses have been discovered.\n   o  MUAs SHOULD provide\
    \ a prominent indication of the level of\n      confidentiality associated with\
    \ an account configuration that is\n      appropriate for the user interface (for\
    \ example, a \"lock\" icon or\n      changed background color for a visual interface,\
    \ or some sort of\n      audible indication for an audio user interface), at appropriate\n\
    \      times and/or locations, in order to inform the user of the\n      confidentiality\
    \ of the communications associated with that\n      account.  For example, this\
    \ might be done whenever (a) the user is\n      prompted for authentication credentials,\
    \ (b) the user is composing\n      mail that will be sent to a particular submission\
    \ server, (c) a\n      list of accounts is displayed (particularly if the user\
    \ can select\n      from that list to read mail), or (d) the user is asking to\
    \ view or\n      update any configuration data that will be stored on a remote\n\
    \      server.  If, however, an MUA provides such an indication, it\n      MUST\
    \ NOT indicate confidentiality for any connection that does not\n      at least\
    \ use TLS 1.1 with certificate verification and also meet\n      the minimum confidentiality\
    \ requirements associated with that\n      account.\n   o  MUAs MUST implement\
    \ TLS 1.2 [RFC5246] or later.  Earlier TLS and\n      SSL versions MAY also be\
    \ supported, so long as the MUA requires at\n      least TLS 1.1 [RFC4346] when\
    \ accessing accounts that are\n      configured to impose minimum confidentiality\
    \ requirements.\n   o  All MUAs SHOULD implement the recommended TLS ciphersuites\n\
    \      described in [RFC7525] or a future BCP or Standards Track revision\n  \
    \    of that document.\n   o  MUAs that are configured to not require minimum\
    \ confidentiality\n      for one or more accounts SHOULD detect when TLS becomes\
    \ available\n      on those accounts (using [RFC6186] or other means) and offer\
    \ to\n      upgrade the account to require TLS.\n   Additional considerations\
    \ and details appear below.\n"
- title: 5.1.  Use of SRV Records in Establishing Configuration
  contents:
  - "5.1.  Use of SRV Records in Establishing Configuration\n   This document updates\
    \ [RFC6186] by changing the preference rules and\n   adding a new SRV service\
    \ label _submissions._tcp to refer to Message\n   Submission with Implicit TLS.\n\
    \   User-configurable MUAs SHOULD support the use of [RFC6186] for\n   account\
    \ setup.  However, when using configuration information\n   obtained via this\
    \ method, MUAs SHOULD ignore advertised services that\n   do not satisfy minimum\
    \ confidentiality requirements, unless the user\n   has explicitly requested reduced\
    \ confidentiality.  This will have the\n   effect of causing the MUA to default\
    \ to ignoring advertised\n   configurations that do not support TLS, even when\
    \ those advertised\n   configurations have a higher priority than other advertised\n\
    \   configurations.\n   When using configuration information per [RFC6186], MUAs\
    \ SHOULD NOT\n   automatically establish new configurations that do not require\
    \ TLS\n   for all servers, unless there are no advertised configurations using\n\
    \   TLS.  If such a configuration is chosen, prior to attempting to\n   authenticate\
    \ to the server or use the server for Message Submission,\n   the MUA SHOULD warn\
    \ the user that traffic to that server will not be\n   encrypted and that it will\
    \ therefore likely be intercepted by\n   unauthorized parties.  The specific wording\
    \ is to be determined by\n   the implementation, but it should adequately capture\
    \ the sense of\n   risk, given the widespread incidence of mass surveillance of\
    \ email\n   traffic.\n   Similarly, an MUA MUST NOT attempt to \"test\" a particular\
    \ Mail\n   Account configuration by submitting the user's authentication\n   credentials\
    \ to a server, unless a TLS session meeting minimum\n   confidentiality levels\
    \ has been established with that server.  If\n   minimum confidentiality requirements\
    \ have not been satisfied, the MUA\n   must explicitly warn that the user's password\
    \ may be exposed to\n   attackers before testing the new configuration.\n   When\
    \ establishing a new configuration for connecting to an IMAP, POP,\n   or SMTP\
    \ submission server, based on SRV records, an MUA SHOULD verify\n   that either\
    \ (a) the SRV records are signed using DNSSEC or (b) the\n   target Fully Qualified\
    \ Domain Name (FQDN) of the SRV record matches\n   the original server FQDN for\
    \ which the SRV queries were made.  If the\n   target FQDN is not in the queried\
    \ domain, the MUA SHOULD verify with\n   the user that the SRV target FQDN is\
    \ suitable for use, before\n   executing any connections to the host.  (See Section\
    \ 6 of [RFC6186].)\n   An MUA MUST NOT consult SRV records to determine which\
    \ servers to use\n   on every connection attempt, unless those SRV records are\
    \ signed by\n   DNSSEC and have a valid signature.  However, an MUA MAY consult\
    \ SRV\n   records from time to time to determine if an MSP's server\n   configuration\
    \ has changed and alert the user if it appears that this\n   has happened.  This\
    \ can also serve as a means to encourage users to\n   upgrade their configurations\
    \ to require TLS if and when their MSPs\n   support it.\n"
- title: 5.2.  Minimum Confidentiality Level
  contents:
  - "5.2.  Minimum Confidentiality Level\n   MUAs SHOULD, by default, require a minimum\
    \ level of confidentiality\n   for services accessed by each account.  For MUAs\
    \ supporting the\n   ability to access multiple Mail Accounts, this requirement\
    \ SHOULD be\n   configurable on a per-account basis.\n   The default minimum expected\
    \ level of confidentiality for all new\n   accounts MUST require successful validation\
    \ of the server's\n   certificate and SHOULD require negotiation of TLS version\
    \ 1.1 or\n   greater.  (Future revisions to this specification may raise these\n\
    \   requirements or impose additional requirements to address newly\n   discovered\
    \ weaknesses in protocols or cryptographic algorithms.)\n   MUAs MAY permit the\
    \ user to disable this minimum confidentiality\n   requirement during initial\
    \ account configuration or when subsequently\n   editing an account configuration\
    \ but MUST warn users that such a\n   configuration will not assure privacy for\
    \ either passwords or\n   messages.\n   An MUA that is configured to require a\
    \ minimum level of\n   confidentiality for a Mail Account MUST NOT attempt to\
    \ perform any\n   operation other than capability discovery, or STARTTLS for servers\n\
    \   not using Implicit TLS, unless the minimum level of confidentiality\n   is\
    \ provided by that connection.\n   MUAs SHOULD NOT allow users to easily access\
    \ or send mail via a\n   connection, or authenticate to any service using a password,\
    \ if that\n   account is configured to impose minimum confidentiality requirements\n\
    \   and that connection does not meet all of those requirements.  An\n   example\
    \ of \"easy access\" would be to display a dialog informing the\n   user that\
    \ the security requirements of the account were not met by\n   the connection\
    \ but allowing the user to \"click through\" to send mail\n   or access the service\
    \ anyway.  Experience indicates that users\n   presented with such an option often\
    \ \"click through\" without\n   understanding the risks that they're accepting\
    \ by doing so.\n   Furthermore, users who frequently find the need to \"click\
    \ through\" to\n   use an insecure connection may become conditioned to do so\
    \ as a\n   matter of habit, before considering whether the risks are reasonable\n\
    \   in each specific instance.\n   An MUA that is not configured to require a\
    \ minimum level of\n   confidentiality for a Mail Account SHOULD still attempt\
    \ to connect to\n   the services associated with that account using the most secure\
    \ means\n   available, e.g., by using Implicit TLS or STARTTLS.\n"
- title: 5.3.  Certificate Validation
  contents:
  - "5.3.  Certificate Validation\n   MUAs MUST validate TLS server certificates according\
    \ to [RFC7817] and\n   PKIX [RFC5280].\n   MUAs MAY also support DNS-Based Authentication\
    \ of Named Entities\n   (DANE) [RFC6698] as a means of validating server certificates\
    \ in\n   order to meet minimum confidentiality requirements.\n   MUAs MAY support\
    \ the use of certificate pinning but MUST NOT consider\n   a connection in which\
    \ the server's authenticity relies on certificate\n   pinning as providing the\
    \ minimum level of confidentiality.  (See\n   Section 5.4.)\n"
- title: 5.4.  Certificate Pinning
  contents:
  - "5.4.  Certificate Pinning\n   During account setup, the MUA will identify servers\
    \ that provide\n   account services such as mail access and mail submission (Section\
    \ 5.1\n   describes one way to do this).  The certificates for these servers\n\
    \   are verified using the rules described in [RFC7817] and PKIX\n   [RFC5280].\
    \  In the event that the certificate does not validate due\n   to an expired certificate,\
    \ a lack of an appropriate chain of trust,\n   or a lack of an identifier match,\
    \ the MUA MAY offer to create a\n   persistent binding between that certificate\
    \ and the saved hostname\n   for the server, for use when accessing that account's\
    \ servers.  This\n   is called \"certificate pinning\".\n   (Note: This use of\
    \ the term \"certificate pinning\" means something\n   subtly different than HTTP\
    \ Public Key Pinning as described in\n   [RFC7469].  The dual use of the same\
    \ term is confusing, but\n   unfortunately both uses are well established.)\n\
    \   Certificate pinning is only appropriate during Mail Account setup and\n  \
    \ MUST NOT be offered as an option in response to a failed certificate\n   validation\
    \ for an existing Mail Account.  An MUA that allows\n   certificate pinning MUST\
    \ NOT allow a certificate pinned for one\n   account to validate connections for\
    \ other accounts.  An MUA that\n   allows certificate pinning MUST also allow\
    \ a user to undo the\n   pinning, i.e., to revoke trust in a certificate that\
    \ has previously\n   been pinned.\n   A pinned certificate is subject to a man-in-the-middle\
    \ attack at\n   account setup time and typically lacks a mechanism to automatically\n\
    \   revoke or securely refresh the certificate.  Note also that a man-in-\n  \
    \ the-middle attack at account setup time will expose the user's\n   password\
    \ to the attacker (if a password is used).  Therefore, the use\n   of a pinned\
    \ certificate does not meet the requirement for a minimum\n   confidentiality\
    \ level, and an MUA MUST NOT indicate to the user that\n   such confidentiality\
    \ is provided.  Additional advice on certificate\n   pinning is presented in [RFC6125].\n"
- title: 5.5.  Client Certificate Authentication
  contents:
  - "5.5.  Client Certificate Authentication\n   MUAs MAY implement client certificate\
    \ authentication on the Implicit\n   TLS port.  An MUA MUST NOT provide a client\
    \ certificate during the\n   TLS handshake unless the server requests one and\
    \ the MUA has been\n   authorized to use that client certificate with that account.\
    \  Having\n   the end user explicitly configure a client certificate for use with\
    \ a\n   given account is sufficient to meet this requirement.  However,\n   installing\
    \ a client certificate for use with one account MUST NOT\n   automatically authorize\
    \ the use of that certificate with other\n   accounts.  This is not intended to\
    \ prohibit site-specific\n   authorization mechanisms, such as (a) a site-administrator-controlled\n\
    \   mechanism to authorize the use of a client certificate with a given\n   account\
    \ or (b) a domain-name-matching mechanism.\n   Note: The requirement that the\
    \ server request a certificate is just a\n   restatement of the TLS protocol rules,\
    \ e.g., Section 7.4.6 of\n   [RFC5246].  The requirement that the client not send\
    \ a certificate\n   not known to be acceptable to the server is pragmatic in multiple\n\
    \   ways: the current TLS protocol provides no way for the client to know\n  \
    \ which of the potentially multiple certificates it should use; also,\n   when\
    \ the client sends a certificate, it is potentially disclosing its\n   identity\
    \ (or its user's identity) to both the server and any party\n   with access to\
    \ the transmission medium, perhaps unnecessarily and for\n   no useful purpose.\n\
    \   A client supporting client certificate authentication with Implicit\n   TLS\
    \ MUST implement the SASL EXTERNAL mechanism [RFC4422], using the\n   appropriate\
    \ authentication command (AUTH for POP3 [RFC5034], AUTH for\n   SMTP Submission\
    \ [RFC4954], or AUTHENTICATE for IMAP [RFC3501]).\n"
- title: 6.  Considerations Related to Antivirus/Antispam Software and Services
  contents:
  - "6.  Considerations Related to Antivirus/Antispam Software and Services\n   There\
    \ are multiple ways to connect an AVAS service (e.g., \"Antivirus\n   & Antispam\"\
    ) to a mail server.  Some mechanisms, such as the de facto\n   \"milter\" protocol,\
    \ are out of scope for this specification.  However,\n   some services use an\
    \ SMTP relay proxy that intercepts mail at the\n   application layer to perform\
    \ a scan and proxy or forward to another\n   Mail Transfer Agent (MTA).  Deploying\
    \ AVAS services in this way can\n   cause many problems [RFC2979], including direct\
    \ interference with\n   this specification, and other forms of confidentiality\
    \ or security\n   reduction.  An AVAS product or service is considered compatible\
    \ with\n   this specification if all IMAP, POP, and SMTP-related software\n  \
    \ (including proxies) it includes are compliant with this\n   specification.\n\
    \   Note that end-to-end email encryption prevents AVAS software and\n   services\
    \ from using email content as part of a spam or virus\n   assessment.  Furthermore,\
    \ although a minimum confidentiality level\n   can prevent a man-in-the-middle\
    \ from introducing spam or virus\n   content between the MUA and Submission server,\
    \ it does not prevent\n   other forms of client or account compromise.  The use\
    \ of AVAS\n   services for submitted email therefore remains necessary.\n"
- title: 7.  IANA Considerations
  contents:
  - '7.  IANA Considerations

    '
- title: 7.1.  POP3S Port Registration Update
  contents:
  - "7.1.  POP3S Port Registration Update\n   IANA has updated the registration of\
    \ the TCP well-known port 995\n   using the following template [RFC6335]:\n  \
    \   Service Name: pop3s\n     Transport Protocol: TCP\n     Assignee: IESG <iesg@ietf.org>\n\
    \     Contact: IETF Chair <chair@ietf.org>\n     Description: POP3 over TLS protocol\n\
    \     Reference: RFC 8314\n     Port Number: 995\n"
- title: 7.2.  IMAPS Port Registration Update
  contents:
  - "7.2.  IMAPS Port Registration Update\n   IANA has updated the registration of\
    \ the TCP well-known port 993\n   using the following template [RFC6335]:\n  \
    \   Service Name: imaps\n     Transport Protocol: TCP\n     Assignee: IESG <iesg@ietf.org>\n\
    \     Contact: IETF Chair <chair@ietf.org>\n     Description: IMAP over TLS protocol\n\
    \     Reference: RFC 8314\n     Port Number: 993\n   No changes to existing UDP\
    \ port assignments for pop3s or imaps are\n   being requested.\n"
- title: 7.3.  Submissions Port Registration
  contents:
  - "7.3.  Submissions Port Registration\n   IANA has assigned an alternate usage\
    \ of TCP port 465 in addition to\n   the current assignment using the following\
    \ template [RFC6335]:\n     Service Name: submissions\n     Transport Protocol:\
    \ TCP\n     Assignee: IESG <iesg@ietf.org>\n     Contact: IETF Chair <chair@ietf.org>\n\
    \     Description: Message Submission over TLS protocol\n     Reference: RFC 8314\n\
    \     Port Number: 465\n   This is a one-time procedural exception to the rules\
    \ in [RFC6335].\n   This requires explicit IESG approval and does not set a precedent.\n\
    \   Note: Since the purpose of this alternate usage assignment is to\n   align\
    \ with widespread existing practice and there is no known usage\n   of UDP port\
    \ 465 for Message Submission over TLS, IANA has not\n   assigned an alternate\
    \ usage of UDP port 465.\n   Historically, port 465 was briefly registered as\
    \ the \"smtps\" port.\n   This registration made no sense, as the SMTP transport\
    \ MX\n   infrastructure has no way to specify a port, so port 25 is always\n \
    \  used.  As a result, the registration was revoked and was subsequently\n   reassigned\
    \ to a different service.  In hindsight, the \"smtps\"\n   registration should\
    \ have been renamed or reserved rather than\n   revoked.  Unfortunately, some\
    \ widely deployed mail software\n   interpreted \"smtps\" as \"submissions\" [RFC6409]\
    \ and used that port for\n   email submission by default when an end user requested\
    \ security\n   during account setup.  If a new port is assigned for the submissions\n\
    \   service, either (a) email software will continue with unregistered\n   use\
    \ of port 465 (leaving the port registry inaccurate relative to\n   de facto practice\
    \ and wasting a well-known port) or (b) confusion\n   between the de facto and\
    \ registered ports will cause harmful\n   interoperability problems that will\
    \ deter the use of TLS for Message\n   Submission.  The authors of this document\
    \ believe that both of these\n   outcomes are less desirable than a \"wart\" in\
    \ the registry documenting\n   real-world usage of a port for two purposes.  Although\
    \ STARTTLS on\n   port 587 has been deployed, it has not replaced the deployed\
    \ use of\n   Implicit TLS submission on port 465.\n"
- title: 7.4.  Additional Registered Clauses for "Received" Fields
  contents:
  - "7.4.  Additional Registered Clauses for \"Received\" Fields\n   Per the provisions\
    \ in [RFC5321], IANA has added two additional-\n   registered-clauses for Received\
    \ fields as defined in Section 4.3 of\n   this document:\n   o  \"tls\": Indicates\
    \ the TLS cipher used (if applicable)\n   o  \"group\": Indicates the Diffie-Hellman\
    \ group used with the TLS\n      cipher (if applicable)\n   The descriptions and\
    \ syntax of these additional clauses are provided\n   in Section 4.3 of this document.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   This entire document is about security considerations.\
    \  In general,\n   this is targeted to improve mail confidentiality and to mitigate\n\
    \   threats external to the email system such as network-level snooping\n   or\
    \ interception; this is not intended to mitigate active attackers\n   who have\
    \ compromised service provider systems.\n   Implementers should be aware that\
    \ the use of client certificates with\n   TLS 1.2 reveals the user's identity\
    \ to any party with the ability to\n   read packets from the transmission medium\
    \ and therefore may\n   compromise the user's privacy.  There seems to be no easy\
    \ fix with\n   TLS 1.2 or earlier versions, other than to avoid presenting client\n\
    \   certificates except when there is explicit authorization to do so.\n   TLS\
    \ 1.3 [TLS-1.3] appears to reduce this privacy risk somewhat.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC793]   Postel, J., \"Transmission Control\
    \ Protocol\", STD 7,\n              RFC 793, DOI 10.17487/RFC0793, September 1981,\n\
    \              <https://www.rfc-editor.org/info/rfc793>.\n   [RFC1939]  Myers,\
    \ J. and M. Rose, \"Post Office Protocol - Version 3\",\n              STD 53,\
    \ RFC 1939, DOI 10.17487/RFC1939, May 1996,\n              <https://www.rfc-editor.org/info/rfc1939>.\n\
    \   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n        \
    \      Requirement Levels\", BCP 14, RFC 2119,\n              DOI 10.17487/RFC2119,\
    \ March 1997,\n              <https://www.rfc-editor.org/info/rfc2119>.\n   [RFC3207]\
    \  Hoffman, P., \"SMTP Service Extension for Secure SMTP over\n              Transport\
    \ Layer Security\", RFC 3207, DOI 10.17487/RFC3207,\n              February 2002,\
    \ <https://www.rfc-editor.org/info/rfc3207>.\n   [RFC3501]  Crispin, M., \"INTERNET\
    \ MESSAGE ACCESS PROTOCOL -\n              VERSION 4rev1\", RFC 3501, DOI 10.17487/RFC3501,\n\
    \              March 2003, <https://www.rfc-editor.org/info/rfc3501>.\n   [RFC4033]\
    \  Arends, R., Austein, R., Larson, M., Massey, D., and S.\n              Rose,\
    \ \"DNS Security Introduction and Requirements\",\n              RFC 4033, DOI\
    \ 10.17487/RFC4033, March 2005,\n              <https://www.rfc-editor.org/info/rfc4033>.\n\
    \   [RFC5034]  Siemborski, R. and A. Menon-Sen, \"The Post Office Protocol\n \
    \             (POP3) Simple Authentication and Security Layer (SASL)\n       \
    \       Authentication Mechanism\", RFC 5034, DOI 10.17487/RFC5034,\n        \
    \      July 2007, <https://www.rfc-editor.org/info/rfc5034>.\n   [RFC5234]  Crocker,\
    \ D., Ed., and P. Overell, \"Augmented BNF for\n              Syntax Specifications:\
    \ ABNF\", STD 68, RFC 5234,\n              DOI 10.17487/RFC5234, January 2008,\n\
    \              <https://www.rfc-editor.org/info/rfc5234>.\n   [RFC5246]  Dierks,\
    \ T. and E. Rescorla, \"The Transport Layer Security\n              (TLS) Protocol\
    \ Version 1.2\", RFC 5246,\n              DOI 10.17487/RFC5246, August 2008,\n\
    \              <https://www.rfc-editor.org/info/rfc5246>.\n   [RFC5280]  Cooper,\
    \ D., Santesson, S., Farrell, S., Boeyen, S.,\n              Housley, R., and\
    \ W. Polk, \"Internet X.509 Public Key\n              Infrastructure Certificate\
    \ and Certificate Revocation List\n              (CRL) Profile\", RFC 5280, DOI\
    \ 10.17487/RFC5280, May 2008,\n              <https://www.rfc-editor.org/info/rfc5280>.\n\
    \   [RFC5322]  Resnick, P., Ed., \"Internet Message Format\", RFC 5322,\n    \
    \          DOI 10.17487/RFC5322, October 2008,\n              <https://www.rfc-editor.org/info/rfc5322>.\n\
    \   [RFC6186]  Daboo, C., \"Use of SRV Records for Locating Email\n          \
    \    Submission/Access Services\", RFC 6186,\n              DOI 10.17487/RFC6186,\
    \ March 2011,\n              <https://www.rfc-editor.org/info/rfc6186>.\n   [RFC6409]\
    \  Gellens, R. and J. Klensin, \"Message Submission for Mail\",\n            \
    \  STD 72, RFC 6409, DOI 10.17487/RFC6409, November 2011,\n              <https://www.rfc-editor.org/info/rfc6409>.\n\
    \   [RFC6698]  Hoffman, P. and J. Schlyter, \"The DNS-Based Authentication\n \
    \             of Named Entities (DANE) Transport Layer Security (TLS)\n      \
    \        Protocol: TLSA\", RFC 6698, DOI 10.17487/RFC6698,\n              August\
    \ 2012, <https://www.rfc-editor.org/info/rfc6698>.\n   [RFC7525]  Sheffer, Y.,\
    \ Holz, R., and P. Saint-Andre,\n              \"Recommendations for Secure Use\
    \ of Transport Layer\n              Security (TLS) and Datagram Transport Layer\
    \ Security\n              (DTLS)\", BCP 195, RFC 7525, DOI 10.17487/RFC7525,\n\
    \              May 2015, <https://www.rfc-editor.org/info/rfc7525>.\n   [RFC7672]\
    \  Dukhovni, V. and W. Hardaker, \"SMTP Security via\n              Opportunistic\
    \ DNS-Based Authentication of Named Entities\n              (DANE) Transport Layer\
    \ Security (TLS)\", RFC 7672,\n              DOI 10.17487/RFC7672, October 2015,\n\
    \              <https://www.rfc-editor.org/info/rfc7672>.\n   [RFC7817]  Melnikov,\
    \ A., \"Updated Transport Layer Security (TLS)\n              Server Identity\
    \ Check Procedure for Email-Related\n              Protocols\", RFC 7817, DOI\
    \ 10.17487/RFC7817, March 2016,\n              <https://www.rfc-editor.org/info/rfc7817>.\n\
    \   [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in\n         \
    \     RFC 2119 Key Words\", BCP 14, RFC 8174,\n              DOI 10.17487/RFC8174,\
    \ May 2017,\n              <https://www.rfc-editor.org/info/rfc8174>.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [CERT-555316]\n              CERT, \"Vulnerability\
    \ Note VU#555316: STARTTLS plaintext\n              command injection vulnerability\"\
    , Carnegie Mellon\n              University Software Engineering Institute, September\
    \ 2011,\n              <https://www.kb.cert.org/vuls/id/555316>.\n   [Email-TLS]\n\
    \              Moore, K., \"Recommendations for use of TLS by Electronic\n   \
    \           Mail Access Protocols\", Work in Progress, draft-moore-\n        \
    \      email-tls-00, October 2013.\n   [MTA-STS]  Margolis, D., Risher, M., Ramakrishnan,\
    \ B., Brotman, A.,\n              and J. Jones, \"SMTP MTA Strict Transport Security\n\
    \              (MTA-STS)\", Work in Progress, draft-ietf-uta-mta-sts-14,\n   \
    \           January 2018.\n   [POP3-over-TLS]\n              Melnikov, A., Newman,\
    \ C., and M. Yevstifeyev, Ed., \"POP3\n              over TLS\", Work in Progress,\
    \ draft-melnikov-pop3-\n              over-tls-02, August 2011.\n   [RFC2595]\
    \  Newman, C., \"Using TLS with IMAP, POP3 and ACAP\",\n              RFC 2595,\
    \ DOI 10.17487/RFC2595, June 1999,\n              <https://www.rfc-editor.org/info/rfc2595>.\n\
    \   [RFC2979]  Freed, N., \"Behavior of and Requirements for Internet\n      \
    \        Firewalls\", RFC 2979, DOI 10.17487/RFC2979, October 2000,\n        \
    \      <https://www.rfc-editor.org/info/rfc2979>.\n   [RFC3848]  Newman, C., \"\
    ESMTP and LMTP Transmission Types\n              Registration\", RFC 3848, DOI\
    \ 10.17487/RFC3848, July 2004,\n              <https://www.rfc-editor.org/info/rfc3848>.\n\
    \   [RFC4346]  Dierks, T. and E. Rescorla, \"The Transport Layer Security\n  \
    \            (TLS) Protocol Version 1.1\", RFC 4346,\n              DOI 10.17487/RFC4346,\
    \ April 2006,\n              <https://www.rfc-editor.org/info/rfc4346>.\n   [RFC4422]\
    \  Melnikov, A., Ed., and K. Zeilenga, Ed., \"Simple\n              Authentication\
    \ and Security Layer (SASL)\", RFC 4422,\n              DOI 10.17487/RFC4422,\
    \ June 2006,\n              <https://www.rfc-editor.org/info/rfc4422>.\n   [RFC4954]\
    \  Siemborski, R., Ed., and A. Melnikov, Ed., \"SMTP Service\n              Extension\
    \ for Authentication\", RFC 4954,\n              DOI 10.17487/RFC4954, July 2007,\n\
    \              <https://www.rfc-editor.org/info/rfc4954>.\n   [RFC5068]  Hutzler,\
    \ C., Crocker, D., Resnick, P., Allman, E., and T.\n              Finch, \"Email\
    \ Submission Operations: Access and\n              Accountability Requirements\"\
    , BCP 134, RFC 5068,\n              DOI 10.17487/RFC5068, November 2007,\n   \
    \           <https://www.rfc-editor.org/info/rfc5068>.\n   [RFC5321]  Klensin,\
    \ J., \"Simple Mail Transfer Protocol\", RFC 5321,\n              DOI 10.17487/RFC5321,\
    \ October 2008,\n              <https://www.rfc-editor.org/info/rfc5321>.\n  \
    \ [RFC6066]  Eastlake 3rd, D., \"Transport Layer Security (TLS)\n            \
    \  Extensions: Extension Definitions\", RFC 6066,\n              DOI 10.17487/RFC6066,\
    \ January 2011,\n              <https://www.rfc-editor.org/info/rfc6066>.\n  \
    \ [RFC6125]  Saint-Andre, P. and J. Hodges, \"Representation and\n           \
    \   Verification of Domain-Based Application Service Identity\n              within\
    \ Internet Public Key Infrastructure Using X.509\n              (PKIX) Certificates\
    \ in the Context of Transport Layer\n              Security (TLS)\", RFC 6125,\
    \ DOI 10.17487/RFC6125,\n              March 2011, <https://www.rfc-editor.org/info/rfc6125>.\n\
    \   [RFC6335]  Cotton, M., Eggert, L., Touch, J., Westerlund, M., and S.\n   \
    \           Cheshire, \"Internet Assigned Numbers Authority (IANA)\n         \
    \     Procedures for the Management of the Service Name and\n              Transport\
    \ Protocol Port Number Registry\", BCP 165,\n              RFC 6335, DOI 10.17487/RFC6335,\
    \ August 2011,\n              <https://www.rfc-editor.org/info/rfc6335>.\n   [RFC7469]\
    \  Evans, C., Palmer, C., and R. Sleevi, \"Public Key Pinning\n              Extension\
    \ for HTTP\", RFC 7469, DOI 10.17487/RFC7469,\n              April 2015, <https://www.rfc-editor.org/info/rfc7469>.\n\
    \   [TLS-1.3]  Rescorla, E., \"The Transport Layer Security (TLS) Protocol\n \
    \             Version 1.3\", Work in Progress, draft-ietf-tls-tls13-23,\n    \
    \          January 2018.\n"
- title: Appendix A.  Design Considerations
  contents:
  - "Appendix A.  Design Considerations\n   This section is not normative.\n   The\
    \ first version of this document was written independently from the\n   October\
    \ 2013 version of [Email-TLS] (\"Recommendations for use of TLS\n   by Electronic\
    \ Mail Access Protocols\").  Subsequent versions merge\n   ideas from both documents.\n\
    \   One author of this document was also the author of RFC 2595, which\n   became\
    \ the standard for TLS usage with POP and IMAP, and the other\n   author was perhaps\
    \ the first to propose that idea.  In hindsight,\n   both authors now believe\
    \ that that approach was a mistake.  At this\n   point, the authors believe that\
    \ while anything that makes it easier\n   to deploy TLS is good, the desirable\
    \ end state is that these\n   protocols always use TLS, leaving no need for a\
    \ separate port for\n   cleartext operation except to support legacy clients while\
    \ they\n   continue to be used.  The separate-port model for TLS is inherently\n\
    \   simpler to implement, debug, and deploy.  It also enables a \"generic\n  \
    \ TLS load-balancer\" that accepts secure client connections for\n   arbitrary\
    \ foo-over-TLS protocols and forwards them to a server that\n   may or may not\
    \ support TLS.  Such load-balancers cause many problems\n   because they violate\
    \ the end-to-end principle and the server loses\n   the ability to log security-relevant\
    \ information about the client\n   unless the protocol is designed to forward\
    \ that information (as this\n   specification does for the ciphersuite).  However,\
    \ they can result in\n   TLS deployment where it would not otherwise happen, which\
    \ is a\n   sufficiently important goal that it overrides any problems.\n   Although\
    \ STARTTLS appears only slightly more complex than\n   separate-port TLS, we again\
    \ learned the lesson that complexity is the\n   enemy of security in the form\
    \ of the STARTTLS command injection\n   vulnerability (Computer Emergency Readiness\
    \ Team (CERT) vulnerability\n   ID #555316 [CERT-555316]).  Although there's nothing\
    \ inherently wrong\n   with STARTTLS, the fact that it resulted in a common implementation\n\
    \   error (made independently by multiple implementers) suggests that it\n   is\
    \ a less secure architecture than Implicit TLS.\n   Section 7 of RFC 2595 critiques\
    \ the separate-port approach to TLS.\n   The first bullet was a correct critique.\
    \  There are proposals in the\n   HTTP community to address that, and the use\
    \ of SRV records as\n   described in RFC 6186 resolves that critique for email.\
    \  The second\n   bullet is correct as well but is not very important because\
    \ useful\n   deployment of security layers other than TLS in email is small enough\n\
    \   to be effectively irrelevant.  (Also, it's less correct than it used\n   to\
    \ be because \"export\" ciphersuites are no longer supported in modern\n   versions\
    \ of TLS.)  The third bullet is incorrect because it misses\n   the desirable\
    \ option of \"use TLS for all subsequent connections to\n   this server once TLS\
    \ is successfully negotiated\".  The fourth bullet\n   may be correct, but it\
    \ is not a problem yet with current port\n   consumption rates.  The fundamental\
    \ error was prioritizing a\n   perceived better design based on a mostly valid\
    \ critique over\n   real-world deployability.  But getting security and confidentiality\n\
    \   facilities actually deployed is so important that it should trump\n   design\
    \ purity considerations.\n   Port 465 is presently used for two purposes: for\
    \ submissions by a\n   large number of clients and service providers and for the\
    \ \"urd\"\n   protocol by one vendor.  Actually documenting this current state\
    \ is\n   controversial, as discussed in the IANA Considerations section.\n   However,\
    \ there is no good alternative.  Registering a new port for\n   submissions when\
    \ port 465 is already widely used for that purpose\n   will just create interoperability\
    \ problems.  Registering a port\n   that's only used if advertised by an SRV record\
    \ (RFC 6186) would not\n   create interoperability problems but would require\
    \ all client\n   deployments, server deployments, and software to change\n   significantly,\
    \ which is contrary to the goal of promoting the\n   increased use of TLS.  Encouraging\
    \ the use of STARTTLS on port 587\n   would not create interoperability problems,\
    \ but it is unlikely to\n   have any impact on the current undocumented use of\
    \ port 465 and makes\n   the guidance in this document less consistent.  The remaining\
    \ option\n   is to document the current state of the world and support future\
    \ use\n   of port 465 for submission, as this increases consistency and ease of\n\
    \   deployment for TLS email submission.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   Thanks to Ned Freed for discussion of the initial concepts\
    \ in this\n   document.  Thanks to Alexey Melnikov for [POP3-over-TLS], which\
    \ was\n   the basis of the POP3 Implicit TLS text.  Thanks to Russ Housley,\n\
    \   Alexey Melnikov, and Dan Newman for review feedback.  Thanks to\n   Paul Hoffman\
    \ for interesting feedback in initial conversations about\n   this idea.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Keith Moore\n   Windrock, Inc.\n   PO Box 1934\n   Knoxville,\
    \ TN  37901\n   United States of America\n   Email: moore@network-heretics.com\n\
    \   Chris Newman\n   Oracle\n   440 E. Huntington Dr., Suite 400\n   Arcadia,\
    \ CA  91006\n   United States of America\n   Email: chris.newman@oracle.com\n"
