- title: __initial_text__
  contents:
  - '        Transmission of IPv6 Packets over ITU-T G.9959 Networks

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes the frame format for transmission of IPv6\n\
    \   packets as well as a method of forming IPv6 link-local addresses and\n   statelessly\
    \ autoconfigured IPv6 addresses on ITU-T G.9959 networks.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc7428.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2015 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................2\n\
    \      1.1. Terms Used .................................................3\n  \
    \    1.2. Requirements Language ......................................4\n   2.\
    \ G.9959 Parameters to Use for IPv6 Transport .....................5\n      2.1.\
    \ Addressing Mode ............................................5\n      2.2. IPv6\
    \ Multicast Support .....................................6\n      2.3. G.9959\
    \ MAC PDU Size and IPv6 MTU ...........................6\n      2.4. Transmission\
    \ Status Indications ............................7\n      2.5. Transmission Security\
    \ ......................................7\n   3. 6LoWPAN Adaptation Layer and\
    \ Frame Format .......................7\n      3.1. Dispatch Header ............................................8\n\
    \   4. 6LoWPAN Addressing ..............................................9\n  \
    \    4.1. Stateless Address Autoconfiguration of Routable IPv6\n           Addresses\
    \ ..................................................9\n      4.2. IPv6 Link-Local\
    \ Address ...................................10\n      4.3. Unicast Address Mapping\
    \ ...................................10\n      4.4. On the Use of Neighbor Discovery\
    \ Technologies .............11\n           4.4.1. Prefix and CID Management (Route-Over)\
    \ .............11\n           4.4.2. Prefix and CID Management (Mesh-Under) .............11\n\
    \   5. Header Compression .............................................12\n  \
    \ 6. Security Considerations ........................................13\n   7.\
    \ Privacy Considerations .........................................14\n   8. References\
    \ .....................................................14\n      8.1. Normative\
    \ References ......................................14\n      8.2. Informative\
    \ References ....................................16\n   Appendix A. G.9959 6LoWPAN\
    \ Datagram Example .......................17\n   Acknowledgements ..................................................21\n\
    \   Authors' Addresses ................................................21\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The ITU-T G.9959 recommendation [G.9959] targets low-power\
    \ Personal\n   Area Networks (PANs).  This document defines the frame format for\n\
    \   transmission of IPv6 [RFC2460] packets as well as the formation of\n   IPv6\
    \ link-local addresses and statelessly autoconfigured IPv6\n   addresses on G.9959\
    \ networks.\n   The general approach is to adapt elements of [RFC4944] to G.9959\n\
    \   networks.  G.9959 provides a Segmentation and Reassembly (SAR) layer\n   for\
    \ transmission of datagrams larger than the G.9959 Media Access\n   Control Protocol\
    \ Data Unit (MAC PDU).\n   [RFC6775] updates [RFC4944] by specifying IPv6 over\
    \ Low-Power\n   Wireless Personal Area Network (6LoWPAN) optimizations for IPv6\n\
    \   Neighbor Discovery (ND) (originally defined by [RFC4861]).  This\n   document\
    \ limits the use of [RFC6775] to prefix and Context ID\n   assignment.  An Interface\
    \ Identifier (IID) may be constructed from a\n   G.9959 link-layer address, leading\
    \ to a \"link-layer-derived IPv6\n   address\".  If using that method, Duplicate\
    \ Address Detection (DAD) is\n   not needed.  Alternatively, IPv6 addresses may\
    \ be assigned centrally\n   via DHCP, leading to a \"non-link-layer-derived IPv6\
    \ address\".\n   Address registration is only needed in certain cases.\n   In\
    \ addition to IPv6 application communication, the frame format\n   defined in\
    \ this document may be used by IPv6 routing protocols such\n   as the Routing\
    \ Protocol for Low-Power and Lossy Networks (RPL)\n   [RFC6550] or Reactive Discovery\
    \ of Point-to-Point Routes in Low-Power\n   and Lossy Networks (P2P-RPL) [RFC6997]\
    \ to implement IPv6 routing over\n   G.9959 networks.\n   The encapsulation frame\
    \ defined by this specification may optionally\n   be transported via mesh routing\
    \ below the 6LoWPAN layer.  Mesh-under\n   and route-over routing protocol specifications\
    \ are out of scope for\n   this document.\n"
- title: 1.1.  Terms Used
  contents:
  - "1.1.  Terms Used\n   6LoWPAN: IPv6 over Low-Power Wireless Personal Area Network\n\
    \   ABR: Authoritative 6LoWPAN Border Router (Authoritative 6LBR)\n      [RFC6775]\n\
    \   Ack: Acknowledgement\n   AES: Advanced Encryption Standard\n   CID: Context\
    \ Identifier [RFC6775]\n   DAD: Duplicate Address Detection [RFC6775]\n   DHCPv6:\
    \ Dynamic Host Configuration Protocol for IPv6 [RFC3315]\n   EUI-64: Extended\
    \ Unique Identifier [EUI64]\n   G.9959: Short range narrow-band digital radiocommunication\n\
    \      transceiver [G.9959]\n   GHC: Generic Header Compression [RFC7400]\n  \
    \ HomeID: G.9959 Link-Layer Network Identifier\n   IID: Interface Identifier\n\
    \   Link-layer-derived address: IPv6 address constructed on the basis of\n   \
    \   link-layer address information\n   MAC: Media Access Control\n   Mesh-under:\
    \ Forwarding via mesh routing below the 6LoWPAN layer\n   MTU: Maximum Transmission\
    \ Unit\n   ND: Neighbor Discovery [RFC4861] [RFC6775]\n   NodeID: G.9959 Link-Layer\
    \ Node Identifier\n   Non-link-layer-derived address: IPv6 address assigned by\
    \ a managed\n      process, e.g., DHCPv6\n   P2P-RPL: Reactive Discovery of Point-to-Point\
    \ Routes in Low-Power and\n      Lossy Networks [RFC6997]\n   PAN: Personal Area\
    \ Network\n   PDU: Protocol Data Unit\n   PHY: Physical Layer\n   RA: Router Advertisement\
    \ [RFC4861] [RFC6775]\n   Route-over: Forwarding via IP routing above the 6LoWPAN\
    \ layer\n   RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks [RFC6550]\n\
    \   SAR: G.9959 Segmentation and Reassembly\n   ULA: Unique Local Address [RFC4193]\n"
- title: 1.2.  Requirements Language
  contents:
  - "1.2.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 2.  G.9959 Parameters to Use for IPv6 Transport
  contents:
  - "2.  G.9959 Parameters to Use for IPv6 Transport\n   This section outlines properties\
    \ applying to the PHY and MAC layers\n   of G.9959 and how to use these for IPv6\
    \ transport.\n"
- title: 2.1.  Addressing Mode
  contents:
  - "2.1.  Addressing Mode\n   G.9959 defines how a unique 32-bit HomeID network identifier\
    \ is\n   assigned by a network controller and how an 8-bit NodeID host\n   identifier\
    \ is allocated to each node.  NodeIDs are unique within the\n   network identified\
    \ by the HomeID.  The G.9959 HomeID represents an\n   IPv6 subnet that is identified\
    \ by one or more IPv6 prefixes.\n   An IPv6 host MUST construct its link-local\
    \ IPv6 address from the\n   link-layer-derived IID in order to facilitate IP header\
    \ compression\n   as described in [RFC6282].\n   A node interface MAY support\
    \ the M flag of the RA message for the\n   construction of routable IPv6 addresses.\
    \  A cost-optimized node\n   implementation may save memory by skipping support\
    \ for the M flag.\n   The M flag MUST be interpreted as defined in Figure 1.\n\
    \    +--------+--------+---------------------------------------------+\n    |\
    \ M flag | M flag |  Required node behavior                     |\n    | support|\
    \ value  |                                             |\n    +--------+--------+---------------------------------------------+\n\
    \    | No     |(ignore)| Node MUST use link-layer-derived addressing |\n    +--------+--------+---------------------------------------------+\n\
    \    | Yes    |    0   | Node MUST use link-layer-derived addressing |\n    |\
    \        +--------+---------------------------------------------+\n    |     \
    \   |    1   | Node MUST use DHCPv6-based addressing, and  |\n    |        | \
    \       | node MUST comply fully with [RFC6775]       |\n    +--------+--------+---------------------------------------------+\n\
    \              Figure 1: RA M Flag Support and Interpretation\n   A node that\
    \ uses DHCPv6-based addressing MUST comply fully with the\n   text of [RFC6775].\n\
    \   If DHCPv6-based addressing is used, the DHCPv6 client must use a\n   DHCPv6\
    \ Unique Identifier (DUID) of type DUID-UUID, as described in\n   [RFC6355]. \
    \ The Universally Unique Identifier (UUID) used in the\n   DUID-UUID must be generated\
    \ as specified in [RFC4122], Section 4.5,\n   starting at the third paragraph\
    \ in that section (the 47-bit random\n   number-based UUID).  The DUID must be\
    \ stored persistently by the node\n   as specified in Section 3 of [RFC6355].\n\
    \   A word of caution: since HomeIDs and NodeIDs are handed out by a\n   network\
    \ controller function during inclusion, identifier validity and\n   uniqueness\
    \ are limited by the lifetime of the network membership.\n   This can be cut short\
    \ by a mishap occurring at the network\n   controller.  Having a single point\
    \ of failure at the network\n   controller suggests that high-reliability network\
    \ deployments may\n   benefit from a redundant network controller function.\n\
    \   This warning applies to link-layer-derived addressing as well as to\n   non-link-layer-derived\
    \ addressing deployments.\n"
- title: 2.2.  IPv6 Multicast Support
  contents:
  - "2.2.  IPv6 Multicast Support\n   [RFC3819] recommends that IP subnetworks support\
    \ (subnet-wide)\n   multicast.  G.9959 supports direct-range IPv6 multicast, while\n\
    \   subnet-wide multicast is not supported natively by G.9959.  Subnet-\n   wide\
    \ multicast may be provided by an IP routing protocol or a mesh\n   routing protocol\
    \ operating below the 6LoWPAN layer.  Routing protocol\n   specifications are\
    \ out of scope for this document.\n   IPv6 multicast packets MUST be carried via\
    \ G.9959 broadcast.\n   As per [G.9959], this is accomplished as follows:\n  \
    \ 1.  The destination HomeID of the G.9959 MAC PDU MUST be the HomeID\n      \
    \ of the network.\n   2.  The destination NodeID of the G.9959 MAC PDU MUST be\
    \ the\n       broadcast NodeID (0xff).\n   G.9959 broadcast MAC PDUs are only\
    \ intercepted by nodes within the\n   network identified by the HomeID.\n"
- title: 2.3.  G.9959 MAC PDU Size and IPv6 MTU
  contents:
  - "2.3.  G.9959 MAC PDU Size and IPv6 MTU\n   IPv6 packets MUST be transmitted using\
    \ G.9959 transmission profile R3\n   or higher.\n   [RFC2460] specifies that any\
    \ link that cannot convey a 1280-octet\n   packet in one piece must provide link-specific\
    \ fragmentation and\n   reassembly at a layer below IPv6.\n   G.9959 provides\
    \ segmentation and reassembly for payloads up to\n   1350 octets.  IPv6 header\
    \ compression [RFC6282] improves the chances\n   that a short IPv6 packet can\
    \ fit into a single G.9959 frame.\n   Therefore, Section 3 of this document specifies\
    \ that [RFC6282] MUST\n   be supported.  With the mandatory link-layer security\
    \ enabled, a\n   G.9959 R3 MAC PDU may accommodate 6LoWPAN datagrams of up to\n\
    \   130 octets without triggering G.9959 segmentation and reassembly.\n   Longer\
    \ 6LoWPAN datagrams will lead to the transmission of multiple\n   G.9959 PDUs.\n"
- title: 2.4.  Transmission Status Indications
  contents:
  - "2.4.  Transmission Status Indications\n   The G.9959 MAC layer provides native\
    \ acknowledgement and\n   retransmission of MAC PDUs.  The G.9959 SAR layer does\
    \ the same for\n   larger datagrams.  A mesh routing layer may provide a similar\
    \ feature\n   for routed communication.  An IPv6 routing stack communicating over\n\
    \   G.9959 may utilize link-layer status indications such as delivery\n   confirmation\
    \ and Ack timeout from the MAC layer.\n"
- title: 2.5.  Transmission Security
  contents:
  - "2.5.  Transmission Security\n   Implementations claiming conformance with this\
    \ document MUST enable\n   G.9959 shared network key security.\n   The shared\
    \ network key is intended to address security requirements\n   in the home at\
    \ the normal level of security requirements.  For\n   applications with high or\
    \ very high requirements for confidentiality\n   and/or integrity, additional\
    \ application-layer security measures for\n   end-to-end authentication and encryption\
    \ may need to be applied.\n   (The availability of the network relies on the security\
    \ properties of\n   the network key in any case.)\n"
- title: 3.  6LoWPAN Adaptation Layer and Frame Format
  contents:
  - "3.  6LoWPAN Adaptation Layer and Frame Format\n   The 6LoWPAN encapsulation formats\
    \ defined in this section are carried\n   as payload in the G.9959 MAC PDU.  IPv6\
    \ header compression [RFC6282]\n   MUST be supported by implementations of this\
    \ specification.  Further,\n   implementations MAY support Generic Header Compression\
    \ (GHC)\n   [RFC7400].  A node implementing [RFC7400] MUST probe its peers for\n\
    \   GHC support before applying GHC.\n   All 6LoWPAN datagrams transported over\
    \ G.9959 are prefixed by a\n   6LoWPAN encapsulation header stack.  The 6LoWPAN\
    \ payload follows this\n   encapsulation header stack.  Each header in the header\
    \ stack contains\n   a header type followed by zero or more header fields.  An\
    \ IPv6 header\n   stack may contain, in the following order, addressing, hop-by-hop\n\
    \   options, routing, fragmentation, destination options, and, finally,\n   payload\
    \ [RFC2460].  The 6LoWPAN header format is structured the same\n   way.  Currently,\
    \ only one payload option is defined for the G.9959\n   6LoWPAN header format.\n\
    \   The definition of 6LoWPAN headers consists of the dispatch value, the\n  \
    \ definition of the header fields that follow, and their ordering\n   constraints\
    \ relative to all other headers.  Although the header stack\n   structure provides\
    \ a mechanism to address future demands on the\n   6LoWPAN adaptation layer, it\
    \ is not intended to provide general-\n   purpose extensibility.\n   An example\
    \ of a complete G.9959 6LoWPAN datagram can be found in\n   Appendix A.\n"
- title: 3.1.  Dispatch Header
  contents:
  - "3.1.  Dispatch Header\n   The Dispatch Header is shown below:\n     0       \
    \            1                   2                   3\n     0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | 6LoWPAN CmdCls|   Dispatch    |  Type-specific header         |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                    Figure 2: Dispatch Type and Header\n   6LoWPAN CmdCls: 6LoWPAN\
    \ Command Class identifier.  This field MUST\n      carry the value 0x4F [G.9959].\
    \  The value is assigned by the ITU-T\n      and specifies that the following\
    \ bits are a 6LoWPAN encapsulated\n      datagram.  6LoWPAN protocols MUST ignore\
    \ the G.9959 frame if the\n      6LoWPAN Command Class identifier deviates from\
    \ 0x4F.\n   Dispatch: Identifies the header type immediately following the\n \
    \     Dispatch Header.\n   Type-specific header: A header determined by the Dispatch\
    \ Header.\n   The dispatch value may be treated as an unstructured namespace.\
    \  Only\n   a few symbols are required to represent current 6LoWPAN\n   functionality.\
    \  Although some additional savings could be achieved by\n   encoding additional\
    \ functionality into the dispatch byte, these\n   measures would tend to constrain\
    \ the ability to address future\n   alternatives.\n              +------------+--------------------+-----------+\n\
    \              | Pattern    | Header Type        | Reference |\n             \
    \ +------------+--------------------+-----------+\n              | 01  1xxxxx\
    \ | 6LoWPAN_IPHC       | [RFC6282] |\n              +------------+--------------------+-----------+\n\
    \              Other IANA-assigned 6LoWPAN dispatch values do not\n          \
    \    apply to this document.\n                         Figure 3: Dispatch Values\n\
    \   6LoWPAN_IPHC: IPv6 Header Compression.  Refer to [RFC6282].\n"
- title: 4.  6LoWPAN Addressing
  contents:
  - "4.  6LoWPAN Addressing\n   IPv6 addresses may be autoconfigured from IIDs that\
    \ may again be\n   constructed from link-layer address information to save memory\
    \ in\n   devices and to facilitate efficient IP header compression as per\n  \
    \ [RFC6282].  Link-layer-derived addresses have a static nature and may\n   involuntarily\
    \ expose private usage data on public networks.  Refer to\n   Section 7.\n   A\
    \ NodeID is mapped into an IEEE EUI-64 identifier as follows:\n              \
    \          IID = 0000:00ff:fe00:YYXX\n                 Figure 4: Constructing\
    \ a Compressible IID\n   where XX carries the G.9959 NodeID and YY is a 1-byte\
    \ value chosen by\n   the individual node.  The default YY value MUST be zero.\
    \  A node MAY\n   use values of YY other than zero to form additional IIDs in\
    \ order to\n   instantiate multiple IPv6 interfaces.  The YY value MUST be ignored\n\
    \   when computing the corresponding NodeID (the XX value) from an IID.\n   The\
    \ method of constructing IIDs from the link-layer address obviously\n   does not\
    \ support addresses assigned or constructed by other means.  A\n   node MUST NOT\
    \ compute the NodeID from the IID if the first 6 bytes of\n   the IID do not comply\
    \ with the format defined in Figure 4.  In that\n   case, the address resolution\
    \ mechanisms of [RFC6775] apply.\n"
- title: 4.1.  Stateless Address Autoconfiguration of Routable IPv6 Addresses
  contents:
  - "4.1.  Stateless Address Autoconfiguration of Routable IPv6 Addresses\n   The\
    \ IID defined above MUST be used whether autoconfiguring a ULA IPv6\n   address\
    \ [RFC4193] or a globally routable IPv6 address [RFC3587] in\n   G.9959 subnets.\n"
- title: 4.2.  IPv6 Link-Local Address
  contents:
  - "4.2.  IPv6 Link-Local Address\n   The IPv6 link-local address [RFC4291] for a\
    \ G.9959 interface is\n   formed by appending the IID defined above to the IPv6\
    \ link-local\n   prefix fe80::/64.\n   The \"Universal/Local\" (U/L) bit MUST\
    \ be set to zero in keeping with\n   the fact that this is not a globally unique\
    \ value [EUI64].\n   The resulting link-local address is formed as follows:\n\
    \        10 bits            54 bits                  64 bits\n     +----------+-----------------------+----------------------------+\n\
    \     |1111111010|         (zeros)       | Interface Identifier (IID) |\n    \
    \ +----------+-----------------------+----------------------------+\n        \
    \             Figure 5: IPv6 Link-Local Address\n"
- title: 4.3.  Unicast Address Mapping
  contents:
  - "4.3.  Unicast Address Mapping\n   The address resolution procedure for mapping\
    \ IPv6 unicast addresses\n   into G.9959 link-layer addresses follows the general\
    \ description in\n   Section 7.2 of [RFC4861].  The Source/Target Link-layer Address\n\
    \   option MUST have the following form when the link layer is G.9959.\n     \
    \                 0                   1\n                      0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5\n                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  \
    \                   |     Type      |    Length=1   |\n                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                     |     0x00      |    NodeID     |\n                    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                     |            Padding\
    \            |\n                     +-                             -+\n     \
    \                |          (All zeros)          |\n                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                  Figure 6: IPv6 Unicast Address Mapping\n   Option fields:\n\
    \   Type:  The value 1 signifies the Source Link-layer address.  The\n      value\
    \ 2 signifies the Destination Link-layer address.\n   Length:  This is the length\
    \ of this option (including the Type and\n      Length fields) in units of 8 octets.\
    \  The value of this field is\n      always 1 for G.9959 NodeIDs.\n   NodeID:\
    \  This is the G.9959 NodeID to which the actual interface\n      currently responds.\
    \  The link-layer address may change if the\n      interface joins another network\
    \ at a later time.\n"
- title: 4.4.  On the Use of Neighbor Discovery Technologies
  contents:
  - "4.4.  On the Use of Neighbor Discovery Technologies\n   [RFC4861] specifies how\
    \ IPv6 nodes may resolve link-layer addresses\n   from IPv6 addresses via the\
    \ use of link-local IPv6 multicast.\n   [RFC6775] is an optimization of [RFC4861],\
    \ specifically targeting\n   6LoWPAN networks.  [RFC6775] defines how a 6LoWPAN\
    \ node may register\n   IPv6 addresses with an authoritative border router (ABR).\
    \  Mesh-under\n   networks MUST NOT use [RFC6775] address registration.  However,\n\
    \   [RFC6775] address registration MUST be used if the first 6 bytes of\n   the\
    \ IID do not comply with the format defined in Figure 4.\n"
- title: 4.4.1.  Prefix and CID Management (Route-Over)
  contents:
  - "4.4.1.  Prefix and CID Management (Route-Over)\n   In route-over environments,\
    \ IPv6 hosts MUST use [RFC6775] address\n   registration.  A node implementation\
    \ for route-over operation MAY use\n   [RFC6775] mechanisms for obtaining IPv6\
    \ prefixes and corresponding\n   header compression context information [RFC6282].\
    \  [RFC6775] route-\n   over requirements apply with no modifications.\n"
- title: 4.4.2.  Prefix and CID Management (Mesh-Under)
  contents:
  - "4.4.2.  Prefix and CID Management (Mesh-Under)\n   An implementation for mesh-under\
    \ operation MUST use [RFC6775]\n   mechanisms for managing IPv6 prefixes and corresponding\
    \ header\n   compression context information [RFC6282].  [RFC6775] Duplicate\n\
    \   Address Detection (DAD) MUST NOT be used, since the link-layer\n   inclusion\
    \ process of G.9959 ensures that a NodeID is unique for a\n   given HomeID.\n\
    \   With this exception and the specific redefinition of the RA Router\n   Lifetime\
    \ value 0xFFFF (refer to Section 4.4.2.3), the text of the\n   following subsections\
    \ is in compliance with [RFC6775].\n"
- title: 4.4.2.1.  Prefix Assignment Considerations
  contents:
  - "4.4.2.1.  Prefix Assignment Considerations\n   As stated by [RFC6775], an ABR\
    \ is responsible for managing\n   prefix(es).  Global routable prefixes may change\
    \ over time.  It is\n   RECOMMENDED that a ULA prefix is assigned to the 6LoWPAN\
    \ subnet to\n   facilitate stable site-local application associations based on\
    \ IPv6\n   addresses.  A node MAY support the M flag of the RA message.  This\n\
    \   influences the way IPv6 addresses are assigned.  Refer to Section 2.1\n  \
    \ for details.\n"
- title: 4.4.2.2.  Robust and Efficient CID Management
  contents:
  - "4.4.2.2.  Robust and Efficient CID Management\n   The 6LoWPAN Context Option\
    \ (6CO) is used according to [RFC6775] in an\n   RA to disseminate Context IDs\
    \ (CIDs) to use for compressing prefixes.\n   One or more prefixes and corresponding\
    \ Context IDs MUST be assigned\n   during initial node inclusion.\n   When updating\
    \ context information, a CID may have its lifetime set to\n   zero to obsolete\
    \ it.  The CID MUST NOT be reused immediately; rather,\n   the next vacant CID\
    \ should be assigned.  Header compression based on\n   CIDs MUST NOT be used for\
    \ RA messages carrying context information.\n   An expired CID and the associated\
    \ prefix MUST NOT be reset but rather\n   must be retained in receive-only mode\
    \ if there is no other current\n   need for the CID value.  This will allow an\
    \ ABR to detect if a\n   sleeping node without a clock uses an expired CID, and\
    \ in response,\n   the ABR MUST return an RA with fresh context information to\
    \ the\n   originator.\n"
- title: 4.4.2.3.  Infinite Prefix Lifetime Support for Island-Mode Networks
  contents:
  - "4.4.2.3.  Infinite Prefix Lifetime Support for Island-Mode Networks\n   Nodes\
    \ MUST renew the prefix and CID according to the lifetime\n   signaled by the\
    \ ABR.  [RFC6775] specifies that the maximum value of\n   the RA Router Lifetime\
    \ field MAY be up to 0xFFFF.  This document\n   further specifies that the value\
    \ 0xFFFF MUST be interpreted as\n   infinite lifetime.  This value MUST NOT be\
    \ used by ABRs.  Its use is\n   only intended for a sleeping network controller\
    \ -- for instance, a\n   battery-powered remote control being master for a small\
    \ island-mode\n   network of light modules.\n"
- title: 5.  Header Compression
  contents:
  - "5.  Header Compression\n   IPv6 header compression [RFC6282] MUST be implemented,\
    \ and GHC\n   [RFC7400] compression for higher layers MAY be implemented.  This\n\
    \   section will simply identify substitutions that should be made when\n   interpreting\
    \ the text of [RFC6282] and [RFC7400].\n   In general, the following substitutions\
    \ should be made:\n   o  Replace \"802.15.4\" with \"G.9959\".\n   o  Replace\
    \ \"802.15.4 short address\" with \"<Interface><G.9959\n      NodeID>\".\n   o\
    \  Replace \"802.15.4 PAN ID\" with \"G.9959 HomeID\".\n   When a 16-bit address\
    \ is called for (i.e., an IEEE 802.15.4 \"short\n   address\"), it MUST be formed\
    \ by prepending an Interface label byte to\n   the G.9959 NodeID:\n          \
    \            0                   1\n                      0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5\n                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      \
    \               |   Interface   |    NodeID     |\n                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   A transmitting node may be sending to an IPv6 destination address\n   that\
    \ can be reconstructed from the link-layer destination address.\n   If the Interface\
    \ number is zero (the default value), all IPv6 address\n   bytes may be elided.\
    \  Likewise, the Interface number of a fully\n   elided IPv6 address (i.e., SAM/DAM=11)\
    \ may be reconstructed to the\n   value zero by a receiving node.\n   64-bit 802.15.4\
    \ address details do not apply.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   The method of derivation of Interface Identifiers\
    \ from 8-bit NodeIDs\n   preserves uniqueness within the network.  However, there\
    \ is no\n   protection from duplication through forgery.  Neighbor Discovery in\n\
    \   G.9959 links may be susceptible to threats as detailed in [RFC3756].\n   G.9959\
    \ networks may feature mesh routing.  This implies additional\n   threats due\
    \ to ad hoc routing as per [KW03].  G.9959 provides\n   capability for link-layer\
    \ security.  G.9959 nodes MUST use link-layer\n   security with a shared key.\
    \  Doing so will alleviate the majority of\n   threats stated above.  A sizable\
    \ portion of G.9959 devices is\n   expected to always communicate within their\
    \ PAN (i.e., within their\n   subnet, in IPv6 terms).  In response to cost and\
    \ power consumption\n   considerations, these devices will typically implement\
    \ the minimum\n   set of features necessary.  Accordingly, security for such devices\n\
    \   may rely on the mechanisms defined at the link layer by G.9959.\n   G.9959\
    \ relies on the Advanced Encryption Standard (AES) for\n   authentication and\
    \ encryption of G.9959 frames and further employs\n   challenge-response handshaking\
    \ to prevent replay attacks.\n   It is also expected that some G.9959 devices\
    \ (e.g., billing and/or\n   safety-critical products) will implement coordination\
    \ or integration\n   functions.  These may communicate regularly with IPv6 peers\
    \ outside\n   the subnet.  Such IPv6 devices are expected to secure their end-to-\n\
    \   end communications with standard security mechanisms (e.g., IPsec,\n   Transport\
    \ Layer Security (TLS), etc.).\n"
- title: 7.  Privacy Considerations
  contents:
  - "7.  Privacy Considerations\n   IP addresses may be used to track devices on the\
    \ Internet; such\n   devices can in turn be linked to individuals and their activities.\n\
    \   Depending on the application and the actual use pattern, this may be\n   undesirable.\
    \  To impede tracking, globally unique and non-changing\n   characteristics of\
    \ IP addresses should be avoided, e.g., by\n   frequently changing the global\
    \ prefix and avoiding unique link-layer-\n   derived IIDs in addresses.\n   Some\
    \ link layers use a 48-bit or 64-bit link-layer address that\n   uniquely identifies\
    \ the node on a global scale, regardless of global\n   prefix changes.  The risk\
    \ of exposing a G.9959 device from its\n   link-layer-derived IID is limited because\
    \ of the short 8-bit\n   link-layer address.\n   While intended for central address\
    \ management, DHCPv6 address\n   assignment also decouples the IPv6 address from\
    \ the link-layer\n   address.  Addresses may be made dynamic by the use of a short\
    \ DHCP\n   lease period and an assignment policy that makes the DHCP server hand\n\
    \   out a fresh IP address every time.  For enhanced privacy, the\n   DHCP-assigned\
    \ addresses should be logged only for the duration of the\n   lease, provided\
    \ the implementation also allows logging for longer\n   durations as per the operational\
    \ policies.\n   It should be noted that privacy and frequently changing address\n\
    \   assignments come at a cost.  Non-link-layer-derived IIDs require the\n   use\
    \ of address registration.  Further, non-link-layer-derived IIDs\n   cannot be\
    \ compressed; this leads to longer datagrams and increased\n   link-layer segmentation.\
    \  Finally, frequent prefix changes\n   necessitate more Context Identifier updates;\
    \ this not only leads to\n   increased traffic but also may affect the battery\
    \ lifetime of\n   sleeping nodes.\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.  Normative References
  contents:
  - "8.1.  Normative References\n   [G.9959]   International Telecommunication Union,\
    \ \"Short range\n              narrow-band digital radiocommunication transceivers\
    \ - PHY\n              and MAC layer specifications\", ITU-T Recommendation\n\
    \              G.9959, January 2015,\n              <http://www.itu.int/rec/T-REC-G.9959>.\n\
    \   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n        \
    \      Requirement Levels\", BCP 14, RFC 2119, March 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC2460]  Deering, S. and R. Hinden, \"Internet Protocol, Version 6\n   \
    \           (IPv6) Specification\", RFC 2460, December 1998,\n              <http://www.rfc-editor.org/info/rfc2460>.\n\
    \   [RFC4122]  Leach, P., Mealling, M., and R. Salz, \"A Universally\n       \
    \       Unique IDentifier (UUID) URN Namespace\", RFC 4122,\n              July\
    \ 2005, <http://www.rfc-editor.org/info/rfc4122>.\n   [RFC4193]  Hinden, R. and\
    \ B. Haberman, \"Unique Local IPv6 Unicast\n              Addresses\", RFC 4193,\
    \ October 2005,\n              <http://www.rfc-editor.org/info/rfc4193>.\n   [RFC4291]\
    \  Hinden, R. and S. Deering, \"IP Version 6 Addressing\n              Architecture\"\
    , RFC 4291, February 2006,\n              <http://www.rfc-editor.org/info/rfc4291>.\n\
    \   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,\n      \
    \        \"Neighbor Discovery for IP version 6 (IPv6)\", RFC 4861,\n         \
    \     September 2007, <http://www.rfc-editor.org/info/rfc4861>.\n   [RFC4944]\
    \  Montenegro, G., Kushalnagar, N., Hui, J., and D. Culler,\n              \"\
    Transmission of IPv6 Packets over IEEE 802.15.4\n              Networks\", RFC\
    \ 4944, September 2007,\n              <http://www.rfc-editor.org/info/rfc4944>.\n\
    \   [RFC6282]  Hui, J. and P. Thubert, \"Compression Format for IPv6\n       \
    \       Datagrams over IEEE 802.15.4-Based Networks\", RFC 6282,\n           \
    \   September 2011, <http://www.rfc-editor.org/info/rfc6282>.\n   [RFC6355]  Narten,\
    \ T. and J. Johnson, \"Definition of the UUID-Based\n              DHCPv6 Unique\
    \ Identifier (DUID-UUID)\", RFC 6355,\n              August 2011, <http://www.rfc-editor.org/info/rfc6355>.\n\
    \   [RFC6775]  Shelby, Z., Chakrabarti, S., Nordmark, E., and C. Bormann,\n  \
    \            \"Neighbor Discovery Optimization for IPv6 over Low-Power\n     \
    \         Wireless Personal Area Networks (6LoWPANs)\", RFC 6775,\n          \
    \    November 2012, <http://www.rfc-editor.org/info/rfc6775>.\n   [RFC7400]  Bormann,\
    \ C., \"6LoWPAN-GHC: Generic Header Compression for\n              IPv6 over Low-Power\
    \ Wireless Personal Area Networks\n              (6LoWPANs)\", RFC 7400, November\
    \ 2014,\n              <http://www.rfc-editor.org/info/rfc7400>.\n"
- title: 8.2.  Informative References
  contents:
  - "8.2.  Informative References\n   [EUI64]    IEEE, \"Guidelines for 64-bit Global\
    \ Identifier\n              (EUI-64TM)\", November 2012, <http://standards.ieee.org/\n\
    \              regauth/oui/tutorials/EUI64.html>.\n   [KW03]     Karlof, C. and\
    \ D. Wagner, \"Secure Routing in Sensor\n              Networks: Attacks and Countermeasures\"\
    , Elsevier Ad Hoc\n              Networks Journal, Special Issue on Sensor Network\n\
    \              Applications and Protocols, vol. 1, issues 2-3,\n             \
    \ September 2003.\n   [RFC3315]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins,\
    \ C.,\n              and M. Carney, \"Dynamic Host Configuration Protocol for\n\
    \              IPv6 (DHCPv6)\", RFC 3315, July 2003,\n              <http://www.rfc-editor.org/info/rfc3315>.\n\
    \   [RFC3587]  Hinden, R., Deering, S., and E. Nordmark, \"IPv6 Global\n     \
    \         Unicast Address Format\", RFC 3587, August 2003,\n              <http://www.rfc-editor.org/info/rfc3587>.\n\
    \   [RFC3756]  Nikander, P., Kempf, J., and E. Nordmark, \"IPv6 Neighbor\n   \
    \           Discovery (ND) Trust Models and Threats\", RFC 3756,\n           \
    \   May 2004, <http://www.rfc-editor.org/info/rfc3756>.\n   [RFC3819]  Karn, P.,\
    \ Bormann, C., Fairhurst, G., Grossman, D.,\n              Ludwig, R., Mahdavi,\
    \ J., Montenegro, G., Touch, J., and L.\n              Wood, \"Advice for Internet\
    \ Subnetwork Designers\", BCP 89,\n              RFC 3819, July 2004,\n      \
    \        <http://www.rfc-editor.org/info/rfc3819>.\n   [RFC6550]  Winter, T.,\
    \ Thubert, P., Brandt, A., Hui, J., Kelsey, R.,\n              Levis, P., Pister,\
    \ K., Struik, R., Vasseur, JP., and R.\n              Alexander, \"RPL: IPv6 Routing\
    \ Protocol for Low-Power and\n              Lossy Networks\", RFC 6550, March\
    \ 2012,\n              <http://www.rfc-editor.org/info/rfc6550>.\n   [RFC6997]\
    \  Goyal, M., Baccelli, E., Philipp, M., Brandt, A., and J.\n              Martocci,\
    \ \"Reactive Discovery of Point-to-Point Routes in\n              Low-Power and\
    \ Lossy Networks\", RFC 6997, August 2013,\n              <http://www.rfc-editor.org/info/rfc6997>.\n"
- title: Appendix A.  G.9959 6LoWPAN Datagram Example
  contents:
  - "Appendix A.  G.9959 6LoWPAN Datagram Example\n   This example outlines each individual\
    \ bit of a sample IPv6 UDP packet\n   arriving to a G.9959 node from a host in\
    \ the Internet via a PAN\n   border router.\n   In the G.9959 PAN, the complete\
    \ frame has the following fields.\n   G.9959:\n     +------+---------+----------+---+-----+----------...\n\
    \     |HomeID|SrcNodeID|FrmControl|Len|SeqNo|DestNodeID|\n     +------+---------+----------+---+-----+----------+-...\n\
    \   6LoWPAN:\n     ...+--------------+----------------+-----------------------...\n\
    \        |6LoWPAN CmdCls|6LoWPAN_IPHC Hdr|Compressed IPv6 headers|\n       ...-------------+----------------+-----------------------+-...\n\
    \   IPv6, TCP/UDP, App payload:\n       ...+-------------------------+------------+-----------+\n\
    \          |Uncompressed IPv6 headers|TCP/UDP/ICMP|App payload|\n         ...------------------------+------------+-----------+\n\
    \   The frame comes from the source IPv6 address\n   2001:0db8:ac10:ef01::ff:fe00:1206.\
    \  The source prefix\n   2001:0db8:ac10:ef01/64 is identified by the IPHC CID\
    \ = 3.\n   The frame is delivered in direct range from the gateway that has\n\
    \   source NodeID = 1.  The Interface Identifier (IID) ff:fe00:1206 is\n   recognized\
    \ as a link-layer-derived address and is compressed to the\n   16-bit value 0x1206.\n\
    \   The frame is sent to the destination IPv6 address\n   2001:0db8:27ef:42ca::ff:fe00:0004.\
    \  The destination prefix\n   2001:0db8:27ef:42ca/64 is identified by the IPHC\
    \ CID = 2.\n   The IID ff:fe00:0004 is recognized as a link-layer-derived address.\n\
    \   Thanks to the link-layer-derived addressing rules, the sender knows\n   that\
    \ this is to be sent to G.9959 NodeID = 4, targeting the IPv6\n   interface instance\
    \ number 0 (the default).\n   To reach the 6LoWPAN stack of the G.9959 node (skipping\
    \ the G.9959\n   header fields), the first octet must be the 6LoWPAN Command Class\n\
    \   (0x4F).\n        0\n        0 1 2 3 4 5 6 7 8\n       +-+-+-+-+-+-+-+-...\n\
    \       |     0x4F      |\n       +-+-+-+-+-+-+-+-+-...\n   The Dispatch Header\
    \ bits '011' advertise a compressed IPv6 header.\n        0                  \
    \ 1\n        0 1 2 3 4 5 6 7 8 9 0\n       +-+-+-+-+-+-+-+-+-+-+-...\n       |\
    \     0x4F      |0 1 1\n       +-+-+-+-+-+-+-+-+-+-+-+-...\n   The following bits\
    \ encode the first IPv6 header fields:\n   TF = '11'   : Traffic Class and Flow\
    \ Label are elided\n   NH = '1'    : Next Header is elided\n   HLIM = '10' : Hop\
    \ limit is 64\n         0                   1\n         0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n        |     0x4F \
    \     |0 1 1 1 1 1 1 0|\n        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n   CID\
    \ = '1'   : CI data follows the DAM field\n   SAC = '1'   : Src addr uses stateful,\
    \ context-based compression\n   SAM = '10'  : Use src CID and 16 bits for link-layer-derived\
    \ addr\n   M = '0'     : Dest addr is not a multicast addr\n   DAC = '1'   : Dest\
    \ addr uses stateful, context-based compression\n   DAM = '11'  : Use dest CID\
    \ and dest NodeID to link-layer-derived addr\n        0                   1  \
    \                 2\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3\n\
    \       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n       |     0x4F\
    \      |0 1 1 1 1 1 1 0|1 1 1 0 0 1 1 1|\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n\
    \   Address compression context identifiers:\n   SCI =  0x3\n   DCI =  0x2\n \
    \         2           3\n          4 5 6 7 8 9 0 1\n      ...+-+-+-+-+-+-+-+-...\n\
    \         |  0x3  |  0x2  |\n        ...+-+-+-+-+-+-+-+-...\n   IPv6 header fields:\n\
    \   (skipping \"version\" field)\n   (skipping \"Traffic Class\")\n   (skipping\
    \ \"flow label\")\n   (skipping \"payload length\")\n   IPv6 header address fields:\n\
    \   SrcIP = 0x1206 : Use SCI and 16 least significant bits of\n   link-layer-derived\
    \ address\n   (skipping DestIP ) - completely reconstructed from dest NodeID\n\
    \                        and DCI\n          2           3                   4\n\
    \          4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\n      ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n\
    \         |  0x3  |  0x2  |     0x12      |     0x06      |\n        ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n\
    \   Next Header encoding for the UDP header:\n   Dispatch = '11110': Next Header\
    \ dispatch code for UDP header\n   C =      '0'      : 16-bit checksum carried\
    \ inline\n   P =      '00'     : Both src port and dest port are carried in-line\n\
    \          4   5\n          8 9 0 1 2 3 4 5\n      ...+-+-+-+-+-+-+-+-...\n  \
    \       |1 1 1 1 0|0|0 0|\n        ...+-+-+-+-+-+-+-+-...\n UDP header fields:\n\
    \ src port  = 0x1234\n dest port = 0x5678\n     5       6                   7\
    \                   8\n     6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7\n ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n\
    \    |     0x12      |     0x34      |     0x56      |     0x78      |\n   ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-..\n\
    \ (skipping \"length\")\n checksum = ....  (actual checksum value depends on\n\
    \                   the actual UDP payload)\n                                1\n\
    \        8   9                   0\n        8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3\n\
    \    ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n       |         (UDP checksum) \
    \       |\n      ...+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...\n Add your own UDP payload\
    \ here...\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   Thanks to the authors of RFC 4944 and RFC 6282, and members\
    \ of the\n   IETF 6LoWPAN working group; this document borrows extensively from\n\
    \   their work.  Thanks to Erez Ben-Tovim, Erik Nordmark, Kerry Lynn,\n   Michael\
    \ Richardson, and Tommas Jess Christensen for useful comments.\n   Thanks to Carsten\
    \ Bormann for extensive feedback that improved this\n   document significantly.\
    \  Thanks to Brian Haberman for pointing out\n   unclear details.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Anders Brandt\n   Sigma Designs\n   Emdrupvej 26A, 1.\n\
    \   Copenhagen O  2100\n   Denmark\n   EMail: anders_brandt@sigmadesigns.com\n\
    \   Jakob Buron\n   Sigma Designs\n   Emdrupvej 26A, 1.\n   Copenhagen O  2100\n\
    \   Denmark\n   EMail: jakob_buron@sigmadesigns.com\n"
