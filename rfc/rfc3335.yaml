- title: __initial_text__
  contents:
  - "                     MIME-based Secure Peer-to-Peer\n              Business Data\
    \ Interchange over the Internet\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2002).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes how to exchange structured business data\n\
    \   securely using SMTP transport for Electronic Data Interchange, (EDI -\n  \
    \ either the American Standards Committee X12 or UN/EDIFACT, Electronic\n   Data\
    \ Interchange for Administration, Commerce and Transport), XML or\n   other data\
    \ used for business to business data interchange.  The data\n   is packaged using\
    \ standard MIME content-types.  Authentication and\n   privacy are obtained by\
    \ using Cryptographic Message Syntax (S/MIME)\n   or OpenPGP security body parts.\
    \  Authenticated acknowledgements make\n   use of multipart/signed replies to\
    \ the original SMTP message.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.0   Introduction .................................................3\n\
    \   2.0   Overview .....................................................4\n  \
    \ 2.1   Purpose of a Security Guideline for MIME EDI .................4\n   2.2\
    \   Definitions ..................................................4\n   2.2.1\
    \ Terms ........................................................4\n   2.2.2 The\
    \ Secure Transmission Loop .................................5\n   2.2.3 Definition\
    \ of Receipts .......................................5\n   2.3   Assumptions ..................................................6\n\
    \   2.3.1 EDI Process Assumptions ......................................6\n  \
    \ 2.3.2 Flexibility Assumptions ......................................7\n   3.0\
    \   Referenced RFCs and Their Contribution .......................8\n   3.1  \
    \ RFC 821 SMTP [7] .............................................8\n   3.2   RFC\
    \ 822 Text Message Format [3] ..............................8\n   3.3   RFC 1847\
    \ MIME Security Multiparts [6] ........................8\n   3.4   RFC 1892 Multipart/Report\
    \ [9] ................................8\n   3.5   RFC 1767 EDI Content [2] .....................................9\n\
    \   3.6   RFC 2015, 3156, 2440 PGP/MIME [4] ............................9\n  \
    \ 3.7   RFC 2045, 2046, and 2049 MIME [1] ............................9\n   3.8\
    \   RFC 2298 Message Disposition Notification [5] ................9\n   3.9  \
    \ RFC 2633 and 2630 S/MIME Version 3 Message Specifications [8] 9\n   4.0   Structure\
    \ of an EDI MIME Message - Applicability .............9\n   4.1   Introduction\
    \ .................................................9\n   4.2   Structure of an\
    \ EDI MIME Message - PGP/MIME .................10\n   4.2.1 No Encryption, No\
    \ Signature .................................10\n   4.2.2 No Encryption, Signature\
    \ ....................................10\n   4.2.3 Encryption, No Signature ....................................10\n\
    \   4.2.4 Encryption, Signature .......................................10\n  \
    \ 4.3   Structure of an EDI MIME Message - S/MIME ...................10\n   4.3.1\
    \ No encryption, No Signature..................................10\n   4.3.2 No\
    \ encryption, Signature ....................................10\n   4.3.3 Encryption,\
    \ No Signature ....................................11\n   4.3.4 Encryption, Signature\
    \ .......................................11\n   5.0   Receipts ....................................................11\n\
    \   5.1   Introduction ................................................11\n  \
    \ 5.2   Requesting a Signed Receipt .................................13\n   5.2.1\
    \ Additional Signed Receipt Considerations ....................16\n   5.3   Message\
    \ Disposition Notification Format .....................17\n   5.3.1 Message Disposition\
    \ Notification Extensions .................18\n   5.3.2 Disposition Mode, Type,\
    \ and Modifier Use ....................19\n   5.4   Message Disposition Notification\
    \ Processing .................21\n   5.4.1 Large File Processing .......................................21\n\
    \   5.4.2 Example .....................................................22\n  \
    \ 6.0   Public Key Certificate Handling .............................24\n   6.1\
    \   Near Term Approach ..........................................24\n   6.2  \
    \ Long Term Approach ..........................................24\n   7.0   Security\
    \ Considerations .....................................25\n   8.0   Acknowledgments\
    \ .............................................26\n   9.0   References ..................................................26\n\
    \   Appendix IANA Registration Form ...................................28\n  \
    \ Authors' Addresses ................................................28\n   Full\
    \ Copyright Statement ..........................................29\n"
- title: 1.0 Introduction
  contents:
  - "1.0 Introduction\n   Previous work on Internet EDI focused on specifying MIME\
    \ content\n   types for EDI data ([2] RFC 1767).  This document expands on RFC\
    \ 1767\n   to specify use of a comprehensive set of data security features,\n\
    \   specifically data privacy, data integrity/authenticity, non-\n   repudiation\
    \ of origin and non-repudiation of receipt.  This document\n   also recognizes\
    \ contemporary RFCs and is attempting to \"re-invent\" as\n   little as possible.\
    \  While this document focuses specifically on EDI\n   data, any other data type\
    \ is also supported.\n   With an enhancement in the area of \"receipts\", as described\
    \ below\n   (5.2), secure Internet MIME based EDI can be accomplished by using\n\
    \   and complying with the following RFCs:\n      -RFC 821 SMTP\n      -RFC 822\
    \ Text Message Formats\n      -RFC 1767 EDI Content Type\n      -RFC 1847 Security\
    \ Multiparts for MIME\n      -RFC 1892 Multipart/Report\n      -RFC 2015, 3156,\
    \ 2440 MIME/PGP\n      -RFC 2045 to 2049 MIME RFCs\n      -RFC 2298 Message Disposition\
    \ Notification\n      -RFC 2630, 2633 S/MIME v3 Specification\n   Our intent here\
    \ is to define clearly and precisely how these are used\n   together, and what\
    \ is required by user agents to be compliant with\n   this document.\n   The key\
    \ words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"\
    SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n\
    \   document are to be interpreted as described in RFC 2119.\n"
- title: 2.0 Overview
  contents:
  - '2.0 Overview

    '
- title: 2.1 Purpose of a Security Guideline for MIME EDI
  contents:
  - "2.1 Purpose of a Security Guideline for MIME EDI\n   The purpose of these specifications\
    \ is to ensure interoperability\n   between EDI user agents, invoking some or\
    \ all of the commonly\n   expected security features.  This document is also NOT\
    \ limited to\n   strict EDI use, but applies to any electronic commerce application\n\
    \   where business data needs to be exchanged over the Internet in a\n   secure\
    \ manner.\n"
- title: 2.2 Definitions
  contents:
  - '2.2 Definitions

    '
- title: 2.2.1 Terms
  contents:
  - "2.2.1 Terms\n   EDI                  Electronic Data Interchange\n   EC     \
    \              Electronic Commerce\n   Receipt              The functional message\
    \ that is sent from a\n                        receiver to a sender to acknowledge\n\
    \                        receipt of an EDI/EC interchange.\n   Signed Receipt\
    \       Same as above, but with a digital\n                        signature.\n\
    \   Message Disposition  The Internet messaging format used to\n   Notification\
    \         convey a receipt.  This term is used\n                        interchangeably\
    \ with receipt.  A signed\n                        MDN is a signed receipt.\n\
    \   Non-repudiation of   NRR is a \"legal event\" that occurs when\n   Receipt\
    \ (NRR)        the original sender of an EDI/EC\n                        interchange\
    \ has verified the signed\n                        receipt coming back from the\
    \ receiver.\n                        NRR IS NOT a functional or a technical\n\
    \                        message.\n   PGP/MIME             Digital envelope security\
    \ based on the\n                        Pretty Good Privacy (PGP) standard\n \
    \                       (Zimmerman), integrated with MIME Security\n         \
    \               Multiparts [6].\n   S/MIME               A format and protocol\
    \ for adding\n                        Cryptographic signature and/or encryption\n\
    \                        services to Internet MIME messages.\n"
- title: 2.2.2 The secure transmission loop
  contents:
  - "2.2.2 The secure transmission loop\n   This document's focus is on the formats\
    \ and protocols for exchanging\n   EDI content that has had security applied to\
    \ it using the Internet's\n   messaging environment.\n   The \"secure transmission\
    \ loop\" for EDI involves one organization\n   sending a signed and encrypted\
    \ EDI interchange to another\n   organization, requesting a signed receipt, followed\
    \ later by the\n   receiving organization sending this signed receipt back to\
    \ the\n   sending organization.  In other words, the following transpires:\n \
    \    -The organization sending EDI/EC data signs and encrypts the data\n     \
    \ using either PGP/MIME or S/MIME.  In addition, the message will\n      request\
    \ a signed receipt to be returned to the sender of the\n      message.\n     -The\
    \ receiving organization decrypts the message and verifies the\n      signature,\
    \ resulting in verified integrity of the data and\n      authenticity of the sender.\n\
    \     -The receiving organization then returns a signed receipt to the\n     \
    \ sending organization in the form of a message disposition\n      notification\
    \ message.  This signed receipt will contain the hash\n      of the signature\
    \ from the received message, indicating to the\n      sender that the received\
    \ message was verified and/or decrypted\n      properly.\n   The above describes\
    \ functionality which, if implemented, would\n   satisfy all security requirements.\
    \  This specification, however,\n   leaves full flexibility for users to decide\
    \ the degree to which they\n   want to deploy those security features with their\
    \ trading partners.\n"
- title: 2.2.3 Definition of receipts
  contents:
  - "2.2.3 Definition of receipts\n   The term used for both the functional activity\
    \ and message for\n   acknowledging receipt of an EDI/EC interchange is receipt,\
    \ or signed\n   receipt.  The first term is used if the acknowledgment is for\
    \ an\n   interchange resulting in a receipt which is NOT signed.  The second\n\
    \   term is used if the acknowledgment is for an interchange resulting in\n  \
    \ a receipt which IS signed.  The method used to request a receipt or a\n   signed\
    \ receipt is defined in RFC 2298, \"An Extensible Message Format\n   for Message\
    \ Disposition Notifications\".\n   The \"rule\" is:\n     - If a receipt is requested,\
    \ explicitly specifying that the receipt\n       be signed, then the receipt MUST\
    \ be returned with a signature.\n     - If a receipt is requested, explicitly\
    \ specifying that the receipt\n       be signed, but the recipient cannot support\
    \ the requested\n       protocol format or requested MIC algorithms, then a receipt,\n\
    \       either signed or unsigned SHOULD  be returned.\n     - If a signature\
    \ is not explicitly requested, or if the signed\n       receipt request parameter\
    \ is not recognized by the UA, a receipt\n       may or may not be returned. \
    \ This behavior is consistent with the\n       MDN RFC 2298.\n   A term often\
    \ used in combination with receipts is \"Non-Repudiation of\n   Receipt (NRR).\
    \  NRR refers to a legal event which occurs only when\n   the original sender\
    \ of an interchange has verified the signed receipt\n   coming back from recipient\
    \ of the message.  Note that NRR is not\n   possible without signatures.\n"
- title: 2.3  Assumptions
  contents:
  - '2.3  Assumptions

    '
- title: 2.3.1 EDI Process Assumptions
  contents:
  - "2.3.1 EDI Process Assumptions\n   -Encrypted object is an EDI Interchange\n \
    \   This specification assumes that a typical EDI interchange is the\n    lowest\
    \ level object that will be subject to security services.\n    In ANSI X12, this\
    \ means anything between, and including segments ISA\n    and IEA.  In EDIFACT,\
    \ this means anything between, and including,\n    segments UNA/UNB and UNZ. \
    \ In other words, the EDI interchanges\n    including envelope segments remain\
    \ intact and unreadable during\n    secure transport.\n   -EDI envelope headers\
    \ are encrypted\n    Congruent with the above statement, EDI envelope headers\
    \ are NOT\n    visible in the MIME package.  In order to optimize routing from\n\
    \    existing commercial EDI networks (called Value Added Networks or\n    VANs)\
    \ to the Internet, work may need to be done in the future to\n    define ways\
    \ to pull out some of the envelope information to make\n    them visible; however,\
    \ this specification does not go into any\n    detail on this.\n   -X12.58 and\
    \ UN/EDIFACT security considerations\n    The most common EDI standards bodies,\
    \ ANSI X12 and EDIFACT, have\n    defined internal provisions for security.  X12.58\
    \ is the security\n    mechanism for ANSI X12 and AUTACK provides security for\
    \ EDIFACT.\n    This specification DOES NOT dictate use or non-use of these security\n\
    \    standards.  They are both fully compatible, though possibly\n    redundant,\
    \ with this specification.\n"
- title: 2.3.2 Flexibility Assumptions
  contents:
  - "2.3.2 Flexibility Assumptions\n   -Encrypted or unencrypted data\n    This specification\
    \ allows for EDI message exchange where the EDI\n    data can either be un-protected\
    \ or protected by means of encryption.\n   -Signed or unsigned data\n    This\
    \ specification allows for EDI message exchange with or without\n    digital signature\
    \ of the original EDI transmission.\n   -Use of receipt or not\n    This specification\
    \ allows for EDI message transmission with or\n    without a request for receipt\
    \ notification.  If a signed receipt\n    notification  is requested however,\
    \ a mic value is REQUIRED as part\n    of the returned receipt, unless an error\
    \ condition occurs in which a\n    mic value cannot be returned.  In error cases,\
    \ an un-signed receipt\n    or MDN SHOULD be returned with the correct \"disposition\
    \ modifier\"\n    error value.\n   -Formatting choices\n    This specification\
    \ defines the use of two methods for formatting EDI\n    contents that have security\
    \ applied to it:\n    -PGP/MIME\n    -S/MIME\n    This specification relies on\
    \ the guidelines set forth in RFC\n    2015/3156/2440, as reflected in [4] \"\
    MIME Security with Pretty Good\n    Privacy\" (PGP); OpenPGP Message Format, and\
    \ RFC 2633/2630 [8]\n    \"S/MIME Version 3 Message Specification; Cryptographic\
    \ Message\n    Syntax\".  PGP/MIME or S/MIME as defined in this Applicability\n\
    \    statement.\n   -Hash function, message digest choices\n    When a signature\
    \ is used, it is RECOMMENDED that the SHA1 hash\n    algorithm be used for all\
    \ outgoing messages, and that both MD5 and\n    SHA1 be supported for incoming\
    \ messages.\n    In summary, the following eight permutations are possible in\
    \ any\n    given trading relationship:\n    (1) Sender sends unencrypted data,\
    \ does NOT request a receipt.\n    (2) Sender sends unencrypted data, requests\
    \ a signed or unsigned\n        receipt.  The receiver sends back the signed or\
    \ unsigned\n        receipt.\n    (3) Sender sends encrypted data, does NOT request\
    \ a receipt.\n    (4) Sender sends encrypted data, requests a signed or unsigned\n\
    \        receipt.  The receiver sends back the signed or unsigned\n        receipt.\n\
    \    (5) Sender sends signed data, does NOT request a signed or unsigned\n   \
    \     receipt.\n    (6) Sender sends signed data, requests a signed or unsigned\
    \ receipt.\n        Receiver sends back the signed or unsigned receipt.\n    (7)\
    \ Sender sends encrypted and signed data, does NOT request a\n        signed or\
    \ unsigned receipt.\n    (8) Sender sends encrypted and signed data, requests\
    \ a signed or\n        unsigned receipt.  Receiver sends back the signed or unsigned\n\
    \        receipt.\n   NOTE: Users can choose any of the eight possibilities, but\
    \ only\n   example (8), when a signed receipt is requested, offers the whole\n\
    \   suite of security features described in the \"Secure transmission\n   loop\"\
    \ above.\n"
- title: 3.0 Referenced RFCs and Their Contribution
  contents:
  - '3.0 Referenced RFCs and Their Contribution

    '
- title: 3.1 RFC 821 SMTP [7]
  contents:
  - "3.1 RFC 821 SMTP [7]\n   This is the core mail transfer standard that all MTAs\
    \ need to adhere\n   to.\n"
- title: 3.2 RFC 822 Text Message Format [3]
  contents:
  - "3.2 RFC 822 Text Message Format [3]\n   Defines message header fields and the\
    \ parts making up a message.\n"
- title: 3.3 RFC 1847 MIME Security Multiparts [6]
  contents:
  - "3.3 RFC 1847 MIME Security Multiparts [6]\n   This document defines security\
    \ multiparts for MIME:\n   multipart/encrypted and multipart/signed.\n"
- title: 3.4 RFC 1892 Multipart/report [9]
  contents:
  - "3.4 RFC 1892 Multipart/report [9]\n   This RFC defines the use of the multipart/report\
    \ content type,\n   something that the MDN RFC 2298 builds upon.\n"
- title: 3.5 RFC 1767 EDI Content [2]
  contents:
  - "3.5 RFC 1767 EDI Content [2]\n   This RFC defines the use of content type \"\
    application\" for ANSI X12\n   (application/EDI-X12), EDIFACT (application/EDIFACT)\
    \ and mutually\n   defined EDI (application/EDI-Consent).\n"
- title: 3.6 RFC 2015, 3156, 2440 PGP/MIME [4]
  contents:
  - "3.6 RFC 2015, 3156, 2440 PGP/MIME [4]\n   These RFCs define the use of content\
    \ types \"multipart/encrypted\",\n   \"multipart/signed\", \"application/pgp encrypted\"\
    \ and\n   \"application/pgp-signature\" for defining MIME PGP content.\n"
- title: 3.7 RFC 2045, 2046, and 2049 MIME [1]
  contents:
  - "3.7 RFC 2045, 2046, and 2049 MIME [1]\n   These are the basic MIME standards,\
    \ upon which all MIME related RFCs\n   build, including this one.  Key contributions\
    \ include definition of\n   \"content type\", \"sub-type\" and \"multipart\",\
    \ as well as encoding\n   guidelines, which establishes 7-bit US-ASCII as the\
    \ canonical\n   character set to be used in Internet messaging.\n"
- title: 3.8 RFC 2298 Message Disposition Notification [5]
  contents:
  - "3.8 RFC 2298 Message Disposition Notification [5]\n   This Internet RFC defines\
    \ how a message disposition notification\n   (MDN) is requested, and the format\
    \ and syntax of the MDN.  The MDN is\n   the basis upon which receipts and signed\
    \ receipts are defined in this\n   specification.\n"
- title: 3.9 RFC 2633 and 2630 S/MIME Version 3 Message Specifications [8]
  contents:
  - "3.9 RFC 2633 and 2630 S/MIME Version 3 Message Specifications [8]\n   This specification\
    \ describes how MIME shall carry CMS Objects.\n"
- title: 4.0 Structure of an EDI MIME Message - Applicability
  contents:
  - '4.0 Structure of an EDI MIME Message - Applicability

    '
- title: 4.1 Introduction
  contents:
  - "4.1 Introduction\n   The structures below are described hierarchically in terms\
    \ of which\n   RFC's are applied to form the specific structure.  For details\
    \ of how\n   to code in compliance with all RFC's involved, turn directly to the\n\
    \   RFC's referenced.\n   Also, these structures describe the initial transmission\
    \ only.\n   Receipts, and requests for receipts are handled in section 5.\n"
- title: 4.2 Structure of an EDI MIME Message - PGP/MIME
  contents:
  - '4.2 Structure of an EDI MIME Message - PGP/MIME

    '
- title: 4.2.1 No Encryption, No Signature
  contents:
  - "4.2.1 No Encryption, No Signature\n   -RFC822/2045\n     -RFC1767 (application/EDIxxxx\
    \ or /xml)\n"
- title: 4.2.2 No Encryption, Signature
  contents:
  - "4.2.2 No Encryption, Signature\n   -RFC822/2045\n     -RFC1847 (multipart/signed)\n\
    \       -RFC1767 (application/EDIxxxx or /xml)\n       -RFC2015/2440/3156 (application/pgp-signature)\n"
- title: 4.2.3 Encryption, No Signature
  contents:
  - "4.2.3 Encryption, No Signature\n   -RFC822/2045\n     -RFC1847 (multipart/encrypted)\n\
    \       -RFC2015/2440/3156 (application/pgp-encrypted)\n         -\"Version: 1\"\
    \n       -RFC2015/2440/3156 (application/octet-stream)\n         -RFC1767 (application/EDIxxxx\
    \ or /xml) (encrypted)\n"
- title: 4.2.4 Encryption, Signature
  contents:
  - "4.2.4 Encryption, Signature\n   -RFC822/2045\n     -RFC1847 (multipart/encrypted)\n\
    \       -RFC2015/2440/3156 (application/pgp-encrypted)\n         -\"Version: 1\"\
    \n       -RFC2015/2440/3156 (application/octet-stream)\n         -RFC1847 (multipart/signed)(encrypted)\n\
    \           -RFC1767 (application/EDIxxxx or /xml)(encrypted)\n           -RFC2015/2440/3156\
    \ (application/pgp-signature)(encrypted)\n"
- title: 4.3 Structure of an EDI MIME Message - S/MIME
  contents:
  - '4.3 Structure of an EDI MIME Message - S/MIME

    '
- title: 4.3.1 No Encryption, No Signature
  contents:
  - "4.3.1 No Encryption, No Signature\n   -RFC822/2045\n     -RFC1767 (application/EDIxxxx\
    \ or /xml)\n"
- title: 4.3.2 No Encryption, Signature
  contents:
  - "4.3.2 No Encryption, Signature\n   -RFC822/2045\n     -RFC1847 (multipart/signed)\n\
    \       -RFC1767 (application/EDIxxxx or /xml)\n       -RFC2633 (application/pkcs7-signature)\n"
- title: 4.3.3 Encryption, No Signature
  contents:
  - "4.3.3 Encryption, No Signature\n   -RFC822/2045\n     -RFC2633 (application/pkcs7-mime)\n\
    \       -RFC1767 (application/EDIxxxx or /xml) (encrypted)\n"
- title: 4.3.4 Encryption, Signature
  contents:
  - "4.3.4 Encryption, Signature\n   -RFC822/2045\n     -RFC2633 (application/pkcs7-mime)\n\
    \       -RFC1847 (multipart/signed) (encrypted)\n         -RFC1767 (application/EDIxxxx\
    \ or /xml) (encrypted)\n         -RFC2633 (application/pkcs7-signature) (encrypted)\n"
- title: 5.0 Receipts
  contents:
  - '5.0 Receipts

    '
- title: 5.1 Introduction
  contents:
  - "5.1 Introduction\n   In order to support non-repudiation of receipt (NRR), a\
    \ signed\n   receipt, based on digitally signing a message disposition\n   notification,\
    \ is to be implemented by a receiving trading partner's\n   UA (User Agent). \
    \ The message disposition notification, specified by\n   RFC 2298 is digitally\
    \ signed by a receiving trading partner as part\n   of a multipart/signed MIME\
    \ message.\n   The following support for signed receipts is REQUIRED:\n   1) The\
    \ ability to create a multipart/report; where the report-type =\n      disposition-notification.\n\
    \   2) The ability to calculate a message integrity check (MIC) on the\n     \
    \ received message.  The calculated MIC value will be returned to\n      the sender\
    \ of the message inside the signed receipt.\n   4) The ability to create a multipart/signed\
    \ content with the message\n      disposition notification as the first body part,\
    \ and the signature\n      as the second body part.\n   5) The ability to return\
    \ the signed receipt to the sending trading\n      partner.\n   The signed receipt\
    \ is used to notify a sending trading partner that\n   requested the signed receipt\
    \ that:\n   1) The receiving trading partner acknowledges receipt of the sent\
    \ EDI\n      Interchange.\n   2) If the sent message was signed, then the receiving\
    \ trading partner\n      has authenticated the sender of the EDI Interchange.\n\
    \   3) If the sent message was signed, then the receiving trading partner\n  \
    \    has verified the integrity of the sent EDI Interchange.\n   Regardless of\
    \ whether the EDI Interchange was sent in S/MIME or\n   PGP/MIME format, the receiving\
    \ trading partner's UA MUST provide the\n   following basic processing:\n   1)\
    \ If the sent EDI Interchange is encrypted, then the encrypted\n      symmetric\
    \ key and initialization vector (if applicable) is\n      decrypted using the\
    \ receiver's private key.\n   2) The decrypted symmetric encryption key is then\
    \ used to decrypt the\n      EDI Interchange.\n   3) The receiving trading partner\
    \ authenticates signatures in a\n      message using the sender's public key.\
    \  The authentication\n      algorithm performs the following:\n      a) The message\
    \ integrity check (MIC or Message Digest), is\n         decrypted using the sender's\
    \ public key.\n      b) A MIC on the signed contents (the MIME header and encoded\
    \ EDI\n         object, as per RFC 1767) in the message received is calculated\n\
    \         using the same one-way hash function that the sending trading\n    \
    \     partner used.\n      c) The MIC extracted from the message that was sent,\
    \ and the MIC\n         calculated using the same one-way hash function that the\n\
    \         sending trading partner used is compared for equality.\n   4) The receiving\
    \ trading partner formats the MDN and sets the\n      calculated MIC into the\
    \ \"Received-content-MIC\" extension field.\n   5) The receiving trading partner\
    \ creates a multipart/signed MIME\n      message according to RFC 1847.\n   6)\
    \ The MDN is the first part of the multipart/signed message, and the\n      digital\
    \ signature is created over this MDN, including its MIME\n      headers.\n   7)\
    \ The second part of the multipart/signed message contains the\n      digital\
    \ signature.  The \"protocol\" option specified in the second\n      part of the\
    \ multipart/signed is as follows:\n      S/MIME: protocol = \"application/pkcs-7-signature\"\
    \n      PGP/MIME: protocol = \"application/pgp-signature\"\n   8) The signature\
    \ information is formatted according to S/MIME or\n      PGP/MIME specifications.\n\
    \   The EDI Interchange and the RFC 1767 MIME EDI content header, can\n   actually\
    \ be part of a multi-part MIME content-type.  When the EDI\n   Interchange is\
    \ part of a multi-part MIME content-type, the MIC MUST\n   be calculated across\
    \ the entire multi-part content, including the\n   MIME headers.\n   The signed\
    \ MDN, when received by the sender of the EDI Interchange\n   can be used by the\
    \ sender:\n   1) As an acknowledgment that the EDI Interchange sent, was delivered\n\
    \      and acknowledged by the receiving trading partner.  The receiver\n    \
    \  does this by returning the original message id of the sent message\n      in\
    \ the MDN portion of the signed receipt.\n   2) As an acknowledgment that the\
    \ integrity of the EDI Interchange was\n      verified by the receiving trading\
    \ partner.  The receiver does this\n      by returning the calculated MIC of the\
    \ received EDI Interchange\n      (and 1767 MIME headers) in the \"Received-content-MIC\"\
    \ field of the\n      signed MDN.\n   3) As an acknowledgment that the receiving\
    \ trading partner has\n      authenticated the sender of the EDI Interchange.\n\
    \   4) As a non-repudiation of receipt when the signed MDN is\n      successfully\
    \ verified by the sender with the receiving trading\n      partner's public key\
    \ and the returned mic value inside the MDN is\n      the same as the digest of\
    \ the original message.\n"
- title: 5.2 Requesting a Signed Receipt
  contents:
  - "5.2 Requesting a Signed Receipt\n   Message Disposition Notifications are requested\
    \ as per RFC 2298,\n   \"An Extensible Message Format for Message Disposition\
    \ Notification\".\n   A request that the receiving user agent issue a message\
    \ disposition\n   notification is made by placing the following header into the\
    \ message\n   to be sent:\n   MDN-request-header = \"Disposition-notification-to\"\
    \ \":\"\n                         mail-address\n   The mail-address field is specified\
    \ as an RFC 822 user@domain\n   address, and is the return address for the message\
    \ disposition\n   notification.\n   In addition to requesting a message disposition\
    \ notification, a\n   message disposition notification that is digitally signed,\
    \ or what\n   has been referred to as a signed receipt, can be requested by placing\n\
    \   the following in the message header following the \"Disposition-\n   Notification-To\"\
    \ line.\n   Disposition-notification-options =\n         \"Disposition-Notification-Options\"\
    \ \":\"\n         disposition-notification-parameters\n   where\n     disposition-notification-parameters\
    \ =\n                       parameter *(\";\" parameter)\n   where\n     parameter\
    \ = attribute \"=\" importance \", \" 1#value\"\n   where\n     importance = \"\
    required\" | \"optional\"\n   So the Disposition-notification-options string could\
    \ be:\n     signed-receipt-protocol=optional, <protocol symbol>;\n     signed-receipt-micalg=optional,\
    \ <micalg1>, <micalg2>,...;\n   The currently supported values for <protocol symbol>\
    \ are\n   \"pkcs7-signature\", for the S/MIME detached signature format, or\n\
    \   \"pgp-signature\", for the pgp signature format.\n   The currently supported\
    \ values for MIC algorithm values are:\n   Algorithm   Value\n   used\n   MD5\
    \         md5\n   SHA-1       sha1\n   (Historical Note:  Some early implementations\
    \ of EDIINT emitted and\n   expected \"rsa-md5\" and \"rsa-sha1\" for the micalg\
    \ parameter.)\n   Receiving agents SHOULD be able to recover gracefully from a\
    \ micalg\n   parameter value that they do not recognize.\n   An example of a formatted\
    \ options line would be as follows:\n   Disposition-notification-options:\n  \
    \   signed-receipt-protocol=optional, pkcs7-signature;\n     signed-receipt-micalg=optional,\
    \ sha1, md5\n   The semantics of the \"signed-receipt-protocol\" parameter is\
    \ as\n   follows:\n   1) The \"signed-receipt-protocol\" parameter is used to\
    \ request a\n      signed receipt from the recipient trading partner.  The\n \
    \     \"signed-receipt-protocol\" parameter also specifies the format in\n   \
    \   which the signed receipt should be returned to the requester.\n      The \"\
    signed-receipt-micalg\" parameter is a list of MIC algorithms\n      preferred\
    \ by the requester for use in signing the returned\n      receipt.  The list of\
    \ MIC algorithms should be honored by the\n      recipient from left to right.\n\
    \      Both the \"signed-receipt-protocol\" and the \"signed-receipt-micalg\"\n\
    \      option parameters are REQUIRED when requesting a signed receipt.\n   2)\
    \ The \"importance\" attribute of \"Optional\" is defined in the MDN RFC\n   \
    \   2298 and has the following meaning:\n      Parameters with an importance of\
    \ \"Optional\" permit a UA that does\n      not understand the particular options\
    \ parameter to still generate\n      a MDN in response to a request for a MDN.\
    \  A UA that does not\n      understand the \"signed-receipt-protocol\" parameter,\
    \ or the\n      \"signed-receipt-micalg\" will obviously not return a signed\n\
    \      receipt.\n      The importance of \"Optional\" is used for the signed receipt\n\
    \      parameters because it is RECOMMENDED that an MDN be returned to\n     \
    \ the requesting trading partner even if the recipient could not\n      sign it.\n\
    \      The returned MDN will contain information on the disposition of\n     \
    \ the message as well as why the MDN could not be signed.  See the\n      Disposition\
    \ field in section 5.3 for more information.\n      Within an EDI trading relationship,\
    \ if a signed receipt is\n      expected and is not returned, then the validity\
    \ of the transaction\n      is up to the trading partners to resolve.  In general,\
    \ if a signed\n      receipt is required in the trading relationship and is not\n\
    \      received, the transaction will likely not be considered valid.\n"
- title: 5.2.1 Additional Signed Receipt Considerations
  contents:
  - "5.2.1 Additional Signed Receipt Considerations\n   The \"rules\" stated in Section\
    \ 2.2.3 for signed receipts are as\n   follows:\n   1) When a receipt is requested,\
    \ explicitly specifying that the\n      receipt be signed, then the receipt MUST\
    \ be returned with a\n      signature.\n   2) When a receipt is requested, explicitly\
    \ specifying that the\n      receipt be signed, but the recipient cannot support\
    \ either the\n      requested protocol format, or requested MIC algorithms, then\n\
    \      either a signed or unsigned receipt SHOULD be returned.\n   3) When a signature\
    \ is not explicitly requested, or if the signed\n      receipt request parameter\
    \ is not recognized by the UA, then no\n      receipt, an unsigned receipt, or\
    \ a signed receipt MAY be returned\n      by the recipient.\n   NOTE: For Internet\
    \ EDI, it is RECOMMENDED that when a signature is\n   not explicitly requested,\
    \ or if parameters are not recognized, that\n   the UA send back at a minimum,\
    \ an unsigned receipt.  If a signed\n   receipt however was always returned as\
    \ a policy, whether requested or\n   not, then any false unsigned receipts can\
    \ be repudiated.\n   When a request for a signed receipt is made, but there is\
    \ an error in\n   processing the contents of the message, a signed receipt MUST\
    \ still\n   be returned.  The request for a signed receipt SHALL still be\n  \
    \ honored, though the transaction itself may not be valid.  The reason\n   for\
    \ why the contents could not be processed MUST be set in the\n   \"disposition-field\"\
    .\n   When a request for a signed receipt is made, the\n   \"Received-content-MIC\"\
    \ MUST always be returned to the requester.\n   The\"Received-content-MIC\" MUST\
    \ be calculated as follows:\n   - For any signed messages, the MIC to be returned\
    \ is calculated on\n     the RFC1767 MIME header and content.  Canonicalization\
    \ as specified\n     in RFC 1848 MUST be performed before the MIC is calculated,\
    \ since\n     the sender requesting the signed receipt was also REQUIRED to\n\
    \     canonicalize.\n   - For encrypted, unsigned messages, the MIC to be returned\
    \ is\n     calculated on the decrypted RFC 1767 MIME header and content.  The\n\
    \     content after decryption MUST be canonicalized before the MIC is\n     calculated.\n\
    \   - For unsigned, unencrypted messages, the MIC MUST be calculated over\n  \
    \   the message contents prior to Content-Transfer-Encoding and without\n    \
    \ the MIME or any other RFC 822 headers, since these are sometimes\n     altered\
    \ or reordered by MTAs.\n"
- title: 5.3 Message Disposition Notification Format
  contents:
  - "5.3 Message Disposition Notification Format\n   The format of a message disposition\
    \ notification is specified in RFC\n   2298.  For use in Internet EDI, the following\
    \ format will be used:\n   - content-type - per RFC 1892 and the RFC 2298 specification\n\
    \   - reporting-ua-field - per RFC 2298 specification\n   - MDN-gateway-field\
    \ - per RFC 2298 specification\n   - original-recipient-field - per RFC 2298 specification\n\
    \   - final-recipient-field - per RFC 2298 specification\n   - original-message-id-field\
    \ - per RFC 2298 specification\n   - disposition-field  - the following \"disposition-mode\"\
    \ values SHOULD\n                          be used for Internet EDI:\n     \"\
    automatic-action\" - The disposition described by the disposition\n          \
    \                type was a result of an automatic action,\n                 \
    \         rather than an explicit instruction by the\n                       \
    \   user for this message.\n     \"manual-action\"    - The disposition described\
    \ by the disposition\n                          type was a result of an explicit\
    \ instruction\n                          by the user rather than some sort of\n\
    \                          automatically performed action.\n     \"MDN-sent-automatically\"\
    \ - The MDN was sent because the UA had\n                                previously\
    \ been configured to do so.\n     \"MDN-sent-manually\" - The user explicitly\
    \ gave permission for this\n                           particular MDN to be sent.\n\
    \                           \"MDN-sent-manually\" is meaningful with\n       \
    \                    \"manual-action\", but not with\n                       \
    \    \"automatic-action\".\n   - disposition-field - the following \"disposition-type\"\
    \ values SHOULD\n                         be used for Internet EDI:\n     \"processed\"\
    \ - The message has been processed in some manner (e.g.,\n                   printed,\
    \ faxed, forwarded, gatewayed) without being\n                   displayed to\
    \ the user.  The user may or may not see\n                   the message later.\n\
    \     \"failed\" -  A failure occurred that prevented the proper generation\n\
    \                 of an MDN.  More information about the cause of the\n      \
    \           failure may be contained in a Failure field.  The\n              \
    \   \"failed\" disposition type is not to be used for the\n                 situation\
    \ in which there is some problem in processing\n                 the message other\
    \ than interpreting the request for an\n                 MDN.  The \"processed\"\
    \ or other disposition type with\n                 appropriate disposition modifiers\
    \ is to be used in such\n                 situations.\n   - disposition-field\
    \ - the following \"disposition-modifier\" values\n                         SHOULD\
    \ be used for Internet EDI:\n     \"error\" -  An error of some sort occurred\
    \ that prevented successful\n                processing of the message.  Further\
    \ information is\n                contained in an Error field.\n     \"warning\"\
    \ - The message was successfully processed but some sort of\n                \
    \ exceptional condition occurred.  Further Information is\n                 contained\
    \ in a Warning field.\n"
- title: 5.3.1 Message Disposition Notification Extensions
  contents:
  - "5.3.1 Message Disposition Notification Extensions\n   The following \"extension\
    \ field\" will be added in order to support\n   signed receipts for RFC 1767 MIME\
    \ content type and multipart MIME\n   content types that include the RFC 1767\
    \ MIME content type.  The\n   extension field\" defined below follows the \"disposition-field\"\
    \ in the\n   MDN.\n   The \"Received-content-MIC\" extension field is set when\
    \ the integrity\n   of the received message is verified.  The MIC is the base64\
    \ encoded\n   quantity computed over the received message with a hash function.\n\
    \   For details of \"what\" the \"Received-content-MIC\" should be calculated\n\
    \   over, see Section 5.2.1.  The algorithm used to calculate the\n   \"Received-content-MIC\"\
    \ value MUST be the same as the \"micalg\" value\n   used by the sender in the\
    \ multipart/signed message.  When no\n   signature is received, or the mic-alg\
    \ parameter is not supported then\n   it is RECOMMENDED that the SHA1 algorithm\
    \ be used to calculate the\n   MIC on the received message or message contents.\n\
    \   This field is set only when the contents of the message are processed\n  \
    \ successfully.  This field is used in conjunction with the recipient's\n   signature\
    \ on the MDN in order for the sender to verify \"non-\n   repudiation of receipt\"\
    .\n   - extension field = \"Received-content-MIC\"  \":\"  MIC\n     where:\n\
    \     <MIC> = <base64MicValue> \",\" <micalg>\n     <base64MicValue> = the result\
    \ of one way hash function, base64\n                        encoded.\n     < micalg>\
    \ = the micalg value defined in RFC1847, an IANA\n                 registered\
    \ MIC algorithm ID token.\n"
- title: 5.3.2 Disposition Mode, Type, and Modifier Use
  contents:
  - "5.3.2 Disposition Mode, Type, and Modifier Use\n   Guidelines for use of the\
    \ \"disposition-mode\", \"disposition-type\", and\n   \"disposition-modifier\"\
    \ fields within Internet EDI are discussed in\n   this section.  The \"disposition-mode\"\
    , \"disposition-type', and\n   \"disposition-modifier' fields are described in\
    \ detail in RFC 2298.\n   The \"disposition-mode', \"disposition-type\" and \"\
    disposition-modifier\"\n   values SHOULD be used as follows:\n"
- title: 5.3.2.1 Successful Processing
  contents:
  - "5.3.2.1 Successful Processing\n   When the request for a receipt or signed receipt,\
    \ and the received\n   message contents are successfully processed by the receiving\
    \ EDI UA,\n   a receipt or MDN SHOULD be returned with the \"disposition-type\"\
    \ set\n   to there is no explicit way for a user to control the sending of the\n\
    \   MDN, then the first part of the \"disposition-mode\" should be set to\n  \
    \ \"automatic-action\".  When the MDN is being sent under user\n   configurable\
    \ control, then the first part of the \"disposition-mode\"\n   should be set to\
    \ \"manual-action\".  Since a request for a signed\n   receipt should always be\
    \ honored, the user MUST not be allowed to\n   configure the UA to not send a\
    \ signed receipt when the sender\n   requests one.\n   The second part of the\
    \ \"disposition-mode\" is set to \"MDN-sent-\n   manually\" if the user gave explicit\
    \ permission for the MDN to be\n   sent.  Again, the user MUST not be allowed\
    \ to explicitly refuse to\n   send a signed receipt when the sender requests one.\
    \  The second part\n   of the \"disposition-mode\" is set to \"MDN-sent-automatically\"\
    \ whenever\n   the EDI UA sends the MDN automatically, regardless of whether the\n\
    \   sending was under a user's, administrator's, or under software\n   control.\n\
    \   Since EDI content is generally handled automatically by the EDI UA, a\n  \
    \ request for a receipt or signed receipt will generally return the\n   following\
    \ in the \"disposition-field\":\n     Disposition: automatic-action/MDN-sent-automatically;\
    \ processed\n   Note this specification does not restrict the use of the\n   \"\
    disposition-mode\" to just automatic actions.  Manual actions are\n   valid as\
    \ long as it is kept in mind that a request for a signed\n   receipt MUST be honored.\n"
- title: 5.3.2.2 Unprocessed Content
  contents:
  - "5.3.2.2 Unprocessed Content\n   The request for a signed receipt requires the\
    \ use of two\n   \"disposition-notification-options\", which specify the protocol\
    \ format\n   of the returned signed receipt, and the MIC algorithm used to\n \
    \  calculate the mic over the message contents.  The \"disposition-field\"\n \
    \  values that should be used in the case where the message content is\n   being\
    \ rejected or ignored, for instance if the EDI UA determines that\n   a signed\
    \ receipt cannot be returned because it does not support the\n   requested protocol\
    \ format, so the EDI UA chooses not to process the\n   message contents itself,\
    \ should be specified in the MDN\n   \"disposition-field\" as follows:\n   Disposition:\
    \ \"disposition-mode\";\n     failed/Failure: unsupported format\n   The syntax\
    \ of the \"failed\" \"disposition-type\" is general, allowing\n   the sending\
    \ of any textual information along with the \"failed\"\n   \"disposition-type\"\
    .  For use in Internet EDI, the following \"failed\"\n   values are defined:\n\
    \   \"Failure: unsupported format\" \"Failure: unsupported MIC-algorithms\"\n"
- title: 5.3.2.3 Content Processing Errors
  contents:
  - "5.3.2.3 Content Processing Errors\n   When errors occur processing the received\
    \ message content, the\n   \"disposition-field\" should be set to the \"processed\"\
    \ \"disposition-\n   type\" value and the \"error\" \"disposition-modifier\" value.\
    \  For use in\n   Internet EDI, the following \"error\" \"disposition-modifier\"\
    \ values are\n   defined:\n   \"Error: decryption-failed\" - the receiver could\
    \ not decrypt the\n                                message contents.\n   \"Error:\
    \ authentication-failed\" - the receiver could not authenticate\n            \
    \                        the sender.\n   \"Error: integrity-check-failed\" - the\
    \ receiver could not verify\n                                     content integrity.\n\
    \   \"Error: unexpected-processing-error\" - a catch-all for any additional\n\
    \                                          processing errors.\n   An example of\
    \ how the \"disposition-field\" would look when content\n   processing errors\
    \ are detected is as follows:\n   Disposition: \"disposition-mode\";\n     processed/Error:\
    \ decryption-failed\n"
- title: 5.3.2.4 Content Processing Warnings
  contents:
  - "5.3.2.4 Content Processing Warnings\n   Situations arise in EDI where even if\
    \ a trading partner cannot be\n   authenticated correctly, the trading partners\
    \ still agree to continue\n   processing the EDI transactions.  Transaction reconciliation\
    \ is done\n   between the trading partners at a later time.  In the content\n\
    \   processing warning situations as described above, the \"disposition-\n   field\"\
    \ SHOULD be set to the \"processed\" \"disposition-type\" value, and\n   the \"\
    warning\" \"disposition-modifier\" value.  For use in Internet EDI,\n   the following\
    \ \"warning\" \"disposition-modifier\" values are defined:\n   \"Warning: authentication-failed,\
    \ processing continued\"\n   An example of how the \"disposition-field\" would\
    \ look when content\n   processing warnings are detected is as follows:\n   Disposition:\
    \ \"disposition-mode\"; processed/Warning:\n                 authentication-failed,\
    \ processing continued\n"
- title: 5.4 Message Disposition Notification Processing
  contents:
  - '5.4 Message Disposition Notification Processing

    '
- title: 5.4.1 Large File Processing
  contents:
  - "5.4.1 Large File Processing\n   Large EDI Interchanges sent via SMTP can be automatically\
    \ fragmented\n   by some message transfer agents.  A subtype of message/partial,\
    \ is\n   defined in RFC 2045 [1] to allow large objects to be delivered as\n \
    \  separate pieces of mail and to be automatically reassembled by the\n   receiving\
    \ user agent.  Using message/partial, can help alleviate\n   fragmentation of\
    \ large messages by different message transfer agents,\n   but does not completely\
    \ eliminate the problem.  It is still possible\n   that a piece of a partial message,\
    \ upon re-assembly, may prove to\n   contain a partial message as well.  This\
    \ is allowed by the Internet\n   standards, and it is the responsibility of the\
    \ user agent to\n   reassemble the fragmented pieces.\n   It is RECOMMENDED that\
    \ the size of the EDI Interchange sent via SMTP\n   be configurable so that if\
    \ fragmentation is needed, then\n   message/partial can be used to send the large\
    \ EDI Interchange in\n   smaller pieces.  RFC 2045 [1] defines the use of Content-Type:\n\
    \   message/partial.\n   Note: Support of the message/partial content type for\
    \ use in Internet\n   EDI is OPTIONAL and in the absence of knowledge that the\
    \ recipient\n   supports partial it SHOULD NOT be used.\n   The receiving UA is\
    \ required to re-assemble the original message\n   before sending the message\
    \ disposition notification to the original\n   sender of the message.  A message\
    \ disposition notification is used to\n   specify the disposition of the entire\
    \ message that was sent, and\n   should not be returned by a processing UA until\
    \ the entire message is\n   received, even if the received message requires re-assembling.\n"
- title: 5.4.2 Example
  contents:
  - "5.4.2 Example\n   The following is an example of a signed receipt returned by\
    \ a UA\n   after successfully processing a MIME EDI content type.  The sending\n\
    \   trading partner has requested a return signed receipt.\n   This example follows\
    \ the S/MIME application/pkcs-7-signature format.\n   NOTE: This example is provided\
    \ as an illustration only, and is not\n   considered part of the protocol specification.\
    \  If an example\n   conflicts with the protocol definitions specified above or\
    \ in the\n   other referenced RFCs, the example is wrong.\n        To: <recipient\
    \ email>\n        Subject:\n        From: <sender email>\n        Date: <date>\n\
    \        Mime-Version: 1.0\n        Content-Type: multipart/signed; boundary=\"\
    separator\";\n          micalg=sha1; protocol=\"application/pkcs7-signature\"\n\
    \        --separator\n      & Content-Type:  multipart/report; report-type=disposition\n\
    \      &   notification;  boundary=\"xxxxx\"\n      &\n      & --xxxxx\n     \
    \ & Content-Type: text/plain\n      &\n      & The message sent to Recipient <Recipient@cyclonesoftware.com>\n\
    \      & has been received, the EDI Interchange was successfully\n      & decrypted\
    \ and its integrity was verified.  In addition, the\n      & sender of the message,\
    \ Sender <Edi_Sender@cyclonesoftware.com>\n      & was authenticated as the originator\
    \ of the message.  There is\n      & no guarantee however that the EDI Interchange\
    \ was\n      & syntactically correct, or was received by the EDI\n      & application.\n\
    \      &\n      & --xxxxx\n      & Content-Type:  message/disposition-notification\n\
    \      &\n      & Reporting-UA: Interchange.cyclonesoftware.com (CI 2.2)\n   \
    \   & Original-Recipient: rfc822; Edi_Recipient@cyclonesoftware.com\n      & Final-Recipient:\
    \ rfc822;  Edi_Recipient@cyclonesoftware.com\n      & Original-Message-ID: <17759920005.12345@cyclonesoftware.com\
    \ >\n      & Disposition: automatic-action/MDN-sent-automatically; processed\n\
    \      & Received-content-MIC: Q2hlY2sgSW50XwdyaXRIQ, sha1\n      &\n      & --xxxxx\n\
    \      & Content-Type: message/rfc822\n      &\n      & To: <recipient email>\n\
    \      & Subject:\n      &\n      &  [additional header fields go here]\n    \
    \  &\n      & --xxxxx--\n        --separator\n        Content-Type: application/pkcs7-signature;\
    \ name=smime.p7s;\n        Content-Transfer-Encoding: base64\n        Content-Disposition:\
    \ attachment; filename=smime.p7s\n        MIIHygYJKoZIhvcNAQcDoIIHuzCCB7cCAQAxgfIwge8CAQAwg\n\
    \        ZgwgYMxFjAUBgNVBAMTDVRlcnJ5IEhhcmRpbmcxEDAOBgNVBA\n        oTB0NZQ0xPTkUxDDAKBgNVBAsTA04vQTEQMA4GA1UEBxMHU=\n\
    \      --separator--\n   Notes:\n   -The lines preceded with \"&\" is what the\
    \ signature is calculated\n    over.\n    (For details on how to prepare the multipart/signed\
    \ with protocol =\n    \"application/pkcs7-signature\" see the \"S/MIME Message\
    \ Specification,\n    PKCS Security Services for MIME\".)\n   Note: As specified\
    \ by RFC 1892 [9], returning the original or\n   portions of the original message\
    \ in the third body part of the\n   multipart/report is not required.  This is\
    \ an optional body part.  It\n   is RECOMMENDED that the received headers from\
    \ the original message be\n   placed in the third body part, as they can be helpful\
    \ in tracking\n   problems.\n   Also note that the textual first body part of\
    \ the multipart/report\n   can be used to include a more detailed explanation\
    \ of the error\n   conditions reported by the disposition headers.  The first\
    \ body part\n   of the multipart/report when used in this way, allows a person\
    \ to\n   better diagnose a problem in detail.\n"
- title: 6.0 Public Key Certificate Handling
  contents:
  - '6.0 Public Key Certificate Handling

    '
- title: 6.1 Near Term Approach
  contents:
  - "6.1 Near Term Approach\n   In the near term, the exchange of public keys and\
    \ certification of\n   these keys must be handled as part of the process of establishing\
    \ a\n   trading partnership.  The UA and/or EDI application interface must\n \
    \  maintain a database of public keys used for encryption or signatures,\n   in\
    \ addition to the mapping between EDI trading partner ID and RFC 822\n   [3] email\
    \ address.  The procedures for establishing a trading\n   partnership and configuring\
    \ the secure EDI messaging system might\n   vary among trading partners and software\
    \ packages.\n   For systems which make use of X.509 certificates, it is RECOMMENDED\n\
    \   that trading partners self-certify each other if an agreed upon\n   certification\
    \ authority is not used.  It is highly RECOMMENDED that\n   when trading partners\
    \ are using S/MIME, that they also exchange\n   public key certificates using\
    \ the recommendations specified in the\n   S/MIME Version 3 Message Specification.\
    \  The message formats and\n   S/MIME conformance requirements for certificate\
    \ exchange are\n   specified in this document.\n   This applicability statement\
    \ does NOT require the use of a\n   certification authority.  The use of a certification\
    \ authority is\n   therefore OPTIONAL.\n"
- title: 6.2 Long Term Approach
  contents:
  - "6.2 Long Term Approach\n   In the long term, additional Internet-EDI standards\
    \ may be developed\n   to simplify the process of establishing a trading partnership,\n\
    \   including the third party authentication of trading partners, as well\n  \
    \ as attributes of the trading relationship.\n"
- title: 7.0 Security Considerations
  contents:
  - "7.0 Security Considerations\n   This entire document is concerned with secure\
    \ transport of business\n   to business data, and considers both privacy and authentication\n\
    \   issues.\n   Extracted from S/MIME Version 2 Message Specification:\n   40-bit\
    \ encryption is considered weak by most cryptographers.  Using\n   weak cryptography\
    \ offers little actual security over sending plain\n   text.  However, other features\
    \ of S/MIME, such as the specification\n   of tripleDES or AES and the ability\
    \ to announce stronger\n   cryptographic capabilities to parties with whom you\
    \ communicate,\n   allow senders to create messages that use strong encryption.\
    \  Using\n   weak cryptography is never recommended unless the only alternative\
    \ is\n   no cryptography.  When feasible, sending and receiving agents should\n\
    \   inform senders and recipients the relative cryptographic strength of\n   messages.\n\
    \   Extracted from S/MIME Version 2 Certificate Handling:\n   When processing\
    \ certificates, there are many situations where the\n   processing might fail.\
    \  Because the processing may be done by a user\n   agent, a security gateway,\
    \ or other program, there is no single way\n   to handle such failures.  Just\
    \ because the methods to handle the\n   failures has not been listed, however,\
    \ the reader should not assume\n   that they are not important.  The opposite\
    \ is true:  if a certificate\n   is not provably valid and associated with the\
    \ message, the processing\n   software should take immediate and noticeable steps\
    \ to inform the end\n   user about it.\n   Some of the many places where signature\
    \ and certificate checking\n   might fail include:\n   - no certificate chain\
    \ leads to a trusted CA\n   - no ability to check the CRL for a certificate\n\
    \   - an invalid CRL was received\n   - the CRL being checked is expired\n   -\
    \ the certificate is expired\n   - the certificate has been revoked\n   There\
    \ are certainly other instances where a certificate may be\n   invalid, and it\
    \ is the responsibility of the processing software to\n   check them all thoroughly,\
    \ and to decide what to do if the check\n   fails.\n"
- title: 8.0 Acknowledgments
  contents:
  - "8.0 Acknowledgments\n   Many thanks go out to the previous authors of the MIME-based\
    \ Secure\n   EDI IETF Draft:  Mats Jansson.\n   The authors would like to extend\
    \ special thanks to Carl Hage, Jun\n   Ding, Dale Moberg, and Karen Rosenthal\
    \ for providing the team with\n   valuable, and very thorough feedback.  Without\
    \ participants like\n   those cited above, these efforts become hard to complete\
    \ in a way\n   useful to the users and implementers of the technology.\n   In\
    \ addition, the authors would like to thank Harald Alvestrand, Jim\n   Galvin,\
    \ and Roger Fajman for their guidance and input.\n"
- title: 9.0 References
  contents:
  - "9.0 References\n   [1]  Borenstein, N. and N. Freed, \"Multipurpose Internet\
    \ Mail\n        Extensions (MIME) Part One: Format of Internet Message Bodies\"\
    ,\n        RFC 2045, November 1996.\n        Borenstein, N. and N. Freed, \"Multipurpose\
    \ Internet Mail\n        Extensions (MIME) Part Two: Media Types\", RFC 2046,\
    \ November\n        1996.\n        Borenstein, N. and N. Freed, \"Multipurpose\
    \ Internet Mail\n        Extensions (MIME) Part Five: Conformance Criteria and\
    \ Examples\",\n        RFC 2049, November 1996.\n   [2]  Crocker, D., \"MIME Encapsulation\
    \ of EDI Objects\", RFC 1767,\n        March 1995.\n   [3]  Resnick, P., \"Internet\
    \ Message Format\", RFC 2822, April 2001.\n   [4]  Elkins, M., \"MIME Security\
    \ With Pretty Good Privacy (PGP)\", RFC\n        2015, October 1996.\n       \
    \ Callas, J., Donnerhacke, L., Finney, H. and R.Thayer \"OpenPGP\n        Message\
    \ Format\", RFC 2440, November 1998.\n        Elkins, M., Del Torto, D., Levien,\
    \ R. and T. Roessler \"MIME\n        Security with OpenPGP\", RFC 3156, August\
    \ 2001.\n   [5]  Fajman, R., \"An Extensible Message Format for Message\n    \
    \    Disposition Notifications\", RFC 2298, March 1998.\n   [6]  Galvin, J., Murphy,\
    \ S., Crocker, S. and N. Freed,  \"Security\n        Multiparts for MIME: Multipart/Signed\
    \ and Multipart/Encrypted\",\n        RFC 1847, October 1995.\n   [7]  Klensin,\
    \ J., \"Simple Mail Transfer Protocol\",  RFC 2821, April\n        1982.\n   [8]\
    \  Ramsdell, B., \"S/MIME Version 3 Message Specification;\n        Cryptographic\
    \ Message Syntax\", RFC 2633, June 1999.\n        Housley, R., \"Cryptographic\
    \ Message Syntax\", RFC 2630, June\n        1999.\n   [9]  Vaudreuil, G., \"The\
    \ Multipart/Report Content Type for the\n        Reporting of Mail System Administrative\
    \ Messages\", RFC 1892,\n        January 1996.\n"
- title: Appendix A IANA Registration Form
  contents:
  - 'Appendix IANA Registration Form

    '
- title: A.1 IANA registration of the signed-receipt-protocol content
  contents:
  - "A.1 IANA registration of the signed-receipt-protocol content\n    disposition\
    \ parameter\n      Parameter-name: signed-receipt-protocol\n      Syntax: See\
    \ section 5.2 of this document\n      Specification: See section 5.2 of this document\n"
- title: A.2 IANA registration of the signed-receipt-micalg content
  contents:
  - "A.2 IANA registration of the signed-receipt-micalg content\n    disposition parameter\n\
    \      Parameter-name: signed-receipt-micalg\n      Syntax: See section 5.2 of\
    \ this document\n      Specification: See section 5.2 of this document\n"
- title: A.3 IANA registration of the Received-content-MIC MDN extension
  contents:
  - "A.3 IANA registration of the Received-content-MIC MDN extension\n    field name\n\
    \      Extension field name: Received-content-MIC\n      Syntax: See section 5.3.1\
    \ of this document\n      Specification: See section 5.3.1 of this document\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Terry Harding\n   Cyclone Commerce\n   8388 E. Hartford\
    \ Drive\n   Scottsdale, Arizona 85255, USA\n   EMail: tharding@cyclonecommerce.com\n\
    \   Chuck Shih\n   Gartner Group\n   251 River Oaks Parkway\n   San Jose, CA 95134-1913\
    \ USA\n   EMail: chuck.shih@gartner.com\n   Rik Drummond\n   Drummond Group\n\
    \   P.O. Box 101567\n   Ft. Worth, TX 76105 USA\n   EMail: rik@drummondgroup.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2002).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.  v\
    \ This\n   document and the information contained herein is provided on an \"\
    AS\n   IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK\n\
    \   FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT\n  \
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL\n   NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY\n   OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
