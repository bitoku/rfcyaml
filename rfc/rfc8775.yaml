- contents:
  - '                  PIM Designated Router Load Balancing

    '
  title: __initial_text__
- contents:
  - "Abstract\n   On a multi-access network, one of the PIM-SM (PIM Sparse Mode)\n
    \  routers is elected as a Designated Router.  One of the\n   responsibilities
    of the Designated Router is to track local multicast\n   listeners and forward
    data to these listeners if the group is\n   operating in PIM-SM.  This document
    specifies a modification to the\n   PIM-SM protocol that allows more than one
    of the PIM-SM routers to\n   take on this responsibility so that the forwarding
    load can be\n   distributed among multiple routers.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    7841.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8775.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2020 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (https://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1.  Introduction\n   2.  Terminology\n   3.  Applicability\n
    \  4.  Functional Overview\n     4.1.  GDR Candidates\n   5.  Protocol Specification\n
    \    5.1.  Hash Mask and Hash Algorithm\n     5.2.  Modulo Hash Algorithm\n       5.2.1.
    \ Modulo Hash Algorithm Examples\n       5.2.2.  Limitations\n     5.3.  PIM Hello
    Options\n       5.3.1.  PIM DR Load-Balancing Capability (DRLB-Cap) Hello\n               Option\n
    \      5.3.2.  PIM DR Load-Balancing List (DRLB-List) Hello Option\n     5.4.
    \ PIM DR Operation\n     5.5.  PIM GDR Candidate Operation\n     5.6.  DRLB-List
    Hello Option Processing\n     5.7.  PIM Assert Modification\n     5.8.  Backward
    Compatibility\n   6.  Operational Considerations\n   7.  IANA Considerations\n
    \    7.1.  Initial Registry\n     7.2.  Assignment of New Hash Algorithms\n   8.
    \ Security Considerations\n   9.  References\n     9.1.  Normative References\n
    \    9.2.  Informative References\n   Acknowledgements\n   Authors' Addresses\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   On a multi-access LAN (such as an Ethernet) with one or
    more PIM-SM\n   (PIM Sparse Mode) [RFC7761] routers, one of the PIM-SM routers
    is\n   elected as a Designated Router (DR).  The PIM DR has two\n   responsibilities
    in the PIM-SM protocol.  For any active sources on a\n   LAN, the PIM DR is responsible
    for registering with the Rendezvous\n   Point (RP) if the group is operating in
    PIM-SM.  Also, the PIM DR is\n   responsible for tracking local multicast listeners
    and forwarding\n   data to these listeners if the group is operating in PIM-SM.\n
    \  Consider the following LAN in Figure 1:\n                             (core
    networks)\n                             R1    R2     R3\n                            (many
    receivers)\n                        Figure 1: LAN with Receivers\n   Assume R1
    is elected as the DR.  According to the PIM-SM protocol, R1\n   will be responsible
    for forwarding traffic to that LAN on behalf of\n   all local members.  In addition
    to keeping track of membership\n   reports, R1 is also responsible for initiating
    the creation of source\n   and/or shared trees towards the senders or the RPs.
    \ The membership\n   reports would be IGMP or Multicast Listener Discovery (MLD)
    messages.\n   This applies to any versions of the IGMP and MLD protocols.  The
    most\n   recent versions are IGMPv3 [RFC3376] and MLDv2 [RFC3810].\n   Having
    a single router acting as DR and being responsible for data-\n   plane forwarding
    leads to several issues.  One of the issues is that\n   the aggregated bandwidth
    will be limited to what R1 can handle with\n   regards to capacity of incoming
    links, the interface on the LAN, and\n   total forwarding capacity.  It is very
    common that a LAN consists of\n   switches that run IGMP/MLD or PIM snooping [RFC4541].
    \ This allows\n   the forwarding of multicast packets to be restricted only to
    segments\n   leading to receivers that have indicated their interest in multicast\n
    \  groups using either IGMP or MLD.  The emergence of the switched\n   Ethernet
    allows the aggregated bandwidth to exceed, sometimes by a\n   large number, that
    of a single link.  For example, let us modify\n   Figure 1 and introduce an Ethernet
    switch in Figure 2.\n                            (core networks)\n                            R1
    \   R2     R3\n                          +=gi1===gi2===gi3=+\n                          +=gi4===gi5===gi6=+\n
    \                           H1    H2     H3\n                     Figure 2: LAN
    with Ethernet Switch\n   Let us assume that each individual link is a Gigabit
    Ethernet.  Each\n   router (R1, R2, and R3) and the switch have enough forwarding\n
    \  capacity to handle hundreds of gigabits of data.\n   Let us further assume
    that each of the hosts requests 500 Mbps of\n   unique multicast data.  This totals
    to 1.5 Gbps of data, which is\n   less than what each switch or the combined uplink
    bandwidth across\n   the routers can handle, even under failure of a single router.\n
    \  On the other hand, the link between R1 and switch, via port gi1, can\n   only
    handle a throughput of 1 Gbps.  And if R1 is the only DR (the\n   PIM DR elected
    using the procedure defined by [RFC7761]), at least\n   500 Mbps worth of data
    will be lost because the only link that can be\n   used to draw the traffic from
    the routers to the switch is via gi1.\n   In other words, the entire network's
    throughput is limited by the\n   single connection between the PIM DR and the
    switch (or LAN, as in\n   Figure 1).\n   Another important issue is related to
    failover.  If R1 is the only\n   forwarder on a shared LAN, when R1 goes out of
    service, multicast\n   forwarding for the entire LAN has to be rebuilt by the
    newly elected\n   PIM DR.  However, if there were a way that allowed multiple
    routers\n   to forward to the LAN for different groups, failure of one of the\n
    \  routers would only lead to disruption to a subset of the flows,\n   therefore
    improving the overall resilience of the network.\n   This document specifies a
    modification to the PIM-SM protocol that\n   allows more than one of these routers,
    called Group Designated\n   Routers (GDRs), to be selected so that the forwarding
    load can be\n   distributed among a number of routers.\n"
  title: 1.  Introduction
- contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\",
    \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\",
    \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described
    in\n   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n   capitals,
    as shown here.\n   With respect to PIM-SM, this document follows the terminology
    that\n   has been defined in [RFC7761].\n   This document also introduces the
    following new acronyms:\n   GDR: Group Designated Router.  For each multicast
    flow, either a\n      (*,G) for Any-Source Multicast (ASM) or an (S,G) for Source-\n
    \     Specific Multicast (SSM) [RFC4607], a hash algorithm (described\n      below)
    is used to select one of the routers as a GDR.  The GDR is\n      responsible
    for initiating the forwarding tree building process\n      for the corresponding
    multicast flow.\n   GDR Candidate:  a router that has the potential to become
    a GDR.\n      There might be multiple GDR Candidates on a LAN, but only one can\n
    \     become the GDR for a specific multicast flow.\n"
  title: 2.  Terminology
- contents:
  - "3.  Applicability\n   The extension specified in this document applies to PIM-SM
    routers\n   acting as last-hop routers (there are directly connected receivers).\n
    \  It does not alter the behavior of a PIM DR or any other routers on\n   the
    first-hop network (directly connected sources).  This is because\n   the source
    tree is built using the IP address of the sender, not the\n   IP address of the
    PIM DR that sends PIM registers towards the RP.\n   The load balancing between
    first-hop routers can be achieved\n   naturally if an IGP provides equal cost
    multiple paths (which it\n   usually does in practice).  Also, distributing the
    load to do source\n   registration does not justify the additional complexity
    required to\n   support it.\n"
  title: 3.  Applicability
- contents:
  - "4.  Functional Overview\n   In the PIM DR election as defined in [RFC7761], when
    multiple routers\n   are connected to a multi-access LAN (for example, an Ethernet),
    one\n   of them is elected to act as PIM DR.  The PIM DR is responsible for\n
    \  sending local Join/Prune messages towards the RP or source.  In order\n   to
    elect the PIM DR, each PIM router on the LAN examines the received\n   PIM Hello
    messages and compares its own DR priority and IP address\n   with those of its
    neighbors.  The router with the highest DR priority\n   is the PIM DR.  If there
    are multiple such routers, their IP\n   addresses are used as the tiebreaker,
    as described in [RFC7761].\n   In order to share forwarding load among last-hop
    routers, besides the\n   normal PIM DR election, one or more GDRs are elected
    on the multi-\n   access LAN.  There is only one PIM DR on the multi-access LAN,
    but\n   there might be multiple GDR Candidates.\n   For each multicast flow, that
    is, (*,G) for ASM and (S,G) for SSM, a\n   hash algorithm (Section 5.1) is used
    to select one of the routers to\n   be the GDR.  The new DR Load-Balancing Capability
    (DRLB-Cap) PIM\n   Hello Option is used to announce the Capability, as well as
    the hash\n   algorithm type.  Routers with the new DRLB-Cap Option advertised
    in\n   their PIM Hello, using the same GDR election hash algorithm and the\n   same
    DR priority as the PIM DR, are considered as GDR Candidates.\n   Hash masks are
    defined for Source, Group, and RP, separately, in\n   order to handle PIM ASM/SSM.
    \ The masks, as well as a sorted list of\n   GDR Candidate addresses, are announced
    by the DR in a new DR Load-\n   Balancing List (DRLB-List) PIM Hello Option.\n
    \  A hash algorithm based on the announced Source, Group, or RP masks\n   allows
    one GDR to be assigned to a corresponding multicast state.\n   That GDR is responsible
    for initiating the creation of the multicast\n   forwarding tree for multicast
    traffic.\n"
  - contents:
    - "4.1.  GDR Candidates\n   GDR is the new concept introduced by this specification.
      \ GDR\n   Candidates are routers eligible for GDR election on the LAN.  To\n
      \  become a GDR Candidate, a router must have the same DR priority and\n   run
      the same GDR election hash algorithm as the DR on the LAN.\n   For example,
      assume there are 4 routers on the LAN: R1, R2, R3, and\n   R4, each announcing
      a DRLB-Cap Option.  R1, R2, and R3 have the same\n   DR priority, while R4's
      DR priority is less preferred.  In this\n   example, R4 will not be eligible
      for GDR election, because R4 will\n   not become a PIM DR unless all of R1,
      R2, and R3 go out of service.\n   Furthermore, assume router R1 wins the PIM
      DR election, R1 and R2\n   advertise the same hash algorithm for GDR election,
      while R3\n   advertises a different one.  In this case, only R1 and R2 will
      be\n   eligible for GDR election, while R3 will not.\n   As a DR, R1 will include
      its own Load-Balancing Hash Masks and the\n   identity of R1 and R2 (the GDR
      Candidates) in its DRLB-List Hello\n   Option.\n"
    title: 4.1.  GDR Candidates
  title: 4.  Functional Overview
- contents:
  - '5.  Protocol Specification

    '
  - contents:
    - "5.1.  Hash Mask and Hash Algorithm\n   A hash mask is used to extract a number
      of bits from the\n   corresponding IP address field (32 for IPv4, 128 for IPv6)
      and\n   calculate a hash value.  A hash value is used to select a GDR from\n
      \  GDR Candidates advertised by the PIM DR.  Hash masks allow for\n   certain
      flows to always be forwarded by the same GDR, by ignoring\n   certain bits in
      the hash value calculation, so that the hash values\n   are the same.  For example,
      0.0.255.0 defines a hash mask for an IPv4\n   address that masks the first,
      second, and fourth octets, which means\n   that only the third octet will influence
      the hash value computed.\n   Note that the masks need not be a contiguous set
      of bits.  For\n   example, for IPv4, 15.15.15.15 would be a valid mask.\n   In
      the text below, a hash mask is, in some places, said to be zero.\n   A hash
      mask is zero if no bits are set, that is, 0.0.0.0 for IPv4 and\n   :: for IPv6.
      \ Also, a hash mask is said to be an all-bits-set mask if\n   it is 255.255.255.255
      for IPv4 or\n   ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff for IPv6.\n   There
      are three hash masks defined:\n   *  RP Hash Mask\n   *  Source Hash Mask\n
      \  *  Group Hash Mask\n   The hash masks need to be configured on the PIM routers
      that can\n   potentially become a PIM DR, unless the implementation provides\n
      \  default hash mask values.  An implementation SHOULD have default hash\n   mask
      values as follows.  The default RP Hash Mask SHOULD be zero (no\n   bits set).
      \ The default Source and Group Hash Masks SHOULD both be\n   all-bits-set masks.
      \ These default values are likely acceptable for\n   most deployments and simplify
      configuration.  There is only a need to\n   use other masks if one needs to
      ensure that certain flows are\n   forwarded by the same GDR.\n   The DRLB-List
      Hello Option contains a list of GDR Candidates.  The\n   first one listed has
      ordinal number 0, the second listed ordinal\n   number 1, and the last one has
      ordinal number N - 1 if there are N\n   candidates listed.  The hash value computed
      will be the ordinal\n   number of the GDR Candidate that is acting as GDR for
      the flow in\n   question.\n   The input to be hashed is determined as follows:\n
      \  *  If the group is in ASM mode and the RP Hash Mask announced by the\n      PIM
      DR is not zero (at least one bit is set), calculate the value\n      of hashvalue_RP
      (Section 5.2) to determine the GDR.\n   *  If the group is in ASM mode and the
      RP Hash Mask announced by the\n      PIM DR is zero (no bits are set), obtain
      the value of\n      hashvalue_Group (Section 5.2) to determine the GDR.\n   *
      \ If the group is in SSM mode, use hashvalue_SG (Section 5.2) to\n      determine
      the GDR.\n   A simple modulo hash algorithm is defined in this document.  However,\n
      \  to allow another hash algorithm to be used, a 1-octet \"Hash\n   Algorithm\"
      field is included in the DRLB-Cap Hello Option to specify\n   the hash algorithm
      used by the router.\n   If different hash algorithms are advertised among the
      routers on a\n   LAN, only the routers advertising the same hash algorithm as
      the DR\n   (as well as having the same DR priority as the DR) are eligible for\n
      \  GDR election.\n"
    title: 5.1.  Hash Mask and Hash Algorithm
  - contents:
    - "5.2.  Modulo Hash Algorithm\n   As part of computing the hash, the notation
      LSZC(hash_mask) is used\n   to denote the number of zeroes counted from the
      least significant bit\n   of a hash mask hash_mask.  As an example, LSZC(255.255.128)
      is 7 and\n   LSZC(ffff:8000::) is 111.  If all bits are set, LSZC will be 0.
      \ If\n   the mask is zero, then LSZC will be 32 for IPv4 and 128 for IPv6.\n
      \  The number of GDR Candidates is denoted as GDRC.\n   The idea behind the
      modulo hash algorithm is, in simple terms, that\n   the corresponding mask is
      applied to a value, then the result is\n   shifted right LSZC(mask) bits so
      that the least significant bits that\n   were masked out are not considered.
      \ Then, this result is masked by\n   0xffffffff, keeping only the last 32 bits
      of the result (this only\n   makes a difference for IPv6).  Finally, the hash
      value is this result\n   modulo the number of GDR Candidates (GDRC).\n   The
      modulo hash algorithm, for computing the values hashvalue_RP,\n   hashvalue_Group,
      and hashvalue_SG, is defined as follows.\n   hashvalue_RP is calculated as:\n
      \     (((RP_address & RP_mask) >> LSZC(RP_mask)) & 0xffffffff) % GDRC\n      RP_address
      is the address of the RP defined for the group, and\n      RP_mask is the RP
      Hash Mask.\n   hashvalue_Group is calculated as:\n      (((Group_address & Group_mask)
      >> LSZC(Group_mask)) & 0xffffffff)\n      % GDRC\n      Group_address is the
      group address, and Group_mask is the Group\n      Hash Mask.\n   hashvalue_SG
      is calculated as:\n      ((((Source_address & Source_mask) >> LSZC(Source_mask))
      &\n      0xffffffff) ^ (((Group_address & Group_mask) >> LSZC(Group_mask))\n
      \     & 0xffffffff)) % GDRC\n      Group_address is the group address, and Group_mask
      is the Group\n      Hash Mask.\n"
    - contents:
      - "5.2.1.  Modulo Hash Algorithm Examples\n   To help illustrate the algorithm,
        consider this example.  Router X\n   with IPv4 address 203.0.113.1 receives
        a DRLB-List Hello Option from\n   the DR that announces RP Hash Mask 0.0.255.0
        and a list of GDR\n   Candidates, sorted by IP addresses from high to low:
        203.0.113.3,\n   203.0.113.2, and 203.0.113.1.  The ordinal number assigned
        to those\n   addresses would be:\n   0 for 203.0.113.3; 1 for 203.0.113.2;
        2 for 203.0.113.1 (Router X).\n   Assume there are 2 RPs: RP1 192.0.2.1 for
        Group1 and RP2 198.51.100.2\n   for Group2.  Following the modulo hash algorithm:\n
        \  *  LSZC(0.0.255.0) is 8, and GDRC is 3.  The hashvalue_RP for Group1\n
        \     with RP RP1 is:\n      (((192.0.2.1 & 0.0.255.0) >> 8) & 0xffffffff
        % 3)\n      = 2 % 3\n      = 2\n      This matches the ordinal number assigned
        to Router X.  Router X\n      will be the GDR for Group1.\n   *  The hashvalue_RP
        for Group2 with RP RP2 is:\n      (((198.51.100.2 & 0.0.255.0) >> 8) & 0xffffffff
        % 3)\n      = 100 % 3\n      = 1\n      This is different from the ordinal
        number of Router X (2).  Hence,\n      Router X will not be GDR for Group2.\n
        \  For IPv6, consider this example, similar to the above.  Router X with\n
        \  IPv6 address fe80::1 receives a DRLB-List Hello Option from the DR\n   that
        announces RP Hash Mask ::ffff:ffff:ffff:0 and a list of GDR\n   Candidates,
        sorted by IP addresses from high to low: fe80::3,\n   fe80::2, and fe80::1.
        \ The ordinal number assigned to those addresses\n   would be:\n      0 for
        fe80::3; 1 for fe80::2; 2 for fe80::1 (Router X).\n   Assume there are 2 RPs:
        RP1 2001:db8::1:0:5678:1 for Group1 and RP2\n   2001:db8::1:0:1234:2 for Group2.
        \ Following the modulo hash\n   algorithm:\n   *  LSZC(::ffff:ffff:ffff:0)
        is 16, and GDRC is 3.  The hashvalue_RP\n      for Group1 with RP RP1 is:\n
        \     (((2001:db8::1:0:5678:1 & ::ffff:ffff:ffff:0) >> 16) &\n       0xffffffff
        % 3)\n      = ((::1:0:5678:0 >> 16) & 0xffffffff % 3)\n      = (::1:0:5678
        & 0xffffffff % 3)\n      = ::5678 % 3\n      = 2\n      This matches the ordinal
        number assigned to Router X.  Router X\n      will be the GDR for Group1.\n
        \  *  The hashvalue_RP for Group2 with RP RP2 is:\n      (((2001:db8::1:0:1234:1
        & ::ffff:ffff:ffff:0) >> 16) &\n       0xffffffff % 3)\n      = ((::1:0:1234:0
        >> 16) & 0xffffffff % 3)\n      = (::1:0:1234 & 0xffffffff % 3)\n      = ::1234
        % 3\n      = 1\n      This is different from the ordinal number of Router
        X (2).  Hence,\n      Router X will not be GDR for Group2.\n"
      title: 5.2.1.  Modulo Hash Algorithm Examples
    - contents:
      - "5.2.2.  Limitations\n   The modulo hash algorithm has poor failover characteristics
        when a\n   shared LAN has more than two GDRs.  In the case of more than two
        GDRs\n   on a LAN, when one GDR fails, all of the groups may be reassigned
        to\n   a different GDR, even if they were not assigned to the failed GDR.\n
        \  However, many deployments use only two routers on a shared LAN for\n   redundancy
        purposes.  Future work may define new hash algorithms\n   where only groups
        assigned to the failed GDR get reassigned.\n   The modulo hash algorithm will
        use, at most, 32 consecutive bits of\n   the input addresses for its computation.
        \ Exactly which bits are used\n   of the source, group, or RP addresses depend
        on the respective masks.\n   This limitation may be an issue for IPv6 deployments,
        since not all\n   bits of the IPv6 addresses are considered.  If this causes\n
        \  operational issues, a new hash algorithm would need to be defined.\n"
      title: 5.2.2.  Limitations
    title: 5.2.  Modulo Hash Algorithm
  - contents:
    - "5.3.  PIM Hello Options\n   PIM routers include a new option, called \"Load-Balancing
      Capability\n   (DRLB-Cap)\", in their PIM Hello messages.\n   Besides this DRLB-Cap
      Hello Option, the elected PIM DR also includes\n   a new \"DR Load-Balancing
      List (DRLB-List) Hello Option\".  The DRLB-\n   List Hello Option consists of
      three hash masks, as defined above, and\n   also a list of GDR Candidate addresses
      on the LAN.  It is recommended\n   that the GDR Candidate addresses are sorted
      in descending order.\n   This ensures that when using algorithms, such as the
      modulo hash\n   algorithm in this document, that it is predictable which GDR
      is\n   responsible for which groups, regardless of the order the DR learned\n
      \  about the candidates.\n"
    - contents:
      - "5.3.1.  PIM DR Load-Balancing Capability (DRLB-Cap) Hello Option\n      0
        \                  1                   2                   3\n      0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     |           Type
        = 34           |         Length = 4            |\n     |                     Reserved
        \                 |Hash Algorithm |\n          Figure 3: PIM DR Load-Balancing
        Capability Hello Option\n   Type:  34\n   Length:  4\n   Reserved:  Transmitted
        as zero, ignored on receipt.\n   Hash Algorithm:  Hash algorithm type.  A
        value listed in the IANA\n      \"PIM Designated Router Load-Balancing Hash
        Algorithms\" registry. 0\n      is used for the hash algorithm defined in
        this document.\n   This DRLB-Cap Hello Option MUST be advertised by routers
        on all\n   interfaces where DR Load Balancing is enabled.  Note that the option\n
        \  is included, at most, once.\n"
      title: 5.3.1.  PIM DR Load-Balancing Capability (DRLB-Cap) Hello Option
    - contents:
      - "5.3.2.  PIM DR Load-Balancing List (DRLB-List) Hello Option\n      0                   1
        \                  2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2
        3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     |           Type = 35           |
        \        Length                |\n     |                    GDR Candidate
        Address(es)                  |\n             Figure 4: PIM DR Load-Balancing
        List Hello Option\n   Type:  35\n   Length:  (3 + n) x (4 or 16) bytes, where
        n is the number of GDR\n      Candidates.\n   Group Mask (32/128 bits):  Mask
        applied to group addresses as part of\n      hash computation.\n   Source
        Mask (32/128 bits):  Mask applied to source addresses as part\n      of hash
        computation.\n   RP Mask (32/128 bits):  Mask applied to RP addresses as part
        of hash\n      computation.\n   All masks MUST have the same number of bits
        as the IP source address\n   in the PIM Hello IP header.\n   GDR Candidate
        Address(es) (32/128 bits):  List of GDR Candidate(s)\n      All addresses
        MUST be in the same address family as the PIM Hello\n      IP header.  It
        is recommended that the addresses are sorted in\n      descending order.\n
        \     If the \"Interface ID\" option, as specified in [RFC6395], is\n      present
        in a GDR Candidate's PIM Hello message and the \"Router\n      Identifier\"
        portion is non-zero:\n      *  For IPv4, the \"GDR Candidate Address\" will
        be set directly to\n         the \"Router Identifier\".\n      *  For IPv6,
        the \"GDR Candidate Address\" will be 96 bits of\n         zeroes, followed
        by the 32 bit Router Identifier.\n      If the \"Interface ID\" option is
        not present in a GDR Candidate's\n      PIM Hello message or if the \"Interface
        ID\" option is present but\n      the \"Router Identifier\" field is zero,
        the \"GDR Candidate Address\"\n      will be the IPv4 or IPv6 source address
        of the PIM Hello message.\n      This DRLB-List Hello Option MUST only be
        advertised by the elected\n      PIM DR.  It MUST be ignored if received from
        a non-DR.  The option\n      MUST also be ignored if the hash masks are not
        the correct number\n      of bits or GDR Candidate addresses are in the wrong
        address\n      family.\n"
      title: 5.3.2.  PIM DR Load-Balancing List (DRLB-List) Hello Option
    title: 5.3.  PIM Hello Options
  - contents:
    - "5.4.  PIM DR Operation\n   The DR election process is still the same as defined
      in [RFC7761].\n   The DR advertises the new DRLB-List Hello Option, which contains
      mask\n   values from user configuration (or default values), followed by a\n
      \  list of GDR Candidate addresses.  Note that if a router included the\n   \"Interface
      ID\" option in the hello message and the Router ID is non-\n   zero, the Router
      ID will be used to form the GDR Candidate address of\n   the router, as discussed
      in the previous section.  It is recommended\n   that the list be sorted from
      the highest value to the lowest value.\n   The reason for sorting the list is
      to make the behavior\n   deterministic, regardless of the order in which the
      DR learns of new\n   candidates.  Note that, as for non-DR routers, the DR also
      advertises\n   the DRLB-Cap Hello Option to indicate its ability to support
      the new\n   functionality and the type of GDR election hash algorithm it uses.\n
      \  If a PIM DR receives a neighbor DRLB-Cap Hello Option that contains\n   the
      same hash algorithm as the DR and the neighbor has the same DR\n   priority
      as the DR, PIM DR SHOULD consider the neighbor as a GDR\n   Candidate and insert
      the GDR Candidate's Address into the list of the\n   DRLB-List Option.  However,
      the DR may have policies limiting which\n   or the number of GDR Candidates
      to include.  Likewise, the DR SHOULD\n   include itself in the list of GDR Candidates,
      but it is permissible\n   not to do so, for instance, if there is some policy
      restricting the\n   candidate set.\n   If a PIM neighbor included in the list
      expires, stops announcing the\n   DRLB-Cap Hello Option, changes DR priority,
      changes hash algorithm,\n   or otherwise becomes ineligible as a candidate,
      the DR SHOULD\n   immediately send a triggered hello with a new list in the
      DRLB-List\n   option, excluding the neighbor.\n   If a new router becomes eligible
      as a candidate, there is no urgency\n   in sending out an updated list.  An
      updated list SHOULD be included\n   in the next hello.\n"
    title: 5.4.  PIM DR Operation
  - contents:
    - "5.5.  PIM GDR Candidate Operation\n   When an IGMP/MLD report is received,
      a hash algorithm is used by the\n   GDR Candidates to determine which router
      is going to be responsible\n   for building forwarding trees on behalf of the
      host.\n   The router MUST include the DRLB-Cap Hello Option in all PIM Hello\n
      \  messages sent on the interface.  Note that the presence of the DRLB-\n   Cap
      Option in the PIM Hello does not guarantee that the router will\n   be considered
      as a GDR Candidate.  Once the DR election is done, the\n   DRLB-List Hello Option
      is received from the current PIM DR containing\n   a list of the selected GDR
      Candidates.\n   A router only acts as a GDR Candidate if it is included in the
      GDR\n   Candidate list of the DRLB-List Hello Option.  See next section for\n
      \  details.\n"
    title: 5.5.  PIM GDR Candidate Operation
  - contents:
    - "5.6.  DRLB-List Hello Option Processing\n   This section discusses processing
      of the DRLB-List Hello Option,\n   including the case where it was received
      in the previous hello but\n   not in the current hello.  All routers MUST ignore
      the DRLB-List\n   Hello Option if it is received from a PIM router that is not
      the DR.\n   The option MUST only be processed by routers that are announcing
      the\n   DRLB-Cap Option and only if the hash algorithm announced by the DR is\n
      \  the same as the local announcement.  All GDR Candidates MUST use the\n   hash
      masks advertised in the Option, even if they differ from those\n   the candidate
      was configured with.  The DR MUST also process its own\n   DRLB-List Hello Option.\n
      \  A router stores the latest option contents that were announced, if\n   any,
      and deletes the previous contents.  The router MUST also compare\n   the new
      contents with any previous contents and, if there are any\n   changes, continue
      processing as below.  Note that if the option does\n   not pass the above checks,
      the below processing MUST be done as if\n   the option was not announced.\n
      \  If the contents of the DRLB-List Option, the masks, or the candidate\n   list
      differ from the previously saved copy, it is received for the\n   first time,
      or it is no longer being received or accepted, the option\n   MUST be processed
      as below.\n   1.  If the local router is included in the \"GDR Candidate\n       Address(es)\"
      field, it will look for its own address, or if it\n       announces a non-zero
      Router ID, its own Router ID.  For each of\n       the groups or source and
      group pairs, if the group is in SSM mode\n       with local receiver interest,
      the router MUST run the hash\n       algorithm to determine which of them is
      for the GDR.\n       *  If there is no change in the GDR status, then no further\n
      \         action is required.\n       *  If the router becomes the new GDR,
      then a multicast forwarding\n          tree MUST be built [RFC7761].\n       *
      \ If the router is no longer the GDR, then it uses an Assert as\n          explained
      in Section 5.7.\n   2.  If one of the following occurs:\n       *  the local
      router is not included in the \"GDR Candidate\n          Address(es)\" field,\n
      \      *  the DRLB-List Hello Option is no longer included in the DR's\n          Hello,
      or\n       *  the DR's Neighbor Liveness Timer expires [RFC7761],\n       then
      for each group (or each source and group pair if the group\n       is in SSM
      mode) with local receiver interest, for which the\n       router is the GDR,
      the router uses an Assert as explained in\n       Section 5.7.\n"
    title: 5.6.  DRLB-List Hello Option Processing
  - contents:
    - "5.7.  PIM Assert Modification\n   GDR changes may occur due to configuration
      change, GDR Candidates\n   going down, and also new routers coming up and becoming
      GDR\n   Candidates.  This may occur while flows are being forwarded.  If the\n
      \  GDR for an active flow changes, there is likely to be some\n   disruption,
      such as packet loss or duplicates.  By using asserts,\n   packet loss is minimized
      while allowing a small amount of duplicates.\n   When a router stops acting
      as the GDR for a group, or source and\n   group pair if SSM, it MUST set the
      Assert metric preference to\n   maximum (0x7fffffff) and the Assert metric to
      one less than maximum\n   (0xfffffffe).  That is, whenever it sends or receives
      an Assert for\n   the group, it must use these values as the metric preference
      and\n   metric rather than the values provided by the unicast routing\n   protocol.\n
      \  The rest of this section is just for illustration purposes and not\n   part
      of the protocol definition.\n   To illustrate the behavior when there is a GDR
      change, consider the\n   following scenario where there are two flows: G1 and
      G2.  R1 is the\n   GDR for G1, and R2 is the GDR for G2.  When R3 comes up,
      it is\n   possible that R3 becomes GDR for both G1 and G2; hence, R3 starts
      to\n   build the forwarding tree for G1 and G2.  If R1 and R2 stop\n   forwarding
      before R3 completes the process, packet loss might occur.\n   On the other hand,
      if R1 and R2 continue forwarding while R3 is\n   building the forwarding trees,
      duplicates might occur.\n   When the role of GDR changes as above, instead of
      immediately\n   stopping forwarding, R1 and R2 continue forwarding to G1 and
      G2\n   respectively, while, at the same time, R3 build forwarding trees for\n
      \  G1 and G2.  This will lead to PIM Asserts.\n   For G1, using the functionality
      described in this document, R1 and R3\n   determine the new GDR, which is R3.
      \ With the modified Assert\n   behavior, R1 sets its Assert metric to the near
      maximum value, as\n   discussed above.  That will make R3, which has normal
      metric in its\n   Assert, the Assert winner.\n"
    title: 5.7.  PIM Assert Modification
  - contents:
    - "5.8.  Backward Compatibility\n   In the case of a hybrid Ethernet shared LAN
      (where some PIM routers\n   support the functionality defined in this document
      and some do not):\n   *  If the DR does not support the new functionality, then
      there will\n      be no load balancing.\n   *  If non-DR routers do not support
      the new functionality, they will\n      not be considered as GDR Candidate and
      will not take part in load\n      balancing.  Load balancing may still happen
      on the link.\n"
    title: 5.8.  Backward Compatibility
  title: 5.  Protocol Specification
- contents:
  - "6.  Operational Considerations\n   An administrator needs to consider what the
    total bandwidth\n   requirements are and find a set of routers that together have
    enough\n   available capacity while making sure that each of the routers can\n
    \  handle its part, assuming that the traffic is distributed roughly\n   equally
    among the routers.  Ideally, one should also have enough\n   bandwidth to handle
    the case where at least one router fails.  All\n   routers should have reachability
    to the sources and RPs, if\n   applicable, that are not via the LAN.\n   Care
    must be taken when choosing what hash masks to configure.  One\n   would typically
    configure the same masks on all the routers so that\n   they are the same, regardless
    of which router is elected as DR.  The\n   default masks are likely suitable for
    most deployment.  The RP Hash\n   Mask must be configured (the default is no bits
    set) if one wishes to\n   hash based on the RP address rather than the group address
    for ASM.\n   The default masks will use the entire group addresses, and source\n
    \  addresses if SSM, as part of the hash.  An administrator may set\n   other
    masks that mask out part of the addresses to ensure that\n   certain flows always
    get hashed to the same router.  How this is\n   achieved depends on how the group
    addresses are allocated.\n   Only the routers announcing the same hash algorithm
    as the DR would\n   be considered as GDR Candidates.  Network administrators need
    to make\n   sure that the desired set of routers announce the same algorithm.\n
    \  Migration between different algorithms is not considered in this\n   document.\n"
  title: 6.  Operational Considerations
- contents:
  - "7.  IANA Considerations\n   IANA has made these assignments in the \"PIM-Hello
    Options\" registry:\n   value 34 for the PIM DR Load-Balancing Capability (DRLB-Cap)
    Hello\n   Option (with Length of 4), and value 35 for the PIM DR Load-Balancing\n
    \  List (DRLB-List) Hello Option (with variable Length).\n   Per this document,
    IANA has created a registry called \"PIM Designated\n   Router Load-Balancing
    Hash Algorithms\" in the \"Protocol Independent\n   Multicast (PIM)\" branch of
    the registry tree.  The registry lists\n   hash algorithms for use by PIM Designated
    Router Load Balancing.\n"
  - contents:
    - "7.1.  Initial Registry\n   The initial content of the registry is as follows.\n
      \                   | Type  | Name       | Reference |\n                    |
      0     | Modulo     | RFC 8775  |\n                    | 1-255 | Unassigned |
      \          |\n"
    title: 7.1.  Initial Registry
  - contents:
    - "7.2.  Assignment of New Hash Algorithms\n   Assignment of new hash algorithms
      is done according to the \"IETF\n   Review\" procedure; see [RFC8126].\n"
    title: 7.2.  Assignment of New Hash Algorithms
  title: 7.  IANA Considerations
- contents:
  - "8.  Security Considerations\n   Security of the new DR Load-Balancing PIM Hello
    Options is only\n   guaranteed by the security of PIM Hello messages, so the security\n
    \  considerations for PIM Hello messages, as described in PIM-SM\n   [RFC7761],
    apply here.\n   If the DR is subverted, it could omit or add certain GDRs or announce\n
    \  an unsupported algorithm.  If another router is subverted, it could\n   be
    made DR and cause similar issues.  While these issues are specific\n   to this
    specification, they are not that different from existing\n   attacks, such as
    subverting a DR and lowering the DR priority,\n   causing a different router to
    become the DR.\n   If, for any reason, the DR includes a GDR in the announced
    list that\n   announces a different algorithm from what the DR announces, the
    GDR\n   is required to ignore the announcement, and there will be no router\n
    \  acting as the DR for the flows that hash to that GDR.\n   If a GDR is subverted,
    it could potentially be made to stop\n   forwarding all the traffic it is expected
    to forward.  This is also\n   similar today to if a DR is subverted.\n   An administrator
    may be able to achieve the desired load balancing of\n   known flows, but an attacker
    may send a single high rate flow that is\n   served by a single GDR or send multiple
    flows that are expected to be\n   hashed to the same GDR.\n"
  title: 8.  Security Considerations
- contents:
  - '9.  References

    '
  - contents:
    - "9.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use
      in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n
      \             DOI 10.17487/RFC2119, March 1997,\n              <https://www.rfc-editor.org/info/rfc2119>.\n
      \  [RFC6395]  Gulrajani, S. and S. Venaas, \"An Interface Identifier (ID)\n
      \             Hello Option for PIM\", RFC 6395, DOI 10.17487/RFC6395,\n              October
      2011, <https://www.rfc-editor.org/info/rfc6395>.\n   [RFC7761]  Fenner, B.,
      Handley, M., Holbrook, H., Kouvelas, I.,\n              Parekh, R., Zhang, Z.,
      and L. Zheng, \"Protocol Independent\n              Multicast - Sparse Mode
      (PIM-SM): Protocol Specification\n              (Revised)\", STD 83, RFC 7761,
      DOI 10.17487/RFC7761, March\n              2016, <https://www.rfc-editor.org/info/rfc7761>.\n
      \  [RFC8126]  Cotton, M., Leiba, B., and T. Narten, \"Guidelines for\n              Writing
      an IANA Considerations Section in RFCs\", BCP 26,\n              RFC 8126, DOI
      10.17487/RFC8126, June 2017,\n              <https://www.rfc-editor.org/info/rfc8126>.\n
      \  [RFC8174]  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in RFC\n              2119
      Key Words\", BCP 14, RFC 8174, DOI 10.17487/RFC8174,\n              May 2017,
      <https://www.rfc-editor.org/info/rfc8174>.\n"
    title: 9.1.  Normative References
  - contents:
    - "9.2.  Informative References\n   [RFC3376]  Cain, B., Deering, S., Kouvelas,
      I., Fenner, B., and A.\n              Thyagarajan, \"Internet Group Management
      Protocol, Version\n              3\", RFC 3376, DOI 10.17487/RFC3376, October
      2002,\n              <https://www.rfc-editor.org/info/rfc3376>.\n   [RFC3810]
      \ Vida, R., Ed. and L. Costa, Ed., \"Multicast Listener\n              Discovery
      Version 2 (MLDv2) for IPv6\", RFC 3810,\n              DOI 10.17487/RFC3810,
      June 2004,\n              <https://www.rfc-editor.org/info/rfc3810>.\n   [RFC4541]
      \ Christensen, M., Kimball, K., and F. Solensky,\n              \"Considerations
      for Internet Group Management Protocol\n              (IGMP) and Multicast Listener
      Discovery (MLD) Snooping\n              Switches\", RFC 4541, DOI 10.17487/RFC4541,
      May 2006,\n              <https://www.rfc-editor.org/info/rfc4541>.\n   [RFC4607]
      \ Holbrook, H. and B. Cain, \"Source-Specific Multicast for\n              IP\",
      RFC 4607, DOI 10.17487/RFC4607, August 2006,\n              <https://www.rfc-editor.org/info/rfc4607>.\n"
    title: 9.2.  Informative References
  title: 9.  References
- contents:
  - "Acknowledgements\n   The authors would like to thank Steve Simlo and Taki Millonis
    for\n   helping with the original idea; Alia Atlas, Bill Atwood, Joe Clarke,\n
    \  Alissa Cooper, Jake Holland, Bharat Joshi, Anish Kachinthaya, Anvitha\n   Kachinthaya,
    Benjamin Kaduk, Mirja K\xFChlewind, Barry Leiba, Ben Niven-\n   Jenkins, Alvaro
    Retana, Adam Roach, Michael Scharf, \xC9ric Vyncke, and\n   Carl Wallace for reviews
    and comments; and Toerless Eckert and\n   Rishabh Parekh for helpful conversation
    on the document.\n"
  title: Acknowledgements
- contents:
  - "Authors' Addresses\n   Yiqun Cai\n   Alibaba Group\n   520 Almanor Avenue\n   Sunnyvale,
    CA 94085\n   United States of America\n   Email: yiqun.cai@alibaba-inc.com\n   Heidi
    Ou\n   Alibaba Group\n   520 Almanor Avenue\n   Sunnyvale, CA 94085\n   United
    States of America\n   Email: heidi.ou@alibaba-inc.com\n   Sri Vallepalli\n   Email:
    vallepal@yahoo.com\n   Mankamana Mishra\n   Cisco Systems, Inc.\n   821 Alder
    Drive,\n   Milpitas, CA 95035\n   United States of America\n   Email: mankamis@cisco.com\n
    \  Stig Venaas\n   Cisco Systems, Inc.\n   Tasman Drive\n   San Jose, CA 95134\n
    \  United States of America\n   Email: stig@cisco.com\n   Andy Green\n   British
    Telecom\n   Adastral Park\n   Ipswich\n   IP5 2RE\n"
  title: Authors' Addresses
