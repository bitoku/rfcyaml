- title: __initial_text__
  contents:
  - '                 Authentication and Confidentiality in

    '
- title: Protocol Independent Multicast Sparse Mode (PIM-SM) Link-Local Messages
  contents:
  - 'Protocol Independent Multicast Sparse Mode (PIM-SM) Link-Local Messages

    '
- title: Abstract
  contents:
  - "Abstract\n   RFC 4601 mandates the use of IPsec to ensure authentication of the\n\
    \   link-local messages in the Protocol Independent Multicast - Sparse\n   Mode\
    \ (PIM-SM) routing protocol.  This document specifies mechanisms\n   to authenticate\
    \ the PIM-SM link-local messages using the IP security\n   (IPsec) Encapsulating\
    \ Security Payload (ESP) or (optionally) the\n   Authentication Header (AH). \
    \ It specifies optional mechanisms to\n   provide confidentiality using the ESP.\
    \  Manual keying is specified as\n   the mandatory and default group key management\
    \ solution.  To deal\n   with issues of scalability and security that exist with\
    \ manual\n   keying, optional support for an automated group key management\n\
    \   mechanism is provided.  However, the procedures for implementing\n   automated\
    \ group key management are left to other documents.  This\n   document updates\
    \ RFC 4601.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc5796.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. Goals and Non-Goals ........................................4\n  \
    \ 2. Terminology .....................................................5\n   3.\
    \ Transport Mode versus Tunnel Mode ...............................5\n   4. Authentication\
    \ ..................................................5\n   5. Confidentiality .................................................6\n\
    \   6. IPsec Requirements ..............................................6\n  \
    \ 7. Key Management ..................................................8\n    \
    \  7.1. Manual Key Management ......................................8\n      7.2.\
    \ Automated Key Management ...................................8\n      7.3. Communications\
    \ Patterns ....................................9\n      7.4. Neighbor Relationships\
    \ ....................................10\n   8. Number of Security Associations\
    \ ................................11\n   9. Rekeying .......................................................12\n\
    \      9.1. Manual Rekeying Procedure .................................13\n  \
    \    9.2. KeyRolloverInterval .......................................14\n    \
    \  9.3. Rekeying Interval .........................................14\n   10.\
    \ IPsec Protection Barrier and SPD/GSPD .........................14\n      10.1.\
    \ Manual Keying ............................................14\n           10.1.1.\
    \ SAD Entries .......................................14\n           10.1.2. SPD\
    \ Entries .......................................14\n      10.2. Automatic Keying\
    \ .........................................15\n           10.2.1. SAD Entries\
    \ .......................................15\n           10.2.2. GSPD Entries ......................................15\n\
    \           10.2.3. PAD Entries .......................................15\n  \
    \ 11. Security Association Lookup ...................................16\n   12.\
    \ Activating the Anti-Replay Mechanism ..........................16\n   13. Implementing\
    \ a Security Policy Database per Interface .........17\n   14. Extended Sequence\
    \ Number ......................................17\n   15. Security Considerations\
    \ .......................................18\n   16. Acknowledgements ..............................................18\n\
    \   17. References ....................................................19\n  \
    \    17.1. Normative References .....................................19\n    \
    \  17.2. Informative References ...................................19\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   All the PIM-SM [RFC4601] control messages have IP protocol\
    \ number\n   103.  Some control messages are unicast; the rest are multicast with\n\
    \   Time to Live (TTL) = 1.  The source address used for unicast messages\n  \
    \ is a domain-wide reachable address.  For the multicast messages, a\n   link-local\
    \ address of the interface on which the message is being\n   sent is used as the\
    \ source address and a special multicast address,\n   ALL_PIM_ROUTERS (224.0.0.13\
    \ in IPv4 and ff02::d in IPv6) is used as\n   the destination address.  These\
    \ messages are called link-local\n   messages.  Hello, Join/Prune, and Assert\
    \ messages are included in\n   this category.  A forged link-local message may\
    \ be sent to the\n   ALL_PIM_ROUTERS multicast address by an attacker.  This type\
    \ of\n   message affects the construction of the distribution tree [RFC4601].\n\
    \   The effects of these forged messages are outlined in Section 6.1 of\n   [RFC4601].\
    \  Some of the effects are very severe, whereas some are\n   minor.\n   PIM-SM\
    \ version 2 was originally specified in RFC 2117 [RFC2117], and\n   revised in\
    \ RFC 2362 [RFC2362] and RFC 4601.  RFC 4601 obsoletes RFC\n   2362, and corrects\
    \ a number of deficiencies.  The \"Security\n   Considerations\" section of RFC\
    \ 4601 is based primarily on the\n   Authentication Header (AH) specification\
    \ described in RFC 4302\n   [RFC4302].\n   Securing the unicast messages can be\
    \ achieved by the use of a normal\n   unicast IPsec Security Association (SA)\
    \ between the two communicants.\n   This document focuses on the security issues\
    \ for link-local messages.\n   It provides some guidelines to take advantage of\
    \ the new permitted AH\n   functionality in RFC 4302 and the new permitted ESP\
    \ functionality in\n   RFC 4303 [RFC4303], and to bring the PIM-SM specification\
    \ into\n   alignment with the new AH and ESP specifications.  In particular, in\n\
    \   accordance with RFC 4301, the use of ESP is made mandatory and AH is\n   specified\
    \ as optional.  This document specifies manual key management\n   as mandatory\
    \ to implement, i.e., that all implementations MUST\n   support, and provides\
    \ the necessary structure for an automated key\n   management protocol that the\
    \ PIM routers may use.\n"
- title: 1.1.  Goals and Non-Goals
  contents:
  - "1.1.  Goals and Non-Goals\n   The primary goal for link-local security is to\
    \ provide data origin\n   authentication for each link-local message.  A secondary\
    \ goal is to\n   ensure that communication only happens between legitimate peers\n\
    \   (i.e., adjacent routers).  An optional goal is to provide data\n   confidentiality\
    \ for the link-local messages.\n   The first goal implies that each router has\
    \ a unique identity.  It is\n   possible (but not mandatory) that this identity\
    \ will be based on the\n   unicast identity of the router.  (The unicast identity\
    \ could be, for\n   example, based on some individually configured property of\
    \ the\n   router, or be part of a region-wide public key infrastructure.)  The\n\
    \   existence of this unique identity is assumed in this specification,\n   but\
    \ procedures for establishing it are out of scope for this\n   document.\n   The\
    \ second goal implies that there is some form of \"adjacency matrix\"\n   that\
    \ controls the establishment of Security Associations among\n   adjacent multicast\
    \ routers.  For manual keying, this control will be\n   exercised by the Administrator\
    \ of the router(s), through the setting\n   of initialization parameters.  For\
    \ automated keying, the existence of\n   this control will be reflected by the\
    \ contents of the Peer\n   Authorization Database (PAD) (see RFC 4301 [RFC4301])\
    \ or the Group\n   Security Policy Database (GSPD) (see RFC 5374 [RFC5374]) in\
    \ each\n   router.  Procedures for controlling the adjacency and building the\n\
    \   associated PAD and GSPD are out of scope for this document.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [RFC2119].\n   They indicate requirement levels for compliant PIM-SM\n\
    \   implementations.\n"
- title: 3.  Transport Mode versus Tunnel Mode
  contents:
  - "3.  Transport Mode versus Tunnel Mode\n   All implementations conforming to this\
    \ specification MUST support SA\n   in transport mode to provide required IPsec\
    \ security to PIM-SM link-\n   local messages.  They MAY also support SA in tunnel\
    \ mode to provide\n   required IPsec security to PIM-SM link-local messages. \
    \ If tunnel\n   mode is used, both destination address preservation and source\n\
    \   address preservation MUST be used, as described in Section 3.1 of RFC\n  \
    \ 5374 [RFC5374].\n"
- title: 4.  Authentication
  contents:
  - "4.  Authentication\n   Implementations conforming to this specification MUST\
    \ support\n   authentication for PIM-SM link-local messages.  Implementations\n\
    \   conforming to this specification MUST support HMAC-SHA1 [RFC2404].\n   In\
    \ order to provide authentication of PIM-SM link-local messages,\n   implementations\
    \ MUST support ESP [RFC4303] and MAY support AH\n   [RFC4302].\n   If ESP in transport\
    \ mode is used, it will only provide authentication\n   to PIM-SM protocol packets\
    \ excluding the IP header, extension\n   headers, and options.\n   If AH in transport\
    \ mode is used, it will provide authentication to\n   PIM-SM protocol packets,\
    \ selected portions of the IP header,\n   extension headers and options.\n   Note:\
    \ when authentication for PIM-SM link-local messages is enabled,\n   o  PIM-SM\
    \ link-local packets that are not protected with AH or ESP\n      will be silently\
    \ discarded by IPsec, although the implementation\n      of IPsec may maintain\
    \ a counter of such packets.\n   o  PIM-SM link-local packets that fail the authentication\
    \ checks will\n      be silently discarded by IPsec, although the implementation\
    \ of\n      IPsec may maintain a counter of such packets.\n"
- title: 5.  Confidentiality
  contents:
  - "5.  Confidentiality\n   Implementations conforming to this specification SHOULD\
    \ support\n   confidentiality for PIM-SM.  Implementations supporting\n   confidentiality\
    \ MUST support AES-CBC [RFC3602] with a 128-bit key.\n   If confidentiality is\
    \ provided, ESP MUST be used.\n   Since authentication MUST be supported by a\
    \ conforming\n   implementation, an implementation MUST NOT generate the combination\n\
    \   of NON-NULL Encryption and NULL Authentication.\n   Note: when confidentiality\
    \ for PIM-SM link-local packets is enabled,\n   o  PIM-SM packets that are not\
    \ protected with ESP will be silently\n      discarded by IPsec, although the\
    \ implementation of IPsec may\n      maintain a counter of such packets.\n"
- title: 6.   IPsec Requirements
  contents:
  - "6.   IPsec Requirements\n   In order to implement this specification, the following\
    \ IPsec\n   capabilities are required.\n   Transport mode\n      IPsec in transport\
    \ mode MUST be supported.\n   Multiple Security Policy Databases (SPDs)\n    \
    \  The implementation MUST support multiple SPDs with an SPD\n      selection\
    \ function that provides an ability to choose a specific\n      SPD based on interface.\n\
    \   Selectors\n      The implementation MUST be able to use source address, destination\n\
    \      address, protocol, and direction as selectors in the SPD.\n   Interface\
    \ ID tagging\n      The implementation MUST be able to tag the inbound packets\
    \ with\n      the ID of the interface (physical or virtual) on which they\n  \
    \    arrived.\n   Manual key support\n      It MUST be possible to use manually\
    \ configured keys to secure the\n      specified traffic.\n   Encryption and authentication\
    \ algorithms\n      Encryption and authentication algorithm requirements described\
    \ in\n      RFC 4835 [RFC4835] apply when ESP and AH are used to protect\n   \
    \   PIM-SM.  Implementations MUST support ESP-NULL, and if providing\n      confidentiality,\
    \ MUST support the ESP transforms providing\n      confidentiality required by\
    \ [RFC4835].  However, in any case,\n      implementations MUST NOT allow the\
    \ user to choose a stream cipher\n      or block mode cipher in counter mode for\
    \ use with manual keys.\n   Encapsulation of ESP packets\n      IP encapsulation\
    \ of ESP packets MUST be supported.  For\n      simplicity, UDP encapsulation\
    \ of ESP packets SHOULD NOT be used.\n   If the automatic keying features of this\
    \ specification are\n   implemented, the following additional IPsec capabilities\
    \ are\n   required:\n   Group Security Policy Database (GSPD)\n      The implementation\
    \ MUST support the GSPD that is described in RFC\n      5374 [RFC5374].\n   Multiple\
    \ Group Security Policy Databases\n      The implementation MUST support multiple\
    \ GSPDs with a GSPD\n      selection function that provides an ability to choose\
    \ a specific\n      GSPD based on interface.\n   Selectors\n      The implementation\
    \ MUST be able to use source address, destination\n      address, protocol and\
    \ direction as selectors in the GSPD.\n"
- title: 7.  Key Management
  contents:
  - "7.  Key Management\n   All the implementations MUST support manual configuration\
    \ of the\n   Security Associations (SAs) that will be used to authenticate PIM-SM\n\
    \   link-local messages.  This does not preclude the use of a negotiation\n  \
    \ protocol such as the Group Domain Of Interpretation (GDOI) [RFC3547]\n   or\
    \ Group Secure Association Key Management Protocol (GSAKMP)\n   [RFC4535] to establish\
    \ these SAs.\n"
- title: 7.1.  Manual Key Management
  contents:
  - "7.1.  Manual Key Management\n   To establish the SAs at PIM-SM routers, manual\
    \ key configuration will\n   be feasible when the number of peers (directly connected\
    \ routers) is\n   small.  The Network Administrator will configure a router manually.\n\
    \   At that time, the authentication method and the choice of keys SHOULD\n  \
    \ be configured.  The parameters for the Security Association Database\n   (SAD)\
    \ will be entered.  The Network Administrator will also configure\n   the Security\
    \ Policy Database of a router to ensure the use of the\n   associated SA while\
    \ sending a link-local message.\n"
- title: 7.2.  Automated Key Management
  contents:
  - "7.2.  Automated Key Management\n   All the link-local messages of the PIM-SM\
    \ protocol are sent to the\n   destination address, ALL_PIM_ROUTERS, which is\
    \ a multicast address.\n   By using the sender address in conjunction with the\
    \ destination\n   address for Security Association lookup, link-local communication\n\
    \   turns into a Source-Specific Multicast (SSM) or \"one-to-many\"\n   communication.\n\
    \   The procedures for automated key management are not specified in this\n  \
    \ document.\n   One option is to use Group Domain Of Interpretation (GDOI) [RFC3547],\n\
    \   which enables a group of users or devices to exchange encrypted data\n   using\
    \ IPsec data encryption.  GDOI has been developed to be used in\n   multicast\
    \ applications, where the number of end users or devices may\n   be large and\
    \ the end users or devices can dynamically join/leave a\n   multicast group. \
    \ However, a PIM router is not expected to join/leave\n   very frequently, and\
    \ the number of routers is small when compared to\n   the possible number of users\
    \ of a multicast application.  Moreover,\n   most of the PIM routers will be located\
    \ inside the same\n   administrative domain and are considered to be trusted parties.\
    \  It\n   is possible that a subset of GDOI functionalities will be sufficient.\n\
    \   Another option is to use the Group Secure Association Key Management\n   Protocol\
    \ (GSAKMP) [RFC4535].\n"
- title: 7.3.  Communications Patterns
  contents:
  - "7.3.  Communications Patterns\n   Before discussing the set of Security Associations\
    \ that are required\n   to properly manage a multicast region that is under the\
    \ control of a\n   single administration, it is necessary to understand the\n\
    \   communications patterns that will exist among the routers in this\n   region.\
    \  From the perspective of a speaking router, the information\n   from that router\
    \ is sent (multicast) to all of its neighbors.  From\n   the perspective of a\
    \ listening router, the information coming from\n   each of its neighbors is distinct\
    \ from the information coming from\n   every other router to which it is directly\
    \ connected.  Thus, an\n   administrative region contains many (small) distinct\
    \ groups, all of\n   which happen to be using the same multicast destination address\n\
    \   (e.g., ALL_PIM_ROUTERS, see Section 11), and each of which is\n   centered\
    \ on the associated speaking router.\n   Consider the example configuration as\
    \ shown in Figure 1.\n   R2    R3    R4    R5    R6\n   |     |     |     |  \
    \   |\n   |     |     |     |     |\n   ---------   ---------------\n        \
    \  |     |\n          |     |\n           \\   /\n             R1\n          \
    \ /   \\\n          |     |\n          |     |\n   ---------    --------------------\n\
    \         |       |    |    |    |\n         |       |    |    |    |\n      \
    \  R7      R8   R9   R10  R11\n         |       |    |    |    |\n           \
    \           |\n                      |\n                  -------------\n    \
    \               |    |    |\n                   |    |    |\n                \
    \  R12  R13  R14\n         Figure 1: Set of router interconnections\n   In this\
    \ configuration, router R1 has four interfaces, and is the\n   speaking router\
    \ for a group whose listening routers are routers R2\n   through R11.  Router\
    \ R9 is the speaking router for a group whose\n   listening routers are routers\
    \ R1, R8, and R10-R14.\n   From the perspective of R1 as a speaking router, if\
    \ a Security\n   Association SA1 is assigned to protect outgoing packets from\
    \ R1, then\n   it is necessary to distribute the key for this association to each\
    \ of\n   the routers R2 through R11.  Similarly, from the perspective of R9 as\n\
    \   a speaking router, if a Security Association is assigned to protect\n   the\
    \ outgoing packets from R9, then it is necessary to distribute the\n   key for\
    \ this association to each of the routers R1, R8, and R10\n   through R14.\n \
    \  From the perspective of R1 as a listening router, all packets\n   arriving\
    \ from R2 through R11 need to be distinguished from each\n   other, to permit\
    \ selecting the correct Security Association in the\n   SAD.  (Packets from each\
    \ of the peer routers (R2 through R11)\n   represent communication from a different\
    \ speaker, with a separate\n   sequence-number space, even though they are sent\
    \ using the same\n   destination address.)  For a multicast Security Association,\
    \ RFC 4301\n   permits using the source address in the selection function.  If\
    \ the\n   source addresses used by routers R2 through R11 are globally unique,\n\
    \   then the source addresses of the peer routers are sufficient to\n   achieve\
    \ the differentiation.  If the sending routers use link-local\n   addresses, then\
    \ these addresses are unique only on a per-interface\n   basis, and it is necessary\
    \ to use the Interface ID tag as an\n   additional selector, i.e., either the\
    \ selection function has to have\n   the Interface ID tag as one of its inputs\
    \ or separate SADs have to be\n   maintained for each interface.\n   If the assumption\
    \ of connectivity to the key server can be made\n   (which is true in the PIM-SM\
    \ case), then the Group Controller/Key\n   Server (GC/KS) that is used for the\
    \ management of the keys can be\n   centrally located (and duplicated for reliability).\
    \  If this\n   assumption cannot be made (i.e., in the case of adjacencies for\
    \ a\n   unicast router), then some form of \"local\" key server must be\n   available\
    \ for each group.  Given that the listening routers are never\n   more than one\
    \ hop away from the speaking router, the speaking router\n   is the obvious place\
    \ to locate the \"local\" key server.  As such, this\n   may be a useful approach\
    \ even in the PIM-SM case.  This approach has\n   the additional advantage that\
    \ there is no need to duplicate the local\n   key server for reliability, since\
    \ if the key server is down, it is\n   very likely that the speaking router is\
    \ also down.\n"
- title: 7.4.  Neighbor Relationships
  contents:
  - "7.4.  Neighbor Relationships\n   Each distinct group consists of one speaker,\
    \ and the set of directly\n   connected listeners.  If the decision is made to\
    \ maintain one\n   Security Association per speaker (see Section 8), then the\
    \ key server\n   will need to be aware of the adjacencies of each speaker.  Procedures\n\
    \   for managing and distributing these adjacencies are out of scope for\n   this\
    \ document.\n"
- title: 8.  Number of Security Associations
  contents:
  - "8.  Number of Security Associations\n   The number of Security Associations to\
    \ be maintained by a PIM router\n   depends on the required security level and\
    \ available key management.\n   This SHOULD be decided by the Network Administrator.\
    \  Two different\n   ways are shown in Figures 2 and 3.  It is assumed that A,\
    \ B, and C\n   are three PIM routers, where B and C are directly connected with\
    \ A,\n   and there is no direct link between B and C.\n                      \
    \                 |\n            +++++                      |\n            + B\
    \ + SAb     ------------>|\n            +   + SAa     <------------|\n       \
    \     +++++                      |\n                                       |\n\
    \            +++++ SAb     <------------|\n            +   +                 ---->|\n\
    \            +   +                /\n            + A + SAa     -------\n     \
    \       +   +                \\\n            +   +                 ---->|\n  \
    \          +++++ SAc     <------------|\n                                    \
    \   |\n            +++++                      |\n            + C + SAc     ------------>|\n\
    \            +   + SAa     <------------|\n            +++++                 \
    \     |\n                                       |\n                          Directly\
    \ connected network\n         Figure 2: Activate unique Security Association for\
    \ each peer\n   The first method, shown in Figure 2, SHOULD be supported by every\n\
    \   implementation.  In this method, each node will use a unique SA for\n   its\
    \ outbound traffic.  A, B, and C will use SAa, SAb, and SAc,\n   respectively,\
    \ for sending any traffic.  Each node will include the\n   source address when\
    \ searching the SAD for a match.  Router A will use\n   SAb and SAc for packets\
    \ received from B and C, respectively.  The\n   number of SAs to be activated\
    \ and maintained by a PIM router will be\n   equal to the number of directly connected\
    \ routers, plus one for\n   sending its own traffic.  Also, the addition of a\
    \ PIM router in the\n   network will require the addition of another SA on every\
    \ directly\n   connected PIM router.  This solution will be scalable and practically\n\
    \   feasible with an automated key management protocol.  However, it MAY\n   be\
    \ used with manual key management, if the number of directly\n   connected routers\
    \ is small.\n                                       |\n            +++++     \
    \                 |\n            + B + SAo     ------------>|\n            + \
    \  + SAi     <------------|\n            +++++                      |\n      \
    \                                 |\n            +++++ SAi     <------------|\n\
    \            +   +                 ---->|\n            +   +                /\n\
    \            + A + SAo     -------\n            +   +                \\\n    \
    \        +   +                 ---->|\n            +++++ SAi     <------------|\n\
    \                                       |\n            +++++                 \
    \     |\n            + C + SAo     ------------>|\n            +   + SAi     <------------|\n\
    \            +++++                      |\n                                  \
    \     |\n                          Directly connected network\n         Figure\
    \ 3: Activate two Security Associations\n   The second method, shown in Figure\
    \ 3, MUST be supported by every\n   implementation.  In this simple method, all\
    \ the nodes will use two\n   SAs, one for sending (SAo) and the other for receiving\
    \ (SAi) traffic.\n   Thus, the number of SAs is always two and will not be affected\
    \ by\n   addition of a PIM router.  Although two different SAs (i.e., SAo and\n\
    \   SAi) are used in this method, the SA parameters (keys, Security\n   Parameter\
    \ Index (SPI), etc.) for the two SAs are identical, i.e., the\n   same information\
    \ is shared among all the routers in an administrative\n   region.  This document\
    \ RECOMMENDS this second method for manual key\n   configuration.  However, it\
    \ MAY also be used with automated key\n   configuration.\n"
- title: 9.  Rekeying
  contents:
  - "9.  Rekeying\n   An analysis of the considerations for key management is provided\
    \ in\n   RFC 4107 [RFC4107].\n   In PIM-SM deployments it is expected that secure\
    \ sessions will be\n   relatively long-lived, and it is not expected that keys\
    \ will be\n   significantly exposed through normal operational activity.  Manual\n\
    \   keying is judged acceptable in the light of the relatively low rate\n   of\
    \ change that is required.\n   To maintain the security of a link, the authentication\
    \ and encryption\n   key values SHOULD be changed periodically, to limit the risk\
    \ of\n   undetected key disclosure.  Keys SHOULD also be changed when there is\n\
    \   a change of trusted personnel.\n   Manual keying offers the ability to change\
    \ keys in a coordinated way,\n   but it has several drawbacks in PIM-SM systems.\
    \  Some of these are\n   listed in Section 15 (\"Security Considerations\") of\
    \ this document.\n   According to an analysis in line with RFC 4107 [RFC4107],\
    \ PIM-SM\n   would benefit from automated key management and roll over because\
    \ all\n   the disadvantages of manual keys listed in Section 15 would be\n   eliminated.\
    \  However, suitable techniques for automated key\n   management do not currently\
    \ exist.  Work is in hand in the IETF to\n   develop suitable solutions.  In the\
    \ meantime, implementations MUST\n   support manual rekeying as described below.\
    \  Implementers and\n   deployers need to be aware of the requirement to upgrade\
    \ to support\n   automated key management as soon as suitable techniques are\n\
    \   available.\n"
- title: 9.1.  Manual Rekeying Procedure
  contents:
  - "9.1.  Manual Rekeying Procedure\n   In accordance with the requirements of RFC\
    \ 4107 [RFC4107], the\n   following three-step procedure provides a possible mechanism\
    \ to rekey\n   the routers on a link without dropping PIM-SM protocol packets\
    \ or\n   disrupting the adjacency, while ensuring that it is always clear\n  \
    \ which key is being used.\n   1.  For every router on the link, create an additional\
    \ inbound SA for\n       the interface being rekeyed using a new SPI and the new\
    \ key.\n   2.  For every router on the link, replace the original outbound SA\n\
    \       with one using the new SPI and key values.  The SA replacement\n     \
    \  operation MUST be atomic with respect to sending PIM-SM packets\n       on\
    \ the link, so that no PIM-SM packets are sent without\n       authentication/encryption\n\
    \   3.  For every router on the link, remove the original inbound SA.\n   Note\
    \ that all routers on the link MUST complete step 1 before any\n   begin step\
    \ 2.  Likewise, all the routers on the link MUST complete\n   step 2 before any\
    \ begin step 3.\n   One way to control the progression from one step to another\
    \ is for\n   each router to have a configurable time constant KeyRolloverInterval.\n\
    \   After the router begins step 1 on a given link, it waits for this\n   interval\
    \ and then moves to step 2.  Likewise, after moving to step 2,\n   it waits for\
    \ this interval and then moves to step 3.\n   In order to achieve smooth key transition,\
    \ all routers on a link MUST\n   use the same value for KeyRolloverInterval and\
    \ MUST initiate the key\n   rollover process within this time period.\n   At the\
    \ end of this time period, all the routers on the link will have\n   a single\
    \ inbound and outbound SA for PIM-SM with the new SPI and key\n   values.\n"
- title: 9.2.  KeyRolloverInterval
  contents:
  - "9.2.  KeyRolloverInterval\n   The configured value of KeyRolloverInterval needs\
    \ to be long enough\n   to allow the Administrator to change keys on all the PIM-SM\
    \ routers.\n   As this value can vary significantly depending on the implementation\n\
    \   and the deployment, it is left to the Administrator to choose an\n   appropriate\
    \ value.\n"
- title: 9.3.  Rekeying Interval
  contents:
  - "9.3.  Rekeying Interval\n   In keeping with the goal of reducing key exposure,\
    \ the encryption and\n   authentication keys SHOULD be changed at least every\
    \ 90 days.\n"
- title: 10.  IPsec Protection Barrier and SPD/GSPD
  contents:
  - '10.  IPsec Protection Barrier and SPD/GSPD

    '
- title: 10.1.  Manual Keying
  contents:
  - '10.1.  Manual Keying

    '
- title: 10.1.1.  SAD Entries
  contents:
  - "10.1.1.  SAD Entries\n   The Administrator must configure the necessary Security\
    \ Associations.\n   Each SA entry has the source address of an authorized peer,\
    \ and a\n   Destination Address of ALL_PIM_ROUTERS.  Unique SPI values for the\n\
    \   manually configured SAs MUST be assigned by the Administrator to\n   ensure\
    \ that the SPI does not conflict with existing SPI values in the\n   SAD.\n"
- title: 10.1.2.  SPD Entries
  contents:
  - "10.1.2.  SPD Entries\n   The Administrator must configure the necessary SPD entries.\
    \  The SPD\n   entry must ensure that any outbound IP traffic packet traversing\
    \ the\n   IPsec boundary, with PIM as its next layer protocol and sent to the\n\
    \   Destination Address of ALL_PIM_ROUTERS, is protected by ESP or AH.\n   Note\
    \ that this characterization includes all the link-local messages\n   (Hello,\
    \ Join/Prune, Bootstrap, Assert).\n"
- title: 10.2.  Automatic Keying
  contents:
  - "10.2.  Automatic Keying\n   When automatic keying is used, the SA creation is\
    \ done dynamically\n   using a group key management protocol.  The GSPD and PAD\
    \ tables are\n   configured by the Administrator.  The PAD table provides the\
    \ link\n   between the IPsec subsystem and the group key management protocol.\n\
    \   For automatic keying, the implementation MUST support the multicast\n   extensions\
    \ described in [RFC5374].\n"
- title: 10.2.1.  SAD Entries
  contents:
  - "10.2.1.  SAD Entries\n   All PIM routers participate in an authentication scheme\
    \ that\n   identifies permitted neighbors and achieves peer authentication\n \
    \  during SA negotiation, leading to child SAs being established and\n   saved\
    \ in the SAD.\n"
- title: 10.2.2.  GSPD Entries
  contents:
  - "10.2.2.  GSPD Entries\n   The Administrator must configure the necessary GSPD\
    \ entries for\n   \"sender only\" directionality.  This rule MUST trigger the\
    \ group key\n   management protocol for a registration exchange.  This exchange\
    \ will\n   set up the outbound SAD entry that encrypts the multicast PIM control\n\
    \   message.  Considering that this rule is \"sender only\", no inbound SA\n \
    \  is created in the reverse direction.\n   In addition, the registration exchange\
    \ will trigger the installation\n   of the GSPD entries corresponding to each\
    \ legitimate peer router,\n   with direction \"receiver only\".  Procedures for\
    \ achieving the\n   registration exchange are out of scope for this document.\n\
    \   A router SHOULD NOT dynamically detect new neighbors as the result of\n  \
    \ receiving an unauthenticated PIM-SM link-local message or an IPsec\n   packet\
    \ that fails an SAD lookup.  An automated key management\n   protocol SHOULD provide\
    \ a means of notifying a router of new,\n   legitimate neighbors.\n"
- title: 10.2.3.  PAD Entries
  contents:
  - "10.2.3.  PAD Entries\n   The PAD will be configured with information to permit\
    \ identification\n   of legitimate group members and senders (i.e., to control\
    \ the\n   adjacency).  Procedures for doing this are out of scope for this\n \
    \  document.\n"
- title: 11.  Security Association Lookup
  contents:
  - "11.  Security Association Lookup\n   For an SA that carries unicast traffic,\
    \ three parameters (SPI,\n   destination address, and security protocol type (AH\
    \ or ESP)) are used\n   in the Security Association lookup process for inbound\
    \ packets.  The\n   SPI is sufficient to specify an SA.  However, an implementation\
    \ may\n   use the SPI in conjunction with the IPsec protocol type (AH or ESP)\n\
    \   for the SA lookup process.  According to RFC 4301 [RFC4301], for\n   multicast\
    \ SAs, in conjunction with the SPI, the destination address\n   or the destination\
    \ address plus the sender address may also be used\n   in the SA lookup.  This\
    \ applies to both ESP and AH.  The security\n   protocol field is not employed\
    \ for a multicast SA lookup.\n   Given that, from the prospective of a receiving\
    \ router, each peer\n   router is an independent sender and given that the destination\n\
    \   address will be the same for all senders, the receiving router MUST\n   use\
    \ SPI plus destination address plus sender address when performing\n   the SA\
    \ lookup.  In effect, link-local communication is an SSM\n   communication that\
    \ happens to use an Any-Source Multicast (ASM)\n   address (which is shared among\
    \ all the routers).\n   Given that it is always possible to distinguish a connection\
    \ using\n   IPsec from a connection not using IPsec, it is recommended that the\n\
    \   address ALL_PIM_ROUTERS be used, to maintain consistency with present\n  \
    \ practice.\n   Given that the sender address of an incoming packet may be only\n\
    \   locally unique (because of the use of link-local addresses), it is\n   necessary\
    \ for a receiver to use the interface ID tag to determine the\n   associated SA\
    \ for that sender.  Therefore, this document mandates\n   that the interface ID\
    \ tag, the SPI, and the sender address MUST be\n   used in the SA lookup process.\n"
- title: 12.  Activating the Anti-Replay Mechanism
  contents:
  - "12.  Activating the Anti-Replay Mechanism\n   Although link-level messages on\
    \ a link constitute a multiple-sender,\n   multiple-receiver group, the use of\
    \ the interface ID tag and sender\n   address for SA lookup essentially resolves\
    \ the communication into a\n   separate SA for each sender/destination pair, even\
    \ for the case where\n   only two SAs (with identical SA parameters) are used\
    \ for the entire\n   administrative region.  Therefore, the statement in the AH\
    \ RFC\n   (Section 2.5 of [RFC4302]) that \"for a multi-sender SA, the anti-\n\
    \   replay features are not available\" becomes irrelevant to the PIM-SM\n   link-local\
    \ message exchange.\n   To activate the anti-replay mechanism in a unicast communication,\
    \ the\n   receiver uses the sliding window protocol and it maintains a sequence\n\
    \   number for this protocol.  This sequence number starts from zero.\n   Each\
    \ time the sender sends a new packet, it increments this number by\n   one.  In\
    \ a multi-sender multicast group communication, a single\n   sequence number for\
    \ the entire group would not be enough.\n   The whole scenario is different for\
    \ PIM link-local messages.  These\n   messages are sent to local links with TTL\
    \ = 1.  A link-local message\n   never propagates through one router to another.\
    \  The use of the\n   sender address and the interface ID tag for SA lookup converts\
    \ the\n   relationship from a multiple-sender group to multiple single-sender\n\
    \   associations.  This specification RECOMMENDS activation of the anti-\n   replay\
    \ mechanism only if the SAs are assigned using an automated key\n   management\
    \ procedure.  If manual key management is used, the anti-\n   replay SHOULD NOT\
    \ be activated.\n   If an existing router has to restart, in accordance with RFC\
    \ 4303\n   [RFC4303], the sequence-number counter at the sender MUST be\n   correctly\
    \ maintained across local reboots, etc., until the key is\n   replaced.\n"
- title: 13.  Implementing a Security Policy Database per Interface
  contents:
  - "13.  Implementing a Security Policy Database per Interface\n   RFC 4601 suggests\
    \ that it may be desirable to implement a separate\n   Security Policy Database\
    \ (SPD) for each router interface.  The use of\n   link-local addresses in certain\
    \ circumstances implies that\n   differentiation of ambiguous speaker addresses\
    \ requires the use of\n   the interface ID tag in the SA lookup.  One way to do\
    \ this is through\n   the use of multiple SPDs.  Alternatively, the interface\
    \ ID tag may be\n   a specific component of the selector algorithm.  This is in\n\
    \   conformance with RFC 4301, which explicitly removes the requirement\n   for\
    \ separate SPDs that was present in RFC 2401 [RFC2401].\n"
- title: 14.  Extended Sequence Number
  contents:
  - "14.  Extended Sequence Number\n   In the [RFC4302], there is a provision for\
    \ a 64-bit Extended Sequence\n   Number (ESN) as the counter of the sliding window\
    \ used in the anti-\n   replay protocol.  Both the sender and the receiver maintain\
    \ a 64-bit\n   counter for the sequence number, although only the lower order\
    \ 32\n   bits are sent in the transmission.  In other words, it will not\n   affect\
    \ the present header format of AH.  If ESN is used, a sender\n   router can send\
    \ 2^64 -1 packets without any intervention.  This\n   number is very large, and\
    \ from a PIM router's point of view, a PIM\n   router can never exceed this number\
    \ in its lifetime.  This makes it\n   reasonable to permit manual configuration\
    \ for a small number of PIM\n   routers, since the sequence number will never\
    \ roll over.  For this\n   reason, when manual configuration is used, ESN SHOULD\
    \ be deployed as\n   the sequence number for the sliding window protocol.  In\
    \ addition,\n   when an ESN is used with a manually keyed SA, it MUST be saved\
    \ over a\n   reboot, along with an indication of which sequence numbers have been\n\
    \   used.\n"
- title: 15.  Security Considerations
  contents:
  - "15.  Security Considerations\n   The whole document considers the security issues\
    \ of PIM link-local\n   messages and proposes a mechanism to protect them.\n \
    \  Limitations of manual keys:\n   The following are some of the known limitations\
    \ of the usage of\n   manual keys.\n   o  If replay protection cannot be provided,\
    \ the PIM routers will not\n      be secured against all the attacks that can\
    \ be performed by\n      replaying PIM packets.\n   o  Manual keys are usually\
    \ long lived (changing them often is a\n      tedious task).  This gives an attacker\
    \ enough time to discover the\n      keys.\n   o  As the Administrator is manually\
    \ configuring the keys, there is a\n      chance that the configured keys are\
    \ weak (there are known weak\n      keys for DES/3DES at least).\n   Impersonation\
    \ attacks:\n   The usage of the same key on all the PIM routers connected to a\
    \ link\n   leaves them all insecure against impersonation attacks if any one of\n\
    \   the PIM routers is compromised, malfunctioning, or misconfigured.\n   Detailed\
    \ analysis of various vulnerabilities of routing protocols is\n   provided in\
    \ RFC 4593 [RFC4593].  For further discussion of PIM-SM and\n   multicast security,\
    \ the reader is referred to RFC 5294 [RFC5294], RFC\n   4609 [RFC4609], and the\
    \ Security Considerations section of RFC 4601\n   [RFC4601].\n"
- title: 16.  Acknowledgements
  contents:
  - "16.  Acknowledgements\n   The structure and text of this document draw heavily\
    \ from RFC 4552\n   [RFC4552].  The authors of this document thank M. Gupta and\
    \ N. Melam\n   for permission to do this.\n   The quality of this document was\
    \ substantially improved after SECDIR\n   pre-review by Brian Weis, and after\
    \ AD review by Adrian Farrel.\n"
- title: 17.  References
  contents:
  - '17.  References

    '
- title: 17.1.  Normative References
  contents:
  - "17.1.  Normative References\n   [RFC4601]  Fenner, B., Handley, M., Holbrook,\
    \ H., and I. Kouvelas,\n              \"Protocol Independent Multicast - Sparse\
    \ Mode (PIM-SM):\n              Protocol Specification (Revised)\", RFC 4601,\
    \ August 2006.\n   [RFC4302]  Kent, S., \"IP Authentication Header\", RFC 4302,\n\
    \              December 2005.\n   [RFC2119]  Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC4301]  Kent, S. and K. Seo, \"Security Architecture for the\n\
    \              Internet Protocol\", RFC 4301, December 2005.\n   [RFC4303]  Kent,\
    \ S., \"IP Encapsulating Security Payload (ESP)\",\n              RFC 4303, December\
    \ 2005.\n   [RFC4835]  Manral, V., \"Cryptographic Algorithm Implementation\n\
    \              Requirements for Encapsulating Security Payload (ESP) and\n   \
    \           Authentication Header (AH)\", RFC 4835, April 2007.\n   [RFC5374]\
    \  Weis, B., Gross, G., and D. Ignjatic, \"Multicast\n              Extensions\
    \ to the Security Architecture for the Internet\n              Protocol\", RFC\
    \ 5374, November 2008.\n   [RFC2404]  Madson, C. and R. Glenn, \"The Use of HMAC-SHA-1-96\
    \ within\n              ESP and AH\", RFC 2404, November 1998.\n   [RFC3602] \
    \ Frankel, S., Glenn, R., and S. Kelly, \"The AES-CBC Cipher\n              Algorithm\
    \ and Its Use with IPsec\", RFC 3602,\n              September 2003.\n"
- title: 17.2.  Informative References
  contents:
  - "17.2.  Informative References\n   [RFC2117]  Estrin, D., Farinacci, D., Helmy,\
    \ A., Thaler, D., Deering,\n              S., Handley, M., Jacobson, V., Liu,\
    \ C., Sharma, P., and L.\n              Wei, \"Protocol Independent Multicast-Sparse\
    \ Mode (PIM-SM):\n              Protocol Specification\", RFC 2117, June 1997.\n\
    \   [RFC2362]  Estrin, D., Farinacci, D., Helmy, A., Thaler, D., Deering,\n  \
    \            S., Handley, M., and V. Jacobson, \"Protocol Independent\n      \
    \        Multicast-Sparse Mode (PIM-SM): Protocol Specification\",\n         \
    \     RFC 2362, June 1998.\n   [RFC2401]  Kent, S. and R. Atkinson, \"Security\
    \ Architecture for the\n              Internet Protocol\", RFC 2401, November\
    \ 1998.\n   [RFC4535]  Harney, H., Meth, U., Colegrove, A., and G. Gross,\n  \
    \            \"GSAKMP: Group Secure Association Key Management\n             \
    \ Protocol\", RFC 4535, June 2006.\n   [RFC3547]  Baugher, M., Weis, B., Hardjono,\
    \ T., and H. Harney, \"The\n              Group Domain of Interpretation\", RFC\
    \ 3547, July 2003.\n   [RFC4593]  Barbir, A., Murphy, S., and Y. Yang, \"Generic\
    \ Threats to\n              Routing Protocols\", RFC 4593, October 2006.\n   [RFC5294]\
    \  Savola, P. and J. Lingard, \"Host Threats to Protocol\n              Independent\
    \ Multicast (PIM)\", RFC 5294, August 2008.\n   [RFC4609]  Savola, P., Lehtonen,\
    \ R., and D. Meyer, \"Protocol\n              Independent Multicast - Sparse Mode\
    \ (PIM-SM) Multicast\n              Routing Security Issues and Enhancements\"\
    , RFC 4609,\n              October 2006.\n   [RFC4552]  Gupta, M. and N. Melam,\
    \ \"Authentication/Confidentiality\n              for OSPFv3\", RFC 4552, June\
    \ 2006.\n   [RFC4107]  Bellovin, S. and R. Housley, \"Guidelines for Cryptographic\n\
    \              Key Management\", BCP 107, RFC 4107, June 2005.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   J. William Atwood\n   Concordia University/CSE\n   1455\
    \ de Maisonneuve Blvd. West\n   Montreal, QC  H3G 1M8\n   Canada\n   Phone: +1(514)848-2424\
    \ ext3046\n   EMail: bill@cse.concordia.ca\n   URI:   http://users.encs.concordia.ca/~bill\n\
    \   Salekul Islam\n   INRS Energie, Materiaux et Telecommunications\n   800 de\
    \ La Gauchetiere, Suite 800\n   Montreal, QC  H5A 1K6\n   Canada\n   EMail: Salekul.Islam@emt.inrs.ca\n\
    \   URI:   http://users.encs.concordia.ca/~salek_is\n   Maziar Siami\n   Concordia\
    \ University/CIISE\n   1455 de Maisonneuve Blvd. West\n   Montreal, QC  H3G 1M8\n\
    \   Canada\n   EMail: mzrsm@yahoo.ca\n"
