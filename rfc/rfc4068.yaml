- title: __initial_text__
  contents:
  - '                     Fast Handovers for Mobile IPv6

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2005).\n"
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv6 enables a Mobile Node to maintain its connectivity to\
    \ the\n   Internet when moving from one Access Router to another, a process\n\
    \   referred to as handover.  During handover, there is a period during\n   which\
    \ the Mobile Node is unable to send or receive packets because of\n   link switching\
    \ delay and IP protocol operations.  This \"handover\n   latency\" resulting from\
    \ standard Mobile IPv6 procedures, namely\n   movement detection, new Care of\
    \ Address configuration, and Binding\n   Update, is often unacceptable to real-time\
    \ traffic such as Voice over\n   IP.  Reducing the handover latency could be beneficial\
    \ to non-real-\n   time, throughput-sensitive applications as well.  This document\n\
    \   specifies a protocol to improve handover latency due to Mobile IPv6\n   procedures.\
    \  This document does not address improving the link\n   switching latency.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n   2.  Terminology. . . . . . . . . . . . . . . . . . . . .\
    \ . . . . .  3\n   3.  Protocol Overview. . . . . . . . . . . . . . . . . . .\
    \ . . . .  5\n       3.1.  Addressing the Handover Latency. . . . . . . . . .\
    \ . . .  5\n       3.2.  Protocol Operation . . . . . . . . . . . . . . . . .\
    \ . .  7\n       3.3.  Protocol Operation of Network-initiated Handover . . .\
    \ .  9\n   4.  Protocol Details . . . . . . . . . . . . . . . . . . . . . . .\
    \ 10\n   5.  Miscellaneous. . . . . . . . . . . . . . . . . . . . . . . . . 15\n\
    \       5.1.  Handover Capability Exchange . . . . . . . . . . . . . . 15\n  \
    \     5.2.  Determining New Care of Address. . . . . . . . . . . . . 15\n    \
    \   5.3.  Packet Loss. . . . . . . . . . . . . . . . . . . . . . . 15\n      \
    \ 5.4.  DAD Handling . . . . . . . . . . . . . . . . . . . . . . 16\n       5.5.\
    \  Fast or Erroneous Movement . . . . . . . . . . . . . . . 16\n   6.  Message\
    \ Formats. . . . . . . . . . . . . . . . . . . . . . . . 17\n       6.1.  New\
    \ Neighborhood Discovery Messages. . . . . . . . . . . 17\n             6.1.1.\
    \ Router Solicitation for Proxy Advertisement\n                    (RtSolPr) .\
    \ . . . . . . . . . . . . . . . . . . . 17\n             6.1.2. Proxy Router Advertisement\
    \ (PrRtAdv). . . . . . . 20\n       6.2.  Inter-Access Router Messages . . . .\
    \ . . . . . . . . . . 23\n             6.2.1. Handover Initiate (HI). . . . .\
    \ . . . . . . . . . 23\n             6.2.2. Handover Acknowledge (HAck) . . .\
    \ . . . . . . . . 25\n       6.3.  New Mobility Header Messages . . . . . . .\
    \ . . . . . . . 27\n             6.3.1. Fast Binding Update (FBU) . . . . . .\
    \ . . . . . . 27\n             6.3.2. Fast Binding Acknowledgment (FBack) . .\
    \ . . . . . 28\n             6.3.3. Fast Neighbor Advertisement (FNA) . . . .\
    \ . . . . 30\n       6.4.  New Options. . . . . . . . . . . . . . . . . . . .\
    \ . . . 31\n             6.4.1. IP Address Option . . . . . . . . . . . . . .\
    \ . . 32\n             6.4.2. New Router Prefix Information Option. . . . . .\
    \ . 33\n             6.4.3. Link-Layer Address (LLA) Option . . . . . . . . .\
    \ 34\n             6.4.4. Mobility Header Link-Layer Address (MH-LLA)\n      \
    \              Option. . . . . . . . . . . . . . . . . . . . . . 35\n        \
    \     6.4.5. Neighbor Advertisement Acknowledgment (NAACK) . . 35\n   7.  Configurable\
    \ Parameters. . . . . . . . . . . . . . . . . . . . 36\n   8.  Security Considerations.\
    \ . . . . . . . . . . . . . . . . . . . 37\n   9.  IANA Considerations. . . .\
    \ . . . . . . . . . . . . . . . . . . 38\n   10. Acknowledgments. . . . . . .\
    \ . . . . . . . . . . . . . . . . . 39\n   11. Normative References . . . . .\
    \ . . . . . . . . . . . . . . . . 39\n   12. Contributors . . . . . . . . . .\
    \ . . . . . . . . . . . . . . . 39\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv6 [3] describes the protocol operations for a\
    \ mobile node\n   to maintain connectivity to the Internet during its handover\
    \ from one\n   access router to another.  These operations involve movement\n\
    \   detection, IP address configuration, and location update.  The\n   combined\
    \ handover latency is often sufficient to affect real-time\n   applications. \
    \ Throughput-sensitive applications can also benefit\n   from reducing this latency.\
    \  This document describes a protocol to\n   reduce the handover latency.\n  \
    \ This specification addresses the following problem: how to allow a\n   mobile\
    \ node to send packets as soon as it detects a new subnet link,\n   and how to\
    \ deliver packets to a mobile node as soon as its attachment\n   is detected by\
    \ the new access router.  The protocol defines IP\n   protocol messages necessary\
    \ for its operation regardless of link\n   technology.  It does this without depending\
    \ on specific link-layer\n   features while allowing link-specific customizations.\
    \  By definition,\n   this specification considers handovers that interwork with\
    \ Mobile IP:\n   once attached to its new access router, an MN engages in Mobile\
    \ IP\n   operations including Return Routability [3].  There are no special\n\
    \   requirements for a mobile node to behave differently with respect to\n   its\
    \ standard Mobile IP operations.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [1].  The use\n   of the term, \"silently ignore\" is not defined in RFC\
    \ 2119.  However,\n   the term is used in this document and can be similarly construed.\n\
    \   The following terminology and abbreviations are used in this\n   document.\
    \  The reference handover scenario is illustrated in\n   Figure 1.\n      Mobile\
    \ Node (MN)\n            A Mobile IPv6 host.\n      Access Point (AP)\n      \
    \      A Layer 2 device connected to an IP subnet that offers\n            wireless\
    \ connectivity to an MN.  An Access Point Identifier\n            (AP-ID) refers\
    \ to the AP's L2 address.  Sometimes, AP-ID is\n            also referred to as\
    \ a Base Station Subsystem ID (BSSID).\n      Access Router (AR)\n           \
    \ The MN's default router.\n      Previous Access Router (PAR)\n            The\
    \ MN's default router prior to its handover.\n      New Access Router (NAR)\n\
    \            The MN's default router subsequent to its handover.\n      Previous\
    \ CoA (PCoA)\n            The MN's Care of Address valid on PAR's subnet.\n  \
    \    New CoA (NCoA)\n            The MN's Care of Address valid on NAR's subnet.\n\
    \      Handover\n            A process of terminating existing connectivity and\
    \ obtaining\n            new IP connectivity.\n      Router Solicitation for Proxy\
    \ Advertisement (RtSolPr)\n            A message from the MN to the PAR requesting\
    \ information for\n            a potential handover.\n      Proxy Router Advertisement\
    \ (PrRtAdv)\n            A message from the PAR to the MN that provides information\n\
    \            about neighboring links facilitating expedited movement\n       \
    \     detection.  The message also acts as a trigger for network-\n          \
    \  initiated handover.\n      (AP-ID, AR-Info) tuple\n            Contains an\
    \ access router's L2 and IP addresses, and the\n            prefix valid on the\
    \ interface to which the Access Point\n            (identified by AP-ID) is attached.\
    \  The triplet [Router's L2\n            address, Router's IP address, Prefix]\
    \ is called \"AR-Info\".\n      Assigned Addressing\n            A particular\
    \ type of NCoA configuration in which the NAR\n            assigns an IPv6 address\
    \ for the MN.  The method by which NAR\n            manages its address pool is\
    \ not specified in this document.\n      Fast Binding Update (FBU)\n         \
    \   A message from the MN instructing its PAR to redirect its\n            traffic\
    \ (toward NAR).\n      Fast Binding Acknowledgment (FBack)\n            A message\
    \ from the PAR in response to an FBU.\n      Fast Neighbor Advertisement (FNA)\n\
    \            A message from the MN to the NAR to announce attachment, and\n  \
    \          to confirm the use of NCoA when the MN has not received an\n      \
    \      FBACK.\n      Handover Initiate (HI)\n            A message from the PAR\
    \ to the NAR regarding an MN's\n            handover.\n      Handover Acknowledge\
    \ (HAck)\n            A message from the NAR to the PAR as a response to HI.\n\
    \             v            +------------+\n           +-+            |  Previous\
    \  |        <\n           | | ---------- |   Access   | ------ > ----\\\n    \
    \       +-+            |   Router   |        <      \\\n               MN    \
    \     |   (PAR)    |                \\\n            |             +------------+\
    \            +---------------+\n            |                   ^            IP\
    \     | Correspondent |\n            |                   |         Network   |\
    \  Node         |\n            V                   |                   +---------------+\n\
    \                                v                        /\n             v  \
    \          +------------+                /\n           +-+            |    New\
    \     |        <      /\n           | | ---------- |   Access   | ------ > ----/\n\
    \           +-+            |   Router   |        <\n              MN         \
    \ |   (NAR)    |\n                          +------------+\n               Figure\
    \ 1: Reference Scenario for Handover\n"
- title: 3.  Protocol Overview
  contents:
  - '3.  Protocol Overview

    '
- title: 3.1.  Addressing the Handover Latency
  contents:
  - "3.1.  Addressing the Handover Latency\n   The ability to immediately send packets\
    \ from a new subnet link\n   depends on the \"IP connectivity\" latency, which\
    \ in turn depends on\n   the movement detection latency and new CoA configuration\
    \ latency.\n   Once an MN is IP-capable on the new subnet link, it can send a\n\
    \   Binding Update to its Home Agent and one or more correspondents.\n   Once\
    \ its correspondents successfully process the Binding Update,\n   which typically\
    \ involves the Return Routability procedure, the MN can\n   receive packets at\
    \ the new CoA.  So, the ability to receive packets\n   from correspondents directly\
    \ at its new CoA depends on the Binding\n   Update latency as well as the IP connectivity\
    \ latency.\n   The protocol enables an MN to quickly detect that it has moved\
    \ to a\n   new subnet by providing the new access point and the associated\n \
    \  subnet prefix information when the MN is still connected to its\n   current\
    \ subnet (i.e., PAR in Figure 1).  For instance, an MN may\n   discover available\
    \ access points using link-layer specific mechanisms\n   (i.e., a \"scan\" in\
    \ WLAN) and then request subnet information\n   corresponding to one or more of\
    \ those discovered access points.  The\n   MN may do this after performing router\
    \ discovery or at any time while\n   connected to its current router.  The result\
    \ of resolving an\n   identifier associated with an access point is a [AP-ID,\
    \ AR-Info]\n   tuple, which an MN can use in readily detecting movement:  when\n\
    \   attachment to an access point with AP-ID takes place, the MN knows\n   the\
    \ corresponding new router's coordinates including its prefix, IP\n   address,\
    \ and L2 address.  The \"Router Solicitation for Proxy\n   Advertisement (RtSolPr)\"\
    \ and \"Proxy Router Advertisement (PrRtAdv)\"\n   messages (see Section 6.1)\
    \ are used for aiding movement detection.\n   Through the RtSolPr and PrRtAdv\
    \ messages, the MN also formulates a\n   prospective new CoA (NCoA) when it is\
    \ still present on the PAR's\n   link.  Hence, the latency due to new prefix discovery\
    \ subsequent to\n   handover is eliminated.  Furthermore, this prospective address\
    \ can be\n   used immediately after attaching to the new subnet link (i.e., NAR's\n\
    \   link) when the MN has received a \"Fast Binding Acknowledgment\n   (FBack)\"\
    \ message prior to its movement.  If it moves without\n   receiving an FBack,\
    \ the MN can still start using NCoA after\n   announcing its attachment through\
    \ a \"Fast Neighbor Advertisement\n   (FNA)\" message.  NAR responds to FNA if\
    \ the tentative address is\n   already in use thereby reducing NCoA configuration\
    \ latency.  Under\n   some limited conditions in which the probability of address\
    \ collision\n   is considered insignificant, it may be possible to use NCoA\n\
    \   immediately after attaching to the new link.  Even so, all\n   implementations\
    \ MUST support and SHOULD use the mechanism specified\n   in this document to\
    \ avoid potential address conflicts.\n   To reduce the Binding Update latency,\
    \ the protocol specifies a tunnel\n   between the Previous CoA (PCoA) and the\
    \ NCoA.  An MN sends a \"Fast\n   Binding Update\" message to its Previous Access\
    \ Router to establish\n   this tunnel.  When feasible, the MN SHOULD send an FBU\
    \ from PAR's\n   link.  Otherwise, it should be sent immediately after attachment\
    \ to\n   NAR has been detected.  Subsequent sections describe the protocol\n \
    \  mechanics.  As a result, PAR begins tunneling packets arriving for\n   PCoA\
    \ to NCoA.  Such a tunnel remains active until the MN completes\n   the Binding\
    \ Update with its correspondents.  In the opposite\n   direction, the MN SHOULD\
    \ reverse tunnel packets to PAR until it\n   completes the Binding Update.  PAR\
    \ SHOULD forward the inner packet in\n   the tunnel to its destination (i.e.,\
    \ to the MN's correspondent).\n   Such a reverse tunnel ensures that packets containing\
    \ PCoA as a\n   source IP address are not dropped due to ingress filtering.  Readers\n\
    \   may observe that even though the MN is IP-capable on the new link, it\n  \
    \ cannot use NCoA directly with its correspondents without the\n   correspondents\
    \ first establishing a binding cache entry (for NCoA).\n   Forwarding support\
    \ for PCoA is provided through a reverse tunnel\n   between the MN and the PAR.\n\
    \   Setting up a tunnel alone does not ensure that the MN receives\n   packets\
    \ as soon as it is attached to a new subnet link, unless the\n   NAR can detect\
    \ the MN's presence.  A neighbor discovery operation\n   involving a neighbor's\
    \ address resolution (i.e., Neighbor\n   Solicitation and Neighbor Advertisement)\
    \ typically results in\n   considerable delay, sometimes lasting multiple seconds.\
    \  For\n   instance, when arriving packets trigger NAR to send Neighbor\n   Solicitation\
    \ before the MN attaches, subsequent retransmissions of\n   address resolution\
    \ are separated by a default period of one second\n   each.  To circumvent this\
    \ delay, an MN announces its attachment\n   through the FNA message that allows\
    \ the NAR to consider MN to be\n   reachable.  If there is no existing entry,\
    \ FNA allows NAR to create\n   one.  If NAR already has an entry, FNA updates\
    \ the entry while taking\n   potential address conflicts into consideration. \
    \ Through tunnel\n   establishment for PCoA and fast advertisement, the protocol\
    \ provides\n   expedited forwarding of packets to the MN.\n   The protocol also\
    \ provides the following important functionalities.\n   The access routers can\
    \ exchange messages to confirm that a proposed\n   NCoA is acceptable.  For instance,\
    \ when an MN sends an FBU from PAR's\n   link, FBack can be delivered after the\
    \ NAR considers the NCoA\n   acceptable for use.  This is especially useful when\
    \ addresses are\n   assigned by the access router.  The NAR can also rely on its\
    \ trust\n   relationship with PAR before providing forwarding support for the\
    \ MN.\n   That is, it may create a forwarding entry for the NCoA subject to\n\
    \   \"approval\" from PAR which it trusts.  Finally, the access routers\n   could\
    \ transfer network-resident contexts, such as access control,\n   QoS, and header\
    \ compression, in conjunction with handover.  For these\n   operations, the protocol\
    \ provides \"Handover Initiate (HI)\" and\n   \"Handover Acknowledge (HAck)\"\
    \ messages.  Both of these messages MUST\n   be supported and SHOULD be used.\
    \  The access routers MUST have\n   necessary security association established\
    \ by means outside the scope\n   of this document.\n"
- title: 3.2.  Protocol Operation
  contents:
  - "3.2.  Protocol Operation\n   The protocol begins when an MN sends an RtSolPr\
    \ to its access router\n   to resolve one or more Access Point Identifiers to\
    \ subnet-specific\n   information.  In response, the access router (e.g., PAR\
    \ in Figure 1)\n   sends a PrRtAdv message containing one or more [AP-ID, AR-Info]\n\
    \   tuples.  The MN may send a RtSolPr at any convenient time, for\n   instance\
    \ as a response to some link-specific event (a \"trigger\") or\n   simply after\
    \ performing router discovery.  However, the expectation\n   is that prior to\
    \ sending RtSolPr, the MN will have discovered the\n   available APs by link-specific\
    \ methods.  The RtSolPr and PrRtAdv\n   messages do not establish any state at\
    \ the access router; their\n   packet formats are defined in Section 6.1.\n  \
    \ With the information provided in the PrRtAdv message, the MN\n   formulates\
    \ a prospective NCoA and sends an FBU message when a link-\n   specific handover\
    \ event occurs.  The purpose of the FBU is to\n   authorize PAR to bind PCoA to\
    \ NCoA, so that arriving packets can be\n   tunneled to the new location of the\
    \ MN.  Whenever feasible, the FBU\n   SHOULD be sent from PAR's link.  For instance,\
    \ an internal link-\n   specific trigger could enable FBU transmission from the\
    \ previous\n   link.  When it is not feasible, the FBU is sent from the new link.\n\
    \   Care must be taken to ensure that the NCoA used in FBU does not\n   conflict\
    \ with an address already in use by some other node on the\n   link.  For this,\
    \ FBU encapsulation within FNA MUST be implemented and\n   SHOULD be used (see\
    \ below) when the FBU is sent from NAR's link.\n   The format and semantics of\
    \ FBU processing are specified in Section\n   6.3.1.\n   Depending on whether\
    \ an FBack is received on the previous link (which\n   clearly depends on whether\
    \ the FBU was sent in the first place),\n   there are two modes of operation.\n\
    \   1. The MN receives an FBack on the previous link.  This means that\n     \
    \ packet tunneling is already in progress by the time the MN\n      handovers\
    \ to NAR.  The MN SHOULD send FNA immediately after\n      attaching to NAR, so\
    \ that arriving and buffered packets can be\n      forwarded to the MN right away.\n\
    \      Before sending an FBack to an MN, PAR can determine whether the\n     \
    \ NCoA is acceptable to the NAR through the exchange of HI and HAck\n      messages.\
    \  When assigned addressing (i.e., addresses are assigned\n      by the router)\
    \ is used, the proposed NCoA in the FBU is carried in\n      HI, and the NAR MAY\
    \ assign the proposed NCoA.  Such an assigned\n      NCoA MUST be returned in\
    \ HAck, and the PAR MUST in turn provide\n      the assigned NCoA in the FBack.\
    \  If there is an assigned NCoA\n      returned in the FBack, the MN MUST use\
    \ the assigned address (and\n      not the proposed address in the FBU) upon attaching\
    \ to NAR.\n   2. The MN does not receive the FBack on the previous link because\
    \ the\n      MN has not sent the FBU or the MN has left the link after sending\n\
    \      the FBU (which itself may be lost), but before receiving an FBack.\n  \
    \    Without receiving an FBack in the latter case, the MN cannot\n      ascertain\
    \ whether PAR has successfully processed the FBU.  Hence,\n      it (re)sends\
    \ an FBU as soon as it attaches to NAR.  To enable NAR\n      to forward packets\
    \ immediately (when FBU has been processed) and\n      to allow NAR to verify\
    \ whether NCoA is acceptable, the MN SHOULD\n      encapsulate the FBU in the\
    \ FNA.  If NAR detects that NCoA is in\n      use when processing the FNA, for\
    \ instance while creating a\n      neighbor entry, it MUST discard the inner FBU\
    \ packet and send a\n      Router Advertisement with the \"Neighbor Advertisement\
    \ Acknowledge\n      (NAACK)\" option in which NAR MAY include an alternate IP\
    \ address\n      for the MN to use.  This discarding avoids the rare and\n   \
    \   undesirable outcome that results from address collision.  Detailed\n     \
    \ FNA processing rules are specified in Section 6.3.3.\n   The scenario in which\
    \ an MN sends an FBU and receives an FBack on\n   PAR's link is illustrated in\
    \ Figure 2.  For convenience, this\n   scenario is characterized as \"predictive\"\
    \ mode of operation.  The\n   scenario in which the MN sends an FBU from NAR's\
    \ link is illustrated\n   in Figure 3.  For convenience, this scenario is characterized\
    \ as a\n   \"reactive\" mode of operation.  Note that the reactive mode also\n\
    \   includes the case in which an FBU has been sent from PAR's link but\n   an\
    \ FBack has not been received yet.\n   Finally, the PrRtAdv message may be sent\
    \ unsolicited (i.e., without\n   the MN first sending a RtSolPr).  This mode is\
    \ described in Section\n   3.3.\n"
- title: 3.3.  Protocol Operation of Network-initiated Handover
  contents:
  - "3.3.  Protocol Operation of Network-initiated Handover\n   In some wireless technologies,\
    \ the handover control may reside in the\n   network even though the decision\
    \ to undergo handover may be mutually\n   arrived at between the MN and the network.\
    \  In these networks, the\n   PAR can send an unsolicited PrRtAdv containing the\
    \ link layer\n   address, IP address, and subnet prefixes of the NAR when the\
    \ network\n   decides that a handover is imminent.  The MN MUST process this\n\
    \   PrRtAdv to configure a new care of address on the new subnet, and\n   MUST\
    \ send an FBU to PAR prior to switching to the new link.  After\n   transmitting\
    \ PrRtAdv, the PAR MUST continue to forward packets to the\n   MN on its current\
    \ link until the FBU is received.  The rest of the\n   operation is the same as\
    \ that described in Section 3.2.\n   The unsolicited PrRtAdv also allows the network\
    \ to inform the MN\n   about geographically adjacent subnets without the MN having\
    \ to\n   explicitly request that information.  This can reduce the amount of\n\
    \   wireless traffic required for the MN to obtain a neighborhood\n   topology\
    \ map of links and subnets.  Such usage of PrRtAdv is\n   decoupled from the actual\
    \ handover; see Section 6.1.2.\n              MN                    PAR      \
    \            NAR\n               |                     |                    |\n\
    \               |------RtSolPr------->|                    |\n               |<-----PrRtAdv--------|\
    \                    |\n               |                     |               \
    \     |\n               |------FBU----------->|--------HI--------->|\n       \
    \        |                     |<------HAck---------|\n               |      \
    \    <--FBack---|--FBack--->         |\n               |                     |\
    \                    |\n            disconnect             forward           \
    \     |\n               |                   packets===============>|\n       \
    \        |                     |                    |\n               |      \
    \               |                    |\n           connect                   |\
    \                    |\n               |                     |               \
    \     |\n               |--------- FNA --------------------------->|\n       \
    \        |<=================================== deliver packets\n             \
    \  |                                          |\n                  Figure 2: \"\
    Predictive\" Fast Handover\n"
- title: 4.  Protocol Details
  contents:
  - "4.  Protocol Details\n   All descriptions refer to Figure 1.\n   After discovering\
    \ one or more nearby access points, the MN sends\n   RtSolPr to resolve access\
    \ point identifiers to subnet router\n   information.  This is convenient to do\
    \ after performing router\n   discovery.  However, the MN can send RtSolPr at\
    \ any time, e.g., when\n   one or more new access points are discovered.  The\
    \ MN can also send\n   RtSolPr more than once during its attachment to PAR.  The\
    \ trigger for\n   sending RtSolPr can originate from a link-specific event, such\
    \ as the\n   promise of a better signal strength from another access point coupled\n\
    \   with fading signal quality with the current access point.  Such\n   events,\
    \ often broadly referred to as \"L2 triggers\", are outside the\n   scope of this\
    \ document.  Nevertheless, they serve as events that\n   invoke this protocol.\
    \  For instance, when a \"link up\" indication is\n   obtained on the new link,\
    \ protocol messages (e.g., FNA) can be\n   immediately transmitted.  Implementations\
    \ SHOULD make use of such\n   triggers whenever possible.\n              MN  \
    \                  PAR                  NAR\n               |                \
    \     |                    |\n               |------RtSolPr------->|         \
    \           |\n               |<-----PrRtAdv--------|                    |\n \
    \              |                     |                    |\n            disconnect\
    \               |                    |\n               |                     |\
    \                    |\n               |                     |               \
    \     |\n            connect                  |                    |\n       \
    \        |------FNA[FBU]-------|------------------->|\n               |      \
    \               |<-----FBU-----------|\n               |                     |------FBack-------->|\n\
    \               |                   forward                |\n               |\
    \                   packets===============>|\n               |               \
    \      |                    |\n               |<===================================\
    \ deliver packets\n               |                                          |\n\
    \                   Figure 3: \"Reactive\" Fast Handover\n   The RtSolPr message\
    \ contains one or more AP-IDs.  A wildcard requests\n   all available tuples.\n\
    \   As a response to RtSolPr, PAR sends a PrRtAdv message that indicates\n   one\
    \ of the following possible conditions.\n   1. If the PAR does not have an entry\
    \ corresponding to the new access\n      point, it MUST respond indicating that\
    \ the new access point is\n      unknown.  The MN MUST stop fast handover protocol\
    \ operations on\n      the current link.  The MN MAY send an FBU from its new\
    \ link.\n   2. If the new access point is connected to the PAR's current\n   \
    \   interface (to which MN is attached), the PAR MUST respond with a\n      Code\
    \ value indicating that the new access point is connected to\n      the current\
    \ interface, but not send any prefix information.  This\n      scenario could\
    \ arise, for example, when several wireless access\n      points are bridged into\
    \ a wired network.  No further protocol\n      action is necessary.\n   3. If\
    \ the new access point is known and the PAR has information about\n      it, then\
    \ PAR MUST respond indicating that the new access point is\n      known and supply\
    \ the [AP-ID, AR-Info] tuple.  If the new access\n      point is known, but does\
    \ not support fast handover, the PAR MUST\n      indicate this with Code 3 (See\
    \ Section 6.1.2).\n   4. If a wildcard is supplied as an identifier for the new\
    \ access\n      point, the PAR SHOULD supply neighborhood [AP-ID, AR-Info] tuples\n\
    \      that are subject to path MTU restrictions (i.e., provide any `n'\n    \
    \  tuples without exceeding the link MTU).\n   When further protocol action is\
    \ necessary, some implementations MAY\n   choose to begin buffering copies of\
    \ incoming packets at the PAR.  If\n   such FIFO buffering is used, the PAR MUST\
    \ continue forwarding the\n   packets to PCoA (i.e., buffer and forward).  Such\
    \ buffering can be\n   useful when the MN leaves without sending the FBU message\
    \ from the\n   PAR's link.  The PAR SHOULD stop buffering after processing the\
    \ FBU\n   message.  The size of the buffer is an implementation-specific\n   consideration.\n\
    \   The method by which Access Routers exchange information about their\n   neighbors,\
    \ and thereby allow construction of Proxy Router\n   Advertisements with information\
    \ about neighboring subnets is outside\n   the scope of this document.\n   The\
    \ RtSolPr and PrRtAdv messages MUST be implemented by an MN and an\n   access\
    \ router that supports fast handovers.  However, when the\n   parameters necessary\
    \ for the MN to send packets immediately upon\n   attaching to the NAR are supplied\
    \ by the link layer handover\n   mechanism itself, use of above messages is optional\
    \ on such links.\n   After a PrRtAdv message is processed, the MN sends an FBU\
    \ at a time\n   determined by link-specific events, and includes the proposed\
    \ NCoA.\n   The MN SHOULD send the FBU from PAR's link whenever \"anticipation\"\
    \ of\n   handover is feasible.  When anticipation is not feasible or when it\n\
    \   has not received an FBack, the MN sends an FBU immediately after\n   attaching\
    \ to NAR's link.  This FBU SHOULD be encapsulated in an FNA\n   message.  The\
    \ encapsulation allows the NAR to discard the (inner) FBU\n   packet if an address\
    \ conflict is detected as a result of (outer) FNA\n   packet processing (see FNA\
    \ processing below).  In response to the\n   FBU, the PAR establishes a binding\
    \ between PCoA (\"Home Address\") and\n   NCoA, and sends the FBack to the MN.\
    \  Prior to establishing this\n   binding, PAR SHOULD send an HI message to NAR,\
    \ and receive HAck in\n   response.  To determine the NAR's address for the HI\
    \ message, the PAR\n   can perform the longest prefix match of NCoA (in FBU) with\
    \ the prefix\n   list of neighboring access routers.  When the source IP address\
    \ of\n   the FBU is PCoA, i.e., the FBU is sent from the PAR's link, and the\n\
    \   HI message MUST have a Code value set to 0; see Section 6.2.1.  When\n   the\
    \ source IP address of the FBU is not PCoA, i.e., the FBU is sent\n   from the\
    \ NAR's link, the HI message MUST have a Code value of 1; see\n   Section 6.2.1.\n\
    \   The HI message contains the PCoA, Link-Layer Address, and the NCoA of\n  \
    \ the MN.  In response to processing an HI message with Code 0, the NAR\n   1.\
    \ determines whether NCoA supplied in the HI message is a valid\n      address\
    \ for use.  If it is, the NAR starts proxying [6] the\n      address for PROXY_ND_LIFETIME\
    \ during which the MN is expected to\n      connect to the NAR.  The NAR MAY use\
    \ the Link-Layer Address to\n      verify whether a corresponding IP address exists\
    \ in its forwarding\n      tables.\n   2. allocates NCoA for the MN when assigned\
    \ addressing is used,\n      creates a proxy neighbor cache entry, and begins\
    \ defending it.\n      The NAR MAY allocate the NCoA proposed in HI.\n   3. MAY\
    \ create a host route entry for PCoA in case NCoA cannot be\n      accepted or\
    \ assigned.  This host route entry SHOULD be implemented\n      such that until\
    \ the MN's presence is detected, either through\n      explicit announcement by\
    \ the MN or by other means, arriving\n      packets do not invoke neighbor discovery.\
    \  The NAR MAY also set up\n      a reverse tunnel to the PAR in this case.\n\
    \   4. provides the status of the handover request in the Handover\n      Acknowledge\
    \ (HAck) message.\n   When the Code value in HI is 1, NAR MUST skip the above\
    \ operations\n   since it would have performed those operations during FNA processing.\n\
    \   However, it SHOULD be prepared to process any other options that may\n   be\
    \ defined in the future.  Sending an HI message with Code 1 allows\n   NAR to\
    \ validate the neighbor cache entry it creates for the MN during\n   FNA processing.\
    \  That is, NAR can make use of the knowledge that its\n   trusted peer (i.e.,\
    \ PAR) has a trust relationship with the MN.\n   If HAck contains an assigned\
    \ NCoA, the FBack MUST include it, and the\n   MN MUST use the address provided\
    \ in the FBack.  The PAR MAY send the\n   FBack to the previous link to facilitate\
    \ faster reception in the\n   event that the MN is still present.  The result\
    \ of the FBU and FBack\n   processing is that PAR begins tunneling the MN's packets\
    \ to NCoA.  If\n   the MN does not receive an FBack message even after retransmitting\n\
    \   the FBU for FBU_RETRIES, it must assume that fast handover support is\n  \
    \ not available and stop the protocol operation.\n   When the MN establishes link\
    \ connectivity with the NAR, it SHOULD\n   send a Fast Neighbor Advertisement\
    \ (FNA) message (see 6.3.3).  If the\n   MN has not received an FBack by the time\
    \ the FNA is being sent, it\n   SHOULD encapsulate the FBU in the FNA and send\
    \ them together.\n   When the NCoA corresponding to the FNA message is acceptable,\
    \ the NAR\n   MUST\n   1. delete its proxy neighbor cache entry, if any is present.\n\
    \   2. create a neighbor cache entry and set its state to REACHABLE\n      without\
    \ overwriting an existing entry for a different layer 2\n      address.\n   3.\
    \ forward any buffered packets.\n   4. enable the host route entry for PCoA, if\
    \ any is present.\n   When the NCoA corresponding to the FNA message is not acceptable,\
    \ the\n   NAR MUST\n   1. discard the inner (FBU) packet.\n   2. send a Router\
    \ Advertisement with the NAACK option in which it MAY\n      include an alternate\
    \ NCoA for use.  This message MUST be sent to\n      the source IP address present\
    \ in the FNA using the same Layer 2\n      address present in the FNA.\n   If\
    \ the MN receives a Router Advertisement with a NAACK option, it\n   MUST use\
    \ the IP address, if any, provided in the NAACK option.\n   Otherwise, the MN\
    \ should configure another NCoA.  Subsequently, the\n   MN SHOULD send an FBU\
    \ using the new CoA.  As a special case, the\n   address supplied in NAACK could\
    \ be PCoA itself, in which case the MN\n   MUST NOT send any more FBUs.\n   Once\
    \ the MN has confirmed its NCoA, it SHOULD send a Neighbor\n   Advertisement message.\
    \  This message allows MN's neighbors to update\n   their neighbor cache entries\
    \ with the MN's addresses.\n   Just as in Mobile IPv6, the PAR sets the 'R' bit\
    \ in the Prefix\n   Information option, and includes its 128 bit global address\
    \ in the\n   router advertisements.  This allows the mobile nodes to learn the\n\
    \   PAR's global IPv6 address.  The MN reverse tunnels its packets to the\n  \
    \ same global address of PAR.  The tunnel end-point addresses must be\n   configured\
    \ accordingly.  When PAR receives a reverse tunneled packet,\n   it must verify\
    \ if a secure binding exists for the MN identified by\n   PCoA in the tunneled\
    \ packet, before forwarding the packet.\n"
- title: 5.  Miscellaneous
  contents:
  - '5.  Miscellaneous

    '
- title: 5.1.  Handover Capability Exchange
  contents:
  - "5.1.  Handover Capability Exchange\n   The MN expects a PrRtAdv in response to\
    \ its RtSolPr message.  If the\n   MN does not receive a PrRtAdv message even\
    \ after RTSOLPR_RETRIES, it\n   must assume that PAR does not support the fast\
    \ handover protocol and\n   stop sending RtSolPr messages.\n   Even if an MN's\
    \ current access router is capable of fast handover,\n   the new access router\
    \ to which the MN attaches may be incapable of\n   fast handover.  This is indicated\
    \ to the MN during \"runtime\", through\n   the PrRtAdv message with a Code value\
    \ of 3 (see Section 6.1.2).\n"
- title: 5.2.  Determining New Care of Address
  contents:
  - "5.2.  Determining New Care of Address\n   Typically, the MN formulates its prospective\
    \ NCoA using the\n   information provided in a PrRtAdv message and sends the FBU.\
    \  The PAR\n   MUST use the NCoA present in the FBU in its HI message.  The NAR\
    \ MUST\n   verify if the NCoA present in HI is already in use.  In any case, NAR\n\
    \   MUST respond to HI using a HAck, in which it may include another NCoA\n  \
    \ to use, especially when assigned address configuration is used.  If\n   there\
    \ is a CoA present in HAck, the PAR MUST include it in the FBack\n   message.\n\
    \   If a PrRtAdv message carries an NCoA, the MN MUST use it as its\n   prospective\
    \ NCoA.\n"
- title: 5.3.  Packet Loss
  contents:
  - "5.3.  Packet Loss\n   Handover involves link switching, which may not be exactly\n\
    \   coordinated with fast handover signaling.  Furthermore, the arrival\n   pattern\
    \ of packets is dependent on many factors, including\n   application characteristics,\
    \ network queuing behaviors, etc.  Hence,\n   packets may arrive at the NAR before\
    \ the MN is able to establish its\n   link there.  These packets will be lost\
    \ unless they are buffered by\n   the NAR.  Similarly, if the MN attaches to the\
    \ NAR and then sends an\n   FBU message, packets arriving at the PAR will be lost\
    \ unless they are\n   buffered.  This protocol provides an option to indicate\
    \ a request for\n   buffering at the NAR in the HI message.  When the PAR requests\
    \ this\n   feature (for the MN), it SHOULD also provide its own support for\n\
    \   buffering.\n"
- title: 5.4.  DAD Handling
  contents:
  - "5.4.  DAD Handling\n   Duplicate Address Detection (DAD) was defined in [7] to\
    \ avoid address\n   duplication on links when stateless address auto-configuration\
    \ is\n   used.  The use of DAD to verify the uniqueness of an IPv6 address\n \
    \  configured through stateless auto-configuration adds delays to a\n   handover.\n\
    \   The probability of an interface identifier duplication on the same\n   subnet\
    \ is very low, however it cannot be ignored.  In this document,\n   certain precautions\
    \ are proposed to minimize the effects of a\n   duplicate address occurrence.\n\
    \   In some cases, the NAR may already have the knowledge required to\n   assess\
    \ whether the MN's address is a duplicate before the MN moves to\n   the new subnet.\
    \  For example, the NAR can have a list of all nodes on\n   its subnet, perhaps\
    \ for access control, and by searching this list,\n   it can confirm whether the\
    \ MN's address is a duplicate.  The result\n   of this search is sent back to\
    \ the PAR in the HAck message.  If such\n   knowledge is not available at the\
    \ NAR, it may indicate this by not\n   confirming the NCoA in the HAck message.\
    \  The NAR may also indicate\n   this in the NAACK option in response to the FNA\
    \ message.  In such\n   cases, the MN would have to follow the address configuration\n\
    \   procedure according to [6] after attaching to the NAR.\n"
- title: 5.5.  Fast or Erroneous Movement
  contents:
  - "5.5.  Fast or Erroneous Movement\n   Although this specification is for fast\
    \ handover, the protocol is\n   limited in terms of how fast an MN can move. \
    \ Ping-Pong is a special\n   case of fast movement, where an MN moves between\
    \ the same two access\n   points rapidly.  Another instance of the same problem\
    \ is erroneous\n   movement, i.e., the MN receives information prior to a handover\
    \ that\n   it is moving to a new access point, but it is either moved to a\n \
    \  different one or it aborts movement altogether.  All of the above\n   behaviors\
    \ are usually the result of link layer idiosyncrasies and\n   thus are often resolved\
    \ at the link layer itself.\n   IP layer mobility, however, introduces its own\
    \ limits.  IP layer\n   handovers should occur at a rate suitable for the MN to\
    \ update the\n   binding of, at least, its HA and preferably that of every CN\
    \ with\n   which it is in communication.  An MN that moves faster than necessary\n\
    \   for this signaling to complete, which may be a few seconds, may start\n  \
    \ losing packets.  The signaling cost over the air interface and in the\n   network\
    \ may increase significantly, especially in the case of rapid\n   movement between\
    \ several access routers.  To avoid the signaling\n   overhead, the following\
    \ measures are suggested.\n   An MN returning to the PAR before updating the necessary\
    \ bindings\n   when present on the NAR MUST send a Fast Binding Update with the\
    \ Home\n   Address equal to the MN's PCoA and a lifetime of zero to the PAR.\n\
    \   The MN should have a security association with the PAR since it\n   performed\
    \ a fast handover to the NAR.  The PAR, upon receiving this\n   Fast Binding Update,\
    \ will check its set of outgoing (temporary fast\n   handover) tunnels.  If it\
    \ finds a match, it SHOULD tear down that\n   tunnel (i.e., stop forwarding packets\
    \ for this MN and start\n   delivering packets directly to the node instead).\
    \  The MN SHOULD NOT\n   attempt to use any of the fast handover mechanisms described\
    \ in this\n   specification and SHOULD revert back to standard Mobile IPv6.\n\
    \   Temporary tunnels for the purpose of fast handovers should use short\n   lifetimes\
    \ (a small number of seconds or less).  The lifetime of such\n   tunnels should\
    \ be enough to allow an MN to update all its active\n   bindings.  The default\
    \ lifetime of the tunnel should be the same as\n   the lifetime value in the FBU\
    \ message.\n   The effect of erroneous movement is typically limited to the loss\
    \ of\n   packets since routing can change and the PAR may forward packets\n  \
    \ toward another router before the MN actually connects to that router.\n   If\
    \ the MN discovers itself on an unanticipated access router, a Fast\n   Binding\
    \ Update to the PAR SHOULD be sent.  Since Fast Binding Updates\n   are authenticated,\
    \ they supercede the existing binding and packets\n   MUST be redirected to the\
    \ newly confirmed location of the MN.\n"
- title: 6.  Message Formats
  contents:
  - "6.  Message Formats\n   All the ICMPv6 messages have a common Type specified\
    \ in [4].  The\n   messages are distinguished based on the Subtype field (see\
    \ below).\n   The values for the Subtypes are specified in Section 9.  For all\
    \ the\n   ICMPv6 messages, the checksum is defined in [2].\n"
- title: 6.1.  New Neighborhood Discovery Messages
  contents:
  - '6.1.  New Neighborhood Discovery Messages

    '
- title: 6.1.1.  Router Solicitation for Proxy Advertisement (RtSolPr)
  contents:
  - "6.1.1.  Router Solicitation for Proxy Advertisement (RtSolPr)\n   Mobile Nodes\
    \ send Router Solicitation for Proxy Advertisement in\n   order to prompt routers\
    \ for Proxy Router Advertisements.  All the\n   Link-Layer Address options have\
    \ the format defined in 6.4.3.\n    0                   1                   2\
    \                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |     Code      |          Checksum             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Subtype     |   Reserved    |          Identifier           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n       Figure 4: Router Solicitation\
    \ for Proxy (RtSolPr) Message\n   IP Fields:\n      Source Address\n         \
    \            An IP address assigned to the sending interface.\n      Destination\
    \ Address\n                     The address of the Access Router or the all routers\n\
    \                     multicast address.\n      Hop Limit      255.  See RFC 2461.\n\
    \      Authentication Header\n                     If a Security Association for\
    \ the IP Authentication\n                     Header exists between the sender\
    \ and the\n                     destination address, then the sender SHOULD include\n\
    \                     this header.  See RFC 2402 [5].\n   ICMP Fields:\n     \
    \ Type           The Experimental Mobility Protocol Type.  See [4].\n      Code\
    \           0\n      Checksum       The ICMPv6 checksum.\n      Subtype      \
    \  2\n      Reserved       MUST be set to zero by the sender and ignored by\n\
    \                     the receiver.\n      Identifier     MUST be set by the sender\
    \ so that replies can be\n                     matched to this Solicitation.\n\
    \   Valid Options:\n      Source Link-Layer Address\n                     When\
    \ known, the Link-Layer Address of the sender\n                     SHOULD be\
    \ included using the Link-Layer Address\n                     option.  See the\
    \ LLA option format below.\n      New Access Point Link-Layer Address\n      \
    \               The Link-Layer Address or identification of the\n            \
    \         access point for which the MN requests routing\n                   \
    \  advertisement information.  It MUST be included in\n                     all\
    \ RtSolPr messages.  More than one such address\n                     or identifier\
    \ can be present.  This field can also\n                     be a wildcard address\
    \ with all bits set to zero.\n   Future versions of this protocol may define new\
    \ option types.\n   Receivers MUST silently ignore any options that they do not\
    \ recognize\n   and continue processing the rest of the message.\n   Including\
    \ the source LLA option allows the receiver to record the\n   sender's L2 address\
    \ so that neighbor discovery can be avoided when\n   the receiver needs to send\
    \ packets back to the sender (of the RtSolPr\n   message).\n   When a wildcard\
    \ is used for a New Access Point LLA, no other New\n   Access Point LLA options\
    \ must be present.\n   A Proxy Router Advertisement (PrRtAdv) message should be\
    \ received by\n   the MN in response to a RtSolPr.  If such a message is not received\n\
    \   in a timely manner (no less than twice the typical round trip time\n   (RTT)\
    \ over the access link or 100 milliseconds if RTT is not known),\n   it SHOULD\
    \ resend the RtSolPr message.  Subsequent retransmissions can\n   be up to RTSOLPR_RETRIES,\
    \ but MUST use an exponential backoff in\n   which the timeout period (i.e., 2xRTT\
    \ or 100 milliseconds) is doubled\n   prior to each instance of retransmission.\
    \  If Proxy Router\n   Advertisement is not received by the time the MN disconnects\
    \ from the\n   PAR, the MN SHOULD send an FBU immediately after configuring a\
    \ new\n   CoA.\n   When RtSolPr messages are sent more than once, they MUST be\
    \ rate\n   limited with MAX_RTSOLPR_RATE per second.  During each use of a\n \
    \  RtSolPr, exponential backoff is used for retransmissions.\n"
- title: 6.1.2.  Proxy Router Advertisement (PrRtAdv)
  contents:
  - "6.1.2.  Proxy Router Advertisement (PrRtAdv)\n   Access routers send Proxy Router\
    \ Advertisement messages gratuitously\n   if the handover is network-initiated\
    \ or as a response to a RtSolPr\n   message from an MN, providing the Link-Layer\
    \ Address, IP address, and\n   subnet prefixes of neighboring routers.  All the\
    \ Link-Layer Address\n   options have the format defined in Section 6.4.3.\n \
    \  IP Fields:\n      Source Address\n                     MUST be the Link-Local\
    \ Address assigned to the\n                     interface from which this message\
    \ is sent.\n      Destination Address\n                     The Source Address\
    \ of an invoking Router\n                     Solicitation for a Proxy Advertisement\
    \ or the\n                     address of the node the Access Router is\n    \
    \                 instructing to handover.\n    0                   1        \
    \           2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |     Code      |          Checksum             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Subtype     |   Reserved    |          Identifier           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n         Figure 5: Proxy Router\
    \ Advertisement (PrRtAdv) Message\n      Hop Limit      255.  See RFC 2461 [6].\n\
    \      Authentication Header\n                     If a Security Association for\
    \ the IP Authentication\n                     Header exists between the sender\
    \ and the\n                     destination address, the sender SHOULD include\
    \ this\n                     header.  See RFC 2402 [5].\n   ICMP Fields:\n   \
    \   Type           The Experimental Mobility Protocol Type.  See RFC\n       \
    \              4065 [4].\n      Code           0, 1, 2, 3 or 4.  See below.\n\
    \      Checksum       The ICMPv6 checksum.\n      Subtype        3\n      Reserved\
    \       MUST be set to zero by the sender and ignored by\n                   \
    \  the receiver.\n      Identifier     Copied from the Router Solicitation for\
    \ Proxy\n                     Advertisement or set to Zero if unsolicited.\n \
    \  Valid Options in the following order:\n      Source Link-Layer Address\n  \
    \                   When known, the Link-Layer Address of the sender\n       \
    \              SHOULD be included using the Link-Layer Address\n             \
    \        option.  See the LLA option format below.\n      New Access Point Link-Layer\
    \ Address\n                     The Link-Layer Address or identification of the\n\
    \                     access point is copied from the RtSolPr message.\n     \
    \                This option MUST be present.\n      New Router's Link-Layer Address\n\
    \                     The Link-Layer Address of the Access Router for\n      \
    \               which this message is proxied.  This option MUST be\n        \
    \             included when Code is 0 or 1.\n      New Router's IP Address\n \
    \                    The IP address of NAR.  This option MUST be\n           \
    \          included when Code is 0 or 1.\n      New Router Prefix Information\
    \ Option.\n                     Specifies the prefix of the Access Router for\
    \ which\n                     the message is proxied and is used for address\n\
    \                     auto-configuration.  This option MUST be included\n    \
    \                 when Code is 0 or 1.  However, when this prefix is\n       \
    \              the same as that used in the New Router's IP\n                \
    \     Address option (above), the Prefix Information\n                     option\
    \ need not be present.\n      New CoA Option\n                     MAY be present\
    \ when a PrRtAdv is sent unsolicited.\n                     PAR MAY compute a\
    \ new CoA using NAR's prefix\n                     information and the MN's L2\
    \ address, or by any\n                     other means.\n   Future versions of\
    \ this protocol may define new option types.\n   Receivers MUST silently ignore\
    \ any options they do not recognize and\n   continue processing the message.\n\
    \   Currently, Code values 0, 1, 2, 3 and 4 are defined.\n   A Proxy Router Advertisement\
    \ with Code 0 means that the MN should use\n   the [AP-ID, AR-Info] tuple (present\
    \ in the options above) for\n   movement detection and NCoA formulation.  In this\
    \ case, the Option-\n   Code field in the New Access Point LLA option is 1, reflecting\
    \ the\n   LLA of the access point for which the rest of the options are\n   related.\
    \  Multiple tuples may be present.\n   A Proxy Router Advertisement with Code\
    \ 1 means that the message is\n   sent unsolicited.  If a New CoA option is present\
    \ following the New\n   Router Prefix Information option, the MN SHOULD use the\
    \ supplied NCoA\n   and send the FBU immediately or else stand to lose service.\
    \  This\n   message acts as a network-initiated handover trigger; see Section\n\
    \   3.3.  The Option-Code field in the New Access Point LLA option (see\n   below)\
    \ in this case is 1 reflecting the LLA of the access point for\n   which the rest\
    \ of the options are related.\n   A Proxy Router Advertisement with Code 2 means\
    \ that no new router\n   information is present.  Each New Access Point LLA option\
    \ contains an\n   Option-Code value (described below) that indicates a specific\n\
    \   outcome.\n      -  When the Option-Code field in the New Access Point LLA\
    \ option\n         is 5, handover to that access point does not require a change\n\
    \         of CoA.  No other options are required in this case.\n      -  When\
    \ the Option-Code field in the New Access Point LLA option\n         is 6, the\
    \ PAR is not aware of the Prefix Information requested.\n         The MN SHOULD\
    \ attempt to send an FBU as soon as it regains\n         connectivity with the\
    \ NAR.  No other options are required in\n         this case.\n      -  When the\
    \ Option-Code field in the New Access Point LLA option\n         is 7, it means\
    \ that the NAR does not support fast handover.\n         The MN MUST stop fast\
    \ handover protocol operations.  No other\n         options are required in this\
    \ case.\n   A Proxy Router Advertisement with Code 3 means that new router\n \
    \  information is only present for a subset of access points requested.\n   The\
    \ Option-Code field values (defined above including a value of 1)\n   distinguish\
    \ different outcomes for individual access points.\n   A Proxy Router Advertisement\
    \ with Code 4 means that the subnet\n   information regarding neighboring access\
    \ points is sent unsolicited,\n   but the message is not a handover trigger, unlike\
    \ when the message is\n   sent with Code 1.  Multiple tuples may be present.\n\
    \   When a wildcard AP identifier is supplied in the RtSolPr message, the\n  \
    \ PrRtAdv message should include any `n' [Access Point Identifier,\n   Link-Layer\
    \ Address option, Prefix Information Option] tuples\n   corresponding to the PAR's\
    \ neighborhood.\n"
- title: 6.2.  Inter-Access Router Messages
  contents:
  - '6.2.  Inter-Access Router Messages

    '
- title: 6.2.1.  Handover Initiate (HI)
  contents:
  - "6.2.1.  Handover Initiate (HI)\n   The Handover Initiate (HI) is an ICMPv6 message\
    \ sent by an Access\n   Router (typically PAR) to another Access Router (typically\
    \ NAR) to\n   initiate the process of a MN's handover.\n    0                \
    \   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |     Code      |          Checksum             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Subtype     |S|U| Reserved  |          Identifier           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n                Figure 6: Handover\
    \ Initiate (HI) Message\n   IP Fields:\n      Source Address\n               \
    \      The IP address of the PAR.\n      Destination Address\n               \
    \      The IP address of the NAR.\n      Hop Limit      255.  See RFC 2461 [6].\n\
    \       Authentication Header\n                     The authentication header\
    \ MUST be used when this\n                     message is sent.  See RFC 2402\
    \ [5].\n   ICMP Fields:\n      Type           The Experimental Mobility Protocol\
    \ Type.  See RFC\n                     4065 [4].\n      Code           0 or 1.\
    \  See below\n      Checksum       The ICMPv6 checksum.\n      Subtype       \
    \ 4\n      S flag         Assigned address configuration flag.  When set,\n  \
    \                   this message requests a new CoA to be returned by\n      \
    \               the destination.  May be set when Code = 0.  MUST\n          \
    \           be 0 when Code = 1.\n      U flag         Buffer flag.  When set,\
    \ the destination SHOULD\n                     buffer any packets moving toward\
    \ the node indicated\n                     in the options of this message.  Used\
    \ when Code =\n                     0, SHOULD be set to 0 when Code = 1.\n   \
    \   Reserved       MUST be set to zero by the sender and ignored by\n        \
    \             the receiver.\n      Identifier     MUST be set by the sender so\
    \ replies can be matched\n                     to this message.\n   Valid Options:\n\
    \      Link-Layer Address of MN\n                     The Link-Layer Address of\
    \ the MN that is undergoing\n                     handover to the destination\
    \ (i.e., NAR).  This\n                     option MUST be included so that the\
    \ destination can\n                     recognize the MN.\n      Previous Care\
    \ of Address\n                     The IP address used by the MN while attached\
    \ to the\n                     originating router.  This option SHOULD be included\n\
    \                     so that a host route can be established if\n           \
    \          necessary.\n      New Care of Address\n                     The IP\
    \ address the MN wishes to use when connected\n                     to the destination.\
    \  When the `S' bit is set, the\n                     NAR MAY assign this address.\n\
    \   The PAR uses a Code value of 0 when it processes an FBU with PCoA as\n   a\
    \ source IP address.  The PAR uses a Code value of 1 when it\n   processes an\
    \ FBU whose source IP address is not PCoA.\n   If a Handover Acknowledge (HAck)\
    \ message is not received as a\n   response in a short time period (no less than\
    \ twice the typical RTT\n   between source and destination, or 100 milliseconds\
    \ if RTT is not\n   known), the Handover Initiate SHOULD be resent.  Subsequent\n\
    \   retransmissions can be up to HI_RETRIES, but MUST use exponential\n   backoff\
    \ in which the timeout period (i.e., 2xRTT or 100 milliseconds)\n   is doubled\
    \ during each instance of retransmission.\n"
- title: 6.2.2.  Handover Acknowledge (HAck)
  contents:
  - "6.2.2.  Handover Acknowledge (HAck)\n   The Handover Acknowledgment message is\
    \ a new ICMPv6 message that MUST\n   be sent (typically by NAR to PAR) as a reply\
    \ to the Handover Initiate\n   message.\n    0                   1           \
    \        2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |     Code      |          Checksum             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Subtype     |    Reserved   |          Identifier           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n              Figure 7: Handover\
    \ Acknowledge (HAck) Message\n   IP Fields:\n      Source Address\n          \
    \           Copied from the destination address of the Handover\n            \
    \         Initiate Message to which this message is a\n                     response.\n\
    \      Destination Address\n                     Copied from the source address\
    \ of the Handover\n                     Initiate Message to which this message\
    \ is a\n                     response.\n      Hop Limit      255.  See RFC 2461\
    \ [6].\n      Authentication Header\n                     The authentication header\
    \ MUST be used when this\n                     message is sent.  See RFC 2402\
    \ [5].\n   ICMP Fields:\n      Type           The Experimental Mobility Protocol\
    \ Type.  See RFC\n                     4065 [4].\n      Code\n               \
    \        0: Handover Accepted, NCoA valid\n                       1: Handover\
    \ Accepted, NCoA not valid\n                       2: Handover Accepted, NCoA\
    \ in use\n                       3: Handover Accepted, NCoA assigned\n       \
    \                   (used in Assigned addressing)\n                       4: Handover\
    \ Accepted, NCoA not assigned\n                          (used in Assigned addressing)\n\
    \                     128: Handover Not Accepted, reason unspecified\n       \
    \              129: Administratively prohibited\n                     130: Insufficient\
    \ resources\n      Checksum       The ICMPv6 checksum.\n      Subtype        5\n\
    \      Reserved       MUST be set to zero by the sender and ignored by\n     \
    \                the receiver.\n      Identifier     Copied from the corresponding\
    \ field in the Handover\n                     Initiate message to which this message\
    \ is a\n                     response.\n   Valid Options:\n      New Care of Address\n\
    \                     If the S flag in the Handover Initiate message is\n    \
    \                 set, this option MUST be used to provide NCoA the\n        \
    \             MN should use when connected to this router.  This\n           \
    \          option MAY be included, even when the `S' bit is\n                \
    \     not set, e.g., Code 2 above.\n   Upon receiving an HI message, the NAR MUST\
    \ respond with a Handover\n   Acknowledge message.  If the `S' flag is set in\
    \ the HI message, the\n   NAR SHOULD include the New Care of Address option and\
    \ a Code 3.\n   The NAR MAY provide support for PCoA (instead of accepting or\n\
    \   assigning NCoA), establish a host route entry for PCoA, and set up a\n   tunnel\
    \ to the PAR to forward MN's packets sent with PCoA as a source\n   IP address.\
    \  This host route entry SHOULD be used to forward packets\n   once the NAR detects\
    \ that the particular MN is attached to its link.\n   When responding to an HI\
    \ message containing a Code value 1, the Code\n   values 1, 2, and 4 in the HAck\
    \ message are not relevant.\n   Finally, the new access router can always refuse\
    \ handover, in which\n   case it should indicate the reason in one of the available\
    \ Code\n   values.\n"
- title: 6.3.  New Mobility Header Messages
  contents:
  - "6.3.  New Mobility Header Messages\n   Mobile IPv6 uses a new IPv6 header type\
    \ called Mobility Header [3].\n   The Fast Binding Update, Fast Binding Acknowledgment,\
    \ and Fast\n   Neighbor Advertisement messages use the Mobility Header.\n"
- title: 6.3.1.  Fast Binding Update (FBU)
  contents:
  - "6.3.1.  Fast Binding Update (FBU)\n   The Fast Binding Update message is identical\
    \ to the Mobile IPv6\n   Binding Update (BU) message.  However, the processing\
    \ rules are\n   slightly different.\n                                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                    |          Sequence #           |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |A|H|L|K|        Reserved       |           Lifetime            |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    .\
    \                                                               .\n    .     \
    \                   Mobility options                       .\n    .          \
    \                                                     .\n    |               \
    \                                                |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \              Figure 8: Fast Binding Update (FBU) Message\n   IP fields:\n  \
    \    Source Address\n                     The PCoA or NCoA\n      Destination\
    \ Address\n                     The IP address of the Previous Access Router\n\
    \      A flag       MUST be set to one to request that PAR send a Fast\n     \
    \                Binding Acknowledgment message.\n      H flag       MUST be set\
    \ to one.  See RFC 3775 [3].\n      L flag       See RFC 3775 [3].\n      K flag\
    \       See RFC 3775 [3].\n      Reserved       This field is unused.  MUST be\
    \ set zero.\n      Sequence Number\n                     See RFC 3775 [3].\n \
    \     Lifetime       See RFC 3775 [3].\n      Mobility Options\n             \
    \        MUST contain an alternate CoA option set to the\n                   \
    \  NCoA when an FBU is sent from PAR's link.\n   The MN sends an FBU message any\
    \ time after receiving a PrRtAdv\n   message.  If the MN moves prior to receiving\
    \ a PrRtAdv message, it\n   SHOULD send an FBU to the PAR after configuring NCoA\
    \ on the NAR\n   according to Neighbor Discovery and IPv6 Address Configuration\n\
    \   protocols.\n   The source IP address is PCoA when the FBU is sent from PAR's\
    \ link,\n   and the source IP address is NCoA when sent from NAR's link.  When\n\
    \   the FBU is sent from NAR's link, it SHOULD be encapsulated within an\n   FNA.\n\
    \   The FBU MUST also include the Home Address Option, and the Home\n   Address\
    \ is PCoA.  An FBU message MUST be protected so that PAR is\n   able to determine\
    \ that the FBU message is sent by a genuine MN.\n"
- title: 6.3.2.  Fast Binding Acknowledgment (FBack)
  contents:
  - "6.3.2.  Fast Binding Acknowledgment (FBack)\n   The Fast Binding Acknowledgment\
    \ message is sent by the PAR to\n   acknowledge receipt of a Fast Binding Update\
    \ message in which the 'A'\n   bit is set.  The Fast Binding Acknowledgment message\
    \ SHOULD NOT be\n   sent to the MN before the PAR receives a HAck message from\
    \ the NAR.\n   The Fast Binding Acknowledgment MAY also be sent to the MN on the\
    \ old\n   link.\n                                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                    |    Status     |K|  Reserved   |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |           Sequence #          |           Lifetime            |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    .\
    \                                                               .\n    .     \
    \                   Mobility options                       .\n    .          \
    \                                                     .\n    |               \
    \                                                |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \          Figure 9: Fast Binding Acknowledgment (FBack) Message\n   IP fields:\n\
    \      Source Address\n                     The IP address of the Previous Access\
    \ Router.\n                     Destination Address\n                     The\
    \ NCoA\n      Status         8-bit unsigned integer indicating the disposition\n\
    \                     of the Fast Binding Update.  Values of the Status\n    \
    \                 field that are less than 128 indicate that the\n           \
    \          Binding Update was accepted by the receiving node.\n              \
    \       The following such Status values are currently\n                     defined:\n\
    \                     0 Fast Binding Update accepted\n                     1 Fast\
    \ Binding Update accepted but NCoA is\n                       invalid.  Use NCoA\
    \ supplied in \"alternate\" CoA\n                     Values of the Status field\
    \ that are greater than or\n                     equal to 128 indicate that the\
    \ Binding Update was\n                     rejected by the receiving node.  The\
    \ following such\n                     Status values are currently defined:\n\
    \                     128 Reason unspecified\n                     129 Administratively\
    \ prohibited\n                     130 Insufficient resources\n              \
    \       131 Incorrect interface identifier length\n      `K' flag       See RFC\
    \ 3775 [3].\n      Reserved       An unused field.  MUST be set to zero.\n   \
    \   Sequence Number\n                     Copied from the FBU message for use\
    \ by the MN in\n                     matching this acknowledgment with an outstanding\n\
    \                     FBU.\n      Lifetime       The granted lifetime in seconds\
    \ for which the\n                     sender of this message will retain a binding\
    \ for\n                     traffic redirection.\n      Mobility Options\n   \
    \                  MUST contain an \"alternate\" CoA if Status is 1.\n"
- title: 6.3.3.  Fast Neighbor Advertisement (FNA)
  contents:
  - "6.3.3.  Fast Neighbor Advertisement (FNA)\n   A MN sends a Fast Neighbor Advertisement\
    \ to announce itself to the\n   NAR.  When the Mobility Header Type is FNA, the\
    \ Payload Proto field\n   may be set to IPv6 to assist FBU encapsulation.\n  \
    \                                  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n       \
    \                             |            Reserved           |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    .                                                               .\n    .\
    \                        Mobility Options                       .\n    .     \
    \                                                          .\n    |          \
    \                                                     |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \           Figure 10: Fast Neighbor Advertisement (FNA) Message\n   IP fields:\n\
    \      Source Address\n                     NCoA\n      Destination Address\n\
    \                     NAR's IP Address\n      Mobility Options\n             \
    \        MUST contain the Mobility Header Link-Layer Address\n               \
    \      of the MN in the MH-LLA option format.  See Section\n                 \
    \    6.4.4.\n   The MN sends a Fast Neighbor Advertisement to the NAR, as soon\
    \ as it\n   regains connectivity on the new link.  Arriving or buffered packets\n\
    \   can be immediately forwarded.  If NAR is proxying NCoA, it creates a\n   neighbor\
    \ cache entry in REACHABLE state.  If there is no entry, it\n   creates one and\
    \ sets it to REACHABLE.  If there is an entry in the\n   INCOMPLETE state without\
    \ a Link-Layer Address, it sets it to\n   REACHABLE.  During the process of creating\
    \ a neighbor cache entry,\n   NAR can also detect if NCoA is in use, thus avoiding\
    \ address\n   collisions.  Since the FBU is encapsulated within the FNA when sent\n\
    \   from NAR's link, NAR drops the FBU if it detects a collision.\n   The combination\
    \ of NCoA (present in source IP address) and the Link-\n   Layer Address (present\
    \ as a Mobility Option) SHOULD be used to\n   distinguish the MN from other nodes.\n"
- title: 6.4.  New Options
  contents:
  - "6.4.  New Options\n   All the options are of the form shown in Figure 11.\n \
    \  The Type values are defined from the Neighbor Discovery options\n   space.\
    \  The Length field is in units of 8 octets, except for the\n   Mobility Header\
    \ Link-Layer Address option, whose Length field is in\n   units of octets in accordance\
    \ with Section 6.2 in [3].  Option-Code\n   provides additional information for\
    \ each of the options (See\n   individual options below).\n    0             \
    \      1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |    Length     |  Option-Code  |               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   ~                              ...                              ~\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                       Figure 11: Option Format\n"
- title: 6.4.1.  IP Address Option
  contents:
  - "6.4.1.  IP Address Option\n   This option is sent in the Proxy Router Advertisement,\
    \ the Handover\n   Initiate, and Handover Acknowledge messages.\n    0       \
    \            1                   2                   3\n    0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |    Length     | Option-Code   | Prefix Length |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          Reserved                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                                                             +\n   |        \
    \                                                       |\n   +              \
    \            IPv6 Address                         +\n   |                    \
    \                                           |\n   +                          \
    \                                     +\n   |                                \
    \                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                     Figure 12: IPv6 Address Option\n      Type           17\n\
    \      Length         The size of this option in 8 octets including the\n    \
    \                 Type, Option-Code, and Length fields.\n      Option-Code   \
    \ 1   Old Care-of Address\n                     2   New Care-of Address\n    \
    \                 3   NAR's IP address\n      Prefix Length\n                \
    \     The Length of the IPv6 Address Prefix.\n      Reserved       MUST be set\
    \ to zero by the sender and MUST be\n                     ignored by the receiver.\n\
    \      IPv6 Address   The IP address for the unit defined by the Type\n      \
    \               field.\n"
- title: 6.4.2.  New Router Prefix Information Option
  contents:
  - "6.4.2.  New Router Prefix Information Option\n   This option is sent in the PrRtAdv\
    \ message to provide the prefix\n   information valid on the NAR.\n   0      \
    \             1                   2                   3\n   0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |    Length     |  Option-Code  | Prefix Length |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          Reserved                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                                                             +\n   |        \
    \                                                       |\n   +              \
    \              Prefix                             +\n   |                    \
    \                                           |\n   +                          \
    \                                     +\n   |                                \
    \                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \           Figure 13: New Router Prefix Information Option\n      Type      \
    \     18\n      Length         The size of this option in 8 octets including the\n\
    \                     Type, Option-Code, and Length fields.\n      Option-Code\
    \    0\n      Prefix Length\n                     8-bit unsigned integer.  The\
    \ number of leading bits\n                     in the Prefix that are valid. \
    \ The value ranges\n                     from 0 to 128.\n      Reserved      \
    \ MUST be set to zero by the sender and MUST be\n                     ignored\
    \ by the receiver.\n      Prefix         An IP address or a prefix of an IP address.\
    \  The\n                     Prefix Length field contains the number of valid\n\
    \                     leading bits in the prefix.  The bits in the prefix\n  \
    \                   after the prefix length are reserved and MUST be\n       \
    \              initialized to zero by the sender and ignored by\n            \
    \         the receiver.\n"
- title: 6.4.3.  Link-Layer Address (LLA) Option
  contents:
  - "6.4.3.  Link-Layer Address (LLA) Option\n    0                   1          \
    \         2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Type       |    Length     |  Option-Code  |      LLA...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                  Figure 14: Link-Layer Address Option\n      Type          \
    \ 19\n      Length         The size of this option in 8 octets including the\n\
    \                     Type, Option-Code, and Length fields.\n      Option-Code\n\
    \                     0  wildcard requesting resolution for all nearby\n     \
    \                   access points\n                     1  Link-Layer Address\
    \ of the New Access Point\n                     2  Link-Layer Address of the MN\n\
    \                     3  Link-Layer Address of the NAR (i.e., Proxied\n      \
    \                  Originator)\n                     4  Link-Layer Address of\
    \ the source of the RtSolPr\n                        or PrRtAdv message\n    \
    \                 5  The access point identified by the LLA belongs\n        \
    \                to the current interface of the router\n                    \
    \ 6  No prefix information available for the access\n                        point\
    \ identified by the LLA\n                     7  No fast handovers support available\
    \ for the\n                        access point identified by the LLA\n      LLA\
    \            The variable length Link-Layer Address.\n   Depending on the size\
    \ of the individual LLA option, appropriate\n   padding MUST be used to ensure\
    \ that the entire option size is a\n   multiple of 8 octets.\n   The New Access\
    \ Point Link-Layer Address contains the Link-Layer\n   Address of the access point\
    \ for which handover is about to be\n   attempted.  This is used in the Router\
    \ Solicitation for the Proxy\n   Advertisement message.\n   The MN Link-Layer\
    \ Address option contains the Link-Layer Address of\n   an MN.  It is used in\
    \ the Handover Initiate message.\n   The NAR (i.e., Proxied Originator) Link-Layer\
    \ Address option contains\n   the Link-Layer Address of the Access Router to which\
    \ the Proxy Router\n   Solicitation message refers.\n"
- title: 6.4.4.  Mobility Header Link-Layer Address (MH-LLA) Option
  contents:
  - "6.4.4.  Mobility Header Link-Layer Address (MH-LLA) Option\n   This option is\
    \ identical to the LLA option, but is carried in the\n   Mobility Header messages\
    \ (i.e., FNA).  In the future, other Mobility\n   Header messages may also make\
    \ use of this option.  For instance,\n   including this option in FBU allows PAR\
    \ to obtain the MN's LLA\n   readily.  The format of the option when the LLA is\
    \ 6 bytes is shown\n   in Figure 15.  When the LLA size is different, the option\
    \ MUST be\n   aligned appropriately.  See Section 6.2 in [3].\n    0         \
    \          1                   2                   3\n    0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                              \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                                   |\
    \      Type     |    Length     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | Option-Code   |    Pad0=0     |         LLA                   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                             LLA                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Figure 15: Mobility Header Link-Layer Address Option\n      Type   \
    \        7\n      Length         The size of this option in octets not including\
    \ the\n                     Type, Length, and Option-Code fields.\n      Option-Code\
    \    2 Link-Layer Address of the MN\n      LLA            The variable length\
    \ Link-Layer Address.\n"
- title: 6.4.5.  Neighbor Advertisement Acknowledgment (NAACK)
  contents:
  - "6.4.5.  Neighbor Advertisement Acknowledgment (NAACK)\n    0                \
    \   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |    Length     | Option-Code   |     Status    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          Reserved                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       Figure 16: Neighbor Advertisement Acknowledgment Option\n      Type  \
    \         20\n      Length         8-bit unsigned integer.  Length of the option,\
    \ in 8\n                     octets.  The length is 1 when NCoA is not supplied.\n\
    \                     The length is 3 when NCoA is supplied (immediately\n   \
    \                  following the Reserved field).\n      Option-Code    0\n  \
    \    Status         8-bit unsigned integer indicating the disposition\n      \
    \               of the Fast Neighbor Advertisement message.  The\n           \
    \          following Status values are currently defined:\n                  \
    \     1   The New CoA is invalid.\n                       2   The New CoA is invalid;\
    \ use the supplied CoA.\n                           The New CoA MUST be present\
    \ following the\n                           Reserved field.\n                \
    \     128   Link Layer Address unrecognized.\n      Reserved       MUST be set\
    \ to zero by the sender and MUST be\n                     ignored by the receiver.\n\
    \   The NAR responds to the FNA with the NAACK option to notify the MN to\n  \
    \ use a different NCoA if there is address collision.  If the NCoA is\n   invalid,\
    \ the Router Advertisement MUST use the NCoA as the\n   destination address but\
    \ use the L2 address present in the FNA.  The\n   MN SHOULD use the NCoA if it\
    \ is supplied with the NAACK option.  If\n   the NAACK indicates that the Link-Layer\
    \ Address is unrecognized, the\n   MN MUST NOT use the NCoA or PCoA and SHOULD\
    \ start the process of\n   acquiring an NCoA at the NAR immediately.\n   New option\
    \ types may be defined in the future.\n"
- title: 7.  Configurable Parameters
  contents:
  - "7.  Configurable Parameters\n      Parameter Name       Default Value       \
    \     Definition\n      -------------------  ----------------------   -------\n\
    \      RTSOLPR_RETRIES      3                        Section 6.1.1\n      MAX_RTSOLPR_RATE\
    \     3                        Section 6.1.1\n      FBU_RETRIES          3   \
    \                     Section 4\n      PROXY_ND_LIFETIME    1.5 seconds      \
    \        Section 6.2.2\n      HI_RETRIES           3                        Section\
    \ 6.2.1\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   The following security vulnerabilities are identified,\
    \ and suggested\n   solutions are mentioned.\n   1. Insecure FBU: In this case,\
    \ packets meant for one address could be\n      stolen, or redirected to some\
    \ unsuspecting node.  This concern is\n      the same as that in an MN and Home\
    \ Agent relationship.\n      Hence, the PAR MUST ensure that the FBU packet arrived\
    \ from a node\n      that legitimately owns the PCoA.  The access router and its\
    \ hosts\n      may use any available mechanism to establish a security\n     \
    \ association that MUST be used to secure FBU.  The current version\n      of\
    \ this protocol does not specify how this security association is\n      established.\
    \  However, future work may specify this security\n      association establishment.\n\
    \      If an access router can ensure that the source IP address in an\n     \
    \ arriving packet could only have originated from the node whose\n      Link-Layer\
    \ Address is in the router's neighbor cache, then a bogus\n      node cannot use\
    \ a victim's IP address for malicious redirection of\n      traffic.  Such an\
    \ operation is recommended at least on neighbor\n      discovery messages including\
    \ the RtSolPr message.\n   2. Secure FBU, malicious or inadvertent redirection:\
    \ In this case,\n      the FBU is secured, but the target of binding happens to\
    \ be an\n      unsuspecting node due to inadvertent operation or malicious\n \
    \     intent.  This vulnerability can lead to an MN with a genuine\n      security\
    \ association with its access router redirecting traffic to\n      an incorrect\
    \ address.\n      However, the target of malicious traffic redirection is limited\
    \ to\n      an interface on an access router with which the PAR has a security\n\
    \      association.  The PAR MUST verify that the NCoA to which PCoA is\n    \
    \  being bound actually belongs to NAR's prefix.  To do this, HI and\n      HAck\
    \ message exchanges are to be used.  When NAR accepts NCoA in\n      HI (with\
    \ Code = 0), it proxies NCoA so that any arriving packets\n      are not sent\
    \ on the link until the MN attaches and announces\n      itself through FNA. \
    \ Therefore, any inadvertent or malicious\n      redirection to a host is avoided.\
    \  It is still possible to jam\n      NAR's buffer with redirected traffic.  However,\
    \ since NAR's\n      handover state corresponding to NCoA has a finite (and short)\n\
    \      lifetime corresponding to a small multiple of anticipated handover\n  \
    \    latency, the extent of this vulnerability is arguably small.\n   3. Sending\
    \ an FBU from NAR's link: A malicious node may send an FBU\n      from NAR's link\
    \ providing an unsuspecting node's address as NCoA.\n      Since the FBU is encapsulated\
    \ in the FNA, NAR should detect the\n      collision with an address in use when\
    \ processing the FNA, and then\n      drop the FBU.  When NAR is unable to detect\
    \ address collisions,\n      there is a vulnerability that redirection can affect\
    \ an\n      unsuspecting node.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   This document defines four new experimental ICMPv6\
    \ messages that use\n   the Experimental Mobility Protocol ICMPv6 format [4].\
    \  These four new\n   Subtype value assignments out of the Experimental Mobility\
    \ Protocol\n   Subtype Registry [4] have been assigned as follows:\n      Subtype\
    \    Description              Reference\n      -------    -----------        \
    \      ---------\n      2          RtSolPr                  Section 6.1.1\n  \
    \    3          PrRtAdv                  Section 6.1.2\n      4          HI  \
    \                     Section 6.2.1\n      5          HAck                   \
    \  Section 6.2.2\n   This document defines four new Neighbor Discovery [6] options\
    \ that\n   have received Type assignments from IANA.\n      Option-Type     Description\
    \              Reference\n      -----------     -----------              ---------\n\
    \      17              IP Address Option        Section 6.4.1\n      18      \
    \        New Router Prefix\n                      Information Option       Section\
    \ 6.4.2\n      19              Link-Layer Address\n                      Option\
    \                   Section 6.4.3\n      20              Neighbor Advertisement\n\
    \                      Acknowledgment Option    Section 6.4.5\n   This document\
    \ defines three new Mobility Header messages that have\n   received type allocations\
    \ from the Mobility Header Types registry at\n   http://www.iana.org/assignments/mobility-parameters:\n\
    \   1. Fast Binding Update, described in Section 6.3.1\n   2. Fast Binding Acknowledgment,\
    \ described in Section 6.3.2, and\n   3. Fast Neighbor Advertisement, described\
    \ in Section 6.3.3.\n   This document defines a new Mobility Option which has\
    \ received type\n   assignments from the Mobility Options Type registry at\n \
    \  http://www.iana.org/assignments/mobility-parameters:\n   1. Mobility Header\
    \ Link-Layer Address option, described in Section\n      6.4.4.\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   The editor would like to thank all those who have provided\
    \ feedback\n   on this specification, but can only mention a few here:  Martin\n\
    \   Andre, Vijay Devarapalli, Youn-Hee Han, Emil Ivov, Suvidh Mathur,\n   Koshiro\
    \ Mitsuya, Gabriel Montenegro, Takeshi Ogawa, Sun Peng, YC\n   Peng, Domagoj Premec,\
    \ and Jonathan Wood.  The editor would like to\n   acknowledge a contribution\
    \ from James Kempf to improve this\n   specification.  The editor would also like\
    \ to thank the [mipshop]\n   working group chair Gabriel Montenegro and the erstwhile\
    \ [mobile ip]\n   working group chairs Basavaraj Patil and Phil Roberts for providing\n\
    \   much support for this work.\n"
- title: 11.  Normative References
  contents:
  - "11.  Normative References\n   [1]  Bradner, S., \"Key words for use in RFCs to\
    \ Indicate Requirement\n        Levels\", BCP 14, RFC 2119, March 1997.\n   [2]\
    \  Conta, A. and S. Deering, \"Internet Control Message Protocol\n        (ICMPv6)\
    \ for the Internet Protocol Version 6 (IPv6)\n        Specification\", RFC 2463,\
    \ December 1998.\n   [3]  Johnson, D., Perkins, C., and J. Arkko, \"Mobility Support\
    \ in\n        IPv6\", RFC 3775, June 2004.\n   [4]  Kempf, J., \"Instructions\
    \ for Seamoby and Experimental Mobility\n        Protocol IANA Allocations\",\
    \ RFC 4065, July 2005.\n   [5]  Kent, S. and R. Atkinson, \"IP Authentication\
    \ Header\", RFC 2402,\n        November 1998.\n   [6]  Narten, T., Nordmark, E.,\
    \ and W. Simpson, \"Neighbor Discovery\n        for IP Version 6 (IPv6)\", RFC\
    \ 2461, December 1998.\n   [7]  Thomson, S. and T. Narten, \"IPv6 Stateless Address\n\
    \        Autoconfiguration\", RFC 2462, December 1998.\n"
- title: 12.  Contributors
  contents:
  - "12.  Contributors\n   This document originated in the fast handover design team\
    \ effort.\n   The members of this design team in alphabetical order were:  Gopal\n\
    \   Dommety, Karim El-Malki, Mohammed Khalil, Charles Perkins, Hesham\n   Soliman,\
    \ George Tsirtsis, and Alper Yegin.\n   The design team member's contact information:\n\
    \   Gopal Dommety\n   Cisco Systems, Inc.\n   170 West Tasman Drive\n   San Jose,\
    \ CA 95134\n   Phone:+1 408 525 1404\n   EMail: gdommety@cisco.com\n   Karim El\
    \ Malki\n   Ericsson Radio Systems AB\n   LM Ericssons Vag. 8\n   126 25 Stockholm\n\
    \   SWEDEN\n   Phone:  +46 8 7195803\n   Fax:    +46 8 7190170\n   EMail: Karim.El-Malki@era.ericsson.se\n\
    \   Mohamed Khalil\n   Nortel Networks\n   EMail: mkhalil@nortelnetworks.com\n\
    \   Charles E. Perkins\n   Communications Systems Lab\n   Nokia Research Center\n\
    \   313 Fairchild Drive\n   Mountain View, California 94043\n   USA\n   Phone:\
    \  +1-650 625-2986\n   Fax:  +1 650 625-2502\n   EMail:  charliep@iprg.nokia.com\n\
    \   Hesham Soliman\n   Flarion Technologies\n   EMail: H.Soliman@flarion.com\n\
    \   George Tsirtsis\n   Flarion Technologies\n   EMail: G.Tsirtsis@flarion.com\n\
    \   Alper E. Yegin\n   Samsung Advanced Institute of Technology\n   75 West Plumeria\
    \ Drive\n   San Jose, CA 95134\n   USA\n   Phone: +1 408 544 5656\n   EMail: alper.yegin@samsung.com\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Rajeev Koodli, Editor\n   Nokia Research Center\n   313\
    \ Fairchild Drive\n   Mountain View, CA 94043 USA\n   Phone: +1 650 625 2359\n\
    \   Fax: +1 650 625 2502\n   EMail: Rajeev.Koodli@nokia.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2005).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at ietf-\n   ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
