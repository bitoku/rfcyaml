- title: __initial_text__
  contents:
  - '        Cisco Architecture for Lawful Intercept in IP Networks

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2004).\n"
- title: IESG Note
  contents:
  - "IESG Note\n   This RFC is not a candidate for any level of Internet Standard.\
    \  The\n   IETF disclaims any knowledge of the fitness of this RFC for any\n \
    \  purpose, and in particular notes that the decision to publish is not\n   based\
    \ on IETF review for such things as security, congestion control\n   or inappropriate\
    \ interaction with deployed protocols.  The RFC Editor\n   has chosen to publish\
    \ this document at its discretion.  Readers of\n   this document should exercise\
    \ caution in evaluating its value for\n   implementation and deployment.\n"
- title: Abstract
  contents:
  - "Abstract\n   For the purposes of this document, lawful intercept is the lawfully\n\
    \   authorized interception and monitoring of communications.  Service\n   providers\
    \ are being asked to meet legal and regulatory requirements\n   for the interception\
    \ of voice as well as data communications in IP\n   networks in a variety of countries\
    \ worldwide.  Although requirements\n   vary from country to country, some requirements\
    \ remain common even\n   though details such as delivery formats may differ. \
    \ This document\n   describes Cisco's Architecture for supporting lawful intercept\
    \ in IP\n   networks.  It provides a general solution that has a minimum set of\n\
    \   common interfaces.  This document does not attempt to address any of\n   the\
    \ specific legal requirements or obligations that may exist in a\n   particular\
    \ country.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction. . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  2\n      1.1. Requirements Motivating the Architecture . . . .\
    \ . . . . .  3\n      1.2. Document Organization. . . . . . . . . . . . . . .\
    \ . . . .  4\n   2. Reference Model . . . . . . . . . . . . . . . . . . . . .\
    \ . . .  5\n      2.1. Reference Model Components . . . . . . . . . . . . . .\
    \ . .  6\n      2.2. Operational Considerations . . . . . . . . . . . . . . .\
    \ .  7\n   3. Interfaces. . . . . . . . . . . . . . . . . . . . . . . . . . .\
    \  9\n      3.1. Content Intercept Request Interface. . . . . . . . . . . .  9\n\
    \      3.2. Intercept Content Interface (f). . . . . . . . . . . . . . 10\n  \
    \ 4. Applying the Reference Model. . . . . . . . . . . . . . . . . . 11\n    \
    \  4.1. Voice over IP networks . . . . . . . . . . . . . . . . . . 11\n      \
    \     4.1.1. Interception of Voice over IP Services. . . . . . . 11\n        \
    \   4.1.2. Local Voice Services. . . . . . . . . . . . . . . . 12\n      4.2.\
    \ Data Services. . . . . . . . . . . . . . . . . . . . . . . 13\n   5. Security\
    \ Considerations . . . . . . . . . . . . . . . . . . . . 13\n      5.1. Content\
    \ Request Interface (d) - SNMPv3 Control . . . . . . 14\n   6. Informative References.\
    \ . . . . . . . . . . . . . . . . . . . . 14\n   7. Acronyms. . . . . . . . .\
    \ . . . . . . . . . . . . . . . . . . . 16\n   8. Authors' Addresses. . . . .\
    \ . . . . . . . . . . . . . . . . . . 17\n   9. Full Copyright Statement. . .\
    \ . . . . . . . . . . . . . . . . . 18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   For the purposes of this document, lawful intercept is the\
    \ lawfully\n   authorized interception and monitoring of communications of an\n\
    \   intercept subject.  The term \"intercept subject\", \"subject\", \"target\n\
    \   subscriber\" or \"target\" in this document refers to the subscriber of\n\
    \   a telecommunications service whose communications and/or intercept\n   related\
    \ information (IRI) has been lawfully authorized to be\n   intercepted and delivered\
    \ to some agency.  Note that although the\n   term \"Law Enforcement Agency\"\
    \ (LEA) is used throughout this document,\n   this may refer to any agency that\
    \ is able to request lawfully\n   authorized interception.\n   By intercept related\
    \ information (IRI) we mean information related to\n   the IP traffic of interest.\
    \  There is currently no standardized\n   definition for IRI for IP traffic. \
    \ IRI has been defined for a few\n   services that might run over IP (e.g., Voice\
    \ over IP) or that IP runs\n   on top of (e.g., GPRS).  For example, IRI for voice\
    \ over IP could be\n   the called and calling phone numbers.  The definition of\
    \ IRI from\n   [14] is shown below:\n         Intercept Related Information: collection\
    \ of\n         information or data associated with\n         telecommunication\
    \ services involving the target\n         identity, specifically communication\
    \ associated\n         information or data (e.g., unsuccessful\n         communication\
    \ attempts), service associated\n         information or data and location\n \
    \        information.\n   Service providers are being asked to meet legal and\
    \ regulatory\n   requirements for the interception of voice as well as data\n\
    \   communications in IP networks in a variety of countries worldwide.\n   Although\
    \ requirements vary from country to country, some requirements\n   remain common\
    \ even though details such as delivery formats may\n   differ.  This document\
    \ describes Cisco's Architecture for supporting\n   lawful intercept in IP networks.\
    \  It provides a general solution that\n   has a minimum set of common interfaces.\
    \  This document does not deal\n   with legal requirements or obligations.\n \
    \  This document describes one method for supporting lawful intercept.\n   Other\
    \ methods may be available.\n   The IESG wishes to draw the reader's attention\
    \ to RFC 2804 [15] for a\n   description of why architectures such as these are\
    \ vendor-specific,\n   rather than a topic of standardization for the IETF.\n"
- title: 1.1.  Requirements Motivating the Architecture
  contents:
  - "1.1.  Requirements Motivating the Architecture\n   The purpose of the following\
    \ list of requirements is to provide an\n   understanding of the motivation behind\
    \ the architecture and some of\n   the requirements imposed on components and\
    \ interfaces that are\n   described in the later sections of the document.  This\
    \ does not imply\n   any legal requirements on service providers or equipment\
    \ vendors\n   although such requirements may coincide.\n   Note that there are\
    \ a variety of requirements that have been defined\n   for lawfully authorized\
    \ intercept throughout the world.  Some of\n   these have been defined by standards\
    \ bodies (e.g., [13]), while\n   others are country specific.  The following itemized\
    \ list is a\n   distillation of some of these, although a given item may or may\
    \ not\n   apply to a specific country:\n   *  Lawful Intercept (LI) should be\
    \ undetectable by the intercept\n      subject.\n   *  Mechanisms should be in\
    \ place to limit unauthorized personnel from\n      performing or knowing about\
    \ lawfully authorized intercepts.\n   *  There is often a requirement (especially\
    \ for telecommunications\n      services) to provide intercept related information\
    \ (IRI)\n      separately from the actual Internet Protocol (IP) traffic (or\n\
    \      content) of interest (Note: some authorizations may be restricted\n   \
    \   to IRI).\n   *  If IRI is delivered separately from content, there should\
    \ be some\n      means to correlate the IRI and the content with each other.\n\
    \   *  If the information being intercepted is encrypted by the service\n    \
    \  provider and the service provider has access to the keys, then the\n      information\
    \ should be decrypted before delivery to the Law\n      Enforcement Agency (LEA)\
    \ or the encryption keys should be passed\n      to the Law Enforcement Agency\
    \ to allow them to decrypt the\n      information.\n   *  If the information being\
    \ intercepted is encrypted by the intercept\n      subject and its associate and\
    \ the service provider has access to\n      the keys, then the service provider\
    \ may deliver the keys to the\n      LEA.\n   *  There is often a requirement\
    \ for a service provider to be able to\n      do multiple simultaneous intercepts\
    \ on a single subject.  The fact\n      that there are multiple intercepts should\
    \ be transparent to the\n      LEAs.\n   *  There is often a requirement that\
    \ the service provider should not\n      deliver any unauthorized information\
    \ to the LEA.\n   The architecture and interfaces described in this document attempts\n\
    \   to address these requirements.\n"
- title: 1.2.  Document Organization
  contents:
  - "1.2.  Document Organization\n   Section 1 of this document lists requirements\
    \ motivating the\n   architecture.  Section 2 of this document describes a reference\
    \ model\n   along with some operation considerations.  Section 3 provides more\n\
    \   detailed requirements on the interfaces related to content\n   interception.\
    \  Section 4 applies the reference model to voice over IP\n   and data intercepts\
    \ and Section 5 examines security considerations.\n"
- title: 2.  Reference Model
  contents:
  - "2.  Reference Model\n   This section describes a generic reference model (Figure\
    \ 1) for\n   lawful intercept.\n                          +--------------------+\
    \               +-----+\n                          |  LI Administration |    \
    \ HI1(a)    |     |\n                          |      Function      |<--------------|\
    \     |\n                          +--------------------+               |    \
    \ |\n                                 |                             |     |\n\
    \                                 | MD Provisioning             |     |\n    \
    \                             | Interface(b)                | LEA |\n        \
    \                         v                             |     |\n   +-----------+\
    \           +--------------------+              |     |\n   |           |<---(c)----|\
    \                    |              |     |\n   |  IRI IAP  |--IRI(e)-->|    \
    \  Mediation     |----HI2(g)--->|     |\n   |           |           |      Device\
    \ (MD)   |              |     |\n   +-----------+           |                \
    \    |----HI3(h)--->|     |\n                           +--------------------+\
    \              +-----+\n                                |         ^\n        \
    \              Intercept |         | Intercepted\n                     Request(d)\
    \ |         | Content(f)\n                                |         |\n      \
    \                          v         |\n                              +--------------------+\n\
    \                        User  |       Content      |  User\n                \
    \      ------->|         IAP        |-------->\n                      Content\
    \ +--------------------+  Content\n      Figure 1: Intercept Architecture\n  \
    \ A brief description of the interfaces is included in table 1 below.\n   For\
    \ a more detailed description of the interfaces refer to section 3.\n   For a\
    \ description of the components refer to section 2.1.\n   Table 1 LI Interfaces\n\
    \     Interface               Description\n   ---------------------  -------------------------------------------\n\
    \   (a) HI1                   Handover Interface 1 - Administration\n        \
    \                     Interface: The LEA provides intercept\n                \
    \             information to the service provider\n                          \
    \   administration function.\n   (b) MD Provisioning       Mediation Device provisioning\
    \ interface.\n                             Parameters include: target identifier,\n\
    \                             duration of intercept, type of intercept,\n    \
    \                         etc.\n   (c) IRI IAP Provisioning  Specifies Target\
    \ identifier, duration,\n                             etc. for provisioning of\
    \ delivery of\n                             Intercept Related Information (IRI).\n\
    \   (d) Content Intercept     Provisioning of the Content IAP.\n       Provisioning\n\
    \   (e) IRI to MD             Internal interface between IRI Intercept\n     \
    \                        Access Point (IAP) and Mediation device\n           \
    \                  (MD) for delivery of IRI.\n   (f) Content to MD         Internal\
    \ interface between content\n                             IAP and MD for delivery\
    \ of Content.\n   (g) HI2                   Handover Interface 2: Interface between\n\
    \                             the MD and LEA for delivering IRI.  This\n     \
    \                        interface may vary from country to\n                \
    \             country.\n   (h) HI3                   Handover Interface 3: Interface\
    \ between\n                             the MD and LEA for delivering Content.\n\
    \                             This interface may vary from country to\n      \
    \                       country.\n"
- title: 2.1.  Reference Model Components
  contents:
  - "2.1.  Reference Model Components\n   A brief description of the key components\
    \ in the reference model is\n   as follows:\n   Lawful Intercept (LI) Administration\
    \ Function:\n      This function provides the (typically manual) provisioning\n\
    \      interface for the intercept as a result of a court order or\n      warrant\
    \ delivered by the Law Enforcement Agency (LEA).  It could\n      involve separate\
    \ provisioning interfaces for several components,\n      but more typically is\
    \ a single interface to the Mediation Device\n      (MD), which then takes care\
    \ of provisioning of other components in\n      the network.  Because of the requirement\
    \ in some laws to limit\n      accessibility to authorized personnel, the provisioning\
    \ interface\n      has to be strictly controlled.  In many cases, the identity\
    \ of the\n      subject received from the LEA has to be translated into an\n \
    \     identity that can be used by the network to enable the intercept.\n   Intercept\
    \ Access Point (IAP):\n      An IAP is a device within the network that is used\
    \ for\n      intercepting lawfully authorized intercept information.  It may be\n\
    \      an existing device that has intercept capability or it could be a\n   \
    \   special device that is provided for that purpose.  Two types of\n      IAP's\
    \ are discussed here: IAP's that provide content; and IAP's\n      that provide\
    \ intercept related information (IRI).\n   Content IAP:\n      A content IAP is\
    \ an IAP that is used to intercept the IP traffic\n      of interest.\n   IRI\
    \ IAP: This is an IAP that is used to provide intercept related\n      information\
    \ (IRI).\n   Law Enforcement Agency (LEA):\n      This is the agency that has\
    \ requested the intercept and to which\n      the service provider delivers the\
    \ information.\n   Mediation Device (MD):\n      The MD requests intercepts from\
    \ IAPs through interfaces (c) and\n      (d) in Figure 1.  The Mediation Device\
    \ receives the data from the\n      IAP, packages it in the correct format (which\
    \ may vary from\n      country to country) and delivers it to the LEA.  In the\
    \ case where\n      multiple law enforcement agencies are intercepting the same\n\
    \      subject, the mediation device may replicate the information\n      multiple\
    \ times.  The assumption is that the service provider\n      operates the MD (via\
    \ specially authorized personnel) and that the\n      LEA only has access to interfaces\
    \ (a), (g) and (h) in Figure 1.\n"
- title: 2.2.  Operational Considerations
  contents:
  - "2.2.  Operational Considerations\n   In a typical operation, a lawfully authorized\
    \ surveillance request\n   arrives for a specified intercept subject.  Authorized\
    \ personnel\n   provision the intercept using interface (b) in Figure 1, which\
    \ may be\n   for content only, IRI only or both.  Once the intercept is\n   provisioned,\
    \ the IAP's send the IRI and/or content to the MD, which\n   formats the information\
    \ into the appropriate format for delivery to\n   the LEA.  Some operational issues\
    \ that need to be considered:\n   *  Location and Address Information for Content\
    \ Intercepts: In some\n      cases where the location and/or addressing information\
    \ for the\n      intercept is not known until the subject registers (or makes\
    \ a\n      call in the case of voice), the IRI may provide needed information\n\
    \      in order to do the content tap (e.g., the IP address and port for\n   \
    \   the content streams).\n   *  Content Encryption: If the intercept content\
    \ is encrypted and the\n      service provider has access to the encryption keys\
    \ (e.g., receives\n      keys in Session Description Protocol for Voice over IP),\
    \ then the\n      keys can be sent via IRI.  It is, however, possible for end-users\n\
    \      to exchange keys by some other means without any knowledge of the\n   \
    \   service provider in which case the service provider will not be\n      able\
    \ to provide the keys. Content transformations could make\n      decryption at\
    \ the LEA impossible.  This is why the original\n      packets are provided on\
    \ interface (f) rather than attempting to\n      convert them to some other format.\n\
    \   *  Detection by the Intercept Subject: One requirement is to ensure\n    \
    \  that the intercept subject is unable to detect that they are being\n      intercepted.\
    \  This document assumes a sophisticated subject:\n      -  Able to check IP addresses,\
    \ use traceroute, etc.\n      -  Able to check if any unusual signaling is occurring\
    \ on their\n         customer premises equipment (CPE).\n      -  Able to detect\
    \ degradation or interruptions in service.\n      This is why the intercept mechanism\
    \ described here does not\n      involve special requests to the CPE, re-routing\
    \ of packets or\n      end-to-end changes in IP addresses.  Instead, content intercept\
    \ is\n      done on a device along the normal content path (i.e., no re-\n   \
    \   routing has occurred) that is within the service provider's\n      network.\
    \  A convenient content IAP is a router or switch at the\n      edge of the service\
    \ provider's network to which the intercept\n      subject connects.  This is\
    \ illustrated in Figure 2.\n                           |\n        Customer Premises\
    \  | Service Provider's Network\n                           |\n              \
    \                  +-------+\n            +-----+             |       |\n    \
    \        | CPE |-------------| Router|----------\n            +-----+        \
    \     | (IAP) |\n                                |       |\n                 \
    \               +-------+\n              Figure 2  Content IAP - Router\n    \
    \  Another possibility of course is to provide a special device along\n      the\
    \ path to provide the content IAP capabilities.\n      Note that in the case where\
    \ there is multi-homing (two or more\n      routers connected to provide access\
    \ for the CPE), intercept taps\n      may have to be installed on more than one\
    \ access router.  If the\n      CPE is multi-homed to multiple service providers,\
    \ then the\n      intercept will have to be installed on each service provider\n\
    \      separately and the LEA will have to correlate the data.\n   *  Unauthorized\
    \ Creation and Detection: Another concern is the\n      prevention of unauthorized\
    \ creation and detection of intercepts.\n      This is particularly important\
    \ when a network element such as a\n      router is used as a content IAP.  Those\
    \ routers that have the\n      capability should be carefully controlled with\
    \ access to intercept\n      capability and information only via authorized personnel.\
    \  In one\n      approach using the reference model in Figure 1, the MD is in\
    \ a\n      controlled environment and the MD does the intercept request to\n \
    \     the content IAP over an encrypted link.  Logging and auditing are\n    \
    \  used to detect unauthorized attempts to access the intercept\n      capability.\n\
    \   *  Capacity:  Support for lawful intercept on a network element\n      supporting\
    \ customers consumes resources on that equipment.\n      Therefore, support for\
    \ lawful intercept requires capacity planning\n      and engineering to ensure\
    \ that revenue-producing services are not\n      adversely affected.\n"
- title: 3.  Interfaces
  contents:
  - "3.  Interfaces\n   This section provides a brief description of the interfaces\
    \ in the\n   reference model (Figure 1).  A list of these interfaces is included\n\
    \   in Table 1 in Section 2.\n   One of the objectives in defining these interfaces\
    \ is to keep the\n   internal interfaces (b to f) the same regardless of country-specific\n\
    \   requirements.  The MD then formats the IRI and the content to meet\n   the\
    \ country specific requirements for interfaces (g) and (h).\n"
- title: 3.1.  Content Intercept Request Interface
  contents:
  - "3.1.  Content Intercept Request Interface\n   This section describes some of\
    \ the requirements for the content\n   intercept request interface (d) in Figure\
    \ 1.  It makes use of a\n   common request protocol (SNMPv3) regardless of the\
    \ type of\n   application (e.g., voice, data) and suggests the usage of a TAP-MIB,\n\
    \   which is defined in a separate document [1].  Some of the\n   considerations\
    \ that lead to the use of SNMPv3 and to the definition\n   of the specific Management\
    \ Information Base (MIB) defined in [1] are\n   provided here.\n   In order to\
    \ provide a generic interface for intercepting,\n   replicating, encapsulating\
    \ and transporting content packets to the\n   MD, the content intercept interface\
    \ ((d) in Figure 1) should specify:\n   *  A Filter specification for classifying\
    \ the packets to be\n      intercepted.\n   *  The destination address of the\
    \ MD (where to send the packets).\n   *  Encapsulation and Transport parameters.\n\
    \   In addition, a timeout value for the intercept should also be\n   specified.\
    \  This defines a limited lifetime for the intercept so that\n   failures will\
    \ not result in intercepts remaining beyond their\n   authorized lifetime.  If\
    \ a failure of the MD occurs such that it is\n   not able to supply the refresh\
    \ to the timeout, then the intercept\n   will cease to exist after the timeout\
    \ expires.  Similarly, if the IAP\n   re-boots, then the intercept will not survive\
    \ the re-boot unless the\n   IAP is capable of ascertaining that the intercept\
    \ lifetime\n   requirements will continue to be met.\n   In order for this to\
    \ work, it must be possible for the mediation\n   device to realize that there\
    \ is a failure in the IAP such that it\n   must re-establish the intercept.  This\
    \ may be in the form of an audit\n   (from the MD to the IAP), or in the form\
    \ of a heartbeat mechanism in\n   the content stream, or both.\n"
- title: 3.2.  Intercept Content Interface (f)
  contents:
  - "3.2.  Intercept Content Interface (f)\n   The encapsulation method should retain\
    \ all of the information in the\n   original packets (source and destination addresses\
    \ as well as\n   payload) and provide an identifier for correlating the packets\
    \ with\n   the IRI.  One encapsulation that meets those requirements is\n   described\
    \ in Section 4 of [2].  For non-voice intercepts, the\n   \"Intercepted Information\"\
    \ field in Table 1 of [2] contains the\n   original intercepted IP packet.\n \
    \  Note, however, that the interface defined in [2] is based on UDP\n   which\
    \ is an unreliable and unordered transport protocol (i.e.,\n   provides neither\
    \ retransmission on detection of errors nor ordering\n   of data).  If this transport\
    \ is used, the underlying network (Layers\n   1 -    - 3) should be engineered\
    \ to meet the overall reliability\n   requirements for delivery of content.\n\
    \   If a more reliable transport protocol is required, then a mechanism\n   that\
    \ provides timely delivery as well as limits the burden (both\n   processing and\
    \ buffering) on the Content IAP should be used.  One\n   mechanism that meets\
    \ these requirements is a NACK-oriented\n   retransmission scheme based on [12].\n\
    \   If [12] is used, the call content channel identifier may be placed in\n  \
    \ the SSRC field of the encapsulating RTP packet.  The payload type may\n   be\
    \ used to identify the type of packet encapsulated in RTP (e.g., IP,\n   PPP,\
    \ Ethernet MAC).  Note that usage of [12] is still under\n   investigation and\
    \ may need further specification.  Usage of [12] in\n   the content IAP places\
    \ more processing burden on the content IAP than\n   a UDP-based intercept and\
    \ can affect the capacity of the content IAP.\n"
- title: 4.  Applying the Reference Model
  contents:
  - "4.  Applying the Reference Model\n   This section applies the reference model\
    \ to some example\n   applications.\n"
- title: 4.1.  Voice over IP networks
  contents:
  - "4.1.  Voice over IP networks\n   This section will look at some of the issues\
    \ surrounding interception\n   of voice over IP calls, taking local voice services\
    \ as a specific\n   service example.  The reference model from Figure 1 will be\
    \ applied\n   with the use of a common set of interfaces that are independent\
    \ of\n   the call signaling protocols in use.\n"
- title: 4.1.1.  Interception of Voice over IP Services
  contents:
  - "4.1.1.  Interception of Voice over IP Services\n   There are a variety of architectures\
    \ in use for voice over IP (e.g.,\n   centralized versus distributed) as well\
    \ as various protocols (SIP\n   [6], H.323 [9], MGCP [7], H.248 [8]).  There are\
    \ also a variety of\n   services that may be offered:\n   *  Local Voice Services\
    \ (i.e., service to a user that has an IP phone\n      or a phone connected to\
    \ a gateway)\n   *  Transit services\n   *  Long distance access services (e.g.,\
    \ calling/debit card).\n   This document does not address any obligations that\
    \ a service\n   provider might or might not have to support intercepts.  It simply\n\
    \   describes how intercept might be done using the reference model in\n   Figure\
    \ 1.\n   Note that in the case of services where the intercept subject\n   accesses\
    \ the network via a non-IP endpoint (e.g., TDM), the\n   detectability issue is\
    \ less acute (e.g., re-routing of packets to\n   intercept them in a special device\
    \ is a possible option), since the\n   intercept subject does not have access\
    \ to the IP addresses or to\n   traceroute.\n   However, in the case of local\
    \ services, this is a much more difficult\n   problem.  The intercept for a call\
    \ originating and terminating on-net\n   (i.e., a call that is voice over IP end-to-end)\
    \ has to be intercepted\n   along its normal route in order to be undetectable.\
    \  In addition, the\n   call-forwarding feature that is often provided as a local\
    \ service\n   feature makes interception even more difficult: If call forwarding\
    \ is\n   invoked, a call that was intended to terminate on the intercept\n   subject\
    \ may be forwarded anywhere in the network resulting in the\n   media stream bypassing\
    \ the original content IAP (since in voice over\n   IP, the media stream goes\
    \ directly from end-to-end).  Also, since\n   call forwarding can often be set\
    \ up on a call-by-call basis, the\n   location of the content IAP will often not\
    \ be known until the call is\n   set up.\n"
- title: 4.1.2.  Local Voice Services
  contents:
  - "4.1.2.  Local Voice Services\n   This sub-section will look at the specific case\
    \ in which the\n   intercept subject under surveillance is being provided with\
    \ a local\n   voice service by the same provider that also provides the network\n\
    \   access (e.g., controls the edge router or switch).  This is an\n   important\
    \ assumption, since in VoIP the entity providing call control\n   (e.g., SIP server)\
    \ can be totally separate from the entity providing\n   network access (e.g.,\
    \ operates edge routers).\n   Suppose that a subscriber that subscribes to a local\
    \ (e.g.,\n   residential) voice service is a target for a lawfully authorized\n\
    \   surveillance.  Part of the system providing these services is a\n   subscriber\
    \ database that includes addressing information about the\n   subscriber as well\
    \ information on what features are in effect (e.g.,\n   call forwarding).  Some\
    \ call control entity (CCE) accesses that\n   database in order to provide local\
    \ services.  For example, if the\n   subject has call forwarding invoked, that\
    \ fact (and where to forward\n   the call) is indicated in the subscriber database.\
    \  A call arriving\n   at the CCE that \"owns\" that subscriber can then take\
    \ the appropriate\n   action (e.g., forward the call).\n   The CCE that \"owns\"\
    \ the target subscriber (which could be an H.323\n   gatekeeper, a SIP proxy or\
    \ a Media Gateway Controller) is provisioned\n   with the intercept parameters\
    \ (e.g., subject identification\n   information such as the telephone number and\
    \ where to deliver the\n   IRI).  The provisioning of this CCE could be through\
    \ interface (c) in\n   Figure 1.  The CCE in question is the IRI IAP and once\
    \ provisioned,\n   it passes the IRI to the MD.  In the scenario being discussed,\
    \ the\n   CCE typically remains in the signaling path throughout the call, even\n\
    \   in the call-forwarding case.  Part of the IRI it passes to the MD is\n   the\
    \ media signaling information (i.e., SDP [11] or H.245 [10]), which\n   includes\
    \ endpoint IP address and port information for the media\n   (content) streams.\
    \  Armed with this media address information, the MD\n   can determine the content\
    \ IAP (e.g., [5]) and make the request via\n   interface (d).  The request identifies\
    \ the voice stream to be\n   intercepted based on information received in the\
    \ call signaling\n   (i.e., IP addresses and UDP port numbers).\n   Note that\
    \ the content IAP in the case of voice over IP could be an\n   edge router or\
    \ a PSTN gateway (e.g., a call from the PSTN forwarded\n   to the PSTN).  SIP,\
    \ H.323, MGCP or H.248 call signaling protocols\n   could be used.  However, the\
    \ protocol (SNMPv3 [1]) used for interface\n   (d), is not dependent on the type\
    \ of call signaling protocol used;\n   nor is the encapsulation format and transport\
    \ protocol (interface\n   \"f\").  The same reference model (Figure 1) with the\
    \ same interfaces\n   can be used for lawfully authorized surveillance, regardless\
    \ of the\n   signaling protocol and regardless of the type of service being\n\
    \   provided (Note: even though a local voice service was used in this\n   example,\
    \ other voice services could use the same model and\n   interfaces).\n"
- title: 4.2.  Data Services
  contents:
  - "4.2.  Data Services\n   The same model (Figure 1) can also be used for data services.\
    \  In\n   this case the IRI IAP could be a server that acts as registration,\n\
    \   authentication and authorization point for the data service (e.g., a\n   RADIUS\
    \ server).  If a potential IRI IAP does not have the available\n   interfaces\
    \ (c) and (e), the MD may have to do a content tap on\n   registration signaling\
    \ in order to obtain the IRI.\n   The IRI in the case of a data service could\
    \ include:\n   *  The time that the user registered or de-registered for the\n\
    \      service.\n   *  Addressing information (i.e., given the user identity,\
    \ what IP\n      address or other information is available that could be used\
    \ in\n      interface (d) to do the content tap).\n   Once suitable addressing\
    \ information is available in order to do\n   content tapping the MD can invoke\
    \ the tap via interface (d).\n   Clearly the IRI interfaces (c, e, g) are different\
    \ for data than they\n   are for voice services.  However, the content IAP is\
    \ typically the\n   same (an edge router).  Interfaces (d, f, and h) may also\
    \ be the\n   same.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   Given the sensitive nature of lawful intercept\
    \ (LI) -- both from the\n   standpoint of the need to protect sensitive data,\
    \ as well as conceal\n   the identities of the intercept subjects, the LI solution\
    \ should have\n   the ability to provide stringent security measures to combat\
    \ threats\n   such as impersonation of MD's, privacy and confidentiality breaches,\n\
    \   as well as message forgery and replay attacks.\n   While this document doesn't\
    \ discuss issues of physical security,\n   operating system, or application hardening\
    \ within the principals of\n   the LI solution, they are clearly important.  In\
    \ particular, the MD\n   server would be considered a prime target for attacks.\n\
    \   In general, all interfaces should have the capability of providing\n   strong\
    \ cryptographic authentication to establish the identity of the\n   principals,\
    \ and be able to correlate the identity of the principal\n   with the action they\
    \ are attempting to perform.  All interfaces\n   should be capable of performing\
    \ some sort of cryptographic message\n   integrity checking such as, for example,\
    \ HMAC-MD5.  Message integrity\n   checking can also be used to counter replay\
    \ attacks.  Privacy and\n   confidentiality considerations, may also require the\
    \ use of\n   encryption.\n   The content and IRI IAPs also should also provide\
    \ protection of the\n   identity of the intercept subject and the existence of\
    \ an intercept.\n"
- title: 5.1.  Content Request Interface (d) - SNMPv3 Control
  contents:
  - "5.1.  Content Request Interface (d) - SNMPv3 Control\n   For interface (d,) native\
    \ SNMPv3 security module mechanism is used.\n   The additional requirement is\
    \ that the IAP should support the ability\n   to protect the TAP MIB's [1] from\
    \ disclosure or control by\n   unauthorized USM [3] users.  VACM [4] provides\
    \ the necessary tools to\n   limit the views to particular USM users, but there\
    \ are also special\n   considerations:\n   *  The ability to limit access to the\
    \ appropriate TAP MIB's by only\n      those SNMPv3 USM users which have keys\
    \ established and the proper\n      VACM views defined.\n   *  Segregation of\
    \ the TAP MIB such that only operators of sufficient\n      privilege level can\
    \ create VACM views that include the TAP MIB\n      [1].\n"
- title: 6.  Informative References
  contents:
  - "6.  Informative References\n   [1]  Baker, F., \"Cisco Lawful Intercept Control\
    \ MIB\", Work in\n        Progress, April 2004.\n   [2]  PacketCable(TM) Electronic\
    \ Surveillance Specification, PKT-SP-\n        ESP-I04-040723, http://www.packetcable.com/specifications/\n\
    \   [3]  Blumenthal, U. and B. Wijnen, \"User-based Security Model (USM)\n   \
    \     for version 3 of the Simple Network Management Protocol\n        (SNMPv3)\"\
    , STD 62, RFC 3414, December 2002.\n   [4]  Wijnen, B., Presuhn, R., and K. McCloghrie,\
    \ \"View-based Access\n        Control Model (VACM) for the Simple Network Management\
    \ Protocol\n        (SNMP)\", STD 62, RFC 3415, December 2002.\n   [5]  Warnicke,\
    \ E., \"A Suggested Scheme for DNS Resolution of Networks\n        and Gateways\"\
    , Work in Progress.\n   [6]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,\
    \ A.,\n        Peterson, J., Sparks, R., Handley, M., and E. Schooler, \"SIP:\n\
    \        Session Initiation Protocol\", RFC 3261, June 2002.\n   [7]  Andreasen,\
    \ F. and B. Foster, \"Media Gateway Control Protocol\n        (MGCP) Version 1.0\"\
    , RFC 3435, January 2003.\n   [8]  ITU-T Recommendation H.248.1, Gateway Control\
    \ Protocol: Version\n        2, May 2002.\n   [9]  ITU-T Recommendation H.323,\
    \ Packet-based Multimedia\n        Communications Systems, July 2003.\n   [10]\
    \ ITU-T Recommendation H.245, Control Protocol for Multimedia\n        Communications,\
    \ July 2003.\n   [11] Handley, M. and V. Jacobson, \"SDP: Session Description\n\
    \        Protocol\", RFC 2327, April 1998.\n   [12] Rey, J., Leon, D., Miyazaki,\
    \ A., Varsa, V., and R. Hakenber,\n        \"RTP Retransmission Payload Format\"\
    , Work in Progress.\n   [13] ETSI TS 101 331, Telecommunications security; Lawful\n\
    \        Interception (LI); Requirements of law enforcement agencies.\n   [14]\
    \ ETSI TS 33.108 v6.7.0, 3rd Generation Partnership Project;\n        Technical\
    \ Specification Group Services and System Aspects; 3G\n        Security; Handover\
    \ Interface for Lawful Interception (Release\n        6).\n   [15] IAB and IESG,\
    \ \"IETF Policy on Wiretapping\", RFC 2804, May 2000.\n"
- title: 7.  Acronyms
  contents:
  - "7.  Acronyms\n   CCE            Call Control Entity\n   CMTS           Cable\
    \ Modem Termination System\n   CPE            Customer Premises Equipment\n  \
    \ ETSI           European Telecommunications Standards Institute\n   GPRS    \
    \       Generalized Packet Radio Service\n   HMAC-MD5       Hash-based Message\
    \ Authentication Code -\n                   Message Digest 5\n   IAP         \
    \   Intercept Access Point\n   IETF           Internet Engineering Task Force\n\
    \   IRI            Intercept Related Information\n   ITU-T          International\
    \ Telecommunications Union -\n                   Telecommunications Sector\n \
    \  LEA            Law Enforcement Agency\n   LI             Lawful Intercept\n\
    \   MGCP           Media Gateway Control Protocol\n   MD             Mediation\
    \ Device\n   MIB            Management Information Base\n   NACK           Negative\
    \ Acknowledgement\n   PSTN           Public Switched Telecommunications Network\n\
    \   RFC            Request for Comment\n   RTP            Real-time Transport\
    \ Protocol\n   SDP            Session Description Protocol\n   SIP           \
    \ Session Initiation Protocol\n   SSRC           Synchronization Source\n   TDM\
    \            Time Division Multiplex\n   UDP            User Datagram Protocol\n\
    \   USM            User Service Model\n   VACM           View-based Access Control\
    \ Model\n   VoIP           Voice over IP\n"
- title: 8.  Authors' Addresses
  contents:
  - "8.  Authors' Addresses\n   Fred Baker\n   Cisco Systems\n   1121 Via Del Rey\n\
    \   Santa Barbara, CA  93117\n   US\n   Phone: +1-408-526-4257\n   Fax:   +1-413-473-2403\n\
    \   EMail: fred@cisco.com\n   Bill Foster\n   Cisco Systems\n   Suite 2150\n \
    \  1050 West Pender St.\n   Vancouver, BC, V6E 3S7\n   Canada\n   Phone: +1-604-647-2315\n\
    \   EMail: bfoster@cisco.com\n   Chip Sharp\n   Cisco Systems\n   7025 Kit Creek\
    \ Road\n   RTP, NC 27709  USA\n   Tel:+1.919.392.3121\n   EMail: chsharp@cisco.com\n"
- title: 9.  Full Copyright Statement
  contents:
  - "9.  Full Copyright Statement\n   Copyright (C) The Internet Society (2004).\n\
    \   This document is subject to the rights, licenses and restrictions\n   contained\
    \ in BCP 78, and at www.rfc-editor.org, and except as set\n   forth therein, the\
    \ authors retain all their rights.\n   This document and the information contained\
    \ herein are provided on an\n   \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION\
    \ HE/SHE REPRESENTS\n   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND\
    \ THE INTERNET\n   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR\
    \ IMPLIED,\n   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE\n\
    \   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES\
    \ OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ ISOC's procedures with respect to rights in ISOC Documents can\n   be found\
    \ in BCP 78 and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat\
    \ and any\n   assurances of licenses to be made available, or the result of an\n\
    \   attempt made to obtain a general license or permission for the use of\n  \
    \ such proprietary rights by implementers or users of this\n   specification can\
    \ be obtained from the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n\
    \   The IETF invites any interested party to bring to its attention any\n   copyrights,\
    \ patents or patent applications, or other proprietary\n   rights that may cover\
    \ technology that may be required to implement\n   this standard.  Please address\
    \ the information to the IETF at ietf-\n   ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
