- title: __initial_text__
  contents:
  - "              Embedding the Rendezvous Point (RP) Address\n                 \
    \     in an IPv6 Multicast Address\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2004).\n"
- title: Abstract
  contents:
  - "Abstract\n   This memo defines an address allocation policy in which the address\n\
    \   of the Rendezvous Point (RP) is encoded in an IPv6 multicast group\n   address.\
    \  For Protocol Independent Multicast - Sparse Mode (PIM-SM),\n   this can be\
    \ seen as a specification of a group-to-RP mapping\n   mechanism.  This allows\
    \ an easy deployment of scalable inter-domain\n   multicast and simplifies the\
    \ intra-domain multicast configuration as\n   well.  This memo updates the addressing\
    \ format presented in RFC 3306.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  ...............................................\
    \   2\n       1.1.  Background ............................................  \
    \ 2\n       1.2.  Solution  .............................................   2\n\
    \       1.3.  Assumptions and Scope .................................   3\n  \
    \     1.4.  Terminology  ..........................................   4\n    \
    \   1.5.  Abbreviations  ........................................   4\n   2. \
    \ Unicast-Prefix-based Address Format  ........................   4\n   3.  Modified\
    \ Unicast-Prefix-based Address Format  ...............   5\n   4.  Embedding the\
    \ Address of the RP in the Multicast Address  ...   5\n   5.  Examples  ...................................................\
    \   7\n       5.1.  Example 1  ............................................  \
    \ 7\n       5.2.  Example 2  ............................................   7\n\
    \       5.3.  Example 3  ............................................   8\n  \
    \     5.4.  Example 4  ............................................   8\n   6.\
    \  Operational Considerations  .................................   8\n       6.1.\
    \  RP Redundancy .........................................   8\n       6.2.  RP\
    \ Deployment  ........................................   9\n       6.3.  Guidelines\
    \ for Assigning IPv6 Addresses to RPs ........   9\n       6.4.  Use as a Substitute\
    \ for BSR ...........................   9\n       6.5.  Controlling the Use of\
    \ RPs ............................   9\n   7.  The Embedded-RP Group-to-RP Mapping\
    \ Mechanism  ..............  10\n       7.1.  PIM-SM Group-to-RP Mapping ............................\
    \  10\n       7.2.  Overview of the Model .................................  11\n\
    \   8.  Scalability Analysis  .......................................  12\n  \
    \ 9.  Acknowledgements  ...........................................  13\n   10.\
    \ Security Considerations .....................................  13\n   11. References\
    \ ..................................................  15\n       11.1. Normative\
    \ References ..................................  15\n       11.2. Informative\
    \ References ................................  15\n   A.  Discussion about Design\
    \ Tradeoffs ...........................  16\n   Authors' Addresses ..............................................\
    \  17\n   Full Copyright Statement ......................................... 18\n"
- title: 1.  Introduction
  contents:
  - '1.  Introduction

    '
- title: 1.1.  Background
  contents:
  - "1.1.  Background\n   As has been noticed [V6MISSUES], there exists a deployment\
    \ problem\n   with global, interdomain IPv6 multicast: PIM-SM [PIM-SM] RPs have\
    \ no\n   way of communicating the information about (active) multicast sources\n\
    \   to other multicast domains, as Multicast Source Discovery Protocol\n   (MSDP)\
    \ [MSDP] has deliberately not been specified for IPv6.\n   Therefore the whole\
    \ interdomain Any Source Multicast (ASM) model is\n   rendered unusable; Source-Specific\
    \ Multicast (SSM) [SSM] avoids these\n   problems but is not a complete solution\
    \ for several reasons, as noted\n   below.\n   Further, it has been noted that\
    \ there are some problems with the\n   support and deployment of mechanisms SSM\
    \ would require [V6MISSUES]:\n   it seems unlikely that SSM could be usable as\
    \ the only interdomain\n   multicast routing mechanism in the short term.\n"
- title: 1.2.  Solution
  contents:
  - "1.2.  Solution\n   This memo describes a multicast address allocation policy\
    \ in which\n   the address of the RP is encoded in the IPv6 multicast group address,\n\
    \   and specifies a PIM-SM group-to-RP mapping to use the encoding,\n   leveraging,\
    \ and extending unicast-prefix-based addressing [RFC3306].\n   This mechanism\
    \ not only provides a simple solution for IPv6\n   interdomain Any Source Multicast\
    \ but can be used as a simple solution\n   for IPv6 intra-domain ASM with scoped\
    \ multicast addresses as well.\n   It can also be used as an automatic RP discovery\
    \ mechanism in those\n   deployment scenarios that would have previously used\
    \ the Bootstrap\n   Router protocol (BSR) [BSR].\n   The solution consists of\
    \ three elements:\n   o  A specification of a subrange of [RFC3306] IPv6 multicast\
    \ group\n      addresses defined by setting one previously unused bit of the\n\
    \      Flags field to \"1\",\n   o  a specification of the mapping by which such\
    \ a group address\n      encodes the RP address that is to be used with this group,\
    \ and\n   o  a description of operational procedures to operate ASM with PIM-SM\n\
    \      on these IPv6 multicast groups.\n   Addresses in the subrange will be called\
    \ embedded-RP addresses.\n   This scheme obviates the need for MSDP, and the routers\
    \ are not\n   required to include any multicast configuration, except when they\
    \ act\n   as an RP.\n   This memo updates the addressing format presented in RFC\
    \ 3306.\n   Some design tradeoffs are discussed in Appendix A.\n"
- title: 1.3.  Assumptions and Scope
  contents:
  - "1.3.  Assumptions and Scope\n   A 128-bit RP address can't be embedded into a\
    \ 128-bit group address\n   with space left to carry the group identity itself.\
    \ An appropriate\n   form of encoding is thus defined by requiring that the Interface-IDs\n\
    \   of RPs in the embedded-RP range can be assigned to be a specific\n   value.\n\
    \   If these assumptions can't be followed, operational procedures and\n   configuration\
    \ must be slightly changed, or this mechanism can't be\n   used.\n   The assignment\
    \ of multicast addresses is outside the scope of this\n   document; it is up to\
    \ the RP and applications to ensure that group\n   addresses are unique by using\
    \ some unspecified method.  However, the\n   mechanisms are probably similar to\
    \ those used with [RFC3306].\n   Similarly, RP failure management methods, such\
    \ as Anycast-RP, are out\n   of scope for this document.  These do not work without\
    \ additional\n   specification or deployment.  This is covered briefly in Section\
    \ 6.1.\n"
- title: 1.4.  Terminology
  contents:
  - "1.4.  Terminology\n   Embedded-RP behaves as if all the members of the group\
    \ were intra-\n   domain to the information distribution. However, as it gives\
    \ a\n   solution for the global IPv6 multicast Internet, spanning multiple\n \
    \  administrative domains, we say it is a solution for inter-domain\n   multicast.\n\
    \   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\"\
    ,\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in\
    \ this\n   document are to be interpreted as described in [RFC2119].\n"
- title: 1.5.  Abbreviations
  contents:
  - "1.5.  Abbreviations\n      ASM     Any Source Multicast\n      BSR     Bootstrap\
    \ Router\n      DR      Designated Router\n      IGP     Interior Gateway Protocol\n\
    \      MLD     Multicast Listener Discovery\n      MSDP    Multicast Source Discovery\
    \ Protocol\n      PIM     Protocol Independent Multicast\n      PIM-SM  Protocol\
    \ Independent Multicast - Sparse Mode\n      RIID    RP Interface ID (as specified\
    \ in this memo)\n      RP      Rendezvous Point\n      RPF     Reverse Path Forwarding\n\
    \      SPT     Shortest Path Tree\n      SSM     Source-Specific Multicast\n"
- title: 2.  Unicast-Prefix-based Address Format
  contents:
  - "2.  Unicast-Prefix-based Address Format\n   As described in [RFC3306], the multicast\
    \ address format is as\n   follows:\n      |   8    |  4 |  4 |   8    | 8  |\
    \       64       |    32    |\n      +--------+----+----+--------+----+----------------+----------+\n\
    \      |11111111|flgs|scop|reserved|plen| network prefix | group ID |\n      +--------+----+----+--------+----+----------------+----------+\n\
    \   Where flgs are \"0011\".  (The first two bits are as yet undefined,\n   sent\
    \ as zero and ignored on receipt.)\n"
- title: 3.  Modified Unicast-Prefix-based Address Format
  contents:
  - "3.  Modified Unicast-Prefix-based Address Format\n   This memo specifies a modification\
    \ to the unicast-prefix-based\n   address format by specifying the second high-order\
    \ bit (\"R-bit\") as\n   follows:\n      |   8    |  4 |  4 |  4 |  4 | 8  | \
    \      64       |    32    |\n      +--------+----+----+----+----+----+----------------+----------+\n\
    \      |11111111|flgs|scop|rsvd|RIID|plen| network prefix | group ID |\n     \
    \ +--------+----+----+----+----+----+----------------+----------+\n          \
    \                            +-+-+-+-+\n      flgs is a set of four flags:   \
    \ |0|R|P|T|\n                                      +-+-+-+-+\n   When the highest-order\
    \ bit is 0, R = 1 indicates a multicast address\n   that embeds the address on\
    \ the RP.  Then P MUST be set to 1, and\n   consequently T MUST be set to 1, as\
    \ specified in [RFC3306].  In\n   effect, this implies the prefix FF70::/12. \
    \ In this case, the last 4\n   bits of the previously reserved field are interpreted\
    \ as embedding\n   the RP interface ID, as specified in this memo.\n   The behavior\
    \ is unspecified if P or T is not set to 1, as then the\n   prefix would not be\
    \ FF70::/12.  Likewise, the encoding and the\n   protocol mode used when the two\
    \ high-order bits in \"flgs\" are set to\n   11 (\"FFF0::/12\") is intentionally\
    \ unspecified until such time that\n   the highest-order bit is defined.  Without\
    \ further IETF\n   specification, implementations SHOULD NOT treat the FFF0::/12\
    \ range\n   as Embedded-RP.\n   R = 0 indicates a multicast address that does\
    \ not embed the address\n   of the RP and follows the semantics defined in [ADDRARCH]\
    \ and\n   [RFC3306].  In this context, the value of \"RIID\" MUST be sent as zero\n\
    \   and MUST be ignored on receipt.\n"
- title: 4.  Embedding the Address of the RP in the Multicast Address
  contents:
  - "4.  Embedding the Address of the RP in the Multicast Address\n   The address\
    \ of the RP can only be embedded in unicast-prefix-based\n   ASM addresses.\n\
    \   That is, to identify whether it is a multicast address as specified\n   in\
    \ this memo and to be processed any further, an address must satisfy\n   all of\
    \ the following:\n   o It MUST be a multicast address with \"flgs\" set to 0111,\
    \ that is, to\n      be of the prefix FF70::/12,\n   o  \"plen\" MUST NOT be 0\
    \ (i.e., not SSM), and\n   o  \"plen\" MUST NOT be greater than 64.\n   The address\
    \ of the RP can be obtained from a multicast address\n   satisfying the above\
    \ criteria by taking the following two steps:\n   1. Copy the first \"plen\" bits\
    \ of the \"network prefix\" to a zeroed\n      128-bit address structure, and\n\
    \   2. replace the last 4 bits with the contents of \"RIID\".\n   These two steps\
    \ could be illustrated as follows:\n      | 20 bits | 4  | 8  |       64     \
    \  |    32    |\n      +---------+----+----+----------------+----------+\n   \
    \   |xtra bits|RIID|plen| network prefix | group ID |\n      +---------+----+----+----------------+----------+\n\
    \                  ||    \\\\  vvvvvvvvvvv\n                  ||     ``====> copy\
    \ plen bits of \"network prefix\"\n                  ||       +------------+--------------------------+\n\
    \                  ||       | network pre| 0000000000000000000000   |\n      \
    \            ||       +------------+--------------------------+\n            \
    \       \\\\\n                    ``=================> copy RIID to the last 4\
    \ bits\n                           +------------+---------------------+----+\n\
    \                           | network pre| 0000000000000000000 |RIID|\n      \
    \                     +------------+---------------------+----+\n   One should\
    \ note that there are several operational scenarios (see\n   Example 3 below)\
    \ when the [RFC3306] statement \"all non-significant\n   bits of the network prefix\
    \ field SHOULD be zero\" is ignored.  This is\n   to allow multicast group address\
    \ allocations to be consistent with\n   unicast prefixes; the multicast addresses\
    \ would still use the RP\n   associated with the network prefix.\n   \"plen\"\
    \ higher than 64 MUST NOT be used, as that would overlap with\n   the high-order\
    \ bits of multicast group-id.\n   When processing an encoding to get the RP address,\
    \ the multicast\n   routers MUST perform at least the same address validity checks\
    \ to the\n   calculated RP address as to one received via other means (like BSR\n\
    \   [BSR] or MSDP for IPv4).  At least fe80::/10, ::/16, and ff00::/8\n   MUST\
    \ be excluded.  This is particularly important, as the information\n   is obtained\
    \ from an untrusted source, i.e., any Internet user's\n   input.\n   One should\
    \ note that the 4 bits reserved for \"RIID\" set the upper\n   bound for RPs for\
    \ the combination of scope, network prefix, and group\n   ID -- without varying\
    \ any of these, one can have 2^4-1 = 15 different\n   RPs (as RIID=0 is reserved,\
    \ see section 6.3).  However, each of these\n   is an IPv6 group address of its\
    \ own (i.e., there can be only one RP\n   per multicast address).\n"
- title: 5.  Examples
  contents:
  - "5.  Examples\n   Four examples of multicast address allocation and resulting\
    \ group-\n   to-RP mappings are described here to better illustrate the\n   possibilities\
    \ provided by the encoding.\n"
- title: 5.1.  Example 1
  contents:
  - "5.1.  Example 1\n   The network administrator of 2001:DB8::/32 wants to set up\
    \ an RP for\n   the network and all the customers, by placing it on an existing\n\
    \   subnet, e.g., 2001:DB8:BEEF:FEED::/64.\n   In that case, the group addresses\
    \ would be something like\n   \"FF7x:y40:2001:DB8:BEEF:FEED::/96\", and then their\
    \ RP address would\n   be \"2001:DB8:BEEF:FEED::y\".  There are still 32 bits\
    \ of multicast\n   group-ids to assign to customers and self (\"y\" could be anything\
    \ from\n   1 to F, as 0 must not be used).\n"
- title: 5.2.  Example 2
  contents:
  - "5.2.  Example 2\n   As in Example 1, the network administrator of 2001:DB8::/32\
    \ wants to\n   set up the RP but, to make it more flexible, wants to place it\
    \ on a\n   specifically routed subnet and wants to keep larger address space for\n\
    \   group allocations.  That is, the administrator selects the least\n   specific\
    \ part of the unicast prefix, with plen=32, and the group\n   addresses will be\
    \ from the multicast prefix:\n      FF7x:y20:2001:DB8::/64\n   where \"x\" is\
    \ the multicast scope, \"y\" is the interface ID of the RP\n   address, and there\
    \ are 64 bits for group-ids or assignments.  In this\n   case, the address of\
    \ the RP would be:\n      2001:DB8::y\n   The address 2001:DB8::y/128 is assigned\
    \ to a router as a loopback\n   address and is injected into the routing system;\
    \ if the network\n   administrator sets up only one or two RPs (and, e.g., not\
    \ one RP per\n   subnet), this approach may be preferable to the one described\
    \ in\n   Example 1.\n"
- title: 5.3.  Example 3
  contents:
  - "5.3.  Example 3\n   As in Example 2, the network administrator can also assign\
    \ multicast\n   prefixes such as \"FF7x:y20:2001:DB8:DEAD::/80\" to some of customers.\n\
    \   In this case the RP address would still be \"2001:DB8::y\".  (Note that\n\
    \   this is just a more specific subcase of Example 2, where the\n   administrator\
    \ assigns a multicast prefix, not just individual group-\n   ids.)\n   Note the\
    \ second rule of deriving the RP address: the \"plen\" field in\n   the multicast\
    \ address, 0x20 = 32, refers to the length of \"network\n   prefix\" field considered\
    \ when obtaining the RP address.  In this\n   case, only the first 32 bits of\
    \ the network prefix field, \"2001:DB8\",\n   are preserved: the value of \"plen\"\
    \ takes no stance on actual\n   unicast/multicast prefix lengths allocated or\
    \ used in the networks,\n   here from 2001:DB8:DEAD::/48.\n   In short, this distinction\
    \ allows more flexible RP address\n   configuration in the scenarios where it\
    \ is desirable to have the\n   group addresses be consistent with the unicast\
    \ prefix allocations.\n"
- title: 5.4.  Example 4
  contents:
  - "5.4.  Example 4\n   In the network of Examples 1, 2, and 3, the network admin\
    \ sets up\n   addresses for use by customers, but an organization wants to have\
    \ its\n   own PIM-SM domain.  The organization can pick multicast addresses\n\
    \   such as \"FF7x:y30:2001:DB8:BEEF::/80\", and then the RP address would\n \
    \  be \"2001:DB8:BEEF::y\".\n"
- title: 6.  Operational Considerations
  contents:
  - "6.  Operational Considerations\n   This section describes the major operational\
    \ considerations for those\n   deploying this mechanism.\n"
- title: 6.1.  RP Redundancy
  contents:
  - "6.1.  RP Redundancy\n   A technique called \"Anycast RP\" is used within a PIM-SM\
    \ domain to\n   share an address and multicast state information between a set\
    \ of RPs\n   mainly for redundancy purposes.  Typically, MSDP has been used for\n\
    \   this as well [ANYCASTRP].  There are also other approaches, such as\n   using\
    \ PIM for sharing this information [ANYPIMRP].\n   The most feasible candidate\
    \ for RP failover is using PIM for Anycast\n   RP or \"anycasting\" (i.e., the\
    \ shared-unicast model [ANYCAST]) the RP\n   address in the Interior Gateway Protocol\
    \ (IGP) without state sharing\n   (although depending on the redundancy requirements,\
    \ this may or may\n   not be enough).  However, the redundancy mechanisms are\
    \ outside of\n   the scope of this memo.\n"
- title: 6.2.  RP Deployment
  contents:
  - "6.2.  RP Deployment\n   As there is no need to share inter-domain state with\
    \ MSDP, each\n   Designated Router connecting multicast sources could act as an\
    \ RP\n   without scalability concerns about setting up and maintaining MSDP\n\
    \   sessions.\n   This might be particularly attractive when one is concerned\
    \ about RP\n   redundancy.  In the case where the DR close to a major source for\
    \ a\n   group acts as the RP, a certain amount of fate-sharing properties can\n\
    \   be obtained without using any RP failover mechanisms: if the DR goes\n   down,\
    \ the multicast transmission may not work anymore in any case.\n   Along the same\
    \ lines, its may also be desirable to distribute the RP\n   responsibilities to\
    \ multiple RPs.  As long as different RPs serve\n   different groups, this is\
    \ trivial: each group could map to a\n   different RP (or sufficiently many different\
    \ RPs that the load on one\n   RP is not a problem).  However, load sharing challenges\
    \ one group\n   faces are similar to those of Anycast-RP.\n"
- title: 6.3.  Guidelines for Assigning IPv6 Addresses to RPs
  contents:
  - "6.3.  Guidelines for Assigning IPv6 Addresses to RPs\n   With this mechanism,\
    \ the RP can be given basically any unicast\n   network prefix up to /64. The\
    \ interface identifier will have to be\n   manually configured to match \"RIID\"\
    .\n   RIID = 0 must not be used, as using it would cause ambiguity with the\n\
    \   Subnet-Router Anycast Address [ADDRARCH].\n   If an administrator wishes to\
    \ use an RP address that does not conform\n   to the addressing topology but is\
    \ still from the network provider's\n   unicast prefix (e.g., an additional loopback\
    \ address assigned on a\n   router, as described in Example 2 in Section 5.1),\
    \ that address can\n   be injected into the routing system via a host route.\n"
- title: 6.4.  Use as a Substitute for BSR
  contents:
  - "6.4.  Use as a Substitute for BSR\n   With embedded-RP, use of BSR or other RP\
    \ configuration mechanisms\n   throughout the PIM domain is not necessary, as\
    \ each group address\n   specifies the RP to be used.\n"
- title: 6.5.  Controlling the Use of RPs
  contents:
  - "6.5.  Controlling the Use of RPs\n   Compared to the MSDP inter-domain ASM model,\
    \ the control and\n   management of who can use an RP, and how, changes slightly\
    \ and\n   deserves explicit discussion.\n   MSDP advertisement filtering typically\
    \ includes at least two\n   capabilities: filtering who is able to create a global\
    \ session\n   (\"source filtering\") and filtering which groups should be globally\n\
    \   accessible (\"group filtering\").  These are done to prevent local\n   groups\
    \ from being advertised to the outside or unauthorized senders\n   from creating\
    \ global groups.\n   However, such controls do not yet block the outsiders from\
    \ using such\n   groups, as they could join the groups even without Source Active\n\
    \   advertisement with a (Source, Group) or (S,G) Join by\n   guessing/learning\
    \ the source and/or the group address.  For proper\n   protection, one should\
    \ set up, for example, PIM multicast scoping\n   borders at the border routers.\
    \  Therefore, embedded-RP has by default\n   a roughly equivalent level of \"\
    protection\" as MSDP with SA filtering.\n   A new issue with control is that nodes\
    \ in a \"foreign domain\" may\n   register to an RP, or send PIM Join to an RP.\
    \  (These have been\n   possible in the past as well, to a degree, but only through\
    \ willful\n   attempts or purposeful RP configuration at DRs.)  The main threat\
    \ in\n   this case is that an outsider may illegitimately use the RP to host\n\
    \   his/hers own group(s).  This can be mitigated to an extent by\n   filtering\
    \ which groups or group ranges are allowed at the RP; more\n   specific controls\
    \ are beyond the scope of this memo.  Note that this\n   does not seem to be a\
    \ serious threat in the first place, as anyone\n   with a /64 unicast prefix can\
    \ create their own RP without having to\n   illegitimately get it from someone\
    \ else.\n"
- title: 7.  The Embedded-RP Group-to-RP Mapping Mechanism
  contents:
  - "7.  The Embedded-RP Group-to-RP Mapping Mechanism\n   This section specifies\
    \ the group-to-RP mapping mechanism for Embedded\n   RP.\n"
- title: 7.1.  PIM-SM Group-to-RP Mapping
  contents:
  - "7.1.  PIM-SM Group-to-RP Mapping\n   The only PIM-SM modification required is\
    \ implementing this mechanism\n   as one group-to-RP mapping method.\n   The implementation\
    \ will have to recognize the address format and\n   derive and use the RP address\
    \ by using the rules in Section 4.  This\n   information is used at least when\
    \ performing Reverse Path Forwarding\n   (RPF) lookups, when processing Join/Prune\
    \ messages, or performing\n   Register-encapsulation.\n   To avoid loops and inconsistencies,\
    \ for addresses in the range\n   FF70::/12, the Embedded-RP mapping MUST be considered\
    \ the longest\n   possible match and higher priority than any other mechanism.\n\
    \   It is worth noting that compared to the other group-to-RP mapping\n   mechanisms,\
    \ which can be precomputed, the embedded-RP mapping must be\n   redone for every\
    \ new IPv6 group address that would map to a different\n   RP.  For efficiency,\
    \ the results may be cached in an implementation-\n   specific manner, to avoid\
    \ computation for every embedded-RP packet.\n   This group-to-RP mapping mechanism\
    \ must be supported by the RP, the\n   DR adjacent to the senders, and any router\
    \ on the path from any\n   receiver to the RP.  Paths for Shortest Path Tree (SPT)\
    \ formation and\n   Register-Stop do not require the support, as those are accomplished\n\
    \   with an (S,G) Join.\n"
- title: 7.2.  Overview of the Model
  contents:
  - "7.2.  Overview of the Model\n   This section gives a high-level, non-normative\
    \ overview of how\n   Embedded RP operates, as specified in the previous section.\n\
    \   The steps when a receiver wishes to join a group are as follows:\n   1. A\
    \ receiver finds out a group address by some means (e.g., SDR or a\n      web\
    \ page).\n   2. The receiver issues an Multicast Listener Discovery (MLD) Report,\n\
    \      joining the group.\n   3. The receiver's DR will initiate the PIM-SM Join\
    \ process towards\n      the RP encoded in the multicast address, irrespective\
    \ of whether\n      it is in the \"local\" or \"remote\" PIM domain.\n   The steps\
    \ when a sender wishes to send to a group are as follows:\n   1. A sender finds\
    \ out a group address by using an unspecified method\n      (e.g., by contacting\
    \ the administrator for group assignment or\n      using a multicast address assignment\
    \ protocol).\n   2. The sender sends to the group.\n   3. The sender's DR will\
    \ send the packets unicast-encapsulated in\n      PIM-SM Register-messages to\
    \ the RP address encoded in the\n      multicast address (in the special case\
    \ that DR is the RP, such\n      sending is only conceptual).\n   In fact, all\
    \ the messages go as specified in [PIM-SM]; embedded-RP\n   just acts as a group-to-RP\
    \ mapping mechanism.  Instead of obtaining\n   the address of the RP from local\
    \ configuration or configuration\n   protocols (e.g., BSR), the algorithm derives\
    \ it transparently from\n   the encoded multicast address.\n"
- title: 8.  Scalability Analysis
  contents:
  - "8.  Scalability Analysis\n   Interdomain MSDP model for connecting PIM-SM domains\
    \ is mostly\n   hierarchical in configuration and deployment, but flat with regard\
    \ to\n   information distribution.  The embedded-RP inter-domain model behaves\n\
    \   as if every group formed its own Internet-wide PIM domain, with the\n   group\
    \ mapping to a single RP, wherever the receivers or senders are\n   located. \
    \ Hence, the inter-domain multicast becomes a flat, RP-\n   centered topology.\
    \  The scaling issues are described below.\n   Previously, foreign sources sent\
    \ the unicast-encapsulated data to\n   their \"local\" RP; now they are sent to\
    \ the \"foreign\" RP responsible\n   for the specific group.  This is especially\
    \ important with large\n   multicast groups where there are a lot of heavy senders\
    \ --\n   particularly if implementations do not handle unicast-decapsulation\n\
    \   well.\n   With IPv4 ASM multicast, there are roughly two kinds of Internet-wide\n\
    \   state: MSDP (propagated everywhere), and multicast routing state (on\n   the\
    \ receiver or sender branches).  The former is eliminated, but the\n   backbone\
    \ routers might end up with (*, G) and (S, G, rpt) state\n   between receivers\
    \ (and past receivers, for PIM Prunes) and the RP, in\n   addition to (S, G) states\
    \ between the receivers and senders, if SPT\n   is used.  However, the total amount\
    \ of state is smaller.\n   In both inter-domain and intra-domain cases, the embedded-RP\
    \ model is\n   practically identical to the traditional PIM-SM in intra-domain.\
    \  On\n   the other hand, PIM-SM has been deployed (in IPv4) in inter-domain\n\
    \   using MSDP; compared to that inter-domain model, this specification\n   simplifies\
    \ the tree construction (i.e., multicast routing) by\n   removing the RP for senders\
    \ and receivers in foreign domains and\n   eliminating the MSDP information distribution.\n\
    \   As the address of the RP is tied to the multicast address, the RP\n   failure\
    \ management becomes more difficult, as the deployed failover\n   or redundancy\
    \ mechanisms (e.g., BSR, Anycast-RP with MSDP) cannot be\n   used as-is.  However,\
    \ Anycast-RP using PIM provides equal redundancy;\n   this described briefly in\
    \ Section 6.1.\n   The PIM-SM specification states, \"Any RP address configured\
    \ or\n   learned MUST be a domain-wide reachable address\".  What \"reachable\"\
    \n   precisely means is not clear, even without embedded-RP.  This\n   statement\
    \ cannot be proven, especially with the foreign RPs, as one\n   cannot even guarantee\
    \ that the RP exists.  Instead of manually\n   configuring RPs and DRs (configuring\
    \ a non-existent RP was possible,\n   though rare), with this specification the\
    \ hosts and users using\n   multicast indirectly specify the RP themselves, lowering\
    \ the\n   expectancy of the RP reachability.  This is a relatively significant\n\
    \   problem but not much different from the current multicast deployment:\n  \
    \ e.g., MLDv2 (S,G) joins, whether ASM or SSM, yield the same result\n   [PIMSEC].\n\
    \   Being able to join/send to remote RPs raises security concerns that\n   are\
    \ considered separately, but it has an advantage too: every group\n   has a \"\
    responsible RP\" that is able to control (to some extent) who\n   is able to send\
    \ to the group.\n   A more extensive description and comparison of the inter-domain\n\
    \   multicast routing models (traditional ASM with MSDP, embedded-RP,\n   SSM)\
    \ and their security properties has been described in [PIMSEC].\n"
- title: 9.  Acknowledgements
  contents:
  - "9.  Acknowledgements\n   Jerome Durand commented on an early version of this\
    \ memo.  Marshall\n   Eubanks noted an issue regarding short plen values.  Tom\
    \ Pusateri\n   noted problems with an earlier SPT-join approach.  Rami Lehtonen\n\
    \   pointed out issues with the scope of SA-state and provided extensive\n   commentary.\
    \  Nidhi Bhaskar gave the document a thorough review.\n   Toerless Eckert, Hugh\
    \ Holbrook, and Dave Meyer provided very\n   extensive feedback.  In particular,\
    \ Pavlin Radoslavov, Dino\n   Farinacci, Nidhi Bhaskar, and Jerome Durand provided\
    \ good comments\n   during and after WG last call.  Mark Allman, Bill Fenner,\
    \ Thomas\n   Narten, and Alex Zinin provided substantive comments during the IESG\n\
    \   evaluation.  The whole MboneD working group is also acknowledged for\n   continued\
    \ support and comments.\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   The addresses of RPs are encoded in the multicast\
    \ addresses, thus\n   becoming more visible as single points of failure.  Even\
    \ though this\n   does not significantly affect the multicast routing security,\
    \ it may\n   expose the RP to other kinds of attacks.  The operators are\n   encouraged\
    \ to pay special attention to securing these routers.  See\n   Section 6.1 for\
    \ considerations regarding failover and Section 6.2 for\n   placement of RPs leading\
    \ to a degree of fate-sharing properties.\n   As any RP will have to accept PIM-SM\
    \ Join/Prune/Register messages\n   from any DR, this might cause a potential Denial\
    \ of Service attack\n   scenario.  However, this can be mitigated, as the RP can\
    \ discard all\n   such messages for all multicast addresses that do not encode\
    \ the\n   address of the RP.  Both the sender- and receiver-based attacks are\n\
    \   described at greater length in [PIMSEC].\n   Additionally, the implementation\
    \ SHOULD also allow manual\n   configuration of which multicast prefixes are allowed\
    \ to be used.\n   This can be used to limit the use of the RP to designated groups\n\
    \   only.  In some cases, being able to restrict (at the RP) which\n   unicast\
    \ addresses are allowed to send or join to a group is\n   desirable.  (However,\
    \ note that Join/Prune messages would still leave\n   state in the network, and\
    \ Register messages can be spoofed [PIMSEC].)\n   Obviously, these controls are\
    \ only possible at the RP, not at the\n   intermediate routers or the DR.\n  \
    \ It is RECOMMENDED that routers supporting this specification do not\n   act\
    \ as RPs unless explicitly configured to do so, as becoming an RP\n   does not\
    \ require any advertisement (e.g., through BSR or manually).\n   Otherwise, any\
    \ router could potentially become an RP (and be abused\n   as such).  Further,\
    \ multicast groups or group ranges to-be-served MAY\n   need to be explicitly\
    \ configured at the RPs, to protect them from\n   being used unwillingly.  Note\
    \ that the more specific controls (e.g.,\n   \"insider-must-create\" or \"invite-outsiders\"\
    \ models) as to who is\n   allowed to use the groups are beyond the scope of this\
    \ memo.\n   Excluding internal-only groups from MSDP advertisements does not\n\
    \   protect the groups from outsiders but only offers security by\n   obscurity;\
    \ embedded-RP offers similar level of protection.  When real\n   protection is\
    \ desired, PIM scoping for example, should be set up at\n   the borders. This\
    \ is described at more length in Section 6.5.\n   One should observe that the\
    \ embedded-RP threat model is actually\n   rather similar to SSM; both mechanisms\
    \ significantly reduce the\n   threats at the sender side.  On the receiver side,\
    \ the threats are\n   somewhat comparable, as an attacker could do an MLDv2 (S,G)\
    \ join\n   towards a non-existent source, which the local RP could not block\n\
    \   based on the MSDP information.\n   The implementation MUST perform at least\
    \ the same address validity\n   checks to the embedded-RP address as it would\
    \ to one received via\n   other means; at least fe80::/10, ::/16, and ff00::/8\
    \ should be\n   excluded.  This is particularly important, as the information\
    \ is\n   derived from the untrusted source (i.e., any user in the Internet),\n\
    \   not from the local configuration.\n   A more extensive description and comparison\
    \ of the inter-domain\n   multicast routing models (traditional ASM with MSDP,\
    \ embedded-RP,\n   SSM) and their security properties has been done separately\
    \ in\n   [PIMSEC].\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [ADDRARCH]  Hinden, R. and S. Deering, \"Internet\
    \ Protocol Version 6\n               (IPv6) Addressing Architecture\", RFC 3513,\
    \ April 2003.\n   [RFC2119]   Bradner, S., \"Key words for use in RFCs to Indicate\n\
    \               Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC3306]\
    \   Haberman, B. and D. Thaler, \"Unicast-Prefix-based IPv6\n               Multicast\
    \ Addresses\", RFC 3306, August 2002.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [ANYCAST]   Hagino, J. and K. Ettikan, \"An\
    \ analysis of IPv6 anycast\",\n               Work in Progress, June 2003.\n \
    \  [ANYCASTRP] Kim, D., Meyer, D., Kilmer, H., and D. Farinacci,\n           \
    \    \"Anycast Rendevous Point (RP) mechanism using Protocol\n               Independent\
    \ Multicast (PIM) and Multicast Source\n               Discovery Protocol (MSDP)\"\
    , RFC 3446, January 2003.\n   [ANYPIMRP]  Farinacci, D. and Y. Cai, \"Anycast-RP\
    \ using PIM\", Work in\n               Progress, June 2004.\n   [BSR]       Fenner,\
    \ B., et al., \"Bootstrap Router (BSR) Mechanism for\n               PIM Sparse\
    \ Mode\", Work in Progress, July 2004.\n   [MSDP]      Fenner, B. and D. Meyer,\
    \ \"Multicast Source Discovery\n               Protocol (MSDP)\", RFC 3618, October\
    \ 2003.\n   [PIMSEC]    Savola, P., Lehtonen, R., and D. Meyer, \"PIM-SM Multicast\n\
    \               Routing Security Issues and Enhancements\", Work in\n        \
    \       Progress, October 2004.\n   [PIM-SM]    Fenner, B. et al, \"Protocol Independent\
    \ Multicast -\n               Sparse Mode (PIM-SM): Protocol Specification (Revised)\"\
    ,\n               Work in Progress, July 2004.\n   [SSM]       Holbrook, H. et\
    \ al, \"Source-Specific Multicast for IP\",\n               Work in Progress,\
    \ September 2004.\n   [V6MISSUES] Savola, P., \"IPv6 Multicast Deployment Issues\"\
    , Work in\n               Progress, September 2004.\n"
- title: A.  Discussion about Design Tradeoffs
  contents:
  - "A.  Discussion about Design Tradeoffs\n   The document only specifies FF70::/12\
    \ for now; if/when the upper-most\n   bit is used, one must specify how FFF0::/12\
    \ applies to Embedded-RP.\n   For example, a different mode of PIM or another\
    \ protocol might use\n   that range, in contrast to FF70::/12, as currently specified,\
    \ being\n   for PIM-SM only.\n   Instead of using flags bits (\"FF70::/12\"),\
    \ one could have used the\n   leftmost reserved bits instead (\"FF3x:8000::/17\"\
    ).\n   It has been argued that instead of allowing the operator to specify\n \
    \  RIID, the value could be pre-determined (e.g., \"1\").  However, this\n   has\
    \ not been adopted, as this eliminates address assignment\n   flexibility from\
    \ the operator.\n   Values 64 < \"plen\" < 96 would overlap with upper bits of\
    \ the\n   multicast group-id; due to this restriction, \"plen\" must not exceed\n\
    \   64 bits.  This is in line with RFC 3306.\n   The embedded-RP addressing could\
    \ be used to convey other information\n   (other than RP address) as well, for\
    \ example, what should be the RPT\n   threshold for PIM-SM.  These could be, whether\
    \ feasible or not,\n   encoded in the RP address somehow, or in the multicast\
    \ group address.\n   In any case, such modifications are beyond the scope of this\
    \ memo.\n   For the cases where the RPs do not exist or are unreachable, or too\n\
    \   much state is being generated to reach in a resource exhaustion\n   Denial\
    \ of Service attack, some forms of rate-limiting or other\n   mechanisms could\
    \ be deployed to mitigate the threats while trying not\n   to disturb the legitimate\
    \ usage.  However, as the threats are\n   generic, they are considered out of\
    \ scope and discussed separately in\n   [PIMSEC].\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Pekka Savola\n   CSC/FUNET\n   Espoo, Finland\n   EMail:\
    \ psavola@funet.fi\n   Brian Haberman\n   Johns Hopkins University Applied Physics\
    \ Lab\n   11100 Johns Hopkins Road\n   Laurel, MD  20723-6099\n   US\n   Phone:\
    \ +1 443 778 1319\n   EMail: brian@innovationslab.net\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2004).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ IETF's procedures with respect to rights in IETF Documents can\n   be found\
    \ in BCP 78 and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat\
    \ and any\n   assurances of licenses to be made available, or the result of an\n\
    \   attempt made to obtain a general license or permission for the use of\n  \
    \ such proprietary rights by implementers or users of this\n   specification can\
    \ be obtained from the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n\
    \   The IETF invites any interested party to bring to its attention any\n   copyrights,\
    \ patents or patent applications, or other proprietary\n   rights that may cover\
    \ technology that may be required to implement\n   this standard.  Please address\
    \ the information to the IETF at ietf-\n   ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
