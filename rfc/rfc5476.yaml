- title: __initial_text__
  contents:
  - '            Packet Sampling (PSAMP) Protocol Specifications

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n   This document may contain\
    \ material from IETF Documents or IETF\n   Contributions published or made publicly\
    \ available before November\n   10, 2008.  The person(s) controlling the copyright\
    \ in some of this\n   material may not have granted the IETF Trust the right to\
    \ allow\n   modifications of such material outside the IETF Standards Process.\n\
    \   Without obtaining an adequate license from the person(s) controlling\n   the\
    \ copyright in such materials, this document may not be modified\n   outside the\
    \ IETF Standards Process, and derivative works of it may\n   not be created outside\
    \ the IETF Standards Process, except to format\n   it for publication as an RFC\
    \ or to translate it into languages other\n   than English.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies the export of packet information from a\n\
    \   Packet SAMPling (PSAMP) Exporting Process to a PSAMP Collecting\n   Process.\
    \  For export of packet information, the IP Flow Information\n   eXport (IPFIX)\
    \ protocol is used, as both the IPFIX and PSAMP\n   architecture match very well,\
    \ and the means provided by the IPFIX\n   protocol are sufficient.  The document\
    \ specifies in detail how the\n   IPFIX protocol is used for PSAMP export of packet\
    \ information.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Conventions Used in This Document ..........................3\n  \
    \ 2. PSAMP Documents Overview ........................................4\n   3.\
    \ Terminology .....................................................4\n      3.1.\
    \ IPFIX Terminology ..........................................4\n      3.2. PSAMP\
    \ Terminology ..........................................5\n           3.2.1. Packet\
    \ Streams and Packet Content ...................5\n           3.2.2. Selection\
    \ Process ...................................6\n           3.2.3. Reporting ...........................................7\n\
    \           3.2.4. Metering Process ....................................8\n  \
    \         3.2.5. Exporting Process ...................................8\n    \
    \       3.2.6. PSAMP Device ........................................8\n      \
    \     3.2.7. Collector ...........................................8\n        \
    \   3.2.8. Selection Methods ...................................9\n      3.3.\
    \ IPFIX and PSAMP Terminology Comparison ....................11\n           3.3.1.\
    \ IPFIX and PSAMP Processes ..........................11\n           3.3.2. Packet\
    \ Report, Packet Interpretation, and\n                  Data Record ........................................12\n\
    \   4. Differences between PSAMP and IPFIX ............................12\n  \
    \    4.1. Architecture Point of View ................................12\n    \
    \  4.2. Protocol Point of View ....................................14\n      4.3.\
    \ Information Model Point of View ...........................14\n   5. PSAMP Requirements\
    \ versus the IPFIX Solution ...................14\n      5.1. High-Level View\
    \ of the Integration ........................15\n   6. Using the IPFIX Protocol\
    \ for PSAMP .............................16\n      6.1. Selector ID ...............................................17\n\
    \      6.2. The Selection Sequence ID .................................17\n  \
    \    6.3. The Exporting Process .....................................17\n    \
    \  6.4. Packet Report .............................................17\n      \
    \     6.4.1. Basic Packet Report ................................17\n        \
    \   6.4.2. Extended Packet Report .............................21\n      6.5.\
    \ Report Interpretation .....................................22\n           6.5.1.\
    \ Selection Sequence Report Interpretation ...........23\n           6.5.2. Selector\
    \ Report Interpretation .....................25\n                  6.5.2.1. Systematic\
    \ Count-Based Sampling ...........25\n                  6.5.2.2. Systematic Time-Based\
    \ Sampling ............27\n                  6.5.2.3. Random n-out-of-N Sampling\
    \ ................28\n                  6.5.2.4. Uniform Probabilistic Sampling\
    \ ............29\n                  6.5.2.5. Property Match Filtering ..................31\n\
    \                  6.5.2.6. Hash-Based Filtering ......................33\n  \
    \                6.5.2.7. Other Selection Methods ...................36\n    \
    \       6.5.3. Selection Sequence Statistics Report\n                  Interpretation\
    \ .....................................37\n           6.5.4. Accuracy Report Interpretation\
    \ .....................39\n   7. Security Considerations ........................................43\n\
    \   8. IANA Considerations ............................................43\n  \
    \    8.1. IPFIX-Related Considerations ..............................43\n    \
    \  8.2. PSAMP-Related Considerations ..............................43\n   9. References\
    \ .....................................................44\n      9.1. Normative\
    \ References ......................................44\n      9.2. Informative\
    \ References ....................................44\n   10. Acknowledgments ...............................................45\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The name PSAMP is a contraction of the phrase \"Packet Sampling\"\
    .  The\n   word \"Sampling\" captures the idea that only a subset of all packets\n\
    \   passing a network element will be selected for reporting.  PSAMP\n   selection\
    \ operations include random selection, deterministic\n   selection, and deterministic\
    \ approximations to random selection\n   (Hash-based Selection).\n   The IP Flow\
    \ Information eXport (IPFIX) protocol specified in\n   [RFC5101] exports IP traffic\
    \ information [RFC5102] observed at\n   network devices.  This matches the general\
    \ protocol requirements\n   outlined in the PSAMP framework [RFC5474].  However,\
    \ there are some\n   architectural differences between IPFIX and PSAMP in the\
    \ requirements\n   for an export protocol.  While the IPFIX architecture [RFC5470]\
    \ is\n   focused on gathering and exporting IP traffic flow information, the\n\
    \   focus of the PSAMP framework [RFC5474] is on exporting information on\n  \
    \ individual packets.  This basic difference and a set of derived\n   differences\
    \ in protocol requirements are outlined in Section 4.\n   Despite these differences,\
    \ the IPFIX protocol is well suited for the\n   PSAMP protocol.  Section 5 specifies\
    \ how the IPFIX protocol is used\n   for the export of packet samples.  Required\
    \ extensions of the IPFIX\n   information model are specified in the PSAMP information\
    \ model\n   [RFC5477].\n"
- title: 1.1.  Conventions Used in This Document
  contents:
  - "1.1.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n"
- title: 2.  PSAMP Documents Overview
  contents:
  - "2.  PSAMP Documents Overview\n   This document is one out of a series of documents\
    \ from the PSAMP\n   group.\n   [RFC5474]: \"A Framework for Packet Selection\
    \ and Reporting\" describes\n   the PSAMP framework for network elements to select\
    \ subsets of packets\n   by statistical and other methods, and to export a stream\
    \ of reports\n   on the selected packets to a Collector.\n   [RFC5475]: \"Sampling\
    \ and Filtering Techniques for IP Packet\n   Selection\" describes the set of\
    \ packet selection techniques supported\n   by PSAMP.\n   RFC 5476 (this document):\
    \ \"Packet Sampling (PSAMP) Protocol\n   Specifications\" specifies the export\
    \ of packet information from a\n   PSAMP Exporting Process to a PSAMP Collecting\
    \ Process.\n   [RFC5477]: \"Information Model for Packet Sampling Exports\" defines\
    \ an\n   information and data model for PSAMP.\n"
- title: 3.  Terminology
  contents:
  - "3.  Terminology\n   As the IPFIX export protocol is used to export the PSAMP\
    \ information,\n   the relevant IPFIX terminology from [RFC5101] is copied over\
    \ in this\n   document.  All terms defined in this section have their first letter\n\
    \   capitalized when used in this document.  The terminology summary\n   table\
    \ in Section 3.1 gives a quick overview of the relationships\n   between the different\
    \ IPFIX terms.  The PSAMP terminology defined\n   here is fully consistent with\
    \ all terms listed in [RFC5475] and\n   [RFC5474], but only definitions that are\
    \ relevant to the PSAMP\n   protocol appear here.  Section 3.3 applies the PSAMP\
    \ terminology to\n   the IPFIX protocol terminology.\n"
- title: 3.1.   IPFIX Terminology
  contents:
  - "3.1.   IPFIX Terminology\n   IPFIX-specific terminology used in this document\
    \ is defined in\n   Section 2 of [RFC5101].  The only exceptions are the Metering\n\
    \   Process, Exporting Process, and the Collector terms, which are\n   defined\
    \ more precisely in the PSAMP terminology section.  In this\n   document, as in\
    \ [RFC5101], the first letter of each IPFIX-specific\n   term is capitalized.\n\
    \      +------------------+---------------------------------------------+\n  \
    \    |                  |                 contents                    |\n    \
    \  |                  +--------------------+------------------------+\n      |\
    \       Set        |      Template      |         record         |\n      +------------------+--------------------+------------------------+\n\
    \      |     Data Set     |          /         |     Data Record(s)     |\n  \
    \    +------------------+--------------------+------------------------+\n    \
    \  |   Template Set   | Template Record(s) |           /            |\n      +------------------+--------------------+------------------------+\n\
    \      | Options Template | Options Template   |           /            |\n  \
    \    |       Set        | Record(s)          |                        |\n    \
    \  +------------------+--------------------+------------------------+\n      \
    \               Figure A: Terminology Summary Table\n"
- title: 3.2.  PSAMP Terminology
  contents:
  - "3.2.  PSAMP Terminology\n   The PSAMP terminology section has been copied from\
    \ [RFC5475].\n"
- title: 3.2.1.  Packet Streams and Packet Content
  contents:
  - "3.2.1.  Packet Streams and Packet Content\n   * Observed Packet Stream\n    \
    \  The Observed Packet Stream is the set of all packets observed at\n      the\
    \ Observation Point.\n   * Packet Stream\n      A Packet Stream denotes a set\
    \ of packets from the Observed Packet\n      Stream that flows past some specified\
    \ point within the Metering\n      Process.  An example of a Packet Stream is\
    \ the output of the\n      Selection Process.  Note that packets selected from\
    \ a stream,\n      e.g., by Sampling, do not necessarily possess a property by\
    \ which\n      they can be distinguished from packets that have not been\n   \
    \   selected.  For this reason, the term \"stream\" is favored over\n      \"\
    flow\", which is defined as a set of packets with common\n      properties [RFC3917].\n\
    \   * Packet Content\n      The Packet Content denotes the union of the packet\
    \ header (which\n      includes link layer, network layer, and other encapsulation\n\
    \      headers) and the packet payload.  Note that, depending on the\n      Observation\
    \ Point, the link layer information might not be\n      available.\n"
- title: 3.2.2.  Selection Process
  contents:
  - "3.2.2.  Selection Process\n   * Selection Process\n      A Selection Process\
    \ takes the Observed Packet Stream as its input\n      and selects a subset of\
    \ that stream as its output.\n   * Selection State\n      A Selection Process\
    \ may maintain state information for use by the\n      Selection Process.  At\
    \ a given time, the Selection State may\n      depend on packets observed at and\
    \ before that time, and other\n      variables.  Examples include:\n         (i)\
    \ sequence numbers of packets at the input of Selectors;\n        (ii) a timestamp\
    \ of observation of the packet at the Observation\n             Point;\n     \
    \  (iii) iterators for pseudorandom number generators;\n        (iv) hash values\
    \ calculated during selection;\n         (v) indicators of whether the packet\
    \ was selected by a given\n             Selector.\n      Selection Processes may\
    \ change portions of the Selection State as\n      a result of processing a packet.\
    \  Selection state for a packet is\n      to reflect the state after processing\
    \ the packet.\n   * Selector\n      A Selector defines the action of a Selection\
    \ Process on a single\n      packet of its input.  If selected, the packet becomes\
    \ an element\n      of the output Packet Stream.\n      The Selector can make\
    \ use of the following information in\n      determining whether a packet is selected:\n\
    \         (i) the Packet Content;\n        (ii) information derived from the packet's\
    \ treatment at the\n             Observation Point;\n       (iii) any selection\
    \ state that may be maintained by the Selection\n             Process.\n   * Composite\
    \ Selector\n      A Composite Selector is an ordered composition of Selectors,\
    \ in\n      which the output Packet Stream issuing from one Selector forms the\n\
    \      input Packet Stream to the succeeding Selector.\n   * Primitive Selector\n\
    \      A Selector is primitive if it is not a Composite Selector.\n   * Selector\
    \ ID\n      The Selector ID is the unique ID identifying a Primitive Selector.\n\
    \      The ID is unique within the Observation Domain.\n   * Selection Sequence\n\
    \      From all the packets observed at an Observation Point, only a few\n   \
    \   packets are selected by one or more Selectors.  The Selection\n      Sequence\
    \ is a unique value per Observation Domain describing the\n      Observation Point\
    \ and the Selector IDs through which the packets\n      are selected.\n"
- title: 3.2.3.  Reporting
  contents:
  - "3.2.3.  Reporting\n   * Packet Reports\n      Packet Reports comprise a configurable\
    \ subset of a packet's input\n      to the Selection Process, including the Packet\
    \ Content,\n      information relating to its treatment (for example, the output\n\
    \      interface), and its associated selection state (for example, a\n      hash\
    \ of the Packet Content).\n   * Report Interpretation\n      Report Interpretation\
    \ comprises subsidiary information, relating\n      to one or more packets, that\
    \ is used for interpretation of their\n      Packet Reports.  Examples include\
    \ configuration parameters of the\n      Selection Process.\n   * Report Stream\n\
    \      The Report Stream is the output of a Metering Process, comprising\n   \
    \   two distinguished types of information: Packet Reports and Report\n      Interpretation.\n"
- title: 3.2.4.  Metering Process
  contents:
  - "3.2.4.  Metering Process\n   * Metering Process\n      A Metering Process selects\
    \ packets from the Observed Packet Stream\n      using a Selection Process, and\
    \ produces as output a Report Stream\n      concerning the selected packets.\n\
    \      The PSAMP Metering Process can be viewed as analogous to the IPFIX\n  \
    \    Metering Process [RFC5101], which produces Flow Records as its\n      output,\
    \ with the difference that the PSAMP Metering Process always\n      contains a\
    \ Selection Process.  The relationship between PSAMP and\n      IPFIX is further\
    \ described in [RFC5477] and [RFC5474].\n"
- title: 3.2.5.  Exporting Process
  contents:
  - "3.2.5.  Exporting Process\n   * Exporting Process\n      An Exporting Process\
    \ sends, in the form of Export Packets, the\n      output of one or more Metering\
    \ Processes to one or more\n      Collectors.\n   * Export Packet\n      An Export\
    \ Packet is a combination of Report Interpretation(s)\n      and/or one or more\
    \ Packet Reports that are bundled by the\n      Exporting Process into an Export\
    \ Packet for exporting to a\n      Collector.\n"
- title: 3.2.6.  PSAMP Device
  contents:
  - "3.2.6.  PSAMP Device\n   * PSAMP Device\n      A PSAMP Device is a device hosting\
    \ at least an Observation Point,\n      a Selection Process, and an Exporting\
    \ Process.  Typically,\n      corresponding Observation Point(s), Selection Process(es),\
    \ and\n      Exporting Process(es) are co-located at this device, for example,\n\
    \      at a router.\n"
- title: 3.2.7.  Collector
  contents:
  - "3.2.7.  Collector\n   * Collector\n      A Collector receives a Report Stream\
    \ exported by one or more\n      Exporting Processes.  In some cases, the host\
    \ of the Metering\n      and/or Exporting Processes may also serve as the Collector.\n"
- title: 3.2.8.  Selection Methods
  contents:
  - "3.2.8.  Selection Methods\n   * Filtering\n      A filter is a Selector that\
    \ selects a packet deterministically\n      based on the Packet Content, or its\
    \ treatment, or functions of\n      these occurring in the Selection State.  Two\
    \ examples are:\n         (i) Property Match Filtering: A packet is selected if\
    \ a\n             specific field in the packet equals a predefined value.\n  \
    \      (ii) Hash-based Selection: A Hash Function is applied to the\n        \
    \     Packet Content, and the packet is selected if the result\n             falls\
    \ in a specified range.\n   * Sampling\n             A Selector that is not a\
    \ filter is called a Sampling\n             operation.  This reflects the intuitive\
    \ notion that if the\n             selection of a packet cannot be determined\
    \ from its content\n             alone, there must be some type of Sampling taking\
    \ place.\n   * Content-Independent Sampling\n             A Sampling operation\
    \ that does not use Packet Content (or\n             quantities derived from it)\
    \ as the basis for selection is\n             called a Content-independent Sampling\
    \ operation.  Examples\n             include systematic Sampling, and uniform\
    \ pseudorandom\n             Sampling driven by a pseudorandom number whose generation\n\
    \             is independent of Packet Content.  Note that in Content-\n     \
    \        independent Sampling, it is not necessary to access the\n           \
    \  Packet Content in order to make the selection decision.\n   * Content-Dependent\
    \ Sampling\n             A Sampling operation where selection is dependent on\
    \ Packet\n             Content is called a Content-dependent Sampling operation.\n\
    \             An example is pseudorandom selection according to a\n          \
    \   probability that depends on the contents of a packet field.\n            \
    \ Note that this is not a filter, because the selection is\n             not deterministic.\n\
    \   * Hash Domain\n             A Hash Domain is a subset of the Packet Content\
    \ and the\n             packet treatment, viewed as an N-bit string for some\n\
    \             positive integer N.\n   * Hash Range\n             A Hash Range\
    \ is a set of M-bit strings for some positive\n             integer M that define\
    \ the range of values the result of the\n             hash operation can take.\n\
    \   * Hash Function\n             A Hash Function defines a deterministic map\
    \ from the Hash\n             Domain into the Hash Range.\n   * Hash Selection\
    \ Range\n             A Hash Selection Range is a subset of the Hash Range.  The\n\
    \             packet is selected if the action of the Hash Function on\n     \
    \        the Hash Domain for the packet yields a result in the Hash\n        \
    \     Selection Range.\n   * Hash-based Selection\n             A Hash-based Selection\
    \ is Filtering specified by a Hash\n             Domain, a Hash Function, a Hash\
    \ Range, and a Hash Selection\n             Range.\n   * Approximative Selection\n\
    \             Selectors in any of the above categories may be\n             approximated\
    \ by operations in the same or another category\n             for the purposes\
    \ of implementation.  For example, uniform\n             pseudorandom Sampling\
    \ may be approximated by Hash-based\n             Selection, using a suitable\
    \ Hash Function and Hash Domain.\n             In this case, the closeness of\
    \ the approximation depends on\n             the choice of Hash Function and Hash\
    \ Domain.\n   * Population\n             A Population is a Packet Stream, or a\
    \ subset of a Packet\n             Stream.  A Population can be considered as\
    \ a base set from\n             which packets are selected.  An example is all\
    \ packets in\n             the Observed Packet Stream that are observed within\
    \ some\n             specified time interval.\n   * Population Size\n        \
    \     The Population Size is the number of all packets in the\n             Population.\n\
    \   * Sample Size\n             The Sample Size is the number of packets selected\
    \ from the\n             Population by a Selector.\n   * Configured Selection\
    \ Fraction\n             The Configured Selection Fraction is the expected ratio\
    \ of\n             the Sample Size to the Population Size, as based on the\n \
    \            configured selection parameters.\n   * Attained Selection Fraction\n\
    \             The Attained Selection Fraction is the ratio of the actual\n   \
    \          Sample Size to the Population Size.  For some Sampling\n          \
    \   methods, the Attained Selection Fraction can differ from\n             the\
    \ Configured Selection Fraction due to, for example, the\n             inherent\
    \ statistical variability in Sampling decisions of\n             probabilistic\
    \ Sampling and Hash-based Selection.\n             Nevertheless, for large Population\
    \ Sizes and properly\n             configured Selectors, the Attained Selection\
    \ Fraction\n             usually approaches the Configured Selection Fraction.\n"
- title: 3.3.  IPFIX and PSAMP Terminology Comparison
  contents:
  - "3.3.  IPFIX and PSAMP Terminology Comparison\n   The PSAMP terminology has been\
    \ specified with an IPFIX background, as\n   PSAMP and IPFIX have similar terms.\
    \  However, this section clarifies\n   the terms between the IPFIX and PSAMP terminology.\n"
- title: 3.3.1.  IPFIX and PSAMP Processes
  contents:
  - "3.3.1.  IPFIX and PSAMP Processes\n   Figure B indicates the sequence of the\
    \ IPFIX processes (Metering and\n   Exporting) within the PSAMP Device.\n    \
    \            +------------------+\n                | Metering Process |\n    \
    \            | +-----------+    |     +-----------+\n      Observed  | | Selection\
    \ |    |     | Exporting |\n      Packet--->| | Process   |--------->| Process\
    \   |--->Collector\n      Stream    | +-----------+    |     +-----------+\n \
    \               +------------------+\n                          Figure B: PSAMP\
    \ Processes\n   The Selection Process, which takes an Observed Packet Stream as\
    \ its\n   input, is an integral part of the Metering Process.  The Selection\n\
    \   Process chooses which packets from its input Packet Stream will be\n   reported\
    \ on by the rest of the Metering Process.  Note that a\n   \"Process\" is not\
    \ necessarily implemented as a separate CPU thread.\n"
- title: 3.3.2.  Packet Report, Packet Interpretation, and Data Record
  contents:
  - "3.3.2.  Packet Report, Packet Interpretation, and Data Record\n   The PSAMP terminology\
    \ speaks of Packet Report and Packet\n   Interpretation, while the IPFIX terminology\
    \ speaks of Data Record and\n   (Options) Template Record.  The PSAMP Packet Report,\
    \ which comprises\n   information about the observed packet, can be viewed as\
    \ analogous to\n   the IPFIX Data Record defined by a Template Record.  The PSAMP\
    \ Report\n   Interpretation, which comprises subsidiary information used for the\n\
    \   interpretation of the Packet Reports, can be viewed as analogous to\n   the\
    \ IPFIX Data Record defined by an Options Template Record.  This\n   Options Template\
    \ Record contains subsidiary information, applicable\n   to the observed packet\
    \ sent into the PSAMP Packet Report.\n"
- title: 4.  Differences between PSAMP and IPFIX
  contents:
  - "4.  Differences between PSAMP and IPFIX\n   The output of the IPFIX working group\
    \ relevant for this document is\n   structured into three documents:\n      -\
    \ IP Flow information architecture [RFC5470]\n      - IPFIX protocol specifications\
    \ [RFC5101]\n      - IP Flow information export information model [RFC5102]\n\
    \   In the following sections, we investigate the differences between\n   IPFIX\
    \ and PSAMP for each of those aspects.\n"
- title: 4.1.  Architecture Point of View
  contents:
  - "4.1.  Architecture Point of View\n   Traffic Flow measurement as described in\
    \ the IPFIX requirements\n   [RFC3917] and the IPFIX architecture [RFC5470] can\
    \ be separated into\n   two stages: packet processing and Flow processing.  Figure\
    \ C\n   illustrates these stages.\n   In stage 1, all processing steps act on\
    \ packets.  Packets are\n   captured, timestamped, selected by one or more selection\
    \ steps, and\n   finally forwarded to packet classification that maps packets\
    \ to\n   Flows.  The packets' selection steps may include Filtering and\n   Sampling\
    \ functions.\n   In stage 2, all processing steps act on Flows.  After packets\
    \ are\n   classified (mapped to Flows), Flows are generated (or updated if they\n\
    \   exist already).  Flow generation and update steps may be performed\n   repeatedly\
    \ for aggregating Flows.  Finally, Flows are exported.\n   Packet Sampling as\
    \ described in the PSAMP framework [RFC5474] covers\n   only stage 1 of the IPFIX\
    \ architecture with the packet classification\n   replaced by Packet Report export,\
    \ while IPFIX covers stage 2 also, as\n   it generates Flow Records out of the\
    \ selected packets.\n      IPFIX architecture                       PSAMP framework\n\
    \        packet header                           packet header\n          capturing\
    \     \\                         capturing\n              |          |       \
    \                     |\n         timestamping    |                       timestamping\n\
    \              |          |                            |\n              v    \
    \      |                            v\n      +------>+          |  stage 1:  \
    \        +------>+\n      |       |           > packet            |       |\n\
    \      |    packet        |  processing        |    packet\n      |   selection\
    \      |                    |   selection\n      |       |          |        \
    \            |       |\n      +-------+          |                    +-------+\n\
    \              |          |                            |\n              v    \
    \      |                            v\n           packet       /             \
    \          Packet Report\n        classification  \\                         \
    \ export\n              |          |\n              v          |\n      +------>+\
    \          |\n      |       |          |\n      | Flow generation  |\n      |\
    \   and update     |  stage 2:\n      |       |           > Flow\n      |    \
    \   v          |  processing\n      |     Flow         |\n      |   selection\
    \      |\n      |       |          |\n      +-------+          |\n           \
    \   |          |\n              v          |\n         Flow Record    /\n    \
    \       export\n       Figure C: Comparison of IPFIX Architecture and PSAMP Framework\n"
- title: 4.2.  Protocol Point of View
  contents:
  - "4.2.  Protocol Point of View\n   Concerning the protocol, the major difference\
    \ between IPFIX and PSAMP\n   is that the IPFIX protocol exports Flow Records\
    \ while the PSAMP\n   protocol exports Packet Reports.  From a pure export point\
    \ of view,\n   IPFIX will not distinguish a Flow Record composed of several packets\n\
    \   aggregated together from a Flow Record composed of a single packet.\n   So\
    \ the PSAMP export can be seen as a special IPFIX Flow Record\n   containing information\
    \ about a single packet.\n   All extensions of the IPFIX protocol that are required\
    \ to satisfy the\n   PSAMP requirements have already been incorporated in the\
    \ IPFIX\n   protocol [RFC5101], which was developed in parallel with the PSAMP\n\
    \   protocol.  An example is the need for a data type for protocol fields\n  \
    \ that have flexible length, such as an octet array.  This was added to\n   the\
    \ IPFIX protocol specification in order to meet the requirement of\n   the PSAMP\
    \ protocol to report content of captured packets, for\n   example, the first octets\
    \ of a packet.\n"
- title: 4.3.  Information Model Point of View
  contents:
  - "4.3.  Information Model Point of View\n   From the information model point of\
    \ view, the overlap between both\n   the IPFIX and PSAMP protocols is quite large.\
    \  Most of the\n   Information Elements in the IPFIX protocol are also relevant\
    \ for\n   exporting packet information, for example, all fields reporting\n  \
    \ packet header properties.  Only a few Information Elements, such as\n   observedFlowTotalCount\
    \ (whose value will always be 1 for PSAMP),\n   etc., cannot be used in a meaningful\
    \ way by the PSAMP protocol.\n   Also, IPFIX protocol requirements concerning\
    \ stage 2 of Figure C do\n   not apply to the PSAMP Metering Process.\n   Further\
    \ required extensions apply to the information model.  Even if\n   the IPFIX charter\
    \ speaks of Sampling, no Sampling-related Information\n   Elements are specified\
    \ in [RFC5102].  The task of specifying them was\n   intentionally left for the\
    \ PSAMP information model [RFC5477].  A set\n   of several additional fields is\
    \ required for satisfying the\n   requirements for the PSAMP information model\
    \ [RFC5475].\n   Exploiting the extensibility of the IPFIX information model,\
    \ the\n   required extension is covered by the PSAMP information model\n   specified\
    \ in [RFC5477].\n"
- title: 5.  PSAMP Requirements versus the IPFIX Solution
  contents:
  - "5.  PSAMP Requirements versus the IPFIX Solution\n   The [RFC5474] contains PSAMP\
    \ protocol requirements throughout the\n   document, with a special focus in Section\
    \ 4, \"Generic Requirements\n   for PSAMP\", and its subsections.\n   Section\
    \ 4 of [RFC5474] describes one requirement that, if not\n   directly related to\
    \ the export protocol, will put some constraints on\n   it.  Parallel Measurements:\
    \ multiple independent Selection Processes\n   at the same entity.\n   [RFC5474]\
    \ also describes a series of requirements specifying the\n   different Information\
    \ Elements that MUST and SHOULD be reported to\n   the Collector.  Nevertheless,\
    \ IPFIX, being a generic export protocol,\n   can export any Information Elements\
    \ as long as they are described in\n   the information model.  So these requirements\
    \ are mainly targeted for\n   [RFC5477].\n   The PSAMP protocol specification\
    \ meets almost all the protocol\n   requirements stated in the PSAMP framework\
    \ document [RFC5474]:\n      * Extensibility\n      * Parallel selection processes\n\
    \      * Encrypted packets\n      * Indication of information loss\n      * Accuracy\n\
    \      * Privacy\n      * Timeliness\n      * Congestion avoidance\n      * Secure\
    \ export\n      * Export rate limit\n      * Microsecond timestamp resolution\n\
    \   The only requirement that is not met is Export Packet compression.\n   With\
    \ the choice of IPFIX as the PSAMP export protocol, the Export\n   Packet compression\
    \ option mentioned in the Section 8.5 of the\n   framework document [RFC5474]\
    \ is not addressed.\n"
- title: 5.1.  High-Level View of the Integration
  contents:
  - "5.1.  High-Level View of the Integration\n   The Template Record in the Template\
    \ Set is used to describe the\n   different PSAMP Information Elements that will\
    \ be exported to the\n   Collector.  The Collector decodes the Template Record\
    \ in the Template\n   Set and knows which Information Elements to expect when\
    \ it receives\n   the Data Records in the PSAMP Packet Report Data Set.  Typically,\
    \ in\n   the base level of the PSAMP functionality, the Template Set will\n  \
    \ contain the input sequence number, the packet fragment (some number\n   of contiguous\
    \ bytes from the start of the packet or from the start of\n   the payload), and\
    \ the Selection Sequence.\n   The Options Template Record in the Options Template\
    \ Set is used to\n   describe the different PSAMP Information Elements that concern\
    \ the\n   Metering Process itself: Sampling and/or Filtering functions, and the\n\
    \   associated parameters.  The Collector decodes the Options Template\n   Records\
    \ in the Options Template Set and knows which Information\n   Elements to expect\
    \ when it receives the Data Records in the PSAMP\n   Report Interpretation Data\
    \ Set.  Typically, the Options Template\n   would contain the Selection Sequence,\
    \ the Sampling or Filtering\n   functions, and the Sampling or Filtering associated\
    \ parameters.\n   PSAMP requires all the different possibilities of the IPFIX\
    \ protocol\n   specifications [RFC5101], that is, the three types of Sets (Data\
    \ Set,\n   Template Set, and Options Templates Set) with the two types of\n  \
    \ Template Records (Template Record and Options Template Record), as\n   described\
    \ in Figure A.  As a consequence, PSAMP can't rely on a\n   subset of the IPFIX\
    \ protocol specifications described in [RFC5101].\n   The entire IPFIX protocol\
    \ specifications [RFC5101] MUST be\n   implemented for the PSAMP protocol.\n"
- title: 6.  Using the IPFIX Protocol for PSAMP
  contents:
  - "6.  Using the IPFIX Protocol for PSAMP\n   In this section, we describe the usage\
    \ of the IPFIX protocol for\n   PSAMP.  We describe the record formats and the\
    \ additional\n   requirements that must be met.  PSAMP uses two different types\
    \ of\n   messages:\n      - Packet Reports\n      - Report Interpretation\n  \
    \ The format of Packet Reports is defined in IPFIX Template Records.\n   The PSAMP\
    \ data is transferred as Information Elements in IPFIX Data\n   Records as described\
    \ by the Template Record.  There are two different\n   types of Packet Reports.\
    \  Basic Packet Reports contain only the basic\n   Information Elements required\
    \ for PSAMP reporting.  Extended Packet\n   Reports MAY contain other Information\
    \ Elements, and do not\n   necessarily include Packet Content (See section 6.4.2).\n\
    \   The format of Report Interpretations is defined in the IPFIX Options\n   Template\
    \ Record.  The Information Elements are transferred in IPFIX\n   Data Records\
    \ as described by the Options Template Record.  There are\n   four different types\
    \ of Report Interpretation messages:\n      - Selection Sequence Report Interpretation\n\
    \      - Selector Report Interpretation\n      - Selection Sequence Statistics\
    \ Report Interpretation\n      - Accuracy Report Interpretation\n   A description\
    \ and examples about the usage of those reports are given\n   below.\n"
- title: 6.1.  Selector ID
  contents:
  - "6.1.  Selector ID\n   The Selector ID is the unique ID identifying a Primitive\
    \ Selector.\n   Each Primitive Selector MUST have a unique ID within the Observation\n\
    \   Domain.  The Selector ID is represented by the selectorId Information\n  \
    \ Element [RFC5477].\n"
- title: 6.2.  The Selection Sequence ID
  contents:
  - "6.2.  The Selection Sequence ID\n   From all the packets observed at an Observation\
    \ Point, a subset of\n   packets is selected by one or more Selectors.  The Selection\
    \ Sequence\n   is the combination of an Observation Point and one or more\n  \
    \ Selector(s) through which the packets are selected.  The Selection\n   Sequence\
    \ ID is a unique value representing that combination.  The\n   Selection Sequence\
    \ ID is represented by the selectionSequenceId\n   Information Element [RFC5477].\n"
- title: 6.3.  The Exporting Process
  contents:
  - "6.3.  The Exporting Process\n   An Exporting Process MUST be able to limit the\
    \ export rate according\n   to a configurable value.  The Exporting Process MAY\
    \ limit the export\n   rate on a per Collecting Process basis.\n"
- title: 6.4.  Packet Report
  contents:
  - "6.4.  Packet Report\n   For each Selection Sequence, for each selected packet,\
    \ a Packet\n   Report MUST be created.  The format of the Packet Report is specified\n\
    \   in a Template Record contained in a Template Set.\n   There are two types\
    \ of Packet Report, as described in [RFC5474]: the\n   basic Packet Report and\
    \ the extended Packet Report.\n"
- title: 6.4.1.  Basic Packet Report
  contents:
  - "6.4.1.  Basic Packet Report\n   For each selected packet, the Packet Report MUST\
    \ contain the\n   following information:\n   - The selectionSequenceId Information\
    \ Element\n     If there is a digest function in the Selection Sequence, the Packet\n\
    \     Report MUST contain the hash value (digestHashValue Information\n     Element)\
    \ generated by the digest Hash Function for each selected\n     packet.  If there\
    \ is more than one digest function, then each hash\n     value MUST be included\
    \ in the same order as they appear in the\n     Selection Sequence.  If there\
    \ are no digest functions in the\n     Selection Sequence, no element for the\
    \ digest needs to be sent.\n   - Some number of contiguous bytes from the start\
    \ of the packet,\n     including the packet header (which includes link layer,\
    \ network\n     layer, and other encapsulation headers) and some subsequent bytes\n\
    \     of the packet payload.  Alternatively, the number of contiguous\n     bytes\
    \ may start at the beginning of the payload.  The\n     dataLinkFrameSection,\
    \ mplsLabelStackSection,\n     mplsPayloadPacketSection, ipPacketSection, and\n\
    \     ipPayloadPacketSection PSAMP Information Elements are available for\n  \
    \   this use.\n   For each selected packet, the Packet Report SHOULD contain a\
    \ time-\n   related Information Element that matches the Metering Process time\n\
    \   accuracy.  Typically, the observationTimeMicroseconds Information\n   Element.\
    \  Other possible Information Elements are the\n   observationTimeSeconds, the\
    \ observationTimeMilliseconds, or the\n   observationTimeNanoseconds.\n   In the\
    \ Packet Report, the PSAMP Device MUST be capable of exporting\n   the number\
    \ of observed packets and the number of packets selected by\n   each instance\
    \ of its Primitive Selectors (as described by the\n   non-scope Information Elements\
    \ of the Selection Sequence Statistics\n   Report Interpretation), although it\
    \ MAY be a configurable option not\n   to include them.  If exported, the Attained\
    \ Selection Fraction may be\n   calculated precisely for the Observed Packet Stream.\
    \  The Packet\n   Report MAY include only the final selector packetSelected, to\
    \ act as\n   an index for that Selection Sequence in the Selection Sequence\n\
    \   Statistics Report Interpretation, which also allows the calculation\n   of\
    \ the Attained Selection Fraction.\n   The contiguous Information Elements (dataLinkFrameSection,\n\
    \   mplsLabelStackSection, mplsPayloadPacketSection, ipPacketSection, and\n  \
    \ ipPayloadPacketSection) MAY be encoded with a fixed-length field or\n   with\
    \ a variable-sized field.  If one of these Information Elements is\n   encoded\
    \ with a fixed-length field whose length is too long for the\n   number of contiguous\
    \ bytes in the selected packet, padding MUST NOT\n   be used.  In this case, the\
    \ Exporting Process MUST export the\n   information either in a new Template Record\
    \ with the correct fixed-\n   length field or in a new Template Record with a\
    \ variable-length\n   field.\n   Here is an example of a basic Packet Report,\
    \ with a\n   SelectionSequenceId value of 9 and dataLinkFrameSection Information\n\
    \   Element of 12 bytes, 0x4500 005B A174 0000 FF11 832E, encoded with a\n   fixed-length\
    \ field.\n   IPFIX Template Record:\n       0                   1            \
    \       2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 2          |         Length = 24           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Template ID = 260      |        Field Count = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |   selectionSequenceId = 301   |        Field Length = 4       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      digestHashValue = 326    |        Field Length = 4       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |   dataLinkFrameSection = 315  |        Field Length = 12      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |observationTimeMicroseconds=324|\
    \        Field Length = 4       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The associated IPFIX Data Record:\n       0                   1          \
    \         2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 260        |           Length = 32         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               9                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                         0x9123 0613                           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         0x4500 005B                           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                         0xA174 0000                           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         0xFF11 832E                           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                       observation time ...                    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        ... encoded as dateTimeMicroSeconds [RFC5101]          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure D: Example of a Basic Packet Report\n   Here is an example\
    \ of a basic Packet Report, with a\n   SelectionSequenceId value of 9 and ipHeaderPacketSection\
    \ Information\n   Element of 12 bytes, 0x4500 005B A174 0000 FF11 832E, encoded\
    \ with a\n   variable-sized field.\n   IPFIX Template Record:\n       0      \
    \             1                   2                   3\n       0 1 2 3 4 5 6\
    \ 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 2          |         Length = 16           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Template ID = 261      |        Field Count = 2        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |    selectionSequenceId = 301  |        Field Length = 4       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \  ipHeaderPacketSection = 313  |      Field Length = 65535     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The associated IPFIX Data Record:\n       0                   1          \
    \         2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 261        |           Length = 21         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               9                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |  Length = 12  |                  0x4500 ...                   |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \   ...  005B   |                  0xA174 ...                   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |   ...  0000   |                  0xFF11 ...                   |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \   ...  832E   |\n      +-+-+-+-+-+-+-+-+\n                  Figure E: Example\
    \ of a Basic Packet Report\n                         with a Variable-Sized Field\n"
- title: 6.4.2.  Extended Packet Report
  contents:
  - "6.4.2.  Extended Packet Report\n   Alternatively to the basic Packet Report,\
    \ the extended Packet Report\n   MAY contain other Information Elements related\
    \ to the protocols used\n   in the packet (such as source and destination IP addresses),\
    \ related\n   to the packet treatment (such as output interface, destination BGP\n\
    \   autonomous system [RFC4271]), or related to the Selection State\n   associated\
    \ with the packet (such as timestamp, hash value).\n   It is envisaged that selection\
    \ of fields for extended Packet Reports\n   may be used to reduce reporting bandwidth,\
    \ in which case the option\n   to report some number of contiguous bytes from\
    \ the start of the\n   packet, mandatory in the basic Packet Report, may not be\
    \ exercised.\n   In this case, the Packet Content MAY be omitted.  Note this\n\
    \   configuration is quite similar to an IPFIX Device for which a\n   Template\
    \ Record containing information about a single packet is\n   reported.\n   Example\
    \ of a detailed Extended Packet Report:\n   IPFIX Template Record:\n      0  \
    \                 1                   2                   3\n      0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Set ID =  2        |           Length = 32         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Template ID = 261       |         Field Count = 6       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |0|  selectionSequenceId = 301  |         Field Length = 4      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |0|\
    \  sourceIPv4Address = 8      |         Field Length = 4      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |0| destinationIPv4Address = 12 |         Field Length = 4      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |0|\
    \    totalLengthIPv4 = 190    |         Field Length = 2      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |0|     tcpSourcePort = 182     |         Field Length = 2      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |0|\
    \  tcpDestinationPort = 183   |         Field Length = 2      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The associated IPFIX Data Record:\n       0                   1          \
    \         2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 261        |            Length = 20        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               9                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                           192.0.2.1                           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                          192.0.2.106                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                72             |                1372           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \               80              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \              Figure F: Example of an Extended Packet Report\n"
- title: 6.5.  Report Interpretation
  contents:
  - "6.5.  Report Interpretation\n   To make full sense of the Packet Reports, there\
    \ are a number of\n   additional pieces of information that must be communicated\
    \ to the\n   Collector:\n   - The details about which Selectors and Observation\
    \ Points are being\n     used within a Selection Sequence MUST be provided using\
    \ the\n     Selection Sequence Report Interpretation.\n   - The configuration\
    \ details of each Selector MUST be provided using\n     the Selector Report Interpretation.\n\
    \   - The Selector ID statistics MUST be provided using the Selection\n     Sequence\
    \ Statistics Report Interpretation.\n   - The accuracies of the reported fields\
    \ MUST be provided using the\n     Accuracy Report Interpretation.\n"
- title: 6.5.1.  Selection Sequence Report Interpretation
  contents:
  - "6.5.1.  Selection Sequence Report Interpretation\n   Each Packet Report contains\
    \ a selectionSequenceId Information Element\n   that identifies the particular\
    \ combination of Observation Point and\n   Selector(s) used for its selection.\
    \  For every selectionSequenceId\n   Information Element in use, the PSAMP Device\
    \ MUST export a Selection\n   Sequence Report Interpretation using an Options\
    \ Template with the\n   following Information Elements:\n   Scope:     selectionSequenceId\n\
    \   Non-Scope: one Information Element mapping the Observation Point\n       \
    \       selectorId (one or more)\n   An Information Element representing the Observation\
    \ Point would\n   typically be taken from the ingressInterface, egressInterface,\n\
    \   lineCardId, exporterIPv4Address, or exporterIPv6Address Information\n   Elements\
    \ (specified in [RFC5102]), but is not limited to those: any\n   Information Element\
    \ specified in [RFC5102] or [RFC5477] can\n   potentially be used.  In case of\
    \ more complex Observation Points\n   (such as a list of interfaces, a bus, etc.),\
    \ a new Information\n   Element describing the new type of Observation Point must\
    \ be\n   specified, along with an Options Template Record describing it in\n \
    \  more detail (if necessary).\n   If the packets are selected by a Composite\
    \ Selector, the Selection\n   Sequence is composed of several Primitive Selectors.\
    \  In such a case,\n   the Selection Sequence Report Interpretation MUST contain\
    \ the list of\n   all the Primitive Selector IDs in the Selection Sequence.  If\n\
    \   multiple Selectors are contained in the Selection Sequence Report\n   Interpretation,\
    \ the selectorId's MUST be identified in the order they\n   are used.\n   Example\
    \ of two Selection Sequences:\n   Selection Sequence 7 (Filter->Sampling):\n \
    \    ingressInterface    5\n     selectorId          5 (Filter, match IPV4SourceAddress\
    \ 192.0.2.1)\n     selectorId         10 (Sampler, Random 1 out-of ten)\n   Selection\
    \ Sequence 9 (Sampling->Filtering):\n     ingressInterface    5\n     selectorId\
    \         10 (Sampler, Random 1 out-of ten)\n     selectorId          5 (Filter,\
    \ match IPV4SourceAddress 192.0.2.1)\n   IPFIX Options Template Record:\n    \
    \   0                   1                   2                   3\n       0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |          Set ID = 3           |          Length = 26          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Template ID = 262      |         Field Count = 4       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Scope Field Count =  1    |0|  selectionSequenceId = 301  |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Scope 1 Length = 4      |0|     ingressInterface = 10   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |        Field Length = 4       |0|      selectorId = 302       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Field Length = 4       |0|      selectorId = 302       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |        Field Length = 4       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The associated IPFIX Data Record:\n       0                   1          \
    \         2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |          Set ID = 262         |           Length = 36         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               7                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                               5                               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               5                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                              10                               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               9                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                               5                               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              10                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                               5                               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      \
    \ Figure G: Example of a Selection Sequence Report Interpretation\n   Notes:\n\
    \   * There are two Records here in the same Data Set.  Each record\n     defines\
    \ a different Selection Sequence.\n   * If, for example, a different Selection\
    \ Sequence is composed of\n     three Selectors, then a different Options Template\
    \ with three\n     selectorId Information Elements (instead of two) must be used.\n"
- title: 6.5.2.  Selector Report Interpretation
  contents:
  - "6.5.2.  Selector Report Interpretation\n   An IPFIX Data Record, defined by an\
    \ Options Template Record, MUST be\n   used to send the configuration details\
    \ of every Selector in use.  The\n   Options Template Record MUST contain the\
    \ selectorId Information\n   Element as the Scope field and the SelectorAlgorithm\
    \ Information\n   Element followed by some specific configuration parameters:\n\
    \   Scope:     selectorId\n   Non-scope: selectorAlgorithm\n              algorithm-specific\
    \ Information Elements\n   The algorithm-specific Information Elements are specified\
    \ in the\n   following subsections, depending on the selection method represented\n\
    \   by the value of the selectorAlgorithm [RFC5477].\n"
- title: 6.5.2.1.  Systematic Count-Based Sampling
  contents:
  - "6.5.2.1.  Systematic Count-Based Sampling\n   In systematic count-based Sampling,\
    \ the start and stop triggers for\n   the Sampling interval are defined in accordance\
    \ with the spatial\n   packet position (packet count) [RFC5475].\n   The REQUIRED\
    \ algorithm-specific Information Elements in the case of\n   systematic count-based\
    \ Sampling are:\n      samplingPacketInterval: number of packets selected in a\
    \ row\n      samplingPacketSpace:    number of packets between selections\n  \
    \ Example of a simple 1 out-of 10 systematic count-based Selector\n   definition,\
    \ where the samplingPacketInterval is 1 and the\n   samplingPacketSpace is 9.\n\
    \   IPFIX Options Template Record:\n      0                   1              \
    \     2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |          Set ID = 3           |          Length = 26          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Template ID =  263     |         Field Count = 4       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |    Scope Field Count =  1     |0|       selectorId = 302      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Scope 1 Length = 4       |0|   selectorAlgorithm = 304   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 1        |0|samplingPacketInterval = 305 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 1        |0|  samplingPacketSpace = 306  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 1        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Associated IPFIX Data Record:\n       0                   1              \
    \     2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Set ID = 263       |          Length = 11          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              15                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       1       |      1        |      9        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \           Figure H: Example of the Selector Report Interpretation\n        \
    \             for Systematic Count-Based Sampling\n   Notes:\n   * A selectorAlgorithm\
    \ value of 1 represents systematic count-based\n     Sampling.\n   * samplingPacketInterval\
    \ and samplingPacketSpace are of type\n     unsigned32 but are compressed down\
    \ to one octet here, as allowed by\n     the IPFIX protocol specifications [RFC5101].\n"
- title: 6.5.2.2.  Systematic Time-Based Sampling
  contents:
  - "6.5.2.2.  Systematic Time-Based Sampling\n   In systematic time-based Sampling,\
    \ the start and stop triggers are\n   used to define the Sampling intervals [RFC5475].\
    \  The REQUIRED\n   algorithm-specific Information Elements in the case of systematic\n\
    \   time-based Sampling are:\n      samplingTimeInterval: time (in microseconds)\
    \ when packets are\n                            selected\n      samplingTimeSpace:\
    \    time (in microseconds) between selections\n   Example of a 100 microsecond\
    \ out-of 1000 microsecond systematic\n   time-based Selector definition, where\
    \ the samplingTimeInterval is 100\n   and the samplingTimeSpace is 900.\n   IPFIX\
    \ Options Template Record:\n       0                   1                   2 \
    \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 3          |          Length = 26          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Template ID = 264        |        Field Count = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |    Scope Field Count = 1      |0|      selectorId = 302       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Scope 1 Length = 4        |0|     selectorAlgorithm = 304 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Field Length = 1         |0|  samplingTimeInterval = 307 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Field Length = 1         |0|   samplingTimeSpace = 308   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Field Length = 2         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Associated IPFIX Data Record:\n       0                   1              \
    \     2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 264        |          Length = 12          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              16                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |        2      |       100     |             900               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      \
    \     Figure I: Example of the Selector Report Interpretation\n              \
    \       for Systematic Time-Based Sampling\n   Notes:\n   * A selectorAlgorithm\
    \ value of 2 represents systematic time-based\n     Sampling.\n   * samplingTimeInterval\
    \ and samplingTimeSpace are of type unsigned32\n     but are compressed down here.\n"
- title: 6.5.2.3.  Random n-out-of-N Sampling
  contents:
  - "6.5.2.3.  Random n-out-of-N Sampling\n   In random n-out-of-N Sampling, n elements\
    \ are selected out of the\n   parent Population that consists of N elements [RFC5475].\
    \  The\n   REQUIRED algorithm-specific Information Elements in case of random\n\
    \   n-out-of-N Sampling are:\n      samplingSize:       number of packets selected\n\
    \      samplingPopulation: number of packets in selection Population\n   Example\
    \ of a 1 out-of 10 random n-out-of-N Sampling Selector:\n   IPFIX Options Template\
    \ Record:\n       0                   1                   2                  \
    \ 3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |           Set ID = 3          |          Length = 26          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Template ID = 265        |        Field Count = 4        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Scope Field Count = 1     |0|      selectorId = 302       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Scope 1 Length = 4        |0|  selectorAlgorithm = 304    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Field Length = 1         |0|      samplingSize = 309     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Field Length = 1         |0|  samplingPopulation = 310   |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Field Length = 1         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  Associated IPFIX Data Record:\n       0                   1               \
    \    2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |         Set ID = 265          |          Length = 11          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              17                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       3       |       1       |        10     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \           Figure J: Example of the Selector Report Interpretation\n        \
    \               for Random n-out-of-N Sampling\n   Notes:\n   * A selectorAlgorithm\
    \ value of 3 represents Random n-out-of-N\n     Sampling.\n   * samplingSize and\
    \ samplingPopulation are of type unsigned32 but are\n     compressed down to one\
    \ octet here.\n"
- title: 6.5.2.4.  Uniform Probabilistic Sampling
  contents:
  - "6.5.2.4.  Uniform Probabilistic Sampling\n   In uniform probabilistic Sampling,\
    \ each element has the same\n   probability p of being selected from the parent\
    \ Population [RFC5475].\n   The algorithm-specific Information Element in case\
    \ of uniform\n   probabilistic Sampling is:\n      samplingProbability: a floating\
    \ point number for the Sampling\n                           probability.\n   Example\
    \ of a 15% uniform probability Sampling Selector:\n   IPFIX Options Template Record:\n\
    \      0                   1                   2                   3\n      0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |          Set ID = 3           |             Length = 22       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Template ID = 271       |         Field Count = 3       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Scope Field Count = 1     |0|      selectorId = 302       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Field Length = 4         |0|   selectorAlgorithm = 304   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Field Length = 1         |0| samplingProbability = 311   |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Field Length = 4         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  Associated IPFIX Data Record:\n      0                   1                \
    \   2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 271        |          Length = 11          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              20                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      4        |                          0.15                 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \               |\n      +-+-+-+-+-+-+-+-+\n           Figure K: Example of the\
    \ Selector Report Interpretation\n                     for Uniform Probabilistic\
    \ Sampling\n   Notes:\n   * A selectorAlgorithm value of 4 represents Uniform\
    \ Probabilistic\n     Sampling.\n   * samplingProbability is of type float64 but\
    \ is compressed down to a\n     float32 here.\n"
- title: 6.5.2.5.  Property Match Filtering
  contents:
  - "6.5.2.5.  Property Match Filtering\n   This classification includes match(es)\
    \ on field(s) within a packet\n   and/or on properties of the router state.  With\
    \ this method, a packet\n   is selected if a specific field in the packet equals\
    \ a predefined\n   value.\n   The algorithm-specific Information Elements defining\
    \ configuration\n   parameters for Property Match Filtering are taken from the\
    \ full range\n   of available Information Elements.\n   When multiple different\
    \ Information Elements are defined, the filter\n   acts as a logical AND.  Note\
    \ that the logical OR is not covered by\n   these PSAMP specifications.  The Property\
    \ Match Filtering Options\n   Template Record MUST NOT have multiple identical\
    \ Information\n   Elements.  The result of the filter is independent from the\
    \ order of\n   the Information Elements in the Options Template Record, but the\n\
    \   order may be important for implementation purposes, as the first\n   filter\
    \ will have to work at a higher rate.  In any case, an\n   implementation is not\
    \ constrained to respect the filter ordering as\n   long as the result is the\
    \ same, and it may even implement the\n   composite Filtering in one single step.\n\
    \   Since encryption alters the meaning of encrypted fields, when the\n   Property\
    \ Match Filtering classification is based on the encrypted\n   field(s) in the\
    \ packet, it MUST be able to recognize that the\n   field(s) are not available\
    \ and MUST NOT select those packets unless\n   specifically directed by the Information\
    \ Element description.  Even\n   if they are ignored, the encrypted packets MUST\
    \ be accounted for in\n   the Selector packetsObserved Information Element [RFC5477],\
    \ part of\n   the Selection Sequence Statistics Report Interpretation.\n   Example\
    \ of a match-based filter Selector, whose rules are:\n      IPv4 Source Address\
    \   = 192.0.2.1\n      IPv4 Next-Hop Address = 192.0.2.129\n   IPFIX Options Template\
    \ Record:\n       0                   1                   2                  \
    \ 3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |             Set ID =  3       |          Length = 26          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |        Template ID = 266      |       Field Count = 4         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Scope Field Count = 1     |0|     selectorId = 302        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Scope 1 Length = 4       |0|   selectorAlgorithm = 304   |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 1        |0|    sourceIPv4Address = 8    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |0|   ipNextHopIPv4Address = 15 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  Associated IPFIX Data Record:\n       0                   1               \
    \    2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 266        |        Length = 11            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              21                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       5       |                        192.0.2 ...            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \ ... .1        |                        192.0.2 ...            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      | ... .129      |\n      +-+-+-+-+-+-+-+-+\n           Figure L: Example\
    \ of the Selector Report Interpretation\n                 for Match-Based and\
    \ Router State Filtering\n   Notes:\n   * A selectorAlgorithm value of 5 represents\
    \ Property Match Filtering.\n   * In this filter, there is a mix of information\
    \ from the packet and\n     information from the router.\n"
- title: 6.5.2.6.  Hash-Based Filtering
  contents:
  - "6.5.2.6.  Hash-Based Filtering\n   In Hash-based Selection, a Hash Function is\
    \ run on IPv4 traffic.  The\n   following fields MUST be used as input to that\
    \ Hash Function:\n      - IP identification field\n      - Flags field\n     \
    \ - Fragment offset\n      - Source IP address\n      - Destination IP address\n\
    \      - A number of bytes from the IP payload.  The number of bytes and\n   \
    \     starting offset MUST be configurable if the Hash Function\n        supports\
    \ it.\n   For the bytes taken from the IP payload, IPSX has a fixed offset of\
    \ 0\n   bytes and a fixed size of 8 bytes.  The number and offset of payload\n\
    \   bytes in the BOB function MUST be configurable.\n   The minimum configuration\
    \ ranges MUST be as follows:\n      Number of bytes:  from 8 to 32\n      Offset:\
    \           from 0 to 64\n   If the selected payload bytes are not available and\
    \ the Hash Function\n   can take a variable-sized input, then the Hash Function\
    \ MUST be run\n   with the information that is available and a shorter size. \
    \ Passing 0\n   as a substitute for missing payload bytes is only acceptable if\
    \ the\n   Hash Function takes a fixed size as is the case with IPSX.\n   If the\
    \ Hash Function can take an initialization value, then this\n   value MUST be\
    \ configurable.\n   A Hash-based Selection function MAY be configurable as a digest\n\
    \   function.  Any Selection Process that is configured as a digest\n   function\
    \ MUST have the output value included in the basic Packet\n   Report for any selected\
    \ packet.\n   Each Hash Function used as a Hash-based Selection Selector requires\n\
    \   its own value for the selectorAlgorithm.  Currently, we have BOB (6),\n  \
    \ IPSX (7), and CRC (8) defined and any MAY be used for either\n   Filtering or\
    \ creating a Packet Digest.  Only BOB is recommended\n   though and SHOULD be\
    \ used.\n   The REQUIRED algorithm-specific Information Elements in case of\n\
    \   Hash-based Selection are:\n   hashIPPayloadOffset   - The payload offset used\
    \ by a Hash-based\n                           Selection Selector\n   hashIPPayloadSize\
    \     - The payload size used by a Hash-based\n                           Selection\
    \ Selector\n   hashOutputRangeMin    - One or more values for the beginning of\
    \ each\n                           potential output range.\n   hashOutputRangeMax\
    \    - One or more values for the end of each\n                           potential\
    \ output range.\n   hashSelectedRangeMin  - One or more values for the beginning\
    \ of each\n                           selected range.\n   hashSelectedRangeMax\
    \  - One or more values for the end of each\n                           selected\
    \ range.\n   hashDigestOutput      - A boolean value, TRUE if the output from\
    \ this\n                           Selector has been configured to be included\n\
    \                           in the Packet Report as a packet digest.\n   Note:\
    \ If more than one selection or output range needs to be sent,\n   then the minimum\
    \ and maximum elements may be repeated as needed.\n   These MUST make one or more\
    \ non-overlapping ranges.  The elements\n   SHOULD be sent as pairs of minimum\
    \ and maximum in ascending order;\n   however, if they are sent out of order,\
    \ then there will only be one\n   way to interpret the ranges to produce a non-overlapping\
    \ range and\n   the Collecting Process MUST be prepared to accept and decode this.\n\
    \   The following algorithm-specific Information Element MAY be sent, but\n  \
    \ is optional for security considerations:\n   hashInitialiserValue  - The initialiser\
    \ value to the Hash Function.\n   Since encryption alters the meaning of encrypted\
    \ fields, when the\n   Hash-based Filtering classification is based on the encrypted\n\
    \   field(s) in the packet, it MUST be able to recognize that the\n   field(s)\
    \ are not available and MUST NOT select those packets.  Even\n   if they are ignored,\
    \ the encrypted packets MUST be accounted for in\n   the Selector packetsObserved\
    \ Information Element [RFC5477], which is\n   part of the Selection Sequence Statistics\
    \ Report Interpretation.\n   Example of a Hash-based Filter Selector, whose configuration\
    \ is:\n      Hash Function           = BOB\n      Hash IP Payload Offset  = 0\n\
    \      Hash IP Payload Size    = 16\n      Hash Initialiser Value  = 0x9A3F9A3F\n\
    \      Hash Output Range       = 0 to 0xFFFFFFFF\n      Hash Selected Range  \
    \   = 100 to 200 and 400 to 500\n   IPFIX Options Template Record:\n      0  \
    \                 1                   2                   3\n      0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |             Set ID =  3       |          Length = 50          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Template ID = 269      |       Field Count = 8         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Scope Field Count = 1     |0|     selectorId = 302        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Scope 1 Length = 4       |0|   selectorAlgorithm = 302   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 1        |0|  hashIPpayloadOffset = 327  |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |0|   hashIPpayloadSize = 328   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |0|  hashInitialiserValue = 329 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |0|   hashOutputRangeMin = 330  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |0|   hashOutputRangeMax = 331  |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |0|  hashSeletionRangeMin = 332 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |0|  hashSeletionRangeMax = 333 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |0|  hashSeletionRangeMin = 332 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |0|  hashSeletionRangeMax = 333 |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  Associated IPFIX Data Record:\n      0                   1                \
    \   2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID = 266        |        Length = 45            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              22                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       6       |                            ...                |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \ ...   0       |                            ...                |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      | ...  16       |                      0x9A3F9A ...             |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \ ...  3F       |                            ...                |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      | ...   0       |                      0xFFFFFF ...             |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \ ...  FF       |                        ... 100                |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      ...      |                        ... 200                |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      ...      |                        ... 400                |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      ...      |                        ... 500                |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      ...      |\n      +-+-+-+-+-+-+-+-+\n           Figure M: Example of the\
    \ Selector Report Interpretation\n                          for Hash-based Filtering\n\
    \   Notes:\n   * A selectorAlgorithm value of 6 represents Hash-based Filtering\n\
    \     using the BOB algorithm.\n"
- title: 6.5.2.7.  Other Selection Methods
  contents:
  - "6.5.2.7.  Other Selection Methods\n   Some potential new selection methods MAY\
    \ be added.  Some of the new\n   selection methods, such as non-uniform probabilistic\
    \ Sampling and\n   flow-state-dependent Sampling, are described in [RFC5475],\
    \ with\n   further references.\n   Each new selection method MUST be assigned\
    \ a unique value for the\n   selectorAlgorithm Information Element.  Its configuration\n\
    \   parameter(s), along with the way to report it/them with an Options\n   Template,\
    \ MUST be clearly specified.\n"
- title: 6.5.3.  Selection Sequence Statistics Report Interpretation
  contents:
  - "6.5.3.  Selection Sequence Statistics Report Interpretation\n   A Selector MAY\
    \ be used in multiple Selection Sequences.  However,\n   each use of a Selector\
    \ must be independent, so each separate logical\n   instance of a Selector MUST\
    \ maintain its own individual Selection\n   State and statistics.\n   The Selection\
    \ Sequence Statistics Report Interpretation MUST include\n   the number of observed\
    \ packets (Population Size) and the number of\n   packets selected (Sample Size)\
    \ by each instance of its Primitive\n   Selectors.\n   Within a Selection Sequence\
    \ composed of several Primitive Selectors,\n   the number of packets selected\
    \ for one Selector is equal to the\n   number of packets seen by the next Selector.\
    \  The order of the\n   Selectors in the Selection Sequence Statistics Report\
    \ Interpretation\n   MUST match the order of the Selectors in the Selection Sequence.\n\
    \   If the full set of statistics is not sent as part of the Basic Packet\n  \
    \ Reports, the PSAMP Device MUST export a Selection Sequence Statistics\n   Report\
    \ Interpretation for every Selection Sequence, using an Options\n   Template containing\
    \ the following Information Elements:\n      Scope:         selectionSequenceId\n\
    \      Non-scope:     packetsObserved\n                     packetsSelected (first\
    \ Selector)\n                     ...\n                     packetsSelected (last\
    \ Selector)\n   The packetsObserved Information Element [RFC5477] MUST contain\
    \ the\n   number of packets seen at the Observation Point, and as a consequence\n\
    \   passed to the first Selector in the Selection Sequence.  The\n   packetsSelected\
    \ Information Element [RFC5477] contains the number of\n   packets selected by\
    \ a Selector in the Selection Sequence.\n   The Attained Selection Fraction for\
    \ the Selection Sequence is\n   calculated by dividing the number of selected\
    \ packets\n   (packetsSelected Information Element) for the last Selector by the\n\
    \   number of observed packets (packetsObserved Information Element).\n   The\
    \ Attained Selection Fraction can be calculated for each Selector\n   by dividing\
    \ the number of packets selected for that Selector by the\n   value for the previous\
    \ Selector.\n   The statistics for the whole sequence SHOULD be taken at a single\n\
    \   logical point in time; the input value for a Selector MUST equal the\n   output\
    \ value of the previous Selector.\n   The Selection Sequence Statistics Report\
    \ Interpretation MUST be\n   exported periodically.\n   Example of Selection Sequence\
    \ Statistics Report Interpretation:\n   Selection Sequence 7 (Filter->Sampling):\n\
    \      Observed   100  (observationPointId  1, Interface 5)\n      Selected  \
    \  50  (selectorId  5, match IPV4SourceAddress 192.0.2.1)\n      Selected    \
    \ 6  (selectorId 10, Sampler: Random one out-of ten)\n   Selection Sequence 9\
    \ (Sampling->Filtering):\n      Observed   100  (observationPointId  1, Interface\
    \ 5)\n      Selected    10  (selectorId 10, Sampler: Random one out-of ten)\n\
    \      Selected     3  (selectorId  5, match IPV4SourceAddress 192.0.2.1)\n  \
    \ IPFIX Options Template Record:\n       0                   1               \
    \    2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Set ID = 3         |           Length = 26         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Template ID = 267       |        Field Count = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Scope Field Count = 1     |0|  selectionSequenceId = 301  |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Scope 1 Length = 4       |0|    packetsObserved = 318    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |0|    packetsSelected = 319    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |0|    packetsSelected = 319    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Field Length = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The associated IPFIX Data Record:\n       0                   1          \
    \         2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID =  267       |          Length = 36          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               7                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                              100                              |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              50                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                               6                               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                               9                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                              100                              |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                              10                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                               3                               |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      \
    \     Figure N: Example of the Selection Sequence Statistics\n               \
    \             Report Interpretation\n   Notes:\n   * The Attained Selection Fractions\
    \ for Selection Sequence 7 are:\n            Filter 10: 50/100\n            Sampler\
    \ 5: 6/50\n            Number of samples selected: 6\n   * The Attained Selection\
    \ Fractions for Selection Sequence 9 are:\n            Sampler 5: 10/100\n   \
    \         Filter 10: 3/10\n            Number of samples selected: 3\n"
- title: 6.5.4.  Accuracy Report Interpretation
  contents:
  - "6.5.4.  Accuracy Report Interpretation\n   In order for the Collecting Process\
    \ to determine the inherent\n   accuracy of the reported quantities (for example,\
    \ timestamps), the\n   PSAMP Device SHOULD send an Accuracy Report Interpretation.\n\
    \   The Accuracy Report Interpretation MUST be exported by an Options\n   Template\
    \ Record with a scope that contains the Information Element\n   for which the\
    \ accuracy is required.  In case the accuracy is specific\n   to a template, a\
    \ second scope containing the templateId value MUST be\n   added to the Options\
    \ Template Record.  The accuracy SHOULD be\n   reported either with the absoluteError\
    \ Information Element [RFC5477]\n   or with the relativeError Information Element\
    \ [RFC5477].\n   Accuracy Report Interpretation using the absoluteError Information\n\
    \   Element:\n    Scope:     informationElementId\n    Non-scope: absoluteError\n\
    \   Accuracy Report Interpretation using the absoluteError Information\n   Element\
    \ and a double scope:\n    Scope:     templateId\n               informationElementId\n\
    \    Non-scope: absoluteError\n   Accuracy Report Interpretation using the relativeError\
    \ Information\n   Element:\n    Scope:     informationElementId\n    Non-scope:\
    \ relativeError\n   Accuracy Report Interpretation using the relativeError Information\n\
    \   Element and a double scope:\n    Scope:     templateId\n               informationElementId\n\
    \    Non-scope: relativeError\n   For example, the accuracy of an Information\
    \ Element whose Abstract\n   Data Type is dateTimeMilliseconds [RFC5102], for\
    \ which the unit is\n   specified as milliseconds, can be specified with the absoluteError\n\
    \   Information Element with the milliseconds units.  In this case, the\n   error\
    \ interval is the Information Element value +/- the value\n   reported in the\
    \ absoluteError.\n   For example, the accuracy of an Information Element to estimate\
    \ the\n   accuracy of a sampled flow, for which the unit would be specified in\n\
    \   octets, can be specified with the relativeError Information Element\n   with\
    \ the octet units.  In this case, the error interval is the\n   Information Element\
    \ value +/- the value reported in the relativeError\n   times the reported Information\
    \ Element value.\n   An alternative to reporting either the absoluteError Information\n\
    \   Element or the relativeError Information Element in the Accuracy\n   Report\
    \ Interpretation, is to report both.  For this case whatever is\n   least accurate\
    \ for the reported value should be used.\n   If the accuracy of a reported quantity\
    \ changes on the Metering\n   Process, a new Accuracy Report Interpretation MUST\
    \ be generated.  The\n   Collecting Process MUST keep the accuracy of the latest\
    \ Accuracy\n   Report Interpretation.\n   Example of an Accuracy Report Interpretation\
    \ using the absoluteError\n   Information Element and a double scope: the timeMicroseconds\n\
    \   contained in the Template 5 has an accuracy of +/- 2 ms, represented\n   by\
    \ the absoluteError Information Element.\n   Scope:     templateId = 6\n     \
    \         informationElementId = timeMicroseconds\n   Non-scope: absoluteError\
    \ = 2 ms\n   IPFIX Options Template Record:\n       0                   1    \
    \               2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Set ID = 3         |           Length = 22         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Template ID = 267       |        Field Count = 3        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Scope Field Count = 2     |0|       templateId = 145      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Scope 1 Length = 2       |0| InformationElementId = 303  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Scope 2 Length = 2       |0|      absoluteError = 320    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  The associated IPFIX Data Record:\n       0                   1           \
    \        2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID =  267       |          Length = 12          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \              5                |             324               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                    2  (encoded as a float32)                  |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      \
    \           Figure O: Example of the Selection Sequence\n                    \
    \  Statistics Report Interpretation\n   Notes:\n   * absoluteError is of type\
    \ float64 but is compressed down to a\n     float32 here.\n   The second example\
    \ displays an Accuracy Report Interpretation using\n   the relativeError Information\
    \ Element and a single scope: the\n   timeMicroseconds has an error of 5%, represented\
    \ by the\n   proportionalAccuracy Information Element.\n   Scope:     informationElementId\
    \ = timeMicroseconds\n   Non-scope: relativeError = 0.05\n   IPFIX Options Template\
    \ Record:\n       0                   1                   2                  \
    \ 3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |            Set ID = 3         |           Length = 18         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Template ID = 268       |        Field Count = 2        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Scope Field Count = 1     |0| InformationElementId = 303  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      Scope 1 Length = 2       |0|      relativeError= 321     |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Field Length = 4        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  The associated IPFIX Data Record:\n       0                   1           \
    \        2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |           Set ID =  267       |          Length = 10          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \             324               |                     0.05 ...  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      | ...(encoded as a float32)     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure P: Example of the Selection Sequence\n              \
    \        Statistics Report Interpretation\n   Notes:\n   * relativeError is of\
    \ type float64 but is compressed down to a\n     float32 here.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   As IPFIX has been selected as the PSAMP export\
    \ protocol and as the\n   PSAMP security requirements are not stricter than the\
    \ IPFIX security\n   requirements, refer to the IPFIX export protocol [RFC5101]\
    \ for the\n   security considerations.\n   In the basic Packet Report, a PSAMP\
    \ Device exports some number of\n   contiguous bytes from the start of the packet,\
    \ including the packet\n   header (which includes link layer, network layer, and\
    \ other\n   encapsulation headers) and some subsequent bytes of the packet\n \
    \  payload.  The PSAMP Device SHOULD NOT export the full payload of\n   conversations,\
    \ as this would mean wiretapping [RFC2804].  The PSAMP\n   Device MUST respect\
    \ local privacy laws.\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   The PSAMP protocol, as set out in this document,\
    \ has two sets of\n   assigned numbers.  Considerations for assigning them are\
    \ discussed in\n   this section, using the example policies as set out in [RFC5226],\n\
    \   \"Guidelines for IANA Considerations\".\n"
- title: 8.1.  IPFIX-Related Considerations
  contents:
  - "8.1.  IPFIX-Related Considerations\n   As the PSAMP protocol uses the IPFIX protocol,\
    \ refer to the IANA\n   considerations section in [RFC5101] for the assignments\
    \ of numbers\n   used in the protocol and for the numbers used in the information\n\
    \   model.\n"
- title: 8.2.  PSAMP-Related Considerations
  contents:
  - "8.2.  PSAMP-Related Considerations\n   Each new selection method MUST be assigned\
    \ a unique value for the\n   selectorAlgorithm Information Element [RFC5477].\
    \  Initial contents of\n   this registry are found in Section 8.2.1 in [RFC5477].\
    \  Its\n   configuration parameter(s), along with the way to report them with\
    \ an\n   Options Template, MUST be clearly specified.\n   New assignments for\
    \ the PSAMP selection method will be administered\n   by IANA, on a First Come\
    \ First Served basis [RFC5226], subject to\n   Expert Review [RFC5226].  The group\
    \ of experts must double check the\n   Information Elements definitions with already\
    \ defined Information\n   Elements for completeness, accuracy, and redundancy.\
    \  These experts\n   will initially be drawn from the Working Group Chairs and\
    \ document\n   editors of the IPFIX and PSAMP Working Groups.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC2119] Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n             Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC5101] Claise, B., Ed., \"Specification of the IP Flow Information\n\
    \             Export (IPFIX) Protocol for the Exchange of IP Traffic Flow\n  \
    \           Information\", RFC 5101, January 2008.\n   [RFC5102] Quittek, J.,\
    \ Bryant, S., Claise, B., Aitken, P., and J.\n             Meyer, \"Information\
    \ Model for IP Flow Information Export\",\n             RFC 5102, January 2008.\n\
    \   [RFC5226] Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n    \
    \         IANA Considerations Section in RFCs\", BCP 26, RFC 5226, May\n     \
    \        2008.\n   [RFC5475] Zseby, T., Molina, M., Duffield, N., Niccolini, S.,\
    \ and F.\n             Raspall, \"Sampling and Filtering Techniques for IP Packet\n\
    \             Selection\", RFC 5475, March 2009.\n   [RFC5477] Dietz, T., Claise,\
    \ B., Aitken, P., Dressler, F., and G.\n             Carle, \"Information Model\
    \ for Packet Sampling Exports\", RFC\n             5477, March 2009.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [RFC2804] IAB and IESG, \"IETF Policy on Wiretapping\"\
    , RFC 2804, May\n             2000.\n   [RFC3917] Quittek, J., Zseby, T., Claise,\
    \ B., and S. Zander,\n             \"Requirements for IP Flow Information Export\
    \ (IPFIX)\", RFC\n             3917, October 2004.\n   [RFC4271] Rekhter, Y.,\
    \ Ed., Li, T., Ed., and S. Hares, Ed., \"A Border\n             Gateway Protocol\
    \ 4 (BGP-4)\", RFC 4271, January 2006.\n   [RFC5470] Sadasivan, G., Brownlee,\
    \ N., Claise, B., and  J. Quittek,\n             \"Architecture for IP Flow Information\
    \ Export\" RFC 5470,\n             March 2009.\n   [RFC5474] Duffield, N., Ed.,\
    \ \"A Framework for Packet Selection and\n             Reporting\", RFC 5474,\
    \ March 2009.\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   The authors would like to thank the PSAMP group, especially\
    \ Paul\n   Aitken for fruitful discussions and for proofreading the document\n\
    \   several times.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Benoit Claise\n   Cisco Systems\n   De Kleetlaan 6a b1\n\
    \   1831 Diegem\n   Belgium\n   Phone: +32 2 704 5622\n   EMail: bclaise@cisco.com\n\
    \   Juergen Quittek\n   NEC Europe Ltd.\n   Network Laboratories\n   Kurfuersten-Anlage\
    \ 36\n   69115 Heidelberg\n   Germany\n   Phone: +49 6221 90511-15\n   EMail:\
    \ quittek@nw.neclab.eu\n   Andrew Johnson\n   Cisco Systems\n   96 Commercial\
    \ Quay\n   Edinburgh EH6 6LX\n   Scotland\n   Phone: +44 131 561 3641\n   EMail:\
    \ andrjohn@cisco.com\n"
