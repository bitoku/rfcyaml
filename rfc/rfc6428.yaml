- title: __initial_text__
  contents:
  - "       Proactive Connectivity Verification, Continuity Check, and\n        Remote\
    \ Defect Indication for the MPLS Transport Profile\n"
- title: Abstract
  contents:
  - "Abstract\n   Continuity Check, Proactive Connectivity Verification, and Remote\n\
    \   Defect Indication functionalities are required for MPLS Transport\n   Profile\
    \ (MPLS-TP) Operations, Administration, and Maintenance (OAM).\n   Continuity\
    \ Check monitors a Label Switched Path for any loss of\n   continuity defect.\
    \  Connectivity Verification augments Continuity\n   Check in order to provide\
    \ confirmation that the desired source is\n   connected to the desired sink. \
    \ Remote Defect Indication enables an\n   end point to report, to its associated\
    \ end point, a fault or defect\n   condition that it detects on a pseudowire,\
    \ Label Switched Path, or\n   Section.\n   This document specifies specific extensions\
    \ to Bidirectional\n   Forwarding Detection (BFD) and methods for proactive Continuity\n\
    \   Check, Continuity Verification, and Remote Defect Indication for\n   MPLS-TP\
    \ pseudowires, Label Switched Paths, and Sections using BFD as\n   extended by\
    \ this memo.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6428.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Conventions Used in This Document ...............................3\n  \
    \    2.1. Terminology ................................................3\n    \
    \  2.2. Requirements Language ......................................5\n   3. MPLS-TP\
    \ CC, Proactive CV, and RDI Mechanism Using BFD ...........5\n      3.1. Existing\
    \ Capabilities ......................................5\n      3.2. CC, CV, and\
    \ RDI Overview ...................................5\n      3.3. ACH Code Points\
    \ for CC and Proactive CV ....................6\n      3.4. MPLS-TP BFD CC Message\
    \ Format ..............................7\n      3.5. MPLS-TP BFD Proactive CV\
    \ Message Format ....................8\n           3.5.1. Section MEP-ID ......................................9\n\
    \           3.5.2. LSP MEP-ID ..........................................9\n  \
    \         3.5.3. PW End Point MEP-ID ................................10\n    \
    \  3.6. BFD Session in MPLS-TP Terminology ........................10\n      3.7.\
    \ BFD Profile for MPLS-TP ...................................11\n           3.7.1.\
    \ Session Initiation and Modification ................12\n           3.7.2. Defect\
    \ Entry Criteria ..............................13\n           3.7.3. Defect Entry\
    \ Consequent Action .....................14\n           3.7.4. Defect Exit Criteria\
    \ ...............................14\n           3.7.5. State Machines .....................................15\n\
    \           3.7.6. Configuration of MPLS-TP BFD Sessions ..............17\n  \
    \         3.7.7. Discriminator Values ...............................17\n   4.\
    \ Configuration Considerations ...................................18\n   5. IANA\
    \ Considerations ............................................18\n   6. Security\
    \ Considerations ........................................19\n   7. References\
    \ .....................................................19\n      7.1. Normative\
    \ References ......................................19\n      7.2. Informative\
    \ References ....................................20\n   8. Acknowledgments ................................................20\n\
    \   9. Contributing Authors ...........................................21\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   In traditional transport networks, circuits are provisioned\
    \ on two or\n   more switches.  Service providers need Operations, Administration,\n\
    \   and Maintenance (OAM) tools to detect mis-connectivity and loss of\n   continuity\
    \ of transport circuits.  Both pseudowires (PWs) and MPLS-TP\n   Label Switched\
    \ Paths (LSPs) [12] emulating traditional transport\n   circuits need to provide\
    \ the same Continuity Check (CC), proactive\n   Continuity Verification (CV),\
    \ and Remote Defect Indication (RDI)\n   capabilities as required in RFC 5860\
    \ [3].  This document describes\n   the use of Bidirectional Forwarding Detection\
    \ (BFD) [4] for CC,\n   proactive CV, and RDI of a PW, LSP, or Sub-Path Maintenance\
    \ Entity\n   (SPME) between two Maintenance Entity Group End Points (MEPs).\n\
    \   As described in RFC 6371 [13], CC and CV functions are used to detect\n  \
    \ loss of continuity (LOC) and unintended connectivity between two MEPs\n   (e.g.,\
    \ mis-merging or mis-connectivity or unexpected MEP).\n   RDI is an indicator\
    \ that is transmitted by a MEP to communicate to\n   its peer MEP that a signal\
    \ fail condition exists.  RDI is only used\n   for bidirectional LSPs and is associated\
    \ with proactive CC and CV BFD\n   control packet generation.\n   This document\
    \ specifies the BFD extension and behavior to satisfy the\n   CC, proactive CV\
    \ monitoring, and the RDI functional requirements for\n   both co-routed and associated\
    \ bidirectional LSPs.  Supported\n   encapsulations include Generic Associated\
    \ Channel Label (GAL) /\n   Generic Associated Channel (G-ACh), Virtual Circuit\
    \ Connectivity\n   Verification (VCCV), and UDP/IP.  Procedures for unidirectional\n\
    \   point-to-point (P2P) and point-to-multipoint (P2MP) LSPs are for\n   further\
    \ study.\n   This document utilizes identifiers for MPLS-TP systems as defined\
    \ in\n   RFC 6370 [9].  Work is ongoing in the ITU-T to define a globally-\n \
    \  unique semantic for ITU Carrier Codes (ICCs), and future work may\n   extend\
    \ this document to utilize ICCs as identifiers for MPLS-TP\n   systems.\n   The\
    \ mechanisms specified in this document are restricted to BFD\n   asynchronous\
    \ mode.\n"
- title: 2.  Conventions Used in This Document
  contents:
  - '2.  Conventions Used in This Document

    '
- title: 2.1.  Terminology
  contents:
  - "2.1.  Terminology\n   ACH: Associated Channel Header\n   BFD: Bidirectional Forwarding\
    \ Detection\n   CC: Continuity Check\n   CV: Connectivity Verification\n   GAL:\
    \ Generic Associated Channel Label\n   G-ACh: Generic Associated Channel\n   LDI:\
    \ Link Down Indication\n   LKI: Lock Instruct\n   LKR: Lock Report\n   LSP: Label\
    \ Switched Path\n   LSR: Label Switching Router\n   ME:  Maintenance Entity\n\
    \   MEG: Maintenance Entity Group\n   MEP: Maintenance Entity Group End Point\n\
    \   MIP: Maintenance Entity Group Intermediate Point\n   MPLS: Multiprotocol Label\
    \ Switching\n   MPLS-OAM: MPLS Operations, Administration and Maintenance\n  \
    \ MPLS-TP: MPLS Transport Profile\n   MPLS-TP LSP: Unidirectional or bidirectional\
    \ Label Switched Path\n   representing a circuit\n   MS-PW: Multi-Segment Pseudowire\n\
    \   NMS: Network Management System\n   OAM: Operations, Administration, and Maintenance\
    \ [14]\n   PW: Pseudowire\n   PDU: Protocol Data Unit\n   P/F: Poll/Final\n  \
    \ RDI: Remote Defect Indication\n   SPME: Sub-Path Maintenance Entity\n   TTL:\
    \ Time To Live\n   TLV: Type Length Value\n   VCCV: Virtual Circuit Connectivity\
    \ Verification\n"
- title: 2.2.   Requirements Language
  contents:
  - "2.2.   Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [1].\n"
- title: 3.  MPLS-TP CC, Proactive CV, and RDI Mechanism Using BFD
  contents:
  - "3.  MPLS-TP CC, Proactive CV, and RDI Mechanism Using BFD\n   This document describes\
    \ procedures for achieve combined CC, CV, and\n   RDI functionality within a single\
    \ MPLS-TP MEG using BFD.  This\n   augments the capabilities that can be provided\
    \ for MPLS-TP LSPs using\n   existing specified tools and procedures.\n"
- title: 3.1.  Existing Capabilities
  contents:
  - "3.1.  Existing Capabilities\n   A CC-only mode may be provided via protocols\
    \ and procedures described\n   in RFC 5885 [7] with ACH channel 7.  These procedures\
    \ may be applied\n   to bidirectional LSPs (via the use of the GAL) as well as\
    \ PWs.\n   Implementations may also interoperate with legacy equipment by\n  \
    \ implementing RFC 5884 [8] for LSPs and RFC 5085 [10] for PWs, in\n   addition\
    \ to the procedures documented in this memo.  In accordance\n   with RFC 5586\
    \ [2], when BFD control packets are encapsulated in an IP\n   header, the fields\
    \ in the IP header are set as defined in RFC 5884\n   [8].  When IP encapsulation\
    \ is used, CV mis-connectivity defect\n   detection can be performed by inferring\
    \ a globally unique source on\n   the basis of the combination of the source IP\
    \ address and My\n   Discriminator fields.\n"
- title: 3.2.  CC, CV, and RDI Overview
  contents:
  - "3.2.  CC, CV, and RDI Overview\n   The combined CC, CV, and RDI functionality\
    \ for MPLS-TP is achieved by\n   multiplexing CC and CV PDUs within a single BFD\
    \ session.  The CV PDUs\n   are augmented with a Source MEP-ID TLV to permit mis-connectivity\n\
    \   detection to be performed by sink MEPs.\n   The interleaving of PDUs is achieved\
    \ via the use of distinct\n   encapsulations and code points for generic associated\
    \ channel (G-ACh)\n   encapsulated BFD depending on whether the PDU format is\
    \ CC or CV:\n   o  CC format: defines a new code point in the Associated Channel\n\
    \      Header (ACH) described in RFC 5586 [2].  This format supports\n      Continuity\
    \ Check and RDI functionalities.\n   o  CV format: defines a new code point in\
    \ the Associated Channel\n      Header (ACH) described in RFC 5586 [2].  The ACH\
    \ with \"MPLS-TP\n      Proactive CV\" code point indicates that the message is\
    \ an MPLS-TP\n      BFD proactive CV message, and information for CV processing\
    \ is\n      appended in the form of the Source MEP-ID TLV.\n   RDI is communicated\
    \ via the BFD diagnostic field in BFD CC messages,\n   and the diagnostic code\
    \ field in CV messages MUST be ignored.  It is\n   not a distinct PDU.  As per\
    \ [4], a sink MEP SHOULD encode a\n   diagnostic code of \"1 - Control Detection\
    \ Time Expired\" when the time\n   since the last received BFD control packet\
    \ exceeds the detection\n   time, which is equal to the remote system's Transmit\
    \ Interval\n   multiplied by the remote system's Detect Multiplier (which is set\
    \ to\n   3 in this document).  A sink MEP SHOULD encode a diagnostic code of\n\
    \   \"5 - Path Down\" as a consequence of the sink MEP receiving LDI.  A\n   sink\
    \ MEP MUST encode a diagnostic code of \"9 - mis-connectivity\n   defect\" when\
    \ CV PDU processing indicates a mis-connectivity defect.\n   A sink MEP that has\
    \ started sending diagnostic code 5 SHOULD NOT\n   change it to 1 when the detection\
    \ timer expires.\n"
- title: 3.3.  ACH Code Points for CC and Proactive CV
  contents:
  - "3.3.  ACH Code Points for CC and Proactive CV\n   Figure 1 illustrates the G-ACh\
    \ encoding for BFD CC-CV-RDI\n   functionality.\n    0                   1   \
    \                2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6\
    \ 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |0 0 0 1|Version|     Flags     |      BFD CC/CV Code Point     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \               Figure 1: ACH Indication of MPLS-TP CC/CV/RDI\n   The first nibble\
    \ (0001b) indicates the G-ACh as per RFC 5586 [2].\n   The version and the flags\
    \ are set to 0 as specified in [2].\n   The code point is either\n   - BFD CC\
    \ code point = 0x0022, or\n   - BFD proactive CV code point = 0x0023.\n   CC and\
    \ CV PDUs apply to all pertinent MPLS-TP structures, including\n   PWs, MPLS LSPs\
    \ (including SPMEs), and Sections.\n   CC and CV operations are simultaneously\
    \ employed on a maintenance\n   entity (ME) within a single BFD session.  The\
    \ expected usage is that\n   normal operation is to send CC BFD protocol data\
    \ units (PDUs)\n   interleaved with a CV BFD PDU (augmented with a Source MEP-ID\
    \ and\n   identified as requiring additional processing by the different ACh\n\
    \   channel types).  The insertion interval for CV PDUs is one per\n   second.\
    \  Detection of a loss of continuity defect occurs when the\n   time since the\
    \ last received BFD control packet exceeds the detection\n   time, which is equal\
    \ to the session periodicity times the remote\n   system's Detect Multiplier (which\
    \ is set to 3 for the CC code point).\n   Mis-connectivity defects are detected\
    \ in a maximum of one second.\n"
- title: 3.4.  MPLS-TP BFD CC Message Format
  contents:
  - "3.4.  MPLS-TP BFD CC Message Format\n   The format of an MPLS-TP CC message is\
    \ shown below.\n    0                   1                   2                \
    \   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n \
    \  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |0\n   0\
    \ 0 1|Version|     Flags     |      BFD CC Code point        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \ |\n   | ~                  BFD Control Packet                           ~ |\n\
    \   | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \                 Figure 2: MPLS-TP CC Message\n   As shown in Figure 2, the MPLS-TP\
    \ CC message consists of the BFD\n   control packet as defined in [4] pre-pended\
    \ by the G-ACh.\n"
- title: 3.5.  MPLS-TP BFD Proactive CV Message Format
  contents:
  - "3.5.  MPLS-TP BFD Proactive CV Message Format\n   The format of an MPLS-TP CV\
    \ Message is shown below.\n    0                   1                   2     \
    \              3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |0 0 0 1|Version|     Flags     |       BFD CV Code Point       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   ~  \
    \                BFD Control Packet                           ~\n   |        \
    \                                                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   ~  \
    \                    Source MEP-ID TLV                        ~\n   |        \
    \                                                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                     Figure 3: MPLS-TP CV Message\n   As shown in Figure 3, the\
    \ MPLS-TP CV message consists of the BFD\n   control packet as defined in [4],\
    \ pre-pended by the ACH and appended\n   by a Source MEP-ID TLV.\n   A Source\
    \ MEP-ID TLV is encoded as a 2-octet field that specifies a\n   Type, followed\
    \ by a 2-octet Length field, followed by a variable-\n   length Value field. \
    \ A BFD session will only use one encoding of the\n   Source ID TLV.\n   The length\
    \ in the BFD control packet is as per [4]; the length of the\n   Source MEP-ID\
    \ TLV is not included.  There are three possible Source\n   MEP TLVs (corresponding\
    \ to the MEP-IDs defined in [9]).  The type\n   fields are:\n      0 - Section\
    \ MEP-ID\n      1 - LSP MEP-ID\n      2 - PW MEP-ID\n   When the GAL is used,\
    \ the TTL field of the GAL MUST be set to at\n   least 1, and the GAL MUST be\
    \ the end of stack label (S=1) as per [2].\n   A node MUST NOT change the value\
    \ in the Source MEP-ID TLV.\n   When digest-based authentication is used, the\
    \ Source ID TLV MUST NOT\n   be included in the digest.\n"
- title: 3.5.1.  Section MEP-ID
  contents:
  - "3.5.1.  Section MEP-ID\n   The IP-compatible MEP-ID for MPLS-TP Sections is the\
    \ interface ID.\n   The format of the Section MEP-ID TLV is:\n    0          \
    \         1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Type                         |  Length                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       MPLS-TP Global_ID                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                    MPLS-TP Node Identifier                    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                    MPLS-TP Interface Number                   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                   Figure 4: Section MEP-ID TLV Format\n   Where the Type is\
    \ of value '0'.  The Length is the length of the\n   value fields.  The MPLS-TP\
    \ Global_ID, Node Identifier, and Interface\n   Numbers are as per [9].\n"
- title: 3.5.2.  LSP MEP-ID
  contents:
  - "3.5.2.  LSP MEP-ID\n   The fields for the LSP MEP-ID are as defined in [9]. \
    \ This is\n   applicable to both LSPs and SPMEs.  This consists of the 32-bit\
    \ MPLS-\n   TP Global_ID, the 32-bit Node Identifier, followed by the 16-bit\n\
    \   Tunnel_Num (that MUST be unique within the context of the Node\n   Identifier),\
    \ and the 16-bit LSP_NUM (that MUST be unique within the\n   context of the Tunnel_Num).\
    \  The format of the TLV is:\n    0                   1                   2  \
    \                 3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6\
    \ 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Type                         |  Length                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       MPLS-TP Global_ID                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                    MPLS-TP Node Identifier                    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |           Tunnel_Num          |            LSP_Num            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                   Figure 5: LSP MEP-ID TLV Format\n   Where the type is of value\
    \ '1'.  The length is the length of the\n   value fields.  The MPLS-TP Global_ID,\
    \ Node Identifier, Tunnel_Num,\n   and LSP_Num are as per [9].\n"
- title: 3.5.3.  PW End Point MEP-ID
  contents:
  - "3.5.3.  PW End Point MEP-ID\n   The fields for the MPLS-TP PW End Point MEP-ID\
    \ are as defined in [9].\n   The format of the TLV is:\n    0                \
    \   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Type                         |  Length                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       MPLS-TP Global_ID                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                    MPLS-TP Node Identifier                    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                             AC_ID                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   AGI Type    |  AGI Length   |      AGI Value                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   ~                    AGI  Value (contd.)                        ~\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 6: PW End Point MEP-ID TLV Format\n   Where the type\
    \ is value '2'.  The length is the length of the\n   following data: the Global_ID,\
    \ Node Identifier, and Attachment\n   Circuit ID (AC_ID) are as per [9].  The\
    \ Attachment Group Identifier\n   (AGI) Type is as per [6], and the AGI Length\
    \ is the length of the AGI\n   value field.\n"
- title: 3.6.  BFD Session in MPLS-TP Terminology
  contents:
  - "3.6.  BFD Session in MPLS-TP Terminology\n   A BFD session corresponds to a CC\
    \ and proactive CV OAM instance in\n   MPLS-TP terminology.  A BFD session is\
    \ enabled when the CC and\n   proactive CV functionality are enabled on a configured\
    \ Maintenance\n   Entity (ME).\n   When the CC and proactive CV functionality\
    \ are disabled on an ME, the\n   BFD session transitions to the ADMIN DOWN state,\
    \ and the BFD session\n   ends.\n   A new BFD session is initiated when the operator\
    \ enables or\n   re-enables the CC and CV functionality.\n   All BFD state changes\
    \ and P/F exchanges MUST be done using CC\n   packets.  P/F and session state\
    \ information in CV packets MUST be\n   ignored.\n"
- title: 3.7.  BFD Profile for MPLS-TP
  contents:
  - "3.7.  BFD Profile for MPLS-TP\n   BFD operates in asynchronous mode utilizing\
    \ the encapsulation defined\n   in Section 3 for all sessions in a given MEG.\
    \  For LSPs, SPMEs, and\n   Sections, this is GAL/G-ACh-encapsulated BFD using\
    \ the code points\n   specified in Section 3.3.  For PWs, this is G-ACh or GAL/G-ACh-\n\
    \   encapsulated BFD using the code points specified in Section 3.3.  In\n   this\
    \ mode, the BFD control packets are periodically sent at a\n   configurable time\
    \ rate.  This rate is a fixed value common for both\n   directions of MEG for\
    \ the lifetime of the MEG.\n   This document specifies bidirectional BFD for P2P\
    \ transport LSPs;\n   hence, all BFD packets MUST be sent with the M bit clear.\n\
    \   There are two modes of operation for bidirectional LSPs: one in which\n  \
    \ the session state of both directions of the LSP is coordinated, and\n   one\
    \ constructed from BFD sessions in such a way that the two\n   directions operate\
    \ independently but are still part of the same MEG.\n   A single bidirectional\
    \ BFD session is used for coordinated operation.\n   Two independent BFD sessions\
    \ are used for independent operation.  It\n   should be noted that independent\
    \ operation treats session state and\n   defect state as independent entities.\
    \  For example, an independent\n   session can be in the UP state while receiving\
    \ RDI.  For a\n   coordinated session, the session state will track the defect\
    \ state.\n   In coordinated mode, an implementation SHOULD NOT reset\n   bfd.RemoteDiscr\
    \ until it is exiting the DOWN state.\n   In independent mode, an implementation\
    \ MUST NOT reset bfd.RemoteDiscr\n   upon transitioning to the DOWN state.\n \
    \  Overall operation is as specified in RFC 5880 [4] and augmented for\n   MPLS\
    \ in RFC 5884 [8].  Coordinated operation is as described in [4].\n   Independent\
    \ operation requires clarification of two aspects of [4].\n   Independent operation\
    \ is characterized by the setting of\n   bfd.MinRxInterval to zero by the MEP\
    \ that is typically the session\n   originator (referred to as the source MEP),\
    \ and there will be a\n   session originator at either end of the bidirectional\
    \ LSP.  Each\n   source MEP will have a corresponding sink MEP that has been\n\
    \   configured to a transmission interval of zero.\n   This memo specifies a preferred\
    \ interpretation of the base\n   specification on how a MEP behaves with a BFD\
    \ transmit rate set to\n   zero.  One interpretation is that no periodic messages\
    \ on the reverse\n   component of the bidirectional LSP originate with that MEP;\
    \ it will\n   only originate messages on a state change.\n   The first clarification\
    \ is that, when a state change occurs, a MEP\n   set to a transmit rate of zero\
    \ sends BFD control messages with a one-\n   second period on the reverse component\
    \ until such time that the state\n   change is confirmed by the session peer.\
    \  At this point, the MEP set\n   to a transmit rate of zero can resume quiescent\
    \ behavior.  This adds\n   robustness to all state transitions in the RxInterval=0\
    \ case.\n   The second clarification is that the originating MEP (the one with\
    \ a\n   non-zero bfd.TxInterval) will ignore a DOWN state received from a\n  \
    \ zero-interval peer.  This means that the zero-interval peer will\n   continue\
    \ to send DOWN state messages that include the RDI diagnostic\n   code as the\
    \ state change is never confirmed.  This adds robustness to\n   the exchange of\
    \ RDI on a unidirectional failure (for both session\n   types DOWN with a diagnostic\
    \ of either control detection period\n   expired or neighbor signaled session\
    \ down offering RDI\n   functionality).\n   A further extension to the base specification\
    \ is that there are\n   additional OAM protocol exchanges that act as inputs to\
    \ the BFD state\n   machine.  These are the Link Down Indication [5] and the Lock\n\
    \   Instruct/Lock Report transactions, the Lock Report interaction being\n   optional.\n"
- title: 3.7.1.  Session Initiation and Modification
  contents:
  - "3.7.1.  Session Initiation and Modification\n   Session initiation occurs starting\
    \ from MinRx = 1 second, MinTx >= 1\n   second, and the detect multiplier = 3.\n\
    \   Once in the UP state, Poll/Final discipline is used to modify the\n   periodicity\
    \ of control message exchange from their default rates to\n   the desired rates\
    \ and to set the detect multiplier to 3.\n   Note that in the Poll/Final process\
    \ a receiver of a new timer value\n   with a poll flag can reject the timer value\
    \ by tearing the session,\n   or it can return its preferred timer value with\
    \ the final flag.  Note\n   also that the receiver of a new timer value with a\
    \ final flag can\n   reject the timer value by tearing the session, or it can\
    \ return its\n   preferred timer value with the poll flag.\n   Once the desired\
    \ rate has been reached using the Poll/Final\n   mechanism, implementations SHOULD\
    \ NOT attempt further rate\n   modification.\n   In the rare circumstance where\
    \ an operator has a reason to further\n   change session parameters, beyond the\
    \ initial migration from default\n   values, Poll/Final discipline can be used\
    \ with the caveat that a peer\n   implementation may consider a session change\
    \ unacceptable and/or\n   bring the BFD session down via the use of the ADMIN\
    \ DOWN state.\n"
- title: 3.7.2.  Defect Entry Criteria
  contents:
  - "3.7.2.  Defect Entry Criteria\n   There are further defect criteria beyond those\
    \ that are defined in\n   [4] to consider given the possibility of mis-connectivity\
    \ defects.\n   The result is the criteria for an LSP direction to transition from\n\
    \   the defect-free state to a defect state is a superset of that in the\n   BFD\
    \ base specification [4].\n   The following conditions cause a MEP to enter the\
    \ defect state for CC\n   PDUs (in no particular order):\n      1. BFD session\
    \ times out (loss of continuity defect).\n      2. Receipt of a Link Down Indication\
    \ or Lock Report.\n   The following will cause the MEP to enter the mis-connectivity\
    \ defect\n   state for CV operation (again, not in any particular order):\n  \
    \    1. BFD control packets are received with an unexpected\n         encapsulation\
    \ (mis-connectivity defect), these include:\n         -  receiving an IP encoded\
    \ CC or CV BFD control packet on an\n            LSP configured to use GAL/G-ACh,\
    \ or\n         -  vice versa\n         (Note there are other possibilities that\
    \ can also alias as an\n         OAM packet.)\n      2. Receipt of an unexpected\
    \ globally unique Source MEP identifier\n         (mis-connectivity defect). \
    \ Note that as each encoding of the\n         Source MEP-ID TLV contains unique\
    \ information (there is no\n         mechanical translation possible between MEP-ID\
    \ formats),\n         receipt of an unexpected Source MEP-ID type is the same\
    \ as\n         receiving an unexpected value.\n      3. Receipt of a session discriminator\
    \ that is not in the local BFD\n         database in the Your Discriminator field\
    \ (mis-connectivity\n         defect).\n      4. Receipt of a session discriminator\
    \ that is in the local\n         database but does not have the expected label\
    \ (mis-connectivity\n         defect).\n      5. If BFD authentication is used,\
    \ receipt of a message with\n         incorrect authentication information (password,\
    \ MD5 digest, or\n         SHA1 hash).\n   The effective defect hierarchy (order\
    \ of checking) is:\n      1. Receiving nothing.\n      2. Receiving Link Down\
    \ Indication, e.g., a local link failure, an\n         MPLS-TP LDI, or Lock Report.\n\
    \      3. Receiving from an incorrect source (determined by whatever\n       \
    \  means).\n      4. Receiving from a correct source (as near as can be determined),\n\
    \         but with incorrect session information.\n      5. Receiving BFD control\
    \ packets in all discernable ways correct.\n"
- title: 3.7.3. Defect Entry Consequent Action
  contents:
  - "3.7.3. Defect Entry Consequent Action\n   Upon defect entry, a sink MEP will\
    \ assert signal fail into any client\n   (sub-)layers.  It will also communicate\
    \ session DOWN to its session\n   peer using CC messages.\n   The blocking of\
    \ traffic as a consequent action MUST be driven only by\n   a defect's consequent\
    \ action as specified in Section 5.1.1.2 of RFC\n   6371 [13].\n   When the defect\
    \ is mis-connectivity, the Section, LSP, or PW\n   termination will silently discard\
    \ all non-OAM traffic received.  The\n   sink MEP will also send a defect indication\
    \ back to the source MEP\n   via the use of a diagnostic code of mis-connectivity\
    \ defect (9).\n"
- title: 3.7.4.  Defect Exit Criteria
  contents:
  - '3.7.4.  Defect Exit Criteria

    '
- title: 3.7.4.1.  Exit from a Loss of Continuity Defect
  contents:
  - "3.7.4.1.  Exit from a Loss of Continuity Defect\n   For a coordinated session,\
    \ exit from a loss of connectivity defect is\n   as described in Figure 7, which\
    \ updates RFC 5880 [4].\n   For an independent session, exit from a loss of connectivity\
    \ defect\n   occurs upon receipt of a well-formed BFD control packet from the\
    \ peer\n   MEP as described in Figures 8 and 9.\n"
- title: 3.7.4.2.  Exit from a Mis-Connectivity Defect
  contents:
  - "3.7.4.2.  Exit from a Mis-Connectivity Defect\n   Exit from a mis-connectivity\
    \ defect state occurs when no CV messages\n   with mis-connectivity defects have\
    \ been received for a period of 3.5\n   seconds.\n"
- title: 3.7.5.  State Machines
  contents:
  - "3.7.5.  State Machines\n   The following state machines update RFC 5880 [4].\
    \  They have been\n   modified to include LDI and LKR as specified in [5] as inputs\
    \ to the\n   state machine and to clarify the behavior for independent mode. \
    \ LKR\n   is an optional input.\n   The coordinated session state machine has\
    \ been augmented to indicate\n   LDI and optionally LKR as inputs to the state\
    \ machine.  For a session\n   that is in the UP state, receipt of LDI or optionally\
    \ LKR will\n   transition the session into the DOWN state.\n                 \
    \            +--+\n                             |  | UP, ADMIN DOWN, TIMER, LDI,\
    \ LKR\n                             |  V\n               DOWN        +------+\
    \  INIT\n              +------------|      |------------+\n              |   \
    \         | DOWN |            |\n              |  +-------->|      |<--------+\
    \  |\n              |  |         +------+         |  |\n              |  |   \
    \      MIS-CONNECTIVITY,|  |\n              |  |               ADMIN DOWN,|  |\n\
    \              |  |ADMIN DOWN,          DOWN,|  |\n              |  |TIMER   \
    \            TIMER,|  |\n              V  |LDI,LKR           LDI,LKR |  V\n  \
    \          +------+                      +------+\n       +----|      |      \
    \                |      |----+\n   DOWN|    | INIT |--------------------->|  UP\
    \  |    |INIT, UP\n       +--->|      | INIT, UP             |      |<---+\n \
    \           +------+                      +------+\n   Figure 7: MPLS CC State\
    \ Machine for Coordinated Session Operation\n   For independent mode, there are\
    \ two state machines: one for the\n   source MEP (which requested bfd.MinRxInterval=0)\
    \ and one for the sink\n   MEP (which agreed to bfd.MinRxInterval=0).\n   The\
    \ source MEP will not transition out of the UP state once\n   initialized except\
    \ in the case of a forced ADMIN DOWN.  Hence, LDI\n   and optionally LKR do not\
    \ enter into the state machine transition\n   from the UP state, but do enter\
    \ into the INIT and DOWN states.\n                             +--+\n        \
    \                     |  | UP, ADMIN DOWN, TIMER, LDI, LKR\n                 \
    \            |  V\n               DOWN        +------+  INIT\n              +------------|\
    \      |------------+\n              |            | DOWN |            |\n    \
    \          |  +-------->|      |<--------+  |\n              |  |         +------+\
    \         |  |\n              |  |                          |  |\n           \
    \   |  |ADMIN DOWN     ADMIN DOWN |  |\n              |  |TIMER,             \
    \       |  |\n              |  |LDI,                      |  |\n             \
    \ V  |LKR                       |  V\n            +------+                   \
    \   +------+\n       +----|      |                      |      |----+\n   DOWN|\
    \    | INIT |--------------------->|  UP  |    | INIT, UP, DOWN,\n       +--->|\
    \      | INIT, UP             |      |<---+ LDI, LKR\n            +------+   \
    \                   +------+\n            Figure 8: MPLS CC State Machine for\
    \ Source MEP for\n                       Independent Session Operation\n   The\
    \ sink MEP state machine (for which the transmit interval has been\n   set to\
    \ zero) is modified to:\n   1) Permit direct transition from DOWN to UP once the\
    \ session has been\n      initialized.  With the exception of via the ADMIN DOWN\
    \ state, the\n      source MEP will never transition from the UP state; hence,\
    \ in\n      normal unidirectional fault scenarios, it will never transition to\n\
    \      the INIT state.\n                                +--+\n               \
    \                 |  | ADMIN DOWN, TIMER, LDI, LKR\n                         \
    \       |  V\n                  DOWN        +------+  INIT, UP\n             \
    \    +------------|      |------------+\n                 |            | DOWN\
    \ |            |\n                 |  +-------->|      |<--------+  |\n      \
    \           |  |         +------+         |  |\n                 |  |        \
    \ MIS-CONNECTIVITY,|  |\n                 |  |               ADMIN DOWN,|  |\n\
    \                 |  |ADMIN DOWN,    TIMER,     |  |\n                 |  |TIMER,\
    \         DOWN,      |  |\n                 |  |LDI,           LDI,       |  V\n\
    \                 V  |LKR            LKR        |  |\n               +------+\
    \                      +------+\n          +----|      |                     \
    \ |      |----+\n      DOWN|    | INIT |--------------------->|  UP  |    |INIT,\
    \ UP\n          +--->|      | INIT, UP             |      |<---+\n           \
    \    +------+                      +------+\n               Figure 9: MPLS CC\
    \ State Machine for the Sink MEP\n                      for Independent Session\
    \ Operation\n"
- title: 3.7.6.  Configuration of MPLS-TP BFD Sessions
  contents:
  - "3.7.6.  Configuration of MPLS-TP BFD Sessions\n   The configuration of MPLS-TP\
    \ BFD session parameters and the\n   coordination of the same between the source\
    \ and sink MEPs are out of\n   scope of this memo.\n"
- title: 3.7.7.  Discriminator Values
  contents:
  - "3.7.7.  Discriminator Values\n   In the BFD control packet, the discriminator\
    \ values either are local\n   to the sink MEP or have no significance (when not\
    \ known).\n   The My Discriminator field MUST be set to a non-zero value (which\
    \ can\n   be a fixed value).  The transmitted Your Discriminator value MUST\n\
    \   reflect back the received value of the My Discriminator field or be\n   set\
    \ to zero if that value is not known.\n   Per Section 7 of RFC 5884 [8], a node\
    \ MUST NOT change the value of\n   the My Discriminator field for an established\
    \ BFD session.\n"
- title: 4.  Configuration Considerations
  contents:
  - "4.  Configuration Considerations\n   The following is an example set of configuration\
    \ parameters for a BFD\n   session:\n      Mode and Encapsulation\n      ----------------------\n\
    \      RFC 5884 - BFD CC in UDP/IP/LSP\n      RFC 5885 - BFD CC in G-ACh\n   \
    \   RFC 5085 - UDP/IP in G-ACh\n       MPLS-TP - CC/CV in GAL/G-ACh or G-ACh\n\
    \   For MPLS-TP, the following additional parameters need to be\n   configured:\n\
    \   1) Session mode, coordinated or independent\n   2) CC periodicity\n   3) The\
    \ MEP-ID for the MEPs at either end of the LSP\n   4) Whether authentication is\
    \ enabled (and if so, the associated\n      parameters)\n   The discriminators\
    \ used by each MEP, both bfd.LocalDiscr and\n   bfd.RemoteDiscr, can optionally\
    \ be configured or locally assigned.\n   Finally, a detect multiplier of 3 is\
    \ directly inferred from the code\n   points.\n"
- title: 5.  IANA Considerations
  contents:
  - "5.  IANA Considerations\n   IANA has allocated two channel types from the \"\
    Pseudowire Associated\n   Channel Types\" registry in RFC 4385 [15].\n      0x0022\
    \   MPLS-TP CC message\n      0x0023   MPLS-TP CV message\n   IANA has created\
    \ a \"CC/CV MEP-ID TLV\" registry.  The parent registry\n   is the \"Pseudowire\
    \ Associated Channel Types\" registry of RFC 4385\n   [15].  All code points within\
    \ this registry shall be allocated\n   according to the \"Standards Action\" procedures\
    \ as specified in [11].\n   The items tracked in the registry will be the type,\
    \ associated name,\n   and reference.\n   The initial values are:\n      0 - Section\
    \ MEP-ID\n      1 - LSP MEP-ID\n      2 - PW MEP-ID\n   IANA has assigned the\
    \ following code point from the \"Bidirectional\n   Forwarding Detection (BFD)\
    \ Parameters\" registry, \"BFD Diagnostic\n   Codes\" subregistry [4]:\n     \
    \ 9 - mis-connectivity defect\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   The use of CV improves network integrity by ensuring\
    \ traffic is not\n   \"leaking\" between LSPs.\n   Base BFD foresees an optional\
    \ authentication section (see Section 6.7\n   of [4]) that can be applied to this\
    \ application.  Although the Source\n   MEP-ID TLV is not included in the BFD\
    \ authentication digest, there is\n   a chain of trust such that the discriminator\
    \ associated with the\n   digest is also associated with the expected MEP-ID;\
    \ this will prevent\n   impersonation of CV messages in this application.\n  \
    \ This memo specifies the use of globally unique identifiers for MEP-\n   IDs.\
    \  This provides absolutely authoritative detection of persistent\n   leaking\
    \ of traffic between LSPs.  Non-uniqueness can result in\n   undetected leaking\
    \ in the scenario where two LSPs with common MEP-IDs\n   are misconnected.  This\
    \ would be considered undesirable but rare; it\n   would also be difficult to\
    \ exploit for malicious purposes as, at a\n   minimum, both a network end point\
    \ and a node that was a transit point\n   for the target MEG would need to be\
    \ compromised.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [1]   Bradner, S., \"Key words for use in RFCs\
    \ to Indicate Requirement\n         Levels\", BCP 14, RFC 2119, March 1997.\n\
    \   [2]   Bocci, M., Ed., Vigoureux, M., Ed., and S. Bryant, Ed., \"MPLS\n   \
    \      Generic Associated Channel\", RFC 5586, June 2009.\n   [3]   Vigoureux,\
    \ M., Ed., Ward, D., Ed., and M. Betts, Ed.,\n         \"Requirements for Operations,\
    \ Administration, and Maintenance\n         (OAM) in MPLS Transport Networks\"\
    , RFC 5860, May 2010.\n   [4]   Katz, D. and D. Ward, \"Bidirectional Forwarding\
    \ Detection\n         (BFD)\", RFC 5880, June 2010.\n   [5]   Swallow, G., Ed.,\
    \ Fulignoli, A., Ed., Vigoureux, M., Ed.,\n         Boutros, S., and D. Ward,\
    \ \"MPLS Fault Management Operations,\n         Administration, and Maintenance\
    \ (OAM)\", RFC 6427, November\n         2011.\n   [6]   Martini, L., \"IANA Allocations\
    \ for Pseudowire Edge to Edge\n         Emulation (PWE3)\", BCP 116, RFC 4446,\
    \ April 2006.\n   [7]   Nadeau, T., Ed., and C. Pignataro, Ed., \"Bidirectional\n\
    \         Forwarding Detection (BFD) for the Pseudowire Virtual Circuit\n    \
    \     Connectivity Verification (VCCV)\", RFC 5885, June 2010.\n   [8]   Aggarwal,\
    \ R., Kompella, K., Nadeau, T., and G. Swallow,\n         \"Bidirectional Forwarding\
    \ Detection (BFD) for MPLS Label\n         Switched Paths (LSPs)\", RFC 5884,\
    \ June 2010.\n   [9]   Bocci, M., Swallow, G., and E. Gray, \"MPLS Transport Profile\n\
    \         (MPLS-TP) Identifiers\", RFC 6370, September 2011.\n   [10]  Nadeau,\
    \ T., Ed., and C. Pignataro, Ed., \"Pseudowire Virtual\n         Circuit Connectivity\
    \ Verification (VCCV): A Control Channel for\n         Pseudowires\", RFC 5085,\
    \ December 2007.\n   [11]  Narten, T. and H. Alvestrand, \"Guidelines for Writing\
    \ an IANA\n         Considerations Section in RFCs\", BCP 26, RFC 5226, May 2008.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [12]  Bocci, M., Ed., Bryant, S., Ed., Frost,\
    \ D., Ed., Levrau, L.,\n         and L. Berger, \"A Framework for MPLS in Transport\
    \ Networks\",\n         RFC 5921, July 2010.\n   [13]  Busi, I., Ed., and D. Allan,\
    \ Ed., \"Operations, Administration,\n         and Maintenance Framework for MPLS-Based\
    \ Transport Networks\",\n         RFC 6371, September 2011.\n   [14]  Andersson,\
    \ L., van Helvoort, H., Bonica, R., Romascanu, D., and\n         S. Mansfield,\
    \ \"Guidelines for the Use of the \"OAM\" Acronym in\n         the IETF\", BCP\
    \ 161, RFC 6291, June 2011.\n   [15]  Bryant, S., Swallow, G., Martini, L., and\
    \ D. McPherson,\n         \"Pseudowire Emulation Edge-to-Edge (PWE3) Control Word\
    \ for Use\n         over an MPLS PSN\", RFC 4385, February 2006.\n"
- title: 8.  Acknowledgments
  contents:
  - "8.  Acknowledgments\n   Nitin Bahadur, Rahul Aggarwal, Tom Nadeau, Nurit Sprecher,\
    \ and Yaacov\n   Weingarten also contributed to this document.\n"
- title: 9.  Contributing Authors
  contents:
  - "9.  Contributing Authors\n   Annamaria Fulignoli\n   Ericsson\n   EMail: annamaria.fulignoli@ericsson.com\n\
    \   Sami Boutros\n   Cisco Systems, Inc.\n   EMail: sboutros@cisco.com\n   Martin\
    \ Vigoureux\n   Alcatel-Lucent\n   EMail: martin.vigoureux@alcatel-lucent.com\n\
    \   Siva Sivabalan\n   Cisco Systems, Inc.\n   EMail: msiva@cisco.com\n   David\
    \ Ward\n   Juniper\n   EMail: dward@juniper.net\n   Robert Rennison\n   ECI Telecom\n\
    \   EMail: robert.rennison@ecitele.com\n"
- title: Editors' Addresses
  contents:
  - "Editors' Addresses\n   Dave Allan\n   Ericsson\n   EMail: david.i.allan@ericsson.com\n\
    \   George Swallow\n   Cisco Systems, Inc.\n   EMail: swallow@cisco.com\n   John\
    \ Drake\n   Juniper\n   EMail: jdrake@juniper.net\n"
