- title: __initial_text__
  contents:
  - ''
- title: 'Interactions between Proxy Mobile IPv6 (PMIPv6) and Mobile IPv6 (MIPv6):'
  contents:
  - "Interactions between Proxy Mobile IPv6 (PMIPv6) and Mobile IPv6 (MIPv6):\n  \
    \                    Scenarios and Related Issues\n"
- title: Abstract
  contents:
  - "Abstract\n   The use of Proxy Mobile IPv6 (PMIPv6) and Mobile IPv6 (MIPv6) in\
    \ the\n   same network requires some care.  This document discusses scenarios\n\
    \   where such mixed usage is appropriate and points out the need for\n   interaction\
    \ between the two mechanisms.  Solutions and\n   recommendations to enable these\
    \ scenarios are also described.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6612.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................2\n\
    \   2. Terminology .....................................................3\n  \
    \ 3. Overview of the Scenarios and Related Issues ....................4\n    \
    \  3.1. Issues Related to Scenario A.1 .............................8\n      3.2.\
    \ Issues Related to Scenario A.2 .............................8\n      3.3. Issues\
    \ Related to Scenario B ..............................10\n   4. Analysis of Possible\
    \ Solutions .................................11\n      4.1. Solutions Related\
    \ to Scenario A.1 .........................11\n      4.2. Solutions Related to\
    \ Scenario A.2 .........................13\n           4.2.1. Mobility from a\
    \ PMIPv6 Domain to a\n                  Non-PMIPv6 Domain ..................................14\n\
    \           4.2.2. Mobility from a Non-PMIPv6 Domain to a\n                  PMIPv6\
    \ Domain ......................................15\n      4.3. Solutions Related\
    \ to Scenario B ...........................15\n   5. Security Considerations ........................................16\n\
    \   6. Contributors ...................................................16\n  \
    \ 7. Acknowledgements ...............................................16\n   8.\
    \ References .....................................................17\n      8.1.\
    \ Normative References ......................................17\n      8.2. Informative\
    \ References ....................................17\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Proxy Mobile IPv6 (PMIPv6) [RFC5213] is a network-based\
    \ IP mobility\n   protocol standardized by the IETF.  In some deployment scenarios,\n\
    \   this protocol will be deployed together with Mobile IPv6 (MIPv6)\n   [RFC6275],\
    \ for example, with PMIPv6 as local mobility protocol and\n   MIPv6 as global\
    \ mobility protocol.  While the usage of a local\n   mobility protocol should\
    \ not have implications on how global mobility\n   is managed, since PMIPv6 is\
    \ partially based on MIPv6 signaling and\n   data structure, some considerations\
    \ are needed to understand how the\n   protocols interact and how the different\
    \ scenarios can be enabled.\n   Some standardization fora are also investigating\
    \ more complex\n   scenarios where the mobility of some nodes is handled using\
    \ Proxy\n   Mobile IPv6, while other nodes use Mobile IPv6; or the mobility of\
    \ a\n   node is managed in turn by a host-based and a network-based\n   mechanism.\
    \  This also needs to be analyzed as a possible deployment\n   scenario.\n   This\
    \ document provides a taxonomy of the most common scenarios that\n   require direct\
    \ interaction between MIPv6 and PMIPv6.  The list is not\n   meant to be exhaustive.\
    \  Moreover, this document presents and\n   identifies most of the issues pertaining\
    \ to these scenarios and\n   discusses possible means and mechanisms that are\
    \ recommended to\n   enable them.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   General mobility terminology can be found in [RFC3753]. \
    \ The\n   following acronyms are used in this document:\n   o  AR (Access Router):\
    \ first hop router\n   o  BCE (Binding Cache Entry): an entry of the MIPv6 or\
    \ PMIPv6 binding\n      cache\n   o  LMA (Local Mobility Anchor): the PMIPv6 mobility\
    \ anchor as\n      specified in [RFC5213]\n   o  MAG (Mobility Access Gateway):\
    \ the PMIPv6 client as specified in\n      [RFC5213]\n   o  MN-HoA: the Home Address\
    \ (HoA) of a Mobile Node (MN) in a PMIPv6\n      domain\n   o  MN-HNP: the IPv6\
    \ prefix that is always present in the Router\n      Advertisements that the MN\
    \ receives when it is attached to any of\n      the access links in that PMIPv6\
    \ domain (MN-HoA always belongs to\n      this prefix.)\n   o  MIPv6-HoA: the\
    \ HoA the MN includes in MIPv6 Binding Update\n      messages\n   o  MIPv6-CoA:\
    \ the Care-of Address the MN includes in MIPv6 Binding\n      Update messages\n"
- title: 3.  Overview of the Scenarios and Related Issues
  contents:
  - "3.  Overview of the Scenarios and Related Issues\n   Several scenarios can be\
    \ identified where MIPv6 and PMIPv6 are\n   deployed in the same network.  This\
    \ document not only focuses on\n   scenarios where the two protocols are used\
    \ by the same MN to manage\n   local and global mobility but also investigates\
    \ more complex\n   scenarios where the protocols are more tightly integrated or\
    \ where\n   there is a coexistence of nodes that do or do not implement MIPv6.\n\
    \   In particular, the scenario space can be split into hierarchical\n   deployments\
    \ and alternative deployments of Mobile IP (MIP) and Proxy\n   Mobile IP (PMIP).\
    \  Hierarchical deployments are scenarios where the\n   two mobility protocols\
    \ are used in the same network in a hierarchical\n   manner for global and local\
    \ mobility management.  Alternative\n   deployments are scenarios where only one\
    \ of the two protocols is used\n   for mobility management of a given MN.\n  \
    \ The following hierarchical scenarios are identified:\n   Scenario A.1: In this\
    \ scenario, PMIPv6 is used as a network-based\n   local mobility management protocol\
    \ whereas MIPv6 is used as a global\n   mobility management protocol.  This interaction\
    \ is very similar to\n   the interaction between Hierarchical Mobile IPv6 (HMIPv6)\
    \ and MIPv6\n   [RFC5380]; MIPv6 is used to manage mobility among different access\n\
    \   networks, while the mobility within the access network is handled by\n   PMIPv6.\
    \  The address managed by PMIPv6 (i.e., the MN-HoA) is\n   registered as the Care-of\
    \ Address by the MN at the Home Agent (HA).\n   This means that the HA has a BCE\
    \ for MIPv6-HoA that points to the\n   MN-HoA.\n   The following figure illustrates\
    \ this scenario.\n                           +----+\n                        \
    \   | HA |  MIPv6-HoA -> MN-HoA\n                           +----+\n         \
    \                    /\\\n                            /  \\\n             +-------------/----\\\
    --------------+\n            (             /      \\              ) Global Mobile\
    \ IPv6\n            (            /        \\             ) Domain\n          \
    \   +----------/----------\\-----------+\n                       /           \
    \ \\\n                    +----+         +----+\n    MN-HoA -> MAG1  |LMA1|  \
    \       |LMA2|\n                    +----+         +----+\n                  \
    \   //\\\\             \\\\\n               +----//--\\\\---+   +-----\\\\------+\n\
    \              (    //    \\\\   ) (       \\\\      ) Local Mobility Network\n\
    \              (   //      \\\\  ) (        \\\\     ) PMIPv6 domain\n       \
    \        +-//--------\\\\+   +--------\\\\---+\n                //          \\\
    \\             \\\\\n               //            \\\\             \\\\\n    \
    \          //              \\\\             \\\\\n           +----+          \
    \ +----+         +----+\n           |MAG1|           |MAG2|         |MAG3|\n \
    \          +----+           +----+         +----+\n             |            \
    \    |              |\n            [MN]\n                          Figure 1: Scenario\
    \ A.1\n   Scenario A.2: In this scenario, the MN is moving across different\n\
    \   access networks, some of them supporting PMIPv6 and some others not\n   supporting\
    \ it.  Therefore, the MN is roaming from an access network\n   where the mobility\
    \ is managed through a network-based solution to an\n   access network where a\
    \ host-based management (i.e., Mobile IPv6) is\n   needed.  This scenario may\
    \ have different sub-scenarios depending on\n   the relations between the MIPv6\
    \ home network and the PMIPv6 domain.\n   The following figure illustrates an\
    \ example of this scenario, where\n   the MN is moving from an access network\
    \ where PMIPv6 is supported\n   (i.e., MAG functionality is supported) to a network\
    \ where PMIPv6 is\n   not supported (i.e., MAG functionality is not supported\
    \ by the AR).\n   This implies that the home link of the MN is actually a PMIPv6\n\
    \   domain.  In this case, the MIPv6-HoA is equal to the MN-HoA (i.e.,\n   the\
    \ address managed by PMIPv6).\n                         MIPv6-HoA == MN-HoA ->\
    \ MAG1\n                               +------+\n                            \
    \   |HA/LMA|-----------------------+\n                               +------+\
    \                       |\n                                 //\\\\           \
    \              |\n                        +-------//--\\\\--------+          \
    \     |\n                       (       //    \\\\ PMIPv6 )              |\n \
    \                      (      //      \\\\ domain)       +--------------+\n  \
    \                      +----//--------\\\\-----+       (   Non-PMIPv6   )\n  \
    \                          //          \\\\            (   domain       )\n  \
    \                         //            \\\\            +--------------+\n   \
    \                       //              \\\\                  |\n            \
    \           +----+           +----+              +----+\n                    \
    \   |MAG1|           |MAG2|              | AR |\n                       +----+\
    \           +----+              +----+\n                         |           \
    \     |                   |\n                        [MN]\n                  \
    \        Figure 2: Scenario A.2\n   In the scenario illustrated in Figure 2, the\
    \ non-PMIPv6 domain can\n   actually also be a different PMIPv6 domain that handles\
    \ a different\n   MN_HoA.  The following figure illustrates this sub-case: the\
    \ MIPv6-\n   HoA is equal to the MN_HoA; however, when the MN hands over to MAG3,\n\
    \   it gets a different IP address (managed by LMA2 using PMIPv6) and\n   registers\
    \ it as a MIPv6 CoA.\n               MIPv6-HoA == MN-HoA -> MAG_1\n          \
    \           +-------+\n                     |HA/LMA1|-----------------------+\n\
    \                     +-------+                       |\n                    \
    \   //\\\\                       +----+\n              +-------//--\\\\--------+\
    \             |LMA2|\n             (       //    \\\\  home  )            +----+\n\
    \             (      //      \\\\ PMIPv6)       +------||------+\n           \
    \  (     //        \\\\domain)      (       ||visited)\n              +---//----------\\\
    \\----+       (       ||PMIPv6 )\n                 //            \\\\        \
    \   (       ||domain )\n                //              \\\\           +------||------+\n\
    \             +----+           +----+              +----+\n             |MAG1|\
    \           |MAG2|              |MAG3|\n             +----+           +----+ \
    \             +----+\n               |                |                   |\n\
    \              [MN]\n                               (a)\n              MIPv6-HoA\
    \ -> MN_CoA\n                     +-------+\n                     |HA/LMA1|-----------------------+\n\
    \                     +-------+                       |\n                    \
    \   //\\\\                       +----+\n              +-------//--\\\\--------+\
    \             |LMA2|  MN_CoA -> MAG3\n             (       //    \\\\  home  )\
    \            +----+\n             (      //      \\\\ PMIPv6)       +------||------+\n\
    \             (     //        \\\\domain)      (       ||visited)\n          \
    \    +---//----------\\\\----+       (       ||PMIPv6 )\n                 // \
    \           \\\\           (       ||domain )\n                //            \
    \  \\\\           +------||------+\n             +----+           +----+     \
    \         +----+\n             |MAG1|           |MAG2|              |MAG3|\n \
    \            +----+           +----+              +----+\n               |   \
    \             |                   |\n                                        \
    \           [MN]\n                                (b)\n             Figure 3:\
    \ Scenario A.2 with Visited PMIPv6 Domain\n   The following alternative deployment\
    \ has been identified:\n   Scenario B: In this scenario, some MNs use MIPv6 to\
    \ manage their\n   movements while others rely on a network-based mobility solution\n\
    \   provided by the network as they don't support Mobile IPv6.  There may\n  \
    \ be a common mobility anchor that acts as MIPv6 Home Agent and PMIPv6\n   LMA,\
    \ depending on the type of the node as depicted in the figure.\n   However, the\
    \ LMA and HA can also be separated, and this has no impact\n   on the mobility\
    \ of the nodes.\n                                     +--------+\n           \
    \                          | HA/LMA |\n                                     +--------+\n\
    \                +------+                              +------+\n            \
    \    | MAG1 |                              | MAG2 |\n                +------+\
    \                              +------+\n                           +-----------+\n\
    \                           | IPv6 host |   ----------------->\n             \
    \              +-----------+       movement\n                        +----------+\n\
    \                        | MIPv6 MN |  ----------------->\n                  \
    \      +----------+       movement\n                           Figure 4: Scenario\
    \ B\n   Note that some of the scenarios can be combined.  For instance,\n   Scenario\
    \ B can be combined with Scenario A.1 or Scenario A.2.\n   The following sections\
    \ describe some possible issues for each\n   scenario.  Respective recommendations\
    \ are described in Section 4.3.\n   The specifications considered as a baseline\
    \ for the analysis are the\n   following: [RFC6275], [RFC4877], and [RFC5213].\n"
- title: 3.1.  Issues Related to Scenario A.1
  contents:
  - "3.1.  Issues Related to Scenario A.1\n   This scenario is very similar to other\
    \ hierarchical mobility schemes,\n   including an HMIPv6-MIPv6 scheme.  No issues\
    \ have been identified in\n   this scenario.  Note that a race condition where\
    \ the MN registers the\n   CoA at the HA before the CoA is actually bound to the\
    \ MAG at the LMA\n   is not possible.  The reason is that per the PMIPv6 specification\n\
    \   [RFC5213], the MAG does not forward any packets sent by the MN until\n   the\
    \ PMIPv6 tunnel is up, regardless the mechanism used for address\n   allocation.\n\
    \   Section 4.1 describes one message flow in case PMIPv6 is used as a\n   local\
    \ mobility protocol and MIPv6 is used as a global mobility\n   protocol.\n"
- title: 3.2.  Issues Related to Scenario A.2
  contents:
  - "3.2.  Issues Related to Scenario A.2\n   This section highlights some considerations\
    \ that are applicable to\n   scenario A.2.\n   1.  HoA management and lookup key\
    \ in the binding cache\n       *  In MIPv6 [RFC6275], the lookup key in the binding\
    \ cache is the\n          HoA of the MN.  In particular, the base specification\n\
    \          [RFC6275] doesn't require the MN to include any identifier,\n     \
    \     such as the MN-ID [RFC4283], in the Binding Update message\n          other\
    \ than its HoA.  As described in [RFC4877], the identifier\n          of the MN\
    \ is known by the Home Agent after the Internet Key\n          Exchange Protocol\
    \ (IKEv2) exchange, but this is not used in\n          the MIPv6 signaling or\
    \ as a lookup key for the binding cache.\n          On the other hand, as specified\
    \ in [RFC5213], a Proxy Binding\n          Update contains the home prefix of\
    \ the MN, the MN-ID and does\n          not include the HoA of the MN (since it\
    \ may not be known by\n          the MAG and consequently by the HA/LMA).  The\
    \ lookup key in\n          the binding cache of the LMA is either the home prefix\
    \ or the\n          MN-ID.  This implies that lookup keys for MIPv6 and PMIPv6\n\
    \          registrations are different.  Because of that, when the MN\n      \
    \    moves from its home network (i.e., from the PMIPv6 domain) to\n         \
    \ the foreign link, the Binding Update sent by the MN is not\n          identified\
    \ by the HA as an update of the Proxy BCE containing\n          the home prefix\
    \ of the MN, but a new binding cache entry is\n          created.  Therefore,\
    \ PMIPv6 and MIPv6 will always create two\n          different BCEs in the HA/LMA,\
    \ which implies that the HA and\n          LMA are logically separated.  How to\
    \ handle the presence of\n          the two BCEs for the same MN is described\
    \ in Section 4.2.\n   2.  MIPv6 de-registration Binding Update deletes PMIPv6\
    \ binding cache\n       entry\n       *  When the MN moves from a MIPv6 foreign\
    \ network to the PMIPv6\n          home domain, the MAG registers the MN at the\
    \ LMA by sending a\n          Proxy Binding Update.  Subsequently, the LMA updates\
    \ the MN's\n          BCE with the MAG address and the MAG emulates the MN's home\n\
    \          link.  Upon detection of the home link, the MN will send a\n      \
    \    de-registration Binding Update to its home agent.  It is\n          necessary\
    \ to make sure that the de-registration of the MIPv6\n          Binding Update\
    \ does not change the PMIPv6 BCE just created by\n          the MAG.\n   3.  Race\
    \ condition between Binding Update and Proxy Binding Update\n       messages (Sequence\
    \ Numbers and Timestamps)\n       *  MIPv6 and PMIPv6 use different mechanisms\
    \ for handling\n          re-ordering of registration messages and they are sent\
    \ by\n          different entities.  In MIPv6, Binding Update messages that\n\
    \          are sent by the MN to the home agent are ordered by the\n         \
    \ sequence numbers.  The other side, in PMIPv6, Proxy Binding\n          Update\
    \ messages that are sent by the MAG to the LMA are\n          ordered by a timestamp\
    \ option.  When the MN moves from one\n          access where Mobile IP is used\
    \ to another access when Proxy\n          Mobile IP is used, delay in the mobility\
    \ signaling sent may\n          imply adverse situations.  For example, if the\
    \ MN sends a\n          Mobile IP Binding Update from access A before moving to\
    \ access\n          B and this Binding Update gets delayed (e.g., a refresh\n\
    \          Binding Update), the Binding Update may reach the combined\n      \
    \    LMA/HA after the Proxy Binding Update sent by the MAG,\n          re-directing\
    \ packets to access A even after the MN has moved\n          to access B.\n  \
    \ 4.  Threat of compromised MAG\n       *  In the MIPv6 base specification [RFC6275],\
    \ there is a strong\n          binding between the HoA registered by the MN and\
    \ the Security\n          Association (SA) used to modify the corresponding BCE.\n\
    \       *  In the PMIPv6 specification [RFC5213], the MAG sends Proxy\n      \
    \    Binding Updates on behalf of a MN to update the BCE that\n          corresponds\
    \ to the MN's HoA.  Since the MAG sends the Binding\n          Updates, PMIPv6\
    \ requires SAs between each MAG and the LMA.\n       *  As described in [RFC4832],\
    \ in PMIPv6, MAG compromise or\n          impersonation is an issue.  [RFC4832],\
    \ Section 2.2, describes\n          how a compromised MAG can harm the functionality\
    \ of an LMA,\n          e.g., manipulating the LMA's routing table (or binding\
    \ cache).\n       *  In this mixed scenario, both host-based and network-based\
    \ SAs\n          are used to update the same binding cache entry at the HA/LMA\n\
    \          (but see the first bullet of this list, as the entry may not\n    \
    \      be the same).  Based on this consideration, the threat\n          described\
    \ in [RFC4832] is worse as it also affects hosts that\n          are using the\
    \ LMA/HA as MIPv6 HA and not using PMIPv6.\n"
- title: 3.3.  Issues Related to Scenario B
  contents:
  - "3.3.  Issues Related to Scenario B\n   In this scenario, there are two types\
    \ of nodes in the access network:\n   some nodes support MIPv6 while some others\
    \ do not.  The rationale\n   behind such a scenario is that the nodes implementing\
    \ MIPv6 manage\n   their own mobility to achieve better performance, e.g., for\
    \ inter-\n   technology handovers.  Obviously, nodes that do not implement MIPv6\n\
    \   must rely on the network to manage their mobility; therefore, Proxy\n   MIPv6\
    \ is used for those nodes.\n   Based on the current PMIPv6 solution described\
    \ in [RFC5213], in any\n   link of the PMIPv6 domain, the MAG emulates the MN's\
    \ home link,\n   advertising the home link prefix to the MN in a unicast Router\n\
    \   Advertisement message.  This ensures that the IP address of the MN is\n  \
    \ still considered valid by the MN itself.  The home network prefix\n   (and any\
    \ other information needed to emulate the home link) is\n   included in the MN's\
    \ profile that is obtained by the MAG via context\n   transfer or via a policy\
    \ store.\n   However, in case there are nodes that implement MIPv6 and want to\
    \ use\n   this protocol, the network must offer MIPv6 service to them.  In such\n\
    \   a case, the MAG should not emulate the home link.  Instead of\n   advertising\
    \ the MN-HNP, the MAG should advertise the topologically\n   correct local IP\
    \ prefix, i.e., the prefix belonging to the MAG, so\n   that the MN detects an\
    \ IP movement, configures a new CoA, and sends a\n   MIPv6 Binding Update based\
    \ on [RFC6275].\n"
- title: 4.  Analysis of Possible Solutions
  contents:
  - '4.  Analysis of Possible Solutions

    '
- title: 4.1.  Solutions Related to Scenario A.1
  contents:
  - "4.1.  Solutions Related to Scenario A.1\n   As mentioned in Section 3.1, there\
    \ are no significant issues in this\n   scenario.\n   Figures 5 and 6 show a scenario\
    \ where an MN is moving from one PMIPv6\n   domain to another, based on the scenario\
    \ of Figure 1.  In Figure 5,\n   the MN moves from an old MAG to MAG2 in the same\
    \ PMIPv6 domain: this\n   movement triggers a PBU to LMA1 and the updating of\
    \ the binding cache\n   at the LMA1.  There is no MIPv6 signaling as the CoA_1\
    \ registered at\n   the HA is the HoA for the PMIPv6 session.  In Figure 6, the\
    \ MN moves\n   from MAG2 in the LMA1 PMIPv6 domain to MAG3 in a different PMIPv6\n\
    \   domain: this triggers the PMIPv6 signaling and the creation of a\n   binding\
    \ at the LMA2.  On the other hand, the local address of the\n   mobile node is\
    \ changed, as the LMA has changed; therefore, the MN\n   sends a MIPv6 Binding\
    \ Update to the HA with the new CoA_2.\n    +----+            +------+       \
    \     +------+       +----+\n    | MN |            | MAG2 |            | LMA1\
    \ |       | HA |\n    +----+            +------+            +------+       +----+\n\
    \      |                  |                    |            |\n      |       \
    \           |                    |   +-----------------+\n      |            \
    \      |                    |   |  HoA -> CoA_1   |\n      |                 \
    \ |                    |   | binding present |\n      |                  |   \
    \                 |   +-----------------+\n      |                  |        \
    \            |            |\n      | CoA conf/confirm |  PBU(CoA_1,MAG_2)  | \
    \           |\n      | <--------------->|  ----------------->|            |\n\
    \      |                  |              +-----------------+|\n      |       \
    \           |              | CoA_1 -> MAG_2  ||\n      |                  |  \
    \            | binding updated ||\n      |                  |              +-----------------+|\n\
    \      |                  |          PBA       |            |\n      |       \
    \           |   <----------------|            |\n      |                  |  \
    \                  |            |\n                   Figure 5: Local Mobility\
    \ Message Flow\n    +----+            +------+            +------+       +----+\n\
    \    | MN |            | MAG3 |            | LMA2 |       | HA |\n    +----+ \
    \           +------+            +------+       +----+\n      |   CoA config  \
    \   |  PBU(CoA_2,MAG_3)  |             |\n      |<---------------->|------------------->|\
    \             |\n      |                  |              +-----------------+ |\n\
    \      |                  |              | CoA_2 -> MAG_3  | |\n      |      \
    \            |              | binding created | |\n      |                  |\
    \              +-----------------+ |\n      |                  |          PBA\
    \       |             |\n      |                  |<-------------------|     \
    \        |\n      |                  |                    |             |\n  \
    \    |                  |  BU (HoA, CoA_2)   |             |\n      |---------------------------------------------------->|\n\
    \      |                  |                    |             |\n      |      \
    \            |                    |     +-----------------+\n      |         \
    \         |                    |     |  HoA -> CoA_2   |\n      |            \
    \      |                    |     | binding updated |\n      |               \
    \   |                    |     +-----------------+\n      |                  |\
    \ BA                 |             |\n      |<----------------------------------------------------|\n\
    \                  Figure 6: Global Mobility Message Flow\n"
- title: 4.2.  Solutions Related to Scenario A.2
  contents:
  - "4.2.  Solutions Related to Scenario A.2\n   As described in Section 3.2, in this\
    \ scenario, the MN relies on\n   PMIPv6 as long as it is in the PMIPv6 domain.\
    \  The MN then uses MIPv6\n   whenever it moves out of the PMIPv6 domain, which\
    \ basically implies\n   that the MIPv6 home link is a PMIPv6 domain.\n   Analyzing\
    \ the issues described in Section 3.2, it is clear that most\n   of them are applicable\
    \ only to the case where there is a common BCE\n   for the PMIPv6 registration\
    \ and the MIPv6 registration.  Issue 1, on\n   how the two protocols identify\
    \ the BCE, is valid only in the case in\n   which we assume that a PMIPv6 message\
    \ has any value for a MIPv6 BCE.\n   Also, Issues 2 and 3 are not applicable in\
    \ the case in which\n   different logical BCEs are used by the LMA and the HA.\
    \  For this\n   reason, it is recommended that when the MIPv6 home link is\n \
    \  implemented as a PMIPv6 domain, the HA/LMA implementation treat the\n   two\
    \ protocols as independent.\n   In more detail, the following principles should\
    \ be followed by the\n   HA/LMA implementation:\n   o  PMIPv6 signaling does not\
    \ overwrite any MIPv6 BCE.  In particular,\n      when a PMIPv6 BCE is created\
    \ for an MN that has previously created\n      a MIPv6 BCE, the MIPv6 BCE of the\
    \ MN is not overwritten, and a new\n      PMIPv6 BCE is created.\n   o  The downlink\
    \ packets in the case where both the MIPv6 BCE and\n      PMIPv6 BCE exist are\
    \ processed as follows:\n      1.  The MIPv6 BCE is processed first.  If the destination\
    \ address\n          of the received downlink packet matches the BCE of the HA,\
    \ the\n          packet is forwarded by encapsulating it with the CoA contained\n\
    \          in the BCE.\n      2.  If the destination address does not match the\
    \ MIPv6 BCE, the\n          BCE created by PMIPv6 is applied, and the packets\
    \ are\n          encapsulated to the registered MAG.\n   The following subsections\
    \ provide a description of the procedures\n   that will be followed by the MN\
    \ and HA/LMA based on the above\n   principles.  The analysis is performed in\
    \ two different subsections,\n   depending on whether the MN moves from a PMIPv6\
    \ domain to a non-\n   PMIPv6 domain or vice versa.\n"
- title: 4.2.1.  Mobility from a PMIPv6 Domain to a Non-PMIPv6 Domain
  contents:
  - "4.2.1.  Mobility from a PMIPv6 Domain to a Non-PMIPv6 Domain\n   Let's assume\
    \ the MN is attached to a PMIPv6 domain and there is a\n   valid Proxy BCE at\
    \ the LMA.  Then, the MN moves to a different access\n   network and starts using\
    \ MIPv6 (e.g., because PMIPv6 is not\n   supported).  The MN needs to bootstrap\
    \ MIPv6 parameters and send a\n   MIPv6 Binding Update in order to have service\
    \ continuity.  Therefore,\n   the following steps must be performed by the User\
    \ Equipment (UE):\n   o  HA/LMA address discovery: the MN needs to discover the\
    \ IP address\n      of the LMA that has a valid BCE for its home network prefix.\
    \  This\n      is described in Section 3.2 as Issue 4.\n   o  SA establishment:\
    \ the MN needs to establish an IPsec Security\n      Association with the HA/LMA\
    \ as described in [RFC4877].\n   o  HoA or home network prefix assignment: as\
    \ part of the MIPv6\n      bootstrapping procedure, the HA assigns a MIPv6 HoA\
    \ to the MN.\n      This address must be the same the MN was using in the PMIPv6\n\
    \      domain.\n   Since all these steps must be performed by the MN before sending\
    \ the\n   Binding Update, they have an impact on the handover latency\n   experienced\
    \ by the MN.  For this reason, it is recommended that the\n   MN establish the\
    \ IPsec SA (and, consequently, be provided by the HA/\n   LMA with a MIPv6-HoA)\
    \ when it is initialized.  This implies that the\n   MN has MIPv6 stack active\
    \ while in the PMIPv6 domain, but as long as\n   it is attached to the same PMIPv6\
    \ domain, it will appear to the MN as\n   if it is attached to the home link.\n\
    \   In order to establish the SA with the HA/LMA, the MN needs to\n   discover\
    \ the IP address of the LMA/HA while in the PMIPv6 domain.\n   This can be done\
    \ either based on DNS or based on DHCPv6, as described\n   in [RFC5026] and [RFC6611].\
    \  The network should be configured so that\n   the MN discovers or gets assigned\
    \ the same HA/LMA that was serving as\n   the LMA in the PMIPv6 domain.  Details\
    \ of the exact procedure are out\n   of scope of this document.\n   When the MN\
    \ establishes the SA, it acquires an HoA based on\n   [RFC5026].  However, based\
    \ on PMIPv6 operations, the LMA knows only\n   the home network prefix used by\
    \ the MN and does not know the MN-HoA.\n   For this reason, the MN must be configured\
    \ to propose the MN-HoA as\n   the HoA in the IKEv2 INTERNAL_IP6_ADDRESS attribute\
    \ during the IKEv2\n   exchange with the HA/LMA.  Alternatively, the HA/LMA can\
    \ be\n   configured to provide the entire home network prefix via the\n   MIP6_HOME_LINK\
    \ attribute to the MN as specified in [RFC5026]; based\n   on this home network\
    \ prefix, the MN can configure an HoA.  Note that\n   the SA must be bound to\
    \ the MN-HoA used in the PMIPv6 domain as per\n   [RFC4877].  Note that the home\
    \ network prefix is shared between the\n   LMA and HA, and this implies that there\
    \ is an interaction between the\n   LMA and the HA in order to assign a common\
    \ home network prefix when\n   triggered by PMIPv6 and MIPv6 signaling.\n   When\
    \ the MN hands over to an access network that does not support\n   Proxy Mobile\
    \ IPv6, it sends a Binding Update to the HA.  The MN may\n   set the R bit defined\
    \ in the Network Mobility (NEMO) specification\n   (implicit mode) [RFC3963] in\
    \ order to indicate that the entire HNP is\n   moved to the new CoA.  A MIPv6\
    \ BCE is created irrespective of the\n   existing PMIPv6 BCE.  Packets matching\
    \ the MIPv6 BCE are sent to the\n   CoA present in the MIPv6 BCE.  The PMIPv6\
    \ BCE will expire in the case\n   in which the MAG does not send a refresh PBU.\n"
- title: 4.2.2.  Mobility from a Non-PMIPv6 Domain to a PMIPv6 Domain
  contents:
  - "4.2.2.  Mobility from a Non-PMIPv6 Domain to a PMIPv6 Domain\n   In this section,\
    \ it is assumed that the MN is in a non-PMIPv6 access\n   network, and it has\
    \ bootstrapped MIPv6 operations based on [RFC5026];\n   therefore, there is valid\
    \ binding cache for its MIPv6-HoA (or HNP in\n   case of NEMO) at the HA.  Then,\
    \ the MN moves to a PMIPv6 domain that\n   is configured to be the home link for\
    \ the MIPv6-HoA the MN has been\n   assigned.\n   In order to provide session\
    \ continuity, the MAG needs to send a PBU\n   to the HA/LMA that was serving the\
    \ MN.  The MAG needs to discover the\n   HA/LMA; however, [RFC5213] assumes that\
    \ the LMA is assigned to the\n   MAG or discovered by the MAG when the MN attaches\
    \ to the MAG.  The\n   exact mechanism is not specified in [RFC5213].  A detailed\n\
    \   description of the necessary procedure is out of the scope of this\n   document.\
    \  Note that the MAG may also rely on static configuration or\n   lower-layer\
    \ information provided by the MN in order to select the\n   correct HA/LMA.\n\
    \   The PBU sent by the MAG creates a PMIPv6 BCE for the MN that is\n   independent\
    \ of the MIPv6 BCE.  Traffic destined to the MIPv6-HoA (or\n   to the HNP in case\
    \ the MN had set the flag R in the last BU) is still\n   forwarded to the CoA\
    \ present in the MIPv6 BCE.  When the MN wants to\n   use the HoA directly from\
    \ the home link, it sends a de-registration\n   message and, at that point only,\
    \ the PMIPv6 BCE is present.\n"
- title: 4.3.  Solutions Related to Scenario B
  contents:
  - "4.3.  Solutions Related to Scenario B\n   The solution for this scenario depends\
    \ on the access network being\n   able to determine that a particular MN wants\
    \ to use Mobile IPv6.\n   This requires a solution at the system level for the\
    \ access network\n   and may require knowledge of the detailed configuration and\
    \ software\n   capabilities of every MN in the system.  These issues are out of\
    \ the\n   scope of this document.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   Scenario A.1 does not introduce any new security\
    \ issues in addition\n   to those described in [RFC5213] or [RFC6275].\n   For\
    \ Scenario A.2, this document requires that the a home agent that\n   also implements\
    \ the PMIPv6 LMA functionality should allow both the MN\n   and the authorized\
    \ MAGs to modify the BCEs for the MN.  Note that the\n   compromised MAG threat\
    \ described in [RFC4832] also applies here in a\n   more severe form as explained\
    \ in Section 3.2.  Scenario B relies on\n   the secure identification of MNs and\
    \ their capabilities so that the\n   right service can be provided for the right\
    \ MNs.  For instance, a\n   malicious MN should not get the HoA of some other\
    \ node assigned to\n   it, and a MN that desires to employ its own mobility management\n\
    \   should be able to do so.  The ability to identify nodes is already a\n   requirement\
    \ in [RFC5213], but Scenario B adds a requirement on\n   identification of node\
    \ capabilities.\n"
- title: 6.  Contributors
  contents:
  - "6.  Contributors\n   Kuntal Chowdhury - kuntal@hotmail.com\n   Vijay Devarapalli\
    \ - vijay.devarapalli@azairenet.com\n   Sri Gundavelli - sgundave@cisco.com\n\
    \   Suresh Krishnan - suresh.krishnan@ericsson.com\n   Ahmad Muhanna - amuhanna@nortel.com\n\
    \   Hesham Soliman - Hesham@elevatemobile.com\n   George Tsirtsis - tsirtsis@googlemail.com\n\
    \   Genadi Velev - Genadi.Velev@eu.panasonic.com\n   Kilian Weniger - Kilian.Weniger@googlemail.com\n"
- title: 7.  Acknowledgements
  contents:
  - "7.  Acknowledgements\n   This document is a merge of four different documents:\
    \ \"Proxy Mobile\n   IPv6 and Mobile IPv6 interworking issues\" (April 2007),\
    \ \"Proxy Mobile\n   IPv6 and Mobile IPv6 interworking\" (April 2007), \"Behavior\
    \ of\n   Collocated HA/LMA\" (October 2008), and \"Interactions between PMIPv6\n\
    \   and MIPv6: scenarios and related issues\" (November 2007).  Thanks to\n  \
    \ the authors and editors of those documents.\n   The authors would also like\
    \ to thank Jonne Soininen and Vidya\n   Narayanan, NETLMM WG chairs, for their\
    \ support.\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.  Normative References
  contents:
  - "8.1.  Normative References\n   [RFC3963]  Devarapalli, V., Wakikawa, R., Petrescu,\
    \ A., and P.\n              Thubert, \"Network Mobility (NEMO) Basic Support Protocol\"\
    ,\n              RFC 3963, January 2005.\n   [RFC4832]  Vogt, C. and J. Kempf,\
    \ \"Security Threats to Network-Based\n              Localized Mobility Management\
    \ (NETLMM)\", RFC 4832,\n              April 2007.\n   [RFC4877]  Devarapalli,\
    \ V. and F. Dupont, \"Mobile IPv6 Operation with\n              IKEv2 and the\
    \ Revised IPsec Architecture\", RFC 4877,\n              April 2007.\n   [RFC5026]\
    \  Giaretta, G., Kempf, J., and V. Devarapalli, \"Mobile IPv6\n              Bootstrapping\
    \ in Split Scenario\", RFC 5026, October 2007.\n   [RFC5213]  Gundavelli, S.,\
    \ Leung, K., Devarapalli, V., Chowdhury, K.,\n              and B. Patil, \"Proxy\
    \ Mobile IPv6\", RFC 5213, August 2008.\n   [RFC5380]  Soliman, H., Castelluccia,\
    \ C., ElMalki, K., and L.\n              Bellier, \"Hierarchical Mobile IPv6 (HMIPv6)\
    \ Mobility\n              Management\", RFC 5380, October 2008.\n   [RFC6275]\
    \  Perkins, C., Johnson, D., and J. Arkko, \"Mobility Support\n              in\
    \ IPv6\", RFC 6275, July 2011.\n   [RFC6611]  Chowdhury, K., Ed. and A. Yegin,\
    \ \"Mobile IPv6 (MIPv6)\n              Bootstrapping for the Integrated Scenario\"\
    , RFC 6611,\n              May 2012.\n"
- title: 8.2.  Informative References
  contents:
  - "8.2.  Informative References\n   [RFC3753]  Manner, J. and M. Kojo, \"Mobility\
    \ Related Terminology\",\n              RFC 3753, June 2004.\n   [RFC4283]  Patel,\
    \ A., Leung, K., Khalil, M., Akhtar, H., and K.\n              Chowdhury, \"Mobile\
    \ Node Identifier Option for Mobile IPv6\n              (MIPv6)\", RFC 4283, November\
    \ 2005.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Gerardo Giaretta (editor)\n   Qualcomm\n   EMail: gerardog@qualcomm.com\n"
