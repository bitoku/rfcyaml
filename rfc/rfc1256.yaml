- contents:
  - '                     ICMP Router Discovery Messages

    '
  title: __initial_text__
- contents:
  - "Status of this Memo\n   This RFC specifies an IAB standards track protocol for
    the Internet\n   community, and requests discussion and suggestions for improvements.\n
    \  Please refer to the current edition of the \"IAB Official Protocol\n   Standards\"
    for the standardization state and status of this protocol.\n   This document is
    a product of the IETF Router Discovery Working\n   Group.  Distribution of this
    memo is unlimited.\n"
  title: Status of this Memo
- contents:
  - "Abstract\n   This document specifies an extension of the Internet Control Message\n
    \  Protocol (ICMP) to enable hosts attached to multicast or broadcast\n   networks
    to discover the IP addresses of their neighboring routers.\n"
  title: Abstract
- contents:
  - "Table of Contents\n   1. Terminology                                                      1\n
    \  2. Protocol Overview                                                3\n   3.
    Message Formats                                                  5\n   4. Router
    Specification                                             7\n        4.1. Router
    Configuration Variables                            7\n        4.2. Message Validation
    by Routers                             9\n        4.3. Router Behavior                                           9\n
    \  5. Host Specification                                              12\n        5.1.
    Host Configuration Variables                             12\n        5.2. Message
    Validation by Hosts                              13\n        5.3. Host Behavior
    \                                           14\n   6. Protocol Constants                                              17\n
    \  7. Security Considerations                                         17\n   References
    \                                                        18\n   Author's Address
    \                                                  19\n"
  title: Table of Contents
- contents:
  - "1. Terminology\n   The following terms have a precise meaning when used in this\n
    \  document:\n   system        a device that implements the Internet Protocol,
    IP [9].\n   router        a system that forwards IP datagrams, as specified\n
    \                in [2].  This does not include systems that, though\n                 capable
    of IP forwarding, have that capability turned\n                 off.  Nor does
    it include systems that do IP forwarding\n                 only insofar as required
    to obey IP Source Route\n                 options.\n   host          any system
    that is not a router.\n   multicast     unless otherwise qualified, means the
    use of either IP\n                 multicast [4] or IP broadcast [6] service.\n
    \  link          a communication facility or medium over which systems\n                 can
    communicate at the link layer, i.e., the protocol\n                 layer immediately
    below IP.  The term \"physical\n                 network\" has sometimes been
    used (imprecisely) for\n                 this. Examples of links are LANs (possibly
    bridged to\n                 other LANs), wide-area store-and-forward networks,\n
    \                satellite channels, and point-to-point links.\n   multicast link\n
    \                a link over which IP multicast or IP broadcast service\n                 is
    supported.  This includes broadcast media such as\n                 LANs and satellite
    channels, single point-to-point\n                 links, and some store-and-forward
    networks such as SMDS\n                 networks [8].\n   interface     a system's
    attachment point to a link.  It is possible\n                 (though unusual)
    for a system to have more than one\n                 interface to the same link.
    \ Interfaces are uniquely\n                 identified by IP unicast addresses;
    a single interface\n                 may have more than one such address.\n   multicast
    interface\n                 an interface to a multicast link, that is, an interface\n
    \                to a link over which IP multicast or IP broadcast\n                 service
    is supported.\n   subnet        either a single subnet of a subnetted IP network
    [7] or\n                 a single non-subnetted IP network, i.e., the entity\n
    \                identified by an IP address logically ANDed with its\n                 assigned
    subnet mask.  More than one subnet may exist\n                 on the same link.\n
    \  neighboring   having an IP address belonging to the same subnet.\n"
  title: 1. Terminology
- contents:
  - "2. Protocol Overview\n   Before a host can send IP datagrams beyond its directly-attached\n
    \  subnet, it must discover the address of at least one operational\n   router
    on that subnet. Typically, this is accomplished by reading a\n   list of one or
    more router addresses from a (possibly remote)\n   configuration file at startup
    time.  On multicast links, some hosts\n   also discover router addresses by listening
    to routing protocol\n   traffic.  Both of these methods have serious drawbacks:
    configuration\n   files must be maintained manually -- a significant administrative\n
    \  burden -- and are unable to track dynamic changes in router\n   availability;
    eavesdropping on routing traffic requires that hosts\n   recognize the particular
    routing protocols in use, which vary from\n   subnet to subnet and which are subject
    to change at any time.  This\n   document specifies an alternative router discovery
    method using a\n   pair of ICMP [10] messages, for use on multicast links.  It\n
    \  eliminates the need for manual configuration of router addresses and\n   is
    independent of any specific routing protocol.\n   The ICMP router discovery messages
    are called \"Router Advertisements\"\n   and \"Router Solicitations\".  Each router
    periodically multicasts a\n   Router Advertisement from each of its multicast
    interfaces,\n   announcing the IP address(es) of that interface.  Hosts discover
    the\n   addresses of their neighboring routers simply by listening for\n   advertisements.
    \ When a host attached to a multicast link starts up,\n   it may multicast a Router
    Solicitation to ask for immediate\n   advertisements, rather than waiting for
    the next periodic ones to\n   arrive; if (and only if) no advertisements are forthcoming,
    the host\n   may retransmit the solicitation a small number of times, but then\n
    \  must desist from sending any more solicitations.  Any routers that\n   subsequently
    start up, or that were not discovered because of packet\n   loss or temporary
    link partitioning, are eventually discovered by\n   reception of their periodic
    (unsolicited) advertisements.  (Links\n   that suffer high packet loss rates or
    frequent partitioning are\n   accommodated by increasing the rate of advertisements,
    rather than\n   increasing the number of solicitations that hosts are permitted
    to\n   send.)\n   The router discovery messages do not constitute a routing protocol:\n
    \  they enable hosts to discover the existence of neighboring routers,\n   but
    not which router is best to reach a particular destination.  If a\n   host chooses
    a poor first-hop router for a particular destination, it\n   should receive an
    ICMP Redirect from that router, identifying a\n   better one.\n   A Router Advertisement
    includes a \"preference level\" for each\n   advertised router address.  When
    a host must choose a default router\n   address (i.e., when, for a particular
    destination, the host has not\n   been redirected or configured to use a specific
    router address), it\n   is expected to choose from those router addresses that
    have the\n   highest preference level (see Section 3.3.1 in the Host Requirements\n
    \  -- Communication Layers RFC [1]).  A network administrator can\n   configure
    router address preference levels to encourage or discourage\n   the use of particular
    routers as default routers.\n   A Router Advertisement also includes a \"lifetime\"
    field, specifying\n   the maximum length of time that the advertised addresses
    are to be\n   considered as valid router addresses by hosts, in the absence of\n
    \  further advertisements.  This is used to ensure that hosts eventually\n   forget
    about routers that fail, become unreachable, or stop acting as\n   routers.\n
    \  The default advertising rate is once every 7 to 10 minutes, and the\n   default
    lifetime is 30 minutes.  This means that, using the default\n   values, the advertisements
    are not sufficient as a mechanism for\n   \"black hole\" detection, i.e., detection
    of failure of the first hop\n   of an active path -- ideally, black holes should
    be detected quickly\n   enough to switch to another router before any transport
    connections\n   or higher-layer sessions time out.  It is assumed that hosts already\n
    \  have mechanisms for black hole detection, as required by [1].  Hosts\n   cannot
    depend on Router Advertisements for this purpose, since they\n   may be unavailable
    or administratively disabled on any particular\n   link or from any particular
    router.  Therefore, the default\n   advertising rate and lifetime values were
    chosen simply to make the\n   load imposed on links and hosts by the periodic
    multicast\n   advertisements negligible, even when there are many routers present.\n
    \  However, a network administrator who wishes to employ advertisements\n   as
    a supplemental black hole detection mechanism is free to configure\n   smaller
    values.\n"
  title: 2. Protocol Overview
- contents:
  - "3. Message Formats\n   ICMP Router Advertisement Message\n       0                   1
    \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
    5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |     Type      |     Code      |           Checksum            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |   Num Addrs   |Addr Entry Size|           Lifetime            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                       Router Address[1]                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                      Preference Level[1]                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                       Router Address[2]                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                      Preference Level[2]                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                               .                               |\n      |
    \                              .                               |\n      |                               .
    \                              |\n   IP Fields:\n      Source Address        An
    IP address belonging to the interface\n                            from which
    this message is sent.\n      Destination Address   The configured AdvertisementAddress
    or the\n                            IP address of a neighboring host.\n      Time-to-Live
    \         1 if the Destination Address is an IP\n                            multicast
    address; at least 1 otherwise.\n   ICMP Fields:\n      Type                  9\n
    \     Code                  0\n      Checksum              The  16-bit one's complement
    of the one's\n                            complement sum of the ICMP message,
    start-\n                            ing with the ICMP Type.  For computing the\n
    \                           checksum, the Checksum field is set to 0.\n      Num
    Addrs             The number of router addresses advertised\n                            in
    this message.\n      Addr Entry Size       The number of 32-bit words of information\n
    \                           per each router address (2, in the version\n                            of
    the protocol described here).\n      Lifetime              The maximum number
    of seconds that the\n                            router addresses may be considered
    valid.\n      Router Address[i],    The sending router's IP address(es) on the\n
    \      i = 1..Num Addrs     interface from which this message is sent.\n      Preference
    Level[i],  The preferability of each Router Address[i]\n       i = 1..Num Addrs
    \    as a default router address, relative to\n                            other
    router addresses on the same subnet.\n                            A signed, twos-complement
    value; higher\n                            values mean more preferable.\n   ICMP
    Router Solicitation Message\n       0                   1                   2
    \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
    5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |     Type      |     Code      |           Checksum            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                           Reserved                            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  IP Fields:\n      Source Address        An IP address belonging to the interface\n
    \                           from which this message is sent, or 0.\n      Destination
    Address   The configured SolicitationAddress.\n      Time-to-Live          1 if
    the Destination Address is an IP\n                            multicast address;
    at least 1 otherwise.\n   ICMP Fields:\n      Type                  10\n      Code
    \                 0\n      Checksum              The  16-bit one's complement
    of the one's\n                            complement sum of the ICMP message,
    start-\n                            ing with the ICMP Type.  For computing the\n
    \                           checksum, the Checksum field is set to 0.\n      Reserved
    \             Sent as 0; ignored on reception.\n"
  title: 3. Message Formats
- contents:
  - '4. Router Specification

    '
  - contents:
    - "4.1. Router Configuration Variables\n   A router that implements the ICMP router
      discovery messages must\n   allow for the following variables to be configured
      by system\n   management; default values are specified so as to make it unnecessary\n
      \  to configure any of these variables in many cases.\n   For each multicast
      interface:\n   AdvertisementAddress\n                 The IP destination address
      to be used for multicast\n                 Router Advertisements sent from the
      interface.  The\n                 only permissible values are the all-systems
      multicast\n                 address, 224.0.0.1, or the limited-broadcast address,\n
      \                255.255.255.255.  (The all-systems address is preferred\n                 wherever
      possible, i.e., on any link where all\n                 listening hosts support
      IP multicast.)\n                 Default: 224.0.0.1 if the router supports IP
      multicast\n                 on the interface, else 255.255.255.255\n   MaxAdvertisementInterval\n
      \                The maximum time allowed between sending multicast\n                 Router
      Advertisements from the interface, in seconds.\n                 Must be no
      less than 4 seconds and no greater than 1800\n                 seconds.\n                 Default:
      600 seconds\n   MinAdvertisementInterval\n                 The minimum time
      allowed between sending unsolicited\n                 multicast Router Advertisements
      from the interface, in\n                 seconds.  Must be no less than 3 seconds
      and no greater\n                 than MaxAdvertisementInterval.\n                 Default:
      0.75 * MaxAdvertisementInterval\n   AdvertisementLifetime\n                 The
      value to be placed in the Lifetime field of Router\n                 Advertisements
      sent from the interface, in seconds.\n                 Must be no less than
      MaxAdvertisementInterval and no\n                 greater than 9000 seconds.\n
      \                Default: 3 * MaxAdvertisementInterval\n   For each of the router's
      IP addresses on its multicast interfaces:\n   Advertise\n                 A
      flag indicating whether or not the address is to be\n                 advertised.\n
      \                Default: TRUE\n   PreferenceLevel\n                 The preferability
      of the address as a default router\n                 address, relative to other
      router addresses on the same\n                 subnet.  A 32-bit, signed, twos-complement
      integer,\n                 with higher values meaning more preferable.  The\n
      \                minimum value (hex 80000000) is used to indicate that\n                 the
      address, even though it may be advertised, is not\n                 to be used
      by neighboring hosts as a default router\n                 address.\n                 Default:
      0\n   The case in which it is useful to configure an address with a\n   preference
      level of hex 80000000 (rather than simply setting its\n   Advertise flag to
      FALSE) is when advertisements are being used for\n   \"black hole\" detection,
      as mentioned in Section 2.  In particular, a\n   router that is to be used to
      reach only specific IP destinations\n   could advertise its address with a preference
      level of hex 80000000\n   (so that neighboring hosts will not use it as a default
      router for\n   reaching arbitrary IP destinations) and a non-zero lifetime (so
      that\n   neighboring hosts that have been redirected or configured to use it\n
      \  can detect its failure by timing out the reception of its\n   advertisements).\n
      \  It has been suggested that, when the preference level of an address\n   has
      not been explicitly configured, a router could set it according\n   to the metric
      of the router's \"default route\" (if it has one), rather\n   than defaulting
      it to zero as suggested above.  Thus, a router with a\n   better metric for
      its default route would advertise a higher\n   preference level for its address.
      \ (Note that routing metrics that\n   are encoded such that \"lower is better\"
      would have to be inverted\n   before being used as preference levels in Router
      Advertisement\n   messages.)  Such a strategy might reduce the amount of ICMP
      Redirect\n   traffic on some links by making it more likely that a host's first\n
      \  choice router for reaching an arbitrary destination is also the best\n   choice.
      \ On the other hand, Redirect traffic is rarely a significant\n   load on a
      link, and there are some cases where such a strategy would\n   result in more
      Redirect traffic, not less (for example, on links from\n   which the most frequently
      chosen destinations are best reached via\n   routers other than the one with
      the best default route).  This\n   document makes no recommendation concerning
      this issue, and\n   implementors are free to try such a strategy, as long as
      they also\n   support static configuration of preference levels as specified
      above.\n"
    title: 4.1. Router Configuration Variables
  - contents:
    - "4.2. Message Validation by Routers\n   A router must silently discard any received
      Router Solicitation\n   messages that do not satisfy the following validity
      checks:\n      - IP Source Address is either 0 or the address of a neighbor\n
      \       (i.e., an address that matches one of the router's own\n        addresses
      on the arrival interface, under the subnet mask\n        associated with that
      address.)\n      - ICMP Checksum is valid.\n      - ICMP Code is 0.\n      -
      ICMP length (derived from the IP length) is 8 or more\n        octets.\n   The
      contents of the ICMP Reserved field, and of any octets beyond the\n   first
      8, are ignored.  Future, backward-compatible changes to the\n   protocol may
      specify the contents of the Reserved field or of\n   additional octets at the
      end of the message; backward-incompatible\n   changes may use different Code
      values.\n   A solicitation that passes the validity checks is called a \"valid\n
      \  solicitation\".\n   A router may silently discard any received Router Advertisement\n
      \  messages.  Any other action on reception of such messages by a router\n   (for
      example, as part of a \"peer discovery\" process) is beyond the\n   scope of
      this document.\n"
    title: 4.2. Message Validation by Routers
  - contents:
    - "4.3. Router Behavior\n   The router joins the all-routers IP multicast group
      (224.0.0.2) on\n   all interfaces on which the router supports IP multicast.\n
      \  The term \"advertising interface\" refers to any functioning and\n   enabled
      multicast interface that has at least one IP address whose\n   configured Advertise
      flag is TRUE.  From each advertising interface,\n   the router transmits periodic,
      multicast Router Advertisements,\n   containing the following values:\n      -
      In the destination address field of the IP header: the\n        interface's
      configured AdvertisementAddress.\n      - In the Lifetime field: the interface's
      configured\n        AdvertisementLifetime.\n      - In the Router Address[i]
      and Preference Level[i] fields:\n        all of the interface's addresses whose
      Advertise flags are\n        TRUE, along with their corresponding PreferenceLevel\n
      \       values.  (In the unlikely event that not all addresses fit\n        in
      a single advertisement, as constrained by the MTU of the\n        link, multiple
      advertisements are sent, with each except\n        the last containing as many
      addresses as can fit.)\n   The advertisements are not strictly periodic: the
      interval between\n   subsequent transmissions is randomized to reduce the probability
      of\n   synchronization with the advertisements from other routers on the\n   same
      link. This is done by maintaining a separate transmission\n   interval timer
      for each advertising interface.  Each time a multicast\n   advertisement is
      sent from an interface, that interface's timer is\n   reset to a uniformly-distributed
      random value between the interface's\n   configured MinAdvertisementInterval
      and MaxAdvertisementInterval;\n   expiration of the timer causes the next advertisement
      to be sent from\n   the interface, and a new random value to be chosen.  (It
      is\n   recommended that routers include some unique value, such as one of\n
      \  their IP or link-layer addresses, in the seed used to initialize\n   their
      pseudo-random number generators.  Although the randomization\n   range is configured
      in units of seconds, the actual randomly-chosen\n   values should not be in
      units of whole seconds, but rather in units\n   of the highest available timer
      resolution.)\n   For the first few advertisements sent from an interface (up
      to\n   MAX_INITIAL_ADVERTISEMENTS), if the randomly chosen interval is\n   greater
      than MAX_INITIAL_ADVERT_INTERVAL, the timer should be set to\n   MAX_INITIAL_ADVERT_INTERVAL
      instead.  Using this smaller interval for\n   the initial advertisements increases
      the likelihood of a router being\n   discovered quickly when it first becomes
      available, in the presence\n   of possible packet loss.\n   In addition to the
      periodic, unsolicited advertisements, a router\n   sends advertisements in response
      to valid solicitations received on\n   any of its advertising interfaces.  A
      router may choose to unicast\n   the response directly to the soliciting host's
      address (if it is not\n   zero), or multicast it to the interface's configured\n
      \  AdvertisementAddress; in the latter case, the interface's interval\n   timer
      is reset to a new random value, as with unsolicited\n   advertisements.  A unicast
      response may be delayed, and a multicast\n   response must be delayed, for a
      small random interval not greater\n   than MAX_RESPONSE_DELAY, in order to prevent
      synchronization with\n   other responding routers, and to allow multiple, closely-spaced\n
      \  solicitations to be answered with a single multicast advertisement.\n   If
      a router receives a solicitation sent to an IP broadcast address,\n   on an
      interface whose configured AdvertisementAddress is an IP\n   multicast address,
      the router may send its response to the IP\n   broadcast address instead of
      the configured IP multicast address.\n   Such an event indicates a configuration
      inconsistency, and should be\n   logged for possible corrective action by the
      network administrator.\n   It should be noted that an interface may become an
      advertising\n   interface at times other than system startup, as a result of
      recovery\n   from an interface failure or through actions of system management\n
      \  such as:\n      - enabling the interface, if it had been administratively\n
      \       disabled and it has one or more addresses whose Advertise\n        flag
      is TRUE, or\n      - enabling IP forwarding capability (i.e., changing the\n
      \       system from being a host to being a router), when the\n        interface
      has one or more addresses whose Advertise flag is\n        TRUE, or\n      -
      setting the Advertise flag of one or more of the\n        interface's addresses
      to TRUE (or adding a new address with\n        a TRUE Advertise flag), when
      previously the interface had\n        no address whose Advertise flag was TRUE.\n"
    - 'In such cases, the router must commence transmission of periodic

      '
    - 'advertisements on the new advertising interface, limiting the first few

      '
    - 'advertisements to intervals no greater than MAX_INITIAL_ADVERT_INTERVAL.

      '
    - 'In the case of a host becoming a router, the system must also join the

      '
    - 'all-routers IP multicast group on all interfaces on which the router

      '
    - 'supports IP multicast (whether or not they are advertising interfaces).

      '
    - 'An interface may also cease to be an advertising interface, through

      '
    - "actions of system management such as:\n      - administratively disabling the
      interface,\n      - shutting down the system, or disabling the IP forwarding\n
      \       capability (i.e., changing the system from being a router\n        to
      being a host), or\n      - setting the Advertise flags of all of the interface's\n
      \       addresses to FALSE.\n   In such cases, it is recommended (but not required)
      that the router\n   transmit a final multicast advertisement on the interface,
      identical\n   to its previous transmission but with a Lifetime field of zero.
      \ In\n   the case of a router becoming a host, the system must also depart\n
      \  from the all-routers IP multicast group on all interfaces on which\n   the
      router supports IP multicast (whether or not they had been\n   advertising interfaces).\n
      \  When the Advertise flag of one or more of an interface's addresses\n   are
      set to FALSE by system management, but there remain other\n   addresses on that
      interface whose Advertise flags are TRUE, it is\n   recommended that the router
      send a single multicast advertisement\n   containing only those address whose
      Advertise flags were set to\n   FALSE, with a Lifetime field of zero.\n"
    title: 4.3. Router Behavior
  title: 4. Router Specification
- contents:
  - '5. Host Specification

    '
  - contents:
    - "5.1. Host Configuration Variables\n   A host that implements the ICMP router
      discovery messages must allow\n   for the following variables to be configured
      by system management;\n   default values are specified so as to make it unnecessary
      to\n   configure any of these variables in many cases.\n   For each multicast
      interface:\n   PerformRouterDiscovery\n                 A flag indicating whether
      or not the host is to perform\n                 ICMP router discovery on the
      interface.\n                 Default: TRUE\n   SolicitationAddress\n                 The
      IP destination address to be used for sending\n                 Router Solicitations
      from the interface.  The only\n                 permissible values are the all-routers
      multicast\n                 address, 224.0.0.2, or the limited-broadcast address,\n
      \                255.255.255.255.  (The all-routers address is preferred\n                 wherever
      possible, i.e., on any link where all\n                 advertising routers
      support IP multicast.)\n                 Default: 224.0.0.2 if the host supports
      IP multicast on\n                 the interface, else 255.255.255.255\n   The
      Host Requirements -- Communication Layers RFC [1], Section\n   3.3.1.6, specifies
      that each host implementation must support a\n   configurable list of default
      router addresses.  The purpose of the\n   ICMP router discovery messages is
      to eliminate the need to configure\n   that list in hosts attached to multicast
      links.  On non-multicast\n   links, and on multicast links for which ICMP router
      discovery is not\n   (yet) supported by the routers or is administratively disabled,
      it\n   will continue to be necessary to configure the default router list in\n
      \  each host.  Each entry in the list contains (at least) the following\n   configurable
      variables:\n   RouterAddress\n                 An IP address of a default router.\n
      \                Default: (none)\n   PreferenceLevel\n                 The preferability
      of the RouterAddress as a default\n                 router address, relative
      to other router addresses on\n                 the same subnet.  The Host Requirements
      RFC does not\n                 specify how this value is to be encoded; to allow
      the\n                 preference level to be conveyed in a Router\n                 Advertisement
      or configured by system management, it is\n                 here specified that
      it be encoded as a 32-bit, signed,\n                 twos-complement integer,
      with higher values meaning\n                 more preferable.  The minimum value
      (hex 80000000) is\n                 reserved to mean that the address is not
      to be used as\n                 a default router address, i.e., it is to be
      used only\n                 for specific IP destinations, of which the host
      has\n                 been informed by ICMP Redirect or configuration.\n                 Default:
      0\n"
    title: 5.1. Host Configuration Variables
  - contents:
    - "5.2. Message Validation by Hosts\n   A host must silently discard any received
      Router Advertisement\n   messages that do not satisfy the following validity
      checks:\n      - ICMP Checksum is valid.\n      - ICMP Code is 0.\n      - ICMP
      Num Addrs is greater than or equal to 1.\n      - ICMP Addr Entry Size is greater
      than or equal to 2.\n      - ICMP length (derived from the IP length) is greater
      than or\n        equal to 8 + (Num Addrs * Addr Entry Size * 4) octets.\n   The
      contents of any additional words of per-address information\n   (i.e., other
      than the Router Address and Preference Level fields),\n   and the contents of
      any octets beyond the first 8 + (Num Addrs * Addr\n   Entry Size * 4) octets,
      are ignored.  Future, backward-compatible\n   changes to the protocol may specify
      additional per-address\n   information words, or additional octets at the end
      of the message;\n   backward-incompatible changes may use different Code values.\n
      \  An advertisement that passes the validity checks is called a \"valid\n   advertisement\".\n
      \  A host must silently discard any received Router Solicitation\n   messages.\n"
    title: 5.2. Message Validation by Hosts
  - contents:
    - "5.3. Host Behavior\n   On any interface on which the host supports IP multicast,
      the host\n   will be a member of the all-systems IP multicast group (224.0.0.1).\n
      \  This occurs automatically, as specified in [4]; no explicit action is\n   required
      on the part of the router discovery protocol implementation.\n   A host never
      sends a Router Advertisement message.\n   A host silently discards any Router
      Advertisement message that\n   arrives on an interface for which the host's
      configured\n   PerformRouterDiscovery flag is FALSE, and it never sends a Router\n
      \  Solicitation on such an interface.\n   A host cannot process an advertisement
      until it has determined its\n   own IP address(es) and subnet mask(s) for the
      interface on which the\n   advertisement is received.  (On some links, a host
      may be able to use\n   some combination of BOOTP [3], RARP [5], or ICMP Address
      Mask\n   messages [7] to discover its own address and mask.)  While waiting
      to\n   learn the address and mask of an interface, a host may save any valid\n
      \  advertisements received on that interface for later processing; this\n   allows
      router discovery and address/mask discovery to proceed in\n   parallel.\n   To
      process an advertisement, a host scans the list of router\n   addresses contained
      in it. It ignores any non-neighboring addresses,\n   i.e., addresses that do
      not match one of the host's own addresses on\n   the arrival interface, under
      the subnet mask associated with that\n   address.  For each neighboring address,
      the host does the following:\n      - If the address is not already present
      in the host's default\n        router list, a new entry is added to the list,
      containing\n        the address along with its accompanying preference level\n
      \       and a timer initialized to the Lifetime value from the\n        advertisement.\n
      \     - If the address is already present in the host's default\n        router
      list as a result of a previously-received\n        advertisement, its preference
      level is updated and its\n        timer is reset to the values in the newly-received\n
      \       advertisement.\n      - If the address is already present in the host's
      default\n        router list as a result of system configuration, no change\n
      \       is made to its preference level; there is no timer\n        associated
      with a configured address.  (Note that any\n        router addresses acquired
      from the \"Gateway\" subfield of\n        the vendor extensions field of a BOOTP
      packet [11] are\n        considered to be configured addresses; they are assigned\n
      \       the default preference level of zero, and they do not have\n        an
      associated timer.  Note further that any address found\n        in the \"giaddr\"
      field of a BOOTP packet [3] identifies a\n        BOOTP forwarder which is not
      necessarily an IP router; such\n        an address should not be installed in
      the host's default\n        router list.)\n   Whenever the timer expires in
      any entry that was created as a result\n   of a received advertisement, that
      entry is discarded.\n   To limit the storage needed for the default router list,
      a host may\n   choose not to store all of the router addresses discovered via\n
      \  advertisements.  If so, the host should discard those addresses with\n   lower
      preference levels in favor of those with higher levels.  It is\n   desirable
      to retain more than one default router address in the list\n   so that, if the
      current choice of default router is discovered to be\n   down, the host may
      immediately choose another default router, without\n   having to wait for the
      next advertisement to arrive.\n   Any router address advertised with a preference
      level of hex 80000000\n   is not to be used by the host as default router address;
      such an\n   address may be omitted from the default router list, unless its
      timer\n   is being use as a \"black-hole\" detection mechanism, as discussed
      in\n   Section 4.1.\n   It should be understood that preference levels learned
      from\n   advertisements do not affect any of the host's cached route entries.\n
      \  For example, if the host has been redirected to use a particular\n   router
      address to reach a specific IP destination, it continues to\n   use that router
      address for that destination, even if it discovers\n   another router address
      with a higher preference level.  Preference\n   levels influence the choice
      of router only for an IP destination for\n   which there is no cached or configured
      route, or whose cached route\n   points to a router that is subsequently discovered
      to be dead or\n   unreachable.\n   A host is permitted (but not required) to
      transmit up to\n   MAX_SOLICITATIONS Router Solicitation messages from any of
      its\n   multicast interfaces after any of the following events:\n      - The
      interface is initialized at system startup time.\n      - The interface is reinitialized
      after a temporary interface\n        failure or after being temporarily disabled
      by system\n        management.\n      - The system changes from being a router
      to being a host, by\n        having its IP forwarding capability turned off
      by system\n        management.\n      - The PerformRouterDiscovery flag for
      the interface is\n        changed from FALSE to TRUE by system management.\n
      \  The IP destination address of the solicitations is the configured\n   SolicitationAddress
      for the interface.  The IP source address may\n   contain zero if the host has
      not yet determined an address for the\n   interface; otherwise it contains one
      of the interface's addresses.\n   If a host does choose to send a solicitation
      after one of the above\n   events, it should delay that transmission for a random
      amount of time\n   between 0 and MAX_SOLICITATION_DELAY.  This serves to alleviate\n
      \  congestion when many hosts start up on a link at the same time, such\n   as
      might happen after recovery from a power failure.  (It is\n   recommended that
      hosts include some unique value, such as one of\n   their IP or link-layer addresses,
      in the seed used to initialize\n   their pseudo-random number generators.  Although
      the randomization\n   range is specified in units of seconds, the actual randomly-chosen\n
      \  value should not be in units of whole seconds, but rather in units of\n   the
      highest available timer resolution.)\n   A host may also choose to further postpone
      its solicitations,\n   subsequent to one of the above events, until the first
      time it needs\n   to use a default router.\n   Upon receiving a valid advertisement
      containing at least one\n   neighboring address whose preference level is other
      than hex\n   80000000, subsequent to one of the above events, the host must
      desist\n   from sending any solicitations on that interface (even if none have\n
      \  been sent yet), until the next time one of the above events occurs.\n   The
      small number of retransmissions of a solicitation, which are\n   permitted if
      no such advertisement is received, should be sent at\n   intervals of SOLICITATION_INTERVAL
      seconds, without randomization.\n"
    title: 5.3. Host Behavior
  title: 5. Host Specification
- contents:
  - "6. Protocol Constants\n   Router constants:\n         MAX_INITIAL_ADVERT_INTERVAL
    \      16 seconds\n         MAX_INITIAL_ADVERTISEMENTS        3 transmissions\n
    \        MAX_RESPONSE_DELAY                2 seconds\n   Host constants:\n         MAX_SOLICITATION_DELAY
    \           1 second\n         SOLICITATION_INTERVAL             3 seconds\n         MAX_SOLICITATIONS
    \                3 transmissions\n   Additional protocol constants are defined
    with the message formats in\n   Section 3, and with the router and host configuration
    variables in\n   Sections 4.1 and 5.1.\n   All protocol constants are subject
    to change in future revisions of\n   the protocol.\n"
  title: 6. Protocol Constants
- contents:
  - "7. Security Considerations\n   This extension of ICMP makes it possible for any
    system attached to a\n   link to masquerade as a default router for hosts attached
    to that\n   link.  Any traffic sent to such an imposter is vulnerable to\n   eavesdropping,
    to denial of forwarding service, and to modification\n   by insertion, deletion,
    or alteration of packets.  It should be noted\n   that, on most multicast or broadcast
    links on which this protocol is\n   expected to operate, eavesdropping is already
    possible by any system\n   attached to the link, and the Address Resolution Protocol
    (ARP) used\n   on those links offers a similar opportunity for service denial
    and\n   message stream modification.  For environments where those threats\n   are
    deemed unacceptable, there are configuration variables to disable\n   dynamic
    router discovery by hosts.\n   The Router Advertisement message format is defined
    so as to allow\n   additional information to be added to the message in a backward-\n
    \  compatible manner.  One possible use of that capability is to add\n   digital
    signatures or some other form of authentication information\n   to the advertisements,
    to enable hosts to verify their authenticity.\n   This is FOR FURTHER STUDY.\n"
  title: 7. Security Considerations
- contents:
  - "References\n   [1] Braden, R., Editor, \"Requirements for Internet Hosts --\n
    \      Communication Layers\", RFC 1122, USC/Information Sciences\n       Institute,
    October 1989.\n   [2] Braden, R., and J. Postel, \"Requirements for Internet Gateways\",\n
    \      RFC 1009, USC/Information Sciences Institute, June 1987.\n   [3] Croft,
    B, and J. Gilmore, \"Bootstrap Protocol (BOOTP)\", RFC 951,\n       Stanford and
    SUN Microsystems, September 1985.\n   [4] Deering, S., \"Host Extensions for IP
    Multicasting\", RFC 1112,\n       Stanford University, August 1989.\n   [5] Finlayson,
    R., Mann, T., Mogul J., and M. Theimer, \"A Reverse\n       Address Resolution
    Protocol\", RFC 903, Stanford University, June\n       1984.\n   [6] Mogul, J.,
    \"Broadcasting Internet Datagrams\", RFC 919, Stanford\n       University, October
    1984.\n   [7] Mogul J., and J. Postel, \"Internet Standard Subnetting\n       Procedure\",
    RFC 950, USC/Information Sciences Institute, August\n       1985.\n   [8] Piscitello
    D., and J. Lawrence, \"Transmission of IP datagrams\n       over the SMDS Service\",
    RFC 1209, Bell Communications Research,\n       March, 1991.\n   [9] Postel, J.,
    \"Internet Protocol - DARPA Internet Program Protocol\n       Specification\",
    RFC 791, DARPA, September 1981.\n  [10] Postel, J., \"Internet Control Message
    Protocol - DARPA Internet\n       Program Protocol Specification\", RFC 792, USC/Information\n
    \      Sciences Institute, September 1981.\n  [11] Reynolds, J., \"BOOTP Vendor
    Information Extensions\", RFC 1084,\n       USC/Information Sciences Institute,
    December 1988.\n"
  title: References
- contents:
  - "Author's Address\n       Stephen E. Deering\n       Xerox Palo Alto Research
    Center\n       3333 Coyote Hill Road\n       Palo Alto, CA  94304\n       Phone:
    (415) 494-4839\n       EMail: deering@xerox.com\n       Or send comments to gw-discovery@gregorio.stanford.edu.\n"
  title: Author's Address
