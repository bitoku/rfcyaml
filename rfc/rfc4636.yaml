- title: __initial_text__
  contents:
  - '             Foreign Agent Error Extension for Mobile IPv4

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies a new extension for use by Foreign Agents\n\
    \   operating Mobile IP for IPv4.  Currently, a foreign agent cannot\n   supply\
    \ status information without destroying the ability for a mobile\n   node to verify\
    \ authentication data supplied by the home agent.  The\n   new extension solves\
    \ this problem by making a better place for the\n   foreign agent to provide its\
    \ status information to the mobile node.\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document specifies a new non-skippable extension for\
    \ use by\n   Foreign Agents operating Mobile IP for IPv4 [4].  The new extension\n\
    \   option allows a foreign agent to supply an error code without\n   disturbing\
    \ the data supplied by the Home Agent within the\n   Registration Reply message.\
    \  In this way, the mobile node can verify\n   that the Registration Reply message\
    \ was generated by the Home Agent\n   even in cases where the foreign agent is\
    \ required by protocol to\n   insert new status information into the Registration\
    \ Reply message.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The keywords \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [1].  Other\n   terminology is used as already defined in [4].\n"
- title: 3.  FA Error Extension Format
  contents:
  - "3.  FA Error Extension Format\n   The format of the FA Error Extension conforms\
    \ to the Short Extension\n   format specified for Mobile IPv4 [4].  The FA Error\
    \ Extension is not\n   skippable.\n       0                   1              \
    \     2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |    Sub-Type   |     Status    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      Type\n\
    \         45\n      Length\n         2\n      Sub-Type\n         0\n      Status\n\
    \         A status code used by the foreign agent to supply status\n         information\
    \ to the mobile node.\n"
- title: 4.  Operation and Use of the FA Error Extension
  contents:
  - "4.  Operation and Use of the FA Error Extension\n   The FA Error Extension is\
    \ only valid for use within Mobile IPv4\n   Registration Reply messages.  The\
    \ FA Error Extension is not\n   skippable.  A mobile node that cannot correctly\
    \ interpret the\n   contents of the FA Error Extension MUST NOT use the care-of\
    \ address\n   provided in the Registration Reply message, until another\n   Registration\
    \ Request message has been sent and a successful\n   Registration Reply message\
    \ received.\n   Status codes allowable for use within the FA Error Extension are\n\
    \   within the range 64-127.  The currently specified codes are as\n   follows:\n\
    \      64 reason unspecified\n      65 administratively prohibited\n      66 insufficient\
    \ resources\n      68 home agent failed authentication\n      71 poorly formed\
    \ Reply\n      77 invalid care-of address\n      78 registration timeout\n   as\
    \ defined in RFC 3344 [4] for use by the Foreign Agent.  Status\n   codes for\
    \ use with the FA Error extensions must not be differently\n   defined for use\
    \ in the Code field of Registration Reply messages.\n   When a foreign agent appends\
    \ a FA Error Extension to the Registration\n   Reply as received from the Home\
    \ Agent, it has to update the UDP\n   Length field in the UDP header [5] to account\
    \ for the extra 4 bytes\n   of length.\n   This document updates the Mobile IP\
    \ base specification [4] regarding\n   the procedures followed by the foreign\
    \ agent in the case that the\n   home agent fails authentication.  Instead of\
    \ modifying the \"status\"\n   field of the Registration Reply to contain the\
    \ value 68, now the\n   foreign agent should append the Foreign Agent Error Extension\n\
    \   containing the status value 68.\n"
- title: 5.  Mobile Node Considerations
  contents:
  - "5.  Mobile Node Considerations\n   If a mobile node receives a successful Registration\
    \ Reply (status\n   code 0 or 1), with a FA Error Extension indicating that the\
    \ foreign\n   agent is not honoring said Registration Reply, the mobile node SHOULD\n\
    \   then send a deregistration message to the home agent.  In this way,\n   the\
    \ home agent will not maintain a registration status that is\n   inconsistent\
    \ with the status maintained by the foreign agent.\n"
- title: 6.  Foreign Agent Considerations
  contents:
  - "6.  Foreign Agent Considerations\n   When denying a successful Registration Reply,\
    \ the Foreign Agent\n   SHOULD send a Registration Revocation message [2] to the\
    \ Home Agent\n   if a mobility security association exists between them.  For\
    \ cases\n   when the foreign agent does have the required security association,\n\
    \   this way of informing the home agent does not have the vulnerability\n   from\
    \ detrimental actions by malicious foreign agents, as noted in\n   section 8.\n"
- title: 7.  IANA Considerations
  contents:
  - "7.  IANA Considerations\n   This specification reserves one number for the FA\
    \ Error Extension\n   (see section 3) from the space of numbers for non-skippable\
    \ mobility\n   extensions (i.e., 0-127) defined in the specification for Mobile\
    \ IPv4\n   [4].\n   This specification also creates a new number space of sub-types\
    \ for\n   the type number of this extension.  Sub-type zero is to be allocated\n\
    \   from this number space for the protocol extension specified in this\n   document.\
    \  Similar to the procedures specified for Mobile IP [4]\n   number spaces, future\
    \ allocations from this number space require\n   expert review [3].\n   The status\
    \ codes that are allowable in the FA Error Extension are a\n   subset of the status\
    \ codes defined in the specification for Mobile\n   IPv4 [4].  If, in the future,\
    \ additional status codes are defined for\n   Mobile IPv4, the definition for\
    \ each new status code must indicate\n   whether the new status code is allowable\
    \ for use in the FA Error\n   Extension.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   The extension in this document improves the security\
    \ features of\n   Mobile IPv4 by allowing the mobile node to be assured of the\n\
    \   authenticity of the information supplied within a Registration\n   Request.\
    \  Previously, whenever the foreign agent was required to\n   provide status information\
    \ to the mobile node, it could only do so by\n   destroying the ability of the\
    \ mobile device to verify the Mobile-Home\n   Authentication Extension data.\n\
    \   In many common cases, the mobile node will not have a security\n   association\
    \ with the foreign agent that has sent the extension.\n   Thus, the mobile node\
    \ will be unable to ascertain that the foreign\n   agent sending the extended\
    \ Registration Reply message is the same\n   foreign agent that earlier received\
    \ the associated Registration\n   Request from the mobile node.  Because of this,\
    \ a malicious foreign\n   agent could cause a mobile node to operate as if the\
    \ registration had\n   failed, when in fact its home agent and a correctly operating\
    \ foreign\n   agent had both accepted the mobile node's Registration Request.\
    \  In\n   order to reduce the vulnerability to such maliciously transmitted\n\
    \   Registration Reply messages with the unauthenticated extension, the\n   mobile\
    \ node MAY delay processing of such denied Registration Reply\n   messages for\
    \ a short while in order to determine whether another\n   successful Registration\
    \ Reply might be received from the foreign\n   agent.\n"
- title: 9.  Acknowledgements
  contents:
  - "9.  Acknowledgements\n   Thanks to Kent Leung and Henrik Lefkowetz for suggested\
    \ improvements\n   to this specification.\n"
- title: 10.  Normative References
  contents:
  - "10.  Normative References\n   [1] Bradner, S., \"Key words for use in RFCs to\
    \ Indicate Requirement\n       Levels\", BCP 14, RFC 2119, March 1997.\n   [2]\
    \ Glass, S. and M. Chandra, \"Registration Revocation in Mobile\n       IPv4\"\
    , RFC 3543, August 2003.\n   [3] Narten, T. and H. Alvestrand, \"Guidelines for\
    \ Writing an IANA\n       Considerations Section in RFCs\", BCP 26, RFC 2434,\
    \ October 1998.\n   [4] Perkins, C., \"IP Mobility Support for IPv4\", RFC 3344,\
    \ August\n       2002.\n   [5] Postel, J., \"User Datagram Protocol\", STD 6,\
    \ RFC 768, August\n       1980.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Charles E. Perkins\n   Palo Alto Systems Research Lab\n\
    \   Nokia Research Center\n   975 Page Mill Road, Suite 200\n   Palo Alto, CA\
    \ 94304-1003\n   Phone: +1 650-496-4402\n   Fax:   +1-650-739-0779\n   EMail:\
    \ charles.perkins@nokia.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
