- title: __initial_text__
  contents:
  - "             Extensions to Support Efficient Carrying of\n        Multicast Traffic\
    \ in Layer-2 Tunneling Protocol (L2TP)\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2005).\n"
- title: Abstract
  contents:
  - "Abstract\n   The Layer Two Tunneling Protocol (L2TP) provides a method for\n\
    \   tunneling PPP packets.  This document describes an extension to L2TP,\n  \
    \ to make efficient use of L2TP tunnels within the context of deploying\n   multicast\
    \ services whose data will have to be conveyed by these\n   tunnels.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n             6.2.1.  New Outgoing Sessions AVP (MSI).................\
    \ 15\n             6.2.2.  New Outgoing Sessions Acknowledgement AVP (MSI). 15\n\
    \             6.2.3.  Withdraw Outgoing Sessions AVP (MSI)............ 17\n  \
    \     6.3.  Multicast Packets Priority AVP (MSI).................... 17\n    \
    \         6.3.1.  Global Configuration............................ 18\n      \
    \       6.3.2.  Individual Configuration........................ 19\n        \
    \     6.3.3.  Priority........................................ 19\n   7.  Multicast\
    \ Session Teardown.................................... 19\n       7.1.  Operations..............................................\
    \ 20\n       7.2.  Multicast-Session-End-Notify (MSEN)..................... 20\n\
    \       7.3.  Result Codes............................................ 21\n  \
    \ 8.  Traffic Merging............................................... 22\n   9.\
    \  IANA Considerations........................................... 22\n   10. Security\
    \ Considerations....................................... 23\n   11. References....................................................\
    \ 23\n       11.1. Normative References.................................... 23\n\
    \       11.2. Informative References.................................. 24\n  \
    \ 12. Acknowledgements.............................................. 24\n   Appendix\
    \ A.  Examples of Group States Determination............... 25\n   Author's Address..................................................\
    \ 27\n   Full Copyright Statement.......................................... 28\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The deployment of IP multicast-based services may have to\
    \ deal with\n   L2TP tunnel engineering.  The forwarding of multicast data within\n\
    \   L2TP sessions may impact the throughput of L2TP tunnels because the\n   same\
    \ traffic may be sent multiple times within the same L2TP tunnel,\n   but in different\
    \ sessions.  This proposal aims to reduce the impact\n   by applying the replication\
    \ mechanism of multicast traffic only when\n   necessary.\n   The solution described\
    \ herein provides a mechanism for transmitting\n   multicast data only once for\
    \ all the L2TP sessions that have been\n   established in a tunnel, each multicast\
    \ flow having a dedicated L2TP\n   session.\n   Within the context of deploying\
    \ IP multicast-based services, it is\n   assumed that the routers of the IP network\
    \ that embed a L2TP Network\n   Server (LNS) capability may be involved in the\
    \ forwarding of\n   multicast data, toward users who access the network through\
    \ an L2TP\n   tunnel.  The LNS is in charge of replicating the multicast data\
    \ for\n   each L2TP session that a receiver who has requested a multicast flow\n\
    \   uses.  In the solution described here, an LNS is able to send\n   multicast\
    \ data only once and to let the L2TP Access Concentrator\n   (LAC) perform the\
    \ traffic replication.  By doing so, it is expected\n   to spare transmission\
    \ resources in the core network that supports\n   L2TP tunnels.  This multicast\
    \ extension to L2TP is designed so that\n   it does not affect the behavior of\
    \ L2TP equipment under normal\n   conditions.\n   A solution whereby multicast\
    \ data is carried only once in a L2TP\n   tunnel is of interest to service providers,\
    \ as edge devices are\n   aggregating more and more users.  This is particularly\
    \ true for\n   operators who are deploying xDSL (Digital Subscriber Line) services\n\
    \   and cable infrastructures.  Therefore, L2TP tunnels that may be\n   supported\
    \ by the network will have to carry multiple redundant\n   multicast data more\
    \ often.  The solution described in this document\n   applies to downstream traffic\
    \ exclusively; i.e., data coming from the\n   LNS toward end-users connected to\
    \ the LAC.  This downstream multicast\n   traffic is not framed by the LNS but\
    \ by the LAC, thus ensuring\n   compatibility for all users in a common tunnel,\
    \ whatever the framing\n   scheme.\n"
- title: 1.1.  Conventions Used in This Document
  contents:
  - "1.1.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 1.2.  Terminology
  contents:
  - "1.2.  Terminology\n   Unicast session\n      This term refers to the definition\
    \ of \"Session\" as it is described\n      in the terminology section of [RFC2661].\n\
    \   Multicast session\n      This term refers to a connection between the LAC\
    \ and the LNS.\n      Additional Control Messages and Attribute-Value-Pairs (AVPs)\
    \ are\n      defined in this document to open and maintain this connection for\n\
    \      the particular purpose of multicast traffic transportation.  This\n   \
    \   connection between the LAC and the LNS is intended to convey\n      multicast\
    \ traffic only.\n   Session\n      This term is used when there is no need to\
    \ dissociate multicast\n      from unicast sessions, and thus it designates both.\n\
    \   M-IGP\n      Designates a Multicast Interior Gateway Protocol.\n   Multicast\
    \ flow\n      Designates datagrams sent to a group from a set of sources for\n\
    \      which multicast reception is desired.\n   GMP\n      Group Management Protocol,\
    \ such as:\n         - IGMPv1 ([RFC1112])\n         - IGMPv2 ([RFC2236])\n   \
    \      - MLD ([RFC2710], [RFC3590])\n   SFGMP\n      Source Filtering Group Management\
    \ Protocol, such as:\n         - IGMPv3 ([RFC3376])\n         - MLDv2 ([RFC3810])\n"
- title: 2.  Motivation for a Session-Based Solution
  contents:
  - "2.  Motivation for a Session-Based Solution\n   Multicast data have to be seen\
    \ as a singular flow that may be\n   conveyed into all the L2TP sessions that\
    \ have been established in a\n   tunnel.  This means that a given L2TP session\
    \ can be dedicated for\n   the forwarding of a multicast flow that will be forwarded\
    \ to multiple\n   receivers, including those that can be reached by one or several\
    \ of\n   these L2TP sessions.  A session carrying IP multicast data is\n   independent\
    \ from the underlying framing scheme and is therefore\n   compatible with any\
    \ new framing scheme that may be supported by the\n   L2TP protocol.\n   Using\
    \ a single L2TP session per multicast flow is motivated by the\n   following arguments:\n\
    \   -  The administrator of the LNS is presumably in charge of the IP\n      multicast-based\
    \ services and the related engineering aspects.  As\n      such, he must be capable\
    \ of filtering multicast traffic on a\n      multicast source basis, on a multicast\
    \ group basis, and on a user\n      basis (users who access the network using\
    \ an L2TP session that\n      terminates in this LNS).\n   -  Having an L2TP session\
    \ dedicated for a multicast flow makes it\n      possible to enforce specific\
    \ policies for multicast traffic.  For\n      instance, it is possible to change\
    \ the priority treatment for\n      multicast packets against unicast packets.\n\
    \   -  It is not always acceptable or possible to have multicast\n      forwarding\
    \ performed within the network between the LAC and the\n      LNS.  Having the\
    \ multicast traffic conveyed within an L2TP tunnel\n      ensures a multicast\
    \ service between the LNS and end-users,\n      alleviating the need for activating\
    \ multicast capabilities in the\n      underlying network.\n"
- title: 3.  Control Connection Establishment
  contents:
  - '3.  Control Connection Establishment

    '
- title: 3.1.  Negotiation Phase
  contents:
  - "3.1.  Negotiation Phase\n   The multicast extension capability is negotiated\
    \ between the LAC and\n   the LNS during the control connection establishment\
    \ phase.  However,\n   establishment procedures defined in [RFC2661] remain unchanged.\
    \  An\n   LAC indicates its multicast extension capability by using a new AVP,\n\
    \   the \"Multicast Capability\" AVP.  There is no explicit acknowledgement\n\
    \   sent by the LNS during the control connection establishment phase.\n   Instead,\
    \ the LNS is allowed to use multicast extension messages to\n   open and maintain\
    \ multicast sessions (see Section 5).\n"
- title: 3.2.  Multicast Capability AVP (SCCRQ, SCCRP)
  contents:
  - "3.2.  Multicast Capability AVP (SCCRQ, SCCRP)\n   In order to inform the LNS\
    \ that an LAC has the ability to handle\n   multicast sessions, the LAC sends\
    \ a Multicast Capability AVP during\n   the control connection establishment phase.\
    \  This AVP is either sent\n   in a SCCRQ or a SCCRP control message by the LAC\
    \ towards the LNS.\n   Upon receipt of the Multicast Capability AVP, a LNS may\
    \ adopt two\n   distinct behaviors:\n   1) The LNS does not implement the L2TP\
    \ multicast extension: any\n      multicast-related information (including the\
    \ Multicast Capability\n      AVP) will be silently ignored by the LNS.\n   2)\
    \ The LNS implements L2TP multicast extensions and therefore\n      supports the\
    \ Multicast Capability AVP: the LNS is allowed to send\n      L2TP specific commands\
    \ for conveying multicast traffic toward the\n      LAC.\n   The multicast capability\
    \ exclusively refers to the tunnel for which\n   the AVP has been received during\
    \ the control connection establishment\n   phase.  It SHOULD be possible for an\
    \ LNS administrator to shut down\n   L2TP multicast extension features towards\
    \ one or a set of LAC(s).  In\n   this case, the LNS behavior is similar to that\
    \ in 1).\n   The AVP has the following format:\n      Vendor ID = 0\n      Attribute\
    \ = 80 (16 bits)\n       0                   1                   2           \
    \        3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |M|H|0|0|0|0|      Length       |          Vendor ID            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \              80               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n \
    \  The M-bit MUST be set to 0, the AVP MAY be hidden (H-bit set to 0 or\n   1).\n\
    \   The length of this AVP is 6 octets.\n"
- title: 4.  L2TP Multicast Session Establishment Decision
  contents:
  - '4.  L2TP Multicast Session Establishment Decision

    '
- title: 4.1.  Multicast States in LNS
  contents:
  - "4.1.  Multicast States in LNS\n   The router that embeds the LNS feature MUST\
    \ support at least one\n   Group Management Protocol (GMP), such as:\n      -\
    \ IGMPv1\n      - IGMPv2\n      - MLD\n   or a Source Filtering Group Management\
    \ Protocol (SFGMP), such as:\n      - IGMPv3\n      - MLDv2\n   The LAC does not\
    \ have any group management activity: GMP or SFGMP\n   processing is performed\
    \ by the LNS.  The LAC is a layer-2 equipment,\n   and is not supposed to track\
    \ GMP or SFGMP messages between the\n   receivers and the LNS in this context.\
    \  The LNS MUST always be at the\n   origin of the creation of a multicast L2TP\
    \ session dedicated for the\n   forwarding of IP multicast datagrams destined\
    \ to a multicast group.\n   The LNS acts as a GMP or SFGMP Querier for every logical\
    \ interface\n   associated to an L2TP session.\n   As a multicast router, the\
    \ equipment that embeds the LNS function\n   will keep state per group per attached\
    \ network (i.e., per L2TP\n   session).  The LNS-capable equipment activating\
    \ multicast extensions\n   for L2TP will have to classify and analyze GMP and\
    \ SFGMP states in\n   order to create L2TP multicast sessions within the appropriate\
    \ L2TP\n   tunnels.  This is performed in three steps:\n   1) The LNS has to compute\
    \ group states for each L2TP tunnel, by using\n      group states recorded for\
    \ each L2TP session of the tunnel.  Group\n      state determination for L2TP\
    \ tunnels is discussed in Section 4.2.\n      For each L2TP tunnel, the result\
    \ of this computation will issue a\n      list of states of the form (group, filter-mode,\
    \ source-list):\n      -  group: Denotes the multicast group.\n      -  filter-mode:\
    \ Either INCLUDE or EXCLUDE, as defined in\n         [RFC3376].\n      -  source-list:\
    \ List of IP unicast addresses from which multicast\n         reception is desired\
    \ or not, depending on the filter-mode.\n   2) According to each group state,\
    \ the LNS will create one or multiple\n      replication contexts, depending on\
    \ the filter-mode for the\n      considered group and the local policy configured\
    \ in the LNS.\n      For groups in INCLUDE mode, the LNS SHOULD implement two\
    \ different\n      policies:\n      -  One session per (source, group) pair: the\
    \ LNS creates one\n         replication context per (source, group) pair.\n  \
    \    or\n      -  One session per group: the LNS creates one replication context\n\
    \         per (source-list, group) pair.\n      For groups in EXCLUDE mode, the\
    \ LNS will create one replication\n      context per (list of sources excluded\
    \ by *all* the receivers,\n      group).  The list of sources represents the intersection\
    \ of the\n      sets, not the union.\n   3) For each replication context, the\
    \ LNS will create one L2TP\n      multicast session (if threshold conditions are\
    \ met; see Section\n      4.3) and its associated Outgoing Session List (OSL).\
    \  The OSL\n      lists L2TP sessions that requested the multicast flow\n    \
    \  corresponding to the group and the associated source-filtering\n      properties.\
    \  There is one OSL per replication context; i.e., per\n      L2TP multicast session.\n\
    \   For a group member running an SFGMP, it is therefore possible to\n   receive\
    \ multicast traffic from sources that have been explicitly\n   excluded in its\
    \ SFGMP membership report if other group members in the\n   same L2TP tunnel wish\
    \ to receive packets from these sources.  This\n   behavior is comparable to the\
    \ case where group members are connected\n   to the same multi-access network.\
    \  When a group is in EXCLUDE mode or\n   in INCLUDE mode with a policy allowing\
    \ one session per (group,\n   source-list), sharing the same L2TP tunnel is equivalent\
    \ to being\n   connected to the same multi-access network in terms of multicast\n\
    \   traffic received.  For groups in INCLUDE mode with a policy allowing\n   one\
    \ L2TP multicast session per (source, group), the behavior is\n   slightly improved\
    \ because it prevents group members from receiving\n   traffic from non-requested\
    \ sources.  On the other hand, this policy\n   potentially increases the number\
    \ of L2TP multicast sessions to\n   establish and maintain.  Examples are provided\
    \ in Appendix A.\n   In order for the LAC to forward the multicast traffic received\n\
    \   through the L2TP multicast session to group members, the LNS sends\n   the\
    \ OSL to the LAC for the related multicast session (see Section 6).\n"
- title: 4.2.  Group State Determination
  contents:
  - "4.2.  Group State Determination\n   Source Filtering Group Management Protocols\
    \ require querier routers\n   to keep a filter-mode per group per attached network,\
    \ to condense the\n   total desired reception state of a group to a minimum set\
    \ so that all\n   systems' memberships are satisfied.\n   Within the context of\
    \ L2TP, each L2TP session has to be considered an\n   attached network by GMP\
    \ and SFGMP protocols.  When the L2TP multicast\n   extension is activated, each\
    \ L2TP Control Connection has to be\n   considered a pseudo attached network,\
    \ as well, in order to condense\n   group membership reports for every L2TP session\
    \ in the tunnel.\n   Therefore, a list of group states is maintained for each\
    \ L2TP Control\n   Connection into which the membership information of each of\
    \ its L2TP\n   sessions is merged.  This list of group states is a set of membership\n\
    \   records of the form (group, filter-mode, source-list).\n   Each group state\
    \ represents the result of a merging process applied\n   to subscriptions on L2TP\
    \ sessions of a Control Connection for a\n   considered group.  This merging process\
    \ is performed in three steps:\n      1) Conversion of any GMP subscription into\
    \ SFGMP subscription\n         (IGMPv1/v2 to IGMPv3, MLDv1 to MLDv2);\n      2)\
    \ Removal of subscription timers and, if filter-mode is EXCLUDE,\n         sources\
    \ with source timer > 0;\n      3) Then, resulting subscriptions are merged by\
    \ using merging rules\n         described in SFGMP specifications ([RFC3376],\
    \ Section 3.2,\n         [RFC3810], Section 4.2).\n   This process is also described\
    \ in [PROXY].  Examples of group state\n   determination are provided in Appendix\
    \ A.\n"
- title: 4.3.  Triggering
  contents:
  - "4.3.  Triggering\n   The rules to be enforced by the LNS whereby it is decided\
    \ when to\n   open a dedicated L2TP multicast session for a multicast group SHOULD\n\
    \   be configurable by the LNS administrator.  This would typically\n   happen\
    \ whenever a threshold of MULTICAST_SESSION_THRESHOLD\n   receivers/sessions referenced\
    \ in a replication context is reached.\n   This threshold value SHOULD be valued\
    \ at 2 by default, as it is worth\n   opening a dedicated L2TP multicast session\
    \ for two group members\n   sharing the same desired reception state (which means\
    \ that two L2TP\n   unicast sessions are concerned).  In this case, the OSL will\n\
    \   reference two distinct L2TP sessions.\n   The actual receipt by the LNS of\
    \ multicast traffic requested by end-\n   users can also be taken into account\
    \ to decide whether the associated\n   L2TP multicast session has to be opened.\n\
    \   Whenever an OSL gets empty, the LNS MUST stop sending multicast\n   traffic\
    \ over the corresponding L2TP multicast session.  Then the L2TP\n   multicast\
    \ session MUST be torn down as described in Section 7.\n   Filter-mode changes\
    \ for a group can also trigger the opening or the\n   termination of L2TP multicast\
    \ sessions in the following ways:\n   a) From INCLUDE Mode to EXCLUDE Mode\n \
    \  When a group state filter-mode switches from INCLUDE to EXCLUDE, only\n   one\
    \ replication context (and its associated L2TP multicast session)\n   issued from\
    \ this group state can exist (see Section 4.1).  The LNS\n   SHOULD keep one replication\
    \ context previously created for this group\n   state and it has to update it\
    \ with:\n      -  a new source-list that has to be excluded from forwarding\n\
    \      -  a new OSL\n   The LNS MUST send an OSL update to the LAC to reflect\
    \ L2TP session\n   list changes (section 6.2), whenever appropriate.  The unused\
    \ L2TP\n   multicast sessions that correspond to previously created replication\n\
    \   contexts for the group SHOULD be terminated, either actively or\n   passively\
    \ by emptying their corresponding OSLs.\n   The remaining L2TP multicast session\
    \ MAY also be terminated if the\n   number of receivers is below a predefined\
    \ threshold (see Section 7).\n   To limit the duration of temporary packet loss\
    \ or duplicates to\n   receivers, the LNS has to minimize delay between OSL updates\
    \ messages\n   sent to the LAC.  Therefore, one can assume that terminating a\n\
    \   multicast session passively gives the smoothest transition.\n   b) From EXCLUDE\
    \ Mode to INCLUDE Mode\n   When a group state filter-mode switches from EXCLUDE\
    \ to INCLUDE,\n   multiple replication contexts issued by this group state may\
    \ be\n   created (see Section 4.1).  The LNS SHOULD keep the replication\n   context\
    \ previously created for this group state and it has to update\n   it accordingly\
    \ with the following information:\n      -  a new list of sources that has to\
    \ be forwarded.  This list has\n         only one record if there is one replication\
    \ context per (group,\n         source)\n      -  a new OSL\n   The LNS MUST send\
    \ an OSL update to the LAC to reflect L2TP session\n   list changes, whenever\
    \ appropriate.  If the LNS is configured to\n   create one replication context\
    \ per (group, source), L2TP multicast\n   sessions will be opened in addition\
    \ to the existing one, depending on\n   the number of sources for the group.\n\
    \   If new L2TP multicast sessions have to be opened, the LNS SHOULD wait\n  \
    \ until these multicast sessions are established before updating the\n   OSL of\
    \ the original multicast session.  To limit the duration of\n   temporary packet\
    \ loss or duplicates to receivers, the LNS has to\n   minimize delay between OSL\
    \ updates messages sent to the LAC.\n"
- title: 4.4.  Multicast Traffic Sent from Group Members
  contents:
  - "4.4.  Multicast Traffic Sent from Group Members\n   The present document proposes\
    \ a solution to enhance the forwarding of\n   downstream multicast traffic exclusively;\
    \ i.e., data coming from the\n   LNS toward end-users connected to the LAC.  If\
    \ a group member that\n   uses an L2TP session is also a multicast source for\
    \ traffic conveyed\n   in a multicast session, datagrams may be sent back to the\
    \ source.  To\n   prevent this behavior, two options can be used in the LNS:\n\
    \      1) Disable the multicast packets' forwarding capability, for those\n  \
    \       multicast datagrams sent by users connected to the network by\n      \
    \   means of an L2TP tunnel.  Protocols using well-known multicast\n         addresses\
    \ MUST NOT be impacted.\n      2) Exclude from the OSL the L2TP session used by\
    \ a group member\n         that sends packets matching the replication context\
    \ of this\n         OSL.  Therefore, the corresponding multicast flow is sent\
    \ by\n         the LNS over the user L2TP unicast session, using standard\n  \
    \       multicast forwarding rules.\n"
- title: 5.  L2TP Multicast Session Opening Process
  contents:
  - "5.  L2TP Multicast Session Opening Process\n   The opening of an L2TP multicast\
    \ session is initiated by the LNS.  A\n   three-message exchange is used to set\
    \ up the session.  The following\n   is a typical sequence of events:\n      LAC\
    \              LNS\n      ---              ---\n                       (multicast\
    \ session\n                       triggering)\n                       <- MSRQ\n\
    \      MSRP ->\n      (Ready to\n       replicate)\n      MSE  ->\n          \
    \             <- ZLB ACK\n   The ZLB ACK is sent if there are no further messages\
    \ waiting in the\n   queue for that peer.\n"
- title: 5.1.  Multicast-Session-Request (MSRQ)
  contents:
  - "5.1.  Multicast-Session-Request (MSRQ)\n   Multicast-Session-Request (MSRQ) is\
    \ a control message sent by the LNS\n   to the LAC to indicate that a multicast\
    \ session can be created.  The\n   LNS initiates this message according to the\
    \ rules in Section 4.3.  It\n   is the first in a three-message exchange used\
    \ for establishing a\n   multicast session within an L2TP tunnel.\n   A LNS MUST\
    \ NOT send a MSRQ control message if the remote LAC did not\n   open the L2TP\
    \ tunnel with the Multicast Capability AVP.  The LAC MUST\n   ignore MSRQ control\
    \ messages sent in an L2TP tunnel, if the L2TP\n   tunnel was not opened with\
    \ control messages including a Multicast\n   Capability AVP.\n   The following\
    \ AVPs MUST be present in MSRQ:\n      Message Type\n      Assigned Session ID\n\
    \   The following AVPs MAY be present in MSRQ:\n      Random Vector\n      Maximum\
    \ BPS\n   The Maximum BPS value is set by the LNS administrator.  However, this\n\
    \   value should be chosen in accordance with the line capabilities of\n   the\
    \ end-users.  The Maximum BPS value SHOULD NOT be higher than the\n   highest\
    \ speed connection for all end-users within the L2TP tunnel.\n   The associated\
    \ Message Type AVP is encoded with the following values:\n      Vendor ID = 0\n\
    \      Attribute Type = 0\n      Attribute Value = 23 (16 bits)\n   The M-bit\
    \ MUST be set to 0, and the H-bit MUST be set to 0.\n"
- title: 5.2.  Multicast-Session-Response (MSRP)
  contents:
  - "5.2.  Multicast-Session-Response (MSRP)\n   Multicast-Session-Response (MSRP)\
    \ is a control message sent by the\n   LAC to the LNS in response to a received\
    \ MSRQ message.  It is the\n   second in a three-message exchange used for establishing\
    \ a multicast\n   session within an L2TP tunnel.\n   MSRP is used to indicate\
    \ that the MSRQ was successful and that the\n   LAC will attempt to reserve appropriate\
    \ resources to perform\n   multicast replication for unicast sessions managed\
    \ in the pertaining\n   control connection.\n   The following AVPs MUST be present\
    \ in MSRP:\n      Message Type\n      Assigned Session ID\n   The following AVP\
    \ MAY be present in MSRP:\n      Random Vector\n   The associated Message Type\
    \ AVP is encoded with the following values:\n      Vendor ID = 0\n      Attribute\
    \ Type = 0\n      Attribute Value = 24 (16 bits)\n   The M-bit MUST be set to\
    \ 0, and the H-bit MUST be set to 0.\n"
- title: 5.3.  Multicast-Session-Establishment (MSE)
  contents:
  - "5.3.  Multicast-Session-Establishment (MSE)\n   Multicast-Session-Establishment\
    \ (MSE) is a control message sent by\n   the LAC to the LNS to indicate that the\
    \ LAC is ready to receive\n   necessary multicast information (Section 6) for\
    \ the group using the\n   newly created multicast session.  It is the third message\
    \ in the\n   three-message sequence used for establishing a multicast session\n\
    \   within an L2TP tunnel.\n   The following AVP MUST be present in MSE:\n   \
    \   Message Type\n   The following AVP MAY be present in MSE:\n      Sequencing\
    \ Required\n   Sequencing will occur only from the LNS to the LAC, as a multicast\n\
    \   session is only used to forward multicast traffic downstream.\n   The associated\
    \ Message Type AVP is encoded with the following values:\n      Vendor ID = 0\n\
    \      Attribute Type = 0\n      Attribute Value = 25 (16 bits)\n   The M-bit\
    \ MUST be set to 0, and the H-bit MUST be set to 0.\n"
- title: 6.  Session Maintenance and Management
  contents:
  - "6.  Session Maintenance and Management\n   Once the multicast session is established,\
    \ the LAC has to be informed\n   of the L2TP unicast sessions interested in receiving\
    \ the traffic from\n   the newly created multicast session, and a related optional\
    \ priority\n   parameter, defined in Section 6.3.  To achieve this, a new control\n\
    \   message type is defined: Multicast-Session-Information (MSI).\n"
- title: 6.1.  Multicast-Session-Information (MSI)
  contents:
  - "6.1.  Multicast-Session-Information (MSI)\n   Multicast-Session-Information (MSI)\
    \ control messages carry AVPs to\n   keep the OSL synchronized between the LNS\
    \ and the LAC, and to set the\n   optional priority parameter for multicast traffic\
    \ versus unicast\n   traffic.  MSI may be extended to update the multicast session\
    \ with\n   additional parameters, as needed.\n   Each MSI message is specific\
    \ to a particular multicast session.\n   Therefore, the control message MUST use\
    \ the assigned session ID\n   associated with the multicast session (assigned\
    \ by the LAC), except\n   for the case mentioned in 6.3.2.\n   The associated\
    \ Message Type AVP is encoded with the following values:\n      Vendor ID = 0\n\
    \      Attribute Type = 0\n      Attribute Value = 26 (16 bits)\n   The M-bit\
    \ MUST be set to 0, and the H-bit MUST be set to 0.\n   The following AVP MUST\
    \ be present in MSI:\n      Message Type\n   The following AVPs MAY be present\
    \ in MSI:\n      Random Vector\n      New Outgoing Sessions\n      New Outgoing\
    \ Sessions Acknowledgement\n      Withdraw Outgoing Sessions\n      Multicast\
    \ Packets Priority\n   New Outgoing Sessions, New Outgoing Sessions Acknowledgement,\n\
    \   Withdraw Outgoing Sessions, and Multicast Packets Priority are new\n   AVPs\
    \ defined in sections 6.2 and 6.3.\n"
- title: 6.2.  Outgoing Sessions List Updates
  contents:
  - "6.2.  Outgoing Sessions List Updates\n   Whenever a change occurs in the Outgoing\
    \ Sessions List, the LNS MUST\n   inform the LAC of that change.  The OSL is built\
    \ upon subscription\n   reports recorded by GMP or SFGMP processes running in\
    \ the LNS\n   (Section 4.1).\n   The LAC maintains an OSL as a local table transmitted\
    \ by the LNS.  As\n   for the LNS, the LAC has to maintain an OSL for each L2TP\
    \ multicast\n   session within an L2TP tunnel.  To update the LAC OSL, the LNS\
    \ sends\n   a New Outgoing Sessions AVP for additional sessions, or sends a\n\
    \   Withdraw Outgoing Sessions AVP to remove sessions.  All sessions\n   mentioned\
    \ in these AVPs MUST be added or removed by the LAC from the\n   relevant OSL.\
    \  The Outgoing Sessions List is identified by the tunnel\n   ID and the multicast\
    \ session ID to which the updating AVP refers.  To\n   update the OSL, the following\
    \ AVPs are used:\n      Additional session(s): New Outgoing Sessions AVP\n   \
    \   Session(s) removal: Withdraw Outgoing Sessions AVP\n   These new AVPs MUST\
    \ be sent in an MSI message.\n"
- title: 6.2.1.  New Outgoing Sessions AVP (MSI)
  contents:
  - "6.2.1.  New Outgoing Sessions AVP (MSI)\n   The New Outgoing Sessions AVP can\
    \ only be carried within an MSI\n   message type.  This AVP piggybacks every Session\
    \ ID to which the\n   multicast traffic has to be forwarded.\n   The AVP has the\
    \ following format:\n      Vendor ID = 0\n      Attribute = 81 (16 bits)\n   \
    \    0                   1                   2                   3\n       0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |M|H|0|0|0|0|      Length       |          Vendor ID            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \              81               |         Session ID 0          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |              ...              |         Session ID N          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   There\
    \ can be from 1 to N Session IDs present in the New Outgoing\n   Sessions AVP\
    \ (considering the maximum value of the Length field).\n   This AVP must be placed\
    \ in an MSI message and sent after the\n   establishment of the multicast session\
    \ to indicate the initial\n   outgoing sessions to the LAC, and must be sent at\
    \ any time when one\n   or more outgoing sessions appear during the multicast\
    \ session\n   lifetime.  Upon receipt of this AVP, the LAC sends a New Outgoing\n\
    \   Sessions Acknowledgment AVP to the LNS to notify that the LAC is\n   ready\
    \ to replicate the multicast traffic toward the indicated\n   sessions.\n   Usage\
    \ of this AVP is incremental; only new outgoing sessions have to\n   be listed\
    \ in the AVP.\n   The M-bit MUST be set to 1, and the AVP MAY be hidden (H-bit\
    \ set to 0\n   or 1).\n"
- title: 6.2.2.  New Outgoing Sessions Acknowledgement AVP (MSI)
  contents:
  - "6.2.2.  New Outgoing Sessions Acknowledgement AVP (MSI)\n   The New Outgoing\
    \ Sessions Acknowledgement AVP can only be carried\n   within an MSI message type.\
    \  This AVP informs the LNS that the LAC is\n   ready to replicate traffic for\
    \ every Session ID listed in the AVP.\n   The AVP has the following format:\n\
    \      Vendor ID = 0\n      Attribute = 82 (16 bits)\n       0               \
    \    1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |M|H|0|0|0|0|      Length       |          Vendor ID            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \              82               |         Session ID 0          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |              ...              |         Session ID N          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   This\
    \ AVP must be placed in an MSI message and sent by the LAC toward\n   the LNS\
    \ to acknowledge the receipt of a New Outgoing Sessions list\n   received in a\
    \ New Outgoing Sessions AVP from the LNS.\n   An LNS is allowed to send multicast\
    \ traffic within the L2TP multicast\n   session as soon as a New Outgoing Sessions\
    \ Acknowledgement AVP is\n   received for the corresponding L2TP multicast session.\n\
    \   An LNS is allowed to stop sending packets of the corresponding\n   multicast\
    \ flow within L2TP unicast sessions only if it receives an\n   MSI message with\
    \ the New Outgoing Session Acknowledgement AVP, and\n   only for the unicast Session\
    \ IDs mentioned in this AVP.  The\n   multicast traffic can then be conveyed in\
    \ L2TP unicast sessions when\n   the L2TP multicast session goes down.  From this\
    \ standpoint, packets\n   related to this multicast flow SHOULD NOT be conveyed\
    \ within the L2TP\n   unicast sessions mentioned in the AVP in order to avoid\
    \ the\n   duplication of multicast packets.\n   There can be from 1 to N Session\
    \ IDs present in the New Outgoing\n   Sessions Acknowledgement AVP (considering\
    \ the maximum value of the\n   Length field).  Session IDs mentioned in this AVP\
    \ that have not been\n   listed in a previous New Outgoing Sessions AVP should\
    \ be ignored.\n   Non-acknowledged Session IDs MAY be listed in forthcoming New\n\
    \   Outgoing Sessions AVPs, but multicast traffic MUST be sent to logical\n  \
    \ interfaces associated to these Session IDs as long as these Session\n   IDs\
    \ are not acknowledged for replication by the LAC.\n   The M-bit MUST be set to\
    \ 1, and the AVP MAY be hidden (H-bit set to 0\n   or 1).\n"
- title: 6.2.3.  Withdraw Outgoing Sessions AVP (MSI)
  contents:
  - "6.2.3.  Withdraw Outgoing Sessions AVP (MSI)\n   The Withdraw Outgoing Sessions\
    \ AVP is sent whenever there is one or\n   more withdrawn subscriptions for the\
    \ corresponding multicast flow\n   (designated by the session ID on which the\
    \ MSI is sent).\n   The LAC can stop forwarding packets to Session IDs mentioned\
    \ in the\n   AVP for the corresponding multicast flow as soon as it receives the\n\
    \   MSI message embedding this Withdraw Target Session AVP.\n   The AVP has the\
    \ following format:\n      Vendor ID = 0\n      Attribute = 83 (16 bits)\n   \
    \    0                   1                   2                   3\n       0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |M|H|0|0|0|0|      Length       |          Vendor ID            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \              83               |         Session ID 0          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |              ...              |         Session ID N          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   There\
    \ can be from 1 to N Session IDs present in the Withdraw Outgoing\n   Sessions\
    \ AVP (considering the value of the Length field).  The M-bit\n   MUST be set\
    \ to 1, and the AVP MAY be hidden (H-bit set to 0 or 1).\n"
- title: 6.3.  Multicast Packets Priority AVP (MSI)
  contents:
  - "6.3.  Multicast Packets Priority AVP (MSI)\n   The Multicast Packets Priority\
    \ AVP is an optional AVP intended to\n   indicate to the LAC how to process multicast\
    \ traffic against unicast\n   traffic.  Even though the LAC behavior is partially\
    \ described here,\n   the nature of the traffic (layer-2 frames for unicast traffic\
    \ and\n   pure IP packets for multicast traffic) is not a criteria for\n   enforcing\
    \ a traffic prioritization policy.  Traffic processing for\n   the provisioning\
    \ of a uniformly framed traffic for the final user is\n   described is section\
    \ 8.\n   Three different behaviors can be adopted:\n   1) Best effort: the traffic\
    \ is forwarded from the LAC to the end-user\n      in the order in which it comes\
    \ from the LNS, whatever the type of\n      traffic.\n   2) Unicast traffic priority:\
    \ traffic coming down the L2TP unicast\n      session has priority over traffic\
    \ coming down the L2TP multicast\n      session.\n   3) Multicast traffic priority:\
    \ traffic coming down the L2TP multicast\n      session has priority over traffic\
    \ coming down the L2TP unicast\n      session.\n   The priority is encoded as\
    \ a 16-bit quantity, which can take the\n   following values:\n      0: Best effort\
    \ (default)\n      1: Unicast traffic priority\n      2: Multicast traffic priority\n\
    \   The AVP has the following format:\n      Vendor ID = 0\n      Attribute =\
    \ 84 (16 bits)\n       0                   1                   2             \
    \      3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |M|H|0|0|0|0|      Length       |          Vendor ID            |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \              84               |        Priority Value         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Note that the multicast traffic rate can reach up to Maximum BPS (as\n   indicated\
    \ in MSRQ).  This rate can exceed the maximum rate allowed\n   for a particular\
    \ end-user.  This means that even with a priority\n   value of 0, the end-user\
    \ may receive multicast traffic only; unicast\n   packets might be dropped because\
    \ the multicast flow overwhelms the\n   LAC forwarding buffer(s).\n   The default\
    \ Priority Value is 0.  The M-bit MUST be set to 0, and the\n   AVP MAY be hidden\
    \ (H-bit set to 0 or 1).\n   There are two ways of using this AVP: global configuration\
    \ and\n   individual configuration.\n"
- title: 6.3.1.  Global Configuration
  contents:
  - "6.3.1.  Global Configuration\n   The Multicast Priority Packet AVP is sent for\
    \ all L2TP unicast\n   sessions concerned with a specific multicast flow represented\
    \ by an\n   L2TP multicast session.  In this case, the AVP is sent in an L2TP\
    \ MSI\n   control message for the corresponding multicast session ID (Session\n\
    \   ID = L2TP session for the corresponding multicast group).  The\n   priority\
    \ value applies to all L2TP unicast sessions to which the\n   multicast group\
    \ designated by the L2TP multicast session is intended,\n   as soon as this AVP\
    \ is received.\n"
- title: 6.3.2.  Individual Configuration
  contents:
  - "6.3.2.  Individual Configuration\n   The Multicast Priority Packet AVP is sent\
    \ for a specific L2TP unicast\n   session that SHALL adopt a specific behavior\
    \ for both unicast and\n   multicast traffics.  In this case, the AVP is sent\
    \ in an L2TP MSI\n   control message for the L2TP unicast session (Session ID\
    \ = L2TP\n   session for the concerned user).  The priority value applies to the\n\
    \   targeted session only and does not affect the other sessions.  Note\n   that\
    \ in this case, all multicast packets carried in L2TP multicast\n   sessions are\
    \ treated the same way by the LAC for the concerned user.\n   This is the only\
    \ case in which an MSI control message can be sent for\n   an L2TP unicast session.\n"
- title: 6.3.3.  Priority
  contents:
  - "6.3.3.  Priority\n   It is the responsibility of the network administrator to\
    \ decide which\n   behavior to adopt between global or individual configurations,\
    \ if the\n   AVP is sent twice (one for a multicast group and one for a specific\n\
    \   end-user).  By default, only the individual configurations SHOULD be\n   taken\
    \ into consideration in that case.\n   Support of the Multicast Packets Priority\
    \ AVP is optional and SHOULD\n   be configurable by the LAC administrator, if\
    \ it is relevant.\n"
- title: 7.  Multicast Session Teardown
  contents:
  - "7.  Multicast Session Teardown\n   An L2TP multicast session should be torn down\
    \ whenever there are no\n   longer any users interested in receiving the corresponding\
    \ multicast\n   traffic.  A multicast session becomes useless once the related\
    \ OSL\n   has fewer than a predefined number of entries, this number being\n \
    \  defined by a threshold.\n   Multicast session flapping may occur when the number\
    \ of OSL entries\n   oscillates around the threshold, if the same value is used\
    \ to trigger\n   the creation or deletion of an L2TP multicast session.  To avoid\
    \ this\n   behavior, two methods can be used:\n   -  The threshold value that\
    \ is used to determine whether the L2TP\n      multicast session has to be torn\
    \ down is lower than the\n      MULTICAST_SESSION_THRESHOLD value;\n   -  The\
    \ MULTICAST_SESSION_THRESHOLD value is used to determine whether\n      the L2TP\
    \ multicast session has to be torn down.  A multicast\n      session SHOULD be\
    \ killed after a period of\n      MULTICAST_SESSION_HOLDTIME seconds if the corresponding\
    \ OSL\n      maintains fewer than a MULTICAST_SESSION_THRESHOLD number of\n  \
    \    entries.  The MULTICAST_SESSION_HOLDTIME value is 10 seconds by\n      default\
    \ and SHOULD be configurable by either the LAC or the LNS\n      administrator.\n\
    \   The multicast session can be torn down for multiple reasons,\n   including\
    \ specific criteria not described here (which can be vendor\n   specific).\n \
    \  A multicast session teardown can be initiated by either the LAC or\n   the\
    \ LNS.  However, multicast session teardown MUST be initiated by\n   the LNS if\
    \ the termination decision is motivated by the number of\n   users interested\
    \ in receiving the traffic corresponding to a\n   multicast flow.\n"
- title: 7.1.  Operations
  contents:
  - "7.1.  Operations\n   The actual termination of a multicast session is initiated\
    \ with a new\n   Multicast-Session-End-Notify (MSEN) control message, sent either\
    \ by\n   the LAC or by the LNS.\n   The following is an example of a control message\
    \ exchange that\n   terminates a multicast session:\n      LAC or LNS      LAC\
    \ or LNS\n      ----------      ----------\n                      (multicast session\n\
    \                      termination)\n                      <- MSEN\n         \
    \             (Clean up)\n      ZLB ACK ->\n      (Clean up)\n"
- title: 7.2.  Multicast-Session-End-Notify (MSEN)
  contents:
  - "7.2.  Multicast-Session-End-Notify (MSEN)\n   The Multicast-Session-End-Notify\
    \ (MSEN) is an L2TP control message\n   sent by either the LAC or the LNS to request\
    \ the termination of a\n   specific multicast session within the tunnel.  Its\
    \ purpose is to give\n   the peer the relevant termination information, including\
    \ the reason\n   why the termination occurred.  The peer MUST clean up any associated\n\
    \   resources and does not acknowledge the MSEN message.\n   As defined in [RFC2661],\
    \ termination of a control connection will\n   terminate all sessions managed\
    \ within, including multicast sessions\n   if there are any.\n   The MSEN message\
    \ carries a Result Code AVP with an optional Error\n   Code.\n   The following\
    \ AVPs MUST be present in an MSEN message:\n      Message Type\n      Result Code\n\
    \      Assigned Session ID\n   The associated Message Type AVP is encoded with\
    \ the following values:\n      Vendor ID = 0\n      Attribute Type = 0\n     \
    \ Attribute Value = 27 (16 bits)\n   The M-bit MUST be set to 0, and the H-bit\
    \ MUST be set to 0.\n"
- title: 7.3.  Result Codes
  contents:
  - "7.3.  Result Codes\n   The following values are the defined result codes for\
    \ MSEN control\n   messages:\n      1 (16 bits) - No multicast traffic for the\
    \ group\n      2 (16 bits) - Session terminated for the reason indicated in\n\
    \                    the error code\n      3 (16 bits) - No more receivers\n \
    \     4 (16 bits) - No more receivers (filter-mode change)\n      o  The code\
    \ 1 MAY be used when the LAC detects that no traffic is\n         coming down\
    \ the multicast session, or when the LNS doesn't\n         receive multicast traffic\
    \ to be conveyed over the L2TP\n         multicast session during a certain period\
    \ of time.\n      o  The code 2 refers to General Error Codes maintained by the\
    \ IANA\n         for L2TP.\n      o  The code 3 MAY be used by the LAC or the\
    \ LNS when the OSL is\n         empty.\n      o  The code 4 MAY be used by the\
    \ LNS when a multicast session is\n         torn down because of a filter-mode\
    \ change.  This result code\n         SHOULD also be used when the OSL becomes\
    \ empty after a filter-\n         mode change (passive termination when filter-mode\
    \ changes from\n         INCLUDE to EXCLUDE; see Section 4.3).\n"
- title: 8.  Traffic Merging
  contents:
  - "8.  Traffic Merging\n   Both unicast and multicast traffics have to be merged\
    \ by the LAC in\n   order to forward properly framed data to the end-user.  Multicast\n\
    \   packets are framed by the LAC and transmitted toward the proper end-\n   user.\
    \  Methods used to achieve this function are not described here,\n   since it\
    \ is an implementation-specific issue.\n   All frames conveyed from the LAC to\
    \ the end-users have to follow the\n   framing scheme applied for the considered\
    \ peer to which the traffic\n   is destined (e.g., the LAC is always aware of\
    \ the PPP [RFC1661] link\n   parameters, as described in [RFC2661], Section 6.14).\
    \  Note that\n   using L2TP Multicast Extension features is not appropriate for\
    \ end-\n   users who have negotiated a sequenced layer-2 connection with the\n\
    \   LNS.  While inserting PPP-encapsulated multicast packets in a\n   session,\
    \ the LAC cannot modify PPP sequencing performed by the LNS\n   for each PPP session.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   This document defines:\n      - 5 new Message Type\
    \ (Attribute Type 0) Values:\n           o Multicast-Session-Request (MSRQ)  \
    \    : 23\n           o Multicast-Session-Response (MSRP)     : 24\n         \
    \  o Multicast-Session-Establishment (MSE) : 25\n           o Multicast-Session-Information\
    \ (MSI)   : 26\n           o Multicast-Session-End-Notify (MSEN)   : 27\n    \
    \  - 5 new Control Message Attribute Value Pairs:\n           o Multicast Capability\
    \                  : 80\n           o New Outgoing Sessions                 :\
    \ 81\n           o New Outgoing Sessions Acknowledgement : 82\n           o Withdraw\
    \ Outgoing Sessions            : 83\n           o Multicast Packets Priority \
    \           : 84\n      - 4 Result Codes for the MSEN message:\n           o No\
    \ multicast traffic for the group    : 1\n           o Session terminated for\
    \ the reason indicated in the\n             error code                       \
    \     : 2\n           o No more receivers                     : 3\n          \
    \ o No more receivers (filter-mode change): 4\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   It is possible for one receiver to make additional\
    \ multicast traffic\n   that has not been requested go down the link of another\
    \ receiver.\n   This can happen if a single replication context per group is used\
    \ in\n   INCLUDE mode with receivers having divergent source lists, and in\n \
    \  EXCLUDE mode if a receiver has a source list not shared by another.\n   This\
    \ behavior can be encountered every time receivers are connected\n   to a common\
    \ multi-access network.\n   The extension described in this document does not\
    \ introduce any\n   additional security issues as far as the activation of the\
    \ L2TP\n   protocol is concerned.\n   Injecting appropriate control packets in\
    \ the tunnel toward the LAC to\n   modify Outgoing Session List and to flood end-users\
    \ with unwanted\n   multicast traffic is only possible if the control connection\
    \ is\n   hacked.  As for any reception of illegitimate L2TP control messages,\n\
    \   the following apply:\n      -  If the spoofed control message embeds consistent\
    \ sequence\n         numbers, next messages will appear out of synch, yielding\
    \ the\n         control connection to terminate.\n      -  If sequence numbers\
    \ are inconsistent with current control\n         connection states, the spoofed\
    \ control message will be queued\n         or discarded, as described in [RFC2661],\
    \ Section 5.8.\n   The activation of the L2TP multicast capability on the LAC\
    \ could make\n   the equipment more sensitive to Denial of Service attacks if\
    \ the\n   control connection or the related LNS is hacked.  The LAC might also\n\
    \   be sensitive to the burden generated by the additional replication\n   work.\n\
    \   As mentioned in [RFC2661], Section 9.2, securing L2TP requires that\n   the\
    \ underlying transport make encryption, integrity, and\n   authentication services\
    \ available for all L2TP traffic, including\n   L2TP multicast traffic (control\
    \ and data).\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC1112] Deering, S., \"Host extensions for\
    \ IP multicasting\", STD 5,\n             RFC 1112, August 1989.\n   [RFC1661]\
    \ Simpson, W., \"The Point-to-Point Protocol (PPP)\", STD 51,\n             RFC\
    \ 1661, July 1994.\n   [RFC2119] Bradner, S., \"Key words for use in RFCs to Indicate\n\
    \             Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2236]\
    \ Fenner, W., \"Internet Group Management Protocol, Version\n             2\"\
    , RFC 2236, November 1997.\n   [RFC2661] Townsley, W., Valencia, A., Rubens, A.,\
    \ Pall, G., Zorn, G.,\n             and B. Palter, \"Layer Two Tunneling Protocol\
    \ \"L2TP\"\", RFC\n             2661, August 1999.\n   [RFC2710] Deering, S.,\
    \ Fenner, W., and B. Haberman, \"Multicast\n             Listener Discovery (MLD)\
    \ for IPv6\", RFC 2710, October 1999.\n   [RFC3376] Cain, B., Deering, S., Kouvelas,\
    \ I., Fenner, B., and A.\n             Thyagarajan, \"Internet Group Management\
    \ Protocol, Version\n             3\", RFC 3376, October 2002.\n   [RFC3438] Townsley,\
    \ W., \"Layer Two Tunneling Protocol (L2TP) Internet\n             Assigned Numbers\
    \ Authority (IANA) Considerations Update\",\n             BCP 68, RFC 3438, December\
    \ 2002.\n   [RFC3590] Haberman, B., \"Source Address Selection for the Multicast\n\
    \             Listener Discovery (MLD) Protocol\", RFC 3590, September\n     \
    \        2003.\n   [RFC3810] Vida, R. and L. Costa, \"Multicast Listener Discovery\n\
    \             Version 2 (MLDv2) for IPv6\", RFC 3810, June 2004.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [PROXY]   Fenner, B., He, H., Haberman, B.,\
    \ Sandick, H., \"IGMP/MLD-\n             based Multicast Forwarding (\"IGMP/MLD\
    \ Proxying\")\", Work in\n             Progress.\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   Thanks to Christian Jacquenet for all the corrections\
    \ done on this\n   document and his precious advice, to Pierre Levis for his\n\
    \   contribution about IGMP, to Francis Houllier for PPP considerations,\n   and\
    \ to Xavier Vinet for his input about thresholds.  Many thanks to\n   W. Mark\
    \ Townsley, Isidor Kouvelas, and Brian Haberman for their\n   highly valuable\
    \ input on protocol definition.\n"
- title: Appendix A.  Examples of Group States Determination
  contents:
  - "Appendix A.  Examples of Group States Determination\n   *Example 1:\n   All users\
    \ are managed in the same control connection.\n      Users {1, 2, 3} subscribe\
    \ to (Group G1, EXCLUDE {})\n      Users {3, 4, 5} subscribe to (Group G2, EXCLUDE\
    \ {})\n   Group states for this L2TP tunnel will be:\n      (G1, EXCLUDE, {})\n\
    \      (G2, EXCLUDE, {})\n   Therefore, two replication contexts will be created:\n\
    \      -RC1:\n      (*, G1) packets, Multicast Session MS1, OSL = 1, 2, 3\n  \
    \    -RC2:\n      (*, G2) packets, Multicast Session MS2, OSL = 3, 4, 5\n   *Example\
    \ 2:\n   All users are managed in the same control connection.\n      Users {1,\
    \ 2, 3} subscribe to (Group G1, INCLUDE {S1})\n      Users {4, 5, 6} subscribe\
    \ to (Group G1, INCLUDE {S1,S2})\n      Users {7, 8, 9} subscribe to (Group G1,\
    \ INCLUDE {S2})\n   The group state for this L2TP tunnel will be:\n      (G1,\
    \ INCLUDE, {S1, S2)})\n   If the LNS policy allows one replication context per\
    \ (group, source),\n   two replication contexts will be created:\n      -RC1:\n\
    \      (S1, G1) packets, Multicast Session MS1, OSL = 1, 2, 3, 4, 5, 6\n     \
    \ -RC2:\n      (S2, G1) packets, Multicast Session MS2, OSL = 4, 5, 6, 7, 8, 9\n\
    \   If the LNS policy allows one replication context per (group, source-\n   list),\
    \ one replication context will be created:\n      -RC1:\n      ({S1, S2}, G1)\
    \ packets, Multicast Session MS1, OSL = [1..9]\n   *Example 3:\n   All users are\
    \ managed in the same control connection.\n      Users {1, 2} subscribe to (Group\
    \ G1, EXCLUDE {S1})\n      User {3} subscribes to (Group G1, EXCLUDE {S1, S2})\n\
    \   The group state for this L2TP tunnel will be:\n      (G1, EXCLUDE, {S1})\n\
    \   Therefore, one replication context will be created:\n      -RC1:\n      (*-{S1},\
    \ G1) packets, Multicast Session MS1, OSL = 1, 2, 3\n   Next, user {4} subscribes\
    \ to (Group G1, INCLUDE {S1}).  The group\n   state for the L2TP tunnel is changed\
    \ to:\n      (G1, EXCLUDE, {})\n   The replication context RC1 is changed to:\n\
    \      -RC1: (*, G1) packets, Multicast Session MS1, OSL = 1, 2, 3, 4\n   *Example\
    \ 4:\n   All users are managed in the same control connection.  The LNS policy\n\
    \   allows one replication context per (group, source).\n      Users {1, 2, 3}\
    \ subscribe to (Group G1, INCLUDE {S1, S2})\n   The group state for this L2TP\
    \ tunnel will be:\n      (G1, INCLUDE, {S1, S2)})\n   Therefore, two replication\
    \ contexts will be created:\n      -RC1:\n      (S1, G1) packets, Multicast Session\
    \ MS1, OSL = 1, 2, 3\n      -RC2:\n      (S2, G1) packets, Multicast Session MS2,\
    \ OSL = 1, 2, 3\n   Next, user {4} subscribes to (Group G1, EXCLUDE {}), equivalent\
    \ to an\n   IGMPv2 membership report.  The group state for the L2TP tunnel is\n\
    \   changed to:\n      (G1, EXCLUDE, {})\n   The replication context RC1 is changed\
    \ to:\n      -RC1: (*, G1) packets, Multicast Session MS1, OSL = 1, 2, 3, 4\n\
    \   The replication context RC2 is changed to:\n      -RC2: no packets to forward,\
    \ Multicast Session MS2, OSL = {}\n      (Multicast Session MS2 will be deleted)\n\
    \   When user {4} leaves G1, the group state for the L2TP tunnel goes\n   back\
    \ to:\n      (G1, INCLUDE, {S1, S2})\n   Replication contexts become:\n      -RC1:\n\
    \      (S1, G1) packets, Multicast Session MS1, OSL = 1, 2, 3\n      -RC2:\n \
    \     (S2, G1) packets, Multicast Session MS2, OSL = 1, 2, 3\n      (Multicast\
    \ Session MS2 is re-established)\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Gilles Bourdon\n   France Telecom\n   38-40, rue du General\
    \ Leclerc\n   92794 Issy les Moulineaux Cedex 9 - FRANCE\n   Phone: +33 1 4529-4645\n\
    \   EMail: gilles.bourdon@francetelecom.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2005).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at ietf-\n   ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
