- title: __initial_text__
  contents:
  - '                        Policy-Based Accounting

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2002).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes policy-based accounting which is an approach\n\
    \   to provide flexibility to accounting architectures.  Accounting\n   policies\
    \ describe the configuration of an accounting architecture in\n   a standardized\
    \ way.  They are used to instrument the accounting\n   architecture and can be\
    \ exchanged between Authentication,\n   Authorization and Accounting (AAA) entities\
    \ in order to share\n   configuration information.\n   This document describes\
    \ building blocks and message sequences for\n   policy-based accounting in the\
    \ generic AAA architecture (RFC 2903).\n   Examples are given for the usage of\
    \ accounting policies in different\n   scenarios.  It is also shown how accounting\
    \ components can be\n   integrated into the AAA authorization framework (RFC 2904).\
    \  This\n   document does not propose a language for the description of\n   accounting\
    \ policies.  Rather, it is assumed that a suitable policy\n   language can be\
    \ chosen from existing or upcoming standards.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   3.    Impact of Provider Network Characteristics on Accounting...7\n\
    \   6.    Accounting Policies.......................................14\n   6.1\
    \   Accounting Policy Condition...............................15\n   6.2   Accounting\
    \ Policy Action..................................16\n   6.3   Example for Meter\
    \ Configuration...........................17\n   7.    Accounting Services.......................................19\n\
    \   7.1   Integrated Accounting.....................................19\n   7.2\
    \   Discrete Accounting.......................................21\n   7.3   Intra-Domain\
    \ Accounting...................................22\n   7.4   Inter-Domain Accounting...................................23\n\
    \   8.    Accounting with different Authorization Models............25\n   8.1\
    \   Agent Sequence............................................25\n   8.2   Pull\
    \ Sequence.............................................26\n   8.3   Push Sequence.............................................27\n\
    \   8.4   Roaming...................................................28\n   9.\
    \    Examples..................................................29\n   9.1   Printing\
    \ Service Example..................................29\n   9.1.1 Intra-Domain Accounting...................................29\n\
    \   9.1.2 Inter-Domain Accounting...................................30\n   9.1.3\
    \ User Accounting Indication................................31\n   9.2   Mobile/Roaming\
    \ Example....................................31\n   9.3   Diffserv Example..........................................33\n\
    \   9.4   User Accounting Indication Example........................37\n   10.\
    \   Security Considerations...................................39\n   11.   References................................................41\n\
    \   12.   Acknowledgments...........................................42\n   Author's\
    \ Addresses..............................................43\n   Full Copyright\
    \ Statement........................................44\n"
- title: 1. Introduction
  contents:
  - '1. Introduction

    '
- title: 1.1 Motivation
  contents:
  - "1.1 Motivation\n   Even if we will have much more bandwidth in the future than\
    \ now, the\n   control of network resource utilization remains essential for the\n\
    \   support of applications with special demands and for the prevention\n   of\
    \ (malicious or accidental) waste of bandwidth.  Charging provides a\n   possibility\
    \ to control utilization and sharing of network resources.\n   Charging in multi-service\
    \ networks can be done based on the reserved\n   or the actual used resources.\
    \  Charging on reserved resources is an\n   important concept since reservation\
    \ usually precludes other users\n   from using the reserved resources.  Nevertheless,\
    \ if charging is\n   limited to reservation parameters only, the applied charge\
    \ depends on\n   the ability of the user to give a good prediction of the expected\n\
    \   traffic characteristics.  This can be extenuated by using a charging\n   scheme\
    \ that is based on both the reserved and the used resources.  In\n   order to\
    \ support usage-based charging, the collection of information\n   about the resource\
    \ reservation and utilization is required.  The\n   collection of data about resource\
    \ usage is called accounting.\n   Service providers have various options for service\
    \ differentiation,\n   charging schemes and the provisioning of accounting services.\
    \  The\n   applied charging schemes for the provided services are one\n   significant\
    \ feature used by providers to distinguish themselves from\n   competitors.  Therefore,\
    \ providers use different charging schemes and\n   may change the schemes in accordance\
    \ with their business plan.\n   Providers can also offer different accounting\
    \ services (e.g.\n   standard, comprehensive, etc.) in order to allow customers/users\
    \ to\n   choose one scheme that meets the customers/users needs.  Furthermore,\n\
    \   it may be advantageous for a provider to outsource accounting\n   functionality\
    \ to a third party.  Users introduce various traffic\n   profiles and may have\
    \ individual preferences regarding accounting\n   services (like itemized invoices,\
    \ accounting indications, spending\n   limits etc.).\n   One further challenge\
    \ for the configuration of accounting services\n   are heterogeneous metering\
    \ and accounting infrastructures within\n   provider domains.  Also, the usage\
    \ of different accounting and\n   metering solutions used in different provider\
    \ networks complicates\n   the sharing of configuration parameters (e.g. in roaming\
    \ scenarios).\n   The configuration and dynamic adaptation of the accounting process\
    \ to\n   the business model and specific user demands requires a flexible\n  \
    \ configurable accounting infrastructure.  The utilization of\n   standardized\
    \ policies for the expression of conditions and related\n   configuration actions\
    \ also allows the configuration of heterogeneous\n   infrastructures.  For this\
    \ purpose we propose to use accounting\n   policies to configure the accounting\
    \ infrastructure and use the\n   Authentication, Authorization and Accounting\
    \ (AAA) architecture to\n   exchange and to deploy these policies.\n"
- title: 1.2 Document Scope
  contents:
  - "1.2 Document Scope\n   This document describes the structure and usage of accounting\n\
    \   policies.  It shows how the characteristics of the provider network\n   influence\
    \ the requirements for accounting.  The relations between the\n   different roles\
    \ that are involved in the accounting process and the\n   required building blocks\
    \ for an accounting architecture are\n   introduced.  This document describes\
    \ an architecture and mechanisms\n   to configure the accounting service.  It\
    \ proposes to use the AAA\n   protocol for the exchange of accounting configuration\
    \ information\n   expressed in policies.  It does not propose a specific protocol\
    \ for\n   the accounting configuration itself.  The configuration itself can be\n\
    \   done by existing protocols (e.g. Common Open Policy Service Protocol\n   for\
    \ Support of Policy Provisioning - COPS-PR, Simple Network\n   Management Protocol\
    \ - SNMP, etc.).  Furthermore, it is shown how\n   different accounting services\
    \ can be provided in intra- and inter-\n   domain scenarios.  Examples are given\
    \ for the usage of accounting\n   policies in different scenarios.  They show\
    \ how accounting components\n   can be integrated into the authorization framework\
    \ proposed in\n   [RFC2904].\n   Accounting management architectures and objectives\
    \ as well as the\n   transport of accounting records are discussed in [RFC2975]\
    \ and are\n   not further explained here.  This document focuses on the\n   configuration\
    \ of the accounting architecture and measurement devices.\n   The policy-based\
    \ accounting architecture represented in this document\n   describes policy-based\
    \ accounting from the perspective of a Generic\n   AAA Server [RFC2903].  Such\
    \ a server combines into a single entity\n   the functions of managing accounting\
    \ policy, together with the\n   functions of managing user-specific authentication,\
    \ authorization and\n   service provisioning.  Some service providers may choose\
    \ to implement\n   an approach that does not combine these functions into a single\n\
    \   entity or protocol, in which case that particular aspect of this\n   architecture\
    \ does not apply.\n   This document does not propose a language for the description\
    \ of\n   accounting policies.  It is rather assumed that a suitable policy\n \
    \  language can be chosen from existing or upcoming standards.\n"
- title: 2. Terminology
  contents:
  - "2. Terminology\n   Accounting Indication/Confirmation\n           Accounting\
    \ indication messages are pushed from the\n           originating AAA server (the\
    \ server where the accounting\n           information was generated) to the recipient\
    \ which can be an\n           AAA server or a customer/user application.  Accounting\n\
    \           indications contain accounting records which describe the\n      \
    \     resource consumption for a service.  Accounting indication\n           messages\
    \ can also contain aggregated information for multiple\n           services. \
    \ There can be interim and end-of-session accounting\n           indication messages.\
    \  Interim indications are delivered in\n           specified intervals to the\
    \ recipient during the service\n           session while end-of-session indications\
    \ are given to the\n           recipient at the end of the session only.  Accounting\n\
    \           indications may be acknowledged by accounting confirmations\n    \
    \       to provide application layer reliability.\n   Accounting Policy Indication/Confirmation\n\
    \           Accounting policy indication messages contain accounting\n       \
    \    policies and are sent from a customer/user or a AAA server to\n         \
    \  another AAA server.  Accounting policy indications may be\n           acknowledged\
    \ by accounting policy confirmations to provide\n           application layer\
    \ reliability.\n   Accounting Request/Answer\n           Accounting requests are\
    \ sent by an AAA server to another AAA\n           server to request the current\
    \ accounting information for a\n           particular session set (polling). \
    \ The request is answered\n           with an accounting answer which contains\
    \ the accounting\n           records.\n   Accounting Policy Request/Answer\n \
    \          Accounting policy requests are sent by an AAA server to\n         \
    \  another AAA server or a customer/user to request accounting\n           policies\
    \ for a service.  The request is answered by an\n           accounting policy\
    \ answer that contains the accounting policy.\n   Accounting Policies\n      \
    \     Accounting policies describe rules for generation, transport\n         \
    \  and storage of accounting data.  These rules are used for the\n           configuration\
    \ of the accounting process.\n   Application Specific Module (ASM)\n         \
    \  An ASM provides the functionalities required for the user\n           configuration\
    \ of a service to an authenticated and authorized\n           user.  It gets application\
    \ specific information (ASI) (e.g.\n           for user configuration) from the\
    \ AAA server, either in a\n           generic format or in an application specific\
    \ format,\n           encapsulated in a standard message sent to the ASM.  The\
    \ ASM\n           either extracts the ASI from the message or converts\n     \
    \      information given in a generic format into the appropriate\n          \
    \ application specific format.  Further information on how the\n           ASM\
    \ is used can be found in [RFC2903].\n   Charging Schemes\n           A charging\
    \ scheme is an instruction for calculating a charge.\n           Usually, a charging\
    \ scheme is represented by a formula that\n           consists of charging variables\
    \ (e.g. volume, time, reserved\n           peak rate) and charging coefficients\
    \ (e.g. price per time\n           unit).  The charging variables are usually\
    \ filled by\n           information from accounting data.\n   Classifier\n   \
    \        This document uses the definition of classifier as given in\n       \
    \    [RFC2475].  Since this document assumes that meters already\n           include\
    \ classification functions, the term classifier is only\n           used for entities\
    \ that perform additional classification\n           (e.g. as part of data post\
    \ processing).\n   Meter\n           This document uses the definition of meter\
    \ as given in\n           [RFC2722].  This meter definition already includes the\n\
    \           classification of packets.  It differs from the DiffServ\n       \
    \    model [RFC2475] where classifier and meter are considered as\n          \
    \ separate entities.\n   Meter Reader/Collector\n           This document uses\
    \ the definition of meter reader and\n           collector as given in [RFC2722].\n\
    \   Meter Manager\n           This document uses the definition of meter manager\
    \ as given\n           in [RFC2722].\n   Policy, policy condition, policy action\n\
    \           The terms policy, policy condition and policy action are used\n  \
    \         as defined in [RFC3198].\n   QoS Auditing\n           Quality of Service\
    \ (QoS) Auditing is the process of\n           evaluating whether a given quality\
    \ of service guarantee (e.g.\n           thresholds for QoS parameters given in\
    \ a Service Level\n           Agreement -  SLA) has been met during the service\n\
    \           provisioning.\n   Service Class\n           A service class specifies\
    \ the handling of a service (as\n           defined in [RFC3198]) belonging to\
    \ that class by the service\n           provider.  A service class has some kind\
    \ of identifier (e.g.\n           name) and the handling of the service is defined\
    \ by a Service\n           Level Specification (SLS) as described in [RFC3198].\n\
    \   User Configuration\n           We refer to User Configuration as the process\
    \ of configuring\n           a service for a user which has been authenticated\
    \ and\n           authorized by the AAA architecture.  Although an AAA\n     \
    \      architecture is not directly responsible for this user-\n           dependent\
    \ configuration, it may be responsible for triggering\n           the process.\n\
    \   Further definitions of service related terms (Service, Service\n   Subscriber,\
    \ Service User, Network Provider, Service Provider, Broker)\n   can be found in\
    \ section 4 (business roles and their relations).\n"
- title: 3. Impact of Provider Network Characteristics on Accounting
  contents:
  - "3. Impact of Provider Network Characteristics on Accounting\n   There are many\
    \ options for future service providers for the\n   realization of service differentiation\
    \ and provisioning.  Therefore,\n   provider networks can vary with respect to\
    \ several characteristics\n   that impact accounting and charging:\n   - Size\
    \ and Purpose\n   A small ISP that deals with individual customers may charge\n\
    \   individual users based on single flows.  Backbone operators often\n   have\
    \ small ISPs and large corporations as customers, and usually\n   charge based\
    \ on traffic aggregates instead of individual flows.\n   - QoS provisioning technique\n\
    \   Diffserv accounting requirements differ from Intserv accounting\n   requirements\
    \ (e.g. meter granularity).\n   - Service classes\n   The definition of service\
    \ classes within a network and the degree of\n   freedom that customers are given\
    \ (e.g. gold/silver/bronze service vs.\n   a free choice of individual traffic\
    \ profile parameters) is important,\n   e.g. for the flow classification within\
    \ the network, and influences\n   the accounting functions required.\n   - Charging\
    \ scheme\n   There exists a wide variety of charging schemes using tariff\n  \
    \ variables based on different technical and/or economic models.  The\n   chosen\
    \ charging scheme(s) influence the accounting requirements for\n   the provider.\
    \  While some charging schemes lead to zero or only few\n   accounting requirements,\
    \ other charging schemes may be highly\n   demanding.  For instance, flat rate\
    \ charging schemes require no\n   accounting infrastructure at all.  In contrast\
    \ to this, volume-based\n   charging schemes require the measurement of the transmitted\
    \ volume\n   and, with this, increases the complexity for accounting.  Tariffs\n\
    \   that introduce variable prices may require to provide the users\n   regularly\
    \ with accounting information (e.g. by interim accounting\n   indications).\n\
    \   - Accounting Services\n   Providers may offer different accounting services\
    \ (e.g. accounting\n   indication, itemized invoice, etc.)\n   - Accounting agreements\
    \ with other providers\n   Providers may have agreements with other providers\
    \ in order to share\n   accounting tasks and distribute accounting data so that,\
    \ e.g.,\n   metering need only be done once.  If so, it may be useful if\n   providers\
    \ can not only exchange accounting data, but also information\n   on the configuration\
    \ of accounting modules (e.g. meters).  It is\n   important for providers to agree\
    \ beforehand how accounting data will\n   be collected and monitored, and how\
    \ disputes concerning accounting\n   data will be resolved.  In order to minimize\
    \ disputes between\n   providers, it is important for them to agree that either\
    \ both will\n   collect accounting data - and will compare it with the other's\
    \ data\n   at regular intervals, e.g. monthly - or both will use a single source\n\
    \   of accounting data provided by one of them (or by a trusted third\n   party).\n\
    \   - Exploiting Capabilities of Existing Infrastructure (meters, data\n   collection\
    \ points)\n   Providers may already have functions within the network that can\n\
    \   provide accounting functions (e.g. MIB objects, profile meters,\n   proprietary\
    \ accounting solutions).  In order to avoid duplicated\n   functionality, it should\
    \ be possible to use these accounting\n   resources.  Therefore, the configuration\
    \ of different types of\n   accounting modules (e.g. meters) should be possible.\
    \ A common\n   language to express accounting module configurations would be useful\n\
    \   for this purpose.\n"
- title: 4. Business roles and relations
  contents:
  - "4. Business roles and relations\n   In investigating service provisions in the\
    \ current and forthcoming\n   Internet, we identified different business roles\
    \ which are part of\n   the service usage lifecycle.  In this section we first\
    \ define the\n   term service.  Afterwards, the different roles and their\n  \
    \ relationships are defined.  The business roles in this model are used\n   in\
    \ the later examples.\n   - Service\n   A service is a set of capabilities offered\
    \ by a provider to a\n   customer.  In this definition, provider and customer\
    \ can be one of\n   the business roles defined later.  Different kinds of services\
    \ have\n   to be recognized.\n        - Information services handle the delivery\
    \ of information to the\n        customer on top of transport services.  In content-based\n\
    \        services, the service subscriber pays for the content (e.g. for\n   \
    \     a file, an image, a video, etc.).  In communication-based\n        services,\
    \ the service subscriber pays for the provisioning of a\n        certain form\
    \ of communication (e.g. video conferencing or IP\n        telephony).\n     \
    \   - Transport services describe the provisioning of pure\n        transportation\
    \ of IP packets.  At the IP layer, this may include\n        the differentiation\
    \ of packets (e.g. number of packets with a\n        certain DSCP), Intserv based\
    \ reservation or other methods for\n        QoS enhancement (e.g. Automatic Repeat\
    \ reQuest -  ARQ, Forward\n        Error Correction -  FEC).  A transport service\
    \ might also\n        include mechanisms on other layers for improving the transport\n\
    \        (e.g. MPLS).\n        - Management services are responsible for the management\
    \ of\n        resources (e.g. configuration, accounting, security).\n        Accounting\
    \ services describe the provisioning of data about the\n        current or previous\
    \ resource reservation and usage.  Accounting\n        services are needed by\
    \ providers to generate a bill or by users\n        to monitor their resource\
    \ usage.\n   - Service Subscriber\n   The service subscriber is the entity that\
    \ has subscribed to a service\n   and thus has a contractual relationship with\
    \ a service provider and a\n   network provider which provides the underlying\
    \ transport service.  A\n   service subscriber can also act as a service user.\
    \  The service\n   subscriber might have a relationship with a broker that provides\n\
    \   service relevant information.\n   - Service User\n   The service user is the\
    \ entity that uses the service.  The service\n   user can be identical to the\
    \ service subscriber.  In cases where\n   subscriber and user are not identical,\
    \ the service subscriber should\n   be able to control the service usage for all\
    \ service users she is\n   responsible for.\n   - Network Provider\n   A network\
    \ provider is the entity that provides the underlying network\n   infrastructure\
    \ for the service user, service subscriber, service\n   provider and broker. \
    \ A network provider provides transport services.\n   The services are delivered\
    \ on top of the network infrastructure.  The\n   service provider has a contractual\
    \ relationship with the service\n   subscriber and service provider (and the broker).\
    \  The transport\n   network of a network provider is probably not a global network\
    \ which\n   connects all subscribers, providers and brokers.  The transport\n\
    \   network is segmented into a number of sub-networks or domains\n   controlled\
    \ by different network providers with business relations\n   existing between\
    \ them.  Each domain is responsible for intra-domain\n   management and accounting.\
    \  For inter-domain management and\n   accounting, appropriate communication interfaces\
    \ between network\n   providers must exist.\n   - Service Provider\n   A service\
    \ provider entity provides a service.  A service provider can\n   offer a service\
    \ directly to the service subscriber/user.  A service\n   provider can also act\
    \ like a wholesaler selling a service to another\n   service provider (retailer)\
    \ which re-sells the service to the service\n   subscriber.  The service provider\
    \ has contractual relationships with\n   other service providers, subscribers,\
    \ brokers and network providers.\n   A service provider provides information services\
    \ on top of transport\n   services provided by network providers.\n   - Broker\n\
    \   The broker entity allows the other roles to access the information\n   controlled\
    \ by the broker.  The broker can provide different\n   information to different\
    \ business roles.  For example, a service\n   subscriber can get references to\
    \ appropriate service providers and/or\n   network providers (e.g. a broker gives\
    \ the subscriber a reference to\n   a network provider which can provide bandwidth\
    \ as required by the\n   subscriber).  A broker can also interact with other brokers\
    \ to\n   complete their information.  In this case, broker-to-broker business\n\
    \   relationships exist.\n   Figure 1 depicts the different roles and the business\
    \ relations\n   between them.\n                                     +----+\n \
    \                                    V    |\n                       +---------------+\
    \  |\n                       |  Broker       |<-+\n               +------>|  \
    \             |<-----------------+\n               |       +---------------+ \
    \                 |\n               |               ^                        \
    \  |\n               |               |                          |\n          \
    \     |               V                          V\n               |       +------------------+\
    \        +---------------+\n               |       |  Service         |      \
    \  |   Service     |\n               |       |  Subscriber      |<------>|   Provider\
    \    |\n               |       |                  |        |               |<-+\n\
    \               |       | +--------------+ |        +---------------+  |\n   \
    \            |       | | Service User | |               ^      ^    |\n      \
    \         |       | +--------------+ |               |      +----+\n         \
    \      |       +------------------+               |\n               |        \
    \       ^                          |\n               |               |       \
    \                   |\n               |               V                      \
    \    |\n               |       +---------------+                  |\n        \
    \       +------>|  Network      |<-----------------+\n                       |\
    \  Provider     |<-+\n                       +---------------+  |\n          \
    \                           ^    |\n                                     +----+\n\
    \   Figure 1: Roles and business relations\n   The following examples show how\
    \ this business relationship model can\n   be applied to different services.\n\
    \   Example 1: This example describes an Internet printing scenario\n   according\
    \ to the \"print-by-reference\" model [RFC2566].  The\n   subscriber is a company\
    \ and the users are the employees of that\n   company.  The file server and print\
    \ server belong to two different\n   service providers.  The company subscribes\
    \ to the print server\n   service which acts as reseller for the file service.\
    \  The file server\n   service chooses the appropriate transport service (maybe\
    \ based on\n   user preference), thus the file server has a contract with a network\n\
    \   provider using the offered transport service for downloading the data\n  \
    \ from the given location and sending them to the print server.\n   Example 2:\
    \ A company (service subscriber) has a contract with a video\n   archive (service\
    \ provider).  An employee can download clips in\n   different qualities from the\
    \ archive.  The employee can use different\n   transport mechanisms for the download.\
    \  In order to get the\n   appropriate transport, the user contacts an agency\
    \ (broker) that\n   returns a reference to a network provider which provides the\
    \ required\n   transport service.  As an alternative, the content (video) can\
    \ be\n   delivered in different qualities via different transport mechanisms\n\
    \   by the service provider.  The service provider chooses an appropriate\n  \
    \ network provider which provides a transport service compliant with\n   the conditions\
    \ the service provider offers to the subscribers.  In\n   this case the service\
    \ provider can use the facilities of a broker to\n   get a reference to appropriate\
    \ network providers.\n"
- title: 5. Reference Model and Building Blocks
  contents:
  - "5. Reference Model and Building Blocks\n   We have developed a reference model\
    \ for describing the interactions\n   between the different metering, accounting\
    \ and charging processes and\n   their configuration via policies.  This reference\
    \ model is shown in\n   Figure 2.  At the right side, five layers show the different\
    \ building\n   blocks.  The blocks are layered according to the processing of\
    \ the\n   data from the bottom level metering via accounting, up to the final\n\
    \   billing process.  Data aggregation is not only done at the collection\n  \
    \ layer, it can also be done at the other layers.  The building blocks\n   on\
    \ the different layers are configured through the policies shown on\n   the left\
    \ side.  Higher layer policies can be translated into lower\n   layer policies.\
    \  The configuration parameters are extracted from the\n   policy and passed to\
    \ the corresponding building block.  The tasks of\n   the different building blocks\
    \ are as follows:\n   - Metering\n   Meters are needed for capturing data about\
    \ resource consumption in\n   the network (e.g. transmitted volume).  They will\
    \ probably be placed\n   at the edges of the network.  Two types of meters can\
    \ be\n   distinguished: Static meters and configurable meters.  In the case of\n\
    \   static meters, all flows are measured with a fixed granularity, not\n   distinguishing\
    \ if a subsequent charging process needs the specific\n   meter data or not. \
    \ In most cases the large amount of captured data\n   makes filtering and/or aggregation\
    \ after the metering necessary.  In\n   case of a configurable meter, the meter\
    \ collects meter data only for\n   flows specified by metering policies.\n   For\
    \ configuration of the meter process, the following issues must be\n   addressed:\
    \ (a) metering scope (whether to meter all flows or only\n   selected flows),\
    \ (b) flow granularity (e.g. micro flows or traffic\n   aggregates) (c) metered\
    \ flow attributes (i.e. which data is to be\n   collected for a specific flow),\
    \ and (d) meter accuracy (measurement\n   intervals etc.).\n   - Collection\n\
    \   The data gathered by the meter(s) has to be collected for further\n   processing.\
    \  Collection of meter data can be initiated by the meter\n   itself (push model)\
    \ or by a collector entity (pull model).  Collected\n   data can be aggregated\
    \ before being passed to the accounting layer.\n   Metering policies define how\
    \ collection and aggregation is done.\n         POLICY          CONFIGURATION\
    \          BUILDING BLOCKS\n     +---------------+                   +-------------------------+\n\
    \     |               |------------------>|        Billing          |\n     |\
    \  Billing &    |                   +-------------------------+\n     |  Charging\
    \     |                             ^ charging\n     |               |       \
    \                      | data\n     |               |                   +-------------------------+\n\
    \     |               |------------------>|        Charging         |\n     +---------------+\
    \                   +-------------------------+\n             |              \
    \                       ^ acct\n             V                               \
    \      | data\n     +---------------+                   +-------------------------+\n\
    \     |  Accounting   |                   |                         |\n     |\
    \               |------------------>|        Accounting       |\n     +---------------+\
    \                   +-------------------------+\n             |              \
    \                       ^ aggr. meter\n             V                        \
    \             | data\n     +---------------+                   +-------------------------+\n\
    \     |               |------------------>|        Collection       |\n     |\
    \  Metering     |                   |                         |\n     |      \
    \         |                   +-------------------------+\n     |            \
    \   |                             ^ meter\n     |               |            \
    \                 | data\n     |               |                   +-------------------------+\n\
    \     |               |------------------>|        Metering         |\n     +---------------+\
    \                   +-------------------------+\n   Figure 2: Reference Model\n\
    \   - Accounting\n   Accounting describes the collection of data about resource\n\
    \   consumption.  This includes the control of data gathering (via\n   metering),\
    \ transport and storage of accounting data.  For subsequent\n   charging, the\
    \ metered data must be associated with a user that is the\n   initiator of a flow\
    \ and a customer (service subscriber) that is\n   responsible for payment.  For\
    \ initiation of an accounting process, a\n   user or foreign provider must be\
    \ authenticated and authorized.  These\n   three functions can be performed by\
    \ the AAA server.  The accounting\n   process is configured through accounting\
    \ policies.\n   - Charging\n   Charging derives non-monetary costs for accounting\
    \ data sets based on\n   service and customer specific tariff parameters.  Different\
    \ cost\n   metrics may be applied to the same accounting records even in\n   parallel.\
    \  Charging policies define the tariffs and parameters which\n   are applied.\n\
    \   - Billing\n   Billing translates costs calculated by the Charging into monetary\n\
    \   units and generates a final bill for the customer.  Billing policies\n   define\
    \ among others the type (e.g. invoice, credit card), the form of\n   the bill\
    \ (e.g. itemized or not, partial anyomization, etc.) and the\n   time for billing\
    \ (e.g. weekly, monthly, etc.).\n   We propose to use policies expressed in a\
    \ standardized way to\n   appropriately configure the meter, meter data collection\
    \ and\n   accounting processes.\n"
- title: 6. Accounting Policies
  contents:
  - "6. Accounting Policies\n   Accounting policies describe rules for generation,\
    \ transport and\n   storage of accounting data.  They can be exchanged between\
    \ AAA\n   instances at the user or provider premises.  They provide a\n   standardized\
    \ representation of configuration information that can be\n   converted into the\
    \ appropriate settings for different elements of the\n   accounting infrastructures\
    \ (e.g. different meters).\n   As shown in Figure 2, accounting policies configure\
    \ the accounting\n   process.  Policies for the configuration of the metering\
    \ and\n   collection process can be derived from accounting policies.\n   Accounting\
    \ policies are not used to configure the charging or billing\n   process.  Accounting\
    \ policies reside in the AAA server (local\n   policies) or are received from\
    \ other AAA servers (extra-domain\n   policies) or customers/users.  Two different\
    \ models of obtaining\n   accounting policies can be differentiated: push and\
    \ pull model.\n   Push Model\n   In the push model, accounting policies are pushed\
    \ from another AAA\n   server or customer/user in order to establish the policies\
    \ in the\n   local accounting infrastructure.  The acceptance and use of pushed\n\
    \   policies requires special security considerations.  The evaluation of\n  \
    \ the policy should not take place without an appropriate security\n   check of\
    \ the policy in advance.  Also, the evaluation of the\n   condition can lead to\
    \ unwanted actions in the AAA server if the\n   condition contains critical data\
    \ either intentionally (to attack the\n   system) or by accident.  Even the evaluation\
    \ of the condition can\n   cause problems (e.g. DoS).  Therefore, not only the\
    \ action, but also\n   the condition, has to be checked for potential security\
    \ hazards\n   before it is evaluated.\n   Pull Model\n   In the pull model, the\
    \ AAA server requests the policy from a remote\n   AAA server or customer/user\
    \ by sending an accounting policy request.\n   The remote AAA server sends an\
    \ accounting policy reply as an answer\n   that contains the appropriate policy.\n\
    \   Accounting policies are enforced by the network elements that are\n   configured\
    \ in accordance with the policies.  They influence the\n   following settings\
    \ in the accounting architecture:\n   - meter configuration\n   - data collection\
    \ and aggregation\n   - accounting record distribution and storage\n"
- title: 6.1 Accounting Policy Condition
  contents:
  - "6.1 Accounting Policy Condition\n   An accounting policy consists of one or more\
    \ rules, each having a\n   condition part and an action part.  The condition part\
    \ expresses\n   under which condition the policy should be enforced.  The following\n\
    \   attributes are examples for variables in a policy condition\n   statement.\n\
    \   - customer/user ID\n   The customer/user ID identifies the customer or user\
    \ of the service.\n   It can be used in a policy condition in order to select\
    \ a customer or\n   user specific accounting configuration (as policy action).\
    \  For\n   example, it can be user-dependent whether accounting indications are\n\
    \   sent to the user or not.\n   - IP address\n   IP addresses specify the devices\
    \ or networks from which the service\n   usage takes place.  The address of specific\
    \ hosts or subnets can be\n   used to select accounting strategies specific to\
    \ the customer or a\n   user group associated with this address (e.g. all customers\
    \ of an\n   ISP, all public terminals etc.).\n   - time of day\n   The time of\
    \ day can be used, for instance, to configure the level of\n   detail for the\
    \ accounting record, the report interval and the\n   destination.\n   - service\
    \ class\n   Service classes are defined by the provider.  They describe different\n\
    \   levels or different kinds of services that are offered by the\n   provider\
    \ and are usually defined based on a business model.\n   Customers/users select\
    \ a service class.  This selected class can be\n   used in accounting policies\
    \ to define appropriate accounting settings\n   per class.  With this it is possible,\
    \ for instance, to provide more\n   detailed accounting records for higher prioritized\
    \ services than for\n   standard services.\n   - accounting type\n   Accounting\
    \ types combine multiple accounting settings under one\n   keyword.  Like service\
    \ classes, the offered accounting types are\n   defined by the provider in accordance\
    \ with the business model.  With\n   this, providers can offer, for instance,\
    \ different accounting types\n   for one service and allow the customer/user to\
    \ select one.  The\n   combination of settings under one keyword simplifies the\
    \ selection\n   for users.  An example is the combination of high granular accounting\n\
    \   records with short report intervals under a keyword (e.g.\n   \"comprehensive\
    \ accounting\"), or less frequent generation of less\n   detailed records accessed\
    \ by another keyword (\"standard accounting\").\n   The definition of accounting\
    \ types can also help in inter-domain\n   scenarios if providers agree on accounting\
    \ types.\n"
- title: 6.2 Accounting Policy Action
  contents:
  - "6.2 Accounting Policy Action\n   The action part defines the action that takes\
    \ place if the condition\n   is true.  The action for an accounting policy is\
    \ usually the\n   configuration of the accounting infrastructure.  This can already\n\
    \   include settings for meters and collection entities.  The following\n   list\
    \ gives examples for parameters of the accounting infrastructure\n   that can\
    \ be configured by an accounting policy action:\n   - accounting record type/structure\n\
    \   The required accounting data depends on the charging scheme.\n   Therefore,\
    \ different accounting records should be supported.  There\n   are two possibilities:\
    \ Either different record types are defined, or\n   a flexible record is used\
    \ that consists of a variable set of\n   accounting attributes.  Accounting policies\
    \ can be used to\n   communicate to neighbor providers which kind of accounting\
    \ record is\n   needed to provide appropriate data for the charging scheme.  The\n\
    \   specification of the required accounting attributes can influence the\n  \
    \ settings of different components of the accounting architecture (e.g.\n   which\
    \ attributes have to be measured).  An overview of accounting\n   attributes and\
    \ records can be found in [RFC2924].\n   - accounting record destination\n   The\
    \ accounting record destination describes to which entities\n   accounting records\
    \ are sent.  The accounting record destination can\n   be a charging entity, a\
    \ neighbor provider, a user entity or a\n   specific database.  In these cases,\
    \ authentication and authorization\n   mechanisms have to be applied in order\
    \ to ensure that unauthorized\n   entities cannot get access to confidential data.\n\
    \   - report interval\n   The report interval specifies in what time intervals\
    \ accounting\n   records are generated and sent.  This influences the configuration\
    \ of\n   meters and collectors in the accounting architecture.\n   - storage time\n\
    \   If the accounting record destination is a database or a log file, the\n  \
    \ storage time specifies how long the accounting records have to be\n   stored.\n\
    \   - access list\n   The access list specifies who has the permissions to read\
    \ the stored\n   accounting records.\n   - flow granularity\n   The flow granularity\
    \ determines how fine grained (in coverage) the\n   flows in the network are measured.\
    \  The granularity usually is\n   configured by installing specific classification\
    \ rules in the meter.\n   It is also possible to set a specific granularity by\
    \ configuring\n   aggregation schemes that are applied after the metering process.\
    \  The\n   granularity can range from individual micro flows (e.g. determined\
    \ by\n   the quintuple <src, dest, proto, src-port, dest-port>) up to coarse\n\
    \   granular traffic aggregates (e.g. all traffic from one network).\n   - meter\
    \ accuracy\n   The parameters for the meter accuracy can determine, for instance,\n\
    \   how often measurements take place at the meter, how accurate\n   timestamps\
    \ should be, etc.  Meter accuracy parameters can also be\n   used to configure\
    \ sampling schemes.\n"
- title: 6.3 Example for Meter Configuration
  contents:
  - "6.3 Example for Meter Configuration\n   Note: In the following examples, the\
    \ use of NeTraMet or NetFlow to\n         collect accounting information does\
    \ not guarantee exact\n         accounting data, so it is not recommended for\
    \ use in situations\n         where exact accounting data are needed.\n   The\
    \ following two examples show how accounting policies can be used\n   to configure\
    \ different meters.  The accounting policy is sent from\n   the AAA server to\
    \ the ASM and there converted to the appropriate\n   configuration information\
    \ for the used meter.\n   If the meter NeTraMet [RFC2123] is used, the policy\
    \ is converted into\n   a NeTraMet ruleset that contains the relevant flows, attributes\
    \ and\n   reader instructions for the data collection.  This information is\n\
    \   passed to the NeTraMet manager that configures the meter and meter\n   reader\
    \ in accordance with the given configuration.\n     +------------------+\n   \
    \  |     AAA          |\n     |                  |\n     +------------------+\n\
    \           |         ^\n    Policy |         | Accounting Records\n         \
    \  V         |\n     +------------------+\n     |     ASM          |\n     | \
    \                 |\n     +------------------+\n         |           ^\n     \
    \    |           |\n         | config    +-----------------+\n         |     \
    \                        |\n    +-------------------------------+  |\n    |  \
    \  |       Accounting         |  |\n    |    V                          |  |\n\
    \    | +----------------+            |  |\n    | | Meter Manager  |          \
    \  |  | Accounting Records\n    | +----------------+            |  |\n    |  \
    \  |      |                   |  |\n    |  SNMP     V                   |  |\n\
    \    |  (conf)+---------------+      |  |\n    |    |   | Meter Reader  |---------+\n\
    \    |    |   +---------------+      |\n    |    |              ^           |\n\
    \    |    V              |           |\n    | +-----------+     |           |\n\
    \    | |   Meter   |-----+           |\n    | +-----------+    SNMP(DATA)   |\n\
    \    |                               |\n    +-------------------------------+\n\
    \   Figure 3: Policy based Accounting with NeTraMet\n   If the meter NetFlow [NetFlow]\
    \ is used, the meter policies are\n   translated by the ASM into filter instructions\
    \ for the flow\n   collector.  The meter itself is static and therefore is not\
    \ affected\n   by the configuration information.\n     +------------------+\n\
    \     |    AAA           |\n     |                  |\n     +------------------+\n\
    \           |         ^\n    Policy |         | Accounting Records\n         \
    \  V         |\n     +------------------+\n     |     ASM          |\n     | \
    \                 |\n     +------------------+\n         |           ^\n     \
    \    |           |\n         | config    | Accounting Records\n         |    \
    \       |\n    +-------------------------------+\n    |    |    Accounting   \
    \         |\n    |    |                          |\n    |    |  +---------------------+\
    \ |\n    |    |  | Flow Collector      | |\n    |    |  |      +------------+\
    \ | |\n    |    |  |      | Classifier | | |\n    |    |  |      | Aggregator\
    \ | | |\n    |    +->|      +------------+ | |\n    |       +---------------------+\
    \ |\n    |                   ^           |\n    |                   |        \
    \   |\n    | +-----------+     |           |\n    | |   Meter   |-----+      \
    \     |\n    | +-----------+   UDP (DATA)    |\n    |                        \
    \       |\n    +-------------------------------+\n   Figure 4: Policy based Accounting\
    \ with NetFlow\n"
- title: 7. Accounting Services
  contents:
  - "7. Accounting Services\n   Accounting can be seen as part of the service provisioning\
    \ process\n   (integrated accounting) or as a separate service (discrete\n   accounting).\
    \  The different views and their impact on the accounting\n   architecture are\
    \ described below.\n"
- title: 7.1 Integrated Accounting
  contents:
  - "7.1 Integrated Accounting\n   In the integrated accounting model, the accounting\
    \ is seen as part of\n   the provisioned service.  That means the accounting is\
    \ coupled with a\n   specific service.  Therefore, the accounting process is tailored\
    \ to\n   the specific service and might collect accounting information by\n  \
    \ directly exploiting some service specific entities.  For example,\n   accounting\
    \ for IP telephony could use call signaling information from\n   a SIP server.\
    \  The configuration of the accounting architecture is\n   done as part of the\
    \ user configuration of the service equipment.\n   Accounting policies are defined\
    \ as part of the contractual agreement.\n   The ASM converts the instructions\
    \ from the AAA server into the\n   appropriate user configuration including settings\
    \ for the accounting\n   architecture.\n            +---------------------+\n\
    \   <---1--->|  Generic AAA Server |<---1--->\n            |                 \
    \    |            ............\n            |  Rule based engine  |<----|----->:\
    \  Policy  :\n            |                     |    3|      :..........:\n  \
    \          +---------------------+<----|--+   ............\n                 \
    \       ^                  +-->:  Events  :\n                        |       \
    \               :..........:\n                        2\n                    \
    \    |\n                        V\n            +----------------------+      \
    \ ...............\n            | Application specific |<--3-->: Acct Policy :\n\
    \            |         Module       |       :.............:\n            +----------------------+\n\
    \                        ^\n                        |\n                      \
    \  5\n                        |\n                        V\n         +-------------------------------------+\n\
    \         | Service                             |\n         | +-----------+  \
    \  +----------------+ |     ..............\n         | | Service   |<-->|  Accounting/\
    \   |<--3-->: Accounting :\n         | | Provision |    |  Metering      | | \
    \    : Data       :\n         | +-----------+    +----------------+ |     :............:\n\
    \         +-------------------------------------+\n   Figure 5: AAA Server with\
    \ Integrated Accounting\n   Data about the resource consumption is sent back to\
    \ the AAA server\n   via the ASM.  The accounting process within the service converts\
    \ the\n   metered data into accounting records which are sent to the AAA\n   server.\
    \  For generating accounting records data conversion,\n   aggregation and filtering\
    \ of data might be performed.\n"
- title: 7.2 Discrete Accounting
  contents:
  - "7.2 Discrete Accounting\n   In contrast to the integrated accounting approach,\
    \ accounting can\n   also be seen as a separate or discrete service on its own.\
    \  In this\n   case the accounting does not have to be coupled with a specific\n\
    \   service.  Discrete Accounting can be used for outsourcing the\n   accounting\
    \ task.  The accounting service can be provided by a general\n   accounting system\
    \ which is able to account for different services.\n   For example, a generalized\
    \ meter can do accounting for web traffic,\n   FTP traffic and voice over IP traffic.\
    \  If accounting is a separate\n   service, one provider can do the accounting\
    \ (charging and billing)\n   for several other service providers.  Accounting\
    \ is offered just like\n   any other service.  This means authentication and authorization\
    \ might\n   be required prior to the accounting service provisioning.\n   Furthermore,\
    \ it is important that the involved parties agree\n   beforehand how the accounting\
    \ service is provided, what parameters\n   can be set and how disputes will be\
    \ resolved.  After the accounting\n   service has been configured, the AAA server\
    \ can do the user\n   configuration of the service.\n            +---------------------+\n\
    \   <---1--->|  Generic AAA Server |<---1--->\n            |                 \
    \    |            ............\n            |  Rule based engine  |<----|----->:\
    \  Policy  :\n            |                     |    3|      :..........:\n  \
    \          +---------------------+<----|--+   ............\n                ^\
    \             ^            +-->:  Events  :\n                |             | \
    \               :..........:\n                2             2\n              \
    \  |             |\n                V             V\n        +-------------+ \
    \   +--------------+       ...............\n        | Application |    | Application\
    \  |<--3-->: Acct Policy :\n        | Specific    |    | Specific     |      \
    \ :.............:\n        | Module      |    | Module       |\n        +-------------+\
    \    +--------------+\n               ^                  ^\n               | \
    \                 |\n               5                  5\n               |   \
    \               |\n               V                  V\n        +-------------+\
    \    +---------------+       ..............\n        |  Service    |    |  Accounting/\
    \  |<--3-->: Accounting :\n        |             |    |  Metering     |      \
    \ : Data       :\n        +-------------+    +---------------+       :............:\n\
    \   Figure 6: AAA Server with Discrete Accounting\n   A service provider that\
    \ has outsourced the accounting service has to\n   request this service from an\
    \ accounting service provider.  The\n   generated accounting records are sent\
    \ from the accounting provider to\n   the service provider who may make modifications\
    \ to the records before\n   sending them to the final destination.  Having such\
    \ a general\n   accounting service might speed up the creation of new services\
    \ -\n   especially specialized content services - in the Internet.  This\n   separation\
    \ is also beneficial to support special accounting services\n   (e.g. sending\
    \ accounting indications to users) that are not directly\n   coupled to a network\
    \ service.  Furthermore, this separation is useful\n   if the same set of accounting\
    \ strategies can be applied to different\n   services (e.g. different tariffs\
    \ which can be used for a set of\n   services).\n   Another option is to outsource\
    \ only the metering service.  The meter\n   service provider generates meter data\
    \ and sends them to the service\n   provider who has requested them.  The service\
    \ provider then generates\n   accounting records based on the received meter data.\
    \  A separate\n   accounting or metering service provider can be used to validate\
    \ the\n   accounting data generated by a service provider.  If the customer\n\
    \   does not trust a service provider, or in the case of a legal action,\n   a\
    \ trusted accounting or metering provider is able to validate the\n   correctness\
    \ of the accounting data generated by the service provider.\n"
- title: 7.3 Intra-Domain Accounting
  contents:
  - "7.3 Intra-Domain Accounting\n   In Intra-Domain accounting [RFC2975], the data\
    \ about resource\n   consumption is collected in one administrative domain for\
    \ usage in\n   that domain.  Accounting policies are enforced locally.  Since\
    \ no\n   exchange of accounting data with other domains is required in this\n\
    \   scenario, accounting policies do not need to be exchanged with other\n   entities.\n\
    \                                +-------------+\n                           \
    \     |   Billing   |\n                                +-------------+\n     \
    \                                   ^\n                                      \
    \  |\n                                +-------------+\n                      \
    \          |     ASM     |\n                                +-------------+\n\
    \                                        ^\n                                 \
    \       |            ..............\n                                +--------------+\
    \     : Accounting :\n                                |    AAA       |<--->: Policies\
    \   :\n                                +--------------+     :............:\n \
    \                                    |      ^\n                              \
    \       |      |\n                                     V      |\n            \
    \                    +--------------+\n                                |     ASM\
    \      |\n                                +--------------+\n                 \
    \                    |      ^\n                              config |      | Accounting\
    \ Records\n                                     V      |\n   +------------+  \
    \             +-----------|----------+\n   |            | Service usage |  +--------+-------+\
    \  |\n   | End System |-------------->|  | Accounting     |  |\n   |         \
    \   |               |  +----------------+  |\n   +------------+              \
    \ |                      |\n                                |  Service       \
    \      |\n                                +----------------------+\n        User\
    \                            Provider\n   Figure 7: Intra-Domain Accounting\n"
- title: 7.4 Inter-Domain Accounting
  contents:
  - "7.4 Inter-Domain Accounting\n   For Inter-Domain Accounting, at least two administratively\
    \ separated\n   networks are involved in the accounting process.  These can be\
    \ a\n   Home- and a Foreign-Provider in a Roaming/Mobile IP Scenario\n   [RFC2002]\
    \ or a chain of providers if service provisioning involves\n   data transfer and/or\
    \ services from different domains.  In these\n   scenarios, the exchange of accounting\
    \ policies between providers is\n   necessary if accounting tasks are delegated\
    \ to one provider or shared\n   among multiple providers.  The exchange of accounting\
    \ policies is\n   done by the AAA servers as shown in the figure below.\n    \
    \                                                |     +-----------+\n       \
    \                                             |     |  Billing  |\n          \
    \                                          |     +-----------+\n             \
    \                                       |           ^\n                      \
    \                              |           |\n                               \
    \                     |     +-----------+\n                                  \
    \                  |     |    ASM    |\n                                     \
    \               |     +-----------+\n                                        \
    \            |           ^\n                                                 \
    \   |           |\n                        +------------------+ 1. AccPolInd +-----------+\n\
    \                        |                  |<-------------|           |\n   \
    \                     |                  |        |     |           |\n      \
    \                  |     AAAF         | 2.AccPolConf |   AAAH    |\n         \
    \               |                  |------------->|           |\n            \
    \            |                  |        |     |           |\n               \
    \         |                  | 3. AccRec    |           |\n                  \
    \      |                  |------------->|           |\n                     \
    \   +------------------+        |     +-----------+\n                    config\
    \  |       ^               |           ^\n                            |      \
    \ |               |           |\n                            V       |       \
    \        |           V\n                        +--------------+            |\
    \     .............\n                        |     ASM      |            |   \
    \  : Acct.     :\n                        +--------------+            |     :\
    \ Policies  :\n                            |       ^               |     :...........:\n\
    \                            |       |               |\n                     \
    \       |       | Acct. Records |\n                 Service    V       |     \
    \          |\n   +------------+ usage +-----------|----------+    |\n   |    \
    \        |       |  +--------+-------+  |    |\n   | End System |------>|  | Accounting\
    \     |  |    |\n   |            |       |  +----------------+  |    |\n   +------------+\
    \       |                      |    |\n                        |  Service    \
    \         |    |\n                        +----------------------+    |\n    \
    \    User                   Foreign-Provider         Home-Provider\n   Figure\
    \ 8: Inter-Domain Accounting (Roaming Example)\n   In this example, the foreign\
    \ provider takes over the collection of\n   accounting data.  The home provider\
    \ is responsible for applying a\n   charging scheme and sending the bill.  Therefore,\
    \ the home provider\n   needs accounting data from the foreign provider.  In order\
    \ to\n   instruct the foreign provider about the desired accounting record\n \
    \  type and report frequency, the home AAA server sends an accounting\n   policy\
    \ indication to the foreign AAA server.  The indication contains\n   the accounting\
    \ policy.  Instead of sending an indication, the\n   accounting policies could\
    \ also be piggy backed onto an authorization\n   reply.  If the foreign AAA server\
    \ is able to configure devices in a\n   way to enforce the desired policy (e.g.\
    \ the meters are capable of\n   metering the requested attributes) the accounting\
    \ policy indication\n   is acknowledged.  In case the requested policy cannot\
    \ be enforced,\n   the accounting service is denied.  Reasons to deny the enforcement\
    \ of\n   a specific accounting policy could be, e.g. because the meter is not\n\
    \   capable of measuring the requested attributes or the frequency of\n   records\
    \ cannot be provided, or the home provider is not authorized to\n   get the requested\
    \ detailed data.  In this case procedures would be\n   useful to negotiate the\
    \ smallest common denominator for the involved\n   AAA servers regarding the provisioning\
    \ of accounting data.\n"
- title: 8. Accounting with different Authorization Models
  contents:
  - "8. Accounting with different Authorization Models\n   The AAA authorization framework\
    \ [RFC2904] introduces different\n   message sequences for authorization.  The\
    \ integration of configurable\n   accounting services for the message sequences\
    \ can be done as\n   described in the following sections.\n"
- title: 8.1 Agent Sequence
  contents:
  - "8.1 Agent Sequence\n   The appropriate accounting policy for the authorized service\
    \ is\n   either stored together with the authorization policy or in a separate\n\
    \   repository.  The configuration of the accounting infrastructure can\n   be\
    \ done together with the user configuration of the service equipment\n   (messages\
    \ 2 and 3 in Figure 9).  User-specific configuration of the\n   service equipment\
    \ and the accounting infrastructure configuration\n   might involve the transfer\
    \ of configuration data to multiple entities\n   in the network (e.g. to different\
    \ routers for setting up QoS\n   provisioning or to dedicated accounting meters).\n\
    \                             +-------------------------+\n               +------+\
    \      | Service Provider        |\n               |      |   1  |  +-------------------+\
    \  |\n               |      |------+->|    AAA Server     |  |\n             \
    \  |      |<-----+--|                   |  |\n               |      |   4  | \
    \ +-------------------+  |\n               | User |      |       |   ^    ^  \
    \      |\n               |      |      |       |2  |3   |AcctRec |\n         \
    \      |      |      |       V   |    |        |\n               |      |    \
    \  |  +-------------------+  |\n               |      |      |  |      Service\
    \      |  |\n               |      |      |  |     Equipment     |  |\n      \
    \         |      |      |  +-------------------+  |\n               +------+ \
    \     |                         |\n                             +-------------------------+\n\
    \   Figure 9: Accounting and Agent Sequence\n   In the agent sequence, it is possible\
    \ to allow the user to send\n   accounting policies (e.g. for accounting indications)\
    \ together with\n   the authorization request to the AAA server.  Figure 9 shows\
    \ the\n   agent sequence authorization and accounting messages.\n"
- title: 8.2 Pull Sequence
  contents:
  - "8.2 Pull Sequence\n   The configuration of the accounting infrastructure can\
    \ be done\n   similar to the agent sequence during the user configuration of the\n\
    \   service equipment.  Since the pull sequence does not involve the\n   sending\
    \ of a specific authorization request (e.g. if the service\n   equipment is a\
    \ Network Access Server (NAS) and the authorization\n   sequence simply starts\
    \ with the dial-in process), it would need\n   additional communication to support\
    \ accounting policy indications\n   from users.\n                            \
    \  +-------------------------+\n               +------+       | Service Provider\
    \        |\n               |      |AccPolInd +-------------------+  |\n      \
    \         |      |.........>|    AAA Server     |  |\n               |      |<.........|\
    \                   |  |\n               |      |       |  +-------------------+\
    \  |\n               | User |       |       ^   |   ^         |\n            \
    \   |      |       |       |2  |3  |AcctRec  |\n               |      |      \
    \ |       |   V   |         |\n               |      |   1   |  +-------------------+\
    \  |\n               |      |-------+->|      Service      |  |\n            \
    \   |      |<------+--|     Equipment     |  |\n               |      |   4  \
    \ |  +-------------------+  |\n               +------+       |               \
    \          |\n                              +-------------------------+\n   Figure\
    \ 10: Accounting and Pull Sequence\n   This can be, for instance, achieved by\
    \ a hybrid model of agent and\n   pull sequence where the user sends an accounting\
    \ policy indication to\n   the AAA server in addition to the messages exchange\
    \ for the pull\n   sequence.  Figure 10 shows the pull sequence authorization\
    \ and\n   accounting messages.\n"
- title: 8.3 Push Sequence
  contents:
  - "8.3 Push Sequence\n   In the push sequence, there is no direct connection between\
    \ the AAA\n   server and the service equipment.  In this sequence there are three\n\
    \   possibilities for setting up the accounting infrastructure:\n   a) A standard\
    \ fixed accounting procedure that has been assigned in\n   advance for the specific\
    \ combination of authorized user and service\n   is used.\n   b) The ticket (message\
    \ 3 in Figure 11) contains information about the\n   accounting policies used\
    \ (e.g. different tickets for the same service\n   with different accounting policies).\n\
    \   c) The ticket acts as a kind of digital coin and no further\n   accounting\
    \ is needed.  This model also supports the anonymous usage\n   of a service.\n\
    \   Figure 11 shows push sequence authorization and accounting messages.\n   \
    \                            +-------------------------+\n                 +------+\
    \      | Service Provider        |\n                 |      |   1  |  +-------------------+\
    \  |\n                 |      |------+->|    AAA Server     |  |\n           \
    \      |      |<-----+--|                   |  |\n                 |      |  \
    \ 2  |  +-------------------+  |\n                 | User |      |           \
    \   ^          |\n                 |      |      |              | AcctRec  |\n\
    \                 |      |      |              |          |\n                \
    \ |      |   3  |  +-------------------+  |\n                 |      |------+->|\
    \      Service      |  |\n                 |      |<-----+--|     Equipment  \
    \   |  |\n                 |      |   4  |  +-------------------+  |\n       \
    \          +------+      |                         |\n                       \
    \        +-------------------------+\n   Figure 11: Accounting and Push Sequence\n"
- title: 8.4 Roaming
  contents:
  - "8.4 Roaming\n   If the provisioning of the service and the final authentication/\n\
    \   authorization process is done by different organizations, accounting\n   is\
    \ rather coupled to the service provisioning process than to the\n   authentication/authorization\
    \ process.  Since the data doesn't have to\n   traverse the home providers network,\
    \ the home provider has no\n   possibility of collecting data about the resource\
    \ consumption.\n   Therefore, accounting will usually take place in the foreign\
    \ provider\n   domain (i.e. in the domain that does the service provisioning).\n\
    \   Nevertheless, in order to ensure consistency of the authentication,\n   authorization\
    \ and accounting processes (e.g. allocation of user IDs\n   to accounting records)\
    \ and the production of a bill, a connection\n   between the accounting process\
    \ in the service provisioning domain and\n   the deciding authentication/authorization\
    \ process (e.g. at the home\n   provider) is needed.\n   A possible way of doing\
    \ this is if the foreign provider gets the\n   accounting policies from the home\
    \ provider and sets up the accounting\n   architecture in accordance to the given\
    \ policies, the foreign\n   provider can generate accounting records and send\
    \ them back to the\n   home provider.  The home provider then can apply charging\
    \ and can\n   produce a bill.  An example for this is given in section 9.2.  This\n\
    \   scenario requires a prior agreement between the involved providers\n   about\
    \ the possible policies and parameters that are allowed to be\n   set.\n"
- title: 9. Examples
  contents:
  - "9. Examples\n   The following examples illustrate the use of policy-based accounting.\n\
    \   Please note that the services used in the examples are used only for\n   illustration\
    \ purposes and their use in reality requires different\n   messages and parameters.\n"
- title: 9.1 Printing Service Example
  contents:
  - "9.1 Printing Service Example\n   The Internet Printing Protocol (IPP) [RFC2566],\
    \ and especially the\n   \"print-by-reference\" model, provides a very interesting\
    \ example\n   scenario for accounting and the interaction between authorization\
    \ and\n   accounting.  We will describe possible solutions for the accounting\n\
    \   of this service and how the accounting is triggered by the\n   authorization.\
    \  We will show how the model presented above can be\n   used for this example.\n\
    \   IPP \"print-by-reference\" allows a user to request a print service to\n \
    \  print a particular file.  The file to be printed is not on the client\n   system\
    \ but rather on a public server.  That is, the clients print\n   request can contain\
    \ a reference, or pointer, to the document instead\n   of the actual document\
    \ itself.  The print service must then read the\n   file to a file server (used\
    \ for spooling) prior to the printing.\n   There are two possible setups: The\
    \ file and print server either\n   belong to a single organization (Intra-Domain\
    \ Accounting) or to two\n   different organizations (Inter-Domain Accounting).\
    \  In the first\n   case, the user must be authorized by a single service provider\
    \ for\n   service usage.  In the second case, two different possibilities for\n\
    \   establishing a trust relationships between the involved entities have\n  \
    \ to be distinguished [RFC2905].\n"
- title: 9.1.1   Intra-Domain Accounting
  contents:
  - "9.1.1   Intra-Domain Accounting\n   In the case of a single organization, the\
    \ file and print service is\n   provided by a single service provider.  The service\
    \ subscriber and\n   user role are either one entity (e.g. private home user)\
    \ or different\n   entities (e.g. company as subscriber, employee as user).  For\
    \ data\n   transport via the underlying network, the transportation service of\
    \ a\n   network provider is used.  In this case, the AAA server of the\n   provider\
    \ controls the access to the file and the print server.  This\n   means the AAA\
    \ server enforces the accounting policies and collects\n   accounting data for\
    \ both servers.\n"
- title: 9.1.2   Inter-Domain Accounting
  contents:
  - "9.1.2   Inter-Domain Accounting\n   If two different organizations are involved\
    \ there are two\n   possibilities for trust relationships as shown in [RFC2905]:\n\
    \   1. The user has an agreement with the print server; the print\n      server\
    \ has an agreement with the file server.\n   2. The user has agreements with both\
    \ print and file server.\n   In case 1, the user is first authorized by the print\
    \ service and the\n   request is forwarded to the file server.  The file server\
    \ authorizes\n   the print server and determines if the printer is allowed to\
    \ access\n   the file.  In this case which is shown in Figure 12, the accounting\n\
    \   policies from the user arrive at the print service AAA server.\n    USER DOMAIN\
    \     PRINT SERVICE DOMAIN         FILE SERVICE DOMAIN\n                |    \
    \                        |\n     +------+   |                            |\n \
    \    |      |   |                            |\n     |      |   |            \
    \                |\n     |      |   |   +--------------------+   |   +-------------------+\n\
    \     | User |---1-->| Print Service      |---1-->| File Service      |\n    \
    \ |      |<--2---| AAA Server         |<--2---| AAA Server        |\n     |  \
    \    |   |   +--------------------+   |   +-------------------+\n     |      |\
    \   |   | Print Server       |   |   | File Server       |\n     |      |   |\
    \   |  and Printer       |   |   |                   |\n     +------+   |   +--------------------+\
    \   |   +-------------------+\n     1: AccPolInd, 2: AccPolConf\n   Figure 12:\
    \ Inter-Domain Accounting and Printing Service\n   The print service AAA server\
    \ has to decide which policies can be\n   enforced locally and which must be passed\
    \ further to the file service\n   AAA server.  The print service can add additional\
    \ accounting\n   policies.  In case the file server does not support the desired\n\
    \   accounting policies, the print server must notify the user's AAA\n   server\
    \ and some policy conflict resolution must occur.  After the\n   file server has\
    \ transferred the file to the print service, it\n   generates an accounting record\
    \ according to the accounting policy and\n   passes it to the print service. \
    \ The print service generates the\n   final accounting record for the service\
    \ session based on its own and\n   the file service data after finishing printing.\
    \  This record will be\n   used for the later billing process.  Additionally,\
    \ the print server\n   can send the final record to the user's AAA server.  There\
    \ it can be\n   used for later authorization decisions based on used resources,\
    \ i.e.\n   if the customer is a company and the user is an employee.\n   In case\
    \ 2, the customer AAA server has an agreement with file and\n   print server.\
    \  In this case, the user's AAA server sends accounting\n   policies to the file\
    \ and the print server.  After finishing the\n   service, both servers generate\
    \ accounting records for the delivered\n   services which are used for later billing.\
    \  As in the former case,\n   the accounting data can be sent to the user's AAA\
    \ server for use in\n   later authorization decisions.  The user's AAA server\
    \ can tie both\n   accounting records together and assign them to the user using\
    \ audited\n   session information (authorization and accounting messages for a\n\
    \   particular session could be coupled via a session ID) and policies\n   that\
    \ define which activities a certain session is composed of.\n"
- title: 9.1.3   User Accounting Indication
  contents:
  - "9.1.3   User Accounting Indication\n   For the printing service, there are a\
    \ number of possible options for\n   sending accounting indications to the user.\
    \  Accounting indications\n   give the user an indication of how much resources\
    \ have been used\n   until the time of the indication.  A user can receive accounting\n\
    \   indications or not depending on the accounting policy for the user.\n   For\
    \ Internet printing with the \"print-by-reference\" model, such\n   indications\
    \ would be very helpful for the user.  Since the file is\n   not on the clients\
    \ site, the user might not have information on the\n   file size or the number\
    \ of pages that will be printed.  This means\n   the user has no idea of the costs\
    \ of the service usage.  If user and\n   subscriber are a single entity, accounting\
    \ indications would help\n   users to avoid exceeding their spending limit.  Additionally,\n\
    \   accounting indications give the user a hint as to which resource\n   usage\
    \ has caused the charges.  This can be compared to an itemized\n   telephony bill\
    \ where not only the monetary sum per month is printed\n   but, in addition, information\
    \ for every call (start time, duration,\n   distance etc.) and its corresponding\
    \ charge.\n"
- title: 9.2 Mobile/Roaming Example
  contents:
  - "9.2 Mobile/Roaming Example\n   In this section, the \"Dial-in with Roaming\"\
    \ example from the\n   authorization examples [RFC2905], [RFC2002] is used to\
    \ show how\n   accounting functions could interact with authorization functions.\n\
    \   The accounting modules (e.g. collectors and meters) are seen here as\n   part\
    \ of the service equipment which is, in this example, located at\n   the visited\
    \ ISP premises.  The basic configuration of the accounting\n   modules is probably\
    \ done by the visited ISP itself, but the visited\n   ISP can allow the home ISP\
    \ to influence certain parameters (like\n   report interval or accounting record\
    \ format).  This is useful if the\n   home provider generates the invoice and\
    \ therefore needs appropriate\n   accounting records to calculate the prices.\n\
    \      User |         Visited ISP           |        Home  ISP\n           | \
    \                              |\n           |                               |\
    \  +-----------+  ..........\n    <--------------------12-------------------|\
    \ Charging, |<-:charging:\n           |                               |  | Billing\
    \   |  :policies:\n           |                               |  +-----------+\
    \  :........:\n           |                               |        ^\n       \
    \    |                               |        |\n           |                \
    \               |  +-----------+\n           |                               |\
    \  |    ASM    |\n           |                               |  +-----------+\n\
    \           |                               |        ^\n           |         \
    \                      |        |11\n           |                            \
    \   |        |\n           |          +------------+       |  +-------------+\n\
    \           |          |            |       |  |             |\n           | \
    \         |            |---10---->|             |\n           |          |   \
    \         |       |  |             |\n       Acct. Records  | AAAF Server|----3---->|\
    \ AAAH Server |\n    <-----------------|            |<---4-----|             |\n\
    \           |          |            |       |  |             |\n           | \
    \         |            |       |  |             |\n           |          +------------+\
    \       |  +-------------+\n           |           ^  |      ^         |\n   \
    \        |           |  |      |         |\n           |           |  5      9\
    \         |\n           |           |  |      |         |\n           |      \
    \     |  V      |         |\n           |           | +----------------+|\n  \
    \         |           | |     ASM        ||\n           |           2 |      \
    \          ||\n           |           | +----------------+|\n           |    \
    \       |  |      ^         |\n           |           |  |      |         |\n\
    \           |           |  6      8         |\n           |           |  |   \
    \   |         |\n           | +------------+------+-------+ |\n        7  | |\
    \  Service   |      |       | |\n    <--------| Equipment  |  +----------+| |\n\
    \        1  | |            |->|Accounting|| |\n    -------->|            |  +----------+|\
    \ |\n           | |     config |      |       | |\n           | |            |\
    \  +---------+ | |\n           | |            +->| Meters  | | |\n           |\
    \ |               +---------+ | |\n           | +---------------------------+\
    \ |\n           |                               |\n   Figure 13: Roaming Example\n\
    \   The exchange of authorization data corresponds to the example in\n   [RFC2905].\
    \  As an additional component, we introduce an ASM between\n   home AAA and service\
    \ equipment for the user configuration which\n   happens after successful authorization.\
    \  The extended roaming example\n   is shown in Figure 13.  Steps (1), (2) and\
    \ (3) describe the\n   forwarding of an authentication/authorization request from\
    \ the user\n   via the AAA sever of the visited ISP to the home AAA server.  In\
    \ step\n   (4), user specific service parameters are given to the visited ISP's\n\
    \   AAA server and are forwarded to the service equipment (5) where the\n   user\
    \ configuration is done.  The user-specific service parameters\n   could additionally\
    \ include the desired policies for the configuration\n   of the accounting infrastructure\
    \ of the visited ISP.  An accounting\n   policy could be, for instance, \"for\
    \ user X one accounting record of\n   type Y has to be generated every 30 seconds\"\
    .  This accounting policy\n   is used by the visited ISP to configure his modules\
    \ (e.g. metering,\n   data collection).\n   User-dependent service parameters\
    \ are converted by the ASM into the\n   appropriate configuration information\
    \ (6).  Then the user is informed\n   about the completed authentication/authorization\
    \ process (7).  The\n   accounting architecture starts metering the resource usage\
    \ and sends\n   metering records to the ASM (8).  The ASM uses the metered data\
    \ to\n   fill the required accounting records and sends them to the visited\n\
    \   ISP's AAA server (9).  The visited ISP can either post-process the\n   data\
    \ or directly forward them to the home ISP (10).  With this data\n   as input,\
    \ an invoice is generated by the charging and billing modules\n   within the home\
    \ providers domain (11) by using charging policies\n   (tariff formulas), and\
    \ then sent to the user/customer (12).\n   As an additional option, accounting\
    \ records can also be offered to\n   the user (accounting indication) as a special\
    \ service.  For this\n   special service a separate authorization is required.\n"
- title: 9.3 Diffserv Example
  contents:
  - "9.3 Diffserv Example\n   This example explains how integrated accounting is configured\
    \ via\n   policies for a Diffserv service [RFC2475] based on bandwidth brokers\n\
    \   [I2-BB].  The service is the transport of packets with a higher\n   priority\
    \ and the service includes accounting and QoS auditing.\n   Figure 14 shows the\
    \ service setup.  The user issues a Service Request\n   (SR) for a Diffserv service\
    \ to the AAA server.  The request contains\n   a user ID and the parameter for\
    \ the desired service class.\n      User->AAA: user-x@nw-a, service=diffserv,\
    \ class=gold,\n                 amount=2Mbit, dest= nw-b\n   In this example,\
    \ user-x is located at network A (nw-a) and requests a\n   gold class service\
    \ for all flows from this network to the destination\n   network B (nw-b).  After\
    \ authentication and authorization has been\n   completed successfully, the AAA\
    \ server extracts the ASI from the\n   request and passes them to the ASM of the\
    \ Diffserv service.\n      AAA->ASM: service=diffserv, class=gold, amount=2Mbit,\
    \ src=nw-a\n                dest=nw-b\n   The ASM takes over the task of translating\
    \ the application specific\n   information into appropriate user configuration\
    \ information for the\n   service equipment.  For the given Diffserv example,\
    \ the service\n   equipment consists of three components: accounting equipment,\
    \ the QoS\n   auditing equipment and the bandwidth broker architecture.  The ASM\n\
    \   has to address all three components to set up the requested service\n   for\
    \ the user.  The translation of the ASI into configuration\n   information for\
    \ the components can be done by evaluating service\n   provisioning policies.\
    \  For example, the ASM could have the following\n   service provisioning policy:\n\
    \           if class==gold {\n             set bw-request.class = gold\n     \
    \        set accounting.type = comprehensive\n             set qos-audit.metric\
    \ = one-way-delay\n             ...\n           }\n   This results in sending\
    \ a bandwidth request to the BB which asks for\n   a gold service with the given\
    \ parameters.  Furthermore, the ASM\n   issues a request to the accounting equipment\
    \ for comprehensive\n   accounting and a request to the QoS auditing equipment\
    \ for a one-\n   way-delay measurement between the given networks.\n   ASM->BB:\
    \ BW-request(gold, src=nw-a, dest=nw-b, amount=2Mbit)\n   ASM->Acct: Acct-request(comprehensive,\
    \ src=nw-a)\n   ASM->QoS: QoS-audit-request(one-way-delay, src=nw-a, dest=nw-b)\n\
    \   The bandwidth broker then sets up the Diffserv infrastructure to\n   provide\
    \ the prioritized forwarding according to the definition of a\n   gold class.\
    \  This is done in accordance with the actual bandwidth\n   broker's architecture\
    \ and is not further considered here.  For the\n   Accounting Configuration and\
    \ the QoS Audit Control, local\n   configuration policies exist for setting up\
    \ the service.\n      Accounting-Policy:\n                if type==comprehensive\
    \ {\n                  set meter-location = access-point(nw-a)\n             \
    \     set record type =detailed\n                  set report interval = 120 s\n\
    \                  set report target = 193.175.12.8\n                  ^ indent\
    \ of last two lines\n                 }\n      QoS-Measurement-Policy:\n     \
    \             if metric==one-way-delay {\n                    set method = passive\n\
    \                    set timestampsize = 48 bit\n                    set ingress-meter-location\
    \ = access-point(nw-a)\n                    set egress-meter-location = access-point(nw-b)\n\
    \                   }\n   In this case, the local accounting policy sets the meter\
    \ location to\n   the network access point of network A.  It states that for\n\
    \   comprehensive accounting, a detailed record type is required with a\n   report\
    \ interval of 120 s.  The resulting records have to be sent to\n   the given report\
    \ target.  The QoS measurement policy sets the\n   measurement method to passive\
    \ measurement.  It sets the size used for\n   timestamp representation to 48 bits.\
    \  As meter locations, the meters\n   at the access points of network A and network\
    \ B are used.\n   After evaluating these policies, the instructions for the meter\n\
    \   configuration are passed down to the measurement infrastructure.  In\n   our\
    \ example, the accounting configuration instructs the meter at the\n   first measurement\
    \ point (MP1) to add a new rule with the given flow\n   attributes and settings\
    \ for storage and reporting of results.\n      Acct->MI: MP1: add rule dscp=23,\
    \ src=a.a.a/24, dest=b.b.b.b/24\n                     save volume\n          \
    \           set report interval = 120 s\n                     set report target\
    \ = 193.175.12.8\n              SR          +-------+\n   User ----------------->|\
    \  AAA  |\n                          +-------+\n                             \
    \ |\n                              | ASI\n                              V\n  \
    \                        +-------+\n        +-----------------|  ASM  |--------------+--------------+\n\
    \        |       Policy    +-------+  Policy      |   BW Request |\n        |\
    \       Parameters           Parameters  |              |\n        |         \
    \                               |              |\n   -----|----------------------------------------|--------------|-----\n\
    \        |       Service Equipment                |              |\n        V\
    \                                        V              V\n   +---------------+\
    \    ..............    +-----------+   +-----------+\n   | Accounting    |<-->:\
    \ Local      :<-->| QoS       |   | Bandwidth |\n   |               |    : Policies\
    \   :    | Auditing  |   | Broker    |\n   +---------------+    :............:\
    \    +-----------+   +-----------+\n        |                                \
    \        |\n        | Meter Instructions                     | Measurement Setup\n\
    \        V                                        V\n   +--------------------------------------------------+\n\
    \   |  Measurement                                     |\n   |  Infrastructure\
    \                                  |\n   +--------------------------------------------------+\n\
    \   Figure 14: Diffserv Service Provision Setup\n   The QoS audit control instructs\
    \ two meters (at MP1 and MP2) to set up\n   a passive one-way-delay measurement.\n\
    \      QoS->MI: MP1: add rule dscp=23, src=a.a.a.a/24 dest=b.b.b.b/24,\n     \
    \               save timestamp-48\n               MP2: add rule dscp=23, src=a.a.a.a/24,\
    \ dest=b.b.b.b/24,\n                    save timestamp-48\n"
- title: 9.4 User Accounting Indication Example
  contents:
  - "9.4 User Accounting Indication Example\n   This example explains how discrete\
    \ accounting can be used to provide\n   accounting indications for the user. \
    \ Accounting indications are sent\n   to the user in order to inform the user\
    \ about current resource\n   consumption.  The accounting indication is a special\
    \ accounting\n   service that can be provided in addition to the standard accounting\n\
    \   performed by the provider.  Like for any other service, an\n   authorization\
    \ should take place before the accounting indication\n   service provisioning.\
    \  Therefore, the accounting here is seen as a\n   separate service.  That means\
    \ the accounting service is independent\n   of the main service and therefore\
    \ can be applied to different\n   services.  It might be used as an addition to\
    \ an integrated\n   accounting that is part of the service.  The authorization\
    \ process\n   for the accounting service is out of the scope of this document\
    \ and\n   therefore is not further explained here.\n   Figure 15 illustrates the\
    \ configuration message sequence for setting\n   up the accounting service.  First,\
    \ the user sends an Accounting\n   Service Request (ASR) to the AAA server which\
    \ includes desired\n   parameters for the provisioning of the accounting service\
    \ (e.g.\n   report interval).\n      user->AAA: user-x@nw-a, service= accounting\
    \ indications,\n                 report interval= 60 s\n   The AAA server passes\
    \ the ASI to the ASM of the accounting service\n   after the user has been authenticated\
    \ and authorized for the service\n   usage.\n      AAA->ASM: user-x@nw-a, service=accounting\
    \ indications,\n                report interval= 60 s\n   The ASM generates an\
    \ accounting policy based on the ASI and passes\n   this policy to the Accounting\
    \ Configuration.\n   ASM->Acct: If src=a.a.a.x {\n                acc-indication\
    \ = on\n                report interval = 60s\n                report target=\
    \ a.a.a.x\n              }\n              ASR       +-------+\n   User --------------->|\
    \  AAA  |\n                        +-------+\n                            |\n\
    \                            | ASI\n                            V\n          \
    \              +-------+\n                        |  ASM  |\n                \
    \        +-------+\n                            |\n   -------------------------|---------------------------\n\
    \   Service Equipment        | Accounting Policy\n                           \
    \ V\n                    +-----------------+      ..............\n           \
    \         |  Accounting     |<---->: Local Acct :\n                    |     \
    \            |      : Policies   :\n                    +-----------------+  \
    \    :............:\n                            |\n                         \
    \   | Meter Instructions\n                            V\n                    +-----------------+\n\
    \                    |  Measurement    |\n                    |  Infrastructure\
    \ |\n                    +-----------------+\n   Figure 15: Accounting Indication\
    \ Configuration\n   The Accounting Configuration generates meter instructions\
    \ according\n   to the accounting policies from the ASM and local accounting policies\n\
    \   and passes them to the measurement infrastructure.\n      local Acct-Policy:\
    \ if acc-indication {\n                          record type = compact\n     \
    \                    }\n      Acct->MI: MP1: set report interval = 60 s\n    \
    \                 add report target = a.a.a.x\n"
- title: 10. Security Considerations
  contents:
  - "10. Security Considerations\n   Accounting services provide the basis for billing.\
    \  Therefore, the\n   incentives (mainly saving money) and potential for fraud\
    \ is extremely\n   high in the field of configuration of the accounting architecture\
    \ and\n   the collection of accounting data.  In the presented framework, two\n\
    \   types of data communications are required, the exchange of accounting\n  \
    \ policies and the collection of accounting records.  Both\n   communications\
    \ introduce potential security hazards.\n   The following potential security hazards\
    \ can be identified:\n   - Forgery of accounting policies and accounting record\
    \ information\n   Both accounting policies and accounting records can be the target\
    \ of\n   forgery of information.  Accounting policies contain configuration\n\
    \   information.  Modifying this information can lead to a mal-configured\n  \
    \ accounting and metering system which either allows data to traverse\n   the\
    \ accounting system undetected (without being accounted for, e.g.\n   by changing\
    \ the classification rules of a meter) or produces bogus\n   accounting records.\
    \  Accounting records contain data about resource\n   consumption and provide\
    \ the basis for billing.  Modifying accounting\n   records may lead to erroneous\
    \ bills.  Furthermore, it is important\n   that policies or accounting records\
    \ are not redirected or removed and\n   that forged policies or records are not\
    \ inserted.\n   - Eavesdropping\n   It may be required to keep accounting policies\
    \ and accounting records\n   confidential between the involved parties.\n   -\
    \ Denial of Service (DoS) attacks\n   Both the AAA server and the accounting/metering\
    \ subsystem can be the\n   target of denial of service attacks.  A denial of service\
    \ attack\n   against the AAA server may lead to malfunction and even breakdown\
    \ of\n   the server.  This means the server will not be able to provide proper\n\
    \   authentication, authorization and accounting functionality.  The\n   service\
    \ provided by the AAA server will become unavailable or\n   unusable.  An attack\
    \ to the server can be worse than an attack to the\n   service equipment itself,\
    \ especially if multiple services use one AAA\n   server.  An attack against the\
    \ accounting/metering system will cause\n   loss of metering data and/or loss\
    \ of accounting records.\n   This leads to the following security requirements:\n\
    \   - Secrecy of accounting policies and accounting data\n   Unauthorized entities\
    \ should not be able to read or modify accounting\n   policies or accounting records.\
    \  This can be achieved with standard\n   encryption methods.\n   - Authentication\
    \ of accounting data and accounting policy sources\n   It should be ensured that\
    \ the data is originated by the original\n   source.  Source-authentication can\
    \ be achieved by using digital\n   signatures.\n   - Protection of the integrity\
    \ of accounting policies and records\n   It should be ensured that the data was\
    \ not modified on the way from\n   sender to receiver.  Data-authentication can\
    \ also be achieved with\n   digital signatures.\n   - Verify correctness of generated\
    \ accounting data\n   It must be ensured that the accounting data generated by\
    \ the service\n   provider is correct.  A provider may generate incorrect accounting\n\
    \   records either deliberately (i.e. forging) or unintentionally (e.g.\n   faulty\
    \ configuration).  These incorrect accounting records probably\n   have the consequence\
    \ of incorrect bills.  Customers can verify the\n   correctness of the accounting\
    \ data through their measurements and/or\n   through data collected by a trusted\
    \ third party.  A trusted third\n   party can be an independent accounting service\
    \ provider as described\n   in section 7.2 or a more general entity providing\
    \ an auditing\n   service.\n   - Prevention and protection against Denial of Service\
    \ attacks\n   The AAA protocol and all building blocks should be designed and\n\
    \   implemented in a way as resistant as possible to denial of service\n   attacks.\
    \  An additional strategy to defend against DoS attacks is to\n   add a component\
    \ to the meter system that is able to detect suspicious\n   traffic patterns.\
    \  Upon detection, further actions can be taken\n   according to a pre-defined\
    \ policy.\n   The prevention of these hazards has to be considered for the\n \
    \  protocols used for accounting policy exchange and the transportation\n   of\
    \ accounting records.  Since the security requirements for\n   authentication,\
    \ transmission level security, data object\n   confidentiality and integrity are\
    \ addressed in the criteria for AAA\n   protocol evaluation [RFC2989], we assume\
    \ that the future AAA\n   protocol(s) will be suited for secure accounting record\
    \ transfer and\n   probably also for secure accounting policy transport.  Furthermore,\n\
    \   we assume that existing or upcoming solutions for secure\n   transportation\
    \ and enforcement of policies can be used.  Real\n   prevention of DoS attacks\
    \ is quite difficult.  A selective dropping\n   of the attackers packets is impossible\
    \ if the malicious packets\n   cannot be separated from the valid customer traffic.\
    \  Dropping of all\n   packets of a certain type may prevent authorized customers\
    \ from using\n   the service and therefore help the attacker to achieve her goal.\n"
- title: 11. References
  contents:
  - "11. References\n   [I2-BB]     Internet2-QBone Bandwidth Broker,\n          \
    \     http://www.merit.edu/working.groups/i2-qbone-bb\n   [NetFlow]   NetFlow\
    \ Services and Applications, White Paper, Cisco\n               Systems, 1999\n\
    \   [RFC2002]   Perkins, C., \"IP Mobility Support\", RFC 3220, October\n    \
    \           1996.\n   [RFC2123]   Brownlee, N., \"Traffic Flow Measurement: Experiences\
    \ with\n               NeTraMet\", RFC 2123, March 1997.\n   [RFC2475]   Blake,\
    \ S., Black, D., Carlson, M., Davies, E., Wang Z.\n               and W. Weiss,\
    \ \"An Architecture for Differentiated\n               Services\", RFC 2475, December\
    \ 1998.\n   [RFC2566]   DeBry, R., \"Internet Printing Protocol/1.0: Model and\n\
    \               Semantics\", RFC 2911, April 1999.\n   [RFC2722]   Brownlee, N.,\
    \ Mills, C. and G. Ruth, \"Traffic Flow\n               Measurement:  Architecture\"\
    , RFC 2722, October 1999.\n   [RFC2903]   de Laat, C., Gross, G., Gommans, L.,\
    \ Vollbrecht, J. and\n               D. Spence, \"Generic AAA Architecture\",\
    \ RFC 2903, August\n               2000.\n   [RFC2904]   Vollbrecht, J., Calhoun,\
    \ P., Farrell, S., Gommans, L.,\n               Gross, G., de Bruijn, B., de Laat,\
    \ C., Holdrege, M. and\n               D. Spence, \"AAA Authorization Framework\"\
    , RFC 2904,\n               August 2000.\n   [RFC2905]   Vollbrecht, J., Calhoun,\
    \ P., Farrell, S., Gommans, L.,\n               Gross, G., de Bruijn, B., de Laat,\
    \ C., Holdrege, M. and\n               D. Spence, \"AAA Authorization Application\
    \ Examples\", RFC\n               2905, August 2000.\n   [RFC2924]   Brownlee,\
    \ N. and  A. Blount, \"Accounting Attributes and\n               Record Formats\"\
    , RFC 2924, September 2000.\n   [RFC2975]   Aboba, B., Arkko, J. and D. Harrington,\
    \ \"Introduction to\n               Accounting Management\", RFC 2975, October\
    \ 2000.\n   [RFC2989]   Aboba, B., Calhoun, P., Glass, S., Hiller, T., McCann,\n\
    \               P., Shiino, H., Walsh, P., Zorn, G., Dommety, G.,\n          \
    \     Perkins, C., Patil, B., Mitton, D.,  Manning, S.,\n               Beadles,\
    \ M., Chen, X., Sivalingham, S., Hameed, A.,\n               Munson, M., Jacobs,\
    \ S., Lim, B., Hirschman, B., Hsu, R.,\n               Koo, H., Lipford, M., Campbell,\
    \ E., Xu, Y., Baba, S. and\n               E. Jaques, \"Criteria for Evaluating\
    \ AAA Protocols for\n               Network Access\", RFC 2989, November 2000.\n\
    \   [RFC3198]   Westerinen, A., Schnizlein, J., Strassner, J., Scherling,\n  \
    \             M., Quinn, B., Herzog, S., Huynh, A., Carlson, M., Perry,\n    \
    \           J. and S. Waldbusser, \"Terminology for Policy-Based\n           \
    \    Management\", RFC 3198, November 2001.\n"
- title: 12. Acknowledgments
  contents:
  - "12. Acknowledgments\n   The authors would like to thank the members of the AAAARCH\
    \ research\n   group and in particular, the chairs, John Vollbrecht and Cees de\n\
    \   Laat, for the fruitful discussions and comments.  Special thanks are\n   to\
    \ Bernard Aboba, Nevil Brownlee and Ed Ellesson for their review and\n   valuable\
    \ input to this document.\n"
- title: Author's Addresses
  contents:
  - "Author's Addresses\n   Tanja Zseby\n   Fraunhofer Institute for Open Communication\
    \ Systems\n   Kaiserin-Augusta-Allee 31\n   10589 Berlin\n   Germany\n   Phone:\
    \ +49-30-34 63 7153\n   Fax:   +49-30-34 53 8153\n   EMail: zseby@fokus.fhg.de\n\
    \   Sebastian Zander\n   Fraunhofer Institute for Open Communication Systems\n\
    \   Kaiserin-Augusta-Allee 31\n   10589 Berlin\n   Germany\n   Phone: +49-30-34\
    \ 63 7287\n   Fax:   +49-30-34 63 8287\n   EMail: zander@fokus.fhg.de\n   Georg\
    \ Carle\n   Fraunhofer Institute for Open Communication Systems\n   Kaiserin-Augusta-Allee\
    \ 31\n   10589 Berlin\n   Germany\n   Phone: +49-30-34 63 7149\n   Fax:   +49-30-34\
    \ 63 8149\n   EMail: carle@fokus.fhg.de\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2002).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
