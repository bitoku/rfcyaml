- title: __initial_text__
  contents:
  - '      Applicability of MPLS Transport Profile for Ring Topologies

    '
- title: Abstract
  contents:
  - "Abstract\n   This document presents an applicability of existing MPLS protection\n\
    \   mechanisms, both local and end-to-end, to the MPLS Transport Profile\n   (MPLS-TP)\
    \ in ring topologies.  This document does not propose any new\n   mechanisms or\
    \ protocols.  Requirements for MPLS-TP protection\n   especially for protection\
    \ in ring topologies are discussed in\n   \"Requirements of an MPLS Transport\
    \ Profile\" (RFC 5654) and \"MPLS\n   Transport Profile (MPLS-TP) Survivability\
    \ Framework\" (RFC 6372).\n   This document discusses how most of the requirements\
    \ are met by\n   applying linear protection as defined in RFC 6378 in a ring topology.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6974.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2013 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n     1.1.  Problem Statement  . . . . . . . . . . . . . . .\
    \ . . . . .  3\n     1.2.  Scope of the Document  . . . . . . . . . . . . . .\
    \ . . . .  4\n     1.3.  Terminology and Notation . . . . . . . . . . . . . .\
    \ . . .  5\n   2.  Point-to-Point (P2P) Ring Protection . . . . . . . . . . .\
    \ . .  6\n     2.1.  Wrapping . . . . . . . . . . . . . . . . . . . . . . . .\
    \ .  6\n     2.2.  Steering . . . . . . . . . . . . . . . . . . . . . . . . .\
    \  8\n     2.3.  SPME for P2P Protection of a Ring Topology . . . . . . . . 10\n\
    \       2.3.1.  Path SPME for Steering . . . . . . . . . . . . . . . . 11\n  \
    \     2.3.2.  Wrapping Link Protection with Segment-Based SPME . . . 12\n    \
    \   2.3.3.  Wrapping Node Protection . . . . . . . . . . . . . . . 13\n      \
    \ 2.3.4.  Wrapping for Link and Node Protection  . . . . . . . . 14\n     2.4.\
    \  Analysis of P2P Protection . . . . . . . . . . . . . . . . 15\n       2.4.1.\
    \  Recommendations for Protection of P2P Paths\n               Traversing a Ring\
    \  . . . . . . . . . . . . . . . . . . 16\n   3.  Point-to-Multipoint Protection\
    \ . . . . . . . . . . . . . . . . 17\n     3.1.  Wrapping for P2MP LSPs . . .\
    \ . . . . . . . . . . . . . . . 17\n       3.1.1.  Comparison of Wrapping and\
    \ ROM-Wrapping  . . . . . . . 19\n       3.1.2.  Multiple Failures Comparison\
    \ . . . . . . . . . . . . . 20\n     3.2.  Steering for P2MP Paths  . . . . .\
    \ . . . . . . . . . . . . 21\n       3.2.1.  Context Labels . . . . . . . . .\
    \ . . . . . . . . . . . 21\n       3.2.2.  Walk-Through Using Context Labels \
    \ . . . . . . . . . . 23\n   4.  Coordination Protocol  . . . . . . . . . . .\
    \ . . . . . . . . . 26\n   5.  Conclusions and Recommendations  . . . . . . .\
    \ . . . . . . . . 26\n   6.  Security Considerations  . . . . . . . . . . . .\
    \ . . . . . . . 27\n   7.  References . . . . . . . . . . . . . . . . . . . .\
    \ . . . . . . 27\n     7.1.  Normative References . . . . . . . . . . . . . .\
    \ . . . . . 27\n     7.2.  Informative References . . . . . . . . . . . . . .\
    \ . . . . 27\n   Appendix A.  Acknowledgements  . . . . . . . . . . . . . . .\
    \ . . . 29\n   Appendix B.  Contributors  . . . . . . . . . . . . . . . . . .\
    \ . . 29\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The MPLS Transport Profile (MPLS-TP) has been standardized\
    \ as part of\n   a joint effort between the Internet Engineering Task Force (IETF)\
    \ and\n   the International Telecommunications Union Telecommunications\n   Standardization\
    \ Sector (ITU-T).  These specifications are based on\n   the requirements that\
    \ were generated from this joint effort.\n   The MPLS-TP requirement document\
    \ [RFC5654] includes a requirement to\n   support a network that may include subnetworks\
    \ that constitute an\n   MPLS-TP ring as defined in the document.  However, the\
    \ document does\n   not identify any protection requirements specific to a ring\
    \ topology.\n   The requirements state that specific protection mechanisms applying\n\
    \   to ring topologies may be developed if these allow the network to\n   minimize:\n\
    \   o  the number of OAM entities needed to trigger the protection\n   o  the\
    \ number of elements of recovery needed\n   o  the number of labels required\n\
    \   o  the number of control- and management-plane transactions during a\n   \
    \   maintenance operation\n   o  the impact of signaling and routing information\
    \ exchanged during\n      protection, in the presence of a control plane\n   This\
    \ document describes how applying a set of basic MPLS-TP linear\n   protection\
    \ mechanisms defined in [RFC6378] can be used to provide\n   protection of the\
    \ data flows that traverse an MPLS-TP ring.  These\n   mechanisms provide data\
    \ flow protection due to any switching trigger\n   within a reasonable time frame\
    \ and optimize the criteria set out in\n   [RFC5654], as summarized above.  This\
    \ document does not define any\n   new protocol mechanisms or procedures.\n  \
    \ A related topic in [RFC5654] addresses the required support for\n   interconnected\
    \ rings.  This topic involves various scenarios that\n   require further study\
    \ and will be addressed in a separate document,\n   based on the principles outlined\
    \ in this document.\n"
- title: 1.1.  Problem Statement
  contents:
  - "1.1.  Problem Statement\n   Ring topologies, as defined in [RFC5654], are used\
    \ in transport\n   networks.  When designing a protection mechanism for a single\
    \ ring\n   topology, there is a need to address both of the following cases.\n\
    \   1.  A point-to-point transport path that originates at a ring node or\n  \
    \     enters an MPLS-TP-capable ring at a single ingress node, and\n       exits\
    \ the ring at a single egress node, and possibly continues\n       beyond the\
    \ ring.\n   2.  Where the ring is being used as a branching point for a point-to-\n\
    \       multipoint transport path, i.e., the transport path originates at\n  \
    \     or enters the MPLS-TP-capable ring at the ingress node and exits\n     \
    \  through a number of egress nodes, possibly continuing beyond the\n       ring.\n\
    \   In either of these two situations, there is a need to address the\n   following\
    \ different cases.\n   1.  One of the ring links causes a fault condition.  This\
    \ could be\n       either a unidirectional or bidirectional fault, and it should\
    \ be\n       detected by the neighboring nodes.\n   2.  One of the ring nodes\
    \ causes a fault condition.  This condition\n       is invariably a bidirectional\
    \ fault (although in rare cases of\n       misconfiguration, this could be detected\
    \ as a unidirectional\n       fault), and it should be detected by the two neighboring\
    \ ring\n       nodes.\n   3.  An operator command is issued to a specific ring\
    \ node; it either\n       changes the operational state of a node or a link or\
    \ explicitly\n       triggers a protection action.  An operator command changes\
    \ the\n       operational state of a node or a link, or specifically triggers\
    \ a\n       protection action is issued to a specific ring node.  A\n       description\
    \ of the different operator commands is found in\n       Section 4.13 of [RFC4427].\
    \  Examples of these commands include\n       Manual Switch, Forced Switch, and\
    \ Clear operations.\n   The protection domain addressed in this document is limited\
    \ to the\n   traffic that traverses on the ring.  Protection triggers on the\n\
    \   transport path prior to the ingress node of the ring or beyond the\n   egress\
    \ nodes may be protected by some other mechanism.\n"
- title: 1.2.  Scope of the Document
  contents:
  - "1.2.  Scope of the Document\n   This document addresses the requirements that\
    \ appear in Section\n   2.5.6.1 of [RFC5654] on ring protection, based on the\
    \ application of\n   the linear protection as defined in [RFC6378].  Requirement\
    \ R93\n   regarding the support of interconnected rings and protection of\n  \
    \ faults in the interconnection nodes and links is for further study.\n   In addition,\
    \ requirement R105 requiring the support of lockout of\n   specific nodes or spans\
    \ is only supported to the degree that it is\n   supported by the linear protection\
    \ mechanism.\n"
- title: 1.3.  Terminology and Notation
  contents:
  - "1.3.  Terminology and Notation\n   The terminology used in this document is based\
    \ on the terminology\n   defined in the MPLS-TP framework documents:\n   o  MPLS-TP\
    \ framework [RFC5921]\n   o  MPLS-TP OAM framework [RFC6371]\n   o  MPLS-TP survivability\
    \ framework [RFC6372]\n   The MPLS-TP framework document [RFC5921] defines a Sub-Path\n\
    \   Maintenance Entity (SPME) construct that can be defined between any\n   two\
    \ Label Switching Routers (LSRs) of an MPLS-TP Label Switched Path\n   (LSP).\
    \  This SPME may be configured as a co-routed bidirectional\n   path.  The SPME\
    \ is defined to allow management and monitoring of any\n   segment of a transport\
    \ path.  This concept will be used extensively\n   throughout the document to\
    \ support protection of the traffic that\n   traverses an MPLS-TP ring.\n   In\
    \ addition, we describe the use of the label stack in connection\n   with the\
    \ redirecting of data packets by the protection mechanism.\n   The following syntax\
    \ will be used to describe the contents of the\n   label stack:\n   1.  The label\
    \ stack will be enclosed in square brackets (\"[]\").\n   2.  Each level in the\
    \ stack will be separated by the '|' character.\n       It should be noted that\
    \ the label stack may contain additional\n       levels; however, we only present\
    \ the levels that are germane to\n       the protection mechanism.\n   3.  When\
    \ applicable, the S bit (signifying that a given label is the\n       bottom of\
    \ the label stack) will be denoted by the string '+S'\n       within the label.\
    \  If a label is not shown with '+S' , that label\n       may or may not be the\
    \ bottom label in the stack. '+S' is only\n       shown when it is important to\
    \ illustrate that a given label is\n       definitely the last one in the label\
    \ stack.\n   4.  The label of the LSP at the ingress node of the ring will be\n\
    \       denoted by the string \"LI\", and the label of the LSP that is\n     \
    \  expected at the egress point from the ring will be denoted by the\n       string\
    \ \"LE\".  \"LSE\" will denote the label expected at the exit\n       LSR of a\
    \ SPME (if it is different from the egress point from the\n       ring, for example,\
    \ as described in Section 2.3).\n   5.  The label Pxi(y) in the stack denotes\
    \ the label that LSR-x would\n       use to transport the packet to LSR-y over\
    \ the SPME whose index is\n       i.\n   For example:\n   o  The label stack [LI]\
    \ denotes the label stack received at the\n      ingress node of the ring.  There\
    \ may be additional labels after\n      LI, e.g., a PW label; however, this is\
    \ irrelevant to the\n      discussion of the protection scenario.\n   o  [PB1(G)\
    \ | LE] denotes a stack whose top label is the SPME-1 label\n      for LSR-B to\
    \ transmit the data packet to LSR-G, and the second\n      label is the label\
    \ that would be used by the egress LSR to\n      continue to transmit the packet\
    \ on the original LSP.\n   o  If \"LE\" were the bottom label in the stack, then\
    \ the label stack\n      would be shown as [PB1(G) | LE+S].\n"
- title: 2.  Point-to-Point (P2P) Ring Protection
  contents:
  - "2.  Point-to-Point (P2P) Ring Protection\n   There are two protection architecture\
    \ mechanisms -- \"Wrapping\" and\n   \"Steering\" -- that have historically been\
    \ applied to ring topologies,\n   based on Synchronous Digital Hierarchy (SDH)\
    \ specifications [G.841],\n   and have been proposed in various forums to perform\
    \ recovery of a\n   topological ring network.  The following subsections examine\
    \ these\n   two mechanisms, as applied to an MPLS transport network.\n"
- title: 2.1.  Wrapping
  contents:
  - "2.1.  Wrapping\n   Wrapping is defined as a local protection architecture.  This\n\
    \   mechanism is local to the nodes that are neighbors to the detected\n   fault.\
    \  When a fault is detected (either a link or node failure), the\n   neighboring\
    \ node can identify that the fault would prevent forwarding\n   of the data along\
    \ the data path.  Therefore, in order to continue to\n   transmit the data along\
    \ the path, there is a need to \"wrap\" all data\n   traffic around the ring,\
    \ on an alternate data path, until the arrives\n   at the node that is on the\
    \ opposite side of the fault.  When this\n   far-side node also detects that there\
    \ is a fault condition on the\n   working path, it can identify that the data\
    \ traffic that is arriving\n   on the alternate (protecting) data path is intended\
    \ for the \"broken\"\n   data path.  Therefore, again making a local decision,\
    \ the far-side\n   node can wrap the data back onto the normal working path until\
    \ the\n   egress from the ring segment.\n   Wrapping behavior is similar to MPLS-TE\
    \ Fast Reroute, as defined in\n   [RFC4090], which uses either bypass or detour\
    \ tunnels.  Applying Fast\n   Reroute to MPLS, it is possible to wrap all LSPs\
    \ using a bypass\n   tunnel and a single label, or to wrap the traffic of each\
    \ LSP around\n   the failed links via a detour tunnel using a different label\
    \ for each\n   LSP.\n                       ___ ######## ___ ######## ___\n  \
    \             ======>/LSR\\********/LSR\\***XX***/LSR\\\n                    \
    \  \\_B_/@@@@@@@@\\_A_/        \\_F_/\n                        *@            \
    \           #*@\n                        *@                       #*@\n      \
    \                  *@                       #*@\n                       _*@  \
    \        ___          #*@\n                      /LSR\\********/LSR\\********/LSR\\\
    ======>\n                      \\_C_/@@@@@@@@\\_D_/@@@@@@@@\\_E_/\n          \
    \       ===> connected LSP  *** physical link\n                 ###  working path\
    \   @@@ wrapped data path\n                Figure 1: Wrapping Protection for P2P\
    \ Path\n   Consider the LSP that is shown in Figure 1 that enters the ring of\n\
    \   LSRs at LSR-B and exits at LSR-E.  The normal working path LSP\n   follows\
    \ through LSRs B-A-F-E.  If a fault is detected on the link\n   A<->F, then the\
    \ wrapping mechanism decides that LSR-A would wrap the\n   traffic around the\
    \ ring, on a wrapped data path A-B-C-D-E-F, to\n   arrive at LSR-F (on the far\
    \ side of the failed link).  LSR-F would\n   then wrap the data packets back onto\
    \ the working path F->E to the\n   egress node.  In this protection scheme, the\
    \ traffic will follow the\n   path B-A-B-C-D-E-F-E.\n   This protection scheme\
    \ is simple in the sense that there is no need\n   for coordination between the\
    \ different LSRs in the ring -- only the\n   LSRs that detect the fault must wrap\
    \ the traffic, either onto the\n   wrapped data path (at the near end) or back\
    \ to the working path (at\n   the far end).  However, coordination of the switchover\
    \ to the\n   protection path would be needed to maintain the traffic on a co-\n\
    \   routed bidirectional LSP even in cases of a unidirectional fault\n   condition.\n\
    \   The following considerations should be taken into account when\n   considering\
    \ use of wrapping protection:\n   o  Detection of mis-connectivity or loss of\
    \ continuity should be\n      performed at the link level and/or per LSR when\
    \ using node-level\n      protection.  Configuration of the protection being performed\n\
    \      (i.e., link protection or node protection) needs to be performed a\n  \
    \    priori, since the configuration of the proper protection path is\n      dependent\
    \ upon this decision.\n   o  There is a need to define a data path that traverses\
    \ the alternate\n      path around the ring to connect between the two neighbors\
    \ of the\n      detected fault.  If protecting both the links and the nodes of\
    \ an\n      LSP, then, for a ring with N nodes, there is a need for O(2N)\n  \
    \    alternate paths.\n   o  When wrapping, the data is transmitted over some\
    \ of the links\n      twice, once in each direction.  For example, in the figure\
    \ above\n      the traffic is transmitted both B->A and then A->B, and later it\n\
    \      is transmitted E->F and F->E.  This means that there is additional\n  \
    \    bandwidth needed for this protection.\n   o  If a double-fault situation\
    \ occurs in the ring, then wrapping will\n      not be able to deliver any packets\
    \ except between the ingress and\n      the first fault location encountered on\
    \ the working path.  This is\n      based on the need for wrapping to connect\
    \ between the neighbors of\n      the fault location, and this is not possible\
    \ in the segmented\n      ring.\n   o  The resource pre-allocation for all of\
    \ the alternate paths could\n      be problematic (causing massive over subscription\
    \ of the available\n      resources).  However, since most of these alternate\
    \ paths will not\n      be used simultaneously, there is the possibility of allocating\n\
    \      zero resources and depending on the Network Management System\n      (NMS)\
    \ to allocate the proper resources around the ring, based on\n      actual traffic\
    \ usage.\n   o  Wrapping also involves a small increase in traffic latency in\n\
    \      delivering the packets, as a result of traversing the entire ring,\n  \
    \    during protection.\n"
- title: 2.2.  Steering
  contents:
  - "2.2.  Steering\n   The second common scheme for ring protection, steering, takes\n\
    \   advantage of the ring topology by defining two paths from the ingress\n  \
    \ node of the ring to the egress point going in opposite directions\n   around\
    \ the ring.  This is illustrated in Figure 2, where if we assume\n   that the\
    \ traffic needs to enter the ring from node B and exit through\n   node F, we\
    \ could define a primary path through nodes B-A-F, and an\n   alternate path through\
    \ the nodes B-C-D-E-F.  In steering, the\n   switching is always performed by\
    \ the ingress node (node B in\n   Figure 2).  If a fault condition is detected\
    \ anywhere on the working\n   path (B-A-F), then the traffic would be redirected\
    \ by B to the\n   alternate path (i.e., B-C-D-E-F).\n                       ___\
    \          ___          ___\n               ======>/LSR\\********/LSR\\********/LSR\\\
    ======>\n                      \\_B_/########\\_A_/########\\_F_/\n          \
    \              *@                       @*\n                        *@       \
    \                @*\n                        *@                       @*\n   \
    \                    _*@          ___          @*_\n                      /LSR\\\
    ********/LSR\\********/LSR\\\n                      \\_C_/@@@@@@@@\\_D_/@@@@@@@@\\\
    _E_/\n                ===> connected LSP     *** physical link\n             \
    \   ###  working path      @@@ protection path\n             Figure 2: Steering\
    \ Protection in an MPLS-TP Ring\n   This mechanism bears similarities to linear\
    \ 1:1 protection [RFC6372].\n   The two paths around the ring act as the working\
    \ and protection\n   paths.  This requires that the ingress node be informed of\
    \ the need\n   to switch over to the protection path, and also that the ingress\
    \ and\n   egress nodes coordinate the switchover.  There is need to communicate\n\
    \   to the ingress node the need to switch over to the protection path\n   and\
    \ there is a need to coordinate the switchover between the two\n   endpoints of\
    \ the protected domain.\n   The following considerations must be taken into account\
    \ regarding the\n   steering architecture:\n   o  Steering relies on a failure\
    \ detection method that is able to\n      notify the ingress node of the fault\
    \ condition.  This may involve\n      OAM functionality described in [RFC6371],\
    \ e.g., Remote Defect\n      Indication, alarm reporting.\n   o  The process of\
    \ notifying the ingress node adds to the latency of\n      the protection-switching\
    \ process, after the detection of the fault\n      condition.\n   o  While there\
    \ is no need for double bandwidth for the data path,\n      there is the necessity\
    \ for the ring to maintain enough capacity\n      for all of the data in both\
    \ directions around the ring.\n"
- title: 2.3.  SPME for P2P Protection of a Ring Topology
  contents:
  - "2.3.  SPME for P2P Protection of a Ring Topology\n   The SPME concept was introduced\
    \ by [RFC5921] to support management\n   and monitoring an arbitrary segment of\
    \ a transport.  However, an SPME\n   is essentially a valid LSP that may be used\
    \ to aggregate all LSP\n   traffic that traverses the sub-path delineated by the\
    \ SPME.  An SPME\n   may be monitored using the OAM mechanisms as described in\
    \ the MPLS-TP\n   OAM framework document [RFC6371].\n   When defining an MPLS-TP\
    \ ring as a protection domain, there is a need\n   to design a protection mechanism\
    \ that protects all the LSPs that\n   cross the MPLS-TP ring.  For this purpose,\
    \ we associate a (working)\n   SPME with the segment of the transport path that\
    \ traverses the ring.\n   In addition, we configure an alternate (protecting)\
    \ SPME that\n   traverses the ring in the opposite direction around the ring.\
    \  The\n   exact selection of the SPMEs is dependent on the types of transport\n\
    \   path and protection that are being implemented.  This will be\n   detailed\
    \ in the following subsections.\n   Based on this architectural configuration\
    \ for protection of ring\n   topologies, it is possible to limit the number of\
    \ alternate paths\n   needed to protect the data traversing the ring.  In addition,\
    \ since\n   we will perform all of the OAM functionality on the SPME configured\n\
    \   for the traffic, we can minimize the number of OAM sessions needed to\n  \
    \ monitor the data traffic of the ring, rather than monitoring each\n   individual\
    \ LSP.\n   In all of the following subsections, we use 1:1 linear protection\n\
    \   [RFC6372] [RFC6378] to perform protection switching and coordination\n   when\
    \ a signal fault is detected.  The actual configuration of the\n   SPMEs used\
    \ may change depending upon the choice of methodology, and\n   this will be detailed\
    \ in the following sections.  However, in all of\n   these configurations, the\
    \ mechanism will be to transmit the data\n   traffic on the primary SPME, while\
    \ applying OAM functionality over\n   both the primary and the secondary SPME\
    \ to detect signal fault\n   conditions on either path.  If a signal fault is\
    \ detected on the\n   primary SPME, then the mechanism described in [RFC6378]\
    \ shall be used\n   to coordinate a switchover of data traffic to the secondary\
    \ SPME.\n   Assuming that the SPME is implemented as an hierarchical LSP, packets\n\
    \   that arrive at LSR-B with a label stack [LI] will have the SPME label\n  \
    \ pushed at LSR-B, and the LSP label will be swapped for the label that\n   is\
    \ expected by the egress LSR (i.e., the packet will arrive at LSR-A\n   with a\
    \ label stack of [PA1(B) | LE] and arrive at LSR-F with [PE1(F)\n   | LE]).  The\
    \ SPME label will be popped by LSR-F, and the LSP label\n   will be treated appropriately\
    \ at LSR-F and forwarded along the LSP,\n   outside the ring.  This scenario is\
    \ true for all LSPs that are\n   aggregated by this primary SPME.\n"
- title: 2.3.1.  Path SPME for Steering
  contents:
  - "2.3.1.  Path SPME for Steering\n   A P2P SPME that traverses part of a ring has\
    \ two Maintenance Entity\n   Group End Points (MEPs), each one acts as the ingress\
    \ and egress in\n   one direction of the bidirectional SPME.  Since the SPME is\n\
    \   traversing a ring, we can take advantage of another characteristic of\n  \
    \ a ring -- there is always an alternative path between the two MEPs,\n   i.e.,\
    \ traversing the ring in the opposite direction.  This\n   alternative SPME can\
    \ be defined as the protection path for the\n   working path that is configured\
    \ as part of the LSP and defined as a\n   SPME.\n   For each pair of SPMEs that\
    \ are defined in this way, it is possible\n   to verify the connectivity and continuity\
    \ by applying the MPLS-TP OAM\n   functionality to both the working and protection\
    \ SPME.  If a\n   discontinuity or mis-connectivity is detected, then the MEPs\
    \ will\n   become aware of this condition and could perform a protection switch\n\
    \   of all LSPs to the alternate, protection SPME.\n   The following figure shows\
    \ an MPLS-TP ring that is part of a larger\n   MPLS-TP network.  The ring could\
    \ be used as a network segment that\n   may be traversed by numerous LSPs.  In\
    \ particular, the figure shows\n   that for all LSPs that connect to the ring\
    \ at LSR-B and exit the ring\n   from LSR-F, we configure two SPMEs through the\
    \ ring (the first SPME\n   traverses B-A-F, and the second SPME traverses B-C-D-E-F).\n\
    \                       ___          ___          ___\n                =====>/LSR\\\
    ********/LSR\\********/LSR\\======>\n                      \\_B_/########\\_A_/########\\\
    _F_/\n                        *@                       @*\n                  \
    \      *@                       @*\n                        *@               \
    \        @*\n                       _*@          ___          @*_\n          \
    \            /LSR\\********/LSR\\********/LSR\\\n                      \\_C_/@@@@@@@@\\\
    _D_/@@@@@@@@\\_E_/\n                 ===> connected LSP    *** physical link\n\
    \                 ###  primary SPME     @@@ secondary SPME\n                 \
    \        Figure 3: An MPLS-TP Ring\n   This protection mechanism is identical\
    \ to the application of 1:1\n   linear protection [RFC6372] [RFC6378] to the pair\
    \ of SPMEs.  Under\n   normal conditions, all LSP data traffic will be transmitted\
    \ on the\n   working SPME.  If the linear protection is triggered by the OAM\n\
    \   indication, another fault indication trigger, or an operator command,\n  \
    \ then the MEPs will select the protection SPME to transmit all LSP\n   data packets.\n\
    \   The protection SPME will continue to transmit the data packets until\n   the\
    \ stable recovery of the fault condition.  Upon recovery, i.e., the\n   fault\
    \ condition has cleared and the network is stabilized, the\n   ingress LSR could\
    \ switch traffic back to the working SPME, if the\n   protection domain is configured\
    \ for revertive behavior.\n   The control of the protection switching, especially\
    \ for cases of\n   operator commands, would be covered by the protocol defined\
    \ in\n   [RFC6378].\n"
- title: 2.3.2.  Wrapping Link Protection with Segment-Based SPME
  contents:
  - "2.3.2.  Wrapping Link Protection with Segment-Based SPME\n   It is possible to\
    \ use the SPME mechanism to perform segment-based\n   protection.  For each link\
    \ in the ring, we define two SPMEs -- the\n   first is a SPME between the two\
    \ LSRs that are connected by the link,\n   and the second SPME is between those\
    \ same two LSRs but traverses the\n   entire ring (except the link that connects\
    \ the LSRs).  In Figure 4,\n   we show the primary SPME that connects LSR-A and\
    \ LSR-F over a segment\n   connection, and the secondary SPME that connects these\
    \ same LSRs by\n   traversing the ring in the opposite direction.\n          \
    \              ___          ___          ___\n                       /LSR\\********/LSR\\\
    ********/LSR\\\n                       \\_B_/@@@@@@@@\\_A_/########\\_F_/\n  \
    \                       *@                        *@\n                       \
    \  *@                        *@\n                         *@                 \
    \       *@\n                        _*@          ___          _*@\n          \
    \             /LSR\\********/LSR\\********/LSR\\\n                       \\_C_/@@@@@@@@\\\
    _D_/@@@@@@@@\\_E_/\n                  *** physical link\n                  ###\
    \ primary SPME      @@@ secondary SPME\n                          Figure 4: Segment\
    \ SPMEs\n   By applying OAM monitoring of these two SPMEs (at each LSR), it is\n\
    \   possible to effect a wrapping protection mechanism for the LSP\n   traffic\
    \ that traverses the ring.  The LSR on either side of the\n   segment would identify\
    \ that there is a fault condition on the link\n   and redirect all LSP traffic\
    \ to the secondary SPME.  The traffic\n   would traverse the ring until arriving\
    \ at the neighboring (relative\n   to the segment) LSR.  At this point, the LSP\
    \ traffic would be\n   redirected onto the original LSP, quite likely over the\
    \ neighboring\n   SPME.\n   Following the progression of the label stack through\
    \ this switching\n   operation (for a LSP that enters the ring at LSR-B and exits\
    \ the ring\n   at LSR-E):\n   1.  The data packet arrives at LSR-A with label\
    \ stack [L1+S] (i.e.,\n       the top label from the LSP and bottom-of-stack indicator)\n\
    \   2.  In the normal case (no protection switching), LSR-A forwards the\n   \
    \    packet with label stack [PA1(F) | LSE+S] (i.e., swaps the label\n       for\
    \ the LSP, to be acceptable to the SPME egress, and pushes the\n       label for\
    \ the primary SPME from LSR-A to LSR-F).\n   3.  When protection switching is\
    \ in effect, LSR-A forwards the packet\n       with label stack [PA2(B) | LSE+S]\
    \ (i.e., LSR-A pushes the label\n       for the secondary SPME from LSR-A to LSR-F,\
    \ after swapping the\n       label of the lower-level LSP).  This will be transmitted\
    \ along\n       the secondary SPME until LSR-E forwards it to LSR-F with label\n\
    \       stack [PE2(F) | LSE+S].\n   4.  When the packet arrives at LSR-F, it pops\
    \ the SPME label, process\n       the LSP label, and forwards the packet to the\
    \ next point,\n       possibly pushing a SPME label if the next segment is likewise\n\
    \       protected.\n"
- title: 2.3.3.  Wrapping Node Protection
  contents:
  - "2.3.3.  Wrapping Node Protection\n   Implementation of protection at the node\
    \ level would be similar to\n   the mechanism described in the previous subsection.\
    \  The difference\n   would be in the SPMEs that are used.  For node protection,\
    \ the\n   primary SPME would be configured between the two LSRs that are\n   connected\
    \ to the node that is being protected (see the SPME between\n   LSR-A and LSR-E\
    \ through LSR-F in Figure 5), and the secondary SPME\n   would be configured between\
    \ these same nodes, going around the ring\n   (see the secondary SPME in Figure\
    \ 5).\n                        ___          ___          ___\n               \
    \        /LSR\\********/LSR\\********/LSR\\\n                       \\_B_/@@@@@@@@\\\
    _A_/########\\_F_/\n                         *@                        *#\n  \
    \                       *@                        *#\n                       \
    \  *@                        *#\n                        _*@          ___    \
    \      _*#\n                       /LSR\\********/LSR\\********/LSR\\\n      \
    \                 \\_C_/@@@@@@@@\\_D_/@@@@@@@@\\_E_/\n                  *** physical\
    \ link\n                  ### primary SPME      @@@ secondary SPME\n         \
    \             Figure 5: Node-Protection SPMEs\n   The protection mechanism would\
    \ work similarly -- it would be based on\n   1:1 linear protection [RFC6372] and\
    \ be triggered by OAM functions on\n   both SPMEs.  It would wrap the data packets\
    \ onto the secondary SPME\n   at the ingress MEP (e.g., LSR-A in the figure) of\
    \ the SPME and back\n   onto the continuation of the LSP at the egress MEP (e.g.,\
    \ LSR-E in\n   the figure) of the SPME.\n"
- title: 2.3.4.  Wrapping for Link and Node Protection
  contents:
  - "2.3.4.  Wrapping for Link and Node Protection\n   In the different types of wrapping\
    \ presented in Section 2.3.2 and\n   Section 2.3.3, there is a limitation that\
    \ the protection mechanism\n   must a priori decide whether it is protecting against\
    \ link or node\n   failure.  In addition, the neighboring LSR, that detects the\
    \ fault,\n   cannot readily differentiate between a link failure or a node\n \
    \  failure.\n   It would be possible to configure extra SPMEs to protect both\
    \ for\n   link and node failures, arriving at a configuration of the ring that\n\
    \   is shown in Figure 6.  Here, there are three protection SPMEs\n   configured:\n\
    \   o  Secondary node#1 would be used to divert traffic as a result of an\n  \
    \    indication that LSR-F is not available; it redirects the traffic\n      to\
    \ the path between LSR-A and LSR-E.\n   o  Secondary node#2 would be used to divert\
    \ traffic as a result of an\n      indication that LSR-A is not available; it\
    \ redirects the traffic\n      to the path between LSR-F and LSR-B.\n   o  Secondary\
    \ segment would be used to divert traffic as a result of\n      an indication\
    \ that the segment between LSR-A and LSR-F is not\n      available; it redirects\
    \ the traffic to the path between LSR-A and\n      LSR-F on the long circuit of\
    \ the ring.\n   However, choosing the SPME to use for the wrapping would then\
    \ involve\n   considerable effort and could result in the protected traffic not\n\
    \   sharing the same protection path in both directions.\n                   \
    \       ___ ++++++++ ___          ___\n                         /LSR\\********/LSR\\\
    ********/LSR\\\n                         \\_B_/@@@@@@@@\\_A_/########\\_F_/\n\
    \                         $+*@                       +*$\n                   \
    \      $+*@                       +*$\n                         $+*@         \
    \              +*$\n                         $+*@ ++++++++ ___ ++++++++ +*$\n\
    \                         /LSR\\********/LSR\\********/LSR\\\n               \
    \          \\_C_/@@@@@@@@\\_D_/@@@@@@@@\\_E_/\n                              $$$$$$$$\
    \     $$$$$$$$\n           *** physical link\n           ### primary SPME    \
    \        @@@ secondary node#1 SPME\n           $$$ secondary node#2 SPME   +++\
    \ secondary segment SPME\n             Figure 6: SPMEs for Protecting Segments\
    \ and Node\n"
- title: 2.4.  Analysis of P2P Protection
  contents:
  - "2.4.  Analysis of P2P Protection\n   Analyzing steering SPME protection (Section\
    \ 2.3.1) and wrapping based\n   on SPME (Sections 2.3.2 or 2.3.3), we can make\
    \ the following\n   observations (based on a ring with N nodes, where N is not\
    \ more than\n   16):\n   o  Number of SPMEs that need to be configured\n     \
    \    For steering: O(2N^2).  There are two SPMEs from each ingress\n         LSR\
    \ to each of the other nodes in the ring.\n         For wrapping: O(2N).  (However,\
    \ the operator must decide a\n         priori whether to protect for link failures\
    \ or node failures at\n         each point.)\n   o  Number of OAM sessions at\
    \ each node\n         For steering: O(2N)\n         For wrapping: 3\n   o  Bandwidth\
    \ requirements\n         For steering: single bandwidth at each link\n       \
    \  For wrapping: double bandwidth at links that are between\n         ingress\
    \ and wrapping node and between second wrapping node and\n         egress.\n \
    \  o  Special considerations\n         For steering: latency of OAM detection\
    \ of fault condition by\n         ingress MEP.  (Using alarm reporting could optimize\
    \ over using\n         CC-V only.)\n         For wrapping: each node must decide\
    \ a priori whether it is\n         protecting for link or node failures.  To protect\
    \ for both node\n         and link failures would increase the complexity of deciding\n\
    \         which protection path to use, as well as violate the co-\n         routedness\
    \ of the protected traffic.\n   Based on this analysis, using steering as described\
    \ in Section 2.3.1\n   would be the recommended protection mechanism due to its\
    \ simplicity.\n   It should be pointed out that the number of SPMEs involved in\
    \ this\n   protection could be reduced by eliminating each SPME between a pair\n\
    \   of LSRs that is not used as an ingress and egress pair.\n"
- title: 2.4.1.  Recommendations for Protection of P2P Paths Traversing a Ring
  contents:
  - "2.4.1.  Recommendations for Protection of P2P Paths Traversing a Ring\n   Based\
    \ on the analysis presented, while applying linear protection to\n   effect wrapping\
    \ protection in a ring topology is possible as\n   demonstrated, there are certain\
    \ limitations in addressing some of the\n   required behavior.  The limitations\
    \ include:\n   o  the need to configure a priori whether link or node protection\n\
    \      will be provided\n   o  the higher number of SPMEs that need to be defined\n\
    \   o  the difficulty in addressing cases of multiple failures in the\n      ring\n\
    \   Application of linear protection, based on the use of SPMEs within\n   the\
    \ ring, to implement a steering methodology to protect a ring\n   topology is\
    \ rather straightforward, overcomes the limitations listed\n   above, and scales\
    \ very well.  For this and other reasons listed\n   previously, the authors recommend\
    \ the use of steering to provide\n   protection of P2P paths that traverse a ring\
    \ topology.\n"
- title: 3.  Point-to-Multipoint Protection
  contents:
  - "3.  Point-to-Multipoint Protection\n   [RFC5654] requires that ring protection\
    \ must provide protection for\n   unidirectional point-to-multipoint paths through\
    \ the ring.  Ring\n   topologies provide a ready platform for supporting such\
    \ data paths.\n   A point-to-multipoint (P2MP) LSP in an MPLS-TP ring would be\n\
    \   characterized by a single ingress LSR and multiple egress LSRs.  The\n   following\
    \ subsections will present methods to address the protection\n   of the ring-based\
    \ sections of these LSPs.\n"
- title: 3.1.  Wrapping for P2MP LSPs
  contents:
  - "3.1.  Wrapping for P2MP LSPs\n   When protecting a P2MP ring data path using\
    \ the wrapping\n   architecture, the basic operation is similar to the description\n\
    \   given, as the traffic has been wrapped back onto the normal working\n   path\
    \ on the far side of the detected fault and will continue to be\n   transported\
    \ to all of the egress points.\n   It is possible to optimize the performance\
    \ of the wrapping mechanism\n   when applied to P2MP LSPs by exploiting the topology\
    \ of ring\n   networks.\n   This improved mechanism, which we call Ring Optimized\
    \ Multipoint\n   Wrapping (ROM-Wrapping), behaves much the same as classical wrapping.\n\
    \   However, ROM-Wrapping configures a protection P2MP LSP, relative to\n   each\
    \ node that is considered a failure risk.  The protection P2MP LSP\n   will be\
    \ routed between the failure risk node's upstream neighbor to\n   all of the egress\
    \ nodes (for the particular LSP) that are downstream\n   of the failure risk node.\n\
    \   Referring to Figure 7, it is possible to identify the protected\n   (working)\
    \ LSP (A-B-{C}-{D}-E-{F}) and one possible backup\n   (protection) LSP.  (Note:\
    \ the egress nodes are indicated by the curly\n   braces.)  This protection LSP\
    \ will be used to wrap the data back\n   around the ring to protect against a\
    \ failure on link B-C.  This\n   protection LSP is also a P2MP LSP that is configured\
    \ with egress\n   points (at nodes F, D, and C) complementary to the broken working\n\
    \   data path.\n                                  |\n                        \
    \          |\n                                  V  Ingress\n               ___\
    \               _V_                ___\n              /LSR\\             /LSR\\\
    **************/LSR\\\n           <@@\\_F_/@@@@@@@@@@@@@\\_A_/@@@@@@@@@@@@@@\\\
    _B_/\n               @ *                                    *\n              \
    \ @ *                                    *\n               @ *               \
    \                   XXXX Failure\n               @ *                         \
    \           *\n               @_*               ___                __*\n     \
    \         /LSR\\*************/LSR\\**************/LSR\\\n              \\_E_/@@@@@@@@@@@@@\\\
    _D_/@@@@@@@@@@@@@@\\_C_/\n                                 @                 \
    \ @\n                                 @                  @\n                 \
    \                V                  V\n               ***  working LSP      @@@\
    \ protection LSP\n                        Figure 7: P2MP ROM-Wrapping\n   Using\
    \ this mechanism, there is a need to configure a particular\n   protection LSP\
    \ for each node on the working LSP.  In the table below,\n   \"X's Backup\" is\
    \ the backup path activated by node X as a consequence\n   of a failure affecting\
    \ node Y (downstream node with respect to X) or\n   link X-Y.  (Note: Braces in\
    \ the path indicate egress nodes.)\n                   Protected LSP: A->B->{C}->{D}->E->{F}\n\
    \                        -- LINK/NODE PROTECTION --\n              A's Backup:\
    \              A->{F}->E->{D}->{C}\n              B's Backup:              B->A->{F}->E->{D}->{C}\n\
    \              C's Backup:              C->B->A->{F}->E->{D}\n              D's\
    \ Backup:              D->C->B->A->{F}\n              E's Backup:            \
    \  E->D->C->B->A->{F}\n   It should be noted that ROM-Wrapping is an LSP-based\
    \ protection\n   mechanism, as opposed to the SPME-based protection mechanisms\
    \ that\n   are presented in other sections of this document.  While this may\n\
    \   seem to be limited in scope, the mechanism may be very efficient for\n   many\
    \ applications that are based on P2MP distribution schemes.  While\n   ROM-Wrapping\
    \ can be applied to any network topology, it is\n   particularly efficient for\
    \ interconnected ring topologies.\n"
- title: 3.1.1.  Comparison of Wrapping and ROM-Wrapping
  contents:
  - "3.1.1.  Comparison of Wrapping and ROM-Wrapping\n   It is possible to compare\
    \ the wrapping and the ROM-Wrapping\n   mechanisms in various aspects and show\
    \ some improvements offered by\n   ROM-Wrapping.\n   When configuring the protection\
    \ LSP for wrapping, it is necessary to\n   configure for a specific failure: link\
    \ protection or node protection.\n   If the protection method is configured to\
    \ protect against node\n   failures, but the actual failure affects a link, this\
    \ could result in\n   failing to deliver traffic to the node, when it should be\
    \ possible to\n   do so.\n   ROM-Wrapping, however, does not have this limitation\
    \ because there is\n   no distinction between node and link protection.  Whether\
    \ link B-C or\n   node C fails, the rerouting will attempt to reach C. If the\
    \ failure\n   is on the link, the traffic will be delivered to C; if the failure\
    \ is\n   at node C, the traffic will be rerouted correctly until node D, and\n\
    \   will be blocked at this point.  However, all egress nodes up to the\n   failure\
    \ will be able to deliver the traffic properly.\n   A second aspect is the number\
    \ of hops needed to properly deliver the\n   traffic.  Referring to the example\
    \ shown in Figure 7, where a failure\n   is detected on link B-C, the following\
    \ table lists the set of nodes\n   traversed by the data in the protection:\n\
    \                              Basic Wrapping:\n   A-B                   B-A-F-E-D-C\
    \              {C}-{D}-E-{F}\n   \"Upstream\" segment    backup path         \
    \     \"Downstream\" segment\n   with respect to the                         \
    \   with respect to the\n   failure                                        failure\n\
    \                               ROM-Wrapping:\n   A-B                  B-A-{F}-E-{D}-{C}\
    \        ..\n   \"Upstream\" segment   backup path\n   with respect to the\n \
    \  failure\n   Comparing the two lists of nodes, it is possible to see that in\
    \ this\n   particular case the number of hops crossed when basic wrapping is\n\
    \   used is significantly higher than the number of hops crossed by the\n   traffic\
    \ when ROM-Wrapping is used.  Generally, the number of hops for\n   basic wrapping\
    \ is always greater than or equal to that for ROM-\n   Wrapping.  This implies\
    \ a certain waste of bandwidth on all links\n   that are crossed in both directions.\n\
    \   Considering the ring network in Figure 7, it is possible to consider\n   the\
    \ bandwidth utilization.  The protected LSP is set up from A to F\n   clockwise\
    \ and an M Mbps bandwidth is reserved along the path.  All\n   the protection\
    \ LSPs are pre-provisioned counterclockwise, each of\n   them may also have reserved\
    \ bandwidth M.  These LSPs share the same\n   bandwidth in a SE (Shared Explicit)\
    \ style, as described in [RFC2205].\n   The bandwidth reserved counterclockwise\
    \ is not used when the\n   protected LSP is properly working and, in theory, could\
    \ be used for\n   extra traffic [RFC4427].  However, it should be noted that [RFC5654]\n\
    \   does not require support of such extra traffic.\n   The two recovery mechanisms\
    \ require different protection bandwidths.\n   In the case of wrapping, the bandwidth\
    \ used is M in both directions\n   on many of the links.  While in the case of\
    \ ROM-Wrapping, only the\n   links from the ingress node to the node performing\
    \ the actual\n   wrapping utilize M bandwidth in both directions, while all other\n\
    \   links utilize M bandwidth only in the counterclockwise direction.\n   Consider\
    \ the case of a failure detected on link B-C as shown in\n   Figure 7.  The following\
    \ table lists the bandwidth utilization on\n   each link (in units equal to M),\
    \ for each recovery mechanism and for\n   each direction (CW=clockwise, CCW=counterclockwise).\n\
    \                  +----------+----------+--------------+\n                  |\
    \          | Wrapping | ROM-Wrapping |\n                  +----------+----------+--------------+\n\
    \                  | Link A-B |  CW+CCW  | CW+CCW       |\n                  |\
    \ Link A-F |    CCW   | CCW          |\n                  | Link F-E |  CW+CCW\
    \  | CCW          |\n                  | Link E-D |  CW+CCW  | CCW          |\n\
    \                  | Link D-C |  CW+CCW  | CCW          |\n                  +----------+----------+--------------+\n"
- title: 3.1.2.  Multiple Failures Comparison
  contents:
  - "3.1.2.  Multiple Failures Comparison\n   A further comparison of wrapping and\
    \ ROM-Wrapping can be done with\n   respect to their ability to react to multiple\
    \ failures.  The wrapping\n   recovery mechanism does not have the ability to\
    \ recover from multiple\n   failures on a ring network, while ROM-Wrapping is\
    \ able to recover\n   from some multiple failures.\n   Consider, for example,\
    \ a double link failure affecting links B-C and\n   C-D shown in Figure 7.  The\
    \ wrapping mechanism is not able to recover\n   from the failure because B, upon\
    \ detecting the failure, has no\n   alternative paths to reach C.  All the P2MP\
    \ traffic is lost.  The\n   ROM-Wrapping mechanism is able to partially recover\
    \ from the failure,\n   because the backup P2MP LSP to F and D is correctly set\
    \ up and\n   continues delivering traffic.\n"
- title: 3.2.  Steering for P2MP Paths
  contents:
  - "3.2.  Steering for P2MP Paths\n   When protecting P2MP traffic that uses an MPLS-TP\
    \ ring as its\n   branching point (i.e., the traffic enters the ring at a head-end\
    \ node\n   and exits the ring at multiple nodes), we can employ a steering\n \
    \  mechanism based on 1+1 linear protection [RFC6372].  We can configure\n   two\
    \ P2MP unidirectional SPMEs from each node on the ring; they\n   traverse the\
    \ ring in both directions.  These SPMEs will be configured\n   with an egress\
    \ at each ring node.  In order to be able to direct the\n   LSP traffic to the\
    \ proper egress point for that particular LSP, we\n   need to employ context labeling\
    \ as defined in [RFC5331].  The method\n   for using these labels is expanded\
    \ upon in Section 3.2.1.\n   For every LSP that enters the ring at a given node,\
    \ the traffic will\n   be sent through both of these SPMEs, each with its own\
    \ context label\n   and the context-specific label for the particular LSP.  The\
    \ egress\n   nodes should select the traffic that is arriving on the working SPME.\n\
    \   When a failure condition is identified, the egress nodes should\n   select\
    \ the traffic from whichever of the two SPMEs whose traffic\n   arrives at that\
    \ node, i.e., since one of the two (presumably the\n   working SPME) will be blocked\
    \ by the failure.  In this way, all\n   egress nodes are able to receive the data\
    \ traffic.  While each node\n   detects that there is connectivity from the ingress\
    \ node of the ring,\n   it continues to select the data that is coming from the\
    \ working SPME.\n   If a particular node stops receiving the connectivity messages\
    \ from\n   the working SPME, it identifies that it must select to read the data\n\
    \   packets from the protection SPME.\n"
- title: 3.2.1.  Context Labels
  contents:
  - "3.2.1.  Context Labels\n   Figure 8 shows the two unidirectional P2MP SPMEs that\
    \ are configured\n   from LSR-A with egress points at all of the nodes on the\
    \ ring.  The\n   clockwise SPME (i.e., A-B-C-D-E-F) is configured as the working\
    \ SPME\n   that will aggregate all traffic for P2MP LSPs that enter the ring at\n\
    \   LSR-A and must be sent out of the ring at any subset of the ring\n   nodes.\
    \  The counter-clockwise SPME (i.e., A-F-E-D-C-B) is configured\n   as the protection\
    \ SPME.\n                          ^            ^            ^\n             \
    \            _|_          _|_          _|_\n                  ----->/LSR\\********/LSR\\\
    ********/LSR\\\n                        \\_A_/========\\_B_/========\\_C_/\n \
    \                        +*              <+++++++++*||\n                     \
    \    +*                       +*||\n                         +*              \
    \         +*||\n                         +*                       +*||\n     \
    \                    +*_ ++++++++ ___ +++++++++*||\n                        /LSR\\\
    ********/LSR\\********/LSR\\\n                        \\_F_/<=======\\_E_/========\\\
    _D_/\n                          |            |            |\n                \
    \          V            V            V\n                ---> connected LSP   \
    \   *** physical link\n                ===  working SPME       +++ protection\
    \ SPME\n                           Figure 8: P2MP SPMEs\n   [RFC5331] defines\
    \ the concept of context labels.  A context-\n   identifying label defines a context\
    \ label space that is used to\n   interpret the context-specific labels (found\
    \ directly below the\n   context-identifying label) for a specific tunnel.  The\
    \ SPME label is\n   a context-identifying label.  This means that at each hop\
    \ the node\n   that receives the SPME label uses it to point not directly to a\n\
    \   forwarding table, but to a Label Information Base (LIB).  As a node\n   receives\
    \ an SPME label, it examines it, discovers that it is a\n   context label, pops\
    \ off the SPME label, and looks up the next label\n   down in the stack in the\
    \ LIB indicated by the context label.\n   The label below this context-identifying\
    \ label should be used by the\n   forwarding function of the node to decide the\
    \ actions to take for\n   this packet.  In MPLS-TP protection of ring topologies,\
    \ there are two\n   context LIBs.  One is the context LIB for the working SPME,\
    \ and the\n   other is the context LIB for the protection SPME.  All context LIBs\n\
    \   have a behavior defined for the end-to-end LSP label, but the\n   behavior\
    \ at each node may be different in the context of each SPME.\n   For example,\
    \ using the ring that is shown in Figure 8, the working\n   SPME is configured\
    \ to have a context-identifying label of CW at each\n   node on the ring, and\
    \ the protection SPME is configured to have a\n   context-identifying label of\
    \ CP at each node.  For the specific LSP,\n   we will designate the context-specific\
    \ label used on the working SPME\n   as WL(x-y), where it's the label used as\
    \ node-x forwards the packet\n   to node-y.  Similarly, a context-specific label\
    \ on the protection\n   SPME would be designated PL(x-y).  An explicit example\
    \ of label\n   values appears in the next subsection.\n   Assume we are applying\
    \ 1+1 linear protection, as outlined above, for\n   a P2MP LSP that enters the\
    \ ring at LSR-A and has egress points from\n   the ring at LSR-C and LSR-E using\
    \ the two SPMEs shown in Figure 8.  A\n   packet that arrives at LSR-A with a\
    \ label stack [LI+S] will be\n   forwarded on the working SPME with a label stack\
    \ [CW | WL(A-B)].  The\n   packet should then be forwarded to LSR-C arriving with\
    \ a label [CW |\n   WL(B-C)], where WL(B-C) should instruct the forwarding function\
    \ to\n   egress the packet with [LE(C)] and forward a copy to LSR-D with label\n\
    \   stack [CW | WL(C-D)].\n   If a fault condition is detected (for example, on\
    \ the link C-D), then\n   the nodes that are beyond the fault point (in this example,\
    \ nodes\n   LSR-D, LSR-E, and LSR-F), will cease to receive the data packets from\n\
    \   the clockwise (working) SPME.  Each of these LSRs should then begin\n   to\
    \ switch its \"selector bridge\" and accept the data packets from the\n   protection\
    \ (counter-clockwise) SPME.  At the ingress point (LSR-A),\n   all data packets\
    \ will have been transmitted on both the working SPME\n   and the protection SPME.\
    \  Continuing the example, LSR-A will transmit\n   one copy of the data to LSR-B\
    \ with stack [CW | WL(A-B)] and one copy\n   to LSR-F with stack [CP | PL(A-F)].\
    \  The packet will arrive at LSR-C\n   from the working SPME and egress from the\
    \ ring.  LSR-E will receive\n   the packet from the protection SPME with stack\
    \ [CP | PL(F-E)], and\n   the context-sensitive label PL(F-E) will instruct the\
    \ forwarding\n   function to send a copy out of the ring with label LE(E) and\
    \ a second\n   copy to LSR-D with stack [CP | PL(E-D)].  In this way, each of\
    \ the\n   egress points receives the packet from the SPME that is available at\n\
    \   that point.\n   This architecture has the added advantages that there is no\
    \ need for\n   the ingress node to identify the existence of the mis-connectivity,\n\
    \   and there is no need for a return path from the egress points to the\n   ingress.\n"
- title: 3.2.2.  Walk-Through Using Context Labels
  contents:
  - "3.2.2.  Walk-Through Using Context Labels\n   In order to better demonstrate\
    \ the use of the context labels, we\n   present a walk-through of an example application\
    \ of the P2MP\n   protection presented in this section.  Referring to Figure 9,\
    \ there\n   is a P2MP LSP that traverses the ring, entering the ring at LSR-B\
    \ and\n   branching off at LSR-D, LSR-E, and LSR-H, and it does not continue\n\
    \   beyond LSR-H.  For purposes of protection, two P2MP unidirectional\n   SPMEs\
    \ are configured on the ring starting from LSR-B.  One of the\n   SPMEs, the working\
    \ SPME, is configured with egress points at each of\n   the LSRs -- C, D, E, F,\
    \ G, H, J, K, A. The second SPME, the\n   protection SPME, is configured with\
    \ egress points at each of the LSRs\n   -- A, K, J, H, G, F, E, D, C.\n      \
    \                      ^            ^           ^           ^\n              \
    \              ^            ^           ^           ^\n              ___ xxxxxxxxx_+_\
    \ xxxxxxxxxX+_xxxxxxxxxX+_ xxxxxxxx_+_\n       xxxxx>/LSR\\********/LSR\\********/LSR\\\
    *******/LSR\\*******/LSR\\\n             \\_B_/========\\_C_/========\\_D_/=======\\\
    _E_/=======\\_F_/\n               *+             <+++++++++    +++++++     ++++++++*||x\n\
    \               *+                                              +*||x\n      \
    \         *+                                              +*||x\n            \
    \   *+                                              +*||x\n              _*++++++++++\
    \ ___ +++++++++___ ++++++++___+++++++++*||x\n             /LSR\\********/LSR\\\
    ********/LSR\\*******/LSR\\*******/LSR\\\n             \\_A_/<=======\\_K_/========\\\
    _J_/=======\\_H_/=======\\_G_/\n               +            +            +   \
    \        +Xxxxxxxxxx +\n               v            v            v           v\
    \           v\n               v            v            v           v        \
    \   v\n       xxx P2MP LSP (X LSP egress)     *** physical link\n       === working\
    \ SPME                +++ protection SPME\n                                  \
    \     +>> protection SPME egress\n                           Figure 9: P2MP SPMEs\n\
    \   For this example, we suppose that the LSP traffic enters the ring at\n   LSR-B\
    \ with the label stack [99], and leaves the ring:\n   o  at LSR-D with stack [199]\n\
    \   o  at LSR-E with stack [299]\n   o  at LSR-H with stack [399]\n   While it\
    \ is possible for the context-identifying label for the SPME\n   to be configured\
    \ as a different value at each LSR, for the sake of\n   this example, we will\
    \ suppose a configuration of 200 as the context-\n   identifying label for the\
    \ working SPME at each of the LSRs in the\n   ring, and 400 as the context-identifying\
    \ label for the protection\n   SPME at each LSR.\n   For the specific connected\
    \ LSP, we configure the following context-\n   specific labels:\n   +------+-----------------------------+------------------------------+\n\
    \   | node | W-context(200)              | P-context(400)               |\n  \
    \ +------+-----------------------------+------------------------------+\n   |\
    \   A  | 65 {drop packet}            | 165 {fwd w/ [400 | 190]}     |\n   |  \
    \ C  | 90 {fwd w/ [200 | 80]}      | 190 {drop packet}            |\n   |   D\
    \  | 80 {fwd w/ [200 | 75] +     | 180 {egress w/ [199]}        |\n   |      |\
    \ egress w/ [199]}            |                              |\n   |   E  | 75\
    \ {fwd w/ [200 | 65] +     | 175 {fwd w/ [400 | 180] +    |\n   |      | egress\
    \ w/ [299]}            | egress w/ [299]}             |\n   |   F  | 65 {fwd w/\
    \ [200 | 55]}      | 165 {fwd w/ [400 | 175]}     |\n   |   G  | 55 {fwd w/ [200\
    \ | 45]}      | 155 {fwd w/ [400 | 165]}     |\n   |   H  | 45 {egress w/ [399]}\
    \        | 145 {fwd w/ [400 | 155] +    |\n   |      |                       \
    \      | egress w/ [399]}             |\n   |   J  | 65 {drop packet}        \
    \    | 165 {fwd w/ [400 | 145]}     |\n   |   K  | 65 {drop packet}          \
    \  | 190 {fwd w/ [400 | 165]}     |\n   +------+-----------------------------+------------------------------+\n\
    \   When a packet arrives on the LSP to LSR-B with stack [99], the\n   forwarding\
    \ function determines that it is necessary to forward the\n   packet to both the\
    \ working SPME with stack [200 | 90] and the\n   protection SPME with stack [400\
    \ | 165].  Each LSR on the SPME will\n   identify the top label, i.e., 200 or\
    \ 400, to be the context-\n   identifying label and use the next label in the\
    \ stack to select the\n   forwarding action from the specific context table.\n\
    \   Therefore, at LSR-C, the packet on the working SPME will arrive with\n   stack\
    \ [200 | 90], and the 200 will point to the middle column of the\n   table above.\
    \  After popping the 200, the next label, i.e., 90, will\n   select the forwarding\
    \ action \"fwd w/ [200 | 80]\", and the packet will\n   be forwarded to LSR-D\
    \ with stack [200 | 80].  In this manner, the\n   packet will be forwarded along\
    \ both SPMEs according to the configured\n   behavior in the context tables. \
    \ However, the egress points at LSR-D,\n   LSR-E, and LSR-H will each be configured\
    \ with a selector bridge so\n   they will use only the input from the working\
    \ SPME.  If any of these\n   egress points identifies that there is a connection\
    \ fault on the\n   working SPME, then the selector bridge will cause the LSR to\
    \ read the\n   input from the protection SPME.\n"
- title: 4.  Coordination Protocol
  contents:
  - "4.  Coordination Protocol\n   The survivability framework [RFC6372] indicates\
    \ that there is a need\n   to coordinate protection switching between the endpoints\
    \ of a\n   protected bidirectional domain.  The coordination is necessary for\n\
    \   particular cases, in order to maintain the co-routed nature of the\n   bidirectional\
    \ transport path.  The particular cases where this\n   becomes necessary include\
    \ when unidirectional fault detection or\n   operator commands are used.\n   By\
    \ using the same mechanisms defined in [RFC6378] for linear\n   protection to\
    \ protect a single ring topology, we are able to gain a\n   consistent solution\
    \ for this coordination between the endpoints of\n   the protection domain.  The\
    \ Protection State Coordination Protocol\n   that is specified in [RFC6378] provides\
    \ coverage for all the\n   coordination cases, including support for operator\
    \ commands, e.g.,\n   Forced Switch.\n"
- title: 5.  Conclusions and Recommendations
  contents:
  - "5.  Conclusions and Recommendations\n   Ring topologies are prevalent in traditional\
    \ transport networks and\n   will continue to be used for various reasons.  Protection\
    \ for\n   transport paths that traverse a ring within an MPLS network can be\n\
    \   provided by applying an appropriate instance of linear protection, as\n  \
    \ defined in [RFC6372].  This document has shown that for each of the\n   traditional\
    \ ring-protection architectures there is an application of\n   linear protection\
    \ that provides efficient coverage, based on the use\n   of the Sub-Path Maintenance\
    \ Entity (SPME), defined in [RFC5921] and\n   [RFC6371].  For example:\n   o \
    \ P2P steering - Configuration of two SPMEs, from the ingress node\n      of the\
    \ ring to the egress node of the ring, and 1:1 linear\n      protection.\n   o\
    \  P2P Wrapping for link protection - Configuration of two SPMEs, one\n      for\
    \ the protected link and the second for the long route between\n      the two\
    \ neighboring nodes, and 1:1 linear protection.\n   o  P2P wrapping for node protection\
    \ - Configuration of two SPMEs, one\n      between the two neighbors of the protected\
    \ node and the second\n      between these two nodes on the long route, and 1:1\
    \ linear\n      protection.\n   o  P2MP wrapping - it is possible to optimize\
    \ the performance of the\n      wrapping by configuring the proper protection\
    \ path to egress the\n      data at the proper branching nodes.\n   o  P2MP steering\
    \ - by combining 1+1 linear protection and\n      configuration of the SPME based\
    \ on context-sensitive labeling of\n      the protection path.\n   This document\
    \ shows that use of the protection architecture and\n   mechanisms suggested provides\
    \ the optimizations needed to justify\n   ring-specific protection as defined\
    \ in [RFC5654].\n   Protection of traffic over a ring topology based on the steering\n\
    \   architecture using basic 1:1 linear protection is a very efficient\n   implementation\
    \ for sections of a P2P transport path that traverses a\n   ring.  Steering should\
    \ be the preferred mechanism for P2P protection\n   in a ring topology since it\
    \ reduces the extra bandwidth required when\n   traffic doubles through wrapped\
    \ protection, and it provides the\n   ability to protect both against link and\
    \ node failures without\n   complicating the fault detection or requiring that\
    \ multiple\n   protection paths be configured.  While this is true, it's possible\
    \ to\n   support either wrapping or steering while depending upon the OAM\n  \
    \ functionality (outlined in [RFC6371] and specified in various\n   documents)\
    \ and the coordination protocol specified for linear\n   protection in [RFC6378].\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   This document does not add any security risks\
    \ to the network.  Any\n   security considerations are defined in [RFC6378], and\
    \ their\n   applicability to the information contained in this document follows\n\
    \   naturally from the applicability of the mechanism defined in that\n   document.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC6378]  Weingarten, Y., Bryant, S., Osborne,\
    \ E., Sprecher, N., and\n              A. Fulignoli, \"MPLS Transport Profile\
    \ (MPLS-TP) Linear\n              Protection\", RFC 6378, October 2011.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [G.841]    ITU, \"Types and characteristics\
    \ of SDH network protection\n              architectures\", ITU-T G.841, October\
    \ 1998.\n   [RFC2205]  Braden, B., Zhang, L., Berson, S., Herzog, S., and S.\n\
    \              Jamin, \"Resource ReSerVation Protocol (RSVP) -- Version 1\n  \
    \            Functional Specification\", RFC 2205, September 1997.\n   [RFC4090]\
    \  Pan, P., Swallow, G., and A. Atlas, \"Fast Reroute\n              Extensions\
    \ to RSVP-TE for LSP Tunnels\", RFC 4090,\n              May 2005.\n   [RFC4427]\
    \  Mannie, E. and D. Papadimitriou, \"Recovery (Protection and\n             \
    \ Restoration) Terminology for Generalized Multi-Protocol\n              Label\
    \ Switching (GMPLS)\", RFC 4427, March 2006.\n   [RFC5331]  Aggarwal, R., Rekhter,\
    \ Y., and E. Rosen, \"MPLS Upstream\n              Label Assignment and Context-Specific\
    \ Label Space\",\n              RFC 5331, August 2008.\n   [RFC5654]  Niven-Jenkins,\
    \ B., Brungard, D., Betts, M., Sprecher, N.,\n              and S. Ueno, \"Requirements\
    \ of an MPLS Transport Profile\",\n              RFC 5654, September 2009.\n \
    \  [RFC5921]  Bocci, M., Bryant, S., Frost, D., Levrau, L., and L.\n         \
    \     Berger, \"A Framework for MPLS in Transport Networks\",\n              RFC\
    \ 5921, July 2010.\n   [RFC6371]  Busi, I. and D. Allan, \"Operations, Administration,\
    \ and\n              Maintenance Framework for MPLS-Based Transport Networks\"\
    ,\n              RFC 6371, September 2011.\n   [RFC6372]  Sprecher, N. and A.\
    \ Farrel, \"MPLS Transport Profile\n              (MPLS-TP) Survivability Framework\"\
    , RFC 6372,\n              September 2011.\n"
- title: Appendix A.  Acknowledgements
  contents:
  - "Appendix A.  Acknowledgements\n   The authors would like to acknowledge the strong\
    \ contributions from\n   all the people who commented on this document and made\
    \ suggestions\n   for improvements.\n"
- title: Appendix B.  Contributors
  contents:
  - "Appendix B.  Contributors\n   The authors would like to acknowledge the following\
    \ individuals that\n   contributed their insights and advice to this work:\n \
    \  Nurit Sprecher (NSN)\n   Akira Sakurai (NEC)\n   Rolf Winter (NEC)\n   Eric\
    \ Osborne (Cisco)\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Yaacov Weingarten\n   34 Hagefen St.\n   Karnei Shomron,\
    \   4485500\n   Israel\n   Phone:\n   EMail: wyaacov@gmail.com\n   Stewart Bryant\n\
    \   Cisco Systems\n   10 New Square, Bedfont Lakes\n   Feltham, Middlesex,\n \
    \  TW18 8HA\n   UK\n   EMail: stbryant@cisco.com\n   Danielle Ceccarelli\n   Ericsson\n\
    \   Via A. Negrone 1/A\n   Genova, Sestri Ponente\n   Italy\n   EMail: daniele.ceccarelli@ericsson.com\n\
    \   Diego Caviglia\n   Ericsson\n   Via A. Negrone 1/A\n   Genova, Sestri Ponente\n\
    \   Italy\n   EMail: diego.caviglia@ericsson.com\n   Francesco Fondelli\n   Ericsson\n\
    \   Via A. Negrone 1/A\n   Genova, Sestri Ponente\n   Italy\n   EMail: francesco.fondelli@ericsson.com\n\
    \   Marco Corsi\n   Altran\n   Via A. Negrone 1/A\n   Genova, Sestri Ponente\n\
    \   Italy\n   EMail: corsi.marco@gmail.com\n   Bo Wu\n   ZTE Corporation\n   4F,\
    \ RD Building 2, Zijinghua Road\n   Nanjing, Yuhuatai District\n   P.R. China\n\
    \   EMail: wu.bo@zte.com.cn\n   Xuehui Dai\n   EMail: xuehuiwfsy@gmail.com\n"
