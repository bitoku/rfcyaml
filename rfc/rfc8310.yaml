- title: __initial_text__
  contents:
  - '           Usage Profiles for DNS over TLS and DNS over DTLS

    '
- title: Abstract
  contents:
  - "Abstract\n   This document discusses usage profiles, based on one or more\n \
    \  authentication mechanisms, which can be used for DNS over Transport\n   Layer\
    \ Security (TLS) or Datagram TLS (DTLS).  These profiles can\n   increase the\
    \ privacy of DNS transactions compared to using only\n   cleartext DNS.  This\
    \ document also specifies new authentication\n   mechanisms -- it describes several\
    \ ways that a DNS client can use an\n   authentication domain name to authenticate\
    \ a (D)TLS connection to a\n   DNS server.  Additionally, it defines (D)TLS protocol\
    \ profiles for\n   DNS clients and servers implementing DNS over (D)TLS.  This\
    \ document\n   updates RFC 7858.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8310.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2018 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \   2. Terminology .....................................................6\n  \
    \ 3. Scope ...........................................................7\n   4.\
    \ Discussion ......................................................8\n   5. Usage\
    \ Profiles ..................................................8\n      5.1. DNS\
    \ Resolution ............................................11\n   6. Authentication\
    \ in DNS over (D)TLS ..............................11\n      6.1. DNS-over-(D)TLS\
    \ Startup Configuration Problems ............11\n      6.2. Credential Verification\
    \ ...................................12\n      6.3. Summary of Authentication\
    \ Mechanisms ......................12\n      6.4. Combining Authentication Mechanisms\
    \ .......................15\n      6.5. Authentication in Opportunistic Privacy\
    \ ...................15\n      6.6. Authentication in Strict Privacy ..........................16\n\
    \      6.7. Implementation Guidance ...................................16\n  \
    \ 7. Sources of Authentication Domain Names .........................17\n    \
    \  7.1. Full Direct Configuration .................................17\n      7.2.\
    \ Direct Configuration of ADN Only ..........................17\n      7.3. Dynamic\
    \ Discovery of ADN ..................................17\n           7.3.1. DHCP\
    \ ...............................................18\n   8. Credential Verification\
    \ Based on Authentication Domain Name ....18\n      8.1. Authentication Based\
    \ on PKIX Certificate ..................18\n      8.2. DANE ......................................................19\n\
    \           8.2.1. Direct DNS Meta-Queries ............................20\n  \
    \         8.2.2. TLS DNSSEC Chain Extension .........................20\n   9.\
    \ (D)TLS Protocol Profile ........................................20\n   10. IANA\
    \ Considerations ...........................................21\n   11. Security\
    \ Considerations .......................................21\n      11.1. Countermeasures\
    \ to DNS Traffic Analysis ..................22\n   12. References ....................................................22\n\
    \      12.1. Normative References .....................................22\n  \
    \    12.2. Informative References ...................................24\n   Appendix\
    \ A. Server Capability Probing and Caching by DNS Clients ..26\n   Acknowledgments\
    \ ...................................................27\n   Authors' Addresses\
    \ ................................................27\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   DNS privacy issues are discussed in [RFC7626].  The specific\
    \ issues\n   described in [RFC7626] that are most relevant to this document are\n\
    \   o  Passive attacks that eavesdrop on cleartext DNS transactions on\n     \
    \ the wire (Section 2.4 of [RFC7626]) and\n   o  Active attacks that redirect\
    \ clients to rogue servers to monitor\n      DNS traffic (Section 2.5.3 of [RFC7626]).\n\
    \   Mitigating these attacks increases the privacy of DNS transactions;\n   however,\
    \ many of the other issues raised in [RFC7626] still apply.\n   Two documents\
    \ that provide ways to increase DNS privacy between DNS\n   clients and DNS servers\
    \ are\n   o  \"Specification for DNS over Transport Layer Security (TLS)\"\n \
    \     [RFC7858], referred to here as simply \"DNS over TLS\".\n   o  \"DNS over\
    \ Datagram Transport Layer Security (DTLS)\" [RFC8094],\n      referred to here\
    \ as simply \"DNS over DTLS\".  Note that [RFC8094]\n      is an Experimental\
    \ specification.\n   Both documents are limited in scope to communications between\
    \ stub\n   clients and recursive resolvers, and the same scope is applied to\n\
    \   this document (see Sections 2 and 3).  The proposals here might be\n   adapted\
    \ or extended in future to be used for recursive clients and\n   authoritative\
    \ servers, but this application was out of scope for the\n   DNS PRIVate Exchange\
    \ (dprive) Working Group charter at the time this\n   document was published.\n\
    \   This document specifies two usage profiles (Strict Privacy and\n   Opportunistic\
    \ Privacy) for DTLS [RFC6347] and TLS [RFC5246] that\n   provide improved levels\
    \ of mitigation for the attacks described above\n   compared to using only cleartext\
    \ DNS.\n   Section 5 presents a generalized discussion of usage profiles by\n\
    \   separating the usage profile, which is based purely on the security\n   properties\
    \ it offers the user, from the specific mechanism or\n   mechanisms that are used\
    \ for DNS server authentication.  The profiles\n   described are\n   o  A Strict\
    \ Privacy profile, which requires an encrypted connection\n      and successful\
    \ authentication of the DNS server; this mitigates\n      both passive eavesdropping\
    \ and client redirection (at the expense\n      of providing no DNS service if\
    \ an encrypted, authenticated\n      connection is not available).\n   o  An Opportunistic\
    \ Privacy profile, which will attempt, but does not\n      require, encryption\
    \ and successful authentication; it therefore\n      provides limited or no mitigation\
    \ for such attacks but maximizes\n      the chance of DNS service.\n   The above\
    \ usage profiles attempt authentication of the server using\n   at least one authentication\
    \ mechanism.  Section 6.4 discusses how to\n   combine authentication mechanisms\
    \ to determine the overall\n   authentication result.  Depending on that overall\
    \ authentication\n   result (and whether encryption is available), the usage profile\
    \ will\n   determine if the connection should proceed, fall back, or fail.\n \
    \  One authentication mechanism is already described in [RFC7858].\n   [RFC7858]\
    \ specifies an authentication mechanism for DNS over TLS that\n   is based on\
    \ Subject Public Key Info (SPKI) in the context of a\n   specific case of a Strict\
    \ Privacy profile using that single\n   authentication mechanism.  Therefore,\
    \ the \"out-of-band key-pinned\n   privacy profile\" described in [RFC7858] would\
    \ qualify as a \"Strict\n   Privacy profile\" that used SPKI pinning for authentication.\n\
    \   This document extends the use of authentication based on SPKI\n   pin sets,\
    \ so that it is considered a general authentication mechanism\n   that can be\
    \ used with either DNS-over-(D)TLS usage profile.  That is,\n   the mechanism\
    \ for SPKI pin sets as described in [RFC7858] MAY be used\n   with DNS over (D)TLS.\n\
    \   This document also describes a number of additional authentication\n   mechanisms,\
    \ all of which specify how a DNS client should authenticate\n   a DNS server based\
    \ on an \"authentication domain name\".  In\n   particular, the following topics\
    \ are described:\n   o  How a DNS client can obtain the combination of an authentication\n\
    \      domain name and IP address for a DNS server.  See Section 7.\n   o  What\
    \ acceptable credentials a DNS server can present to prove its\n      identity\
    \ for (D)TLS authentication based on a given authentication\n      domain name.\
    \  See Section 8.\n   o  How a DNS client can verify that any given credential\
    \ matches the\n      authentication domain name obtained for a DNS server.  See\n\
    \      Section 8.\n   This document defines a (D)TLS protocol profile for use\
    \ with DNS; see\n   Section 9.  This profile defines the configuration options\
    \ and\n   protocol extensions required of both parties to (1) optimize\n   connection\
    \ establishment and session resumption for transporting DNS\n   and (2) support\
    \ all currently specified authentication mechanisms.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\"\
    , \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted as described\
    \ in\n   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all\n\
    \   capitals, as shown here.\n   Several terms are used specifically in the context\
    \ of this document:\n   o  DNS client: A DNS stub resolver or forwarder.  In the\
    \ case of a\n      forwarder, the term \"DNS client\" is used to discuss the side\
    \ that\n      sends queries.\n   o  DNS server: A DNS recursive resolver or forwarder.\
    \  In the case of\n      a forwarder, the term \"DNS server\" is used to discuss\
    \ the side\n      that responds to queries.  Note that, as used in this document,\n\
    \      this term does not apply to authoritative servers.\n   o  Privacy-enabling\
    \ DNS server: A DNS server that implements\n      DNS over TLS [RFC7858] and may\
    \ optionally implement DNS over DTLS\n      [RFC8094].  The server should also\
    \ offer at least one of the\n      credentials described in Section 8 and implement\
    \ the (D)TLS\n      profile described in Section 9.\n   o  (D)TLS: Used for brevity;\
    \ refers to both Transport Layer Security\n      [RFC5246] and Datagram Transport\
    \ Layer Security [RFC6347].\n      Specific terms will be used for any text that\
    \ applies to either\n      protocol alone.\n   o  DNS over (D)TLS: Used for brevity;\
    \ refers to both DNS over TLS\n      [RFC7858] and DNS over DTLS [RFC8094].  Specific\
    \ terms will be\n      used for any text that applies to either protocol alone.\n\
    \   o  Authentication domain name: A domain name that can be used to\n      authenticate\
    \ a privacy-enabling DNS server.  Sources of\n      authentication domain names\
    \ are discussed in Section 7.\n   o  SPKI pin sets: [RFC7858] describes the use\
    \ of cryptographic\n      digests to \"pin\" public key information in a manner\
    \ similar to\n      HTTP Public Key Pinning (HPKP) [RFC7469].  An SPKI pin set\
    \ is a\n      collection of these pins that constrains a DNS server.\n   o  Authentication\
    \ information: Information a DNS client may use as\n      the basis of an authentication\
    \ mechanism.  In this context, this\n      information can be either\n      *\
    \  an SPKI pin set or\n      *  an authentication domain name\n   o  Reference\
    \ identifier: A reference identifier as described in\n      [RFC6125], constructed\
    \ by the DNS client when performing TLS\n      authentication of a DNS server.\n\
    \   o  Credential: Information available for a DNS server that proves its\n  \
    \    identity for authentication purposes.  Credentials discussed here\n     \
    \ include\n      *  a PKIX certificate\n      *  a DNSSEC-validated chain to a\
    \ TLSA record\n      but may also include SPKI pin sets.\n"
- title: 3.  Scope
  contents:
  - "3.  Scope\n   This document is limited to describing\n   o  Usage profiles based\
    \ on general authentication mechanisms.\n   o  The details of domain-name-based\
    \ authentication of DNS servers by\n      DNS clients (as defined in Section 2).\n\
    \   o  The (D)TLS profiles needed to support authentication in\n      DNS over\
    \ (D)TLS.\n   As such, the following topics are out of scope for this document:\n\
    \   o  Authentication of authoritative servers by recursive resolvers.\n   o \
    \ Authentication of DNS clients by DNS servers.\n   o  The details of how to perform\
    \ authentication based on SPKI\n      pin sets.  This is defined in [RFC7858].\n\
    \   o  Any server identifier other than domain names, including IP\n      addresses,\
    \ organizational names, country of origin, etc.\n"
- title: 4.  Discussion
  contents:
  - "4.  Discussion\n   One way to mitigate eavesdropping on cleartext DNS transactions\
    \ by\n   passive attackers is to encrypt the query (and response).  Such\n   encryption\
    \ typically provides integrity protection as a side effect;\n   this means that\
    \ on-path attackers cannot simply inject bogus DNS\n   responses.  To also mitigate\
    \ active attackers pretending to be the\n   server, the client must authenticate\
    \ the (D)TLS connection to the\n   server.\n   This document discusses usage profiles,\
    \ which provide differing\n   levels of attack mitigation to DNS clients, based\
    \ on the requirements\n   for authentication and encryption, regardless of the\
    \ context (for\n   example, which network the client is connected to).  A usage\
    \ profile\n   is a concept distinct from a usage policy or usage model; a usage\n\
    \   policy or usage model might dictate which profile should be used in a\n  \
    \ particular context (enterprise vs. coffee shop), with a particular\n   set of\
    \ DNS servers or with reference to other external factors.  A\n   description\
    \ of the variety of usage policies is out of scope for this\n   document but may\
    \ be the subject of future work.\n   The term \"privacy-enabling DNS server\"\
    \ is used throughout this\n   document.  This is a DNS server that\n   o  MUST\
    \ implement DNS over TLS [RFC7858].\n   o  MAY implement DNS over DTLS [RFC8094].\n\
    \   o  SHOULD offer at least one of the credentials described in\n      Section\
    \ 8.\n   o  Implements the (D)TLS profile described in Section 9.\n"
- title: 5.  Usage Profiles
  contents:
  - "5.  Usage Profiles\n   A DNS client has a choice of usage profiles available\
    \ to increase the\n   privacy of DNS transactions.  This choice is briefly discussed\
    \ in\n   both [RFC7858] and [RFC8094].  These usage profiles are\n   o  Strict\
    \ Privacy profile: The DNS client requires both an encrypted\n      and authenticated\
    \ connection to a privacy-enabling DNS server.  A\n      hard failure occurs if\
    \ this is not available.  This requires the\n      client to securely obtain authentication\
    \ information it can use to\n      authenticate the server.  This profile mitigates\
    \ both passive and\n      active attacks, thereby providing the client with the\
    \ best\n      available privacy for DNS.  This profile is discussed in detail\
    \ in\n      Section 6.6.\n   o  Opportunistic Privacy profile: The DNS client\
    \ uses Opportunistic\n      Security as described in [RFC7435].\n      *  \"...\
    \ the use of cleartext as the baseline communication\n         security policy,\
    \ with encryption and authentication negotiated\n         and applied to the communication\
    \ when available.\"\n      As described in [RFC7435], it might result in\n   \
    \   *  an encrypted and authenticated connection\n      *  an encrypted connection\n\
    \      *  a cleartext connection\n      depending on the fallback logic of the\
    \ client, the available\n      authentication information, and the capabilities\
    \ of the DNS\n      server.  In all these cases, the DNS client is willing to\
    \ continue\n      with a connection to the DNS server and perform resolution of\n\
    \      queries.  The use of Opportunistic Privacy is intended to support\n   \
    \   incremental deployment of increased privacy with a view to\n      widespread\
    \ adoption of the Strict Privacy profile.  It should be\n      employed when the\
    \ DNS client might otherwise settle for cleartext;\n      it provides the maximum\
    \ protection available, depending on the\n      combination of factors described\
    \ above.  If all the configured DNS\n      servers are DNS privacy servers, then\
    \ it can provide protection\n      against passive attacks and might protect against\
    \ active ones.\n   Both profiles can include an initial meta-query (performed\
    \ using\n   Opportunistic Privacy) to obtain the IP address for the privacy-\n\
    \   enabling DNS server to which the DNS client will subsequently\n   connect.\
    \  The rationale for permitting this for the Strict Privacy\n   profile is that\
    \ requiring such meta-queries to also be performed\n   using the Strict Privacy\
    \ profile would introduce significant\n   deployment obstacles.  However, it should\
    \ be noted that in this\n   scenario an active attack on the meta-query is possible.\
    \  Such an\n   attack could result in a Strict Privacy profile client connecting\
    \ to\n   a server it cannot authenticate (and therefore not obtaining DNS\n  \
    \ service) or an Opportunistic Privacy client connecting to a server\n   controlled\
    \ by the attacker.  DNSSEC validation can detect the attack\n   on the meta-query,\
    \ which may result in the client not obtaining DNS\n   service (for both usage\
    \ profiles), depending on its DNSSEC validation\n   policy.  See Section 7.2 for\
    \ more discussion.\n   To compare the two usage profiles, Table 1 below shows\
    \ a successful\n   Strict Privacy profile alongside the three possible outcomes\
    \ of an\n   Opportunistic Privacy profile.  In the best-case scenario for the\n\
    \   Opportunistic Privacy profile (an authenticated and encrypted\n   connection),\
    \ it is equivalent to the Strict Privacy profile.  In the\n   worst-case scenario,\
    \ it is equivalent to cleartext.  Clients using\n   the Opportunistic Privacy\
    \ profile SHOULD try for the best case but\n   MAY fall back to the intermediate\
    \ case and, eventually, the worst-\n   case scenario, in order to obtain a response.\
    \  One reason to fall\n   back without trying every available privacy-enabling\
    \ DNS server is if\n   latency is more important than attack mitigation; see Appendix\
    \ A.\n   The Opportunistic Privacy profile therefore provides varying\n   protection,\
    \ depending on what kind of connection is actually used,\n   including no attack\
    \ mitigation at all.\n   Note that there is no requirement in Opportunistic Security\
    \ to notify\n   the user regarding what type of connection is actually used; the\n\
    \   \"detection\" described below is only possible if such connection\n   information\
    \ is available.  However, if it is available and the user\n   is informed that\
    \ an unencrypted connection was used to connect to a\n   server, then the user\
    \ should assume (detect) that the connection is\n   subject to both active and\
    \ passive attacks, since the DNS queries are\n   sent in cleartext.  This might\
    \ be particularly useful if a new\n   connection to a certain server is unencrypted\
    \ when all previous\n   connections were encrypted.  Similarly, if the user is\
    \ informed that\n   an encrypted but unauthenticated connection was used, then\
    \ the user\n   can detect that the connection may be subject to active attacks.\
    \  In\n   other words, for the cases where no protection is provided against an\n\
    \   attacker (N), it is possible to detect that an attack might be\n   happening\
    \ (D).  This is discussed in Section 6.5.\n    +---------------+------------+------------------+-----------------+\n\
    \    | Usage Profile | Connection | Passive Attacker | Active Attacker |\n   \
    \ +---------------+------------+------------------+-----------------+\n    | \
    \    Strict    |    A, E    |        P         |        P        |\n    | Opportunistic\
    \ |    A, E    |        P         |        P        |\n    | Opportunistic | \
    \    E      |        P         |       N, D      |\n    | Opportunistic |    \
    \        |       N, D       |       N, D      |\n    +---------------+------------+------------------+-----------------+\n\
    \     P == Protection; N == No protection; D == Detection is possible;\n     \
    \    A == Authenticated connection; E == Encrypted connection\n     Table 1: Attack\
    \ Protection by Usage Profile and Type of Attacker\n   The Strict Privacy profile\
    \ provides the best attack mitigation and\n   therefore SHOULD always be implemented\
    \ in DNS clients that implement\n   the Opportunistic Privacy profile.\n   A DNS\
    \ client that implements DNS over (D)TLS SHOULD NOT be configured\n   by default\
    \ to use only cleartext.\n   The choice between the two profiles depends on a\
    \ number of factors,\n   including which is more important to the particular client:\n\
    \   o  DNS service, at the cost of no attack mitigation (Opportunistic\n     \
    \ Privacy) or\n   o  Best available attack mitigation, at the potential cost of\
    \ no DNS\n      service (Strict Privacy).\n   Additionally, the two profiles require\
    \ varying levels of\n   configuration (or a trusted relationship with a provider)\
    \ and DNS\n   server capabilities; therefore, DNS clients will need to carefully\n\
    \   select which profile to use based on their communication needs.\n   A DNS\
    \ server that implements DNS over (D)TLS SHOULD provide at least\n   one credential\
    \ (Section 2) so that those DNS clients that wish to use\n   the Strict Privacy\
    \ profile are able to do so.\n"
- title: 5.1.  DNS Resolution
  contents:
  - "5.1.  DNS Resolution\n   A DNS client SHOULD select a particular usage profile\
    \ when resolving\n   a query.  A DNS client MUST NOT fall back from Strict Privacy\
    \ to\n   Opportunistic Privacy during the resolution of a given query, as this\n\
    \   could invalidate the protection offered against attackers.  It is\n   anticipated\
    \ that DNS clients will use a particular usage profile for\n   all queries to\
    \ all configured servers until an operational issue or\n   policy update dictates\
    \ a change in the profile used.\n"
- title: 6.  Authentication in DNS over (D)TLS
  contents:
  - "6.  Authentication in DNS over (D)TLS\n   This section describes authentication\
    \ mechanisms and how they can be\n   used in either Strict or Opportunistic Privacy\
    \ for DNS over (D)TLS.\n"
- title: 6.1.  DNS-over-(D)TLS Startup Configuration Problems
  contents:
  - "6.1.  DNS-over-(D)TLS Startup Configuration Problems\n   Many (D)TLS clients\
    \ use PKIX authentication [RFC6125] based on an\n   authentication domain name\
    \ for the server they are contacting.  These\n   clients typically first look\
    \ up the server's network address in the\n   DNS before making this connection.\
    \  Such a DNS client therefore has a\n   bootstrap problem, as it will typically\
    \ only know the IP address of\n   its DNS server.\n   In this case, before connecting\
    \ to a DNS server, a DNS client needs\n   to learn the authentication domain name\
    \ it should associate with the\n   IP address of a DNS server for authentication\
    \ purposes.  Sources of\n   authentication domain names are discussed in Section\
    \ 7.\n   One advantage of this domain-name-based approach is that it\n   encourages\
    \ the association of stable, human-recognizable identifiers\n   with secure DNS\
    \ service providers.\n"
- title: 6.2.  Credential Verification
  contents:
  - "6.2.  Credential Verification\n   Verification of SPKI pin sets is discussed\
    \ in [RFC7858].\n   In terms of domain-name-based verification, once an authentication\n\
    \   domain name is known for a DNS server, a choice of authentication\n   mechanisms\
    \ can be used for credential verification.  Section 8\n   discusses these mechanisms\
    \ -- namely, PKIX certificate-based\n   authentication and DNS-Based Authentication\
    \ of Named Entities (DANE)\n   -- in detail.\n   Note that the use of DANE adds\
    \ requirements on the ability of the\n   client to get validated DNSSEC results.\
    \  This is discussed in more\n   detail in Section 8.2.\n"
- title: 6.3.  Summary of Authentication Mechanisms
  contents:
  - "6.3.  Summary of Authentication Mechanisms\n   This section provides an overview\
    \ of the various authentication\n   mechanisms.  Table 2 below indicates how the\
    \ DNS client obtains\n   information to use for authentication for each option:\
    \ either\n   statically via direct configuration or dynamically.  Of course, the\n\
    \   Opportunistic Privacy profile does not require authentication, and so\n  \
    \ a client using that profile may choose to connect to a\n   privacy-enabling\
    \ DNS server on the basis of just an IP address.\n   +---+------------+-------------+------------------------------------+\n\
    \   | # | Static     | Dynamically | Short name: Description            |\n  \
    \ |   | Config     | Obtained    |                                    |\n   +---+------------+-------------+------------------------------------+\n\
    \   | 1 | SPKI + IP  |             | SPKI: SPKI pin set(s) and IP       |\n  \
    \ |   |            |             | address obtained out of band       |\n   |\
    \   |            |             | [RFC7858]                          |\n   |  \
    \ |            |             |                                    |\n   | 2 |\
    \ ADN + IP   |             | ADN: ADN and IP address obtained   |\n   |   |  \
    \          |             | out of band (see Section 7.1)      |\n   |   |    \
    \        |             |                                    |\n   | 3 | ADN  \
    \      | IP          | ADN only: Opportunistic Privacy    |\n   |   |        \
    \    |             | meta-queries to a NP DNS server    |\n   |   |          \
    \  |             | for A/AAAA (see Section 7.2)       |\n   |   |            |\
    \             |                                    |\n   | 4 |            | ADN\
    \ + IP    | DHCP: DHCP configuration only (see |\n   |   |            |      \
    \       | Section 7.3.1)                     |\n   |   |            |        \
    \     |                                    |\n   | 5 | [ADN + IP] | [ADN + IP]\
    \  | DANE: DNSSEC chain obtained via    |\n   |   |            | TLSA record |\
    \ Opportunistic Privacy meta-queries |\n   |   |            |             | to\
    \ NP DNS server (see Section      |\n   |   |            |             | 8.2.1)\
    \                             |\n   |   |            |             |         \
    \                           |\n   | 6 | [ADN + IP] | [ADN + IP]  | TLS extension:\
    \ DNSSEC chain        |\n   |   |            | TLSA record | provided by PE DNS\
    \ server in TLS   |\n   |   |            |             | DNSSEC chain extension\
    \ (see        |\n   |   |            |             | Section 8.2.2)          \
    \           |\n   +---+------------+-------------+------------------------------------+\n\
    \                SPKI == SPKI pin set(s); IP == IP Address;\n        ADN == Authentication\
    \ Domain Name; NP == Network-Provided;\n        PE == Privacy-Enabling; [ ] ==\
    \ Data may be obtained either\n                         statically or dynamically\n\
    \              Table 2: Overview of Authentication Mechanisms\n   The following\
    \ summary attempts to present some key attributes of each\n   of the mechanisms\
    \ (using the \"Short name\" from Table 2), indicating\n   attractive attributes\
    \ with a \"+\" and undesirable attributes\n   with a \"-\".\n   1.  SPKI\n   \
    \    + Minimal leakage (note that the ADN is always leaked in the\n         Server\
    \ Name Indication (SNI) field in the ClientHello in TLS\n         when communicating\
    \ with a privacy-enabling DNS server)\n       - Overhead of ongoing key management\
    \ required\n   2.  ADN\n       + Minimal leakage\n       + One-off direct configuration\
    \ only\n   3.  ADN only\n       + Minimal one-off direct configuration; only a\
    \ human-recognizable\n         domain name needed\n       - A/AAAA meta-queries\
    \ leaked to network-provided DNS server that\n         may be subject to active\
    \ attack (attack can be mitigated by\n         DNSSEC validation)\n   4.  DHCP\n\
    \       + No static config\n       - Requires a non-standard or future DHCP option\
    \ in order to\n         provide the ADN\n       - Requires secure and trustworthy\
    \ connection to DHCP server if\n         used with a Strict Privacy profile\n\
    \   5.  DANE\n       The ADN and/or IP may be obtained statically or dynamically,\
    \ and\n       the relevant attributes of that method apply.\n       + DANE options\
    \ (e.g., matching on entire certificate)\n       - Requires a DNSSEC-validating\
    \ stub implementation (the\n         deployment of which is limited at the time\
    \ of this writing)\n       - DNSSEC chain meta-queries leaked to network-provided\
    \ DNS server\n         that may be subject to active attack\n   6.  TLS extension\n\
    \       The ADN and/or IP may be obtained statically or dynamically, and\n   \
    \    the relevant attributes of that method apply.\n       + Reduced latency compared\
    \ with DANE\n       + No network-provided DNS server required if ADN and IP\n\
    \         statically configured\n       + DANE options (e.g., matching on entire\
    \ certificate)\n       - Requires a DNSSEC-validating stub implementation\n"
- title: 6.4.  Combining Authentication Mechanisms
  contents:
  - "6.4.  Combining Authentication Mechanisms\n   This document does not make explicit\
    \ recommendations about how an\n   authentication mechanism based on SPKI pin\
    \ sets should be combined\n   with a domain-based mechanism from an operator perspective.\
    \  However,\n   it can be envisaged that a DNS server operator may wish to make\
    \ both\n   an SPKI pin set and an authentication domain name available to allow\n\
    \   clients to choose which mechanism to use.  Therefore, the following\n   text\
    \ provides guidance on how clients ought to behave if they choose\n   to configure\
    \ both, as is possible in HPKP [RFC7469].\n   A DNS client that is configured\
    \ with both an authentication domain\n   name and an SPKI pin set for a DNS server\
    \ SHOULD match on both a\n   valid credential for the authentication domain name\
    \ and a valid SPKI\n   pin set (if both are available) when connecting to that\
    \ DNS server.\n   In this case, the client SHOULD treat individual SPKI pins as\n\
    \   specified in Section 2.6 of [RFC7469] with regard to user-defined\n   trust\
    \ anchors.  The overall authentication result SHOULD only be\n   considered successful\
    \ if both authentication mechanisms are\n   successful.\n"
- title: 6.5.  Authentication in Opportunistic Privacy
  contents:
  - "6.5.  Authentication in Opportunistic Privacy\n   An Opportunistic Privacy Profile\
    \ (based on Opportunistic Security\n   [RFC7435]) that MAY be used for DNS over\
    \ (D)TLS is described in\n   [RFC7858] and is further specified in this document.\n\
    \   DNS clients that issue queries under an Opportunistic Privacy profile\n  \
    \ and that know authentication information for a given privacy-enabling\n   DNS\
    \ server SHOULD try to authenticate the server using the mechanisms\n   described\
    \ here.  This is useful for detecting (but not preventing)\n   active attacks,\
    \ since the fact that authentication information is\n   available indicates that\
    \ the server in question is a privacy-enabling\n   DNS server to which it should\
    \ be possible to establish an\n   authenticated and encrypted connection.  In\
    \ this case, whilst a\n   client cannot know the reason for an authentication\
    \ failure, from a\n   security standpoint the client should consider an active\
    \ attack in\n   progress and proceed under that assumption.  For example, a client\n\
    \   that implements a nameserver selection algorithm that preferentially\n   uses\
    \ nameservers that successfully authenticated (see Section 5)\n   might not continue\
    \ to use the failing server if there were\n   alternative servers available.\n\
    \   Attempting authentication is also useful for debugging or diagnostic\n   purposes\
    \ if there are means to report the result.  This information\n   can provide a\
    \ basis for a DNS client to switch to (preferred) Strict\n   Privacy where it\
    \ is viable, e.g., where all the configured servers\n   support DNS over (D)TLS\
    \ and successfully authenticate.\n"
- title: 6.6.  Authentication in Strict Privacy
  contents:
  - "6.6.  Authentication in Strict Privacy\n   To authenticate a privacy-enabling\
    \ DNS server, a DNS client needs to\n   know authentication information for each\
    \ server it is willing to\n   contact.  This is necessary to protect against active\
    \ attacks that\n   attempt to redirect clients to rogue DNS servers.\n   A DNS\
    \ client requiring Strict Privacy MUST use either (1) one of the\n   sources listed\
    \ in Section 7, to obtain an authentication domain name\n   for the server it\
    \ contacts or (2) an SPKI pin set as described in\n   [RFC7858].\n   A DNS client\
    \ requiring Strict Privacy MUST only attempt to connect to\n   DNS servers for\
    \ which at least one piece of authentication\n   information is known.  The client\
    \ MUST use the available verification\n   mechanisms described in Section 8 to\
    \ authenticate the server and MUST\n   abort connections to a server when no verification\
    \ mechanism\n   succeeds.\n   With Strict Privacy, the DNS client MUST NOT commence\
    \ sending DNS\n   queries until at least one of the privacy-enabling DNS servers\n\
    \   becomes available.\n   A privacy-enabling DNS server may be temporarily unavailable\
    \ when\n   configuring a network.  For example, for clients on networks that\n\
    \   require registration through web-based login (a.k.a. \"captive\n   portals\"\
    ), such registration may rely on DNS interception and\n   spoofing.  Techniques\
    \ such as those used by dnssec-trigger\n   [dnssec-trigger] MAY be used during\
    \ network configuration, with the\n   intent to transition to the designated privacy-enabling\
    \ DNS servers\n   after captive-portal registration.  If using a Strict Privacy\n\
    \   profile, the system MUST alert by some means that the DNS is not\n   private\
    \ during such a bootstrap operation.\n"
- title: 6.7.  Implementation Guidance
  contents:
  - "6.7.  Implementation Guidance\n   Section 9 describes the (D)TLS profile for\
    \ DNS over (D)TLS.\n   Additional considerations relating to general implementation\n\
    \   guidelines are discussed in both Section 11 and Appendix A.\n"
- title: 7.  Sources of Authentication Domain Names
  contents:
  - '7.  Sources of Authentication Domain Names

    '
- title: 7.1.  Full Direct Configuration
  contents:
  - "7.1.  Full Direct Configuration\n   DNS clients may be directly and securely\
    \ provisioned with the\n   authentication domain name of each privacy-enabling\
    \ DNS server -- for\n   example, using a client-specific configuration file or\
    \ API.\n   In this case, direct configuration for a DNS client would consist of\n\
    \   both an IP address and an authentication domain name for each DNS\n   server\
    \ that were obtained via an out-of-band mechanism.\n"
- title: 7.2.  Direct Configuration of ADN Only
  contents:
  - "7.2.  Direct Configuration of ADN Only\n   A DNS client may be configured directly\
    \ and securely with only the\n   authentication domain name of each of its privacy-enabling\
    \ DNS\n   servers -- for example, using a client-specific configuration file\n\
    \   or API.\n   A DNS client might learn of a default recursive DNS resolver from\
    \ an\n   untrusted source (such as DHCP's DNS Recursive Name Server option\n \
    \  [RFC3646]).  It can then use meta-queries performed using an\n   Opportunistic\
    \ Privacy profile to an untrusted recursive DNS resolver\n   to establish the\
    \ IP address of the intended privacy-enabling DNS\n   resolver by doing a lookup\
    \ of A/AAAA records.  A DNSSEC-validating\n   client SHOULD apply the same validation\
    \ policy to the A/AAAA\n   meta-queries as it does to other queries.  A client\
    \ that does not\n   validate DNSSEC SHOULD apply the same policy (if any) to the\
    \ A/AAAA\n   meta-queries as it does to other queries.  Private DNS resolution\
    \ can\n   now be done by the DNS client against the pre-configured privacy-\n\
    \   enabling DNS resolver, using the IP address obtained from the\n   untrusted\
    \ DNS resolver.\n   A DNS client so configured that successfully connects to a\
    \ privacy-\n   enabling DNS server MAY choose to locally cache the server host\
    \ IP\n   addresses in order to not have to repeat the meta-query.\n"
- title: 7.3.  Dynamic Discovery of ADN
  contents:
  - "7.3.  Dynamic Discovery of ADN\n   This section discusses the general case of\
    \ a DNS client discovering\n   both the authentication domain name and IP address\
    \ dynamically.  At\n   the time of this writing, this is not possible by any standard\
    \ means.\n   However, since, for example, a future DHCP extension could (in\n\
    \   principle) provide this mechanism, the required security properties\n   of\
    \ such mechanisms are outlined here.\n   When using a Strict Privacy profile,\
    \ the dynamic discovery technique\n   used as a source of authentication domain\
    \ names MUST be considered\n   secure and trustworthy.  This requirement does\
    \ not apply when using\n   an Opportunistic Privacy profile, given the security\
    \ expectation of\n   that profile.\n"
- title: 7.3.1.  DHCP
  contents:
  - "7.3.1.  DHCP\n   In the typical case today, a DHCP server [RFC2131] [RFC3315]\
    \ provides\n   a list of IP addresses for DNS resolvers (see Section 3.8 of\n\
    \   [RFC2132]) but does not provide an authentication domain name for the\n  \
    \ DNS resolver, thus preventing the use of most of the authentication\n   methods\
    \ described here (all of those that are based on a mechanism\n   with ADN; see\
    \ Table 2).\n   This document does not specify or request any DHCP extension to\n\
    \   provide authentication domain names.  However, if one is developed in\n  \
    \ future work, the issues outlined in Section 8 of [RFC7227] should be\n   taken\
    \ into account, as should the security considerations discussed\n   in Section\
    \ 23 of [RFC3315].\n   This document does not attempt to describe secured and\
    \ trusted\n   relationships to DHCP servers, as this is purely a DHCP issue (and\n\
    \   still open, at the time of this writing).  Whilst some implementation\n  \
    \ work is in progress to secure IPv6 connections for DHCP, IPv4\n   connections\
    \ have received little or no implementation attention in\n   this area.\n"
- title: 8.  Credential Verification Based on Authentication Domain Name
  contents:
  - '8.  Credential Verification Based on Authentication Domain Name

    '
- title: 8.1.  Authentication Based on PKIX Certificate
  contents:
  - "8.1.  Authentication Based on PKIX Certificate\n   When a DNS client configured\
    \ with an authentication domain name\n   connects to its configured DNS server\
    \ over (D)TLS, the server may\n   present it with a PKIX certificate.  In order\
    \ to ensure proper\n   authentication, DNS clients MUST verify the entire certification\
    \ path\n   per [RFC5280].  The DNS client additionally uses validation\n   techniques\
    \ as described in [RFC6125] to compare the domain name to\n   the certificate\
    \ provided.\n   A DNS client constructs one reference identifier for the server\
    \ based\n   on the authentication domain name: a DNS-ID, which is simply the\n\
    \   authentication domain name itself.\n   If the reference identifier is found\
    \ (as described in Section 6 of\n   [RFC6125]) in the PKIX certificate's subjectAltName\
    \ extension, the\n   DNS client should accept the certificate for the server.\n\
    \   A compliant DNS client MUST only inspect the certificate's\n   subjectAltName\
    \ extension for the reference identifier.  In\n   particular, it MUST NOT inspect\
    \ the Subject field itself.\n"
- title: 8.2.  DANE
  contents:
  - "8.2.  DANE\n   DANE [RFC6698] provides various mechanisms using DNSSEC to anchor\n\
    \   trust for certificates and raw public keys.  However, this requires\n   the\
    \ DNS client to have an authentication domain name (which must be\n   obtained\
    \ via a trusted source) for the DNS privacy server.\n   This section assumes a\
    \ solid understanding of both DANE [RFC6698] and\n   DANE operations [RFC7671].\
    \  A few pertinent issues covered in these\n   documents are outlined here as\
    \ useful pointers, but familiarity with\n   both of these documents in their entirety\
    \ is expected.\n   Note that [RFC6698] says\n      Clients that validate the DNSSEC\
    \ signatures themselves MUST use\n      standard DNSSEC validation procedures.\
    \  Clients that rely on\n      another entity to perform the DNSSEC signature\
    \ validation MUST use\n      a secure mechanism between themselves and the validator.\n\
    \   Note that [RFC7671] covers the following topics:\n   o  Sections 4.1 (\"Opportunistic\
    \ Security and PKIX Usages\") and 14\n      (\"Security Considerations\") of [RFC7671],\
    \ which both discuss the\n      use of schemes based on trust anchors and end\
    \ entities (PKIX-TA(0)\n      and PKIX-EE(1), respectively) for Opportunistic\
    \ Security.\n   o  Section 5 (\"Certificate-Usage-Specific DANE Updates and\n\
    \      Guidelines\") of [RFC7671] -- specifically, Section 5.1 of\n      [RFC7671],\
    \ which outlines the combination of certificate usage\n      DANE-EE(3) and selector\
    \ SPKI(1) with raw public keys [RFC7250].\n      Section 5.1 of [RFC7671] also\
    \ discusses the security implications\n      of this mode; for example, it discusses\
    \ key lifetimes and\n      specifies that validity period enforcement is based\
    \ solely on the\n      TLSA RRset properties for this case.\n   o  Section 13\
    \ (\"Operational Considerations\") of [RFC7671], which\n      discusses TLSA TTLs\
    \ and signature validity periods.\n   The specific DANE record for a DNS privacy\
    \ server would take the form\n      _853._tcp.[authentication-domain-name] for\
    \ TLS\n      _853._udp.[authentication-domain-name] for DTLS\n"
- title: 8.2.1.  Direct DNS Meta-Queries
  contents:
  - "8.2.1.  Direct DNS Meta-Queries\n   The DNS client MAY choose to perform the\
    \ DNS meta-queries to retrieve\n   the required DANE records itself.  The DNS\
    \ meta-queries for such DANE\n   records MAY use the Opportunistic Privacy profile\
    \ or be in the clear\n   to avoid trust recursion.  The records MUST be validated\
    \ using DNSSEC\n   as described in [RFC6698].\n"
- title: 8.2.2.  TLS DNSSEC Chain Extension
  contents:
  - "8.2.2.  TLS DNSSEC Chain Extension\n   The DNS client MAY offer the TLS extension\
    \ described in\n   [TLS-DNSSEC-Chain-Ext].  If the DNS server supports this extension,\n\
    \   it can provide the full chain to the client in the handshake.\n   If the DNS\
    \ client offers the TLS DNSSEC chain extension, it MUST be\n   capable of validating\
    \ the full DNSSEC authentication chain down to\n   the leaf.  If the supplied\
    \ DNSSEC chain does not validate, the client\n   MUST ignore the DNSSEC chain\
    \ and validate only via other supplied\n   credentials.\n"
- title: 9.  (D)TLS Protocol Profile
  contents:
  - "9.  (D)TLS Protocol Profile\n   This section defines the (D)TLS protocol profile\
    \ of DNS over (D)TLS.\n   Clients and servers MUST adhere to the (D)TLS implementation\n\
    \   recommendations and security considerations of [RFC7525], except with\n  \
    \ respect to the (D)TLS version.\n   Since encryption of DNS using (D)TLS is a\
    \ greenfield deployment, DNS\n   clients and servers MUST implement only (D)TLS\
    \ 1.2 or later.  For\n   example, implementing (D)TLS 1.3 [TLS-1.3] [DTLS-1.3]\
    \ is also an\n   option.\n   Implementations MUST NOT offer or provide TLS compression,\
    \ since\n   compression can leak significant amounts of information, especially\n\
    \   to a network observer capable of forcing the user to do an arbitrary\n   DNS\
    \ lookup in the style of the Compression Ratio Info-leak Made Easy\n   (CRIME)\
    \ attacks [CRIME].\n   Implementations compliant with this profile MUST implement\
    \ the\n   following items:\n   o  TLS session resumption without server-side state\
    \ [RFC5077], which\n      eliminates the need for the server to retain cryptographic\
    \ state\n      for longer than necessary.  (This statement updates [RFC7858].)\n\
    \   o  Raw public keys [RFC7250], which reduce the size of the\n      ServerHello\
    \ and can be used by servers that cannot obtain\n      certificates (e.g., DNS\
    \ servers on private networks).  A client\n      MUST only indicate support for\
    \ raw public keys if it has an SPKI\n      pin set pre-configured (for interoperability\
    \ reasons).\n   Implementations compliant with this profile SHOULD implement the\n\
    \   following items:\n   o  TLS False Start [RFC7918], which reduces round trips\
    \ by allowing\n      the TLS second flight of messages (ChangeCipherSpec) to also\n\
    \      contain the (encrypted) DNS query.\n   o  The Cached Information Extension\
    \ [RFC7924], which avoids\n      transmitting the server's certificate and certificate\
    \ chain if the\n      client has cached that information from a previous TLS handshake.\n\
    \   Guidance specific to TLS is provided in [RFC7858], and guidance\n   specific\
    \ to DTLS is provided in [RFC8094].\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document does not require any IANA actions.\n"
- title: 11.  Security Considerations
  contents:
  - "11.  Security Considerations\n   Security considerations discussed in [RFC7525],\
    \ [RFC8094], and\n   [RFC7858] apply to this document.\n   DNS clients SHOULD\
    \ implement (1) support for the mechanisms described\n   in Section 8.2 and (2)\
    \ offering a configuration option that limits\n   authentication to using only\
    \ those mechanisms (i.e., with no fallback\n   to pure PKIX-based authentication)\
    \ such that authenticating solely\n   via the PKIX infrastructure can be avoided.\n"
- title: 11.1.  Countermeasures to DNS Traffic Analysis
  contents:
  - "11.1.  Countermeasures to DNS Traffic Analysis\n   This section makes suggestions\
    \ for measures that can reduce the\n   ability of attackers to infer information\
    \ pertaining to encrypted\n   client queries by other means (e.g., via an analysis\
    \ of encrypted\n   traffic size or via monitoring of the unencrypted traffic from\
    \ a DNS\n   recursive resolver to an authoritative server).\n   DNS-over-(D)TLS\
    \ clients and servers SHOULD implement the following\n   relevant DNS extensions:\n\
    \   o  Extension Mechanisms for DNS (EDNS(0)) padding [RFC7830], which\n     \
    \ allows encrypted queries and responses to hide their size, making\n      analysis\
    \ of encrypted traffic harder.\n   Guidance on padding policies for EDNS(0) is\
    \ provided in\n   [EDNS0-Pad-Policies].\n   DNS-over-(D)TLS clients SHOULD implement\
    \ the following relevant DNS\n   extensions:\n   o  Privacy election per [RFC7871]\
    \ (\"Client Subnet in DNS Queries\").\n      If a DNS client does not include\
    \ an edns-client-subnet EDNS0\n      option with SOURCE PREFIX-LENGTH set to 0\
    \ in a query, the DNS\n      server may potentially leak client address information\
    \ to the\n      upstream authoritative DNS servers.  A DNS client ought to be\
    \ able\n      to inform the DNS resolver that it does not want any address\n \
    \     information leaked, and the DNS resolver should honor that\n      request.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n  \
    \            DOI 10.17487/RFC2119, March 1997,\n              <https://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC5077]  Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig,\n       \
    \       \"Transport Layer Security (TLS) Session Resumption without\n        \
    \      Server-Side State\", RFC 5077, DOI 10.17487/RFC5077,\n              January\
    \ 2008, <https://www.rfc-editor.org/info/rfc5077>.\n   [RFC5246]  Dierks, T. and\
    \ E. Rescorla, \"The Transport Layer Security\n              (TLS) Protocol Version\
    \ 1.2\", RFC 5246,\n              DOI 10.17487/RFC5246, August 2008,\n       \
    \       <https://www.rfc-editor.org/info/rfc5246>.\n   [RFC5280]  Cooper, D.,\
    \ Santesson, S., Farrell, S., Boeyen, S.,\n              Housley, R., and W. Polk,\
    \ \"Internet X.509 Public Key\n              Infrastructure Certificate and Certificate\
    \ Revocation List\n              (CRL) Profile\", RFC 5280, DOI 10.17487/RFC5280,\
    \ May 2008,\n              <https://www.rfc-editor.org/info/rfc5280>.\n   [RFC6125]\
    \  Saint-Andre, P. and J. Hodges, \"Representation and\n              Verification\
    \ of Domain-Based Application Service Identity\n              within Internet\
    \ Public Key Infrastructure Using X.509\n              (PKIX) Certificates in\
    \ the Context of Transport Layer\n              Security (TLS)\", RFC 6125, DOI\
    \ 10.17487/RFC6125,\n              March 2011, <https://www.rfc-editor.org/info/rfc6125>.\n\
    \   [RFC6347]  Rescorla, E. and N. Modadugu, \"Datagram Transport Layer\n    \
    \          Security Version 1.2\", RFC 6347, DOI 10.17487/RFC6347,\n         \
    \     January 2012, <https://www.rfc-editor.org/info/rfc6347>.\n   [RFC6698] \
    \ Hoffman, P. and J. Schlyter, \"The DNS-Based Authentication\n              of\
    \ Named Entities (DANE) Transport Layer Security (TLS)\n              Protocol:\
    \ TLSA\", RFC 6698, DOI 10.17487/RFC6698,\n              August 2012, <https://www.rfc-editor.org/info/rfc6698>.\n\
    \   [RFC7250]  Wouters, P., Ed., Tschofenig, H., Ed., Gilmore, J.,\n         \
    \     Weiler, S., and T. Kivinen, \"Using Raw Public Keys in\n              Transport\
    \ Layer Security (TLS) and Datagram Transport\n              Layer Security (DTLS)\"\
    , RFC 7250, DOI 10.17487/RFC7250,\n              June 2014, <https://www.rfc-editor.org/info/rfc7250>.\n\
    \   [RFC7525]  Sheffer, Y., Holz, R., and P. Saint-Andre,\n              \"Recommendations\
    \ for Secure Use of Transport Layer\n              Security (TLS) and Datagram\
    \ Transport Layer Security\n              (DTLS)\", BCP 195, RFC 7525, DOI 10.17487/RFC7525,\n\
    \              May 2015, <https://www.rfc-editor.org/info/rfc7525>.\n   [RFC7671]\
    \  Dukhovni, V. and W. Hardaker, \"The DNS-Based\n              Authentication\
    \ of Named Entities (DANE) Protocol: Updates\n              and Operational Guidance\"\
    , RFC 7671, DOI 10.17487/RFC7671,\n              October 2015, <https://www.rfc-editor.org/info/rfc7671>.\n\
    \   [RFC7830]  Mayrhofer, A., \"The EDNS(0) Padding Option\", RFC 7830,\n    \
    \          DOI 10.17487/RFC7830, May 2016,\n              <https://www.rfc-editor.org/info/rfc7830>.\n\
    \   [RFC7858]  Hu, Z., Zhu, L., Heidemann, J., Mankin, A., Wessels, D.,\n    \
    \          and P. Hoffman, \"Specification for DNS over Transport\n          \
    \    Layer Security (TLS)\", RFC 7858, DOI 10.17487/RFC7858,\n              May\
    \ 2016, <https://www.rfc-editor.org/info/rfc7858>.\n   [RFC7918]  Langley, A.,\
    \ Modadugu, N., and B. Moeller, \"Transport\n              Layer Security (TLS)\
    \ False Start\", RFC 7918,\n              DOI 10.17487/RFC7918, August 2016,\n\
    \              <https://www.rfc-editor.org/info/rfc7918>.\n   [RFC7924]  Santesson,\
    \ S. and H. Tschofenig, \"Transport Layer Security\n              (TLS) Cached\
    \ Information Extension\", RFC 7924,\n              DOI 10.17487/RFC7924, July\
    \ 2016,\n              <https://www.rfc-editor.org/info/rfc7924>.\n   [RFC8094]\
    \  Reddy, T., Wing, D., and P. Patil, \"DNS over Datagram\n              Transport\
    \ Layer Security (DTLS)\", RFC 8094,\n              DOI 10.17487/RFC8094, February\
    \ 2017,\n              <https://www.rfc-editor.org/info/rfc8094>.\n   [RFC8174]\
    \  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in\n              RFC 2119\
    \ Key Words\", BCP 14, RFC 8174,\n              DOI 10.17487/RFC8174, May 2017,\n\
    \              <https://www.rfc-editor.org/info/rfc8174>.\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [CRIME]    Rizzo, J. and T. Duong, \"The CRIME\
    \ Attack\", Ekoparty\n              Security Conference, 2012,\n             \
    \ <https://www.ekoparty.org/archivo/2012/eko8-CRIME.pdf>.\n   [dnssec-trigger]\n\
    \              NLnetLabs, \"Dnssec-Trigger\", December 2017,\n              <https://www.nlnetlabs.nl/projects/dnssec-trigger/>.\n\
    \   [DTLS-1.3]\n              Rescorla, E., Tschofenig, H., and N. Modadugu, \"\
    The\n              Datagram Transport Layer Security (DTLS) Protocol\n       \
    \       Version 1.3\", Work in Progress, draft-ietf-tls-dtls13-26,\n         \
    \     March 2018.\n   [EDNS0-Pad-Policies]\n              Mayrhofer, A., \"Padding\
    \ Policy for EDNS(0)\", Work in\n              Progress, draft-ietf-dprive-padding-policy-04,\n\
    \              February 2018.\n   [RFC2131]  Droms, R., \"Dynamic Host Configuration\
    \ Protocol\",\n              RFC 2131, DOI 10.17487/RFC2131, March 1997,\n   \
    \           <https://www.rfc-editor.org/info/rfc2131>.\n   [RFC2132]  Alexander,\
    \ S. and R. Droms, \"DHCP Options and BOOTP Vendor\n              Extensions\"\
    , RFC 2132, DOI 10.17487/RFC2132, March 1997,\n              <https://www.rfc-editor.org/info/rfc2132>.\n\
    \   [RFC3315]  Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,\n    \
    \          C., and M. Carney, \"Dynamic Host Configuration Protocol\n        \
    \      for IPv6 (DHCPv6)\", RFC 3315, DOI 10.17487/RFC3315,\n              July\
    \ 2003, <https://www.rfc-editor.org/info/rfc3315>.\n   [RFC3646]  Droms, R., Ed.,\
    \ \"DNS Configuration options for Dynamic\n              Host Configuration Protocol\
    \ for IPv6 (DHCPv6)\", RFC 3646,\n              DOI 10.17487/RFC3646, December\
    \ 2003,\n              <https://www.rfc-editor.org/info/rfc3646>.\n   [RFC7227]\
    \  Hankins, D., Mrugalski, T., Siodelski, M., Jiang, S., and\n              S.\
    \ Krishnan, \"Guidelines for Creating New DHCPv6 Options\",\n              BCP\
    \ 187, RFC 7227, DOI 10.17487/RFC7227, May 2014,\n              <https://www.rfc-editor.org/info/rfc7227>.\n\
    \   [RFC7435]  Dukhovni, V., \"Opportunistic Security: Some Protection\n     \
    \         Most of the Time\", RFC 7435, DOI 10.17487/RFC7435,\n              December\
    \ 2014, <https://www.rfc-editor.org/info/rfc7435>.\n   [RFC7469]  Evans, C., Palmer,\
    \ C., and R. Sleevi, \"Public Key Pinning\n              Extension for HTTP\"\
    , RFC 7469, DOI 10.17487/RFC7469,\n              April 2015, <https://www.rfc-editor.org/info/rfc7469>.\n\
    \   [RFC7626]  Bortzmeyer, S., \"DNS Privacy Considerations\", RFC 7626,\n   \
    \           DOI 10.17487/RFC7626, August 2015,\n              <https://www.rfc-editor.org/info/rfc7626>.\n\
    \   [RFC7871]  Contavalli, C., van der Gaast, W., Lawrence, D., and\n        \
    \      W. Kumari, \"Client Subnet in DNS Queries\", RFC 7871,\n              DOI\
    \ 10.17487/RFC7871, May 2016,\n              <https://www.rfc-editor.org/info/rfc7871>.\n\
    \   [TLS-1.3]  Rescorla, E., \"The Transport Layer Security (TLS) Protocol\n \
    \             Version 1.3\", Work in Progress, draft-ietf-tls-tls13-27,\n    \
    \          March 2018.\n   [TLS-DNSSEC-Chain-Ext]\n              Shore, M., Barnes,\
    \ R., Huque, S., and W. Toorop, \"A DANE\n              Record and DNSSEC Authentication\
    \ Chain Extension for TLS\",\n              Work in Progress, draft-ietf-tls-dnssec-chain-\n\
    \              extension-06, January 2018.\n"
- title: Appendix A.  Server Capability Probing and Caching by DNS Clients
  contents:
  - "Appendix A.  Server Capability Probing and Caching by DNS Clients\n   This section\
    \ presents a non-normative discussion of how DNS clients\n   might probe for,\
    \ and cache capabilities of, privacy-enabling DNS\n   servers.\n   Deployment\
    \ of both DNS over TLS and DNS over DTLS will be gradual.\n   Not all servers\
    \ will support one or both of these protocols, and the\n   well-known port might\
    \ be blocked by some middleboxes.  Clients will\n   be expected to keep track\
    \ of servers that support DNS over TLS and/or\n   DNS over DTLS, as well as those\
    \ that have been previously\n   authenticated.\n   If no server capability information\
    \ is available, then (unless\n   otherwise specified by the configuration of the\
    \ DNS client) DNS\n   clients that implement both TLS and DTLS should try to authenticate\n\
    \   using both protocols before failing or falling back to an\n   unauthenticated\
    \ or cleartext connection.  DNS clients using an\n   Opportunistic Privacy profile\
    \ should try all available servers\n   (possibly in parallel) in order to obtain\
    \ an authenticated and\n   encrypted connection before falling back.  (RATIONALE:\
    \ This approach\n   can increase latency while discovering server capabilities\
    \ but\n   maximizes the chance of sending the query over an authenticated and\n\
    \   encrypted connection.)\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   Thanks to the authors of both [RFC8094] and [RFC7858] for\
    \ laying the\n   groundwork for this document and for reviewing the contents.\
    \  The\n   authors would also like to thank John Dickinson, Shumon Huque,\n  \
    \ Melinda Shore, Gowri Visweswaran, Ray Bellis, Stephane Bortzmeyer,\n   Jinmei\
    \ Tatuya, Paul Hoffman, Christian Huitema, and John Levine for\n   review and\
    \ discussion of the ideas presented here.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Sara Dickinson\n   Sinodun Internet Technologies\n   Magdalen\
    \ Centre\n   Oxford Science Park\n   Oxford  OX4 4GA\n   United Kingdom\n   Email:\
    \ sara@sinodun.com\n   URI:   https://www.sinodun.com/\n   Daniel Kahn Gillmor\n\
    \   ACLU\n   125 Broad Street, 18th Floor\n   New York, NY  10004\n   United States\
    \ of America\n   Email: dkg@fifthhorseman.net\n   Tirumaleswar Reddy\n   McAfee,\
    \ Inc.\n   Embassy Golf Link Business Park\n   Bangalore, Karnataka  560071\n\
    \   India\n   Email: TirumaleswarReddy_Konda@McAfee.com\n"
