- title: __initial_text__
  contents:
  - '                NBMA Next Hop Resolution Protocol (NHRP)

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (1998).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes the NBMA Next Hop Resolution Protocol (NHRP).\n\
    \   NHRP can be used by a source station (host or router) connected to a\n   Non-Broadcast,\
    \ Multi-Access (NBMA) subnetwork to determine the\n   internetworking layer address\
    \ and NBMA subnetwork addresses of the\n   \"NBMA next hop\" towards a destination\
    \ station.  If the destination is\n   connected to the NBMA subnetwork, then the\
    \ NBMA next hop is the\n   destination station itself.  Otherwise, the NBMA next\
    \ hop is the\n   egress router from the NBMA subnetwork that is \"nearest\" to\
    \ the\n   destination station.  NHRP is intended for use in a multiprotocol\n\
    \   internetworking layer environment over NBMA subnetworks.\n   Note that while\
    \ this protocol was developed for use with NBMA\n   subnetworks, it is possible,\
    \ if not likely, that it will be applied\n   to BMA subnetworks as well.  However,\
    \ this usage of NHRP is for\n   further study.\n   This document is intended to\
    \ be a functional superset of the NBMA\n   Address Resolution Protocol (NARP)\
    \ documented in [1].\n   Operation of NHRP as a means of establishing a transit\
    \ path across an\n   NBMA subnetwork between two routers will be addressed in\
    \ a separate\n   document (see [13]).\n"
- title: 1. Introduction
  contents:
  - "1. Introduction\n   The keywords MUST, MUST NOT, REQUIRED, SHALL, SHALL NOT,\
    \ SHOULD,\n   SHOULD NOT, RECOMMENDED, MAY, and OPTIONAL, when they appear in\
    \ this\n   document, are to be interpreted as described in [15].\n   The NBMA\
    \ Next Hop Resolution Protocol (NHRP) allows a source station\n   (a host or router),\
    \ wishing to communicate over a Non-Broadcast,\n   Multi-Access (NBMA) subnetwork,\
    \ to determine the internetworking\n   layer addresses and NBMA addresses of suitable\
    \ \"NBMA next hops\"\n   toward a destination station.  A subnetwork can be non-broadcast\n\
    \   either because it technically doesn't support broadcasting (e.g., an\n   X.25\
    \ subnetwork) or because broadcasting is not feasible for one\n   reason or another\
    \ (e.g., an SMDS multicast group or an extended\n   Ethernet would be too large).\
    \  If the destination is connected to the\n   NBMA subnetwork, then the NBMA next\
    \ hop is the destination station\n   itself.  Otherwise, the NBMA next hop is\
    \ the egress router from the\n   NBMA subnetwork that is \"nearest\" to the destination\
    \ station.\n   One way to model an NBMA network is by using the notion of logically\n\
    \   independent IP subnets (LISs). LISs, as defined in [3] and [4], have\n   the\
    \ following properties:\n      1)  All members of a LIS have the same IP network/subnet\
    \ number\n          and address mask.\n      2)  All members of a LIS are directly\
    \ connected to the same\n          NBMA subnetwork.\n      3)  All hosts and routers\
    \ outside of the LIS are accessed via\n          a router.\n      4)  All members\
    \ of a LIS access each other directly (without\n          routers).\n   Address\
    \ resolution as described in [3] and [4] only resolves the next\n   hop address\
    \ if the destination station is a member of the same LIS as\n   the source station;\
    \ otherwise, the source station must forward\n   packets to a router that is a\
    \ member of multiple LIS's.  In multi-LIS\n   configurations, hop-by-hop address\
    \ resolution may not be sufficient\n   to resolve the \"NBMA next hop\" toward\
    \ the destination station, and IP\n   packets may have multiple IP hops through\
    \ the NBMA subnetwork.\n   Another way to model NBMA is by using the notion of\
    \ Local Address\n   Groups (LAGs) [10]. The essential difference between the LIS\
    \ and the\n   LAG models is that while with the LIS model the outcome of the\n\
    \   \"local/remote\" forwarding decision is driven purely by addressing\n   information,\
    \ with the LAG model the outcome of this decision is\n   decoupled from the addressing\
    \ information and is coupled with the\n   Quality of Service and/or traffic characteristics.\
    \  With the LAG\n   model any two entities on a common NBMA network could establish\
    \ a\n   direct communication with each other, irrespective of the entities'\n\
    \   addresses.\n   Support for the LAG model assumes the existence of a mechanism\
    \ that\n   allows any entity (i.e., host or router) connected to an NBMA network\n\
    \   to resolve an internetworking layer address to an NBMA address for\n   any\
    \ other entity connected to the same NBMA network.  This resolution\n   would\
    \ take place regardless of the address assignments to these\n   entities. Within\
    \ the parameters described in this document, NHRP\n   describes such a mechanism.\
    \  For example, when the internetworking\n   layer address is of type IP, once\
    \ the NBMA next hop has been\n   resolved, the source may either start sending\
    \ IP packets to the\n   destination (in a connectionless NBMA subnetwork such\
    \ as SMDS) or may\n   first establish a connection to the destination with the\
    \ desired\n   bandwidth (in a connection-oriented NBMA subnetwork such as ATM).\n\
    \   Use of NHRP may be sufficient for hosts doing address resolution when\n  \
    \ those hosts are directly connected to an NBMA subnetwork, allowing\n   for straightforward\
    \ implementations in NBMA stations. NHRP also has\n   the capability of determining\
    \ the egress point from an NBMA\n   subnetwork when the destination is not directly\
    \ connected to the NBMA\n   subnetwork and the identity of the egress router is\
    \ not learned by\n   other methods (such as routing protocols).  Optional extensions\
    \ to\n   NHRP provide additional robustness and diagnosability.\n   Address resolution\
    \ techniques such as those described in [3] and [4]\n   may be in use when NHRP\
    \ is deployed.  ARP servers and services over\n   NBMA subnetworks may be required\
    \ to support hosts that are not\n   capable of dealing with any model for communication\
    \ other than the\n   LIS model, and deployed hosts may not implement NHRP but\
    \ may continue\n   to support ARP variants such as those described in [3] and\
    \ [4].  NHRP\n   is intended to reduce or eliminate the extra router hops required\
    \ by\n   the LIS model, and can be deployed in a non-interfering manner with\n\
    \   existing ARP services [14].\n   The operation of NHRP to establish transit\
    \ paths across NBMA\n   subnetworks between two routers requires additional mechanisms\
    \ to\n   avoid stable routing loops, and will be described in a separate\n   document\
    \ (see [13]).\n"
- title: 2. Overview
  contents:
  - '2. Overview

    '
- title: 2.1 Terminology
  contents:
  - "2.1 Terminology\n   The term \"network\" is highly overloaded, and is especially\
    \ confusing\n   in the context of NHRP.  We use the following terms:\n     Internetwork\
    \ layer--the media-independent layer (IP in the case of\n     TCP/IP networks).\n\
    \     Subnetwork layer--the media-dependent layer underlying the\n     internetwork\
    \ layer, including the NBMA technology (ATM, X.25, SMDS,\n     etc.)\n     The\
    \ term \"server\", unless explicitly stated to the contrary, refers\n     to a\
    \ Next Hop Server (NHS).  An NHS is an entity performing the\n     Next Hop Resolution\
    \ Protocol service within the NBMA cloud.  An NHS\n     is always tightly coupled\
    \ with a routing entity (router, route\n     server or edge device) although the\
    \ converse is not yet guaranteed\n     until ubiquitous deployment of this functionality\
    \ occurs.  Note\n     that the presence of intermediate routers that are not coupled\
    \ with\n     an NHS entity may preclude the use of NHRP when source and\n    \
    \ destination stations on different sides of such routers and thus\n     such\
    \ routers may partition NHRP reachability within an NBMA\n     network.\n    \
    \ The term \"client\", unless explicitly stated to the contrary, refers\n    \
    \ to a Next Hop Resolution Protocol client (NHC).  An NHC is an\n     entity which\
    \ initiates NHRP requests of various types in order to\n     obtain access to\
    \ the NHRP service.\n     The term \"station\" generally refers to a host or router\
    \ which\n     contains an NHRP entity.  Occasionally, the term station will\n\
    \     describe a \"user\" of the NHRP client or service functionality; the\n \
    \    difference in usage is largely semantic.\n"
- title: 2.2 Protocol Overview
  contents:
  - "2.2 Protocol Overview\n   In this section, we briefly describe how a source S\
    \ (which\n   potentially can be either a router or a host) uses NHRP to determine\n\
    \   the \"NBMA next hop\" to destination D.\n   For administrative and policy\
    \ reasons, a physical NBMA subnetwork may\n   be partitioned into several, disjoint\
    \ \"Logical NBMA subnetworks\".  A\n   Logical NBMA subnetwork is defined as a\
    \ collection of hosts and\n   routers that share unfiltered subnetwork connectivity\
    \ over an NBMA\n   subnetwork.  \"Unfiltered subnetwork connectivity\" refers\
    \ to the\n   absence of closed user groups, address screening or similar features\n\
    \   that may be used to prevent direct communication between stations\n   connected\
    \ to the same NBMA subnetwork.  (Hereafter, unless otherwise\n   specified, we\
    \ use the term \"NBMA subnetwork\" to mean *logical* NBMA\n   subnetwork.)\n \
    \  Placed within the NBMA subnetwork are one or more entities that\n   implement\
    \ the NHRP protocol.  Such stations which are capable of\n   answering NHRP Resolution\
    \ Requests are known as \"Next Hop Servers\"\n   (NHSs).  Each NHS serves a set\
    \ of destination hosts, which may or may\n   not be directly connected to the\
    \ NBMA subnetwork.  NHSs cooperatively\n   resolve the NBMA next hop within their\
    \ logical NBMA subnetwork.  In\n   addition to NHRP, NHSs may support \"classical\"\
    \ ARP service; however,\n   this will be the subject of a separate document [14].\n\
    \   An NHS maintains a cache which contains protocol layer address to\n   NBMA\
    \ subnetwork layer address resolution information.  This cache can\n   be constructed\
    \ from information obtained from NHRP Register packets\n   (see Section 5.2.3\
    \ and 5.2.4), from NHRP Resolution Request/Reply\n   packets, or through mechanisms\
    \ outside the scope of this document\n   (examples of such mechanisms might include\
    \ ARP[3] and pre-configured\n   tables).  Section 6.2 further describes cache\
    \ management issues.\n   For a station within a given LIS to avoid providing NHS\n\
    \   functionality, there must be one or more NHSs within the NBMA\n   subnetwork\
    \ which are providing authoritative address resolution\n   information on its\
    \ behalf.  Such an NHS is said to be \"serving\" the\n   station.  A station on\
    \ a LIS that lacks NHS functionality and is a\n   client of the NHRP service is\
    \ known as NHRP Client or just NHCs.  If\n   a serving NHS is to be able to supply\
    \ the address resolution\n   information for an NHC then NHSs must exist at each\
    \ hop along all\n   routed paths between the NHC making the resolution request\
    \ and the\n   destination NHC.  The last NHRP entity along the routed path is\
    \ the\n   serving NHS; that is, NHRP Resolution Requests are not forwarded to\n\
    \   destination NHCs but rather are processed by the serving NHS.\n   An NHC also\
    \ maintains a cache of protocol address to NBMA address\n   resolution information.\
    \  This cache is populated through information\n   obtained from NHRP Resolution\
    \ Reply packets, from manual\n   configuration, or through mechanisms outside\
    \ the scope of this\n   document.\n   The protocol proceeds as follows.  An event\
    \ occurs triggering station\n   S to want to resolve the NBMA address of a path\
    \ to D.  This is most\n   likely to be when a data packet addressed to station\
    \ D is to be\n   emitted from station S (either because station S is a host, or\n\
    \   station S is a transit router), but the address resolution could also\n  \
    \ be triggered by other means (a routing protocol update packet, for\n   example).\
    \ Station S first determines the next hop to station D\n   through normal routing\
    \ processes (for a host, the next hop may simply\n   be the default router; for\
    \ routers, this is the \"next hop\" to the\n   destination internetwork layer\
    \ address).  If the destination's\n   address resolution information is already\
    \ available in S's cache then\n   that information is used to forward the packet.\
    \  Otherwise, if the\n   next hop is reachable through one of its NBMA interfaces,\
    \ S\n   constructs an NHRP Resolution Request packet (see Section 5.2.1)\n   containing\
    \ station D's internetwork layer address as the (target)\n   destination address,\
    \ S's own internetwork layer address as the source\n   address (Next Hop Resolution\
    \ Request initiator), and station S's NBMA\n   addressing information.  Station\
    \ S may also indicate that it prefers\n   an authoritative NHRP Resolution Reply\
    \ (i.e., station S only wishes\n   to receive an NHRP Resolution Reply from an\
    \ NHS serving the\n   destination NHC). Station S emits the NHRP Resolution Request\
    \ packet\n   towards the destination.\n   If the NHRP Resolution Request is triggered\
    \ by a data packet then S\n   may, while awaiting an NHRP Resolution Reply, choose\
    \ to dispose of\n   the data packet in one of the following ways:\n     (a)  Drop\
    \ the packet\n     (b)  Retain the packet until the NHRP Resolution Reply arrives\n\
    \          and a more optimal path is available\n     (c)  Forward the packet\
    \ along the routed path toward D\n   The choice of which of the above to perform\
    \ is a local policy matter,\n   though option (c) is the recommended default,\
    \ since it may allow data\n   to flow to the destination while the NBMA address\
    \ is being resolved.\n   Note that an NHRP Resolution Request for a given destination\
    \ MUST NOT\n   be triggered on every packet.\n   When the NHS receives an NHRP\
    \ Resolution Request, a check is made to\n   see if it serves station D.  If the\
    \ NHS does not serve D, the NHS\n   forwards the NHRP Resolution Request to another\
    \ NHS.  Mechanisms for\n   determining how to forward the NHRP Resolution Request\
    \ are discussed\n   in Section 3.\n   If this NHS serves D, the NHS resolves station\
    \ D's NBMA address\n   information, and generates a positive NHRP Resolution Reply\
    \ on D's\n   behalf.  NHRP Resolution Replies in this scenario are always marked\n\
    \   as \"authoritative\".  The NHRP Resolution Reply packet contains the\n   address\
    \ resolution information for station D which is to be sent back\n   to S.  Note\
    \ that if station D is not on the NBMA subnetwork, the next\n   hop internetwork\
    \ layer address will be that of the egress router\n   through which packets for\
    \ station D are forwarded.\n   A transit NHS receiving an NHRP Resolution Reply\
    \ may cache the\n   address resolution information contained therein.  To a subsequent\n\
    \   NHRP Resolution Request, this NHS may respond with the cached, \"non-\n  \
    \ authoritative\" address resolution information if the NHS is permitted\n   to\
    \ do so (see Sections 5.2.2 and 6.2 for more information on non-\n   authoritative\
    \ versus authoritative NHRP Resolution Replies).  Non-\n   authoritative NHRP\
    \ Resolution Replies are distinguished from\n   authoritative NHRP Resolution\
    \ Replies so that if a communication\n   attempt based on non-authoritative information\
    \ fails, a source\n   station can choose to send an authoritative NHRP Resolution\
    \ Request.\n   NHSs MUST NOT respond to authoritative NHRP Resolution Requests\
    \ with\n   cached information.\n   If the determination is made that no NHS in\
    \ the NBMA subnetwork can\n   reply to the NHRP Resolution Request for D then\
    \ a negative NHRP\n   Resolution Reply (NAK) is returned.  This occurs when (a)\
    \ no next-hop\n   resolution information is available for station D from any NHS,\
    \ or\n   (b) an NHS is unable to forward the NHRP Resolution Request (e.g.,\n\
    \   connectivity is lost).\n   NHRP Registration Requests, NHRP Purge Requests,\
    \ NHRP Purge Replies,\n   and NHRP Error Indications follow a routed path in the\
    \ same fashion\n   that NHRP Resolution Requests and NHRP Resolution Replies do.\n\
    \   Specifically, \"requests\" and \"indications\" follow the routed path\n  \
    \ from Source Protocol Address (which is the address of the station\n   initiating\
    \ the communication) to the Destination Protocol Address.\n   \"Replies\", on\
    \ the other hand, follow the routed path from the\n   Destination Protocol Address\
    \ back to the Source Protocol Address with\n   the following exceptions: in the\
    \ case of a NHRP Registration Reply\n   and in the case of an NHC initiated NHRP\
    \ Purge Request, the packet is\n   always returned via a direct VC (see Sections\
    \ 5.2.4 and 5.2.5); if\n   one does not exists then one MUST be created.\n   NHRP\
    \ Requests and NHRP Replies do NOT cross the borders of a NBMA\n   subnetwork\
    \ however further study is being done in this area (see\n   Section 7).   Thus,\
    \ the internetwork layer data traffic out of and\n   into an NBMA subnetwork always\
    \ traverses an internetwork layer router\n   at its border.\n   NHRP optionally\
    \ provides a mechanism to send a NHRP Resolution Reply\n   which contains aggregated\
    \ address resolution information. For\n   example, suppose that router X is the\
    \ next hop from station S to\n   station D and that X is an egress router for\
    \ all stations sharing an\n   internetwork layer address prefix with station D.\
    \  When an NHRP\n   Resolution Reply is generated in response to a NHRP Resolution\n\
    \   Request, the responder may augment the internetwork layer address of\n   station\
    \ D with a prefix length (see Section 5.2.0.1).  A subsequent\n   (non-authoritative)\
    \ NHRP Resolution Request for some destination that\n   shares an internetwork\
    \ layer address prefix (for the number of bits\n   specified in the prefix length)\
    \ with D may be satisfied with this\n   cached information.  See section 6.2 regarding\
    \ caching issues.\n   To dynamically detect subnetwork-layer filtering in NBMA\
    \ subnetworks\n   (e.g., X.25 closed user group facility, or SMDS address screens),\
    \ to\n   trace the routed path that an NHRP packet takes, or to provide loop\n\
    \   detection and diagnostic capabilities, a \"Route Record\" may be\n   included\
    \ in NHRP packets (see Sections 5.3.2 and 5.3.3).  The Route\n   Record extensions\
    \ are the NHRP Forward Transit NHS Record Extension\n   and the NHRP Reverse Transit\
    \ NHS Record Extension.  They contain the\n   internetwork (and subnetwork layer)\
    \ addresses of all intermediate\n   NHSs between source and destination and between\
    \ destination and\n   source respectively.  When a source station is unable to\
    \ communicate\n   with the responder (e.g., an attempt to open an SVC fails),\
    \ it may\n   attempt to do so successively with other subnetwork layer addresses\n\
    \   in the NHRP Forward Transit NHS Record Extension until it succeeds\n   (if\
    \ authentication policy permits such action).  This approach can\n   find a suitable\
    \ egress point in the presence of subnetwork-layer\n   filtering (which may be\
    \ source/destination sensitive, for instance,\n   without necessarily creating\
    \ separate logical NBMA subnetworks) or\n   subnetwork-layer congestion (especially\
    \ in connection-oriented\n   media).\n"
- title: 3. Deployment
  contents:
  - "3. Deployment\n   NHRP Resolution Requests traverse one or more hops within an\
    \ NBMA\n   subnetwork before reaching the station that is expected to generate\
    \ a\n   response.  Each station, including the source station, chooses a\n   neighboring\
    \ NHS to which it will forward the NHRP Resolution Request.\n   The NHS selection\
    \ procedure typically involves applying a destination\n   protocol layer address\
    \ to the protocol layer routing table which\n   causes a routing decision to be\
    \ returned.  This routing decision is\n   then used to forward the NHRP Resolution\
    \ Request to the downstream\n   NHS. The destination protocol layer address previously\
    \ mentioned is\n   carried within the NHRP Resolution Request packet.  Note that\
    \ even\n   though a protocol layer address was used to acquire a routing\n   decision,\
    \ NHRP packets are not encapsulated within a protocol layer\n   header but rather\
    \ are carried at the NBMA layer using the\n   encapsulation described in Section\
    \ 5.\n   Each NHS/router examines the NHRP Resolution Request packet on its\n\
    \   way toward the destination.  Each NHS which the NHRP packet traverses\n  \
    \ on the way to the packet's destination might modify the packet (e.g.,\n   updating\
    \ the Forward Record extension).  Ignoring error situations,\n   the NHRP Resolution\
    \ Request eventually arrives at a station that is\n   to generate an NHRP Resolution\
    \ Reply.  This responding station\n   \"serves\" the destination.  The responding\
    \ station generates an NHRP\n   Resolution Reply using the source protocol address\
    \ from within the\n   NHRP packet to determine where the NHRP Resolution Reply\
    \ should be\n   sent.\n   Rather than use routing to determine the next hop for\
    \ an NHRP packet,\n   an NHS may use other applicable means (such as static configuration\n\
    \   information ) in order to determine to which neighboring NHSs to\n   forward\
    \ the NHRP Resolution Request packet as long as such other\n   means would not\
    \ cause the NHRP packet to arrive at an NHS which is\n   not along the routed\
    \ path.  The use of static configuration\n   information for this purpose is beyond\
    \ the scope of this document.\n   The NHS serving a particular destination must\
    \ lie along the routed\n   path to that destination.  In practice, this means\
    \ that all egress\n   routers must double as NHSs serving the destinations beyond\
    \ them, and\n   that hosts on the NBMA subnetwork are served by routers that double\n\
    \   as NHSs.  Also, this implies that forwarding of NHRP packets within\n   an\
    \ NBMA subnetwork requires a contiguous deployment of NHRP capable\n   routers.\
    \  It is important that, in a given LIS/LAG which is using\n   NHRP, all NHSs\
    \ within the LIS/LAG have at least some portion of their\n   resolution databases\
    \ synchronized so that a packet arriving at one\n   router/NHS in a given LIS/LAG\
    \ will be forwarded in the same fashion\n   as a packet arriving at a different\
    \ router/NHS for the given LIS/LAG.\n   One method, among others, is to use the\
    \ Server Cache Synchronization\n   Protocol (SCSP) [12].  It is RECOMMENDED that\
    \ SCSP be the method used\n   when a LIS/LAG contains two or more router/NHSs.\n\
    \   During migration to NHRP, it cannot be expected that all routers\n   within\
    \ the NBMA subnetwork are NHRP capable.  Thus, NHRP traffic\n   which would otherwise\
    \ need to be forwarded through such routers can\n   be expected to be dropped\
    \ due to the NHRP packet not being\n   recognized.  In this case, NHRP will be\
    \ unable to establish any\n   transit paths whose discovery requires the traversal\
    \ of the non-NHRP\n   speaking routers.  If the client has tried and failed to\
    \ acquire a\n   cut through path then the client should use the network layer\
    \ routed\n   path as a default.\n   If an NBMA technology offers a group, an anycast,\
    \ or a multicast\n   addressing feature then the NHC may be configured with such\
    \ an\n   address (appropriate to the routing realm it participates in) which\n\
    \   would be assigned to all NHS serving that routing realm.  This\n   address\
    \ can then be used for establishing an initial connection to an\n   NHS to transmit\
    \ a registration request.  This address may not be used\n   for sending NHRP requests.\
    \  The resulting VC may be used for NHRP\n   requests if and only if the registration\
    \ response is received over\n   that VC, thereby indicating that one happens to\
    \ have anycast\n   connected to an NHS serving the LIS/LAG.  In the case of non-\n\
    \   connection oriented networks, or of multicast (rather than anycast)\n   addresses,\
    \ the addres MUST NOT be used for sending NHRP resolution\n   requests.\n   When\
    \ an NHS \"serves\" an NHC, the NHS MUST send NHRP messages destined\n   for the\
    \ NHC directly to the NHC.  That is, the NHRP message MUST NOT\n   transit through\
    \ any NHS which is not serving the NHC when the NHRP\n   message is currently\
    \ at an NHS which does serve the NHC (this, of\n   course, assumes the NHRP message\
    \ is destined for the NHC).  Further,\n   an NHS which serves an NHC SHOULD have\
    \ a direct NBMA level connection\n   to that NHC (see Section 5.2.3 and 5.2.4\
    \ for examples).\n   With the exception of NHRP Registration Requests (see Section\
    \ 5.2.3\n   and 5.2.4 for details of the NHRP Registration Request case), an NHC\n\
    \   MUST send NHRP messages over a direct NBMA level connection between\n   the\
    \ serving NHS and the served NHC.\n   It may not be desirable to maintain semi-permanent\
    \ NBMA level\n   connectivity between the NHC and the NHS.   In this case, when\
    \ NBMA\n   level connectivity is initially setup between the NHS and the NHC (as\n\
    \   described in Section 5.2.4), the NBMA address of the NHS should be\n   obtained\
    \ through the NBMA level signaling technology.  This address\n   should be stored\
    \ for future use in setting up subsequent NBMA level\n   connections.  A somewhat\
    \ more information rich technique to obtain\n   the address information (and more)\
    \ of the serving NHS would be for\n   the NHC to include the Responder Address\
    \ extension (see Section\n   5.3.1) in the NHRP Registration Request and to store\
    \ the information\n   returned to the NHC in the Responder Address extension which\
    \ is\n   subsequently included in the NHRP Registration Reply.  Note also\n  \
    \ that, in practice, a client's default router should also be its NHS;\n   thus\
    \ a client may be able to know the NBMA address of its NHS from\n   the configuration\
    \ which was already required for the client to be\n   able to communicate.  Further,\
    \ as mentioned in Section 4, NHCs may be\n   configured with the addressing information\
    \ of one or more NHSs.\n"
- title: 4. Configuration
  contents:
  - "4. Configuration\n   Next Hop Clients\n     An NHC connected to an NBMA subnetwork\
    \ MAY be configured with the\n     Protocol address(es) and NBMA address(es) of\
    \ its NHS(s).  The\n     NHS(s) will likely also represent the NHC's default or\
    \ peer\n     routers, so their NBMA addresses may be obtained from the NHC's\n\
    \     existing configuration.  If the NHC is attached to several\n     subnetworks\
    \ (including logical NBMA subnetworks), the NHC should\n     also be configured\
    \ to receive routing information from its NHS(s)\n     and peer routers so that\
    \ it can determine which internetwork layer\n     networks are reachable through\
    \ which subnetworks.\n   Next Hop Servers\n     An NHS is configured with knowledge\
    \ of its own internetwork layer\n     and NBMA addresses.  An NHS MAY also be\
    \ configured with a set of\n     internetwork layer address prefixes that correspond\
    \ to the\n     internetwork layer addresses of the stations it serves. The NBMA\n\
    \     addresses of the stations served by the NHS may be learned via NHRP\n  \
    \   Registration packets.\n     If a served NHC is attached to several subnetworks,\
    \ the\n     router/route-server coresident with the serving NHS may also need\n\
    \     to be configured to advertise routing information to such NHCs.\n     If\
    \ an NHS acts as an egress router for stations connected to other\n     subnetworks\
    \ than the NBMA subnetwork, the NHS must, in addition to\n     the above, be configured\
    \ to exchange routing information between\n     the NBMA subnetwork and these\
    \ other subnetworks.\n     In all cases, routing information is exchanged using\
    \ conventional\n     intra-domain and/or inter-domain routing protocols.\n"
- title: 5. NHRP Packet Formats
  contents:
  - "5. NHRP Packet Formats\n   This section describes the format of NHRP packets.\
    \  In the following,\n   unless otherwise stated explicitly, the unqualified term\
    \ \"request\"\n   refers generically to any of the NHRP packet types which are\n\
    \   \"requests\".  Further, unless otherwise stated explicitly, the\n   unqualified\
    \ term \"reply\" refers generically to any of the NHRP packet\n   types which\
    \ are \"replies\".\n   An NHRP packet consists of a Fixed Part, a Mandatory Part,\
    \ and an\n   Extensions Part.  The Fixed Part is common to all NHRP packet types.\n\
    \   The Mandatory Part MUST be present, but varies depending on packet\n   type.\
    \  The Extensions Part also varies depending on packet type, and\n   need not\
    \ be present.\n   The length of the Fixed Part is fixed at 20 octets.  The length\
    \ of\n   the Mandatory Part is determined by the contents of the extensions\n\
    \   offset field (ar$extoff).  If ar$extoff=0x0 then the mandatory part\n   length\
    \ is equal to total packet length (ar$pktsz) minus 20 otherwise\n   the mandatory\
    \ part length is equal to ar$extoff minus 20.  The length\n   of the Extensions\
    \ Part is implied by ar$pktsz minus ar$extoff.  NHSs\n   may increase the size\
    \ of an NHRP packet as a result of extension\n   processing, but not beyond the\
    \ offered maximum packet size of the\n   NBMA network.\n   NHRP packets are actually\
    \ members of a wider class of address mapping\n   and management protocols being\
    \ developed by the IETF. A specific\n   encapsulation, based on the native formats\
    \ used on the particular\n   NBMA network over which NHRP is carried, indicates\
    \ the generic IETF\n   mapping and management protocol. For example, SMDS networks\
    \ always\n   use LLC/SNAP encapsulation at the NBMA layer [4], and an NHRP packet\n\
    \   is preceded by the following LLC/SNAP encapsulation:\n   [0xAA-AA-03] [0x00-00-5E]\
    \ [0x00-03]\n   The first three octets are LLC, indicating that SNAP follows.\
    \  The\n   SNAP OUI portion is the IANA's OUI, and the SNAP PID portion\n   identifies\
    \ the mapping and management protocol. A field in the Fixed\n   Header following\
    \ the encapsulation indicates that it is NHRP.\n   ATM uses either LLC/SNAP encapsulation\
    \ of each packet (including\n   NHRP), or uses no encapsulation on VCs dedicated\
    \ to a single protocol\n   (see [7]).  Frame Relay and X.25 both use NLPID/SNAP\
    \ encapsulation or\n   identification of NHRP, using a NLPID of 0x0080 and the\
    \ same SNAP\n   contents as above (see [8], [9]).\n   Fields marked \"unused\"\
    \ MUST be set to zero on transmission, and\n   ignored on receipt.\n   Most packet\
    \ types (ar$op.type) have both internetwork layer\n   protocol-independent fields\
    \ and protocol-specific fields. The\n   protocol type/snap fields (ar$pro.type/snap)\
    \ qualify the format of\n   the protocol-specific fields.\n"
- title: 5.1 NHRP Fixed Header
  contents:
  - "5.1 NHRP Fixed Header\n   The Fixed Part of the NHRP packet contains those elements\
    \ of the NHRP\n   packet which are always present and do not vary in size with\
    \ the type\n   of packet.\n    0                   1                   2     \
    \              3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            ar$afn             |          ar$pro.type          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          ar$pro.snap                          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  ar$pro.snap  |   ar$hopcnt   |            ar$pktsz           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |           ar$chksum           |            ar$extoff          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | ar$op.version |   ar$op.type  |    ar$shtl    |    ar$sstl    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   ar$afn\n     Defines the type of \"link layer\" addresses being carried. \
    \ This\n     number is taken from the 'address family number' list specified in\n\
    \     [6].  This field has implications to the coding of ar$shtl and\n     ar$sstl\
    \ as described below.\n   ar$pro.type\n     field is a 16 bit unsigned integer\
    \ representing the following\n     number space:\n       0x0000 to 0x00FF  Protocols\
    \ defined by the equivalent NLPIDs.\n       0x0100 to 0x03FF  Reserved for future\
    \ use by the IETF.\n       0x0400 to 0x04FF  Allocated for use by the ATM Forum.\n\
    \       0x0500 to 0x05FF  Experimental/Local use.\n       0x0600 to 0xFFFF  Protocols\
    \ defined by the equivalent Ethertypes.\n     (based on the observations that\
    \ valid Ethertypes are never smaller\n     than 0x600, and NLPIDs never larger\
    \ than 0xFF.)\n   ar$pro.snap\n     When ar$pro.type has a value of 0x0080, a\
    \ SNAP encoded extension is\n     being used to encode the protocol type. This\
    \ snap extension is\n     placed in the ar$pro.snap field.  This is termed the\
    \ 'long form'\n     protocol ID. If ar$pro != 0x0080 then the ar$pro.snap field\
    \ MUST be\n     zero on transmit and ignored on receive. The ar$pro.type field\n\
    \     itself identifies the protocol being referred to. This is termed\n     the\
    \ 'short form' protocol ID.\n     In all cases, where a protocol has an assigned\
    \ number in the\n     ar$pro.type space (excluding 0x0080) the short form MUST\
    \ be used\n     when transmitting NHRP messages; i.e., if Ethertype or NLPID\n\
    \     codings exist then they are used on transmit rather than the\n     ethertype.\
    \   If both Ethertype and NLPID codings exist then when\n     transmitting NHRP\
    \ messages, the Ethertype coding MUST be used (this\n     is consistent with RFC\
    \ 1483 coding).  So, for example, the\n     following codings exist for IP:\n\
    \       SNAP:      ar$pro.type = 0x00-80, ar$pro.snap = 0x00-00-00-08-00\n   \
    \    NLPID:     ar$pro.type = 0x00-CC, ar$pro.snap = 0x00-00-00-00-00\n      \
    \ Ethertype: ar$pro.type = 0x08-00, ar$pro.snap = 0x00-00-00-00-00\n     and thus,\
    \ since the Ethertype coding exists, it is used in\n     preference.\n   ar$hopcnt\n\
    \     The Hop count indicates the maximum number of NHSs that an NHRP\n     packet\
    \ is allowed to traverse before being discarded.  This field\n     is used in\
    \ a similar fashion to the way that a TTL is used in an IP\n     packet and should\
    \ be set accordingly.  Each NHS decrements the TTL\n     as the NHRP packet transits\
    \ the NHS on the way to the next hop\n     along the routed path to the destination.\
    \  If an NHS receives an\n     NHRP packet which it would normally forward to\
    \ a next hop and that\n     packet contains an ar$hopcnt set to zero then the\
    \ NHS sends an\n     error indication message back to the source protocol address\n\
    \     stating that the hop count has been exceeded (see Section 5.2.7)\n     and\
    \ the NHS drops the packet in error;  however, an error\n     indication is never\
    \ sent as a result of receiving an error\n     indication.  When a responding\
    \ NHS replies to an NHRP request, that\n     NHS places a value in ar$hopcnt as\
    \ if it were sending a request of\n     its own.\n   ar$pktsz\n     The total\
    \ length of the NHRP packet, in octets (excluding link\n     layer encapsulation).\n\
    \   ar$chksum\n     The standard IP checksum over the entire NHRP packet starting\
    \ at\n     the fixed header.  If the packet is an odd number of bytes in\n   \
    \  length then this calculation is performed as if a byte set to 0x00\n     is\
    \ appended to the end of the packet.\n   ar$extoff\n     This field identifies\
    \ the existence and location of NHRP\n     extensions.  If this field is 0 then\
    \ no extensions exist otherwise\n     this field represents the offset from the\
    \ beginning of the NHRP\n     packet (i.e., starting from the ar$afn field) of\
    \ the first\n     extension.\n   ar$op.version\n     This field indicates what\
    \ version of generic address mapping and\n     management protocol is represented\
    \ by this message.\n       0               MARS protocol [11].\n       1     \
    \          NHRP as defined in this document.\n       0x02 - 0xEF     Reserved\
    \ for future use by the IETF.\n       0xF0 - 0xFE     Allocated for use by the\
    \ ATM Forum.\n       0xFF            Experimental/Local use.\n   ar$op.type\n\
    \     When ar$op.version == 1, this is the NHRP packet type: NHRP\n     Resolution\
    \ Request(1), NHRP Resolution Reply(2), NHRP Registration\n     Request(3), NHRP\
    \ Registration Reply(4), NHRP Purge Request(5), NHRP\n     Purge Reply(6), or\
    \ NHRP Error Indication(7).  Use of NHRP packet\n     Types in the range 128 to\
    \ 255 are reserved for research or use in\n     other protocol development and\
    \ will be administered by IANA as\n     described in Section 9.\n   ar$shtl\n\
    \     Type & length of source NBMA address interpreted in the context of\n   \
    \  the 'address family number'[6] indicated by ar$afn.  See below for\n     more\
    \ details.\n   ar$sstl\n     Type & length of source NBMA subaddress interpreted\
    \ in the context\n     of the 'address family number'[6] indicated by ar$afn.\
    \  When an\n     NBMA technology has no concept of a subaddress, the subaddress\n\
    \     length is always coded ar$sstl = 0 and no storage is allocated for\n   \
    \  the subaddress in the appropriate mandatory part.  See below for\n     more\
    \ details.\n   Subnetwork layer address type/length fields (e.g., ar$shtl, Cli\
    \ Addr\n   T/L) and subnetwork layer subaddresses type/length fields (e.g.,\n\
    \   ar$sstl, Cli SAddr T/L) are coded as follows:\n    7 6 5 4 3 2 1 0\n   +-+-+-+-+-+-+-+-+\n\
    \   |0|x|  length   |\n   +-+-+-+-+-+-+-+-+\n   The most significant bit is reserved\
    \ and MUST be set to zero. The\n   second most significant bit (x) is a flag indicating\
    \ whether the\n   address being referred to is in:\n      - NSAP format (x = 0).\n\
    \      - Native E.164 format (x = 1).\n   For NBMA technologies that use neither\
    \ NSAP nor E.164 format\n   addresses, x = 0 SHALL be used to indicate the native\
    \ form for the\n   particular NBMA technology.\n   If the NBMA network is ATM\
    \ and a subaddress (e.g., Source NBMA\n   SubAddress, Client NBMA SubAddress)\
    \ is to be included in any part of\n   the NHRP packet then ar$afn MUST be set\
    \ to 0x000F; further, the\n   subnetwork layer address type/length fields (e.g.,\
    \ ar$shtl, Cli Addr\n   T/L) and subnetwork layer subaddress type/length fields\
    \ (e.g.,\n   ar$sstl, Cli SAddr T/L) MUST be coded as in [11].  If the NBMA\n\
    \   network is ATM and no subaddress field is to be included in any part\n   of\
    \ the NHRP packet then ar$afn MAY be set to 0x0003 (NSAP) or 0x0008\n   (E.164)\
    \ accordingly.\n   The bottom 6 bits is an unsigned integer value indicating the\
    \ length\n   of the associated NBMA address in octets. If this value is zero the\n\
    \   flag x is ignored.\n"
- title: 5.2.0 Mandatory Part
  contents:
  - "5.2.0 Mandatory Part\n   The Mandatory Part of the NHRP packet contains the operation\
    \ specific\n   information (e.g., NHRP Resolution Request/Reply, etc.) and variable\n\
    \   length data which is pertinent to the packet type.\n"
- title: 5.2.0.1 Mandatory Part Format
  contents:
  - "5.2.0.1 Mandatory Part Format\n   Sections 5.2.1 through 5.2.6 have a very similar\
    \ mandatory part.\n   This mandatory part includes a common header and zero or\
    \ more Client\n   Information Entries (CIEs). Section 5.2.7 has a different format\n\
    \   which is specified in that section.\n   The common header looks like the following:\n\
    \    0                   1                   2                   3\n    0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | Src Proto Len | Dst Proto Len |           Flags               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                         Request ID                            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Source NBMA Address (variable length)              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Source NBMA Subaddress (variable length)             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Source Protocol Address (variable length)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |       Destination  Protocol Address (variable length)         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   And the CIEs have the following format:\n    0                   1       \
    \            2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Code       | Prefix Length |         unused                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Maximum Transmission Unit    |        Holding Time           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Cli Addr T/L | Cli SAddr T/L | Cli Proto Len |  Preference   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Client NBMA Address (variable length)              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |           Client NBMA Subaddress (variable length)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Client Protocol Address (variable length)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                        .....................\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Code       | Prefix Length |         unused                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Maximum Transmission Unit    |        Holding Time           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Cli Addr T/L | Cli SAddr T/L | Cli Proto Len |  Preference   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Client NBMA Address (variable length)              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |           Client NBMA Subaddress (variable length)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Client Protocol Address (variable length)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The meanings of the fields are as follows:\n   Src Proto Len\n     This field\
    \ holds the length in octets of the Source Protocol\n     Address.\n   Dst Proto\
    \ Len\n     This field holds the length in octets of the Destination Protocol\n\
    \     Address.\n   Flags\n     These flags are specific to the given message type\
    \ and they are\n     explained in each section.\n   Request ID\n     A value which,\
    \ when coupled with the address of the source,\n     provides a unique identifier\
    \ for the information contained in a\n     \"request\" packet.  This value is\
    \ copied directly from an \"request\"\n     packet into the associated \"reply\"\
    .  When a sender of a \"request\"\n     receives \"reply\", it will compare the\
    \ Request ID and source address\n     information in the received \"reply\" against\
    \ that found in its\n     outstanding \"request\" list.  When a match is found\
    \ then the\n     \"request\" is considered to be acknowledged.\n     The value\
    \ is taken from a 32 bit counter that is incremented each\n     time a new \"\
    request\" is transmitted.  The same value MUST be used\n     when resending a\
    \ \"request\", i.e., when a \"reply\" has not been\n     received for a \"request\"\
    \ and a retry is sent after an appropriate\n     interval.\n     It is RECOMMENDED\
    \ that the initial value for this number be 0.  A\n     node MAY reuse a sequence\
    \ number if and only if the reuse of the\n     sequence number is not precluded\
    \ by use of a particular method of\n     synchronization (e.g., as described in\
    \ Appendix A).\n   The NBMA address/subaddress form specified below allows combined\n\
    \   E.164/NSAPA form of NBMA addressing. For NBMA technologies without a\n   subaddress\
    \ concept, the subaddress field is always ZERO length and\n   ar$sstl = 0.\n \
    \  Source NBMA Address\n     The Source NBMA address field is the address of the\
    \ source station\n     which is sending the \"request\". If the field's length\
    \ as specified\n     in ar$shtl is 0 then no storage is allocated for this address\
    \ at\n     all.\n   Source NBMA SubAddress\n     The Source NBMA subaddress field\
    \ is the address of the source\n     station which is sending the \"request\"\
    .  If the field's length as\n     specified in ar$sstl is 0 then no storage is\
    \ allocated for this\n     address at all.\n   For those NBMA technologies which\
    \ have a notion of \"Calling Party\n   Addresses\", the Source NBMA Addresses\
    \ above are the addresses used\n   when signaling for an SVC.\n   \"Requests\"\
    \ and \"indications\" follow the routed path from Source\n   Protocol Address\
    \ to the Destination Protocol Address. \"Replies\", on\n   the other hand, follow\
    \ the routed path from the Destination Protocol\n   Address back to the Source\
    \ Protocol Address with the following\n   exceptions: in the case of a NHRP Registration\
    \ Reply and in the case\n   of an NHC initiated NHRP Purge Request, the packet\
    \ is always returned\n   via a direct VC (see Sections 5.2.4 and 5.2.5).\n   Source\
    \ Protocol Address\n     This is the protocol address of the station which is\
    \ sending the\n     \"request\".  This is also the protocol address of the station\
    \ toward\n     which a \"reply\" packet is sent.\n   Destination Protocol Address\n\
    \     This is the protocol address of the station toward which a\n     \"request\"\
    \ packet is sent.\n   Code\n     This field is message specific.  See the relevant\
    \ message sections\n     below.  In general, this field is a NAK code; i.e., when\
    \ the field\n     is 0 in a reply then the packet is acknowledging a request and\
    \ if\n     it contains any other value the packet contains a negative\n     acknowledgment.\n\
    \   Prefix Length\n     This field is message specific.  See the relevant message\
    \ sections\n     below.  In general, however, this fields is used to indicate\
    \ that\n     the information carried in an NHRP message pertains to an\n     equivalence\
    \ class of internetwork layer addresses rather than just\n     a single internetwork\
    \ layer address specified. All internetwork\n     layer addresses that match the\
    \ first \"Prefix Length\" bit positions\n     for the specific internetwork layer\
    \ address are included in the\n     equivalence class.  If this field is set to\
    \ 0x00 then this field\n     MUST be ignored and no equivalence information is\
    \ assumed (note\n     that 0x00 is thus equivalent to 0xFF).\n   Maximum Transmission\
    \ Unit\n     This field gives the maximum transmission unit for the relevant\n\
    \     client station.  If this value is 0 then either the default MTU is\n   \
    \  used or the MTU negotiated via signaling is used if such\n     negotiation\
    \ is possible for the given NBMA.\n   Holding Time\n     The Holding Time field\
    \ specifies the number of seconds for which\n     the Next Hop NBMA information\
    \ specified in the CIE is considered to\n     be valid.  Cached information SHALL\
    \ be discarded when the holding\n     time expires.  This field must be set to\
    \ 0 on a NAK.\n   Cli Addr T/L\n     Type & length of next hop NBMA address specified\
    \ in the CIE.  This\n     field is interpreted in the context of the 'address\
    \ family\n     number'[6] indicated by ar$afn (e.g., ar$afn=0x0003 for ATM).\n\
    \   Cli SAddr T/L\n     Type & length of next hop NBMA subaddress specified in\
    \ the CIE.\n     This field is interpreted in the context of the 'address family\n\
    \     number'[6] indicated by ar$afn (e.g., ar$afn=0x0015 for ATM makes\n    \
    \ the address an E.164 and the subaddress an ATM Forum NSAP address).\n     When\
    \ an NBMA technology has no concept of a subaddress, the\n     subaddress is always\
    \ null with a length of 0.  When the address\n     length is specified as 0 no\
    \ storage is allocated for the address.\n   Cli Proto Len\n     This field holds\
    \ the length in octets of the Client Protocol\n     Address specified in the CIE.\n\
    \   Preference\n     This field specifies the preference for use of the specific\
    \ CIE\n     relative to other CIEs.  Higher values indicate higher preference.\n\
    \     Action taken when multiple CIEs have equal or highest preference\n     value\
    \ is a local matter.\n   Client NBMA Address\n     This is the client's NBMA address.\n\
    \   Client NBMA SubAddress\n     This is the client's NBMA subaddress.\n   Client\
    \ Protocol Address\n     This is the client's internetworking layer address specified.\n\
    \   Note that an NHS may cache source address binding information from an\n  \
    \ NHRP Resolution Request if and only if the conditions described in\n   Section\
    \ 6.2 are met for the NHS.  In all other cases, source address\n   binding information\
    \ appearing in an NHRP message MUST NOT be cached.\n"
- title: 5.2.1 NHRP Resolution Request
  contents:
  - "5.2.1 NHRP Resolution Request\n   The NHRP Resolution Request packet has a Type\
    \ code of 1. Its\n   mandatory part is coded as described in Section 5.2.0.1 and\
    \ the\n   message specific meanings of the fields are as follows:\n   Flags -\
    \ The flags field is coded as follows:\n      0                   1\n      0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |Q|A|D|U|S|\
    \       unused        |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     Q\n    \
    \   Set if the station sending the NHRP Resolution Request is a\n       router;\
    \ clear if the it is a host.\n     A\n       This bit is set in a NHRP Resolution\
    \ Request if only\n       authoritative next hop information is desired and is\
    \ clear\n       otherwise.  See the NHRP Resolution Reply section below for\n\
    \       further details on the \"A\" bit and its usage.\n     D\n       Unused\
    \ (clear on transmit)\n     U\n       This is the Uniqueness bit. This bit aids\
    \ in duplicate address\n       detection.  When this bit is set in an NHRP Resolution\
    \ Request\n       and one or more entries exist in the NHS cache which meet the\n\
    \       requirements of the NHRP Resolution Request then only the CIE in\n   \
    \    the NHS's cache with this bit set will be returned.  Note that\n       even\
    \ if this bit was set at registration time, there may still be\n       multiple\
    \ CIEs that might fulfill the NHRP Resolution Request\n       because an entire\
    \ subnet can be registered through use of the\n       Prefix Length in the CIE\
    \ and the address of interest might be\n       within such a subnet. If the \"\
    uniqueness\" bit is set and the\n       responding NHS has one or more cache entries\
    \ which match the\n       request but no such cache entry has the \"uniqueness\"\
    \ bit set,\n       then the NHRP Resolution Reply returns with a NAK code of \"\
    13 -\n       Binding Exists But Is Not Unique\" and no CIE is included.  If a\n\
    \       client wishes  to  receive  non- unique  Next  Hop Entries, then\n   \
    \    the client must have the \"uniqueness\" bit set to zero in its NHRP\n   \
    \    Resolution Request. Note that when this bit is set in an NHRP\n       Registration\
    \ Request, only a single CIE may be specified in the\n       NHRP Registration\
    \ Request and that CIE must have the Prefix\n       Length field set to 0xFF.\n\
    \     S\n       Set if the binding between the Source Protocol Address and the\n\
    \       Source NBMA information in the NHRP Resolution Request is\n       guaranteed\
    \ to be stable and accurate (e.g., these addresses are\n       those of an ingress\
    \ router which is connected to an ethernet stub\n       network or the NHC is\
    \ an NBMA attached host).\n   Zero or one CIEs (see Section 5.2.0.1) may be specified\
    \ in an NHRP\n   Resolution Request.  If one is specified then that entry carries\
    \ the\n   pertinent information for the client sourcing the NHRP Resolution\n\
    \   Request.  Usage of the CIE in the NHRP Resolution Request is\n   described\
    \ below:\n     Prefix Length\n       If a CIE is specified in the NHRP Resolution\
    \ Request then the\n       Prefix Length field may be used to qualify the widest\
    \ acceptable\n       prefix which may be used to satisfy the NHRP Resolution Request.\n\
    \       In the case of NHRP Resolution Request/Reply, the Prefix Length\n    \
    \   specifies the equivalence class of addresses which match the\n       first\
    \ \"Prefix Length\" bit positions of the Destination Protocol\n       Address.\
    \  If the \"U\" bit is set in the common header then this\n       field MUST be\
    \ set to 0xFF.\n     Maximum Transmission Unit\n       This field gives the maximum\
    \ transmission unit for the source\n       station.  A possible use of this field\
    \ in the NHRP Resolution\n       Request packet is for the NHRP Resolution Requester\
    \ to ask for a\n       target MTU.\n     Holding Time\n       The Holding Time\
    \ specified in the one CIE permitted to be\n       included in an NHRP Resolution\
    \ Request is the amount of time\n       which the source address binding information\
    \ in the NHRP\n       Resolution Request is permitted to cached by transit and\n\
    \       responding NHSs.  Note that this field may only have a non-zero\n    \
    \   value if the S bit is set.\n     All other fields in the CIE MUST be ignored\
    \ and SHOULD be set to 0.\n   The Destination Protocol Address in the common header\
    \ of the\n   Mandatory Part of this message contains the protocol address of the\n\
    \   station for which resolution is desired.  An NHC MUST send the NHRP\n   Resolution\
    \ Request directly to one of its serving NHSs (see Section 3\n   for more information).\n"
- title: 5.2.2 NHRP Resolution Reply
  contents:
  - "5.2.2 NHRP Resolution Reply\n   The NHRP Resolution Reply packet has a Type code\
    \ of 2. CIEs\n   correspond to Next Hop Entries in an NHS's cache which match\
    \ the\n   criteria in the NHRP Resolution Request.  Its mandatory part is coded\n\
    \   as described in Section 5.2.0.1.  The message specific meanings of\n   the\
    \ fields are as follows:\n   Flags - The flags field is coded as follows:\n  \
    \    0                   1\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |Q|A|D|U|S|       unused        |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     Q\n       Copied from the NHRP Resolution Request.  Set if the NHRP\n  \
    \     Resolution Requester is a router;  clear if it is a host.\n     A\n    \
    \   Set if the next hop CIE in the NHRP Resolution Reply is\n       authoritative;\
    \ clear if the NHRP Resolution Reply is non-\n       authoritative.\n       When\
    \ an NHS receives a NHRP Resolution Request for authoritative\n       information\
    \ for which it is the authoritative source, it MUST\n       respond with a NHRP\
    \ Resolution Reply containing all and only\n       those next hop CIEs which are\
    \ contained in the NHS's cache which\n       both match the criteria of the NHRP\
    \ Resolution Request and are\n       authoritative cache entries.  An NHS is an\
    \ authoritative source\n       for a NHRP Resolution Request if the information\
    \ in the NHS's\n       cache matches the NHRP Resolution Request criteria and\
    \ that\n       information was obtained through a NHRP Registration Request or\n\
    \       through synchronization with an NHS which obtained this\n       information\
    \ through a NHRP Registration Request.  An\n       authoritative cache entry is\
    \ one which is obtained through a NHRP\n       Registration Request or through\
    \ synchronization with an NHS which\n       obtained this information through\
    \ a NHRP Registration Request.\n       An NHS obtains non-authoritative CIEs through\
    \ promiscuous\n       listening to NHRP packets other than NHRP Registrations\
    \ which are\n       directed at it.  A NHRP Resolution Request which indicates\
    \ a\n       request for non-authoritative information should cause a NHRP\n  \
    \     Resolution Reply which contains all entries in the replying NHS's\n    \
    \   cache (i.e., both authoritative and non-authoritative) which\n       match\
    \ the criteria specified in the request.\n     D\n       Set if the association\
    \ between destination and the associate next\n       hop information included\
    \ in all CIEs of the NHRP Resolution Reply\n       is guaranteed to be stable\
    \ for the lifetime of the information\n       (the holding time).  This is the\
    \ case if the Next Hop protocol\n       address in a CIE identifies the destination\
    \ (though it may be\n       different in value than the Destination address if\
    \ the\n       destination system has multiple addresses) or if the destination\n\
    \       is not connected directly to the NBMA subnetwork but the egress\n    \
    \   router to that destination is guaranteed to be stable (such as\n       when\
    \ the destination is immediately adjacent to the egress router\n       through\
    \ a non-NBMA interface).\n     U\n       This is the Uniqueness bit. See the NHRP\
    \ Resolution Request\n       section above for details.  When this bit is set,\
    \ only one CIE is\n       included since only one unique binding should exist\
    \ in an NHS's\n       cache.\n     S\n       Copied from NHRP Resolution Request\
    \ message.\n   One or more CIEs are specified in the NHRP Resolution Reply. Each\
    \ CIE\n   contains NHRP next hop information which the responding NHS has\n  \
    \ cached and which matches the parameters specified in the NHRP\n   Resolution\
    \ Request.  If no match is found by the NHS issuing the NHRP\n   Resolution Reply\
    \ then a single CIE is enclosed with the a CIE Code\n   set appropriately (see\
    \ below) and all other fields MUST be ignored\n   and SHOULD be set to 0.  In\
    \ order to facilitate the use of NHRP by\n   minimal client implementations, the\
    \ first CIE MUST contain the next\n   hop with the highest preference value so\
    \ that such an implementation\n   need parse only a single CIE.\n     Code\n \
    \      If this field is set to zero then this packet contains a\n       positively\
    \ acknowledged NHRP Resolution Reply.  If this field\n       contains any other\
    \ value then this message contains an NHRP\n       Resolution Reply NAK which\
    \ means that an appropriate\n       internetworking layer to NBMA address binding\
    \ was not available\n       in the responding NHS's cache.  If NHRP Resolution\
    \ Reply contains\n       a Client Information Entry with a NAK Code other than\
    \ 0 then it\n       MUST NOT contain any other CIE.  Currently defined NAK Codes\
    \ are\n       as follows:\n       4 - Administratively Prohibited\n         An\
    \ NHS may refuse an NHRP Resolution Request attempt for\n         administrative\
    \ reasons (due to policy constraints or routing\n         state).  If so, the\
    \ NHS MUST send an NHRP Resolution Reply\n         which contains a NAK code of\
    \ 4.\n       5 - Insufficient Resources\n         If an NHS cannot serve a station\
    \ due to a lack of resources\n         (e.g., can't store sufficient information\
    \ to send a purge if\n         routing changes), the NHS MUST reply with a NAKed\
    \ NHRP\n         Resolution Reply which contains a NAK code of 5.\n       12 -\
    \ No Internetworking Layer Address to NBMA Address Binding\n            Exists\n\
    \         This code states that there were absolutely no internetworking\n   \
    \      layer address to NBMA address bindings found in the responding\n      \
    \   NHS's cache.\n       13 - Binding Exists But Is Not Unique\n         This\
    \ code states that there were one or more internetworking\n         layer address\
    \ to NBMA address bindings found in the responding\n         NHS's cache, however\
    \ none of them had the uniqueness bit set.\n     Prefix Length\n       In the\
    \ case of NHRP Resolution Reply, the Prefix Length specifies\n       the equivalence\
    \ class of addresses which match the first \"Prefix\n       Length\" bit positions\
    \ of the Destination Protocol Address.\n     Holding Time\n       The Holding\
    \ Time specified in a CIE of an NHRP Resolution Reply\n       is the amount of\
    \ time remaining before the expiration of the\n       client information which\
    \ is cached at the replying NHS.  It is\n       not the value which was registered\
    \ by the client.\n     The remainder of the fields for the CIE for each next hop\
    \ are\n     filled out as they were defined when the next hop was registered\n\
    \     with the responding NHS (or one of the responding NHS's\n     synchronized\
    \ servers) via the NHRP Registration Request.\n   Load-splitting may be performed\
    \ when more than one Client Information\n   Entry is returned to a requester when\
    \ equal preference values are\n   specified.  Also, the alternative addresses\
    \ may be used in case of\n   connectivity failure in the NBMA subnetwork (such\
    \ as a failed call\n   attempt in connection-oriented NBMA subnetworks).\n   Any\
    \ extensions present in the NHRP Resolution Request packet MUST be\n   present\
    \ in the NHRP Resolution Reply even if the extension is non-\n   Compulsory.\n\
    \   If an unsolicited NHRP Resolution Reply packet is received, an Error\n   Indication\
    \ of type Invalid NHRP Resolution Reply Received SHOULD be\n   sent in response.\n\
    \   When an NHS that serves a given NHC receives an NHRP Resolution Reply\n  \
    \ destined for that NHC then the NHS must MUST send the NHRP Resolution\n   Reply\
    \ directly to the NHC (see Section 3).\n"
- title: 5.2.3 NHRP Registration Request
  contents:
  - "5.2.3 NHRP Registration Request\n   The NHRP Registration Request is sent from\
    \ a station to an NHS to\n   notify the NHS of the station's NBMA information.\
    \  It has a Type code\n   of 3. Each CIE corresponds to Next Hop information which\
    \ is to be\n   cached at an NHS.  The mandatory part of an NHRP Registration Request\n\
    \   is coded as described in Section 5.2.0.1.  The message specific\n   meanings\
    \ of the fields are as follows:\n   Flags - The flags field is coded as follows:\n\
    \      0                   1\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |U|         unused              |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     U\n       This is the Uniqueness bit. When set in an NHRP Registration\n\
    \       Request, this bit indicates that the registration of the protocol\n  \
    \     address is unique within the confines of the set of synchronized\n     \
    \  NHSs.  This \"uniqueness\" qualifier MUST be stored in the NHS/NHC\n      \
    \ cache.  Any attempt to register a binding between the protocol\n       address\
    \ and an NBMA address when this bit is set MUST be rejected\n       with a Code\
    \ of \"14 - Unique Internetworking Layer Address Already\n       Registered\"\
    \ if the replying NHS already has a cache entry for the\n       protocol address\
    \ and the cache entry has the \"uniqueness\" bit\n       set.  A registration\
    \ of a CIE's information is rejected when the\n       CIE is returned with the\
    \ Code field set to anything other than\n       0x00.  See the description of\
    \ the uniqueness bit in NHRP\n       Resolution Request section above for further\
    \ details.  When this\n       bit is set only, only one CIE MAY be included in\
    \ the NHRP\n       Registration Request.\n   Request ID\n     The request ID has\
    \ the same meaning as described in Section\n     5.2.0.1.  However, the request\
    \ ID for NHRP Registrations which is\n     maintained at each client MUST be kept\
    \ in non-volatile memory so\n     that when a client crashes and reregisters there\
    \ will be no\n     inconsistency in the NHS's database.  In order to reduce the\n\
    \     overhead associated with updating non-volatile memory, the actual\n    \
    \ updating need not be done with every increment of the Request ID\n     but could\
    \ be done, for example, every 50 or 100 increments.  In\n     this scenario, when\
    \ a client crashes and reregisters it knows to\n     add 100 to the value of the\
    \ Request ID in the non-volatile memory\n     before using the Request ID for\
    \ subsequent registrations.\n   One or more CIEs are specified in the NHRP Registration\
    \ Request.\n   Each CIE contains next hop information which a client is attempting\n\
    \   to register with its servers.  Generally, all fields in CIEs enclosed\n  \
    \ in NHRP Registration Requests are coded as described in Section\n   5.2.0.1.\
    \  However, if a station is only registering itself with the\n   NHRP Registration\
    \ Request then it MAY code the Cli Addr T/L, Cli\n   SAddr T/L, and Cli Proto\
    \ Len as zero which signifies that the client\n   address information is to be\
    \ taken from the source information in the\n   common header (see Section 5.2.0.1).\
    \  Below, further clarification is\n   given for some fields in a CIE in the context\
    \ of a NHRP Registration\n   Request.\n     Code\n       This field is set to\
    \ 0x00 in NHRP Registration Requests.\n     Prefix Length\n       This field may\
    \ be used in a NHRP Registration Request to register\n       equivalence information\
    \ for the Client Protocol Address specified\n       in the CIE of an NHRP Registration\
    \ Request In the case of NHRP\n       Registration Request, the Prefix Length\
    \ specifies the equivalence\n       class of addresses which match the first \"\
    Prefix Length\" bit\n       positions of the Client Protocol Address.  If the\
    \ \"U\" bit is set\n       in the common header then this field MUST be set to\
    \ 0xFF.\n   The NHRP Registration Request is used to register an NHC's NHRP\n\
    \   information with its NHSs.  If an NHC is configured with the protocol\n  \
    \ address of a serving NHS then the NHC may place the NHS's protocol\n   address\
    \ in the Destination Protocol Address field of the NHRP\n   Registration Request\
    \ common header otherwise the NHC must place its\n   own protocol address in the\
    \ Destination Protocol Address field.\n   When an NHS receives an NHRP Registration\
    \ Request which has the\n   Destination Protocol Address field set to an address\
    \ which belongs to\n   a LIS/LAG for which the NHS is serving then if the Destination\n\
    \   Protocol Address field is equal to the Source Protocol Address field\n   (which\
    \ would happen if the NHC put its protocol address in the\n   Destination Protocol\
    \ Address) or the Destination Protocol Address\n   field is equal to the protocol\
    \ address of the NHS then the NHS\n   processes the NHRP Registration Request\
    \ after doing appropriate error\n   checking (including any applicable policy\
    \ checking).\n   When an NHS receives an NHRP Registration Request which has the\n\
    \   Destination Protocol Address field set to an address which does not\n   belong\
    \ to a LIS/LAG for which the NHS is serving then the NHS\n   forwards the packet\
    \ down the routed path toward the appropriate\n   LIS/LAG.\n   When an NHS receives\
    \ an NHRP Registration Request which has the\n   Destination Protocol Address\
    \ field set to an address which belongs to\n   a LIS/LAG for which the NHS is\
    \ serving then if the Destination\n   Protocol Address field does not equal the\
    \ Source Protocol Address\n   field and the Destination Protocol Address field\
    \ does not equal the\n   protocol address of the NHS then the NHS forwards the\
    \ message to the\n   appropriate NHS within the LIS/LAG as specified by Destination\n\
    \   Protocol Address field.\n   It is possible that a misconfigured station will\
    \ attempt to register\n   with the wrong NHS (i.e., one that cannot serve it due\
    \ to policy\n   constraints or routing state).  If this is the case, the NHS MUST\n\
    \   reply with a NAK-ed Registration Reply of type Can't Serve This\n   Address.\n\
    \   If an NHS cannot serve a station due to a lack of resources, the NHS\n   MUST\
    \ reply with a NAK-ed Registration Reply of type Registration\n   Overflow.\n\
    \   In order to keep the registration entry from being discarded, the\n   station\
    \ MUST re-send the NHRP Registration Request packet often\n   enough to refresh\
    \ the registration, even in the face of occasional\n   packet loss. It is recommended\
    \ that the NHRP Registration Request\n   packet be sent at an interval equal to\
    \ one-third of the Holding Time\n   specified therein.\n"
- title: 5.2.4 NHRP Registration Reply
  contents:
  - "5.2.4 NHRP Registration Reply\n   The NHRP Registration Reply is sent by an NHS\
    \ to a client in response\n   to that client's NHRP Registration Request. If the\
    \ Code field of a\n   CIE in the NHRP Registration Reply has anything other than\
    \ zero in it\n   then the NHRP Registration Reply is a NAK otherwise the reply\
    \ is an\n   ACK.  The NHRP Registration Reply has a Type code of 4.\n   An NHRP\
    \ Registration Reply is formed from an NHRP Registration\n   Request by changing\
    \ the type code to 4, updating the CIE Code field,\n   and filling in the appropriate\
    \ extensions if they exist.  The message\n   specific meanings of the fields are\
    \ as follows:\n   Attempts to register the information in the CIEs of an NHRP\n\
    \   Registration Request may fail for various reasons.  If this is the\n   case\
    \ then each failed attempt to register the information in a CIE of\n   an NHRP\
    \ Registration Request is logged in the associated NHRP\n   Registration Reply\
    \ by setting the CIE Code field to the appropriate\n   error code as shown below:\n\
    \     CIE Code\n       0 - Successful Registration\n         The information in\
    \ the CIE was successfully registered with the\n         NHS.\n       4 - Administratively\
    \ Prohibited\n         An NHS may refuse an NHRP Registration Request attempt\
    \ for\n         administrative reasons (due to policy constraints or routing\n\
    \         state).  If so, the NHS MUST send an NHRP Registration Reply\n     \
    \    which contains a NAK code of 4.\n       5 - Insufficient Resources\n    \
    \     If an NHS cannot serve a station due to a lack of resources,\n         the\
    \ NHS MUST reply with a NAKed NHRP Registration Reply which\n         contains\
    \ a NAK code of 5.\n       14 - Unique Internetworking Layer Address Already Registered\n\
    \         If a client tries to register a protocol address to NBMA\n         address\
    \ binding with the uniqueness bit on and the protocol\n         address already\
    \ exists in the NHS's cache then if that cache\n         entry also has the uniqueness\
    \ bit on then this NAK Code is\n         returned in the CIE in the NHRP Registration\
    \ Reply.\n   Due to the possible existence of asymmetric routing, an NHRP\n  \
    \ Registration Reply may not be able to merely follow the routed path\n   back\
    \ to the source protocol address specified in the common header of\n   the NHRP\
    \ Registration Reply.  As a result, there MUST exist a direct\n   NBMA level connection\
    \ between the NHC and its NHS on which to send\n   the NHRP Registration Reply\
    \ before NHRP Registration Reply may be\n   returned to the NHC.  If such a connection\
    \ does not exist then the\n   NHS must setup such a connection to the NHC by using\
    \ the source NBMA\n   information supplied in the common header of the NHRP Registration\n\
    \   Request.\n"
- title: 5.2.5 NHRP Purge Request
  contents:
  - "5.2.5 NHRP Purge Request\n   The NHRP Purge Request packet is sent in order to\
    \ invalidate cached\n   information in a station.  The NHRP Purge Request packet\
    \ has a type\n   code of 5.  The mandatory part of an NHRP Purge Request is coded\
    \ as\n   described in Section 5.2.0.1.  The message specific meanings of the\n\
    \   fields are as follows:\n   Flags - The flags field is coded as follows:\n\
    \      0                   1\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |N|         unused              |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     N\n       When set, this bit tells the receiver of the NHRP Purge Request\n\
    \       that the requester does not expect to receive an NHRP Purge\n       Reply.\
    \  If an unsolicited NHRP Purge Reply is received by a\n       station where that\
    \ station is identified in the Source Protocol\n       Address of the packet then\
    \ that packet must be ignored.\n   One or more CIEs are specified in the NHRP\
    \ Purge Request.  Each CIE\n   contains next hop information which is to be purged\
    \ from an NHS/NHC\n   cache.  Generally, all fields in CIEs enclosed in NHRP Purge\
    \ Requests\n   are coded as described in Section 5.2.0.1.  Below, further\n  \
    \ clarification is given for some fields in a CIE in the context of a\n   NHRP\
    \ Purge Request.\n     Code\n       This field is set to 0x00 in NHRP Purge Requests.\n\
    \     Prefix Length\n       In the case of NHRP Purge Requests, the Prefix Length\
    \ specifies\n       the equivalence class of addresses which match the first \"\
    Prefix\n       Length\" bit positions of the Client Protocol Address specified\
    \ in\n       the CIE.  All next hop information which contains a protocol\n  \
    \     address which matches an element of this equivalence class is to\n     \
    \  be purged from the receivers cache.\n     The Maximum Transmission Unit and\
    \ Preference fields of the CIE are\n     coded as zero.  The Holding Time should\
    \ be coded as zero but there\n     may be some utility in supplying a \"short\"\
    \ holding time to be\n     applied to the matching next hop information before\
    \ that\n     information would be purged; this usage is for further study. The\n\
    \     Client Protocol Address field and the Cli Proto Len field MUST be\n    \
    \ filled in.  The Client Protocol Address is filled in with the\n     protocol\
    \ address to be purged from the receiving station's cache\n     while the Cli\
    \ Proto Len is set the length of the purged client's\n     protocol address. \
    \ All remaining fields in the CIE MAY be set to\n     zero although the client\
    \ NBMA information (and associated length\n     fields) MAY be specified to narrow\
    \ the scope of the NHRP Purge\n     Request if requester desires.  However, the\
    \ receiver of an NHRP\n     Purge Request may choose to ignore the Client NBMA\
    \ information if\n     it is supplied.\n   An NHRP Purge Request packet is sent\
    \ from an NHS to a station to\n   cause it to delete previously cached information.\
    \  This is done when\n   the information may be no longer valid (typically when\
    \ the NHS has\n   previously provided next hop information for a station that\
    \ is not\n   directly connected to the NBMA subnetwork, and the egress point to\n\
    \   that station may have changed).\n   An NHRP Purge Request packet may also\
    \ be sent from an NHC to an NHS\n   with which the NHC had previously registered.\
    \  This allows for an NHC\n   to invalidate its registration with NHRP before\
    \ it would otherwise\n   expire via the holding timer. If an NHC does not have\
    \ knowledge of a\n   protocol address of a serving NHS then the NHC must place\
    \ its own\n   protocol address in the Destination Protocol Address field and\n\
    \   forward the packet along the routed path.  Otherwise, the NHC must\n   place\
    \ the protocol address of a serving NHS in this field.\n   Serving NHSs may need\
    \ to send one or more new NHRP Purge Requests as\n   a result of receiving a purge\
    \ from one of their served NHCs since the\n   NHS may have previously responded\
    \ to NHRP Resolution Requests for\n   that NHC's NBMA information.  These purges\
    \ are \"new\" in that they are\n   sourced by the NHS and not the NHC;  that is,\
    \ for each NHC that\n   previously sent a NHRP Resolution Request for the purged\
    \ NHC NBMA\n   information, an NHRP Purge Request is sent which contains the Source\n\
    \   Protocol/NBMA Addresses of the NHS and the Destination Protocol\n   Address\
    \ of the NHC which previously sent an NHRP Resolution Request\n   prior to the\
    \ purge.\n   The station sending the NHRP Purge Request MAY periodically\n   retransmit\
    \ the NHRP Purge Request until either NHRP Purge Request is\n   acknowledged or\
    \ until the holding time of the information being\n   purged has expired. Retransmission\
    \ strategies for NHRP Purge Requests\n   are a local matter.\n   When a station\
    \ receives an NHRP Purge Request, it MUST discard any\n   previously cached information\
    \ that matches the information in the\n   CIEs.\n   An NHRP Purge Reply MUST be\
    \ returned for the NHRP Purge Request even\n   if the station does not have a\
    \ matching cache entry assuming that the\n   \"N\" bit is off in the NHRP Purge\
    \ Request.\n   If the station wishes to reestablish communication with the\n \
    \  destination shortly after receiving an NHRP Purge Request, it should\n   make\
    \ an authoritative NHRP Resolution Request in order to avoid any\n   stale cache\
    \ entries that might be present in intermediate NHSs (See\n   section 6.2.2.).\
    \  It is recommended that authoritative NHRP\n   Resolution Requests be made for\
    \ the duration of the holding time of\n   the old information.\n"
- title: 5.2.6 NHRP Purge Reply
  contents:
  - "5.2.6 NHRP Purge Reply\n   The NHRP Purge Reply packet is sent in order to assure\
    \ the sender of\n   an NHRP Purge Request that all cached information of the specified\n\
    \   type has been purged from the station sending the reply.  The NHRP\n   Purge\
    \ Reply has a type code of 6.\n   An NHRP Purge Reply is formed from an NHRP Purge\
    \ Request by merely\n   changing the type code in the request to 6.  The packet\
    \ is then\n   returned to the requester after filling in the appropriate extensions\n\
    \   if they exist.\n"
- title: 5.2.7  NHRP Error Indication
  contents:
  - "5.2.7  NHRP Error Indication\n   The NHRP Error Indication is used to convey\
    \ error indications to the\n   sender of an NHRP packet.  It has a type code of\
    \ 7.  The Mandatory\n   Part has the following format:\n    0                \
    \   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | Src Proto Len | Dst Proto Len |            unused             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |           Error Code          |        Error Offset           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Source NBMA Address (variable length)              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Source NBMA Subaddress (variable length)             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |          Source Protocol Address (variable length)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |       Destination  Protocol Address (variable length)         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |       Contents of NHRP Packet in error (variable length)      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Src Proto Len\n     This field holds the length in octets of the Source Protocol\n\
    \     Address.\n   Dst Proto Len\n     This field holds the length in octets of\
    \ the Destination Protocol\n     Address.\n   Error Code\n     An error code indicating\
    \ the type of error detected, chosen from\n     the following list:\n       1\
    \ - Unrecognized Extension\n         When the Compulsory bit of an extension in\
    \ NHRP packet is set,\n         the NHRP packet cannot be processed unless the\
    \ extension has\n         been processed.  The responder MUST return an NHRP Error\n\
    \         Indication of type Unrecognized Extension if it is incapable of\n  \
    \       processing the extension.  However, if a transit NHS (one which\n    \
    \     is not going to generate a reply) detects an unrecognized\n         extension,\
    \ it SHALL ignore the extension.\n       3 - NHRP Loop Detected\n         A Loop\
    \ Detected error is generated when it is determined that\n         an NHRP packet\
    \ is being forwarded in a loop.\n       6 - Protocol Address Unreachable\n   \
    \      This error occurs when a packet it moving along the routed path\n     \
    \    and it reaches a point such that the protocol address of\n         interest\
    \ is not reachable.\n       7 - Protocol Error\n         A generic packet processing\
    \ error has occurred (e.g., invalid\n         version number, invalid protocol\
    \ type, failed checksum, etc.)\n       8 - NHRP SDU Size Exceeded\n         If\
    \ the SDU size of the NHRP packet exceeds the MTU size of the\n         NBMA network\
    \ then this error is returned.\n       9 - Invalid Extension\n         If an NHS\
    \ finds an extension in a packet which is inappropriate\n         for the packet\
    \ type, an error is sent back to the sender with\n         Invalid Extension as\
    \ the code.\n       10 - Invalid NHRP Resolution Reply Received\n         If a\
    \ client receives a NHRP Resolution Reply for a Next Hop\n         Resolution\
    \ Request which it believes it did not make then an\n         error packet is\
    \ sent to the station making the reply with an\n         error code of Invalid\
    \ Reply Received.\n       11 - Authentication Failure\n         If a received\
    \ packet fails an authentication test then this\n         error is returned.\n\
    \       15 - Hop Count Exceeded\n         The hop count which was specified in\
    \ the Fixed Header of an\n         NHRP message has been exceeded.\n   Error Offset\n\
    \     The offset in octets into the original NHRP packet in which an\n     error\
    \ was detected.  This offset is calculated starting from the\n     NHRP Fixed\
    \ Header.\n   Source NBMA Address\n     The Source NBMA address field is the address\
    \ of the station which\n     observed the error.\n   Source NBMA SubAddress\n\
    \     The Source NBMA subaddress field is the address of the station\n     which\
    \ observed the error.  If the field's length as specified in\n     ar$sstl is\
    \ 0 then no storage is allocated for this address at all.\n   Source Protocol\
    \ Address\n     This is the protocol address of the station which issued the Error\n\
    \     packet.\n   Destination Protocol Address\n     This is the protocol address\
    \ of the station which sent the packet\n     which was found to be in error.\n\
    \   An NHRP Error Indication packet SHALL NEVER be generated in response\n   to\
    \ another NHRP Error Indication packet.  When an NHRP Error\n   Indication packet\
    \ is generated, the offending NHRP packet SHALL be\n   discarded.  In no case\
    \ should more than one NHRP Error Indication\n   packet be generated for a single\
    \ NHRP packet.\n   If an NHS sees its own Protocol and NBMA Addresses in the Source\
    \ NBMA\n   and Source Protocol address fields of a transiting NHRP Error\n   Indication\
    \ packet then the NHS will quietly drop the packet and do\n   nothing (this scenario\
    \ would occur when the NHRP Error Indication\n   packet was itself in a loop).\n\
    \   Note that no extensions may be added to an NHRP Error Indication.\n"
- title: 5.3  Extensions Part
  contents:
  - "5.3  Extensions Part\n   The Extensions Part, if present, carries one or more\
    \ extensions in\n   {Type, Length, Value} triplets.\n   Extensions have the following\
    \ format:\n    0                   1                   2                   3\n\
    \    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |C|u|        Type               |        Length                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                         Value...                              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   C\n     \"Compulsory.\"  If clear, and the NHS does not recognize the type\n\
    \     code, the extension may safely be ignored.  If set, and the NHS\n     does\
    \ not recognize the type code, the NHRP \"request\" is considered\n     to be\
    \ in error.  (See below for details.)\n   u\n     Unused and must be set to zero.\n\
    \   Type\n     The extension type code (see below).  The extension type is not\n\
    \     qualified by the Compulsory bit, but is orthogonal to it.\n   Length\n \
    \    The length in octets of the value (not including the Type and\n     Length\
    \ fields;  a null extension will have only an extension header\n     and a length\
    \ of zero).\n   When extensions exist, the extensions list is terminated by the\
    \ Null\n   TLV, having Type = 0 and Length = 0.\n   Extensions may occur in any\
    \ order, but any particular extension type\n   may occur only once in an NHRP\
    \ packet unless explicitly stated to the\n   contrary in the extensions definition.\
    \  For example, the vendor-\n   private extension may occur multiple times in\
    \ a packet in order to\n   allow for extensions which do not share the same vendor\
    \ ID to be\n   represented.  It is RECOMMENDED that a given vendor include no\
    \ more\n   than one Vendor Private Extension.\n   An NHS MUST NOT change the order\
    \ of extensions.  That is, the order\n   of extensions placed in an NHRP packet\
    \ by an NHC (or by an NHS when\n   an NHS sources a packet) MUST be preserved\
    \ as the packet moves\n   between NHSs.  Minimal NHC implementations MUST only\
    \ recognize, but\n   not necessarily parse, the Vendor Private extension and the\
    \ End Of\n   Extensions extension.  Extensions are only present in a \"reply\"\
    \ if\n   they were present in the corresponding \"request\" with the exception\n\
    \   of Vendor Private extensions.  The previous statement is not intended\n  \
    \ to preclude the creation of NHS-only extensions which might be added\n   to\
    \ and removed from NHRP packets by the same NHS; such extensions\n   MUST not\
    \ be propagated to NHCs.\n   The Compulsory bit provides for a means to add to\
    \ the extension set.\n   If the bit is set in an extension then the station responding\
    \ to the\n   NHRP message which contains that extension MUST be able to understand\n\
    \   the extension (in this case, the station responding to the message is\n  \
    \ the station that would issue an NHRP reply in response to a NHRP\n   request).\
    \  As a result, the responder MUST return an NHRP Error\n   Indication of type\
    \ Unrecognized Extension.  If the Compulsory bit is\n   clear then the extension\
    \ can be safely ignored; however, if an\n   ignored extension is in a \"request\"\
    \ then it MUST be returned,\n   unchanged, in the corresponding \"reply\" packet\
    \ type.\n   If a transit NHS (one which is not going to generate a \"reply\")\n\
    \   detects an unrecognized extension, it SHALL ignore the extension.  If\n  \
    \ the Compulsory bit is set, the transit NHS MUST NOT cache the\n   information\
    \ contained in the packet and MUST NOT identify itself as\n   an egress router\
    \ (in the Forward Record or Reverse Record\n   extensions).  Effectively, this\
    \ means, if a transit NHS encounters an\n   extension which it cannot process\
    \ and which has the Compulsory bit\n   set then that NHS MUST NOT participate\
    \ in any way in the protocol\n   exchange other than acting as a forwarding agent.\n\
    \   The NHRP extension Type space is subdivided to encourage use outside\n   the\
    \ IETF.\n     0x0000 - 0x0FFF         Reserved for NHRP.\n     0x1000 - 0x11FF\
    \         Allocated to the ATM Forum.\n     0x1200 - 0x37FF         Reserved for\
    \ the IETF.\n     0x3800 - 0x3FFF         Experimental use.\n   IANA will administer\
    \ the ranges reserved for the IETF as described in\n   Section 9. Values in the\
    \ 'Experimental use' range have only local\n   significance.\n"
- title: 5.3.0  The End Of Extensions
  contents:
  - "5.3.0  The End Of Extensions\n    Compulsory = 1\n    Type = 0\n    Length =\
    \ 0\n   When extensions exist, the extensions list is terminated by the End\n\
    \   Of Extensions/Null TLV.\n"
- title: 5.3.1  Responder Address Extension
  contents:
  - "5.3.1  Responder Address Extension\n    Compulsory = 1\n    Type = 3\n    Length\
    \ = variable\n   This extension is used to determine the address of the NHRP\n\
    \   responder; i.e., the entity that generates the appropriate \"reply\"\n   packet\
    \ for a given \"request\" packet.  In the case of an NHRP\n   Resolution Request,\
    \ the station responding may be different (in the\n   case of cached replies)\
    \ than the system identified in the Next Hop\n   field of the NHRP Resolution\
    \ Reply.  Further, this extension may aid\n   in detecting loops in the NHRP forwarding\
    \ path.\n   This extension uses a single CIE with the extension specific meanings\n\
    \   of the fields set as follows:\n   The Prefix Length fields MUST be set to\
    \ 0 and ignored.\n   CIE Code\n     5 - Insufficient Resources\n       If the\
    \ responder to an NHRP Resolution Request is an egress point\n       for the target\
    \ of the address resolution request (i.e., it is one\n       of the stations identified\
    \ in the list of CIEs in an NHRP\n       Resolution Reply) and the Responder Address\
    \ extension is included\n       in the NHRP Resolution Request and insufficient\
    \ resources to\n       setup a cut-through VC exist at the responder then the\
    \ Code field\n       of the Responder Address Extension is set to 5 in order to\
    \ tell\n       the client that a VC setup attempt would in all likelihood be\n\
    \       rejected; otherwise this field MUST be coded as a zero.  NHCs MAY\n  \
    \     use this field to influence whether they attempt to setup a cut-\n     \
    \  through to the egress router.\n   Maximum Transmission Unit\n     This field\
    \ gives the maximum transmission unit preferred by the\n     responder.  If this\
    \ value is 0 then either the default MTU is used\n     or the MTU negotiated via\
    \ signaling is used if such negotiation is\n     possible for the given NBMA.\n\
    \   Holding Time\n     The Holding Time field specifies the number of seconds\
    \ for which\n     the NBMA information of the responser is considered to be valid.\n\
    \     Cached information SHALL be discarded when the holding time\n     expires.\n\
    \   \"Client Address\" information is actually \"Responder Address\"\n   information\
    \ for this extension.  Thus, for example, Cli Addr T/L is\n   the responder NBMA\
    \ address type and length field.\n   If a \"requester\" desires this information,\
    \ the \"requester\" SHALL\n   include this extension with a value of zero.  Note\
    \ that this implies\n   that no storage is allocated for the Holding Time and\
    \ Type/Length\n   fields until the \"Value\" portion of the extension is filled\
    \ out.\n   If an NHS is generating a \"reply\" packet in response to a \"request\"\
    \n   containing this extension, the NHS SHALL include this extension,\n   containing\
    \ its protocol address in the \"reply\".  If an NHS has more\n   than one protocol\
    \ address, it SHALL use the same protocol address\n   consistently in all of the\
    \ Responder Address, Forward Transit NHS\n   Record, and Reverse Transit NHS Record\
    \ extensions.  The choice of\n   which of several protocol address to include\
    \ in this extension is a\n   local matter.\n   If an NHRP Resolution Reply packet\
    \ being forwarded by an NHS contains\n   a protocol address of that NHS in the\
    \ Responder Address Extension\n   then that NHS SHALL generate an NHRP Error Indication\
    \ of type \"NHRP\n   Loop Detected\" and discard the NHRP Resolution Reply.\n\
    \   If an NHRP Resolution Reply packet is being returned by an\n   intermediate\
    \ NHS based on cached data, it SHALL place its own address\n   in this extension\
    \ (differentiating it from the address in the Next\n   Hop field).\n"
- title: 5.3.2  NHRP Forward Transit NHS Record Extension
  contents:
  - "5.3.2  NHRP Forward Transit NHS Record Extension\n    Compulsory = 1\n    Type\
    \ = 4\n    Length = variable\n   The NHRP Forward Transit NHS record contains\
    \ a list of transit NHSs\n   through which a \"request\" has traversed.  Each\
    \ NHS SHALL append to\n   the extension a Forward Transit NHS element (as specified\
    \ below)\n   containing its Protocol address.  The extension length field and\
    \ the\n   ar$chksum fields SHALL be adjusted appropriately.\n   The responding\
    \ NHS, as described in Section 5.3.1, SHALL NOT update\n   this extension.\n \
    \  In addition, NHSs that are willing to act as egress routers for\n   packets\
    \ from the source to the destination SHALL include information\n   about their\
    \ NBMA Address.\n   This extension uses a single CIE per NHS Record element with\
    \ the\n   extension specific meanings of the fields set as follows:\n   The Prefix\
    \ Length fields MUST be set to 0 and ignored.\n   CIE Code\n     5 - Insufficient\
    \ Resources\n       If an NHRP Resolution Request contains an NHRP Forward Transit\n\
    \       NHS Record Extension and insufficient resources to setup a cut-\n    \
    \   through VC exist at the current transit NHS then the CIE Code\n       field\
    \ for NHRP Forward Transit NHS Record Extension is set to 5\n       in order to\
    \ tell the client that a VC setup attempt would in all\n       likelihood be rejected;\
    \ otherwise this field MUST be coded as a\n       zero.  NHCs MAY use this field\
    \ to influence whether they attempt\n       to setup a cut-through as described\
    \ in Section 2.2.  Note that\n       the NHRP Reverse Transit NHS Record Extension\
    \ MUST always have\n       this field set to zero.\n   Maximum Transmission Unit\n\
    \     This field gives the maximum transmission unit preferred by the\n     transit\
    \ NHS.  If this value is 0 then either the default MTU is\n     used or the MTU\
    \ negotiated via signaling is used if such\n     negotiation is possible for the\
    \ given NBMA.\n   Holding Time\n     The Holding Time field specifies the number\
    \ of seconds for which\n     the NBMA information of the transit NHS is considered\
    \ to be valid.\n     Cached information SHALL be discarded when the holding time\n\
    \     expires.\n   \"Client Address\" information is actually \"Forward Transit\
    \ NHS\n   Address\" information for this extension.  Thus, for example, Cli Addr\n\
    \   T/L is the transit NHS NBMA address type and length field.\n   If a \"requester\"\
    \ wishes to obtain this information, it SHALL include\n   this extension with\
    \ a length of zero.  Note that this implies that no\n   storage is allocated for\
    \ the Holding Time and Type/Length fields\n   until the \"Value\" portion of the\
    \ extension is filled out.\n   If an NHS has more than one Protocol address, it\
    \ SHALL use the same\n   Protocol address consistently in all of the Responder\
    \ Address,\n   Forward NHS Record, and Reverse NHS Record extensions.  The choice\
    \ of\n   which of several Protocol addresses to include in this extension is a\n\
    \   local matter.\n   If a \"request\" that is being forwarded by an NHS contains\
    \ the\n   Protocol Address of that NHS in one of the Forward Transit NHS\n   elements\
    \ then the NHS SHALL generate an NHRP Error Indication of type\n   \"NHRP Loop\
    \ Detected\" and discard the \"request\".\n"
- title: 5.3.3  NHRP Reverse Transit NHS Record Extension
  contents:
  - "5.3.3  NHRP Reverse Transit NHS Record Extension\n    Compulsory = 1\n    Type\
    \ = 5\n    Length = variable\n   The NHRP Reverse Transit NHS record contains\
    \ a list of transit NHSs\n   through which a \"reply\" has traversed.  Each NHS\
    \ SHALL append a\n   Reverse Transit NHS element (as specified below) containing\
    \ its\n   Protocol address to this extension.  The extension length field and\n\
    \   ar$chksum SHALL be adjusted appropriately.\n   The responding NHS, as described\
    \ in Section 5.3.1, SHALL NOT update\n   this extension.\n   In addition, NHSs\
    \ that are willing to act as egress routers for\n   packets from the source to\
    \ the destination SHALL include information\n   about their NBMA Address.\n  \
    \ This extension uses a single CIE per NHS Record element with the\n   extension\
    \ specific meanings of the fields set as follows:\n   The CIE Code and Prefix\
    \ Length fields MUST be set to 0 and ignored.\n   Maximum Transmission Unit\n\
    \     This field gives the maximum transmission unit preferred by the\n     transit\
    \ NHS.  If this value is 0 then either the default MTU is\n     used or the MTU\
    \ negotiated via signaling is used if such\n     negotiation is possible for the\
    \ given NBMA.\n   Holding Time\n     The Holding Time field specifies the number\
    \ of seconds for which\n     the NBMA information of the transit NHS is considered\
    \ to be valid.\n     Cached information SHALL be discarded when the holding time\n\
    \     expires.\n   \"Client Address\" information is actually \"Reverse Transit\
    \ NHS\n   Address\" information for this extension.  Thus, for example, Cli Addr\n\
    \   T/L is the transit NHS NBMA address type and length field.\n   If a \"requester\"\
    \ wishes to obtain this information, it SHALL include\n   this extension with\
    \ a length of zero.  Note that this implies that no\n   storage is allocated for\
    \ the Holding Time and Type/Length fields\n   until the \"Value\" portion of the\
    \ extension is filled out.\n   If an NHS has more than one Protocol address, it\
    \ SHALL use the same\n   Protocol address consistently in all of the Responder\
    \ Address,\n   Forward NHS Record, and Reverse NHS Record extensions.  The choice\
    \ of\n   which of several Protocol addresses to include in this extension is a\n\
    \   local matter.\n   If a \"reply\" that is being forwarded by an NHS contains\
    \ the Protocol\n   Address of that NHS in one of the Reverse Transit NHS elements\
    \ then\n   the NHS SHALL generate an NHRP Error Indication of type \"NHRP Loop\n\
    \   Detected\" and discard the \"reply\".\n   Note that this information may be\
    \ cached at intermediate NHSs;  if\n   so, the cached value SHALL be used when\
    \ generating a reply.\n"
- title: 5.3.4 NHRP Authentication Extension
  contents:
  - "5.3.4 NHRP Authentication Extension\n   Compulsory = 1 Type = 7 Length = variable\n\
    \   The NHRP Authentication Extension is carried in NHRP packets to\n   convey\
    \ authentication information between NHRP speakers.  The\n   Authentication Extension\
    \ may be included in any NHRP \"request\" or\n   \"reply\" only.\n   The authentication\
    \ is always done pairwise on an NHRP hop-by-hop\n   basis;  i.e., the authentication\
    \ extension is regenerated at each\n   hop.  If a received packet fails the authentication\
    \ test, the station\n   SHALL generate an Error Indication of type \"Authentication\
    \ Failure\"\n   and discard the packet. Note that one possible authentication\
    \ failure\n   is the lack of an Authentication Extension; the presence or absence\n\
    \   of the Authentication Extension is a local matter.\n"
- title: 5.3.4.1 Header Format
  contents:
  - "5.3.4.1 Header Format\n   The authentication header has the following format:\n\
    \   0                   1                   2                   3\n   0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Reserved                    | Security Parameter Index (SPI)|\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |               Src Addr...                                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +-+-+-+-+-+-+-+-+-+-+\
    \ Authentication Data... -+-+-+-+-+-+-+-+-+-+\n   |                          \
    \                                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Security Parameter Index (SPI) can be thought of as an index into a\n   table\
    \ that maintains the keys and other information such as hash\n   algorithm. Src\
    \ and Dst communicate either offline using manual keying\n   or online using a\
    \ key management protocol to populate this table. The\n   sending NHRP entity\
    \ always allocates the SPI and the parameters\n   associated with it.\n   Src\
    \ Addr a variable length field is the address assigned to the\n   outgoing interface.\
    \ The length of the addr is obtained from the\n   source protocol length field\
    \ in the mandatory part of the NHRP\n   header.  The tuple <spi, src addr> uniquely\
    \ identifies the key and\n   other parameters that are used in authentication.\n\
    \   The length of the authentication data field  is dependent on the hash\n  \
    \ algorithm used. The data field contains the keyed hash calculated\n   over the\
    \ entire NHRP payload. The authentication data field is zeroed\n   out before\
    \ the hash is calculated.\n"
- title: 5.3.4.2 SPI and Security Parameters Negotiation
  contents:
  - "5.3.4.2 SPI and Security Parameters Negotiation\n   SPI's can be negotiated either\
    \ manually or using an Internet Key\n   Management protocol. Manual keying MUST\
    \ be supported. The following\n   parameters are associated with the tuple <SPI,\
    \ src>- lifetime,\n   Algorithm, Key. Lifetime indicates the duration in seconds\
    \ for which\n   the key is valid. In case of manual keying, this duration can\
    \ be\n   infinite. Also, in order to better support manual keying, there may\n\
    \   be multiple tuples active at the same time (Dst being the same).\n   Algorithm\
    \ specifies the hash algorithm agreed upon by the two\n   entities. HMAC-MD5-128\
    \ [16] is the default algorithm. Other\n   algorithms MAY be supported by defining\
    \ new values. IANA will assign\n   the numbers to identify the algorithm being\
    \ used as described in\n   Section 9.\n   Any Internet standard key management\
    \ protocol MAY so be used to\n   negotiate the SPI and parameters.\n"
- title: 5.3.4.3 Message Processing
  contents:
  - "5.3.4.3 Message Processing\n   At the time of adding the authentication extension\
    \ header, src looks\n   up in a table to fetch the SPI and the security parameters\
    \ based on\n   the outgoing interface address. If there are no entries in the\
    \ table\n   and if there is support for key management, the src initiates the\
    \ key\n   management protocol to fetch the necessary parameters. The src\n   constructs\
    \ the Authentication Extension payload and calculates the\n   hash by zeroing\
    \ authentication data field. The result replaces in the\n   zeroed authentication\
    \ data field. The src address field in the\n   payload is the IP address assigned\
    \ to the outgoing interface.\n   If key management is not supported and authentication\
    \ is mandatory,\n   the packet is dropped and this information is logged.\n  \
    \ On the receiving end, dst fetches the parameters based on the SPI and\n   the\
    \ ip address in the authentication extension payload. The\n   authentication data\
    \ field is extracted before zeroing out to\n   calculate the hash. It computes\
    \ the hash on the entire payload and if\n   the hash does not match, then an \"\
    abnormal event\" has occurred.\n"
- title: 5.3.4.4 Security Considerations
  contents:
  - "5.3.4.4 Security Considerations\n   It is important that the keys chosen are\
    \ strong as the security of\n   the entire system depends on the keys being chosen\
    \ properly and the\n   correct implementation of the algorithms.\n   The security\
    \ is performed on a hop by hop basis. The data received\n   can be trusted only\
    \ so much as one trusts all the entities in the\n   path traversed. A chain of\
    \ trust is established amongst NHRP entities\n   in the path of the NHRP Message\
    \ . If the security in an NHRP entity\n   is compromised, then security in the\
    \ entire NHRP domain is\n   compromised.\n   Data integrity covers the entire\
    \ NHRP payload. This guarantees that\n   the message was not modified and the\
    \ source is authenticated as well.\n   If authentication extension is not used\
    \ or if the security is\n   compromised, then NHRP entities are liable to both\
    \ spoofing attacks,\n   active attacks and passive attacks.\n   There is no mechanism\
    \ to encrypt the messages. It is assumed that a\n   standard layer 3 confidentiality\
    \ mechanism will be used to encrypt\n   and decrypt messages.  It is recommended\
    \ to use an Internet standard\n   key management protocol to negotiate the keys\
    \ between the neighbors.\n   Transmitting the keys in clear text, if other methods\
    \ of negotiation\n   is used, compromises the security completely.\n   Any NHS\
    \ is susceptible to Denial of Service (DOS) attacks that cause\n   it to become\
    \ overloaded, preventing legitimate packets from being\n   acted upon properly.\
    \ A rogue host can send request and registration\n   packets to the first hop\
    \ NHS. If the authentication option is not\n   used, the registration packet is\
    \ forwarded along the routed path\n   requiring processing along each NHS. If\
    \ the authentication option is\n   used, then only the first hop NHS is susceptible\
    \ to DOS attacks\n   (i.e., unauthenticated packets will be dropped rather than\
    \ forwarded\n   on). If security of any host is compromised (i.e., the keys it\
    \ is\n   using to communicate with an NHS become known), then a rogue host can\n\
    \   send NHRP packets to the first hop NHS of the host whose keys were\n   compromised,\
    \ which will then forward them along the routed path as in\n   the case of unauthenticated\
    \ packets.  However, this attack requires\n   that the rogue host to have the\
    \ same first hop NHS as that of the\n   compromised host. Finally, it should be\
    \ noted that denial of service\n   attacks that cause routers on the routed path\
    \ to expend resources\n   processing NHRP packets are also susceptable to attacks\
    \ that flood\n   packets at the same destination as contained in an NHRP packet's\n\
    \   Destination Protocol Address field.\n"
- title: 5.3.5  NHRP Vendor-Private Extension
  contents:
  - "5.3.5  NHRP Vendor-Private Extension\n    Compulsory = 0\n    Type = 8\n    Length\
    \ = variable\n   The NHRP Vendor-Private Extension is carried in NHRP packets\
    \ to\n   convey vendor-private information or NHRP extensions between NHRP\n \
    \  speakers.\n    0                   1                   2                  \
    \ 3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                  Vendor ID                    |  Data....     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Vendor ID\n     802 Vendor ID as assigned by the IEEE [6]\n   Data\n     The\
    \ remaining octets after the Vendor ID in the payload are\n     vendor-dependent\
    \ data.\n   This extension may be added to any \"request\" or \"reply\" packet\
    \ and it\n   is the only extension that may be included multiple times.  If the\n\
    \   receiver does not handle this extension, or does not match the Vendor\n  \
    \ ID in the extension then the extension may be completely ignored by\n   the\
    \ receiver.  If a Vendor Private Extension is included in a\n   \"request\" then\
    \ it must be copied to the corresponding \"reply\".\n"
- title: 6. Protocol Operation
  contents:
  - "6. Protocol Operation\n   In this section, we discuss certain operational considerations\
    \ of\n   NHRP.\n"
- title: 6.1 Router-to-Router Operation
  contents:
  - "6.1 Router-to-Router Operation\n   In practice, the initiating and responding\
    \ stations may be either\n   hosts or routers.  However, there is a possibility\
    \ under certain\n   conditions that a stable routing loop may occur if NHRP is\
    \ used\n   between two routers.  In particular, attempting to establish an NHRP\n\
    \   path across a boundary where information used in route selection is\n   lost\
    \ may result in a routing loop.  Such situations include the loss\n   of BGP path\
    \ vector information, the interworking of multiple routing\n   protocols with\
    \ dissimilar metrics (e.g, RIP and OSPF), etc.  In such\n   circumstances, NHRP\
    \ should not be used.  This situation can be\n   avoided if there are no \"back\
    \ door\" paths between the entry and\n   egress router outside of the NBMA subnetwork.\
    \  Protocol mechanisms to\n   relax these restrictions are under investigation.\n\
    \   In general it is preferable to use mechanisms, if they exist, in\n   routing\
    \ protocols to resolve the egress point when the destination\n   lies outside\
    \ of the NBMA subnetwork, since such mechanisms will be\n   more tightly coupled\
    \ to the state of the routing system and will\n   probably be less likely to create\
    \ loops.\n"
- title: 6.2 Cache Management Issues
  contents:
  - "6.2 Cache Management Issues\n   The management of NHRP caches in the source station,\
    \ the NHS serving\n   the destination, and any intermediate NHSs is dependent\
    \ on a number\n   of factors.\n"
- title: 6.2.1 Caching Requirements
  contents:
  - "6.2.1 Caching Requirements\n   Source Stations\n     Source stations MUST cache\
    \ all received NHRP Resolution Replies\n     that they are actively using.  They\
    \ also must cache \"incomplete\"\n     entries, i.e., those for which a NHRP Resolution\
    \ Request has been\n     sent but those for which an NHRP Resolution Reply has\
    \ not been\n     received.  This is necessary in order to preserve the Request\
    \ ID\n     for retries, and provides the state necessary to avoid triggering\n\
    \     NHRP Resolution Requests for every data packet sent to the\n     destination.\n\
    \     Source stations MUST purge expired information from their caches.\n    \
    \ Source stations MUST purge the appropriate cached information upon\n     receipt\
    \ of an NHRP Purge Request packet.\n     When a station has a co-resident NHC\
    \ and NHS, the co-resident NHS\n     may reply to NHRP Resolution Requests from\
    \ the co-resident NHC with\n     information which the station cached as a result\
    \ of the co-resident\n     NHC making its own NHRP Resolution Requests as long\
    \ as the co-\n     resident NHS follows the rules for Transit NHSs as seen below.\n\
    \   Serving NHSs\n     The NHS serving the destination (the one which responds\n\
    \     authoritatively to NHRP Resolution Requests) SHOULD cache protocol\n   \
    \  address information from all NHRP Resolution Requests to which it\n     has\
    \ responded if the information in the NHRP Resolution Reply has\n     the possibility\
    \ of changing during its lifetime (so that an NHRP\n     Purge Request packet\
    \ can be issued). The internetworking to NBMA\n     binding information provided\
    \ by the source station in the NHRP\n     Resolution Request may also be cached\
    \ if and only if the \"S\" bit is\n     set, the NHRP Resolution Request has included\
    \ a CIE with the\n     Holding Time field set greater than zero (this is the valid\
    \ Holding\n     Time for the source binding), and only for non-authoritative use\n\
    \     for a period not to exceed the Holding Time.\n   Transit NHSs\n     A Transit\
    \ NHS (lying along the NHRP path between the source station\n     and the responding\
    \ NHS) may cache source binding information\n     contained in NHRP Resolution\
    \ Request packets that it forwards if\n     and only if the \"S\" bit is set,\
    \ the NHRP Resolution Request has\n     included a CIE with the Holding Time field\
    \ set greater than zero\n     (this is the valid Holding Time for the source binding),\
    \ and only\n     for non-authoritative use for a period not to exceed the Holding\n\
    \     Time.\n     A Transit NHS may cache destination information contained in\
    \ NHRP\n     Resolution Reply CIE if only if the D bit is set and then only for\n\
    \     non-authoritative use for a period not to exceed the Holding Time\n    \
    \ value contained in the CIE.  A Transit NHS MUST NOT cache source\n     binding\
    \ information contained in an NHRP Resolution Reply.\n     Further, a transit\
    \ NHS MUST discard any cached information when the\n     prescribed time has expired.\
    \  It may return cached information in\n     response to non-authoritative NHRP\
    \ Resolution Requests only.\n"
- title: 6.2.2 Dynamics of Cached Information
  contents:
  - "6.2.2 Dynamics of Cached Information\n   NBMA-Connected Destinations\n     NHRP's\
    \ most basic function is that of simple NBMA address\n     resolution of stations\
    \ directly attached to the NBMA subnetwork.\n     These mappings are typically\
    \ very static, and appropriately chosen\n     holding times will minimize problems\
    \ in the event that the NBMA\n     address of a station must be changed. Stale\
    \ information will cause\n     a loss of connectivity, which may be used to trigger\
    \ an\n     authoritative NHRP Resolution Request and bypass the old data.  In\n\
    \     the worst case, connectivity will fail until the cache entry times\n   \
    \  out.\n     This applies equally to information marked in NHRP Resolution\n\
    \     Replies as being \"stable\" (via the \"D\" bit).\n   Destinations Off of\
    \ the NBMA Subnetwork\n     If the source of an NHRP Resolution Request is a host\
    \ and the\n     destination is not directly attached to the NBMA subnetwork, and\n\
    \     the route to that destination is not considered to be \"stable,\" the\n\
    \     destination mapping may be very dynamic (except in the case of a\n     subnetwork\
    \ where each destination is only singly homed to the NBMA\n     subnetwork). \
    \ As such the cached information may very likely become\n     stale.  The consequence\
    \ of stale information in this case will be a\n     suboptimal path (unless the\
    \ internetwork has partitioned or some\n     other routing failure has occurred).\n"
- title: 6.3 Use of the Prefix Length field of a CIE
  contents:
  - "6.3 Use of the Prefix Length field of a CIE\n   A certain amount of care needs\
    \ to be taken when using the Prefix\n   Length field of a CIE, in particular with\
    \ regard to the prefix length\n   advertised (and thus the size of the equivalence\
    \ class specified by\n   it).  Assuming that the routers on the NBMA subnetwork\
    \ are exchanging\n   routing information, it should not be possible for an NHS\
    \ to create a\n   black hole by advertising too large of a set of destinations,\
    \ but\n   suboptimal routing (e.g., extra internetwork layer hops through the\n\
    \   NBMA) can result.  To avoid this situation an NHS that wants to send\n   the\
    \ Prefix Length MUST obey the following rule:\n     The NHS examines the Network\
    \ Layer Reachability Information (NLRI)\n     associated with the route that the\
    \ NHS would use to forward towards\n     the destination (as specified by the\
    \ Destination internetwork layer\n     address in the NHRP Resolution Request),\
    \ and extracts from this\n     NLRI the shortest address prefix such that: (a)\
    \ the Destination\n     internetwork layer address (from the NHRP Resolution Request)\
    \ is\n     covered by the prefix, (b) the NHS does not have any routes with\n\
    \     NLRI which form a subset of what is covered by the prefix. The\n     prefix\
    \ may then be used in the CIE.\n   The Prefix Length field of the CIE should be\
    \ used with restraint, in\n   order to avoid NHRP stations choosing suboptimal\
    \ transit paths when\n   overlapping prefixes are available.  This document specifies\
    \ the use\n   of the prefix length only when all the destinations covered by the\n\
    \   prefix are \"stable\". That is, either:\n     (a) All destinations covered\
    \ by the prefix are on the NBMA network,\n         or\n     (b) All destinations\
    \ covered by the prefix are directly attached to\n         the NHRP responding\
    \ station.\n   Use of the Prefix Length field of the CIE in other circumstances\
    \ is\n   outside the scope of this document.\n"
- title: 6.4 Domino Effect
  contents:
  - "6.4 Domino Effect\n   One could easily imagine a situation where a router, acting\
    \ as an\n   ingress station to the NBMA subnetwork, receives a data packet, such\n\
    \   that this packet triggers an NHRP Resolution Request.  If the router\n   forwards\
    \ this data packet without waiting for an NHRP transit path to\n   be established,\
    \ then when the next router along the path receives the\n   packet, the next router\
    \ may do exactly the same - originate its own\n   NHRP Resolution Request (as\
    \ well as forward the packet).  In fact\n   such a data packet may trigger NHRP\
    \ Resolution Request generation at\n   every router along the path through an\
    \ NBMA subnetwork.  We refer to\n   this phenomena as the NHRP \"domino\" effect.\n\
    \   The NHRP domino effect is clearly undesirable.  At best it may result\n  \
    \ in excessive NHRP traffic.  At worst it may result in an excessive\n   number\
    \ of virtual circuits being established unnecessarily.\n   Therefore, it is important\
    \ to take certain measures to avoid or\n   suppress this behavior.  NHRP implementations\
    \ for NHSs MUST provide a\n   mechanism to address this problem. One possible\
    \ strategy to address\n   this problem would be to configure a router in such\
    \ a way that NHRP\n   Resolution Request generation by the router would be driven\
    \ only by\n   the traffic the router receives over its non-NBMA interfaces\n \
    \  (interfaces that are not attached to an NBMA subnetwork).  Traffic\n   received\
    \ by the router over its NBMA-attached interfaces would not\n   trigger NHRP Resolution\
    \ Requests.  Such a router avoids the NHRP\n   domino effect through administrative\
    \ means.\n"
- title: 7. NHRP over Legacy BMA Networks
  contents:
  - "7. NHRP over Legacy BMA Networks\n   There would appear to be no significant\
    \ impediment to running NHRP\n   over legacy broadcast subnetworks.  There may\
    \ be issues around\n   running NHRP across multiple subnetworks. Running NHRP\
    \ on broadcast\n   media has some interesting possibilities; especially when setting\
    \ up\n   a cut-through for inter-ELAN inter-LIS/LAG traffic when one or both\n\
    \   end stations are legacy attached.  This use for NHRP requires further\n  \
    \ research.\n"
- title: 8. Discussion
  contents:
  - "8. Discussion\n   The result of an NHRP Resolution Request depends on how routing\
    \ is\n   configured among the NHSs of an NBMA subnetwork.  If the destination\n\
    \   station is directly connected to the NBMA subnetwork and the routed\n   path\
    \ to it lies entirely within the NBMA subnetwork, the NHRP\n   Resolution Replies\
    \ always return the NBMA address of the destination\n   station itself rather\
    \ than the NBMA address of some egress router.\n   On the other hand, if the routed\
    \ path exits the NBMA subnetwork, NHRP\n   will be unable to resolve the NBMA\
    \ address of the destination, but\n   rather will return the address of the egress\
    \ router.  For\n   destinations outside the NBMA subnetwork, egress routers and\
    \ routers\n   in the other subnetworks should exchange routing information so\
    \ that\n   the optimal egress router may be found.\n   In addition to NHSs, an\
    \ NBMA station could also be associated with\n   one or more regular routers that\
    \ could act as \"connectionless\n   servers\" for the station.  The station could\
    \ then choose to resolve\n   the NBMA next hop or just send the packets to one\
    \ of its\n   connectionless servers.  The latter option may be desirable if\n\
    \   communication with the destination is short-lived and/or doesn't\n   require\
    \ much network resources.  The connectionless servers could, of\n   course, be\
    \ physically integrated in the NHSs by augmenting them with\n   internetwork layer\
    \ switching functionality.\n"
- title: 9. IANA Considerations
  contents:
  - "9. IANA Considerations\n   IANA will take advice from the Area Director appointed\
    \ designated\n   subject matter expert, in order to assign numbers from the various\n\
    \   number spaces described herein.  In the event that the Area Director\n   appointed\
    \ designated subject matter expert is unavailable, the\n   relevant IESG Area\
    \ Director will appoint another expert.  Any and all\n   requests for value assignment\
    \ within a given number space will be\n   accepted when the usage of the value\
    \ assignment documented.  Possible\n   forms of documentantion include, but is\
    \ not limited to, RFCs or the\n   product of another cooperative standards body\
    \ (e.g., the MPOA and\n   LANE subworking group of the ATM Forum).\n"
- title: References
  contents:
  - "References\n   [1] Heinanen, J., and R. Govindan, \"NBMA Address Resolution Protocol\n\
    \   (NARP)\", RFC 1735, December 1994.\n   [2] Plummer, D., \"Address Resolution\
    \ Protocol\", STD 37, RFC 826,\n   November 1982.\n   [3] Laubach, M., and J.\
    \ Halpern, \"Classical IP and ARP over ATM\", RFC\n   2225, April 1998.\n   [4]\
    \ Piscitello,, D., and J. Lawrence, \"Transmission of IP datagrams\n   over the\
    \ SMDS service\", RFC 1209, March 1991.\n   [5] Protocol Identification in the\
    \ Network Layer, ISO/IEC TR\n   9577:1990.\n   [6] Reynolds, J., and J. Postel,\
    \ \"Assigned Numbers\", STD 2, RFC 1700,\n   October 1994.\n   [7] Heinanen, J.,\
    \ \"Multiprotocol Encapsulation over ATM Adaptation\n   Layer 5\", RFC 1483, July\
    \ 1993.\n   [8] Malis, A., Robinson, D., and R. Ullmann, \"Multiprotocol\n   Interconnect\
    \ on X.25 and ISDN in the Packet Mode\", RFC 1356, August\n   1992.\n   [9] Bradley,\
    \ T., Brown, C., and A. Malis, \"Multiprotocol Interconnect\n   over Frame Relay\"\
    , RFC 1490, July 1993.\n   [10] Rekhter, Y., and D. Kandlur, \"\"Local/Remote\"\
    \ Forwarding Decision\n   in Switched Data Link Subnetworks\", RFC 1937, May 1996.\n\
    \   [11] Armitage, G., \"Support for Multicast over UNI 3.0/3.1 based ATM\n  \
    \ Networks\", RFC 2022, November 1996.\n   [12] Luciani, J., Armitage, G., and\
    \ J. Halpern, \"Server Cache\n   Synchronization Protocol (SCSP) - NBMA\", RFC\
    \ 2334, April 1998.\n   [13] Rekhter, Y., \"NHRP for Destinations off the NBMA\
    \ Subnetwork\",\n   Work In Progress.\n   [14] Luciani, J., et. al., \"Classical\
    \ IP and ARP over ATM to NHRP\n   Transition\", Work In Progress.\n   [15] Bradner,\
    \ S., \"Key words for use in RFCs to Indicate Requirement\n   Levels\", BCP 14,\
    \ RFC 2119, March 1997.\n   [16] Krawczyk, H., Bellare, M., and R. Canetti, \"\
    HMAC: Keyed Hashing\n   for Message Authentication\", RFC 2104, February 1997.\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   We would like to thank (in no particular order) Thomas Narten\
    \ of IBM\n   for his comments in the role of Internet AD, Juha Heinenan of Telecom\n\
    \   Finland and Ramesh Govidan of ISI for their work on NBMA ARP and the\n   original\
    \ NHRP draft, which served as the basis for this work.\n   Russell Gardo of IBM,\
    \ John Burnett of Adaptive, Dennis Ferguson of\n   ANS, Andre Fredette of Bay\
    \ Networks, Joel Halpern of Newbridge, Paul\n   Francis of NTT, Tony Li, Bryan\
    \ Gleeson, and Yakov Rekhter of cisco,\n   and Grenville Armitage of Bellcore\
    \ should also be acknowledged for\n   comments and suggestions that improved this\
    \ work substantially.  We\n   would also like to thank the members of the ION\
    \ working group of the\n   IETF, whose review and discussion of this document\
    \ have been\n   invaluable.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   James V. Luciani                    Dave Katz\n   Bay\
    \ Networks                        cisco Systems\n   3 Federal Street         \
    \           170 W. Tasman Dr.\n   Mail Stop: BL3-03                   San Jose,\
    \ CA 95134 USA\n   Billerica, MA 01821                 Phone:  +1 408 526 8284\n\
    \   Phone:  +1 978 916 4734             EMail:  dkatz@cisco.com\n   EMail:  luciani@baynetworks.com\n\
    \   David Piscitello                    Bruce Cole\n   Core Competence       \
    \              Juniper Networks\n   1620 Tuckerstown Road               3260 Jay\
    \ St.\n   Dresher, PA 19025 USA               Santa Clara, CA 95054\n   Phone:\
    \  +1 215 830 0692             Phone:  +1 408 327 1900\n   EMail: dave@corecom.com\
    \             EMail:  bcole@jnx.com\n   Naganand Doraswamy\n   Bay Networks, Inc.\n\
    \   3 Federal Street\n   Mail Stop: Bl3-03\n   Billerica, MA 01801\n   Phone:\
    \  +1 978 916 1323\n   EMail: naganand@baynetworks.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (1998).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
