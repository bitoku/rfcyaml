- title: __initial_text__
  contents:
  - "   The China Education and Research Network (CERNET) IVI Translation\n   Design\
    \ and Deployment for the IPv4/IPv6 Coexistence and Transition\n"
- title: Abstract
  contents:
  - "Abstract\n   This document presents the China Education and Research Network\n\
    \   (CERNET)'s IVI translation design and deployment for the IPv4/IPv6\n   coexistence\
    \ and transition.\n   The IVI is a prefix-specific and stateless address mapping\
    \ mechanism\n   for \"an IPv6 network to the IPv4 Internet\" and \"the IPv4 Internet\
    \ to\n   an IPv6 network\" scenarios.  In the IVI design, subsets of the ISP's\n\
    \   IPv4 addresses are embedded in the ISP's IPv6 addresses, and the\n   hosts\
    \ using these IPv6 addresses can therefore communicate with the\n   global IPv6\
    \ Internet directly and can communicate with the global\n   IPv4 Internet via\
    \ stateless translators.  The communications can\n   either be IPv6 initiated\
    \ or IPv4 initiated.  The IVI mechanism\n   supports the end-to-end address transparency\
    \ and incremental\n   deployment.  The IVI is an early design deployed in the\
    \ CERNET as a\n   reference for the IETF standard documents on IPv4/IPv6 stateless\n\
    \   translation.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6219.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Analysis of IPv4-IPv6 Translation Mechanisms ...............3\n  \
    \    1.2. CERNET Translation Requirements ............................4\n   2.\
    \ Terms and Abbreviations .........................................6\n   3. The\
    \ IVI Translation Algorithm ...................................6\n      3.1. Address\
    \ Format .............................................8\n      3.2. Routing and\
    \ Forwarding .....................................9\n      3.3. Network-Layer\
    \ Header Translation ..........................10\n      3.4. Transport-Layer\
    \ Header Translation ........................11\n      3.5. Fragmentation and\
    \ MTU Handling ............................11\n      3.6. ICMP Handling .............................................11\n\
    \      3.7. Application Layer Gateway .................................12\n  \
    \ 4. The IVI DNS Configuration ......................................12\n    \
    \  4.1. DNS Configuration for the IVI6(i) Addresses ...............12\n      4.2.\
    \ DNS Service for the IVIG6(i) Addresses ....................12\n   5. The Advanced\
    \ IVI Translation Functions .........................12\n      5.1. IVI Multicast\
    \ .............................................12\n   6. IVI Host Operation .............................................13\n\
    \      6.1. IVI Address Assignment ....................................13\n  \
    \    6.2. IPv6 Source Address Selection .............................13\n   7.\
    \ The IVI Implementation .........................................14\n      7.1.\
    \ Linux Implementation ......................................14\n      7.2. Testing\
    \ Environment .......................................14\n   8. Security Considerations\
    \ ........................................14\n   9. Contributors ...................................................15\n\
    \   10. Acknowledgments ...............................................15\n  \
    \ Appendix A. The IVI Translator Configuration Example ..............16\n   Appendix\
    \ B. The traceroute Results ................................17\n   11. References\
    \ ....................................................19\n      11.1. Normative\
    \ References .....................................19\n      11.2. Informative\
    \ References ...................................20\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document presents the CERNET IVI translation design\
    \ and\n   deployment for the IPv4/IPv6 coexistence and transition.  In Roman\n\
    \   numerals, the \"IV\" stands for 4, and \"VI\" stands for 6, so \"IVI\"\n \
    \  stands for the IPv4/IPv6 translation.\n   The experiences with IPv6 deployment\
    \ in the past 10 years indicate\n   that the ability to communicate between IPv4\
    \ and IPv6 address\n   families would be beneficial.  However, the current transition\n\
    \   methods do not fully support this requirement [RFC4213].  For\n   example,\
    \ dual-stack hosts can communicate with both the IPv4 and IPv6\n   hosts, but\
    \ single-stack hosts can only communicate with hosts in the\n   same address family.\
    \  While the dual-stack approach continues to work\n   in many cases even in the\
    \ face of IPv4 address depletion [COUNT],\n   there are situations where it would\
    \ be desirable to communicate with\n   a device in another address family.  Tunneling-based\
    \ architectures\n   can link the IPv6 islands across IPv4 networks, but they cannot\n\
    \   provide communication between the two different address families\n   [RFC3056]\
    \ [RFC5214] [RFC4380].  Translation can relay communications\n   for hosts located\
    \ in IPv4 and IPv6 networks, but the current\n   implementation of this kind of\
    \ architecture is not scalable, and it\n   cannot maintain end-to-end address\
    \ transparency [RFC2766] [RFC3142]\n   [RFC4966] [RFC2775].\n"
- title: 1.1.  Analysis of IPv4-IPv6 Translation Mechanisms
  contents:
  - "1.1.  Analysis of IPv4-IPv6 Translation Mechanisms\n   Since IPv4 and IPv6 are\
    \ different protocols with different addressing\n   structures, a translation\
    \ mechanism is necessary for communication\n   between endpoints using different\
    \ address families.  There are\n   several ways to implement the translation.\
    \  One is the Stateless IP/\n   ICMP Translation Algorithm (SIIT) [RFC2765], which\
    \ provides a\n   mechanism for translation between IPv4 and IPv6 packet headers\n\
    \   (including ICMP headers) without requiring any per-connection state.\n   However,\
    \ SIIT does not specify the address assignment and routing\n   scheme [RFC2766].\
    \  For example, SIIT uses IPv4-mapped IPv6 addresses\n   [::ffff:ipv4-addr/96]\
    \ and IPv4-compatible IPv6 addresses\n   [::ipv4-address/96] for the address mapping,\
    \ but these addresses\n   violate the aggregation principle of IPv6 routing [RFC4291].\
    \  The\n   other translation mechanism is Network Address Translation - Protocol\n\
    \   Translation (NAT-PT), which has serious technical and operational\n   difficulties;\
    \ the IETF has reclassified it from Proposed Standard to\n   Historic status [RFC4966].\n\
    \   In order to solve the technical difficulties in NAT-PT, the issues\n   and\
    \ the possible workarounds are:\n   1.  NAT-PT disrupts all protocols that embed\
    \ IP addresses (and/or\n       ports) in packet payloads.  There is little that\
    \ can be done\n       about this, other than using Application Layer Gateways\
    \ (ALGs) or\n       preferring protocols that transport DNS names instead of\n\
    \       addresses.\n   2.  Loss of end-to-end address transparency may occur.\
    \  End-to-end\n       address transparency implies a global address space, the\
    \ ability\n       to pass packets unaltered throughout the network, and the ability\n\
    \       to use source and destination addresses as unique labels\n       [RFC2775].\
    \  A reversible, algorithmic mapping can restore some of\n       this transparency.\
    \  However, it is still not possible to ensure\n       that all nodes in the existing\
    \ Internet support such reversible\n       mappings.\n   3.  The states maintained\
    \ in the translator cause scalability,\n       multihoming, and load-sharing problems.\
    \  Hence, a stateless\n       translation scheme is preferred.\n   4.  Loss of\
    \ information due to incompatible semantics between IPv4\n       and IPv6 versions\
    \ of headers and protocols may occur.  A partial\n       remedy to this is the\
    \ proper attention to the details of the\n       protocol translation, for example,\
    \ the error-codes mapping\n       between ICMP and ICMPv6.  However, some semantic\
    \ differences\n       remain.\n   5.  The DNS is tightly coupled with the translator\
    \ and lack of\n       address mapping persistence discussed in Section 3.3 of\n\
    \       [RFC4966].  Hence, the DNS should be decoupled from the\n       translator.\n\
    \   6.  Support for referrals is difficult in NAT-PT, given that\n       translated\
    \ addresses may leak outside the network where these\n       addresses have a\
    \ meaning.  Stateless translation, algorithmic\n       address mappings, and the\
    \ decoupling of DNS from the translation\n       process can help the handling\
    \ of referrals.  Nevertheless, it is\n       still possible that an address-based\
    \ referral is passed to\n       someone who cannot employ it.  For instance, an\
    \ IPv6-only node\n       may pass a referral based on an IPv6 address to a node\
    \ that only\n       understands IPv4.\n"
- title: 1.2.  CERNET Translation Requirements
  contents:
  - "1.2.  CERNET Translation Requirements\n   The China Education and Research Network\
    \ has two backbones using\n   different address families.  The CERNET is IPv4-only\
    \ [CERNET] and\n   CERNET2 is IPv6-only [CNGI-CERNET2], which fit in \"an IPv6\
    \ network to\n   the IPv4 Internet\" and \"the IPv4 Internet to an IPv6 network\"\
    \n   scenarios in the IETF BEHAVE working group definition [BEHAVE]\n   [RFC6144].\
    \  In order to make CERNET2 communicate with the IPv4\n   Internet, we designed\
    \ the IVI mechanism and installed IVI translators\n   between the CERNET and CERNET2.\n\
    \   The requirements of the IVI mechanism are:\n   1.  It should support both\
    \ IPv6-initiated and IPv4-initiated\n       communications for the IPv6 clients/servers\
    \ in \"an IPv6 network\".\n   2.  It should follow current IPv4 and IPv6 routing\
    \ practice without\n       increasing the global routing table size in both address\n\
    \       families.\n   3.  It should be able to be deployed incrementally.\n  \
    \ 4.  It should be able to use IPv4 addresses effectively due to the\n       IPv4\
    \ address depletion problem.\n   5.  It should be stateless to achieve scalability.\n\
    \   6.  The DNS function should be decoupled from the translator.\n   The specific\
    \ IVI design presented in this document can satisfy the\n   above requirements,\
    \ with the following notes:\n   1.  It restricts the IPv6 hosts to use a subset\
    \ of the addresses\n       inside the ISP's IPv6 block.  Therefore, IPv6 autoconfiguration\n\
    \       cannot be used for these IPv6 hosts.  Manual configuration or\n      \
    \ autoconfiguration via stateful DHCPv6 is required.\n   2.  It defines a one-to-one\
    \ mapping between IPv4 addresses and IPv6\n       addresses; hence, the IPv4 addresses\
    \ cannot be used efficiently.\n       However, the IVI6 addresses can be used\
    \ both for IPv6 clients and\n       IPv6 servers.  Due to this limitation, we\
    \ suggest using IVI6\n       addresses for servers.\n   3.  An ALG is still required\
    \ for any applications that embed\n       address(es) in the payload.\n   4. \
    \ Some issues with end-to-end transparency, address referrals, and\n       incompatible\
    \ semantics between protocol versions still remain, as\n       discussed above.\n\
    \   The IVI is an early design deployed in the CERNET for the stateless\n   translation.\
    \  The IETF standard IPv4-IPv6 stateless and stateful\n   translation mechanisms\
    \ are defined in [RFC6144], [RFC6052],\n   [RFC6145], [RFC6146], and [RFC6147].\n"
- title: 2.  Terms and Abbreviations
  contents:
  - "2.  Terms and Abbreviations\n   The following terms and abbreviations are used\
    \ in this document:\n   ISP(i):  A specific Internet service provider \"i\".\n\
    \   IVIG4:  The global IPv4 address space.\n   IPS4(i):  A subset of IVIG4 allocated\
    \ to ISP(i).\n   IVI4(i):  A subset of IPS4(i); the addresses in this set will\
    \ be\n      mapped to IPv6 via the IVI mapping mechanism and used by IPv6\n  \
    \    hosts of ISP(i).\n   IPG6:  The global IPv6 address space.\n   IPS6(i): \
    \ A subset of IPG6 allocated to ISP(i).\n   IVIG6(i):  A subset of IPS6(i), and\
    \ an image of IVIG4 in the IPv6\n      address family via the IVI mapping mechanism.\
    \  It is defined as\n      the IPv4-converted address in [RFC6144].\n   IVI6(i):\
    \  A subset of IVIG6(i) and an image of IVI4(i) in the IPv6\n      address family\
    \ via the IVI mapping mechanism.  It is defined as\n      the IPv4-translatable\
    \ address in [RFC6144].\n   IVI translator:  The mapping and translation gateway\
    \ between IPv4 and\n      IPv6 based on the IVI mechanism.\n   IVI DNS:  Providing\
    \ the IVI Domain Name System (DNS).\n   The key words \"MUST\", \"MUST NOT\",\
    \ \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\", when\n   they appear in this document, are to be\
    \ interpreted as described in\n   [RFC2119].\n"
- title: 3.  The IVI Translation Algorithm
  contents:
  - "3.  The IVI Translation Algorithm\n   The IVI is a prefix-specific and stateless\
    \ address mapping scheme\n   that can be carried out by individual ISPs.  In the\
    \ IVI design,\n   subsets of the ISP's IPv4 addresses are embedded in the ISP's\
    \ IPv6\n   addresses, and the hosts using these IPv6 addresses can therefore\n\
    \   communicate with the global IPv6 Internet directly and can\n   communicate\
    \ with the global IPv4 Internet via stateless translators.\n   The communications\
    \ can either be IPv6 initiated or IPv4 initiated.\n   The IVI mapping and translation\
    \ mechanism is implemented in an IVI\n   translator that connects between \"an\
    \ IPv6 network\" and the IPv4\n   Internet via the ISP's IPv4 network, as shown\
    \ in the following\n   figure.\n            ------                        -----\
    \           ------\n          /  The   \\       -----        /  An   \\      \
    \ /  The   \\\n         |  IPv4    |-----|Xlate|------|  IPv6   |-----|  IPv6\
    \    |\n          \\Internet/       -----        \\Network/       \\Internet/\n\
    \            ------                        -----           ------\n          \
    \                 <===>\n    Figure 1: The Scenarios: \"An IPv6 Network to the\
    \ IPv4 Internet\" and\n                  \"the IPv4 Internet to an IPv6 Network\"\
    \n   In order to perform the translation function between IPv4 and IPv6\n   addresses,\
    \ the translator needs to represent the IPv4 addresses in\n   IPv6 and the IPv6\
    \ addresses in IPv4.\n   To represent the IPv4 addresses in IPv6, a unique, prefix-specific,\n\
    \   and stateless mapping scheme is defined between IPv4 addresses and\n   subsets\
    \ of IPv6 addresses, so each provider-independent IPv6 address\n   block (usually\
    \ a /32) will have a small portion of IPv6 addresses\n   (for example, /40 defined\
    \ by PREFIX), which is the image of the\n   totality of the global IPv4 addresses,\
    \ as shown in the following\n   figure.  The SUFFIX is all zeros.\n          \
    \                  +-+-+-+-+-+-+\n                            |  IVIG4    |\n\
    \                            +-+-+-+-+-+-+\n                                 ||\n\
    \                                \\  /\n                                 \\/\n\
    \             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n            \
    \ |  PREFIX      | IPv4 addr |  SUFFIX            |\n             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n\
    \             Figure 2: Representing the IPv4 Addresses in IPv6\n   To represent\
    \ the IPv6 addresses in IPv4, each provider can borrow a\n   portion of its IPv4\
    \ addresses and map them into IPv6 based on the\n   above mapping rule.  These\
    \ special IPv6 addresses will be physically\n   used by IPv6 hosts.  The original\
    \ IPv4 form of the borrowed addresses\n   is the image of these special IPv6 addresses,\
    \ and it can be accessed\n   by the IPv4 Internet, as shown in the following figure.\
    \  The SUFFIX\n   can either be all zeros, or some other value for future extensions.\n\
    \             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n            \
    \ |  PREFIX      |   |IVI4|  |  SUFFIX            |\n             +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+\n\
    \                                  ||\n                                 \\  /\n\
    \                                  \\/\n                                -+-+-+\n\
    \                                |IVI4|\n                                -+-+-+\n\
    \             Figure 3: Representing the IPv6 Addresses in IPv4\n"
- title: 3.1.  Address Format
  contents:
  - "3.1.  Address Format\n   The IVI address format is defined based on an individual\
    \ ISP's IPv6\n   prefix, as shown in the following figure\n     | 0          \
    \       |32 |40                   |72             127|\n     ------------------------------------------------------------------\n\
    \     |                   |ff |                     |                  |\n   \
    \  ------------------------------------------------------------------\n     |<-\
    \     PREFIX        ->|<-  IPv4 address   ->|   <- SUFFIX ->   |\n           \
    \            Figure 4: IVI Address Mapping\n   where bit 0 to bit 31 are the prefix\
    \ of ISP(i)'s /32 (e.g., using\n   document IPv6 address IPS6=2001:db8::/32) in\
    \ the CERNET\n   implementation, bit 32 to bit 39 are all ones as the identifier\
    \ of\n   the IVI addresses, and bit 40 to bit 71 are embedded global IPv4\n  \
    \ space (IVIG4), presented in hexadecimal format (e.g.,\n   2001:db8:ff00::/40).\
    \  Note that based on the IVI mapping mechanism,\n   an IPv4 /24 is mapped to\
    \ an IPv6 /64, and an IPv4 /32 is mapped to an\n   IPv6 /72.\n   The IETF standard\
    \ for the address format is defined in [RFC6052].\n"
- title: 3.2.  Routing and Forwarding
  contents:
  - "3.2.  Routing and Forwarding\n   Based on the IVI address mapping rule, routing\
    \ is straightforward, as\n   shown in the following figure\n    /-----\\     \
    \                                                /-----\\\n   ( ISP's )   -- \
    \ 192.0.2.2    -----------  2001:db8::2 --    ( ISP's )\n   ( IPv4  )--|R1|-------------|\
    \ IVI Xlate |------------|R2|---( IPv6  )\n   (network)   --    192.0.2.1  -----------\
    \ 2001:db8::1  --    (network)\n    \\-----/                                 \
    \                    \\-----/\n       |                                      \
    \                     |\n       |                                            \
    \               |\n   The IPv4 Internet                                   The\
    \ IPv6 Internet\n                           Figure 5: IVI Routing\n   where\n\
    \   1.  IVI Xlate is a special dual-stack router, with two interfaces,\n     \
    \  one to the IPv4 network and the other to the IPv6 network (it is\n       also\
    \ possible to have a single interface configured with both\n       IPv4 and IPv6\
    \ addresses).  IVI Xlate can support dynamic routing\n       protocols in IPv4\
    \ and IPv6 address families.  In the above\n       configuration, the static routing\
    \ configuration can be used.\n   2.  Router R1 has an IPv4 route for IVI4(i)/k\
    \ (k is the prefix length\n       of IVI4(i)) with the next hop equal to 192.0.2.1,\
    \ and this route\n       is distributed to the Internet with proper aggregation.\n\
    \   3.  Router R2 has an IPv6 route for IVIG6(i)/40 with the next hop\n      \
    \ equal to 2001:db8::1, and this route is distributed to the IPv6\n       Internet\
    \ with proper aggregation.\n   4.  The IVI translator has an IPv6 route for IVI6(i)/(40+k)\
    \ with the\n       next hop equal to 2001:db8::2.  The IVI translator also has\
    \ an\n       IPv4 default route 0.0.0.0/0 with the next hop equal to\n       192.0.2.2.\n\
    \   Note that the routes described above can be learned/inserted by\n   dynamic\
    \ routing protocols (IGP or BGP) in the IVI translator peering\n   with R1 and\
    \ R2.\n   Since both IVI4(i) and IVI6(i) are aggregated to IPS4(i) and IPS6(i)\n\
    \   in ISP(i)'s border routers, respectively, they will not affect the\n   global\
    \ IPv4 and IPv6 routing tables [RFC4632].\n   Since the IVI translation is stateless,\
    \ it can support multihoming\n   when the same prefix is used for multiple translators.\n\
    \   Since the IVI translation can be implemented independently in each\n   ISP's\
    \ network, it can be incrementally deployed in the global\n   Internet.\n"
- title: 3.3.  Network-Layer Header Translation
  contents:
  - "3.3.  Network-Layer Header Translation\n   IPv4 [RFC0791] and IPv6 [RFC2460]\
    \ are different protocols with\n   different network-layer header formats; the\
    \ translation of the IPv4\n   and IPv6 headers MUST be performed according to\
    \ SIIT [RFC2765],\n   except for the source and destination addresses in the header,\
    \ as\n   shown in the following figures.\n       -------------------------------------------------------------\n\
    \       IPv4 Field             Translated to IPv6\n       -------------------------------------------------------------\n\
    \       Version (0x4)          Version (0x6)\n       IHL                    discarded\n\
    \       Type of Service        Traffic Class\n       Total Length           Payload\
    \ Length = Total Length - 20\n       Identification         discarded\n      \
    \ Flags                  discarded\n       Offset                 discarded\n\
    \       TTL                    Hop Limit\n       Protocol               Next Header\n\
    \       Header Checksum        discarded\n       Source Address         IVI address\
    \ mapping\n       Destination Address    IVI address mapping\n       Options \
    \               discarded\n       -------------------------------------------------------------\n\
    \                 Figure 6: IPv4-to-IPv6 Header Translation\n       -------------------------------------------------------------\n\
    \       IPv6 Field             Translated to IPv4 Header\n       -------------------------------------------------------------\n\
    \       Version (0x6)          Version (0x4)\n       Traffic Class          Type\
    \ of Service\n       Flow Label             discarded\n       Payload Length \
    \        Total Length = Payload Length + 20\n       Next Header            Protocol\n\
    \       Hop Limit              TTL\n       Source Address         IVI address\
    \ mapping\n       Destination Address    IVI address mapping\n       -       \
    \               IHL = 5\n       -                      Header Checksum recalculated\n\
    \       -------------------------------------------------------------\n      \
    \           Figure 7: IPv6-to-IPv4 Header Translation\n   The IETF standard for\
    \ IP/ICMP translation is defined in [RFC6145],\n   which contains updated technical\
    \ specifications.\n"
- title: 3.4.  Transport-Layer Header Translation
  contents:
  - "3.4.  Transport-Layer Header Translation\n   Since the TCP and UDP headers [RFC0793]\
    \ [RFC0768] consist of\n   checksums that include the IP header, the recalculation\
    \ and updating\n   of the transport-layer headers MUST be performed.  Note that\
    \ SIIT\n   does not recalculate the transport-layer checksum, since checksum-\n\
    \   neutral IPv6 addresses are used in SIIT [RFC2765].\n   The IETF standard for\
    \ transport-layer header translation is defined\n   in [RFC6145], which contains\
    \ updated technical specifications.\n"
- title: 3.5.  Fragmentation and MTU Handling
  contents:
  - "3.5.  Fragmentation and MTU Handling\n   When the packet is translated by the\
    \ IVI translator, due to the\n   different sizes of the IPv4 and IPv6 headers,\
    \ the IVI6 packets will\n   be at least 20 bytes larger than the IVI4 packets,\
    \ which may exceed\n   the MTU of the next link in the IPv6 network.  Therefore,\
    \ the MTU\n   handling and translation between IPv6 fragmentation headers and\
    \ the\n   fragmentation field in the IPv4 headers are necessary; this is\n   performed\
    \ in the IVI translator according to SIIT [RFC2765].\n   The IETF standard for\
    \ fragmentation and MTU handling is defined in\n   [RFC6145], which contains updated\
    \ technical specifications.\n"
- title: 3.6.  ICMP Handling
  contents:
  - "3.6.  ICMP Handling\n   For ICMP message translation between IPv4 and IPv6, IVI\
    \ follows the\n   ICMP/ICMPv6 message correspondence as defined in SIIT [RFC2765].\n\
    \   Note that the ICMP message may be generated by an intermediate router\n  \
    \ whose IPv6 address does not belong to IVIG6(i).  Since ICMP\n   translation\
    \ is important to the path MTU discovery and\n   troubleshooting, the IPv4 representation\
    \ of the non-IVIG6 addresses\n   in the ICMP packets is required.  In the current\
    \ IVI prototype, a\n   small IPv4 address block is used to identify the non-IVIG6\
    \ addresses.\n   This prevents translated ICMP messages from being discarded due\
    \ to\n   unknown or private IP sources.\n   The IETF standard for IP/ICMP translation\
    \ is defined in [RFC6145],\n   which contains updated technical specifications.\n"
- title: 3.7.  Application Layer Gateway
  contents:
  - "3.7.  Application Layer Gateway\n   Due to the features of 1-to-1 address mapping\
    \ and stateless\n   operation, IVI can support most of the existing applications,\
    \ such as\n   HTTP, Secure SHell (SSH), and Telnet.  However, some applications\
    \ are\n   designed such that IP addresses are used to identify application-\n\
    \   layer entities (e.g., FTP).  In these cases, an Application Layer\n   Gateway\
    \ (ALG) is unavoidable, and it can be integrated into the IVI\n   translator.\n\
    \   The discussion of the use of ALGs is in [RFC6144].\n"
- title: 4.  The IVI DNS Configuration
  contents:
  - "4.  The IVI DNS Configuration\n   The DNS [RFC1035] service is important for\
    \ the IVI mechanism.\n"
- title: 4.1.  DNS Configuration for the IVI6(i) Addresses
  contents:
  - "4.1.  DNS Configuration for the IVI6(i) Addresses\n   For providing authoritative\
    \ DNS service for IVI4(i) and IVI6(i), each\n   host name will have both an A\
    \ record and a AAAA record pointing to\n   IVI4(i) and IVI6(i), respectively.\
    \  Note that the same name always\n   points to a unique host, which is an IVI6(i)\
    \ host, and it has IVI4(i)\n   representation via the IVI translator.\n"
- title: 4.2.  DNS Service for the IVIG6(i) Addresses
  contents:
  - "4.2.  DNS Service for the IVIG6(i) Addresses\n   For resolving the IPv6 form\
    \ of the global IPv4 space (IVIG6(i)), each\n   ISP must provide customized IVI\
    \ DNS service for the IVI6(i) hosts.\n   The IVI DNS server MUST be deployed in\
    \ a dual-stack environment.\n   When the IVI6(i) host queries a AAAA record for\
    \ an IPv4-only domain\n   name, the IVI DNS will query the AAAA record first.\
    \  If the AAAA\n   record does not exist, the IVI DNS will query the A record\
    \ and map it\n   to IVIG6(i), and return a AAAA record to the IVI6(i) host.  The\n\
    \   technical specifications for this process are defined in [RFC6147].\n"
- title: 5.  The Advanced IVI Translation Functions
  contents:
  - '5.  The Advanced IVI Translation Functions

    '
- title: 5.1.  IVI Multicast
  contents:
  - "5.1.  IVI Multicast\n   The IVI mechanism can support IPv4/IPv6 communication\
    \ of Protocol\n   Independent Multicast - Source-Specific Multicast (PIM-SSM)\
    \ [RFC5771]\n   [RFC3569] [RFC4607].\n   There will be 2^24 group addresses for\
    \ IPv4 SSM.  The corresponding\n   IPv6 SSM group addresses can be defined as\
    \ shown in the following\n   figure.\n          -------------------------------------------------------\n\
    \          IPv4 Group Address          IPv6 Group Address\n          -------------------------------------------------------\n\
    \          232.0.0.0/8                 ff3e:0:0:0:0:0:f000:0000/96\n         \
    \ 232.255.255.255/8           ff3e:0:0:0:0:0:f0ff:ffff/96\n          -------------------------------------------------------\n\
    \               Figure 8: IVI Multicast Group Address Mapping\n   The source address\
    \ in IPv6 MUST be IVI6(i) in order to perform\n   Reverse Path Forwarding (RPF)\
    \ as required by PIM - Sparse Mode\n   (PIM-SM).\n   The interoperation of PIM-SM\
    \ for IPv4 and IPv6 address families can\n   either be implemented via an Application\
    \ Layer Gateway or via static\n   joins based on IGMPv3 and Multicast Listener\
    \ Discovery Version 2\n   (MLDv2) in IPv4 and IPv6, respectively.\n"
- title: 6.  IVI Host Operation
  contents:
  - '6.  IVI Host Operation

    '
- title: 6.1.  IVI Address Assignment
  contents:
  - "6.1.  IVI Address Assignment\n   The IVI6 address has a special format (for example,\
    \ IVI4=192.0.2.1/32\n   and IVI6=2001:db8:ffc0:2:100::/72); therefore, stateless\
    \ IPv6 address\n   autoconfiguration cannot be used.  However, the IVI6 can be\
    \ assigned\n   to the IPv6 end system via manual configuration or stateful\n \
    \  autoconfiguration via DHCPv6.\n   o  For the manual configuration, the host\
    \ needs to configure the IVI6\n      address and the corresponding prefix length,\
    \ as well as the\n      default gateway address and the DNS resolver address.\n\
    \   o  For the DHCPv6 configuration, the DHCPv6 will assign the IVI6\n      address\
    \ and the DNS resolver address to the host.  The router in\n      the subnet should\
    \ enable router advertisement (RA), since the\n      default gateway is learned\
    \ from the router.\n"
- title: 6.2.  IPv6 Source Address Selection
  contents:
  - "6.2.  IPv6 Source Address Selection\n   Since each IPv6 host may have multiple\
    \ addresses, it is important for\n   the host to use an IVI6(i) address to reach\
    \ the global IPv4 networks.\n   The short-term workaround is to use IVI6(i) as\
    \ the default source\n   IPv6 address of the host, defined as the policy table\
    \ in [RFC3484].\n   The long-term solution requires that the application should\
    \ be able\n   to select the source addresses for different services.\n"
- title: 7.  The IVI Implementation
  contents:
  - '7.  The IVI Implementation

    '
- title: 7.1.  Linux Implementation
  contents:
  - "7.1.  Linux Implementation\n   An implementation of IVI exists for the Linux\
    \ operating system.  The\n   source code can be downloaded from [LINUX].  An example\
    \ of how to\n   configure an IVI deployment is shown in Appendix A.\n   The IVI\
    \ DNS source code for the IVIG6(i) addresses presented in this\n   document can\
    \ be downloaded from [DNS].\n"
- title: 7.2.  Testing Environment
  contents:
  - "7.2.  Testing Environment\n   The IVI translator based on the Linux implementation\
    \ has been\n   deployed between [CERNET] (IPv4-only) and [CNGI-CERNET2] (IPv6-only)\n\
    \   since March 2006.  The pure-IPv6 web servers using IVI6 addresses\n   [2001:250:ffca:2672:100::]\
    \ behind the IVI translator can be accessed\n   by the IPv4 hosts [TEST4], and\
    \ also by the global IPv6 hosts [TEST6].\n   The pure-IPv6 clients using IVI6\
    \ addresses behind the IVI translator\n   can access IPv4 servers on the IPv4\
    \ Internet.\n   Two traceroute results are presented in Appendix B to show the\n\
    \   address mapping of the IVI mechanism.\n   IVI6 manual configuration and DHCPv6\
    \ configuration of the IPv6 end\n   system have also been tested with success.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   This document presents the prefix-specific and\
    \ stateless address\n   mapping mechanism (IVI) for the IPv4/IPv6 coexistence\
    \ and transition.\n   The IPv4 security and IPv6 security issues should be addressed\
    \ by\n   related documents of each address family and are not included in this\n\
    \   document.\n   However, there are several issues that need special considerations,\n\
    \   specifically (a) IPsec and its NAT traversal, (b) DNS Security\n   Extensions\
    \ (DNSSEC), and (c) firewall filter rules.\n   o  IPsec and its NAT traversal:\
    \ Since the IVI scheme maintains end-\n      to-end address transparency, IPsec\
    \ could work with or without NAT\n      traversal techniques.\n   o  DNSSEC: DNSSEC\
    \ verification will be terminated at the IVI DNS for\n      the \"A record to\
    \ AAAA record\" translation.  It would be fine to\n      have a translation in\
    \ a local IVI DNS server that also verifies\n      DNSSEC, or in the host, if\
    \ the host both translates the DNS entry\n      and again verifies DNSSEC validity.\
    \  The DNSSEC discussion is in\n      [RFC6147].\n   o  Firewall filter rules:\
    \ Since the IVI scheme maintains the end-to-\n      end address transparency and\
    \ there is a unique mapping between\n      IPv4 and IPv6 addresses, the firewall\
    \ filter rule can therefore be\n      implemented for one address family, or mapped\
    \ to another address\n      family and implemented in that address family.  However,\
    \ the\n      current IPv6 routers may only support the access-list or uRPF\n \
    \     (unicast Reverse Path Forwarding) for the prefix length shorter\n      than\
    \ /64; there may a practical constraint for the construction of\n      such rules.\n\
    \   Except for the issues discussed above, we have not found special\n   security\
    \ problems introduced by the IVI translation in our\n   experiments.\n"
- title: 9.  Contributors
  contents:
  - "9.  Contributors\n   The authors would like to acknowledge the following contributors\
    \ in\n   the different phases of the IVI development: Ang Li, Yuncheng Zhu,\n\
    \   Junxiu Lu, Yu Zhai, Wentao Shang, Weifeng Jiang, and Bizheng Fu.\n   The authors\
    \ would like to acknowledge the following contributors, who\n   provided helpful\
    \ inputs concerning the IVI concept: Bill Manning,\n   David Ward, Elwyn Davies,\
    \ Lixia Zhang, Jun Murai, Fred Baker, Jari\n   Arkko, Ralph Droms, Tony Hain,\
    \ and Kevin Yin.\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   The authors thank the following for funding support:\
    \ the CERNET,\n   CNGI-CERNET2, CNGI Research and Development, and the China \"\
    863\" and\n   China \"973\" projects.\n"
- title: Appendix A.  The IVI Translator Configuration Example
  contents:
  - "Appendix A.  The IVI Translator Configuration Example\n   #!/bin/bash\n   # open\
    \ forwarding\n   echo 1 > /proc/sys/net/ipv6/conf/all/forwarding\n   echo 1 >\
    \ /proc/sys/net/ipv4/conf/all/forwarding\n   # config route for IVI6 = 2001:db8:ffc0:2:0::/64,\n\
    \   #                  IVI4 = 192.0.2.0/24\n   # configure IPv6 route\n   route\
    \ add -A inet6 2001:db8:ffc0:2:0::/64 \\\n   gw 2001:da8:aaae::206 dev eth0\n\
    \   # config mapping for      source-PF = 2001:db8::/32\n   # config mapping for\
    \ destination-PF = 2001:db8::/32\n   # for each mapping, a unique pseudo-address\
    \ (10.0.0.x/8)\n   # should be configured.\n   # ip addr add 10.0.0.1/8 dev eth0\n\
    \   # IPv4-to-IPv6 mapping: multiple mappings can be done via multiple\n   # commands.\n\
    \   # mroute IVI4-network IVI4-mask pseudo-address interface \\\n   # source-PF\
    \ destination-PF\n   /root/mroute 192.0.2.0 255.255.255.0 10.0.0.1 \\\n   eth0\
    \ 2001:db8:: 2001:db8::\n   # IPv6-to-IPv4 mapping\n   # mroute6 destination-PF\
    \ destination-PF-pref-len\n   /root/mroute6 2001:db8:ff00:: 40\n             \
    \       Figure 9: IVI Configuration Example\n"
- title: Appendix B.  The traceroute Results
  contents:
  - "Appendix B.  The traceroute Results\n   ivitraceroute 202.38.108.2\n   1  202.112.0.65\
    \ 6 ms 2 ms 1 ms\n   2  202.112.53.73 4 ms 6 ms 12 ms\n   3  202.112.53.178 1\
    \ ms 1 ms 1 ms\n   4  202.112.61.242 1 ms 1 ms 1 ms\n   5  192.0.2.100 1 ms 1\
    \ ms 1 ms\n   6  192.0.2.102 1 ms 1 ms 1 ms\n   7  192.0.2.103 2 ms 2 ms 2 ms\n\
    \   8  192.0.2.104 2 ms 2 ms 2 ms\n   9  192.0.2.105 4 ms 4 ms 3 ms\n   10 202.38.108.2\
    \ 2 ms 3 ms 3 ms\n                     Figure 10: ivitraceroute Results\n   Note\
    \ that the non-IVIG6 addresses are mapped to IPv4 document address\n   192.0.2.0/24.\n\
    \   ivitraceroute6 www.mit.edu\n   src_ivi4=202.38.97.205 src_ivi6=2001:da8:ffca:2661:cd00::\n\
    \   dst_host=www.mit.edu\n   dst_ip4=18.7.22.83 dst_ivig=2001:da8:ff12:716:5300::\n\
    \   traceroute to 2001:da8:ff12:716:5300:: (2001:da8:ff12:716:5300::),\n   30\
    \ hops max, 40 byte packets to not_ivi\n   1  2001:da8:ff0a:0:100::      0.304\
    \ ms 0.262 ms 0.190 ms\n      10.0.0.1\n   2  2001:da8:ffca:7023:fe00::  0.589\
    \ ms * *\n      202.112.35.254\n   3  2001:da8:ffca:7035:4900::  1.660 ms 1.538\
    \ ms 1.905 ms\n      202.112.53.73\n   4  2001:da8:ffca:703d:9e00::  0.371 ms\
    \ 0.530 ms 0.459 ms\n      202.112.61.158\n   5  2001:da8:ffca:7035:1200::  0.776\
    \ ms 0.704 ms 0.690 ms\n      202.112.53.18\n   6  2001:da8:ffcb:b5c2:7d00:: \
    \ 89.382 ms 89.076 ms 89.240 ms\n      203.181.194.125\n   7  2001:da8:ffc0:cb74:9100::\
    \  204.623 ms 204.685 ms 204.494 ms\n      192.203.116.145\n   8  2001:da8:ffcf:e7f0:8300::\
    \  249.842 ms 249.945 ms 250.329 ms\n      207.231.240.131\n   9  2001:da8:ff40:391c:2d00::\
    \  249.891 ms 249.936 ms 250.090 ms\n      64.57.28.45\n   10 2001:da8:ff40:391c:2a00::\
    \  259.030 ms 259.110 ms 259.086 ms\n      64.57.28.42\n   11 2001:da8:ff40:391c:700::\
    \   264.247 ms 264.399 ms 264.364 ms\n      64.57.28.7\n   12 2001:da8:ff40:391c:a00::\
    \   271.014 ms 269.572 ms 269.692 ms\n      64.57.28.10\n   13 2001:da8:ffc0:559:dd00::\
    \   274.300 ms 274.483 ms 274.316 ms\n      192.5.89.221\n   14 2001:da8:ffc0:559:ed00::\
    \   274.534 ms 274.367 ms 274.517 ms\n      192.5.89.237\n   15 * * *\n   16 2001:da8:ff12:a800:1900::\
    \  276.032 ms 275.876 ms 276.090 ms\n      18.168.0.25\n   17 2001:da8:ff12:716:5300::\
    \   276.285 ms 276.370 ms 276.214 ms\n      18.7.22.83\n                     Figure\
    \ 11: ivitraceroute6 Results\n   Note that all of the IPv4 addresses can be mapped\
    \ to prefix-specific\n   IPv6 addresses (for example, 18.7.22.83 is mapped to\
    \ 2001:da8:ff12:\n   716:5300::).\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC0768]  Postel, J., \"User Datagram Protocol\"\
    , STD 6, RFC 768,\n              August 1980.\n   [RFC0791]  Postel, J., \"Internet\
    \ Protocol\", STD 5, RFC 791,\n              September 1981.\n   [RFC0793]  Postel,\
    \ J., \"Transmission Control Protocol\", STD 7,\n              RFC 793, September\
    \ 1981.\n   [RFC1035]  Mockapetris, P., \"Domain names - implementation and\n\
    \              specification\", STD 13, RFC 1035, November 1987.\n   [RFC2119]\
    \  Bradner, S., \"Key words for use in RFCs to Indicate\n              Requirement\
    \ Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2460]  Deering, S. and R. Hinden,\
    \ \"Internet Protocol, Version 6\n              (IPv6) Specification\", RFC 2460,\
    \ December 1998.\n   [RFC2765]  Nordmark, E., \"Stateless IP/ICMP Translation\
    \ Algorithm\n              (SIIT)\", RFC 2765, February 2000.\n   [RFC2766]  Tsirtsis,\
    \ G. and P. Srisuresh, \"Network Address\n              Translation - Protocol\
    \ Translation (NAT-PT)\", RFC 2766,\n              February 2000.\n   [RFC3056]\
    \  Carpenter, B. and K. Moore, \"Connection of IPv6 Domains\n              via\
    \ IPv4 Clouds\", RFC 3056, February 2001.\n   [RFC4213]  Nordmark, E. and R. Gilligan,\
    \ \"Basic Transition Mechanisms\n              for IPv6 Hosts and Routers\", RFC\
    \ 4213, October 2005.\n   [RFC4291]  Hinden, R. and S. Deering, \"IP Version 6\
    \ Addressing\n              Architecture\", RFC 4291, February 2006.\n   [RFC4380]\
    \  Huitema, C., \"Teredo: Tunneling IPv6 over UDP through\n              Network\
    \ Address Translations (NATs)\", RFC 4380,\n              February 2006.\n   [RFC4607]\
    \  Holbrook, H. and B. Cain, \"Source-Specific Multicast for\n              IP\"\
    , RFC 4607, August 2006.\n   [RFC4632]  Fuller, V. and T. Li, \"Classless Inter-domain\
    \ Routing\n              (CIDR): The Internet Address Assignment and Aggregation\n\
    \              Plan\", BCP 122, RFC 4632, August 2006.\n   [RFC5214]  Templin,\
    \ F., Gleeson, T., and D. Thaler, \"Intra-Site\n              Automatic Tunnel\
    \ Addressing Protocol (ISATAP)\", RFC 5214,\n              March 2008.\n   [RFC5771]\
    \  Cotton, M., Vegoda, L., and D. Meyer, \"IANA Guidelines for\n             \
    \ IPv4 Multicast Address Assignments\", BCP 51, RFC 5771,\n              March\
    \ 2010.\n   [RFC6052]  Bao, C., Huitema, C., Bagnulo, M., Boucadair, M., and X.\n\
    \              Li, \"IPv6 Addressing of IPv4/IPv6 Translators\", RFC 6052,\n \
    \             October 2010.\n   [RFC6144]  Baker, F., Li, X., Bao, C., and K.\
    \ Yin, \"Framework for\n              IPv4/IPv6 Translation\", RFC 6144, April\
    \ 2011.\n   [RFC6145]  Li, X., Bao, C., and F. Baker, \"IP/ICMP Translation\n\
    \              Algorithm\", RFC 6145, April 2011.\n   [RFC6146]  Bagnulo, M.,\
    \ Matthews, P., and I. van Beijnum, \"Stateful\n              NAT64: Network Address\
    \ and Protocol Translation from IPv6\n              Clients to IPv4 Servers\"\
    , RFC 6146, April 2011.\n   [RFC6147]  Bagnulo, M., Sullivan, A., Matthews, P.,\
    \ and I. van\n              Beijnum, \"DNS64: DNS Extensions for Network Address\n\
    \              Translation from IPv6 Clients to IPv4 Servers\", RFC 6147,\n  \
    \            April 2011.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [BEHAVE]   \"The IETF Behave Working Group\
    \ Charter:\n              http://datatracker.ietf.org/wg/behave/charter/\".\n\
    \   [CERNET]   \"CERNET Homepage:\n              http://www.edu.cn/english_1369/index.shtml\"\
    .\n   [CNGI-CERNET2]\n              \"CNGI-CERNET2 Homepage:\n              http://www.cernet2.edu.cn/index_en.htm\"\
    .\n   [COUNT]    \"IPv4 address countdown: http://penrose.uk6x.com/\".\n   [DNS]\
    \      \"Source Code of the IVI DNS\n              http://www.ivi2.org/IVI/src/ividns-0.1.tar.gz/\"\
    .\n   [LINUX]    \"Source Code of the IVI implementation for Linux:\n        \
    \      http://linux.ivi2.org/impl/\".\n   [RFC2775]  Carpenter, B., \"Internet\
    \ Transparency\", RFC 2775,\n              February 2000.\n   [RFC3142]  Hagino,\
    \ J. and K. Yamamoto, \"An IPv6-to-IPv4 Transport\n              Relay Translator\"\
    , RFC 3142, June 2001.\n   [RFC3484]  Draves, R., \"Default Address Selection\
    \ for Internet\n              Protocol version 6 (IPv6)\", RFC 3484, February\
    \ 2003.\n   [RFC3569]  Bhattacharyya, S., Ed., \"An Overview of Source-Specific\n\
    \              Multicast (SSM)\", RFC 3569, July 2003.\n   [RFC4966]  Aoun, C.\
    \ and E. Davies, \"Reasons to Move the Network\n              Address Translator\
    \ - Protocol Translator (NAT-PT) to\n              Historic Status\", RFC 4966,\
    \ July 2007.\n   [TEST4]    \"Test homepage for the IVI4(i): http://test4.ivi2.org\"\
    .\n   [TEST6]    \"Test homepage for the IVI6(i): http://test6.ivi2.org\",\n \
    \             Available using IPv6 only.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Xing Li\n   CERNET Center/Tsinghua University\n   Room\
    \ 225, Main Building, Tsinghua University\n   Beijing  100084\n   CN\n   Phone:\
    \ +86 10-62785983\n   EMail: xing@cernet.edu.cn\n   Congxiao Bao\n   CERNET Center/Tsinghua\
    \ University\n   Room 225, Main Building, Tsinghua University\n   Beijing  100084\n\
    \   CN\n   Phone: +86 10-62785983\n   EMail: congxiao@cernet.edu.cn\n   Maoke\
    \ Chen\n   CERNET Center/Tsinghua University\n   Room 225, Main Building, Tsinghua\
    \ University\n   Beijing  100084\n   CN\n   Phone: +86 10-62785983\n   EMail:\
    \ fibrib@gmail.com\n   Hong Zhang\n   CERNET Center/Tsinghua University\n   Room\
    \ 225, Main Building, Tsinghua University\n   Beijing  100084\n   CN\n   Phone:\
    \ +86 10-62785983\n   EMail: neilzh@gmail.com\n   Jianping Wu\n   CERNET Center/Tsinghua\
    \ University\n   Room 225, Main Building, Tsinghua University\n   Beijing  100084\n\
    \   CN\n   Phone: +86 10-62785983\n   EMail: jianping@cernet.edu.cn\n"
