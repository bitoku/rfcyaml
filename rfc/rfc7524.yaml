- contents:
  - "                 Inter-Area Point-to-Multipoint (P2MP)\n                 Segmented
    Label Switched Paths (LSPs)\n"
  title: __initial_text__
- contents:
  - "Abstract\n   This document describes procedures for building inter-area point-to-\n
    \  multipoint (P2MP) segmented service label switched paths (LSPs) by\n   partitioning
    such LSPs into intra-area segments and using BGP as the\n   inter-area routing
    and Label Distribution Protocol (LDP).  Within\n   each IGP area, the intra-area
    segments are either carried over intra-\n   area P2MP LSPs, using P2MP LSP hierarchy,
    or instantiated using\n   ingress replication.  The intra-area P2MP LSPs may be
    signaled using\n   P2MP RSVP-TE or P2MP multipoint LDP (mLDP).  If ingress replication\n
    \  is used within an IGP area, then (multipoint-to-point) LDP LSPs or\n   (point-to-point)
    RSVP-TE LSPs may be used in the IGP area.  The\n   applications/services that
    use such inter-area service LSPs may be\n   BGP Multicast VPN, Virtual Private
    LAN Service (VPLS) multicast, or\n   global table multicast over MPLS.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    5741.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc7524.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2015 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1. Introduction ....................................................5\n
    \  2. Specification of Requirements ...................................5\n   3.
    General Assumptions and Terminology .............................6\n   4. Inter-Area
    P2MP Segmented Next-Hop Extended Community ...........7\n   5. Discovering P2MP
    FEC of Inter-Area P2MP Service LSP .............8\n      5.1. BGP MVPN ...................................................8\n
    \          5.1.1. Routes Originated by PE or ASBR .....................9\n           5.1.2.
    Routes Re-advertised by PE or ASBR ..................9\n           5.1.3. Inter-Area
    Routes ...................................9\n      5.2. LDP VPLS with BGP Auto-discovery
    or BGP VPLS ..............10\n           5.2.1. Routes Originated by PE or ASBR
    ....................10\n           5.2.2. Routes Re-advertised by PE or ASBR .................11\n
    \          5.2.3. Inter-Area Routes ..................................11\n      5.3.
    Global Table Multicast over MPLS ..........................12\n   6. Egress PE/ASBR
    Signaling Procedures ............................13\n      6.1. Determining the
    Upstream ABR/PE/ASBR (Upstream Node) ......13\n           6.1.1. Upstream Node
    for MVPN or VPLS .....................13\n           6.1.2. Upstream Node for
    Global Table Multicast ...........14\n      6.2. Originating a Leaf A-D Route
    ..............................15\n           6.2.1. Leaf A-D Route for MVPN and
    VPLS ...................15\n           6.2.2. Leaf A-D Route for Global Table
    Multicast ..........15\n           6.2.3. Constructing the Rest of the Leaf A-D
    Route ........17\n      6.3. PIM-SM in ASM Mode for Global Table Multicast .............18\n
    \          6.3.1. Option 1 ...........................................18\n                  6.3.1.1.
    Originating Source Active A-D Routes ......18\n                  6.3.1.2. Receiving
    BGP Source Active A-D\n                           Route by PE ...............................19\n
    \                 6.3.1.3. Handling (S,G,rpt) State ..................19\n           6.3.2.
    Option 2 ...........................................19\n                  6.3.2.1.
    Originating Source Active A-D Routes ......19\n                  6.3.2.2. Receiving
    BGP Source Active A-D Route .....20\n                  6.3.2.3. Pruning Sources
    Off the Shared Tree .......20\n                  6.3.2.4. More on Handling (S,G,rpt)
    State ..........21\n   7. Egress ABR Procedures ..........................................21\n
    \     7.1. Handling Leaf A-D Route on Egress ABR .....................21\n      7.2.
    P2MP LSP as the Intra-Area LSP in the Egress Area .........23\n           7.2.1.
    Received Leaf A-D Route Is for MVPN or VPLS ........23\n           7.2.2. Received
    Leaf A-D Route Is for Global Table\n                  Multicast ..........................................24\n
    \                 7.2.2.1. Global Table Multicast and S-PMSI\n                           A-D
    Routes ................................24\n                  7.2.2.2. Global Table
    Multicast and\n                           Wildcard S-PMSI A-D Routes ................25\n
    \          7.2.3. Global Table Multicast and the Expected\n                  Upstream
    Node ......................................25\n           7.2.4. P2MP LDP LSP
    as the Intra-Area P2MP LSP ............26\n           7.2.5. P2MP RSVP-TE LSP
    as the Intra-Area P2MP LSP ........26\n      7.3. Ingress Replication in the Egress
    Area ....................26\n   8. Ingress ABR Procedures .........................................27\n
    \     8.1. P2MP LSP as the Intra-Area LSP in the Backbone Area .......27\n      8.2.
    Ingress Replication in the Backbone Area ..................27\n   9. Ingress PE/ASBR
    Procedures .....................................28\n      9.1. P2MP LSP as the
    Intra-Area LSP in the Ingress Area ........28\n      9.2. Ingress Replication
    in the Ingress Area ...................29\n   10. Common Tunnel Type in the Ingress
    and Egress Areas ............29\n   11. Placement of Ingress and Egress PEs ...........................30\n
    \  12. MVPN with Virtual Hub-and-Spoke ...............................31\n   13.
    Data Plane ....................................................31\n      13.1.
    Data Plane Procedures on ABRs ............................31\n      13.2. Data
    Plane Procedures on Egress PEs ......................32\n      13.3. Data Plane
    Procedures on Ingress PEs .....................33\n      13.4. Data Plane Procedures
    on Transit Routers .................33\n   14. Support for Inter-Area Transport
    LSPs .........................33\n      14.1. \"Transport Tunnel\" Tunnel Type
    ...........................33\n      14.2. Discovering Leaves of the Inter-Area
    P2MP Service LSP ....34\n      14.3. Discovering P2MP FEC of P2MP Transport LSP
    ...............34\n      14.4. Egress PE Procedures for P2MP Transport LSP ..............35\n
    \     14.5. ABRs and Ingress PE Procedures for P2MP Transport LSP ....35\n      14.6.
    Discussion ...............................................36\n   15. IANA Considerations
    ...........................................38\n   16. Security Considerations
    .......................................38\n   17. References ....................................................39\n
    \     17.1. Normative References .....................................39\n      17.2.
    Informative References ...................................41\n   Acknowledgements
    ..................................................41\n   Authors' Addresses ................................................42\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   This document describes procedures for building inter-area
    point-to-\n   multipoint (P2MP) segmented service LSPs by partitioning such LSPs\n
    \  into intra-area segments and using BGP as the inter-area routing and\n   label
    distribution protocol.  Within each IGP area, the intra-area\n   segments are
    either carried over intra-area P2MP LSPs, potentially\n   using P2MP LSP hierarchy,
    or instantiated using ingress replication.\n   The intra-area P2MP LSPs may be
    signaled using P2MP RSVP-TE [RFC4875]\n   or P2MP mLDP [RFC6388].  If ingress
    replication is used in an IGP\n   area, then (multipoint-to-point) LDP LSPs [RFC5036]
    or (point-to-\n   point) RSVP-TE LSPs [RFC3209] may be used within the IGP area.
    \ The\n   applications/services that use such inter-area service LSPs may be\n
    \  BGP Multicast VPN (BGP MVPN), VPLS multicast, or global table\n   multicast
    over MPLS.\n   The primary use case of such segmented P2MP service LSPs is when
    the\n   Provider Edge (PE) routers are in different areas but in the same\n   Autonomous
    System (AS) and thousands or more of PEs require P2MP\n   connectivity.  For instance,
    this may be the case when MPLS is pushed\n   further to the metro edge and the
    metros are in different IGP areas.\n   This may also be the case when a service
    provider's network comprises\n   multiple IGP areas in a single AS, with a large
    number of PEs.\n   Seamless MPLS is the industry term to address this case\n   [SEAMLESS-MPLS].
    \ Thus, one of the applicabilities of this document\n   is that it describes the
    multicast procedures for seamless MPLS.\n   It is to be noted that [RFC6514] and
    [RFC7117] already specify\n   procedures for building segmented inter-AS P2MP
    service LSPs.  This\n   document complements those procedures, as it extends the
    segmented\n   P2MP LSP model such that it is applicable to inter-area P2MP service\n
    \  LSPs as well.  In fact, an inter-AS deployment could use inter-AS\n   segmented
    P2MP LSPs as specified in [RFC6514] and [RFC7117] where\n   each intra-AS segment
    is constructed using inter-area segmented P2MP\n   LSPs, as specified in this
    document.\n"
  title: 1.  Introduction
- contents:
  - "2.  Specification of Requirements\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\",
    \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\",
    and \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n"
  title: 2.  Specification of Requirements
- contents:
  - "3.  General Assumptions and Terminology\n   The reader is assumed to be familiar
    with MVPN procedures and\n   terminology [RFC6513] [RFC6514] and VPLS procedures
    and terminology\n   [RFC7117].\n   This document allows Area Border Routers (ABRs),
    acting as Route\n   Reflectors, to follow the procedures specified in [SEAMLESS-MPLS]\n
    \  when handling the BGP Next Hop of the routes to the PEs.\n   Specifically,
    when reflecting such routes from the non-backbone areas\n   into the backbone
    area, the ABRs MUST set the BGP Next Hop to their\n   own loopback addresses (next-hop-self),
    while when reflecting such\n   routes from the backbone area into the non-backbone
    areas, the ABRs\n   SHOULD NOT change the BGP Next Hop addresses (next-hop-unchanged).\n
    \  While this document allows ABRs to follow the procedures specified in\n   [SEAMLESS-MPLS],
    procedures specified in this document are applicable\n   even when ABRs do not
    follow the procedures specified in\n   [SEAMLESS-MPLS].\n   This document specifies
    a particular way of supporting the global\n   table multicast service.  Although
    the document refers to this\n   approach simply as \"global table multicast\",
    it does not mean to\n   imply that there are no other ways to support global table
    multicast.\n   An alternative way to support global table multicast is to use
    the\n   procedures for MVPN that are specified in [RFC6514] and in this\n   document.
    \ That alternative is discussed in more detail in [GTM].\n   However, that alternative
    is not further considered in the current\n   document.\n   This document assumes
    that, in the context of global table multicast,\n   ABRs do not carry routes to
    the destinations external to their own\n   AS.  Furthermore, in the context of
    global table multicast, this\n   document assumes that an Autonomous System Border
    Router (ASBR), when\n   re-advertising into Internal BGP (IBGP) routes received
    from an\n   external speaker (received via External BGP (EBGP)), may not change\n
    \  the BGP Next Hop to self.\n   Within an AS, a P2MP service LSP is partitioned
    into three segments:\n   ingress area segment, backbone area segment, and egress
    area segment.\n   Within each area, a segment is carried over an intra-area P2MP
    LSP or\n   instantiated using ingress replication.\n   When intra-area P2MP LSPs
    are used to instantiate the intra-area\n   segments, there could be either 1:1
    or n:1 mapping between intra-area\n   segments of the inter-area P2MP service
    LSP and a given intra-area\n   P2MP LSP.  The latter is realized using P2MP LSP
    hierarchy with\n   upstream-assigned labels [RFC5331].  For simplicity of presentation,\n
    \  we assume that P2MP LSP hierarchy is used even with 1:1 mapping; in\n   which
    case, an Implicit NULL is used as the upstream-assigned label.\n   When intra-area
    segments of the inter-area P2MP service LSP are\n   instantiated using ingress
    replication, multiple such segments may be\n   carried in the same P2P RSVP-TE
    or MP2P LDP LSP.  This can be\n   achieved using downstream-assigned labels alone.\n
    \  The ingress area segment of a P2MP service LSP is rooted at a PE (or\n   at
    an ASBR in the case where the P2MP service LSP spans multiple\n   ASes).  The
    leaves of this segment are other PEs/ASBRs and ABRs in\n   the same area as the
    root PE.\n   The backbone area segment is rooted at either an ABR that is\n   connected
    to the ingress area (ingress ABR), an ASBR if the ASBR is\n   present in the backbone
    area, or a PE if the PE is present in the\n   backbone area.  The backbone area
    segment has its leaf ABRs that are\n   connected to the egress area(s) or PEs
    in the backbone area, or ASBRs\n   in the backbone area.\n   The egress area segment
    is rooted at an ABR in the egress area\n   (egress ABR), and has its leaf PEs
    and ASBR in that egress area (the\n   latter covers the case where the P2MP service
    LSP spans multiple\n   ASes).  For a given P2MP service LSP, note that there may
    be more\n   than one backbone segment, each rooted at its own ingress ABR, and\n
    \  more than one egress area segment, each rooted at its own egress ABR.\n   This
    document uses the term \"A-D routes\" for \"auto-discovery routes\".\n   An implementation
    that supports this document MUST implement the\n   procedures described in the
    following sections to support inter-area\n   P2MP segmented service LSPs.\n"
  title: 3.  General Assumptions and Terminology
- contents:
  - "4.  Inter-Area P2MP Segmented Next-Hop Extended Community\n   This document defines
    a new Transitive IPv4-Address-Specific Extended\n   Community Sub-Type: \"Inter-Area
    P2MP Next-Hop\".  This document also\n   defines a new BGP Transitive IPv6-Address-Specific
    Extended Community\n   Sub-Type: \"Inter-Area P2MP Next-Hop\".\n   A PE, an ABR,
    or an ASBR constructs the Inter-Area P2MP Segmented\n   Next-Hop Extended Community
    as follows:\n   -  The Global Administrator field MUST be set to an IP address
    of the\n      PE, ABR, or ASBR that originates or advertises the route carrying\n
    \     the P2MP Next-Hop Extended Community.  For example this address\n      may
    be the loopback address or the PE, ABR, or ASBR that\n      advertises the route.\n
    \  -  The Local Administrator field MUST be set to 0.\n      If the Global Administrator
    field is an IPv4 address, the\n      IPv4-Address-Specific Extended Community
    is used; if the Global\n      Administrator field is an IPv6 address, the IPv6-Address-Specific\n
    \     Extended Community is used.\n      The detailed usage of these Extended
    Communities is described in\n      the following sections.\n"
  title: 4.  Inter-Area P2MP Segmented Next-Hop Extended Community
- contents:
  - "5.  Discovering P2MP FEC of Inter-Area P2MP Service LSP\n   Each inter-area P2MP
    service LSP has associated with it P2MP\n   Forwarding Equivalence Class (FEC).
    \ The egress PEs need to learn\n   this P2MP FEC in order to initiate the creation
    of the egress area\n   segment of the P2MP inter-area service LSP.\n   The P2MP
    FEC of the inter-area P2MP LSP is learned by the egress PEs\n   either by configuration
    or based on the application-specific\n   procedures (e.g., MVPN-specific procedures
    or VPLS-specific\n   procedures).\n"
  - contents:
    - "5.1.  BGP MVPN\n   Egress PEs and/or ASBRs discover the P2MP FEC of the service
      LSPs\n   used by BGP MVPN using the Inclusive Provider Multicast Service\n   Interface
      (I-PMSI) or Selective PMSI (S-PMSI) A-D routes that are\n   originated by the
      ingress PEs or ASBRs following the procedures of\n   [RFC6514], along with modifications
      as described in this document.\n   The Network Layer Reachability Information
      (NLRI) of such routes\n   encodes the P2MP FEC.\n   The procedures in this document
      require that at least one ABR in a\n   given IGP area act as a Route Reflector
      for MVPN A-D routes.  Such a\n   Router Reflector is responsible for re-advertising
      MVPN A-D routes\n   across area boundaries.  When re-advertising these routes
      across area\n   boundaries, this Route Reflector MUST follow the procedures
      in this\n   document.  Note that such a Route Reflector may also re-advertise\n
      \  MVPN A-D routes within the same area; in which case, it follows the\n   plain
      BGP Route Reflector procedures [RFC4456].\n"
    - contents:
      - "5.1.1.  Routes Originated by PE or ASBR\n   The \"Leaf Information Required\"
        flag MUST be set in the PMSI Tunnel\n   attribute carried in the MVPN A-D
        routes, when originated by the\n   ingress PEs or ASBRs, except for the case
        where (a) as a matter of\n   policy (provisioned on the ingress PEs or ASBRs)
        there is no\n   aggregation of ingress area segments of the service LSPs and
        (b) mLDP\n   is used as the protocol to establish intra-area transport LSPs
        in the\n   ingress area.  Before any Leaf A-D route is advertised by a PE
        or ABR\n   in the same area, as described in the following sections, an\n
        \  I-PMSI/S-PMSI A-D route is advertised either with an explicit Tunnel\n
        \  Type and Tunnel Identifier in the PMSI Tunnel attribute, if the\n   Tunnel
        Identifier has already been assigned, or with a special Tunnel\n   Type of
        \"No tunnel information present\" otherwise.\n"
      title: 5.1.1.  Routes Originated by PE or ASBR
    - contents:
      - "5.1.2.  Routes Re-advertised by PE or ASBR\n   When the I-PMSI/S-PMSI A-D
        routes are re-advertised by an ingress\n   ABR, the \"Leaf Information Required\"
        flag MUST be set in the PMSI\n   Tunnel attribute present in the routes, except
        for the case where\n   (a) as a matter of policy (provisioned on the ingress
        ABR) there is\n   no aggregation of backbone area segments of the service
        LSPs and\n   (b) mLDP is used as the protocol to establish intra-area transport\n
        \  LSPs in the backbone area.  Likewise, when the I-PMSI/S-PMSI A-D\n   routes
        are re-advertised by an egress ABR, the \"Leaf Information\n   Required\"
        flag MUST be set in the PMSI Tunnel attribute present in\n   the routes, except
        for the case where (a) as a matter of policy\n   (provisioned on the egress
        ABR) there is no aggregation of egress\n   area segments of the service LSPs
        and (b) mLDP is used as the\n   protocol to establish intra-area transport
        LSPs in the egress area.\n   Note that the procedures in the above paragraph
        apply when intra-area\n   segments are realized by either intra-area P2MP
        LSPs or by ingress\n   replication.\n"
      title: 5.1.2.  Routes Re-advertised by PE or ASBR
    - contents:
      - "5.1.3.  Inter-Area Routes\n   When BGP MVPN I-PMSI or S-PMSI A-D routes are
        advertised or\n   propagated to signal inter-area P2MP service LSPs, to indicate
        that\n   these LSPs should be segmented using the procedures specified in
        this\n   document, these routes MUST carry the Inter-Area P2MP Segmented\n
        \  Next-Hop Extended Community.  This Extended Community MUST be\n   included
        in the I-PMSI/S-PMSI A-D route by the PE that originates\n   such a route,
        or an ASBR that re-advertises such a route into its own\n   AS.  The Global
        Administrator field in this Extended Community MUST\n   be set to the advertising
        PE or ASBR's IP address.  This Extended\n   Community MUST also be included
        by ABRs as they re-advertise such\n   routes.  An ABR MUST set the Global
        Administrator field of the Inter-\n   Area P2MP Segmented Next-Hop Extended
        Community to its own IP\n   address.  Presence of this Extended Community
        in the I-PMSI/S-PMSI\n   A-D routes indicates to ABRs and PEs/ASBRs that they
        have to follow\n   the procedures in this document when these procedures differ
        from\n   those in [RFC6514].\n   If an ASBR receives from an IBGP peer an
        I-PMSI or S-PMSI A-D route\n   that carries the Inter-Area P2MP Segmented
        Next-Hop Extended\n   Community, then before re-advertising this route to
        an EBGP peer, the\n   ASBR SHOULD remove this Extended Community from the
        route.\n   Suppose an ASBR receives an I-PMSI/S-PMSI A-D route from an EBGP\n
        \  peer, and this route carries the Inter-Area P2MP Segmented Next-Hop\n   Extended
        Community.  If the inter-area P2MP service LSP signaled by\n   this route
        should not be segmented, then before re-advertising this\n   route to its
        IBGP peers, the ASBR MUST remove this Extended Community\n   from the route.\n
        \  To avoid requiring ABRs to participate in the propagation of\n   C-multicast
        routes, this document requires that ABRs MUST NOT modify\n   the BGP Next
        Hop when re-advertising Inter-AS I-PMSI A-D routes.  For\n   consistency,
        this document requires that ABRs MUST NOT modify the BGP\n   Next Hop when
        re-advertising either Intra-AS or Inter-AS\n   I-PMSI/S-PMSI A-D routes.  The
        egress PEs may advertise the\n   C-multicast routes to RRs that are different
        than the ABRs.  However,\n   ABRs can still be configured to be the Route
        Reflectors for\n   C-multicast routes; in which case, they will participate
        in the\n   propagation of C-multicast routes.\n"
      title: 5.1.3.  Inter-Area Routes
    title: 5.1.  BGP MVPN
  - contents:
    - "5.2.  LDP VPLS with BGP Auto-discovery or BGP VPLS\n   Egress PEs discover
      the P2MP FEC of the service LSPs used by VPLS,\n   using the VPLS A-D routes
      that are originated by the ingress PEs\n   [RFC4761] [RFC6074] or VPLS S-PMSI
      A-D routes that are originated by\n   the ingress PEs [RFC7117].  The NLRI of
      such routes encodes the\n   P2MP FEC.\n"
    - contents:
      - "5.2.1.  Routes Originated by PE or ASBR\n   The \"Leaf Information Required\"
        flag MUST be set in the PMSI Tunnel\n   attribute carried in the VPLS A-D
        routes or VPLS S-PMSI A-D routes,\n   when originated by the ingress PEs or
        ASBRs, except for the case\n   where (a) as a matter of policy (provisioned
        on the ingress PEs or\n   ASBRs) there is no aggregation of ingress area segments
        of the\n   service LSPs and (b) mLDP is used as the protocol to establish
        intra-\n   area transport LSPs in the ingress area.  Before any Leaf A-D route\n
        \  is advertised by a PE or ABR in the same area, as described in the\n   following
        sections, a VPLS/S-PMSI A-D route is advertised either with\n   an explicit
        Tunnel Type and Tunnel Identifier in the PMSI Tunnel\n   attribute, if the
        Tunnel Identifier has already been assigned, or\n   with a special Tunnel
        Type of \"No tunnel information present\"\n   otherwise.\n"
      title: 5.2.1.  Routes Originated by PE or ASBR
    - contents:
      - "5.2.2.  Routes Re-advertised by PE or ASBR\n   When the VPLS/S-PMSI A-D routes
        are re-advertised by an ingress ABR,\n   the \"Leaf Information Required\"
        flag MUST be set in the PMSI Tunnel\n   attribute present in the routes, except
        for the case where (a) as a\n   matter of policy (provisioned on the ingress
        ABR) there is no\n   aggregation of backbone area segments of the service
        LSPs and (b)\n   mLDP is used as the protocol to establish intra-area transport
        LSPs\n   in the backbone area.  Likewise, when the VPLS/S-PMSI A-D routes
        are\n   re-advertised by an egress ABR, the \"Leaf Information Required\"
        flag\n   MUST be set in the PMSI Tunnel attribute present in the routes,\n
        \  except for the case where (a) as a matter of policy (provisioned on\n   the
        egress ABR) there is no aggregation of egress area segments of\n   the service
        LSPs and (b) mLDP is used as the protocol to establish\n   intra-area transport
        LSPs in the egress area.\n"
      title: 5.2.2.  Routes Re-advertised by PE or ASBR
    - contents:
      - "5.2.3.  Inter-Area Routes\n   When VPLS A-D routes or S-PMSI A-D routes are
        advertised or\n   propagated to signal inter-area P2MP service LSPs, to indicate
        that\n   these LSPs should be segmented using the procedures specified in
        this\n   document, these routes MUST carry the Inter-Area P2MP Segmented\n
        \  Next-Hop Extended Community.  This Extended Community MUST be\n   included
        in the A-D route by the PE or ASBR that originates such a\n   route, and the
        Global Administrator field MUST be set to the\n   advertising PE or ASBR's
        IP address.  This Extended Community MUST\n   also be included by ABRs as
        they re-advertise such routes.  An ABR\n   MUST set the Global Administrator
        field of the Inter-Area P2MP\n   Segmented Next-Hop Extended Community to
        its own IP address.\n   Presence of this Extended Community in the I-PMSI/S-PMSI
        A-D routes\n   indicates to ABRs and PEs/ASBRs that they have to follow the\n
        \  procedures in this document when these procedures differ from those\n   in
        [RFC7117].\n   Note that the procedures in the above paragraph apply when
        intra-area\n   segments are realized by either intra-area P2MP LSPs or by
        ingress\n   replication.\n   The procedures in this document require that
        at least one ABR in a\n   given area act as a Route Reflector for VPLS A-D
        routes.  Such a\n   Router Reflector is responsible for re-advertising VPLS
        A-D routes\n   across areas boundaries.  When re-advertising these routes
        across\n   areas boundaries, this Route Reflector MUST follow the procedures\n
        \  in this document.  Note that such a Route Reflector may also\n   re-advertise
        VPLS A-D routes within the same area; in which case,\n   it follows plain
        BGP Route Reflector procedures [RFC4456].\n   When re-advertising VPLS A-D
        routes, a Route Reflector MUST NOT\n   modify the BGP Next Hop of these routes.\n"
      title: 5.2.3.  Inter-Area Routes
    title: 5.2.  LDP VPLS with BGP Auto-discovery or BGP VPLS
  - contents:
    - "5.3.  Global Table Multicast over MPLS\n   This section describes how the egress
      PEs discover the P2MP FEC when\n   the application is global table multicast
      over an MPLS-capable\n   infrastructure.  In the rest of the document, we will
      refer to this\n   application as \"global table multicast\".\n   When Protocol
      Independent Multicast - Sparse Mode (PIM-SM) is used\n   for non-bidirectional
      ASM (\"Any Source Multicast\") group addresses,\n   this document refers to
      this as \"PIM-SM in ASM mode\".\n   In the case where global table multicast
      uses PIM-SM in ASM mode, the\n   following assumes that an inter-area P2MP service
      LSP could be used\n   to carry traffic either on a shared (*,G) or a source
      (S,G) tree.\n   An egress PE learns the (S/*,G) of a multicast stream as a result
      of\n   receiving IGMP or PIM messages on one of its IP multicast interfaces.\n
      \  This (S/*,G) forms the P2MP FEC of the inter-area P2MP service LSP.\n   For
      each such P2MP FEC, there MAY exist a distinct inter-area P2MP\n   service LSP,
      or multiple such FECs MAY be carried over a single P2MP\n   service LSP using
      a wildcard (*,*) S-PMSI [RFC6625].\n   Note that this document does not require
      the use of (*,G) inter-area\n   P2MP service LSPs when global table multicast
      uses PIM-SM in ASM\n   mode.  In fact, PIM-SM in ASM mode may be supported entirely
      by using\n   only (S,G) inter-area P2MP service LSPs.\n"
    title: 5.3.  Global Table Multicast over MPLS
  title: 5.  Discovering P2MP FEC of Inter-Area P2MP Service LSP
- contents:
  - "6.  Egress PE/ASBR Signaling Procedures\n   This section describes the egress
    PE/ASBR procedures for constructing\n   segmented inter-area P2MP LSPs.  The procedures
    in this section apply\n   irrespective of whether the egress PE/ASBR is in a leaf
    IGP area, the\n   backbone area, or even in the same IGP area as the ingress PE/ASBR.\n
    \  An egress PE/ASBR applies procedures specified in this section to\n   MVPN
    I-PMSI or S-PMSI A-D routes only if these routes carry the\n   Inter-Area P2MP
    Segmented Next-Hop Extended Community.  An egress PE\n   applies procedures specified
    in this section to VPLS A-D routes or\n   VPLS S-PMSI A-D routes only if these
    routes carry the Inter-Area P2MP\n   Segmented Next-Hop Extended Community.\n
    \  In order to support global table multicast, an egress PE MUST be\n   auto-configured
    to import routes that carry an AS-specific Route\n   Target Extended Community
    ([RFC4360]) with the Global Administrator\n   field set to the AS of the PE and
    the Local Administrator field set\n   to 0.\n   Once an egress PE/ASBR discovers
    the P2MP FEC of an inter-area\n   segmented P2MP service LSP, it MUST propagate
    this P2MP FEC in BGP in\n   order to construct the segmented inter-area P2MP service
    LSP.  This\n   propagation uses BGP Leaf A-D routes.\n"
  - contents:
    - "6.1.  Determining the Upstream ABR/PE/ASBR (Upstream Node)\n   An egress PE/ASBR
      discovers the P2MP FEC of an inter-area P2MP\n   segmented service LSP as described
      in Section 5.  Once the egress\n   PE/ASBR discovers this P2MP FEC, it MUST
      determine the upstream node\n   to reach such a FEC.  If the egress PE/ASBR
      and the ingress PE/ASBR\n   are not in the same area, and the egress PE/ASBR
      is not in the\n   backbone IGP area, then this upstream node would be an egress
      ABR.\n   If the egress PE/ASBR is in the backbone area and the ingress PE/ASBR\n
      \  is not in the backbone area, then this upstream node would be an\n   ingress
      ABR.  If the egress PE/ASBR is in the same area as the\n   ingress PE/ASBR,
      then this upstream node would be the ingress\n   PE/ASBR.\n"
    - contents:
      - "6.1.1.  Upstream Node for MVPN or VPLS\n   If the application is MVPN or
        VPLS, then the upstream node's IP\n   address is the IP address determined
        from the Global Administrator\n   field of the Inter-Area P2MP Segmented Next-Hop
        Extended Community.\n   As described in Section 5, this Extended Community
        MUST be carried in\n   the MVPN or VPLS A-D route from which the P2MP FEC
        of the inter-area\n   P2MP segmented service LSP is determined.\n"
      title: 6.1.1.  Upstream Node for MVPN or VPLS
    - contents:
      - "6.1.2.  Upstream Node for Global Table Multicast\n   If the application is
        global table multicast, then the unicast routes\n   to multicast sources/RPs
        SHOULD carry the \"VRF Route Import\" Extended\n   Community [RFC6514] where
        the IP address in the Global Administrator\n   field is set to the IP address
        of the PE or ASBR advertising the\n   unicast route.  The Local Administrator
        field of this Extended\n   Community MUST be set to 0 (note that this is in
        contrast to the case\n   of MVPN, where the Local Administrator field carries
        a non-zero value\n   that identifies a particular VRF on a PE that originates
        VPN-IP\n   routes).  If it is not desirable to advertise the VRF Route Import\n
        \  Extended Community in unicast routes, then unicast routes to\n   multicast
        sources/RPs MUST be advertised using the multicast\n   Subsequent Address
        Family Identifier (SAFI), i.e., SAFI 2, and such\n   routes MUST carry the
        VRF Route Import Extended Community.\n   Further, if the application is global
        table multicast, then the BGP\n   unicast routes that advertise the routes
        to the IP addresses of\n   PEs/ASBRs/ABRs SHOULD carry the Inter-Area P2MP
        Segmented Next-Hop\n   Extended Community.  The IP address in the Global Administrator
        field\n   of this Extended Community MUST be set to the IP address of the
        PE,\n   ASBR, or ABR advertising the unicast route.  The Local Administrator\n
        \  field of this Extended Community MUST be set to 0.  If it is not\n   desirable
        to advertise the Inter-Area P2MP Segmented Next-Hop\n   Extended Community
        in BGP unicast routes, then the BGP unicast routes\n   to the IP addresses
        of PEs/ASBRs/ABRs MUST be advertised using the\n   multicast SAFI, i.e., SAFI
        2, and such routes MUST carry the Inter-\n   Area P2MP Segmented Next-Hop
        Extended Community.  The procedures for\n   handling the BGP Next Hop attribute
        of SAFI 2 routes are the same as\n   those of handling regular unicast routes
        and MAY follow\n   [SEAMLESS-MPLS].\n   If the application is global table
        multicast, then in order to\n   determine the upstream node address, the egress
        PE first determines\n   the ingress PE.  In order to determine the ingress
        PE, the egress PE\n   determines the best route to reach the S/RP.  The ingress
        PE address\n   is the IP address determined from the Global Administrator
        field of\n   the VRF Route Import Extended Community that is carried in this\n
        \  route.  Then, the egress PE finds the best unicast route to reach the\n
        \  ingress PE.  The upstream node address is the IP address determined\n   from
        the Global Administrator field of the Inter-Area P2MP Segmented\n   Next-Hop
        Extended Community that is carried in this route.\n"
      title: 6.1.2.  Upstream Node for Global Table Multicast
    title: 6.1.  Determining the Upstream ABR/PE/ASBR (Upstream Node)
  - contents:
    - "6.2.  Originating a Leaf A-D Route\n   If the P2MP FEC was derived from an
      MVPN or VPLS A-D route, and if\n   the route carries a PMSI Tunnel attribute
      with the \"Leaf Information\n   Required\" flag set, then the egress PE MUST
      originate a Leaf A-D\n   route.\n   If the P2MP FEC was derived from a global
      table multicast (S/*,G),\n   and the upstream node's address is not the same
      as the egress PE,\n   then the egress PE MUST originate a Leaf A-D route.\n"
    - contents:
      - "6.2.1.  Leaf A-D Route for MVPN and VPLS\n   If the P2MP FEC was derived
        from MVPN or VPLS A-D routes, then the\n   Route Key field of the Leaf A-D
        route contains the NLRI of the A-D\n   route from which the P2MP FEC was derived.
        \ This follows procedures\n   for constructing Leaf A-D routes described in
        [RFC6514] [RFC7117].\n"
      title: 6.2.1.  Leaf A-D Route for MVPN and VPLS
    - contents:
      - "6.2.2.  Leaf A-D Route for Global Table Multicast\n   If the application
        is global table multicast, then the MCAST-VPN NLRI\n   of the Leaf A-D route
        is constructed as follows.\n   The Route Key field of the MCAST-VPN NLRI has
        the following format:\n                   +-----------------------------------+\n
        \                  |      RD   (8 octets)              |\n                   +-----------------------------------+\n
        \                  | Multicast Source Length (1 octet) |\n                   +-----------------------------------+\n
        \                  |  Multicast Source (Variable)      |\n                   +-----------------------------------+\n
        \                  |  Multicast Group Length (1 octet) |\n                   +-----------------------------------+\n
        \                  |  Multicast Group   (Variable)     |\n                   +-----------------------------------+\n
        \                  |  Ingress PE's IP Address          |\n                   +-----------------------------------+\n
        \  RD is set to 0 for (S,G) state and all ones for (*,G) state,\n   Multicast
        Source is set to S for (S,G) state or RP for (*,G) state,\n   Multicast Group
        is set to G, and Multicast Source Length and\n   Multicast Group Length are
        set to either 4 or 16 (depending on\n   whether S/RP and G are IPv4 or IPv6
        addresses).\n   The Ingress PE's IP address is determined as described in\n
        \  Section 6.1.\n   The Originating Router's IP Address field of the MCAST-VPN
        NLRI is\n   set to the address of the local PE (the PE that originates the\n
        \  route).\n   Thus, the entire MCAST-VPN NLRI of the route has the following\n
        \  format:\n                   +-----------------------------------+\n                   |
        \     Route Type = 4 (1 octet)     |\n                   +-----------------------------------+\n
        \                  |         Length (1 octet)          |\n                   +-----------------------------------+\n
        \                  |          RD   (8 octets)          |\n                   +-----------------------------------+\n
        \                  | Multicast Source Length (1 octet) |\n                   +-----------------------------------+\n
        \                  |  Multicast Source (Variable)      |\n                   +-----------------------------------+\n
        \                  |  Multicast Group Length (1 octet) |\n                   +-----------------------------------+\n
        \                  |  Multicast Group   (Variable)     |\n                   +-----------------------------------+\n
        \                  |  Ingress PE's IP Address          |\n                   +-----------------------------------+\n
        \                  |  Originating Router's IP Address  |\n                   +-----------------------------------+\n
        \  Note that the encoding of the MCAST-VPN NLRI for the Leaf A-D routes\n
        \  used for global table multicast is different from the encoding used\n   by
        the Leaf A-D routes originated in response to S-PMSI or I-PMSI A-D\n   routes.
        \ A router that receives a Leaf A-D route can distinguish\n   between these
        two cases by examining the third octet of the MCAST-VPN\n   NLRI of the route.
        \ If the value of this octet is 0x01, 0x02, or\n   0x03, then this Leaf A-D
        route was originated in response to an\n   S-PMSI or I-PMSI A-D route.  If
        the value of this octet is either\n   0x00 or 0xff, and octets 3 through 10
        contain either all 0x00 or all\n   0xff, then this is a Leaf A-D route used
        for global table multicast.\n   When the PE deletes (S,G)/(*,G) state that
        was created as a result of\n   receiving PIM or IGMP messages on one of its
        IP multicast interfaces,\n   if the PE previously originated a Leaf A-D route
        for that state, the\n   PE SHOULD withdraw that route.\n   An AS with an IPv4
        network may provide global table multicast service\n   for customers that
        use IPv6, and an AS with an IPv6 network may\n   provide global table multicast
        service for customers that use IPv4.\n   Therefore, the address family of
        the Ingress PE's IP Address field\n   and the Originating Router's IP Address
        field in the Leaf A-D routes\n   used for global table multicast MUST NOT
        be inferred from the AFI\n   field of the associated MP_REACH_NLRI/MP_UNREACH_NLRI
        attribute of\n   these routes.  The address family is determined from the
        length of\n   the address (a length of 4 octets for IPv4 addresses or a length
        of\n   16 octets for IPv6 addresses).\n   For example, if an AS with an IPv4
        network is providing IPv6\n   multicast service to a customer, the Ingress
        PE's IP Address and\n   Originating Router's IP Address in the Leaf A-D routes
        used for IPv6\n   global table multicast will be a 4-octet IPv4 address, even
        though\n   the AFI of those routes will have the value 2.\n   Note that the
        Ingress PE's IP Address and the Originating Router's IP\n   Address must be
        either both IPv4 or both IPv6 addresses; thus, they\n   must be of the same
        length.  Since the two variable-length fields\n   (Multicast Source and Multicast
        Group) in the Leaf A-D routes used\n   for global table multicast have their
        own Length field, from these\n   two Length fields, and the Length field of
        the MCAST-VPN NLRI, one\n   can compute the length of the Ingress PE's IP
        Address field and the\n   Originating Router's IP Address field.  If the computed
        length of\n   these fields is neither 4 nor 16, the MP_REACH_NLRI attribute
        MUST be\n   considered to be \"incorrect\", and MUST be handled as specified
        in\n   Section 7 of [RFC4760].\n"
      title: 6.2.2.  Leaf A-D Route for Global Table Multicast
    - contents:
      - "6.2.3.  Constructing the Rest of the Leaf A-D Route\n   The Next Hop field
        of the MP_REACH_NLRI attribute of the route SHOULD\n   be set to the same
        IP address as the one carried in the Originating\n   Router's IP Address field
        of the route.\n   When ingress replication is used to instantiate the egress
        area\n   segment, the Leaf A-D route MUST carry a downstream-assigned label
        in\n   the PMSI Tunnel attribute where the PMSI Tunnel Type is set to\n   ingress
        replication.  A PE MUST assign a distinct MPLS label for each\n   Leaf A-D
        route originated by the PE.\n   To constrain distribution of this route, the
        originating PE\n   constructs an IP-based Route Target Extended Community
        by placing the\n   IP address of the upstream node in the Global Administrator
        field of\n   the Extended Community, with the Local Administrator field of
        this\n   community set to 0.  The originating PE then adds this Route Target\n
        \  Extended Community to this Leaf A-D route.  The upstream node's\n   address
        is determined as specified in Section 6.1.\n   The PE then advertises this
        route to the upstream node.\n"
      title: 6.2.3.  Constructing the Rest of the Leaf A-D Route
    title: 6.2.  Originating a Leaf A-D Route
  - contents:
    - "6.3.  PIM-SM in ASM Mode for Global Table Multicast\n   This specification
      allows two options for supporting global table\n   multicast that are initiated
      using PIM-SM in ASM mode.  The first\n   option does not carry IP multicast
      shared trees over the MPLS\n   network.  The second option does carry shared
      trees over the MPLS\n   network and provides support for switching from shared
      trees to\n   source trees.\n"
    - contents:
      - "6.3.1.  Option 1\n   This option does not carry IP multicast shared trees
        over the MPLS\n   network.  Therefore, when an (egress) PE creates (*,G) state
        (as a\n   result of receiving PIM or IGMP messages on one of its IP multicast\n
        \  interfaces), the PE does not propagate this state using Leaf A-D\n   routes.\n"
      - contents:
        - "6.3.1.1.  Originating Source Active A-D Routes\n   Whenever an RP that
          is co-located with a PE discovers a new multicast\n   source (as a result
          of receiving PIM Register or MSDP messages), the\n   RP/PE SHOULD originate
          a BGP Source Active A-D route.  Similarly,\n   whenever, as a result of
          receiving MSDP messages, a PE that is not\n   configured as an RP discovers
          a new multicast source, the PE SHOULD\n   originate a BGP Source Active
          A-D route.  The BGP Source Active A-D\n   route carries a single MCAST-VPN
          NLRI constructed as follows:\n   + The RD in this NLRI is set to 0.\n   +
          The Multicast Source field MUST be set to S.  The Multicast Source\n     Length
          field is set appropriately to reflect this.\n   + The Multicast Group field
          MUST be set to G.  The Multicast Group\n     Length field is set appropriately
          to reflect this.\n   The Route Target of this Source Active A-D route is
          an AS-specific\n   Route Target Extended Community with the Global Administrator
          field\n   set to the AS of the advertising RP/PE and the Local Administrator\n
          \  field set to 0.\n   To constrain distribution of the Source Active A-D
          route to the AS of\n   the advertising RP, this route SHOULD carry the NO_EXPORT
          Community\n   ([RFC1997]).\n   Using the normal BGP procedures, the Source
          Active A-D route is\n   propagated to all other PEs within the AS.\n   Whenever
          the RP/PE discovers that the source is no longer active, the\n   RP MUST
          withdraw the Source Active A-D route, if such a route was\n   previously
          advertised by the RP.\n"
        title: 6.3.1.1.  Originating Source Active A-D Routes
      - contents:
        - "6.3.1.2.  Receiving BGP Source Active A-D Route by PE\n   As a result of
          receiving PIM or IGMP messages on one of its IP\n   multicast interfaces,
          when an egress PE creates in its Tree\n   Information Base (TIB) a new (*,G)
          entry with a non-empty outgoing\n   interface list that contains one or
          more IP multicast interfaces, the\n   PE MUST check if it has any Source
          Active A-D routes for that G.  If\n   there is such a route, S of that route
          is reachable via an MPLS\n   interface, and the PE does not have (S,G) state
          in its TIB for (S,G)\n   carried in the route, then the PE originates a
          Leaf A-D route\n   carrying that (S,G), as specified in Section 6.2.2.\n
          \  When an egress PE receives a new Source Active A-D route, the PE MUST\n
          \  check if its TIB contains an (*,G) entry with the same G as carried\n
          \  in the Source Active A-D route.  If such an entry is found, S is\n   reachable
          via an MPLS interface, and the PE does not have (S,G) state\n   in its TIB
          for (S,G) carried in the route, then the PE originates a\n   Leaf A-D route
          carrying that (S,G), as specified in Section 6.2.2.\n"
        title: 6.3.1.2.  Receiving BGP Source Active A-D Route by PE
      - contents:
        - "6.3.1.3.  Handling (S,G,rpt) State\n   Creation and deletion of (S,G,rpt)
          state on a PE that resulted from\n   receiving PIM messages on one of its
          IP multicast interfaces do not\n   result in any BGP actions by the PE.\n"
        title: 6.3.1.3.  Handling (S,G,rpt) State
      title: 6.3.1.  Option 1
    - contents:
      - "6.3.2.  Option 2\n   This option does carry IP multicast shared trees over
        the MPLS\n   network.  Therefore, when an egress PE creates (*,G) state (as
        a\n   result of receiving PIM or IGMP messages on one of its IP multicast\n
        \  interfaces), the PE does propagate this state using Leaf A-D routes.\n"
      - contents:
        - "6.3.2.1.  Originating Source Active A-D Routes\n   Whenever a PE creates
          an (S,G) state as a result of receiving Leaf\n   A-D routes associated with
          the global table multicast service, if S\n   is reachable via one of the
          IP multicast-capable interfaces, and the\n   PE determines that G is in
          the PIM-SM in ASM mode range, the PE MUST\n   originate a BGP Source Active
          A-D route.  The route carries a single\n   MCAST-VPN NLRI constructed as
          follows:\n   + The RD in this NLRI is set to 0.\n   + The Multicast Source
          field MUST be set to S.  The Multicast Source\n     Length field is set
          appropriately to reflect this.\n   + The Multicast Group field MUST be set
          to G.  The Multicast Group\n     Length field is set appropriately to reflect
          this.\n   The Route Target of this Source Active A-D route is an AS-specific\n
          \  Route Target Extended Community with the Global Administrator field\n
          \  set to the AS of the advertising PE and the Local Administrator field\n
          \  set to 0.\n   To constrain distribution of the Source Active A-D route
          to the AS of\n   the advertising PE, this route SHOULD carry the NO_EXPORT
          Community\n   [RFC1997].\n   Using the normal BGP procedures, the Source
          Active A-D route is\n   propagated to all other PEs within the AS.\n   Whenever
          the PE deletes the (S,G) state that was previously created\n   as a result
          of receiving a Leaf A-D route for (S,G), the PE that\n   deletes the state
          MUST also withdraw the Source Active A-D route, if\n   such a route was
          advertised when the state was created.\n"
        title: 6.3.2.1.  Originating Source Active A-D Routes
      - contents:
        - "6.3.2.2.  Receiving BGP Source Active A-D Route\n   Procedures for receiving
          BGP Source Active A-D routes are the same as\n   with Option 1.\n"
        title: 6.3.2.2.  Receiving BGP Source Active A-D Route
      - contents:
        - "6.3.2.3.  Pruning Sources Off the Shared Tree\n   After receiving a new
          Source Active A-D route for (S,G), if a PE\n   determines that (a) it has
          the (*,G) entry in its TIB, (b) the\n   incoming interface (iif) list for
          that entry contains one of the IP\n   interfaces, (c) an MPLS LSP is in
          the outgoing interface (oif) list\n   for that entry, and (d) the PE does
          not originate a Leaf A-D route\n   for (S,G), then the PE MUST transition
          the (S,G,rpt) downstream state\n   to the Prune state.  [Conceptually the
          PIM state machine on the PE\n   will act \"as if\" it had received Prune(S,G,Rpt)
          from some other PE,\n   without actually having received one.]  Depending
          on the (S,G,rpt)\n   state on the iifs, this may result in the PE using
          PIM procedures to\n   prune S off the Shared (*,G) tree.\n   Transitioning
          the state machine to the Prune state SHOULD be done\n   after a delay that
          is controlled by a timer.  The value of the timer\n   MUST be configurable.
          \ The purpose of this timer is to ensure that S\n   is not pruned off the
          shared tree until all PEs have had time to\n   receive the Source Active
          A-D route for (S,G).\n   The PE MUST keep the (S,G,rpt) downstream state
          machine in the Prune\n   state for as long as (a) the outgoing interface
          list (oif) for (*,G)\n   contains an MPLS LSP, (b) the PE has at least one
          Source Active A-D\n   route for (S,G), and (c) the PE does not originate
          the Leaf A-D route\n   for (S,G).  Once any of these conditions become no
          longer valid, the\n   PE MUST transition the (S,G,rpt) downstream state
          machine to the\n   NoInfo state.\n   Note that, except for the scenario
          described in the first paragraph\n   of this section, in all scenarios relying
          solely on PIM procedures on\n   the PE is sufficient to ensure the correct
          behavior when pruning\n   sources off the shared tree.\n"
        title: 6.3.2.3.  Pruning Sources Off the Shared Tree
      - contents:
        - "6.3.2.4.  More on Handling (S,G,rpt) State\n   Creation and deletion of
          (S,G,rpt) state on a PE that resulted from\n   receiving PIM messages on
          one of its IP multicast interfaces do not\n   result in any BGP actions
          by the PE.\n"
        title: 6.3.2.4.  More on Handling (S,G,rpt) State
      title: 6.3.2.  Option 2
    title: 6.3.  PIM-SM in ASM Mode for Global Table Multicast
  title: 6.  Egress PE/ASBR Signaling Procedures
- contents:
  - "7.  Egress ABR Procedures\n   This section describes the egress ABR procedures
    for constructing\n   segmented inter-area P2MP LSPs.\n"
  - contents:
    - "7.1.  Handling Leaf A-D Route on Egress ABR\n   When an egress ABR receives
      a Leaf A-D route and the Route Target\n   Extended Community carried by the
      route contains the IP address of\n   this ABR, the following procedures will
      be executed.\n   If the value of the third octet of the MCAST-VPN NLRI of the
      received\n   Leaf A-D route is either 0x01, 0x02, or 0x03, this indicates that
      the\n   Leaf A-D route was originated in response to an S-PMSI or I-PMSI A-D\n
      \  route (see Section 6.2.2).  In this case, the egress ABR MUST find an\n   S-PMSI
      or I-PMSI route whose NLRI has the same value as the Route Key\n   field of
      the received Leaf A-D route.  If such a matching route is\n   found, then the
      Leaf A-D route MUST be accepted.  If the Leaf A-D\n   route is accepted and
      if it is the first Leaf A-D route update for\n   the Route Key field in the
      route, or the withdrawal of the last Leaf\n   A-D route for the Route Key field,
      then the following procedures will\n   be executed.\n   If the RD of the received
      Leaf A-D route is set to all zeros or all\n   ones, then the received Leaf A-D
      route is for the global table\n   multicast service.\n   If the received Leaf
      A-D route is the first Leaf A-D route update for\n   the Route Key field carried
      in the route, then the egress ABR\n   originates a Leaf A-D route, whose MCAST-VPN
      NLRI is constructed as\n   follows.\n   The Route Key field of the MCAST-VPN
      NLRI is the same as the Route\n   Key field of the MCAST-VPN NLRI of the received
      Leaf A-D route.  The\n   Originating Router's IP Address field of the MCAST-VPN
      NLRI is set to\n   the address of the local ABR (the ABR that originates the
      route).\n   The Next Hop field of the MP_REACH_NLRI attribute of the route SHOULD\n
      \  be set to the same IP address as the one carried in the Originating\n   Router's
      IP Address field of the route.\n   To constrain distribution of this route,
      the originating egress ABR\n   constructs an IP-based Route Target Extended
      Community by placing the\n   IP address of the upstream node in the Global Administrator
      field of\n   the Extended Community, with the Local Administrator field of this\n
      \  Extended Community set to 0, and sets the Extended Communities\n   attribute
      of this Leaf A-D route to that Extended Community.\n   The upstream node's IP
      address is the IP address determined from the\n   Global Administrator field
      of the Inter-Area P2MP Segmented Next-Hop\n   Extended Community, where this
      Extended Community is obtained as\n   follows.  When the Leaf A-D route is for
      MVPN or VPLS, this Extended\n   Community is the one carried in the I-PMSI/S-PMSI
      A-D route that\n   matches the Leaf A-D route.  When the Leaf A-D route is for
      global\n   table multicast, this Extended Community is the one carried in the\n
      \  best unicast route to the Ingress PE.  The Ingress PE address is\n   determined
      from the received Leaf A-D route.  The best unicast route\n   MUST first be
      determined from multicast SAFI, i.e., SAFI 2 routes, if\n   present.\n   The
      ABR then advertises this Leaf A-D route to the upstream node in\n   the backbone
      area.\n   Mechanisms specified in [RFC4684] for constrained BGP route\n   distribution
      can be used along with this specification to ensure that\n   only the needed
      PE/ABR will have to process a said Leaf A-D route.\n   When ingress replication
      is used to instantiate the backbone area\n   segment, the Leaf A-D route originated
      by the egress ABR MUST carry a\n   downstream-assigned label in the PMSI Tunnel
      attribute where the\n   Tunnel Type is set to ingress replication.  The ABR
      MUST assign a\n   distinct MPLS label for each Leaf A-D route that it originates.\n
      \  In order to support global table multicast, an egress ABR MUST auto-\n   configure
      an import AS-based Route Target Extended Community with the\n   Global Administrator
      field set to the AS of the ABR and the Local\n   Administrator field set to
      0.\n   If the received Leaf A-D route is the withdrawal of the last Leaf A-D\n
      \  route for the Route Key carried in the route, then the egress ABR\n   must
      withdraw the Leaf A-D route associated with that Route Key that\n   has been
      previously advertised by the egress ABR in the backbone\n   area.\n"
    title: 7.1.  Handling Leaf A-D Route on Egress ABR
  - contents:
    - "7.2.  P2MP LSP as the Intra-Area LSP in the Egress Area\n   This section describes
      procedures for using intra-area P2MP LSPs in\n   the egress area.  The procedures
      that are common to both P2MP RSVP-TE\n   and P2MP LDP are described first, followed
      by procedures that are\n   specific to the signaling protocol.\n   When P2MP
      LSPs are used as the intra-area LSPs, note that an existing\n   intra-area P2MP
      LSP may be used solely for a particular inter-area\n   P2MP service LSP or for
      other inter-area P2MP service LSPs as well.\n   The choice between the two options
      is purely local to the egress ABR.\n   The first option provides one-to-one
      mapping between inter-area P2MP\n   service LSPs and intra-area P2MP LSPs; the
      second option provides\n   many-to-one mapping, thus allowing the aggregation
      of forwarding\n   state.\n"
    - contents:
      - "7.2.1.  Received Leaf A-D Route Is for MVPN or VPLS\n   If the value of the
        third octet of the MCAST-VPN NLRI of the received\n   Leaf A-D route is either
        0x01, 0x02, or 0x03, this indicates that the\n   Leaf A-D route was originated
        in response to an MVPN or VPLS S-PMSI\n   or I-PMSI A-D route (see Section
        6.2.2).  In this case, the ABR MUST\n   re-advertise in the egress area the
        MVPN/VPLS A-D route that matches\n   the Leaf A-D route to signal the binding
        of the intra-area P2MP LSP\n   to the inter-area P2MP service LSP.  This must
        be done if and only if\n   (a) such a binding hasn't already been advertised
        or (b) the binding\n   has changed.  The re-advertised route MUST carry the
        Inter-area P2MP\n   Segmented Next-Hop Extended Community.\n   The PMSI Tunnel
        attribute of the re-advertised route specifies either\n   an intra-area P2MP
        RSVP-TE LSP or an intra-area P2MP LDP LSP rooted\n   at the ABR and MUST also
        carry an upstream-assigned MPLS label.  The\n   upstream-assigned MPLS label
        MUST be set to Implicit NULL if the\n   mapping between the inter-area P2MP
        service LSP and the intra-area\n   P2MP LSP is one-to-one.  If the mapping
        is many-to-one, the intra-\n   area segment of the inter-area P2MP service
        LSP (referred to as the\n   \"inner\" P2MP LSP) is constructed by nesting
        the inter-area P2MP\n   service LSP in an intra-area P2MP LSP (referred to
        as the \"outer\"\n   intra-area P2MP LSP), by using P2MP LSP hierarchy based
        on upstream-\n   assigned MPLS labels [RFC5332].\n   If segments of multiple
        MVPN or VPLS S-PMSI service LSPs are carried\n   over a given intra-area P2MP
        LSP, each of these segments MUST carry a\n   distinct upstream-assigned label,
        even if all these service LSPs are\n   for (C-S/*,C-G/*)s from the same MVPN/VPLS.
        \ Therefore, an ABR\n   maintains a Label Forwarding Information Base (LFIB)
        state for each\n   such S-PMSI traversing the ABR (that applies to both the
        ingress and\n   the egress ABRs).\n"
      title: 7.2.1.  Received Leaf A-D Route Is for MVPN or VPLS
    - contents:
      - "7.2.2.  Received Leaf A-D Route Is for Global Table Multicast\n   When the
        RD of the received Leaf A-D route is set to all zeros or all\n   ones, this
        is the case of inter-area P2MP service LSP being\n   associated with the global
        table multicast service.  The procedures\n   for this are described below.\n"
      - contents:
        - "7.2.2.1.  Global Table Multicast and S-PMSI A-D Routes\n   This section
          applies only if it is desired to send a particular (S,G)\n   or (*,G) global
          table multicast flow to only those egress PEs that\n   have receivers for
          that multicast flow.\n   If the egress ABR has not previously received (and
          re-advertised) an\n   S-PMSI A-D route for (S,G) or (*,G) that has been
          originated by an\n   ingress PE/ASBR (see Section 9.1), then the egress
          ABR MUST originate\n   an S-PMSI A-D route.  The PMSI Tunnel attribute of
          the route MUST\n   contain the identity of the intra-area P2MP LSP and an
          upstream-\n   assigned MPLS label (although this label may be an Implicit
          NULL --\n   see Section 3).  The RD, Multicast Source Length, Multicast
          Source,\n   Multicast Group Length (1 octet), and Multicast Group fields
          of the\n   NLRI of this route are the same as those of the received Leaf
          A-D\n   route.  The Originating Router's IP Address field in the S-PMSI
          A-D\n   route is the same as the Ingress PE's IP Address field in the\n
          \  received Leaf A-D route.  The Route Target of this route is an AS-\n
          \  specific Route Target Extended Community with the Global\n   Administrator
          field set to the AS of the advertising ABR and the\n   Local Administrator
          field set to 0.  The route MUST carry the Inter-\n   Area P2MP Segmented
          Next-Hop Extended Community.  This Extended\n   Community is constructed
          following the procedures in Section 4.\n   The egress ABR MUST advertise
          this route into the egress area.  PEs\n   in the egress area that participate
          in the global table multicast\n   will import this route based on the Route
          Target carried by the\n   route.\n   A PE in the egress area that originated
          the Leaf A-D route SHOULD\n   join the P2MP LSP advertised in the PMSI Tunnel
          attribute of the\n   S-PMSI A-D route.\n"
        title: 7.2.2.1.  Global Table Multicast and S-PMSI A-D Routes
      - contents:
        - "7.2.2.2.  Global Table Multicast and Wildcard S-PMSI A-D Routes\n   It
          may be desirable for an ingress PE to carry multiple multicast\n   flows
          associated with the global table multicast over the same inter-\n   area
          P2MP service LSP.  This can be achieved using wildcard, i.e.,\n   (*,*)
          S-PMSI A-D routes [RFC6625].  An ingress PE MAY advertise a\n   wildcard
          S-PMSI A-D route as described in Section 9.\n   If the ingress PE originates
          a wildcard S-PMSI A-D route, and the\n   egress ABR receives this route
          from the ingress ABR, then the egress\n   ABR either (a) MUST re-advertise
          this route into the egress area with\n   the PMSI Tunnel attribute containing
          the identifier of the intra-area\n   P2MP LSP in the egress area and an
          upstream-assigned label (note that\n   this label may be an Implicit NULL
          -- see Section 3) assigned to the\n   inter-area wildcard S-PMSI or (b)
          MUST be able to disaggregate\n   traffic carried over the wildcard S-PMSI
          onto the egress area (S,G)\n   or (*,G) S-PMSIs.  The procedures for such
          disaggregation require IP\n   processing on the egress ABRs.\n   If the
          egress ABR advertises a wildcard S-PMSI A-D route into the\n   egress area,
          this route MUST carry an AS-specific Route Target\n   Extended Community
          with the Global Administrator field set to the AS\n   of the advertising
          ABR and the Local Administrator field set to 0.\n   PEs in the egress area
          that participate in the global table multicast\n   will import this route.\n
          \  A PE in the egress area SHOULD join the P2MP LSP advertised in the\n
          \  PMSI Tunnel attribute of the wildcard S-PMSI A-D route if (a) the\n   Originating
          Router's IP Address field in the S-PMSI A-D route has the\n   same value
          as the Ingress PE's IP Address in at least one of the Leaf\n   A-D routes
          for global table multicast originated by the PE and (b)\n   the upstream
          ABR for the Ingress PE's IP address in that Leaf A-D\n   route is the egress
          ABR that advertises the wildcard S-PMSI A-D\n   route.\n"
        title: 7.2.2.2.  Global Table Multicast and Wildcard S-PMSI A-D Routes
      title: 7.2.2.  Received Leaf A-D Route Is for Global Table Multicast
    - contents:
      - "7.2.3.  Global Table Multicast and the Expected Upstream Node\n   If the
        mapping between the inter-area P2MP service LSP for global\n   table multicast
        service and the intra-area P2MP LSP is many-to-one,\n   then an egress PE
        must be able to determine whether a given multicast\n   packet for a particular
        (S,G) is received from the \"expected\"\n   upstream node.  The expected node
        is the node towards which the Leaf\n   A-D route is sent by the egress PE.
        \ Packets received from another\n   upstream node for that (S,G) MUST be dropped.
        \ To allow the egress PE\n   to determine the sender upstream node, the intra-area
        P2MP LSP MUST\n   be signaled with no Penultimate Hop Popping (PHP), when
        the mapping\n   between the inter-area P2MP service LSP for global table multicast\n
        \  service and the intra-area P2MP LSP is many-to-one.\n   Further, the egress
        ABR MUST first push onto the label stack the\n   upstream-assigned label advertised
        in the S-PMSI A-D route, if the\n   label is not the Implicit NULL.\n"
      title: 7.2.3.  Global Table Multicast and the Expected Upstream Node
    - contents:
      - "7.2.4.  P2MP LDP LSP as the Intra-Area P2MP LSP\n   The above procedures
        are sufficient if P2MP LDP LSPs are used as the\n   intra-area P2MP LSP in
        the egress area.\n"
      title: 7.2.4.  P2MP LDP LSP as the Intra-Area P2MP LSP
    - contents:
      - "7.2.5.  P2MP RSVP-TE LSP as the Intra-Area P2MP LSP\n   If P2MP RSVP-TE LSP
        is used as the intra-area LSP in the egress area,\n   then the egress ABR
        can either (a) graft the leaf (whose IP address\n   is specified in the received
        Leaf A-D route) into an existing P2MP\n   LSP rooted at the egress ABR, and
        use that LSP for carrying traffic\n   for the inter-area segmented P2MP service
        LSP or (b) originate a new\n   P2MP LSP to be used for carrying (S,G).\n   When
        the RD of the received Leaf A-D route is all zeros or all ones,\n   the procedures
        are as described in Section 7.2.2.\n   Note also that the SESSION object that
        the egress ABR would use for\n   the intra-area P2MP LSP need not encode the
        P2MP FEC from the\n   received Leaf A-D route.\n"
      title: 7.2.5.  P2MP RSVP-TE LSP as the Intra-Area P2MP LSP
    title: 7.2.  P2MP LSP as the Intra-Area LSP in the Egress Area
  - contents:
    - "7.3.  Ingress Replication in the Egress Area\n   When ingress replication is
      used to instantiate the egress area\n   segment, the Leaf A-D route advertised
      by the egress PE MUST carry a\n   downstream-assigned label in the PMSI Tunnel
      attribute where the\n   Tunnel Type is set to ingress replication.  We will
      call this label\n   the egress PE downstream-assigned label.\n   The egress
      ABR MUST forward packets received from the backbone area\n   intra-area segment,
      for a particular inter-area P2MP LSP, to all the\n   egress PEs from which the
      egress ABR has imported a Leaf A-D route\n   for the inter-area P2MP LSP.  A
      packet to a particular egress PE is\n   encapsulated, by the egress ABR, using
      an MPLS label stack the bottom\n   label of which is the egress PE downstream-assigned
      label.  The top\n   label is the P2P RSVP-TE or the MP2P LDP label to reach
      the\n   egress PE.\n   Note that these procedures ensure that an egress PE always
      receives\n   packets only from the upstream node expected by the egress PE.\n"
    title: 7.3.  Ingress Replication in the Egress Area
  title: 7.  Egress ABR Procedures
- contents:
  - "8.  Ingress ABR Procedures\n   When an ingress ABR receives a Leaf A-D route
    and the Route Target\n   Extended Community carried by the route contains the
    IP address of\n   this ABR, the ingress ABR follows the same procedures as in
    Section\n   7, with egress ABR replaced by ingress ABR, backbone area replaced
    by\n   ingress area, and backbone area segment replaced by ingress area\n   segment.\n
    \  In order to support global table multicast, the ingress ABR MUST be\n   auto-configured
    with an import AS-based Route Target Extended\n   Community whose Global Administrator
    field is set to the AS of the\n   ABR and whose Local Administrator field is set
    to 0.\n"
  - contents:
    - "8.1.  P2MP LSP as the Intra-Area LSP in the Backbone Area\n   The procedures
      for binding the backbone area segment of an inter-area\n   P2MP LSP to the intra-area
      P2MP LSP in the backbone area are the same\n   as in Sections 7 and 7.2, with
      egress PE being replaced by egress\n   ABR, egress ABR being replaced by ingress
      ABR, and egress area being\n   replaced by backbone area.  This applies to the
      inter-area P2MP LSPs\n   associated with either MVPN, VPLS, or global table
      multicast.\n   It is to be noted that, in the case of global table multicast,
      if the\n   backbone area uses wildcard S-PMSI, then the egress area also SHOULD\n
      \  use wildcard S-PMSI for global table multicast, or the egress ABRs\n   MUST
      be able to disaggregate traffic carried over the wildcard S-PMSI\n   onto the
      egress area (S,G) or (*,G) S-PMSIs.  The procedures for such\n   disaggregation
      require IP processing on the egress ABRs.\n"
    title: 8.1.  P2MP LSP as the Intra-Area LSP in the Backbone Area
  - contents:
    - "8.2.  Ingress Replication in the Backbone Area\n   When ingress replication
      is used to instantiate the backbone area\n   segment, the Leaf A-D route advertised
      by the egress ABR MUST carry a\n   downstream-assigned label in the PMSI Tunnel
      attribute where the\n   Tunnel Type is set to ingress replication.  We will
      call this the\n   egress ABR downstream-assigned label.  The egress ABR MUST
      assign a\n   distinct MPLS label for each Leaf A-D route originated by the ABR.\n
      \  The ingress ABR MUST forward packets received from the ingress area\n   intra-area
      segment, for a particular inter-area P2MP LSP, to all the\n   egress ABRs from
      which the ingress ABR has imported a Leaf A-D route\n   for the inter-area P2MP
      LSP.  A packet to a particular egress ABR is\n   encapsulated, by the ingress
      ABR, using an MPLS label stack the\n   bottom label of which is the egress ABR
      downstream-assigned label.\n   The top label is the P2P RSVP-TE or the MP2P
      LDP label to reach the\n   egress ABR.\n"
    title: 8.2.  Ingress Replication in the Backbone Area
  title: 8.  Ingress ABR Procedures
- contents:
  - "9.  Ingress PE/ASBR Procedures\n   This section describes the ingress PE/ASBR
    procedures for\n   constructing segmented inter-area P2MP LSPs.\n   When an ingress
    PE/ASBR receives a Leaf A-D route and the Route\n   Target Extended Community
    carried by the route contains the IP\n   address of this PE/ASBR, the following
    procedures will be executed.\n   If the value of the third octet of the MCAST-VPN
    NLRI of the received\n   Leaf A-D route is either 0x01, 0x02, or 0x03, this indicates
    that the\n   Leaf A-D route was originated in response to an S-PMSI or I-PMSI
    A-D\n   route (see Section 6.2.2).  In this case, the ingress PE/ASBR MUST\n   find
    an S-PMSI or I-PMSI route whose NLRI has the same value as the\n   Route Key field
    of the received Leaf A-D route.  If such a matching\n   route is found, then the
    Leaf A-D route MUST be accepted or else it\n   MUST be discarded.  If the Leaf
    A-D route is accepted, then it MUST\n   be processed as per MVPN or VPLS procedures.\n
    \  If the RD of the received A-D route is set to all zeros or all ones,\n   then
    the received Leaf A-D route is for the global table multicast\n   service.  If
    this is the first Leaf A-D route for the Route Key\n   carried in the route, the
    PIM implementation MUST set its upstream\n   (S/RP,G) state machine to Joined
    state for the (S/RP,G) received via\n   a Leaf A-D route update.  Likewise, if
    this is the withdrawal of the\n   last Leaf A-D route whose Route Key matches
    a particular (S/RP,G)\n   state, the PIM implementation MUST set its upstream
    (S/RP,G) state\n   machine to Prune state for the (S/RP,G).\n"
  - contents:
    - "9.1.  P2MP LSP as the Intra-Area LSP in the Ingress Area\n   If the value of
      the third octet of the MCAST-VPN NLRI of the received\n   Leaf A-D route is
      either 0x01, 0x02, or 0x03 (which indicates that\n   the Leaf A-D route was
      originated in response to an S-PMSI or I-PMSI\n   A-D route), and P2MP LSP is
      used as the intra-area LSP in the ingress\n   area, then the procedures for
      binding the ingress area segment of the\n   inter-area P2MP LSP to the intra-area
      P2MP LSP in the ingress area\n   are the same as in Sections 7 and 7.2.\n   When
      the RD of the received Leaf A-D route is all zeros or all ones,\n   as is the
      case where the inter-area service P2MP LSP is associated\n   with the global
      table multicast service, the ingress PE MAY originate\n   an S-PMSI A-D route
      with the RD, multicast source, and multicast\n   group fields being the same
      as those in the received Leaf A-D route.\n   Further, in the case of global
      table multicast, an ingress PE MAY\n   originate a wildcard S-PMSI A-D route
      as per the procedures in\n   [RFC6625] with the RD set to 0.  This route may
      be originated by the\n   ingress PE based on configuration or based on the import
      of a Leaf\n   A-D route with the RD set to 0.  If an ingress PE originates such
      a\n   route, then the ingress PE MAY decide not to originate (S,G) or (*,G)\n
      \  S-PMSI A-D routes.\n   The wildcard S-PMSI A-D route MUST carry the Inter-Area
      P2MP\n   Segmented Next-Hop Extended Community.  This Extended Community is\n
      \  constructed following the procedures in Section 4.\n   It is to be noted
      that, in the case of global table multicast, if the\n   ingress area uses wildcard
      S-PMSI, then the backbone area also SHOULD\n   use wildcard S-PMSI for global
      table multicast, or the ingress ABRs\n   MUST be able to disaggregate traffic
      carried over the wildcard S-PMSI\n   onto the backbone area (S,G) or (*,G) S-PMSIs.
      \ The procedures for\n   such disaggregation require IP processing on the ingress
      ABRs.\n"
    title: 9.1.  P2MP LSP as the Intra-Area LSP in the Ingress Area
  - contents:
    - "9.2.  Ingress Replication in the Ingress Area\n   When ingress replication
      is used to instantiate the ingress area\n   segment, the Leaf A-D route advertised
      by the ingress ABR MUST carry\n   a downstream-assigned label in the PMSI Tunnel
      attribute where the\n   Tunnel Type is set to ingress replication.  We will
      call this the\n   ingress ABR downstream-assigned label.  The ingress ABR MUST
      assign a\n   distinct MPLS label for each Leaf A-D route originated by the ABR.\n
      \  The ingress PE/ASBR MUST forward packets received from the CE, for a\n   particular
      inter-area P2MP LSP, to all the ingress ABRs from which\n   the ingress PE/ASBR
      has imported a Leaf A-D route for the inter-area\n   P2MP LSP.  A packet to
      a particular ingress ABR is encapsulated, by\n   the ingress PE/ASBR, using
      an MPLS label stack the bottom label of\n   which is the ingress ABR downstream-assigned
      label.  The top label is\n   the P2P RSVP-TE or the MP2P LDP label to reach
      the ingress ABR.\n"
    title: 9.2.  Ingress Replication in the Ingress Area
  title: 9.  Ingress PE/ASBR Procedures
- contents:
  - "10.  Common Tunnel Type in the Ingress and Egress Areas\n   For a given inter-area
    service P2MP LSP, the PE/ASBR that is the root\n   of that LSP controls the type
    of the intra-area P-tunnel that carries\n   the ingress area segment of that LSP.
    \ However, the type of the\n   intra-area P-tunnel that carries the backbone area
    segment of that\n   LSP may be different from the type of the intra-area P-tunnels
    that\n   carry the ingress area segment and the egress area segment of that\n
    \  LSP.  In that situation, if, for a given inter-area P2MP LSP, it is\n   desirable/necessary
    to use the same type of tunnel for the intra-area\n   P-tunnels that carry the
    ingress area segment and for the intra-area\n   P-tunnels that carry the egress
    area segment of that LSP, then the\n   following procedures on the ingress ABR
    and egress ABR provide this\n   functionality.\n   When an ingress ABR re-advertises
    into the backbone area a BGP MVPN\n   I-PMSI, S-PMSI A-D route, or VPLS A-D route,
    the ingress ABR places\n   the PMSI Tunnel attribute of this route into the ATTR_SET
    BGP\n   attribute [RFC6368], adds this attribute to the re-advertised route,\n
    \  and then replaces the original PMSI Tunnel attribute with a new one\n   (note
    that the Tunnel Type of the new attribute may be different from\n   the Tunnel
    Type of the original attribute).\n   When an egress ABR re-advertises into the
    egress area a BGP MVPN\n   I-PMSI or S-PMSI A-D route, or VPLS A-D route, if the
    route carries\n   the ATTR_SET BGP attribute [RFC6368], the ABR sets the Tunnel
    Type of\n   the PMSI Tunnel attribute in the re-advertised route to the Tunnel\n
    \  Type of the PMSI Tunnel attribute carried in the ATTR_SET BGP\n   attribute,
    and removes the ATTR_SET from the route.\n"
  title: 10.  Common Tunnel Type in the Ingress and Egress Areas
- contents:
  - "11.  Placement of Ingress and Egress PEs\n   As described in the earlier sections,
    procedures in this document\n   allow the placement of ingress and egress PEs
    in the backbone area.\n   They also allow the placement of egress PEs in the ingress
    area or\n   the placement of ingress PEs in the egress area.\n   For instance,
    suppose that in the ingress and egress areas, a global\n   table multicast service
    is being provided, and the data is being sent\n   over PIM-based IP/GRE P-tunnels.
    \ Suppose also that it is desired to\n   carry that data over the backbone area
    through MPLS P-tunnels.  This\n   can be done if the ABR connecting the ingress
    area to the backbone\n   follows the procedures that this document specifies for
    ingress PEs\n   providing the global table multicast service, and if the ABR\n
    \  connecting the egress area to the backbone follows the procedures\n   that
    this document specifies for egress PEs providing the global\n   table multicast
    service.\n   If MVPN service is being provided in the ingress and egress areas,\n
    \  with the MVPN data carried in PIM-based IP/GRE P-tunnels, this same\n   technique
    enables the MVPN data to be carried over the backbone in\n   MPLS P-tunnels.  The
    PIM-based IP/GRE P-tunnels in the ingress and\n   egress areas are treated as
    global table multicasts, and the ABRs\n   provide the ingress and egress PE functionality.\n"
  title: 11.  Placement of Ingress and Egress PEs
- contents:
  - "12.  MVPN with Virtual Hub-and-Spoke\n   Procedures described in this document
    could be used in conjunction\n   with the Virtual Hub-and-Spoke procedures [RFC7024].\n
    \  This document does not place any restrictions on the placement of\n   Virtual
    Hubs and Virtual Spokes.\n   In addition to I-PMSI/S-PMSI A-D routes, the procedures
    described in\n   this document are applicable to Associated-V-spoke-only I-PMSI
    A-D\n   routes.\n   In the scenario where a V-hub, as a result of importing an
    S-PMSI A-D\n   route in its VRF, originates an S-PMSI A-D route targeted to its\n
    \  V-spokes (as specified in Section 7.8.2 of [RFC7024]), the V-hub\n   SHOULD
    be able to control via configuration whether the Inter-Area\n   P2MP Segmented
    Next-Hop Extended Community, if present in the\n   received S-PMSI A-D route,
    should also be carried in the originated\n   S-PMSI A-D route.  By default, if
    the received S-PMSI A-D route\n   carries the Inter-Area P2MP Segmented Next-Hop
    Extended Community,\n   then the originated S-PMSI A-D route SHOULD also carry
    this Extended\n   Community.\n"
  title: 12.  MVPN with Virtual Hub-and-Spoke
- contents:
  - "13.  Data Plane\n   This section describes the data plane procedures on the ABRs,
    ingress\n   PEs, egress PEs, and transit routers.\n"
  - contents:
    - "13.1.  Data Plane Procedures on ABRs\n   When procedures in this document are
      followed to signal inter-area\n   P2MP segmented LSPs, ABRs are required to
      perform only MPLS\n   switching.  When an ABR receives an MPLS packet from an
      \"incoming\"\n   intra-area segment of the inter-area P2MP segmented LSP, it
      forwards\n   the packet, based on MPLS switching, on to another \"outgoing\"
      intra-\n   area segment of the inter-area P2MP segmented LSP.\n   If the outgoing
      intra-area segment is instantiated using a P2MP LSP,\n   and if there is a one-to-one
      mapping between the outgoing intra-area\n   segment and the P2MP LSP, then the
      ABR MUST pop the incoming\n   segment's label stack and push the label stack
      of the outgoing P2MP\n   LSP.  If there is a many-to-one mapping between outgoing
      intra-area\n   segments and the P2MP LSP, then the ABR MUST pop the incoming\n
      \  segment's label stack and first push the upstream-assigned label\n   corresponding
      to the outgoing intra-area segment, if such a label has\n   been assigned, and
      then push the label stack of the outgoing P2MP\n   LSP.\n   If the outgoing
      intra-area segment is instantiated using ingress\n   replication, then the ABR
      must pop the incoming segment's label stack\n   and replicate the packet once
      to each leaf ABR or PE of the outgoing\n   intra-area segment.  The label stack
      of the packet sent to each such\n   leaf MUST first include a downstream-assigned
      label assigned by the\n   leaf to the segment, followed by the label stack of
      the P2P or MP2P\n   LSP to the leaf.\n"
    title: 13.1.  Data Plane Procedures on ABRs
  - contents:
    - "13.2.  Data Plane Procedures on Egress PEs\n   An egress PE must first identify
      the inter-area P2MP segmented LSP\n   based on the incoming label stack.  After
      this identification, the\n   egress PE must forward the packet using the application
      that is bound\n   to the inter-area P2MP segmented LSP.\n   Note that the application-specific
      forwarding for MVPN service may\n   require the egress PE to determine whether
      the packets were received\n   from the expected sender PE.  When the application
      is MVPN, the FEC\n   of an inter-area P2MP segmented LSP is at the granularity
      of the\n   sender PE.  Note that MVPN intra-AS I-PMSI A-D routes and S-PMSI
      A-D\n   routes both carry the Originating Router's IP Address.  Thus, an\n   egress
      PE could associate the data arriving on P-tunnels advertised\n   by these routes
      with the Originating Router's IP Address carried by\n   these routes, which
      is the same as the ingress PE.  Since a unique\n   label stack is associated
      with each such FEC, the egress PE can\n   determine the sender PE from the label
      stack.\n   Likewise for VPLS service, for the purposes of Media Access Control\n
      \  (MAC) learning the egress, the PE must be able to determine the\n   \"VE-ID\"
      (VPLS Edge Device Identifier) from which the packets have\n   been received.
      \ The FEC of the VPLS A-D routes carries the VE-ID.\n   Thus, an egress PE could
      associate the data arriving on P-tunnels\n   advertised by these routes with
      the VE-ID carried by these routes.\n   Since a unique label stack is associated
      with each such FEC, the\n   egress PE can perform MAC learning for packets received
      from a given\n   VE-ID.\n   When the application is global table multicast,
      it is sufficient for\n   the label stack to include identification of the sender
      upstream\n   node.  When P2MP LSPs are used, this requires that PHP MUST be
      turned\n   off.  When ingress replication is used, the egress PE knows the\n
      \  incoming downstream-assigned label to which it has bound a particular\n   (S/*,G)
      and must accept packets with only that label for that\n   (S/*,G).\n"
    title: 13.2.  Data Plane Procedures on Egress PEs
  - contents:
    - "13.3.  Data Plane Procedures on Ingress PEs\n   An Ingress PE must perform
      application-specific forwarding procedures\n   to identify the outgoing intra-area
      segment of an incoming packet.\n   If the outgoing intra-area segment is instantiated
      using a P2MP LSP,\n   and if there is a one-to-one mapping between the outgoing
      intra-area\n   segment and the P2MP LSP, then the ingress PE MUST encapsulate
      the\n   packet in the label stack of the outgoing P2MP LSP.  If there is a\n
      \  many-to-one mapping between outgoing intra-area segments and the P2MP\n   LSP,
      then the PE MUST first push the upstream-assigned label\n   corresponding to
      the outgoing intra-area segment, if such a label\n   has been assigned, and
      then push the label stack of the outgoing\n   P2MP LSP.\n   If the outgoing
      intra-area segment is instantiated using ingress\n   replication, then the PE
      must replicate the packet once to each leaf\n   ABR or PE of the outgoing intra-area
      segment.  The label stack of the\n   packet sent to each such leaf MUST first
      include a downstream-\n   assigned label assigned by the leaf to the segment,
      followed by the\n   label stack of the P2P or MP2P LSP to the leaf.\n"
    title: 13.3.  Data Plane Procedures on Ingress PEs
  - contents:
    - "13.4.  Data Plane Procedures on Transit Routers\n   When procedures in this
      document are followed to signal inter-area\n   P2MP segmented LSPs, transit
      routers in each area perform only MPLS\n   switching.\n"
    title: 13.4.  Data Plane Procedures on Transit Routers
  title: 13.  Data Plane
- contents:
  - "14.  Support for Inter-Area Transport LSPs\n   This section describes OPTIONAL
    procedures that allow multiple\n   (inter-area) P2MP LSPs to be aggregated into
    a single inter-area P2MP\n   \"transport LSP\".  The segmentation procedures,
    as specified in this\n   document, are then applied to these inter-area P2MP transport
    LSPs,\n   rather than being applied directly to the individual LSPs that are\n
    \  aggregated into the transport.  In the following, the individual LSPs\n   that
    are aggregated into a single transport LSP will be known as\n   \"service LSPs\".\n"
  - contents:
    - "14.1.  \"Transport Tunnel\" Tunnel Type\n   For the PMSI Tunnel attribute,
      we define a new Tunnel Type, called\n   \"Transport Tunnel\", whose Tunnel Identifier
      is a tuple <Source PE\n   Address, Local Number>.  This Tunnel Type is assigned
      a value of 8.\n   The Source PE Address is the address of the PE that originates
      the\n   (service) A-D route that carries this attribute, and the Local Number\n
      \  is a number that is unique to the Source PE.  The length of the Local\n   Number
      part is the same as the length of the Source PE Address.\n   Thus, if the Source
      PE Address is an IPv4 address, then the Local\n   Number part is 4 octets; if
      the Source PE Address is an IPv6 address,\n   then the Local Number part is
      16 octets.\n"
    title: 14.1.  "Transport Tunnel" Tunnel Type
  - contents:
    - "14.2.  Discovering Leaves of the Inter-Area P2MP Service LSP\n   When aggregating
      multiple P2MP LSPs using P2MP LSP hierarchy,\n   determining the leaf nodes
      of the LSPs being aggregated is essential\n   for being able to trade-off the
      overhead due to the P2MP LSPs versus\n   suboptimal use of bandwidth due to
      the partial congruency of the LSPs\n   being aggregated.\n   Therefore, if a
      PE that is a root of a given service P2MP LSP wants\n   to aggregate this LSP
      with other (service) P2MP LSPs rooted at the\n   same PE into an inter-area
      P2MP transport LSP, the PE should first\n   determine all the leaf nodes of
      that service LSP, as well as those of\n   the other service LSPs being aggregated.\n
      \  To accomplish this, the PE sets the PMSI Tunnel attribute of the\n   service
      A-D route (an I-PMSI or S-PMSI A-D route for MVPN or VPLS\n   service) associated
      with that LSP as follows.  The Tunnel Type is set\n   to \"No tunnel information
      present\", and the \"Leaf Information\n   Required\" flag is set to 1.  The
      route MUST NOT carry the Inter-Area\n   P2MP Segmented Next-Hop Extended Community.
      \ In contrast to the\n   procedures for the MVPN and VPLS A-D routes described
      so far, the\n   Route Reflectors that participate in the distribution of this
      route\n   need not be ABRs.\n"
    title: 14.2.  Discovering Leaves of the Inter-Area P2MP Service LSP
  - contents:
    - "14.3.  Discovering P2MP FEC of P2MP Transport LSP\n   Once the ingress PE determines
      all the leaves of a given P2MP service\n   LSP, the PE (using some local criteria)
      selects a particular inter-\n   area transport P2MP LSP to be used for carrying
      the (inter-area)\n   service P2MP LSP.\n   Once the PE selects the transport
      P2MP LSP, the PE (re-)originates\n   the service A-D route.  The PMSI Tunnel
      attribute of this route now\n   carries the Tunnel Identifier of the selected
      transport LSP, with the\n   Tunnel Type set to \"Transport Tunnel\".  If the
      transport LSP carries\n   multiple P2MP service LSPs, then the MPLS Label field
      in the\n   attribute carries an upstream-assigned label assigned by the PE that\n
      \  is bound to the P2MP FEC of the inter-area P2MP service LSP.\n   Otherwise,
      this field is set to Implicit NULL.\n   As described earlier, this service A-D
      route MUST NOT carry the\n   Inter-Area P2MP Segmented Next-Hop Extended Community,
      and the Route\n   Reflectors that participate in the distribution of this route
      need\n   not be ABRs.\n"
    title: 14.3.  Discovering P2MP FEC of P2MP Transport LSP
  - contents:
    - "14.4.  Egress PE Procedures for P2MP Transport LSP\n   When an egress PE receives
      and accepts an MVPN or VPLS service A-D\n   route, if the \"Leaf Information
      Required\" flag in the PMSI Tunnel\n   attribute of the received A-D route is
      set to 1, and the route does\n   not carry the Inter-Area P2MP Segmented Next-Hop
      Extended Community,\n   then the egress PE, following the \"regular\" MVPN or
      VPLS procedures\n   associated with the received A-D route (as specified in
      [RFC6514] and\n   [RFC7117]), originates a Leaf A-D route.\n   In addition,
      if the Tunnel Type in the PMSI Tunnel attribute of the\n   received service
      A-D route is set to \"Transport Tunnel\", the egress\n   PE originates yet another
      Leaf A-D route.\n   The format of the Route Key field of the MCAST-VPN NLRI
      of this\n   additional Leaf A-D route is the same as defined in Section 6.2.2.\n
      \  The Route Key field of the MCAST-VPN NLRI of this route is\n   constructed
      as follows:\n      RD (8 octets) - set to 0\n      Multicast Source Length,
      Multicast Source - constructed from the\n          Source PE Address part of
      the Tunnel Identifier carried in the\n          PMSI Tunnel attribute of the
      received service S-PMSI A-D\n          route.\n      Multicast Group Length,
      Multicast Group - constructed from the\n          Local Number part of the Tunnel
      Identifier carried in the PMSI\n          Tunnel attribute of the received service
      S-PMSI A-D route.\n      Ingress PE IP Address - set to the Source PE Address
      part of the\n          Tunnel Identifier carried in the PMSI Tunnel attribute
      of the\n          received service S-PMSI A-D route.\n   The egress PE, when
      determining the upstream ABR, follows the\n   procedures specified in Section
      6.1 for global table multicast.\n   The egress PE constructs the rest of the
      Leaf A-D route following the\n   procedures specified in Section 6.2.3.\n   From
      that point on we follow the procedures used for the Leaf A-D\n   routes for
      global table multicast, as outlined below.\n"
    title: 14.4.  Egress PE Procedures for P2MP Transport LSP
  - contents:
    - "14.5.  ABRs and Ingress PE Procedures for P2MP Transport LSP\n   In this section,
      we specify ingress and egress ABRs, as well as\n   ingress PE procedures for
      P2MP transport LSPs.\n   When an egress ABR receives the Leaf A-D route, and
      P2MP LSP is used\n   to instantiate the egress area segment of the inter-area
      transport\n   LSP, the egress ABR will advertise into the egress area an S-PMSI
      A-D\n   route.  This route is constructed following the procedures in Section\n
      \  7.2.2.1.  The egress PE(s) will import this route.\n   The egress ABR will
      also propagate, with appropriate modifications,\n   the received Leaf A-D route
      into the backbone area.  This is\n   irrespective of whether the egress area
      segment is instantiated using\n   P2MP LSP or ingress replication.\n   If P2MP
      LSP is used to instantiate the backbone area segment of the\n   inter-area transport
      LSP, then an ingress ABR will advertise into the\n   backbone area an S-PMSI
      A-D route.  This route is constructed\n   following the procedures in Section
      7.1.2.1.  The egress ABR(s) will\n   import this route.\n   The ingress ABR
      will also propagate, with appropriate modifications,\n   the received Leaf A-D
      route into the ingress area towards the\n   ingress/root PE.  This is irrespective
      of whether the backbone area\n   segment is instantiated using P2MP LSP or ingress
      replication.\n   Finally, if P2MP LSP is used to instantiate the ingress area
      segment,\n   the ingress PE will advertise into the ingress area an S-PMSI A-D\n
      \  route with the RD, multicast source, and multicast group fields being\n   the
      same as those in the received Leaf A-D route.  The PMSI Tunnel\n   attribute
      of this route contains the identity of the intra-area P2MP\n   LSP used to instantiate
      the ingress area segment, and an upstream-\n   assigned MPLS label.  The ingress
      ABR(s) and other PE(s) in the\n   ingress area, if any, will import this route.
      \ The ingress PE will\n   use the (intra-area) P2MP LSP advertised in this route
      for carrying\n   traffic associated with the original service A-D route advertised
      by\n   the PE.\n"
    title: 14.5.  ABRs and Ingress PE Procedures for P2MP Transport LSP
  - contents:
    - "14.6.  Discussion\n   Use of inter-area transport P2MP LSPs, as described in
      this section,\n   creates a level of indirection between (inter-area) P2MP service\n
      \  LSPs, and intra-area transport LSPs that carry the service LSPs.\n   Rather
      than segmenting (inter-area) service P2MP LSPs, and then\n   aggregating (intra-area)
      segments of these service LSPs into intra-\n   area transport LSPs, this approach
      first aggregates multiple (inter-\n   area) service P2MP LSPs into a single
      inter-area transport P2MP LSP,\n   then segments such inter-area transport P2MP
      LSPs, and then\n   aggregates (intra-area) segments of these inter-area transport
      LSPs\n   into intra-area transport LSPs.\n   On one hand, this approach could
      result in reducing the state (and\n   the overhead associated with maintaining
      the state) on ABRs.  This is\n   because instead of requiring ABRs to maintain
      state for individual\n   P2MP service LSPs, ABRs would need to maintain state
      only for the\n   inter-area P2MP transport LSPs.  Note, however, that this reduction\n
      \  is possible only if a single inter-area P2MP transport LSP aggregates\n   more
      than one (inter-area) service LSP.  In the absence of such\n   aggregation,
      use of inter-area transport LSPs provides no benefits,\n   yet results in extra
      overhead.  And while such aggregation does allow\n   reduced state on ABRs,
      it comes at a price, as described below.\n   As we mentioned before, aggregating
      multiple P2MP service LSPs into a\n   single inter-area P2MP transport LSP requires
      the PE rooted at these\n   LSPs to determine all the leaf nodes of the service
      LSPs to be\n   aggregated.  This means that the root PE has to track all the
      leaf\n   PEs of these LSPs.  In contrast, when one applies segmentation\n   procedures
      directly to the P2MP service LSPs, the root PE has to\n   track only the leaf
      PEs in its own IGP area, plus the ingress ABR(s).\n   Likewise, an ingress ABR
      has to track only the egress ABRs.  Finally,\n   an egress ABR has to track
      only the leaf PEs in its own area.\n   Therefore, while the total overhead of
      leaf tracking due to the P2MP\n   service LSPs is about the same in both approaches,
      the distribution\n   of this overhead is different.  Specifically, when one
      uses inter-\n   area P2MP transport LSPs, this overhead is concentrated on the\n
      \  ingress PE.  When one applies segmentation procedures directly to the\n   P2MP
      service LSPs, this overhead is distributed among the ingress PE\n   and ABRs.\n
      \  Moreover, when one uses inter-area P2MP transport LSPs, ABRs have to\n   bear
      the overhead of leaf tracking for inter-area P2MP transport\n   LSPs.  In contrast,
      when one applies segmentation procedures directly\n   to the P2MP service LSPs,
      there is no such overhead (as there are no\n   inter-area P2MP transport LSPs).\n
      \  Use of inter-area P2MP transport LSPs may also result in more\n   bandwidth
      inefficiency, as compared to applying segmentation\n   procedures directly to
      the P2MP service LSPs.  This is because with\n   inter-area P2MP transport LSPs
      the ABRs aggregate segments of inter-\n   area P2MP transport LSPs, rather than
      segments of (inter-area) P2MP\n   service LSPs.  To illustrate this, consider
      the following example.\n   Assume PE1 in Area 1 is an ingress PE, with two multicast
      streams,\n   (C-S1, C-G1) and (C-S2, C-G2), originated by an MVPN site connected\n
      \  to PE1.  Assume that PE2 in Area 2 has an MVPN site with receivers\n   for
      (C-S1, C-G1), PE3 and PE4 in Area 3 have an MVPN site with\n   receivers for
      both (C-S1, C-G1) and (C-S2, C-G2).  Finally, assume\n   that PE5 in Area 4
      has an MVPN site with receivers for (C-S2, C-G2).\n   When segmentation applies
      directly to the P2MP service LSPs, Area 2\n   would have just one intra-area
      transport LSP that would carry the\n   egress area segment of the P2MP service
      LSP for (C-S1, C-G1); Area 3\n   would have just one intra-area transport LSP
      that would carry the\n   egress area segments of both the P2MP service LSP for
      (C-S1, C-G1)\n   and the P2MP service LSP for (C-S2, C-G2); Area 4 would have
      just one\n   intra-area transport LSP that would carry the egress area segment
      of\n   the P2MP service LSP for (C-S2, C-G2).  Note that there is no\n   bandwidth
      inefficiency in this case at all.\n   When using inter-area P2MP transport LSPs,
      to achieve the same state\n   overhead on the routers within each of the egress
      areas (except for\n   egress ABRs), PE1 would need to aggregate the P2MP service
      LSP for\n   (C-S1, C-G1) and the P2MP service LSP for (C-S2, C-G2) into the
      same\n   inter-area P2MP transport LSP.  While such aggregation would reduce\n
      \  state on ABRs, it would also result in bandwidth inefficiency, as\n   (C-S1,
      C-G1) will be delivered not just to PE2, PE3, and PE4, but\n   also to PE5,
      which has no receivers for this stream.  Likewise,\n   (C-S2, C-G2) will be
      delivered not just to PE3, PE4, and PE5, but\n   also to PE2, which has no receivers
      for this stream.\n"
    title: 14.6.  Discussion
  title: 14.  Support for Inter-Area Transport LSPs
- contents:
  - "15.  IANA Considerations\n   This document defines a new BGP Extended Community
    called \"Inter-Area\n   P2MP Segmented Next-Hop\" (see Section 4).  This may be
    either a\n   Transitive IPv4-Address-Specific Extended Community or a Transitive\n
    \  IPv6-Address-Specific Extended Community.  IANA has assigned the\n   value
    0x12 in the \"Transitive IPv4-Address-Specific Extended\n   Community Sub-Types\"
    registry, and IANA has assigned the value 0x0012\n   in the \"Transitive IPv6-Address-Specific
    Extended Community Types\"\n   registry.  This document is the reference for both
    code points.\n   IANA has assigned the value 0x08 in the \"P-Multicast Service\n
    \  Interface Tunnel (PMSI Tunnel) Tunnel Types\" registry [RFC7385] as\n   \"Transport
    Tunnel\" (see Section 14).\n   This document makes use of a Route Distinguisher
    whose value is all\n   ones.  The two-octet type field of this Route Distinguisher
    thus has\n   the value 65535.  IANA has assigned this value in the \"Route\n   Distinguisher
    Type Field\" registry as \"For Use Only in Certain Leaf\n   A-D Routes\", with
    this document as the reference.\n"
  title: 15.  IANA Considerations
- contents:
  - "16.  Security Considerations\n   Procedures described in this document are subject
    to security threats\n   similar to those experienced by any MPLS deployment.  It
    is\n   recommended that baseline security measures are considered as\n   described
    in \"Security Framework for MPLS and GMPLS Networks\"\n   [RFC5920], in the mLDP
    specification [RFC6388], and in the P2MP\n   RSVP-TE specification [RFC3209].
    \ The security considerations of\n   [RFC6513] are also applicable.\n"
  title: 16.  Security Considerations
- contents:
  - '17.  References

    '
  - contents:
    - "17.1.  Normative References\n   [RFC1997]   Chandra, R., Traina, P., and T.
      Li, \"BGP Communities\n               Attribute\", RFC 1997, DOI 10.17487/RFC1997,
      August 1996,\n               <http://www.rfc-editor.org/info/rfc1997>.\n   [RFC2119]
      \  Bradner, S., \"Key words for use in RFCs to Indicate\n               Requirement
      Levels\", BCP 14, RFC 2119,\n               DOI 10.17487/RFC2119, March 1997,\n
      \              <http://www.rfc-editor.org/info/rfc2119>.\n   [RFC3209]   Awduche,
      D., Berger, L., Gan, D., Li, T., Srinivasan, V.,\n               and G. Swallow,
      \"RSVP-TE: Extensions to RSVP for LSP\n               Tunnels\", RFC 3209, DOI
      10.17487/RFC3209, December 2001,\n               <http://www.rfc-editor.org/info/rfc3209>.\n
      \  [RFC4360]   Sangli, S., Tappan, D., and Y. Rekhter, \"BGP Extended\n               Communities
      Attribute\", RFC 4360, DOI 10.17487/RFC4360,\n               February 2006,
      <http://www.rfc-editor.org/info/rfc4360>.\n   [RFC4456]   Bates, T., Chen, E.,
      and R. Chandra, \"BGP Route\n               Reflection: An Alternative to Full
      Mesh Internal BGP\n               (IBGP)\", RFC 4456, DOI 10.17487/RFC4456,
      April 2006,\n               <http://www.rfc-editor.org/info/rfc4456>.\n   [RFC4684]
      \  Marques, P., Bonica, R., Fang, L., Martini, L., Raszuk,\n               R.,
      Patel, K., and J. Guichard, \"Constrained Route\n               Distribution
      for Border Gateway Protocol/MultiProtocol\n               Label Switching (BGP/MPLS)
      Internet Protocol (IP) Virtual\n               Private Networks (VPNs)\", RFC
      4684, DOI 10.17487/RFC4684,\n               November 2006, <http://www.rfc-editor.org/info/rfc4684>.\n
      \  [RFC4760]   Bates, T., Chandra, R., Katz, D., and Y. Rekhter,\n               \"Multiprotocol
      Extensions for BGP-4\", RFC 4760,\n               DOI 10.17487/RFC4760, January
      2007,\n               <http://www.rfc-editor.org/info/rfc4760>.\n   [RFC4761]
      \  Kompella, K., Ed., and Y. Rekhter, Ed., \"Virtual Private\n               LAN
      Service (VPLS) Using BGP for Auto-Discovery and\n               Signaling\",
      RFC 4761, DOI 10.17487/RFC4761, January 2007,\n               <http://www.rfc-editor.org/info/rfc4761>.\n
      \  [RFC4875]   Aggarwal, R., Ed., Papadimitriou, D., Ed., and S.\n               Yasukawa,
      Ed., \"Extensions to Resource Reservation\n               Protocol - Traffic
      Engineering (RSVP-TE) for Point-to-\n               Multipoint TE Label Switched
      Paths (LSPs)\", RFC 4875,\n               DOI 10.17487/RFC4875, May 2007,\n
      \              <http://www.rfc-editor.org/info/rfc4875>.\n   [RFC5036]   Andersson,
      L., Ed., Minei, I., Ed., and B. Thomas, Ed.,\n               \"LDP Specification\",
      RFC 5036, DOI 10.17487/RFC5036,\n               October 2007, <http://www.rfc-editor.org/info/rfc5036>.\n
      \  [RFC5331]   Aggarwal, R., Rekhter, Y., and E. Rosen, \"MPLS Upstream\n               Label
      Assignment and Context-Specific Label Space\",\n               RFC 5331, DOI
      10.17487/RFC5331, August 2008,\n               <http://www.rfc-editor.org/info/rfc5331>.\n
      \  [RFC5332]   Eckert, T., Rosen, E., Ed., Aggarwal, R., and Y. Rekhter,\n               \"MPLS
      Multicast Encapsulations\", RFC 5332,\n               DOI 10.17487/RFC5332,
      August 2008,\n               <http://www.rfc-editor.org/info/rfc5332>.\n   [RFC6074]
      \  Rosen, E., Davie, B., Radoaca, V., and W. Luo,\n               \"Provisioning,
      Auto-Discovery, and Signaling in Layer 2\n               Virtual Private Networks
      (L2VPNs)\", RFC 6074,\n               DOI 10.17487/RFC6074, January 2011,\n
      \              <http://www.rfc-editor.org/info/rfc6074>.\n   [RFC6368]   Marques,
      P., Raszuk, R., Patel, K., Kumaki, K., and T.\n               Yamagata, \"Internal
      BGP as the Provider/Customer Edge\n               Protocol for BGP/MPLS IP Virtual
      Private Networks\n               (VPNs)\", RFC 6368, DOI 10.17487/RFC6368, September
      2011,\n               <http://www.rfc-editor.org/info/rfc6368>.\n   [RFC6388]
      \  Wijnands, IJ., Ed., Minei, I., Ed., Kompella, K., and B.\n               Thomas,
      \"Label Distribution Protocol Extensions for\n               Point-to-Multipoint
      and Multipoint-to-Multipoint Label\n               Switched Paths\", RFC 6388,
      DOI 10.17487/RFC6388, November\n               2011, <http://www.rfc-editor.org/info/rfc6388>.\n
      \  [RFC6513]   Rosen, E., Ed., and R. Aggarwal, Ed., \"Multicast in\n               MPLS/BGP
      IP VPNs\", RFC 6513, DOI 10.17487/RFC6513,\n               February 2012, <http://www.rfc-editor.org/info/rfc6513>.\n
      \  [RFC6514]   Aggarwal, R., Rosen, E., Morin, T., and Y. Rekhter, \"BGP\n               Encodings
      and Procedures for Multicast in MPLS/BGP IP\n               VPNs\", RFC 6514,
      DOI 10.17487/RFC6514, February 2012,\n               <http://www.rfc-editor.org/info/rfc6514>.\n
      \  [RFC6625]   Rosen, E., Ed., Rekhter, Y., Ed., Hendrickx, W., and R.\n               Qiu,
      \"Wildcards in Multicast VPN Auto-Discovery Routes\",\n               RFC 6625,
      DOI 10.17487/RFC6625, May 2012,\n               <http://www.rfc-editor.org/info/rfc6625>.\n
      \  [RFC7117]   Aggarwal, R., Ed., Kamite, Y., Fang, L., Rekhter, Y., and\n               C.
      Kodeboniya, \"Multicast in Virtual Private LAN Service\n               (VPLS)\",
      RFC 7117, DOI 10.17487/RFC7117, February 2014,\n               <http://www.rfc-editor.org/info/rfc7117>.\n
      \  [RFC7385]   Andersson, L. and G. Swallow, \"IANA Registry for\n               P-Multicast
      Service Interface (PMSI) Tunnel Type Code\n               Points\", RFC 7385,
      DOI 10.17487/RFC7385, October 2014,\n               <http://www.rfc-editor.org/info/rfc7385>.\n"
    title: 17.1.  Normative References
  - contents:
    - "17.2.  Informative References\n   [GTM]       Zhang, J, Giuliano, L, Rosen,
      E., Ed., Subramanian, K.,\n               Pacella, D., and J. Schiller, \"Global
      Table Multicast\n               with BGP-MVPN Procedures\", Work in Progress,
      draft-ietf-\n               bess-mvpn-global-table-mcast-00, November 2014.\n
      \  [RFC5920]   Fang, L., Ed., \"Security Framework for MPLS and GMPLS\n               Networks\",
      RFC 5920, DOI 10.17487/RFC5920, July 2010,\n               <http://www.rfc-editor.org/info/rfc5920>.\n
      \  [RFC7024]   Jeng, H., Uttaro, J., Jalil, L., Decraene, B., Rekhter,\n               Y.,
      and R. Aggarwal, \"Virtual Hub-and-Spoke in BGP/MPLS\n               VPNs\",
      RFC 7024, DOI 10.17487/RFC7024, October 2013,\n               <http://www.rfc-editor.org/info/rfc7024>.\n
      \  [SEAMLESS-MPLS]\n               Leymann, N., Ed., Decraene, B., Filsfils,
      C.,\n               Konstantynowicz, M., Ed., and D. Steinberg, \"Seamless\n
      \              MPLS Architecture\", Work in Progress,\n               draft-ietf-mpls-seamless-mpls-07,
      June 2014.\n"
    title: 17.2.  Informative References
  title: 17.  References
- contents:
  - "Acknowledgements\n   We would like to thank Loa Andersson and Qin Wu for their
    review and\n   comments.\n"
  title: Acknowledgements
- contents:
  - "Authors' Addresses\n   Yakov Rekhter\n   Juniper Networks\n   1194 North Mathilda
    Ave.\n   Sunnyvale, CA 94089\n   United States\n   Eric C Rosen\n   Juniper Networks\n
    \  10 Technology Park Drive\n   Westford, MA 01886\n   United States\n   EMail:
    erosen@juniper.net\n   Rahul Aggarwal\n   EMail: raggarwa_1@yahoo.com\n   Thomas
    Morin\n   Orange\n   2, avenue Pierre-Marzin\n   22307 Lannion Cedex\n   France\n
    \  EMail: thomas.morin@orange.com\n   Irene Grosclaude\n   Orange\n   2, avenue
    Pierre-Marzin\n   22307 Lannion Cedex\n   France\n   EMail: irene.grosclaude@orange.com\n
    \  Nicolai Leymann\n   Deutsche Telekom AG\n   Winterfeldtstrasse 21\n   Berlin
    10781\n   Germany\n   EMail: n.leymann@telekom.de\n   Samir Saad\n   AT&T\n   EMail:
    samirsaad1@outlook.com\n"
  title: Authors' Addresses
