- title: __initial_text__
  contents:
  - '              Considerations in Validating the Path in BGP

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: IESG Note
  contents:
  - "IESG Note\n   After consultation with the RPSEC WG, the IESG thinks that this\
    \ work\n   is related to IETF work done in WG RPSEC, but this does not prevent\n\
    \   publishing.\n   This RFC is not a candidate for any level of Internet Standard.\
    \  The\n   IETF disclaims any knowledge of the fitness of this RFC for any\n \
    \  purpose and in particular notes that the decision to publish is not\n   based\
    \ on IETF review for such things as security, congestion control,\n   or inappropriate\
    \ interaction with deployed protocols.  The RFC Editor\n   has chosen to publish\
    \ this document at its discretion.  Readers of\n   this document should exercise\
    \ caution in evaluating its value for\n   implementation and deployment.  See\
    \ RFC 3932 for more information.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document examines the implications of hop-by-hop forwarding,\n\
    \   route aggregation, and route filtering on the concept of validation\n   within\
    \ a BGP Autonomous System (AS) Path.\n"
- title: 1.  Background
  contents:
  - "1.  Background\n   A good deal of thought has gone into, and is currently being\
    \ given\n   to, validating the path to a destination advertised by BGP.  The\n\
    \   purpose of this work is to explain the issues in validating a BGP AS\n   Path,\
    \ in the expectation that it will help in the evaluation of\n   schemes seeking\
    \ to improve path validation.  The first section\n   defines at least some of\
    \ the types of questions a BGP speaker\n   receiving an update from a peer not\
    \ in the local autonomous system\n   (AS) could ask about the information within\
    \ the routing update.  The\n   following sections examine the answers to these\
    \ questions in\n   consideration of specific deployments of BGP.\n   The examples\
    \ given in this document are intended to distill\n   deployments down to their\
    \ most critical components, making the\n   examples easier to understand and consider.\
    \  In many situations, the\n   specific path taken in the example may not be relevant,\
    \ but that does\n   not nullify the principles considered in each example.  It\
    \ has been\n   suggested that these examples are \"red herrings\", because they\
    \ do not\n   illustrate actual problems with specific policies.  On the contrary,\n\
    \   these examples are powerful because they are simple.  Any topology in\n  \
    \ which one of these example topologies is a subtopology will exhibit\n   the\
    \ characteristics explained in this document.  Rather than focusing\n   on a specific\
    \ topology, then dismissing that single topology as a\n   \"corner case\", this\
    \ document shows the basic issues with assertions\n   about the AS Path attribute\
    \ within BGP.  These generalized issues can\n   then be applied to more specific\
    \ cases.\n   With the heightened interest in network security, the security of\
    \ the\n   information carried within routing systems running BGP, as described\n\
    \   in [RFC4271], is being looked at with great interest.  While there\n   are\
    \ techniques available for securing the relationship between two\n   devices exchanging\
    \ routing protocol information, such as [BGP-MD5],\n   these techniques do not\
    \ ensure various aspects of the information\n   carried within routing protocols\
    \ are valid or authorized.\n   The following small internetwork is used to examine\
    \ the concepts of\n   validity and authorization within this document, providing\n\
    \   definitions used through the remainder of the document.\n   10.1.1.0/24--(AS65000)---(AS65001)--(AS65002)\n\
    \   Assume a BGP speaker in AS65002 has received an advertisement for\n   10.1.1.0/24\
    \ from a BGP speaker in AS65001, with an AS Path of {65000,\n   65001}.\n"
- title: 1.1.  Is the Originating AS Authorized to Advertise Reachability to the
  contents:
  - "1.1.  Is the Originating AS Authorized to Advertise Reachability to the\n   \
    \   Destination?\n   The most obvious question the receiving BGP speaker can ask\
    \ about\n   this advertisement is whether or not the originating AS, in this case\n\
    \   AS65000, is authorized to advertise the prefix contained within the\n   advertisement,\
    \ in this case 10.1.1.0/24.  Whether or not a BGP\n   speaker receiving a route\
    \ to 10.1.1.0/24 originating in AS65000 can\n   verify that AS65000 is, indeed,\
    \ authorized to advertise 10.1.1.0/24\n   is outside the scope of this document.\n"
- title: 1.2.  Is the Path Contained in the Advertised Routing Information Valid?
  contents:
  - "1.2.  Is the Path Contained in the Advertised Routing Information Valid?\n  \
    \ If a BGP speaker receives an advertisement from a peer outside the\n   local\
    \ autonomous system (AS), the peer sending the update has a path\n   to the destination\
    \ prefix in the update.  Specifically, are the\n   autonomous systems within the\
    \ internetwork connected in such a way\n   that the receiver, following the AS\
    \ Path listed in the BGP update\n   itself, can reach the originating AS listed\
    \ in the received AS Path?\n   Within this document, this is called path validation.\n\
    \   Path validation, in the context of this small internetwork, asserts\n   that\
    \ when a BGP speaker in AS65002 receives an advertisement from a\n   BGP speaker\
    \ in AS65001 with the AS Path {65000, 65001}, the speaker\n   can assume that\
    \ AS65001 is attached to the local AS, and that AS65001\n   is also attached to\
    \ AS65000.\n"
- title: 1.3.  Is the Advertisement Authorized?
  contents:
  - "1.3.  Is the Advertisement Authorized?\n   There are at least three senses in\
    \ which the readvertisement of a\n   received advertisement can be authorized\
    \ in BGP:\n   o  The transmitter is authorized to advertise the specific routing\n\
    \      information contained in the route.  This treats the routing\n      information\
    \ as a single, atomic unit, regardless of the\n      information the route actually\
    \ contains.  A route to 10.1.1.0/24\n      and another route to 10.1.0.0/16 are\
    \ considered completely\n      different advertisements of routing information,\
    \ so an AS may be\n      authorized to advertise 10.1.0.0/16 without regard to\
    \ its\n      authorization to advertise 10.1.1.0/24, since these are two\n   \
    \   separate routes.  This is called route authorization throughout\n      this\
    \ document.\n   o  The transmitter is authorized to advertise the specific reachable\n\
    \      destination(s) contained in the route.  This treats the routing\n     \
    \ information as a set of destinations. 10.1.1.0/24 is contained\n      within\
    \ 10.1.0.0/16, and authorization to advertise the latter\n      implies authorization\
    \ to advertise the former.  This is called\n      reachability authorization throughout\
    \ this document.\n   o  The transmitter is authorized to transit traffic to the\n\
    \      destinations contained within the route.  This ties the concepts\n    \
    \  of the route to what the route is used for.  If a BGP speaker is\n      advertising\
    \ reachability to 10.1.1.0/24, it is authorized to\n      transit traffic to all\
    \ reachable destinations within 10.1.1.0/24\n      along the path advertised.\
    \  This is called transit authorization\n      throughout this document.\n   There\
    \ is considerable tension between these three definitions of\n   authorization;\
    \ much of this document is built around exploring the\n   relationships between\
    \ these different types of authorization, and how\n   they may, or may not, work\
    \ in various internetworks.  One of the\n   conclusions reached by this document\
    \ is that route authorization,\n   reachability authorization, and transit authorization\
    \ are often at\n   odds with each other.  Showing one type of authorization to\
    \ be true\n   does not show any other types of authorization to be true, and route\n\
    \   authorization is of questionable value because of the intertwined\n   nature\
    \ of these three types of authorization in a routing system.\n"
- title: 1.4.  Will Traffic Forwarded to an Advertising Speaker Follow the
  contents:
  - "1.4.  Will Traffic Forwarded to an Advertising Speaker Follow the\n      Described\
    \ AS Path?\n   If a BGP speaker receives an advertisement from a peer not in the\n\
    \   local AS, will traffic forwarded to the peer advertising the update\n   follow\
    \ the path described in the AS Path?  In this document, this is\n   called forwarding\
    \ consistency.\n   In terms of the small example internetwork, if a BGP speaker\
    \ in\n   AS65002 receives an advertisement from a peer in AS65001 for the\n  \
    \ destination 10.1.1.0/24, with an AS Path {65000, 65001}, will traffic\n   forwarded\
    \ to the BGP speaker in AS65001 actually be forwarded through\n   routers within\
    \ AS65001, then AS65000, to reach its destination?\n"
- title: 1.5.  Is a Withdrawing Speaker Authorized to Withdraw the Routing
  contents:
  - "1.5.  Is a Withdrawing Speaker Authorized to Withdraw the Routing\n      Information?\n\
    \   If an advertisement is withdrawn, the withdrawing BGP peer was\n   originally\
    \ advertising the prefix (or was authorized to advertise the\n   prefix).  This\
    \ assertion is out of the scope of this document.\n"
- title: 2.  Analysis
  contents:
  - "2.  Analysis\n   To begin, we review some of the concepts of routing, since we\
    \ need to\n   keep these concepts fixed firmly in place while we examine these\n\
    \   questions.  After this, four examples will be undertaken with BGP to\n   show\
    \ the tension between the various types of authorization in a path\n   vector\
    \ routing system.\n"
- title: 2.1.  A Short Analysis of Routing
  contents:
  - "2.1.  A Short Analysis of Routing\n   Routing protocols are designed, in short,\
    \ to discover a set of\n   loop-free paths to each reachable destination within\
    \ a network (or\n   internetwork).  The loop-free path chosen to reach a specific\n\
    \   destination may not be the shortest path, and it may not always be\n   the\
    \ \"best\" path (depending on the definition of \"best\"), but it\n   should always\
    \ be a loop-free path, otherwise the routing protocol has\n   failed.\n   This\
    \ sheds some light on the purpose of the path included in a path\n   vector protocol's\
    \ routing update: the path is there to prove the path\n   is loop free, rather\
    \ than to provide any other information.  While\n   Dijkstra's Sender Policy Framework\
    \ (SPF) and the Diffusing Update\n   Algorithm (DUAL) both base their loop-free\
    \ path calculations on the\n   cost of a path, path vector protocols, such as\
    \ BGP, prove a path is\n   loop free by carrying a list of nodes the advertisement\
    \ itself has\n   traversed.  BGP specifically uses an AS Path-based mechanism\
    \ to prove\n   loop freeness for any given update so each AS along the path may\n\
    \   implement local policy without risking a loop in the routing system\n   caused\
    \ by competing metrics.\n   We need to keep this principle in mind when considering\
    \ the use of\n   the path carried in a path-vector protocol, and its use by a\n\
    \   receiving BGP speaker for setting policy or gauging the route's\n   security\
    \ level.\n"
- title: '2.2.  First Example: Manual Intervention in the Path Choice'
  contents:
  - "2.2.  First Example: Manual Intervention in the Path Choice\n   In the small\
    \ network:\n                   +---(AS65002)---+\n   (AS65000)--(AS65001)    \
    \      (AS65004)--10.1.1.0/24\n                   +---(AS65003)---+\n   A BGP\
    \ speaker in AS65000 may receive an advertisement from a peer\n   that 10.1.1.0/24\
    \ is reachable along the path {65004, 65002, 65001}.\n   Based on this information,\
    \ the BGP speaker may forward packets to its\n   peer in AS65001, expecting them\
    \ to take the path described.  However,\n   within AS65001, the network administrator\
    \ may have configured a\n   static route making the next hop to 10.1.1.0/24 the\
    \ edge router with\n   AS65003.\n   It's useful to note that while [RFC4271] states:\
    \ \"....we assume that\n   a BGP speaker advertises to its peers only those routes\
    \ that it\n   itself uses...\", the definition of the term \"use\" is rather loose\
    \ in\n   all known widely deployed BGP implementations.  Rather than meaning:\n\
    \   \"A BGP speaker will only advertise destinations the BGP process on\n   the\
    \ speaker has installed in the routing table\", it generally means:\n   \"A BGP\
    \ speaker will only advertise destinations that the local\n   routing table has\
    \ a matching route installed for, no matter what\n   process on the local router\
    \ installed the route\".  A naive reaction\n   may be to simply change the BGP\
    \ specifications and all existing\n   implementations so a BGP speaker will only\
    \ advertise a route to a\n   peer if the BGP process on the router actually installed\
    \ the route in\n   the local routing table.  This, however, ignores the complex\n\
    \   interactions between interior and exterior gateway protocols, which\n   most\
    \ often run on the same device, and the complexities of route\n   origination.\n\
    \   Although this is an \"extreme\" example, since we can hardly claim the\n \
    \  information within the routing protocol is actually insufficient, we\n   still\
    \ find this example instructive in light of the questions\n   outlined in Section\
    \ 1:\n   o  Is the AS Path valid?  The AS Path the receiving BGP speaker in\n\
    \      AS65000 receives from its peer in AS65001, {65004, 65002, 65001),\n   \
    \   does exist, and is valid.\n   o  Is the advertisement authorized?  Since we\
    \ have no knowledge of\n      any autonomous system level policy within this network,\
    \ we have no\n      way of answering this question.  We can assume that AS65001\
    \ has\n      both route and reachability authorization, but it is difficult to\n\
    \      see how transit authorization can be accomplished in this\n      situation.\
    \  Even if the BGP speaker in AS65000 could verify\n      AS65001 is authorized\
    \ to transit AS65002 to reach 10.1.1.0/24,\n      this implies nothing about the\
    \ authorization to transit traffic\n      through the path traffic will actually\
    \ take, which is through\n      AS65003.\n   o  Is the AS Path consistent with\
    \ the forwarding path (does\n      forwarding consistency exist)?  No, the advertised\
    \ AS Path is\n      {65004, 65002, 65001}, while the actual path is {65004, 65003,\n\
    \      65001}.\n   From this example, we can see forwarding consistency is not\
    \ possible\n   to validate in a deployed network; just because a BGP speaker\n\
    \   advertises a specific path to reach a given destination, there is no\n   reason\
    \ to assume traffic forwarded to the speaker will actually\n   follow the path\
    \ advertised.  In fact, we can reason this from the\n   nature of packet-forwarding\
    \ networks; each router along a path makes\n   a completely separate decision\
    \ about where to forward received\n   traffic.  Any router along the path could\
    \ actually change the path\n   due to network conditions without notifying, in\
    \ any way, upstream\n   routers.  Therefore, at any given time, an upstream router\
    \ may be\n   forwarding traffic along a path that no longer exists, or is no\n\
    \   longer optimal, and downstream routers could be correcting the\n   forwarding\
    \ decision by placing the traffic on another available path\n   unknown to the\
    \ upstream router.\n   As a corollary, we can see that authorizing transit through\
    \ a\n   specific AS Path is not possible, either.  If the source of a\n   specific\
    \ flow cannot know what path the traffic within that flow will\n   take to reach\
    \ the destination, then there is no meaningful sense in\n   which downstream routers\
    \ can authorize the source to use available\n   paths for transiting traffic.\n"
- title: '2.3.  Second Example: An Unintended Reachable Destination'
  contents:
  - "2.3.  Second Example: An Unintended Reachable Destination\n   In this internetwork,\
    \ we assume a single policy: the system\n   administrator of AS65000 would not\
    \ like the destination 10.1.1.0/24\n   to be reachable from any autonomous system\
    \ beyond AS65001.  In other\n   words, 10.1.1.0/24 should be reachable within\
    \ AS65001, but not to\n   autonomous systems connected to AS65001, such as AS65002.\n\
    \   10.1.1.0/24---(AS65000)---(AS65001)---(AS65002)\n   The system administrator\
    \ can implement this policy by causing BGP\n   speakers within AS65000 to advertise\
    \ 10.1.1.0/24 to peers within\n   AS65001 with a signal that the BGP speakers\
    \ in AS65001 should not\n   readvertise the reachability of this routing information.\
    \  For\n   example, BGP speakers in AS65000 could advertise the route to\n   10.1.1.0/24\
    \ with the NO_ADVERTISE community attached, as described in\n   [RFC4271].  If\
    \ the BGP speakers in AS65001 are configured to respond\n   to this community\
    \ (and we assume they are for the purposes of this\n   document) correctly, they\
    \ should accept this advertisement, but not\n   readvertise reachability to 10.1.1.0/24\
    \ into AS65002.\n   However, unknown to the system administrator of AS65000, AS65001\
    \ is\n   actually advertising a default route to AS65002 with an AS Path of\n\
    \   {65001}, and not a full routing table.  If some host within AS65002,\n   then,\
    \ originates a packet destined to 10.1.1.1, what will happen?\n   The packet will\
    \ be routed according to the default route from AS65002\n   into AS65001.  Routers\
    \ within AS65001 will forward the packet along\n   the 10.1.1.0/24 route, eventually\
    \ forwarding the traffic into\n   AS65000.\n   o  Is the AS Path valid?  This\
    \ is a difficult question to answer,\n      since there are actually two different\
    \ advertisements in the\n      example.  From the perspective of the BGP speaker\
    \ in AS65002\n      receiving a default route in an advertisement from a peer\
    \ in\n      AS65001, the AS Path to the default route is valid.  However,\n  \
    \    there is no route to 10.1.1.0/24 for the BGP speaker in AS65002 to\n    \
    \  examine for validity, so the question appears to be out of scope\n      for\
    \ this example.\n   o Is the AS Path consistent with the forwarding path (is there\n\
    \      forwarding consistency)?  From the perspective of a BGP speaker in\n  \
    \    AS65002, traffic forwarded to AS65001 towards a destination within\n    \
    \  10.1.1.0/24 is going to actually terminate within AS65001, since\n      that\
    \ is the entire AS Path for the default route.  However, this\n      traffic actually\
    \ transits AS65001 towards AS65000.  Therefore,\n      forwarding consistency\
    \ does not exist in this example, in which we\n      are dealing with a case of\
    \ aggregation, and as Section 9.1.4 of\n      [RFC4271], in reference to aggregated\
    \ routing information, states:\n      \"Forwarding along such a route does not\
    \ guarantee that IP packets\n      will actually traverse only ASes listed in\
    \ the AS_PATH attribute\n      of the route\".\n"
- title: 2.3.1.  Advertisement Authorization
  contents:
  - "2.3.1.  Advertisement Authorization\n   Is the advertisement authorized?  This\
    \ example higlights the tension\n   between the three different types of authorization.\
    \  The three\n   following sections discuss issues with different advertisements\n\
    \   AS65001 may send to AS65002.\n"
- title: 2.3.1.1.  Valid Unauthorized Aggregates
  contents:
  - "2.3.1.1.  Valid Unauthorized Aggregates\n   The first issue that comes up in\
    \ this example is the case where there\n   is no expectation of authorization\
    \ for aggregation.  The most common\n   example of this is the advertising and\
    \ accepting of the default route\n   (0/0).  This is a common practice typically\
    \ done by agreement between\n   the two parties.  Obviously, there is not an authorization\
    \ process\n   for such an advertisement.  This advertisement may extend\n   reachability\
    \ beyond the originator's intention (along the lines of\n   the previous example).\
    \  It may cause packets to take paths not known\n   by the sender (since the path\
    \ on 0/0 is simply the advertising AS).\n   It may violate other security constraints.\
    \  This places limits on the\n   power and applicability of efforts to secure\
    \ the AS path and AS\n   policies.  It does not vitiate the underlying value in\
    \ such efforts.\n"
- title: 2.3.1.2.  Owner Aggregation
  contents:
  - "2.3.1.2.  Owner Aggregation\n   In the current instantiation of IP address allocation,\
    \ an AS may\n   receive authorization to advertise 10.1.0.0/16, for instance,\
    \ and may\n   authorize some other party to use (or own) 10.1.1.0/24, a subblock\
    \ of\n   the space authorized.  This is called a suballocation.\n   For instance,\
    \ in this example, if AS65001 were authorized to\n   originate 10.1.0.0/16, it\
    \ could advertise 10.1.0.0/16 towards\n   AS65002, rather than a default route.\
    \  Assume there is some form of\n   authorization mechanism AS65002 can consult\
    \ to verify AS65001 is\n   authorized to advertise 10.1.0.0/16.  In this case,\
    \ AS65002 could\n   examine the authorization of AS65001 to originate 10.1.0.0/16,\
    \ and\n   assume that if AS65002 is authorized to advertise 10.1.0.0/16, it is\n\
    \   also authorized to transit traffic towards every possible subblock of\n  \
    \ (every destination within) 10.1.0.0/16.  To put this in more distinct\n   terms:\n\
    \   o  AS65002 verifies route authorization by examining the\n      authorization\
    \ of AS65001 to advertise 10.1.0.0/16.\n   o  AS65002 assumes destination authorization,\
    \ that AS65001 has the\n      authorization to advertise every possible subblock\
    \ of 10.1.0.0/16,\n      because AS65001 is authorized to advertise 10.1.0.0/16.\n\
    \   o  AS65002 assumes transit authorization, that AS65001 has the\n      authorization\
    \ to transit traffic to every possible subblock of\n      10.1.0.0/16, because\
    \ AS65001 is authorized to advertise\n      10.1.0.0/16.\n   From the example\
    \ given, however, it is obvious route authorization\n   does not equal destination\
    \ or transit authorization.  While AS65001\n   does have route authorization to\
    \ advertise 10.1.0.0/16, it does not\n   have destination authorization to advertise\
    \ 10.1.1.0/24, nor transit\n   authorization for destinations with 10.1.1.0/24.\n\
    \   The naive reply to this would be to simply state that destination and\n  \
    \ transit authorization should not be assumed from route authorization.\n   However,\
    \ the problem is not that simple to resolve.  The assumption\n   of destination\
    \ authorization and transit authorization are not\n   decisions AS65002 actually\
    \ makes; they are embedded in the way the\n   routing system works.  The route\
    \ itself, within the design of\n   routing, carries these implications.\n   Why\
    \ does routing intertwine these three types of authorization?  Most\n   simply,\
    \ because AS65002 does not have any information about subblocks\n   that are part\
    \ of 10.1.0.0/16.  There is no way for AS65002 to check\n   for destination and\
    \ transit authorization because this information is\n   removed from the system\
    \ altogether.  In order to show destination and\n   transit authorization, this\
    \ information must be reinjected into the\n   routing system in some way.\n  \
    \ For instance, considering destination authorization alone, it is\n   possible\
    \ to envision a system where AS65001, when suballocating part\n   of 10.1.0.0/16\
    \ to the originator, must also obtain permission to\n   continue advertising the\
    \ original address block as an aggregate, to\n   attempt to resolve this problem.\
    \  However, this raises some other\n   issues:\n   o  If the originator did not\
    \ agree to AS65001 advertising an\n      aggregate containing 10.1.1.0/24, then\
    \ AS65001 would be forced to\n      advertise some collection of advertisements\
    \ not containing the\n      suballocated block.\n   o  If AS65001 actually does\
    \ obtain permission to advertise the\n      aggregate, we must find some way to\
    \ provide AS65002 with\n      information about this authorization for each possible\
    \ subblock of\n      10.1.0.0/16.\n   In other words, either AS65002 must receive\
    \ the actual routes for\n   each suballocation of 10.1.0.0/16, or it must receive\
    \ some form of\n   authorization allowing AS65001 to advertise each suballocation\
    \ of\n   10.1.0.0/16.  This appears to defeat the purpose of aggregation,\n  \
    \ rendering routing systems much less scalable than current design\n   allows.\
    \  Further, this does not resolve the issue of how AS65002\n   would actually\
    \ know what all the suballocations of 10.1.0.0/16\n   actually are.  Some possible\
    \ solutions could be:\n   o  The suballocator must advertise all suballocations.\
    \  This could\n      potentially expose business relationships and patterns that\
    \ many\n      large commercial providers do not want to expose, and degrades the\n\
    \      hierarchical nature of suballocation altogether.\n   o  The IP address\
    \ space must be reconstructed so everyone using IP\n      address space will know,\
    \ based on the construction of the IP\n      address space, what subblocks exist.\
    \  For instance, the longest\n      allowed subblock could be set at a /24, and\
    \ authorization must be\n      available for every possible /24 in the address\
    \ space, either for\n      origination, or as part of an aggregate.  This sort\
    \ of solution\n      would be an extreme burden on the routing system.\n"
- title: 2.3.1.3.  Proxy Aggregation
  contents:
  - "2.3.1.3.  Proxy Aggregation\n   It is also possible for AS65001 to have some\
    \ form of agreement with\n   AS65002 to aggregate blocks of address space it does\
    \ not own towards\n   AS65002.  This might be done to reduce the burden on BGP\
    \ speakers\n   within AS65002.  This is called proxy aggregation.  While proxy\n\
    \   aggregation is rare, it is useful to examine the result of agreed\n   upon\
    \ proxy aggregation in this situation.\n   Assume AS65001 has an advertisement\
    \ for 10.1.0.0/24 from some unknown\n   source, and decides to advertise both\
    \ 10.1.0.0/24 and 10.1.1.0/24 as\n   10.1.0.0/23 to AS65002.  If there exists\
    \ an agreement for AS65001 to\n   advertise proxy aggregates to AS65002, the latter\
    \ will accept the\n   advertisement regardless of any attached authorization to\
    \ advertise.\n   This may represent a security risk for AS65002, but it might\
    \ be seen\n   as an acceptable risk considering the trade-offs, from AS65002's\n\
    \   perspective.\n   The problem is, however, this also impacts the policies of\
    \ AS65000,\n   which is originating one of the two routes being aggregated by\n\
    \   AS65001.  There is no way for AS65002 to know about this policy, nor\n   to\
    \ react to it, and there is actually no incentive for AS65002 to\n   react to\
    \ a security threat posed to AS65000, which it has no direct\n   relationship\
    \ with.  There doesn't appear to be any immediately\n   available solution to\
    \ this problem, other than to disallow proxy\n   aggregation, even between two\
    \ cooperating autonomous systems.\n"
- title: 2.3.2.  Implications
  contents:
  - "2.3.2.  Implications\n   The basic problem is that AS65002 assumes when AS65001\
    \ advertises an\n   authorized route containing 10.1.1.0/24, either through a\
    \ valid\n   unauthorized aggregate, an owner aggregated route, or a proxy\n  \
    \ aggregation, AS65001 also has destination authorization for the\n   subblock\
    \ 10.1.1.0/24, and transit authorization for destinations\n   within 10.1.1.0/24.\
    \  These are, in fact, invalid assumptions, but\n   they are tied to the way routing\
    \ actually works.  This shows the\n   value of route authorization is questionable,\
    \ unless there is some\n   way to untie destination and transit authorization\
    \ from route\n   advertisements, which are deeply intertwined today.\n"
- title: '2.4.  Third Example: Following a Specific Path'
  contents:
  - "2.4.  Third Example: Following a Specific Path\n   This example is slightly more\
    \ complex than the last two.  Given the\n   following small network, assume that\
    \ A and D have a mutually agreed\n   upon policy of not allowing traffic to transit\
    \ B to reach\n   destinations within 10.1.1.0/25.\n   10.1.1.0/25--A---B---C---D\n\
    \                |       |   |\n                E-------F---G\n   Assume the following:\n\
    \   o  A advertises 10.1.1.0/25 to B, and 10.1.1.0/24 to E.\n   o  B advertises\
    \ 10.1.1.0/25 {B,A} to C.\n   o  E advertises 10.1.1.0/24 {E,A} to F, filtering\
    \ 10.1.1.0/25 {E,A}\n      based on some local policy.\n   o  F advertises 10.1.1.0/24\
    \ {F,E,A} to C and to G.\n   o  C advertises 10.1.1.0/24 {C,F,E,A} to D, filtering\
    \ 10.1.1.0/25\n      {B,A} based on some local policy.\n   o  G advertises 10.1.1.0/24\
    \ {G,F,E,A} to D.\n   o  D chooses 10.1.1.0/24 {C,F,E,A} over 10.1.1.0/24 {G,F,E,A}.\n\
    \   What path will traffic forwarded to C destined to hosts within\n   10.1.1.0/25\
    \ actually follow?\n   o  D forwards this traffic to C, since its best path is\
    \ through\n      10.1.1.0/24 {C,F,E,A}.\n   o  C forwards this traffic to B, since\
    \ its best path is through\n      10.1.1.0/25 {B,A}.\n   o  B forwards this traffic\
    \ to A, since its best path is through\n      10.1.1.0/25 {A}.\n   Considering\
    \ this result:\n   o  Is the AS Path valid?  Both {G, F, E, A} and {C, F, E, A}\
    \ are\n      valid AS Paths, so both AS Paths in this example are valid.\n   o\
    \  Is the advertisement authorized?  Assuming A is authorized to\n      advertise\
    \ 10.1.1.0/24, and all the autonomous systems in the\n      example are authorized\
    \ to readvertise 10.1.1.0/24, the route is\n      authorized.  However, C does\
    \ not have destination nor transit\n      authorization to 10.1.1.0/25, since\
    \ B is the best path from C to\n      10.1.1.0/25, and D and A have explicit policies\
    \ not to transit\n      this path.  In effect, then C does not have destination\
    \ or transit\n      authorization for 10.1.1.0/24, because it contains 10.1.1.0/25.\n\
    \   o  Is the AS Path consistent with the forwarding path (is there\n      forwarding\
    \ consistency)?  While C is advertising the AS Path {C,\n      F, E, A} to D to\
    \ reach destinations within 10.1.1.0/24, it is\n      actually forwarding along\
    \ a different path to some destinations\n      within this advertisement.  Forwarding\
    \ consistency does not exist\n      within this internetwork.\n   In this example,\
    \ A assumes that D will receive both the advertisement\n   for 10.1.1.0/24 and\
    \ the advertisement for 10.1.1.0/25, and will be\n   able to use the included\
    \ AS Path to impose their mutually agreed on\n   policy not to transit B.  Information\
    \ about 10.1.1.0/25, however, is\n   removed from the routing system by policies\
    \ outside the knowledge or\n   control of A or D.  The information remaining in\
    \ the routing system\n   implies D may correctly route to destinations within\
    \ 10.1.1.0/25\n   through C, since 10.1.1.0/25 is contained within 10.1.1.0/24,\
    \ which C\n   is legally advertising.\n   The tension between route authorization,\
    \ destination authorization,\n   and transit authorization can be seen clearly\
    \ in this slightly more\n   complex example.  Route authorization implies destination\
    \ and transit\n   authorization in routing, but route authorization does not include\n\
    \   destination or prefix authorization in this example.\n"
- title: '2.5.  Fourth Example: Interior and Exterior Paths Mismatch'
  contents:
  - "2.5.  Fourth Example: Interior and Exterior Paths Mismatch\n   This is the most\
    \ complex example we will cover in this document.  It\n   can be argued that the\
    \ configuration described in this example is a\n   misconfiguration, but we have\
    \ chosen this example for its simplicity,\n   as an illustration of the complexity\
    \ of the interaction between\n   interior and exterior gateway protocols within\
    \ an autonomous system.\n   BGP route reflectors, particularly when configured\
    \ in a hierarchy,\n   provide many examples of forwarding inconsistency, but they\
    \ are much\n   more complex than this small example.\n    +-----F(9)---------------G(3)--------+\n\
    \    |                         |          |\n    |                  +------+ \
    \         |\n    |                  |                 |\n    |        +---C(2)--+\
    \                 |\n    |        |         |                 |\n   A(1)-----B(2)\
    \       +----------------E(5)--10.1.1.0/24\n    |        |         |         \
    \        |\n    |        +---D(2)--+                 |\n    |                \
    \                    |\n    +------------------H(6)--J(7)--K(8)--+\n   In this\
    \ diagram, each router is labeled, with the AS in which it is\n   contained, in\
    \ parenthesis following the router label.  As its best\n   path to 10.1.1.0/24:\n\
    \      o  Router E is using its local (intra-AS) path.\n      o  Router C is using\
    \ the path through AS3.\n      o  Router D is using the path through Router E.\n\
    \      o  Router B is using the path through Router E.\n   Examining the case\
    \ of Router B more closely, however, we discover\n   that while Router B prefers\
    \ the path it has learned from Router E,\n   that path has been advertised with\
    \ a next hop of Router E itself.\n   However, Router B's best path to this next\
    \ hop (i.e., Router E), as\n   determined by the interior routing protocol, is\
    \ actually through\n   Router C.  Thus, Router B advertises the path {2, 5} to\
    \ Router A, but\n   traffic actually follows the path {2, 3, 5} when Router B\
    \ receives\n   it.\n   The system administrator of AS1 has determined there is\
    \ an attacker\n   in AS3, and has set the policy on router A to avoid any route\
    \ with\n   AS3 in the AS Path.  So, beginning with this rule, it discards the\n\
    \   path learned from AS9.  It now examines the two remaining paths,\n   learned\
    \ from AS2 (B) and AS6, and determines the best path is {2, 5},\n   through AS2\
    \ (B).  However, unknown to A, AS2 (B) is also connected to\n   AS3, and is transiting\
    \ traffic to AS5 via the path {2, 3, 5}.\n   Returning to our questions:\n   o\
    \  Is the AS Path valid?  The AS Path {2, 3, 5} is a valid AS Path.\n   o  Is\
    \ the route authorized?  Assuming each AS along the path is\n      authorized\
    \ to originate, or readvertise, 10.1.1.0/24, the route is\n      authorized. \
    \ Destination authorization is also clear in this\n      situation, since 10.1.1.0/24\
    \ is the single destination throughout\n      the example.  Transit authorization\
    \ is a little more difficult to\n      determine, since the traffic doesn't actually\
    \ flow along the AS\n      Path contained in the routing advertisement.  It's\
    \ impossible to\n      claim the AS Path {2,3,5} is a valid path from either the\
    \ route\n      originator or the traffic originator, since that AS Path is not\n\
    \      the AS Path advertised.  Essentially, Router E assumes transit\n      authorization\
    \ from route authorization, when there is no way to\n      determine that AS3\
    \ is actually authorized to transit traffic to\n      10.1.1.0/24.\n   o  Is the\
    \ AS Path consistent with the forwarding path (is there\n      forwarding consistency)?\
    \  The advertised AS Path is {2, 5}, while\n      the traffic forwarded to the\
    \ destination actually transits {2, 3,\n      5}.  Forwarding is not consistent\
    \ in this example.\n"
- title: 3.  Summary
  contents:
  - "3.  Summary\n   The examples given in this document are not the only possible\n\
    \   examples of forwarding that is inconsistent with the advertised AS\n   Path;\
    \ [ROUTINGLOGIC] also provides some examples, as well.\n   [ASTRACEROUTE] provides\
    \ some interesting background on the practical\n   impact of forwarding that is\
    \ inconsistent with the advertised AS\n   Path, in the context of attempting to\
    \ trace the actual path of\n   packets through a large internetwork, running BGP\
    \ as an exterior\n   gateway protocol.\n   Routing strongly intertwines the concepts\
    \ of route authorization,\n   destination authorization, and transit authorization.\
    \  If a BGP\n   speaker is authorized to advertise a specific route, routing assumes\n\
    \   that it is also authorized to advertise every possible subblock\n   within\
    \ the destination prefix, and the advertiser is authorized to\n   transit packets\
    \ to every destination within the route.  By surveying\n   these examples, we\
    \ see that route authorization does not, in fact,\n   equal destination authorization\
    \ or transit authorization, calling\n   into question the value of route authorization.\n\
    \   There are no easy or obviously scalable solutions to this problem.\n"
- title: 4.  Acknowledgements
  contents:
  - "4.  Acknowledgements\n   We would like to thank Steve Kent for his contributions\
    \ and comments\n   on this document.  We would also like to thank Joel Halpern\
    \ for his\n   work in clarifying many sections of the document, including\n  \
    \ additional text in critical sections.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   This document does not propose any new extensions\
    \ or additions to\n   existing or proposed protocols, and so does not impact the\
    \ security\n   of any protocol.\n"
- title: 6.  Informative References
  contents:
  - "6.  Informative References\n   [ASTRACEROUTE] Feamster, N. and H. Balakrishnan,\
    \ \"Towards an Accurate\n                  ASLevel Traceroute Tool\", SIGCOMM\
    \ ACM SIGCOMM, 2003.\n   [BGP-MD5]      Heffernan, A., \"Protection of BGP Sessions\
    \ via the TCP\n                  MD5 Signature Option\", RFC 2385, August 1998.\n\
    \   [RFC4271]      Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., \"A\n   \
    \               Border Gateway Protocol 4 (BGP-4)\", RFC 4271, January\n     \
    \             2006.\n   [ROUTINGLOGIC] Feamster, N. and H. Balakrishnan, \"Towards\
    \ a Logic for\n                  Wide Area Routing\", SIGCOMM ACM SIGCOMM Worshop\
    \ on\n                  Future Directions in Network Architecture, Germany,\n\
    \                  August 2003.\n   [SOBGP]        White, R., \"Architecture and\
    \ Deployment Considerations\n                  for Secure Origin BGP (soBGP)\"\
    , Work in Progress.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Russ White\n   Cisco Systems\n   EMail: riw@cisco.com\n\
    \   Bora Akyol\n   Cisco Systems\n   EMail: bora@cisco.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2008).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78\
    \ and at www.rfc-editor.org/copyright.html, and\n   except as set forth therein,\
    \ the authors retain all their rights.\n   This document and the information contained\
    \ herein are provided on an\n   \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION\
    \ HE/SHE REPRESENTS\n   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE\
    \ IETF TRUST AND\n   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,\
    \ EXPRESS\n   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE\
    \ OF\n   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n\
    \   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
