- title: __initial_text__
  contents:
  - "     Two-Way Active Measurement Protocol (TWAMP) Reflect Octets and\n       \
    \                Symmetrical Size Features\n"
- title: Abstract
  contents:
  - "Abstract\n   This memo describes two closely related features for the core\n\
    \   specification of the Two-Way Active Measurement Protocol (TWAMP): an\n   optional\
    \ capability where the responding host returns some of the\n   command octets\
    \ or padding octets to the sender, and an optional\n   sender packet format that\
    \ ensures equal test packet sizes are used in\n   both directions.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6038.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Requirements Language ...........................................3\n  \
    \ 3. Purpose and Scope ...............................................4\n   4.\
    \ TWAMP Control Extensions ........................................4\n      4.1.\
    \ Connection Setup with New Features .........................5\n      4.2. Reflect\
    \ Octets: Request-TW-Session Packet Format ...........6\n      4.3. Reflect Octets:\
    \ Accept Session Packet Format ...............7\n      4.4. Additional Considerations\
    \ ..................................9\n   5. Extended TWAMP Test .............................................9\n\
    \      5.1. Sender Behavior ............................................9\n  \
    \         5.1.1. Packet Timings ......................................9\n    \
    \       5.1.2. Reflect Octets: Packet Formats and Contents .........9\n      \
    \     5.1.3. Reflect Octets: Interaction with Padding\n                  Truncation\
    \ .........................................11\n           5.1.4. Symmetrical Size:\
    \ Session-Sender Packet Format .....13\n           5.1.5. Symmetrical Size AND\
    \ Reflect Octets:\n                  Session-Sender Packet ..............................14\n\
    \      5.2. Reflector Behavior ........................................14\n  \
    \         5.2.1. Reflect Octets: Session-Reflector Packet\n                  Format\
    \ and Contents ................................15\n           5.2.2. Symmetrical\
    \ Size: Session-Reflector Packet Format ..16\n           5.2.3. Symmetrical Size\
    \ AND Reflect Octets:\n                  Session-Sender Packet Format .......................16\n\
    \   6. Security Considerations ........................................17\n  \
    \ 7. IANA Considerations ............................................17\n    \
    \  7.1. Registry Specification ....................................17\n      7.2.\
    \ Registry Contents .........................................17\n   8. Acknowledgements\
    \ ...............................................17\n   9. Normative References\
    \ ...........................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The Two-Way Active Measurement Protocol (TWAMP) [RFC5357]\
    \ is an\n   extension of the One-way Active Measurement Protocol (OWAMP)\n   [RFC4656].\
    \  The TWAMP specification gathered wide review as it\n   approached completion,\
    \ and the by-products were several\n   recommendations for new features in TWAMP.\n\
    \   This memo describes two closely related features for TWAMP.\n   One is the\
    \ OPTIONAL capability for the responder host to return a\n   limited number of\
    \ unassigned (padding) octets to the Control-Client\n   or Session-Sender entities\
    \ in both the TWAMP-Control and TWAMP-Test\n   protocols.  With this capability,\
    \ the Control-Client or Session-\n   Sender can embed octets of information it\
    \ deems useful and have the\n   assurance that the corresponding reply/test packet\
    \ will contain that\n   information when it is reflected and returned (by the\
    \ Server or\n   Session-Reflector).\n   The memo also adds an OPTIONAL capability\
    \ to ensure that reflected\n   test packets are the same size in both directions\
    \ of transmission.\n   This is accomplished by specifying a new TWAMP-Test Session-Sender\n\
    \   packet format.  Although TWAMP [RFC5357] recommends padding\n   truncation\
    \ to achieve symmetrical sizes (to compensate for the\n   Session-Reflector's\
    \ larger test packet header), it's not guaranteed\n   that the Session-Reflector\
    \ will truncate the padding, and it's not\n   possible if there's insufficient\
    \ padding.\n   This memo is an update to the TWAMP core protocol specified in\n\
    \   [RFC5357].  Measurement systems are not required to implement the\n   features\
    \ described in this memo to claim compliance with [RFC5357].\n   Throughout this\
    \ memo, the bits marked MBZ (Must Be Zero) MUST be set\n   to zero by senders\
    \ and MUST be ignored by receivers.  Also, the HMAC\n   (Hashed Message Authentication\
    \ Code) MUST be calculated as defined in\n   Section 3.2 of [RFC4656].\n"
- title: 2.  Requirements Language
  contents:
  - "2.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n"
- title: 3.  Purpose and Scope
  contents:
  - "3.  Purpose and Scope\n   The purpose of this memo is to define two OPTIONAL\
    \ closely related\n   features for TWAMP [RFC5357].  The features enhance the\
    \ TWAMP host's\n   capabilities to perform a simple operation on control and test\n\
    \   packets: the reflection of octets or padding, and the capability to\n   ensure\
    \ symmetrical size TWAMP-Test packets.  Motivations include\n   permitting the\
    \ controller host to tag packets with an index for\n   simplified identification,\
    \ and/or assert that the same size test\n   packets will be used in each direction.\n\
    \   The scope of the memo is limited to specifications of the following\n   features:\n\
    \   o  Reflect Octets: the capability of the Server/Session-Reflector to\n   \
    \   reflect specific octets back to the Client/Session-Sender, and a\n      similar\
    \ service provided by the Client and Session-Sender.\n   o  Symmetrical Size:\
    \ the capability to ensure that TWAMP-Test\n      protocol uses the same packet\
    \ size in both directions through\n      support of a new TWAMP-Test Session-Sender\
    \ test packet format in\n      both the Session-Sender and the Session-Reflector.\
    \  Only the\n      Session-Sender test packet format is new.\n   This memo extends\
    \ the modes of operation through assignment of two\n   new values in the Modes\
    \ field (see Section 3.1 of [RFC4656] for the\n   format of the Server Greeting\
    \ message), while retaining backward\n   compatibility with the core TWAMP [RFC5357]\
    \ implementations.  The two\n   new values correspond to the two features defined\
    \ in this memo.\n   When the Server and Control-Client have agreed to use the\
    \ Reflect\n   Octets mode during control connection setup, then the Control-Client,\n\
    \   the Server, the Session-Sender, and the Session-Reflector MUST all\n   conform\
    \ to the requirements of that mode, as identified below.\n   When the Server and\
    \ Control-Client have agreed to use the Symmetrical\n   Size mode during control\
    \ connection setup, then the Control-Client,\n   the Server, the Session-Sender,\
    \ and the Session-Reflector MUST all\n   conform to the requirements of that mode,\
    \ as identified below.\n"
- title: 4.  TWAMP Control Extensions
  contents:
  - "4.  TWAMP Control Extensions\n   TWAMP-Control protocol [RFC5357] uses the Modes\
    \ field to identify and\n   select specific communication capabilities, and this\
    \ field is a\n   recognized extension mechanism.  The following sections describe\
    \ two\n   such extensions.\n"
- title: 4.1.  Connection Setup with New Features
  contents:
  - "4.1.  Connection Setup with New Features\n   TWAMP connection establishment follows\
    \ the procedure defined in\n   Section 3.1 of [RFC4656] and Section 3.1 of [RFC5357].\
    \  The new\n   features require two new bit positions (and values) to identify\
    \ the\n   ability of the Server/Session-Reflector to reflect specific octets\n\
    \   back to the Control-Client/Session-Sender, and to support the new\n   Session-Sender\
    \ packet format in the TWAMP-Test protocol.  See the\n   IANA section for details\
    \ on the assigned values and bit positions.\n   The Server sets one or both of\
    \ the new bit positions in the Modes\n   field of the Server Greeting message\
    \ to indicate its capabilities and\n   willingness to operate in either of these\
    \ modes (or both) if desired.\n   If the Control-Client intends to operate all\
    \ test sessions invoked\n   with this control connection using one or both of\
    \ the new modes, it\n   MUST set the Mode field bit corresponding to each function\
    \ in the\n   Setup Response message.  With this and other extensions, the Control-\n\
    \   Client MAY set multiple Mode field bits in the Setup Response\n   message.\n"
- title: '4.2.  Reflect Octets: Request-TW-Session Packet Format'
  contents:
  - "4.2.  Reflect Octets: Request-TW-Session Packet Format\n   The bits designated\
    \ for the Reflect Octets feature in the Request-TW-\n   Session command are as\
    \ shown in the packet format below.\n    0                   1               \
    \    2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      5        |  MBZ  | IPVN  |  Conf-Sender  | Conf-Receiver |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                  Number of Schedule Slots                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   .                                                               .\n   .  \
    \         ... Many fields (66 octets) not shown ...           .\n   .        \
    \                                                       .\n   .              \
    \                                                 .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                    Padding Length  (4 octets)                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                      Start Time  (8 octets)                   |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       Timeout  (8 octets)                     |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       Type-P Descriptor                       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Octets to be reflected    |  Length of padding to reflect |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       MBZ (4 octets)                          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   |  \
    \                     HMAC (16 octets)                        |\n   |        \
    \                                                       |\n   |              \
    \                                                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   It is important to note that the Padding Length field continues to\n   specify\
    \ the number of padding octets that the Session-Sender will\n   append to ALL\
    \ TWAMP-Test packets associated with this test session.\n   See below for considerations\
    \ on the minimum length of the padding\n   octets following the definitions of\
    \ the two new fields that follow\n   the Type-P Descriptor.\n   Note that the\
    \ number of padding octets appended to the Session-\n   Reflector's test packet\
    \ depends on support for the truncation process\n   that TWAMP recommends, see\
    \ Section 4.2.1 of [RFC5357].\n   The Octets to be reflected field SHALL be 2\
    \ octets long, as shown,\n   and contain the octets that the Server MUST reflect\
    \ in the Accept\n   Session message as specified below.\n   The Length of padding\
    \ to reflect field SHALL be 2 octets long and\n   contain an unsigned binary value\
    \ in units of octets.  This field\n   communicates the length of the padding in\
    \ the TWAMP-Test Packet that\n   the Session-Sender expects to be reflected and\
    \ the length of octets\n   that the Session-Reflector SHALL return in its TWAMP-Test\
    \ packet\n   format (see Section 5.2).  By including this length field in the\n\
    \   Request-TW-Session message, a Server is able to determine if it can\n   comply\
    \ with a specific request to reflect padding in the TWAMP-Test\n   packets and\
    \ to arrange for the Session-Reflector processing in\n   advance.\n   The Padding\
    \ Length SHOULD be >= 27 octets when specifying a test\n   session using the Unauthenticated\
    \ TWAMP-Test mode to allow for the\n   truncation process that TWAMP recommends,\
    \ see Section 4.2.1 of\n   [RFC5357].\n   The Padding Length SHOULD be >= 56 octets\
    \ when specifying a test\n   session using the Authenticated or Encrypted TWAMP-Test\
    \ modes to\n   allow for the truncation process that TWAMP recommends, see Section\n\
    \   4.2.1 of [RFC5357].\n   The Padding Length SHALL be > the Length of padding\
    \ to reflect when\n   specifying a test session using the OPTIONAL Reflect Octets\
    \ mode.\n   In Unauthenticated TWAMP-Test mode, the Padding Length SHALL be >=\
    \ 27\n   + Length of padding to reflect octets when specifying a test session\n\
    \   using both the OPTIONAL Reflect Octets mode and the truncation\n   process\
    \ that TWAMP recommends, see Section 4.2.1 of [RFC5357].\n   In Authenticated\
    \ or Encrypted TWAMP-Test modes, the Padding Length\n   SHALL be >= 56 + Length\
    \ of padding to reflect octets when specifying\n   a test session using both the\
    \ OPTIONAL Reflect Octets mode and the\n   truncation process that TWAMP recommends,\
    \ see Section 4.2.1 of\n   [RFC5357].\n"
- title: '4.3.  Reflect Octets: Accept Session Packet Format'
  contents:
  - "4.3.  Reflect Octets: Accept Session Packet Format\n   The bits designated for\
    \ the Reflect Padding feature in the Accept\n   Session command are as shown in\
    \ the packet format below.\n    0                   1                   2    \
    \               3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Accept     |      MBZ      |            Port               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|\n\
    \   |                                                               |\n   |  \
    \                      SID (16 octets)                        |\n   |        \
    \                                                       |\n   |              \
    \                                                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |       Reflected octets        |         Server octets         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                       MBZ (8 octets)                          |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   |  \
    \                     HMAC (16 octets)                        |\n   |        \
    \                                                       |\n   |              \
    \                                                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The Reflected octets field SHALL contain the octets from the Request-\n  \
    \ TW-Session Octets to be reflected field and be 2 octets long, as\n   shown.\n\
    \   The Server octets field SHALL contain information that the Server\n   intends\
    \ to be returned in the TWAMP-Test Packet Padding (to be\n   reflected) field,\
    \ OR SHALL be zero, and be 2 octets long, as shown.\n   Although the Server determines\
    \ the SID, this field is very long (16\n   octets) and does not normally appear\
    \ in TWAMP-Test packets.  The\n   following items MUST be part of compliant implementations\
    \ using the\n   Reflect Octets feature:\n   o  When a Server does not require\
    \ octets to be returned in TWAMP-Test\n      packets, it MUST send all zeros in\
    \ the Server octets field.\n   o  When a Server intends octets to be returned\
    \ in TWAMP-Test packets,\n      it MUST send a non-zero value in the Server octets\
    \ field, and the\n      TWAMP-Test Sender MUST include those octets at the beginning\
    \ of\n      the Packet Padding (to be reflected) field.\n   o  Section 4.1.2 defines\
    \ how Server octets MUST be included in the\n      TWAMP-Test packet padding when\
    \ this service is desired by the\n      Server (indicated in the second of two\
    \ figures in this section).\n   When performing the truncation process that TWAMP\
    \ recommends, see\n   Section 4.2.1 of [RFC5357], if calculations on the Padding\
    \ lengths\n   reveal that there are insufficient octets supplied to produce equal-\n\
    \   length Session-Sender and Session-Reflector test packets, then the\n   Accept\
    \ field MUST be set to 3 to indicate that some aspect of the\n   request is not\
    \ supported.\n"
- title: 4.4.  Additional Considerations
  contents:
  - "4.4.  Additional Considerations\n   The value of the Modes field sent by the\
    \ Server in the Server\n   Greeting message is the bit-wise OR of the mode values\
    \ that it is\n   willing to support during this session.\n   With the publication\
    \ of this memo as an RFC, the last 7 bit positions\n   of the Modes 32-bit field\
    \ are used.  A Control-Client conforming to\n   this extension of [RFC5357] MAY\
    \ ignore the values in the higher bits\n   of the Modes field, or it MAY support\
    \ other features that are\n   communicated in those bit positions.  The other\
    \ bits are available\n   for future protocol extensions.\n"
- title: 5.  Extended TWAMP Test
  contents:
  - "5.  Extended TWAMP Test\n   The TWAMP-Test protocol is similar to the OWAMP [RFC4656]\
    \ test\n   protocol with the exception that the Session-Reflector transmits test\n\
    \   packets to the Session-Sender in response to each test packet it\n   receives.\
    \  TWAMP, see Section 4 of [RFC5357], defines two additional\n   test packet formats\
    \ for packets transmitted by the Session-Reflector.\n   The appropriate format\
    \ depends on the security mode chosen.  The new\n   modes specified here utilize\
    \ some of the padding octets within each\n   test packet format or require truncation\
    \ of those octets depending on\n   the security mode in use.\n"
- title: 5.1.  Sender Behavior
  contents:
  - "5.1.  Sender Behavior\n   This section describes extensions to the behavior of\
    \ the TWAMP\n   Session-Sender.\n"
- title: 5.1.1.  Packet Timings
  contents:
  - "5.1.1.  Packet Timings\n   The Send Schedule is not utilized in TWAMP, and this\
    \ is unchanged in\n   this memo.\n"
- title: '5.1.2.  Reflect Octets: Packet Formats and Contents'
  contents:
  - "5.1.2.  Reflect Octets: Packet Formats and Contents\n   The Session-Sender packet\
    \ format and content follow the same\n   procedure and guidelines as defined in\
    \ Section 4.1.2 of [RFC4656] (as\n   indicated in Section 4.1.2 of [RFC5357]).\n\
    \   The Reflect Octets mode re-designates the original TWAMP-Test Packet\n   Padding\
    \ field (see Section 4.1.2 of [RFC4656]), as shown below for\n   Unauthenticated\
    \ mode:\n    0                   1                   2                   3\n \
    \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                        Sequence Number                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          Timestamp                            |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         Error Estimate        |                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \                               +\n   |                                      \
    \                         |\n   |                  Packet Padding (to be reflected)\
    \             |\n   .               (length in octets specified in command)  \
    \       .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   .                                                               .\n   .  \
    \                Additional Packet Padding                    .\n   .        \
    \                                                       .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The Packet Padding (to be reflected) field SHALL correspond to the\n   length\
    \ of octets specified in the Request-TW-Session Length of\n   padding to reflect\
    \ field to this test session.  These are the octets\n   that the Session-Sender\
    \ expects will be returned by the Session-\n   Reflector.\n   The length of the\
    \ Additional Packet Padding field is the difference\n   between two fields in\
    \ the Request-TW-Session command, as follows:\n   Additional Packet Padding, in\
    \ octets =\n   Padding Length - Length of padding to reflect\n   When a Server\
    \ intends octets to be returned in TWAMP-Test packets, it\n   MUST send a non-zero\
    \ value in the Server octets field, and the TWAMP-\n   Test Session-Sender MUST\
    \ include those octets in the first 2 octets\n   of the Packet Padding (to be\
    \ reflected) field as shown below:\n    0                   1                \
    \   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1\n                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                   |         Server octets         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   |  \
    \            Remaining Packet Padding (to be reflected)       |\n   .        \
    \     (total length in octets specified in command)     .\n   .              \
    \                                                 .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   The Server octets field contains the same information that the Server\n  \
    \ returned to the Control-Client in the Accept-Session message\n   corresponding\
    \ to this specific test session (see Section 4.3).  At\n   the Session-Reflector,\
    \ these octets MUST be reflected the same as the\n   rest of the Packet Padding\
    \ (to be reflected) field.\n   Note that it is permissible for the Session-Sender\
    \ to insert the same\n   octets used in the Octets to be reflected field of the\
    \ Request-TW-\n   Session command elsewhere in the Packet Padding (to be reflected)\n\
    \   field.\n"
- title: '5.1.3.  Reflect Octets: Interaction with Padding Truncation'
  contents:
  - "5.1.3.  Reflect Octets: Interaction with Padding Truncation\n   When the Reflect\
    \ Octets mode is selected, and performing the\n   truncation process that TWAMP\
    \ recommends, see Section 4.2.1 of\n   [RFC5357], the Session-Sender MUST anticipate\
    \ a minimum padding\n   required to achieve equal-size test packets in both directions.\
    \  The\n   amount of padding needed to achieve symmetrical packet size depends\n\
    \   on both the security mode (Unauthenticated/Authenticated/Encrypted)\n   and\
    \ whether the Reflect Octets mode is selected simultaneously.\n   When using the\
    \ truncation process in TWAMP alone, see Section 4.2.1\n   of [RFC5357], the Session-Sender\
    \ MUST append sufficient Packet\n   Padding octets to allow the same IP packet\
    \ payload lengths to be used\n   in each direction of transmission (this is usually\
    \ desirable).  To\n   compensate for the Session-Reflector's larger test packet\
    \ format, the\n   Session-Sender MUST append at least 27 octets of padding in\n\
    \   Unauthenticated mode, and at least 56 octets in Authenticated and\n   Encrypted\
    \ modes.  The sizes of TWAMP-Test protocol packets and the\n   resulting truncated\
    \ padding to achieve equal packet sizes in both\n   directions are shown in the\
    \ table below:\n    +-------------------+----------------------+---------------------+\n\
    \    | Octets in:        | Unauthenticated Mode | Auth/Encrypted Mode |\n    +-------------------+----------------------+---------------------+\n\
    \    | Reflector Header  | 41                   | 104                 |\n    |\
    \ Sender Header     | 14                   | 48                  |\n    | Truncated\
    \ Padding | 27                   | 56                  |\n    +-------------------+----------------------+---------------------+\n\
    \                       TWAMP-Test Padding Truncation\n   When using the Reflect\
    \ Octets mode simultaneously with the truncation\n   process that TWAMP recommends\
    \ in Section 4.2.1 of [RFC5357], the\n   Session-Sender MUST append at least 27\
    \ octets of padding plus the\n   Length of the padding to reflect octets when\
    \ operating in\n   Unauthenticated mode.  The Session-Sender MUST append at least\
    \ 56\n   octets of padding plus the Length of the padding to reflect octets\n\
    \   when operating in Authenticated and Encrypted modes.\n"
- title: '5.1.4.  Symmetrical Size: Session-Sender Packet Format'
  contents:
  - "5.1.4.  Symmetrical Size: Session-Sender Packet Format\n   When the Symmetrical\
    \ Size mode is selected, the Session-Sender SHALL\n   use the following TWAMP-Test\
    \ Packet Format in Unauthenticated mode:\n   Unauthenticated Mode\n    0     \
    \              1                   2                   3\n    0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                        Sequence Number                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          Timestamp                            |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         Error Estimate        |                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \                               +\n   |                                      \
    \                         |\n   |                                            \
    \                   |\n   |                         MBZ (27 octets)          \
    \             |\n   |                                                        \
    \       |\n   |                                                              \
    \ |\n   |                                                               |\n  \
    \ +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |    \
    \           |                                               |\n   +-+-+-+-+-+-+-+-+\
    \                                               +\n   .                      \
    \                                         .\n   .                        Packet\
    \ Padding                         .\n   .                                    \
    \                           .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   This feature REQUIRES only a new Session-Sender test packet format,\n   the\
    \ Session-Reflector test packet format is unchanged.\n"
- title: '5.1.5.  Symmetrical Size AND Reflect Octets: Session-Sender Packet'
  contents:
  - "5.1.5.  Symmetrical Size AND Reflect Octets: Session-Sender Packet\n        Format\n\
    \   When both the Symmetrical Size mode and the Reflect Octets mode are\n   selected,\
    \ the Session-Sender SHALL use the following TWAMP-Test\n   Packet Format in Unauthenticated\
    \ mode:\n   Unauthenticated Mode\n    0                   1                  \
    \ 2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                        Sequence Number                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                          Timestamp                            |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |         Error Estimate        |                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
    \                               +\n   |                                      \
    \                         |\n   |                                            \
    \                   |\n   |                         MBZ (27 octets)          \
    \             |\n   |                                                        \
    \       |\n   |                                                              \
    \ |\n   |                                                               |\n  \
    \ +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   |    \
    \           |                                               |\n   +-+-+-+-+-+-+-+-+\
    \                                               +\n   |                  Packet\
    \ Padding (to be reflected)             |\n   .               (length in octets\
    \ specified in command)         .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   .                                                               .\n   .  \
    \                Additional Packet Padding                    .\n   .        \
    \                                                       .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   In this combined mode, the Packet Padding to be reflected follows the\n  \
    \ 27 MBZ octets.  In Authenticated or Encrypted modes, the Packet\n   Padding\
    \ to be reflected follows the 56 MBZ octets.\n"
- title: 5.2.  Reflector Behavior
  contents:
  - "5.2.  Reflector Behavior\n   The TWAMP Reflector follows the procedures and guidelines\
    \ in Section\n   4.2 of [RFC5357], with the following additional functions:\n\
    \   o  Reflect Octets mode: Designated octets in the Packet Padding (to\n    \
    \  be reflected) field of the Session-Sender's test packet MUST be\n      included\
    \ in the Session-Reflector's test packet.\n   o  Symmetrical Size mode: The Session-Reflector\
    \ MUST operate using\n      the Session_Reflector Packet Format defined in Section\
    \ 5.1.4,\n      where the Padding Octets are separated from the information\n\
    \      fields.\n"
- title: '5.2.1.  Reflect Octets: Session-Reflector Packet Format and Contents'
  contents:
  - "5.2.1.  Reflect Octets: Session-Reflector Packet Format and Contents\n   The\
    \ Reflect Padding feature re-designates the Packet Padding field,\n   as shown\
    \ below.  When the Reflect Octets mode is selected, the\n   Session-Sender SHALL\
    \ use the following TWAMP-Test Packet Format in\n   Unauthenticated mode:\n  \
    \  0                   1                   2                   3\n    0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                        Sequence Number                        |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                          Timestamp                            |\n    |\
    \                                                               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |         Error Estimate        |           MBZ                 |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                          Receive Timestamp                    |\n    |\
    \                                                               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                        Sender Sequence Number                 |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                      Sender Timestamp                         |\n    |\
    \                                                               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |      Sender Error Estimate    |           MBZ                 |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |  Sender TTL   |         Packet Padding (from Session-Sender)  |\n    +-+-+-+-+-+-+-+-+\
    \                                               +\n    .                     \
    \                                          .\n    +                          \
    \                     +-+-+-+-+-+-+-+-+\n    |          Packet Padding (from Session-Sender)\
    \ |               |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   \
    \            +\n    |                                                        \
    \       |\n    |                                                             \
    \  |\n    .                  Additional Packet Padding                    .\n\
    \    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   The\
    \ Packet Padding (from Session-Sender) field MUST be the same\n   octets as the\
    \ Packet Padding (to be reflected) field in the Session-\n   Sender's test packet,\
    \ and therefore MUST conform to the length\n   specified in the Request-TW-Session\
    \ message.\n   When the Server has returned a non-zero value in the Server octets\n\
    \   field of the Accept Session message (as described in Section 4.3),\n   then\
    \ the Session-Reflector SHALL reflect these octets the same as the\n   rest of\
    \ the Packet Padding (to be reflected) field.\n   Section 4.2.1 of [RFC5357] recommends\
    \ a padding truncation process\n   for use in TWAMP.  When using that process\
    \ in conjunction with the\n   Reflect Octets mode, the Session-Reflector MUST\
    \ reflect the\n   designated octets from the Session-Sender's test packet in the\
    \ Packet\n   Padding (from Session-Sender) field, and MAY re-use additional Packet\n\
    \   Padding from the Session-Sender.  The Session-Reflector MUST truncate\n  \
    \ the padding such that the highest number octets are discarded, and\n   the test\
    \ packet length equals the Session-Sender's packet length.\n   When using the\
    \ recommended truncation process, the Session-Reflector\n   MUST truncate exactly\
    \ 27 octets of padding in Unauthenticated mode,\n   and exactly 56 octets in Authenticated\
    \ and Encrypted modes.\n   In any case, the Session-Reflector MAY re-use the Sender's\
    \ Packet\n   Padding (since the requirements for padding generation are the same\n\
    \   for each).\n"
- title: '5.2.2.  Symmetrical Size: Session-Reflector Packet Format'
  contents:
  - "5.2.2.  Symmetrical Size: Session-Reflector Packet Format\n   When Symmetrical\
    \ Size mode is selected, the Session-Reflector packet\n   formats for Unauthenticated\
    \ and Authenticated/Encrypted modes are\n   identical to the core TWAMP specification,\
    \ see Section 4.2.1 of\n   [RFC5357].  Thus, the Session-Reflector test packet\
    \ format is\n   unchanged.\n   The Session-Reflector MUST construct its test packet\
    \ using the\n   information in the Session-Sender's test packet.  The length of\
    \ the\n   Session-Reflector's test packet SHALL equal the length of the\n   Session-Sender's\
    \ test packet.\n"
- title: '5.2.3.  Symmetrical Size AND Reflect Octets: Session-Sender Packet'
  contents:
  - "5.2.3.  Symmetrical Size AND Reflect Octets: Session-Sender Packet\n        Format\n\
    \   When both the Symmetrical Size mode and the Reflect Octets mode are\n   selected,\
    \ the Session-Reflector MUST operate using the Session-Sender\n   Packet Format\
    \ defined in Section 5.1.5, where the Padding Octets are\n   separated from the\
    \ information fields, and the Packet Padding (to be\n   reflected) field precedes\
    \ the Additional Padding.\n   The Session-Reflector SHALL use the same TWAMP-Test\
    \ Packet Format as\n   specified in Section 5.2.1, above.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   These extended modes of operation do not appear\
    \ to permit any new\n   attacks on hosts communicating with core TWAMP [RFC5357].\n\
    \   The security considerations that apply to any active measurement of\n   live\
    \ networks are relevant here as well.  See [RFC4656] and\n   [RFC5357].\n"
- title: 7.  IANA Considerations
  contents:
  - "7.  IANA Considerations\n   This memo adds two modes to the IANA registry for\
    \ the TWAMP Modes\n   field, and describes behavior when the new modes are used.\
    \  This\n   field is a recognized extension mechanism for TWAMP.\n"
- title: 7.1.  Registry Specification
  contents:
  - "7.1.  Registry Specification\n   IANA has created a TWAMP-Modes registry (as\
    \ requested in [RFC5618]).\n   TWAMP-Modes are specified in TWAMP Server Greeting\
    \ messages and Setup\n   Response messages, as described in Section 3.1 of [RFC5357],\n\
    \   consistent with Section 3.1 of [RFC4656], and extended by this memo.\n   Modes\
    \ are indicated by setting bits in the 32-bit Modes field that\n   correspond\
    \ to values in the Modes registry.  For the TWAMP-Modes\n   registry, we expect\
    \ that new features will be assigned increasing\n   registry values that correspond\
    \ to single bit positions, unless there\n   is a good reason to do otherwise (more\
    \ complex encoding than single-\n   bit positions may be used in the future to\
    \ access the 2^32 value\n   space).\n"
- title: 7.2.  Registry Contents
  contents:
  - "7.2.  Registry Contents\n   The TWAMP-Modes registry has been augmented as follows:\n\
    \   Value  Description             Semantics Definition\n   --------------------------------------------------------\n\
    \   32     Reflect Octets          this memo, Section 3.1\n          Capability\
    \              new bit position (5)\n   64     Symmetrical Size        this memo,\
    \ Section 3.1\n          Sender Test Packet Format new bit position (6)\n"
- title: 8.  Acknowledgements
  contents:
  - "8.  Acknowledgements\n   The authors thank Steve Baillargeon, Walt Steverson,\
    \ and Stina Ross\n   for helpful review and comments.\n"
- title: 9.  Normative References
  contents:
  - "9.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in RFCs\
    \ to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March 1997.\n\
    \   [RFC4656]  Shalunov, S., Teitelbaum, B., Karp, A., Boote, J., and M.\n   \
    \           Zekauskas, \"A One-way Active Measurement Protocol\n             \
    \ (OWAMP)\", RFC 4656, September 2006.\n   [RFC5357]  Hedayat, K., Krzanowski,\
    \ R., Morton, A., Yum, K., and J.\n              Babiarz, \"A Two-Way Active Measurement\
    \ Protocol (TWAMP)\",\n              RFC 5357, October 2008.\n   [RFC5618]  Morton,\
    \ A. and K. Hedayat, \"Mixed Security Mode for the\n              Two-Way Active\
    \ Measurement Protocol (TWAMP)\", RFC 5618,\n              August 2009.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Al Morton\n   AT&T Labs\n   200 Laurel Avenue South\n\
    \   Middletown, NJ  07748\n   USA\n   Phone: +1 732 420 1571\n   Fax:   +1 732\
    \ 368 1192\n   EMail: acmorton@att.com\n   URI:   http://home.comcast.net/~acmacm/\n\
    \   Len Ciavattone\n   AT&T Labs\n   200 Laurel Avenue South\n   Middletown, NJ\
    \  07748\n   USA\n   Phone: +1 732 420 1239\n   EMail: lencia@att.com\n"
