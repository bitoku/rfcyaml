- title: __initial_text__
  contents:
  - '                 Real-time Inter-network Defense (RID)

    '
- title: Abstract
  contents:
  - "Abstract\n   Security incidents, such as system compromises, worms, viruses,\n\
    \   phishing incidents, and denial of service, typically result in the\n   loss\
    \ of service, data, and resources both human and system.  Service\n   providers\
    \ and Computer Security Incident Response Teams need to be\n   equipped and ready\
    \ to assist in communicating and tracing security\n   incidents with tools and\
    \ procedures in place before the occurrence of\n   an attack.  Real-time Inter-network\
    \ Defense (RID) outlines a\n   proactive inter-network communication method to\
    \ facilitate sharing\n   incident-handling data while integrating existing detection,\
    \ tracing,\n   source identification, and mitigation mechanisms for a complete\n\
    \   incident-handling solution.  Combining these capabilities in a\n   communication\
    \ system provides a way to achieve higher security levels\n   on networks.  Policy\
    \ guidelines for handling incidents are\n   recommended and can be agreed upon\
    \ by a consortium using the security\n   recommendations and considerations. \
    \ This document obsoletes RFC\n   6045.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6545.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Changes from RFC 6045 ......................................5\n  \
    \    1.2. Normative and Informative ..................................6\n    \
    \  1.3. Terminology ................................................7\n   2. Characteristics\
    \ of Incidents ....................................7\n   3. Communication between\
    \ CSIRTs and Service Providers ..............8\n      3.1. Inter-Service-Provider\
    \ RID Messaging ......................10\n      3.2. RID Communication Topology\
    \ ................................12\n   4. Message Formats ................................................13\n\
    \      4.1. RID Data Types ............................................13\n  \
    \         4.1.1. Boolean ............................................13\n    \
    \  4.2. RID Message Types .........................................14\n   5. IODEF-RID\
    \ Schema ...............................................15\n      5.1. RIDPolicy\
    \ Class ...........................................17\n           5.1.1. ReportSchema\
    \ .......................................23\n      5.2. RequestStatus .............................................26\n\
    \      5.3. IncidentSource ............................................28\n  \
    \    5.4. RID Name Spaces ...........................................29\n    \
    \  5.5. Encoding ..................................................29\n      5.6.\
    \ Including IODEF or Other XML Documents ....................29\n           5.6.1.\
    \ Including XML Documents in RID .....................30\n   6. RID Messages ...................................................31\n\
    \      6.1. Request ...................................................31\n  \
    \    6.2. Acknowledgement ...........................................33\n    \
    \  6.3. Result ....................................................34\n      6.4.\
    \ Report ....................................................36\n      6.5. Query\
    \ .....................................................38\n   7. RID Communication\
    \ Exchanges ....................................39\n      7.1. Upstream Trace\
    \ Communication Flow .........................40\n           7.1.1. RID TraceRequest\
    \ Example ...........................43\n           7.1.2. Acknowledgement Message\
    \ Example ....................47\n           7.1.3. Result Message Example .............................47\n\
    \      7.2. Investigation Request Communication Flow ..................50\n  \
    \         7.2.1. Investigation Request Example ......................51\n    \
    \       7.2.2. Acknowledgement Message Example ....................53\n      7.3.\
    \ Report Communication Flow .................................54\n           7.3.1.\
    \ Report Example .....................................54\n      7.4. Query Communication\
    \ Flow ..................................56\n           7.4.1. Query Example ......................................57\n\
    \   8. RID Schema Definition ..........................................58\n  \
    \ 9. Security Requirements ..........................................62\n    \
    \  9.1. XML Digital Signatures and Encryption .....................62\n      9.2.\
    \ Message Transport .........................................66\n      9.3. Public\
    \ Key Infrastructure .................................67\n           9.3.1. Authentication\
    \ .....................................68\n           9.3.2. Multi-Hop Request\
    \ Authentication ...................69\n      9.4. Consortiums and Public Key\
    \ Infrastructures ................70\n      9.5. Privacy Concerns and System Use\
    \ Guidelines ................71\n      9.6. Sharing Profiles and Policies .............................76\n\
    \   10. Security Considerations .......................................77\n  \
    \ 11. Internationalization Issues ...................................77\n   12.\
    \ IANA Considerations ...........................................78\n   13. Summary\
    \ .......................................................80\n   14. References\
    \ ....................................................80\n      14.1. Normative\
    \ References .....................................80\n      14.2. Informative\
    \ References ...................................82\n   Appendix A. Acknowledgements\
    \ ......................................84\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Organizations require help from other parties to identify\
    \ incidents,\n   mitigate malicious activity targeting their computing resources,\
    \ and\n   to gain insight into potential threats through the sharing of\n   information.\
    \  This coordination might entail working with a service\n   provider (SP) to\
    \ filter attack traffic, working with an SP to resolve\n   a configuration issue\
    \ that is unintentionally causing problems,\n   contacting a remote site to take\
    \ down a bot network, or sharing\n   watch-lists of known malicious IP addresses\
    \ in a consortium.  The\n   term \"SP\" is to be interpreted as any type of service\
    \ provider or\n   Computer Security Incident Response Team (CSIRT) that may be\
    \ involved\n   in RID communications.\n   Incident handling involves the detection,\
    \ reporting, identification,\n   and mitigation of an incident, whether it be\
    \ a benign configuration\n   issue, IT incident, an infraction to a service level\
    \ agreement (SLA),\n   system compromise, socially engineered phishing attack,\
    \ or a denial-\n   of-service (DoS) attack, etc.  When an incident is detected,\
    \ the\n   response may include simply filing a report, notification to the\n \
    \  source of the incident, a request to an SP for resolution/mitigation,\n   or\
    \ a request to locate the source.  One of the more difficult cases\n   is that\
    \ in which the source of an attack is unknown, requiring the\n   ability to trace\
    \ the attack traffic iteratively upstream through the\n   network for the possibility\
    \ of any further actions to take place.  In\n   cases when accurate records of\
    \ an active session between the target\n   or victim system and the source or\
    \ attacking system are available,\n   the source is easy to identify.\n   Real-time\
    \ inter-network defense (RID) outlines a proactive inter-\n   network communication\
    \ method to facilitate sharing incident-handling\n   data while integrating existing\
    \ detection, tracing, source\n   identification, and mitigation mechanisms for\
    \ a complete incident\n   handling solution.  RID provides a secure method to\
    \ communicate\n   incident information, enabling the exchange of Incident Object\n\
    \   Description and Exchange Format (IODEF) [RFC5070] Extensible Markup\n   Language\
    \ (XML) documents.  RID considers security, policy, and\n   privacy issues related\
    \ to the exchange of potentially sensitive\n   information, enabling SPs or organizations\
    \ the options to make\n   appropriate decisions according to their policies. \
    \ RID includes\n   provisions for confidentiality, integrity, and authentication.\n\
    \   The data in RID messages is represented in an XML [XML1.0] document\n   using\
    \ the IODEF and RID.  By following this model, integration with\n   other aspects\
    \ for incident handling is simplified.  Methods are\n   incorporated into the\
    \ communication system to indicate what actions\n   need to be taken closest to\
    \ the source in order to halt or mitigate\n   the effects of the incident or attack\
    \ at hand.  RID is intended to\n   provide a method to communicate the relevant\
    \ information between\n   CSIRTs while being compatible with a variety of existing\
    \ and possible\n   future detection-tracing and response approaches.  Incidents\
    \ may be\n   extended to include Information Technology (IT) incidents, where\
    \ RID\n   enables the communication between or within providers for non-\n   security\
    \ IT incidents.\n   Security and privacy considerations are of high concern since\n\
    \   potentially sensitive information may be passed through RID messages.\n  \
    \ RID messaging takes advantage of XML security, privacy, and policy\n   information\
    \ set in the RID schema.  The RID schema defines\n   communication-specific metadata\
    \ to support the communication of IODEF\n   documents for exchanging or tracing\
    \ information regarding incidents.\n   RID messages are encapsulated for transport,\
    \ which is defined in a\n   separate document [RFC6546].  The authentication,\
    \ integrity, and\n   authorization features that RID and RID transport offer are\
    \ used to\n   achieve a necessary level of security.\n   Coordinating with other\
    \ CSIRTs is not strictly a technical problem.\n   There are numerous procedural,\
    \ trust, and legal considerations that\n   might prevent an organization from\
    \ sharing information.  RID provides\n   information and options that can be used\
    \ by organizations who must\n   then apply their own policies for sharing information.\
    \  Organizations\n   must develop policies and procedures for the use of the RID\
    \ protocol\n   and IODEF.\n"
- title: 1.1.  Changes from RFC 6045
  contents:
  - "1.1.  Changes from RFC 6045\n   This document contains the following changes\
    \ with respect to its\n   predecessor [RFC6045]:\n   o  This document is Standards\
    \ Track, while [RFC6045] was published as\n      Informational.\n   o  This document\
    \ obsoletes [RFC6045] and moves it to Historic status.\n   o  This document refers\
    \ to the updated RID transport specification\n      [RFC6546], where appropriate.\n\
    \   o  Edits reflected in this updated version of RID are primarily\n      improvements\
    \ to the informational descriptions.  The descriptions\n      have been updated\
    \ to clarify that IODEF and RID can be used for\n      all types of incidents\
    \ and are not limited to network security\n      incidents.  The language has\
    \ been updated to change the focus from\n      attacks to incidents, where appropriate.\
    \  The term \"network\n      provider\" has been replaced with the more generic\
    \ term of \"service\n      provider\".  Several introductory informational sections\
    \ have been\n      removed as they are not necessary for the implementation of\
    \ the\n      protocol.  The sections include:\n      *  1.3.  Attack Types and\
    \ RID Messaging,\n      *  2.  RID Integration with Network Provider Technologies,\n\
    \      *  3.1.  Integrating Trace Approaches, and\n      *  3.2.  Superset of\
    \ Packet Information for Traces.\n   o  An option for a star topology has been\
    \ included in an\n      informational section to meet current use-case requirements\
    \ of\n      those who provide reports on incident information.\n   o  The schema\
    \ version was incremented.  The schema has changed to\n      include IODEF [RFC5070]\
    \ enveloped in RID in the RIDPolicy class\n      using the new ReportSchema class,\
    \ to include one verified erratum,\n      to include additional enumerations in\
    \ the Justification attribute,\n      to remove the AcrossNationalBoundaries region\
    \ enumeration, to add\n      the DataWithHandlingRequirements enumeration in TrafficTypes,\
    \ and\n      to change the name of the RequestAuthorization MsgType to\n     \
    \ Acknowledgement.  Additional text has been provided to clarify\n      definitions\
    \ of enumerated values for some attributes.  The\n      RequestAuthorization name\
    \ was replaced with Acknowledgement to\n      more accurately represent the function\
    \ of that message type.  Text\n      was clarified to note the possible use of\
    \ this message in response\n      to Query and Report messages.  The attributes\
    \ were fixed in the\n      schema to add 'lang' at the RID class level for language\
    \ support.\n   o  The TraceRequest and Investigation messages have been collapsed\n\
    \      into a single message with the requirement to set the MsgType\n      according\
    \ to the functionality required for automation.  The\n      message descriptions\
    \ were identical with the exception of the\n      MsgType, which remains an exception\
    \ depending on the desired\n      function.  Since both of the enumerations for\
    \ MsgType are each a\n      Request, 'Investigation' is now 'InvestigationRequest'.\
    \  Content\n      may vary within the IODEF document for the type of Request\n\
    \      specified.\n   o  The IncidentQuery message description name and MsgType\
    \ enumeration\n      value in the schema have been changed to the more generic\
    \ name of\n      'Query'.\n   o  Guidance has been improved to ensure consistent\
    \ implementations\n      and use of XML encryption to provide confidentiality\
    \ based on data\n      markers, specifically the iodef:restriction attribute in\
    \ the IODEF\n      and IODEF-RID schemas.  The attribute may also be present in\
    \ IODEF\n      extension schemas, where the guidance also applies.  Additional\n\
    \      guidance and restrictions have been added for XML requirements.\n   o \
    \ All of the normative text from the Security Considerations section\n      has\
    \ been moved to a new section, Security Requirements.\n   o  The order in which\
    \ the RID schema is presented in Section 5 has\n      been changed to match the\
    \ order in the IODEF-RID schema.\n   o  Additional text has been provided to explain\
    \ the content and\n      interactions between entities in the examples.\n   o\
    \  Additional references have been provided to improve\n      interoperability\
    \ with stricter guidance on the use of XML digital\n      signatures and encryption.\n"
- title: 1.2.  Normative and Informative
  contents:
  - "1.2.  Normative and Informative\n   Sections 1, 2, 3, and 12 provide helpful\
    \ background information and\n   considerations.  RID systems participating in\
    \ a consortium are\n   REQUIRED to fully implement Sections 4, 5, 6, 7, 8, 9,\
    \ 10, and 11 to\n   prevent interoperability concerns.\n"
- title: 1.3.  Terminology
  contents:
  - "1.3.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"\
    SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\"\
    , and \"OPTIONAL\" in this\n   document are to be interpreted as described in\
    \ [RFC2119].\n"
- title: 2.  Characteristics of Incidents
  contents:
  - "2.  Characteristics of Incidents\n   An incident may be defined as a benign configuration\
    \ issue, IT\n   incident, an infraction to a service level agreement (SLA), system\n\
    \   compromise, a worm or Trojan infection, or a single- or multiple-\n   source\
    \ denial-of-service attack.  The goal of tracing a security\n   incident may be\
    \ to identify the source or to find a point on the\n   network as close to the\
    \ origin of the incident as possible.  Incident\n   tracing can be used to identify\
    \ the source(s) of an attack in order\n   to halt or mitigate the undesired behavior\
    \ or to correct an\n   identified issue.  RID messages can be communicated between\
    \ entities\n   to report or investigate any type of incident and allow for actions\n\
    \   to be taken when the source of the incident or a point closer to the\n   source\
    \ is known or has been identified.  Methods to accomplish\n   mitigation may include\
    \ remediation of a configuration issue,\n   filtering or rate-limiting the traffic\
    \ close to the source, or taking\n   the host or network offline.  Care must also\
    \ be taken to ensure that\n   the systems involved in the RID communications are\
    \ not abused and to\n   use proper analysis in determining if attack traffic is,\
    \ in fact,\n   attack traffic at each SP involved in the investigation.\n   Investigating\
    \ security incidents can be a difficult task since\n   attackers go to great lengths\
    \ to obscure their identity.  In the case\n   of a security incident, the true\
    \ source might be identified through\n   an existing established connection to\
    \ the attacker's point of origin.\n   However, the attacker may not connect to\
    \ the compromised system for a\n   long period of time after the initial compromise\
    \ or may access the\n   system through a series of compromised hosts spread across\
    \ the\n   network.  Other methods of obscuring the source may include targeting\n\
    \   the host with the same attack from multiple sources using both valid\n   and\
    \ spoofed source addresses.  This tactic can be used to compromise\n   a machine\
    \ and leave the difficult task of locating the true origin\n   for the administrators.\
    \  Attackers use many techniques, which can\n   vary between individuals or even\
    \ organized groups of attackers.\n   Through analysis, the techniques may be grouped\
    \ into indicators of\n   compromise to be shared via IODEF and RID, further assisting\
    \ with the\n   improvement of detection capabilities.  Security incidents, including\n\
    \   distributed denial-of-service (DDoS) attacks, can be difficult or\n   nearly\
    \ impossible to trace because of the nature of the attack.  Some\n   of the difficulties\
    \ in investigating attacks include the following:\n   o  the incident or attack\
    \ originates from multiple sources;\n   o  the incident may leverage social-engineering\
    \ techniques or other\n      methods to gain access to resources and intellectual\
    \ property\n      using what appears to be legitimate access methods such as\n\
    \      outbound web sessions from user systems;\n   o  the attack may include\
    \ various types of traffic meant to consume\n      server resources, such as a\
    \ SYN flood attack without a significant\n      increase in bandwidth utilization;\n\
    \   o  the type of traffic could include valid destination services,\n      which\
    \ cannot be blocked since they are essential services to\n      business, such\
    \ as DNS servers at an SP or HTTP requests sent to an\n      organization connected\
    \ to the Internet;\n   o  the attack may utilize varying types of packets including\
    \ TCP,\n      UDP, ICMP, or other IP protocols;\n   o  the attack may be from\
    \ \"zombies\" or large botnets, which then\n      require additional searches\
    \ to locate a controlling server as the\n      true origin of the attack;\n  \
    \ o  the attack may use a very small number of packets from any\n      particular\
    \ source, thus making a trace after the fact nearly\n      impossible;\n   o \
    \ the indicators of a compromise may be difficult to detect.\n   If the source(s)\
    \ of an incident cannot be determined from IP address\n   information, it may\
    \ be possible to trace the traffic based on\n   characteristics of the incident\
    \ such as tracing the increased\n   bandwidth utilization or the type of packets\
    \ seen by the client.  In\n   the case of packets with spoofed source addresses,\
    \ it is not a\n   trivial task to identify the source of an attack.\n   IODEF,\
    \ any extensions to IODEF, and RID can be used to detail an\n   incident, characteristics\
    \ of the incident (as it evolves), the\n   incident history, and communications\
    \ of the incident to facilitate\n   the resolution and reporting of the incident.\n"
- title: 3.  Communication between CSIRTs and Service Providers
  contents:
  - "3.  Communication between CSIRTs and Service Providers\n   Expediting the communication\
    \ between CSIRTs and SPs is essential when\n   responding to a security-related\
    \ incident, which may cross network\n   access points between service providers.\
    \  As a result of the urgency\n   involved in this inter-service-provider security\
    \ incident\n   communication, there must be an effective system in place to\n\
    \   facilitate the interaction.  This communication policy or method\n   should\
    \ involve multiple means of communication to avoid a single\n   point of failure.\
    \  Email is one way to transfer information about the\n   incident, packet traces,\
    \ etc.  However, email may not be received in\n   a timely fashion or be acted\
    \ upon with the same urgency as a phone\n   call or other communication mechanism\
    \ like RID.\n   A technical solution to trace traffic across a single SP may include\n\
    \   homegrown or commercial systems for which RID messaging must\n   accommodate\
    \ the input requirements.  The incident-handling system\n   used on the SP's backbone\
    \ by the CSIRT to coordinate the trace across\n   the single network requires\
    \ a method to accept, process, and relay\n   RID messages to the system, as well\
    \ as to wait for responses from the\n   system to continue the RID request process\
    \ as appropriate.  In this\n   scenario, each service provider maintains its own\
    \ system capable of\n   communicating via RID and integrates with a management\
    \ station used\n   for monitoring and analysis.  An alternative for providers\
    \ lacking\n   sufficient resources may be to have a neutral third party with access\n\
    \   to the provider's network resources who could be used to perform the\n   incident-handling\
    \ functions.  This could be a function of a central\n   organization operating\
    \ as a CSIRT for countries as a whole or within\n   a consortium that may be able\
    \ to provide centralized resources.\n   Consortiums could consist of a federation\
    \ or a group of service\n   providers or CSIRTs that agrees to participate in\
    \ the RID\n   communication protocol with an agreed-upon policy and communication\n\
    \   protocol facilitating the secure transport of IODEF-RID XML\n   documents.\
    \  Transport for RID messages is specified in [RFC6546].\n   One goal of RID is\
    \ to prevent the need to permit access to other\n   networks' equipment.  RID\
    \ provides a standard messaging mechanism to\n   enable the communication of incident-handling\
    \ information to other\n   providers in a consortium or in neighboring networks.\
    \  The third\n   party mentioned above may be used in this technical solution\
    \ to\n   assist in facilitating incident handling and possibly traceback\n   through\
    \ smaller providers.  The RID messaging mechanism may be a\n   logical or physical\
    \ out-of-band network to ensure that the\n   communication is secure and unaffected\
    \ by the state of the network\n   under attack.  The two management methods would\
    \ accommodate the needs\n   of larger providers to maintain full management of\
    \ their network, and\n   the third-party option could be available to smaller\
    \ providers who\n   lack the necessary human resources to perform incident-handling\n\
    \   operations.  The first method enables the individual providers to\n   involve\
    \ (via a notification and alerting system) their network\n   operations staff\
    \ to authorize the continuance of a trace or other\n   necessary response to a\
    \ RID communication request through their\n   network.\n   The network used for\
    \ the communication should consist of out-of-band\n   or protected channels (direct\
    \ communication links) or encrypted\n   channels dedicated to the transport of\
    \ RID messages.  The\n   communication links would be direct connections (virtual\
    \ or physical)\n   between peers who have agreed-upon use and abuse policies through\
    \ a\n   consortium.  Consortiums might be linked through policy comparisons\n\
    \   and additional agreements to form a larger web or iterative network\n   of\
    \ peers that correlates to the traffic paths available over the\n   larger web\
    \ of networks or is based on regions and logical groups.\n   Contact information,\
    \ IP addresses of RID systems, and other\n   information must be coordinated between\
    \ bilateral peers by a\n   consortium and may use existing databases, such as\
    \ the routing\n   arbiter.  The security, configuration, and Confidence rating\
    \ schemes\n   of the RID messaging peers must be negotiated by peers and must\
    \ meet\n   certain overall requirements of the fully connected network\n   (Internet,\
    \ government, education, etc.) through the peering and/or a\n   consortium-based\
    \ agreement.\n   RID messaging established with clients of an provider may be\n\
    \   negotiated in a contract as part of a value-added service or through\n   a\
    \ service level agreement (SLA).  Further discussion is beyond the\n   scope of\
    \ this document and may be more appropriately handled in\n   peering or service\
    \ level agreements.\n   Procedures for incident handling need to be established\
    \ and well\n   known by anyone that may be involved in incident response.  The\n\
    \   procedures should also contain contact information for internal\n   escalation\
    \ procedures, as well as for external assistance groups such\n   as a CSIRT, CERT\
    \ Coordination Center (CERT/CC), Global Information\n   Assurance Certification\
    \ (GIAC), and the U.S. Federal Bureau of\n   Investigations (FBI) or other assisting\
    \ government organization in\n   the country of the investigation.\n"
- title: 3.1.  Inter-Service-Provider RID Messaging
  contents:
  - "3.1.  Inter-Service-Provider RID Messaging\n   RID provides a protocol and format\
    \ that ensures interoperability\n   between vendors for the implementation of\
    \ an incident messaging\n   mechanism.  The messages should meet several requirements\
    \ in order to\n   be meaningful as they traverse multiple networks.  RID provides\
    \ the\n   framework necessary for communication between networks involved in\n\
    \   the incident handling, possible traceback, and mitigation of a\n   security\
    \ incident.  Several message types described in Section 4.2\n   are necessary\
    \ to facilitate the handling of a security incident.  The\n   message types include\
    \ the Report, Query, Request, Acknowledgement,\n   and Result message.\n   The\
    \ Report message is used when an incident is to be filed on a RID\n   system or\
    \ associated database, where no further action is required.\n   A Query message\
    \ is used to request information on a particular\n   incident.  A Request message\
    \ with options set to 'TraceRequest' is\n   used when the source of the traffic\
    \ may have been spoofed.  In that\n   case, each SP in the upstream path who receives\
    \ this Request will\n   issue a trace across the network to determine the upstream\
    \ source of\n   the traffic.  The Acknowledgement and Result messages are used\
    \ to\n   communicate the status and result of a Request.  The Request message\n\
    \   with options set to 'InvestigationRequest' may be sent to any party\n   assisting\
    \ in an incident investigation.  The InvestigationRequest\n   leverages the bilateral\
    \ relationships or a consortium's\n   interconnections to mitigate or stop problematic\
    \ traffic close to the\n   source.  Routes could determine the fastest path to\
    \ a known source IP\n   address in the case of an InvestigationRequest.  A Request\
    \ message\n   (set to 'TraceRequest' or 'InvestigationRequest') sent between RID\n\
    \   systems to stop traffic at the source through a bordering network\n   requires\
    \ the information enumerated below:\n   1.  Enough information to enable the network\
    \ administrators to make a\n       decision about the importance of continuing\
    \ the trace.\n   2.  The incident or IP packet information needed to carry out\
    \ the\n       trace or investigation.\n   3.  Contact information of the origin\
    \ of the RID communication.  The\n       contact information could be provided\
    \ through the Autonomous\n       System Number (ASN) [RFC1930] or Network Information\
    \ Center (NIC)\n       handle information listed in the Registry for Internet\
    \ Numbers or\n       other Internet databases.\n   4.  Network path information\
    \ to help prevent any routing loops\n       through the network from perpetuating\
    \ a trace.  If a RID system\n       receives a Request with MsgType set to 'TraceRequest'\
    \ that\n       contains its own information in the path, the trace must cease\n\
    \       and the RID system should generate an alert to inform the network\n  \
    \     operations staff that a tracing loop exists.\n   5.  A unique identifier\
    \ for a single attack.  This identifier should\n       be used to correlate traces\
    \ to multiple sources in a DDoS attack.\n   Use of the communication network and\
    \ the RID protocol must be for\n   pre-approved, authorized purposes only.  It\
    \ is the responsibility of\n   each participating party to adhere to guidelines\
    \ set forth in both a\n   global use policy established through the peering agreements\
    \ for each\n   bilateral peer or agreed-upon consortium guidelines.  The purpose\
    \ of\n   such policies is to avoid abuse of the system; the policies shall be\n\
    \   developed by a consortium or participating entities.  The global\n   policy\
    \ may be dependent on the domain it operates under; for example,\n   a government\
    \ network or a commercial network such as the Internet\n   would adhere to different\
    \ guidelines to address the individual\n   concerns.  Privacy issues must be considered\
    \ in public networks such\n   as the Internet.  Privacy issues are discussed in\
    \ the Security\n   Requirements section, along with other requirements that must\
    \ be\n   agreed upon by participating entities.\n   RID requests must be legitimate\
    \ incidents and not used for purposes\n   such as sabotage or censorship.  An\
    \ example of such abuse of the\n   system includes a request to rate-limit legitimate\
    \ traffic to prevent\n   information from being shared between users on the Internet\n\
    \   (restricting access to online versions of papers) or restricting\n   access\
    \ from a competitor's product in order to sabotage a business.\n   The RID system\
    \ should be configurable to either require user input or\n   automatically continue\
    \ traces.  This feature enables a network\n   manager to assess the available\
    \ resources before continuing a Request\n   message set to 'InvestigationRequest'\
    \ or 'TraceRequest'.  If the\n   Confidence rating (provided in IODEF) is low,\
    \ it may not be in the\n   provider's best interest to continue the Request with\
    \ options set to\n   'InvestigationRequest' or 'TraceRequest'.  The Confidence\
    \ ratings\n   must adhere to the specifications for selecting the percentage used\n\
    \   to avoid abuse of the system.  Requests must be issued by authorized\n   individuals\
    \ from the initiating CSIRT, set forth in policy guidelines\n   established through\
    \ peering or a SLA.\n"
- title: 3.2.  RID Communication Topology
  contents:
  - "3.2.  RID Communication Topology\n   The most basic topology for communicating\
    \ RID systems is a direct\n   connection or a bilateral relationship as illustrated\
    \ below.\n            ___________                                  __________\n\
    \            |         |                                  |        |\n       \
    \     |  RID    |__________-------------___________|  RID   |\n            |_________|\
    \          | SP Border |           |________|\n                              \
    \   -------------\n                      Figure 1: Direct Peer Topology\n   Within\
    \ the consortium model, several topologies might be agreed upon\n   and used.\
    \  One would leverage bilateral network peering relationships\n   of the members\
    \ of the consortium.  The peers for RID would match that\n   of routing peers,\
    \ and the logical network borders would be used.\n   This approach may be necessary\
    \ for an iterative trace where the\n   source is unknown.  The model looks like\
    \ the above diagram; however,\n   there may be an extensive number of interconnections\
    \ of bilateral\n   relationships formed.  Also within a consortium model, it may\
    \ be\n   useful to establish an integrated mesh of networks to pass RID\n   messages.\
    \  This may be beneficial when the source address is known,\n   and an interconnection\
    \ may provide a faster route to reach the\n   closest upstream peer to the source\
    \ of the attack traffic if direct\n   communication between SPs is not possible.\
    \  An example is illustrated\n   below.\n       _______                     _______\
    \                     _______\n       |     |                     |     |    \
    \                 |     |\n     __| RID |____-------------____| RID |____-------------____|\
    \ RID |__\n       |_____|    | SP Border |    |_____|    | SP Border |    |_____|\n\
    \          |       -------------               -------------       |\n       \
    \   |_______________________________________________________|\n      Direct connection\
    \ to network that is not an immediate network peer\n                       Figure\
    \ 2: Mesh Peer Topology\n   By using a fully meshed model in a consortium, broadcasting\
    \ RID\n   requests would be possible, but not advisable.  By broadcasting a\n\
    \   request, RID peers that may not have carried the attack traffic on\n   their\
    \ network would be asked to perform a trace for the potential of\n   decreasing\
    \ the time in which the true source was identified.  As a\n   result, many networks\
    \ would have utilized unnecessary resources for a\n   Request that may have also\
    \ been unnecessary.\n   A star topology may be desirable in instances where a\
    \ peer may be a\n   provider of incident information.  This requires trust relationships\n\
    \   to be established between the provider of information and each of the\n  \
    \ consumers of that information.  Examples may include country-level\n   CSIRTs\
    \ or service providers distributing incident information to\n   organizations.\n"
- title: 4.  Message Formats
  contents:
  - '4.  Message Formats

    '
- title: 4.1.  RID Data Types
  contents:
  - "4.1.  RID Data Types\n   RID is derived from the IODEF data model and inherits\
    \ all of the data\n   types defined in the IODEF model.  One data type is added\
    \ by RID:\n   BOOLEAN.\n"
- title: 4.1.1.  Boolean
  contents:
  - "4.1.1.  Boolean\n   A boolean value is represented by the BOOLEAN data type.\n\
    \   The BOOLEAN data type is implemented as \"xs:boolean\" [XMLschema] in\n  \
    \ the schema.  Note that there are two lexical representations for\n   boolean\
    \ in [XMLschema]: '1' or 'true' for TRUE and '0' or 'false' or\n   FALSE.\n"
- title: 4.2.  RID Message Types
  contents:
  - "4.2.  RID Message Types\n   The five RID message types described below MUST be\
    \ implemented.  RID\n   messages uses both the IODEF [RFC5070] and RID document,\
    \ which MUST\n   be encapsulated for transport as specified in [RFC6546].  The\n\
    \   messages are generated and received on designated systems for RID\n   communications.\
    \  Each RID message type, along with an example, is\n   described in the following\
    \ sections.  The IODEF-RID schema is\n   introduced in Section 5 to support the\
    \ described RID message types.\n   1.  Request.  This message type is used when\
    \ a request\n       ('InvestigationRequest' or 'TraceRequest') is needed.  The\n\
    \       purpose of the Request message (set to 'InvestigationRequest') is\n  \
    \     to leverage the existing peer relationships in order to notify\n       the\
    \ SP closest to the source of the valid traffic of a security-\n       related\
    \ incident for any necessary actions to be taken.  The\n       Request (set to\
    \ 'TraceRequest') is used when the traffic has to\n       be traced iteratively\
    \ through networks to find the source by\n       setting the MsgType to 'TraceRequest'.\
    \  The\n       'InvestigationRequest' MsgType is used for all other Request\n\
    \       messages.\n   2.  Acknowledgement.  This message is sent to the initiating\
    \ RID\n       system from each of the upstream provider's RID systems to\n   \
    \    provide information on the status of a Request.  The\n       Acknowledgement\
    \ is also used to provide a reason why a Request,\n       Report, or Query was\
    \ not accepted.\n   3.  Result.  The Result message is used to provide a final\
    \ report and\n       the notification of actions taken for a Request.  This message\
    \ is\n       sent to the initiating CSIRT through the network of RID systems\n\
    \       in the path of the trace as notification that the source of the\n    \
    \   attack was located.\n   4.  Report.  This message is used to report a security\
    \ incident, for\n       which no action is requested.  This may be used for the\
    \ purpose\n       of correlating attack information by CSIRTs, sharing incident\n\
    \       information, statistics and trending information, etc.\n   5.  Query.\
    \  This message is used to request information about an\n       incident or incident\
    \ type from a trusted system communicating via\n       RID.  The response is provided\
    \ through the Report message.\n   When an application receives a RID message,\
    \ it must be able to\n   determine the type of message and parse it accordingly.\
    \  The message\n   type is specified in the RIDPolicy class.  The RIDPolicy class\
    \ may\n   also be used by the transport protocol to facilitate the\n   communication\
    \ of security incident data to trace, investigate, query,\n   or report information\
    \ regarding security incidents.\n"
- title: 5.  IODEF-RID Schema
  contents:
  - "5.  IODEF-RID Schema\n   There are three classes included in the RID extension\
    \ required to\n   facilitate RID communications.  The RequestStatus class is used\
    \ to\n   indicate the approval status of a Request message; the IncidentSource\n\
    \   class is used to report whether or not a source was found and to\n   identify\
    \ the source host(s) or network(s); and the RIDPolicy class\n   provides information\
    \ on the agreed-upon policies and specifies the\n   type of communication message\
    \ being used.\n   The RID schema defines communication-specific metadata to support\
    \ the\n   exchange of incident information in an IODEF document.  The intent in\n\
    \   maintaining a separate schema and not using the AdditionalData\n   extension\
    \ of IODEF is the flexibility of sending messages between RID\n   hosts.  Since\
    \ RID is a separate schema and RID messages include both\n   the RID and IODEF\
    \ documents, the RID message acts as an envelope in\n   that policy and security\
    \ defined at the RID message layer are applied\n   to both documents.  One reason\
    \ for maintaining separate schemas is\n   for flexibility, where the RIDPolicy\
    \ class can be easily extracted\n   for use in the RID message and by the transport\
    \ protocol.\n   The security requirements of sending incident information between\n\
    \   entities include the use of encryption.  The RIDPolicy information is\n  \
    \ not required to be encrypted, so separating out this data from the\n   IODEF\
    \ XML document removes the need for decrypting and parsing the\n   IODEF document\
    \ to determine how it should be handled at each RID\n   host.\n   The purpose\
    \ of the RIDPolicy class is to specify the message type for\n   the receiving\
    \ host, facilitate the policy needs of RID, and provide\n   routing information\
    \ in the form of an IP address of the destination\n   RID system.\n   The security\
    \ requirements and policy guidelines are discussed in\n   Section 9.  The policy\
    \ is defined between RID peers and within or\n   between consortiums.  RIDPolicy\
    \ is meant to be a tool to facilitate\n   the defined policies.  This MUST be\
    \ used in accordance with policy\n   set between clients, peers, consortiums,\
    \ and/or regions.  Security,\n   privacy, and confidentiality MUST be considered\
    \ as specified in this\n   document.\n   The RID schema is defined as follows:\n\
    \           +------------------+\n           |        RID       |\n          \
    \ +------------------+\n           |                  |\n           | ENUM lang\
    \        |<>---{0..1}----[ RIDPolicy      ]\n           |                  |\n\
    \           |                  |<>---{0..1}----[ RequestStatus  ]\n          \
    \ |                  |\n           |                  |<>---{0..1}----[ IncidentSource\
    \ ]\n           +------------------+\n                         Figure 3: The RID\
    \ Schema\n   The aggregate classes that constitute the RID schema in the iodef-rid\n\
    \   namespace are as follows:\n   RIDPolicy\n      Zero or One.  The RIDPolicy\
    \ class is used by all message types to\n      facilitate policy agreements between\
    \ peers, consortiums, or\n      federations, as well as to properly route messages.\n\
    \   RequestStatus\n      Zero or One.  The RequestStatus class is used only in\n\
    \      Acknowledgement messages.  The message reports back to the CSIRT\n    \
    \  or SP in the Acknowledgement message to provide status on a\n      Request\
    \ or if an error or problem occurs with the receipt or\n      processing of a\
    \ Report, Query, or Result message.\n   IncidentSource\n      Zero or One.  The\
    \ IncidentSource class is used in the Result\n      message only.  The IncidentSource\
    \ provides the information on the\n      identified source host or network of\
    \ an attack trace or\n      investigation.\n   Each of the three listed classes\
    \ may be the only class included in\n   the RID class, hence the option for zero\
    \ or one.  In some cases,\n   RIDPolicy MAY be the only class in the RID definition\
    \ when used by\n   the transport protocol [RFC6546], as that information should\
    \ be as\n   small as possible and may not be encrypted.  The RequestStatus\n \
    \  message MUST be able to stand alone without the need for an IODEF\n   document\
    \ to facilitate the communication, limiting the data\n   transported to the required\
    \ elements per [RFC6546].\n   The RID class has one attribute:\n      lang\n \
    \        One.  REQUIRED.  ENUM.  A valid language code per [RFC5646]\n       \
    \  constrained by the definition of \"xs:language\" inherited from\n         [XML1.0].\n"
- title: 5.1.  RIDPolicy Class
  contents:
  - "5.1.  RIDPolicy Class\n   The RIDPolicy class facilitates the delivery of RID\
    \ messages and is\n   also referenced for transport in the transport document\
    \ [RFC6546].\n   The RIDPolicy Class includes the ability to embed an IODEF document\n\
    \   or XML documents that conform to schemas other than IODEF in the\n   ReportSchema\
    \ element.\n          +------------------------+\n          | RIDPolicy      \
    \        |\n          +------------------------+\n          |                \
    \        |\n          | ENUM restriction       |<>-------------[ Node        \
    \ ]\n          | ENUM MsgType           |\n          | ENUM MsgDestination   \
    \ |<>---{0..1}----[ IncidentID   ]\n          | ENUM ext-MsgType       |\n   \
    \       | ENUM ext-MsgDestination|<>---{1..*}----[ PolicyRegion ]\n          |\
    \                        |\n          |                        |<>---{1..*}----[\
    \ TrafficType  ]\n          |                        |\n          |          \
    \              |<>---{0..1}----[ ReportSchema ]\n          +------------------------+\n\
    \                       Figure 4: The RIDPolicy Class\n   The aggregate elements\
    \ that constitute the RIDPolicy class are as\n   follows:\n   Node\n      One.\
    \  The Node class is used to identify a host or network device,\n      in this\
    \ case to identify the system communicating RID messages,\n      and the usage\
    \ is determined by the MsgDestination attribute.  The\n      base definition of\
    \ this class is reused from the IODEF\n      specification [RFC5070], Section\
    \ 3.16.  See Section 11 of this\n      document for Internationalization considerations.\n\
    \   IncidentID\n      Zero or one.  Global reference pointing back to the IncidentID\n\
    \      defined in the IODEF data model.  The IncidentID includes the name\n  \
    \    of the CSIRT, an incident number, and an instance of that\n      incident.\
    \  The instance number is appended with a dash separating\n      the values and\
    \ is used in cases for which it may be desirable to\n      group incidents.  Examples\
    \ of incidents that may be grouped\n      include botnets, polymorphic attacks,\
    \ DDoS attacks, multiple hops\n      of compromised systems found during an investigation,\
    \ etc.\n   PolicyRegion\n      One or many.  REQUIRED.  The values for the attribute\
    \ \"region\" are\n      used to determine what policy area may require consideration\n\
    \      before a trace can be approved.  The PolicyRegion may include\n      multiple\
    \ selections from the attribute list in order to fit all\n      possible policy\
    \ considerations when crossing regions, consortiums,\n      or networks.\n   region\n\
    \      One or many.  REQUIRED.  ENUM.  The attribute region is used to\n     \
    \ identify the expected sharing range of the incident information.\n      The\
    \ region may be within a region or defined by existing\n      relationships such\
    \ as those of a consortium or a client to a\n      service provider.\n      1.\
    \  ClientToSP.  A client initiated the request to their service\n          provider\
    \ (SP).  A client may be an individual, enterprise, or\n          other type of\
    \ entity (government, commercial, education,\n          etc.).  An SP may be a\
    \ network, telecommunications,\n          infrastructure, or other type of SP\
    \ where a client-to-vendor\n          relationship has been established.  The\
    \ client-to-vendor\n          relationship will typically have established contracts\
    \ or\n          agreements to define expectations and trust relationships.\n \
    \     2.  SPToClient.  An SP initiated a RID request or report to a\n        \
    \  client.  A client may be an individual, enterprise, or other\n          type\
    \ of entity (government, commercial, education, etc.).  An\n          SP may be\
    \ a network, telecommunications, infrastructure, or\n          other type of SP\
    \ where a client-to-vendor relationship has\n          been established.  The\
    \ client-to-vendor relationship will\n          typically have established contracts\
    \ or agreements to define\n          expectations and trust relationships.\n \
    \     3.  IntraConsortium.  Incident information that should have no\n       \
    \   restrictions within the boundaries of a consortium with the\n          agreed-upon\
    \ use and abuse guidelines.  A consortium is a well-\n          defined group\
    \ with established members and trust relationships\n          specific to sharing\
    \ within that group.  A consortium would\n          typically define the types\
    \ of data that can be shared in\n          advance, define the expectations on\
    \ protecting that data, as\n          well as have established contractual agreements.\
    \  Examples of\n          consortiums may include industry-focused sharing communities\n\
    \          (financial, government, research and education, etc.) or cross\n  \
    \        industry sharing communities (for instance, organizations\n         \
    \ within local proximity that form a sharing group).\n      4.  PeerToPeer.  Incident\
    \ information that should have no\n          restrictions between two peers but\
    \ may require further\n          evaluation before continuance beyond that point\
    \ with the\n          agreed-upon use and abuse guidelines.  PeerToPeer\n    \
    \      communications may involve any two individuals or entities\n          that\
    \ decide to share information directly with each other.\n      5.  BetweenConsortiums.\
    \  Incident information that should have no\n          restrictions between consortiums\
    \ that have established agreed-\n          upon use and abuse guidelines.  BetweenConsortiums\
    \ is used\n          when two consortiums (as defined in IntraConsortium above)\n\
    \          share data.  The types of data that can be shared\n          BetweenConsortiums\
    \ should be identified in their agreements\n          and contracts along with\
    \ expectations on how that data should\n          be handled and protected.\n\
    \      6.  ext-value.  An escape value used to extend this attribute.\n      \
    \    See IODEF [RFC5070], Section 5.1.\n   TrafficType\n      One or many.  REQUIRED.\
    \  The values for the attribute \"type\" are\n      meant to assist in determining\
    \ if a trace is appropriate for the\n      SP receiving the request to continue\
    \ the trace.  Multiple values\n      may be selected for this element; however,\
    \ where possible, it\n      should be restricted to one value that most accurately\
    \ describes\n      the traffic type.\n   type\n      One or many.  REQUIRED. \
    \ ENUM.  The attribute type is used to\n      identify the type of information\
    \ included in the RID message or\n      the type of incident.\n      1.  Attack.\
    \  This option SHOULD only be selected if the traffic is\n          related to\
    \ an information security incident or attack.  The\n          type of attack MUST\
    \ also be listed in more detail in the IODEF\n          Method and Impact classes\
    \ for further clarification to assist\n          in determining if the trace can\
    \ be continued ([RFC5070],\n          Sections 3.9 and 3.10.1).\n      2.  Network.\
    \  This option MUST only be selected when the trace is\n          related to network\
    \ traffic or routing issues.\n      3.  Content.  This category MUST be used only\
    \ in the case in which\n          the request is related to the content and regional\n\
    \          restrictions on accessing that type of content exist.  This is\n  \
    \        not malicious traffic but may be used for determining what\n        \
    \  sources or destinations accessed certain materials available\n          on\
    \ the Internet, including, but not limited to, news,\n          technology, or\
    \ inappropriate content.\n      4.  DataWithHandlingRequirements.  This option\
    \ is used when data\n          shared may have additional restrictions for handling,\n\
    \          protection, and processing based on the type of data and where\n  \
    \        it resides.  Regulatory or legal restrictions may be imposed\n      \
    \    on specific types of data that could vary based on the\n          location,\
    \ region or nation, of the data or where it\n          originated.  The IODEF\
    \ document, as well as any extensions,\n          included with the RID message\
    \ should indicate the specific\n          restrictions to be considered.  The\
    \ use of this enumeration\n          flag is not legally binding.\n      5.  AudienceRestriction.\
    \  This option is used to indicate that the\n          message contains data that\
    \ should be viewed by a restricted\n          audience.  This setting should not\
    \ be used for normal\n          incidents or reporting as it could slow response\
    \ times.  The\n          content may be a business-relevant notification or request.\n\
    \          This option MAY be used by a business partner to report or\n      \
    \    request assistance if an incident has affected a supply chain.\n        \
    \  This option may also be used if the content is relevant to\n          regulatory\
    \ obligations, legal (eDiscovery), or other use cases\n          that require\
    \ management attention.\n      6.  Other.  If this option is selected, a description\
    \ of the\n          traffic type MUST be provided so that policy decisions can\
    \ be\n          made to continue or stop the investigation.  The information\n\
    \          should be provided in the IODEF message in the Expectation\n      \
    \    class or in the History class using a HistoryItem log.  This\n          may\
    \ also be used for incident types other than information-\n          security-related\
    \ incidents.\n      7.  ext-value.  An escape value used to extend this attribute.\n\
    \          See IODEF [RFC5070], Section 5.1.\n      ReportSchema\n         Zero\
    \ or One.  The ReportSchema class is used by the message\n         types that\
    \ require the full IODEF schema to be included in the\n         RID envelope.\
    \  Alternate schemas may be included if approved by\n         the Designated Reviewer\
    \ and registered by IANA for use with\n         RID.\n   The RIDPolicy class has\
    \ five attributes:\n      restriction\n         OPTIONAL.  ENUM.  This attribute\
    \ indicates the disclosure\n         guidelines to which the sender expects the\
    \ recipient to adhere.\n         This guideline provides no real security since\
    \ it is the choice\n         of the recipient of the document to honor it.  This\
    \ attribute\n         follows the same guidelines as \"restriction\" used in IODEF.\n\
    \      MsgType\n         One.  REQUIRED.  ENUM.  The type of RID message sent.\
    \  The five\n         types of messages are described in Section 4.2 and can be\
    \ noted\n         as one of the six selections below, where a Request is set to\n\
    \         either 'InvestigationRequest' or 'TraceRequest'.\n         1.  TraceRequest.\
    \  This Request message may be used to initiate\n             a TraceRequest or\
    \ to continue a TraceRequest to an upstream\n             network closer to the\
    \ source address of the origin of the\n             security incident.\n     \
    \    2.  Acknowledgement.  This message is sent to the initiating\n          \
    \   RID system from each of the upstream RID systems to provide\n            \
    \ information on the request status in the current network.\n         3.  Result.\
    \  This message indicates that the source of the\n             attack was located,\
    \ and the message is sent to the\n             initiating RID system through the\
    \ RID systems in the path\n             of the trace.\n         4.  InvestigationRequest.\
    \  This Request message type is used\n             when the source of the traffic\
    \ is believed to be valid.\n             The purpose of the InvestigationRequest\
    \ is to leverage the\n             existing peer or consortium relationships in\
    \ order to\n             notify the SP closest to the source of the valid traffic\n\
    \             that some event occurred, which may be a security-related\n    \
    \         incident.\n         5.  Report.  This message is used to report a security\
    \ incident\n             for which no action is requested in the IODEF Expectation\n\
    \             class.  This may be used for the purpose of correlating\n      \
    \       attack information by CSIRTs, gathering statistics and\n             trending\
    \ information, etc.\n         6.  Query.  This message is used to request information\
    \ from a\n             trusted RID system about an incident or incident type.\n\
    \      Additionally, there is an extension attribute to add new\n      enumerated\
    \ values:\n         ext-value.  An escape value used to extend this attribute.\
    \  See\n         IODEF [RFC5070], Section 5.1.\n      MsgDestination\n       \
    \  One.  REQUIRED.  ENUM.  The destination required at this level\n         may\
    \ either be the RID messaging system intended to receive the\n         request,\
    \ or, in the case of a Request with MsgType set to\n         'InvestigationRequest',\
    \ the source of the incident.  In the\n         case of an InvestigationRequest,\
    \ the RID system that can help\n         stop or mitigate the traffic may not\
    \ be known, and the message\n         may have to traverse RID messaging systems\
    \ by following the\n         routing path to the RID system closest to the source\
    \ of the\n         attack traffic.  The Node element lists either the RID system\n\
    \         or the IP address of the source, and the meaning of the value\n    \
    \     in the Node element is determined by the MsgDestination\n         element.\n\
    \         1.  RIDSystem.  The IP address of the next upstream system\n       \
    \      accepting RID communications is REQUIRED and is listed in\n           \
    \  the Node element of the RIDPolicy class.  If NodeName\n             element\
    \ of the Node class is used, it contains a DNS domain\n             name.  The\
    \ originating RID system is required to check that\n             this domain name\
    \ resolves to the IP address to which the\n             RID message is sent. \
    \ This check may be performed in\n             advance of sending the message\
    \ and the result saved for\n             future use with additional RID messages.\n\
    \         2.  SourceOfIncident.  The Address element of the Node element\n   \
    \          contains the IP address of the incident source, and the\n         \
    \    NodeName element of the Node class is not used.  The IP\n             address\
    \ is REQUIRED when this option is selected.  The IP\n             address is used\
    \ to determine the path of systems accepting\n             RID communications\
    \ that will be used to find the closest\n             RID system to the source\
    \ of an attack in which the IP\n             address used by the source is believed\
    \ to be valid and a\n             Request message with MsgDestination set to\n\
    \             'InvestigationRequest' is used.  This is not to be confused\n  \
    \           with the IncidentSource class, as the defined value here is\n    \
    \         from an initial Request ('InvestigationRequest' or\n             'TraceRequest'),\
    \ not the source used in a Result message.\n         3.  ext-value.  An escape\
    \ value used to extend this attribute.\n             All extensions shall specify\
    \ the contents and meaning of\n             the Node element of RIDPolicy.  See\
    \ IODEF [RFC5070],\n             Section 5.1, on extensibility.  If the NodeName\
    \ element of\n             the Node class is used by an extension, NodeName may\n\
    \             contain an Internationalized Domain Name (IDN); see\n          \
    \   Section 11 for applicable requirements.  All extensions\n             SHOULD\
    \ use an IP address in the Address element of the Node\n             class as\
    \ the primary means of Node identification.\n      MsgType-ext\n         OPTIONAL.\
    \  STRING.  A means by which to extend the MsgType\n         attribute.  See IODEF\
    \ [RFC5070], Section 5.1.\n      MsgDestination-ext\n         OPTIONAL.  STRING.\
    \  A means by which to extend the\n         MsgDestination attribute.  See IODEF\
    \ [RFC5070], Section 5.1\n"
- title: 5.1.1.  ReportSchema
  contents:
  - "5.1.1.  ReportSchema\n   The ReportSchema class is an aggregate class in the\
    \ RIDPolicy class.\n   The IODEF schema is the approved schema for inclusion in\
    \ RID messages\n   via the ReportSchema class.\n          +-------------------------+\n\
    \          |      ReportSchema       |\n          +-------------------------+\n\
    \          |                         |\n          |  ENUM Version           |\n\
    \          |  STRING ext-Version     |<>---{1}-------[ XMLDocument   ]\n     \
    \     |  ENUM XMLSchemaID       |\n          |  STRING ext-XMLSchemaID |<>---{0..1}----[\
    \ URL           ]\n          |                         |\n          |        \
    \                 |<>---{0..*}----[ Signature     ]\n          |             \
    \            |\n          +-------------------------+\n                     Figure\
    \ 5: The ReportSchema Class\n   The elements that constitute the ReportSchema\
    \ class are as follows:\n      XMLDocument\n         One.  The XMLDocument is\
    \ a complete XML document defined by the\n         iodef:ExtensionType class.\
    \  This class follows the guidelines\n         in [RFC5070], Section 5, where\
    \ the data type is set to 'xml'\n         and meaning is set to 'xml' to include\
    \ an XML document.\n      URL\n         Zero or One.  URL.  A reference to the\
    \ XML schema of the XML\n         document included.  The URL data type is defined\
    \ in [RFC5070],\n         Section 2.15, as \"xs:anyURI\" in the schema.  The schemaLocation\n\
    \         for IODEF is already included in the RID schema, so this is not\n  \
    \       necessary to include a URL for IODEF documents.  The list of\n       \
    \  registered schemas for inclusion will be maintained by IANA.\n      Signature\n\
    \         Zero to many.  The Signature uses the iodef:ExtensionType class\n  \
    \       to enable this element to contain a detached or enveloped\n         signature.\
    \  This class follows the guidelines in [RFC5070]\n         Section 5 where the\
    \ data type is set to 'xml' and meaning is\n         set to 'xml' to include an\
    \ XML document.  This element is used\n         to encapsulate the detached signature\
    \ based on the iodef:\n         RecordItem class within the IODEF document to\
    \ verify the\n         originator of the message or to include the enveloped\n\
    \         signature.  If other schemas are used instead of IODEF, they\n     \
    \    MUST provide guidance on what class to use if a detached\n         signature\
    \ is provided for this purpose.\n      The ReportSchema class has four attributes:\n\
    \      Version\n         OPTIONAL.  One.  The Version attribute is the version\
    \ number of\n         the specified XML schema.  That schema must be an approved\n\
    \         version of IODEF or a schema registered with IANA for use with\n   \
    \      RID.  The IANA registry for managing schemas other than IODEF\n       \
    \  is specified in Section 12.\n            ext-value.  An escape value used to\
    \ extend this attribute.\n            See IODEF [RFC5070], Section 5.1.\n    \
    \  ext-Version\n         OPTIONAL.  One.  The ext-Version attribute is the version\n\
    \         number of the included XML schema.  This attribute is used if a\n  \
    \       schema other than IODEF or an IANA-registered schema that has\n      \
    \   been added to the enumerated list for Version is included.\n      XMLSchemaID\n\
    \         OPTIONAL.  One.  The XMLSchemaID attribute is the identifier,\n    \
    \     the defined namespace [XMLNames], of the XML schema of the XML\n       \
    \  document included.  The XMLSchemaID and Version specify the\n         format\
    \ of the XMLDocument element.  The only permitted values,\n         include the\
    \ namespace for IODEF [RFC5070],\n         \"urn:ietf:params:xml:ns:iodef-1.0\"\
    , any future IETF-approved\n         versions of IODEF, and any namespace included\
    \ in the IANA-\n         managed list of registered schemas for use with RID.\
    \  The IANA\n         registry for managing schemas other than IODEF is specified\
    \ in\n         Section 12.\n            ext-value.  An escape value used to extend\
    \ this attribute.\n            See IODEF [RFC5070], Section 5.1.\n      ext-XMLSchemaID\n\
    \         OPTIONAL.  One.  The ext-XMLSchemaID attribute is the\n         identifier\
    \ (defined namespace) of the XML schema of the XML\n         document included.\
    \  The ext-XMLSchemaID and ext-Version specify\n         the format of the XMLDocument\
    \ element and are used if the\n         included schema is not IODEF version 1.0\
    \ or an IANA-registered\n         schema that has been added to the enumerated\
    \ list for\n         XMLSchemaID.\n"
- title: 5.2.  RequestStatus
  contents:
  - "5.2.  RequestStatus\n   The RequestStatus class is an aggregate class in the\
    \ RID class.\n                       +--------------------------------+\n    \
    \                   | RequestStatus                  |\n                     \
    \  +--------------------------------+\n                       |              \
    \                  |\n                       | ENUM restriction              \
    \ |\n                       | ENUM AuthorizationStatus       |\n             \
    \          | ENUM Justification             |\n                       | STRING\
    \ ext-AuthorizationStatus |\n                       | STRING ext-Justification\
    \       |\n                       |                                |\n       \
    \                +--------------------------------+\n                     Figure\
    \ 6: The RequestStatus Class\n   The RequestStatus class has five attributes:\n\
    \      restriction\n         OPTIONAL.  ENUM.  This attribute indicates the disclosure\n\
    \         guidelines to which the sender expects the recipient to adhere.\n  \
    \       This guideline provides no real security since it is the choice\n    \
    \     of the recipient of the document to honor it.  This attribute\n        \
    \ follows the same guidelines as \"restriction\" used in IODEF.\n      AuthorizationStatus\n\
    \         One.  REQUIRED.  ENUM.  The listed values are used to provide a\n  \
    \       response to the requesting CSIRT of the status of a Request,\n       \
    \  Report, or Query.\n         1.  Approved.  The trace was approved and will\
    \ begin in the\n             current SP.\n         2.  Denied.  The trace was\
    \ denied in the current SP.  The next\n             closest SP can use this message\
    \ to filter traffic from the\n             upstream SP using the example packet\
    \ to help mitigate the\n             effects of the attack as close to the source\
    \ as possible.\n             The Acknowledgement message must be passed back to\
    \ the\n             originator and a Result message must be used from the\n  \
    \           closest SP to the source in order to indicate actions taken\n    \
    \         in the IODEF History class.\n         3.  Pending.  Awaiting approval;\
    \ a timeout period has been\n             reached, which resulted in this Pending\
    \ status and\n             Acknowledgement message being generated.\n        \
    \ 4.  ext-value.  An escape value used to extend this attribute.\n           \
    \  See IODEF [RFC5070], Section 5.1.\n         Justification\n            OPTIONAL.\
    \  ENUM.  Provides a reason for a Denied or Pending\n            message.\n  \
    \          1.  SystemResource.  A resource issue exists on the systems\n     \
    \           that would be involved in the request.\n            2.  Authentication.\
    \  The enveloped digital signature\n                [RFC3275] failed to validate.\n\
    \            3.  AuthenticationOrigin.  The detached digital signature\n     \
    \           for the original requestor on the RecordItem entry\n             \
    \   failed to validate.\n            4.  Encryption.  The recipient was unable\
    \ to decrypt the\n                request, report, or query.\n            5. \
    \ UnrecognizedFormat.  The format of the provided document\n                was\
    \ unrecognized.\n            6.  CannotProcess.  The document could not be processed.\n\
    \                Reasons may include legal or policy decisions.\n            \
    \    Resolution may require communication outside of this\n                protocol\
    \ to resolve legal or policy issues.  No further\n                messages SHOULD\
    \ be sent until resolved.\n            7.  Other.  There were other reasons this\
    \ request could not\n                be processed.\n            8.  ext-value.\
    \  An escape value used to extend this\n                attribute.  See IODEF\
    \ [RFC5070], Section 5.1.\n         AuthorizationStatus-ext\n            OPTIONAL.\
    \  STRING.  A means by which to extend the\n            AuthorizationStatus attribute.\
    \  See IODEF [RFC5070], Section\n            5.1.\n         Justification-ext\n\
    \            OPTIONAL.  STRING.  A means by which to extend the\n            Justification\
    \ attribute.  See IODEF [RFC5070], Section 5.1.\n"
- title: 5.3.  IncidentSource
  contents:
  - "5.3.  IncidentSource\n   The IncidentSource class is an aggregate class in the\
    \ RID class.\n          +-------------------+\n          | IncidentSource    |\n\
    \          +-------------------+\n          |                   |\n          |\
    \ ENUM restriction  |\n          |                   |<>-------------[ SourceFound\
    \    ]\n          |                   |\n          |                   |<>---{0..*}----[\
    \ Node           ]\n          |                   |\n          +-------------------+\n\
    \                    Figure 7: The IncidentSource Class\n   The elements that\
    \ constitute the IncidentSource class follow:\n      SourceFound\n         One.\
    \  BOOLEAN.  The Source class indicates if a source was\n         identified.\
    \  If the source was identified, it is listed in the\n         Node element of\
    \ this class.\n         True.  Source of incident was identified.\n         False.\
    \  Source of incident was not identified.\n      Node\n         Zero or many.\
    \  The Node class is used to identify a system\n         identified as part of\
    \ an incident.  If this element is used,\n         the Address element of the\
    \ Node element MUST contain the IP\n         address of the system.  If the NodeName\
    \ element of the Node\n         class is used, it contains a DNS domain name that\
    \ has been\n         checked to ensure that it resolved to that IP address when\
    \ the\n         check was performed.  See Section 11 of this document for\n  \
    \       internationalization considerations for NodeName.  The base\n        \
    \ definition of this class from the IODEF ([RFC5070], Section\n         3.16)\
    \ can be expanded to include other identifiers.\n      The IncidentSource class\
    \ has one attribute:\n      restriction\n         OPTIONAL.  ENUM.  This attribute\
    \ indicates the disclosure\n         guidelines to which the sender expects the\
    \ recipient to\n         adhere.This guideline provides no real security since\
    \ it is the\n         choice of the recipient of the document to honor it.  This\n\
    \         attribute follows the same guidelines as \"restriction\" used in\n \
    \        IODEF.\n"
- title: 5.4.  RID Name Spaces
  contents:
  - "5.4.  RID Name Spaces\n   The RID schema declares a namespace of\n   \"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \ and registers it per\n   [RFC3688].  Each IODEF-RID document MUST use the \"\
    iodef-rid-2.0\"\n   namespace in the top-level element RID-Document.  It can be\n\
    \   referenced as follows:\n   <RID-Document version=\"2.0\" lang=\"en-US\"\n\
    \      xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\n      xmlns:xsi=\"\
    http://www.w3c.org/2001/XMLSchema-instance\"\n      xsi:schemaLocation=\"urn:ietf:params:xml:ns:iodef-rid-2.0.xsd\"\
    >\n"
- title: 5.5.  Encoding
  contents:
  - "5.5.  Encoding\n   RID documents MUST begin with an XML declaration and MUST\
    \ specify the\n   XML version used; also, the use of UTF-8 encoding is REQUIRED\n\
    \   ([RFC3470], Section 4.4).  RID conforms to all XML data encoding\n   conventions\
    \ and constraints.\n   The XML declaration with no character encoding will read\
    \ as follows:\n      <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n   The following\
    \ characters have special meaning in XML and MUST be\n   escaped with their entity\
    \ reference equivalent: \"&\", \"<\", \">\", \"\\\"\"\n   (double quotation mark),\
    \ and \"'\" (apostrophe).  These entity\n   references are \"&amp;\", \"&lt;\"\
    , \"&gt;\", \"&quot;\", and \"&apos;\",\n   respectively.\n"
- title: 5.6.  Including IODEF or Other XML Documents
  contents:
  - "5.6.  Including IODEF or Other XML Documents\n   In order to support the changing\
    \ activity of CSIRTS, the RID schema\n   can include an IODEF or other data model.\
    \  The IODEF is also\n   extensible, enabling the schemas to evolve along with\
    \ the needs of\n   CSIRTs.  This section discusses how to include the IODEF XML\
    \ document\n   or other XML documents to leverage the security and trust\n   relationships\
    \ established through the use of RID.  These techniques\n   are designed so that\
    \ adding new data will not require a change to the\n   RID schema.  This approach\
    \ also supports the exchange of private XML\n   documents relevant only to a closed\
    \ consortium.  XML documents can be\n   included through the ReportSchema class\
    \ in the RIDPolicy class.  The\n   XMLDocument attribute is set to 'xml' to allow\
    \ for the inclusion of\n   full IODEF or other XML documents.  The following guidelines\
    \ MUST be\n   followed:\n   1.  The included schema MUST define a separate namespace,\
    \ such as the\n       declared namespace for IODEF of\n       \"urn:ietf:params:xml:ns:iodef-1.0\"\
    .\n   2.  When a parser encounters an included XML document it does not\n    \
    \   understand, the included document MUST be ignored (and not\n       processed),\
    \ but the remainder of the document MUST be processed.\n       Parsers will be\
    \ able to identify the XML documents for which they\n       have no processing\
    \ logic through the namespace declaration.\n       Parsers that encounter an unrecognized\
    \ element in a namespace\n       that they do support SHOULD reject the document\
    \ as a syntax\n       error.\n   3.  Implementations SHOULD NOT download schemas\
    \ at runtime due to the\n       security implications, and included documents\
    \ MUST NOT be\n       required to provide a resolvable location of their schema.\n\
    \   The examples included in Section 7 demonstrate how an IODEF document\n   is\
    \ included.  The included schema of IODEF is represented in\n   ReportSchema as\
    \ follows:\n      Version: \"1.0\"\n      XMLSchemaID: \"urn:ietf:params:xml:ns:iodef-1.0\"\
    \n      URL: \"http://www.iana.org/assignments/xml-registry/schema/\n      iodef-1.0.xsd\"\
    \n   The URL is optionally included for IODEF since it is already in the\n   RID\
    \ schema, and the schemaLocation is defined.\n"
- title: 5.6.1.  Including XML Documents in RID
  contents:
  - "5.6.1.  Including XML Documents in RID\n   XML schemas may be registered for\
    \ inclusion in a RID message.  This\n   may include schemas other than IODEF or\
    \ updated versions of IODEF.\n   The registered IANA information for additional\
    \ schemas MUST include\n   the specification name, version, specification Uniform\
    \ Resource\n   Identifier (URI), and namespace.  The following provides an example\n\
    \   of the necessary information for additional schemas beyond IODEF.\n   Example\
    \ Name (XXXX)\n      Schema Name:   XXXX_1.1\n      Version:       1.1\n     \
    \ Namespace:     <registered namespace>\n      Specification URI:  http://www.example.com/XXXX\n\
    \   The version attribute of the ReportSchema class is populated with the\n  \
    \ approved versions of IODEF or any additional schemas registered by\n   IANA;\
    \ see Section 12.\n   The XMLSchemaID of the ReportSchema class is populated with\
    \ the\n   namespace of the included schema.  The attribute enumeration values\n\
    \   include the namespace for IODEF and any schema registered by IANA;\n   see\
    \ Section 12.\n   The URL element of the ReportSchema class is populated with\
    \ the\n   Specification URI value of the included schema.\n"
- title: 6.  RID Messages
  contents:
  - "6.  RID Messages\n   The IODEF model is followed as specified in [RFC5070] for\
    \ each of the\n   RID message types.  The RID schema is used in combination with\
    \ IODEF\n   documents to facilitate RID communications.  Each message type varies\n\
    \   slightly in format and purpose; hence, the requirements vary and are\n   specified\
    \ for each.  All classes, elements, attributes, etc., that\n   are defined in\
    \ the IODEF-Document are valid in the context of a RID\n   message; however, some\
    \ listed as optional in IODEF are mandatory for\n   RID as listed for each message\
    \ type.  The IODEF model MUST be fully\n   implemented for RID messages that include\
    \ IODEF payloads to ensure\n   proper parsing of those messages.\n   Note: The\
    \ implementation of RID may automate the ability to fill in\n   the content required\
    \ for each message type from packet input,\n   incident data, situational awareness\
    \ information, or default values\n   such as those used in the EventData class.\n"
- title: 6.1.  Request
  contents:
  - "6.1.  Request\n   Description: This message type is used to request assistance\
    \ in a\n   computer security investigation.  The investigation request may be\n\
    \   directed to another party that can assist with forensics and continue\n  \
    \ the investigation (the incident may have originated on the SP network\n   to\
    \ which the Request was sent), or it may be directed to an SP to\n   trace the\
    \ traffic from an unknown source.  The Request message with\n   MsgType set to\
    \ 'InvestigationRequest' may leverage the existing\n   bilateral peer relationships\
    \ in order to notify the SP closest to the\n   source of the valid traffic that\
    \ some event occurred, which may be a\n   security-related incident.  A Request\
    \ message with the MsgType set to\n   'TraceRequest' may be sent to an upstream\
    \ peer to trace back through\n   the network to locate the source of malicious\
    \ traffic.  The following\n   information is REQUIRED for Request messages and\
    \ is provided through\n   the following data structures:\n   RID Information:\n\
    \      RIDPolicy\n         RID message type, IncidentID, and destination policy\n\
    \         information\n   IODEF Information:\n      Timestamps (DetectTime, StartTime,\
    \ EndTime, ReportTime).\n      Incident Identifier (Incident class, IncidentID).\n\
    \      Confidence rating of security incident (Impact and Confidence\n      class).\n\
    \      System class is used to list both the Source and Destination.\n      Expectation\
    \ class should be used to request any specific actions\n      to be taken close\
    \ to the source.\n      Path information of nested RID systems, beginning with\
    \ the request\n      originator used in the trace using IODEF EventData with category\n\
    \      set to 'infrastructure'.\n      Event, Record, and RecordItem classes to\
    \ include example packets\n      and other information related to the incident.\
    \  Note: Event\n      information included here requires a second instance of\
    \ EventData\n      in addition to that used to convey SP path contact information.\n\
    \   Standards for encryption and digital signatures [RFC3275] [XMLsig]\n   [XMLencrypt]:\n\
    \      Digital signature from initiating CSIRT or provider system sending\n  \
    \    the RID message, passed to all systems receiving the Request using\n    \
    \  a detached XML digital signature on a RecordItem entry, placed in\n      an\
    \ instance of the Signature element.\n      Digital signature of sending CSIRT\
    \ or SP for authenticity of the\n      RID message, from the CSIRT or provider\
    \ creating this message\n      using an enveloped XML digital signature on the\
    \ IODEF document,\n      placed in an instance of the Signature element.\n   \
    \   XML encryption as required by policy, agreements, and data\n      markers.\n\
    \   Security requirements include the ability to encrypt [XMLencrypt] the\n  \
    \ contents of the Request message using the public key of the\n   destination\
    \ RID system.  The incident number increases whether the\n   Request message has\
    \ the MsgDestination set to 'InvestigationRequest'\n   or 'TraceRequest' in order\
    \ to ensure uniqueness within the system.\n   The relaying peers also append their\
    \ Autonomous System (AS) or RID\n   system information using the path information\
    \ as the Request message\n   was relayed through SPs.  This enables the response\
    \ (Result message)\n   to utilize the same path and trust relationships for the\
    \ return\n   message, indicating any actions taken.  The request is recorded in\n\
    \   the state tables of both the initiating and destination SP RID\n   systems.\
    \  The destination SP is responsible for any actions taken as\n   a result of\
    \ the request in adherence to any service level agreements\n   or policies.  The\
    \ SP MUST confirm that the traffic actually\n   originated from the suspected\
    \ system before taking any action and\n   confirm the reason for the request.\
    \  The request may be sent directly\n   to a known RID system or routed by the\
    \ source address of the attack\n   using the MsgDestination of RIDPolicy set to\
    \ 'SourceOfIncident'.\n   Note: Any intermediate parties in a TraceRequest MUST\
    \ be able to view\n   RIDPolicy information of responding message types in order\
    \ to\n   properly direct RID messages.\n   A DDoS attack can have many sources,\
    \ resulting in multiple traces to\n   locate the sources of the attack.  It may\
    \ be valid to continue\n   multiple traces for a single attack.  The path information\
    \ enables\n   the administrators to determine if the exact trace already passed\n\
    \   through a single network.  The Incident Identifier must also be used\n   to\
    \ identify multiple Requests from a single incident.  If a single\n   Request\
    \ results in divergent paths of Requests, a separate instance\n   number MUST\
    \ be used under the same IncidentID.  The IncidentID\n   instance number of IODEF\
    \ can be used to correlate related incident\n   data that is part of a larger\
    \ incident.\n"
- title: 6.2.  Acknowledgement
  contents:
  - "6.2.  Acknowledgement\n   Description: The Acknowledgement is also used to provide\
    \ a status to\n   any message type and to provide a Justification if the message\
    \ could\n   not be processed for any reason.  This message is sent to the\n  \
    \ initiating RID system from the next upstream provider's application\n   or system\
    \ designated for accepting RID communications to provide\n   information on the\
    \ request status in the current SP.\n   The following information is REQUIRED\
    \ for Acknowledgement messages\n   and is provided through the following data\
    \ structures:\n   RID Information:\n      RIDPolicy\n         RID message type,\
    \ IncidentID, and destination policy\n         information\n      RequestStatus\
    \ class:\n         Status of Request\n   Standards for encryption and digital\
    \ signatures [RFC3275], [XMLsig],\n   [XMLencrypt]:\n      Digital signature of\
    \ responding CSIRT or provider for authenticity\n      of Trace Status Message,\
    \ from the CSIRT or provider creating this\n      message using an enveloped XML\
    \ digital signature.\n      XML encryption as required by policy, agreements,\
    \ and data\n      markers.\n   A message is sent back to the initiating CSIRT\
    \ or provider's system;\n   it accepts RID communications of the trace as status\
    \ notification.\n   This message verifies that the next RID system in the path\
    \ has\n   received the message from the previous system in the path.  This\n \
    \  message also verifies that the trace is now continuing, has stopped,\n   or\
    \ is pending in the next upstream CSIRT or provider's RID system.\n   The Pending\
    \ status is automatically generated after a 2-minute\n   timeout without system-predefined\
    \ or administrator action to approve\n   or disapprove the trace continuance.\
    \  If a Request is denied, the\n   originator and sending peer (if they are not\
    \ the same) MUST both\n   receive the message.  This provides the sending peer\
    \ with the option\n   to take action to stop or mitigate the traffic as close\
    \ to the source\n   as possible.\n"
- title: 6.3.  Result
  contents:
  - "6.3.  Result\n   Description: This message indicates that the trace or investigation\n\
    \   has been completed and provides the result.  The Result message\n   includes\
    \ information on whether or not a source was found, and the\n   source information\
    \ is provided through the IncidentSource class.  The\n   Result information MUST\
    \ go back to the originating RID system that\n   began the investigation or trace.\
    \  A provider may use any number of\n   incident-handling data sources to ascertain\
    \ the true source of an\n   attack.  All of the possible information sources may\
    \ or may not be\n   readily tied into the RID communications system.\n   The following\
    \ information is REQUIRED for Result messages and will be\n   provided through\
    \ the following data structures:\n      RID Information:\n         RIDPolicy\n\
    \            RID message type, IncidentID, and destination policy\n          \
    \  information\n         Incident Source\n            The IncidentSource class\
    \ of the RID schema is used to note\n            if a source was identified and\
    \ provide the source\n            address(es) or other Node information.\n   \
    \   IODEF Information:\n         Timestamps (DetectTime, StartTime, EndTime, ReportTime).\n\
    \         Incident Identifier (Incident class, IncidentID).\n            Trace\
    \ number is used for multiple traces of a single\n            incident; it MUST\
    \ be included if the response is specific to\n            an instance of an incident.\n\
    \         Confidence rating of security incident (Impact and Confidence\n    \
    \     class).\n         System class is used to list both the Source and Destination\n\
    \         Information used in the attack and must note if the traffic is\n   \
    \      spoofed, thus requiring in RID an upstream Request set to\n         'TraceRequest'.\n\
    \         History class \"atype\" attribute is used to note any actions\n    \
    \     taken.\n         History class also notes any other background information\n\
    \         including notes about the Confidence level or rating of the\n      \
    \   result information.\n         Path information of nested RID systems, beginning\
    \ with the\n         request originator used in the trace using IODEF EventData\
    \ with\n         category set to 'infrastructure'.  The last SP listed is the\
    \ SP\n         that located the source of the traffic (the provider sending\n\
    \         the Result message).\n         Event, Record, and RecordItem classes\
    \ to include example\n         packets and other information related to the incident\n\
    \         (optional).  Note: Event information included here requires a\n    \
    \     second instance of EventData in addition to that used to convey\n      \
    \   SP path contact information.\n      Standards for encryption and digital signatures\
    \ [RFC3275],\n      [XMLsig], [XMLencrypt]:\n         Digital signature of source\
    \ CSIRT or provider for authenticity\n         of Result message, from the CSIRT\
    \ or provider creating this\n         message using an enveloped XML digital signature.\n\
    \         XML encryption as required by policy, agreements, and data\n       \
    \  markers.\n   A message is sent back to the initiating CSIRT or provider's RID\n\
    \   system to notify the CSIRT that the source has been located.  The\n   actual\
    \ source information may or may not be included, depending on\n   the policy of\
    \ the network in which the client or host is attached.\n   Any action taken by\
    \ the SP to act upon the discovery of the source of\n   a trace should be included.\
    \  The SP may be able to automate the\n   adjustment of filters at their border\
    \ router to block outbound access\n   for the machine(s) discovered as a part\
    \ of the attack.  The filters\n   may be comprehensive and block all Internet\
    \ access until the host has\n   taken the appropriate action to resolve any security\
    \ issues.  The SP\n   may be limited in their options for filtering due to agreements\
    \ or\n   other restrictions resulting in less comprehensive filters, such as\n\
    \   rate-limiting the ingress traffic as close to the source as possible.\n  \
    \ Security and privacy requirements discussed in Section 9 MUST be\n   taken into\
    \ account.\n   Note: The History class has been expanded in IODEF to accommodate\
    \ all\n   of the possible actions taken as a result of a RID Request using the\n\
    \   \"iodef:atype\", or action type, attribute.  The History class should\n  \
    \ be used to note all actions taken close to the source of a trace or\n   incident\
    \ using the most appropriate option for the type of action\n   along with a description.\
    \  The \"atype\" attribute in the Expectation\n   class can also be used to request\
    \ an appropriate action when a\n   Request is made.\n"
- title: 6.4.  Report
  contents:
  - "6.4.  Report\n   Description: This message or document is sent to a RID system\
    \ to\n   provide a report of a security incident.  This message does not\n   require\
    \ any actions to be taken, except to file the report on the\n   receiving RID\
    \ system or associated database.\n   The following information is REQUIRED for\
    \ Report messages and will be\n   provided through the following data structures:\n\
    \      RID Information:\n         RIDPolicy RID message type, IncidentID, and\
    \ destination policy\n         information\n      The following data is RECOMMENDED\
    \ if available and can be provided\n      through the following data structures:\n\
    \      IODEF Information:\n         Timestamps (DetectTime, StartTime, EndTime,\
    \ ReportTime).\n         Incident Identifier (Incident class, IncidentID).\n \
    \           Trace number is used for multiple traces of a single\n           \
    \ incident; it MUST be included if the Report is specific to\n            an instance\
    \ of an incident.\n         Confidence rating of security incident (Impact and\
    \ Confidence\n         class).\n         System class is used to list both the\
    \ Source and Destination\n         Information used in the attack.\n         Event,\
    \ Record, and RecordItem classes are used to include\n         example packets\
    \ and other information related to the incident\n         (optional).\n      Standards\
    \ for encryption and digital signatures [RFC3275],\n      [XMLsig], [XMLencrypt]:\n\
    \         Digital signature from initiating RID system, passed to all\n      \
    \   systems receiving the report using an enveloped XML digital\n         signature,\
    \ placed in an instance of the Signature element.\n         XML encryption as\
    \ required by policy, agreements, and data\n         markers.\n   Security requirements\
    \ include the ability to encrypt [XMLencrypt] the\n   contents of the Report message\
    \ using the public key of the\n   destination RID system.  Senders of a Report\
    \ message should note that\n   the information may be used to correlate security\
    \ incident\n   information for the purpose of trending, pattern detection, etc.,\
    \ and\n   may be shared with other parties unless otherwise agreed upon with\n\
    \   the receiving RID system.  Therefore, sending parties of a Report\n   message\
    \ may obfuscate or remove destination addresses or other\n   sensitive information\
    \ before sending a Report message.  A Report\n   message may be sent either to\
    \ file an incident report or to respond\n   to a Query, and data sensitivity must\
    \ be considered in both cases.\n   The SP path information is not necessary for\
    \ this message, as it will\n   be communicated directly between two trusted RID\
    \ systems.\n"
- title: 6.5.  Query
  contents:
  - "6.5.  Query\n   Description: The Query message is used to request incident\n\
    \   information from a trusted RID system.  The request can include the\n   incident\
    \ number, if known, or detailed information about the\n   incident.  If the incident\
    \ number is known, the Report message\n   containing the incident information\
    \ can easily be returned to the\n   trusted requestor using automated methods.\
    \  If an example packet or\n   other unique information is included in the Query,\
    \ the return report\n   may be automated; otherwise, analyst intervention may\
    \ be required.\n   The following information is REQUIRED for a Query message and\
    \ is\n   provided through the following data structures:\n      RID Information:\n\
    \         RIDPolicy\n            RID message type, IncidentID, and destination\
    \ policy\n            information\n      IODEF Information (optional):\n     \
    \    Timestamps (DetectTime, StartTime, EndTime, ReportTime).\n         Incident\
    \ Identifier (Incident class, IncidentID).\n            Trace number is used for\
    \ multiple traces of a single\n            incident; it MUST be included if the\
    \ Query is an instance of\n            an incident.\n         Confidence rating\
    \ of security incident (Impact and Confidence\n         class).\n         System\
    \ class is used to list both the Source and Destination\n         Information\
    \ used in the attack.\n         Event, Record, and RecordItem classes are used\
    \ to include\n         example packets and other information related to the incident\n\
    \         (optional).\n      Standards for encryption and digital signatures [RFC3275],\n\
    \      [XMLsig], [XMLencrypt]:\n         Digital signature from the CSIRT or SP\
    \ initiating the RID\n         message, passed to all systems receiving the Query\
    \ using an\n         enveloped XML digital signature, placed in an instance of\
    \ the\n         Signature element.\n         XML encryption as required by policy,\
    \ agreements, and data\n         markers.\n   The proper response to the Query\
    \ message is a Report message.\n   Multiple incidents may be returned for a single\
    \ query if an incident\n   type is requested.  In this case, the receiving system\
    \ sends an IODEF\n   document containing multiple incidents or all instances of\
    \ an\n   incident.  The system sending the reply may preset a limit to the\n \
    \  number of documents returned in one report.  The recommended limit is\n   5,\
    \ to prevent the documents from becoming too large.  Other transfer\n   methods\
    \ may be better suited than RID for large transfers of data.\n   The Confidence\
    \ rating may be used in the Query message to select only\n   incidents with an\
    \ equal or higher Confidence rating than what is\n   specified.  This may be used\
    \ for cases when information is gathered\n   on a type of incident but not on\
    \ specifics about a single incident.\n   Source and Destination Information may\
    \ not be needed if the Query is\n   intended to gather data about a specific type\
    \ of incident.\n"
- title: 7.  RID Communication Exchanges
  contents:
  - "7.  RID Communication Exchanges\n   The following section outlines the communication\
    \ flows for RID and\n   also provides examples of messages.\n   The possible set\
    \ of message exchanges include:\n   o  Request: Asynchronous Request for assistance\
    \ and/or action to be\n      taken, MAY involve multiple systems and iterative\
    \ Requests\n         MsgType set to 'InvestigationRequest' or 'TraceRequest'\n\
    \         Possible responses:\n         +  Acknowledgement (OPTIONAL for InvestigationRequest)\n\
    \         +  Result (REQUIRED unless Acknowledgement was set to 'no')\n      \
    \   +  Report (OPTIONAL; zero or more; Report can be sent\n            unsolicited)\n\
    \   o  Query: Synchronous request for information\n         MsgType set to 'Query'\n\
    \         Possible responses:\n         +  Acknowledgement (OPTIONAL if yes; REQUIRED\
    \ if no Report will\n            be sent)\n         +  Report (REQUIRED unless\
    \ Acknowledgement was set to 'no')\n   o  Report: Asynchronous information report;\
    \ may be pushed to systems\n      or may be a response to a Query\n         MsgType\
    \ set to 'Report'\n         Possible responses:\n         +  Acknowledgement (OPTIONAL)\n\
    \   Processing considerations for the IODEF document and any IODEF\n   included\
    \ elements or attributes MUST follow the guidelines specified\n   in [RFC5070],\
    \ Section 4.  [RFC3023] and [RFC3470] specify\n   requirements and best practices\
    \ for the use of XML in IETF\n   application protocols.  RID and IODEF documents\
    \ MUST be well-formed\n   (see [RFC3470], Section 4.1) and MUST be validated against\
    \ the\n   appropriate schema.  Internal or external DTD subsets are prohibited\n\
    \   in RID; see [RFC3023], Section 3.\n   Comments can be ignored by conform ant\
    \ processors for RID or IODEF\n   documents (see [RFC3470], Section 4.6) and are\
    \ included below for\n   informational purposes only.  The first example demonstrates\
    \ the use\n   of a detached digital signature.  Subsequent examples do not include\n\
    \   the detached signature required for some message types.  The\n   signature\
    \ is applied after the message is created as demonstrated in\n   the first example.\n\
    \   Note: For each example listed below, [RFC5735] addresses were used.\n   Assume\
    \ that each IP address listed is actually a separate network\n   range held by\
    \ different SPs.  Addresses were used from /27 network\n   ranges.\n"
- title: 7.1.  Upstream Trace Communication Flow
  contents:
  - "7.1.  Upstream Trace Communication Flow\n   The diagram below outlines the RID\
    \ Request communication flow for a\n   TraceRequest between RID systems on different\
    \ networks tracing an\n   attack.  The Request message with MsgDestination set\
    \ to\n   'TraceRequest' is represented in the diagram by \"TraceRequest\".\n \
    \  SP-1, SP-2, and SP-3 represent service providers that are involved in\n   the\
    \ example trace communication flow.\n    Attack Dest      SP-1            SP-2\
    \        SP-3        Attack Src\n    1. Attack    |  Attack\n       reported \
    \ |  detected\n    2.              Initiate trace\n    3.              Locate\
    \ origin\n                    through\n                    upstream SP\n    4.\
    \              o---TraceRequest----->\n    5.                              Trace\n\
    \                                    Initiated\n    6.              <---Acknowledgement--o\n\
    \    7.                              Locate origin\n                         \
    \           through\n                                    upstream SP\n    8. \
    \                             o---TraceRequest--->\n    9.                   \
    \                          Trace Initiated\n    10.             <----------Acknowledgement----o\n\
    \                                     <-Acknowledgement-o\n    11.           \
    \                                 Locate attack\n                            \
    \                       source on network   X\n    12.             <------------Result----------------o\n\
    \    13.             o- - - - -Acknowledgement- - - - - >\n                 Figure\
    \ 8: TraceRequest Communication Flow\n   Before a trace is initiated, the RID\
    \ system should verify that an\n   instance of the trace or a similar request\
    \ is not active.  The traces\n   may be resource intensive; therefore, providers\
    \ need to be able to\n   detect potential abuse of the system or unintentional\
    \ resource\n   drains.  Information such as the Source and Destination Information,\n\
    \   associated packets, and the incident may be desirable to maintain for\n  \
    \ a period of time determined by administrators.\n   The communication flow demonstrates\
    \ that an Acknowledgement message\n   is sent to both the downstream peer and\
    \ the original requestor.  If a\n   Request in a traceback is denied, the downstream\
    \ peer has the option\n   to take an action and respond with a Result message.\
    \  The originator\n   of the request may follow up with the downstream peer of\
    \ the SP\n   involved using a Request with the MsgType set to\n   'InvestigationRequest'\
    \ to ensure that an action is taken if no\n   response is received.  Nothing precludes\
    \ the originator of the\n   request from initiating a new Request with the MsgType\
    \ set to\n   'TraceRequest' thereby bypassing the SP that denied the request,\
    \ if a\n   trace is needed beyond that point.  Another option may be for the\n\
    \   initiator to send an 'InvestigationRequest' to an SP upstream of the\n   SP\
    \ that denied the request.  This action assumes enough information\n   was gathered\
    \ to discern the true source of the attack traffic from\n   the incident-handling\
    \ information.\n   The proper response to a TraceRequest is an Acknowledgement\
    \ message.\n   The Acknowledgement message lets the requestor know if the trace\
    \ will\n   continue through the next upstream network.  If there is a problem\n\
    \   with the request, such as a failure to validate the digital signature\n  \
    \ or decrypt the request, an Acknowledgement message MUST be sent to\n   the requestor\
    \ and the downstream peer (if they are not one and the\n   same) providing the\
    \ reason why the message could not be processed.\n   Assuming that the trace continued,\
    \ additional TraceRequests with the\n   response of an Acknowledgement message\
    \ would occur, thereby passing\n   the request upstream in the path to the source\
    \ of the traffic related\n   to the incident.  Once a source is found, a Result\
    \ message is sent to\n   the originator of the trace, as determined by the SP\
    \ path information\n   provided through the document instance of EventData, where\
    \ contact is\n   set to 'infrastructure'.  The SP path information is also used\
    \ when\n   sending the Acknowledgement messages to the first entry (the trace\n\
    \   originator) and the last nested entry (the downstream peer).  The\n   Result\
    \ message is encrypted [XMLencrypt] for the originator providing\n   information\
    \ about the incident source and any actions taken.  If the\n   originator fails\
    \ to decrypt or authenticate the Result message, an\n   Acknowledgement message\
    \ is sent in response; otherwise, no return\n   message is sent.  The final Acknowledgement\
    \ to the Result message is\n   depicted as optional in the diagram above.  If\
    \ an Acknowledgement\n   message is sent with the RequestStatus set to Denied,\
    \ a downstream\n   peer receiving this message may choose to take action to stop\
    \ or\n   mitigate the traffic at that point in the network, as close to the\n\
    \   source as possible.  If the downstream peer chooses this option, it\n   would\
    \ send a Result message to the trace originator.\n"
- title: 7.1.1.  RID TraceRequest Example
  contents:
  - "7.1.1.  RID TraceRequest Example\n   The example listed is of a Request message\
    \ with MsgDestination set to\n   'TraceRequest' based on the incident report example\
    \ from the IODEF\n   document.  The RID classes were included as appropriate for\
    \ a Request\n   message of this type using the RIDPolicy class.  The example given\
    \ is\n   that of a CSIRT reporting a DoS attack in progress to the upstream\n\
    \   SP.  The request asks the next SP to continue the trace and have the\n   traffic\
    \ mitigated closer to the source of the traffic.  The example\n   Request message\
    \ is the first step of a TraceRequest as depicted in\n   the previous diagram,\
    \ where 'Attack Dest' is represented by\n   192.0.2.67 (and SP-1).  The 'Attack\
    \ Src' is later identified in the\n   Result message example as 192.0.2.37 and\
    \ initially as tracing closer\n   to 192.0.2.35.  SP-1 is identified in the Request\
    \ as CSIRT-FOR-OUR-\n   DOMAIN, and SP-2 is identified in the RID document for\
    \ the Request as\n   the 'RIDSystem' in 'MsgDestination' as 192.0.2.3 using the\
    \ Node\n   class.  SP-3 is later used in the Result message and the\n   administrator\
    \ is identified as 'Admin-contact@10.1.1.2' as they\n   searched for 192.0.2.35;\
    \ the administrator may be different than the\n   constituency contact (an additional\
    \ Request with MsgDestination set\n   to 'TraceRequest' occurred between SP-2\
    \ to SP-3 that is not\n   included).  SP-3 is the service provider for 192.0.2.32/27\
    \ and was\n   able to take the action to rate-limit their traffic.  The SP-1,\
    \ SP-2,\n   and SP-3 information would be replaced with the appropriate (and\n\
    \   valid) email and other contact information in real usages.  The Node\n   class\
    \ enables multiple methods to identify a system, such as a fully\n   qualified\
    \ domain name or the IP address to be provided for the SP.\n   Any mapping of\
    \ existing relationships from the SP Node information to\n   the name, contact,\
    \ digital signature verification information and\n   other identifying or trust\
    \ information is provided at the application\n   layer to support end users of\
    \ the incident management system.  A\n   packet is provided in this example to\
    \ enable any traces to be\n   performed by SP-2 and SP-3 to perform traces to\
    \ the attack source\n   before taking the requested action to 'rate-limit' the\
    \ traffic.  The\n   subnet of 192.0.2.0 uses a 27-bit mask in the examples below.\n\
    \   In the following example, use of [XMLsig] to generate digital\n   signatures\
    \ follows the guidance of [XMLsig] 1.0.  Version 1.1 of\n   [XMLsig] supports\
    \ additional digest algorithms.  Reference [RFC4051]\n   for URIs intended for\
    \ use with XML digital signatures, encryption,\n   and canonicalization.  SHA-1\
    \ SHOULD NOT be used; see [RFC6194] for\n   further details.\n   Note: Due to\
    \ the limit of 72 characters per line, some line breaks\n   were added in the\
    \ examples and schemas in this document.\n"
- title: <?xml version="1.0" encoding="UTF-8" standalone="no"?>
  contents:
  - '<?xml version="1.0" encoding="UTF-8" standalone="no"?>

    '
- title: <iodef-rid:RID lang="en-US"
  contents:
  - "<iodef-rid:RID lang=\"en-US\"\n xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\
    \n xsi:schemaLocation=\"urn:ietf:params:xml:ns:iodef-rid-2.0\">\n <iodef-rid:RIDPolicy\
    \ MsgDestination=\"RIDSystem\" MsgType=\"TraceRequest\">\n   <iodef-rid:PolicyRegion\
    \ region=\"IntraConsortium\"/>\n     <iodef:Node>\n      <iodef:Address category=\"\
    ipv4-addr\">192.0.2.3</iodef:Address>\n     </iodef:Node>\n     <iodef-rid:TrafficType\
    \ type=\"Attack\"/>\n     <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n  \
    \          CERT-FOR-OUR-DOMAIN#207-1\n     </iodef:IncidentID>\n     <!-- IODEF-Document\
    \ included in RID -->\n     <iodef-rid:ReportSchema Version=\"1.0\">\n      <iodef-rid:XMLDocument\
    \ dtype=\"xml\" meaning=\"xml\">\n       <IODEF-Document lang=\"en\">\n      \
    \  <iodef:Incident purpose=\"traceback\" restriction=\"need-to-know\">\n     \
    \     <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n                      \
    \     CERT-FOR-OUR-DOMAIN#207-1\n          </iodef:IncidentID>\n          <iodef:DetectTime>2004-02-02T22:49:24+00:00</iodef:DetectTime>\n\
    \          <iodef:StartTime>2004-02-02T22:19:24+00:00</iodef:StartTime>\n    \
    \      <iodef:ReportTime>2004-02-02T23:20:24+00:00</iodef:ReportTime>\n      \
    \    <iodef:Description>\n                           Host involved in DoS attack\n\
    \          </iodef:Description>\n          <iodef:Assessment>\n            <iodef:Impact\
    \ completion=\"failed\" severity=\"low\"\n                          type=\"dos\"\
    />\n          </iodef:Assessment>\n          <iodef:Contact role=\"creator\" type=\"\
    organization\">\n            <iodef:ContactName>Constituency-contact for 192.0.2.35\n\
    \            </iodef:ContactName>\n            <iodef:Email>Constituency-contact@192.0.2.35</iodef:Email>\n\
    \          </iodef:Contact>\n          <iodef:EventData>\n            <iodef:Flow>\n\
    \              <iodef:System category=\"source\">\n                <iodef:Node>\n\
    \                  <iodef:Address category=\"ipv4-addr\">192.0.2.35\n        \
    \          </iodef:Address>\n                </iodef:Node>\n                <iodef:Service\
    \ ip_protocol=\"6\">\n                  <iodef:Port>38765</iodef:Port>\n     \
    \           </iodef:Service>\n              </iodef:System>\n              <iodef:System\
    \ category=\"target\">\n                <iodef:Node>\n                  <iodef:Address\
    \ category=\"ipv4-addr\">192.0.2.67\n                  </iodef:Address>\n    \
    \            </iodef:Node>\n                <iodef:Service ip_protocol=\"6\">\n\
    \                  <iodef:Port>80</iodef:Port>\n                </iodef:Service>\n\
    \              </iodef:System>\n            </iodef:Flow>\n            <iodef:Expectation\
    \ action=\"rate-limit-host\" severity=\"high\">\n              <iodef:Description>\n\
    \                     Rate-limit traffic close to source\n            </iodef:Description>\n\
    \          </iodef:Expectation>\n          <iodef:Record>\n            <iodef:RecordData>\n\
    \              <iodef:Description>\n               The IPv4 packet included was\
    \ used in the described attack\n              </iodef:Description>\n         \
    \     <iodef:RecordItem dtype=\"ipv4-packet\">450000522ad9\n                0000ff06c41fc0a801020a010102976d0050103e020810d9\n\
    \                4a1350021000ad6700005468616e6b20796f7520666f7220\n          \
    \      6361726566756c6c792072656164696e6720746869732052\n                46432e0a\n\
    \              </iodef:RecordItem>\n             </iodef:RecordData>\n       \
    \     </iodef:Record>\n           </iodef:EventData>\n           <iodef:History>\n\
    \             <iodef:HistoryItem action=\"rate-limit-host\">\n               <iodef:DateTime>\n\
    \                      2001-09-14T08:19:01+00:00\n               </iodef:DateTime>\n\
    \               <iodef:IncidentID name=\"CSIRT-FOR-OUR-DOMAIN\">\n           \
    \           CSIRT-FOR-OUR-DOMAIN#207-1\n               </iodef:IncidentID>\n \
    \              <iodef:Description>\n              Notification sent to next upstream\
    \ SP closer to 192.0.2.35\n               </iodef:Description>\n             \
    \ </iodef:HistoryItem>\n             </iodef:History>\n            </iodef:Incident>\n\
    \           </IODEF-Document>\n         </iodef-rid:XMLDocument>\n       <!--\
    \ End of IODEF-Document included in RID -->\n       <!-- Start of detached XML\
    \ signature included in RID -->\n       <iodef-rid:Signature dtype=\"xml\" meaning=\"\
    xml\">\n        <Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"\n    \
    \               Id=\"dsig-123456\">\n        <SignedInfo>\n"
- title: <CanonicalizationMethod
  contents:
  - "<CanonicalizationMethod\n  Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"\
    />\n"
- title: <SignatureMethod
  contents:
  - "<SignatureMethod\n  Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"\
    />\n    <Reference URI=\"\">\n    <Transforms>\n     <Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"\
    />\n     <Transform Algorithm=\"http://www.w3.org/2002/06/xmldsig-filter2\">\n\
    \     <XPath xmlns=\"http://www.w3.org/2002/06/xmldsig-filter2\"\n       xmlns:dsig=\"\
    http://www.w3.org/2000/09/xmldsig#\"\n       xmlns:dsig-trans=\"http://www.w3.org/2002/06/xmldsig-filter2\"\
    \n       Filter=\"intersect\">\n       //dsig:Signature[@Id = 'dsig-123456']/\n\
    \       ancestor::iodef-rid:ReportSchema/\n       iodef-rid:XMLDocument/IODEF-Document[1]/iodef:Incident[1]/\n\
    \       iodef:EventData[1]/iodef:Record[1]/iodef:RecordData[1]/\n       iodef:RecordItem[1]</XPath></Transform></Transforms>\n\
    \    <DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\n \
    \   <DigestValue>\n       NQuIhPjdZuZJnPi/hW62dwJT1dR+vqcZV8mpemCVN5g=\n    </DigestValue>\n\
    \   </Reference></SignedInfo>\n   <SignatureValue>\n"
- title: lnq/ePQ4AVpxCR0ifCp9sMsW0r/AdT3C2GR/zaN1V+hZ/NApOygUjMzTCQnx+RvGPNkO/RVq
  contents:
  - 'lnq/ePQ4AVpxCR0ifCp9sMsW0r/AdT3C2GR/zaN1V+hZ/NApOygUjMzTCQnx+RvGPNkO/RVq

    '
- title: BEIDgZQUEnQZn/uSbmr0tQ6xpBfaxF1DCosLgiZy+2jFzpXrwoN/jHNgtxR/9QLW9mZ+I7V6
  contents:
  - 'BEIDgZQUEnQZn/uSbmr0tQ6xpBfaxF1DCosLgiZy+2jFzpXrwoN/jHNgtxR/9QLW9mZ+I7V6

    '
- title: LEEJ73Kut+d0naTGHlyi64ab2PqsVuRXQ4pXUKbhMkhzeTIqvFLK93KGfsIMd6Cb+n2u/ABy
  contents:
  - 'LEEJ73Kut+d0naTGHlyi64ab2PqsVuRXQ4pXUKbhMkhzeTIqvFLK93KGfsIMd6Cb+n2u/ABy

    '
- title: Lkc+gflJYUWVP4DxkQ4cyex6hM6RYTRUSr7jVD9K4d8KFP2g85i69YLtSu01W1Np0afpJ4a9
  contents:
  - 'Lkc+gflJYUWVP4DxkQ4cyex6hM6RYTRUSr7jVD9K4d8KFP2g85i69YLtSu01W1Np0afpJ4a9

    '
- title: MK0E7ISMNRmC8wIklCAsSXiBRqyaEwaSy/clybI0vCTPqGOYh3/SZg==
  contents:
  - "MK0E7ISMNRmC8wIklCAsSXiBRqyaEwaSy/clybI0vCTPqGOYh3/SZg==\n   </SignatureValue>\n\
    \   <KeyInfo>\n    <KeyValue>\n      <RSAKeyValue>\n       <Modulus>\n"
- title: z8adrX9m0S8OxIxN+fui33wiz4ZYgb4xPbR9MS5pOp1A8kVpH5Ew3N6O3/dMs2a4diIxyGLV
  contents:
  - 'z8adrX9m0S8OxIxN+fui33wiz4ZYgb4xPbR9MS5pOp1A8kVpH5Ew3N6O3/dMs2a4diIxyGLV

    '
- title: h0r86QXWH/W6T2IC2ny+hi+jWRwXrvgTY3ZAFgePvz2OdRhVN/cUbOto4Pa4I2mVZWW+/Q0F
  contents:
  - 'h0r86QXWH/W6T2IC2ny+hi+jWRwXrvgTY3ZAFgePvz2OdRhVN/cUbOto4Pa4I2mVZWW+/Q0F

    '
- title: n7YpqPBDDxlGq/xyFPuYq/4y7Y+Ah+vHO2ZSaiQjbj8F38XrGhwlcbFVyK8AmxK3z0zWwX86
  contents:
  - 'n7YpqPBDDxlGq/xyFPuYq/4y7Y+Ah+vHO2ZSaiQjbj8F38XrGhwlcbFVyK8AmxK3z0zWwX86

    '
- title: uMEqVCjW6s6j2KAWdbAjEpgZHlJY87i/DqnFgxfmdg3oru+YeiEPVRY8hyQpYbtgryveZOHT
  contents:
  - 'uMEqVCjW6s6j2KAWdbAjEpgZHlJY87i/DqnFgxfmdg3oru+YeiEPVRY8hyQpYbtgryveZOHT

    '
- title: gnCHmS/53U9jSS0cyb/ADuj1upfyNoOiMMgQr7Olhc5pTvuWAl4Fnw==</Modulus>
  contents:
  - "gnCHmS/53U9jSS0cyb/ADuj1upfyNoOiMMgQr7Olhc5pTvuWAl4Fnw==</Modulus>\n       <Exponent>AQAB</Exponent>\n\
    \      </RSAKeyValue>\n      </KeyValue>\n    </KeyInfo>\n   </Signature>\n  </iodef-rid:Signature>\n\
    \  <!-- End of detached XML signature included in RID -->\n      </iodef-rid:ReportSchema>\n\
    \   </iodef-rid:RIDPolicy>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: 7.1.2.  Acknowledgement Message Example
  contents:
  - "7.1.2.  Acknowledgement Message Example\n   The example Acknowledgement message\
    \ is in response to the Request\n   message listed above.  The SP that received\
    \ the request is responding\n   to approve the trace continuance in their network.\n\
    \   <iodef-rid:RID lang=\"en\"\n                  xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n                  xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n     <iodef-rid:RIDPolicy\
    \ MsgType=\"Acknowledgement\"\n                          MsgDestination=\"RIDSystem\"\
    >\n       <iodef-rid:PolicyRegion region=\"IntraConsortium\"/>\n       <iodef:Node>\n\
    \         <iodef:Address category=\"ipv4-addr\">192.0.2.67</iodef:Address>\n \
    \      </iodef:Node>\n       <iodef-rid:TrafficType type=\"Attack\"/>\n      \
    \ <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n         CERT-FOR-OUR-DOMAIN#207-1\n\
    \       </iodef:IncidentID>\n     </iodef-rid:RIDPolicy>\n     <iodef-rid:RequestStatus\
    \ AuthorizationStatus=\"Approved\"/>\n   </iodef-rid:RID>\n"
- title: 7.1.3.  Result Message Example
  contents:
  - "7.1.3.  Result Message Example\n   The example Result message is in response\
    \ to the Request listed\n   above.  This message type only comes after an Acknowledgement\
    \ within\n   the Request flow of messages where a TraceRequest is in progress.\
    \  It\n   may be a direct response to a Request with the MsgType set to\n   'InvestigationRequest'.\
    \  This message provides information about the\n   source of the attack and the\
    \ actions taken to mitigate the traffic.\n   The Result message is typically the\
    \ last message in a Request flow;\n   however, an Acknowledgement MAY follow if\
    \ there are any issues\n   receiving or processing the Result.\n"
- title: <iodef-rid:RID lang="en"
  contents:
  - "<iodef-rid:RID lang=\"en\"\n               xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n               xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"Result\"\n                       MsgDestination=\"RIDSystem\">\n \
    \   <iodef-rid:PolicyRegion region=\"IntraConsortium\"/>\n    <iodef:Node>\n \
    \     <iodef:Address category=\"ipv4-addr\">192.0.2.67</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#207-1\n    </iodef:IncidentID>\n"
- title: <!-- IODEF-Document included in RID -->
  contents:
  - "<!-- IODEF-Document included in RID -->\n    <iodef-rid:ReportSchema Version=\"\
    1.0\">\n     <iodef-rid:XMLDocument dtype=\"xml\" meaning=\"xml\">\n      <iodef:IODEF-Document\
    \ lang=\"en\">\n      <iodef:Incident restriction=\"need-to-know\" purpose=\"\
    traceback\">\n        <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n      \
    \    CERT-FOR-OUR-DOMAIN#207-1\n        </iodef:IncidentID>\n      <iodef:DetectTime>2004-02-02T22:49:24+00:00</iodef:DetectTime>\n\
    \      <iodef:StartTime>2004-02-02T22:19:24+00:00</iodef:StartTime>\n      <iodef:ReportTime>2004-02-02T23:20:24+00:00</iodef:ReportTime>\n\
    \      <iodef:Description>Host involved in DoS attack</iodef:Description>\n  \
    \    <iodef:Assessment>\n        <iodef:Impact severity=\"low\" completion=\"\
    failed\"\n                      type=\"dos\"/>\n      </iodef:Assessment>\n  \
    \    <iodef:Contact role=\"creator\" type=\"organization\">\n        <iodef:ContactName>Constituency-contact\
    \ for 192.0.2.35\n        </iodef:ContactName>\n        <iodef:Email>Constituency-contact@192.0.2.35</iodef:Email>\n\
    \      </iodef:Contact>\n      <iodef:EventData>\n        <iodef:Contact role=\"\
    admin\" type=\"organization\">\n          <iodef:ContactName>Admin-contact for\
    \ 192.0.2.35\n          </iodef:ContactName>\n          <iodef:Email>Admin-contact@10.1.1.2</iodef:Email>\n\
    \        </iodef:Contact>\n        <iodef:Flow>\n          <iodef:System category=\"\
    intermediate\">\n            <iodef:Node>\n              <iodef:Address category=\"\
    ipv4-addr\">192.0.2.35\n              </iodef:Address>\n            </iodef:Node>\n\
    \          </iodef:System>\n        </iodef:Flow>\n        <iodef:EventData>\n\
    \          <iodef:Contact role=\"admin\" type=\"organization\">\n            <iodef:ContactName>Admin-contact\
    \ for 192.0.2.3\n            </iodef:ContactName>\n            <iodef:Email>Admin-contact@192.0.2.3</iodef:Email>\n\
    \          </iodef:Contact>\n          <iodef:Flow>\n            <iodef:System\
    \ category=\"intermediate\">\n              <iodef:Node>\n                <iodef:Address\
    \ category=\"ipv4-addr\">192.0.2.3\n                </iodef:Address>\n       \
    \       </iodef:Node>\n            </iodef:System>\n          </iodef:Flow>\n\
    \        </iodef:EventData>\n      </iodef:EventData>\n      <iodef:EventData>\n\
    \        <iodef:Flow>\n          <iodef:System category=\"source\">\n        \
    \    <iodef:Node>\n              <iodef:Address category=\"ipv4-addr\">192.0.2.35\n\
    \              </iodef:Address>\n            </iodef:Node>\n            <iodef:Service\
    \ ip_protocol=\"6\">\n              <iodef:Port>38765</iodef:Port>\n         \
    \   </iodef:Service>\n          </iodef:System>\n          <iodef:System category=\"\
    target\">\n            <iodef:Node>\n              <iodef:Address category=\"\
    ipv4-addr\">192.0.2.67\n              </iodef:Address>\n            </iodef:Node>\n\
    \            <iodef:Service ip_protocol=\"6\">\n              <iodef:Port>80</iodef:Port>\n\
    \            </iodef:Service>\n          </iodef:System>\n        </iodef:Flow>\n\
    \        <iodef:Expectation severity=\"high\" action=\"rate-limit-host\">\n  \
    \        <iodef:Description>\n            Rate-limit traffic close to source\n\
    \          </iodef:Description>\n        </iodef:Expectation>\n        <iodef:Record>\n\
    \          <iodef:RecordData>\n            <iodef:Description>\n             \
    \ The IPv4 packet included was used in the described attack\n            </iodef:Description>\n\
    \            <iodef:RecordItem dtype=\"ipv4-packet\">450000522ad9\n          \
    \  0000ff06c41fc0a801020a010102976d0050103e020810d9\n            4a1350021000ad6700005468616e6b20796f7520666f7220\n\
    \            6361726566756c6c792072656164696e6720746869732052\n            46432e0a\n\
    \            </iodef:RecordItem>\n          </iodef:RecordData>\n        </iodef:Record>\n\
    \      </iodef:EventData>\n      <iodef:History>\n        <iodef:HistoryItem action=\"\
    rate-limit-host\">\n          <iodef:DateTime>2004-02-02T22:53:01+00:00</iodef:DateTime>\n\
    \          <iodef:IncidentID name=\"CSIRT-FOR-OUR-DOMAIN\">\n            CSIRT-FOR-OUR-DOMAIN#207-1\n\
    \          </iodef:IncidentID>\n          <iodef:Description>\n            Notification\
    \ sent to next upstream SP closer to 192.0.2.35\n          </iodef:Description>\n\
    \        </iodef:HistoryItem>\n        <iodef:HistoryItem action=\"rate-limit-host\"\
    >\n          <iodef:DateTime>2004-02-02T23:07:21+00:00</iodef:DateTime>\n    \
    \      <iodef:IncidentID name=\"CSIRT-FOR-SP3\">\n            CSIRT-FOR-SP3#3291-1\n\
    \          </iodef:IncidentID>\n          <iodef:Description>\n            Host\
    \ rate-limited for 24 hours\n            </iodef:Description>\n          </iodef:HistoryItem>\n\
    \        </iodef:History>\n      </iodef:Incident>\n      </iodef:IODEF-Document>\n\
    \     </iodef-rid:XMLDocument>\n"
- title: <!-- End of IODEF-Document included in RID -->
  contents:
  - "<!-- End of IODEF-Document included in RID -->\n   </iodef-rid:ReportSchema>\n\
    \  </iodef-rid:RIDPolicy>\n  <iodef-rid:IncidentSource>\n    <iodef-rid:SourceFound>true</iodef-rid:SourceFound>\n\
    \    <iodef:Node>\n      <iodef:Address category=\"ipv4-addr\">192.0.2.37</iodef:Address>\n\
    \    </iodef:Node>\n  </iodef-rid:IncidentSource>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: 7.2.  Investigation Request Communication Flow
  contents:
  - "7.2.  Investigation Request Communication Flow\n   The diagram below outlines\
    \ a RID Request communication flow between\n   RID systems on different networks\
    \ for a security incident with a\n   known source address.  Therefore, MsgDestination\
    \ is set to\n   'InvestigationRequest' for the Request message and is included\
    \ in the\n   diagram below as \"Investigation\".  The proper response to a Request\n\
    \   with the MsgDestination set to 'InvestigationRequest' is a Result\n   message.\
    \  If there is a problem with the Request, such as a failure\n   to validate the\
    \ digital signature or decrypt the Request, an\n   Acknowledgement message is\
    \ sent to the requestor.  The\n   Acknowledgement message should provide the reason\
    \ why the message\n   could not be processed.\n       Attack Dest      SP-1  \
    \            SP-2        Attack Src\n       1. Attack    |  Attack\n         \
    \ reported  |  detected\n       2.              Determine source\n           \
    \            of security incident\n       3.              o---Investigation---->\n\
    \       4.                              Research\n                           \
    \            incident and\n                                       determine appropriate\n\
    \                                       actions to take\n       5.           \
    \   <-------Result-------o\n            Figure 9: Investigation Request Communication\
    \ Flow\n"
- title: 7.2.1.  Investigation Request Example
  contents:
  - "7.2.1.  Investigation Request Example\n   The following example only includes\
    \ the RID-specific details.  The\n   IODEF and security measures are similar to\
    \ the TraceRequest, with the\n   exception that the source is known, the receiving\
    \ RID system is known\n   to be close to the source, and the MsgDestination is\
    \ set to\n   'InvestigationRequest'.  The source known is indicated in the IODEF\n\
    \   document, which allows for incident sources to be listed as spoofed,\n   if\
    \ appropriate.\n   This flow does not include a Result message because the request\
    \ is\n   denied as shown in the Acknowledgement response.\n   SP-1 is represented\
    \ by CERT-FOR-OUR-DOMAIN and 192.0.2.67.  SP-2 is\n   identified by 192,0.2.98.\
    \  In this example, SP-2 is the service\n   provider for systems on the 192.0.2.32/27\
    \ subnet.  The contact for\n   the host 192.0.2.35 is known at the start of the\
    \ request as\n   'Constituency-contact@10.1.1.2'.\n  <iodef-rid:RID lang=\"en\"\
    \n                 xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\n\
    \                 xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n    <iodef-rid:RIDPolicy\
    \ MsgType=\"InvestigationRequest\"\n                         MsgDestination=\"\
    SourceOfIncident\">\n      <iodef-rid:PolicyRegion region=\"PeerToPeer\"/>\n \
    \     <iodef:Node>\n        <iodef:Address category=\"ipv4-addr\">192.0.2.98</iodef:Address>\n\
    \      </iodef:Node>\n      <iodef-rid:TrafficType type=\"Attack\"/>\n      <iodef:IncidentID\
    \ name=\"CERT-FOR-OUR-DOMAIN\">\n        CERT-FOR-OUR-DOMAIN#208-1\n      </iodef:IncidentID>\n\
    \  <!-- IODEF-Document included in RID -->\n      <iodef-rid:ReportSchema Version=\"\
    1.0\">\n       <iodef-rid:XMLDocument dtype=\"xml\" meaning=\"xml\">\n    <iodef:IODEF-Document\
    \ lang=\"en\">\n    <iodef:Incident restriction=\"need-to-know\" purpose=\"other\"\
    >\n      <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n        CERT-FOR-OUR-DOMAIN#208-1\n\
    \      </iodef:IncidentID>\n      <iodef:DetectTime>2004-02-05T08:13:33+00:00</iodef:DetectTime>\n\
    \      <iodef:StartTime>2004-02-05T08:13:31+00:00</iodef:StartTime>\n      <iodef:EndTime>2004-02-05T08:13:33+00:00</iodef:EndTime>\n\
    \      <iodef:ReportTime>2004-02-05T08:13:35+00:00</iodef:ReportTime>\n      <iodef:Description>Host\
    \ involved in DoS attack</iodef:Description>\n      <iodef:Assessment>\n     \
    \   <iodef:Impact severity=\"low\" completion=\"failed\" type=\"recon\"/>\n  \
    \    </iodef:Assessment>\n      <iodef:Contact role=\"creator\" type=\"organization\"\
    >\n        <iodef:ContactName>Constituency-contact for 192.0.2.35\n        </iodef:ContactName>\n\
    \        <iodef:Email>Constituency-contact@10.1.1.2</iodef:Email>\n      </iodef:Contact>\n\
    \      <iodef:EventData>\n        <iodef:Flow>\n          <iodef:System category=\"\
    source\">\n            <iodef:Node>\n              <iodef:Address category=\"\
    ipv4-addr\">192.0.2.35\n              </iodef:Address>\n            </iodef:Node>\n\
    \            <iodef:Service ip_protocol=\"6\">\n              <iodef:Port>41421</iodef:Port>\n\
    \            </iodef:Service>\n          </iodef:System>\n          <iodef:System\
    \ category=\"target\">\n            <iodef:Node>\n              <iodef:Address\
    \ category=\"ipv4-addr\">192.0.2.67\n              </iodef:Address>\n        \
    \    </iodef:Node>\n            <iodef:Service ip_protocol=\"6\">\n          \
    \    <iodef:Port>80</iodef:Port>\n            </iodef:Service>\n          </iodef:System>\n\
    \        </iodef:Flow>\n        <iodef:Expectation severity=\"high\" action=\"\
    investigate\">\n          <iodef:Description>\n            Investigate whether\
    \ source has been compromised\n          </iodef:Description>\n        </iodef:Expectation>\n\
    \      </iodef:EventData>\n      <iodef:History>\n        <iodef:HistoryItem action=\"\
    block-host\">\n          <iodef:DateTime>2004-02-05T08:19:01+00:00</iodef:DateTime>\n\
    \          <iodef:IncidentID name=\"CSIRT-FOR-OUR-DOMAIN\">\n            CSIRT-FOR-OUR-DOMAIN#208-1\n\
    \          </iodef:IncidentID>\n          <iodef:Description>\n            Investigation\
    \ request sent to SP for 192.0.2.35\n          </iodef:Description>\n        </iodef:HistoryItem>\n\
    \      </iodef:History>\n    </iodef:Incident>\n    </iodef:IODEF-Document>\n\
    \       </iodef-rid:XMLDocument>\n  <!-- End of IODEF-Document included in RID\
    \ -->\n      </iodef-rid:ReportSchema>\n    </iodef-rid:RIDPolicy>\n  </iodef-rid:RID>\n"
- title: 7.2.2.  Acknowledgement Message Example
  contents:
  - "7.2.2.  Acknowledgement Message Example\n   The example Acknowledgement message\
    \ is in response to the Request\n   listed above.  The SP that received the request\
    \ was unable to\n   validate the digital signature used to authenticate the sending\
    \ RID\n   system.\n   <iodef-rid:RID lang=\"en\"\n                  xmlns:iodef-rid=\"\
    urn:ietf:params:xml:ns:iodef-rid-2.0\"\n                  xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\"\
    >\n     <iodef-rid:RIDPolicy MsgType=\"Acknowledgement\"\n                   \
    \       MsgDestination=\"RIDSystem\">\n       <iodef-rid:PolicyRegion region=\"\
    IntraConsortium\"/>\n       <iodef:Node>\n         <iodef:Address category=\"\
    ipv4-addr\">192.0.2.67</iodef:Address>\n       </iodef:Node>\n       <iodef-rid:TrafficType\
    \ type=\"Attack\"/>\n       <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n\
    \         CERT-FOR-OUR-DOMAIN#208-1\n       </iodef:IncidentID>\n     </iodef-rid:RIDPolicy>\n\
    \     <iodef-rid:RequestStatus AuthorizationStatus=\"Denied\"\n              \
    \                Justification=\"Authentication\"/>\n   </iodef-rid:RID>\n"
- title: 7.3.  Report Communication Flow
  contents:
  - "7.3.  Report Communication Flow\n   The diagram below outlines the RID Report\
    \ communication flow between\n   RID systems on different SPs.\n           SP-1\
    \                           SP-2\n        1. Generate incident information\n \
    \          and prepare Report message\n        2.              o-------Report------->\n\
    \        3.                          File report in database\n               \
    \    Figure 10: Report Communication Flow\n   The Report communication flow is\
    \ used to provide information on\n   incidents.  Incident information may be shared\
    \ between CSIRTs or\n   other entities using this format.  When a report is received,\
    \ the RID\n   system must verify that the report has not already been filed. \
    \ The\n   incident number and incident data, such as the hexadecimal packet and\n\
    \   incident class information, can be used to compare with existing\n   database\
    \ entries.  The Report message typically does not have a\n   response.  If there\
    \ is a problem with the Report message, such as a\n   failure to validate the\
    \ digital signature [RFC3275] or decrypt the\n   request, an Acknowledgement message\
    \ is sent to the requestor.  The\n   Acknowledgement message should provide the\
    \ reason why the message\n   could not be processed.\n"
- title: 7.3.1.  Report Example
  contents:
  - "7.3.1.  Report Example\n   The following example only includes the RID-specific\
    \ details.  This\n   report is an unsolicited Report message that includes an\
    \ IPv4 packet.\n   The IODEF document and digital signature is similar to the\
    \ Request\n   example with MsgDestination set to 'TraceRequest'.\n   This example\
    \ is a message sent from SP-1, CERT-FOR-OUR-DOMAIN at\n   192.0.2.67, to SP-2\
    \ at 192.0.2.130 for informational purposes on an\n   attack that took place.\n\
    \   <iodef-rid:RID lang=\"en\"\n                  xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n                  xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n     <iodef-rid:RIDPolicy\
    \ MsgType=\"Report\" MsgDestination=\"RIDSystem\">\n       <iodef-rid:PolicyRegion\
    \ region=\"PeerToPeer\"/>\n       <iodef:Node>\n         <iodef:Address category=\"\
    ipv4-addr\">192.0.2.130</iodef:Address>\n       </iodef:Node>\n       <iodef-rid:TrafficType\
    \ type=\"Attack\"/>\n       <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n\
    \         CERT-FOR-OUR-DOMAIN#209-1\n       </iodef:IncidentID>\n   <!-- IODEF-Document\
    \ included in RID -->\n       <iodef-rid:ReportSchema>\n        <iodef-rid:XMLDocument\
    \ dtype=\"xml\" meaning=\"xml\">\n     <iodef:IODEF-Document lang=\"en\">\n  \
    \   <iodef:Incident restriction=\"need-to-know\" purpose=\"reporting\">\n    \
    \   <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n         CERT-FOR-OUR-DOMAIN#209-1\n\
    \       </iodef:IncidentID>\n       <iodef:DetectTime>2004-02-05T10:21:08+00:00</iodef:DetectTime>\n\
    \       <iodef:StartTime>2004-02-05T10:21:05+00:00</iodef:StartTime>\n       <iodef:EndTime>2004-02-05T10:35:00+00:00</iodef:EndTime>\n\
    \       <iodef:ReportTime>2004-02-05T10:27:38+00:00</iodef:ReportTime>\n     \
    \  <iodef:Description>Host illicitly accessed admin account\n       </iodef:Description>\n\
    \       <iodef:Assessment>\n         <iodef:Impact severity=\"high\" completion=\"\
    succeeded\"\n                       type=\"admin\"/>\n         <iodef:Confidence\
    \ rating=\"high\"/>\n       </iodef:Assessment>\n       <iodef:Contact role=\"\
    creator\" type=\"organization\">\n         <iodef:ContactName>Constituency-contact\
    \ for 192.0.2.35\n         </iodef:ContactName>\n         <iodef:Email>Constituency-contact@10.1.1.2</iodef:Email>\n\
    \       </iodef:Contact>\n       <iodef:EventData>\n         <iodef:Flow>\n  \
    \         <iodef:System category=\"source\">\n             <iodef:Node>\n    \
    \           <iodef:Address category=\"ipv4-addr\">192.0.2.35\n               </iodef:Address>\n\
    \             </iodef:Node>\n             <iodef:Service ip_protocol=\"6\">\n\
    \               <iodef:Port>32821</iodef:Port>\n             </iodef:Service>\n\
    \           </iodef:System>\n           <iodef:System category=\"target\">\n \
    \            <iodef:Node>\n               <iodef:Address category=\"ipv4-addr\"\
    >192.0.2.67\n               </iodef:Address>\n             </iodef:Node>\n   \
    \          <iodef:Service ip_protocol=\"6\">\n               <iodef:Port>22</iodef:Port>\n\
    \             </iodef:Service>\n           </iodef:System>\n         </iodef:Flow>\n\
    \       </iodef:EventData>\n       <iodef:History>\n         <iodef:HistoryItem\
    \ action=\"rate-limit-host\">\n           <iodef:DateTime>2004-02-05T10:28:00+00:00</iodef:DateTime>\n\
    \           <iodef:IncidentID name=\"CSIRT-FOR-OUR-DOMAIN\">\n             CSIRT-FOR-OUR-DOMAIN#209-1\n\
    \           </iodef:IncidentID>\n           <iodef:Description>\n            \
    \ Incident report sent to SP for 192.0.2.35\n           </iodef:Description>\n\
    \         </iodef:HistoryItem>\n       </iodef:History>\n     </iodef:Incident>\n\
    \     </iodef:IODEF-Document>\n        </iodef-rid:XMLDocument>\n   <!-- End of\
    \ IODEF-Document included in RID -->\n     </iodef-rid:ReportSchema>\n     </iodef-rid:RIDPolicy>\n\
    \   </iodef-rid:RID>\n"
- title: 7.4.  Query Communication Flow
  contents:
  - "7.4.  Query Communication Flow\n   The diagram below outlines the RID Query communication\
    \ flow between\n   RID systems on different networks.\n           SP-1       \
    \                    SP-2\n        1. Generate a request for\n           information\
    \ on a specific\n           incident number or incident type\n        2.     \
    \         o-------Query------->\n        3.                              Verify\
    \ policy information\n                                        and determine if\
    \ matches exist\n                                        for requested information\n\
    \        4.              <-------Report------o\n        5.  Associate report to\
    \ request\n            by incident number or type\n            and file report(s).\n\
    \                    Figure 11: Query Communication Flow\n   The Query message\
    \ communication receives a response of a Report\n   message.  If the Report message\
    \ is empty, the responding host did not\n   have information available to share\
    \ with the requestor.  The incident\n   number and responding RID system, as well\
    \ as the transport, assist in\n   the association of the request and response\
    \ since a report can be\n   filed and is not always solicited.  If there is a\
    \ problem with the\n   Query message, such as a failure to validate the digital\
    \ signature or\n   decrypt the request, an Acknowledgement message is sent to\
    \ the\n   requestor.  The Acknowledgement message should provide the reason why\n\
    \   the message could not be processed.\n"
- title: 7.4.1.  Query Example
  contents:
  - "7.4.1.  Query Example\n   The Query request may be received in several formats\
    \ as a result of\n   the type of query being performed.  If the incident number\
    \ is the\n   only information provided, the IODEF document and IP packet data\
    \ may\n   not be needed to complete the request.  However, if a type of\n   incident\
    \ is requested, the incident number remains NULL, and the IP\n   packet data will\
    \ not be included in the IODEF RecordItem class; the\n   other incident information\
    \ is the main source for comparison.  In the\n   case in which an incident number\
    \ may not be the same between CSIRTs,\n   the incident number and/or IP packet\
    \ information can be provided and\n   used for comparison on the receiving RID\
    \ system to generate (a)\n   Report message(s).\n   This query is sent to 192.0.2.3,\
    \ inquiring about the incident with\n   the identifier CERT-FOR-OUR-DOMAIN#210-1.\
    \  The Report will be\n   provided to the requestor identified and verified through\
    \ the\n   authentication and digital signature information provided in the RID\n\
    \   message.  An example Report is provided above.\n   <iodef-rid:RID lang=\"\
    en\"\n                  xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n                  xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n     <iodef-rid:RIDPolicy\
    \ MsgType=\"Query\"\n                          MsgDestination=\"RIDSystem\">\n\
    \       <iodef-rid:PolicyRegion region=\"PeerToPeer\"/>\n       <iodef:Node>\n\
    \         <iodef:Address category=\"ipv4-addr\">192.0.2.3</iodef:Address>\n  \
    \     </iodef:Node>\n       <iodef-rid:TrafficType type=\"Attack\"/>\n       <iodef:IncidentID\
    \ name=\"CERT-FOR-OUR-DOMAIN\">\n         CERT-FOR-OUR-DOMAIN#210-1\n       </iodef:IncidentID>\n\
    \     </iodef-rid:RIDPolicy>\n   </iodef-rid:RID>\n"
- title: 8.  RID Schema Definition
  contents:
  - '8.  RID Schema Definition

    '
- title: <?xml version="1.0" encoding="UTF-8"?>
  contents:
  - "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <xs:schema xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n  xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\"\n  xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\
    \n  xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"\n  targetNamespace=\"urn:ietf:params:xml:ns:iodef-rid-2.0\"\
    \n  elementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\">\n <xs:import\
    \ namespace=\"urn:ietf:params:xml:ns:iodef-1.0\"\n schemaLocation=\"http://www.iana.org/assignments/xml-registry/schema/\n\
    \ iodef-1.0.xsd\"/>\n <xs:import namespace=\"http://www.w3.org/2000/09/xmldsig#\"\
    \n schemaLocation=\"http://www.w3.org/TR/xmldsig-core/\n xmldsig-core-schema.xsd\"\
    />\n <!-- ****************************************************************\n *********************************************************************\n\
    \ ***  Real-time Inter-network Defense - RID XML Schema             ***\n ***\
    \    Namespace - iodef-rid, April 2012                        ***\n ***    The\
    \ namespace is defined to support transport of IODEF     ***\n ***     documents\
    \ for exchanging incident information.            ***\n *********************************************************************\n\
    \ -->\n <!--RID messages act as an envelope for IODEF and RID documents\n    \
    \ to support the exchange of incident information-->\n <!--\n ====== Real-Time\
    \ Inter-network Defense - RID ======\n ====  Suggested definition for RID messaging\
    \ ======\n  -->\n <xs:annotation>\n   <xs:documentation>XML Schema wrapper for\
    \ IODEF</xs:documentation>\n </xs:annotation>\n <xs:element name=\"RID\" type=\"\
    iodef-rid:RIDType\"/>\n   <xs:complexType name=\"RIDType\">\n     <xs:sequence>\n\
    \       <xs:element ref=\"iodef-rid:RIDPolicy\" minOccurs=\"0\"/>\n       <xs:element\
    \ ref=\"iodef-rid:RequestStatus\" minOccurs=\"0\"/>\n       <xs:element ref=\"\
    iodef-rid:IncidentSource\" minOccurs=\"0\"/>\n     </xs:sequence>\n     <xs:attribute\
    \ name=\"lang\"\n                    type=\"xs:language\" use=\"required\"/>\n\
    \   </xs:complexType>\n <!--Used in Acknowledgement Message for RID-->\n <xs:element\
    \ name=\"RequestStatus\" type=\"iodef-rid:RequestStatusType\"/>\n   <xs:complexType\
    \ name=\"RequestStatusType\">\n      <xs:attribute name=\"AuthorizationStatus\"\
    \ use=\"required\">\n         <xs:simpleType>\n           <xs:restriction base=\"\
    xs:NMTOKEN\">\n           <xs:whiteSpace value=\"collapse\"/>\n             <xs:enumeration\
    \ value=\"Approved\"/>\n             <xs:enumeration value=\"Denied\"/>\n    \
    \         <xs:enumeration value=\"Pending\"/>\n             <xs:enumeration value=\"\
    ext-value\"/>\n           </xs:restriction>\n         </xs:simpleType>\n     \
    \ </xs:attribute>\n      <xs:attribute name=\"ext-AuthorizationStatus\"\n    \
    \                type=\"xs:string\" use=\"optional\"/>\n      <xs:attribute name=\"\
    Justification\">\n         <xs:simpleType>\n           <xs:restriction base=\"\
    xs:NMTOKEN\">\n           <xs:whiteSpace value=\"collapse\"/>\n             <xs:enumeration\
    \ value=\"SystemResource\"/>\n             <xs:enumeration value=\"Authentication\"\
    />\n             <xs:enumeration value=\"AuthenticationOrigin\"/>\n          \
    \   <xs:enumeration value=\"Encryption\"/>\n             <xs:enumeration value=\"\
    UnrecognizedFormat\"/>\n             <xs:enumeration value=\"CannotProcess\"/>\n\
    \             <xs:enumeration value=\"Other\"/>\n             <xs:enumeration\
    \ value=\"ext-value\"/>\n           </xs:restriction>\n         </xs:simpleType>\n\
    \      </xs:attribute>\n      <xs:attribute name=\"ext-Justification\"\n     \
    \               type=\"xs:string\" use=\"optional\"/>\n     <xs:attribute name=\"\
    restriction\" type=\"iodef:restriction-type\"/>\n   </xs:complexType>\n <!--Incident\
    \ Source Information for Result Message-->\n <xs:element name=\"IncidentSource\"\
    \ type=\"iodef-rid:IncidentSourceType\"/>\n   <xs:complexType name=\"IncidentSourceType\"\
    >\n     <xs:sequence>\n       <xs:element ref=\"iodef-rid:SourceFound\"/>\n  \
    \     <xs:element ref=\"iodef:Node\" minOccurs=\"0\"\n           maxOccurs=\"\
    unbounded\"/>\n     </xs:sequence>\n     <xs:attribute name=\"restriction\" type=\"\
    iodef:restriction-type\"/>\n   </xs:complexType>\n   <xs:element name=\"SourceFound\"\
    \ type=\"xs:boolean\"/>\n <!--\n ====== Real-Time Inter-network Defense Policy\
    \ - RIDPolicy ======\n ======  Definition for RIDPolicy for messaging\n  -->\n\
    \ <xs:annotation>\n  <xs:documentation>RID Policy used for transport of\n    \
    \  messages</xs:documentation>\n </xs:annotation>\n <!-- RIDPolicy information\
    \ with setting information listed in RID\n      documentation -->\n <xs:element\
    \ name=\"RIDPolicy\" type=\"iodef-rid:RIDPolicyType\"/>\n   <xs:complexType name=\"\
    RIDPolicyType\">\n     <xs:sequence>\n       <xs:element ref=\"iodef-rid:PolicyRegion\"\
    \ maxOccurs=\"unbounded\"/>\n       <xs:element ref=\"iodef:Node\"/>\n       <xs:element\
    \ ref=\"iodef-rid:TrafficType\" maxOccurs=\"unbounded\"/>\n       <xs:element\
    \ ref=\"iodef:IncidentID\" minOccurs=\"0\"/>\n       <xs:element ref=\"iodef-rid:ReportSchema\"\
    \ minOccurs=\"0\"/>\n     </xs:sequence>\n    <xs:attribute name=\"MsgType\" use=\"\
    required\">\n     <xs:simpleType>\n       <xs:restriction base=\"xs:NMTOKEN\"\
    >\n       <xs:whiteSpace value=\"collapse\"/>\n         <xs:enumeration value=\"\
    TraceRequest\"/>\n         <xs:enumeration value=\"Acknowledgement\"/>\n     \
    \    <xs:enumeration value=\"Result\"/>\n         <xs:enumeration value=\"InvestigationRequest\"\
    />\n         <xs:enumeration value=\"Report\"/>\n         <xs:enumeration value=\"\
    Query\"/>\n         <xs:enumeration value=\"ext-value\"/>\n       </xs:restriction>\n\
    \     </xs:simpleType>\n    </xs:attribute>\n   <xs:attribute name=\"ext-MsgType\"\
    \ type=\"xs:string\" use=\"optional\"/>\n   <xs:attribute name=\"MsgDestination\"\
    \ use=\"required\">\n     <xs:simpleType>\n       <xs:restriction base=\"xs:NMTOKEN\"\
    >\n       <xs:whiteSpace value=\"collapse\"/>\n         <xs:enumeration value=\"\
    RIDSystem\"/>\n         <xs:enumeration value=\"SourceOfIncident\"/>\n       \
    \  <xs:enumeration value=\"ext-value\"/>\n       </xs:restriction>\n     </xs:simpleType>\n\
    \    </xs:attribute>\n   <xs:attribute name=\"ext-MsgDestination\" type=\"xs:string\"\
    \n                 use=\"optional\"/>\n   <xs:attribute name=\"restriction\" type=\"\
    iodef:restriction-type\"/>\n    </xs:complexType>\n   <xs:element name=\"PolicyRegion\"\
    >\n     <xs:complexType>\n      <xs:attribute name=\"region\" use=\"required\"\
    >\n       <xs:simpleType>\n        <xs:restriction base=\"xs:NMTOKEN\">\n    \
    \    <xs:whiteSpace value=\"collapse\"/>\n          <xs:enumeration value=\"ClientToSP\"\
    />\n          <xs:enumeration value=\"SPToClient\"/>\n          <xs:enumeration\
    \ value=\"IntraConsortium\"/>\n          <xs:enumeration value=\"PeerToPeer\"\
    />\n          <xs:enumeration value=\"BetweenConsortiums\"/>\n          <xs:enumeration\
    \ value=\"ext-value\"/>\n        </xs:restriction>\n       </xs:simpleType>\n\
    \      </xs:attribute>\n      <xs:attribute name=\"ext-region\"\n            \
    \        type=\"xs:string\" use=\"optional\"/>\n     </xs:complexType>\n   </xs:element>\n\
    \   <xs:element name=\"TrafficType\">\n     <xs:complexType>\n      <xs:attribute\
    \ name=\"type\" use=\"required\">\n       <xs:simpleType>\n        <xs:restriction\
    \ base=\"xs:NMTOKEN\">\n        <xs:whiteSpace value=\"collapse\"/>\n        \
    \  <xs:enumeration value=\"Attack\"/>\n          <xs:enumeration value=\"Network\"\
    />\n          <xs:enumeration value=\"Content\"/>\n          <xs:enumeration value=\"\
    DataWithHandlingRequirements\"/>\n          <xs:enumeration value=\"AudienceRestriction\"\
    />\n          <xs:enumeration value=\"Other\"/>\n          <xs:enumeration value=\"\
    ext-value\"/>\n        </xs:restriction>\n       </xs:simpleType>\n      </xs:attribute>\n\
    \      <xs:attribute name=\"ext-type\"\n                    type=\"xs:string\"\
    \ use=\"optional\"/>\n     </xs:complexType>\n   </xs:element>\n <!--Used to include\
    \ an enveloped XML document in RID-->\n <xs:element name=\"ReportSchema\" type=\"\
    iodef-rid:ReportSchemaType\"/>\n   <xs:complexType name=\"ReportSchemaType\">\n\
    \     <xs:sequence>\n       <xs:element ref=\"iodef-rid:XMLDocument\" minOccurs=\"\
    1\"\n                   maxOccurs=\"1\"/>\n       <xs:element ref=\"iodef-rid:URL\"\
    \ minOccurs=\"0\"\n                   maxOccurs=\"1\"/>\n       <xs:element ref=\"\
    iodef-rid:Signature\" minOccurs=\"0\"\n                   maxOccurs=\"unbounded\"\
    />\n     </xs:sequence>\n      <xs:attribute name=\"Version\" use=\"optional\"\
    >\n       <xs:simpleType>\n        <xs:restriction base=\"xs:NMTOKEN\">\n    \
    \    <xs:whiteSpace value=\"collapse\"/>\n          <xs:enumeration value=\"1.0\"\
    />\n               <xs:enumeration value=\"ext-value\"/>\n        </xs:restriction>\n\
    \       </xs:simpleType>\n      </xs:attribute>\n      <xs:attribute name=\"ext-Version\"\
    \n                    type=\"xs:string\" use=\"optional\"/>\n      <xs:attribute\
    \ name=\"XMLSchemaID\" use=\"optional\">\n       <xs:simpleType>\n        <xs:restriction\
    \ base=\"xs:anyURI\">\n        <xs:whiteSpace value=\"collapse\"/>\n         \
    \ <xs:enumeration value=\"urn:ietf:params:xml:ns:iodef-1.0\"/>\n             \
    \  <xs:enumeration value=\"ext-value\"/>\n        </xs:restriction>\n       </xs:simpleType>\n\
    \      </xs:attribute>\n      <xs:attribute name=\"ext-XMLSchemaID\"\n       \
    \             type=\"xs:string\" use=\"optional\"/>\n     </xs:complexType>\n\
    \   <xs:element name=\"XMLDocument\"\n               type=\"iodef:ExtensionType\"\
    />\n   <xs:element name=\"URL\"\n               type=\"xs:anyURI\"/>\n   <xs:element\
    \ name=\"Signature\"\n               type=\"iodef:ExtensionType\"/>\n </xs:schema>\n"
- title: 9.  Security Requirements
  contents:
  - '9.  Security Requirements

    '
- title: 9.1.  XML Digital Signatures and Encryption
  contents:
  - "9.1.  XML Digital Signatures and Encryption\n   RID leverages existing security\
    \ standards and data markings in\n   RIDPolicy to achieve the required levels\
    \ of security for the exchange\n   of incident information.  The use of standards\
    \ includes TLS and the\n   XML security features of encryption [XMLencrypt] and\
    \ digital\n   signatures [RFC3275] [XMLsig].  The standards provide clear methods\n\
    \   to ensure that messages are secure, authenticated, and authorized;\n   meet\
    \ policy and privacy guidelines; and maintain integrity.  XML\n   Signature Best\
    \ Practices [XMLSigBP] should be referenced by\n   implementers for information\
    \ on improving security to mitigate\n   attacks.\n   As specified in the relevant\
    \ sections of this document, the XML\n   digital signature [RFC3275] and XML encryption\
    \ [XMLencrypt] are used\n   in the following cases:\n   XML Digital Signature\n\
    \   o  The originator of a Request MUST use a detached signature to sign\n   \
    \   at least one of the original elements contained in the RecordItem\n      class\
    \ to provide authentication to all upstream participants in\n      the trace or\
    \ those involved in the investigation.  All instances\n      of RecordItem provided\
    \ by the originator may be individually\n      signed, and additional RecordItem\
    \ entries by upstream peers in the\n      trace or investigation may be signed\
    \ by the peer adding the data,\n      while maintaining the original RecordItem\
    \ entry(s) and detached\n      signature(s) from the original requestor.  It is\
    \ important to note\n      that the data is signed at the RecordItem level.  Since\
    \ multiple\n      RecordItems may exist within an IODEF document and may originate\n\
    \      from different sources, the signature is applied at the RecordItem\n  \
    \    level to enable the use of an XML detached signature.  Exclusive\n      canonicalization\
    \ [XMLCanon] is REQUIRED for the detached signature\n      and not the references,\
    \ as the XML document generated is then\n      included in the RID message within\
    \ the Signature element of the\n      ReportSchema class.  This signature MUST\
    \ be passed to all\n      recipients of the Request message.\n   o  If a Request\
    \ does not include a RecordItem entry, a timestamp MUST\n      be used to ensure\
    \ there is data to be signed for the multi-hop\n      authentication use case.\
    \  The DateTime element of the iodef:\n      RecordData class ([RFC5070], Section\
    \ 3.19.1) is used for this\n      purpose.\n   o  For all message types, the full\
    \ IODEF-RID document MUST be signed\n      using an enveloped signature by the\
    \ sending peer to provide\n      authentication and integrity to the receiving\
    \ RID system.  The\n      signature is placed in an instance of the Signature\
    \ element.\n   o  XML Signature Best Practices [XMLSigBP] guidance SHOULD be\n\
    \      followed to prevent or mitigate security risks.  Examples include\n   \
    \   the recommendation to authenticate a signature prior to processing\n     \
    \ (executing potentially dangerous operations) and the\n      recommendation to\
    \ limit the use of URIs since they may enable\n      cross-site scripting attacks\
    \ or access to local information.\n   o  XML Path Language (XPath) 2.0 [XMLPath]\
    \ MUST be followed to\n      specify the portion of the XML document to be signed.\
    \  XPath is\n      used to specify a location within an XML document.  Best practice\n\
    \      recommendations for using XPath [XMLSigBP] SHOULD be referenced to\n  \
    \    reduce the risk of denial-of-service attacks.  The use of XSLT\n      transforms\
    \ MUST be restricted according to security guidance in\n      [XMLSigBP].\n  \
    \ XML Encryption\n   o  The IODEF-RID document MAY be encrypted to provide an\
    \ extra layer\n      of security between peers so that not only the message is\n\
    \      encrypted for transport.  This behavior would be agreed upon\n      between\
    \ peers or a consortium, or determined on a per-message\n      basis, depending\
    \ on security requirements.  It should be noted\n      that there are cases for\
    \ transport where the RIDPolicy class needs\n      to be presented in clear text,\
    \ as detailed in the transport\n      document [RFC6546].\n   o  A Request, or\
    \ any other message type that may be relayed through\n      RID systems before\
    \ reaching the intended destination as a result\n      of trust relationships,\
    \ MAY be encrypted specifically for the\n      intended recipient.  This may be\
    \ necessary if the RID network is\n      being used for message transfer, the\
    \ intermediate parties do not\n      need to have knowledge of the request contents,\
    \ and a direct\n      communication path does not exist.  In that case, the RIDPolicy\n\
    \      class is used by intermediate parties and as such, RIDPolicy is\n     \
    \ maintained in clear text.\n   o  The action taken in the Result message may\
    \ be encrypted using the\n      key of the request originator.  In that case,\
    \ the intermediate\n      parties can view the RIDPolicy information and know\
    \ the trace has\n      been completed and do not need to see the action.  If the\
    \ use of\n      encryption were limited to sections of the message, the History\n\
    \      class information would be encrypted.  Otherwise, it is\n      RECOMMENDED\
    \ to encrypt the entire IODEF-RID document and use an\n      enveloped signature\
    \ for the originator of the request.  The\n      existence of the Result message\
    \ for an incident would tell any\n      intermediate parties used in the path\
    \ of the incident\n      investigation that the incident handling has been completed.\n\
    \   o  The iodef:restriction attribute sets expectations for the privacy\n   \
    \   of an incident and is defined in Section 3.2 of RFC 5070.\n      Following\
    \ the guidance for XML encryption in the Security\n      Requirements section,\
    \ the iodef:restriction attribute can be set\n      in any of the RID classes\
    \ to define restrictions and encryption\n      requirements for the exchange of\
    \ incident information.  The\n      restriction options enable encryption capabilities\
    \ for the\n      complete exchange of an IODEF document (including any extensions),\n\
    \      within specific classes of IODEF, or IODEF extensions, where more\n   \
    \   limited restrictions are desired.  The restriction attribute is\n      contained\
    \ in each of the RID classes and MUST be used in\n      accordance with confidentiality\
    \ expectations for either sections\n      of the IODEF document or the complete\
    \ IODEF document.  Consortiums\n      and organizations should consider this guidance\
    \ when creating\n      exchange policies.\n   o  Expectations based on how restriction\
    \ is set:\n      *  If restriction is set to 'private', the class or document\
    \ MUST\n         be encrypted for the recipient using XML encryption and the\n\
    \         public key of the recipient.  See Section 9.3 for a discussion\n   \
    \      on public key infrastructure (PKI) and other security\n         requirements.\n\
    \      *  If restriction is set to 'need-to-know', the class or document\n   \
    \      MUST be encrypted to ensure only those with need-to-know access\n     \
    \    can decrypt the data.  The document can either be encrypted for\n       \
    \  each individual for which access is intended or be encrypted\n         with\
    \ a single group key.  The method used SHOULD adhere to any\n         certificate\
    \ policy and practices agreements between entities\n         for the use of RID.\
    \  A group key in this instance refers to a\n         single key (symmetric) that\
    \ is used to encrypt the block of\n         data.  The users with need-to-know\
    \ access privileges may be\n         given access to the shared key via a secure\
    \ distribution\n         method, for example, providing access to the symmetric\
    \ key\n         encrypted with each of the user's public keys.\n      *  If restriction\
    \ is set to 'public', the class or document MUST\n         be sent in clear text.\
    \  This setting can be critical if certain\n         sections of a document or\
    \ an entire document are to be shared\n         without restrictions.  This provides\
    \ flexibility within an\n         incident to share certain information freely\
    \ where appropriate.\n      *  If restriction is set to 'default', the information\
    \ can be\n         shared according to an information disclosure policy pre-\n\
    \         arranged by the communicating parties.\n   o  Expectations based on\
    \ placement of the restriction setting:\n      *  If restriction is set within\
    \ one of the RID classes, the\n         restriction applies to the entire IODEF\
    \ document.\n      *  If restriction is set within individual IODEF classes, the\n\
    \         restriction applies to the specific IODEF class and the\n         children\
    \ of that class.\n   The formation of policies is a very important aspect of using\
    \ a\n   messaging system like RID to exchange potentially sensitive\n   information.\
    \  Many considerations should be involved for peering\n   parties, and some guidelines\
    \ to protect the data, systems, and\n   transport are covered in this section.\
    \  Policies established should\n   provide guidelines for communication methods,\
    \ security, and fall-back\n   procedures.  See Sections 9.4 and 9.5 for additional\
    \ information on\n   consortiums and PKI considerations.\n   The security considerations\
    \ for the storage and exchange of\n   information in RID messaging may include\
    \ adherence to local,\n   regional, or national regulations in addition to the\
    \ obligations to\n   protect client information during an investigation.  RIDPolicy\
    \ is a\n   necessary tool for listing the requirements of messages to provide\
    \ a\n   method to categorize data elements for proper handling.  Controls are\n\
    \   also provided for the sending entity to protect messages from third\n   parties\
    \ through XML encryption.\n   RID provides a method to exchange incident-handling\
    \ requests and\n   Report messages between entities.  Administrators have the\
    \ ability to\n   base decisions on the available resources and other factors of\
    \ their\n   network and maintain control of incident investigations within their\n\
    \   own network.  Thus, RID provides the ability for participating\n   networks\
    \ to manage their own security controls, leveraging the\n   information listed\
    \ in RIDPolicy.\n   RID is used to transfer or exchange XML documents in an IODEF\
    \ format\n   or using another IANA-registered format.  Implementations SHOULD\
    \ NOT\n   download schemas at runtime due to the security implications, and\n\
    \   included documents MUST NOT be required to provide a resolvable\n   location\
    \ of their schema.\n"
- title: 9.2.  Message Transport
  contents:
  - "9.2.  Message Transport\n   A transport specification is defined in a separate\
    \ document\n   [RFC6546].  The specified transport protocols MUST use encryption\
    \ to\n   provide an additional level of security and integrity, while\n   supporting\
    \ mutual authentication through bidirectional certificate\n   usage.  Any subsequent\
    \ transport method defined should take advantage\n   of existing standards for\
    \ ease of implementation and integration of\n   RID systems.  Session encryption\
    \ for the transport of RID messages is\n   enforced in the transport specification.\
    \  The privacy and security\n   considerations are addressed fully in RID to protect\
    \ sensitive\n   portions of documents and to provide a method to authenticate\
    \ the\n   messages.  Therefore, RID messages do not rely on the security\n   provided\
    \ by the transport layer alone.  The encryption requirements\n   and considerations\
    \ for RID messages are discussed in Section 9.1 of\n   this document.\n   Consortiums\
    \ may vary their selected transport mechanisms and thus\n   decide upon a mutual\
    \ protocol to use for transport when communicating\n   with peers in a neighboring\
    \ consortium using RID.  RID systems MUST\n   implement and deploy HTTPS as defined\
    \ in the transport document\n   [RFC6546] and optionally MAY support other protocols\
    \ such as the\n   Blocks Extensible Exchange Protocol (BEEP) [RFC3080].  Bindings\
    \ would\n   need to be defined to enable support for other transport protocols.\n\
    \   Systems used to send authenticated RID messages between networks MUST\n  \
    \ use a secured system and interface to connect to a border network's\n   RID\
    \ systems.  Each connection to a RID system MUST meet the security\n   requirements\
    \ agreed upon through the consortium regulations, peering,\n   or SLAs.  The RID\
    \ system MUST listen for and send RID messages on\n   only the designated port,\
    \ which also MUST be over an encrypted tunnel\n   meeting the minimum requirement\
    \ of algorithms and key lengths\n   established by the consortium, peering, or\
    \ SLA.  The selected\n   cryptographic algorithms for symmetric encryption, digital\n\
    \   signatures, and hash functions MUST meet minimum security levels of\n   the\
    \ times.  The encryption strength MUST adhere to import and export\n   regulations\
    \ of the involved countries for data exchange.\n   Out-of-band communications\
    \ dedicated to SP interaction for RID\n   messaging would provide additional security\
    \ as well as guaranteed\n   bandwidth during a denial-of-service attack.  For\
    \ example, an out-of-\n   band channel may consist of logical paths defined over\
    \ the existing\n   network.  Out-of-band communications may not be practical or\
    \ possible\n   between service providers, but provisions should be considered\
    \ to\n   protect the incident management systems used for RID messaging.\n   Methods\
    \ to protect the data transport may also be provided through\n   session encryption.\n"
- title: 9.3.  Public Key Infrastructure
  contents:
  - "9.3.  Public Key Infrastructure\n   It is RECOMMENDED that RID, the XML security\
    \ functions, and transport\n   protocols properly integrate with a PKI managed\
    \ by the consortium,\n   federate PKIs within a consortium, or use a PKI managed\
    \ by a trusted\n   third party.  Entities MAY use shared keys as an alternate\
    \ solution,\n   although this may limit the ability to validate certificates and\n\
    \   could introduce risk.  For the Internet, a few examples of existing\n   efforts\
    \ that could be leveraged to provide the supporting PKI include\n   the Regional\
    \ Internet Registry's (RIR's) PKI hierarchy, vendor issued\n   certificates, or\
    \ approved issuers of Extended Validation (EV)\n   Certificates.  Security and\
    \ privacy considerations related to\n   consortiums are discussed in Sections\
    \ 9.4 and 9.5.\n   The use of PKI between entities or by a consortium SHOULD adhere\
    \ to\n   any applicable certificate policy and practices agreements for the\n\
    \   use of RID.  [RFC3647] specifies a commonly used format for\n   certificate\
    \ policy (CP) and certification practices statements (CPS).\n   Systems with predefined\
    \ relationships for RID include those who peer\n   directly or through a consortium\
    \ with agreed-upon appropriate use\n   agreements.  The agreements to trust other\
    \ entities may be based on\n   assurance levels that could be determined by a\
    \ comparison of the CP,\n   CPS, and/or RID operating procedures.  The initial\
    \ comparison of\n   policies and the ability to audit controls provide a baseline\n\
    \   assurance level for entities to form and maintain trust\n   relationships.\
    \  Trust relationships may also be defined through a\n   bridged or hierarchical\
    \ PKI in which both peers belong.  If shared\n   keys or keys issued from a common\
    \ CA are used, the verification of\n   controls to determine the assurance level\
    \ to trust other entities may\n   be limited to the RID policies and operating\
    \ procedures.\n   XML security functions utilized in RID require a trust center\
    \ such as\n   a PKI for the distribution of credentials to provide the necessary\n\
    \   level of security for this protocol.  Layered transport protocols\n   also\
    \ utilize encryption and rely on a trust center.  Public key\n   certificate pairs\
    \ issued by a trusted Certification Authority (CA)\n   MAY be used to provide\
    \ the necessary level of authentication and\n   encryption for the RID protocol.\
    \  The CA used for RID messaging must\n   be trusted by all involved parties and\
    \ may take advantage of similar\n   efforts, such as the Internet2 federated PKI\
    \ or the ARIN/RIR effort\n   to provide a PKI to service providers.  The PKI used\
    \ for\n   authentication also provides the necessary certificates needed for\n\
    \   encryption used for the RID transport protocol [RFC6546].\n"
- title: 9.3.1.  Authentication
  contents:
  - "9.3.1.  Authentication\n   Hosts receiving a RID message MUST be able to verify\
    \ that the sender\n   of the request is valid and trusted.  Using digital signatures\
    \ on a\n   hash of the RID message with an X.509 version 3 certificate issued\
    \ by\n   a trusted party MUST be used to authenticate the request.  The X.509\n\
    \   version 3 specifications as well as the digital signature\n   specifications\
    \ and path validation standards set forth in [RFC5280]\n   MUST be followed in\
    \ order to interoperate with a PKI designed for\n   similar purposes.  Full path\
    \ validation verifies the chaining\n   relationship to a trusted root and also\
    \ performs a certificate\n   revocation check.  The use of digital signatures\
    \ in RID XML messages\n   MUST follow the World Wide Web Consortium (W3C) recommendations\
    \ for\n   signature syntax and processing when either the XML encryption\n   [XMLencrypt]\
    \ or digital signature [XMLsig] [RFC3275] is used within a\n   document.\n   It\
    \ might be helpful to define an extension to the authentication\n   scheme that\
    \ uses attribute certificates [RFC5755] in such a way that\n   an application\
    \ could automatically determine whether human\n   intervention is needed to authorize\
    \ a request; however, the\n   specification of such an extension is out of scope\
    \ for this document.\n   The use of pre-shared keys may be considered for authentication\
    \ at\n   the transport layer.  If this option is selected, the specifications\n\
    \   set forth in \"Pre-Shared Key Ciphersuites for Transport Layer\n   Security\
    \ (TLS)\" [RFC4279] MUST be followed.  Transport specifications\n   are detailed\
    \ in a separate document [RFC6546].\n"
- title: 9.3.2.  Multi-Hop Request Authentication
  contents:
  - "9.3.2.  Multi-Hop Request Authentication\n   The use of multi-hop authentication\
    \ in a Request is used when a\n   Request is sent to multiple entities or SPs\
    \ in an iterative manner.\n   Multi-hop authentication is REQUIRED in Requests\
    \ that involve\n   multiple SPs where Requests are forwarded iteratively through\
    \ peers.\n   Bilateral trust relationships MAY be used between peers; multi-hop\n\
    \   authentication MUST be used for cases where the originator of a\n   message\
    \ is authenticated several hops into the message flow.\n   For practical reasons,\
    \ SPs may want to prioritize incident-handling\n   events based upon the immediate\
    \ peer for a Request, the originator of\n   a request, and the listed Confidence\
    \ rating for the incident.  In\n   order to provide a higher assurance level of\
    \ the authenticity of a\n   Request, the originating RID system is included in\
    \ the Request along\n   with contact information and the information of all RID\
    \ systems in\n   the path the trace has taken.  This information is provided through\n\
    \   the IODEF EventData class, which nests the list of systems and\n   contacts\
    \ involved in a trace, while setting the category attribute to\n   \"infrastructure\"\
    .\n   To provide multi-hop authentication, the originating RID system MUST\n \
    \  include a digital signature in the Request sent to all systems in the\n   upstream\
    \ path.  The digital signature from the RID system is\n   performed on the RecordItem\
    \ class of the IODEF following the XML\n   digital signature specifications from\
    \ W3C [XMLsig] using a detached\n   signature.  The signature MUST be passed to\
    \ all parties that receive\n   a Request, and each party MUST be able to perform\
    \ full path\n   validation on the digital signature [RFC5280].  In order to\n\
    \   accommodate that requirement, the RecordItem data MUST remain\n   unchanged\
    \ as a request is passed along between providers and is the\n   only element for\
    \ which the signature is applied.  If additional\n   RecordItems are included\
    \ in the document at upstream peers, the\n   initial RecordItem entry MUST still\
    \ remain with the detached\n   signature.  The subsequent RecordItem elements\
    \ may be signed by the\n   peer adding the incident information for the investigation.\
    \  A second\n   benefit to this requirement is that the integrity of the filter\
    \ used\n   is ensured as it is passed to subsequent SPs in the upstream trace\
    \ of\n   the incident.  The trusted PKI also provides the keys used to\n   digitally\
    \ sign the RecordItem class for a Request to meet the\n   requirement of authenticating\
    \ the original request.  Any host in the\n   path of the trace should be able\
    \ to verify the digital signature\n   using the trusted PKI.\n   In the case in\
    \ which an enterprise using RID sends a Request to its\n   provider, the signature\
    \ from the enterprise MUST be included in the\n   initial request.  The SP may\
    \ generate a new request to send upstream\n   to members of the SP consortium\
    \ to continue the investigation.  If\n   the original request is sent, the originating\
    \ SP, acting on behalf of\n   the enterprise network under attack, MUST also digitally\
    \ sign, with\n   an enveloped signature, the full IODEF document to assure the\n\
    \   authenticity of the Request.  An SP that offers RID as a service may\n   be\
    \ using its own PKI to secure RID communications between its RID\n   system and\
    \ the attached enterprise networks.  SPs participating in\n   the trace MUST be\
    \ able to determine the authenticity of RID requests.\n"
- title: 9.4.  Consortiums and Public Key Infrastructures
  contents:
  - "9.4.  Consortiums and Public Key Infrastructures\n   Consortiums are an ideal\
    \ way to establish a communication web of\n   trust for RID messaging.  It should\
    \ be noted that direct\n   relationships may be ideal for some communications,\
    \ such as those\n   between a provider of incident information and a subscriber\
    \ of the\n   incident reports.  The consortium could provide centralized\n   resources,\
    \ such as a PKI, and established guidelines and control\n   requirements for use\
    \ of RID.  The consortium may assist in\n   establishing trust relationships between\
    \ the participating SPs to\n   achieve the necessary level of cooperation and\
    \ experience-sharing\n   among the consortium entities.  This may be established\
    \ through PKI\n   certificate policy [RFC3647] reviews to determine the appropriate\n\
    \   trust levels between organizations or entities.  The consortium may\n   also\
    \ be used for other purposes to better facilitate communication\n   among SPs\
    \ in a common area (Internet, region, government, education,\n   private networks,\
    \ etc.).\n   Using a PKI to distribute certificates used by RID systems provides\n\
    \   an already established method to link trust relationships between\n   consortiums\
    \ that peer with SPs belonging to a separate consortium.\n   In other words, consortiums\
    \ could peer with other consortiums to\n   enable communication of RID messages\
    \ between the participating SPs.\n   The PKI along with Memorandums of Agreement\
    \ could be used to link\n   border directories to share public key information\
    \ in a bridge, a\n   hierarchy, or a single cross-certification relationship.\n\
    \   Consortiums also need to establish guidelines for each participating\n   SP\
    \ to adhere to.  The RECOMMENDED guidelines include:\n   o  Physical and logical\
    \ practices to protect RID systems;\n   o  Network- and application-layer protection\
    \ for RID systems and\n      communications;\n   o  Proper use guidelines for\
    \ RID systems, messages, and requests; and\n   o  A PKI, certificate policy, and\
    \ certification practices statement\n      to provide authentication, integrity,\
    \ and privacy.\n   The functions described for a consortium's role parallel those\
    \ of a\n   PKI federation.  The PKI federations that currently exist are\n   responsible\
    \ for establishing security guidelines and PKI trust\n   models.  The trust models\
    \ are used to support applications to share\n   information using trusted methods\
    \ and protocols.\n   A PKI can also provide the same level of security for communication\n\
    \   between an end entity (enterprise, educational, or government\n   customer\
    \ network) and the SP.\n"
- title: 9.5.  Privacy Concerns and System Use Guidelines
  contents:
  - "9.5.  Privacy Concerns and System Use Guidelines\n   Privacy issues raise many\
    \ concerns when information-sharing is\n   required to achieve the goal of stopping\
    \ or mitigating the effects of\n   a security incident.  The RIDPolicy class is\
    \ used to automate the\n   enforcement of the privacy concerns listed within this\
    \ document.  The\n   privacy and system use concerns for the system communicating\
    \ RID\n   messages and other integrated components include the following:\n  \
    \ Service Provider Concerns:\n   o  Privacy of data monitored and/or stored on\
    \ Intrusion Detection\n      Systems (IDSs) for attack detection.\n   o  Privacy\
    \ of data monitored and stored on systems used to trace\n      traffic across\
    \ a single network.\n   o  Privacy of incident information stored on incident\
    \ management\n      systems participating in RID communications.\n   Customer\
    \ Attached Networks Participating in RID with SP:\n   o  Customer networks may\
    \ include enterprise, educational, government,\n      or other networks attached\
    \ to an SP participating in RID.\n      Customers should review data handling\
    \ policies to understand how\n      data will be protected by a service provider.\
    \  This information\n      will enable customers to decide what types of data\
    \ at what\n      sensitivity level can be shared with service providers.  This\n\
    \      information could be used at the application layer to establish\n     \
    \ sharing profiles for entities and groups; see Section 9.6.\n   o  Customers\
    \ should request information on the security and privacy\n      considerations\
    \ in place by their SP and the consortium of which\n      the SP is a member.\
    \  Customers should understand if their data\n      were to be forwarded, how\
    \ it might be sanitized and how it will be\n      protected.  In advance of sharing\
    \ data with their SP, customers\n      should also understand if limitations can\
    \ be placed on how it will\n      be used.\n   o  Customers should be aware that\
    \ their data can and will be sent to\n      other SPs in order to complete a trace\
    \ unless an agreement stating\n      otherwise is made in the service level agreements\
    \ between the\n      customer and SP.  Customers considering privacy options may\
    \ limit\n      the use of this feature if they do not want the data forwarded.\n\
    \   Parties Involved in the Attack:\n   o  Privacy of the identity of a host involved\
    \ in an attack or any\n      indicators of compromise.\n   o  Privacy of information\
    \ such as the source and destination used for\n      communication purposes over\
    \ the monitored or RID-connected\n      network(s).\n   o  Protection of data\
    \ from being viewed by intermediate parties in\n      the path of an Request request\
    \ should be considered.\n   Consortium Considerations:\n   o  System use restrictions\
    \ for security incident handling within the\n      local region's definitions\
    \ of appropriate traffic.  When\n      participating in a consortium, appropriate\
    \ use guidelines should\n      be agreed upon and entered into contracts.\n  \
    \ o  System use prohibiting the consortium's participating SPs from\n      inappropriately\
    \ tracing traffic to locate sources or mitigate\n      traffic unlawfully within\
    \ the jurisdiction or region.\n   Inter-Consortium Considerations:\n   o  System\
    \ use between peering consortiums should consider any\n      government communication\
    \ regulations that apply between those two\n      regions, such as encryption\
    \ export and import restrictions.\n   o  System use between consortiums SHOULD\
    \ NOT request traffic traces\n      and actions beyond the scope intended and\
    \ permitted by law or\n      inter-consortium agreements.\n   o  System use between\
    \ consortiums should consider national boundary\n      issues and request limits\
    \ in their appropriate system use\n      agreements.  Appropriate use should include\
    \ restrictions to\n      prevent the use of the protocol for limiting or restricting\n\
    \      traffic that is otherwise permitted within the country in which\n     \
    \ the peering consortium resides.\n   The security and privacy considerations\
    \ listed above are for the\n   consortiums, SPs, and enterprises to agree upon.\
    \  The agreed-upon\n   policies may be facilitated through use of the RIDPolicy\
    \ class and\n   application-layer options.  Some privacy considerations are addressed\n\
    \   through the RID guidelines for encryption and digital signatures as\n   described\
    \ in Section 9.1.\n   RID is useful in determining the true source of an incident\
    \ that\n   traverses multiple networks or to communicate security incidents and\n\
    \   automate the response.  The information obtained from the\n   investigation\
    \ may determine the identity of the source host or the SP\n   used by the source\
    \ of the traffic.  It should be noted that the trace\n   mechanism used across\
    \ a single SP may also raise privacy concerns for\n   the clients of the network.\
    \  Methods that may raise concern include\n   those that involve storing packets\
    \ for some length of time in order\n   to trace packets after the fact.  Monitoring\
    \ networks for intrusions\n   and for tracing capabilities also raises concerns\
    \ for potentially\n   sensitive valid traffic that may be traversing the monitored\
    \ network.\n   IDSs and single-network tracing are outside of the scope of this\n\
    \   document, but the concern should be noted and addressed within the\n   use\
    \ guidelines of the network.  Some IDSs and single-network trace\n   mechanisms\
    \ attempt to properly address these issues.  RID is designed\n   to provide the\
    \ information needed by any single-network trace\n   mechanism.  The provider's\
    \ choice of a single trace mechanism depends\n   on resources, existing solutions,\
    \ and local legislation.  Privacy\n   concerns in regard to the single-network\
    \ trace must be dealt with at\n   the client-to-SP level and are out of scope\
    \ for RID messaging.\n   The identity of the true source of an attack being traced\
    \ through RID\n   could be sensitive.  The true identity listed in a Result message\
    \ can\n   be protected through the use of encryption [XMLencrypt] enveloping\n\
    \   the IODEF document and RID Result information, using the public\n   encryption\
    \ key of the originating SP.  Alternatively, the action\n   taken may be listed\
    \ without the identity being revealed to the\n   originating SP.  The ultimate\
    \ goal of the RID communication system is\n   to stop or mitigate attack traffic,\
    \ not to ensure that the identity\n   of the attack traffic is known to involved\
    \ parties.  The SP that\n   identifies the source should deal directly with the\
    \ involved parties\n   and proper authorities in order to determine the guidelines\
    \ for the\n   release of such information, if it is regarded as sensitive.  In\
    \ some\n   situations, systems used in attacks are compromised by an unknown\n\
    \   source and, in turn, are used to attack other systems.  In that\n   situation,\
    \ the reputation of a business or organization may be at\n   stake, and the action\
    \ taken may be the only additional information\n   reported in the Result message\
    \ to the originating system.  If the\n   security incident is a minor incident,\
    \ such as a zombie system used\n   in part of a large-scale DDoS attack, ensuring\
    \ the system is taken\n   off the network until it has been fixed may be sufficient.\
    \  The\n   decision is left to the system users and consortiums to determine\n\
    \   appropriate data to be shared given that the goal of the\n   specification\
    \ is to provide the appropriate technical options to\n   remain compliant.  The\
    \ textual descriptions should include details of\n   the incident in order to\
    \ protect the reputation of the unknowing\n   attacker and prevent the need for\
    \ additional investigation.  Local,\n   state, or national laws may dictate the\
    \ appropriate reporting action\n   for specific security incidents.\n   Privacy\
    \ becomes an issue whenever sensitive data traverses a network.\n   For example,\
    \ if an attack occurred between a specific source and\n   destination, then every\
    \ SP in the path of the trace becomes aware\n   that the cyber attack occurred.\
    \  In a targeted attack, it may not be\n   desirable that information about two\
    \ nation states that are battling\n   a cyber war would become general knowledge\
    \ to all intermediate\n   parties.  However, it is important to allow the traces\
    \ to take place\n   in order to halt the activity since the health of the networks\
    \ in the\n   path could also be at stake during the attack.  This provides a\n\
    \   second argument for allowing the Result message to only include an\n   action\
    \ taken and not the identity of the offending host.  In the case\n   of a Request\
    \ or Report, where the originating SP is aware of the SP\n   that will receive\
    \ the request for processing, the free-form text\n   areas of the document could\
    \ be encrypted [XMLencrypt] using the\n   public key of the destination SP to\
    \ ensure that no other SP in the\n   path can read the contents.  The encryption\
    \ is accomplished through\n   the W3C [XMLencrypt] specification for encrypting\
    \ an element.\n   In some situations, all network traffic of a nation may be granted\n\
    \   through a single SP.  In that situation, options must support sending\n  \
    \ Result messages from a downstream peer of that SP.  That option\n   provides\
    \ an additional level of abstraction to hide the identity and\n   the SP of the\
    \ identified source of the traffic.  Legal action may\n   override this technical\
    \ decision after the trace has taken place, but\n   that is out of the technical\
    \ scope of this document.\n   Privacy concerns when using an Request message to\
    \ request action\n   close to the source of valid attack traffic need to be considered.\n\
    \   Although the intermediate SPs may relay the request if there is no\n   direct\
    \ trust relationship to the closest SP to the source, the\n   intermediate SPs\
    \ do not require the ability to see the contents of\n   the packet or the text\
    \ description field(s) in the request.  This\n   message type does not require\
    \ any action by the intermediate RID\n   systems, except to relay the packet to\
    \ the next SP in the path.\n   Therefore, the contents of the request may be encrypted\
    \ for the\n   destination system.  The intermediate SPs only need to know how\
    \ to\n   direct the request to the manager of the ASN in which the source IP\n\
    \   address belongs.\n   Traces must be legitimate security-related incidents\
    \ and not used for\n   purposes such as sabotage or censorship.  An example of\
    \ such abuse of\n   the system includes a request to block or rate-limit legitimate\n\
    \   traffic to prevent information from being shared between users on the\n  \
    \ Internet (restricting access to online versions of papers) or\n   restricting\
    \ access from a competitor's product in order to sabotage a\n   business.\n  \
    \ Intra-consortium RID communications raise additional issues,\n   especially\
    \ when the peering consortiums reside in different regions\n   or nations.  Request\
    \ messages and requested actions to mitigate or\n   stop traffic must adhere to\
    \ the appropriate use guidelines and yet\n   prevent abuse of the system.  First,\
    \ the peering consortiums must\n   identify the types of traffic that can be traced\
    \ between the borders\n   of the participating SPs of each consortium.  The traffic\
    \ traced\n   should be limited to security-incident-related traffic.  Second,\
    \ the\n   traces permitted within one consortium, if passed to a peering\n   consortium,\
    \ may infringe upon the peering consortium's freedom-of-\n   information laws.\
    \  An example would be a consortium in one country\n   permitting a trace of traffic\
    \ containing objectionable material,\n   outlawed within that country.  The RID\
    \ trace may be a valid use of\n   the system within the confines of that country's\
    \ network border;\n   however, it may not be permitted to continue across network\n\
    \   boundaries where such content is permitted under law.  By continuing\n   the\
    \ trace in another country's network, the trace and response could\n   have the\
    \ effect of improperly restricting access to data.  A\n   continued trace into\
    \ a second country may break the laws and\n   regulations of that nation.  Any\
    \ such traces MUST cease at the\n   country's border.\n   The privacy concerns\
    \ listed in this section address issues among the\n   trusted parties involved\
    \ in a trace within an SP, a RID consortium,\n   and peering RID consortiums.\
    \  Data used for RID communications must\n   also be protected from parties that\
    \ are not trusted.  This protection\n   is provided through the authentication\
    \ and encryption of documents as\n   they traverse the path of trusted servers\
    \ and through the local\n   security controls in place for the incident management\
    \ systems.  Each\n   RID system MUST perform a bidirectional authentication when\
    \ sending a\n   RID message and use the public encryption key of the upstream\
    \ or\n   downstream peer to send a message or document over the network.  This\n\
    \   means that the document is decrypted and re-encrypted at each RID\n   system\
    \ via TLS over a transport protocol such as [RFC6546].  The RID\n   messages may\
    \ be decrypted at each RID system in order to properly\n   process the request\
    \ or relay the information.  Today's processing\n   power is more than sufficient\
    \ to handle the minimal burden of\n   encrypting and decrypting relatively small\
    \ typical RID messages.\n"
- title: 9.6.  Sharing Profiles and Policies
  contents:
  - "9.6.  Sharing Profiles and Policies\n   The application layer can be used to\
    \ establish workflows and rulesets\n   specific to sharing profiles for entities\
    \ or consortiums.  The\n   profiles can leverage sharing agreements to restrict\
    \ data types or\n   classifications of data that are shared.  The level of information\
    \ or\n   classification of data shared with any entity may be based on\n   protection\
    \ levels offered by the receiving entity and periodic\n   validation of those\
    \ controls.  The profile may also indicate how far\n   information can be shared\
    \ according to the entity and data type.  The\n   profile may also indicate whether\
    \ requests to share data from an\n   entity must go directly to that entity.\n\
    \   In some cases, pre-defined sharing profiles will be possible.  These\n   include\
    \ any use case where an agreement is in place in advance of\n   sharing.  Examples\
    \ may be between clients and SPs, entities such as\n   partners, or consortiums.\
    \  There may be other cases when sharing\n   profiles may not be established in\
    \ advance, such as an organization\n   dealing with an incident who requires assistance\
    \ from an entity that\n   it has not worked with before.  An organization may\
    \ want to establish\n   sharing profiles specific to possible user groups to prepare\
    \ for\n   possible incident scenarios.  The user groups could include business\n\
    \   partners, industry peers, service providers, experts not part of a\n   service\
    \ provider, law enforcement, or regulatory reporting bodies.\n   Workflows to\
    \ approve transactions may be specific to sharing profiles\n   and data types.\
    \  Application developers should include capabilities\n   to enable these decision\
    \ points for users of the system.\n   Any expectations between entities to preserve\
    \ the weight and\n   admissibility of evidence should be handled at the policy\
    \ and\n   agreement level.  A sharing profile may include notes or an indicator\n\
    \   for approvers in workflows to reflect if such agreements exist.\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   RID has many security requirements and considerations\
    \ built into the\n   design of the protocol, several of which are described in\
    \ the\n   Security Requirements section.  For a complete view of security,\n \
    \  considerations include the availability, confidentiality, and\n   integrity\
    \ concerns for the transport, storage, and exchange of\n   information.\n   Protected\
    \ tunnels between systems accepting RID communications are\n   used to provide\
    \ confidentiality, integrity, authenticity, and privacy\n   for the data at the\
    \ transport layer.  Encryption and digital\n   signatures are also used at the\
    \ IODEF document level through RID\n   options to provide confidentiality, integrity,\
    \ authenticity, privacy\n   and traceability of the document contents at the application\
    \ layer.\n   Trust relationships are based on PKI and the comparison/validation\
    \ of\n   security controls for the incident management systems communicating\n\
    \   via RID.  Trust levels can be established in cross-certification\n   processes\
    \ where entities compare PKI policies that include the\n   specific management\
    \ and handling of an entity's PKI and certificates\n   issued under that policy.\
    \  [RFC3647] defines an Internet X.509 Public\n   Key Infrastructure Certificate\
    \ Policy and Certification Practices\n   Framework that may be used in the comparison\
    \ of policies to establish\n   trust levels and agreements between entities, an\
    \ entity and a\n   consortium, and consortiums.  The agreements SHOULD consider\
    \ key\n   management practices including the ability to perform path validation\n\
    \   on certificates [RFC5280], key distribution techniques [RFC2585], and\n  \
    \ Certificate Authority and Registration Authority management\n   practices.\n\
    \   The agreements between entities SHOULD also include a common\n   understanding\
    \ of the usage of RID security, policy, and privacy\n   options discussed in both\
    \ the Security Requirements and Security\n   Considerations sections.  The formality,\
    \ requirements, and complexity\n   of the agreements for the certificate policy,\
    \ practices, supporting\n   infrastructure, and the use of RID options SHOULD\
    \ be decided by the\n   entities or consortiums creating those agreements.\n"
- title: 11.  Internationalization Issues
  contents:
  - "11.  Internationalization Issues\n   The Node class identifies a host or network\
    \ device.  This document\n   reuses the definition of Node from the IODEF specification\
    \ [RFC5070],\n   Section 3.16.  However, that document did not clearly specify\
    \ whether\n   a NodeName could be an Internationalized Domain Name (IDN).  RID\n\
    \   systems MUST treat the NodeName class as a domain name slot\n   [RFC5890].\
    \  RID systems SHOULD support IDNs in the NodeName class.\n   If they do so, the\
    \ UTF-8 representation of the domain name MUST be\n   used, i.e., all of the domain\
    \ name's labels MUST be U-labels\n   expressed in UTF-8 or NR-LDH labels [RFC5890];\
    \ A-labels MUST NOT be\n   used.  An application communicating via RID can convert\
    \ between\n   A-labels and U-labels by using the Punycode encoding [RFC3492] for\n\
    \   A-labels as described in the protocol specification for\n   Internationalized\
    \ Domain Names in Applications [RFC5891].\n"
- title: 12.  IANA Considerations
  contents:
  - "12.  IANA Considerations\n   This document uses URNs to describe XML namespaces\
    \ and XML schemas\n   [XMLschema] conforming to a registry mechanism described\
    \ in\n   [RFC3688].\n   Registration request for the iodef-rid namespace:\n  \
    \    URI: urn:ietf:params:xml:ns:iodef-rid-2.0\n      Registrant Contact: IESG.\n\
    \      XML: None.  Namespace URIs do not represent an XML specification.\n   Registration\
    \ request for the iodef-rid XML schema:\n      URI: urn:ietf:params:xml:schema:iodef-rid-2.0\n\
    \      Registrant Contact: IESG.\n      XML: See Section 8, \"RID Schema Definition\"\
    , of this document.\n   The following registry has been created and is now managed\
    \ by IANA:\n      Name of the registry: \"XML Schemas Exchanged via RID\"\n  \
    \    Namespace details: A registry entry for an XML Schema Transferred\n     \
    \ via RID consists of:\n         Schema Name: A short string that represents the\
    \ schema\n         referenced.  This value is for reference only in the table.\n\
    \         The version of the schema MUST be included in this string to\n     \
    \    allow for multiple versions of the same specification to be in\n        \
    \ the registry.\n         Version: The version of the registered XML schema. \
    \ The version\n         is a string that SHOULD be formatted as numbers separated\
    \ by a\n         '.' (period) character.\n         Namespace: The namespace of\
    \ the referenced XML schema.  This is\n         represented in the RID ReportSchema\
    \ class in the XMLSchemaID\n         attribute as an enumerated value is represented\
    \ by a URN or\n         URI.\n         Specification URI: A URI [RFC3986] from\
    \ which the registered\n         specification can be obtained.  The specification\
    \ MUST be\n         publicly available from this URI.\n         Reference: The\
    \ reference to the document that describes the\n         schema.\n      Information\
    \ that must be provided to assign a new value: The above\n      list of information.\n\
    \      Fields to record in the registry: Schema Name, Version, Namespace,\n  \
    \    Specification URI, Reference\n      Initial registry contents: See Section\
    \ 5.6.1.\n      Allocation Policy: Expert Review [RFC5226] and Specification\n\
    \      Required [RFC5226].\n   The Designated Expert is expected to consult with\
    \ the MILE (Managed\n   Incident Lightweight Exchange) working group or its successor\
    \ if any\n   such WG exists (e.g., via email to the working group's mailing list).\n\
    \   The Designated Expert is expected to retrieve the XML schema\n   specification\
    \ from the provided URI in order to check the public\n   availability of the specification\
    \ and verify the correctness of the\n   URI.  An important responsibility of the\
    \ Designated Expert is to\n   ensure that the XML schema is appropriate for use\
    \ in RID.\n   The following registry has been created and is now managed by IANA:\n\
    \      Name of the registry: \"RID Enumeration List\"\n      The registry is intended\
    \ to enable enumeration value additions to\n      attributes in the iodef-rid\
    \ XML schema.\n      Fields to record in the registry: Attribute Name, Attribute\
    \ Value,\n      Description, Reference\n      Initial registry content: none.\n\
    \      Allocation Policy: Expert Review [RFC5226]\n   The Designated Expert is\
    \ expected to consult with the MILE (Managed\n   Incident Lightweight Exchange)\
    \ working group or its successor if any\n   such WG exists (e.g., via email to\
    \ the working group's mailing list).\n   The Designated Expert is expected to\
    \ review the request and validate\n   the appropriateness of the enumeration for\
    \ the attribute.  If a\n   specification is associated with the request, it MUST\
    \ be reviewed by\n   the Designated Expert.\n"
- title: 13.  Summary
  contents:
  - "13.  Summary\n   Security incidents have always been difficult to trace as a\
    \ result of\n   spoofed sources, resource limitations, and bandwidth utilization\n\
    \   problems.  Incident response is often slow even when the IP address\n   is\
    \ known to be valid because of the resources required to notify the\n   responsible\
    \ party of the attack and then to stop or mitigate the\n   attack traffic.  Methods\
    \ to identify and trace attacks near real time\n   are essential to thwarting\
    \ attack attempts.  SPs need policies and\n   automated methods to combat the\
    \ hacker's efforts.  SPs need automated\n   monitoring and response capabilities\
    \ to identify and trace attacks\n   quickly without resource-intensive side effects.\
    \  Integration with a\n   centralized communication system to coordinate the detection,\n\
    \   tracing, and identification of attack sources on a single network is\n   essential.\
    \  RID provides a way to integrate SP resources for each\n   aspect of attack\
    \ detection, tracing, and source identification and\n   extends the communication\
    \ capabilities among SPs.  The communication\n   is accomplished through the use\
    \ of flexible IODEF XML-based documents\n   passed between incident-handling systems\
    \ or RID systems.  A Request\n   is communicated to an upstream SP and may result\
    \ in an upstream trace\n   or in an action to stop or mitigate the attack traffic.\
    \  The messages\n   are communicated among peers with security inherent to the\
    \ RID\n   messaging scheme provided through existing standards such as XML\n \
    \  encryption and digital signatures.  Policy information is carried in\n   the\
    \ RID message itself through the use of the RIDPolicy.  RID\n   provides the timely\
    \ communication among SPs, which is essential for\n   incident handling.\n"
- title: 14.  References
  contents:
  - '14.  References

    '
- title: 14.1.  Normative References
  contents:
  - "14.1.  Normative References\n   [RFC2119]     Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                 Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC2585]     Housley, R. and P. Hoffman, \"Internet X.509 Public\
    \ Key\n                 Infrastructure Operational Protocols: FTP and HTTP\",\n\
    \                 RFC 2585, May 1999.\n   [RFC3023]     Murata, M., St. Laurent,\
    \ S., and D. Kohn, \"XML Media\n                 Types\", RFC 3023, January 2001.\n\
    \   [RFC3275]     Eastlake, D., Reagle, J., and D. Solo, \"(Extensible\n     \
    \            Markup Language) XML-Signature Syntax and Processing\",\n       \
    \          RFC 3275, March 2002.\n   [RFC3470]     Hollenbeck, S., Rose, M., and\
    \ L. Masinter, \"Guidelines\n                 for the Use of Extensible Markup\
    \ Language (XML)\n                 within IETF Protocols\", BCP 70, RFC 3470,\
    \ January 2003.\n   [RFC3492]     Costello, A., \"Punycode: A Bootstring encoding\
    \ of\n                 Unicode for Internationalized Domain Names in\n       \
    \          Applications (IDNA)\", RFC 3492, March 2003.\n   [RFC3688]     Mealling,\
    \ M., \"The IETF XML Registry\", BCP 81,\n                 RFC 3688, January 2004.\n\
    \   [RFC4051]     Eastlake, D., \"Additional XML Security Uniform Resource\n \
    \                Identifiers (URIs)\", RFC 4051, April 2005.\n   [RFC4279]   \
    \  Eronen, P. and H. Tschofenig, \"Pre-Shared Key\n                 Ciphersuites\
    \ for Transport Layer Security (TLS)\",\n                 RFC 4279, December 2005.\n\
    \   [RFC5070]     Danyliw, R., Meijer, J., and Y. Demchenko, \"The\n         \
    \        Incident Object Description Exchange Format\", RFC 5070,\n          \
    \       December 2007.\n   [RFC5226]     Narten, T. and H. Alvestrand, \"Guidelines\
    \ for Writing\n                 an IANA Considerations Section in RFCs\", BCP\
    \ 26,\n                 RFC 5226, May 2008.\n   [RFC5280]     Cooper, D., Santesson,\
    \ S., Farrell, S., Boeyen, S.,\n                 Housley, R., and W. Polk, \"\
    Internet X.509 Public Key\n                 Infrastructure Certificate and Certificate\
    \ Revocation\n                 List (CRL) Profile\", RFC 5280, May 2008.\n   [RFC5646]\
    \     Phillips, A. and M. Davis, \"Tags for Identifying\n                 Languages\"\
    , BCP 47, RFC 5646, September 2009.\n   [RFC5755]     Farrell, S., Housley, R.,\
    \ and S. Turner, \"An Internet\n                 Attribute Certificate Profile\
    \ for Authorization\",\n                 RFC 5755, January 2010.\n   [RFC5890]\
    \     Klensin, J., \"Internationalized Domain Names for\n                 Applications\
    \ (IDNA): Definitions and Document\n                 Framework\", RFC 5890, August\
    \ 2010.\n   [RFC5891]     Klensin, J., \"Internationalized Domain Names in\n \
    \                Applications (IDNA): Protocol\", RFC 5891, August 2010.\n   [RFC6546]\
    \     Trammell, B., \"Transport of Real-time Inter-network\n                 Defense\
    \ (RID) Messages over HTTP/TLS\", RFC 6546,\n                 April 2012.\n  \
    \ [XML1.0]      Bray, T., Maler, E., Paoli, J., Sperberg-McQueen, C.,\n      \
    \           and F. Yergeau, \"Extensible Markup Language (XML) 1.0\",\n      \
    \           W3C Recommendation XML 1.0, November 2008,\n                 <http://www.w3.org/TR/xml/>.\n\
    \   [XMLCanon]    Boyer, J., \"Canonical XML 1.0\", W3C Recommendation 1.0,\n\
    \                 December 2001, <http://www.w3.org/TR/xml-c14n>.\n   [XMLPath]\
    \     Berglund, A., Boag, S., Chamberlin, D., Fernandez, M.,\n               \
    \  Kay, M., Robie, J., and J. Simeon, \"XML Schema Part 1:\n                 Structures\"\
    , W3C Recommendation Second Edition,\n                 December 2010, <http://www.w3.org/TR/xpath20/>.\n\
    \   [XMLSigBP]    Hirsch, F. and P. Datta, \"XML-Signature Best\n            \
    \     Practices\", W3C Recommendation, August 2011,\n                 <http://www.w3.org/TR/xmldsig-bestpractices/>.\n\
    \   [XMLencrypt]  Imaura, T., Dillaway, B., and E. Simon, \"XML Encryption\n \
    \                Syntax and Processing\", W3C Recommendation,\n              \
    \   December 2002, <http://www.w3.org/TR/xmlenc-core/>.\n   [XMLschema]   Thompson,\
    \ H., Beech, D., Maloney, M., and N.\n                 Mendelsohn, \"XML Schema\
    \ Part 1: Structures\", W3C\n                 Recommendation Second Edition, October\
    \ 2004,\n                 <http://www.w3.org/TR/xmlschema-1/>.\n   [XMLsig]  \
    \    Bartel, M., Boyer, J., Fox, B., LaMaccia, B., and E.\n                 Simon,\
    \ \"XML-Signature Syntax and Processing\", W3C\n                 Recommendation\
    \ Second Edition, June 2008,\n                 <http://www.w3.org/TR/xmldsig-core/>.\n"
- title: 14.2.  Informative References
  contents:
  - "14.2.  Informative References\n   [RFC1930]     Hawkinson, J. and T. Bates, \"\
    Guidelines for creation,\n                 selection, and registration of an Autonomous\
    \ System\n                 (AS)\", BCP 6, RFC 1930, March 1996.\n   [RFC3080]\
    \     Rose, M., \"The Blocks Extensible Exchange Protocol\n                 Core\"\
    , RFC 3080, March 2001.\n   [RFC3647]     Chokhani, S., Ford, W., Sabett, R.,\
    \ Merrill, C., and S.\n                 Wu, \"Internet X.509 Public Key Infrastructure\n\
    \                 Certificate Policy and Certification Practices\n           \
    \      Framework\", RFC 3647, November 2003.\n   [RFC3986]     Berners-Lee, T.,\
    \ Fielding, R., and L. Masinter,\n                 \"Uniform Resource Identifier\
    \ (URI): Generic Syntax\",\n                 STD 66, RFC 3986, January 2005.\n\
    \   [RFC5735]     Cotton, M. and L. Vegoda, \"Special Use IPv4 Addresses\",\n\
    \                 BCP 153, RFC 5735, January 2010.\n   [RFC6045]     Moriarty,\
    \ K., \"Real-time Inter-network Defense (RID)\",\n                 RFC 6045, November\
    \ 2010.\n   [RFC6194]     Polk, T., Chen, L., Turner, S., and P. Hoffman,\n  \
    \               \"Security Considerations for the SHA-0 and SHA-1\n          \
    \       Message-Digest Algorithms\", RFC 6194, March 2011.\n   [XMLNames]    Bray,\
    \ T., Hollander, D., Layman, A., Tobin, R., and H.\n                 Thomson,\
    \ \"Namespaces in XML 1.0 (Third Edition)\", W3C\n                 Recommendation\
    \ , December 2009,\n                 <http://www.w3.org/TR/xml-names/>.\n"
- title: Appendix A.  Acknowledgements
  contents:
  - "Appendix A.  Acknowledgements\n   Many thanks to colleagues and the Internet\
    \ community for reviewing\n   and commenting on the document as well as providing\
    \ recommendations\n   to improve, simplify, and secure the protocol: Steve Bellovin,\
    \ David\n   Black, Harold Booth, Paul Cichonski, Robert K. Cunningham, Roman\n\
    \   Danyliw, Yuri Demchenko, Sandra G. Dykes, Stephen Farrell, Katherine\n   Goodier,\
    \ Cynthia D. McLain, Thomas Millar, Jean-Francois Morfin,\n   Stephen Northcutt,\
    \ Damir Rajnovic, Tony Rutkowski, Peter Saint-Andre,\n   Jeffrey Schiller, Robert\
    \ Sparks, William Streilein, Richard Struse,\n   Tony Tauber, Brian Trammell,\
    \ Sean Turner, Iljitsch van Beijnum, and\n   David Waltermire.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Kathleen M. Moriarty\n   EMC Corporation\n   176 South Street\n\
    \   Hopkinton, MA\n   United States\n   EMail: Kathleen.Moriarty@emc.com\n"
