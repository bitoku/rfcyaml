- title: __initial_text__
  contents:
  - '                Localized Routing for Proxy Mobile IPv6

    '
- title: Abstract
  contents:
  - "Abstract\n   Proxy Mobile IPv6 (PMIPv6) is a network based mobility management\n\
    \   protocol that enables IP mobility for a host without requiring its\n   participation\
    \ in any mobility-related signaling.  PMIPv6 requires all\n   communications to\
    \ go through the local mobility anchor.  As this can\n   be suboptimal, Localized\
    \ Routing (LR) allows Mobile Nodes (MNs)\n   attached to the same or different\
    \ Mobile Access Gateways (MAGs) to\n   route traffic by using localized forwarding\
    \ or a direct tunnel\n   between the gateways.  This document proposes initiation,\n\
    \   utilization, and termination mechanisms for localized routing between\n  \
    \ mobile access gateways within a proxy mobile IPv6 domain.  It defines\n   two\
    \ new signaling messages, Localized Routing Initiation (LRI) and\n   Local Routing\
    \ Acknowledgment (LRA), that are used to realize this\n   mechanism.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by\n   the Internet Engineering\
    \ Steering Group (IESG).  Further\n   information on Internet Standards is available\
    \ in Section 2 of\n   RFC 5741.\n   Information about the current status of this\
    \ document, any\n   errata, and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6705.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Conventions Used in This Document ...............................3\n  \
    \ 3. Initiation of Localized Routing .................................3\n    \
    \  3.1. MAG Behavior ...............................................4\n      3.2.\
    \ LMA Behavior ...............................................4\n   4. Teardown\
    \ of Localized Routing ...................................4\n   5. Scenario A11:\
    \ Two MNs Attached to the Same MAG and LMA ..........4\n      5.1. Handover Considerations\
    \ ....................................6\n   6. Scenario A21: Two MNs Attached\
    \ to Different MAGs but the\n      Same LMA ........................................................7\n\
    \      6.1. Handover Considerations ....................................9\n  \
    \    6.2. Tunneling between the MAGs .................................9\n   7.\
    \ Scenario A12: Two MNs Attached to the Same MAG with\n      Different LMAs .................................................10\n\
    \      7.1. Handover Considerations ...................................12\n  \
    \ 8. Scenario A22: Two MNs Attached to Different MAGs with\n      Different LMAs\
    \ .................................................13\n   9. IPv4 Support in Localized\
    \ Routing ..............................13\n   10. Message Formats ...............................................13\n\
    \      10.1. Localized Routing Initiation (LRI) .......................14\n  \
    \    10.2. Localized Routing Acknowledgment (LRA) ...................15\n   11.\
    \ New Mobility Option ...........................................16\n      11.1.\
    \ MAG IPv6 Address .........................................16\n   12. Configuration\
    \ Variables .......................................17\n   13. Security Considerations\
    \ .......................................17\n   14. IANA Considerations ...........................................17\n\
    \   15. Contributors ..................................................18\n  \
    \ 16. Acknowledgments ...............................................18\n   17.\
    \ References ....................................................19\n      17.1.\
    \ Normative References .....................................19\n      17.2. Informative\
    \ References ...................................19\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Proxy Mobile IPv6 [RFC5213] describes the protocol operations\
    \ to\n   maintain reachability and session persistence for a Mobile Node (MN)\n\
    \   without the explicit participation from the MN in signaling\n   operations\
    \ at the Internet Protocol (IP) layer.  In order to\n   facilitate such network-based\
    \ mobility, the PMIPv6 protocol defines a\n   Mobile Access Gateway (MAG), which\
    \ acts as a proxy for the Mobile\n   IPv6 [RFC6275] signaling, and the Local Mobility\
    \ Anchor (LMA), which\n   acts similar to a Home Agent.  The LMA and the MAG establish\
    \ a\n   bidirectional tunnel for forwarding all data traffic belonging to the\n\
    \   Mobile Nodes.  In the case where both endpoints are located in the\n   same\
    \ PMIPv6 domain, this can be suboptimal and result in increased\n   delay and\
    \ congestion in the network.  Moreover, it increases\n   transport costs and traffic\
    \ load at the LMA.\n   To overcome these issues, localized routing can be used\
    \ to allow\n   nodes attached to the same or different MAGs to directly exchange\n\
    \   traffic by using localized forwarding or a direct tunnel between the\n   gateways.\
    \  [RFC6279] defines the problem statement for PMIPv6\n   localized routing. \
    \ This document describes a solution for PMIPv6\n   localized routing between\
    \ two MNs in the same PMIPv6 domain.  The\n   protocol specified here assumes\
    \ that each MN is attached to a MAG and\n   that each MN's MAG has established\
    \ a binding for the attached MN at\n   its selected LMA according to [RFC5213].\
    \  The protocol builds on the\n   scenarios defined in [RFC6279].\n"
- title: 2.  Conventions Used in This Document
  contents:
  - "2.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n   This document also uses the terminology defined in Section\
    \ 2 of\n   [RFC6279].\n"
- title: 3.  Initiation of Localized Routing
  contents:
  - "3.  Initiation of Localized Routing\n   Since the traffic to be localized passes\
    \ through both the LMA and the\n   MAGs, it is possible, at least in some scenarios,\
    \ for either of them\n   to initiate Localized Routing (LR).  In order to eliminate\
    \ ambiguity,\n   the protocol described in this document selects the initiator\
    \ of LR\n   based on the rules below.\n"
- title: 3.1.  MAG Behavior
  contents:
  - "3.1.  MAG Behavior\n   The MAG MUST initiate LR if both of the communicating\
    \ MNs are\n   attached to it and the MNs are anchored at different LMAs.  The\
    \ MAG\n   MUST NOT initiate LR in any other case.\n"
- title: 3.2.  LMA Behavior
  contents:
  - "3.2.  LMA Behavior\n   The LMA MUST initiate LR if both of the communicating\
    \ MNs are\n   anchored to it.  The LMA MUST NOT initiate LR in any other case.\n"
- title: 4.  Teardown of Localized Routing
  contents:
  - "4.  Teardown of Localized Routing\n   The use of localized routing is not persistent.\
    \  Localized routing\n   has a defined lifetime as specified by the initiator;\
    \ upon expiry,\n   the forwarding MUST revert to using bidirectional tunneling.\
    \  When\n   localized routing ceases, the corresponding Localized Routing Entries\n\
    \   (LREs) MUST be removed.\n   If the initiator of LR wishes to terminate localized\
    \ routing before\n   the expiry of the lifetime specified in the LRI message,\
    \ it MUST do\n   so by sending a new LRI message with the lifetime set to zero.\n"
- title: '5.  Scenario A11: Two MNs Attached to the Same MAG and LMA'
  contents:
  - "5.  Scenario A11: Two MNs Attached to the Same MAG and LMA\n   In this scenario,\
    \ the two Mobile Nodes involved in communication are\n   attached to a single\
    \ MAG and both are anchored at the same LMA as\n   shown in Figure 1.\n      \
    \                           Internet\n                                    :\n\
    \                                    |\n                                    |\n\
    \                                 +-----+\n                                 |\
    \ LMA |\n                                 +-----+\n                          \
    \          |\n                                    |\n                        \
    \            |\n                                 +-----+\n                   \
    \              | MAG |\n                                 +-----+\n           \
    \                       :   :\n                               +---+ +---+\n  \
    \                             |MN1| |MN2|\n                               +---+\
    \ +---+\n                                 Figure 1\n   The LMA initiates a localized\
    \ routing session by detecting traffic\n   between two MNs attached to the same\
    \ MAG.  The exact traffic\n   identification mechanism is not specified in this\
    \ document and is\n   left open for implementations and specific deployments.\
    \  An example\n   trigger could be that an application-layer signaling entity\
    \ detects\n   the possibility of localized routing and notifies the LMA about\
    \ the\n   two endpoints, and the LMA determines that the two endpoints are\n \
    \  attached to the same MAG.  Such a trigger mechanism offers localized\n   routing\
    \ at the granularity of an individual application session,\n   providing flexibility\
    \ in usage.  It is also possible that one of the\n   mobility entities (LMA or\
    \ MAG) could decide to initiate localized\n   routing based on configured policy.\
    \  Please note that a MAG\n   implementing the protocol specified in this document\
    \ will not\n   dynamically initiate LR in the same LMA case (i.e., by sending\
    \ an\n   LRI), but can statically initiate LR based on the\n   EnableMAGLocalRouting\
    \ configuration variable specified in [RFC5213].\n      +----+      +----+   \
    \   +----+          +----+\n      |MN1 |      |MN2 |      |MAG1|          |LMA\
    \ |\n      +----+      +----+      +----+          +----+\n        |         \
    \  |           |               |\n        |         data          |     data \
    \     |\n        |<--------------------->|<------------->|\n        |        \
    \   |           |               |\n        |           |    data   |     data\
    \      |\n        |           |<--------->|<------------->|\n        |       \
    \    |           |          LR decision\n        |           |           |  LRI(Opt1)\
    \    |\n        |           |           |<--------------|\n        |         \
    \  |           |               |\n        |           |           |  LRA(Opt2)\
    \    |\n        |           |           |-------------->|\n        |         \
    \  |           |               |\n        |        data           |          \
    \     |\n        |<--------------------->|               |\n        |        \
    \   |           |               |\n        |           |   data    |         \
    \      |\n        |           |<--------->|               |\n        |       \
    \    |           |               |\n        |           |           |        \
    \       |\n      Opt1: MN1-ID,MN1-HNP,MN2-ID,MN2-HNP\n      Opt2: U=0,MN1-ID,MN1-HNP,MN2-ID,MN2-HNP\n\
    \      where U is the flag defined in Section 10.2.\n                        \
    \         Figure 2\n   After detecting a possibility for localized routing, the\
    \ LMA SHOULD\n   construct an LRI message that is used to signal the intent to\n\
    \   initiate localized routing and to convey parameters for the same.\n   This\
    \ is a Mobility Header message and it MUST contain the MN-\n   Identifier (MN-ID)\
    \ and the Home Network Prefix (HNP) (as Mobility\n   Header options) for each\
    \ of the MNs involved.  The LMA MUST then send\n   the LRI message to the MAG\
    \ (MAG1) where the two MNs are attached.\n   The initiation of the LR procedure\
    \ is shown in Figure 2.\n   The MAG (MAG1) MUST verify the attachment status of\
    \ the two MNs\n   locally by checking the binding cache.  The MAG MUST then verify\
    \ if\n   the EnableMAGLocalRouting flag is set to 1.  If it is not, the MAG\n\
    \   has not been configured to allow localized routing, and it MUST\n   reject\
    \ the LRI and MUST send an LRA with Status code \"Localized\n   Routing Not Allowed\"\
    .  Please note that this does not update behavior\n   specified in [RFC5213] but\
    \ merely implements the LMA enforcement\n   specified in Section 6.10.3 of [RFC5213].\
    \  If the MAG is configured\n   to allow localized routing, it MUST then create\
    \ LREs for each\n   direction of the communication between the two MNs.  The exact\
    \ form\n   of the forwarding entries is left for the implementations to decide;\n\
    \   however, they SHOULD contain the HNP corresponding to the destination\n  \
    \ IP address and a next-hop identifier (e.g., the layer-2 address of\n   the next\
    \ hop).  These LREs MUST override the Binding Update List\n   (BUL) entries for\
    \ the specific HNPs identified in the LRI message.\n   Hence, all traffic matching\
    \ the HNPs is forwarded locally.\n   If the MAG is unable to deliver packets using\
    \ the LREs, it is\n   possible that one of the MNs is no longer attached to the\
    \ MAG.\n   Hence, the MAG MUST fall back to using the BUL entry, and the LMA\n\
    \   MUST forward the received packets using its Binding Cache Entry\n   (BCE).\n\
    \   After processing the LRI message, the MAG MUST respond with a Local\n   Routing\
    \ Acknowledgment (LRA) message.  This Mobility Header message\n   MUST also include\
    \ the MN-ID and the HNP for each of the communicating\n   MNs, as well as an appropriate\
    \ Status code indicating the outcome of\n   LRI processing.  Status code 0 indicates\
    \ localized routing was\n   successfully offered by the MAG.  Any other value\
    \ for Status code\n   indicates the reason for the failure to offer localized\
    \ routing\n   service.  When Status code is 0, the LMA sets a flag in the BCE\n\
    \   corresponding to the HNPs to record that localized routing is in\n   progress\
    \ for that HNP.\n"
- title: 5.1.  Handover Considerations
  contents:
  - "5.1.  Handover Considerations\n   If one of the MNs, say MN1, detaches from the\
    \ MAG and attaches to\n   another MAG (say nMAG), the localized routing state\
    \ needs to be\n   re-established. When the LMA receives the PBU from nMAG for\
    \ MN1, it\n   will see that localized routing is active for MN1.  The LMA MUST\n\
    \   hence initiate LR at nMAG and update the LR state of pMAG.  After the\n  \
    \ handover completes, LR will resemble Scenario A21.  The pMAG MUST\n   follow\
    \ the forwarding rules described in Section 6.10.5 of [RFC5213]\n   and decide\
    \ that it will no longer perform LR for MN1.\n"
- title: '6.  Scenario A21: Two MNs Attached to Different MAGs but the Same LMA'
  contents:
  - "6.  Scenario A21: Two MNs Attached to Different MAGs but the Same LMA\n   The\
    \ LMA may choose to support local forwarding to Mobile Nodes\n   attached to two\
    \ different MAGs within a single PMIPv6 domain.\n                            \
    \     Internet\n                                    :\n                      \
    \              |\n                                    |\n                    \
    \             +-----+\n                                 | LMA |\n            \
    \                     +-----+\n                                    |\n       \
    \                             |\n                               +----+-----+\n\
    \                               |          |\n                            +----+\
    \     +----+\n                            |MAG1|     |MAG2|\n                \
    \            +----+     +----+\n                              :           :\n\
    \                            +---+       +---+\n                            |MN1|\
    \       |MN2|\n                            +---+       +---+\n               \
    \                  Figure 3\n   As earlier, the LMA initiates LR as a response\
    \ to some trigger\n   mechanism.  In this case, however, it MUST send two separate\
    \ LRI\n   messages to the two MAGs.  In addition to the MN-ID and the HNP\n  \
    \ options, each LRI message MUST contain the IP address of the\n   counterpart\
    \ MAG.  When the MAG IP address option is present, each MAG\n   MUST create a\
    \ local forwarding entry such that the packets for the MN\n   attached to the\
    \ remote MAG are sent over a tunnel associated with\n   that remote MAG.  The\
    \ tunnel between the MAGs is assumed to be\n   established following the considerations\
    \ mentioned in Section 6.2.\n      +----+      +----+      +----+      +----+\
    \        +----+\n      |MN1 |      |MN2 |      |MAG1|      |MAG2|        |LMA\
    \ |\n      +----+      +----+      +----+      +----+        +----+\n        |\
    \           |           |           |             |\n        |        data   \
    \        |          data           |\n        |<--------------------->|<----------------------->|\n\
    \        |           |           |           |             |\n        |      \
    \     |         data          |    data     |\n        |           |<--------------------->|<----------->|\n\
    \        |           |           |           |             |\n        |      \
    \     |           |           |             |\n        |           |         \
    \  |       LRI(Opt1)         |\n        |           |           |<------------------------|\n\
    \        |           |           |           |             |\n        |      \
    \     |           |           |  LRI(Opt2)  |\n        |           |         \
    \  |           |<------------|\n        |           |           |           |\
    \             |\n        |           |           |        LRA(Opt3)        |\n\
    \        |           |           |------------------------>|\n        |      \
    \     |           |           |             |\n        |           |         \
    \  |           |   LRA(Opt4) |\n        |           |           |           |------------>|\n\
    \        |           |           |           |             |\n        |      \
    \     |           |           |             |\n        |           |         \
    \  |           |             |\n        |        data           |    data   |\
    \             |\n        |<--------------------->|<--------->|             |\n\
    \        |           |           |           |             |\n        |      \
    \     |         data          |             |\n        |           |<--------------------->|\
    \             |\n        |           |           |           |             |\n\
    \        |           |           |           |             |\n      Opt1: MN1-ID,MN1-HNP,MAG2-IPv6-Address\n\
    \      Opt2: MN2-ID,MN2-HNP,MAG1-IPv6-Address\n      Opt3: U=0,MN1-ID,MN1-HNP,MAG2-IPv6-Address\n\
    \      Opt4: U=0,MN2-ID,MN2-HNP,MAG1-IPv6-Address\n      where U is the flag defined\
    \ in Section 10.2.\n                                 Figure 4\n   In this case,\
    \ each MAG responds to the LRI with an LRA message.  All\n   subsequent packets\
    \ are routed between the MAGs locally, without\n   traversing the LMA.  If one\
    \ of the MAGs (say MAG1) responds with a\n   successful LRA (Status value is zero)\
    \ and the other (say MAG2)\n   responds with an error (Status value is non-zero),\
    \ LR will still be\n   performed in one direction (MN1->MAG1->MAG2->MN2), but\
    \ the packets\n   flowing the other way will take the LMA path\n   (MN2->MAG2->LMA->MAG1->MN1).\n\
    \   The protocol does not require any synchronization between the MAGs\n   before\
    \ local forwarding begins.  Each MAG begins its local forwarding\n   independent\
    \ of the other.\n   No synchronization between the MAGs is required because each\
    \ MAG\n   initiates LR in one direction.  After the LMA instructs MAG1 to\n  \
    \ initiate LR, packets from MN1 to MN2 will take the path\n   MN1->MAG1->MAG2->MN2\
    \ while those from MN2 to MN1 will take the path\n   MN2->MAG2->LMA->MAG1->MN1\
    \ until the LMA instructs MAG2 to initiate LR\n   as well.  A MAG will forward\
    \ a packet towards either another MAG or\n   its own LMA; therefore, there would\
    \ be no duplication of packets.\n"
- title: 6.1.  Handover Considerations
  contents:
  - "6.1.  Handover Considerations\n   If one of the MNs, say MN1, detaches from its\
    \ current MAG (in this\n   case MAG1) and attaches to another MAG (say nMAG1),\
    \ the localized\n   routing state needs to be re-established.  When the LMA receives\
    \ the\n   PBU from nMAG1 for MN1, it will see that localized routing is active\n\
    \   for MN1.  The LMA MUST then initiate LR at nMAG1 and update the LR\n   state\
    \ of MAG2 to use nMAG1 instead of MAG1.\n"
- title: 6.2.  Tunneling between the MAGs
  contents:
  - "6.2.  Tunneling between the MAGs\n   In order to support localized routing, both\
    \ MAGs SHOULD support the\n   following encapsulation modes for the user packets,\
    \ which are also\n   defined for the tunnel between the LMA and MAG:\n   o  IPv4-or-IPv6-over-IPv6\
    \ [RFC5844]\n   o  IPv4-or-IPv6-over-IPv4 [RFC5844]\n   o  IPv4-or-IPv6-over-IPv4-UDP\
    \ [RFC5844]\n   o  TLV-header UDP tunneling [RFC5845]\n   o  Generic Routing Encapsulation\
    \ (GRE) tunneling with or without GRE\n      key(s) [RFC5845]\n   MAG1 and MAG2\
    \ MUST use the same tunneling mechanism for the data\n   traffic tunneled between\
    \ them.  The encapsulation mode to be employed\n   SHOULD be configurable.  It\
    \ is RECOMMENDED that:\n   1.  As the default behavior, the inter-MAG tunnel uses\
    \ the same\n       encapsulation mechanism as that being used for the PMIPv6 tunnel\n\
    \       between the LMA and the MAGs.  MAG1 and MAG2 automatically start\n   \
    \    using the same encapsulation mechanism without a need for a\n       special\
    \ configuration on the MAGs or a dynamic tunneling\n       mechanism negotiation\
    \ between them.\n   2.  Configuration on the MAGs can override the default mechanism\n\
    \       specified in Option 1 above.  MAG1 and MAG2 MUST be configured\n     \
    \  with the same mechanism, and this configuration is most likely to\n       be\
    \ uniform throughout the PMIPv6 domain.  If the packets on the\n       PMIPv6\
    \ tunnel cannot be uniquely mapped onto the configured\n       inter-MAG tunnel,\
    \ this scenario is not applicable, and Option 3\n       below SHOULD directly\
    \ be applied.\n   3.  An implicit or explicit tunnel negotiation mechanism between\
    \ the\n       MAGs can override the default mechanism specified in Option 1\n\
    \       above.  The employed tunnel negotiation mechanism is outside the\n   \
    \    scope of this document.\n"
- title: '7.  Scenario A12: Two MNs Attached to the Same MAG with Different LMAs'
  contents:
  - "7.  Scenario A12: Two MNs Attached to the Same MAG with Different LMAs\n   In\
    \ this scenario, both the MNs are attached to the same MAG, but are\n   anchored\
    \ at two different LMAs.  MN1 is anchored at LMA1, and MN2 is\n   anchored at\
    \ LMA2.  Note that the two LMAs are part of the same\n   Provider Domain.\n  \
    \                               Internet\n                           :       \
    \           :\n                           +------------------+\n             \
    \              |                  |\n                        +----+          \
    \    +----+\n                        |LMA1|              |LMA2|\n            \
    \            +----+              +----+\n                           |        \
    \          |\n                           |                  |\n              \
    \             +------------------+\n                                    |\n  \
    \                                  |\n                                    |\n\
    \                                 +-----+\n                                 |\
    \ MAG |\n                                 +-----+\n                          \
    \        :   :\n                               +---+ +---+\n                 \
    \              |MN1| |MN2|\n                               +---+ +---+\n     \
    \                            Figure 5\n   Hence, neither LMA has a means to determine\
    \ that the two Mobile Nodes\n   are attached to the same MAG.  Only the MAG can\
    \ possibly determine\n   that the two Mobile Nodes involved in communication are\
    \ attached to\n   it.  Therefore, localized routing MUST be initiated by the MAG.\n\
    \   The MAG sends an LRI message containing the MN-ID, HNP, and the\n   counterpart\
    \ LMA address to each LMA.  Each LMA makes a decision to\n   support local forwarding\
    \ independently based on configured policy for\n   the corresponding LMA.  Each\
    \ LMA MUST respond to the LRI message with\n   an LRA message.  If the initiation\
    \ of LR on the LMA was successful,\n   the Status value in the received LRA would\
    \ be set to zero.  After the\n   MAG receives both the LRA messages, each with\
    \ the Status value set to\n   zero (success) from the two different LMAs, the\
    \ MAG will conclude\n   that it can provide local forwarding support for the two\
    \ Mobile\n   Nodes.\n      +----+      +----+      +----+      +----+        +----+\n\
    \      |MN1 |      |MN2 |      |MAG |      |LMA1|        |LMA2|\n      +----+\
    \      +----+      +----+      +----+        +----+\n        |           |   \
    \        |           |             |\n        |        data           |   data\
    \    |    data     |\n        |<--------------------->|<--------->|<----------->|\n\
    \        |           |           |           |             |\n        |      \
    \     |   data    |          data           |\n        |           |<--------->|<----------------------->|\n\
    \        |           |           |           |             |\n        |      \
    \     |           |           |             |\n        |           |         \
    \  | LRI(Opt1) |             |\n        |           |           |---------->|\
    \             |\n        |           |           |           |             |\n\
    \        |           |           |        LRI(Opt2)        |\n        |      \
    \     |           |------------------------>|\n        |           |         \
    \  |           |             |\n        |           |           | LRA(Opt3) |\
    \             |\n        |           |           |<----------|             |\n\
    \        |           |           |           |             |\n        |      \
    \     |           |        LRA(Opt4)        |\n        |           |         \
    \  |<------------------------|\n        |           |           |           |\
    \             |\n        |           |           |           |             |\n\
    \        |           |           |           |             |\n        |      \
    \  data           |           |             |\n        |<--------------------->|\
    \           |             |\n        |           |           |           |   \
    \          |\n        |           |    data   |           |             |\n  \
    \      |           |<--------->|           |             |\n        |        \
    \   |           |           |             |\n        |           |           |\
    \           |             |\n      Opt1: MN1-ID,MN1-HNP\n      Opt2: MN2-ID,MN2-HNP\n\
    \      Opt3: U=0,MN1-ID,MN1-HNP\n      Opt4: U=0,MN2-ID,MN2-HNP\n      where U\
    \ is the flag defined in Section 10.2.\n                                 Figure\
    \ 6\n"
- title: 7.1.  Handover Considerations
  contents:
  - "7.1.  Handover Considerations\n   If one of the MNs, say MN1, detaches from its\
    \ current MAG (in this\n   case MAG1) and attaches to another MAG (say nMAG1),\
    \ the current MAG\n   MUST immediately stop using the LRE and MUST send all packets\n\
    \   originated by the other MN (MN2) towards its LMA (in this case LMA2).\n"
- title: '8.  Scenario A22: Two MNs Attached to Different MAGs with Different LMAs'
  contents:
  - "8.  Scenario A22: Two MNs Attached to Different MAGs with Different LMAs\n  \
    \ This scenario will not be covered in this document since PMIPv6 does\n   not\
    \ define any form of inter-LMA communication.  When a supported\n   scenario,\
    \ such as Scenario A12, morphs into Scenario A22, the node\n   that initiated\
    \ the localized routing session MUST tear it down in\n   order to prevent lasting\
    \ packet loss.  This can result in transient\n   packet loss when routing switches\
    \ between the localized path into the\n   normal path through the LMAs.  In applications\
    \ that are loss\n   sensitive, this can lead to observable service disruptions.\
    \  In\n   deployments where Scenario A22 is possible, the use of localized\n \
    \  routing is NOT RECOMMENDED when packet-loss-sensitive applications\n   are\
    \ in use.\n"
- title: 9.  IPv4 Support in Localized Routing
  contents:
  - "9.  IPv4 Support in Localized Routing\n   PMIPv6 MNs can use an IPv4 Home Address\
    \ (HoA) as described in\n   [RFC5844].  In order to support the setup and maintenance\
    \ of\n   localized routes for these IPv4 HoAs in PMIPv6, the MAGs MUST add the\n\
    \   IPv4 HoAs into their LREs.  The MAGs MUST also support encapsulation\n   of\
    \ IPv4 packets as described in [RFC5844].  The localized routing\n   protocol\
    \ messages MUST include an IPv4 HoA option in their signaling\n   messages in\
    \ order to support IPv4 addresses for localized routing.\n   If the transport\
    \ network between the PMIPv6 entities involved in\n   localized routing is IPv4-only,\
    \ the LRI and LRA messages MUST be\n   encapsulated similar to the PBU/PBA messages\
    \ as specified in\n   [RFC5844].  The encapsulation mode used SHOULD be identical\
    \ to the\n   one used to transport PBU and PBA messages.\n"
- title: 10.  Message Formats
  contents:
  - "10.  Message Formats\n   The localized routing messages use two new Mobility\
    \ Header types (17\n   and 18).  The LRI message requests creation or deletion\
    \ of the\n   localized routing state, and the LRA message acknowledges the\n \
    \  creation or deletion of such localized routing state.\n"
- title: 10.1.  Localized Routing Initiation (LRI)
  contents:
  - "10.1.  Localized Routing Initiation (LRI)\n   The LRI messages use a new Mobility\
    \ Header type (17).  The LMA sends\n   an LRI message to a MAG to request local\
    \ forwarding for a pair of\n   MNs.  The MAG may also send this message to request\
    \ the two LMAs for\n   offering local forwarding as described in Section 7.\n\
    \     0                   1                   2                   3\n     0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n              \
    \                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                   \
    \                 |           Sequence #          |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |         Reserved              |           Lifetime            |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    .\
    \                                                               .\n    .     \
    \                   Mobility options                       .\n    .          \
    \                                                     .\n    |               \
    \                                                |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Sequence Number: A monotonically increasing integer.  Set by a\n      sending\
    \ node in a request message and used to match a reply to the\n      request.\n\
    \      Reserved: This field is unused and MUST be set to zero.\n      Lifetime:\
    \ The requested time, in seconds, for which the sender\n      wishes to have local\
    \ forwarding.  A value of 0xffff (all ones)\n      indicates an infinite lifetime.\
    \  When set to 0, indicates a\n      request to stop localized routing.\n    \
    \  Mobility Options: MUST contain two separate MN-ID options,\n      followed\
    \ by one or more HNPs for each of the MNs.  For instance,\n      for Mobile Nodes\
    \ MN1 and MN2 with identifiers MN1-ID and MN2-ID,\n      and Home Network Prefixes\
    \ MN1-HNP and MN2-HNP, the following tuple\n      MUST be present in the following\
    \ order: [MN1-ID, MN1-HNP],\n      [MN2-ID, MN2-HNP].  The MN-ID and HNP options\
    \ are the same as in\n      [RFC5213].  The LRI MAY contain the remote MAG IPv6\
    \ address\n      option, which is formatted identically to the HNP option, except\n\
    \      that it uses a different Type code and the Prefix Length is always\n  \
    \    equal to 128 bits (see Section 10.1).\n   The LRI message SHOULD be re-transmitted\
    \ if a corresponding LRA\n   message is not received within LRA_WAIT_TIME time\
    \ units, up to a\n   maximum of LRI_RETRIES, each separated by LRA_WAIT_TIME time\
    \ units.\n"
- title: 10.2.  Localized Routing Acknowledgment (LRA)
  contents:
  - "10.2.  Localized Routing Acknowledgment (LRA)\n   The LRA messages use a new\
    \ Mobility Header type (18).  A MAG sends an\n   LRA message to the LMA as a response\
    \ to the LRI message.  An LMA may\n   also send this message to a MAG as a response\
    \ to the LRI message as\n   described in Section 7.\n     0                  \
    \ 1                   2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                    |           Sequence #          |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |U|  Reserved   |   Status      |           Lifetime            |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    .\
    \                                                               .\n    .     \
    \                   Mobility options                       .\n    .          \
    \                                                     .\n    |               \
    \                                                |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Sequence Number: Copied from the sequence number field of the LRI\n   \
    \   message being responded to.\n       'U' flag: When set to 1, the LRA message\
    \ is sent unsolicited.\n       The Lifetime field indicates a new requested value.\
    \  The MAG MUST\n       wait for the regular LRI message to confirm that the request\
    \ is\n       acceptable to the LMA.\n       Reserved: This field is unused and\
    \ MUST be set zero.\n       Status: 8-bit unsigned integer indicating the result\
    \ of\n       processing the Localized Routing Acknowledgment message.  Values\n\
    \       of the Status field less than 128 indicate that the Localized\n      \
    \ Routing Acknowledgment was processed successfully by the mobility\n       entities(LMA\
    \ or MAG).  Values greater than or equal to 128\n       indicate that the Localized\
    \ Routing Acknowledgment was rejected\n       by the mobility entities.  The following\
    \ Status values are\n       currently defined:\n          0: Success\n       \
    \   128: Localized Routing Not Allowed\n          129: MN Not Attached\n     \
    \  Lifetime: The time, in seconds, for which local forwarding is\n       supported.\
    \  It is typically copied from the corresponding field\n       in the LRI message.\n\
    \       Mobility Options: When Status code is 0, MUST contain the\n       [MN-ID,\
    \ HNP] tuples in the same order as in the LRI message.\n       When Status code\
    \ is not 0, MUST contain only those [MN-ID, HNP]\n       tuples for which local\
    \ forwarding is supported.  The MN-ID and\n       HNP options are the same as\
    \ those described in [RFC5213].\n"
- title: 11.  New Mobility Option
  contents:
  - '11.  New Mobility Option

    '
- title: 11.1.  MAG IPv6 Address
  contents:
  - "11.1.  MAG IPv6 Address\n   The MAG IPv6 address mobility option contains the\
    \ IPv6 address of a\n   MAG involved in localized routing.  The MAG IPv6 address\
    \ option has\n   an alignment requirement of 8n+4.\n     0                   1\
    \                   2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |      Type     |   Length      |   Reserved    | Address Length|\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    +\
    \                                                               +\n    |     \
    \                                                          |\n    +          \
    \             MAG IPv6 Address                        +\n    |               \
    \                                                |\n    +                    \
    \                                           +\n    |                         \
    \                                      |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \        Type\n            51\n        Length\n            8-bit unsigned integer\
    \ indicating the length of the option\n            in octets, excluding the type\
    \ and length fields.  This field\n            MUST be set to 18.\n        Reserved\
    \ (R)\n            This 8-bit field is unused.  The value MUST be initialized\n\
    \            to 0 by the sender and MUST be ignored by the receiver.\n       \
    \ Address Length\n            This field MUST be set to 128.\n        MAG IPv6\
    \ Address\n            A 16-byte field containing the MAG's IPv6 address.\n"
- title: 12.  Configuration Variables
  contents:
  - "12.  Configuration Variables\n   The LMA and the MAG must allow the following\
    \ variables to be\n   configurable:\n   LRA_WAIT_TIME:  This variable is used\
    \ to set the time interval, in\n      seconds, between successive retransmissions\
    \ of an LRI message.\n      The default value is 3 seconds.\n   LRI_RETRIES: \
    \ This variable indicates the maximum number of times the\n      initiator retransmits\
    \ an LRI message before stopping.  The default\n      value for this variable\
    \ is 3.\n"
- title: 13.  Security Considerations
  contents:
  - "13.  Security Considerations\n   The protocol inherits the threats to [RFC5213]\
    \ that are identified in\n   [RFC4832].  The protocol specified in this document\
    \ uses the same\n   security association as defined in [RFC5213] for use between\
    \ the LMA\n   and the MAG to protect the LRI and LRA messages.  This document\
    \ also\n   assumes the preexistence of a MAG-MAG security association if LR\n\
    \   needs to be supported between them.  Support for integrity protection\n  \
    \ using IPsec is REQUIRED, but support for confidentiality is OPTIONAL.\n   The\
    \ MAGs MUST perform ingress filtering on the MN-sourced packets\n   before encapsulating\
    \ them into MAG-MAG tunnels in order to prevent\n   address spoofing.\n"
- title: 14.  IANA Considerations
  contents:
  - "14.  IANA Considerations\n   The Localized Routing Initiation (described in Section\
    \  10.1) and the\n   Localized Routing Acknowledgment (described in Section 10.2)\
    \ have\n   each been assigned a Mobility Header type (17 and 18, respectively)\n\
    \   from the \"Mobility Header Types - for the MH Type field in the\n   Mobility\
    \ Header\" registry at\n   http://www.iana.org/assignments/mobility-parameters.\n\
    \   The MAG IPv6 Address has been assigned a Mobility Option type (51)\n   from\
    \ the \"Mobility Options\" registry at\n   http://www.iana.org/assignments/mobility-parameters.\n"
- title: 15.  Contributors
  contents:
  - "15.  Contributors\n   This document merges ideas from five different draft documents\n\
    \   addressing the PMIP localized routing problem.  The authors of these\n   drafts\
    \ are listed below (in alphabetical order).\n   Kuntal Chowdhury <kchowdhury@starentnetworks.com>\n\
    \   Ashutosh Dutta <adutta@niksun.com>\n   Rajeev Koodli <rkoodli@starentnetworks.com>\n\
    \   Suresh Krishnan <suresh.krishnan@ericsson.com>\n   Marco Liebsch <marco.liebsch@nw.neclab.eu>\n\
    \   Paulo Loureiro <loureiro@neclab.eu>\n   Desire Oulai <desire.oulai@videotron.com>\n\
    \   Behcet Sarikaya <sarikaya@ieee.org>\n   Qin Wu <sunseawq@huawei.com>\n   Hidetoshi\
    \ Yokota <yokota@kddilabs.jp>\n"
- title: 16.  Acknowledgments
  contents:
  - "16.  Acknowledgments\n   The authors would like to thank Sri Gundavelli, Julien\
    \ Abeille, Tom\n   Taylor, Kent Leung, Mohana Jeyatharan, Jouni Korhonen, Glen\
    \ Zorn,\n   Ahmad Muhanna, Zoltan Turanyi, Dirk von Hugo, Pete McCann, Xiansong\n\
    \   Cui, Carlos Bernardos, Basavaraj Patil, Jari Arkko, Mary Barnes, Les\n   Ginsberg,\
    \ Russ Housley, Carl Wallace, Ralph Droms, Adrian Farrel, and\n   Stephen Farrell\
    \ for their comments and suggestions.\n"
- title: 17.  References
  contents:
  - '17.  References

    '
- title: 17.1.  Normative References
  contents:
  - "17.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC5213]  Gundavelli, S., Ed., Leung, K., Devarapalli, V.,\n    \
    \          Chowdhury, K., and B. Patil, \"Proxy Mobile IPv6\", RFC\n         \
    \     5213, August 2008.\n   [RFC5844]  Wakikawa, R. and S. Gundavelli, \"IPv4\
    \ Support for Proxy\n              Mobile IPv6\", RFC 5844, May 2010.\n   [RFC5845]\
    \  Muhanna, A., Khalil, M., Gundavelli, S., and K. Leung,\n              \"Generic\
    \ Routing Encapsulation (GRE) Key Option for Proxy\n              Mobile IPv6\"\
    , RFC 5845, June 2010.\n   [RFC6275]  Perkins, C., Ed., Johnson, D., and J. Arkko,\
    \ \"Mobility\n              Support in IPv6\", RFC 6275, July 2011.\n"
- title: 17.2.  Informative References
  contents:
  - "17.2.  Informative References\n   [RFC4832]  Vogt, C. and J. Kempf, \"Security\
    \ Threats to Network-Based\n              Localized Mobility Management (NETLMM)\"\
    , RFC 4832, April\n              2007.\n   [RFC6279]  Liebsch, M., Ed., Jeong,\
    \ S., and Q. Wu, \"Proxy Mobile IPv6\n              (PMIPv6) Localized Routing\
    \ Problem Statement\", RFC 6279,\n              June 2011.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Suresh Krishnan\n   Ericsson\n   8400 Blvd Decarie\n \
    \  Town of Mount Royal, Quebec\n   Canada\n   Phone: +1 514 345 7900 x42871\n\
    \   EMail: suresh.krishnan@ericsson.com\n   Rajeev Koodli\n   Cisco Systems\n\
    \   EMail: rkoodli@cisco.com\n   Paulo Loureiro\n   NEC Laboratories Europe\n\
    \   NEC Europe Ltd.\n   Kurfuersten-Anlage 36\n   69115 Heidelberg\n   Germany\n\
    \   EMail: loureiro@neclab.eu\n   Qin Wu\n   Huawei Technologies Co., Ltd.\n \
    \  101 Software Avenue, Yuhua District\n   Nanjing, Jiangsu  21001\n   China\n\
    \   Phone: +86-25-56623633\n   EMail: sunseawq@huawei.com\n   Ashutosh Dutta\n\
    \   NIKSUN\n   EMail: adutta@niksun.com\n"
