- title: __initial_text__
  contents:
  - "     Interworking between Locator/ID Separation Protocol (LISP) and\n       \
    \                      Non-LISP Sites\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes techniques for allowing sites running the\n\
    \   Locator/ID Separation Protocol (LISP) to interoperate with Internet\n   sites\
    \ that may be using either IPv4, IPv6, or both but that are not\n   running LISP.\
    \  A fundamental property of LISP-speaking sites is that\n   they use Endpoint\
    \ Identifiers (EIDs), rather than traditional IP\n   addresses, in the source\
    \ and destination fields of all traffic they\n   emit or receive.  While EIDs\
    \ are syntactically identical to IPv4 or\n   IPv6 addresses, normally routes to\
    \ them are not carried in the global\n   routing system, so an interoperability\
    \ mechanism is needed for non-\n   LISP-speaking sites to exchange traffic with\
    \ LISP-speaking sites.\n   This document introduces three such mechanisms.  The\
    \ first uses a new\n   network element, the LISP Proxy Ingress Tunnel Router (Proxy-ITR),\
    \ to\n   act as an intermediate LISP Ingress Tunnel Router (ITR) for non-LISP-\n\
    \   speaking hosts.  Second, this document adds Network Address\n   Translation\
    \ (NAT) functionality to LISP ITRs and LISP Egress Tunnel\n   Routers (ETRs) to\
    \ substitute routable IP addresses for non-routable\n   EIDs.  Finally, this document\
    \ introduces the Proxy Egress Tunnel\n   Router (Proxy-ETR) to handle cases where\
    \ a LISP ITR cannot send\n   packets to non-LISP sites without encapsulation.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for examination, experimental implementation, and\n   evaluation.\n\
    \   This document defines an Experimental Protocol for the Internet\n   community.\
    \  This document is a product of the Internet Engineering\n   Task Force (IETF).\
    \  It represents the consensus of the IETF\n   community.  It has received public\
    \ review and has been approved for\n   publication by the Internet Engineering\
    \ Steering Group (IESG).  Not\n   all documents approved by the IESG are a candidate\
    \ for any level of\n   Internet Standard; see Section 2 of RFC 5741.\n   Information\
    \ about the current status of this document, any errata,\n   and how to provide\
    \ feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6832.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2013 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Definition of Terms .............................................5\n  \
    \ 3. LISP Interworking Models ........................................6\n   4.\
    \ Routable EIDs ...................................................7\n      4.1.\
    \ Impact on Routing Table ....................................7\n      4.2. Requirement\
    \ for Sites to Use BGP ...........................7\n      4.3. Limiting the Impact\
    \ of Routable EIDs .......................7\n      4.4. Use of Routable EIDs for\
    \ Sites Transitioning to LISP .......7\n   5. Proxy Ingress Tunnel Routers ....................................8\n\
    \      5.1. Proxy-ITR EID Announcements ................................8\n  \
    \    5.2. Packet Flow with Proxy-ITRs ................................9\n    \
    \  5.3. Scaling Proxy-ITRs ........................................11\n      5.4.\
    \ Impact of the Proxy-ITR's Placement in the Network ........11\n      5.5. Benefit\
    \ to Networks Deploying Proxy-ITRs ..................11\n   6. Proxy Egress Tunnel\
    \ Routers ....................................12\n      6.1. Packet Flow with\
    \ Proxy-ETRs ...............................12\n   7. LISP-NAT .......................................................13\n\
    \      7.1. Using LISP-NAT with LISP-NR EIDs ..........................14\n  \
    \    7.2. LISP Sites with Hosts Using RFC 1918 Addresses Sending\n           to\
    \ Non-LISP Sites .........................................15\n      7.3. LISP\
    \ Sites with Hosts Using RFC 1918 Addresses Sending\n           Packets to Other\
    \ LISP Sites ...............................15\n      7.4. LISP-NAT and Multiple\
    \ EIDs ................................16\n   8. Discussion of Proxy-ITRs, LISP-NAT,\
    \ and Proxy-ETRs .............16\n      8.1. How Proxy-ITRs and Proxy-ETRs Interact\
    \ ....................17\n   9. Security Considerations ........................................17\n\
    \   10. Acknowledgments ...............................................18\n  \
    \ 11. References ....................................................18\n    \
    \  11.1. Normative References .....................................18\n      11.2.\
    \ Informative References ...................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document describes interoperation mechanisms between\
    \ LISP\n   [RFC6830] sites that use EIDs that are not globally routed, and\n \
    \  non-LISP sites.  A key behavior of the separation of Locators and\n   Endpoint\
    \ IDs is that EID-Prefixes are normally not advertised into\n   the Internet's\
    \ Default-Free Zone (DFZ).  (See Section 4 for the\n   exception case.)  Specifically,\
    \ only Routing Locators (RLOCs) are\n   carried in the Internet's DFZ.  Existing\
    \ Internet sites (and their\n   hosts) that do not run LISP must still be able\
    \ to reach sites\n   numbered from LISP EID space.  This document describes three\n\
    \   mechanisms that can be used to provide reachability between sites\n   that\
    \ are LISP-capable and those that are not.\n   The first mechanism uses a new\
    \ network element, the LISP Proxy\n   Ingress Tunnel Router (Proxy-ITR), to act\
    \ as an intermediate LISP\n   Ingress Tunnel Router (ITR) for non-LISP-speaking\
    \ hosts.  The second\n   mechanism adds a form of Network Address Translation\
    \ (NAT)\n   functionality to Tunnel Routers (xTRs, where \"xTR\" refers to either\n\
    \   an ITR or ETR), to substitute routable IP addresses for non-routable\n   EIDs.\
    \  The final network element is the LISP Proxy Egress Tunnel\n   Router (Proxy-ETR),\
    \ which acts as an intermediate Egress Tunnel\n   Router (ETR) for LISP sites\
    \ that need to encapsulate LISP packets\n   destined to non-LISP sites.\n   More\
    \ detailed descriptions of these mechanisms and the network\n   elements involved\
    \ may be found in the following sections:\n   -  Section 2 defines terms used\
    \ throughout this document.\n   -  Section 3 describes the different cases where\
    \ interworking\n      mechanisms are needed.\n   -  Section 4 describes the relationship\
    \ between the new EID-Prefix\n      space and the IP address space used by the\
    \ current Internet.\n   -  Section 5 introduces and describes the operation of\
    \ Proxy-ITRs.\n   -  Section 6 introduces and describes the operation of Proxy-ETRs.\n\
    \   -  Section 7 defines how NAT is used by ETRs to translate\n      non-routable\
    \ EIDs into routable IP addresses.\n   -  Section 8 describes the relationship\
    \ between asymmetric and\n      symmetric interworking mechanisms (Proxy-ITRs\
    \ and Proxy-ETRs vs.\n      LISP-NAT).\n   Note that any successful interworking\
    \ model should be independent of\n   any particular EID-to-RLOC mapping algorithm.\
    \  This document does not\n   comment on the value of any of the particular LISP\
    \ mapping systems.\n   Several areas concerning the interworking of LISP and non-LISP\
    \ sites\n   remain open for further study.  These areas include an examination\
    \ of\n   the impact of LISP-NAT on Internet traffic and applications,\n   understanding\
    \ the deployment motivations for the deployment and\n   operation of Proxy Tunnel\
    \ Routers, the impact of EID routes\n   originated into the Internet's Default-Free\
    \ Zone, and the effects of\n   Proxy Tunnel Routers or LISP-NAT on Internet traffic\
    \ and\n   applications.  Until these issues are fully understood, it is\n   possible\
    \ that the interworking mechanisms described in this document\n   will be hard\
    \ to deploy or may have unintended consequences to\n   applications.\n"
- title: 2.  Definition of Terms
  contents:
  - "2.  Definition of Terms\n   Default-Free Zone:  The Default-Free Zone (DFZ) refers\
    \ to the\n      collection of all Internet autonomous systems that do not require\n\
    \      a default route to route a packet to any destination.\n   LISP Routable\
    \ (LISP-R) Site:  A LISP site whose addresses are used as\n      both globally\
    \ routable IP addresses and LISP EIDs.\n   LISP Non-Routable (LISP-NR) Site: \
    \ A LISP site whose addresses are\n      EIDs only; these EIDs are not found in\
    \ the legacy Internet routing\n      table.\n   LISP Proxy Ingress Tunnel Router\
    \ (Proxy-ITR):  Proxy-ITRs are used to\n      provide connectivity between sites\
    \ that use LISP EIDs and those\n      that do not.  They act as gateways between\
    \ those parts of the\n      Internet that are not using LISP (the legacy Internet).\
    \  A given\n      Proxy-ITR advertises one or more highly aggregated EID-Prefixes\n\
    \      into the public Internet and acts as the ITR for traffic received\n   \
    \   from the public Internet.  LISP Proxy-ITRs are described in\n      Section\
    \ 5.\n   LISP Network Address Translation (LISP-NAT):  Network address\n     \
    \ translation between EID space assigned to a site and RLOC space\n      also\
    \ assigned to that site.  LISP-NAT is described in Section 7.\n   LISP Proxy Egress\
    \ Tunnel Router (Proxy-ETR):  Proxy-ETRs provide a\n      LISP (routable or non-routable\
    \ EID) site's ITRs with the ability\n      to send packets to non-LISP sites in\
    \ cases where unencapsulated\n      packets (the default mechanism) would fail\
    \ to be delivered.\n      Proxy-ETRs function by having an ITR encapsulate all\
    \ non-LISP\n      destined traffic to a pre-configured Proxy-ETR.  LISP Proxy-ETRs\n\
    \      are described in Section 6.\n    EID Sub-Namespace:  A power-of-two block\
    \ of aggregatable Locators\n      set aside for LISP interworking.\n   For definitions\
    \ of other terms -- notably Map-Request, Map-Reply,\n   Ingress Tunnel Router\
    \ (ITR), and Egress Tunnel Router (ETR) -- please\n   consult the LISP specification\
    \ [RFC6830].\n"
- title: 3.  LISP Interworking Models
  contents:
  - "3.  LISP Interworking Models\n   There are 4 unicast connectivity cases that\
    \ describe how sites can\n   send packets to each other:\n   1.  non-LISP site\
    \ to non-LISP site\n   2.  LISP site to LISP site\n   3.  LISP site to non-LISP\
    \ site\n   4.  non-LISP site to LISP site\n   Note that while Cases 3 and 4 seem\
    \ similar, there are subtle\n   differences due to the way packets are originated.\n\
    \   The first case is the Internet as we know it today and as such will\n   not\
    \ be discussed further here.  The second case is documented in\n   [RFC6830],\
    \ and there are no new interworking requirements because\n   there are no new\
    \ protocol requirements placed on intermediate\n   non-LISP routers.\n   In Case\
    \ 3, LISP site to non-LISP site, a LISP site can (in most\n   cases) send packets\
    \ to a non-LISP site because the non-LISP site\n   prefixes are routable.  The\
    \ non-LISP sites need not do anything new\n   to receive packets.  The only action\
    \ the LISP site needs to take is\n   to know when not to LISP-encapsulate packets.\
    \  An ITR knows\n   explicitly that the destination is non-LISP if the destination\
    \ IP\n   address of an IP packet matches a (negative) Map-Cache entry that has\n\
    \   the action 'Natively-Forward'.\n   There could be some situations where (unencapsulated)\
    \ packets\n   originated by a LISP site may not be forwarded to a non-LISP site.\n\
    \   These cases are reviewed in Section 6 (Proxy Egress Tunnel Routers).\n   Case\
    \ 4, typically the most challenging, occurs when a host at a\n   non-LISP site\
    \ wishes to send traffic to a host at a LISP site.  If\n   the source host uses\
    \ a (non-globally routable) EID as the destination\n   IP address, the packet\
    \ is forwarded inside the source site until it\n   reaches a router that cannot\
    \ forward it (due to lack of a default\n   route), at which point the traffic\
    \ is dropped.  For traffic not to be\n   dropped, some mechanism to make this\
    \ destination EID routable must be\n   in place.  Sections 5 (Proxy-ITRs) and\
    \ 7 (LISP-NAT) describe two such\n   mechanisms.  Case 4 also applies to non-LISP\
    \ packets (as in Case 3)\n   that are returning to the LISP site.\n"
- title: 4.  Routable EIDs
  contents:
  - "4.  Routable EIDs\n   An obvious way to achieve interworking between LISP and\
    \ non-LISP\n   hosts is for a LISP site to simply announce EID-Prefixes into the\n\
    \   DFZ, much like the current routing system, effectively treating them\n   as\
    \ \"Provider-Independent\" (PI) prefixes.  Having a site do this is\n   undesirable,\
    \ as it defeats one of the primary goals of LISP -- to\n   reduce global routing\
    \ system state.\n"
- title: 4.1.  Impact on Routing Table
  contents:
  - "4.1.  Impact on Routing Table\n   If EID-Prefixes are announced into the DFZ,\
    \ the impact is similar to\n   the case in which LISP has not been deployed, because\
    \ these\n   EID-Prefixes will be no more aggregatable than existing PI addresses.\n\
    \   Such a mechanism is not viewed as a viable long-term solution but may\n  \
    \ be a viable short-term way for a site to transition a portion of its\n   address\
    \ space to EID space without changing its existing routing\n   policy.\n"
- title: 4.2.  Requirement for Sites to Use BGP
  contents:
  - "4.2.  Requirement for Sites to Use BGP\n   Routable EIDs might require non-LISP\
    \ sites today to use BGP to, among\n   other things, originate their site's routes\
    \ into the DFZ, in order to\n   enable ingress Traffic Engineering.  Relaxing\
    \ this requirement (and\n   thus potentially reducing global DFZ routing state)\
    \ while still\n   letting sites control their ingress Traffic Engineering policy\
    \ is a\n   design goal of LISP.\n"
- title: 4.3.  Limiting the Impact of Routable EIDs
  contents:
  - "4.3.  Limiting the Impact of Routable EIDs\n   Two schemes are proposed to limit\
    \ the impact of having EIDs announced\n   in the current global Internet routing\
    \ table:\n   1.  Section 5 discusses the LISP Proxy Ingress Tunnel Router, an\n\
    \       approach that provides ITR functionality to bridge LISP-capable\n    \
    \   and non-LISP-capable sites.\n   2.  Section 7 discusses another approach,\
    \ LISP-NAT, in which NAT\n       [RFC2993] is combined with ITR functionality\
    \ to limit the impact\n       of routable EIDs on the Internet routing infrastructure.\n"
- title: 4.4.  Use of Routable EIDs for Sites Transitioning to LISP
  contents:
  - "4.4.  Use of Routable EIDs for Sites Transitioning to LISP\n   A primary design\
    \ goal for LISP (and other Locator/ID separation\n   proposals) is to facilitate\
    \ topological aggregation of namespaces\n   used for the path computation, and\
    \ thus decrease global routing\n   system overhead.  Another goal is to achieve\
    \ the benefits of improved\n   aggregation as soon as possible.  Individual sites\
    \ advertising their\n   own routes for LISP EID-Prefixes into the global routing\
    \ system is\n   therefore not recommended.\n   That being said, single-homed sites\
    \ (or multihomed sites that are not\n   leaking more-specific exceptions) that\
    \ are already using provider-\n   aggregated prefixes can use these prefixes as\
    \ LISP EIDs without\n   adding state to the routing system.  In other words, such\
    \ sites do\n   not cause additional prefixes to be advertised.  For such sites,\n\
    \   connectivity to a non-LISP site does not require interworking\n   machinery\
    \ because the \"PA\" (Provider-Assigned) EIDs are already\n   routable (they are\
    \ effectively LISP-R type sites).  Their EIDs are\n   found in the LISP mapping\
    \ system, and their (aggregate) PA prefix(es)\n   are found in the DFZ of the\
    \ Internet.\n   The continued announcements of an existing site's Provider-\n\
    \   Independent (PI) prefix(es) is of course under the control of that\n   site.\
    \  Some period of transition, where a site is found both in the\n   LISP mapping\
    \ system, and as a discrete prefix in the Internet routing\n   system, may be\
    \ a viable transition strategy.  Care should be taken\n   not to advertise additional\
    \ more-specific LISP EID-Prefixes into\n   the DFZ.\n"
- title: 5.  Proxy Ingress Tunnel Routers
  contents:
  - "5.  Proxy Ingress Tunnel Routers\n   Proxy Ingress Tunnel Routers (Proxy-ITRs)\
    \ allow non-LISP sites to\n   send packets to LISP-NR sites.  A Proxy-ITR is a\
    \ new network element\n   that shares many characteristics with the LISP ITR.\
    \  Proxy-ITRs allow\n   non-LISP sites to send packets to LISP-NR sites without\
    \ any changes\n   to protocols or equipment at the non-LISP site.  Proxy-ITRs\
    \ have two\n   primary functions:\n   Originating EID Advertisements:  Proxy-ITRs\
    \ advertise highly\n      aggregated EID-Prefix space on behalf of LISP sites\
    \ so that\n      non-LISP sites can reach them.\n   Encapsulating Legacy Internet\
    \ Traffic:  Proxy-ITRs also encapsulate\n      non-LISP Internet traffic into\
    \ LISP packets and route them towards\n      their destination RLOCs.\n"
- title: 5.1.  Proxy-ITR EID Announcements
  contents:
  - "5.1.  Proxy-ITR EID Announcements\n   A key part of Proxy-ITR functionality is\
    \ to advertise routes for\n   highly aggregated EID-Prefixes into parts of the\
    \ global routing\n   system.  Aggressive aggregation is performed to minimize\
    \ the number\n   of new announced routes.  In addition, careful placement of\n\
    \   Proxy-ITRs can greatly reduce the advertised scope of these new\n   routes.\
    \  To this end, Proxy-ITRs should be deployed close to\n   non-LISP-speaking sites\
    \ rather than close to LISP sites.  Such\n   deployment not only limits the scope\
    \ of EID-Prefix route\n   advertisements but also allows the traffic forwarding\
    \ load to be\n   spread among many Proxy-ITRs.\n"
- title: 5.2.  Packet Flow with Proxy-ITRs
  contents:
  - "5.2.  Packet Flow with Proxy-ITRs\n   What follows is an example of the path\
    \ a packet would take when using\n   a Proxy-ITR.  In this example, the LISP-NR\
    \ site is given the\n   EID-Prefix 192.0.2.0/24.  For the purposes of this example,\
    \ neither\n   this prefix nor any covering aggregate are present in the global\n\
    \   routing system.  In other words, without the Proxy-ITR announcing\n   192.0.2.0/24,\
    \ if a packet with this destination were to reach a\n   router in the Default-Free\
    \ Zone, it would be dropped.  The following\n   diagram describes a high-level\
    \ view of the topology:\n                     Internet DFZ\n          .--------------------------------.\n\
    \         /                                  \\\n         |      Traffic Encap'd\
    \ to Site's   |\n         |    +-----+    RLOC(s)            |        LISP Site:\n\
    \         |    |P-ITR|=========>             |\n         |    +-----+        \
    \            +--+      +-----+ |\n         |       |                       |PE+------+CE\
    \ 1 |-|\n         |       | Originated Route      +--+      +-----+ | +----+\n\
    \         |       V  192.0.2.0/24            |              |-|Host|\n       \
    \  |                               +--|      +-----+ | +----+\n         |    \
    \                           |PE+------+CE 2 |-|  192.0.2.1\n         |       \
    \         +---+          +--+      +-----+ |\n         \\                |PE |\
    \             /\n          '---------------+-+-+------------'        Site EID-Prefix:\n\
    \                            |                          192.0.2.0/24\n       \
    \                     |       ^\n                            |       |\n     \
    \                    +--+--+    | Traffic\n         Non LISP Site:  | CE  |  \
    \  |  to\n                         +--+--+    | 192.168.2.1\n                \
    \            |       |\n                       -----------\n                 \
    \              |\n                              +----+\n                     \
    \         |Host|\n                              +----+\n                Figure\
    \ 1: Example of Proxy-ITR Packet Flow\n   A full protocol exchange example follows:\n\
    \   1.  The source host makes a DNS lookup EID for the destination and\n     \
    \  gets 192.0.2.1 in return.\n   2.  The source host has a default route to the\
    \ Customer Edge (CE)\n       router and forwards the packet to the CE.\n   3.\
    \  The CE has a default route to its Provider Edge (PE) router and\n       forwards\
    \ the packet to the PE.\n   4.  The PE has a route to 192.0.2.0/24, and the next\
    \ hop is the\n       Proxy-ITR.\n   5.  The Proxy-ITR has or acquires a mapping\
    \ for 192.0.2.1 and LISP-\n       encapsulates the packet.  The outer IP header\
    \ now has a\n       destination address of one of the destination EID's RLOCs.\
    \  The\n       outer source address of this encapsulated packet is the\n     \
    \  Proxy-ITR's RLOC.\n   6.  The Proxy-ITR looks up the RLOC and forwards the\
    \ LISP packet to\n       the next hop, after which it is forwarded by other routers\
    \ to the\n       ETR's RLOC.\n   7.  The ETR decapsulates the packet and delivers\
    \ the packet to the\n       192.0.2.1 host in the destination LISP site.\n   8.\
    \  Packets from host 192.0.2.1 will flow back through the LISP\n       site's\
    \ ITR.  Such packets are not encapsulated because the ITR\n       knows that the\
    \ destination (the original source) is a non-LISP\n       site.  The ITR knows\
    \ this because it can check the LISP mapping\n       database for the destination\
    \ EID and on a failure determines that\n       the destination site is not LISP\
    \ enabled.\n   9.  Packets are then routed natively and directly to the destination\n\
    \       (original source) site.\n   Note that in this example the return path\
    \ is asymmetric, so return\n   traffic will not go back through the Proxy-ITR.\
    \  This is because the\n   LISP-NR site's ITR will discover that the originating\
    \ site is not a\n   LISP site and will not encapsulate the returning packet (see\n\
    \   [RFC6830] for details of ITR behavior).\n   The asymmetric nature of traffic\
    \ flows allows the Proxy-ITR to be\n   relatively simple -- it will only have\
    \ to encapsulate LISP packets.\n"
- title: 5.3.  Scaling Proxy-ITRs
  contents:
  - "5.3.  Scaling Proxy-ITRs\n   Proxy-ITRs attract traffic by announcing the LISP\
    \ EID namespace into\n   parts of the non-LISP-speaking global routing system.\
    \  There are\n   several ways that a network could control how traffic reaches\
    \ a\n   particular Proxy-ITR to prevent it from receiving more traffic than\n\
    \   it can handle:\n   1.  The Proxy-ITR's aggregate routes might be selectively\
    \ announced,\n       giving a coarse way to control the quantity of traffic attracted\n\
    \       by that Proxy-ITR.  For example, some of the routes being\n       announced\
    \ might be tagged with a BGP community and their scope of\n       announcement\
    \ limited by the routing policy of the provider.\n   2.  The same address might\
    \ be announced by multiple Proxy-ITRs in\n       order to share the traffic using\
    \ IP Anycast.  The asymmetric\n       nature of traffic flows through the Proxy-ITR\
    \ means that\n       operationally, deploying a set of Proxy-ITRs would be very\n\
    \       similar to existing anycasted services like DNS caches.  Multiple\n  \
    \     Proxy-ITRs could advertise the same BGP Next Hop IP address as\n       their\
    \ RLOC, and traffic would be attracted to the nearest Next\n       Hop according\
    \ to the network's IGP.\n"
- title: 5.4.  Impact of the Proxy-ITR's Placement in the Network
  contents:
  - "5.4.  Impact of the Proxy-ITR's Placement in the Network\n   There are several\
    \ approaches that a network could take in placing\n   Proxy-ITRs.  Placing the\
    \ Proxy-ITR near the source of traffic allows\n   the communication between the\
    \ non-LISP site and the LISP site to have\n   the least \"stretch\" (i.e., the\
    \ least number of forwarding hops when\n   compared to an optimal path between\
    \ the sites).\n   Some proposals, for example the Core Router-Integrated Overlay\n\
    \   [CRIO], have suggested grouping Proxy-ITRs near an arbitrary subset\n   of\
    \ ETRs and announcing a 'local' subset of EID space.  This model\n   cannot guarantee\
    \ minimum stretch if the EID-Prefix route\n   advertisement points are changed\
    \ (such a change might occur if a site\n   adds, removes, or replaces one or more\
    \ of its ISP connections).\n"
- title: 5.5.  Benefit to Networks Deploying Proxy-ITRs
  contents:
  - "5.5.  Benefit to Networks Deploying Proxy-ITRs\n   When packets destined for\
    \ LISP-NR sites arrive and are encapsulated\n   at a Proxy-ITR, a new LISP packet\
    \ header is prepended.  This causes\n   the packet's destination to be set to\
    \ the destination ETR's RLOC.\n   Because packets are thus routed towards RLOCs,\
    \ it can potentially\n   better follow the Proxy-ITR network's Traffic Engineering\
    \ policies\n   (such as closest exit routing).  This also means that providers\
    \ that\n   are not default-free and do not deploy Proxy-ITRs end up sending more\n\
    \   traffic to expensive transit links (assuming their upstreams have\n   deployed\
    \ Proxy-ITRs) rather than to the ETR's RLOC addresses, to\n   which they may well\
    \ have cheaper and closer connectivity (via, for\n   example, settlement-free\
    \ peering).  A corollary to this would be that\n   large transit providers deploying\
    \ Proxy-ITRs may attract more\n   traffic, and therefore more revenue, from their\
    \ customers.\n"
- title: 6.  Proxy Egress Tunnel Routers
  contents:
  - "6.  Proxy Egress Tunnel Routers\n   Proxy Egress Tunnel Routers (Proxy-ETRs)\
    \ allow LISP sites to send\n   packets to non-LISP sites in the case where the\
    \ access network does\n   not allow the LISP site to send packets with the source\
    \ address of\n   the site's EID(s).  A Proxy-ETR is a new network element that,\n\
    \   conceptually, acts as an ETR for traffic destined to non-LISP sites.\n   This\
    \ also has the effect of allowing an ITR to avoid having to decide\n   whether\
    \ to encapsulate packets or not -- it can always encapsulate\n   packets.  An\
    \ ITR would encapsulate packets destined for LISP sites\n   (no change here),\
    \ and these would be routed directly to the\n   corespondent site's ETR.  All\
    \ other packets (those destined to\n   non-LISP sites) will be sent to the originating\
    \ site's Proxy-ETR.\n   There are two primary reasons why sites would want to\
    \ utilize a\n   Proxy-ETR:\n   Avoiding strict Unicast Reverse Path Forwarding\
    \ (uRPF) failures:\n      Some providers' access networks require the source of\
    \ the packets\n      emitted to be within the addressing scope of the access networks\n\
    \      (see Section 9).\n   Traversing a different IP Protocol:  A LISP site may\
    \ want to transmit\n      packets to a non-LISP site where some of the intermediate\
    \ network\n      does not support the particular IP protocol desired (v4 or v6).\n\
    \      Proxy-ETRs can allow this LISP site's data to 'hop over' this by\n    \
    \  utilizing LISP's support for mixed-protocol encapsulation.\n"
- title: 6.1.  Packet Flow with Proxy-ETRs
  contents:
  - "6.1.  Packet Flow with Proxy-ETRs\n   Packets from a LISP site can reach a non-LISP\
    \ site with the aid of a\n   Proxy-ETR.  An ITR is simply configured to send all\
    \ non-LISP traffic,\n   which it normally would have forwarded natively (non-encapsulated),\n\
    \   to a Proxy-ETR.  In the case where the ITR uses one or more\n   Map-Resolvers,\
    \ the ITR will encapsulate packets that match the\n   received Negative Map-Cache\
    \ to the configured Proxy-ETR(s).  In the\n   case where the ITR is connected\
    \ to the mapping system directly, it\n   would encapsulate all packets to the\
    \ configured Proxy-ETR that are\n   cache misses.  Note that this outer encapsulation\
    \ to the Proxy-ETR\n   may be in an IP protocol other than the (inner) encapsulated\
    \ data.\n   Routers then use the LISP (outer) header's destination address to\n\
    \   route the packets toward the configured Proxy-ETR.\n   A Proxy-ETR should\
    \ verify the (inner) source EID of the packet at the\n   time of decapsulation\
    \ in order to verify that this is from a\n   configured LISP site.  This is to\
    \ prevent spoofed inner sources from\n   being encapsulated through the Proxy-ETR.\n\
    \   What follows is an example of the path a packet would take when using\n  \
    \ a Proxy-ETR.  In this example, the LISP-NR (or LISP-R) site is given\n   the\
    \ EID-Prefix 192.0.2.0/24, and it is trying to reach a host at a\n   non-LISP\
    \ site with the IP prefix 198.51.100.0/24.  For the purposes\n   of this example,\
    \ the destination (198.51.100.0/24) is found in the\n   Internet's routing system.\n\
    \   A full protocol exchange example follows:\n   1.  The source host makes a\
    \ DNS lookup for the destination and gets\n       198.51.100.100 (an IP address\
    \ of a host in the non-LISP site) in\n       return.\n   2.  The source host has\
    \ a default route to the Customer Edge (CE)\n       router and forwards the packet\
    \ towards the CE.\n   3.  The CE is a LISP ITR and is configured to encapsulate\
    \ traffic\n       destined for non-LISP sites to a Proxy-ETR.\n   4.  The Proxy-ETR\
    \ decapsulates the LISP packet and forwards the\n       original packet to its\
    \ next hop.\n   5.  The packet is then routed natively and directly to the\n \
    \      destination (non-LISP) site 198.51.100.0/24.\n   Note that in this example\
    \ the return path is asymmetric, so return\n   traffic will not go back through\
    \ the Proxy-ETR.  This means that in\n   order to reach LISP-NR sites, non-LISP\
    \ sites must still use\n   Proxy-ITRs.\n"
- title: 7.  LISP-NAT
  contents:
  - "7.  LISP-NAT\n   LISP Network Address Translation (LISP-NAT) is a limited form\
    \ of NAT\n   [RFC2993].  LISP-NAT is designed to enable the interworking of\n\
    \   non-LISP sites and LISP-NR sites by ensuring that the LISP-NR's site\n   addresses\
    \ are always routable.  LISP-NAT accomplishes this by\n   translating a host's\
    \ source address from an 'inner' (LISP-NR EID)\n   value to an 'outer' (LISP-R)\
    \ value and keeping this translation in a\n   table that it can reference for\
    \ subsequent packets.\n   In addition, existing RFC 1918 [RFC1918] sites can use\
    \ LISP-NAT to\n   talk to both LISP and non-LISP sites.\n   The basic concept\
    \ of LISP-NAT is that when transmitting a packet, the\n   ITR replaces a non-routable\
    \ EID source address with a routable source\n   address, which enables packets\
    \ to return to the site.  Note that this\n   section is intended as a rough overview\
    \ of what could be done and is\n   not an exhaustive guide to IPv4 NAT.\n   There\
    \ are two main cases that involve LISP-NAT:\n   1.  Hosts at LISP sites that use\
    \ non-routable global EIDs speaking to\n       non-LISP sites using global addresses.\n\
    \   2.  Hosts at LISP sites that use RFC 1918 private EIDs speaking to\n     \
    \  other sites, who may be either LISP or non-LISP sites.\n   Note that LISP-NAT\
    \ is not needed in the case of LISP-R (routable\n   global EIDs) sources.  This\
    \ case occurs when a site is announcing its\n   prefix into both the LISP mapping\
    \ system and the Internet DFZ.  This\n   is because the LISP-R source's address\
    \ is routable, and return\n   packets will be able to natively reach the site.\n"
- title: 7.1.  Using LISP-NAT with LISP-NR EIDs
  contents:
  - "7.1.  Using LISP-NAT with LISP-NR EIDs\n   LISP-NAT allows a host with a LISP-NR\
    \ EID to send packets to non-LISP\n   hosts by translating the LISP-NR EID to\
    \ a globally unique address (a\n   LISP-R EID).  This globally unique address\
    \ may be either a PI or PA\n   address.\n   An example of this translation follows.\
    \  For this example, a site has\n   been assigned a LISP-NR EID of 203.0.113.0/24.\
    \  In order to utilize\n   LISP-NAT, the site has also been provided the PA EID\
    \ 192.0.2.0/24 and\n   uses the first address (192.0.2.1) as the site's RLOC.\
    \  The rest of\n   this PA space (192.0.2.2 to 192.0.2.254) is used as a translation\n\
    \   pool for this site's hosts who need to send packets to non-LISP\n   hosts.\n\
    \   The translation table might look like the following:\n      Site NR-EID  \
    \   Site R-EID     Site's RLOC    Translation Pool\n      ==============================================================\n\
    \      203.0.113.0/24  192.0.2.0/24    192.0.2.1      192.0.2.2-254\n        \
    \            Figure 2: Example Translation Table\n   The host 203.0.113.2 sends\
    \ a packet (which, for the purposes of this\n   example, is destined for a non-LISP\
    \ site) to its default route (the\n   ITR).  The ITR receives the packet and determines\
    \ that the\n   destination is not a LISP site.  How the ITR makes this determination\n\
    \   is up to the ITR's implementation of the EID-to-RLOC mapping system\n   used\
    \ (see, for example, [RFC6836]).\n   The ITR then rewrites the source address\
    \ of the packet from\n   203.0.113.2 to 192.0.2.2, which is the first available\
    \ address in the\n   LISP-R EID space available to it.  The ITR keeps this translation\
    \ in\n   a table in order to reverse this process when receiving packets\n   destined\
    \ to 192.0.2.2.\n   Finally, when the ITR forwards this packet without encapsulating\
    \ it,\n   it uses the entry in its LISP-NAT table to translate the returning\n\
    \   packets' destination IPs to the proper host.\n"
- title: 7.2.  LISP Sites with Hosts Using RFC 1918 Addresses Sending to Non-LISP
  contents:
  - "7.2.  LISP Sites with Hosts Using RFC 1918 Addresses Sending to Non-LISP\n  \
    \    Sites\n   In the case where hosts using RFC 1918 addresses desire to send\n\
    \   packets to non-LISP hosts, the LISP-NAT implementation acts much like\n  \
    \ an existing IPv4 NAT device that is doing address translation only\n   (not\
    \ port translation).  The ITR providing the NAT service must use\n   LISP-R EIDs\
    \ for its global address pool and also provide all the\n   standard NAT functions\
    \ required today.\n   Note that the RFC 1918 addresses above are private addresses\
    \ and not\n   EIDs, and that these RFC 1918 addresses are not found in the LISP\n\
    \   mapping system.\n   The source of the packet must be translated to a LISP-R\
    \ EID in a\n   manner similar to that discussed in Section 7, and this packet\
    \ must\n   be forwarded to the ITR's next hop for the destination, without LISP\n\
    \   encapsulation.\n"
- title: 7.3.  LISP Sites with Hosts Using RFC 1918 Addresses Sending Packets to
  contents:
  - "7.3.  LISP Sites with Hosts Using RFC 1918 Addresses Sending Packets to\n   \
    \   Other LISP Sites\n   LISP-NAT allows a host with an RFC 1918 address to send\
    \ packets to\n   LISP hosts by translating the RFC 1918 address to a LISP EID.\
    \  After\n   translation, the communication between the source and destination\
    \ ITR\n   and ETRs continues as described in [RFC6830].\n   While the communication\
    \ of LISP EIDs to LISP EIDs is, strictly\n   speaking, outside the scope of interworking,\
    \ it is included here in\n   order to complete the conceptual framework of LISP-NAT.\n\
    \   An example of this translation and encapsulation follows.  For this\n   example,\
    \ a host has been assigned an RFC 1918 address of 192.168.1.2.\n   In order to\
    \ utilize LISP-NAT, the site also has been provided the\n   LISP-R EID-Prefix\
    \ 192.0.2.0/24 and uses the first address (192.0.2.1)\n   as the site's RLOC.\
    \  The rest of this PA space (192.0.2.2 to\n   192.0.2.254) is used as a translation\
    \ pool for this site's hosts who\n   need to send packets to both non-LISP and\
    \ LISP hosts.\n   The host 192.168.1.2 sends a packet destined for a non-LISP\
    \ site to\n   its default route (the ITR).  The ITR receives the packet and\n\
    \   determines that the destination is a LISP site.  How the ITR makes\n   this\
    \ determination is up to the ITR's implementation of the\n   EID-to-RLOC mapping\
    \ system.\n   The ITR then rewrites the source address of the packet from\n  \
    \ 192.168.1.2 to 192.0.2.2, which is the first available address in the\n   LISP\
    \ EID space available to it.  The ITR keeps this translation in a\n   table in\
    \ order to reverse this process when receiving packets\n   destined to 192.0.2.2.\n\
    \   The ITR then LISP-encapsulates this packet (see [RFC6830] for\n   details).\
    \  The ITR uses the site's RLOC as the LISP outer header's\n   source and the\
    \ translation address as the LISP inner header's source.\n   Once it decapsulates\
    \ returning traffic, it uses the entry in its\n   LISP-NAT table to translate\
    \ the returning packet's destination IP\n   address and then forwards it to the\
    \ proper host.\n"
- title: 7.4.  LISP-NAT and Multiple EIDs
  contents:
  - "7.4.  LISP-NAT and Multiple EIDs\n   With LISP-NAT, there are two EIDs possible\
    \ for a given host: the\n   LISP-R EID and the LISP-NR EID.  When a site has two\
    \ addresses that a\n   host might use for global reachability, name-to-address\
    \ directories\n   may need to be modified.\n   This problem -- global vs. local\
    \ addressability -- exists for NAT in\n   general, but the specific issue described\
    \ above is unique to\n   location/identity separation schemes.  Some of these\
    \ have suggested\n   running a separate DNS instance for new types of EIDs.  This\
    \ solves\n   the problem but introduces complexity for the site.  Alternatively,\n\
    \   using Proxy-ITRs can mitigate this problem, because the LISP-NR EID\n   can\
    \ be reached in all cases.\n"
- title: 8.  Discussion of Proxy-ITRs, LISP-NAT, and Proxy-ETRs
  contents:
  - "8.  Discussion of Proxy-ITRs, LISP-NAT, and Proxy-ETRs\n   In summary, there\
    \ are three suggested mechanisms for interworking\n   LISP with non-LISP sites\
    \ (for both IPv4 and IPv6).  In the LISP-NAT\n   option, the LISP site can manage\
    \ and control the interworking on its\n   own.  In the Proxy-ITR case, the site\
    \ is not required to manage the\n   advertisement of its EID-Prefix into the DFZ,\
    \ with the cost of\n   potentially adding stretch to the connections of non-LISP\
    \ sites\n   sending packets to the LISP site.  The third option is Proxy-ETRs,\n\
    \   which are optionally used by sites relying on Proxy-ITRs to mitigate\n   two\
    \ caveats for LISP sites sending packets to non-LISP sites.  This\n   means Proxy-ETRs\
    \ are not usually expected to be deployed by\n   themselves; rather, they will\
    \ be used to assist LISP-NR sites that\n   are already using Proxy-ITRs.\n"
- title: 8.1.  How Proxy-ITRs and Proxy-ETRs Interact
  contents:
  - "8.1.  How Proxy-ITRs and Proxy-ETRs Interact\n   There is a subtle difference\
    \ between symmetrical (LISP-NAT) and\n   asymmetrical (Proxy-ITR and Proxy-ETR)\
    \ interworking techniques.\n   Operationally, Proxy-ITRs and Proxy-ETRs can (and\
    \ likely should) be\n   decoupled, since Proxy-ITRs are best deployed closest\
    \ to non-LISP\n   sites and Proxy-ETRs are best located close to the LISP sites\
    \ they\n   are decapsulating for.  This asymmetric placement of the two network\n\
    \   elements minimizes the stretch imposed on each direction of the\n   packet\
    \ flow while still allowing for coarsely aggregated\n   announcements of EIDs\
    \ into the Internet's routing table.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   Like any router or LISP ITR, Proxy-ITRs will\
    \ have the opportunity to\n   inspect traffic at the time that they encapsulate.\
    \  The location of\n   these devices in the network can have implications for\
    \ discarding\n   malicious traffic on behalf of ETRs that request this behavior\
    \ (by\n   setting the ACT (action) bit in Map-Reply packets [RFC6830] to \"Drop\"\
    \n   for an EID or EID-Prefix).  This is an area that would benefit from\n   further\
    \ experimentation and analysis.\n   LISP interworking via Proxy-ITRs should have\
    \ no impact on the\n   existing network beyond what LISP ITRs and ETRs introduce\
    \ when\n   multihoming.  That is, if a site multihomes today (with LISP or BGP),\n\
    \   there is a possibility of asymmetric flows.\n   Proxy-ITRs and Proxy-ETRs\
    \ will likely be operated by organizations\n   other than those of the end site\
    \ receiving or sending traffic.  Care\n   should be taken, then, in selecting\
    \ a Proxy-ITR/Proxy-ETR provider to\n   insure that the quality of service meets\
    \ the site's expectations.\n   Proxy-ITRs and Proxy-ETRs share many of the same\
    \ security issues as\n   those discussed for ITRs and ETRs.  For further information,\
    \ see the\n   security considerations section of [RFC6830].\n   As with traditional\
    \ NAT, LISP-NAT will obscure the actual host\n   LISP-NR EID behind the LISP-R\
    \ addresses used as the NAT pool.\n   When LISP sites send packets to non-LISP\
    \ sites (these non-LISP sites\n   rely on Proxy-ITRs to enable interworking),\
    \ packets will have the\n   site's EID as the source IP address.  These EIDs may\
    \ not be\n   recognized by their ISP's Unicast Reverse Path Forwarding (uRPF)\n\
    \   rules enabled on the Provider Edge router.  Several options are\n   available\
    \ to the service provider.  For example, they could enable a\n   less strict version\
    \ of uRPF, where they only look for the existence\n   of the EID-Prefix in the\
    \ routing table.  Another option, which is\n   more secure, is to add a static\
    \ route for the customer on the PE\n   router but not redistribute this route\
    \ into the provider's routing\n   table.  Finally, Proxy-ETRs can enable LISP\
    \ sites to bypass this uRPF\n   check by encapsulating all of their egress traffic\
    \ destined to\n   non-LISP sites to the Proxy-ETR (thus ensuring that the outer\
    \ IP\n   source address is the site's RLOC).\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   Thanks go to Christian Vogt, Lixia Zhang, Robin Whittle,\
    \ Michael\n   Menth, Xuewei Wang, and Noel Chiappa, who have made insightful\n\
    \   comments with respect to LISP interworking and transition mechanisms.\n  \
    \ A special thanks goes to Scott Brim for his initial brainstorming of\n   these\
    \ ideas and also for his careful review.\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC1918]  Rekhter, Y., Moskowitz, R., Karrenberg,\
    \ D., Groot, G., and\n              E. Lear, \"Address Allocation for Private\
    \ Internets\",\n              BCP 5, RFC 1918, February 1996.\n   [RFC6830]  Farinacci,\
    \ D., Fuller, V., Meyer, D., and D. Lewis, \"The\n              Locator/ID Separation\
    \ Protocol (LISP)\", RFC 6830,\n              January 2013.\n   [RFC6836]  Farinacci,\
    \ D., Fuller, V., Meyer, D., and D. Lewis,\n              \"Locator/ID Separation\
    \ Protocol Alternative Logical\n              Topology (LISP+ALT)\", RFC 6836,\
    \ January 2013.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [CRIO]     Zhang, X., Francis, P., Wang, J.,\
    \ and K. Yoshida, \"CRIO:\n              Scaling IP Routing with the Core Router-Integrated\n\
    \              Overlay\", November 2006.\n   [RFC2993]  Hain, T., \"Architectural\
    \ Implications of NAT\", RFC 2993,\n              November 2000.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Darrel Lewis\n   Cisco Systems\n   EMail: darlewis@cisco.com\n\
    \   David Meyer\n   Cisco Systems\n   EMail: dmm@1-4-5.net\n   Dino Farinacci\n\
    \   Cisco Systems\n   EMail: farinacci@gmail.com\n   Vince Fuller\n   EMail: vaf@vaf.net\n"
