- contents:
  - "         Transparent Interconnection of Lots of Links (TRILL):\n     End Station
    Address Distribution Information (ESADI) Protocol\n"
  title: __initial_text__
- contents:
  - "Abstract\n   The IETF TRILL (Transparent Interconnection of Lots of Links)\n
    \  protocol provides least-cost pair-wise data forwarding without\n   configuration
    in multi-hop networks with arbitrary topologies and\n   link technologies.  TRILL
    supports multipathing of both unicast and\n   multicast traffic.  Devices that
    implement the TRILL protocol are\n   called TRILL switches or RBridges (Routing
    Bridges).\n   ESADI (End Station Address Distribution Information) is an optional\n
    \  protocol by which a TRILL switch can communicate, in a Data Label\n   (VLAN
    or fine-grained label) scoped way, end station address and\n   reachability information
    to TRILL switches participating in ESADI for\n   the relevant Data Label.  This
    document updates RFC 6325,\n   specifically the documentation of the ESADI protocol,
    and is not\n   backwards compatible.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    5741.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc7357.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2014 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n
    \     1.1. Content and Precedence .....................................5\n      1.2.
    Terminology ................................................5\n   2. ESADI Protocol
    Overview .........................................6\n      2.1. ESADI Virtual
    Link ........................................10\n      2.2. ESADI Neighbor Determination
    ..............................10\n      2.3. ESADI Payloads ............................................11\n
    \  3. ESADI DRB (Designated RBridge) Determination ...................11\n   4.
    ESADI PDU Processing ...........................................12\n      4.1.
    Unicasting ESADI PDUs .....................................12\n      4.2. General
    Transmission of ESADI PDUs ........................13\n      4.3. General Receipt
    of ESADI PDUs .............................14\n      4.4. ESADI Reliable Flooding
    ...................................14\n   5. End Station Addresses ..........................................15\n
    \     5.1. Learning Confidence Level .................................15\n      5.2.
    Forgetting End Station Addresses ..........................16\n      5.3. Duplicate
    MAC Address .....................................16\n   6. ESADI-LSP Contents
    .............................................18\n      6.1. ESADI Parameter Data
    ......................................19\n      6.2. MAC-Reachability TLV ......................................20\n
    \     6.3. Default Authentication ....................................21\n   7.
    IANA Considerations ............................................21\n      7.1.
    ESADI Participation and Capability Flags ..................22\n      7.2. TRILL
    GENINFO TLV .........................................23\n   8. Security Considerations
    ........................................24\n      8.1. Privacy Considerations
    ....................................25\n   9. Acknowledgements ...............................................26\n
    \  10. References ....................................................26\n      10.1.
    Normative References .....................................26\n      10.2. Informative
    References ...................................28\n   Appendix A. Interoperability
    and Changes to RFC 6325 ..............29\n      A.1. ESADI PDU Changes .........................................29\n
    \     A.2. Unicasting Changes ........................................30\n      A.3.
    Message Timing Changes and Suggestions ....................30\n      A.4. Duplicate
    Address Reachability ............................30\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   The TRILL (Transparent Interconnection of Lots of Links)
    protocol\n   [RFC6325] provides least-cost pair-wise data forwarding without\n
    \  configuration in multi-hop networks with arbitrary topologies and\n   link
    technologies, safe forwarding even during periods of temporary\n   loops, and
    support for multipathing of both unicast and multicast\n   traffic.  TRILL accomplishes
    this with the IS-IS (Intermediate System\n   to Intermediate System) [IS-IS] [RFC1195]
    [RFC7176] link-state\n   routing protocol using a header with a hop count.  The
    design\n   supports optimization of the distribution of multi-destination frames\n
    \  and two types of data labeling: VLANs (Virtual Local Area Networks)\n   [RFC6325]
    and FGLs (fine-grained labels) [RFC7172].  Devices that\n   implement TRILL are
    called TRILL switches or RBridges (Routing\n   Bridges).\n   There are five ways
    a TRILL switch can learn end station addresses,\n   as described in Section 4.8
    of [RFC6325].  One of these is the ESADI\n   (End Station Address Distribution
    Information) protocol, which is an\n   optional Data Label scoped way by which
    TRILL switches can\n   communicate with each other information such as end station
    addresses\n   and their TRILL switch of attachment.  A TRILL switch that is\n
    \  announcing interest in a Data Label MAY use the ESADI protocol to\n   announce
    the end station address of some or all of its attached end\n   stations in that
    Data Label to other TRILL switches that are running\n   ESADI for that Data Label.
    \ (In the future, ESADI may also be used\n   for other address and reachability
    information.)\n   By default, TRILL switches with connected end stations learn\n
    \  addresses from the data plane when ingressing and egressing native\n   frames,
    although such learning can be disabled.  The ESADI protocol's\n   potential advantages
    over data plane learning include the following:\n   1. Security advantages:\n
    \     a) The ESADI protocol can be used to announce end stations with an\n         authenticated
    enrollment (for example, enrollment authenticated\n         by cryptographically
    based EAP (Extensible Authentication\n         Protocol) [RFC3748] methods via
    [802.1X]).\n      b) The ESADI protocol supports cryptographic authentication
    of its\n         message payloads for more secure transmission.\n   2. Fast update
    advantages: The ESADI protocol provides a fast update\n      of end station MAC
    (Media Access Control) addresses and their\n      TRILL switch of attachment.
    \ If an end station is unplugged from\n      one TRILL switch and plugged into
    another, ingressed frames with\n      that end station's MAC address as their
    destination can be\n      black-holed.  That is, they can be sent just to the
    older egress\n      TRILL switch that the end station was connected to until cached\n
    \     address information at some remote ingress TRILL switch times out,\n      possibly
    for tens of seconds [RFC6325].\n   MAC address reachability information, some
    ESADI parameters, and\n   optional authentication information are carried in ESADI
    packets\n   rather than in the TRILL IS-IS protocol.  As specified below, ESADI\n
    \  is, for each Data Label, a virtual logical topology overlay in the\n   TRILL
    topology.  An advantage of using ESADI over using TRILL IS-IS\n   is that the
    end station attachment information is not flooded to all\n   TRILL switches but
    only to TRILL switches advertising ESADI\n   participation for the Data Label
    in which those end stations occur.\n"
  - contents:
    - "1.1.  Content and Precedence\n   This document updates [RFC6325], the TRILL
      base protocol\n   specification, replacing the description of the TRILL ESADI
      protocol\n   (Section 4.2.5 of [RFC6325], including all subsections), providing\n
      \  more detail on ESADI, updating other ESADI-related sections of\n   [RFC6325],
      and prevailing over [RFC6325] in any case where they\n   conflict.  For this
      reason, familiarity with [RFC6325] is\n   particularly assumed.  These changes
      include a change to the format\n   of ESADI-LSPs (ESADI Link State Protocol
      Data Units) that is not\n   backwards compatible; this change is justified by
      the substantially\n   increased amount of information that can be carried and
      in light of\n   the very limited, if any, deployment of RFC 6325 ESADI.  These\n
      \  changes are further discussed in Appendix A.\n   Section 2 of this document
      is the ESADI protocol overview.  Section 3\n   specifies ESADI DRB (Designated
      RBridge) determination.  Section 4\n   discusses the processing of ESADI PDUs.
      \ Section 5 discusses\n   interaction with other modes of end station address
      learning.\n   Section 6 describes the ESADI-LSP and its contents.\n"
    title: 1.1.  Content and Precedence
  - contents:
    - "1.2.  Terminology\n   This document uses the acronyms defined in [RFC6325],
      in addition to\n   the following:\n      Data Label:      VLAN or FGL.\n      ESADI
      RBridge:   An RBridge that is participating in ESADI for one\n                       or
      more Data Labels.\n      FGL:             Fine-Grained Label [RFC7172].\n      LSP:
      \            Link State PDU [IS-IS].\n      LSP number zero: A Link State PDU
      with fragment number equal to\n                       zero.\n      PDU:             Protocol
      Data Unit.\n      TRILL switch:    An alternative name for an RBridge.\n   The
      key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n
      \  \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in
      this\n   document are to be interpreted as described in [RFC2119].\n   Capitalized
      IANA-related terms such as \"IETF Review\" are to be\n   interpreted as described
      in [RFC5226].\n"
    title: 1.2.  Terminology
  title: 1.  Introduction
- contents:
  - "2.  ESADI Protocol Overview\n   ESADI is a Data Label scoped way for TRILL switches
    (also known as\n   RBridges) to announce and learn end station addresses rapidly
    and\n   securely.  An RBridge that is announcing participation in ESADI for\n
    \  one or more Data Labels is called an ESADI RBridge.\n   ESADI is an optional
    protocol that is separate from the mandatory\n   TRILL IS-IS implemented by all
    RBridges in a campus.  There is a\n   separate ESADI instance for each Data Label
    (VLAN or FGL) if ESADI is\n   being used for that Data Label.  In essence, for
    each such Data\n   Label, there is a modified instance of the IS-IS reliable flooding\n
    \  mechanism in which ESADI RBridges may choose to participate.  (These\n   are
    not the instances specified in [RFC6822].)  Multiple ESADI\n   instances may share
    implementation components within an RBridge as\n   long as that sharing preserves
    the independent operation of each\n   instance of the ESADI protocol.  For example,
    the ESADI link state\n   database could be a single database with a field in each
    record\n   indicating the Data Label to which it applies, or it could be a\n   separate
    database per Data Label.  However, the ESADI update process\n   operates separately
    for each ESADI instance and independently from\n   the TRILL IS-IS update process.\n
    \  ESADI does no routing calculations, so there is no reason for\n   pseudonodes
    in ESADI and none are created.  (Pseudonodes [IS-IS] are\n   a construct for optimizing
    routing calculations.)  Furthermore, a\n   relatively large amount of ESADI data
    will have to be distributed,\n   under some circumstances, using ESADI mechanisms;
    this would require\n   a large number of ESADI-LSP fragments.  ESADI-LSP, ESADI-CSNP,
    and\n   ESADI-PSNP (ESADI Link State PDU, Complete Sequence Number PDU, and\n
    \  Partial Sequence Number PDU) payloads are therefore formatted as\n   Extended
    Level 1 Circuit Scope (E-L1CS) PDUs [RFC7356] (see also\n   Section 6).  This
    allows up to 2**16 fragments but does not support\n   link state data associated
    with pseudonodes.\n   After the TRILL Header, ESADI packets have an inner Ethernet
    header\n   with the Inner.MacDA of \"All-Egress-RBridges\" (formerly called\n
    \  \"All-ESADI-RBridges\"), an inner Data Label specifying the VLAN or FGL\n   of
    interest, and the \"L2-IS-IS\" Ethertype followed by the ESADI\n   payload, as
    shown in Figure 1.\n                     +--------------------------------+\n
    \                    |          Link Header           |\n                     +--------------------------------+\n
    \                    |       TRILL Data Header        |\n                     +--------------------------------+\n
    \                    |   Inner Ethernet Addresses     |\n                     +--------------------------------+\n
    \                    |           Data Label           |\n                     +--------------------------------+\n
    \                    |       L2-IS-IS Ethertype       |\n                     +--------------------------------+\n
    \                    |         ESADI Payload          |\n                     +--------------------------------+\n
    \                    |          Link Trailer          |\n                     +--------------------------------+\n
    \                  Figure 1: TRILL ESADI Packet Overview\n   TRILL ESADI packets
    sent on an Ethernet link are structured as shown\n   in Figure 2.  The outer VLAN
    tag will not be present if it was not\n   included by the Ethernet port that sent
    the packet.\n   Outer Ethernet Header:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                 Next Hop Destination Address                  |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | Next Hop Destination Addr.    | Sending RBridge Port MAC Addr.|\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                 Sending RBridge Port MAC Address              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \      ...Ethernet frame tagging including optional Outer.VLAN tag...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | Ethertype = TRILL      0x22F3 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  TRILL Header:                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                                      |
    V | R |M|Op-Length| Hop Count |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | Egress Nickname               | Ingress (Origin) Nickname     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  Inner Ethernet Header:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                      All-Egress-RBridges                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | All-Egress-RBridges (cont.)   | Origin RBridge MAC Address    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |               Origin RBridge MAC Address (continued)          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |  VLAN or FGL Data Label (4 or 8 bytes) [RFC7172] ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | Ethertype = L2-IS-IS   0x22F4 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  ESADI Payload (formatted as IS-IS):\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | IS-IS Common Header, IS-IS PDU Specific Fields, IS-IS TLVs    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  Frame Check Sequence:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                  FCS (Frame Check Sequence)                   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \               Figure 2: ESADI Ethernet Link Packet Format\n   The Next Hop Destination
    Address or Outer.MacDA is the All-RBridges\n   multicast address if the ESADI
    PDU is being multicast.  If it is\n   being unicast, the Next Hop Destination
    Address is the unicast\n   address of the next-hop RBridge.  The VLAN for the
    Outer.VLAN\n   information, if present, will be the Designated VLAN for the link
    on\n   which the packet is sent.  The V and R fields will be zero while the\n
    \  M bit will be one, unless the ESADI PDU was unicast, in which case\n   the
    M bit will be zero.  The Data Label specified will be the VLAN or\n   FGL to which
    the ESADI packet applies.  The Origin RBridge MAC\n   Address or Inner.MacSA MUST
    be a MAC address unique across the campus\n   owned by the RBridge originating
    the ESADI packet -- for example, any\n   of its port MAC addresses if it has any
    Ethernet ports -- and each\n   ESADI RBridge MUST use the same Inner.MacSA for
    all of the ESADI\n   packets it originates.\n   TRILL ESADI packets sent on a
    PPP link are structured as shown in\n   Figure 3 [RFC6361].\n   PPP Header:\n
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      | PPP = TNP (TRILL Data) 0x005D
    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   TRILL Header:                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \                                     | V | R |M|Op-Length| Hop Count |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | Egress Nickname               | Ingress (Origin) Nickname     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  Inner Ethernet Header:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                      All-Egress-RBridges                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | All-Egress-RBridges (cont.)   | Origin RBridge MAC Address    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |               Origin RBridge MAC Address (continued)          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |  VLAN or FGL Data Label (4 or 8 bytes) [RFC7172] ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | Ethertype = L2-IS-IS   0x22F4 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  ESADI Payload (formatted as IS-IS):\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     | IS-IS Common Header, IS-IS PDU Specific Fields, IS-IS TLVs    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  PPP Check Sequence:\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                       PPP Check Sequence                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \                 Figure 3: ESADI PPP Link Packet Format\n"
  - contents:
    - "2.1.  ESADI Virtual Link\n   All RBridges forward ESADI packets as if they
      were ordinary TRILL\n   Data packets.  Because of this forwarding, it appears
      to an instance\n   of the ESADI protocol at an RBridge that it is directly connected
      by\n   a multi-access virtual link to all RBridges in the campus that are\n
      \  \"data reachable\" from it (see Section 2 of [RFC7180]) and are running\n
      \  ESADI for that Data Label.  No \"routing\" calculation (least-cost path\n
      \  or distribution tree construction) ever has to be performed by ESADI.\n   An
      ESADI RBridge merely transmits the ESADI packets it originates on\n   this virtual
      link as described for TRILL Data packets in [RFC6325]\n   and [RFC7172].  For
      multicast ESADI packets, it may use any\n   distribution tree that it might
      use for an ordinary multi-destination\n   TRILL Data packet.  RBridges that
      do not implement the ESADI\n   protocol, do not have it enabled, or are not
      participating in the\n   ESADI protocol for the Data Label of an ESADI packet
      do not\n   decapsulate or locally process the ESADI packet.  Thus, ESADI packets\n
      \  are transparently tunneled through transit RBridges.\n"
    title: 2.1.  ESADI Virtual Link
  - contents:
    - "2.2.  ESADI Neighbor Determination\n   The ESADI instance for Data Label X
      at an RBridge RB1 determines who\n   its adjacent ESADI neighbors are by examining
      the TRILL IS-IS link\n   state database for RBridges that are data reachable
      from RB1 (see\n   Section 2 of [RFC7180]) and are announcing their participation
      in\n   Data Label X ESADI.  When an RBridge RB2 becomes data unreachable\n   from
      RB1 or the relevant entries for RB2 are purged from the core\n   IS-IS link
      state database, it is lost as a neighbor and also dropped\n   from any ESADI
      instances from the point of view of RB1, and when RB2\n   is no longer announcing
      participation in Data Label X ESADI, it\n   ceases to be a neighbor for any
      Data Label X ESADI instance.  All\n   these considerations are Data Label scoped.
      \ Because of these\n   mechanisms whereby an ESADI instance at an ESADI RBridge
      can\n   determine its ESADI adjacencies by examining the TRILL IS-IS link\n
      \  state database, there are no \"Hellos\" sent in ESADI and no adjacency\n
      \  information is carried in ESADI-LSPs.\n   A participation announcement in
      a VLAN scoped ESADI instance is\n   generated by setting a flag bit in the Interested
      VLANs sub-TLV, and\n   an announcement for an FGL scoped ESADI instance is generated
      by\n   setting a flag bit in the Interested Labels sub-TLV [RFC7176] (see\n
      \  Section 7.1).\n"
    title: 2.2.  ESADI Neighbor Determination
  - contents:
    - "2.3.  ESADI Payloads\n   TRILL ESADI packet payloads are structured like IS-IS
      Extended\n   Level 1 Circuit Scope (E-L1CS) LSP, CSNP, and PSNP PDUs [RFC7356],\n
      \  except as indicated below, but are always TRILL encapsulated on the\n   wire
      as if they were TRILL Data packets.  The information distributed\n   by the
      ESADI protocol includes a list of local end station MAC\n   addresses connected
      to the originating RBridge and, for each such\n   address, a 1-octet unsigned
      \"Confidence\" rating in the range 0-254\n   (see Section 6.2).  It is entirely
      up to the originating RBridge\n   which locally connected MAC addresses it wishes
      to advertise via\n   ESADI and with what Confidence.  It MAY advertise all,
      some, or none\n   of such addresses.  In addition, some ESADI parameters of
      the\n   advertising RBridge (see Section 6.1) and, optionally, authentication\n
      \  information (see Section 6.3) are included.  Future uses of ESADI may\n   distribute
      other similar address and reachability information.\n   TRILL ESADI-LSPs MUST
      NOT contain a Data Label ID in their payload.\n   The Data Label to which the
      ESADI data applies is the Data Label of\n   the TRILL Data packet enclosing
      the ESADI payload.  If a Data Label\n   ID could occur within the payload, it
      might conflict with that TRILL\n   Data packet Data Label and could conflict
      with any future Data Label\n   mapping scheme that may be adopted [VLANmapping].
      \ If a VLAN or FGL\n   ID field within an ESADI-LSP PDU does include a value,
      that field's\n   contents MUST be ignored.\n"
    title: 2.3.  ESADI Payloads
  title: 2.  ESADI Protocol Overview
- contents:
  - "3.  ESADI DRB (Designated RBridge) Determination\n   Because ESADI does no adjacency
    announcement or routing, the\n   ESADI-DRB never creates a pseudonode.  However,
    a DRB [RFC7177] is\n   still needed to issue ESADI-CSNP PDUs and respond to ESADI-PSNP
    PDUs\n   for ESADI-LSP synchronization.\n   Generally speaking, the DRB election
    on the ESADI virtual link (see\n   Section 2.1) operates similarly to the DRB
    election on a TRILL IS-IS\n   broadcast link, as described in Section 4.2.1 (\"DRB
    Election\n   Details\") of [RFC7177], with the following exceptions: in the Data\n
    \  Label X ESADI-DRB election at RB1 on an ESADI virtual link, the\n   candidates
    are the local ESADI instance for Data Label X and all\n   remote ESADI instances
    at RBridges that are (1) data reachable from\n   RB1 [RFC7180] and (2) announcing
    in their TRILL IS-IS LSP that they\n   are participating in ESADI for Data Label
    X.  The winner is the\n   instance with the highest ESADI Parameter 7-bit priority
    field with\n   ties broken by the System ID, comparing fields as unsigned integers\n
    \  with the larger magnitude considered higher priority.  \"SNPA/MAC\n   address\"
    (Subnetwork Point of Attachment / MAC address) is not\n   considered in this tiebreaking,
    and there is no \"Port ID\".\n"
  title: 3.  ESADI DRB (Designated RBridge) Determination
- contents:
  - "4.  ESADI PDU Processing\n   Data Label X ESADI neighbors are usually not connected
    directly by a\n   physical link but are always logically connected by a virtual
    link\n   (see Section 2.1).  There could be hundreds or thousands of ESADI\n   RBridges
    (TRILL switches) on the virtual link.  The only PDUs used in\n   ESADI are the
    ESADI-LSP, ESADI-CSNP, and ESADI-PSNP PDUs.  In\n   particular, there are no Hello
    or MTU PDUs, because ESADI does not\n   build a topology, does not do any routing
    calculations, and does not\n   determine MTU.  Instead, ESADI uses the distribution
    trees and the Sz\n   campus minimum link MTU determined by the core TRILL IS-IS
    (see\n   [RFC6325] and [RFC7180]).\n"
  - contents:
    - "4.1.  Unicasting ESADI PDUs\n   For [IS-IS], PDU multicasting is normal on
      a local link and no effort\n   is made to optimize to unicast, because on the
      typical physical link\n   for which IS-IS was designed (commonly a piece of
      multi-access\n   Ethernet cable), any frame made the link busy for that frame
      time.\n   However, to ESADI instances, what appears to be a simple multi-access\n
      \  link is generally a set of multi-hop distribution trees that may or\n   may
      not be pruned.  Thus, transmitting a multicast frame on such a\n   tree can
      impose a substantially greater load than transmitting a\n   unicast frame.  This
      load may be justified if there are likely to be\n   multiple listeners but may
      not be justified if there is only one\n   recipient of interest.  For this reason,
      under some circumstances,\n   ESADI PDUs MAY be TRILL unicast if it is confirmed
      that the\n   destination RBridge supports receiving unicast ESADI PDUs (see\n
      \  Section 6.1).\n   The format of a unicast ESADI packet is the format of a
      multicast\n   TRILL ESADI packet as described in Section 2 above, except as\n
      \  follows:\n   o  On an Ethernet link, in the outer Ethernet header the Outer.MacDA\n
      \     is the unicast address of the next-hop RBridge.\n   o  In the TRILL Header,
      the M bit is set to zero and the Egress\n      Nickname is the nickname of the
      destination RBridge.\n   To support unicasting of ESADI PDUs, Section 4.6.2.2
      of [RFC6325] is\n   replaced with the following:\n   4.6.2.2.  TRILL ESADI Packets\n
      \     If M = 1, the egress nickname designates the distribution tree.\n      The
      packet is forwarded as described in Section 4.6.2.5.  In\n      addition, if
      (1) the forwarding RBridge is interested in the\n      specified VLAN or fine-grained
      label [RFC7172], (2) the forwarding\n      RBridge implements the TRILL ESADI
      protocol, and (3) ESADI is\n      enabled for the specified VLAN or fine-grained
      label, then the\n      inner frame is decapsulated and provided to that local
      ESADI\n      protocol.\n      If M = 0 and the egress nickname is not that of
      the receiving\n      RBridge, the packet is forwarded as for known unicast TRILL
      Data\n      frames as described in Section 4.6.2.4.  If M = 0 and the egress\n
      \     nickname is that of the receiving RBridge, and the receiving\n      RBridge
      supports unicast ESADI PDUs, then the ESADI packet is\n      decapsulated and
      processed if it meets the three numbered\n      conditions in the paragraph
      above; otherwise, it is discarded.\n   The references to \"4.6.2.2\", \"4.6.2.4\",
      and \"4.6.2.5\" above refer to\n   those sections in [RFC6325].\n"
    title: 4.1.  Unicasting ESADI PDUs
  - contents:
    - "4.2.  General Transmission of ESADI PDUs\n   Following the usual [IS-IS] rules,
      an ESADI instance does not\n   transmit any ESADI PDUs if it has no ESADI adjacencies.
      \ Such\n   transmission would just be a waste of bandwidth.\n   The MTU available
      to ESADI payloads is at least 24 bytes less than\n   that available to TRILL
      IS-IS because of the additional fields\n   required ( 2(TRILL Ethertype) + 6(TRILL
      Header) + 6(Inner.MacDA) +\n   6(Inner.MacSA) + 4/8(Data Label) bytes ).  Thus,
      the inner ESADI\n   payload, starting with the Intradomain Routeing Protocol\n
      \  Discriminator byte, MUST NOT exceed Sz minus 24 for a VLAN ESADI\n   instance
      or Sz minus 28 for an FGL ESADI instance; however, if a\n   larger payload is
      received, it is processed normally (see [RFC6325]\n   and [RFC7180] for discussions
      of Sz and MTU).\n   In all cases where this document says that an ESADI PDU
      is multicast,\n   if the transmitting RBridge has only one neighbor and that
      neighbor\n   advertises support for unicast, the PDU MAY be unicast (see\n   Section
      4.1).\n   A priority bit to indicate that an LSP fragment should be flooded\n
      \  with high priority is provided by [RFC7356].  This bit SHOULD be set\n   on
      ESADI-LSP fragment zero because it is important that the ESADI\n   Parameter
      APPsub-TLV get through promptly.  This bit SHOULD NOT be\n   set on other ESADI-LSP
      fragments to avoid giving undue priority to\n   less urgent PDUs.\n"
    title: 4.2.  General Transmission of ESADI PDUs
  - contents:
    - "4.3.  General Receipt of ESADI PDUs\n   In contrast with Layer 3 IS-IS PDU
      acceptance tests, which check the\n   source inner and outer SNPA/MAC in order
      to verify that a PDU is from\n   an adjacent TRILL switch, in TRILL ESADI adjacency
      is based on the\n   system ID, so the system ID inside the PDU is all that is
      tested for.\n   If an ESADI instance believes that it has no ESADI neighbors,
      it\n   ignores any ESADI PDUs it receives.\n"
    title: 4.3.  General Receipt of ESADI PDUs
  - contents:
    - "4.4.  ESADI Reliable Flooding\n   The IS-IS reliable flooding mechanism (the
      Update Process) is\n   modified for ESADI in the ways listed below.  Except
      as otherwise\n   stated, the ESADI update process works as described in [IS-IS],\n
      \  [RFC1195], and [RFC7356].\n   When an ESADI instance sees that it has a new
      ESADI neighbor, its\n   self-originated ESADI-LSP fragments are scheduled to
      be sent and MAY\n   be unicast to that neighbor if the neighbor is announcing
      in its LSP\n   that it supports unicast ESADI (see Section 6.1).  If all the
      other\n   ESADI instances for the same Data Label send their self-originated\n
      \  ESADI-LSPs immediately, there may be a surge of traffic to that new\n   neighbor.
      \ Therefore, the ESADI instances SHOULD wait an interval of\n   time before
      sending their ESADI-LSP(s) to a new neighbor.  The\n   interval time value is
      up to the device implementation.  One\n   suggestion is that the interval time
      can be assigned a random value\n   with a range based on the RBridge's nickname
      (or any one of its\n   nicknames, if it holds more than one), such as ( 2000
      * nickname /\n   2**16 ) milliseconds, assuming \"nickname\" to be an unsigned
      quantity.\n   All the TRILL switches participating in an ESADI instance for
      some\n   Data Label appear to ESADI to be adjacent.  Thus, the originator of\n
      \  any active ESADI-LSP fragment always appears to be on link and, to\n   spread
      the burden of such a response, could be the RBridge to respond\n   to any ESADI-CSNP
      or PSNP request for that fragment.  However, under\n   very rare circumstances,
      it could be that some version of the LSP\n   fragment with a higher sequence
      number is actually held by another\n   ESADI RBridge on the link, so non-originators
      need to be able to\n   respond eventually.  Thus, when the receipt of a CSNP
      or PSNP causes\n   the SRMflag (Send Routing Message flag [IS-IS]) to be set
      for an LSP\n   fragment, action is as specified in [IS-IS] for the originating
      ESADI\n   RBridge of the fragment; however, at a non-originating ESADI RBridge,\n
      \  when changing the SRMflag from 0 to 1, the lastSent timestamp [IS-IS]\n   is
      also set to the current time minus\n          minimumLSPTransmissionInterval
      * Random (Jitter) / 100\n   (where minimumLSPTransmissionInterval, Random, and
      Jitter are as in\n   [IS-IS]).  This will delay and jitter the transmission
      of the LSP\n   fragment by non-originators.  This gives the originator more
      time to\n   send the fragment and provides more time for such an originator-\n
      \  transmitted copy to traverse the likely multi-hop path to\n   non-originators
      and clear the SRMflag for the fragment at\n   non-originators.\n   The multi-hop
      distribution tree method with Reverse Path Forwarding\n   Check used for multicast
      distribution by TRILL will typically be less\n   reliable than transmission
      over a single local broadcast link hop.\n   For LSP synchronization robustness,
      in addition to sending\n   ESADI-CSNPs as usual when it is the DRB, an ESADI
      RBridge SHOULD also\n   transmit an ESADI-CSNP for an ESADI instance if all
      of the following\n   conditions are met:\n   o  it sees one or more ESADI neighbors
      for that instance, and\n   o  it does not believe it is the DRB for the ESADI
      instance, and\n   o  it has not received or sent an ESADI-CSNP PDU for the instance
      for\n      the average of the CSNP Time (see Section 6.1) of the DRB and its\n
      \     CSNP Time.\n"
    title: 4.4.  ESADI Reliable Flooding
  title: 4.  ESADI PDU Processing
- contents:
  - "5.  End Station Addresses\n   The subsections below discuss end station address
    considerations in\n   the context of ESADI.\n"
  - contents:
    - "5.1.  Learning Confidence Level\n   The Confidence level mechanism [RFC6325]
      allows an RBridge campus\n   manager to cause certain address learning sources
      to prevail over\n   others.  MAC address information learned through a registration\n
      \  protocol, such as [802.1X] with a cryptographically based EAP\n   [RFC3748]
      method, might be considered more reliable than information\n   learned through
      the mere observation of data traffic.  When such\n   authenticated learned address
      information is transmitted via the\n   ESADI protocol, the use of authentication
      in the TRILL ESADI-LSP\n   packets could make tampering with it in transit very
      difficult.  As a\n   result, it might be reasonable to announce such authenticated\n
      \  information via the ESADI protocol with a high Confidence, so it\n   would
      be used in preference to any alternative learning from data\n   observation.\n"
    title: 5.1.  Learning Confidence Level
  - contents:
    - "5.2.  Forgetting End Station Addresses\n   The end station addresses learned
      through the TRILL ESADI protocol\n   should be forgotten through changes in
      ESADI-LSPs.  The timeout of\n   the learned end station address is up to the
      originating RBridge that\n   decides when to remove such information from its
      ESADI-LSPs (or up to\n   ESADI protocol timeouts if the originating RBridge
      becomes\n   unreachable).\n   If RBridge RBn participating in the TRILL ESADI
      protocol for Data\n   Label X no longer wishes to participate in ESADI, it ceases
      to\n   participate by (1) clearing the ESADI Participation bit in the\n   appropriate
      Interested VLANs or Interested Labels sub-TLV and (2)\n   sending a final ESADI-LSP
      nulling out its ESADI-LSP information.\n"
    title: 5.2.  Forgetting End Station Addresses
  - contents:
    - "5.3.  Duplicate MAC Address\n   With ESADI, it is possible to persistently
      see occurrences of the\n   same MAC address in the same Data Label being advertised
      as reachable\n   by two or more RBridges.  The specification of how to handle
      this\n   situation in [RFC6325] is updated by this document, by replacing the\n
      \  last sentence of the last paragraph of Section 4.2.6 of [RFC6325] as\n   shown
      below to provide better traffic-spreading while avoiding\n   possible address
      flip-flopping.\n   As background, assume some end station or set of end stations
      ESn\n   have two or more ports with the same MAC address in the same Data\n
      \  Label with the ports connected to different RBridges (RB1, RB2, ...)\n   by
      separate links.  With ESADI, some other RBridge, RB0, can\n   persistently see
      that MAC address in that Data Label connected to\n   multiple RBridges.  When
      RB0 ingresses a frame, say from ES0,\n   destined for that MAC and label, the
      current [RFC6325] text permits a\n   wide range of behavior.  In particular,
      [RFC6325] would permit RB0 to\n   use some rule, such as \"always encapsulate
      to the egress with the\n   lowest System ID\", which would put all of this traffic
      through only\n   one of the egress RBridges and one of the end station ports.
      \ With\n   that behavior, there would be no load-spreading, even if there were\n
      \  multiple different ingress RBridges and/or different MAC addresses\n   with
      the same reachability.  [RFC6325] would also permit RB0 to send\n   different
      traffic to different egresses by doing ECMP (Equal Cost\n   Multipath) at a
      flow level, which would likely result in return\n   traffic for RB0 to egress
      to ES0 from various of RB1, RB2, ... for\n   the same MAC and label.  The resulting
      address reachability\n   flip-flopping perceived at RB0 could cause problems.\n
      \  This update to [RFC6325] avoids these potential difficulties by\n   requiring
      that RB0 use one of the following two policies: (1) only\n   encapsulate to
      one egress RBridge for any particular MAC and label,\n   but select that egress
      pseudorandomly, based on the topology\n   (including MAC reachability) or (2)
      if RB0 will not be disturbed by\n   the returning TRILL Data packets showing
      the same MAC or by label\n   flip-flopping between different ingresses, RB0
      may use ECMP.\n   Assuming multiple ingress RBridges and/or multiple MAC and
      label\n   addresses, strategy 1 should result in load-spreading without address\n
      \  flip-flopping, while strategy 2 will produce better load-spreading\n   than
      strategy 1 but with address flip-flopping from the point of view\n   of RB0.\n
      \  OLD [RFC6325] Section 4.2.6 text:\n      \"... If confidences are also tied
      between the duplicates, for\n      consistency it is suggested that RB2 direct
      all such frames (or\n      all such frames in the same ECMP flow) toward the
      same egress\n      RBridge; however, the use of other policies will not cause
      a\n      network problem since transit RBridges do not examine the\n      Inner.MacDA
      for known unicast frames.\"\n   NEW [RFC6325] Section 4.2.6 text:\n      \"...
      If confidences are also tied between the duplicates, then RB2\n      MUST adopt
      one of the following two strategies:\n      1. In a pseudorandom way [RFC4086],
      select one of the egress\n         RBridges that is least cost from RB2 and
      to which the\n         destination MAC appears to be attached, and send all
      traffic\n         for the destination MAC and VLAN (or FGL [RFC7172]) to that\n
      \        egress.  This pseudorandom choice need only be changed when\n         there
      is a change in campus topology or MAC attachment\n         information.  Such
      pseudorandom selection will, over a\n         population of ingress RBridges,
      probabilistically spread\n         traffic over the possible egress RBridges.
      \ Reasonable inputs\n         to the pseudorandom selection are the ingress
      RBridge System ID\n         and/or nickname, the VLAN or FGL, the destination
      MAC address,\n         and a vector of the RBridges with connectivity to that
      MAC and\n         VLAN or FGL.  There is no need for different RBridges to use\n
      \        the same pseudorandom function.\n         As an example of such a pseudorandom
      function, if there are k\n         egress RBridges (RB0, RB1, ..., RB(k-1))
      all reporting\n         attachment to address MACx in Data Label DLy, then an
      ingress\n         RBridge RBin could select the one to which it will send all\n
      \        unicast TRILL Data packets addressed to MACx in DLy based on\n         the
      following:\n            FNV-32(RBin | MACx | DLy | RB0 | RB1 | ... | RB(k-1))
      mod k\n            where the FNV (Fowler/Noll/Vo) algorithm is specified in\n
      \           [FNV], RBx means the nickname for RBridge RBx, \"|\" means\n            concatenation,
      MACx is the destination MAC address, DLy is\n            the Data Label, and
      \"mod k\" means the integer division\n            remainder of the output of
      the FNV-32 function considered as\n            a positive integer divided by
      k.\n      2. If RB2 supports ECMP and will not be disturbed by return\n         traffic
      from the same MAC and VLAN (or FGL [RFC7172]) coming\n         from a variety
      of different RBridges, then it MAY send traffic\n         using ECMP at the
      flow level to the egress RBridges that are\n         least cost from RB2 and
      to which the destination MAC appears to\n         be attached.\"\n"
    title: 5.3.  Duplicate MAC Address
  title: 5.  End Station Addresses
- contents:
  - "6.  ESADI-LSP Contents\n   The only PDUs used in ESADI are the ESADI-LSP, ESADI-CSNP,
    and\n   ESADI-PSNP PDUs.  Currently, the contents of an ESADI-LSP consist of\n
    \  zero or more MAC-Reachability TLVs, optionally an Authentication TLV,\n   and
    exactly one ESADI parameter APPsub-TLV.  Other similar data may\n   be included
    in the future and, as in [IS-IS], an ESADI instance\n   ignores any TLVs or sub-TLVs
    it does not understand.  Because these\n   PDUs are formatted as Extended Level
    1 Circuit Scope (E-L1CS) PDUs\n   [RFC7356], the Type and Length fields in the
    TLVs are 16-bit.\n   This section specifies the format for the ESADI Parameter
    APPsub-TLV,\n   gives the reference for the ESADI MAC-Reachability TLV, and discusses\n
    \  default authentication configuration.\n   For robustness, the payload for an
    ESADI-LSP number zero and any\n   ESADI-CSNP or ESADI-PSNP covering fragment zero
    MUST NOT exceed 1470\n   minus 24 bytes in length (1446 bytes) if it has an Inner.VLAN,
    or\n   1470 minus 28 bytes (1442 bytes) if it has an Inner.FGL.  However, if\n
    \  an ESADI-LSP number zero or such an ESADI-CSNP or ESADI-PSNP is\n   received
    that is longer, it is still processed normally.  (As stated\n   in Section 4.3.1
    of [RFC6325], 1470 bytes was chosen to make it\n   extremely unlikely that a TRILL
    control packet, even with reasonable\n   additional headers, tags, and/or encapsulation,
    would encounter MTU\n   problems on an inter-RBridge link.)\n"
  - contents:
    - "6.1.  ESADI Parameter Data\n   Figure 4 presents the format of the ESADI parameter
      data.  This\n   APPsub-TLV MUST be included in a TRILL GENINFO TLV in ESADI-LSP\n
      \  number zero.  If it is missing from ESADI-LSP number zero or if\n   ESADI-LSP
      number zero is not known, priority for the sending RBridge\n   defaults to 0x40
      and CSNP Time defaults to 30.  If there is more than\n   one occurrence in ESADI-LSP
      number zero, the first occurrence will be\n   used.  Occurrences of the ESADI
      Parameter APPsub-TLV in non-zero\n   ESADI-LSP fragments are ignored.\n               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \              | Type                          |   (2 bytes)\n               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \              | Length                        |   (2 bytes)\n               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \              |R| Priority    |                   (1 byte)\n               +-+-+-+-+-+-+-+-+\n
      \              | CSNP Time     |                   (1 byte)\n               +-+-+-+-+-+-+-+-+\n
      \              | Flags         |                   (1 byte)\n               +---------------+\n
      \              | Reserved for expansion            (variable)\n               +-+-+-+-...\n
      \                  Figure 4: ESADI Parameter APPsub-TLV\n   Type: Set to ESADI-PARAM
      sub-TLV (TRILL APPsub-TLV type 0x0001).\n      Two bytes, because this APPsub-TLV
      appears in an extended TLV\n      [RFC7356].\n   Length: Variable, with a minimum
      of 3, but must fit within the ESADI\n      packet.  This field is encoded as
      an unsigned integer in network\n      byte order [RFC7356].\n   R: A reserved
      bit that MUST be sent as zero and ignored on receipt.\n   Priority: Gives the
      originating RBridge's priority for being the DRB\n      on the ESADI instance
      virtual link (see Section 3) for the Data\n      Label in which the PDU containing
      the parameter data was sent.  It\n      is an unsigned 7-bit integer with the
      larger magnitude indicating\n      higher priority.  It defaults to 0x40 for
      an RBridge participating\n      in ESADI for which it has not been configured.\n
      \  CSNP Time: An unsigned byte that gives the amount of time in seconds\n      during
      which the originating RBridge, if it is the DRB on the\n      ESADI virtual
      link, will send at least three ESADI-CSNP PDUs.  It\n      defaults to 30 seconds
      for an RBridge participating in ESADI for\n      which it has not been configured.\n
      \  Flags: A byte of flags associated with the originating ESADI\n      instance,
      as follows:\n                     0   1   2   3   4   5   6   7\n                  +---+---+---+---+---+---+---+---+\n
      \                 | UN|           RESV            |\n                  +---+---+---+---+---+---+---+---+\n
      \     The UN flag indicates that the RBridge originating the ESADI-LSP,\n      including
      this ESADI parameter data, will accept and properly\n      process ESADI PDUs
      sent by TRILL unicast (see Section 4.1).  The\n      remaining RESV bits are
      reserved for future use and MUST be sent\n      as zero and ignored on receipt.\n
      \  Reserved for future expansion: Future versions of the ESADI Parameter\n      APPsub-TLV
      may have additional information.  A receiving ESADI\n      RBridge ignores any
      additional data here, unless it implements\n      such future expansion(s).\n"
    title: 6.1.  ESADI Parameter Data
  - contents:
    - "6.2.  MAC-Reachability TLV\n   The primary information in TRILL ESADI-LSP PDUs
      consists of\n   MAC-Reachability (MAC-RI) TLVs specified in [RFC6165].  These
      TLVs\n   contain one or more unicast MAC addresses of end stations that are\n
      \  both on a port and in a VLAN for which the originating RBridge is\n   Appointed
      Forwarder, along with the 1-octet unsigned Confidence in\n   this information
      with a value in the range 0-254.  If such a TLV is\n   received containing a
      Confidence of 255, it is treated as if the\n   Confidence was 254.  (This is
      to assure that any received address\n   information can be overridden by local
      address information statically\n   configured with a Confidence of 255.)\n   The
      TLVs in TRILL ESADI PDUs, including the MAC-RI TLV, MUST NOT\n   contain the
      Data Label ID.  If a Data Label ID is present in the\n   MAC-RI TLV, it is ignored.
      \ In the ESADI PDU, only the Inner.VLAN or\n   Inner.FGL tag indicates the Data
      Label to which the ESADI-LSP\n   applies.\n"
    title: 6.2.  MAC-Reachability TLV
  - contents:
    - "6.3.  Default Authentication\n   The Authentication TLV may be included in
      ESADI PDUs [RFC5310]\n   [IS-IS].  The default for ESADI PDU authentication
      is based on the\n   state of TRILL IS-IS shared secret authentication for TRILL
      IS-IS LSP\n   PDUs.  If TRILL IS-IS authentication and ESADI are implemented
      at a\n   TRILL switch, then ESADI MUST be able to use the authentication\n   algorithms
      implemented for TRILL IS-IS and implement the keying\n   material derivation
      function given below.  If ESADI authentication\n   has been manually configured,
      that configuration is not restricted by\n   the configuration of TRILL IS-IS
      security.\n   If TRILL IS-IS authentication is not in effect for LSP PDUs\n
      \  originated by a TRILL switch, then ESADI PDUs originated by that\n   TRILL
      switch are by default also unsecured.\n   If such IS-IS LSP PDU authentication
      is in effect at a TRILL switch,\n   then, unless configured otherwise, ESADI
      PDUs sent by that switch\n   MUST use the same algorithm in their Authentication
      TLVs.  The ESADI\n   authentication keying material used is derived from the
      IS-IS LSP\n   shared secret keying material as detailed below.  However, such\n
      \  authentication MAY be configured to use some other keying material.\n           HMAC-SHA256
      ( \"TRILL ESADI\", IS-IS-LSP-shared-key )\n   In the algorithm above, HMAC-SHA256
      is as described in [FIPS180] and\n   [RFC6234], and \"TRILL ESADI\" is the 11-byte
      US ASCII [ASCII] string\n   indicated.  IS-IS-LSP-shared-key is secret keying
      material being used\n   by the originating TRILL switch for IS-IS LSP authentication.\n"
    title: 6.3.  Default Authentication
  title: 6.  ESADI-LSP Contents
- contents:
  - "7.  IANA Considerations\n   IANA allocation and registry considerations are given
    below.  Three\n   new sub-registries have been created in the \"Transparent\n
    \  Interconnection of Lots of Links (TRILL) Parameters\" registry located\n   at
    <http://www.iana.org/assignments/trill-parameters> -- two in\n   Section 7.1 and
    one in Section 7.2 -- and various code points have\n   been assigned.\n"
  - contents:
    - "7.1.  ESADI Participation and Capability Flags\n   IANA Action 1:\n      IANA
      has created the following new sub-registry called \"Interested\n      VLANs
      Flag Bits\" in the \"Transparent Interconnection of Lots of\n      Links (TRILL)
      Parameters\" registry.\n         Sub-registry: Interested VLANs Flag Bits\n
      \        Registration Procedures: IETF Review\n         Note: These bits appear
      in the Interested VLANs record within\n         the Interested VLANs and Spanning
      Tree Roots Sub-TLV (INT-VLAN)\n         specified in [RFC7176].\n         References:
      [RFC7176], [RFC7357]\n       Bit  Mnemonic  Description                      Reference\n
      \      ---  --------  -----------                      ---------\n         0
      \    M4     IPv4 Multicast Router Attached   [RFC7176]\n         1     M6     IPv6
      Multicast Router Attached   [RFC7176]\n         2      -     Unassigned\n         3
      \    ES     ESADI Participation              [RFC7357]\n        4-15    -     (used
      for a VLAN ID)             [RFC7176]\n       16-19    -     Unassigned\n       20-31
      \   -     (used for a VLAN ID)             [RFC7176]\n      The creation of
      this sub-registry (as immediately above) assigned\n      bit 3 as the ESADI
      Participation bit in the Interested VLANs and\n      Spanning Tree Roots sub-TLV.
      \ If The ESADI Participation bit is a\n      one, it indicates that the originating
      RBridge is participating in\n      ESADI for the indicated Data Label(s).\n
      \  IANA Action 2:\n      IANA has created the following new sub-registry called
      \"Interested\n      Labels Flag Bits\" in the \"Transparent Interconnection
      of Lots of\n      Links (TRILL) Parameters\" registry.\n         Sub-registry:
      Interested Labels Flag Bits\n         Registration Procedures: IETF Review\n
      \        Note: These bits appear in the Interested Labels record within\n         the
      Interested Labels and Spanning Tree Roots Sub-TLV\n         (INT-LABEL) specified
      in [RFC7176].\n         References: [RFC7176], [RFC7357]\n      Bit  Mnemonic
      \ Description                      Reference\n      ---  --------  -----------
      \                     ---------\n        0     M4     IPv4 Multicast Router
      Attached   [RFC7176]\n        1     M6     IPv6 Multicast Router Attached   [RFC7176]\n
      \       2     BM     Bit Map                          [RFC7176]\n        3     ES
      \    ESADI Participation              [RFC7357]\n       4-7     -     Unassigned\n
      \     The creation of this sub-registry (as immediately above) assigned\n      bit
      3 as the ESADI Participation bit in the Interested Labels and\n      Spanning
      Tree Roots sub-TLV.  If The ESADI Participation bit is a\n      one, it indicates
      that the originating RBridge is participating in\n      ESADI for the indicated
      Data Label(s).\n"
    title: 7.1.  ESADI Participation and Capability Flags
  - contents:
    - "7.2.  TRILL GENINFO TLV\n   IANA Action 3:\n      IANA has allocated the IS-IS
      Application Identifier 1 under the\n      Generic Information TLV (#251) [RFC6823]
      for TRILL.\n   IANA Action 4:\n      IANA has created a sub-registry in the
      \"Transparent\n      Interconnection of Lots of Links (TRILL) Parameters\" registry
      as\n      follows:\n         Sub-registry:  TRILL APPsub-TLV Types under IS-IS
      TLV 251\n                        Application Identifier 1\n         Registration
      Procedures: IETF Review with additional\n            requirements on the documentation
      of the use being\n            registered as specified in Section 7.2 of [RFC7357].\n
      \        Note: Types greater than 255 are only usable in contexts\n         permitting
      a type larger than one byte, such as extended TLVs\n         [RFC7356].\n         Reference:
      [RFC7357]\n                Type      Name              Reference\n             ----------
      \ --------          -----------\n                     0   Reserved          [RFC7357]\n
      \                    1   ESADI-PARAM       [RFC7357]\n                 2-254
      \  Unassigned        [RFC7357]\n                   255   Reserved          [RFC7357]\n
      \            256-65534   Unassigned        [RFC7357]\n                 65535
      \  Reserved          [RFC7357]\n      TRILL APPsub-TLV Types 2 through 254 and
      256 through 65534 are\n      available for assignment by IETF Review.  The RFC
      causing such an\n      assignment will also include a discussion of security
      issues and\n      of the rate of change of the information being advertised.
      \ TRILL\n      APPsub-TLVs MUST NOT alter basic IS-IS protocol operation\n      including
      the establishment of adjacencies, the update process,\n      and the decision
      process for TRILL IS-IS [IS-IS] [RFC1195]\n      [RFC7177].  The TRILL Generic
      Information TLV MUST NOT be used in\n      an IS-IS instance zero [RFC6822]
      LSP but may be used in Flooding\n      Scoped LSPs (FS-LSPs) [RFC7356].\n   The
      V, I, D, and S flags in the initial flags byte of a TRILL Generic\n   Information
      TLV have the meanings specified in [RFC6823] but are not\n   currently used,
      as TRILL operates as a Level 1 IS-IS area and no\n   semantics are hereby assigned
      to the inclusion of an IPv4 and/or IPv6\n   address via the I and V flags.  Thus,
      these I and V flags MUST be\n   zero; however, if either or both are one, the
      space that should be\n   taken by an IPv4 and/or IPv6 address, respectively,
      is skipped over\n   and ignored.  Furthermore, the use of multilevel IS-IS is
      an obvious\n   extension for TRILL [MultiLevel], and future IETF Standards Actions\n
      \  may update or obsolete this specification to provide for the use of\n   any
      or all of these flags in the TRILL GENINFO TLV.\n   The ESADI Parameters information,
      for which TRILL APPsub-TLV 1 is\n   hereby assigned, is compact and slow changing
      (see Section 6.1).\n   For security considerations related to ESADI and the
      ESADI Parameter\n   APPsub-TLV, see Section 8.\n"
    title: 7.2.  TRILL GENINFO TLV
  title: 7.  IANA Considerations
- contents:
  - "8.  Security Considerations\n   ESADI PDUs can be authenticated through the inclusion
    of the\n   Authentication TLV [RFC5310].  Defaults for such authentication are\n
    \  described in Section 6.3.\n   The ESADI-LSP data primarily announces MAC address
    reachability\n   within a Data Label.  Such reachability can, in some cases, be
    an\n   authenticated registration (for example, a Layer 2 authenticated\n   registration
    using cryptographically based EAP (Extensible\n   Authentication Protocol [RFC3748])
    methods via [802.1X]).  The\n   combination of these techniques can cause ESADI
    MAC reachability\n   information to be substantially more trustworthy than MAC\n
    \  reachability learned from observation of the data plane.\n   Nevertheless,
    ESADI still involves trusting all other RBridges in the\n   TRILL campus, at least
    those that have the keying material necessary\n   to construct a valid Authentication
    TLV.\n   However, there may be cases where authenticated registration is used\n
    \  for end stations, because of a significant threat of forged packets\n   on
    end station links, but it is not necessary to authenticate ESADI\n   PDUs because
    that threat is not present for inter-RBridge trunks.\n   For example, a TRILL
    campus with secure RBridges and inter-RBridge\n   links configured as trunks but
    with some end stations connected via\n   IEEE 802.11 wireless access links might
    use 802.11 authentication for\n   the connection of such end stations but might
    not necessarily\n   authenticate ESADI PDUs.  Note that if the IS-IS LSPs in a
    TRILL\n   campus are authenticated, perhaps due to a concern about forged\n   packets,
    the ESADI PDUs will be authenticated by default as provided\n   in Section 6.3.\n
    \  MAC reachability learned from the data plane (the TRILL default) is\n   overwritten
    by any future learning of the same type.  ESADI\n   advertisements are represented
    in the Data Label scoped link state\n   database.  Thus, ESADI makes visible any
    multiple attachments of the\n   same MAC address within a Data Label to different
    RBridges (see\n   Section 5.3).  This may or may not be an error or misconfiguration,\n
    \  but ESADI at least makes it explicitly and persistently visible,\n   which
    would not be the case with data plane learning.\n   For general TRILL security
    considerations, see [RFC6325].\n"
  - contents:
    - "8.1.  Privacy Considerations\n   The address reachability information distributed
      by ESADI has\n   substantial privacy considerations under many, but not all,\n
      \  circumstances.\n   For example, if ESADI were used in a TRILL campus with
      independent\n   user end stations at the edge, the MAC addresses of such end
      stations\n   could uniquely identify the users of those end stations.  Their\n
      \  reachability would be sensitive information and, particularly if\n   logged,
      could reveal such user information.  On the other hand, if\n   TRILL is being
      used to implement an Internet Exchange Point (IXP) to\n   connect Internet Service
      Providers (ISPs), the MAC addresses being\n   advertised in ESADI would typically
      be those of the ISP's directly\n   connected IP router ports, since Layer 3
      routers bound the TRILL\n   campus, for which there would be few privacy concerns.\n
      \  However, records of MAC attachment that include a modest amount of\n   history,
      perhaps a few days' worth, can be useful in managing a\n   network and troubleshooting
      network problems.  It might, in some\n   cases, also be legally required, or
      required for billing purposes or\n   the like.\n   Network operators should
      seek a reasonable balance between these\n   competing considerations, customized
      for the circumstances of their\n   particular networks where ESADI is in use.
      \ They should not maintain\n   logs of MAC reachability information for any
      longer than is clearly\n   required.\n"
    title: 8.1.  Privacy Considerations
  title: 8.  Security Considerations
- contents:
  - "9.  Acknowledgements\n   The authors thank the following, listed in alphabetic
    order, for\n   their suggestions and contributions:\n      David Black, Somnath
    Chatterjee, Adrian Farrel, Stephen Farrell,\n      Sujay Gupta, Russ Housley,
    Pearl Liang, Kathleen Moriarty, Thomas\n      Narten, Erik Nordmark, and Mingui
    Zhang.\n"
  title: 9.  Acknowledgements
- contents:
  - '10.  References

    '
  - contents:
    - "10.1.  Normative References\n   [ASCII]    American National Standards Institute
      (formerly United\n              States of America Standards Institute), \"USA
      Code for\n              Information Interchange\", ANSI X3.4-1968, 1968.\n              ANSI
      X3.4-1968 has been replaced by newer versions with\n              slight modifications,
      but the 1968 version remains\n              definitive for the Internet.\n   [FIPS180]
      \ \"Secure Hash Standard (SHS)\", National Institute of\n              Standards
      and Technology, Federal Information Processing\n              Standard (FIPS)
      180-4, March 2012, <http://csrc.nist.gov/\n              publications/fips/fips180-4/fips-180-4.pdf>.\n
      \  [IS-IS]    ISO/IEC 10589:2002, Second Edition, \"Information\n              technology
      -- Telecommunications and information exchange\n              between systems
      -- Intermediate System to Intermediate\n              System intra-domain routeing
      information exchange protocol\n              for use in conjunction with the
      protocol for providing the\n              connectionless-mode network service
      (ISO 8473)\", 2002.\n   [RFC1195]  Callon, R., \"Use of OSI IS-IS for routing
      in TCP/IP and\n              dual environments\", RFC 1195, December 1990.\n
      \  [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n              Requirement
      Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC4086]  Eastlake 3rd, D., Schiller,
      J., and S. Crocker,\n              \"Randomness Requirements for Security\",
      BCP 106, RFC 4086,\n              June 2005.\n   [RFC5226]  Narten, T. and H.
      Alvestrand, \"Guidelines for Writing an\n              IANA Considerations Section
      in RFCs\", BCP 26, RFC 5226,\n              May 2008.\n   [RFC5310]  Bhatia,
      M., Manral, V., Li, T., Atkinson, R., White, R.,\n              and M. Fanto,
      \"IS-IS Generic Cryptographic\n              Authentication\", RFC 5310, February
      2009.\n   [RFC6165]  Banerjee, A. and D. Ward, \"Extensions to IS-IS for Layer-2\n
      \             Systems\", RFC 6165, April 2011.\n   [RFC6325]  Perlman, R., Eastlake
      3rd, D., Dutt, D., Gai, S., and A.\n              Ghanwani, \"Routing Bridges
      (RBridges): Base Protocol\n              Specification\", RFC 6325, July 2011.\n
      \  [RFC6361]  Carlson, J. and D. Eastlake 3rd, \"PPP Transparent\n              Interconnection
      of Lots of Links (TRILL) Protocol Control\n              Protocol\", RFC 6361,
      August 2011.\n   [RFC6823]  Ginsberg, L., Previdi, S., and M. Shand, \"Advertising\n
      \             Generic Information in IS-IS\", RFC 6823, December 2012.\n   [RFC7172]
      \ Eastlake 3rd, D., Zhang, M., Agarwal, P., Perlman, R., and\n              D.
      Dutt, \"Transparent Interconnection of Lots of Links\n              (TRILL):
      Fine-Grained Labeling\", RFC 7172, May 2014.\n   [RFC7176]  Eastlake 3rd, D.,
      Senevirathne, T., Ghanwani, A., Dutt,\n              D., and A. Banerjee, \"Transparent
      Interconnection of Lots\n              of Links (TRILL) Use of IS-IS\", RFC
      7176, May 2014.\n   [RFC7177]  Eastlake 3rd, D., Perlman, R., Ghanwani, A.,
      Yang, H., and\n              V. Manral, \"Transparent Interconnection of Lots
      of Links\n              (TRILL): Adjacency\", RFC 7177, May 2014.\n   [RFC7180]
      \ Eastlake 3rd, D., Zhang, M., Ghanwani, A., Manral, V., and\n              A.
      Banerjee, \"Transparent Interconnection of Lots of Links\n              (TRILL):
      Clarifications, Corrections, and Updates\",\n              RFC 7180, May 2014.\n
      \  [RFC7356]  Ginsberg, L., Previdi, S., and Y. Yang, \"IS-IS Flooding\n              Scope
      Link State PDUs (LSPs)\", RFC 7356, September 2014.\n"
    title: 10.1.  Normative References
  - contents:
    - "10.2.  Informative References\n   [802.1X]   IEEE 802.1, \"IEEE Standard for
      Local and metropolitan area\n              networks--Port-Based Network Access
      Control\", IEEE\n              Standard 802.1X-2010, February 2010.\n   [FNV]
      \     Fowler, G., Noll, L., Vo, K., and D. Eastlake 3rd, \"The\n              FNV
      Non-Cryptographic Hash Algorithm\", Work in Progress,\n              April 2014.\n
      \  [MultiLevel]\n              Perlman, R., Eastlake 3rd, D., Ghanwani, A.,
      and H. Zhai,\n              \"Flexible Multilevel TRILL (Transparent Interconnection
      of\n              Lots of Links)\", Work in Progress, June 2014.\n   [RFC3748]
      \ Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.\n              Levkowetz,
      Ed., \"Extensible Authentication Protocol\n              (EAP)\", RFC 3748,
      June 2004.\n   [RFC6234]  Eastlake 3rd, D. and T. Hansen, \"US Secure Hash Algorithms\n
      \             (SHA and SHA-based HMAC and HKDF)\", RFC 6234, May 2011.\n   [RFC6822]
      \ Previdi, S., Ed., Ginsberg, L., Shand, M., Roy, A., and D.\n              Ward,
      \"IS-IS Multi-Instance\", RFC 6822, December 2012.\n   [VLANmapping]\n              Perlman,
      R., Rijhsinghani, A., Eastlake 3rd, D., Banerjee,\n              A., and D.
      Dutt, \"TRILL: Campus Label and Priority\n              Regions\", Work in Progress,
      January 2014.\n"
    title: 10.2.  Informative References
  title: 10.  References
- contents:
  - "Appendix A.  Interoperability and Changes to RFC 6325\n   This appendix summarizes
    the significant changes this document makes\n   to the TRILL base protocol specification
    [RFC6325].  Although\n   simultaneous use of [RFC6325] ESADI and ESADI as specified
    in this\n   document in a TRILL campus is very unlikely due to non-deployment
    of\n   [RFC6325] ESADI, this appendix also discusses, for each change, the\n   interoperability
    considerations should such simultaneous use occur.\n"
  - contents:
    - "A.1.  ESADI PDU Changes\n   The format of ESADI-LSP, ESADI-CSNP, and ESADI-PSNP
      PDU payloads is\n   changed from the IS-IS Level 1 format [IS-IS] to the Extended
      Level 1\n   Circuit Scope format (E-L1CS) specified in [RFC7356].  This change
      is\n   not backwards compatible with [RFC6325].  It is made in light of the\n
      \  information-carrying capacity of the E-L1CS format, which is\n   256 times
      greater than that of the base IS-IS format.  It is\n   anticipated that this
      greater information-carrying capacity will be\n   needed, under some circumstances,
      to carry end station addressing\n   information or other similar address and
      reachability information\n   when it is added to ESADI in the future.\n   The
      PDU numbers used for the ESADI LSP, CSNP, and PSNP PDUs in\n   [RFC6325] are
      18, 24, and 26 [IS-IS].  With this document, the format\n   changes, and the
      PDU numbers change to 10, 11, and 12 [RFC7356].  The\n   use of different PDU
      numbers assures that a PDU will not be\n   mis-parsed.  Because of this, implementations
      of this document and\n   implementations of [RFC6325] ESADI will discard each
      other's PDUs.\n   Thus, address reachability or other information distributed
      through\n   either type of ESADI implementation will only be communicated to\n
      \  other implementations of the same type, and the two communities will\n   not
      communicate any information with each other.\n   Note that RBridges can use
      the TRILL mandatory-to-implement,\n   enabled-by-default data plane address
      learning in addition to ESADI.\n   (Section 5 of this document and the material
      it references explain\n   how to handle conflicts between different sources
      of address\n   reachability information.)  Simply leaving data plane address\n
      \  learning enabled would enable smooth incremental migration from\n   [RFC6325]
      ESADI to the ESADI specification in this document, should\n   that be necessary.
      \ The data plane address learning would fill in any\n   gaps due to non-communication
      between the two types of ESADI\n   implementations, although without the speed
      or security advantages\n   of ESADI.\n"
    title: A.1.  ESADI PDU Changes
  - contents:
    - "A.2.  Unicasting Changes\n   Unicasting of ESADI PDUs is optionally supported,
      including replacing\n   Section 4.6.2.2 of [RFC6325] with the new text given
      in Section 4.1\n   of this document.  This unicast support is backwards compatible\n
      \  because it is only used when the recipient RBridge signals its\n   support.\n"
    title: A.2.  Unicasting Changes
  - contents:
    - "A.3.  Message Timing Changes and Suggestions\n   The following timing-related
      ESADI message changes and suggestions\n   are included in this document:\n   1.
      Provide for staggered delay for non-originators of ESADI-LSP\n      fragments
      in response to requests for such fragments by CSNP and\n      PSNP messages.\n
      \  2. Suggest staggered timing of unicast ESADI-LSPs when a new ESADI\n      RBridge
      appears on the ESADI virtual link.\n   These relate only to the timing of messages
      for congestion\n   minimization.  Should a message be lost, due to congestion
      or\n   otherwise, it will be later retransmitted as a normal part of the\n   robust
      flooding mechanism used by ESADI.\n"
    title: A.3.  Message Timing Changes and Suggestions
  - contents:
    - "A.4.  Duplicate Address Reachability\n   The handling of persistent reachability
      of the same MAC within the\n   same Data Label from two or more RBridges is
      substantially modified,\n   including the explicit replacement of some text
      in Section 4.2.6 of\n   [RFC6325] (see Section 5.3 of this document).  There
      is no problem\n   with a mixture of ESADI implementations in a TRILL campus,
      some\n   conforming to [RFC6325] and some conforming to this document, for\n
      \  handling this condition.  The more implementations conform to the\n   improved
      behavior specified in this document for this condition, the\n   better the traffic-spreading
      will be, and the less likely address\n   flip-flopping problems will be.\n"
    title: A.4.  Duplicate Address Reachability
  title: Appendix A.  Interoperability and Changes to RFC 6325
- contents:
  - "Authors' Addresses\n   Hongjun Zhai\n   ZTE Corporation\n   68 Zijinghua Road\n
    \  Nanjing 200012\n   China\n   Phone: +86-25-52877345\n   EMail: zhai.hongjun@zte.com.cn\n
    \  Fangwei Hu\n   ZTE Corporation\n   889 Bibo Road\n   Shanghai 201203\n   China\n
    \  Phone: +86-21-68896273\n   EMail: hu.fangwei@zte.com.cn\n   Radia Perlman\n
    \  EMC\n   2010 256th Ave. NE, #200\n   Bellevue, WA  98007\n   USA\n   EMail:
    Radia@alum.mit.edu\n   Donald Eastlake 3rd\n   Huawei Technologies\n   155 Beaver
    Street\n   Milford, MA  01757\n   USA\n   Phone: +1-508-333-2270\n   EMail: d3e3e3@gmail.com\n
    \  Olen Stokes\n   Extreme Networks\n   2121 RDU Center Drive, Suite 300\n   Morrisville,
    NC  27560\n   USA\n   EMail: ostokes@extremenetworks.com\n"
  title: Authors' Addresses
