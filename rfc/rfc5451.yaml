- title: __initial_text__
  contents:
  - '   Message Header Field for Indicating Message Authentication Status

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n"
- title: Abstract
  contents:
  - "Abstract\n   This memo defines a new header field for use with electronic mail\n\
    \   messages to indicate the results of message authentication efforts.\n   Any\
    \ receiver-side software, such as mail filters or Mail User Agents\n   (MUAs),\
    \ may use this message header field to relay that information\n   in a convenient\
    \ way to users or to make sorting and filtering\n   decisions.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n     1.1.  Purpose  . . . . . . . . . . . . . . . . . . . .\
    \ . . . . .  4\n     1.2.  Trust Boundary . . . . . . . . . . . . . . . . . .\
    \ . . . .  4\n     1.3.  Processing Scope . . . . . . . . . . . . . . . . . .\
    \ . . .  5\n     1.4.  Requirements . . . . . . . . . . . . . . . . . . . . .\
    \ . .  5\n     1.5.  Definitions  . . . . . . . . . . . . . . . . . . . . . .\
    \ .  5\n       1.5.1.  General  . . . . . . . . . . . . . . . . . . . . . . .\
    \  5\n       1.5.2.  Security . . . . . . . . . . . . . . . . . . . . . . .  5\n\
    \       1.5.3.  Email Architecture . . . . . . . . . . . . . . . . . .  6\n  \
    \   1.6.  Trust Environment  . . . . . . . . . . . . . . . . . . . .  7\n   2.\
    \  Definition and Format of the Header Field  . . . . . . . . . .  8\n     2.1.\
    \  General Description  . . . . . . . . . . . . . . . . . . .  8\n     2.2.  Formal\
    \ Definition  . . . . . . . . . . . . . . . . . . . .  8\n     2.3.  Authentication\
    \ Identifier Field  . . . . . . . . . . . . . 10\n     2.4.  Result Values  .\
    \ . . . . . . . . . . . . . . . . . . . . . 12\n       2.4.1.  DKIM and DomainKeys\
    \ Results  . . . . . . . . . . . . . 12\n       2.4.2.  SPF and Sender-ID Results\
    \  . . . . . . . . . . . . . . 13\n       2.4.3.  \"iprev\" Results  . . . . .\
    \ . . . . . . . . . . . . . . 14\n       2.4.4.  SMTP AUTH Results  . . . . .\
    \ . . . . . . . . . . . . . 14\n       2.4.5.  Extension Result Codes . . . .\
    \ . . . . . . . . . . . . 15\n     2.5.  Authentication Methods . . . . . . .\
    \ . . . . . . . . . . . 15\n       2.5.1.  Definition of Initial Methods  . .\
    \ . . . . . . . . . . 16\n       2.5.2.  Extension Methods  . . . . . . . . .\
    \ . . . . . . . . . 16\n   3.  The \"iprev\" Authentication Method  . . . . .\
    \ . . . . . . . . . 17\n   4.  Adding the Header Field to A Message . . . . .\
    \ . . . . . . . . 18\n     4.1.  Header Field Position and Interpretation . .\
    \ . . . . . . . 19\n     4.2.  Local Policy Enforcement . . . . . . . . . . .\
    \ . . . . . . 20\n   5.  Removing the Header Field  . . . . . . . . . . . . .\
    \ . . . . . 20\n   6.  IANA Considerations  . . . . . . . . . . . . . . . . .\
    \ . . . . 22\n     6.1.  The Authentication-Results Header Field  . . . . . .\
    \ . . . 22\n     6.2.  Email Authentication Method Name Registry  . . . . . .\
    \ . . 22\n     6.3.  Email Authentication Result Name Registry  . . . . . . .\
    \ . 24\n   7.  Security Considerations  . . . . . . . . . . . . . . . . . . .\
    \ 26\n     7.1.  Forged Header Fields . . . . . . . . . . . . . . . . . . . 26\n\
    \     7.2.  Misleading Results . . . . . . . . . . . . . . . . . . . . 27\n  \
    \   7.3.  Header Field Position  . . . . . . . . . . . . . . . . . . 28\n    \
    \ 7.4.  Reverse IP Query Denial-of-Service Attacks . . . . . . . . 28\n     7.5.\
    \  Mitigation of Backscatter  . . . . . . . . . . . . . . . . 28\n     7.6.  Internal\
    \ MTA Lists . . . . . . . . . . . . . . . . . . . . 28\n     7.7.  Attacks against\
    \ Authentication Methods . . . . . . . . . . 28\n     7.8.  Intentionally Malformed\
    \ Header Fields  . . . . . . . . . . 29\n     7.9.  Compromised Internal Hosts\
    \ . . . . . . . . . . . . . . . . 29\n     7.10. Encapsulated Instances . . .\
    \ . . . . . . . . . . . . . . . 29\n     7.11. Reverse Mapping  . . . . . . .\
    \ . . . . . . . . . . . . . . 29\n   8.  References . . . . . . . . . . . . .\
    \ . . . . . . . . . . . . . 30\n     8.1.  Normative References . . . . . . .\
    \ . . . . . . . . . . . . 30\n     8.2.  Informative References . . . . . . .\
    \ . . . . . . . . . . . 30\n   Appendix A.  Legacy MUAs . . . . . . . . . . .\
    \ . . . . . . . . . . 32\n   Appendix B.  Authentication-Results Examples . .\
    \ . . . . . . . . . 33\n     B.1.  Trivial Case; Header Field Not Present . .\
    \ . . . . . . . . 33\n     B.2.  Nearly Trivial Case; Service Provided, But No\n\
    \           Authentication Done  . . . . . . . . . . . . . . . . . . . 34\n  \
    \   B.3.  Service Provided, Authentication Done  . . . . . . . . . . 35\n    \
    \ B.4.  Service Provided, Several Authentications Done, Single\n           MTA\
    \  . . . . . . . . . . . . . . . . . . . . . . . . . . . 36\n     B.5.  Service\
    \ Provided, Several Authentications Done,\n           Different MTAs . . . . .\
    \ . . . . . . . . . . . . . . . . . 37\n     B.6.  Service Provided, Multi-Tiered\
    \ Authentication Done . . . . 39\n   Appendix C.  Operational Considerations about\
    \ Message\n                Authentication  . . . . . . . . . . . . . . . . . .\
    \ . 41\n   Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . .\
    \ 43\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This memo defines a new header field for electronic mail\
    \ messages\n   that presents the results of a message authentication effort in\
    \ a\n   machine-readable format.  The intent is to create a place to collect\n\
    \   such data when message authentication mechanisms are in use so that a\n  \
    \ Mail User Agent (MUA) and downstream filters can make filtering\n   decisions\
    \ and/or provide a recommendation to the user as to the\n   validity of the message's\
    \ origin and possibly the integrity of its\n   content.\n   End users are not\
    \ expected to be direct consumers of this header\n   field.  This header field\
    \ is intended for consumption by programs\n   that will then use or render such\
    \ data in a human-usable form.\n   This memo defines both the format of this new\
    \ header field and\n   discusses the implications of its presence or absence.\
    \  However, it\n   does not discuss how the data contained in the header field\
    \ should be\n   used (i.e. what filtering decisions are appropriate, or how an\
    \ MUA\n   might render these results) as these are local policy and/or user\n\
    \   interface design questions that are not appropriate for this memo.\n   At\
    \ the time of publication of this memo, [AUTH], [DKIM],\n   [DOMAINKEYS], [SENDERID],\
    \ and [SPF] are published DNS domain-level\n   email authentication methods in\
    \ common use.  This proposal is not\n   intended to be restricted to domain-based\
    \ authentication, but this\n   has proven to be a good starting point for implementations.\
    \  As\n   various methods emerge, it is necessary to prepare for their\n   appearance\
    \ and encourage convergence in the area of interfacing\n   verifiers to filters\
    \ and MUAs.\n   Although [SPF] defined a header field called Received-SPF and\n\
    \   [DOMAINKEYS] defined one called DomainKey-Status for this purpose,\n   those\
    \ header fields are specific to the conveyance of their\n   respective results\
    \ only and thus are insufficient to satisfy the\n   requirements enumerated below.\n"
- title: 1.1.  Purpose
  contents:
  - "1.1.  Purpose\n   The header field defined in this memo is expected to serve\
    \ several\n   purposes:\n   1.  Convey the results of various message authentication\
    \ checks being\n       applied by upstream filters and Mail Transfer Agents (MTAs)\
    \ to\n       MUAs and downstream filters within the same \"trust domain\", as\n\
    \       such agents may wish to render those results to end users or use\n   \
    \    that data to apply more or less stringent content checks based on\n     \
    \  authentication results;\n   2.  Provide a common location within a message\
    \ for this data;\n   3.  Create an extensible framework for reporting new authentication\n\
    \       methods as they emerge.\n   In particular, the mere presence of this header\
    \ field should not be\n   construed as meaning that its data is valid, but rather\
    \ that it is\n   asserting validity based on one or more authentication schemes\n\
    \   somewhere upstream.  For an MUA or downstream filter to treat the\n   assertions\
    \ as actually valid, there must be an assessment of the\n   trust relationship\
    \ between such agents and the validating MTA.\n"
- title: 1.2.  Trust Boundary
  contents:
  - "1.2.  Trust Boundary\n   This document makes several references to the \"trust\
    \ boundary\" of an\n   administrative management domain (ADMD).  Given the diversity\
    \ among\n   existing mail environments, a precise definition of this term isn't\n\
    \   possible.\n   Simply put, a transfer from the creator of the header field\
    \ to the\n   consumer must occur within a context of trust that the creator's\n\
    \   information is correct.  How this trust is obtained is outside the\n   scope\
    \ of this document.  It is entirely a local matter.\n   Thus, this document defines\
    \ a \"trust boundary\" as the delineation\n   between \"external\" and \"internal\"\
    \ entities; \"external\" here includes\n   all hosts that do not deliberately\
    \ provide some kind of messaging\n   service for the receiving ADMD's users, and\
    \ \"internal\" includes those\n   hosts that do.  By this definition, the hosts\
    \ within a \"trust\n   boundary\" may lie entirely within a receiving ADMD's direct\
    \ control,\n   or they can include hosts managed by another ADMD (such as an ISP\
    \ or\n   commercial filtering service) but that also provide services for the\n\
    \   former.\n"
- title: 1.3.  Processing Scope
  contents:
  - "1.3.  Processing Scope\n   This proposal is intended to address the needs of\
    \ authenticating\n   messages or properties of messages during their actual transport.\
    \  It\n   is not meant to address the security of messages that might be\n   encapsulated\
    \ within other messages, such as a message/rfc822 [MIME]\n   part within a message.\n"
- title: 1.4.  Requirements
  contents:
  - "1.4.  Requirements\n   This memo establishes no new requirements on existing\
    \ protocols or\n   servers.\n   In particular, this memo establishes no requirement\
    \ on MTAs to reject\n   or filter arriving messages that do not pass authentication\
    \ checks.\n   The data conveyed by the defined header field's contents are for\
    \ the\n   information of MUAs and filters and should be used at their\n   discretion.\n"
- title: 1.5.  Definitions
  contents:
  - "1.5.  Definitions\n   This section defines various terms used throughout this\
    \ document.\n"
- title: 1.5.1.  General
  contents:
  - "1.5.1.  General\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [KEYWORDS].\n"
- title: 1.5.2.  Security
  contents:
  - "1.5.2.  Security\n   [SECURITY] discusses authentication and authorization and\
    \ the\n   conflation of the two concepts.  The use of those terms within the\n\
    \   context of recent message-security work has given rise to slightly\n   different\
    \ definitions, and this document reflects those current\n   usages, as follows:\n\
    \   o  \"Authorization\" is the establishment of permission to use a\n      resource\
    \ or represent an identity.  In this context, authorization\n      indicates that\
    \ a message from a particular ADMD arrived via a\n      route the ADMD has explicitly\
    \ approved.\n   o  \"Authentication\" is the assertion of validity of a piece\
    \ of data\n      about a message (such as the sender's identity) or the message\
    \ in\n      its entirety.\n   As examples: [SPF] and [SENDERID] are authorization\
    \ mechanisms in\n   that they express a result that shows whether or not the ADMD\
    \ that\n   apparently sent the message has explicitly authorized the connecting\n\
    \   [SMTP] client to relay messages on its behalf but do not actually\n   validate\
    \ any property of the message itself.  By contrast, [DKIM] is\n   agnostic as\
    \ to the routing of a message but uses cryptographic\n   signatures to authenticate\
    \ agents claiming responsibility for the\n   message (which implies authorization)\
    \ and ensure it was not modified\n   in transit.  Since the signatures are not\
    \ tied to SMTP connections,\n   they can be added by either the ADMD of origin,\
    \ intermediate ADMDs\n   (such as a mailing list server), or both.\n   Rather\
    \ than create a separate header field for each class of\n   solution, this proposal\
    \ groups them both into a single header field.\n"
- title: 1.5.3.  Email Architecture
  contents:
  - "1.5.3.  Email Architecture\n   o  A \"border MTA\" is an MTA that acts as a gateway\
    \ between the\n      general Internet and the users within an organizational boundary.\n\
    \      (See also Section 1.2.)\n   o  A \"delivery MTA\" (or Mail Delivery Agent\
    \ or MDA) is an MTA that\n      actually enacts delivery of a message to a user's\
    \ inbox or other\n      final delivery.\n   o  An \"intermediate MTA\" is an MTA\
    \ that handles messages after a\n      border MTA and before a delivery MTA.\n\
    \   The following diagram illustrates the flow of mail among these\n   defined\
    \ components:\n                          +-----+   +-----+   +------------+\n\
    \                          | MUA |-->| MSA |-->| Border MTA |\n              \
    \            +-----+   +-----+   +------------+\n                            \
    \                        |\n                                                 \
    \   |\n                                                    V\n               \
    \                                +----------+\n                              \
    \                 | Internet |\n                                             \
    \  +----------+\n                                                    |\n     \
    \                                               |\n                          \
    \                          V\n   +-----+   +-----+   +------------------+   +------------+\n\
    \   | MUA |<--| MDA |<--| Intermediate MTA |<--| Border MTA |\n   +-----+   +-----+\
    \   +------------------+   +------------+\n   Generally, it is assumed that the\
    \ work of applying message\n   authentication schemes takes place at a border\
    \ MTA or a delivery MTA.\n   This specification is written with that assumption\
    \ in mind.  However,\n   there are some sites at which the entire mail infrastructure\
    \ consists\n   of a single host.  In such cases, such terms as \"border MTA\"\
    \ and\n   \"delivery MTA\" may well apply to the same machine or even the very\n\
    \   same agent.  It is also possible that some message authentication\n   tests\
    \ could take place on an intermediate MTA.  Although this\n   document doesn't\
    \ specifically describe such cases, they are not meant\n   to be excluded from\
    \ this specification.\n   See [EMAIL-ARCH] for further discussion on general email\
    \ system\n   architecture, and Appendix C of this memo for discussion about the\n\
    \   common aspects of email authentication in current environments.\n"
- title: 1.6.  Trust Environment
  contents:
  - "1.6.  Trust Environment\n   This new header field permits one or more message\
    \ validation\n   mechanisms to communicate its output to one or more separate\n\
    \   assessment mechanisms.  These mechanisms operate within a unified\n   trust\
    \ boundary that defines an Administrative Management Domain\n   (ADMD).  An ADMD\
    \ contains one or more entities that perform\n   validation and generate the header\
    \ field, and one or more that\n   consume it for some type of assessment.  The\
    \ field contains no\n   integrity or validation mechanism of its own, so its presence\
    \ must be\n   trusted implicitly.  Hence, use of the header field depends upon\n\
    \   ensuring that mail entering the ADMD has instances of the header\n   field\
    \ claiming to be valid within its boundaries removed, so that\n   occurrences\
    \ of such header fields can be used safely by consumers.\n   The \"authserv-id\"\
    \ token defined in Section 2.2 can be used to label\n   an entire ADMD or a specific\
    \ validation engine within an ADMD.\n   Although the labeling scheme is left as\
    \ an operational choice, some\n   guidance for selecting a token is provided within\
    \ this proposal.\n"
- title: 2.  Definition and Format of the Header Field
  contents:
  - "2.  Definition and Format of the Header Field\n   This section gives a general\
    \ overview of the format of the header\n   field being defined, and then provides\
    \ more formal specification.\n"
- title: 2.1.  General Description
  contents:
  - "2.1.  General Description\n   The new header field being defined here is called\
    \ \"Authentication-\n   Results\".  It is a Structured Header Field as defined\
    \ in [MAIL] and\n   thus all of the related definitions in that document apply.\n\
    \   This new header field SHOULD be added at the top of the message as it\n  \
    \ transits MTAs that do authentication checks so some idea of how far\n   away\
    \ the checks were done can be inferred.  It therefore should be\n   treated as\
    \ a Trace Field as defined in [MAIL], and thus all of the\n   related definitions\
    \ in that document apply.\n   The value of the header field (after removing [MAIL]\
    \ comments)\n   consists of an authentication identifier, an optional version,\
    \ and\n   then a series of \"method=result\" statements indicating which\n   authentication\
    \ method(s) were applied and their respective results,\n   and then, for each\
    \ applied method, an optional \"reason\" string plus\n   optional \"property=value\"\
    \ statements indicating which message\n   properties were evaluated to reach that\
    \ conclusion.\n   The header field MAY appear more than once in a single message,\
    \ or\n   more than one result MAY be represented in a single header field, or\n\
    \   a combination of these MAY be applied.\n"
- title: 2.2.  Formal Definition
  contents:
  - "2.2.  Formal Definition\n   Formally, the header field is specified as follows\
    \ using [ABNF]:\n     authres-header = \"Authentication-Results:\" [CFWS] authserv-id\n\
    \              [ CFWS version ]\n              ( [CFWS] \";\" [CFWS] \"none\"\
    \ / 1*resinfo ) [CFWS] CRLF\n            ; the special case of \"none\" is used\
    \ to indicate that no\n            ; message authentication is performed\n   \
    \  authserv-id = dot-atom\n                 ; see below for a description of this\
    \ element\n     version = 1*DIGIT [CFWS]\n             ; indicates which version\
    \ of this specification is in use;\n             ; this specification is version\
    \ \"1\"; the absence of a\n             ; version implies this version of the\
    \ specification\n     resinfo = [CFWS] \";\" methodspec [ CFWS reasonspec ]\n\
    \               *( CFWS propspec )\n     methodspec = [CFWS] method [CFWS] \"\
    =\" [CFWS] result\n                ; indicates which authentication method was\
    \ evaluated\n     reasonspec = \"reason\" [CFWS] \"=\" [CFWS] value\n        \
    \        ; a free-form comment on the reason the given result\n              \
    \  ; was returned\n     propspec = ptype [CFWS] \".\" [CFWS] property [CFWS] \"\
    =\" pvalue\n              ; an indication of which properties of the message\n\
    \              ; were evaluated by the authentication scheme being\n         \
    \     ; applied to yield the reported result and would be\n              ; useful\
    \ to reveal to end users as authenticated\n     method = dot-atom [ [CFWS] \"\
    /\" [CFWS] version ]\n            ; a method indicates which method's result is\n\
    \            ; represented by \"result\", and is one of the methods\n        \
    \    ; explicitly defined as valid in this document\n            ; or is an extension\
    \ method as defined below\n     result = dot-atom\n            ; indicates the\
    \ results of the attempt to authenticate\n            ; the message; see below\
    \ for details\n     ptype = \"smtp\" / \"header\" / \"body\" / \"policy\"\n  \
    \         ; indicates whether the property being evaluated was\n           ; a\
    \ parameter to an [SMTP] command, or was a value taken\n           ; from a message\
    \ header field, or was some property of\n           ; the message body, or some\
    \ other property evaluated by\n           ; the receiving MTA\n     property =\
    \ dot-atom\n             ; if \"ptype\" is \"smtp\", this indicates which [SMTP]\n\
    \             ; command provided the value that was evaluated by the\n       \
    \      ; authentication scheme being applied; if \"ptype\" is\n             ;\
    \ \"header\", this indicates from which header field the\n             ; value\
    \ being evaluated was extracted; if \"ptype\" is\n             ; \"body\", this\
    \ indicates the offset into the body at which\n             ; content of interest\
    \ was detected; if \"ptype\" is \"policy\"\n             ; then this indicates\
    \ the name of the policy that caused\n             ; this header field to be added\
    \ (see below)\n     pvalue = [CFWS] ( value / [ [ local-part ] \"@\" ] domain-name\
    \ )\n              [CFWS]\n            ; the value extracted from the message\
    \ property defined\n            ; by the \"ptype.property\" construction; if the\
    \ value\n            ; identifies something intended to be an e-mail identity,\n\
    \            ; then it MUST use the right hand portion of this ABNF\n        \
    \    ; definition\n   The \"local-part\" is as defined in Section 3.4.1, and \"\
    dot-atom\" is\n   defined in Section 3.2.3, of [MAIL].\n   The \"value\" is as\
    \ defined in Section 5.1 of [MIME].\n   The \"domain-name\" is as defined in Section\
    \ 3.5 of [DKIM].\n   The \"dot-atom\" used in a \"result\" above is further constrained\
    \ by the\n   necessity of being enumerated in Section 2.4 or an amendment to it.\n\
    \   See Section 2.3 for a description of the \"authserv-id\" element.\n   The\
    \ list of commands eligible for use with the \"smtp\" ptype can be\n   found in\
    \ [SMTP] and subsequent amendments.\n   \"CFWS\" is as defined in Section 3.2.2\
    \ of [MAIL].\n   The \"propspec\" may be omitted if, for example, the method was\
    \ unable\n   to extract any properties to do its evaluation yet has a result to\n\
    \   report.\n   The \"ptype\" and \"property\" values used by each authentication\
    \ method\n   should be defined in the specification for that method (or its\n\
    \   amendments).\n   The \"ptype\" and \"property\" are case-insensitive.\n  \
    \ A \"ptype\" value of \"policy\" indicates a policy decision about the\n   message\
    \ not specific to a property of the message that could be\n   extracted.  For\
    \ example, if a method would normally report a\n   \"ptype.property\" of \"header.From\"\
    \ and no From: header field was\n   present, the method can use \"policy\" to\
    \ indicate that no conclusion\n   about the authenticity of the message could\
    \ be reached.\n"
- title: 2.3.  Authentication Identifier Field
  contents:
  - "2.3.  Authentication Identifier Field\n   Every Authentication-Results header\
    \ field has an authentication\n   identifier field (\"authserv-id\" above).  This\
    \ is similar in syntax to\n   a fully-qualified domain name.\n   The authentication\
    \ identifier field provides a unique identifier that\n   refers to the authenticating\
    \ service within a given ADMD.  The\n   uniqueness of the identifier MUST be guaranteed\
    \ by the ADMD that\n   generates it and must pertain to exactly that one ADMD.\
    \  This\n   identifier is intended to be machine-readable and not necessarily\n\
    \   meaningful to users.  MUAs or downstream filters SHOULD use this\n   identifier\
    \ to determine whether or not the data contained in an\n   Authentication-Results\
    \ header field should be used.\n   For simplicity and scalability, the authentication\
    \ identifier SHOULD\n   be a common token used throughout the ADMD, such as the\
    \ DNS domain\n   name used by or within that ADMD.\n   For tracing and debugging\
    \ purposes, the authentication identifier MAY\n   instead be the hostname of the\
    \ MTA performing the authentication\n   check whose result is being reported.\
    \  This is also useful for\n   another purpose, as described in Section 4.  Moreover,\
    \ some\n   implementations have considered appending a delimiter such as \"/\"\
    \ and\n   following it with useful transport tracing data such as the [SMTP]\n\
    \   queue ID or a timestamp.\n   It should be noted, however, that using a local,\
    \ relative identifier\n   like a single hostname, rather than a hierarchical and\
    \ globally\n   unique ADMD identifier like a DNS domain name, makes configuration\n\
    \   more difficult for large sites.  The hierarchical identifier permits\n   aggregating\
    \ related, trusted systems together under a single, parent\n   identifier, which\
    \ in turn permits assessing the trust relationship\n   with a single reference.\
    \  The alternative is a flat namespace\n   requiring individually listing each\
    \ trusted system.  Since consumers\n   must use the identifier to determine whether\
    \ to use the contents of\n   the header field:\n   o  Changes to the identifier\
    \ impose a large, centralized\n      administrative burden.\n   o  Ongoing administrative\
    \ changes require constantly updating this\n      centralized table, making it\
    \ difficult to ensure that an MUA or\n      downstream filter will have access\
    \ to accurate information for\n      assessing the usability of the header field's\
    \ content.  In\n      particular, consumers of the header field will need to know\
    \ not\n      only the current identifier(s) in use, but previous ones as well\n\
    \      to account for delivery latency or later re-assessment of the\n      header\
    \ field's contents.\n   Examples of valid authentication identifiers are \"example.com\"\
    ,\n   \"mail.example.org\", \"ms1.newyork.example.com\", and \"example-auth\"\
    .\n"
- title: 2.4.  Result Values
  contents:
  - "2.4.  Result Values\n   Each individual authentication method returns one of\
    \ a set of\n   specific result values.  The subsections below define these results\n\
    \   for the authentication methods specifically supported by this memo,\n   and\
    \ verifiers SHOULD use these values as described below.  New\n   methods not specified\
    \ in this document intended to be supported by\n   the header field defined in\
    \ this memo MUST include a similar result\n   table either in its defining memo\
    \ or in a supplementary one.\n"
- title: 2.4.1.  DKIM and DomainKeys Results
  contents:
  - "2.4.1.  DKIM and DomainKeys Results\n   The result values used by [DKIM] and\
    \ [DOMAINKEYS] are as follows:\n   none:  The message was not signed.\n   pass:\
    \  The message was signed, the signature or signatures were\n      acceptable\
    \ to the verifier, and the signature(s) passed\n      verification tests.\n  \
    \ fail:  The message was signed and the signature or signatures were\n      acceptable\
    \ to the verifier, but they failed the verification\n      test(s).\n   policy:\
    \  The message was signed but the signature or signatures were\n      not acceptable\
    \ to the verifier.\n   neutral:  The message was signed but the signature or signatures\n\
    \      contained syntax errors or were not otherwise able to be\n      processed.\
    \  This result SHOULD also be used for other failures not\n      covered elsewhere\
    \ in this list.\n   temperror:  The message could not be verified due to some\
    \ error that\n      is likely transient in nature, such as a temporary inability\
    \ to\n      retrieve a public key.  A later attempt may produce a final\n    \
    \  result.\n   permerror:  The message could not be verified due to some error\
    \ that\n      is unrecoverable, such as a required header field being absent.\
    \  A\n      later attempt is unlikely to produce a final result.\n   A signature\
    \ is \"acceptable to the verifier\" if it passes local policy\n   checks (or there\
    \ are no specific local policy checks).  For example,\n   a verifier might require\
    \ that the signature(s) on the message be\n   added using the DNS domain present\
    \ in the From: header field of the\n   message, thus making third-party signatures\
    \ unacceptable.\n   [DKIM] advises that if a message fails verification, it should\
    \ be\n   treated as an unsigned message.  A report of \"fail\" here permits the\n\
    \   receiver of the report to decide how to handle the failure.  A report\n  \
    \ of \"neutral\" or \"none\" preempts that choice, ensuring the message\n   will\
    \ be treated as if it had not been signed.\n"
- title: 2.4.2.  SPF and Sender-ID Results
  contents:
  - "2.4.2.  SPF and Sender-ID Results\n   The result values are used by [SPF] and\
    \ [SENDERID] as follows:\n   none:  No policy records were published at the sender's\
    \ DNS domain.\n   neutral:  The sender's ADMD has asserted that it cannot or does\
    \ not\n      want to assert whether or not the sending IP address is authorized\n\
    \      to send mail using the sender's DNS domain.\n   pass:  The client is authorized\
    \ by the sender's ADMD to inject or\n      relay mail on behalf of the sender's\
    \ DNS domain.\n   policy:  The client is authorized to inject or relay mail on\
    \ behalf\n      of the sender's DNS domain according to the authentication\n \
    \     method's algorithm, but local policy dictates that the result is\n     \
    \ unacceptable.\n   hardfail:  This client is explicitly not authorized to inject\
    \ or\n      relay mail using the sender's DNS domain.\n   softfail:  The sender's\
    \ ADMD believes the client was not authorized\n      to inject or relay mail using\
    \ the sender's DNS domain, but is\n      unwilling to make a strong assertion\
    \ to that effect.\n   temperror:  The message could not be verified due to some\
    \ error that\n      is likely transient in nature, such as a temporary inability\
    \ to\n      retrieve a policy record from DNS.  A later attempt may produce a\n\
    \      final result.\n   permerror:  The message could not be verified due to\
    \ some error that\n      is unrecoverable, such as a required header field being\
    \ absent or\n      a syntax error in a retrieved DNS TXT record.  A later attempt\
    \ is\n      unlikely to produce a final result.\n   The distinction between and\
    \ interpretation of \"none\" and \"neutral\"\n   under these methods is discussed\
    \ further in [SPF].\n   The \"policy\" result would be returned if, for example,\
    \ [SPF] returned\n   as \"pass\" result, but a local policy check matches the\
    \ sending DNS\n   domain to one found in an explicit list of unacceptable DNS\
    \ domains\n   (e.g., spammers).\n   If the retrieved sender policies used to evaluate\
    \ [SPF] and\n   [SENDERID] do not contain explicit provisions for authenticating\
    \ the\n   local-part (see Section 3.4.1 of [MAIL]) of an address, the \"pvalue\"\
    \n   reported along with results for these mechanisms SHOULD NOT include\n   the\
    \ local-part.\n"
- title: 2.4.3.  "iprev" Results
  contents:
  - "2.4.3.  \"iprev\" Results\n   The result values are used by the \"iprev\" method,\
    \ defined in\n   Section 3, are as follows:\n   pass:  The DNS evaluation succeeded,\
    \ i.e., the \"reverse\" and\n      \"forward\" lookup results were returned and\
    \ were in agreement.\n   fail:  The DNS evaluation failed.  In particular, the\
    \ \"reverse\" and\n      \"forward\" lookups each produced results but they were\
    \ not in\n      agreement, or the \"forward\" query completed but produced no\n\
    \      result, e.g., a DNS RCODE of 3, commonly known as NXDOMAIN, or an\n   \
    \   RCODE of 0 (NOERROR) in a reply containing no answers, was\n      returned.\n\
    \   temperror:  The DNS evaluation could not be completed due to some\n      error\
    \ that is likely transient in nature, such as a temporary DNS\n      error, e.g.,\
    \ a DNS RCODE of 2, commonly known as SERVFAIL, or\n      other error condition\
    \ resulted.  A later attempt may produce a\n      final result.\n   permerror:\
    \  The DNS evaluation could not be completed because no PTR\n      data are published\
    \ for the connecting IP address, e.g., a DNS\n      RCODE of 3, commonly known\
    \ as NXDOMAIN, or an RCODE of 0 (NOERROR)\n      in a reply containing no answers,\
    \ was returned.  This prevented\n      completion of the evaluation.\n   There\
    \ is no \"none\" for this method since any TCP connection\n   delivering email\
    \ has an IP address associated with it, so some kind\n   of evaluation will always\
    \ be possible.\n   For discussion of the format of DNS replies, see [DNS].\n"
- title: 2.4.4.  SMTP AUTH Results
  contents:
  - "2.4.4.  SMTP AUTH Results\n   The result values are used by the [AUTH] method\
    \ are as follows:\n   none:  SMTP authentication was not attempted.\n   pass:\
    \  The SMTP client had authenticated to the server reporting the\n      result\
    \ using the protocol described in [AUTH].\n   fail:  The SMTP client had attempted\
    \ to authenticate to the server\n      using the protocol described in [AUTH]\
    \ but was not successful, yet\n      continued to send the message about which\
    \ a result is being\n      reported.\n   temperror:  The SMTP client attempted\
    \ to authenticate using the\n      protocol described in [AUTH] but was not able\
    \ to complete the\n      attempt due to some error which is likely transient in\
    \ nature,\n      such as a temporary Lightweight Directory Access Protocol (LDAP)\n\
    \      lookup error.  A later attempt may produce a final result.\n   permerror:\
    \  The SMTP client attempted to authenticate using the\n      protocol described\
    \ in [AUTH] but was not able to complete the\n      attempt due to some error\
    \ that is likely not transient in nature,\n      such as a permanent LDAP lookup\
    \ error.  A later attempt is not\n      likely produce a final result.\n   Note\
    \ that an agent making use of the data provided by this header\n   field SHOULD\
    \ consider \"fail\" and \"temperror\" to be the synonymous in\n   terms of message\
    \ authentication, i.e., the client did not\n   authenticate.\n"
- title: 2.4.5.  Extension Result Codes
  contents:
  - "2.4.5.  Extension Result Codes\n   Additional result codes (extension results)\
    \ might be defined in the\n   future by later revisions or extensions to this\
    \ specification.\n   Extension results beginning with \"x-\" will never be defined\
    \ as\n   standard fields; such names are reserved for experimental use.\n   Result\
    \ codes not beginning with \"x-\" MUST be registered with the\n   Internet Assigned\
    \ Numbers Authority (IANA) and published in an RFC.\n   See Section 6 for further\
    \ details.\n   Implementations reporting new result codes MUST use the \"x-\"\
    \ prefix\n   until such time as the new method is registered by IANA.\n   Extension\
    \ results MUST only be used within ADMDs that have explicitly\n   consented to\
    \ use them.  These results and the parameters associated\n   with them are not\
    \ documented in RFCs.  Therefore, they are subject to\n   change at any time and\
    \ not suitable for production use.  Any MTA, MUA\n   or downstream filter intended\
    \ for production use SHOULD ignore or\n   delete any Authentication-Results header\
    \ field that includes an\n   extension result.\n"
- title: 2.5.  Authentication Methods
  contents:
  - "2.5.  Authentication Methods\n   This section defines the supported authentication\
    \ methods and\n   discusses the proper means for applying experimental and other\n\
    \   extension methods.\n"
- title: 2.5.1.  Definition of Initial Methods
  contents:
  - "2.5.1.  Definition of Initial Methods\n   As they are currently existing specifications\
    \ for message\n   authentication, it is appropriate to define an authentication\
    \ method\n   identifier for each of [AUTH], [DKIM], [DOMAINKEYS], [SENDERID],\
    \ and\n   [SPF].  Therefore, the authentication method identifiers \"auth\",\n\
    \   \"dkim\", \"domainkeys\", \"sender-id\", and \"spf\", respectively are hereby\n\
    \   defined for MTAs applying those specifications for email message\n   authentication.\n\
    \   Furthermore, method \"iprev\" is defined in Section 3.\n   See Section 6 for\
    \ details.\n"
- title: 2.5.2.  Extension Methods
  contents:
  - "2.5.2.  Extension Methods\n   Additional authentication method identifiers (extension\
    \ methods) may\n   be defined in the future by later revisions or extensions to\
    \ this\n   specification.  Extension methods beginning with \"x-\" will never\
    \ be\n   defined as standard fields; such names are reserved for experimental\n\
    \   use.  Method identifiers not beginning with \"x-\" MUST be registered\n  \
    \ with the Internet Assigned Numbers Authority (IANA) and published in\n   an\
    \ RFC.  See Section 6 for further details.\n   Extension methods may be defined\
    \ for the following reasons:\n   1.  To allow additional information from new\
    \ authentication systems\n       to be communicated to MUAs or downstream filters.\
    \  The names of\n       such identifiers should reflect the name of the method\
    \ being\n       defined, but should not be needlessly long.\n   2.  To allow the\
    \ creation of \"sub-identifiers\" that indicate\n       different levels of authentication\
    \ and differentiate between\n       their relative strengths, e.g., \"auth1-weak\"\
    \ and \"auth1-strong\".\n   Implementations of new methods MUST use the \"x-\"\
    \ prefix until such\n   time as the new method is registered by IANA.\n   Authentication\
    \ method implementors are encouraged to provide adequate\n   information, via\
    \ [MAIL] comments if necessary, to allow an MUA\n   developer to understand or\
    \ relay ancillary details of authentication\n   results.  For example, if it might\
    \ be of interest to relay what data\n   was used to perform an evaluation, such\
    \ information could be relayed\n   as a comment in the header field, such as:\n\
    \        Authentication-Results: example.com;\n                  foo=pass bar.baz=blob\
    \ (2 of 3 tests OK)\n   Experimental method identifiers MUST only be used within\
    \ ADMDs that\n   have explicitly consented to use them.  These method identifiers\
    \ and\n   the parameters associated with them are not documented in RFCs.\n  \
    \ Therefore, they are subject to change at any time and not suitable\n   for production\
    \ use.  Any MTA, MUA, or downstream filter intended for\n   production use SHOULD\
    \ ignore or delete any Authentication-Results\n   header field that includes an\
    \ experimental method identifier.\n"
- title: 3.  The "iprev" Authentication Method
  contents:
  - "3.  The \"iprev\" Authentication Method\n   This section defines an additional\
    \ authentication method called\n   \"iprev\".\n   In general, \"iprev\" is an\
    \ attempt to verify that a client appears to\n   be valid based on some DNS queries.\
    \  Upon receiving a session\n   initiation of some kind from a client, the IP\
    \ address of the client\n   peer is queried for matching names (i.e., a number-to-name\n\
    \   translation, also known as a \"reverse lookup\" or a \"PTR\" record\n   query).\
    \  Once that result is acquired, a lookup of each of the names\n   (i.e., a name-to-number\
    \ translation, or an \"A\" or \"AAAA\" record\n   query) thus retrieved is done.\
    \  The response to this second check\n   should result in at least one mapping\
    \ back to the client's IP\n   address.\n   More algorithmically: if the client\
    \ peer's IP address is I, the list\n   of names to which I maps (after a \"PTR\"\
    \ query) is the set N, and the\n   union of IP addresses to which each member\
    \ of N maps (after\n   corresponding \"A\" and \"AAAA\" queries) is L, then this\
    \ test is\n   successful if I is an element of L.\n   The response to a PTR query\
    \ could contain multiple names.  To prevent\n   heavy DNS loads, agents performing\
    \ these queries MUST be implemented\n   such that the number of names evaluated\
    \ by generation of\n   corresponding A or AAAA queries is finite, though it MAY\
    \ be\n   configurable by an administrator.  As an example, Section 5.5 of\n  \
    \ [SPF] chose a limit of 10 for its implementation of this algorithm.\n   [DNS-IP6]\
    \ discusses the query formats for the IPv6 case.\n   A successful test using this\
    \ algorithm constitutes a result of \"pass\"\n   since the ADMD in which the client's\
    \ PTR claims it belongs has\n   confirmed that claim by including corresponding\
    \ data in its DNS\n   domain.  A failure to match constitutes a \"fail\".  There\
    \ is no case\n   in which a \"neutral\" result can be returned.  The remaining\n\
    \   \"temperror\" and \"permerror\" cases refer, respectively, to temporary\n\
    \   and permanent DNS query errors.\n   There is some contention regarding the\
    \ wisdom and reliability of this\n   test.  For example, in some regions it can\
    \ be difficult for this test\n   ever to pass because the practice of arranging\
    \ to match the forward\n   and reverse DNS is infrequently observed.  Therefore,\
    \ the actual\n   implementation details of how a verifier performs an \"iprev\"\
    \ test are\n   not specified here.  The verifier MAY report a successful or failed\n\
    \   \"iprev\" test at its discretion having done some kind of check of the\n \
    \  validity of the connection's identity using DNS.  It is incumbent\n   upon\
    \ an agent making use of the reported \"iprev\" result to understand\n   what\
    \ exactly that particular verifier is attempting to report.\n   Extensive discussion\
    \ of reverse DNS mapping and its implications can\n   be found in [DNSOP-REVERSE].\
    \  In particular, it recommends that\n   applications avoid using this test as\
    \ a means of authentication or\n   security.  Its presence in this memo is not\
    \ an endorsement, but is\n   merely acknowledgement that the method remains common\
    \ and provides\n   the means to relay the results of that test.\n"
- title: 4.  Adding the Header Field to A Message
  contents:
  - "4.  Adding the Header Field to A Message\n   This specification makes no attempt\
    \ to evaluate the relative\n   strengths of various message authentication methods\
    \ that may become\n   available.  As such, the order of the presented authentication\n\
    \   methods and results MUST NOT be used either to imply or infer the\n   importance\
    \ or strength of any given method over another.  Instead,\n   the MUA or downstream\
    \ filter consuming this header field must\n   interpret the result of each method\
    \ based on its own knowledge of\n   what that method evaluates.\n   Each \"method\"\
    \ MUST refer to an authentication method declared in the\n   IANA registry, or\
    \ an extension method as defined in Section 2.5.2,\n   and each \"result\" MUST\
    \ refer to a result code declared in the IANA\n   registry, or an extension result\
    \ code as defined in Section 2.4.5.\n   See Section 6 for further information\
    \ about the registered methods\n   and result codes.\n   An MTA compliant with\
    \ this specification MUST add this header field\n   (after performing one or more\
    \ message authentication tests) to\n   indicate which MTA or ADMD performed the\
    \ test, which test got applied\n   and what the result was.  If an MTA applies\
    \ more than one such test,\n   it MUST add this header field either once per test,\
    \ or once\n   indicating all of the results.  An MTA MUST NOT add a result to\
    \ an\n   existing header field.\n   An MTA MAY add this header field containing\
    \ only the authentication\n   identifier portion to indicate explicitly that no\
    \ message\n   authentication schemes were applied prior to delivery of this\n\
    \   message.\n   An MTA adding this header field must take steps to identify it\
    \ as\n   legitimate to the MUAs or downstream filters that will ultimately\n \
    \  consume its content.  One required process to do so is described in\n   Section\
    \ 5.  Further measures may be required in some environments.\n   Some possible\
    \ solutions are enumerated in Section 7.1.  This memo\n   does not mandate any\
    \ specific solution to this issue as each\n   environment has its own facilities\
    \ and limitations.\n   For MTAs that add this header field, adding header fields\
    \ in order\n   (at the top), per Section 3.6 of [MAIL], is particularly important.\n\
    \   Moreover, this header field SHOULD be inserted above any other trace\n   header\
    \ fields such MTAs might prepend.  This allows easy detection of\n   header fields\
    \ that can be trusted.\n   End users making direct use of this header field may\
    \ inadvertently\n   trust information that has not been properly vetted.  If,\
    \ for\n   example, a basic [SPF] result were to be relayed that claims an\n  \
    \ authenticated addr-spec, the local-part of that addr-spec has\n   actually not\
    \ been authenticated.  Thus, an MTA adding this header\n   field SHOULD NOT include\
    \ any data that has not been authenticated by\n   the method(s) being applied.\
    \  Moreover, MUAs SHOULD NOT render to\n   users such information if it is presented\
    \ by a method known not to\n   authenticate it.\n"
- title: 4.1.  Header Field Position and Interpretation
  contents:
  - "4.1.  Header Field Position and Interpretation\n   In order to ensure non-ambiguous\
    \ results and avoid the impact of\n   false header fields, MUAs and downstream\
    \ filters SHOULD NOT interpret\n   this header field unless specifically instructed\
    \ to do so by the user\n   or administrator.  That is, this interpretation should\
    \ not be \"on by\n   default\".  Naturally then, users or administrators should\
    \ not\n   activate such a feature unless they are certain the header field will\n\
    \   be added by the border MTA that accepts the mail that is ultimately\n   read\
    \ by the MUA, and instances of the header field appearing to be\n   from within\
    \ the ADMD but actually added by foreign MTAs will be\n   removed before delivery.\n\
    \   Furthermore, MUAs and downstream filters SHOULD NOT interpret this\n   header\
    \ field unless the authentication identifier it bears appears to\n   be one used\
    \ within its own ADMD as configured by the user or\n   administrator.\n   MUAs\
    \ and downstream filters MUST ignore any result reported using a\n   \"result\"\
    \ not specified in the result code registry, or a \"ptype\" not\n   listed in\
    \ the corresponding registry for such values as defined in\n   Section 6.  Moreover,\
    \ such agents MUST ignore a result indicated for\n   any \"method\" they do not\
    \ specifically support.\n   An MUA SHOULD NOT reveal these results to end users\
    \ unless the\n   results are accompanied by, at a minimum, some associated reputation\n\
    \   data about the authenticated origin identifiers within the message.\n   For\
    \ example, an attacker could register examp1e.com (note the digit\n   \"one\"\
    ) and send signed mail to intended victims; a verifier would\n   detect that the\
    \ signature was valid and report a \"pass\" even though\n   it's clear the DNS\
    \ domain name was intended to mislead.  See\n   Section 7.2 for further discussion.\n\
    \   As stated in Section 2.1, this header field SHOULD be treated as\n   though\
    \ it were a trace header field as defined in Section 3.6.7 of\n   [MAIL], and\
    \ hence MUST NOT be reordered and MUST be prepended to the\n   message, so that\
    \ there is generally some indication upon delivery of\n   where in the chain of\
    \ handling MTAs the message authentication was\n   done.\n   MUAs SHOULD ignore\
    \ instances of this header field discovered within\n   message/rfc822 [MIME] attachments.\n\
    \   Further discussion of this can be found in Section 7 below.\n"
- title: 4.2.  Local Policy Enforcement
  contents:
  - "4.2.  Local Policy Enforcement\n   If a site's local policy is to consider a\
    \ non-recoverable failure\n   result (e.g., \"fail\" for DKIM, \"hardfail\" for\
    \ SPF) for any particular\n   authentication method as justification to reject\
    \ the message\n   completely, the border MTA SHOULD issue an [SMTP] rejection\
    \ response\n   to the message rather than adding this header field with the failure\n\
    \   result and allowing it to proceed toward delivery.  This is more\n   desirable\
    \ than allowing the message to reach an internal host's MTA\n   or spam filter,\
    \ thus possibly generating a local rejection such as a\n   [DSN] to a forged originator.\n\
    \   The same MAY also be done for local policy decisions overriding the\n   results\
    \ of the authentication methods (e.g., the \"policy\" result\n   codes described\
    \ in Section 2.4).\n   Such rejections at the SMTP protocol level are not possible\
    \ if local\n   policy is enforced at the MUA and not the MTA.  Unfortunately,\
    \ this\n   may be a common scenario.\n"
- title: 5.  Removing the Header Field
  contents:
  - "5.  Removing the Header Field\n   For security reasons, any MTA conforming to\
    \ this specification MUST\n   delete any discovered instance of this header field\
    \ that claims to\n   have been added within its trust boundary and that did not\
    \ come from\n   another trusted MTA.  For example, an MTA (border or otherwise)\
    \ for\n   example.com receiving a message MUST delete any instance of this\n \
    \  header field bearing an authentication identifier indicating the\n   header\
    \ field was added within example.com prior to adding its own\n   header fields.\
    \  This may mean each MTA will have to be equipped with\n   a list of internal\
    \ MTAs known to be compliant (and hence\n   trustworthy).\n   For simplicity and\
    \ maximum security, a border MTA MAY remove all\n   instances of this header field\
    \ on mail crossing into its trust\n   boundary.  However, this may conflict with\
    \ the desire to access\n   authentication results performed by trusted external\
    \ service\n   providers.  It may also invalidate signed messages whose signatures\n\
    \   cover external instances of this header field.  A more robust border\n   MTA\
    \ could allow a specific list of authenticating MTAs whose\n   information should\
    \ be let in, removing all others.\n   As stated in Section 1.2, a formal definition\
    \ of \"trust boundary\" is\n   deliberately not made here.  It is entirely possible\
    \ that a border\n   MTA for example.com might explicitly trust authentication\
    \ results\n   asserted by upstream host example.net even though they exist in\n\
    \   completely disjoint administrative boundaries.  In that case, the\n   border\
    \ MTA MAY elect not to delete those results; moreover, the\n   upstream host doing\
    \ some authentication work could apply a signing\n   technology such as [DKIM]\
    \ on its own results to assure downstream\n   hosts of their authenticity.  An\
    \ example of this is provided in\n   Appendix B.\n   Similarly, in the case of\
    \ messages signed using [DKIM] or other\n   message signing methods that sign\
    \ header fields, this may invalidate\n   one or more signatures on the message\
    \ if they covered the header\n   field to be removed at the time of signing. \
    \ This behavior can be\n   desirable since there's little value in validating\
    \ the signature on a\n   message with forged headers.  However, signing agents\
    \ MAY therefore\n   elect to omit these header fields from signing to avoid this\n\
    \   situation.\n   An MTA SHOULD remove any instance of this header field bearing\
    \ a\n   version (express or implied) that it does not support.  However, an\n\
    \   MTA MUST remove such a header if the [SMTP] connection relaying the\n   message\
    \ is not from a trusted internal MTA.\n"
- title: 6.  IANA Considerations
  contents:
  - "6.  IANA Considerations\n   IANA has registered a new header field and created\
    \ two new tables as\n   described below.\n"
- title: 6.1.  The Authentication-Results Header Field
  contents:
  - "6.1.  The Authentication-Results Header Field\n   Per [IANA-HEADERS], the \"\
    Authentication-Results\" header field has\n   been added to the IANA Permanent\
    \ Message Header Field Registry.  The\n   following is the registration template:\n\
    \     Header field name: Authentication-Results\n     Applicable protocol: mail\
    \ ([MAIL])\n     Status: Standard\n     Author/Change controller: IETF\n     Specification\
    \ document(s): RFC 5451\n     Related information:\n       Requesting review of\
    \ any proposed changes and additions to\n       this field is recommended.\n"
- title: 6.2.  Email Authentication Method Name Registry
  contents:
  - "6.2.  Email Authentication Method Name Registry\n   Names of message authentication\
    \ methods supported by this\n   specification must be registered with IANA, with\
    \ the exception of\n   experimental names as described in Section 2.5.2.\n   New\
    \ entries are assigned only for values that have been documented in\n   a published\
    \ RFC that has had IETF Review, per [IANA-CONSIDERATIONS].\n   Each method must\
    \ register a name, the specification that defines it,\n   one or more \"ptype\"\
    \ values appropriate for use with that method,\n   which \"property\" value(s)\
    \ should be reported by that method, and a\n   description of the \"value\" to\
    \ be used with each.\n   The initial set of entries in this registry is as follows:\n"
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '|   Method   | Defined  | ptype  | property       | value              |'
  contents:
  - '|   Method   | Defined  | ptype  | property       | value              |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '|    auth    | RFC4954  | smtp   | auth           | AUTH parameter of  |'
  contents:
  - '|    auth    | RFC4954  | smtp   | auth           | AUTH parameter of  |

    '
- title: '|            |          |        |                | the SMTP MAIL      |'
  contents:
  - '|            |          |        |                | the SMTP MAIL      |

    '
- title: '|            |          |        |                | command            |'
  contents:
  - '|            |          |        |                | command            |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '|    dkim    | RFC4871  | header | d              | value of           |'
  contents:
  - '|    dkim    | RFC4871  | header | d              | value of           |

    '
- title: '|            |          |        |                | signature "d" tag  |'
  contents:
  - '|            |          |        |                | signature "d" tag  |

    '
- title: '|            |          |        +----------------+--------------------+'
  contents:
  - '|            |          |        +----------------+--------------------+

    '
- title: '|            |          |        | i              | value of           |'
  contents:
  - '|            |          |        | i              | value of           |

    '
- title: '|            |          |        |                | signature "i" tag  |'
  contents:
  - '|            |          |        |                | signature "i" tag  |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '| domainkeys | RFC4870  | header | d              | value of           |'
  contents:
  - '| domainkeys | RFC4870  | header | d              | value of           |

    '
- title: '|            |          |        |                | signature "d" tag  |'
  contents:
  - '|            |          |        |                | signature "d" tag  |

    '
- title: '|            |          |        +----------------+--------------------+'
  contents:
  - '|            |          |        +----------------+--------------------+

    '
- title: '|            |          |        | from           | value of From      |'
  contents:
  - '|            |          |        | from           | value of From      |

    '
- title: '|            |          |        |                | header field after |'
  contents:
  - '|            |          |        |                | header field after |

    '
- title: '|            |          |        |                | removing comments  |'
  contents:
  - '|            |          |        |                | removing comments  |

    '
- title: '|            |          |        |                | and local-part if  |'
  contents:
  - '|            |          |        |                | and local-part if  |

    '
- title: '|            |          |        |                | not authenticated  |'
  contents:
  - '|            |          |        |                | not authenticated  |

    '
- title: '|            |          |        +----------------+--------------------+'
  contents:
  - '|            |          |        +----------------+--------------------+

    '
- title: '|            |          |        | sender         | value of Sender    |'
  contents:
  - '|            |          |        | sender         | value of Sender    |

    '
- title: '|            |          |        |                | header field after |'
  contents:
  - '|            |          |        |                | header field after |

    '
- title: '|            |          |        |                | removing comments  |'
  contents:
  - '|            |          |        |                | removing comments  |

    '
- title: '|            |          |        |                | and local-part if  |'
  contents:
  - '|            |          |        |                | and local-part if  |

    '
- title: '|            |          |        |                | not authenticated  |'
  contents:
  - '|            |          |        |                | not authenticated  |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '|    iprev   | this     | policy | iprev          | client IP address  |'
  contents:
  - '|    iprev   | this     | policy | iprev          | client IP address  |

    '
- title: '|            | document |        |                |                    |'
  contents:
  - '|            | document |        |                |                    |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '|  sender-id | RFC4406  | header | name of header | value of header    |'
  contents:
  - '|  sender-id | RFC4406  | header | name of header | value of header    |

    '
- title: '|            |          |        | field used by  | field used by PRA  |'
  contents:
  - '|            |          |        | field used by  | field used by PRA  |

    '
- title: '|            |          |        | the Purported  | after removing     |'
  contents:
  - '|            |          |        | the Purported  | after removing     |

    '
- title: '|            |          |        | Responsible    | comments and parts |'
  contents:
  - '|            |          |        | Responsible    | comments and parts |

    '
- title: '|            |          |        | Address (PRA)  | not authenticated  |'
  contents:
  - '|            |          |        | Address (PRA)  | not authenticated  |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: '|     spf    | RFC4408  | smtp   | mailfrom       | envelope sender    |'
  contents:
  - '|     spf    | RFC4408  | smtp   | mailfrom       | envelope sender    |

    '
- title: '|            |          |        |                | after removing     |'
  contents:
  - '|            |          |        |                | after removing     |

    '
- title: '|            |          |        |                | parts not          |'
  contents:
  - '|            |          |        |                | parts not          |

    '
- title: '|            |          |        |                | authenticated      |'
  contents:
  - '|            |          |        |                | authenticated      |

    '
- title: '|            |          +--------+----------------+--------------------+'
  contents:
  - '|            |          +--------+----------------+--------------------+

    '
- title: '|            |          | smtp   | helo           | HELO/EHLO value    |'
  contents:
  - '|            |          | smtp   | helo           | HELO/EHLO value    |

    '
- title: +------------+----------+--------+----------------+--------------------+
  contents:
  - '+------------+----------+--------+----------------+--------------------+

    '
- title: 6.3.  Email Authentication Result Name Registry
  contents:
  - "6.3.  Email Authentication Result Name Registry\n   Names of message authentication\
    \ result codes supported by this\n   specification must be registered with IANA,\
    \ with the exception of\n   experimental codes as described in Section 2.4.5.\n\
    \   New entries are assigned only for result codes that have been\n   documented\
    \ in a published RFC that has had IETF Review, per\n   [IANA-CONSIDERATIONS].\
    \  Each code must register a name, the document\n   that establishes the registration,\
    \ the authentication method(s) that\n   uses it, and either a definition of the\
    \ semantics of its use or a\n   reference to the place where those semantics are\
    \ defined.\n   The initial set of entries in this registry is as follows:\n"
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '|   Code    | Defined  | Auth Method(s) | Meaning                      |'
  contents:
  - '|   Code    | Defined  | Auth Method(s) | Meaning                      |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| none      | this     | dkim           | section 2.4.1                |'
  contents:
  - '| none      | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | spf            | section 2.4.2                |'
  contents:
  - '|           |          | spf            | section 2.4.2                |

    '
- title: '|           |          | sender-id      |                              |'
  contents:
  - '|           |          | sender-id      |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | auth           | section 2.4.4                |'
  contents:
  - '|           |          | auth           | section 2.4.4                |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| pass      | this     | dkim           | section 2.4.1                |'
  contents:
  - '| pass      | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | spf            | section 2.4.2                |'
  contents:
  - '|           |          | spf            | section 2.4.2                |

    '
- title: '|           |          | sender-id      |                              |'
  contents:
  - '|           |          | sender-id      |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | iprev          | section 2.4.3                |'
  contents:
  - '|           |          | iprev          | section 2.4.3                |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | auth           | section 2.4.4                |'
  contents:
  - '|           |          | auth           | section 2.4.4                |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| fail      | this     | dkim           | section 2.4.1                |'
  contents:
  - '| fail      | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | iprev          | section 2.4.3                |'
  contents:
  - '|           |          | iprev          | section 2.4.3                |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | auth           | section 2.4.4                |'
  contents:
  - '|           |          | auth           | section 2.4.4                |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| policy    | this     | dkim           | section 2.4.1                |'
  contents:
  - '| policy    | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | spf            | section 2.4.2                |'
  contents:
  - '|           |          | spf            | section 2.4.2                |

    '
- title: '|           |          | sender-id      |                              |'
  contents:
  - '|           |          | sender-id      |                              |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| neutral   | this     | dkim           | section 2.4.1                |'
  contents:
  - '| neutral   | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | spf            | section 2.4.2                |'
  contents:
  - '|           |          | spf            | section 2.4.2                |

    '
- title: '|           |          | sender-id      |                              |'
  contents:
  - '|           |          | sender-id      |                              |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| temperror | this     | dkim           | section 2.4.1                |'
  contents:
  - '| temperror | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | spf            | section 2.4.2                |'
  contents:
  - '|           |          | spf            | section 2.4.2                |

    '
- title: '|           |          | sender-id      |                              |'
  contents:
  - '|           |          | sender-id      |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | iprev          | section 2.4.3                |'
  contents:
  - '|           |          | iprev          | section 2.4.3                |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | auth           | section 2.4.4                |'
  contents:
  - '|           |          | auth           | section 2.4.4                |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| permerror | this     | dkim           | section 2.4.1                |'
  contents:
  - '| permerror | this     | dkim           | section 2.4.1                |

    '
- title: '|           | document | domainkeys     |                              |'
  contents:
  - '|           | document | domainkeys     |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | spf            | section 2.4.2                |'
  contents:
  - '|           |          | spf            | section 2.4.2                |

    '
- title: '|           |          | sender-id      |                              |'
  contents:
  - '|           |          | sender-id      |                              |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | iprev          | section 2.4.3                |'
  contents:
  - '|           |          | iprev          | section 2.4.3                |

    '
- title: '|           |          +----------------+------------------------------+'
  contents:
  - '|           |          +----------------+------------------------------+

    '
- title: '|           |          | auth           | section 2.4.4                |'
  contents:
  - '|           |          | auth           | section 2.4.4                |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| hardfail  | this     | spf            | section 2.4.2                |'
  contents:
  - '| hardfail  | this     | spf            | section 2.4.2                |

    '
- title: '|           | document | sender-id      |                              |'
  contents:
  - '|           | document | sender-id      |                              |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: '| softfail  | this     | spf            | section 2.4.2                |'
  contents:
  - '| softfail  | this     | spf            | section 2.4.2                |

    '
- title: '|           | document | sender-id      |                              |'
  contents:
  - '|           | document | sender-id      |                              |

    '
- title: +-----------+----------+----------------+------------------------------+
  contents:
  - '+-----------+----------+----------------+------------------------------+

    '
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   The following security considerations apply when\
    \ adding or processing\n   the \"Authentication-Results\" header field:\n"
- title: 7.1.  Forged Header Fields
  contents:
  - "7.1.  Forged Header Fields\n   An MUA or filter that accesses a mailbox whose\
    \ mail is handled by a\n   non-conformant MTA, and understands Authentication-Results\
    \ header\n   fields, could potentially make false conclusions based on forged\n\
    \   header fields.  A malicious user or agent could forge a header field\n   using\
    \ the DNS domain of a receiving ADMD as the authserv-id token in\n   the value\
    \ of the header field, and with the rest of the value claim\n   that the message\
    \ was properly authenticated.  The non-conformant MTA\n   would fail to strip\
    \ the forged header field, and the MUA could\n   inappropriately trust it.\n \
    \  It is for this reason an MUA should not have processing of the\n   \"Authentication-Results\"\
    \ header field enabled by default; instead it\n   should be ignored, at least\
    \ for the purposes of enacting filtering\n   decisions, unless specifically enabled\
    \ by the user or administrator\n   after verifying that the border MTA is compliant.\
    \  It is acceptable\n   to have an MUA aware of this specification, but have an\
    \ explicit list\n   of hostnames whose \"Authentication-Results\" header fields\
    \ are\n   trustworthy; however, this list should initially be empty.\n   Proposed\
    \ alternate solutions to this problem are nascent:\n   1.  Possibly the simplest\
    \ is a digital signature protecting the\n       header field, such as using [DKIM],\
    \ that can be verified by an\n       MUA by using a posted public key.  Although\
    \ one of the main\n       purposes of this memo is to relieve the burden of doing\
    \ message\n       authentication work at the MUA, this only requires that the\
    \ MUA\n       learn a single authentication scheme even if a number of them are\n\
    \       in use at the border MTA.  Note that [DKIM] requires that the\n      \
    \ From header field be signed, although in this application, the\n       signing\
    \ agent (a trusted MTA) likely cannot authenticate that\n       value, so the\
    \ fact that it is signed should be ignored.\n   2.  Another would be a means to\
    \ interrogate the MTA that added the\n       header field to see if it is actually\
    \ providing any message\n       authentication services and saw the message in\
    \ question, but this\n       isn't especially palatable given the work required\
    \ to craft and\n       implement such a scheme.\n   3.  Yet another might be a\
    \ method to interrogate the internal MTAs\n       that apparently handled the\
    \ message (based on Received: header\n       fields) to determine whether any\
    \ of them conform to Section 5 of\n       this memo.  This, too, has potentially\
    \ high barriers-to-entry.\n   4.  Extensions to [IMAP], [SMTP], and [POP3] could\
    \ be defined to\n       allow an MUA or filtering agent to acquire the \"authserv-id\"\
    \ in\n       use within an ADMD, thus allowing it to identify which\n       Authentication-Results\
    \ header fields it can trust.\n   5.  On the presumption that internal MTAs are\
    \ fully compliant with\n       Section 3.6 of [MAIL], and the compliant internal\
    \ MTAs are using\n       their own host names or the ADMD's DNS domain name as\
    \ the\n       \"authserv-id\" token, the header field proposed here should always\n\
    \       appear above a Received: header added by a trusted MTA.  This can\n  \
    \     be used as a test for header field validity.\n   Support for some of these\
    \ is planned for future work.\n   In any case, a mechanism needs to exist for\
    \ an MUA or filter to\n   verify that the host that appears to have added the\
    \ header field (a)\n   actually did so, and (b) is legitimately adding that header\
    \ field for\n   this delivery.  Given the variety of messaging environments deployed\n\
    \   today, consensus appears to be that specifying a particular mechanism\n  \
    \ for doing so is not appropriate for this memo.\n   Mitigation of the forged\
    \ header field attack can also be accomplished\n   by moving the authentication\
    \ results data into meta-data associated\n   with the message.  In particular,\
    \ an [SMTP] extension could be\n   established which is used to communicate authentication\
    \ results from\n   the border MTA to intermediate and delivery MTAs; the latter\
    \ of these\n   could arrange to store the authentication results as meta-data\n\
    \   retrieved and rendered along with the message by an [IMAP] client\n   aware\
    \ of a similar extension in that protocol.  The delivery MTA\n   would be told\
    \ to trust data via this extension only from MTAs it\n   trusts, and border MTAs\
    \ would not accept data via this extension from\n   any source.  There is no vector\
    \ in such an arrangement for forgery of\n   authentication data by an outside\
    \ agent.\n"
- title: 7.2.  Misleading Results
  contents:
  - "7.2.  Misleading Results\n   Until some form of service for querying the reputation\
    \ of a sending\n   agent is widely deployed, the existence of this header field\n\
    \   indicating a \"pass\" does not render the message trustworthy.  It is\n  \
    \ possible for an arriving piece of spam or other undesirable mail to\n   pass\
    \ checks by several of the methods enumerated above (e.g., a piece\n   of spam\
    \ signed using [DKIM] by the originator of the spam, which\n   might be a spammer\
    \ or a compromised system).  In particular, this\n   issue is not resolved by\
    \ forged header field removal discussed above.\n   Hence, MUAs and downstream\
    \ filters must take some care with use of\n   this header even after possibly\
    \ malicious headers are scrubbed.\n"
- title: 7.3.  Header Field Position
  contents:
  - "7.3.  Header Field Position\n   Despite the requirements of [MAIL], header fields\
    \ can sometimes be\n   reordered enroute by intermediate MTAs.  The goal of requiring\
    \ header\n   field addition only at the top of a message is an acknowledgement\n\
    \   that some MTAs do reorder header fields, but most do not.  Thus, in\n   the\
    \ general case, there will be some indication of which MTAs (if\n   any) handled\
    \ the message after the addition of the header field\n   defined here.\n"
- title: 7.4.  Reverse IP Query Denial-of-Service Attacks
  contents:
  - "7.4.  Reverse IP Query Denial-of-Service Attacks\n   Section 5.5 of [SPF] describes\
    \ a DNS-based denial-of-service attack\n   for verifiers that attempt DNS-based\
    \ identity verification of\n   arriving client connections.  A verifier wishing\
    \ to do this check and\n   report this information SHOULD take care not to go\
    \ to unbounded\n   lengths to resolve \"A\" and \"PTR\" queries.  MUAs or other\
    \ filters\n   making use of an \"iprev\" result specified by this memo SHOULD\
    \ be\n   aware of the algorithm used by the verifier reporting the result and\n\
    \   thus be aware of its limitations.\n"
- title: 7.5.  Mitigation of Backscatter
  contents:
  - "7.5.  Mitigation of Backscatter\n   Failing to follow the instructions of Section\
    \ 4.2 can result in a\n   denial-of-service attack caused by the generation of\
    \ [DSN] messages\n   (or equivalent) to addresses that did not send the messages\
    \ being\n   rejected.\n"
- title: 7.6.  Internal MTA Lists
  contents:
  - "7.6.  Internal MTA Lists\n   Section 5 describes a procedure for scrubbing headers\
    \ that may\n   contain forged authentication results about a message.  A compliant\n\
    \   installation will have to include, at each MTA, a list of other MTAs\n   known\
    \ to be compliant and trustworthy.  Failing to keep this list\n   current as internal\
    \ infrastructure changes may expose an ADMD to\n   attack.\n"
- title: 7.7.  Attacks against Authentication Methods
  contents:
  - "7.7.  Attacks against Authentication Methods\n   If an attack becomes known against\
    \ an authentication method, clearly\n   then the agent verifying that method can\
    \ be fooled into thinking an\n   inauthentic message is authentic, and thus the\
    \ value of this header\n   field can be misleading.  It follows that any attack\
    \ against the\n   authentication methods supported by this document (and later\n\
    \   amendments to it) is also a security consideration here.\n"
- title: 7.8.  Intentionally Malformed Header Fields
  contents:
  - "7.8.  Intentionally Malformed Header Fields\n   It is possible for an attacker\
    \ to add an Authentication-Results\n   header field that is extraordinarily large\
    \ or otherwise malformed in\n   an attempt to discover or exploit weaknesses in\
    \ header field parsing\n   code.  Implementors must thoroughly verify all such\
    \ header fields\n   received from MTAs and be robust against intentionally as\
    \ well as\n   unintentionally malformed header fields.\n"
- title: 7.9.  Compromised Internal Hosts
  contents:
  - "7.9.  Compromised Internal Hosts\n   An internal MUA or MTA that has been compromised\
    \ could generate mail\n   with a forged From header field and a forged Authentication-Results\n\
    \   header field that endorses it.  Although it is clearly a larger\n   concern\
    \ to have compromised internal machines than it is to prove the\n   value of this\
    \ header field, this risk can be mitigated by arranging\n   that internal MTAs\
    \ will remove this header field if it claims to have\n   been added by a trusted\
    \ border MTA (as described above), yet the\n   [SMTP] connection is not coming\
    \ from an internal machine known to be\n   running an authorized MTA.  However,\
    \ in such a configuration,\n   legitimate MTAs will have to add this header field\
    \ when legitimate\n   internal-only messages are generated.  This is also covered\
    \ in\n   Section 5.\n"
- title: 7.10.  Encapsulated Instances
  contents:
  - "7.10.  Encapsulated Instances\n   [MIME] messages may contain attachments of\
    \ type \"message/rfc822\",\n   which contain other [MAIL] messages.  Such an encapsulated\
    \ message\n   may also contain an Authentication-Results header field.  Although\n\
    \   the processing of these is outside of the intended scope of this\n   document\
    \ (see Section 1.3), some early guidance to MUA developers is\n   appropriate\
    \ here.\n   Since MTAs are unlikely to strip Authentication-Results header fields\n\
    \   after mailbox delivery, MUAs are advised in Section 4.1 to ignore\n   such\
    \ instances within [MIME] attachments.  Moreover, when extracting\n   a message\
    \ digest to separate mail store messages or other media, such\n   header fields\
    \ should be removed so that they will never be\n   interpreted improperly by MUAs\
    \ that might later consume them.\n"
- title: 7.11.  Reverse Mapping
  contents:
  - "7.11.  Reverse Mapping\n   Although Section 3 of this memo includes explicit\
    \ support for the\n   \"iprev\" method, its value as an authentication mechanism\
    \ is limited.\n   Implementors of both this proposal and agents that use the data\
    \ it\n   relays are encouraged to become familiar with the issues raised by\n\
    \   [DNSOP-REVERSE] when deciding whether or not to include support for\n   \"\
    iprev\".\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.  Normative References
  contents:
  - "8.1.  Normative References\n   [ABNF]                 Crocker, D. and P. Overell,\
    \ \"Augmented BNF for\n                          Syntax Specifications: ABNF\"\
    , STD 68,\n                          RFC 5234, January 2008.\n   [IANA-HEADERS]\
    \         Klyne, G., Nottingham, M., and J. Mogul,\n                         \
    \ \"Registration Procedures for Message Header\n                          Fields\"\
    , BCP 90, RFC 3864, September 2004.\n   [KEYWORDS]             Bradner, S., \"\
    Key words for use in RFCs to\n                          Indicate Requirement Levels\"\
    , BCP 14,\n                          RFC 2119, March 1997.\n   [MAIL]        \
    \         Resnick, P., Ed., \"Internet Message Format\",\n                   \
    \       RFC 5322, October 2008.\n   [MIME]                 Freed, N. and N. Borenstein,\
    \ \"Multipurpose\n                          Internet Mail Extensions (MIME) Part\
    \ One:\n                          Format of Internet Message Bodies\", RFC 2045,\n\
    \                          November 1996.\n"
- title: 8.2.  Informative References
  contents:
  - "8.2.  Informative References\n   [AUTH]                 Siemborski, R. and A.\
    \ Melnikov, \"SMTP Service\n                          Extension for Authentication\"\
    , RFC 4954,\n                          July 2007.\n   [DKIM]                 Allman,\
    \ E., Callas, J., Delany, M., Libbey,\n                          M., Fenton, J.,\
    \ and M. Thomas, \"DomainKeys\n                          Identified Mail (DKIM)\
    \ Signatures\", RFC 4871,\n                          May 2007.\n   [DNS]     \
    \             Mockapetris, P., \"Domain names -\n                          implementation\
    \ and specification\", STD 13,\n                          RFC 1035, November 1987.\n\
    \   [DNS-IP6]              Thomson, S., Huitema, C., Ksinant, V., and M.\n   \
    \                       Souissi, \"DNS Extensions to Support IP Version\n    \
    \                      6\", RFC 3596, October 2003.\n   [DNSOP-REVERSE]      \
    \  Senie, D. and A. Sullivan, \"Considerations for\n                         \
    \ the use of DNS Reverse Mapping\", Work\n                          in Progress,\
    \ March 2008.\n   [DOMAINKEYS]           Delany, M., \"Domain-Based Email Authentication\n\
    \                          Using Public Keys Advertised in the DNS\n         \
    \                 (DomainKeys)\", RFC 4870, May 2007.\n   [DSN]              \
    \    Moore, K. and G. Vaudreuil, \"An Extensible\n                          Message\
    \ Format for Delivery Status\n                          Notifications\", RFC 3464,\
    \ January 2003.\n   [EMAIL-ARCH]           Crocker, D., \"Internet Mail Architecture\"\
    ,\n                          Work in Progress, October 2008.\n   [IANA-CONSIDERATIONS]\
    \  Narten, T. and H. Alvestrand, \"Guidelines for\n                          Writing\
    \ an IANA Considerations Section in\n                          RFCs\", BCP 26,\
    \ RFC 5226, May 2008.\n   [IMAP]                 Crispin, M., \"INTERNET MESSAGE\
    \ ACCESS PROTOCOL\n                          - VERSION 4rev1\", RFC 3501, March\
    \ 2003.\n   [POP3]                 Myers, J. and M. Rose, \"Post Office Protocol\
    \ -\n                          Version 3\", STD 53, RFC 1939, May 1996.\n   [SECURITY]\
    \             Rescorla, E. and B. Korver, \"Guidelines for\n                 \
    \         Writing RFC Text on Security Considerations\",\n                   \
    \       BCP 72, RFC 3552, July 2003.\n   [SENDERID]             Lyon, J. and M.\
    \ Wong, \"Sender ID:\n                          Authenticating E-Mail\", RFC 4406,\
    \ April 2006.\n   [SMTP]                 Klensin, J., \"Simple Mail Transfer Protocol\"\
    ,\n                          RFC 5321, October 2008.\n   [SPF]               \
    \   Wong, M. and W. Schlitt, \"Sender Policy\n                          Framework\
    \ (SPF) for Authorizing Use of Domains\n                          in E-Mail, Version\
    \ 1\", RFC 4408, April 2006.\n"
- title: Appendix A.  Legacy MUAs
  contents:
  - "Appendix A.  Legacy MUAs\n   Implementors of this proposal should be aware that\
    \ many MUAs are\n   unlikely to be retrofitted to support the new header field\
    \ and its\n   semantics.  In the interests of convenience and quicker adoption,\
    \ a\n   delivery MTA might want to consider adding things that are processed\n\
    \   by existing MUAs in addition to the Authentication-Results header\n   field.\
    \  One suggestion is to include a Priority header field, on\n   messages that\
    \ don't already have such a header field, containing a\n   value that reflects\
    \ the strength of the authentication that was\n   accomplished, e.g., \"low\"\
    \ for weak or no authentication, \"normal\" or\n   \"high\" for good or strong\
    \ authentication.\n   Some modern MUAs can already filter based on the content\
    \ of this\n   header field.  However, there is keen interest in having MUAs make\n\
    \   some kind of graphical representation of this header field's meaning\n   to\
    \ end users.  Until this capability is added, other interim means of\n   conveying\
    \ authentication results may be necessary while this proposal\n   and its successors\
    \ are adopted.\n"
- title: Appendix B.  Authentication-Results Examples
  contents:
  - "Appendix B.  Authentication-Results Examples\n   This section presents some examples\
    \ of the use of this header field\n   to indicate authentication results.\n"
- title: B.1.  Trivial Case; Header Field Not Present
  contents:
  - "B.1.  Trivial Case; Header Field Not Present\n   The trivial case:\n        Received:\
    \ from mail-router.example.com\n                      (mail-router.example.com\
    \ [192.0.2.1])\n                  by server.example.org (8.11.6/8.11.6)\n    \
    \                  with ESMTP id g1G0r1kA003489;\n                  Fri, Feb 15\
    \ 2002 17:19:07 -0800\n        From: sender@example.com\n        Date: Fri, Feb\
    \ 15 2002 16:54:30 -0800\n        To: receiver@example.org\n        Message-Id:\
    \ <12345.abc@example.com>\n        Subject: here's a sample\n        Hello!  Goodbye!\n\
    \   Example 1: Trivial case\n   The \"Authentication-Results\" header field is\
    \ completely absent.  The\n   MUA may make no conclusion about the validity of\
    \ the message.  This\n   could be the case because the message authentication\
    \ services were\n   not available at the time of delivery, or no service is provided,\
    \ or\n   the MTA is not in compliance with this specification.\n"
- title: B.2.  Nearly Trivial Case; Service Provided, But No Authentication Done
  contents:
  - "B.2.  Nearly Trivial Case; Service Provided, But No Authentication Done\n   A\
    \ message that was delivered by an MTA that conforms to this\n   specification\
    \ but provides no actual message authentication service:\n        Authentication-Results:\
    \ example.org; none\n        Received: from mail-router.example.com\n        \
    \              (mail-router.example.com [192.0.2.1])\n                  by server.example.org\
    \ (8.11.6/8.11.6)\n                      with ESMTP id g1G0r1kA003489;\n     \
    \             Fri, Feb 15 2002 17:19:07 -0800\n        From: sender@example.com\n\
    \        Date: Fri, Feb 15 2002 16:54:30 -0800\n        To: receiver@example.org\n\
    \        Message-Id: <12345.abc@example.com>\n        Subject: here's a sample\n\
    \        Hello!  Goodbye!\n   Example 2: Header present but no authentication\
    \ done\n   The \"Authentication-Results\" header field is present, showing that\n\
    \   the delivering MTA conforms to this specification.  It used its DNS\n   domain\
    \ name as the authserv-id.  The presence of \"none\" (and the\n   absence of any\
    \ method and result tokens) indicates that no message\n   authentication was done.\n"
- title: B.3.  Service Provided, Authentication Done
  contents:
  - "B.3.  Service Provided, Authentication Done\n   A message that was delivered\
    \ by an MTA that conforms to this\n   specification and applied some message authentication:\n\
    \        Authentication-Results: example.com;\n                  spf=pass smtp.mailfrom=example.net\n\
    \        Received: from dialup-1-2-3-4.example.net\n                      (dialup-1-2-3-4.example.net\
    \ [192.0.2.200])\n                  by mail-router.example.com (8.11.6/8.11.6)\n\
    \                      with ESMTP id g1G0r1kA003489;\n                  Fri, Feb\
    \ 15 2002 17:19:07 -0800\n        From: sender@example.net\n        Date: Fri,\
    \ Feb 15 2002 16:54:30 -0800\n        To: receiver@example.com\n        Message-Id:\
    \ <12345.abc@example.net>\n        Subject: here's a sample\n        Hello!  Goodbye!\n\
    \   Example 3: Header reporting results\n   The \"Authentication-Results\" header\
    \ field is present, indicating that\n   the border MTA conforms to this specification.\
    \  The authserv-id is\n   once again the DNS domain name.  Furthermore, the message\
    \ was\n   authenticated by that MTA via the method specified in [SPF].  Note\n\
    \   that since that method cannot authenticate the local-part, it has\n   been\
    \ omitted from the result's value.  The MUA could extract and\n   relay this extra\
    \ information if desired.\n"
- title: B.4.  Service Provided, Several Authentications Done, Single MTA
  contents:
  - "B.4.  Service Provided, Several Authentications Done, Single MTA\n   A message\
    \ that was relayed inbound via a single MTA that conforms to\n   this specification\
    \ and applied three different message authentication\n   checks:\n        Authentication-Results:\
    \ example.com;\n                  auth=pass (cram-md5) smtp.auth=sender@example.com;\n\
    \                  spf=pass smtp.mailfrom=example.com\n        Authentication-Results:\
    \ example.com;\n                  sender-id=pass header.from=example.com\n   \
    \     Received: from dialup-1-2-3-4.example.net (8.11.6/8.11.6)\n            \
    \          (dialup-1-2-3-4.example.net [192.0.2.200])\n                  by mail-router.example.com\
    \ (8.11.6/8.11.6)\n                      with ESMTP id g1G0r1kA003489;\n     \
    \             Fri, Feb 15 2002 17:19:07 -0800\n        Date: Fri, Feb 15 2002\
    \ 16:54:30 -0800\n        To: receiver@example.net\n        From: sender@example.com\n\
    \        Message-Id: <12345.abc@example.com>\n        Subject: here's a sample\n\
    \        Hello!  Goodbye!\n   Example 4: Headers reporting results from one MTA\n\
    \   The \"Authentication-Results\" header field is present, indicating the\n \
    \  delivering MTA conforms to this specification.  Once again, the\n   receiving\
    \ DNS domain name is used as the authserv-id.  Furthermore,\n   the sender authenticated\
    \ herself/himself to the MTA via a method\n   specified in [AUTH], and both [SPF]\
    \ and [SENDERID] checks were done\n   and passed.  The MUA could extract and relay\
    \ this extra information\n   if desired.\n   Two \"Authentication-Results\" header\
    \ fields are not required since the\n   same host did all of the checking.  The\
    \ authenticating agent could\n   have consolidated all the results into one header\
    \ field.\n   This example illustrates a scenario in which a remote user on a\n\
    \   dialup connection (example.net) sends mail to a border MTA\n   (example.com)\
    \ using SMTP authentication to prove identity.  The\n   dialup provider has been\
    \ explicitly authorized to relay mail as\n   \"example.com\" resulting in passes\
    \ by the SPF and SenderID checks.\n"
- title: B.5.  Service Provided, Several Authentications Done, Different MTAs
  contents:
  - "B.5.  Service Provided, Several Authentications Done, Different MTAs\n   A message\
    \ that was relayed inbound by two different MTAs that conform\n   to this specification\
    \ and applied multiple message authentication\n   checks:\n        Authentication-Results:\
    \ example.com;\n                  sender-id=hardfail header.from=example.com;\n\
    \                  dkim=pass (good signature) header.i=sender@example.com\n  \
    \      Received: from mail-router.example.com\n                      (mail-router.example.com\
    \ [192.0.2.1])\n                  by auth-checker.example.com (8.11.6/8.11.6)\n\
    \                      with ESMTP id i7PK0sH7021929;\n                  Fri, Feb\
    \ 15 2002 17:19:22 -0800\n        Authentication-Results: example.com;\n     \
    \             auth=pass (cram-md5) smtp.auth=sender@example.com;\n           \
    \       spf=hardfail smtp.mailfrom=example.com\n        Received: from dialup-1-2-3-4.example.net\n\
    \                      (dialup-1-2-3-4.example.net [192.0.2.200])\n          \
    \        by mail-router.example.com (8.11.6/8.11.6)\n                      with\
    \ ESMTP id g1G0r1kA003489;\n                  Fri, Feb 15 2002 17:19:07 -0800\n\
    \        DKIM-Signature:  v=1; a=rsa-sha256; s=gatsby; d=example.com;\n      \
    \            i=sender@example.com; t=1188964191; c=simple/simple;\n          \
    \        h=From:Date:To:Message-Id:Subject;\n                  bh=sEuZGD/pSr7ANysbY3jtdaQ3Xv9xPQtS0m70;\n\
    \                  b=EToRSuvUfQVP3Bkz ... rTB0t0gYnBVCM=\n        From: sender@example.com\n\
    \        Date: Fri, Feb 15 2002 16:54:30 -0800\n        To: receiver@example.com\n\
    \        Message-Id: <12345.abc@example.com>\n        Subject: here's a sample\n\
    \        Hello!  Goodbye!\n   Example 5: Headers reporting results from multiple\
    \ MTAs\n   The \"Authentication-Results\" header field is present, indicating\n\
    \   conformance to this specification.  Once again, the authserv-id used\n   is\
    \ the recipient's DNS domain name.  The header field is present\n   twice because\
    \ two different MTAs in the chain of delivery did\n   authentication tests.  The\
    \ first, \"mail-router.example.com\" reports\n   that [AUTH] and [SPF] were both\
    \ used, and [AUTH] passed but [SPF]\n   failed.  In the [AUTH] case, additional\
    \ data is provided in the\n   comment field, which the MUA can choose to render\
    \ if desired.\n   The second MTA, \"auth-checker.example.com\", reports that it\
    \ did a\n   [SENDERID] test (which failed) and a [DKIM] test (which passed).\n\
    \   Again, additional data about one of the tests is provided as a\n   comment,\
    \ which the MUA may choose to render.\n   Since different hosts did the two sets\
    \ of authentication checks, the\n   header fields cannot be consolidated in this\
    \ example.\n   This example illustrates more typical transmission of mail into\n\
    \   \"example.com\" from a user on a dialup connection \"example.net\".  The\n\
    \   user appears to be legitimate as he/she had a valid password allowing\n  \
    \ authentication at the border MTA using [AUTH].  The [SPF] and\n   [SENDERID]\
    \ tests failed since \"example.com\" has not granted\n   \"example.net\" authority\
    \ to relay mail on its behalf.  However, the\n   [DKIM] test passed because the\
    \ sending user had a private key\n   matching one of \"example.com\"'s published\
    \ public keys and used it to\n   sign the message.\n"
- title: B.6.  Service Provided, Multi-Tiered Authentication Done
  contents:
  - "B.6.  Service Provided, Multi-Tiered Authentication Done\n   A message that had\
    \ authentication done at various stages, one of\n   which was outside the receiving\
    \ ADMD:\n     Authentication-Results: example.com;\n           dkim=pass (good\
    \ signature) header.i=@mail-router.example.net;\n           dkim=fail (bad signature)\
    \ header.i=@newyork.example.com\n     Received: from mail-router.example.net\n\
    \               (mail-router.example.net [192.0.2.250])\n           by chicago.example.com\
    \ (8.11.6/8.11.6)\n               for <recipient@chicago.example.com>\n      \
    \         with ESMTP id i7PK0sH7021929;\n           Fri, Feb 15 2002 17:19:22\
    \ -0800\n     DKIM-Signature: v=1; a=rsa-sha256; s=furble;\n           d=mail-router.example.net;\
    \ t=1188964198; c=relaxed/simple;\n           h=From:Date:To:Message-Id:Subject:Authentication-Results;\n\
    \           bh=ftA9J6GtX8OpwUECzHnCkRzKw1uk6FNiLfJl5Nmv49E=;\n           b=oINEO8hgn/gnunsg\
    \ ... 9n9ODSNFSDij3=\n     Authentication-Results: example.net;\n           dkim=pass\
    \ (good signature) header.i=@newyork.example.com\n     Received: from smtp.newyork.example.com\n\
    \               (smtp.newyork.example.com [192.0.2.220])\n           by mail-router.example.net\
    \ (8.11.6/8.11.6)\n               with ESMTP id g1G0r1kA003489;\n           Fri,\
    \ Feb 15 2002 17:19:07 -0800\n     DKIM-Signature: v=1; a=rsa-sha256; s=gatsby;\
    \ d=newyork.example.com;\n           t=1188964191; c=simple/simple;\n        \
    \   h=From:Date:To:Message-Id:Subject;\n           bh=sEu28nfs9fuZGD/pSr7ANysbY3jtdaQ3Xv9xPQtS0m7=;\n\
    \           b=EToRSuvUfQVP3Bkz ... rTB0t0gYnBVCM=\n     From: sender@newyork.example.com\n\
    \     Date: Fri, Feb 15 2002 16:54:30 -0800\n     To: meetings@example.net\n \
    \    Message-Id: <12345.abc@newyork.example.com>\n     Subject: here's a sample\n\
    \   Example 6: Headers reporting results from multiple MTAs in different\n   ADMDs\n\
    \   In this example we see multi-tiered authentication with an extended\n   trust\
    \ boundary.\n   The message was sent from someone at example.com's New York office\n\
    \   (newyork.example.com) to a mailing list managed at an intermediary.\n   The\
    \ message was signed at the origin using [DKIM].\n   The message was sent to a\
    \ mailing list service provider called\n   example.net, which is used by example.com.\
    \  There,\n   meetings@example.net is expanded to a long list of recipients, one\
    \ of\n   that is at the Chicago office.  In this example, we will assume that\n\
    \   the trust boundary for chicago.example.com includes the mailing list\n   server\
    \ at example.net.\n   The mailing list server there first authenticated the message\
    \ and\n   affixed an Authentication-Results header field indicating such using\n\
    \   its DNS domain name for the authserv-id.  It then altered the message\n  \
    \ by affixing some footer text to the body, including some\n   administrivia such\
    \ as unsubscription instructions.  Finally, the\n   mailing list server affixes\
    \ a second [DKIM] signature and begins\n   distribution of the message.\n   The\
    \ border MTA for chicago.example.com explicitly trusts results from\n   mail-router.example.net\
    \ so that header field is not removed.  It\n   performs evaluation of both signatures\
    \ and determines that the first\n   (most recent) is a \"pass\" but, because of\
    \ the aforementioned\n   modifications, the second is a \"fail\".  However, the\
    \ first signature\n   included the Authentication-Results header added at mail-\n\
    \   router.example.net that validated the second signature.  Thus,\n   indirectly,\
    \ it can be determined that the authentications claimed by\n   both signatures\
    \ are indeed valid.\n"
- title: Appendix C.  Operational Considerations about Message Authentication
  contents:
  - "Appendix C.  Operational Considerations about Message Authentication\n   This\
    \ proposal is predicated on the idea that authentication (and\n   presumably in\
    \ the future, reputation) work is typically done by\n   border MTAs rather than\
    \ MUAs or intermediate MTAs; the latter merely\n   make use of the results determined\
    \ by the former.  Certainly this is\n   not mandatory for participation in electronic\
    \ mail or message\n   authentication, but the work of this proposal and its deployment\
    \ to\n   date is based on that model.  The assumption satisfies several common\n\
    \   ADMD requirements:\n   1.  Service operators prefer to resolve the handling\
    \ of problem\n       messages as close to the border of the ADMD as possible.\
    \  This\n       enables, for example, rejections of messages at the SMTP level\n\
    \       rather than generating a DSN internally.  Thus, doing any of the\n   \
    \    authentication or reputation work exclusively at the MUA or\n       intermediate\
    \ MTA renders this desire unattainable.\n   2.  Border MTAs are more likely to\
    \ have direct access to external\n       sources of authentication or reputation\
    \ information since modern\n       MUAs are more likely to be heavily firewalled.\
    \  Thus, some MUAs\n       might not even be able to complete the task of performing\n\
    \       authentication or reputation evaluations without complex proxy\n     \
    \  configurations or similar burdens.\n   3.  MUAs rely upon the upstream MTAs\
    \ within their trust boundaries to\n       make correct (as much as that is possible)\
    \ evaluations about the\n       message's envelope, header and content.  Thus,\
    \ MUAs don't need to\n       know how to do the work that upstream MTAs do; they\
    \ only need the\n       results of that work.\n   4.  Evaluations about the quality\
    \ of a message, from simple token\n       matching (e.g., a list of preferred\
    \ DNS domains) to cryptanalysis\n       (e.g., public/private key work), are at\
    \ least a little bit\n       expensive and thus should be minimized.  To that\
    \ end, performing\n       those tests at the border MTA is far preferred to doing\
    \ that work\n       at each MUA that handles a message.  If an ADMD's environment\n\
    \       adheres to common messaging protocols, a reputation query or an\n    \
    \   authentication check performed by a border MTA would return the\n       same\
    \ result as the same query performed by an MUA.  By contrast,\n       in an environment\
    \ where the MUA does the work, a message arriving\n       for multiple recipients\
    \ would thus cause authentication or\n       reputation evaluation to be done\
    \ more than once for the same\n       message (i.e., at each MUA) causing needless\
    \ amplification of\n       resource use and creating a possible denial-of-service\
    \ attack\n       vector.\n   5.  Minimizing change is good.  As new authentication\
    \ and reputation\n       methods emerge, the list of methods supported by this\
    \ header\n       field would presumably be extended.  If MUAs simply consume the\n\
    \       contents of this header field rather than actually attempting to\n   \
    \    do authentication and/or reputation work, then MUAs only need to\n      \
    \ learn to parse this header field once; emergence of new methods\n       requires\
    \ only a configuration change at the MUAs and software\n       changes at the\
    \ MTAs (which are presumably fewer in number).  When\n       choosing to implement\
    \ these functions in MTAs vs MUAs, the issues\n       of individual flexibility,\
    \ infrastructure inertia and scale of\n       effort must be considered.  It is\
    \ typically easier to change a\n       single MUA than an MTA because the modification\
    \ affects fewer\n       users and can be pursued with less care.  However, changing\
    \ many\n       MUAs is more effort than changing a smaller number of MTAs.\n \
    \  6.  For decisions affecting message delivery and display, assessment\n    \
    \   based on authentication and reputation is best performed close to\n      \
    \ the time of message transit, as a message makes its journey\n       toward a\
    \ user's inbox, not afterwards.  DKIM keys and IP address\n       reputations,\
    \ etc., can change over time or even become invalid,\n       and users can take\
    \ a long time to read a message once delivered.\n       The value of this work\
    \ thus degrades, perhaps quickly, once the\n       delivery process has completed.\
    \  This seriously diminishes the\n       value of this work when done other than\
    \ at MTAs.\n   Many operational choices are possible within an ADMD, including\
    \ the\n   venue for performing authentication and/or reputation assessment.\n\
    \   The current specification does not dictate any of those choices.\n   Rather,\
    \ it facilitates those cases in which information produced by\n   one stage of\
    \ analysis needs to be transported with the message to the\n   next stage.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   The author wishes to acknowledge the following for their\
    \ review and\n   constructive criticism of this proposal: Eric Allman, Mark Delany,\n\
    \   Victor Duchovni, Frank Ellermann, Jim Fenton, Philip Guenther, Tony\n   Hansen,\
    \ Paul Hoffman, Scott Kitterman, Eliot Lear, John Levine, Miles\n   Libbey, Charles\
    \ Lindsey, Alexey Melnikov, Douglas Otis, Juan Altmayer\n   Pizzorno, Michael\
    \ Thomas, and Kazu Yamamoto.\n   Special thanks to Dave Crocker and S. Moonesamy\
    \ for their logistical\n   support, and feedback on and contributions to the numerous\
    \ proposed\n   edits throughout the lifetime of this work.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Murray S. Kucherawy\n   Sendmail, Inc.\n   6475 Christie\
    \ Ave., Suite 350\n   Emeryville, CA  94608\n   US\n   Phone: +1 510 594 5400\n\
    \   EMail: msk+ietf@sendmail.com\n"
