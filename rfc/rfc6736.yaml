- title: __initial_text__
  contents:
  - '   Diameter Network Address and Port Translation Control Application

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes the framework, messages, and procedures\
    \ for\n   the Diameter Network address and port translation Control\n   Application.\
    \  This Diameter application allows per-endpoint control\n   of Network Address\
    \ Translators and Network Address and Port\n   Translators, which are added to\
    \ networks to cope with IPv4 address\n   space depletion.  This Diameter application\
    \ allows external devices\n   to configure and manage a Network Address Translator\
    \ device --\n   expanding the existing Diameter-based Authentication, Authorization,\n\
    \   and Accounting (AAA) and policy control capabilities with a Network\n   Address\
    \ Translator and Network Address and Port Translator control\n   component.  These\
    \ external devices can be network elements in the\n   data plane such as a Network\
    \ Access Server, or can be more\n   centralized control plane devices such as\
    \ AAA-servers.  This Diameter\n   application establishes a context to commonly\
    \ identify and manage\n   endpoints on a gateway or server and a Network Address\
    \ Translator and\n   Network Address and Port Translator device.  This includes,\
    \ for\n   example, the control of the total number of Network Address\n   Translator\
    \ bindings allowed or the allocation of a specific Network\n   Address Translator\
    \ binding for a particular endpoint.  In addition,\n   it allows Network Address\
    \ Translator devices to provide information\n   relevant to accounting purposes.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6736.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \   2. Conventions .....................................................6\n  \
    \ 3. Deployment Framework ............................................7\n    \
    \  3.1. Deployment Scenario ........................................7\n      3.2.\
    \ Diameter NAPT Control Application Overview .................9\n      3.3. Deployment\
    \ Scenarios for DNCA .............................10\n   4. DNCA Session Establishment\
    \ and Management ......................12\n      4.1. Session Establishment .....................................13\n\
    \      4.2. Session Update ............................................16\n  \
    \    4.3. Session and Binding Query .................................18\n    \
    \  4.4. Session Termination .......................................20\n      4.5.\
    \ Session Abort .............................................21\n      4.6. Failure\
    \ Cases of the DNCA Diameter Peers ..................22\n   5. Use of the Diameter\
    \ Base Protocol ..............................23\n      5.1. Securing Diameter\
    \ Messages ................................23\n      5.2. Accounting Functionality\
    \ ..................................24\n      5.3. Use of Sessions ...........................................24\n\
    \      5.4. Routing Considerations ....................................24\n  \
    \    5.5. Advertising Application Support ...........................24\n   6.\
    \ DNCA Commands ..................................................25\n      6.1.\
    \ NAT-Control-Request (NCR) Command .........................25\n      6.2. NAT-Control-Answer\
    \ (NCA) Command ..........................26\n   7. NAT Control Application Session\
    \ State Machine ..................26\n   8. DNCA AVPs ......................................................29\n\
    \      8.1. Reused Base Protocol AVPs .................................29\n  \
    \    8.2. Additional Result-Code AVP Values .........................30\n    \
    \       8.2.1. Success ............................................30\n      \
    \     8.2.2. Transient Failures .................................30\n        \
    \   8.2.3. Permanent Failures .................................31\n      8.3.\
    \ Reused NASREQ Diameter Application AVPs ...................32\n      8.4. Reused\
    \ AVPs from RFC 4675 .................................33\n      8.5. Reused AVPs\
    \ from Diameter QoS Application .................33\n      8.6. Reused AVPs from\
    \ ETSI ES 283 034, e4 Diameter\n           Application ...............................................34\n\
    \      8.7. DNCA-Defined AVPs .........................................35\n  \
    \         8.7.1. NC-Request-Type AVP ................................36\n    \
    \       8.7.2. NAT-Control-Install AVP ............................36\n      \
    \     8.7.3. NAT-Control-Remove AVP .............................37\n        \
    \   8.7.4. NAT-Control-Definition AVP .........................37\n          \
    \ 8.7.5. NAT-Internal-Address AVP ...........................38\n           8.7.6.\
    \ NAT-External-Address AVP ...........................38\n           8.7.7. Max-NAT-Bindings\
    \ ...................................39\n           8.7.8. NAT-Control-Binding-Template\
    \ AVP ...................39\n           8.7.9. Duplicate-Session-Id AVP ...........................39\n\
    \           8.7.10. NAT-External-Port-Style AVP .......................39\n  \
    \ 9. Accounting Commands ............................................40\n    \
    \  9.1. NAT Control Accounting Messages ...........................40\n      9.2.\
    \ NAT Control Accounting AVPs ...............................40\n           9.2.1.\
    \ NAT-Control-Record .................................41\n           9.2.2. NAT-Control-Binding-Status\
    \ .........................41\n           9.2.3. Current-NAT-Bindings ...............................41\n\
    \   10. AVP Occurrence Tables .........................................41\n  \
    \    10.1. DNCA AVP Table for NAT Control Initial and Update\n            Requests\
    \ .................................................42\n      10.2. DNCA AVP Table\
    \ for Session Query Requests ................43\n      10.3. DNCA AVP Table for\
    \ Accounting Messages ...................43\n   11. IANA Considerations ...........................................44\n\
    \      11.1. Application Identifier ...................................44\n  \
    \    11.2. Command Codes ............................................44\n    \
    \  11.3. AVP Codes ................................................44\n      11.4.\
    \ Result-Code AVP Values ...................................44\n      11.5. NC-Request-Type\
    \ AVP ......................................44\n      11.6. NAT-External-Port-Style\
    \ AVP ..............................45\n      11.7. NAT-Control-Binding-Status\
    \ AVP ...........................45\n   12. Security Considerations .......................................45\n\
    \   13. Examples ......................................................47\n  \
    \    13.1. DNCA Session Establishment Example .......................47\n    \
    \  13.2. DNCA Session Update with Port Style Example ..............50\n      13.3.\
    \ DNCA Session Query Example ...............................51\n      13.4. DNCA\
    \ Session Termination Example .........................53\n   14. Acknowledgements\
    \ ..............................................55\n   15. References ....................................................55\n\
    \      15.1. Normative References .....................................55\n  \
    \    15.2. Informative References ...................................56\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Internet service providers deploy Network Address Translators\
    \ (NATs)\n   and Network Address and Port Translators (NAPTs) [RFC3022] in their\n\
    \   networks.  A key motivation for doing so is the depletion of\n   available\
    \ public IPv4 addresses.  This document defines a Diameter\n   application allowing\
    \ providers to control the behavior of NAT and\n   NAPT devices that implement\
    \ IPv4-to-IPv4 network address and port\n   translation [RFC2663] as well as stateful\
    \ IPv6-to-IPv4 address family\n   translation as defined in [RFC2663], [RFC6145],\
    \ and [RFC6146].  The\n   use of a Diameter application allows for simple integration\
    \ into the\n   existing Authentication, Authorization, and Accounting (AAA)\n\
    \   environment of a provider.\n   The Diameter Network address and port translation\
    \ Control Application\n   (DNCA) offers the following capabilities:\n   1.  Limits\
    \ or defines the number of NAPT/NAT-bindings made available\n       to an individual\
    \ endpoint.  The main motivation for restricting\n       the number of bindings\
    \ on a per-endpoint basis is to protect the\n       service of the service provider\
    \ against denial-of-service (DoS)\n       attacks.  If multiple endpoints share\
    \ a single public IP address,\n       these endpoints can share fate.  If one\
    \ endpoint would (either\n       intentionally, or due to misbehavior, misconfiguration,\
    \ malware,\n       etc.) be able to consume all available bindings for a given\n\
    \       single public IP address, service would be hampered (or might\n      \
    \ even become unavailable) for those other endpoints sharing the\n       same\
    \ public IP address.  The efficiency of a NAPT deployment\n       depends on the\
    \ maximum number of bindings an endpoint could use.\n       Given that the typical\
    \ number of bindings an endpoint uses\n       depends on the type of endpoint\
    \ (e.g., a personal computer of a\n       broadband user is expected to use a\
    \ higher number of bindings\n       than a simple mobile phone) and a NAPT device\
    \ is often shared by\n       different types of endpoints, it is desirable to\
    \ actively manage\n       the maximum number of bindings.  This requirement is\
    \ specified in\n       REQ-3 of [CGN-REQS].\n   2.  Supports the allocation of\
    \ specific NAPT/NAT-bindings.  Two types\n       of specific bindings can be distinguished:\n\
    \       *  Allocation of a predefined NAT-binding: The internal and\n        \
    \  external IP addresses as well as the port pair are specified\n          within\
    \ the request.  Some deployment cases, such as access to\n          a web-server\
    \ within a user's home network with IP address and\n          port, benefit from\
    \ statically configured bindings.\n       *  Allocation of an external IP address\
    \ for a given internal IP\n          address: The allocated external IP address\
    \ is reported back to\n          the requester.  In some deployment scenarios,\
    \ the application\n          requires immediate knowledge of the allocated binding\
    \ for a\n          given internal IP address but does not control the allocation\n\
    \          of the external IP address; for example, SIP-proxy server\n       \
    \   deployments.\n   3.  Defines the external address pool(s) to be used for allocating\
    \ an\n       external IP address: External address pools can be either pre-\n\
    \       assigned at the NAPT/NAT device or specified within a request.\n     \
    \  If pre-assigned address pools are used, a request needs to\n       include\
    \ a reference to identify the pool.  Otherwise, the request\n       contains a\
    \ description of the IP address pool(s) to be used, for\n       example, a list\
    \ of IP-subnets.  Such external address pools can\n       be used to select the\
    \ external IP address in NAPT/NAT-bindings\n       for multiple subscribers.\n\
    \   4.  Generates reports and accounting records: Reports established\n      \
    \ bindings for a particular endpoint.  The collected information is\n       used\
    \ by accounting systems for statistical purposes.\n   5.  Queries and retrieves\
    \ details about bindings on demand: This\n       feature complements the previously\
    \ mentioned accounting\n       functionality (see item 4).  This feature can be\
    \ used by an\n       entity to find NAT-bindings belonging to one or multiple\n\
    \       endpoints on the NAT device.  The entity is not required to\n       create\
    \ a DNCA control session to perform the query but would,\n       obviously, still\
    \ need to create a Diameter session complying to\n       the security requirements.\n\
    \   6.  Identifies a subscriber or endpoint on multiple network devices\n    \
    \   (NAT/NAPT device, the AAA-server, or the Network Access Server\n       (NAS)):\
    \ Endpoint identification is facilitated through a Global\n       Endpoint ID.\
    \  Endpoints are identified through a single\n       classifier or a set of classifiers,\
    \ such as IP address, Virtual\n       Local Area Network (VLAN) identifier, or\
    \ interface identifier\n       that uniquely identify the traffic associated with\
    \ a particular\n       global endpoint.\n   With the above capabilities, DNCA\
    \ qualifies as a Middlebox\n   Communications (MIDCOM) protocol [RFC3303], [RFC3304],\
    \ [RFC5189] for\n   middleboxes that perform NAT.  The MIDCOM protocol evaluation\n\
    \   [RFC4097] evaluated Diameter as a candidate protocol for MIDCOM.\n   DNCA\
    \ provides the extensions to the Diameter base protocol [RFC6733]\n   following\
    \ the MIDCOM protocol requirements, such as the support of\n   NAT-specific rule\
    \ transport, support for oddity of mapped ports, as\n   well as support for consecutive\
    \ range port numbers.  DNCA adds to the\n   MIDCOM protocol capabilities in that\
    \ it allows the maintenance of the\n   reference to an endpoint representing a\
    \ user or subscriber in the\n   control operation, enabling the control of the\
    \ behavior of a NAT\n   device on a per-endpoint basis.  Following the requirements\
    \ of\n   different operators and deployments, different management protocols\n\
    \   are employed.  Examples include, for example, Simple Network\n   Management\
    \ Protocol (SNMP) [RFC3411] and Network Configuration\n   (NETCONF) [RFC6241],\
    \ which can both be used for device configuration.\n   Similarly, DNCA complements\
    \ existing MIDCOM implementations, offering\n   a MIDCOM protocol option for operators\
    \ with an operational\n   environment that is Diameter focused that desire the\
    \ use of Diameter\n   to perform per-endpoint NAT control.  Note that in case\
    \ an operator\n   uses multiple methods and protocols to configure a NAT device,\
    \ such\n   as, for example, command line interface (CLI), SNMP, NETCONF, or Port\n\
    \   Control Protocol (PCP), along with DNCA specified in this document,\n   the\
    \ operator MUST ensure that the configurations performed using the\n   different\
    \ methods and protocols do not conflict in order to ensure a\n   proper operation\
    \ of the NAT service.\n   This document is structured as follows: Section 2 lists\
    \ terminology,\n   while Section 3 provides an introduction to DNCA and its overall\n\
    \   deployment framework.  Sections 3.2 to 8 cover DNCA specifics, with\n   Section\
    \ 3.2 describing session management, Section 5 the use of the\n   Diameter base\
    \ protocol, Section 6 new commands, Section 8 Attribute\n   Value Pairs (AVPs)\
    \ used, and Section 9 accounting aspects.\n   Section 10 presents AVP occurrence\
    \ tables.  IANA and security\n   considerations are addressed in Sections 11 and\
    \ 12, respectively.\n"
- title: 2.  Conventions
  contents:
  - "2.  Conventions\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n\
    \   Abbreviations and terminology used in this document:\n      AAA: Authentication,\
    \ Authorization, Accounting\n      DNCA: Diameter Network address and port translation\
    \ Control\n      Application\n      Endpoint: Managed entity of the DNCA.  An\
    \ endpoint represents a\n      network element or device, associated with a subscriber,\
    \ a user,\n      or a group of users.  An endpoint is represented by a single\n\
    \      access-session on a NAS.  DNCA assumes a 1:1 relationship between\n   \
    \   an endpoint, the access-session it represents, and the associated\n      DNCA\
    \ session.\n      NAPT: Network Address and Port Translation, see also [RFC3022].\n\
    \      NAT: Network Address Translation (NAT and NAPT are used in this\n     \
    \ document interchangeably)\n      NAT-binding or binding: Association of two\
    \ IP address/port pairs\n      (with one IP address typically being private and\
    \ the other one\n      public) to facilitate NAT\n      NAT-binding predefined\
    \ template: A policy template or\n      configuration that is predefined at the\
    \ NAT device.  It may\n      contain NAT-bindings, IP address pools for allocating\
    \ the external\n      IP address of a NAT-binding, the maximum number of allowed\
    \ NAT-\n      bindings for endpoints, etc.\n      NAT device: Network Address\
    \ Translator or Network Address and Port\n      Translator: An entity performing\
    \ NAT or NAPT.\n      NAT controller: Entity controlling the behavior of a NAT\
    \ device.\n      NAS: Network Access Server\n      NCR: NAT-Control-Request\n\
    \      NCA: NAT-Control-Answer\n      NAT44: IPv4-to-IPv4 NAPT, see [RFC2663]\n\
    \      NAT64: IPv6-to-IPv4 address family translation, see [RFC6145] and\n   \
    \   [RFC6146]\n      PPP: Point-to-Point Protocol [RFC1661]\n"
- title: 3.  Deployment Framework
  contents:
  - '3.  Deployment Framework

    '
- title: 3.1.  Deployment Scenario
  contents:
  - "3.1.  Deployment Scenario\n   Figure 1 shows a typical network deployment for\
    \ IPv4 Internet access.\n   A user's IPv4 host (i.e., endpoint) gains access to\
    \ the Internet\n   though a NAS, which facilitates the authentication of the endpoint\n\
    \   and configures the endpoint's connection according to the\n   authorization\
    \ and configuration data received from the AAA-server\n   upon successful authentication.\
    \  Public IPv4 addresses are used\n   throughout the network.  DNCA manages an\
    \ endpoint that represents a\n   network element or device or an IPv4 host, associated\
    \ with a\n   subscriber, a user or a group of users.  An endpoint is represented\n\
    \   by a single access-session on a NAS.  DNCA assumes a 1:1:1\n   relationship\
    \ between an endpoint, the access-session it represents,\n   and the associated\
    \ DNCA session.\n                         +---------+\n                      \
    \   |         |\n                         |   AAA   |\n                      \
    \   |         |\n                         +---------+\n                      \
    \        |\n                              |\n                              |\n\
    \                              |\n    +---------+          +---------+       \
    \      +----------+\n    |  IPv4   |          |         |             |  IPv4\
    \    |\n    |  Host   |----------|   NAS   |-------------| Internet |\n    | \
    \        |          |         |             |          |\n    +---------+    \
    \      +---------+             +----------+\n    <-------------------- Public\
    \ IPv4 ---------------------->\n         Figure 1: Typical Network Deployment\
    \ for Internet Access\n   Figure 2 depicts the deployment scenario where a service\
    \ provider\n   places a NAT between the host and the public Internet.  The objective\n\
    \   is to provide the customer with connectivity to the public IPv4\n   Internet.\
    \  The NAT device performs network address and port (and\n   optionally address\
    \ family) translation, depending on whether the\n   access network uses private\
    \ IPv4 addresses or public IPv6 addresses\n   to public IPv4 addresses.  Note\
    \ that there may be more than one NAS,\n   NAT device, or AAA-entity in a deployment,\
    \ although the figures only\n   depict one entity each for clarity.\n   If the\
    \ NAT device would be put in place without any endpoint\n   awareness, the service\
    \ offerings of the service provider could be\n   impacted as detailed in [CGN-REQS].\
    \  This includes cases like the\n   following:\n   o  Provisioning static NAT-bindings\
    \ for particular endpoints\n   o  Using different public IP address pools for\
    \ a different set of\n      endpoints (for example, residential or business customers)\n\
    \   o  Reporting allocated bindings on a per-endpoint basis\n   o  Integrate control\
    \ of the NAT device into the already existing per-\n      endpoint management\
    \ infrastructure of the service provider\n                   +---------+\n   \
    \                |         |\n                   |   AAA   |\n               \
    \    |         |\n                   +---------+\n                        |\n\
    \                        |\n                        |\n                      \
    \  |\n     +--------+    +---------+    +--------+    +----------+\n     |  IPv4\
    \  |----|         |----|  NAT-  |----| IPv4     |\n     |  Host  |    |   NAS\
    \   |    | device |    | Internet |\n     |        |    |         |    |     \
    \   |    |          |\n     +--------+    +---------+    +--------+    +----------+\n\
    \   For NAT44 deployments (IPv4 host):\n        <----- Private IPv4 ----------><---\
    \ Public IPv4 --->\n   For NAT64 deployments (IPv6 host):\n        <----- Public\
    \  IPv6 ----------><--- Public IPv4 --->\n               Figure 2: Access Network\
    \ Deployment with NAT\n   Figure 2 shows a typical deployment for IPv4 Internet\
    \ access\n   involving a NAT device within the service provider network.  The\n\
    \   figure describes two scenarios: one where an IPv4 host (with a\n   private\
    \ IPv4 address) accesses the IPv4 Internet, as well as one\n   where an IPv6-host\
    \ accesses the IPv4 Internet.\n"
- title: 3.2.  Diameter NAPT Control Application Overview
  contents:
  - "3.2.  Diameter NAPT Control Application Overview\n   DNCA runs between two DNCA\
    \ Diameter peers.  One DNCA Diameter peer\n   resides within the NAT device, the\
    \ other DNCA Diameter peer resides\n   within a NAT controller (discussed in Section\
    \ 3.3).  DNCA allows per-\n   endpoint control and management of NAT within the\
    \ NAT device.  Based\n   on Diameter, DNCA integrates well with the suite of Diameter\n\
    \   applications deployed for per-endpoint authentication, authorization,\n  \
    \ accounting, and policy control in service provider networks.\n   DNCA offers:\n\
    \   o  Request and answer commands to control the allowed number of NAT-\n   \
    \   bindings per endpoint, to request the allocation of specific\n      bindings\
    \ for an endpoint, to define the address pool to be used\n      for an endpoint.\n\
    \   o  Per-endpoint reporting of the allocated NAT-bindings.\n   o  Unique identification\
    \ of an endpoint on a NAT device, AAA-server,\n      and NAS to simplify correlation\
    \ of accounting data streams.\n   DNCA allows controlling the behavior of a NAT\
    \ device on a per-\n   endpoint basis during initial session establishment and\
    \ at later\n   stages by providing an update procedure for already established\n\
    \   sessions.  Using DNCA, per-endpoint NAT-binding information can be\n   retrieved\
    \ using either accounting mechanisms or an explicit session\n   query to the NAT.\n"
- title: 3.3.  Deployment Scenarios for DNCA
  contents:
  - "3.3.  Deployment Scenarios for DNCA\n   DNCA can be deployed in different ways.\
    \  DNCA supports deployments\n   with \"n\" NAT controllers and \"m\" NAT devices,\
    \ with n and m equal to\n   or greater than 1.  From a DNCA perspective, an operator\
    \ should\n   ensure that the session representing a particular endpoint is atomic.\n\
    \   Any deployment MUST ensure that, for any given endpoint, only a\n   single\
    \ DNCA NAT controller and is active at any point in time.  This\n   is to ensure\
    \ that NAT devices controlled by multiple NAT controllers\n   do not receive conflicting\
    \ control requests for a particular endpoint\n   or that they would not be unclear\
    \ about to which NAT controller to\n   send accounting information.  Operational\
    \ considerations MAY require\n   an operator to use alternate control mechanisms\
    \ or protocols such as\n   SNMP or manual configuration via a CLI to apply per-endpoint\
    \ NAT-\n   specific configuration, for example, static NAT-bindings.  For these\n\
    \   cases, the NAT device MUST allow the operator to configure a policy\n   on\
    \ how configuration conflicts are resolved.  Such a policy could\n   specify,\
    \ for example, that manually configured NAT-bindings using the\n   CLI always\
    \ take precedence over those configured using DNCA.\n   Two common deployment\
    \ scenarios are outlined in Figure 3 (\"Integrated\n   Deployment\") and Figure\
    \ 4 (\"Autonomous Deployment\").  Per the note\n   above, multiple instances of\
    \ NAT controllers and NAT devices could be\n   deployed.  The figures only show\
    \ single instances for reasons of\n   clarity.  The two shown scenarios differ\
    \ in which entity fulfills the\n   role of the NAT controller.  Within the figures,\
    \ (C) denotes the\n   network element performing the role of the NAT controller.\n\
    \   The integrated deployment approach hides the existence of the NAT\n   device\
    \ from external servers, such as the AAA-server.  It is suited\n   for environments\
    \ where minimal changes to the existing AAA deployment\n   are desired.  The NAS\
    \ and the NAT device are Diameter peers\n   supporting the DNCA.  The Diameter\
    \ peer within the NAS, performing\n   the role of the NAT controller, initiates\
    \ and manages sessions with\n   the NAT device, exchanges NAT-specific configuration\
    \ information, and\n   handles reporting and accounting information.  The NAS\
    \ receives\n   reporting and accounting information from the NAT device.  With\
    \ this\n   information, the NAS can provide a single accounting record for the\n\
    \   endpoint.  A system correlating the accounting information received\n   from\
    \ the NAS and NAT device would not be needed.\n   An example network attachment\
    \ for an integrated NAT deployment can be\n   described as follows: an endpoint\
    \ connects to the network, with the\n   NAS being the point of attachment.  After\
    \ successful authentication,\n   the NAS receives endpoint-related authorization\
    \ data from the AAA-\n   server.  A portion of the authorization data applies\
    \ to per-endpoint\n   configuration on the NAS itself, another portion describes\n\
    \   authorization and configuration information for NAT control aimed at\n   the\
    \ NAT device.  The NAS initiates a DNCA session to the NAT device\n   and sends\
    \ relevant authorization and configuration information for\n   the particular\
    \ endpoint to the NAT device.  This can comprise NAT-\n   bindings, which have\
    \ to be pre-established for the endpoint, or\n   management-related configuration,\
    \ such as the maximum number of NAT-\n   bindings allowed for the endpoint.  The\
    \ NAT device sends its per-\n   endpoint accounting information to the NAS, which\
    \ aggregates the\n   accounting information received from the NAT device with\
    \ its local\n   accounting information for the endpoint into a single accounting\n\
    \   stream towards the AAA-server.\n                   +---------+\n         \
    \          |         |\n                   |   AAA   |\n                   | \
    \        |\n                   +---------+\n                        |\n      \
    \                  |\n                        |\n     +--------+    +---------+\
    \    +--------+    +----------+\n     |        |    |   (C)   |    |        |\
    \    |          |\n     |  Host  |----|   NAS   |----|  NAT-  |----| IPv4    \
    \ |\n     |        |    |         |    | device |    | Internet |\n     +--------+\
    \    +---------+    +--------+    +----------+\n   For NAT44 deployments (IPv4\
    \ host):\n        <----- Private IPv4 ----------><--- Public IPv4 --->\n   For\
    \ NAT64 deployments (IPv6 host):\n        <----- Public  IPv6 ----------><---\
    \ Public IPv4 --->\n          Figure 3: NAT Control Deployment: Integrated Deployment\n\
    \   Figure 3 shows examples of integrated deployments.  It illustrates\n   two\
    \ scenarios: one where an IPv4 host (with a private IPv4 address)\n   accesses\
    \ the IPv4 Internet and another where an IPv6 host accesses\n   the IPv4 Internet.\n\
    \   The autonomous deployment approach decouples endpoint management on\n   the\
    \ NAS and NAT device.  In the autonomous deployment approach, the\n   AAA-system\
    \ and the NAT device are the Diameter peers running the\n   DNCA.  The AAA-system\
    \ also serves as NAT controller.  It manages the\n   connection to the NAT device,\
    \ controls the per-endpoint\n   configuration, and receives accounting and reporting\
    \ information from\n   the NAT device.  Different from the integrated deployment\
    \ scenario,\n   the autonomous deployment scenario does not \"hide\" the existence\
    \ of\n   the NAT device from the AAA infrastructure.  Here, two accounting\n \
    \  streams are received by the AAA-server for one particular endpoint:\n   one\
    \ from the NAS and one from the NAT device.\n                   +---------+\n\
    \                   |   (C)   |\n                   |   AAA   |---------\n   \
    \                |         |         |\n                   +---------+       \
    \  |\n                        |              |\n                        |    \
    \          |\n                        |              |\n     +--------+    +---------+\
    \    +---------+    +----------+\n     |  IPv4/ |    |         |    |        \
    \ |    |  IPv4    |\n     |  IPv6  |----|   NAS   |----|  NAT-   |----| Internet\
    \ |\n     |  Host  |    |         |    | device  |    |          |\n     +--------+\
    \    +---------+    +---------+    +----------+\n   For NAT44 deployments (IPv4\
    \ host):\n        <----- Private IPv4 ----------><--- Public IPv4 --->\n   For\
    \ NAT64 deployments (IPv6 host):\n        <----- Public  IPv6 ----------><---\
    \ Public IPv4 --->\n          Figure 4: NAT Control Deployment: Autonomous Deployment\n\
    \   Figure 4 shows examples of autonomous deployments.  It illustrates\n   two\
    \ scenarios: one where an IPv4 host (with a private IPv4 address)\n   accesses\
    \ the IPv4 Internet and another where an IPv6 host accesses\n   the IPv4 Internet.\n"
- title: 4.  DNCA Session Establishment and Management
  contents:
  - "4.  DNCA Session Establishment and Management\n   Note that from this section\
    \ on, there are references to some of the\n   commands and AVPs defined for DNCA.\
    \  Please refer to Sections 6 and 8\n   for details.  DNCA runs between a Diameter\
    \ peer residing in a NAT\n   controller and a Diameter peer residing in a NAT\
    \ device.  Note that,\n   per what was already mentioned above, each DNCA session\
    \ between\n   Diameter peers in a NAT controller and a NAT device represents a\n\
    \   single endpoint, with an endpoint being either a network element, a\n   device,\
    \ or an IPv4 host associated with a subscriber, a user, or a\n   group of users.\
    \  The Diameter peer within the NAT controller is\n   always the control-requesting\
    \ entity: it initiates, updates, or\n   terminates the sessions.  Sessions are\
    \ initiated when the NAT\n   controller learns about a new endpoint (i.e., host)\
    \ that requires a\n   NAT service.  This could be due to, for example, the entity\
    \ hosting\n   the NAT controller receiving authentication, authorization, or\n\
    \   accounting requests for or from the endpoint.  Alternate methods that\n  \
    \ could trigger session setup include local configuration, receipt of a\n   packet\
    \ from a formerly unknown IP address, etc.\n"
- title: 4.1.  Session Establishment
  contents:
  - "4.1.  Session Establishment\n   The DNCA Diameter peer within the NAT controller\
    \ establishes a\n   session with the DNCA Diameter peer within the NAT device\
    \ to control\n   the behavior of the NAT function within the NAT device.  During\n\
    \   session establishment, the DNCA Diameter peer within the NAT\n   controller\
    \ passes along configuration information to the DNCA\n   Diameter peer within\
    \ the NAT device.  The session configuration\n   information comprises the maximum\
    \ number of bindings allowed for the\n   endpoint associated with this session,\
    \ a set of predefined NAT-\n   bindings to be established for this endpoint, or\
    \ a description of the\n   address pool, from which external addresses are to\
    \ be allocated.\n   The DNCA Diameter peer within the NAT controller generates\
    \ a NAT-\n   Control-Request (NCR) message to the DNCA Diameter peer within the\n\
    \   NAT device with the NC-Request-Type AVP set to INITIAL_REQUEST to\n   initiate\
    \ a Diameter NAT control session.  On receipt of an NCR, the\n   DNCA Diameter\
    \ peer within the NAT device sets up a new session for\n   the endpoint associated\
    \ with the endpoint classifier(s) contained in\n   the NCR.  The DNCA Diameter\
    \ peer within the NAT device notifies its\n   DNCA Diameter peer within the NAT\
    \ controller about successful session\n   setup using a NAT-Control-Answer (NCA)\
    \ message with the Result-Code\n   set to DIAMETER_SUCCESS.  Figure 5 shows the\
    \ initial protocol\n   interaction between the two DNCA Diameter peers.\n   The\
    \ initial NAT-Control-Request MAY contain configuration information\n   for the\
    \ session, which specifies the behavior of the NAT device for\n   the session.\
    \  The configuration information that MAY be included,\n   comprises:\n   o  A\
    \ list of NAT-bindings, which should be pre-allocated for the\n      session;\
    \ for example, in case an endpoint requires a fixed\n      external IP address/port\
    \ pair for an application.\n   o  The maximum number of NAT-bindings allowed for\
    \ an endpoint.\n   o  A description of the external IP address pool(s) to be used\
    \ for\n      the session.\n   o  A reference to a NAT-binding Predefined template\
    \ on the NAT\n      device, which is applied to the session.  Such a NAT-binding\n\
    \      Predefined template on the NAT device may contain, for example,\n     \
    \ the name of the IP address pool from which external IP addresses\n      should\
    \ be allocated, the maximum number of bindings permitted for\n      the endpoint,\
    \ etc.\n   In certain cases, the NAT device may not be able to perform the tasks\n\
    \   requested within the NCR.  These include the following:\n   o  If a DNCA Diameter\
    \ peer within the NAT device receives an NCR from\n      a DNCA Diameter peer\
    \ within a NAT controller with the NC-Request-\n      Type AVP set to INITIAL_REQUEST\
    \ that identifies an already\n      existing session, that is, the endpoint identifier\
    \ matches an\n      already existing session, the DNCA Diameter peer within the\
    \ NAT\n      device MUST return an NCA with the Result-Code set to\n      SESSION_EXISTS\
    \ and provide the Session-Id of the existing session\n      in the Duplicate-Session-Id\
    \ AVP.\n   o  If a DNCA Diameter peer within the NAT device receives an NCR from\n\
    \      a DNCA Diameter peer within a NAT controller with the NC-Request-\n   \
    \   Type AVP set to INITIAL_REQUEST that matches more than one of the\n      already\
    \ existing sessions, that is, the DNCA Diameter peer and\n      endpoint identifier\
    \ match already existing sessions, the DNCA\n      Diameter peer within the NAT\
    \ device MUST return an NCA with the\n      Result-Code set to INSUFFICIENT-CLASSIFIERS.\
    \  In case a DNCA\n      Diameter peer receives an NCA that reports Insufficient-\n\
    \      Classifiers, it MAY choose to retry establishing a new session\n      using\
    \ additional or more specific classifiers.\n   o  If the NCR contains a NAT-binding\
    \ Predefined template not defined\n      on the NAT device, the DNCA Diameter\
    \ peer within the NAT device\n      MUST return an NCA with the Result-Code AVP\
    \ set to\n      UNKNOWN_BINDING_TEMPLATE_NAME.\n   o  In case the NAT device is\
    \ unable to establish all of the bindings\n      requested in the NCR, the DNCA\
    \ Diameter peer MUST return an NCA\n      with the Result-Code set to BINDING_FAILURE.\
    \  A DNCA Diameter peer\n      within a NAT device MUST treat an NCR as an atomic\
    \ operation;\n      hence, none of the requested bindings will be established\
    \ by the\n      NAT device.  Either all requested actions within an NCR MUST be\n\
    \      completed successfully or the entire request fails.\n   o  If a NAT device\
    \ cannot conform to a request to set the maximum\n      number of NAT-bindings\
    \ allowed for a session, the DNCA Diameter\n      peer in the NAT device MUST\
    \ return an NCA with the Result-Code AVP\n      set to MAX_BINDINGS_SET_FAILURE.\
    \  Such a condition can, for\n      example, occur if the operator specified the\
    \ maximum number of\n      NAT-bindings through another mechanism, which, per\
    \ the operator's\n      policy, takes precedence over DNCA.\n   o  If a NAT device\
    \ does not have sufficient resources to process a\n      request, the DNCA Diameter\
    \ peer MUST return an NCA with the\n      Result-Code set to RESOURCE_FAILURE.\n\
    \   o  In the case where Max-NAT-Bindings, NAT-Control-Definition, and\n     \
    \ NAT-Control-Binding-Template are included in the NCR, and the\n      values\
    \ in Max-NAT-Bindings and NAT-Control-Definition contradict\n      those specified\
    \ in the pre-provisioned template on the NAT device\n      that NAT-Control-Binding-Template\
    \ references, Max-NAT-Bindings and\n      NAT-Control-Definition MUST override\
    \ the values specified in the\n      template to which NAT-Control-Binding-Template\
    \ refers.\n   NAT controller (DNCA Diameter peer)   NAT device (DNCA Diameter\
    \ peer)\n               |                                           |\n      \
    \         |                                           |\n               |    \
    \                                       |\n            Trigger               \
    \                         |\n               |                                \
    \           |\n               |                   NCR                     |\n\
    \               |------------------------------------------>|\n              \
    \ |                                           |\n               |            \
    \                               |\n               |                          \
    \                 |\n               |                                        \
    \   |\n               |                                 If able to comply\n  \
    \             |                                 with request, then\n         \
    \      |                                 create session state\n              \
    \ |                                           |\n               |            \
    \                               |\n               |                     NCA  \
    \                 |\n               |<------------------------------------------|\n\
    \               |                                           |\n              \
    \ |                                           |\n      Figure 5: Initial NAT-Control-Request\
    \ and Session Establishment\n   Note: The DNCA Diameter peer within the NAT device\
    \ creates session\n   state only if it is able to comply with the NCR.  On success,\
    \ it will\n   reply with an NCA with the Result-Code set to DIAMETER_SUCCESS.\n"
- title: 4.2.  Session Update
  contents:
  - "4.2.  Session Update\n   A session update is performed if the NAT controller\
    \ desires to change\n   the behavior of the NAT device for an existing session.\
    \  A session\n   update could be used, for example, to change the number of allowed\n\
    \   bindings for a particular session or establish or remove a predefined\n  \
    \ binding.\n   The DNCA Diameter peer within the NAT controller generates an NCR\n\
    \   message to the DNCA Diameter peer within the NAT device with the NC-\n   Request-Type\
    \ AVP set to UPDATE_REQUEST upon receiving a trigger\n   signal.  If the session\
    \ is updated successfully, the DNCA Diameter\n   peer within the NAT device notifies\
    \ the DNCA Diameter peer within the\n   NAT controller about the successful session\
    \ update using a NAT-\n   Control-Answer (NCA) message with the Result-Code set\
    \ to\n   DIAMETER_SUCCESS.  Figure 6 shows the protocol interaction between\n\
    \   the two DNCA Diameter peers.\n   In certain cases, the NAT device may not\
    \ be able to perform the tasks\n   requested within the NCR.  These include the\
    \ following:\n   o  If a DNCA Diameter peer within a NAT device receives an NCR\
    \ update\n      or query request for a non-existent session, it MUST set the\n\
    \      Result-Code in the answer to DIAMETER_UNKNOWN_SESSION_ID.\n   o  If the\
    \ NCR contains a NAT-binding Predefined template not defined\n      on the NAT\
    \ device, an NCA with the Result-Code AVP set to\n      UNKNOWN_BINDING_TEMPLATE_NAME\
    \ MUST be returned.\n   o  If the NAT device cannot establish the requested binding\
    \ because\n      the maximum number of allowed bindings has been reached for the\n\
    \      endpoint classifier, an NCA with the Result-Code AVP set to\n      MAXIMUM_BINDINGS_REACHED_FOR_ENDPOINT\
    \ MUST be returned to the DNCA\n      Diameter peer.\n   o  If the NAT device\
    \ cannot establish some or all of the bindings\n      requested in an NCR, but\
    \ has not yet reached the maximum number of\n      allowed bindings for the endpoint,\
    \ an NCA with the Result-Code set\n      to BINDING_FAILURE MUST be returned.\
    \  As already noted, the DNCA\n      Diameter peer in a NAT device MUST treat\
    \ an NCR as an atomic\n      operation.  Hence, none of the requested bindings\
    \ will be\n      established by the NAT device in case of failure.  Actions\n\
    \      requested within an NCR are either all successful or all fail.\n   o  If\
    \ the NAT device cannot conform to a request to set the maximum\n      number\
    \ of bindings allowed for a session as specified by the Max-\n      NAT-Bindings,\
    \ the DNCA Diameter peer in the NAT device MUST return\n      an NCA with the\
    \ Result-Code AVP set to MAX_BINDINGS_SET_FAILURE.\n   o  If the NAT device does\
    \ not have sufficient resources to process a\n      request, an NCA with the Result-Code\
    \ set to RESOURCE_FAILURE MUST\n      be returned.\n   o  If an NCR changes the\
    \ maximum number of NAT-bindings allowed for\n      the endpoint defined through\
    \ an earlier NCR, the new value MUST\n      override any previously defined limit\
    \ on the maximum number of\n      NAT-bindings set through the DNCA.  Note that,\
    \ prior to\n      overwriting an existing value, the NAT device MUST check whether\n\
    \      the overwrite action conforms to the locally configured policy.\n     \
    \ Deployment dependent, an existing value could have been set by a\n      protocol\
    \ or mechanism different from DNCA and with higher\n      priority.  In which\
    \ case, the NAT device will refuse the change\n      and the DNCA Diameter peer\
    \ in the NAT device MUST return an NCA\n      with the Result-Code AVP set to\
    \ MAX_BINDINGS_SET_FAILURE.  It\n      depends on the implementation of the NAT\
    \ device on how the NAT\n      device copes with a case where the new value is\
    \ lower than the\n      actual number of allocated bindings.  The NAT device SHOULD\n\
    \      refrain from enforcing the new limit immediately (that is,\n      actively\
    \ remove bindings), but rather disallows the establishment\n      of new bindings\
    \ until the current number of bindings is lower than\n      the newly established\
    \ maximum number of allowed bindings.\n   o  If an NCR specifies a new NAT-binding\
    \ Predefined template on the\n      NAT device, the NAT-binding Predefined template\
    \ overrides any\n      previously defined rule for the session.  Existing NAT-bindings\n\
    \      SHOULD NOT be impacted by the change of templates.\n   o  In case Max-NAT-Bindings,\
    \ NAT-Control-Definition, and NAT-Control-\n      Binding-Template are included\
    \ in the NCR, and the values in Max-\n      NAT-Bindings and NAT-Control-Definition\
    \ contradict those specified\n      in the pre-provisioned template on the NAT\
    \ device that NAT-\n      Control-Binding-Template references, Max-NAT-Bindings\
    \ and NAT-\n      Control-Definition MUST override the values specified in the\n\
    \      template to which the NAT-Control-Binding-Template refers.\n   Note: Already\
    \ established bindings for the session SHOULD NOT be\n   affected in case the\
    \ tasks requested within the NCR cannot be\n   completed.\n   NAT controller (DNCA\
    \ Diameter peer)   NAT device (DNCA Diameter peer)\n               |         \
    \                                  |\n               |                       \
    \                    |\n               |                                     \
    \      |\n        Change of session                                  |\n     \
    \      attributes                                      |\n               |   \
    \                                        |\n               |                 \
    \  NCR                     |\n               |------------------------------------------>|\n\
    \               |                                           |\n              \
    \ |                                           |\n               |            \
    \                       If able to comply\n               |                  \
    \                 with the request:\n               |                        \
    \          update session state\n               |                            \
    \               |\n               |                                          \
    \ |\n               |                     NCA                   |\n          \
    \     |<------------------------------------------|\n               |        \
    \                                   |\n             Figure 6: NAT-Control-Request\
    \ for Session Update\n"
- title: 4.3.  Session and Binding Query
  contents:
  - "4.3.  Session and Binding Query\n   A session and NAT-binding query MAY be used\
    \ by the DNCA Diameter peer\n   within the NAT controller either to retrieve information\
    \ on the\n   current bindings for a particular session at the NAT device or to\n\
    \   discover the session identifier for a particular external IP address/\n  \
    \ port pair.\n   A DNCA Diameter peer within the NAT controller starts a session\
    \ query\n   by sending an NCR message with NC-Request-Type AVP set to\n   QUERY_REQUEST.\
    \  Figure 7 shows the protocol interaction between the\n   DNCA Diameter peers.\n\
    \   Two types of query requests exist.  The first type of query request\n   uses\
    \ the Session-Id as input parameter to the query.  It is to allow\n   the DNCA\
    \ Diameter peer within the NAT controller to retrieve the\n   current set of bindings\
    \ for a specific session.  The second type of\n   query request is used to retrieve\
    \ the session identifiers, along with\n   the associated bindings, matching a\
    \ criteria.  This enables the DNCA\n   Diameter peer within the NAT controller\
    \ to find those sessions, which\n   utilize a specific external or internal IP\
    \ address.\n   1.  Request a list of currently allocated NAT-bindings for a\n\
    \       particular session: On receiving an NCR, the NAT device SHOULD\n     \
    \  look up the session information for the Session-Id contained in\n       the\
    \ NCR and report all currently active NAT-bindings for the\n       session using\
    \ an NCA message with the Result-Code set to\n       DIAMETER_SUCCESS.  In this\
    \ case, the NCR MUST NOT contain a NAT-\n       Control-Definition AVP.  Each\
    \ NAT-binding is reported in a NAT-\n       Control-Definition AVP.  In case the\
    \ Session-Id is unknown, the\n       DNCA Diameter peer within the NAT device\
    \ MUST return an NCA\n       message with the Result-Code set to DIAMETER_UNKNOWN_SESSION_ID.\n\
    \   2.  Retrieve Session-Ids and bindings for internal IP address or one\n   \
    \    or multiple external IP address/port pairs: If the DNCA Diameter\n      \
    \ peer within the NAT controller wishes to retrieve the Session-\n       Id(s)\
    \ for an internal IP address or one or multiple external IP\n       address/port\
    \ pairs, it MUST include the internal IP address as\n       part of the Framed-IP-Address\
    \ AVP or external IP address/port\n       pair(s) as part of the NAT-External-Address\
    \ AVP of the NCR.  The\n       external IP address/port pair(s) are known in advance\
    \ by the\n       controller via configuration, AAA interactions, or other means.\n\
    \       The Session-Id is not included in the NCR or the NCA for this\n      \
    \ type of a query.  The DNCA Diameter peer within the NAT device\n       SHOULD\
    \ report the NAT-bindings and associated Session-Ids\n       corresponding to\
    \ the internal IP address or external IP address/\n       port pairs in an NCA\
    \ message using one or multiple instances of\n       the NAT-Control-Definition\
    \ AVP.  The Result-Code is set to\n       DIAMETER_SUCCESS.  In case an external\
    \ IP address/port pair has\n       no associated existing NAT-binding, the NAT-Control-Definition\n\
    \       AVP contained in the reply just contains the NAT-External-Address\n  \
    \     AVP.\n   NAT controller (DNCA Diameter peer)   NAT device (DNCA Diameter\
    \ peer)\n               |                                           |\n      \
    \         |                                           |\n               |    \
    \                                       |\n     DNCA Session Established     \
    \                         |\n               |                                \
    \           |\n               |                   NCR                     |\n\
    \               |------------------------------------------>|\n              \
    \ |                                           |\n               |            \
    \                               |\n               |                          \
    \                 |\n               |                                        \
    \   |\n               |                          Look up corresponding session\n\
    \               |                            and associated NAT-bindings\n   \
    \            |                                           |\n               | \
    \                  NCA                     |\n               |<------------------------------------------|\n\
    \               |                                           |\n              \
    \ |                                           |\n               |            \
    \                               |\n                          Figure 7: Session\
    \ Query\n"
- title: 4.4.  Session Termination
  contents:
  - "4.4.  Session Termination\n   Similar to session initiation, session tear down\
    \ MUST be initiated by\n   the DNCA Diameter peer within the NAT controller. \
    \ The DNCA Diameter\n   peer sends a Session-Termination-Request (STR) message\
    \ to its peer\n   within the NAT device upon receiving a trigger signal.  The\
    \ source of\n   the trigger signal is outside the scope of this document.  As\
    \ part of\n   STR-message processing, the DNCA Diameter peer within the NAT device\n\
    \   MAY send an accounting stop record reporting all bindings.  All the\n   NAT-bindings\
    \ belonging to the session MUST be removed, and the\n   session state MUST be\
    \ cleaned up.  The DNCA Diameter peer within the\n   NAT device MUST notify its\
    \ DNCA Diameter peer in the NAT controller\n   about successful session termination\
    \ using a Session-Termination-\n   Answer (STA) message with Result-Code set to\
    \ DIAMETER_SUCCESS.\n   Figure 8 shows the protocol interaction between the two\
    \ DNCA Diameter\n   peers.\n   If a DNCA Diameter peer within a NAT device receives\
    \ an STR and fails\n   to find a matching session, the DNCA Diameter peer MUST\
    \ return an STA\n   with the Result-Code set to DIAMETER_UNKNOWN_SESSION_ID.\n\
    \   NAT controller (DNCA Diameter peer)   NAT device (DNCA Diameter peer)\n  \
    \             |                                            |\n               |\
    \                                            |\n            Trigger          \
    \                               |\n               |                          \
    \                  |\n               |                   STR                 \
    \     |\n               |------------------------------------------->|\n     \
    \          |                                            |\n               |  \
    \                                          |\n               |               \
    \                             |\n               |                            \
    \                |\n               |                                         \
    \   |\n               |           Send accounting stop             |\n       \
    \        |<-------------------------------------------|\n               |    \
    \   reporting all session bindings       |\n               |                 \
    \                           |\n               |                              \
    \              |\n               |                                  Remove NAT-bindings\n\
    \               |                                       of session\n         \
    \      |                                            |\n               |      \
    \                            Terminate session /\n               |           \
    \                      Remove session state\n               |                \
    \                            |\n               |                             \
    \               |\n               |                                          \
    \  |\n               |                  STA                       |\n        \
    \       |<-------------------------------------------|\n               |     \
    \                                       |\n               |                  \
    \                          |\n                  Figure 8: Terminate NAT Control\
    \ Session\n"
- title: 4.5.  Session Abort
  contents:
  - "4.5.  Session Abort\n   An Abort-Session-Request (ASR) message is sent from the\
    \ DNCA Diameter\n   peer within the NAT device to the DNCA Diameter peer within\
    \ the NAT\n   controller when it is unable to maintain a session due to resource\n\
    \   limitations.  The DNCA Diameter peer within the NAT controller MUST\n   acknowledge\
    \ a successful session abort using an Abort-Session-Answer\n   (ASA) message with\
    \ the Result-Code set to DIAMETER_SUCCESS.  Figure 9\n   shows the protocol interaction\
    \ between the DNCA Diameter peers.  The\n   DNCA Diameter peers will start a session\
    \ termination procedure as\n   described in Section 4.4 following an ASA with\
    \ the Result-Code set to\n   DIAMETER_SUCCESS.\n   If the DNCA Diameter peer within\
    \ a NAT controller receives an ASR but\n   fails to find a matching session, it\
    \ MUST return an ASA with the\n   Result-Code set to DIAMETER_UNKNOWN_SESSION_ID.\
    \  If the DNCA Diameter\n   peer within the NAT controller is unable to comply\
    \ with the ASR for\n   any other reason, an ASA with the Result-Code set to\n\
    \   DIAMETER_UNABLE_TO_COMPLY MUST be returned.\n   NAT controller (DNCA Diameter\
    \ peer)   NAT device (DNCA Diameter peer)\n               |                  \
    \                          |\n               |                               \
    \             |\n               |                                         Trigger\n\
    \               |                                            |\n             \
    \  |                   ASR                      |\n               |<-------------------------------------------|\n\
    \               |                                            |\n             \
    \  |                                            |\n               |          \
    \                                  |\n               |                  ASA  \
    \                     |\n               |------------------------------------------->|\n\
    \               |                                            |\n             \
    \  |                                            |\n               |          \
    \                                  |\n               |           On successful\
    \ ASA                |\n               |<------Session Termination Procedure------->|\n\
    \                    Figure 9: Abort NAT Control Session\n"
- title: 4.6.  Failure Cases of the DNCA Diameter Peers
  contents:
  - "4.6.  Failure Cases of the DNCA Diameter Peers\n   This document does not specify\
    \ the behavior in case the NAT device\n   and NAT controller, or their respective\
    \ DNCA Diameter peers, are out\n   of sync or lose state.  This could happen,\
    \ for example, if one of the\n   entities restarts, in case of a (temporary) loss\
    \ of network\n   connectivity, etc.  Example failure cases include the following:\n\
    \   o  NAT controller and the DNCA Diameter peer within the NAT\n      controller\
    \ lose state (e.g., due to a restart).  In this case:\n      *  the DNCA Diameter\
    \ peer within the NAT device MAY receive an NCR\n         with the NC-Request-Type\
    \ AVP set to INITIAL_REQUEST that\n         matches an existing session of the\
    \ DNCA Diameter peer within\n         the NAT device.  The DNCA Diameter peer\
    \ within the NAT device\n         MUST return a Result-Code that contains a Duplicate-Session-Id\n\
    \         AVP to report the Session-Id of the existing session.  The DNCA\n  \
    \       Diameter peer within the NAT controller MAY send an explicit\n       \
    \  Session-Termination-Request (STR) for the older session, which\n         was\
    \ lost.\n      *  a DNCA Diameter peer MAY receive accounting records for a\n\
    \         session that does not exist.  The DNCA Diameter peer sends an\n    \
    \     accounting answer with the Result-Code set to\n         DIAMETER_UNKNOWN_SESSION_ID\
    \ in response.  On receiving the\n         response, the DNCA Diameter peer SHOULD\
    \ clear the session and\n         remove associated session state.\n   o  The\
    \ NAT device and the DNCA Diameter peer within NAT device lose\n      state. \
    \ In such a case, the DNCA Diameter peer MAY receive an NCR\n      with the NC-Request-Type\
    \ AVP set to UPDATE_REQUEST for a non-\n      existent session.  The DNCA Diameter\
    \ peer MUST return an NCA with\n      the Result-Code set to DIAMETER_UNKNOWN_SESSION_ID.\
    \  When a DNCA\n      application within a NAT controller receives this NCA with\
    \ the\n      Result-Code set to DIAMETER_UNKNOWN_SESSION_ID, it MAY try to re-\n\
    \      establish DNCA session or disconnect corresponding access session.\n  \
    \ o  The DNCA Diameter peer within the NAT controller is unreachable,\n      for\
    \ example, it is detected by Diameter device watchdog messages\n      (as defined\
    \ in Section 5.5 of [RFC6733]) or accounting requests\n      from the DNCA Diameter\
    \ peer fail to get a response, NAT-bindings\n      and NAT device state pertaining\
    \ to that session MUST be cleaned up\n      after a grace period that is configurable\
    \ on the NAT device.  The\n      grace period can be configured as zero or higher,\
    \ depending on\n      operator preference.\n   o  The DNCA Diameter peer within\
    \ the NAT device is unreachable or\n      down and the NCR fails to get a response.\
    \  Handling of this case\n      depends on the actual service offering of the\
    \ service provider.\n      The service provider could, for example, choose to\
    \ stop offering\n      connectivity service.\n   o  A discussion of the mechanisms\
    \ used for a NAT device to clean up\n      state in case the DNCA Diameter peer\
    \ within the NAT device crashes\n      is outside the scope of this document.\
    \  Implementers of NAT\n      devices could choose from a variety of options such\
    \ as coupling\n      the state (e.g., NAT-bindings) to timers that require periodic\n\
    \      refresh, or time out otherwise, operating system watchdogs for\n      applications,\
    \ etc.\n"
- title: 5.  Use of the Diameter Base Protocol
  contents:
  - "5.  Use of the Diameter Base Protocol\n   The Diameter base protocol [RFC6733]\
    \ applies with the clarifications\n   listed in the present specification.\n"
- title: 5.1.  Securing Diameter Messages
  contents:
  - "5.1.  Securing Diameter Messages\n   For secure transport of Diameter messages,\
    \ the recommendations in\n   [RFC6733] apply.\n   DNCA Diameter peers SHOULD verify\
    \ their identity during the\n   Capabilities Exchange Request procedure.\n   A\
    \ DNCA Diameter peer within the NAT device SHOULD verify that a DNCA\n   Diameter\
    \ peer that issues an NCR command is allowed to do so based\n   on:\n   o  The\
    \ identity of the DNCA Diameter peer\n   o  The type of NCR Command\n   o  The\
    \ content of the NCR Command\n   o  Any combination of the above\n"
- title: 5.2.  Accounting Functionality
  contents:
  - "5.2.  Accounting Functionality\n   Accounting functionality (the accounting session\
    \ state machine,\n   related Command Codes and AVPs) is defined in Section 9.\n"
- title: 5.3.  Use of Sessions
  contents:
  - "5.3.  Use of Sessions\n   Each DNCA session MUST have a globally unique Session-Id,\
    \ as defined\n   in [RFC6733], which MUST NOT be changed during the lifetime of\
    \ the\n   DNCA session.  The Diameter Session-Id serves as the global endpoint\n\
    \   identifier.  The DNCA Diameter peers maintain state associated with\n   the\
    \ Session-Id.  This globally unique Session-Id is used for\n   updating, accounting,\
    \ and terminating the session.  A DNCA session\n   MUST NOT have more than one\
    \ outstanding request at any given time.  A\n   DNCA Diameter peer sends an Abort-Session-Request\
    \ as defined in\n   [RFC6733] if it is unable to maintain sessions due to resource\n\
    \   limitation.\n"
- title: 5.4.  Routing Considerations
  contents:
  - "5.4.  Routing Considerations\n   It is assumed that the DNCA Diameter peer within\
    \ a NAT controller\n   knows the DiameterIdentity of the Diameter peer within\
    \ a NAT device\n   for a given endpoint.  Both the Destination-Realm and Destination-\n\
    \   Host AVPs are present in the request from a DNCA Diameter peer within\n  \
    \ a NAT controller to a DNCA Diameter peer within a NAT device.\n"
- title: 5.5.  Advertising Application Support
  contents:
  - "5.5.  Advertising Application Support\n   Diameter nodes conforming to this specification\
    \ MUST advertise\n   support for DNCA by including the value of 12 in the Auth-\n\
    \   Application-Id of the Capabilities-Exchange-Request and Capabilities-\n  \
    \ Exchange-Answer commands [RFC6733].\n"
- title: 6.  DNCA Commands
  contents:
  - "6.  DNCA Commands\n   The following commands are used to establish, maintain,\
    \ and query\n   NAT-bindings.\n"
- title: 6.1.  NAT-Control-Request (NCR) Command
  contents:
  - "6.1.  NAT-Control-Request (NCR) Command\n   The NAT-Control-Request (NCR) command,\
    \ indicated by the command field\n   set to 330 and the 'R' bit set in the Command\
    \ Flags field, is sent\n   from the DNCA Diameter peer within the NAT controller\
    \ to the DNCA\n   Diameter peer within the NAT device in order to install NAT-bindings.\n\
    \   User-Name, Logical-Access-Id, Physical-Access-ID, Framed-IP-Address,\n   Framed-IPv6-Prefix,\
    \ Framed-Interface-Id, EGRESS-VLANID, NAS-Port-ID,\n   Address-Realm, and Calling-Station-ID\
    \ AVPs serve as identifiers for\n   the endpoint.\n   Message format:\n      <\
    \ NC-Request > ::= < Diameter Header: 330, REQ, PXY>\n                       {\
    \ Auth-Application-Id }\n                       { Origin-Host }\n            \
    \           { Origin-Realm }\n                       { Destination-Realm }\n \
    \                      { Destination-Host }\n                       { NC-Request-Type\
    \ }\n                       [ Session-Id ]\n                       [ Origin-State-Id\
    \ ]\n                    *1 [ NAT-Control-Remove ]\n                    *1 [ NAT-Control-Install\
    \ ]\n                       [ NAT-External-Address ]\n                       [\
    \ User-Name ]\n                       [ Logical-Access-Id ]\n                \
    \       [ Physical-Access-ID ]\n                       [ Framed-IP-Address ]\n\
    \                       [ Framed-IPv6-Prefix ]\n                       [ Framed-Interface-Id\
    \ ]\n                       [ EGRESS-VLANID]\n                       [ NAS-Port-ID]\n\
    \                       [ Address-Realm ]\n                       [ Calling-Station-ID\
    \ ]\n                     * [ Proxy-Info ]\n                     * [ Route-Record\
    \ ]\n                     * [ AVP ]\n"
- title: 6.2.  NAT-Control-Answer (NCA) Command
  contents:
  - "6.2.  NAT-Control-Answer (NCA) Command\n   The NAT-Control-Answer (NCA) command,\
    \ indicated by the Command Code\n   field set to 330 and the 'R' bit cleared in\
    \ the Command Flags field,\n   is sent by the DNCA Diameter peer within the NAT\
    \ device in response\n   to the NAT-Control-Request command.\n   Message format:\n\
    \      <NC-Answer> ::= < Diameter Header: 330, PXY >\n                      {\
    \ Origin-Host }\n                      { Origin-Realm }\n                    \
    \  { Result-Code }\n                      [ Session-Id ]\n                   \
    \   [ NC-Request-Type ]\n                    * [ NAT-Control-Definition ]\n  \
    \                    [ Current-NAT-Bindings ]\n                      [ Origin-State-Id\
    \ ]\n                      [ Error-Message ]\n                      [ Error-Reporting-Host\
    \ ]\n                    * [ Failed-AVP ]\n                    * [ Proxy-Info\
    \ ]\n                      [ Duplicate-Session-Id ]\n                    * [ Redirect-Host]\n\
    \                      [ Redirect-Host-Usage ]\n                      [ Redirect-Max-Cache-Time\
    \ ]\n                    * [ Proxy-Info ]\n                    * [ Route-Record\
    \ ]\n                    * [ Failed-AVP ]\n                    * [ AVP ]\n"
- title: 7.  NAT Control Application Session State Machine
  contents:
  - "7.  NAT Control Application Session State Machine\n   This section contains a\
    \ set of finite state machines, representing\n   the life cycle of a DNCA session,\
    \ which MUST be observed by all\n   implementations of the DNCA Diameter application.\
    \  The DNCA Diameter\n   peers are stateful and the state machine maintained is\
    \ similar to the\n   stateful client and server authorization state machine described\
    \ in\n   [RFC6733].  When a session is moved to the Idle state, any resources\n\
    \   that were allocated for the particular session must be released.  Any\n  \
    \ event not listed in the state machines MUST be considered an error\n   condition,\
    \ and an answer, if applicable, MUST be returned to the\n   originator of the\
    \ message.\n   In the state table, the event \"Failure to send NCR\" means that\
    \ the\n   DNCA Diameter peer within the NAT controller is unable to send the\n\
    \   NCR command to the desired destination.  This could be due to the\n   peer\
    \ being down or due to the peer sending back the transient failure\n   or temporary\
    \ protocol error notification DIAMETER_TOO_BUSY or\n   DIAMETER_LOOP_DETECTED\
    \ in the Result-Code AVP of an NCA.\n   In the state table, \"FAILED NCA\" means\
    \ that the DNCA Diameter peer\n   within the NAT device was not able to honor\
    \ the corresponding NCR.\n   This can happen due to any transient or permanent\
    \ error at the NAT\n   device or its associated DNCA Diameter peer within indicated\
    \ by the\n   following error Result-Code values: RESOURCE_FAILURE,\n   UNKNOWN_BINDING_TEMPLATE_NAME,\
    \ MAX_BINDINGS_SET_FAILURE,\n   BINDING_FAILURE, MAXIMUM_BINDINGS_REACHED_FOR_ENDPOINT,\n\
    \   SESSION_EXISTS, INSUFFICIENT_CLASSIFIERS.\n   The following state machine\
    \ is observed by a DNCA Diameter peer\n   within a NAT controller.  The state\
    \ machine description uses the term\n   \"access session\" to describe the connectivity\
    \ service offered to the\n   endpoint or host.  \"Access session\" should not\
    \ be confused with the\n   Diameter session.\n             DNCA Diameter peer\
    \ within a NAT controller\n      State     Event                          Action\
    \     New State\n      -------------------------------------------------------------\n\
    \      Idle      New endpoint detected that     Send        Pending\n        \
    \        requires NAT control           NCR\n                                \
    \               Initial\n                                               Request\n\
    \      Idle      ASR received                   Send ASA    Idle\n           \
    \     for unknown session            with\n                                  \
    \             Result-Code\n                                               = UNKNOWN_\n\
    \                                               SESSION_ID\n      Pending   Successful\
    \ NCA                 Setup       Open\n                received             \
    \          complete\n      Pending   Successful NCA                 Send STR \
    \   Discon\n                received,\n                but peer unable to provide\n\
    \                service\n      Pending   Error processing successful    Send\
    \ STR    Discon\n                NCA\n      Pending   Failed                 \
    \        Clean up    Idle\n                NCA received\n      Open      NAT control\
    \                    Send        Open\n                update required       \
    \         NCR update\n                                               request\n\
    \      Open      Successful                                 Open\n           \
    \     NCA received\n      Open      Failed                         Clean up  \
    \  Idle\n                NCA received\n      Open      Access session end detected\
    \    Send STR    Discon\n      Open      ASR received,                  Send ASA\
    \    Discon\n                access session will be         with\n           \
    \     terminated                     Result-Code\n                           \
    \                    = SUCCESS,\n                                            \
    \   Send STR\n      Open      ASR received,                  Send ASA    Open\n\
    \                access session will not        with\n                be terminated\
    \                  Result-Code\n                                             \
    \  != SUCCESS\n      Discon    ASR Received                   Send ASA    Idle\n\
    \      Discon    STA Received                   Discon.     Idle\n           \
    \                                    endpoint\n   The following state machine\
    \ is observed by a DNCA Diameter peer\n   within a NAT device.\n             DNCA\
    \ Diameter peer within a NAT device\n      State     Event                   \
    \       Action     New State\n      -------------------------------------------------------------\n\
    \      Idle      NCR query request              Send       Idle\n            \
    \    received, and                  successful\n                able to provide\
    \ requested      NCA\n                NAT-binding report\n      Idle      NCR\
    \ received                   Send       Open\n                and able to    \
    \                successful\n                provide requested              NCA\n\
    \                NAT control service\n      Idle      NCR request            \
    \        Send       Idle\n                received, and                  failed\n\
    \                unable to provide requested    NCA\n                NAT control\
    \ service\n      Open      NCR request                    Send       Open\n  \
    \              received, and                  successful\n                able\
    \ to provide requested      NCA\n                NAT control service\n      Open\
    \      NCR request                    Send       Idle\n                received,\
    \ and                  failed\n                unable to provide requested   \
    \ NCA,\n                NAT control service            Clean up\n      Open  \
    \    Unable to continue             Send ASR   Discon\n                providing\
    \ requested\n                NAT control service\n      Open      Unplanned loss\
    \ of session/     Clean up   Idle\n                connection to DNCA Diameter\n\
    \                peer in NAT controller\n                detected (e.g., due to\
    \ Diameter\n                watchdog notification)\n      Discon    Failure to\
    \ send ASR            Wait,      Discon\n                                    \
    \           resend ASR\n      Discon    ASR successfully sent and      Clean up\
    \   Idle\n                ASA received with Result-Code\n      Not       ASA received\
    \                   None       No change\n      Discon\n      Any       STR received\
    \                   Send STA,  Idle\n                                        \
    \       Clean up\n"
- title: 8.  DNCA AVPs
  contents:
  - '8.  DNCA AVPs

    '
- title: 8.1.  Reused Base Protocol AVPs
  contents:
  - "8.1.  Reused Base Protocol AVPs\n   The following table describes the AVPs reused\
    \ from the Diameter base\n   protocol [RFC6733]; their AVP Code values, types,\
    \ and possible flag\n   values and whether the AVP MAY be encrypted.  [RFC6733]\
    \ specifies the\n   AVP Flag rules for AVPs in Section 4.5.  The Diameter AVP\
    \ rules are\n   defined in [RFC6733], Section 4.\n                           \
    \                        +---------+\n                                       \
    \            |  AVP    |\n                                                   |\
    \  Flag   |\n                                                   |  rules  |\n\
    \   +-----------------------------------------------|-----+---+---------+\n  \
    \ |                           AVP                 |     |   |         |\n   |\
    \ Attribute Name            Code     Data Type  |MUST |MAY|   Encr  |\n   +-----------------------------------------------+-----+---+---------+\n\
    \   |Acct-Interim-Interval      85       Unsigned32 | M   | P |    Y    |\n  \
    \ |Auth-Application-Id        258      Unsigned32 | M   | P |    N    |\n   |Destination-Host\
    \           293      DiamIdent  | M   | P |    N    |\n   |Destination-Realm \
    \         283      DiamIdent  | M   | P |    N    |\n   |Error-Message       \
    \       281      UTF8String | M   | P |    N    |\n   |Error-Reporting-Host  \
    \     294      DiamIdent  | M   | P |    N    |\n   |Failed-AVP              \
    \   279      Grouped    | M   | P |    N    |\n   |Origin-Host               \
    \ 264      DiamIdent  | M   | P |    N    |\n   |Origin-Realm               296\
    \      DiamIdent  | M   | P |    N    |\n   |Origin-State-Id            278  \
    \    Unsigned32 | M   | P |    N    |\n   |Proxy-Info                 284    \
    \  Grouped    | M   | P |    N    |\n   |Result-Code                268      Unsigned32\
    \ | M   | P |    N    |\n   |Route-Record               282      DiamIdent  |\
    \ M   |   |    N    |\n   |Session-Id                 263      UTF8String | M\
    \   | P |    Y    |\n   |User-Name                  1        UTF8String | M  \
    \ | P |    Y    |\n   +-----------------------------------------------+-----+---+---------+\n\
    \   Table 1: DIAMETER AVPs from the Diameter Base Protocol\n   The Auth-Application-Id\
    \ AVP (AVP Code 258) is assigned by IANA to\n   Diameter applications.  The value\
    \ of the Auth-Application-Id for the\n   Diameter NAT Control Application is 12.\
    \  Please refer to [RFC6733]\n   for the definition of the Diameter AVP flag rules\
    \ and the associated\n   abbreviations used in the table.\n"
- title: 8.2.  Additional Result-Code AVP Values
  contents:
  - "8.2.  Additional Result-Code AVP Values\n   This section defines new values for\
    \ the Result-Code AVP that SHALL be\n   supported by all Diameter implementations\
    \ that conform to the present\n   document.\n"
- title: 8.2.1.  Success
  contents:
  - "8.2.1.  Success\n   No new Result-Code AVP value is defined within this category.\n"
- title: 8.2.2.  Transient Failures
  contents:
  - "8.2.2.  Transient Failures\n   Result-Code AVP values that fall within the transient\
    \ failures\n   category are those used to inform a peer that the request could\
    \ not\n   be satisfied at the time that it was received.  The request may be\n\
    \   able to be satisfied in the future.\n   The following new values of the Result-Code\
    \ AVP are defined:\n      RESOURCE_FAILURE (4014)\n         The DNCA Diameter\
    \ peer within the NAT device indicates that the\n         binding could not be\
    \ installed or a new session could not be\n         created due to resource shortage.\n"
- title: 8.2.3.  Permanent Failures
  contents:
  - "8.2.3.  Permanent Failures\n   The Result-Code AVP values, which fall within\
    \ the permanent failures\n   category are used to inform the peer that the request\
    \ failed and\n   should not be attempted again.  The request may be able to be\n\
    \   satisfied in the future.\n   The following new values of the Result-Code AVP\
    \ are defined:\n      UNKNOWN_BINDING_TEMPLATE_NAME (5042)\n         The DNCA\
    \ Diameter peer within the NAT device indicates that the\n         binding could\
    \ not be installed or a new session could not be\n         created because the\
    \ specified NAT-Control-Binding-Template AVP,\n         which refers to a predefined\
    \ policy template in the NAT device,\n         is unknown.\n      BINDING_FAILURE\
    \ (5043)\n         The DNCA Diameter peer within the NAT device indicates that\
    \ the\n         requested binding(s) could not be installed.  For example,\n \
    \        Requested ports are already in use.\n      MAX_BINDINGS_SET_FAILURE (5044)\n\
    \         The DNCA Diameter peer within the NAT device indicates that it\n   \
    \      failed to conform to a request to configure the maximum number\n      \
    \   of bindings for a session.  For example, an operator defined\n         the\
    \ maximum number of bindings on the NAT device using a method\n         or protocol\
    \ that takes precedence over DNCA.\n      MAXIMUM_BINDINGS_REACHED_FOR_ENDPOINT\
    \ (5045)\n         The DNCA Diameter peer within the NAT device denies the request\n\
    \         because the maximum number of allowed bindings has been reached\n  \
    \       for the specified endpoint classifier.\n      SESSION_EXISTS (5046)\n\
    \         The DNCA Diameter peer within the NAT device denies a request\n    \
    \     to initialize a new session, if it already has a DNCA session\n        \
    \ that uses the same set of classifiers as indicated by the DNCA\n         Diameter\
    \ peer within the NAT controller in the new session\n         initialization request.\n\
    \      INSUFFICIENT_CLASSIFIERS (5047)\n         The DNCA Diameter peer within\
    \ the NAT device requests to\n         initialize a new session, if the classifiers\
    \ in the request\n         match more than one of the existing sessions on the\
    \ DNCA\n         Diameter peer within the NAT device.\n"
- title: 8.3.  Reused NASREQ Diameter Application AVPs
  contents:
  - "8.3.  Reused NASREQ Diameter Application AVPs\n   The following table describes\
    \ the AVPs reused from the Diameter\n   Network Access Server Application [RFC4005];\
    \ their AVP Code values,\n   types, and possible flag values; and whether the\
    \ AVP MAY be\n   encrypted.  The [RFC6733] specifies the AVP Flag rules for AVPs\
    \ in\n   Section 4.5.  The Diameter AVP rules are defined in the [RFC6733],\n\
    \   Section 4.\n                                          +---------------------+\n\
    \                                          |    AVP Flag Rules   |\n   +------------------+------+------------|----+-----+----+-----|----+\n\
    \   |                  | AVP  |            |    |     |SHLD| MUST|    |\n   |\
    \ Attribute Name   | Code |  Value Type|MUST| MAY | NOT|  NOT|Encr|\n   |------------------|------|------------|----+-----+----+-----|----|\n\
    \   | NAS-Port         |   5  | Unsigned32 | M  |  P  |    |  V  | Y  |\n   |\
    \ NAS-Port-Id      |  87  | UTF8String | M  |  P  |    |  V  | Y  |\n   | Calling-Station-\
    \ |  31  | UTF8String | M  |  P  |    |  V  | Y  |\n   |   Id             |  \
    \    |            |    |     |    |     |    |\n   | Framed-IP-Address|   8  |\
    \ OctetString| M  |  P  |    |  V  | Y  |\n   | Framed-Interface-|  96  | Unsigned64\
    \ | M  |  P  |    |  V  | Y  |\n   |   Id             |      |            |  \
    \  |     |    |     |    |\n   | Framed-IPv6-     |  97  | OctetString| M  | \
    \ P  |    |  V  | Y  |\n   |  Prefix          |      |            |    |     |\
    \    |     |    |\n   +------------------+------+------------|----+-----+----+-----|----+\n\
    \   Table 2: Reused NASREQ Diameter application AVPs.  Please refer to\n   [RFC6733]\
    \ for the definition of the Diameter AVP Flag rules and the\n   associated abbreviations\
    \ used in the table.\n"
- title: 8.4.  Reused AVPs from RFC 4675
  contents:
  - "8.4.  Reused AVPs from RFC 4675\n   The following table describes the AVPs reused\
    \ from \"RADIUS Attributes\n   for Virtual LAN and Priority Support\" [RFC4675];\
    \ their AVP Code\n   values, types, and possible flag values; and whether the\
    \ AVP MAY be\n   encrypted.  [RFC6733] specifies the AVP Flag rules for AVPs in\n\
    \   Section 4.5.  The Diameter AVP rules are defined in [RFC6733],\n   Section\
    \ 4.\n                                          +---------------------+\n    \
    \                                      |    AVP Flag Rules   |\n   +------------------+------+------------|----+-----+----+-----|----+\n\
    \   |                  | AVP  |            |    |     |SHLD| MUST|    |\n   |\
    \ Attribute Name   | Code |  Value Type|MUST| MAY | NOT|  NOT|Encr|\n   |------------------|------|------------|----+-----+----+-----|----|\n\
    \   | Egress-VLANID    |  56  | OctetString| M  |  P  |    |  V  | Y  |\n   +------------------+------+------------|----+-----+----+-----|----+\n\
    \   Table 3: Reused attributes from [RFC4675].  Please refer to [RFC6733]\n  \
    \ for the definition of the Diameter AVP Flag rules and the associated\n   abbreviations\
    \ used in the table.\n"
- title: 8.5.  Reused AVPs from Diameter QoS Application
  contents:
  - "8.5.  Reused AVPs from Diameter QoS Application\n   The following table describes\
    \ the AVPs reused from the \"Traffic\n   Classification and Quality of Service\
    \ (QoS) Attributes for Diameter\"\n   [RFC5777]; their AVP Code values, types,\
    \ and possible flag values;\n   and whether the AVP MAY be encrypted.  [RFC6733]\
    \ specifies the AVP\n   Flag rules for AVPs in Section 4.5.  The Diameter AVP\
    \ rules are\n   defined in [RFC6733], Section 4.\n                           \
    \                        +---------+\n                                       \
    \            |  AVP    |\n                                                   |\
    \  Flag   |\n                                                   |  Rules  |\n\
    \   +-----------------------------------------------|-----+---+---------+\n  \
    \ |                           AVP                 |     |   |         |\n   |\
    \ Attribute Name            Code     Data Type  |MUST |MAY|   Encr  |\n   +-----------------------------------------------+-----+---+---------+\n\
    \   |Port                       530     Integer32   |  M  | P |    Y    |\n  \
    \ |Protocol                   513     Enumerated  |  M  | P |    Y    |\n   |Direction\
    \                  514     Enumerated  |  M  | P |    Y    |\n   +-----------------------------------------------+-----+---+---------+\n\
    \   Table 4: Reused QoS-attributes.  Please refer to [RFC6733] for the\n   definition\
    \ of the Diameter AVP Flag rules and the associated\n   abbreviations used in\
    \ the table.\n"
- title: 8.6.  Reused AVPs from ETSI ES 283 034, e4 Diameter Application
  contents:
  - "8.6.  Reused AVPs from ETSI ES 283 034, e4 Diameter Application\n   The following\
    \ table describes the AVPs reused from the Diameter e4\n   Application [ETSIES283034];\
    \ their AVP Code values, types, and\n   possible flag values; and whether the\
    \ AVP MAY be encrypted.\n   [RFC6733] specifies the AVP Flag rules for AVPs in\
    \ Section 4.5.  The\n   Diameter AVP rules are defined in [RFC6733], Section 4.\
    \  The\n   Vendor-ID field in these AVP header will be set to ETSI (13019).\n\
    \                                                   +---------+\n            \
    \                                       |  AVP    |\n                        \
    \                           |  Flag   |\n                                    \
    \               |  Rules  |\n   +-----------------------------------------------|-----+---+---------+\n\
    \   |                           AVP                 |     |   |         |\n  \
    \ | Attribute Name            Code     Data Type  |MUST |MAY|   Encr  |\n   +-----------------------------------------------+-----+---+---------+\n\
    \   |Address-Realm              301     OctetString | M,V |   |    Y    |\n  \
    \ |Logical-Access-Id          302     OctetString |   V | M |    Y    |\n   |Physical-Access-ID\
    \         313     UTF8String  |   V | M |    Y    |\n   +-----------------------------------------------+-----+---+---------+\n\
    \   Table 5: Reused AVPs from the Diameter e4 application.  Please refer\n   to\
    \ [RFC6733] for the definition of the Diameter AVP Flag rules and\n   the associated\
    \ abbreviations used in the table.\n"
- title: 8.7.  DNCA-Defined AVPs
  contents:
  - "8.7.  DNCA-Defined AVPs\n   The following table describes the new Diameter AVPs\
    \ defined in this\n   document; their AVP Code values, types, and possible flag\
    \ values; and\n   whether the AVP MAY be encrypted.  [RFC6733] specifies the AVP\
    \ Flag\n   rules for AVPs in Section 4.5.  The Diameter AVP rules are defined\
    \ in\n   [RFC6733], Section 4.  The AVPs defined here MUST NOT have the 'V'\n\
    \   bit in the AVP Flags field set.\n                                        \
    \              +---------+\n                                                 \
    \     |  AVP    |\n                                                      |  Flag\
    \   |\n                                                      |  Rules  |\n   +--------------------------------------------------|-----+---+------+\n\
    \   |                       AVP                        |     |   |      |\n  \
    \ | Attribute Name        Code    Sect.   Data Type  |MUST |MAY| Encr |\n   +--------------------------------------------------+-----+---+------+\n\
    \   |NC-Request-Type        595     8.7.1   Enumerated | M   | P |  Y   |\n  \
    \ |NAT-Control-Install    596     8.7.2   Grouped    | M   | P |  Y   |\n   |NAT-Control-Remove\
    \     597     8.7.3   Grouped    | M   | P |  Y   |\n   |NAT-Control-Definition\
    \ 598     8.7.4   Grouped    | M   | P |  Y   |\n   |NAT-Internal-Address   599\
    \     8.7.5   Grouped    | M   | P |  Y   |\n   |NAT-External-Address   600  \
    \   8.7.6   Grouped    | M   | P |  Y   |\n   |Max-NAT-Bindings       601    \
    \ 8.7.7   Unsigned32 | M   | P |  Y   |\n   |NAT-Control-           602     8.7.8\
    \   OctetString| M   | P |  Y   |\n   | Binding-Template                     \
    \            |     |   |      |\n   |Duplicate-             603     8.7.9   UTF8String\
    \ | M   | P |  Y   |\n   | Session-Id                                       |\
    \     |   |      |\n   |NAT-External-Port-     604     8.7.10  Enumerated | M\
    \   | P |  Y   |\n   | Style                                            |    \
    \ |   |      |\n   |NAT-Control-Record     605     9.2.1   Grouped    | M   |\
    \ P |  Y   |\n   |NAT-Control-           606     9.2.2   Enumerated | M   | P\
    \ |  Y   |\n   | Binding-Status                                   |     |   |\
    \      |\n   |Current-NAT-Bindings   607     9.2.3   Unsigned32 | M   | P |  Y\
    \   |\n   +--------------------------------------------------+-----+---+------+\n\
    \   Table 6: New Diameter AVPs.  Please refer to [RFC6733] for the\n   definition\
    \ of the Diameter AVP Flag rules and the associated\n   abbreviations used in\
    \ the table.\n"
- title: 8.7.1.  NC-Request-Type AVP
  contents:
  - "8.7.1.  NC-Request-Type AVP\n   The NC-Request-Type AVP (AVP Code 595) is of\
    \ type Enumerated and\n   contains the reason for sending the NAT-Control-Request\
    \ command.  It\n   shall be present in all NAT-Control-Request messages.\n   The\
    \ following values are defined:\n      INITIAL_REQUEST (1)\n         An Initial\
    \ Request is to initiate a Diameter NAT control\n         session between the\
    \ DNCA Diameter peers.\n      UPDATE_REQUEST (2)\n         An Update Request is\
    \ used to update bindings previously\n         installed on a given access session,\
    \ to add new binding on a\n         given access session, or to remove one or\
    \ several binding(s)\n         activated on a given access session.\n      QUERY_REQUEST\
    \ (3)\n         Query Request is used to query a NAT device about the currently\n\
    \         installed bindings for an endpoint classifier.\n"
- title: 8.7.2.  NAT-Control-Install AVP
  contents:
  - "8.7.2.  NAT-Control-Install AVP\n   The NAT-Control-Install AVP (AVP code 596)\
    \ is of type Grouped, and it\n   is used to activate or install NAT-bindings.\
    \  It also contains Max-\n   NAT-Bindings that defines the maximum number of NAT-bindings\
    \ allowed\n   for an endpoint and the NAT-Control-Binding-Template that references\n\
    \   a predefined template on the NAT device that may contain static\n   binding,\
    \ a maximum number of bindings allowed, an IP address pool\n   from which external\
    \ binding addresses should be allocated, etc.  If\n   the NAT-External-Port-Style\
    \ AVP is present, then the NAT device MUST\n   select the external ports for the\
    \ NAT-bindings, per the style\n   specified.  The NAT-External-Port-Style is applicable\
    \ for NAT-\n   bindings defined by the NAT-Control-Definition AVPs whose NAT-\n\
    \   External-Address or Port AVPs within the NAT-External-Address are\n   unspecified.\n\
    \   AVP format:\n     NAT-Control-Install ::= < AVP Header: 596 >\n          \
    \                    * [ NAT-Control-Definition ]\n                          \
    \      [ NAT-Control-Binding-Template ]\n                                [ Max-NAT-Bindings\
    \ ]\n                                [ NAT-External-Port-Style ]\n           \
    \                   * [ AVP ]\n"
- title: 8.7.3.  NAT-Control-Remove AVP
  contents:
  - "8.7.3.  NAT-Control-Remove AVP\n   The NAT-Control-Remove AVP (AVP code 597)\
    \ is of type Grouped, and it\n   is used to deactivate or remove NAT-bindings.\
    \  At least one of the\n   two AVPs (NAT-Control-Definition AVP or NAT-Control-Binding-Template\n\
    \   AVP) SHOULD be present in the NAT-Control-Remove AVP.\n   AVP format:\n  \
    \   NAT-Control-Remove ::= < AVP Header: 597 >\n                             *\
    \ [ NAT-Control-Definition ]\n                               [ NAT-Control-Binding-Template\
    \ ]\n                             * [ AVP ]\n"
- title: 8.7.4.  NAT-Control-Definition AVP
  contents:
  - "8.7.4.  NAT-Control-Definition AVP\n   The NAT-Control-Definition AVP (AVP code\
    \ 598) is of type Grouped, and\n   it describes a binding.\n   The NAT-Control-Definition\
    \ AVP uniquely identifies the binding\n   between the DNCA Diameter peers.\n \
    \  If both the NAT-Internal-Address and NAT-External-Address AVP(s) are\n   supplied,\
    \ it is a predefined binding.\n   If the NAT-External-Address AVP is not specified,\
    \ then the NAT device\n   MUST select the external port as per the NAT-External-Port-Style\
    \ AVP,\n   if present in the NAT-Control-Definition AVP.\n   The Protocol AVP\
    \ describes the transport protocol for the binding.\n   The NAT-Control-Definition\
    \ AVP can contain either zero or one\n   Protocol AVP.  If the Protocol AVP is\
    \ omitted and if both internal\n   and external IP addresses are specified, then\
    \ the binding reserves\n   the IP addresses for all transport protocols.\n   The\
    \ Direction AVP is of type Enumerated.  It specifies the direction\n   for the\
    \ binding.  The values of the enumeration applicable in this\n   context are:\
    \ \"IN\",\"OUT\".  If Direction AVP is OUT or absent, the NAT-\n   Internal-Address\
    \ refers to the IP address of the endpoint that needs\n   to be translated.  If\
    \ Direction AVP is \"IN\", NAT-Internal-Address is\n   the destination IP address\
    \ that has to be translated.\n   AVP format:\n     NAT-Control-Definition ::=\
    \ < AVP Header: 598 >\n                                 { NAT-Internal-Address\
    \ }\n                                 [ Protocol ]\n                         \
    \        [ Direction ]\n                                 [ NAT-External-Address\
    \ ]\n                                 [ Session-Id ]\n                       \
    \        * [ AVP ]\n"
- title: 8.7.5.  NAT-Internal-Address AVP
  contents:
  - "8.7.5.  NAT-Internal-Address AVP\n   The NAT-Internal-Address AVP (AVP code 599)\
    \ is of type Grouped.  It\n   describes the internal IP address and port for a\
    \ binding.  Framed-\n   IPV6-Prefix and Framed-IP-Address AVPs are mutually exclusive.\
    \  The\n   endpoint identifier Framed-IP-Address, Framed-IPv6-Prefix, and the\n\
    \   internal address in this NAT-Internal-Address AVP to install NAT-\n   bindings\
    \ for the session MUST match.\n   AVP format:\n     NAT-Internal-Address ::= <\
    \ AVP Header: 599 >\n                               [ Framed-IP-Address ]\n  \
    \                             [ Framed-IPv6-Prefix ]\n                       \
    \        [ Port]\n                             * [ AVP ]\n"
- title: 8.7.6.  NAT-External-Address AVP
  contents:
  - "8.7.6.  NAT-External-Address AVP\n   The NAT-External-Address AVP (AVP code 600)\
    \ is of type Grouped, and\n   it describes the external IP address and port for\
    \ a binding.  The\n   external IP address specified in this attribute can be reused\
    \ for\n   multiple endpoints by specifying the same address in the respective\n\
    \   NAT-External-Address AVPs.  If the external IP address is not\n   specified\
    \ and the NAT-External-Port-Style AVP is specified in the\n   NAT-Control-Definition\
    \ AVP, then the NAT device MUST select an\n   external port as per the NAT-External-Port-Style\
    \ AVP.\n   AVP format:\n     NAT-External-Address ::= < AVP Header: 600 >\n  \
    \                             [ Framed-IP-Address ]\n                        \
    \       [ Port ]\n                             * [ AVP ]\n"
- title: 8.7.7.  Max-NAT-Bindings
  contents:
  - "8.7.7.  Max-NAT-Bindings\n   The Max-NAT-Bindings AVP (AVP code 601) is of type\
    \ Unsigned32.  It\n   indicates the maximum number of NAT-bindings allowed for\
    \ a particular\n   endpoint.\n"
- title: 8.7.8.  NAT-Control-Binding-Template AVP
  contents:
  - "8.7.8.  NAT-Control-Binding-Template AVP\n   The NAT-Control-Binding-Template\
    \ AVP (AVP code 602) is of type\n   OctetString.  It defines a name for a policy\
    \ template that is\n   predefined at the NAT device.  Details on the contents\
    \ and structure\n   of the template and configuration are outside the scope of\
    \ this\n   document.  The policy to which this AVP refers may contain NAT-\n \
    \  bindings, an IP address pool for allocating the external IP address\n   of\
    \ a NAT-binding, and a maximum number of allowed NAT-bindings.  Such\n   a policy\
    \ template can be reused by specifying the same NAT-Control-\n   Binding-Template\
    \ AVP in the corresponding NAT-Control-Install AVPs of\n   multiple endpoints.\n"
- title: 8.7.9.  Duplicate-Session-Id AVP
  contents:
  - "8.7.9.  Duplicate-Session-Id AVP\n   The Duplicate-Session-Id AVP (AVP Code 603)\
    \ is of type UTF8String.\n   It is used to report errors and contains the Session-Id\
    \ of an\n   existing session.\n"
- title: 8.7.10.  NAT-External-Port-Style AVP
  contents:
  - "8.7.10.  NAT-External-Port-Style AVP\n   The NAT-External-Port-Style AVP (AVP\
    \ Code 604) is of type Enumerated\n   and contains the style to be followed while\
    \ selecting the external\n   port for a NAT-binding relative to the internal port.\n\
    \   The following values are defined:\n      FOLLOW_INTERNAL_PORT_STYLE (1)\n\
    \         External port numbers selected MUST follow the same sequence\n     \
    \    and oddity as the internal ports of the NAT-bindings.  The port\n       \
    \  oddity is required to support protocols like RTP and RTCP as\n         defined\
    \ in [RFC3550].  If for example the internal port in a\n         requested NAT-binding\
    \ is odd numbered, then the external port\n         allocated MUST also be odd\
    \ numbered, and vice versa for an even\n         numbered port.  In addition,\
    \ the sequence of port numbering is\n         maintained: if internal ports are\
    \ consecutive, then the NAT\n         device MUST choose consecutive external\
    \ ports for the NAT-\n         bindings.\n"
- title: 9.  Accounting Commands
  contents:
  - "9.  Accounting Commands\n   The DNCA reuses session-based accounting as defined\
    \ in the Diameter\n   base protocol [RFC6733] to report the bindings per endpoint.\
    \  This\n   reporting is achieved by sending Diameter Accounting-Request (ACR)\n\
    \   commands [Start, Interim, and Stop] from the DNCA Diameter peer\n   within\
    \ the NAT device to its associated DNCA Diameter peer within the\n   NAT controller.\n\
    \   The DNCA Diameter peer within the NAT device sends an ACR Start on\n   receiving\
    \ an NCR with NC-Request-Type AVP set to INITIAL_REQUEST for\n   a session or\
    \ on creation of the first binding for a session requested\n   in an earlier NCR.\
    \  DNCA may send ACR Interim updates, if required,\n   either due to a change\
    \ in bindings resulting from an NCR with NC-\n   Request-Type AVP set to UPDATE_REQUEST,\
    \ periodically as specified in\n   Acct-Interim-Interval by the DNCA Diameter\
    \ peer within the NAT\n   controller, or when it creates or tears down bindings.\
    \  An ACR Stop\n   is sent by the DNCA Diameter peer within the NAT device on\
    \ receiving\n   an STR message.\n   The function of correlating the multiple bindings\
    \ used by an endpoint\n   at any given time is relegated to the post processor.\n\
    \   The DNCA Diameter peer within the NAT device may trigger an Interim\n   accounting\
    \ record when the maximum number of bindings, if received in\n   an NCR, is reached.\n"
- title: 9.1.  NAT Control Accounting Messages
  contents:
  - "9.1.  NAT Control Accounting Messages\n   The ACR and ACA messages are reused\
    \ as defined in the Diameter base\n   protocol [RFC6733] for exchanging endpoint\
    \ NAT-binding details\n   between the DNCA Diameter peers.  The DNCA Application\
    \ ID is used in\n   the accounting commands.  The ACR contains one or more optional\
    \ NAT-\n   Control-Record AVPs to report the bindings.  The NAT device indicates\n\
    \   the number of allocated NAT-bindings to the NAT controller using the\n   Current-NAT-Bindings\
    \ AVP.  This number needs to match the number of\n   bindings identified as active\
    \ within the NAT-Control-Record AVP.\n"
- title: 9.2.  NAT Control Accounting AVPs
  contents:
  - "9.2.  NAT Control Accounting AVPs\n   In addition to AVPs for ACR specified in\
    \ [RFC6733], the DNCA Diameter\n   peer within the NAT device must add the NAT-Control-Record\
    \ AVP.\n"
- title: 9.2.1.  NAT-Control-Record
  contents:
  - "9.2.1.  NAT-Control-Record\n   The NAT-Control-Record AVP (AVP code 605) is of\
    \ type Grouped.  It\n   describes a binding and its status.  If NAT-Control-Binding-Status\
    \ is\n   set to Created, Event-Timestamp indicates the binding creation time.\n\
    \   If NAT-Control-Binding-Status is set to Removed, Event-Timestamp\n   indicates\
    \ the binding removal time.  If NAT-Control-Binding-Status is\n   active, Event-Timestamp\
    \ need not be present; if a value is present,\n   it indicates that binding is\
    \ active at the given time.\n     NAT-Control-Record ::= < AVP Header: 605 >\n\
    \                            { NAT-Control-Definition }\n                    \
    \        { NAT-Control-Binding-Status }\n                            [ Event-Timestamp\
    \ ]\n"
- title: 9.2.2.  NAT-Control-Binding-Status
  contents:
  - "9.2.2.  NAT-Control-Binding-Status\n   The NAT-Control-Binding-Status AVP (AVP\
    \ code 606) is of type\n   enumerated.  It indicates the status of the binding:\
    \ created,\n   removed, or active.\n   The following values are defined:\n   \
    \   Created (1)\n         NAT-binding is created.\n      Active (2)\n        \
    \ NAT-binding is active.\n      Removed (3)\n         NAT-binding was removed.\n"
- title: 9.2.3.  Current-NAT-Bindings
  contents:
  - "9.2.3.  Current-NAT-Bindings\n   The Current-NAT-Bindings AVP (AVP code 607)\
    \ is of type Unsigned32.\n   It indicates the number of NAT-bindings active on\
    \ the NAT device.\n"
- title: 10.  AVP Occurrence Tables
  contents:
  - "10.  AVP Occurrence Tables\n   The following sections present the AVPs defined\
    \ in this document and\n   specify the Diameter messages in which they can be\
    \ present.  Note:\n   AVPs that can only be present within a Grouped AVP are not\n\
    \   represented in this table.\n   The table uses the following symbols:\n   \
    \   0         The AVP MUST NOT be present in the message.\n      0+        Zero\
    \ or more instances of the AVP can be present in the\n                message.\n\
    \      0-1       Zero or one instance of the AVP can be present in the\n     \
    \           message.  It is considered an error if there is more\n           \
    \     than one instance of the AVP.\n      1         One instance of the AVP MUST\
    \ be present in the message.\n      1+        At least one instance of the AVP\
    \ MUST be present in the\n                message.\n"
- title: 10.1.  DNCA AVP Table for NAT Control Initial and Update Requests
  contents:
  - "10.1.  DNCA AVP Table for NAT Control Initial and Update Requests\n   The following\
    \ table lists DNCA-specific AVPs that have to be present\n   in NCRs and NCAs\
    \ with the NC-Request-Type set to INITIAL_REQUEST or\n   UPDATE_REQUEST.\n   \
    \                                    +-------------------+\n                 \
    \                      |  Command Code     |\n   +-----------------------------------+-------------------+\n\
    \   | Attribute Name                        NCR    NCA      |\n   +-------------------------------------------------------+\n\
    \   |NC-Request-Type                         1      1       |\n   |NAT-Control-Install\
    \                    0-1     0       |\n   |NAT-Control-Remove               \
    \      0-1     0       |\n   |NAT-Control-Definition                  0      0\
    \       |\n   |Current-NAT-Bindings                    0      0       |\n   |Duplicate-Session-Id\
    \                    0     0-1      |\n   +-------------------------------------------------------+\n\
    \   Note that any combination of NAT-Control-Install and NAT-Control-\n   Remove\
    \ AVPs could be present in an update or initial requests.\n   Consider the following\
    \ examples:\n      Neither the NAT-Control-Install AVP nor the NAT-Control-Remove\
    \ AVP\n      is present: This could, for example, be the case if the NAT\n   \
    \   controller would only want to receive accounting information but\n      not\
    \ control NAT-bindings.\n      Only NAT-Control-Install AVP is present: This could,\
    \ for example,\n      be the case if a new NAT-binding is installed for an existing\n\
    \      session.\n      Only NAT-Control-Remove AVP is present: This could, for\
    \ example,\n      be the case if a new NAT-binding is removed from an existing\n\
    \      session.\n      Both, NAT-Control-Install AVP and NAT-Control-Remove AVP\
    \ are\n      present: This could, for example. be the case if a formerly\n   \
    \   created NAT-binding is removed and a new NAT-binding is\n      established\
    \ within the same request.\n"
- title: 10.2.  DNCA AVP Table for Session Query Requests
  contents:
  - "10.2.  DNCA AVP Table for Session Query Requests\n   The following table lists\
    \ DNCA-specific AVPs that have to be present\n   in NCRs and NCAs with the NC-Request-Type\
    \ set to QUERY_REQUEST.\n                                       +-------------------+\n\
    \                                       |  Command Code     |\n   +-----------------------------------+-------------------+\n\
    \   | Attribute Name                        NCR    NCA      |\n   +-------------------------------------------------------+\n\
    \   |NC-Request-Type                         1      1       |\n   |NAT-Control-Install\
    \                     0      0       |\n   |NAT-Control-Remove               \
    \       0      0       |\n   |NAT-Control-Definition                  0      0+\
    \      |\n   |NAT-External-Address                    0+     0       |\n   |Current-NAT-Bindings\
    \                    0      1       |\n   |Duplicate-Session-Id              \
    \      0      0       |\n   +-------------------------------------------------------+\n"
- title: 10.3.  DNCA AVP Table for Accounting Messages
  contents:
  - "10.3.  DNCA AVP Table for Accounting Messages\n   The following table lists DNCA-specific\
    \ AVPs, which may or may not be\n   present in ACR and ACA messages.\n       \
    \                                +-------------------+\n                     \
    \                  |  Command Code     |\n   +-----------------------------------+-------------------+\n\
    \   | Attribute Name                        ACR    ACA      |\n   +-------------------------------------------------------+\n\
    \   |NAT-Control-Record                      0+     0       |\n   |Current-NAT-Bindings\
    \                    1      0       |\n   +-------------------------------------------------------+\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   This section contains either the namespaces that\
    \ have been created in\n   this specification or the values assigned to existing\
    \ namespaces\n   managed by IANA.\n   In the subsections below, when we speak\
    \ about review by a Designated\n   Expert [RFC5226], please note that the Designated\
    \ Expert will be\n   assigned by the IESG.  Initially, such Expert discussions\
    \ take place\n   on the AAA WG mailing list.\n"
- title: 11.1.  Application Identifier
  contents:
  - "11.1.  Application Identifier\n   This specification assigns the value 12, 'Diameter\
    \ NAT Control\n   Application', to the Application Identifier namespace defined\
    \ in\n   [RFC6733].  See Section 4 for more information.\n"
- title: 11.2.  Command Codes
  contents:
  - "11.2.  Command Codes\n   This specification uses the value 330 from the Command\
    \ code namespace\n   defined in [RFC6733] for the NAT-Control-Request (NCR) and\
    \ NAT-\n   Control-Answer (NCA) commands.  See Section 6.1 and Section 6.2 for\n\
    \   more information on these commands.\n"
- title: 11.3.  AVP Codes
  contents:
  - "11.3.  AVP Codes\n   This specification assigns the values 595-607 from the AVP\
    \ Code\n   namespace defined in [RFC6733].  See Section 8.7 for the assignment\n\
    \   of the namespace in this specification.\n"
- title: 11.4.  Result-Code AVP Values
  contents:
  - "11.4.  Result-Code AVP Values\n   This specification assigns the values 4014\
    \ and 5042-5047 from the\n   Result-Code AVP value namespace defined in [RFC6733].\
    \  See\n   Section 8.2 for the assignment of the namespace in this\n   specification.\n"
- title: 11.5.  NC-Request-Type AVP
  contents:
  - "11.5.  NC-Request-Type AVP\n   As defined in Section 8.7.1, the NC-Request-Type\
    \ AVP includes\n   Enumerated type values 1-3.  IANA has created and is maintaining\
    \ a\n   namespace for this AVP.  All remaining values are available for\n   assignment\
    \ by a Designated Expert [RFC5226].\n"
- title: 11.6.  NAT-External-Port-Style AVP
  contents:
  - "11.6.  NAT-External-Port-Style AVP\n   As defined in Section 8.7.10, the NAT-External-Port-Style\
    \ AVP\n   includes Enumerated type value 1.  IANA has created and is\n   maintaining\
    \ a namespace for this AVP.  All remaining values are\n   available for assignment\
    \ by a Designated Expert [RFC5226].\n"
- title: 11.7.  NAT-Control-Binding-Status AVP
  contents:
  - "11.7.  NAT-Control-Binding-Status AVP\n   As defined in Section 8.7.1, the NAT-Control-Binding-Status\
    \ AVP\n   includes Enumerated type values 1-3.  IANA has created and is\n   maintaining\
    \ a namespace for this AVP.  All remaining values are\n   available for assignment\
    \ by a Designated Expert [RFC5226].\n"
- title: 12.  Security Considerations
  contents:
  - "12.  Security Considerations\n   This document describes procedures for controlling\
    \ NAT-related\n   attributes and parameters by an entity, which is non-local to\
    \ the\n   device performing NAT.  This section discusses security\n   considerations\
    \ for DNCA.  This includes the interactions between the\n   Diameter peers within\
    \ a NAT controller and a NAT device as well as\n   general considerations for\
    \ a NAT-control in a service provider\n   network.\n   Security between a NAT\
    \ controller and a NAT device has a number of\n   components: authentication,\
    \ authorization, integrity, and\n   confidentiality.\n   \"Authentication\" refers\
    \ to confirming the identity of an originator\n   for all datagrams received from\
    \ the originator.  Lack of\n   authentication of Diameter messages between the\
    \ Diameter peers can\n   jeopardize the fundamental service of the peering network\
    \ elements.\n   A consequence of not authenticating the message sender by the\n\
    \   recipient would be that an attacker could spoof the identity of a\n   \"legitimate\"\
    \ authorizing entity in order to change the behavior of\n   the receiver.  An\
    \ attacker could, for example, launch a DoS attack by\n   setting the maximum\
    \ number of bindings for a session on the NAT\n   device to zero; provisioning\
    \ bindings on a NAT device that includes\n   IP addresses already in use in other\
    \ parts of the network; or\n   requesting session termination of the Diameter\
    \ session and hampering\n   an endpoint's (i.e., a user's) connectivity.  Lack\
    \ of authentication\n   of a NAT device to a NAT controller could lead to situations\
    \ where\n   the NAT device could provide a wrong view of the resources (i.e.,\n\
    \   NAT-bindings).  In addition, a NAT-binding Predefined template on the\n  \
    \ NAT device could be configured differently than expected by the NAT\n   controller.\
    \  If either of the two DNCA Diameter peers fail to provide\n   the required credentials,\
    \ the failure should be subject to logging.\n   The corresponding logging infrastructure\
    \ of the operator SHOULD be\n   built in a way that it can mitigate potential\
    \ DoS attacks resulting\n   from large amounts of logging events.  This could\
    \ include proper\n   dimensioning of the logging infrastructure combined with\
    \ policing the\n   maximum amount of logging events accepted by the logging system\
    \ to a\n   threshold which the system is known to be able to handle.\n   \"Authorization\"\
    \ refers to whether a particular authorizing entity is\n   authorized to signal\
    \ a network element request for one or more\n   applications, adhering to a certain\
    \ policy profile.  Failing the\n   authorization process might indicate a resource\
    \ theft attempt or\n   failure due to administrative and/or credential deficiencies.\
    \  In\n   either case, the network element should take the proper measures to\n\
    \   log such attempts.\n   Integrity is required to ensure that a Diameter message\
    \ exchanged\n   between the Diameter peers has not been maliciously altered by\n\
    \   intermediate devices.  The result of a lack of data integrity\n   enforcement\
    \ in an untrusted environment could be that an impostor\n   will alter the messages\
    \ exchanged between the peers.  This could\n   cause a change of behavior of the\
    \ peers, including the potential of a\n   DoS.\n   Confidentiality protection\
    \ of Diameter messages ensures that the\n   signaling data is accessible only\
    \ to the authorized entities.  When\n   signaling messages between the DNCA Diameter\
    \ peers traverse untrusted\n   networks, lack of confidentiality will allow eavesdropping\
    \ and\n   traffic analysis.\n   Diameter offers security mechanisms to deal with\
    \ the functionality\n   demanded above.  DNCA makes use of the capabilities offered\
    \ by\n   Diameter and the underlying transport protocols to deliver these\n  \
    \ requirements (see Section 5.1).  If the DNCA communication traverses\n   untrusted\
    \ networks, messages between DNCA Diameter peers SHOULD be\n   secured using either\
    \ IPsec or TLS.  Please refer to [RFC6733],\n   Section 13 for details.  DNCA\
    \ Diameter peers SHOULD perform bilateral\n   authentication, authorization, as\
    \ well as procedures to ensure\n   integrity and confidentiality of the information\
    \ exchange.  In\n   addition, the Session-Id chosen for a particular Diameter\
    \ session\n   SHOULD be chosen in a way that it is hard to guess in order to\n\
    \   mitigate issues through potential message replay.\n   DNCA Diameter peers\
    \ SHOULD have a mutual trust setup.  This document\n   does not specify a mechanism\
    \ for authorization between the DNCA\n   Diameter peers.  The DNCA Diameter peers\
    \ SHOULD be provided with\n   sufficient information to make an authorization\
    \ decision.  The\n   information can come from various sources, for example, the\
    \ peering\n   devices could store local authentication policy, listing the\n \
    \  identities of authorized peers.\n   Any mechanism or protocol providing control\
    \ of a NAT device, and DNCA\n   is an example of such a control mechanism, could\
    \ allow for misuse of\n   the NAT device given that it enables the definition\
    \ of per-\n   destination or per-source rules.  Misuse could include anti-\n \
    \  competitive practices among providers, censorship, crime, etc.  NAT-\n   control\
    \ could be used as a tool for preventing or redirecting access\n   to particular\
    \ sites.  For instance, by controlling the NAT-bindings,\n   one could ensure\
    \ that endpoints aren't able to receive particular\n   flows, or that those flows\
    \ are redirected to a relay that snoops or\n   tampers with traffic instead of\
    \ directly forwarding the traffic to\n   the intended endpoint.  In addition,\
    \ one could set up a binding in a\n   way that the source IP address used is one\
    \ of a relay so that traffic\n   coming back can be snooped on or interfered with.\
    \  The operator also\n   needs to consider security threats resulting from unplanned\n\
    \   termination of the DNCA session.  Unplanned session termination,\n   which\
    \ could happen due to, e.g., an attacker taking down the NAT\n   controller, leads\
    \ to the NAT device cleaning up the state associated\n   with this session after\
    \ a grace period.  If the grace period is set\n   to zero, the endpoint will experience\
    \ an immediate loss of\n   connectivity to services reachable through the NAT\
    \ device following\n   the termination of the DNCA session.The protections on\
    \ DNCA and its\n   Diameter protocol exchanges don't prevent such abuses of NAT-control.\n\
    \   Prevention of misuse or misconfiguration of a NAT device by an\n   authorized\
    \ NAT controller is beyond the scope of this protocol\n   specification.  A service\
    \ provider deploying DNCA needs to make sure\n   that higher-layer processes and\
    \ procedures are put in place that\n   allow them to detect and mitigate misuses.\n"
- title: 13.  Examples
  contents:
  - "13.  Examples\n   This section shows example DNCA message content and exchange.\n"
- title: 13.1.  DNCA Session Establishment Example
  contents:
  - "13.1.  DNCA Session Establishment Example\n   Figure 15 depicts a typical call\
    \ flow for DNCA session establishment.\n   In this example, the NAT controller\
    \ does the following:\n   a.  requests a maximum of 100 NAT-bindings for the endpoint.\n\
    \   b.  defines a static binding for a TCP connection that associates the\n  \
    \     internal IP Address:Port 192.0.2.1:80 with the external IP\n       Address:Port\
    \ 198.51.100.1:80 for the endpoint.\n   c.  requests the use of a preconfigured\
    \ template called \"local-\n       policy\" while creating NAT-bindings for the\
    \ endpoint.\n   endpoint             NAT controller (within NAS)           NAT\
    \ device\n      |                            |                               |\n\
    \      |                            |                               |\n      |\
    \      1. Trigger            |                               |\n      |--------------------------->|\
    \                               |\n      |       +-------------------------------------+\
    \              |\n      |       |  2. Determine that NAT control      |      \
    \        |\n      |       |     is required for the endpoint    |            \
    \  |\n      |       +-------------------------------------+              |\n \
    \     |                            |                               |\n      |\
    \                            |                               |\n      |      \
    \                     ...................................\n      |           \
    \                .|   3. Diameter Base CER/CEA    |.\n      |                \
    \           .|<----------------------------->|.\n      |                     \
    \      ...................................\n      |                          \
    \  |                               |\n      |                            |   \
    \                            |\n      |                            |         4.\
    \  NCR               |\n      |                            |------------------------------>|\n\
    \      |                            |                               |\n      |\
    \                            |                     5. DNCA session\n      |  \
    \                          |                        established\n      |     \
    \                       |                               |\n      |           \
    \                 |         6.  NCA               |\n      |                 \
    \           |<------------------------------|\n      |                       \
    \     |                               |\n      |                            |\
    \                               |\n      |                  7. Data traffic  \
    \                         |\n      |----------------------------------------------------------->|\n\
    \      |                            |                               |\n      |\
    \                            |                               |\n      |      \
    \                      |                    8. NAT-bindings\n      |         \
    \                   |                     created as per\n      |            \
    \                |                   directives in the\n      |              \
    \              |                       DNCA session\n      |                 \
    \           |                               |\n                Figure 15: Initial\
    \ NAT-Control-Request and\n                       Session Establishment Example\n\
    \   Detailed description of the steps shown in Figure 15:\n   1.  The NAT controller\
    \ (co-located with the NAS here) creates state\n       for an endpoint based on\
    \ a trigger.  This could, for example, be\n       the successful establishment\
    \ of a Point-to-Point Protocol (PPP)\n       [RFC1661] access session.\n   2.\
    \  Based on the configuration of the DNCA Diameter peer within the\n       NAT\
    \ controller, the NAT controller determines that NAT-control is\n       required\
    \ and is to be enforced at a NAT device.\n   3.  If there is no Diameter session\
    \ already established with the DNCA\n       Diameter peer within NAT device, a\
    \ Diameter connection is\n       established and Diameter Base CER/CEA are exchanged.\n\
    \   4.  The NAT-Controller creates an NCR message (see below) and sends\n    \
    \   it to the NAT device.  This example shows IPv4 to IPv4 address\n       and\
    \ port translation.  For IPv6 to IPv4 translation, the Framed-\n       IP-Address\
    \ AVP would be replaced by the Framed-IPv6-Address AVP\n       with the value\
    \ set to the IPv6 address of the endpoint.\n     < NC-Request > ::= < Diameter\
    \ Header: 330, REQ, PXY>\n                      Session-Id =  \"natC.example.com:33041;23432;\"\
    \n                      Auth-Application-Id = <DNCA Application ID>\n        \
    \              Origin-Host = \"natC.example.com\"\n                      Origin-Realm\
    \ = \"example.com\"\n                      Destination-Realm = \"example.com\"\
    \n                      Destination-Host = \"nat-device.example.com\"\n      \
    \                NC-Request-Type = INITIAL_REQUEST\n                      User-Name\
    \ = \"subscriber_example1\"\n                      Framed-IP-Address = \"192.0.2.1\"\
    \n                      NAT-Control-Install = {\n                           NAT-Control-Definition\
    \ = {\n                              Protocol = TCP\n                        \
    \      Direction = OUT\n                              NAT-Internal-Address = {\n\
    \                                   Framed-IP-Address = \"192.0.2.1\"\n      \
    \                             Port = 80\n                              }\n   \
    \                           NAT-External-Address = {\n                       \
    \            Framed-IP-Address = \"198.51.100.1\"\n                          \
    \         Port = 80\n                              }\n                       \
    \    }\n                           Max-NAT-Bindings = 100\n                  \
    \         NAT-Control-Binding-Template = \"local-policy\"\n                  \
    \    }\n   5.  The NAT device establishes a DNCA session as it is able to comply\n\
    \       with the request.\n   6.  The NAT device sends an NCA to indicate the\
    \ successful completion\n       of the request.\n      <NC-Answer> ::= < Diameter\
    \ Header: 330, PXY >\n                       Session-Id =  \"natC.example.com:33041;23432;\"\
    \n                       Origin-Host = \"nat-device.example.com\"\n          \
    \             Origin-Realm = \"example.com\"\n                       NC-Request-Type\
    \ = INITIAL_REQUEST\n                       Result-Code = DIAMETER_SUCCESS\n \
    \  7.  The endpoint sends packets that reach the NAT device.\n   8.  The NAT device\
    \ performs NAT for traffic received from the\n       endpoint with source address\
    \ 192.0.2.1.  Traffic with source IP\n       address 192.0.2.1 and port 80 are\
    \ translated to the external IP\n       address 198.51.100.1 and port 80.  Traffic\
    \ with source IP address\n       192.0.2.1 and a source port different from 80\
    \ will be translated\n       to IP address 198.51.100.1 and a port chosen by the\
    \ NAT device.\n       Note that this example assumes that the NAT device follows\n\
    \       typical binding allocation rules for endpoints, in that only a\n     \
    \  single external IP address is used for all traffic received from\n       a\
    \ single IP address of an endpoint.  The NAT device will allow a\n       maximum\
    \ of 100 NAT-bindings be created for the endpoint.\n"
- title: 13.2.  DNCA Session Update with Port Style Example
  contents:
  - "13.2.  DNCA Session Update with Port Style Example\n   This section gives an\
    \ example for a DNCA session update: A new set of\n   NAT-bindings is requested\
    \ for an existing session.  The request\n   contains a directive ( the \"NAT-External-Port-Style\"\
    \ AVP set to\n   FOLLOW_INTERNAL_PORT_STYLE) that directs the NAT device to maintain\n\
    \   port-sequence and port-oddity for the newly created NAT-bindings.  In\n  \
    \ the example shown, the internal ports are UDP port 1036 and 1037.\n   The NAT\
    \ device follows the directive selects the external ports\n   accordingly.  The\
    \ NAT device would, for example, create a mapping of\n   192.0.2.1:1036 to 198.51.100.1:5056\
    \ and 192.0.2.1:1037 to\n   198.51.100.1:5057, thereby maintaining port oddity\
    \ (1036->5056,\n   1037->5057) and sequence ( the consecutive internal ports 1036\
    \ and\n   1037 map to the consecutive external ports 5056 and 5057).\n      <\
    \ NC-Request > ::= < Diameter Header: 330, REQ, PXY>\n                       Session-Id\
    \ =  \"natC.example.com:33041;23432;\"\n                       Auth-Application-Id\
    \ = <DNCA Application ID>\n                       Origin-Host = \"natC.example.com\"\
    \n                       Origin-Realm = \"example.com\"\n                    \
    \   Destination-Realm = \"example.com\"\n                       Destination-Host\
    \ = \"nat-device.example.com\"\n                       NC-Request-Type = UPDATE_REQUEST\n\
    \                       NAT-Control-Install = {\n                           NAT-Control-Definition\
    \ = {\n                               Protocol = UDP\n                       \
    \        Direction = OUT\n                               NAT-Internal-Address\
    \ = {\n                                    Framed-IP-Address = \"192.0.2.1\"\n\
    \                                    Port = 1035\n                           \
    \    }\n                           }\n                           NAT-Control-Definition\
    \ = {\n                               Protocol = UDP\n                       \
    \        Direction = OUT\n                               NAT-Internal-Address\
    \ = {\n                                    Framed-IP-Address = \"192.0.2.1\"\n\
    \                                    Port = 1036\n                           \
    \    }\n                           }\n                           NAT-External-Port-\n\
    \                                  Style = FOLLOW_INTERNAL_PORT_STYLE\n      \
    \                 }\n"
- title: 13.3.  DNCA Session Query Example
  contents:
  - "13.3.  DNCA Session Query Example\n   This section shows an example for DNCA\
    \ session query for a subscriber\n   whose internal IP Address is 192.0.2.1.\n\
    \      < NC-Request > ::= < Diameter Header: 330, REQ, PXY>\n                \
    \       Auth-Application-Id = <DNCA Application ID>\n                       Origin-Host\
    \ = \"natC.example.com\"\n                       Origin-Realm = \"example.com\"\
    \n                       Destination-Realm = \"example.com\"\n               \
    \        Destination-Host = \"nat-device.example.com\"\n                     \
    \  NC-Request-Type = QUERY_REQUEST\n                       Framed-IP-Address =\
    \ \"192.0.2.1\"\n   The NAT device constructs an NCA to report all currently active\
    \ NAT-\n   bindings whose internal address is 192.0.2.1.\n      <NC-Answer> ::=\
    \ < Diameter Header: 330, PXY >\n                    Origin-Host = \"nat-device.example.com\"\
    \n                    Origin-Realm = \"example.com\"\n                    NC-Request-Type\
    \ = QUERY_REQUEST\n                    NAT-Control-Definition = {\n          \
    \                  Protocol = TCP\n                            Direction = OUT\n\
    \                            NAT-Internal-Address = {\n                      \
    \          Framed-IP-Address = \"192.0.2.1\"\n                               \
    \ Port = 80\n                               }\n                            NAT-External-Address\
    \ = {\n                                 Framed-IP-Address = \"198.51.100.1\"\n\
    \                                 Port = 80\n                               }\n\
    \                            Session-Id = \"natC.example.com:33041;23432;\"\n\
    \                    }\n                    NAT-Control-Definition = {\n     \
    \                       Protocol = TCP\n                            Direction\
    \ = OUT\n                            NAT-Internal-Address = {\n              \
    \                  Framed-IP-Address = \"192.0.2.1\"\n                       \
    \         Port = 1036\n                               }\n                    \
    \        NAT-External-Address = {\n                                 Framed-IP-Address\
    \ = \"198.51.100.1\"\n                                 Port = 5056\n         \
    \                      }\n                            Session-Id = \"natC.example.com:33041;23432;\"\
    \n                    }\n                    NAT-Control-Definition = {\n    \
    \                        Protocol = TCP\n                            Direction\
    \ = OUT\n                            NAT-Internal-Address = {\n              \
    \                  Framed-IP-Address = \"192.0.2.1\"\n                       \
    \         Port = 1037\n                               }\n                    \
    \        NAT-External-Address = {\n                                 Framed-IP-Address\
    \ = \"198.51.100.1\"\n                                 Port = 5057\n         \
    \                      }\n                            Session-Id = \"natC.example.com:33041;23432;\"\
    \n                       }\n"
- title: 13.4.  DNCA Session Termination Example
  contents:
  - "13.4.  DNCA Session Termination Example\n   In this example the NAT controller\
    \ decides to terminate the\n   previously established DNCA session.  This could,\
    \ for example, be the\n   case as a result of an access session (e.g., a PPP session)\n\
    \   associated with an endpoint having been torn down.\n       NAT controller\
    \                            NAT device\n             |                      \
    \                 |\n             |                                       |\n\
    \    +--------------+                                 |\n    |  1. Trigger  |\
    \                                 |\n    +--------------+                    \
    \             |\n             |                                       |\n    \
    \         |                                       |\n             |          \
    \   2.  STR                   |\n             |-------------------------------------->|\n\
    \             |                                       |\n             |      \
    \                       3. DNCA session\n             |                      \
    \             lookup\n             |             4.  ACR                   |\n\
    \             |<--------------------------------------|\n             |      \
    \                                 |\n             |             5.  ACA      \
    \             |\n             |-------------------------------------->|\n    \
    \         |                                       |\n             |          \
    \                             |\n             |                             6.\
    \ DNCA bindings\n             |                            and session cleanup\n\
    \             |                                       |\n             |      \
    \       7.  STA                   |\n             |<--------------------------------------|\n\
    \             |                                       |\n            Figure 20:\
    \  NAT Control Session Termination Example\n   The following steps describe the\
    \ sequence of events for tearing down\n   the DNCA session in the example above:\n\
    \   1.  The NAT controller receives a trigger that a DNCA session\n       associated\
    \ with a specific endpoint should be terminated.  An\n       example event could\
    \ be the termination of the PPP [RFC1661]\n       access session to an endpoint\
    \ in a NAS.  The NAS correspondingly\n       triggers the NAT controller request\
    \ to tear down the associated\n       DNCA session.\n   2.  The NAT controller\
    \ creates the required NCR message and sends it\n       to the NAT device:\n \
    \     < STR >     ::= < Diameter Header: 275, REQ, PXY>\n                    \
    \   Session-Id =  \"natC.example.com:33041;23432;\"\n                       Auth-Application-Id\
    \ = <DNCA Application ID>\n                       Origin-Host = \"natC.example.com\"\
    \n                       Origin-Realm = \"example.com\"\n                    \
    \   Destination-Realm = \"example.com\"\n                       Destination-Host\
    \ = \"nat-device.example.com\"\n                       Termination-Cause = DIAMETER_LOGOUT\n\
    \   3.  The NAT device looks up the DNCA session based on the Session-Id\n   \
    \    AVP and finds a previously established active session.\n   4.  The NAT device\
    \ reports all NAT-bindings established for that\n       subscriber using an ACR:\n\
    \      < ACR >     ::= < Diameter Header: 271, REQ, PXY>\n                   \
    \    Session-Id =  \"natC.example.com:33041;23432;\"\n                       Auth-Application-Id\
    \ = <DNCA Application ID>\n                       Origin-Host = \"nat-device.example.com\"\
    \n                       Origin-Realm = \"example.com\"\n                    \
    \   Destination-Realm = \"example.com\"\n                       Destination-Host\
    \ = \"natC.example.com\"\n                       Accounting-Record-Type = STOP_RECORD\n\
    \                       Accounting-Record-Number = 1\n                       NAT-Control-Record\
    \ = {\n                           NAT-Control-Definition = {\n               \
    \                Protocol = TCP\n                               Direction = OUT\n\
    \                               NAT-Internal-Address = {\n                   \
    \                Framed-IP-Address = \"192.0.2.1\"\n                         \
    \          Port = 5001\n                                  }\n                \
    \               NAT-External-Address = {\n                                   \
    \ Framed-IP-Address = \"198.51.100.1\"\n                                    Port\
    \ = 7777\n                                  }\n                              }\n\
    \                             NAT-Control-Binding-Status = Removed\n         \
    \                 }\n   5.  The NAT controller receives and processes the ACR\
    \ as per its\n       configuration.  It responds with an ACA to the NAT device.\n\
    \      <ACA>      ::= < Diameter Header: 271, PXY >\n                       Session-Id\
    \ =  \"natC.example.com:33041;23432;\"\n                       Origin-Host = \"\
    natC.example.com\"\n                       Origin-Realm = \"example.com\"\n  \
    \                     Result-Code = DIAMETER_SUCCESS\n                       Accounting-Record-Type\
    \ = STOP_RECORD\n                       Accounting-Record-Number = 1\n   6.  On\
    \ receipt of the ACA the NAT device cleans up all NAT-bindings\n       and associated\
    \ session state for the endpoint.\n   7.  NAT device sends an STA.  On receipt\
    \ of the STA the NAT\n       controller will clean up the corresponding session\
    \ state.\n      <STA>      ::= < Diameter Header: 275, PXY >\n               \
    \        Session-Id =  \"natC.example.com:33041;23432;\"\n                   \
    \    Origin-Host = \"nat-device.example.com\"\n                       Origin-Realm\
    \ = \"example.com\"\n                       Result-Code = DIAMETER_SUCCESS\n"
- title: 14.  Acknowledgements
  contents:
  - "14.  Acknowledgements\n   The authors would like to thank Jari Arkko, Wesley\
    \ Eddy, Stephen\n   Farrell, Miguel A. Garcia, David Harrington, Jouni Korhonen,\
    \ Matt\n   Lepinski, Avi Lior, Chris Metz, Pallavi Mishra, Lionel Morand, Robert\n\
    \   Sparks, Martin Stiemerling, Dave Thaler, Hannes Tschofenig, Sean\n   Turner,\
    \ Shashank Vikram, Greg Weber, and Glen Zorn for their input on\n   this document.\n"
- title: 15.  References
  contents:
  - '15.  References

    '
- title: 15.1.  Normative References
  contents:
  - "15.1.  Normative References\n   [ETSIES283034]  ETSI, \"Telecommunications and\
    \ Internet Converged\n                   Services and Protocols for Advanced Networks\n\
    \                   (TISPAN), Network Attachment Sub-System (NASS), e4\n     \
    \              interface based on the Diameter protocol.\",\n                \
    \   September 2008.\n   [RFC2119]       Bradner, S., \"Key words for use in RFCs\
    \ to Indicate\n                   Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC4005]       Calhoun, P., Zorn, G., Spence, D., and D. Mitton,\n\
    \                   \"Diameter Network Access Server Application\",\n        \
    \           RFC 4005, August 2005.\n   [RFC4675]       Congdon, P., Sanchez, M.,\
    \ and B. Aboba, \"RADIUS\n                   Attributes for Virtual LAN and Priority\
    \ Support\",\n                   RFC 4675, September 2006.\n   [RFC5226]     \
    \  Narten, T. and H. Alvestrand, \"Guidelines for Writing\n                  \
    \ an IANA Considerations Section in RFCs\", BCP 26,\n                   RFC 5226,\
    \ May 2008.\n   [RFC5777]       Korhonen, J., Tschofenig, H., Arumaithurai, M.,\n\
    \                   Jones, M., and A. Lior, \"Traffic Classification and\n   \
    \                Quality of Service (QoS) Attributes for Diameter\",\n       \
    \            RFC 5777, February 2010.\n   [RFC6733]       Fajardo, V., Arkko,\
    \ J., Loughney, J., and G. Zorn,\n                   \"Diameter Base Protocol\"\
    , RFC 6733, October 2012.\n"
- title: 15.2.  Informative References
  contents:
  - "15.2.  Informative References\n   [CGN-REQS]      Perreault, S., Yamagata, I.,\
    \ Miyakawa, S., Nakagawa,\n                   A., and H. Ashida, \"Common requirements\
    \ for Carrier\n                   Grade NATs (CGNs)\", Work in Progress, September\
    \ 2012.\n   [RFC1661]       Simpson, W., \"The Point-to-Point Protocol (PPP)\"\
    ,\n                   STD 51, RFC 1661, July 1994.\n   [RFC2663]       Srisuresh,\
    \ P. and M. Holdrege, \"IP Network Address\n                   Translator (NAT)\
    \ Terminology and Considerations\",\n                   RFC 2663, August 1999.\n\
    \   [RFC3022]       Srisuresh, P. and K. Egevang, \"Traditional IP Network\n \
    \                  Address Translator (Traditional NAT)\", RFC 3022,\n       \
    \            January 2001.\n   [RFC3303]       Srisuresh, P., Kuthan, J., Rosenberg,\
    \ J., Molitor,\n                   A., and A. Rayhan, \"Middlebox communication\n\
    \                   architecture and framework\", RFC 3303, August 2002.\n   [RFC3304]\
    \       Swale, R., Mart, P., Sijben, P., Brim, S., and M.\n                  \
    \ Shore, \"Middlebox Communications (midcom) Protocol\n                   Requirements\"\
    , RFC 3304, August 2002.\n   [RFC3411]       Harrington, D., Presuhn, R., and\
    \ B. Wijnen, \"An\n                   Architecture for Describing Simple Network\
    \ Management\n                   Protocol (SNMP) Management Frameworks\", STD\
    \ 62,\n                   RFC 3411, December 2002.\n   [RFC3550]       Schulzrinne,\
    \ H., Casner, S., Frederick, R., and V.\n                   Jacobson, \"RTP: A\
    \ Transport Protocol for Real-Time\n                   Applications\", STD 64,\
    \ RFC 3550, July 2003.\n   [RFC4097]       Barnes, M., \"Middlebox Communications\
    \ (MIDCOM)\n                   Protocol Evaluation\", RFC 4097, June 2005.\n \
    \  [RFC5189]       Stiemerling, M., Quittek, J., and T. Taylor,\n            \
    \       \"Middlebox Communication (MIDCOM) Protocol\n                   Semantics\"\
    , RFC 5189, March 2008.\n   [RFC6145]       Li, X., Bao, C., and F. Baker, \"\
    IP/ICMP Translation\n                   Algorithm\", RFC 6145, April 2011.\n \
    \  [RFC6146]       Bagnulo, M., Matthews, P., and I. van Beijnum,\n          \
    \         \"Stateful NAT64: Network Address and Protocol\n                   Translation\
    \ from IPv6 Clients to IPv4 Servers\",\n                   RFC 6146, April 2011.\n\
    \   [RFC6241]       Enns, R., Bjorklund, M., Schoenwaelder, J., and A.\n     \
    \              Bierman, \"Network Configuration Protocol (NETCONF)\",\n      \
    \             RFC 6241, June 2011.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Frank Brockners\n   Cisco\n   Hansaallee 249, 3rd Floor\n\
    \   Duesseldorf, Nordrhein-Westfalen  40549\n   Germany\n   EMail: fbrockne@cisco.com\n\
    \   Shwetha Bhandari\n   Cisco\n   Cessna Business Park, Sarjapura Marathalli\
    \ Outer Ring Road\n   Bangalore, Karnataka 560 087\n   India\n   EMail: shwethab@cisco.com\n\
    \   Vaneeta Singh\n   18, Cambridge Road\n   Bangalore 560008\n   India\n   EMail:\
    \ vaneeta.singh@gmail.com\n   Victor Fajardo\n   Telcordia Technologies\n   1\
    \ Telcordia Drive #1S-222\n   Piscataway, NJ 08854\n   USA\n   EMail: vf0213@gmail.com\n"
