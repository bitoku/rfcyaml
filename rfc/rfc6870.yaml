- title: __initial_text__
  contents:
  - '             Pseudowire Preferential Forwarding Status Bit

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes a mechanism for signaling the active and\n\
    \   standby status of redundant Pseudowires (PWs) between their\n   termination\
    \ points.  A set of Redundant PWs is configured between\n   Provider Edge (PE)\
    \ nodes in single-segment pseudowire (SS-PW)\n   applications or between Terminating\
    \ Provider Edge (T-PE) nodes in\n   Multi-Segment Pseudowire (MS-PW) applications.\n\
    \   In order for the PE/T-PE nodes to indicate the preferred PW to use\n   for\
    \ forwarding PW packets to one another, a new status bit is\n   defined.  This\
    \ bit indicates a Preferential Forwarding status with a\n   value of active or\
    \ standby for each PW in a redundant set.\n   In addition, a second status bit\
    \ is defined to allow peer PE nodes to\n   coordinate a switchover operation of\
    \ the PW.\n   Finally, this document updates RFC 4447 by adding details to the\n\
    \   handling of the PW status code bits in the PW Status TLV.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6870.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2013 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. Requirements Language ......................................4\n  \
    \ 2. Motivation and Scope ............................................4\n   3.\
    \ Terminology .....................................................7\n   4. PE\
    \ Architecture .................................................9\n   5. Modes\
    \ of Operation ..............................................9\n      5.1. Independent\
    \ Mode ...........................................9\n      5.2. Master/Slave Mode\
    \ .........................................12\n   6. PW State Transition Signaling\
    \ Procedures .......................14\n      6.1. PW Standby Notification Procedures\
    \ in Independent Mode ....14\n      6.2. PW Standby Notification Procedures in\
    \ Master/Slave Mode ...15\n           6.2.1. PW State Machine ...................................16\n\
    \      6.3. Coordination of PW Switchover .............................17\n  \
    \         6.3.1. Procedures at the Requesting Endpoint ..............18\n    \
    \       6.3.2. Procedures at the Receiving Endpoint ...............20\n   7. Status\
    \ Mapping .................................................20\n      7.1. AC Defect\
    \ State Entry/Exit ................................21\n      7.2. PW Defect State\
    \ Entry/Exit ................................21\n   8. Applicability and Backward\
    \ Compatibility .......................21\n   9. Security Considerations ........................................22\n\
    \   10. MIB Considerations ............................................22\n  \
    \ 11. IANA Considerations ...........................................22\n    \
    \  11.1. Status Code for PW Preferential Forwarding Status ........22\n      11.2.\
    \ Status Code for PW Request Switchover Status .............23\n   12. Contributors\
    \ ..................................................23\n   13. Acknowledgments\
    \ ...............................................24\n   14. References ....................................................24\n\
    \      14.1. Normative References .....................................24\n  \
    \    14.2. Informative References ...................................24\n    Appendix\
    \ A. Applications of PW Redundancy Procedures .............26\n      A.1. One\
    \ Multi-Homed CE with Single SS-PW Redundancy ...........26\n      A.2. Multiple\
    \ Multi-Homed CEs with SS-PW Redundancy ............28\n      A.3. Multi-Homed\
    \ CE with MS-PW Redundancy ......................30\n      A.4. Multi-Homed CE\
    \ with MS-PW Redundancy and S-PE Protection ..31\n      A.5. Single-Homed CE with\
    \ MS-PW Redundancy .....................32\n      A.6. PW Redundancy between H-VPLS\
    \ MTU-s and PE-rs ..............33\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document provides the extensions to the Pseudowire\
    \ (PW) control\n   plane to support the protection schemes of the PW redundancy\n\
    \   applications described in RFC 6718, \"Pseudowire (PW) Redundancy\" [8].\n\
    \   It specifies a new PW status bit as well as the procedures Provider\n   Edge\
    \ (PE) nodes follow to notify one another of the Preferential\n   Forwarding state\
    \ of each PW in the redundant set, i.e., active or\n   standby.  This status bit\
    \ is different from the PW status bits\n   already defined in RFC 4447, the pseudowire\
    \ setup and maintenance\n   protocol [2].  In addition, this document specifies\
    \ a second status\n   bit to allow peer PE nodes to coordinate a switchover operation\
    \ of\n   the PW from active to standby, or vice versa.\n   As a result of the\
    \ introduction of these new status bits, this\n   document updates RFC 4447 by\
    \ clarifying the rules for processing\n   status bits not originally defined in\
    \ RFC 4447.  It also updates RFC\n   4447 by defining that a status bit can indicate\
    \ a status other than a\n   fault or can indicate an instruction to the peer PE.\
    \  See more\n   details in Section 8.\n   Section 15 shows in detail how the mechanisms\
    \ described in this\n   document are used to achieve the desired protection schemes\
    \ of the\n   applications described in [8].\n"
- title: 1.1.  Requirements Language
  contents:
  - "1.1.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [1].\n"
- title: 2.  Motivation and Scope
  contents:
  - "2.  Motivation and Scope\n   The PW setup and maintenance protocol defines the\
    \ following status\n   codes in the PW Status TLV to indicate the state for an\
    \ attachment\n   circuit (AC) and a PW [7]:\n   0x00000000 - Pseudowire forwarding\
    \ (clear all failures)\n   0x00000001 - Pseudowire Not Forwarding\n   0x00000002\
    \ - Local Attachment Circuit (ingress) Receive Fault\n   0x00000004 - Local Attachment\
    \ Circuit (egress) Transmit Fault\n   0x00000008 - Local PSN-facing PW (ingress)\
    \ Receive Fault\n   0x00000010 - Local PSN-facing PW (egress) Transmit Fault\n\
    \   The applications defined in [8] allow the provisioning of a primary\n   PW\
    \ and one or many secondary backup PWs in the same Virtual Private\n   Wire Service\
    \ (VPWS) or Virtual Private LAN Service (VPLS).  The\n   objective of PW redundancy\
    \ is to maintain end-to-end connectivity for\n   the emulated service by activating\
    \ the correct PW whenever an AC, a\n   PE, or a PW fails.  The correct PW means\
    \ the one that provides the\n   end-to-end connectivity from Customer Edge (CE)\
    \ to CE such that\n   packets continue to flow.\n   A PE node makes a selection\
    \ of which PW to activate at any given time\n   for the purpose of forwarding\
    \ user packets.  This selection takes\n   into account the local state of the\
    \ PW and AC, as well as the remote\n   state of the PW and AC as indicated in\
    \ the PW status bits it received\n   from the peer PE node.\n   In the absence\
    \ of faults, all PWs are up both locally and remotely,\n   and a PE node needs\
    \ to select a single PW to which to forward user\n   packets.  This is referred\
    \ to as the active PW.  All other PWs will\n   be in standby and must not be used\
    \ to forward user packets.\n   In order for both ends of the service to select\
    \ the same PW for\n   forwarding user packets, this document defines a new status\
    \ bit: the\n   Preferential Forwarding status bit.  It also defines the procedures\n\
    \   the PE nodes follow to indicate the Preferential Forwarding state of\n   a\
    \ PW to its peer PE node.\n   In addition, a second status bit is defined to allow\
    \ peer PE nodes to\n   coordinate a switchover operation of the PW if required\
    \ by the\n   application.  This is known as the Request Switchover status bit.\n\
    \   Together, the mechanisms described in this document achieve the\n   following\
    \ protection capabilities defined in [8]:\n      a. A 1:1 protection in which\
    \ a specific subset of a path for an\n         emulated service, consisting of\
    \ a standby PW and/or AC,\n         protects another specific subset of a path\
    \ for the emulated\n         service, consisting of an active PW and/or AC.  An\
    \ active PW\n         can forward data traffic and control plane traffic, such\
    \ as\n         Operations, Administration, and Maintenance (OAM) packets.  A\n\
    \         standby PW does not carry data traffic.\n      b. An N:1 protection\
    \ scheme in which N specific subsets of a path\n         for an emulated service,\
    \ consisting each of a standby PW and/or\n         AC, protect a specific subset\
    \ of a path for the emulated\n         service, consisting of an active PW and/or\
    \ AC.\n      c. A mechanism to allow PW endpoints to coordinate the switchover\n\
    \         to a given PW by using an explicit request/acknowledgment\n        \
    \ switchover procedure.  This mechanism is complementary to the\n         independent\
    \ mode of operation and is described in Section 6.3.\n         6.3.  This mechanism\
    \ can be invoked manually by the user,\n         effectively providing a manual\
    \ switchover capability.  It can\n         also be invoked automatically to resolve\
    \ a situation where the\n         PW endpoints could not match the two directions\
    \ of the PW.\n      d. A locally configured precedence to govern the selection\
    \ of a PW\n         when more than one PW qualifies for the active state, as\n\
    \         defined in Sections 5.1. and 5.2.  The PW with the lowest\n        \
    \ precedence value has the highest priority.  Precedence may be\n         configured\
    \ via, for example, a local configuration parameter at\n         the PW endpoint.\n\
    \      e. By configuration, implementations can designate one PW in the\n    \
    \     1:1 or N:1 protection as a primary PW and the remaining as\n         secondary\
    \ PWs.  If more than one PW qualifies for the active\n         state, as defined\
    \ in Sections 5.1 and 5.2, a PE node selects\n         the primary PW in preference\
    \ to a secondary PW.  In other\n         words, the primary PW has implicitly\
    \ the lowest precedence\n         value.  Furthermore, a PE node reverts to the\
    \ primary PW\n         immediately after it comes back up or after the expiration\
    \ of a\n         delay effectively achieving revertive protection switching.\n\
    \   1+1 protection (in which one specific subset of a path for an\n   emulated\
    \ service, consisting of a standby PW and/or AC, protects\n   another specific\
    \ subset of a path for the emulated service and in\n   which traffic is permanently\
    \ duplicated at the ingress node on both\n   the currently active and standby\
    \ subsets of the paths) is not\n   supported.\n   The above protection schemes\
    \ are provided using the following\n   operational modes:\n      1. An independent\
    \ mode of operation in which each PW endpoint node\n         uses its own local\
    \ rule to select which PW it intends to\n         activate at any given time,\
    \ and advertises that PW to the\n         remote endpoints.  Only a PW that is\
    \ up and that indicated\n         active status bit locally and remotely is in\
    \ the active state\n         and can be used to forward data packets.  This is\
    \ described in\n         Section 5.1.\n      2. A master/slave mode in which one\
    \ PW endpoint, the master\n         endpoint, selects and dictates to the other\
    \ endpoint(s), the\n         slave endpoint(s), which PW to activate.  This is\
    \ described in\n         Section 5.2.\n   Note that this document specifies the\
    \ mechanisms to support PW\n   redundancy where a set of redundant PWs terminate\
    \ on either a PE, in\n   the case of an SS-PW, or on a T-PE, in the case of an\
    \ MS-PW.  PW\n   redundancy scenarios where the redundant set of PW segments\n\
    \   terminates on a Switching Provider Edge (S-PE) are for further study.\n"
- title: 3. Terminology
  contents:
  - "3. Terminology\n   Pseudowire (PW): A mechanism that carries the essential elements\
    \ of\n         an emulated service from one PE to one or more other PEs over a\n\
    \         Public Service Network (PSN) [9].\n   Single-Segment Pseudowire (SS-PW):\
    \ A PW set up directly between two\n         T-PE devices.  The PW label is unchanged\
    \ between the\n         originating and terminating PEs [6].\n   Multi-Segment\
    \ Pseudowire (MS-PW): A static or dynamically configured\n         set of two\
    \ or more contiguous PW segments that behave and\n         function as a single\
    \ point-to-point PW.  Each end of an MS-PW,\n         by definition, terminates\
    \ on a T-PE [6].\n   Up PW: A PW that has been configured (label mapping exchanged\
    \ between\n         PEs) and is not showing any of the PW or AC status bits\n\
    \         specified in [7].  Such a PW is available for forwarding\n         traffic\
    \ [8].\n   Down PW: A PW that either has not been fully configured or has been\n\
    \         configured and is showing any of the PW or AC status bits\n        \
    \ specified in [7]; such a PW is not available for forwarding\n         traffic\
    \ [8].\n   Active PW:  An up PW used for forwarding user, OAM, and control plane\n\
    \         traffic [8].\n   Standby PW: An up PW that is not used for forwarding\
    \ user traffic but\n         may forward OAM and specific control plane traffic\
    \ [8].\n   Primary PW: The PW that a PW endpoint activates in preference to any\n\
    \         other PW when more than one PW qualifies for active state.\n       \
    \  When the primary PW comes back up after a failure and qualifies\n         for\
    \ active state, the PW endpoint always reverts to it.  The\n         designation\
    \ of primary is performed by local configuration for\n         the PW at the PE\
    \ and is only required when revertive protection\n         switching is used [8].\n\
    \   Secondary PW: When it qualifies for active state, a secondary PW is\n    \
    \     only selected if no primary PW is configured or if the\n         configured\
    \ primary PW does not qualify for active state (e.g.,\n         is down).  By\
    \ default, a PW in a redundancy PW set is\n         considered secondary.  There\
    \ is no revertive mechanism among\n         secondary PWs [8].\n   PW Precedence:\
    \ This is a configuration local to the PE that dictates\n         the order in\
    \ which a forwarder chooses to use a PW when\n         multiple PWs all qualify\
    \ for the active state.  Note that a PW\n         that has been configured as\
    \ primary has, implicitly, the lowest\n         precedence value.\n   PW Endpoint:\
    \ A PE where a PW terminates on a point where Native\n         Service Processing\
    \ is performed, e.g., an SS-PW PE, an MS-PW\n         T-PE, a Hierarchical VPLS\
    \ (H-VPLS) MTU-s, or PE-rs [8].\n   Provider Edge (PE): A device that provides\
    \ PWE3 to a CE [9].\n   PW Terminating Provider Edge (T-PE): A PE where the customer-facing\n\
    \         ACs are bound to a PW forwarder.  A terminating PE is present\n    \
    \     in the first and last segments of an MS-PW.  This incorporates\n       \
    \  the functionality of a PE as defined in RFC 3985 [6].\n   PW Switching Provider\
    \ Edge (S-PE): A PE capable of switching the\n         control and data planes\
    \ of the preceding and succeeding PW\n         segments in an MS-PW.  The S-PE\
    \ terminates the PSN tunnels of\n         the preceding and succeeding segments\
    \ of the MS-PW.  Therefore,\n         it includes a PW switching point for an\
    \ MS-PW.  A PW switching\n         point is never the S-PE and the T-PE for the\
    \ same MS-PW.  A PW\n         switching point runs necessary protocols to set\
    \ up and manage\n         PW segments with other PW switching points and terminating\
    \ PEs.\n         An S-PE can exist anywhere a PW must be processed or policy\n\
    \         applied.  Therefore, it is not limited to the edge of a\n         provider\
    \ network [6].\n   MTU-s: A hierarchical virtual private LAN service Multi-Tenant\
    \ Unit\n         switch, as defined in RFC 4762 [3].\n   PE-rs: A routing and\
    \ bridging capable PE as defined in RFC 4762 [3].\n   FEC: Forwarding Equivalence\
    \ Class.\n   OAM: Operations, Administration, and Maintenance.\n   VCCV: Virtual\
    \ Connection Connectivity Verification.\n   This document uses the term 'PE' to\
    \ be synonymous with both PEs as\n   per RFC 3985 [9] and T-PEs as per RFC 5659\
    \ [6].\n   This document uses the term 'PW' to be synonymous with both PWs as\n\
    \   per RFC 3985 [9] and SS-PWs, MS-PWs, and PW segments as per RFC 5659\n   [6].\n"
- title: 4.  PE Architecture
  contents:
  - "4.  PE Architecture\n   Figure 1 shows the PE architecture for PW redundancy,\
    \ when more than\n   one PW in a redundant set is associated with a single AC.\
    \  This is\n   based on the architecture in Figure 4b of RFC 3985 [9].  The\n\
    \   forwarder selects which of the redundant PWs to use based on the\n   criteria\
    \ described in this document.\n              +----------------------------------------+\n\
    \              |                PE Device               |\n              +----------------------------------------+\n\
    \     Single   |                 |        Single        | PW Instance\n      AC\
    \      |                 +      PW Instance     X<===========>\n             \
    \ |                 |                      |\n              |                \
    \ |----------------------|\n      <------>o                 |        Single  \
    \      | PW Instance\n              |    Forwarder    +      PW Instance     X<===========>\n\
    \              |                 |                      |\n              |   \
    \              |----------------------|\n              |                 |   \
    \     Single        | PW Instance\n              |                 +      PW Instance\
    \     X<===========>\n              |                 |                      |\n\
    \              +----------------------------------------+\n               Figure\
    \ 1. PE Architecture for PW Redundancy\n"
- title: 5.  Modes of Operation
  contents:
  - "5.  Modes of Operation\n   There are two modes of operation for the use of the\
    \ PW Preferential\n   Forwarding status bits:\n   o  independent mode\n   o  master/slave\
    \ mode\n"
- title: 5.1.  Independent Mode
  contents:
  - "5.1.  Independent Mode\n   PW endpoint nodes independently select which PWs are\
    \ eligible to\n   become active and which are not.  They advertise the corresponding\n\
    \   active or standby Preferential Forwarding status for each PW.  Each\n   PW\
    \ endpoint compares local and remote status bits and uses the PW\n   that is up\
    \ at both endpoints and that advertised active Preferential\n   Forwarding status\
    \ at both the local and remote endpoints.\n   In this mode of operation, the Preferential\
    \ Forwarding status\n   indicates the preferred forwarding state of each endpoint\
    \ but the\n   actual forwarding state of the PW is the result of the comparison\
    \ of\n   the local and remote forwarding status bits.\n   If more than one PW\
    \ qualifies for the active state, each PW endpoint\n   MUST implement a common\
    \ mechanism to choose the PW for forwarding.\n   The default mechanism MUST be\
    \ supported by all implementations, and\n   it operates as follows:\n   1. For\
    \ a PW using the PWid ID Forwarding Equivalence Class (PWid FEC)\n      [2], the\
    \ PW with the lowest PWid value is selected.\n   2. For a PW using the Generalized\
    \ PWid FEC [2], each PW in a\n      redundant set is uniquely identified at each\
    \ PE using the\n      following triplet: AGI::SAII::TAII.  The unsigned integer\
    \ form of\n      the concatenated word can be used in the comparison.  However,\
    \ the\n      Source Attachment Individual Identifier (SAII) and Target\n     \
    \ Attachment Individual Identifier (TAII) values as seen on a PE\n      node are\
    \ the mirror values of what the peer PE node sees.  So that\n      both PE nodes\
    \ compare the same value, the PE with the lowest\n      system IP address MUST\
    \ use the unsigned integer form of\n      AGI::SAII::TAII, while the PE with the\
    \ highest system IP address\n      MUST use the unsigned integer form of AGI::TAII::SAII.\
    \  This way,\n      both PE nodes will compare the same values.  The PW that\n\
    \      corresponds to the minimum of the compared values across all PWs\n    \
    \  in the redundant set is selected.\n      In the case where the system IP address\
    \ is not known, it is\n      RECOMMENDED to implement the active PW selection\
    \ mechanism\n      described next.\n      In the case of segmented PW, the operator\
    \ needs to make sure that\n      the PWid or AGI::SAII::TAII of the redundant\
    \ PWs within the first\n      and last segment are ordered consistently such that\
    \ the same end-\n      to-end MS-PW gets selected.  Otherwise, it is RECOMMENDED\
    \ to\n      implement the active PW selection mechanism described next.\n   The\
    \ PW endpoints MAY also implement the following active PW selection\n   mechanism:\n\
    \   1. If the PW endpoint is configured with the precedence parameter on\n   \
    \   each PW in the redundant set, it selects the PW with the lowest\n      configured\
    \ precedence value.\n   2. If the PW endpoint is configured with one PW as primary\
    \ and one or\n      more PWs as secondary, it selects the primary PW in preference\
    \ to\n      all secondary PWs.  If a primary PW is not available, it selects\n\
    \      the secondary PW with the lowest precedence value.  If the primary\n  \
    \    PW becomes available, a PW endpoint reverts to it immediately or\n      after\
    \ the expiration of a configurable delay.\n   3. This active PW selection mechanism\
    \ assumes the precedence\n      parameter values are configured consistently at\
    \ both PW endpoints\n      and that unique values are assigned to the PWs in the\
    \ same\n      redundant set to achieve tiebreaking using this mechanism.\n   There\
    \ are scenarios with dual-homing of a CE to PE nodes where each\n   PE node needs\
    \ to advertise active Preferential Forwarding status on\n   more than one PW in\
    \ the redundant set.  However, a PE MUST always\n   select a single PW for forwarding\
    \ using the above active PW selection\n   algorithm.  An example of such a case\
    \ is described in 15.2.\n   There are scenarios where each PE needs to advertise\
    \ active\n   Preferential Forwarding status on a single PW in the redundant set.\n\
    \   In order to ensure that both PE nodes make the same selection, they\n   MUST\
    \ use the above active PW selection algorithm to determine the PW\n   eligible\
    \ for active state.  An example of such a case is described in\n   15.5.\n   In\
    \ steady state with consistent configuration, a PE will always find\n   an active\
    \ PW.  However, it is possible that such a PW is not found\n   due to a misconfiguration.\
    \  In the event that an active PW is not\n   found, a management notification\
    \ SHOULD be generated.  If a\n   management notification for failure to find an\
    \ active PW was\n   generated and an active PW is subsequently found, a management\n\
    \   notification SHOULD be generated, so clearing the previous failure\n   indication.\
    \  Additionally, a PE MAY use the request switchover\n   procedures described\
    \ in Section 6.3 to have both PE nodes switch to a\n   common PW.\n   There may\
    \ also be transient conditions where endpoints do not share a\n   common view\
    \ of the active/standby state of the PWs.  This could be\n   caused by propagation\
    \ delay of the Targeted Label Distribution\n   Protocol (T-LDP) status messages\
    \ between endpoints.  In this case,\n   the behavior of the receiving endpoint\
    \ is outside the scope of this\n   document.\n   Thus, in this mode of operation,\
    \ the following definition of active\n   and standby PW states apply:\n   o  Active\
    \ State\n   A PW is considered to be in active state when the PW labels are\n\
    \   exchanged between its two endpoints and the status bits exchanged\n   between\
    \ the endpoints indicate the PW is up and its Preferential\n   Forwarding status\
    \ is active at both endpoints.  In this state user\n   traffic can flow over the\
    \ PW in both directions.  As described in\n   Section 5.1, the PE nodes MUST implement\
    \ a common mechanism to select\n   one PW for forwarding in case multiple PWs\
    \ qualify for the active\n   state.\n   o  Standby State\n   A PW is considered\
    \ to be in standby state when the PW labels are\n   exchanged between its two\
    \ endpoints, but the Preferential Forwarding\n   status bits exchanged indicate\
    \ the PW Preferential Forwarding status\n   is standby at one or both endpoints.\
    \  In this state, the endpoints\n   MUST NOT forward data traffic over the PW\
    \ but MAY allow PW OAM\n   packets, e.g., Virtual Connection Connectivity Verification\
    \ (VCCV)\n   packets [11], to be sent and received in order to test the liveliness\n\
    \   of standby PWs.  The endpoints of the PW MAY also allow the\n   forwarding\
    \ of specific control plane packets of applications using\n   the PW.  The specification\
    \ of applications and the allowed control\n   plane packets are outside the scope\
    \ of this document.  If the PW is a\n   spoke in H-VPLS, any Media Access Control\
    \ (MAC) addresses learned via\n   the PW SHOULD be flushed when it transitions\
    \ to standby state,\n   according to the procedures in RFC 4762 [3] and in [10].\n"
- title: 5.2.  Master/Slave Mode
  contents:
  - "5.2.  Master/Slave Mode\n   One endpoint node of the redundant set of PWs is\
    \ designated the\n   master and is responsible for selecting which PW both endpoints\
    \ must\n   use to forward user traffic.\n   The master indicates the forwarding\
    \ state in the PW Preferential\n   Forwarding status bit.  The other endpoint\
    \ node, the slave, MUST\n   follow the decision of the master node based on the\
    \ received status\n   bits.  In other words, the Preferential Forwarding status\
    \ bit sent by\n   the master node indicates the actual forwarding state of the\
    \ PW at\n   the master node.\n   There is a single PE master PW endpoint node\
    \ and one or many PE PW\n   endpoint slave nodes.  The assignment of master/slave\
    \ roles to the PW\n   endpoints is performed by local configuration.  Note that\
    \ the\n   behavior described in this section assumes correct configuration of\n\
    \   the master and slave endpoints.  This document does not define a\n   mechanism\
    \ to detect errors in the configuration, and misconfiguration\n   might lead to\
    \ protection switchover failing to work correctly.\n   Furthermore, this document\
    \ does not specify the procedures for a\n   backup master node.  In deployments\
    \ where PE node protection is\n   required, it is recommended to use the independent\
    \ mode of operation\n   as in the application described in Section 15.2.\n   One\
    \ endpoint of the PW, the master, actively selects which PW to\n   activate and\
    \ uses it for forwarding user traffic.  This status is\n   indicated to the slave\
    \ node by setting the Preferential Forwarding\n   status bit in the status bit\
    \ TLV to active.  It does not forward user\n   traffic to any other of the PW's\
    \ in the redundant set to the slave\n   node and indicates this by setting the\
    \ Preferential Forwarding status\n   bit in the status bit TLV to standby for\
    \ those PWs.  The master node\n   MUST ignore any PW Preferential Forwarding status\
    \ bits received from\n   the slave nodes.\n   If more than one PW qualifies for\
    \ the active state, the master PW\n   endpoint node selects one.  There is no\
    \ requirement to specify a\n   default active PW selection mechanism in this case;\
    \ however, for\n   consistency across implementations, the master PW endpoint\
    \ SHOULD\n   implement the default active PW selection mechanism described in\n\
    \   Section 5.1.\n   If the master PW endpoint implements the active PW selection\n\
    \   mechanism based on primary/secondary and precedence parameters, it\n   MUST\
    \ comply with the following behavior:\n   1. If the PW endpoint is configured\
    \ with the precedence parameter on\n      each PW in the redundant set, it MUST\
    \ select the PW with the\n      lowest configured precedence value.\n   2. If\
    \ the PW endpoint is configured with one PW as primary and one or\n      more\
    \ PWs as secondary, it MUST select the primary PW in preference\n      to all\
    \ secondary PWs.  If a primary PW is not available, it MUST\n      use the secondary\
    \ PW with the lowest precedence value.  If the\n      primary PW becomes available,\
    \ a PW endpoint MUST revert to it\n      immediately or after the expiration of\
    \ a configurable delay.\n   The slave endpoint(s) are required to act on the status\
    \ bits received\n   from the master.  When the received status bit transitions\
    \ from\n   active to standby, a slave node MUST stop forwarding over the\n   previously\
    \ active PW.  When the received status bit transitions from\n   standby to active\
    \ for a given PW, the slave node MUST start\n   forwarding user traffic over this\
    \ PW.\n   In this mode of operation, the following definition of active and\n\
    \   standby PW states apply:\n   o  Active State\n   A PW is considered to be\
    \ in active state when the PW labels are\n   exchanged between its two endpoints,\
    \ and the status bits exchanged\n   between the endpoints indicate the PW is up\
    \ at both endpoints, and\n   the Preferential Forwarding status at the master\
    \ endpoint is active.\n   In this state, user traffic can flow over the PW in\
    \ both directions.\n   o  Standby State\n   A PW is considered to be in standby\
    \ state when the PW labels are\n   exchanged between its two endpoints, and the\
    \ status bits exchanged\n   between the endpoints indicate the Preferential Forwarding\
    \ status at\n   the master endpoint is standby.  In this state, the endpoints\
    \ MUST\n   NOT forward data traffic over the PW but MAY allow PW OAM packets,\n\
    \   e.g., VCCV, to be sent and received.  The endpoints of the PW MAY\n   also\
    \ allow the forwarding of specific control plane packets of\n   applications using\
    \ the PW.  The specification of applications and the\n   allowed control plane\
    \ packets are outside the scope of this document.\n   If the PW is a spoke in\
    \ H-VPLS, any MAC addresses learned via the PW\n   SHOULD be flushed when it transitions\
    \ to standby state according to\n   the procedures in RFC 4762 [3] and [10].\n"
- title: 6.  PW State Transition Signaling Procedures
  contents:
  - "6.  PW State Transition Signaling Procedures\n   This section describes the extensions\
    \ to PW status signaling and the\n   processing rules for these extensions.  It\
    \ defines a new PW\n   Preferential Forwarding status bit that is to be used with\
    \ the PW\n   Status TLV specified in RFC 4447 [2].\n   The PW Preferential Forwarding\
    \ bit, when set, is used to signal\n   either the preferred or actual active/standby\
    \ forwarding state of the\n   PW by one PE to the far-end PE.  The actual semantics\
    \ of the value\n   being signaled vary according to whether the PW is acting in\n\
    \   master/slave or independent mode.\n"
- title: 6.1.  PW Standby Notification Procedures in Independent Mode
  contents:
  - "6.1.  PW Standby Notification Procedures in Independent Mode\n   PEs that contain\
    \ PW endpoints independently select which PW they\n   intend to use for forwarding,\
    \ depending on the specific application\n   (example applications are described\
    \ in [8]).  They advertise the\n   corresponding preferred active/standby forwarding\
    \ state for each PW.\n   An active Preferential Forwarding state is indicated\
    \ by clearing the\n   PW Preferential Forwarding status bit in the PW Status TLV.\
    \  A\n   standby Preferential Forwarding state is indicated by setting the PW\n\
    \   Preferential Forwarding status bit in the PW Status TLV.  This\n   advertisement\
    \ occurs in both the initial label mapping message and in\n   a subsequent notification\
    \ message when the forwarding state\n   transitions as a result of a state change\
    \ in the specific\n   application.\n   Each PW endpoint compares the updated local\
    \ and remote status and\n   effectively activates the PW, which is up at both\
    \ endpoints and which\n   shows both local active and remote active Preferential\
    \ Forwarding\n   states.  The PE nodes MUST implement a common mechanism to select\
    \ one\n   PW for forwarding in case multiple PWs qualify for the active state,\n\
    \   as explained in Section 5.1.\n   When a PW is in active state, the PEs can\
    \ forward user packets, OAM\n   packets, and other control plane packets over\
    \ the PW.\n   When a PW is in standby state, the PEs MUST NOT forward user packets\n\
    \   over the PW but MAY forward PW OAM packets and specific control plane\n  \
    \ packets.\n   For MS-PWs, S-PEs MUST relay the PW status notification containing\n\
    \   both the existing status bits and the new Preferential Forwarding\n   status\
    \ bits between ingress and egress PWs as per the procedures\n   defined in [4].\n"
- title: 6.2.  PW Standby Notification Procedures in Master/Slave Mode
  contents:
  - "6.2.  PW Standby Notification Procedures in Master/Slave Mode\n   Whenever the\
    \ master PW endpoint selects or deselects a PW for\n   forwarding user traffic\
    \ at its end, it explicitly notifies the event\n   to the remote slave endpoint.\
    \  The slave endpoint carries out the\n   corresponding action on receiving the\
    \ PW state change notification.\n   If the PW Preferential Forwarding bit in PW\
    \ Status TLV received by\n   the slave is set, it indicates that the PW at the\
    \ master end is not\n   used for forwarding and is thus kept in the standby state.\
    \  The PW\n   MUST NOT be used for forwarding at slave endpoint.  Clearing the\
    \ PW\n   Preferential Forwarding bit in PW Status TLV indicates that the PW at\n\
    \   the master endpoint is used for forwarding and is in active state,\n   and\
    \ the receiving slave endpoint MUST activate the PW if it was\n   previously not\
    \ used for forwarding.\n   When this mechanism is used, a common Group ID in the\
    \ PWid FEC\n   element or a PW Grouping ID TLV in the Generalized PWid FEC element,\n\
    \   as defined in [2], MAY be used to signal PWs in groups in order to\n   minimize\
    \ the number of LDP status messages that MUST be sent.  When\n   PWs are provisioned\
    \ with such grouping, a termination point sends a\n   single \"wildcard\" notification\
    \ message to denote this change in\n   status for all affected PWs.  This status\
    \ message contains either the\n   PWid FEC TLV with only the Group ID or the Generalized\
    \ PWid FEC TLV\n   with only the PW Grouping ID TLV.  As mentioned in [2], the\
    \ Group ID\n   field of the PWid FEC element, or the PW Grouping ID TLV in the\n\
    \   Generalized PWid FEC element, can be used to send status notification\n  \
    \ for an arbitrary set of PWs.\n   For MS-PWs, S-PEs MUST relay the PW status\
    \ notification containing\n   both the existing and the new Preferential Forwarding\
    \ status bits\n   between ingress and egress PW segments, as per the procedures\
    \ defined\n   in [4].\n"
- title: 6.2.1.  PW State Machine
  contents:
  - "6.2.1.  PW State Machine\n   It is convenient to describe the PW state change\
    \ behavior in terms of\n   a state machine (Table 1).  The PW state machine is\
    \ explained in\n   detail in the two defined states, and the behavior is presented\
    \ as a\n   state transition table.  The same state machine is applicable to PW\n\
    \   groups.\n      STATE         EVENT                                  NEW STATE\n\
    \      ACTIVE        PW put in standby (master)             STANDBY\n        \
    \            Action: Transmit PW Preferential\n                            Forwarding\
    \ bit set\n                    Receive PW Preferential Forwarding     STANDBY\n\
    \                       bit set   (slave)\n                    Action: Stop forwarding\
    \ over PW\n                    Receive PW Preferential Forwarding     ACTIVE\n\
    \                       bit set but bit not supported\n                    Action:\
    \ None\n                    Receive PW Preferential Forwarding     ACTIVE\n  \
    \                     bit clear\n                    Action: None.\n      STANDBY\
    \       PW activated (master)                  ACTIVE\n                    Action:\
    \ Transmit PW Preferential\n                      Forwarding bit clear\n     \
    \               Receive PW Preferential Forwarding     ACTIVE\n              \
    \         bit clear (slave)\n                    Action: Activate PW\n       \
    \             Receive PW Preferential Forwarding     STANDBY\n               \
    \        bit clear but bit not supported\n                    Action: None\n \
    \                   Receive PW Preferential Forwarding     STANDBY\n         \
    \              bit set\n                    Action: None\n        Table 1.  PW\
    \ State Transition Table in Master/Slave Mode\n"
- title: 6.3.  Coordination of PW Switchover
  contents:
  - "6.3.  Coordination of PW Switchover\n   There are PW redundancy applications\
    \ that require that PE nodes\n   coordinate the switchover to a PW such that both\
    \ endpoints will\n   forward over the same PW at any given time.  One such application\
    \ for\n   redundant MS-PW is identified in [8].  Multiple MS-PWs are configured\n\
    \   between a pair of T-PE nodes.  The paths of these MS-PWs are diverse\n   and\
    \ are switched at different S-PE nodes.  Only one of these MS-PWs\n   is active\
    \ at any given time.  The others are put in standby.  The\n   endpoints follow\
    \ the independent mode procedures to use the PW, which\n   is both up and for\
    \ which both endpoints advertise an active\n   Preferential Forwarding status\
    \ bit.\n   The trigger for sending a request to switchover by one endpoint of\n\
    \   the MS-PW can be an operational event.  For example, a failure that\n   causes\
    \ the endpoints to be unable to find a common PW for which both\n   endpoints\
    \ advertise an active Preferential Forwarding status bit.\n   The other trigger\
    \ is the execution of an administrative maintenance\n   operation by the network\
    \ operator in order to move the traffic away\n   from the nodes or links currently\
    \ used by the active PW.\n   Unlike the case of a master/slave mode of operation,\
    \ the endpoint\n   requesting the switchover requires explicit acknowledgment\
    \ from the\n   peer endpoint that the request can be honored before it switches\
    \ to\n   another PW.  Furthermore, any of the endpoints can make the request\n\
    \   to switch over.\n   This document specifies a second status bit that is used\
    \ by a PE to\n   request that its peer PE switch over to use a different active\
    \ PW.\n   This bit is referred to as the Request Switchover status bit.  The\n\
    \   Preferential Forwarding status bit continues to be used by each\n   endpoint\
    \ to indicate its current local settings of the active/standby\n   state of each\
    \ PW in the redundant set.  In other words, as in the\n   independent mode, it\
    \ indicates to the far-end which of the PWs is\n   being used to forward packets\
    \ and which is being put in standby.  It\n   can thus be used as a way for the\
    \ far-end to acknowledge the\n   requested switchover operation.\n   A PE MAY\
    \ support the Request Switchover bit.  A PE that receives the\n   Request Switchover\
    \ bit and that does not support it will ignore it.\n   If the Request Switchover\
    \ bit is supported by both sending and\n   receiving PEs, the following procedures\
    \ MUST be followed by both\n   endpoints of a PW to coordinate the switchover\
    \ of the PW.\n   S-PEs nodes MUST relay the PW status notification containing\
    \ the\n   existing status bits, as well as the new Preferential Forwarding and\n\
    \   Request Switchover status bits between ingress and egress PW segments\n  \
    \ as per the procedures defined in [4].\n"
- title: 6.3.1.  Procedures at the Requesting Endpoint
  contents:
  - "6.3.1.  Procedures at the Requesting Endpoint\n   a. The requesting endpoint\
    \ sends a Status TLV in the LDP notification\n      message with the Request Switchover\
    \ bit set on the PW to which it\n      desires to switch.\n   b. The endpoint\
    \ does not activate, forwarding on that PW at this\n      point in time.  It MAY,\
    \ however, enable receiving on that PW.\n      Thus, the Preferential Forwarding\
    \ status bit still reflects the\n      currently used PW.\n   c. The requesting\
    \ endpoint starts a timer while waiting for the\n      remote endpoint to acknowledge\
    \ the request.  This timer SHOULD be\n      configurable with a default value\
    \ of 3 seconds.\n   d. If, while waiting for the acknowledgment, the requesting\
    \ endpoint\n      receives a request from its peer to switch over to the same\
    \ or a\n      different PW, it MUST perform the following:\n         i. If its\
    \ address is higher than that of the peer, this\n            endpoint ignores\
    \ the request and continues to wait for the\n            acknowledgment from its\
    \ peer.\n        ii. If its system IP address is lower than that of its peer,\
    \ it\n            aborts the timer and immediately starts the procedures of\n\
    \            the receiving endpoint in Section 6.3.2.\n   e. If, while waiting\
    \ for the acknowledgment, the requesting endpoint\n      receives a status notification\
    \ message from its peer with the\n      Preferential Forwarding status bit cleared\
    \ in the requested PW, it\n      MUST treat this as an explicit acknowledgment\
    \ of the request and\n      MUST perform the following:\n         i. Abort the\
    \ timer.\n        ii. Activate the PW.\n       iii. Send an update status notification\
    \ message with the\n            Preferential Forwarding status bit and the Request\n\
    \            Switchover bit clear on the newly active PW and send an\n       \
    \     update status notification message with the Preferential\n            Forwarding\
    \ status bit set in the previously active PW.\n   f. If, while waiting for the\
    \ acknowledgment, the requesting endpoint\n      detects that the requested PW\
    \ went into down state locally, and\n      could use an alternate PW that is up,\
    \ it MUST perform the\n      following:\n         i. Abort the timer.\n      \
    \  ii. Issue a new request to switchover to the alternate PW.\n       iii. Restart\
    \ the timer.\n   g. If, while waiting for the acknowledgment, the requesting endpoint\n\
    \      detects that the requested PW went into the down state locally,\n     \
    \ and could not use an alternate PW that is up, it MUST perform the\n      following:\n\
    \         i. Abort the timer.\n        ii. Send an update status notification\
    \ message with the\n            Preferential Forwarding status bit unchanged and\
    \ the Request\n            Switchover bit reset for the requested PW.\n   h. If,\
    \ while waiting for the acknowledgment, the timer expires, the\n      requesting\
    \ endpoint MUST assume that the request was rejected and\n      MAY issue a new\
    \ request.\n   i. If the requesting node receives the acknowledgment after the\n\
    \      request expired, it will treat it as if the remote endpoint\n      unilaterally\
    \ switched between the PWs without issuing a request.\n      In that case, it\
    \ MAY issue a new request and follow the requesting\n      endpoint procedures\
    \ to synchronize which PW to use for the\n      transmit and receive directions\
    \ of the emulated service.\n"
- title: 6.3.2. Procedures at the Receiving Endpoint
  contents:
  - "6.3.2. Procedures at the Receiving Endpoint\n   a. Upon receiving a status notification\
    \ message with the Request\n      Switchover bit set on a PW different from the\
    \ currently active\n      one, and the requested PW is up, the receiving endpoint\
    \ MUST\n      perform the following:\n         i. Activate the PW.\n        ii.\
    \ Send an update status notification message with the\n            Preferential\
    \ Forwarding status bit clear and the Request\n            Switchover bit reset\
    \ on the newly active PW , and send an\n            update status notification\
    \ message with the Preferential\n            Forwarding status bit set in the\
    \ previously active PW.\n       iii. Upon receiving a status notification message\
    \ with the\n            Request Switchover bit set on a PW, which is different\
    \ from\n            the currently active PW but is down, the receiving endpoint\n\
    \            MUST ignore the request.\n"
- title: 7.  Status Mapping
  contents:
  - "7.  Status Mapping\n   The generation and processing of the PW Status TLV MUST\
    \ follow the\n   procedures in RFC 4447 [2].  The PW Status TLV is sent on the\
    \ active\n   PW and standby PWs to make sure the remote AC and PW states are\n\
    \   always known to the local PE node.\n   The generation and processing of PW\
    \ Status TLV by an S-PE node in a\n   MS-PW MUST follow the procedures in [4].\n\
    \   The procedures for determining and mapping PW and AC states MUST\n   follow\
    \ the rules in [5] with the following modifications.\n"
- title: 7.1.  AC Defect State Entry/Exit
  contents:
  - "7.1.  AC Defect State Entry/Exit\n   A PE enters the AC receive (or transmit)\
    \ defect state for a PW\n   service when one or more of the conditions specified\
    \ for this PW\n   service in [5] are met.\n   When a PE enters the AC receive\
    \ (or transmit) defect state for a PW,\n   it MUST send a forward (reverse) defect\
    \ indication to the remote\n   peers over all PWs in the redundant set that are\
    \ associated with this\n   AC.\n   When a PE exits the AC receive (or transmit)\
    \ defect state for a PW\n   service, it MUST clear the forward (or reverse) defect\
    \ indication to\n   the remote peers over all PWs in the redundant set that are\n\
    \   associated with this AC.\n"
- title: 7.2.  PW Defect State Entry/Exit
  contents:
  - "7.2.  PW Defect State Entry/Exit\n   A PE enters the PW receive (or transmit)\
    \ defect state for a PW\n   service when one or more of the conditions specified\
    \ in Section 8.3.1\n   (Section 8.3.2) in [5] are met for each of the PWs in the\
    \ redundant\n   set.\n   When a PE enters the PW receive (or transmit) defect\
    \ state for a PW\n   service associated with an AC, it MUST send a reverse (or\
    \ forward)\n   defect indication over one or more of the PWs in the redundant\
    \ set\n   associated with the same AC if the PW failure was detected by this PE\n\
    \   without receiving a forward defect indication from the remote PE [5].\n  \
    \ When a PE exits the PW receive (or transmit) defect state for a PW,\n   it MUST\
    \ clear the reverse (or forward) defect indication over any PW\n   in the redundant\
    \ associated with the same AC set if applicable.\n"
- title: 8.  Applicability and Backward Compatibility
  contents:
  - "8.  Applicability and Backward Compatibility\n   The mechanisms defined in this\
    \ document are to be used in\n   applications where standby state signaling of\
    \ a PW or PW group is\n   required.  Both PWid FEC and Generalized PWid FEC are\
    \ supported.  All\n   PWs that are part of a redundant set MUST use the same FEC\
    \ type.\n   When the set uses the PWid FEC element, each PW is uniquely\n   identified\
    \ by its PW ID.  When the redundant set uses the Generalized\n   PWid FEC element,\
    \ each PW MUST have a unique identifier that consists\n   of the triplet AGI::SAII::TAII.\n\
    \   A PE implementation that uses the mechanisms described in this\n   document\
    \ MUST negotiate the use of PW Status TLV between its T-LDP\n   peers, as per\
    \ RFC 4447 [2].  If the PW Status TLV is found to be not\n   supported by either\
    \ of its endpoints after status negotiation\n   procedures, then the mechanisms\
    \ specified in this document cannot be\n   used.\n   A PE implementation that\
    \ is compliant with RFC 4447 [2] and that does\n   not support the generation\
    \ or processing of the Preferential\n   Forwarding status bit or of the Request\
    \ Switchover status bit MUST\n   ignore these status bits if they are set by a\
    \ peer PE.  This document\n   in fact updates RFC 4447 by prescribing the same\
    \ behavior for any\n   status bit not originally defined in RFC 4447.\n   Finally,\
    \ this document updates RFC 4447 by defining that a status bit\n   can indicate\
    \ a status other than a fault or can indicate an\n   instruction to the peer PE.\
    \  As a result, a PE implementation\n   compliant to RFC 4447 MUST process each\
    \ status bit it supports when\n   set according to the rules specific to that\
    \ status bit.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   LDP extensions/options that protect PWs must\
    \ be implemented because\n   the status bits defined in this document have the\
    \ same security\n   considerations as the PW setup and maintenance protocol defined\
    \ in\n   RFC 4447 [2].  It should be noted that the security of a PW redundant\n\
    \   set is only as good as the weakest security on any of its members.\n"
- title: 10.  MIB Considerations
  contents:
  - "10.  MIB Considerations\n   New MIB objects for the support of PW redundancy\
    \ will be defined in a\n   separate document.\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   This document defines the following PW status codes\
    \ for the PW\n   redundancy application.  IANA has allocated these from the\n\
    \   \"Pseudowire Status Codes Registry\".\n"
- title: 11.1.  Status Code for PW Preferential Forwarding Status
  contents:
  - "11.1.  Status Code for PW Preferential Forwarding Status\n   0x00000020 When\
    \ the bit is set, it indicates PW forwarding standby\".\n              When the\
    \ bit is cleared, it indicates PW forwarding\n              active\".\n"
- title: 11.2.  Status Code for PW Request Switchover Status
  contents:
  - "11.2.  Status Code for PW Request Switchover Status\n   0x00000040 When the bit\
    \ is set, it represents Request Switchover to\n              this PW.\n      \
    \        When the bit is cleared, it represents no specific action.\n"
- title: 12.  Contributors
  contents:
  - "12.  Contributors\n   The editors would like to thank Matthew Bocci, Pranjal\
    \ Kumar Dutta,\n   Giles Heron, Marc Lasserre, Luca Martini, Thomas Nadeau, Jonathan\n\
    \   Newton, Hamid Ould-Brahim, Olen Stokes, and Daniel Cohn who made a\n   contribution\
    \ to the development of this document.\n   Matthew Bocci\n   Alcatel-Lucent\n\
    \   EMail: matthew.bocci@alcatel-lucent.com\n   Pranjal Kumar Dutta\n   Alcatel-Lucent\n\
    \   EMail: pranjal.dutta@alcatel-lucent.com\n   Giles Heron\n   Cisco Systems,\
    \ Inc.\n   giles.heron@gmail.com\n   Marc Lasserre\n   Alcatel-Lucent\n   EMail:\
    \ marc.lasserre@alcatel-lucent.com\n   Luca Martini\n   Cisco Systems, Inc.\n\
    \   EMail: lmartini@cisco.com\n   Thomas Nadeau\n   Juniper Networks\n   EMail:\
    \ tnadeau@lucidvision.com\n   Jonathan Newton\n   Cable & Wireless Worldwide\n\
    \   EMail: Jonathan.Newton@cw.com\n   Hamid Ould-Brahim\n   EMail: ouldh@yahoo.com\n\
    \   Olen Stokes\n   Extreme Networks\n   EMail: ostokes@extremenetworks.com\n\
    \   Daniel Cohn\n   Orckit\n   daniel.cohn.ietf@gmail.com.\n"
- title: 13.  Acknowledgments
  contents:
  - "13.  Acknowledgments\n   The authors would like to thank the following individuals\
    \ for their\n   valuable comments and suggestions, which improved the document\
    \ both\n   technically and editorially:\n   Vach Kompella, Kendall Harvey, Tiberiu\
    \ Grigoriu, John Rigby,\n   Prashanth Ishwar, Neil Hart, Kajal Saha, Florin Balus,\
    \ Philippe\n   Niger, Dave McDysan, Roman Krzanowski, Italo Busi, Robert Rennison,\n\
    \   and Nicolai Leymann.\n"
- title: 14.  References
  contents:
  - '14.  References

    '
- title: 14.1.  Normative References
  contents:
  - "14.1.  Normative References\n   [1]   Bradner, S., \"Key words for use in RFCs\
    \ to Indicate Requirement\n         Levels\", BCP 14, RFC 2119, March 1997.\n\
    \   [2]   Martini, L., Ed., Rosen, E., El-Aawar, N., Smith, T., and G.\n     \
    \    Heron, \"Pseudowire Setup and Maintenance Using the Label\n         Distribution\
    \ Protocol (LDP)\", RFC 4447, April 2006.\n   [3]   Lasserre, M., Ed., and V.\
    \ Kompella, Ed., \"Virtual Private LAN\n         Service (VPLS) Using Label Distribution\
    \ Protocol (LDP)\n         Signaling\", RFC 4762, January 2007.\n   [4]   Martini,\
    \ L., Metz, C., Nadeau, T., Bocci, M., and M. Aissaoui,\n         \"Segmented\
    \ Pseudowire\", RFC 6073, January 2011.\n   [5]   Aissaoui, M., Busschbach, P.,\
    \ Martini, L., Morrow, M., Nadeau,\n         T., and Y(J). Stein, \"Pseudowire\
    \ (PW) Operations,\n         Administration, and Maintenance (OAM) Message Mapping\"\
    , RFC\n         6310, July 2011.\n"
- title: 14.2.  Informative References
  contents:
  - "14.2.  Informative References\n   [6]   Bocci, M. and S. Bryant, \"An Architecture\
    \ for Multi-Segment\n         Pseudowire Emulation Edge-to-Edge\", RFC 5659, October\
    \ 2009.\n   [7]   Martini, L., \"IANA Allocations for Pseudowire Edge to Edge\n\
    \         Emulation (PWE3)\", BCP 116, RFC 4446, April 2006.\n   [8]   Muley,\
    \ P., Aissaoui, M., and M. Bocci, \"Pseudowire Redundancy\",\n         RFC 6718,\
    \ August 2012.\n   [9]   Bryant, S., Ed., and P. Pate, Ed., \"Pseudo Wire Emulation\
    \ Edge-\n         to-Edge (PWE3) Architecture\", RFC 3985, March 2005.\n   [10]\
    \  Dutta, P., Balus, F., Calvignac, G., and O. Stokes \"LDP\n         Extensions\
    \ for Optimized MAC Address Withdrawal in H-VPLS\",\n         Work in Progress,\
    \ October 2011.\n   [11]  Nadeau, T., Ed., and C. Pignataro, Ed., \"Pseudowire\
    \ Virtual\n         Circuit Connectivity Verification (VCCV): A Control Channel\
    \ for\n         Pseudowires\", RFC 5085, December 2007.\n"
- title: Appendix A.  Applications of PW Redundancy Procedures
  contents:
  - "Appendix A.  Applications of PW Redundancy Procedures\n   This section shows\
    \ how the mechanisms described in this document are\n   used to achieve the desired\
    \ protection behavior for some of the\n   applications described in \"PW Redundancy\"\
    \ [8].\n"
- title: A.1.  One Multi-Homed CE with Single SS-PW Redundancy
  contents:
  - "A.1.  One Multi-Homed CE with Single SS-PW Redundancy\n   The following figure\
    \ illustrates an application of SS-PW redundancy.\n         |<-------------- Emulated\
    \ Service ---------------->|\n         |                                     \
    \             |\n         |          |<------- Pseudowire  ------>|          |\n\
    \         |          |                            |          |\n         |   \
    \       |    |<-- PSN Tunnels-->|    |          |\n         |          V    V\
    \                  V    V          |\n         V    AC    +----+             \
    \     +----+     AC   V\n   +-----+    |     | PE1|==================|    |  \
    \   |    +-----+\n   |     |----------|....|...PW1.(active)...|....|----------|\
    \     |\n   |     |          |    |==================|    |          | CE2 |\n\
    \   | CE1 |          +----+                  |PE2 |          |     |\n   |   \
    \  |          +----+                  |    |          +-----+\n   |     |    \
    \      |    |==================|    |\n   |     |----------|....|...PW2.(standby)..|\
    \    |\n   +-----+    |     | PE3|==================|    |\n              AC \
    \   +----+                  +----+\n          Figure 2.  Multi-Homed CE with SS-PW\
    \ Redundancy\n   The application in Figure 2 makes use of the independent mode\
    \ of\n   operation.\n   CE1 is dual-homed to PE1 and to PE3 by attachment circuits.\
    \  The\n   method for dual-homing of CE1 to PE1 and to PE3 nodes and the\n   protocols\
    \ used are outside the scope of this document (see [8]).\n   In this example,\
    \ the AC from CE1 to PE1 is active, while the AC from\n   CE1 to PE3 is standby,\
    \ as determined by the redundancy protocol\n   running on the ACs.  Thus, in normal\
    \ operation, PE1 and PE3 will\n   advertise an active and standby Preferential\
    \ Forwarding status bit,\n   respectively, to PE2, reflecting the forwarding state\
    \ of the two ACs\n   to CE1 as determined by the AC dual-homing protocol.  PE2\
    \ advertises\n   a Preferential Forwarding status bit of active on both PW1 and\
    \ PW2,\n   since the AC to CE2 is single-homed.  As both the local and remote\n\
    \   UP/DOWN status and Preferential Forwarding status for PW1 are up and\n   active,\
    \ traffic is forwarded over PW1 in both directions.\n   On failure of the AC between\
    \ CE1 and PE1, the forwarding state of the\n   AC on PE3 transitions to active.\
    \  PE3 then announces the newly\n   changed Preferential Forwarding status bit\
    \ of active to PE2.  PE1\n   will advertise a PW status notification message,\
    \ indicating that the\n   AC between CE1 and PE1 is down.  PE2 matches the local\
    \ and remote\n   Preferential Forwarding status of active and status of \"Pseudowire\n\
    \   forwarding\" and selects PW2 as the new active PW to which to send\n   traffic.\n\
    \   On failure of the PE1 node, PE3 will detect it and will transition\n   the\
    \ forwarding state of its AC to active.  The method by which PE3\n   detects that\
    \ PE1 is down is outside the scope of this document.  PE3\n   then announces the\
    \ newly changed Preferential Forwarding status bit\n   of active to PE2.  PE3\
    \ and PE2 match the local and remote\n   Preferential Forwarding status of active\
    \ and UP/DOWN status\n   \"Pseudowire forwarding\" and select PW2 as the new active\
    \ PW to which\n   to send traffic.  Note that PE2 may have detected that the PW\
    \ to PE1\n   went down via T-LDP Hello timeout or via other means.  However, it\n\
    \   will not be able to forward user traffic until it receives the\n   updated\
    \ status bit from PE3.\n   Note that, in this example, the receipt of the AC status\
    \ on the\n   CE1-PE1 link is normally sufficient for PE2 to switch to PW2.\n \
    \  However, the operator may want to trigger the switchover of the PW\n   for\
    \ administrative reasons, e.g., maintenance; thus, the use of the\n   Preferential\
    \ Forwarding status bit is required to notify PE2 to\n   trigger the switchover.\n\
    \   Note that the primary/secondary procedures do not apply in this case\n   as\
    \ the PW Preferential Forwarding status is driven by the AC\n   forwarding state,\
    \ as determined by the AC dual-homing protocol used.\n"
- title: A.2.  Multiple Multi-Homed CEs with SS-PW Redundancy
  contents:
  - "A.2.  Multiple Multi-Homed CEs with SS-PW Redundancy\n             |<--------------\
    \ Emulated Service ---------------->|\n             |                        \
    \                          |\n             |          |<------- Pseudowire  ------>|\
    \          |\n             |          |                            |         \
    \ |\n             |          |    |<-- PSN Tunnels-->|    |          |\n     \
    \        |          V    V    (not shown)   V    V          |\n             V\
    \    AC    +----+                  +----+     AC   V\n       +-----+    |    \
    \ |....|.......PW1........|....|     |    +-----+\n       |     |----------| PE1|......\
    \   .........| PE3|----------|     |\n       | CE1 |          +----+      \\ /\
    \  PW3    +----+          | CE2 |\n       |     |          +----+       X    \
    \      +----+          |     |\n       |     |          |    |....../ \\..PW4....|\
    \    |          |     |\n       |     |----------| PE2|                  | PE4|---------\
    \ |     |\n       +-----+    |     |....|.....PW2..........|....|     |    +-----+\n\
    \                  AC    +----+                  +----+    AC\n            Figure\
    \ 3. Multiple Multi-Homed CEs with SS-PW Redundancy\n   The application in Figure\
    \ 3 makes use of the independent mode of\n   operation.\n   CE1 is dual-homed\
    \ to PE1 and PE2.  CE2 is dual-homed to PE3 and PE4.\n   The method for dual-homing\
    \ and the used protocols are outside the\n   scope of this document.  Note that\
    \ the PSN tunnels are not shown in\n   this figure for clarity.  However, it can\
    \ be assumed that each of the\n   PWs shown is encapsulated in a separate PSN\
    \ tunnel.\n   Assume that the AC from CE1 to PE1 is active and from CE1 to PE2\
    \ it\n   is standby; furthermore, assume that the AC from CE2 to PE3 is\n   standby\
    \ and from CE2 to PE4 it is active.  The method of deriving the\n   active/standby\
    \ status of the AC is outside the scope of this\n   document.\n   PE1 advertises\
    \ the Preferential Forwarding status active and UP/DOWN\n   status \"Pseudowire\
    \ forwarding\" for pseudowires PW1 and PW4 connected\n   to PE3 and PE4.  This\
    \ status reflects the forwarding state of the AC\n   attached to PE1.  PE2 advertises\
    \ Preferential Forwarding status\n   standby and UP/DOWN status \"Pseudowire forwarding\"\
    \ for pseudowires\n   PW2 and PW3 to PE3 and PE4.  PE3 advertises Preferential\
    \ Forwarding\n   status standby and UP/DOWN status \"Pseudowire forwarding\" for\n\
    \   pseudowires PW1 and PW3 to PE1 and PE2.  PE4 advertises the\n   Preferential\
    \ Forwarding status active and UP/DOWN status \"Pseudowire\n   forwarding\" for\
    \ pseudowires PW2 and PW4 to PE2 and PE1, respectively.\n   Thus, by matching\
    \ the local and remote Preferential Forwarding status\n   of active and UP/DOWN\
    \ status of\n   \"Pseudowire forwarding\" of pseudowires, the PE nodes determine\
    \ which\n   PW should be in the active state.  In this case, it is PW4 that will\n\
    \   be selected.\n   On failure of the AC between CE1 and PE1, the forwarding\
    \ state of the\n   AC on PE2 is changed to active.  PE2 then announces the newly\
    \ changed\n   Preferential Forwarding status bit of active to PE3 and PE4.  PE1\n\
    \   will advertise a PW status notification message, indicating that the\n   AC\
    \ between CE1 and PE1 is down.  PE2 and PE4 match the local and\n   remote Preferential\
    \ Forwarding status of active and UP/DOWN status\n   \"Pseudowire forwarding\"\
    \ and select PW2 as the new active PW to which\n   to send traffic.\n   On failure\
    \ of the PE1 node, PE2 will detect the failure and will\n   transition the forwarding\
    \ state of its AC to active.  The method by\n   which PE2 detects that PE1 is\
    \ down is outside the scope of this\n   document.  PE2 then announces the newly\
    \ changed Preferential\n   Forwarding status bit of active to PE3 and PE4.  PE2\
    \ and PE4 match\n   the local and remote Preferential Forwarding status of active\
    \ and\n   UP/DOWN status \"Pseudowire forwarding\" and select PW2 as the new\n\
    \   active PW to which to send traffic.  Note that PE3 and PE4 may have\n   detected\
    \ that the PW to PE1 went down via T-LDP Hello timeout or via\n   other means.\
    \  However, they will not be able to forward user traffic\n   until they have\
    \ received the updated status bit from PE2.\n   Because each dual-homing algorithm\
    \ running on the two node sets,\n   i.e., {CE1, PE1, PE2} and {CE2, PE3, PE4},\
    \ selects the active AC\n   independently, there is a need to signal the active\
    \ status of the AC\n   such that the PE nodes can select a common active PW for\
    \ end-to-end\n   forwarding between CE1 and CE2 as per the procedures in the\n\
    \   independent mode.\n   Note that no primary/secondary procedures, as defined\
    \ in Sections 5.1\n   and 5.2, apply in this use case as the active/standby status\
    \ is\n   driven by the AC forwarding state, as determined by the AC dual-\n  \
    \ homing protocol used.\n"
- title: A.3.  Multi-Homed CE with MS-PW Redundancy
  contents:
  - "A.3.  Multi-Homed CE with MS-PW Redundancy\n   The following figure illustrates\
    \ an application of MS-PW redundancy.\n       Native   |<-----------Pseudowire\
    \ ------------->| Native\n       Service  |                                  \
    \   | Service\n        (AC)    |     |<-PSN1-->|     |<-PSN2-->|     |  (AC)\n\
    \          |     V     V         V     V         V     V   |\n          |    \
    \ +-----+         +-----+         +-----+   |\n   +----+ |     |T-PE1|=========|S-PE1|=========|T-PE2|\
    \   |   +----+\n   |    |-------|......PW1-Seg1.......|PW1-Seg2.......|-------|\
    \    |\n   |    |       |     |=========|     |=========|     |       |    |\n\
    \   | CE1|       +-----+         +-----+         +-----+       |    |\n   |  \
    \  |         |.|           +-----+         +-----+       | CE2|\n   |    |   \
    \      |.|===========|     |=========|     |       |    |\n   |    |         |.....PW2-Seg1......|.PW2-Seg2......|-------|\
    \    |\n   +----+         |=============|S-PE2|=========|T-PE4|   |   +----+\n\
    \                                +-----+         +-----+   AC\n              Figure\
    \ 4.  Multi-Homed CE with MS-PW Redundancy\n   The application in Figure 4 makes\
    \ use of the independent mode of\n   operation.  It extends the application described\
    \ in Section 15.1.\n   15.1 of this document and in [8] by adding a pair of S-PE\
    \ nodes to\n   switch the segments of PW1 and PW2.\n   CE2 is dual-homed to T-PE2\
    \ and T-PE4.  PW1 and PW2 are used to extend\n   the resilient connectivity all\
    \ the way to T-PE1.  PW1 has two\n   segments and is an active pseudowire, while\
    \ PW2 has two segments and\n   is a standby pseudowire.  This application requires\
    \ support for MS-PW\n   with segments of the same type as described in [4].\n\
    \   The operation in this case is the same as in the case of SS-PW, as\n   described\
    \ in Section 15.1.  The only difference is that the S-PE\n   nodes need to relay\
    \ the PW status notification containing both the\n   UP/DOWN and forwarding status\
    \ to the T-PE nodes.\n"
- title: A.4.  Multi-Homed CE with MS-PW Redundancy and S-PE Protection
  contents:
  - "A.4.  Multi-Homed CE with MS-PW Redundancy and S-PE Protection\n   The following\
    \ figure illustrates an application of MS-PW redundancy\n   with 1:1 PW protection.\n\
    \       Native   |<-----------Pseudowire ------------->|  Native\n       Service\
    \  |                                     |  Service\n        (AC)    |     |<-PSN1-->|\
    \     |<-PSN2-->|     |   (AC)\n          |     V     V         V     V      \
    \   V     V    |\n          |                     +-----+                    |\n\
    \          |       |=============|     |=============|      |\n          |   \
    \    |.....PW3-Seg1......|.PW3-Seg2....|      |\n          |       |.|===========|S-PE3|===========|.|\
    \      |\n          |       |.|           +-----+           |.|      |\n     \
    \     |     +-----+         +-----+         +-----+    |\n   +----+ |     |T-PE1|=========|S-PE1|=========|T-PE2|\
    \    |  +----+\n   |    |-------|......PW1-Seg1.......|PW1-Seg2.......|-------|\
    \    |\n   |    |       |     |=========|     |=========|     |       |    |\n\
    \   | CE1|       +-----+         +-----+         +-----+       |    |\n   |  \
    \  |       |.| |.|         +-----+         +-----+       | CE2|\n   |    |   \
    \    |.| |.|=========|     |=========|     |       |    |\n   |    |       |.|\
    \ |...PW2-Seg1......|.PW2-Seg2......|-------|    |\n   +----+       |.| |===========|S-PE2|=========|T-PE4|\
    \    |  +----+\n                |.|             +-----+         +-----+    AC\n\
    \                |.|             +-----+           |.|\n                |.|=============|\
    \     |===========|.|\n                |.......PW4-Seg1......|.PW4-Seg2....|\n\
    \                |===============|S-PE4|=============|\n                     \
    \           +-----+\n      Figure 5.  Multi-Homed CE with MS-PW Redundancy and\
    \ Protection\n   The application in Figure 5 makes use of the independent mode\
    \ of\n   operation.\n   CE2 is dual-homed to T-PE2 and T-PE4.  The PW pairs {PW1,PW3}\
    \ and\n   {PW2,PW4} are used to extend the resilient connectivity all the way\n\
    \   to T-PE1, like in the case in Section 15.3, with the addition that\n   this\
    \ setup provides for S-PE node protection.\n   CE1 is connected to T-PE1 while\
    \ CE2 is dual-homed to T-PE2 and T-PE4.\n   There are four segmented PWs.  PW1\
    \ and PW2 are primary PWs and are\n   used to support CE2 multi-homing.  PW3 and\
    \ PW4 are secondary PWs and\n   are used to support 1:1 PW protection.  PW1, PW2,\
    \ PW3, and PW4 have\n   two segments and they are switched at S-PE1, S-PE2, S-PE3,\
    \ and S-PE4,\n   respectively.\n   It is possible that S-PE1 coincides with S-PE4\
    \ and/or SP-2 coincides\n   with S-PE3, in particular, where the two PSN domains\
    \ are\n   interconnected via two nodes.  However, Figure 5 shows four separate\n\
    \   S-PE nodes for clarity.\n   The behavior of this setup is exactly the same\
    \ as the setup in\n   Section 15.3 except that T-PE1 will always see a pair of\
    \ PWs eligible\n   for the active state, for example, the pair {PW1,PW3} when\
    \ the AC\n   between CE2 and T-PE2 is in active state.  Thus, it is important\
    \ that\n   both T-PE1 and T-PE2 implement a common mechanism to choose one the\n\
    \   two PWs for forwarding, as explained in Section 5.1.  Similarly,\n   T-PE1\
    \ and T-PE4 must use the same mechanism to select among the pair\n   {PW2,PW4}\
    \ when the AC between CE2 and T-PE4 is in active state.\n"
- title: A.5.  Single-Homed CE with MS-PW Redundancy
  contents:
  - "A.5.  Single-Homed CE with MS-PW Redundancy\n   The following is an application\
    \ of the independent mode of operation,\n   along with the request switchover\
    \ procedures in order to provide N:1\n   PW protection.  A revertive behavior\
    \ to a primary PW is shown as an\n   example of configuring and using the primary/secondary\
    \ procedures\n   described in Sections 5.1. and 5.2.\n       Native   |<------------Pseudowire\
    \ ------------>|  Native\n       Service  |                                  \
    \   |  Service\n        (AC)    |     |<-PSN1-->|     |<-PSN2-->|     |  (AC)\n\
    \          |     V     V         V     V         V     V   |\n          |    \
    \ +-----+         +-----+         +-----+   |\n   +----+ |     |T-PE1|=========|S-PE1|=========|T-PE2|\
    \   |   +----+\n   |    |-------|......PW1-Seg1.......|.PW1-Seg2......|-------|\
    \    |\n   | CE1|       |     |=========|     |=========|     |       | CE2|\n\
    \   |    |       +-----+         +-----+         +-----+       |    |\n   +----+\
    \        |.||.|                          |.||.|       +----+\n               \
    \  |.||.|         +-----+          |.||.|\n                 |.||.|=========| \
    \    |========== .||.|\n                 |.||...PW2-Seg1......|.PW2-Seg2...||.|\n\
    \                 |.| ===========|S-PE2|============ |.|\n                 |.|\
    \            +-----+             |.|\n                 |.|============+-----+=============\
    \ .|\n                 |.....PW3-Seg1.|     | PW3-Seg2......|\n              \
    \    ==============|S-PE3|===============\n                                | \
    \    |\n                                +-----+\n             Figure 6.  Single-Homed\
    \ CE with MS-PW Redundancy\n   CE1 is connected to PE1 in provider edge 1 and\
    \ CE2 to PE2 in provider\n   edge 2, respectively.  There are three segmented\
    \ PWs:  a primary PW,\n   PW1, is switched at S-PE1 and has the lowest precedence\
    \ value of\n   zero; a secondary PW, PW2, which is switched at S-PE2 and has a\n\
    \   precedence of 1; and another secondary PW, PW3, which is switched at\n   S-PE3\
    \ and has a precedence of 2.\n   The precedence is locally configured at the endpoints\
    \ of the PW,\n   i.e., T-PE1 and T-PE2.  The lower the precedence value, the higher\n\
    \   the priority.\n   T-PE1 and T-PE2 will select the PW they intend to activate\
    \ based on\n   their local and remote UP/DOWN state, as well as the local precedence\n\
    \   configuration.  In this case, they will both advertise Preferential\n   Forwarding\
    \ status bit of active on PW1 and of standby on PW2 and PW3\n   using priority\
    \ derived from local precedence configuration.  Assuming\n   all PWs are up, T-PE1\
    \ and T-PE2 will use PW1 to forward user packets.\n   If PW1 fails, then the T-PE\
    \ detecting the failure will send a status\n   notification to the remote T-PE\
    \ with a Local PSN-facing PW (ingress)\n   Receive Fault bit set, a Local PSN-facing\
    \ PW (egress) Transmit Fault\n   bit set, or a Pseudowire Not Forwarding bit set.\
    \  In addition, it\n   will set the Preferential Forwarding status bit on PW1\
    \ to standby.\n   It will also advertise the Preferential Forwarding status bit\
    \ on PW2\n   as active, as it has the next-lowest precedence value.  T-PE2 will\n\
    \   also perform the same steps as soon as it is informed of the failure\n   of\
    \ PW1.  Both T-PE nodes will perform a match on the Preferential\n   Forwarding\
    \ status of active and UP/DOWN status of \"Pseudowire\n   forwarding\" and will\
    \ use PW2 to forward user packets.\n   However, this does not guarantee that the\
    \ T-PEs will choose the same\n   PW from the redundant set to forward on, for\
    \ a given emulated\n   service, at all times.  This may be due to a mismatch of\
    \ the\n   configuration of the PW precedence in each T-PE.  This may also be\n\
    \   due to a failure that caused the endpoints to not be able to match\n   the\
    \ active Preferential Forwarding status bit and UP/DOWN status\n   bits.  In this\
    \ case, T-PE1 and/or T-PE2 can invoke the request\n   switchover/acknowledgment\
    \ procedures to synchronize the choice of PW\n   to forward on in both directions.\n\
    \   The trigger for sending a request to switch over can also be the\n   execution\
    \ of an administrative maintenance operation by the network\n   operator in order\
    \ to move the traffic away from the T-PE/S-PE\n   nodes/links to be serviced.\n\
    \   In case the Request Switchover is sent by both endpoints\n   simultaneously,\
    \ both T-PEs send status notification with the newly\n   selected PW with Request\
    \ Switchover bit set, waiting for a response\n   from the other endpoint.  In\
    \ such a situation, the T-PE with greater\n   system address request is given\
    \ precedence.  This helps in\n   synchronizing PWs in the event of mismatch of\
    \ precedence\n   configuration as well.\n   On recovery of the primary PW, PW1\
    \ is selected to forward traffic and\n   the secondary PW, PW2, is set to standby.\n"
- title: A.6.  PW Redundancy between H-VPLS MTU-s and PE-rs
  contents:
  - "A.6.  PW Redundancy between H-VPLS MTU-s and PE-rs\n   The following figure illustrates\
    \ the application of use of PW\n   redundancy in H-VPLS for the purpose of dual-homing\
    \ an MTU-s node to\n   PE nodes using PW spokes.  This application makes use of\
    \ the\n   master/slave mode of operation.\n                                  \
    \     PE1-rs\n                                     +--------+\n              \
    \                       |  VSI   |\n                     Active PW       |   --\
    \   |\n                      Group..........|../  \\..|.\n     CE-1          \
    \       .          |  \\  /  | .\n      \\                  .           |   --\
    \   |  .\n       \\                .            +--------+   .\n        \\   MTU-s\
    \      .                  .        .     PE3-rs\n         +--------+   .     \
    \              .         . +--------+\n         |   VSI  |  .                \
    \    .  H-VPlS  .|  VSI   |\n         |   -- ..|..                     .   Core\
    \    |.. --   |\n         |  /  \\  |                       .    PWs    |  / \
    \ \\  |\n         |  \\  /..|..                     .           |  \\  /  |\n\
    \         |   --   |  .                    .          .|.. --   |\n         +--------+\
    \   .                   .         . +--------+\n        /              .     \
    \             .        .\n       /                .            +--------+   .\n\
    \      /                  .           |  VSI   |  .\n     CE-2               \
    \  .          |   --   | .\n                           ..........|../  \\..|.\n\
    \                     Standby PW      |  \\  /  |\n                      Group\
    \          |   --   |\n                                     +--------+\n     \
    \                                 PE2-rs\n          A.6.  Multi-Homed MTU-s in\
    \ H-VPLS Core\n   MTU-s is dual-homed to PE1-rs and PE2-rs.  The primary spoke\
    \ PWs from\n   MTU-s are connected to PE1-rs, while the secondary PWs are connected\n\
    \   to PE2.  PE1-rs and PE2-rs are connected to H-VPLS core on the other\n   side\
    \ of the network.  MTU-s communicates to PE1-rs and PE2-rs the\n   forwarding\
    \ status of its member PWs for a set of Virtual Switch\n   Instances (VSIs) having\
    \ common status active/standby.  It may be\n   signaled using PW grouping with\
    \ a common group-id in the PWid FEC\n   element or Grouping TLV in the Generalized\
    \ PWid FEC element, as\n   defined in [2] to scale better.  MTU-s derives the\
    \ status of the PWs\n   based on local policy configuration.  In this example,\
    \ the\n   primary/secondary procedures as defined in Section 5.2 are used, but\n\
    \   this can be based on any other policy.\n   Whenever MTU-s performs a switchover,\
    \ it sends a wildcard\n   notification message to PE2-rs for the previously standby\
    \ PW group\n   containing PW Status TLV with PW Preferential Forwarding bit cleared.\n\
    \   On receiving the notification, PE-2rs unblocks all member PWs\n   identified\
    \ by the PW group and the state of the PW group changes from\n   standby to active.\
    \  All procedures described in Section 6.2 are\n   applicable.\n   The use of\
    \ the Preferential Forwarding status bit in master/slave\n   mode is similar to\
    \ Topology Change Notification in the IEEE Ethernet\n   Bridges controlled by\
    \ Rapid Spanning Tree Protocol (RSTP) but is\n   restricted over a single hop.\
    \  When these procedures are implemented,\n   PE-rs devices are aware of switchovers\
    \ at MTU-s and could generate\n   MAC Withdraw messages to trigger MAC flushing\
    \ within the H-VPLS full\n   mesh.  By default, MTU-s devices should still trigger\
    \ MAC Withdraw\n   messages, as currently defined in [3], to prevent two copies\
    \ of MAC\n   Withdraws being sent: one by MTU-s and another one by PE-rs nodes.\n\
    \   Mechanisms to disable a MAC Withdraw trigger in certain devices is\n   out\
    \ of the scope of this document.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Praveen Muley\n   Alcatel-lucent\n   701 E. Middlefield\
    \ Road\n   Mountain View, CA, 94043, USA\n   EMail: praveen.muley@alcatel-lucent.com\n\
    \   Mustapha Aissaoui\n   Alcatel-lucent\n   600 March Rd\n   Kanata, ON, Canada\
    \ K2K 2E6\n   EMail: mustapha.aissaoui@alcatel-lucent.com\n"
