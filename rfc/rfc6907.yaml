- title: __initial_text__
  contents:
  - "                     Use Cases and Interpretations\n          of Resource Public\
    \ Key Infrastructure (RPKI) Objects\n                    for Issuers and Relying\
    \ Parties\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes a number of use cases together with\n  \
    \ directions and interpretations for organizations and relying parties\n   when\
    \ creating or encountering Resource Public Key Infrastructure\n   (RPKI) object\
    \ scenarios in the public RPKI.  All of these items are\n   discussed here in\
    \ relation to the Internet routing system.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6907.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2013 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. Terminology ................................................4\n  \
    \    1.2. Documentation Prefixes .....................................4\n    \
    \  1.3. Definitions ................................................4\n   2. Overview\
    \ ........................................................6\n      2.1. General\
    \ Interpretation of RPKI Object Semantics ............6\n   3. Origination Use\
    \ Cases ...........................................7\n      3.1. Single Announcement\
    \ ........................................8\n      3.2. Aggregate with a More\
    \ Specific .............................8\n      3.3. Aggregate with a More Specific\
    \ from a Different ASN ........9\n      3.4. Sub-Allocation to a Multi-Homed Customer\
    \ ...................9\n      3.5. Restriction of a New Allocation ...........................10\n\
    \      3.6. Restriction of New ASN ....................................11\n  \
    \    3.7. Restriction of a Part of an Allocation ....................11\n    \
    \  3.8. Restriction of Prefix Length ..............................12\n      3.9.\
    \ Restriction of Sub-Allocation Prefix Length ...............13\n      3.10. Aggregation\
    \ and Origination by an Upstream Provider ......15\n      3.11. Rogue Aggregation\
    \ and Origination by an Upstream\n            Provider .................................................16\n\
    \   4. Adjacency or Path Validation Use Cases .........................17\n  \
    \ 5. Partial Deployment Use Cases ...................................18\n    \
    \  5.1. Parent Does Not Participate in RPKI .......................18\n      5.2.\
    \ Only Some Children Participate in RPKI ....................18\n      5.3. Grandchild\
    \ Does Not Participate in RPKI ...................19\n   6. Transfer Use Cases\
    \ .............................................20\n      6.1. Transfer of In-Use\
    \ Prefix and Autonomous System Number ....20\n      6.2. Transfer of In-Use Prefix\
    \ .................................21\n      6.3. Transfer of Unused Prefix .................................22\n\
    \   7. Relying Party Use Cases ........................................22\n  \
    \    7.1. Prefix-Origin Validation Use Cases ........................22\n    \
    \       7.1.1. Covering ROA Prefix, maxLength Satisfied,\n                  and\
    \ AS Match .......................................23\n           7.1.2. Covering\
    \ ROA Prefix, maxLength Exceeded,\n                  and AS Match .......................................23\n\
    \           7.1.3. Covering ROA Prefix, maxLength Satisfied,\n               \
    \   and AS Mismatch ....................................23\n           7.1.4.\
    \ Covering ROA Prefix, maxLength Exceeded,\n                  and AS Mismatch\
    \ ....................................24\n           7.1.5. Covering ROA Prefix\
    \ Not Found ......................24\n           7.1.6. Covering ROA Prefix and\
    \ the ROA Is an AS 0 ROA .....24\n           7.1.7. Covering ROA Prefix Not Found\
    \ but ROAs\n                  Exist for a Covering Set of More Specifics .........25\n\
    \           7.1.8. AS_SET in Route and Covering ROA Prefix Not Found ..25\n  \
    \         7.1.9. Singleton AS in AS_SET (in the Route),\n                  Covering\
    \ ROA Prefix, and AS Match ..................26\n           7.1.10. Singleton\
    \ AS in AS_SET (in the Route),\n                   Covering ROA Prefix, and AS\
    \ Mismatch ..............26\n           7.1.11. Multiple ASs in AS_SET (in the\
    \ Route) and\n                   Covering ROA Prefix ...............................26\n\
    \           7.1.12. Multiple ASs in AS_SET (in the Route) and\n              \
    \     ROAs Exist for a Covering Set of More Specifics ...27\n      7.2. ROA Expiry\
    \ or Receipt of a CRL Revoking a ROA .............27\n           7.2.1. ROA of\
    \ Parent Prefix Is Revoked ....................27\n           7.2.2. ROA of Prefix\
    \ Revoked while Parent Prefix\n                  Has Covering ROA Prefix with\
    \ Different ASN .........28\n           7.2.3. ROA of Prefix Revoked while That\
    \ of Parent\n                  Prefix Prevails ....................................28\n\
    \           7.2.4. ROA of Grandparent Prefix Revoked while\n                 \
    \ That of Parent Prefix Prevails .....................28\n           7.2.5. Expiry\
    \ of ROA of Parent Prefix .....................29\n           7.2.6. Expiry of\
    \ ROA of Prefix while Parent Prefix\n                  Has Covering ROA with Different\
    \ ASN ................29\n           7.2.7. Expiry of ROA of Prefix while That\
    \ of\n                  Parent Prefix Prevails .............................29\n\
    \           7.2.8. Expiry of ROA of Grandparent Prefix while\n               \
    \   That of Parent Prefix Prevails .....................29\n   8. Acknowledgements\
    \ ...............................................30\n   9. Security Considerations\
    \ ........................................30\n   10. References ....................................................30\n\
    \      10.1. Normative References .....................................30\n  \
    \    10.2. Informative References ...................................30\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document describes a number of use cases together with\n\
    \   directions and interpretations for organizations and relying parties\n   when\
    \ creating or encountering Resource Public Key Infrastructure\n   (RPKI) object\
    \ scenarios in the public RPKI.  All of these items are\n   discussed here in\
    \ relation to the Internet routing system.\n"
- title: 1.1.  Terminology
  contents:
  - "1.1.  Terminology\n   It is assumed that the reader is familiar with the terms\
    \ and concepts\n   described in \"Internet X.509 Public Key Infrastructure Certificate\n\
    \   and Certificate Revocation List (CRL) Profile\" [RFC5280], \"A Profile\n \
    \  for X.509 PKIX Resource Certificates\" [RFC6487], \"X.509 Extensions\n   for\
    \ IP Addresses and AS Identifiers\" [RFC3779], \"A Profile for Route\n   Origin\
    \ Authorizations (ROAs)\" [RFC6482], \"Validation of Route\n   Origination Using\
    \ the Resource Certificate Public Key Infrastructure\n   (PKI) and Route Origin\
    \ Authorizations (ROAs)\" [RFC6483], and \"BGP\n   Prefix Origin Validation\"\
    \ [RFC6811].\n"
- title: 1.2.  Documentation Prefixes
  contents:
  - "1.2.  Documentation Prefixes\n   The documentation prefixes recommended in [RFC5737]\
    \ are insufficient\n   for use as example prefixes in this document.  Therefore,\
    \ this\n   document uses RFC 1918 [RFC1918] address space for constructing\n \
    \  example prefixes.\n"
- title: 1.3.  Definitions
  contents:
  - "1.3.  Definitions\n   For all of the use cases in this document, it is assumed\
    \ that RPKI\n   objects (e.g., resource certificates, ROAs) validate in accordance\n\
    \   with [RFC6487] and [RFC6480].  In other words, we assume that\n   corrupted\
    \ RPKI objects, if any, have been detected and eliminated.\n   The following definitions\
    \ are in use in this document.  Some of these\n   definitions are reused or adapted\
    \ from [RFC6811] with authors'\n   permission.\n   Resource:  An IP address prefix\
    \ (simply called prefix or subnet) or\n      an Autonomous System Number (ASN).\n\
    \   Allocation:  A set of resources provided to an entity or organization\n  \
    \    for its use.\n   Sub-allocation:  A set of resources subordinate to an allocation\n\
    \      assigned to another entity or organization.\n   Prefix:  A prefix consists\
    \ of a pair (IP address, prefix length),\n      interpreted as is customary (see\
    \ [RFC4632]).\n   Route:  Data derived from a received BGP update, as defined\
    \ in\n      [RFC4271], Section 1.1.  The route includes one prefix and an\n  \
    \    AS_PATH, among other things.\n   ROA:  Route Origin Authorization (ROA) is\
    \ an RPKI object signed by a\n      prefix holder authorizing origination of said\
    \ prefix from an\n      origin AS specified in said ROA.\n   AS 0 ROA:  A ROA\
    \ with ASN value 0 (zero) in the AS ID field.  AS 0\n      ROA is an attestation\
    \ by a prefix holder that the prefix described\n      in the ROA, and any more\
    \ specific prefix, should not be used in a\n      routing context [RFC6483].\n\
    \   ROA prefix:  The prefix from a ROA.\n   ROA ASN:  The origin ASN from a ROA.\n\
    \   maxLength:  The maximum length up to which more specific prefixes of\n   \
    \   a ROA prefix may be originated from the corresponding ROA ASN.\n      The\
    \ maxLength is specified in the ROA.\n   Route prefix:  A prefix derived from\
    \ a route.\n   Route origin ASN:  The origin AS number derived from a route. \
    \ The\n      origin AS number is:\n      o  the rightmost AS in the final segment\
    \ of the AS_PATH attribute\n         in the route if that segment is of type AS_SEQUENCE,\
    \ or\n      o  the BGP speaker's own AS number if that segment is of type\n  \
    \       AS_CONFED_SEQUENCE or AS_CONFED_SET or if the AS_PATH is empty,\n    \
    \     or\n      o  the distinguished value \"NONE\" if the final segment of the\n\
    \         AS_PATH attribute is of any other type.\n   Covering ROA prefix:  A\
    \ ROA prefix that is an exact match or a less\n      specific when compared to\
    \ the route prefix under consideration.\n      In other words, the route prefix\
    \ is said to have a covering ROA\n      prefix when there exists a ROA such that\
    \ the ROA prefix length is\n      less than or equal to the route prefix length\
    \ and the ROA prefix\n      address matches the route prefix address for all bits\
    \ specified by\n      the ROA prefix length.\n   Covering ROA:  If a ROA contains\
    \ a covering ROA prefix for a route\n      prefix under consideration, then the\
    \ ROA is said to be a covering\n      ROA for the route prefix.\n   No covering\
    \ ROA:  No covering ROA exists for a route prefix under\n      consideration.\n\
    \   No other covering ROA:  No other covering ROA exists (besides what is\n  \
    \    (are) already cited) for a route prefix under consideration.\n   Multi-homed\
    \ prefix or subnet:  A prefix (i.e., subnet) for which a\n      route is originated\
    \ through two or more autonomous systems.\n   Matched:  A route's {prefix, origin\
    \ AS} pair is said to be matched by\n      a ROA when the route prefix has a covering\
    \ ROA, and in addition,\n      the route prefix length is less than or equal to\
    \ the maxLength in\n      said covering ROA and the route origin ASN is equal\
    \ to the ASN in\n      said covering ROA.\n   Given these definitions, any given\
    \ BGP route will be found to have\n   one of the following \"validation states\"\
    :\n   o  NotFound: The route prefix has no covering ROA.\n   o  Valid: The route's\
    \ {prefix, origin AS} pair is matched by at least\n      one ROA.\n   o  Invalid:\
    \ The route prefix has at least one covering ROA and the\n      route's {prefix,\
    \ origin AS} pair is not matched by any ROA.\n   It is to be noted that no ROA\
    \ can have the value \"NONE\" as its ROA\n   ASN.  Thus, a route whose origin\
    \ ASN is \"NONE\" cannot be matched by\n   any ROA.  Similarly, no valid route\
    \ can have an origin ASN of zero\n   [AS0-PROC].  Thus, no route can be matched\
    \ by a ROA whose ASN is zero\n   (i.e., an AS 0 ROA) [RFC6483].\n"
- title: 2.  Overview
  contents:
  - '2.  Overview

    '
- title: 2.1.  General Interpretation of RPKI Object Semantics
  contents:
  - "2.1.  General Interpretation of RPKI Object Semantics\n   In the interpretation\
    \ of relying parties (RPs), or relying party\n   routing software, it is important\
    \ that a 'make before break'\n   operational policy be applied.  In part, this\
    \ means that an RP should\n   implement a routing decision process where a route\
    \ is assumed to be\n   intended (i.e., considered unsuspicious) unless proven\
    \ otherwise by\n   the existence of a valid RPKI object that explicitly invalidates\
    \ the\n   route (see Section 7.1 for examples).  Also, especially in cases when\n\
    \   a prefix is newly acquired by allocation/sub-allocation or due to\n   prefix-ownership\
    \ transfer, a ROA should be registered in RPKI prior\n   to advertisement of the\
    \ prefix in BGP.  This is highly recommended\n   for the following reasons.  Observe\
    \ that in the transfer case\n   (considering a prefix transfer from Org A to Org\
    \ B), even though Org\n   A's resource cert would be revoked before issuing a\
    \ resource cert to\n   Org B, there may be some latency before all relying parties\
    \ discard\n   the previously received ROA of Org A for that prefix.  The latency\n\
    \   may be due to CRL propagation delay in the RPKI system or due to\n   periodic\
    \ polling by RPs, etc.  Also, observe that in the\n   sub-allocation case (from\
    \ parent Org A to child Org B), there may be\n   an existing ROA registered by\
    \ Org A (with their own origin ASN) for a\n   covering aggregate prefix relative\
    \ to the prefix in consideration.\n   If the new prefix owner (Org B) has not\
    \ already registered their own\n   ROA (i.e., ROA with their origin ASN), then\
    \ the presence of a\n   different covering ROA (i.e., one with a different origin\
    \ ASN)\n   belonging to Org A would result in invalid assessment for the route\n\
    \   advertised by the new owner (Org B).  Thus, in both cases (transfer\n   or\
    \ sub-allocation), it is prudent for the new owner (Org B) to ensure\n   that\
    \ its route for the prefix will be valid by proactively issuing a\n   ROA before\
    \ advertising the route.  The ROA should be issued with\n   sufficient lead time\
    \ taking into consideration the RPKI propagation\n   delays.\n   As stated earlier\
    \ in Section 1.3, for all of the use cases in this\n   document, it is assumed\
    \ that RPKI objects (e.g., resource\n   certificates, ROAs) validate in accordance\
    \ with [RFC6487] and\n   [RFC6480].  In other words, we assume that corrupted\
    \ RPKI objects, if\n   any, have been detected and eliminated.\n   While many\
    \ of the examples provided here illustrate organizations\n   using their own autonomous\
    \ system numbers to originate routes, it\n   should be recognized that a prefix\
    \ holder need not necessarily be the\n   holder of the autonomous system number\
    \ used for the route\n   origination.\n"
- title: 3.  Origination Use Cases
  contents:
  - "3.  Origination Use Cases\n   This section deals with the various use cases where\
    \ an organization\n   has Internet resources and will announce routes to the Internet.\n\
    \   It is based on operational observations of the existing routing\n   system.\
    \  In the following use cases, the phrase \"relying parties\n   interpret the\
    \ route as intended\" is generally meant to indicate that\n   \"relying parties\
    \ interpret an announced route as having a valid\n   origination AS\".\n"
- title: 3.1.  Single Announcement
  contents:
  - "3.1.  Single Announcement\n   An organization (Org A with ASN 64496) has been\
    \ allocated the prefix\n   10.1.2.0/24.  It wishes to announce the /24 prefix\
    \ from ASN 64496\n   such that relying parties interpret the route as intended.\n\
    \   The desired announcement (and organization) would be:\n      +----------------------------------------------+\n\
    \      | Prefix          | Origin AS   | Organization |\n      +----------------------------------------------+\n\
    \      | 10.1.2.0/24     | AS 64496    |   Org A      |\n      +----------------------------------------------+\n\
    \   The issuing party should create a ROA containing the following:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.2.0/24       |    24         |\n      +----------------------------------------------+\n"
- title: 3.2.  Aggregate with a More Specific
  contents:
  - "3.2.  Aggregate with a More Specific\n   An organization (Org A with ASN 64496)\
    \ has been allocated the prefix\n   10.1.0.0/16.  It wishes to announce the more\
    \ specific prefix\n   10.1.0.0/20 from ASN 64496 as well as the aggregate route\
    \ such that\n   relying parties interpret the routes as intended.\n   The desired\
    \ announcements (and organization) would be:\n      +----------------------------------------------+\n\
    \      | Prefix          | Origin AS   | Organization |\n      +----------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |   Org A      |\n      | 10.1.0.0/20 \
    \    | AS 64496    |   Org A      |\n      +----------------------------------------------+\n\
    \   The issuing party should create a ROA containing the following:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      |          |-----------------------------------+\n\
    \      |          | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n"
- title: 3.3.  Aggregate with a More Specific from a Different ASN
  contents:
  - "3.3.  Aggregate with a More Specific from a Different ASN\n   An organization\
    \ (Org A with ASN 64496 and ASN 64511) has been\n   allocated the prefix 10.1.0.0/16.\
    \  It wishes to announce the more\n   specific prefix 10.1.0.0/20 from ASN 64511\
    \ as well as the aggregate\n   route from ASN 64496 such that relying parties\
    \ interpret the routes\n   as intended.\n   The desired announcements (and organization)\
    \ would be:\n      +---------------------------------------------+\n      | Prefix\
    \          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |  Org A      |\n      | 10.1.0.0/20  \
    \   | AS 64511    |  Org A      |\n      +---------------------------------------------+\n\
    \   The issuing party should create ROAs containing the following:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n\
    \      +----------------------------------------------+\n      | asID     | address\
    \           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n"
- title: 3.4.  Sub-Allocation to a Multi-Homed Customer
  contents:
  - "3.4.  Sub-Allocation to a Multi-Homed Customer\n   An organization (Org A with\
    \ ASN 64496) has been allocated the prefix\n   10.1.0.0/16; it wishes to announce\
    \ the more specific prefix\n   10.1.0.0/20 from ASN 64496.  It has further delegated\
    \ 10.1.16.0/20 to\n   a customer (Org B with ASN 64511) who is multi-homed and\
    \ will\n   originate the prefix route from ASN 64511.  ASN 64496 will also\n \
    \  announce the aggregate route such that relying parties interpret the\n   routes\
    \ as intended.\n   The desired announcements (and organizations) would be:\n \
    \     +---------------------------------------------+\n      | Prefix        \
    \  | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |  Org A      |\n      | 10.1.0.0/20  \
    \   | AS 64496    |  Org A      |\n      | 10.1.16.0/20    | AS 64511    |  Org\
    \ B      |\n      +---------------------------------------------+\n   The issuing\
    \ party should create ROAs containing the following:\n      Org A:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      |          |-----------------------------------+\n\
    \      |          | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n\
    \      Org B:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.16.0/20      |    20         |\n      +----------------------------------------------+\n"
- title: 3.5.  Restriction of a New Allocation
  contents:
  - "3.5.  Restriction of a New Allocation\n   An organization has recently been allocated\
    \ the prefix 10.1.0.0/16.\n   Its network deployment is not yet ready to announce\
    \ the prefix and\n   wishes to restrict all possible announcements of 10.1.0.0/16\
    \ and more\n   specifics in routing using RPKI.\n   The following announcements\
    \ would be considered undesirable:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/16     | ANY AS      |  ANY        |\n      | 10.1.0.0/20  \
    \   | ANY AS      |  ANY        |\n      | 10.1.17.0/24    | ANY AS      |  ANY\
    \        |\n      +---------------------------------------------+\n   The issuing\
    \ party should create a ROA containing the following:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      |    0     | 10.1.0.0/16       |    32         |\n      +----------------------------------------------+\n\
    \   This is known as an AS 0 ROA [RFC6483].  Also, please see the\n   definition\
    \ and related comments in Section 1.3.\n"
- title: 3.6.  Restriction of New ASN
  contents:
  - "3.6.  Restriction of New ASN\n   An organization has recently been allocated\
    \ an additional ASN 64511.\n   Its network deployment is not yet ready to use\
    \ this ASN and wishes to\n   restrict all possible uses of ASN 64511 using RPKI.\n\
    \   The following announcement would be considered undesirable:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | ANY             | AS 64511    |  ANY        |\n      +---------------------------------------------+\n\
    \   It is currently not possible to restrict use of autonomous system\n   numbers.\n"
- title: 3.7.  Restriction of a Part of an Allocation
  contents:
  - "3.7.  Restriction of a Part of an Allocation\n   An organization (Org A with\
    \ ASN 64496) has been allocated the prefix\n   10.1.0.0/16.  Its network topology\
    \ permits the announcement of\n   10.1.0.0/17.  Org A wishes to restrict any possible\
    \ announcement of\n   10.1.128.0/17 or more specifics of that /17 using RPKI.\n\
    \   The desired announcement (and organization) would be:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/17     | AS 64496    |  Org A      |\n      +---------------------------------------------+\n\
    \   The following announcements would be considered undesirable:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.128.0/17   | ANY AS      |  ANY        |\n      | 10.1.128.0/24\
    \   | ANY AS      |  ANY        |\n      +---------------------------------------------+\n\
    \   The issuing party should create ROAs containing the following:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/17       |    17         |\n      +----------------------------------------------+\n\
    \      +----------------------------------------------+\n      | asID     | address\
    \           | maxLength     |\n      +----------------------------------------------+\n\
    \      |    0     | 10.1.128.0/17     |    32         |\n      +----------------------------------------------+\n"
- title: 3.8.  Restriction of Prefix Length
  contents:
  - "3.8.  Restriction of Prefix Length\n   An organization (Org A with ASN 64496)\
    \ has been allocated the prefix\n   10.1.0.0/16; it wishes to announce the aggregate\
    \ and any or all more\n   specific prefixes up to and including a maximum length\
    \ of /20, but\n   never any more specific than a /20.\n   Examples of the desired\
    \ announcements (and organization) would be:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |  Org A      |\n      | 10.1.0.0/17  \
    \   | AS 64496    |  Org A      |\n      |     ...         | AS 64496    |  Org\
    \ A      |\n      | 10.1.128.0/20   | AS 64496    |  Org A      |\n      +---------------------------------------------+\n\
    \   The following announcements would be considered undesirable:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/21     | ANY AS      |  ANY        |\n      | 10.1.0.0/22  \
    \   | ANY AS      |  ANY        |\n      |     ...         | ANY AS      |  ANY\
    \        |\n      | 10.1.128.0/24   | ANY AS      |  ANY        |\n      +---------------------------------------------+\n\
    \   The issuing party should create a ROA containing the following:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    20         |\n      +----------------------------------------------+\n"
- title: 3.9.  Restriction of Sub-Allocation Prefix Length
  contents:
  - "3.9.  Restriction of Sub-Allocation Prefix Length\n   An organization (Org A\
    \ with ASN 64496) has been allocated the prefix\n   10.1.0.0/16.  It sub-allocates\
    \ several /20 prefixes to its multi-\n   homed customers: Org B with ASN 64501\
    \ and Org C with ASN 64499,\n   respectively.  It wishes to restrict those customers\
    \ from advertising\n   any corresponding routes more specific than a /22.\n  \
    \ The desired announcements (and organizations) would be:\n      +---------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |  Org A      |\n      | 10.1.0.0/20  \
    \   | AS 64501    |  Org B      |\n      | 10.1.128.0/20   | AS 64499    |  Org\
    \ C      |\n      | 10.1.4.0/22     | AS 64501    |  Org B      |\n      +---------------------------------------------+\n\
    \   The following example announcements (and organizations) would be\n   considered\
    \ undesirable:\n      +---------------------------------------------+\n      |\
    \ Prefix          | Origin AS   |Organization |\n      +---------------------------------------------+\n\
    \      | 10.1.0.0/24     | AS 64501    |  Org B      |\n      | 10.1.128.0/24\
    \   | AS 64499    |  Org C      |\n      |  .....          | ...         | ...\
    \         |\n      | 10.1.0.0/23     | ANY AS      |  ANY        |\n      +---------------------------------------------+\n\
    \   The issuing party (Org A) should create ROAs containing the\n   following:\n\
    \      For Org A:\n      +----------------------------------------------+\n  \
    \    | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n\
    \      For Org B:\n      +----------------------------------------------+\n  \
    \    | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64501    | 10.1.0.0/20       |    22         |\n      +----------------------------------------------+\n\
    \      For Org C:\n      +----------------------------------------------+\n  \
    \    | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64499    | 10.1.128.0/20     |    22         |\n      +----------------------------------------------+\n"
- title: 3.10.  Aggregation and Origination by an Upstream Provider
  contents:
  - "3.10.  Aggregation and Origination by an Upstream Provider\n   Consider four\
    \ organizations with the following resources, which were\n   acquired independently\
    \ from any transit provider.\n      +-------------------------------------------------+\n\
    \      | Organization     | ASN      |    Prefix         |\n      +-------------------------------------------------+\n\
    \      | Org A            | AS 64496 |  10.1.0.0/24      |\n      | Org B    \
    \        | AS 64505 |  10.1.3.0/24      |\n      | Org C            | AS 64499\
    \ |  10.1.1.0/24      |\n      | Org D            | AS 64511 |  10.1.2.0/24  \
    \    |\n      +-------------------------------------------------+\n   These organizations\
    \ share a common upstream provider Transit X\n   (ASN 64497) that originates an\
    \ aggregate of these prefixes with the\n   permission of all four organizations.\n\
    \   The desired announcements (and organizations) would be:\n      +----------------------------------------------+\n\
    \      | Prefix          | Origin AS   | Organization |\n      +----------------------------------------------+\n\
    \      | 10.1.0.0/24     | AS 64496    |   Org A      |\n      | 10.1.3.0/24 \
    \    | AS 64505    |   Org B      |\n      | 10.1.1.0/24     | AS 64499    | \
    \  Org C      |\n      | 10.1.2.0/24     | AS 64511    |   Org D      |\n    \
    \  | 10.1.0.0/22     | AS 64497    |   Transit X  |\n      +----------------------------------------------+\n\
    \   It is currently not possible for an upstream provider to make a valid\n  \
    \ aggregate announcement of independent prefixes.  However, the issuing\n   parties\
    \ should create ROAs containing the following:\n      Org A:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/24       |    24         |\n      +----------------------------------------------+\n\
    \      Org B:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64505    | 10.1.3.0/24       |    24         |\n      +----------------------------------------------+\n\
    \      Org C:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64499    | 10.1.1.0/24       |    24         |\n      +----------------------------------------------+\n\
    \      Org D:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.2.0/24       |    24         |\n      +----------------------------------------------+\n"
- title: 3.11.  Rogue Aggregation and Origination by an Upstream Provider
  contents:
  - "3.11.  Rogue Aggregation and Origination by an Upstream Provider\n   Consider\
    \ four organizations with the following resources that were\n   acquired independently\
    \ from any transit provider.\n      +-------------------------------------------------+\n\
    \      | Organization     | ASN      |    Prefix         |\n      +-------------------------------------------------+\n\
    \      | Org A            | AS 64496 |  10.1.0.0/24      |\n      | Org B    \
    \        | AS 64503 |  10.1.3.0/24      |\n      | Org C            | AS 64499\
    \ |  10.1.1.0/24      |\n      | Org D            | AS 64511 |  10.1.2.0/24  \
    \    |\n      +-------------------------------------------------+\n   These organizations\
    \ share a common upstream provider Transit X\n   (ASN 64497) that originates an\
    \ aggregate of these prefixes where\n   possible.  In this situation, Org B (ASN\
    \ 64503, 10.1.3.0/24) does not\n   wish for its prefix to be aggregated by the\
    \ upstream provider.\n   The desired announcements (and organizations) would be:\n\
    \      +----------------------------------------------+\n      | Prefix      \
    \    | Origin AS   | Organization |\n      +----------------------------------------------+\n\
    \      | 10.1.0.0/24     | AS 64496    |   Org A      |\n      | 10.1.3.0/24 \
    \    | AS 64503    |   Org B      |\n      | 10.1.1.0/24     | AS 64499    | \
    \  Org C      |\n      | 10.1.2.0/24     | AS 64511    |   Org D      |\n    \
    \  | 10.1.0.0/23     | AS 64497    |   Transit X  |\n      +----------------------------------------------+\n\
    \   The following announcement would be considered undesirable:\n      +----------------------------------------------+\n\
    \      | Prefix          | Origin AS   | Organization |\n      +----------------------------------------------+\n\
    \      | 10.1.0.0/22     | AS 64497    |   Transit X  |\n      +----------------------------------------------+\n\
    \   It is currently not possible for an upstream provider to make a valid\n  \
    \ aggregate announcement of independent prefixes.  However, the issuing\n   parties\
    \ should create ROAs containing the following:\n      Org A:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/24       |    24         |\n      +----------------------------------------------+\n\
    \      Org B:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64503    | 10.1.3.0/24       |    24         |\n      +----------------------------------------------+\n\
    \      Org C:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64499    | 10.1.1.0/24       |    24         |\n      +----------------------------------------------+\n\
    \      Org D:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.2.0/24       |    24         |\n      +----------------------------------------------+\n"
- title: 4.  Adjacency or Path Validation Use Cases
  contents:
  - "4.  Adjacency or Path Validation Use Cases\n   Use cases pertaining to adjacency\
    \ or path validation are beyond the\n   scope of this document and would be addressed\
    \ in a separate document.\n"
- title: 5.  Partial Deployment Use Cases
  contents:
  - '5.  Partial Deployment Use Cases

    '
- title: 5.1.  Parent Does Not Participate in RPKI
  contents:
  - "5.1.  Parent Does Not Participate in RPKI\n   An organization (Org A with ASN\
    \ 64511) is multi-homed and has been\n   assigned the prefix 10.1.0.0/20 from\
    \ its upstream (Transit X with\n   ASN 64496).  Org A wishes to announce the prefix\
    \ 10.1.0.0/20 from\n   ASN 64511 to its other upstream(s).  Org A also wishes\
    \ to create RPKI\n   statements about the resource; however, Transit X (ASN 64496),\
    \ which\n   announces the aggregate 10.1.0.0/16, has not yet adopted RPKI.\n \
    \  The desired announcements (and organization with RPKI adoption)\n   would be:\n\
    \      +----------------------------------------------------+\n      | Prefix\
    \          | Origin AS   |Organization | RPKI |\n      +----------------------------------------------------+\n\
    \      | 10.1.0.0/20     | AS 64511    |  Org A      | Yes  |\n      | 10.1.0.0/16\
    \     | AS 64496    |  Transit X  | No   |\n      +----------------------------------------------------+\n\
    \   RPKI is strictly hierarchical; therefore, if Transit X does not\n   participate\
    \ in RPKI, Org A is unable to validly issue RPKI objects.\n"
- title: 5.2.  Only Some Children Participate in RPKI
  contents:
  - "5.2.  Only Some Children Participate in RPKI\n   An organization (Org A with\
    \ ASN 64496) has been allocated the prefix\n   10.1.0.0/16 and participates in\
    \ RPKI; it wishes to announce the more\n   specific prefix 10.1.0.0/20 from ASN\
    \ 64496.  It has further delegated\n   10.1.16.0/20 and 10.1.32.0/20 to customers\
    \ Org B with ASN 64511 and\n   Org C with ASN 64502 (respectively), who are multi-homed.\
    \  Org B\n   (ASN 64511) does not participate in RPKI.  Org C (ASN 64502)\n  \
    \ participates in RPKI.\n   The desired announcements (and organizations with\
    \ RPKI adoption)\n   would be:\n      +----------------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization | RPKI |\n      +----------------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |  Org A      | Yes  |\n      | 10.1.0.0/20\
    \     | AS 64496    |  Org A      | Yes  |\n      | 10.1.16.0/20    | AS 64511\
    \    |  Org B      | No   |\n      | 10.1.32.0/20    | AS 64502    |  Org C  \
    \    | Yes  |\n      +----------------------------------------------------+\n\
    \   The issuing parties should create ROAs containing the following:\n      Org\
    \ A:\n      +----------------------------------------------+\n      | asID   \
    \  | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n\
    \      |          | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n\
    \      Org A issues for Org B:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.16.0/20      |    20         |\n      +----------------------------------------------+\n\
    \      Org C:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64502    | 10.1.32.0/20      |    20         |\n      +----------------------------------------------+\n"
- title: 5.3.  Grandchild Does Not Participate in RPKI
  contents:
  - "5.3.  Grandchild Does Not Participate in RPKI\n   Consider the previous example,\
    \ with an extension by which Org B, who\n   does not participate in RPKI, further\
    \ allocates 10.1.17.0/24 to Org X\n   with ASN 64505.  Org X does not participate\
    \ in RPKI.\n   The desired announcements (and organizations with RPKI adoption)\n\
    \   would be:\n      +----------------------------------------------------+\n\
    \      | Prefix          | Origin AS   |Organization | RPKI |\n      +----------------------------------------------------+\n\
    \      | 10.1.0.0/16     | AS 64496    |  Org A      | Yes  |\n      | 10.1.0.0/20\
    \     | AS 64496    |  Org A      | Yes  |\n      | 10.1.16.0/20    | AS 64511\
    \    |  Org B      | No   |\n      | 10.1.32.0/20    | AS 64502    |  Org C  \
    \    | Yes  |\n      | 10.1.17.0/24    | AS 64505    |  Org X      | No   |\n\
    \      +----------------------------------------------------+\n   The issuing\
    \ parties should create ROAs containing the following:\n      Org A:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n\
    \      |          | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n\
    \      Org A issues for Org B:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.16.0/20      |    20         |\n      +----------------------------------------------+\n\
    \      Org A issues for Org B's customer Org X:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64505    | 10.1.17.0/24      |    24         |\n      +----------------------------------------------+\n\
    \      Org C:\n      +----------------------------------------------+\n      |\
    \ asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64502    | 10.1.32.0/20      |    20         |\n      +----------------------------------------------+\n"
- title: 6.  Transfer Use Cases
  contents:
  - "6.  Transfer Use Cases\n   For transfer use cases, based on the preceding sections,\
    \ it should be\n   easy to deduce what new ROAs need to be created and what existing\n\
    \   ROAs need to be maintained (or revoked).  The resource transfer and\n   timing\
    \ of revocation/creation of the ROAs need to be performed based\n   on the make-before-break\
    \ principle and using suitable Regional\n   Internet Registry (RIR) procedures\
    \ (see Section 2.1).\n"
- title: 6.1.  Transfer of In-Use Prefix and Autonomous System Number
  contents:
  - "6.1.  Transfer of In-Use Prefix and Autonomous System Number\n   Org A holds\
    \ the resource 10.1.0.0/20, and it is currently in use and\n   originated from\
    \ AS 64496 with valid RPKI objects in place.  Org B has\n   acquired both the\
    \ prefix and ASN and desires an RPKI transfer on a\n   particular date and time\
    \ without adversely affecting the operational\n   use of the resource.\n   The\
    \ following RPKI objects would be created/revoked:\n      For Org A, revoke the\
    \ following ROA:\n      +----------------------------------------------+\n   \
    \   | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n\
    \      For Org B, add the following ROA:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/20       |    20         |\n      +----------------------------------------------+\n"
- title: 6.2.  Transfer of In-Use Prefix
  contents:
  - "6.2.  Transfer of In-Use Prefix\n   Org A holds the resource 10.1.0.0/16, and\
    \ it is currently in use and\n   originated from AS 64496 with valid RPKI objects\
    \ in place.  Org A has\n   agreed to transfer the entire /16 address block to\
    \ Org B and will no\n   longer originate the prefix or more specifics of it. \
    \ Consequently,\n   Org B desires an RPKI transfer of this resource on a particular\
    \ date\n   and time.  This prefix will be originated by AS 64511 as a result of\n\
    \   this transfer.\n   The following RPKI objects would be created/revoked:\n\
    \      For Org A, revoke the following ROA:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n\
    \      For Org B, add the following ROA when the\n      resource certificate for\
    \ 10.1.0.0/16 is issued\n      to them (Org B):\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64511    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n"
- title: 6.3.  Transfer of Unused Prefix
  contents:
  - "6.3.  Transfer of Unused Prefix\n   Org A holds the resources 10.1.0.0/16 and\
    \ AS 64507 (with RPKI\n   objects).  Org A currently announces 10.1.0.0/16 from\
    \ AS 64507.\n   Org B has acquired an unused portion (10.1.4.0/24) of the prefix\
    \ from\n   Org A and desires an RPKI transfer on a particular date and time.\n\
    \   Org B will originate a route 10.1.4.0/24 from AS 64496.\n   The following\
    \ RPKI objects would be created/sustained:\n      For Org A, leave the following\
    \ ROA unchanged:\n      +----------------------------------------------+\n   \
    \   | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64507    | 10.1.0.0/16       |    16         |\n      +----------------------------------------------+\n\
    \      For Org B, add the following ROA when the\n      resource certificate for\
    \ 10.1.4.0/24 is issued\n      to them (Org B):\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.4.0/24       |    24         |\n      +----------------------------------------------+\n\
    \   Org A may optionally provide ROA coverage for Org B by creating the\n   following\
    \ ROA preceding the RPKI transfer.  The ROA itself is then\n   naturally revoked\
    \ when 10.1.4.0/24 is transferred to Org B's resource\n   certificate.\n     \
    \ Org A adds the following ROA:\n      +----------------------------------------------+\n\
    \      | asID     | address           | maxLength     |\n      +----------------------------------------------+\n\
    \      | 64496    | 10.1.4.0/24       |    24         |\n      +----------------------------------------------+\n"
- title: 7.  Relying Party Use Cases
  contents:
  - '7.  Relying Party Use Cases

    '
- title: 7.1.  Prefix-Origin Validation Use Cases
  contents:
  - "7.1.  Prefix-Origin Validation Use Cases\n   These use cases try to systematically\
    \ enumerate the situations a\n   relying party may encounter while receiving a\
    \ BGP update and making\n   use of ROA information to interpret the validity of\
    \ the prefix-origin\n   information in the routes derived from the update.  We\
    \ enumerate the\n   situations or scenarios and include a recommendation for the\
    \ expected\n   outcome of prefix-origin validation.  For a description of prefix-\n\
    \   origin validation algorithms, see [RFC6483] and [RFC6811].  We use\n   the\
    \ terms Valid, Invalid, and NotFound as defined in [RFC6811] and\n   summarized\
    \ earlier in Section 1.3.  Also see [RFC6472] for a\n   recommendation to deprecate\
    \ AS_SETs in BGP updates.  The use cases\n   described here can be potentially\
    \ used as test cases for testing and\n   evaluation of prefix-origin validation\
    \ in router implementations;\n   see, for example, [BRITE].\n"
- title: 7.1.1.  Covering ROA Prefix, maxLength Satisfied, and AS Match
  contents:
  - "7.1.1.  Covering ROA Prefix, maxLength Satisfied, and AS Match\n   ROA: {10.1.0.0/16,\
    \ maxLength = 20, AS 64496}\n   Route has {10.1.0.0/17, Origin = AS 64496}\n \
    \  Recommended RPKI prefix-origin validation interpretation:  Route is\n     \
    \ Valid.\n   Comment:  The route prefix has a covering ROA prefix, and the route\n\
    \      origin ASN matches the ROA ASN.  This is a straightforward prefix-\n  \
    \    origin validation use case; it follows from the primary intention\n     \
    \ of creation of the ROA by a prefix holder.\n"
- title: 7.1.2.  Covering ROA Prefix, maxLength Exceeded, and AS Match
  contents:
  - "7.1.2.  Covering ROA Prefix, maxLength Exceeded, and AS Match\n   ROA: {10.1.0.0/16,\
    \ maxLength = 20, AS 64496}\n   Route has {10.1.0.0/22, Origin = AS 64496}\n \
    \  No other covering ROA\n   Recommended RPKI prefix-origin validation interpretation:\
    \  Route is\n      Invalid.\n   Comment:  In this case, the maxLength specified\
    \ in the ROA is\n      exceeded by the route prefix.\n"
- title: 7.1.3.  Covering ROA Prefix, maxLength Satisfied, and AS Mismatch
  contents:
  - "7.1.3.  Covering ROA Prefix, maxLength Satisfied, and AS Mismatch\n   ROA: {10.1.0.0/16,\
    \ maxLength = 24, AS 64496}\n   Route has {10.1.88.0/24, Origin = AS 64511}\n\
    \   No other covering ROA\n   Recommended RPKI prefix-origin validation interpretation:\
    \  Route is\n      Invalid.\n   Comment:  In this case, an AS other than the one\
    \ specified in the ROA\n      is originating the route.  This may be a prefix\
    \ or subprefix\n      hijack situation.\n"
- title: 7.1.4.  Covering ROA Prefix, maxLength Exceeded, and AS Mismatch
  contents:
  - "7.1.4.  Covering ROA Prefix, maxLength Exceeded, and AS Mismatch\n   ROA: {10.1.0.0/16,\
    \ maxLength = 22, AS 64496}\n   Route has {10.1.88.0/24, Origin = AS 64511}\n\
    \   No other covering ROA\n   Recommended RPKI prefix-origin validation interpretation:\
    \  Route is\n      Invalid.\n   Comment:  In this case, the maxLength specified\
    \ in the ROA is\n      exceeded by the route prefix, and also an AS other than\
    \ the one\n      specified in the ROA is originating the route.  This may be a\n\
    \      subprefix hijack situation.\n"
- title: 7.1.5.  Covering ROA Prefix Not Found
  contents:
  - "7.1.5.  Covering ROA Prefix Not Found\n   Route has {10.1.3.0/24, Origin = AS\
    \ 64511}\n   No covering ROA\n   Recommended RPKI prefix-origin validation interpretation:\
    \  Route's\n      validation status is NotFound.\n   Comment:  In this case, there\
    \ is no covering ROA for the route\n      prefix.  It could be a prefix or subprefix\
    \ hijack situation, but\n      this announcement does not contradict any existing\
    \ ROA.  During\n      partial deployment, there would be some legitimate prefix-origin\n\
    \      announcements for which ROAs may not have been issued yet.\n"
- title: 7.1.6.  Covering ROA Prefix and the ROA Is an AS 0 ROA
  contents:
  - "7.1.6.  Covering ROA Prefix and the ROA Is an AS 0 ROA\n   ROA: {10.1.0.0/16,\
    \ maxLength = 32, AS 0}\n   Route has {10.1.5.0/24, Origin = AS 64511}\n   Recommended\
    \ RPKI prefix-origin validation interpretation:  Route's\n      validation status\
    \ is Invalid.\n   Comment:  An AS 0 ROA implies by definition that the prefix\
    \ listed in\n      it and all of the more specifics of that prefix should not\
    \ be used\n      in a routing context [RFC6483] [AS0-PROC].  Also, please see\n\
    \      related comments in Section 1.3.\n"
- title: 7.1.7.  Covering ROA Prefix Not Found but ROAs Exist for a Covering Set
  contents:
  - "7.1.7.  Covering ROA Prefix Not Found but ROAs Exist for a Covering Set\n   \
    \     of More Specifics\n   ROA: {10.1.0.0/18, maxLength = 20, AS 64496}\n   ROA:\
    \ {10.1.64.0/18, maxLength = 20, AS 64496}\n   ROA: {10.1.128.0/18, maxLength\
    \ = 20, AS 64496}\n   ROA: {10.1.192.0/18, maxLength = 20, AS 64496}\n   Route\
    \ has {10.1.0.0/16, Origin = AS 64496}\n   No covering ROA\n   Recommended RPKI\
    \ prefix-origin validation interpretation:  Route's\n      validation status is\
    \ NotFound.\n   Comment:  In this case, the route prefix is an aggregate (/16),\
    \ and\n      it turns out that there exist ROAs for more specifics (/18s) that,\n\
    \      if combined, can help support validation of the announced prefix-\n   \
    \   origin pair.  But it is very hard in general to break up an\n      announced\
    \ prefix into constituent more specifics and check for ROA\n      coverage for\
    \ those more specifics, and hence this type of\n      accommodation is not recommended.\n"
- title: 7.1.8.  AS_SET in Route and Covering ROA Prefix Not Found
  contents:
  - "7.1.8.  AS_SET in Route and Covering ROA Prefix Not Found\n   Route has {10.1.0.0/16,\
    \ AS_SET [AS 64496, AS 64497, AS 64498,\n   AS 64499] appears in the rightmost\
    \ position in the AS_PATH}\n   No covering ROA\n   Recommended RPKI prefix-origin\
    \ validation interpretation:  Route's\n      validation status is NotFound.\n\
    \   Comment:  An extremely small percentage (~0.1%) of external BGP\n      (eBGP)\
    \ updates are seen to have an AS_SET in them; this is known\n      as proxy aggregation.\
    \  In this case, the route with the AS_SET\n      does not conflict with any ROA\
    \ (i.e., the route prefix has no\n      covering ROA prefix).  Therefore, the\
    \ route gets NotFound\n      validation status.\n"
- title: 7.1.9.  Singleton AS in AS_SET (in the Route), Covering ROA Prefix, and
  contents:
  - "7.1.9.  Singleton AS in AS_SET (in the Route), Covering ROA Prefix, and\n   \
    \     AS Match\n   Route has {10.1.0.0/24, AS_SET [AS 64496] appears in the rightmost\n\
    \   position in the AS_PATH}\n   ROA: {10.1.0.0/22, maxLength = 24, AS 64496}\n\
    \   Recommended RPKI prefix-origin validation interpretation:  Route is\n    \
    \  Invalid.\n   Comment:  In the spirit of [RFC6472], any route with an AS_SET\
    \ in it\n      should not be considered valid (by ROA-based validation).  If the\n\
    \      route contains an AS_SET and a covering ROA prefix exists for the\n   \
    \   route prefix, then the route should get an Invalid status.\n      (Note: AS\
    \ match or mismatch consideration does not apply.)\n"
- title: 7.1.10.  Singleton AS in AS_SET (in the Route), Covering ROA Prefix, and
  contents:
  - "7.1.10.  Singleton AS in AS_SET (in the Route), Covering ROA Prefix, and\n  \
    \       AS Mismatch\n   Route has {10.1.0.0/24, AS_SET [AS 64496] appears in the\
    \ rightmost\n   position in the AS_PATH}\n   ROA: {10.1.0.0/22, maxLength = 24,\
    \ AS 64511}\n   Recommended RPKI prefix-origin validation interpretation:  Route\
    \ is\n      Invalid.\n   Comment:  If the route contains an AS_SET and a covering\
    \ ROA prefix\n      exists for the route prefix, then the route should get an\
    \ Invalid\n      status.  (Note: AS match or mismatch consideration does not\n\
    \      apply.)\n"
- title: 7.1.11.  Multiple ASs in AS_SET (in the Route) and Covering ROA Prefix
  contents:
  - "7.1.11.  Multiple ASs in AS_SET (in the Route) and Covering ROA Prefix\n   Route\
    \ has {10.1.0.0/22, AS_SET [AS 64496, AS 64497, AS 64498,\n   AS 64499] appears\
    \ in the rightmost position in the AS_PATH}\n   ROA: {10.1.0.0/22, maxLength =\
    \ 24, AS 64509}\n   No other covering ROA\n   Recommended RPKI prefix-origin validation\
    \ interpretation:  Route is\n      Invalid.\n   Comment:  If the route contains\
    \ an AS_SET and a covering ROA prefix\n      exists for the route prefix, then\
    \ the route should get an Invalid\n      status.\n"
- title: 7.1.12.  Multiple ASs in AS_SET (in the Route) and ROAs Exist for a
  contents:
  - "7.1.12.  Multiple ASs in AS_SET (in the Route) and ROAs Exist for a\n       \
    \  Covering Set of More Specifics\n   ROA: {10.1.0.0/18, maxLength = 20, AS 64496}\n\
    \   ROA: {10.1.64.0/18, maxLength = 20, AS 64497}\n   ROA: {10.1.128.0/18, maxLength\
    \ = 20, AS 64498}\n   ROA: {10.1.192.0/18, maxLength = 20, AS 64499}\n   Route\
    \ has {10.1.0.0/16, AS_SET [AS 64496, AS 64497, AS 64498,\n   AS 64499] appears\
    \ in the rightmost position in the AS_PATH}\n   No covering ROA\n   Recommended\
    \ RPKI prefix-origin validation interpretation:  Route's\n      validation status\
    \ is NotFound.\n   Comment:  In this case, the aggregate of the prefixes in the\
    \ ROAs is\n      a covering prefix (i.e., exact match or less specific) relative\
    \ to\n      the route prefix.  The ASs in each of the contributing ROAs\n    \
    \  together form a set that matches the AS_SET in the route.  But it\n      is\
    \ very hard in general to break up an announced prefix into\n      constituent\
    \ more specifics and check for ROA coverage for those\n      more specifics. \
    \ In any case, it may be noted once again that in\n      the spirit of [RFC6472],\
    \ any route with an AS_SET in it should not\n      be considered valid (by ROA-based\
    \ validation).  In fact, the route\n      under consideration would have received\
    \ an Invalid status if the\n      route prefix had at least one covering ROA prefix.\n"
- title: 7.2.  ROA Expiry or Receipt of a CRL Revoking a ROA
  contents:
  - "7.2.  ROA Expiry or Receipt of a CRL Revoking a ROA\n   Here we enumerate use\
    \ cases corresponding to router actions when RPKI\n   objects expire or are revoked.\
    \  In the cases that follow, the terms\n   \"expired ROA\" or \"revoked ROA\"\
    \ are shorthand and describe the expiry\n   or revocation of the End Entity (EE)\
    \ or resource certificate that\n   causes a relying party to consider the corresponding\
    \ ROA to have\n   expired or been revoked, respectively.\n"
- title: 7.2.1.  ROA of Parent Prefix Is Revoked
  contents:
  - "7.2.1.  ROA of Parent Prefix Is Revoked\n   A certificate revocation list (CRL)\
    \ is received that reveals that the\n   ROA {10.1.0.0/22, maxLength = 24, ASN\
    \ 64496} is revoked.  Further, a\n   route exists in the Internet routing system\
    \ for 10.1.3.0/24\n   originated from ASN 64496.  In the absence of said revoked\
    \ ROA, no\n   covering ROA prefix exists for the route prefix (i.e., 10.1.3.0/24).\n\
    \   The Relying Party interpretation would be: Route's validation status\n   is\
    \ NotFound.\n"
- title: 7.2.2.  ROA of Prefix Revoked while Parent Prefix Has Covering ROA
  contents:
  - "7.2.2.  ROA of Prefix Revoked while Parent Prefix Has Covering ROA\n        Prefix\
    \ with Different ASN\n   A CRL is received that reveals that the ROA {10.1.3.0/24,\n\
    \   maxLength = 24, ASN 64496} is revoked.  Further, a route exists in\n   the\
    \ Internet routing system for 10.1.3.0/24 originated from\n   ASN 64496.  Additionally,\
    \ a valid ROA exists for a parent prefix\n   10.1.0.0/22, and said ROA is {10.1.0.0/22,\
    \ maxLength = 24,\n   ASN 64511}.  No other covering ROA exists for the 10.1.3.0/24\
    \ prefix.\n   The Relying Party interpretation would be: Route is Invalid.\n"
- title: 7.2.3.  ROA of Prefix Revoked while That of Parent Prefix Prevails
  contents:
  - "7.2.3.  ROA of Prefix Revoked while That of Parent Prefix Prevails\n   A CRL\
    \ is received that reveals that the ROA {10.1.3.0/24,\n   maxLength = 24, ASN\
    \ 64496} is revoked.  Further, a route exists in\n   the Internet routing system\
    \ for 10.1.3.0/24 originated from\n   ASN 64496.  Additionally, a valid ROA exists\
    \ for a parent prefix\n   10.1.0.0/22, and said ROA is {10.1.0.0/22, maxLength\
    \ = 24,\n   ASN 64496}.\n   The Relying Party interpretation would be: Route is\
    \ Valid.\n   (Clarification: Perhaps the revocation of the ROA for prefix\n  \
    \ 10.1.3.0/24 was initiated just to eliminate redundancy.)\n"
- title: 7.2.4.  ROA of Grandparent Prefix Revoked while That of Parent Prefix
  contents:
  - "7.2.4.  ROA of Grandparent Prefix Revoked while That of Parent Prefix\n     \
    \   Prevails\n   A CRL is received that reveals that the ROA {10.1.0.0/20,\n \
    \  maxLength = 24, ASN 64496} is revoked.  Further, a route exists in\n   the\
    \ Internet routing system for 10.1.3.0/24 originated from\n   ASN 64496.  Additionally,\
    \ a valid ROA exists for a parent prefix\n   10.1.0.0/22, and said ROA is {10.1.0.0/22,\
    \ maxLength = 24,\n   ASN 64496}.\n   The Relying Party interpretation would be:\
    \ Route is Valid.\n   (Clarification: The ROA for less specific grandparent prefix\n\
    \   10.1.0.0/20 was revoked or withdrawn.)\n"
- title: 7.2.5.  Expiry of ROA of Parent Prefix
  contents:
  - "7.2.5.  Expiry of ROA of Parent Prefix\n   A scan of the ROA list reveals that\
    \ the ROA {10.1.0.0/22,\n   maxLength = 24, ASN 64496} has expired.  Further,\
    \ a route exists in\n   the Internet routing system for 10.1.3.0/24 originated\
    \ from\n   ASN 64496.  In the absence of said expired ROA, no covering ROA\n \
    \  prefix exists for the route prefix (i.e., 10.1.3.0/24).\n   The Relying Party\
    \ interpretation would be: Route's validation status\n   is NotFound.\n"
- title: 7.2.6.  Expiry of ROA of Prefix while Parent Prefix Has Covering ROA
  contents:
  - "7.2.6.  Expiry of ROA of Prefix while Parent Prefix Has Covering ROA\n      \
    \  with Different ASN\n   A scan of the ROA list reveals that the ROA {10.1.3.0/24,\n\
    \   maxLength = 24, ASN 64496} has expired.  Further, a route exists in\n   the\
    \ Internet routing system for 10.1.3.0/24 originated from\n   ASN 64496.  Additionally,\
    \ a valid ROA exists for a parent prefix\n   10.1.0.0/22, and said ROA is {10.1.0.0/22,\
    \ maxLength = 24,\n   ASN 64511}.  No other covering ROA exists for the prefix\
    \ (i.e.,\n   10.1.3.0/24).\n   The Relying Party interpretation would be: Route\
    \ is Invalid.\n"
- title: 7.2.7.  Expiry of ROA of Prefix while That of Parent Prefix Prevails
  contents:
  - "7.2.7.  Expiry of ROA of Prefix while That of Parent Prefix Prevails\n   A scan\
    \ of the ROA list reveals that the ROA {10.1.3.0/24,\n   maxLength = 24, ASN 64496}\
    \ has expired.  Further, a route exists in\n   the Internet routing system for\
    \ 10.1.3.0/24 originated from\n   ASN 64496.  Additionally, a valid ROA exists\
    \ for a parent prefix\n   10.1.0.0/22, and said ROA is {10.1.0.0/22, maxLength\
    \ = 24,\n   ASN 64496}.\n   The Relying Party interpretation would be: Route is\
    \ Valid.\n"
- title: 7.2.8.  Expiry of ROA of Grandparent Prefix while That of Parent Prefix
  contents:
  - "7.2.8.  Expiry of ROA of Grandparent Prefix while That of Parent Prefix\n   \
    \     Prevails\n   A scan of the ROA list reveals that the ROA {10.1.0.0/20,\n\
    \   maxLength = 24, ASN 64496} has expired.  Further, a route exists in\n   the\
    \ Internet routing system for 10.1.3.0/24 originated from\n   ASN 64496.  Additionally,\
    \ a valid ROA exists for a parent prefix\n   10.1.0.0/22, and said ROA is {10.1.0.0/22,\
    \ maxLength = 24,\n   ASN 64496}.\n   The Relying Party interpretation would be:\
    \ Route is Valid.\n"
- title: 8.  Acknowledgements
  contents:
  - "8.  Acknowledgements\n   The authors are indebted to both Sandy Murphy and Sam\
    \ Weiler for\n   their guidance.  Further, the authors would like to thank Steve\
    \ Kent,\n   Warren Kumari, Randy Bush, Curtis Villamizar, and Danny McPherson\
    \ for\n   their technical insight and review.  The authors also wish to thank\n\
    \   Elwyn Davies, Stephen Farrell, Barry Leiba, Stewart Bryant, Alexey\n   Melnikov,\
    \ and Russ Housley for their review and comments during the\n   IESG review process.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   This memo requires no security considerations.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC4271]  Rekhter, Y., Li, T., and S. Hares,\
    \ \"A Border Gateway\n              Protocol 4 (BGP-4)\", RFC 4271, January 2006.\n\
    \   [RFC6480]  Lepinski, M. and S. Kent, \"An Infrastructure to Support\n    \
    \          Secure Internet Routing\", RFC 6480, February 2012.\n   [RFC6482] \
    \ Lepinski, M., Kent, S., and D. Kong, \"A Profile for Route\n              Origin\
    \ Authorizations (ROAs)\", RFC 6482, February 2012.\n   [RFC6487]  Huston, G.,\
    \ Michaelson, G., and R. Loomans, \"A Profile for\n              X.509 PKIX Resource\
    \ Certificates\", RFC 6487,\n              February 2012.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [AS0-PROC] Kumari, W., Bush, R., Schiller,\
    \ H., and K. Patel,\n              \"Codification of AS 0 processing\", Work in\
    \ Progress,\n              August 2012.\n   [BRITE]    NIST, \"BRITE - BGPSEC\
    \ / RPKI Interoperability Test &\n              Evaluation\", Developed by the\
    \ National Institute of\n              Standards and Technology (NIST), Gaithersburg,\
    \ Maryland,\n              2011, <http://brite.antd.nist.gov/statics/about>.\n\
    \   [RFC1918]  Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and\n  \
    \            E. Lear, \"Address Allocation for Private Internets\",\n        \
    \      BCP 5, RFC 1918, February 1996.\n   [RFC3779]  Lynn, C., Kent, S., and\
    \ K. Seo, \"X.509 Extensions for IP\n              Addresses and AS Identifiers\"\
    , RFC 3779, June 2004.\n   [RFC4632]  Fuller, V. and T. Li, \"Classless Inter-domain\
    \ Routing\n              (CIDR): The Internet Address Assignment and Aggregation\n\
    \              Plan\", BCP 122, RFC 4632, August 2006.\n   [RFC5280]  Cooper,\
    \ D., Santesson, S., Farrell, S., Boeyen, S.,\n              Housley, R., and\
    \ W. Polk, \"Internet X.509 Public Key\n              Infrastructure Certificate\
    \ and Certificate Revocation List\n              (CRL) Profile\", RFC 5280, May\
    \ 2008.\n   [RFC5737]  Arkko, J., Cotton, M., and L. Vegoda, \"IPv4 Address Blocks\n\
    \              Reserved for Documentation\", RFC 5737, January 2010.\n   [RFC6472]\
    \  Kumari, W. and K. Sriram, \"Recommendation for Not Using\n              AS_SET\
    \ and AS_CONFED_SET in BGP\", BCP 172, RFC 6472,\n              December 2011.\n\
    \   [RFC6483]  Huston, G. and G. Michaelson, \"Validation of Route\n         \
    \     Origination Using the Resource Certificate Public Key\n              Infrastructure\
    \ (PKI) and Route Origin Authorizations\n              (ROAs)\", RFC 6483, February\
    \ 2012.\n   [RFC6811]  Mohapatra, P., Scudder, J., Ward, D., Bush, R., and R.\n\
    \              Austein, \"BGP Prefix Origin Validation\", RFC 6811,\n        \
    \      January 2013.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Terry Manderson\n   ICANN\n   EMail: terry.manderson@icann.org\n\
    \   Kotikalapudi Sriram\n   US NIST\n   EMail: ksriram@nist.gov\n   Russ White\n\
    \   Verisign\n   EMail: russ@riw.us\n"
