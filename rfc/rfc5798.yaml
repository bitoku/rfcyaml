- title: __initial_text__
  contents:
  - ' Virtual Router Redundancy Protocol (VRRP) Version 3 for IPv4 and IPv6

    '
- title: Abstract
  contents:
  - "Abstract\n   This memo defines the Virtual Router Redundancy Protocol (VRRP)\
    \ for\n   IPv4 and IPv6.  It is version three (3) of the protocol, and it is\n\
    \   based on VRRP (version 2) for IPv4 that is defined in RFC 3768 and in\n  \
    \ \"Virtual Router Redundancy Protocol for IPv6\".  VRRP specifies an\n   election\
    \ protocol that dynamically assigns responsibility for a\n   virtual router to\
    \ one of the VRRP routers on a LAN.  The VRRP router\n   controlling the IPv4\
    \ or IPv6 address(es) associated with a virtual\n   router is called the Master,\
    \ and it forwards packets sent to these\n   IPv4 or IPv6 addresses.  VRRP Master\
    \ routers are configured with\n   virtual IPv4 or IPv6 addresses, and VRRP Backup\
    \ routers infer the\n   address family of the virtual addresses being carried\
    \ based on the\n   transport protocol.  Within a VRRP router, the virtual routers\
    \ in\n   each of the IPv4 and IPv6 address families are a domain unto\n   themselves\
    \ and do not overlap.  The election process provides dynamic\n   failover in the\
    \ forwarding responsibility should the Master become\n   unavailable.  For IPv4,\
    \ the advantage gained from using VRRP is a\n   higher-availability default path\
    \ without requiring configuration of\n   dynamic routing or router discovery protocols\
    \ on every end-host.  For\n   IPv6, the advantage gained from using VRRP for IPv6\
    \ is a quicker\n   switchover to Backup routers than can be obtained with standard\
    \ IPv6\n   Neighbor Discovery mechanisms.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc5798.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. A Note on Terminology ......................................4\n  \
    \    1.2. IPv4 .......................................................5\n    \
    \  1.3. IPv6 .......................................................6\n      1.4.\
    \ Requirements Language ......................................6\n      1.5. Scope\
    \ ......................................................7\n      1.6. Definitions\
    \ ................................................7\n   2. Required Features ...............................................8\n\
    \      2.1. IPvX Address Backup ........................................8\n  \
    \    2.2. Preferred Path Indication ..................................8\n    \
    \  2.3. Minimization of Unnecessary Service Disruptions ............9\n      2.4.\
    \ Efficient Operation over Extended LANs .....................9\n      2.5. Sub-Second\
    \ Operation for IPv4 and IPv6 .....................9\n   3. VRRP Overview ..................................................10\n\
    \   4. Sample Configurations ..........................................11\n  \
    \    4.1. Sample Configuration 1 ....................................11\n    \
    \  4.2. Sample Configuration 2 ....................................13\n   5. Protocol\
    \ .......................................................14\n      5.1. VRRP Packet\
    \ Format ........................................15\n           5.1.1. IPv4 Field\
    \ Descriptions ............................15\n                  5.1.1.1. Source\
    \ Address ............................15\n                  5.1.1.2. Destination\
    \ Address .......................15\n                  5.1.1.3. TTL .......................................16\n\
    \                  5.1.1.4. Protocol ..................................16\n  \
    \         5.1.2. IPv6 Field Descriptions ............................16\n    \
    \              5.1.2.1. Source Address ............................16\n      \
    \            5.1.2.2. Destination Address .......................16\n        \
    \          5.1.2.3. Hop Limit .................................16\n          \
    \        5.1.2.4. Next Header ...............................16\n      5.2. VRRP\
    \ Field Descriptions ...................................16\n           5.2.1.\
    \ Version ............................................16\n           5.2.2. Type\
    \ ...............................................17\n           5.2.3. Virtual\
    \ Rtr ID (VRID) ..............................17\n           5.2.4. Priority ...........................................17\n\
    \           5.2.5. Count IPvX Addr ....................................17\n  \
    \         5.2.6. Rsvd ...............................................17\n    \
    \       5.2.7. Maximum Advertisement Interval (Max Adver Int) .....17\n      \
    \     5.2.8. Checksum ...........................................18\n        \
    \   5.2.9. IPvX Address(es) ...................................18\n   6. Protocol\
    \ State Machine .........................................18\n      6.1. Parameters\
    \ Per Virtual Router .............................18\n      6.2. Timers ....................................................20\n\
    \      6.3. State Transition Diagram ..................................21\n  \
    \    6.4. State Descriptions ........................................21\n    \
    \       6.4.1. Initialize .........................................21\n      \
    \     6.4.2. Backup .............................................22\n        \
    \   6.4.3. Master .............................................24\n   7. Sending\
    \ and Receiving VRRP Packets .............................26\n      7.1. Receiving\
    \ VRRP Packets ....................................26\n      7.2. Transmitting\
    \ VRRP Packets .................................27\n      7.3. Virtual Router\
    \ MAC Address ................................28\n      7.4. IPv6 Interface Identifiers\
    \ ................................28\n   8. Operational Issues .............................................29\n\
    \      8.1. IPv4 ......................................................29\n  \
    \         8.1.1. ICMP Redirects .....................................29\n    \
    \       8.1.2. Host ARP Requests ..................................29\n      \
    \     8.1.3. Proxy ARP ..........................................30\n      8.2.\
    \ IPv6 ......................................................30\n           8.2.1.\
    \ ICMPv6 Redirects ...................................30\n           8.2.2. ND\
    \ Neighbor Solicitation ...........................30\n           8.2.3. Router\
    \ Advertisements ..............................31\n      8.3. IPvX ......................................................31\n\
    \           8.3.1. Potential Forwarding Loop ..........................31\n  \
    \         8.3.2. Recommendations Regarding Setting Priority Values ..32\n    \
    \  8.4. VRRPv3 and VRRPv2 Interoperation ..........................32\n      \
    \     8.4.1. Assumptions ........................................32\n        \
    \   8.4.2. VRRPv3 Support of VRRPv2 ...........................32\n          \
    \ 8.4.3. VRRPv3 Support of VRRPv2 Considerations ............33\n            \
    \      8.4.3.1. Slow, High-Priority Masters ...............33\n              \
    \    8.4.3.2. Overwhelming VRRPv2 Backups ...............33\n   9. Security Considerations\
    \ ........................................33\n   10. Contributors and Acknowledgments\
    \ ..............................34\n   11. IANA Considerations ...........................................35\n\
    \   12. References ....................................................35\n  \
    \    12.1. Normative References .....................................35\n    \
    \  12.2. Informative References ...................................36\n   Appendix\
    \ A. Operation over FDDI, Token Ring, and ATM LANE .........38\n      A.1. Operation\
    \ over FDDI .......................................38\n      A.2. Operation over\
    \ Token Ring .................................38\n      A.3. Operation over ATM\
    \ LANE ...................................40\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This memo defines the Virtual Router Redundancy Protocol\
    \ (VRRP) for\n   IPv4 and IPv6.  It is version three (3) of the protocol.  It\
    \ is based\n   on VRRP (version 2) for IPv4 that is defined in [RFC3768] and in\n\
    \   [VRRP-IPv6].  VRRP specifies an election protocol that dynamically\n   assigns\
    \ responsibility for a virtual router to one of the VRRP\n   routers on a LAN.\
    \  The VRRP router controlling the IPv4 or IPv6\n   address(es) associated with\
    \ a virtual router is called the Master,\n   and it forwards packets sent to these\
    \ IPv4 or IPv6 addresses.  VRRP\n   Master routers are configured with virtual\
    \ IPv4 or IPv6 addresses,\n   and VRRP Backup routers infer the address family\
    \ of the virtual\n   addresses being carried based on the transport protocol.\
    \  Within a\n   VRRP router, the virtual routers in each of the IPv4 and IPv6\
    \ address\n   families are a domain unto themselves and do not overlap.  The\n\
    \   election process provides dynamic failover in the forwarding\n   responsibility\
    \ should the Master become unavailable.\n   VRRP provides a function similar to\
    \ the proprietary protocols \"Hot\n   Standby Router Protocol (HSRP)\" [RFC2281]\
    \ and \"IP Standby Protocol\"\n   [IPSTB].\n"
- title: 1.1.  A Note on Terminology
  contents:
  - "1.1.  A Note on Terminology\n   This document discusses both IPv4 and IPv6 operation,\
    \ and with\n   respect to the VRRP protocol, many of the descriptions and procedures\n\
    \   are common.  In this document, it would be less verbose to be able to\n  \
    \ refer to \"IP\" to mean either \"IPv4 or IPv6\".  However, historically,\n \
    \  the term \"IP\" usually refers to IPv4.  For this reason, in this\n   specification,\
    \ the term \"IPvX\" (where X is 4 or 6) is introduced to\n   mean either \"IPv4\"\
    \ or \"IPv6\".  In this text, where the IP version\n   matters, the appropriate\
    \ term is used and the use of the term \"IP\" is\n   avoided.\n"
- title: 1.2.  IPv4
  contents:
  - "1.2.  IPv4\n   There are a number of methods that an IPv4 end-host can use to\n\
    \   determine its first-hop router towards a particular IPv4 destination.\n  \
    \ These include running (or snooping) a dynamic routing protocol such\n   as Routing\
    \ Information Protocol [RFC2453] or OSPF version 2\n   [RFC2328], running an ICMP\
    \ router discovery client [RFC1256], or\n   using a statically configured default\
    \ route.\n   Running a dynamic routing protocol on every end-host may be\n   infeasible\
    \ for a number of reasons, including administrative\n   overhead, processing overhead,\
    \ security issues, or lack of a protocol\n   implementation for some platforms.\
    \  Neighbor or router discovery\n   protocols may require active participation\
    \ by all hosts on a network,\n   leading to large timer values to reduce protocol\
    \ overhead in the face\n   of large numbers of hosts.  This can result in a significant\
    \ delay in\n   the detection of a lost (i.e., dead) neighbor; such a delay may\n\
    \   introduce unacceptably long \"black hole\" periods.\n   The use of a statically\
    \ configured default route is quite popular; it\n   minimizes configuration and\
    \ processing overhead on the end-host and\n   is supported by virtually every\
    \ IPv4 implementation.  This mode of\n   operation is likely to persist as dynamic\
    \ host configuration\n   protocols [RFC2131] are deployed, which typically provide\n\
    \   configuration for an end-host IPv4 address and default gateway.\n   However,\
    \ this creates a single point of failure.  Loss of the default\n   router results\
    \ in a catastrophic event, isolating all end-hosts that\n   are unable to detect\
    \ any alternate path that may be available.\n   The Virtual Router Redundancy\
    \ Protocol (VRRP) is designed to\n   eliminate the single point of failure inherent\
    \ in the static default-\n   routed environment.  VRRP specifies an election protocol\
    \ that\n   dynamically assigns responsibility for a virtual router to one of the\n\
    \   VRRP routers on a LAN.  The VRRP router controlling the IPv4\n   address(es)\
    \ associated with a virtual router is called the Master and\n   forwards packets\
    \ sent to these IPv4 addresses.  The election process\n   provides dynamic failover\
    \ in the forwarding responsibility should the\n   Master become unavailable. \
    \ Any of the virtual router's IPv4\n   addresses on a LAN can then be used as\
    \ the default first hop\n   router by end-hosts.  The advantage gained from using\
    \ VRRP is a\n   higher availability default path without requiring configuration\
    \ of\n   dynamic routing or router discovery protocols on every end-host.\n"
- title: 1.3.  IPv6
  contents:
  - "1.3.  IPv6\n   IPv6 hosts on a LAN will usually learn about one or more default\n\
    \   routers by receiving Router Advertisements sent using the IPv6\n   Neighbor\
    \ Discovery (ND) protocol [RFC4861].  The Router\n   Advertisements are multicast\
    \ periodically at a rate that the hosts\n   will learn about the default routers\
    \ in a few minutes.  They are not\n   sent frequently enough to rely on the absence\
    \ of the Router\n   Advertisement to detect router failures.\n   Neighbor Discovery\
    \ (ND) includes a mechanism called Neighbor\n   Unreachability Detection to detect\
    \ the failure of a neighbor node\n   (router or host) or the forwarding path to\
    \ a neighbor.  This is done\n   by sending unicast ND Neighbor Solicitation messages\
    \ to the neighbor\n   node.  To reduce the overhead of sending Neighbor Solicitations,\
    \ they\n   are only sent to neighbors to which the node is actively sending\n\
    \   traffic and only after there has been no positive indication that the\n  \
    \ router is up for a period of time.  Using the default parameters in\n   ND,\
    \ it will take a host about 38 seconds to learn that a router is\n   unreachable\
    \ before it will switch to another default router.  This\n   delay would be very\
    \ noticeable to users and cause some transport\n   protocol implementations to\
    \ time out.\n   While the ND unreachability detection could be made quicker by\n\
    \   changing the parameters to be more aggressive (note that the current\n   lower\
    \ limit for this is 5 seconds), this would have the downside of\n   significantly\
    \ increasing the overhead of ND traffic, especially when\n   there are many hosts\
    \ all trying to determine the reachability of one\n   of more routers.\n   The\
    \ Virtual Router Redundancy Protocol for IPv6 provides a much\n   faster switchover\
    \ to an alternate default router than can be obtained\n   using standard ND procedures.\
    \  Using VRRP, a Backup router can take\n   over for a failed default router in\
    \ around three seconds (using VRRP\n   default parameters).  This is done without\
    \ any interaction with the\n   hosts and a minimum amount of VRRP traffic.\n"
- title: 1.4.  Requirements Language
  contents:
  - "1.4.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 1.5.  Scope
  contents:
  - "1.5.  Scope\n   The remainder of this document describes the features, design\
    \ goals,\n   and theory of operation of VRRP.  The message formats, protocol\n\
    \   processing rules, and state machine that guarantee convergence to a\n   single\
    \ Virtual Router Master are presented.  Finally, operational\n   issues related\
    \ to MAC address mapping, handling of ARP requests,\n   generation of ICMP redirect\
    \ messages, and security issues are\n   addressed.\n"
- title: 1.6.  Definitions
  contents:
  - "1.6.  Definitions\n   VRRP Router             A router running the Virtual Router\n\
    \                           Redundancy Protocol.  It may participate as\n    \
    \                       one or more virtual routers.\n   Virtual Router      \
    \    An abstract object managed by VRRP that acts\n                          \
    \ as a default router for hosts on a shared\n                           LAN. \
    \ It consists of a Virtual Router\n                           Identifier and either\
    \ a set of associated\n                           IPv4 addresses or a set of associated\
    \ IPv6\n                           addresses across a common LAN.  A VRRP Router\n\
    \                           may back up one or more virtual routers.\n   IP Address\
    \ Owner        The VRRP router that has the virtual router's\n               \
    \            IPvX address(es) as real interface\n                           address(es).\
    \  This is the router that, when\n                           up, will respond\
    \ to packets addressed to one\n                           of these IPvX addresses\
    \ for ICMP pings, TCP\n                           connections, etc.\n   Primary\
    \ IP Address      In IPv4, an IPv4 address selected from the\n               \
    \            set of real interface addresses.  One\n                         \
    \  possible selection algorithm is to always\n                           select\
    \ the first address.  In IPv4 mode, VRRP\n                           advertisements\
    \ are always sent using the\n                           primary IPv4 address as\
    \ the source of the\n                           IPv4 packet.  In IPv6, the link-local\
    \ address\n                           of the interface over which the packet is\n\
    \                           transmitted is used.\n   Virtual Router Master   The\
    \ VRRP router that is assuming the\n                           responsibility\
    \ of forwarding packets sent to\n                           the IPvX address(es)\
    \ associated with the\n                           virtual router, answering ARP\
    \ requests\n                           for the IPv4 address(es), and answering\
    \ ND\n                           requests for the IPv6 address(es).  Note that\n\
    \                           if the IPvX address owner is available, then\n   \
    \                        it will always become the Master.\n   Virtual Router\
    \ Backup   The set of VRRP routers available to assume\n                     \
    \      forwarding responsibility for a virtual\n                           router\
    \ should the current Master fail.\n"
- title: 2.  Required Features
  contents:
  - "2.  Required Features\n   This section outlines the set of features that were\
    \ considered\n   mandatory and that guided the design of VRRP.\n"
- title: 2.1.  IPvX Address Backup
  contents:
  - "2.1.  IPvX Address Backup\n   Backup of an IPvX address or addresses is the primary\
    \ function of\n   VRRP.  While providing election of a Virtual Router Master and\
    \ the\n   additional functionality described below, the protocol should\n   strive\
    \ to:\n   o  Minimize the duration of black holes.\n   o  Minimize the steady-state\
    \ bandwidth overhead and processing\n      complexity.\n   o  Function over a\
    \ wide variety of multiaccess LAN technologies\n      capable of supporting IPvX\
    \ traffic.\n   o  Allow multiple virtual routers on a network for load balancing.\n\
    \   o  Support multiple logical IPvX subnets on a single LAN segment.\n"
- title: 2.2.  Preferred Path Indication
  contents:
  - "2.2.  Preferred Path Indication\n   A simple model of Master election among a\
    \ set of redundant routers is\n   to treat each router with equal preference and\
    \ claim victory after\n   converging to any router as Master.  However, there\
    \ are likely to be\n   many environments where there is a distinct preference\
    \ (or range of\n   preferences) among the set of redundant routers.  For example,\
    \ this\n   preference may be based upon access link cost or speed, router\n  \
    \ performance or reliability, or other policy considerations.  The\n   protocol\
    \ should allow the expression of this relative path preference\n   in an intuitive\
    \ manner and guarantee Master convergence to the most\n   preferential router\
    \ currently available.\n"
- title: 2.3.  Minimization of Unnecessary Service Disruptions
  contents:
  - "2.3.  Minimization of Unnecessary Service Disruptions\n   Once Master election\
    \ has been performed, any unnecessary transitions\n   between Master and Backup\
    \ routers can result in a disruption in\n   service.  The protocol should ensure\
    \ after Master election that no\n   state transition is triggered by any Backup\
    \ router of equal or lower\n   preference as long as the Master continues to function\
    \ properly.\n   Some environments may find it beneficial to avoid the state\n\
    \   transition triggered when a router that is preferred over the current\n  \
    \ Master becomes available.  It may be useful to support an override of\n   the\
    \ immediate convergence to the preferred path.\n"
- title: 2.4.  Efficient Operation over Extended LANs
  contents:
  - "2.4.  Efficient Operation over Extended LANs\n   Sending IPvX packets (that is,\
    \ sending either IPv4 or IPv6) on a\n   multiaccess LAN requires mapping from\
    \ an IPvX address to a MAC\n   address.  The use of the virtual router MAC address\
    \ in an extended\n   LAN employing learning bridges can have a significant effect\
    \ on the\n   bandwidth overhead of packets sent to the virtual router.  If the\n\
    \   virtual router MAC address is never used as the source address in a\n   link-level\
    \ frame, then the station location is never learned,\n   resulting in flooding\
    \ of all packets sent to the virtual router.  To\n   improve the efficiency in\
    \ this environment, the protocol should:\n   1) use the virtual router MAC address\
    \ as the source in a packet sent\n   by the Master to trigger station learning;\
    \ 2) trigger a message\n   immediately after transitioning to the Master to update\
    \ the station\n   learning; and 3) trigger periodic messages from the Master to\n\
    \   maintain the station learning cache.\n"
- title: 2.5.  Sub-Second Operation for IPv4 and IPv6
  contents:
  - "2.5.  Sub-Second Operation for IPv4 and IPv6\n   Sub-second detection of Master\
    \ VRRP router failure is needed in both\n   IPv4 and IPv6 environments.  Earlier\
    \ work proposed that sub-second\n   operation was for IPv6; this specification\
    \ leverages that earlier\n   approach for IPv4 and IPv6.\n   One possible problematic\
    \ scenario when using small\n   VRRP_Advertisement_Intervals may occur when a\
    \ router is delivering\n   more packets onto the LAN than can be accommodated,\
    \ and so a queue\n   builds up in the router.  It is possible that packets being\n\
    \   transmitted onto the VRRP-protected LAN could see larger queueing\n   delay\
    \ than the smallest VRRP Advertisement_Interval.  In this case,\n   the Master_Down_Interval\
    \ will be small enough so that normal queuing\n   delays might cause a VRRP Backup\
    \ to conclude that the Master is down,\n   and therefore promote itself to Master.\
    \  Very shortly afterwards, the\n   delayed VRRP packets from the Master cause\
    \ a switch back to Backup\n   status.  Furthermore, this process can repeat many\
    \ times per second,\n   causing significant disruption to traffic.  To mitigate\
    \ this problem,\n   priority forwarding of VRRP packets should be considered.\
    \  It should\n   be possible for a VRRP Master to observe that this situation\
    \ is\n   occurring frequently and at least log the problem.\n"
- title: 3.  VRRP Overview
  contents:
  - "3.  VRRP Overview\n   VRRP specifies an election protocol to provide the virtual\
    \ router\n   function described earlier.  All protocol messaging is performed\n\
    \   using either IPv4 or IPv6 multicast datagrams; thus, the protocol can\n  \
    \ operate over a variety of multiaccess LAN technologies supporting\n   IPvX multicast.\
    \  Each link of a VRRP virtual router has a single\n   well-known MAC address\
    \ allocated to it.  This document currently only\n   details the mapping to networks\
    \ using the IEEE 802 48-bit MAC\n   address.  The virtual router MAC address is\
    \ used as the source in all\n   periodic VRRP messages sent by the Master router\
    \ to enable bridge\n   learning in an extended LAN.\n   A virtual router is defined\
    \ by its virtual router identifier (VRID)\n   and a set of either IPv4 or IPv6\
    \ address(es).  A VRRP router may\n   associate a virtual router with its real\
    \ address on an interface.\n   The scope of each virtual router is restricted\
    \ to a single LAN.  A\n   VRRP router may be configured with additional virtual\
    \ router mappings\n   and priority for virtual routers it is willing to back up.\
    \  The\n   mapping between the VRID and its IPvX address(es) must be coordinated\n\
    \   among all VRRP routers on a LAN.\n   There is no restriction against reusing\
    \ a VRID with a different\n   address mapping on different LANs, nor is there\
    \ a restriction against\n   using the same VRID number for a set of IPv4 addresses\
    \ and a set of\n   IPv6 addresses; however, these are two different virtual routers.\n\
    \   To minimize network traffic, only the Master for each virtual router\n   sends\
    \ periodic VRRP Advertisement messages.  A Backup router will not\n   attempt\
    \ to preempt the Master unless it has higher priority.  This\n   eliminates service\
    \ disruption unless a more preferred path becomes\n   available.  It's also possible\
    \ to administratively prohibit all\n   preemption attempts.  The only exception\
    \ is that a VRRP router will\n   always become Master of any virtual router associated\
    \ with addresses\n   it owns.  If the Master becomes unavailable, then the highest-\n\
    \   priority Backup will transition to Master after a short delay,\n   providing\
    \ a controlled transition of the virtual router\n   responsibility with minimal\
    \ service interruption.\n   The VRRP protocol design provides rapid transition\
    \ from Backup to\n   Master to minimize service interruption and incorporates\n\
    \   optimizations that reduce protocol complexity while guaranteeing\n   controlled\
    \ Master transition for typical operational scenarios.  The\n   optimizations\
    \ result in an election protocol with minimal runtime\n   state requirements,\
    \ minimal active protocol states, and a single\n   message type and sender.  The\
    \ typical operational scenarios are\n   defined to be two redundant routers and/or\
    \ distinct path preferences\n   among each router.  A side effect when these assumptions\
    \ are violated\n   (i.e., more than two redundant paths, all with equal preference)\
    \ is\n   that duplicate packets may be forwarded for a brief period during\n \
    \  Master election.  However, the typical scenario assumptions are\n   likely\
    \ to cover the vast majority of deployments, loss of the Master\n   router is\
    \ infrequent, and the expected duration in Master election\n   convergence is\
    \ quite small ( << 1 second ).  Thus, the VRRP\n   optimizations represent significant\
    \ simplifications in the protocol\n   design while incurring an insignificant\
    \ probability of brief network\n   degradation.\n"
- title: 4.  Sample Configurations
  contents:
  - '4.  Sample Configurations

    '
- title: 4.1.  Sample Configuration 1
  contents:
  - "4.1.  Sample Configuration 1\n   The following figure shows a simple network\
    \ with two VRRP routers\n   implementing one virtual router.\n        +-----------+\
    \ +-----------+\n        |   Rtr1    | |   Rtr2    |\n        |(MR VRID=1)| |(BR\
    \ VRID=1)|\n        |           | |           |\n"
- title: VRID=1  +-----------+ +-----------+
  contents:
  - 'VRID=1  +-----------+ +-----------+

    '
- title: IPvX A--------->*            *<---------IPvX B
  contents:
  - "IPvX A--------->*            *<---------IPvX B\n                |           \
    \ |\n                |            |\n"
- title: '----------------+------------+-----+----------+----------+----------+--'
  contents:
  - "----------------+------------+-----+----------+----------+----------+--\n   \
    \                                ^          ^          ^          ^\n        \
    \                           |          |          |          |\n"
- title: default rtr IPvX addrs-------> (IPvX A)   (IPvX A)   (IPvX A)   (IPvX A)
  contents:
  - "default rtr IPvX addrs-------> (IPvX A)   (IPvX A)   (IPvX A)   (IPvX A)\n  \
    \                                 |          |          |          |\n       \
    \                   IPvX H1->* IpvX H2->* IPvX H3->* IpvX H4->*\n            \
    \                    +--+--+    +--+--+    +--+--+    +--+--+\n              \
    \                  |  H1 |    |  H2 |    |  H3 |    |  H4 |\n                \
    \                +-----+    +-----+    +--+--+    +--+--+\n   Legend:\n      \
    \   --+---+---+-- = Ethernet, Token Ring, or FDDI\n                     H = Host\
    \ computer\n                    MR = Master Router\n                    BR = Backup\
    \ Router\n                    *  =  IPvX Address; X is 4 everywhere in IPv4 case\n\
    \                                        X is 6 everywhere in IPv6 case\n    \
    \                (IPvX) = default router for hosts\n   Eliminating all mention\
    \ of VRRP (VRID=1) from the figure above leaves\n   it as a typical deployment.\n\
    \   In the IPv4 case (that is, IPvX is IPv4 everywhere in the figure),\n   each\
    \ router is permanently assigned an IPv4 address on the LAN\n   interface (Rtr1\
    \ is assigned IPv4 A and Rtr2 is assigned IPv4 B), and\n   each host installs\
    \ a static default route through one of the routers\n   (in this example they\
    \ all use Rtr1's IPv4 A).\n   In the IPv6 case (that is, IPvX is IPv6 everywhere\
    \ in the figure),\n   each router has a link-local IPv6 address on the LAN interface\
    \ (Rtr1\n   is assigned IPv6 Link-Local A and Rtr2 is assigned IPv6 Link-\n  \
    \ Local B), and each host learns a default route from Router\n   Advertisements\
    \ through one of the routers (in this example, they all\n   use Rtr1's IPv6 Link-Local\
    \ A).\n   Moving to an IPv4 VRRP environment, each router has the exact same\n\
    \   permanently assigned IPv4 address.  Rtr1 is said to be the IPv4\n   address\
    \ owner of IPv4 A, and Rtr2 is the IPv4 address owner of\n   IPv4 B.  A virtual\
    \ router is then defined by associating a unique\n   identifier (the virtual router\
    \ ID) with the address owned by a\n   router.\n   Moving to an IPv6 VRRP environment,\
    \ each router has the exact same\n   Link-Local IPv6 address.  Rtr1 is said to\
    \ be the IPv6 address owner\n   of IPv6 A, and Rtr2 is the IPv6 address owner\
    \ of IPv6 B.  A virtual\n   router is then defined by associating a unique identifier\
    \ (the\n   virtual router ID) with the address owned by a router.\n   Finally,\
    \ in both the IPv4 and IPv6 cases, the VRRP protocol manages\n   virtual router\
    \ failover to a Backup router.\n   The IPv4 example above shows a virtual router\
    \ configured to cover the\n   IPv4 address owned by Rtr1 (VRID=1, IPv4_Address=A).\
    \  When VRRP is\n   enabled on Rtr1 for VRID=1, it will assert itself as Master,\
    \ with\n   priority = 255, since it is the IP address owner for the virtual\n\
    \   router IP address.  When VRRP is enabled on Rtr2 for VRID=1, it will\n   transition\
    \ to Backup, with priority = 100 (the default priority is\n   100), since it is\
    \ not the IPv4 address owner.  If Rtr1 should fail,\n   then the VRRP protocol\
    \ will transition Rtr2 to Master, temporarily\n   taking over forwarding responsibility\
    \ for IPv4 A to provide\n   uninterrupted service to the hosts.  When Rtr1 returns\
    \ to service, it\n   will re-assert itself as Master.\n   The IPv6 example above\
    \ shows a virtual router configured to cover the\n   IPv6 address owned by Rtr1\
    \ (VRID=1, IPv6_Address=A).  When VRRP is\n   enabled on Rtr1 for VRID=1, it will\
    \ assert itself as Master, with\n   priority = 255, since it is the IPv6 address\
    \ owner for the virtual\n   router IPv6 address.  When VRRP is enabled on Rtr2\
    \ for VRID=1, it\n   will transition to Backup, with priority = 100 (the default\
    \ priority\n   is 100), since it is not the IPv6 address owner.  If Rtr1 should\n\
    \   fail, then the VRRP protocol will transition Rtr2 to Master,\n   temporarily\
    \ taking over forwarding responsibility for IPv6 A to\n   provide uninterrupted\
    \ service to the hosts.\n   Note that in both cases, in this example IPvX B is\
    \ not backed up; it\n   is only used by Rtr2 as its interface address.  In order\
    \ to back up\n   IPvX B, a second virtual router must be configured.  This is\
    \ shown in\n   the next section.\n"
- title: 4.2.  Sample Configuration 2
  contents:
  - "4.2.  Sample Configuration 2\n   The following figure shows a configuration with\
    \ two virtual routers\n   with the hosts splitting their traffic between them.\n\
    \        +-----------+      +-----------+\n        |   Rtr1    |      |   Rtr2\
    \    |\n        |(MR VRID=1)|      |(BR VRID=1)|\n        |(BR VRID=2)|      |(MR\
    \ VRID=2)|\n"
- title: VRID=1  +-----------+      +-----------+  VRID=2
  contents:
  - 'VRID=1  +-----------+      +-----------+  VRID=2

    '
- title: IPvX A -------->*            *<---------- IPvX B
  contents:
  - "IPvX A -------->*            *<---------- IPvX B\n                |         \
    \   |\n                |            |\n"
- title: '----------------+------------+-----+----------+----------+----------+--'
  contents:
  - "----------------+------------+-----+----------+----------+----------+--\n   \
    \                                ^          ^          ^          ^\n        \
    \                           |          |          |          |\n"
- title: default rtr IPvX addrs -----> (IPvX A)   (IPvX A)   (IPvX B)   (IPvX B)
  contents:
  - "default rtr IPvX addrs -----> (IPvX A)   (IPvX A)   (IPvX B)   (IPvX B)\n   \
    \                                |          |          |          |\n        \
    \                  IPvX H1->* IpvX H2->* IPvX H3->* IpvX H4->*\n             \
    \                   +--+--+    +--+--+    +--+--+    +--+--+\n               \
    \                 |  H1 |    |  H2 |    |  H3 |    |  H4 |\n                 \
    \               +-----+    +-----+    +--+--+    +--+--+\n   Legend:\n       \
    \ ---+---+---+--  =  Ethernet, Token Ring, or FDDI\n                     H  =\
    \  Host computer\n                    MR  =  Master Router\n                 \
    \   BR  =  Backup Router\n                     *  =  IPvX Address; X is 4 everywhere\
    \ in IPv4 case\n                                         X is 6 everywhere in\
    \ IPv6 case\n                (IPvX)  =  default router for hosts\n   In the IPv4\
    \ example above (that is, IPvX is IPv4 everywhere in the\n   figure), half of\
    \ the hosts have configured a static route through\n   Rtr1's IPv4 A, and half\
    \ are using Rtr2's IPv4 B.  The configuration\n   of virtual router VRID=1 is\
    \ exactly the same as in the first example\n   (see Section 4.1), and a second\
    \ virtual router has been added to\n   cover the IPv4 address owned by Rtr2 (VRID=2,\
    \ IPv4_Address=B).  In\n   this case, Rtr2 will assert itself as Master for VRID=2\
    \ while Rtr1\n   will act as a Backup.  This scenario demonstrates a deployment\n\
    \   providing load splitting when both routers are available, while\n   providing\
    \ full redundancy for robustness.\n   In the IPv6 example above (that is, IPvX\
    \ is IPv6 everywhere in the\n   figure), half of the hosts have learned a default\
    \ route through\n   Rtr1's IPv6 A, and half are using Rtr2's IPv6 B.  The configuration\n\
    \   of virtual router VRID=1 is exactly the same as in the first example\n   (see\
    \ Section 4.1), and a second virtual router has been added to\n   cover the IPv6\
    \ address owned by Rtr2 (VRID=2, IPv6_Address=B).  In\n   this case, Rtr2 will\
    \ assert itself as Master for VRID=2 while Rtr1\n   will act as a Backup.  This\
    \ scenario demonstrates a deployment\n   providing load splitting when both routers\
    \ are available, while\n   providing full redundancy for robustness.\n   Note\
    \ that the details of load balancing are out of scope of this\n   document.  However,\
    \ in a case where the servers need different\n   weights, it may not make sense\
    \ to rely on router advertisements alone\n   to balance the host load between\
    \ the routers.\n"
- title: 5.  Protocol
  contents:
  - "5.  Protocol\n   The purpose of the VRRP packet is to communicate to all VRRP\
    \ routers\n   the priority and the state of the Master router associated with\
    \ the\n   VRID.\n   When VRRP is protecting an IPv4 address, VRRP packets are\
    \ sent\n   encapsulated in IPv4 packets.  They are sent to the IPv4 multicast\n\
    \   address assigned to VRRP.\n   When VRRP is protecting an IPv6 address, VRRP\
    \ packets are sent\n   encapsulated in IPv6 packets.  They are sent to the IPv6\
    \ multicast\n   address assigned to VRRP.\n"
- title: 5.1.  VRRP Packet Format
  contents:
  - "5.1.  VRRP Packet Format\n   This section defines the format of the VRRP packet\
    \ and the relevant\n   fields in the IP header.\n     0                   1  \
    \                 2                   3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                    IPv4 Fields or IPv6 Fields                 |\n   ...\
    \                                                             ...\n    |     \
    \                                                          |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |Version| Type  | Virtual Rtr ID|   Priority    |Count IPvX Addr|\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |(rsvd) |     Max Adver Int     |          Checksum             |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                                                               |\n    +\
    \                                                               +\n    |     \
    \                  IPvX Address(es)                        |\n    +          \
    \                                                     +\n    +               \
    \                                                +\n    +                    \
    \                                           +\n    +                         \
    \                                      +\n    |                              \
    \                                 |\n    +                                   \
    \                            +\n    |                                        \
    \                       |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n"
- title: 5.1.1.  IPv4 Field Descriptions
  contents:
  - '5.1.1.  IPv4 Field Descriptions

    '
- title: 5.1.1.1.  Source Address
  contents:
  - "5.1.1.1.  Source Address\n   This is the primary IPv4 address of the interface\
    \ the packet is being\n   sent from.\n"
- title: 5.1.1.2.  Destination Address
  contents:
  - "5.1.1.2.  Destination Address\n   The IPv4 multicast address as assigned by the\
    \ IANA for VRRP is:\n   224.0.0.18\n   This is a link-local scope multicast address.\
    \  Routers MUST NOT\n   forward a datagram with this destination address, regardless\
    \ of its\n   TTL.\n"
- title: 5.1.1.3.  TTL
  contents:
  - "5.1.1.3.  TTL\n   The TTL MUST be set to 255.  A VRRP router receiving a packet\
    \ with\n   the TTL not equal to 255 MUST discard the packet.\n"
- title: 5.1.1.4.  Protocol
  contents:
  - "5.1.1.4.  Protocol\n   The IPv4 protocol number assigned by the IANA for VRRP\
    \ is 112\n   (decimal).\n"
- title: 5.1.2.  IPv6 Field Descriptions
  contents:
  - '5.1.2.  IPv6 Field Descriptions

    '
- title: 5.1.2.1.  Source Address
  contents:
  - "5.1.2.1.  Source Address\n   This is the IPv6 link-local address of the interface\
    \ the packet is\n   being sent from.\n"
- title: 5.1.2.2.  Destination Address
  contents:
  - "5.1.2.2.  Destination Address\n   The IPv6 multicast address assigned by the\
    \ IANA for VRRP is:\n      FF02:0:0:0:0:0:0:12\n   This is a link-local scope\
    \ multicast address.  Routers MUST NOT\n   forward a datagram with this destination\
    \ address, regardless of its\n   Hop Limit.\n"
- title: 5.1.2.3.  Hop Limit
  contents:
  - "5.1.2.3.  Hop Limit\n   The Hop Limit MUST be set to 255.  A VRRP router receiving\
    \ a packet\n   with the Hop Limit not equal to 255 MUST discard the packet.\n"
- title: 5.1.2.4.  Next Header
  contents:
  - "5.1.2.4.  Next Header\n   The IPv6 Next Header protocol assigned by the IANA\
    \ for VRRP is 112\n   (decimal).\n"
- title: 5.2.  VRRP Field Descriptions
  contents:
  - '5.2.  VRRP Field Descriptions

    '
- title: 5.2.1.  Version
  contents:
  - "5.2.1.  Version\n   The version field specifies the VRRP protocol version of\
    \ this packet.\n   This document defines version 3.\n"
- title: 5.2.2.  Type
  contents:
  - "5.2.2.  Type\n   The type field specifies the type of this VRRP packet.  The\
    \ only\n   packet type defined in this version of the protocol is:\n   1 ADVERTISEMENT\n\
    \   A packet with unknown type MUST be discarded.\n"
- title: 5.2.3.  Virtual Rtr ID (VRID)
  contents:
  - "5.2.3.  Virtual Rtr ID (VRID)\n   The Virtual Rtr ID field identifies the virtual\
    \ router this packet is\n   reporting status for.\n"
- title: 5.2.4.  Priority
  contents:
  - "5.2.4.  Priority\n   The priority field specifies the sending VRRP router's priority\
    \ for\n   the virtual router.  Higher values equal higher priority.  This field\n\
    \   is an 8-bit unsigned integer field.\n   The priority value for the VRRP router\
    \ that owns the IPvX address\n   associated with the virtual router MUST be 255\
    \ (decimal).\n   VRRP routers backing up a virtual router MUST use priority values\n\
    \   between 1-254 (decimal).  The default priority value for VRRP routers\n  \
    \ backing up a virtual router is 100 (decimal).\n   The priority value zero (0)\
    \ has special meaning, indicating that the\n   current Master has stopped participating\
    \ in VRRP.  This is used to\n   trigger Backup routers to quickly transition to\
    \ Master without having\n   to wait for the current Master to time out.\n"
- title: 5.2.5.  Count IPvX Addr
  contents:
  - "5.2.5.  Count IPvX Addr\n   This is the number of either IPv4 addresses or IPv6\
    \ addresses\n   contained in this VRRP advertisement.  The minimum value is 1.\n"
- title: 5.2.6.  Rsvd
  contents:
  - "5.2.6.  Rsvd\n   This field MUST be set to zero on transmission and ignored on\n\
    \   reception.\n"
- title: 5.2.7.  Maximum Advertisement Interval (Max Adver Int)
  contents:
  - "5.2.7.  Maximum Advertisement Interval (Max Adver Int)\n   The Maximum Advertisement\
    \ Interval is a 12-bit field that indicates\n   the time interval (in centiseconds)\
    \ between ADVERTISEMENTS.  The\n   default is 100 centiseconds (1 second).\n \
    \  Note that higher-priority Master routers with slower transmission\n   rates\
    \ than their Backup routers are unstable.  This is because low-\n   priority nodes\
    \ configured to faster rates could come online and\n   decide they should be Masters\
    \ before they have heard anything from\n   the higher-priority Master with a slower\
    \ rate.  When this happens, it\n   is temporary: once the lower-priority node\
    \ does hear from the higher-\n   priority Master, it will relinquish mastership.\n"
- title: 5.2.8.  Checksum
  contents:
  - "5.2.8.  Checksum\n   The checksum field is used to detect data corruption in\
    \ the VRRP\n   message.\n   The checksum is the 16-bit one's complement of the\
    \ one's complement\n   sum of the entire VRRP message starting with the version\
    \ field and a\n   \"pseudo-header\" as defined in Section 8.1 of [RFC2460].  The\
    \ next\n   header field in the \"pseudo-header\" should be set to 112 (decimal)\n\
    \   for VRRP.  For computing the checksum, the checksum field is set to\n   zero.\
    \  See RFC1071 for more detail [RFC1071].\n"
- title: 5.2.9.  IPvX Address(es)
  contents:
  - "5.2.9.  IPvX Address(es)\n   This refers to one or more IPvX addresses associated\
    \ with the virtual\n   router.  The number of addresses included is specified\
    \ in the \"Count\n   IP Addr\" field.  These fields are used for troubleshooting\n\
    \   misconfigured routers.  If more than one address is sent, it is\n   recommended\
    \ that all routers be configured to send these addresses in\n   the same order\
    \ to make it easier to do this comparison.\n   For IPv4 addresses, this refers\
    \ to one or more IPv4 addresses that\n   are backed up by the virtual router.\n\
    \   For IPv6, the first address must be the IPv6 link-local address\n   associated\
    \ with the virtual router.\n   This field contains either one or more IPv4 addresses,\
    \ or one or more\n   IPv6 addresses, that is, IPv4 and IPv6 MUST NOT both be carried\
    \ in\n   one IPvX Address field.\n"
- title: 6.  Protocol State Machine
  contents:
  - '6.  Protocol State Machine

    '
- title: 6.1.  Parameters Per Virtual Router
  contents:
  - "6.1.  Parameters Per Virtual Router\n   VRID                        Virtual Router\
    \ Identifier.  Configurable\n                               item in the range\
    \ 1-255 (decimal).  There\n                               is no default.\n   Priority\
    \                    Priority value to be used by this VRRP\n                \
    \               router in Master election for this\n                         \
    \      virtual router.  The value of 255\n                               (decimal)\
    \ is reserved for the router that\n                               owns the IPvX\
    \ address associated with the\n                               virtual router.\
    \  The value of 0 (zero) is\n                               reserved for the Master\
    \ router to\n                               indicate it is releasing responsibility\n\
    \                               for the virtual router.  The range 1-254\n   \
    \                            (decimal) is available for VRRP routers\n       \
    \                        backing up the virtual router.  Higher\n            \
    \                   values indicate higher priorities.  The\n                \
    \               default value is 100 (decimal).\n   IPv4_Addresses           \
    \   One or more IPv4 addresses associated\n                               with\
    \ this virtual router.  Configured\n                               item with no\
    \ default.\n   IPv6_Addresses              One or more IPv6 addresses associated\n\
    \                               with this virtual router.  Configured\n      \
    \                         item with no default.  The first address\n         \
    \                      must be the Link-Local address associated\n           \
    \                    with the virtual router.\n   Advertisement_Interval     \
    \ Time interval between ADVERTISEMENTS\n                               (centiseconds).\
    \  Default is 100\n                               centiseconds (1 second).\n \
    \  Master_Adver_Interval       Advertisement interval contained in\n         \
    \                      ADVERTISEMENTS received from the Master\n             \
    \                  (centiseconds).  This value is saved by\n                 \
    \              virtual routers in the Backup state and\n                     \
    \          used to compute Skew_Time and\n                               Master_Down_Interval.\
    \  The initial value\n                               is the same as Advertisement_Interval.\n\
    \   Skew_Time                   Time to skew Master_Down_Interval in\n       \
    \                        centiseconds.  Calculated as\n                   (((256\
    \ - priority) * Master_Adver_Interval) / 256)\n   Master_Down_Interval       \
    \ Time interval for Backup to declare\n                               Master down\
    \ (centiseconds).\n                               Calculated as\n            \
    \                   (3 * Master_Adver_Interval) + Skew_time\n   Preempt_Mode \
    \               Controls whether a (starting or\n                            \
    \   restarting) higher-priority Backup router\n                              \
    \ preempts a lower-priority Master router.\n                               Values\
    \ are True to allow preemption and\n                               False to prohibit\
    \ preemption.  Default is\n                               True.\n            \
    \                   Note: The exception is that the router\n                 \
    \              that owns the IPvX address associated\n                       \
    \        with the virtual router always preempts,\n                          \
    \     independent of the setting of this flag.\n   Accept_Mode               \
    \  Controls whether a virtual router in\n                               Master\
    \ state will accept packets\n                               addressed to the address\
    \ owner's IPvX\n                               address as its own if it is not\
    \ the IPvX\n                               address owner.  The default is False.\n\
    \                               Deployments that rely on, for example,\n     \
    \                          pinging the address owner's IPvX address\n        \
    \                       may wish to configure Accept_Mode to\n               \
    \                True.\n                               Note: IPv6 Neighbor Solicitations\
    \ and\n                               Neighbor Advertisements MUST NOT be\n  \
    \                             dropped when Accept_Mode is False.\n   Virtual_Router_MAC_Address\
    \  The MAC address used for the source MAC\n                               address\
    \ in VRRP advertisements and\n                               advertised in ARP\
    \ responses as the MAC\n                               address to use for IP_Addresses.\n"
- title: 6.2.  Timers
  contents:
  - "6.2.  Timers\n   Master_Down_Timer        Timer that fires when ADVERTISEMENT\
    \ has not\n                            been heard for Master_Down_Interval.\n\
    \   Adver_Timer              Timer that fires to trigger sending of\n        \
    \                    ADVERTISEMENT based on\n                            Advertisement_Interval.\n"
- title: 6.3.  State Transition Diagram
  contents:
  - "6.3.  State Transition Diagram\n                             +---------------+\n\
    \                  +--------->|               |<-------------+\n             \
    \     |          |  Initialize   |              |\n                  |   +------|\
    \               |----------+   |\n                  |   |      +---------------+\
    \          |   |\n                  |   |                                 |  \
    \ |\n                  |   V                                 V   |\n         \
    \ +---------------+                       +---------------+\n          |     \
    \          |---------------------->|               |\n          |    Master  \
    \   |                       |    Backup     |\n          |               |<----------------------|\
    \               |\n          +---------------+                       +---------------+\n"
- title: 6.4.  State Descriptions
  contents:
  - "6.4.  State Descriptions\n   In the state descriptions below, the state names\
    \ are identified by\n   {state-name}, and the packets are identified by all-uppercase\n\
    \   characters.\n   A VRRP router implements an instance of the state machine\
    \ for each\n   virtual router election it is participating in.\n"
- title: 6.4.1.  Initialize
  contents:
  - "6.4.1.  Initialize\n   The purpose of this state is to wait for a Startup event,\
    \ that is, an\n   implementation-defined mechanism that initiates the protocol\
    \ once it\n   has been configured.  The configuration mechanism is out of scope\
    \ of\n   this specification.\n   (100) If a Startup event is received, then:\n\
    \      (105) - If the Priority = 255 (i.e., the router owns the IPvX\n      address\
    \ associated with the virtual router), then:\n         (110) + Send an ADVERTISEMENT\n\
    \         (115) + If the protected IPvX address is an IPv4 address, then:\n  \
    \          (120) * Broadcast a gratuitous ARP request containing the\n       \
    \     virtual router MAC address for each IP address associated\n            with\
    \ the virtual router.\n         (125) + else // IPv6\n            (130) * For\
    \ each IPv6 address associated with the virtual\n            router, send an unsolicited\
    \ ND Neighbor Advertisement with\n            the Router Flag (R) set, the Solicited\
    \ Flag (S) unset, the\n            Override flag (O) set, the target address set\
    \ to the IPv6\n            address of the virtual router, and the target link-layer\n\
    \            address set to the virtual router MAC address.\n         (135) +endif\
    \ // was protected addr IPv4?\n         (140) + Set the Adver_Timer to Advertisement_Interval\n\
    \         (145) + Transition to the {Master} state\n      (150) - else // rtr\
    \ does not own virt addr\n         (155) + Set Master_Adver_Interval to Advertisement_Interval\n\
    \         (160) + Set the Master_Down_Timer to Master_Down_Interval\n        \
    \ (165) + Transition to the {Backup} state\n      (170) -endif // priority was\
    \ not 255\n      (175) endif // startup event was recv\n"
- title: 6.4.2.  Backup
  contents:
  - "6.4.2.  Backup\n   The purpose of the {Backup} state is to monitor the availability\
    \ and\n   state of the Master router.\n   (300) While in this state, a VRRP router\
    \ MUST do the following:\n      (305) - If the protected IPvX address is an IPv4\
    \ address, then:\n         (310) + MUST NOT respond to ARP requests for the IPv4\n\
    \         address(es) associated with the virtual router.\n      (315) - else\
    \ // protected addr is IPv6\n         (320) + MUST NOT respond to ND Neighbor\
    \ Solicitation messages\n         for the IPv6 address(es) associated with the\
    \ virtual router.\n         (325) + MUST NOT send ND Router Advertisement messages\
    \ for the\n         virtual router.\n      (330) -endif // was protected addr\
    \ IPv4?\n      (335) - MUST discard packets with a destination link-layer MAC\n\
    \      address equal to the virtual router MAC address.\n      (340) - MUST NOT\
    \ accept packets addressed to the IPvX address(es)\n      associated with the\
    \ virtual router.\n      (345) - If a Shutdown event is received, then:\n    \
    \     (350) + Cancel the Master_Down_Timer\n         (355) + Transition to the\
    \ {Initialize} state\n      (360) -endif // shutdown recv\n      (365) - If the\
    \ Master_Down_Timer fires, then:\n         (370) + Send an ADVERTISEMENT\n   \
    \      (375) + If the protected IPvX address is an IPv4 address, then:\n     \
    \       (380) * Broadcast a gratuitous ARP request on that interface\n       \
    \     containing the virtual router MAC address for each IPv4\n            address\
    \ associated with the virtual router.\n         (385) + else // ipv6\n       \
    \     (390) * Compute and join the Solicited-Node multicast\n            address\
    \ [RFC4291] for the IPv6 address(es) associated with\n            the virtual\
    \ router.\n            (395) * For each IPv6 address associated with the virtual\n\
    \            router, send an unsolicited ND Neighbor Advertisement with\n    \
    \        the Router Flag (R) set, the Solicited Flag (S) unset, the\n        \
    \    Override flag (O) set, the target address set to the IPv6\n            address\
    \ of the virtual router, and the target link-layer\n            address set to\
    \ the virtual router MAC address.\n         (400) +endif // was protected addr\
    \ ipv4?\n         (405) + Set the Adver_Timer to Advertisement_Interval\n    \
    \     (410) + Transition to the {Master} state\n      (415) -endif // Master_Down_Timer\
    \ fired\n      (420) - If an ADVERTISEMENT is received, then:\n         (425)\
    \ + If the Priority in the ADVERTISEMENT is zero, then:\n            (430) * Set\
    \ the Master_Down_Timer to Skew_Time\n         (440) + else // priority non-zero\n\
    \            (445) * If Preempt_Mode is False, or if the Priority in the\n   \
    \         ADVERTISEMENT is greater than or equal to the local\n            Priority,\
    \ then:\n               (450) @ Set Master_Adver_Interval to Adver Interval\n\
    \               contained in the ADVERTISEMENT\n               (455) @ Recompute\
    \ the Master_Down_Interval\n               (460) @ Reset the Master_Down_Timer\
    \ to\n               Master_Down_Interval\n            (465) * else // preempt\
    \ was true or priority was less\n               (470) @ Discard the ADVERTISEMENT\n\
    \            (475) *endif // preempt test\n         (480) +endif // was priority\
    \ zero?\n      (485) -endif // was advertisement recv?\n   (490) endwhile // Backup\
    \ state\n"
- title: 6.4.3.  Master
  contents:
  - "6.4.3.  Master\n   While in the {Master} state, the router functions as the forwarding\n\
    \   router for the IPvX address(es) associated with the virtual router.\n   Note\
    \ that in the Master state, the Preempt_Mode Flag is not\n   considered.\n   (600)\
    \ While in this state, a VRRP router MUST do the following:\n      (605) - If\
    \ the protected IPvX address is an IPv4 address, then:\n         (610) + MUST\
    \ respond to ARP requests for the IPv4 address(es)\n         associated with the\
    \ virtual router.\n      (615) - else // ipv6\n         (620) + MUST be a member\
    \ of the Solicited-Node multicast\n         address for the IPv6 address(es) associated\
    \ with the virtual\n         router.\n         (625) + MUST respond to ND Neighbor\
    \ Solicitation message for\n         the IPv6 address(es) associated with the\
    \ virtual router.\n         (630) ++ MUST send ND Router Advertisements for the\
    \ virtual\n         router.\n         (635) ++ If Accept_Mode is False:  MUST\
    \ NOT drop IPv6 Neighbor\n         Solicitations and Neighbor Advertisements.\n\
    \      (640) +-endif // ipv4?\n      (645) - MUST forward packets with a destination\
    \ link-layer MAC\n      address equal to the virtual router MAC address.\n   \
    \   (650) - MUST accept packets addressed to the IPvX address(es)\n      associated\
    \ with the virtual router if it is the IPvX address owner\n      or if Accept_Mode\
    \ is True.  Otherwise, MUST NOT accept these\n      packets.\n      (655) - If\
    \ a Shutdown event is received, then:\n         (660) + Cancel the Adver_Timer\n\
    \         (665) + Send an ADVERTISEMENT with Priority = 0\n         (670) + Transition\
    \ to the {Initialize} state\n      (675) -endif // shutdown recv\n      (680)\
    \ - If the Adver_Timer fires, then:\n         (685) + Send an ADVERTISEMENT\n\
    \         (690) + Reset the Adver_Timer to Advertisement_Interval\n      (695)\
    \ -endif // advertisement timer fired\n      (700) - If an ADVERTISEMENT is received,\
    \ then:\n         (705) -+ If the Priority in the ADVERTISEMENT is zero, then:\n\
    \            (710) -* Send an ADVERTISEMENT\n            (715) -* Reset the Adver_Timer\
    \ to Advertisement_Interval\n         (720) -+ else // priority was non-zero\n\
    \            (725) -* If the Priority in the ADVERTISEMENT is greater\n      \
    \      than the local Priority,\n            (730) -* or\n            (735) -*\
    \ If the Priority in the ADVERTISEMENT is equal to\n            the local Priority\
    \ and the primary IPvX Address of the\n            sender is greater than the\
    \ local primary IPvX Address, then:\n               (740) -@ Cancel Adver_Timer\n\
    \               (745) -@ Set Master_Adver_Interval to Adver Interval\n       \
    \        contained in the ADVERTISEMENT\n               (750) -@ Recompute the\
    \ Skew_Time\n               (755) @ Recompute the Master_Down_Interval\n     \
    \          (760) @ Set Master_Down_Timer to Master_Down_Interval\n           \
    \    (765) @ Transition to the {Backup} state\n            (770) * else // new\
    \ Master logic\n               (775) @ Discard ADVERTISEMENT\n            (780)\
    \ *endif // new Master detected\n         (785) +endif // was priority zero?\n\
    \      (790) -endif // advert recv\n   (795) endwhile // in Master\n"
- title: 7.  Sending and Receiving VRRP Packets
  contents:
  - '7.  Sending and Receiving VRRP Packets

    '
- title: 7.1.  Receiving VRRP Packets
  contents:
  - "7.1.  Receiving VRRP Packets\n   The following functions are performed when a\
    \ VRRP packet is received:\n      - If the received packet is an IPv4 packet,\
    \ then:\n         + MUST verify that the IPv4 TTL is 255.\n      - else // ipv6\
    \ recv\n         + MUST verify that the IPv6 Hop Limit is 255.\n      -endif\n\
    \      - MUST verify that the VRRP version is 3.\n      - MUST verify that the\
    \ received packet contains the complete VRRP\n      packet (including fixed fields,\
    \ and IPvX address).\n      - MUST verify the VRRP checksum.\n      - MUST verify\
    \ that the VRID is configured on the receiving\n      interface and the local\
    \ router is not the IPvX address owner\n      (Priority = 255 (decimal)).\n  \
    \ If any one of the above checks fails, the receiver MUST discard the\n   packet,\
    \ SHOULD log the event, and MAY indicate via network management\n   that an error\
    \ occurred.\n      - MAY verify that \"Count IPvX Addrs\" and the list of IPvX\n\
    \      address(es) match the IPvX Address(es) configured for the VRID.\n   If\
    \ the above check fails, the receiver SHOULD log the event and MAY\n   indicate\
    \ via network management that a misconfiguration was detected.\n"
- title: 7.2.  Transmitting VRRP Packets
  contents:
  - "7.2.  Transmitting VRRP Packets\n   The following operations MUST be performed\
    \ when transmitting a VRRP\n   packet:\n      - Fill in the VRRP packet fields\
    \ with the appropriate virtual\n      router configuration state\n      - Compute\
    \ the VRRP checksum\n      - If the protected address is an IPv4 address, then:\n\
    \         + Set the source MAC address to virtual router MAC Address\n       \
    \  + Set the source IPv4 address to interface primary IPv4 address\n      - else\
    \ // ipv6\n         + Set the source MAC address to virtual router MAC Address\n\
    \         + Set the source IPv6 address to interface link-local IPv6\n       \
    \  address\n         -endif\n         - Set the IPvX protocol to VRRP\n      \
    \   - Send the VRRP packet to the VRRP IPvX multicast group\n   Note: VRRP packets\
    \ are transmitted with the virtual router MAC\n   address as the source MAC address\
    \ to ensure that learning bridges\n   correctly determine the LAN segment the\
    \ virtual router is\n   attached to.\n"
- title: 7.3.  Virtual Router MAC Address
  contents:
  - "7.3.  Virtual Router MAC Address\n   The virtual router MAC address associated\
    \ with a virtual router is an\n   IEEE 802 MAC Address in the following format:\n\
    \   IPv4 case: 00-00-5E-00-01-{VRID} (in hex, in Internet-standard bit-\n   order)\n\
    \   The first three octets are derived from the IANA's Organizational\n   Unique\
    \ Identifier (OUI).  The next two octets (00-01) indicate the\n   address block\
    \ assigned to the VRRP for IPv4 protocol. {VRID} is the\n   VRRP Virtual Router\
    \ Identifier.  This mapping provides for up to 255\n   IPv4 VRRP routers on a\
    \ network.\n   IPv6 case: 00-00-5E-00-02-{VRID} (in hex, in Internet-standard\
    \ bit-\n   order)\n   The first three octets are derived from the IANA's OUI.\
    \  The next two\n   octets (00-02) indicate the address block assigned to the\
    \ VRRP for\n   IPv6 protocol. {VRID} is the VRRP Virtual Router Identifier.  This\n\
    \   mapping provides for up to 255 IPv6 VRRP routers on a network.\n"
- title: 7.4.  IPv6 Interface Identifiers
  contents:
  - "7.4.  IPv6 Interface Identifiers\n   IPv6 routers running VRRP MUST create their\
    \ Interface Identifiers in\n   the normal manner (e.g., \"Transmission of IPv6\
    \ Packets over Ethernet\n   Networks\" [RFC2464]).  They MUST NOT use the virtual\
    \ router MAC\n   address to create the Modified Extended Unique Identifier (EUI)-64\n\
    \   identifiers.\n   This VRRP specification describes how to advertise and resolve\
    \ the\n   VRRP router's IPv6 link-local address and other associated IPv6\n  \
    \ addresses into the virtual router MAC address.\n"
- title: 8.  Operational Issues
  contents:
  - '8.  Operational Issues

    '
- title: 8.1.  IPv4
  contents:
  - '8.1.  IPv4

    '
- title: 8.1.1.  ICMP Redirects
  contents:
  - "8.1.1.  ICMP Redirects\n   ICMP redirects may be used normally when VRRP is running\
    \ between a\n   group of routers.  This allows VRRP to be used in environments\
    \ where\n   the topology is not symmetric.\n   The IPv4 source address of an ICMP\
    \ redirect should be the address\n   that the end-host used when making its next-hop\
    \ routing decision.  If\n   a VRRP router is acting as Master for virtual router(s)\
    \ containing\n   addresses it does not own, then it must determine which virtual\n\
    \   router the packet was sent to when selecting the redirect source\n   address.\
    \  One method to deduce the virtual router used is to examine\n   the destination\
    \ MAC address in the packet that triggered the\n   redirect.\n   It may be useful\
    \ to disable redirects for specific cases where VRRP\n   is being used to load-share\
    \ traffic between a number of routers in a\n   symmetric topology.\n"
- title: 8.1.2.  Host ARP Requests
  contents:
  - "8.1.2.  Host ARP Requests\n   When a host sends an ARP request for one of the\
    \ virtual router IPv4\n   addresses, the Virtual Router Master MUST respond to\
    \ the ARP request\n   with an ARP response that indicates the virtual MAC address\
    \ for the\n   virtual router.  Note that the source address of the Ethernet frame\n\
    \   of this ARP response is the physical MAC address of the physical\n   router.\
    \  The Virtual Router Master MUST NOT respond with its physical\n   MAC address\
    \ in the ARP response.  This allows the client to always\n   use the same MAC\
    \ address regardless of the current Master router.\n   When a VRRP router restarts\
    \ or boots, it SHOULD NOT send any ARP\n   messages using its physical MAC address\
    \ for the IPv4 address it owns;\n   it should only send ARP messages that include\
    \ virtual MAC addresses.\n   This may entail the following:\n   o  When configuring\
    \ an interface, Virtual Router Master routers\n      should broadcast a gratuitous\
    \ ARP request containing the virtual\n      router MAC address for each IPv4 address\
    \ on that interface.\n   o  At system boot, when initializing interfaces for VRRP\
    \ operation,\n      delay gratuitous ARP requests and ARP responses until both\
    \ the\n      IPv4 address and the virtual router MAC address are configured.\n\
    \   o  When, for example, ssh access to a particular VRRP router is\n      required,\
    \ an IP address known to belong to that router must be\n      used.\n"
- title: 8.1.3.  Proxy ARP
  contents:
  - "8.1.3.  Proxy ARP\n   If Proxy ARP is to be used on a VRRP router, then the VRRP\
    \ router\n   must advertise the virtual router MAC address in the Proxy ARP\n\
    \   message.  Doing otherwise could cause hosts to learn the real MAC\n   address\
    \ of the VRRP router.\n"
- title: 8.2.  IPv6
  contents:
  - '8.2.  IPv6

    '
- title: 8.2.1.  ICMPv6 Redirects
  contents:
  - "8.2.1.  ICMPv6 Redirects\n   ICMPv6 redirects may be used normally when VRRP\
    \ is running between a\n   group of routers [RFC4443].  This allows VRRP to be\
    \ used in\n   environments where the topology is not symmetric (e.g., the VRRP\n\
    \   routers do not connect to the same destinations).\n   The IPv6 source address\
    \ of an ICMPv6 redirect should be the address\n   that the end-host used when\
    \ making its next-hop routing decision.  If\n   a VRRP router is acting as Master\
    \ for virtual router(s) containing\n   addresses it does not own, then it must\
    \ determine which virtual\n   router the packet was sent to when selecting the\
    \ redirect source\n   address.  A method to deduce the virtual router used is\
    \ to examine\n   the destination MAC address in the packet that triggered the\n\
    \   redirect.\n"
- title: 8.2.2.  ND Neighbor Solicitation
  contents:
  - "8.2.2.  ND Neighbor Solicitation\n   When a host sends an ND Neighbor Solicitation\
    \ message for the virtual\n   router IPv6 address, the Virtual Router Master MUST\
    \ respond to the ND\n   Neighbor Solicitation message with the virtual MAC address\
    \ for the\n   virtual router.  The Virtual Router Master MUST NOT respond with\
    \ its\n   physical MAC address.  This allows the client to always use the same\n\
    \   MAC address regardless of the current Master router.\n   When a Virtual Router\
    \ Master sends an ND Neighbor Solicitation\n   message for a host's IPv6 address,\
    \ the Virtual Router Master MUST\n   include the virtual MAC address for the virtual\
    \ router if it sends a\n   source link-layer address option in the neighbor solicitation\n\
    \   message.  It MUST NOT use its physical MAC address in the source\n   link-layer\
    \ address option.\n   When a VRRP router restarts or boots, it SHOULD NOT send\
    \ any ND\n   messages with its physical MAC address for the IPv6 address it owns;\n\
    \   it should only send ND messages that include virtual MAC addresses.\n   This\
    \ may entail the following:\n   o  When configuring an interface, Virtual Router\
    \ Master routers\n      should send an unsolicited ND Neighbor Advertisement message\n\
    \      containing the virtual router MAC address for the IPv6 address on\n   \
    \   that interface.\n   o  At system boot, when initializing interfaces for VRRP\
    \ operation,\n      all ND Router and Neighbor Advertisements and Solicitation\n\
    \      messages must be delayed until both the IPv6 address and the\n      virtual\
    \ router MAC address are configured.\n   Note that on a restarting Master router\
    \ where the VRRP protected\n   address is the interface address, (that is, priority\
    \ 255) duplicate\n   address detection (DAD) may fail, as the Backup router may\
    \ answer\n   that it owns the address.  One solution is to not run DAD in this\n\
    \   case.\n"
- title: 8.2.3.  Router Advertisements
  contents:
  - "8.2.3.  Router Advertisements\n   When a Backup VRRP router has become Master\
    \ for a virtual router, it\n   is responsible for sending Router Advertisements\
    \ for the virtual\n   router as specified in Section 6.4.3.  The Backup routers\
    \ must be\n   configured to send the same Router Advertisement options as the\n\
    \   address owner.\n   Router Advertisement options that advertise special services\
    \ (e.g.,\n   Home Agent Information Option) that are present in the address owner\n\
    \   should not be sent by the address owner unless the Backup routers are\n  \
    \ prepared to assume these services in full and have a complete and\n   synchronized\
    \ database for this service.\n"
- title: 8.3.  IPvX
  contents:
  - '8.3.  IPvX

    '
- title: 8.3.1.  Potential Forwarding Loop
  contents:
  - "8.3.1.  Potential Forwarding Loop\n   If it is not the address owner, a VRRP\
    \ router SHOULD NOT forward\n   packets addressed to the IPvX address for which\
    \ it becomes Master.\n   Forwarding these packets would result in unnecessary\
    \ traffic.  Also,\n   in the case of LANs that receive packets they transmit (e.g.,\
    \ Token\n   Ring), this can result in a forwarding loop that is only terminated\n\
    \   when the IPvX TTL expires.\n   One such mechanism for VRRP routers is to add/delete\
    \ a reject host\n   route for each adopted IPvX address when transitioning to/from\
    \ MASTER\n   state.\n"
- title: 8.3.2.  Recommendations Regarding Setting Priority Values
  contents:
  - "8.3.2.  Recommendations Regarding Setting Priority Values\n   A priority value\
    \ of 255 designates a particular router as the \"IPvX\n   address owner\".  Care\
    \ must be taken not to configure more than one\n   router on the link in this\
    \ way for a single VRID.\n   Routers with priority 255 will, as soon as they start\
    \ up, preempt all\n   lower-priority routers.  No more than one router on the\
    \ link is to be\n   configured with priority 255, especially if preemption is\
    \ set.  If no\n   router has this priority, and preemption is disabled, then no\n\
    \   preemption will occur.\n   When there are multiple Backup routers, their priority\
    \ values should\n   be uniformly distributed.  For example, if one Backup router\
    \ has the\n   default priority of 100 and another Backup Router is added, a\n\
    \   priority of 50 would be a better choice for it than 99 or 100, in\n   order\
    \ to facilitate faster convergence.\n"
- title: 8.4.  VRRPv3 and VRRPv2 Interoperation
  contents:
  - '8.4.  VRRPv3 and VRRPv2 Interoperation

    '
- title: 8.4.1.  Assumptions
  contents:
  - "8.4.1.  Assumptions\n   1. VRRPv2 and VRRPv3 interoperation is optional.\n  \
    \ 2. Mixing VRRPv2 and VRRPv3 should only be done when transitioning\n      from\
    \ VRRPv2 to VRRPv3.  Mixing the two versions should not be\n      considered a\
    \ permanent solution.\n"
- title: 8.4.2.  VRRPv3 Support of VRRPv2
  contents:
  - "8.4.2.  VRRPv3 Support of VRRPv2\n   As mentioned above, this support is intended\
    \ for upgrade scenarios\n   and is NOT recommended for permanent deployments.\n\
    \   An implementation MAY implement a configuration flag that tells it to\n  \
    \ listen for and send both VRRPv2 and VRRPv3 advertisements.\n   When a virtual\
    \ router is configured this way and is the Master, it\n   MUST send both types\
    \ at the configured rate, even if sub-second.\n   When a virtual router is configured\
    \ this way and is the Backup, it\n   should time out based on the rate advertised\
    \ by the Master; in the\n   case of a VRRPv2 Master, this means it must translate\
    \ the timeout\n   value it receives (in seconds) into centiseconds.  Also, a Backup\n\
    \   should ignore VRRPv2 advertisements from the current Master if it is\n   also\
    \ receiving VRRPv3 packets from it.  It MAY report when a VRRPv3\n   Master is\
    \ *not* sending VRRPv2 packets: that suggests they don't\n   agree on whether\
    \ they're supporting VRRPv2 routers.\n"
- title: 8.4.3.  VRRPv3 Support of VRRPv2 Considerations
  contents:
  - '8.4.3.  VRRPv3 Support of VRRPv2 Considerations

    '
- title: 8.4.3.1.  Slow, High-Priority Masters
  contents:
  - "8.4.3.1.  Slow, High-Priority Masters\n   See also Section 5.2.7, \"Maximum Advertisement\
    \ Interval\n   (Max Adver Int)\".\n   The VRRPv2 Master router interacting with\
    \ a sub-second VRRPv3 Backup\n   router is the most important example of this.\n\
    \   A VRRPv2 implementation should not be given a higher priority than a\n   VRRPv2/VRRPv3\
    \ implementation it is interacting with if the VRRPv2/\n   VRRPv3 rate is sub-second.\n"
- title: 8.4.3.2.  Overwhelming VRRPv2 Backups
  contents:
  - "8.4.3.2.  Overwhelming VRRPv2 Backups\n   It seems possible that a VRRPv3 Master\
    \ router sending at centisecond\n   rates could potentially overwhelm a VRRPv2\
    \ Backup router with\n   potentially unclear results.\n   In this upgrade case,\
    \ a deployment should initially run the VRRPv3\n   Master routers with lower frequencies\
    \ (e.g., 100 centiseconds) until\n   the VRRPv2 routers are upgraded.  Then, once\
    \ the deployment has\n   convinced itself that VRRPv3 is working properly, the\
    \ VRRPv2 support\n   may be unconfigured and then the desired sub-second rates\
    \ configured.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   VRRP for IPvX does not currently include any\
    \ type of authentication.\n   Earlier versions of the VRRP (for IPv4) specification\
    \ included\n   several types of authentication ranging from none to strong.\n\
    \   Operational experience and further analysis determined that these did\n  \
    \ not provide sufficient security to overcome the vulnerability of\n   misconfigured\
    \ secrets, causing multiple Masters to be elected.  Due\n   to the nature of the\
    \ VRRP protocol, even if VRRP messages are\n   cryptographically protected, it\
    \ does not prevent hostile nodes from\n   behaving as if they are a VRRP Master,\
    \ creating multiple Masters.\n   Authentication of VRRP messages could have prevented\
    \ a hostile node\n   from causing all properly functioning routers from going\
    \ into Backup\n   state.  However, having multiple Masters can cause as much disruption\n\
    \   as no routers, which authentication cannot prevent.  Also, even if a\n   hostile\
    \ node could not disrupt VRRP, it can disrupt ARP and create\n   the same effect\
    \ as having all routers go into Backup.\n   Some L2 switches provide the capability\
    \ to filter out, for example,\n   ARP and/or ND messages from end-hosts on a switch-port\
    \ basis.  This\n   mechanism could also filter VRRP messages from switch ports\n\
    \   associated with end-hosts and can be considered for deployments with\n   untrusted\
    \ hosts.\n   It should be noted that these attacks are not worse and are a subset\n\
    \   of the attacks that any node attached to a LAN can do independently\n   of\
    \ VRRP.  The kind of attacks a malicious node on a LAN can do\n   include promiscuously\
    \ receiving packets for any router's MAC address;\n   sending packets with the\
    \ router's MAC address as the source MAC\n   address in the L2 header to tell\
    \ the L2 switches to send packets\n   addressed to the router to the malicious\
    \ node instead of the router;\n   send redirects to tell the hosts to send their\
    \ traffic somewhere\n   else; send unsolicited ND replies; answer ND requests;\
    \ etc.  All of\n   this can be done independently of implementing VRRP.  VRRP\
    \ does not\n   add to these vulnerabilities.\n   Independent of any authentication\
    \ type, VRRP includes a mechanism\n   (setting TTL = 255, checking on receipt)\
    \ that protects against VRRP\n   packets being injected from another remote network.\
    \  This limits most\n   vulnerabilities to local attacks.\n   VRRP does not provide\
    \ any confidentiality.  Confidentiality is not\n   necessary for the correct operation\
    \ of VRRP, and there is no\n   information in the VRRP messages that must be kept\
    \ secret from other\n   nodes on the LAN.\n   In the context of IPv6 operation,\
    \ if SEcure Neighbor Discovery (SEND)\n   is deployed, VRRP is compatible with\
    \ the \"trust anchor\" and \"trust\n   anchor or cga\" modes of SEND [RFC3971].\
    \  The SEND configuration needs\n   to give the Master and Backup routers the\
    \ same prefix delegation in\n   the certificates so that Master and Backup routers\
    \ advertise the same\n   set of subnet prefixes.  However, the Master and Backup\
    \ routers\n   should have their own key pairs to avoid private key sharing.\n"
- title: 10.  Contributors and Acknowledgments
  contents:
  - "10.  Contributors and Acknowledgments\n   The editor would like to thank V. Ullanatt\
    \ for his review of an early\n   version.  This document consists of very little\
    \ new material (there\n   is some new text in Appendix A) and was created by merging\
    \ and\n   \"xml-izing\" [VRRP-IPv6] and [RFC3768], and then adding in the changes\n\
    \   discussed recently on the Virtual Router Redundancy Protocol working\n   group's\
    \ mailing list.  R. Hinden is the author and J. Cruz the editor\n   of the former.\
    \  The contributors for the latter appear below.\n   The IPv6 text in this specification\
    \ is based on [RFC2338].  The\n   authors of RFC2338 are S. Knight, D. Weaver,\
    \ D. Whipple, R. Hinden,\n   D. Mitzel, P. Hunt, P. Higginson, M. Shand, and A.\
    \ Lindem.\n   The author of [VRRP-IPv6] would also like to thank Erik Nordmark,\n\
    \   Thomas Narten, Steve Deering, Radia Perlman, Danny Mitzel, Mukesh\n   Gupta,\
    \ Don Provan, Mark Hollinger, John Cruz, and Melissa Johnson for\n   their helpful\
    \ suggestions.\n   The IPv4 text in this specification is based on [RFC3768].\
    \  The\n   authors of that specification would like to thank Glen Zorn, Michael\n\
    \   Lane, Clark Bremer, Hal Peterson, Tony Li, Barbara Denny, Joel\n   Halpern,\
    \ Steve Bellovin, Thomas Narten, Rob Montgomery, Rob Coltun,\n   Radia Perlman,\
    \ Russ Housley, Harald Alvestrand, Steve Bellovin, Ned\n   Freed, Ted Hardie,\
    \ Russ Housley, Bert Wijnen, Bill Fenner, and Alex\n   Zinin for their comments\
    \ and suggestions.\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   IANA has assigned an IPv6 link-local scope multicast\
    \ address for VRRP\n   for IPv6.  The IPv6 multicast address is as follows:\n\
    \      FF02:0:0:0:0:0:0:12\n   The values assigned address should be entered into\
    \ Section 5.1.2.2.\n   The IANA has reserved a block of IANA Ethernet unicast\
    \ addresses for\n   VRRP for IPv6 in the range\n      00-00-5E-00-02-00 to 00-00-5E-00-02-FF\
    \ (in hex)\n   Similar assignments are documented at:\n      http://www.iana.org\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [ISO.10038.1993]  International Organization\
    \ for Standardization,\n                     \"Information technology - Telecommunications\
    \ and\n                     information exchange between systems - Local area\n\
    \                     networks - Media access control (MAC) bridges\", ISO\n \
    \                    Standard 10038, 1993.\n   [RFC2119]         Bradner, S.,\
    \ \"Key words for use in RFCs to Indicate\n                     Requirement Levels\"\
    , BCP 14, RFC 2119, March 1997.\n   [RFC2460]         Deering, S. and R. Hinden,\
    \ \"Internet Protocol,\n                     Version 6 (IPv6) Specification\"\
    , RFC 2460,\n                     December 1998.\n   [RFC3768]         Hinden,\
    \ R., \"Virtual Router Redundancy Protocol\n                     (VRRP)\", RFC\
    \ 3768, April 2004.\n   [RFC4291]         Hinden, R. and S. Deering, \"IP Version\
    \ 6 Addressing\n                     Architecture\", RFC 4291, February 2006.\n\
    \   [RFC4443]         Conta, A., Deering, S., and M. Gupta, Ed.,\n           \
    \          \"Internet Control Message Protocol (ICMPv6) for the\n            \
    \         Internet Protocol Version 6 (IPv6) Specification\",\n              \
    \       RFC 4443, March 2006.\n   [RFC4861]         Narten, T., Nordmark, E.,\
    \ Simpson, W., and H.\n                     Soliman, \"Neighbor Discovery for\
    \ IP version 6\n                     (IPv6)\", RFC 4861, September 2007.\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [VRRP-IPv6]       Hinden, R. and J. Cruz, \"\
    Virtual Router Redundancy\n                     Protocol for IPv6\", Work in Progress,\
    \ March 2007.\n   [IPSTB]           Higginson, P. and M. Shand, \"Development\
    \ of Router\n                     Clusters to Provide Fast Failover in IP Networks\"\
    ,\n                     Digital Technical Journal, Volume 9 Number 3,\n      \
    \               Winter 1997.\n   [IPX]             Novell Incorporated, \"IPX\
    \ Router Specification\n                     Version 1.10\", October 1992.\n \
    \  [RFC1071]         Braden, R., Borman, D., Partridge, C., and W.\n         \
    \            Plummer, \"Computing the Internet checksum\", RFC\n             \
    \        1071, September 1988.\n   [RFC1256]         Deering, S., Ed., \"ICMP\
    \ Router Discovery Messages\",\n                     RFC 1256, September 1991.\n\
    \   [RFC1469]         Pusateri, T., \"IP Multicast over Token-Ring Local\n   \
    \                  Area Networks\", RFC 1469, June 1993.\n   [RFC2131]       \
    \  Droms, R., \"Dynamic Host Configuration Protocol\",\n                     RFC\
    \ 2131, March 1997.\n   [RFC2281]         Li, T., Cole, B., Morton, P., and D.\
    \ Li, \"Cisco Hot\n                     Standby Router Protocol (HSRP)\", RFC\
    \ 2281, March\n                     1998.\n   [RFC2328]         Moy, J., \"OSPF\
    \ Version 2\", STD 54, RFC 2328, April\n                     1998.\n   [RFC2338]\
    \         Knight, S., Weaver, D., Whipple, D., Hinden, R.,\n                 \
    \    Mitzel, D., Hunt, P., Higginson, P., Shand, M., and\n                   \
    \  A. Lindem, \"Virtual Router Redundancy Protocol\",\n                     RFC\
    \ 2338, April 1998.\n   [RFC2453]         Malkin, G., \"RIP Version 2\", STD 56,\
    \ RFC 2453,\n                     November 1998.\n   [RFC2464]         Crawford,\
    \ M., \"Transmission of IPv6 Packets over\n                     Ethernet Networks\"\
    , RFC 2464, December 1998.\n   [RFC3971]         Arkko, J., Ed., Kempf, J., Zill,\
    \ B., and P.\n                     Nikander, \"SEcure Neighbor Discovery (SEND)\"\
    , RFC\n                     3971, March 2005.\n   [TKARCH]          IBM Incorporated,\
    \ \"IBM Token-Ring Network,\n                     Architecture Specification,\
    \ Publication\n                     SC30-3374-02, Third Edition\", September 1989.\n"
- title: Appendix A.  Operation over FDDI, Token Ring, and ATM LANE
  contents:
  - 'Appendix A.  Operation over FDDI, Token Ring, and ATM LANE

    '
- title: A.1.  Operation over FDDI
  contents:
  - "A.1.  Operation over FDDI\n   FDDI interfaces remove from the FDDI ring frames\
    \ that have a source\n   MAC address matching the device's hardware address. \
    \ Under some\n   conditions, such as router isolations, ring failures, protocol\n\
    \   transitions, etc., VRRP may cause there to be more than one Master\n   router.\
    \  If a Master router installs the virtual router MAC address\n   as the hardware\
    \ address on a FDDI device, then other Masters'\n   ADVERTISEMENTS will be removed\
    \ from the ring during the Master\n   convergence, and convergence will fail.\n\
    \   To avoid this, an implementation SHOULD configure the virtual router\n   MAC\
    \ address by adding a unicast MAC filter in the FDDI device, rather\n   than changing\
    \ its hardware MAC address.  This will prevent a Master\n   router from removing\
    \ any ADVERTISEMENTS it did not originate.\n"
- title: A.2.  Operation over Token Ring
  contents:
  - "A.2.  Operation over Token Ring\n   Token Ring has several characteristics that\
    \ make running VRRP\n   difficult.  These include the following:\n   o  In order\
    \ to switch to a new Master located on a different bridge\n      Token-Ring segment\
    \ from the previous Master when using source-\n      route bridges, a mechanism\
    \ is required to update cached source-\n      route information.\n   o  No general\
    \ multicast mechanism is supported across old and new\n      Token-Ring adapter\
    \ implementations.  While many newer Token-Ring\n      adapters support group\
    \ addresses, Token-Ring functional-address\n      support is the only generally\
    \ available multicast mechanism.  Due\n      to the limited number of Token-Ring\
    \ functional addresses, these\n      may collide with other usage of the same\
    \ Token-Ring functional\n      addresses.\n   Due to these difficulties, the preferred\
    \ mode of operation over Token\n   Ring will be to use a Token-Ring functional\
    \ address for the VRID\n   virtual MAC address.  Token-Ring functional addresses\
    \ have the two\n   high-order bits in the first MAC address octet set to B'1'.\
    \  They\n   range from 03-00-00-00-00-80 to 03-00-02-00-00-00 (canonical format).\n\
    \   However, unlike multicast addresses, there is only one unique\n   functional\
    \ address per bit position.  The functional addresses\n   03-00-00-10-00-00 through\
    \ 03-00-02-00-00-00 are reserved by the\n   Token-Ring Architecture [TKARCH] for\
    \ user-defined applications.\n   However, since there are only 12 user-defined\
    \ Token-Ring functional\n   addresses, there may be other non-IPvX protocols using\
    \ the same\n   functional address.  Since the Novell IPX [IPX] protocol uses the\n\
    \   03-00-00-10-00-00 functional address, operation of VRRP over Token\n   Ring\
    \ will avoid use of this functional address.  In general, Token-\n   Ring VRRP\
    \ users will be responsible for resolution of other user-\n   defined Token-Ring\
    \ functional address conflicts.\n   VRIDs are mapped directly to Token-Ring functional\
    \ addresses.  In\n   order to decrease the likelihood of functional-address conflicts,\n\
    \   allocation will begin with the largest functional address.  Most non-\n  \
    \ IPvX protocols use the first or first couple user-defined functional\n   addresses,\
    \ and it is expected that VRRP users will choose VRIDs\n   sequentially, starting\
    \ with 1.\n         VRID      Token-Ring Functional Address\n         ----   \
    \   -----------------------------\n            1             03-00-02-00-00-00\n\
    \            2             03-00-04-00-00-00\n            3             03-00-08-00-00-00\n\
    \            4             03-00-10-00-00-00\n            5             03-00-20-00-00-00\n\
    \            6             03-00-40-00-00-00\n            7             03-00-80-00-00-00\n\
    \            8             03-00-00-01-00-00\n            9             03-00-00-02-00-00\n\
    \           10             03-00-00-04-00-00\n           11             03-00-00-08-00-00\n\
    \   Or, more succinctly, octets 3 and 4 of the functional address are\n   equal\
    \ to (0x4000 >> (VRID - 1)) in non-canonical format.\n   Since a functional address\
    \ cannot be used as a MAC-level source\n   address, the real MAC address is used\
    \ as the MAC source address in\n   VRRP advertisements.  This is not a problem\
    \ for bridges, since\n   packets addressed to functional addresses will be sent\
    \ on the\n   spanning-tree explorer path [ISO.10038.1993].\n   The functional-address\
    \ mode of operation MUST be implemented by\n   routers supporting VRRP on Token\
    \ Ring.\n   Additionally, routers MAY support the unicast mode of operation to\n\
    \   take advantage of newer Token-Ring adapter implementations that\n   support\
    \ non-promiscuous reception for multiple unicast MAC addresses\n   and to avoid\
    \ both the multicast traffic and usage conflicts\n   associated with the use of\
    \ Token-Ring functional addresses.  Unicast\n   mode uses the same mapping of\
    \ VRIDs to virtual MAC addresses as\n   Ethernet.  However, one important difference\
    \ exists.  ND\n   request/reply packets contain the virtual MAC address as the\
    \ source\n   MAC address.  The reason for this is that some Token-Ring driver\n\
    \   implementations keep a cache of MAC address/source-routing\n   information\
    \ independent of the ND cache.\n   Hence, these implementations have to receive\
    \ a packet with the\n   virtual MAC address as the source address in order to\
    \ transmit to\n   that MAC address in a source-route-bridged network.\n   Unicast\
    \ mode on Token Ring has one limitation that should be\n   considered.  If there\
    \ are VRID routers on different source-route-\n   bridge segments, and there are\
    \ host implementations that keep their\n   source-route information in the ND\
    \ cache and do not listen to\n   gratuitous NDs, these hosts will not update their\
    \ ND source-route\n   information correctly when a switchover occurs.  The only\
    \ possible\n   solution is to put all routers with the same VRID on the same source-\n\
    \   route-bridge segment and use techniques to prevent that bridge\n   segment\
    \ from being a single point of failure.  These techniques are\n   beyond the scope\
    \ of this document.\n   For both the multicast and unicast mode of operation,\
    \ VRRP\n   advertisements sent to 224.0.0.18 should be encapsulated as described\n\
    \   in [RFC1469].\n"
- title: A.3.  Operation over ATM LANE
  contents:
  - "A.3.  Operation over ATM LANE\n   Operation of VRRP over ATM LANE on routers\
    \ with ATM LANE interfaces\n   and/or routers behind proxy LAN Emulation Clients\
    \ (LECs) are beyond\n   the scope of this document.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Stephen Nadas (editor)\n   Ericsson\n   900 Chelmsford St.,\
    \ T3 4th Floor\n   Lowell, MA  01851\n   USA\n   Phone: +1 978 275 7448\n   EMail:\
    \ stephen.nadas@ericsson.com\n"
