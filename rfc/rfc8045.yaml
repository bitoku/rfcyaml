- contents:
  - '       RADIUS Extensions for IP Port Configuration and Reporting

    '
  title: __initial_text__
- contents:
  - "Abstract\n   This document defines three new RADIUS attributes.  For devices
    that\n   implement IP port ranges, these attributes are used to communicate\n
    \  with a RADIUS server in order to configure and report IP transport\n   ports
    as well as mapping behavior for specific hosts.  This mechanism\n   can be used
    in various deployment scenarios such as Carrier-Grade\n   NAT, IPv4/IPv6 translators,
    Provider WLAN gateway, etc.  This\n   document defines a mapping between some
    RADIUS attributes and IP Flow\n   Information Export (IPFIX) Information Element
    identifiers.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    7841.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc8045.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2017 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n
    \  2. Terminology .....................................................5\n      2.1.
    Requirements Language ......................................6\n   3. Extensions
    of RADIUS Attributes and TLVs ........................7\n      3.1. Extended Attributes
    for IP Ports ...........................7\n           3.1.1. IP-Port-Limit-Info
    Attribute ........................7\n           3.1.2. IP-Port-Range Attribute
    .............................9\n           3.1.3. IP-Port-Forwarding-Map Attribute
    ...................12\n      3.2. RADIUS TLVs for IP Ports ..................................15\n
    \          3.2.1. IP-Port-Type TLV ...................................16\n           3.2.2.
    IP-Port-Limit TLV ..................................17\n           3.2.3. IP-Port-Ext-IPv4-Addr
    TLV ..........................18\n           3.2.4. IP-Port-Int-IPv4-Addr TLV
    ..........................19\n           3.2.5. IP-Port-Int-IPv6-Addr TLV ..........................20\n
    \          3.2.6. IP-Port-Int-Port TLV ...............................21\n           3.2.7.
    IP-Port-Ext-Port TLV ...............................22\n           3.2.8. IP-Port-Alloc
    TLV ..................................23\n           3.2.9. IP-Port-Range-Start
    TLV ............................24\n           3.2.10. IP-Port-Range-End TLV .............................25\n
    \          3.2.11. IP-Port-Local-Id TLV ..............................25\n   4.
    Applications, Use Cases, and Examples ..........................27\n      4.1.
    Managing CGN Port Behavior Using RADIUS ...................27\n           4.1.1.
    Configure IP Port Limit for a User .................27\n           4.1.2. Report
    IP Port Allocation/Deallocation .............29\n           4.1.3. Configure Port
    Forwarding Mapping ..................31\n           4.1.4. An Example .........................................33\n
    \     4.2. Report Assigned Port Set for a Visiting UE ................35\n   5.
    Table of Attributes ............................................36\n   6. Security
    Considerations ........................................36\n   7. IANA Considerations
    ............................................37\n      7.1. New IPFIX Information
    Elements ............................37\n      7.2. New RADIUS Attributes .....................................38\n
    \     7.3. New RADIUS TLVs ...........................................38\n   8.
    References .....................................................39\n      8.1.
    Normative References ......................................39\n      8.2. Informative
    References ....................................40\n   Acknowledgments ...................................................43\n
    \  Authors' Addresses ................................................43\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   In a broadband network, customer information is usually
    stored on a\n   RADIUS server [RFC2865].  At the time when a user initiates an
    IP\n   connection request, if this request is authorized, the RADIUS server\n
    \  will populate the user's configuration information to the Network\n   Access
    Server (NAS), which is often referred to as a Broadband\n   Network Gateway (BNG)
    in broadband access networks.  The Carrier-\n   Grade NAT (CGN) function may also
    be implemented on the BNG.  Within\n   this document, the CGN may perform Network
    Address Translation from\n   IPv4 Clients to IPv4 Servers (NAT44) [RFC3022], NAT
    from IPv6 Clients\n   to IPv4 Servers (NAT64) [RFC6146], or Dual-Stack Lite Address
    Family\n   Transition Router (AFTR) [RFC6333] function.  In such case, the CGN\n
    \  IP transport port (e.g., TCP/UDP port) mapping behaviors can be part\n   of
    the configuration information sent from the RADIUS server to the\n   NAS/BNG.
    \ As part of the accounting information sent from the NAS/BNG\n   to a RADIUS
    server, the NAS/BNG may also report the IP port mapping\n   behavior applied by
    the CGN to a user session.\n   When IP packets traverse the CGN, it performs mapping
    on the IP\n   transport (e.g., TCP/UDP) source port as required.  An IP transport\n
    \  source port, along with a source IP address, destination IP address,\n   destination
    port, and protocol identifier, if applicable, uniquely\n   identify a mapping.
    \ Since the number space of IP transport ports in\n   the CGN's external realm
    is shared among multiple users assigned with\n   the same IPv4 address, the total
    number of a user's simultaneous IP\n   mappings is likely to be subject to a port
    quota (see Section 5 of\n   [RFC6269]).\n   The attributes defined in this document
    may also be used to report\n   the assigned port range in some deployments, such
    as Provider WLAN\n   [WIFI-SERVICES].  For example, a visiting host can be managed
    by\n   Customer Premises Equipment (CPE), which will need to report the\n   assigned
    port range to the service platform.  This is required for\n   identification purposes
    (see TR-146 [TR-146] for more details).\n   This document proposes three new attributes
    as RADIUS protocol\n   extensions; they are used for separate purposes, as follows:\n
    \  1.  IP-Port-Limit-Info: This attribute may be carried in a RADIUS\n       Access-Accept,
    Access-Request, Accounting-Request, or CoA-Request\n       packet.  The purpose
    of this attribute is to limit the total\n       number of IP source transport
    ports allocated to a user and\n       associated with one or more IPv4 or IPv6
    addresses.\n   2.  IP-Port-Range: This attribute may be carried in a RADIUS\n
    \      Accounting-Request packet.  The purpose of this attribute is for\n       an
    address-sharing device (e.g., a CGN) to report to the RADIUS\n       server the
    range of IP source transport ports that have been\n       allocated or deallocated
    for a user.  The port range is bound to\n       an external IPv4 address.\n   3.
    \ IP-Port-Forwarding-Map: This attribute may be carried in RADIUS\n       Access-Accept,
    Access-Request, Accounting-Request, or CoA-Request\n       packet.  The purpose
    of this attribute is to specify how an IP\n       internal source transport port,
    together with its internal IPv4\n       or IPv6 address, are mapped to an external
    source transport port\n       along with the external IPv4 address.\n   IPFIX
    Information Elements [RFC7012] can be used for IP flow\n   identification and
    representation over RADIUS.  This document\n   provides a mapping between some
    RADIUS TLVs and IPFIX Information\n   Element identifiers.  A new IPFIX Information
    Element is defined by\n   this document (see Section 3.2.2).\n   IP protocol numbers
    (refer to [ProtocolNumbers]) can be used for\n   identification of IP transport
    protocols (e.g., TCP [RFC793], UDP\n   [RFC768], Datagram Congestion Control Protocol
    (DCCP) [RFC4340], and\n   Stream Control Transmission Protocol (SCTP) [RFC4960])
    that are\n   associated with some RADIUS attributes.\n   This document focuses
    on IPv4 address sharing.  Mechanisms for IPv6\n   prefix sharing (e.g., IPv6-to-IPv6
    Network Prefix Translation\n   (NPTv6)) are out of scope.\n"
  title: 1.  Introduction
- contents:
  - "2.  Terminology\n   This document makes use of the following terms:\n   o  IP
    Port: This refers to an IP transport port (e.g., a TCP port\n      number or UDP
    port number).\n   o  IP Port Type: This refers to the IP transport protocol as\n
    \     indicated by the IP transport protocol number.  Refer to\n      [ProtocolNumbers].\n
    \  o  IP Port Limit: This denotes the maximum number of IP ports for a\n      specific
    (or all) IP transport protocol(s) that a device\n      supporting port ranges
    can use when performing port number\n      mappings for a specific user/host.
    \ Note that this limit is\n      usually associated with one or more IPv4/IPv6
    addresses.\n   o  IP Port Range: This specifies a set of contiguous IP ports\n
    \     indicated by the lowest numerical number and the highest numerical\n      number,
    inclusively.\n   o  Internal IP Address: This refers to the IP address that is
    used by\n      a host as a source IP address in an outbound IP packet sent\n      towards
    a device supporting port ranges in the internal realm.\n      The internal IP
    address may be IPv4 or IPv6.\n   o  External IP Address: This refers to the IP
    address that is used as\n      a source IP address in an outbound IP packet after
    traversing a\n      device supporting port ranges in the external realm.  This\n
    \     document assumes that the external IP address is an IPv4 address.\n   o
    \ Internal Port: This is an IP transport port that is allocated by a\n      host
    or application behind an address-sharing device for an\n      outbound IP packet
    in the internal realm.\n   o  External Port: This is an IP transport port that
    is allocated by\n      an address-sharing device upon receiving an outbound IP
    packet in\n      the internal realm and is used to replace the internal port that\n
    \     is allocated by a user or application.\n   o  External Realm: This refers
    to the networking segment where\n      external IP addresses are used as source
    addresses of outbound\n      packets forwarded by an address-sharing device.\n
    \  o  Internal Realm: This refers to the networking segment that is\n      behind
    an address-sharing device and where internal IP addresses\n      are used.\n   o
    \ Mapping: This denotes a relationship between an internal IP\n      address,
    internal port, and protocol, as well as an external IP\n      address, external
    port, and protocol.\n   o  Address-Sharing Device: This is a device that is capable
    of\n      sharing an IPv4 address among multiple users.  A typical example\n      of
    this device is a CGN, CPE, Provider WLAN gateway, etc.\n"
  - contents:
    - "2.1.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\",
      \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\",
      and \"OPTIONAL\" in this\n   document are to be interpreted as described in
      RFC 2119 [RFC2119].\n"
    title: 2.1.  Requirements Language
  title: 2.  Terminology
- contents:
  - "3.  Extensions of RADIUS Attributes and TLVs\n   These three new attributes are
    defined in the following subsections:\n   1.  IP-Port-Limit-Info Attribute\n   2.
    \ IP-Port-Range Attribute\n   3.  IP-Port-Forwarding-Map Attribute\n   All these
    attributes are allocated from the RADIUS \"Extended Type\"\n   code space per
    [RFC6929].\n   These attributes and their embedded TLVs (refer to Section 3.2)
    are\n   defined with globally unique names and follow the guidelines in\n   Section
    2.7.1 of [RFC6929].\n   In all the figures describing the RADIUS attributes and
    TLV formats\n   in the following subsections, the fields are transmitted from
    left to\n   right.\n"
  - contents:
    - '3.1.  Extended Attributes for IP Ports

      '
    - contents:
      - "3.1.1.  IP-Port-Limit-Info Attribute\n   This attribute is of type \"tlv\"
        as defined in the RADIUS Protocol\n   Extensions [RFC6929].  It contains some
        sub-attributes, and the\n   requirements are as follows:\n   o  The IP-Port-Limit-Info
        Attribute MAY contain the IP-Port-Type TLV\n      (see Section 3.2.1).\n   o
        \ The IP-Port-Limit-Info Attribute MUST contain the\n      IP-Port-Limit TLV
        (see Section 3.2.2).\n   o  The IP-Port-Limit-Info Attribute MAY contain the\n
        \     IP-Port-Ext-IPv4-Addr TLV (see Section 3.2.3).\n   The IP-Port-Limit-Info
        Attribute specifies the maximum number of IP\n   ports, as indicated in IP-Port-Limit
        TLV, of a specific IP transport\n   protocol, as indicated in IP-Port-Type
        TLV, and associated with a\n   given IPv4 address, as indicated in IP-Port-Ext-IPv4-Addr
        TLV, for an\n   end user.\n   Note that when IP-Port-Type TLV is not included
        as part of the\n   IP-Port-Limit-Info Attribute, the port limit applies to
        all IP\n   transport protocols.\n   Note also that when IP-Port-Ext-IPv4-Addr
        TLV is not included as part\n   of the IP-Port-Limit-Info Attribute, the port
        limit applies to all\n   the IPv4 addresses managed by the address-sharing
        device, e.g., a CGN\n   or NAT64 device.\n   The IP-Port-Limit-Info Attribute
        MAY appear in an Access-Accept\n   packet.  It MAY also appear in an Access-Request
        packet as a\n   preferred maximum number of IP ports indicated by the device\n
        \  supporting port ranges co-located with the NAS, e.g., a CGN or NAT64.\n
        \  The IP-Port-Limit-Info Attribute MAY appear in a CoA-Request packet.\n
        \  The IP-Port-Limit-Info Attribute MAY appear in an Accounting-Request\n
        \  packet.\n   The IP-Port-Limit-Info Attribute MUST NOT appear in any other
        RADIUS\n   packet.\n   The format of the IP-Port-Limit-Info Attribute is shown
        in Figure 1.\n    0                   1                   2                   3\n
        \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |      Type     |     Length    | Extended-Type |    Value ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 1\n   Type\n      241\n   Length\n
        \     This field indicates the total length in octets of all fields of\n      this
        attribute, including the Type, Length, Extended-Type, and the\n      entire
        length of the embedded TLVs.\n   Extended-Type\n      5\n   Value\n      This
        field contains a set of TLVs as follows:\n      IP-Port-Type TLV\n         This
        TLV contains a value that indicates the IP port type.\n         Refer to Section
        3.2.1.\n      IP-Port-Limit TLV\n         This TLV contains the maximum number
        of IP ports of a specific\n         IP port type and associated with a given
        IPv4 address for an\n         end user.  This TLV MUST be included in the
        IP-Port-Limit-Info\n         Attribute.  Refer to Section 3.2.2.  This limit
        applies to all\n         mappings that can be instantiated by an underlying
        address-\n         sharing device without soliciting any external entity.
        \ In\n         particular, this limit does not include the ports that are\n
        \        instructed by an Authentication, Authorization, and Accounting\n
        \        (AAA) server.\n      IP-Port-Ext-IPv4-Addr TLV\n         This TLV
        contains the IPv4 address that is associated with the\n         IP port limit
        contained in the IP-Port-Limit TLV.  This TLV is\n         optionally included
        as part of the IP-Port-Limit-Info\n         Attribute.  Refer to Section 3.2.3.\n
        \  IP-Port-Limit-Info Attribute is associated with the following\n   identifier:
        241.5.\n"
      title: 3.1.1.  IP-Port-Limit-Info Attribute
    - contents:
      - "3.1.2.  IP-Port-Range Attribute\n   This attribute is of type \"tlv\" as
        defined in the RADIUS Protocol\n   Extensions [RFC6929].  It contains some
        sub-attributes and the\n   requirement is as follows:\n   o  The IP-Port-Range
        Attribute MAY contain the IP-Port-Type TLV (see\n      Section 3.2.1).\n   o
        \ The IP-Port-Range Attribute MUST contain the IP-Port-Alloc TLV\n      (see
        Section 3.2.8).\n   o  For port allocation, the IP-Port-Range Attribute MUST
        contain both\n      the IP-Port-Range-Start TLV (see Section 3.2.9) and the\n
        \     IP-Port-Range-End TLV (see Section 3.2.10).  For port\n      deallocation,
        the IP-Port-Range Attribute MAY contain both of\n      these two TLVs; if
        the two TLVs are not included, it implies that\n      all ports that were
        previously allocated are now all deallocated.\n   o  The IP-Port-Range Attribute
        MAY contain the\n      IP-Port-Ext-IPv4-Addr TLV (see Section 3.2.3).\n   o
        \ The IP-Port-Range Attribute MAY contain the IP-Port-Local-Id TLV\n      (see
        Section 3.2.11).\n   The IP-Port-Range Attribute contains a range of contiguous
        IP ports.\n   These ports are either to be allocated or deallocated depending
        on\n   the Value carried by the IP-Port-Alloc TLV.\n   If the IP-Port-Type
        TLV is included as part of the IP-Port-Range\n   Attribute, then the port
        range is associated with the specific IP\n   transport protocol as specified
        in the IP-Port-Type TLV, but\n   otherwise it is for all IP transport protocols.\n
        \  If the IP-Port-Ext-IPv4-Addr TLV is included as part of the\n   IP-Port-Range
        Attribute, then the port range as specified is\n   associated with the IPv4
        address as indicated, but otherwise it is\n   for all IPv4 addresses by the
        address-sharing device (e.g., a CGN\n   device) for the end user.\n   This
        attribute can be used to convey a single IP transport port\n   number: in
        such case, the Value of the IP-Port-Range-Start TLV and\n   the IP-Port-Range-End
        TLV, respectively, contain the same port\n   number.\n   The information contained
        in the IP-Port-Range Attribute is sent to\n   RADIUS server.\n   The IP-Port-Range
        Attribute MAY appear in an Accounting-Request\n   packet.\n   The IP-Port-Range
        Attribute MUST NOT appear in any other RADIUS\n   packet.\n   The format of
        the IP-Port-Range Attribute is shown in Figure 2.\n    0                   1
        \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |      Type     |     Length    | Extended-Type |    Value ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 2\n   Type\n      241\n   Length\n
        \     This field indicates the total length in octets of all fields of\n      this
        attribute, including the Type, Length, Extended-Type, and the\n      entire
        length of the embedded TLVs.\n   Extended-Type\n      6\n   Value\n      This
        field contains a set of TLVs as follows:\n      IP-Port-Type TLV\n         This
        TLV contains a value that indicates the IP port type.\n         Refer to Section
        3.2.1.\n      IP-Port-Alloc TLV\n         This TLV contains a flag to indicate
        the range of the specified\n         IP ports for either allocation or deallocation.
        \ This TLV MUST\n         be included as part of the IP-Port-Range Attribute.
        \ Refer to\n         Section 3.2.8.\n      IP-Port-Range-Start TLV\n         This
        TLV contains the smallest port number of a range of\n         contiguous IP
        ports.  To report the port allocation, this TLV\n         MUST be included
        together with IP-Port-Range-End TLV as part of\n         the IP-Port-Range
        Attribute.  Refer to Section 3.2.9.\n      IP-Port-Range-End TLV\n         This
        TLV contains the largest port number of a range of\n         contiguous IP
        ports.  To report the port allocation, this TLV\n         MUST be included
        together with IP-Port-Range-Start TLV as part\n         of the IP-Port-Range
        Attribute.  Refer to Section 3.2.10.\n      IP-Port-Ext-IPv4-Addr TLV\n         This
        TLV contains the IPv4 address that is associated with the\n         IP port
        range, as is collectively indicated in the\n         IP-Port-Range-Start TLV
        and the IP-Port-Range-End TLV.  This\n         TLV is optionally included
        as part of the IP-Port-Range\n         Attribute.  Refer to Section 3.2.3.\n
        \     IP-Port-Local-Id TLV\n         This TLV contains a local significant
        identifier at the\n         customer premise, such as the Media Access Control
        (MAC)\n         address, interface ID, VLAN ID, PPP sessions ID, VPN Routing\n
        \        and Forwarding (VRF) ID, IP address/prefix, etc.  This TLV is\n         optionally
        included as part of the IP-Port-Range Attribute.\n         Refer to Section
        3.2.11.\n   The IP-Port-Range Attribute is associated with the following\n
        \  identifier: 241.6.\n"
      title: 3.1.2.  IP-Port-Range Attribute
    - contents:
      - "3.1.3.  IP-Port-Forwarding-Map Attribute\n   This attribute is of type \"tlv\"
        as defined in the RADIUS Protocol\n   Extensions [RFC6929].  It contains some
        sub-attributes and the\n   requirement is as follows:\n   o  The IP-Port-Forwarding-Map
        Attribute MAY contain the\n      IP-Port-Type TLV (see Section 3.2.1).\n   o
        \ The IP-Port-Forwarding-Map Attribute MUST contain both\n      IP-Port-Int-Port
        TLV (see Section 3.2.6) and the\n      IP-Port-Ext-Port TLV (see Section 3.2.7).\n
        \  o  If the internal realm is with an IPv4 address family, the\n      IP-Port-Forwarding-Map
        Attribute MUST contain the\n      IP-Port-Int-IPv4-Addr TLV (see Section 3.2.4);
        if the internal\n      realm is with an IPv6 address family, the IP-Port-Forwarding-Map\n
        \     Attribute MUST contain the IP-Port-Int-IPv6-Addr TLV (see\n      Section
        3.2.5).\n   o  The IP-Port-Forwarding-Map Attribute MAY contain the\n      IP-Port-Ext-IPv4-Addr
        TLV (see Section 3.2.3).\n   o  The IP-Port-Forwarding-Map Attribute MAY contain
        the\n      IP-Port-Local-Id TLV (see Section 3.2.11).\n   The attribute contains
        a two-octet IP internal port number and a\n   two-octet IP external port number.
        \ The internal port number is\n   associated with an internal IPv4 or IPv6
        address that MUST always be\n   included.  The external port number is associated
        with a specific\n   external IPv4 address if included, but otherwise it is
        associated\n   with all external IPv4 addresses for the end user.\n   If the
        IP-Port-Type TLV is included as part of the\n   IP-Port-Forwarding-Map Attribute,
        then the port mapping is associated\n   with the specific IP transport protocol
        as specified in the\n   IP-Port-Type TLV, but otherwise it is for all IP transport
        protocols.\n   The IP-Port-Forwarding-Map Attribute MAY appear in an Access-Accept\n
        \  packet.  It MAY also appear in an Access-Request packet to indicate a\n
        \  preferred port mapping by the device co-located with NAS.  However,\n   the
        server is not required to honor such a preference.\n   The IP-Port-Forwarding-Map
        Attribute MAY appear in a CoA-Request\n   packet.\n   The IP-Port-Forwarding-Map
        Attribute MAY also appear in an\n   Accounting-Request packet.\n   The IP-Port-Forwarding-Map
        Attribute MUST NOT appear in any other\n   RADIUS packet.\n   The format of
        the IP-Port-Forwarding-Map Attribute is shown in\n   Figure 3.\n    0                   1
        \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |      Type     |     Length    | Extended-Type |    Value ....\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 3\n   Type\n      241\n   Length\n
        \     This field indicates the total length in octets of all fields of\n      this
        attribute, including the Type, Length, Extended-Type, and the\n      entire
        length of the embedded TLVs.\n   Extended-Type\n      7\n   Value\n      This
        field contains a set of TLVs as follows:\n      IP-Port-Type TLV\n         This
        TLV contains a value that indicates the IP port type.\n         Refer to Section
        3.2.1.\n      IP-Port-Int-Port TLV\n         This TLV contains an internal
        IP port number associated with an\n         internal IPv4 or IPv6 address.
        \ This TLV MUST be included\n         together with IP-Port-Ext-Port TLV as
        part of the\n         IP-Port-Forwarding-Map Attribute.  Refer to Section
        3.2.6.\n      IP-Port-Ext-Port TLV\n         This TLV contains an external
        IP port number associated with an\n         external IPv4 address.  This TLV
        MUST be included together with\n         IP-Port-Int-Port TLV as part of the
        IP-Port-Forwarding-Map\n         Attribute.  Refer to Section 3.2.7.\n      IP-Port-Int-IPv4-Addr
        TLV\n         This TLV contains an IPv4 address that is associated with the\n
        \        internal IP port number contained in the IP-Port-Int-Port TLV.\n
        \        For the internal realm with an IPv4 address family, this TLV\n         MUST
        be included as part of the IP-Port-Forwarding-Map\n         Attribute.  Refer
        to Section 3.2.4.\n      IP-Port-Int-IPv6-Addr TLV\n         This TLV contains
        an IPv6 address that is associated with the\n         internal IP port number
        contained in the IP-Port-Int-Port TLV.\n         For the internal realm with
        an IPv6 address family, this TLV\n         MUST be included as part of the
        IP-Port-Forwarding-Map\n         Attribute.  Refer to Section 3.2.5.\n      IP-Port-Ext-IPv4-Addr
        TLV\n         This TLV contains an IPv4 address that is associated with the\n
        \        external IP port number contained in the IP-Port-Ext-Port TLV.\n
        \        This TLV MAY be included as part of the IP-Port-Forwarding-Map\n
        \        Attribute.  Refer to Section 3.2.3.\n      IP-Port-Local-Id TLV\n
        \        This TLV contains a local significant identifier at the\n         customer
        premise, such as MAC address, interface ID, VLAN ID,\n         PPP sessions
        ID, VRF ID, IP address/prefix, etc.  This TLV is\n         optionally included
        as part of the IP-Port-Forwarding-Map\n         Attribute.  Refer to Section
        3.2.11.\n   The IP-Port-Forwarding-Map Attribute is associated with the following\n
        \  identifier: 241.7.\n"
      title: 3.1.3.  IP-Port-Forwarding-Map Attribute
    title: 3.1.  Extended Attributes for IP Ports
  - contents:
    - "3.2.  RADIUS TLVs for IP Ports\n   The TLVs that are included in the three
      attributes (see Section 3.1)\n   are defined in the following subsections.  These
      TLVs use the format\n   defined in [RFC6929].  As the three attributes carry
      similar data, we\n   have defined a common set of TLVs that are used for all
      three\n   attributes.  That is, the TLVs have the same name and number when\n
      \  encapsulated in any one of the three parent attributes.  See\n   Sections
      3.1.1, 3.1.2, and 3.1.3 for a list of which TLV is permitted\n   within which
      parent attribute.\n   The encoding of the Value field of these TLVs follows
      the\n   recommendation of [RFC6158].  In particular, IP-Port-Type,\n   IP-Port-Limit,
      IP-Port-Int-Port, IP-Port-Ext-Port, IP-Port-Alloc,\n   IP-Port-Range-Start,
      and IP-Port-Range-End TLVs are encoded in\n   32 bits as per the recommendation
      in Appendix A.2.1 of [RFC6158].\n"
    - contents:
      - "3.2.1.  IP-Port-Type TLV\n   The format of IP-Port-Type TLV is shown in Figure
        4.  This attribute\n   carries the IP transport protocol number defined by
        IANA (refer to\n   [ProtocolNumbers]).\n    0                   1                   2
        \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |   TLV-Type    |     Length    |        Protocol-Number\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \          Protocol-Number         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 4\n   TLV-Type\n      1\n   Length\n
        \     Six octets\n   Protocol-Number\n      Integer.  This field contains
        the data (unsigned8) of the protocol\n      number defined in [ProtocolNumbers],
        right justified, and the\n      unused bits in this field MUST be set to zero.
        \ Protocols that do\n      not use a port number (e.g., the Resource Reservation
        Protocol\n      (RSVP) or IP Encapsulating Security Payload (ESP)) MUST NOT
        be\n      included in the IP-Port-Type TLV.\n   IP-Port-Type TLV MAY be included
        in the following attributes:\n   o  IP-Port-Limit-Info Attribute, identified
        as 241.5.1 (see\n      Section 3.1.1)\n   o  IP-Port-Range Attribute, identified
        as 241.6.1 (see Section 3.1.2)\n   o  IP-Port-Forwarding-Map Attribute, identified
        as 241.7.1 (see\n      Section 3.1.3)\n   When the IP-Port-Type TLV is included
        within a RADIUS attribute, the\n   associated attribute is applied to the
        IP transport protocol as\n   indicated by the Protocol-Number only, such as
        TCP, UDP, SCTP,\n   DCCP, etc.\n"
      title: 3.2.1.  IP-Port-Type TLV
    - contents:
      - "3.2.2.  IP-Port-Limit TLV\n   The format of IP-Port-Limit TLV is shown in
        Figure 5.  This attribute\n   carries IPFIX Information Element 458, \"sourceTransportPortsLimit\",\n
        \  which indicates the maximum number of IP transport ports as a limit\n   for
        an end user to use that is associated with one or more IPv4 or\n   IPv6 addresses.\n
        \   0                   1                   2                   3\n    0 1
        2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |   TLV-Type    |     Length    |    sourceTransportPortsLimit\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \       sourceTransportPortsLimit  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 5\n   TLV-Type\n      2\n   Length\n
        \     Six octets\n   sourceTransportPortsLimit\n      Integer.  This field
        contains the data (unsigned16) of\n      sourceTransportPortsLimit (458) defined
        in IPFIX, right justified,\n      and the unused bits in this field MUST be
        set to zero.\n   IP-Port-Limit TLV MUST be included as part of the IP-Port-Limit-Info\n
        \  Attribute (refer to Section 3.1.1), identified as 241.5.2.\n"
      title: 3.2.2.  IP-Port-Limit TLV
    - contents:
      - "3.2.3.  IP-Port-Ext-IPv4-Addr TLV\n   The format of IP-Port-Ext-IPv4-Addr
        TLV is shown in Figure 6.  This\n   attribute carries IPFIX Information Element
        225,\n   \"postNATSourceIPv4Address\", which is the IPv4 source address after\n
        \  NAT operation (refer to [IPFIX]).\n    0                   1                   2
        \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |   TLV-Type    |    Length     |    postNATSourceIPv4Address\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \       postNATSourceIPv4Address   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 6\n   TLV-Type\n      3\n   Length\n
        \     Six octets\n   postNATSourceIPv4Address\n      Integer.  This field
        contains the data (ipv4Address) of\n      postNATSourceIPv4Address (225) defined
        in IPFIX.\n   IP-Port-Ext-IPv4-Addr TLV MAY be included in the following\n
        \  attributes:\n   o  IP-Port-Limit-Info Attribute, identified as 241.5.3
        (see\n      Section 3.1.1)\n   o  IP-Port-Range Attribute, identified as 241.6.3
        (see Section 3.1.2)\n   o  IP-Port-Forwarding-Mapping Attribute, identified
        as 241.7.3 (see\n      Section 3.1.3)\n"
      title: 3.2.3.  IP-Port-Ext-IPv4-Addr TLV
    - contents:
      - "3.2.4.  IP-Port-Int-IPv4-Addr TLV\n   The format of IP-Port-Int-IPv4 TLV
        is shown in Figure 7.  This\n   attribute carries IPFIX Information Element
        8, \"sourceIPv4Address\",\n   which is the IPv4 source address before NAT
        operation (refer to\n   [IPFIX]).\n    0                   1                   2
        \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |   TLV-Type    |     Length    |       sourceIPv4Address\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \        sourceIPv4Address         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 7\n   TLV-Type\n      4\n   Length\n
        \     Six octets\n   sourceIPv4Address\n      Integer.  This field contains
        the data (ipv4Address) of\n      sourceIPv4Address (8) defined in IPFIX.\n
        \  If the internal realm is with an IPv4 address family, the\n   IP-Port-Int-IPv4-Addr
        TLV MUST be included as part of the\n   IP-Port-Forwarding-Map Attribute (refer
        to Section 3.1.3),\n   identified as 241.7.4.\n"
      title: 3.2.4.  IP-Port-Int-IPv4-Addr TLV
    - contents:
      - "3.2.5.  IP-Port-Int-IPv6-Addr TLV\n   The format of IP-Port-Int-IPv6-Addr
        TLV is shown in Figure 8.  This\n   attribute carries IPFIX Information Element
        27, \"sourceIPv6Address\",\n   which is the IPv6 source address before NAT
        operation (refer to\n   [IPFIX]).\n    0                   1                   2
        \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |   TLV-Type    |     Length    |        sourceIPv6Address\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                            sourceIPv6Address\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                            sourceIPv6Address\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                            sourceIPv6Address\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \          sourceIPv6Address       |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 8\n   TLV-Type\n      5\n   Length\n
        \     Eighteen octets\n   sourceIPv6Address\n      IPv6 address (128 bits).
        \ This field contains the data\n      (ipv6Address) of sourceIPv6Address (27)
        defined in IPFIX.\n   If the internal realm is with an IPv6 address family,
        the\n   IP-Port-Int-IPv6-Addr TLV MUST be included as part of the\n   IP-Port-Forwarding-Map
        Attribute (refer to Section 3.1.3),\n   identified as 241.7.5.\n"
      title: 3.2.5.  IP-Port-Int-IPv6-Addr TLV
    - contents:
      - "3.2.6.  IP-Port-Int-Port TLV\n   The format of IP-Port-Int-Port TLV is shown
        in Figure 9.  This\n   attribute carries IPFIX Information Element 7, \"sourceTransportPort\",\n
        \  which is the source transport number associated with an internal IPv4\n
        \  or IPv6 address (refer to [IPFIX]).\n    0                   1                   2
        \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |    TLV-Type   |     Length    |      sourceTransportPort\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \          sourceTransportPort     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 9\n   TLV-Type\n      6\n   Length\n
        \     Six octets\n   sourceTransportPort\n      Integer.  This field contains
        the data (unsigned16) of\n      sourceTransportPort (7) defined in IPFIX,
        right justified, and\n      unused bits MUST be set to zero.\n   IP-Port-Int-Port
        TLV MUST be included as part of the\n   IP-Port-Forwarding-Map Attribute (refer
        to Section 3.1.3),\n   identified as 241.7.6.\n"
      title: 3.2.6.  IP-Port-Int-Port TLV
    - contents:
      - "3.2.7.  IP-Port-Ext-Port TLV\n   The format of IP-Port-Ext-Port TLV is shown
        in Figure 10.  This\n   attribute carries IPFIX Information Element 227,\n
        \  \"postNAPTSourceTransportPort\", which is the transport number\n   associated
        with an external IPv4 address (refer to [IPFIX]).\n    0                   1
        \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |    TLV-Type   |     Length    |  postNAPTSourceTransportPort\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     postNAPTSourceTransportPort  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 10\n   TLV-Type\n      7\n   Length\n
        \     Six octets\n   postNAPTSourceTransportPort\n      Integer.  This field
        contains the data (unsigned16) of\n      postNAPTSourceTransportPort (227)
        defined in IPFIX, right\n      justified, and unused bits MUST be set to zero.\n
        \  IP-Port-Ext-Port TLV MUST be included as part of the\n   IP-Port-Forwarding-Map
        Attribute (refer to Section 3.1.3),\n   identified as 241.7.7.\n"
      title: 3.2.7.  IP-Port-Ext-Port TLV
    - contents:
      - "3.2.8.  IP-Port-Alloc TLV\n   The format of IP-Port-Alloc TLV is shown in
        Figure 11.  This\n   attribute carries IPFIX Information Element 230, \"natEvent\",
        which is\n   a flag to indicate an action of NAT operation (refer to [IPFIX]).\n
        \  When the value of natEvent is \"1\" (Create event), it means to\n   allocate
        a range of transport ports; when the value is \"2\", it means\n   to deallocate
        a range of transports ports.  For the purpose of this\n   TLV, no other value
        is used.\n    0                   1                   2                   3\n
        \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |    TLV-Type   |     Length    |            natEvent\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \              natEvent            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 11\n   TLV-Type\n      8\n   Length\n
        \     Six octets\n   natEvent\n      Integer.  This field contains the data
        (unsigned8) of natEvent\n      (230) defined in IPFIX, right justified, and
        unused bits MUST be\n      set to zero.  It indicates the allocation or deallocation
        of a\n      range of IP ports as follows:\n         0: Reserved\n         1:
        Allocation\n         2: Deallocation\n   IP-Port-Alloc TLV MUST be included
        as part of the IP-Port-Range\n   Attribute (refer to Section 3.1.2), identified
        as 241.6.8.\n"
      title: 3.2.8.  IP-Port-Alloc TLV
    - contents:
      - "3.2.9.  IP-Port-Range-Start TLV\n   The format of IP-Port-Range-Start TLV
        is shown in Figure 12.  This\n   attribute carries IPFIX Information Element
        361, \"portRangeStart\",\n   which is the smallest port number of a range
        of contiguous transport\n   ports (refer to [IPFIX]).\n    0                   1
        \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |    TLV-Type   |     Length    |         portRangeStart\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \            portRangeStart        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 12\n   TLV-Type\n      9\n   Length\n
        \     Six octets\n   portRangeStart\n      Integer.  This field contains the
        data (unsigned16) of\n      portRangeStart (361) defined in IPFIX, right justified,
        and unused\n      bits MUST be set to zero.\n   IP-Port-Range-Start TLV is
        included as part of the IP-Port-Range\n   Attribute (refer to Section 3.1.2),
        identified as 241.6.9.\n"
      title: 3.2.9.  IP-Port-Range-Start TLV
    - contents:
      - "3.2.10.  IP-Port-Range-End TLV\n   The format of IP-Port-Range-End TLV is
        shown in Figure 13.  This\n   attribute carries IPFIX Information Element
        362, \"portRangeEnd\",\n   which is the largest port number of a range of
        contiguous transport\n   ports (refer to [IPFIX]).\n    0                   1
        \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |    TLV-Type   |     Length    |          portRangeEnd\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \             portRangeEnd         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 13\n   TLV-Type\n      10\n   Length\n
        \     Six octets\n   portRangeEnd\n      Integer.  This field contains the
        data (unsigned16) of\n      portRangeEnd (362) defined in IPFIX, right justified,
        and unused\n      bits MUST be set to zero.\n   IP-Port-Range-End TLV is included
        as part of the IP-Port-Range\n   Attribute (refer to Section 3.1.2), identified
        as 241.6.10.\n"
      title: 3.2.10.  IP-Port-Range-End TLV
    - contents:
      - "3.2.11.  IP-Port-Local-Id TLV\n   The format of IP-Port-Local-Id TLV is shown
        in Figure 14.  This\n   attribute carries a string called \"localID\", which
        is a local\n   significant identifier as explained below.\n   The primary
        issue addressed by this TLV is that there are CGN\n   deployments that do
        not distinguish internal hosts by their internal\n   IP address alone but
        use further identifiers for unique subscriber\n   identification.  For example,
        this is the case if a CGN supports\n   overlapping private or shared IP address
        spaces (as described in\n   [RFC1918] and [RFC6598]) for internal hosts of
        different subscribers.\n   In such cases, different internal hosts are identified
        and mapped at\n   the CGN by their IP address and/or another identifier, for
        example,\n   the identifier of a tunnel between the CGN and the subscriber.
        \ In\n   these scenarios (and similar ones), the internal IP address is not\n
        \  sufficient to demultiplex connections from internal hosts.  An\n   additional
        identifier needs to be present in the IP-Port-Range\n   Attribute and IP-Port-Forwarding-Mapping
        Attribute in order to\n   uniquely identify an internal host.  The IP-Port-Local-Id
        TLV is used\n   to carry this identifier.\n    0                   1                   2
        \                  3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |    TLV-Type   |     Length    |        localID ....\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                                Figure 14\n   TLV-Type\n      11\n   Length\n
        \     Variable number of octets\n   localID\n      String.  The data type
        of this field is string (refer to\n      [RFC8044]).  This field contains
        the data that is a local\n      significant identifier at the customer premise,
        such as MAC\n      address, interface ID, VLAN ID, PPP sessions ID, VRF ID,
        IP\n      address/prefix, or another local significant identifier.\n   IP-Port-Local-Id
        TLV MAY be included in the following Attributes if\n   it is necessary to
        identify the subscriber:\n   o  IP-Port-Range Attribute, identified as 241.6.11
        (see\n      Section 3.1.2)\n   o  IP-Port-Forwarding-Mapping Attribute, identified
        as 241.7.11 (see\n      Section 3.1.3)\n"
      title: 3.2.11.  IP-Port-Local-Id TLV
    title: 3.2.  RADIUS TLVs for IP Ports
  title: 3.  Extensions of RADIUS Attributes and TLVs
- contents:
  - "4.  Applications, Use Cases, and Examples\n   This section describes some applications
    and use cases to illustrate\n   the use of the attributes proposed in this document.\n"
  - contents:
    - "4.1.  Managing CGN Port Behavior Using RADIUS\n   In a broadband network, customer
      information is usually stored on a\n   RADIUS server, and the BNG acts as a
      NAS.  The communication between\n   the NAS and the RADIUS server is triggered
      by a user when it signs in\n   to the Internet service where either PPP or DHCP/DHCPv6
      is used.\n   When a user signs in, the NAS sends a RADIUS Access-Request message\n
      \  to the RADIUS server.  The RADIUS server validates the request, and\n   if
      the validation succeeds, it in turn sends back a RADIUS\n   Access-Accept message.
      \ The Access-Accept message carries\n   configuration information specific to
      that user back to the NAS,\n   where some of the information would be passed
      on to the requesting\n   user via PPP or DHCP/DHCPv6.\n   A CGN function in
      a broadband network is most likely to be co-located\n   on a BNG.  In that case,
      parameters for CGN port mapping behavior for\n   users can be configured on
      the RADIUS server.  When a user signs in\n   to the Internet service, the associated
      parameters can be conveyed to\n   the NAS, and proper configuration is accomplished
      on the CGN device\n   for that user.\n   Also, a CGN operation status such as
      CGN port allocation and\n   deallocation for a specific user on the BNG can
      also be transmitted\n   back to the RADIUS server for accounting purposes using
      the RADIUS\n   protocol.\n   The RADIUS protocol has already been widely deployed
      in broadband\n   networks to manage BNG, thus the functionality described in
      this\n   specification introduces little overhead to the existing network\n
      \  operation.\n   In the following subsections, we describe how to manage CGN
      behavior\n   using the RADIUS protocol, with required RADIUS extensions proposed\n
      \  in Section 3.\n"
    - contents:
      - "4.1.1.  Configure IP Port Limit for a User\n   In the face of an IPv4 address
        shortage, there are currently\n   proposals to multiplex multiple users' connections
        over a number of\n   shared IPv4 addresses, such as Carrier Grade NAT [RFC6888],\n
        \  Dual-Stack Lite [RFC6333], NAT64 [RFC6146], etc.  As a result, a\n   single
        IPv4 public address may be shared by hundreds or even\n   thousands of users.
        \ As indicated in [RFC6269], it is therefore\n   necessary to impose limits
        on the total number of ports available to\n   an individual user to ensure
        that the shared resource, i.e., the\n   IPv4 address, remains available in
        some capacity to all the users\n   using it.  The support of an IP port limit
        is also documented in\n   [RFC6888] as a requirement for CGN.\n   The IP port
        limit imposed on an end user may be on the total number\n   of IP source transport
        ports or a specific IP transport protocol as\n   defined in Section 3.1.1.\n
        \  The per-user IP port limit is configured on a RADIUS server, along\n   with
        other user information such as credentials.\n   When a user signs in to the
        Internet service successfully, the IP\n   port limit for the subscriber is
        passed by the RADIUS server to the\n   BNG, which is acting as a NAS and is
        co-located with the CGN using\n   the IP-Port-Limit-Info RADIUS attribute
        (defined in Section 3.1.1)\n   along with other configuration parameters.
        \ While some parameters are\n   passed to the user, the IP port limit is recorded
        on the CGN device\n   for imposing the usage of IP transport ports for that
        user.\n   Figure 15 illustrates how the RADIUS protocol is used to configure\n
        \  the maximum number of TCP/UDP ports for a given user on a CGN device.\n
        \  User                     CGN/NAS                        AAA\n    |                         BNG
        \                        Server\n    |                          |                             |\n
        \   |                          |                             |\n    |----Service
        Request------>|                             |\n    |                          |
        \                            |\n    |                          |-----Access-Request
        -------->|\n    |                          |                             |\n
        \   |                          |<----Access-Accept-----------|\n    |                          |
        \    (IP-Port-Limit-Info)    |\n    |                          |     (for
        TCP/UDP ports)     |\n    |<---Service Granted ------|                             |\n
        \   |    (other parameters)    |                             |\n    |                          |
        \                            |\n    |                  (CGN external port
        \                   |\n    |                   allocation and                       |\n
        \   |                   IPv4 address assignment)             |\n    |                          |
        \                            |\n       Figure 15: RADIUS Message Flow for
        Configuring CGN Port Limit\n   The IP port limit created on a CGN device for
        a specific user using a\n   RADIUS extension may be changed using a RADIUS
        CoA message [RFC5176]\n   that carries the same RADIUS attribute.  The CoA
        message may be sent\n   from the RADIUS server directly to the NAS, and once
        a RADIUS CoA ACK\n   message is accepted and sent back, the new IP port limit
        replaces the\n   previous one.\n   Figure 16 illustrates how the RADIUS protocol
        is used to increase the\n   TCP/UDP port limit from 1024 to 2048 on a CGN
        device for a specific\n   user.\n   User                     CGN/NAS                           AAA\n
        \   |                         BNG                            Server\n    |
        \                         |                               |\n    |              TCP/UDP
        Port Limit (1024)                   |\n    |                          |                               |\n
        \   |                          |<---------CoA Request----------|\n    |                          |
        \      (IP-Port-Limit-Info)    |\n    |                          |       (for
        TCP/UDP ports)     |\n    |                          |                               |\n
        \   |              TCP/UDP Port Limit (2048)                   |\n    |                          |
        \                              |\n    |                          |---------CoA
        Response--------->|\n    |                          |                               |\n
        \   Figure 16: RADIUS Message Flow for Changing a User's CGN Port Limit\n"
      title: 4.1.1.  Configure IP Port Limit for a User
    - contents:
      - "4.1.2.  Report IP Port Allocation/Deallocation\n   Upon obtaining the IP
        port limit for a user, the CGN device needs to\n   allocate an IP transport
        port for the user when receiving a new IP\n   flow sent from that user.\n
        \  As one practice, a CGN may allocate a block of IP ports for a\n   specific
        user, instead of one port at a time, and within each port\n   block the ports
        may be randomly distributed or in consecutive\n   fashion.  When a CGN device
        allocates a block of transport ports, the\n   information can be easily conveyed
        to the RADIUS server by a new\n   RADIUS attribute called the IP-Port-Range
        (defined in Section 3.1.2).\n   The CGN device may allocate one or more IP
        port ranges, where each\n   range contains a set of numbers representing IP
        transport ports and\n   the total number of ports MUST be less or equal to
        the associated IP\n   port limit imposed for that user.  A CGN device may
        choose to\n   allocate a small port range and allocate more at a later time
        as\n   needed; such practice is good because of its randomization in nature.\n
        \  At the same time, the CGN device also needs to decide on the shared\n   IPv4
        address for that user.  The shared IPv4 address and the\n   pre-allocated
        IP port range are both passed to the RADIUS server.\n   When a user initiates
        an IP flow, the CGN device randomly selects a\n   transport port number from
        the associated and pre-allocated IP port\n   range for that user to replace
        the original source port number along\n   with the replacement of the source
        IP address by the shared IPv4\n   address.\n   A CGN device may decide to
        \"free\" a previously assigned set of IP\n   ports that have been allocated
        for a specific user but are not\n   currently in use, and with that, the CGN
        device must send the\n   information of the deallocated IP port range along
        with the shared\n   IPv4 address to the RADIUS server.\n   Figure 17 illustrates
        how the RADIUS protocol is used to report a set\n   of ports allocated and
        deallocated, respectively, by a NAT64 device\n   for a specific user to the
        RADIUS server.  2001:db8:100:200::/56 is\n   the IPv6 prefix allocated to
        this user.  In order to limit the usage\n   of the NAT64 resources on a per-user
        basis for fairness of resource\n   usage (see REQ-4 of [RFC6888]), port range
        allocations are bound to\n   the /56 prefix, not to the source IPv6 address
        of the request.  The\n   NAT64 device is configured with the per-user port
        limit policy by\n   some means (e.g., subscriber-mask [RFC7785]).\n   Host
        \                     NAT64/NAS                     AAA\n    |                         BNG
        \                        Server\n    |                          |                             |\n
        \   |                          |                             |\n    |----Service
        Request------>|                             |\n    |                          |
        \                            |\n    |                          |-----Access-Request
        -------->|\n    |                          |                             |\n
        \   |                          |<----Access-Accept-----------|\n    |<---Service
        Granted ------|                             |\n    |    (other parameters)
        \   |                             |\n   ...                        ...                           ...\n
        \   |                          |                             |\n    |                          |
        \                            |\n    |                (NAT64 decides to allocate
        \             |\n    |                 a TCP/UDP port range for the user)
        \    |\n    |                          |                             |\n    |
        \                         |-----Accounting-Request----->|\n    |                          |
        \   (IP-Port-Range           |\n    |                          |     for allocation)
        \        |\n   ...                        ...                           ...\n
        \   |                          |                             |\n    |                (NAT64
        decides to deallocate            |\n    |                 a TCP/UDP port range
        for the user)     |\n    |                          |                             |\n
        \   |                          |-----Accounting-Request----->|\n    |                          |
        \   (IP-Port-Range           |\n    |                          |     for deallocation)
        \      |\n    |                          |                             |\n
        \           Figure 17: RADIUS Message Flow for Reporting NAT64\n                   Allocation/Deallocation
        of a Port Set\n"
      title: 4.1.2.  Report IP Port Allocation/Deallocation
    - contents:
      - "4.1.3.  Configure Port Forwarding Mapping\n   In most scenarios, the port
        mapping on a NAT device is dynamically\n   created when the IP packets of
        an IP connection initiated by a user\n   arrives.  For some applications,
        the port mapping needs to be\n   pre-defined and allow IP packets of applications
        from outside a CGN\n   device to pass through and be \"port forwarded\" to
        the correct user\n   located behind the CGN device.\n   The Port Control Protocol
        (PCP) [RFC6887], provides a mechanism to\n   create a mapping from an external
        IP address and port to an internal\n   IP address and port on a CGN device
        just to achieve the \"port\n   forwarding\" purpose.  PCP is a server-client
        protocol capable of\n   creating or deleting a mapping along with a rich set
        of features on a\n   CGN device in dynamic fashion.  In some deployments,
        all users need\n   is a few (typically just one) pre-configured port mappings
        for\n   applications at home, such as a web cam; the lifetime of such a port\n
        \  mapping remains valid throughout the duration of the customer's\n   Internet
        service connection time.  In such an environment, it is\n   possible to statically
        configure a port mapping on the RADIUS server\n   for a user and let the RADIUS
        protocol propagate the information to\n   the associated CGN device.\n   Note
        that this document targets deployments where a AAA server is\n   responsible
        for instructing NAT mappings for a given subscriber and\n   does not make
        any assumption about the host's capabilities with\n   regards to port forwarding
        control.  This deployment is complementary\n   to PCP given that PCP targets
        a different deployment model where an\n   application (on the host) controls
        its mappings in an upstream CPE,\n   CGN, firewall, etc.\n   Figure 18 illustrates
        how the RADIUS protocol is used to configure a\n   port forwarding mapping
        on a NAT44 device.\n   Host                     CGN/NAS                           AAA\n
        \   |                         BNG                            Server\n    |
        \                         |                               |\n    |----Service
        Request------>|                               |\n    |                          |
        \                              |\n    |                          |---------Access-Request------->|\n
        \   |                          |                               |\n    |                          |<--------Access-Accept---------|\n
        \   |                          |   (IP-Port-Forwarding-Map)    |\n    |<---Service
        Granted ------|                               |\n    |    (other parameters)
        \   |                               |\n    |                          |                               |\n
        \   |                 (Create a port mapping                   |\n    |                  for
        the user, and                       |\n    |                  associate it
        with the                   |\n    |                  internal IP address                     |\n
        \   |                  and external IP address)                |\n    |                          |
        \                              |\n    |                          |                               |\n
        \   |                          |------Accounting-Request------>|\n    |                          |
        \   (IP-Port-Forwarding-Map)   |\n              Figure 18: RADIUS Message
        Flow for Configuring\n                         a Port Forwarding Mapping\n
        \  A port forwarding mapping that is created on a CGN device using the\n   RADIUS
        extension as described above may also be changed using a\n   RADIUS CoA message
        [RFC5176] that carries the same RADIUS\n   association.  The CoA message may
        be sent from the RADIUS server\n   directly to the NAS, and once the RADIUS
        CoA ACK message is accepted\n   and sent back, the new port forwarding mapping
        then replaces the\n   previous one.\n   Figure 19 illustrates how the RADIUS
        protocol is used to change an\n   existing port mapping from (a:X) to (a:Y),
        where \"a\" is an internal\n   port, and \"X\" and \"Y\" are external ports,
        respectively, for a\n   specific user with a specific IP address\n   Host
        \                    CGN/NAS                           AAA\n    |                         BNG
        \                           Server\n    |                          |                               |\n
        \   |                    Internal IP Address                   |\n    |                    Port
        Map (a:X)                        |\n    |                          |                               |\n
        \   |                          |<---------CoA Request----------|\n    |                          |
        \   (IP-Port-Forwarding-Map)   |\n    |                          |                               |\n
        \   |                    Internal IP Address                   |\n    |                    Port
        Map (a:Y)                        |\n    |                          |                               |\n
        \   |                          |---------CoA Response--------->|\n    |                          |
        \   (IP-Port-Forwarding-Map)   |\n                Figure 19: RADIUS Message
        Flow for Changing\n                     a User's Port Forwarding Mapping\n"
      title: 4.1.3.  Configure Port Forwarding Mapping
    - contents:
      - "4.1.4.  An Example\n   An Internet Service Provider (ISP) assigns TCP/UDP
        500 ports for the\n   user Joe.  This number is the limit that can be used
        for TCP/UDP\n   ports on a CGN device for Joe and it is configured on a RADIUS\n
        \  server.  Also, Joe asks for a pre-defined port forwarding mapping on\n
        \  the CGN device for his web cam applications (external port 5000 maps\n
        \  to internal port 1234).\n   When Joe successfully connects to the Internet
        service, the RADIUS\n   server conveys the TCP/UDP port limit (500) and the
        port forwarding\n   mapping (external port 5000 to internal port 1234) to
        the CGN device\n   using the IP-Port-Limit-Info Attribute and IP-Port-Forwarding-Map\n
        \  Attribute, respectively, carried by an Access-Accept message to the\n   BNG
        where NAS and CGN are co-located.\n   Upon receiving the first outbound IP
        packet sent from Joe's laptop,\n   the CGN device decides to allocate a small
        port pool that contains 40\n   consecutive ports, from 3500 to 3540, inclusively,
        and also assigns a\n   shared IPv4 address 192.0.2.15 for Joe.  The CGN device
        also randomly\n   selects one port from the allocated range (say, 3519) and
        uses that\n   port to replace the original source port in outbound IP packets.\n
        \  For accounting purposes, the CGN device passes this port range\n   (3500-3540)
        and the shared IPv4 address 192.0.2.15 together to the\n   RADIUS server using
        IP-Port-Range Attribute carried by an\n   Accounting-Request message.\n   When
        Joe works on more applications with more outbound IP mappings\n   and the
        port pool (3500-3540) is close to exhaust, the CGN device\n   allocates a
        second port pool (8500-8800) in a similar fashion and\n   also passes the
        new port range (8500-8800) and IPv4 address\n   192.0.2.15 together to the
        RADIUS server using IP-Port-Range\n   Attribute carried by an Accounting-Request
        message.  Note when the\n   CGN allocates more ports, it needs to assure that
        the total number of\n   ports allocated for Joe is within the limit.\n   Joe
        decides to upgrade his service agreement with more TCP/UDP ports\n   allowed
        (up to 1000 ports).  The ISP updates the information in Joe's\n   profile
        on the RADIUS server, which then sends a CoA-Request message\n   that carries
        the IP-Port-Limit-Info Attribute with 1000 ports to the\n   CGN device; the
        CGN device in turn sends back a CoA-ACK message.\n   With that, Joe enjoys
        more available TCP/UDP ports for his\n   applications.\n   When Joe is not
        using his service, most of the IP mappings are closed\n   with their associated
        TCP/UDP ports released on the CGN device, which\n   then sends the relevant
        information back to the RADIUS server using\n   the IP-Port-Range Attribute
        carried by the Accounting-Request\n   message.\n   Throughout Joe's connection
        with his ISP, applications can\n   communicate with his web cam at home from
        the external realm, thus\n   directly traversing the pre-configured mapping
        on the CGN device.\n   When Joe disconnects from his Internet service, the
        CGN device will\n   deallocate all TCP/UDP ports as well as the port forwarding
        mapping\n   and send the relevant information to the RADIUS server.\n"
      title: 4.1.4.  An Example
    title: 4.1.  Managing CGN Port Behavior Using RADIUS
  - contents:
    - "4.2.  Report Assigned Port Set for a Visiting UE\n   Figure 20 illustrates
      an example of the flow exchange that occurs\n   when the visiting User Equipment
      (UE) connects to a CPE offering WLAN\n   service.\n   For identification purposes
      (see [RFC6967]), once the CPE assigns a\n   port set, it issues a RADIUS message
      to report the assigned port set.\n   UE         CPE             CGN                          AAA\n
      \   |                         BNG                         Server\n    |                          |
      \                            |\n    |                          |                             |\n
      \   |----Service Request------>|                             |\n    |                          |
      \                            |\n    |                          |-----Access-Request
      -------->|\n    |                          |                             |\n
      \   |                          |<----Access-Accept-----------|\n    |<---Service
      Granted ------|                             |\n    |    (other parameters)    |
      \                            |\n   ...          |             ...                           ...\n
      \   |<---IP@----|              |                             |\n    |           |
      \             |                             |\n    |   (CPE assigns a TCP/UDP
      port                          |\n    |   range for this visiting UE)                          |\n
      \   |           |                                            |\n    |           |--Accounting-Request-...------------------->|\n
      \   |           |    (IP-Port-Range                          |\n    |           |
      \    for allocation)                        |\n   ...          |             ...
      \                          ...\n    |           |              |                             |\n
      \   |           |              |                             |\n    |   (CPE
      withdraws a TCP/UDP port                        |\n    |   range for a visiting
      UE)                             |\n    |           |                                            |\n
      \   |           |--Accounting-Request-...------------------->|\n    |           |
      \   (IP-Port-Range                          |\n    |           |     for deallocation)
      \                     |\n    |           |                                            |\n
      \            Figure 20: RADIUS Message Flow for Reporting CPE\n          Allocation/Deallocation
      of a Port Set to a Visiting UE\n"
    title: 4.2.  Report Assigned Port Set for a Visiting UE
  title: 4.  Applications, Use Cases, and Examples
- contents:
  - "5.  Table of Attributes\n   This document proposes three new RADIUS attributes,
    and their formats\n   are as follows:\n   o  IP-Port-Limit-Info: 241.5\n   o  IP-Port-Range:
    241.6\n   o  IP-Port-Forwarding-Map: 241.7\n   The following table provides a
    guide as to what type of RADIUS\n   packets may contain these attributes and in
    what quantity.\n   Request Accept Reject Challenge Acct.    #     Attribute\n
    \                                  Request\n   0+      0+     0      0         0+
    \      241.5 IP-Port-Limit-Info\n   0       0      0      0         0+       241.6
    IP-Port-Range\n   0+      0+     0      0         0+       241.7 IP-Port-Forwarding-Map\n
    \  The following table defines the meaning of the above table entries.\n   0  This
    attribute MUST NOT be present in packet.\n   0+ Zero or more instances of this
    attribute MAY be present in packet.\n"
  title: 5.  Table of Attributes
- contents:
  - "6.  Security Considerations\n   This document does not introduce any security
    issue other than the\n   ones already identified in RADIUS documents [RFC2865]
    and [RFC5176]\n   for CoA messages.  Known RADIUS vulnerabilities apply to this\n
    \  specification.  For example, if RADIUS packets are sent in the clear,\n   an
    attacker in the communication path between the RADIUS client and\n   server may
    glean information that it will use to prevent a legitimate\n   user from accessing
    the service by appropriately setting the maximum\n   number of IP ports conveyed
    in an IP-Port-Limit-Info Attribute;\n   exhaust the port quota of a user by installing
    many mapping entries\n   (IP-Port-Forwarding-Map Attribute); prevent incoming
    traffic from\n   being delivered to its legitimate destination by manipulating
    the\n   mapping entries installed by means of an IP-Port-Forwarding-Map\n   Attribute;
    discover the IP address and port range that are assigned\n   to a given user and
    reported in an IP-Port-Range Attribute; and so\n   on.  The root cause of these
    attack vectors is the communication\n   between the RADIUS client and server.\n
    \  The IP-Port-Local-Id TLV includes an identifier of which the type and\n   length
    is deployment and implementation dependent.  This identifier\n   might carry privacy-sensitive
    information.  It is therefore\n   RECOMMENDED to utilize identifiers that do not
    have such privacy\n   concerns.\n   If there is any error in a RADIUS Accounting-Request
    packet sent\n   from a RADIUS client to the server, the RADIUS server MUST NOT
    send\n   a response to the client (refer to [RFC2866]).  Examples of the\n   errors
    include the erroneous port range in the\n   IP-Port-Range Attribute, inconsistent
    port mapping in the\n   IP-Port-Forwarding-Map Attribute, etc.\n   This document
    targets deployments where a trusted relationship is in\n   place between the RADIUS
    client and server with communication\n   optionally secured by IPsec or Transport
    Layer Security (TLS)\n   [RFC6614].\n"
  title: 6.  Security Considerations
- contents:
  - "7.  IANA Considerations\n   Per this document, IANA has made new code point assignments
    for both\n   IPFIX Information Elements and RADIUS attributes as explained in
    the\n   following subsections.\n"
  - contents:
    - "7.1.  New IPFIX Information Elements\n   The following IPFIX Information Element
      has been registered (refer to\n   Section 3.2.2):\n   o  sourceTransportPortsLimit:\n
      \     *  Name: sourceTransportPortsLimit\n      *  Element ID: 458\n      *
      \ Description: This Information Element contains the maximum\n         number
      of IP source transport ports that can be used by an end\n         user when
      sending IP packets; each user is associated with one\n         or more (source)
      IPv4 or IPv6 addresses.  This Information\n         Element is particularly
      useful in address-sharing deployments\n         that adhere to REQ-4 of [RFC6888].
      \ Limiting the number of\n         ports assigned to each user ensures fairness
      among users and\n         mitigates the denial-of-service attack that a user
      could launch\n         against other users through the address-sharing device
      in order\n         to grab more ports.\n      *  Data type: unsigned16\n      *
      \ Data type semantics: totalCounter\n      *  Data type unit: ports\n      *
      \ Data value range: from 1 to 65535\n"
    title: 7.1.  New IPFIX Information Elements
  - contents:
    - "7.2.  New RADIUS Attributes\n   The Attribute Types defined in this document
      have been registered by\n   IANA from the RADIUS namespace as described in the
      \"IANA\n   Considerations\" section of [RFC3575], in accordance with BCP 26\n
      \  [RFC5226].  For RADIUS packets, attributes, and registries created by\n   this
      document, IANA has placed them at\n   <http://www.iana.org/assignments/radius-types>.\n
      \  In particular, this document defines three new RADIUS attributes, as\n   follows,
      from the Short Extended Space of [RFC6929]:\n   Type      Description             Data
      Type   Reference\n   ----      -----------             ---------   ---------\n
      \  241.5     IP-Port-Limit-Info      tlv         Section 3.1.1\n   241.6     IP-Port-Range
      \          tlv         Section 3.1.2\n   241.7     IP-Port-Forwarding-Map  tlv
      \        Section 3.1.3\n"
    title: 7.2.  New RADIUS Attributes
  - contents:
    - "7.3.  New RADIUS TLVs\n   IANA has created a new registry called \"RADIUS IP
      Port Configuration\n   and Reporting TLVs\".  All TLVs in this registry have
      one or more\n   parent RADIUS attributes in nesting (refer to [RFC6929]).  This\n
      \  registry contains the following TLVs:\n      Value  Description           Data
      Type    Reference\n      -----  -----------           ---------    ---------\n
      \     0      Reserved\n      1      IP-Port-Type          integer      Section
      3.2.1\n      2      IP-Port-Limit         integer      Section 3.2.2\n      3
      \     IP-Port-Ext-IPv4-Addr ipv4addr     Section 3.2.3\n      4      IP-Port-Int-IPv4-Addr
      ipv4addr     Section 3.2.4\n      5      IP-Port-Int-IPv6-Addr ipv4addr     Section
      3.2.5\n      6      IP-Port-Int-Port      integer      Section 3.2.6\n      7
      \     IP-Port-Ext-Port      integer      Section 3.2.7\n      8      IP-Port-Alloc
      \        integer      Section 3.2.8\n      9      IP-Port-Range-Start   integer
      \     Section 3.2.9\n      10     IP-Port-Range-End     integer      Section
      3.2.10\n      11     IP-Port-Local-Id      string       Section 3.2.11\n      12-255
      Unassigned\n   The registration procedure for this registry is Standards Action
      as\n   defined in [RFC5226].\n"
    title: 7.3.  New RADIUS TLVs
  title: 7.  IANA Considerations
- contents:
  - '8.  References

    '
  - contents:
    - "8.1.  Normative References\n   [IPFIX]    IANA, \"IP Flow Information Export
      (IPFIX) Entities\",\n              <http://www.iana.org/assignments/ipfix/>.\n
      \  [ProtocolNumbers]\n              IANA, \"Protocol Numbers\",\n              <http://www.iana.org/assignments/protocol-numbers/>.\n
      \  [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n              Requirement
      Levels\", BCP 14, RFC 2119,\n              DOI 10.17487/RFC2119, March 1997,\n
      \             <http://www.rfc-editor.org/info/rfc2119>.\n   [RFC2865]  Rigney,
      C., Willens, S., Rubens, A., and W. Simpson,\n              \"Remote Authentication
      Dial In User Service (RADIUS)\",\n              RFC 2865, DOI 10.17487/RFC2865,
      June 2000,\n              <http://www.rfc-editor.org/info/rfc2865>.\n   [RFC3575]
      \ Aboba, B., \"IANA Considerations for RADIUS (Remote\n              Authentication
      Dial In User Service)\", RFC 3575,\n              DOI 10.17487/RFC3575, July
      2003,\n              <http://www.rfc-editor.org/info/rfc3575>.\n   [RFC5226]
      \ Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n              IANA
      Considerations Section in RFCs\", BCP 26, RFC 5226,\n              DOI 10.17487/RFC5226,
      May 2008,\n              <http://www.rfc-editor.org/info/rfc5226>.\n   [RFC6929]
      \ DeKok, A. and A. Lior, \"Remote Authentication Dial In User\n              Service
      (RADIUS) Protocol Extensions\", RFC 6929,\n              DOI 10.17487/RFC6929,
      April 2013,\n              <http://www.rfc-editor.org/info/rfc6929>.\n   [RFC7012]
      \ Claise, B., Ed., and B. Trammell, Ed., \"Information Model\n              for
      IP Flow Information Export (IPFIX)\", RFC 7012,\n              DOI 10.17487/RFC7012,
      September 2013,\n              <http://www.rfc-editor.org/info/rfc7012>.\n   [RFC8044]
      \ DeKok, A., \"Data Types in RADIUS\", RFC 8044,\n              DOI 10.17487/RFC8044,
      January 2017,\n              <http://www.rfc-editor.org/info/rfc8044>.\n"
    title: 8.1.  Normative References
  - contents:
    - "8.2.  Informative References\n   [RFC768]  Postel, J., \"User Datagram Protocol\",
      STD 6, RFC 768,\n              DOI 10.17487/RFC0768, August 1980,\n              <http://www.rfc-editor.org/info/rfc768>.\n
      \  [RFC793]  Postel, J., \"Transmission Control Protocol\", STD 7,\n              RFC
      793, DOI 10.17487/RFC0793, September 1981,\n              <http://www.rfc-editor.org/info/rfc793>.\n
      \  [RFC1918]  Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G.,\n              and
      E. Lear, \"Address Allocation for Private Internets\",\n              BCP 5,
      RFC 1918, DOI 10.17487/RFC1918, February 1996,\n              <http://www.rfc-editor.org/info/rfc1918>.\n
      \  [RFC2866]  Rigney, C., \"RADIUS Accounting\", RFC 2866,\n              DOI
      10.17487/RFC2866, June 2000,\n              <http://www.rfc-editor.org/info/rfc2866>.\n
      \  [RFC3022]  Srisuresh, P. and K. Egevang, \"Traditional IP Network\n              Address
      Translator (Traditional NAT)\", RFC 3022,\n              DOI 10.17487/RFC3022,
      January 2001,\n              <http://www.rfc-editor.org/info/rfc3022>.\n   [RFC4340]
      \ Kohler, E., Handley, M., and S. Floyd, \"Datagram\n              Congestion
      Control Protocol (DCCP)\", RFC 4340,\n              DOI 10.17487/RFC4340, March
      2006,\n              <http://www.rfc-editor.org/info/rfc4340>.\n   [RFC4960]
      \ Stewart, R., Ed., \"Stream Control Transmission Protocol\",\n              RFC
      4960, DOI 10.17487/RFC4960, September 2007,\n              <http://www.rfc-editor.org/info/rfc4960>.\n
      \  [RFC5176]  Chiba, M., Dommety, G., Eklund, M., Mitton, D., and B.\n              Aboba,
      \"Dynamic Authorization Extensions to Remote\n              Authentication Dial
      In User Service (RADIUS)\", RFC 5176,\n              DOI 10.17487/RFC5176, January
      2008,\n              <http://www.rfc-editor.org/info/rfc5176>.\n   [RFC6146]
      \ Bagnulo, M., Matthews, P., and I. van Beijnum, \"Stateful\n              NAT64:
      Network Address and Protocol Translation from IPv6\n              Clients to
      IPv4 Servers\", RFC 6146, DOI 10.17487/RFC6146,\n              April 2011, <http://www.rfc-editor.org/info/rfc6146>.\n
      \  [RFC6158]  DeKok, A., Ed., and G. Weber, \"RADIUS Design Guidelines\",\n
      \             BCP 158, RFC 6158, DOI 10.17487/RFC6158, March 2011,\n              <http://www.rfc-editor.org/info/rfc6158>.\n
      \  [RFC6269]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and\n              P.
      Roberts, \"Issues with IP Address Sharing\", RFC 6269,\n              DOI 10.17487/RFC6269,
      June 2011,\n              <http://www.rfc-editor.org/info/rfc6269>.\n   [RFC6333]
      \ Durand, A., Droms, R., Woodyatt, J., and Y. Lee,\n              \"Dual-Stack
      Lite Broadband Deployments Following IPv4\n              Exhaustion\", RFC 6333,
      DOI 10.17487/RFC6333, August 2011,\n              <http://www.rfc-editor.org/info/rfc6333>.\n
      \  [RFC6598]  Weil, J., Kuarsingh, V., Donley, C., Liljenstolpe, C., and\n              M.
      Azinger, \"IANA-Reserved IPv4 Prefix for Shared Address\n              Space\",
      BCP 153, RFC 6598, DOI 10.17487/RFC6598,\n              April 2012, <http://www.rfc-editor.org/info/rfc6598>.\n
      \  [RFC6614]  Winter, S., McCauley, M., Venaas, S., and K. Wierenga,\n              \"Transport
      Layer Security (TLS) Encryption for RADIUS\",\n              RFC 6614, DOI 10.17487/RFC6614,
      May 2012,\n              <http://www.rfc-editor.org/info/rfc6614>.\n   [RFC6887]
      \ Wing, D., Ed., Cheshire, S., Boucadair, M., Penno, R., and\n              P.
      Selkirk, \"Port Control Protocol (PCP)\", RFC 6887,\n              DOI 10.17487/RFC6887,
      April 2013,\n              <http://www.rfc-editor.org/info/rfc6887>.\n   [RFC6888]
      \ Perreault, S., Ed., Yamagata, I., Miyakawa, S., Nakagawa,\n              A.,
      and H. Ashida, \"Common Requirements for Carrier-Grade\n              NATs (CGNs)\",
      BCP 127, RFC 6888, DOI 10.17487/RFC6888,\n              April 2013, <http://www.rfc-editor.org/info/rfc6888>.\n
      \  [RFC6967]  Boucadair, M., Touch, J., Levis, P., and R. Penno,\n              \"Analysis
      of Potential Solutions for Revealing a Host\n              Identifier (HOST_ID)
      in Shared Address Deployments\",\n              RFC 6967, DOI 10.17487/RFC6967,
      June 2013,\n              <http://www.rfc-editor.org/info/rfc6967>.\n   [RFC7785]
      \ Vinapamula, S. and M. Boucadair, \"Recommendations for\n              Prefix
      Binding in the Context of Softwire Dual-Stack\n              Lite\", RFC 7785,
      DOI 10.17487/RFC7785, February 2016,\n              <http://www.rfc-editor.org/info/rfc7785>.\n
      \  [TR-146]   Broadband Forum, \"TR-146: Subscriber Sessions\", Broadband\n
      \             Forum Technical Report 146, Issue 1, May 2013,\n              <http://www.broadband-forum.org/technical/\n
      \             download/TR-146.pdf>.\n   [WIFI-SERVICES]\n              Gundavelli,
      S., Grayson, M., Seite, P., and Y. Lee,\n              \"Service Provider Wi-Fi
      Services Over Residential\n              Architectures\", Work in Progress,\n
      \             draft-gundavelli-v6ops-community-wifi-svcs-06, April 2013.\n"
    title: 8.2.  Informative References
  title: 8.  References
- contents:
  - "Acknowledgments\n   Many thanks to Dan Wing, Roberta Maglione, Daniel Derksen,
    David\n   Thaler, Alan DeKok, Lionel Morand, and Peter Deacon for their useful\n
    \  comments and suggestions.\n   Special thanks to Lionel Morand for the Shepherd
    review and to\n   Kathleen Moriarty for the AD review.\n   Thanks to Carl Wallace,
    Tim Chown, and Ben Campbell for the detailed\n   review.\n"
  title: Acknowledgments
- contents:
  - "Authors' Addresses\n   Dean Cheng\n   Huawei\n   2330 Central Expressway\n   Santa
    Clara, California  95050\n   United States of America\n   Email: dean.cheng@huawei.com\n
    \  Jouni Korhonen\n   Broadcom Corporation\n   3151 Zanker Road\n   San Jose,
    California  95134\n   United States of America\n   Email: jouni.nospam@gmail.com\n
    \  Mohamed Boucadair\n   Orange\n   Rennes\n   France\n   Email: mohamed.boucadair@orange.com\n
    \  Senthil Sivakumar\n   Cisco Systems\n   7100-8 Kit Creek Road\n   Research
    Triangle Park, North Carolina\n   United States of America\n   Email: ssenthil@cisco.com\n"
  title: Authors' Addresses
