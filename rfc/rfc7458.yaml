- title: __initial_text__
  contents:
  - "        Extensible Authentication Protocol (EAP) Attributes for\n           \
    \  Wi-Fi Integration with the Evolved Packet Core\n"
- title: Abstract
  contents:
  - "Abstract\n   With Wi-Fi emerging as a crucial access network for mobile service\n\
    \   providers, it has become important to provide functions commonly\n   available\
    \ in 3G and 4G networks in Wi-Fi access networks as well.\n   Such functions include\
    \ Access Point Name (APN) Selection, multiple\n   Packet Data Network (PDN) connections,\
    \ and seamless mobility between\n   Wi-Fi and 3G/4G networks.\n   The EAP Authentication\
    \ and Key Agreement (EAP-AKA), and EAP-AKA',\n   protocol is required for mobile\
    \ devices to access the mobile Evolved\n   Packet Core (EPC) via Wi-Fi networks.\
    \  This document defines a few\n   new EAP attributes to enable the above-mentioned\
    \ functions in such\n   networks.  The attributes are exchanged between a client\
    \ (such as a\n   Mobile Node (MN)) and its network counterpart (such as an\n \
    \  Authentication, Authorization, and Accounting (AAA) server) in the\n   service\
    \ provider's infrastructure.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7458.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2015 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. APN Selection ..............................................4\n  \
    \    1.2. Multiple APN Connectivity ..................................4\n    \
    \  1.3. Wi-Fi to E-UTRAN Mobility ..................................4\n   2. Terminology\
    \ .....................................................4\n   3. Protocol Overview\
    \ ...............................................5\n      3.1. Brief Introduction\
    \ to EAP ..................................5\n      3.2. IEEE 802.11 Authentication\
    \ Using EAP over 802.1X ...........5\n   4. New EAP Attributes ..............................................7\n\
    \      4.1. APN Selection ..............................................7\n  \
    \    4.2. Connectivity Type ..........................................7\n    \
    \  4.3. Wi-Fi to UTRAN/E-UTRAN Mobility ............................8\n      4.4.\
    \ MN Serial ID ...............................................8\n   5. Attribute\
    \ Extensions ............................................8\n      5.1. AT_VIRTUAL_NETWORK_ID\
    \ ......................................8\n      5.2. AT_VIRTUAL_NETWORK_REQ .....................................9\n\
    \      5.3. AT_CONNECTIVITY_TYPE ......................................10\n  \
    \    5.4. AT_HANDOVER_INDICATION ....................................11\n    \
    \  5.5. AT_HANDOVER_SESSION_ID ....................................11\n      5.6.\
    \ AT_MN_SERIAL_ID ...........................................12\n   6. Security\
    \ Considerations ........................................13\n   7. IANA Considerations\
    \ ............................................14\n   8. References .....................................................15\n\
    \      8.1. Normative References ......................................15\n  \
    \    8.2. Informative References ....................................16\n   Acknowledgments\
    \ ...................................................18\n   Authors' Addresses\
    \ ................................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Wi-Fi has emerged as a \"trusted\" access technology for\
    \ mobile service\n   providers; see [EPC2] for reference to the 3rd Generation\
    \ Partnership\n   Project (3GPP) description of \"trusted\" access.  Advances\
    \ in IEEE\n   802.11u [IEEE802.11u] and \"HotSpot 2.0\" [hs20] have enabled seamless\n\
    \   roaming, in which a Mobile Node can select and connect to a Wi-Fi\n   access\
    \ network just as it would roam into a cellular network.  It has\n   thus become\
    \ important to provide certain functions in Wi-Fi that are\n   commonly supported\
    \ in licensed-spectrum networks such as 3G and 4G\n   networks.  This document\
    \ specifies a few new EAP attributes for an MN\n   to interact with the network\
    \ to support some of these functions (see\n   below).  These new attributes serve\
    \ as a trigger for Proxy Mobile\n   IPv6 network nodes to undertake the relevant\
    \ mobility operations.\n   For instance, when the MN requests a new IP session\
    \ (i.e., a new APN\n   in 3GPP) and the network agrees, the corresponding attribute\
    \ (defined\n   below) acts as a trigger for the Mobile Anchor Gateway (MAG) to\n\
    \   initiate a new mobility session with the Local Mobility Anchor (LMA).\n  \
    \ This document refers to [RFC6459] for the basic definitions of mobile\n   network\
    \ terminology (such as APN) used here.\n   The 3GPP networks support many functions\
    \ that are not commonly\n   implemented in a Wi-Fi network.  This document defines\
    \ EAP attributes\n   that enable the following functions in Wi-Fi access networks\
    \ using\n   EAP-AKA [RFC4187] and EAP-AKA' [RFC5448]:\n      o APN Selection\n\
    \      o Multiple APN Connectivity\n      o Wi-Fi to 3G/4G (Universal Terrestrial\
    \ Radio Access Network\n      (UTRAN) / Evolved UTRAN (E-UTRAN)) mobility\n  \
    \ The attributes defined here are exchanged between the MN and the EAP\n   server,\
    \ typically realized as part of the AAA server infrastructure\n   in a service\
    \ provider's infrastructure.  In particular, the Wi-Fi\n   access network simply\
    \ conveys the attributes to the service\n   provider's core network where the\
    \ EAP processing takes place [EPC].\n   Since these attributes share the same\
    \ IANA registry, the methods are\n   applicable to EAP-AKA, EAP-AKA', EAP Subscriber\
    \ Identity Modules\n   (EAP-SIM) [RFC4186], and with appropriate extensions, are\
    \ possibly\n   applicable for other EAP methods as well.  In addition to the trusted\n\
    \   Wi-Fi access networks, the attributes are applicable to any trusted\n   \"\
    non-3GPP\" access network that uses the EAP methods and provides\n   connectivity\
    \ to the mobile EPC, which provides connectivity for 3G,\n   4G, and other non-3GPP\
    \ access networks [EPC2].\n"
- title: 1.1.  APN Selection
  contents:
  - "1.1.  APN Selection\n   The 3GPP networks support the concept of an APN.  This\
    \ is defined in\n   [GPRS].  Each APN is an independent IP network with its own\
    \ set of IP\n   services.  When the MN attaches to the network, it may select\
    \ a\n   specific APN to receive desired services.  For example, to receive\n \
    \  generic Internet services, a user device may select APN \"Internet\";\n   and\
    \ to receive IP Multimedia Subsystems (IMS) voice services, it may\n   select\
    \ APN \"IMSvoice\".\n   In a Wi-Fi access scenario, an MN needs a way of sending\
    \ the desired\n   APN name to the network.  This document specifies a new attribute\
    \ to\n   propagate the APN information via EAP.  The agreed APN is necessary\n\
    \   for the Proxy Mobile IPv6 MAG to initiate a new session with the LMA.\n"
- title: 1.2.  Multiple APN Connectivity
  contents:
  - "1.2.  Multiple APN Connectivity\n   As an extension of APN Selection, an MN may\
    \ choose to connect to\n   multiple IP networks simultaneously.  3GPP provides\
    \ this feature via\n   additional Packet Data Protocol (PDP) contexts or additional\
    \ Packet\n   Data Network (PDN) connections and defines the corresponding set\
    \ of\n   signaling procedures.  In a trusted Wi-Fi network, an MN connects to\n\
    \   the first APN via DHCPv4 or IPv6 Router Solicitation.  This document\n   specifies\
    \ an attribute that indicates the MN's capability to support\n   multiple APN\
    \ connectivity.  The specific connectivity types are also\n   necessary for the\
    \ Proxy Mobile IPv6 signaling.\n"
- title: 1.3.  Wi-Fi to E-UTRAN Mobility
  contents:
  - "1.3.  Wi-Fi to E-UTRAN Mobility\n   When operating in a multiaccess network,\
    \ an MN may want to gracefully\n   handover its IP attachment from one access\
    \ network to another.  For\n   instance, an MN connected to a 3GPP E-UTRAN network\
    \ may choose to\n   move its connectivity to a trusted Wi-Fi network.  Alternatively,\
    \ the\n   MN may choose to connect using both access technologies\n   simultaneously\
    \ and maintain two independent IP attachments.  To\n   implement these scenarios,\
    \ the MN needs a way to correlate the UTRAN/\n   E-UTRAN session with the new\
    \ Wi-Fi session.  This document specifies\n   an attribute to propagate E-UTRAN\
    \ session identification to the\n   network via EAP.  This helps the network to\
    \ correlate the sessions\n   between the two Radio Access Network (RAN) technologies\
    \ and thus\n   helps the overall handover process.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n"
- title: 3.  Protocol Overview
  contents:
  - '3.  Protocol Overview

    '
- title: 3.1.  Brief Introduction to EAP
  contents:
  - "3.1.  Brief Introduction to EAP\n   EAP is defined as a generic protocol in [RFC3748].\
    \  EAP, combined\n   with one of the payload protocols such as EAP-AKA' [RFC5448]\
    \ can\n   accomplish several things in a network:\n   o  Establish the identity\
    \ of the user (MN) to the network.\n   o  Authenticate the user during the first\
    \ attach with the help of an\n      authentication center that securely maintains\
    \ the user\n      credentials.  This process is called \"EAP Authentication\"\
    .\n   o  Re-authenticate the user periodically, but without the overhead of\n\
    \      a round-trip to the authentication center.  This process is called\n  \
    \    \"EAP Fast Re-Authentication\".\n   This document makes use of the EAP Authentication\
    \ procedure.  The use\n   of the EAP Fast Re-Authentication procedure is for further\
    \ study.\n   Both the EAP Authentication and EAP Fast Re-Authentication procedures\n\
    \   are specified for trusted access network use in 3GPP[TS-33.402].\n"
- title: 3.2.  IEEE 802.11 Authentication Using EAP over 802.1X
  contents:
  - "3.2.  IEEE 802.11 Authentication Using EAP over 802.1X\n   In a Wi-Fi network,\
    \ EAP is carried over the IEEE 802.1X\n   Authentication protocol.  The IEEE 802.1X\
    \ Authentication is a\n   transparent, payload-unaware mechanism to carry the\
    \ authentication\n   messages between the MN and the Wi-Fi network elements.\n\
    \   EAP, on the other hand, has multiple purposes.  Apart from its core\n   functions\
    \ of communicating an MN's credentials to the network and\n   proving the MN's\
    \ identity, it also allows the MN to send arbitrary\n   information elements to\
    \ help establish the MN's IP session in the\n   network.  Figure 1 shows an example\
    \ of end-to-end EAP flow in the\n   context of an IEEE 802.11 Wi-Fi network. \
    \ We first define the\n   terminology:\n   o  MN: Mobile Node\n   o  WAN: Wi-Fi\
    \ Access Node, typically consisting of Wi-Fi Access Point\n      and Wi-Fi Controller.\
    \  The CAPWAP [RFC5415] protocol allows these\n      functions to be realized\
    \ in separate physical nodes or in a single\n      node.  In a Proxy Mobile IPv6\
    \ (PMIPv6) [RFC5213] network, the MAG\n      functionality is located in the WAN,\
    \ either in the Wi-Fi Access\n      Point or in the Wi-Fi Controller.\n   o  AAA:\
    \ The infrastructure node supporting the AAA server with the\n      EAP methods\
    \ (AKA, AKA', EAP-SIM).  The endpoints of the EAP method\n      are the MN and\
    \ the AAA server.\n   o  IPCN: IP Core Network.  This includes the PMIPv6 LMA\
    \ function.\n  MN                        WAN                        AAA      \
    \   IPCN\n                           (MAG)                                   (LMA)\n\
    \  1)|<----------Beacon--------|                         |             |\n  2)|<----------Probe-------->|\
    \                         |             |\n    |                         |   \
    \                      |             |\n    |              802.11 Auth|      \
    \                   |             |\n  3)|<----------------------->|         \
    \                |             |\n    |                         |            \
    \             |             |\n    |       802.11 Association|               \
    \          |             |\n  4)|<----------------------->|                  \
    \       |             |\n    |                         |                     \
    \    |             |\n  5)|<----EAP Req/Identity----|                        \
    \ |             |\n    |                         |                         | \
    \            |\n  6)|----EAP Resp/Identity----|->--EAP Resp/Identity--->|    \
    \         |\n    |                         |                         |       \
    \      |\n  7)|<-EAP Req/AKA-Challenge<-|--EAP Req/AKA-Challenge--|          \
    \   |\n    |                         |                         |             |\n\
    \  8)|-EAP Resp/AKA-Challenge--|>EAP Resp/AKA-Challenge->|             |\n   \
    \ |                         |                         |             |\n  9)|<-----EAP\
    \ Success------<-|------EAP Success--------|             |\n    |            \
    \             |                         |             |\n 10)|<====== 802.11 Data\
    \ ====>|<========== 802.11 Data ====Tunnel to=>|\n    |                      \
    \   |                         | core network|\n    |                         |\
    \                         |             |\n                     Figure 1: Example\
    \ EAP Deployment\n   1.   An MN detects a beacon from a WAP in the vicinity.\n\
    \   2.   The MN probes the WAP to determine suitability to attach (Verify\n  \
    \      Service Set Identifier (SSID) list, authentication type, and so\n     \
    \   on).\n   3.   The MN initiates the IEEE 802.11 Authentication with the Wi-Fi\n\
    \        network.  In Wi-Fi Protected Access (WPA) / WPA2 mode, this is\n    \
    \    an open authentication without any security credential\n        verification.\n\
    \   4.   The MN initiates 802.11 Association with the Wi-Fi network.\n   5.  \
    \ The Wi-Fi network initiates 802.1X/EAP Authentication procedures\n        by\
    \ sending EAP Request/Identity.\n   6.   The MN responds with its permanent or\
    \ temporary identity.\n   7.   The Wi-Fi network challenges the MN to prove its\
    \ identity by\n        sending EAP Request/AKA-Challenge.\n   8.   The MN calculates\
    \ the security digest and responds with EAP\n        Response/AKA-Challenge.\n\
    \   9.   If the authentication is successful, the Wi-Fi network responds\n   \
    \     to the MN with EAP Success.\n   10.  An end-to-end data path is available\
    \ for the MN to start IP\n        layer communication (DHCPv4, IPv6 Router Solicitation,\
    \ and so\n        on).\n"
- title: 4.  New EAP Attributes
  contents:
  - "4.  New EAP Attributes\n   The following subsections define the new EAP attributes\
    \ and their\n   usage.\n"
- title: 4.1.  APN Selection
  contents:
  - "4.1.  APN Selection\n   In a Wi-Fi network, an MN includes the AT_VIRTUAL_NETWORK_ID\n\
    \   attribute in the EAP-Response/AKA-Challenge to indicate the desired\n   APN\
    \ identity for the first PDN connection.\n   If the MN does not include the AT_VIRTUAL_NETWORK_ID\
    \ attribute in the\n   EAP-Response/AKA-Challenge, the network may select an APN\
    \ by other\n   means.  This selection mechanism is outside the scope of this\n\
    \   document.\n   An MN includes the AT_VIRTUAL_NETWORK_REQ attribute to indicate\n\
    \   single or multiple PDN capability.  In addition, a Sub type in the\n   attribute\
    \ indicates IPv4, IPv6, or dual IPv4v6 PDN connectivity.\n"
- title: 4.2.  Connectivity Type
  contents:
  - "4.2.  Connectivity Type\n   An MN indicates its preference for connectivity using\
    \ the\n   AT_CONNECTIVITY_TYPE attribute in the EAP-Response/AKA-Challenge\n \
    \  message.  The preference indicates whether the MN wishes connectivity\n   to\
    \ the Evolved Packet Core (the so-called \"EPC PDN connectivity\") or\n   Internet\
    \ Offload (termed as \"Non-Seamless Wireless Offload\").\n   The network makes\
    \ its decision and replies with the same attribute in\n   the EAP Success message.\n"
- title: 4.3.  Wi-Fi to UTRAN/E-UTRAN Mobility
  contents:
  - "4.3.  Wi-Fi to UTRAN/E-UTRAN Mobility\n   When a multiaccess MN enters a Wi-Fi\
    \ network, the following\n   parameters are applicable in the EAP-Response/AKA-Challenge\
    \ for IP\n   session continuity from UTRAN/E-UTRAN.\n   o  AT_HANDOVER_INDICATION:\
    \ This attribute indicates to the network\n      that the MN intends to continue\
    \ the IP session from UTRAN/E-UTRAN.\n      If a previous session can be located,\
    \ the network will honor this\n      request by connecting the Wi-Fi access to\
    \ the existing IP session.\n   o  AT_HANDOVER_SESSION_ID: An MN MAY use this attribute\
    \ to identify\n      the session on UTRAN/E-UTRAN.  If used, this attribute contains\n\
    \      Packet Temporary Mobile Subscriber Identity (P-TMSI) if the\n      previous\
    \ session was on UTRAN; if the previous session was on\n      E-UTRAN, it contains\
    \ Mobile Temporary Mobile Subscriber Identity\n      (M-TMSI).  This attribute\
    \ helps the network correlate the Wi-Fi\n      session to an existing UTRAN/E-UTRAN\
    \ session.\n"
- title: 4.4.  MN Serial ID
  contents:
  - "4.4.  MN Serial ID\n   The MN_SERIAL_ID attribute defines an MN's serial number,\
    \ including\n   International Mobile Equipment Identity (IMEI) and International\n\
    \   Mobile Equipment Identity Software Version (IMEISV).  The IMEI (or\n   IMEISV)\
    \ is used for ensuring a legitimate (and not a stolen) device\n   is in use. \
    \ As with the others, this attribute is exchanged with the\n   service provider's\
    \ AAA server.  The MN_SERIAL_ID MUST NOT be\n   propagated further by the AAA\
    \ server to any other node.\n"
- title: 5.  Attribute Extensions
  contents:
  - "5.  Attribute Extensions\n   The format for the new attributes follows that in\
    \ [RFC4187].  Note\n   that the Length field value is inclusive of the first two\
    \ bytes.\n"
- title: 5.1.  AT_VIRTUAL_NETWORK_ID
  contents:
  - "5.1.  AT_VIRTUAL_NETWORK_ID\n   The AT_VIRTUAL_NETWORK_ID attribute identifies\
    \ the virtual IP network\n   to which the MN intends to attach.  The implementation\
    \ of the virtual\n   network on the core network side is technology specific.\
    \  For\n   instance, in a 3GPP network, the virtual network is implemented based\n\
    \   on the 3GPP APN primitive.\n   This attribute SHOULD be included in the EAP-Response/AKA-Challenge\n\
    \   message.\n      0                   1                   2                \
    \   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |AT_VIRTUAL     | Length        | Virtual Network Id            |\n      |\
    \  _NETWORK_ID  |               |                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                  Virtual Network Id                           |\n   \
    \   |                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \               Figure 2: AT_VIRTUAL_NETWORK_ID EAP Attribute\n   Virtual Network\
    \ Id:\n   An arbitrary octet string that identifies a virtual network in the\n\
    \   access technology to which the MN is attaching.  For instance, in\n   3GPP\
    \ E-UTRAN, this could be an APN.  See [TS-23.003] for encoding of\n   the field.\n"
- title: 5.2.  AT_VIRTUAL_NETWORK_REQ
  contents:
  - "5.2.  AT_VIRTUAL_NETWORK_REQ\n   When an MN intends to connect an APN, it SHOULD\
    \ use this attribute to\n   indicate different capabilities to the network.  In\
    \ turn, the network\n   provides what is supported.\n   From the MN, this attribute\
    \ can be included only in EAP-Response/\n   Identity.  From the network, it SHOULD\
    \ be included in the EAP\n   Request/AKA-Challenge message.  In the MN-to-network\
    \ direction, the\n   Type field (below) indicates the MN's request.  In the network-to-MN\n\
    \   direction, the Type field indicates the network's willingness to\n   support\
    \ the request; a present Type field value indicates the network\n   support for\
    \ that Type.\n      0                   1                   2                \
    \   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |AT_VIRTUAL_    |     Length    |  Virt-Net-Req | Virt-Net-Req  |\n      |NETWORK_REQ\
    \    |               |     Type      |   Sub type    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \              Figure 3: AT_VIRTUAL_NETWORK_REQ EAP Attribute\n   Virt-Net-Req\
    \ Type:\n   Type can have one of the following values:\n   o  0: Reserved\n  \
    \ o  1: Single PDN connection\n   o  2: Multiple PDN connection.  Can request\
    \ Non-Seamless Wi-Fi\n      Offload or EPC connectivity (see the Connectivity\
    \ Type attribute\n      below)\n   Virt-Net-Req Sub type:\n   Sub type can have\
    \ one of the following values:\n   o  0: Reserved\n   o  1: PDN Type: IPv4\n \
    \  o  2: PDN Type: IPv6\n   o  3: PDN Type: IPv4v6\n"
- title: 5.3.  AT_CONNECTIVITY_TYPE
  contents:
  - "5.3.  AT_CONNECTIVITY_TYPE\n   An MN uses this attribute to indicate whether\
    \ it wishes the\n   connectivity type to be Non-Seamless WLAN Offload or EPC.\
    \  This\n   attribute is applicable for multiple PDN connections only.\n   From\
    \ the MN, this attribute can be included only in EAP-Response/\n   Identity. \
    \ From the network, it SHOULD be included in the EAP\n   Request/AKA-Challenge\
    \ message.\n      0                   1                   2                  \
    \ 3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \  |AT_CONNECTIVITY|     Length    | Connectivity  | Reserved      |\n      |_TYPE\
    \          |               | Type          |               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \               Figure 4: AT_CONNECTIVITY_TYPE EAP Attribute\n   Connectivity\
    \ Type:\n   Connectivity Type can have one of the following values:\n   o  0:\
    \ Reserved\n   o  1: Non-Seamless WLAN Offload (NSWO)\n   o  2: EPC PDN connectivity\n"
- title: 5.4.  AT_HANDOVER_INDICATION
  contents:
  - "5.4.  AT_HANDOVER_INDICATION\n   This attribute indicates an MN's handover intention\
    \ of an existing IP\n   attachment.\n   This attribute SHOULD be included in the\
    \ EAP-Response/AKA-Challenge\n   message.\n      0                   1       \
    \            2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |AT_HANDOVER_IND|     Length    | Handover      |   Pad         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      \
    \        Figure 5: AT_HANDOVER_INDICATION EAP Attribute\n   Handover Type:\n \
    \  o  0 - The MN has no intention of handing over an existing IP\n      session,\
    \ i.e., the MN is requesting an independent IP session with\n      the Wi-Fi network\
    \ without disrupting the IP session with the\n      UTRAN/E-UTRAN.  In this case,\
    \ no Session Id (Section 5.5) is\n      included.\n   o  1 - The MN intends to\
    \ handover an existing IP session.  In this\n      case, MN MAY include a Session\
    \ Id (Section 5.5) to correlate this\n      Wi-Fi session with a UTRAN/E-UTRAN\
    \ session.\n"
- title: 5.5.  AT_HANDOVER_SESSION_ID
  contents:
  - "5.5.  AT_HANDOVER_SESSION_ID\n   When an MN intends to handover an earlier IP\
    \ session to the current\n   access network, it may propagate a session identity\
    \ that can help\n   identify the previous session from UTRAN/E-UTRAN that the\
    \ MN intends\n   to handover.  This attribute is defined as a generic octet string.\n\
    \   The MN MAY include an E-UTRAN Globally Unique Temporary User\n   Equipment\
    \ Identity (GUTI) if the previous session was an E-UTRAN\n   session.  If the\
    \ previous session was a UTRAN session, the MN MAY\n   include a UTRAN Global\
    \ Radio Network Controller (RNC) ID (Mobile\n   Country Code (MCC), Mobile Network\
    \ Code (MNC), RNC ID) and P-TMSI\n   concatenated as an octet string.\n   This\
    \ attribute SHOULD be included in the EAP-Response/AKA-Challenge\n   message.\n\
    \   0                   1                   2                   3\n   0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |AT_HANDOVER_   |   Length      |  Access       |  Reserved     |\n   |  SESSION_ID\
    \   |               |  Technology   |               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                           Session Id                          |\n   |  \
    \                            ...                              |\n   |        \
    \                      ...                              |\n   |              \
    \                                                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \              Figure 6: AT_HANDOVER_SESSION_ID EAP Attribute\n   Access Technology:\n\
    \   This field represents the RAN technology from which the MN is\n   undergoing\
    \ a handover.\n   o  0: Reserved\n   o  1: UTRAN\n   o  2: E-UTRAN\n   Session\
    \ Id:\n   An octet string of variable length that identifies the session in the\n\
    \   source access technology.  As defined at the beginning of this\n   section,\
    \ the actual value is RAN technology dependent.  For E-UTRAN,\n   the value is\
    \ GUTI.  For UTRAN, the value is Global RNC ID (6 bytes)\n   followed by P-TMSI\
    \ (4 bytes).  See [TS-23.003] for encoding of the\n   field.\n"
- title: 5.6.  AT_MN_SERIAL_ID
  contents:
  - "5.6.  AT_MN_SERIAL_ID\n   This attribute defines the MN's machine serial number.\
    \  Examples are\n   IMEI and IMEISV.\n   A network that requires the machine serial\
    \ number for authorization\n   purposes MUST send a request for the attribute\
    \ in an EAP-Request/\n   AKA-Challenge message.  If the attribute is present,\
    \ the MN SHOULD\n   include the attribute in the EAP-Response/AKA-Challenge message.\
    \  If\n   the MN sends the attribute, it MUST be contained within an\n   AT_ENCR_DATA\
    \ attribute.  An MN MUST NOT provide the attribute unless\n   it receives the\
    \ request from a network authenticated via EAP/AKA.\n   0                   1\
    \                   2                   3\n   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |AT_MN_         |   Length      |  Serial ID    |  Reserved     |\n   |  SERIAL_ID\
    \    |               |    Type       |               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                           MN Serial Id                        |\n   |  \
    \                                                             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                  Figure 7: AT_MN_SERIAL_ID EAP Attribute\n   Serial ID Type:\n\
    \   This field identifies the type of the MN Identifier.\n   o  0: Reserved\n\
    \   o  1: IMEI\n   o  2: IMEISV\n   MN Serial Id:\n   An arbitrary octet string\
    \ that identifies the MN's machine serial\n   number.  The actual value is device\
    \ specific.  See [TS-23.003] for\n   encoding of the field.  When sent by the\
    \ network in the EAP-Request/\n   AKA-Challenge message, this field is not present,\
    \ which serves as an\n   indication for the MN to provide the attribute in the\
    \ EAP-Response/\n   AKA-Challenge message.\n   An AT_MN_SERIAL_ID attribute MUST\
    \ only be used with methods that can\n   provide mutual (network and device) authentication,\
    \ such as AKA,\n   AKA', and EAP-SIM.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   This document defines new EAP attributes to extend\
    \ the capability of\n   the EAP-AKA protocol as specified in Section 8.2 of [RFC4187].\
    \  The\n   attributes are passed between an MN and a AAA server in provider-\n\
    \   controlled, trusted Wi-Fi networks, where the Wi-Fi access network is\n  \
    \ a relay between the MN and the AAA server.  The document does not\n   specify\
    \ any new messages or options to the EAP-AKA protocol.\n   The attributes defined\
    \ here are fields that are used in existing 3G\n   and 4G networks, where they\
    \ are exchanged (in protocols specific to\n   3G and 4G networks) subsequent to\
    \ the mobile network authentication\n   (e.g., using the UMTS-AKA mechanism).\
    \  For the operator-controlled\n   Wi-Fi access that is connected to the same\
    \ core infrastructure as the\n   3G and 4G access, a similar model is followed\
    \ here with the EAP-AKA\n   (or EAP-AKA', EAP-SIM) authentication.  In doing so,\
    \ processing these\n   attributes, security-wise, is no worse than that in existing\
    \ 3G and\n   4G mobile networks.\n   The attributes inherit the security protection\
    \ (integrity, replay,\n   and confidentiality) provided by the parameters in the\
    \ AKA(') or SIM\n   methods; see Section 12.6 in [RFC4187].  Furthermore, RFC\
    \ 4187\n   requires attributes exchanged in EAP-Request/AKA-Identity or\n   EAP-Response/AKA-Identity\
    \ to be integrity-protected with\n   AT_CHECKCODE; see Section 8.2 in [RFC4187].\
    \  This requirement applies\n   to the AT_CONNECTIVITY_TYPE and AT_VIRTUAL_NETWORK_REQ\
    \ attributes\n   defined in this document.\n   The AT_MN_SERIAL_ID attribute MUST\
    \ have confidentiality protection\n   provided by the AKA(') or EAP-SIM methods\
    \ beyond the secure transport\n   (such as private leased lines, VPN, etc.) deployed\
    \ by the provider of\n   the trusted Wi-Fi service.\n   Use of identifiers such\
    \ as IMEI could have privacy implications,\n   wherein devices can be profiled\
    \ and tracked.  With additional\n   information, this could also lead to profiling\
    \ of user's network\n   access patterns.  Implementers should consult [hotos-2011],\
    \ and the\n   references therein, for a broader discussion and possible mitigation\n\
    \   methods on the subject.\n"
- title: 7.  IANA Considerations
  contents:
  - "7.  IANA Considerations\n   This document defines the following new skippable\
    \ EAP-AKA attributes.\n   These attributes have been assigned from the \"EAP-AKA\
    \ and EAP-SIM\n   Parameters\" registry at <https://www.iana.org/assignments/\n\
    \   eapsimaka-numbers>.\n   o  AT_VIRTUAL_NETWORK_ID (Section 5.1): 145\n   o\
    \  AT_VIRTUAL_NETWORK_REQ (Section 5.2): 146\n   o  AT_CONNECTIVITY_TYPE (Section\
    \ 5.3): 147\n   o  AT_HANDOVER_INDICATION (Section 5.4): 148\n   o  AT_HANDOVER_SESSION_ID\
    \ (Section 5.5): 149\n   o  AT_MN_SERIAL_ID (Section 5.6): 150\n   A new IANA\
    \ registry titled \"Trusted Non-3GPP Access EAP Parameters\"\n   has been created.\
    \  The range for both Types and Sub types in the\n   registry is 0 - 127, with\
    \ 0 (zero) being a reserved value.  IANA has\n   made assignments in a monotonically\
    \ increasing order in increments of\n   1, starting from 1.  New assignments in\
    \ this registry are made with\n   the Specification Required policy [RFC5226].\n\
    \   The IANA Designated Expert should review the requirements for new\n   assignments\
    \ based on factors including, but not limited to, the\n   source of request (e.g.,\
    \ standards bodies), deployment needs (e.g.,\n   industry consortium, operator\
    \ community), and experimental needs\n   (e.g., academia, industrial labs).  A\
    \ document outlining the purpose\n   of new assignments should accompany the request.\
    \  Such a document\n   could be a standards document or a research project description.\
    \  The\n   Designated Expert should consider that there is sufficient evidence\n\
    \   of potential usage both on the endpoints (e.g., Mobile Devices, etc.)\n  \
    \ and the infrastructure (e.g., AAA servers, gateways, etc.)\n   The following\
    \ fields have been assigned:\n   o  Virt-Net-Req Type (Section 5.2): 1\n   o \
    \ Virt-Net-Req Sub type (Section 5.2): 2\n   o  Connectivity Type (Section 5.3):\
    \ 3\n   o  Access Technology (Section 5.5): 4\n   o  Serial ID Type (Section 5.6):\
    \ 5\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.  Normative References
  contents:
  - "8.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n   [RFC4187]\
    \  Arkko, J. and H. Haverinen, \"Extensible Authentication\n              Protocol\
    \ Method for 3rd Generation Authentication and Key\n              Agreement (EAP-AKA)\"\
    , RFC4187, January 2006,\n              <http://www.rfc-editor.org/info/rfc4187>.\n\
    \   [RFC5226]  Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n   \
    \           IANA Considerations Section in RFCs\", BCP 26, RFC 5226,\n       \
    \       May 2008, <http://www.rfc-editor.org/info/rfc5226>.\n   [RFC6459]  Korhonen,\
    \ J., Ed., Soininen, J., Patil, B., Savolainen,\n              T., Bajko, G.,\
    \ and K. Iisakkila, \"IPv6 in 3rd Generation\n              Partnership Project\
    \ (3GPP) Evolved Packet System (EPS)\",\n              RFC 6459, January 2012,\n\
    \              <http://www.rfc-editor.org/info/rfc6459>.\n"
- title: 8.2.  Informative References
  contents:
  - "8.2.  Informative References\n   [EPC]      3GPP, \"General Packet Radio Service\
    \ (GPRS); enhancements\n              for Evolved Universal Terrestrial Radio\
    \ Access Network\n              (E-UTRAN) access\", TS 23.401 8.8.0, December\
    \ 2009,\n              <http://www.3gpp.org/ftp/Specs/html-info/23401.htm>.\n\
    \   [EPC2]     3GPP, \"Architecture enhancements for non-3GPP accesses\",\n  \
    \            TS 23.402 8.8.0, December 2009,\n              <http://www.3gpp.org/ftp/Specs/html-info/23402.htm>.\n\
    \   [GPRS]     3GPP, \"General Packet Radio Service (GPRS); Service\n        \
    \      description, Stage 2\", TS 23.060, December 2006,\n              <http://www.3gpp.org/ftp/Specs/html-info/23060.htm>.\n\
    \   [IEEE802.11u]\n              IEEE, \"IEEE Standard for Information Technology-\n\
    \              Telecommunications and information exchange between\n         \
    \     systems-Local and Metropolitan networks-specific\n              requirements-Part\
    \ II: Wireless LAN Medium Access Control\n              (MAC) and Physical Layer\
    \ (PHY) specifications: Amendment\n              9: Interworking with External\
    \ Networks\", IEEE Std 802.11u-\n              2011, February 2011, <http://standards.ieee.org/findstds/\n\
    \              standard/802.11u-2011.html>.\n   [RFC3748]  Aboba, B., Blunk, L.,\
    \ Vollbrecht, J., Carlson, J., and H.\n              Levkowetz, Ed., \"Extensible\
    \ Authentication Protocol\n              (EAP)\", RFC3748, June 2004,\n      \
    \        <http://www.rfc-editor.org/info/rfc3748.txt>.\n   [RFC4186]  Haverinen,\
    \ H., Ed. and J. Salowey, Ed., \"Extensible\n              Authentication Protocol\
    \ Method for Global System for\n              Mobile Communications (GSM) Subscriber\
    \ Identity Modules\n              (EAP-SIM)\", RFC 4186, January 2006,\n     \
    \         <http://www.rfc-editor.org/info/rfc4186>.\n   [RFC5213]  Gundavelli,\
    \ S., Ed., Leung, K., Devarapalli, V.,\n              Chowdhury, K., and B. Patil,\
    \ \"Proxy Mobile IPv6\", RFC\n              5213, August 2008,\n             \
    \ <http://www.rfc-editor.org/info/rfc5213>.\n   [RFC5415]  Calhoun, P., Montemurro,\
    \ M., and D. Stanley, \"Control And\n              Provisioning of Wireless Access\
    \ Points (CAPWAP) Protocol\n              Specification\", RFC5415, January 2009,\n\
    \              <http://www.rfc-editor.org/info/rfc5415.txt>.\n   [RFC5448]  Arkko,\
    \ J., Lehtovirta, V., and P. Eronen, \"Improved\n              Extensible Authentication\
    \ Protocol Method for 3rd\n              Generation Authentication and Key Agreement\
    \ (EAP-AKA')\",\n              RFC 5448, May 2009,\n              <http://www.rfc-editor.org/info/rfc5448>.\n\
    \   [TS-23.003]\n              3GPP, \"Numbering, addressing and identification\"\
    , TS\n              23.003 12.2.0, March 2014,\n              <http://www.3gpp.org/ftp/Specs/html-info/23003.htm>.\n\
    \   [TS-33.402]\n              3GPP, \"3GPP System Architecture Evolution (SAE);\
    \ Security\n              aspects of non-3GPP accesses\", TS 33.402 8.6.0, December\n\
    \              2009, <http://www.3gpp.org/ftp/Specs/html-info/33402.htm>.\n  \
    \ [hotos-2011]\n              Wetherall, et al., D., \"Privacy Revelations for\
    \ Web and\n              Mobile Apps\", Proceedings of the Hot Topics in Operating\n\
    \              Systems (HotOS), May 2011,\n              <https://www.usenix.org/legacy/events/hotos11/tech/>.\n\
    \   [hs20]     \"Hotspot 2.0 (Release 2) Technical Specification Package\n   \
    \           v1.0.0\", <https://www.wi-fi.org/hotspot-20-release-2-\n         \
    \     technical-specification-package-v100>.\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   Thanks to Sebastian Speicher for the review and suggesting\n\
    \   improvements.  Thanks to Mark Grayson for proposing the MN Serial ID\n   attribute,\
    \ and thanks to Brian Haberman for suggesting a new\n   registry.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ravi Valmikam\n   Unaffiliated\n   United States\n   EMail:\
    \ valmikam@gmail.com\n   Rajeev Koodli\n   Intel\n   United States\n   EMail:\
    \ rajeev.koodli@intel.com\n"
