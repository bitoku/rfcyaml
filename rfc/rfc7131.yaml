- title: __initial_text__
  contents:
  - ''
- title: Session Initiation Protocol (SIP) History-Info Header Call Flow Examples
  contents:
  - 'Session Initiation Protocol (SIP) History-Info Header Call Flow Examples

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes use cases and documents call flows that\n\
    \   require the History-Info header field to capture the Request-URIs as\n   a\
    \ Session Initiation Protocol (SIP) Request is retargeted.  The use\n   cases\
    \ are described along with the corresponding call flow diagrams\n   and messaging\
    \ details.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7131.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2014 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Overview ........................................................2\n\
    \   2. Conventions and Terminology .....................................3\n  \
    \ 3. Detailed Call Flows .............................................3\n    \
    \  3.1. Sequentially Forking (History-Info in Response) ............3\n      3.2.\
    \ History-Info with Privacy Header Field ....................11\n      3.3. Privacy\
    \ for a Specific History-Info Entry .................16\n      3.4. Automatic\
    \ Call Distribution ...............................20\n      3.5. Determining\
    \ the Alias Used ................................27\n      3.6. PBX Voicemail\
    \ Example .....................................29\n      3.7. Consumer Voicemail\
    \ Example ................................35\n      3.8. GRUU ......................................................41\n\
    \      3.9. Limited-Use Address .......................................44\n  \
    \    3.10. Service Invocation .......................................47\n    \
    \  3.11. Toll-Free Number .........................................48\n   4. Security\
    \ Considerations ........................................51\n   5. Acknowledgements\
    \ ...............................................51\n   6. Informative References\
    \ .........................................51\n"
- title: 1.  Overview
  contents:
  - "1.  Overview\n   Many services that use SIP require the ability to determine\
    \ why and\n   how the call arrived at a specific application.  The use cases\n\
    \   provided in this document illustrate the use of the History-Info\n   header\
    \ [RFC7044], for example, applications and common scenarios.\n   The optional\
    \ \"rc\" and \"mp\" header field parameters defined in\n   [RFC7044] are required\
    \ for several of the use cases.  Descriptions of\n   the example use cases, call\
    \ flow diagrams, and messaging details are\n   provided.\n"
- title: 2.  Conventions and Terminology
  contents:
  - "2.  Conventions and Terminology\n   The term \"retarget\" is used as defined\
    \ in [RFC7044].  The terms\n   \"location service\", \"redirect\", and \"address-of-record\
    \ (AOR)\" are\n   used consistent with the terminology in [RFC3261].\n"
- title: 3.  Detailed Call Flows
  contents:
  - "3.  Detailed Call Flows\n   The scenarios in this section provide sample use\
    \ cases for the\n   History-Info header for informational purposes only.  They\
    \ are not\n   intended to be normative.  In many cases, only the relevant messaging\n\
    \   details are included in the body of the call flow.\n"
- title: 3.1.  Sequentially Forking (History-Info in Response)
  contents:
  - "3.1.  Sequentially Forking (History-Info in Response)\n   This scenario highlights\
    \ an example where the History-Info in the\n   response is useful to an application\
    \ or user that originated the\n   request.\n   Alice sends a call to Bob via sip:example.com.\
    \  The proxy\n   sip:example.com sequentially tries Bob on a SIP User Agent (UA)\
    \ that\n   has bound a contact with the sip:bob@example.com AOR, and then\n  \
    \ several alternate addresses (Office and Home) unsuccessfully before\n   sending\
    \ a response to Alice.  The hi-entry containing the initial\n   contact is the\
    \ hi-entry just prior to the first hi-entry tagged with\n   an \"rc\" header field\
    \ parameter.  In this example, the Office and Home\n   are not the same AOR as\
    \ sip:bob@example.com, but rather different\n   AORs that have been configured\
    \ as alternate addresses for Bob in the\n   proxy.  In other words, Office and\
    \ Home are not bound through SIP\n   Registration with Bob's AOR.  This type of\
    \ arrangement is common, for\n   example, when a \"routing\" rule to a Public\
    \ Switched Telephone Network\n   (PSTN) number is manually configured in a proxy.\
    \  These hi-entries\n   are identified by the index contained in the hi-target-param\
    \ \"mp\"\n   header field parameter in the hi-entries.\n   This scenario illustrates\
    \ that by providing the History-Info to\n   Alice, the end-user, or an application\
    \ at Alice could make a decision\n   on how best to attempt finding Bob without\
    \ sending multiple requests\n   to the same destination.  Upon receipt of the\
    \ response containing the\n   History-Info entries, the Request-URIs for the History-Info\
    \ entries\n   tagged with an \"mp\" header field parameter are extracted.  Those\n\
    \   Request-URIs can be compared to other URIs (if any) that might be\n   attempted\
    \ in order to establish the session with Bob.  This results\n   in avoiding the\
    \ sending of another INVITE to Bob's home phone.\n   Without this mechanism, Alice\
    \ might well attempt to reach Bob at his\n   office phone, which would then retarget\
    \ the request to Bob's home\n   phone.  When that attempt failed, then Alice might\
    \ attempt to reach\n   Bob directly at his home phone, unknowingly for a third\
    \ time.\n     Alice   example.com            Bob     Office    Home\n     |  \
    \          |                  |        |        |\n     | INVITE F1  |       \
    \           |        |        |\n     |----------->|    INVITE F2     |      \
    \  |        |\n     |            |----------------->|        |        |\n    \
    \ | 100 Trying F3                 |        |        |\n     |<-----------|  302\
    \ Move Temporarily F4  |        |\n     |            |<-----------------|    \
    \    |        |\n     |            |   ACK F5         |        |        |\n  \
    \   |            |----------------->|        |        |\n     |            | \
    \      INVITE F6           |        |\n     |            |-------------------------->|\
    \        |\n     |            |      180 Ringing F7       |        |\n     | \
    \           |<--------------------------|        |\n     |  180 Ringing F8   \
    \                     |        |\n     |<-----------|   retransmit INVITE    \
    \   |        |\n     |            |-------------------------->|        |\n   \
    \  |            |      ( timeout )          |        |\n     |            |  \
    \           INVITE F9              |\n     |            |----------------------------------->|\n\
    \     |            |           100 Trying F10           |\n     |            |<-----------------------------------|\n\
    \     |            |           486 Busy Here F11        |\n     |            |<-----------------------------------|\n\
    \     |  486 Busy Here F12                              |\n     |<-----------|\
    \             ACK F13                |\n     |            |----------------------------------->|\n\
    \     |  ACK F14   |                                    |\n     |----------->|\
    \                                    |\n                 Figure 1: Example with\
    \ Sequential Forking\n   Message Details\n   F1 INVITE Alice -> example.com\n\
    \   INVITE sip:bob@example.com SIP/2.0\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 70\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To:\
    \ Bob <sip:bob@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:bob@example.com>;index=1\n   Contact:\
    \ Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F2 INVITE  example.com -> Bob\n\
    \   INVITE sip:bob@192.0.2.4 SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx3st\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   Record-Route: <sip:proxy.example.com;lr>\n   History-Info: <sip:bob@example.com>;index=1\n\
    \   History-Info: <sip:bob@192.0.2.4>;index=1.1;rc=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F3 100 Trying example.com -> Alice\n   SIP/2.0 100 Trying\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n\
    \   To: Bob <sip:bob@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   Content-Length: 0\n   F4 302 Moved Temporarily Bob -> example.com\n\
    \   SIP/2.0 302 Moved Temporarily\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx3st\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n\
    \   To: Bob <sip:bob@example.com>;tag=es43sd\n   Supported: histinfo\n   Call-ID:\
    \ 12345600@example.com\n   CSeq: 1 INVITE\n   History-Info: <sip:bob@example.com>;index=1\n\
    \   History-Info: <sip:bob@192.0.2.4>;index=1.1;rc=1\n   Contact: <sip:office@example.com>;mp=1\n\
    \   Content-Length: 0\n   F5 ACK example.com -> Bob\n   ACK sip:bob@example.com\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx3st\n   Max-Forwards:\
    \ 70\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To: Bob <sip:bob@example.com>;tag=es43sd\n\
    \   Call-ID: 12345600@example.com\n   CSeq: 1 ACK\n   Content-Length: 0\n   F6\
    \ INVITE example.com -> office\n   INVITE sip:office@192.0.2.5 SIP/2.0\n   Via:\
    \ SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx4st\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 69\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To:\
    \ Bob <sip:bob@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   Record-Route: <sip:proxy.example.com;lr>\n   History-Info: <sip:bob@example.com>;index=1\n\
    \   History-Info: <sip:bob@192.0.2.4?Reason=SIP%3Bcause%3D302>;\\\n          \
    \       index=1.1;rc=1\n   History-Info: <sip:office@example.com>;index=1.2;mp=1\n\
    \   History-Info: <sip:office@192.0.2.5>;index=1.2.1;rc=1.2\n   CSeq: 1 INVITE\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F7 180 Ringing\
    \ office -> example.com\n   SIP/2.0 180 Ringing\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx4st\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n\
    \   To: Bob <sip:bob@example.com>;tag=53rdds\n   Supported: histinfo\n   Call-ID:\
    \ 12345600@example.com\n   Record-Route: <sip:proxy.example.com;lr>\n   History-Info:\
    \ <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.4?Reason=SIP%3Bcause%3D302>;\\\
    \n                 index=1.1;rc=1\n   History-Info: <sip:office@example.com>;index=1.2;mp=1\n\
    \   History-Info: <sip:office@192.0.2.5>;index=1.2.1;rc=1.2\n   CSeq: 1 INVITE\n\
    \   Contact: Office <sip:office@192.0.2.5>\n   Content-Length: 0\n   F8 180 Ringing\
    \ example.com -> Alice\n   SIP/2.0 180 Ringing\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To: Bob <sip:bob@example.com>;tag=53rdds\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   Record-Route: <sip:proxy.example.com;lr>\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.4?Reason=SIP%3Bcause%3D302>;\\\
    \n                 index=1.1;rc=1\n   History-Info: <sip:office@example.com>;index=1.2;mp=1\n\
    \   History-Info: <sip:office@192.0.2.5>;index=1.2.1;rc=1.2\n   CSeq: 1 INVITE\n\
    \   Contact: Office <sip:office@192.0.2.5>\n   Content-Length: 0\n   F9 INVITE\
    \ example.com -> home\n   INVITE sip:home@192.0.2.6 SIP/2.0\n   Via: SIP/2.0/TCP\
    \ proxy.example.com:5060;branch=z9hG4bKx5st\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 69\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To:\
    \ Bob <sip:bob@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   Record-Route: <sip:proxy.example.com;lr>\n   History-Info: <sip:bob@example.com>;index=1\n\
    \   History-Info: <sip:bob@192.0.2.4?Reason=SIP%3Bcause%3D302>;\\\n          \
    \       index=1.1;rc=1\n   History-Info: <sip:office@example.com?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2;mp=1\n   History-Info: <sip:office@192.0.2.5?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2.1;rc=1.2\n   History-Info: <sip:home@example.com>;index=1.3;mp=1\n\
    \   History-Info: <sip:home@192.0.2.6>;index=1.3.1;rc=1.3\n   CSeq: 1 INVITE\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F10 100 Trying\
    \ home -> example.com\n   SIP/2.0 100 Trying\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx5st\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n\
    \   To: Bob <sip:bob@example.com>\n   Call-ID: 12345600@example.com\n   CSeq:\
    \ 1 INVITE\n   Content-Length: 0\n   F11 486 Busy Here home -> example.com\n \
    \  SIP/2.0  486 Busy Here\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx5st\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n\
    \   To: Bob <sip:bob@example.com>;tag=55rdds\n   Call-ID: 12345600@example.com\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.4?Reason=SIP%3Bcause%3D302>;\\\
    \n                 index=1.1;rc=1\n   History-Info: <sip:office@example.com?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2;mp=1\n   History-Info: <sip:office@192.0.2.5?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2.1;rc=1.2\n   History-Info: <sip:home@example.com>;index=1.3;mp=1\n\
    \   History-Info: <sip:home@192.0.2.6>;index=1.3.1;rc=1.3\n   CSeq: 1 INVITE\n\
    \   Content-Length: 0\n   F12 486 Busy Here example.com -> Alice\n   SIP/2.0 \
    \ 486 Busy Here\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   From:\
    \ Alice <sip:alice@example.com>;tag=sr3dds\n   To: Bob <sip:bob@example.com>;tag=55rdds\n\
    \   Call-ID: 12345600@example.com\n   History-Info: <sip:bob@example.com>;index=1\n\
    \   History-Info: <sip:bob@192.0.2.4?Reason=SIP%3Bcause%3D302>;\\\n          \
    \       index=1.1;rc=1\n   History-Info: <sip:office@example.com?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2;mp=1\n   History-Info: <sip:office@192.0.2.5?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2.1;rc=1.2\n   History-Info: <sip:home@example.com>;index=1.3;mp=1\n\
    \   History-Info: <sip:home@192.0.2.6>;index=1.3.1;rc=1.3\n   CSeq: 1 INVITE\n\
    \   Content-Length: 0\n   F13 ACK example.com -> home\n   ACK sip:home@192.0.2.6\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKx5st\n   Max-Forwards:\
    \ 70\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n   To: Bob <sip:bob@example.com>;tag=55rdds\n\
    \   Call-ID: 12345600@example.com\n   CSeq: 1 ACK\n   Content-Length: 0\n   F14\
    \ ACK Alice -> example.com\n   ACK sip:bob@example.com SIP/2.0\n   Via: SIP/2.0/TCP\
    \ 192.0.2.3:5060;branch=z9hG4bK4321\n   Max-Forwards: 70\n   From: Alice <sip:alice@example.com>;tag=sr3dds\n\
    \   To: Bob <sip:bob@example.com>;tag=55rdds\n   Call-ID: 12345600@example.com\n\
    \   Route: <sip:proxy.example.com;lr>\n   CSeq: 1 ACK\n   Content-Length: 0\n"
- title: 3.2.  History-Info with Privacy Header Field
  contents:
  - "3.2.  History-Info with Privacy Header Field\n   This is an example of the use\
    \ of the Privacy header field with a\n   value of \"history\" added by an intermediary.\
    \  The intermediary\n   responsible for the biloxi.example.com domain adds a Privacy\
    \ header\n   field with a value of \"history\" indicating that all the History-Info\n\
    \   header field information is anonymized outside the biloxi.example.com\n  \
    \ domain.\n      Alice  atlanta.example.com  biloxi.example.com  Bob Work  Bob\
    \ Home\n      |             |                |                 |          |\n\
    \      | INVITE F1   |                |                 |          |\n      |------------>|\
    \                |                 |          |\n      |             |       \
    \         |                 |          |\n      |             |   INVITE F2  \
    \  |                 |          |\n      |             |--------------->|    \
    \             |          |\n      |             |                |           \
    \      |          |\n      |             |                | INVITE F3       |\
    \          |\n      |             |                |---------------->|       \
    \   |\n      |             |                |302 Move Temporarily F4     |\n \
    \     |             |                |<----------------|          |\n      | \
    \            |                |    ACK F5       |          |\n      |        \
    \     |                |---------------->|          |\n      |             | \
    \               |                 |          |\n      |             |        \
    \        | INVITE F6       |          |\n      |             |               \
    \ |--------------------------->|\n      |             |                |     200\
    \ F7      |          |\n      |             |                |<---------------------------|\n\
    \      |             |                |                 |          |\n      |\
    \             |     200 F8     |                 |          |\n      |       \
    \      |<---------------|                 |          |\n      |             |\
    \                |                 |          |\n      |     200 F9  |       \
    \         |                 |          |\n      |<------------|              \
    \  |                 |          |\n      |             |                |    \
    \             |          |\n      |             |       ACK      |           \
    \      |          |\n      |---------------------------------------------------------->|\n\
    \      |             |                |                 |          |\n       \
    \        Figure 2: Example with Privacy Header Fields\n   Message Details\n  \
    \ F1 INVITE Alice -> atlanta.example.com\n   INVITE sip:bob@biloxi.example.com;p=x\
    \ SIP/2.0\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   Max-Forwards:\
    \ 70\n   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>\n\
    \   Supported: histinfo\n   Privacy: history\n   Call-ID: 12345600@atlanta.example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F2 INVITE  atlanta.example.com\
    \ -> biloxi.example.com\n   INVITE sip:bob@biloxi.example.com;p=x SIP/2.0\n  \
    \ Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2\n   Via:\
    \ SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   Max-Forwards: 69\n   From:\
    \ Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1\
    \ INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1.1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F3 INVITE  biloxi.example.com -> Bob Work\n   INVITE sip:bob@192.0.1.11\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKgs33\n\
    \   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\n  \
    \                received=192.0.2.3\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 68\n   From: Alice <sip:alice@atlanta.example.com>;tag=22\n\
    \   To: Bob <sip:bob@biloxi.example.com>\n   Privacy: history\n   Supported: histinfo\n\
    \   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1 INVITE\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1.1\n\
    \   History-Info: <sip:bob@192.0.1.11>;index=1.1.1;rc=1.1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F4 302 Moved Temporarily Bob Work -> biloxi.example.com\n\
    \   SIP/2.0 302 Moved Temporarily\n   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKgs33;\\\
    \n                    received=192.0.2.102\n   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\
    \n                  received=192.0.2.3\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=11\n\
    \   Privacy: history\n   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n\
    \   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1.1\n   History-Info:\
    \ <sip:bob@192.0.1.11>;index=1.1.1;rc=1.1\n   Contact: Bob Home <sip:bob@192.0.1.15>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F5 ACK  biloxi.example.com -> Bob Work\n   ACK sip:bob@192.0.1.11\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKgs33\n\
    \   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\n  \
    \                received=192.0.2.3\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 68\n   From: Alice <sip:alice@atlanta.example.com>;tag=22\n\
    \   To: Bob <sip:bob@biloxi.example.com>;tag=11\n   Call-ID: 12345600@atlanta.example.com\n\
    \   CSeq: 1 ACK\n   Content-Length: <appropriate value>\n   [SDP Not Shown]\n\
    \   F6 INVITE  biloxi.example.com -> Bob Home\n   INVITE sip:bob@192.0.1.15 SIP/2.0\n\
    \   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKgs32\n   Via:\
    \ SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\n         \
    \         received=192.0.2.3\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 68\n   From: Alice <sip:alice@atlanta.example.com>;tag=22\n\
    \   To: Bob <sip:bob@biloxi.example.com>\n   Privacy: history\n   Supported: histinfo\n\
    \   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1 INVITE\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1.1\n\
    \   History-Info: <sip:bob@192.0.1.11?Reason=SIP%3Bcause%3D302>;\\\n         \
    \          index=1.1.1;rc=1\n   History-Info: <sip:bob@192.0.1.15>;index=1.1.2\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F7 200 OK  Bob\
    \ -> biloxi.example.com\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKgs32;\\\
    \n                  received=192.0.2.101\n   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\
    \n                  received=192.0.2.3\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=33\n\
    \   Privacy: history\n   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n\
    \   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1.1\n   History-Info:\
    \ <sip:bob@192.0.1.11?Reason=SIP%3Bcause%3D302>;\\\n                   index=1.1.1;rc=1\n\
    \   History-Info: <sip:bob@192.0.1.15>;index=1.1.2;rc=1.1\n   Content-Type: application/sdp\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F8 200 OK  biloxi.example.com\
    \ -> atlanta.example.com\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\
    \n                  received=192.0.2.3\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=33\n\
    \   Privacy: history\n   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:anonymous@anonymous.invalid>;index=1\n\
    \   History-Info: <sip:anonymous@anonymous.invalid>;index=1.1\n   History-Info:\
    \ <sip:anonymous@anonymous.invalid>;index=1.1.1;rc=1\n   History-Info: <sip:anonymous@anonymous.invalid>;index=1.1.2;rc=1.1\n\
    \   Contact: Bob <sip:bob@192.0.1.11>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F9 200 OK  atlanta.example.com ->\
    \ Alice\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=33\n\
    \   Privacy: history\n   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:anonymous@anonymous.invalid>;index=1\n\
    \   History-Info: <sip:anonymous@anonymous.invalid>;index=1.1\n   History-Info:\
    \ <sip:anonymous@anonymous.invalid>;index=1.1.1;rc=1\n   History-Info: <sip:anonymous@anonymous.invalid>;index=1.1.2;rc=1.1\n\
    \   Contact: Bob <sip:bob@192.0.1.11>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n"
- title: 3.3.  Privacy for a Specific History-Info Entry
  contents:
  - "3.3.  Privacy for a Specific History-Info Entry\n   This example provides a basic\
    \ call scenario similar to Section 3.2;\n   however, due to local policy at sip:biloxi.example.com,\
    \ only the\n   final hi-entry in the History-Info, which is Bob's local URI,\n\
    \   contains a privacy header field with a priv-value of \"history\", thus\n \
    \  providing Alice with some information about the history of the\n   request,\
    \ but anonymizing Bob's local URI.\n   Alice   atlanta.example.com  biloxi.example.com\
    \   Bob\n   |                |                |                |\n   |   INVITE\
    \ F1    |                |                |\n   |--------------->|           \
    \     |                |\n   |                |                |             \
    \   |\n   |                |   INVITE F2    |                |\n   |         \
    \       |--------------->|                |\n   |                |           \
    \     |                |\n   |                |                | INVITE F3   \
    \   |\n   |                |                |--------------->|\n   |         \
    \       |                |                |\n   |                |           \
    \     |     200 F4     |\n   |                |                |<---------------|\n\
    \   |                |                |                |\n   |               \
    \ |     200 F5     |                |\n   |                |<---------------|\
    \                |\n   |                |                |                |\n\
    \   |     200 F6     |                |                |\n   |<---------------|\
    \                |                |\n   |                |                |  \
    \              |\n   |                |       ACK      |                |\n  \
    \ |------------------------------------------------->|\n   |                |\
    \                |                |\n       Figure 3: Example with Privacy Header\
    \ Field for Specific URI\n   Message Details\n   F1 INVITE Alice -> atlanta.example.com\n\
    \   INVITE sip:bob@biloxi.example.com;p=x SIP/2.0\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 70\n   From: Alice <sip:alice@atlanta.example.com>;tag=22\n\
    \   To: Bob <sip:bob@biloxi.example.com>\n   Supported: histinfo\n   Call-ID:\
    \ 12345600@atlanta.example.com\n   CSeq: 1 INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F2 INVITE  atlanta.example.com\
    \ -> biloxi.example.com\n   INVITE sip:bob@biloxi.example.com;p=x SIP/2.0\n  \
    \ Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2\n   Via:\
    \ SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n   Max-Forwards: 69\n   From:\
    \ Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1\
    \ INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1.1;np=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F3 INVITE  biloxi.example.com -> Bob\n   INVITE sip:bob@192.0.1.11\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKeset\n\
    \   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\n  \
    \                received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   Max-Forwards: 68\n   From: Alice <sip:alice@atlanta.example.com>;tag=22\n\
    \   To: Bob <sip:bob@biloxi.example.com>\n   Supported: histinfo\n   Call-ID:\
    \ 12345600@atlanta.example.com\n   CSeq: 1 INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n\
    \   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1.1;np=1\n   History-Info:\
    \ <sip:bob@192.0.1.11?Privacy=history>;index=1.1.1;rc=1.1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F4 200 OK  Bob -> biloxi.example.com\n   SIP/2.0 200 OK\n\
    \   Via: SIP/2.0/TCP proxy.biloxi.example.com:5060;branch=z9hG4bKeset;\\\n   \
    \               received=192.0.2.5\n   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\
    \n                  received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=33\n\
    \   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1\
    \ INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1.1;np=1\n   History-Info: <sip:bob@192.0.1.11?Privacy=history>;index=1.1.1;rc=1.1\n\
    \   Contact: Bob <sip:bob@192.0.1.11>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F5 200 OK  biloxi.example.com ->\
    \ atlanta.example.com\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP proxy.atlanta.example.com:5060;branch=z9hG4bKbst2;\\\
    \n                  received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=33\n\
    \   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1\
    \ INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1.1;np=1\n   History-Info: <sip:anonymous@anonymous.invalid>;index=1.1.1;rc=1.1\n\
    \   Contact: Bob <sip:bob@192.0.1.11>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F6 200 OK  atlanta.example.com ->\
    \ Alice\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK4321\n\
    \   From: Alice <sip:alice@atlanta.example.com>;tag=22\n   To: Bob <sip:bob@biloxi.example.com>;tag=33\n\
    \   Supported: histinfo\n   Call-ID: 12345600@atlanta.example.com\n   CSeq: 1\
    \ INVITE\n   History-Info: <sip:bob@biloxi.example.com;p=x>;index=1\n   History-Info:\
    \ <sip:bob@biloxi.example.com;p=x>;index=1.1;np=1\n   History-Info: <sip:anonymous@anonymous.invalid>;index=1.1.1;rc=1.1\n\
    \   Contact: Bob <sip:bob@192.0.1.11>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n"
- title: 3.4.  Automatic Call Distribution
  contents:
  - "3.4.  Automatic Call Distribution\n   This scenario highlights an example of\
    \ an Automatic Call Distribution\n   service, where the agents are divided into\
    \ groups based upon the type\n   of customers they handle.  In this example, the\
    \ Gold customers are\n   given higher priority than Silver customers, so a Gold\
    \ call would get\n   serviced even if all the agents servicing the Gold group\
    \ were busy,\n   by retargeting the request to the Silver Group for delivery to\
    \ an\n   agent.  Upon receipt of the call at the agent assigned to handle the\n\
    \   incoming call, based upon the History-Info header in the message, the\n  \
    \ application at the agent can provide an indication that this is a\n   Gold call\
    \ by extracting the hi-entry associated with the incoming\n   request, which is\
    \ determined by locating the hi-entry whose index is\n   reflected in the first\
    \ hi-entry with a hi-target of \"mp\".  In the\n   example, this would be the\
    \ hi-entry referenced by the value of the\n   first \"mp\" header field parameter,\
    \ i.e., the hi-entry containing an\n   index of \"1\".  An application can also\
    \ determine how many groups from\n   which the call may have overflowed before\
    \ reaching the agent, etc.,\n   and present the information to the agent so that\
    \ the call can be\n   handled appropriately, i.e., \"I'm so sorry for the delay,\
    \ blah, blah,\n   blah...\"\n   For scenarios whereby calls might overflow from\
    \ the Silver to the\n   Gold, clearly the alternate group identification, internal\
    \ routing,\n   or actual agent that handles the call should not be sent to UA1.\n\
    \   Thus, for this scenario, one would expect that the proxy would not\n   support\
    \ the sending of the History-Info in the response, even if\n   requested by Alice\
    \ or the proxy could anonymize the Silver related\n   hi-entries by adding privacy\
    \ in the Silver hi-entries.\n   As with the other examples, this is not a complete\
    \ prescription of\n   how one would do this type of service but an example of\
    \ a subset of\n   processing that might be associated with such a service.  In\n\
    \   addition, this example does not address any aspects of agent\n   availability\
    \ resulting in the call being sent to an agent in another\n   group, which might\
    \ also be done via a SIP interface.\n   Alice       example.com     Gold     \
    \     Silver       Agent\n   |              |              |             |   \
    \         |\n   | INVITE F1    |              |             |            |\n \
    \  |------------->|              |             |            |\n   |          \
    \    |              |             |            |\n   |              |  INVITE\
    \ F2   |             |            |\n   |              |------------->|      \
    \       |            |\n   |              |              |             |     \
    \       |\n   |              |  302 Moved Temporarily F3  |            |\n   |\
    \              |<-------------|             |            |\n   |             \
    \ |              |             |            |\n   |              |      ACK  \
    \   |             |            |\n   |              |------------->|         \
    \    |            |\n   |              |              |             |        \
    \    |\n   |              |  INVITE F4   |             |            |\n   |  \
    \            |--------------------------->|            |\n   |              |\
    \              |             |            |\n   |              |             \
    \ |             | INVITE F5  |\n   |              |              |           \
    \  |----------->|\n   |              |              |             |          \
    \  |\n   |              |              |             |  200 OK F6 |\n   |    \
    \          |              |             |<-----------|\n   |              |  \
    \            |             |            |\n   |              |         200 OK\
    \ F7          |            |\n   |              |<---------------------------|\
    \            |\n   |              |              |             |            |\n\
    \   |  200 OK F8   |              |             |            |\n   |<-------------|\
    \              |             |            |\n   |              |             \
    \ |             |            |\n   |                         ACK F9          \
    \               |\n   |------------------------------------------------------->|\n\
    \           Figure 4: Example for Automatic Call Distribution\n   Message Details\n\
    \   F1 INVITE Alice -> example.com\n   INVITE sip:Gold@example.com SIP/2.0\n \
    \  Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 70\n \
    \  From: Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance\
    \ <sip:Gold@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:Gold@example.com>;index=1\n   Contact:\
    \ Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F2 INVITE example.com -> Gold.example.com\n\
    \   INVITE sip:Gold@gold.example.com SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance\
    \ <sip:Gold@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:Gold@example.com>;index=1\n   History-Info:\
    \ <sip:Gold@gold.example.com>;rc=1;index=1.1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F3 302 Moved Temporarily Gold.example.com -> example.com\n\
    \   SIP/2.0 302 Moved Temporarily\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4;\\\
    \n                  received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance\
    \ <sip:Gold@example.com>;tag=kkaz-\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:Gold@example.com>;index=1\n   History-Info:\
    \ <sip:Gold@gold.example.com>;rc=1;index=1.1\n   Contact: <sip:Silver@example.com>;mp=1\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F4 INVITE example.com -> Silver.example.com\n   INVITE sip:Silver@example.com\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK45q2\n   Via:\
    \ SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n   From:\
    \ Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance <sip:Gold@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:Gold@example.com>;index=1\n   History-Info: <sip:Gold@gold.example.com?Reason=SIP%3Bcause%3D302>;\\\
    \n                   rc=1;index=1.1\n   History-Info: <sip:Silver@example.com>;index=1.2;mp=1\n\
    \   History-Info: <sip:Silver@silver.example.com>;index=1.2.1;rc=1.2\n   Contact:\
    \ Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F5 INVITE Silver.example.com ->\
    \ Agent\n   INVITE sip:Silver@192.0.2.7 SIP/2.0\n   Via: SIP/2.0/TCP silver.example.com:5060;branch=z9hG4bKerxs\n\
    \   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK45q2;\\\n          \
    \        received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   Max-Forwards: 68\n   From: Alice <sip:alice@example.com>;tag=1235\n   To:\
    \ Gold Member Assistance <sip:Gold@example.com>\n   Supported: histinfo\n   Call-ID:\
    \ 12345600@example.com\n   CSeq: 1 INVITE\n   History-Info: <sip:Gold@example.com>;index=1\n\
    \   History-Info: <sip:Gold@gold.example.com?Reason=SIP%3Bcause%3D302>;\\\n  \
    \                 rc=1;index=1.1\n   History-Info: <sip:Silver@example.com>;index=1.2;mp=1\n\
    \   History-Info: <sip:Silver@silver.example.com>;index=1.2.1;rc=1.2\n   History-Info:\
    \ <sip:Silver@192.0.2.7>;index=1.2.1.1;rc=1.2.1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F6 200 OK Agent -> Silver.example.com\n   SIP/2.0 200 OK\n\
    \   Via: SIP/2.0/TCP silver.example.com:5060;branch=z9hG4bKerxs;\\\n         \
    \          received=192.0.2.5\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK45q2;\\\
    \n                   received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance\
    \ <sip:Gold@example.com>;tag=2325\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:Gold@example.com>;index=1\n   History-Info:\
    \ <sip:Gold@gold.example.com?Reason=SIP%3Bcause%3D302>;\\\n                  \
    \ rc=1;index=1.1\n   History-Info: <sip:Silver@example.com>;index=1.2;mp=1\n \
    \  History-Info: <sip:Silver@silver.example.com>;index=1.2.1;rc=1.2\n   History-Info:\
    \ <sip:Silver@192.0.2.7>;index=1.2.1.1;rc=1.2.1\n   Contact: Agent <sip:Silver@192.0.2.7>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F7 200 OK Silver.example.com -> example.com\n   SIP/2.0\
    \ 200 OK\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK45q2;\\\n \
    \                  received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance\
    \ <sip:Gold@example.com>;tag=2325\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:Gold@example.com>;index=1\n   History-Info:\
    \ <sip:Gold@gold.example.com?Reason=SIP%3Bcause%3D302>;\\\n                  \
    \ rc=1;index=1.1\n   History-Info: <sip:Silver@example.com>;index=1.2;mp=1\n \
    \  History-Info: <sip:Silver@silver.example.com>;index=1.2.1;rc=1.2\n   History-Info:\
    \ <sip:Silver@192.0.2.7>;index=1.2.1.1;rc=1.2.1\n   Contact: Agent <sip:Silver@192.0.2.7>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F8 200 OK example.com -> Alice\n   SIP/2.0 200 OK\n   Via:\
    \ SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   From: Alice <sip:alice@example.com>;tag=1235\n\
    \   To: Gold Member Assistance <sip:Gold@example.com>;tag=2325\n   Supported:\
    \ histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n   History-Info:\
    \ <sip:Gold@example.com>;index=1\n   History-Info: <sip:Gold@gold.example.com?Reason=SIP%3Bcause%3D302>;\\\
    \n                   rc=1;index=1.1\n   History-Info: <sip:Silver@example.com>;index=1.2;mp=1\n\
    \   History-Info: <sip:Silver@silver.example.com>;index=1.2.1;rc=1.2\n   History-Info:\
    \ <sip:Silver@192.0.2.7>;index=1.2.1.1;rc=1.2.1\n   Contact: Agent <sip:Silver@192.0.2.7>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F9 ACK Alice -> Agent\n   ACK sip:Silver@192.0.2.7 SIP/2.0\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t3\n   Max-Forwards: 70\n\
    \   From: Alice <sip:alice@example.com>;tag=1235\n   To: Gold Member Assistance\
    \ <sip:Gold@example.com>;tag=2325\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 ACK\n   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   The first hi-entry\
    \ with the \"mp\" header field parameter contains an\n   \"mp\" header field parameter\
    \ value of 1, which points to the original-\n   target, which allows the operator\
    \ to identify that the call was from\n   the Gold customer.\n"
- title: 3.5.  Determining the Alias Used
  contents:
  - "3.5.  Determining the Alias Used\n   SIP UAs are associated with an AOR.  It\
    \ is possible for a single UA\n   to actually have multiple AORs associated with\
    \ it.  One common usage\n   for this is aliases.  For example, a user might have\
    \ an AOR of\n   sip:john@example.com but also have the AORs\n   sip:john.smith@example.com\
    \ and sip:jsmith@example.com.  Rather than\n   registering against each of these\
    \ AORs individually, the user would\n   register against just one of them, and\
    \ the home proxy would\n   automatically accept incoming calls for any of the\
    \ aliases, treating\n   them identically and ultimately forwarding them towards\
    \ the UA.  This\n   is common practice in the IP Multimedia Subsystem (IMS), where\
    \ it is\n   called \"implicit registration\" and each alias is called a \"public\n\
    \   user identity (PUID)\".\n   It is a common requirement for a User Agent Server\
    \ (UAS), on receipt\n   of a call, to know which of its aliases was used to reach\
    \ it.  This\n   knowledge can be used to choose ringtones to play, determine call\n\
    \   treatment, and so on.  For example, a user might give out one alias\n   to\
    \ friends and family only, resulting in a special ring that alerts\n   the user\
    \ to the importance of the call.\n   The following call flow and example messages\
    \ show how History-Info\n   can be used to find out the alias used to reach the\
    \ callee.  The\n   alias for the call is determined by hi-entry with the index\
    \ that\n   matches the value of the last hi-entry with an \"rc\" header field\n\
    \   parameter in the Request received.\n          Alice             example.com\
    \             John\n          |                     | REGISTER F1         |\n\
    \          |                     |<--------------------|\n          |        \
    \             | 200 OK F2           |\n          |                     |-------------------->|\n\
    \          | INVITE F3           |                     |\n          |-------------------->|\
    \                     |\n          |                     | INVITE F4         \
    \  |\n          |                     |-------------------->|\n              \
    \         * Rest of flow not shown *\n                        Figure 5: Alias\
    \ Example\n   Message Details\n   F1 REGISTER John -> example.com\n   REGISTER\
    \ sip:example.com SIP/2.0\n   Via: SIP/2.0/TCP 192.0.2.1;branch=z9hG4bKnashds7\n\
    \   Max-Forwards: 70\n   From: John <sip:john@example.com>;tag=a73kszlfl\n   To:\
    \ John <sip:john@example.com>\n   Supported: histinfo\n   Call-ID: 1j9FpLxk3uxtm8tn@192.0.2.1\n\
    \   CSeq: 1 REGISTER\n   Contact: <sip:john@192.0.2.1>\n   Content-Length: 0\n\
    \   F2 200 OK example.com -> John\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP 192.0.2.1;branch=z9hG4bKnashds7\n\
    \   From: John <sip:john@example.com>;tag=a73kszlfl\n   To: John <sip:john@example.com>;tag=d2dstee2\n\
    \   Call-ID: 1j9FpLxk3uxtm8tn@192.0.2.1\n   CSeq: 1 REGISTER\n   Contact: <sip:john@192.0.2.1>;expires=3600\n\
    \   Content-Length: 0\n   F3 INVITE Alice -> example.com\n   INVITE sip:john.smith@example.com\
    \ SIP/2.0\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards:\
    \ 70\n   From: Alice <sip:alice@example.com>;tag=a73kszlfl\n   To: John <sip:john.smith@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:john.smith@example.com>;index=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F4 INVITE example.com -> John\n   INVITE sip:john@192.0.2.1\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4\n   Via:\
    \ SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n   From:\
    \ Alice <sip:alice@example.com>;tag=a73kszlfl\n   To: John <sip:john.smith@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   Record-Route: <sip:proxy.example.com;lr>\n   History-Info: <sip:john.smith@example.com>;index=1\n\
    \   History-Info: <sip:john@192.0.2.1>;index=1.1;rc=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   The last hi-entry with the \"rc\" header field parameter\
    \ references the\n   source of retargeting pointing at the alias AOR, which in\
    \ the example\n   is \"john.smith@example.com\".\n"
- title: 3.6.  PBX Voicemail Example
  contents:
  - "3.6.  PBX Voicemail Example\n   A typical use case for voicemail is one whereby\
    \ the original called\n   party is not reachable and the call arrives at a voicemail\
    \ system.\n   In some cases, multiple alternate destinations may be tried without\n\
    \   success.  The voicemail system typically requires the original called\n  \
    \ party information to determine the appropriate mailbox so an\n   appropriate\
    \ greeting can be provided and the appropriate party\n   notified of the message.\n\
    \   In this example, Alice calls Bob, whose SIP client is forwarded to\n   Carol.\
    \  Carol does not answer the call; thus, it is forwarded to a VM\n   (voicemail)\
    \ server (VMS).  In order to determine the appropriate\n   mailbox to use for\
    \ this call, the VMS needs the original target for\n   the request.  The original\
    \ target is determined by finding the first\n   hi-entry tagged with \"rc\" or\
    \ \"mp\" and using the hi-entry referenced\n   by the index of \"rc\" or \"mp\"\
    \ header field parameter as the target for\n   determining the appropriate mailbox.\
    \  This hi-entry is used to\n   populate the \"target\" URI parameter as defined\
    \ in [RFC4458].  The\n   reason associated with the first hi-entry tagged with\
    \ \"rc\" or \"mp\"\n   (i.e., 302) could be used to provide a customized voicemail\
    \ greeting\n   and is used to populate the \"cause\" URI parameter as defined\
    \ in\n   [RFC4458].  Note that some VMSs may also (or instead) use the\n   information\
    \ available in the History-Info headers for custom handling\n   of the VM based\
    \ on how and why the call arrived at the VMS.\n   Furthermore, it is the proxy\
    \ forwarding the call to the VMS that\n   determines the target of the voicemail;\
    \ it is the proxy that sets the\n   target of voicemail, which is also the entity\
    \ that utilizes [RFC7044]\n   to find the target that is usually based on local\
    \ policy installed by\n   the user or an administrator.\n   Alice      example.com\
    \       Bob          Carol        VM\n   | INVITE F1    |              |     \
    \        |          |\n   |------------->|              |             |      \
    \    |\n   |              | INVITE  F2   |             |          |\n   |    \
    \          |------------->|             |          |\n   |              |    \
    \          |             |          |\n   |  100 Trying  |              |    \
    \         |          |\n   |<-------------| 302 Moved Temporarily F3   |     \
    \     |\n   |              |<-------------|             |          |\n   |   \
    \           |              |             |          |\n   |              |   \
    \   ACK     |             |          |\n   |              |------------->|   \
    \          |          |\n   |              |              |             |    \
    \      |\n   |              | INVITE F4    |             |          |\n   |  \
    \            |--------------------------->|          |\n   |              |  \
    \            |             |          |\n   |              |         180 Ringing\
    \  F5    |          |\n   |              |<---------------------------|      \
    \    |\n   |              |              |             |          |\n   | 180\
    \ Ringing  |              |             |          |\n   |<-------------|    \
    \          |             |          |\n   |              |              |    \
    \         |          |\n   |              |       (timeout)            |     \
    \     |\n   |              |              |             |          |\n   |   \
    \           | INVITE  F6   |             |          |\n   |              |-------------------------------------->|\n\
    \   |              |              |             |          |\n   |           \
    \   |               200 OK  F7              |\n   |              |<--------------------------------------|\n\
    \   |   200 OK     |              |             |          |\n   |<-------------|\
    \              |             |          |\n   |              |              |\
    \             |          |\n   |                         ACK                 \
    \         |\n   |----------------------------------------------------->|\n   \
    \              Figure 6: Enterprise Voicemail Example\n   Message Details\n  \
    \ F1 INVITE Alice -> example.com\n   INVITE sip:bob@example.com SIP/2.0\n   Via:\
    \ SIP/2.0/TCP  192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 70\n   From:\
    \ Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F2 INVITE example.com\
    \ -> Bob\n   INVITE sip:bob@192.0.2.5 SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5>;index=1.1;rc=1\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F3 302 Moved Temporarily\
    \ Bob -> example.com\n   SIP/2.0 302 Moved Temporarily\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4;\\\
    \n                    received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>;tag=2g22d-lnf\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5>;index=1.1;rc=1\n\
    \   Contact: <sip:carol@example.com>;mp=1\n   Content-Type: application/sdp\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F4 INVITE example.com\
    \ -> Carol\n   INVITE sip:carol@192.0.2.4 SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK4522\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302>;\\\
    \n                      index=1.1;rc=1\n   History-Info: <sip:carol@example.com;cause=480>;index=1.2;mp=1\n\
    \   History-Info: <sip:carol@192.0.2.4;cause=480>;index=1.2.1;rc=1.2\n   Contact:\
    \ Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F5 180 Ringing Carol -> example.com\n\
    \   SIP/2.0 180 Ringing\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK4522;\\\
    \n                    received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>;tag=setss3x\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302>;\\\
    \n                      index=1.1;rc=1\n   History-Info: <sip:carol@example.com;cause=480>;index=1.2;mp=1\n\
    \   History-Info: <sip:carol@192.0.2.4;cause=480>;index=1.2.1;rc=1.2\n   Contact:\
    \ <sip:carol@192.0.2.4>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F6 INVITE example.com -> VM\n  \
    \ INVITE sip:vm@192.0.2.6;target=sip:bob%40example.com;cause=480\\\n         \
    \               SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK4523\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302>;\\\
    \n                       index=1.1;rc=1\n   History-Info: <sip:carol@example.com;cause=480?Reason=SIP%3Bcause%3D\\\
    \n                 408>;index=1.2;mp=1\n   History-Info: <sip:carol@192.0.2.4;cause=480?Reason=SIP%3Bcause%3D\\\
    \n                 408>;index=1.2.1;rc=1.2\n   History-Info: <sip:vm@example.com;\\\
    \n                       target=sip:bob%40example.com;cause=480>;\\\n        \
    \               index=1.3;mp=1\n   History-Info: <sip:vm@192.0.2.6;\\\n      \
    \                 target=sip:bob%40example.com;cause=480>;\\\n               \
    \        index=1.3.1;rc=1.3\n   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type:\
    \ application/sdp\n   Content-Length: <appropriate value>\n   [SDP Not Shown]\n\
    \   F7 200 OK VM -> example.com\n   SIP/2.0 200 OK\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK4523;\\\
    \n                    received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>;tag=3dweggs\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302>;\\\
    \n                      index=1.1;rc=1\n   History-Info: <sip:carol@example.com;cause=480?Reason=SIP%3Bcause%3D\\\
    \n                 408>;index=1.2;mp=1\n   History-Info: <sip:carol@192.0.2.4;cause=480?Reason=SIP%3Bcause%3D\\\
    \n                 408>;index=1.2.1;rc=1.2\n   History-Info: <sip:vm@example.com;\\\
    \n                      target=sip:bob%40example.com;cause=480>;\\\n         \
    \             index=1.3;mp=1\n   History-Info: <sip:vm@192.0.2.6;\\\n        \
    \              target=sip:bob%40example.com;cause=480>;\\\n                  \
    \    index=1.3.1;rc=1.3\n   Contact: <sip:vm@192.0.2.6>\n   Content-Type: application/sdp\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   The VMS can look\
    \ at the last hi-entry and find the target of the\n   mailbox by looking at the\
    \ URI entry in the \"target\" URI parameter in\n   the hi-entry.\n"
- title: 3.7.  Consumer Voicemail Example
  contents:
  - "3.7.  Consumer Voicemail Example\n   In the case of a consumer, when the call\
    \ is retargeted, it is usually\n   to another administrative domain.  The voicemail\
    \ system in these\n   environments typically requires the last-called-party information\
    \ to\n   determine the appropriate mailbox so an appropriate greeting can be\n\
    \   provided and the appropriate party notified of the message.\n   In this example,\
    \ Alice calls Bob, but Bob has temporarily forwarded\n   his phone to Carol (she\
    \ is his wife).  Carol does not answer the\n   call; thus, it is forwarded to\
    \ a VMS.  In order to determine the\n   appropriate mailbox to use for this call,\
    \ the VMS needs the\n   appropriate target for the request.  The last target is\
    \ determined by\n   finding the hi-entry referenced by the index of last hi-entry\
    \ tagged\n   with \"mp\" for determining the appropriate mailbox.  This hi-entry\
    \ is\n   used to populate the \"target\" URI parameter as defined in [RFC4458].\n\
    \   Note that some VMSs may also (or instead) use the information\n   available\
    \ in the History-Info headers for custom handling of the VM\n   in terms of how\
    \ and why the called arrived at the VMS.\n   Alice      example.com       Bob\
    \          Carol        VM\n   | INVITE F1    |              |             | \
    \         |\n   |------------->|              |             |          |\n   |\
    \              | INVITE  F2   |             |          |\n   |              |------------->|\
    \             |          |\n   |              |              |             | \
    \         |\n   |  100 Trying  |              |             |          |\n   |<-------------|\
    \ 302 Moved Temporarily F3   |          |\n   |              |<-------------|\
    \             |          |\n   |              |              |             | \
    \         |\n   |              |      ACK     |             |          |\n   |\
    \              |------------->|             |          |\n   |              |\
    \              |             |          |\n   |              | INVITE F4    |\
    \             |          |\n   |              |--------------------------->| \
    \         |\n   |              |              |             |          |\n   |\
    \              |         180 Ringing  F5    |          |\n   |              |<---------------------------|\
    \          |\n   |              |              |             |          |\n  \
    \ | 180 Ringing  |              |             |          |\n   |<-------------|\
    \              |             |          |\n   |              |              |\
    \             |          |\n   |              |       (timeout)            | \
    \         |\n   |              |              |             |          |\n   |\
    \              | INVITE  F6   |             |          |\n   |              |-------------------------------------->|\n\
    \   |              |              |             |          |\n   |           \
    \   |               200 OK  F7              |\n   |              |<--------------------------------------|\n\
    \   |   200 OK     |              |             |          |\n   |<-------------|\
    \              |             |          |\n   |              |              |\
    \             |          |\n   |                         ACK                 \
    \         |\n   |----------------------------------------------------->|\n   \
    \               Figure 7: Consumer Voicemail Example\n   Message Details\n   F1\
    \ INVITE Alice -> example.com\n   INVITE sip:bob@example.com SIP/2.0\n   Via:\
    \ SIP/2.0/TCP  192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 70\n   From:\
    \ Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F2 INVITE example.com\
    \ -> Bob\n   INVITE sip:bob@192.0.2.5 SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5>;index=1.1;rc=1\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F3 302 Moved Temporarily\
    \ Bob -> example.com\n   SIP/2.0 302 Moved Temporarily\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4;\\\
    \n           received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>;tag=224ls3s-t\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5>;index=1.1;rc=1\n\
    \   Contact: <sip:carol@example.com>;mp=1\n   Content-Type: application/sdp\n\
    \   Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F4 INVITE example.com\
    \ -> Carol\n   INVITE sip:carol@192.0.2.4 SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK24s5\n\
    \   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302\\\
    \n                 %3Btext%3D%22Moved%20Temporarily%22>\\\n                 ;index=1.1;rc=1\n\
    \   History-Info: <sip:carol@example.com>;index=1.2;mp=1\n   History-Info: <sip:carol@192.0.2.4>;index=1.2.1;rc=1.2\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n \
    \  Content-Length: <appropriate value>\n   [SDP Not Shown]\n   F5 180 Ringing\
    \ Carol -> example.com\n   SIP/2.0 180 Ringing\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK24s5;\\\
    \n           received=192.0.2.101\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>;tag=setss3x\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302\\\
    \n                 %3Btext%3D%22Moved%20Temporarily%22>;\\\n                 index=1.1;rc=1\n\
    \   History-Info: <sip:carol@example.com>;index=1.2;mp=1\n   History-Info: <sip:carol@192.0.2.4>;index=1.2.1;rc=1.2\n\
    \   Contact: <sip:carol@192.0.2.4>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F6 INVITE example.com -> VM\n  \
    \ INVITE sip:vm@192.0.2.6;target=sip:carol%40example.com SIP/2.0\n   Via: SIP/2.0/TCP\
    \ proxy.example.com:5060;branch=z9hG4bKbbg4\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   Max-Forwards: 69\n   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To:\
    \ Bob <sip:bob@example.com>\n   Supported: histinfo\n   Call-ID: 12345600@example.com\n\
    \   CSeq: 1 INVITE\n   History-Info: <sip:bob@example.com>;index=1\n   History-Info:\
    \ <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302\\\n                 %3Btext%3D%22Moved%20Temporarily%22>;\\\
    \n                 index=1.1;rc=1\n   History-Info: <sip:carol@example.com>;\\\
    \n                 index=1.2;mp=1\n   History-Info: <sip:carol@192.0.2.4?Reason=SIP%3Bcause%3D408>;\\\
    \n                 index=1.2.1;rc=1.2\n   History-Info: <sip:vm@example.com;target=sip:carol%40example.com;\\\
    \n                 cause=408>;index=1.2.2;mp=1.2\n   History-Info: <sip:vm@192.0.2.5;target=sip:carol%40example.com;\\\
    \n                 cause=408>;index=1.2.2.1;rc=1.2.2\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   F7 200 OK VM -> example.com\n   SIP/2.0 200 OK\n   Via:\
    \ SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bKbbg4\n   Via: SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n\
    \   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: Bob <sip:bob@example.com>;tag=3dweggs\n\
    \   Supported: histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   History-Info: <sip:bob@example.com>;index=1\n   History-Info: <sip:bob@192.0.2.5?Reason=SIP%3Bcause%3D302\\\
    \n                 %3Btext%3D%22Moved%20Temporarily%22>;\\\n                 index=1.1;rc=1\n\
    \   History-Info: <sip:carol@example.com>;\\\n                 index=1.2;mp=1\n\
    \   History-Info: <sip:carol@192.0.2.4?Reason=SIP%3Bcause%3D408>;\\\n        \
    \         index=1.2.1;rc=1.2\n   History-Info: <sip:vm@example.com;target=sip:carol%40example.com;\\\
    \n                 cause=408>;index=1.2.2;mp=1.2\n   History-Info: <sip:vm@192.0.2.5;target=sip:carol%40example.com;\\\
    \n                 cause=408>;index=1.2.2.1;rc=1.2.2\n   Contact: <sip:carol@192.0.2.5>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   The VMS can look at the last hi-entry and find the target\
    \ of the\n   mailbox by looking for the \"target\" URI parameter in the hi-entry\
    \ and\n   the reason by the \"cause\" URI parameter in the same hi-entry.\n"
- title: 3.8.  GRUU
  contents:
  - "3.8.  GRUU\n   A variation on the problem in Section 3.5 occurs with Globally\n\
    \   Routable User Agent URI (GRUU) [RFC5627].  A GRUU is a URI assigned\n   to\
    \ a UA instance that has many of the same properties as the AOR but\n   causes\
    \ requests to be routed only to that specific instance.  It is\n   desirable for\
    \ a UA to know whether it was reached because a\n   correspondent sent a request\
    \ to its GRUU or to its AOR.  This can be\n   used to drive differing authorization\
    \ policies on whether the request\n   should be accepted or rejected, for example.\
    \  However, like the AOR\n   itself, the GRUU is lost in translation at the home\
    \ proxy.  Thus, the\n   UAS cannot know whether it was contacted via the GRUU\
    \ or its AOR.\n   The following call flow and example messages show how History-Info\n\
    \   can be used to find out the GRUU used to reach the callee.\n   While a GRUU\
    \ is comprised of an AOR with a URI parameter, as defined\n   in [RFC5627], the\
    \ GRUU construct itself is not an AOR.  Thus, the\n   retargeting of a request\
    \ based on a GRUU does not result in the\n   addition of an \"rc\" header field\
    \ parameter to the hi-entry containing\n   the GRUU.  The lack of an \"rc\" header\
    \ field parameter in the hi-\n   entries can be a hint that the source of retargeting\
    \ is a GRUU.\n   However, to ensure this is the case, the UAS needs to search\
    \ for a\n   \"gr\" parameter in the hi-entry prior to the last hi-entry.  If there\n\
    \   is a GRUU, the URI will always be prior to the last hi-entry as the\n   GRUU\
    \ does not allow multiple instance to be mapped to a contact\n   address.\n  \
    \        Alice             example.com             John\n          |         \
    \            | REGISTER F1         |\n          |                     |<--------------------|\n\
    \          |                     | 200 OK F2           |\n          |        \
    \             |-------------------->|\n          | INVITE F3           |     \
    \                |\n          |-------------------->|                     |\n\
    \          |                     | INVITE F4           |\n          |        \
    \             |-------------------->|\n                       * Rest of flow not\
    \ shown *\n                         Figure 8: GRUU Example\n   Message Details\n\
    \   F1 REGISTER John -> example.com\n   REGISTER sip:example.com SIP/2.0\n   Via:\
    \ SIP/2.0/UDP 192.0.2.1;branch=z9hG4bKnashds7\n   Max-Forwards: 70\n   From: John\
    \ <sip:John@example.com>;tag=a73kszlfl\n   Supported: gruu\n   To: John <sip:john@example.com>\n\
    \   Call-ID: 1j9FpLxk3uxtm8tn@192.0.2.1\n   CSeq: 1 REGISTER\n   Contact: <sip:john@192.0.2.1>;+sip.instance=\\\
    \n       <urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>\n   Content-Length: 0\n\
    \   [SDP Not Shown]\n   F2 200 OK example.com -> John\n   SIP/2.0 200 OK\n   Via:\
    \ SIP/2.0/TCP 192.0.2.1;branch=z9hG4bKnashds7\n   From: John <sip:john@example.com>;tag=a73kszlfl\n\
    \   To: John <sip:john@example.com> ;tag=b88sn\n   Call-ID: 1j9FpLxk3uxtm8tn@192.0.2.1\n\
    \   CSeq: 1 REGISTER\n   Contact: <sip:john@192.0.2.1>;\\\n       pub-gruu=\"\
    sip:john@example.com;\\\n       gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6\"\
    ;\\\n       temp-gruu=\\\n       \"sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com;\\\
    \n     gr\";+sip.instance=\\\n       \"<urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>\"\
    ;\\\n       expires=3600\n     Content-Length: 0\n   [SDP Not Shown]\n   Assuming\
    \ Alice has knowledge of a GRUU either through\n   prior communication or through\
    \ other means such as presence\n   places a call to John's GRUU.\n   F3 INVITE\
    \ Alice -> example.com\n   INVITE sip:john@example.com;\\\n       gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6\
    \ SIP/2.0\n   Via: SIP/2.0/TCP  192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards:\
    \ 70\n   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: <sip:john@example.com;\\\
    \n       gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>\n   Supported: gruu,\
    \ histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n   History-Info:\
    \ <sip:john@example.com;\\\n       gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>;index=1\n\
    \   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Length: <appropriate value>\n\
    \   [SDP Not Shown]\n   F4 INVITE example.com -> John\n   INVITE sip:john@192.0.2.1\
    \ SIP/2.0\n   Via: SIP/2.0/TCP proxy.example.com:5060;branch=z9hG4bK12s4\n   Via:\
    \ SIP/2.0/TCP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n   From:\
    \ Alice <sip:alice@example.com>;tag=kkaz-\n   To: <sip:john@example.com;\\\n \
    \      gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>\n   Supported: gruu,\
    \ histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n   Record-Route:\
    \ <sip:proxy.example.com;lr>\n   History-Info: <sip:john@example.com;\\\n    \
    \   gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>;index=1\n   History-Info:\
    \ <sip:john@192.0.2.1>;index=1.1;rc=1\n   Contact: Alice <sip:alice@192.0.2.3>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n   By analyzing the entry referenced by the entry with the\
    \ last \"rc\",\n   one can realize that the URI used to reach the device was GRUU\
    \ by\n   finding the \"gr\" parameter.\n"
- title: 3.9.  Limited-Use Address
  contents:
  - "3.9.  Limited-Use Address\n   A limited-use address is a SIP URI that is minted\
    \ on-demand, and\n   passed out to a small number (usually one) of remote correspondents.\n\
    \   Incoming calls targeted to that limited-use address are accepted as\n   long\
    \ as the UA still desires communications from the remote target.\n   Should they\
    \ no longer wish to be bothered by that remote\n   correspondent, the URI is invalidated\
    \ so that future requests\n   targeted to it are rejected.\n   Limited-use addresses\
    \ are used in battling voice spam [RFC5039].  The\n   easiest way to provide them\
    \ would be for a UA to be able to take its\n   AOR and \"mint\" a limited-use\
    \ address by appending additional\n   parameters to the URI.  It could then give\
    \ out the URI to a\n   particular correspondent and remember that URI locally.\
    \  When an\n   incoming call arrives, the UAS would examine the parameter in the\
    \ URI\n   and determine whether or not the call should be accepted.\n   Alternatively,\
    \ the UA could push authorization rules into the\n   network, so that it need\
    \ not even see incoming requests that are to\n   be rejected.\n   This approach,\
    \ especially when executed on the UA, requires that\n   parameters attached to\
    \ the AOR, but not used by the home proxy in\n   processing the request, survive\
    \ the translation at the home proxy and\n   be presented to the UA.  This will\
    \ not be the case with the logic in\n   RFC 3261, since the Request-URI is replaced\
    \ by the registered\n   contact, and any such parameters are lost.\n   Using the\
    \ History-Info, John's UA can easily see if the call was\n   addressed to its\
    \ AOR, GRUU, or a temp-GRUU and treat the call\n   accordingly by looking for\
    \ a \"gr\" tag in the hi-entry prior to the\n   last hi-entry.\n          Alice\
    \             example.com             John\n          |                     |\
    \ REGISTER F1         |\n          |                     |<--------------------|\n\
    \          |                     | 200 OK F2           |\n          |        \
    \             |-------------------->|\n          | INVITE F3           |     \
    \                |\n          |-------------------->|                     |\n\
    \          |                     | INVITE F4           |\n          |        \
    \             |-------------------->|\n                       * Rest of flow not\
    \ shown *\n                 Figure 9: Limited-Use Address Example\n   Message\
    \ Details\n   F1 REGISTER John -> example.com\n   REGISTER sip:example.com SIP/2.0\n\
    \   Via: SIP/2.0/UDP 192.0.2.1;branch=z9hG4bKnashds7\n   Max-Forwards: 70\n  \
    \ From: John <sip:John@example.com>;tag=a73kszlfl\n   Supported: gruu\n   To:\
    \ John <sip:john@example.com>\n   Call-ID: 1j9FpLxk3uxtm8tn@192.0.2.1\n   CSeq:\
    \ 1 REGISTER\n   Contact: <sip:john@192.0.2.1>;\\\n     +sip.instance=\"<urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>\"\
    \n   Content-Length: 0\n   F2 200 OK example.com -> John\n   SIP/2.0 200 OK\n\
    \   Via: SIP/2.0/UDP 192.0.2.1;branch=z9hG4bKnashds7\n   From: John <sip:john@example.com>;tag=a73kszlfl\n\
    \   To: John <sip:john@example.com> ;tag=b88sn\n   Call-ID: 1j9FpLxk3uxtm8tn@192.0.2.1\n\
    \   CSeq: 1 REGISTER\n   Contact: <sip:john@192.0.2.1>;\\\n     pub-gruu=\"sip:john@example.com;\\\
    \n     gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6\";\\\n     temp-gruu=\\\
    \n     \"sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com;gr\";\\\n\
    \     +sip.instance=\"<urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6>\";\\\n \
    \    expires=3600\n   Content-Length: 0\n    Assuming Alice has knowledge of a\
    \ temp-GRUU, she places a\n    call to the temp-GRUU.\n   F3 INVITE Alice -> example.com\n\
    \   INVITE sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com;\\\n   \
    \    gr SIP/2.0\n   Via: SIP/2.0/UDP 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards:\
    \ 70\n   From: Alice <sip:alice@example.com>;tag=kkaz-\n   To: <sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com\\\
    \n    ;gr>\n   Supported: gruu, histinfo\n   Call-ID: 12345600@example.com\n \
    \  CSeq: 1 INVITE\n   History-Info: \\\n    <sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com;gr>\\\
    \n    ;index=1\n   Contact: Alice <sip:alice@192.0.2.3>\n   Content-Length: <appropriate\
    \ value>\n   F4 INVITE example.com -> John\n   INVITE sip:john@192.0.2.1 SIP/2.0\n\
    \   Via: SIP/2.0/UDP proxy.example.com:5060;branch=z9hG4bK12s4\n   Via: SIP/2.0/UDP\
    \ 192.0.2.3:5060;branch=z9hG4bK42t2\n   Max-Forwards: 69\n   From: Alice <sip:alice@example.com>;tag=kkaz-\n\
    \   To: <sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com\\\n    ;gr>\n\
    \   Supported: gruu, histinfo\n   Call-ID: 12345600@example.com\n   CSeq: 1 INVITE\n\
    \   Record-Route: <sip:proxy.example.com;lr>\n   History-Info: \\\n    <sip:tgruu.7hs==jd7vnzga5w7fajsc7-ajd6fabz0f8g5@example.com;gr>\\\
    \n    ;index=1\n   History-Info: <sip:john@192.0.2.1>;index=1.1;rc=1\n   Contact:\
    \ Alice <sip:alice@192.0.2.3>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   By analyzing the entry referenced by the entry with\
    \ the last \"rc\",\n   one can realize that the URI used to reach the device was\
    \ GRUU by\n   finding the \"gr\" parameter.\n"
- title: 3.10.  Service Invocation
  contents:
  - "3.10.  Service Invocation\n   Several SIP specifications have been developed\
    \ that make use of\n   complex URIs to address services within the network rather\
    \ than\n   subscribers.  The URIs are complex because they contain numerous\n\
    \   parameters that control the behavior of the service.  Examples of\n   this\
    \ include the specification that first introduced the concept,\n   [RFC3087],\
    \ control of network announcements and Interactive Voice\n   Response (IVR) with\
    \ SIP URI [RFC4240], and control of voicemail\n   access with SIP URI [RFC4458].\n\
    \   A common problem with all of these mechanisms is that once a proxy\n   has\
    \ decided to rewrite the Request-URI to point to the service, it\n   cannot be\
    \ sure that the Request-URI will not be destroyed by a\n   downstream proxy that\
    \ decides to forward the request in some way, and\n   does so by rewriting the\
    \ Request-URI.\n   Section 3.6 shows how History-Info can be used to invoke a\
    \ service.\n"
- title: 3.11.  Toll-Free Number
  contents:
  - "3.11.  Toll-Free Number\n   Toll-free numbers, also known in the United States\
    \ as 800 or 8xx\n   numbers, are telephone numbers that are free for users to\
    \ call.\n   In the telephone network, toll-free numbers are just aliases to\n\
    \   actual numbers that are used for routing of the call.  In order to\n   process\
    \ the call in the PSTN, a switch will perform a query (using a\n   protocol called\
    \ Transaction Capabilities Application Part (TCAP)),\n   which will return either\
    \ a phone number or the identity of a carrier\n   which can handle the call.\n\
    \   There has been recent work on allowing such PSTN translation services\n  \
    \ to be accessed by SIP proxy servers through IP querying mechanisms.\n   For\
    \ example, ENUM [RFC6117] has already been proposed as a mechanism\n   for performing\
    \ Number Portability (NP) queries [RFC4769].  Using it\n   for 8xx number translations\
    \ is a logical next step.\n   The new target from translating the 8xx number may\
    \ be in the PSTN or\n   in the SIP network.  If the new target is an entity in\
    \ the PSTN, the\n   proper treatment in the PSTN (and in particular, correct\n\
    \   reconciliation of billing records) requires that the call be marked\n   with\
    \ both the originating number (8xx number) and the new target\n   number, History-info\
    \ would come in play here to assure original 8xx\n   number is not lost.\n   Although\
    \ not required to have both the originating number (8xx\n   number) and the new\
    \ target in the SIP network, an enterprise or user\n   who utilize the 8xx service\
    \ can benefit by knowing whether the call\n   came in via an 8xx number in order\
    \ to treat the call differently (for\n   example, to play a special announcement),\
    \ but if the original\n   Request-URI is lost through translation, there is no\
    \ way to tell if\n   the call came in via 8xx number.  History-Info again would\
    \ come in\n   play here.\n   Similar problems arise with other \"special\" numbers\
    \ and services used\n   in the PSTN, such as operator services, pay/premium numbers\
    \ (9xx\n   numbers in the United States), and short service codes such as 311.\n\
    \   To find the service number, the UAS can extract the hi-entry whose\n   index\
    \ matches the value of the first hi-entry with an \"mp\" tag.\n   Technically,\
    \ the call can be forwarded to these \"special\" numbers\n   from non-special\
    \ numbers; however, that is uncommon based on the way\n   these services authorize\
    \ translations.\n   This example call flow shows a UAC that does not support History-\n\
    \   Info.\n         Alice      Toll-Free Service   Atlanta.com          John\n\
    \          |                |              |                   |\n          |\
    \    INVITE F1   |              |                   |\n          |--------------->|\
    \   INVITE F2  |                   |\n          |                |------------->|\
    \                   |\n          |                |              |  INVITE F3\
    \        |\n          |                |              |------------------>|\n\
    \                       * Rest of flow not shown *\n                   Figure\
    \ 10: Service Number Example\n   Message Details\n   F1 INVITE 192.0.2.1 -> Toll-Free\
    \ Service\n   INVITE sip:+18005551002@example.com;user=phone  SIP/2.0\n   Via:\
    \ SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK74bf\n   From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \   To: <sip:+18005551002@example.com;user=phone>\n   Call-ID: c3x842276298220188511\n\
    \   CSeq: 1 INVITE\n   Max-Forwards: 70\n   Contact: <sip:alice@192.0.2.1>\n \
    \  Content-Type: application/sdp\n   Content-Length: <appropriate value>\n   [SDP\
    \ Not Shown]\n   F2 INVITE Toll-Free Service -> Atlanta.com\n   INVITE sip:+15555551002@atlanta.com\
    \ SIP/2.0\n   Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik8\n   Via: SIP/2.0/TCP\
    \ 192.0.2.1:5060;branch=z9hG4bK74bf\n   From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \   To: <sip:+18005551002@example.com;user=phone>\n   Call-ID: c3x842276298220188511\n\
    \   CSeq: 1 INVITE\n   Max-Forwards: 69\n   Supported: histinfo\n   History-Info:\
    \ <sip:+18005551002@example.com;user=phone>;index=1\n   History-Info: <sip:+15555551002@atlanta.com>;index=1.1;mp=1\n\
    \   Contact: <sip:alice@192.0.2.1>\n   Content-Type: application/sdp\n   Content-Length:\
    \ <appropriate value>\n   [SDP Not Shown]\n   F3 INVITE Atlanta.com -> John\n\
    \   INVITE sip:john@198.51.100.2 SIP/2.0\n   Via: SIP/2.0/TCP 198.51.100.1:5060;branch=z9hG4bKpxk7g\n\
    \   Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik8\n   Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK74bf\n\
    \   From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n   To:\
    \ <sip:+18005551002@example.com;user=phone>\n   Call-ID: c3x842276298220188511\n\
    \   CSeq: 1 INVITE\n   Max-Forwards: 68\n   Supported: histinfo\n   History-Info:\
    \ <sip:+18005551002@example.com;user=phone>;index=1\n   History-Info: <sip:+15555551002@atlanta.com>;index=1.1;mp=1\n\
    \   History-Info: <sip:john@atlanta.com>;index=1.1.1;rc=1.1\n   History-Info:\
    \ <sip:john@198.51.100.2>;index=1.1.1.1;rc=1.1.1\n   Contact: <sip:alice@192.0.2.1>\n\
    \   Content-Type: application/sdp\n   Content-Length: <appropriate value>\n  \
    \ [SDP Not Shown]\n"
- title: 4.  Security Considerations
  contents:
  - "4.  Security Considerations\n   The security considerations for the History-Info\
    \ header field are\n   specified in [RFC7044].\n"
- title: 5.  Acknowledgements
  contents:
  - "5.  Acknowledgements\n   Jonathan Rosenberg, et al produced the document that\
    \ provided\n   additional use cases precipitating the requirement for the new\n\
    \   \"target\" parameter in the History-Info header field and the new SIP/\n \
    \  SIPS URI parameter.  Hadriel Kaplan provided some comments.\n   Brett Tate,\
    \ Roland Jesske, Laura Liess, Scott Godin, Dale Worley, and\n   Marianne Mohali\
    \ provided extensive review and comments on call flows,\n   message examples,\
    \ and text.\n"
- title: 6.  Informative References
  contents:
  - "6.  Informative References\n   [RFC3261]  Rosenberg, J., Schulzrinne, H., Camarillo,\
    \ G., Johnston,\n              A., Peterson, J., Sparks, R., Handley, M., and\
    \ E.\n              Schooler, \"SIP: Session Initiation Protocol\", RFC 3261,\n\
    \              June 2002.\n   [RFC5627]  Rosenberg, J., \"Obtaining and Using\
    \ Globally Routable User\n              Agent URIs (GRUUs) in the Session Initiation\
    \ Protocol\n              (SIP)\", RFC 5627, October 2009.\n   [RFC3087]  Campbell,\
    \ B. and R. Sparks, \"Control of Service Context\n              using SIP Request-URI\"\
    , RFC 3087, April 2001.\n   [RFC4240]  Burger, E., Van Dyke, J., and A. Spitzer,\
    \ \"Basic Network\n              Media Services with SIP\", RFC 4240, December\
    \ 2005.\n   [RFC5039]  Rosenberg, J. and C. Jennings, \"The Session Initiation\n\
    \              Protocol (SIP) and Spam\", RFC 5039, January 2008.\n   [RFC4458]\
    \  Jennings, C., Audet, F., and J. Elwell, \"Session\n              Initiation\
    \ Protocol (SIP) URIs for Applications such as\n              Voicemail and Interactive\
    \ Voice Response (IVR)\", RFC 4458,\n              April 2006.\n   [RFC6117] \
    \ Hoeneisen, B., Mayrhofer, A., and J. Livingood, \"IANA\n              Registration\
    \ of Enumservices: Guide, Template, and IANA\n              Considerations\",\
    \ RFC 6117, March 2011.\n   [RFC4769]  Livingood, J. and R. Shockey, \"IANA Registration\
    \ for an\n              Enumservice Containing Public Switched Telephone Network\n\
    \              (PSTN) Signaling Information\", RFC 4769, November 2006.\n   [RFC7044]\
    \  Barnes, M., Audet, F., Schubert, S., van Elburg, J., and\n              C.\
    \ Holmberg, \"An Extension to the Session Initiation\n              Protocol (SIP)\
    \ for Request History Information\", RFC 7044,\n              February 2014.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Mary Barnes\n   TX\n   US\n   EMail: mary.ietf.barnes@gmail.com\n\
    \   Francois Audet\n   Skype\n   EMail: francois.audet@skype.net\n   Shida Schubert\n\
    \   NTT\n   Tokyo\n   Japan\n   EMail: shida@ntt-at.com\n   Hans Erik van Elburg\n\
    \   Detecon International Gmbh\n   Oberkasseler str. 2\n   Bonn\n   Germany\n\
    \   EMail: ietf.hanserik@gmail.com\n   Christer Holmberg\n   Ericsson\n   Hirsalantie\
    \ 11, Jorvas\n   Finland\n   EMail: christer.holmberg@ericsson.com\n"
