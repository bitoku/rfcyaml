- title: __initial_text__
  contents:
  - "  Private Session Initiation Protocol (SIP) Proxy-to-Proxy Extensions\n for Supporting\
    \ the PacketCable Distributed Call Signaling Architecture\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2003).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   In order to deploy a residential telephone service at very large\n\
    \   scale across different domains, it is necessary for trusted elements\n   owned\
    \ by different service providers to exchange trusted information\n   that conveys\
    \ customer-specific information and expectations about the\n   parties involved\
    \ in the call.  This document describes private\n   extensions to the Session\
    \ Initiation Protocol (SIP) (RFC3261) for\n   supporting the exchange of customer\
    \ information and billing\n   information between trusted entities in the PacketCable\
    \ Distributed\n   Call Signaling Architecture.  These extensions provide mechanisms\
    \ for\n   access network coordination to prevent theft of service, customer\n\
    \   originated trace of harassing calls, support for operator services\n   and\
    \ emergency services, and support for various other regulatory\n   issues.  The\
    \ use of the extensions is only applicable within closed\n   administrative domains,\
    \ or among federations of administrative\n   domains with previously agreed-upon\
    \ policies where coordination of\n   charging and other functions is required.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Applicability Statement . . . . . . . . . . . . . .\
    \ . . . . .  3\n   2.  Introduction. . . . . . . . . . . . . . . . . . . . . .\
    \ . . .  3\n   3.  Trust Boundary. . . . . . . . . . . . . . . . . . . . . . .\
    \ .  5\n   4.  Conventions used in this document . . . . . . . . . . . . . . \
    \ 6\n   5.  P-DCS-TRACE-PARTY-ID. . . . . . . . . . . . . . . . . . . . .  6\n\
    \       5.1.  Syntax. . . . . . . . . . . . . . . . . . . . . . . . .  7\n   \
    \    5.2.  Procedures at an Untrusted User Agent Client (UAC). . .  7\n      \
    \ 5.3.  Procedures at a Trusted User Agent Client (UAC) . . . .  7\n       5.4.\
    \  Procedures at an Untrusted User Agent Server (UAS). . .  7\n       5.5.  Procedures\
    \ at a Trusted User Agent Server (UAS) . . . .  7\n       5.6.  Procedures at\
    \ Proxy . . . . . . . . . . . . . . . . . .  8\n             5.6.1.  Procedures\
    \ at Originating Proxy . . . . . . . .  8\n             5.6.2.  Procedures at\
    \ Terminating Proxy . . . . . . . .  8\n   6.  P-DCS-OSPS. . . . . . . . . . .\
    \ . . . . . . . . . . . . . . .  8\n       6.1.  Syntax. . . . . . . . . . . .\
    \ . . . . . . . . . . . . .  9\n       6.2.  Procedures at an Untrusted User Agent\
    \ Client (UAC). . .  9\n       6.3.  Procedures at a Trusted User Agent Client\
    \ (UAC) . . . . 10\n       6.4.  Procedures at an Untrusted User Agent Server\
    \ (UAS). . . 10\n       6.5.  Procedures at a Trusted User Agent Server (UAS)\
    \ . . . . 11\n       6.6.  Procedures at Proxy . . . . . . . . . . . . . . . .\
    \ . . 11\n   7.  P-DCS-BILLING-INFO. . . . . . . . . . . . . . . . . . . . . .\
    \ 11\n       7.1.  Syntax. . . . . . . . . . . . . . . . . . . . . . . . . 13\n\
    \       7.2.  Procedures at an Untrusted User Agent Client (UAC). . . 14\n   \
    \    7.3.  Procedures at a Trusted User Agent Client (UAC) . . . . 14\n      \
    \ 7.4.  Procedures at an Untrusted User Agent Server (UAS). . . 15\n       7.5.\
    \  Procedures at a Trusted User Agent Server (UAS) . . . . 15\n       7.6.  Procedures\
    \ at Proxy . . . . . . . . . . . . . . . . . . 16\n             7.6.1.  Procedures\
    \ at Originating Proxy . . . . . . . . 16\n             7.6.2.  Procedures at\
    \ Terminating Proxy . . . . . . . . 17\n             7.6.3.  Procedures at Tandem\
    \ Proxy. . . . . . . . . . . 18\n   8.  P-DCS-LAES and P-DCS-REDIRECT . . . .\
    \ . . . . . . . . . . . . 18\n       8.1.  Syntax. . . . . . . . . . . . . . .\
    \ . . . . . . . . . . 19\n       8.2.  Procedures at an Untrusted User Agent Client\
    \ (UAC). . . 20\n       8.3.  Procedures at a Trusted User Agent Client (UAC)\
    \ . . . . 20\n       8.4.  Procedures at an Untrusted User Agent Server (UAS).\
    \ . . 21\n       8.5.  Procedures at a Trusted User Agent Server (UAS) . . . .\
    \ 21\n       8.6.  Procedures at Proxy . . . . . . . . . . . . . . . . . . 21\n\
    \             8.6.1.  Procedures at Originating Proxy . . . . . . . . 22\n   \
    \          8.6.2.  Procedures at Terminating Proxy . . . . . . . . 23\n   9. \
    \ Security Considerations . . . . . . . . . . . . . . . . . . . 24\n   10. IANA\
    \ Considerations . . . . . . . . . . . . . . . . . . . . . 25\n   11. Intellectual\
    \ Property Rights Notice . . . . . . . . . . . . . 25\n   12. References  . .\
    \ . . . . . . . . . . . . . . . . . . . . . . . 25\n       12.1. Normative References.\
    \ . . . . . . . . . . . . . . . . . 25\n       12.2. Informative References. .\
    \ . . . . . . . . . . . . . . . 26\n   13. Acknowledgements. . . . . . . . . .\
    \ . . . . . . . . . . . . . 26\n   14. Editors' Addresses. . . . . . . . . . .\
    \ . . . . . . . . . . . 27\n   15. Full Copyright Statement. . . . . . . . . .\
    \ . . . . . . . . . 28\n"
- title: 1.  Applicability Statement
  contents:
  - "1.  Applicability Statement\n   The SIP extensions described in this document\
    \ make certain\n   assumptions regarding network topology, linkage between SIP\
    \ and lower\n   layers, and the availability of transitive trust.  These assumptions\n\
    \   are generally not applicable in the Internet as a whole.  The use of\n   these\
    \ headers is only applicable within closed administrative\n   domains, or among\
    \ federations of administrative domains with\n   previously agreed-upon policies\
    \ where coordination of charging and\n   other functions is required, as in for\
    \ example the architecture\n   presented in [6].  Use outside such a domain could\
    \ result in the\n   leakage of potentially sensitive or private information. \
    \ User\n   consent to the privacy implications of the policies in [6] is\n   strongly\
    \ encouraged in those domains as well.\n   Although RFC 2119 language is used\
    \ in this document, the scope of the\n   normative language is only for the area\
    \ of applicability of the\n   document and, like the technology, it does not apply\
    \ to the general\n   Internet.\n"
- title: 2.  Introduction
  contents:
  - "2.  Introduction\n   In order to deploy a SIP-based [2] residential telephone\
    \ service at\n   very large scale across different domains, it is necessary for\n\
    \   trusted elements owned by different service providers to exchange\n   trusted\
    \ information that conveys billing information and expectations\n   about the\
    \ parties involved in the call.\n   There are many billing models used in deriving\
    \ revenue from telephony\n   services today.  Charging for telephony services\
    \ is tightly coupled\n   to the use of network resources.  It is outside the scope\
    \ of this\n   document to discuss the details of these numerous and varying\n\
    \   methods.\n   A key motivating principle of the DCS architecture described\
    \ in [6]\n   is the need for network service providers to be able to control and\n\
    \   monitor network resources; revenue may be derived from the usage of\n   these\
    \ resources as well as from the delivery of enhanced services\n   such as telephony.\
    \  Furthermore, the DCS architecture recognizes the\n   need for coordination\
    \ between call signaling and resource management.\n   This coordination ensures\
    \ that users are authenticated and authorized\n   before receiving access to network\
    \ resources and billable enhanced\n   services.\n   DCS Proxies, as defined in\
    \ [6], have access to subscriber information\n   and act as policy decision points\
    \ and trusted intermediaries along\n   the call signaling path.  Edge routers\
    \ provide the network\n   connectivity and resource policy enforcement mechanism\
    \ and also\n   capture and report network connectivity and resource usage\n  \
    \ information.  Edge routers need to be given billing information that\n   can\
    \ be logged with Record Keeping or Billing servers.  The DCS Proxy,\n   as a central\
    \ point of coordination between call signaling and\n   resource management, can\
    \ provide this information based on the\n   authenticated identity of the calling\
    \ and called parties.  Since\n   there is a trust relationship among DCS Proxies,\
    \ they can be relied\n   upon to exchange trusted billing information pertaining\
    \ to the\n   parties involved in a call.  See [6] for a description of the trust\n\
    \   boundary and trusted versus untrusted entities.\n   For these reasons, it\
    \ is appropriate to consider defining SIP header\n   extensions to allow DCS Proxies\
    \ to exchange information during call\n   setup.  It is the intent that the extensions\
    \ would only appear on\n   trusted network segments, should be inserted upon entering\
    \ a trusted\n   network region, and removed before leaving trusted network segments.\n\
    \   Significant amounts of information is retrieved by an originating DCS\n  \
    \ Proxy in its handling of a connection setup request from a user\n   agent. \
    \ Such information includes location information about the\n   subscriber (essential\
    \ for emergency services calls), billing\n   information, and station information\
    \ (e.g., coin operated phone).  In\n   addition, while translating the destination\
    \ number, information such\n   as the local-number-portability office code is\
    \ obtained and will be\n   needed by all other proxies handling this call.\n \
    \  For Usage Accounting records, it is necessary to have an identifier\n   that\
    \ can be associated with all the event records produced for the\n   call.  The\
    \ SIP Call-ID header field cannot be used as such an\n   identifier since it is\
    \ selected by the originating user agent, and\n   may not be unique among all\
    \ past calls as well as current calls.\n   Further, since this identifier is to\
    \ be used by the service provider,\n   it should be chosen in a manner and in\
    \ a format that meets the\n   service provider's needs.\n   Billing information\
    \ may not necessarily be unique for each user\n   (consider the case of calls\
    \ from an office all billed to the same\n   account).  Billing information may\
    \ not necessarily be identical for\n   all calls made by a single user (consider\
    \ prepaid calls, credit card\n   calls, collect calls, etc).  It is therefore\
    \ necessary to carry\n   billing information separate from the calling and called\
    \ party\n   identification.  Furthermore, some billing models call for split-\n\
    \   charging where multiple entities are billed for portions of the call.\n  \
    \ The addition of a SIP General Header Field allows for the capture of\n   billing\
    \ information and billing identification for the duration of\n   the call.\n \
    \  It is the intent that the billing extensions would only appear on\n   trusted\
    \ network segments, and MAY be inserted by a DCS Proxy in\n   INVITE and REFER\
    \ requests and INVITE responses in a trusted network\n   segment, and removed\
    \ before leaving trusted network segments.\n   In addition to support for billing,\
    \ current residential telephone\n   service includes the need for customer originated\
    \ trace (of harassing\n   or obscene calls), for operator services such as busy\
    \ line\n   verification and emergency interrupt (initiated by an operator from\n\
    \   an Operator Services Position System (OSPS)), for emergency services\n   such\
    \ as 9-1-1 calls to a Public Service Access Point (PSAP) and the\n   subsequent\
    \ call handling, and support for Electronic Surveillance and\n   Law Enforcement\
    \ access as required by applicable legislation and\n   court orders.  In all of\
    \ these cases, additional information about\n   the call and about the subscribers\
    \ involved in the call needs to be\n   exchanged between the proxies.\n"
- title: 3.  Trust Boundary
  contents:
  - "3.  Trust Boundary\n   The DCS architecture [6] defines a trust boundary around\
    \ the various\n   systems and servers that are owned, operated by, and/or controlled\
    \ by\n   the service provider.  These trusted systems include the proxies and\n\
    \   various servers such as bridge servers, voicemail servers,\n   announcement\
    \ servers, etc.  Outside of the trust boundary lie the\n   customer premises equipment,\
    \ and various application and media\n   servers operated by third-party service\
    \ providers.\n   Certain subscriber-specific information, such as billing and\n\
    \   accounting information, stays within the trust boundary.  Other\n   subscriber-specific\
    \ information, such as endpoint identity, may be\n   presented to untrusted endpoints\
    \ or may be withheld based on\n   subscriber profiles.\n   The User Agent (UA)\
    \ may be either within the trust boundary or\n   outside the trust boundary, depending\
    \ on exactly what function is\n   being performed and exactly how it is being\
    \ performed. Accordingly,\n   the procedures followed by a User Agent are different\
    \ depending on\n   whether the UA is within the trust boundary or outside the\
    \ trust\n   boundary.\n   The following sections giving procedures for User Agents\
    \ therefore\n   are subdivided into trusted user agents and untrusted user agents.\n"
- title: 4.  Conventions used in this document
  contents:
  - "4.  Conventions used in this document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    ,  \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in BCP 14, RFC 2119 [1].\n   The term \"private-URL\" used in this document\
    \ refers to a SIP URI that\n   is generated by a proxy, contains a \"hostport\"\
    \ that identifies the\n   proxy, and contains a \"userinfo\" string that is generated\
    \ by the\n   proxy.  The \"userinfo\" typically contains (or points to) information\n\
    \   that is not to be disclosed outside the trusted domain of the\n   proxies,\
    \ such as billing account numbers, electronic surveillance\n   indication, electronic\
    \ surveillance parameters, and call redirection\n   information.  Consequently,\
    \ the information is either stored locally\n   by the proxy, or encrypted with\
    \ a private key known only to the proxy\n   and encoded in a character string\
    \ in the \"userinfo\" portion of the\n   URL.  A checksum is included in the \"\
    userinfo\" data to detect\n   tampering.  The mechanism by which a proxy recognizes\
    \ a \"userinfo\" as\n   a private-URL and decodes and recovers the original information\
    \ is\n   local to the proxy and is not subject to standardization.  Some\n   possible\
    \ implementations include an initial magic cookie (e.g.,\n   z9hG4Bk followed\
    \ by the pointer/information), or use of a reserved\n   \"user\" name (e.g., \"\
    private\") with the optional \"password\" containing\n   the pointer/information.\n"
- title: 5.  P-DCS-TRACE-PARTY-ID
  contents:
  - "5.  P-DCS-TRACE-PARTY-ID\n   In the telephone network, calling identity information\
    \ is used to\n   support regulatory requirements such as the Customer Originated\
    \ Trace\n   service, which provide the called party with the ability to report\n\
    \   obscene or harassing phone calls to law enforcement.  This service is\n  \
    \ provided independently of caller-id, and works even if the caller\n   requested\
    \ anonymity.  The calling party is here identified as the\n   station originating\
    \ the call.  In order for this service to be\n   dependable, the called party\
    \ must be able to trust that the calling\n   identity information being presented\
    \ is valid.  One way to achieve\n   this is described in [10].\n   To initiate\
    \ a customer-originated-trace from an untrusted UAC, an\n   additional header\
    \ is defined for the INVITE request.  This header is\n   called P-DCS-Trace-Party-ID,\
    \ and does not appear in any other request\n   or response.  The entity addressed\
    \ by the Request-URI performs the\n   service-provider-specific functions of recording\
    \ and reporting the\n   caller identity in the P-DCS-Trace-Party-ID for law enforcement\n\
    \   action.  It then forwards the call to either an announcement server\n   or\
    \ to the service-provider's business office to collect further\n   information\
    \ about the complaint.  A trusted UAC does not use this\n   header, as it initiates\
    \ this action locally.\n"
- title: 5.1.  Syntax
  contents:
  - "5.1.  Syntax\n   The ABNF description of this header is (some terms used in this\
    \ ABNF\n   are defined in [2]):\n      P-DCS-Trace-Party-ID = \"P-DCS-Trace-Party-ID\"\
    \ HCOLON\n                                     name-addr\n   This document adds\
    \ the following entry to Table 2 of [2]:\n      Header field         where proxy\
    \  ACK  BYE  CAN  INV  OPT  REG\n      ------------         ----- -----  --- \
    \ ---  ---  ---  ---  ---\n      P-DCS-Trace-Party-ID   R     dr    -    -   \
    \ -    o    -    -\n                                        SUB  NOT  REF  INF\
    \  UPD  PRA\n                                        ---  ---  ---  ---  --- \
    \ ---\n                                         -    -    -    -    -    -\n \
    \  The addr-spec contained in name-addr contains a URL that identifies\n   the\
    \ remote endpoint.  Addr-spec typically contains a tel: URL or SIP\n   URI giving\
    \ the identity of the remote endpoint, as provided in the\n   signaling messages\
    \ that established the session to be traced.\n"
- title: 5.2.  Procedures at an Untrusted User Agent Client (UAC)
  contents:
  - "5.2.  Procedures at an Untrusted User Agent Client (UAC)\n   The UAC MUST insert\
    \ a P-DCS-Trace-Party-ID header into the initial\n   INVITE message for a customer-originated-trace\
    \ request.  The UAC MUST\n   use a SIP URI in the Request-URI with userinfo set\
    \ to \"call-trace\"\n   and hostport identifying the call tracing entity for the\
    \ untrusted\n   UA.\n"
- title: 5.3.  Procedures at a Trusted User Agent Client (UAC)
  contents:
  - "5.3.  Procedures at a Trusted User Agent Client (UAC)\n   A trusted UAC performs\
    \ the customer-originated-trace in a manner\n   similar to the trusted UAS, described\
    \ below.  A trusted UAC MUST NOT\n   include this header in any request.\n"
- title: 5.4.  Procedures at an Untrusted User Agent Server (UAS)
  contents:
  - "5.4.  Procedures at an Untrusted User Agent Server (UAS)\n   This header MUST\
    \ NOT appear in any response sent by a UAS.\n"
- title: 5.5.  Procedures at a Trusted User Agent Server (UAS)
  contents:
  - "5.5.  Procedures at a Trusted User Agent Server (UAS)\n   If the P-DCS-Trace-Party-ID\
    \ header is present in the initial INVITE\n   request from a UAC, and the Request-URI\
    \ of the INVITE has userinfo\n   set to \"call-trace\" and hostport set to the\
    \ UAS, the UAS MUST perform\n   the service-provider-specific functions of recording\
    \ and reporting\n   the caller identity for law enforcement action.  The UAS then\
    \ MUST\n   redirect the call, via a 3xx response, to either an announcement\n\
    \   server or to the service-provider's business office to collect\n   further\
    \ information about the complaint.\n   This header MUST NOT appear in any response\
    \ sent by a UAS.\n"
- title: 5.6.  Procedures at Proxy
  contents:
  - "5.6.  Procedures at Proxy\n   Two sets of proxy procedures are defined: (1) the\
    \ procedures at an\n   originating proxy, and (2) the procedures at a terminating\
    \ proxy. The\n   originating proxy is a proxy that received the INVITE request\
    \ from a\n   non-trusted endpoint.\n   The terminating proxy is a proxy that sends\
    \ the INVITE request to a\n   non-trusted endpoint.\n   A proxy that both receives\
    \ the INVITE request from an untrusted\n   endpoint, and sends the INVITE request\
    \ to an untrusted endpoint,\n   performs both sets of procedures.\n"
- title: 5.6.1.  Procedures at Originating Proxy
  contents:
  - "5.6.1.  Procedures at Originating Proxy\n   If the P-DCS-Trace-Party-ID header\
    \ is present in the initial INVITE\n   request from the UAC, and the Request-URI\
    \ of the INVITE has userinfo\n   other than \"call-trace\" and hostport set to\
    \ other than a potentially\n   provisioned call tracing entity, then the Proxy\
    \ MAY reject the\n   request, or MAY remove the P-DCS-Trace-Party-ID header from\
    \ the\n   request.  If the header is present in a valid request, and contains\
    \ a\n   private-URL that identifies the Proxy in the hostport, then the\n   Originating\
    \ Proxy SHOULD replace the private-URL with its original\n   contents (i.e., the\
    \ verified identity of the caller of the session\n   that is being traced).\n"
- title: 5.6.2.  Procedures at Terminating Proxy
  contents:
  - "5.6.2.  Procedures at Terminating Proxy\n   This header MUST NOT appear in any\
    \ request or response sent by a\n   terminating proxy to an untrusted endpoint.\n"
- title: 6.  P-DCS-OSPS
  contents:
  - "6.  P-DCS-OSPS\n   Some calls have special call processing requirements that\
    \ may not be\n   satisfied by normal user agent call processing.  For example,\
    \ when a\n   user is engaged in a call and another call arrives, such a call might\n\
    \   be rejected with a busy indication.  However, some PSTN operator\n   services\
    \ require special call processing.  In particular, the Busy\n   Line Verification\
    \ (BLV) and Emergency Interrupt (EI) services\n   initiated by an operator from\
    \ an Operator Services Position System\n   (OSPS) on the PSTN network have such\
    \ a need.  Similarly, emergency\n   calls to a 9-1-1 Public Service Access Point\
    \ (PSAP) may result in\n   trunk signaling causing operator ringback using a howling\
    \ tone or\n   sustained ring on the originating line (country-specific variations\n\
    \   may exist).\n   In order to inform the SIP user agent that special treatment\
    \ should\n   be given to a call, we use a new P-DCS-OSPS header field, which may\n\
    \   be set to a value indicating when a special type of call processing\n   is\
    \ requested.  We define three values in this header, namely \"BLV\"\n   for busy\
    \ line verification, \"EI\" for emergency interrupt, and \"RING\"\n   for operator\
    \ ringback (e.g., howling/sustained tone ring in the US).\n   If the user agent\
    \ decides to honor such a request, the response of\n   the user agent to an INVITE\
    \ with either \"BLV\" or \"EI\" will not be a\n   busy indication.  Since \"EI\"\
    \ and \"RING\" only occur on established\n   dialogs, they may also appear in\
    \ UPDATE requests.\n"
- title: 6.1.  Syntax
  contents:
  - "6.1.  Syntax\n   The ABNF description of the P-DCS-OSPS header is as follows\
    \ (some\n   terms used in this ABNF are defined in [2]):\n      P-DCS-OSPS   \
    \   = \"P-DCS-OSPS\" HCOLON OSPS-Tag\n      OSPS-Tag        = \"BLV\" / \"EI\"\
    \ / \"RING\" / token\n   This document adds the following entry to Table 2 of\
    \ [2]:\n      Header field         where proxy  ACK  BYE  CAN  INV  OPT  REG\n\
    \      ------------         ----- -----  ---  ---  ---  ---  ---  ---\n      P-DCS-OSPS\
    \             R     dr    -    -    -    o    -    -\n                       \
    \                 SUB  NOT  REF  INF  UPD  PRA\n                             \
    \           ---  ---  ---  ---  ---  ---\n                                   \
    \      -    -    -    -    o    -\n   The OSPS-Tag value of \"token\" is defined\
    \ for extensibility, and is\n   reserved for future use.\n"
- title: 6.2.  Procedures at an Untrusted User Agent Client (UAC)
  contents:
  - "6.2.  Procedures at an Untrusted User Agent Client (UAC)\n   The P-DCS-OSPS header\
    \ MUST NOT be sent in a request from an untrusted\n   UAC.\n"
- title: 6.3.  Procedures at a Trusted User Agent Client (UAC)
  contents:
  - "6.3.  Procedures at a Trusted User Agent Client (UAC)\n   This header is typically\
    \ only inserted by a Media Gateway Controller\n   [6] that is controlling a Media\
    \ Gateway with special trunks to a PSTN\n   OSPS system or PSAP.  This trunk group\
    \ is usually referred to as a\n   BLV-trunk group and employs special signaling\
    \ procedures that prevent\n   inadvertent use.  Calls originating at the PSTN\
    \ OSPS system are sent\n   over this trunk group, and result in an INVITE request\
    \ with the P-\n   DCS-OSPS header.\n   This header MAY be sent in an INVITE request,\
    \ and MUST NOT appear in\n   any message other than those listed below.\n   OSPS-Tag\
    \ value \"BLV\" MUST NOT appear in any request or response other\n   than an initial\
    \ INVITE request establishing a new dialog.\n   OSPS-Tag value \"EI\" MUST NOT\
    \ appear in any request or response other\n   than (1) a subsequent INVITE within\
    \ a pre-existing dialog established\n   with the OSPS-Tag value of \"BLV\", or\
    \ (2) an UPDATE request within a\n   pre-existing dialog established with the\
    \ OSPS-Tag value of \"BLV\".\n   OSPS-Tag value \"RING\" MUST NOT appear in any\
    \ request or response\n   other than (1) a subsequent INVITE within a pre-existing\
    \ dialog\n   established by a UAC to an operator or PSAP, or (2) an UPDATE request\n\
    \   within a pre-existing dialog established by a UAC to an operator or\n   PSAP.\n"
- title: 6.4.  Procedures at an Untrusted User Agent Server (UAS)
  contents:
  - "6.4.  Procedures at an Untrusted User Agent Server (UAS)\n   If the UAS receives\
    \ an INVITE request with an OSPS-Tag of \"BLV\",\n   dialog identification that\
    \ matches an existing dialog, and the\n   existing call was not established with\
    \ the OSPS-Tag, it MUST reject\n   the request with a 403-Forbidden error code.\n\
    \   If the UAS receives an INVITE/UPDATE request with an OSPS-Tag value\n   of\
    \ \"EI\" or \"RING\", with dialog identification that does not match an\n   existing\
    \ dialog, it MUST reject the request with a 403-Forbidden\n   response code.\n\
    \   If the UAS receives an INVITE that contains an OSPS-Tag value of\n   \"BLV\"\
    \ and is not willing to cooperate in offering this service, it\n   MUST reject\
    \ the request with a 403-Forbidden response code.\n   The UAS SHOULD NOT reject\
    \ an INVITE with a BLV OSPS-Tag due to a busy\n   condition.  The UAS MUST NOT\
    \ respond with a 3xx-Redirect response\n   code to an INVITE with a BLV OSPS-Tag.\
    \  The UAS SHOULD NOT alert the\n   user of the incoming call attempt if the BLV\
    \ OSPS-Tag is present in\n   the INVITE.\n   If an INVITE with OSPS-Tag of \"\
    BLV\" is accepted (e.g., meeting all\n   QoS pre-conditions, etc.), the UAS MUST\
    \ send an audio stream on this\n   connection to the address and port given in\
    \ the SDP of the INVITE.\n   The UAS MAY perform a mixing operation between the\
    \ two ends of an\n   existing active call and send the resulting media stream\
    \ to the\n   address and port indicated.  Alternatively, the UAS MAY send a copy\n\
    \   of the local voice stream, and (if no activity on the local voice\n   stream)\
    \ send a copy of the received voice stream of an existing call.\n   If the state\
    \ of the UAS is idle, the UAS SHOULD send a stream of\n   silence packets to OSPS.\
    \  If the state of the UAS is ringing or\n   ringback, the UAS SHOULD send a ringback\
    \ stream to OSPS.\n   If an INVITE/UPDATE with OSPS-Tag of \"EI\" is accepted,\
    \ the UAS MUST\n   enable communication between the UAC and the local user.  The\
    \ UAS MAY\n   put any existing call on hold, or initiate an ad-hoc conference.\n\
    \   If an INVITE/UPDATE with OSPS-Tag of \"RING\" is accepted, the UAS MUST\n\
    \   perform operator ringback in accordance with local procedures, e.g.,\n   generate\
    \ a 3-second howling tone or a sustained ring, depending on\n   the state of the\
    \ user equipment.\n"
- title: 6.5.  Procedures at a Trusted User Agent Server (UAS)
  contents:
  - "6.5.  Procedures at a Trusted User Agent Server (UAS)\n   The procedures at a\
    \ trusted UAS MUST be identical to those described\n   in 6.4.\n"
- title: 6.6.  Procedures at Proxy
  contents:
  - "6.6.  Procedures at Proxy\n   In the DCS architecture, the OSPS is considered\
    \ a trusted UAC.  If a\n   proxy receives a P-DCS-OSPS header in a request from\
    \ an untrusted\n   source, it MUST either remove the header or reject the request\
    \ with a\n   403-Forbidden response.\n   A proxy that implements a call-forwarding\
    \ service MUST NOT respond to\n   an INVITE request with a 3xx response, if the\
    \ request contained the\n   P-DCS-OSPS header.\n"
- title: 7.  P-DCS-BILLING-INFO
  contents:
  - "7.  P-DCS-BILLING-INFO\n   There are many billing models used in deriving revenue\
    \ from telephony\n   services today.  Charging for telephony services is tightly\
    \ coupled\n   to the use of network resources.  It is outside the scope of this\n\
    \   document to discuss the details of these numerous and varying\n   methods.\n\
    \   Proxies have access to subscriber information and act as policy\n   decision\
    \ points and trusted intermediaries along the call signaling\n   path.  Edge routers\
    \ provide the network connection and resource\n   policy enforcement mechanism\
    \ and also capture and report network\n   connection and resource usage information.\
    \  Edge routers need to be\n   given billing information that can be logged with\
    \ Record Keeping or\n   Billing servers.  The proxy, as a central point of coordination\n\
    \   between call signaling and resource management, can provide this\n   information\
    \ based on the authenticated identity of the calling and\n   called parties. \
    \ Since there is a trust relationship among proxies,\n   they can be relied upon\
    \ to exchange trusted billing information\n   pertaining to the parties involved\
    \ in a call.\n   For Usage Accounting records, it is necessary to have an identifier\n\
    \   that can be associated with all the event records produced for the\n   call.\
    \  The SIP Call-ID header field cannot be used as such an\n   identifier since\
    \ it is selected by the originating user agent, and\n   may not be unique among\
    \ all past calls as well as current calls.\n   Further, since this identifier\
    \ is to be used by the service provider,\n   it should be chosen in a manner and\
    \ in a format that meets the\n   service provider's needs.\n   Billing information\
    \ may not necessarily be unique for each user\n   (consider the case of calls\
    \ from an office all billed to the same\n   account).  Billing information may\
    \ not necessarily be identical for\n   all calls made by a single user (consider\
    \ prepaid calls, credit card\n   calls, collect calls, etc).  It is therefore\
    \ necessary to carry\n   billing information separate from the calling and called\
    \ party\n   identification.  Furthermore, some billing models call for split-\n\
    \   charging where multiple entities are billed for portions of the call.\n  \
    \ The addition of a SIP General Header Field allows for the capture of\n   billing\
    \ information and billing identification for the duration of\n   the call.\n \
    \  It is the intent that the billing extensions would only appear on\n   trusted\
    \ network segments, and MAY be inserted by a proxy or trusted\n   UA in INVITE\
    \ requests in a trusted network segment, and removed\n   before leaving trusted\
    \ network segments.  The P-DCS-Billing-Info\n   header extension is used only\
    \ on requests and responses between\n   proxies and trusted User Agents.  It is\
    \ never sent to, nor sent by,\n   an untrusted UA.\n"
- title: 7.1.  Syntax
  contents:
  - "7.1.  Syntax\n   The DCS-Billing-Info header is defined by the following ABNF\
    \ (some\n   terms used in this ABNF are defined in [2]):\n   P-DCS-Billing-Info\
    \      = \"P-DCS-Billing-Info\" HCOLON\n                              Billing-Correlation-ID\
    \ \"/\" FEID\n                              *(SEMI Billing-Info-param)\n   Billing-Correlation-ID\
    \  = 1*48(HEXDIG)\n   FEID                    = 1*16(HEXDIG) \"@\" host\n   Billing-Info-param\
    \      = RKS-Group-ID-param / Charge-param /\n                             Calling-param\
    \ / Called-param /\n                             Routing-param / Loc-Routing-param\
    \ /\n                             generic-param\n   RKS-Group-ID-param      =\
    \ \"rksgroup\" EQUAL RKS-Group-ID\n   RKS-Group-ID            = token\n   Charge-param\
    \            = \"charge\" EQUAL Acct-Charge-URI\n   Acct-Charge-URI         =\
    \ LDQUOT addr-spec RDQUOT\n   Calling-param           = \"calling\" EQUAL Acct-Calling-URI\n\
    \   Acct-Calling-URI        = LDQUOT addr-spec RDQUOT\n   Called-param       \
    \     = \"called\" EQUAL Acct-Called-URI\n   Acct-Called-URI         = LDQUOT\
    \ addr-spec RDQUOT\n   Routing-param           = \"routing\" EQUAL Acct-Routing-URI\n\
    \   Acct-Routing-URI        = LDQUOT addr-spec RDQUOT\n   Loc-Routing-param  \
    \     = \"locroute\" EQUAL Acct-Loc-Routing-URI\n   Acct-Loc-Routing-URI    =\
    \ LDQUOT addr-spec RDQUOT\n   This document adds the following entry to Table\
    \ 2 of [2]:\n   Header field         where proxy  ACK  BYE  CAN  INV  OPT  REG\n\
    \   ------------         ----- -----  ---  ---  ---  ---  ---  ---\n   P-DCS-Billing-Info\
    \         admr    -    -    -    o    -    -\n                               \
    \      SUB  NOT  REF  INF  UPD  PRA\n                                     ---\
    \  ---  ---  ---  ---  ---\n                                      -    -    -\
    \    -    -    -\n   The P-DCS-Billing-Info extension contains an identifier that\
    \ can be\n   used by an event recorder to associate multiple usage records,\n\
    \   possibly from different sources, with a billable account.  It further\n  \
    \ contains the subscriber account information, and other information\n   necessary\
    \ for accurate billing of the service.  This header is only\n   used between proxies\
    \ and trusted User Agents.\n   The Billing-Correlation-ID is specified in [9]\
    \ as a 24-byte binary\n   structure, containing 4 bytes of NTP timestamp, 8 bytes\
    \ of the unique\n   identifier of the network element that generated the ID, 8\
    \ bytes\n   giving the time zone, and 4 bytes of monotonically increasing\n  \
    \ sequence number at that network element.  This identifier is chosen\n   to be\
    \ globally unique within the system for a window of several\n   months.  This\
    \ MUST be encoded in the P-DCS-Billing-Info header as a\n   hexadecimal string\
    \ of up to 48 characters.  Leading zeroes MAY be\n   suppressed.\n   The Financial-Entity-ID\
    \ (FEID) is specified in [9] as an 8-byte\n   structure, containing the financial\
    \ identifier for that domain,\n   followed by a domain name.  FEID can be associated\
    \ with a type of\n   service and could be assigned to multiple domains by the\
    \ same\n   provider.  A domain could contain multiple assigned FEIDs.  This 8-\n\
    \   byte structure MUST be encoded in the P-DCS-Billing-Info header as a\n   hexadecimal\
    \ string of up to 16 characters.  Trailing zeroes MAY be\n   suppressed.  \"Host\"\
    \ contains the domain name.\n   The RKS-Group-ID specifies a record keeping server\
    \ (or group of\n   cooperating servers) for event messages relating to this call.\
    \  It is\n   used to control certain optimizations of procedures when multiple\n\
    \   event message streams are being sent to the same Record Keeping\n   Server.\n\
    \   Additional parameters contain the information needed for generation\n   of\
    \ event message records.  Acct-Charge-URI, Acct-Calling-URI, Acct-\n   Called-URI,\
    \ Acct-Routing-URI, and Acct-Location-Routing-URI are each\n   defined as URLs;\
    \ they should all contain tel: URLs with E.164\n   formatted addresses.  These\
    \ fields are further defined in [9] under\n   the element identifiers \"Charge_Number\"\
    \ (element ID 16),\n   \"Calling_Party_Number\" (element ID 4), \"Called_Party_Number\"\
    \ (element\n   ID 5), \"Routing Number\" (element ID 25), and\n   \"Location_Routing_Number\"\
    \ (element ID 22).\n"
- title: 7.2.  Procedures at an Untrusted User Agent Client (UAC)
  contents:
  - "7.2.  Procedures at an Untrusted User Agent Client (UAC)\n   This header is never\
    \ sent to an untrusted UAC, and is never sent by\n   an untrusted UAC.\n"
- title: 7.3.  Procedures at a Trusted User Agent Client (UAC)
  contents:
  - "7.3.  Procedures at a Trusted User Agent Client (UAC)\n   The UAC MUST generate\
    \ the Billing-Correlation-ID for the call, and\n   insert it into the P-DCS-Billing-Info\
    \ header in the initial INVITE\n   message sent to the terminating proxy, along\
    \ with the charging\n   information for the call.  The UAC MUST include its FEID,\
    \ and the\n   RKS-Group-ID for the Record-Keeping-Server being used by the UAC.\
    \ If\n   the UAC performed a Local Number Portability (LNP) query, it MUST\n \
    \  include the Routing Number and Location Routing Number returned by\n   the\
    \ query.\n   If the response to the initial INVITE is a 3xx-Redirect, the UAC\n\
    \   generates a new initial INVITE request to the destination specified\n   in\
    \ the Contact: header, as per standard SIP.  If a UAC receives a\n   3xx-Redirect\
    \ response to an initial INVITE, the new INVITE generated\n   by the UAC MUST\
    \ contain the P-DCS-Billing-Info header from the 3xx-\n   Redirect response. \
    \ If the UAC is acting as a B2BUA, instead of\n   generating a new INVITE it MAY\
    \ generate a private-URL and place it in\n   the Contact header of a 3xx-Redirect\
    \ response sent to the originating\n   endpoint.  This private-URL MUST contain\
    \ (or contain a pointer to)\n   the P-DCS-Billing-Info value, which indicates\
    \ the charging\n   arrangement for the new call, and an expiration time very shortly\
    \ in\n   the future, to limit the ability of the originator to re-use this\n \
    \  private-URL for multiple calls.\n   A UAC that includes a Refer-to header in\
    \ a REFER request MUST include\n   a P-DCS-Billing-Info header in the Refer-to's\
    \ URL.  This P-DCS-\n   Billing-Info header MUST include the accounting information\
    \ of the\n   initiator of the REFER.\n"
- title: 7.4.  Procedures at an Untrusted User Agent Server (UAS)
  contents:
  - "7.4.  Procedures at an Untrusted User Agent Server (UAS)\n   This header is never\
    \ sent to an untrusted UAS, and is never sent by\n   an untrusted UAS.\n"
- title: 7.5.  Procedures at a Trusted User Agent Server (UAS)
  contents:
  - "7.5.  Procedures at a Trusted User Agent Server (UAS)\n   The UAS MUST include\
    \ a P-DCS-Billing-Info header in the first\n   reliable 1xx (except 100) or 2xx\
    \ response to an initial INVITE\n   message.  This P-DCS-Billing-Info header MUST\
    \ include the Billing-\n   Correlation-ID generated by the UAS, the FEID of the\
    \ UAS, and the\n   RKS-Group-ID of the Record-Keeping-Server being used by the\
    \ UAS.  The\n   UAS MAY change the values of Acct-Charge-URI if it wishes to override\n\
    \   the billing information that was present in the INVITE (e.g., for a\n   toll-free\
    \ call).  The decision to do this and the contents of the new\n   Acct-Charge-URI\
    \ MUST be determined by service provider policy\n   provisioned in the UAS.  If\
    \ the UAS performed a LNP query, it MUST\n   include the Routing Number and Location\
    \ Routing Number returned by\n   the query.\n   The UAS MUST add a P-DCS-Billing-Info\
    \ header to a 3xx-redirect\n   response to an initial INVITE, giving the accounting\
    \ information for\n   the call forwarder, for the call segment from the destination\
    \ to the\n   forwarded-to destination.\n"
- title: 7.6.  Procedures at Proxy
  contents:
  - "7.6.  Procedures at Proxy\n   Three sets of proxy procedures are defined: (1)\
    \ the procedures at an\n   originating proxy, (2) the procedures at a terminating\
    \ proxy, and (3)\n   the procedures at a tandem proxy.\n   The originating proxy\
    \ is a proxy that received the INVITE request\n   from a non-trusted endpoint.\n\
    \   The terminating proxy is a proxy that sends the INVITE request to a\n   non-trusted\
    \ endpoint.\n   A proxy that is neither an originating proxy, nor a terminating\n\
    \   proxy, is a tandem proxy.\n   For purposes of mid-call changes, such as call\
    \ transfers, the proxy\n   that receives the request from a non-trusted endpoint\
    \ is considered\n   the initiating proxy; the proxy that sends the request to\
    \ a non-\n   trusted endpoint is considered the recipient proxy.  Procedures for\n\
    \   the initiating proxy are included below with those for originating\n   proxies,\
    \ while procedures for the recipient proxy are included with\n   those for terminating\
    \ proxies.\n   A proxy that both receives the INVITE request from an untrusted\n\
    \   endpoint, and sends the INVITE request to a non-trusted endpoint,\n   performs\
    \ both sets of procedures.\n"
- title: 7.6.1.  Procedures at Originating Proxy
  contents:
  - "7.6.1.  Procedures at Originating Proxy\n   The originating proxy MUST generate\
    \ the Billing-Correlation-ID for\n   the call, and insert it into the P-DCS-Billing-Info\
    \ header in the\n   initial INVITE message sent to the terminating proxy, along\
    \ with the\n   charging information for the call.  The originating proxy MUST\n\
    \   include its FEID, and the RKS-Group-ID for the Record-Keeping-Server\n   being\
    \ used by the originating proxy.  If the originating proxy\n   performed a LNP\
    \ query, it MUST include the Routing Number and\n   Location Routing Number returned\
    \ by the query.  Any P-DCS-Billing-\n   Info header present from an untrusted\
    \ UA MUST be removed.\n   If the Request-URI contains a private-URL, and the decoded\
    \ username\n   contains billing information, the originating proxy MUST generate\
    \ a\n   P-DCS-Billing-Info header with that decrypted information. Otherwise,\n\
    \   the originating proxy MUST determine the accounting information for\n   the\
    \ call originator, and insert a P-DCS-Billing-Info header including\n   that information.\n\
    \   If the response to the initial INVITE is a 3xx-Redirect, received\n   prior\
    \ to a 18x, the originating proxy generates a new initial INVITE\n   request to\
    \ the destination specified in the Contact: header, as per\n   standard SIP. \
    \ If an originating proxy receives a 3xx-Redirect\n   response to an initial INVITE\
    \ prior to a 18x response, the INVITE\n   generated by the proxy MUST contain\
    \ the P-DCS-Billing-Info header\n   from the 3xx-Redirect response.\n   If the\
    \ response to the initial INVITE is a 3xx-Redirect, received\n   after a 18x,\
    \ the originating proxy generates a private-URL and places\n   it in the Contact\
    \ header of a 3xx-Redirect response sent to the\n   originating endpoint.  This\
    \ private-URL MUST contain (or contain a\n   pointer to) the P-DCS-Billing-Info\
    \ value, which indicate the charging\n   arrangement for the new call, and an\
    \ expiration time very shortly in\n   the future, to limit the ability of the\
    \ originator to re-use this\n   private-URL for multiple calls.\n   An originating\
    \ proxy that processes a REFER request from an untrusted\n   UA MUST include a\
    \ P-DCS-Billing-Info header in the Refer-to's URL.\n   This P-DCS-Billing-Info\
    \ header MUST include the accounting\n   information of the initiator.\n"
- title: 7.6.2.  Procedures at Terminating Proxy
  contents:
  - "7.6.2.  Procedures at Terminating Proxy\n   The terminating proxy MUST NOT send\
    \ the P-DCS-Billing-Info header to\n   an untrusted destination.\n   The terminating\
    \ proxy MUST include a P-DCS-Billing-Info header in the\n   first reliable 1xx\
    \ (except 100) or 2xx response to an initial INVITE\n   message.  This P-DCS-Billing-Info\
    \ header MUST include the Billing-\n   Correlation-ID generated by the terminating\
    \ proxy, the FEID of the\n   terminating proxy, and the RKS-Group-ID of the Record-Keeping-Server\n\
    \   being used by the terminating proxy.  The terminating proxy MAY\n   change\
    \ the values of Acct-Charge-URI if it wishes to override the\n   billing information\
    \ that was present in the INVITE (e.g., for a\n   toll-free call).  The decision\
    \ to do this and the contents of the\n   resulting P-DCS-Billing-Info header MUST\
    \ be determined by service\n   provider policy provisioned in the terminating\
    \ proxy.  If the\n   terminating proxy performed a LNP query, it MUST include\
    \ the Routing\n   Number and Location Routing Number returned by the query.\n\
    \   The terminating proxy MUST add P-DCS-Billing-Info headers to a 3xx-\n   redirect\
    \ response to an initial INVITE, giving the accounting\n   information for the\
    \ call forwarder, for the call segment from the\n   destination to the forwarded-to\
    \ destination.\n   A proxy receiving a mid-call REFER request that includes a\
    \ Refer-to\n   header generates a private-URL and places it in the Refer-to header\n\
    \   sent to the endpoint.  This private-URL MUST contain the P-DCS-\n   Billing-Info\
    \ value, which indicate the charging arrangement for the\n   new call, and an\
    \ expiration time very shortly in the future, to limit\n   the ability of the\
    \ endpoint to re-use this private-URL for multiple\n   calls.\n"
- title: 7.6.3.  Procedures at Tandem Proxy
  contents:
  - "7.6.3.  Procedures at Tandem Proxy\n   If the tandem proxy performed a LNP query,\
    \ it MUST insert the Routing\n   Number and Location Routing Number returned by\
    \ the query into the P-\n   DCS-Billing-Info header in the first reliable 1xx/2xx/3xx\
    \ (except\n   100) response.\n"
- title: 8.  P-DCS-LAES and P-DCS-REDIRECT
  contents:
  - "8.  P-DCS-LAES and P-DCS-REDIRECT\n   NOTE:  According to RFC 2804 [5], the IETF\
    \ supports documentation of\n   lawful intercept technology if it is necessary\
    \ to develop it.  The\n   following section provides such documentation.  The\
    \ RFC 2119\n   language, as stated above, describes the requirements of the\n\
    \   specification only if implemented, and strictly within the\n   applicability\
    \ domain described above.  See RFC 2804 for description\n   of issues regarding\
    \ privacy, security, and complexity in relation to\n   this technology.\n   The\
    \ P-DCS-LAES extension contains the information needed to support\n   Lawfully\
    \ Authorized Electronic Surveillance.  This header contains\n   the address and\
    \ port of an Electronic Surveillance Delivery Function\n   for delivery of a duplicate\
    \ stream of event messages related to this\n   call.  The header may also contain\
    \ an additional address and port for\n   delivery of call content.  Security key\
    \ information is included to\n   enable pairs of Delivery Functions to securely\
    \ exchange surveillance\n   information.  This header is only used between proxies\
    \ and trusted\n   User Agents.\n   The P-DCS-Redirect extension contains call\
    \ identifying information\n   needed to support the requirements of Lawfully Authorized\
    \ Electronic\n   Surveillance of redirected calls.  This header is only used between\n\
    \   proxies and trusted User Agents.\n   Use of P-DCS-LAES and P-DCS-Redirect\
    \ is controlled by a combination\n   of legislation, regulation, and court orders,\
    \ which MUST be followed.\n   In certain cases inclusion of these headers will\
    \ be mandated, and\n   therefore MUST be present in the requests and responses\
    \ indicated.\n   In other cases inclusion of these headers will be forbidden,\
    \ and\n   therefore MUST NOT be present in the request and responses indicated.\n\
    \   In the sub-sections that follow, use of \"SHOULD\" is intended to\n   capture\
    \ these conflicting situations, e.g., a P-DCS-LAES header\n   SHOULD be included\
    \ in an initial INVITE means either that it MUST be\n   included or that it MUST\
    \ NOT be included, based on the applicable\n   court orders.\n"
- title: 8.1.  Syntax
  contents:
  - "8.1.  Syntax\n   The formats of the P-DCS-LAES and P-DCS-Redirect headers are\
    \ given by\n   the following ABNF (some terms used in this ABNF are defined in\
    \ [2]\n   and [3]):\n      P-DCS-LAES        = \"P-DCS-LAES\" HCOLON Laes-sig\n\
    \                          *(SEMI Laes-param)\n      Laes-sig          = hostport\n\
    \      Laes-param        = Laes-content / Laes-key / generic-param\n      Laes-content\
    \      = \"content\" EQUAL hostport\n      Laes-key          = \"key\" EQUAL token\n\
    \      P-DCS-Redirect    = \"P-DCS-Redirect\" HCOLON Called-ID\n             \
    \             *(redir-params)\n      Called-ID         = LDQUOT addr-spec RDQUOT\n\
    \      redir-params      = redir-uri-param / redir-count-param /\n           \
    \               generic-param\n      redir-uri-param   = \"redirector-uri\" EQUAL\
    \ Redirector\n      Redirector        = LDQUOT addr-spec RDQUOT\n      redir-count-param\
    \ = \"count\" EQUAL Redir-count\n      Redir-count       = 1*DIGIT\n   This document\
    \ adds the following entry to Table 2 of [2]:\n      Header field         where\
    \ proxy  ACK  BYE  CAN  INV  OPT  REG\n      ------------         ----- -----\
    \  ---  ---  ---  ---  ---  ---\n      P-DCS-LAES                  adr    -  \
    \  -    -    o    -    -\n      P-DCS-Redirect              adr    -    -    -\
    \    o    -    -\n                                        SUB  NOT  REF  INF \
    \ UPD  PRA\n                                        ---  ---  ---  ---  ---  ---\n\
    \                                         -    -    -    -    -    -\n       \
    \                                  -    -    -    -    -    -\n   The values of\
    \ Laes-sig and Laes-content are addresses of the\n   Electronic Surveillance Delivery\
    \ Function, and used as the\n   destination address for call-identifying information\
    \ and call-\n   content, respectively.  Laes-key is a string generated by the\
    \ proxy\n   that is used by the Delivery Function to securely transfer\n   information\
    \ between them [8].\n   The P-DCS-Redirect header contains redirection information.\
    \  The\n   redir-uri-param indicates the original destination requested by the\n\
    \   user (e.g., dialed number), the Redirector indicates the new\n   destination,\
    \ and the Redir-count indicates the number of redirections\n   that have occurred.\n"
- title: 8.2.  Procedures at an Untrusted User Agent Client (UAC)
  contents:
  - "8.2.  Procedures at an Untrusted User Agent Client (UAC)\n   This header MUST\
    \ NOT be sent to an untrusted UAC, and MUST NOT be\n   sent by an untrusted UAC.\n"
- title: 8.3.  Procedures at a Trusted User Agent Client (UAC)
  contents:
  - "8.3.  Procedures at a Trusted User Agent Client (UAC)\n   The UAC checks for\
    \ an outstanding lawfully authorized surveillance\n   order for the originating\
    \ subscriber, and, if present, includes this\n   information in the Authorization\
    \ for Quality of Service [7] or\n   signals this information to the device performing\
    \ the intercept\n   (e.g., a Media Gateway).\n   If the P-DCS-LAES header is present\
    \ in the first reliable 1xx (except\n   100), 2xx or 3xx response (indicating\
    \ surveillance is required on the\n   terminating subscriber, but that the terminating\
    \ equipment is unable\n   to perform that function), the UAC MUST include this\
    \ information in\n   the Authorization for Quality of Service, or MUST signal\
    \ this\n   information to the device performing the intercept (e.g., a Media\n\
    \   Gateway).\n   If a 3xx-Redirect response is received to the initial INVITE\
    \ request,\n   and if a P-DCS-LAES header is present in the 3xx response, the\
    \ UAC\n   SHOULD include that header unchanged in the reissued INVITE. The UAC\n\
    \   SHOULD also include a P-DCS-Redirect header containing the original\n   dialed\
    \ number, the new destination number, and the number of\n   redirections that\
    \ have occurred.  Although it is technically possible\n   for the originating\
    \ equipment to perform this surveillance (or add to\n   its existing surveillance\
    \ of the call), the design of the\n   surveillance system has the terminating\
    \ equipment performing the\n   surveillance for all the intermediate forwardings.\n\
    \   A UAC that includes a Refer-to header in a REFER request, when the\n   originating\
    \ subscriber has an outstanding lawfully authorized\n   surveillance order, SHOULD\
    \ include a P-DCS-LAES header attached to\n   the Refer-to.  The P-DCS-LAES header\
    \ SHOULD include the address and\n   port of the local Electronic Surveillance\
    \ Delivery Function for a\n   copy of the call's event messages, SHOULD include\
    \ the address and\n   port of the local Electronic Surveillance Delivery Function\
    \ for the\n   copy of call content if call content is to be intercepted, and SHOULD\n\
    \   include a random string for use as a security key between the\n   Delivery\
    \ Functions.\n   The trusted UAC MUST NOT send the P-DCS-LAES and P-DCS-Redirect\n\
    \   headers to an untrusted entity.\n"
- title: 8.4.  Procedures at an Untrusted User Agent Server (UAS)
  contents:
  - "8.4.  Procedures at an Untrusted User Agent Server (UAS)\n   This header MUST\
    \ NOT be sent to an untrusted UAS, and MUST NOT be\n   sent by an untrusted UAS.\n"
- title: 8.5.  Procedures at a Trusted User Agent Server (UAS)
  contents:
  - "8.5.  Procedures at a Trusted User Agent Server (UAS)\n   The UAS checks for\
    \ an outstanding lawfully authorized surveillance\n   order for the terminating\
    \ subscriber, or presence of the P-DCS-LAES\n   header in the INVITE request.\
    \  If either is present, the UAS includes\n   this information in the authorization\
    \ for Quality of Service [7].\n   If the terminating equipment is unable to perform\
    \ the required\n   surveillance (e.g., if the destination is a voicemail server),\
    \ the\n   UAS SHOULD include a P-DCS-LAES header in the first reliable non-100\n\
    \   response requesting the originating proxy to perform the\n   surveillance.\
    \  The P-DCS-LAES header SHOULD include the address and\n   port of the local\
    \ Electronic Surveillance Delivery Function for a\n   copy of the call's event\
    \ messages, SHOULD include the address and\n   port of the local Electronic Surveillance\
    \ Delivery Function for the\n   copy of call content if call content is to be\
    \ intercepted, and SHOULD\n   include a random string for use as a security key\
    \ between the\n   Delivery Functions.\n   If the response to the initial INVITE\
    \ request is a 3xx-Redirect\n   response, and there is an outstanding lawfully\
    \ authorized\n   surveillance order for the terminating subscriber, the UAS SHOULD\n\
    \   include a P-DCS-LAES header in the 3xx-Redirect response, with\n   contents\
    \ as described above.\n   The trusted UAS MUST NOT send the P-DCS-LAES and P-DCS-Redirect\n\
    \   headers to an untrusted entity.\n"
- title: 8.6.  Procedures at Proxy
  contents:
  - "8.6.  Procedures at Proxy\n   Two sets of proxy procedures are defined: (1) the\
    \ procedures at an\n   originating proxy, and (2) the procedures at a terminating\
    \ proxy. The\n   originating proxy is a proxy that received the INVITE request\
    \ from a\n   non-trusted endpoint.\n   The terminating proxy is a proxy that sends\
    \ the INVITE request to a\n   non-trusted endpoint.\n   For purposes of mid-call\
    \ changes, such as call transfers, the proxy\n   that receives the request from\
    \ a non-trusted endpoint is considered\n   the initiating proxy; the proxy that\
    \ sends the request to a non-\n   trusted endpoint is considered the recipient\
    \ proxy.  Procedures for\n   the initiating proxy are included below with those\
    \ for originating\n   proxies, while procedures for the recipient proxy are included\
    \ with\n   those for terminating proxies.\n   A proxy that both receives the INVITE\
    \ request from an untrusted\n   endpoint, and sends the INVITE request to a non-trusted\
    \ endpoint,\n   MUST NOT generate P-DCS-LAES nor P-DCS-Redirect headers.\n   A\
    \ proxy that is neither an originating proxy nor a terminating proxy\n   SHOULD\
    \ pass the P-DCS-Laes and P-DCS-Redirect headers in requests and\n   responses.\n"
- title: 8.6.1.  Procedures at Originating Proxy
  contents:
  - "8.6.1.  Procedures at Originating Proxy\n   The Originating Proxy MUST remove\
    \ any P-DCS-LAES and P-DCS-Redirect\n   headers in requests or responses to or\
    \ from an untrusted proxy or\n   untrusted UA.\n   The originating proxy checks\
    \ for an outstanding lawfully authorized\n   surveillance order for the originating\
    \ subscriber, and, if present,\n   includes this information in the Authorization\
    \ for Quality of Service\n   [7] or signals this information to the device performing\
    \ the\n   intercept (e.g., a Media Gateway).\n   If the P-DCS-LAES header is present\
    \ in the first reliable 1xx (except\n   100), 2xx or 3xx response (indicating\
    \ surveillance is required on the\n   terminating subscriber, but that the terminating\
    \ equipment is unable\n   to perform that function), the originating proxy MUST\
    \ include this\n   information in the Authorization for Quality of Service, or\
    \ MUST\n   signal this information to the device performing the intercept (e.g.,\n\
    \   a Media Gateway).\n   If the Request-URI in an initial INVITE request contains\
    \ a private-\n   URL, the originating proxy MUST decrypt the userinfo information\
    \ to\n   find the real destination for the call, and other special processing\n\
    \   information.  If electronic surveillance information is contained in\n   the\
    \ decrypted userinfo, the originating proxy SHOULD generate a P-\n   DCS-LAES\
    \ header with the surveillance information.\n   If a 3xx-Redirect response is\
    \ received to the initial INVITE request\n   prior to a 18x, and if a P-DCS-LAES\
    \ header is present in the 3xx\n   response, the originating proxy SHOULD include\
    \ that header unchanged\n   in the reissued INVITE.  The originating proxy SHOULD\
    \ also include a\n   P-DCS-Redirect header containing the original dialed number,\
    \ the new\n   destination number, and the number of redirections that have\n \
    \  occurred.\n   If a 3xx-Redirect response is received to the initial INVITE\
    \ request\n   after a 18x, the originating proxy generates a private-URL and places\n\
    \   it in the Contact header of a 3xx-Redirect response sent to the\n   originating\
    \ endpoint.  If a P-DCS-LAES header is present in the 3xx\n   response, this private-URL\
    \ MUST contain (1) the electronic\n   surveillance information from the 3xx-Redirect\
    \ response, (2) the\n   original destination number, (3) the identity of the redirecting\n\
    \   party, and (4) the number of redirections of this call.\n   An originating\
    \ proxy that processes a REFER request [4] from an\n   untrusted UA, when the\
    \ originating subscriber has an outstanding\n   lawfully authorized surveillance\
    \ order, becomes a B2BUA for that\n   request.  It SHOULD reissue the request\
    \ with a P-DCS-LAES header\n   added to the Refer-to's URL.  The P-DCS-LAES header\
    \ SHOULD include\n   (1) the address and port of the local Electronic Surveillance\n\
    \   Delivery Function for a copy of the call's event messages, (2) the\n   address\
    \ and port of the local Electronic Surveillance Delivery\n   Function for the\
    \ copy of call content if call content is to be\n   intercepted, and (3) a random\
    \ string for use as a security key\n   between the Delivery Functions.\n   An\
    \ initiating proxy that sends a mid-call REFER request including a\n   Refer-to\
    \ header, when the initiating subscriber has an outstanding\n   lawfully authorized\
    \ surveillance order, SHOULD include a P-DCS-LAES\n   header in the Refer-to's\
    \ URL.\n   The originating proxy MUST NOT send the P-DCS-LAES and P-DCS-Redirect\n\
    \   headers to an untrusted entity.\n"
- title: 8.6.2.  Procedures at Terminating Proxy
  contents:
  - "8.6.2.  Procedures at Terminating Proxy\n   The Terminating Proxy MUST remove\
    \ any P-DCS-LAES and P-DCS-Redirect\n   headers in requests or responses to or\
    \ from an untrusted proxy or UA.\n   The terminating proxy checks for an outstanding\
    \ lawfully authorized\n   surveillance order for the terminating subscriber. \
    \ If present, the\n   terminating proxy includes this information in the authorization\
    \ for\n   Quality of Service [7].\n   The terminating proxy MUST NOT send the\
    \ P-DCS-LAES and P-DCS-Redirect\n   headers to an untrusted entity, either as\
    \ headers in the request or\n   response, or as headers attached to URIs in the\
    \ request or response.\n   If the terminating equipment is unable to perform the\
    \ required\n   surveillance (e.g., if the destination is a voicemail server),\
    \ the\n   terminating proxy SHOULD include a P-DCS-LAES header in the first\n\
    \   reliable 1xx/2xx/3xx (except 100) response requesting the originating\n  \
    \ proxy to perform the surveillance.  The P-DCS-LAES header SHOULD\n   include\
    \ the address and port of the local Electronic Surveillance\n   Delivery Function\
    \ for a copy of the call's event messages, SHOULD\n   include the address and\
    \ port of the local Electronic Surveillance\n   Delivery Function for the copy\
    \ of call content if call content is to\n   be intercepted, and SHOULD include\
    \ a random string for use as a\n   security key between the Delivery Functions.\n\
    \   If the response to the initial INVITE request is a 3xx-Redirect\n   response,\
    \ and there is an outstanding lawfully authorized\n   surveillance order for the\
    \ terminating subscriber, the terminating\n   proxy SHOULD include a P-DCS-LAES\
    \ header in the 3xx-Redirect\n   response, with contents as described above.\n\
    \   A proxy receiving a mid-call REFER request [4] that includes a\n   Refer-to\
    \ header with a P-DCS-LAES header attached becomes a B2BUA for\n   this request.\
    \  It MUST generate a private-URL and place it in the\n   Refer-to header sent\
    \ to the endpoint.  This private-URL MUST contain\n   the P-DCS-LAES information\
    \ from the attached header.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   QoS gate coordination, billing information, and\
    \ electronic\n   surveillance information are all considered to be sensitive\n\
    \   information that MUST be protected from eavesdropping and furthermore\n  \
    \ require integrity checking.  It is therefore necessary that the\n   trusted\
    \ UAs and proxies take precautions to protect this information\n   from eavesdropping\
    \ and tampering.  Use of IPsec or TLS between\n   Proxies is REQUIRED.  A minimum\
    \ mandatory-to-implement IPsec\n   configuration for the DCS architecture is given\
    \ by [8].  Also\n   REQUIRED is mutual authentication (1) between Proxies and\
    \ (2) between\n   trusted UAs and Proxies, both of which MAY be implemented with\n\
    \   administratively pre-shared keys, or through consultation with\n   another\
    \ trusted third party.  If IPsec is to be used, the\n   specification of the security\
    \ policies and procedures of the\n   administrative domain where these headers\
    \ are applicable (and all\n   connections between administrative domains in the\
    \ federation) MUST\n   define an interoperable set of options.\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document defines a number of SIP extension\
    \ headers, which have\n   been included in the registry of SIP headers defined\
    \ in [2].\n   Registration information for new headers is as follows:\n   Header\
    \ Field Name:   P-DCS-Trace-Party-ID\n        RFC Number:     3603\n        Compact\
    \ Form:   none\n   Header Field Name:   P-DCS-OSPS\n        RFC Number:     3603\n\
    \        Compact Form:   none\n   Header Field Name:   P-DCS-Billing-Info\n  \
    \      RFC Number:     3603\n        Compact Form:   none\n   Header Field Name:\
    \   P-DCS-LAES\n        RFC Number:     3603\n        Compact Form:   none\n \
    \  Header Field Name:   P-DCS-Redirect\n        RFC Number:     3603\n       \
    \ Compact Form:   none\n"
- title: 11.  Intellectual Property Rights Notice
  contents:
  - "11.  Intellectual Property Rights Notice\n   The IETF has been notified of intellectual\
    \ property rights claimed in\n   regard to some or all of the specification contained\
    \ in this\n   document.  For more information consult the online list of claimed\n\
    \   rights.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [1]  Bradner, S., \"Key words for use in RFCs\
    \ to Indicate Requirement\n        Levels\", BCP 14, RFC 2119, March 1997.\n \
    \  [2]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,\n       \
    \ Peterson, J., Sparks, R., Handley, M. and E. Schooler, \"SIP:\n        Session\
    \ Initiation Protocol\", RFC 3261, June 2002.\n   [3]  Crocker, D., Ed. and P.\
    \ Overell, \"Augmented BNF for Syntax\n        Specifications: ABNF\", RFC 2234,\
    \ November 1997.\n   [4]  Sparks, R., \"The Session Initiation Protocol (SIP)\
    \ Refer\n        Method\", RFC 3515, April 2003.\n   [5]  IAB and IESG, \"IETF\
    \ Policy on Wiretapping\", RFC 2804, May 2000.\n"
- title: 12.2. Informative References
  contents:
  - "12.2. Informative References\n   [6]  DCS Group, \"Architectural Considerations\
    \ for Providing Carrier\n        Class Telephony Services Utilizing SIP-based\
    \ Distributed Call\n        Control Mechanisms\", Work in Progress.\n   [7]  PacketCable\
    \ Dynamic Quality of Service Specification, pkt-sp-\n        dqos-i07-030815,\
    \ August 2003.\n   [8]  PacketCable Security Specification, pkt-sp-sec-i09-030728,\
    \ July\n        2003.\n   [9]  PacketCable Event Message Specification, pkt-sp-em-i07-030815,\n\
    \        August 2003.\n   [10] Jennings, C., Peterson, J. and M. Watson, \"Private\
    \ Extensions to\n        the Session Initiation Protocol (SIP) for Asserted Identity\n\
    \        within Trusted Networks\", RFC 3325, November 2002.\n"
- title: 13.  Acknowledgements
  contents:
  - "13.  Acknowledgements\n   The Distributed Call Signaling work in the PacketCable\
    \ project is the\n   work of a large number of people, representing many different\n\
    \   companies.  The authors would like to recognize and thank the\n   following\
    \ for their assistance: John Wheeler, Motorola; David\n   Boardman, Daniel Paul,\
    \ Arris Interactive; Bill Blum, Jon Fellows, Jay\n   Strater, Jeff Ollis, Clive\
    \ Holborow, Motorola; Doug Newlin, Guido\n   Schuster, Ikhlaq Sidhu, 3Com; Jiri\
    \ Matousek, Bay Networks; Farzi\n   Khazai, Nortel; John Chapman, Bill Guckel,\
    \ Michael Ramalho, Cisco;\n   Chuck Kalmanek, Doug Nortz, John Lawser, James Cheng,\
    \ Tung- Hai\n   Hsiao, Partho Mishra, AT&T; Telcordia Technologies; and Lucent\
    \ Cable\n   Communications.\n   Previous versions further acknowledged, as co-authors,\
    \ several people\n   for providing the text of this document.  They are:\n   \
    \   Bill Marshall (wtm@research.att.com) and K. K. Ramakrishnan\n      (kkrama@research.att.com),\
    \ AT&T; Ed Miller\n      (edward.miller@terayon.com), Terayon; Glenn Russell\n\
    \      (G.Russell@Cablelabs.com), CableLabs; Burcak Beser\n      (burcak@juniper.net)\
    \ Juniper Networks, Mike Mannette\n      (Michael_Mannette@3com.com) and Kurt\
    \ Steinbrenner\n      (Kurt_Steinbrenner@3com.com), 3Com; Dave Oran (oran@cisco.com)\
    \ and\n      Flemming Andreasen (fandreas@cisco.com), Cisco Systems; John\n  \
    \    Pickens (jpickens@com21.com), Com21; Poornima Lalwaney\n      (poornima.lalwaney@nokia.com),\
    \ Nokia; Jon Fellows\n      (jfellows@coppermountain.com), Copper Mountain Networks;\
    \ Doc Evans\n      (n7dr@arrisi.com) Arris, and Keith Kelly (keith@netspeak.com),\n\
    \      NetSpeak.\n"
- title: 14.  Editors' Addresses
  contents:
  - "14.  Editors' Addresses\n   Bill Marshall\n   AT&T\n   Florham Park, NJ  07932\n\
    \   EMail: wtm@research.att.com\n   Flemming Andreasen\n   Cisco\n   Edison, NJ\n\
    \   EMail: fandreas@cisco.com\n"
- title: 15.  Full Copyright Statement
  contents:
  - "15.  Full Copyright Statement\n   Copyright (C) The Internet Society (2003).\
    \  All Rights Reserved.\n   This document and translations of it may be copied\
    \ and furnished to\n   others, and derivative works that comment on or otherwise\
    \ explain it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assignees.\n\
    \   This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
