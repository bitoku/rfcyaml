- title: __initial_text__
  contents:
  - '                Authentication Protocol for Mobile IPv6

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: IESG Note
  contents:
  - "IESG Note\n   This RFC is not a candidate for any level of Internet Standard.\
    \  RFC\n   3775 and 3776 define Mobile IPv6 and its security mechanism.  This\n\
    \   document presents an alternate security mechanism for Mobile IPv6\n   used\
    \ in 3GPP2 networks.\n   The security properties of this mechanism have not been\
    \ reviewed in\n   the IETF.  Conducting this review proved difficult because the\n\
    \   standards-track security mechanism for Mobile IPv6 is tightly\n   integrated\
    \ into the protocol; extensions to Mobile IPv6 and the core\n   documents make\
    \ assumptions about the properties of the security model\n   without explicitly\
    \ stating what assumptions are being made.  There is\n   no documented service\
    \ model.  Thus it is difficult to replace the\n   security mechanism and see if\
    \ the current protocol and future\n   extensions meet appropriate security requirements\
    \ both under the\n   original and new security mechanisms.  If a service model\
    \ for Mobile\n   IPv6 security is ever formally defined and reviewed, a mechanism\n\
    \   similar to this one could be produced and fully reviewed.\n   Section 1.1\
    \ of this document provides an applicability statement for\n   this RFC.  The\
    \ IESG recommends against the usage of this\n   specification outside of environments\
    \ that meet the conditions of\n   that applicability statement.  In addition the\
    \ IESG recommends those\n   considering deploying or implementing this specification\
    \ conduct a\n   sufficient security review to meet the conditions of the environments\n\
    \   in which this RFC will be used.\n"
- title: Abstract
  contents:
  - "Abstract\n   IPsec is specified as the means of securing signaling messages\n\
    \   between the Mobile Node and Home Agent for Mobile IPv6 (MIPv6).\n   MIPv6\
    \ signaling messages that are secured include the Binding Updates\n   and Acknowledgement\
    \ messages used for managing the bindings between a\n   Mobile Node and its Home\
    \ Agent.  This document proposes an alternate\n   method for securing MIPv6 signaling\
    \ messages between Mobile Nodes and\n   Home Agents.  The alternate method defined\
    \ here consists of a\n   MIPv6-specific mobility message authentication option\
    \ that can be\n   added to MIPv6 signaling messages.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Applicability Statement ....................................3\n  \
    \ 2. Overview ........................................................4\n   3.\
    \ Terminology .....................................................5\n      3.1.\
    \ General Terms ..............................................5\n   4. Operational\
    \ Flow ................................................6\n   5. Mobility Message\
    \ Authentication Option ..........................7\n      5.1. MN-HA Mobility\
    \ Message Authentication Option ...............8\n           5.1.1. Processing\
    \ Considerations ...........................9\n      5.2. MN-AAA Mobility Message\
    \ Authentication Option ..............9\n           5.2.1. Processing Considerations\
    \ ..........................10\n      5.3. Authentication Failure Detection at\
    \ the Mobile Node .......11\n   6. Mobility Message Replay Protection Option ......................11\n\
    \   7. Security Considerations ........................................13\n  \
    \ 8. IANA Considerations ............................................14\n   9.\
    \ Acknowledgements ...............................................15\n   10. References\
    \ ....................................................15\n      10.1. Normative\
    \ References .....................................15\n      10.2. Informative\
    \ References ...................................15\n   Appendix A. Rationale for\
    \ mobility message replay protection\n               option ................................................16\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The base Mobile IPv6 specification [RFC3775] specifies the\
    \ signaling\n   messages, Binding Update (BU) and Binding Acknowledgement (BA),\n\
    \   between the Mobile Node (MN) and Home Agent (HA) to be secured by the\n  \
    \ IPsec Security Associations (IPsec SAs) that are established between\n   these\
    \ two entities.\n   This document proposes a solution for securing the Binding\
    \ Update and\n   Binding Acknowledgment messages between the Mobile Node and Home\n\
    \   Agent using a mobility message authentication option that is included\n  \
    \ in these messages.  Such a mechanism enables IPv6 mobility in a host\n   without\
    \ having to establish an IPsec SA with its Home Agent.  A\n   Mobile Node can\
    \ implement Mobile IPv6 without having to integrate it\n   with the IPsec module,\
    \ in which case the Binding Update and Binding\n   Acknowledgement messages (between\
    \ MN-HA) are secured with the\n   mobility message authentication option.\n  \
    \ The authentication mechanism proposed here is similar to the\n   authentication\
    \ mechanism used in Mobile IPv4 [RFC3344].\n"
- title: 1.1.  Applicability Statement
  contents:
  - "1.1.  Applicability Statement\n   The mobility message authentication option\
    \ specified in Section 5 is\n   applicable in certain types of networks that have\
    \ the following\n   characteristics:\n   - Networks in which the authentication\
    \ of the MN for network access\n   is done by an authentication server in the\
    \ home network via the home\n   agent.  The security association is established\
    \ by the network\n   operator (provisioning methods) between the MN and a backend\n\
    \   authentication server (e.g., Authentication, Authorization, and\n   Accounting\
    \ (AAA) home server).  MIPv6 as per RFCs 3775 and 3776\n   relies on the IPsec\
    \ SA between the MN and an HA.  In cases where the\n   assignment of the HA is\
    \ dynamic and the only static or long-term SA\n   is between the MN and a backend\
    \ authentication server, the mobility\n   message authentication option is desirable.\n\
    \   - In certain deployment environments, the mobile node needs dynamic\n   assignment\
    \ of a home agent and home address.  The assignment of such\n   can be on a per-session\
    \ basis or on a per-MN power-up basis.  In such\n   scenarios, the MN relies on\
    \ an identity such as a Network Access\n   Identifier (NAI) [RFC4283], and a security\
    \ association with a AAA\n   server to obtain such bootstrapping information.\
    \  The security\n   association is created via an out-of-band mechanism or by\
    \ non Mobile\n   IPv6 signaling.  The out-of-band mechanism can be specific to\
    \ the\n   deployment environment of a network operator.  In Code Division\n  \
    \ Multiple Access (CDMA) network deployments, this information can be\n   obtained\
    \ at the time of network access authentication via [3GPP2]\n   specific extensions\
    \ to PPP or DHCPv6 on the access link and by AAA\n   extensions in the core. \
    \ It should be noted that the out-of-band\n   mechanism is not within the scope\
    \ of the mobility message\n   authentication option (Section 5) and hence is not\
    \ described therein.\n   - Network deployments in which not all Mobile Nodes and\
    \ Home Agents\n   have IKEv2 implementations and support for the integration of\
    \ IKEv2\n   with backend AAA infrastructures.  IKEv2 as a technology has yet to\n\
    \   reach maturity status and widespread implementations needed for\n   commercial\
    \ deployments on a large scale.  At the time of this\n   writing, [RFC4306] is\
    \ yet to be published as an RFC.  Hence from a\n   practical perspective that\
    \ operators face, IKEv2 is not yet capable\n   of addressing the immediate need\
    \ for MIPv6 deployment.\n   - Networks that expressly rely on the backend AAA\
    \ infrastructure as\n   the primary means for identifying and authentication/authorizing\
    \ a\n   mobile user for MIPv6 service.\n   - Networks in which the establishment\
    \ of the security association\n   between the Mobile Node and the authentication\
    \ server (AAA Home) is\n   established using an out-of-band mechanism and not\
    \ by any key\n   exchange protocol.  Such networks will also rely on out-of-band\n\
    \   mechanisms to renew the security association (between MN and AAA\n   Home)\
    \ when needed.\n   - Networks that are bandwidth constrained (such as cellular\
    \ wireless\n   networks) and for which there exists a strong desire to minimize\
    \ the\n   number of signaling messages sent over such interfaces.  MIPv6\n   signaling\
    \ that relies on Internet Key Exchange (IKE) as the primary\n   means for setting\
    \ up an SA between the MN and HA requires more\n   signaling messages compared\
    \ with the use of an mobility message\n   authentication option carried in the\
    \ BU/BA messages.\n   One such example of networks that have such characteristics\
    \ are CDMA\n   networks as defined in [3GPP2].\n"
- title: 2.  Overview
  contents:
  - "2.  Overview\n   This document presents a lightweight mechanism to authenticate\
    \ the\n   Mobile Node at the Home Agent or at the Authentication,\n   Authorization,\
    \ and Accounting (AAA) server in Home network (AAAH)\n   based on a shared-key-based\
    \ mobility security association between the\n   Mobile Node and the respective\
    \ authenticating entity.  This shared-\n   key-based mobility security association\
    \ (shared-key-based mobility\n   SA) may be statically provisioned or dynamically\
    \ created.  The term\n   \"mobility security association\" referred to in this\
    \ document is\n   understood to be a \"shared-key-based Mobile IPv6 authentication\"\
    \n   security association.\n   This document introduces new mobility options to\
    \ aid in\n   authentication of the Mobile Node to the Home Agent or AAAH server.\n\
    \   The confidentiality protection of Return Routability messages and\n   authentication/integrity\
    \ protection of Mobile Prefix Discovery (MPD)\n   is not provided when these options\
    \ are used for authentication of the\n   Mobile Node to the Home Agent.  Thus,\
    \ unless the network can\n   guarantee such protection (for instance, like in\
    \ 3GPP2 networks),\n   Route Optimization and Mobile Prefix Discovery should not\
    \ be used\n   when using the mobility message authentication option.\n"
- title: 3.  Terminology
  contents:
  - "3.  Terminology\n   The keywords \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119.\n"
- title: 3.1.  General Terms
  contents:
  - "3.1.  General Terms\n   First (size, input)\n      Some formulas in this specification\
    \ use a functional form \"First\n      (size, input)\" to indicate truncation\
    \ of the \"input\" data so that\n      only the first \"size\" bits remain to\
    \ be used.\n   Shared-key-based Mobility Security Association\n      Security\
    \ relation between the Mobile Node and its Home Agent, used\n      to authenticate\
    \ the Mobile Node for mobility service.  The\n      shared-key-based mobility\
    \ security association between Mobile Node\n      and Home Agent consists of a\
    \ mobility Security Parameter Index\n      (SPI), a shared key, an authentication\
    \ algorithm, and the replay\n      protection mechanism in use.\n   Mobility SPI\n\
    \      A number in the range [0-4294967296] used to index into the\n      shared-key-based\
    \ mobility security associations.\n"
- title: 4.  Operational Flow
  contents:
  - "4.  Operational Flow\n   The figure below describes the sequence of messages\
    \ sent and received\n   between the MN and HA in the registration process.  Binding\
    \ Update\n   (BU) and Binding Acknowledgement (BA) messages are used in the\n\
    \   registration process.\n         MN                                       \
    \           HA/AAAH\n         |                   BU to HA                   \
    \        |\n   (a)   |----------------------------------------------------->|\n\
    \         | (including MN-ID option,                             |\n         |\
    \  mobility message replay protection option[optional],|\n         |  mobility\
    \ message authentication option)             |\n         |                   \
    \                                   |\n         |                            \
    \       HA/AAAH authenticates MN\n         |                                 \
    \                     |\n         |                                          \
    \            |\n         |                  BA to MN                         \
    \   |\n   (b)   |<-----------------------------------------------------|\n   \
    \      | (including MN-ID option,                             |\n         |  mobility\
    \ message replay protection option[optional],|\n         |  mobility message authentication\
    \ option)             |\n         |                                          \
    \            |\n         Figure 1: Home Registration with Authentication Protocol\n\
    \   The Mobile Node MUST use the Mobile Node Identifier option,\n   specifically\
    \ the MN-NAI mobility option as defined in [RFC4283] to\n   identify itself while\
    \ authenticating with the Home Agent.  The Mobile\n   Node uses the Mobile Node\
    \ Identifier option as defined in [RFC4283]\n   to identify itself as may be required\
    \ for use with some existing AAA\n   infrastructure designs.\n   The Mobile Node\
    \ MAY use the Message Identifier option as defined in\n   Section 6 for additional\
    \ replay protection.\n   The mobility message authentication option described\
    \ in Section 5 may\n   be used by the Mobile Node to transfer authentication data\
    \ when the\n   Mobile Node and the Home Agent are utilizing a mobility SPI (a\
    \ number\n   in the range [0-4294967296] used to index into the shared-key-based\n\
    \   mobility security associations) to index between multiple mobility\n   security\
    \ associations.\n"
- title: 5.  Mobility Message Authentication Option
  contents:
  - "5.  Mobility Message Authentication Option\n   This section defines a mobility\
    \ message authentication option that\n   may be used to secure Binding Update\
    \ and Binding Acknowledgement\n   messages.  This option can be used along with\
    \ IPsec or preferably as\n   an alternate mechanism to authenticate Binding Update\
    \ and Binding\n   Acknowledgement messages in the absence of IPsec.\n   This document\
    \ also defines subtype numbers, which identify the mode\n   of authentication\
    \ and the peer entity to authenticate the message.\n   Two subtype numbers are\
    \ specified in this document.  Other subtypes\n   may be defined for use in the\
    \ future.\n   Only one instance of a mobility message authentication option of\
    \ a\n   particular subtype can be present in the message.  One message may\n \
    \  contain multiple instances of the mobility message authentication\n   option\
    \ with different subtype values.  If both MN-HA and MN-AAA\n   authentication\
    \ options are present, the MN-HA authentication option\n   must be present before\
    \ the MN-AAA authentication option (else, the HA\n   MUST discard the message).\n\
    \   When a Binding Update or Binding Acknowledgement is received without\n   a\
    \ mobility message authentication option and the entity receiving it\n   is configured\
    \ to use the mobility message authentication option or\n   has the shared-key-based\
    \ mobility security association for the\n   mobility message authentication option,\
    \ the entity should silently\n   discard the received message.\n       0     \
    \              1                   2                   3\n       0 1 2 3 4 5 6\
    \ 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                       |  Option Type  | Option Length |  Subtype      |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |                  Mobility SPI                                 |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n       |\
    \                  Authentication Data ....\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \             Figure 2: Mobility Message Authentication Option\n      Option Type:\n\
    \         AUTH-OPTION-TYPE value 9 has been defined by IANA.  An 8-bit\n     \
    \    identifier of the type mobility option.\n      Option Length:\n         8-bit\
    \ unsigned integer, representing the length in octets of\n         the Subtype,\
    \ mobility Security Parameter Index (SPI) and\n         Authentication Data fields.\n\
    \      Subtype:\n         A number assigned to identify the entity and/or mechanism\
    \ to be\n         used to authenticate the message.\n      Mobility SPI:\n   \
    \      Mobility Security Parameter Index\n      Authentication Data:\n       \
    \  This field has the information to authenticate the relevant\n         mobility\
    \ entity.  This protects the message beginning at the\n         Mobility Header\
    \ up to and including the mobility SPI field.\n      Alignment requirements :\n\
    \         The alignment requirement for this option is 4n + 1.\n"
- title: 5.1.  MN-HA Mobility Message Authentication Option
  contents:
  - "5.1.  MN-HA Mobility Message Authentication Option\n   The format of the MN-HA\
    \ mobility message authentication option is as\n   defined in Figure 2.  This\
    \ option uses the subtype value of 1.  The\n   MN-HA mobility message authentication\
    \ option is used to authenticate\n   the Binding Update and Binding Acknowledgement\
    \ messages based on the\n   shared-key-based security association between the\
    \ Mobile Node and the\n   Home Agent.\n   The shared-key-based mobility security\
    \ association between Mobile\n   Node and Home Agent used within this specification\
    \ consists of a\n   mobility SPI, a key, an authentication algorithm, and the\
    \ replay\n   protection mechanism in use.  The mobility SPI is a number in the\n\
    \   range [0-4294967296], where the range [0-255] is reserved.  The key\n   consists\
    \ of an arbitrary value and is 16 octets in length.  The\n   authentication algorithm\
    \ is HMAC_SHA1.  The replay protection\n   mechanism may use the Sequence number\
    \ as specified in [RFC3775] or\n   the Timestamp option as defined in Section\
    \ 6.  If the Timestamp\n   option is used for replay protection, the mobility\
    \ security\n   association includes a \"close enough\" field to account for clock\n\
    \   drift.  A default value of 7 seconds SHOULD be used.  This value\n   SHOULD\
    \ be greater than 3 seconds.\n   The MN-HA mobility message authentication option\
    \ MUST be the last\n   option in a message with a mobility header if it is the\
    \ only mobility\n   message authentication option in the message.\n   The authentication\
    \ data is calculated on the message starting from\n   the mobility header up to\
    \ and including the mobility SPI value of\n   this option.\n   Authentication\
    \ Data = First (96, HMAC_SHA1(MN-HA Shared key, Mobility\n   Data))\n   Mobility\
    \ Data = care-of address | home address | Mobility Header (MH)\n   Data\n   MH\
    \ Data is the content of the Mobility Header up to and including the\n   mobility\
    \ SPI field of this option.  The Checksum field in the\n   Mobility Header MUST\
    \ be set to 0 to calculate the Mobility Data.\n   The first 96 bits from the Message\
    \ Authentication Code (MAC) result\n   are used as the Authentication Data field.\n"
- title: 5.1.1.  Processing Considerations
  contents:
  - "5.1.1.  Processing Considerations\n   The assumption is that the Mobile Node\
    \ has a shared-key-based\n   security association with the Home Agent.  The Mobile\
    \ Node MUST\n   include this option in a BU if it has a shared-key-based mobility\n\
    \   security association with the Home Agent.  The Home Agent MUST\n   include\
    \ this option in the BA if it received this option in the\n   corresponding BU\
    \ and Home Agent has a shared-key-based mobility\n   security association with\
    \ the Mobile Node.\n   The Mobile Node or Home Agent receiving this option MUST\
    \ verify the\n   authentication data in the option.  If authentication fails,\
    \ the Home\n   Agent MUST send BA with Status Code MIPV6-AUTH-FAIL.  If the Home\n\
    \   Agent does not have shared-key-based mobility SA, Home Agent MUST\n   discard\
    \ the BU.  The Home Agent MAY log such events.\n"
- title: 5.2.  MN-AAA Mobility Message Authentication Option
  contents:
  - "5.2.  MN-AAA Mobility Message Authentication Option\n   The format of the MN-AAA\
    \ mobility message authentication option is as\n   defined in Figure 2.  This\
    \ option uses the subtype value of 2.  The\n   MN-AAA authentication mobility\
    \ option is used to authenticate the\n   Binding Update message based on the shared\
    \ mobility security\n   association between the Mobile Node and AAA server in\
    \ Home network\n   (AAAH).  It is not used in Binding Acknowledgement messages.\
    \  The\n   corresponding Binding Acknowledgement messages must be authenticated\n\
    \   using the MN-HA mobility message authentication option (Section 5.1).\n  \
    \ The MN-AAA mobility message authentication option must be the last\n   option\
    \ in a message with a mobility header.  The corresponding\n   response MUST include\
    \ the MN-HA mobility message authentication\n   option, and MUST NOT include the\
    \ MN-AAA mobility message\n   authentication option.\n   The Mobile Node MAY use\
    \ the Mobile Node Identifier option [RFC4283]\n   to enable the Home Agent to\
    \ make use of available AAA infrastructure.\n   The authentication data is calculated\
    \ on the message starting from\n   the mobility header up to and including the\
    \ mobility SPI value of\n   this option.\n   The authentication data shall be\
    \ calculated as follows:\n   Authentication data = hash_fn(MN-AAA Shared key,\
    \ MAC_Mobility Data)\n   hash_fn() is decided by the value of mobility SPI field\
    \ in the MN-AAA\n   mobility message authentication option.\n   SPI = HMAC_SHA1_SPI:\n\
    \   If mobility SPI has the well-known value HMAC_SHA1_SPI, then\n   hash_fn()\
    \ is HMAC_SHA1.  When HMAC_SHA1_SPI is used, the BU is\n   authenticated by AAA\
    \ using HMAC_SHA1 authentication.  In that case,\n   MAC_Mobility Data is calculated\
    \ as follows:\n   MAC_Mobility Data = SHA1(care-of address | home address | MH\
    \ Data)\n   MH Data is the content of the Mobility Header up to and including\
    \ the\n   mobility SPI field of this option.\n"
- title: 5.2.1.  Processing Considerations
  contents:
  - "5.2.1.  Processing Considerations\n   The use of the MN-AAA mobility message\
    \ authentication option assumes\n   that AAA entities at the home site communicate\
    \ with the HA via an\n   authenticated channel.  Specifically, a BU with the MN-AAA\
    \ mobility\n   message authentication option is authenticated via a home AAA server.\n\
    \   The specific details of the interaction between the HA and the AAA\n   server\
    \ is beyond the scope of this document.\n   When the Home Agent receives a Binding\
    \ Update with the MN-AAA\n   mobility message authentication option, the Binding\
    \ Update is\n   authenticated by an entity external to the Home Agent, typically\
    \ a\n   AAA server.\n"
- title: 5.3.  Authentication Failure Detection at the Mobile Node
  contents:
  - "5.3.  Authentication Failure Detection at the Mobile Node\n   In case of authentication\
    \ failure, the Home Agent MUST send a Binding\n   Acknowledgement with status\
    \ code MIPV6-AUTH-FAIL to the Mobile Node,\n   if a shared-key-based mobility\
    \ security association to be used\n   between Mobile Node and Home Agent for authentication\
    \ exists.  If\n   there is no shared-key-based mobility security association,\
    \ HA drops\n   the Binding Update.  HA may log the message for administrative\n\
    \   action.\n   Upon receiving a Binding Acknowledgement with status code MIPV6-\n\
    \   AUTH-FAIL, the Mobile Node SHOULD stop sending new Binding Updates to\n  \
    \ the Home Agent.\n"
- title: 6.  Mobility Message Replay Protection Option
  contents:
  - "6.  Mobility Message Replay Protection Option\n   The Mobility message replay\
    \ protection option MAY be used in Binding\n   Update/Binding Acknowledgement\
    \ messages when authenticated using the\n   mobility message authentication option\
    \ as described in Section 5.\n   The mobility message replay protection option\
    \ is used to let the Home\n   Agent verify that a Binding Update has been freshly\
    \ generated by the\n   Mobile Node and not replayed by an attacker from some previous\n\
    \   Binding Update.  This is especially useful for cases where the Home\n   Agent\
    \ does not maintain stateful information about the Mobile Node\n   after the binding\
    \ entry has been removed.  The Home Agent does the\n   replay protection check\
    \ after the Binding Update has been\n   authenticated.  The mobility message replay\
    \ protection option when\n   included is used by the Mobile Node for matching\
    \ BA with BU.\n   If this mode of replay protection is used, it needs to be part\
    \ of the\n   shared-key-based mobility security association.\n   If the policy\
    \ at Home Agent mandates replay protection using this\n   option (as opposed to\
    \ the sequence number in the Mobility Header in\n   Binding Update) and the Binding\
    \ Update from the Mobile Node does not\n   include this option, the Home Agent\
    \ discards the BU and sets the\n   Status Code in BA to MIPV6-MESG-ID-REQD.\n\
    \   When the Home Agent receives the mobility message replay protection\n   option\
    \ in Binding Update, it MUST include the mobility message replay\n   protection\
    \ option in Binding Acknowledgement.  Appendix A provides\n   details regarding\
    \ why the mobility message replay protection option\n   MAY be used when using\
    \ the authentication option.\n       0                   1                   2\
    \                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1\n                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                   |      Option Type  | Option Length |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |                  Timestamp ...                                |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n       |\
    \                  Timestamp                                    |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \            Figure 3: Mobility Message Replay Protection Option\n      Option\
    \ Type:\n         MESG-ID-OPTION-TYPE value 10 has been defined by IANA.  An\n\
    \         8-bit identifier of the type mobility option.\n      Option Length:\n\
    \         8-bit unsigned integer, representing the length in octets of\n     \
    \    the Timestamp field.\n      Timestamp:\n         This field carries the 64\
    \ bit timestamp.\n      Alignment requirements :\n         The alignment requirement\
    \ for this option is 8n + 2.\n   The basic principle of timestamp replay protection\
    \ is that the node\n   generating a message inserts the current time of day, and\
    \ the node\n   receiving the message checks that this timestamp is sufficiently\n\
    \   close to its own time of day.  Unless specified differently in the\n   shared-key-based\
    \ mobility security association between the nodes, a\n   default value of 7 seconds\
    \ MAY be used to limit the time difference.\n   This value SHOULD be greater than\
    \ 3 seconds.  The two nodes must have\n   adequately synchronized time-of-day\
    \ clocks.\n   The Mobile Node MUST set the Timestamp field to a 64-bit value\n\
    \   formatted as specified by the Network Time Protocol (NTP) [RFC1305].\n   The\
    \ low-order 32 bits of the NTP format represent fractional seconds,\n   and those\
    \ bits that are not available from a time source SHOULD be\n   generated from\
    \ a good source of randomness.  Note, however, that when\n   using timestamps,\
    \ the 64-bit timestamp used in a Binding Update from\n   the Mobile Node MUST\
    \ be greater than that used in any previous\n   successful Binding Update.\n \
    \  After successful authentication of Binding Update (either locally at\n   the\
    \ Home Agent or when a success indication is received from the AAA\n   server),\
    \ the Home Agent MUST check the Timestamp field for validity.\n   In order to\
    \ be valid, the timestamp contained in the Timestamp field\n   MUST be close enough\
    \ to the Home Agent's time-of-day clock and the\n   timestamp MUST be greater\
    \ than all previously accepted timestamps for\n   the requesting Mobile Node.\n\
    \   If the timestamp is valid, the Home Agent copies the entire Timestamp\n  \
    \ field into the Timestamp field in the BA it returns to the Mobile\n   Node.\
    \  If the timestamp is not valid, the Home Agent copies only the\n   low-order\
    \ 32 bits into the BA, and supplies the high-order 32 bits\n   from its own time\
    \ of day.\n   If the Timestamp field is not valid but the authentication of the\
    \ BU\n   succeeds, the Home Agent MUST send a Binding Acknowledgement with\n \
    \  status code MIPV6-ID-MISMATCH.  The Home Agent does not create a\n   binding\
    \ cache entry if the timestamp check fails.\n   If the Mobile Node receives a\
    \ Binding Acknowledgement with the code\n   MIPV6-ID-MISMATCH, the Mobile Node\
    \ MUST authenticate the BA by\n   processing the MN-HA authentication mobility\
    \ option.\n   If authentication succeeds, the Mobile Node MUST adjust its timestamp\n\
    \   and send subsequent Binding Update using the updated value.\n   Upon receiving\
    \ a BA that does not contain the MIPV6-ID-MISMATCH\n   status code, the Mobile\
    \ Node MUST compare the Timestamp value in the\n   BA to the Timestamp value it\
    \ sent in the corresponding BU.  If the\n   values match, the Mobile Node proceeds\
    \ to process the MN-HA\n   authentication data in the BA.  If the values do not\
    \ match, the\n   Mobile Node silently discards the BA.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   This document proposes new mobility message authentication\
    \ options to\n   authenticate the control message between Mobile Node, Home Agent,\n\
    \   and/or home AAA (as an alternative to IPsec).  The new options\n   provide\
    \ for authentication of Binding Update and Binding\n   Acknowledgement messages.\
    \  The MN-AAA mobility message authentication\n   option provide for authentication\
    \ with AAA infrastructure.\n   This specification also introduces an optional\
    \ replay protection\n   mechanism in Section 6, to prevent replay attacks.  The\
    \ sequence\n   number field in the Binding Update is not used if this mechanism\
    \ is\n   used.  This memo defines the timestamp option to be used for mobility\n\
    \   message replay protection.\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   IANA services are required for this specification.\
    \  The values for\n   new mobility options and status codes must be assigned from\
    \ the\n   Mobile IPv6 [RFC3775] numbering space.\n   The values for Mobility Option\
    \ types AUTH-OPTION-TYPE and MESG-ID-\n   OPTION-TYPE, as defined in Section 5\
    \ and Section 6, have been\n   assigned.  The values are 9 for the AUTH-OPTION-TYPE\
    \ and 10 for the\n   MESG-ID-OPTION-TYPE Mobility Option.\n   The values for status\
    \ codes MIPV6-ID-MISMATCH, MIPv6-AUTH-FAIL, and\n   MIPV6-MESG-ID-REQD, as defined\
    \ in Section 6 and Section 5.3, have\n   been assigned.  The values are 144 for\
    \ MIPV6-ID-MISMATCH 145 for\n   MIPV6-MESG-ID-REQD and 146 for MIPV6-AUTH-FAIL.\n\
    \   A new section for enumerating algorithms identified by specific\n   mobility\
    \ SPIs within the range 0-255 has to be added to\n   http://www.iana.org/assignments/mobility-parameters\n\
    \   The currently defined values are as follows:\n   The value 0 should not be\
    \ assigned.\n   The value 3 is reserved for HMAC_SHA1_SPI as defined in Section\
    \ 5.2.\n   The value 5 is reserved for use by 3GPP2.\n   New values for this namespace\
    \ can be allocated using IETF Consensus.\n   [RFC2434].\n   In addition, IANA\
    \ has created a new namespace for the Subtype field\n   of the MN-HA and MN-AAA\
    \ mobility message authentication options under\n   http://www.iana.org/assignments/mobility-parameters\n\
    \   The currently allocated values are as follows:\n   1 MN-HA mobility message\
    \ authentication option Section 5.1\n   2 MN-AAA mobility message authentication\
    \ option Section 5.2\n   New values for this namespace can be allocated using\
    \ IETF Consensus.\n   [RFC2434].\n"
- title: 9.  Acknowledgements
  contents:
  - "9.  Acknowledgements\n   The authors would like to thank Basavaraj Patil, Charlie\
    \ Perkins,\n   Vijay Devarapalli, Jari Arkko, and Gopal Dommety, and Avi Lior\
    \ for\n   their thorough review and suggestions on the document.  The authors\n\
    \   would like to acknowledge the fact that a similar authentication\n   method\
    \ was considered in base protocol [RFC3775] at one time.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC4283]   Patel, A., Leung, K., Khalil, M.,\
    \ Akhtar, H., and K.\n               Chowdhury, \"Mobile Node Identifier Option\
    \ for Mobile\n               IPv6\", RFC 4283, November 2005.\n   [RFC1305]  \
    \ Mills, D., \"Network Time Protocol (Version 3)\n               Specification,\
    \ Implementation\", RFC 1305, March 1992.\n   [RFC2434]   Narten, T. and H. Alvestrand,\
    \ \"Guidelines for Writing an\n               IANA Considerations Section in RFCs\"\
    , BCP 26, RFC 2434,\n               October 1998.\n   [RFC3344]   Perkins, C.,\
    \ \"IP Mobility Support for IPv4\", RFC 3344,\n               August 2002.\n \
    \  [RFC3775]   Johnson, D., Perkins, C., and J. Arkko, \"Mobility Support\n  \
    \             in IPv6\", RFC 3775, June 2004.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [3GPP2]     \"cdma2000 Wireless IP Network\
    \ Standard\", 3GPP2 X.S0011-D,\n               September 2005.\n   [RFC4306] \
    \  Kaufman, C., Ed., \"Internet Key Exchange (IKEv2)\n               Protocol\"\
    , RFC 4306, December 2005.\n"
- title: Appendix A.  Rationale for Mobility Message Replay Protection Option
  contents:
  - "Appendix A.  Rationale for Mobility Message Replay Protection Option\n   Mobile\
    \ IPv6 [RFC3775] defines a Sequence Number in the mobility\n   header to prevent\
    \ replay attacks.  There are two aspects that stand\n   out in regards to using\
    \ the Sequence Number to prevent replay\n   attacks.\n   First, the specification\
    \ states that the Home Agent should accept a\n   BU with a Sequence Number greater\
    \ than the Sequence Number from the\n   previous Binding Update.  This implicitly\
    \ assumes that the Home Agent\n   has some information regarding the Sequence\
    \ Number from the previous\n   BU (even when the binding cache entry is not present).\
    \  Second, the\n   specification states that if the Home Agent has no binding\
    \ cache\n   entry for the indicated home address, it MUST accept any Sequence\n\
    \   Number value in a received Binding Update from this Mobile Node.\n   With\
    \ the mechanism defined in this document, it is possible for the\n   Mobile Node\
    \ to register with a different Home Agent during each\n   mobility session.  Thus,\
    \ it is unreasonable to expect each Home Agent\n   in the network to maintain\
    \ state about the Mobile Node.  Also, if the\n   Home Agent does not cache information\
    \ regarding sequence number, as\n   per the second point above, a replayed BU\
    \ can cause a Home Agent to\n   create a binding cache entry for the Mobile Node.\
    \  Thus, when\n   authentication option is used, Sequence Number does not provide\n\
    \   protection against replay attack.\n   One solution to this problem (when the\
    \ Home Agent does not save state\n   information for every Mobile Node) would\
    \ be for the Home Agent to\n   reject the first BU and assign a (randomly generated)\
    \ starting\n   sequence number for the session and force the Mobile Node to send\
    \ a\n   fresh BU with the suggested sequence number.  While this would work\n\
    \   in most cases, it would require an additional round trip, and this\n   extra\
    \ signaling and latency is not acceptable in certain deployments\n   [3GPP2].\
    \  Also, this rejection and using sequence number as a nonce\n   in rejection\
    \ is a new behavior that is not specified in [RFC3775].\n   Thus, this specification\
    \ uses the mobility message replay protection\n   option to prevent replay attacks.\
    \  Specifically, timestamps are used\n   to prevent replay attacks as described\
    \ in Section 6.\n   It is important to note that as per Mobile IPv6 [RFC3775]\
    \ this\n   problem with sequence number exists.  Since the base specification\n\
    \   mandates the use of IPsec (and naturally that goes with IKE in most\n   cases),\
    \ the real replay protection is provided by IPsec/IKE.  In case\n   of BU/BA between\
    \ Mobile Node and Client Node (CN), the liveness proof\n   is provided by the\
    \ use of nonces that the CN generates.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Alpesh Patel\n   Cisco Systems\n   170 W. Tasman Drive\n\
    \   San Jose, CA  95134\n   US\n   Phone: +1 408-853-9580\n   EMail: alpesh@cisco.com\n\
    \   Kent Leung\n   Cisco Systems\n   170 W. Tasman Drive\n   San Jose, CA  95134\n\
    \   US\n   Phone: +1 408-526-5030\n   EMail: kleung@cisco.com\n   Mohamed Khalil\n\
    \   Nortel Networks\n   2221 Lakeside Blvd.\n   Richardson, TX  75082\n   US\n\
    \   Phone: +1 972-685-0574\n   EMail: mkhalil@nortel.com\n   Haseeb Akhtar\n \
    \  Nortel Networks\n   2221 Lakeside Blvd.\n   Richardson, TX  75082\n   US\n\
    \   Phone: +1 972-684-4732\n   EMail: haseebak@nortel.com\n   Kuntal Chowdhury\n\
    \   Starent Networks\n   30 International Place\n   Tewksbury, MA  01876\n   US\n\
    \   Phone: +1 214 550 1416\n   EMail: kchowdhury@starentnetworks.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
