- title: __initial_text__
  contents:
  - "                 Registration Extensions for IPv6 over\n Low-Power Wireless Personal\
    \ Area Network (6LoWPAN) Neighbor Discovery\n"
- title: Abstract
  contents:
  - "Abstract\n   This specification updates RFC 6775 -- the Low-Power Wireless\n\
    \   Personal Area Network (6LoWPAN) Neighbor Discovery specification --\n   to\
    \ clarify the role of the protocol as a registration technique and\n   simplify\
    \ the registration operation in 6LoWPAN routers, as well as to\n   provide enhancements\
    \ to the registration capabilities and mobility\n   detection for different network\
    \ topologies, including the Routing\n   Registrars performing routing for host\
    \ routes and/or proxy Neighbor\n   Discovery in a low-power network.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 7841.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   https://www.rfc-editor.org/info/rfc8505.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2018 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \    2.1. Requirements Language ......................................4\n    \
    \  2.2. Related Documents ..........................................4\n      2.3.\
    \ Abbreviations ..............................................4\n      2.4. New\
    \ Terms ..................................................6\n   3. Applicability\
    \ of Address Registration Options ...................7\n   4. Extended Neighbor\
    \ Discovery Options and Messages ................8\n      4.1. Extended Address\
    \ Registration Option (EARO) ................8\n      4.2. Extended Duplicate\
    \ Address Message Formats ................12\n      4.3. Extensions to the Capability\
    \ Indication Option ............13\n   5. Updating RFC 6775 ..............................................14\n\
    \      5.1. Extending the Address Registration Option .................16\n  \
    \    5.2. Transaction ID ............................................17\n    \
    \       5.2.1. Comparing TID Values ...............................17\n      5.3.\
    \ Registration Ownership Verifier (ROVR) ....................19\n      5.4. Extended\
    \ Duplicate Address Messages .......................20\n      5.5. Registering\
    \ the Target Address ............................20\n      5.6. Link-Local Addresses\
    \ and Registration .....................21\n      5.7. Maintaining the Registration\
    \ States .......................22\n   6. Backward Compatibility .........................................24\n\
    \      6.1. Signaling EARO Support ....................................25\n  \
    \    6.2. RFC 6775-Only 6LN .........................................25\n    \
    \  6.3. RFC 6775-Only 6LR .........................................25\n      6.4.\
    \ RFC 6775-Only 6LBR ........................................26\n   7. Security\
    \ Considerations ........................................26\n   8. Privacy Considerations\
    \ .........................................28\n   9. IANA Considerations ............................................29\n\
    \      9.1. Address Registration Option Flags .........................29\n  \
    \    9.2. Address Registration Option I-Field .......................29\n    \
    \  9.3. ICMP Codes ................................................30\n      9.4.\
    \ New ARO Status Values .....................................31\n      9.5. New\
    \ 6LoWPAN Capability Bits ...............................32\n   10. References\
    \ ....................................................32\n      10.1. Normative\
    \ References .....................................32\n      10.2. Informative\
    \ References ...................................34\n   Appendix A. Applicability\
    \ and Fulfilled Requirements\n               (Not Normative) .......................................38\n\
    \   Appendix B. Requirements (Not Normative) ..........................39\n  \
    \   B.1. Requirements Related to Mobility ...........................39\n    \
    \ B.2. Requirements Related to Routing Protocols ..................40\n     B.3.\
    \ Requirements Related to Various Low-Power Link Types .......41\n     B.4. Requirements\
    \ Related to Proxy Operations ...................42\n     B.5. Requirements Related\
    \ to Security ...........................42\n     B.6. Requirements Related to\
    \ Scalability ........................44\n     B.7. Requirements Related to Operations\
    \ and Management ..........44\n     B.8. Matching Requirements with Specifications\
    \ ..................45\n   Acknowledgments ...................................................47\n\
    \   Authors' Addresses ................................................47\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   IPv6 Low-Power and Lossy Networks (LLNs) support star and\
    \ mesh\n   topologies.  For such networks, \"Neighbor Discovery Optimization for\n\
    \   IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)\"\n   [RFC6775]\
    \ (also referred to as \"6LoWPAN Neighbor Discovery (ND)\")\n   defines a registration\
    \ mechanism and a central IPv6 ND Registrar to\n   ensure unique addresses.  The\
    \ 6LoWPAN ND mechanism reduces the\n   dependency of the IPv6 ND protocol [RFC4861]\
    \ [RFC4862] on\n   network-layer multicast and link-layer broadcast operations.\n\
    \   This specification updates 6LoWPAN ND [RFC6775] to simplify and\n   generalize\
    \ registration in 6LoWPAN Routers (6LRs).  In particular,\n   this specification\
    \ modifies and extends the behavior and protocol\n   elements of 6LoWPAN ND to\
    \ enable the following actions:\n   o  Determining the most recent location in\
    \ the case of node mobility\n   o  Simplifying the registration flow for Link-Local\
    \ Addresses\n   o  Support for a routing-unaware leaf node in a route-over network\n\
    \   o  Proxy registration in a route-over network\n   o  Enabling verification\
    \ for the registration, using the Registration\n      Ownership Verifier (ROVR)\
    \ (Section 5.3)\n   o  Registration to an IPv6 ND proxy (e.g., a Routing Registrar)\n\
    \   o  Better support for privacy and temporary addresses\n   These features satisfy\
    \ the requirements listed in Appendix B.\n"
- title: 2.  Terminology
  contents:
  - '2.  Terminology

    '
- title: 2.1.  Requirements Language
  contents:
  - "2.1.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted\
    \ as described in\n   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear\
    \ in all\n   capitals, as shown here.\n"
- title: 2.2.  Related Documents
  contents:
  - "2.2.  Related Documents\n   In this document, readers will encounter terms and\
    \ concepts that are\n   discussed in the following documents:\n   o  \"Neighbor\
    \ Discovery for IP version 6 (IPv6)\" [RFC4861]\n   o  \"IPv6 Stateless Address\
    \ Autoconfiguration\" [RFC4862]\n   o  \"IPv6 over Low-Power Wireless Personal\
    \ Area Networks (6LoWPANs):\n      Overview, Assumptions, Problem Statement, and\
    \ Goals\" [RFC4919]\n   o  \"Problem Statement and Requirements for IPv6 over\
    \ Low-Power\n      Wireless Personal Area Network (6LoWPAN) Routing\" [RFC6606]\n\
    \   o  \"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless\n  \
    \    Personal Area Networks (6LoWPANs)\" [RFC6775]\n"
- title: 2.3.  Abbreviations
  contents:
  - "2.3.  Abbreviations\n   This document uses the following abbreviations:\n   6BBR:\
    \ 6LoWPAN Backbone Router\n   6CIO: Capability Indication Option\n   6LBR: 6LoWPAN\
    \ Border Router\n   6LN:  6LoWPAN Node\n   6LoWPAN:  IPv6 over Low-Power Wireless\
    \ Personal Area Network\n   6LR:  6LoWPAN Router\n   ARO:  Address Registration\
    \ Option\n   DAC:  Duplicate Address Confirmation\n   DAD:  Duplicate Address\
    \ Detection\n   DAR:  Duplicate Address Request\n   DODAG:  Destination-Oriented\
    \ Directed Acyclic Graph\n   EARO: Extended Address Registration Option\n   EDA:\
    \  Extended Duplicate Address\n   EDAC: Extended Duplicate Address Confirmation\n\
    \   EDAR: Extended Duplicate Address Request\n   LLN:  Low-Power and Lossy Network\n\
    \   NA:   Neighbor Advertisement\n   NCE:  Neighbor Cache Entry\n   ND:   Neighbor\
    \ Discovery\n   NS:   Neighbor Solicitation\n   RA:   Router Advertisement\n \
    \  ROVR: Registration Ownership Verifier (pronounced \"rover\")\n   RPL:  IPv6\
    \ Routing Protocol for LLNs (pronounced \"ripple\") [RFC6550]\n   RS:   Router\
    \ Solicitation\n   TID:  Transaction ID (a sequence counter in the EARO)\n"
- title: 2.4.  New Terms
  contents:
  - "2.4.  New Terms\n   Backbone Link:  An IPv6 transit link that interconnects two\
    \ or more\n         Backbone Routers.\n   Binding:  The association between an\
    \ IP address, a Media Access\n         Control (MAC) address, and other information\
    \ about the node\n         that owns the IP address.\n   Registration:  The process\
    \ by which a 6LN registers an IPv6 Address\n         with a 6LR in order to establish\
    \ connectivity to the LLN.\n   Registered Node:  The 6LN for which the registration\
    \ is performed,\n         according to the fields in the EARO.\n   Registering\
    \ Node:  The node that performs the registration.  Either\n         the Registered\
    \ Node or a proxy.\n   IPv6 ND Registrar:  A node that can process a registration\
    \ in either\n         NS(EARO) or EDAR messages and consequently respond with\
    \ an NA\n         or EDAC message containing the EARO and appropriate status for\n\
    \         the registration.\n   Registered Address:  An address registered for\
    \ the Registered Node.\n   RFC 6775-only:  An implementation, a type of node,\
    \ or a message that\n         behaves only as specified by [RFC6775], as opposed\
    \ to the\n         behavior specified in this document.\n   Route-over network:\
    \  A network for which connectivity is provided at\n         the IP layer.\n \
    \  Routing Registrar:  An IPv6 ND Registrar that also provides\n         reachability\
    \ services for the Registered Address, including DAD\n         and proxy NA.\n\
    \   Backbone Router (6BBR):  A Routing Registrar that proxies the 6LoWPAN\n  \
    \       ND operations specified in this document to ensure that\n         multiple\
    \ LLNs federated by a Backbone Link operate as a single\n         IPv6 subnetwork.\n\
    \   updated:  A 6LN, 6LR, or 6LBR that supports this specification, in\n     \
    \    contrast to an RFC 6775-only device.\n"
- title: 3.  Applicability of Address Registration Options
  contents:
  - "3.  Applicability of Address Registration Options\n   The ARO as described in\
    \ [RFC6775] facilitates DAD for hosts and\n   populates NCEs [RFC4861] in the\
    \ routers.  This reduces the reliance\n   on multicast operations, which are often\
    \ as intrusive as broadcast,\n   in IPv6 ND operations (see [Multicast-over-IEEE802-Wireless]).\n\
    \   This document specifies new status codes for registrations rejected\n   by\
    \ a 6LR or 6LBR for reasons other than address duplication.\n   Examples include:\n\
    \   o  the router running out of space.\n   o  a registration bearing a stale\
    \ sequence number.  This could happen\n      if the host moves after the registration\
    \ was placed.\n   o  a host misbehaving and attempting to register an invalid\
    \ address,\n      such as the unspecified address as defined in [RFC4291].\n \
    \  o  a host using an address that is not topologically correct on\n      that\
    \ link.\n   In such cases, the host will receive an error that will help diagnose\n\
    \   the issue; the host may retry -- possibly with a different address or\n  \
    \ possibly registering to a different router -- depending on the\n   returned\
    \ error.  The ability to return errors to address\n   registrations is not intended\
    \ to be used to restrict the ability of\n   hosts to form and use multiple addresses.\
    \  Each host may form and\n   register a number of addresses for enhanced privacy,\
    \ using mechanisms\n   such as those described in [RFC4941] (\"Privacy Extensions\
    \ for\n   Stateless Address Autoconfiguration in IPv6\"), e.g., Stateless\n  \
    \ Address Autoconfiguration (SLAAC), and SHOULD conform to [RFC7934]\n   (\"Host\
    \ Address Availability Recommendations\").\n   As indicated in IPv6 ND [RFC4861],\
    \ a router needs enough storage to\n   hold NCEs for all directly connected addresses\
    \ to which it is\n   currently forwarding packets (unused entries may be flushed).\
    \  In\n   contrast, a router serving the address-registration mechanism needs\n\
    \   enough storage to hold NCEs for all the addresses that may be\n   registered\
    \ to it, regardless of whether or not they are actively\n   communicating.  The\
    \ number of registrations supported by a 6LR or\n   6LBR MUST be clearly documented\
    \ by the vendor, and the dynamic use of\n   associated resources SHOULD be made\
    \ available to the network\n   operator, e.g., to a management console.  Network\
    \ administrators need\n   to ensure that 6LRs/6LBRs in their network support the\
    \ number and\n   types of devices that can register to them, based on the number\
    \ of\n   IPv6 Addresses that those devices require, as well as their address\n\
    \   renewal rate and behavior.\n"
- title: 4.  Extended Neighbor Discovery Options and Messages
  contents:
  - "4.  Extended Neighbor Discovery Options and Messages\n   This specification does\
    \ not introduce any new options; it modifies\n   existing options and updates\
    \ the associated behaviors.\n"
- title: 4.1.  Extended Address Registration Option (EARO)
  contents:
  - "4.1.  Extended Address Registration Option (EARO)\n   The ARO is defined in Section\
    \ 4.1 of [RFC6775].\n   This specification introduces the EARO; the EARO is based\
    \ on the ARO\n   for use in NS and NA messages.  The EARO includes a sequence\
    \ counter\n   called the Transaction ID (TID), which is used to determine the\n\
    \   latest location of a registering mobile device.  A new T flag\n   indicates\
    \ that the presence of the TID field is populated and that\n   the option is an\
    \ EARO.  A 6LN requests routing or proxy services from\n   a 6LR using a new R\
    \ flag in the EARO.\n   The EUI-64 field is redefined and renamed \"ROVR field\"\
    \ in order to\n   carry different types of information, e.g., cryptographic information\n\
    \   of variable size (see Section 5.3).  A larger ROVR size MAY be used\n   if\
    \ and only if backward compatibility is not an issue in the\n   particular LLN.\
    \  The length of the ROVR field, expressed in units of\n   8 bytes, is the Length\
    \ value of the option minus 1.  A larger ROVR\n   size MAY be used if and only\
    \ if backward compatibility is not an\n   issue in the particular LLN.\n   Section\
    \ 5.1 discusses those changes in depth.\n   The format of the EARO is shown in\
    \ Figure 1:\n      0                   1                   2                 \
    \  3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \ |     Type      |     Length    |    Status     |    Opaque     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |  Rsvd | I |R|T|     TID       |     Registration Lifetime     |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                                                             |\n    ...     \
    \       Registration Ownership Verifier (ROVR)           ...\n     |         \
    \                                                      |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                           Figure 1: EARO Format\n   Option Fields:\n   Type:\
    \       33\n   Length:     8-bit unsigned integer.  The length of the option in\n\
    \               units of 8 bytes.\n   Status:     8-bit unsigned integer.  Indicates\
    \ the status of a\n               registration in the NA response.  MUST be set\
    \ to 0 in NS\n               messages.  See Table 1 below.\n   Opaque:     An\
    \ octet opaque to ND.  The 6LN MAY pass it transparently\n               to another\
    \ process.  It MUST be set to 0 when not used.\n   Rsvd (Reserved):\n        \
    \       This field is unused.  It MUST be initialized to 0 by the\n          \
    \     sender and MUST be ignored by the receiver.\n   I:          2-bit integer.\
    \  A value of 0 indicates that the Opaque\n               field carries an abstract\
    \ index that is used to decide in\n               which routing topology the address\
    \ is expected to be\n               injected.  In that case, the Opaque field\
    \ is passed to a\n               routing process with the indication that it carries\n\
    \               topology information, and the value of 0 indicates\n         \
    \      default.  All other values of \"I\" are reserved and\n               MUST\
    \ NOT be used.\n   R:          The Registering Node sets the R flag to request\n\
    \               reachability services for the Registered Address from a\n    \
    \           Routing Registrar.\n   T:          1-bit flag.  Set if the next octet\
    \ is used as a TID.\n   TID:        1-byte unsigned integer.  A Transaction ID\
    \ that is\n               maintained by the node and incremented with each\n \
    \              transaction of one or more registrations performed at the\n   \
    \            same time to one or more 6LRs.  This field MUST be\n            \
    \   ignored if the T flag is not set.\n   Registration Lifetime:\n           \
    \    16-bit integer, expressed in minutes.  A value of 0\n               indicates\
    \ that the registration has ended and that the\n               associated state\
    \ MUST be removed.\n   Registration Ownership Verifier (ROVR):\n             \
    \  Enables the correlation between multiple attempts to\n               register\
    \ the same IPv6 Address.  The ROVR size MUST be\n               64 bits when backward\
    \ compatibility is needed; otherwise,\n               the size MAY be 128, 192,\
    \ or 256 bits.\n   +-------+-----------------------------------------------------------+\n\
    \   | Value | Description                                               |\n  \
    \ +-------+-----------------------------------------------------------+\n   |\
    \  0-2  | As defined in [RFC6775].  Note: A Status value of 1       |\n   |  \
    \     | (\"Duplicate Address\") applies to the Registered Address.  |\n   |  \
    \     | If the Source Address conflicts with an existing          |\n   |    \
    \   | registration, \"Duplicate Source Address\" MUST be used.    |\n   |    \
    \   |                                                           |\n   |   3  \
    \ | Moved: The registration failed because it is not the most |\n   |       |\
    \ recent.  This Status indicates that the registration is   |\n   |       | rejected\
    \ because another more recent registration was     |\n   |       | done, as indicated\
    \ by the same ROVR and a more recent     |\n   |       | TID.  One possible cause\
    \ is a stale registration that has |\n   |       | progressed slowly in the network\
    \ and was passed by a more |\n   |       | recent one.  It could also indicate\
    \ a ROVR collision.     |\n   |       |                                      \
    \                     |\n   |   4   | Removed: The binding state was removed.\
    \  This Status MAY  |\n   |       | be placed in an NA(EARO) message that is sent\
    \ as the      |\n   |       | rejection of a proxy registration to an IPv6 ND\
    \           |\n   |       | Registrar, or in an asynchronous NA(EARO), at any\
    \ time.   |\n   |       |                                                    \
    \       |\n   |   5   | Validation Requested: The Registering Node is challenged\
    \  |\n   |       | for owning the Registered Address or for being an         |\n\
    \   |       | acceptable proxy for the registration.  An IPv6 ND        |\n  \
    \ |       | Registrar MAY place this Status in asynchronous DAC or NA |\n   |\
    \       | messages.                                                 |\n   |  \
    \     |                                                           |\n   |   6\
    \   | Duplicate Source Address: The address used as the source  |\n   |      \
    \ | of the NS(EARO) conflicts with an existing registration.  |\n   |       |\
    \                                                           |\n   |   7   | Invalid\
    \ Source Address: The address used as the source of |\n   |       | the NS(EARO)\
    \ is not a Link-Local Address.                 |\n   |       |               \
    \                                            |\n   |   8   | Registered Address\
    \ Topologically Incorrect: The address   |\n   |       | being registered is not\
    \ usable on this link.              |\n   |       |                          \
    \                                 |\n   |   9   | 6LBR Registry Saturated: A new\
    \ registration cannot be     |\n   |       | accepted because the 6LBR Registry\
    \ is saturated.  Note:   |\n   |       | This code is used by 6LBRs instead of\
    \ Status 2 when       |\n   |       | responding to a Duplicate Address message\
    \ exchange and is |\n   |       | passed on to the Registering Node by the 6LR.\
    \             |\n   |       |                                                \
    \           |\n   |   10  | Validation Failed: The proof of ownership of the \
    \         |\n   |       | Registered Address is not correct.                 \
    \       |\n   +-------+-----------------------------------------------------------+\n\
    \                        Table 1: EARO Status Codes\n"
- title: 4.2.  Extended Duplicate Address Message Formats
  contents:
  - "4.2.  Extended Duplicate Address Message Formats\n   The DAR and DAC messages\
    \ share a common base format as defined in\n   Section 4.4 of [RFC6775].  Those\
    \ messages enable information from the\n   ARO to be transported over multiple\
    \ hops.  The DAR and DAC are\n   extended as shown in Figure 2:\n      0     \
    \              1                   2                   3\n      0 1 2 3 4 5 6\
    \ 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |CodePfx|CodeSfx|          Checksum             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \  Status     |     TID       |     Registration Lifetime     |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                                                               |\n    ...\
    \            Registration Ownership Verifier (ROVR)           ...\n     |    \
    \                                                           |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                                                               |\n    \
    \ +                                                               +\n     |  \
    \                                                             |\n     +      \
    \                 Registered Address                      +\n     |          \
    \                                                     |\n     +              \
    \                                                 +\n     |                  \
    \                                             |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \            Figure 2: Extended Duplicate Address Message Format\n   Modified\
    \ Message Fields:\n   Code:       The ICMP Code [RFC4443] for Duplicate Address\
    \ messages is\n               split into two 4-bit fields: the Code Prefix and\
    \ the Code\n               Suffix.  The Code Prefix MUST be set to 0 by the sender\n\
    \               and MUST be ignored by the receiver.  A non-null value of\n  \
    \             the Code Suffix indicates support for this specification.\n    \
    \           It MUST be set to 1 when operating in a backward-\n              \
    \ compatible mode, indicating a ROVR size of 64 bits.  It\n               MAY\
    \ be 2, 3, or 4, denoting a ROVR size of 128, 192, or\n               256 bits,\
    \ respectively.\n   TID:        1-byte integer.  Same definition and processing\
    \ as the\n               TID in the EARO as defined in Section 4.1.  This field\n\
    \               MUST be ignored if the ICMP Code is null.\n   Registration Ownership\
    \ Verifier (ROVR):\n               The size of the ROVR is known from the ICMP\
    \ Code Suffix.\n               This field has the same definition and processing\
    \ as the\n               ROVR in the EARO as defined in Section 4.1.\n"
- title: 4.3.  Extensions to the Capability Indication Option
  contents:
  - "4.3.  Extensions to the Capability Indication Option\n   This specification defines\
    \ five new capability bits for use in the\n   6CIO as defined by [RFC7400] (\"\
    6LoWPAN-GHC: Generic Header\n   Compression for IPv6 over Low-Power Wireless Personal\
    \ Area Networks\n   (6LoWPANs)\"), for use in IPv6 ND messages.  (The G flag is\
    \ defined in\n   Section 3.3 of [RFC7400].)\n   The D flag indicates that the\
    \ 6LBR supports EDAR and EDAC messages.\n   A 6LR that learns the D flag from\
    \ advertisements can then exchange\n   EDAR and EDAC messages with the 6LBR, and\
    \ it also sets the D flag as\n   well as the L flag in the 6CIO in its own advertisements.\
    \  In this\n   way, 6LNs will be able to prefer registration with a 6LR that can\n\
    \   make use of new 6LBR features.\n   The new L, B, and P flags indicate whether\
    \ a router is capable of\n   acting as a 6LR, 6LBR, or Routing Registrar (e.g.,\
    \ 6BBR) (or some\n   combination thereof), respectively.  These flags are not\
    \ mutually\n   exclusive; an updated node can advertise multiple collocated\n\
    \   functions.\n   The E flag indicates that the EARO can be used in a registration.\
    \  A\n   6LR that supports this specification MUST set the E flag.\n      0  \
    \                 1                   2                   3\n      0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |   Length = 1  |     Reserved      |D|L|B|P|E|G|\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                         Reserved                            |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 3: New Capability Bits in the 6CIO\n   Option Fields:\n\
    \   Type:  36\n   D: The 6LBR supports EDAR and EDAC messages.\n   L: The node\
    \ is a 6LR.\n   B: The node is a 6LBR.\n   P: The node is a Routing Registrar.\n\
    \   E: The node is an IPv6 ND Registrar; i.e., it supports registrations\n   \
    \   based on the EARO.\n"
- title: 5.  Updating RFC 6775
  contents:
  - "5.  Updating RFC 6775\n   The EARO (see Section 4.1) updates the ARO used within\
    \ NS and NA\n   messages between a 6LN and a 6LR.  The update enables a registration\n\
    \   to a Routing Registrar in order to obtain additional services, such\n   as\
    \ return routability to the Registered Address by such means as\n   routing and/or\
    \ proxy ND, as illustrated in Figure 4.\n                                 Routing\n\
    \                 6LN            Registrar\n                  |              \
    \  |\n                  |   NS(EARO)     |\n                  |--------------->|\n\
    \                  |                |\n                  |                | Inject/maintain\n\
    \                  |                | host route or\n                  |     \
    \           | IPv6 ND proxy state\n                  |                | <----------------->\n\
    \                  |   NA(EARO)     |\n                  |<---------------|\n\
    \                  |                |\n                     Figure 4: (Re-)Registration\
    \ Flow\n   Similarly, the EDAR and EDAC update the DAR and DAC messages so as\
    \ to\n   transport the new information between 6LRs and 6LBRs across an LLN\n\
    \   mesh.  The extensions to the ARO are the DAR and the DAC, as used in\n   the\
    \ Duplicate Address messages.  They convey the additional\n   information all\
    \ the way to the 6LBR.\n   In turn, the 6LBR may proxy the registration to obtain\
    \ reachability\n   services from a Routing Registrar such as a 6BBR, as illustrated\
    \ in\n   Figure 5.  This specification avoids the Duplicate Address message\n\
    \   flow for Link-Local Addresses in a route-over [RFC6606] topology (see\n  \
    \ Section 5.6).\n                                             Routing\n      6LN\
    \          6LR            6LBR      Registrar\n       |            |         \
    \     |            |\n       |<Link-local>|   <Routed>   |<Link-local>|\n    \
    \   |            |              |            |\n       |  NS(EARO)  |        \
    \      |            |\n       |----------->|              |            |\n   \
    \    |            | Extended DAR |            |\n       |            |------------->|\
    \            |\n       |            |              |  proxy     |\n       |  \
    \          |              |  NS(EARO)  |\n       |            |              |----------->|\n\
    \       |            |              |            | Inject/maintain\n       | \
    \           |              |            | host route or\n       |            |\
    \              |            | IPv6 ND proxy state\n       |            |     \
    \         |            | <----------------->\n       |            |          \
    \    |  proxy     |\n       |            |              |  NA(EARO)  |\n     \
    \  |            | Extended DAC |<-----------|\n       |            |<-------------|\
    \            |\n       |  NA(EARO)  |              |            |\n       |<-----------|\
    \              |            |\n       |            |              |          \
    \  |\n                     Figure 5: (Re-)Registration Flow\n   This specification\
    \ allows multiple registrations, including\n   registrations for privacy and temporary\
    \ addresses, and provides a\n   mechanism to help clean up stale registration\
    \ state as soon as\n   possible, e.g., after a movement (see Section 7).\n   Section\
    \ 5 of [RFC6775] specifies how a 6LN bootstraps an interface\n   and locates available\
    \ 6LRs.  A Registering Node SHOULD register to a\n   6LR that supports this specification\
    \ if one is found, as discussed in\n   Section 6.1, instead of registering to\
    \ an RFC 6775-only 6LR;\n   otherwise, the Registering Node operates in a backward-compatible\n\
    \   fashion when attaching to an RFC 6775-only 6LR.\n"
- title: 5.1.  Extending the Address Registration Option
  contents:
  - "5.1.  Extending the Address Registration Option\n   The EARO updates the ARO\
    \ and is backward compatible with the ARO if\n   and only if the Length value\
    \ of the option is set to 2.  The format\n   of the EARO is presented in Section\
    \ 4.1.  More details on backward\n   compatibility can be found in Section 6.\n\
    \   The NS message and the ARO are modified as follows:\n   o  The Target Address\
    \ field in the NS containing the EARO is now the\n      field that indicates the\
    \ address that is being registered, as\n      opposed to the Source Address field\
    \ in the NS as specified in\n      [RFC6775] (see Section 5.5).  This change enables\
    \ a 6LBR to send a\n      proxy registration for a 6LN's address to a Routing\
    \ Registrar and\n      in most cases also avoids the use of an address as the\
    \ Source\n      Address before it is registered.\n   o  The EUI-64 field in the\
    \ ARO is renamed \"Registration Ownership\n      Verifier (ROVR)\" and is not\
    \ required to be derived from a MAC\n      address (see Section 5.3).\n   o  The\
    \ option's Length value MAY be different than 2 and take a value\n      between\
    \ 3 and 5, in which case the EARO is not backward compatible\n      with an ARO.\
    \  The increase in size corresponds to a larger ROVR\n      field, so the size\
    \ of the ROVR is inferred from the option's\n      Length value.\n   o  A new\
    \ Opaque field is introduced to carry opaque information in\n      cases where\
    \ the registration is relayed to another process, e.g.,\n      to be advertised\
    \ by a routing protocol.  A new \"I\" field provides\n      a type for the opaque\
    \ information and indicates the other process\n      to which the 6LN passes the\
    \ opaque value.  A value of 0 for the\n      \"I\" field indicates topological\
    \ information to be passed to a\n      routing process if the registration is\
    \ redistributed.  In that\n      case, a value of 0 for the Opaque field (1) is\
    \ backward compatible\n      with the reserved fields that are overloaded and\
    \ (2) indicates\n      that the default topology is to be used.\n   o  This document\
    \ specifies a new flag in the EARO: the R flag.  If\n      the R flag is set,\
    \ the Registering Node requests that the 6LR\n      ensure reachability for the\
    \ Registered Address, e.g., by means of\n      routing or proxy ND.  Conversely,\
    \ when it is not set, the R flag\n      indicates that the Registering Node is\
    \ a router and that it will\n      advertise reachability to the Registered Address\
    \ via a routing\n      protocol (such as RPL [RFC6550]).\n   o  A node that supports\
    \ this specification MUST provide a TID field\n      in the EARO and set the T\
    \ flag to indicate the presence of the TID\n      (see Section 5.2).\n   o  Finally,\
    \ this specification introduces new status codes to help\n      diagnose the cause\
    \ of a registration failure (see Table 1).\n   When registering, a 6LN that acts\
    \ only as a host MUST set the R flag\n   to indicate that it is not a router and\
    \ that it will not handle its\n   own reachability.  A 6LR that manages its reachability\
    \ SHOULD NOT set\n   the R flag; if it does, routes towards this router may be\
    \ installed\n   on its behalf and may interfere with those it advertises.\n"
- title: 5.2.  Transaction ID
  contents:
  - "5.2.  Transaction ID\n   The TID is a sequence number that is incremented by\
    \ the 6LN with each\n   re-registration to a 6LR.  The TID is used to determine\
    \ the recency\n   of the registration request.  The network uses the most recent\
    \ TID to\n   determine the most recent known location(s) of a moving 6LN.  When\
    \ a\n   Registered Node is registered with multiple 6LRs in parallel, the\n  \
    \ same TID MUST be used.  This enables the 6LBRs and/or Routing\n   Registrars\
    \ to determine whether the registrations are identical and\n   to distinguish\
    \ that situation from a movement (for example, see\n   Section 5.7 and Appendix\
    \ A).\n"
- title: 5.2.1.  Comparing TID Values
  contents:
  - "5.2.1.  Comparing TID Values\n   The operation of the TID is fully compatible\
    \ with that of the RPL\n   Path Sequence counter as described in Section 7.2 of\
    \ [RFC6550]\n   (\"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks\"\
    ).\n   A TID is deemed to be more recent than another when its value is\n   greater\
    \ as determined by the operations detailed in this section.\n   The TID range\
    \ is subdivided in a \"lollipop\" fashion [Perlman83],\n   where the values from\
    \ 128 and greater are used as a linear sequence\n   to indicate a restart and\
    \ bootstrap the counter, and the values less\n   than or equal to 127 are used\
    \ as a circular sequence number space of\n   size 128 as mentioned in [RFC1982].\
    \  Consideration is given to the\n   mode of operation when transitioning from\
    \ the linear region to the\n   circular region.  Finally, when operating in the\
    \ circular region, if\n   sequence numbers are determined to be too far apart,\
    \ then they are\n   not comparable, as detailed below.\n   A window of comparison,\
    \ SEQUENCE_WINDOW = 16, is configured based on\n   a value of 2^N, where N is\
    \ defined to be 4 in this specification.\n   For a given sequence counter,\n \
    \  1.  Prior to use, the sequence counter SHOULD be initialized to an\n      \
    \ implementation-defined value of 128 or greater.  A recommended\n       value\
    \ is 240 (256 - SEQUENCE_WINDOW).\n   2.  When a sequence counter increment would\
    \ cause the sequence\n       counter to increment beyond its maximum value, the\
    \ sequence\n       counter MUST wrap back to 0.  When incrementing a sequence\n\
    \       counter greater than or equal to 128, the maximum value is 255.\n    \
    \   When incrementing a sequence counter less than 128, the maximum\n       value\
    \ is 127.\n   3.  When comparing two sequence counters, the following rules MUST\
    \ be\n       applied:\n       1.  When a first sequence counter A is in the interval\
    \ [128-255]\n           and a second sequence counter B is in the interval [0-127]:\n\
    \           1.  If (256 + B - A) is less than or equal to\n               SEQUENCE_WINDOW,\
    \ then B is greater than A, A is less than\n               B, and the two are\
    \ not equal.\n           2.  If (256 + B - A) is greater than SEQUENCE_WINDOW,\
    \ then A\n               is greater than B, B is less than A, and the two are\
    \ not\n               equal.\n           For example, if A is 240 and B is 5,\
    \ then (256 + 5 - 240) is\n           21.  21 is greater than SEQUENCE_WINDOW\
    \ (16); thus, 240 is\n           greater than 5.  As another example, if A is\
    \ 250 and B is 5,\n           then (256 + 5 - 250) is 11.  11 is less than SEQUENCE_WINDOW\n\
    \           (16); thus, 250 is less than 5.\n       2.  In the case where both\
    \ sequence counters to be compared are\n           less than or equal to 127,\
    \ and in the case where both\n           sequence counters to be compared are\
    \ greater than or equal\n           to 128:\n           1.  If the absolute magnitude\
    \ of difference between the two\n               sequence counters is less than\
    \ or equal to\n               SEQUENCE_WINDOW, then a comparison as described\
    \ in\n               [RFC1982] is used to determine the relationships\n      \
    \         \"greater than\", \"less than\", and \"equal\".\n           2.  If the\
    \ absolute magnitude of difference of the two\n               sequence counters\
    \ is greater than SEQUENCE_WINDOW, then a\n               desynchronization has\
    \ occurred and the two sequence\n               numbers are not comparable.\n\
    \   4.  If two sequence numbers are determined to be not comparable,\n       i.e.,\
    \ the results of the comparison are not defined, then a node\n       should give\
    \ precedence to the sequence number that was most\n       recently incremented.\
    \  Failing this, the node should select the\n       sequence number in order to\
    \ minimize the resulting changes to its\n       own state.\n"
- title: 5.3.  Registration Ownership Verifier (ROVR)
  contents:
  - "5.3.  Registration Ownership Verifier (ROVR)\n   The ROVR field replaces the\
    \ EUI-64 field of the ARO defined in\n   [RFC6775].  It is associated in the 6LR\
    \ and the 6LBR with the\n   registration state.  The ROVR can be a unique ID of\
    \ the Registering\n   Node, such as the EUI-64 address of an interface.  This\
    \ can also be a\n   token obtained with cryptographic methods that can be used\
    \ in\n   additional protocol exchanges to associate a cryptographic identity\n\
    \   (key) with this registration to ensure that only the owner can modify\n  \
    \ it later, if the proof of ownership of the ROVR can be obtained.  The\n   scope\
    \ of a ROVR is the registration of a particular IPv6 Address, and\n   it MUST\
    \ NOT be used to correlate registrations of different\n   addresses.\n   The ROVR\
    \ can be of different types; the type is signaled in the\n   message that carries\
    \ the new type.  For instance, the type can be a\n   cryptographic string and\
    \ can be used to prove the ownership of the\n   registration as specified in [AP-ND]\
    \ (\"Address Protected Neighbor\n   Discovery for Low-power and Lossy Networks\"\
    ).  In order to support\n   the flows related to the proof of ownership, this\
    \ specification\n   introduces new status codes \"Validation Requested\" and \"\
    Validation\n   Failed\" in the EARO.\n   Note regarding ROVR collisions: Different\
    \ techniques for forming the\n   ROVR will operate in different namespaces.  [RFC6775]\
    \ specifies the\n   use of EUI-64 addresses.  [AP-ND] specifies the generation\
    \ of\n   cryptographic tokens.  While collisions are not expected in the\n   EUI-64\
    \ namespace only, they may happen if [AP-ND] is implemented by\n   at least one\
    \ of the nodes.  An implementation that understands the\n   namespace MUST consider\
    \ that ROVRs from different namespaces are\n   different even if they have the\
    \ same value.  An RFC 6775-only 6LBR or\n   6LR will confuse the namespaces; this\
    \ slightly increases the risk of\n   a ROVR collision.  A ROVR collision has no\
    \ effect if the two\n   Registering Nodes register different addresses, since\
    \ the ROVR is\n   only significant within the context of one registration.  A\
    \ ROVR is\n   not expected to be unique to one registration, as this specification\n\
    \   allows a node to use the same ROVR to register multiple IPv6\n   Addresses.\
    \  This is why the ROVR MUST NOT be used as a key to\n   identify the Registering\
    \ Node or as an index to the registration.  It\n   is only used as a match to\
    \ ensure that the node that updates a\n   registration for an IPv6 Address is\
    \ the node that made the original\n   registration for that IPv6 Address.  Also,\
    \ when the ROVR is not an\n   EUI-64 address, then it MUST NOT be used as the\
    \ Interface Identifier\n   of the Registered Address.  This way, a registration\
    \ that uses that\n   ROVR will not collide with that of an IPv6 Address derived\
    \ from\n   EUI-64 and using the EUI-64 as the ROVR per [RFC6775].\n   The Registering\
    \ Node SHOULD store the ROVR, or enough information to\n   regenerate it, in persistent\
    \ memory.  If this is not done and an\n   event such as a reboot causes a loss\
    \ of state, re-registering the\n   same address could be impossible until (1)\
    \ the 6LRs and the 6LBR\n   time out the previous registration or (2) a management\
    \ action clears\n   the relevant state in the network.\n"
- title: 5.4.  Extended Duplicate Address Messages
  contents:
  - "5.4.  Extended Duplicate Address Messages\n   In order to map the new EARO content\
    \ in the EDA messages, a new TID\n   field is added to the EDAR and EDAC messages\
    \ as a replacement for the\n   Reserved field, and a non-null value of the ICMP\
    \ Code indicates\n   support for this specification.  The format of the EDAR and\
    \ EDAC\n   messages is presented in Section 4.2.\n   As with the EARO, the EDA\
    \ messages are backward compatible with the\n   RFC 6775-only versions, as long\
    \ as the ROVR field is 64 bits long.\n   Remarks concerning backward compatibility\
    \ for the protocol between\n   the 6LN and the 6LR apply similarly between a 6LR\
    \ and a 6LBR.\n"
- title: 5.5.  Registering the Target Address
  contents:
  - "5.5.  Registering the Target Address\n   An NS message with an EARO is a registration\
    \ if and only if it also\n   carries an SLLA Option (\"SLLAO\") [RFC6775] (\"\
    SLLA\" stands for \"Source\n   Link-Layer Address\").  The EARO can also be used\
    \ in NS and NA\n   messages between Routing Registrars to determine the distributed\n\
    \   registration state; in that case, it does not carry the SLLA Option\n   and\
    \ is not confused with a registration.\n   The Registering Node is the node that\
    \ performs the registration to\n   the Routing Registrar.  As also described in\
    \ [RFC6775], it may be the\n   Registered Node as well, in which case it registers\
    \ one of its own\n   addresses and indicates its own MAC address as the SLLA in\
    \ the\n   NS(EARO).\n   This specification adds the capability to proxy the registration\n\
    \   operation on behalf of a Registered Node that is reachable over an\n   LLN\
    \ mesh.  In that case, if the Registered Node is reachable from the\n   Routing\
    \ Registrar via a mesh-under configuration, the Registering\n   Node indicates\
    \ the MAC address of the Registered Node as the SLLA in\n   the NS(EARO).  If\
    \ the Registered Node is reachable over a route-over\n   configuration from the\
    \ Registering Node, the SLLA in the NS(ARO) is\n   that of the Registering Node.\
    \  This enables the Registering Node to\n   attract the packets from the Routing\
    \ Registrar and route them over\n   the LLN to the Registered Node.\n   In order\
    \ to enable the latter operation, this specification changes\n   the behavior\
    \ of the 6LN and the 6LR so that the Registered Address is\n   found in the Target\
    \ Address field of the NS and NA messages as\n   opposed to the Source Address\
    \ field.  With this convention, a TLLA\n   Option (Target Link-Layer Address Option,\
    \ or \"TLLAO\") indicates the\n   link-layer address of the 6LN that owns the\
    \ address.\n   A Registering Node (e.g., a 6LBR also acting as a RPL root) that\n\
    \   advertises reachability for the 6LN MUST place its own link-layer\n   address\
    \ in the SLLA Option of the registration NS(EARO) message.\n   This maintains\
    \ compatibility with RFC 6775-only 6LoWPAN ND.\n"
- title: 5.6.  Link-Local Addresses and Registration
  contents:
  - "5.6.  Link-Local Addresses and Registration\n   LLN nodes are often not wired\
    \ and may move.  There is no guarantee\n   that a Link-Local Address will remain\
    \ unique among a huge and\n   potentially variable set of neighboring nodes.\n\
    \   Compared to [RFC6775], this specification only requires that a\n   Link-Local\
    \ Address be unique from the perspective of the two nodes\n   that use it to communicate\
    \ (e.g., the 6LN and the 6LR in an NS/NA\n   exchange).  This simplifies the DAD\
    \ process in a route-over topology\n   for Link-Local Addresses by avoiding an\
    \ exchange of EDA messages\n   between the 6LR and a 6LBR for those addresses.\n\
    \   An exchange between two nodes using Link-Local Addresses implies that\n  \
    \ they are reachable over one hop.  A node MUST register a Link-Local\n   Address\
    \ to a 6LR in order to obtain further reachability by way of\n   that 6LR and,\
    \ in particular, to use the Link-Local Address as the\n   Source Address to register\
    \ other addresses, e.g., global addresses.\n   If there is no collision with a\
    \ previously registered address, then\n   the Link-Local Address is unique from\
    \ the standpoint of this 6LR and\n   the registration is not a duplicate.  Two\
    \ different 6LRs might claim\n   the same Link-Local Address but different link-layer\
    \ addresses.  In\n   that case, a 6LN MUST only interact with at most one of the\
    \ 6LRs.\n   The exchange of EDAR and EDAC messages between the 6LR and a 6LBR,\n\
    \   which ensures that an address is unique across the domain covered by\n   the\
    \ 6LBR, does not need to take place for Link-Local Addresses.\n   When sending\
    \ an NS(EARO) to a 6LR, a 6LN MUST use a Link-Local\n   Address as the Source\
    \ Address of the registration, whatever the type\n   of IPv6 Address that is being\
    \ registered.  That Link-Local Address\n   MUST be either an address that is already\
    \ registered to the 6LR or\n   the address that is being registered.\n   When\
    \ a 6LN starts up, it typically multicasts an RS and receives one\n   or more\
    \ unicast RA messages from 6LRs.  If the 6LR can process EARO\n   messages, then\
    \ it places a 6CIO in its RA message with the E flag set\n   as required in Section\
    \ 6.1.\n   When a Registering Node does not have an already-registered address,\n\
    \   it MUST register a Link-Local Address, using it as both the Source\n   Address\
    \ and the Target Address of an NS(EARO) message.  In that case,\n   it is RECOMMENDED\
    \ to use an address for which DAD is not required\n   (see [RFC6775]), e.g., derived\
    \ from a globally unique EUI-64 address;\n   using the SLLA Option in the NS is\
    \ consistent with existing ND\n   specifications such as [RFC4429] (\"Optimistic\
    \ Duplicate Address\n   Detection (DAD) for IPv6\").  The 6LN MAY then use that\
    \ address to\n   register one or more other addresses.\n   A 6LR that supports\
    \ this specification replies with an NA(EARO),\n   setting the appropriate status.\
    \  Since there is no exchange of EDAR\n   or EDAC messages for Link-Local Addresses,\
    \ the 6LR may answer\n   immediately to the registration of a Link-Local Address,\
    \ based solely\n   on its existing state and the SLLA Option that is placed in\
    \ the\n   NS(EARO) message as required in [RFC6775].\n   A node registers its\
    \ IPv6 Global Unicast Addresses (GUAs) to a 6LR in\n   order to establish global\
    \ reachability for these addresses via that\n   6LR.  When registering with an\
    \ updated 6LR, a Registering Node does\n   not use a GUA as the Source Address,\
    \ in contrast to a node that\n   complies with [RFC6775].  For non-Link-Local\
    \ Addresses, the exchange\n   of EDAR and EDAC messages MUST conform to [RFC6775],\
    \ but the extended\n   formats described in this specification for the DAR and\
    \ the DAC are\n   used to relay the extended information in the case of an EARO.\n"
- title: 5.7.  Maintaining the Registration States
  contents:
  - "5.7.  Maintaining the Registration States\n   This section discusses protocol\
    \ actions that involve the Registering\n   Node, the 6LR, and the 6LBR.  It must\
    \ be noted that the portion that\n   deals with a 6LBR only applies to those addresses\
    \ that are registered\n   to it; as discussed in Section 5.6, this is not the\
    \ case for\n   Link-Local Addresses.  The registration state includes all data\
    \ that\n   is stored in the router relative to that registration, in particular,\n\
    \   but not limited to, an NCE.  6LBRs and Routing Registrars may store\n   additional\
    \ registration information and use synchronization protocols\n   that are out\
    \ of scope for this document.\n   A 6LR cannot accept a new registration when\
    \ its registration storage\n   space is exhausted.  In that situation, the EARO\
    \ is returned in an NA\n   message with a status code of \"Neighbor Cache Full\"\
    \ (Status 2; see\n   [RFC6775] and Table 1), and the Registering Node may attempt\
    \ to\n   register to another 6LR.\n   If the registry in the 6LBR is full, then\
    \ the 6LBR cannot decide\n   whether a registration for a new address is a duplicate.\
    \  In that\n   case, the 6LBR replies to an EDAR message with an EDAC message\
    \ that\n   carries a new status code indicating \"6LBR Registry Saturated\"\n\
    \   (Table 1).  Note: This code is used by 6LBRs instead of \"Neighbor\n   Cache\
    \ Full\" when responding to a Duplicate Address message exchange\n   and is passed\
    \ on to the Registering Node by the 6LR.  There is no\n   point in the node retrying\
    \ this registration via another 6LR, since\n   the problem is network-wide.  The\
    \ node may abandon that address,\n   de-register other addresses first to make\
    \ room, or keep the address\n   \"tentative\" [RFC4861] and retry later.\n   A\
    \ node renews an existing registration by sending a new NS(EARO)\n   message for\
    \ the Registered Address, and the 6LR MUST report the new\n   registration to\
    \ the 6LBR.\n   A node that ceases to use an address SHOULD attempt to de-register\n\
    \   that address from all the 6LRs to which it has registered the\n   address.\
    \  This is achieved using an NS(EARO) message with a\n   Registration Lifetime\
    \ of 0.  If this is not done, the associated\n   state will remain in the network\
    \ until the current Registration\n   Lifetime expires; this may lead to a situation\
    \ where the 6LR\n   resources become saturated, even if they were correctly planned\
    \ to\n   start with.  The 6LR may then take defensive measures that may\n   prevent\
    \ this node or some other nodes from owning as many addresses\n   as they request\
    \ (see Section 7).\n   A node that moves away from a particular 6LR SHOULD attempt\
    \ to\n   de-register all of its addresses registered to that 6LR and register\n\
    \   to a new 6LR with an incremented TID.  When/if the node appears\n   elsewhere,\
    \ an asynchronous NA(EARO) or EDAC message with a status\n   code of \"Moved\"\
    \ SHOULD be used to clean up the state in the previous\n   location.  The \"Moved\"\
    \ status can be used by a Routing Registrar in\n   an NA(EARO) message to indicate\
    \ that the ownership of the proxy state\n   was transferred to another Routing\
    \ Registrar due to movement of the\n   device.  If the receiver of the message\
    \ has registration state\n   corresponding to the related address, it SHOULD propagate\
    \ the status\n   down the forwarding path to the Registered Node (e.g., reversing\
    \ an\n   existing RPL [RFC6550] path as prescribed in [Efficient-NPDAO]).\n  \
    \ Whether it could do so or not, the receiver MUST clean up said state.\n   Upon\
    \ receiving an NS(EARO) message with a Registration Lifetime of 0\n   and determining\
    \ that this EARO is the most recent for a given NCE\n   (see Section 5.2), a 6LR\
    \ cleans up its NCE.  If the address was\n   registered to the 6LBR, then the\
    \ 6LR MUST report to the 6LBR, through\n   a Duplicate Address exchange with the\
    \ 6LBR, indicating the null\n   Registration Lifetime and the latest TID that\
    \ this 6LR is aware of.\n   Upon receiving the EDAR message, the 6LBR determines\
    \ if this is the\n   most recent TID it has received for that particular registry\
    \ entry.\n   If so, then the EDAR is answered with an EDAC message bearing a\n\
    \   status code of 0 (\"Success\") [RFC6775], and the entry is scheduled to\n\
    \   be removed.  Otherwise, a status code of \"Moved\" is returned instead,\n\
    \   and the existing entry is maintained.\n   When an address is scheduled to\
    \ be removed, the 6LBR SHOULD keep its\n   NCE in a DELAY state [RFC4861] for\
    \ a configurable period of time, so\n   as to prevent a scenario where (1) a mobile\
    \ node that de-registered\n   from one 6LR did not yet register to a new one or\
    \ (2) the new\n   registration did not yet reach the 6LBR due to propagation delays\
    \ in\n   the network.  Once the DELAY time has passed, the 6LBR silently\n   removes\
    \ its entry.\n"
- title: 6.  Backward Compatibility
  contents:
  - "6.  Backward Compatibility\n   This specification changes the behavior of the\
    \ peers in a\n   registration flow.  To enable backward compatibility, a 6LN that\n\
    \   registers to a 6LR that is not known to support this specification\n   MUST\
    \ behave in a manner that is backward compatible with [RFC6775].\n   Conversely,\
    \ if the 6LR is found to support this specification, then\n   the 6LN MUST conform\
    \ to this specification when communicating with\n   that 6LR.\n   A 6LN that supports\
    \ this specification MUST always use an EARO as a\n   replacement for an ARO in\
    \ its registration to a router.  This\n   behavior is backward compatible, since\
    \ the T flag and TID field\n   occupy fields that are reserved in [RFC6775] and\
    \ are thus ignored by\n   an RFC 6775-only router.  A router that supports this\
    \ specification\n   MUST answer an NS(ARO) and an NS(EARO) with an NA(EARO). \
    \ A router\n   that does not support this specification will consider the ROVR\
    \ as an\n   EUI-64 address and treat it the same; this scenario has no\n   consequence\
    \ if the Registered Addresses are different.\n"
- title: 6.1.  Signaling EARO Support
  contents:
  - "6.1.  Signaling EARO Support\n   [RFC7400] specifies the 6CIO, which indicates\
    \ a node's capabilities\n   to the node's peers.  The 6CIO MUST be present in\
    \ both RS and RA\n   messages, unless the 6CIO information was already shared\
    \ in recent\n   exchanges or pre-configured in all nodes in a network.  In any\
    \ case,\n   a 6CIO MUST be placed in an RA message that is sent in response to\
    \ an\n   RS with a 6CIO.\n   Section 4.3 defines a new flag for the 6CIO to signal\
    \ EARO support by\n   the issuer of the message.  New flags are also added to\
    \ the 6CIO to\n   signal the sender's capability to act as a 6LR, 6LBR, and Routing\n\
    \   Registrar (see Section 4.3).\n   Section 4.3 also defines a new flag that\
    \ indicates the support of\n   EDAR and EDAC messages by the 6LBR.  This flag\
    \ is valid in RA\n   messages but not in RS messages.  More information on the\
    \ 6LBR is\n   found in a separate Authoritative Border Router Option (ABRO). \
    \ The\n   ABRO is placed in RA messages as prescribed by [RFC6775]; in\n   particular,\
    \ it MUST be placed in an RA message that is sent in\n   response to an RS with\
    \ a 6CIO indicating the capability to act as a\n   6LR, since the RA propagates\
    \ information between routers.\n"
- title: 6.2.  RFC 6775-Only 6LN
  contents:
  - "6.2.  RFC 6775-Only 6LN\n   An RFC 6775-only 6LN will use the Registered Address\
    \ as the Source\n   Address of the NS message and will not use an EARO.  An updated\
    \ 6LR\n   MUST accept that registration if it is valid per [RFC6775], and it\n\
    \   MUST manage the binding cache accordingly.  The updated 6LR MUST then\n  \
    \ use the RFC 6775-only DAR and DAC messages as specified in [RFC6775]\n   to\
    \ indicate to the 6LBR that the TID is not present in the messages.\n   The main\
    \ difference from [RFC6775] is that the exchange of DAR and\n   DAC messages for\
    \ the purpose of DAD is avoided for Link-Local\n   Addresses.  In any case, the\
    \ 6LR MUST use an EARO in the reply and\n   can use any of the status codes defined\
    \ in this specification.\n"
- title: 6.3.  RFC 6775-Only 6LR
  contents:
  - "6.3.  RFC 6775-Only 6LR\n   An updated 6LN discovers the capabilities of the\
    \ 6LR in the 6CIO in\n   RA messages from that 6LR; if the 6CIO was not present\
    \ in the RA,\n   then the 6LR is assumed to be RFC 6775-only.\n   An updated 6LN\
    \ MUST use an EARO in the request, regardless of the\n   type of 6LR -- RFC 6775-only\
    \ or updated; this implies that the T flag\n   is set.  It MUST use a ROVR of\
    \ 64 bits if the 6LR is RFC 6775-only.\n   If an updated 6LN moves from an updated\
    \ 6LR to an RFC 6775-only 6LR,\n   the RFC 6775-only 6LR will send an RFC 6775-only\
    \ DAR message, which\n   cannot be compared with an updated one for recency. \
    \ Allowing\n   RFC 6775-only DAR messages to update a state established by the\n\
    \   updated protocol in the 6LBR would be an attack vector; therefore,\n   this\
    \ cannot be the default behavior.  But if RFC 6775-only and\n   updated 6LRs coexist\
    \ temporarily in a network, then it makes sense\n   for an administrator to install\
    \ a policy that allows this behavior,\n   using some method that is out of scope\
    \ for this document.\n"
- title: 6.4.  RFC 6775-Only 6LBR
  contents:
  - "6.4.  RFC 6775-Only 6LBR\n   With this specification, the Duplicate Address messages\
    \ are extended\n   to transport the EARO information.  As with the NS/NA exchange,\
    \ an\n   updated 6LBR MUST always use the EDAR and EDAC messages.\n   Note that\
    \ an RFC 6775-only 6LBR will accept and process an EDAR\n   message as if it were\
    \ an RFC 6775-only DAR, as long as the ROVR is\n   64 bits long.  An updated 6LR\
    \ discovers the capabilities of the 6LBR\n   in the 6CIO in RA messages from the\
    \ 6LR; if the 6CIO was not present\n   in any RA, then the 6LBR is assumed to\
    \ be RFC 6775-only.\n   If the 6LBR is RFC 6775-only, the 6LR MUST use only the\
    \ 64 leftmost\n   bits of the ROVR and place the result in the EDAR message to\
    \ maintain\n   compatibility.  This way, the support of DAD is preserved.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   This specification extends [RFC6775], and the\
    \ Security Considerations\n   section of that document also applies to this document.\
    \  In\n   particular, the link layer SHOULD be sufficiently protected to\n   prevent\
    \ rogue access.\n   [RFC6775] does not protect the content of its messages and\
    \ expects\n   lower-layer encryption to defeat potential attacks.  This\n   specification\
    \ requires the LLN MAC layer to provide secure unicast\n   to/from a Routing Registrar\
    \ and secure broadcast or multicast from\n   the Routing Registrar in a way that\
    \ prevents tampering with or\n   replaying the ND messages.\n   This specification\
    \ recommends using privacy techniques (see\n   Section 8) and protecting against\
    \ address theft via methods that are\n   outside the scope of this document. \
    \ As an example, [AP-ND]\n   guarantees the ownership of the Registered Address\
    \ using a\n   cryptographic ROVR.\n   The registration mechanism may be used by\
    \ a rogue node to attack the\n   6LR or 6LBR with a denial-of-service attack against\
    \ the registry.  It\n   may also happen that the registry of a 6LR or 6LBR is\
    \ saturated and\n   cannot take any more registrations; this scenario effectively\
    \ denies\n   the requesting node the capability to use a new address.  In order\
    \ to\n   alleviate those concerns, (1) Section 5.2 provides a sequence counter\n\
    \   that keeps incrementing to detect and clean up stale registration\n   information\
    \ and that contributes to defeat replay attacks and\n   (2) Section 5.7 provides\
    \ a number of recommendations that ensure that\n   a stale registration is removed\
    \ as soon as possible from the 6LR\n   and 6LBR.\n   In particular, this specification\
    \ recommends that:\n   o  A node that ceases to use an address SHOULD attempt\
    \ to de-register\n      that address from all the 6LRs to which it is registered.\n\
    \   o  The registration lifetimes SHOULD be individually configurable for\n  \
    \    each address or group of addresses.  A node SHOULD be configured\n      for\
    \ each address (or address category) with a Registration\n      Lifetime that\
    \ reflects the expectation of how long it will use the\n      address with the\
    \ 6LR to which the address is registered.  In\n      particular, use cases that\
    \ involve mobility or rapid address\n      changes SHOULD use lifetimes that are\
    \ the same order of magnitude\n      as the duration of the expectation of presence\
    \ but that are still\n      longer.\n   o  The router (6LR or 6LBR) SHOULD be\
    \ configurable so as to limit the\n      number of addresses that can be registered\
    \ by a single node, but\n      as a protective measure only.  In any case, a router\
    \ MUST be able\n      to keep a minimum number of addresses per node.  That minimum\n\
    \      depends on the type of device and ranges between 3 for a very\n      constrained\
    \ LLN and 10 for a larger device.  A node may be\n      identified by its MAC\
    \ address, as long as it is not obfuscated by\n      privacy measures.  A stronger\
    \ identification (e.g., by security\n      credentials) is RECOMMENDED.  When\
    \ the maximum is reached, the\n      router SHOULD use a Least Recently Used (LRU)\
    \ algorithm to\n      clean up the addresses, keeping at least one Link-Local\
    \ Address.\n      The router SHOULD attempt to keep one or more stable addresses\
    \ if\n      stability can be determined, e.g., because they are used over a\n\
    \      much longer time span than other (privacy, shorter-lived)\n      addresses.\n\
    \   o  In order to avoid denial of registration due to a lack of\n      resources,\
    \ administrators should take great care to deploy\n      adequate numbers of 6LRs\
    \ to cover the needs of the nodes in their\n      range, so as to avoid a situation\
    \ of starving nodes.  It is\n      expected that the 6LBR that serves an LLN is\
    \ a more capable node\n      than the average 6LR, but in a network condition\
    \ where it may\n      become saturated, a particular LLN should distribute the\
    \ 6LBR\n      functionality -- for instance, by leveraging a high-speed Backbone\n\
    \      Link and Routing Registrars to aggregate multiple LLNs into a\n      larger\
    \ subnet.\n   The LLN nodes depend on a 6LBR and may use the services of a Routing\n\
    \   Registrar for their operation.  A trust model MUST be put in place to\n  \
    \ ensure that only authorized devices are acting in these roles, so as\n   to\
    \ avoid threats such as black-holing or bombing attack whereby an\n   impersonated\
    \ 6LBR would destroy state in the network by using the\n   \"Removed\" status\
    \ code.  At a minimum, this trust model could be based\n   on Layer 2 access control\
    \ or could provide role validation as well\n   (see Req-5.1 in Appendix B.5).\n"
- title: 8.  Privacy Considerations
  contents:
  - "8.  Privacy Considerations\n   As indicated in Section 3, this protocol does\
    \ not limit the number of\n   IPv6 Addresses that each device can form.  However,\
    \ to mitigate\n   denial-of-service attacks, it can be useful as a protective\
    \ measure\n   to have a limit that is high enough not to interfere with the normal\n\
    \   behavior of devices in the network.  A host should be able to form\n   and\
    \ register any address that is topologically correct in the\n   subnet(s) advertised\
    \ by the 6LR/6LBR.\n   This specification does not mandate any particular way\
    \ for forming\n   IPv6 Addresses, but it discourages using EUI-64 for forming\
    \ the\n   Interface Identifier in the Link-Local Address because this method\n\
    \   prevents the usage of Secure Neighbor Discovery (SEND) [RFC3971],\n   Cryptographically\
    \ Generated Addresses (CGAs) [RFC3972], and other\n   address privacy techniques.\n\
    \   [RFC8065] (\"Privacy Considerations for IPv6 Adaptation-Layer\n   Mechanisms\"\
    ) explains why privacy is important and how to form\n   privacy-aware addresses.\
    \  All implementations and deployments must\n   consider the option of privacy\
    \ addresses in their own environments.\n   The IPv6 Address of the 6LN in the\
    \ IPv6 header can be compressed\n   statelessly when the Interface Identifier\
    \ in the IPv6 Address can be\n   derived from the lower-layer address.  When it\
    \ is not critical to\n   benefit from that compression, e.g., the address can\
    \ be compressed\n   statefully, or it is rarely used and/or it is used only over\
    \ one hop,\n   privacy concerns should be considered.  In particular, new\n  \
    \ implementations should follow [RFC8064] (\"Recommendation on Stable\n   IPv6\
    \ Interface Identifiers\").  [RFC8064] recommends the mechanism\n   specified\
    \ in [RFC7217] (\"A Method for Generating Semantically Opaque\n   Interface Identifiers\
    \ with IPv6 Stateless Address Autoconfiguration\n   (SLAAC)\") for generating\
    \ Interface Identifiers to be used in SLAAC.\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   IANA has made a number of changes under the \"Internet\
    \ Control Message\n   Protocol version 6 (ICMPv6) Parameters\" registry, as follows.\n"
- title: 9.1.  Address Registration Option Flags
  contents:
  - "9.1.  Address Registration Option Flags\n   IANA has created a new subregistry\
    \ for \"Address Registration Option\n   Flags\" under the \"Internet Control Message\
    \ Protocol version 6\n   (ICMPv6) Parameters\" registry.  (See [RFC4443] for information\n\
    \   regarding ICMPv6.)\n   This specification defines eight positions -- bit 0\
    \ to bit 7 -- and\n   assigns bit 6 for the R flag and bit 7 for the T flag (see\n\
    \   Section 4.1).  The registration procedure is \"IETF Review\" or \"IESG\n \
    \  Approval\" (see [RFC8126]).\n   The initial contents of the registry are shown\
    \ in Table 2.\n                +-------------+--------------+------------+\n \
    \               |  ARO Status | Description  | Reference  |\n                +-------------+--------------+------------+\n\
    \                |     0-5     | Unassigned   |            |\n               \
    \ |             |              |            |\n                |      6      |\
    \ R Flag       | RFC 8505   |\n                |             |              |\
    \            |\n                |      7      | T Flag       | RFC 8505   |\n\
    \                +-------------+--------------+------------+\n              Table\
    \ 2: New Address Registration Option Flags\n"
- title: 9.2.  Address Registration Option I-Field
  contents:
  - "9.2.  Address Registration Option I-Field\n   IANA has created a new subregistry\
    \ for \"Address Registration Option\n   I-Field\" under the \"Internet Control\
    \ Message Protocol version 6\n   (ICMPv6) Parameters\" registry.\n   This specification\
    \ defines four integer values from 0 to 3 and\n   assigns value 0 to \"Abstract\
    \ Index for Topology Selection\" (see\n   Section 4.1).  The registration procedure\
    \ is \"IETF Review\" or \"IESG\n   Approval\" [RFC8126].\n   The initial contents\
    \ of the registry are shown in Table 3.\n      +--------+---------------------------------------+------------+\n\
    \      | Value  | Meaning                               | Reference  |\n     \
    \ +--------+---------------------------------------+------------+\n      | 0 \
    \     | Abstract Index for Topology Selection | RFC 8505   |\n      |        |\
    \                                       |            |\n      | 1-3    | Unassigned\
    \                            |            |\n      +--------+---------------------------------------+------------+\n\
    \               Table 3: New Subregistry for the EARO I-Field\n"
- title: 9.3.  ICMP Codes
  contents:
  - "9.3.  ICMP Codes\n   IANA has created two new subregistries of the 'ICMPv6 \"\
    Code\" Fields'\n   registry, which itself is a subregistry of ICMPv6 codes in\
    \ the\n   \"Internet Control Message Protocol version 6 (ICMPv6) Parameters\"\n\
    \   registry.\n   The new subregistries relate to ICMP Types 157 (Duplicate Address\n\
    \   Request) (shown in Table 4) and 158 (Duplicate Address Confirmation)\n   (shown\
    \ in Table 5), respectively.  For those two ICMP types, the ICMP\n   Code field\
    \ is split into two subfields: the Code Prefix and the Code\n   Suffix.  The new\
    \ subregistries relate to the Code Suffix portion of\n   the ICMP Code.  The range\
    \ of the Code Suffix is 0-15 in all cases.\n   The registration procedure is \"\
    IETF Review\" or \"IESG Approval\"\n   [RFC8126] for both subregistries.\n   The\
    \ initial contents of these subregistries are as follows:\n   +--------------+--------------------------------------+------------+\n\
    \   | Code Suffix  | Meaning                              | Reference  |\n   +--------------+--------------------------------------+------------+\n\
    \   | 0            | DAR message                          | RFC 6775   |\n   |\
    \              |                                      |            |\n   | 1 \
    \           | EDAR message with 64-bit ROVR field  | RFC 8505   |\n   |      \
    \        |                                      |            |\n   | 2       \
    \     | EDAR message with 128-bit ROVR field | RFC 8505   |\n   |            \
    \  |                                      |            |\n   | 3            |\
    \ EDAR message with 192-bit ROVR field | RFC 8505   |\n   |              |   \
    \                                   |            |\n   | 4            | EDAR message\
    \ with 256-bit ROVR field | RFC 8505   |\n   |              |                \
    \                      |            |\n   | 5-15         | Unassigned        \
    \                   |            |\n   +--------------+--------------------------------------+------------+\n\
    \           Table 4: Code Suffixes for ICMP Type 157 DAR Message\n   +--------------+--------------------------------------+------------+\n\
    \   | Code Suffix  | Meaning                              | Reference  |\n   +--------------+--------------------------------------+------------+\n\
    \   | 0            | DAC message                          | RFC 6775   |\n   |\
    \              |                                      |            |\n   | 1 \
    \           | EDAC message with 64-bit ROVR field  | RFC 8505   |\n   |      \
    \        |                                      |            |\n   | 2       \
    \     | EDAC message with 128-bit ROVR field | RFC 8505   |\n   |            \
    \  |                                      |            |\n   | 3            |\
    \ EDAC message with 192-bit ROVR field | RFC 8505   |\n   |              |   \
    \                                   |            |\n   | 4            | EDAC message\
    \ with 256-bit ROVR field | RFC 8505   |\n   |              |                \
    \                      |            |\n   | 5-15         | Unassigned        \
    \                   |            |\n   +--------------+--------------------------------------+------------+\n\
    \           Table 5: Code Suffixes for ICMP Type 158 DAC Message\n"
- title: 9.4.  New ARO Status Values
  contents:
  - "9.4.  New ARO Status Values\n   IANA has made additions to the \"Address Registration\
    \ Option Status\n   Values\" subregistry, as follows:\n    +-------+--------------------------------------------+------------+\n\
    \    | Value | Description                                | Reference  |\n   \
    \ +-------+--------------------------------------------+------------+\n    | \
    \  3   | Moved                                      | RFC 8505   |\n    |    \
    \   |                                            |            |\n    |   4   |\
    \ Removed                                    | RFC 8505   |\n    |       |   \
    \                                         |            |\n    |   5   | Validation\
    \ Requested                       | RFC 8505   |\n    |       |              \
    \                              |            |\n    |   6   | Duplicate Source\
    \ Address                   | RFC 8505   |\n    |       |                    \
    \                        |            |\n    |   7   | Invalid Source Address\
    \                     | RFC 8505   |\n    |       |                          \
    \                  |            |\n    |   8   | Registered Address Topologically\
    \ Incorrect | RFC 8505   |\n    |       |                                    \
    \        |            |\n    |   9   | 6LBR Registry Saturated               \
    \     | RFC 8505   |\n    |       |                                          \
    \  |            |\n    |   10  | Validation Failed                          |\
    \ RFC 8505   |\n    +-------+--------------------------------------------+------------+\n\
    \                      Table 6: New ARO Status Values\n"
- title: 9.5.  New 6LoWPAN Capability Bits
  contents:
  - "9.5.  New 6LoWPAN Capability Bits\n   IANA has made additions to the \"6LoWPAN\
    \ Capability Bits\" subregistry,\n   as follows:\n             +------+---------------------------+------------+\n\
    \             | Bit  | Description               | Reference  |\n            \
    \ +------+---------------------------+------------+\n             |  10  | EDA\
    \ Support (D bit)       | RFC 8505   |\n             |      |                \
    \           |            |\n             |  11  | 6LR capable (L bit)       |\
    \ RFC 8505   |\n             |      |                           |            |\n\
    \             |  12  | 6LBR capable (B bit)      | RFC 8505   |\n            \
    \ |      |                           |            |\n             |  13  | Routing\
    \ Registrar (P bit) | RFC 8505   |\n             |      |                    \
    \       |            |\n             |  14  | EARO support (E bit)      | RFC\
    \ 8505   |\n             +------+---------------------------+------------+\n \
    \                  Table 7: New 6LoWPAN Capability Bits\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n  \
    \            DOI 10.17487/RFC2119, March 1997,\n              <https://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC4291]  Hinden, R. and S. Deering, \"IP Version 6 Addressing\n        \
    \      Architecture\", RFC 4291, DOI 10.17487/RFC4291,\n              February\
    \ 2006, <https://www.rfc-editor.org/info/rfc4291>.\n   [RFC4443]  Conta, A., Deering,\
    \ S., and M. Gupta, Ed., \"Internet\n              Control Message Protocol (ICMPv6)\
    \ for the Internet\n              Protocol Version 6 (IPv6) Specification\", STD\
    \ 89,\n              RFC 4443, DOI 10.17487/RFC4443, March 2006,\n           \
    \   <https://www.rfc-editor.org/info/rfc4443>.\n   [RFC4861]  Narten, T., Nordmark,\
    \ E., Simpson, W., and H. Soliman,\n              \"Neighbor Discovery for IP\
    \ version 6 (IPv6)\", RFC 4861,\n              DOI 10.17487/RFC4861, September\
    \ 2007,\n              <https://www.rfc-editor.org/info/rfc4861>.\n   [RFC4862]\
    \  Thomson, S., Narten, T., and T. Jinmei, \"IPv6 Stateless\n              Address\
    \ Autoconfiguration\", RFC 4862,\n              DOI 10.17487/RFC4862, September\
    \ 2007,\n              <https://www.rfc-editor.org/info/rfc4862>.\n   [RFC4919]\
    \  Kushalnagar, N., Montenegro, G., and C. Schumacher, \"IPv6\n              over\
    \ Low-Power Wireless Personal Area Networks (6LoWPANs):\n              Overview,\
    \ Assumptions, Problem Statement, and Goals\",\n              RFC 4919, DOI 10.17487/RFC4919,\
    \ August 2007,\n              <https://www.rfc-editor.org/info/rfc4919>.\n   [RFC6282]\
    \  Hui, J., Ed. and P. Thubert, \"Compression Format for IPv6\n              Datagrams\
    \ over IEEE 802.15.4-Based Networks\", RFC 6282,\n              DOI 10.17487/RFC6282,\
    \ September 2011,\n              <https://www.rfc-editor.org/info/rfc6282>.\n\
    \   [RFC6606]  Kim, E., Kaspar, D., Gomez, C., and C. Bormann, \"Problem\n   \
    \           Statement and Requirements for IPv6 over Low-Power\n             \
    \ Wireless Personal Area Network (6LoWPAN) Routing\",\n              RFC 6606,\
    \ DOI 10.17487/RFC6606, May 2012,\n              <https://www.rfc-editor.org/info/rfc6606>.\n\
    \   [RFC6775]  Shelby, Z., Ed., Chakrabarti, S., Nordmark, E., and C.\n      \
    \        Bormann, \"Neighbor Discovery Optimization for IPv6 over\n          \
    \    Low-Power Wireless Personal Area Networks (6LoWPANs)\",\n              RFC\
    \ 6775, DOI 10.17487/RFC6775, November 2012,\n              <https://www.rfc-editor.org/info/rfc6775>.\n\
    \   [RFC7400]  Bormann, C., \"6LoWPAN-GHC: Generic Header Compression for\n  \
    \            IPv6 over Low-Power Wireless Personal Area Networks\n           \
    \   (6LoWPANs)\", RFC 7400, DOI 10.17487/RFC7400,\n              November 2014,\
    \ <https://www.rfc-editor.org/info/rfc7400>.\n   [RFC8126]  Cotton, M., Leiba,\
    \ B., and T. Narten, \"Guidelines for\n              Writing an IANA Considerations\
    \ Section in RFCs\", BCP 26,\n              RFC 8126, DOI 10.17487/RFC8126, June\
    \ 2017,\n              <https://www.rfc-editor.org/info/rfc8126>.\n   [RFC8174]\
    \  Leiba, B., \"Ambiguity of Uppercase vs Lowercase in\n              RFC 2119\
    \ Key Words\", BCP 14, RFC 8174,\n              DOI 10.17487/RFC8174, May 2017,\n\
    \              <https://www.rfc-editor.org/info/rfc8174>.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [Alternative-Ellip-Curve-Reps]\n          \
    \    Struik, R., \"Alternative Elliptic Curve Representations\",\n           \
    \   Work in Progress, draft-struik-lwip-curve-\n              representations-00,\
    \ October 2017.\n   [AP-ND]    Thubert, P., Ed., Sarikaya, B., Sethi, M., and\
    \ R. Struik,\n              \"Address Protected Neighbor Discovery for Low-power\
    \ and\n              Lossy Networks\", Work in Progress, draft-ietf-6lo-\n   \
    \           ap-nd-08, October 2018.\n   [Arch-for-6TiSCH]\n              Thubert,\
    \ P., Ed., \"An Architecture for IPv6 over the\n              TSCH mode of IEEE\
    \ 802.15.4\", Work in Progress,\n              draft-ietf-6tisch-architecture-17,\
    \ November 2018.\n   [Efficient-NPDAO]\n              Jadhav, R., Ed., Thubert,\
    \ P., Sahoo, R., and Z. Cao,\n              \"Efficient Route Invalidation\",\
    \ Work in Progress,\n              draft-ietf-roll-efficient-npdao-09, October\
    \ 2018.\n   [IEEE-802-15-4]\n              IEEE, \"IEEE Standard for Low-Rate\
    \ Wireless Networks\",\n              IEEE Standard 802.15.4, DOI 10.1109/IEEESTD.2016.7460875,\n\
    \              <https://ieeexplore.ieee.org/document/7460875/>.\n   [IPv6-Backbone-Router]\n\
    \              Thubert, P., Ed. and C. Perkins, \"IPv6 Backbone Router\",\n  \
    \            Work in Progress, draft-ietf-6lo-backbone-router-08,\n          \
    \    October 2018.\n   [IPv6-over-802.11ah]\n              Del Carpio Vega, L.,\
    \ Robles, M., and R. Morabito, \"IPv6\n              over 802.11ah\", Work in\
    \ Progress, draft-delcarpio-6lo-\n              wlanah-01, October 2015.\n   [IPv6-over-NFC]\n\
    \              Choi, Y., Ed., Hong, Y-G., Youn, J-S., Kim, D-K., and J-H.\n  \
    \            Choi, \"Transmission of IPv6 Packets over Near Field\n          \
    \    Communication\", Work in Progress, draft-ietf-6lo-nfc-12,\n             \
    \ November 2018.\n   [IPv6-over-PLC]\n              Hou, J., Liu, B., Hong, Y-G.,\
    \ Tang, X., and C. Perkins,\n              \"Transmission of IPv6 Packets over\
    \ PLC Networks\", Work in\n              Progress, draft-hou-6lo-plc-05, October\
    \ 2018.\n   [Multicast-over-IEEE802-Wireless]\n              Perkins, C., McBride,\
    \ M., Stanley, D., Kumari, W., and JC.\n              Zuniga, \"Multicast Considerations\
    \ over IEEE 802 Wireless\n              Media\", Work in Progress, draft-ietf-mboned-ieee802-mcast-\n\
    \              problems-03, October 2018.\n   [ND-Optimizations]\n           \
    \   Chakrabarti, S., Nordmark, E., Thubert, P., and M.\n              Wasserman,\
    \ \"IPv6 Neighbor Discovery Optimizations for\n              Wired and Wireless\
    \ Networks\", Work in Progress,\n              draft-chakrabarti-nordmark-6man-efficient-nd-07,\n\
    \              February 2015.\n   [Perlman83]\n              Perlman, R., \"Fault-Tolerant\
    \ Broadcast of Routing\n              Information\", North-Holland Computer Networks\
    \ 7:\n              pp. 395-405, DOI 10.1016/0376-5075(83)90034-X, 1983,\n   \
    \           <http://www.cs.illinois.edu/~pbg/courses/cs598fa09/\n            \
    \  readings/p83.pdf>.\n   [RFC1958]  Carpenter, B., Ed., \"Architectural Principles\
    \ of the\n              Internet\", RFC 1958, DOI 10.17487/RFC1958, June 1996,\n\
    \              <https://www.rfc-editor.org/info/rfc1958>.\n   [RFC1982]  Elz,\
    \ R. and R. Bush, \"Serial Number Arithmetic\", RFC 1982,\n              DOI 10.17487/RFC1982,\
    \ August 1996,\n              <https://www.rfc-editor.org/info/rfc1982>.\n   [RFC3610]\
    \  Whiting, D., Housley, R., and N. Ferguson, \"Counter with\n              CBC-MAC\
    \ (CCM)\", RFC 3610, DOI 10.17487/RFC3610,\n              September 2003, <https://www.rfc-editor.org/info/rfc3610>.\n\
    \   [RFC3810]  Vida, R., Ed. and L. Costa, Ed., \"Multicast Listener\n       \
    \       Discovery Version 2 (MLDv2) for IPv6\", RFC 3810,\n              DOI 10.17487/RFC3810,\
    \ June 2004,\n              <https://www.rfc-editor.org/info/rfc3810>.\n   [RFC3971]\
    \  Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,\n              \"SEcure\
    \ Neighbor Discovery (SEND)\", RFC 3971,\n              DOI 10.17487/RFC3971,\
    \ March 2005,\n              <https://www.rfc-editor.org/info/rfc3971>.\n   [RFC3972]\
    \  Aura, T., \"Cryptographically Generated Addresses (CGA)\",\n              RFC\
    \ 3972, DOI 10.17487/RFC3972, March 2005,\n              <https://www.rfc-editor.org/info/rfc3972>.\n\
    \   [RFC4429]  Moore, N., \"Optimistic Duplicate Address Detection (DAD)\n   \
    \           for IPv6\", RFC 4429, DOI 10.17487/RFC4429, April 2006,\n        \
    \      <https://www.rfc-editor.org/info/rfc4429>.\n   [RFC4941]  Narten, T., Draves,\
    \ R., and S. Krishnan, \"Privacy\n              Extensions for Stateless Address\
    \ Autoconfiguration in\n              IPv6\", RFC 4941, DOI 10.17487/RFC4941,\
    \ September 2007,\n              <https://www.rfc-editor.org/info/rfc4941>.\n\
    \   [RFC6550]  Winter, T., Ed., Thubert, P., Ed., Brandt, A., Hui, J.,\n     \
    \         Kelsey, R., Levis, P., Pister, K., Struik, R., Vasseur,\n          \
    \    JP., and R. Alexander, \"RPL: IPv6 Routing Protocol for\n              Low-Power\
    \ and Lossy Networks\", RFC 6550,\n              DOI 10.17487/RFC6550, March 2012,\n\
    \              <https://www.rfc-editor.org/info/rfc6550>.\n   [RFC7217]  Gont,\
    \ F., \"A Method for Generating Semantically Opaque\n              Interface Identifiers\
    \ with IPv6 Stateless Address\n              Autoconfiguration (SLAAC)\", RFC\
    \ 7217,\n              DOI 10.17487/RFC7217, April 2014,\n              <https://www.rfc-editor.org/info/rfc7217>.\n\
    \   [RFC7428]  Brandt, A. and J. Buron, \"Transmission of IPv6 Packets\n     \
    \         over ITU-T G.9959 Networks\", RFC 7428,\n              DOI 10.17487/RFC7428,\
    \ February 2015,\n              <https://www.rfc-editor.org/info/rfc7428>.\n \
    \  [RFC7668]  Nieminen, J., Savolainen, T., Isomaki, M., Patil, B.,\n        \
    \      Shelby, Z., and C. Gomez, \"IPv6 over BLUETOOTH(R) Low\n              Energy\"\
    , RFC 7668, DOI 10.17487/RFC7668, October 2015,\n              <https://www.rfc-editor.org/info/rfc7668>.\n\
    \   [RFC7934]  Colitti, L., Cerf, V., Cheshire, S., and D. Schinazi,\n       \
    \       \"Host Address Availability Recommendations\", BCP 204,\n            \
    \  RFC 7934, DOI 10.17487/RFC7934, July 2016,\n              <https://www.rfc-editor.org/info/rfc7934>.\n\
    \   [RFC8064]  Gont, F., Cooper, A., Thaler, D., and W. Liu,\n              \"\
    Recommendation on Stable IPv6 Interface Identifiers\",\n              RFC 8064,\
    \ DOI 10.17487/RFC8064, February 2017,\n              <https://www.rfc-editor.org/info/rfc8064>.\n\
    \   [RFC8065]  Thaler, D., \"Privacy Considerations for IPv6 Adaptation-\n   \
    \           Layer Mechanisms\", RFC 8065, DOI 10.17487/RFC8065,\n            \
    \  February 2017, <https://www.rfc-editor.org/info/rfc8065>.\n   [RFC8105]  Mariager,\
    \ P., Petersen, J., Ed., Shelby, Z., Van de Logt,\n              M., and D. Barthel,\
    \ \"Transmission of IPv6 Packets over\n              Digital Enhanced Cordless\
    \ Telecommunications (DECT) Ultra\n              Low Energy (ULE)\", RFC 8105,\
    \ DOI 10.17487/RFC8105,\n              May 2017, <https://www.rfc-editor.org/info/rfc8105>.\n\
    \   [RFC8163]  Lynn, K., Ed., Martocci, J., Neilson, C., and S.\n            \
    \  Donaldson, \"Transmission of IPv6 over Master-Slave/Token-\n              Passing\
    \ (MS/TP) Networks\", RFC 8163, DOI 10.17487/RFC8163,\n              May 2017,\
    \ <https://www.rfc-editor.org/info/rfc8163>.\n   [RFC8279]  Wijnands, IJ., Ed.,\
    \ Rosen, E., Ed., Dolganow, A.,\n              Przygienda, T., and S. Aldrin,\
    \ \"Multicast Using Bit Index\n              Explicit Replication (BIER)\", RFC\
    \ 8279,\n              DOI 10.17487/RFC8279, November 2017,\n              <https://www.rfc-editor.org/info/rfc8279>.\n\
    \   [Routing-for-RPL-Leaves]\n              Thubert, P., Ed., \"Routing for RPL\
    \ Leaves\", Work in\n              Progress, draft-thubert-roll-unaware-leaves-05,\
    \ May 2018.\n"
- title: Appendix A.  Applicability and Fulfilled Requirements (Not Normative)
  contents:
  - "Appendix A.  Applicability and Fulfilled Requirements (Not Normative)\n   This\
    \ specification extends 6LoWPAN ND to provide a sequence number to\n   the registration\
    \ and fulfills the requirements expressed in\n   Appendix B.1 by enabling the\
    \ mobility of devices from one LLN to the\n   next.  A full specification for\
    \ enabling mobility based on the use of\n   the EARO and the registration procedures\
    \ defined in this document can\n   be found in subsequent work [IPv6-Backbone-Router]\
    \ (\"IPv6 Backbone\n   Router\").  The 6BBR is an example of a Routing Registrar\
    \ that acts as\n   an IPv6 ND proxy over a Backbone Link that federates multiple\
    \ LLNs as\n   well as the Backbone Link itself into a single IPv6 subnet.  The\n\
    \   expected registration flow in that case is illustrated in Figure 6,\n   noting\
    \ that any combination of 6LR, 6LBR, and 6BBR may be collocated.\n       6LN \
    \             6LR             6LBR            6BBR\n        |                |\
    \               |                |\n        |   NS(EARO)     |               |\
    \                |\n        |--------------->|               |               \
    \ |\n        |                | Extended DAR  |                |\n        |  \
    \              |-------------->|                |\n        |                |\
    \               |                |\n        |                |               |\
    \ proxy NS(EARO) |\n        |                |               |--------------->|\n\
    \        |                |               |                | NS(DAD)\n       \
    \ |                |               |                | ------>\n        |     \
    \           |               |                | <wait>\n        |             \
    \   |               |                |\n        |                |           \
    \    | proxy NA(EARO) |\n        |                |               |<---------------|\n\
    \        |                | Extended DAC  |                |\n        |      \
    \          |<--------------|                |\n        |   NA(EARO)     |    \
    \           |                |\n        |<---------------|               |   \
    \             |\n        |                |               |                |\n\
    \                     Figure 6: (Re-)Registration Flow\n   [Arch-for-6TiSCH] (\"\
    An Architecture for IPv6 over the TSCH mode of\n   IEEE 802.15.4\") describes\
    \ how a 6LoWPAN ND host using the\n   Time-Slotted Channel Hopping (TSCH) mode\
    \ of IEEE Std. 802.15.4\n   [IEEE-802-15-4] can connect to the Internet via a\
    \ RPL mesh network.\n   Doing so requires additions to the 6LoWPAN ND protocol\
    \ to support\n   mobility and reachability in a secure and manageable network\n\
    \   environment.  This document specifies those new operations and\n   fulfills\
    \ the requirements listed in Appendix B.2.\n   The term \"LLN\" is used loosely\
    \ in this document and is intended to\n   cover multiple types of WLANs and WPANs,\
    \ including Low-Power IEEE\n   Std. 802.11 networking, Bluetooth low energy, IEEE\
    \ Std. 802.11ah, and\n   IEEE Std. 802.15.4 wireless meshes, so as to address\
    \ the requirements\n   discussed in Appendix B.3.\n   This specification can be\
    \ used by any wireless node to register its\n   IPv6 Addresses with a Routing\
    \ Registrar and to obtain routing\n   services such as proxy ND operations over\
    \ a Backbone Link.  This\n   satisfies the requirements expressed in Appendix\
    \ B.4.\n   This specification is extended by [AP-ND] to provide a solution to\n\
    \   some of the security-related requirements expressed in Appendix B.5.\n   [ND-Optimizations]\
    \ (\"IPv6 Neighbor Discovery Optimizations for Wired\n   and Wireless Networks\"\
    ) suggests that 6LoWPAN ND [RFC6775] can be\n   extended to other types of links\
    \ (beyond IEEE Std. 802.15.4) for\n   which it was defined.  The registration\
    \ technique is beneficial when\n   the link-layer technique used to carry IPv6\
    \ multicast packets is not\n   sufficiently efficient in terms of delivery ratio\
    \ or energy\n   consumption in the end devices -- in particular, to enable\n \
    \  energy-constrained sleeping nodes.  The value of such an extension is\n   especially\
    \ apparent in the case of mobile wireless nodes, to reduce\n   the multicast operations\
    \ that are related to IPv6 ND [RFC4861]\n   [RFC4862] and affect the operation\
    \ of the wireless medium\n   [Multicast-over-IEEE802-Wireless].  This fulfills\
    \ the scalability\n   requirements listed in Appendix B.6.\n"
- title: Appendix B.  Requirements (Not Normative)
  contents:
  - "Appendix B.  Requirements (Not Normative)\n   This appendix lists requirements\
    \ that were discussed by the\n   6lo Working Group for an update to 6LoWPAN ND.\
    \  How those\n   requirements are matched with existing specifications at the\
    \ time\n   of this writing is shown in Appendix B.8.\n"
- title: B.1.  Requirements Related to Mobility
  contents:
  - "B.1.  Requirements Related to Mobility\n   Due to the unstable nature of LLN\
    \ links, even in an LLN of immobile\n   nodes, a 6LN may change its point of attachment\
    \ from, say, 6LR-a to\n   6LR-b but may not be able to notify 6LR-a.  Consequently,\
    \ 6LR-a may\n   still attract traffic that it cannot deliver any more.  When links\
    \ to\n   a 6LR change state, there is thus a need to identify stale states in\n\
    \   a 6LR and restore reachability in a timely fashion, e.g., by using\n   some\
    \ type of signaling upon detection of the movement or using a\n   keep-alive mechanism\
    \ with a period that is consistent with the needs\n   of the application.\n  \
    \ Req-1.1:  Upon a change of point of attachment, connectivity via a\n       \
    \      new 6LR MUST be restored in a timely fashion without the\n            \
    \ need to de-register from the previous 6LR.\n   Req-1.2:  For that purpose, the\
    \ protocol MUST enable differentiating\n             between multiple registrations\
    \ from one 6LN and\n             registrations from different 6LNs claiming the\
    \ same\n             address.\n   Req-1.3:  Stale states MUST be cleaned up in\
    \ 6LRs.\n   Req-1.4:  A 6LN SHOULD also be able to register its address\n    \
    \         concurrently to multiple 6LRs.\n"
- title: B.2.  Requirements Related to Routing Protocols
  contents:
  - "B.2.  Requirements Related to Routing Protocols\n   The point of attachment of\
    \ a 6LN may be a 6LR in an LLN mesh.  IPv6\n   routing in an LLN can be based\
    \ on RPL, which is the routing protocol\n   that was defined by the IETF for this\
    \ particular purpose.  Other\n   routing protocols are also considered by Standards\
    \ Development\n   Organizations (SDOs) on the basis of the expected network\n\
    \   characteristics.  It is required that a 6LN attached via ND to a 6LR\n   indicate\
    \ whether or not it (1) participates in the selected routing\n   protocol to obtain\
    \ reachability via the 6LR or (2) expects the 6LR to\n   manage its reachability.\n\
    \   The specified updates enable other specifications to define new\n   services\
    \ such as Source Address Validation Improvement (SAVI) (via\n   [AP-ND]), participation\
    \ as an unaware leaf to a routing protocol\n   (such as the protocol described\
    \ in [RFC6550] (RPL)) (via\n   [Routing-for-RPL-Leaves]), and registration to\
    \ Backbone Routers\n   performing proxy ND in an LLN (via [IPv6-Backbone-Router]).\n\
    \   Beyond the 6LBR unicast address registered by ND, other addresses,\n   including\
    \ multicast addresses, are needed as well.  For example, a\n   routing protocol\
    \ often uses a multicast address to register changes\n   to established paths.\
    \  ND needs to register such a multicast address\n   to enable routing concurrently\
    \ with discovery.\n   Multicast is needed for groups.  Groups may be formed by\
    \ device type\n   (e.g., routers, street lamps), location (geography, RPL subtree),\n\
    \   or both.\n   The Bit Index Explicit Replication (BIER) architecture [RFC8279]\n\
    \   proposes an optimized technique to enable multicast in an LLN with a\n   very\
    \ limited requirement for routing state in the nodes.\n   Related requirements\
    \ are as follows:\n   Req-2.1:  The ND registration method SHOULD be extended\
    \ so that the\n             6LR is instructed whether to advertise the address\
    \ of a 6LN\n             over the selected routing protocol and obtain reachability\n\
    \             to that address using the selected routing protocol.\n   Req-2.2:\
    \  Considering RPL, the ARO that is used in the ND\n             registration\
    \ SHOULD be extended to carry enough information\n             to generate a DAO\
    \ message as specified in Section 6.4 of\n             [RFC6550] -- in particular,\
    \ the capability to compute a\n             Path Sequence and, as an option, a\
    \ RPLInstanceID.\n   Req-2.3:  Multicast operations SHOULD be supported and optimized\
    \ --\n             for instance, using BIER or the Multicast Protocol for\n  \
    \           Low-Power and Lossy Networks (MPL).  Whether ND is\n             appropriate\
    \ for the registration to the Routing Registrar\n             is to be defined,\
    \ considering the additional burden of\n             supporting Multicast Listener\
    \ Discovery Version 2 (MLDv2)\n             for IPv6 [RFC3810].\n"
- title: B.3.  Requirements Related to Various Low-Power Link Types
  contents:
  - "B.3.  Requirements Related to Various Low-Power Link Types\n   6LoWPAN ND [RFC6775]\
    \ was defined with a focus on IEEE Std.802.15.4\n   and, in particular, the capability\
    \ to derive a unique identifier from\n   a globally unique EUI-64 address.  At\
    \ this point, the 6lo Working\n   Group is extending the 6LoWPAN Header Compression\
    \ (HC) technique\n   [RFC6282] to other link types, including ITU-T G.9959 [RFC7428],\n\
    \   Master-Slave/Token-Passing [RFC8163], Digital Enhanced Cordless\n   Telecommunications\
    \ (DECT) Ultra Low Energy [RFC8105], Near Field\n   Communication [IPv6-over-NFC],\
    \ and IEEE Std. 802.11ah\n   [IPv6-over-802.11ah], as well as Bluetooth low energy\
    \ [RFC7668] and\n   Power Line Communication (PLC) Networks [IPv6-over-PLC].\n\
    \   Related requirements are as follows:\n   Req-3.1:  The support of the registration\
    \ mechanism SHOULD be\n             extended to more LLN links than IEEE Std.802.15.4,\
    \ matching\n             at least the LLN links for which an \"IPv6 over foo\"\
    \n             specification exists, as well as low-power Wi-Fi.\n   Req-3.2:\
    \  As part of this extension, a mechanism to compute a unique\n             identifier\
    \ should be provided, with the capability to form\n             a Link-Local Address\
    \ that SHOULD be unique at least within\n             the LLN connected to a 6LBR\
    \ discovered by ND in each node\n             within the LLN.\n   Req-3.3:  The\
    \ ARO used in the ND registration SHOULD be extended to\n             carry the\
    \ relevant forms of the unique identifier.\n   Req-3.4:  ND should specify the\
    \ formation of a site-local address\n             that follows the security recommendations\
    \ in [RFC7217].\n"
- title: B.4.  Requirements Related to Proxy Operations
  contents:
  - "B.4.  Requirements Related to Proxy Operations\n   Duty-cycled devices may not\
    \ be awake to answer a lookup from a node\n   that uses IPv6 ND and may need a\
    \ proxy.  Additionally, the\n   duty-cycled device may rely on the 6LBR to perform\
    \ registration to\n   the Routing Registrar.\n   The ND registration method SHOULD\
    \ defend the addresses of duty-cycled\n   devices that are sleeping most of the\
    \ time and incapable of defending\n   their own addresses.\n   Related requirements\
    \ are as follows:\n   Req-4.1:  The registration mechanism SHOULD enable a third\
    \ party to\n             proxy-register an address on behalf of a 6LN that may\
    \ be\n             sleeping or located deeper in an LLN mesh.\n   Req-4.2:  The\
    \ registration mechanism SHOULD be applicable to a\n             duty-cycled device\
    \ regardless of the link type and SHOULD\n             enable a Routing Registrar\
    \ to operate as a proxy to defend\n             the Registered Addresses on its\
    \ behalf.\n   Req-4.3:  The registration mechanism SHOULD enable long sleep\n\
    \             durations, on the order of multiple days to a month.\n"
- title: B.5.  Requirements Related to Security
  contents:
  - "B.5.  Requirements Related to Security\n   In order to guarantee the operations\
    \ of the 6LoWPAN ND flows,\n   spoofing the roles of the 6LR, 6LBR, and Routing\
    \ Registrar should be\n   avoided.  Once a node successfully registers an address,\
    \ 6LoWPAN ND\n   should provide energy-efficient means for the 6LBR to protect\
    \ that\n   ownership even when the node that registered the address is sleeping.\n\
    \   In particular, the 6LR and the 6LBR should then be able to verify\n   whether\
    \ a subsequent registration for a given address comes from the\n   original node.\n\
    \   In an LLN, it makes sense to base security on Layer 2 security.\n   During\
    \ bootstrap of the LLN, nodes join the network after\n   authorization by a Joining\
    \ Assistant (JA) or a Commissioning Tool\n   (CT).  After joining, nodes communicate\
    \ with each other via secured\n   links.  The keys for Layer 2 security are distributed\
    \ by the JA/CT.\n   The JA/CT can be part of the LLN or be outside the LLN.  In\
    \ both\n   cases, the ability to route packets between the JA/CT and the joining\n\
    \   node is needed.\n   Related requirements are as follows:\n   Req-5.1:  6LoWPAN\
    \ ND security mechanisms SHOULD provide a mechanism\n             for the 6LR,\
    \ 6LBR, and Routing Registrar to authenticate\n             and authorize one\
    \ another for their respective roles, as\n             well as with the 6LN for\
    \ the role of 6LR.\n   Req-5.2:  6LoWPAN ND security mechanisms SHOULD provide\
    \ a mechanism\n             for the 6LR and the 6LBR to validate new registrations\
    \ of\n             authorized nodes.  Joining of unauthorized nodes MUST be\n\
    \             prevented.\n   Req-5.3:  The use of 6LoWPAN ND security mechanisms\
    \ SHOULD NOT result\n             in large packet sizes.  In particular, the NS,\
    \ NA, DAR, and\n             DAC messages for a re-registration flow SHOULD NOT\
    \ exceed\n             80 octets so as to fit in a secured IEEE Std.802.15.4\n\
    \             [IEEE-802-15-4] frame.\n   Req-5.4:  Recurrent 6LoWPAN ND security\
    \ operations MUST NOT be\n             computationally intensive on the 6LN's\
    \ CPU.  When\n             calculation of a key hash is employed, a mechanism\
    \ lighter\n             than SHA-1 SHOULD be used.\n   Req-5.5:  The number of\
    \ keys that the 6LN needs to manipulate SHOULD\n             be minimized.\n \
    \  Req-5.6:  6LoWPAN ND security mechanisms SHOULD enable (1) the\n          \
    \   variation of CCM (\"Counter with CBC-MAC\") [RFC3610] called\n           \
    \  \"CCM*\" for use at both Layer 2 and Layer 3 and (2) the\n             reuse\
    \ of a security code that has to be present on the\n             device for upper-layer\
    \ security (e.g., TLS).  Algorithm\n             agility and support for large\
    \ keys (e.g., 256-bit key\n             sizes) are also desirable.\n   Req-5.7:\
    \  Public key and signature sizes SHOULD be minimized while\n             maintaining\
    \ adequate confidentiality and data origin\n             authentication for multiple\
    \ types of applications with\n             various degrees of criticality.\n \
    \  Req-5.8:  Routing of packets should continue when links pass from the\n   \
    \          unsecured state to the secured state.\n   Req-5.9:  6LoWPAN ND security\
    \ mechanisms SHOULD provide a mechanism\n             for the 6LR and the 6LBR\
    \ to validate whether a new\n             registration for a given address corresponds\
    \ to the same\n             6LN that registered it initially and, if not, determine\
    \ the\n             rightful owner and deny or clean up the registration if it\n\
    \             is a duplicate.\n"
- title: B.6.  Requirements Related to Scalability
  contents:
  - "B.6.  Requirements Related to Scalability\n   Use cases from Automatic Meter\
    \ Reading (AMR) (collection-tree\n   operations) and Advanced Metering Infrastructure\
    \ (AMI) (bidirectional\n   communication to the meters) indicate the need for\
    \ a large number of\n   LLN nodes pertaining to a single RPL DODAG (e.g., 5000)\
    \ and connected\n   to the 6LBR over a large number of LLN hops (e.g., 15).\n\
    \   Related requirements are as follows:\n   Req-6.1:  The registration mechanism\
    \ SHOULD enable a single 6LBR to\n             register multiple thousands of\
    \ devices.\n   Req-6.2:  The timing of the registration operation should allow\
    \ for\n             long latency, such as that found in LLNs with ten or\n   \
    \          more hops.\n"
- title: B.7.  Requirements Related to Operations and Management
  contents:
  - "B.7.  Requirements Related to Operations and Management\n   Guideline 3.8 in\
    \ Section 3 of [RFC1958] (\"Architectural Principles of\n   the Internet\") recommends\
    \ the following: \"Avoid options and\n   parameters whenever possible.  Any options\
    \ and parameters should be\n   configured or negotiated dynamically rather than\
    \ manually.\"  This is\n   especially true in LLNs where the number of devices\
    \ may be large and\n   manual configuration is infeasible.  Capabilities for dynamic\n\
    \   configuration of LLN devices can also be constrained by network and\n   power\
    \ limitations.\n   A network administrator should be able to validate that the\
    \ network\n   is operating within capacity and that, in particular, a 6LBR does\
    \ not\n   get overloaded with an excessive amount of registrations, so the\n \
    \  administrator can take actions such as adding a Backbone Link with\n   additional\
    \ 6LBRs and Routing Registrars to the network.\n   Related requirements are as\
    \ follows:\n   Req-7.1:  A management model SHOULD be provided that enables access\n\
    \             to the 6LBR, monitors its usage vs. capacity, and sends\n      \
    \       alerts in the case of congestion.  It is recommended that\n          \
    \   the 6LBR be reachable over a non-LLN link.\n   Req-7.2:  A management model\
    \ SHOULD be provided that enables access\n             to the 6LR and its capacity\
    \ to host additional NCEs.  This\n             management model SHOULD avoid polling\
    \ individual 6LRs in a\n             way that could disrupt the operation of the\
    \ LLN.\n   Req-7.3:  Information on successful and failed registrations SHOULD\n\
    \             be provided, including information such as the ROVR of the\n   \
    \          6LN, the Registered Address, the address of the 6LR, and\n        \
    \     the duration of the registration flow.\n   Req-7.4:  In the case of a failed\
    \ registration, information on the\n             failure, including the identification\
    \ of the node that\n             rejected the registration and the status in the\
    \ EARO,\n             SHOULD be provided.\n"
- title: B.8.  Matching Requirements with Specifications
  contents:
  - "B.8.  Matching Requirements with Specifications\n             +-------------+--------------------------------+\n\
    \             | Requirement | Document                       |\n             +-------------+--------------------------------+\n\
    \             | Req-1.1     | [IPv6-Backbone-Router]         |\n             |\
    \             |                                |\n             | Req-1.2     |\
    \ [RFC6775]                      |\n             |             |             \
    \                   |\n             | Req-1.3     | [RFC6775]                \
    \      |\n             |             |                                |\n    \
    \         | Req-1.4     | RFC 8505                       |\n             |   \
    \          |                                |\n             | Req-2.1     | RFC\
    \ 8505                       |\n             |             |                 \
    \               |\n             | Req-2.2     | RFC 8505                     \
    \  |\n             |             |                                |\n        \
    \     | Req-2.3     |                                |\n             |       \
    \      |                                |\n             | Req-3.1     | Technology\
    \ Dependent           |\n             |             |                        \
    \        |\n             | Req-3.2     | Technology Dependent           |\n  \
    \           |             |                                |\n             | Req-3.3\
    \     | Technology Dependent           |\n             |             |       \
    \                         |\n             | Req-3.4     | Technology Dependent\
    \           |\n             |             |                                |\n\
    \             | Req-4.1     | RFC 8505                       |\n             |\
    \             |                                |\n             | Req-4.2     |\
    \ RFC 8505                       |\n             |             |             \
    \                   |\n             | Req-4.3     | [RFC6775]                \
    \      |\n             |             |                                |\n    \
    \         | Req-5.1     |                                |\n             |   \
    \          |                                |\n             | Req-5.2     | [AP-ND]\
    \                        |\n             |             |                     \
    \           |\n             | Req-5.3     |                                |\n\
    \             |             |                                |\n             |\
    \ Req-5.4     |                                |\n             |             |\
    \                                |\n             | Req-5.5     | [AP-ND]     \
    \                   |\n             |             |                          \
    \      |\n             | Req-5.6     | [Alternative-Ellip-Curve-Reps] |\n    \
    \         |             |                                |\n             | Req-5.7\
    \     | [AP-ND]                        |\n             |             |       \
    \                         |\n             | Req-5.8     |                    \
    \            |\n             |             |                                |\n\
    \             | Req-5.9     | [AP-ND]                        |\n             |\
    \             |                                |\n             | Req-6.1     |\
    \ RFC 8505                       |\n             |             |             \
    \                   |\n             | Req-6.2     | RFC 8505                 \
    \      |\n             |             |                                |\n    \
    \         | Req-7.1     |                                |\n             |   \
    \          |                                |\n             | Req-7.2     |  \
    \                              |\n             |             |               \
    \                 |\n             | Req-7.3     |                            \
    \    |\n             |             |                                |\n      \
    \       | Req-7.4     |                                |\n             +-------------+--------------------------------+\n\
    \               Table 8: Documents That Address Requirements\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   Kudos to Eric Levy-Abegnoli, who designed the \"First-Hop\
    \ Security\"\n   infrastructure upon which the first Backbone Router was implemented.\n\
    \   Many thanks to Sedat Gormus, Rahul Jadhav, Tim Chown, Juergen\n   Schoenwaelder,\
    \ Chris Lonvick, Dave Thaler, Adrian Farrel, Peter Yee,\n   Warren Kumari, Benjamin\
    \ Kaduk, Mirja Kuehlewind, Ben Campbell, Eric\n   Rescorla, and Lorenzo Colitti\
    \ for their various contributions and\n   reviews.  Also, many thanks to Thomas\
    \ Watteyne for the world's first\n   implementation of a 6LN that was instrumental\
    \ to the early tests of\n   the 6LR, 6LBR, and Backbone Router.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Pascal Thubert (editor)\n   Cisco Systems, Inc.\n   Building\
    \ D (Regus) 45 Allee des Ormes\n   Mougins - Sophia Antipolis\n   France\n   Phone:\
    \ +33 4 97 23 26 34\n   Email: pthubert@cisco.com\n   Erik Nordmark\n   Zededa\n\
    \   Santa Clara, CA\n   United States of America\n   Email: nordmark@sonic.net\n\
    \   Samita Chakrabarti\n   Verizon\n   San Jose, CA\n   United States of America\n\
    \   Email: samitac.ietf@gmail.com\n   Charles E. Perkins\n   Futurewei\n   2330\
    \ Central Expressway\n   Santa Clara, CA  95050\n   United States of America\n\
    \   Email: charliep@computer.org\n"
