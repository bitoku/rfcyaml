- title: __initial_text__
  contents:
  - "             A Session Initiation Protocol (SIP) Extension\n                \
    \   for the Identification of Services\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes private extensions to the Session Initiation\n\
    \   Protocol (SIP) that enable a network of trusted SIP servers to assert\n  \
    \ the service of authenticated users.  The use of these extensions is\n   only\
    \ applicable inside an administrative domain with previously\n   agreed-upon policies\
    \ for generation, transport, and usage of such\n   information.  This document\
    \ does NOT offer a general service\n   identification model suitable for use between\
    \ different trust domains\n   or for use in the Internet at large.\n   The document\
    \ also defines a URN to identify both services and User\n   Agent (UA) applications.\
    \  This URN can be used within the SIP header\n   fields defined in this document\
    \ to identify services, and also within\n   the framework defined for caller preferences\
    \ and callee capabilities\n   to identify usage of both services and applications\
    \ between end UAs.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6050.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  3\n   2.  Applicability Statement  . . . . . . . . . . . . . .\
    \ . . . . .  5\n   3.  Conventions  . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .  6\n   4.  Syntax of the Header Fields  . . . . . . . . . . . . . .\
    \ . . .  6\n     4.1.  The P-Asserted-Service Header  . . . . . . . . . . . .\
    \ . .  6\n     4.2.  The P-Preferred-Service Header . . . . . . . . . . . . .\
    \ .  7\n     4.3.  Service and Application Definition . . . . . . . . . . . .\
    \  8\n     4.4.  Registration Template  . . . . . . . . . . . . . . . . . .  8\n\
    \   5.  Usage of the P-Preferred-Service and P-Asserted-Service\n       Header\
    \ Fields  . . . . . . . . . . . . . . . . . . . . . . . . 10\n     5.1.  Usage\
    \ of the P-Preferred-Service and\n           P-Asserted-Service Header Fields\
    \ in Requests . . . . . . . 10\n       5.1.1.  Procedures at User Agent Clients\
    \ (UAC) . . . . . . . . 10\n       5.1.2.  Procedures at Intermediate Proxies\
    \ . . . . . . . . . . 11\n       5.1.3.  Procedures at User Agent Servers . .\
    \ . . . . . . . . . 12\n     5.2.  Usage of the P-Preferred-Service and\n    \
    \       P-Asserted-Service Header Fields in Responses  . . . . . . 12\n   6. \
    \ Examples of Usage  . . . . . . . . . . . . . . . . . . . . . . 12\n   7.  Security\
    \ Considerations  . . . . . . . . . . . . . . . . . . . 15\n   8.  IANA Considerations\
    \  . . . . . . . . . . . . . . . . . . . . . 16\n     8.1.  P-Asserted-Service\
    \ and P-Preferred-Service Header\n           Fields . . . . . . . . . . . . .\
    \ . . . . . . . . . . . . . 16\n     8.2.  Definition of Service-ID Values  .\
    \ . . . . . . . . . . . . 16\n   9.  References . . . . . . . . . . . . . . .\
    \ . . . . . . . . . . . 17\n     9.1.  Normative References . . . . . . . . .\
    \ . . . . . . . . . . 17\n     9.2.  Informative References . . . . . . . . .\
    \ . . . . . . . . . 18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document describes private extensions to the Session\
    \ Initiation\n   Protocol (SIP) that enable a network of trusted SIP servers to\
    \ assert\n   the service, possibly subject to the user being entitled to that\n\
    \   service.  The use of these extensions is only applicable inside an\n   administrative\
    \ domain with previously agreed-upon policies for\n   generation, transport, and\
    \ usage of such information.  This document\n   does NOT offer a general service\
    \ model suitable for use between\n   different trust domains or for use in the\
    \ Internet at large.\n   The concept of \"service\" within SIP has no hard and\
    \ fast rules.  RFC\n   5897 [RFC5897] provides general guidance on what constitutes\
    \ a\n   service within SIP and what does not.\n   This document also makes use\
    \ of the terms \"derived service\n   identification\" and \"declarative service\
    \ identification\" as defined\n   in RFC 5897 [RFC5897].\n   It should be noted\
    \ that RFC 5897 [RFC5897] clearly states that\n   declarative service identification\
    \ -- the process by which a user\n   agent inserts a moniker into a message that\
    \ defines the desired\n   service, separate from explicit and well-defined protocol\
    \ mechanisms\n   -- is harmful.\n   During a session setup, proxies may need to\
    \ understand what service\n   the request is related to in order to know what\
    \ application server to\n   contact or other service logic to invoke.  The SIP\
    \ INVITE request\n   contains all of the information necessary to determine the\
    \ service.\n   However, the calculation of the service may be computational and\n\
    \   database intensive.  For example, a given trust domain's definition\n   of\
    \ a service might include request authorization.  Moreover, the\n   analysis may\
    \ require examination of the Session Description Protocol\n   (SDP).\n   For example,\
    \ an INVITE request with video SDP directed to a video-on-\n   demand Request-URI\
    \ could be marked as an IPTV session.  An INVITE\n   request with push-to-talk\
    \ over cellular (PoC) routes could be marked\n   as a PoC session.  An INVITE\
    \ request with a Require header field\n   containing an option tag of \"foogame\"\
    \ could be marked as a foogame\n   session.\n   NOTE: If the information contained\
    \ within the SIP INVITE request is\n   not sufficient to uniquely identify a service,\
    \ the remedy is to\n   extend the SIP signaling to capture the missing element.\
    \  RFC 5897\n   [RFC5897] provides further explanation.\n   By providing a mechanism\
    \ to compute and store the results of the\n   domain-specific service calculation,\
    \ i.e., the derived service\n   identification, this optimization allows a single\
    \ trusted proxy to\n   perform an analysis of the request and authorize the requestor's\n\
    \   permission to request such a service.  The proxy may then include a\n   service\
    \ identifier that relieves other trusted proxies and trusted\n   UAs from performing\
    \ further duplicate analysis of the request for\n   their service identification\
    \ purposes.  In addition, this extension\n   allows user agent clients outside\
    \ the trust domain to provide a hint\n   of the requested service.\n   This extension\
    \ does not provide for the dialog or transaction to be\n   rejected if the service\
    \ is not supported end-to-end.  SIP provides\n   other mechanisms, such as the\
    \ option-tag and use of the Require and\n   Proxy-Require header fields, where\
    \ such functionality is required.\n   No explicitly signaled service identification\
    \ exists, and the session\n   proceeds for each node's definition of the service\
    \ in use, on the\n   basis of information contained in the SDP and in other SIP\
    \ header\n   fields.\n   This mechanism is specifically for managing the information\
    \ needs of\n   intermediate routing devices between the calling user and the user\n\
    \   represented by the Request-URI.  In support of this mechanism, a URN\n   is\
    \ defined to identify the services.  This URN has wider\n   applicability to additionally\
    \ identify services and terminal\n   applications.  Between end users, caller\
    \ preferences and callee\n   capabilities as specified in RFC 3840 [RFC3840] and\
    \ RFC 3841\n   [RFC3841] provide an appropriate mechanism for indicating such\n\
    \   service and application identification.  These mechanisms have been\n   extended\
    \ by RFC 5688 [RFC5688] to provide further capabilities in\n   this area.\n  \
    \ The mechanism proposed in this document relies on a new header field\n   called\
    \ 'P-Asserted-Service' that contains a URN.  This is supported\n   by a further\
    \ new header field called 'P-Preferred-Service' that also\n   contains a URN and\
    \ that allows the UA to express preferences\n   regarding the decisions made on\
    \ service within the trust domain.\n   An example of the P-Asserted-Service header\
    \ field is:\n   P-Asserted-Service: urn:urn-7:3gpp-service.exampletelephony.version1\n\
    \   A proxy server that handles a request can, after authenticating the\n   originating\
    \ user in some way (for example: digest authentication) to\n   ensure that the\
    \ user is entitled to that service, insert such a\n   P-Asserted-Service header\
    \ field into the request and forward it to\n   other trusted proxies.  A proxy\
    \ that is about to forward a request to\n   a proxy server or UA that it does\
    \ not trust removes all the\n   P-Asserted-Service header field values.\n   This\
    \ document labels services by means of an informal URN.  This\n   provides a hierarchical\
    \ structure for defining services and\n   subservices, and provides an address\
    \ that can be resolvable for\n   various purposes outside the scope of this document,\
    \ e.g., to obtain\n   information about the service so described.\n"
- title: 2.  Applicability Statement
  contents:
  - "2.  Applicability Statement\n   This document describes private extensions to\
    \ SIP (see RFC 3261\n   [RFC3261]) that enable a network of trusted SIP servers\
    \ to assert the\n   service of end users or end systems.  The use of these extensions\
    \ is\n   only applicable inside a 'trust domain' as defined in \"Short Term\n\
    \   Requirements for Network Asserted Identity\" (see RFC 3324 [RFC3324]).\n \
    \  Nodes in such a trust domain are explicitly trusted by its users and\n   end\
    \ systems to publicly assert the service of each party, and that\n   they have\
    \ common and agreed-upon definitions of services and\n   homogeneous service offerings.\
    \  The means by which the network\n   determines the service to assert is outside\
    \ the scope of this\n   document (though it commonly entails some form of authentication).\n\
    \   The mechanism for defining a trust domain is to provide a certain set\n  \
    \ of specifications known as 'Spec(T)', and then specify compliance to\n   that\
    \ set of specifications.  Spec(T) MUST specify behavior as\n   documented in RFC\
    \ 3324 [RFC3324].\n   This document does NOT offer a general service model suitable\
    \ for\n   inter-domain use or use in the Internet at large.  Its assumptions\n\
    \   about the trust relationship between the user and the network may not\n  \
    \ apply in many applications.  For example, these extensions do not\n   accommodate\
    \ a model whereby end users can independently assert their\n   service by use\
    \ of the extensions defined here.  End users assert\n   their service by including\
    \ the SIP and SDP parameters that correspond\n   to the service they require.\
    \  Furthermore, since the asserted\n   services are not cryptographically certified,\
    \ they are subject to\n   forgery, replay, and falsification in any architecture\
    \ that does not\n   meet the requirements of RFC 3324 [RFC3324].\n   The asserted\
    \ services also lack an indication of who specifically is\n   asserting the service,\
    \ and so it must be assumed that a member of the\n   trust domain is asserting\
    \ the service.  Therefore, the information is\n   only meaningful when securely\
    \ received from a node known to be a\n   member of the trust domain.\n   Despite\
    \ these limitations, there are sufficiently useful specialized\n   deployments,\
    \ that meet the assumptions described above and can accept\n   the limitations\
    \ that result, to warrant informational publication of\n   this mechanism.\n"
- title: 3.  Conventions
  contents:
  - "3.  Conventions\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in BCP\
    \ 14, RFC 2119\n   [RFC2119].\n   Throughout this document, requirements for or\
    \ references to proxy\n   servers or proxy behavior apply similarly to other intermediaries\n\
    \   within a trust domain (for example, back-to-back user agents\n   (B2BUAs)).\n\
    \   The term trust domain in this document has the meaning as defined in\n   RFC\
    \ 3324 [RFC3324].\n"
- title: 4.  Syntax of the Header Fields
  contents:
  - "4.  Syntax of the Header Fields\n   The following syntax specification uses the\
    \ augmented Backus-Naur\n   Form (BNF) as described in RFC 5234 [RFC5234].\n"
- title: 4.1.  The P-Asserted-Service Header
  contents:
  - "4.1.  The P-Asserted-Service Header\n   The P-Asserted-Service header field is\
    \ used among trusted SIP\n   entities (typically intermediaries) to carry the\
    \ service information\n   of the user sending a SIP message.\n   The P-Asserted-Service\
    \ header field carries information that is\n   derived service identification.\
    \  While a declarative service\n   identification can assist in deriving the value\
    \ transferred in this\n   header field, this should be in the form of streamlining\
    \ the correct\n   derived service identification.\n         PAssertedService =\
    \ \"P-Asserted-Service\"\n                            HCOLON PAssertedService-value\n\
    \         PAssertedService-value = Service-ID *(COMMA Service-ID)\n   See Section\
    \ 4.4 for the definition of Service-ID in ABNF.\n   Proxies can (and will) add\
    \ and remove this header field.\n   Table 1 adds the header fields defined in\
    \ this document to Table 2 in\n   SIP [RFC3261], Section 7.1 of the SIP-specific\
    \ event notification\n   [RFC3265], Tables 1 and 2 in the SIP INFO method [RFC2976],\
    \ Tables 1\n   and 2 in the reliability of provisional responses in SIP [RFC3262],\n\
    \   Tables 1 and 2 in the SIP UPDATE method [RFC3311], Tables 1 and 2 in\n   the\
    \ SIP extension for instant messaging [RFC3428], Table 1 in the SIP\n   REFER\
    \ method [RFC3515], and Tables 2 and 3 in the SIP PUBLISH method\n   [RFC3903]:\n\
    \         Header field          where  proxy  ACK BYE CAN INV OPT REG SUB\n  \
    \       _______________________________________________________________\n    \
    \     P-Asserted-Service      R     admr   -   -   -   o   o   -   o\n       \
    \  Header field                        NOT PRA INF UPD MSG REF PUB\n         _______________________________________________________________\n\
    \         P-Asserted-Service                   -   -   -   -   o   o   o\n   \
    \                           Table 1\n   Syntactically, there may be multiple P-Asserted-Service\
    \ header fields\n   in a request.  The semantics of multiple P-Asserted-Service\
    \ header\n   fields appearing in the same request is not defined at this time.\n\
    \   Implementations of this specification MUST provide only one\n   P-Asserted-Service\
    \ header field value.\n"
- title: 4.2.  The P-Preferred-Service Header
  contents:
  - "4.2.  The P-Preferred-Service Header\n   The P-Preferred-Service header field\
    \ is used by a user agent sending\n   the SIP request to provide a hint to a trusted\
    \ proxy of the preferred\n   service that the user wishes to be used for the P-Asserted-Service\n\
    \   field value that the trusted element will insert.\n   The P-Preferred-Service\
    \ header field carries information that is\n   declarative service identification.\
    \  Such information should only be\n   used to assist in deriving a derived service\
    \ identification at the\n   recipient entity.\n         PPreferredService = \"\
    P-Preferred-Service\"\n                             HCOLON PPreferredService-value\n\
    \         PPreferredService-value = Service-ID *(COMMA Service-ID)\n   See Section\
    \ 4.4 for the definition of Service-ID in ABNF.\n   Table 2 adds the header fields\
    \ defined in this document to Table 2 in\n   SIP [RFC3261], Section 7.1 of the\
    \ SIP-specific event notification\n   [RFC3265], Tables 1 and 2 in the SIP INFO\
    \ method [RFC2976], Tables 1\n   and 2 in Reliability of provisional responses\
    \ in SIP [RFC3262],\n   Tables 1 and 2 in the SIP UPDATE method [RFC3311], Tables\
    \ 1 and 2 in\n   the SIP extension for Instant Messaging [RFC3428], Table 1 in\
    \ the SIP\n   REFER method [RFC3515], and Tables 2 and 3 in the SIP PUBLISH method\n\
    \   [RFC3903]:\n         Header field          where  proxy  ACK BYE CAN INV OPT\
    \ REG SUB\n         _______________________________________________________________\n\
    \         P-Preferred-Service     R      dr    -   -   -   o   o   -   o\n   \
    \      Header field                        NOT PRA INF UPD MSG REF PUB\n     \
    \    _______________________________________________________________\n       \
    \  P-Preferred-Service                  -   -   -   -   o   o   o\n          \
    \                    Table 2\n   Syntactically, there may be multiple P-Preferred-Service\
    \ header\n   fields in a request.  The semantics of multiple P-Preferred-Service\n\
    \   header fields appearing in the same request is not defined at this\n   time.\
    \  Implementations of this specification MUST only provide one\n   P-Preferred-Service\
    \ header field value.\n"
- title: 4.3.  Service and Application Definition
  contents:
  - "4.3.  Service and Application Definition\n   Service definitions and characteristics\
    \ are outside the scope of this\n   document.  Other standards organizations,\
    \ vendors, and operators may\n   define their own services and register them.\n\
    \   A hierarchical structure is defined consisting of service identifiers\n  \
    \ or application identifiers, and subservice identifiers.\n   The service and\
    \ subservice identifiers are as described in Section 1.\n   The URN may also be\
    \ used to identify a service or an application\n   between end users for use within\
    \ the context of RFC 3840 [RFC3840]\n   and RFC 3841 [RFC3841].\n   IANA maintains\
    \ a registry of service identifier values that have been\n   assigned.  This registry\
    \ has been created by the actions of Section\n   8.2 of this document.\n   subservice\
    \ identifiers are not managed by IANA.  It is the\n   responsibility of the organization\
    \ that registered the service to\n   manage the subservices.\n"
- title: 4.4.  Registration Template
  contents:
  - "4.4.  Registration Template\n   Below, we include the registration template for\
    \ the URN scheme\n   according to RFC 3406 [RFC3406].  The URN scheme is defined\
    \ as an\n   informal Namespace ID (NID).\n   Namespace ID:  urn-7\n   Registration\
    \ Information:\n      Registration version: 1; registration date: 2009-03-22\n\
    \   Declared registrant of the namespace:  3GPP Specifications Manager\n     \
    \ (3gppContact@etsi.org) (+33 (0)492944200)\n   Declaration of syntactic structure:\
    \  The URN consists of a\n      hierarchical service identifier or application\
    \ identifier, with a\n      sequence of labels separated by periods.  The leftmost\
    \ label is\n      the most significant one and is called 'top-level service\n\
    \      identifier', while names to the right are called 'subservices' or\n   \
    \   'sub-applications'.  The set of allowable characters is the same\n      as\
    \ that for domain names (see RFC 1123 [RFC1123]) and a subset of\n      the labels\
    \ allowed in RFC 3958 [RFC3958].  Labels are case-\n      insensitive and MUST\
    \ be specified in all lowercase.  For any given\n      service identifier, labels\
    \ can be removed right-to-left and the\n      resulting URN is still valid, referring\
    \ a more generic service,\n      with the exception of the top-level service identifier\
    \ and\n      possibly the first subservice or sub-application identifier.\n  \
    \    Labels cannot be removed beyond a defined basic service; for\n      example,\
    \ the label w.x may define a service, but the label w may\n      only define an\
    \ assignment authority for assigning subsequent\n      values and not define a\
    \ service in its own right.  In other words,\n      if a service identifier 'w.x.y.z'\
    \ exists, the URNs 'w.x' and\n      'w.x.y' are also valid service identifiers,\
    \ but w may not be a\n      valid service identifier if it merely defines who\
    \ is responsible\n      for defining x.\n        Service-ID      = \"urn:urn-7:\"\
    \ urn-service-id\n        urn-service-id  = top-level *(\".\" sub-service-id)\n\
    \        top-level       = let-dig [ *26let-dig ]\n        sub-service-id  = let-dig\
    \ [ *let-dig ]\n        let-dig         = ALPHA / DIGIT / \"-\"\n      While the\
    \ naming convention above uses the term \"service\", all the\n      constructs\
    \ are equally applicable to identifying applications\n      within the UA.\n \
    \  Relevant ancillary documentation:  None\n   Identifier uniqueness considerations:\
    \  A service identifier\n      identifies a service, and an application identifier\
    \ an application\n      indicated in the service or application registration (see\
    \ IANA\n      Considerations (Section 8)).  Uniqueness is guaranteed by the IANA\n\
    \      registration.\n   Identifier persistence considerations:  The service or\
    \ application\n      identifier for the same service or application is expected\
    \ to be\n      persistent, although there naturally cannot be a guarantee that\
    \ a\n      particular service will continue to be available globally or at\n \
    \     all times.\n   Process of identifier assignment:  The process of identifier\n\
    \      assignment is described in the IANA Considerations (Section 8).\n   Process\
    \ for identifier resolution:  There is no single global\n      resolution service\
    \ for service identifiers or application\n      identifiers.\n   Rules for lexical\
    \ equivalence:  'service' identifiers are compared\n      according to case-insensitive\
    \ string equality.\n   Conformance with URN syntax:  The BNF in the 'Declaration\
    \ of\n      syntactic structure' above constrains the syntax for this URN\n  \
    \    scheme.\n   Validation mechanism:  Validation determines whether a given\
    \ string\n      is currently a validly assigned URN (see RFC 3406 [RFC3406]).\
    \  Due\n      to the distributed nature of usage and since not all services are\n\
    \      available everywhere, validation in this sense is not possible.\n   Scope:\
    \  The scope for this URN can be local to a single domain, or\n      may be more\
    \ widely used.\n"
- title: 5.  Usage of the P-Preferred-Service and P-Asserted-Service Header
  contents:
  - "5.  Usage of the P-Preferred-Service and P-Asserted-Service Header\n    Fields\n"
- title: 5.1.  Usage of the P-Preferred-Service and P-Asserted-Service Header
  contents:
  - "5.1.  Usage of the P-Preferred-Service and P-Asserted-Service Header\n      Fields\
    \ in Requests\n"
- title: 5.1.1.  Procedures at User Agent Clients (UAC)
  contents:
  - "5.1.1.  Procedures at User Agent Clients (UAC)\n   The UAC MAY insert a P-Preferred-Service\
    \ in a request that creates a\n   dialog, or a request outside of a dialog.  This\
    \ information can\n   assist the proxies in identifying appropriate service capabilities\
    \ to\n   apply to the call.  This information MUST NOT conflict with other SIP\n\
    \   or SDP information included in the request.  Furthermore, the SIP or\n   SDP\
    \ information needed to signal functionality of this service MUST\n   be present.\
    \  Thus, if a service requires a video component, then the\n   SDP has to include\
    \ the media line associated with that video\n   component; it cannot be assumed\
    \ from the P-Preferred-Service header\n   field value.  Similarly, if the service\
    \ requires particular SIP\n   functionality for which a SIP extension and a Require\
    \ header field\n   value is defined, then the request has to include that SIP\
    \ signaling\n   as well as the P-Preferred-Service header field value.\n   A UAC\
    \ that is within the same trust domain as the proxy to which it\n   sends a request\
    \ (e.g., a media gateway or application server) MAY\n   insert a P-Asserted-Service\
    \ header field in a request that creates a\n   dialog, or a request outside of\
    \ a dialog.  This information MUST NOT\n   conflict with other SIP or SDP information\
    \ included in the request.\n   Furthermore, the SIP or SDP information needed\
    \ to signal\n   functionality of this service MUST be present.\n"
- title: 5.1.2.  Procedures at Intermediate Proxies
  contents:
  - "5.1.2.  Procedures at Intermediate Proxies\n   A proxy in a trust domain can\
    \ receive a request from a node that it\n   trusts or a node that it does not\
    \ trust.  When a proxy receives a\n   request from a node it does not trust and\
    \ it wishes to add a\n   P-Asserted-Service header field, the proxy MUST identify\
    \ the service\n   appropriate to the capabilities (e.g., SDP) in the request,\
    \ MAY\n   authenticate the originator of the request (in order to determine\n\
    \   whether the user is subscribed for that service).  Where the\n   originator\
    \ of the request is authenticated, the proxy MUST use the\n   identity that results\
    \ from this checking and authentication to insert\n   a P-Asserted-Service header\
    \ field into the request.\n   When a proxy receives a request containing a P-Preferred-Service\n\
    \   header field, the Proxy MAY use the contents of that header field to\n   assist\
    \ in determining the service to be included in a P-Asserted-\n   Service header\
    \ field (for instance, to prioritize the order of\n   comparison of filter criteria\
    \ for potential services that the request\n   could match).  The proxy MUST NOT\
    \ use the contents of the\n   P-Preferred-Service header field to identify the\
    \ service without\n   first checking against the capabilities (e.g., SDP) contained\
    \ in the\n   request.  If the proxy inserts a P-Asserted-Service header field\
    \ in\n   the request, the proxy MUST remove the P-Preferred-Service header\n \
    \  field before forwarding the request; otherwise, the Proxy SHOULD\n   include\
    \ the P-Preferred-Service header field when forwarding the\n   request.\n   If\
    \ the proxy receives a request from a node that it trusts, it can\n   use the\
    \ information in the P-Asserted-Service header field, if any,\n   as if it had\
    \ authenticated the user itself.\n   If there is no P-Asserted-Service header\
    \ field present, or it is not\n   possible to match the request to a specific\
    \ service as identified by\n   the service identifier, a proxy MAY add one containing\
    \ it using its\n   own analysis of the information contained in the SIP request.\
    \  If the\n   proxy received the request from an element that it does not trust\
    \ and\n   there is a P-Asserted-Service header present, the proxy MUST replace\n\
    \   that header field's contents with a new analysis or remove that\n   header\
    \ field.\n   The analysis performed to identify such service identifiers is\n\
    \   outside the scope of this document.  However, it is perfectly valid\n   as\
    \ a result of the analysis not to include any service identifier in\n   the forwarded\
    \ request, and thus not include a P-Asserted-Service\n   header field.\n   If\
    \ a proxy forwards a request to a node outside the proxy's trust\n   domain, there\
    \ MUST NOT be a P-Asserted-Service header field in the\n   forwarded request.\n"
- title: 5.1.3.  Procedures at User Agent Servers
  contents:
  - "5.1.3.  Procedures at User Agent Servers\n   For a User Agent Server (UAS) outside\
    \ the trust domain, the\n   P-Asserted-Service header is removed before it reaches\
    \ this entity;\n   therefore, there are no procedures for such a device.\n   However,\
    \ if a UAS receives a request from a previous element that it\n   does not trust,\
    \ it MUST NOT use the P-Asserted-Service header field\n   in any way.\n   If a\
    \ UA is part of the trust domain from which it received a request\n   containing\
    \ a P-Asserted-Service header field, then it can use the\n   value freely, but\
    \ it MUST ensure that it does not forward the\n   information to any element that\
    \ is not part of the trust domain.\n"
- title: 5.2.  Usage of the P-Preferred-Service and P-Asserted-Service Header
  contents:
  - "5.2.  Usage of the P-Preferred-Service and P-Asserted-Service Header\n      Fields\
    \ in Responses\n   There is no usage of these header fields in responses.\n"
- title: 6.  Examples of Usage
  contents:
  - "6.  Examples of Usage\n   In this example, proxy.example.com creates a P-Asserted-Service\n\
    \   header field from the user identity it discovered from SIP digest\n   authentication,\
    \ the list of services appropriate to that user, and\n   the services that correspond\
    \ to the SDP information included in the\n   request.  Note that F1 and F2 are\
    \ about identifying the user and do\n   not directly form part of the capability\
    \ provided in this document.\n   It forwards this information to a trusted proxy\
    \ that forwards it to a\n   trusted gateway.  Note that these examples consist\
    \ of partial SIP\n   messages that illustrate only those header fields relevant\
    \ to the\n   authenticated identity problem.\n      * F1   useragent.example.com\
    \ -> proxy.example.com\n      INVITE sip:+14085551212@example.com SIP/2.0\n  \
    \    Via: SIP/2.0/TCP useragent.example.com;branch=z9hG4bK-123\n      To: <sip:+14085551212@example.com>\n\
    \      From: \"Anonymous\" <sip:anonymous@anonymous.invalid>;tag=9802748\n   \
    \   Call-ID: 245780247857024504\n      CSeq: 1 INVITE\n      Max-Forwards: 70\n\
    \      v=0\n      o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd\n   \
    \   s=-\n      c=IN IP6 5555::aaa:bbb:ccc:ddd\n      t=0 0\n      m=audio 3456\
    \ RTP/AVPF 97 96\n      b=AS:25.4\n      a=curr:qos local sendrecv\n      a=curr:qos\
    \ remote none\n      a=des:qos mandatory local sendrecv\n      a=des:qos mandatory\
    \ remote sendrecv\n      a=sendrecv\n      a=rtpmap:97 AMR\n      a=fmtp:97 mode-set=0,2,5,7;\
    \ maxframes\n      * F2   proxy.example.com -> useragent.example.com\n      SIP/2.0\
    \ 407 Proxy Authorization\n      Via: SIP/2.0/TCP useragent.example.com;branch=z9hG4bK-123\n\
    \      To: <sip:+14085551212@example.com>;tag=123456\n      From: \"Anonymous\"\
    \ <sip:anonymous@anonymous.invalid>;tag=9802748\n      Call-ID: 245780247857024504\n\
    \      CSeq: 1 INVITE\n      Proxy-Authenticate: .... realm=\"sip.example.com\"\
    \n      * F3   useragent.example.com -> proxy.example.com\n      INVITE sip:+14085551212@example.com\
    \ SIP/2.0\n      Via: SIP/2.0/TCP useragent.example.com;branch=z9hG4bK-124\n \
    \     To: <sip:+14085551212@example.com>\n      From: \"Anonymous\" <sip:anonymous@anonymous.invalid>;tag=9802748\n\
    \      Call-ID: 245780247857024504\n      CSeq: 2 INVITE\n      Max-Forwards:\
    \ 70\n      Proxy-Authorization: realm=\"sip.example.com\" user=\"fluffy\"\n \
    \     v=0\n      o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd\n    \
    \  s=-\n      c=IN IP6 5555::aaa:bbb:ccc:ddd\n      t=0 0\n      m=audio 3456\
    \ RTP/AVPF 97 96\n      b=AS:25.4\n      a=curr:qos local sendrecv\n      a=curr:qos\
    \ remote none\n      a=des:qos mandatory local sendrecv\n      a=des:qos mandatory\
    \ remote sendrecv\n      a=sendrecv\n      a=rtpmap:97 AMR\n      a=fmtp:97 mode-set=0,2,5,7;\
    \ maxframes\n    * F4   proxy.example.com -> proxy.pstn.example (trusted)\n  \
    \  INVITE sip:+14085551212@proxy. pstn.example SIP/2.0\n    Via: SIP/2.0/TCP useragent.example.com;branch=z9hG4bK-124\n\
    \    Via: SIP/2.0/TCP proxy.example.com;branch=z9hG4bK-abc\n    To: <sip:+14085551212@example.com>\n\
    \    From: \"Anonymous\" <sip:anonymous@anonymous.invalid>;tag=9802748\n    Call-ID:\
    \ 245780247857024504\n    CSeq: 2 INVITE\n    Max-Forwards: 69\n    P-Asserted-Service:\
    \ urn:urn-7:3gpp-service.exampletelephony.version1\n    v=0\n    o=- 2987933615\
    \ 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd\n    s=-\n    c=IN IP6 5555::aaa:bbb:ccc:ddd\n\
    \    t=0 0\n    m=audio 3456 RTP/AVPF 97 96\n    b=AS:25.4\n    a=curr:qos local\
    \ sendrecv\n    a=curr:qos remote none\n    a=des:qos mandatory local sendrecv\n\
    \    a=des:qos mandatory remote sendrecv\n    a=sendrecv\n    a=rtpmap:97 AMR\n\
    \    a=fmtp:97 mode-set=0,2,5,7; maxframes\n    * F5   proxy.pstn.example -> gw.pstn.example\
    \ (trusted)\n    INVITE sip:+14085551212@gw.pstn.example SIP/2.0\n    Via: SIP/2.0/TCP\
    \ useragent.example.com;branch=z9hG4bK-124\n    Via: SIP/2.0/TCP proxy.example.com;branch=z9hG4bK-abc\n\
    \    Via: SIP/2.0/TCP proxy.pstn.example;branch=z9hG4bK-a1b2\n    To: <sip:+14085551212@example.com>\n\
    \    From: \"Anonymous\" <sip:anonymous@anonymous.invalid>;tag=9802748\n    Call-ID:\
    \ 245780247857024504\n    CSeq: 2 INVITE\n    Max-Forwards: 68\n    P-Asserted-Service:\
    \ urn:urn-7:3gpp-service.exampletelephony.version1\n    v=0\n    o=- 2987933615\
    \ 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd\n    s=-\n    c=IN IP6 5555::aaa:bbb:ccc:ddd\n\
    \    t=0 0\n    m=audio 3456 RTP/AVPF 97 96\n    b=AS:25.4\n    a=curr:qos local\
    \ sendrecv\n    a=curr:qos remote none\n    a=des:qos mandatory local sendrecv\n\
    \    a=des:qos mandatory remote sendrecv\n    a=sendrecv\n    a=rtpmap:97 AMR\n\
    \    a=fmtp:97 mode-set=0,2,5,7; maxframes\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   The mechanism provided in this document is a\
    \ partial consideration of\n   the problem of service identification in SIP. \
    \ For example, these\n   mechanisms provide no means by which end users can securely\
    \ share\n   service information end-to-end without a trusted service provider.\n\
    \   This information is secured by transitive trust, which is only as\n   reliable\
    \ as the weakest link in the chain of trust.\n   The trust domain provides a set\
    \ of servers where the characteristics\n   of the service are agreed for that\
    \ service identifier value, and\n   where the calling user is entitled to use\
    \ that service.  RFC 5897\n   [RFC5897] identifies the impact of allowing such\
    \ service identifier\n   values to \"leak\" outside of the trust domain, including\
    \ implications\n   on fraud, interoperability, and stifling of service innovation.\n"
- title: 8.  IANA Considerations
  contents:
  - '8.  IANA Considerations

    '
- title: 8.1.  P-Asserted-Service and P-Preferred-Service Header Fields
  contents:
  - "8.1.  P-Asserted-Service and P-Preferred-Service Header Fields\n   This document\
    \ specifies two new SIP header fields: P-Asserted-Service\n   and P-Preferred-Service.\
    \  Their syntax is given in Section 3.  These\n   header fields are defined by\
    \ the following information, which has\n   been added to the header sub-registry\
    \ under http://www.iana.org.\n        Header Name        compact    Reference\n\
    \        -----------------  -------    ---------\n        P-Asserted-Service \
    \           RFC 6050\n        P-Preferred-Service           RFC 6050\n"
- title: 8.2.  Definition of Service-ID Values
  contents:
  - "8.2.  Definition of Service-ID Values\n   Top-level identifiers are identified\
    \ by labels managed by IANA,\n   according to the processes outlined in RFC 5226\
    \ [RFC5226], in a new\n   registry called \"Service-ID/Application-ID Labels\"\
    .  Thus, creating a\n   new service at the top-level requires IANA action.  The\
    \ policy for\n   adding service labels is 'specification required'.  The following\
    \ two\n   identifiers are initially defined:\n      3gpp-service\n      3gpp-application\n\
    \   subservice identifiers are not managed by IANA.  It is the\n   responsibility\
    \ of the organization that registered the service to\n   manage the subservices.\n\
    \   Application identifiers are not managed by IANA.  It is the\n   responsibility\
    \ of the organization that registered the service to\n   manage the applicable\
    \ applications.\n   Entries in the registration table have the following format:\n\
    \   Service/Application   Description                          Reference\n   --------------------------------------------------------------------\n\
    \   3gpp-service          Communication services defined by    RFC 6050\n    \
    \                     3GPP for use by the IM CN subsystem\n                  \
    \       and its attached UAs.  This value\n                         in itself\
    \ does not define a service\n                         and requires subsequent\
    \ labels to\n                         define the service.\n   3gpp-application\
    \      Applications defined by 3GPP for     RFC 6050\n                       \
    \  use by UAs attached to the IM CN\n                         subsystem. This\
    \ value in itself\n                         does not define a service and\n  \
    \                       requires subsequent labels to define\n               \
    \          the service.\n   Here, the IM CN subsystem stands for the IP Multimedia\
    \ Core Network\n   subsystem.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC1123]  Braden, R., \"Requirements for Internet\
    \ Hosts - Application\n              and Support\", STD 3, RFC 1123, October 1989.\n\
    \   [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n        \
    \      Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC3261]  Rosenberg,\
    \ J., Schulzrinne, H., Camarillo, G., Johnston,\n              A., Peterson, J.,\
    \ Sparks, R., Handley, M., and E.\n              Schooler, \"SIP: Session Initiation\
    \ Protocol\", RFC 3261,\n              June 2002.\n   [RFC3324]  Watson, M., \"\
    Short Term Requirements for Network Asserted\n              Identity\", RFC 3324,\
    \ November 2002.\n   [RFC3406]  Daigle, L., van Gulik, D., Iannella, R., and P.\
    \ Faltstrom,\n              \"Uniform Resource Names (URN) Namespace Definition\n\
    \              Mechanisms\", BCP 66, RFC 3406, October 2002.\n   [RFC3958]  Daigle,\
    \ L. and A. Newton, \"Domain-Based Application\n              Service Location\
    \ Using SRV RRs and the Dynamic Delegation\n              Discovery Service (DDDS)\"\
    , RFC 3958, January 2005.\n   [RFC5226]  Narten, T. and H. Alvestrand, \"Guidelines\
    \ for Writing an\n              IANA Considerations Section in RFCs\", BCP 26,\
    \ RFC 5226,\n              May 2008.\n   [RFC5234]  Crocker, D. and P. Overell,\
    \ \"Augmented BNF for Syntax\n              Specifications: ABNF\", STD 68, RFC\
    \ 5234, January 2008.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [RFC2976]  Donovan, S., \"The SIP INFO Method\"\
    , RFC 2976,\n              October 2000.\n   [RFC3262]  Rosenberg, J. and H. Schulzrinne,\
    \ \"Reliability of\n              Provisional Responses in Session Initiation\
    \ Protocol\n              (SIP)\", RFC 3262, June 2002.\n   [RFC3265]  Roach,\
    \ A., \"Session Initiation Protocol (SIP)-Specific\n              Event Notification\"\
    , RFC 3265, June 2002.\n   [RFC3311]  Rosenberg, J., \"The Session Initiation\
    \ Protocol (SIP)\n              UPDATE Method\", RFC 3311, October 2002.\n   [RFC3428]\
    \  Campbell, B., Rosenberg, J., Schulzrinne, H., Huitema, C.,\n              and\
    \ D. Gurle, \"Session Initiation Protocol (SIP) Extension\n              for Instant\
    \ Messaging\", RFC 3428, December 2002.\n   [RFC3515]  Sparks, R., \"The Session\
    \ Initiation Protocol (SIP) Refer\n              Method\", RFC 3515, April 2003.\n\
    \   [RFC3840]  Rosenberg, J., Schulzrinne, H., and P. Kyzivat,\n             \
    \ \"Indicating User Agent Capabilities in the Session\n              Initiation\
    \ Protocol (SIP)\", RFC 3840, August 2004.\n   [RFC3841]  Rosenberg, J., Schulzrinne,\
    \ H., and P. Kyzivat, \"Caller\n              Preferences for the Session Initiation\
    \ Protocol (SIP)\",\n              RFC 3841, August 2004.\n   [RFC3903]  Niemi,\
    \ A., \"Session Initiation Protocol (SIP) Extension\n              for Event State\
    \ Publication\", RFC 3903, October 2004.\n   [RFC5688]  Rosenberg, J., \"A Session\
    \ Initiation Protocol (SIP) Media\n              Feature Tag for MIME Application\
    \ Subtypes\", RFC 5688,\n              January 2010.\n   [RFC5897]  Rosenberg,\
    \ J., \"Identification of Communications Services\n              in the Session\
    \ Initiation Protocol (SIP)\", RFC 5897,\n              June 2010.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Keith Drage\n   Alcatel-Lucent\n   Quadrant, Stonehill Green,\
    \ Westlea\n   Swindon, Wilts\n   UK\n   EMail: drage@alcatel-lucent.com\n"
