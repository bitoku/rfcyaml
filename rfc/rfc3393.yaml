- title: __initial_text__
  contents:
  - "                    IP Packet Delay Variation Metric\n                   for\
    \ IP Performance Metrics (IPPM)\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2002).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document refers to a metric for variation in delay of packets\n\
    \   across Internet paths.  The metric is based on the difference in the\n   One-Way-Delay\
    \ of selected packets.  This difference in delay is\n   called \"IP Packet Delay\
    \ Variation (ipdv)\".\n   The metric is valid for measurements between two hosts\
    \ both in the\n   case that they have synchronized clocks and in the case that\
    \ they are\n   not synchronized.  We discuss both in this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n         2.7.1 Errors/Uncertainties related to Clocks.................11\n\
    \         2.7.2 Errors/uncertainties related to Wire-time vs Host-time.12\n  \
    \ 3 Definitions for Samples of One-way-ipdv..........................12\n    \
    \ 3.1 Metric name..................................................12\n     3.2\
    \ Parameters...................................................12\n     3.3 Metric\
    \ Units.................................................13\n     3.4 Definition...................................................13\n\
    \     3.5 Discussion...................................................13\n  \
    \   3.6 Methodology..................................................14\n    \
    \ 3.7 Errors and uncertainties.....................................14\n   4 Statistics\
    \ for One-way-ipdv......................................14\n     4.1 Lost Packets\
    \ and ipdv statistics.............................15\n     4.2 Distribution of\
    \ One-way-ipdv values..........................15\n     4.3 Type-P-One-way-ipdv-percentile...............................16\n\
    \     4.4 Type-P-One-way-ipdv-inverse-percentile.......................16\n  \
    \   4.5 Type-P-One-way-ipdv-jitter...................................16\n    \
    \ 4.6 Type-P-One-way-peak-to-peak-ipdv.............................16\n   5 Discussion\
    \ of clock synchronization..............................17\n     5.1 Effects of\
    \ synchronization errors............................17\n     5.2 Estimating the\
    \ skew of unsynchronized clocks.................18\n   6 Security Considerations..........................................18\n\
    \     6.1 Denial of service............................................18\n  \
    \   6.2 Privacy/Confidentiality......................................18\n    \
    \ 6.3 Integrity....................................................19\n   7 Acknowledgments..................................................19\n\
    \   8 References.......................................................19\n  \
    \    8.1 Normative References........................................19\n    \
    \  8.2 Informational References....................................19\n   9 Authors'\
    \ Addresses...............................................20\n   10 Full Copyright\
    \ Statement........................................21\n"
- title: 1. Introduction
  contents:
  - "1. Introduction\n   This memo defines a metric for the variation in delay of\
    \ packets that\n   flow from one host to another through an IP path.  It is based\
    \ on \"A\n   One-Way-Delay metric for IPPM\", RFC 2679 [2] and part of the text\
    \ in\n   this memo is taken directly from that document; the reader is assumed\n\
    \   to be familiar with that document.\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\" and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in BCP 14, RFC 2119 [3].\n   Although BCP 14, RFC 2119 was written with protocols\
    \ in mind, the key\n   words are used in this document for similar reasons.  They\
    \ are used\n   to ensure the results of measurements from two different\n   implementations\
    \ are comparable and to note instances where an\n   implementation could perturb\
    \ the network.\n   The structure of the memo is as follows:\n   +  A 'singleton'\
    \ analytic metric, called Type-P-One-way-ipdv, will be\n      introduced to define\
    \ a single instance of an ipdv measurement.\n   +  Using this singleton metric,\
    \ a 'sample', called Type-P-one-way-\n      ipdv-Poisson-stream, will be introduced\
    \ to make it possible to\n      compute the statistics of sequences of ipdv measurements.\n\
    \   +  Using this sample, several 'statistics' of the sample will be\n      defined\
    \ and discussed\n"
- title: 1.1. Terminology
  contents:
  - "1.1. Terminology\n   The variation in packet delay is sometimes called \"jitter\"\
    .  This\n   term, however, causes confusion because it is used in different ways\n\
    \   by different groups of people.\n   \"Jitter\" commonly has two meanings: The\
    \ first meaning is the\n   variation of a signal with respect to some clock signal,\
    \ where the\n   arrival time of the signal is expected to coincide with the arrival\n\
    \   of the clock signal.  This meaning is used with reference to\n   synchronous\
    \ signals and might be used to measure the quality of\n   circuit emulation, for\
    \ example.  There is also a metric called\n   \"wander\" used in this context.\n\
    \   The second meaning has to do with the variation of a metric (e.g.,\n   delay)\
    \ with respect to some reference metric (e.g., average delay or\n   minimum delay).\
    \  This meaning is frequently used by computer\n   scientists and frequently (but\
    \ not always) refers to variation in\n   delay.\n   In this document we will avoid\
    \ the term \"jitter\" whenever possible\n   and stick to delay variation which\
    \ is more precise.\n"
- title: 1.2. Definition
  contents:
  - "1.2. Definition\n   A definition of the IP Packet Delay Variation (ipdv) can\
    \ be given for\n   packets inside a stream of packets.\n   The ipdv of a pair\
    \ of packets within a stream of packets is defined\n   for a selected pair of\
    \ packets in the stream going from measurement\n   point MP1 to measurement point\
    \ MP2.\n   The ipdv is the difference between the one-way-delay of the selected\n\
    \   packets.\n"
- title: 1.3. Motivation
  contents:
  - "1.3. Motivation\n   One important use of delay variation is the sizing of play-out\n\
    \   buffers for applications requiring the regular delivery of packets\n   (for\
    \ example, voice or video play-out).  What is normally important\n   in this case\
    \ is the maximum delay variation, which is used to size\n   play-out buffers for\
    \ such applications [7].  Other uses of a delay\n   variation metric are, for\
    \ example, to determine the dynamics of\n   queues within a network (or router)\
    \ where the changes in delay\n   variation can be linked to changes in the queue\
    \ length process at a\n   given link or a combination of links.\n   In addition,\
    \ this type of metric is particularly robust with respect\n   to differences and\
    \ variations of the clocks of the two hosts.  This\n   allows the use of the metric\
    \ even if the two hosts that support the\n   measurement points are not synchronized.\
    \  In the latter case\n   indications of reciprocal skew of the clocks can be\
    \ derived from the\n   measurement and corrections are possible.  The related\
    \ precision is\n   often comparable with the one that can be achieved with synchronized\n\
    \   clocks, being of the same order of magnitude of synchronization\n   errors.\
    \  This will be discussed below.\n   The scope of this document is to provide\
    \ a way to measure the ipdv\n   delivered on a path.  Our goal is to provide a\
    \ metric which can be\n   parameterized so that it can be used for various purposes.\
    \  Any\n   report of the metric MUST include all the parameters associated with\n\
    \   it so that the conditions and meaning of the metric can be determined\n  \
    \ exactly.  Since the metric does not represent a value judgment (i.e.,\n   define\
    \ \"good\" and \"bad\"), we specifically do not specify particular\n   values\
    \ of the metrics that IP networks must meet.\n   The flexibility of the metric\
    \ can be viewed as a disadvantage but\n   there are some arguments for making\
    \ it flexible.  First, though there\n   are some uses of ipdv mentioned above,\
    \ to some degree the uses of\n   ipdv are still a research topic and some room\
    \ should be left for\n   experimentation.  Secondly, there are different views\
    \ in the\n   community of what precisely the definition should be (e.g.,\n   [8],[9],[10]).\
    \  The idea here is to parameterize the definition,\n   rather than write a different\
    \ document for each proposed definition.\n   As long as all the parameters are\
    \ reported, it will be clear what is\n   meant by a particular use of ipdv.  All\
    \ the remarks in the document\n   hold, no matter which parameters are chosen.\n"
- title: 1.4. General Issues Regarding Time
  contents:
  - "1.4. General Issues Regarding Time\n   Everything contained in Section 2.2. of\
    \ [2] applies also in this\n   case.\n   To summarize: As in [1] we define \"\
    skew\" as the first derivative of\n   the offset of a clock with respect to \"\
    true time\" and define \"drift\"\n   as the second derivative of the offset of\
    \ a clock with respect to\n   \"true time\".\n   From there, we can construct\
    \ \"relative skew\" and \"relative drift\" for\n   two clocks C1 and C2 with respect\
    \ to one another.  These are natural\n   extensions of the basic framework definitions\
    \ of these quantities:\n   +  Relative offset = difference in clock times\n  \
    \ +  Relative skew = first derivative of the difference in clock times\n   + \
    \ Relative drift = second derivative of the difference in clock\n      times\n\
    \   NOTE: The drift of a clock, as it is above defined over a long period\n  \
    \ must have an average value that tends to zero while the period\n   becomes large\
    \ since the frequency of the clock has a finite (and\n   small) range.  In order\
    \ to underline the order of magnitude of this\n   effect,it is considered that\
    \ the maximum range of drift for\n   commercial crystals is about 50 part per\
    \ million (ppm).  Since it is\n   mainly connected with variations in operating\
    \ temperature (from 0 to\n   70 degrees Celsius), it is expected that a host will\
    \ have a nearly\n   constant temperature during its operation period, and variations\
    \ in\n   temperature, even if quick, could be less than one Celsius per\n   second,\
    \ and range in the order of a few degrees.  The total range of\n   the drift is\
    \ usually related to variations from 0 to 70 Celsius.\n   These are important\
    \ points for evaluation of precision of ipdv\n   measurements, as will be seen\
    \ below.\n"
- title: 2. A singleton definition of a One-way-ipdv metric
  contents:
  - "2. A singleton definition of a One-way-ipdv metric\n   The purpose of the singleton\
    \ metric is to define what a single\n   instance of an ipdv measurement is.  Note\
    \ that it can only be\n   statistically significant in combination with other\
    \ instances.  It is\n   not intended to be meaningful as a singleton, in the sense\
    \ of being\n   able to draw inferences from it.\n   This definition makes use\
    \ of the corresponding definition of type-P-\n   One-Way-Delay metric [2].  This\
    \ section makes use of those parts of\n   the One-Way-Delay Draft that directly\
    \ apply to the One-Way-ipdv\n   metric, or makes direct references to that Draft.\n"
- title: 2.1. Metric name
  contents:
  - "2.1. Metric name\n   Type-P-One-way-ipdv\n"
- title: 2.2. Metric parameters
  contents:
  - "2.2. Metric parameters\n   +  Src, the IP address of a host\n   +  Dst, the IP\
    \ address of a host\n   +  T1, a time\n   +  T2, a time\n   +  L, a packet length\
    \ in bits.  The packets of a Type P packet stream\n      from which the singleton\
    \ ipdv metric is taken MUST all be of the\n      same length.\n   +  F, a selection\
    \ function defining unambiguously the two packets\n      from the stream selected\
    \ for the metric.\n   +  I1,I2, times which mark that beginning and ending of\
    \ the interval\n      in which the packet stream from which the singleton measurement\
    \ is\n      taken occurs.\n   +  P, the specification of the packet type, over\
    \ and above the source\n      and destination addresses\n"
- title: 2.3. Metric unit
  contents:
  - "2.3. Metric unit\n   The value of a Type-P-One-way-ipdv is either a real number\
    \ of seconds\n   (positive, zero or negative) or an undefined number of seconds.\n"
- title: 2.4. Definition
  contents:
  - "2.4. Definition\n   We are given a Type P packet stream and I1 and I2 such that\
    \ the first\n   Type P packet to pass measurement point MP1 after I1 is given\
    \ index 0\n   and the last Type P packet to pass measurement point MP1 before\
    \ I2 is\n   given the highest index number.\n   Type-P-One-way-ipdv is defined\
    \ for two packets from Src to Dst\n   selected by the selection function F, as\
    \ the difference between the\n   value of the type-P-One-way-delay from Src to\
    \ Dst at T2 and the value\n   of the type-P-One-Way-Delay from Src to Dst at T1.\
    \  T1 is the wire-\n   time at which Scr sent the first bit of the first packet,\
    \ and T2 is\n   the wire-time at which Src sent the first bit of the second packet.\n\
    \   This metric is derived from the One-Way-Delay metric.\n   Therefore, for a\
    \ real number ddT \"The type-P-one-way-ipdv from Src to\n   Dst at T1, T2 is ddT\"\
    \ means that Src sent two packets, the first at\n   wire-time T1 (first bit),\
    \ and the second at wire-time T2 (first bit)\n   and the packets were received\
    \ by Dst at wire-time dT1+T1 (last bit of\n   the first packet), and at wire-time\
    \ dT2+T2 (last bit of the second\n   packet), and that dT2-dT1=ddT.\n   \"The\
    \ type-P-one-way-ipdv from Src to Dst at T1,T2 is undefined\" means\n   that Src\
    \ sent the first bit of a packet at T1 and the first bit of a\n   second packet\
    \ at T2 and that Dst did not receive one or both packets.\n   Figure 1 illustrates\
    \ this definition.  Suppose that packets P(i) and\n   P(k) are selected.\n   \
    \  I1  P(i)       P(j)                  P(k)                     I2\n   MP1 |--------------------------------------------------------------|\n\
    \           |\\        |\\                    |\\\n           | \\       | \\\
    \                   | \\\n           |  \\      |  \\                  |  \\\n\
    \           |   \\     |   \\                 |   \\\n           |dTi \\    |dTj\
    \ \\                |dTk \\\n           |<--->v   |<--->v               |<--->v\n\
    \   MP2 |--------------------------------------------------------------|\n   \
    \ I1          P(i)       P(j)                 P(k)               I2\n        \
    \             Figure 1: Illustration of the definition\n   Then ddT = dTk - dTi\
    \ as defined above.\n"
- title: 2.5. Discussion
  contents:
  - "2.5. Discussion\n   This metric definition depends on a stream of Type-P-One-Way-Delay\n\
    \   packets that have been measured.  In general this can be a stream of\n   two\
    \ or more packets, delimited by the interval endpoints I1 and I2.\n    There must\
    \ be a stream of at least two packets in order for a\n   singleton ipdv measurement\
    \ to take place.  The purpose of the\n   selection function is to specify exactly\
    \ which two packets from the\n   stream are to be used for the singleton measurement.\
    \  Note that the\n   selection function may involve observing the one-way-delay\
    \ of all the\n   Type P packets of the stream in the specified interval.  Examples\
    \ of\n   a selection function are:\n   +  Consecutive Type-P packets within the\
    \ specified interval\n   +  Type-P packets with specified indices within the specified\n\
    \      interval\n   +  Type-P packets with the min and max one-way-delays within\
    \ the\n      specified interval\n   +  Type-P packets with specified indices from\
    \ the set of all defined\n      (i.e., non-infinite) one-way-delays Type-P packets\
    \ within the\n      specified interval.\n      The following practical issues\
    \ have to be considered:\n   +  Being a differential measurement, this metric\
    \ is less sensitive to\n      clock synchronization problems.  This issue will\
    \ be more carefully\n      examined in section 5 of this memo.  It is pointed\
    \ out that, if\n      the relative clock conditions change in time, the accuracy\
    \ of the\n      measurement will depend on the time interval I2-I1 and the\n \
    \     magnitude of possible errors will be discussed below.\n   +  A given methodology\
    \ will have to include a way to determine\n      whether a delay value is infinite\
    \ or whether it is merely very\n      large (and the packet is yet to arrive at\
    \ Dst).  As noted by\n      Mahdavi and Paxson, simple upper bounds (such as the\
    \ 255 seconds\n      theoretical upper bound on the lifetimes of IP packets [Postel:\n\
    \      RFC 791]) could be used, but good engineering, including an\n      understanding\
    \ of packet lifetimes, will be needed in practice.\n      Comment: Note that,\
    \ for many applications of these metrics, the\n      harm in treating a large\
    \ delay as infinite might be zero or very\n      small.  A TCP data packet, for\
    \ example, that arrives only after\n      several multiples of the RTT may as\
    \ well have been lost.\n   +  As with other 'type-P' metrics, the value of the\
    \ metric may depend\n      on such properties of the packet as protocol,(UDP or\
    \ TCP) port\n      number, size, and arrangement for special treatment (as with\
    \ IP\n      precedence or with RSVP).\n   +  ddT is derived from the start of\
    \ the first bit out from a packet\n      sent out by Src to the reception of the\
    \ last bit received by Dst.\n      Delay is correlated to the size of the packet.\
    \  For this reason,\n      the packet size is a parameter of the measurement and\
    \ must be\n      reported along with the measurement.\n   +  If the packet is\
    \ duplicated along the path (or paths!) so that\n      multiple non-corrupt copies\
    \ arrive at the destination, then the\n      packet is counted as received, and\
    \ the first copy to arrive\n      determines the packet's One-Way-Delay.\n   +\
    \  If the packet is fragmented and if, for whatever reason,\n      re-assembly\
    \ does not occur, then the packet will be deemed lost.\n   In this document it\
    \ is assumed that the Type-P packet stream is\n   generated according to the Poisson\
    \ sampling methodology described in\n   [1].\n   The reason for Poisson sampling\
    \ is that it ensures an unbiased and\n   uniformly distributed sampling of times\
    \ between I1 and I2.  However,\n   alternate sampling methodologies are possible.\
    \  For example,\n   continuous sampling of a constant bit rate stream (i.e., periodic\n\
    \   packet transmission) is a possibility.  However, in this case, one\n   must\
    \ be sure to avoid any \"aliasing\" effects that may occur with\n   periodic samples.\n"
- title: 2.6. Methodologies
  contents:
  - "2.6. Methodologies\n   As with other Type-P-* metrics, the detailed methodology\
    \ will depend\n   on the Type-P (e.g., protocol number, UDP/TCP port number, size,\n\
    \   precedence).\n   The measurement methodology described in this section assumes\
    \ the\n   measurement and determination of ipdv in real-time as part of an\n \
    \  active measurement.  Note that this can equally well be done a\n   posteriori,\
    \ i.e., after the one-way-delay measurement is completed.\n   Generally, for a\
    \ given Type-P, the methodology would proceed as\n   follows: Note that this methodology\
    \ is based on synchronized clocks.\n   The need for synchronized clocks for Src\
    \ and Dst will be discussed\n   later.\n   +  Start after time I1.  At the Src\
    \ host, select Src and Dst IP\n      addresses, and form test packets of Type-P\
    \ with these addresses\n      according to a given technique (e.g., the Poisson\
    \ sampling\n      technique).  Any 'padding' portion of the packet needed only\
    \ to\n      make the test packet a given size should be filled with randomized\n\
    \      bits to avoid a situation in which the measured delay is lower\n      than\
    \ it would otherwise be due to compression techniques along the\n      path.\n\
    \   +  At the Dst host, arrange to receive the packets.\n   +  At the Src host,\
    \ place a time stamp in the Type-P packet, and send\n      it towards Dst.\n \
    \  +  If the packet arrives within a reasonable period of time, take a\n     \
    \ time stamp as soon as possible upon the receipt of the packet.  By\n      subtracting\
    \ the two time stamps, an estimate of One-Way-Delay can\n      be computed.\n\
    \   +  If the packet meets the selection function criterion for the first\n  \
    \    packet, record this first delay value.  Otherwise, continue\n      generating\
    \ the Type-P packet stream as above until the criterion\n      is met or I2, whichever\
    \ comes first.\n   +  At the Src host, packets continue to be generated according\
    \ to the\n      given methodology.  The Src host places a time stamp in the Type-P\n\
    \      packet, and send it towards Dst.\n   +  If the packet arrives within a\
    \ reasonable period of time, take a\n      time stamp as soon as possible upon\
    \ the receipt of the packet.  By\n      subtracting the two time stamps, an estimate\
    \ of One-Way-Delay can\n      be computed.\n   +  If the packet meets the criterion\
    \ for the second packet, then by\n      subtracting the first value of One-Way-Delay\
    \ from the second value\n      the ipdv value of the pair of packets is obtained.\
    \  Otherwise,\n      packets continue to be generated until the criterion for\
    \ the\n      second packet is fulfilled or I2, whichever comes first.\n   +  If\
    \ one or both packets fail to arrive within a reasonable period\n      of time,\
    \ the ipdv is taken to be undefined.\n"
- title: 2.7. Errors and Uncertainties
  contents:
  - "2.7. Errors and Uncertainties\n   In the singleton metric of ipdv, factors that\
    \ affect the measurement\n   are the same as those affecting the One-Way-Delay\
    \ measurement, even\n   if, in this case, the influence is different.\n   The\
    \ Framework document [1] provides general guidance on this point,\n   but we note\
    \ here the following specifics related to delay metrics:\n   +  Errors/uncertainties\
    \ due to uncertainties in the clocks of the Src\n      and Dst hosts.\n   +  Errors/uncertainties\
    \ due to the difference between 'wire time' and\n      'host time'.\n   Each of\
    \ these errors is discussed in more detail in the following\n   paragraphs.\n"
- title: 2.7.1. Errors/Uncertainties related to Clocks
  contents:
  - "2.7.1. Errors/Uncertainties related to Clocks\n   If, as a first approximation,\
    \ the error that affects the first\n   measurement of One-Way-Delay were the same\
    \ as the one affecting the\n   second measurement, they will cancel each other\
    \ when calculating\n   ipdv.  The residual error related to clocks is the difference\
    \ of the\n   errors that are supposed to change from time T1, at which the first\n\
    \   measurement is performed, to time T2 at which the second measurement\n   is\
    \ performed.  Synchronization, skew, accuracy and resolution are\n   here considered\
    \ with the following notes:\n   +  Errors in synchronization between source and\
    \ destination clocks\n      contribute to errors in both of the delay measurements\
    \ required\n      for calculating ipdv.\n   +  The effect of drift and skew errors\
    \ on ipdv measurements can be\n      quantified as follows: Suppose that the skew\
    \ and drift functions\n      are known.  Assume first that the skew function is\
    \ linear in time.\n      Clock offset is then also a function of time and the\
    \ error evolves\n      as e(t) = K*t + O, where K is a constant and O is the offset\
    \ at\n      time 0.  In this case, the error added to the subtraction of two\n\
    \      different time stamps (t2 > t1) is e(t2)-e(t1) = K*(t2 - t1) which\n  \
    \    will be added to the time difference (t2 - t1).  If the drift\n      cannot\
    \ be ignored, but we assume that the drift is a linear\n      function of time,\
    \ then the skew is given by s(t) = M*(t**2) + N*t\n      + S0, where M and N are\
    \ constants and S0 is the skew at time 0.\n      The error added by the variable\
    \ skew/drift process in this case\n      becomes e(t) = O + s(t) and the error\
    \ added to the difference in\n      time stamps is e(t2)-e(t1) = N*(t2-t1) + M*{(t2-t1)**2}.\n\
    \      It is the claim here (see remarks in section 1.3) that the effects\n  \
    \    of skew are rather small over the time scales that we are\n      discussing\
    \ here, since temperature variations in a system tend to\n      be slow relative\
    \ to packet inter-transmission times and the range\n      of drift is so small.\n\
    \   +  As far as accuracy and resolution are concerned, what is noted in\n   \
    \   the one-way-delay document [2] in section 3.7.1, applies also in\n      this\
    \ case, with the further consideration, about resolution, that\n      in this\
    \ case the uncertainty introduced is two times the one of a\n      single delay\
    \ measurement.  Errors introduced by these effects are\n      often larger than\
    \ the ones introduced by the drift.\n"
- title: 2.7.2. Errors/uncertainties related to Wire-time vs Host-time
  contents:
  - "2.7.2. Errors/uncertainties related to Wire-time vs Host-time\n   The content\
    \ of sec. 3.7.2 of [2] applies also in this case, with the\n   following further\
    \ consideration: The difference between Host-time and\n   Wire-time can be in\
    \ general decomposed into two components, of which\n   one is constant and the\
    \ other is variable.  Only the variable\n   components will produce measurement\
    \ errors, while the constant one\n   will be canceled while calculating ipdv.\n\
    \   However, in most cases, the fixed and variable components are not\n   known\
    \ exactly.\n"
- title: 3. Definitions for Samples of One-way-ipdv
  contents:
  - "3. Definitions for Samples of One-way-ipdv\n   The goal of the sample definition\
    \ is to make it possible to compute\n   the statistics of sequences of ipdv measurements.\
    \  The singleton\n   definition is applied to a stream of test packets generated\
    \ according\n   to a pseudo-random Poisson process with average arrival rate lambda.\n\
    \   If necessary, the interval in which the stream is generated can be\n   divided\
    \ into sub-intervals on which the singleton definition of ipdv\n   can be applied.\
    \  The result of this is a sequence of ipdv\n   measurements that can be analyzed\
    \ by various statistical procedures.\n   Starting from the definition of the singleton\
    \ metric of one-way-ipdv,\n   we define a sample of such singletons.  In the following,\
    \ the two\n   packets needed for a singleton measurement will be called a \"pair\"\
    .\n"
- title: 3.1. Metric name
  contents:
  - "3.1. Metric name\n   Type-P-One-way-ipdv-Poisson-stream\n"
- title: 3.2. Parameters
  contents:
  - "3.2. Parameters\n   +  Src, the IP address of a host\n   +  Dst, the IP address\
    \ of a host\n   +  T0, a time\n   +  Tf, a time\n   +  lambda, a rate in reciprocal\
    \ seconds\n   +  L, a packet length in bits.  The packets of a Type P packet stream\n\
    \      from which the sample ipdv metric is taken MUST all be of the same\n  \
    \    length.\n   +  F, a selection function defining unambiguously the packets\
    \ from\n      the stream selected for the metric.\n   +  I(i),I(i+1), i >=0, pairs\
    \ of times which mark the beginning and\n      ending of the intervals in which\
    \ the packet stream from which the\n      measurement is taken occurs.  I(0) >=\
    \ T0 and assuming that n is\n      the largest index, I(n) <= Tf.\n   +  P, the\
    \ specification of the packet type, over and above the source\n      and destination\
    \ addresses\n"
- title: '3.3. Metric Units:'
  contents:
  - "3.3. Metric Units:\n   A sequence of triples whose elements are:\n   +  T1, T2,times\n\
    \   +  dT a real number or an undefined number of seconds\n"
- title: 3.4. Definition
  contents:
  - "3.4. Definition\n   A pseudo-random Poisson process is defined such that it begins\
    \ at or\n   before T0, with average arrival rate lambda, and ends at or after\
    \ Tf.\n   Those time values T(i) greater than or equal to T0 and less than or\n\
    \   equal to Tf are then selected for packet generation times.\n   Each packet\
    \ falling within one of the sub-intervals I(i), I(i+1) is\n   tested to determine\
    \ whether it meets the criteria of the selection\n   function F as the first or\
    \ second of a packet pair needed to compute\n   ipdv.  The sub-intervals can be\
    \ defined such that a sufficient number\n   of singleton samples for valid statistical\
    \ estimates can be obtained.\n   The triples defined above consist of the transmission\
    \ times of the\n   first and second packets of each singleton included in the\
    \ sample,\n   and the ipdv in seconds.\n"
- title: 3.5. Discussion
  contents:
  - "3.5. Discussion\n   Note first that, since a pseudo-random number sequence is\
    \ employed,\n   the sequence of times, and hence the value of the sample, is not\n\
    \   fully specified.  Pseudo-random number generators of good quality\n   will\
    \ be needed to achieve the desired qualities.\n   The sample is defined in terms\
    \ of a Poisson process both to avoid the\n   effects of self-synchronization and\
    \ also capture a sample that is\n   statistically as unbiased as possible.  There\
    \ is, of course, no claim\n   that real Internet traffic arrives according to\
    \ a Poisson arrival\n   process.\n   The sample metric can best be explained with\
    \ a couple of examples:\n   For the first example, assume that the selection function\
    \ specifies\n   the \"non-infinite\" max and min one-way-delays over each sub-interval.\n\
    \   We can define contiguous sub-intervals of fixed specified length and\n   produce\
    \ a sequence each of whose elements is the triple <transmission\n   time of the\
    \ max delay packet, transmission time of the min delay\n   packet, D(max)-D(min)>\
    \ which is collected for each sub-interval.  A\n   second example is the selection\
    \ function that specifies packets whose\n   indices (sequence numbers) are just\
    \ the integers below a certain\n   bound.  In this case, the sub-intervals are\
    \ defined by the\n   transmission times of the generated packets and the sequence\
    \ produced\n   is just <T(i), T(i+1), D(i+1)-D(i)> where D(i) denotes the one-way-\n\
    \   delay of the ith packet of a stream.\n   This definition of the sample metric\
    \ encompasses both the definition\n   proposed in [9] and the one proposed in\
    \ [10].\n"
- title: 3.6. Methodology
  contents:
  - "3.6. Methodology\n   Since packets can be lost or duplicated or can arrive in\
    \ a different\n   order than the order sent, the pairs of test packets should\
    \ be marked\n   with a sequence number.  For duplicated packets only the first\n\
    \   received copy should be considered.\n   Otherwise, the methodology is the\
    \ same as for the singleton\n   measurement, with the exception that the singleton\
    \ measurement is\n   repeated a number of times.\n"
- title: 3.7. Errors and uncertainties
  contents:
  - "3.7. Errors and uncertainties\n   The same considerations apply that have been\
    \ made about the singleton\n   metric.  Additional error can be introduced by\
    \ the pseudo-random\n   Poisson process as discussed in [2].  Further considerations\
    \ will be\n   given in section 5.\n"
- title: 4. Statistics for One-way-ipdv
  contents:
  - "4. Statistics for One-way-ipdv\n   Some statistics are suggested which can provide\
    \ useful information in\n   analyzing the behavior of the packets flowing from\
    \ Src to Dst.  The\n   statistics are assumed to be computed from an ipdv sample\
    \ of\n   reasonable size.\n   The purpose is not to define every possible statistic\
    \ for ipdv, but\n   ones which have been proposed or used.\n"
- title: 4.1. Lost Packets and ipdv statistics
  contents:
  - "4.1. Lost Packets and ipdv statistics\n   The treatment of lost packets as having\
    \ \"infinite\" or \"undefined\"\n   delay complicates the derivation of statistics\
    \ for ipdv.\n   Specifically, when packets in the measurement sequence are lost,\n\
    \   simple statistics such as sample mean cannot be computed.  One\n   possible\
    \ approach to handling this problem is to reduce the event\n   space by conditioning.\
    \  That is, we consider conditional statistics;\n   namely we estimate the mean\
    \ ipdv (or other derivative statistic)\n   conditioned on the event that selected\
    \ packet pairs arrive at the\n   destination (within the given timeout).  While\
    \ this itself is not\n   without problems (what happens, for example, when every\
    \ other packet\n   is lost), it offers a way to make some (valid) statements about\
    \ ipdv,\n   at the same time avoiding events with undefined outcomes.\n   In practical\
    \ terms, what this means is throwing out the samples where\n   one or both of\
    \ the selected packets has an undefined delay.  The\n   sample space is reduced\
    \ (conditioned) and we can compute the usual\n   statistics, understanding that\
    \ formally they are conditional.\n"
- title: 4.2. Distribution of One-way-ipdv values
  contents:
  - "4.2. Distribution of One-way-ipdv values\n   The one-way-ipdv values are limited\
    \ by virtue of the fact that there\n   are upper and lower bounds on the one-way-delay\
    \ values.\n   Specifically, one-way-delay is upper bounded by the value chosen\
    \ as\n   the maximum beyond which a packet is counted as lost.  It is lower\n\
    \   bounded by propagation, transmission and nodal transit delays\n   assuming\
    \ that there are no queues or variable nodal delays in the\n   path.  Denote the\
    \ upper bound of one-way-delay by U and the lower\n   bound by L and we see that\
    \ one-way-ipdv can only take on values in\n   the (open) interval (L-U, U-L).\n\
    \   In any finite interval, the one-way-delay can vary monotonically\n   (non-increasing\
    \ or non-decreasing) or of course it can vary in both\n   directions in the interval,\
    \ within the limits of the half-open\n   interval [L,U).  Accordingly, within\
    \ that interval, the one-way-ipdv\n   values can be positive, negative, or a mixture\
    \ (including 0).\n   Since the range of values is limited, the one-way-ipdv cannot\n\
    \   increase or decrease indefinitely.  Suppose, for example, that the\n   ipdv\
    \ has a positive 'run' (i.e., a long sequence of positive values).\n   At some\
    \ point in this 'run', the positive values must approach 0 (or\n   become negative)\
    \ if the one-way-delay remains finite.  Otherwise, the\n   one-way-delay bounds\
    \ would be violated.  If such a run were to\n   continue infinitely long, the\
    \ sample mean (assuming no packets are\n   lost) would approach 0 (because the\
    \ one-way-ipdv values must approach\n   0).  Note, however, that this says nothing\
    \ about the shape of the\n   distribution, or whether it is symmetric.  Note further\
    \ that over\n   significant intervals, depending on the width of the interval\
    \ [L,U),\n   that the sample mean one-way-ipdv could be positive, negative or\
    \ 0.\n   There are basically two ways to represent the distribution of values\n\
    \   of an ipdv sample: an empirical pdf and an empirical cdf.  The\n   empirical\
    \ pdf is most often represented as a histogram where the\n   range of values of\
    \ an ipdv sample is divided into bins of a given\n   length and each bin contains\
    \ the proportion of values falling between\n   the two limits of the bin.  (Sometimes\
    \ instead the number of values\n   falling between the two limits is used).  The\
    \ empirical cdf is simply\n   the proportion of ipdv sample values less than a\
    \ given value, for a\n   sequence of values selected from the range of ipdv values.\n"
- title: 4.3. Type-P-One-way-ipdv-percentile
  contents:
  - "4.3. Type-P-One-way-ipdv-percentile\n   Given a Type-P One-Way-ipdv sample and\
    \ a given percent X between 0%\n   and 100%.  The Xth percentile of all ipdv values\
    \ is in the sample.\n   Therefore, then 50th percentile is the median.\n"
- title: 4.4. Type-P-One-way-ipdv-inverse-percentile
  contents:
  - "4.4. Type-P-One-way-ipdv-inverse-percentile\n   Given a Type-P-One-way-ipdv sample\
    \ and a given value Y, the percent\n   of ipdv sample values less than or equal\
    \ to Y.\n"
- title: 4.5. Type-P-One-way-ipdv-jitter
  contents:
  - "4.5. Type-P-One-way-ipdv-jitter\n   Although the use of the term \"jitter\" is\
    \ deprecated, we use it here\n   following the authors in [8].  In that document,\
    \ the selection\n   function specifies that consecutive packets of the Type-P\
    \ stream are\n   to be selected for the packet pairs used in ipdv computation.\
    \  They\n   then take the absolute value of the ipdv values in the sample.  The\n\
    \   authors in [8] use the resulting sample to compare the behavior of\n   two\
    \ different scheduling algorithms.\n   An alternate, but related, way of computing\
    \ an estimate of jitter is\n   given in RFC 1889 [11].  The selection function\
    \ there is implicitly\n   consecutive packet pairs, and the \"jitter estimate\"\
    \ is computed by\n   taking the absolute values of the ipdv sequence (as defined\
    \ in this\n   document) and applying an exponential filter with parameter 1/16\
    \ to\n   generate the estimate (i.e., j_new = 15/16* j_old + 1/16*j_new).\n"
- title: 4.6. Type-P-One-way-peak-to-peak-ipdv
  contents:
  - "4.6. Type-P-One-way-peak-to-peak-ipdv\n   In this case, the selection function\
    \ used in collecting the Type-P-\n   One-Way-ipdv sample specifies that the first\
    \ packet of each pair to\n   be the packet with the maximum Type-P-One-Way-Delay\
    \ in each\n   subinterval and the second packet of each pair to be the packet\
    \ with\n   the minimum Type-P-One-Way-Delay in each sub-interval.  The resulting\n\
    \   sequence of values is the peak-to-peak delay variation in each\n   subinterval\
    \ of the measurement interval.\n"
- title: 5. Discussion of clock synchronization
  contents:
  - "5. Discussion of clock synchronization\n   This section gives some considerations\
    \ about the need for having\n   synchronized clocks at the source and destination,\
    \ although in the\n   case of unsynchronized clocks, data from the measurements\
    \ themselves\n   can be used to correct error.  These considerations are given\
    \ as a\n   basis for discussion and they require further investigation.\n"
- title: 5.1. Effects of synchronization errors
  contents:
  - "5.1. Effects of synchronization errors\n   Clock errors can be generated by two\
    \ processes: the relative drift\n   and the relative skew of two given clocks.\
    \  We should note that drift\n   is physically limited and so the total relative\
    \ skew of two clocks\n   can vary between an upper and a lower bound.\n   Suppose\
    \ then that we have a measurement between two systems such that\n   the clocks\
    \ in the source and destination systems have at time 0 a\n   relative skew of\
    \ s(0) and after a measurement interval T have skew\n   s(T).  We assume that\
    \ the two clocks have an initial offset of O\n   (that is letter O).\n   Now suppose\
    \ that the packets travel from source to destination in\n   constant time, in\
    \ which case the ipdv is zero and the difference in\n   the time stamps of the\
    \ two clocks is actually just the relative\n   offset of the clocks.  Suppose\
    \ further that at the beginning of the\n   measurement interval the ipdv value\
    \ is calculated from a packet pair\n   and at the end of the measurement interval\
    \ another ipdv value is\n   calculated from another packet pair.  Assume that\
    \ the time interval\n   covered by the first measurement is t1 and that the time\
    \ interval\n   covered by the second measurement is t2.  Then\n   ipdv1 = s(0)*t1\
    \ + t1*(s(T)-s(0))/T\n   ipdv2 = s(T)*t2 + t2*(s(T)-s(0))/T\n   assuming that\
    \ the change in skew is linear in time.  In most\n   practical cases, it is claimed\
    \ that the drift will be close to zero\n   in which case the second (correction)\
    \ term in the above equations\n   disappears.\n   Note that in the above discussion,\
    \ other errors, including the\n   differences between host time and wire time,\
    \ and externally-caused\n   clock discontinuities (e.g., clock corrections) were\
    \ ignored.  Under\n   these assumptions the maximum clock errors will be due to\
    \ the maximum\n   relative skew acting on the largest interval between packets.\n"
- title: 5.2. Estimating the skew of unsynchronized clocks
  contents:
  - "5.2. Estimating the skew of unsynchronized clocks\n   If the skew is linear (that\
    \ is, if s(t) = S * t for constant S), the\n   error in ipdv values will depend\
    \ on the time between the packets used\n   in calculating the value.  If ti is\
    \ the time between the packet pair,\n   then let Ti denote the sample mean time\
    \ between packets and the\n   average skew is s(Ti) = S * Ti.  In the event that\
    \ the delays are\n   constant, the skew parameter S can be estimated from the\
    \ estimate Ti\n   of the time between packets and the sample mean ipdv value.\
    \  Under\n   these assumptions, the ipdv values can be corrected by subtracting\n\
    \   the estimated S * ti.\n   We observe that the displacement due to the skew\
    \ does not change the\n   shape of the distribution, and, for example the Standard\
    \ Deviation\n   remains the same.  What introduces a distortion is the effect\
    \ of the\n   drift, also when the mean value of this effect is zero at the end\
    \ of\n   the measurement.  The value of this distortion is limited to the\n  \
    \ effect of the total skew variation on the emission interval.\n"
- title: 6. Security Considerations
  contents:
  - "6. Security Considerations\n   The one-way-ipdv metric has the same security\
    \ properties as the one-\n   way-delay metric [2], and thus they inherit the security\n\
    \   considerations of that document.  The reader should consult [2] for a\n  \
    \ more detailed treatment of security considerations.  Nevertheless,\n   there\
    \ are a few things to highlight.\n"
- title: 6.1. Denial of service
  contents:
  - "6.1. Denial of service\n   It is still possible that there could be an attempt\
    \ at a denial of\n   service attack by sending many measurement packets into the\
    \ network.\n   In general, legitimate measurements must have their parameters\n\
    \   carefully selected in order to avoid interfering with normal traffic.\n"
- title: 6.2. Privacy/Confidentiality
  contents:
  - "6.2. Privacy/Confidentiality\n   The packets contain no user information, and\
    \ so privacy of user data\n   is not a concern.\n"
- title: 6.3. Integrity
  contents:
  - "6.3. Integrity\n   There could also be attempts to disrupt measurements by diverting\n\
    \   packets or corrupting them.  To ensure that test packets are valid\n   and\
    \ have not been altered during transit, packet authentication and\n   integrity\
    \ checks may be used.\n"
- title: 7. Acknowledgments
  contents:
  - "7. Acknowledgments\n   Thanks to Merike Kaeo, Al Morton and Henk Uiterwaal for\
    \ catching\n   mistakes and for clarifying re-wordings for this final document.\n\
    \   A previous major revision of the document resulted from e-mail\n   discussions\
    \ with and suggestions from Mike Pierce, Ruediger Geib,\n   Glenn Grotefeld, and\
    \ Al Morton.  For previous revisions of this\n   document, discussions with Ruediger\
    \ Geib, Matt Zekauskas and Andy\n   Scherer were very helpful.\n"
- title: 8. References
  contents:
  - '8. References

    '
- title: 8.1 Normative References
  contents:
  - "8.1 Normative References\n   [1]  Paxon, V., Almes, G., Mahdavi, J. and M. Mathis,\
    \ \"Framework for\n        IP Performance Metrics\", RFC 2330, February 1998.\n\
    \   [2]  Almes, G. and S. Kalidindisu, \"A One-Way-Delay Metric for IPPM\",\n\
    \        RFC 2679, September 1999.\n   [3]  Bradner, S., \"Key words for use in\
    \ RFCs to indicate requirement\n        levels\", BCP 14, RFC 2119, March 1997.\n"
- title: 8.2 Informational References
  contents:
  - "8.2 Informational References\n   [4]  ITU-T Recommendation Y.1540 (formerly numbered\
    \ I.380) \"Internet\n        Protocol Data Communication Service - IP Packet Transfer\
    \ and\n        Availability Performance Parameters\", February 1999.\n   [5] \
    \ Demichelis, Carlo - \"Packet Delay Variation Comparison between\n        ITU-T\
    \ and IETF Draft Definitions\" November 2000 (in the IPPM\n        mail archives).\n\
    \   [6]  ITU-T Recommendation I.356 \"B-ISDN ATM Layer Cell Transfer\n       \
    \ Performance\".\n   [7]  S. Keshav - \"An Engineering Approach to Computer Networking\"\
    ,\n        Addison-Wesley 1997, ISBN 0-201-63442-2.\n   [8]  Jacobson, V., Nichols,\
    \ K. and Poduri, K. \"An Expedited\n        Forwarding PHB\", RFC 2598, June 1999.\n\
    \   [9]  ITU-T Draft Recommendation Y.1541 - \"Internet Protocol\n        Communication\
    \ Service - IP Performance and Availability\n        Objectives and Allocations\"\
    , April 2000.\n   [10] Demichelis, Carlo - \"Improvement of the Instantaneous\
    \ Packet\n        Delay Variation (IPDV) Concept and Applications\", World\n \
    \       Telecommunications Congress 2000, 7-12 May 2000.\n   [11] Schulzrinne,\
    \ H., Casner, S., Frederick, R. and V. Jacobson,\n        \"RTP: A transport protocol\
    \ for real-time applications\", RFC\n        1889, January 1996.\n"
- title: 9. Authors' Addresses
  contents:
  - "9. Authors' Addresses\n   Carlo Demichelis\n   Telecomitalia Lab S.p.A\n   Via\
    \ G. Reiss Romoli 274\n   10148 - TORINO\n   Italy\n   Phone: +39 11 228 5057\n\
    \   Fax:   +39 11 228 5069\n   EMail: carlo.demichelis@tilab.com\n   Philip Chimento\n\
    \   Ericsson IPI\n   7301 Calhoun Place\n   Rockville, Maryland 20855\n   USA\n\
    \   Phone: +1-240-314-3597\n   EMail: chimento@torrentnet.com\n"
- title: 10.  Full Copyright Statement
  contents:
  - "10.  Full Copyright Statement\n   Copyright (C) The Internet Society (2002).\
    \  All Rights Reserved.\n   This document and translations of it may be copied\
    \ and furnished to\n   others, and derivative works that comment on or otherwise\
    \ explain it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
