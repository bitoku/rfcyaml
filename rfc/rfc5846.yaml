- title: __initial_text__
  contents:
  - '                  Binding Revocation for IPv6 Mobility

    '
- title: Abstract
  contents:
  - "Abstract\n   This document defines a binding revocation mechanism to terminate\
    \ a\n   mobile node's mobility session and the associated resources.  This\n \
    \  mechanism can be used both with base Mobile IPv6 and its extensions,\n   such\
    \ as Proxy Mobile IPv6.  The mechanism allows the mobility entity\n   which initiates\
    \ the revocation procedure to request its peer to\n   terminate either one, multiple\
    \ or all specified Binding Cache\n   entries.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc5846.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  4\n   2.  Conventions and Terminology  . . . . . . . . . . . .\
    \ . . . . .  4\n     2.1.  Conventions Used in This Document  . . . . . . . .\
    \ . . . .  4\n     2.2.  Terminology  . . . . . . . . . . . . . . . . . . . .\
    \ . . .  4\n   3.  Binding Revocation Protocol and Use Cases Overview . . . .\
    \ . .  5\n     3.1.  Binding Revocation Protocol  . . . . . . . . . . . . . .\
    \ .  5\n     3.2.  MIPv6 and DSMIP6 Use Case  . . . . . . . . . . . . . . . .\
    \  6\n     3.3.  Multiple Care-of Addresses (MCoA) Use Case . . . . . . . .  7\n\
    \     3.4.  Proxy MIPv6 Use Case . . . . . . . . . . . . . . . . . . .  8\n  \
    \     3.4.1.  Local Mobility Anchor Initiates PMIPv6 Revocation  . .  9\n    \
    \   3.4.2.  Mobile Access Gateway Revokes Bulk PMIPv6 Bindings . . 10\n   4. \
    \ Binding Revocation Messages over IPv4 Transport Network  . . . 10\n   5.  Binding\
    \ Revocation Message . . . . . . . . . . . . . . . . . . 11\n     5.1.  Binding\
    \ Revocation Indication Message  . . . . . . . . . . 13\n     5.2.  Binding Revocation\
    \ Acknowledgement Message . . . . . . . . 16\n   6.  Binding Revocation Process\
    \ Operation . . . . . . . . . . . . . 18\n     6.1.  Sending Binding Revocation\
    \ Message . . . . . . . . . . . . 18\n       6.1.1.  Sending Binding Revocation\
    \ Indication  . . . . . . . . 18\n       6.1.2.  Sending Binding Revocation Acknowledgement\
    \ . . . . . . 19\n     6.2.  Receiving Binding Revocation Message . . . . . .\
    \ . . . . . 20\n       6.2.1.  Receiving Binding Revocation Indication  . . .\
    \ . . . . 20\n       6.2.2.  Receiving Binding Revocation Acknowledgement . .\
    \ . . . 21\n     6.3.  Retransmission of Binding Revocation Indication  . . .\
    \ . . 22\n   7.  Home Agent Operation . . . . . . . . . . . . . . . . . . . .\
    \ . 22\n   8.  Local Mobility Anchor Operation  . . . . . . . . . . . . . . .\
    \ 23\n     8.1.  Sending Binding Revocation Indication  . . . . . . . . . . 23\n\
    \     8.2.  Receiving Binding Revocation Indication  . . . . . . . . . 27\n  \
    \ 9.  Mobile Access Gateway Operation  . . . . . . . . . . . . . . . 29\n    \
    \ 9.1.  Receiving Binding Revocation Indication  . . . . . . . . . 29\n     9.2.\
    \  Sending Binding Revocation Indication  . . . . . . . . . . 31\n   10. Mobile\
    \ Node Operation  . . . . . . . . . . . . . . . . . . . . 32\n   11. Protocol\
    \ Configuration Variables . . . . . . . . . . . . . . . 34\n   12. IANA Considerations\
    \  . . . . . . . . . . . . . . . . . . . . . 34\n   13. Security Considerations\
    \  . . . . . . . . . . . . . . . . . . . 36\n   14. Acknowledgements . . . . .\
    \ . . . . . . . . . . . . . . . . . . 37\n   15. References . . . . . . . . .\
    \ . . . . . . . . . . . . . . . . . 37\n     15.1. Normative References . . .\
    \ . . . . . . . . . . . . . . . . 37\n     15.2. Informative References . . .\
    \ . . . . . . . . . . . . . . . 38\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   In the case of Mobile IPv6 and for administrative reasons,\
    \ sometimes\n   it becomes necessary to inform the mobile node that its registration\n\
    \   has been revoked and the mobile node is no longer able to receive IP\n   mobility\
    \ service for its Home Address.  A similar Mobile IPv4\n   registration revocation\
    \ mechanism [RFC3543] has been specified by the\n   IETF for providing a revocation\
    \ mechanism for sessions that were\n   established using Mobile IPv4 registration\
    \ [RFC3344].\n   This document specifies a binding revocation mechanism that can\
    \ be\n   used to revoke a mobile node's mobility session(s).  The same\n   mechanism\
    \ can be used to revoke bindings created using Mobile IPv6\n   [RFC3775] or any\
    \ of its extensions, e.g., Proxy Mobile IPv6\n   [RFC5213].  The proposed revocation\
    \ mechanism uses a new Mobility\n   Header (MH) type 16 for revocation signaling\
    \ that is applicable to\n   Mobile IPv6 [RFC3775] and Proxy Mobile IPv6 [RFC5213]\
    \ and can be used\n   by any two IP mobility entities.  As an example, this mechanism\n\
    \   allows a local mobility anchor (LMA), involved in providing IP\n   mobility\
    \ services to a mobile node, to notify the mobile access\n   gateway (MAG) of\
    \ the termination of that mobile node binding\n   registration.  In another example,\
    \ a mobile access gateway can use\n   this mechanism to notify its local mobility\
    \ anchor peer with a bulk\n   termination of all or a subset of proxy mobile IPv6\
    \ (PMIPv6) bindings\n   that are registered with the local mobility anchor and\
    \ currently\n   being served by the mobile access gateway.  Any mobility entity\
    \ is\n   allowed to revoke only the registration of those mobile node(s)\n   mobility\
    \ sessions that are currently registered with it.\n"
- title: 2.  Conventions and Terminology
  contents:
  - '2.  Conventions and Terminology

    '
- title: 2.1.  Conventions Used in This Document
  contents:
  - "2.1.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 2.2.  Terminology
  contents:
  - "2.2.  Terminology\n   All the general mobility related terminology and abbreviations\
    \ are to\n   be interpreted as defined in the Mobile IPv6 [RFC3775], Proxy Mobile\n\
    \   IPv6 [RFC5213] and IPv4 Support for Proxy Mobile IPv6 [RFC5844]\n   specifications.\
    \  The following terms are used in this specification.\n   Initiator\n      The\
    \ mobility node that initiates the binding revocation procedure\n      by sending\
    \ a Binding Revocation Indication message to its peer,\n      e.g., home agent,\
    \ local mobility anchor, or mobile access gateway.\n   Responder\n      The mobility\
    \ node that receives the Binding Revocation Indication\n      message and responds\
    \ with a Binding Revocation Acknowledgement\n      message, e.g., mobile node,\
    \ mobile access gateway, or local\n      mobility anchor.\n"
- title: 3.  Binding Revocation Protocol and Use Cases Overview
  contents:
  - "3.  Binding Revocation Protocol and Use Cases Overview\n   This specification\
    \ specifies a generic binding revocation mechanism\n   where a mobility node can\
    \ communicate to the mobile node or another\n   mobility node the identity of\
    \ the mobile node registration binding\n   that is being terminated.  In the case\
    \ when this mechanism is used\n   for bulk termination or multiple bindings, the\
    \ identities of these\n   bindings are communicated to the mobile node or mobility\
    \ node using\n   the same generic mechanism.  The following subsections present\
    \ the\n   protocol overview and applicable use cases.\n"
- title: 3.1.  Binding Revocation Protocol
  contents:
  - "3.1.  Binding Revocation Protocol\n   In the case of Mobile IPv6, if the home\
    \ network decides to terminate\n   the service of the mobile node, the home agent\
    \ sends a Binding\n   Revocation Indication (BRI) message to the mobile node.\
    \  The home\n   agent includes the home address (HoA) of the mobile node in the\
    \ Type\n   2 routing header as specified in [RFC3775] to indicate the impacted\n\
    \   mobile node binding.  In the case of Dual Stack Mobile IPv6 (DSMIPv6)\n  \
    \ [RFC5555], the home agent may include the IPv4 Home Address option\n   with\
    \ the home IPv4 address assigned by the mobile node.\n   Additionally, if the\
    \ mobile node registered multiple care-of\n   addresses [RFC5648], the home agent\
    \ includes the Binding Identifier\n   (BID) option(s) in the Binding Revocation\
    \ Indication message to\n   identify which binding is being revoked.  When the\
    \ mobile node\n   receives a Binding Revocation Indication message with its HoA\n\
    \   included in the Type 2 routing header, the mobile node responds by\n   sending\
    \ a Binding Revocation Acknowledgement (BRA) message.\n   Similarly, in the case\
    \ of Proxy Mobile IPv6 [RFC5213], the revocation\n   procedure can be initiated\
    \ by the local mobility anchor by sending a\n   Binding Revocation Indication\
    \ message to communicate the termination\n   of a mobile node registration binding\
    \ to the mobile access gateway.\n   In this case, the local mobility anchor includes\
    \ the mobile node Home\n   Network Prefix (MN-HNP) option [RFC5213] and the MN-ID\
    \ option\n   [RFC4283] to indicate to the mobility access gateway the identity\
    \ of\n   the PMIPv6 binding that needs to be terminated.  When the mobile\n  \
    \ access gateway receives the Binding Revocation Indication message,\n   the mobile\
    \ access gateway responds to the local mobility anchor by\n   sending a Binding\
    \ Revocation Acknowledgement message.\n   On the other hand, the mobile access\
    \ gateway usually sends a de-\n   registration message by sending a Proxy Binding\
    \ Update with a\n   lifetime of zero to indicate to the local mobility anchor\
    \ of the\n   termination of the PMIPv6 mobile node binding registration.  In this\n\
    \   case, the mobile access gateway includes the MN-HNP option, the MN-ID\n  \
    \ option, and all other required mobility options as per [RFC5213] in\n   order\
    \ for the local mobility anchor to identify the mobile node\n   PMIPv6 binding.\
    \  Additionally, in the case when the mobile access\n   gateway communicates a\
    \ bulk termination of PMIPv6 mobility sessions,\n   the mobile access gateway\
    \ sends a Binding Revocation Indication\n   message with the Global (G) bit set\
    \ and includes the mobile access\n   gateway identity in the MN-ID option, see\
    \ Section 9.2 and\n   Section 8.2.  When the local mobility anchor receives such\
    \ a Binding\n   Revocation Indication message, it ensures that the mobile access\n\
    \   gateway is authorized to send such a bulk termination message, see\n   Section\
    \ 13, and then processes the Binding Revocation Indication\n   message accordingly.\
    \  If the local mobility anchor processes the\n   Binding Revocation Indication\
    \ message successfully, the local\n   mobility anchor responds to the mobile access\
    \ gateway by sending\n   Binding Revocation Acknowledgement message.\n   In any\
    \ of the above cases, the initiator of the binding revocation\n   procedure, e.g.,\
    \ home agent, local mobility anchor, or mobile access\n   gateway, uses the Revocation\
    \ Trigger field in the Binding Revocation\n   Indication message to indicate to\
    \ the receiving node the reason for\n   initiating the revocation procedure.\n"
- title: 3.2.  MIPv6 and DSMIP6 Use Case
  contents:
  - "3.2.  MIPv6 and DSMIP6 Use Case\n   The binding revocation mechanism is applicable\
    \ to Mobile IPv6 and\n   DSMIPv6 session(s) when the home agent needs to inform\
    \ the mobile\n   node that its binding registration has been revoked, e.g., for\
    \ an\n   administrative reason.  This mechanism enables the user or the mobile\n\
    \   node to react to the revocation, e.g., reinstate its interrupted\n   Mobile\
    \ IPv6 services.\n   In this case, the home agent sends a Binding Revocation Indication\n\
    \   message to indicate to the mobile node that its current mobile IPv6\n   (MIPv6)\
    \ binding has been revoked and it is no longer able to receive\n   IP mobility\
    \ service.  The home agent includes the HoA in a Type 2\n   routing header as\
    \ used in [RFC3775] and sets the Revocation Trigger\n   field to a proper value,\
    \ e.g., Administrative Reason.  In the case of\n   a DSMIPv6 session, the home\
    \ agent may additionally include the\n   mobile-node-assigned IPv4 Home Address\
    \ in the IPv4 Home Address\n   option.  When the mobile node receives the Binding\
    \ Revocation\n   Indication message, it sends a Binding Revocation Acknowledgement\n\
    \   message to the home agent.  Figure 1 illustrates the message\n   sequencing\
    \ when a home agent revokes a mobile node binding\n   registration.\n        \
    \ MN                                         HA\n         |                  \
    \                         |\n         |           HoA in Type 2 Routing Hdr  \
    \     |\n         |<<<------------...  +  ...-----------------|\n         |  \
    \    BRI [seq.#, Revocation Trigger]      |\n         |                      \
    \                     |\n         |                                          \
    \ |\n         | BRA (HoA in Dest. Option)[seq.#, Status]  |\n         |---------------------------------------->>>|\n\
    \         |                                           |\n         |          \
    \                                 |\n      Figure 1: Home Agent Revokes a Mobile\
    \ Node Binding Registration\n"
- title: 3.3.  Multiple Care-of Addresses (MCoA) Use Case
  contents:
  - "3.3.  Multiple Care-of Addresses (MCoA) Use Case\n   In the case of multiple\
    \ care-of address registrations [RFC5648], the\n   home agent maintains a different\
    \ binding for each care-of address and\n   home address pair.  These bindings\
    \ are also indexed and identified\n   during the mobile node registration using\
    \ a BID mobility option.  The\n   HA may revoke one or multiple bindings for the\
    \ same mobile node home\n   address.\n   If the home agent revokes a single binding\
    \ for a mobile node with\n   multiple care-of address registrations, the home\
    \ agent sends a\n   Binding Revocation Indication message to the mobile node with\
    \ the\n   corresponding BID option included.  If more than one of the mobile\n\
    \   node registered care-of addresses needs to be revoked, the home agent\n  \
    \ includes all the corresponding BID options in the same Binding\n   Revocation\
    \ Indication message.  Figure 2 illustrates the message flow\n   when the home\
    \ agent revokes two registered care-of addresses for the\n   same mobile node\
    \ in a single Binding Revocation Indication message.\n                       \
    \                             HA Binding Cache\n                             \
    \                       ================\n                                   \
    \                 MN-BID1 [CoA1+HoA]\n   MN                                  \
    \         HA  MN-BID2 [CoA2+HoA]\n    |                                      \
    \      |  MN-BID3 [CoA3+HoA]\n    |                                          \
    \  |  MN-BID4 [CoA4+HoA]\n    |             HoA in Type 2 Routing Hdr      |\n\
    \    |<<<<--------------  +  ---------------------|\n    |     BRI [seq.#, R.\
    \ Trigger, BID1, BID4]    |\n    |                                           \
    \ |\n    |                                            |\n    | BRA (HoA in Dest.\
    \ Option) [seq.#, Status]  |\n    |---------------------------------------->>>>|\n\
    \    |                                            |\n    |                   \
    \                         |\n    Figure 2: Home Agent Revokes MN's Specific Care-of\
    \ Address Bindings\n   Additionally, the home agent may revoke all of the mobile\
    \ node\n   registered bindings by sending a BRI message without including any\n\
    \   BID options while the HoA is included in the Type 2 routing header.\n   Figure\
    \ 1 illustrates the message flow when the home agent revokes all\n   registered\
    \ care-of address bindings for a mobile node in a single\n   Binding Revocation\
    \ Indication message.\n"
- title: 3.4.  Proxy MIPv6 Use Case
  contents:
  - "3.4.  Proxy MIPv6 Use Case\n   Since the mobile node does not participate in\
    \ the mobility mechanism\n   in the case of PMIPv6, there are many scenarios where\
    \ the Binding\n   Revocation mechanism is needed to clean resources and make sure\
    \ that\n   the mobility entities, i.e., mobile access gateway and local mobility\n\
    \   anchor, are always synchronized with respect to the status of the\n   existing\
    \ PMIPv6 bindings.  The binding revocation mechanism is\n   generic enough that\
    \ it can be used for all Proxy Mobile IPv6\n   scenarios that follow the [RFC5213]\
    \ and [RFC5844] specifications.\n   When the mobile access gateway receives a\
    \ Binding Revocation\n   Indication message as in Section 9.1, the mobile access\
    \ gateway sends\n   a Binding Revocation Acknowledgement message to the local\
    \ mobility\n   anchor following the rules described in Section 6.1.2.  Similarly,\
    \ if\n   the local mobility anchor receives a Binding Revocation Indication\n\
    \   message, the local mobility anchor responds to the mobile access\n   gateway\
    \ by sending a Binding Revocation Acknowledgement message.\n"
- title: 3.4.1.  Local Mobility Anchor Initiates PMIPv6 Revocation
  contents:
  - "3.4.1.  Local Mobility Anchor Initiates PMIPv6 Revocation\n   The local mobility\
    \ anchor may send a Binding Revocation Indication\n   message with the appropriate\
    \ revocation trigger value to the mobile\n   access gateway that hosts a specific\
    \ PMIPv6 binding to indicate that\n   the mobile node binding has been terminated\
    \ and the mobile access\n   gateway can clean up the applicable resources.  When\
    \ the mobile\n   access gateway receives a Binding Revocation Indication message,\
    \ the\n   mobile access gateway identifies the respective binding and it sends\n\
    \   a Binding Revocation Acknowledgement message to the local mobility\n   anchor.\
    \  In this case, the mobile access gateway could terminate the\n   IPv6 or IPv4\
    \ mobility session on the access link and notify the\n   mobile node as in Section\
    \ 9.1.\n   As an example, Figure 3, illustrates the message sequence for\n   revoking\
    \ a mobile node binding at the source mobile access gateway\n   during the mobile\
    \ node inter-MAG handover.  During the inter-MAG\n   handover, the mobile node\
    \ moves from the source MAG to the target\n   MAG.  The target MAG sends a Proxy\
    \ Binding Update with the new\n   care-of address to the local mobility anchor\
    \ to update the mobile\n   node's point of attachment.  Since the mobile node\
    \ binding at the\n   local mobility anchor points to the source MAG and upon receiving\
    \ the\n   Proxy Binding Update from the target MAG, the local mobility anchor\n\
    \   updates the MN Binding Cache entry (BCE) and sends a Proxy Binding\n   Acknowledgement\
    \ to the target MAG.  The local mobility anchor can\n   send a Binding Revocation\
    \ Indication message with the appropriate\n   revocation trigger value, e.g.,\
    \ inter-MAG handover - different Access\n   Types, to the source MAG in order\
    \ to clean up the applicable\n   resources reserved for the specified mobile node\
    \ binding.  The source\n   mobile access gateway acknowledges the Binding Revocation\
    \ Indication\n   message by sending a Binding Revocation Acknowledgement message\
    \ to\n   indicate the success or failure of the termination of the mobile\n  \
    \ node's binding.\n   The process identified above can also be used by the local\
    \ mobility\n   anchor in scenarios other than the inter-MAG handover with the\
    \ proper\n   revocation trigger value to indicate to the peer mobile access\n\
    \   gateway that a specific PMIPv6 binding or bindings have been revoked.\n  \
    \           oldMAG       newMAG                          LMA\n               |\
    \             |                            |\n               |             | \
    \       PBU                 |\n               |             |--------------------------->|\n\
    \               |             |                      PBU triggers\n          \
    \     |             |                   BRI Msg to oldMAG\n               |  \
    \           |                            |\n               |             |   \
    \     PBA                 |\n               |             |<---------------------------|\n\
    \               |             |                            |\n               |\
    \             |                            |\n               |    BRI [seq.#,\
    \ R. Trigger, P bit, NAI]   |\n               |<-----------------------------------------|\n\
    \               |             |                            |\n               |\
    \             |                            |\n               |             | \
    \                           |\n               |             |                \
    \            |\n               |        BRA [seq.#, Status, P bit]        |\n\
    \               |----------------------------------------->|\n               |\
    \             |                            |\n               |             | \
    \                           |\n    Figure 3: LMA Revokes an MN Registration During\
    \ Inter-MAG Handover\n   In addition, the local mobility anchor can send a Binding\
    \ Revocation\n   Indication message to indicate that all bindings that are hosted\
    \ by\n   the peer mobile access gateway and registered with the local mobility\n\
    \   anchor are being revoked by setting the Global (G) bit as described\n   in\
    \ Section 8.1.\n"
- title: 3.4.2.  Mobile Access Gateway Revokes Bulk PMIPv6 Bindings
  contents:
  - "3.4.2.  Mobile Access Gateway Revokes Bulk PMIPv6 Bindings\n   The mobile access\
    \ gateway sends a BRI message with the Global (G) bit\n   set and the Revocation\
    \ Trigger field set to \"Per-Peer Policy\" to\n   indicate that all mobility bindings\
    \ that are registered at the local\n   mobility anchor and attached to the mobile\
    \ access gateway are being\n   revoked as in Section 9.2.  When the local mobility\
    \ anchor receives\n   this Binding Revocation Indication message from the specified\
    \ mobile\n   access gateway, the local mobility anchor first checks if the mobile\n\
    \   access gateway is authorized to use global revocations, then it\n   responds\
    \ with the appropriate status code by sending a Binding\n   Revocation Acknowledgement\
    \ message as in Section 6.1.2.\n"
- title: 4.  Binding Revocation Messages over IPv4 Transport Network
  contents:
  - "4.  Binding Revocation Messages over IPv4 Transport Network\n   In some deployments,\
    \ the network between the mobile access gateway\n   and the local mobility anchor\
    \ may only support IPv4 transport.\n   Another case is when a mobile node that\
    \ supports client mobile IPv6\n   roams to an access network where only IPv4 addressing\
    \ and transport\n   is supported.  In this case, the mobile node is required to\
    \ register\n   an IPv4 home address with its home agent using a mobile IPv6 Binding\n\
    \   Update message.\n   If the Proxy Binding Update and Proxy Binding Acknowledgement\n\
    \   messages or the Binding Update and Binding Acknowledgement messages\n   are\
    \ sent using UDP encapsulation [RFC5844] [RFC5555], then the\n   Binding Revocation\
    \ Messages are sent using the same UDP\n   encapsulation.  The same UDP source\
    \ and destination port numbers and\n   IPv4 addresses used for exchanging the\
    \ Proxy Binding Update and Proxy\n   Binding Acknowledgement or the Binding Update\
    \ and Binding\n   Acknowledgement messages MUST be used when transporting Binding\n\
    \   Revocation Messages over IPv4 using UDP encapsulation.  For example,\n   the\
    \ source UDP port number, the destination UDP port number, the\n   source IPv4\
    \ address, and the destination IPv4 address of the Binding\n   Revocation Indication\
    \ message are set to the destination UDP port\n   number, the source UDP port\
    \ number, destination IPv4 address, and\n   source IPv4 address of the latest\
    \ received and successfully processed\n   Proxy Binding Update or Binding Update\
    \ message, respectively.  For\n   more details on tunneling Proxy Mobile IPv6\
    \ and Mobile IPv6 signaling\n   messages over IPv4, see [RFC5844] and [RFC5555],\
    \ respectively.\n"
- title: 5.  Binding Revocation Message
  contents:
  - "5.  Binding Revocation Message\n   This section defines the Binding Revocation\
    \ Message format using an\n   MH Type 16 as illustrated in Figure 4.  The value\
    \ in the Binding\n   Revocation Type field defines whether the Binding Revocation\
    \ Message\n   is a Binding Revocation Indication or Binding Revocation\n   Acknowledgement.\
    \  If the Binding Revocation Type field is set to 1,\n   the Binding Revocation\
    \ Message is a Binding Revocation Indication as\n   in Section 5.1.  However,\
    \ if the value is 2, it is a Binding\n   Revocation Acknowledgement message as\
    \ in Section 5.2.\n       0                   1                   2          \
    \         3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       | Payload Proto |  Header Len   |   MH Type     |   Reserved    |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |           Checksum            |  B.R. Type    |               |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +\n       |\
    \                                                               |\n       .  \
    \          Binding Revocation Message Data                    .\n       |    \
    \                                                           |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                   Figure 4: Binding Revocation Message\n   Payload Proto\n \
    \     8-bit selector.  See [RFC3775] for more details.\n   Header Len\n      8-bit\
    \ unsigned integer.  Representing the length of the Mobility\n      Header in\
    \ units of 8 octets, excluding the first 8 octets.  See\n      [RFC3775] for more\
    \ details.\n   MH Type\n      16, which identifies the mobility message as a Binding\
    \ Revocation\n      Message.\n   Reserved\n      8-bit field reserved for future\
    \ use.  The value MUST be\n      initialized to zero by the sender and MUST be\
    \ ignored by the\n      receiver.\n   Checksum\n      16-bit unsigned integer.\
    \  This field contains the checksum of the\n      Mobility Header.  The checksum\
    \ is calculated as described in\n      [RFC3775].\n   Binding Revocation Type\n\
    \      8-bit unsigned integer.  It defines the type of the Binding\n      Revocation\
    \ Message.  It can be assigned one of the following\n      values:\n         \
    \ 0  Reserved\n          1  Binding Revocation Indication\n          2  Binding\
    \ Revocation Acknowledgement\n          All other values are unassigned\n   Binding\
    \ Revocation Message Data\n      The Binding Revocation Message Data follows the\
    \ Binding Revocation\n      Message format that is defined in this document for\
    \ the specified\n      value in the Binding Revocation Type field.  In this document,\
    \ it\n      is either a Binding Revocation Indication as in Section 5.1 or\n \
    \     Binding Revocation Acknowledgement as in Section 5.2.\n"
- title: 5.1.  Binding Revocation Indication Message
  contents:
  - "5.1.  Binding Revocation Indication Message\n   The Binding Revocation Indication\
    \ (BRI) message is a Binding\n   Revocation Message that has an MH type 16 and\
    \ a Binding Revocation\n   Type value of 1.  It is used by the initiator to inform\
    \ the responder\n   of the identity of a specific binding or bindings for which\
    \ IP\n   mobility service are being revoked.  Binding Revocation Indication\n\
    \   message is sent as described in Sections 7, 8.1, and 9.2.\n   When the value\
    \ 1 is indicated in the Binding Revocation Type field of\n   the Binding Revocation\
    \ Message, the format of the Binding Revocation\n   Message Data follows the Binding\
    \ Revocation Indication message as in\n   Figure 5\n       0                 \
    \  1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                                    \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                                      \
    \ | B.R. Type = 1 |  R. Trigger   |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       |          Sequence #           |P|V|G|       Reserved          |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |                                                               |\n      \
    \ .                                                               .\n       .\
    \                        Mobility options                       .\n       |  \
    \                                                             |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \              Figure 5: Binding Revocation Indication Message\n   Revocation\
    \ Trigger\n      8-bit unsigned integer indicating the event that triggered the\n\
    \      initiator to send the BRI message.  The Per-MN Revocation Trigger\n   \
    \   values are less than 128.  The Per-MN Revocation Trigger is used\n      when\
    \ the BRI message intends to revoke one or more bindings for\n      the same mobile\
    \ node.  The Global Revocation Trigger values are\n      greater than 128 and\
    \ less than 250 and used in the BRI message\n      when the Global (G) bit is\
    \ set for global revocation.  The values\n      250-255 are reserved for testing\
    \ purposes only.  The following\n      Revocation Trigger values are currently\
    \ defined:\n      Per-MN Revocation Trigger Values:\n          0  Unspecified\n\
    \          1  Administrative Reason\n          2  Inter-MAG Handover - same Access\
    \ Type\n          3  Inter-MAG Handover - different Access Type\n          4 \
    \ Inter-MAG Handover - Unknown\n          5  User-Initiated Session(s) Termination\n\
    \          6  Access Network Session(s) Termination\n          7  Possible Out-of-Sync\
    \ BCE State\n      Global Revocation Trigger Values:\n          128  Per-Peer\
    \ Policy\n          129  Revoking Mobility Node Local Policy\n      Reserved Revocation\
    \ Trigger Values:\n          250-255 Reserved For Testing Purposes only\n    \
    \      All other values are Reserved\n   Sequence Number\n      A 16-bit unsigned\
    \ integer used by the initiator to match a\n      returned Binding Revocation\
    \ Acknowledgement with this Binding\n      Revocation Indication.  This sequence\
    \ number could be a random\n      number.  At any time, implementations MUST ensure\
    \ there is no\n      collision between the sequence numbers of all outstanding\
    \ Binding\n      Revocation Indication Messages.\n   Proxy Binding (P)\n     \
    \ The Proxy Binding (P) bit is set by the initiator to indicate that\n      the\
    \ revoked binding(s) is a PMIPv6 binding.\n   IPv4 HoA Binding Only (V)\n    \
    \  The IPv4 HoA Binding Only (V) bit is set by the initiator, home\n      agent,\
    \ or local mobility anchor to indicate to the receiving\n      mobility entity\
    \ the termination of the IPv4 Home Address binding\n      only as in Sections\
    \ 7 and 8.1.\n   Global (G)\n      The Global (G) bit is set by the initiator,\
    \ LMA or MAG, to\n      indicate the termination of all Per-Peer mobility Bindings\
    \ or\n      Multiple Bindings that share a common identifier(s) and are served\n\
    \      by the initiator and responder as in Sections 8.1 and 9.2.\n   Reserved\n\
    \      These fields are unused.  They MUST be initialized to zero by the\n   \
    \   sender and MUST be ignored by the receiver.\n   Mobility Options\n      A\
    \ variable-length field of such length that the complete Mobility\n      Header\
    \ is an integer multiple of 8 octets long.  This field\n      contains zero or\
    \ more TLV-encoded mobility options.  This document\n      does not define any\
    \ new mobility option.  The receiver MUST ignore\n      and skip any options that\
    \ it does not understand.  These mobility\n      options are used by the responder\
    \ to identify the specific binding\n      or bindings that the initiator is requesting\
    \ be revoked.\n   The following options are valid in a Binding Revocation Indication:\n\
    \   o  Home Network Prefix option [RFC5213].  This option MAY be used\n      only\
    \ when the (P) bit is set.  This option MUST be present when\n      the BRI is\
    \ used to revoke a single Proxy MIPv6 Binding Cache\n      entry.\n   o  Mobile\
    \ Node Identifier option [RFC4283].  This option MUST be\n      present when the\
    \ (P) bit is set.  Additionally, if the Global (G)\n      bit is set by the mobile\
    \ access gateway, this option MUST carry\n      the MAG identity.  In this specification,\
    \ only the Mobile Node\n      Identifier option with subtype 1 is required and\
    \ other subtypes\n      are currently not supported.\n   o  Binding Identifier\
    \ mobility option [RFC5648].  This option MUST be\n      present if the initiator\
    \ requests to terminate one binding of a\n      multiple care-of address bindings\
    \ for the same mobile node.  The\n      initiator may include more than one of\
    \ the BID mobility options.\n   o  IPv4 Home Address option, which contains the\
    \ mobile node home IPv4\n      address [RFC5555].  This option MUST only be included\
    \ when the\n      IPv4 HoA Binding only (V) bit is set and the (P) bit is cleared.\n\
    \   o  IPv4 Home Address Request option, which contains the mobile node\n    \
    \  proxy home IPv4 address [RFC5844].  This option MUST only be\n      included\
    \ when the IPv4 HoA Binding only (V) and the (P) bits are\n      set.\n   o  Alternate\
    \ Care-of Address mobility option [RFC3775].  According to\n      [RFC5213], the\
    \ mobile access gateway is allowed to include this\n      option in the Proxy\
    \ Binding Update to indicate the proxy care-of\n      address of the mobile node\
    \ mobility session.  This option MAY be\n      included to indicate the proxy\
    \ care-of address of the mobile\n      node's binding that is being revoked. \
    \ In the case when the Global\n      (G) bit is set, this option identifies all\
    \ mobility bindings that\n      share the same proxy care-of address.\n   If no\
    \ mobility options are present in this message, 4 octets of\n   padding are necessary\
    \ and the Header Len field of the Binding\n   Revocation Message will be set to\
    \ 1.\n"
- title: 5.2.  Binding Revocation Acknowledgement Message
  contents:
  - "5.2.  Binding Revocation Acknowledgement Message\n   The Binding Revocation Acknowledgement\
    \ (BRA) message is a Binding\n   Revocation Message that has an MH type 16 and\
    \ a Binding Revocation\n   Type value of 2.  It is used to acknowledge the receipt\
    \ of a Binding\n   Revocation Indication message described in Section 5.1.  This\
    \ packet\n   is sent as described in Section 6.1.2.\n   When the value 2 is indicated\
    \ in the Binding Revocation Type field of\n   the Binding Revocation Message,\
    \ the format of the Binding Revocation\n   Message Data follows the Binding Revocation\
    \ Acknowledgement message\n   as in Figure 6.\n       0                   1  \
    \                 2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                       | B.R. Type = 2 |    Status     |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |            Sequence #         |P|V|G|       Reserved          |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n       |\
    \                                                               |\n       .  \
    \                                                             .\n       .    \
    \                    Mobility options                       .\n       .      \
    \                                                         .\n       |        \
    \                                                       |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \           Figure 6: Binding Revocation Acknowledgement Message\n   Status  8-bit\
    \ unsigned integer indicating the result of processing\n      the Binding Revocation\
    \ Indication message by the responder.\n      Values of the Status field less\
    \ than 128 indicate that the Binding\n      Revocation Indication was processed\
    \ successfully by the responder.\n      Values greater than or equal to 128 indicate\
    \ that the Binding\n      Revocation Indication was rejected by the responder.\
    \  The\n      following Status values are currently defined:\n            0  success\n\
    \            1  partial success\n          128  Binding Does NOT Exist\n     \
    \     129  IPv4 Home Address Option Required\n          130  Global Revocation\
    \ NOT Authorized\n          131  Revoked Mobile Nodes Identity Required\n    \
    \      132  Revocation Failed - MN is Attached\n          133  Revocation Trigger\
    \ NOT Supported\n          134  Revocation Function NOT Supported\n          135\
    \  Proxy Binding Revocation NOT Supported\n   Sequence Number\n      The sequence\
    \ number in the Binding Revocation Acknowledgement is\n      copied from the Sequence\
    \ Number field in the Binding Revocation\n      Indication.  It is used by the\
    \ initiator, e.g., HA, LMA, MAG, in\n      matching this Binding Revocation Acknowledgement\
    \ with the\n      outstanding Binding Revocation Indication.\n   Proxy Binding\
    \ (P)\n      The Proxy Binding (P) bit is set if the (P) bit is set in the\n \
    \     corresponding Binding Revocation Indication message.\n   IPv4 HoA Binding\
    \ Only (V)\n      The IPv4 HoA Binding Only (V) bit is set if the (V) bit is set\
    \ in\n      the corresponding Binding Revocation Indication message.\n   Global\
    \ (G)\n      The Global (G) bit is set if the (G) bit is set in the\n      corresponding\
    \ Binding Revocation Indication message.\n   Reserved\n      These fields are\
    \ unused.  They MUST be initialized to zero by the\n      sender and MUST be ignored\
    \ by the receiver.\n   Mobility Options\n      A variable-length field of such\
    \ length that the complete Mobility\n      Header is an integer multiple of 8\
    \ octets long.  This field\n      contains zero or more TLV-encoded mobility options.\
    \  In the case\n      when the Status field is set to success, no mobility option\
    \ is\n      required.  The mobility option(s) is usually used to communicate\n\
    \      information of the bindings that failed the revocation procedure.\n   The\
    \ following mobility options are valid in a Binding Revocation\n   Acknowledgement:\n\
    \   o  Home Network Prefix option [RFC5213].  This option MAY be included\n  \
    \    only when the (P) bit is set.\n   o  Mobile Node Identifier Option [RFC4283].\
    \  This option MAY be\n      included when the (P) bit is set.  This option SHOULD\
    \ be included\n      if the Home Network Prefix option is included.\n   o  Binding\
    \ Identifier mobility option [RFC5648].  The responder MAY\n      include this\
    \ option to indicate the specific BID that failed the\n      revocation procedure.\n\
    \   If no options are present in this message, 4 octets of padding are\n   necessary\
    \ and the Header Len field of the Binding Revocation Message\n   will be set to\
    \ 1.\n"
- title: 6.  Binding Revocation Process Operation
  contents:
  - "6.  Binding Revocation Process Operation\n   The following subsections describe\
    \ the details of the generic binding\n   revocation process as used by the different\
    \ mobility entities.\n"
- title: 6.1.  Sending Binding Revocation Message
  contents:
  - "6.1.  Sending Binding Revocation Message\n   When sending a Binding Revocation\
    \ message, the initiator constructs\n   the packet as it would do with any other\
    \ Mobility Header with the\n   exception of setting the MH Type field to 16.\n\
    \   The Binding Revocation Message MUST be protected using the same\n   underlying\
    \ security association, e.g., IPsec, that is being used\n   between the two peers\
    \ to protect the mobile node's Mobile IPv6 and\n   its extensions binding registration\
    \ signaling.  If IPsec is not used\n   as the underlying security mechanism to\
    \ protect the binding\n   registration signaling, the used underlying security\
    \ mechanism MUST\n   provide protection against all identified security threats\
    \ as\n   described under \"Security Considerations\" in [RFC3775] and [RFC5213].\n"
- title: 6.1.1.  Sending Binding Revocation Indication
  contents:
  - "6.1.1.  Sending Binding Revocation Indication\n   The initiator MUST construct\
    \ the Binding Revocation Message Data\n   following the format of the Binding\
    \ Revocation Indication message as\n   described in Section 5.1 and the following:\n\
    \   o  The initiator MUST set the Sequence Number field to a valid\n      sequence\
    \ number for Binding Revocation.  Since sending a Binding\n      Revocation Indication\
    \ message is not done on a regular basis, a\n      16-bit Sequence Number field\
    \ is large enough to allow the\n      initiator to match the Binding Revocation\
    \ Acknowledgement to the\n      associated Binding Revocation Indication using\
    \ the Sequence Number\n      field only.\n   o  If the initiator is revoking a\
    \ binding that was created using\n      proxy MIPv6 registration, the initiator\
    \ MUST set the Proxy Binding\n      (P) bit.\n   o  If the initiator is sending\
    \ the Binding Revocation Indication\n      message to revoke multiple mobility\
    \ sessions, the initiator MUST\n      set the Global (G) bit.  In this case, the\
    \ initiator MUST set the\n      Revocation Trigger field to a valid value from\
    \ the list of Global\n      Revocation Triggers.\n   o  If the initiator is sending\
    \ the Binding Revocation Indication\n      message with the Global (G) bit cleared,\
    \ the initiator MUST set\n      the Revocation Trigger field to a valid value\
    \ from the list of\n      Per-MN Revocation Triggers.\n   o  If the initiator\
    \ is sending the Binding Revocation Indication\n      message to indicate the\
    \ revocation of the mobile node IPv4 HoA\n      Binding Only, the initiator MUST\
    \ set the (V) bit.  In this case,\n      the initiator MUST include either the\
    \ IPv4 Home Address option or\n      the IPv4 Home Address Request option in the\
    \ BRI to identify the\n      IPv4 HoA that is being revoked.\n"
- title: 6.1.2.  Sending Binding Revocation Acknowledgement
  contents:
  - "6.1.2.  Sending Binding Revocation Acknowledgement\n   The responder MUST send\
    \ a Binding Revocation Acknowledgement message\n   to indicate the receipt and\
    \ the status of processing of the\n   corresponding Binding Revocation Indication\
    \ message as follows:\n   o  Whenever the Binding Revocation Indication is discarded,\
    \ e.g., as\n      described in Section 6.2, a Binding Revocation Acknowledgement\n\
    \      MUST NOT be sent.  Otherwise, the treatment depends on the\n      following\
    \ rules.\n   o  If the responder accepts the Binding Revocation Indication\n \
    \     message, the responder MUST send a successful Binding Revocation\n     \
    \ Acknowledgement with an appropriate status code.\n   o  If the responder rejects\
    \ the Binding Revocation Indication\n      message, the responder MUST send a\
    \ Binding Revocation\n      Acknowledgement with an appropriate failure status\
    \ code.\n   If the Source Address field of the IPv6 header that carried the\n\
    \   Binding Revocation Indication message does not contain a unicast\n   address,\
    \ the Binding Revocation Indication packet MUST be silently\n   discarded.\n \
    \  When the responder acknowledges the received Binding Revocation\n   Indication\
    \ message, the responder MUST construct the Binding\n   Revocation Message Data\
    \ following the format of the Binding\n   Revocation Acknowledgement message as\
    \ described in Section 5.2 and\n   the following:\n   o  The responder MUST set\
    \ the Sequence Number field by copying the\n      value from the Sequence Number\
    \ field of the received Binding\n      Revocation Indication.\n   o  The responder\
    \ MUST set the Status field to a valid value that\n      reflects the status of\
    \ the processing of the received Binding\n      Revocation Indication message.\n\
    \   o  If the (P) bit is set in the received Binding Revocation\n      Indication,\
    \ the responder MUST set the (P) bit in the Binding\n      Revocation Acknowledgement.\n\
    \   o  If the Global (G) bit is set in the received Binding Revocation\n     \
    \ Indication, the responder MUST set the Global (G) bit in the\n      Binding\
    \ Revocation Acknowledgement.\n   o  If the IPv4 HoA Binding Only (V) bit is set\
    \ in the received\n      Binding Revocation Indication, the responder MUST set\
    \ the (V) bit\n      in the Binding Revocation Acknowledgement.\n   o  The destination\
    \ IP address of the IPv6 packet of the Binding\n      Revocation Acknowledgement\
    \ is set to the source IP address of the\n      received Binding Revocation Indication.\n"
- title: 6.2.  Receiving Binding Revocation Message
  contents:
  - "6.2.  Receiving Binding Revocation Message\n   When receiving a Binding Revocation\
    \ Message, the responder MUST\n   verify the Mobility Header as described in Section\
    \ 9.2. of [RFC3775].\n   If the packet is dropped due to failing any of the Mobility\
    \ Header\n   test checks, the responder MUST follow the processing rules as in\n\
    \   Section 9.2 of [RFC3775].  If the responder does not support the\n   Binding\
    \ Revocation Indication message and does not recognize the MH\n   type 16, it\
    \ sends a Binding Error message with the Status field set\n   to 2 as described\
    \ in [RFC3775].\n   Upon receiving a packet carrying a Binding Revocation Message,\
    \ BRI or\n   BRA, the receiving mobility entity MUST verify that the packet was\n\
    \   received protected by the security association that is being used to\n   protect\
    \ the binding registration and Binding Revocation signaling\n   between the two\
    \ peers, e.g., an IPsec Security Association (SA).\n"
- title: 6.2.1.  Receiving Binding Revocation Indication
  contents:
  - "6.2.1.  Receiving Binding Revocation Indication\n   When the responder receives\
    \ a packet carrying a Binding Revocation\n   Indication message that was successfully\
    \ processed as in Section 6.2,\n   the responder, in addition, processes the message\
    \ as follows:\n   o  The responder MUST validate that the Binding Revocation Indication\n\
    \      is formatted as in Section 5.1.\n   o  If the Revocation Trigger field\
    \ is set to a value that the\n      responder does not support, the responder\
    \ SHOULD reject the\n      Binding Revocation Indication message using status\
    \ code\n      \"Revocation Trigger NOT Supported\".\n   o  If the Revocation Trigger\
    \ value is NOT allowed with the Binding\n      Revocation Indication message intent,\
    \ e.g., the Global (G) bit is\n      set and the Revocation Trigger field value\
    \ is Per-MN-specific, the\n      responder SHOULD reject the Binding Revocation\
    \ Indication message\n      using status code \"Revocation Function NOT Supported\"\
    .\n   o  If the responder failed to identify the mobile node(s) bindings as\n\
    \      identified in the Binding Revocation Indication message, the\n      responder\
    \ MUST reject the BRI using status code \"Binding Does NOT\n      Exist\".\n"
- title: 6.2.2.  Receiving Binding Revocation Acknowledgement
  contents:
  - "6.2.2.  Receiving Binding Revocation Acknowledgement\n   When the initiator receives\
    \ a packet carrying a Binding Revocation\n   Acknowledgement message that was\
    \ successfully processed as in\n   Section 6.2, the initiator, in addition, processes\
    \ the message and\n   examines the Status field as follows:\n   o  The initiator\
    \ MUST validate that the sequence number in the\n      Sequence Number field matches\
    \ the sequence number of an\n      outstanding Binding Revocation Indication that\
    \ was sent by the\n      initiator.  If the sequence number does not match a sequence\n\
    \      number of any of the outstanding Binding Revocation Indication\n      messages,\
    \ the initiator MUST silently discard the message but MAY\n      log the event.\n\
    \   o  If the Status field indicates that the Binding Revocation\n      Indication\
    \ was processed successfully, the initiator MUST delete\n      the current timer\
    \ and the mobile node(s) binding(s) and all\n      associated resources.\n   o\
    \  If the Status field indicates any value other than success, the\n      initiator\
    \ SHOULD examine any mobility options included in the\n      Binding Revocation\
    \ Acknowledgement.  In this case, it is based on\n      the initiator local policy\
    \ how to handle the mobile node binding.\n      The initiator MAY log the appropriate\
    \ event to reflect the\n      received status.\n"
- title: 6.3.  Retransmission of Binding Revocation Indication
  contents:
  - "6.3.  Retransmission of Binding Revocation Indication\n   If the initiator does\
    \ not receive a Binding Revocation\n   Acknowledgement in response to the outstanding\
    \ Binding Revocation\n   Indication before the InitMINDelayBRIs timer expires,\
    \ the initiator,\n   e.g., LMA, SHOULD retransmit the same BRI message up to the\n\
    \   BRIMaxRetriesNumber as defined in Section 11.\n   The retransmissions by the\
    \ initiator MUST use an exponential back-off\n   process in which the timeout\
    \ period is doubled upon each\n   retransmission, until either the initiator receives\
    \ a response or the\n   timeout period reaches the value MAX_BRACK_TIMEOUT.  The\
    \ initiator\n   MAY continue to send these messages at this slower rate up to\
    \ the\n   BRIMaxRetriesNumber.\n   If the initiator does not receive a Binding\
    \ Revocation\n   Acknowledgement message after the BRIMaxRetriesNumber of retransmits\n\
    \   have been sent, the initiator SHOULD clean up all resources\n   associated\
    \ with this mobile node binding.  The initiator may log the\n   event.\n"
- title: 7.  Home Agent Operation
  contents:
  - "7.  Home Agent Operation\n   To terminate a mobile node registration and its\
    \ current binding with\n   the home agent, the home agent sends a packet to the\
    \ mobile node\n   containing a Binding Revocation Indication, with the packet\n\
    \   constructed as follows:\n   o  The Revocation Trigger field MUST be set to\
    \ indicate to the mobile\n      node the reason for revoking its IP mobility binding\
    \ with the home\n      agent.  The Revocation Trigger may be used by the mobile\
    \ node to\n      take further steps if necessary.\n   o  The Binding Revocation\
    \ Indication MUST be sent using a Type 2\n      routing header that contains the\
    \ mobile node's registered IPv6\n      home address for the binding being revoked.\n\
    \   o  The care-of address for the binding MUST be used as the\n      destination\
    \ address in the packet's IPv6 header.\n   o  If the home agent needs to only\
    \ revoke the mobile node's IPv4 home\n      address binding, the home agent MUST\
    \ set the IPv4 HoA Binding Only\n      (V) bit and MUST include the mobile node's\
    \ registered IPv4 home\n      address that is being revoked in the IPv4 Home Address\
    \ option.\n   When the home agent sends a Binding Revocation Indication to the\n\
    \   mobile node, the home agent sets a flag in the mobile node BCE to\n   indicate\
    \ that revocation is in progress and starts the\n   InitMINDelayBRIs timer.  The\
    \ home agent maintains the mobile node BCE\n   in this state until it receives\
    \ a Binding Revocation Acknowledgement\n   or retransmits the Binding Revocation\
    \ Indication message as described\n   in Section 6.3.\n   In a race condition\
    \ case, the home agent may receive a Binding Update\n   from the mobile node while\
    \ the mobile node's BCE has the revocation\n   in progress flag set, the home\
    \ agent SHOULD handle this case based on\n   the reason for sending the Binding\
    \ Revocation Indication message and\n   its local policy.  In this case, if the\
    \ home agent accepts the\n   Binding Update, it needs to update the mobile node\
    \ BCE accordingly,\n   e.g., removing the revocation in progress flag.\n   When\
    \ the home agent needs to revoke one or more of a mobile node\n   bindings that\
    \ were created using multiple care-of address\n   registrations as in [RFC5648],\
    \ the home agent MUST include all the\n   related BID mobility options that identify\
    \ these bindings in the\n   Binding Revocation Indication message.  In the case\
    \ when the home\n   agent needs to revoke all of the mobile node bindings, the\
    \ home agent\n   SHOULD NOT include any of the BID mobility options.\n   When\
    \ the home agent receives a packet carrying a valid Binding\n   Revocation Acknowledgement\
    \ message, the home agent follows\n   Section 6.2 in processing this message.\n"
- title: 8.  Local Mobility Anchor Operation
  contents:
  - '8.  Local Mobility Anchor Operation

    '
- title: 8.1.  Sending Binding Revocation Indication
  contents:
  - "8.1.  Sending Binding Revocation Indication\n   To terminate a mobile node PMIPv6\
    \ registration and its current\n   binding with the local mobility anchor, the\
    \ local mobility anchor\n   sends a packet to the mobile access gateway containing\
    \ a Binding\n   Revocation Indication message following the procedure in Section\
    \ 6.1\n   and the following rules:\n   o  The Proxy Binding (P) bit MUST be set\
    \ to indicate that the binding\n      being revoked is a PMIPv6 binding.\n   o\
    \  The Revocation Trigger field MUST be set to indicate to the mobile\n      access\
    \ gateway the reason for removing the specified mobile node\n      PMIPv6 binding\
    \ at the local mobility anchor.  The Revocation\n      Trigger may be used by\
    \ the mobile access gateway to learn the\n      mobile node's latest movement.\n\
    \   o  The packet MUST contain the Mobile Node Identifier (MN-ID) option,\n  \
    \    which contains the mobile node's Network Access Identifier (NAI)\n      that\
    \ was used in the Proxy Binding Update during the mobile node\n      registration.\n\
    \   o  If the Mobile Node Identifier (MN-ID) is registered in more than\n    \
    \  one of the mobile node's BCEs and the local mobility anchor does\n      NOT\
    \ need to revoke all of the mobile node's bindings, the Binding\n      Revocation\
    \ Indication message MUST contain another identifier to\n      uniquely identify\
    \ the mobile node binding(s) that is being\n      revoked, e.g., at least one\
    \ Home Network Prefix option that\n      contains the mobile node's registered\
    \ Home Network Prefix (HNP)\n      for the binding being revoked.\n   o  In the\
    \ case of revoking all Per-Peer bindings, the local mobility\n      anchor MUST\
    \ set the Global (G) bit and the Revocation Trigger MUST\n      contain the value\
    \ \"Per-Peer Policy\" to request the mobile access\n      gateway to remove all\
    \ Per-Peer bindings that are registered with\n      the local mobility anchor\
    \ and this mobile access gateway.\n   o  The proxy care-of address for the binding\
    \ MUST be used as the\n      destination address in the packet's IPv6 header.\
    \  However, in the\n      case when IPsec is used to protect the Proxy MIPv6 signaling\
    \ as\n      specified in [RFC5213], the destination address MUST be set to the\n\
    \      mag_address that is being used for keying the IPsec SA.  If the\n     \
    \ mag_address is different than the mobile node proxy care-of\n      address,\
    \ the Alternate Care-of Address option MUST be included and\n      MUST contain\
    \ the mobile node proxy care-of address.\n   The local mobility anchor MAY delete\
    \ the mobile node(s) IP tunnel\n   immediately after sending the initial Binding\
    \ Revocation Indication\n   and before receiving the Binding Revocation Acknowledgement\
    \ message.\n   When the local mobility anchor sends a Binding Revocation Indication\n\
    \   to the mobile access gateway to remove a specific binding, the local\n   mobility\
    \ anchor sets a flag in the mobile node proxy BCE to indicate\n   that revocation\
    \ is in progress and starts the InitMINDelayBRIs timer.\n   The local mobility\
    \ anchor SHOULD maintain the mobile node proxy BCE\n   in this state until it\
    \ receives a Binding Revocation Acknowledgement\n   or the BRIMaxRetransmitNumber\
    \ is reached.  In the case when the local\n   mobility anchor sets the Revocation\
    \ Trigger field to a value that\n   indicates inter-MAG handover, the local mobility\
    \ anchor MAY switch\n   the mobile node IP tunnel to the target mobile access\
    \ gateway before\n   sending the Binding Revocation Indication to the source mobile\
    \ access\n   gateway.\n   In a race condition case, the local mobility anchor\
    \ may receive a\n   Proxy Binding Update from the mobile access gateway while\
    \ the mobile\n   node's proxy BCE has the revocation in progress flag set.  The\
    \ local\n   mobility anchor should handle this case based on the reason for\n\
    \   sending the Binding Revocation Indication message and its local\n   policy.\
    \  In this case, if the local mobility anchor accepts the Proxy\n   Binding Update,\
    \ it needs to update the mobile node proxy BCE\n   accordingly, e.g., removing\
    \ the revocation in progress flag.\n   When the local mobility anchor needs to\
    \ revoke all the mobile node\n   proxy BCEs that are registered with the local\
    \ mobility anchor and the\n   mobile access gateway peer, it MUST set the Global\
    \ (G) bit and set\n   the value of the Revocation Trigger field to \"Per-Peer\
    \ Policy\".  In\n   this case, the local mobility anchor MUST NOT include any\
    \ mobility\n   options in this Binding Revocation Indication message.\n   When\
    \ the local mobility anchor needs to revoke all mobile nodes proxy\n   BCEs that\
    \ belong to a specific realm and are registered with the\n   local mobility anchor\
    \ and the mobile access gateway peer, the local\n   mobility anchor MUST set the\
    \ Global (G) bit and set the value of the\n   Revocation Trigger field to \"Revoking\
    \ Mobility Node Local Policy\".\n   In this case, the local mobility anchor MUST\
    \ include a mobility\n   option in the Binding Revocation Indication that is shared\
    \ among all\n   the impacted mobile nodes BCEs, e.g., the mobile node identifier\n\
    \   option, MN-ID option, with a subtype value of 1.  In this case, the\n   NAI\
    \ value in the MN-ID MUST follow the format where the content after\n   the \"\
    @\" character defines the realm that is shared amongst all of the\n   impacted\
    \ mobile nodes proxy BCEs.  As an example: @example.com\n   identifies all mobile\
    \ nodes whose MN-ID value contains \"example.com\"\n   as the realm, e.g., \"\
    1234abdelta@example.com\", \"axxxyzd@example.com\",\n   and \"abcdefg.xyz123@example.com\"\
    , but not\n   \"1234abdelta@foo.example.com\".\n   When the local mobility anchor\
    \ needs to revoke a subgroup of the\n   mobile nodes proxy BCEs that belong to\
    \ a specific realm and are\n   registered with the local mobility anchor and the\
    \ mobile access\n   gateway, the local mobility anchor MUST set the Global (G)\
    \ bit and\n   set the value of the Revocation Trigger field to \"Revoking Mobility\n\
    \   Node Local Policy\".  In this case, the local mobility anchor MUST\n   include\
    \ an additional mobility option to the mobile node identifier\n   option (MN-ID)\
    \ option, with a subtype value of 1.  In other words,\n   the impacted mobile\
    \ node BCEs are those that have an MN-ID with a\n   realm as specified above and,\
    \ e.g., are assigned the same proxy\n   care-of address as the one included in\
    \ the Alternate Care-of Address\n   mobility option.\n   When the mobile node\
    \ is registered with multiple Home Network\n   Prefixes for the same proxy care-of\
    \ address, the local mobility\n   anchor SHOULD include an HNP option for each\
    \ registered HNP in the\n   Binding Revocation Indication.  Alternatively, it\
    \ MAY include only\n   the mobile node identifier (MN-ID) option with the mobile\
    \ node NAI\n   included to indicate to the mobile access gateway to remove all\n\
    \   bindings of the specified mobile node NAI in the MN-ID option.\n   According\
    \ to the Proxy Mobile IPv6 specification [RFC5213], if the\n   local mobility\
    \ anchor receives a Proxy Binding Update message from a\n   new mobile access\
    \ gateway for extending the binding lifetime of the\n   only BCE of this mobile\
    \ node with the Handoff Indicator value set to\n   \"Handoff state unknown (4)\"\
    , the local mobility anchor waits a period\n   of MaxDelayBeforeNewBCEAssign to\
    \ receive a de-registration message\n   from the previous mobile access gateway\
    \ before updating the mobile\n   node's BCE with the new point of attachment.\
    \  If a de-registration\n   message is not received, the local mobility anchor\
    \ considers the\n   received Proxy Binding Update message as a request for a new\
    \ BCE and\n   if processed successfully, the local mobility anchor assigns a\n\
    \   different HNP for the new BCE.\n   This document updates the local mobility\
    \ anchor's behavior in this\n   case.  If the local mobility anchor supports the\
    \ binding revocation\n   mechanism as described in this document, it SHOULD proactively\
    \ send a\n   Binding Revocation Indication message to the previous mobile access\n\
    \   gateway instead of waiting for a de-registration from the previous\n   mobile\
    \ access gateway.  In the Binding Revocation Indication message,\n   the Revocation\
    \ Trigger MUST be set to \"Inter-MAG Handover - Unknown\".\n   If the local mobility\
    \ anchor sent a Binding Revocation Indication\n   message with the Revocation\
    \ Trigger field set to \"Inter-MAG Handover\n   - Unknown\" and while waiting\
    \ for a response, Binding Revocation\n   Acknowledgement, the following are possible\
    \ conditions that the local\n   mobility anchor MUST handle as specified below:\n\
    \   o  If the local mobility anchor receives a successful Binding\n      Revocation\
    \ Acknowledgement message or a de-registration message\n      from the previous\
    \ mobile access gateway, the local mobility anchor\n      MUST update the mobile\
    \ node BCE as if it received a de-\n      registration message as described in\
    \ [RFC5213].\n   o  If the local mobility anchor receives a Binding Revocation\n\
    \      Acknowledgement message with the Status field set to \"Revocation\n   \
    \   Failed - MN is Attached\", the local mobility anchor SHOULD update\n     \
    \ the mobile node BCE as if it did NOT receive a de-registration\n      before\
    \ the MaxDelayBeforeNewBCEAssign timer expired by creating a\n      new BCE as\
    \ described in [RFC5213].\n   o  If the local mobility anchor did not receive\
    \ a Binding Revocation\n      Acknowledgement message or a de-registration Proxy\
    \ Binding Update\n      from the previous mobile access gateway after it exhausted\
    \ all of\n      the Binding Revocation Indication message retransmissions as\n\
    \      described in Section 6.3, the local mobility anchor SHOULD update\n   \
    \   the mobile node's BCE as if it did NOT receive a de-registration\n      before\
    \ the MaxDelayBeforeNewBCEAssign timer expired by creating a\n      new BCE as\
    \ described in [RFC5213].  Note that the local mobility\n      anchor SHOULD use\
    \ the recommended number of retransmissions for\n      the Binding Revocation\
    \ Indication message as described in\n      Section 11 to avoid delaying the creation\
    \ of a new Binding Cache\n      entry for too long, if the mobile node is actually\
    \ attaching to\n      the new MAG with a different interface.\n   When the mobile\
    \ node is registered with an IPv4 proxy home address in\n   addition to the Home\
    \ Network Prefix where both of the IPv4 proxy HoA\n   (pHoA) and HNP are bound\
    \ to the same proxy CoA (pCoA), the local\n   mobility anchor MAY revoke the mobile\
    \ node IPv4 proxy HoA binding to\n   the current mobile node proxy CoA while maintaining\
    \ the mobile node\n   binding of the HNP to its current pCoA as part of the mobile\
    \ node\n   BCE.  In this case, if the local mobility anchor decides to revoke\n\
    \   the mobile node IPv4 proxy HoA only, it MUST send a Binding\n   Revocation\
    \ Indication message following the procedure in Section 6.1\n   and the following\
    \ rules:\n   o  The IPv4 HoA Binding Only (V) bit MUST be set in the BRI to\n\
    \      indicate that only the IPv4 home address binding is being revoked.\n  \
    \ o  The IPv4 Home Address Request option MUST be included with the\n      mobile\
    \ node's registered proxy home IPv4 address that is being\n      released in addition\
    \ to the MN-ID option.\n   o  The mobile node Home Network Prefix option MUST\
    \ NOT be included.\n   o  The Revocation Trigger field MUST be set to an appropriate\
    \ value,\n      e.g., \"User Initiated Session(s) Termination\".\n"
- title: 8.2.  Receiving Binding Revocation Indication
  contents:
  - "8.2.  Receiving Binding Revocation Indication\n   When the local mobility anchor\
    \ receives a packet carrying a Binding\n   Revocation Indication that was successfully\
    \ processed as in\n   Section 6.2, the local mobility anchor processes the message\
    \ as\n   follows:\n   o  If the (P) bit is set, the local mobility anchor MUST\
    \ validate\n      that all impacted bindings have the proxy binding flag set.\n\
    \   o  If the Global (G) bit is set and the Revocation Trigger field\n      value\
    \ is \"Per-Peer Policy\", the LMA MUST validate that the Proxy\n      (P) bit\
    \ is set and the MN-ID option is present with the mobile\n      access gateway\
    \ identity included.  In addition, the local mobility\n      anchor MUST verify\
    \ that the identified mobile access gateway as\n      per the value in the MN-ID\
    \ option is authorized to use the global\n      revocation with revocation trigger\
    \ value \"Per-Peer Policy\", see\n      Section 13.  If the local mobility anchor\
    \ processes the Global\n      Binding Revocation Indication message successfully,\
    \ it MUST accept\n      the Binding Revocation Indication message using the status\
    \ code\n      \"success\".\n   o  If the mobile access gateway is not authorized\
    \ to use the Per-Peer\n      Global revocation feature or the received Binding\
    \ Revocation\n      Indication message has the Global (G) bit set and the Revocation\n\
    \      Trigger field is set to \"Per-Peer Policy\", but the MN-ID option is\n\
    \      not included, the local mobility anchor MUST reject the Binding\n     \
    \ Revocation Indication message using status code \"Global Revocation\n      NOT\
    \ Authorized\".\n   o  If the Global (G) bit is set and the Revocation Trigger\
    \ value is\n      \"Per-Peer Policy\", and only the mobile node identifier (MN-ID)\n\
    \      option is included, the local mobility anchor MUST revoke all\n      mobile\
    \ node bindings for which the proxy CoA is the one used as\n      the source of\
    \ the IPv6 packet that carried the Binding Revocation\n      Indication.  However,\
    \ if the Alternate Care-of Address option is\n      included in addition to the\
    \ mobile node identifier option, the\n      local mobility anchor MUST revoke\
    \ all mobile node bindings whose\n      proxy care-of address matches the care-of\
    \ address in the Alternate\n      Care-of Address option.  After the local mobility\
    \ anchor\n      successfully processes the Binding Revocation Indication message\n\
    \      and identifies all impacted mobile nodes bindings, it MUST accept\n   \
    \   the Binding Revocation Indication message using the status code\n      \"\
    success\".\n   o  If the local mobility anchor accepted the Binding Revocation\n\
    \      Indication message but one or more of the bindings identified in\n    \
    \  the received Binding Revocation Indication message has already\n      been\
    \ released, the local mobility anchor MUST accept the message\n      and it MAY\
    \ set the Status field to \"partial success\" and include\n      the mobile node\
    \ identifier (MN-ID) or the Home Network Prefix\n      option to identify the\
    \ binding(s) that failed the revocation\n      procedure.\n   o  If the Global\
    \ (G) bit is not set, the local mobility anchor uses\n      the included mobility\
    \ options to identify the impacted mobile node\n      binding as follows:\n  \
    \    1.  If only the mobile node identifier (MN-ID) option is included,\n    \
    \      the local mobility anchor MUST accept the message and revoke\n        \
    \  all bindings for this mobile node that use the specified\n          mobile\
    \ node NAI including the IPv4 Home Address binding(s) if\n          present.\n\
    \      2.  If the mobile node identifier (MN-ID) and one Home Network\n      \
    \    Prefix option are included, the local mobility anchor MUST\n          accept\
    \ the message and only remove the specified mobile node\n          proxy binding.\n\
    \      3.  If the mobile node identifier (MN-ID) option and more than one\n  \
    \        Home Network Prefix options are included, the local mobility\n      \
    \    anchor MUST accept the message and remove all bindings that\n          are\
    \ referenced by these Home Network Prefixes for the\n          specified mobile\
    \ node NAI.\n      4.  If the IPv4 HoA binding Only (V) bit is set and the mobile\n\
    \          node identifier (MN-ID) option and the IPv4 Home Address\n        \
    \  Request option are included, the local mobility anchor MUST\n          accept\
    \ the message and remove only the IPv4 HoA address\n          binding to the mobile\
    \ node current proxy care-of address.\n   The Revocation Trigger field value in\
    \ the received Binding Revocation\n   Indication could be used by the local mobility\
    \ anchor to log an event\n   or update some local parameters that track the state\
    \ of the peer\n   mobile access gateway.\n   After the local mobility anchor accepts\
    \ or rejects a Binding\n   Revocation Indication message, the local mobility anchor\
    \ MUST follow\n   Sections 6.1 and 6.1.2 to send a Binding Revocation Acknowledgement\n\
    \   message to the mobile access gateway.\n"
- title: 9.  Mobile Access Gateway Operation
  contents:
  - '9.  Mobile Access Gateway Operation

    '
- title: 9.1.  Receiving Binding Revocation Indication
  contents:
  - "9.1.  Receiving Binding Revocation Indication\n   When the mobile access gateway\
    \ receives a packet carrying a Binding\n   Revocation Indication that was successfully\
    \ processed as in\n   Section 6.2, the mobile access gateway processes the message\
    \ as\n   follows:\n   o  If the Global (G) bit is set and the Revocation Trigger\
    \ field\n      value is \"Per-Peer Policy\", the mobile access gateway MUST\n\
    \      validate that the Proxy (P) bit is set and no mobility options are\n  \
    \    included in the message.  If the mobile access gateway processes\n      the\
    \ Global Binding Revocation Indication message successfully, it\n      MUST accept\
    \ the Binding Revocation Indication message using the\n      status code \"success\"\
    .\n   o  If the Global (G) bit is set and the Revocation Trigger field\n     \
    \ value is \"Revoking Mobility Node Local Policy\", the mobile access\n      gateway\
    \ MUST validate that the Proxy (P) bit is set and at least\n      the MN-ID option\
    \ with the subtype value of 1 is included in the\n      Binding Revocation Indication\
    \ and it is formatted as described is\n      Section 8.1.  If the mobile access\
    \ gateway processes this Global\n      Binding Revocation Indication message successfully,\
    \ it MUST accept\n      the message using the status code \"success\".\n   o \
    \ If the Global (G) bit is set and the Revocation Trigger field\n      value is\
    \ \"Revoking Mobility Node Local Policy\", and no mobility\n      options are\
    \ included in the Binding Revocation Indication message\n      or the mobile access\
    \ gateway is not able to identify the impacted\n      mobile nodes bindings based\
    \ on the included mobility options, the\n      mobile access gateway MUST treat\
    \ this as an error scenario.  In\n      this case, the mobile access gateway MUST\
    \ reject the Binding\n      Revocation Indication message using status code \"\
    Revoked Mobile\n      Nodes Identity Required\".\n   o  If the Revocation Trigger\
    \ field value in the received Binding\n      Revocation Indication message indicates\
    \ inter-MAG handover, e.g.,\n      Inter-MAG Handover - Unknown, the mobile access\
    \ gateway uses the\n      mobility option(s) included in the Binding Revocation\
    \ Indication\n      message to identify the mobile node binding.  The mobile access\n\
    \      gateway SHOULD ensure that the mobile node is no longer attached\n    \
    \  to the mobile access gateway before accepting the BRI message\n      using\
    \ status code \"success\".  However, if the mobile access\n      gateway verified\
    \ that the mobile node is still directly attached,\n      the mobile access gateway\
    \ MUST reject the BRI using status code\n      \"Revocation failed - MN is Attached\"\
    .\n   o  If the IPv4 HoA Binding Only (V) bit is set, the mobile access\n    \
    \  gateway uses the MN-ID option to identify the mobile node binding\n      entry\
    \ in the Binding Update List (BUL).  The mobile access gateway\n      MUST verify\
    \ that the IPv4 address included in the IPv4 Home\n      Address Request option\
    \ in the received Binding Revocation\n      Indication is the same as the IPv4\
    \ proxy HoA that is assigned to\n      the mobile node.  After the mobile access\
    \ gateway successfully\n      validates the received IPv4 home address as the\
    \ mobile node IPv4\n      HoA, it MUST consider this as an indication to ONLY\
    \ release the\n      mobile node IPv4 proxy HoA binding to the mobile node current\n\
    \      proxy CoA.  Consequently, it MUST continue to maintain the mobile\n   \
    \   node IPv6 proxy HoA or HNP binding to the current mobile node\n      proxy\
    \ CoA as part of the mobile node binding in the BUL entry and\n      release all\
    \ resources associated with the MN IPv4 proxy HoA\n      binding to the MN pCoA.\
    \  If the mobile access gateway processed\n      the BRI successfully, the mobile\
    \ access gateway MUST accept the\n      BRI using status code \"success\".  On\
    \ the other hand, if the mobile\n      access gateway is able to identify the\
    \ mobile node binding using\n      the MN-ID but failed to identify the received\
    \ IPv4 proxy HoA, the\n      mobile access gateway MUST reject the BRI using status\
    \ code\n      \"Binding Does NOT Exist\".\n   o  If the mobile access gateway\
    \ accepts the Binding Revocation\n      Indication message but one or more of\
    \ the bindings identified in\n      the received Binding Revocation Indication\
    \ message has already\n      been released before processing the Binding Revocation\
    \ Indication,\n      the mobile access gateway MUST accept the Binding Revocation\n\
    \      Indication message.  In this case, the mobile access gateway MAY\n    \
    \  set the Status field to \"partial success\" and include the mobile\n      node\
    \ identifier (MN-ID) or the Home Network Prefix option to\n      identify the\
    \ binding(s) that failed to be removed as part of the\n      revocation procedure.\n\
    \   The Revocation Trigger field value in the received Binding Revocation\n  \
    \ Indication could be used by the mobile access gateway to define what\n   actions\
    \ the mobile access gateway could do to inform the mobile node\n   that its IP\
    \ connectivity to the current HNP has been terminated,\n   e.g., if the Revocation\
    \ Trigger field is set to \"Administrative\n   Reason\", the mobile access gateway\
    \ may terminate the IPv6 or IPv4\n   mobility session on the access link and notify\
    \ the mobile node.  The\n   specific details and considerations on how the mobile\
    \ access gateway\n   terminates IPv6 or IPv4 mobility session on the access link\
    \ and\n   notifies the mobile node can be found in [RFC5213] and [RFC5844].\n\
    \   After the mobile access gateway accepts or rejects a Binding\n   Revocation\
    \ Indication message, the mobile access gateway MUST follow\n   Sections 6.1 and\
    \ 6.1.2 to send a Binding Revocation Acknowledgement\n   message to the local\
    \ mobility anchor.\n"
- title: 9.2.  Sending Binding Revocation Indication
  contents:
  - "9.2.  Sending Binding Revocation Indication\n   The mobile access gateway could\
    \ send a Binding Revocation Indication\n   message to indicate the termination\
    \ of multiple mobile node bindings,\n   e.g., when using the global revocation\
    \ with the Global (G) bit set.\n   In this case, when an event occurs that requires\
    \ the mobile access\n   gateway to inform the local mobility anchor peer to terminate\
    \ all\n   mobile node bindings that are registered at the local mobility anchor\n\
    \   and the mobile access gateway, the mobile access gateway sends a\n   Binding\
    \ Revocation Indication message following the procedure in\n   Section 6.1 and\
    \ the following:\n   o  The Proxy Binding (P) bit MUST be set to indicate that\
    \ the\n      binding(s) being revoked is a PMIPv6 binding.\n   o  The Global (G)\
    \ bit MUST be set and the Revocation Trigger MUST\n      contain a value of \"\
    Per-Peer Policy\" in the Binding Revocation\n      Indication to request the local\
    \ mobility anchor to remove all Per-\n      Peer bindings that are registered\
    \ with the local mobility anchor\n      and the mobile access gateway.  In this\
    \ case, the MN-ID option\n      MUST be included in the Binding Revocation Indication\
    \ and contain\n      the mobile access gateway identity.  In addition, the mobile\n\
    \      access gateway MAY include the Alternate Care-of Address option.\n    \
    \  If included, the Alternate Care-of Address option MUST contain the\n      proxy\
    \ care-of address the bindings that are being impacted by this\n      Binding\
    \ Revocation Indication message.\n   o  The mobile access gateway address MAY\
    \ be used as the source\n      address in the packet's IPv6 header.\n   As described\
    \ in Section 6.3, the mobile access gateway SHOULD\n   retransmit the Binding\
    \ Revocation Indication to the local mobility\n   anchor until it receives a matching\
    \ Binding Revocation\n   Acknowledgement or the BRIMaxRetransmitNumber is reached.\
    \  The mobile\n   access gateway MAY delete the mobile node IP tunnels immediately\n\
    \   after sending the Binding Revocation Indication and before receiving\n   a\
    \ Binding Revocation Acknowledgement message from the LMA.\n   In response to\
    \ a Binding Revocation Indication message, if the mobile\n   access gateway receives\
    \ a packet carrying a Binding Revocation\n   Acknowledgement that was successfully\
    \ processed as in Section 6.2 and\n   the Status field indicates \"Global Revocation\
    \ NOT Authorized\", the\n   mobile access gateway is not authorized to participate\
    \ in a Per-Peer\n   Global Revocation.  The mobile access gateway SHOULD NOT retry\n\
    \   sending a Binding Revocation Indication with the Global (G) bit set\n   and\
    \ the Revocation Trigger field value set to \"Per-Peer Policy\" to\n   the same\
    \ local mobility agent.  The mobile access gateway should\n   raise an alarm or\
    \ log an event to indicate this rejection.\n"
- title: 10.  Mobile Node Operation
  contents:
  - "10.  Mobile Node Operation\n   Upon receiving a packet carrying a Binding Revocation\
    \ Indication, the\n   mobile node MUST validate the packet according to Section\
    \ 6.2 and the\n   following tests:\n   o  The mobile node MUST verify that the\
    \ IP address in the Type 2\n      routing header is its Home Address and that\
    \ its Binding Update\n      List contains an entry for that Home Address.  If\
    \ one of the tests\n      fails, the mobile node SHOULD silently discard the received\n\
    \      Binding Revocation Indication message.\n   o  If mobile node Binding Update\
    \ List contains an entry for the IP\n      address in the Type 2 routing header\
    \ of the received Binding\n      Revocation Indication packet, the mobile node\
    \ MUST accept the BRI\n      message using status code \"success\".\n   o  If\
    \ the IPv4 HoA Binding Only (V) bit is set in the received BRI\n      message,\
    \ the mobile node MUST verify that there is an IPv4 Home\n      Address option\
    \ in the received Binding Revocation Indication and\n      the IPv4 address included\
    \ in the IPv4 Home Address option is the\n      same as its IPv4 HoA that is assigned\
    \ to the mobile node.  If this\n      verification is successful, the mobile node\
    \ MUST consider this\n      Binding Revocation Indication as an indication to\
    \ ONLY release the\n      mobile node IPv4 HoA binding to its current care-of\
    \ address.\n      Consequently, the mobile node MUST continue to maintain its\
    \ IPv6\n      HoA binding to the current CoA as part of the mobile node binding\n\
    \      in the BUL entry and release all resources associated with the MN\n   \
    \   IPv4 HoA binding.  In this case, the mobile node MUST accept the\n      Binding\
    \ Revocation Indication message using status code \"success\".\n      On the other\
    \ hand, if the IPv4 Home Address Option was NOT\n      included in the received\
    \ BRI with the (V) bit is set, the MN MUST\n      reject the BRI message with\
    \ status code \"IPv4 Home Address Option\n      Required\".  Additionally, if\
    \ the IPv4 HoA received in the IPv4\n      Home Address Option is NOT the one\
    \ assigned to the mobile node,\n      the mobile node SHOULD reject the Binding\
    \ Revocation Indication\n      with status code \"Binding Does NOT Exist\".\n\
    \   o  The mobile node MUST verify that the (P) bit in the Binding\n      Revocation\
    \ Indication is NOT set.  If the (P) bit is set, the\n      mobile node MUST reject\
    \ the Binding Revocation Indication using\n      status code \"Proxy Binding Revocation\
    \ NOT Supported\".\n   o  If the mobile node has registered multiple care-of addresses\
    \ with\n      its home agent, the mobile node MUST verify which binding is being\n\
    \      revoked by examining the content of the Binding Revocation\n      Indication\
    \ message.  If the mobile node received a Binding\n      Revocation Indication\
    \ with one or more BID options and its home\n      address is included in the\
    \ Type 2 routing header, the mobile node\n      MUST consider all of the care-of\
    \ addresses bindings, identified in\n      the BID options, with this home address\
    \ as being revoked.  In this\n      case, if the BRI validation is successful,\
    \ the mobile node MUST\n      accept the Binding Revocation Indication message\
    \ with status code\n      \"success\".\n   o  If the mobile node has multiple\
    \ care-of address bindings with its\n      home agent and received a Binding Revocation\
    \ Indication, without\n      any BID option included and its home address was\
    \ included in the\n      Type 2 routing header, the mobile node MUST consider\
    \ all of its\n      registered care-of address bindings with this home address\
    \ as\n      being revoked.  If the mobile node validates the BRI successfully,\n\
    \      the mobile node MUST accept the Binding Revocation Indication\n      message\
    \ with status code \"success\".\n   If the mobile node accepts or rejects the\
    \ Binding Revocation\n   Indication message, the mobile node MUST follow Sections\
    \ 6.1 and\n   6.1.2 to send a Binding Revocation Acknowledgement message to the\n\
    \   home agent.  Note that anytime the MN does not send a Binding\n   Revocation\
    \ Acknowledgement to a BRI, the initiator is likely to\n   retransmit the BRI\
    \ at least one time.  This causes additional load on\n   the initiator who sends\
    \ the retransmissions, as well as on the MN\n   that will receive and process\
    \ them.\n   The Revocation Trigger field value in the received Binding Revocation\n\
    \   Indication could be used by the mobile node to define what action the\n  \
    \ mobile node could do to be able to register again and receive its IP\n   mobility\
    \ service, e.g., contacting its home operator.\n"
- title: 11.  Protocol Configuration Variables
  contents:
  - "11.  Protocol Configuration Variables\n   Any mobility entity that is allowed\
    \ to invoke the binding revocation\n   procedure by sending a Binding Revocation\
    \ Indication message SHOULD\n   allow the following variables to be configured.\n\
    \   BRI Maximum Number of Retries (BRIMaxRetriesNumber)\n      This variable specifies\
    \ the maximum Number of times a mobility\n      entity can retransmit a Binding\
    \ Revocation Indication message\n      before receiving a Binding Revocation Acknowledgement\
    \ message.\n      The default value for this parameter is 1.\n   Initial Minimum\
    \ Delay Between BRI messages (InitMINDelayBRIs)\n      This variable specifies\
    \ the initial delay timeout in seconds\n      before the revoking mobility entity\
    \ retransmits a BRI message.\n      The default is 1 second but is not to be configured\
    \ to less than\n      0.5 seconds.\n   Maximum BRA TIMEOUT (MAX_BRACK_TIMEOUT)\n\
    \      This variable specifies the maximum delay timeout in seconds\n      before\
    \ the revoking mobility entity retransmits a BRI message.\n      The default is\
    \ 2 seconds.\n"
- title: 12.  IANA Considerations
  contents:
  - "12.  IANA Considerations\n   This specification defines a new Binding Revocation\
    \ Message using a\n   new Mobility Header Type 16, as described in Section 5.\
    \  The new\n   Mobility Header type value needs to be assigned from the same\n\
    \   numbering space as allocated for the other Mobility Header types\n   registry.\n\
    \   This document also creates a new registry \"Binding Revocation Type\"\n  \
    \ that indicates the type of the binding revocation message.  The\n   current\
    \ binding revocation message types are described in Sections\n   5.1 and 5.2,\
    \ and are the following:\n       0  Reserved\n       1  Binding Revocation Indication\n\
    \       2  Binding Revocation Acknowledgement\n       All other values are unassigned\n\
    \   Future values of the Binding Revocation Type can be allocated using\n   Standards\
    \ Action or IESG Approval [RFC5226].\n   In addition, this document also creates\
    \ a second new registry for the\n   Revocation Trigger that indicates the reason\
    \ behind sending the\n   Binding Revocation Indication message.  The current Revocation\n\
    \   Trigger values are described in Section 5.1, and are the following:\n   Per-MN\
    \ Revocation Trigger Values:\n       0  Unspecified\n       1  Administrative\
    \ Reason\n       2  Inter-MAG Handover - same Access Type\n       3  Inter-MAG\
    \ Handover - different Access Type\n       4  Inter-MAG Handover - Unknown\n \
    \      5  User-Initiated Session(s) Termination\n       6  Access Network Session(s)\
    \ Termination\n       7  Possible Out-of-Sync BCE State\n   Global Revocation\
    \ Trigger Values:\n       128  Per-Peer Policy\n       129  Revoking Mobility\
    \ Node Local Policy\n   Reserved Revocation Trigger Values:\n       250-255 Reserved\
    \ For Testing Purposes only\n       All other values are Unassigned\n   Future\
    \ values of the Revocation Trigger can be allocated using\n   Standards Action\
    \ or IESG Approval [RFC5226].\n   Furthermore, this document creates a third new\
    \ registry \"Binding\n   Revocation Acknowledgement Status Codes\".  The current\
    \ values are\n   described in Section 5.2, and are the following:\n         0\
    \  success\n         1  partial success\n       128  Binding Does NOT Exist\n\
    \       129  IPv4 Home Address Option Required\n       130  Global Revocation\
    \ NOT Authorized\n       131  Revoked Mobile Nodes Identity Required\n       132\
    \  Revocation Failed - MN is Attached\n       133  Revocation Trigger NOT Supported\n\
    \       134  Revocation Function NOT Supported\n       135  Proxy Binding Revocation\
    \ NOT Supported\n   Future values of the Status field can be allocated using Standards\n\
    \   Action or IESG Approval [RFC5226].\n   All fields labeled \"Reserved\" are\
    \ only to be assigned through\n   Standards Action or IESG Approval.\n"
- title: 13.  Security Considerations
  contents:
  - "13.  Security Considerations\n   This specification allows the mobility node\
    \ that initiates the\n   binding revocation procedure to revoke a mobility session(s)\
    \ that is\n   currently registered with it.  It is NOT allowed for any mobility\n\
    \   node to revoke a mobile node mobility session that is not registered\n   with\
    \ this mobility node.\n   The binding revocation protocol described in this specification\
    \ uses\n   the same security association between the mobile node and the home\n\
    \   agent or the mobile access gateway and the local mobility anchor that\n  \
    \ is being used to exchange the MIPv6 or PMIPv6 Binding Update and\n   Binding\
    \ Acknowledgement signaling.  If IPsec is used, the traffic\n   selectors associated\
    \ with the Security Policy Database (SPD) entry\n   protecting the Binding Update\
    \ and Binding Acknowledgement MUST be\n   extended to include Binding Revocation\
    \ Message MH type 16.  Extending\n   the traffic selectors of the SPD entry in\
    \ order to reuse the SA\n   protecting the Binding Update and Binding Acknowledgement\
    \ (instead of\n   creating new ones) ensures that those SAs will be up and running\
    \ when\n   the revoking entity needs to send a binding revocation signaling\n\
    \   message.\n   On the other hand, if IPsec is not used as the underlying security\n\
    \   mechanism to protect the Mobile IPv6 and its extensions binding\n   registration\
    \ signaling, the used underlying security mechanism MUST\n   provide protection\
    \ against all identified security threats as\n   described under \"Security Considerations\"\
    \ in [RFC3775] and [RFC5213].\n   Since some mobility entities, e.g., local mobility\
    \ anchor and mobile\n   access gateway, are allowed to send and receive Binding\
    \ Revocation\n   Indications and Binding Revocation Acknowledgements for different\n\
    \   cases, when IPsec is used to secure signaling between the local\n   mobility\
    \ anchor and mobile access gateway, it prevents any of them\n   from processing\
    \ a Binding Revocation Message that was not constructed\n   by an authorized party.\n\
    \   The Proxy Mobile IPv6 [RFC5213] requires the local mobility anchor to\n  \
    \ restrict the creation and manipulation of proxy bindings to\n   specifically\
    \ authorized mobile access gateways.  Therefore, the\n   mobile access gateway\
    \ that is authorized to create or manipulate the\n   mobile node proxy BCE is\
    \ also authorized to revoke such mobile node\n   registration by sending a de-registration\
    \ with lifetime of zero.\n   However, since bulk termination using Binding Revocation\
    \ Indication\n   with the Global (G) bit set and the Revocation Trigger field\
    \ set to\n   \"Per-Peer Policy\" impacts all mobility sessions that are registered\n\
    \   with the mobile access gateway and its local mobility anchor peer,\n   the\
    \ local mobility anchor MUST be locally configurable to authorize\n   such specific\
    \ functionality.  Additional mechanisms, such as a policy\n   store or Authentication,\
    \ Authorization, and Accounting (AAA) may be\n   employed, but these are outside\
    \ the scope of this specification.\n"
- title: 14.  Acknowledgements
  contents:
  - "14.  Acknowledgements\n   The authors would like to thank Ryuji Wakikawa, Bruno\
    \ Mongazon-\n   Cazavet, Domagoj Premec, Arnaud Ebalard, Patrick Stupar, Vijay\n\
    \   Devarapalli, and Joel Hortelius for their review and comments of this\n  \
    \ document and all colleagues who have supported the advancement of\n   this effort.\n\
    \   Also, we would like to thank Jari Arkko, Ben Campbell, Pasi Eronen,\n   Ralph\
    \ Droms, Alexey Melnikov, Tim Polk, Adrian Farrel, and Robert\n   Sparks for their\
    \ reviews of this document as part of the IESG review\n   process.\n"
- title: 15.  References
  contents:
  - '15.  References

    '
- title: 15.1.  Normative References
  contents:
  - "15.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC5226]  Narten, T. and H. Alvestrand, \"Guidelines for Writing\
    \ an\n              IANA Considerations Section in RFCs\", BCP 26, RFC 5226,\n\
    \              May 2008.\n   [RFC3775]  Johnson, D., Perkins, C., and J. Arkko,\
    \ \"Mobility Support\n              in IPv6\", RFC 3775, June 2004.\n   [RFC4283]\
    \  Patel, A., Leung, K., Khalil, M., Akhtar, H., and K.\n              Chowdhury,\
    \ \"Mobile Node Identifier Option for Mobile IPv6\n              (MIPv6)\", RFC\
    \ 4283, November 2005.\n   [RFC5213]  Gundavelli, S., Leung, K., Devarapalli,\
    \ V., Chowdhury, K.,\n              and B. Patil, \"Proxy Mobile IPv6\", RFC 5213,\
    \ August 2008.\n   [RFC5844]  Wakikawa, R. and S. Gundavelli, \"IPv4 Support for\
    \ Proxy\n              Mobile IPv6\", RFC 5844, May 2010.\n   [RFC5648]  Wakikawa,\
    \ R., Devarapalli, V., Tsirtsis, G., Ernst, T.,\n              and K. Nagami,\
    \ \"Multiple Care-of Addresses Registration\",\n              RFC 5648, October\
    \ 2009.\n   [RFC5555]  Soliman, H., \"Mobile IPv6 Support for Dual Stack Hosts\
    \ and\n              Routers\", RFC 5555, June 2009.\n"
- title: 15.2.  Informative References
  contents:
  - "15.2.  Informative References\n   [RFC3344]  Perkins, C., \"IP Mobility Support\
    \ for IPv4\", RFC 3344,\n              August 2002.\n   [RFC3543]  Glass, S. and\
    \ M. Chandra, \"Registration Revocation in\n              Mobile IPv4\", RFC 3543,\
    \ August 2003.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ahmad Muhanna\n   Ericsson, Inc.\n   2201 Lakeside Blvd.\n\
    \   Richardson, TX  75082\n   USA\n   EMail: ahmad.muhanna@ericsson.com\n   Mohamed\
    \ Khalil\n   Ericsson, Inc.\n   6300 Legacy Dr.\n   Plano, TX  75024\n   USA\n\
    \   EMail: mohamed.khalil@ericsson.com\n   Sri Gundavelli\n   Cisco\n   170 West\
    \ Tasman Drive\n   San Jose, CA  95134\n   USA\n   EMail: sgundave@cisco.com\n\
    \   Kuntal Chowdhury\n   Cisco\n   30 International Place\n   Tewksbury, MA  01876\n\
    \   USA\n   EMail: kchowdhu@cisco.com\n   Parviz Yegani\n   Juniper Networks\n\
    \   1194 North Mathilda Avenue\n   Sunnyvale, CA  94089\n   USA\n   EMail: pyegani@juniper.net\n"
