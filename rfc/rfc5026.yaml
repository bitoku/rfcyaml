- title: __initial_text__
  contents:
  - '              Mobile IPv6 Bootstrapping in Split Scenario

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   A Mobile IPv6 node requires a Home Agent address, a home address,\
    \ and\n   IPsec security associations with its Home Agent before it can start\n\
    \   utilizing Mobile IPv6 service.  RFC 3775 requires that some or all of\n  \
    \ these are statically configured.  This document defines how a Mobile\n   IPv6\
    \ node can bootstrap this information from non-topological\n   information and\
    \ security credentials pre-configured on the Mobile\n   Node.  The solution defined\
    \ in this document solves the split\n   scenario described in the Mobile IPv6\
    \ bootstrapping problem statement\n   in RFC 4640.  The split scenario refers\
    \ to the case where the Mobile\n   Node's mobility service is authorized by a\
    \ different service provider\n   than basic network access.  The solution described\
    \ in this document\n   is also generically applicable to any bootstrapping case,\
    \ since other\n   scenarios are more specific realizations of the split scenario.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................3\n  \
    \ 3. Split Scenario ..................................................4\n   4.\
    \ Components of the Solution ......................................7\n   5. Protocol\
    \ Operations .............................................9\n      5.1. Home Agent\
    \ Address Discovery ...............................9\n           5.1.1. DNS Lookup\
    \ by Home Agent Name ......................10\n           5.1.2. DNS Lookup by\
    \ Service Name .........................10\n      5.2. IPsec Security Associations\
    \ Setup .........................11\n      5.3. Home Address Assignment ...................................11\n\
    \           5.3.1. Home Address Assignment by the Home Agent ..........11\n  \
    \         5.3.2. Home Address Auto-Configuration by the\n                  Mobile\
    \ Node ........................................12\n      5.4. Authorization and\
    \ Authentication with MSA .................14\n   6. Home Address Registration\
    \ in the DNS ...........................14\n   7. Summary of Bootstrapping Protocol\
    \ Flow .........................16\n   8. Option and Attribute Format ....................................17\n\
    \      8.1. DNS Update Mobility Option ................................17\n  \
    \    8.2. MIP6_HOME_PREFIX Attribute ................................19\n   9.\
    \ Security Considerations ........................................20\n      9.1.\
    \ HA Address Discovery ......................................20\n      9.2. Home\
    \ Address Assignment through IKEv2 .....................22\n      9.3. SA Establishment\
    \ Using EAP through IKEv2 ..................22\n      9.4. Backend Security between\
    \ the HA and AAA Server ............22\n      9.5. Dynamic DNS Update ........................................23\n\
    \   10. IANA Considerations ...........................................24\n  \
    \ 11. Contributors ..................................................24\n   12.\
    \ Acknowledgements ..............................................25\n   13. References\
    \ ....................................................25\n      13.1. Normative\
    \ References .....................................25\n      13.2. Informative\
    \ References ...................................26\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv6 [1] requires the Mobile Node to know its Home\
    \ Agent\n   Address, its own Home Address, and the cryptographic materials (e.g.,\n\
    \   shared keys or certificates) needed to set up IPsec security\n   associations\
    \ with the Home Agent (HA) in order to protect Mobile IPv6\n   signaling.  This\
    \ is generally referred to as the Mobile IPv6\n   bootstrapping problem [7].\n\
    \   The Mobile IPv6 base protocol does not specify any method to\n   automatically\
    \ acquire this information, which means that network\n   administrators are normally\
    \ required to manually set configuration\n   data on Mobile Nodes and HAs.  However,\
    \ in real deployments, manual\n   configuration does not scale as the Mobile Nodes\
    \ increase in number.\n   As discussed in [7], several bootstrapping scenarios\
    \ can be\n   identified depending on the relationship between the network operator\n\
    \   that authenticates a mobile node for granting network access service\n   (Access\
    \ Service Authorizer, ASA) and the service provider that\n   authorizes Mobile\
    \ IPv6 service (Mobility Service Authorizer, MSA).\n   This document describes\
    \ a solution to the bootstrapping problem that\n   is applicable in a scenario\
    \ where the MSA and the ASA are different\n   entities (i.e., a split scenario).\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [2].\n   General mobility terminology can be found in [8].  The following\n\
    \   additional terms are used here:\n   Access Service Authorizer (ASA)\n    \
    \  A network operator that authenticates a mobile node and\n      establishes\
    \ the mobile node's authorization to receive Internet\n      service.\n   Access\
    \ Service Provider (ASP)\n      A network operator that provides direct IP packet\
    \ forwarding to\n      and from the end host.\n   Mobility Service Authorizer\
    \ (MSA)\n      A service provider that authorizes Mobile IPv6 service.\n   Mobility\
    \ Service Provider (MSP)\n      A service provider that provides Mobile IPv6 service.\
    \  In order to\n      obtain such service, the mobile node must be authenticated\
    \ and\n      prove authorization to obtain the service.\n   Split scenario\n \
    \     A scenario where mobility service and network access service are\n     \
    \ authorized by different entities.  This implies that MSA is\n      different\
    \ from ASA.\n"
- title: 3.  Split Scenario
  contents:
  - "3.  Split Scenario\n   In the problem statement description [7], there is a clear\
    \ assumption\n   that mobility service and network access service can be separate.\n\
    \   This assumption implies that mobility service and network access\n   service\
    \ may be authorized by different entities.  As an example, the\n   service model\
    \ defined in [7] allows an enterprise network to deploy a\n   Home Agent and offer\
    \ Mobile IPv6 service to a user, even if the user\n   is accessing the Internet\
    \ independent of its enterprise account\n   (e.g., by using his personal WiFi\
    \ hotspot account at a coffee shop).\n   Therefore, in this document it is assumed\
    \ that network access and\n   mobility service are authorized by different entities,\
    \ which means\n   that authentication and authorization for mobility service and\n\
    \   network access will be considered separately.  This scenario is\n   called\
    \ split scenario.\n   Moreover, the model defined in [7] separates the entity\
    \ providing the\n   service from the entity that authenticates and authorizes\
    \ the user.\n   This is similar to the roaming model for network access.  Therefore,\n\
    \   in the split scenario, two different cases can be identified\n   depending\
    \ on the relationship between the entity that provides the\n   mobility service\
    \ (i.e., Mobility Service Provider, MSP) and the\n   entity that authenticates\
    \ and authorizes the user (i.e., Mobility\n   Service Authorizer, MSA).\n   Figure\
    \ 1 depicts the split scenario when the MSP and the MSA are the\n   same entity.\
    \  This means that the network operator that provides the\n   Home Agent authenticates\
    \ and authorizes the user for mobility\n   service.\n                        \
    \                   Mobility Service\n                                    Provider\
    \ and Authorizer\n               +-------------------------------------------+\n\
    \               |                                           |\n              \
    \ |  +-------------+                   +--+   |\n               |  | MSA/MSP AAA\
    \ |  <------------->  |HA|   |\n               |  |   server    |    AAA protocol\
    \   +--+   |\n               |  +-------------+                          |\n \
    \              |                                           |\n               +-------------------------------------------+\n\
    \                          +--+\n                          |MN|\n            \
    \              +--+\n                  Figure 1 -- Split Scenario (MSA == MSP)\n\
    \   Figure 2 shows the split scenario in case the MSA and the MSP are two\n  \
    \ different entities.  This might happen if the Mobile Node is far from\n   its\
    \ MSA network and is assigned a closer HA to optimize performance\n   or if the\
    \ MSA cannot provide any Home Agent and relies on a third\n   party (i.e., the\
    \ MSP) to grant mobility service to its users.  Notice\n   that the MSP might\
    \ or might not also be the network operator that is\n   providing network access\
    \ (i.e., ASP, Access Service Provider).\n                 Mobility Service\n \
    \                      Authorizer\n                  +-------------+\n       \
    \           |  MSA AAA    |\n                  |   server    |\n             \
    \     +-------------+\n                        ^\n                        |\n\
    \           AAA protocol |\n                        |                  Mobility\
    \ Service\n                        |                          Provider\n     \
    \          +--------|----------------------------------+\n               |   \
    \     V                                  |\n               |  +-------------+\
    \                   +--+   |\n               |  |  MSP AAA    |  <------------->\
    \  |HA|   |\n               |  |   server    |    AAA protocol   +--+   |\n  \
    \             |  +-------------+                          |\n               |\
    \                                           |\n               +-------------------------------------------+\n\
    \                          +--+\n                          |MN|\n            \
    \              +--+\n                 Figure 2 -- Split Scenario (MSA != MSP)\n\
    \   Note that Figure 1 and Figure 2 assume the use of an Authentication,\n   Authorization,\
    \ and Accounting (AAA) protocol to authenticate and\n   authorize the Mobile Node\
    \ for mobility service.  However, since the\n   Internet Key Exchange Protocol\
    \ (IKEv2) allows an Extensible\n   Authentication Protocol (EAP) client authentication\
    \ only and the\n   server authentication needs to be performed based on certificates\
    \ or\n   public keys, the Mobile Node potentially requires a Certificate\n   Revocation\
    \ List check (CRL check) even though an AAA protocol is used\n   to authenticate\
    \ and authorize the Mobile Node for mobility service.\n   If, instead, a Public\
    \ Key Infrastructure (PKI) is used, the Mobile\n   Node and HA use certificates\
    \ to authenticate each other and there is\n   no AAA server involved [9].  This\
    \ is conceptually similar to Figure\n   1, since the MSP == MSA, except the Home\
    \ Agent, and potentially the\n   Mobile Node, may require a certificate revocation\
    \ list check (CRL\n   check) with the Certification Authority (CA).  The CA may\
    \ be either\n   internal or external to the MSP.  Figure 3 illustrates this.\n\
    \                          Certification\n                            Authority\n\
    \                         +-------------+\n                         |    CA  \
    \     |\n                         |   server    |\n                         +-------------+\n\
    \                               ^\n                               |\n        \
    \          CRL Check    |\n                               |       Mobility Service\n\
    \                               |    Provider and Authorizer\n               \
    \       +--------|----------+\n                      |        V          |\n \
    \                     |  +-------------+  |\n                      |  |     HA\
    \      |  |\n                      |  |             |  |\n                   \
    \   |  +-------------+  |\n                      |                   |\n     \
    \                 +-------------------+\n                                 +--+\n\
    \                                 |MN|\n                                 +--+\n\
    \                 Figure 3 -- Split Scenario with PKI\n   For more details on\
    \ the use of PKI for IKEv2 authentication, please\n   refer to [3] and [10].\n\
    \   The split scenario is the simplest model that can be identified,\n   since\
    \ no assumptions about the access network are made.  This implies\n   that the\
    \ mobility service is bootstrapped independently from the\n   authentication protocol\
    \ for network access used (e.g., EAP or even\n   open access).  For this reason,\
    \ the solution described in this\n   document and developed for this scenario\
    \ could also be applied to the\n   integrated access-network deployment model\
    \ [7], even if it might not\n   be optimized.\n"
- title: 4.  Components of the Solution
  contents:
  - "4.  Components of the Solution\n   The bootstrapping problem is composed of different\
    \ sub-problems that\n   can be solved independently in a modular way.  The components\
    \ are\n   identified and a brief overview of their solution follow.\n   HA address\
    \ discovery\n      The Mobile Node needs to discover the address of its Home Agent.\n\
    \      The main objective of a bootstrapping solution is to minimize the\n   \
    \   data pre-configured on the Mobile Node.  For this reason, the\n      DHAAD\
    \ defined in [1] may not be applicable in real deployments\n      since it is\
    \ required that the Mobile Node is pre-configured with\n      the home network\
    \ prefix and does not allow an operator to load\n      balance by having Mobile\
    \ Nodes dynamically assigned to Home Agents\n      located in different subnets.\
    \  This document defines a solution\n      for Home Agent address discovery that\
    \ is based on Domain Name\n      Service (DNS), introducing a new DNS SRV record\
    \ [4].  The unique\n      information that needs to be pre-configured on the Mobile\
    \ Node is\n      the domain name of the MSP.\n   IPsec Security Associations setup\n\
    \      Mobile IPv6 requires that a Mobile Node and its Home Agent share\n    \
    \  an IPsec SA in order to protect binding updates and other Mobile\n      IPv6\
    \ signaling.  This document provides a solution that is based\n      on IKEv2\
    \ and follows what is specified in [3].  The IKEv2 peer\n      authentication\
    \ can be performed both using certificates and using\n      EAP depending on the\
    \ network operator's deployment model.\n   Home Address (HoA) assignment\n   \
    \   The Mobile Node needs to know its Home Address in order to\n      bootstrap\
    \ Mobile IPv6 operation.  The Home Address is assigned by\n      the Home Agent\
    \ during the IKEv2 exchange (as described in [3]).\n      The solution defined\
    \ in this document also allows the Mobile Node\n      to auto-configure its Home\
    \ Address based on stateless auto-\n      configuration [11], Cryptographically\
    \ Generated Addresses [12], or\n      privacy addresses [13].\n   Authentication\
    \ and Authorization with MSA\n      The user must be authenticated in order for\
    \ the MSP to grant the\n      service.  Since the user credentials can be verified\
    \ only by the\n      MSA, this authorization step is performed by the MSA.  Moreover,\n\
    \      the mobility service must be explicitly authorized by the MSA\n      based\
    \ on the user's profile.  These operations are performed in\n      different ways\
    \ depending on the credentials used by the Mobile\n      Node during the IKEv2\
    \ peer authentication and on the backend\n      infrastructure (PKI or AAA).\n\
    \   An optional part of bootstrapping involves providing a way for the\n   Mobile\
    \ Node to have its Fully Qualified Domain Name (FQDN) updated in\n   the DNS with\
    \ a dynamically assigned home address.  While not all\n   applications will require\
    \ this service, many networking applications\n   use the FQDN to obtain an address\
    \ for a node prior to starting IP\n   traffic with it.  The solution defined in\
    \ this document specifies\n   that the dynamic DNS update is performed by the\
    \ Home Agent or through\n   the AAA infrastructure, depending on the trust relationship\
    \ in place.\n"
- title: 5.  Protocol Operations
  contents:
  - "5.  Protocol Operations\n   This section describes in detail the procedures needed\
    \ to perform\n   Mobile IPv6 bootstrapping based on the components identified\
    \ in the\n   previous section.\n"
- title: 5.1.  Home Agent Address Discovery
  contents:
  - "5.1.  Home Agent Address Discovery\n   Once a Mobile Node has obtained network\
    \ access, it can perform Mobile\n   IPv6 bootstrapping.  For this purpose, the\
    \ Mobile Node queries the\n   DNS server to request information on Home Agent\
    \ service.  As\n   mentioned before in the document, the Mobile Node should be\
    \ pre-\n   configured with the domain name of the Mobility Service Provider.\n\
    \   The Mobile Node needs to obtain the IP address of a DNS server before\n  \
    \ it can send a DNS request.  This can be configured on the Mobile Node\n   or\
    \ obtained through DHCPv6 from the visited link [14].  In any case,\n   it is\
    \ assumed that there is some kind of mechanism by which the\n   Mobile Node is\
    \ configured with a DNS server since a DNS server is\n   needed for many other\
    \ reasons.\n   Two options for DNS lookup for a Home Agent address are identified\
    \ in\n   this document: DNS lookup by Home Agent Name and DNS lookup by\n   service\
    \ name.\n   This document does not provide a specific mechanism to load balance\n\
    \   different Mobile Nodes among Home Agents.  It is possible for an MSP\n   to\
    \ achieve coarse-grained load balancing by dynamically updating the\n   SRV RR\
    \ priorities to reflect the current load on the MSP's collection\n   of Home Agents.\
    \  Mobile Nodes then use the priority mechanism to\n   preferentially select the\
    \ least loaded HA.  The effectiveness of this\n   technique depends on how much\
    \ of a load it will place on the DNS\n   servers, particularly if dynamic DNS\
    \ is used for frequent updates.\n   While this document specifies a Home Agent\
    \ Address Discovery solution\n   based on DNS, when the ASP and the MSP are the\
    \ same entity, DHCP may\n   be used.  See [15] for details.\n"
- title: 5.1.1.  DNS Lookup by Home Agent Name
  contents:
  - "5.1.1.  DNS Lookup by Home Agent Name\n   In this case, the Mobile Node is configured\
    \ with the Fully Qualified\n   Domain Name of the Home Agent.  As an example,\
    \ the Mobile Node could\n   be configured with the name \"ha1.example.com\", where\
    \ \"example.com\" is\n   the domain name of the MSP granting the mobility service.\n\
    \   The Mobile Node constructs a DNS request by setting the QNAME to the\n   name\
    \ of the Home Agent.  The request has QTYPE set to \"AAAA\" so that\n   the DNS\
    \ server sends the IPv6 address of the Home Agent.  Once the\n   DNS server replies\
    \ to this query, the Mobile Node knows its Home\n   Agent address and can run\
    \ IKEv2 in order to set up the IPsec SAs and\n   get a Home Address.\n   Note\
    \ that the configuration of a home agent FQDN on the mobile node\n   can also\
    \ be extended to dynamically assign a local home agent from\n   the visited network.\
    \  Such dynamic assignment would be useful, for\n   instance, from the point of\
    \ view of improving routing efficiency in\n   bidirectional tunneling mode.  Enhancements\
    \ or conventions for\n   dynamic assignment of local home agents are outside the\
    \ scope of this\n   specification.\n"
- title: 5.1.2.  DNS Lookup by Service Name
  contents:
  - "5.1.2.  DNS Lookup by Service Name\n   RFC 2782 [4] defines the service resource\
    \ record (SRV RR) that allows\n   an operator to use several servers for a single\
    \ domain, to move\n   services from host to host, and to designate some hosts\
    \ as primary\n   servers for a service and others as backups.  Clients ask for\
    \ a\n   specific service/protocol for a specific domain and get back the\n   names\
    \ of any available servers.\n   RFC 2782 [4] also describes the policies to choose\
    \ a service agent\n   based on the preference and weight values.  The DNS SRV\
    \ record may\n   contain the preference and weight values for multiple Home Agents\n\
    \   available to the Mobile Node in addition to the Home Agent FQDNs.  If\n  \
    \ multiple Home Agents are available in the DNS SRV record, then the\n   Mobile\
    \ Node is responsible for processing the information as per\n   policy and for\
    \ picking one Home Agent.  If the Home Agent of choice\n   does not respond to\
    \ the IKE_SA_INIT messages or if IKEv2\n   authentication fails, the Mobile Node\
    \ SHOULD try the next Home Agent\n   on the list.  If none of the Home Agents\
    \ respond, the Mobile Node\n   SHOULD try again after a period of time that is\
    \ configurable on the\n   Mobile Node.  If IKEv2 authentication fails with all\
    \ Home Agents, it\n   is an unrecoverable error on the Mobile Node.\n   The service\
    \ name for Mobile IPv6 Home Agent service, as required by\n   RFC 2782, is \"\
    mip6\" and the protocol name is \"ipv6\".  Note that a\n   transport name cannot\
    \ be used here because Mobile IPv6 does not run\n   over a transport protocol.\n\
    \   The SRV RR has a DNS type code of 33.  As an example, the Mobile\n   constructs\
    \ a request with QNAME set to \"_mip6._ipv6.example.com\" and\n   QTYPE to SRV.\
    \  The reply contains the FQDNs of one or more servers\n   that can then be resolved\
    \ in a separate DNS transaction to the IP\n   addresses.  However, if there is\
    \ room in the SRV reply, it is\n   RECOMMENDED that the DNS server also return\
    \ the IP addresses of the\n   Home Agents in AAAA records as part of the additional\
    \ data section\n   (in order to avoid requiring an additional DNS round trip to\
    \ resolve\n   the FQDNs).\n"
- title: 5.2.  IPsec Security Associations Setup
  contents:
  - "5.2.  IPsec Security Associations Setup\n   As soon as the Mobile Node has discovered\
    \ the Home Agent Address, it\n   establishes an IPsec Security Association with\
    \ the Home Agent itself\n   through IKEv2.  The detailed description of this procedure\
    \ is\n   provided in [3].  If the Mobile Node wants the HA to register the\n \
    \  Home Address in the DNS, it MUST use the FQDN as the initiator\n   identity\
    \ in the IKE_AUTH step of the IKEv2 exchange (IDi).  This is\n   needed because\
    \ the Mobile Node has to prove it is the owner of the\n   FQDN provided in the\
    \ subsequent DNS Update Option.  See Sections 6\n   and 9 for a more detailed\
    \ analysis on this issue.\n   The IKEv2 Mobile Node to Home Agent authentication\
    \ can be performed\n   using either IKEv2 public key signatures or the Extensible\n\
    \   Authentication Protocol (EAP).  The details about how to use IKEv2\n   authentication\
    \ are described in [3] and [5].  The choice of an IKEv2\n   peer authentication\
    \ method depends on the deployment.  The Mobile\n   Node should be configured\
    \ with the information on which IKEv2\n   authentication method to use.  However,\
    \ IKEv2 restricts the Home\n   Agent to Mobile Node authentication to use public\
    \ key signature-based\n   authentication.\n"
- title: 5.3.  Home Address Assignment
  contents:
  - "5.3.  Home Address Assignment\n   Home Address assignment is performed during\
    \ the IKEv2 exchange.  The\n   Home Address can be assigned directly by the Home\
    \ Agent or it can be\n   auto-configured by the Mobile Node.\n"
- title: 5.3.1.  Home Address Assignment by the Home Agent
  contents:
  - "5.3.1.  Home Address Assignment by the Home Agent\n   When the Mobile Node runs\
    \ IKEv2 with its Home Agent, it can request a\n   HoA through the Configuration\
    \ Payload in the IKE_AUTH exchange by\n   including an INTERNAL_IP6_ADDRESS attribute.\
    \  When the Home Agent\n   processes the message, it allocates a HoA and sends\
    \ it a CFG_REPLY\n   message.  The Home Agent could consult a DHCP server on the\
    \ home link\n   for the actual home address allocation.  This is explained in\
    \ detail\n   in [3].\n"
- title: 5.3.2.  Home Address Auto-Configuration by the Mobile Node
  contents:
  - "5.3.2.  Home Address Auto-Configuration by the Mobile Node\n   With the type\
    \ of assignment described in the previous section, the\n   Home Address cannot\
    \ be generated based on Cryptographically Generated\n   Addresses (CGAs) [12]\
    \ or based on the privacy extensions for\n   stateless auto-configuration [13].\
    \  However, the Mobile Node might\n   want to have an auto-configured HoA based\
    \ on these mechanisms.  It is\n   worthwhile to mention that the auto-configuration\
    \ procedure described\n   in this section cannot be used in some possible deployments,\
    \ since\n   the Home Agents might be provisioned with pools of allowed Home\n\
    \   Addresses.\n   In the simplest case, the Mobile Node is provided with a pre-\n\
    \   configured home prefix and home prefix length.  In this case, the\n   Mobile\
    \ Node creates a Home Address based on the pre-configured prefix\n   and sends\
    \ it to the Home Agent, including an INTERNAL_IP6_ADDRESS\n   attribute in a Configuration\
    \ Payload of type CFG_REQUEST.  If the\n   Home Address is valid, the Home Agent\
    \ replies with a CFG_REPLY,\n   including an INTERNAL_IP6_ADDRESS with the same\
    \ address.  If the Home\n   Address provided by the Mobile Node is not valid,\
    \ the Home Agent\n   assigns a different Home Address including an INTERNAL_IP6_ADDRESS\n\
    \   attribute with a new value.  According to [5], the Mobile Node MUST\n   use\
    \ the address sent by the Home Agent.  Later, if the Mobile Node\n   wants to\
    \ use an auto-configured Home Address (e.g., based on CGA), it\n   can run Mobile\
    \ Prefix Discovery, obtain a prefix, auto-configure a\n   new Home Address, and\
    \ then perform a new CREATE_CHILD_SA exchange.\n   If the Mobile Node is not provided\
    \ with a pre-configured Home Prefix,\n   the Mobile cannot simply propose an auto-configured\
    \ HoA in the\n   Configuration Payload since the Mobile Node does not know the\
    \ home\n   prefix before the start of the IKEv2 exchange.  The Mobile Node must\n\
    \   obtain the home prefix and the home prefix length before it can\n   configure\
    \ a home address.\n   One simple solution would be for the Mobile Node to just\
    \ assume that\n   the prefix length on the home link is 64 bits and extract the\
    \ home\n   prefix from the Home Agent's address.  The disadvantage with this\n\
    \   solution is that the home prefix cannot be anything other than /64.\n   Moreover,\
    \ this ties the prefix on the home link and the Home Agent's\n   address, but,\
    \ in general, a Home Agent with a particular address\n   should be able to serve\
    \ a number of prefixes on the home link, not\n   just the prefix from which its\
    \ address is configured.\n   Another solution would be for the Mobile Node to\
    \ assume that the\n   prefix length on the home link is 64 bits and send its interface\n\
    \   identifier to the Home Agent in the INTERNAL_IP6_ADDRESS attribute\n   within\
    \ the CFG_REQ payload.  Even though this approach does not tie\n   the prefix\
    \ on the home link and the Home Agent's address, it still\n   requires that the\
    \ home prefix length is 64 bits.\n   For this reason, the Mobile Node needs to\
    \ obtain the home link\n   prefixes through the IKEv2 exchange.  In the Configuration\
    \ Payload\n   during the IKE_AUTH exchange, the Mobile Node includes the\n   MIP6_HOME_PREFIX\
    \ attribute in the CFG_REQUEST message.  The Home\n   Agent, when it processes\
    \ this message, MUST include in the CFG_REPLY\n   payload prefix information for\
    \ one prefix on the home link.  This\n   prefix information includes the prefix\
    \ length (see Section 8.2).  The\n   Mobile Node auto-configures a Home Address\
    \ from the prefix returned\n   in the CFG_REPLY message and runs a CREATE_CHILD_SA\
    \ exchange to\n   create security associations for the new Home Address.\n   As\
    \ mentioned before in this document, there are deployments where\n   auto-configuration\
    \ of the Home Address cannot be used.  In this case,\n   when the Home Agent receives\
    \ a CFG_REQUEST that includes a\n   MIP6_HOME_PREFIX attribute in the subsequent\
    \ IKE response, it\n   includes a Notify Payload type \"USE_ASSIGNED_HoA\" and\
    \ the related\n   Home Address in a INTERNAL_IP6_ADDRESS attribute.  If the Mobile\
    \ Node\n   gets a \"USE_ASSIGNED_HoA\" Notify Payload in response to the\n   Configuration\
    \ Payload containing the MIP6_HOME_PREFIX attribute, it\n   looks for an INTERNAL_IP6_ADDRESS\
    \ attribute and MUST use the address\n   contained in it in the subsequent CREATE_CHILD_SA\
    \ exchange.\n   When the Home Agent receives a Binding Update for the Mobile Node,\
    \ it\n   performs proxy DAD for the auto-configured Home Address.  If DAD\n  \
    \ fails, the Home Agent rejects the Binding Update.  If the Mobile Node\n   receives\
    \ a Binding Acknowledgement with status 134 (DAD failed), it\n   MUST stop using\
    \ the current Home Address, configure a new HoA, and\n   then run IKEv2 CREATE_CHILD_SA\
    \ exchange to create security\n   associations based on the new HoA.  The Mobile\
    \ Node does not need to\n   run IKE_INIT and IKE_AUTH exchanges again.  Once the\
    \ necessary\n   security associations are created, the Mobile Node sends a Binding\n\
    \   Update for the new Home Address.\n   It is worth noting that with this mechanism,\
    \ the prefix information\n   carried in MIP6_HOME_PREFIX attribute includes only\
    \ one prefix and\n   does not carry all the information that is typically present\
    \ when\n   received through a IPv6 router advertisement.  Mobile Prefix\n   Discovery,\
    \ specified in RFC 3775, is the mechanism through which the\n   Mobile Node can\
    \ get all prefixes on the home link and all related\n   information.  That means\
    \ that MIP6_HOME_PREFIX attribute is only used\n   for Home Address auto-configuration\
    \ and does not replace the usage of\n   Mobile Prefix Discovery for the purposes\
    \ detailed in RFC 3775.\n"
- title: 5.4.  Authorization and Authentication with MSA
  contents:
  - "5.4.  Authorization and Authentication with MSA\n   In a scenario where the Home\
    \ Agent is discovered dynamically by the\n   Mobile Node, it is very likely that\
    \ the Home Agent is not able to\n   verify by its own the credentials provided\
    \ by the Mobile Node during\n   the IKEv2 exchange.  Moreover, the mobility service\
    \ needs to be\n   explicitly authorized based on the user's profile.  As an example,\n\
    \   the Home Agent might not be aware of whether the mobility service can\n  \
    \ be granted at a particular time of the day or when the credit of the\n   Mobile\
    \ Node is going to expire.\n   Due to all these reasons, the Home Agent may need\
    \ to contact the MSA\n   in order to authenticate the Mobile Node and authorize\
    \ mobility\n   service.  This can be accomplished based on a Public Key\n   Infrastructure\
    \ if certificates are used and a PKI is deployed by the\n   MSP and MSA.  On the\
    \ other hand, if the Mobile Node is provided with\n   other types of credentials,\
    \ the AAA infrastructure must be used.\n   The definition of this backend communication\
    \ is out of the scope of\n   this document.  In [16], a list of goals for such\
    \ a communication is\n   provided. [17] and [18] define the RADIUS and Diameter\
    \ extensions,\n   respectively, for the backend communication.\n"
- title: 6.  Home Address Registration in the DNS
  contents:
  - "6.  Home Address Registration in the DNS\n   In order that the Mobile Node is\
    \ reachable through its dynamically\n   assigned Home Address, the DNS needs to\
    \ be updated with the new Home\n   Address.  Since applications make use of DNS\
    \ lookups on FQDN to find\n   a node, the DNS update is essential for providing\
    \ IP reachability to\n   the Mobile Node, which is the main purpose of the Mobile\
    \ IPv6\n   protocol.  The need for DNS updating is not discussed in RFC 3775\n\
    \   since it assumes that the Mobile Node is provisioned with a static\n   Home\
    \ Address.  However, when a dynamic Home Address is assigned to\n   the Mobile\
    \ Node, any existing DNS entry becomes invalid and the\n   Mobile Node becomes\
    \ unreachable unless a DNS update is performed.\n   Since the DNS update must\
    \ be performed securely in order to prevent\n   attacks or modifications from\
    \ malicious nodes, the node performing\n   this update must share a security association\
    \ with the DNS server.\n   Having all possible Mobile Nodes sharing a security\
    \ association with\n   the DNS servers of the MSP might be cumbersome from an\
    \ administrative\n   perspective.  Moreover, even if a Mobile Node has a security\n\
    \   association with a DNS server of its MSP, an address authorization\n   issue\
    \ comes into the picture.  A detailed analysis of possible\n   threats against\
    \ DNS update is provided in Section 9.5.\n   Therefore, due to security and administrative\
    \ reasons, it is\n   RECOMMENDED that the Home Agent perform DNS entry updates\
    \ for the\n   Mobile Node.  For this purpose, the Mobile Node MAY include a new\n\
    \   mobility option in the Binding Update, the DNS Update option, with\n   the\
    \ flag R not set in the option.  This option is defined in Section\n   8 and includes\
    \ the FQDN that needs to be updated.  After receiving\n   the Binding Update,\
    \ the Home Agent MUST update the DNS entry with the\n   identifier provided by\
    \ the Mobile Node and the Home Address included\n   in the Home Address Option.\
    \  The procedure for sending a dynamic DNS\n   update message is specified in\
    \ [6].  The dynamic DNS update SHOULD be\n   performed in a secure way; for this\
    \ reason, the usage of TKEY and\n   TSEC or DNSSEC is recommended (see Section\
    \ 9.5 for details).  As soon\n   as the Home Agent has updated the DNS, it MUST\
    \ send a Binding\n   Acknowledgement message to the Mobile Node, including the\
    \ DNS Update\n   mobility option with the correct value in the Status field (see\n\
    \   Section 8.1).\n   This procedure can be performed directly by the Home Agent\
    \ if the\n   Home Agent has a security association with the domain specified in\n\
    \   the Mobile Node's FQDN.\n   On the other hand, if the Mobile Node wants to\
    \ be reachable through a\n   FQDN that belongs to the MSA, the Home Agent and\
    \ the DNS server that\n   must be updated belong to different administrative domains.\
    \  In this\n   case, the Home Agent may not share a security association with\
    \ the\n   DNS server and the DNS entry update can be performed by the AAA\n  \
    \ server of the MSA.  In order to accomplish this, the Home Agent sends\n   to\
    \ the AAA server the FQDN-HoA pair through the AAA protocol.  This\n   message\
    \ is proxied by the AAA infrastructure of the MSP and is\n   received by the AAA\
    \ server of the MSA.  The AAA server of the MSA\n   performs the DNS update based\
    \ on [6].  Notice that, even in this\n   case, the Home Agent is always required\
    \ to perform a DNS update for\n   the reverse entry, since this is always performed\
    \ in the DNS server\n   of the MSP.  The detailed description of the communication\
    \ between\n   Home Agent and AAA is out of the scope of this document.  More\n\
    \   details are provided in [16].\n   A mechanism to remove stale DNS entries\
    \ is needed.  A DNS entry\n   becomes stale when the related Home Address is no\
    \ longer used by the\n   Mobile Node.  To remove a DNS entry, the Mobile Node\
    \ includes in the\n   Binding Update the DNS Update mobility option, with the\
    \ flag R set in\n   the option.  After receiving the Binding Update, the Home\
    \ Agent MUST\n   remove the DNS entry identified by the FQDN provided by the Mobile\n\
    \   Node and the Home Address included in the Home Address Option.  The\n   procedure\
    \ for sending a dynamic DNS update message is specified in\n   [6].  As mentioned\
    \ above, the dynamic DNS update SHOULD be performed\n   in a secure way; for this\
    \ reason, the usage of TKEY and TSEC or\n   DNSSEC is recommended (see Section\
    \ 9.5 for details).\n   If there is no explicit de-registration BU from the Mobile\
    \ Node, then\n   the HA MAY use the binding cache entry expiration as a trigger\
    \ to\n   remove the DNS entry.\n"
- title: 7.  Summary of Bootstrapping Protocol Flow
  contents:
  - "7.  Summary of Bootstrapping Protocol Flow\n   The message flow of the whole\
    \ bootstrapping procedure when the\n   dynamic DNS update is performed by the\
    \ Home Agent is depicted below.\n          +----+                  +----+    \
    \          +-----+\n          | MN |                  | HA |              | DNS\
    \ |\n          +----+                  +----+              +-----+\n         \
    \        IKEv2 exchange\n              (HoA configuration)\n             <======================>\n\
    \             BU (DNS update option)\n             ----------------------->\n\
    \                                           DNS update\n                     \
    \                <------------------->\n              BA (DNS update option)\n\
    \             <-----------------------\n   On the contrary, the figure below shows\
    \ the message flow of the whole\n   bootstrapping procedure when the dynamic DNS\
    \ update is performed by\n   the AAA server of the MSA.\n        +----+      \
    \          +----+         +---+         +---+\n        | MN |                |\
    \ HA |         |AAA|         |DNS|\n        +----+                +----+     \
    \    +---+         +---+\n              IKEv2 exchange\n            (HoA configuration)\n\
    \          <======================>\n          BU (DNS update option)\n      \
    \    ----------------------->\n                                   AAA request\n\
    \                                   (FQDN, HoA)\n                            \
    \     <-------------->\n                                                  DNS\
    \ update\n                                                 <----------->\n   \
    \                                AAA answer\n                                \
    \   (FQDN, HoA)\n                                 <-------------->\n         \
    \   BA (DNS update option)\n          <-----------------------\n   Notice that\
    \ even in this last case, the Home Agent is always required\n   to perform a DNS\
    \ update for the reverse entry, since this is always\n   performed in the DNS\
    \ server of the MSP.  This is not depicted in the\n   figure above.\n"
- title: 8.  Option and Attribute Format
  contents:
  - '8.  Option and Attribute Format

    '
- title: 8.1.  DNS Update Mobility Option
  contents:
  - "8.1.  DNS Update Mobility Option\n       0                   1              \
    \     2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n                                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                      |  Option Type  | Option Length |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \   Status      |R|  Reserved   |     MN identity (FQDN) ...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Option Type\n      DNS-UPDATE-TYPE (17)\n   Option Length\n      8-bit unsigned\
    \ integer indicating the length of the option\n      excluding the type and length\
    \ fields\n   Status\n      8-bit unsigned integer indicating the result of the\
    \ dynamic DNS\n      update procedure.  This field MUST be set to 0 and ignored\
    \ by the\n      receiver when the DNS Update mobility option is included in a\n\
    \      Binding Update message.  When the DNS Update mobility option is\n     \
    \ included in the Binding Acknowledgement message, values of the\n      Status\
    \ field less than 128 indicate that the dynamic DNS update\n      was performed\
    \ successfully by the Home Agent.  Values greater than\n      or equal to 128\
    \ indicate that the dynamic DNS update was not\n      completed by the HA.  The\
    \ following Status values are currently\n      defined:\n              0 DNS update\
    \ performed\n            128 Reason unspecified\n            129 Administratively\
    \ prohibited\n            130 DNS update failed\n   R flag\n      If set, the\
    \ Mobile Node is requesting the HA to remove the DNS\n      entry identified by\
    \ the FQDN specified in this option and the HoA\n      of the Mobile Node.  If\
    \ not set, the Mobile Node is requesting the\n      HA to create or update a DNS\
    \ entry with its HoA and the FQDN\n      specified in the option.\n   Reserved\n\
    \      MUST be set to 0.\n   MN identity\n      The identity of the Mobile Node\
    \ in FQDN format to be used by the\n      Home Agent to send a Dynamic DNS update.\
    \  It is a variable length\n      field.\n"
- title: 8.2.  MIP6_HOME_PREFIX Attribute
  contents:
  - "8.2.  MIP6_HOME_PREFIX Attribute\n   The MIP6_HOME_PREFIX attribute is carried\
    \ in IKEv2 Configuration\n   Payload messages.  This attribute is used to convey\
    \ the home prefix\n   from which the Mobile Node auto-configures its home address.\n\
    \        0                   1                   2                   3\n     \
    \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       |R|      Attribute Type         |           Length              |\n  \
    \     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \   |                         Prefix Lifetime                       |\n      \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n       |\
    \                                                               |\n       |  \
    \                       Home Prefix                           |\n       |    \
    \                                                           |\n       |      \
    \                                                         |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       | Prefix Length |\n       +-+-+-+-+-+-+-+-+\n   Reserved (1 bit)\n   \
    \   This bit MUST be set to zero and MUST be ignored on receipt.\n   Attribute\
    \ Type (15 bits)\n      A unique identifier for the MIP6_HOME_PREFIX attribute\
    \ (16).\n   Length (2 octets)\n      Length in octets of Value field (Home Prefix,\
    \ Prefix Lifetime and\n      Prefix Length).  This can be 0 or 21.\n   Prefix\
    \ Lifetime (4 octets)\n      The lifetime of the Home Prefix.\n   Home Prefix\
    \ (16 octets)\n      The prefix of the home link through which the Mobile Node\
    \ may\n      auto-configure its Home Address.\n   Prefix Length (1 octet)\n  \
    \    The length in bits of the home prefix specified in the field Home\n     \
    \ Prefix.\n   When the MIP6_HOME_PREFIX attribute is included by the Mobile Node\
    \ in\n   the CFG_REQUEST payload, the value of the Length field is 0.  When\n\
    \   the MIP6_HOME_PREFIX attribute is included in the CFG_REPLY payload\n   by\
    \ the Home Agent, the value of the Length field is 21 and the\n   attribute contains\
    \ also the home prefix information.\n"
- title: 9.  Security Considerations
  contents:
  - '9.  Security Considerations

    '
- title: 9.1.  HA Address Discovery
  contents:
  - "9.1.  HA Address Discovery\n   Use of DNS for address discovery carries certain\
    \ security risks.  DNS\n   transactions in the Internet are typically done without\
    \ any\n   authentication of the DNS server by the client or of the client by\n\
    \   the server.  There are two risks involved:\n   1.  A legitimate client obtains\
    \ a bogus Home Agent address from a\n       bogus DNS server.  This is sometimes\
    \ called a \"pharming\" attack.\n   2.  An attacking client obtains a legitimate\
    \ Home Agent address from\n       a legitimate server.\n   The risk in Case 1\
    \ is mitigated because the Mobile Node is required\n   to conduct an IKE transaction\
    \ with the Home Agent prior to performing\n   a Binding Update to establish Mobile\
    \ IPv6 service.  According to the\n   IKEv2 specification [5], the responder must\
    \ present the initiator\n   with a valid certificate containing the responder's\
    \ public key, and\n   the responder to initiator IKE_AUTH message must be protected\
    \ with an\n   authenticator calculated using the public key in the certificate.\n\
    \   Thus, an attacker would have to set up both a bogus DNS server and a\n   bogus\
    \ Home Agent, and provision the Home Agent with a certificate\n   that a victim\
    \ Mobile Node could verify.  If the Mobile Node can\n   detect that the certificate\
    \ is not trustworthy, the attack will be\n   foiled when the Mobile Node attempts\
    \ to set up the IKE SA.\n   The risk in Case 2 is limited for a single Mobile\
    \ Node to Home Agent\n   transaction if the attacker does not possess proper credentials\
    \ to\n   authenticate with the Home Agent.  The IKE SA establishment will fail\n\
    \   when the attacking Mobile Node attempts to authenticate itself with\n   the\
    \ Home Agent.  Regardless of whether the Home Agent utilizes EAP or\n   host-side\
    \ certificates to authenticate the Mobile Node, the\n   authentication will fail\
    \ unless the Mobile Node has valid\n   credentials.\n   Another risk exists in\
    \ Case 2 because the attacker may be attempting\n   to propagate a Denial of Service\
    \ (DoS) attack on the Home Agent.  In\n   that case, the attacker obtains the\
    \ Home Agent address from the DNS,\n   then propagates the address to a network\
    \ of attacking hosts that\n   bombard the Home Agent with traffic.  This attack\
    \ is not unique to\n   the bootstrapping solution, however, it is actually a risk\
    \ that any\n   Mobile IPv6 Home Agent installation faces.  In fact, the risk is\n\
    \   faced by any service in the Internet that distributes a unicast\n   globally\
    \ routable address to clients.  Since Mobile IPv6 requires\n   that the Mobile\
    \ Node communicate through a globally routable unicast\n   address of a Home Agent,\
    \ it is possible that the Home Agent address\n   could be propagated to an attacker\
    \ by various means (theft of the\n   Mobile Node, malware installed on the Mobile\
    \ Node, evil intent of the\n   Mobile Node owner him/herself, etc.) even if the\
    \ home address is\n   manually configured on the Mobile Node.  Consequently, every\
    \ Mobile\n   IPv6 Home Agent installation will likely be required to mount anti-\n\
    \   DoS measures.  Such measures include overprovisioning of links to and\n  \
    \ from Home Agents and of Home Agent processing capacity, vigilant\n   monitoring\
    \ of traffic on the Home Agent networks to detect when\n   traffic volume increases\
    \ abnormally indicating a possible DoS attack,\n   and hot spares that can quickly\
    \ be switched on in the event an attack\n   is mounted on an operating collection\
    \ of Home Agents.  DoS attacks of\n   moderate intensity should be foiled during\
    \ the IKEv2 transaction.\n   IKEv2 implementations are expected to generate their\
    \ cookies without\n   any saved state, and to time out cookie generation parameters\n\
    \   frequently, with the timeout value increasing if a DoS attack is\n   suspected.\
    \  This should prevent state depletion attacks, and should\n   assure continued\
    \ service to legitimate clients until the practical\n   limits on the network\
    \ bandwidth and processing capacity of the Home\n   Agent network are reached.\n\
    \   Explicit security measures between the DNS server and host, such as\n   DNSSEC\
    \ [19] or TSIG/TKEY [20] [21], can mitigate the risk of 1) and\n   2), but these\
    \ security measures are not widely deployed on end nodes.\n   These security measures\
    \ are not sufficient to protect the Home Agent\n   address against DoS attack,\
    \ however, because a node having a\n   legitimate security association with the\
    \ DNS server could\n   nevertheless intentionally or inadvertently cause the Home\
    \ Agent\n   address to become the target of DoS.\n   Finally, notice that the\
    \ assignment of a home agent from the serving\n   network access provider's (local\
    \ home agent) or a home agent from a\n   nearby network (nearby home agent) may\
    \ set up the potential to\n   compromise a mobile node's location privacy.  A\
    \ home address anchored\n   at such a home agent contains some information about\
    \ the topological\n   location of the mobile node.  Consequently, a mobile node\
    \ requiring\n   location privacy should not disclose this home address to nodes\
    \ that\n   are not authorized to learn the mobile node's location, e.g., by\n\
    \   updating DNS with the new home address.\n   Security considerations for discovering\
    \ HA using DHCP are covered in\n   [22].\n"
- title: 9.2.  Home Address Assignment through IKEv2
  contents:
  - "9.2.  Home Address Assignment through IKEv2\n   Mobile IPv6 bootstrapping assigns\
    \ the home address through the IKEv2\n   transaction.  The Mobile Node can either\
    \ choose to request an\n   address, similar to DHCP, or the Mobile Node can request\
    \ a prefix on\n   the home link, then auto-configure an address.\n   RFC 3775\
    \ [1] requires that a Home Agent check authorization of a home\n   address received\
    \ during a Binding Update.  Therefore, the home agent\n   MUST authorize each\
    \ home address allocation and use.  This\n   authorization is based on linking\
    \ the mobile node identity used in\n   the IKEv2 authentication process and the\
    \ home address.  Home agents\n   MUST implement at least the following two modes\
    \ of authorization:\n   o  Configured home address(es) for each mobile node. \
    \ In this mode,\n      the home agent or infrastructure nodes behind it know what\n\
    \      addresses a specific mobile node is authorized to use.  The mobile\n  \
    \    node is allowed to request these addresses, or if the mobile node\n     \
    \ requests any home address, these addresses are returned to it.\n   o  First-come-first-served\
    \ (FCFS).  In this mode, the home agent\n      maintains a pool of \"used\" addresses,\
    \ and allows mobile nodes to\n      request any address, as long as it is not\
    \ used by another mobile\n      node.\n   Addresses MUST be marked as used for\
    \ at least as long as the binding\n   exists, and are associated with the identity\
    \ of the mobile node that\n   made the allocation.\n   In addition, the home agent\
    \ MUST ensure that the requested address is\n   not the authorized address of\
    \ any other mobile node, i.e., if both\n   FCFS and configured modes use the same\
    \ address space.\n"
- title: 9.3.  SA Establishment Using EAP through IKEv2
  contents:
  - "9.3.  SA Establishment Using EAP through IKEv2\n   Security considerations for\
    \ authentication of the IKE transaction\n   using EAP are covered in [3] .\n"
- title: 9.4.  Backend Security between the HA and AAA Server
  contents:
  - "9.4.  Backend Security between the HA and AAA Server\n   Some deployments of\
    \ Mobile IPv6 bootstrapping may use an AAA server\n   to handle authorization\
    \ for mobility service.  This process has its\n   own security requirements, but\
    \ the backend protocol for a Home Agent\n   to an AAA server interface is not\
    \ covered in this document.  Please\n   see [16] for a discussion of this interface.\n"
- title: 9.5.  Dynamic DNS Update
  contents:
  - "9.5.  Dynamic DNS Update\n   If a Home Agent performs dynamic DNS update on behalf\
    \ of the Mobile\n   Node directly with the DNS server, the Home Agent MUST have\
    \ a\n   security association of some type with the DNS server.  The security\n\
    \   association MAY be established either using DNSSEC [19] or TSIG/TKEY\n   [20][21].\
    \  A security association is REQUIRED even if the DNS server\n   is in the same\
    \ administrative domain as the Home Agent.  The security\n   association SHOULD\
    \ be separate from the security associations used\n   for other purposes, such\
    \ as AAA.\n   In the case where the Mobility Service Provider is different from\
    \ the\n   Mobility Service Authorizer, the network administrators may want to\n\
    \   limit the number of cross-administrative domain security\n   associations.\
    \  If the Mobile Node's FQDN is in the Mobility Service\n   Authorizer's domain,\
    \ since a security association for AAA signaling\n   involved in mobility service\
    \ authorization is required in any case,\n   the Home Agent can send the Mobile\
    \ Node's FQDN to the AAA server\n   under the HA-AAA server security association,\
    \ and the AAA server can\n   perform the update.  In that case, a security association\
    \ is required\n   between the AAA server and DNS server for the dynamic DNS update.\n\
    \   See [16] for a deeper discussion of the Home Agent to AAA server\n   interface.\n\
    \   Regardless of whether the AAA server or Home Agent performs DNS\n   update,\
    \ the authorization of the Mobile Node to update a FQDN MUST be\n   checked prior\
    \ to the performance of the update.  It is an\n   implementation issue as to how\
    \ authorization is determined.  However,\n   in order to allow this authorization\
    \ step, the Mobile Node MUST use a\n   FQDN as the IDi in IKE_AUTH step of the\
    \ IKEv2 exchange.  The FQDN\n   MUST be the same as the FQDN that will be provided\
    \ by the Mobile Node\n   in the DNS Update Option.\n   In case EAP over IKEv2\
    \ is used to set-up the IPsec SA, the Home Agent\n   gets authorization information\
    \ about the Mobile Node's FQDN via the\n   AAA back end communication performed\
    \ during IKEv2 exchange.  The\n   outcome of this step will give the Home Agent\
    \ the necessary\n   information to authorize the DNS update request of the Mobile\
    \ Node.\n   See [16] for details about the communication between the AAA server\n\
    \   and the Home Agent needed to perform the authorization.\n   In case certificates\
    \ are used in IKEv2, the authorization information\n   about the FQDN for DNS\
    \ update MUST be present in the certificate\n   provided by the Mobile Node. \
    \ Since the IKEv2 specification does not\n   include a required certificate type,\
    \ it is not possible to specify\n   precisely how the Mobile Node's FQDN should\
    \ appear in the\n   certificate.  However, as an example, if the certificate type\
    \ is\n   \"X.509 Certificate - Signature\" (one of the recommended types), then\n\
    \   the FQDN may appear in the subjectAltName attribute extension [23].\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document defines a new Mobility Option and\
    \ a new IKEv2\n   Configuration Attribute Type.\n   The following values have\
    \ been assigned:\n   o  from the \"Mobility Option\" namespace ([1]): DNS-UPDATE-TYPE,\
    \ 17\n      (Section 8.1)\n   o  from the \"IKEv2 Configuration Payload Attribute\
    \ Types\" namespace\n      ([5]): MIP6_HOME_PREFIX attribute, 16 (Section 8.2)\n\
    \   o  from the \"IKEv2 Notify Payload Error Types\" namespace ([5]):\n      USE_ASSIGNED_HoA\
    \ error type, 42 (Section 5.3.2)\n   This document creates a new name space \"\
    Status Codes (DNS Update\n   Mobility Option)\" for the status field in the DNS\
    \ Update mobility\n   option.  The current values are described in Section 8.1\
    \ and are\n   listed below.\n        0 DNS update performed\n      128 Reason\
    \ unspecified\n      129 Administratively prohibited\n      130 DNS update failed\n\
    \   Future values of the Status field in the DNS Update mobility option\n   can\
    \ be allocated using Standards Action or IESG approval.\n"
- title: 11.  Contributors
  contents:
  - "11.  Contributors\n   This contribution is a joint effort of the bootstrapping\
    \ solution\n   design team of the MIP6 WG.  The contributors include Basavaraj\n\
    \   Patil, Alpesh Patel, Jari Arkko, James Kempf, Yoshihiro Ohba, Gopal\n   Dommety,\
    \ Alper Yegin, Junghoon Jee, Vijay Devarapalli, Kuntal\n   Chowdury, and Julien\
    \ Bournelle.\n   The design team members can be reached at:\n      Gerardo Giaretta,\
    \ gerardog@qualcomm.com\n      Basavaraj Patil, basavaraj.patil@nokia.com\n  \
    \    Alpesh Patel, alpesh@cisco.com\n      Jari Arkko, jari.arkko@kolumbus.fi\n\
    \      James Kempf, kempf@docomolabs-usa.com\n      Yoshihiro Ohba, yohba@tari.toshiba.com\n\
    \      Gopal Dommety, gdommety@cisco.com\n      Alper Yegin, alper.yegin@samsung.com\n\
    \      Vijay Devarapalli, vijay.devarapalli@azairenet.com\n      Kuntal Chowdury,\
    \ kchowdury@starentnetworks.com\n      Junghoon Jee, jhjee@etri.re.kr\n      Julien\
    \ Bournelle, julien.bournelle@gmail.com\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   The authors would like to thank Rafa Lopez, Francis\
    \ Dupont, Jari\n   Arkko, Kilian Weniger, Vidya Narayanan, Ryuji Wakikawa, and\
    \ Michael\n   Ye for their valuable comments.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [1]   Johnson, D., Perkins, C., and J. Arkko,\
    \ \"Mobility Support in\n         IPv6\", RFC 3775, June 2004.\n   [2]   Bradner,\
    \ S., \"Key words for use in RFCs to Indicate Requirement\n         Levels\",\
    \ BCP 14, RFC 2119, March 1997.\n   [3]   Devarapalli, V. and F. Dupont, \"Mobile\
    \ IPv6 Operation with\n         IKEv2 and the Revised IPsec Architecture\", RFC\
    \ 4877, April\n         2007.\n   [4]   Gulbrandsen, A., Vixie, P., and L. Esibov,\
    \ \"A DNS RR for\n         specifying the location of services (DNS SRV)\", RFC\
    \ 2782,\n         February 2000.\n   [5]   Kaufman, C., \"Internet Key Exchange\
    \ (IKEv2) Protocol\", RFC\n         4306, December 2005.\n   [6]   Vixie, P.,\
    \ Thomson, S., Rekhter, Y., and J. Bound, \"Dynamic\n         Updates in the Domain\
    \ Name System (DNS UPDATE)\", RFC 2136,\n         April 1997.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [7]   Patel, A. and G. Giaretta, \"Problem\
    \ Statement for bootstrapping\n         Mobile IPv6 (MIPv6)\", RFC 4640, September\
    \ 2006.\n   [8]   Manner, J. and M. Kojo, \"Mobility Related Terminology\", RFC\n\
    \         3753, June 2004.\n   [9]   Adams, C., Farrell, S., Kause, T., and T.\
    \ Mononen, \"Internet\n         X.509 Public Key Infrastructure Certificate Management\
    \ Protocol\n         (CMP)\", RFC 4210, September 2005.\n   [10]  Korver, B.,\
    \ \"The Internet IP Security PKI Profile of\n         IKEv1/ISAKMP, IKEv2, and\
    \ PKIX\", RFC 4945, August 2007.\n   [11]  Narten, T., Nordmark, E., Simpson,\
    \ W., and H. Soliman,\n         \"Neighbor Discovery for IP version 6 (IPv6)\"\
    , RFC 4861,\n         September 2007.\n   [12]  Aura, T., \"Cryptographically\
    \ Generated Addresses (CGA)\", RFC\n         3972, March 2005.\n   [13]   Narten,\
    \ T., Draves, R., and S. Krishnan, \"Privacy Extensions\n         for Stateless\
    \ Address Autoconfiguration in IPv6\", RFC 4941,\n         September 2007.\n \
    \  [14]  Droms, R., \"DNS Configuration options for Dynamic Host\n         Configuration\
    \ Protocol for IPv6 (DHCPv6)\", RFC 3646, December\n         2003.\n   [15]  Chowdhury,\
    \ K. and A. Yegin, \"MIP6-bootstrapping for the\n         Integrated Scenario\"\
    , Work in Progress, June 2007.\n   [16]  Giaretta, G., \"AAA Goals for Mobile\
    \ IPv6\", Work in Progress,\n         September 2006.\n   [17]  Chowdhury, K.,\
    \ \"RADIUS Mobile IPv6 Support\", Work in Progress,\n         March 2007.\n  \
    \ [18]  Bournelle, J., \"Diameter Mobile IPv6: HA <-> HAAA Support\",\n      \
    \   Work in Progress, May 2007.\n   [19]  Arends, R., Austein, R., Larson, M.,\
    \ Massey, D., and S. Rose,\n         \"DNS Security Introduction and Requirements\"\
    , RFC 4033, March\n         2005.\n   [20]  Vixie, P., Gudmundsson, O., Eastlake,\
    \ D., and B. Wellington,\n         \"Secret Key Transaction Authentication for\
    \ DNS (TSIG)\", RFC\n         2845, May 2000.\n   [21]  Eastlake, D., \"Secret\
    \ Key Establishment for DNS (TKEY RR)\", RFC\n         2930, September 2000.\n\
    \   [22]  Jang, H., \"DHCP Option for Home Information Discovery in\n        \
    \ MIPv6\", Work in Progress, June 2007.\n   [23]  Housley, R., Polk, W., Ford,\
    \ W., and D. Solo, \"Internet X.509\n         Public Key Infrastructure Certificate\
    \ and Certificate\n         Revocation List (CRL) Profile\", RFC 3280, April 2002.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Gerardo Giaretta\n   Qualcomm\n   EMail: gerardog@qualcomm.com\n\
    \   James Kempf\n   DoCoMo Labs USA\n   181 Metro Drive\n   San Jose, CA  95110\n\
    \   USA\n   EMail: kempf@docomolabs-usa.com\n   Vijay Devarapalli\n   Azaire Networks\n\
    \   3121 Jay Street\n   Santa Clara, CA  95054\n   USA\n   EMail: vijay.devarapalli@azairenet.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
