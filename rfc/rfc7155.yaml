- title: __initial_text__
  contents:
  - '               Diameter Network Access Server Application

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes the Diameter protocol application used for\n\
    \   Authentication, Authorization, and Accounting services in the Network\n  \
    \ Access Server (NAS) environment; it obsoletes RFC 4005.  When\n   combined with\
    \ the Diameter Base protocol, Transport Profile, and\n   Extensible Authentication\
    \ Protocol specifications, this application\n   specification satisfies typical\
    \ network access services requirements.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc7155.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2014 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. Changes from RFC 4005 ......................................5\n  \
    \    1.2. Terminology ................................................6\n    \
    \  1.3. Requirements Language ......................................7\n      1.4.\
    \ Advertising Application Support ............................8\n      1.5. Application\
    \ Identification .................................8\n      1.6. Accounting Model\
    \ ...........................................8\n   2. NAS Calls, Ports, and Sessions\
    \ ..................................8\n      2.1. Diameter Session Establishment\
    \ .............................9\n      2.2. Diameter Session Reauthentication\
    \ or Reauthorization .......9\n      2.3. Diameter Session Termination ..............................10\n\
    \   3. Diameter NAS Application Messages ..............................11\n  \
    \    3.1. AA-Request (AAR) Command ..................................11\n    \
    \  3.2. AA-Answer (AAA) Command ...................................13\n      3.3.\
    \ Re-Auth-Request (RAR) Command .............................15\n      3.4. Re-Auth-Answer\
    \ (RAA) Command ..............................16\n      3.5. Session-Termination-Request\
    \ (STR) Command .................17\n      3.6. Session-Termination-Answer (STA)\
    \ Command ..................17\n      3.7. Abort-Session-Request (ASR) Command\
    \ .......................18\n      3.8. Abort-Session-Answer (ASA) Command ........................19\n\
    \      3.9. Accounting-Request (ACR) Command ..........................20\n  \
    \    3.10. Accounting-Answer (ACA) Command ..........................22\n   4.\
    \ Diameter NAS Application AVPs ..................................23\n      4.1.\
    \ Derived AVP Data Formats ..................................23\n           4.1.1.\
    \ QoSFilterRule ......................................23\n      4.2. NAS Session\
    \ AVPs ..........................................24\n           4.2.1. Call and\
    \ Session Information .......................24\n           4.2.2. NAS-Port AVP\
    \ .......................................25\n           4.2.3. NAS-Port-Id AVP\
    \ ....................................25\n           4.2.4. NAS-Port-Type AVP\
    \ ..................................26\n           4.2.5. Called-Station-Id AVP\
    \ ..............................26\n           4.2.6. Calling-Station-Id AVP .............................26\n\
    \           4.2.7. Connect-Info AVP ...................................27\n  \
    \         4.2.8. Originating-Line-Info AVP ..........................27\n    \
    \       4.2.9. Reply-Message AVP ..................................28\n      4.3.\
    \ NAS Authentication AVPs ...................................28\n           4.3.1.\
    \ User-Password AVP ..................................29\n           4.3.2. Password-Retry\
    \ AVP .................................29\n           4.3.3. Prompt AVP .........................................29\n\
    \           4.3.4. CHAP-Auth AVP ......................................29\n  \
    \         4.3.5. CHAP-Algorithm AVP .................................30\n    \
    \       4.3.6. CHAP-Ident AVP .....................................30\n      \
    \     4.3.7. CHAP-Response AVP ..................................30\n        \
    \   4.3.8. CHAP-Challenge AVP .................................30\n          \
    \ 4.3.9. ARAP-Password AVP ..................................30\n           4.3.10.\
    \ ARAP-Challenge-Response AVP .......................31\n           4.3.11. ARAP-Security\
    \ AVP .................................31\n           4.3.12. ARAP-Security-Data\
    \ AVP ............................31\n      4.4. NAS Authorization AVPs ....................................31\n\
    \           4.4.1. Service-Type AVP ...................................33\n  \
    \         4.4.2. Callback-Number AVP ................................34\n    \
    \       4.4.3. Callback-Id AVP ....................................34\n      \
    \     4.4.4. Idle-Timeout AVP ...................................34\n        \
    \   4.4.5. Port-Limit AVP .....................................34\n          \
    \ 4.4.6. NAS-Filter-Rule AVP ................................35\n           4.4.7.\
    \ Filter-Id AVP ......................................35\n           4.4.8. Configuration-Token\
    \ AVP ............................35\n           4.4.9. QoS-Filter-Rule AVP ................................35\n\
    \           4.4.10. Framed Access Authorization AVPs ..................36\n  \
    \                4.4.10.1. Framed-Protocol AVP ......................36\n    \
    \              4.4.10.2. Framed-Routing AVP .......................36\n      \
    \            4.4.10.3. Framed-MTU AVP ...........................37\n        \
    \          4.4.10.4. Framed-Compression AVP ...................37\n          \
    \        4.4.10.5. IP Access Authorization AVPs .............37\n            \
    \               4.4.10.5.1. Framed-IP-Address AVP .........37\n              \
    \             4.4.10.5.2. Framed-IP-Netmask AVP .........37\n                \
    \           4.4.10.5.3. Framed-Route AVP ..............38\n                  \
    \         4.4.10.5.4. Framed-Pool AVP ...............38\n                    \
    \       4.4.10.5.5. Framed-Interface-Id AVP .......38\n                      \
    \     4.4.10.5.6. Framed-IPv6-Prefix AVP ........39\n                        \
    \   4.4.10.5.7. Framed-IPv6-Route AVP .........39\n                          \
    \ 4.4.10.5.8. Framed-IPv6-Pool AVP ..........39\n                  4.4.10.6. IPX\
    \ Access AVPs ..........................39\n                           4.4.10.6.1.\
    \ Framed-IPX-Network AVP ........40\n                  4.4.10.7. AppleTalk Network\
    \ Access AVPs ............40\n                           4.4.10.7.1. Framed-Appletalk-Link\
    \ AVP .....40\n                           4.4.10.7.2. Framed-Appletalk-Network\
    \ AVP ..40\n                           4.4.10.7.3. Framed-Appletalk-Zone AVP .....41\n\
    \                  4.4.10.8. AppleTalk Remote Access AVPs .............41\n  \
    \                         4.4.10.8.1. ARAP-Features AVP .............41\n    \
    \                       4.4.10.8.2. ARAP-Zone-Access AVP ..........41\n      \
    \     4.4.11. Non-Framed Access Authorization AVPs ..............41\n        \
    \          4.4.11.1. Login-IP-Host AVP ........................41\n          \
    \        4.4.11.2. Login-IPv6-Host AVP ......................42\n            \
    \      4.4.11.3. Login-Service AVP ........................42\n              \
    \    4.4.11.4. TCP Services .............................42\n                \
    \           4.4.11.4.1. Login-TCP-Port AVP ............42\n                  4.4.11.5.\
    \ LAT Services .............................43\n                           4.4.11.5.1.\
    \ Login-LAT-Service AVP .........43\n                           4.4.11.5.2. Login-LAT-Node\
    \ AVP ............43\n                           4.4.11.5.3. Login-LAT-Group AVP\
    \ ...........44\n                           4.4.11.5.4. Login-LAT-Port AVP ............44\n\
    \      4.5. NAS Tunneling AVPs ........................................45\n  \
    \         4.5.1. Tunneling AVP ......................................45\n    \
    \       4.5.2. Tunnel-Type AVP ....................................46\n      \
    \     4.5.3. Tunnel-Medium-Type AVP .............................46\n        \
    \   4.5.4. Tunnel-Client-Endpoint AVP .........................46\n          \
    \ 4.5.5. Tunnel-Server-Endpoint AVP .........................47\n           4.5.6.\
    \ Tunnel-Password AVP ................................48\n           4.5.7. Tunnel-Private-Group-Id\
    \ AVP ........................48\n           4.5.8. Tunnel-Assignment-Id AVP ...........................48\n\
    \           4.5.9. Tunnel-Preference AVP ..............................50\n  \
    \         4.5.10. Tunnel-Client-Auth-Id AVP .........................50\n    \
    \       4.5.11. Tunnel-Server-Auth-Id AVP .........................50\n      4.6.\
    \ NAS Accounting AVPs .......................................51\n           4.6.1.\
    \ Accounting-Input-Octets AVP ........................52\n           4.6.2. Accounting-Output-Octets\
    \ AVP .......................52\n           4.6.3. Accounting-Input-Packets AVP\
    \ .......................52\n           4.6.4. Accounting-Output-Packets AVP ......................53\n\
    \           4.6.5. Acct-Session-Time AVP ..............................53\n  \
    \         4.6.6. Acct-Authentic AVP .................................53\n    \
    \       4.6.7. Accounting-Auth-Method AVP .........................53\n      \
    \     4.6.8. Acct-Delay-Time AVP ................................53\n        \
    \   4.6.9. Acct-Link-Count AVP ................................54\n          \
    \ 4.6.10. Acct-Tunnel-Connection AVP ........................55\n           4.6.11.\
    \ Acct-Tunnel-Packets-Lost AVP ......................55\n   5. AVP Occurrence\
    \ Tables ..........................................55\n      5.1. AA-Request /\
    \ AA-Answer AVP Table ..........................56\n      5.2. Accounting AVP\
    \ Tables .....................................58\n           5.2.1. Framed Access\
    \ Accounting AVP Table .................59\n           5.2.2. Non-Framed Access\
    \ Accounting AVP Table .............61\n   6. Unicode Considerations .........................................62\n\
    \   7. IANA Considerations ............................................63\n  \
    \ 8. Security Considerations ........................................63\n    \
    \  8.1. Authentication Considerations .............................63\n      8.2.\
    \ AVP Considerations ........................................64\n   9. References\
    \ .....................................................65\n      9.1. Normative\
    \ References ......................................65\n      9.2. Informative\
    \ References ....................................65\n   Appendix A. Acknowledgements\
    \ ......................................69\n     A.1. This Document ..............................................69\n\
    \     A.2. RFC 4005 ...................................................69\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document describes the Diameter protocol application\
    \ used for\n   Authentication, Authorization, and Accounting in the Network Access\n\
    \   Server (NAS) environment.  When combined with the Diameter Base\n   protocol\
    \ [RFC6733], Transport Profile [RFC3539], and Extensible\n   Authentication Protocol\
    \ (EAP) [RFC4072] specifications, this\n   specification satisfies the NAS-related\
    \ requirements defined in\n   [RFC2989] and [RFC3169].\n   First, this document\
    \ describes the operation of a Diameter NAS\n   application.  Then, it defines\
    \ the Diameter message command codes.\n   The following sections list the AVPs\
    \ used in these messages, grouped\n   by common usage.  These are session identification,\
    \ authentication,\n   authorization, tunneling, and accounting.  The authorization\
    \ AVPs are\n   further broken down by service type.\n"
- title: 1.1.  Changes from RFC 4005
  contents:
  - "1.1.  Changes from RFC 4005\n   This document obsoletes [RFC4005] and is not\
    \ backward compatible with\n   that document.  An overview of some of the major\
    \ changes is given\n   below.\n   o  All of the material regarding RADIUS/Diameter\
    \ protocol\n      interactions has been removed; however, where AVPs are derived\n\
    \      from RADIUS Attributes, the range and format of those Attribute\n     \
    \ values have been retained for ease of transition.\n   o  The Command Code Format\
    \ (CCF) [RFC6733] for the Accounting-Request\n      and Accounting-Answer messages\
    \ has been changed to explicitly\n      require the inclusion of the Acct-Application-Id\
    \ AVP and exclude\n      the Vendor-Specific-Application-Id AVP.  Normally, this\
    \ type of\n      change would require the allocation of a new command code (see\n\
    \      Section 1.3.3 of [RFC6733]) and consequently, a new application-\n    \
    \  id.  However, the presence of an instance of the Acct-Application-\n      Id\
    \ AVP was required in [RFC4005], as well:\n         The Accounting-Request (ACR)\
    \ message [BASE] is sent by the NAS\n         to report its session information\
    \ to a target server\n         downstream.\n         Either the Acct-Application-Id\
    \ or the Vendor-Specific-\n         Application-Id AVP MUST be present.  If the\
    \ Vendor-Specific-\n         Application-Id grouped AVP is present, it must have\
    \ an Acct-\n         Application-Id inside.\n      Thus, though the syntax of\
    \ the commands has changed, the semantics\n      have not (with the caveat that\
    \ the Acct-Application-Id AVP can no\n      longer be contained in the Vendor-Specific-Application-Id\
    \ AVP).\n   o  The lists of RADIUS attribute values have been deleted in favor\
    \ of\n      references to the appropriate IANA registries.\n   o  The accounting\
    \ model to be used is now specified (see\n      Section 1.6).\n   There are many\
    \ other miscellaneous fixes that have been introduced in\n   this document that\
    \ may not be considered significant, but they are\n   useful nonetheless.  Examples\
    \ are fixes to example IP addresses,\n   addition of clarifying references, etc.\
    \  Errata reports filed against\n   [RFC4005] at the time of writing have been\
    \ reviewed and incorporated\n   as necessary.  A comprehensive list of changes\
    \ is not shown here for\n   practical reasons.\n"
- title: 1.2.  Terminology
  contents:
  - "1.2.  Terminology\n   Section 1.2 of the Diameter Base protocol specification\
    \ [RFC6733]\n   defines most of the terminology used in this document.  Additionally,\n\
    \   the following terms and acronyms are used in this application:\n   NAS (Network\
    \ Access Server)\n      A device that provides an access service for a user to\
    \ a network.\n      The service may be a network connection or a value-added service\n\
    \      such as terminal emulation [RFC2881].\n   PPP (Point-to-Point Protocol)\n\
    \      A multiprotocol serial datalink.  PPP is the primary IP datalink\n    \
    \  used for dial-in NAS connection service [RFC1661].\n   CHAP (Challenge Handshake\
    \ Authentication Protocol)\n      An authentication process used in PPP [RFC1994].\n\
    \   PAP (Password Authentication Protocol)\n      A deprecated PPP authentication\
    \ process, but often used for\n      backward compatibility [RFC1334].\n   SLIP\
    \ (Serial Line Internet Protocol)\n      A serial datalink that only supports\
    \ IP.  A design prior to PPP.\n   ARAP (AppleTalk Remote Access Protocol)\n  \
    \    A serial datalink for accessing AppleTalk networks [ARAP].\n   IPX (Internetwork\
    \ Packet Exchange)\n      The network protocol used by NetWare networks [IPX].\n\
    \   L2TP (Layer Two Tunneling Protocol)\n      L2TP [RFC3931] provides a dynamic\
    \ mechanism for tunneling Layer 2\n      \"circuits\" across a packet-oriented\
    \ data network.\n   LAC (L2TP Access Concentrator)\n      An L2TP Control Connection\
    \ Endpoint being used to cross-connect an\n      L2TP session directly to a datalink\
    \ [RFC3931].\n   LAT (Local Area Transport)\n      A Digital Equipment Corp. \
    \ LAN protocol for terminal services\n      [LAT].\n   LCP (Link Control Protocol)\n\
    \      One of the three major components of PPP [RFC1661].  LCP is used\n    \
    \  to automatically agree upon encapsulation format options, handle\n      varying\
    \ limits on sizes of packets, detect a looped-back link and\n      other common\
    \ misconfiguration errors, and terminate the link.\n      Other optional facilities\
    \ provided are authentication of the\n      identity of its peer on the link,\
    \ and determination when a link is\n      functioning properly and when it is\
    \ failing.\n   PPTP (Point-to-Point Tunneling Protocol)\n      A protocol that\
    \ allows PPP to be tunneled through an IP network\n      [RFC2637].\n   VPN (Virtual\
    \ Private Network)\n      In this document, this term is used to describe access\
    \ services\n      that use tunneling methods.\n"
- title: 1.3.  Requirements Language
  contents:
  - "1.3.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    NOT RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted\
    \ as described in\n   [RFC2119].\n   The use of \"MUST\" and \"MUST NOT\" in the\
    \ AVP Flag Rules columns of AVP\n   Tables in this document refers to AVP flags\
    \ ([RFC6733], Section 4.1)\n   that:\n   o  MUST be set to 1 in the AVP Header\
    \ (\"MUST\" column) and\n   o  MUST NOT be set to 1 (\"MUST NOT\" column)\n"
- title: 1.4.  Advertising Application Support
  contents:
  - "1.4.  Advertising Application Support\n   Diameter nodes conforming to this specification\
    \ MUST advertise\n   support by including the value of one (1) in the Auth-Application-Id\n\
    \   of the Capabilities-Exchange-Request (CER) message [RFC6733].\n"
- title: 1.5.  Application Identification
  contents:
  - "1.5.  Application Identification\n   When used in this application, the Auth-Application-Id\
    \ AVP MUST be\n   set to the value one (1) in the following messages\n   o  AA-Request\
    \ (Section 3.1)\n   o  Re-Auth-Request(Section 3.3)\n   o  Session-Termination-Request\
    \ (Section 3.5)\n   o  Abort-Session-Request (Section 3.7)\n"
- title: 1.6.  Accounting Model
  contents:
  - "1.6.  Accounting Model\n   It is RECOMMENDED that the coupled accounting model\
    \ (RFC 6733,\n   Section 9.3) be used with this application; therefore, the value\
    \ of\n   the Acct-Application-Id AVP in the Accounting-Request (Section 3.9)\n\
    \   and Accounting-Answer (Section 3.10) messages SHOULD be set to one\n   (1).\n"
- title: 2.  NAS Calls, Ports, and Sessions
  contents:
  - "2.  NAS Calls, Ports, and Sessions\n   The arrival of a new call or service connection\
    \ at a port of a\n   Network Access Server (NAS) starts a Diameter NAS Application\
    \ message\n   exchange.  Information about the call, the identity of the user,\
    \ and\n   the user's authentication information are packaged into a Diameter\n\
    \   AA-Request (AAR) message and sent to a server.\n   The server processes the\
    \ information and responds with a Diameter AA-\n   Answer (AAA) message that contains\
    \ authorization information for the\n   NAS or a failure code (Result-Code AVP).\
    \  A value of\n   DIAMETER_MULTI_ROUND_AUTH indicates an additional authentication\n\
    \   exchange, and several AAR and AAA messages may be exchanged until the\n  \
    \ transaction completes.\n"
- title: 2.1.  Diameter Session Establishment
  contents:
  - "2.1.  Diameter Session Establishment\n   When the authentication or authorization\
    \ exchange completes\n   successfully, the NAS application SHOULD start a session\
    \ context.  If\n   the Result-Code of DIAMETER_MULTI_ROUND_AUTH is returned, the\n\
    \   exchange continues until a success or error is returned.\n   If accounting\
    \ is active, the application MUST also send an Accounting\n   message [RFC6733].\
    \  An Accounting-Record-Type of START_RECORD is sent\n   for a new session.  If\
    \ a session fails to start, the EVENT_RECORD\n   message is sent with the reason\
    \ for the failure described.\n   Note that the return of an unsupportable Accounting-Realtime-Required\n\
    \   value [RFC6733] would result in a failure to establish the session.\n"
- title: 2.2.  Diameter Session Reauthentication or Reauthorization
  contents:
  - "2.2.  Diameter Session Reauthentication or Reauthorization\n   The Diameter Base\
    \ protocol allows users to be periodically\n   reauthenticated and/or reauthorized.\
    \  In such instances, the Session-\n   Id AVP in the AAR message MUST be the same\
    \ as the one present in the\n   original authentication/authorization message.\n\
    \   A Diameter server informs the NAS of the maximum time allowed before\n   reauthentication\
    \ or reauthorization via the Authorization-Lifetime\n   AVP [RFC6733].  A NAS\
    \ MAY reauthenticate and/or reauthorize before\n   the end, but a NAS MUST reauthenticate\
    \ and/or reauthorize at the end\n   of the period provided by the Authorization-Lifetime\
    \ AVP.  The\n   failure of a reauthentication exchange will terminate the service.\n\
    \   Furthermore, it is possible for Diameter servers to issue an\n   unsolicited\
    \ reauthentication and/or reauthorization request (e.g.,\n   Re-Auth-Request (RAR)\
    \ message [RFC6733]) to the NAS.  Upon receipt of\n   such a message, the NAS\
    \ MUST respond to the request with a Re-Auth-\n   Answer (RAA) message [RFC6733].\n\
    \   If the RAR properly identifies an active session, the NAS will\n   initiate\
    \ a new local reauthentication or authorization sequence as\n   indicated by the\
    \ Re-Auth-Request-Type value.  This will cause the NAS\n   to send a new AAR message\
    \ using the existing Session-Id.  The server\n   will respond with an AAA message\
    \ to specify the new service\n   parameters.\n   If accounting is active, every\
    \ change of authentication or\n   authorization SHOULD generate an accounting\
    \ message.  If the NAS\n   service is a continuation of the prior user context,\
    \ then an\n   Accounting-Record-Type of INTERIM_RECORD indicating the new session\n\
    \   attributes and cumulative status would be appropriate.  If a new user\n  \
    \ or a significant change in authorization is detected by the NAS, then\n   the\
    \ service may send two messages of the types STOP_RECORD and\n   START_RECORD.\
    \  Accounting may change the subsession identifiers\n   (Acct-Session-Id, or Acct-Sub-Session-Id)\
    \ to indicate such\n   subsessions.  A service may also use a different Session-Id\
    \ value for\n   accounting (see Section 9.6 of [RFC6733]).\n   However, the Diameter\
    \ Session-Id AVP value used for the initial\n   authorization exchange MUST be\
    \ used to generate an STR message when\n   the session context is terminated.\n"
- title: 2.3.  Diameter Session Termination
  contents:
  - "2.3.  Diameter Session Termination\n   When a NAS receives an indication that\
    \ a user's session is being\n   disconnected by the client (e.g., an LCP Terminate-Request\
    \ message\n   [RFC1661] is received) or an administrative command, the NAS MUST\n\
    \   issue a Session-Termination-Request (STR) [RFC6733] to its Diameter\n   server.\
    \  This will ensure that any resources maintained on the\n   servers are freed\
    \ appropriately.\n   Furthermore, a NAS that receives an Abort-Session-Request\
    \ (ASR)\n   [RFC6733] MUST issue an Abort-Session-Answer (ASA) if the session\n\
    \   identified is active and disconnect the PPP (or tunneling) session.\n   If\
    \ accounting is active, an Accounting STOP_RECORD message [RFC6733]\n   MUST be\
    \ sent upon termination of the session context.\n   More information on Diameter\
    \ Session Termination can be found in\n   Sections 8.4 and 8.5 of [RFC6733].\n"
- title: 3.  Diameter NAS Application Messages
  contents:
  - "3.  Diameter NAS Application Messages\n   This section defines the Diameter message\
    \ Command Code [RFC6733]\n   values that MUST be supported by all Diameter implementations\n\
    \   conforming to this specification.  The Command Codes are as follows:\n   +-----------------------------------+---------+------+--------------+\n\
    \   | Command Name                      | Abbrev. | Code | Reference    |\n  \
    \ +-----------------------------------+---------+------+--------------+\n   |\
    \ AA-Request                        |   AAR   | 265  | Section 3.1  |\n   | AA-Answer\
    \                         |   AAA   | 265  | Section 3.2  |\n   | Re-Auth-Request\
    \                   |   RAR   | 258  | Section 3.3  |\n   | Re-Auth-Answer   \
    \                 |   RAA   | 258  | Section 3.4  |\n   | Session-Termination-Request\
    \       |   STR   | 275  | Section 3.5  |\n   | Session-Termination-Answer   \
    \     |   STA   | 275  | Section 3.6  |\n   | Abort-Session-Request          \
    \   |   ASR   | 274  | Section 3.7  |\n   | Abort-Session-Answer             \
    \ |   ASA   | 274  | Section 3.8  |\n   | Accounting-Request                |\
    \   ACR   | 271  | Section 3.9  |\n   | Accounting-Answer                 |  \
    \ ACA   | 271  | Section 3.10 |\n   +-----------------------------------+---------+------+--------------+\n\
    \   Note that the message formats in the following subsections use the\n   standard\
    \ Diameter Command Code Format ([RFC6733], Section 3.2).\n"
- title: 3.1.  AA-Request (AAR) Command
  contents:
  - "3.1.  AA-Request (AAR) Command\n   The AA-Request (AAR), which is indicated by\
    \ setting the Command Code\n   field to 265 and the 'R' bit in the Command Flags\
    \ field, is used to\n   request authentication and/or authorization for a given\
    \ NAS user.\n   The type of request is identified through the Auth-Request-Type\
    \ AVP\n   [RFC6733].  The recommended value for most situations is\n   AUTHORIZE_AUTHENTICATE.\n\
    \   If Authentication is requested, the User-Name attribute SHOULD be\n   present,\
    \ as well as any additional authentication AVPs that would\n   carry the password\
    \ information.  A request for authorization SHOULD\n   only include the information\
    \ from which the authorization will be\n   performed, such as the User-Name, Called-Station-Id,\
    \ or Calling-\n   Station-Id AVPs.  All requests SHOULD contain AVPs uniquely\n\
    \   identifying the source of the call, such as Origin-Host and NAS-Port.\n  \
    \ Certain networks MAY use different AVPs for authorization purposes.\n   A request\
    \ for authorization will include some AVPs defined in\n   Section 4.4.\n   It\
    \ is possible for a single session to be authorized first and then\n   for an\
    \ authentication request to follow.\n   This AA-Request message MAY be the result\
    \ of a multi-round\n   authentication exchange, which occurs when the AA-Answer\
    \ message is\n   received with the Result-Code AVP set to DIAMETER_MULTI_ROUND_AUTH.\n\
    \   A subsequent AAR message SHOULD be sent, with the User-Password AVP\n   that\
    \ includes the user's response to the prompt and MUST include any\n   State AVPs\
    \ that were present in the AAA message.\n      Message Format\n         <AA-Request>\
    \ ::= < Diameter Header: 265, REQ, PXY >\n                          < Session-Id\
    \ >\n                          { Auth-Application-Id }\n                     \
    \     { Origin-Host }\n                          { Origin-Realm }\n          \
    \                { Destination-Realm }\n                          { Auth-Request-Type\
    \ }\n                          [ Destination-Host ]\n                        \
    \  [ NAS-Identifier ]\n                          [ NAS-IP-Address ]\n        \
    \                  [ NAS-IPv6-Address ]\n                          [ NAS-Port\
    \ ]\n                          [ NAS-Port-Id ]\n                          [ NAS-Port-Type\
    \ ]\n                          [ Origin-AAA-Protocol ]\n                     \
    \     [ Origin-State-Id ]\n                          [ Port-Limit ]\n        \
    \                  [ User-Name ]\n                          [ User-Password ]\n\
    \                          [ Service-Type ]\n                          [ State\
    \ ]\n                          [ Authorization-Lifetime ]\n                  \
    \        [ Auth-Grace-Period ]\n                          [ Auth-Session-State\
    \ ]\n                          [ Callback-Number ]\n                         \
    \ [ Called-Station-Id ]\n                          [ Calling-Station-Id ]\n  \
    \                        [ Originating-Line-Info ]\n                         \
    \ [ Connect-Info ]\n                          [ CHAP-Auth ]\n                \
    \          [ CHAP-Challenge ]\n                        * [ Framed-Compression\
    \ ]\n                          [ Framed-Interface-Id ]\n                     \
    \     [ Framed-IP-Address ]\n                        * [ Framed-IPv6-Prefix ]\n\
    \                          [ Framed-IP-Netmask ]\n                          [\
    \ Framed-MTU ]\n                          [ Framed-Protocol ]\n              \
    \            [ ARAP-Password ]\n                          [ ARAP-Security ]\n\
    \                        * [ ARAP-Security-Data ]\n                        * [\
    \ Login-IP-Host ]\n                        * [ Login-IPv6-Host ]\n           \
    \               [ Login-LAT-Group ]\n                          [ Login-LAT-Node\
    \ ]\n                          [ Login-LAT-Port ]\n                          [\
    \ Login-LAT-Service ]\n                        * [ Tunneling ]\n             \
    \           * [ Proxy-Info ]\n                        * [ Route-Record ]\n   \
    \                     * [ AVP ]\n"
- title: 3.2.  AA-Answer (AAA) Command
  contents:
  - "3.2.  AA-Answer (AAA) Command\n   The AA-Answer (AAA) message is indicated by\
    \ setting the Command Code\n   field to 265 and clearing the 'R' bit in the Command\
    \ Flags field.  It\n   is sent in response to the AA-Request (AAR) message.  If\n\
    \   authorization was requested, a successful response will include the\n   authorization\
    \ AVPs appropriate for the service being provided, as\n   defined in Section 4.4.\n\
    \   For authentication exchanges requiring more than a single round trip,\n  \
    \ the server MUST set the Result-Code AVP to DIAMETER_MULTI_ROUND_AUTH.\n   An\
    \ AAA message with this result code MAY include one Reply-Message or\n   more\
    \ and MAY include zero or one State AVPs.\n   If the Reply-Message AVP was present,\
    \ the network access server\n   SHOULD send the text to the user's client to display\
    \ to the user,\n   instructing the client to prompt the user for a response. \
    \ For\n   example, this can be achieved in PPP via PAP.  If it is impossible to\n\
    \   deliver the text prompt to the user, the Diameter NAS Application\n   client\
    \ MUST treat the AA-Answer (AAA) with the Reply-Message AVP as\n   an error and\
    \ deny access.\n      Message Format\n         <AA-Answer> ::= < Diameter Header:\
    \ 265, PXY >\n                         < Session-Id >\n                      \
    \   { Auth-Application-Id }\n                         { Auth-Request-Type }\n\
    \                         { Result-Code }\n                         { Origin-Host\
    \ }\n                         { Origin-Realm }\n                         [ User-Name\
    \ ]\n                         [ Service-Type ]\n                       * [ Class\
    \ ]\n                       * [ Configuration-Token ]\n                      \
    \   [ Acct-Interim-Interval ]\n                         [ Error-Message ]\n  \
    \                       [ Error-Reporting-Host ]\n                       * [ Failed-AVP\
    \ ]\n                         [ Idle-Timeout ]\n                         [ Authorization-Lifetime\
    \ ]\n                         [ Auth-Grace-Period ]\n                        \
    \ [ Auth-Session-State ]\n                         [ Re-Auth-Request-Type ]\n\
    \                         [ Multi-Round-Time-Out ]\n                         [\
    \ Session-Timeout ]\n                         [ State ]\n                    \
    \   * [ Reply-Message ]\n                         [ Origin-AAA-Protocol ]\n  \
    \                       [ Origin-State-Id ]\n                       * [ Filter-Id\
    \ ]\n                         [ Password-Retry ]\n                         [ Port-Limit\
    \ ]\n                         [ Prompt ]\n                         [ ARAP-Challenge-Response\
    \ ]\n                         [ ARAP-Features ]\n                         [ ARAP-Security\
    \ ]\n                       * [ ARAP-Security-Data ]\n                       \
    \  [ ARAP-Zone-Access ]\n                         [ Callback-Id ]\n          \
    \               [ Callback-Number ]\n                         [ Framed-Appletalk-Link\
    \ ]\n                       * [ Framed-Appletalk-Network ]\n                 \
    \        [ Framed-Appletalk-Zone ]\n                       * [ Framed-Compression\
    \ ]\n                         [ Framed-Interface-Id ]\n                      \
    \   [ Framed-IP-Address ]\n                       * [ Framed-IPv6-Prefix ]\n \
    \                        [ Framed-IPv6-Pool ]\n                       * [ Framed-IPv6-Route\
    \ ]\n                         [ Framed-IP-Netmask ]\n                       *\
    \ [ Framed-Route ]\n                         [ Framed-Pool ]\n               \
    \          [ Framed-IPX-Network ]\n                         [ Framed-MTU ]\n \
    \                        [ Framed-Protocol ]\n                         [ Framed-Routing\
    \ ]\n                       * [ Login-IP-Host ]\n                       * [ Login-IPv6-Host\
    \ ]\n                         [ Login-LAT-Group ]\n                         [\
    \ Login-LAT-Node ]\n                         [ Login-LAT-Port ]\n            \
    \             [ Login-LAT-Service ]\n                         [ Login-Service\
    \ ]\n                         [ Login-TCP-Port ]\n                       * [ NAS-Filter-Rule\
    \ ]\n                       * [ QoS-Filter-Rule ]\n                       * [\
    \ Tunneling ]\n                       * [ Redirect-Host ]\n                  \
    \       [ Redirect-Host-Usage ]\n                         [ Redirect-Max-Cache-Time\
    \ ]\n                       * [ Proxy-Info ]\n                       * [ AVP ]\n"
- title: 3.3.  Re-Auth-Request (RAR) Command
  contents:
  - "3.3.  Re-Auth-Request (RAR) Command\n   A Diameter server can initiate reauthentication\
    \ and/or\n   reauthorization for a particular session by issuing a Re-Auth-Request\n\
    \   (RAR) message [RFC6733].\n   For example, for prepaid services, the Diameter\
    \ server that\n   originally authorized a session may need some confirmation that\
    \ the\n   user is still using the services.\n   If a NAS receives an RAR message\
    \ with Session-Id equal to a currently\n   active session and a Re-Auth-Type that\
    \ includes authentication, it\n   MUST initiate a reauthentication toward the\
    \ user, if the service\n   supports this particular feature.\n      Message Format\n\
    \         <RA-Request>  ::= < Diameter Header: 258, REQ, PXY >\n             \
    \             < Session-Id >\n                          { Origin-Host }\n    \
    \                      { Origin-Realm }\n                          { Destination-Realm\
    \ }\n                          { Destination-Host }\n                        \
    \  { Auth-Application-Id }\n                          { Re-Auth-Request-Type }\n\
    \                          [ User-Name ]\n                          [ Origin-AAA-Protocol\
    \ ]\n                          [ Origin-State-Id ]\n                         \
    \ [ NAS-Identifier ]\n                          [ NAS-IP-Address ]\n         \
    \                 [ NAS-IPv6-Address ]\n                          [ NAS-Port ]\n\
    \                          [ NAS-Port-Id ]\n                          [ NAS-Port-Type\
    \ ]\n                          [ Service-Type ]\n                          [ Framed-IP-Address\
    \ ]\n                          [ Framed-IPv6-Prefix ]\n                      \
    \    [ Framed-Interface-Id ]\n                          [ Called-Station-Id ]\n\
    \                          [ Calling-Station-Id ]\n                          [\
    \ Originating-Line-Info ]\n                          [ Acct-Session-Id ]\n   \
    \                       [ Acct-Multi-Session-Id ]\n                          [\
    \ State ]\n                        * [ Class ]\n                          [ Reply-Message\
    \ ]\n                        * [ Proxy-Info ]\n                        * [ Route-Record\
    \ ]\n                        * [ AVP ]\n"
- title: 3.4.  Re-Auth-Answer (RAA) Command
  contents:
  - "3.4.  Re-Auth-Answer (RAA) Command\n   The Re-Auth-Answer (RAA) message [RFC6733]\
    \ is sent in response to the\n   RAR.  The Result-Code AVP MUST be present and\
    \ indicates the\n   disposition of the request.\n   A successful RAA transaction\
    \ MUST be followed by an AAR message.\n      Message Format\n         <RA-Answer>\
    \  ::= < Diameter Header: 258, PXY >\n                          < Session-Id >\n\
    \                          { Result-Code }\n                          { Origin-Host\
    \ }\n                          { Origin-Realm }\n                          [ User-Name\
    \ ]\n                          [ Origin-AAA-Protocol ]\n                     \
    \     [ Origin-State-Id ]\n                          [ Error-Message ]\n     \
    \                     [ Error-Reporting-Host ]\n                        * [ Failed-AVP\
    \ ]\n                        * [ Redirected-Host ]\n                         \
    \ [ Redirected-Host-Usage ]\n                          [ Redirected-Host-Cache-Time\
    \ ]\n                          [ Service-Type ]\n                        * [ Configuration-Token\
    \ ]\n                          [ Idle-Timeout ]\n                          [ Authorization-Lifetime\
    \ ]\n                          [ Auth-Grace-Period ]\n                       \
    \   [ Re-Auth-Request-Type ]\n                          [ State ]\n          \
    \              * [ Class ]\n                        * [ Reply-Message ]\n    \
    \                      [ Prompt ]\n                        * [ Proxy-Info ]\n\
    \                        * [ AVP ]\n"
- title: 3.5.  Session-Termination-Request (STR) Command
  contents:
  - "3.5.  Session-Termination-Request (STR) Command\n   The Session-Termination-Request\
    \ (STR) message [RFC6733] is sent by\n   the NAS to inform the Diameter server\
    \ that an authenticated and/or\n   authorized session is being terminated.\n \
    \     Message Format\n         <ST-Request> ::= < Diameter Header: 275, REQ, PXY\
    \ >\n                         < Session-Id >\n                         { Origin-Host\
    \ }\n                         { Origin-Realm }\n                         { Destination-Realm\
    \ }\n                         { Auth-Application-Id }\n                      \
    \   { Termination-Cause }\n                         [ User-Name ]\n          \
    \               [ Destination-Host ]\n                       * [ Class ]\n   \
    \                      [ Origin-AAA-Protocol ]\n                         [ Origin-State-Id\
    \ ]\n                       * [ Proxy-Info ]\n                       * [ Route-Record\
    \ ]\n                       * [ AVP ]\n"
- title: 3.6.  Session-Termination-Answer (STA) Command
  contents:
  - "3.6.  Session-Termination-Answer (STA) Command\n   The Session-Termination-Answer\
    \ (STA) message [RFC6733] is sent by the\n   Diameter server to acknowledge the\
    \ notification that the session has\n   been terminated.  The Result-Code AVP\
    \ MUST be present and MAY contain\n   an indication that an error occurred while\
    \ the STR was being\n   serviced.\n   Upon sending the STA, the Diameter server\
    \ MUST release all resources\n   for the session indicated by the Session-Id AVP.\
    \  Any intermediate\n   server in the Proxy-Chain MAY also release any resources,\
    \ if\n   necessary.\n      Message Format\n         <ST-Answer>  ::= < Diameter\
    \ Header: 275, PXY >\n                          < Session-Id >\n             \
    \             { Result-Code }\n                          { Origin-Host }\n   \
    \                       { Origin-Realm }\n                          [ User-Name\
    \ ]\n                        * [ Class ]\n                          [ Error-Message\
    \ ]\n                          [ Error-Reporting-Host ]\n                    \
    \    * [ Failed-AVP ]\n                          [ Origin-AAA-Protocol ]\n   \
    \                       [ Origin-State-Id ]\n                        * [ Redirect-Host\
    \ ]\n                          [ Redirect-Host-Usage ]\n                     \
    \     [ Redirect-Max-Cache-Time ]\n                        * [ Proxy-Info ]\n\
    \                        * [ AVP ]\n"
- title: 3.7.  Abort-Session-Request (ASR) Command
  contents:
  - "3.7.  Abort-Session-Request (ASR) Command\n   The Abort-Session-Request (ASR)\
    \ message [RFC6733] can be sent by any\n   Diameter server to the NAS providing\
    \ session service to request that\n   the session identified by the Session-Id\
    \ be stopped.\n      Message Format\n         <AS-Request>  ::= < Diameter Header:\
    \ 274, REQ, PXY >\n                          < Session-Id >\n                \
    \          { Origin-Host }\n                          { Origin-Realm }\n     \
    \                     { Destination-Realm }\n                          { Destination-Host\
    \ }\n                          { Auth-Application-Id }\n                     \
    \     [ User-Name ]\n                          [ Origin-AAA-Protocol ]\n     \
    \                     [ Origin-State-Id ]\n                          [ NAS-Identifier\
    \ ]\n                          [ NAS-IP-Address ]\n                          [\
    \ NAS-IPv6-Address ]\n                          [ NAS-Port ]\n               \
    \           [ NAS-Port-Id ]\n                          [ NAS-Port-Type ]\n   \
    \                       [ Service-Type ]\n                          [ Framed-IP-Address\
    \ ]\n                          [ Framed-IPv6-Prefix ]\n                      \
    \    [ Framed-Interface-Id ]\n                          [ Called-Station-Id ]\n\
    \                          [ Calling-Station-Id ]\n                          [\
    \ Originating-Line-Info ]\n                          [ Acct-Session-Id ]\n   \
    \                       [ Acct-Multi-Session-Id ]\n                          [\
    \ State ]\n                        * [ Class ]\n                        * [ Reply-Message\
    \ ]\n                        * [ Proxy-Info ]\n                        * [ Route-Record\
    \ ]\n                        * [ AVP ]\n"
- title: 3.8.  Abort-Session-Answer (ASA) Command
  contents:
  - "3.8.  Abort-Session-Answer (ASA) Command\n   The ASA message [RFC6733] is sent\
    \ in response to the ASR.  The\n   Result-Code AVP MUST be present and indicates\
    \ the disposition of the\n   request.\n   If the session identified by Session-Id\
    \ in the ASR was successfully\n   terminated, the Result-Code is set to DIAMETER_SUCCESS.\
    \  If the\n   session is not currently active, the Result-Code AVP is set to\n\
    \   DIAMETER_UNKNOWN_SESSION_ID.  If the access device does not stop the\n   session\
    \ for any other reason, the Result-Code AVP is set to\n   DIAMETER_UNABLE_TO_COMPLY.\n\
    \      Message Format\n         <AS-Answer>  ::= < Diameter Header: 274, PXY >\n\
    \                          < Session-Id >\n                          { Result-Code\
    \ }\n                          { Origin-Host }\n                          { Origin-Realm\
    \ }\n                          [ User-Name ]\n                          [ Origin-AAA-Protocol\
    \ ]\n                          [ Origin-State-Id ]\n                         \
    \ [ State]\n                          [ Error-Message ]\n                    \
    \      [ Error-Reporting-Host ]\n                        * [ Failed-AVP ]\n  \
    \                      * [ Redirected-Host ]\n                          [ Redirected-Host-Usage\
    \ ]\n                          [ Redirected-Max-Cache-Time ]\n               \
    \         * [ Proxy-Info ]\n                        * [ AVP ]\n"
- title: 3.9.  Accounting-Request (ACR) Command
  contents:
  - "3.9.  Accounting-Request (ACR) Command\n   The ACR message [RFC6733] is sent\
    \ by the NAS to report its session\n   information to a target server downstream.\n\
    \   The Acct-Application-Id AVP MUST be present.\n   The AVPs listed in the Diameter\
    \ Base protocol specification [RFC6733]\n   MUST be assumed to be present, as\
    \ appropriate.  NAS service-specific\n   accounting AVPs SHOULD be present as\
    \ described in Section 4.6 and the\n   rest of this specification.\n      Message\
    \ Format\n         <AC-Request> ::= < Diameter Header: 271, REQ, PXY >\n     \
    \                    < Session-Id >\n                         { Origin-Host }\n\
    \                         { Origin-Realm }\n                         { Destination-Realm\
    \ }\n                         { Accounting-Record-Type }\n                   \
    \      { Accounting-Record-Number }\n                         { Acct-Application-Id\
    \ }\n                         [ User-Name ]\n                         [ Accounting-Sub-Session-Id\
    \ ]\n                         [ Acct-Session-Id ]\n                         [\
    \ Acct-Multi-Session-Id ]\n                         [ Origin-AAA-Protocol ]\n\
    \                         [ Origin-State-Id ]\n                         [ Destination-Host\
    \ ]\n                         [ Event-Timestamp ]\n                         [\
    \ Acct-Delay-Time ]\n                         [ NAS-Identifier ]\n           \
    \              [ NAS-IP-Address ]\n                         [ NAS-IPv6-Address\
    \ ]\n                         [ NAS-Port ]\n                         [ NAS-Port-Id\
    \ ]\n                         [ NAS-Port-Type ]\n                       * [ Class\
    \ ]\n                         [ Service-Type ]\n                         [ Termination-Cause\
    \ ]\n                         [ Accounting-Input-Octets ]\n                  \
    \       [ Accounting-Input-Packets ]\n                         [ Accounting-Output-Octets\
    \ ]\n                         [ Accounting-Output-Packets ]\n                \
    \         [ Acct-Authentic ]\n                         [ Accounting-Auth-Method\
    \ ]\n                         [ Acct-Link-Count ]\n                         [\
    \ Acct-Session-Time ]\n                         [ Acct-Tunnel-Connection ]\n \
    \                        [ Acct-Tunnel-Packets-Lost ]\n                      \
    \   [ Callback-Id ]\n                         [ Callback-Number ]\n          \
    \               [ Called-Station-Id ]\n                         [ Calling-Station-Id\
    \ ]\n                       * [ Connection-Info ]\n                         [\
    \ Originating-Line-Info ]\n                         [ Authorization-Lifetime ]\n\
    \                         [ Session-Timeout ]\n                         [ Idle-Timeout\
    \ ]\n                         [ Port-Limit ]\n                         [ Accounting-Realtime-Required\
    \ ]\n                         [ Acct-Interim-Interval ]\n                    \
    \   * [ Filter-Id ]\n                       * [ NAS-Filter-Rule ]\n          \
    \             * [ QoS-Filter-Rule ]\n                         [ Framed-Appletalk-Link\
    \ ]\n                         [ Framed-Appletalk-Network ]\n                 \
    \        [ Framed-Appletalk-Zone ]\n                         [ Framed-Compression\
    \ ]\n                         [ Framed-Interface-Id ]\n                      \
    \   [ Framed-IP-Address ]\n                         [ Framed-IP-Netmask ]\n  \
    \                     * [ Framed-IPv6-Prefix ]\n                         [ Framed-IPv6-Pool\
    \ ]\n                       * [ Framed-IPv6-Route ]\n                        \
    \ [ Framed-IPX-Network ]\n                         [ Framed-MTU ]\n          \
    \               [ Framed-Pool ]\n                         [ Framed-Protocol ]\n\
    \                       * [ Framed-Route ]\n                         [ Framed-Routing\
    \ ]\n                       * [ Login-IP-Host ]\n                       * [ Login-IPv6-Host\
    \ ]\n                         [ Login-LAT-Group ]\n                         [\
    \ Login-LAT-Node ]\n                         [ Login-LAT-Port ]\n            \
    \             [ Login-LAT-Service ]\n                         [ Login-Service\
    \ ]\n                         [ Login-TCP-Port ]\n                       * [ Tunneling\
    \ ]\n                       * [ Proxy-Info ]\n                       * [ Route-Record\
    \ ]\n                       * [ AVP ]\n"
- title: 3.10.  Accounting-Answer (ACA) Command
  contents:
  - "3.10.  Accounting-Answer (ACA) Command\n   The ACA message [RFC6733] is used\
    \ to acknowledge an Accounting-\n   Request command.  The Accounting-Answer command\
    \ contains the same\n   Session-Id as the Request.\n   Only the target Diameter\
    \ server or home Diameter server SHOULD\n   respond with the Accounting-Answer\
    \ command.\n   The Acct-Application-Id AVP MUST be present.\n   The AVPs listed\
    \ in the Diameter Base protocol specification [RFC6733]\n   MUST be assumed to\
    \ be present, as appropriate.  NAS service-specific\n   accounting AVPs SHOULD\
    \ be present as described in Section 4.6 and the\n   rest of this specification.\n\
    \      Message Format\n         <AC-Answer> ::= < Diameter Header: 271, PXY >\n\
    \                         < Session-Id >\n                         { Result-Code\
    \ }\n                         { Origin-Host }\n                         { Origin-Realm\
    \ }\n                         { Accounting-Record-Type }\n                   \
    \      { Accounting-Record-Number }\n                         { Acct-Application-Id\
    \ }\n                         [ User-Name ]\n                         [ Accounting-Sub-Session-Id\
    \ ]\n                         [ Acct-Session-Id ]\n                         [\
    \ Acct-Multi-Session-Id ]\n                         [ Event-Timestamp ]\n    \
    \                     [ Error-Message ]\n                         [ Error-Reporting-Host\
    \ ]\n                       * [ Failed-AVP ]\n                         [ Origin-AAA-Protocol\
    \ ]\n                         [ Origin-State-Id ]\n                         [\
    \ NAS-Identifier ]\n                         [ NAS-IP-Address ]\n            \
    \             [ NAS-IPv6-Address ]\n                         [ NAS-Port ]\n  \
    \                       [ NAS-Port-Id ]\n                         [ NAS-Port-Type\
    \ ]\n                         [ Service-Type ]\n                         [ Termination-Cause\
    \ ]\n                         [ Accounting-Realtime-Required ]\n             \
    \            [ Acct-Interim-Interval ]\n                       * [ Class ]\n \
    \                      * [ Proxy-Info ]\n                       * [ AVP ]\n"
- title: 4.  Diameter NAS Application AVPs
  contents:
  - "4.  Diameter NAS Application AVPs\n   The following sections define a new derived\
    \ AVP data format, define a\n   set of application-specific AVPs, and describe\
    \ the use of AVPs\n   defined in other documents by the Diameter NAS Application.\n"
- title: 4.1.  Derived AVP Data Formats
  contents:
  - '4.1.  Derived AVP Data Formats

    '
- title: 4.1.1.  QoSFilterRule
  contents:
  - "4.1.1.  QoSFilterRule\n   The QosFilterRule format is derived from the OctetString\
    \ AVP Base\n   Format.  It uses the US-ASCII charset.  Packets may be marked or\n\
    \   metered based on the following information:\n   o  Direction (in or out)\n\
    \   o  Source and destination IP address (possibly masked)\n   o  Protocol\n \
    \  o  Source and destination port (lists or ranges)\n   o  Differentiated Services\
    \ Code Point (DSCP) values (no mask or\n      range)\n   Rules for the appropriate\
    \ direction are evaluated in order; the first\n   matched rule terminates the\
    \ evaluation.  Each packet is evaluated\n   once.  If no rule matches, the packet\
    \ is treated as best effort.  An\n   access device unable to interpret or apply\
    \ a QoS rule SHOULD NOT\n   terminate the session.\n   QoSFilterRule filters MUST\
    \ follow the following format:\n      action dir proto from src to dst [options]\n\
    \      where\n      action\n                  tag  Mark packet with a specific\
    \ DSCP [RFC2474]\n                  meter  Meter traffic\n      dir         The\
    \ format is as described under IPFilterRule\n                  [RFC6733]\n   \
    \   proto       The format is as described under IPFilterRule\n              \
    \    [RFC6733]\n      src and dst The format is as described under IPFilterRule\n\
    \                  [RFC6733]\n   The options are described in Section 4.4.9.\n\
    \   The rule syntax is a modified subset of ipfw(8) from FreeBSD, and the\n  \
    \ ipfw.c code may provide a useful base for implementations.\n"
- title: 4.2.  NAS Session AVPs
  contents:
  - "4.2.  NAS Session AVPs\n   Diameter reserves the AVP Codes 0 - 255 for RADIUS\
    \ Attributes that\n   are implemented in Diameter.\n"
- title: 4.2.1.  Call and Session Information
  contents:
  - "4.2.1.  Call and Session Information\n   This section describes the AVPs specific\
    \ to Diameter applications\n   that are needed to identify the call and session\
    \ context and status\n   information.  On a request, this information allows the\
    \ server to\n   qualify the session.\n   These AVPs are used in addition to the\
    \ following AVPs from the\n   Diameter Base protocol specification [RFC6733]:\n\
    \      Session-Id Auth-Application-Id Origin-Host Origin-Realm\n      Auth-Request-Type\
    \ Termination-Cause\n   The following table gives the possible flag values for\
    \ the session\n   level AVPs.\n                                            +-----------+\n\
    \                                            | AVP Flag |\n                  \
    \                          |   Rules  |\n                                    \
    \        |-----+-----+\n                                            |MUST | MUST|\n\
    \   Attribute Name          Section Defined  |     |  NOT|\n   -----------------------------------------|-----+-----|\n\
    \   NAS-Port                4.2.2            |  M  |  V  |\n   NAS-Port-Id   \
    \          4.2.3            |  M  |  V  |\n   NAS-Port-Type           4.2.4  \
    \          |  M  |  V  |\n   Called-Station-Id       4.2.5            |  M  |\
    \  V  |\n   Calling-Station-Id      4.2.6            |  M  |  V  |\n   Connect-Info\
    \            4.2.7            |  M  |  V  |\n   Originating-Line-Info   4.2.8\
    \            |  M  |  V  |\n   Reply-Message           4.2.9            |  M \
    \ |  V  |\n   -----------------------------------------|-----+-----|\n"
- title: 4.2.2.  NAS-Port AVP
  contents:
  - "4.2.2.  NAS-Port AVP\n   The NAS-Port AVP (AVP Code 5) is of type Unsigned32\
    \ and contains the\n   physical or virtual port number of the NAS, which authenticates\
    \ the\n   user.  Note that \"port\" is meant in its sense as a service connection\n\
    \   on the NAS, not as an IP protocol identifier; hence, the format and\n   contents\
    \ of the string that identifies the port are specific to the\n   NAS implementation.\n\
    \   Either the NAS-Port AVP or the NAS-Port-Id AVP (Section 4.2.3) SHOULD\n  \
    \ be present in the AA-Request (AAR, Section 3.1) command if the NAS\n   differentiates\
    \ among its ports.\n"
- title: 4.2.3.  NAS-Port-Id AVP
  contents:
  - "4.2.3.  NAS-Port-Id AVP\n   The NAS-Port-Id AVP (AVP Code 87) is of type UTF8String\
    \ and consists\n   of 7-bit US-ASCII text identifying the port of the NAS authenticating\n\
    \   the user.  Note that \"port\" is meant in its sense as a service\n   connection\
    \ on the NAS, not as an IP protocol identifier.\n   Either the NAS-Port-Id AVP\
    \ or the NAS-Port AVP (Section 4.2.2) SHOULD\n   be present in the AA-Request\
    \ (AAR, Section 3.1) command if the NAS\n   differentiates among its ports.  NAS-Port-Id\
    \ is intended for use by\n   NASes that cannot conveniently number their ports.\n"
- title: 4.2.4.  NAS-Port-Type AVP
  contents:
  - "4.2.4.  NAS-Port-Type AVP\n   The NAS-Port-Type AVP (AVP Code 61) is of type\
    \ Enumerated and\n   contains the type of the port on which the NAS is authenticating\
    \ the\n   user.  This AVP SHOULD be present if the NAS uses the same NAS-Port\n\
    \   number ranges for different service types concurrently.\n   The currently\
    \ supported values of the NAS-Port-Type AVP are listed in\n   [RADIUSAttrVals].\n"
- title: 4.2.5.  Called-Station-Id AVP
  contents:
  - "4.2.5.  Called-Station-Id AVP\n   The Called-Station-Id AVP (AVP Code 30) is\
    \ of type UTF8String and\n   contains a 7-bit US-ASCII string sent by the NAS\
    \ to describe the\n   Layer 2 address the user contacted in the request.  For\
    \ dialup\n   access, this can be a phone number obtained by using the Dialed\n\
    \   Number Identification Service (DNIS) or a similar technology.  Note\n   that\
    \ this may be different from the phone number the call comes in\n   on.  For use\
    \ with IEEE 802 access, the Called-Station-Id MAY contain\n   a Media Access Control\
    \ (MAC) address formatted as described in\n   [RFC3580].\n   If the Called-Station-Id\
    \ AVP is present in an AAR message, the Auth-\n   Request-Type AVP is set to AUTHORIZE_ONLY,\
    \ and the User-Name AVP is\n   absent, the Diameter server MAY perform authorization\
    \ based on this\n   AVP.  This can be used by a NAS to request whether a call\
    \ should be\n   answered based on the DNIS result.\n   Further codification of\
    \ this field's allowed content and usage is\n   outside the scope of this specification.\n"
- title: 4.2.6.  Calling-Station-Id AVP
  contents:
  - "4.2.6.  Calling-Station-Id AVP\n   The Calling-Station-Id AVP (AVP Code 31) is\
    \ of type UTF8String and\n   contains a 7-bit US-ASCII string sent by the NAS\
    \ to describe the\n   Layer 2 address from which the user connected in the request.\
    \  For\n   dialup access, this is the phone number the call came from, using\n\
    \   Automatic Number Identification (ANI) or a similar technology.  For\n   use\
    \ with IEEE 802 access, the Calling-Station-Id AVP MAY contain a\n   MAC address,\
    \ formatted as described in RFC 3580.\n   If the Calling-Station-Id AVP is present\
    \ in an AAR message, the Auth-\n   Request-Type AVP is set to AUTHORIZE_ONLY,\
    \ and the User-Name AVP is\n   absent, the Diameter server MAY perform authorization\
    \ based on the\n   value of this AVP.  This can be used by a NAS to request whether\
    \ a\n   call should be answered based on the Layer 2 address (ANI, MAC\n   Address,\
    \ etc.)\n   Further codification of this field's allowed content and usage is\n\
    \   outside the scope of this specification.\n"
- title: 4.2.7.  Connect-Info AVP
  contents:
  - "4.2.7.  Connect-Info AVP\n   The Connect-Info AVP (AVP Code 77) is of type UTF8String\
    \ and is sent\n   in the AA-Request message or an ACR message with the value of\
    \ the\n   Accounting-Record-Type AVP set to STOP.  When sent in the AA-Request,\n\
    \   it indicates the nature of the user's connection.  The connection\n   speed\
    \ SHOULD be included at the beginning of the first Connect-Info\n   AVP in the\
    \ message.  If the transmit and receive connection speeds\n   differ, both may\
    \ be included in the first AVP with the transmit speed\n   listed first (the speed\
    \ at which the NAS modem transmits), then a\n   slash (/), then the receive speed,\
    \ and then other optional\n   information.\n   For example: \"28800 V42BIS/LAPM\"\
    \ or \"52000/31200 V90\"\n   If sent in an ACR message with the value of the Accounting-Record-\n\
    \   Type AVP set to STOP, this attribute may summarize statistics\n   relating\
    \ to session quality.  For example, in IEEE 802.11, the\n   Connect-Info AVP may\
    \ contain information on the number of link layer\n   retransmissions.  The exact\
    \ format of this attribute is\n   implementation specific.\n"
- title: 4.2.8.  Originating-Line-Info AVP
  contents:
  - "4.2.8.  Originating-Line-Info AVP\n   The Originating-Line-Info AVP (AVP Code\
    \ 94) is of type OctetString\n   and is sent by the NAS system to convey information\
    \ about the origin\n   of the call from a Signaling System 7 (SS7).\n   The Originating\
    \ Line Information (OLI) element indicates the nature\n   and/or characteristics\
    \ of the line from which a call originated\n   (e.g., pay phone, hotel phone,\
    \ cellular phone).  Telephone companies\n   are starting to offer OLI to their\
    \ customers as an option over\n   Primary Rate Interface (PRI).  Internet Service\
    \ Providers (ISPs) can\n   use OLI in addition to Called-Station-Id and Calling-Station-Id\n\
    \   attributes to differentiate customer calls and to define different\n   services.\n\
    \   The Value field contains two octets (00 - 99).  ANSI T1.113 and\n   BELLCORE\
    \ 394 can be used for additional information about these\n   values and their\
    \ use.  For information on the currently assigned\n   values, see [ANITypes].\n"
- title: 4.2.9.  Reply-Message AVP
  contents:
  - "4.2.9.  Reply-Message AVP\n   The Reply-Message AVP (AVP Code 18) is of type\
    \ UTF8String and\n   contains text that MAY be displayed to the user.  When used\
    \ in an AA-\n   Answer message with a successful Result-Code AVP, it indicates\n\
    \   success.  When found in an AAA message with a Result-Code other than\n   DIAMETER_SUCCESS,\
    \ the AVP contains a failure message.\n   The Reply-Message AVP MAY contain text\
    \ to prompt the user before\n   another AA-Request attempt.  When used in an AA-Answer\
    \ message\n   containing a Result-Code AVP with the value DIAMETER_MULTI_ROUND_AUTH\n\
    \   or in a Re-Auth-Request message, it MAY contain text to prompt the\n   user\
    \ for a response.\n"
- title: 4.3.  NAS Authentication AVPs
  contents:
  - "4.3.  NAS Authentication AVPs\n   This section defines the AVPs necessary to\
    \ carry the authentication\n   information in the Diameter protocol.  The functionality\
    \ defined here\n   provides a RADIUS-like Authentication, Authorization, and Accounting\n\
    \   service [RFC2865] over a more reliable and secure transport, as\n   defined\
    \ in the Diameter Base protocol [RFC6733].\n   The following table gives the possible\
    \ flag values for the session\n   level AVPs.\n                              \
    \              +----------+\n                                            | AVP\
    \ Flag |\n                                            |  Rules   |\n         \
    \                                   |----+-----|\n                           \
    \                 |MUST| MUST|\n   Attribute Name           Section Defined |\
    \    |  NOT|\n   -----------------------------------------|----+-----|\n   User-Password\
    \                 4.3.1      | M  |  V  |\n   Password-Retry                4.3.2\
    \      | M  |  V  |\n   Prompt                        4.3.3      | M  |  V  |\n\
    \   CHAP-Auth                     4.3.4      | M  |  V  |\n   CHAP-Algorithm \
    \               4.3.5      | M  |  V  |\n   CHAP-Ident                    4.3.6\
    \      | M  |  V  |\n   CHAP-Response                 4.3.7      | M  |  V  |\n\
    \   CHAP-Challenge                4.3.8      | M  |  V  |\n   ARAP-Password  \
    \               4.3.9      | M  |  V  |\n   ARAP-Challenge-Response       4.3.10\
    \     | M  |  V  |\n   ARAP-Security                 4.3.11     | M  |  V  |\n\
    \   ARAP-Security-Data            4.3.12     | M  |  V  |\n   -----------------------------------------|----+-----|\n"
- title: 4.3.1.  User-Password AVP
  contents:
  - "4.3.1.  User-Password AVP\n   The User-Password AVP (AVP Code 2) is of type OctetString\
    \ and\n   contains the password of the user to be authenticated or the user's\n\
    \   input in a multi-round authentication exchange.\n   The User-Password AVP\
    \ contains a user password or one-time password\n   and therefore represents sensitive\
    \ information.  As required by the\n   Diameter Base protocol [RFC6733], Diameter\
    \ messages are encrypted by\n   using IPsec [RFC4301] or Transport Layer Security\
    \ (TLS) [RFC5246].\n   Unless this AVP is used for one-time passwords, the User-Password\
    \ AVP\n   SHOULD NOT be used in untrusted proxy environments without encrypting\n\
    \   it by using end-to-end security techniques.\n   The clear-text password (prior\
    \ to encryption) MUST NOT be longer than\n   128 bytes in length.\n"
- title: 4.3.2.  Password-Retry AVP
  contents:
  - "4.3.2.  Password-Retry AVP\n   The Password-Retry AVP (AVP Code 75) is of type\
    \ Unsigned32 and MAY be\n   included in the AA-Answer if the Result-Code indicates\
    \ an\n   authentication failure.  The value of this AVP indicates how many\n \
    \  authentication attempts a user is permitted before being\n   disconnected.\
    \  This AVP is primarily intended for use when the\n   Framed-Protocol AVP (Section\
    \ 4.4.10.1) is set to ARAP.\n"
- title: 4.3.3.  Prompt AVP
  contents:
  - "4.3.3.  Prompt AVP\n   The Prompt AVP (AVP Code 76) is of type Enumerated and\
    \ MAY be present\n   in the AA-Answer message.  When present, it is used by the\
    \ NAS to\n   determine whether the user's response, when entered, should be\n\
    \   echoed.\n   The supported values are listed in [RADIUSAttrVals].\n"
- title: 4.3.4.  CHAP-Auth AVP
  contents:
  - "4.3.4.  CHAP-Auth AVP\n   The CHAP-Auth AVP (AVP Code 402) is of type Grouped\
    \ and contains the\n   information necessary to authenticate a user using the\
    \ PPP Challenge-\n   Handshake Authentication Protocol (CHAP) [RFC1994].  If the\
    \ CHAP-Auth\n   AVP is found in a message, the CHAP-Challenge AVP (Section 4.3.8)\n\
    \   MUST be present as well.  The optional AVPs containing the CHAP\n   response\
    \ depend upon the value of the CHAP-Algorithm AVP\n   (Section 4.3.8).  The grouped\
    \ AVP has the following ABNF [RFC5234]\n   grammar:\n   CHAP-Auth  ::= < AVP Header:\
    \ 402 >\n                  { CHAP-Algorithm }\n                  { CHAP-Ident\
    \ }\n                  [ CHAP-Response ]\n                * [ AVP ]\n"
- title: 4.3.5.  CHAP-Algorithm AVP
  contents:
  - "4.3.5.  CHAP-Algorithm AVP\n   The CHAP-Algorithm AVP (AVP Code 403) is of type\
    \ Enumerated and\n   contains the algorithm identifier used in the computation\
    \ of the CHAP\n   response [RFC1994].  The following values are currently supported:\n\
    \   CHAP with MD5       5\n      The CHAP response is computed by using the procedure\
    \ described in\n      [RFC1994].  This algorithm requires that the CHAP-Response\
    \ AVP\n      (Section 4.3.7) MUST be present in the CHAP-Auth AVP\n      (Section\
    \ 4.3.4).\n"
- title: 4.3.6.  CHAP-Ident AVP
  contents:
  - "4.3.6.  CHAP-Ident AVP\n   The CHAP-Ident AVP (AVP Code 404) is of type OctetString\
    \ and contains\n   the 1 octet CHAP Identifier used in the computation of the\
    \ CHAP\n   response [RFC1994].\n"
- title: 4.3.7.  CHAP-Response AVP
  contents:
  - "4.3.7.  CHAP-Response AVP\n   The CHAP-Response AVP (AVP Code 405) is of type\
    \ OctetString and\n   contains the 16-octet authentication data provided by the\
    \ user in\n   response to the CHAP challenge [RFC1994].\n"
- title: 4.3.8.  CHAP-Challenge AVP
  contents:
  - "4.3.8.  CHAP-Challenge AVP\n   The CHAP-Challenge AVP (AVP Code 60) is of type\
    \ OctetString and\n   contains the CHAP Challenge sent by the NAS to the CHAP\
    \ peer\n   [RFC1994].\n"
- title: 4.3.9.  ARAP-Password AVP
  contents:
  - "4.3.9.  ARAP-Password AVP\n   The ARAP-Password AVP (AVP Code 70) is of type\
    \ OctetString and is\n   only present when the Framed-Protocol AVP (Section 4.4.10.1)\
    \ is\n   included in the message and is set to ARAP.  This AVP MUST NOT be\n \
    \  present if either the User-Password or the CHAP-Auth AVP is present.\n   See\
    \ [RFC2869] for more information on the contents of this AVP.\n"
- title: 4.3.10.  ARAP-Challenge-Response AVP
  contents:
  - "4.3.10.  ARAP-Challenge-Response AVP\n   The ARAP-Challenge-Response AVP (AVP\
    \ Code 84) is of type OctetString\n   and is only present when the Framed-Protocol\
    \ AVP (Section 4.4.10.1)\n   is included in the message and is set to ARAP.  This\
    \ AVP contains an\n   8-octet response to the dial-in client's challenge.  The\
    \ Diameter\n   server calculates this value by taking the dial-in client's challenge\n\
    \   from the high-order 8 octets of the ARAP-Password AVP and performing\n   DES\
    \ encryption on this value with the authenticating user's password\n   as the\
    \ key.  If the user's password is fewer than 8 octets in length,\n   the password\
    \ is padded at the end with NULL octets to a length of 8\n   before it is used\
    \ as a key.\n"
- title: 4.3.11.  ARAP-Security AVP
  contents:
  - "4.3.11.  ARAP-Security AVP\n   The ARAP-Security AVP (AVP Code 73) is of type\
    \ Unsigned32 and MAY be\n   present in the AA-Answer message if the Framed-Protocol\
    \ AVP\n   (Section 4.4.10.1) is set to the value of ARAP, and the Result-Code\n\
    \   AVP ([RFC6733], Section 7.1) is set to DIAMETER_MULTI_ROUND_AUTH.\n   See\
    \ RFC 2869 for more information on the contents of this AVP.\n"
- title: 4.3.12.  ARAP-Security-Data AVP
  contents:
  - "4.3.12.  ARAP-Security-Data AVP\n   The ARAP-Security-Data AVP (AVP Code 74)\
    \ is of type OctetString and\n   MAY be present in the AA-Request or AA-Answer\
    \ message if the Framed-\n   Protocol AVP (Section 4.4.10.1) is set to the value\
    \ of ARAP and the\n   Result-Code AVP ([RFC6733], Section 7.1) is set to\n   DIAMETER_MULTI_ROUND_AUTH.\
    \  This AVP contains the security module\n   challenge or response associated\
    \ with the ARAP Security Module\n   specified in the ARAP-Security AVP (Section\
    \ 4.3.11).\n"
- title: 4.4.  NAS Authorization AVPs
  contents:
  - "4.4.  NAS Authorization AVPs\n   This section contains the authorization AVPs\
    \ supported in the NAS\n   Application.  The Service-Type AVP SHOULD be present\
    \ in all messages\n   and, based on its value, additional AVPs defined in this\
    \ section and\n   Section 4.5 MAY be present.\n   The following table gives the\
    \ possible flag values for the session-\n   level AVPs.\n                    \
    \                        +----------+\n                                      \
    \      | AVP Flag |\n                                            |  Rules   |\n\
    \                                            |----+-----|\n                  \
    \                          |MUST| MUST|\n   Attribute Name           Section Defined\
    \ |    |  NOT|\n   -----------------------------------------|----+-----|\n   Service-Type\
    \                4.4.1        | M  |  V  |\n   Callback-Number             4.4.2\
    \        | M  |  V  |\n   Callback-Id                 4.4.3        | M  |  V \
    \ |\n   Idle-Timeout                4.4.4        | M  |  V  |\n   Port-Limit \
    \                 4.4.5        | M  |  V  |\n   NAS-Filter-Rule             4.4.6\
    \        | M  |  V  |\n   Filter-Id                   4.4.7        | M  |  V \
    \ |\n   Configuration-Token         4.4.8        | M  |  V  |\n   QoS-Filter-Rule\
    \             4.4.9        |    |     |\n   Framed-Protocol             4.4.10.1\
    \     | M  |  V  |\n   Framed-Routing              4.4.10.2     | M  |  V  |\n\
    \   Framed-MTU                  4.4.10.3     | M  |  V  |\n   Framed-Compression\
    \          4.4.10.4     | M  |  V  |\n   Framed-IP-Address           4.4.10.5.1\
    \   | M  |  V  |\n   Framed-IP-Netmask           4.4.10.5.2   | M  |  V  |\n \
    \  Framed-Route                4.4.10.5.3   | M  |  V  |\n   Framed-Pool     \
    \            4.4.10.5.4   | M  |  V  |\n   Framed-Interface-Id         4.4.10.5.5\
    \   | M  |  V  |\n   Framed-IPv6-Prefix          4.4.10.5.6   | M  |  V  |\n \
    \  Framed-IPv6-Route           4.4.10.5.7   | M  |  V  |\n   Framed-IPv6-Pool\
    \            4.4.10.5.8   | M  |  V  |\n   Framed-IPX-Network          4.4.10.6.1\
    \   | M  |  V  |\n   Framed-Appletalk-Link       4.4.10.7.1   | M  |  V  |\n \
    \  Framed-Appletalk-Network    4.4.10.7.2   | M  |  V  |\n   Framed-Appletalk-Zone\
    \       4.4.10.7.3   | M  |  V  |\n   ARAP-Features               4.4.10.8.1 \
    \  | M  |  V  |\n   ARAP-Zone-Access            4.4.10.8.2   | M  |  V  |\n  \
    \ Login-IP-Host               4.4.11.1     | M  |  V  |\n   Login-IPv6-Host  \
    \           4.4.11.2     | M  |  V  |\n   Login-Service               4.4.11.3\
    \     | M  |  V  |\n   Login-TCP-Port              4.4.11.4.1   | M  |  V  |\n\
    \   Login-LAT-Service           4.4.11.5.1   | M  |  V  |\n   Login-LAT-Node \
    \             4.4.11.5.2   | M  |  V  |\n   Login-LAT-Group             4.4.11.5.3\
    \   | M  |  V  |\n   Login-LAT-Port              4.4.11.5.4   | M  |  V  |\n \
    \  -----------------------------------------|----+-----|\n"
- title: 4.4.1.  Service-Type AVP
  contents:
  - "4.4.1.  Service-Type AVP\n   The Service-Type AVP (AVP Code 6) is of type Enumerated\
    \ and contains\n   the type of service the user has requested or the type of service\
    \ to\n   be provided.  One such AVP MAY be present in an authentication and/or\n\
    \   authorization request or response.  A NAS is not required to\n   implement\
    \ all of these service types.  It MUST treat unknown or\n   unsupported Service-Type\
    \ AVPs received in a response as a failure and\n   end the session with a DIAMETER_INVALID_AVP_VALUE\
    \ Result-Code.\n   When used in a request, the Service-Type AVP SHOULD be considered\
    \ a\n   hint to the server that the NAS believes the user would prefer the\n \
    \  kind of service indicated.  The server is not required to honor the\n   hint.\
    \  Furthermore, if the service specified by the server is\n   supported, but not\
    \ compatible with the current mode of access, the\n   NAS MUST fail to start the\
    \ session.  The NAS MUST also generate the\n   appropriate error message(s).\n\
    \   The complete list of defined values that the Service-Type AVP can\n   take\
    \ can be found in [RFC2865] and the relevant IANA registry\n   [RADIUSAttrVals],\
    \ but the following values require further\n   qualification here:\n      Login\
    \ (1)\n         The user should be connected to a host.  The message MAY\n   \
    \      include additional AVPs as defined in Sections 4.4.11.4 or\n         4.4.11.5.\n\
    \      Framed (2)\n         A Framed Protocol, such as PPP or SLIP, should be\
    \ started for\n         the user.  The message MAY include additional AVPs defined\
    \ in\n         Sections 4.4.10 or 4.5 for tunneling services.\n      Callback\
    \ Login (3)\n         The user should be disconnected and called back, then connected\n\
    \         to a host.  The message MAY include additional AVPs defined in\n   \
    \      this section.\n      Callback Framed (4)\n         The user should be disconnected\
    \ and called back, and then a\n         Framed Protocol, such as PPP or SLIP,\
    \ should be started for the\n         user.  The message MAY include additional\
    \ AVPs defined in\n         Sections 4.4.10 or 4.5 for tunneling services.\n"
- title: 4.4.2.  Callback-Number AVP
  contents:
  - "4.4.2.  Callback-Number AVP\n   The Callback-Number AVP (AVP Code 19) is of type\
    \ UTF8String and\n   contains a dialing string to be used for callback, the format\
    \ of\n   which is deployment specific.  The Callback-Number AVP MAY be used in\n\
    \   an authentication and/or authorization request as a hint to the\n   server\
    \ that a callback service is desired, but the server is not\n   required to honor\
    \ the hint in the corresponding response.\n   Any further codification of this\
    \ field's allowed usage range is\n   outside the scope of this specification.\n"
- title: 4.4.3.  Callback-Id AVP
  contents:
  - "4.4.3.  Callback-Id AVP\n   The Callback-Id AVP (AVP Code 20) is of type UTF8String\
    \ and contains\n   the name of a place to be called, to be interpreted by the\
    \ NAS.  This\n   AVP MAY be present in an authentication and/or authorization\n\
    \   response.\n   This AVP is not roaming-friendly as it assumes that the Callback-Id\n\
    \   is configured on the NAS.  Using the Callback-Number AVP\n   (Section 4.4.2)\
    \ is therefore RECOMMENDED.\n"
- title: 4.4.4.  Idle-Timeout AVP
  contents:
  - "4.4.4.  Idle-Timeout AVP\n   The Idle-Timeout AVP (AVP Code 28) is of type Unsigned32\
    \ and sets the\n   maximum number of consecutive seconds of idle connection allowable\
    \ to\n   the user before termination of the session or before a prompt is\n  \
    \ issued.  The default is none or system specific.\n"
- title: 4.4.5.  Port-Limit AVP
  contents:
  - "4.4.5.  Port-Limit AVP\n   The Port-Limit AVP (AVP Code 62) is of type Unsigned32\
    \ and sets the\n   maximum number of ports the NAS provides to the user.  It MAY\
    \ be used\n   in an authentication and/or authorization request as a hint to the\n\
    \   server that multilink PPP [RFC1990] service is desired, but the\n   server\
    \ is not required to honor the hint in the corresponding\n   response.\n"
- title: 4.4.6.  NAS-Filter-Rule AVP
  contents:
  - "4.4.6.  NAS-Filter-Rule AVP\n   The NAS-Filter-Rule AVP (AVP Code 400) is of\
    \ type IPFilterRule and\n   provides filter rules that need to be configured on\
    \ the NAS for the\n   user.  One or more of these AVPs MAY be present in an authorization\n\
    \   response.\n"
- title: 4.4.7.  Filter-Id AVP
  contents:
  - "4.4.7.  Filter-Id AVP\n   The Filter-Id AVP (AVP Code 11) is of type UTF8String\
    \ and contains\n   the name of the filter list for this user.  It is intended\
    \ to be\n   human readable.  Zero or more Filter-Id AVPs MAY be sent in an\n \
    \  authorization answer message.\n   Identifying a filter list by name allows\
    \ the filter to be used on\n   different NASes without regard to filter-list implementation\
    \ details.\n   However, this AVP is not roaming-friendly, as filter naming differs\n\
    \   from one service provider to another.\n   In environments where backward compatibility\
    \ with RADIUS is not\n   required, it is RECOMMENDED that the NAS-Filter-Rule\
    \ AVP\n   (Section 4.4.6) be used instead.\n"
- title: 4.4.8.  Configuration-Token AVP
  contents:
  - "4.4.8.  Configuration-Token AVP\n   The Configuration-Token AVP (AVP Code 78)\
    \ is of type OctetString and\n   is sent by a Diameter server to a Diameter Proxy\
    \ Agent in an AA-\n   Answer command to indicate a type of user profile to be\
    \ used.  It\n   should not be sent to a Diameter client (NAS).\n   The format\
    \ of the Data field of this AVP is site specific.\n"
- title: 4.4.9.  QoS-Filter-Rule AVP
  contents:
  - "4.4.9.  QoS-Filter-Rule AVP\n   The QoS-Filter-Rule AVP (AVP Code 407) is of\
    \ type QoSFilterRule\n   (Section 4.1.1) and provides QoS filter rules that need\
    \ to be\n   configured on the NAS for the user.  One or more such AVPs MAY be\n\
    \   present in an authorization response.\n   The use of this AVP is NOT RECOMMENDED;\
    \ the AVPs defined by [RFC5777]\n   SHOULD be used instead.\n   The following\
    \ options are defined for the QoSFilterRule filters:\n   DSCP <color>\n      \
    \   If action is set to tag (Section 4.1.1), this option MUST be\n         included\
    \ in the rule.\n         Color values are defined in [RFC2474].  Exact matching\
    \ of DSCP\n         values is required (no masks or ranges).\n   metering <rate>\
    \ <color_under> <color_over>\n         The metering option provides Assured Forwarding,\
    \ as defined in\n         [RFC2597].  and MUST be present if the action is set\
    \ to meter\n         (Section 4.1.1) The rate option is the throughput, in bits\
    \ per\n         second, used by the access device to mark packets.  Traffic\n\
    \         over the rate is marked with the color_over codepoint, and\n       \
    \  traffic under the rate is marked with the color_under\n         codepoint.\
    \  The color_under and color_over options contain the\n         drop preferences\
    \ and MUST conform to the recommended codepoint\n         keywords described in\
    \ [RFC2597] (e.g., AF13).\n         The metering option also supports the strict\
    \ limit on traffic\n         required by Expedited Forwarding, as defined in [RFC3246].\
    \  The\n         color_over option may contain the keyword \"drop\" to prevent\n\
    \         forwarding of traffic that exceeds the rate parameter.\n"
- title: 4.4.10.  Framed Access Authorization AVPs
  contents:
  - "4.4.10.  Framed Access Authorization AVPs\n   This section lists the authorization\
    \ AVPs necessary to support framed\n   access, such as PPP and SLIP.  AVPs defined\
    \ in this section MAY be\n   present in a message if the Service-Type AVP was\
    \ set to \"Framed\" or\n   \"Callback Framed\".\n"
- title: 4.4.10.1.  Framed-Protocol AVP
  contents:
  - "4.4.10.1.  Framed-Protocol AVP\n   The Framed-Protocol AVP (AVP Code 7) is of\
    \ type Enumerated and\n   contains the framing to be used for framed access. \
    \ This AVP MAY be\n   present in both requests and responses.  The supported values\
    \ are\n   listed in [RADIUSAttrVals].\n"
- title: 4.4.10.2.  Framed-Routing AVP
  contents:
  - "4.4.10.2.  Framed-Routing AVP\n   The Framed-Routing AVP (AVP Code 10) is of\
    \ type Enumerated and\n   contains the routing method for the user when the user\
    \ is a router to\n   a network.  This AVP SHOULD only be present in authorization\n\
    \   responses.  The supported values are listed in [RADIUSAttrVals].\n"
- title: 4.4.10.3.  Framed-MTU AVP
  contents:
  - "4.4.10.3.  Framed-MTU AVP\n   The Framed-MTU AVP (AVP Code 12) is of type Unsigned32\
    \ and contains\n   the Maximum Transmission Unit (MTU) to be configured for the\
    \ user,\n   when it is not negotiated by some other means (such as PPP).  This\n\
    \   AVP SHOULD only be present in authorization responses.  The MTU value\n  \
    \ MUST be in the range from 64 to 65535.\n"
- title: 4.4.10.4.  Framed-Compression AVP
  contents:
  - "4.4.10.4.  Framed-Compression AVP\n   The Framed-Compression AVP (AVP Code 13)\
    \ is of type Enumerated and\n   contains the compression protocol to be used for\
    \ the link.  It MAY be\n   used in an authorization request as a hint to the server\
    \ that a\n   specific compression type is desired, but the server is not required\n\
    \   to honor the hint in the corresponding response.\n   More than one compression\
    \ protocol AVP MAY be sent.  The NAS is\n   responsible for applying the proper\
    \ compression protocol to the\n   appropriate link traffic.\n   The supported\
    \ values are listed in [RADIUSAttrVals].\n"
- title: 4.4.10.5.  IP Access Authorization AVPs
  contents:
  - "4.4.10.5.  IP Access Authorization AVPs\n   The AVPs defined in this section\
    \ are used when the user requests, or\n   is being granted, access service to\
    \ IP.\n"
- title: 4.4.10.5.1.  Framed-IP-Address AVP
  contents:
  - "4.4.10.5.1.  Framed-IP-Address AVP\n   The Framed-IP-Address AVP (AVP Code 8)\
    \ [RFC2865] is of type\n   OctetString and contains an IPv4 address of the type\
    \ specified in the\n   attribute value to be configured for the user.  It MAY\
    \ be used in an\n   authorization request as a hint to the server that a specific\
    \ address\n   is desired, but the server is not required to honor the hint in\
    \ the\n   corresponding response.\n   Two values have special significance: 0xFFFFFFFF\
    \ and 0xFFFFFFFE.  The\n   value 0xFFFFFFFF indicates that the NAS should allow\
    \ the user to\n   select an address (i.e., negotiated).  The value 0xFFFFFFFE\
    \ indicates\n   that the NAS should select an address for the user (e.g., assigned\n\
    \   from a pool of addresses kept by the NAS).\n"
- title: 4.4.10.5.2.  Framed-IP-Netmask AVP
  contents:
  - "4.4.10.5.2.  Framed-IP-Netmask AVP\n   The Framed-IP-Netmask AVP (AVP Code 9)\
    \ is of type OctetString and\n   contains the four octets of the IPv4 netmask\
    \ to be configured for the\n   user when the user is a router to a network.  It\
    \ MAY be used in an\n   authorization request as a hint to the server that a specific\
    \ netmask\n   is desired, but the server is not required to honor the hint in\
    \ the\n   corresponding response.  This AVP MUST be present in a response if\n\
    \   the request included this AVP with a value of 0xFFFFFFFF.\n"
- title: 4.4.10.5.3.  Framed-Route AVP
  contents:
  - "4.4.10.5.3.  Framed-Route AVP\n   The Framed-Route AVP (AVP Code 22) is of type\
    \ UTF8String and contains\n   the 7-bit US-ASCII routing information to be configured\
    \ for the user\n   on the NAS.  Zero or more of these AVPs MAY be present in an\n\
    \   authorization response.\n   The string MUST contain a destination prefix in\
    \ dotted quad form\n   optionally followed by a slash and a decimal-length specifier\
    \ stating\n   how many high-order bits of the prefix should be used.  This is\n\
    \   followed by a space, a gateway address in dotted quad form, a space,\n   and\
    \ one or more metrics separated by spaces; for example,\n      \"192.0.2.0/24\
    \ 192.0.2.1 1\"\n   The length specifier may be omitted, in which case it should\
    \ default\n   to 8 bits for class A prefixes, 16 bits for class B prefixes, and\
    \ 24\n   bits for class C prefixes; for example,\n      \"192.0.2.0 192.0.2.1\
    \ 1\"\n   Whenever the gateway address is specified as \"0.0.0.0\", the IP\n \
    \  address of the user SHOULD be used as the gateway address.\n"
- title: 4.4.10.5.4.  Framed-Pool AVP
  contents:
  - "4.4.10.5.4.  Framed-Pool AVP\n   The Framed-Pool AVP (AVP Code 88) is of type\
    \ OctetString and contains\n   the name of an assigned address pool that SHOULD\
    \ be used to assign an\n   address for the user.  If a NAS does not support multiple\
    \ address\n   pools, the NAS SHOULD ignore this AVP.  Address pools are usually\n\
    \   used for IP addresses but can be used for other protocols if the NAS\n   supports\
    \ pools for those protocols.\n   Although specified as type OctetString for compatibility\
    \ with RADIUS\n   [RFC2869], the encoding of the Data field SHOULD also conform\
    \ to the\n   rules for the UTF8String Data Format.\n"
- title: 4.4.10.5.5.  Framed-Interface-Id AVP
  contents:
  - "4.4.10.5.5.  Framed-Interface-Id AVP\n   The Framed-Interface-Id AVP (AVP Code\
    \ 96) is of type Unsigned64 and\n   contains the IPv6 interface identifier to\
    \ be configured for the user.\n   It MAY be used in authorization requests as\
    \ a hint to the server that\n   a specific interface identifier is desired, but\
    \ the server is not\n   required to honor the hint in the corresponding response.\n"
- title: 4.4.10.5.6.  Framed-IPv6-Prefix AVP
  contents:
  - "4.4.10.5.6.  Framed-IPv6-Prefix AVP\n   The Framed-IPv6-Prefix AVP (AVP Code\
    \ 97) is of type OctetString and\n   contains the IPv6 prefix to be configured\
    \ for the user.  One or more\n   AVPs MAY be used in authorization requests as\
    \ a hint to the server\n   that specific IPv6 prefixes are desired, but the server\
    \ is not\n   required to honor the hint in the corresponding response.\n"
- title: 4.4.10.5.7.  Framed-IPv6-Route AVP
  contents:
  - "4.4.10.5.7.  Framed-IPv6-Route AVP\n   The Framed-IPv6-Route AVP (AVP Code 99)\
    \ is of type UTF8String and\n   contains the US-ASCII routing information to be\
    \ configured for the\n   user on the NAS.  Zero or more of these AVPs MAY be present\
    \ in an\n   authorization response.\n   The string MUST contain an IPv6 address\
    \ prefix followed by a slash\n   and a decimal-length specifier stating how many\
    \ high-order bits of\n   the prefix should be used.  This is followed by a space,\
    \ a gateway\n   address in hexadecimal notation, a space, and one or more metrics\n\
    \   separated by spaces; for example,\n      \"2001:db8::/32 2001:db8:106:a00:20ff:fe99:a998\
    \ 1\"\n   Whenever the gateway address is the IPv6 unspecified address, the IP\n\
    \   address of the user SHOULD be used as the gateway address, such as\n   in:\n\
    \      \"2001:db8::/32 :: 1\"\n"
- title: 4.4.10.5.8.  Framed-IPv6-Pool AVP
  contents:
  - "4.4.10.5.8.  Framed-IPv6-Pool AVP\n   The Framed-IPv6-Pool AVP (AVP Code 100)\
    \ is of type OctetString and\n   contains the name of an assigned pool that SHOULD\
    \ be used to assign\n   an IPv6 prefix for the user.  If the access device does\
    \ not support\n   multiple prefix pools, it MUST ignore this AVP.\n   Although\
    \ specified as type OctetString for compatibility with RADIUS\n   [RFC3162], the\
    \ encoding of the Data field SHOULD also conform to the\n   rules for the UTF8String\
    \ Data Format.\n"
- title: 4.4.10.6.  IPX Access AVPs
  contents:
  - "4.4.10.6.  IPX Access AVPs\n   The AVPs defined in this section are used when\
    \ the user requests, or\n   is being granted, access to an IPX network service\
    \ [IPX].\n"
- title: 4.4.10.6.1.  Framed-IPX-Network AVP
  contents:
  - "4.4.10.6.1.  Framed-IPX-Network AVP\n   The Framed-IPX-Network AVP (AVP Code\
    \ 23) is of type Unsigned32 and\n   contains the IPX Network number to be configured\
    \ for the user.  It\n   MAY be used in an authorization request as a hint to the\
    \ server that\n   a specific address is desired, but the server is not required\
    \ to\n   honor the hint in the corresponding response.\n   Two addresses have\
    \ special significance: 0xFFFFFFFF and 0xFFFFFFFE.\n   The value 0xFFFFFFFF indicates\
    \ that the NAS should allow the user to\n   select an address (i.e., Negotiated).\
    \  The value 0xFFFFFFFE indicates\n   that the NAS should select an address for\
    \ the user (e.g., assign it\n   from a pool of one or more IPX networks kept by\
    \ the NAS).\n"
- title: 4.4.10.7.  AppleTalk Network Access AVPs
  contents:
  - "4.4.10.7.  AppleTalk Network Access AVPs\n   The AVPs defined in this section\
    \ are used when the user requests, or\n   is being granted, access to an AppleTalk\
    \ network [AppleTalk].\n"
- title: 4.4.10.7.1.  Framed-Appletalk-Link AVP
  contents:
  - "4.4.10.7.1.  Framed-Appletalk-Link AVP\n   The Framed-Appletalk-Link AVP (AVP\
    \ Code 37) is of type Unsigned32 and\n   contains the AppleTalk network number\
    \ that should be used for the\n   serial link to the user, which is another AppleTalk\
    \ router.  This AVP\n   MUST only be present in an authorization response and\
    \ is never used\n   when the user is not another router.\n   Despite the size\
    \ of the field, values range from 0 to 65,535.  The\n   special value of 0 indicates\
    \ an unnumbered serial link.  A value of 1\n   to 65,535 means that the serial\
    \ line between the NAS and the user\n   should be assigned that value as an AppleTalk\
    \ network number.\n"
- title: 4.4.10.7.2.  Framed-Appletalk-Network AVP
  contents:
  - "4.4.10.7.2.  Framed-Appletalk-Network AVP\n   The Framed-Appletalk-Network AVP\
    \ (AVP Code 38) is of type Unsigned32\n   and contains the AppleTalk network number\
    \ that the NAS should probe\n   to allocate an AppleTalk node for the user.  This\
    \ AVP MUST only be\n   present in an authorization response and is never used\
    \ when the user\n   is not another router.  Multiple instances of this AVP indicate\
    \ that\n   the NAS may probe, using any of the network numbers specified.\n  \
    \ Despite the size of the field, values range from 0 to 65,535.  The\n   special\
    \ value 0 indicates that the NAS should assign a network for\n   the user, using\
    \ its default cable range.  A value between 1 and\n   65,535 (inclusive) indicates\
    \ to the AppleTalk network that the NAS\n   should probe to find an address for\
    \ the user.\n"
- title: 4.4.10.7.3.  Framed-Appletalk-Zone AVP
  contents:
  - "4.4.10.7.3.  Framed-Appletalk-Zone AVP\n   The Framed-Appletalk-Zone AVP (AVP\
    \ Code 39) is of type OctetString\n   and contains the AppleTalk Default Zone\
    \ to be used for this user.\n   This AVP MUST only be present in an authorization\
    \ response.  Multiple\n   instances of this AVP in the same message are not allowed.\n\
    \   The codification of this field's allowed range is outside the scope\n   of\
    \ this specification.\n"
- title: 4.4.10.8.  AppleTalk Remote Access AVPs
  contents:
  - "4.4.10.8.  AppleTalk Remote Access AVPs\n   The AVPs defined in this section\
    \ are used when the user requests, or\n   is being granted, access to the AppleTalk\
    \ network via the AppleTalk\n   Remote Access Protocol [ARAP].  They are only\
    \ present if the Framed-\n   Protocol AVP (Section 4.4.10.1) is set to ARAP. \
    \ Section 2.2 of RFC\n   2869 describes the operational use of these attributes.\n"
- title: 4.4.10.8.1.  ARAP-Features AVP
  contents:
  - "4.4.10.8.1.  ARAP-Features AVP\n   The ARAP-Features AVP (AVP Code 71) is of\
    \ type OctetString and MAY be\n   present in the AA-Accept message if the Framed-Protocol\
    \ AVP is set to\n   the value of ARAP.  See RFC 2869 for more information about\
    \ the\n   format of this AVP.\n"
- title: 4.4.10.8.2.  ARAP-Zone-Access AVP
  contents:
  - "4.4.10.8.2.  ARAP-Zone-Access AVP\n   The ARAP-Zone-Access AVP (AVP Code 72)\
    \ is of type Enumerated and MAY\n   be present in the AA-Accept message if the\
    \ Framed-Protocol AVP is set\n   to the value of ARAP.\n   The supported values\
    \ are listed in [RADIUSAttrVals] and defined in\n   [RFC2869].\n"
- title: 4.4.11.  Non-Framed Access Authorization AVPs
  contents:
  - "4.4.11.  Non-Framed Access Authorization AVPs\n   This section contains the authorization\
    \ AVPs that are needed to\n   support terminal server functionality.  AVPs defined\
    \ in this section\n   MAY be present in a message if the Service-Type AVP was\
    \ set to\n   \"Login\" or \"Callback Login\".\n"
- title: 4.4.11.1.  Login-IP-Host AVP
  contents:
  - "4.4.11.1.  Login-IP-Host AVP\n   The Login-IP-Host AVP (AVP Code 14) [RFC2865]\
    \ is of type OctetString\n   and contains the IPv4 address of a host with which\
    \ to connect the\n   user when the Login-Service AVP is included.  It MAY be used\
    \ in an\n   AA-Request command as a hint to the Diameter server that a specific\n\
    \   host is desired, but the Diameter server is not required to honor the\n  \
    \ hint in the AA-Answer.\n   Two addresses have special significance: all ones\
    \ and 0.  The value\n   of all ones indicates that the NAS SHOULD allow the user\
    \ to select an\n   address.  The value 0 indicates that the NAS SHOULD select\
    \ a host to\n   connect the user to.\n"
- title: 4.4.11.2.  Login-IPv6-Host AVP
  contents:
  - "4.4.11.2.  Login-IPv6-Host AVP\n   The Login-IPv6-Host AVP (AVP Code 98) [RFC3162]\
    \ is of type\n   OctetString and contains the IPv6 address of a host with which\
    \ to\n   connect the user when the Login-Service AVP is included.  It MAY be\n\
    \   used in an AA-Request command as a hint to the Diameter server that a\n  \
    \ specific host is desired, but the Diameter server is not required to\n   honor\
    \ the hint in the AA-Answer.\n   Two addresses have special significance,\n  \
    \ 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF and 0.  The value\n   0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\
    \ indicates that the NAS SHOULD\n   allow the user to select an address.  The\
    \ value 0 indicates that the\n   NAS SHOULD select a host to connect the user\
    \ to.\n"
- title: 4.4.11.3.  Login-Service AVP
  contents:
  - "4.4.11.3.  Login-Service AVP\n   The Login-Service AVP (AVP Code 15) is of type\
    \ Enumerated and\n   contains the service that should be used to connect the user\
    \ to the\n   login host.  This AVP SHOULD only be present in authorization\n \
    \  responses.  The supported values are listed in RFC 2869.\n"
- title: 4.4.11.4.  TCP Services
  contents:
  - "4.4.11.4.  TCP Services\n   The AVP described in the following section MAY be\
    \ present if the\n   Login-Service AVP is set to Telnet, Rlogin, TCP Clear, or\
    \ TCP Clear\n   Quiet.\n"
- title: 4.4.11.4.1.  Login-TCP-Port AVP
  contents:
  - "4.4.11.4.1.  Login-TCP-Port AVP\n   The Login-TCP-Port AVP (AVP Code 16) is of\
    \ type Unsigned32 and\n   contains the TCP port with which the user is to be connected\
    \ when the\n   Login-Service AVP is also present.  This AVP SHOULD only be present\n\
    \   in authorization responses.  The value MUST NOT be greater than\n   65,535.\n"
- title: 4.4.11.5.  LAT Services
  contents:
  - "4.4.11.5.  LAT Services\n   The AVPs described in this section MAY be present\
    \ if the Login-\n   Service AVP is set to LAT [LAT].\n"
- title: 4.4.11.5.1.  Login-LAT-Service AVP
  contents:
  - "4.4.11.5.1.  Login-LAT-Service AVP\n   The Login-LAT-Service AVP (AVP Code 34)\
    \ is of type OctetString and\n   contains the system with which the user is to\
    \ be connected by LAT.\n   It MAY be used in an authorization request as a hint\
    \ to the server\n   that a specific service is desired, but the server is not\
    \ required to\n   honor the hint in the corresponding response.  This AVP MUST\
    \ only be\n   present in the response if the Login-Service AVP states that LAT\
    \ is\n   desired.\n   Administrators use this service attribute when dealing with\
    \ clustered\n   systems.  In these environments, several different time-sharing\
    \ hosts\n   share the same resources (disks, printers, etc.), and administrators\n\
    \   often configure each host to offer access (service) to each of the\n   shared\
    \ resources.  In this case, each host in the cluster advertises\n   its services\
    \ through LAT broadcasts.\n   Sophisticated users often know which service providers\
    \ (machines) are\n   faster and tend to use a node name when initiating a LAT\
    \ connection.\n   Some administrators want particular users to use certain machines\
    \ as\n   a primitive form of load balancing (although LAT knows how to do load\n\
    \   balancing itself).\n   The String field contains the identity of the LAT service\
    \ to use.\n   The LAT Architecture allows this string to contain $ (dollar), -\n\
    \   (hyphen), . (period), _ (underscore), numerics, upper- and lower-case\n  \
    \ alphabetics, and the ISO Latin-1 character set extension\n   [ISO.8859-1.1987].\
    \  All LAT string comparisons are case insensitive.\n"
- title: 4.4.11.5.2.  Login-LAT-Node AVP
  contents:
  - "4.4.11.5.2.  Login-LAT-Node AVP\n   The Login-LAT-Node AVP (AVP Code 35) is of\
    \ type OctetString and\n   contains the Node with which the user is to be automatically\n\
    \   connected by LAT.  It MAY be used in an authorization request as a\n   hint\
    \ to the server that a specific LAT node is desired, but the\n   server is not\
    \ required to honor the hint in the corresponding\n   response.  This AVP MUST\
    \ only be present in a response if the Login-\n   Service-Type AVP is set to LAT.\n\
    \   The String field contains the identity of the LAT service to use.\n   The\
    \ LAT Architecture allows this string to contain $ (dollar), -\n   (hyphen), .\
    \ (period), _ (underscore), numerics, upper- and lower-case\n   alphabetics, and\
    \ the ISO Latin-1 character set extension\n   [ISO.8859-1.1987].  All LAT string\
    \ comparisons are case insensitive.\n"
- title: 4.4.11.5.3.  Login-LAT-Group AVP
  contents:
  - "4.4.11.5.3.  Login-LAT-Group AVP\n   The Login-LAT-Group AVP (AVP Code 36) is\
    \ of type OctetString and\n   contains a string identifying the LAT group codes\
    \ this user is\n   authorized to use.  It MAY be used in an authorization request\
    \ as a\n   hint to the server that a specific group is desired, but the server\n\
    \   is not required to honor the hint in the corresponding response.\n   This\
    \ AVP MUST only be present in a response if the Login-Service-Type\n   AVP is\
    \ set to LAT.\n   LAT supports 256 different group codes, which LAT uses as a\
    \ form of\n   access rights.  LAT encodes the group codes as a 256-bit bitmap.\n\
    \   Administrators can assign one or more of the group code bits at the\n   LAT\
    \ service provider; it will only accept LAT connections that have\n   these group\
    \ codes set in the bitmap.  The administrators assign a\n   bitmap of authorized\
    \ group codes to each user.  LAT gets these from\n   the operating system and\
    \ uses them in its requests to the service\n   providers.\n   The codification\
    \ of the range of allowed usage of this field is\n   outside the scope of this\
    \ specification.\n"
- title: 4.4.11.5.4.  Login-LAT-Port AVP
  contents:
  - "4.4.11.5.4.  Login-LAT-Port AVP\n   The Login-LAT-Port AVP (AVP Code 63) is of\
    \ type OctetString and\n   contains the port with which the user is to be connected\
    \ by LAT.  It\n   MAY be used in an authorization request as a hint to the server\
    \ that\n   a specific port is desired, but the server is not required to honor\n\
    \   the hint in the corresponding response.  This AVP MUST only be\n   present\
    \ in a response if the Login-Service-Type AVP is set to LAT.\n   The String field\
    \ contains the identity of the LAT service to use.\n   The LAT Architecture allows\
    \ this string to contain $ (dollar), -\n   (hyphen), . (period), _ (underscore),\
    \ numerics, upper- and lower-case\n   alphabetics, and the ISO Latin-1 character\
    \ set extension\n   [ISO.8859-1.1987].\n   All LAT string comparisons are case\
    \ insensitive.\n"
- title: 4.5.  NAS Tunneling AVPs
  contents:
  - "4.5.  NAS Tunneling AVPs\n   Some NASes support compulsory tunnel services in\
    \ which the incoming\n   connection data is conveyed by an encapsulation method\
    \ to a gateway\n   elsewhere in the network.  This is typically transparent to\
    \ the\n   service user, and the tunnel characteristics may be described by the\n\
    \   remote Authentication, Authorization, and Accounting server, based on\n  \
    \ the user's authorization information.  Several tunnel characteristics\n   may\
    \ be returned, and the NAS implementation may choose one.  See\n   [RFC2868] and\
    \ [RFC2867] for further information.\n   The following table gives the possible\
    \ flag values for the session-\n   level AVPs and specifies whether the AVP MAY\
    \ be encrypted.\n                                            +----------+\n  \
    \                                          | AVP Flag |\n                    \
    \                        |  Rules   |\n                                      \
    \      |----+-----|\n                                            |MUST| MUST|\n\
    \   Attribute Name          Section Defined  |    | NOT |\n   -----------------------------------------|----+-----|\n\
    \   Tunneling                   4.5.1        | M  |  V  |\n   Tunnel-Type    \
    \             4.5.2        | M  |  V  |\n   Tunnel-Medium-Type          4.5.3\
    \        | M  |  V  |\n   Tunnel-Client-Endpoint      4.5.4        | M  |  V \
    \ |\n   Tunnel-Server-Endpoint      4.5.5        | M  |  V  |\n   Tunnel-Password\
    \             4.5.6        | M  |  V  |\n   Tunnel-Private-Group-Id     4.5.7\
    \        | M  |  V  |\n   Tunnel-Assignment-Id        4.5.8        | M  |  V \
    \ |\n   Tunnel-Preference           4.5.9        | M  |  V  |\n   Tunnel-Client-Auth-Id\
    \       4.5.10       | M  |  V  |\n   Tunnel-Server-Auth-Id       4.5.11     \
    \  | M  |  V  |\n   -----------------------------------------|----+-----|\n"
- title: 4.5.1.  Tunneling AVP
  contents:
  - "4.5.1.  Tunneling AVP\n   The Tunneling AVP (AVP Code 401) is of type Grouped\
    \ and contains the\n   following AVPs, used to describe a compulsory tunnel service\n\
    \   [RFC2868] [RFC2867].  Its data field has the following ABNF grammar:\n   Tunneling\
    \     ::= < AVP Header: 401 >\n                     { Tunnel-Type }\n        \
    \             { Tunnel-Medium-Type }\n                     { Tunnel-Client-Endpoint\
    \ }\n                     { Tunnel-Server-Endpoint }\n                     [ Tunnel-Preference\
    \ ]\n                     [ Tunnel-Client-Auth-Id ]\n                     [ Tunnel-Server-Auth-Id\
    \ ]\n                     [ Tunnel-Assignment-Id ]\n                     [ Tunnel-Password\
    \ ]\n                     [ Tunnel-Private-Group-Id ]\n"
- title: 4.5.2.  Tunnel-Type AVP
  contents:
  - "4.5.2.  Tunnel-Type AVP\n   The Tunnel-Type AVP (AVP Code 64) is of type Enumerated\
    \ and contains\n   the tunneling protocol(s) to be used (in the case of a tunnel\n\
    \   initiator) or in use (in the case of a tunnel terminator).  It MAY be\n  \
    \ used in an authorization request as a hint to the server that a\n   specific\
    \ tunnel type is desired, but the server is not required to\n   honor the hint\
    \ in the corresponding response.\n   The Tunnel-Type AVP SHOULD also be included\
    \ in ACR messages.\n   A tunnel initiator is not required to implement any of\
    \ these tunnel\n   types.  If a tunnel initiator receives a response that contains\
    \ only\n   unknown or unsupported tunnel types, the tunnel initiator MUST behave\n\
    \   as though a response were received with the Result-Code indicating a\n   failure.\n\
    \   The supported values are listed in [RADIUSAttrVals].\n"
- title: 4.5.3.  Tunnel-Medium-Type AVP
  contents:
  - "4.5.3.  Tunnel-Medium-Type AVP\n   The Tunnel-Medium-Type AVP (AVP Code 65) is\
    \ of type Enumerated and\n   contains the transport medium to use when creating\
    \ a tunnel for\n   protocols (such as L2TP [RFC3931]) that can operate over multiple\n\
    \   transports.  It MAY be used in an authorization request as a hint to\n   the\
    \ server that a specific medium is desired, but the server is not\n   required\
    \ to honor the hint in the corresponding response.\n   The supported values are\
    \ listed in [RADIUSAttrVals].\n"
- title: 4.5.4.  Tunnel-Client-Endpoint AVP
  contents:
  - "4.5.4.  Tunnel-Client-Endpoint AVP\n   The Tunnel-Client-Endpoint AVP (AVP Code\
    \ 66) is of type UTF8String\n   and contains the address of the initiator end\
    \ of the tunnel.  It MAY\n   be used in an authorization request as a hint to\
    \ the server that a\n   specific endpoint is desired, but the server is not required\
    \ to honor\n   the hint in the corresponding response.  This AVP SHOULD be included\n\
    \   in the corresponding ACR messages, in which case it indicates the\n   address\
    \ from which the tunnel was initiated.  This AVP, along with\n   the Tunnel-Server-Endpoint\
    \ (Section 4.5.5) and Session-Id AVPs\n   ([RFC6733], Section 8.8), can be used\
    \ to provide a globally unique\n   means to identify a tunnel for accounting and\
    \ auditing purposes.\n   If the value of the Tunnel-Medium-Type AVP (Section 4.5.3)\
    \ is IPv4\n   (1), then this string is either the fully qualified domain name\n\
    \   (FQDN) of the tunnel client machine or a \"dotted-decimal\" IP address.\n\
    \   Implementations MUST support the dotted-decimal format and SHOULD\n   support\
    \ the FQDN format for IP addresses.\n   If Tunnel-Medium-Type is IPv6 (2), then\
    \ this string is either the\n   FQDN of the tunnel client machine or a text representation\
    \ of the\n   address in either the preferred or alternate form [RFC3516].\n  \
    \ Conforming implementations MUST support the preferred form and SHOULD\n   support\
    \ both the alternate text form and the FQDN format for IPv6\n   addresses.\n \
    \  If Tunnel-Medium-Type is neither IPv4 nor IPv6, then this string is a\n   tag\
    \ referring to configuration data local to the Diameter client that\n   describes\
    \ the interface or medium-specific client address to use.\n   Note that this application\
    \ handles Internationalized Domain Names\n   (IDNs) in the same way as the Diameter\
    \ Base protocol (see Appendix D\n   of RFC 6733 for details).\n"
- title: 4.5.5.  Tunnel-Server-Endpoint AVP
  contents:
  - "4.5.5.  Tunnel-Server-Endpoint AVP\n   The Tunnel-Server-Endpoint AVP (AVP Code\
    \ 67) is of type UTF8String\n   and contains the address of the server end of\
    \ the tunnel.  It MAY be\n   used in an authorization request as a hint to the\
    \ server that a\n   specific endpoint is desired, but the server is not required\
    \ to honor\n   the hint in the corresponding response.\n   This AVP SHOULD be\
    \ included in the corresponding ACR messages, in\n   which case it indicates the\
    \ address from which the tunnel was\n   initiated.  This AVP, along with the Tunnel-Client-Endpoint\n\
    \   (Section 4.5.4) and Session-Id AVP ([RFC6733], Section 8.8), can be\n   used\
    \ to provide a globally unique means to identify a tunnel for\n   accounting and\
    \ auditing purposes.\n   If Tunnel-Medium-Type is IPv4 (1), then this string is\
    \ either the\n   fully qualified domain name (FQDN) of the tunnel server machine,\
    \ or a\n   \"dotted-decimal\" IP address.  Implementations MUST support the\n\
    \   dotted-decimal format and SHOULD support the FQDN format for IP\n   addresses.\n\
    \   If Tunnel-Medium-Type is IPv6 (2), then this string is either the\n   FQDN\
    \ of the tunnel server machine, or a text representation of the\n   address in\
    \ either the preferred or alternate form [RFC3516].\n   Implementations MUST support\
    \ the preferred form and SHOULD support\n   both the alternate text form and the\
    \ FQDN format for IPv6 addresses.\n   If Tunnel-Medium-Type is not IPv4 or IPv6,\
    \ this string is a tag\n   referring to configuration data local to the Diameter\
    \ client that\n   describes the interface or medium-specific server address to\
    \ use.\n   Note that this application handles IDNs in the same way as the\n  \
    \ Diameter base protocol (see Appendix D of RFC 6733 for details).\n"
- title: 4.5.6.  Tunnel-Password AVP
  contents:
  - "4.5.6.  Tunnel-Password AVP\n   The Tunnel-Password AVP (AVP Code 69) is of type\
    \ OctetString and may\n   contain a password to be used to authenticate to a remote\
    \ server.\n   The Tunnel-Password AVP SHOULD NOT be used in untrusted proxy\n\
    \   environments without encrypting it by using end-to-end security\n   techniques.\n"
- title: 4.5.7.  Tunnel-Private-Group-Id AVP
  contents:
  - "4.5.7.  Tunnel-Private-Group-Id AVP\n   The Tunnel-Private-Group-Id AVP (AVP\
    \ Code 81) is of type OctetString\n   and contains the group Id for a particular\
    \ tunneled session.  The\n   Tunnel-Private-Group-Id AVP MAY be included in an\
    \ authorization\n   request if the tunnel initiator can predetermine the group\
    \ resulting\n   from a particular connection.  It SHOULD be included in the\n\
    \   authorization response if this tunnel session is to be treated as\n   belonging\
    \ to a particular private group.  Private groups may be used\n   to associate\
    \ a tunneled session with a particular group of users.\n   For example, it MAY\
    \ be used to facilitate routing of unregistered IP\n   addresses through a particular\
    \ interface.  This AVP SHOULD be\n   included in the ACR messages that pertain\
    \ to the tunneled session.\n"
- title: 4.5.8.  Tunnel-Assignment-Id AVP
  contents:
  - "4.5.8.  Tunnel-Assignment-Id AVP\n   The Tunnel-Assignment-Id AVP (AVP Code 82)\
    \ is of type OctetString and\n   is used to indicate to the tunnel initiator the\
    \ particular tunnel to\n   which a session is to be assigned.  Some tunneling\
    \ protocols, such as\n   PPTP [RFC2637] and L2TP [RFC3931], allow for sessions\
    \ between the\n   same two tunnel endpoints to be multiplexed over the same tunnel\
    \ and\n   also for a given session to use its own dedicated tunnel.  This\n  \
    \ attribute provides a mechanism for Diameter to inform the tunnel\n   initiator\
    \ (for example, a LAC) whether to assign the session to a\n   multiplexed tunnel\
    \ or to a separate tunnel.  Furthermore, it allows\n   for sessions sharing multiplexed\
    \ tunnels to be assigned to different\n   multiplexed tunnels.\n   A particular\
    \ tunneling implementation may assign differing\n   characteristics to particular\
    \ tunnels.  For example, different\n   tunnels may be assigned different QoS parameters.\
    \  Such tunnels may\n   be used to carry either individual or multiple sessions.\
    \  The Tunnel-\n   Assignment-Id attribute thus allows the Diameter server to\
    \ indicate\n   that a particular session is to be assigned to a tunnel providing\
    \ an\n   appropriate level of service.  It is expected that any QoS-related\n\
    \   Diameter tunneling attributes defined in the future accompanying this\n  \
    \ one will be associated by the tunnel initiator with the Id given by\n   this\
    \ attribute.  In the meantime, any semantic given to a particular\n   Id string\
    \ is a matter left to local configuration in the tunnel\n   initiator.\n   The\
    \ Tunnel-Assignment-Id AVP is of significance only to Diameter and\n   the tunnel\
    \ initiator.  The Id it specifies is only intended to be of\n   local use to Diameter\
    \ and the tunnel initiator.  The Id assigned by\n   the tunnel initiator is not\
    \ conveyed to the tunnel peer.\n   This attribute MAY be included in authorization\
    \ responses.  The\n   tunnel initiator receiving this attribute MAY choose to\
    \ ignore it and\n   to assign the session to an arbitrary multiplexed or non-multiplexed\n\
    \   tunnel between the desired endpoints.  This AVP SHOULD also be\n   included\
    \ in the Accounting-Request messages pertaining to the\n   tunneled session.\n\
    \   If a tunnel initiator supports the Tunnel-Assignment-Id AVP, then it\n   should\
    \ assign a session to a tunnel in the following manner:\n   o  If this AVP is\
    \ present and a tunnel exists between the specified\n      endpoints with the\
    \ specified Id, then the session should be\n      assigned to that tunnel.\n \
    \  o  If this AVP is present and no tunnel exists between the specified\n    \
    \  endpoints with the specified Id, then a new tunnel should be\n      established\
    \ for the session and the specified Id should be\n      associated with the new\
    \ tunnel.\n   o  If this AVP is not present, then the session is assigned to an\n\
    \      unnamed tunnel.  If an unnamed tunnel does not yet exist between\n    \
    \  the specified endpoints, then it is established and used for this\n      session\
    \ and for subsequent ones established without the Tunnel-\n      Assignment-Id\
    \ attribute.  A tunnel initiator MUST NOT assign a\n      session for which a\
    \ Tunnel-Assignment-Id AVP was not specified to\n      a named tunnel (i.e., one\
    \ that was initiated by a session\n      specifying this AVP).\n   Note that the\
    \ same Id may be used to name different tunnels if these\n   tunnels are between\
    \ different endpoints.\n"
- title: 4.5.9.  Tunnel-Preference AVP
  contents:
  - "4.5.9.  Tunnel-Preference AVP\n   The Tunnel-Preference AVP (AVP Code 83) is\
    \ of type Unsigned32 and is\n   used to identify the relative preference assigned\
    \ to each tunnel when\n   more than one set of tunneling AVPs is returned within\
    \ separate\n   grouped AVPs.  It MAY be used in an authorization request as a\
    \ hint\n   to the server that a specific preference is desired, but the server\n\
    \   is not required to honor the hint in the corresponding response.\n   For example,\
    \ suppose that AVPs describing two tunnels are returned by\n   the server, one\
    \ with a tunnel type of PPTP and the other with a\n   tunnel type of L2TP.  If\
    \ the tunnel initiator supports only one of\n   the tunnel types returned, it\
    \ will initiate a tunnel of that type.\n   If, however, it supports both tunnel\
    \ protocols, it SHOULD use the\n   value of the Tunnel-Preference AVP to decide\
    \ which tunnel should be\n   started.  The tunnel with the lowest numerical value\
    \ in the Value\n   field of this AVP SHOULD be given the highest preference. \
    \ The values\n   assigned to two or more instances of the Tunnel-Preference AVP\
    \ within\n   a given authorization response MAY be identical.  In this case, the\n\
    \   tunnel initiator SHOULD use locally configured metrics to decide\n   which\
    \ set of AVPs to use.\n"
- title: 4.5.10.  Tunnel-Client-Auth-Id AVP
  contents:
  - "4.5.10.  Tunnel-Client-Auth-Id AVP\n   The Tunnel-Client-Auth-Id AVP (AVP Code\
    \ 90) is of type UTF8String and\n   specifies the 7-bit US-ASCII name used by\
    \ the tunnel initiator during\n   the authentication phase of tunnel establishment.\
    \  It MAY be used in\n   an authorization request as a hint to the server that\
    \ a specific\n   preference is desired, but the server is not required to honor\
    \ the\n   hint in the corresponding response.  This AVP MUST be present in the\n\
    \   authorization response if an authentication name other than the\n   default\
    \ is desired.  This AVP SHOULD be included in the ACR messages\n   pertaining\
    \ to the tunneled session.\n"
- title: 4.5.11.  Tunnel-Server-Auth-Id AVP
  contents:
  - "4.5.11.  Tunnel-Server-Auth-Id AVP\n   The Tunnel-Server-Auth-Id AVP (AVP Code\
    \ 91) is of type UTF8String and\n   specifies the 7-bit US-ASCII name used by\
    \ the tunnel terminator\n   during the authentication phase of tunnel establishment.\
    \  It MAY be\n   used in an authorization request as a hint to the server that\
    \ a\n   specific preference is desired, but the server is not required to\n  \
    \ honor the hint in the corresponding response.  This AVP MUST be\n   present\
    \ in the authorization response if an authentication name other\n   than the default\
    \ is desired.  This AVP SHOULD be included in the ACR\n   messages pertaining\
    \ to the tunneled session.\n"
- title: 4.6.  NAS Accounting AVPs
  contents:
  - "4.6.  NAS Accounting AVPs\n   Applications implementing this specification use\
    \ Diameter Accounting\n   (as defined in [RFC6733]) and the AVPs in the following\
    \ section.\n   Service-specific AVP usage is defined in the tables in Section\
    \ 5.\n   If accounting is active, Accounting Request (ACR) messages SHOULD be\n\
    \   sent after the completion of any Authentication or Authorization\n   transaction\
    \ and at the end of a session.  The value of the\n   Accounting-Record-Type AVP\
    \ [RFC6733] indicates the type of event.\n   All other AVPs identify the session\
    \ and provide additional\n   information relevant to the event.\n   The successful\
    \ completion of the first Authentication or\n   Authorization transaction SHOULD\
    \ cause a START_RECORD to be sent.  If\n   additional Authentications or Authorizations\
    \ occur in later\n   transactions, the first exchange should generate a START_RECORD,\
    \ and\n   the latter an INTERIM_RECORD.  For a given session, there MUST only\n\
    \   be one set of matching START and STOP records, with any number of\n   INTERIM_RECORDS\
    \ in between, or one EVENT_RECORD indicating the reason\n   a session wasn't started.\n\
    \   The following table gives the possible flag values for the session-\n   level\
    \ AVPs and specifies whether the AVP MAY be encrypted.\n                     \
    \                       +----------+\n                                       \
    \     | AVP Flag |\n                                            |  Rules   |\n\
    \                                            |----+-----|\n                  \
    \                  Section |MUST| MUST|\n   Attribute Name                   Defined\
    \ |    |  NOT|\n   -----------------------------------------|----+-----|\n   Accounting-Input-Octets\
    \           4.6.1  | M  |  V  |\n   Accounting-Output-Octets          4.6.2  |\
    \ M  |  V  |\n   Accounting-Input-Packets          4.6.3  | M  |  V  |\n   Accounting-Output-Packets\
    \         4.6.4  | M  |  V  |\n   Acct-Session-Time                 4.6.5  | M\
    \  |  V  |\n   Acct-Authentic                    4.6.6  | M  |  V  |\n   Accounting-Auth-Method\
    \            4.6.7  | M  |  V  |\n   Acct-Delay-Time                   4.6.8 \
    \ | M  |  V  |\n   Acct-Link-Count                   4.6.9  | M  |  V  |\n   Acct-Tunnel-Connection\
    \            4.6.10 | M  |  V  |\n   Acct-Tunnel-Packets-Lost          4.6.11\
    \ | M  |  V  |\n   -----------------------------------------|----+-----|\n"
- title: 4.6.1.  Accounting-Input-Octets AVP
  contents:
  - "4.6.1.  Accounting-Input-Octets AVP\n   The Accounting-Input-Octets AVP (AVP\
    \ Code 363) is of type Unsigned64\n   and contains the number of octets received\
    \ from the user.\n   For NAS usage, this AVP indicates how many octets have been\
    \ received\n   from the port in the course of this session.  It can only be present\n\
    \   in ACR messages with an Accounting-Record-Type [RFC6733] of\n   INTERIM_RECORD\
    \ or STOP_RECORD.\n"
- title: 4.6.2.  Accounting-Output-Octets AVP
  contents:
  - "4.6.2.  Accounting-Output-Octets AVP\n   The Accounting-Output-Octets AVP (AVP\
    \ Code 364) is of type Unsigned64\n   and contains the number of octets sent to\
    \ the user.\n   For NAS usage, this AVP indicates how many octets have been sent\
    \ to\n   the port in the course of this session.  It can only be present in\n\
    \   ACR messages with an Accounting-Record-Type of INTERIM_RECORD or\n   STOP_RECORD.\n"
- title: 4.6.3.  Accounting-Input-Packets AVP
  contents:
  - "4.6.3.  Accounting-Input-Packets AVP\n   The Accounting-Input-Packets (AVP Code\
    \ 365) is of type Unsigned64 and\n   contains the number of packets received from\
    \ the user.\n   For NAS usage, this AVP indicates how many packets have been received\n\
    \   from the port over the course of a session being provided to a Framed\n  \
    \ User.  It can only be present in ACR messages with an Accounting-\n   Record-Type\
    \ of INTERIM_RECORD or STOP_RECORD.\n"
- title: 4.6.4.  Accounting-Output-Packets AVP
  contents:
  - "4.6.4.  Accounting-Output-Packets AVP\n   The Accounting-Output-Packets (AVP\
    \ Code 366) is of type Unsigned64\n   and contains the number of IP packets sent\
    \ to the user.\n   For NAS usage, this AVP indicates how many packets have been\
    \ sent to\n   the port over the course of a session being provided to a Framed\n\
    \   User.  It can only be present in ACR messages with an Accounting-\n   Record-Type\
    \ of INTERIM_RECORD or STOP_RECORD.\n"
- title: 4.6.5.  Acct-Session-Time AVP
  contents:
  - "4.6.5.  Acct-Session-Time AVP\n   The Acct-Session-Time AVP (AVP Code 46) is\
    \ of type Unsigned32 and\n   indicates the length of the current session in seconds.\
    \  It can only\n   be present in ACR messages with an Accounting-Record-Type of\n\
    \   INTERIM_RECORD or STOP_RECORD.\n"
- title: 4.6.6.  Acct-Authentic AVP
  contents:
  - "4.6.6.  Acct-Authentic AVP\n   The Acct-Authentic AVP (AVP Code 45) is of type\
    \ Enumerated and\n   specifies how the user was authenticated.  The supported\
    \ values are\n   listed in [RADIUSAttrVals].\n"
- title: 4.6.7.  Accounting-Auth-Method AVP
  contents:
  - "4.6.7.  Accounting-Auth-Method AVP\n   The Accounting-Auth-Method AVP (AVP Code\
    \ 406) is of type Enumerated.\n   A NAS MAY include this AVP in an Accounting-Request\
    \ message to\n   indicate the method used to authenticate the user.  (Note that\
    \ this\n   AVP is semantically equivalent, and the supported values are\n   identical,\
    \ to the Microsoft MS-Acct-Auth-Type vendor-specific RADIUS\n   attribute [RFC2548]).\n"
- title: 4.6.8.  Acct-Delay-Time AVP
  contents:
  - "4.6.8.  Acct-Delay-Time AVP\n   The Acct-Delay-Time AVP (AVP Code 41) is of type\
    \ Unsigned32 and\n   indicates the number of seconds the Diameter client has been\
    \ trying\n   to send the Accounting-Request (ACR).  The accounting server may\n\
    \   subtract this value from the time when the ACR arrives at the server\n   to\
    \ calculate the approximate time of the event that caused the ACR to\n   be generated.\n\
    \   This AVP is not used for retransmissions at the transport level (TCP\n   or\
    \ SCTP).  Rather, it may be used when an ACR command cannot be\n   transmitted\
    \ because there is no appropriate peer to transmit it to or\n   it was rejected\
    \ because it could not be delivered.  In these cases,\n   the command MAY be buffered\
    \ and transmitted later, when an\n   appropriate peer-connection is available\
    \ or after sufficient time has\n   passed that the destination-host may be reachable\
    \ and operational.\n   If the ACR is re-sent in this way, the Acct-Delay-Time\
    \ AVP SHOULD be\n   included.  The value of this AVP indicates the number of seconds\
    \ that\n   elapsed between the time of the first attempt at transmission and the\n\
    \   current attempt.\n"
- title: 4.6.9.  Acct-Link-Count AVP
  contents:
  - "4.6.9.  Acct-Link-Count AVP\n   The Acct-Link-Count AVP (AVP Code 51) is of type\
    \ Unsigned32 and\n   indicates the total number of links that have been active\
    \ (current or\n   closed) in a given multilink session at the time the accounting\n\
    \   record is generated.  This AVP MAY be included in Accounting-Request\n   AVPs\
    \ for any session that may be part of a multilink service.\n   The Acct-Link-Count\
    \ AVP may be used to make it easier for an\n   accounting server to know when\
    \ it has all the records for a given\n   multilink service.  When the number of\
    \ Accounting-Request AVPs\n   received with Accounting-Record-Type = STOP_RECORD\
    \ and with the same\n   Acct-Multi-Session-Id and unique Session-Id AVPs equals\
    \ the largest\n   value of Acct-Link-Count seen in those Accounting-Request AVPs,\
    \ all\n   STOP_RECORD Accounting-Request AVPs for that multilink service have\n\
    \   been received.\n   The following example, showing eight Accounting-Request\
    \ AVPs,\n   illustrates how the Acct-Link-Count AVP is used.  In the table below,\n\
    \   only the relevant AVPs are shown, although additional AVPs containing\n  \
    \ accounting information will be present in the Accounting-Requests\n   AVPs.\n\
    \   Acct-Multi-                   Accounting-     Acct-\n   Session-Id     Session-Id\
    \     Record-Type     Link-Count\n   --------------------------------------------------------\n\
    \     \"...10\"        \"...10\"      START_RECORD        1\n     \"...10\"  \
    \      \"...11\"      START_RECORD        2\n     \"...10\"        \"...11\" \
    \     STOP_RECORD         2\n     \"...10\"        \"...12\"      START_RECORD\
    \        3\n     \"...10\"        \"...13\"      START_RECORD        4\n     \"\
    ...10\"        \"...12\"      STOP_RECORD         4\n     \"...10\"        \"\
    ...13\"      STOP_RECORD         4\n     \"...10\"        \"...10\"      STOP_RECORD\
    \         4\n"
- title: 4.6.10.  Acct-Tunnel-Connection AVP
  contents:
  - "4.6.10.  Acct-Tunnel-Connection AVP\n   The Acct-Tunnel-Connection AVP (AVP Code\
    \ 68) is of type OctetString\n   and contains the identifier assigned to the tunnel\
    \ session.  This\n   AVP, along with the Tunnel-Client-Endpoint (Section 4.5.4)\
    \ and\n   Tunnel-Server-Endpoint (Section 4.5.5) AVPs, may be used to provide\
    \ a\n   means to uniquely identify a tunnel session for auditing purposes.\n \
    \  The format of the identifier in this AVP depends upon the value of\n   the\
    \ Tunnel-Type AVP (Section 4.5.2).  For example, to identify an\n   L2TP tunnel\
    \ connection fully, the L2TP Tunnel Id and Call Id might be\n   encoded in this\
    \ field.  The exact encoding of this field is\n   implementation dependent.\n"
- title: 4.6.11.  Acct-Tunnel-Packets-Lost AVP
  contents:
  - "4.6.11.  Acct-Tunnel-Packets-Lost AVP\n   The Acct-Tunnel-Packets-Lost AVP (AVP\
    \ Code 86) is of type Unsigned32\n   and contains the number of packets lost on\
    \ a given tunnel.\n"
- title: 5.  AVP Occurrence Tables
  contents:
  - "5.  AVP Occurrence Tables\n   The following tables present the AVPs used by NAS\
    \ applications in NAS\n   messages and specify in which Diameter messages they\
    \ may or may not\n   be present.  Messages and AVPs defined in the Diameter Base\
    \ protocol\n   [RFC6733] are not described in this document.  Note that AVPs that\n\
    \   can only be present within a grouped AVP are not represented in this\n   table.\n\
    \   The tables use the following symbols:\n      0    The AVP MUST NOT be present\
    \ in the message.\n      0+   Zero or more instances of the AVP MAY be present\
    \ in the\n           message.\n      0-1  Zero or one instance of the AVP MAY\
    \ be present in the\n           message.\n      1    Exactly one instance of the\
    \ AVP MUST be present in the\n           message.\n"
- title: 5.1.  AA-Request / AA-Answer AVP Table
  contents:
  - "5.1.  AA-Request / AA-Answer AVP Table\n   The table in this section is limited\
    \ to the Command Codes defined in\n   this specification.\n                  \
    \               +-----------+\n                                 |  Command  |\n\
    \                                 |-----+-----+\n   Attribute Name           \
    \     | AAR | AAA |\n   ------------------------------|-----+-----+\n   Acct-Interim-Interval\
    \         | 0   | 0-1 |\n   ARAP-Challenge-Response       | 0   | 0-1 |\n   ARAP-Features\
    \                 | 0   | 0-1 |\n   ARAP-Password                 | 0-1 | 0  \
    \ |\n   ARAP-Security                 | 0-1 | 0-1 |\n   ARAP-Security-Data   \
    \         | 0+  | 0+  |\n   ARAP-Zone-Access              | 0   | 0-1 |\n   Auth-Application-Id\
    \           | 1   | 1   |\n   Auth-Grace-Period             | 0-1 | 0-1 |\n  \
    \ Auth-Request-Type             | 1   | 1   |\n   Auth-Session-State         \
    \   | 0-1 | 0-1 |\n   Authorization-Lifetime        | 0-1 | 0-1 |\n   ------------------------------|-----+-----+\n\
    \                                 +-----------+\n                            \
    \     |  Command  |\n                                 |-----+-----+\n   Attribute\
    \ Name                | AAR | AAA |\n   ------------------------------|-----+-----+\n\
    \   Callback-Id                   | 0   | 0-1 |\n   Callback-Number          \
    \     | 0-1 | 0-1 |\n   Called-Station-Id             | 0-1 | 0   |\n   Calling-Station-Id\
    \            | 0-1 | 0   |\n   CHAP-Auth                     | 0-1 | 0   |\n \
    \  CHAP-Challenge                | 0-1 | 0   |\n   Class                     \
    \    | 0   | 0+  |\n   Configuration-Token           | 0   | 0+  |\n   Connect-Info\
    \                  | 0+  | 0   |\n   Destination-Host              | 0-1 | 0 \
    \  |\n   Destination-Realm             | 1   | 0   |\n   Error-Message       \
    \          | 0   | 0-1 |\n   Error-Reporting-Host          | 0   | 0-1 |\n   Failed-AVP\
    \                    | 0+  | 0+  |\n   Filter-Id                     | 0   | 0+\
    \  |\n   Framed-Appletalk-Link         | 0   | 0-1 |\n   Framed-Appletalk-Network\
    \      | 0   | 0+  |\n   Framed-Appletalk-Zone         | 0   | 0-1 |\n   Framed-Compression\
    \            | 0+  | 0+  |\n   Framed-Interface-Id           | 0-1 | 0-1 |\n \
    \  Framed-IP-Address             | 0-1 | 0-1 |\n   Framed-IP-Netmask         \
    \    | 0-1 | 0-1 |\n   Framed-IPv6-Prefix            | 0+  | 0+  |\n   Framed-IPv6-Pool\
    \              | 0   | 0-1 |\n   Framed-IPv6-Route             | 0   | 0+  |\n\
    \   Framed-IPX-Network            | 0   | 0-1 |\n   Framed-MTU               \
    \     | 0-1 | 0-1 |\n   Framed-Pool                   | 0   | 0-1 |\n   Framed-Protocol\
    \               | 0-1 | 0-1 |\n   Framed-Route                  | 0   | 0+  |\n\
    \   Framed-Routing                | 0   | 0-1 |\n   Idle-Timeout             \
    \     | 0   | 0-1 |\n   Login-IP-Host                 | 0+  | 0+  |\n   Login-IPv6-Host\
    \               | 0+  | 0+  |\n   Login-LAT-Group               | 0-1 | 0-1 |\n\
    \   Login-LAT-Node                | 0-1 | 0-1 |\n   Login-LAT-Port           \
    \     | 0-1 | 0-1 |\n   Login-LAT-Service             | 0-1 | 0-1 |\n   Login-Service\
    \                 | 0   | 0-1 |\n   Login-TCP-Port                | 0   | 0-1\
    \ |\n   Multi-Round-Time-Out          | 0   | 0-1 |\n   ------------------------------|-----+-----+\n\
    \                                 +-----------+\n                            \
    \     |  Command  |\n                                 |-----+-----+\n   Attribute\
    \ Name                | AAR | AAA |\n   ------------------------------|-----+-----+\n\
    \   NAS-Filter-Rule               | 0   | 0+  |\n   NAS-Identifier           \
    \     | 0-1 | 0   |\n   NAS-IP-Address                | 0-1 | 0   |\n   NAS-IPv6-Address\
    \              | 0-1 | 0   |\n   NAS-Port                      | 0-1 | 0   |\n\
    \   NAS-Port-Id                   | 0-1 | 0   |\n   NAS-Port-Type            \
    \     | 0-1 | 0   |\n   Origin-AAA-Protocol           | 0-1 | 0-1 |\n   Origin-Host\
    \                   | 1   | 1   |\n   Origin-Realm                  | 1   | 1\
    \   |\n   Origin-State-Id               | 0-1 | 0-1 |\n   Originating-Line-Info\
    \         | 0-1 | 0   |\n   Password-Retry                | 0   | 0-1 |\n   Port-Limit\
    \                    | 0-1 | 0-1 |\n   Prompt                        | 0   | 0-1\
    \ |\n   Proxy-Info                    | 0+  | 0+  |\n   QoS-Filter-Rule      \
    \         | 0   | 0+  |\n   Re-Auth-Request-Type          | 0   | 0-1 |\n   Redirect-Host\
    \                 | 0   | 0+  |\n   Redirect-Host-Usage           | 0   | 0-1\
    \ |\n   Redirect-Max-Cache-Time       | 0   | 0-1 |\n   Reply-Message        \
    \         | 0   | 0+  |\n   Result-Code                   | 0   | 1   |\n   Route-Record\
    \                  | 0+  | 0   |\n   Service-Type                  | 0-1 | 0-1\
    \ |\n   Session-Id                    | 1   | 1   |\n   Session-Timeout      \
    \         | 0   | 0-1 |\n   State                         | 0-1 | 0-1 |\n   Tunneling\
    \                     | 0+  | 0+  |\n   User-Name                     | 0-1 |\
    \ 0-1 |\n   User-Password                 | 0-1 | 0   |\n   ------------------------------|-----+-----+\n"
- title: 5.2.  Accounting AVP Tables
  contents:
  - "5.2.  Accounting AVP Tables\n   The tables in this section are used to show which\
    \ AVPs defined in\n   this document are to be present and used in NAS application\n\
    \   Accounting messages.  These AVPs are defined in this document, as\n   well\
    \ as in [RFC6733] and [RFC2866].\n"
- title: 5.2.1.  Framed Access Accounting AVP Table
  contents:
  - "5.2.1.  Framed Access Accounting AVP Table\n   The table in this section is used\
    \ when the Service-Type AVP\n   (Section 4.4.1) specifies Framed Access.\n   \
    \                                          +-----------+\n                   \
    \                          |  Command  |\n                                   \
    \          |-----+-----+\n      Attribute Name                         | ACR |\
    \ ACA |\n      ---------------------------------------|-----+-----+\n      Accounting-Auth-Method\
    \                 | 0-1 | 0   |\n      Accounting-Input-Octets               \
    \ | 1   | 0   |\n      Accounting-Input-Packets               | 1   | 0   |\n\
    \      Accounting-Output-Octets               | 1   | 0   |\n      Accounting-Output-Packets\
    \              | 1   | 0   |\n      Accounting-Record-Number               | 0-1\
    \ | 0-1 |\n      Accounting-Record-Type                 | 1   | 1   |\n      Accounting-Realtime-Required\
    \           | 0-1 | 0-1 |\n      Accounting-Sub-Session-Id              | 0-1\
    \ | 0-1 |\n      Acct-Application-Id                    | 0-1 | 0-1 |\n      Acct-Session-Id\
    \                        | 1   | 0-1 |\n      Acct-Multi-Session-Id          \
    \        | 0-1 | 0-1 |\n      Acct-Authentic                         | 1   | 0\
    \   |\n      Acct-Delay-Time                        | 0-1 | 0   |\n      Acct-Interim-Interval\
    \                  | 0-1 | 0-1 |\n      Acct-Link-Count                      \
    \  | 0-1 | 0   |\n      Acct-Session-Time                      | 1   | 0   |\n\
    \      Acct-Tunnel-Connection                 | 0-1 | 0   |\n      Acct-Tunnel-Packets-Lost\
    \               | 0-1 | 0   |\n      Authorization-Lifetime                 |\
    \ 0-1 | 0   |\n      Callback-Id                            | 0-1 | 0   |\n  \
    \    Callback-Number                        | 0-1 | 0   |\n      Called-Station-Id\
    \                      | 0-1 | 0   |\n      Calling-Station-Id               \
    \      | 0-1 | 0   |\n      Class                                  | 0+  | 0+\
    \  |\n      Connection-Info                        | 0+  | 0   |\n      Destination-Host\
    \                       | 0-1 | 0   |\n      Destination-Realm               \
    \       | 1   | 0   |\n      Event-Timestamp                        | 0-1 | 0-1\
    \ |\n      Error-Message                          | 0   | 0-1 |\n      Error-Reporting-Host\
    \                   | 0   | 0-1 |\n      Failed-AVP                          \
    \   | 0   | 0+  |\n      ---------------------------------------|-----+-----+\n\
    \                                          +-----------+\n                   \
    \                       |  Command  |\n                                      \
    \    |-----+-----+\n   Attribute Name                         | ACR | ACA |\n\
    \   ---------------------------------------|-----+-----+\n   Framed-Appletalk-Link\
    \                  | 0-1 | 0   |\n   Framed-Appletalk-Network               |\
    \ 0-1 | 0   |\n   Framed-Appletalk-Zone                  | 0-1 | 0   |\n   Framed-Compression\
    \                     | 0-1 | 0   |\n   Framed-IP-Address                    \
    \  | 0-1 | 0   |\n   Framed-IP-Netmask                      | 0-1 | 0   |\n  \
    \ Framed-IPv6-Prefix                     | 0+  | 0   |\n   Framed-IPv6-Pool  \
    \                     | 0-1 | 0   |\n   Framed-IPX-Network                   \
    \  | 0-1 | 0   |\n   Framed-MTU                             | 0-1 | 0   |\n  \
    \ Framed-Pool                            | 0-1 | 0   |\n   Framed-Protocol   \
    \                     | 0-1 | 0   |\n   Framed-Route                         \
    \  | 0-1 | 0   |\n   Framed-Routing                         | 0-1 | 0   |\n  \
    \ NAS-Filter-Rule                        | 0+  | 0   |\n   NAS-Identifier    \
    \                     | 0-1 | 0-1 |\n   NAS-IP-Address                       \
    \  | 0-1 | 0-1 |\n   NAS-IPv6-Address                       | 0-1 | 0-1 |\n  \
    \ NAS-Port                               | 0-1 | 0-1 |\n   NAS-Port-Id       \
    \                     | 0-1 | 0-1 |\n   NAS-Port-Type                        \
    \  | 0-1 | 0-1 |\n   Origin-AAA-Protocol                    | 0-1 | 0-1 |\n  \
    \ Origin-Host                            | 1   | 1   |\n   Origin-Realm      \
    \                     | 1   | 1   |\n   Origin-State-Id                      \
    \  | 0-1 | 0-1 |\n   Originating-Line-Info                  | 0-1 | 0   |\n  \
    \ Proxy-Info                             | 0+  | 0+  |\n   QoS-Filter-Rule   \
    \                     | 0+  | 0   |\n   Route-Record                         \
    \  | 0+  | 0   |\n   Result-Code                            | 0   | 1   |\n  \
    \ Service-Type                           | 0-1 | 0-1 |\n   Session-Id        \
    \                     | 1   | 1   |\n   Termination-Cause                    \
    \  | 0-1 | 0-1 |\n   Tunnel-Assignment-Id                   | 0-1 | 0   |\n  \
    \ Tunnel-Client-Endpoint                 | 0-1 | 0   |\n   Tunnel-Medium-Type\
    \                     | 0-1 | 0   |\n   Tunnel-Private-Group-Id              \
    \  | 0-1 | 0   |\n   Tunnel-Server-Endpoint                 | 0-1 | 0   |\n  \
    \ Tunnel-Type                            | 0-1 | 0   |\n   User-Name         \
    \                     | 0-1 | 0-1 |\n   ---------------------------------------|-----+-----+\n"
- title: 5.2.2.  Non-Framed Access Accounting AVP Table
  contents:
  - "5.2.2.  Non-Framed Access Accounting AVP Table\n   The table in this section\
    \ is used when the Service-Type AVP\n   (Section 4.4.1) specifies Non-Framed Access.\n\
    \                                          +-----------+\n                   \
    \                       |  Command  |\n                                      \
    \    |-----+-----+\n   Attribute Name                         | ACR | ACA |\n\
    \   ---------------------------------------|-----+-----+\n   Accounting-Auth-Method\
    \                 | 0-1 | 0   |\n   Accounting-Input-Octets                | 1\
    \   | 0   |\n   Accounting-Output-Octets               | 1   | 0   |\n   Accounting-Record-Type\
    \                 | 1   | 1   |\n   Accounting-Record-Number               | 0-1\
    \ | 0-1 |\n   Accounting-Realtime-Required           | 0-1 | 0-1 |\n   Accounting-Sub-Session-Id\
    \              | 0-1 | 0-1 |\n   Acct-Application-Id                    | 0-1\
    \ | 0-1 |\n   Acct-Session-Id                        | 1   | 0-1 |\n   Acct-Multi-Session-Id\
    \                  | 0-1 | 0-1 |\n   Acct-Authentic                         |\
    \ 1   | 0   |\n   Acct-Delay-Time                        | 0-1 | 0   |\n   Acct-Interim-Interval\
    \                  | 0-1 | 0-1 |\n   Acct-Link-Count                        |\
    \ 0-1 | 0   |\n   Acct-Session-Time                      | 1   | 0   |\n   Authorization-Lifetime\
    \                 | 0-1 | 0   |\n   Callback-Id                            | 0-1\
    \ | 0   |\n   Callback-Number                        | 0-1 | 0   |\n   Called-Station-Id\
    \                      | 0-1 | 0   |\n   Calling-Station-Id                  \
    \   | 0-1 | 0   |\n   Class                                  | 0+  | 0+  |\n \
    \  Connection-Info                        | 0+  | 0   |\n   Destination-Host \
    \                      | 0-1 | 0   |\n   Destination-Realm                   \
    \   | 1   | 0   |\n   Event-Timestamp                        | 0-1 | 0-1 |\n \
    \  Error-Message                          | 0   | 0-1 |\n   Error-Reporting-Host\
    \                   | 0   | 0-1 |\n   Failed-AVP                             |\
    \ 0   | 0+  |\n   Login-IP-Host                          | 0+  | 0   |\n   Login-IPv6-Host\
    \                        | 0+  | 0   |\n   Login-LAT-Service                 \
    \     | 0-1 | 0   |\n   Login-LAT-Node                         | 0-1 | 0   |\n\
    \   Login-LAT-Group                        | 0-1 | 0   |\n   Login-LAT-Port  \
    \                       | 0-1 | 0   |\n   Login-Service                      \
    \    | 0-1 | 0   |\n   Login-TCP-Port                         | 0-1 | 0   |\n\
    \   ---------------------------------------|-----+-----+\n                   \
    \                       +-----------+\n                                      \
    \    |  Command  |\n                                          |-----+-----+\n\
    \   Attribute Name                         | ACR | ACA |\n   ---------------------------------------|-----+-----+\n\
    \   NAS-Identifier                         | 0-1 | 0-1 |\n   NAS-IP-Address  \
    \                       | 0-1 | 0-1 |\n   NAS-IPv6-Address                   \
    \    | 0-1 | 0-1 |\n   NAS-Port                               | 0-1 | 0-1 |\n\
    \   NAS-Port-Id                            | 0-1 | 0-1 |\n   NAS-Port-Type   \
    \                       | 0-1 | 0-1 |\n   Origin-AAA-Protocol                \
    \    | 0-1 | 0-1 |\n   Origin-Host                            | 1   | 1   |\n\
    \   Origin-Realm                           | 1   | 1   |\n   Origin-State-Id \
    \                       | 0-1 | 0-1 |\n   Originating-Line-Info              \
    \    | 0-1 | 0   |\n   Proxy-Info                             | 0+  | 0+  |\n\
    \   QoS-Filter-Rule                        | 0+  | 0   |\n   Route-Record    \
    \                       | 0+  | 0   |\n   Result-Code                        \
    \    | 0   | 1   |\n   Session-Id                             | 1   | 1   |\n\
    \   Service-Type                           | 0-1 | 0-1 |\n   Termination-Cause\
    \                      | 0-1 | 0-1 |\n   User-Name                           \
    \   | 0-1 | 0-1 |\n   ---------------------------------------|-----+-----+\n"
- title: 6.  Unicode Considerations
  contents:
  - "6.  Unicode Considerations\n   A number of the AVPs in this RFC use the UTF8String\
    \ type specified in\n   the Diameter Base protocol [RFC6733].  Implementation\
    \ differences in\n   Unicode input processing may result in the same Unicode input\n\
    \   characters generating different UTF-8 strings that fail to match when\n  \
    \ compared for equality.  This may result in interoperability problems\n   between\
    \ a network access server and a Diameter server when a UTF-8\n   string entered\
    \ locally is compared with one received via Diameter.\n   Many of the uses of\
    \ UTF8String in this RFC are limited to the 7-bit\n   US-ASCII-compatible subset\
    \ of UTF-8, where this class of Unicode\n   string comparison problems does not\
    \ arise.\n   Careful preparation of Unicode strings can increase the likelihood\n\
    \   that string comparison will work in ways that make sense for typical\n   users\
    \ throughout the world; [RFC3454] is an example a framework for\n   such Unicode\
    \ string preparation.  The Diameter application specified\n   in this RFC has\
    \ been deployed with use of Unicode in accordance with\n   [RFC4005], which does\
    \ not require any Unicode string preparation.  As\n   a result, additional requirements\
    \ for Unicode string preparation in\n   this RFC would not be backwards compatible\
    \ with existing usage.\n   The Diameter server and the network access servers\
    \ that it serves can\n   be assumed to be under common administrative control,\
    \ and all of the\n   UTF-8 strings involved are part of the configuration of these\n\
    \   servers.  Therefore, administrative interfaces for implementations of\n  \
    \ this RFC:\n   a.  SHOULD accept direct UTF-8 input of all configuration strings\
    \ for\n       AVPs that allow Unicode characters beyond the 7-bit US-ASCII-\n\
    \       compatible subset of Unicode (in addition to any provisions for\n    \
    \   accepting Unicode characters for processing into UTF-8), and\n   b.  SHOULD\
    \ make all such configuration strings available as UTF-8\n       strings.\n  \
    \ This functionality enables an administrator who encounters Unicode\n   string\
    \ comparison problems to copy one instance of aproblematic UTF-8\n   string from\
    \ one server to the other, after which the two (now\n   identical) copies should\
    \ compare as expected.\n"
- title: 7.  IANA Considerations
  contents:
  - "7.  IANA Considerations\n   Several of the namespaces used in this document are\
    \ managed by the\n   Internet Assigned Numbers Authority [IANA], including the\
    \ AVP Codes\n   [AVP-Codes], AVP Specific Values [AVP-Vals], Application IDs\n\
    \   [App-Ids], Command Codes [Command-Codes], and RADIUS Attribute Values\n  \
    \ [RADIUSAttrVals].\n   For the current values allocated, and the policies governing\n\
    \   allocation in those namespaces, please see the above-referenced\n   registries.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   This document describes the extension of Diameter\
    \ for the NAS\n   application.  Security considerations regarding the Diameter\
    \ protocol\n   itself are discussed in [RFC6733].  Use of this application of\n\
    \   Diameter MUST take into consideration the security issues and\n   requirements\
    \ of the Base protocol.\n"
- title: 8.1.  Authentication Considerations
  contents:
  - "8.1.  Authentication Considerations\n   This document does not contain a security\
    \ protocol but does discuss\n   how PPP authentication protocols can be carried\
    \ within the Diameter\n   protocol.  The PPP authentication protocols described\
    \ are PAP and\n   CHAP.\n   The use of PAP SHOULD be discouraged, as it exposes\
    \ users' passwords\n   to possibly non-trusted entities.  However, PAP is also\
    \ frequently\n   used for use with one-time passwords, which do not expose a security\n\
    \   risk.\n   This document also describes how CHAP can be carried within the\n\
    \   Diameter protocol, which is required for RADIUS backward\n   compatibility.\
    \  The CHAP protocol, as used in a RADIUS environment,\n   facilitates authentication\
    \ replay attacks.\n   The use of the EAP authentication protocols [RFC4072] can\
    \ offer\n   better security, given a method suitable for the circumstances.\n\
    \   Depending on the value of the Auth-Request-Type AVP, the Diameter\n   protocol\
    \ allows authorization-only requests that contain no\n   authentication information\
    \ from the client.  This capability goes\n   beyond the Call Check capabilities\
    \ provided by RADIUS (Section 5.6 of\n   [RFC2865]) in that no access decision\
    \ is requested.  As a result, a\n   new session cannot be started as a result\
    \ of a response to an\n   authorization-only request without introducing a significant\
    \ security\n   vulnerability.\n"
- title: 8.2.  AVP Considerations
  contents:
  - "8.2.  AVP Considerations\n   Diameter AVPs often contain security-sensitive data;\
    \ for example,\n   user passwords and location data, network addresses and cryptographic\n\
    \   keys.  With the exception of the Configuration-Token (Section 4.4.8),\n  \
    \ QoS-Filter-Rule (Section 4.4.9), and Tunneling (Section 4.5.1) AVPs,\n   all\
    \ of the AVPs defined in this document are considered to be\n   security-sensitive.\n\
    \   Diameter messages containing any AVPs considered to be security-\n   sensitive\
    \ MUST only be sent protected via mutually authenticated TLS\n   or IPsec.  In\
    \ addition, those messages MUST NOT be sent via\n   intermediate nodes unless\
    \ there is end-to-end security between the\n   originator and recipient or the\
    \ originator has locally trusted\n   configuration that indicates that end-to-end\
    \ security is not needed.\n   For example, end-to-end security may not be required\
    \ in the case\n   where an intermediary node is known to be operated as part of\
    \ the\n   same administrative domain as the endpoints so that an ability to\n\
    \   successfully compromise the intermediary would imply a high\n   probability\
    \ of being able to compromise the endpoints as well.  Note\n   that no end-to-end\
    \ security mechanism is specified in this document.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [ANITypes] NANPA Number Resource Info, \"ANI Assignments\"\
    ,\n              <http://www.nanpa.com/number_resource_info/\n              ani_ii_assignments.html>.\n\
    \   [RFC1994]  Simpson, W., \"PPP Challenge Handshake Authentication\n       \
    \       Protocol (CHAP)\", RFC 1994, August 1996.\n   [RFC2119]  Bradner, S.,\
    \ \"Key words for use in RFCs to Indicate\n              Requirement Levels\"\
    , BCP 14, RFC 2119, March 1997.\n   [RFC2865]  Rigney, C., Willens, S., Rubens,\
    \ A., and W. Simpson,\n              \"Remote Authentication Dial In User Service\
    \ (RADIUS)\", RFC\n              2865, June 2000.\n   [RFC3162]  Aboba, B., Zorn,\
    \ G., and D. Mitton, \"RADIUS and IPv6\", RFC\n              3162, August 2001.\n\
    \   [RFC3516]  Nerenberg, L., \"IMAP4 Binary Content Extension\", RFC 3516,\n\
    \              April 2003.\n   [RFC3539]  Aboba, B. and J. Wood, \"Authentication,\
    \ Authorization and\n              Accounting (AAA) Transport Profile\", RFC 3539,\
    \ June 2003.\n   [RFC5234]  Crocker, D. and P. Overell, \"Augmented BNF for Syntax\n\
    \              Specifications: ABNF\", STD 68, RFC 5234, January 2008.\n   [RFC5777]\
    \  Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M.,\n              and\
    \ A. Lior, \"Traffic Classification and Quality of\n              Service (QoS)\
    \ Attributes for Diameter\", RFC 5777, February\n              2010.\n   [RFC6733]\
    \  Fajardo, V., Arkko, J., Loughney, J., and G. Zorn,\n              \"Diameter\
    \ Base Protocol\", RFC 6733, October 2012.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [ARAP]     Apple Computer, \"Apple Remote Access\
    \ Protocol (ARAP)\n              Version 2.0 External Reference Specification\"\
    , R0612LL/B ,\n              September 1994.\n   [AVP-Codes]\n              IANA,\
    \ \"AVP Codes\",\n              <http://www.iana.org/assignments/aaa-parameters/>.\n\
    \   [AVP-Vals] IANA, \"AVP Specific Values\",\n              <http://www.iana.org/assignments/aaa-parameters/>.\n\
    \   [App-Ids]  IANA, \"Application IDs\",\n              <http://www.iana.org/assignments/aaa-parameters/>.\n\
    \   [AppleTalk]\n              Sidhu, G., Andrews, R., and A. Oppenheimer, \"\
    Inside\n              AppleTalk\", Second Edition Apple Computer, 1990.\n   [BASE]\
    \     Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.\n             \
    \ Arkko, \"Diameter Base Protocol\", RFC 3588, September 2003.\n   [Command-Codes]\n\
    \              IANA, \"Command Codes\",\n              <http://www.iana.org/assignments/aaa-parameters/>.\n\
    \   [IANA]     IANA, \"Internet Assigned Numbers Authority\",\n              <http://www.iana.org/>.\n\
    \   [IPX]      Novell, Inc., \"NetWare System Technical Interface\n          \
    \    Overview\", #883-000780-001, June 1989.\n   [ISO.8859-1.1987]\n         \
    \     International Organization for Standardization,\n              \"Information\
    \ technology - 8-bit single byte coded graphic\n              - character sets\
    \ - Part 1: Latin alphabet No. 1, JTC1/\n              SC2\", ISO Standard 8859-1,\
    \ 1987.\n   [LAT]      Digital Equipment Corp., \"Local Area Transport (LAT)\n\
    \              Specification V5.0\", AA-NL26A-TE, June 1989.\n   [RADIUSAttrVals]\n\
    \              IANA, \"Radius Attribute Values\",\n              <http://www.iana.org/assignments/radius-types/>.\n\
    \   [RFC1334]  Lloyd, B. and W. Simpson, \"PPP Authentication Protocols\",\n \
    \             RFC 1334, October 1992.\n   [RFC1661]  Simpson, W., \"The Point-to-Point\
    \ Protocol (PPP)\", STD 51,\n              RFC 1661, July 1994.\n   [RFC1990]\
    \  Sklower, K., Lloyd, B., McGregor, G., Carr, D., and T.\n              Coradetti,\
    \ \"The PPP Multilink Protocol (MP)\", RFC 1990,\n              August 1996.\n\
    \   [RFC2474]  Nichols, K., Blake, S., Baker, F., and D. Black,\n            \
    \  \"Definition of the Differentiated Services Field (DS\n              Field)\
    \ in the IPv4 and IPv6 Headers\", RFC 2474, December\n              1998.\n  \
    \ [RFC2548]  Zorn, G., \"Microsoft Vendor-specific RADIUS Attributes\",\n    \
    \          RFC 2548, March 1999.\n   [RFC2597]  Heinanen, J., Baker, F., Weiss,\
    \ W., and J. Wroclawski,\n              \"Assured Forwarding PHB Group\", RFC\
    \ 2597, June 1999.\n   [RFC2637]  Hamzeh, K., Pall, G., Verthein, W., Taarud,\
    \ J., Little,\n              W., and G. Zorn, \"Point-to-Point Tunneling Protocol\"\
    , RFC\n              2637, July 1999.\n   [RFC2866]  Rigney, C., \"RADIUS Accounting\"\
    , RFC 2866, June 2000.\n   [RFC2867]  Zorn, G., Aboba, B., and D. Mitton, \"RADIUS\
    \ Accounting\n              Modifications for Tunnel Protocol Support\", RFC 2867,\
    \ June\n              2000.\n   [RFC2868]  Zorn, G., Leifer, D., Rubens, A., Shriver,\
    \ J., Holdrege,\n              M., and I. Goyret, \"RADIUS Attributes for Tunnel\
    \ Protocol\n              Support\", RFC 2868, June 2000.\n   [RFC2869]  Rigney,\
    \ C., Willats, W., and P. Calhoun, \"RADIUS\n              Extensions\", RFC 2869,\
    \ June 2000.\n   [RFC2881]  Mitton, D. and M. Beadles, \"Network Access Server\n\
    \              Requirements Next Generation (NASREQNG) NAS Model\", RFC\n    \
    \          2881, July 2000.\n   [RFC2989]  Aboba, B., Calhoun, P., Glass, S.,\
    \ Hiller, T., McCann, P.,\n              Shiino, H., Walsh, P., Zorn, G., Dommety,\
    \ G., Perkins, C.,\n              Patil, B., Mitton, D., Manning, S., Beadles,\
    \ M., Chen, X.,\n              Sivalingham, S., Hameed, A., Munson, M., Jacobs,\
    \ S., Lim,\n              B., Hirschman, B., Hsu, R., Koo, H., Lipford, M.,\n\
    \              Campbell, E., Xu, Y., Baba, S., and E. Jaques, \"Criteria\n   \
    \           for Evaluating AAA Protocols for Network Access\", RFC\n         \
    \     2989, November 2000.\n   [RFC3169]  Beadles, M. and D. Mitton, \"Criteria\
    \ for Evaluating\n              Network Access Server Protocols\", RFC 3169, September\n\
    \              2001.\n   [RFC3246]  Davie, B., Charny, A., Bennet, J., Benson,\
    \ K., Le Boudec,\n              J., Courtney, W., Davari, S., Firoiu, V., and\
    \ D.\n              Stiliadis, \"An Expedited Forwarding PHB (Per-Hop\n      \
    \        Behavior)\", RFC 3246, March 2002.\n   [RFC3454]  Hoffman, P. and M.\
    \ Blanchet, \"Preparation of\n              Internationalized Strings (\"stringprep\"\
    )\", RFC 3454,\n              December 2002.\n   [RFC3580]  Congdon, P., Aboba,\
    \ B., Smith, A., Zorn, G., and J. Roese,\n              \"IEEE 802.1X Remote Authentication\
    \ Dial In User Service\n              (RADIUS) Usage Guidelines\", RFC 3580, September\
    \ 2003.\n   [RFC3931]  Lau, J., Townsley, M., and I. Goyret, \"Layer Two Tunneling\n\
    \              Protocol - Version 3 (L2TPv3)\", RFC 3931, March 2005.\n   [RFC4005]\
    \  Calhoun, P., Zorn, G., Spence, D., and D. Mitton,\n              \"Diameter\
    \ Network Access Server Application\", RFC 4005,\n              August 2005.\n\
    \   [RFC4072]  Eronen, P., Hiller, T., and G. Zorn, \"Diameter Extensible\n  \
    \            Authentication Protocol (EAP) Application\", RFC 4072,\n        \
    \      August 2005.\n   [RFC4301]  Kent, S. and K. Seo, \"Security Architecture\
    \ for the\n              Internet Protocol\", RFC 4301, December 2005.\n   [RFC5246]\
    \  Dierks, T. and E. Rescorla, \"The Transport Layer Security\n              (TLS)\
    \ Protocol Version 1.2\", RFC 5246, August 2008.\n"
- title: Appendix A.  Acknowledgements
  contents:
  - 'Appendix A.  Acknowledgements

    '
- title: A.1.  This Document
  contents:
  - "A.1.  This Document\n   The vast majority of the text in this document was taken\
    \ directly\n   from RFC 4005; the editor owes a debt of gratitude to the authors\n\
    \   thereof (especially Dave Mitton, who somehow managed to make nroff\n   paginate\
    \ the AVP Occurance Tables correctly!).\n   Thanks (in no particular order) to\
    \ Jai-Jin Lim, Liu Hans, Sebastien\n   Decugis, Jouni Korhonen, Mark Jones, Hannes\
    \ Tschofenig, Dave Crocker,\n   David Black, Barry Leiba, Peter Saint-Andre, Stefan\
    \ Winter, and\n   Lionel Morand for their useful reviews and helpful comments.\n"
- title: A.2.  RFC 4005
  contents:
  - "A.2.  RFC 4005\n   The authors would like to thank Carl Rigney, Allan C. Rubens,\
    \ William\n   Allen Simpson, and Steve Willens for their work on the original\n\
    \   RADIUS protocol, from which many of the concepts in this\n   specification\
    \ were derived.  Thanks, also, to Carl Rigney for\n   [RFC2866] and [RFC2869];\
    \ Ward Willats for [RFC2869]; Glen Zorn,\n   Bernard Aboba, and Dave Mitton for\
    \ [RFC2867] and [RFC3162]; and Dory\n   Leifer, John Shriver, Matt Holdrege, Allan\
    \ Rubens, Glen Zorn, and\n   Ignacio Goyret for their work on [RFC2868].  This\
    \ document stole text\n   and concepts from both [RFC2868] and [RFC2869].  Thanks\
    \ go to Carl\n   Williams for providing IPv6-specific text.\n   The authors would\
    \ also like to acknowledge the following people for\n   their contributions in\
    \ the development of the Diameter protocol:\n   Bernard Aboba, Jari Arkko, William\
    \ Bulley, Kuntal Chowdhury, Daniel\n   C. Fox, Lol Grant, Nancy Greene, Jeff Hagg,\
    \ Peter Heitman, Paul\n   Krumviede, Fergal Ladley, Ryan Moats, Victor Muslin,\
    \ Kenneth Peirce,\n   Sumit Vakil, John R. Vollbrecht, and Jeff Weisberg.\n  \
    \ Finally, Pat Calhoun would like to thank Sun Microsystems, as most of\n   the\
    \ effort put into this document was done while he was in their\n   employ.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Glen Zorn (editor)\n   Network Zen\n   227/358 Thanon Sanphawut\n\
    \   Bang Na, Bangkok  10260\n   Thailand\n   Phone: +66 (0)8-1000-4155\n   EMail:\
    \ glenzorn@gmail.com\n"
