- title: __initial_text__
  contents:
  - '               Diameter Network Access Server Application

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2005).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes the Diameter protocol application used for\n\
    \   Authentication, Authorization, and Accounting (AAA) services in the\n   Network\
    \ Access Server (NAS) environment.  When combined with the\n   Diameter Base protocol,\
    \ Transport Profile, and Extensible\n   Authentication Protocol specifications,\
    \ this application\n   specification satisfies typical network access services\
    \ requirements.\n   Initial deployments of the Diameter protocol are expected\
    \ to include\n   legacy systems.  Therefore, this application has been carefully\n\
    \   designed to ease the burden of protocol conversion between RADIUS and\n  \
    \ Diameter.  This is achieved by including the RADIUS attribute space\n   to eliminate\
    \ the need to perform many attribute translations.\n   The interactions between\
    \ Diameter applications and RADIUS specified\n   in this document are to be applied\
    \ to all Diameter applications.  In\n   this sense, this document extends the\
    \ Base Diameter protocol.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  5\n       1.1.  Terminology  . . . . . . . . . . . . . . . . .\
    \ . . . . .  5\n       1.2.  Requirements Language  . . . . . . . . . . . . .\
    \ . . . .  6\n       1.3.  Advertising Application Support  . . . . . . . . .\
    \ . . .  6\n   2.  NAS Calls, Ports, and Sessions . . . . . . . . . . . . . .\
    \ . .  6\n       2.1.  Diameter Session Establishment . . . . . . . . . . . .\
    \ .  7\n       2.2.  Diameter Session Reauthentication or Reauthorization . .\
    \  7\n       2.3.  Diameter Session Termination . . . . . . . . . . . . . .  8\n\
    \   3.  NAS Messages . . . . . . . . . . . . . . . . . . . . . . . . .  9\n  \
    \     3.1.  AA-Request (AAR) Command . . . . . . . . . . . . . . . .  9\n    \
    \   3.2.  AA-Answer (AAA) Command  . . . . . . . . . . . . . . . . 11\n      \
    \ 3.3.  Re-Auth-Request (RAR) Command  . . . . . . . . . . . . . 13\n       3.4.\
    \  Re-Auth-Answer (RAA) Command . . . . . . . . . . . . . . 14\n       3.5.  Session-Termination-Request\
    \ (STR) Command  . . . . . . . 15\n       3.6.  Session-Termination-Answer (STA)\
    \ Command . . . . . . . . 15\n       3.7.  Abort-Session-Request (ASR) Command\
    \  . . . . . . . . . . 16\n       3.8.  Abort-Session-Answer (ASA) Command . .\
    \ . . . . . . . . . 17\n       3.9.  Accounting-Request (ACR) Command . . . .\
    \ . . . . . . . . 17\n       3.10. Accounting-Answer (ACA) Command. . . . . .\
    \ . . . . . . . 19\n   4.  NAS Session AVPs . . . . . . . . . . . . . . . . .\
    \ . . . . . . 20\n       4.1.  Call and Session Information . . . . . . . . .\
    \ . . . . . 21\n       4.2.  NAS-Port AVP . . . . . . . . . . . . . . . . . .\
    \ . . . . 22\n       4.3.  NAS-Port-Id AVP  . . . . . . . . . . . . . . . . .\
    \ . . . 22\n       4.4.  NAS-Port-Type AVP  . . . . . . . . . . . . . . . . .\
    \ . . 22\n       4.5.  Called-Station-Id AVP  . . . . . . . . . . . . . . . .\
    \ . 23\n       4.6.  Calling-Station-Id AVP . . . . . . . . . . . . . . . . .\
    \ 23\n       4.7.  Connect-Info AVP . . . . . . . . . . . . . . . . . . . . 24\n\
    \       4.8.  Originating-Line-Info AVP  . . . . . . . . . . . . . . . 24\n  \
    \     4.9.  Reply-Message AVP  . . . . . . . . . . . . . . . . . . . 25\n   5.\
    \  NAS Authentication AVPs  . . . . . . . . . . . . . . . . . . . 26\n       5.1.\
    \  User-Password AVP  . . . . . . . . . . . . . . . . . . . 26\n       5.2.  Password-Retry\
    \ AVP . . . . . . . . . . . . . . . . . . . 27\n       5.3.  Prompt AVP . . .\
    \ . . . . . . . . . . . . . . . . . . . . 27\n       5.4.  CHAP-Auth AVP  . .\
    \ . . . . . . . . . . . . . . . . . . . 27\n       5.5.  CHAP-Algorithm AVP .\
    \ . . . . . . . . . . . . . . . . . . 28\n       5.6.  CHAP-Ident AVP . . . .\
    \ . . . . . . . . . . . . . . . . . 28\n       5.7.  CHAP-Response AVP  . . .\
    \ . . . . . . . . . . . . . . . . 28\n       5.8.  CHAP-Challenge AVP . . . .\
    \ . . . . . . . . . . . . . . . 28\n       5.9.  ARAP-Password AVP  . . . . .\
    \ . . . . . . . . . . . . . . 28\n       5.10. ARAP-Challenge-Response AVP. .\
    \ . . . . . . . . . . . . . 28\n       5.11. ARAP-Security AVP. . . . . . . .\
    \ . . . . . . . . . . . . 29\n       5.12. ARAP-Security-Data AVP . . . . . .\
    \ . . . . . . . . . . . 29\n   6.  NAS Authorization AVPs . . . . . . . . . .\
    \ . . . . . . . . . . 29\n       6.1.  Service-Type AVP . . . . . . . . . . .\
    \ . . . . . . . . . 30\n       6.2.  Callback-Number AVP  . . . . . . . . . .\
    \ . . . . . . . . 32\n       6.3.  Callback-Id AVP  . . . . . . . . . . . . .\
    \ . . . . . . . 32\n       6.4.  Idle-Timeout AVP . . . . . . . . . . . . . .\
    \ . . . . . . 32\n       6.5.  Port-Limit AVP . . . . . . . . . . . . . . . .\
    \ . . . . . 32\n       6.6.  NAS-Filter-Rule AVP  . . . . . . . . . . . . . .\
    \ . . . . 32\n       6.7.  Filter-Id AVP  . . . . . . . . . . . . . . . . . .\
    \ . . . 33\n       6.8.  Configuration-Token AVP  . . . . . . . . . . . . . .\
    \ . . 33\n       6.9.  QoS-Filter-Rule AVP  . . . . . . . . . . . . . . . . .\
    \ . 33\n       6.10. Framed Access Authorization AVPs . . . . . . . . . . . .\
    \ 35\n             6.10.1.  Framed-Protocol AVP . . . . . . . . . . . . . . 35\n\
    \             6.10.2.  Framed-Routing AVP. . . . . . . . . . . . . . . 35\n  \
    \           6.10.3.  Framed-MTU AVP. . . . . . . . . . . . . . . . . 35\n    \
    \         6.10.4.  Framed-Compression AVP. . . . . . . . . . . . . 36\n      \
    \ 6.11. IP Access Authorization AVPs.. . . . . . . . . . . . . . 36\n        \
    \     6.11.1.  Framed-IP-Address AVP . . . . . . . . . . . . . 36\n          \
    \   6.11.2.  Framed-IP-Netmask AVP . . . . . . . . . . . . . 36\n            \
    \ 6.11.3.  Framed-Route AVP. . . . . . . . . . . . . . . . 37\n             6.11.4.\
    \  Framed-Pool AVP . . . . . . . . . . . . . . . . 37\n             6.11.5.  Framed-Interface-Id\
    \ AVP . . . . . . . . . . . . 37\n             6.11.6.  Framed-IPv6-Prefix AVP.\
    \ . . . . . . . . . . . . 38\n             6.11.7.  Framed-IPv6-Route AVP . .\
    \ . . . . . . . . . . . 38\n             6.11.8.  Framed-IPv6-Pool AVP. . . .\
    \ . . . . . . . . . . 38\n       6.12. IPX Access . . . . . . . . . . . . . .\
    \ . . . . . . . . . 38\n             6.12.1.  Framed-IPX-Network AVP. . . . .\
    \ . . . . . . . . 39\n       6.13. AppleTalk Network Access . . . . . . . . .\
    \ . . . . . . . 39\n             6.13.1.  Framed-AppleTalk-Link AVP . . . . .\
    \ . . . . . . 39\n             6.13.2.  Framed-AppleTalk-Network AVP . . . . .\
    \ . . . .  39\n             6.13.3.  Framed-AppleTalk-Zone AVP . . . . . . . .\
    \ . . . 40\n       6.14. AppleTalk Remote Access. . . . . . . . . . . . . . .\
    \ . . 40\n             6.14.1.  ARAP-Features AVP . . . . . . . . . . . . . .\
    \ . 40\n             6.14.2.  ARAP-Zone-Access AVP. . . . . . . . . . . . . .\
    \ 40\n       6.15. Non-Framed Access Authorization AVPs . . . . . . . . . . 40\n\
    \             6.15.1.  Login-IP-Host AVP . . . . . . . . . . . . . . . 40\n  \
    \           6.15.2.  Login-IPv6-Host AVP . . . . . . . . . . . . . . 41\n    \
    \         6.15.3.  Login-Service AVP . . . . . . . . . . . . . . . 41\n      \
    \ 6.16. TCP Services . . . . . . . . . . . . . . . . . . . . . . 42\n        \
    \     6.16.1.  Login-TCP-Port AVP . . . . . . . . . . . . . .  42\n       6.17.\
    \ LAT Services . . . . . . . . . . . . . . . . . . . . . . 42\n             6.17.1.\
    \  Login-LAT-Service AVP . . . . . . . . . . . . . 42\n             6.17.2.  Login-LAT-Node\
    \ AVP. . . . . . . . . . . . . . . 43\n             6.17.3.  Login-LAT-Group AVP\
    \ . . . . . . . . . . . . . . 43\n             6.17.4.  Login-LAT-Port AVP. .\
    \ . . . . . . . . . . . . . 43\n   7.  NAS Tunneling  . . . . . . . . . . . .\
    \ . . . . . . . . . . . . 44\n       7.1.  Tunneling AVP  . . . . . . . . . .\
    \ . . . . . . . . . . . 44\n       7.2.  Tunnel-Type AVP  . . . . . . . . . .\
    \ . . . . . . . . . . 45\n       7.3.  Tunnel-Medium-Type AVP . . . . . . . .\
    \ . . . . . . . . . 46\n       7.4.  Tunnel-Client-Endpoint AVP . . . . . . .\
    \ . . . . . . . . 46\n       7.5.  Tunnel-Server-Endpoint AVP . . . . . . . .\
    \ . . . . . . . 47\n       7.6.  Tunnel-Password AVP  . . . . . . . . . . . .\
    \ . . . . . . 48\n       7.7.  Tunnel-Private-Group-Id AVP  . . . . . . . . .\
    \ . . . . . 48\n       7.8.  Tunnel-Assignment-Id AVP . . . . . . . . . . . .\
    \ . . . . 48\n       7.9.  Tunnel-Preference AVP  . . . . . . . . . . . . . .\
    \ . . . 49\n       7.10. Tunnel-Client-Auth-Id AVP. . . . . . . . . . . . . .\
    \ . . 50\n       7.11. Tunnel-Server-Auth-Id AVP. . . . . . . . . . . . . . .\
    \ . 50\n   8.  NAS Accounting . . . . . . . . . . . . . . . . . . . . . . . .\
    \ 50\n       8.1.  Accounting-Input-Octets AVP  . . . . . . . . . . . . . . 51\n\
    \       8.2.  Accounting-Output-Octets AVP . . . . . . . . . . . . . . 52\n  \
    \     8.3.  Accounting-Input-Packets AVP . . . . . . . . . . . . . . 52\n    \
    \   8.4.  Accounting-Output-Packets AVP  . . . . . . . . . . . . . 52\n      \
    \ 8.5.  Acct-Session-Time AVP  . . . . . . . . . . . . . . . . . 52\n       8.6.\
    \  Acct-Authentic AVP . . . . . . . . . . . . . . . . . . . 52\n       8.7.  Accounting-Auth-Method\
    \ AVP . . . . . . . . . . . . . . . 53\n       8.8.  Acct-Delay-Time  . . . .\
    \ . . . . . . . . . . . . . . . . 53\n       8.9.  Acct-Link-Count  . . . . .\
    \ . . . . . . . . . . . . . . . 54\n       8.10. Acct-Tunnel-Connection AVP .\
    \ . . . . . . . . . . . . . . 54\n       8.11. Acct-Tunnel-Packets-Lost AVP .\
    \ . . . . . . . . . . . . . 55\n   9.  RADIUS/Diameter Protocol Interactions \
    \ . . . . . . . . . . . . 55\n       9.1.  RADIUS Request Forwarded as Diameter\
    \ Request . . . . . . 55\n             9.1.1.   RADIUS Dynamic Authorization Considerations\
    \ . . 59\n       9.2.  Diameter Request Forwarded as RADIUS Request . . . . .\
    \ . 60\n             9.2.1.   RADIUS Dynamic Authorization Considerations . .\
    \ 62\n       9.3.  AVPs Used Only for Compatibility . . . . . . . . . . . . 63\n\
    \             9.3.1.   NAS-Identifier AVP. . . . . . . . . . . . . . . 63\n  \
    \           9.3.2.   NAS-IP-Address AVP. . . . . . . . . . . . . . . 64\n    \
    \         9.3.3.   NAS-IPv6-Address AVP. . . . . . . . . . . . . . 65\n      \
    \       9.3.4.   State AVP . . . . . . . . . . . . . . . . . . . 65\n        \
    \     9.3.5.   Termination-Cause AVP Code Values . . . . . . . 66\n          \
    \   9.3.6.   Origin-AAA-Protocol . . . . . . . . . . . . . . 68\n       9.4. \
    \ Prohibited RADIUS Attributes . . . . . . . . . . . . . . 69\n       9.5.  Translatable\
    \ Diameter AVPs . . . . . . . . . . . . . . . 69\n       9.6.  RADIUS Vendor-Specific\
    \ Attributes  . . . . . . . . . . . 69\n             9.6.1.  Forwarding a Diameter\
    \ Vendor Specific AVP as a\n                     RADIUS VSA . . . . . . . . .\
    \ . . . . . . . . . . 70\n             9.6.2.  Forwarding a RADIUS VSA as a Diameter\
    \ Vendor\n                     Specific AVP . . . . . . . . . . . . . . . . .\
    \ . 70\n   10. AVP Occurrence Tables. . . . . . . . . . . . . . . . . . . . .\
    \ 71\n       10.1. AA-Request/Answer AVP Table. . . . . . . . . . . . . . . 71\n\
    \       10.2. Accounting AVP Tables. . . . . . . . . . . . . . . . . . 73\n  \
    \           10.2.1.  Accounting Framed Access AVP Table. . . . . . . 74\n    \
    \         10.2.2.  Accounting Non-Framed Access AVP Table. . . . . 76\n   11.\
    \ IANA Considerations. . . . . . . . . . . . . . . . . . . . . . 77\n       11.1.\
    \ Command Codes. . . . . . . . . . . . . . . . . . . . . . 77\n       11.2. AVP\
    \ Codes. . . . . . . . . . . . . . . . . . . . . . . . 78\n       11.3. Application\
    \ Identifier . . . . . . . . . . . . . . . . . 78\n       11.4. CHAP-Algorithm\
    \ AVP Values. . . . . . . . . . . . . . . . 78\n       11.5. Accounting-Auth-Method\
    \ AVP Values. . . . . . . . . . . . 78\n       11.6. Origin-AAA-Protocol AVP Values\
    \ . . . . . . . . . . . . . 78\n   12. Security Considerations. . . . . . . .\
    \ . . . . . . . . . . . . 78\n   13. References . . . . . . . . . . . . . . .\
    \ . . . . . . . . . . . 79\n       13.1. Normative References . . . . . . . .\
    \ . . . . . . . . . . 79\n       13.2. Informative References . . . . . . . .\
    \ . . . . . . . . . 80\n   14. Acknowledgements . . . . . . . . . . . . . . .\
    \ . . . . . . . . 83\n   Authors' Addresses . . . . . . . . . . . . . . . . .\
    \ . . . . . . . 84\n   Full Copyright Statement . . . . . . . . . . . . . . .\
    \ . . . . . . 85\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document describes the Diameter protocol application\
    \ used for\n   AAA in the Network Access Server (NAS) environment.  When combined\n\
    \   with the Diameter Base protocol [BASE], Transport Profile\n   [DiamTrans],\
    \ and EAP [DiamEAP] specifications, this Diameter NAS\n   application specification\
    \ satisfies NAS-related requirements defined\n   in RFC 2989 [AAACriteria] and\
    \ RFC 3169 [NASCriteria].\n   Initial deployments of the Diameter protocol are\
    \ expected to include\n   legacy systems.  Therefore, this application has been\
    \ carefully\n   designed to ease the burden of protocol conversion between RADIUS\
    \ and\n   Diameter.  This is achieved by including the RADIUS attribute space\n\
    \   to eliminate the need to perform many attribute translations.\n   The interactions\
    \ specified in this document between Diameter\n   applications and RADIUS are\
    \ to be applied to all Diameter\n   applications.  In this sense, this document\
    \ extends the Base Diameter\n   protocol [BASE].\n   First, this document describes\
    \ the operation of a Diameter NAS\n   application.  Then it defines the Diameter\
    \ message Command-Codes.\n   The following sections list the AVPs used in these\
    \ messages, grouped\n   by common usage.  These are session identification, authentication,\n\
    \   authorization, tunneling, and accounting.  The authorization AVPs are\n  \
    \ further broken down by service type.  Interaction and backward\n   compatibility\
    \ issues with RADIUS are discussed in later sections.\n"
- title: 1.1.  Terminology
  contents:
  - "1.1.  Terminology\n   The base Diameter [BASE] specification section 1.4 defines\
    \ most of\n   the terminology used in this document.  Additionally, the following\n\
    \   terms and acronyms are used in this application:\n   NAS (Network Access Server)\
    \ - A device that provides an access\n   service for a user to a network.  The\
    \ service may be a network\n   connection or a value-added service such as terminal\
    \ emulation\n   [NASModel].\n   PPP (Point-to-Point Protocol) - A multiprotocol\
    \ serial datalink.  PPP\n   is the primary IP datalink used for dial-in NAS connection\
    \ service\n   [PPP].\n   CHAP (Challenge Handshake Authentication Protocol) -\
    \ An\n   authentication process used in PPP [PPPCHAP].\n   PAP (Password Authentication\
    \ Protocol) - A deprecated PPP\n   authentication process, but often used for\
    \ backward compatibility\n   [PAP].\n   SLIP (Serial Line Interface Protocol)\
    \ - A serial datalink that only\n   supports IP.  A design prior to PPP.\n   ARAP\
    \ (Appletalk Remote Access Protocol) - A serial datalink for\n   accessing Appletalk\
    \ networks [ARAP].\n   IPX (Internet Packet Exchange) - The network protocol used\
    \ by NetWare\n   networks [IPX].\n   LAT (Local Area Transport) - A Digital Equipment\
    \ Corp. LAN protocol\n   for terminal services [LAT].\n   VPN (Virtual Private\
    \ Network) - In this document, this term is used\n   to describe access services\
    \ that use tunneling methods.\n"
- title: 1.2.  Requirements Language
  contents:
  - "1.2.  Requirements Language\n   In this document, the key words \"MAY\", \"MUST\"\
    , \"MUST NOT\",\n   \"OPTIONAL\", \"RECOMMENDED\", \"SHOULD\", and \"SHOULD NOT\"\
    \ are to be\n   interpreted as described in [Keywords].\n"
- title: 1.3.  Advertising Application Support
  contents:
  - "1.3.  Advertising Application Support\n   Diameter applications conforming to\
    \ this specification MUST advertise\n   support by including the value of one\
    \ (1) in the Auth-Application-Id\n   of Capabilities-Exchange-Request (CER), AA-Request\
    \ (AAR), and AA-\n   Answer (AAA) messages.  All other messages are defined by\
    \ [BASE] and\n   use the Base application id value.\n"
- title: 2.  NAS Calls, Ports, and Sessions
  contents:
  - "2.  NAS Calls, Ports, and Sessions\n   The arrival of a new call or service connection\
    \ at a port of a\n   Network Access Server (NAS) starts a Diameter NAS message\
    \ exchange.\n   Information about the call, the identity of the user, and the\
    \ user's\n   authentication information are packaged into a Diameter AA-Request\n\
    \   (AAR) message and sent to a server.\n   The server processes the information\
    \ and responds with a Diameter\n   AA-Answer (AAA) message that contains authorization\
    \ information for\n   the NAS, or a failure code (Result-Code AVP).  A value of\n\
    \   DIAMETER_MULTI_ROUND_AUTH indicates an additional authentication\n   exchange,\
    \ and several AAR and AAA messages may be exchanged until the\n   transaction\
    \ completes.\n   Depending on the Auth-Request-Type AVP, the Diameter protocol\
    \ allows\n   authorization-only requests that contain no authentication\n   information\
    \ from the client.  This capability goes beyond the Call\n   Check capabilities\
    \ described in section 5.6 of [RADIUS] in that no\n   access decision is requested.\
    \  As a result, service cannot be started\n   as a result of a response to an\
    \ authorization-only request without\n   introducing a significant security vulnerability.\n\
    \   Since no equivalent capability exists in RADIUS, authorization-only\n   requests\
    \ from a NAS implementing Diameter may not be easily\n   translated to an equivalent\
    \ RADIUS message by a Diameter/RADIUS\n   gateway.  For example, when a Diameter\
    \ authorization-only request\n   cannot be translated to a RADIUS Call Check,\
    \ it would be necessary\n   for the Diameter/RADIUS gateway to add authentication\
    \ information to\n   the RADIUS Access Request.  On receiving the Access-Reply,\
    \ the\n   Diameter/RADIUS gateway would need to discard the access decision\n\
    \   (Accept/Reject).  It is not clear whether these translations can be\n   accomplished\
    \ without adding significant security vulnerabilities.\n"
- title: 2.1.  Diameter Session Establishment
  contents:
  - "2.1.  Diameter Session Establishment\n   When the authentication or authorization\
    \ exchange completes\n   successfully, the NAS application SHOULD start a session\
    \ context.  If\n   the Result-Code of DIAMETER_MULTI_ROUND_AUTH is returned, the\n\
    \   exchange continues until a success or error is returned.\n   If accounting\
    \ is active, the application MUST also send an Accounting\n   message [BASE].\
    \  An Accounting-Record-Type of START_RECORD is sent\n   for a new session.  If\
    \ a session fails to start, the EVENT_RECORD\n   message is sent with the reason\
    \ for the failure described.\n   Note that the return of an unsupportable Accounting-Realtime-Required\n\
    \   value [BASE] would result in a failure to establish the session.\n"
- title: 2.2.  Diameter Session Reauthentication or Reauthorization
  contents:
  - "2.2.  Diameter Session Reauthentication or Reauthorization\n   The Diameter Base\
    \ protocol allows users to be periodically\n   reauthenticated and/or reauthorized.\
    \  In such instances, the\n   Session-Id AVP in the AAR message MUST be the same\
    \ as the one present\n   in the original authentication/authorization message.\n\
    \   A Diameter server informs the NAS of the maximum time allowed before\n   reauthentication\
    \ or reauthorization via the Authorization-Lifetime\n   AVP [BASE].  A NAS MAY\
    \ reauthenticate and/or reauthorize before the\n   end, but A NAS MUST reauthenticate\
    \ and/or reauthorize at the end of\n   the period provided by the Authorization-Lifetime\
    \ AVP.  The failure\n   of a reauthentication exchange will terminate the service.\n\
    \   Furthermore, it is possible for Diameter servers to issue an\n   unsolicited\
    \ reauthentication and/or reauthorization request (e.g.,\n   Re-Auth-Request (RAR)\
    \ message [BASE]) to the NAS.  Upon receipt of\n   such a message, the NAS MUST\
    \ respond to the request with a Re-Auth-\n   Answer (RAA) message [BASE].\n  \
    \ If the RAR properly identifies an active session, the NAS will\n   initiate\
    \ a new local reauthentication or authorization sequence as\n   indicated by the\
    \ Re-Auth-Request-Type value.  This will cause the NAS\n   to send a new AAR message\
    \ using the existing Session-Id.  The server\n   will respond with an AAA message\
    \ to specify the new service\n   parameters.\n   If accounting is active, every\
    \ change of authentication or\n   authorization SHOULD generate an accounting\
    \ message.  If the NAS\n   service is a continuation of the prior user context,\
    \ then an\n   Accounting-Record-Type of INTERIM_RECORD indicating the new session\n\
    \   attributes and cumulative status would be appropriate.  If a new user\n  \
    \ or a significant change in authorization is detected by the NAS, then\n   the\
    \ service may send two messages of the types STOP_RECORD and\n   START_RECORD.\
    \  Accounting may change the subsession identifiers\n   (Acct-Session-ID, or Acct-Sub-Session-Id)\
    \ to indicate such sub-\n   sessions.  A service may also use a different Session-Id\
    \ value for\n   accounting (see [BASE] section 9.6).\n   However, the Diameter\
    \ Session-ID AVP value used for the initial\n   authorization exchange MUST be\
    \ used to generate an STR message when\n   the session context is terminated.\n"
- title: 2.3.  Diameter Session Termination
  contents:
  - "2.3.  Diameter Session Termination\n   When a NAS receives an indication that\
    \ a user's session is being\n   disconnected by the client (e.g., LCP Terminate\
    \ is received) or an\n   administrative command, the NAS MUST issue a Session-Termination-\n\
    \   Request (STR) [BASE] to its Diameter Server.  This will ensure that\n   any\
    \ resources maintained on the servers are freed appropriately.\n   Furthermore,\
    \ a NAS that receives an Abort-Session-Request (ASR)\n   [BASE] MUST issue an\
    \ ASA if the session identified is active and\n   disconnect the PPP (or tunneling)\
    \ session.\n   If accounting is active, an Accounting STOP_RECORD message [BASE]\n\
    \   MUST be sent upon termination of the session context.\n   More information\
    \ on Diameter Session Termination is included in\n   [BASE] sections 8.4 and 8.5.\n"
- title: 3.  NAS Messages
  contents:
  - "3.  NAS Messages\n   This section defines the Diameter message Command-Code [BASE]\
    \ values\n   that MUST be supported by all Diameter implementations conforming\
    \ to\n   this specification.  The Command Codes are as follows:\n      Command-Name\
    \                  Abbrev.  Code   Reference\n      -------------------------------------------------------\n\
    \      AA-Request                      AAR     265     3.1\n      AA-Answer  \
    \                     AAA     265     3.2\n      Re-Auth-Request             \
    \    RAR     258     3.3\n      Re-Auth-Answer                  RAA     258  \
    \   3.4\n      Session-Termination-Request     STR     275     3.5\n      Session-Termination-Answer\
    \      STA     275     3.6\n      Abort-Session-Request           ASR     274\
    \     3.7\n      Abort-Session-Answer            ASA     274     3.8\n      Accounting-Request\
    \              ACR     271     3.9\n      Accounting-Answer               ACA\
    \     271     3.10\n"
- title: 3.1.  AA-Request (AAR) Command
  contents:
  - "3.1.  AA-Request (AAR) Command\n   The AA-Request (AAR), which is indicated by\
    \ setting the Command-Code\n   field to 265 and the 'R' bit in the Command Flags\
    \ field, is used to\n   request authentication and/or authorization for a given\
    \ NAS user.\n   The type of request is identified through the Auth-Request-Type\
    \ AVP\n   [BASE].  The recommended value for most RADIUS interoperabily\n   situations\
    \ is AUTHORIZE_AUTHENTICATE.\n   If Authentication is requested, the User-Name\
    \ attribute SHOULD be\n   present, as well as any additional authentication AVPs\
    \ that would\n   carry the password information.  A request for authorization\
    \ SHOULD\n   only include the information from which the authorization will be\n\
    \   performed, such as the User-Name, Called-Station-Id, or Calling-\n   Station-Id\
    \ AVPs.  All requests SHOULD contain AVPs uniquely\n   identifying the source\
    \ of the call, such as Origin-Host and NAS-Port.\n   Certain networks MAY use\
    \ different AVPs for authorization purposes.\n   A request for authorization will\
    \ include some AVPs defined in section\n   6.\n   It is possible for a single\
    \ session to be authorized first and then\n   for an authentication request to\
    \ follow.\n   This AA-Request message MAY be the result of a multi-round\n   authentication\
    \ exchange, which occurs when the AA-Answer message is\n   received with the Result-Code\
    \ AVP set to DIAMETER_MULTI_ROUND_AUTH.\n   A subsequent AAR message SHOULD be\
    \ sent, with the User-Password AVP\n   that includes the user's response to the\
    \ prompt, and MUST include any\n   State AVPs that were present in the AAA message.\n\
    \   Message Format\n      <AA-Request> ::= < Diameter Header: 265, REQ, PXY >\n\
    \                       < Session-Id >\n                       { Auth-Application-Id\
    \ }\n                       { Origin-Host }\n                       { Origin-Realm\
    \ }\n                       { Destination-Realm }\n                       { Auth-Request-Type\
    \ }\n                       [ Destination-Host ]\n                       [ NAS-Identifier\
    \ ]\n                       [ NAS-IP-Address ]\n                       [ NAS-IPv6-Address\
    \ ]\n                       [ NAS-Port ]\n                       [ NAS-Port-Id\
    \ ]\n                       [ NAS-Port-Type ]\n                       [ Origin-AAA-Protocol\
    \ ]\n                       [ Origin-State-Id ]\n                       [ Port-Limit\
    \ ]\n                       [ User-Name ]\n                       [ User-Password\
    \ ]\n                       [ Service-Type ]\n                       [ State ]\n\
    \                       [ Authorization-Lifetime ]\n                       [ Auth-Grace-Period\
    \ ]\n                       [ Auth-Session-State ]\n                       [ Callback-Number\
    \ ]\n                       [ Called-Station-Id ]\n                       [ Calling-Station-Id\
    \ ]\n                       [ Originating-Line-Info ]\n                      \
    \ [ Connect-Info ]\n                       [ CHAP-Auth ]\n                   \
    \    [ CHAP-Challenge ]\n                     * [ Framed-Compression ]\n     \
    \                  [ Framed-Interface-Id ]\n                       [ Framed-IP-Address\
    \ ]\n                     * [ Framed-IPv6-Prefix ]\n                       [ Framed-IP-Netmask\
    \ ]\n                       [ Framed-MTU ]\n                       [ Framed-Protocol\
    \ ]\n                       [ ARAP-Password ]\n                       [ ARAP-Security\
    \ ]\n                     * [ ARAP-Security-Data ]\n                     * [ Login-IP-Host\
    \ ]\n                     * [ Login-IPv6-Host ]\n                       [ Login-LAT-Group\
    \ ]\n                       [ Login-LAT-Node ]\n                       [ Login-LAT-Port\
    \ ]\n                       [ Login-LAT-Service ]\n                     * [ Tunneling\
    \ ]\n                     * [ Proxy-Info ]\n                     * [ Route-Record\
    \ ]\n                     * [ AVP ]\n"
- title: 3.2.  AA-Answer (AAA) Command
  contents:
  - "3.2.  AA-Answer (AAA) Command\n   The AA-Answer (AAA) message is indicated by\
    \ setting the Command-Code\n   field to 265 and clearing the 'R' bit in the Command\
    \ Flags field.  It\n   is sent in response to the AA-Request (AAR) message.  If\n\
    \   authorization was requested, a successful response will include the\n   authorization\
    \ AVPs appropriate for the service being provided, as\n   defined in section 6.\n\
    \   For authentication exchanges requiring more than a single round trip,\n  \
    \ the server MUST set the Result-Code AVP to DIAMETER_MULTI_ROUND_AUTH.\n   An\
    \ AAA message with this result code MAY include one Reply-Message or\n   more\
    \ and MAY include zero or one State AVPs.\n   If the Reply-Message AVP was present,\
    \ the network access server\n   SHOULD send the text to the user's client to display\
    \ to the user,\n   instructing the client to prompt the user for a response. \
    \ For\n   example, this capability can be achieved in PPP via PAP.  If the\n \
    \  access client is unable to prompt the user for a new response, it\n   MUST\
    \ treat the AA-Answer (AAA) with the Reply-Message AVP as an error\n   and deny\
    \ access.\n   Message Format\n      <AA-Answer> ::= < Diameter Header: 265, PXY\
    \ >\n                      < Session-Id >\n                      { Auth-Application-Id\
    \ }\n                      { Auth-Request-Type }\n                      { Result-Code\
    \ }\n                      { Origin-Host }\n                      { Origin-Realm\
    \ }\n                      [ User-Name ]\n                      [ Service-Type\
    \ ]\n                    * [ Class ]\n                    * [ Configuration-Token\
    \ ]\n                      [ Acct-Interim-Interval ]\n                      [\
    \ Error-Message ]\n                      [ Error-Reporting-Host ]\n          \
    \          * [ Failed-AVP ]\n                      [ Idle-Timeout ]\n        \
    \              [ Authorization-Lifetime ]\n                      [ Auth-Grace-Period\
    \ ]\n                      [ Auth-Session-State ]\n                      [ Re-Auth-Request-Type\
    \ ]\n                      [ Multi-Round-Time-Out ]\n                      [ Session-Timeout\
    \ ]\n                      [ State ]\n                    * [ Reply-Message ]\n\
    \                      [ Origin-AAA-Protocol ]\n                      [ Origin-State-Id\
    \ ]\n                    * [ Filter-Id ]\n                      [ Password-Retry\
    \ ]\n                      [ Port-Limit ]\n                      [ Prompt ]\n\
    \                      [ ARAP-Challenge-Response ]\n                      [ ARAP-Features\
    \ ]\n                      [ ARAP-Security ]\n                    * [ ARAP-Security-Data\
    \ ]\n                      [ ARAP-Zone-Access ]\n                      [ Callback-Id\
    \ ]\n                      [ Callback-Number ]\n                      [ Framed-Appletalk-Link\
    \ ]\n                    * [ Framed-Appletalk-Network ]\n                    \
    \  [ Framed-Appletalk-Zone ]\n                    * [ Framed-Compression ]\n \
    \                     [ Framed-Interface-Id ]\n                      [ Framed-IP-Address\
    \ ]\n                    * [ Framed-IPv6-Prefix ]\n                      [ Framed-IPv6-Pool\
    \ ]\n                    * [ Framed-IPv6-Route ]\n                      [ Framed-IP-Netmask\
    \ ]\n                    * [ Framed-Route ]\n                      [ Framed-Pool\
    \ ]\n                      [ Framed-IPX-Network ]\n                      [ Framed-MTU\
    \ ]\n                      [ Framed-Protocol ]\n                      [ Framed-Routing\
    \ ]\n                    * [ Login-IP-Host ]\n                    * [ Login-IPv6-Host\
    \ ]\n                      [ Login-LAT-Group ]\n                      [ Login-LAT-Node\
    \ ]\n                      [ Login-LAT-Port ]\n                      [ Login-LAT-Service\
    \ ]\n                      [ Login-Service ]\n                      [ Login-TCP-Port\
    \ ]\n                    * [ NAS-Filter-Rule ]\n                    * [ QoS-Filter-Rule\
    \ ]\n                    * [ Tunneling ]\n                    * [ Redirect-Host\
    \ ]\n                      [ Redirect-Host-Usage ]\n                      [ Redirect-Max-Cache-Time\
    \ ]\n                    * [ Proxy-Info ]\n                    * [ AVP ]\n"
- title: 3.3.  Re-Auth-Request (RAR) Command
  contents:
  - "3.3.  Re-Auth-Request (RAR) Command\n   A Diameter server may initiate a re-authentication\
    \ and/or re-\n   authorization service for a particular session by issuing a Re-Auth-\n\
    \   Request (RAR) message [BASE].\n   For example, for pre-paid services, the\
    \ Diameter server that\n   originally authorized a session may need some confirmation\
    \ that the\n   user is still using the services.\n   If a NAS receives an RAR\
    \ message with Session-Id equal to a currently\n   active session and a Re-Auth-Type\
    \ that includes authentication, it\n   MUST initiate a re-authentication toward\
    \ the user, if the service\n   supports this particular feature.\n   Message Format\n\
    \      <RA-Request>  ::= < Diameter Header: 258, REQ, PXY >\n                \
    \       < Session-Id >\n                       { Origin-Host }\n             \
    \          { Origin-Realm }\n                       { Destination-Realm }\n  \
    \                     { Destination-Host }\n                       { Auth-Application-Id\
    \ }\n                       { Re-Auth-Request-Type }\n                       [\
    \ User-Name ]\n                       [ Origin-AAA-Protocol ]\n              \
    \         [ Origin-State-Id ]\n                       [ NAS-Identifier ]\n   \
    \                    [ NAS-IP-Address ]\n                       [ NAS-IPv6-Address\
    \ ]\n                       [ NAS-Port ]\n                       [ NAS-Port-Id\
    \ ]\n                       [ NAS-Port-Type ]\n                       [ Service-Type\
    \ ]\n                       [ Framed-IP-Address ]\n                       [ Framed-IPv6-Prefix\
    \ ]\n                       [ Framed-Interface-Id ]\n                       [\
    \ Called-Station-Id ]\n                       [ Calling-Station-Id ]\n       \
    \                [ Originating-Line-Info ]\n                       [ Acct-Session-Id\
    \ ]\n                       [ Acct-Multi-Session-Id ]\n                      \
    \ [ State ]\n                     * [ Class ]\n                       [ Reply-Message\
    \ ]\n                     * [ Proxy-Info ]\n                     * [ Route-Record\
    \ ]\n                     * [ AVP ]\n"
- title: 3.4.  Re-Auth-Answer (RAA) Command
  contents:
  - "3.4.  Re-Auth-Answer (RAA) Command\n   The Re-Auth-Answer (RAA) message [BASE]\
    \ is sent in response to the\n   RAR.  The Result-Code AVP MUST be present and\
    \ indicates the\n   disposition of the request.\n   A successful RAA transaction\
    \ MUST be followed by an AAR message.\n   Message Format\n      <RA-Answer>  ::=\
    \ < Diameter Header: 258, PXY >\n                       < Session-Id >\n     \
    \                  { Result-Code }\n                       { Origin-Host }\n \
    \                      { Origin-Realm }\n                       [ User-Name ]\n\
    \                       [ Origin-AAA-Protocol ]\n                       [ Origin-State-Id\
    \ ]\n                       [ Error-Message ]\n                       [ Error-Reporting-Host\
    \ ]\n                     * [ Failed-AVP ]\n                     * [ Redirected-Host\
    \ ]\n                       [ Redirected-Host-Usage ]\n                      \
    \ [ Redirected-Host-Cache-Time ]\n                       [ Service-Type ]\n  \
    \                   * [ Configuration-Token ]\n                       [ Idle-Timeout\
    \ ]\n                       [ Authorization-Lifetime ]\n                     \
    \  [ Auth-Grace-Period ]\n                       [ Re-Auth-Request-Type ]\n  \
    \                     [ State ]\n                     * [ Class ]\n          \
    \           * [ Reply-Message ]\n                       [ Prompt ]\n         \
    \            * [ Proxy-Info ]\n                     * [ AVP ]\n"
- title: 3.5.  Session-Termination-Request (STR) Command
  contents:
  - "3.5.  Session-Termination-Request (STR) Command\n   The Session-Termination-Request\
    \ (STR) message [BASE] is sent by the\n   NAS to inform the Diameter Server that\
    \ an authenticated and/or\n   authorized session is being terminated.\n   Message\
    \ Format\n      <ST-Request> ::= < Diameter Header: 275, REQ, PXY >\n        \
    \              < Session-Id >\n                      { Origin-Host }\n       \
    \               { Origin-Realm }\n                      { Destination-Realm }\n\
    \                      { Auth-Application-Id }\n                      { Termination-Cause\
    \ }\n                      [ User-Name ]\n                      [ Destination-Host\
    \ ]\n                    * [ Class ]\n                      [ Origin-AAA-Protocol\
    \ ]\n                      [ Origin-State-Id ]\n                    * [ Proxy-Info\
    \ ]\n                    * [ Route-Record ]\n                    * [ AVP ]\n"
- title: 3.6.  Session-Termination-Answer (STA) Command
  contents:
  - "3.6.  Session-Termination-Answer (STA) Command\n   The Session-Termination-Answer\
    \ (STA) message [BASE] is sent by the\n   Diameter Server to acknowledge the notification\
    \ that the session has\n   been terminated.  The Result-Code AVP MUST be present\
    \ and MAY contain\n   an indication that an error occurred while the STR was being\n\
    \   serviced.\n   Upon sending or receiving the STA, the Diameter Server MUST\
    \ release\n   all resources for the session indicated by the Session-Id AVP. \
    \ Any\n   intermediate server in the Proxy-Chain MAY also release any\n   resources,\
    \ if necessary.\n   Message Format\n      <ST-Answer>  ::= < Diameter Header:\
    \ 275, PXY >\n                       < Session-Id >\n                       {\
    \ Result-Code }\n                       { Origin-Host }\n                    \
    \   { Origin-Realm }\n                       [ User-Name ]\n                 \
    \    * [ Class ]\n                       [ Error-Message ]\n                 \
    \      [ Error-Reporting-Host ]\n                     * [ Failed-AVP ]\n     \
    \                  [ Origin-AAA-Protocol ]\n                       [ Origin-State-Id\
    \ ]\n                     * [ Redirect-Host ]\n                       [ Redirect-Host-Usase\
    \ ]\n                       [ Redirect-Max-Cache-Time ]\n                    \
    \ * [ Proxy-Info ]\n                     * [ AVP ]\n"
- title: 3.7.  Abort-Session-Request (ASR) Command
  contents:
  - "3.7.  Abort-Session-Request (ASR) Command\n   The Abort-Session-Request (ASR)\
    \ message [BASE] may be sent by any\n   server to the NAS providing session service,\
    \ to request that the\n   session identified by the Session-Id be stopped.\n \
    \  Message Format\n      <AS-Request>  ::= < Diameter Header: 274, REQ, PXY >\n\
    \                       < Session-Id >\n                       { Origin-Host }\n\
    \                       { Origin-Realm }\n                       { Destination-Realm\
    \ }\n                       { Destination-Host }\n                       { Auth-Application-Id\
    \ }\n                       [ User-Name ]\n                       [ Origin-AAA-Protocol\
    \ ]\n                       [ Origin-State-Id ]\n                       [ NAS-Identifier\
    \ ]\n                       [ NAS-IP-Address ]\n                       [ NAS-IPv6-Address\
    \ ]\n                       [ NAS-Port ]\n                       [ NAS-Port-Id\
    \ ]\n                       [ NAS-Port-Type ]\n                       [ Service-Type\
    \ ]\n                       [ Framed-IP-Address ]\n                       [ Framed-IPv6-Prefix\
    \ ]\n                       [ Framed-Interface-Id ]\n                       [\
    \ Called-Station-Id ]\n                       [ Calling-Station-Id ]\n       \
    \                [ Originating-Line-Info ]\n                       [ Acct-Session-Id\
    \ ]\n                       [ Acct-Multi-Session-Id ]\n                      \
    \ [ State ]\n                     * [ Class ]\n                     * [ Reply-Message\
    \ ]\n                     * [ Proxy-Info ]\n                     * [ Route-Record\
    \ ]\n                     * [ AVP ]\n"
- title: 3.8.  Abort-Session-Answer (ASA) Command
  contents:
  - "3.8.  Abort-Session-Answer (ASA) Command\n   The ASA message [BASE] is sent in\
    \ response to the ASR.  The Result-\n   Code AVP MUST be present and indicates\
    \ the disposition of the\n   request.\n   If the session identified by Session-Id\
    \ in the ASR was successfully\n   terminated, Result-Code is set to DIAMETER_SUCCESS.\
    \  If the session\n   is not currently active, Result-Code is set to\n   DIAMETER_UNKNOWN_SESSION_ID.\
    \  If the access device does not stop the\n   session for any other reason, Result-Code\
    \ is set to\n   DIAMETER_UNABLE_TO_COMPLY.\n   Message Format\n      <AS-Answer>\
    \  ::= < Diameter Header: 274, PXY >\n                       < Session-Id >\n\
    \                       { Result-Code }\n                       { Origin-Host\
    \ }\n                       { Origin-Realm }\n                       [ User-Name\
    \ ]\n                       [ Origin-AAA-Protocol ]\n                       [\
    \ Origin-State-Id ]\n                       [ State]\n                       [\
    \ Error-Message ]\n                       [ Error-Reporting-Host ]\n         \
    \            * [ Failed-AVP ]\n                     * [ Redirected-Host ]\n  \
    \                     [ Redirected-Host-Usage ]\n                       [ Redirected-Max-Cache-Time\
    \ ]\n                     * [ Proxy-Info ]\n                     * [ AVP ]\n"
- title: 3.9.  Accounting-Request (ACR) Command
  contents:
  - "3.9.  Accounting-Request (ACR) Command\n   The ACR message [BASE] is sent by\
    \ the NAS to report its session\n   information to a target server downstream.\n\
    \   Either of Acct-Application-Id or Vendor-Specific-Application-Id AVPs\n   MUST\
    \ be present.  If the Vendor-Specific-Application-Id grouped AVP\n   is present,\
    \ it must have an Acct-Application-Id inside.\n   The AVPs listed in the Base\
    \ MUST be assumed to be present, as\n   appropriate.  NAS service-specific accounting\
    \ AVPs SHOULD be present\n   as described in section 8 and the rest of this specification.\n\
    \   Message Format\n      <AC-Request> ::= < Diameter Header: 271, REQ, PXY >\n\
    \                      < Session-Id >\n                      { Origin-Host }\n\
    \                      { Origin-Realm }\n                      { Destination-Realm\
    \ }\n                      { Accounting-Record-Type }\n                      {\
    \ Accounting-Record-Number }\n                      [ Acct-Application-Id ]\n\
    \                      [ Vendor-Specific-Application-Id ]\n                  \
    \    [ User-Name ]\n                      [ Accounting-Sub-Session-Id ]\n    \
    \                  [ Acct-Session-Id ]\n                      [ Acct-Multi-Session-Id\
    \ ]\n                      [ Origin-AAA-Protocol ]\n                      [ Origin-State-Id\
    \ ]\n                      [ Destination-Host ]\n                      [ Event-Timestamp\
    \ ]\n                      [ Acct-Delay-Time ]\n                      [ NAS-Identifier\
    \ ]\n                      [ NAS-IP-Address ]\n                      [ NAS-IPv6-Address\
    \ ]\n                      [ NAS-Port ]\n                      [ NAS-Port-Id ]\n\
    \                      [ NAS-Port-Type ]\n                    * [ Class ]\n  \
    \                    [ Service-Type ]\n                      [ Termination-Cause\
    \ ]\n                      [ Accounting-Input-Octets ]\n                     \
    \ [ Accounting-Input-Packets ]\n                      [ Accounting-Output-Octets\
    \ ]\n                      [ Accounting-Output-Packets ]\n                   \
    \   [ Acct-Authentic ]\n                      [ Accounting-Auth-Method ]\n   \
    \                   [ Acct-Link-Count ]\n                      [ Acct-Session-Time\
    \ ]\n                      [ Acct-Tunnel-Connection ]\n                      [\
    \ Acct-Tunnel-Packets-Lost ]\n                      [ Callback-Id ]\n        \
    \              [ Callback-Number ]\n                      [ Called-Station-Id\
    \ ]\n                      [ Calling-Station-Id ]\n                    * [ Connection-Info\
    \ ]\n                      [ Originating-Line-Info ]\n                      [\
    \ Authorization-Lifetime ]\n                      [ Session-Timeout ]\n      \
    \                [ Idle-Timeout ]\n                      [ Port-Limit ]\n    \
    \                  [ Accounting-Realtime-Required ]\n                      [ Acct-Interim-Interval\
    \ ]\n                    * [ Filter-Id ]\n                    * [ NAS-Filter-Rule\
    \ ]\n                    * [ Qos-Filter-Rule ]\n                      [ Framed-AppleTalk-Link\
    \ ]\n                      [ Framed-AppleTalk-Network ]\n                    \
    \  [ Framed-AppleTalk-Zone ]\n                      [ Framed-Compression ]\n \
    \                     [ Framed-Interface-Id ]\n                      [ Framed-IP-Address\
    \ ]\n                      [ Framed-IP-Netmask ]\n                    * [ Framed-IPv6-Prefix\
    \ ]\n                      [ Framed-IPv6-Pool ]\n                    * [ Framed-IPv6-Route\
    \ ]\n                      [ Framed-IPX-Network ]\n                      [ Framed-MTU\
    \ ]\n                      [ Framed-Pool ]\n                      [ Framed-Protocol\
    \ ]\n                    * [ Framed-Route ]\n                      [ Framed-Routing\
    \ ]\n                    * [ Login-IP-Host ]\n                    * [ Login-IPv6-Host\
    \ ]\n                      [ Login-LAT-Group ]\n                      [ Login-LAT-Node\
    \ ]\n                      [ Login-LAT-Port ]\n                      [ Login-LAT-Service\
    \ ]\n                      [ Login-Service ]\n                      [ Login-TCP-Port\
    \ ]\n                    * [ Tunneling ]\n                    * [ Proxy-Info ]\n\
    \                    * [ Route-Record ]\n                    * [ AVP ]\n"
- title: 3.10.  Accounting-Answer (ACA) Command
  contents:
  - "3.10.  Accounting-Answer (ACA) Command\n   The ACA message [BASE] is used to\
    \ acknowledge an Accounting-Request\n   command.  The Accounting-Answer command\
    \ contains the same Session-Id\n   as the Request.  If the Accounting-Request\
    \ was protected by end-to-\n   end security, then the corresponding ACA message\
    \ MUST be protected as\n   well.\n   Only the target Diameter Server or home Diameter\
    \ Server SHOULD\n   respond with the Accounting-Answer command.\n   Either Acct-Application-Id\
    \ or Vendor-Specific-Application-Id AVPs\n   MUST be present, as it was in the\
    \ request.\n   The AVPs listed in the Base MUST be assumed to be present, as\n\
    \   appropriate.  NAS service-specific accounting AVPs SHOULD be present\n   as\
    \ described in section 8 and the rest of this specification.\n   Message Format\n\
    \      <AC-Answer> ::= < Diameter Header: 271, PXY >\n                      <\
    \ Session-Id >\n                      { Result-Code }\n                      {\
    \ Origin-Host }\n                      { Origin-Realm }\n                    \
    \  { Accounting-Record-Type }\n                      { Accounting-Record-Number\
    \ }\n                      [ Acct-Application-Id ]\n                      [ Vendor-Specific-Application-Id\
    \ ]\n                      [ User-Name ]\n                      [ Accounting-Sub-Session-Id\
    \ ]\n                      [ Acct-Session-Id ]\n                      [ Acct-Multi-Session-Id\
    \ ]\n                      [ Event-Timestamp ]\n                      [ Error-Message\
    \ ]\n                      [ Error-Reporting-Host ]\n                    * [ Failed-AVP\
    \ ]\n                      [ Origin-AAA-Protocol ]\n                      [ Origin-State-Id\
    \ ]\n                      [ NAS-Identifier ]\n                      [ NAS-IP-Address\
    \ ]\n                      [ NAS-IPv6-Address ]\n                      [ NAS-Port\
    \ ]\n                      [ NAS-Port-Id ]\n                      [ NAS-Port-Type\
    \ ]\n                      [ Service-Type ]\n                      [ Termination-Cause\
    \ ]\n                      [ Accounting-Realtime-Required ]\n                \
    \      [ Acct-Interim-Interval ]\n                    * [ Class ]\n          \
    \          * [ Proxy-Info ]\n                    * [ Route-Record ]\n        \
    \            * [ AVP ]\n"
- title: 4.  NAS Session AVPs
  contents:
  - "4.  NAS Session AVPs\n   Diameter reserves the AVP Codes 0 - 255 for RADIUS functions\
    \ that are\n   implemented in Diameter.\n   AVPs new to Diameter have code values\
    \ of 256 and greater.  A Diameter\n   message that includes one of these AVPs\
    \ may represent functions not\n   present in the RADIUS environment and may cause\
    \ interoperability\n   issues, should the request traverse an AAA system that\
    \ only supports\n   the RADIUS protocol.\n   Some RADIUS attributes are not allowed\
    \ or supported directly in\n   Diameter.  See section 9 for more information.\n"
- title: 4.1.  Call and Session Information
  contents:
  - "4.1.  Call and Session Information\n   This section contains the AVPs specific\
    \ to NAS Diameter applications\n   that are needed to identify the call and session\
    \ context and status\n   information.  On a request, this information allows the\
    \ server to\n   qualify the session.\n   These AVPs are used in addition to the\
    \ Base AVPs of:\n      Session-Id\n      Auth-Application-Id\n      Origin-Host\n\
    \      Origin-Realm\n      Auth-Request-Type\n      Termination-Cause\n   The\
    \ following table describes the session level AVPs; their AVP Code\n   values,\
    \ types, and possible flag values; and whether the AVP MAY be\n   encrypted.\n\
    \                                            +---------------------+\n       \
    \                                     |    AVP Flag rules   |\n              \
    \                              |----+-----+----+-----|----+\n                \
    \   AVP  Section             |    |     |SHLD| MUST|    |\n   Attribute Name \
    \ Code Defined  Value Type |MUST| MAY | NOT|  NOT|Encr|\n   -----------------------------------------|----+-----+----+-----|----|\n\
    \   NAS-Port           5   4.2    Unsigned32 | M  |  P  |    |  V  | Y  |\n  \
    \ NAS-Port-Id       87   4.3    UTF8String | M  |  P  |    |  V  | Y  |\n   NAS-Port-Type\
    \     61   4.4    Enumerated | M  |  P  |    |  V  | Y  |\n   Called-Station-Id\
    \ 30   4.5    UTF8String | M  |  P  |    |  V  | Y  |\n   Calling-Station-  31\
    \   4.6    UTF8String | M  |  P  |    |  V  | Y  |\n     Id                  \
    \                   |    |     |    |     |    |\n   Connect-Info      77   4.7\
    \    UTF8String | M  |  P  |    |  V  | Y  |\n   Originating-Line- 94   4.8  \
    \  OctetString|    | M,P |    |  V  | Y  |\n     Info                        \
    \           |    |     |    |     |    |\n   Reply-Message     18   4.9    UTF8String\
    \ | M  |  P  |    |  V  | Y  |\n   -----------------------------------------|----+-----+----+-----|----|\n"
- title: 4.2.  NAS-Port AVP
  contents:
  - "4.2.  NAS-Port AVP\n   The NAS-Port AVP (AVP Code 5) is of type Unsigned32 and\
    \ contains the\n   physical or virtual port number of the NAS which is authenticating\n\
    \   the user.  Note that \"port\" is meant in its sense as a service\n   connection\
    \ on the NAS, not as an IP protocol identifier.\n   Either NAS-Port or NAS-Port-Id\
    \ (AVP Code 87) SHOULD be present in\n   AA-Request (AAR) commands if the NAS\
    \ differentiates among its ports.\n"
- title: 4.3.  NAS-Port-Id AVP
  contents:
  - "4.3.  NAS-Port-Id AVP\n   The NAS-Port-Id AVP (AVP Code 87) is of type UTF8String\
    \ and consists\n   of ASCII text identifying the port of the NAS authenticating\
    \ the\n   user.  Note that \"port\" is meant in its sense as a service connection\n\
    \   on the NAS, not as an IP protocol identifier.\n   Either NAS-Port or NAS-Port-Id\
    \ SHOULD be present in AA-Request (AAR)\n   commands if the NAS differentiates\
    \ among its ports.  NAS-Port-Id is\n   intended for use by NASes that cannot conveniently\
    \ number their\n   ports.\n"
- title: 4.4.  NAS-Port-Type AVP
  contents:
  - "4.4.  NAS-Port-Type AVP\n   The NAS-Port-Type AVP (AVP Code 61) is of type Enumerated\
    \ and\n   contains the type of the port on which the NAS is authenticating the\n\
    \   user.  This AVP SHOULD be present if the NAS uses the same NAS-Port\n   number\
    \ ranges for different service types concurrently.\n   The supported values are\
    \ defined in [RADIUSTypes].  The following\n   list is informational and subject\
    \ to change by the IANA.\n       0   Async\n       1   Sync\n       2   ISDN Sync\n\
    \       3   ISDN Async V.120\n       4   ISDN Async V.110\n       5   Virtual\n\
    \       6   PIAFS\n       7   HDLC Clear Channel\n       8   X.25\n       9  \
    \ X.75\n      10   G.3 Fax\n      11   SDSL - Symmetric DSL\n      12   ADSL-CAP\
    \ - Asymmetric DSL, Carrierless Amplitude Phase\n              Modulation\n  \
    \    13   ADSL-DMT - Asymmetric DSL, Discrete Multi-Tone\n      14   IDSL - ISDN\
    \ Digital Subscriber Line\n      15   Ethernet\n      16   xDSL - Digital Subscriber\
    \ Line of unknown type\n      17   Cable\n      18   Wireless - Other\n      19\
    \   Wireless - IEEE 802.11\n      20   Token-Ring   [RAD802.1X]\n      21   FDDI\
    \         [RAD802.1X]\n      22   Wireless - CDMA2000\n      23   Wireless - UMTS\n\
    \      24   Wireless - 1X-EV\n      25   IAPP    [IEEE 802.11f]\n"
- title: 4.5.  Called-Station-Id AVP
  contents:
  - "4.5.  Called-Station-Id AVP\n   The Called-Station-Id AVP (AVP Code 30) is of\
    \ type UTF8String and\n   allows the NAS to send the ASCII string describing the\
    \ layer 2\n   address the user contacted in the request.  For dialup access, this\n\
    \   can be a phone number obtained by using Dialed Number Identification\n   (DNIS)\
    \ or a similar technology.  Note that this may be different from\n   the phone\
    \ number the call comes in on.  For use with IEEE 802 access,\n   the Called-Station-Id\
    \ MAY contain a MAC address formatted as\n   described in [RAD802.1X].  It SHOULD\
    \ only be present in\n   authentication and/or authorization requests.\n   If\
    \ the Auth-Request-Type AVP is set to authorization-only and the\n   User-Name\
    \ AVP is absent, the Diameter Server MAY perform\n   authorization based on this\
    \ field.  This can be used by a NAS to\n   request whether a call should be answered\
    \ based on the DNIS.\n   The codification of this field's allowed usage range\
    \ is outside the\n   scope of this specification.\n"
- title: 4.6.  Calling-Station-Id AVP
  contents:
  - "4.6.  Calling-Station-Id AVP\n   The Calling-Station-Id AVP (AVP Code 31) is\
    \ of type UTF8String and\n   allows the NAS to send the ASCII string describing\
    \ the layer 2\n   address from which the user connected in the request.  For dialup\n\
    \   access, this is the phone number the call came from, using Automatic\n   Number\
    \ Identification (ANI) or a similar technology.  For use with\n   IEEE 802 access,\
    \ the Calling-Station-Id AVP MAY contain a MAC\n   address, formated as described\
    \ in [RAD802.1X].  It SHOULD only be\n   present in authentication and/or authorization\
    \ requests.\n   If the Auth-Request-Type AVP is set to authorization-only and\
    \ the\n   User-Name AVP is absent, the Diameter Server MAY perform\n   authorization\
    \ based on this field.  This can be used by a NAS to\n   request whether a call\
    \ should be answered based on the layer 2\n   address (ANI, MAC Address, etc.)\n\
    \   The codification of this field's allowed usage range is outside the\n   scope\
    \ of this specification.\n"
- title: 4.7.  Connect-Info AVP
  contents:
  - "4.7.  Connect-Info AVP\n   The Connect-Info AVP (AVP Code 77) is of type UTF8String\
    \ and is sent\n   in the AA-Request message or ACR STOP message.  When sent in\
    \ the\n   Access-Request, it indicates the nature of the user's connection.\n\
    \   The connection speed SHOULD be included at the beginning of the first\n  \
    \ Connect-Info AVP in the message.  If the transmit and receive\n   connection\
    \ speeds differ, both may be included in the first AVP with\n   the transmit speed\
    \ listed first (the speed the NAS modem transmits\n   at), then a slash (/), then\
    \ the receive speed, and then other\n   optional information.\n   For example:\
    \ \"28800 V42BIS/LAPM\" or \"52000/31200 V90\"\n   More than one Connect-Info\
    \ attribute may be present in an\n   Accounting-Request packet to accommodate\
    \ expected efforts by the ITU\n   to have modems report more connection information\
    \ in a standard\n   format that might exceed 252 octets.\n   If sent in the ACR\
    \ STOP, this attribute may summarize statistics\n   relating to session quality.\
    \  For example, in IEEE 802.11, the\n   Connect-Info attribute may contain information\
    \ on the number of link\n   layer retransmissions.  The exact format of this attribute\
    \ is\n   implementation specific.\n"
- title: 4.8.  Originating-Line-Info AVP
  contents:
  - "4.8.  Originating-Line-Info AVP\n   The Originating-Line-Info AVP (AVP Code 94)\
    \ is of type OctetString\n   and is sent by the NAS system to convey information\
    \ about the origin\n   of the call from an SS7 system.\n   The originating line\
    \ information (OLI) element indicates the nature\n   and/or characteristics of\
    \ the line from which a call originated\n   (e.g., pay phone, hotel, cellular).\
    \  Telephone companies are starting\n   to offer OLI to their customers as an\
    \ option over Primary Rate\n   Interface (PRI).  Internet Service Providers (ISPs)\
    \ can use OLI in\n   addition to Called-Station-Id and Calling-Station-Id attributes\
    \ to\n   differentiate customer calls and to define different services.\n   The\
    \ Value field contains two octets (00 - 99).  ANSI T1.113 and\n   BELLCORE 394\
    \ can be used for additional information about these\n   values and their use.\
    \  For more information on current assignment\n   values, see [ANITypes].\n  \
    \  Value   Description\n   ------------------------------------------------------------\n\
    \      00    Plain Old Telephone Service (POTS)\n      01    Multiparty Line (more\
    \ than 2)\n      02    ANI Failure\n      03    ANI Observed\n      04    ONI\
    \ Observed\n      05    ANI Failure Observed\n      06    Station Level Rating\n\
    \      07    Special Operator Handling Required\n      08    InterLATA Restricted\n\
    \      10    Test Call\n      20    Automatic Identified Outward Dialing (AIOD)\n\
    \      23    Coin or Non-Coin\n      24    Toll Free Service (Non-Pay Origination)\n\
    \      25    Toll Free Service (Pay Origination)\n      27    Toll Free Service\
    \ (Coin Control Origination)\n      29    Prison/Inmate Service\n      30-32 Intercept\n\
    \      30    Intercept (Blank)\n      31    Intercept (Trouble)\n      32    Intercept\
    \ (Regular)\n      34    Telco Operator Handled Call\n      40-49 Unrestricted\
    \ Use\n      52    Outward Wide Area Telecommunications Service (OUTWATS)\n  \
    \    60    Telecommunications Relay Service (TRS)(Unrestricted)\n      61    Cellular/Wireless\
    \ PCS (Type 1)\n      62    Cellular/Wireless PCS (Type 2)\n      63    Cellular/Wireless\
    \ PCS (Roaming)\n      66    TRS (Hotel)\n      67    TRS (Restricted)\n     \
    \ 70    Pay Station, No Coin Control\n      93    Access for Private Virtual Network\
    \ Service\n"
- title: 4.9.  Reply-Message AVP
  contents:
  - "4.9.  Reply-Message AVP\n   The Reply-Message AVP (AVP Code 18) is of type UTF8String\
    \ and\n   contains text that MAY be displayed to the user.  When used in an\n\
    \   AA-Answer message with a successful Result-Code AVP, it indicates\n   success.\
    \  When found in an AAA message with a Result-Code other than\n   DIAMETER_SUCCESS,\
    \ the AVP contains a failure message.\n   The Reply-Message AVP MAY indicate dialog\
    \ text to prompt the user\n   before another AA-Request attempt.  When used in\
    \ an AA-Answer with a\n   Result-Code of DIAMETER_MULTI_ROUND_AUTH or in an Re-Auth-Request\n\
    \   message, it MAY contain a dialog text to prompt the user for a\n   response.\n\
    \   Multiple Reply-Messages MAY be included, and if any are displayed,\n   they\
    \ MUST be displayed in the same order as they appear in the\n   Diameter message.\n"
- title: 5.  NAS Authentication AVPs
  contents:
  - "5.  NAS Authentication AVPs\n   This section defines the AVPs necessary to carry\
    \ the authentication\n   information in the Diameter protocol.  The functionality\
    \ defined here\n   provides a RADIUS-like AAA service over a more reliable and\
    \ secure\n   transport, as defined in the base protocol [BASE].\n   The following\
    \ table describes the AVPs; their AVP Code values, types,\n   and possible flag\
    \ values, and whether the AVP MAY be encrypted.\n                            \
    \                +---------------------+\n                                   \
    \         |    AVP Flag rules   |\n                                          \
    \  |----+-----+----+-----|----+\n                   AVP  Section             |\
    \    |     |SHLD| MUST|    |\n   Attribute Name  Code Defined  Value Type |MUST|\
    \ MAY | NOT|  NOT|Encr|\n   -----------------------------------------|----+-----+----+-----|----|\n\
    \   User-Password      2   5.1    OctetString| M  |  P  |    |  V  | Y  |\n  \
    \ Password-Retry    75   5.2    Unsigned32 | M  |  P  |    |  V  | Y  |\n   Prompt\
    \            76   5.3    Enumerated | M  |  P  |    |  V  | Y  |\n   CHAP-Auth\
    \        402   5.4    Grouped    | M  |  P  |    |  V  | Y  |\n   CHAP-Algorithm\
    \   403   5.5    Enumerated | M  |  P  |    |  V  | Y  |\n   CHAP-Ident      \
    \ 404   5.6    OctetString| M  |  P  |    |  V  | Y  |\n   CHAP-Response    405\
    \   5.7    OctetString| M  |  P  |    |  V  | Y  |\n   CHAP-Challenge    60  \
    \ 5.8    OctetString| M  |  P  |    |  V  | Y  |\n   ARAP-Password     70   5.9\
    \    OctetString| M  |  P  |    |  V  | Y  |\n   ARAP-Challenge-   84   5.10 \
    \  OctetString| M  |  P  |    |  V  | Y  |\n     Response                    \
    \           |    |     |    |     |    |\n   ARAP-Security     73   5.11   Unsigned32\
    \ | M  |  P  |    |  V  | Y  |\n   ARAP-Security-    74   5.12   OctetString|\
    \ M  |  P  |    |  V  | Y  |\n     Data                                   |  \
    \  |     |    |     |    |\n   -----------------------------------------|----+-----+----+-----|----|\n"
- title: 5.1.  User-Password AVP
  contents:
  - "5.1.  User-Password AVP\n   The User-Password AVP (AVP Code 2) is of type OctetString\
    \ and\n   contains the password of the user to be authenticated, or the user's\n\
    \   input in a multi-round authentication exchange.\n   The User-Password AVP\
    \ contains a user password or one-time password\n   and therefore represents sensitive\
    \ information.  As required in\n   [BASE], Diameter messages are encrypted by\
    \ using IPsec or TLS.\n   Unless this AVP is used for one-time passwords, the\
    \ User-Password AVP\n   SHOULD NOT be used in untrusted proxy environments without\
    \ encrypting\n   it by using end-to-end security techniques, such as the proposed\
    \ CMS\n   Security [DiamCMS].\n   The clear-text password (prior to encryption)\
    \ MUST NOT be longer than\n   128 bytes in length.\n"
- title: 5.2.  Password-Retry AVP
  contents:
  - "5.2.  Password-Retry AVP\n   The Password-Retry AVP (AVP Code 75) is of type\
    \ Unsigned32 and MAY be\n   included in the AA-Answer if the Result-Code indicates\
    \ an\n   authentication failure.  The value of this AVP indicates how many\n \
    \  authentication attempts a user is permitted before being\n   disconnected.\
    \  This AVP is primarily intended for use when the\n   Framed-Protocol AVP (see\
    \ section 6.10.1) is set to ARAP.\n"
- title: 5.3.  Prompt AVP
  contents:
  - "5.3.  Prompt AVP\n   The Prompt AVP (AVP Code 76) is of type Enumerated and MAY\
    \ be present\n   in the AA-Answer message.  When present, it is used by the NAS\
    \ to\n   determine whether the user's response, when entered, should be\n   echoed.\n\
    \   The supported values are listed in [RADIUSTypes].  The following list\n  \
    \ is informational:\n      0  No Echo\n      1  Echo\n"
- title: 5.4.  CHAP-Auth AVP
  contents:
  - "5.4.  CHAP-Auth AVP\n   The CHAP-Auth AVP (AVP Code 402) is of type Grouped and\
    \ contains the\n   information necessary to authenticate a user using the PPP\n\
    \   Challenge-Handshake Authentication Protocol (CHAP) [PPPCHAP].  If the\n  \
    \ CHAP-Auth AVP is found in a message, the CHAP-Challenge AVP MUST be\n   present\
    \ as well.  The optional AVPs containing the CHAP response\n   depend upon the\
    \ value of the CHAP-Algorithm AVP.  The grouped AVP has\n   the following ABNF\
    \ grammar:\n      CHAP-Auth  ::= < AVP Header: 402 >\n                     { CHAP-Algorithm\
    \ }\n                     { CHAP-Ident }\n                     [ CHAP-Response\
    \ ]\n                   * [ AVP ]\n"
- title: 5.5.  CHAP-Algorithm AVP
  contents:
  - "5.5.  CHAP-Algorithm AVP\n   The CHAP-Algorithm AVP (AVP Code 403) is of type\
    \ Enumerated and\n   contains the algorithm identifier used in the computation\
    \ of the CHAP\n   response [PPPCHAP].  The following values are currently supported:\n\
    \      CHAP with MD5       5\n         The CHAP response is computed by using\
    \ the procedure described\n         in [PPPCHAP].  This algorithm requires that\
    \ the CHAP-Response\n         AVP MUST be present in the CHAP-Auth AVP.\n"
- title: 5.6.  CHAP-Ident AVP
  contents:
  - "5.6.  CHAP-Ident AVP\n   The CHAP-Ident AVP (AVP Code 404) is of type OctetString\
    \ and contains\n   the 1 octet CHAP Identifier used in the computation of the\
    \ CHAP\n   response [PPPCHAP].\n"
- title: 5.7.  CHAP-Response AVP
  contents:
  - "5.7.  CHAP-Response AVP\n   The CHAP-Response AVP (AVP Code 405) is of type OctetString\
    \ and\n   contains the 16 octet authentication data provided by the user in\n\
    \   response to the CHAP challenge [PPPCHAP].\n"
- title: 5.8.  CHAP-Challenge AVP
  contents:
  - "5.8.  CHAP-Challenge AVP\n   The CHAP-Challenge AVP (AVP Code 60) is of type\
    \ OctetString and\n   contains the CHAP Challenge sent by the NAS to the CHAP\
    \ peer\n   [PPPCHAP].\n"
- title: 5.9.  ARAP-Password AVP
  contents:
  - "5.9.  ARAP-Password AVP\n   The ARAP-Password AVP (AVP Code 70) is of type OctetString\
    \ and is\n   only present when the Framed-Protocol AVP (see section 6.10.1) is\n\
    \   included in the message and is set to ARAP.  This AVP MUST NOT be\n   present\
    \ if either the User-Password or the CHAP-Auth AVP is present.\n   See [RADIUSExt]\
    \ for more information on the contents of this AVP.\n"
- title: 5.10.  ARAP-Challenge-Response AVP
  contents:
  - "5.10.  ARAP-Challenge-Response AVP\n   The ARAP-Challenge-Response AVP (AVP Code\
    \ 84) is of type OctetString\n   and is only present when the Framed-Protocol\
    \ AVP (see section 6.10.1)\n   is included in the message and is set to ARAP.\
    \  This AVP contains an\n   8 octet response to the dial-in client's challenge.\
    \  The RADIUS\n   server calculates this value by taking the dial-in client's\
    \ challenge\n   from the high-order 8 octets of the ARAP-Password AVP and performing\n\
    \   DES encryption on this value with the authenticating user's password\n   as\
    \ the key.  If the user's password is fewer than 8 octets in length,\n   the password\
    \ is padded at the end with NULL octets to a length of 8\n   before it is used\
    \ as a key.\n"
- title: 5.11.  ARAP-Security AVP
  contents:
  - "5.11.  ARAP-Security AVP\n   The ARAP-Security AVP (AVP Code 73) is of type Unsigned32\
    \ and MAY be\n   present in the AA-Answer message if the Framed-Protocol AVP (see\n\
    \   section 6.10.1) is set to the value of ARAP, and the Result-Code AVP\n   is\
    \ set to DIAMETER_MULTI_ROUND_AUTH.  See [RADIUSExt] for more\n   information\
    \ on the format of this AVP.\n"
- title: 5.12.  ARAP-Security-Data AVP
  contents:
  - "5.12.  ARAP-Security-Data AVP\n   The ARAP-Security AVP (AVP Code 74) is of type\
    \ OctetString and MAY be\n   present in the AA-Request or AA-Answer message if\
    \ the Framed-Protocol\n   AVP is set to the value of ARAP, and the Result-Code\
    \ AVP is set to\n   DIAMETER_MULTI_ROUND_AUTH.  This AVP contains the security\
    \ module\n   challenge or response associated with the ARAP Security Module\n\
    \   specified in ARAP-Security.\n"
- title: 6.  NAS Authorization AVPs
  contents:
  - "6.  NAS Authorization AVPs\n   This section contains the authorization AVPs supported\
    \ in the NAS\n   Application.  The Service-Type AVP SHOULD be present in all messages,\n\
    \   and, based on its value, additional AVPs defined in this section and\n   in\
    \ section 7 MAY be present.\n   Due to space constraints, the short-form IPFltrRule\
    \ is used to\n   represent IPFilterRule, and QoSFltrRule is used for QoSFilterRule.\n\
    \                                            +---------------------+\n       \
    \                                     |    AVP Flag rules   |\n              \
    \                              |----+-----+----+-----|----+\n                \
    \   AVP  Section             |    |     |SHLD| MUST|    |\n   Attribute Name \
    \ Code Defined  Value Type |MUST| MAY | NOT|  NOT|Encr|\n   -----------------------------------------|----+-----+----+-----|----|\n\
    \   Service-Type       6   6.1    Enumerated | M  |  P  |    |  V  | Y  |\n  \
    \ Callback-Number   19   6.2    UTF8String | M  |  P  |    |  V  | Y  |\n   Callback-Id\
    \       20   6.3    UTF8String | M  |  P  |    |  V  | Y  |\n   Idle-Timeout \
    \     28   6.4    Unsigned32 | M  |  P  |    |  V  | Y  |\n   Port-Limit     \
    \   62   6.5    Unsigned32 | M  |  P  |    |  V  | Y  |\n   NAS-Filter-Rule  400\
    \   6.6    IPFltrRule | M  |  P  |    |  V  | Y  |\n   Filter-Id         11  \
    \ 6.7    UTF8String | M  |  P  |    |  V  | Y  |\n   Configuration-    78   6.8\
    \    OctetString| M  |     |    | P,V |    |\n     Token                     \
    \             |    |     |    |     |    |\n   QoS-Filter-Rule  407   6.9    QoSFltrRule|\
    \    |     |    |     |    |\n   Framed-Protocol    7  6.10.1  Enumerated | M\
    \  |  P  |    |  V  | Y  |\n   Framed-Routing    10  6.10.2  Enumerated | M  |\
    \  P  |    |  V  | Y  |\n   Framed-MTU        12  6.10.3  Unsigned32 | M  |  P\
    \  |    |  V  | Y  |\n   Framed-           13  6.10.4  Enumerated | M  |  P  |\
    \    |  V  | Y  |\n     Compression                            |    |     |  \
    \  |     |    |\n   Framed-IP-Address  8  6.11.1  OctetString| M  |  P  |    |\
    \  V  | Y  |\n   Framed-IP-Netmask  9  6.11.2  OctetString| M  |  P  |    |  V\
    \  | Y  |\n   Framed-Route      22  6.11.3  UTF8String | M  |  P  |    |  V  |\
    \ Y  |\n   Framed-Pool       88  6.11.4  OctetString| M  |  P  |    |  V  | Y\
    \  |\n   Framed-           96  6.11.5  Unsigned64 | M  |  P  |    |  V  | Y  |\n\
    \     Interface-Id                           |    |     |    |     |    |\n  \
    \ Framed-IPv6-      97  6.11.6  OctetString| M  |  P  |    |  V  | Y  |\n    \
    \ Prefix                                 |    |     |    |     |    |\n   Framed-IPv6-\
    \      99  6.11.7  UTF8String | M  |  P  |    |  V  | Y  |\n     Route       \
    \                           |    |     |    |     |    |\n   Framed-IPv6-Pool\
    \ 100  6.11.8  OctetString| M  |  P  |    |  V  | Y  |\n   Framed-IPX-       23\
    \  6.12.1  UTF8String | M  |  P  |    |  V  | Y  |\n     Network             \
    \                   |    |     |    |     |    |\n   Framed-Appletalk- 37  6.13.1\
    \  Unsigned32 | M  |  P  |    |  V  | Y  |\n     Link                        \
    \           |    |     |    |     |    |\n   Framed-Appletalk- 38  6.13.2  Unsigned32\
    \ | M  |  P  |    |  V  | Y  |\n     Network                                |\
    \    |     |    |     |    |\n   Framed-Appletalk- 39  6.13.3  OctetString| M\
    \  |  P  |    |  V  | Y  |\n     Zone                                   |    |\
    \     |    |     |    |\n   ARAP-Features     71  6.14.1  OctetString| M  |  P\
    \  |    |  V  | Y  |\n   ARAP-Zone-Access  72  6.14.2  Enumerated | M  |  P  |\
    \    |  V  | Y  |\n   Login-IP-Host     14  6.15.1  OctetString| M  |  P  |  \
    \  |  V  | Y  |\n   Login-IPv6-Host   98  6.15.2  OctetString| M  |  P  |    |\
    \  V  | Y  |\n   Login-Service     15  6.15.3  Enumerated | M  |  P  |    |  V\
    \  | Y  |\n   Login-TCP-Port    16  6.16.1  Unsigned32 | M  |  P  |    |  V  |\
    \ Y  |\n   Login-LAT-Service 34  6.17.1  OctetString| M  |  P  |    |  V  | Y\
    \  |\n   Login-LAT-Node    35  6.17.2  OctetString| M  |  P  |    |  V  | Y  |\n\
    \   Login-LAT-Group   36  6.17.3  OctetString| M  |  P  |    |  V  | Y  |\n  \
    \ Login-LAT-Port    63  6.17.4  OctetString| M  |  P  |    |  V  | Y  |\n   -----------------------------------------|----+-----+----+-----|----|\n"
- title: 6.1.  Service-Type AVP
  contents:
  - "6.1.  Service-Type AVP\n   The Service-Type AVP (AVP Code 6) is of type Enumerated\
    \ and contains\n   the type of service the user has requested or the type of service\
    \ to\n   be provided.  One such AVP MAY be present in an authentication and/or\n\
    \   authorization request or response.  A NAS is not required to\n   implement\
    \ all of these service types.  It MUST treat unknown or\n   unsupported Service-Types\
    \ received in a response as a failure and end\n   the session with a DIAMETER_INVALID_AVP_VALUE\
    \ Result-Code.\n   When used in a request, the Service-Type AVP SHOULD be considered\
    \ a\n   hint to the server that the NAS believes the user would prefer the\n \
    \  kind of service indicated.  The server is not required to honor the\n   hint.\
    \  Furthermore, if the service specified by the server is\n   supported, but not\
    \ compatible with the current mode of access, the\n   NAS MUST fail to start the\
    \ session.  The NAS MUST also generate the\n   appropriate error message(s).\n\
    \   The following values have been defined for the Service-Type AVP.  The\n  \
    \ complete list of defined values can be found in [RADIUS] and\n   [RADIUSTypes].\
    \  The following list is informational:\n       1  Login\n       2  Framed\n \
    \      3  Callback Login\n       4  Callback Framed\n       5  Outbound\n    \
    \   6  Administrative\n       7  NAS Prompt\n       8  Authenticate Only\n   \
    \    9  Callback NAS Prompt\n      10  Call Check\n      11  Callback Administrative\n\
    \      12  Voice\n      13  Fax\n      14  Modem Relay\n      15  IAPP-Register\
    \   [IEEE 802.11f]\n      16  IAPP-AP-Check   [IEEE 802.11f]\n      17  Authorize\
    \ Only  [RADDynAuth]\n   The following values are further qualified:\n      Login\
    \               1\n         The user should be connected to a host.  The message\
    \ MAY\n         include additional AVPs defined in sections 6.16 or 6.17.\n  \
    \    Framed              2\n         A Framed Protocol, such as PPP or SLIP, should\
    \ be started for\n         the User.  The message MAY include additional AVPs\
    \ defined in\n         section 6.10, or section 7 for tunneling services.\n  \
    \    Callback Login      3\n         The user should be disconnected and called\
    \ back, then connected\n         to a host.  The message MAY include additional\
    \ AVPs defined in\n         this section.\n      Callback Framed     4\n     \
    \    The user should be disconnected and called back, and then a\n         Framed\
    \ Protocol, such as PPP or SLIP, should be started for the\n         User.  The\
    \ message MAY include additional AVPs defined in\n         section 6.10, or in\
    \ section 7 for tunneling services.\n"
- title: 6.2.  Callback-Number AVP
  contents:
  - "6.2.  Callback-Number AVP\n   The Callback-Number AVP (AVP Code 19) is of type\
    \ UTF8String and\n   contains a dialing string to be used for callback.  It MAY\
    \ be used in\n   an authentication and/or authorization request as a hint to the\n\
    \   server that a Callback service is desired, but the server is not\n   required\
    \ to honor the hint in the corresponding response.\n   The codification of this\
    \ field's allowed usage range is outside the\n   scope of this specification.\n"
- title: 6.3.  Callback-Id AVP
  contents:
  - "6.3.  Callback-Id AVP\n   The Callback-Id AVP (AVP Code 20) is of type UTF8String\
    \ and contains\n   the name of a place to be called, to be interpreted by the\
    \ NAS.  This\n   AVP MAY be present in an authentication and/or authorization\n\
    \   response.\n   This AVP is not roaming-friendly as it assumes that the Callback-Id\n\
    \   is configured on the NAS.  Using the Callback-Number AVP therefore\n   preferable.\n"
- title: 6.4.  Idle-Timeout AVP
  contents:
  - "6.4.  Idle-Timeout AVP\n   The Idle-Timeout AVP (AVP Code 28) is of type Unsigned32\
    \ and sets the\n   maximum number of consecutive seconds of idle connection allowable\
    \ to\n   the user before termination of the session or before a prompt is\n  \
    \ issued.  The default is none, or system specific.\n"
- title: 6.5.  Port-Limit AVP
  contents:
  - "6.5.  Port-Limit AVP\n   The Port-Limit AVP (AVP Code 62) is of type Unsigned32\
    \ and sets the\n   maximum number of ports the NAS provides to the user.  It MAY\
    \ be used\n   in an authentication and/or authorization request as a hint to the\n\
    \   server that multilink PPP [PPPMP] service is desired, but the server\n   is\
    \ not required to honor the hint in the corresponding response.\n"
- title: 6.6.  NAS-Filter-Rule AVP
  contents:
  - "6.6.  NAS-Filter-Rule AVP\n   The NAS-Filter-Rule AVP (AVP Code 400) is of type\
    \ IPFilterRule and\n   provides filter rules that need to be configured on the\
    \ NAS for the\n   user.  One or more of these AVPs MAY be present in an authorization\n\
    \   response.\n"
- title: 6.7.  Filter-Id AVP
  contents:
  - "6.7.  Filter-Id AVP\n   The Filter-Id AVP (AVP Code 11) is of type UTF8String\
    \ and contains\n   the name of the filter list for this user.  Zero or more Filter-Id\n\
    \   AVPs MAY be sent in an authorization answer.\n   Identifying a filter list\
    \ by name allows the filter to be used on\n   different NASes without regard to\
    \ filter-list implementation details.\n   However, this AVP is not roaming friendly,\
    \ as filter naming differs\n   from one service provider to another.\n   In non-RADIUS\
    \ environments, it is RECOMMENDED that the NAS-Filter-\n   Rule AVP be used instead.\n"
- title: 6.8.  Configuration-Token AVP
  contents:
  - "6.8.  Configuration-Token AVP\n   The Configuration-Token AVP (AVP Code 78) is\
    \ of type OctetString and\n   is sent by a Diameter Server to a Diameter Proxy\
    \ Agent or Translation\n   Agent in an AA-Answer command to indicate a type of\
    \ user profile to\n   be used.  It should not be sent to a Diameter Client (NAS).\n\
    \   The format of the Data field of this AVP is site specific.\n"
- title: 6.9.  QoS-Filter-Rule AVP
  contents:
  - "6.9.  QoS-Filter-Rule AVP\n   The QoS-Filter-Rule AVP (AVP Code 407) is of type\
    \ QoSFilterRule and\n   provides QoS filter rules that need to be configured on\
    \ the NAS for\n   the user.  One or more such AVPs MAY be present in an authorization\n\
    \   response.\n   Note: Due to an editorial mistake in [BASE], only the AVP format\
    \ is\n   discussed.  The complete QoSFilterRule definition was not included.\n\
    \   It is reprinted here for clarification.\n   QoSFilterRule\n      The QosFilterRule\
    \ format is derived from the OctetString AVP Base\n      Format.  It uses the\
    \ ASCII charset.  Packets may be marked or\n      metered based on the following\
    \ information:\n         Direction                          (in or out)\n    \
    \     Source and destination IP address  (possibly masked)\n         Protocol\n\
    \         Source and destination port        (lists or ranges)\n         DSCP\
    \ values                        (no mask or range)\n      Rules for the appropriate\
    \ direction are evaluated in order; the\n      first matched rule terminates the\
    \ evaluation.  Each packet is\n      evaluated once.  If no rule matches, the\
    \ packet is treated as best\n      effort.  An access device unable to interpret\
    \ or apply a QoS rule\n      SHOULD NOT terminate the session.\n   QoSFilterRule\
    \ filters MUST follow the following format:\n      action dir proto from src to\
    \ dst [options]\n                tag    - Mark packet with a specific DSCP\n \
    \                        [DIFFSERV].  The DSCP option MUST be\n              \
    \           included.\n                meter  - Meter traffic.  The metering options\n\
    \                         MUST be included.\n   dir           The format is as\
    \ described under IPFilterRule.\n   proto         The format is as described under\
    \ IPFilterRule.\n   src and dst   The format is as described under IPFilterRule.\n\
    \         options:\n         DSCP <color>\n               Color values as defined\
    \ in [DIFFSERV].  Exact\n               matching of DSCP values is required (no\
    \ masks or\n               ranges).\n         metering <rate> <color_under> <color_over>\n\
    \               The metering option provides Assured Forwarding,\n           \
    \    as defined in [DIFFSERVAF], and MUST be present\n               if the action\
    \ is set to meter.  The rate option is\n               the throughput, in bits\
    \ per second, used\n               by the access device to mark packets.  Traffic\n\
    \               over the rate is marked with the color_over\n               codepoint,\
    \ and traffic under the rate is marked\n               with the color_under codepoint.\
    \  The color_under\n               and color_over options contain the drop\n \
    \              preferences and MUST conform to the recommended\n             \
    \  codepoint keywords described in [DIFFSERVAF]\n               (e.g., AF13).\n\
    \               The metering option also supports the strict\n               limit\
    \ on traffic required by Expedited\n               Forwarding, as defined in [DIFFSERVEF].\
    \  The\n               color_over option may contain the keyword \"drop\"\n  \
    \             to prevent forwarding of traffic that exceeds the\n            \
    \   rate parameter.\n         The rule syntax is a modified subset of ipfw(8)\
    \ from FreeBSD,\n         and the ipfw.c code may provide a useful base for\n\
    \         implementations.\n"
- title: 6.10.  Framed Access Authorization AVPs
  contents:
  - "6.10.  Framed Access Authorization AVPs\n   This section lists the authorization\
    \ AVPs necessary to\n   support framed access, such as PPP and SLIP.  AVPs defined\
    \ in this\n   section MAY be present in a message if the Service-Type AVP was\
    \ set\n   to \"Framed\" or \"Callback Framed\".\n"
- title: 6.10.1.  Framed-Protocol AVP
  contents:
  - "6.10.1.  Framed-Protocol AVP\n   The Framed-Protocol AVP (AVP Code 7) is of type\
    \ Enumerated and\n   contains the framing to be used for framed access.  This\
    \ AVP MAY be\n   present in both requests and responses.  The supported values\
    \ are\n   listed in [RADIUSTypes].  The following list is informational:\n   \
    \   1  PPP\n      2  SLIP\n      3  AppleTalk Remote Access Protocol (ARAP)\n\
    \      4  Gandalf proprietary SingleLink/MultiLink protocol\n      5  Xylogics\
    \ proprietary IPX/SLIP\n      6  X.75 Synchronous\n"
- title: 6.10.2.  Framed-Routing AVP
  contents:
  - "6.10.2.  Framed-Routing AVP\n   The Framed-Routing AVP (AVP Code 10) is of type\
    \ Enumerated and\n   contains the routing method for the user when the user is\
    \ a router to\n   a network.  This AVP SHOULD only be present in authorization\n\
    \   responses.  The supported values are listed in [RADIUSTypes].  The\n   following\
    \ list is informational:\n      0  None\n      1  Send routing packets\n     \
    \ 2  Listen for routing packets\n      3  Send and Listen\n"
- title: 6.10.3.  Framed-MTU AVP
  contents:
  - "6.10.3.  Framed-MTU AVP\n   The Framed-MTU AVP (AVP Code 12) is of type Unsigned32\
    \ and contains\n   the Maximum Transmission Unit to be configured for the user,\
    \ when it\n   is not negotiated by some other means (such as PPP).  This AVP SHOULD\n\
    \   only be present in authorization responses.  The MTU value MUST be in\n  \
    \ the range from 64 to 65535.\n"
- title: 6.10.4.  Framed-Compression AVP
  contents:
  - "6.10.4.  Framed-Compression AVP\n   The Framed-Compression AVP (AVP Code 13)\
    \ is of type Enumerated and\n   contains the compression protocol to be used for\
    \ the link.  It MAY be\n   used in an authorization request as a hint to the server\
    \ that a\n   specific compression type is desired, but the server is not required\n\
    \   to honor the hint in the corresponding response.\n   More than one compression\
    \ protocol AVP MAY be sent.  The NAS is\n   responsible for applying the proper\
    \ compression protocol to the\n   appropriate link traffic.\n   The supported\
    \ values are listed in [RADIUSTypes].  The following list\n   is informational:\n\
    \      0  None\n      1  VJ TCP/IP header compression\n      2  IPX header compression\n\
    \      3  Stac-LZS compression\n"
- title: 6.11.  IP Access Authorization AVPs
  contents:
  - "6.11.  IP Access Authorization AVPs\n   The AVPs defined in this section are\
    \ used when the user requests, or\n   is being granted, access service to IP.\n"
- title: 6.11.1.  Framed-IP-Address AVP
  contents:
  - "6.11.1.  Framed-IP-Address AVP\n   The Framed-IP-Address AVP (AVP Code 8) [RADIUS]\
    \ is of type\n   OctetString and contains an IPv4 address of the type specified\
    \ in the\n   attribute value to be configured for the user.  It MAY be used in\
    \ an\n   authorization request as a hint to the server that a specific address\n\
    \   is desired, but the server is not required to honor the hint in the\n   corresponding\
    \ response.\n   Two values have special significance: 0xFFFFFFFF and 0xFFFFFFFE.\
    \  The\n   value 0xFFFFFFFF indicates that the NAS should allow the user to\n\
    \   select an address (i.e., negotiated).  The value 0xFFFFFFFE indicates\n  \
    \ that the NAS should select an address for the user (e.g., assigned\n   from\
    \ a pool of addresses kept by the NAS).\n"
- title: 6.11.2.  Framed-IP-Netmask AVP
  contents:
  - "6.11.2.  Framed-IP-Netmask AVP\n   The Framed-IP-Netmask AVP (AVP Code 9) is\
    \ of type OctetString and\n   contains the four octets of the IPv4 netmask to\
    \ be configured for the\n   user when the user is a router to a network.  It MAY\
    \ be used in an\n   authorization request as a hint to the server that a specific\
    \ netmask\n   is desired, but the server is not required to honor the hint in\
    \ the\n   corresponding response.  This AVP MUST be present in a response if\n\
    \   the request included this AVP with a value of 0xFFFFFFFF.\n"
- title: 6.11.3.  Framed-Route AVP
  contents:
  - "6.11.3.  Framed-Route AVP\n   The Framed-Route AVP (AVP Code 22) is of type UTF8String\
    \ and contains\n   the ASCII routing information to be configured for the user\
    \ on the\n   NAS.  Zero or more of these AVPs MAY be present in an authorization\n\
    \   response.\n   The string MUST contain a destination prefix in dotted quad\
    \ form\n   optionally followed by a slash and a decimal length specifier stating\n\
    \   how many high-order bits of the prefix should be used.  This is\n   followed\
    \ by a space, a gateway address in dotted quad form, a space,\n   and one or more\
    \ metrics separated by spaces; for example,\n      \"192.168.1.0/24 192.168.1.1\
    \ 1\".\n   The length specifier may be omitted, in which case it should default\n\
    \   to 8 bits for class A prefixes, to 16 bits for class B prefixes, and\n   to\
    \ 24 bits for class C prefixes; for example,\n      \"192.168.1.0 192.168.1.1\
    \ 1\".\n   Whenever the gateway address is specified as \"0.0.0.0\" the IP address\n\
    \   of the user SHOULD be used as the gateway address.\n"
- title: 6.11.4.  Framed-Pool AVP
  contents:
  - "6.11.4.  Framed-Pool AVP\n   The Framed-Pool AVP (AVP Code 88) is of type OctetString\
    \ and contains\n   the name of an assigned address pool that SHOULD be used to\
    \ assign an\n   address for the user.  If a NAS does not support multiple address\n\
    \   pools, the NAS SHOULD ignore this AVP.  Address pools are usually\n   used\
    \ for IP addresses but can be used for other protocols if the NAS\n   supports\
    \ pools for those protocols.\n   Although specified as type OctetString for compatibility\
    \ with RADIUS\n   [RADIUSExt], the encoding of the Data field SHOULD also conform\
    \ to\n   the rules for the UTF8String Data Format.\n"
- title: 6.11.5.  Framed-Interface-Id AVP
  contents:
  - "6.11.5.  Framed-Interface-Id AVP\n   The Framed-Interface-Id AVP (AVP Code 96)\
    \ is of type Unsigned64 and\n   contains the IPv6 interface identifier to be configured\
    \ for the user.\n   It MAY be used in authorization requests as a hint to the\
    \ server that\n   a specific interface id is desired, but the server is not required\
    \ to\n   honor the hint in the corresponding response.\n"
- title: 6.11.6.  Framed-IPv6-Prefix AVP
  contents:
  - "6.11.6.  Framed-IPv6-Prefix AVP\n   The Framed-IPv6-Prefix AVP (AVP Code 97)\
    \ is of type OctetString and\n   contains the IPv6 prefix to be configured for\
    \ the user.  One or more\n   AVPs MAY be used in authorization requests as a hint\
    \ to the server\n   that specific IPv6 prefixes are desired, but the server is\
    \ not\n   required to honor the hint in the corresponding response.\n"
- title: 6.11.7.  Framed-IPv6-Route AVP
  contents:
  - "6.11.7.  Framed-IPv6-Route AVP\n   The Framed-IPv6-Route AVP (AVP Code 99) is\
    \ of type UTF8String and\n   contains the ASCII routing information to be configured\
    \ for the user\n   on the NAS.  Zero or more of these AVPs MAY be present in an\n\
    \   authorization response.\n   The string MUST contain an IPv6 address prefix\
    \ followed by a slash\n   and a decimal length specifier stating how many high\
    \ order bits of\n   the prefix should be used.  This is followed by a space, a\
    \ gateway\n   address in hexadecimal notation, a space, and one or more metrics\n\
    \   separated by spaces; for example,\n      \"2000:0:0:106::/64 2000::106:a00:20ff:fe99:a998\
    \ 1\".\n   Whenever the gateway address is the IPv6 unspecified address, the IP\n\
    \   address of the user SHOULD be used as the gateway address, such as\n   in:\n\
    \      \"2000:0:0:106::/64 :: 1\".\n"
- title: 6.11.8.  Framed-IPv6-Pool AVP
  contents:
  - "6.11.8.  Framed-IPv6-Pool AVP\n   The Framed-IPv6-Pool AVP (AVP Code 100) is\
    \ of type OctetString and\n   contains the name of an assigned pool that SHOULD\
    \ be used to assign\n   an IPv6 prefix for the user.  If the access device does\
    \ not support\n   multiple prefix pools, it MUST ignore this AVP.\n   Although\
    \ specified as type OctetString for compatibility with RADIUS\n   [RADIUSIPv6],\
    \ the encoding of the Data field SHOULD also conform to\n   the rules for the\
    \ UTF8String Data Format.\n"
- title: 6.12.  IPX Access
  contents:
  - "6.12.  IPX Access\n   The AVPs defined in this section are used when the user\
    \ requests, or\n   is being granted, access to an IPX network service.\n"
- title: 6.12.1.  Framed-IPX-Network AVP
  contents:
  - "6.12.1.  Framed-IPX-Network AVP\n   The Framed-IPX-Network AVP (AVP Code 23)\
    \ is of type Unsigned32 and\n   contains the IPX Network number to be configured\
    \ for the user.  It\n   MAY be used in an authorization request as a hint to the\
    \ server that\n   a specific address is desired, but the server is not required\
    \ to\n   honor the hint in the corresponding response.\n   Two addresses have\
    \ special significance: 0xFFFFFFFF and 0xFFFFFFFE.\n   The value 0xFFFFFFFF indicates\
    \ that the NAS should allow the user to\n   select an address (i.e., Negotiated).\
    \  The value 0xFFFFFFFE indicates\n   that the NAS should select an address for\
    \ the user (e.g., assign it\n   from a pool of one or more IPX networks kept by\
    \ the NAS).\n"
- title: 6.13.  AppleTalk Network Access
  contents:
  - "6.13.  AppleTalk Network Access\n   The AVPs defined in this section are used\
    \ when the user requests, or\n   is being granted, access to an AppleTalk network\
    \ [AppleTalk].\n"
- title: 6.13.1.  Framed-AppleTalk-Link AVP
  contents:
  - "6.13.1.  Framed-AppleTalk-Link AVP\n   The Framed-AppleTalk-Link AVP (AVP Code\
    \ 37) is of type Unsigned32 and\n   contains the AppleTalk network number that\
    \ should be used for the\n   serial link to the user, which is another AppleTalk\
    \ router.  This AVP\n   MUST only be present in an authorization response and\
    \ is never used\n   when the user is not another router.\n   Despite the size\
    \ of the field, values range from 0 to 65,535.  The\n   special value of 0 indicates\
    \ an unnumbered serial link.  A value of 1\n   to 65,535 means that the serial\
    \ line between the NAS and the user\n   should be assigned that value as an AppleTalk\
    \ network number.\n"
- title: 6.13.2.  Framed-AppleTalk-Network AVP
  contents:
  - "6.13.2.  Framed-AppleTalk-Network AVP\n   The Framed-AppleTalk-Network AVP (AVP\
    \ Code 38) is of type Unsigned32\n   and contains the AppleTalk Network number\
    \ that the NAS should probe\n   to allocate an AppleTalk node for the user.  This\
    \ AVP MUST only be\n   present in an authorization response and is never used\
    \ when the user\n   is not another router.  Multiple instances of this AVP indicate\
    \ that\n   the NAS may probe, using any of the network numbers specified.\n  \
    \ Despite the size of the field, values range from 0 to 65,535.  The\n   special\
    \ value 0 indicates that the NAS should assign a network for\n   the user, using\
    \ its default cable range.  A value between 1 and\n   65,535 (inclusive) indicates\
    \ to the AppleTalk Network that the NAS\n   should probe to find an address for\
    \ the user.\n"
- title: 6.13.3.  Framed-AppleTalk-Zone AVP
  contents:
  - "6.13.3.  Framed-AppleTalk-Zone AVP\n   The Framed-AppleTalk-Zone AVP (AVP Code\
    \ 39) is of type OctetString\n   and contains the AppleTalk Default Zone to be\
    \ used for this user.\n   This AVP MUST only be present in an authorization response.\
    \  Multiple\n   instances of this AVP in the same message are not allowed.\n \
    \  The codification of this field's allowed range is outside the scope\n   of\
    \ this specification.\n"
- title: 6.14.  AppleTalk Remote Access
  contents:
  - "6.14.  AppleTalk Remote Access\n   The AVPs defined in this section are used\
    \ when the user requests, or\n   is being granted, access to the AppleTalk network\
    \ via the AppleTalk\n   Remote Access Protocol [ARAP].  They are only present\
    \ if the Framed-\n   Protocol AVP (see section 6.10.1) is set to ARAP.  Section\
    \ 2.2 of RFC\n   2869 [RADIUSExt] describes the operational use of these attributes.\n"
- title: 6.14.1.  ARAP-Features AVP
  contents:
  - "6.14.1.  ARAP-Features AVP\n   The ARAP-Features AVP (AVP Code 71) is of type\
    \ OctetString and MAY be\n   present in the AA-Accept message if the Framed-Protocol\
    \ AVP is set to\n   the value of ARAP.  See [RADIUSExt] for more information about\
    \ the\n   format of this AVP.\n"
- title: 6.14.2.  ARAP-Zone-Access AVP
  contents:
  - "6.14.2.  ARAP-Zone-Access AVP\n   The ARAP-Zone-Access AVP (AVP Code 72) is of\
    \ type Enumerated and MAY\n   be present in the AA-Accept message if the Framed-Protocol\
    \ AVP is set\n   to the value of ARAP.\n   The supported values are listed in\
    \ [RADIUSTypes] and defined in\n   [RADIUSExt].\n"
- title: 6.15.  Non-Framed Access Authorization AVPs
  contents:
  - "6.15.  Non-Framed Access Authorization AVPs\n   This section contains the authorization\
    \ AVPs that are needed to\n   support terminal server functionality.  AVPs defined\
    \ in this section\n   MAY be present in a message if the Service-Type AVP was\
    \ set to\n   \"Login\" or \"Callback Login\".\n"
- title: 6.15.1.  Login-IP-Host AVP
  contents:
  - "6.15.1.  Login-IP-Host AVP\n   The Login-IP-Host AVP (AVP Code 14) [RADIUS] is\
    \ of type OctetString\n   and contains the IPv4 address of a host with which to\
    \ connect the\n   user when the Login-Service AVP is included.  It MAY be used\
    \ in an\n   AA-Request command as a hint to the Diameter Server that a specific\n\
    \   host is desired, but the Diameter Server is not required to honor the\n  \
    \ hint in the AA-Answer.\n   Two addresses have special significance: all ones\
    \ and 0.  The value\n   of all ones indicates that the NAS SHOULD allow the user\
    \ to select an\n   address.  The value 0 indicates that the NAS SHOULD select\
    \ a host to\n   connect the user to.\n"
- title: 6.15.2.  Login-IPv6-Host AVP
  contents:
  - "6.15.2.  Login-IPv6-Host AVP\n   The Login-IPv6-Host AVP (AVP Code 98) [RADIUSIPv6]\
    \ is of type\n   OctetString and contains the IPv6 address of a host with which\
    \ to\n   connect the user when the Login-Service AVP is included.  It MAY be\n\
    \   used in an AA-Request command as a hint to the Diameter Server that a\n  \
    \ specific host is desired, but the Diameter Server is not required to\n   honor\
    \ the hint in the AA-Answer.\n   Two addresses have special significance:\n  \
    \ 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF and 0.  The value\n   0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\
    \ indicates that the NAS SHOULD\n   allow the user to select an address.  The\
    \ value 0 indicates that the\n   NAS SHOULD select a host to connect the user\
    \ to.\n"
- title: 6.15.3.  Login-Service AVP
  contents:
  - "6.15.3.  Login-Service AVP\n   The Login-Service AVP (AVP Code 15) is of type\
    \ Enumerated and\n   contains the service that should be used to connect the user\
    \ to the\n   login host.  This AVP SHOULD only be present in authorization\n \
    \  responses.\n   The supported values are listed in [RADIUSTypes].  The following\
    \ list\n   is informational:\n      0  Telnet\n      1  Rlogin\n      2  TCP Clear\n\
    \      3  PortMaster (proprietary)\n      4  LAT\n      5  X25-PAD\n      6  X25-T3POS\n\
    \      8  TCP Clear Quiet (suppresses any NAS-generated connect\n            \
    \      string)\n"
- title: 6.16.  TCP Services
  contents:
  - "6.16.  TCP Services\n   The AVPs described in this section MAY be present if\
    \ the Login-\n   Service AVP is set to Telnet, Rlogin, TCP Clear, or TCP Clear\
    \ Quiet.\n"
- title: 6.16.1.  Login-TCP-Port AVP
  contents:
  - "6.16.1.  Login-TCP-Port AVP\n   The Login-TCP-Port AVP (AVP Code 16) is of type\
    \ Unsigned32 and\n   contains the TCP port with which the user is to be connected\
    \ when the\n   Login-Service AVP is also present.  This AVP SHOULD only be present\n\
    \   in authorization responses.  The value MUST NOT be greater than\n   65,535.\n"
- title: 6.17.  LAT Services
  contents:
  - "6.17.  LAT Services\n   The AVPs described in this section MAY be present if\
    \ the Login-\n   Service AVP is set to LAT [LAT].\n"
- title: 6.17.1.  Login-LAT-Service AVP
  contents:
  - "6.17.1.  Login-LAT-Service AVP\n   The Login-LAT-Service AVP (AVP Code 34) is\
    \ of type OctetString and\n   contains the system with which the user is to be\
    \ connected by LAT.\n   It MAY be used in an authorization request as a hint to\
    \ the server\n   that a specific service is desired, but the server is not required\
    \ to\n   honor the hint in the corresponding response.  This AVP MUST only be\n\
    \   present in the response if the Login-Service AVP states that LAT is\n   desired.\n\
    \   Administrators use this service attribute when dealing with clustered\n  \
    \ systems, such as a VAX or Alpha cluster.  In these environments,\n   several\
    \ different time-sharing hosts share the same resources (disks,\n   printers,\
    \ etc.), and administrators often configure each host to\n   offer access (service)\
    \ to each of the shared resources.  In this\n   case, each host in the cluster\
    \ advertises its services through LAT\n   broadcasts.\n   Sophisticated users\
    \ often know which service providers (machines) are\n   faster and tend to use\
    \ a node name when initiating a LAT connection.\n   Some administrators want particular\
    \ users to use certain machines as\n   a primitive form of load balancing (although\
    \ LAT knows how to do load\n   balancing itself).\n   The String field contains\
    \ the identity of the LAT service to use.\n   The LAT Architecture allows this\
    \ string to contain $ (dollar), -\n   (hyphen), . (period), _ (underscore), numerics,\
    \ upper- and lowercase\n   alphabetics, and the ISO Latin-1 character set extension\
    \ [ISOLatin].\n   All LAT string comparisons are case insensitive.\n"
- title: 6.17.2.  Login-LAT-Node AVP
  contents:
  - "6.17.2.  Login-LAT-Node AVP\n   The Login-LAT-Node AVP (AVP Code 35) is of type\
    \ OctetString and\n   contains the Node with which the user is to be automatically\n\
    \   connected by LAT.  It MAY be used in an authorization request as a\n   hint\
    \ to the server that a specific LAT node is desired, but the\n   server is not\
    \ required to honor the hint in the corresponding\n   response.  This AVP MUST\
    \ only be present in a response if the Login-\n   Service-Type AVP is set to LAT.\n\
    \   The String field contains the identity of the LAT service to use.\n   The\
    \ LAT Architecture allows this string to contain $ (dollar), -\n   (hyphen), .\
    \ (period), _ (underscore), numerics, upper- and lowercase\n   alphabetics, and\
    \ the ISO Latin-1 character set extension [ISOLatin].\n   All LAT string comparisons\
    \ are case insensitive.\n"
- title: 6.17.3.  Login-LAT-Group AVP
  contents:
  - "6.17.3.  Login-LAT-Group AVP\n   The Login-LAT-Group AVP (AVP Code 36) is of\
    \ type OctetString and\n   contains a string identifying the LAT group codes this\
    \ user is\n   authorized to use.  It MAY be used in an authorization request as\
    \ a\n   hint to the server that a specific group is desired, but the server\n\
    \   is not required to honor the hint in the corresponding response.\n   This\
    \ AVP MUST only be present in a response if the Login-Service-Type\n   AVP is\
    \ set to LAT.\n   LAT supports 256 different group codes, which LAT uses as a\
    \ form of\n   access rights.  LAT encodes the group codes as a 256-bit bitmap.\n\
    \   Administrators can assign one or more of the group code bits at the\n   LAT\
    \ service provider; it will only accept LAT connections that have\n   these group\
    \ codes set in the bitmap.  The administrators assign a\n   bitmap of authorized\
    \ group codes to each user.  LAT gets these from\n   the operating system and\
    \ uses them in its requests to the service\n   providers.\n   The codification\
    \ of the range of allowed usage of this field is\n   outside the scope of this\
    \ specification.\n"
- title: 6.17.4.  Login-LAT-Port AVP
  contents:
  - "6.17.4.  Login-LAT-Port AVP\n   The Login-LAT-Port AVP (AVP Code 63) is of type\
    \ OctetString and\n   contains the Port with which the user is to be connected\
    \ by LAT.  It\n   MAY be used in an authorization request as a hint to the server\
    \ that\n   a specific port is desired, but the server is not required to honor\n\
    \   the hint in the corresponding response.  This AVP MUST only be\n   present\
    \ in a response if the Login-Service-Type AVP is set to LAT.\n   The String field\
    \ contains the identity of the LAT service to use.\n   The LAT Architecture allows\
    \ this string to contain $ (dollar), -\n   (hyphen), . (period), _ (underscore),\
    \ numerics, upper- and lower-case\n   alphabetics, and the ISO Latin-1 character\
    \ set extension [ISOLatin].\n   All LAT string comparisons are case insensitive.\n"
- title: 7.  NAS Tunneling
  contents:
  - "7.  NAS Tunneling\n   Some NASes support compulsory tunnel services in which\
    \ the incoming\n   connection data is conveyed by an encapsulation method to a\
    \ gateway\n   elsewhere in the network.  This is typically transparent to the\n\
    \   service user, and the tunnel characteristics may be described by the\n   remote\
    \ AAA server, based on the user's authorization information.\n   Several tunnel\
    \ characteristics may be returned, and the NAS\n   implementation may choose one\
    \ [RADTunnels], [RADTunlAcct].\n                                            +---------------------+\n\
    \                                            |    AVP Flag rules   |\n       \
    \                                     |----+-----+----+-----|----+\n         \
    \          AVP  Section             |    |     |SHLD| MUST|    |\n   Attribute\
    \ Name  Code Defined  Value Type |MUST| MAY | NOT| NOT |Encr|\n   -----------------------------------------|----+-----+----+-----|----|\n\
    \   Tunneling        401   7.1    Grouped    | M  |  P  |    |  V  | N  |\n  \
    \ Tunnel-Type       64   7.2    Enumerated | M  |  P  |    |  V  | Y  |\n   Tunnel-Medium-\
    \    65   7.3    Enumerated | M  |  P  |    |  V  | Y  |\n     Type          \
    \                         |    |     |    |     |    |\n   Tunnel-Client-    66\
    \   7.4    UTF8String | M  |  P  |    |  V  | Y  |\n     Endpoint            \
    \                   |    |     |    |     |    |\n   Tunnel-Server-    67   7.5\
    \    UTF8String | M  |  P  |    |  V  | Y  |\n     Endpoint                  \
    \             |    |     |    |     |    |\n   Tunnel-Password   69   7.6    OctetString|\
    \ M  |  P  |    |  V  | Y  |\n   Tunnel-Private-   81   7.7    OctetString| M\
    \  |  P  |    |  V  | Y  |\n     Group-Id                               |    |\
    \     |    |     |    |\n   Tunnel-           82   7.8    OctetString| M  |  P\
    \  |    |  V  | Y  |\n     Assignment-Id                          |    |     |\
    \    |     |    |\n   Tunnel-Preference 83   7.9    Unsigned32 | M  |  P  |  \
    \  |  V  | Y  |\n   Tunnel-Client-    90   7.10   UTF8String | M  |  P  |    |\
    \  V  | Y  |\n     Auth-Id                                |    |     |    |  \
    \   |    |\n   Tunnel-Server-    91   7.11   UTF8String | M  |  P  |    |  V \
    \ | Y  |\n     Auth-Id                                |    |     |    |     |\
    \    |\n   -----------------------------------------|----+-----+----+-----|----|\n"
- title: 7.1.  Tunneling AVP
  contents:
  - "7.1.  Tunneling AVP\n   The Tunneling AVP (AVP Code 401) is of type Grouped and\
    \ contains the\n   following AVPs, used to describe a compulsory tunnel service:\n\
    \   [RADTunnels], [RADTunlAcct].  Its data field has the following ABNF\n   grammar:\n\
    \      Tunneling     ::= < AVP Header: 401 >\n                        { Tunnel-Type\
    \ }\n                        { Tunnel-Medium-Type }\n                        {\
    \ Tunnel-Client-Endpoint }\n                        { Tunnel-Server-Endpoint }\n\
    \                        [ Tunnel-Preference ]\n                        [ Tunnel-Client-Auth-Id\
    \ ]\n                        [ Tunnel-Server-Auth-Id ]\n                     \
    \   [ Tunnel-Assignment-Id ]\n                        [ Tunnel-Password ]\n  \
    \                      [ Tunnel-Private-Group-Id ]\n"
- title: 7.2.  Tunnel-Type AVP
  contents:
  - "7.2.  Tunnel-Type AVP\n   The Tunnel-Type AVP (AVP Code 64) is of type Enumerated\
    \ and contains\n   the tunneling protocol(s) to be used (in the case of a tunnel\n\
    \   initiator) or in use (in the case of a tunnel terminator).  It MAY be\n  \
    \ used in an authorization request as a hint to the server that a\n   specific\
    \ tunnel type is desired, but the server is not required to\n   honor the hint\
    \ in the corresponding response.\n   The Tunnel-Type AVP SHOULD also be included\
    \ in Accounting-Request\n   messages.\n   A tunnel initiator is not required to\
    \ implement any of these tunnel\n   types.  If a tunnel initiator receives a response\
    \ that contains only\n   unknown or unsupported Tunnel-Types, the tunnel initiator\
    \ MUST behave\n   as though a response were received with the Result-Code indicating\
    \ a\n   failure.\n   The supported values are listed in [RADIUSTypes].  The following\
    \ list\n   is informational:\n       1  Point-to-Point Tunneling Protocol (PPTP)\n\
    \       2  Layer Two Forwarding (L2F)\n       3  Layer Two Tunneling Protocol\
    \ (L2TP)\n       4  Ascend Tunnel Management Protocol (ATMP)\n       5  Virtual\
    \ Tunneling Protocol (VTP)\n       6  IP Authentication Header in the Tunnel-mode\
    \ (AH)\n       7  IP-in-IP Encapsulation (IP-IP)\n       8  Minimal IP-in-IP Encapsulation\
    \ (MIN-IP-IP)\n       9  IP Encapsulating Security Payload in the Tunnel-mode\
    \ (ESP)\n      10  Generic Route Encapsulation (GRE)\n      11  Bay Dial Virtual\
    \ Services (DVS)\n      12  IP-in-IP Tunneling\n      13  Virtual LANs (VLAN)\n"
- title: 7.3.  Tunnel-Medium-Type AVP
  contents:
  - "7.3.  Tunnel-Medium-Type AVP\n   The Tunnel-Medium-Type AVP (AVP Code 65) is\
    \ of type Enumerated and\n   contains the transport medium to use when creating\
    \ a tunnel for\n   protocols (such as L2TP) that can operate over multiple transports.\n\
    \   It MAY be used in an authorization request as a hint to the server\n   that\
    \ a specific medium is desired, but the server is not required to\n   honor the\
    \ hint in the corresponding response.\n   The supported values are listed in [RADIUSTypes].\
    \  The following list\n   is informational:\n       1  IPv4 (IP version 4)\n \
    \      2  IPv6 (IP version 6)\n       3  NSAP\n       4  HDLC (8-bit multidrop)\n\
    \       5  BBN 1822\n       6  802 (includes all 802 media plus Ethernet \"canonical\n\
    \                    format\")\n       7  E.163 (POTS)\n       8  E.164 (SMDS,\
    \ Frame Relay, ATM)\n       9  F.69 (Telex)\n      10  X.121 (X.25, Frame Relay)\n\
    \      11  IPX\n      12  Appletalk\n      13  Decnet IV\n      14  Banyan Vines\n\
    \      15  E.164 with NSAP format subaddress\n"
- title: 7.4.  Tunnel-Client-Endpoint AVP
  contents:
  - "7.4.  Tunnel-Client-Endpoint AVP\n   The Tunnel-Client-Endpoint AVP (AVP Code\
    \ 66) is of type UTF8String\n   and contains the address of the initiator end\
    \ of the tunnel.  It MAY\n   be used in an authorization request as a hint to\
    \ the server that a\n   specific endpoint is desired, but the server is not required\
    \ to honor\n   the hint in the corresponding response.\n   This AVP SHOULD be\
    \ included in the corresponding Accounting-Request\n   messages, in which case\
    \ it indicates the address from which the\n   tunnel was initiated.  This AVP,\
    \ along with the Tunnel-Server-\n   Endpoint and Session-Id AVP [BASE], MAY be\
    \ used to provide a globally\n   unique means to identify a tunnel for accounting\
    \ and auditing\n   purposes.\n   If Tunnel-Medium-Type is IPv4 (1), then this\
    \ string is either the\n   fully qualified domain name (FQDN) of the tunnel client\
    \ machine, or a\n   \"dotted-decimal\" IP address.  Implementations MUST support\
    \ the\n   dotted-decimal format and SHOULD support the FQDN format for IP\n  \
    \ addresses.\n   If Tunnel-Medium-Type is IPv6 (2), then this string is either\
    \ the\n   FQDN of the tunnel client machine, or a text representation of the\n\
    \   address in either the preferred or alternate form [IPv6Addr].\n   Conforming\
    \ implementations MUST support the preferred form and SHOULD\n   support both\
    \ the alternate text form and the FQDN format for IPv6\n   addresses.\n   If Tunnel-Medium-Type\
    \ is neither IPv4 nor IPv6, then this string is a\n   tag referring to configuration\
    \ data local to the Diameter client that\n   describes the interface or medium-specific\
    \ client address to use.\n"
- title: 7.5.  Tunnel-Server-Endpoint AVP
  contents:
  - "7.5.  Tunnel-Server-Endpoint AVP\n   The Tunnel-Server-Endpoint AVP (AVP Code\
    \ 67) is of type UTF8String\n   and contains the address of the server end of\
    \ the tunnel.  It MAY be\n   used in an authorization request as a hint to the\
    \ server that a\n   specific endpoint is desired, but the server is not required\
    \ to honor\n   the hint in the corresponding response.\n   This AVP SHOULD be\
    \ included in the corresponding Accounting-Request\n   messages, in which case\
    \ it indicates the address from which the\n   tunnel was initiated.  This AVP,\
    \ along with the Tunnel-Client-\n   Endpoint and Session-Id AVP [BASE], MAY be\
    \ used to provide a globally\n   unique means to identify a tunnel for accounting\
    \ and auditing\n   purposes.\n   If Tunnel-Medium-Type is IPv4 (1), then this\
    \ string is either the\n   fully qualified domain name (FQDN) of the tunnel server\
    \ machine, or a\n   \"dotted-decimal\" IP address.  Implementations MUST support\
    \ the\n   dotted-decimal format and SHOULD support the FQDN format for IP\n  \
    \ addresses.\n   If Tunnel-Medium-Type is IPv6 (2), then this string is either\
    \ the\n   FQDN of the tunnel server machine, or a text representation of the\n\
    \   address in either the preferred or alternate form [IPv6Addr].\n   Implementations\
    \ MUST support the preferred form and SHOULD support\n   both the alternate text\
    \ form and the FQDN format for IPv6 addresses.\n   If Tunnel-Medium-Type is not\
    \ IPv4 or IPv6, this string is a tag\n   referring to configuration data local\
    \ to the Diameter client that\n   describes the interface or medium-specific server\
    \ address to use.\n"
- title: 7.6.  Tunnel-Password AVP
  contents:
  - "7.6.  Tunnel-Password AVP\n   The Tunnel-Password AVP (AVP Code 69) is of type\
    \ OctetString and may\n   contain a password to be used to authenticate to a remote\
    \ server.\n   The Tunnel-Password AVP contains sensitive information.  This value\n\
    \   is not protected in the same manner as RADIUS [RADTunnels].\n   As required\
    \ in [BASE], Diameter messages are encrypted by using IPsec\n   or TLS.  The Tunnel-Password\
    \ AVP SHOULD NOT be used in untrusted\n   proxy environments without encrypting\
    \ it by using end-to-end security\n   techniques, such as CMS Security [DiamCMS].\n"
- title: 7.7.  Tunnel-Private-Group-Id AVP
  contents:
  - "7.7.  Tunnel-Private-Group-Id AVP\n   The Tunnel-Private-Group-Id AVP (AVP Code\
    \ 81) is of type OctetString\n   and contains the group Id for a particular tunneled\
    \ session.  The\n   Tunnel-Private-Group-Id AVP MAY be included in an authorization\n\
    \   request if the tunnel initiator can predetermine the group resulting\n   from\
    \ a particular connection.  It SHOULD be included in the\n   authorization response\
    \ if this tunnel session is to be treated as\n   belonging to a particular private\
    \ group.  Private groups may be used\n   to associate a tunneled session with\
    \ a particular group of users.\n   For example, it MAY be used to facilitate routing\
    \ of unregistered IP\n   addresses through a particular interface.  This AVP SHOULD\
    \ be\n   included in the Accounting-Request messages that pertain to the\n   tunneled\
    \ session.\n"
- title: 7.8.  Tunnel-Assignment-Id AVP
  contents:
  - "7.8.  Tunnel-Assignment-Id AVP\n   The Tunnel-Assignment-Id AVP (AVP Code 82)\
    \ is of type OctetString and\n   is used to indicate to the tunnel initiator the\
    \ particular tunnel to\n   which a session is to be assigned.  Some tunneling\
    \ protocols, such as\n   [PPTP] and [L2TP], allow for sessions between the same\
    \ two tunnel\n   endpoints to be multiplexed over the same tunnel and also for\
    \ a given\n   session to use its own dedicated tunnel.  This attribute provides\
    \ a\n   mechanism for Diameter to inform the tunnel initiator (e.g., PAC,\n  \
    \ LAC) whether to assign the session to a multiplexed tunnel or to a\n   separate\
    \ tunnel.  Furthermore, it allows for sessions sharing\n   multiplexed tunnels\
    \ to be assigned to different multiplexed tunnels.\n   A particular tunneling\
    \ implementation may assign differing\n   characteristics to particular tunnels.\
    \  For example, different\n   tunnels may be assigned different QoS parameters.\
    \  Such tunnels may\n   be used to carry either individual or multiple sessions.\
    \  The\n   Tunnel-Assignment-Id attribute thus allows the Diameter server to\n\
    \   indicate that a particular session is to be assigned to a tunnel\n   providing\
    \ an appropriate level of service.  It is expected that any\n   QoS-related Diameter\
    \ tunneling attributes defined in the future\n   accompanying this one will be\
    \ associated by the tunnel initiator with\n   the Id given by this attribute.\
    \  In the meantime, any semantic given\n   to a particular Id string is a matter\
    \ left to local configuration in\n   the tunnel initiator.\n   The Tunnel-Assignment-Id\
    \ AVP is of significance only to Diameter and\n   the tunnel initiator.  The Id\
    \ it specifies is only intended to be of\n   local use to Diameter and the tunnel\
    \ initiator.  The Id assigned by\n   the tunnel initiator is not conveyed to the\
    \ tunnel peer.\n   This attribute MAY be included in authorization responses.\
    \  The\n   tunnel initiator receiving this attribute MAY choose to ignore it and\n\
    \   to assign the session to an arbitrary multiplexed or non-multiplexed\n   tunnel\
    \ between the desired endpoints.  This AVP SHOULD also be\n   included in the\
    \ Accounting-Request messages pertaining to the\n   tunneled session.\n   If a\
    \ tunnel initiator supports the Tunnel-Assignment-Id AVP, then it\n   should assign\
    \ a session to a tunnel in the following manner:\n      -  If this AVP is present\
    \ and a tunnel exists between the\n         specified endpoints with the specified\
    \ Id, then the session\n         should be assigned to that tunnel.\n      - \
    \ If this AVP is present and no tunnel exists between the\n         specified\
    \ endpoints with the specified Id, then a new tunnel\n         should be established\
    \ for the session and the specified Id\n         should be associated with the\
    \ new tunnel.\n      -  If this AVP is not present, then the session is assigned\
    \ to an\n         unnamed tunnel.  If an unnamed tunnel does not yet exist\n \
    \        between the specified endpoints, then it is established and\n       \
    \  used for this session and for subsequent ones established\n         without\
    \ the Tunnel-Assignment-Id attribute.  A tunnel initiator\n         MUST NOT assign\
    \ a session for which a Tunnel-Assignment-Id AVP\n         was not specified to\
    \ a named tunnel (i.e., one that was\n         initiated by a session specifying\
    \ this AVP).\n   Note that the same Id may be used to name different tunnels if\
    \ these\n   tunnels are between different endpoints.\n"
- title: 7.9.  Tunnel-Preference AVP
  contents:
  - "7.9.  Tunnel-Preference AVP\n   The Tunnel-Preference AVP (AVP Code 83) is of\
    \ type Unsigned32 and is\n   used to identify the relative preference assigned\
    \ to each tunnel when\n   more than one set of tunneling AVPs is returned within\
    \ separate\n   Grouped-AVP AVPs.  It MAY be used in an authorization request as\
    \ a\n   hint to the server that a specific preference is desired, but the\n  \
    \ server is not required to honor the hint in the corresponding\n   response.\n\
    \   For example, suppose that AVPs describing two tunnels are returned by\n  \
    \ the server, one with a Tunnel-Type of PPTP and the other with a\n   Tunnel-Type\
    \ of L2TP.  If the tunnel initiator supports only one of\n   the Tunnel-Types\
    \ returned, it will initiate a tunnel of that type.\n   If, however, it supports\
    \ both tunnel protocols, it SHOULD use the\n   value of the Tunnel-Preference\
    \ AVP to decide which tunnel should be\n   started.  The tunnel with the lowest\
    \ numerical value in the Value\n   field of this AVP SHOULD be given the highest\
    \ preference.  The values\n   assigned to two or more instances of the Tunnel-Preference\
    \ AVP within\n   a given authorization response MAY be identical.  In this case,\
    \ the\n   tunnel initiator SHOULD use locally configured metrics to decide\n \
    \  which set of AVPs to use.\n"
- title: 7.10.  Tunnel-Client-Auth-Id AVP
  contents:
  - "7.10.  Tunnel-Client-Auth-Id AVP\n   The Tunnel-Client-Auth-Id AVP (AVP Code\
    \ 90) is of type UTF8String and\n   specifies the name used by the tunnel initiator\
    \ during the\n   authentication phase of tunnel establishment.  It MAY be used\
    \ in an\n   authorization request as a hint to the server that a specific\n  \
    \ preference is desired, but the server is not required to honor the\n   hint\
    \ in the corresponding response.  This AVP MUST be present in the\n   authorization\
    \ response if an authentication name other than the\n   default is desired.  This\
    \ AVP SHOULD be included in the Accounting-\n   Request messages pertaining to\
    \ the tunneled session.\n"
- title: 7.11.  Tunnel-Server-Auth-Id AVP
  contents:
  - "7.11.  Tunnel-Server-Auth-Id AVP\n   The Tunnel-Server-Auth-Id AVP (AVP Code\
    \ 91) is of type UTF8String and\n   specifies the name used by the tunnel terminator\
    \ during the\n   authentication phase of tunnel establishment.  It MAY be used\
    \ in an\n   authorization request as a hint to the server that a specific\n  \
    \ preference is desired, but the server is not required to honor the\n   hint\
    \ in the corresponding response.  This AVP MUST be present in the\n   authorization\
    \ response if an authentication name other than the\n   default is desired.  This\
    \ AVP SHOULD be included in the Accounting-\n   Request messages pertaining to\
    \ the tunneled session.\n"
- title: 8.  NAS Accounting
  contents:
  - "8.  NAS Accounting\n   Applications implementing this specification use Diameter\
    \ Accounting,\n   as defined in [BASE], and the AVPs in the following section.\n\
    \   Service-specific AVP usage is defined in the tables in section 10.\n   If\
    \ accounting is active, Accounting Request (ACR) messages SHOULD be\n   sent after\
    \ the completion of any Authentication or Authorization\n   transaction and at\
    \ the end of a Session.  The Accounting-Record-Type\n   value indicates the type\
    \ of event.  All other AVPs identify the\n   session and provide additional information\
    \ relevant to the event.\n   The successful completion of the first Authentication\
    \ or\n   Authorization transaction SHOULD cause a START_RECORD to be sent.  If\n\
    \   additional Authentications or Authorizations occur in later\n   transactions,\
    \ the first exchange should generate a START_RECORD, and\n   the later an INTERIM_RECORD.\
    \  For a given session, there MUST only be\n   one set of matching START and STOP\
    \ records, with any number of\n   INTERIM_RECORDS in between, or one EVENT_RECORD\
    \ indicating the reason\n   a session wasn't started.\n   The following table\
    \ describes the AVPs; their AVP Code values, types,\n   and possible flag values;\
    \ and whether the AVP MAY be encrypted.\n                                    \
    \        +---------------------+\n                                           \
    \ |    AVP Flag rules   |\n                                            |----+-----+----+-----|----+\n\
    \                   AVP  Section             |    |     |SHLD| MUST|    |\n  \
    \ Attribute Name  Code Defined  Value Type |MUST| MAY | NOT|  NOT|Encr|\n   -----------------------------------------|----+-----+----+-----|----|\n\
    \   Accounting-      363  8.1     Unsigned64 | M  |  P  |    |  V  | Y  |\n  \
    \   Input-Octets                           |    |     |    |     |    |\n   Accounting-\
    \      364  8.2     Unsigned64 | M  |  P  |    |  V  | Y  |\n     Output-Octets\
    \                          |    |     |    |     |    |\n   Accounting-      365\
    \  8.3     Unsigned64 | M  |  P  |    |  V  | Y  |\n     Input-Packets       \
    \                   |    |     |    |     |    |\n   Accounting-      366  8.4\
    \     Unsigned64 | M  |  P  |    |  V  | Y  |\n     Output-Packets           \
    \              |    |     |    |     |    |\n   Acct-Session-Time 46  8.5    \
    \ Unsigned32 | M  |  P  |    |  V  | Y  |\n   Acct-Authentic    45  8.6     Enumerated\
    \ | M  |  P  |    |  V  | Y  |\n   Acounting-Auth-  406  8.7     Enumerated |\
    \ M  |  P  |    |  V  | Y  |\n     Method                                 |  \
    \  |     |    |     |    |\n   Acct-Delay-Time   41  8.8     Unsigned32 | M  |\
    \  P  |    |  V  | Y  |\n   Acct-Link-Count   51  8.9     Unsigned32 | M  |  P\
    \  |    |  V  | Y  |\n   Acct-Tunnel-      68  8.10    OctetString| M  |  P  |\
    \    |  V  | Y  |\n     Connection                             |    |     |  \
    \  |     |    |\n   Acct-Tunnel-      86  8.11    Unsigned32 | M  |  P  |    |\
    \  V  | Y  |\n     Packets-Lost                           |    |     |    |  \
    \   |    |\n   -----------------------------------------|----+-----+----+-----|----|\n"
- title: 8.1.  Accounting-Input-Octets AVP
  contents:
  - "8.1.  Accounting-Input-Octets AVP\n   The Accounting-Input-Octets AVP (AVP Code\
    \ 363) is of type Unsigned64\n   and contains the number of octets received from\
    \ the user.\n   For NAS usage, this AVP indicates how many octets have been received\n\
    \   from the port in the course of this session.  It can only be present\n   in\
    \ ACR messages with an Accounting-Record-Type of INTERIM_RECORD or\n   STOP_RECORD.\n"
- title: 8.2.  Accounting-Output-Octets AVP
  contents:
  - "8.2.  Accounting-Output-Octets AVP\n   The Accounting-Output-Octets AVP (AVP\
    \ Code 364) is of type Unsigned64\n   and contains the number of octets sent to\
    \ the user.\n   For NAS usage, this AVP indicates how many octets have been sent\
    \ to\n   the port in the course of this session.  It can only be present in\n\
    \   ACR messages with an Accounting-Record-Type of INTERIM_RECORD or\n   STOP_RECORD.\n"
- title: 8.3.  Accounting-Input-Packets AVP
  contents:
  - "8.3.  Accounting-Input-Packets AVP\n   The Accounting-Input-Packets (AVP Code\
    \ 365) is of type Unsigned64 and\n   contains the number of packets received from\
    \ the user.\n   For NAS usage, this AVP indicates how many packets have been received\n\
    \   from the port over the course of a session being provided to a Framed\n  \
    \ User.  It can only be present in ACR messages with an Accounting-\n   Record-Type\
    \ of INTERIM_RECORD or STOP_RECORD.\n"
- title: 8.4.  Accounting-Output-Packets AVP
  contents:
  - "8.4.  Accounting-Output-Packets AVP\n   The Accounting-Output-Packets (AVP Code\
    \ 366) is of type Unsigned64\n   and contains the number of IP packets sent to\
    \ the user.\n   For NAS usage, this AVP indicates how many packets have been sent\
    \ to\n   the port over the course of a session being provided to a Framed\n  \
    \ User.  It can only be present in ACR messages with an Accounting-\n   Record-Type\
    \ of INTERIM_RECORD or STOP_RECORD.\n"
- title: 8.5.  Acct-Session-Time AVP
  contents:
  - "8.5.  Acct-Session-Time AVP\n   The Acct-Session-Time AVP (AVP Code 46) is of\
    \ type Unsigned32 and\n   indicates the length of the current session in seconds.\
    \  It can only\n   be present in ACR messages with an Accounting-Record-Type of\n\
    \   INTERIM_RECORD or STOP_RECORD.\n"
- title: 8.6.  Acct-Authentic AVP
  contents:
  - "8.6.  Acct-Authentic AVP\n   The Acct-Authentic AVP (AVP Code 45) is of type\
    \ Enumerated and\n   specifies how the user was authenticated.  The supported\
    \ values are\n   listed in [RADIUSTypes].  The following list is informational:\n\
    \      1  RADIUS\n      2  Local\n      3  Remote\n      4  Diameter\n"
- title: 8.7.  Accounting-Auth-Method AVP
  contents:
  - "8.7.  Accounting-Auth-Method AVP\n   The Accounting-Auth-Method AVP (AVP Code\
    \ 406) is of type Enumerated.\n   A NAS MAY include this AVP in an Accounting-Request\
    \ message to\n   indicate the method used to authenticate the user.  (Note that\
    \ this\n   is equivalent to the RADIUS MS-Acct-Auth-Type VSA attribute).\n   The\
    \ following values are defined:\n      1  PAP\n      2  CHAP\n      3  MS-CHAP-1\n\
    \      4  MS-CHAP-2\n      5  EAP\n      7  None\n"
- title: 8.8.  Acct-Delay-Time
  contents:
  - "8.8.  Acct-Delay-Time\n   The Acct-Delay-Time AVP (AVP Code 41) is of type Unsigned32\
    \ and\n   indicates the number of seconds the Diameter client has been trying\n\
    \   to send the Accounting-Request (ACR).  The accounting server may\n   subtract\
    \ this value from the time when the ACR arrives at the server\n   to calculate\
    \ the approximate time of the event that caused the ACR to\n   be generated.\n\
    \   This AVP is not used for retransmissions at the transport level (TCP\n   or\
    \ SCTP).  Rather, it may be used when an ACR command cannot be\n   transmitted\
    \ because there is no appropriate peer to transmit it to or\n   was rejected because\
    \ it could not be delivered.  In these cases, the\n   command MAY be buffered\
    \ and transmitted later, when an appropriate\n   peer-connection is available\
    \ or after sufficient time has passed that\n   the destination-host may be reachable\
    \ and operational.  If the ACR is\n   resent in this way, the Acct-Delay-Time\
    \ AVP SHOULD be included.  The\n   value of this AVP indicates the number of seconds\
    \ that elapsed\n   between the time of the first attempt at transmission and the\
    \ current\n   attempt.\n"
- title: 8.9.  Acct-Link-Count
  contents:
  - "8.9.  Acct-Link-Count\n   The Acct-Link-Count AVP (AVP Code 51) is of type Unsigned32\
    \ and\n   indicates the total number of links that have been active (current or\n\
    \   closed) in a given multilink session at the time the accounting\n   record\
    \ is generated.  This AVP MAY be included in Accounting-Requests\n   for any session\
    \ that may be part of a multilink service.\n   The Acct-Link-Count AVP may be\
    \ used to make it easier for an\n   accounting server to know when it has all\
    \ the records for a given\n   multilink service.  When the number of Accounting-Requests\
    \ received\n   with Accounting-Record-Type = STOP_RECORD and with the same Acct-\n\
    \   Multi-Session-Id and unique Session-Ids equals the largest value of\n   Acct-Link-Count\
    \ seen in those Accounting-Requests, all STOP_RECORD\n   Accounting-Requests for\
    \ that multilink service have been received.\n   The following example, showing\
    \ eight Accounting-Requests, illustrates\n   how the Acct-Link-Count AVP is used.\
    \  In the table below, only the\n   relevant AVPs are shown, although additional\
    \ AVPs containing\n   accounting information will be present in the Accounting-Requests.\n\
    \      Acct-Multi-                   Accounting-     Acct-\n      Session-Id \
    \    Session-Id     Record-Type     Link-Count\n      --------------------------------------------------------\n\
    \        \"...10\"        \"...10\"      START_RECORD        1\n        \"...10\"\
    \        \"...11\"      START_RECORD        2\n        \"...10\"        \"...11\"\
    \      STOP_RECORD         2\n        \"...10\"        \"...12\"      START_RECORD\
    \        3\n        \"...10\"        \"...13\"      START_RECORD        4\n  \
    \      \"...10\"        \"...12\"      STOP_RECORD         4\n        \"...10\"\
    \        \"...13\"      STOP_RECORD         4\n        \"...10\"        \"...10\"\
    \      STOP_RECORD         4\n"
- title: 8.10.  Acct-Tunnel-Connection AVP
  contents:
  - "8.10.  Acct-Tunnel-Connection AVP\n   The Acct-Tunnel-Connection AVP (AVP Code\
    \ 68) is of type OctetString\n   and contains the identifier assigned to the tunnel\
    \ session.  This\n   AVP, along with the Tunnel-Client-Endpoint and Tunnel-Server-Endpoint\n\
    \   AVPs, may be used to provide a means to uniquely identify a tunnel\n   session\
    \ for auditing purposes.\n   The format of the identifier in this AVP depends\
    \ upon the value of\n   the Tunnel-Type AVP.  For example, to identify an L2TP\
    \ tunnel\n   connection fully, the L2TP Tunnel Id and Call Id might be encoded\
    \ in\n   this field.  The exact encoding of this field is implementation\n   dependent.\n"
- title: 8.11.  Acct-Tunnel-Packets-Lost AVP
  contents:
  - "8.11.  Acct-Tunnel-Packets-Lost AVP\n   The Acct-Tunnel-Packets-Lost AVP (AVP\
    \ Code 86) is of type Unsigned32\n   and contains the number of packets lost on\
    \ a given link.\n"
- title: 9.  RADIUS/Diameter Protocol Interactions
  contents:
  - "9.  RADIUS/Diameter Protocol Interactions\n   This section describes some basic\
    \ guidelines that servers acting as\n   AAA Translation Agents may use.  A complete\
    \ description of all the\n   differences between RADIUS and Diameter is beyond\
    \ the scope of this\n   section and document.  Note that this document does not\
    \ restrict\n   implementations from creating additional translation methods, as\
    \ long\n   as the translation function doesn't violate the RADIUS or the\n   Diameter\
    \ protocols.\n   Although the Diameter protocol is in many ways a superset of\
    \ RADIUS\n   functions, a number of RADIUS representations are not allowed, so\n\
    \   that new capabilities can be used without the old problems.\n   There are\
    \ primarily two different situations that must be handled:\n   one in which a\
    \ RADIUS request is received that must be forwarded as a\n   Diameter request,\
    \ and another in which the inverse is true.  RADIUS\n   does not support a peer-to-peer\
    \ architecture, and server-initiated\n   operations are generally not supported.\
    \  See [RADDynAuth] for an\n   alternative.\n   Some RADIUS attributes are encrypted.\
    \  RADIUS security and encryption\n   techniques are applied on a hop-per-hop\
    \ basis.  A Diameter agent will\n   have to decrypt RADIUS attribute data entering\
    \ the Diameter system,\n   and if that information is forwarded, the agent MUST\
    \ secure it by\n   using Diameter specific techniques.\n   Note that this section\
    \ uses the two terms, \"AVP\" and \"attribute\", in\n   a concise and specific\
    \ manner.  The former is used to signify a\n   Diameter AVP, and the latter to\
    \ signify a RADIUS attribute.\n"
- title: 9.1.  RADIUS Request Forwarded as Diameter Request
  contents:
  - "9.1.  RADIUS Request Forwarded as Diameter Request\n   This section describes\
    \ the actions that should be taken when a\n   Translation Agent receives a RADIUS\
    \ message to be translated to a\n   Diameter message.\n   Note that RADIUS servers\
    \ are assumed to be stateless.  It is also\n   quite possible for the RADIUS messages\
    \ that comprise the session\n   (i.e., authentication and accounting messages)\
    \ to be handled by\n   different Translation Agents in the proxy network.  Therefore,\
    \ a\n   RADIUS/Diameter Translation Agent SHOULD NOT be assumed to have an\n \
    \  accurate track on session-state information.\n   When a Translation Agent receives\
    \ a RADIUS message, the following\n   steps should be taken:\n      -  If a Message-Authenticator\
    \ attribute is present, the value MUST\n         be checked but not included in\
    \ the Diameter message.  If it is\n         incorrect, the RADIUS message should\
    \ be silently discarded.\n         The gateway system SHOULD generate and include\
    \ a Message-\n         Authenticator in returned RADIUS responses.\n      -  The\
    \ transport address of the sender MUST be checked against the\n         NAS identifying\
    \ attributes.  See the description of NAS-\n         Identifier and NAS-IP-Address\
    \ below.\n      -  The Translation Agent must maintain transaction state\n   \
    \      information relevant to the RADIUS request, such as the\n         Identifier\
    \ field in the RADIUS header, any existing RADIUS\n         Proxy-State attribute,\
    \ and the source IP address and port\n         number of the UDP packet.  These\
    \ may be maintained locally in a\n         state table or saved in a Proxy-Info\
    \ AVP group.  A Diameter\n         Session-Id AVP value must be created using\
    \ a session state\n         mapping mechanism.\n      -  If the RADIUS request\
    \ contained a State attribute and the\n         prefix of the data is \"Diameter/\"\
    , the data following the\n         prefix contains the Diameter Origin-Host/Origin-Realm/Session-\n\
    \         Id.  If no such attributes are present and the RADIUS command\n    \
    \     is an Access-Request, a new Session-Id is created.  The\n         Session-Id\
    \ is included in the Session-Id AVP.\n      -  The Diameter Origin-Host and Origin-Realm\
    \ AVPs MUST be created\n         and added by using the information from an FQDN\
    \ corresponding\n         to the NAS-IP-Address attribute (preferred if available),\n\
    \         and/or to the NAS-Identifier attribute.  (Note that the RADIUS\n   \
    \      NAS-Identifier is not required to be an FQDN.)\n      -  The response MUST\
    \ have an Origin-AAA-Protocol AVP added,\n         indicating the protocol of\
    \ origin of the message.\n      -  The Proxy-Info group SHOULD be added, with\
    \ the local server's\n         identity specified in the Proxy-Host AVP.  This\
    \ should ensure\n         that the response is returned to this system.\n    \
    \  -  The Destination-Realm AVP is created from the information found\n      \
    \   in the RADIUS User-Name attribute.\n      -  If the RADIUS User-Password attribute\
    \ is present, the password\n         must be unencrypted by using the link's RADIUS\
    \ shared secret.\n         The unencrypted value must be forwarded in a User-Password\
    \ AVP\n         using Diameter security.\n      -  If the RADIUS CHAP-Password\
    \ attribute is present, the Ident and\n         Data portion of the attribute\
    \ are used to create the CHAP-Auth\n         grouped AVP.\n      -  If the RADIUS\
    \ message contains an address attribute, it MUST be\n         converted to the\
    \ appropriate Diameter AVP and type.\n      -  If the RADIUS message contains\
    \ Tunnel information [RADTunnels],\n         the attributes or tagged groups should\
    \ each be converted to a\n         Diameter Tunneling Grouped AVP set.  If the\
    \ tunnel information\n         contains a Tunnel-Password attribute, the RADIUS\
    \ encryption\n         must be resolved, and the password forwarded, by using\
    \ Diameter\n         security methods.\n      -  If the RADIUS message received\
    \ is an Accounting-Request, the\n         Acct-Status-Type attribute value must\
    \ be converted to a\n         Accounting-Record-Type AVP value.  If the Acct-Status-Type\n\
    \         attribute value is STOP, the local server MUST issue a\n         Session-Termination-Request\
    \ message once the Diameter\n         Accounting-Answer message has been received.\n\
    \      -  If the Accounting message contains an Acct-Termination-Cause\n     \
    \    attribute, it should be translated to the equivalent\n         Termination-Cause\
    \ AVP value.  (see below)\n      -  If the RADIUS message contains the Accounting-Input-Octets,\n\
    \         Accounting-Input-Packets, Accounting-Output-Octets, or\n         Accounting-Output-Packets,\
    \ these attributes must be converted\n         to the Diameter equivalents.  Further,\
    \ if the Acct-Input-\n         Gigawords or Acct-Output-Gigawords attributes are\
    \ present,\n         these must be used to properly compute the Diameter accounting\n\
    \         AVPs.\n   The corresponding Diameter response is always guaranteed to\
    \ be\n   received by the same Translation Agent that translated the original\n\
    \   request, due to the contents of the Proxy-Info AVP group in the\n   Diameter\
    \ request.  The following steps are applied to the response\n   message during\
    \ the Diameter-to-RADIUS translation:\n      -  If the Diameter Command-Code is\
    \ set to AA-Answer and the\n         Result-Code AVP is set to DIAMETER_MULTI_ROUND_AUTH,\
    \ the\n         gateway must send a RADIUS Access-Challenge.  This must have\n\
    \         the Origin-Host, Origin-Realm, and Diameter Session-Id AVPs\n      \
    \   encapsulated in the RADIUS State attribute, with the prefix\n         \"Diameter/\"\
    , concatenated in the above order separated with \"/\"\n         characters, in\
    \ UTF-8 [UTF-8].  This is necessary to ensure that\n         the Translation Agent\
    \ receiving the subsequent RADIUS Access-\n         Request will have access to\
    \ the Session Identifier and be able\n         to set the Destination-Host to\
    \ the correct value.  If the\n         Multi-Round-Time-Out AVP is present, the\
    \ value of the AVP MUST\n         be inserted in the RADIUS Session-Timeout AVP.\n\
    \      -  If the Command-Code is set to AA-Answer, the Diameter Session-\n   \
    \      Id AVP is saved in a new RADIUS Class attribute whose format\n        \
    \ consists of the string \"Diameter/\" followed by the Diameter\n         Session\
    \ Identifier.  This will ensure that the subsequent\n         Accounting messages,\
    \ which could be received by any Translation\n         Agent, would have access\
    \ to the original Diameter Session\n         Identifier.\n      -  If a Proxy-State\
    \ attribute was present in the RADIUS request,\n         the same attribute is\
    \ added in the response.  This information\n         may be found in the Proxy-Info\
    \ AVP group, or in a local state\n         table.\n      -  If state information\
    \ regarding the RADIUS request was saved in\n         a Proxy-Info AVP or local\
    \ state table, the RADIUS Identifier\n         and UDP IP Address and port number\
    \ are extracted and used in\n         issuing the RADIUS reply.\n   When translating\
    \ a Diameter AA-Answer (with successful result code)\n   to RADIUS Access-Accept\
    \ that contains a Session-Timeout or\n   Authorization-Lifetime AVP, take the\
    \ following steps:\n      -  If the Diameter message contains a Session-Timeout\
    \ AVP but no\n         Authorization-Lifetime AVP, translate it to a Session-Timeout\n\
    \         attribute (not a Termination-Action).\n      -  If the Diameter message\
    \ contains an Authorization-Lifetime AVP\n         but no Session-Timeout AVP,\
    \ translate it to a Session-Timeout\n         attribute and a Termination-Action\
    \ set to AA-REQUEST.  (Remove\n         Authorization-Lifetime and Re-Auth-Request-Type.)\n\
    \      -  If the Diameter message has both, the Session-Timeout must be\n    \
    \     greater than or equal to the Authorization-Lifetime (required\n        \
    \ by [BASE]).  Translate it to a Session-Timeout value (with\n         value from\
    \ Authorization-Lifetime AVP, the smaller one) and\n         with the Termination-Action\
    \ set to AA-REQUEST.  (Remove the\n         Authorization-Lifetime and Re-Auth-Request-Type.)\n"
- title: 9.1.1.  RADIUS Dynamic Authorization Considerations
  contents:
  - "9.1.1.  RADIUS Dynamic Authorization Considerations\n   A Diameter/RADIUS gateway\
    \ may communicate with a server that\n   implements RADIUS Dynamic Authorization\
    \ [RADDynAuth].  If the server\n   supports these functions, it MUST be listening\
    \ on the assigned port\n   and would receive RADIUS CoA-Request and Disconnect-Request\
    \ messages.\n   These can be mapped into the Diameter Re-Auth-Request (RAR) and\n\
    \   Abort-Session-Request (ASR) message exchanges, respectively [BASE].\n   If\
    \ the [RADDynAuth] is not supported, the port would not be active\n   and the\
    \ RADIUS server would receive an ICMP Port Unreachable\n   indication.  Alternatively,\
    \ if the messages are received but with an\n   inappropriate Service-Type, the\
    \ gateway can respond with the\n   appropriate NAK message and an Error-Cause\
    \ attribute with the value\n   of 405, \"Unsupported Service\".\n   The RADIUS\
    \ CoA-Request and Disconnect-Request messages will not\n   contain a Diameter\
    \ Session-Id.  Diameter requires that this value\n   match an active session context.\
    \  The gateway MUST have a session Id\n   cache (or other means) to identify the\
    \ sessions these functions\n   pertain to.  If unable to identify the session,\
    \ the gateway (or NAS)\n   should return an Error-Cause value 503, \"Session Context\
    \ Not Found\".\n   The RADIUS CoA-Request message only supports a change of\n\
    \   authorization attributes, and the received CoA-Request SHOULD include\n  \
    \ a Service-Type of \"Authorize-Only\".  This indicates an extended\n   exchange\
    \ request by the rules given in [RADDynAuth] section 3.2, note\n   6.  This is\
    \ the only type of exchange supported by Diameter [BASE].\n   For the CoA-Request,\
    \ the translated RAR message will have a Re-Auth-\n   Type of AUTHORIZE_ONLY.\
    \  The returned RAA will be translated into a\n   CoA-NAK with Error-Cause \"\
    Request Initiated\".  The gateway's Diameter\n   client SHOULD also start a reauthorization\
    \ sequence by sending an AAR\n   message, which will be translated into an Access-Request\
    \ message.\n   The RADIUS server will use the Access-Accept (or Access-Reject)\n\
    \   message to convey the new authorization attributes, which the gateway\n  \
    \ will pass back in an AAA message.\n   Any attributes included in the COA-Request\
    \ or Access-Accept message\n   are to be considered mandatory in Diameter.  If\
    \ they cannot be\n   supported, they MUST result in an error message return to\
    \ the RADIUS\n   server, with an Error-Cause of \"Unsupported Attribute\".  The\
    \ Diameter\n   NAS will attempt to apply all the attributes supplied in the AA\n\
    \   message to the session.\n   A RADIUS Disconnect-Request message received by\
    \ the gateway would be\n   translated to a Diameter Abort-Session-Request (ASR)\
    \ message [BASE].\n   The results will be returned by the Diameter client in an\
    \ Abort-\n   Session-Answer (ASA) message.  A success indication would translate\n\
    \   to a RADIUS Disconnect-ACK, and a failure would generate a\n   Disconnect-NAK.\n"
- title: 9.2.  Diameter Request Forwarded as RADIUS Request
  contents:
  - "9.2.  Diameter Request Forwarded as RADIUS Request\n   When a server receives\
    \ a Diameter request to be forwarded to a RADIUS\n   entity, the following are\
    \ examples of the steps that may be taken:\n      -  The Origin-Host AVP's value\
    \ is inserted into the NAS-Identifier\n         attribute.\n      -  The following\
    \ information MUST be present in the corresponding\n         Diameter response\
    \ and therefore MUST be saved, either in a\n         local state table or encoded\
    \ in a RADIUS Proxy-State attribute:\n            1. Origin-Host AVP\n       \
    \     2. Session-Id AVP\n            3. Proxy-Info AVP\n            4. Any other\
    \ AVP that MUST be present in the response and\n               has no corresponding\
    \ RADIUS attribute.\n      -  If the CHAP-Auth AVP is present, the grouped AVPs\
    \ are used to\n         create the RADIUS CHAP-Password attribute data.\n    \
    \  -  If the User-Password AVP is present, the data should be\n         encrypted\
    \ and forwarded by using RADIUS rules.  The same is\n         true for any other\
    \ RADIUS-encrypted attribute values.\n      -  AVPs of the type Address must be\
    \ translated to the\n         corresponding RADIUS attribute.\n      -  If the\
    \ Accounting-Input-Octets, Accounting-Input-Packets,\n         Accounting-Output-Octets,\
    \ or Accounting-Output-Packets AVPs are\n         present, they must be translated\
    \ to the corresponding RADIUS\n         attributes.  If the value of the Diameter\
    \ AVPs do not fit\n         within a 32-bit RADIUS attribute, the RADIUS Acct-Input-\n\
    \         Gigawords and Acct-Output-Gigawords must be used.\n      -  If the RADIUS\
    \ link supports the Message-Authenticator attribute\n         [RADIUSExt], it\
    \ SHOULD be generated and added to the request.\n   When the corresponding response\
    \ is received by the Translation Agent,\n   which is guaranteed in the RADIUS\
    \ protocol, the following steps may\n   be taken:\n      -  If the RADIUS code\
    \ is set to Access-Challenge, a Diameter AA-\n         Answer message is created\
    \ with the Result-Code set to\n         DIAMETER_MULTI_ROUND_AUTH.  If the Session-Timeout\
    \ AVP is\n         present in the RADIUS message, its value is inserted into the\n\
    \         Multi-Round-Time-Out AVP.\n      - If a Proxy-State attribute is present,\
    \ extract the encoded\n         information; otherwise, retrieve the original\
    \ Proxy-Info AVP\n         group information from the local state table.\n   \
    \   -  The response's Origin-Host information is created from the FQDN\n     \
    \    of the RADIUS message's source IP address.  The same FQDN is\n         also\
    \ stored to a Route-Record AVP.\n      -  The response's Destination-Host AVP\
    \ is copied from the saved\n         request's Origin-Host information.\n    \
    \  -  The Session-Id information can be recovered from local state,\n        \
    \ or from the constructed State or Proxy-State attribute, as\n         above.\n\
    \      -  If a Proxy-Info AVP was present in the request, the same AVP\n     \
    \    MUST be added to the response.\n      -  If the RADIUS State attributes are\
    \ present, they must be\n         present in the Diameter response, minus those\
    \ added by the\n         gateway.\n      -  Any other AVPs that were saved at\
    \ request time, and that MUST\n         be present in the response, are added\
    \ to the message.\n   When translating a RADIUS Access-Accept to Diameter AA-Answer\
    \ that\n   contains a Session-Timeout attribute, do the following:\n      -  If\
    \ the RADIUS message contains a Session-Timeout attribute and\n         a Termination-Action\
    \ attribute set to DEFAULT (or no\n         Termination-Action attribute at all),\
    \ translate it to AA-Answer\n         with a Session-Timeout AVP and remove the\
    \ Termination-Action\n         attribute.\n      -  If the RADIUS message contains\
    \ a Session-Timeout attribute and\n         a Termination-Action attribute set\
    \ to AA-REQUEST, translate it\n         to AA-Answer with Authorization-Lifetime\
    \ AVP and with Re-Auth-\n         Request-Type set to AUTHORIZE_AUTHENTICATE and\
    \ remove the\n         Session-Timeout attribute.\n"
- title: 9.2.1.  RADIUS Dynamic Authorization Considerations
  contents:
  - "9.2.1.  RADIUS Dynamic Authorization Considerations\n   A RADIUS/Diameter gateway\
    \ communicating with a RADIUS client that\n   implements RADIUS Dynamic Authorization\
    \ [RADDynAuth] may translate\n   Diameter Re-Auth-Request (RAR) messages and Abort-Session-Request\n\
    \   (ASR) messages [BASE] into RADIUS CoA-Request and Disconnect-Request\n   messages\
    \ respectively.\n   If the RADIUS client does not support the capability, the\
    \ gateway\n   will receive an ICMP Port Unreachable indication when it transmits\n\
    \   the RADIUS message.  Even if the NAS supports [RADDynAuth], it may\n   not\
    \ support the Service-Type in the request message.  In this case it\n   will respond\
    \ with a NAK message and (optionally) an Error-Cause\n   attribute with value\
    \ 405, \"Unsupported Service\".  If the gateway\n   encounters these error conditions,\
    \ or if it does not support\n   [RADDynAuth], it sends a Diameter Answer message\
    \ with an Result-Code\n   AVP of \"DIAMETER_COMMAND_UNSUPPORTED\" to the AAA server.\n\
    \   When encoding the RADIUS messages, the gateway MUST include the\n   Diameter\
    \ Session-ID in the RADIUS State attribute value, as mentioned\n   above.  The\
    \ RADIUS client should return it in the response.\n   A Diameter Re-Auth-Request\
    \ (RAR) message [BASE] received by the\n   gateway will be translated into a RADIUS\
    \ CoA-Request and sent to the\n   RADIUS client.  The RADIUS client should respond\
    \ with a CoA-ACK or\n   CoA-NAK message, which the gateway should translate into\
    \ a Re-Auth-\n   Answer (RAA) message.\n   If the gateway receives a RADIUS CoA-NAK\
    \ response containing a\n   Service-Type Attribute with value \"Authorize Only\"\
    \ and an Error-Cause\n   Attribute with value \"Request Initiated\", this indicates\
    \ an extended\n   exchange request per [RADDynAuth] section 3.2, note 6.\n   The\
    \ response is translated to a Diameter Re-Auth-Answer (RAA) with a\n   Result-Code\
    \ AVP of \"DIAMETER_LIMITED_SUCCESS\" sent to the AAA server.\n   Subsequently,\
    \ the gateway should receive a RADIUS Access-Request from\n   the NAS, with a\
    \ Service-Type of \"Authorize Only\".  This is translated\n   into a Diameter\
    \ AA-Request with an Auth-Request-Type AVP of\n   AUTHORIZE_ONLY and sent to the\
    \ AAA server.  The AAA server will then\n   reply with a Diameter AA-Answer, which\
    \ is translated into a RADIUS\n   Access-Accept or Access-Reject, depending on\
    \ the value of the\n   Result-Code AVP.\n   A Diameter Abort-Session-Request (ASR)\
    \ message [BASE] received by the\n   gateway will be translated into a RADIUS\
    \ Disconnect-Request and sent\n   to the RADIUS client.  The RADIUS client should\
    \ respond with a\n   Disconnect-ACK or Disconnect-NAK message, which the gateway\
    \ should\n   translate into an Abort-Session-Answer (ASA) message.\n   If the\
    \ gateway receives a RADIUS Disconnect-NAK response containing a\n   Service-Type\
    \ Attribute with value \"Authorize Only\" and an Error-Cause\n   Attribute with\
    \ value \"Request Initiated\", the Disconnect-NAK response\n   is translated into\
    \ a Diameter Abort-Session-Answer (ASA) with a\n   Result-Code AVP of \"DIAMETER_LIMITED_SUCCESS\"\
    \ sent to the AAA server.\n   Subsequently, the gateway should receive a RADIUS\
    \ Access-Request from\n   the NAS, with a Service-Type of \"Authorize Only\".\
    \  This is translated\n   into a Diameter AA-Request with an Auth-Request-Type\
    \ AVP of\n   AUTHORIZE_ONLY and sent to the AAA server.  The AAA server will then\n\
    \   reply with a Diameter AA-Answer, which is translated into a RADIUS\n   Access-Accept\
    \ or Access-Reject, depending on the value of the\n   Result-Code AVP.\n"
- title: 9.3.  AVPs Used Only for Compatibility
  contents:
  - "9.3.  AVPs Used Only for Compatibility\n   The AVPs defined in this section SHOULD\
    \ only be used for backwards\n   compatibility when a Diameter/RADIUS translation\
    \ function is invoked\n   and are not typically originated by Diameter systems\
    \ during normal\n   operations.\n                                            +---------------------+\n\
    \                                            |    AVP Flag rules   |\n       \
    \                                     |----+-----+----+-----|----+\n         \
    \          AVP  Section             |    |     |SHLD| MUST|    |\n   Attribute\
    \ Name  Code Defined  Value Type |MUST| MAY | NOT|  NOT|Encr|\n   -----------------------------------------|----+-----+----+-----|----|\n\
    \   NAS-Identifier    32  9.3.1   UTF8String | M  |  P  |    |  V  | Y  |\n  \
    \ NAS-IP-Address     4  9.3.2   OctetString| M  |  P  |    |  V  | Y  |\n   NAS-IPv6-Address\
    \  95  9.3.3   OctetString| M  |  P  |    |  V  | Y  |\n   State             24\
    \  9.3.4   OctetString| M  |  P  |    |  V  | Y  |\n   Termination-     295  9.3.5\
    \   Enumerated | M  |  P  |    |  V  | Y  |\n      Cause                     \
    \            |    |     |    |     |    |\n   Origin-AAA-      408  9.3.6   Enumerated\
    \ | M  |  P  |    |  V  | Y  |\n      Protocol                              |\
    \    |     |    |     |    |\n   -----------------------------------------|----+-----+----+-----|----|\n"
- title: 9.3.1.  NAS-Identifier AVP
  contents:
  - "9.3.1.  NAS-Identifier AVP\n   The NAS-Identifier AVP (AVP Code 32) [RADIUS]\
    \ is of type UTF8String\n   and contains the identity of the NAS providing service\
    \ to the user.\n   This AVP SHOULD only be added by a RADIUS/Diameter Translation\
    \ Agent.\n   When this AVP is present, the Origin-Host AVP identifies the NAS\n\
    \   providing service to the user.\n   In RADIUS it would be possible for a rogue\
    \ NAS to forge the NAS-\n   Identifier attribute.  Diameter/RADIUS translation\
    \ agents SHOULD\n   attempt to check a received NAS-Identifier attribute against\
    \ the\n   source address of the RADIUS packet, by doing an A/AAAA RR query.  If\n\
    \   the NAS-Identifier attribute contains an FQDN, then such a query\n   would\
    \ resolve to an IP address matching the source address.  However,\n   the NAS-Identifier\
    \ attribute is not required to contain an FQDN, so\n   such a query could fail.\
    \  If it fails, an error should be logged, but\n   no action should be taken,\
    \ other than a reverse lookup on the source\n   address and insert the resulting\
    \ FQDN into the Route-Record AVP.\n   Diameter agents and servers SHOULD check\
    \ whether a NAS-Identifier AVP\n   corresponds to an entry in the Route-Record\
    \ AVP.  If no match is\n   found, then an error is logged, but no other action\
    \ is taken.\n"
- title: 9.3.2.  NAS-IP-Address AVP
  contents:
  - "9.3.2.  NAS-IP-Address AVP\n   The NAS-IP-Address AVP (AVP Code 4) [RADIUS] is\
    \ of type OctetString\n   and contains the IP Address of the NAS providing service\
    \ to the user.\n   This AVP SHOULD only be added by a RADIUS/Diameter Translation\
    \ Agent.\n   When this AVP is present, the Origin-Host AVP identifies the NAS\n\
    \   providing service to the user.\n   In RADIUS it would be possible for a rogue\
    \ NAS to forge the NAS-IP-\n   Address attribute value.  Diameter/RADIUS translation\
    \ agents MUST\n   check a received NAS-IP-Address or NAS-IPv6-Address attribute\
    \ against\n   the source address of the RADIUS packet.  If they do not match and\n\
    \   the Diameter/RADIUS translation agent does not know whether the\n   packet\
    \ was sent by a RADIUS proxy or NAS (e.g., no Proxy-State\n   attribute), then\
    \ by default it is assumed that the source address\n   corresponds to a RADIUS\
    \ proxy, and that the NAS Address is behind\n   that proxy, potentially with some\
    \ additional RADIUS proxies in\n   between.  The Diameter/RADIUS translation agent\
    \ MUST insert entries\n   in the Route-Record AVP corresponding to the apparent\
    \ route.  This\n   implies doing a reverse lookup on the source address and NAS-IP-\n\
    \   Address or NAS-IPv6-Address attributes to determine the corresponding\n  \
    \ FQDNs.\n   If the source address and the NAS-IP-Address or NAS-IPv6-Address\
    \ do\n   not match, and the Diameter/RADIUS translation agent knows that it is\n\
    \   talking directly to the NAS (e.g., there are no RADIUS proxies\n   between\
    \ it and the NAS), then the error should be logged, and the\n   packet MUST be\
    \ discarded.\n   Diameter agents and servers MUST check whether the NAS-IP-Address\
    \ AVP\n   corresponds to an entry in the Route-Record AVP.  This is done by\n\
    \   doing a reverse lookup (PTR RR) for the NAS-IP-Address to retrieve\n   the\
    \ corresponding FQDN, and by checking for a match with the Route-\n   Record AVP.\
    \  If no match is found, then an error is logged, but no\n   other action is taken.\n"
- title: 9.3.3.  NAS-IPv6-Address AVP
  contents:
  - "9.3.3.  NAS-IPv6-Address AVP\n   The NAS-IPv6-Address AVP (AVP Code 95) [RADIUSIPv6]\
    \ is of type\n   OctetString and contains the IPv6 Address of the NAS providing\n\
    \   service to the user.  This AVP SHOULD only be added by a\n   RADIUS/Diameter\
    \ Translation Agent.  When this AVP is present, the\n   Origin-Host AVP identifies\
    \ the NAS providing service to the user.\n   In RADIUS it would be possible for\
    \ a rogue NAS to forge the NAS-\n   IPv6-Address attribute.  Diameter/RADIUS translation\
    \ agents MUST\n   check a received NAS-IPv6-Address attribute against the source\n\
    \   address of the RADIUS packet.  If they do not match and the\n   Diameter/RADIUS\
    \ translation agent does not know whether the packet\n   was sent by a RADIUS\
    \ proxy or NAS (e.g., no Proxy-State attribute),\n   then by default it is assumed\
    \ that the source address corresponds to\n   a RADIUS proxy, and that the NAS-IPv6-Address\
    \ is behind that proxy,\n   potentially with some additional RADIUS proxies in\
    \ between.  The\n   Diameter/RADIUS translation agent MUST insert entries in the\
    \ Route-\n   Record AVP corresponding to the apparent route.  This implies doing\
    \ a\n   reverse lookup on the source address and NAS-IPv6-Address attributes\n\
    \   to determine the corresponding FQDNs.\n   If the source address and the NAS-IPv6-Address\
    \ do not match, and the\n   Diameter/RADIUS translation agent knows that it is\
    \ talking directly\n   to the NAS (e.g., there are no RADIUS proxies between it\
    \ and the\n   NAS), then the error should be logged, and the packet MUST be\n\
    \   discarded.\n   Diameter agents and servers MUST check whether the NAS-IPv6-Address\n\
    \   AVP corresponds to an entry in the Route-Record AVP.  This is done by\n  \
    \ doing a reverse lookup (PTR RR) for the NAS-IPv6-Address to retrieve\n   the\
    \ corresponding FQDN, and by checking for a match with the Record-\n   Route AVP.\
    \  If no match is found, then an error is logged, but no\n   other action is taken.\n"
- title: 9.3.4.  State AVP
  contents:
  - "9.3.4.  State AVP\n   The State AVP (AVP Code 24) [RADIUS] is of type OctetString\
    \ and has\n   two uses in the Diameter NAS application.\n   The State AVP MAY\
    \ be sent by a Diameter Server to a NAS in an AA-\n   Response command that contains\
    \ a Result-Code of\n   DIAMETER_MULTI_ROUND_AUTH.  If so, the NAS MUST return\
    \ it unmodified\n   in the subsequent AA-Request command.\n   The State AVP MAY\
    \ also be sent by a Diameter Server to a NAS in an\n   AA-Response command that\
    \ also includes a Termination-Action AVP with\n   the value of AA-REQUEST.  If\
    \ the NAS performs the Termination-Action\n   by sending a new AA-Request command\
    \ upon termination of the current\n   service, it MUST return the State AVP unmodified\
    \ in the new request\n   command.\n   In either usage, the NAS MUST NOT interpret\
    \ the AVP locally.  Usage\n   of the State AVP is implementation dependent.\n"
- title: 9.3.5.  Termination-Cause AVP Code Values
  contents:
  - "9.3.5.  Termination-Cause AVP Code Values\n   This section defines a mapping\
    \ between Termination-Cause AVP code\n   values and RADIUS Acct-Terminate-Cause\
    \ attribute code values from RFC\n   2866 [RADIUSAcct] and [RADIUSTypes], thereby\
    \ allowing a\n   RADIUS/Diameter Translation Agent to convert between the attribute\n\
    \   and AVP values.  This section thus extends the definitions in the\n   \"Termination-Cause\
    \ AVP\" section of the Base Diameter specification.\n   The table in this section\
    \ defines the mapping between Termination-\n   Cause AVP and RADIUS Acct-Terminate-Cause\
    \ causes.\n                                 +-----------------------+\n      \
    \                           |         Value         |\n                      \
    \           +-----------+-----------+\n   Cause Value Name              |  RADIUS\
    \   | Diameter  |\n   ------------------------------|-----------+-----------+\n\
    \   User Request                  |     1     |   11      |\n   Lost Carrier \
    \                 |     2     |   12      |\n   Lost Service                 \
    \ |     3     |   13      |\n   Idle Timeout                  |     4     |  \
    \ 14      |\n   Session Timeout               |     5     |   15      |\n   Admin\
    \ Reset                   |     6     |   16      |\n   Admin Reboot         \
    \         |     7     |   17      |\n   Port Error                    |     8\
    \     |   18      |\n   NAS Error                     |     9     |   19     \
    \ |\n   NAS Request                   |     10    |   20      |\n   NAS Reboot\
    \                    |     11    |   21      |\n   Port Unneeded             \
    \    |     12    |   22      |\n   Port Preempted                |     13    |\
    \   23      |\n   Port Suspended                |     14    |   24      |\n  \
    \ Service Unavailable           |     15    |   25      |\n   Callback       \
    \               |     16    |   26      |\n   User Error                    |\
    \     17    |   27      |\n   Host Request                  |     18    |   28\
    \      |\n   Supplicant Restart            |     19    |   29      |  [RAD802.1X]\n\
    \   Reauthentication Failure      |     20    |   30      |  [RAD802.1X]\n   Port\
    \ Reinit                   |     21    |   31      |  [RAD802.1X]\n   Port Disabled\
    \                 |     22    |   32      |  [RAD802.1X]\n   ------------------------------|-----------+-----------+\n\
    \   From RFC 2866, the termination causes are as follows:\n   User Request   \
    \      User requested termination of service, for\n                        example\
    \ with LCP Terminate or by logging out.\n   Lost Carrier         DCD was dropped\
    \ on the port.\n   Lost Service         Service can no longer be provided; for\n\
    \                        example, user's connection to a host was\n          \
    \              interrupted.\n   Idle Timeout         Idle timer expired.\n   Session\
    \ Timeout      Maximum session length timer expired.\n   Admin Reset         \
    \ Administrator reset the port or session.\n   Admin Reboot         Administrator\
    \ is ending service on the NAS,\n                        for example, prior to\
    \ rebooting the NAS.\n   Port Error           NAS detected an error on the port\
    \ that\n                        required ending the session.\n   NAS Error   \
    \         NAS detected an error (other than on the\n                        port)\
    \ that required ending the session.\n   NAS Request          NAS ended the session\
    \ for a non-error reason not\n                        otherwise listed here.\n\
    \   NAS Reboot           NAS ended the session to reboot\n                   \
    \     non-administratively (\"crash\").\n   Port Unneeded        NAS ended the\
    \ session because resource usage\n                        fell below a low-water\
    \ mark (for example, if\n                        a bandwidth-on-demand algorithm\
    \ decided that\n                        the port was no longer needed).\n   Port\
    \ Preempted       NAS ended the session to allocate the\n                    \
    \    port to a higher priority use.\n   Port Suspended       NAS ended the session\
    \ to suspend a virtual\n                        session.\n   Service Unavailable\
    \  NAS was unable to provide requested service.\n   Callback             NAS is\
    \ terminating the current session\n                        to perform callback\
    \ for a new session.\n   User Error           Input from user is in error, causing\n\
    \                        session termination.\n   Host Request         Login Host\
    \ terminated session normally.\n"
- title: 9.3.6.  Origin-AAA-Protocol
  contents:
  - "9.3.6.  Origin-AAA-Protocol\n   The Origin-AAA-Protocol AVP (AVP Code 408) is\
    \ of the type Enumerated\n   and should be inserted in a Diameter message translated\
    \ by a gateway\n   system from another AAA protocol, such as RADIUS.  It identifies\
    \ the\n   source protocol of the message to the Diameter system receiving the\n\
    \   message.\n   The supported values are:\n         1       RADIUS\n"
- title: 9.4.  Prohibited RADIUS Attributes
  contents:
  - "9.4.  Prohibited RADIUS Attributes\n   The following RADIUS attributes MUST NOT\
    \ appear in a Diameter\n   message.  Instead, they are translated to other Diameter\
    \ AVPs or\n   handled in some special manner.  The rules for the treatment of\
    \ the\n   attributes are discussed in sections 9.1, 9.2, and 9.6.\n   Attribute\
    \ Description       Defined     Nearest Diameter AVP\n   -----------------------------------------------------------------\n\
    \    3 CHAP-Password            RFC 2865    CHAP-Auth Group\n   26 Vendor-Specific\
    \          RFC 2865    Vendor Specific AVP\n   29 Termination-Action       RFC\
    \ 2865    Authorization-Lifetime\n   40 Acct-Status-Type         RFC 2866    Accounting-Record-Type\n\
    \   42 Acct-Input-Octets        RFC 2866    Accounting-Input-Octets\n   43 Acct-Output-Octets\
    \       RFC 2866    Accounting-Output-Octets\n   47 Acct-Input-Packets       RFC\
    \ 2866    Accounting-Input-Packets\n   48 Acct-Output-Packets      RFC 2866  \
    \  Accounting-Output-Packets\n   49 Acct-Terminate-Cause     RFC 2866    Termination-Cause\n\
    \   52 Acct-Input-Gigawords     RFC 2869    Accounting-Input-Octets\n   53 Acct-Output-Gigawords\
    \    RFC 2869    Accounting-Output-Octets\n   80 Message-Authenticator    RFC\
    \ 2869    none - check and discard\n"
- title: 9.5.  Translatable Diameter AVPs
  contents:
  - "9.5.  Translatable Diameter AVPs\n   In general, Diameter AVPs that are not RADIUS\
    \ compatible have code\n   values greater than 255.  The table in the section\
    \ above shows the\n   AVPs that can be converted into RADIUS attributes.\n   Another\
    \ problem may occur with Diameter AVP values that may be more\n   than 253 octets\
    \ in length.  Some RADIUS attributes (including but not\n   limited to (8)Reply-Message,\
    \ (79)EAP-Message, and (77)Connect-Info)\n   allow concatenation of multiple instances\
    \ to overcome this\n   limitation.  If this is not possible, a Result-Code of\n\
    \   DIAMETER_INVALID_AVP_LENGTH should be returned.\n"
- title: 9.6.  RADIUS Vendor Specific Attributes
  contents:
  - "9.6.  RADIUS Vendor Specific Attributes\n   RADIUS supports the inclusion of\
    \ Vendor Specific Attributes (VSAs)\n   through the use of attribute 26.  The\
    \ recommended format [RADIUS] of\n   the attribute data field includes a 4 octet\
    \ vendor code followed by a\n   one octet vendor type field and a one octet length\
    \ field.  The last\n   two fields MAY be repeated.\n   A system communicating\
    \ between Diameter and RADIUS MAY have specific\n   knowledge of vendor formats,\
    \ and MAY be able to translate between the\n   two formats.  However, given the\
    \ deployment of many RADIUS vendor\n   formats that do not follow the example\
    \ format in RFC 2865 [RADIUS],\n   (e.g., those that use a longer vendor type\
    \ code) the translations in\n   the next two sections will not work in general\
    \ for those VSAs.  RFC\n   2865 states that a robust implementation SHOULD support\
    \ the field as\n   undistinguished octets.\n   Systems that don't have vendor\
    \ format knowledge MAY discard such\n   attributes without knowing a suitable\
    \ translation.  An alternative\n   format is under consideration [VSA], which\
    \ proposes encodings that\n   would preserve the native information and not require\
    \ vendor\n   knowledge in the gateway system.\n   The following sections are an\
    \ example for translating RADIUS VSAs\n   that use the example RADIUS format,\
    \ and Diameter VSAs that have type\n   codes less than 255, and value field lengths\
    \ less than 252.\n"
- title: 9.6.1.  Forwarding a Diameter Vendor Specific AVP as a RADIUS VSA
  contents:
  - "9.6.1.  Forwarding a Diameter Vendor Specific AVP as a RADIUS VSA\n   For Type\
    \ codes less than 255, the value field length MUST be less\n   than 252 or the\
    \ AVP will be discarded.  The RADIUS VSA attribute\n   should consist of the following\
    \ fields;\n      RADIUS Type = 26, Vendor Specific Attribute\n      RADIUS Length\
    \ = total length of attribute (header + data)\n      RADIUS Vendor code = Diameter\
    \ Vendor code\n      RADIUS Vendor type code = low order byte of Diameter AVP\
    \ code\n      RADIUS Vendor data length = length of Diameter data\n   If the Diameter\
    \ AVP code is greater than 255, then the RADIUS\n   speaking code may use a Vendor\
    \ specific field coding, if it knows one\n   for that vendor.  Otherwise, the\
    \ AVP will be ignored.  If it is\n   flagged as Mandatory, a \"DIAMETER_AVP_UNSUPPORTED\"\
    \ Result-Code will\n   be returned, and the RADIUS message will not be sent.\n"
- title: 9.6.2.  Forwarding a RADIUS VSA as a Diameter Vendor Specific AVP
  contents:
  - "9.6.2.  Forwarding a RADIUS VSA as a Diameter Vendor Specific AVP\n   The Diameter\
    \ AVP will consist of the following fields:\n      Diameter Flags: V=1, M=0, P=0\n\
    \      Diameter Vendor code = RADIUS VSA Vendor code\n      Diameter AVP code\
    \ = RADIUS VSA Vendor type code\n      Diameter AVP length = length of AVP (header\
    \ + data)\n      Diameter Data = RADIUS VSA vendor data\n   Note that the VSAs\
    \ are considered optional by RADIUS rules, and this\n   specification does not\
    \ set the Mandatory flag.  If an implementor\n   desires a VSA be made mandatory\
    \ because it represents a required\n   service policy, the RADIUS gateway should\
    \ have a process to set the\n   bit on the Diameter side.\n   If the RADIUS receiving\
    \ code knows of vendor specific field\n   interpretations for the specific vendor,\
    \ it may employ them to parse\n   an extended AVP code or data length.  Otherwise\
    \ the recommended\n   standard fields will be used.\n   Nested Multiple vendor\
    \ data fields MUST be expanded into multiple\n   Diameter AVPs.\n"
- title: 10.  AVP Occurrence Tables
  contents:
  - "10.  AVP Occurrence Tables\n   The following tables present the AVPs used by\
    \ NAS applications in NAS\n   messages and specify in which Diameter messages\
    \ they MAY or MAY NOT\n   be present.  [BASE] messages and AVPs are not described\
    \ in this\n   document.  Note that AVPs that can only be present within a Grouped\n\
    \   AVP are not represented in this table.\n   The table uses the following symbols:\n\
    \      0     The AVP MUST NOT be present in the message.\n      0+    Zero or\
    \ more instances of the AVP MAY be present in the\n            message.\n    \
    \  0-1   Zero or one instance of the AVP MAY be present in the\n            message.\n\
    \      1     One instance of the AVP MUST be present in the message.\n"
- title: 10.1.  AA-Request/Answer AVP Table
  contents:
  - "10.1.  AA-Request/Answer AVP Table\n   The table in this section is limited to\
    \ the Command Codes defined in\n   this specification.\n                     \
    \            +-----------+\n                                 |  Command  |\n \
    \                                |-----+-----+\n   Attribute Name            \
    \    | AAR | AAA |\n   ------------------------------|-----+-----+\n   Acct-Interim-Interval\
    \         | 0   | 0-1 |\n   ARAP-Challenge-Response       | 0   | 0-1 |\n   ARAP-Features\
    \                 | 0   | 0-1 |\n   ARAP-Password                 | 0-1 | 0  \
    \ |\n   ARAP-Security                 | 0-1 | 0-1 |\n   ARAP-Security-Data   \
    \         | 0+  | 0+  |\n   ARAP-Zone-Access              | 0   | 0-1 |\n   Auth-Application-Id\
    \           | 1   | 1   |\n   Auth-Grace-Period             | 0-1 | 0-1 |\n  \
    \ Auth-Request-Type             | 1   | 1   |\n   Auth-Session-State         \
    \   | 0-1 | 0-1 |\n   Authorization-Lifetime        | 0-1 | 0-1 |\n   ------------------------------|-----+-----+\n\
    \                                 +-----------+\n                            \
    \     |  Command  |\n                                 |-----+-----+\n   Attribute\
    \ Name                | AAR | AAA |\n   ------------------------------|-----+-----+\n\
    \   Callback-Id                   | 0   | 0-1 |\n   Callback-Number          \
    \     | 0-1 | 0-1 |\n   Called-Station-Id             | 0-1 | 0   |\n   Calling-Station-Id\
    \            | 0-1 | 0   |\n   CHAP-Auth                     | 0-1 | 0   |\n \
    \  CHAP-Challenge                | 0-1 | 0   |\n   Class                     \
    \    | 0   | 0+  |\n   Configuration-Token           | 0   | 0+  |\n   Connect-Info\
    \                  | 0+  | 0   |\n   Destination-Host              | 0-1 | 0 \
    \  |\n   Destination-Realm             | 1   | 0   |\n   Error-Message       \
    \          | 0   | 0-1 |\n   Error-Reporting-Host          | 0   | 0-1 |\n   Failed-AVP\
    \                    | 0+  | 0+  |\n   Filter-Id                     | 0   | 0+\
    \  |\n   Framed-Appletalk-Link         | 0   | 0-1 |\n   Framed-Appletalk-Network\
    \      | 0   | 0+  |\n   Framed-Appletalk-Zone         | 0   | 0-1 |\n   Framed-Compression\
    \            | 0+  | 0+  |\n   Framed-Interface-Id           | 0-1 | 0-1 |\n \
    \  Framed-IP-Address             | 0-1 | 0-1 |\n   Framed-IP-Netmask         \
    \    | 0-1 | 0-1 |\n   Framed-IPv6-Prefix            | 0+  | 0+  |\n   Framed-IPv6-Pool\
    \              | 0   | 0-1 |\n   Framed-IPv6-Route             | 0   | 0+  |\n\
    \   Framed-IPX-Network            | 0   | 0-1 |\n   Framed-MTU               \
    \     | 0-1 | 0-1 |\n   Framed-Pool                   | 0   | 0-1 |\n   Framed-Protocol\
    \               | 0-1 | 0-1 |\n   Framed-Route                  | 0   | 0+  |\n\
    \   Framed-Routing                | 0   | 0-1 |\n   Idle-Timeout             \
    \     | 0   | 0-1 |\n   Login-IP-Host                 | 0+  | 0+  |\n   Login-IPv6-Host\
    \               | 0+  | 0+  |\n   Login-LAT-Group               | 0-1 | 0-1 |\n\
    \   Login-LAT-Node                | 0-1 | 0-1 |\n   Login-LAT-Port           \
    \     | 0-1 | 0-1 |\n   Login-LAT-Service             | 0-1 | 0-1 |\n   Login-Service\
    \                 | 0   | 0-1 |\n   Login-TCP-Port                | 0   | 0-1\
    \ |\n   Multi-Round-Time-Out          | 0   | 0-1 |\n   ------------------------------|-----+-----+\n\
    \                                 +-----------+\n                            \
    \     |  Command  |\n                                 |-----+-----+\n   Attribute\
    \ Name                | AAR | AAA |\n   ------------------------------|-----+-----+\n\
    \   NAS-Filter-Rule               | 0   | 0+  |\n   NAS-Identifier           \
    \     | 0-1 | 0   |\n   NAS-IP-Address                | 0-1 | 0   |\n   NAS-IPv6-Address\
    \              | 0-1 | 0   |\n   NAS-Port                      | 0-1 | 0   |\n\
    \   NAS-Port-Id                   | 0-1 | 0   |\n   NAS-Port-Type            \
    \     | 0-1 | 0   |\n   Origin-AAA-Protocol           | 0-1 | 0-1 |\n   Origin-Host\
    \                   | 1   | 1   |\n   Origin-Realm                  | 1   | 1\
    \   |\n   Origin-State-Id               | 0-1 | 0-1 |\n   Originating-Line-Info\
    \         | 0-1 | 0   |\n   Password-Retry                | 0   | 0-1 |\n   Port-Limit\
    \                    | 0-1 | 0-1 |\n   Prompt                        | 0   | 0-1\
    \ |\n   Proxy-Info                    | 0+  | 0+  |\n   QoS-Filter-Rule      \
    \         | 0   | 0+  |\n   Re-Auth-Request-Type          | 0   | 0-1 |\n   Redirect-Host\
    \                 | 0   | 0+  |\n   Redirect-Host-Usage           | 0   | 0-1\
    \ |\n   Redirect-Max-Cache-Time       | 0   | 0-1 |\n   Reply-Message        \
    \         | 0   | 0+  |\n   Result-Code                   | 0   | 1   |\n   Route-Record\
    \                  | 0+  | 0+  |\n   Service-Type                  | 0-1 | 0-1\
    \ |\n   Session-Id                    | 1   | 1   |\n   Session-Timeout      \
    \         | 0   | 0-1 |\n   State                         | 0-1 | 0-1 |\n   Tunneling\
    \                     | 0+  | 0+  |\n   User-Name                     | 0-1 |\
    \ 0-1 |\n   User-Password                 | 0-1 | 0   |\n   ------------------------------|-----+-----+\n"
- title: 10.2.  Accounting AVP Tables
  contents:
  - "10.2.  Accounting AVP Tables\n   The tables in this section are used to show\
    \ which AVPs defined in\n   this document are to be present and used in NAS application\n\
    \   Accounting messages.  These AVPs are defined in this document, as\n   well\
    \ as in [BASE] and [RADIUSAcct].\n"
- title: 10.2.1.  Accounting Framed Access AVP Table
  contents:
  - "10.2.1.  Accounting Framed Access AVP Table\n   The table in this section is\
    \ used when the Service-Type specifies\n   Framed Access.\n                  \
    \                        +-----------+\n                                     \
    \     |  Command  |\n                                          |-----+-----+\n\
    \   Attribute Name                         | ACR | ACA |\n   ---------------------------------------|-----+-----+\n\
    \   Accounting-Auth-Method                 | 0-1 | 0   |\n   Accounting-Input-Octets\
    \                | 1   | 0   |\n   Accounting-Input-Packets               | 1\
    \   | 0   |\n   Accounting-Output-Octets               | 1   | 0   |\n   Accounting-Output-Packets\
    \              | 1   | 0   |\n   Accounting-Record-Number               | 0-1\
    \ | 0-1 |\n   Accounting-Record-Type                 | 1   | 1   |\n   Accounting-Realtime-Required\
    \           | 0-1 | 0-1 |\n   Accounting-Sub-Session-Id              | 0-1 | 0-1\
    \ |\n   Acct-Application-Id                    | 0-1 | 0-1 |\n   Acct-Session-Id\
    \                        | 1   | 0-1 |\n   Acct-Multi-Session-Id             \
    \     | 0-1 | 0-1 |\n   Acct-Authentic                         | 1   | 0   |\n\
    \   Acct-Delay-Time                        | 0-1 | 0   |\n   Acct-Interim-Interval\
    \                  | 0-1 | 0-1 |\n   Acct-Link-Count                        |\
    \ 0-1 | 0   |\n   Acct-Session-Time                      | 1   | 0   |\n   Acct-Tunnel-Connection\
    \                 | 0-1 | 0   |\n   Acct-Tunnel-Packets-Lost               | 0-1\
    \ | 0   |\n   Authorization-Lifetime                 | 0-1 | 0   |\n   Callback-Id\
    \                            | 0-1 | 0   |\n   Callback-Number               \
    \         | 0-1 | 0   |\n   Called-Station-Id                      | 0-1 | 0 \
    \  |\n   Calling-Station-Id                     | 0-1 | 0   |\n   Class      \
    \                            | 0+  | 0+  |\n   Connection-Info               \
    \         | 0+  | 0   |\n   Destination-Host                       | 0-1 | 0 \
    \  |\n   Destination-Realm                      | 1   | 0   |\n   Event-Timestamp\
    \                        | 0-1 | 0-1 |\n   Error-Message                     \
    \     | 0   | 0-1 |\n   Error-Reporting-Host                   | 0   | 0-1 |\n\
    \   Failed-AVP                             | 0   | 0+  |\n   ---------------------------------------|-----+-----+\n\
    \                                          +-----------+\n                   \
    \                       |  Command  |\n                                      \
    \    |-----+-----+\n   Attribute Name                         | ACR | ACA |\n\
    \   ---------------------------------------|-----+-----+\n   Framed-AppleTalk-Link\
    \                  | 0-1 | 0   |\n   Framed-AppleTalk-Network               |\
    \ 0-1 | 0   |\n   Framed-AppleTalk-Zone                  | 0-1 | 0   |\n   Framed-Compression\
    \                     | 0-1 | 0   |\n   Framed-IP-Address                    \
    \  | 0-1 | 0   |\n   Framed-IP-Netmask                      | 0-1 | 0   |\n  \
    \ Framed-IPv6-Prefix                     | 0+  | 0   |\n   Framed-IPv6-Pool  \
    \                     | 0-1 | 0   |\n   Framed-IPX-Network                   \
    \  | 0-1 | 0   |\n   Framed-MTU                             | 0-1 | 0   |\n  \
    \ Framed-Pool                            | 0-1 | 0   |\n   Framed-Protocol   \
    \                     | 0-1 | 0   |\n   Framed-Route                         \
    \  | 0-1 | 0   |\n   Framed-Routing                         | 0-1 | 0   |\n  \
    \ NAS-Filter-Rule                        | 0+  | 0   |\n   NAS-Identifier    \
    \                     | 0-1 | 0-1 |\n   NAS-IP-Address                       \
    \  | 0-1 | 0-1 |\n   NAS-IPv6-Address                       | 0-1 | 0-1 |\n  \
    \ NAS-Port                               | 0-1 | 0-1 |\n   NAS-Port-Id       \
    \                     | 0-1 | 0-1 |\n   NAS-Port-Type                        \
    \  | 0-1 | 0-1 |\n   Origin-AAA-Protocol                    | 0-1 | 0-1 |\n  \
    \ Origin-Host                            | 1   | 1   |\n   Origin-Realm      \
    \                     | 1   | 1   |\n   Origin-State-Id                      \
    \  | 0-1 | 0-1 |\n   Originating-Line-Info                  | 0-1 | 0   |\n  \
    \ Proxy-Info                             | 0+  | 0+  |\n   QoS-Filter-Rule   \
    \                     | 0+  | 0   |\n   Route-Record                         \
    \  | 0+  | 0+  |\n   Result-Code                            | 0   | 1   |\n  \
    \ Service-Type                           | 0-1 | 0-1 |\n   Session-Id        \
    \                     | 1   | 1   |\n   Termination-Cause                    \
    \  | 0-1 | 0-1 |\n   Tunnel-Assignment-Id                   | 0-1 | 0   |\n  \
    \ Tunnel-Client-Endpoint                 | 0-1 | 0   |\n   Tunnel-Medium-Type\
    \                     | 0-1 | 0   |\n   Tunnel-Private-Group-Id              \
    \  | 0-1 | 0   |\n   Tunnel-Server-Endpoint                 | 0-1 | 0   |\n  \
    \ Tunnel-Type                            | 0-1 | 0   |\n   User-Name         \
    \                     | 0-1 | 0-1 |\n   Vendor-Specific-Application-Id       \
    \  | 0-1 | 0-1 |\n   ---------------------------------------|-----+-----+\n"
- title: 10.2.2.  Accounting Non-Framed Access AVP Table
  contents:
  - "10.2.2.  Accounting Non-Framed Access AVP Table\n   The table in this section\
    \ is used when the Service-Type specifies\n   Non-Framed Access.\n           \
    \                               +-----------+\n                              \
    \            |  Command  |\n                                          |-----+-----+\n\
    \   Attribute Name                         | ACR | ACA |\n   ---------------------------------------|-----+-----+\n\
    \   Accounting-Auth-Method                 | 0-1 | 0   |\n   Accounting-Input-Octets\
    \                | 1   | 0   |\n   Accounting-Output-Octets               | 1\
    \   | 0   |\n   Accounting-Record-Type                 | 1   | 1   |\n   Accounting-Record-Number\
    \               | 0-1 | 0-1 |\n   Accounting-Realtime-Required           | 0-1\
    \ | 0-1 |\n   Accounting-Sub-Session-Id              | 0-1 | 0-1 |\n   Acct-Application-Id\
    \                    | 0-1 | 0-1 |\n   Acct-Session-Id                       \
    \ | 1   | 0-1 |\n   Acct-Multi-Session-Id                  | 0-1 | 0-1 |\n   Acct-Authentic\
    \                         | 1   | 0   |\n   Acct-Delay-Time                  \
    \      | 0-1 | 0   |\n   Acct-Interim-Interval                  | 0-1 | 0-1 |\n\
    \   Acct-Link-Count                        | 0-1 | 0   |\n   Acct-Session-Time\
    \                      | 1   | 0   |\n   Authorization-Lifetime              \
    \   | 0-1 | 0   |\n   Callback-Id                            | 0-1 | 0   |\n \
    \  Callback-Number                        | 0-1 | 0   |\n   Called-Station-Id\
    \                      | 0-1 | 0   |\n   Calling-Station-Id                  \
    \   | 0-1 | 0   |\n   Class                                  | 0+  | 0+  |\n \
    \  Connection-Info                        | 0+  | 0   |\n   Destination-Host \
    \                      | 0-1 | 0   |\n   Destination-Realm                   \
    \   | 1   | 0   |\n   Event-Timestamp                        | 0-1 | 0-1 |\n \
    \  Error-Message                          | 0   | 0-1 |\n   Error-Reporting-Host\
    \                   | 0   | 0-1 |\n   Failed-AVP                             |\
    \ 0   | 0+  |\n   Login-IP-Host                          | 0+  | 0   |\n   Login-IPv6-Host\
    \                        | 0+  | 0   |\n   Login-LAT-Service                 \
    \     | 0-1 | 0   |\n   Login-LAT-Node                         | 0-1 | 0   |\n\
    \   Login-LAT-Group                        | 0-1 | 0   |\n   Login-LAT-Port  \
    \                       | 0-1 | 0   |\n   Login-Service                      \
    \    | 0-1 | 0   |\n   Login-TCP-Port                         | 0-1 | 0   |\n\
    \   ---------------------------------------|-----+-----+\n                   \
    \                       +-----------+\n                                      \
    \    |  Command  |\n                                          |-----+-----+\n\
    \   Attribute Name                         | ACR | ACA |\n   ---------------------------------------|-----+-----+\n\
    \   NAS-Identifier                         | 0-1 | 0-1 |\n   NAS-IP-Address  \
    \                       | 0-1 | 0-1 |\n   NAS-IPv6-Address                   \
    \    | 0-1 | 0-1 |\n   NAS-Port                               | 0-1 | 0-1 |\n\
    \   NAS-Port-Id                            | 0-1 | 0-1 |\n   NAS-Port-Type   \
    \                       | 0-1 | 0-1 |\n   Origin-AAA-Protocol                \
    \    | 0-1 | 0-1 |\n   Origin-Host                            | 1   | 1   |\n\
    \   Origin-Realm                           | 1   | 1   |\n   Origin-State-Id \
    \                       | 0-1 | 0-1 |\n   Originating-Line-Info              \
    \    | 0-1 | 0   |\n   Proxy-Info                             | 0+  | 0+  |\n\
    \   QoS-Filter-Rule                        | 0+  | 0   |\n   Route-Record    \
    \                       | 0+  | 0+  |\n   Result-Code                        \
    \    | 0   | 1   |\n   Session-Id                             | 1   | 1   |\n\
    \   Service-Type                           | 0-1 | 0-1 |\n   Termination-Cause\
    \                      | 0-1 | 0-1 |\n   User-Name                           \
    \   | 0-1 | 0-1 |\n   Vendor-Specific-Application-Id         | 0-1 | 0-1 |\n \
    \  ---------------------------------------|-----+-----+\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   This section provides guidance to the Internet Assigned\
    \ Numbers\n   Authority (IANA) regarding registration of values related to the\n\
    \   Diameter protocol, in accordance with BCP 26 [IANAConsid].\n   This document\
    \ defines values in the namespaces that have been created\n   and defined in the\
    \ Diameter Base [BASE].  The IANA Considerations\n   section of that document\
    \ details the assignment criteria.  Values\n   assigned in this document, or by\
    \ future IANA action, must be\n   coordinated within this shared namespace.\n"
- title: 11.1.  Command Codes
  contents:
  - "11.1.  Command Codes\n   This specification assigns the value 265 from the Command\
    \ Code\n   namespace defined in [BASE].  See sections 3.1 and 3.2 for the\n  \
    \ assignment of the namespace in this specification.\n"
- title: 11.2.  AVP Codes
  contents:
  - "11.2.  AVP Codes\n   This specification assigns the values 363 - 366 and 400\
    \ - 408 from\n   the AVP Code namespace defined in [BASE].  See sections 4 and\
    \ 5 for\n   the assignment of the namespace in this specification.  Note that\
    \ the\n   values 363 - 366 are jointly, but consistently, assigned in\n   [DiamMIP].\
    \  This document also creates one new namespace to be\n   managed by IANA, as\
    \ described in section 11.5.\n   This specification also specifies the use of\
    \ AVPs in the 0 - 255\n   range, which are defined in [RADIUSTypes].  These values\
    \ are assigned\n   by the policy in RFC 2865 section 6 [RADIUS] and are amended\
    \ by RFC\n   3575 [RADIUSIANA].\n"
- title: 11.3.  Application Identifier
  contents:
  - "11.3.  Application Identifier\n   This specification uses the value one (1) in\
    \ the Application\n   Identifier namespace as assigned in [BASE].  See section\
    \ 1.2 above\n   for more information.\n"
- title: 11.4.  CHAP-Algorithm AVP Values
  contents:
  - "11.4.  CHAP-Algorithm AVP Values\n   As defined in section 5.5, the CHAP-Algorithm\
    \ AVP (AVP Code 403) uses\n   the values of the \"PPP AUTHENTICATION ALGORITHMS\"\
    \ namespace defined\n   in [PPPCHAP].\n"
- title: 11.5.  Accounting-Auth-Method AVP Values
  contents:
  - "11.5.  Accounting-Auth-Method AVP Values\n   As defined in section 8.6, the Accounting-Auth-Method\
    \ AVP (AVP Code\n   406) defines the values 1 - 5.  All remaining values are available\n\
    \   for assignment via IETF Consensus [IANA].\n"
- title: 11.6.  Origin-AAA-Protocol AVP Values
  contents:
  - "11.6.  Origin-AAA-Protocol AVP Values\n   As defined in section 9.3.6, the Origin-AAA-Protocol\
    \ AVP (AVP Code\n   408) defines the value 1. All remaining values are available\
    \ for\n   assignment with a \"Specification Required\" policy [IANAConsid].\n"
- title: 12.  Security Considerations
  contents:
  - "12.  Security Considerations\n   This document describes the extension of Diameter\
    \ for the NAS\n   application.  The security considerations of the Diameter protocol\n\
    \   itself have been discussed in [BASE].  Use of this application of\n   Diameter\
    \ MUST take into consideration the security issues and\n   requirements of the\
    \ Base protocol.\n   This document does not contain a security protocol but does\
    \ discuss\n   how PPP authentication protocols can be carried within the Diameter\n\
    \   protocol.  The PPP authentication protocols described are PAP and\n   CHAP.\n\
    \   The use of PAP SHOULD be discouraged, as it exposes users' passwords\n   to\
    \ possibly non-trusted entities.  However, PAP is also frequently\n   used for\
    \ use with One-Time Passwords, which do not expose a security\n   risk.\n   This\
    \ document also describes how CHAP can be carried within the\n   Diameter protocol,\
    \ which is required for RADIUS backward\n   compatibility.  The CHAP protocol,\
    \ as used in a RADIUS environment,\n   facilitates authentication replay attacks.\n\
    \   The use of the EAP authentication protocols described in [DiamEAP]\n   can\
    \ offer better security, given a method suitable for the\n   circumstances.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [BASE]         Calhoun, P., Loughney, J., Guttman,\
    \ E., Zorn, G., and\n                  J. Arkko, \"Diameter Base Protocol\", RFC\
    \ 3588,\n                  September 2003.\n   [DiamTrans]    Aboba, B. and J.\
    \ Wood, \"Authentication, Authorization\n                  and Accounting (AAA)\
    \ Transport Profile\", RFC 3539,\n                  June 2003.\n   [RADIUS]  \
    \     Rigney, C., Willens, S., Rubens, A., and W. Simpson,\n                 \
    \ \"Remote Authentication Dial In User Service (RADIUS)\",\n                 \
    \ RFC 2865, June 2000.\n   [RADIUSTypes]  IANA, \"RADIUS Types\", URL:\n     \
    \             <http://www.iana.org/assignments/radius-types>\n   [RADIUSIPv6]\
    \   Aboba, B., Zorn, G., and D. Mitton, \"RADIUS and IPv6\",\n               \
    \   RFC 3162, August 2001.\n   [IPv6Addr]     Nerenberg, L., \"IMAP4 Binary Content\
    \ Extension\", RFC\n                  3516, April 2003.\n   [PPPCHAP]      Simpson,\
    \ W., \"PPP Challenge Handshake Authentication\n                  Protocol (CHAP)\"\
    , RFC 1994, August 1996.\n   [IANAConsid]   Narten, T. and H. Alvestrand, \"Guidelines\
    \ for Writing\n                  an IANA Considerations Section in RFCs\", BCP\
    \ 26, RFC\n                  2434, October 1998.\n   [IANA]         IANA Assigned\
    \ Numbers Database, URL:\n                  <http://www.iana.org/numbers.html>\n\
    \   [Keywords]     Bradner, S., \"Key words for use in RFCs to Indicate\n    \
    \              Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [ANITypes]\
    \     NANPA Number Resource Info, ANI Assignments, URL:\n                  <http://www.nanpa.com/number_resource_info/\n\
    \                  ani_ii_assignments.html>\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [RADIUSAcct]   Rigney, C., \"RADIUS Accounting\"\
    , RFC 2866, June 2000.\n   [RADIUSExt]    Rigney, C., Willats, W., and P. Calhoun,\
    \ \"RADIUS\n                  Extensions\", RFC 2869, June 2000.\n   [RADTunnels]\
    \   Zorn, G., Leifer, D., Rubens, A., Shriver, J.,\n                  Holdrege,\
    \ M., and I. Goyret, \"RADIUS Attributes for\n                  Tunnel Protocol\
    \ Support\", RFC 2868, June 2000.\n   [RADTunlAcct]  Zorn, G., Aboba, B., and\
    \ D. Mitton, \"RADIUS Accounting\n                  Modifications for Tunnel Protocol\
    \ Support\", RFC 2867,\n                  June 2000.\n   [RADDynAuth]   Chiba,\
    \ M., Dommety, G., Eklund, M., Mitton, D., and B.\n                  Aboba, \"\
    Dynamic Authorization Extensions to Remote\n                  Authentication Dial\
    \ In User Service (RADIUS)\", RFC\n                  3576, July 2003.\n   [RADIUSIANA]\
    \   Aboba, B., \"IANA Considerations for RADIUS (Remote\n                  Authentication\
    \ Dial In User Service)\", RFC 3575, July\n                  2003.\n   [NASModel]\
    \     Mitton, D. and M. Beadles, \"Network Access Server\n                  Requirements\
    \ Next Generation (NASREQNG) NAS Model\",\n                  RFC 2881, July 2000.\n\
    \   [NASCriteria]  Beadles, M. and D. Mitton, \"Criteria for Evaluating\n    \
    \              Network Access Server Protocols\", RFC 3169, September\n      \
    \            2001.\n   [AAACriteria]  Aboba, B., Calhoun, P., Glass, S., Hiller,\
    \ T., McCann,\n                  P., Shiino, H., Zorn, G., Dommety, G., Perkins,\
    \ C.,\n                  Patil, B., Mitton, D., Manning, S., Beadles, M.,\n  \
    \                Walsh, P., Chen, X., Sivalingham, S., Hameed, A.,\n         \
    \         Munson, M., Jacobs, S., Lim, B., Hirschman, B., Hsu,\n             \
    \     R., Xu, Y., Campbell, E., Baba, S., and E. Jaques,\n                  \"\
    Criteria for Evaluating AAA Protocols for Network\n                  Access\"\
    , RFC 2989, November 2000.\n   [DiamEAP]      Eronen, P., \"Diameter EAP Application\"\
    , Work in\n                  Progress, May 2004.\n   [DiamCMS]      Calhoun, P.,\
    \ Bulley, W., and S. Farrell, \"Diameter CMS\n                  Security Application\"\
    , Work in Progress, March 2002.\n   [DiamMIP]      Calhoun, P., Johansson, T.,\
    \ Perkins, C., Hiller, T.,\n                  and P. McCann \"Diameter Mobile\
    \ IPv4 Application\", RFC\n                  4004, August 2005.\n   [VSA]    \
    \      Mitton, D., \"Diameter/RADIUS Vendor Specific AVP\n                  Translation\"\
    , Work in Progress, April 2005.\n   [RAD802.1X]    Congdon, P., Aboba, B., Smith,\
    \ A., Zorn, G., and J.\n                  Roese, \"IEEE 802.1X Remote Authentication\
    \ Dial In User\n                  Service (RADIUS) Usage Guidelines\", RFC 3580,\n\
    \                  September 2003.\n   [CDMA2000]     3GPP2 \"P.S0001-B\", Wireless\
    \ IP Network Standard,\n                  October 2002.\n                  http://www.3gpp2.com/Public_html/specs/P.S0001-\n\
    \                  B_v1.0.pdf\n   [AppleTalk]    Sidhu, Gursharan; Andrews, Richard\
    \ F. & Oppenheimer,\n                  Alan B.  \"Inside AppleTalk\", Second Edition,\
    \ Apple\n                  Computer., 1990\n   [ARAP]         Apple Remote Access\
    \ Protocol (ARAP) Version 2.0\n                  External Reference Specification\"\
    , Apple Computer,\n                  September 1994, R0612LL/B\n   [IPX]     \
    \     Novell, Inc., \"NetWare System Technical Interface\n                  Overview\"\
    , June 1989,  # 883-000780-001\n   [LAT]          Local Area Transport (LAT) Specification\
    \ V5.0, Digital\n                  Equipment Corp., AA-NL26A-TE, June 1989\n \
    \  [DIFFSERV]     Nichols, K., Blake, S., Baker, F., and D. Black,\n         \
    \         \"Definition of the Differentiated Services Field (DS\n            \
    \      Field) in the IPv4 and IPv6 Headers\", RFC 2474,\n                  December\
    \ 1998.\n   [DIFFSERVAF]   Heinanen, J., Baker, F., Weiss, W., and J. Wroclawski,\n\
    \                  \"Assured Forwarding PHB Group\", RFC 2597, June 1999.\n  \
    \ [DIFFSERVEF]   Davie, B., Charny, A., Bennet, J.C., Benson, K., Le\n       \
    \           Boudec, J., Courtney, W., Davari, S., Firoiu, V., and\n          \
    \        D. Stiliadis, \"An Expedited Forwarding PHB (Per-Hop\n              \
    \    Behavior)\", RFC 3246, March 2002.\n   [UTF-8]        Yergeau, F., \"UTF-8,\
    \ a transformation format of ISO\n                  10646\", STD 63, RFC 3629,\
    \ November 2003.\n   [ISOLatin]     ISO 8859. International Standard -- Information\n\
    \                  Processing -- 8-bit Single-Byte Coded Graphic\n           \
    \       Character Sets -- Part 1: Latin Alphabet No. 1, ISO\n                \
    \  8859-1:1987.  URL:\n                  <http://www.iso.ch/cate/d16338.html>\n\
    \   [PPP]          Simpson, W., \"The Point-to-Point Protocol (PPP)\", STD\n \
    \                 51, RFC 1661, July 1994.\n   [PAP]          Lloyd, B. and W.\
    \ Simpson, \"PPP Authentication\n                  Protocols\", RFC 1334, October\
    \ 1992.\n   [L2TP]         Townsley, W., Valencia, A., Rubens, A., Pall, G.,\n\
    \                  Zorn, G., and B. Palter, \"Layer Two Tunneling Protocol\n \
    \                 \"L2TP\"\", RFC 2661, August 1999.\n   [PPPMP]        Sklower,\
    \ K., Lloyd, B., McGregor, G., Carr, D., and T.\n                  Coradetti,\
    \ \"The PPP Multilink Protocol (MP)\", RFC\n                  1990, August 1996.\n\
    \   [PPTP]         Hamzeh, K., Pall, G., Verthein, W., Taarud, J.,\n         \
    \         Little, W., and G. Zorn, \"Point-to-Point Tunneling\n              \
    \    Protocol\", RFC 2637, July 1999.\n   [IEEE 802.11F] IEEE, \"Trial-Use Recommended\
    \ Practice for Multi-Vendor\n                  Access Point Interoperability via\
    \ an Inter-Access\n                  Point Protocol Across Distribution Systems\
    \ Supporting\n                  IEEE 802.11 Operation\", IEEE 802.11F-2003, June\
    \ 2003.\n"
- title: 14.  Acknowledgements
  contents:
  - "14.  Acknowledgements\n   The authors would like to thank Carl Rigney, Allan\
    \ C. Rubens, William\n   Allen Simpson, and Steve Willens for their work on the\
    \ original\n   RADIUS [RADIUS], from which many of the concepts in this\n   specification\
    \ were derived.  Thanks, also, to Carl Rigney for\n   [RADIUSAcct] and [RADIUSExt];\
    \ Ward Willats for [RADIUSExt]; Glen\n   Zorn, Bernard Aboba, and Dave Mitton\
    \ for [RADTunlAcct] and\n   [RADIUSIPv6]; and Dory Leifer, John Shriver, Matt\
    \ Holdrege, and\n   Ignacio Goyret for their work on [RADTunnels].  This document\
    \ stole\n   text and concepts from both [RADTunnels] and [RADIUSExt].  Thanks\
    \ go\n   to Carl Williams for providing IPv6-specific text.\n   The authors would\
    \ also like to acknowledge the following people for\n   their contributions in\
    \ the development of the Diameter protocol:\n   Bernard Aboba, Jari Arkko, William\
    \ Bulley, Kuntal Chowdhury, Daniel\n   C. Fox, Lol Grant, Nancy Greene, Jeff Hagg,\
    \ Peter Heitman, Paul\n   Krumviede, Fergal Ladley, Ryan Moats, Victor Muslin,\
    \ Kenneth Peirce,\n   Sumit Vakil, John R. Vollbrecht, and Jeff Weisberg.\n  \
    \ Finally, Pat Calhoun would like to thank Sun Microsystems, as most of\n   the\
    \ effort put into this document was done while he was in their\n   employ.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Pat Calhoun\n   Cisco Systems, Inc.\n   170 West Tasman\
    \ Drive\n   San Jose, CA 95134\n   USA\n   Phone: +1 408-853-5269\n   EMail: pcalhoun@cisco.com\n\
    \   Glen Zorn\n   Cisco Systems, Inc.\n   500 108th Avenue N.E., Suite 500\n \
    \  Bellevue, WA 98004\n   USA\n   Phone:  1 425-471-4861\n   EMail: gwz@cisco.com\n\
    \   David Spence\n   3259 Bluett Rd.\n   Ann Arbor, MI  48105\n   USA\n   Phone:\
    \ +1 734 834 6481\n   EMail: dspence@computer.org\n   David Mitton\n   Circular\
    \ Networks\n   733 Turnpike St #154\n   North Andover, MA 01845\n   EMail: dmitton@circularnetworks.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2005).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at ietf-\n   ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
