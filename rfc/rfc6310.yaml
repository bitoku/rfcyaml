- title: __initial_text__
  contents:
  - "   Pseudowire (PW) Operations, Administration, and Maintenance (OAM)\n      \
    \                      Message Mapping\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies the mapping and notification of defect states\n\
    \   between a pseudowire (PW) and the Attachment Circuits (ACs) of the\n   end-to-end\
    \ emulated service.  It standardizes the behavior of\n   Provider Edges (PEs)\
    \ with respect to PW and AC defects.  It addresses\n   ATM, Frame Relay, Time\
    \ Division Multiplexing (TDM), and Synchronous\n   Optical Network / Synchronous\
    \ Digital Hierarchy (SONET/SDH) PW\n   services, carried over MPLS, MPLS/IP, and\
    \ Layer 2 Tunneling Protocol\n   version 3/IP (L2TPv3/IP) Packet Switched Networks\
    \ (PSNs).\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This\
    \ document is a product of the Internet Engineering Task Force\n   (IETF).  It\
    \ represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   Internet Standards is available\
    \ in Section 2 of RFC 5741.\n   Information about the current status of this document,\
    \ any errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6310.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \   2. Abbreviations and Conventions ...................................5\n  \
    \    2.1. Abbreviations ..............................................5\n    \
    \  2.2. Conventions ................................................6\n   3. Reference\
    \ Model and Defect Locations ............................7\n   4. Abstract Defect\
    \ States ..........................................8\n   5. OAM Modes .......................................................9\n\
    \   6. PW Defect States and Defect Notifications ......................11\n  \
    \    6.1. PW Defect Notification Mechanisms .........................11\n    \
    \       6.1.1. LDP Status TLV .....................................13\n      \
    \     6.1.2. L2TP Circuit Status AVP ............................14\n        \
    \   6.1.3. BFD Diagnostic Codes ...............................16\n      6.2.\
    \ PW Defect State Entry/Exit ................................18\n           6.2.1.\
    \ PW Receive Defect State Entry/Exit Criteria ........18\n           6.2.2. PW\
    \ Transmit Defect State Entry/Exit Criteria .......19\n   7. Procedures for ATM\
    \ PW Service ..................................19\n      7.1. AC Receive Defect\
    \ State Entry/Exit Criteria ...............19\n      7.2. AC Transmit Defect State\
    \ Entry/Exit Criteria ..............20\n      7.3. Consequent Actions ........................................21\n\
    \           7.3.1. PW Receive Defect State Entry/Exit .................21\n  \
    \         7.3.2. PW Transmit Defect State Entry/Exit ................21\n    \
    \       7.3.3. PW Defect State in ATM Port Mode PW Service ........22\n      \
    \     7.3.4. AC Receive Defect State Entry/Exit .................22\n        \
    \   7.3.5. AC Transmit Defect State Entry/Exit ................23\n   8. Procedures\
    \ for Frame Relay PW Service ..........................24\n      8.1. AC Receive\
    \ Defect State Entry/Exit Criteria ...............24\n      8.2. AC Transmit Defect\
    \ State Entry/Exit Criteria ..............24\n      8.3. Consequent Actions ........................................24\n\
    \           8.3.1. PW Receive Defect State Entry/Exit .................24\n  \
    \         8.3.2. PW Transmit Defect State Entry/Exit ................25\n    \
    \       8.3.3. PW Defect State in the FR Port Mode PW Service .....25\n      \
    \     8.3.4. AC Receive Defect State Entry/Exit .................25\n        \
    \   8.3.5. AC Transmit Defect State Entry/Exit ................26\n   9. Procedures\
    \ for TDM PW Service ..................................26\n      9.1. AC Receive\
    \ Defect State Entry/Exit Criteria ...............27\n      9.2. AC Transmit Defect\
    \ State Entry/Exit Criteria ..............27\n      9.3. Consequent Actions ........................................27\n\
    \           9.3.1. PW Receive Defect State Entry/Exit .................27\n  \
    \         9.3.2. PW Transmit Defect State Entry/Exit ................27\n    \
    \       9.3.3. AC Receive Defect State Entry/Exit .................28\n   10.\
    \ Procedures for CEP PW Service .................................28\n      10.1.\
    \ Defect States ............................................29\n           10.1.1.\
    \ PW Receive Defect State Entry/Exit ................29\n           10.1.2. PW\
    \ Transmit Defect State Entry/Exit ...............29\n           10.1.3. AC Receive\
    \ Defect State Entry/Exit ................29\n           10.1.4. AC Transmit Defect\
    \ State Entry/Exit ...............30\n      10.2. Consequent Actions .......................................30\n\
    \           10.2.1. PW Receive Defect State Entry/Exit ................30\n  \
    \         10.2.2. PW Transmit Defect State Entry/Exit ...............30\n    \
    \       10.2.3. AC Receive Defect State Entry/Exit ................30\n   11.\
    \ Security Considerations .......................................31\n   12. Contributors\
    \ and Acknowledgments ..............................31\n   13. References ....................................................32\n\
    \      13.1. Normative References .....................................32\n  \
    \    13.2. Informative References ...................................34\n   Appendix\
    \ A. Native Service Management (Informative) ...............36\n     A.1. Frame\
    \ Relay Management .....................................36\n     A.2. ATM Management\
    \ .............................................37\n   Appendix B. PW Defects and\
    \ Detection Tools ........................38\n     B.1. PW Defects .................................................38\n\
    \     B.2. Packet Loss ................................................38\n  \
    \   B.3. PW Defect Detection Tools ..................................38\n    \
    \ B.4. PW Specific Defect Detection Mechanisms ....................39\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document specifies the mapping and notification of\
    \ defect states\n   between a pseudowire and the Attachment Circuits (AC) of the\
    \ end-to-\n   end emulated service.  It covers the case where the ACs and the\
    \ PWs\n   are of the same type in accordance to the Pseudowire Emulation Edge-\n\
    \   to-Edge (PWE3) architecture [RFC3985] such that a homogeneous PW\n   service\
    \ can be constructed.\n   This document is motivated by the requirements put forth\
    \ in [RFC4377]\n   and [RFC3916].  Its objective is to standardize the behavior\
    \ of PEs\n   with respect to defects on PWs and ACs, so that there is no ambiguity\n\
    \   about the alarms generated and consequent actions undertaken by PEs\n   in\
    \ response to specific failure conditions.\n   This document addresses PWs over\
    \ MPLS, MPLS/IP, L2TPv3/IP PSNs, ATM,\n   Frame Relay, TDM, and SONET/SDH PW native\
    \ services.  Due to its\n   unique characteristics, the Ethernet PW service is\
    \ covered in a\n   separate document [Eth-OAM-Inter].\n   This document provides\
    \ procedures for PWs set up using Label\n   Distribution Protocol (LDP) [RFC4447]\
    \ or L2TPv3 [RFC3931] control\n   protocols.  While we mention fault reporting\
    \ options for PWs\n   established by other means (e.g., by static configuration\
    \ or via\n   BGP), we do not provide detailed procedures for such cases.\n   This\
    \ document is scoped only to single segment PWs.  The mechanisms\n   described\
    \ in this document could also be applied to terminating PEs\n   (T-PEs) for multi-segment\
    \ PWs (MS-PWs) ([RFC5254]).  Section 10 of\n   [RFC6073] details procedures for\
    \ generating or relaying PW status by\n   a switching PE (S-PE).\n"
- title: 2.  Abbreviations and Conventions
  contents:
  - '2.  Abbreviations and Conventions

    '
- title: 2.1.  Abbreviations
  contents:
  - "2.1.  Abbreviations\n   AAL5  ATM Adaptation Layer 5\n   AIS   Alarm Indication\
    \ Signal\n   AC    Attachment Circuit\n   ATM   Asynchronous Transfer Mode\n \
    \  AVP   Attribute Value Pair\n   BFD   Bidirectional Forwarding Detection\n \
    \  CC    Continuity Check\n   CDN   Call Disconnect Notify\n   CE    Customer\
    \ Edge\n   CV    Connectivity Verification\n   DBA   Dynamic Bandwidth Allocation\n\
    \   DLC   Data Link Connection\n   FDI   Forward Defect Indication\n   FR    Frame\
    \ Relay\n   FRBS  Frame Relay Bearer Service\n   ICMP  Internet Control Message\
    \ Protocol\n   LB    Loopback\n   LCCE  L2TP Control Connection Endpoint\n   LDP\
    \   Label Distribution Protocol\n   LSP   Label Switched Path\n   L2TP  Layer\
    \ 2 Tunneling Protocol\n   MPLS  Multiprotocol Label Switching\n   NE    Network\
    \ Element\n   NS    Native Service\n   OAM   Operations, Administration, and Maintenance\n\
    \   PE    Provider Edge\n   PSN   Packet Switched Network\n   PW    Pseudowire\n\
    \   RDI   Reverse Defect Indication\n   PDU   Protocol Data Unit\n   SDH   Synchronous\
    \ Digital Hierarchy\n   SDU   Service Data Unit\n   SONET   Synchronous Optical\
    \ Network\n   TDM   Time Division Multiplexing\n   TLV   Type Length Value\n \
    \  VCC   Virtual Channel Connection\n   VCCV  Virtual Connection Connectivity\
    \ Verification\n   VPC   Virtual Path Connection\n"
- title: 2.2.  Conventions
  contents:
  - "2.2.  Conventions\n   The words \"defect\" and \"fault\" are used interchangeably\
    \ to mean any\n   condition that negatively impacts forwarding of user traffic\
    \ between\n   the CE endpoints of the PW service.\n   The words \"defect notification\"\
    \ and \"defect indication\" are used\n   interchangeably to mean any OAM message\
    \ generated by a PE and sent to\n   other nodes in the network to convey the defect\
    \ state local to this\n   PE.\n   The PW can be carried over three types of Packet\
    \ Switched Networks\n   (PSNs).  An \"MPLS PSN\" makes use of MPLS Label Switched\
    \ Paths\n   [RFC3031] as the tunneling technology to forward the PW packets. \
    \ An\n   \"MPLS/IP PSN\" makes use of MPLS-in-IP tunneling [RFC4023], with an\n\
    \   MPLS shim header used as PW demultiplexer.  An \"L2TPv3/IP PSN\" makes\n \
    \  use of L2TPv3/IP [RFC3931] as the tunneling technology with the\n   L2TPv3/IP\
    \ Session ID as the PW demultiplexer.\n   If LSP-Ping [RFC4379] is run over a\
    \ PW as described in [RFC5085], it\n   will be referred to as \"VCCV-Ping\". \
    \ If BFD is run over a PW as\n   described in [RFC5885], it will be referred to\
    \ as \"VCCV-BFD\".\n   While PWs are inherently bidirectional entities, defects\
    \ and OAM\n   messaging are related to a specific traffic direction.  We use the\n\
    \   terms \"upstream\" and \"downstream\" to identify PEs in relation to the\n\
    \   traffic direction.  A PE is upstream for the traffic it is forwarding\n  \
    \ and is downstream for the traffic it is receiving.\n   We use the terms \"local\"\
    \ and \"remote\" to identify native service\n   networks and ACs in relation to\
    \ a specific PE.  The local AC is\n   attached to the PE in question, while the\
    \ remote AC is attached to\n   the PE at the other end of the PW.\n   A \"transmit\
    \ defect\" is any defect that uniquely impacts traffic sent\n   or relayed by\
    \ the observing PE.  A \"receive defect\" is any defect\n   that impacts information\
    \ transfer to the observing PE.  Note that a\n   receive defect also impacts traffic\
    \ meant to be relayed, and thus can\n   be considered to incorporate two defect\
    \ states.  Thus, when a PE\n   enters both receive and transmit defect states\
    \ of a PW service, the\n   receive defect takes precedence over the transmit defect\
    \ in terms of\n   the consequent actions.\n   A \"forward defect indication\"\
    \ (FDI) is sent in the same direction as\n   the user traffic impacted by the\
    \ defect.  A \"reverse defect\n   indication\" (RDI) is sent in the direction\
    \ opposite to that of the\n   impacted traffic.\n   The key words \"MUST\", \"\
    MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\"\
    , \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted\
    \ as described in [RFC2119].\n"
- title: 3.  Reference Model and Defect Locations
  contents:
  - "3.  Reference Model and Defect Locations\n   Figure 1 illustrates the PWE3 network\
    \ reference model with an\n   indication of the possible defect locations.  This\
    \ model will be\n   referenced in the remainder of this document for describing\
    \ the OAM\n   procedures.\n                 ACs             PSN tunnel       \
    \       ACs\n                        +----+                  +----+\n        +----+\
    \          | PE1|==================| PE2|          +----+\n        |    |---(a)---(b)..(c)......PW1..(d)..(e)..(f)---(g)---|\
    \    |\n        | CE1|   (N1)   |    |                  |    |    (N2)  |CE2 |\n\
    \        |    |----------|............PW2.............|----------|    |\n    \
    \    +----+          |    |==================|    |          +----+\n        \
    \     ^          +----+                  +----+          ^\n             |   \
    \   Provider Edge 1         Provider Edge 2     |\n             |            \
    \                                      |\n             |<-------------- Emulated\
    \ Service ---------------->|\n       Customer                                \
    \                Customer\n        Edge 1                                    \
    \              Edge 2\n                  Figure 1: PWE3 Network Defect Locations\n\
    \   The procedures will be described in this document from the viewpoint\n   of\
    \ PE1, so that N1 is the local native service network and N2 is the\n   remote\
    \ native service network.  PE2 will typically implement the same\n   functionality.\
    \  Note that PE1 is the upstream PE for traffic\n   originating in the local NS\
    \ network N1, while it is the downstream PE\n   for traffic originating in the\
    \ remote NS network N2.\n   The following is a brief description of the defect\
    \ locations:\n   a. Defect in NS network N1.  This covers any defect in network\
    \ N1\n      (including any CE1 defect) that impacts all or some ACs attached\n\
    \      to PE1, and is thus a local AC defect.  The defect is conveyed to\n   \
    \   PE1 and to NS network N2 using NS specific OAM defect indications.\n   b.\
    \ Defect on a PE1 AC interface (another local AC defect).\n   c. Defect on a PE1\
    \ PSN interface.\n   d. Defect in the PSN network.  This covers any defect in\
    \ the PSN that\n      impacts all or some PWs between PE1 and PE2.  The defect\
    \ is\n      conveyed to the PE using a PSN and/or a PW specific OAM defect\n \
    \     indication.  Note that both data plane defects and control plane\n     \
    \ defects must be taken into consideration.  Although control\n      messages\
    \ may follow a different path than PW data plane traffic, a\n      control plane\
    \ defect may affect the PW status.\n   e. Defect on a PE2 PSN interface.\n   f.\
    \ Defect on a PE2 AC interface (a remote AC defect).\n   g. Defect in NS network\
    \ N2 (another remote AC defect).  This covers\n      any defect in N2 (including\
    \ any CE2 defect) that impacts all or a\n      subset of ACs attached to PE2.\
    \  The defect is conveyed to PE2 and\n      to NS network N1 using the NS OAM\
    \ defect indication.\n"
- title: 4.  Abstract Defect States
  contents:
  - "4.  Abstract Defect States\n   PE1 must track four defect states that reflect\
    \ the observed states of\n   both directions of the PW service on both the AC\
    \ and the PW sides.\n   Defects may impact one or both directions of the PW service.\n\
    \   The observed state is a combination of defects directly detected by\n   PE1\
    \ and defects of which it has been made aware via notifications.\n           \
    \                  +-----+\n          ----AC receive---->|     |-----PW transmit---->\n\
    \     CE1                     | PE1 |                       PE2/CE2\n        \
    \  <---AC transmit----|     |<----PW receive-----\n                          \
    \   +-----+\n       (arrows indicate direction of user traffic impacted by a defect)\n\
    \               Figure 2: Receive and Transmit Defect States\n   PE1 will directly\
    \ detect or be notified of AC receive or PW receive\n   defects as they occur\
    \ upstream of PE1 and impact traffic being sent\n   to PE1.  As a result, PE1\
    \ enters the AC or PW receive defect state.\n   In Figure 2, PE1 may be notified\
    \ of a receive defect in the AC by\n   receiving a forward defect indication,\
    \ e.g., ATM AIS, from CE1 or an\n   intervening network.  This defect notification\
    \ indicates that user\n   traffic sent by CE1 may not be received by PE1 due to\
    \ a defect.  PE1\n   can also directly detect an AC receive defect if it resulted\
    \ from a\n   failure of the receive side in the local port or link over which\
    \ the\n   AC is configured.\n   Similarly, PE1 may detect or be notified of a\
    \ receive defect in the\n   PW by receiving a forward defect indication from PE2.\
    \  If the PW\n   status TLV is used for fault notification, this message will\
    \ indicate\n   a Local PSN-facing PW (egress) Transmit Fault or a Local AC (ingress)\n\
    \   Receive Fault at PE2, as described in Section 6.1.1.  This defect\n   notification\
    \ indicates that user traffic sent by CE2 may not be\n   received by PE1 due to\
    \ a defect.  As a result, PE1 enters the PW\n   receive defect state.\n   Note\
    \ that a forward defect indication is sent in the same direction\n   as the user\
    \ traffic impacted by the defect.\n   Generally, a PE cannot detect transmit defects\
    \ by itself and will\n   therefore need to be notified of AC transmit or PW transmit\
    \ defects\n   by other devices.\n   In Figure 2, PE1 may be notified of a transmit\
    \ defect in the AC by\n   receiving a reverse defect indication, e.g., ATM RDI,\
    \ from CE1.  This\n   defect relates to the traffic sent by PE1 to CE1 on the\
    \ AC.\n   Similarly, PE1 may be notified of a transmit defect in the PW by\n \
    \  receiving a reverse defect indication from PE2.  If PW status is used\n   for\
    \ fault notification, this message will indicate a Local PSN-\n   facing PW (ingress)\
    \ Receive Fault or a Local Attachment Circuit\n   (egress) Transmit Fault at PE2,\
    \ as described in Section 6.1.1.  This\n   defect impacts the traffic sent by\
    \ PE1 to CE2.  As a result, PE1\n   enters the PW transmit defect state.\n   Note\
    \ that a reverse defect indication is sent in the reverse\n   direction to the\
    \ user traffic impacted by the defect.\n   The procedures outlined in this document\
    \ define the entry and exit\n   criteria for each of the four states with respect\
    \ to the set of PW\n   services within the document scope and the consequent actions\
    \ that\n   PE1 must perform.\n   When a PE enters both receive and transmit defect\
    \ states related to\n   the same PW service, then the receive defect takes precedence\
    \ over\n   transmit defect in terms of the consequent actions.\n"
- title: 5.  OAM Modes
  contents:
  - "5.  OAM Modes\n   A homogeneous PW service forwards packets between an AC and\
    \ a PW of\n   the same type.  It thus implements both NS OAM and PW OAM mechanisms.\n\
    \   PW OAM defect notification messages are described in Section 6.1.  NS\n  \
    \ OAM messages are described in Appendix A.\n   This document defines two different\
    \ OAM modes, the distinction being\n   the method of mapping between the NS and\
    \ PW OAM defect notification\n   messages.\n   The first mode, illustrated in\
    \ Figure 3, is called the \"single\n   emulated OAM loop\" mode.  Here, a single\
    \ end-to-end NS OAM loop is\n   emulated by transparently passing NS OAM messages\
    \ over the PW.  Note\n   that the PW OAM is shown outside the PW in Figure 3,\
    \ as it is\n   transported in LDP messages or in the associated channel, not inside\n\
    \   the PW itself.\n                       +-----+                 +-----+\n \
    \     +-----+          |     |=================|     |          +-----+\n    \
    \  | CE1 |-=NS-OAM=>| PE1 |----=NS-OAM=>----| PE2 |-=NS-OAM=>| CE2 |\n      +-----+\
    \          |     |=================|     |          +-----+\n                \
    \       +-----+                 +-----+\n                          \\        \
    \               /\n                           -------=PW-OAM=>-------\n      \
    \            Figure 3: Single Emulated OAM Loop Mode\n   The single emulated OAM\
    \ loop mode implements the following behavior:\n   a. The upstream PE (PE1) MUST\
    \ transparently relay NS OAM messages\n      over the PW.\n   b. The upstream\
    \ PE MUST signal local defects affecting the AC using a\n      NS defect notification\
    \ message sent over the PW.  In the case that\n      it is not possible to generate\
    \ NS OAM messages (e.g., because the\n      defect interferes with NS OAM message\
    \ generation), the PE MUST\n      signal local defects affecting the AC using\
    \ a PW defect\n      notification message.\n   c. The upstream PE MUST signal\
    \ local defects affecting the PW using a\n      PW defect notification message.\n\
    \   d. The downstream PE (PE2) MUST insert NS defect notification\n      messages\
    \ into its local AC when it detects or is notified of a\n      defect in the PW\
    \ or remote AC.  This includes translating received\n      PW defect notification\
    \ messages into NS defect notification\n      messages for defects signaled by\
    \ the upstream PE.\n   The single emulated OAM loop mode is suitable for PW services\
    \ that\n   have a widely deployed NS OAM mechanism.  This document specifies the\n\
    \   use of this mode for ATM PW, TDM PW, and Circuit Emulation over\n   Packet\
    \ (CEP) PW services.  It is the default mode of operation for\n   all ATM cell\
    \ mode PW services and the only mode specified for CEP and\n   Structure-Agnostic\
    \ TDM over Packets / Circuit Emulation Service over\n   Packet Switched Network\
    \ (SAToP/CESoPSN) TDM PW services.  It is\n   optional for AAL5 PDU transport\
    \ and AAL5 SDU transport modes.\n   The second OAM mode operates three OAM loops\
    \ joined at the AC/PW\n   boundaries of the PEs.  This is referred to as the \"\
    coupled OAM\n   loops\" mode and is illustrated in Figure 4.  Note that in contrast\
    \ to\n   Figure 3, NS OAM messages are never carried over the PW.\n          \
    \             +-----+                 +-----+\n      +-----+          |     |=================|\
    \     |          +-----+\n      | CE1 |-=NS-OAM=>| PE1 |                 | PE2\
    \ |-=NS-OAM=>| CE2 |\n      +-----+          |     |=================|     | \
    \         +-----+\n                       +-----+                 +-----+\n  \
    \                        \\                       /\n                        \
    \   -------=PW-OAM=>-------\n                     Figure 4: Coupled OAM Loops\
    \ Mode\n   The coupled OAM loops mode implements the following behavior:\n   a.\
    \ The upstream PE (PE1) MUST terminate and translate a received NS\n      defect\
    \ notification message into a PW defect notification message.\n   b. The upstream\
    \ PE MUST signal local failures affecting its local AC\n      using PW defect\
    \ notification messages to the downstream PE.\n   c. The upstream PE MUST signal\
    \ local failures affecting the PW using\n      PW defect notification messages.\n\
    \   d. The downstream PE (PE2) MUST insert NS defect notification\n      messages\
    \ into the AC when it detects or is notified of defects in\n      the PW or remote\
    \ AC.  This includes translating received PW defect\n      notification messages\
    \ into NS defect notification messages.\n   This document specifies the coupled\
    \ OAM loops mode as the default\n   mode for the Frame Relay, ATM AAL5 PDU transport,\
    \ and AAL5 SDU\n   transport services.  It is an optional mode for ATM VCC cell\
    \ mode\n   services.  This mode is not specified for TDM, CEP, or ATM VPC cell\n\
    \   mode PW services.  RFC 5087 defines a similar but distinct mode, as\n   will\
    \ be explained in Section 9.  For the ATM VPC cell mode case a\n   pure coupled\
    \ OAM loops mode is not possible as a PE MUST\n   transparently pass VC-level\
    \ (F5) ATM OAM cells over the PW while\n   terminating and translating VP-level\
    \ (F4) OAM cells.\n"
- title: 6.  PW Defect States and Defect Notifications
  contents:
  - '6.  PW Defect States and Defect Notifications

    '
- title: 6.1.  PW Defect Notification Mechanisms
  contents:
  - "6.1.  PW Defect Notification Mechanisms\n   For MPLS and MPLS/IP PSNs, a PE that\
    \ establishes a PW using the Label\n   Distribution Protocol [RFC5036], and that\
    \ has negotiated use of the\n   LDP status TLV per Section 5.4.3 of [RFC4447],\
    \ MUST use the PW status\n   TLV mechanism for AC and PW status and defect notification.\n\
    \   Additionally, such a PE MAY use VCCV-BFD Connectivity Verification\n   (CV)\
    \ for fault detection only (CV types 0x04 and 0x10 [RFC5885]).\n   A PE that establishes\
    \ an MPLS PW using means other than LDP, e.g., by\n   static configuration or\
    \ by use of BGP, MUST support some alternative\n   method of status reporting.\
    \  The design of a suitable mechanism to\n   carry the aforementioned status TLV\
    \ in the PW associated channel is\n   work in progress [Static-PW-Status].  Additionally,\
    \ such a PE MAY use\n   VCCV-BFD CV for both fault detection and status notification\
    \ (CV\n   types 0x08 and 0x20 [RFC5885]).\n   For a L2TPv3/IP PSN, a PE SHOULD\
    \ use the Circuit Status Attribute\n   Value Pair (AVP) as the mechanism for AC\
    \ and PW status and defect\n   notification.  In its most basic form, the Circuit\
    \ Status AVP\n   [RFC3931] in a Set-Link-Info (SLI) message can signal active/inactive\n\
    \   AC status.  The Circuit Status AVP as described in [RFC5641] is\n   proposed\
    \ to be extended to convey status and defects in the AC and\n   the PSN-facing\
    \ PW in both ingress and egress directions, i.e., four\n   independent status\
    \ bits, without the need to tear down the sessions\n   or control connection.\n\
    \   When a PE does not support the Circuit Status AVP, it MAY use the\n   Stop-Control-Connection-Notification\
    \ (StopCCN) and the Call-\n   Disconnect-Notify (CDN) messages to tear down L2TP\
    \ sessions in a\n   fashion similar to LDP's use of Label Withdrawal to tear down\
    \ a PW.\n   A PE may use the StopCCN to shut down the L2TP control connection,\n\
    \   and implicitly all L2TP sessions associated with that control\n   connection,\
    \ without any explicit session control messages.  This is\n   useful for the case\
    \ of a failure which impacts all L2TP sessions (all\n   PWs) managed by the control\
    \ connection.  It MAY use CDN to disconnect\n   a specific L2TP session when a\
    \ failure only affects a specific PW.\n   Additionally, a PE MAY use VCCV-BFD\
    \ CV types 0x04 and 0x10 for fault\n   detection only, but SHOULD notify the remote\
    \ PE using the Circuit\n   Status AVP.  A PE that establishes a PW using means\
    \ other than the\n   L2TP control plane, e.g., by static configuration or by use\
    \ of BGP,\n   MAY use VCCV-BFD CV types 0x08 and 0x20 for AC and PW status and\n\
    \   defect notification.  These CV types SHOULD NOT be used when the PW\n   is\
    \ established via the L2TP control plane.\n   The CV types are defined in Section\
    \ 6.1.3 of this document.\n"
- title: 6.1.1.  LDP Status TLV
  contents:
  - "6.1.1.  LDP Status TLV\n   [RFC4446] defines the following PW status code points:\n\
    \   0x00000000 -  Pseudowire forwarding (clear all failures)\n   0x00000001 -\
    \  Pseudowire Not Forwarding\n   0x00000002 -  Local Attachment Circuit (ingress)\
    \ Receive Fault\n   0x00000004 -  Local Attachment Circuit (egress) Transmit Fault\n\
    \   0x00000008 -  Local PSN-facing PW (ingress) Receive Fault\n   0x00000010 -\
    \  Local PSN-facing PW (egress) Transmit Fault\n   [RFC4447] specifies that the\
    \ \"Pseudowire forwarding\" code point is\n   used to indicate that all faults\
    \ are to be cleared.  It also\n   specifies that the \"Pseudowire Not Forwarding\"\
    \ code point means that\n   a defect has been detected that is not represented\
    \ by the defined\n   code points.\n   The code points used in the LDP status TLV\
    \ in a PW status\n   notification message report defects from the viewpoint of\
    \ the\n   originating PE.  The originating PE conveys this state in the form of\n\
    \   a forward defect or a reverse defect indication.\n   The forward and reverse\
    \ defect indication definitions used in this\n   document map to the LDP Status\
    \ TLV codes as follows:\n          Forward defect indication corresponds to the\
    \ logical OR of:\n            *  Local Attachment Circuit (ingress) Receive Fault,\n\
    \            *  Local PSN-facing PW (egress) Transmit Fault, and\n           \
    \ *  PW Not Forwarding.\n          Reverse defect indication corresponds to the\
    \ logical OR of:\n            *  Local Attachment Circuit (egress) Transmit Fault\
    \ and\n            *  Local PSN-facing PW (ingress) Receive Fault.\n   A PE MUST\
    \ use PW status notification messages to report all defects\n   affecting the\
    \ PW service including, but not restricted to, the\n   following:\n   o  defects\
    \ detected through fault detection mechanisms in the MPLS\n      and MPLS/IP PSN,\n\
    \   o  defects detected through VCCV-Ping or VCCV-BFD CV types 0x04 and\n    \
    \  0x10 for fault detection only,\n   o  defects within the PE that result in\
    \ an inability to forward\n      traffic between the AC and the PW,\n   o  defects\
    \ of the AC or in the Layer 2 network affecting the AC as\n      per the rules\
    \ detailed in Section 5 for the \"single emulated OAM\n      loop\" mode and \"\
    coupled OAM loops\" modes.\n   Note that there are two situations that require\
    \ PW label withdrawal\n   as opposed to a PW status notification by the PE.  The\
    \ first one is\n   when the PW is taken down administratively in accordance with\n\
    \   [RFC4447].  The second one is when the Target LDP session established\n  \
    \ between the two PEs is lost.  In the latter case, the PW labels will\n   need\
    \ to be re-signaled when the Targeted LDP session is re-\n   established.\n"
- title: 6.1.2.  L2TP Circuit Status AVP
  contents:
  - "6.1.2.  L2TP Circuit Status AVP\n   [RFC3931] defines the Circuit Status AVP\
    \ in the Set-Link-Info (SLI)\n   message to exchange initial status and status\
    \ changes in the circuit\n   to which the pseudowire is bound.  [RFC5641] defines\
    \ extensions to\n   the Circuit Status AVP that are analogous to the PW Status\
    \ TLV\n   defined for LDP.  Consequently, for L2TPv3/IP, the Circuit Status AVP\n\
    \   is used in the same fashion as the PW Status described in the\n   previous\
    \ section.  Extended circuit status for L2TPv3/IP is described\n   in [RFC5641].\n\
    \   If the extended Circuit Status bits are not supported, and instead\n   only\
    \ the \"A bit\" (Active) is used as described in [RFC3931], a PE MAY\n   use CDN\
    \ messages to clear L2TPv3/IP sessions in the presence of\n   session-level failures\
    \ detected in the L2TPv3/IP PSN.\n   A PE MUST set the Active bit in the Circuit\
    \ Status to clear all\n   faults, and it MUST clear the Active bit in the Circuit\
    \ Status to\n   convey any defect that cannot be represented explicitly with specific\n\
    \   Circuit Status flags from [RFC3931] or [RFC5641].\n   The forward and reverse\
    \ defect indication definitions used in this\n   document map to the L2TP Circuit\
    \ Status AVP as follows:\n          Forward defect indication corresponds to the\
    \ logical OR of:\n            *  Local Attachment Circuit (ingress) Receive Fault,\n\
    \            *  Local PSN-facing PW (egress) Transmit Fault, and\n           \
    \ *  PW Not Forwarding.\n          Reverse defect indication corresponds to the\
    \ logical OR of:\n            *  Local Attachment Circuit (egress) Transmit Fault\
    \ and\n            *  Local PSN-facing PW (ingress) Receive Fault.\n   The status\
    \ notification conveys defects from the viewpoint of the\n   originating LCCE\
    \ (PE).\n   When the extended Circuit Status definition of [RFC5641] is\n   supported,\
    \ a PE SHALL use the Circuit Status to report all failures\n   affecting the PW\
    \ service including, but not restricted to, the\n   following:\n   o  defects\
    \ detected through defect detection mechanisms in the\n      L2TPv3/IP PSN,\n\
    \   o  defects detected through VCCV-Ping or VCCV-BFD CV types 0x04 (BFD\n   \
    \   IP/UDP-encapsulated, for PW Fault Detection only) and 0x10 (BFD\n      PW-ACH-encapsulated\
    \ (without IP/UDP headers), for PW.  Fault\n      Detection and AC/PW Fault Status\
    \ Signaling) for fault detection\n      only which are described in Section 6.1.3\
    \ of this document,\n   o  defects within the PE that result in an inability to\
    \ forward\n      traffic between the AC and the PW,\n   o  defects of the AC or\
    \ in the L2 network affecting the AC as per the\n      rules detailed in Section\
    \ 5 for the \"single emulated OAM loop\"\n      mode and the \"coupled OAM loops\"\
    \ modes.\n   When the extended Circuit Status definition of [RFC5641] is not\n\
    \   supported, a PE SHALL use the A bit in the Circuit Status AVP in the\n   SLI\
    \ to report:\n   o  defects of the AC or in the L2 network affecting the AC as\
    \ per the\n      rules detailed in Section 5 for the \"single emulated OAM loop\"\
    \n      mode and the \"coupled OAM loops\" modes.\n   When the extended Circuit\
    \ Status definition of [RFC5641] is not\n   supported, a PE MAY use the CDN and\
    \ StopCCN messages in a similar way\n   to an MPLS PW label withdrawal to report:\n\
    \   o  defects detected through defect detection mechanisms in the\n      L2TPv3/IP\
    \ PSN (using StopCCN),\n   o  defects detected through VCCV (pseudowire level)\
    \ (using CDN),\n   o  defects within the PE that result in an inability to forward\n\
    \      traffic between ACs and PW (using CDN).\n   For ATM L2TPv3/IP pseudowires,\
    \ in addition to the Circuit Status AVP,\n   a PE MAY use the ATM Alarm Status\
    \ AVP [RFC4454] to indicate the\n   reason for the ATM circuit status and the\
    \ specific alarm type, if\n   any.  This AVP is sent in the SLI message to indicate\
    \ additional\n   information about the ATM circuit status.\n   L2TP control connections\
    \ use Hello messages as a keep-alive facility.\n   It is important to note that\
    \ if PSN failure is detected by keep-alive\n   timeout, the control connection\
    \ is cleared.  L2TP Hello messages are\n   sent in-band so as to follow the data\
    \ plane with respect to the\n   source and destination addresses, IP protocol\
    \ number, and UDP port\n   (when UDP is used).\n"
- title: 6.1.3.  BFD Diagnostic Codes
  contents:
  - "6.1.3.  BFD Diagnostic Codes\n   BFD [RFC5880] defines a set of diagnostic codes\
    \ that partially\n   overlap the set of defects that can be communicated through\
    \ LDP\n   Status TLV or L2TP Circuit Status AVP.  This section describes the\n\
    \   behavior of the PEs with respect to using one or both of these\n   methods\
    \ for detecting and propagating defect state.\n   In the case of an MPLS PW established\
    \ via LDP signaling, the PEs\n   negotiate VCCV capabilities during the label\
    \ mapping messages\n   exchange used to establish the two directions of the PW.\
    \  This is\n   achieved by including a capability TLV in the PW Forward Error\n\
    \   Correction (FEC) interface parameters TLV.  In the L2TPv3/IP case,\n   the\
    \ PEs negotiate the use of VCCV during the pseudowire session\n   initialization\
    \ using the VCCV AVP [RFC5085].\n   The CV Type Indicators field in the OAM capability\
    \ TLV or VCCV AVP\n   defines a bitmask used to indicate the specific OAM capabilities\
    \ that\n   the PE can use over the PW being established.\n   A CV type of 0x04\
    \ or 0x10 [RFC5885] indicates that BFD is used for PW\n   fault detection only.\
    \  These CV types MAY be used any time the PW is\n   established using LDP or\
    \ L2TP control planes.  In this mode, only the\n   following diagnostic (Diag)\
    \ codes specified in [RFC5880] will be\n   used:\n     0 -  No diagnostic\n  \
    \   1 -  Control detection time expired\n     3 -  Neighbor signaled session down\n\
    \     7 -  Administratively Down\n   A PE using VCCV-BFD MUST use diagnostic code\
    \ 0 to indicate to its\n   peer PE that it is correctly receiving BFD control\
    \ messages.  It MUST\n   use diagnostic code 1 to indicate to its peer that it\
    \ has stopped\n   receiving BFD control messages and will thus declare the PW\
    \ to be\n   down in the receive direction.  It MUST use diagnostic code 3 to\n\
    \   confirm to its peer that the BFD session is going down after\n   receiving\
    \ diagnostic code 1 from this peer.  In this case, it will\n   declare the PW\
    \ to be down in the transmit direction.  A PE MUST use\n   diagnostic code 7 to\
    \ bring down the BFD session when the PW is\n   brought down administratively.\
    \  All other defects, such as AC/PW\n   defects and PE internal failures that\
    \ prevent it from forwarding\n   traffic, MUST be communicated through the LDP\
    \ Status TLV in the case\n   of MPLS or MPLS/IP PSN, or through the appropriate\
    \ L2TP codes in the\n   Circuit Status AVP in the case of L2TPv3/IP PSN.\n   A\
    \ CV type of 0x08 or 0x20 in the OAM capabilities TLV indicates that\n   BFD is\
    \ used for both PW fault detection and Fault Notification.  In\n   addition to\
    \ the above diagnostic codes, a PE uses the following codes\n   to signal AC defects\
    \ and other defects impacting forwarding over the\n   PW service:\n     6 -  Concatenated\
    \ Path Down\n     8 -  Reverse Concatenated Path Down\n   As specified in [RFC5085],\
    \ the PEs negotiate the use of VCCV during\n   PW setup.  When a PW transported\
    \ over an MPLS-PSN is established\n   using LDP, the PEs negotiate the use of\
    \ the VCCV capabilities using\n   the optional VCCV Capability Advertisement Sub-TLV\
    \ parameter in the\n   Interface Parameter Sub-TLV field of the LDP PW ID FEC\
    \ or using an\n   Interface Parameters TLV of the LDP Generalized PW ID FEC. \
    \ In the\n   case of L2TPv3/IP PSNs, the PEs negotiate the use of VCCV during\
    \ the\n   pseudowire session initialization using VCCV AVP.\n   Note that a defect\
    \ that causes the generation of the \"PW not\n   forwarding code\" (diagnostic\
    \ code 6 or 8) does not necessarily result\n   in the BFD session going down.\
    \  However, if the BFD session times\n   out, then diagnostic code 1 MUST be used\
    \ since it signals a state\n   change of the BFD session itself.  In general,\
    \ when a BFD session\n   changes state, the PEs MUST use state change diagnostic\
    \ codes 0, 1,\n   3, and 7 in accordance with [RFC5880], and they MUST override\
    \ any of\n   the AC/PW status diagnostic codes (codes 6 or 8) that may have been\n\
    \   signaled prior to the BFD session changing state.\n   The forward and reverse\
    \ defect indications used in this document map\n   to the following BFD codes:\n\
    \          Forward defect indication corresponds to the logical OR of:\n     \
    \       *  Concatenated Path Down (BFD diagnostic code 06)\n            *  Pseudowire\
    \ Not Forwarding (PW status code 0x00000001).\n          Reverse defect indication\
    \ corresponds to:\n            *  Reverse Concatenated Path Down (BFD diagnostic\
    \ code 08).\n   These diagnostic codes are used to signal forward and reverse\
    \ defect\n   states, respectively, when the PEs negotiated the use of BFD as the\n\
    \   mechanism for AC and PW fault detection and status signaling\n   notification.\
    \  As stated in Section 6.1, these CV types SHOULD NOT be\n   used when the PW\
    \ is established with the LDP or L2TP control plane.\n"
- title: 6.2.  PW Defect State Entry/Exit
  contents:
  - '6.2.  PW Defect State Entry/Exit

    '
- title: 6.2.1.  PW Receive Defect State Entry/Exit Criteria
  contents:
  - "6.2.1.  PW Receive Defect State Entry/Exit Criteria\n   PE1, as downstream PE,\
    \ will enter the PW receive defect state if one\n   or more of the following occurs:\n\
    \   o  It receives a forward defect indication (FDI) from PE2 indicating\n   \
    \   either a receive defect on the remote AC or that PE2 detected or\n      was\
    \ notified of downstream PW fault.\n   o  It detects loss of connectivity on the\
    \ PSN tunnel upstream of PE1,\n      which affects the traffic it receives from\
    \ PE2.\n   o  It detects a loss of PW connectivity through VCCV-BFD or VCCV-\n\
    \      PING, which affects the traffic it receives from PE2.\n   Note that if\
    \ the PW control session (LDP session, the L2TP session,\n   or the L2TP control\
    \ connection) between the PEs fails, the PW is torn\n   down and needs to be re-established.\
    \  However, the consequent actions\n   towards the ACs are the same as if the\
    \ PW entered the receive defect\n   state.\n   PE1 will exit the PW receive defect\
    \ state when the following\n   conditions are met.  Note that this may result\
    \ in a transition to the\n   PW operational state or the PW transmit defect state.\n\
    \   o  All previously detected defects have disappeared, and\n   o  PE2 cleared\
    \ the FDI, if applicable.\n"
- title: 6.2.2.  PW Transmit Defect State Entry/Exit Criteria
  contents:
  - "6.2.2.  PW Transmit Defect State Entry/Exit Criteria\n   PE1, as upstream PE,\
    \ will enter the PW transmit defect state if the\n   following conditions occur:\n\
    \   o  It receives a Reverse Defect Indication (RDI) from PE2 indicating\n   \
    \   either a transmit fault on the remote AC or that PE2 detected or\n      was\
    \ notified of a upstream PW fault, and\n   o  it is not already in the PW receive\
    \ defect state.\n   PE1 will exit the transmit defect state if it receives an\
    \ OAM message\n   from PE2 clearing the RDI, or it has entered the PW receive\
    \ defect\n   state.\n   For a PW over L2TPv3/IP using the basic Circuit Status\
    \ AVP [RFC3931],\n   the PW transmit defect state is not valid and a PE can only\
    \ enter the\n   PW receive defect state.\n"
- title: 7.  Procedures for ATM PW Service
  contents:
  - "7.  Procedures for ATM PW Service\n   The following procedures apply to Asynchronous\
    \ Transfer Mode (ATM)\n   pseudowires [RFC4717].  ATM terminology is explained\
    \ in Appendix A.2\n   of this document.\n"
- title: 7.1.  AC Receive Defect State Entry/Exit Criteria
  contents:
  - "7.1.  AC Receive Defect State Entry/Exit Criteria\n   When operating in the coupled\
    \ OAM loops mode, PE1 enters the AC\n   receive defect state when any of the following\
    \ conditions are met:\n   a. It detects or is notified of a physical layer fault\
    \ on the ATM\n      interface.\n   b. It receives an end-to-end Flow 4 OAM (F4)\
    \ Alarm Indication Signal\n      (AIS) OAM flow on a Virtual Path (VP) AC or an\
    \ end-to-end Flow 5\n      (F5) AIS OAM flow on a Virtual Circuit (VC) as per\
    \ ITU-T\n      Recommendation I.610 [I.610], indicating that the ATM VPC or VCC\n\
    \      is down in the adjacent Layer 2 ATM network.\n   c. It receives a segment\
    \ F4 AIS OAM flow on a VP AC, or a segment F5\n      AIS OAM flow on a VC AC,\
    \ provided that the operator has\n      provisioned segment OAM and the PE is\
    \ not a segment endpoint.\n   d. It detects loss of connectivity on the ATM VPC/VCC\
    \ while\n      terminating segment or end-to-end ATM continuity check (ATM CC)\n\
    \      cells with the local ATM network and CE.\n   When operating in the coupled\
    \ OAM loops mode, PE1 exits the AC\n   receive defect state when all previously\
    \ detected defects have\n   disappeared.\n   When operating in the single emulated\
    \ OAM loop mode, PE1 enters the\n   AC receive defect state if any of the following\
    \ conditions are met:\n   a. It detects or is notified of a physical layer fault\
    \ on the ATM\n      interface.\n   b. It detects loss of connectivity on the ATM\
    \ VPC/VCC while\n      terminating segment ATM continuity check (ATM CC) cells\
    \ with the\n      local ATM network and CE.\n   When operating in the single emulated\
    \ OAM loop mode, PE1 exits the AC\n   receive defect state when all previously\
    \ detected defects have\n   disappeared.\n   The exact conditions under which\
    \ a PE enters and exits the AIS state,\n   or declares that connectivity is restored\
    \ via ATM CC, are defined in\n   Section 9.2 of [I.610].\n"
- title: 7.2.  AC Transmit Defect State Entry/Exit Criteria
  contents:
  - "7.2.  AC Transmit Defect State Entry/Exit Criteria\n   When operating in the\
    \ coupled OAM loops mode, PE1 enters the AC\n   transmit defect state if any of\
    \ the following conditions are met:\n   a. It terminates an end-to-end F4 RDI\
    \ OAM flow, in the case of a VPC,\n      or an end-to-end F5 RDI OAM flow, in\
    \ the case of a VCC, indicating\n      that the ATM VPC or VCC is down in the\
    \ adjacent L2 ATM.\n   b. It receives a segment F4 RDI OAM flow on a VP AC, or\
    \ a segment F5\n      RDI OAM flow on a VC AC, provided that the operator has\n\
    \      provisioned segment OAM and the PE is not a segment endpoint.\n   PE1 exits\
    \ the AC transmit defect state if the AC state transitions to\n   working or to\
    \ the AC receive defect state.  The exact conditions for\n   exiting the RDI state\
    \ are described in Section 9.2 of [I.610].\n   Note that the AC transmit defect\
    \ state is not valid when operating in\n   the single emulated OAM loop mode,\
    \ as PE1 transparently forwards the\n   received RDI cells as user cells over\
    \ the ATM PW to the remote CE.\n"
- title: 7.3.  Consequent Actions
  contents:
  - "7.3.  Consequent Actions\n   In the remainder of this section, the text refers\
    \ to AIS, RDI, and CC\n   without specifying whether there is an F4 (VP-level)\
    \ flow or an F5\n   (VC-level) flow, or whether it is an end-to-end or a segment\
    \ flow.\n   Precise ATM OAM procedures for each type of flow are specified in\n\
    \   Section 9.2 of [I.610].\n"
- title: 7.3.1.  PW Receive Defect State Entry/Exit
  contents:
  - "7.3.1.  PW Receive Defect State Entry/Exit\n   On entry to the PW receive defect\
    \ state:\n   a. PE1 MUST commence AIS insertion into the corresponding AC.\n \
    \  b. PE1 MUST cease generation of CC cells on the corresponding AC, if\n    \
    \  applicable.\n   c. If the PW defect was detected by PE1 without receiving FDI\
    \ from\n      PE2, PE1 MUST assume PE2 has no knowledge of the defect and MUST\n\
    \      notify PE2 by sending RDI.\n   On exit from the PW receive defect state:\n\
    \   a. PE1 MUST cease AIS insertion into the corresponding AC.\n   b. PE1 MUST\
    \ resume any CC cell generation on the corresponding AC, if\n      applicable.\n\
    \   c. PE1 MUST clear the RDI to PE2, if applicable.\n"
- title: 7.3.2.  PW Transmit Defect State Entry/Exit
  contents:
  - "7.3.2.  PW Transmit Defect State Entry/Exit\n   On entry to the PW Transmit Defect\
    \ State:\n   a. PE1 MUST commence RDI insertion into the corresponding AC.\n \
    \  b. If the PW failure was detected by PE1 without receiving RDI from\n     \
    \ PE2, PE1 MUST assume PE2 has no knowledge of the defect and MUST\n      notify\
    \ PE2 by sending FDI.\n   On exit from the PW Transmit Defect State:\n   a. PE1\
    \ MUST cease RDI insertion into the corresponding AC.\n   b. PE1 MUST clear the\
    \ FDI to PE2, if applicable.\n"
- title: 7.3.3.  PW Defect State in ATM Port Mode PW Service
  contents:
  - "7.3.3.  PW Defect State in ATM Port Mode PW Service\n   In case of transparent\
    \ cell transport PW service, i.e., \"port mode\",\n   where the PE does not keep\
    \ track of the status of individual ATM VPCs\n   or VCCs, a PE cannot relay PW\
    \ defect state over these VCCs and VPCs.\n   If ATM CC is run on the VCCs and\
    \ VPCs end-to-end (CE1 to CE2), or on\n   a segment originating and terminating\
    \ in the ATM network and spanning\n   the PSN network, it will time out and cause\
    \ the CE or ATM switch to\n   enter the ATM AIS state.\n"
- title: 7.3.4.  AC Receive Defect State Entry/Exit
  contents:
  - "7.3.4.  AC Receive Defect State Entry/Exit\n   On entry to the AC receive defect\
    \ state and when operating in the\n   coupled OAM loops mode:\n   a. PE1 MUST\
    \ send FDI to PE2.\n   b. PE1 MUST commence insertion of ATM RDI cells into the\
    \ AC towards\n      CE1.\n   When operating in the single emulated OAM loop mode,\
    \ PE1 must be able\n   to support two options, subject to the operator's preference.\
    \  The\n   default option is the following:\n   On entry to the AC receive defect\
    \ state:\n   a. PE1 MUST transparently relay ATM AIS cells, or, in the case of\
    \ a\n      local AC defect, commence insertion of ATM AIS cells into the\n   \
    \   corresponding PW towards CE2.\n   b. If the defect interferes with NS OAM\
    \ message generation, PE1 MUST\n      send FDI to PE2.\n   c. PE1 MUST cease the\
    \ generation of CC cells on the corresponding PW,\n      if applicable.\n   In\
    \ certain operational models, for example, in the case that the ATM\n   access\
    \ network is owned by a different provider than the PW, an\n   operator may want\
    \ to distinguish between defects detected in the ATM\n   access network and defects\
    \ detected on the AC directly adjacent to\n   the PE.  Therefore, the following\
    \ option MUST also be supported:\n   a. PE1 MUST transparently relay ATM AIS cells\
    \ over the corresponding\n      PW towards CE2.\n   b. Upon detection of a defect\
    \ on the ATM interface on the PE or in\n      the PE itself, PE1 MUST send FDI\
    \ to PE2.\n   c. PE1 MUST cease generation of CC cells on the corresponding PW,\
    \ if\n      applicable.\n   On exit from the AC receive defect state and when\
    \ operating in the\n   coupled OAM loops mode:\n   a. PE1 MUST clear the FDI to\
    \ PE2.\n   b. PE1 MUST cease insertion of ATM RDI cells into the AC.\n   On exit\
    \ from the AC receive defect state and when operating in the\n   single emulated\
    \ OAM loop mode:\n   a. PE1 MUST cease insertion of ATM AIS cells into the corresponding\n\
    \      PW.\n   b. PE1 MUST clear the FDI to PE2, if applicable.\n   c. PE1 MUST\
    \ resume any CC cell generation on the corresponding PW, if\n      applicable.\n"
- title: 7.3.5.  AC Transmit Defect State Entry/Exit
  contents:
  - "7.3.5.  AC Transmit Defect State Entry/Exit\n   On entry to the AC transmit defect\
    \ state and when operating in the\n   coupled OAM loops mode:\n   *  PE1 MUST\
    \ send RDI to PE2.\n   On exit from the AC transmit defect state and when operating\
    \ in the\n   coupled OAM loops mode:\n   *  PE1 MUST clear the RDI to PE2.\n"
- title: 8.  Procedures for Frame Relay PW Service
  contents:
  - "8.  Procedures for Frame Relay PW Service\n   The following procedures apply\
    \ to Frame Relay (FR) pseudowires\n   [RFC4619].  Frame Relay (FR) terminology\
    \ is explained in Appendix A.1\n   of this document.\n"
- title: 8.1.  AC Receive Defect State Entry/Exit Criteria
  contents:
  - "8.1.  AC Receive Defect State Entry/Exit Criteria\n   PE1 enters the AC receive\
    \ defect state if one or more of the\n   following conditions are met:\n   a.\
    \ A Permanent Virtual Circuit (PVC) is not deleted from the FR\n      network\
    \ and the FR network explicitly indicates in a full status\n      report (and\
    \ optionally by the asynchronous status message) that\n      this PVC is inactive\
    \ [Q.933].  In this case, this status maps\n      across the PE to the corresponding\
    \ PW only.\n   b. The Link Integrity Verification (LIV) indicates that the link\
    \ from\n      the PE to the Frame Relay network is down [Q.933].  In this case,\n\
    \      the link down indication maps across the PE to all corresponding\n    \
    \  PWs.\n   c. A physical layer alarm is detected on the FR interface.  In this\n\
    \      case, this status maps across the PE to all corresponding PWs.\n   PE1\
    \ exits the AC receive defect state when all previously detected\n   defects have\
    \ disappeared.\n"
- title: 8.2.  AC Transmit Defect State Entry/Exit Criteria
  contents:
  - "8.2.  AC Transmit Defect State Entry/Exit Criteria\n   The AC transmit defect\
    \ state is not valid for a FR AC.\n"
- title: 8.3.  Consequent Actions
  contents:
  - '8.3.  Consequent Actions

    '
- title: 8.3.1.  PW Receive Defect State Entry/Exit
  contents:
  - "8.3.1.  PW Receive Defect State Entry/Exit\n   The A (Active) bit indicates whether\
    \ the FR PVC is ACTIVE (1) or\n   INACTIVE (0) as explained in [RFC4591].\n  \
    \ On entry to the PW receive defect state:\n   a. PE1 MUST clear the Active bit\
    \ for the corresponding FR AC in a\n      full status report, and optionally in\
    \ an asynchronous status\n      message, as per [Q.933], Annex A.\n   b. If the\
    \ PW failure was detected by PE1 without receiving FDI from\n      PE2, PE1 MUST\
    \ assume PE2 has no knowledge of the defect and MUST\n      notify PE2 by sending\
    \ RDI.\n   On exit from the PW receive defect state:\n   a. PE1 MUST set the Active\
    \ bit for the corresponding FR AC in a full\n      status report, and optionally\
    \ in an asynchronous status message,\n      as per [Q.933], Annex A.  PE1 does\
    \ not apply this procedure on a\n      transition from the PW receive defect state\
    \ to the PW transmit\n      defect state.\n   b. PE1 MUST clear the RDI to PE2,\
    \ if applicable.\n"
- title: 8.3.2.  PW Transmit Defect State Entry/Exit
  contents:
  - "8.3.2.  PW Transmit Defect State Entry/Exit\n   On entry to the PW transmit defect\
    \ state:\n   a. PE1 MUST clear the Active bit for the corresponding FR AC in a\n\
    \      full status report, and optionally in an asynchronous status\n      message,\
    \ as per [Q.933], Annex A.\n   b. If the PW failure was detected by PE1 without\
    \ RDI from PE2, PE1\n      MUST assume PE2 has no knowledge of the defect and\
    \ MUST notify PE2\n      by sending FDI.\n   On exit from the PW transmit defect\
    \ state:\n   a. PE1 MUST set the Active bit for the corresponding FR AC in a full\n\
    \      status report, and optionally in an asynchronous status message,\n    \
    \  as per [Q.933], Annex A.  PE1 does not apply this procedure on a\n      transition\
    \ from the PW transmit defect state to the PW receive\n      defect state.\n \
    \  b. PE1 MUST clear the FDI to PE2, if applicable.\n"
- title: 8.3.3.  PW Defect State in the FR Port Mode PW Service
  contents:
  - "8.3.3.  PW Defect State in the FR Port Mode PW Service\n   In case of port mode\
    \ PW service, STATUS ENQUIRY and STATUS messages\n   are transported transparently\
    \ over the PW.  A PW Failure will\n   therefore result in timeouts of the Q.933\
    \ link and PVC management\n   protocol at the Frame Relay devices at one or both\
    \ sites of the\n   emulated interface.\n"
- title: 8.3.4.  AC Receive Defect State Entry/Exit
  contents:
  - "8.3.4.  AC Receive Defect State Entry/Exit\n   On entry to the AC receive defect\
    \ state:\n   *  PE1 MUST send FDI to PE2.\n   On exit from the AC receive defect\
    \ state:\n   *  PE1 MUST clear the FDI to PE2.\n"
- title: 8.3.5.  AC Transmit Defect State Entry/Exit
  contents:
  - "8.3.5.  AC Transmit Defect State Entry/Exit\n   The AC transmit defect state\
    \ is not valid for an FR AC.\n"
- title: 9.  Procedures for TDM PW Service
  contents:
  - "9.  Procedures for TDM PW Service\n   The following procedures apply to SAToP\
    \ [RFC4553], CESoPSN [RFC5086]\n   and TDMoIP [RFC5087].  These technologies utilize\
    \ the single emulated\n   OAM loop mode.  RFC 5087 distinguishes between trail-extended\
    \ and\n   trail-terminated scenarios; the former is essentially the single\n \
    \  emulated loop model.  The latter applies to cases where the NS\n   networks\
    \ are run by different operators and defect notifications are\n   not propagated\
    \ across the PW.\n   Since TDM is inherently real-time in nature, many OAM indications\n\
    \   must be generated or forwarded with minimal delay.  This requirement\n   rules\
    \ out the use of messaging protocols, such as PW status messages.\n   Thus, for\
    \ TDM PWs, alternate mechanisms are employed.\n   The fact that TDM PW packets\
    \ are sent at a known constant rate can be\n   exploited as an OAM mechanism.\
    \  Thus, a PE enters the PW receive\n   defect state whenever a preconfigured\
    \ number of TDM PW packets do not\n   arrive in a timely fashion.  It exits this\
    \ state when packets once\n   again arrive at their proper rate.\n   Native TDM\
    \ carries OAM indications in overhead fields that travel\n   along with the data.\
    \  TDM PWs emulate this behavior by sending urgent\n   OAM messages in the PWE\
    \ control word.\n   The TDM PWE3 control word contains a set of flags used to\
    \ indicate PW\n   and AC defect conditions.  The L bit is an AC forward defect\n\
    \   indication used by the upstream PE to signal NS network defects to\n   the\
    \ downstream PE.  The M field may be used to modify the meaning of\n   receive\
    \ defects.  The R bit is a PW reverse defect indication used by\n   the PE to\
    \ signal PSN failures to the remote PE.  Upon reception of\n   packets with the\
    \ R bit set, a PE enters the PW transmit defect state.\n   L bits and R bits are\
    \ further described in [RFC5087].\n"
- title: 9.1.  AC Receive Defect State Entry/Exit Criteria
  contents:
  - "9.1.  AC Receive Defect State Entry/Exit Criteria\n   PE1 enters the AC receive\
    \ defect state if any of the following\n   conditions are met:\n   a. It detects\
    \ a physical layer fault on the TDM interface (Loss of\n      Signal, Loss of\
    \ Alignment, etc., as described in [G.775]).\n   b. It is notified of a previous\
    \ physical layer fault by detecting\n      AIS.\n   The exact conditions under\
    \ which a PE enters and exits the AIS state\n   are defined in [G.775].  Note\
    \ that Loss of Signal and AIS detection\n   can be performed by PEs for both structure-agnostic\
    \ and structure-\n   aware TDM PW types.  Note that PEs implementing structure-agnostic\n\
    \   PWs cannot detect Loss of Alignment.\n"
- title: 9.2.  AC Transmit Defect State Entry/Exit Criteria
  contents:
  - "9.2.  AC Transmit Defect State Entry/Exit Criteria\n   PE1 enters the AC transmit\
    \ defect state when it detects RDI according\n   to the criteria in [G.775]. \
    \ Note that PEs implementing structure-\n   agnostic PWs cannot detect RDI.\n"
- title: 9.3.  Consequent Actions
  contents:
  - '9.3.  Consequent Actions

    '
- title: 9.3.1.  PW Receive Defect State Entry/Exit
  contents:
  - "9.3.1.  PW Receive Defect State Entry/Exit\n   On entry to the PW receive defect\
    \ state:\n   a. PE1 MUST commence AIS insertion into the corresponding TDM AC.\n\
    \   b. PE1 MUST set the R bit in all PW packets sent back to PE2.\n   On exit\
    \ from the PW receive defect state:\n   a. PE1 MUST cease AIS insertion into the\
    \ corresponding TDM AC.\n   b. PE1 MUST clear the R bit in all PW packets sent\
    \ back to PE2.\n   Note that AIS generation can, in general, be performed by both\n\
    \   structure-aware and structure-agnostic PEs.\n"
- title: 9.3.2.  PW Transmit Defect State Entry/Exit
  contents:
  - "9.3.2.  PW Transmit Defect State Entry/Exit\n   On entry to the PW Transmit Defect\
    \ State:\n   *  A structure-aware PE1 MUST commence RDI insertion into the\n \
    \     corresponding AC.\n   On exit from the PW Transmit Defect State:\n   * \
    \ A structure-aware PE1 MUST cease RDI insertion into the\n      corresponding\
    \ AC.\n   Note that structure-agnostic PEs are not capable of injecting RDI\n\
    \   into an AC.\n"
- title: 9.3.3.  AC Receive Defect State Entry/Exit
  contents:
  - "9.3.3.  AC Receive Defect State Entry/Exit\n   On entry to the AC receive defect\
    \ state and when operating in the\n   single emulated OAM loop mode:\n   a. PE1\
    \ SHOULD overwrite the TDM data with AIS in the PW packets sent\n      towards\
    \ PE2.\n   b. PE1 MUST set the L bit in these packets.\n   c. PE1 MAY omit the\
    \ payload in order to conserve bandwidth.\n   d. A structure-aware PE1 SHOULD\
    \ send RDI back towards CE1.\n   e. A structure-aware PE1 that detects a potentially\
    \ correctable AC\n      defect MAY use the M field to indicate this.\n   On exit\
    \ from the AC receive defect state and when operating in the\n   single emulated\
    \ OAM loop mode:\n   a. PE1 MUST cease overwriting PW content with AIS and return\
    \ to\n      forwarding valid TDM data in PW packets sent towards PE2.\n   b. PE1\
    \ MUST clear the L bit in PW packets sent towards PE2.\n   c. A structure-aware\
    \ PE1 MUST cease sending RDI towards CE1.\n"
- title: 10.  Procedures for CEP PW Service
  contents:
  - "10.  Procedures for CEP PW Service\n   The following procedures apply to SONET/SDH\
    \ Circuit Emulation\n   [RFC4842].  They are based on the single emulated OAM\
    \ loop mode.\n   Since SONET and SDH are inherently real-time in nature, many\
    \ OAM\n   indications must be generated or forwarded with minimal delay.  This\n\
    \   requirement rules out the use of messaging protocols, such as PW\n   status\
    \ messages.  Thus, for CEP PWs alternate mechanisms are\n   employed.\n   The\
    \ CEP PWE3 control word contains a set of flags used to indicate PW\n   and AC\
    \ defect conditions.  The L bit is a forward defect indication\n   used by the\
    \ upstream PE to signal to the downstream PE a defect in\n   its local attachment\
    \ circuit.  The R bit is a PW reverse defect\n   indication used by the PE to\
    \ signal PSN failures to the remote PE.\n   The combination of N and P bits is\
    \ used by the local PE to signal\n   loss of pointer to the remote PE.\n   The\
    \ fact that CEP PW packets are sent at a known constant rate can be\n   exploited\
    \ as an OAM mechanism.  Thus, a PE enters the PW receive\n   defect state when\
    \ it loses packet synchronization.  It exits this\n   state when it regains packet\
    \ synchronization.  See [RFC4842] for\n   further details.\n"
- title: 10.1.  Defect States
  contents:
  - '10.1.  Defect States

    '
- title: 10.1.1.  PW Receive Defect State Entry/Exit
  contents:
  - "10.1.1.  PW Receive Defect State Entry/Exit\n   In addition to the conditions\
    \ specified in Section 6.2.1, PE1 will\n   enter the PW receive defect state when\
    \ one of the following becomes\n   true:\n   o  It receives packets with the L\
    \ bit set.\n   o  It receives packets with both the N and P bits set.\n   o  It\
    \ loses packet synchronization.\n"
- title: 10.1.2.  PW Transmit Defect State Entry/Exit
  contents:
  - "10.1.2.  PW Transmit Defect State Entry/Exit\n   In addition to the conditions\
    \ specified in Section 6.2.2, PE1 will\n   enter the PW transmit defect state\
    \ if it receives packets with the R\n   bit set.\n"
- title: 10.1.3.  AC Receive Defect State Entry/Exit
  contents:
  - "10.1.3.  AC Receive Defect State Entry/Exit\n   PE1 enters the AC receive defect\
    \ state when any of the following\n   conditions are met:\n   a. It detects a\
    \ physical layer fault on the TDM interface (Loss of\n      Signal, Loss of Alignment,\
    \ etc.).\n   b. It is notified of a previous physical layer fault by detecting\
    \ of\n      AIS.\n   The exact conditions under which a PE enters and exits the\
    \ AIS state\n   are defined in [G.707] and [G.783].\n"
- title: 10.1.4.  AC Transmit Defect State Entry/Exit
  contents:
  - "10.1.4.  AC Transmit Defect State Entry/Exit\n   The AC transmit defect state\
    \ is not valid for CEP PWs.  RDI signals\n   are forwarded transparently.\n"
- title: 10.2.  Consequent Actions
  contents:
  - '10.2.  Consequent Actions

    '
- title: 10.2.1.  PW Receive Defect State Entry/Exit
  contents:
  - "10.2.1.  PW Receive Defect State Entry/Exit\n   On entry to the PW receive defect\
    \ state:\n   a. PE1 MUST commence AIS-P/V insertion into the corresponding AC.\n\
    \      See [RFC4842].\n   b. PE1 MUST set the R bit in all PW packets sent back\
    \ to PE2.\n   On exit from the PW receive defect state:\n   a. PE1 MUST cease\
    \ AIS-P/V insertion into the corresponding AC.\n   b. PE1 MUST clear the R bit\
    \ in all PW packets sent back to PE2.\n   See [RFC4842] for further details.\n"
- title: 10.2.2.  PW Transmit Defect State Entry/Exit
  contents:
  - "10.2.2.  PW Transmit Defect State Entry/Exit\n   On entry to the PW Transmit\
    \ Defect State:\n   a. A structure-aware PE1 MUST commence RDI insertion into\
    \ the\n      corresponding AC.\n   On exit from the PW Transmit Defect State:\n\
    \   a. A structure-aware PE1 MUST cease RDI insertion into the\n      corresponding\
    \ AC.\n"
- title: 10.2.3.  AC Receive Defect State Entry/Exit
  contents:
  - "10.2.3.  AC Receive Defect State Entry/Exit\n   On entry to the AC receive defect\
    \ state:\n   a. PE1 MUST set the L bit in these packets.\n   b. If Dynamic Bandwidth\
    \ Allocation (DBA) has been enabled, PE1 MAY\n      omit the payload in order\
    \ to conserve bandwidth.\n   c. If Dynamic Bandwidth Allocation (DBA) is not enabled,\
    \ PE1 SHOULD\n      insert AIS-V/P in the SDH/SONET client layer in the PW packets\n\
    \      sent towards PE2.\n   On exit from the AC receive defect state:\n   a.\
    \ PE1 MUST cease overwriting PW content with AIS-P/V and return to\n      forwarding\
    \ valid data in PW packets sent towards PE2.\n   b. PE1 MUST clear the L bit in\
    \ PW packets sent towards PE2.\n   See [RFC4842] for further details.\n"
- title: 11.  Security Considerations
  contents:
  - "11.  Security Considerations\n   The mapping messages described in this document\
    \ do not change the\n   security functions inherent in the actual messages.  All\
    \ generic\n   security considerations applicable to PW traffic specified in Section\n\
    \   10 of [RFC3985] are applicable to NS OAM messages transferred inside\n   the\
    \ PW.\n   Security considerations in Section 10 of RFC 5085 for VCCV apply to\n\
    \   the OAM messages thus transferred.  Security considerations\n   applicable\
    \ to the PWE3 control protocol of RFC 4447 Section 8.2 apply\n   to OAM indications\
    \ transferred using the LDP status message.\n   Since the mechanisms of this document\
    \ enable propagation of OAM\n   messages and fault conditions between native service\
    \ networks and\n   PSNs, continuity of the end-to-end service depends on a trust\n\
    \   relationship between the operators of these networks.  Security\n   considerations\
    \ for such scenarios are discussed in Section 7 of\n   [RFC5254].\n"
- title: 12.  Contributors and Acknowledgments
  contents:
  - "12.  Contributors and Acknowledgments\n   Mustapha Aissaoui, Peter Busschbach,\
    \ Luca Martini, Monique Morrow,\n   Thomas Nadeau, and Yaakov (J) Stein, were\
    \ each, in turn, editors of\n   one or more revisions of this document.  All of\
    \ the above were\n   contributing authors, as was Dave Allan, david.i.allan@ericsson.com.\n\
    \   The following contributed significant ideas or text:\n      Matthew Bocci,\
    \ matthew.bocci@alcatel-lucent.co.uk\n      Simon Delord, Simon.A.DeLord@team.telstra.com\n\
    \      Yuichi Ikejiri, y.ikejiri@ntt.com\n      Kenji Kumaki, kekumaki@kddi.com\n\
    \      Satoru Matsushima, satoru.matsushima@tm.softbank.co.jp\n      Teruyuki\
    \ Oya, teruyuki.oya@tm.softbank.co.jp\n      Carlos Pignataro, cpignata@cisco.com\n\
    \      Vasile Radoaca, vasile.radoaca@alcatel-lucent.com\n      Himanshu Shah,\
    \ hshah@ciena.com\n      David Watkinson, david.watkinson@alcatel-lucent.com\n\
    \   The editors would like to acknowledge the contributions of Bertrand\n   Duvivier,\
    \ Adrian Farrel, Tiberiu Grigoriu, Ron Insler, Michel\n   Khouderchah, Vanson\
    \ Lim, Amir Maleki, Neil McGill, Chris Metz, Hari\n   Rakotoranto, Eric Rosen,\
    \ Mark Townsley, and Ben Washam.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [RFC2119]           Bradner, S., \"Key words\
    \ for use in RFCs to\n                       Indicate Requirement Levels\", BCP\
    \ 14, RFC 2119,\n                       March 1997.\n   [RFC4379]           Kompella,\
    \ K. and G. Swallow, \"Detecting Multi-\n                       Protocol Label\
    \ Switched (MPLS) Data Plane\n                       Failures\", RFC 4379, February\
    \ 2006.\n   [RFC4447]           Martini, L., Rosen, E., El-Aawar, N., Smith, T.,\n\
    \                       and G. Heron, \"Pseudowire Setup and Maintenance\n   \
    \                    Using the Label Distribution Protocol (LDP)\",\n        \
    \               RFC 4447, April 2006.\n   [RFC4553]           Vainshtein, A. and\
    \ YJ. Stein, \"Structure-Agnostic\n                       Time Division Multiplexing\
    \ (TDM) over Packet\n                       (SAToP)\", RFC 4553, June 2006.\n\
    \   [RFC4591]           Townsley, M., Wilkie, G., Booth, S., Bryant, S.,\n   \
    \                    and J. Lau, \"Frame Relay over Layer 2 Tunneling\n      \
    \                 Protocol Version 3 (L2TPv3)\", RFC 4591,\n                 \
    \      August 2006.\n   [RFC4619]           Martini, L., Kawa, C., and A. Malis,\n\
    \                       \"Encapsulation Methods for Transport of Frame\n     \
    \                  Relay over Multiprotocol Label Switching (MPLS)\n         \
    \              Networks\", RFC 4619, September 2006.\n   [RFC4717]           Martini,\
    \ L., Jayakumar, J., Bocci, M., El-Aawar,\n                       N., Brayley,\
    \ J., and G. Koleyni, \"Encapsulation\n                       Methods for Transport\
    \ of Asynchronous Transfer\n                       Mode (ATM) over MPLS Networks\"\
    , RFC 4717,\n                       December 2006.\n   [RFC4842]           Malis,\
    \ A., Pate, P., Cohen, R., and D. Zelig,\n                       \"Synchronous\
    \ Optical Network/Synchronous Digital\n                       Hierarchy (SONET/SDH)\
    \ Circuit Emulation over\n                       Packet (CEP)\", RFC 4842, April\
    \ 2007.\n   [RFC5036]           Andersson, L., Minei, I., and B. Thomas, \"LDP\n\
    \                       Specification\", RFC 5036, October 2007.\n   [RFC5085]\
    \           Nadeau, T. and C. Pignataro, \"Pseudowire Virtual\n              \
    \         Circuit Connectivity Verification (VCCV): A\n                      \
    \ Control Channel for Pseudowires\", RFC 5085,\n                       December\
    \ 2007.\n   [RFC5641]           McGill, N. and C. Pignataro, \"Layer 2 Tunneling\n\
    \                       Protocol Version 3 (L2TPv3) Extended Circuit\n       \
    \                Status Values\", RFC 5641, August 2009.\n   [RFC5880]       \
    \    Katz, D. and D. Ward, \"Bidirectional Forwarding\n                      \
    \ Detection (BFD)\", RFC 5880, June 2010.\n   [RFC5885]           Nadeau, T. and\
    \ C. Pignataro, \"Bidirectional\n                       Forwarding Detection (BFD)\
    \ for the Pseudowire\n                       Virtual Circuit Connectivity Verification\n\
    \                       (VCCV)\", RFC 5885, June 2010.\n   [G.707]           \
    \  \"Network node interface for the synchronous\n                       digital\
    \ hierarchy\", ITU-T Recommendation G.707,\n                       December 2003.\n\
    \   [G.775]             \"Loss of Signal (LOS), Alarm Indication Signal\n    \
    \                   (AIS) and Remote Defect Indication (RDI) defect\n        \
    \               detection and clearance criteria for PDH\n                   \
    \    signals\", ITU-T Recommendation G.775,\n                       October 1998.\n\
    \   [G.783]             \"Characteristics of synchronous digital hierarchy\n \
    \                      (SDH) equipment functional blocks\", ITU-\n           \
    \            T Recommendation G.783, March 2006.\n   [I.610]             \"B-ISDN\
    \ operation and maintenance principles and\n                       functions\"\
    , ITU-T Recommendation I.610,\n                       February 1999.\n   [Q.933]\
    \             \"ISDN Digital Subscriber Signalling System No. 1\n            \
    \           (DSS1)  Signalling specifications for frame mode\n               \
    \        switched and permanent virtual connection control\n                 \
    \      and status monitoring\", ITU- T Recommendation\n                      \
    \ Q.993, February 2003.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [RFC0792]           Postel, J., \"Internet\
    \ Control Message Protocol\",\n                       STD 5, RFC 792, September\
    \ 1981.\n   [RFC3031]           Rosen, E., Viswanathan, A., and R. Callon,\n \
    \                      \"Multiprotocol Label Switching Architecture\",\n     \
    \                  RFC 3031, January 2001.\n   [RFC3209]           Awduche, D.,\
    \ Berger, L., Gan, D., Li, T.,\n                       Srinivasan, V., and G.\
    \ Swallow, \"RSVP-TE:\n                       Extensions to RSVP for LSP Tunnels\"\
    , RFC 3209,\n                       December 2001.\n   [RFC3916]           Xiao,\
    \ X., McPherson, D., and P. Pate,\n                       \"Requirements for Pseudo-Wire\
    \ Emulation Edge-to-\n                       Edge (PWE3)\", RFC 3916, September\
    \ 2004.\n   [RFC3931]           Lau, J., Townsley, M., and I. Goyret, \"Layer\
    \ Two\n                       Tunneling Protocol - Version 3 (L2TPv3)\",\n   \
    \                    RFC 3931, March 2005.\n   [RFC3985]           Bryant, S.\
    \ and P. Pate, \"Pseudo Wire Emulation\n                       Edge-to-Edge (PWE3)\
    \ Architecture\", RFC 3985,\n                       March 2005.\n   [RFC4023]\
    \           Worster, T., Rekhter, Y., and E. Rosen,\n                       \"\
    Encapsulating MPLS in IP or Generic Routing\n                       Encapsulation\
    \ (GRE)\", RFC 4023, March 2005.\n   [RFC4377]           Nadeau, T., Morrow, M.,\
    \ Swallow, G., Allan, D.,\n                       and S. Matsushima, \"Operations\
    \ and Management\n                       (OAM) Requirements for Multi-Protocol\
    \ Label\n                       Switched (MPLS) Networks\", RFC 4377,\n      \
    \                 February 2006.\n   [RFC4385]           Bryant, S., Swallow,\
    \ G., Martini, L., and D.\n                       McPherson, \"Pseudowire Emulation\
    \ Edge-to-Edge\n                       (PWE3) Control Word for Use over an MPLS\
    \ PSN\",\n                       RFC 4385, February 2006.\n   [RFC4446]      \
    \     Martini, L., \"IANA Allocations for Pseudowire\n                       Edge\
    \ to Edge Emulation (PWE3)\", BCP 116,\n                       RFC 4446, April\
    \ 2006.\n   [RFC4454]           Singh, S., Townsley, M., and C. Pignataro,\n \
    \                      \"Asynchronous Transfer Mode (ATM) over Layer 2\n     \
    \                  Tunneling Protocol Version 3 (L2TPv3)\", RFC 4454,\n      \
    \                 May 2006.\n   [RFC5086]           Vainshtein, A., Sasson, I.,\
    \ Metz, E., Frost, T.,\n                       and P. Pate, \"Structure-Aware\
    \ Time Division\n                       Multiplexed (TDM) Circuit Emulation Service\
    \ over\n                       Packet Switched Network (CESoPSN)\", RFC 5086,\n\
    \                       December 2007.\n   [RFC5087]           Stein, Y(J)., Shashoua,\
    \ R., Insler, R., and M.\n                       Anavi, \"Time Division Multiplexing\
    \ over IP\n                       (TDMoIP)\", RFC 5087, December 2007.\n   [RFC5254]\
    \           Bitar, N., Bocci, M., and L. Martini,\n                       \"Requirements\
    \ for Multi-Segment Pseudowire\n                       Emulation Edge-to-Edge\
    \ (PWE3)\", RFC 5254,\n                       October 2008.\n   [RFC6073]    \
    \       Martini, L., Metz, C., Nadeau, T., Bocci, M., and\n                  \
    \     M. Aissaoui, \"Segmented Pseudowire\", RFC 6073,\n                     \
    \  January 2011.\n   [Eth-OAM-Inter]     Mohan, D., Bitar, N., DeLord, S., Niger,\
    \ P.,\n                       Sajassi, A., and R. Qiu, \"MPLS and Ethernet OAM\n\
    \                       Interworking\", Work in Progress, March 2011.\n   [Static-PW-Status]\
    \  Martini, L., Swallow, G., Heron, G., and M.\n                       Bocci,\
    \ \"Pseudowire Status for Static\n                       Pseudowires\", Work in\
    \ Progress, June 2011.\n   [I.620]             \"Frame relay operation and maintenance\
    \ principles\n                       and functions\", ITU-T Recommendation I.620,\n\
    \                       October 1996.\n"
- title: Appendix A.  Native Service Management (Informative)
  contents:
  - 'Appendix A.  Native Service Management (Informative)

    '
- title: A.1.  Frame Relay Management
  contents:
  - "A.1.  Frame Relay Management\n   The management of Frame Relay Bearer Service\
    \ (FRBS) connections can\n   be accomplished through two distinct methodologies:\n\
    \   a. Based on [Q.933], Annex A, Link Integrity Verification procedure,\n   \
    \   where STATUS and STATUS ENQUIRY signaling messages are sent using\n      DLCI=0\
    \ over a given User-Network Interface (UNI) and Network-\n      Network Interface\
    \ (NNI) physical link.\n   b. Based on FRBS Local Management Interface (LMI),\
    \ and similar to ATM\n      Integrated LMI (ILMI) where LMI is common in private\
    \ Frame Relay\n      networks.\n   In addition, ITU-T I.620 [I.620] addressed\
    \ Frame Relay loopback.\n   This Recommendation was withdrawn in 2004, and its\
    \ deployment was\n   limited.\n   It is possible to use either, or both, of the\
    \ above options to manage\n   Frame Relay interfaces.  This document will refer\
    \ exclusively to\n   Q.933 messages.\n   The status of any provisioned Frame Relay\
    \ PVC may be updated through:\n   a. Frame Relay STATUS messages in response to\
    \ Frame Relay STATUS\n      ENQUIRY messages; these are mandatory.\n   b. Optional\
    \ unsolicited STATUS updates independent of STATUS ENQUIRY\n      (typically,\
    \ under the control of management system, these updates\n      can be sent periodically\
    \ (continuous monitoring) or only upon\n      detection of specific defects based\
    \ on configuration).\n   In Frame Relay, a Data Link Connection (DLC) is either\
    \ up or down.\n   There is no distinction between different directions.  To achieve\n\
    \   commonality with other technologies, down is represented as a receive\n  \
    \ defect.\n   Frame Relay connection management is not implemented over the PW\n\
    \   using either of the techniques native to FR; therefore, PW mechanisms\n  \
    \ are used to synchronize the view each PE has of the remote Native\n   Service/Attachment\
    \ Circuit (NS/AC).  A PE will treat a remote NS/AC\n   failure in the same way\
    \ it would treat a PW or PSN failure, that is,\n   using AC facing FR connection\
    \ management to notify the CE that FR is\n   down.\n"
- title: A.2.  ATM Management
  contents:
  - "A.2.  ATM Management\n   ATM management and OAM mechanisms are much more evolved\
    \ than those of\n   Frame Relay.  There are five broad management-related categories,\n\
    \   including fault management (FT), Performance management (PM),\n   configuration\
    \ management (CM), Accounting management (AC), and\n   Security management (SM).\
    \  [I.610] describes the functions for the\n   operation and maintenance of the\
    \ physical layer and the ATM layer,\n   that is, management at the bit and cell\
    \ levels.  Because of its\n   scope, this document will concentrate on ATM fault\
    \ management\n   functions.  Fault management functions include the following:\n\
    \   a. Alarm Indication Signal (AIS).\n   b. Remote Defect Indication (RDI).\n\
    \   c. Continuity Check (CC).\n   d. Loopback (LB).\n   Some of the basic ATM\
    \ fault management functions are described as\n   follows: Alarm Indication Signal\
    \ (AIS) sends a message in the same\n   direction as that of the signal, to the\
    \ effect that an error has been\n   detected.\n   The Remote Defect Indication\
    \ (RDI) sends a message to the\n   transmitting terminal that an error has been\
    \ detected.  Alarms\n   related to the physical layer are indicated using path\
    \ AIS/RDI.\n   Virtual path AIS/RDI and virtual channel AIS/RDI are also generated\n\
    \   for the ATM layer.\n   OAM cells (F4 and F5 cells) are used to instrument\
    \ virtual paths and\n   virtual channels, respectively, with regard to their performance\
    \ and\n   availability.  OAM cells in the F4 and F5 flows are used for\n   monitoring\
    \ a segment of the network and end-to-end monitoring.  OAM\n   cells in F4 flows\
    \ have the same VPI as that of the connection being\n   monitored.  OAM cells\
    \ in F5 flows have the same VPI and VCI as that\n   of the connection being monitored.\
    \  The AIS and RDI messages of the\n   F4 and F5 flows are sent to the other network\
    \ nodes via the VPC or\n   the VCC to which the message refers.  The type of error\
    \ and its\n   location can be indicated in the OAM cells.  Continuity check is\n\
    \   another fault management function.  To check whether a VCC that has\n   been\
    \ idle for a period of time is still functioning, the network\n   elements can\
    \ send continuity-check cells along that VCC.\n"
- title: Appendix B.  PW Defects and Detection Tools
  contents:
  - 'Appendix B.  PW Defects and Detection Tools

    '
- title: B.1.  PW Defects
  contents:
  - "B.1.  PW Defects\n   Possible defects that impact PWs are the following:\n  \
    \ a. Physical layer defect in the PSN interface.\n   b. PSN tunnel failure that\
    \ results in a loss of connectivity between\n      ingress and egress PE.\n  \
    \ c. Control session failures between ingress and egress PE.\n   In case of an\
    \ MPLS PSN and an MPLS/IP PSN there are additional\n   defects:\n   a. PW labeling\
    \ error, which is due to a defect in the ingress PE, or\n      to an over-writing\
    \ of the PW label value somewhere along the LSP\n      path.\n   b. LSP tunnel\
    \ label swapping errors or LSP tunnel label merging\n      errors in the MPLS\
    \ network.  This could result in the termination\n      of a PW at the wrong egress\
    \ PE.\n   c. Unintended self-replication; e.g., due to loops or denial-of-\n \
    \     service attacks.\n"
- title: B.2.  Packet Loss
  contents:
  - "B.2.  Packet Loss\n   Persistent congestion in the PSN or in a PE could impact\
    \ the proper\n   operation of the emulated service.\n   A PE can detect packet\
    \ loss resulting from congestion through several\n   methods.  If a PE uses the\
    \ sequence number field in the PWE3 Control\n   Word for a specific pseudowire\
    \ [RFC3985] and [RFC4385], it has the\n   ability to detect packet loss.  Translation\
    \ of congestion detection\n   to PW defect states is beyond the scope of this\
    \ document.\n   There are congestion alarms that are raised in the node and to\
    \ the\n   management system when congestion occurs.  The decision to declare\n\
    \   the PW down and to select another path is usually at the discretion\n   of\
    \ the network operator.\n"
- title: B.3.  PW Defect Detection Tools
  contents:
  - "B.3.  PW Defect Detection Tools\n   To detect the defects listed above, Service\
    \ Providers have a variety\n   of options available.\n   Physical Layer defect\
    \ detection and notification mechanisms include\n   SONET/SDH Loss of Signal (LOS),\
    \ Loss of Alignment (LOA), and AIS/RDI.\n   PSN defect detection mechanisms vary\
    \ according to the PSN type.\n   For PWs over L2TPv3/IP PSNs, with L2TP as encapsulation\
    \ protocol, the\n   defect detection mechanisms described in [RFC3931] apply.\
    \  These\n   include, for example, the keep-alive mechanism performed with Hello\n\
    \   messages for detection of loss of connectivity between a pair of\n   LCCEs\
    \ (i.e., dead PE peer and path detection).  Furthermore, the\n   tools Ping and\
    \ Traceroute, based on ICMP Echo Messages [RFC0792]\n   apply and can be used\
    \ to detect defects on the IP PSN.  Additionally,\n   VCCV-Ping [RFC5085] and\
    \ VCCV-BFD [RFC5885] can also be used to detect\n   defects at the individual\
    \ pseudowire level.\n   For PWs over MPLS or MPLS/IP PSNs, several tools can be\
    \ used:\n   a. LSP-Ping and LSP-Traceroute [RFC4379] for LSP tunnel connectivity\n\
    \      verification.\n   b. LSP-Ping with Bi-directional Forwarding Detection\
    \ [RFC5885] for\n      LSP tunnel continuity checking.\n   c. Furthermore, if\
    \ Resource Reservation Protocol - Traffic\n      Engineering (RSVP-TE) is used\
    \ to set up the PSN Tunnels between\n      ingress and egress PE, the hello protocol\
    \ can be used to detect\n      loss of connectivity [RFC3209], but only at the\
    \ control plane.\n"
- title: B.4.  PW Specific Defect Detection Mechanisms
  contents:
  - "B.4.  PW Specific Defect Detection Mechanisms\n   [RFC4377] describes how LSP-Ping\
    \ and BFD can be used over individual\n   PWs for connectivity verification and\
    \ continuity checking,\n   respectively.\n   Furthermore, the detection of a fault\
    \ could occur at different points\n   in the network and there are several ways\
    \ the observing PE determines\n   a fault exists:\n   a. Egress PE detection of\
    \ failure (e.g., BFD).\n   b. Ingress PE detection of failure (e.g., LSP-PING).\n\
    \   c. Ingress PE notification of failure (e.g., RSVP Path-err).\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Mustapha Aissaoui\n   Alcatel-Lucent\n   600 March Rd\n\
    \   Kanata, ON  K2K 2E6\n   Canada\n   EMail: mustapha.aissaoui@alcatel-lucent.com\n\
    \   Peter Busschbach\n   Alcatel-Lucent\n   67 Whippany Rd\n   Whippany, NJ  07981\n\
    \   USA\n   EMail: busschbach@alcatel-lucent.com\n   Luca Martini\n   Cisco Systems,\
    \ Inc.\n   9155 East Nichols Avenue, Suite 400\n   Englewood, CO  80112\n   USA\n\
    \   EMail: lmartini@cisco.com\n   Monique Morrow\n   Cisco Systems, Inc.\n   Richtistrase\
    \ 7\n   CH-8304 Wallisellen\n   Switzerland\n   EMail: mmorrow@cisco.com\n   Thomas\
    \ Nadeau\n   CA Technologies\n   273 Corporate Dr.\n   Portsmouth, NH  03801\n\
    \   USA\n   EMail: Thomas.Nadeau@ca.com\n   Yaakov (Jonathan) Stein\n   RAD Data\
    \ Communications\n   24 Raoul Wallenberg St., Bldg C\n   Tel Aviv  69719\n   Israel\n\
    \   EMail: yaakov_s@rad.com\n"
