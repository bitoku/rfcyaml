- contents:
  - '               The OSPF Not-So-Stubby Area (NSSA) Option

    '
  title: __initial_text__
- contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol
    for the\n   Internet community, and requests discussion and suggestions for\n
    \  improvements.  Please refer to the current edition of the \"Internet\n   Official
    Protocol Standards\" (STD 1) for the standardization state\n   and status of this
    protocol.  Distribution of this memo is unlimited.\n"
  title: Status of this Memo
- contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2003).  All Rights Reserved.\n"
  title: Copyright Notice
- contents:
  - "Abstract\n   This memo documents an optional type of Open Shortest Path First\n
    \  (OSPF) area that is somewhat humorously referred to as a \"not-so-\n   stubby\"
    area (or NSSA).  NSSAs are similar to the existing OSPF stub\n   area configuration
    option but have the additional capability of\n   importing AS external routes
    in a limited fashion.\n   The OSPF NSSA Option was originally defined in RFC 1587.
    \ The\n   functional differences between this memo and RFC 1587 are explained\n
    \  in Appendix F.  All differences, while expanding capability, are\n   backward-compatible
    in nature.  Implementations of this memo and of\n   RFC 1587 will interoperate.\n"
  title: Abstract
- contents:
  - "Table Of Contents\n   1.0 Overview .................................................
    \ 2\n      1.1 Motivation - Transit Networks .........................  2\n      1.2
    Motivation - Corporate Networks .......................  4\n      1.3 Proposed
    Solution .....................................  5\n   2.0 NSSA Intra-Area Implementation
    Details ...................  7\n      2.1 The N-bit .............................................
    \ 7\n      2.2 Type-7 Address Ranges .................................  7\n      2.3
    Type-7 LSAs ...........................................  8\n      2.4 Originating
    Type-7 LSAs ...............................  9\n      2.5 Calculating Type-7 AS
    External Routes ................. 10\n      2.6 Incremental Updates ...................................
    14\n      2.7 Optionally Importing Summary Routes ................... 14\n   3.0
    Intra-AS Implementation Details .......................... 15\n      3.1 Type-7
    Translator Election ............................ 15\n      3.2 Translating Type-7
    LSAs into Type-5 LSAs .............. 16\n      3.3 Flushing Translated Type-7
    LSAs ....................... 19\n   4.0 Security Considerations ..................................
    20\n   5.0 Acknowledgements ......................................... 21\n   6.0
    Contributors ............................................. 22\n   7.0 References
    ............................................... 22\n   Appendix A: The Options
    Field ................................ 23\n   Appendix B: Router-LSAs ......................................
    24\n   Appendix C: Type-7 LSA Packet Format ......................... 26\n   Appendix
    D: Configuration Parameters ......................... 27\n   Appendix E: The P-bit
    Policy Paradox ......................... 28\n   Appendix F: Differences from RFC
    1587 ........................ 30\n   Author's Addresses ...........................................
    32\n   Full Copyright Statement ..................................... 33\n"
  title: Table Of Contents
- contents:
  - '1.0  Overview

    '
  - contents:
    - "1.1  Motivation - Transit Networks\n   Wide-area transit networks often have
      connections to moderately\n   complex \"leaf\" sites.  A leaf site may have
      multiple IP network\n   numbers assigned to it.  Typically, one of the leaf
      site's networks\n   is directly connected to a router provided and administered
      by the\n   transit network while the others are distributed throughout and\n
      \  administered by the site.  From the transit network's perspective,\n   all
      of the network numbers associated with the site make up a single\n   \"stub\"
      entity.  For example, BBN Planet has one site composed of a\n   class-B network,
      130.57.0.0, and a class-C network, 192.31.114.0.\n   From BBN Planet's perspective,
      this configuration looks something\n   like the diagram on the next page, where
      the \"cloud\" consists of the\n   subnets of 130.57 and network 192.31.114,
      all of which are learned by\n   RIP on router BR18.\n                  192.31.114\n
      \                     |\n                    (cloud)\n                --------------
      130.57.4\n                      |\n                      |\n                   ------
      131.119.13 ------\n                   |BR18|------------|BR10|\n                   ------
      \           ------\n                                        |\n                                        V\n
      \                               to BBN Planet \"core\" OSPF system\n   Topologically,
      this cloud looks very much like an OSPF stub area.\n   The advantages of running
      the cloud as an OSPF stub area are:\n      1. External routes learned from OSPF's
      Type-5 AS-external-LSAs are\n         not advertised beyond the router labeled
      \"BR10\".  This is\n         advantageous because the link between BR10 and
      BR18 may be a\n         low-speed link or the router BR18 may have limited resources.\n
      \     2. The transit network is abstracted to the \"leaf\" router BR18 by\n
      \        advertising only a default route across the link between BR10\n         and
      BR18.\n      3. The cloud becomes a single, manageable \"leaf\" with respect
      to\n         the transit network.\n      4. The cloud can become, logically,
      a part of the transit\n         network's OSPF routing system.\n   However,
      the original definition of the OSPF protocol (See [OSPF])\n   imposes topological
      limitations that restrict simple cloud topologies\n   from becoming OSPF stub
      areas.  In particular, it is illegal for a\n   stub area to import routes external
      to OSPF; thus it is not possible\n   for routers BR18 and BR10 to both be members
      of the stub area and to\n   import into OSPF as Type-5 AS-external-LSAs routes
      learned from RIP\n   or other IP routing protocols.  In order to run OSPF out
      to BR18,\n   BR18 must be a member of a non-stub area or the OSPF backbone before\n
      \  it can import routes other than its directly connected network(s).\n   Since
      it is not acceptable for BR18 to maintain all of BBN Planet's\n   Type-5 AS
      external routes, BBN Planet is forced by OSPF's topological\n   limitations
      to only run OSPF out to BR10 and to run RIP between BR18\n   and BR10.\n"
    title: 1.1  Motivation - Transit Networks
  - contents:
    - "1.2  Motivation - Corporate Networks\n   In a corporate network that supports
      a large corporate infrastructure\n   it is not uncommon for its OSPF domain
      to have a complex non-zero\n   area infrastructure that injects large routing
      tables into its Area 0\n   backbone.  Organizations within the corporate infrastructure
      may\n   routinely multi-home their non-zero OSPF areas to strategically\n   located
      Area 0 backbone routers, either to provide backbone\n   redundancy or to increase
      backbone connectivity or both.  Because of\n   these large routing tables, OSPF
      aggregation via summarization is\n   routinely used and recommended.  Stub areas
      are also recommended to\n   keep the size of the routing tables of non-backbone
      routers small.\n   Organizations within the corporation are administratively
      autonomous\n   and compete for corporate backbone resources.  They also want\n
      \  isolation from each other in order to protect their own network\n   resources
      within the organization.\n   Consider the typical example configuration shown
      below where routers\n   A1, B1 and A2, B2 are connected to Area 1 and Area 2
      respectively,\n   and where routers A0 and B0 are Area 0 border routers that
      connect to\n   both Area 1 and Area 2.  Assume the 192.168.192/20 and 192.168.208/22\n
      \  clouds are subnetted with a protocol different from the corporate\n   OSPF
      instance.  These other protocols could be RIP, IGRP, or second\n   and third
      OSPF instances separate from the corporate OSPF backbone\n   instance.\n   Area
      1 and Area 2 would like to be stub areas to minimize the size of\n   their link
      state databases.  It is also desirable to originate two\n   aggregated external
      advertisements for the subnets of 192.168.192/20\n   and 192.168.208/22 in such
      a way that the preferred path to\n   192.168.192/20 is through A0 and the preferred
      path to 192.168.208/22\n   is through B0.\n                  +---A0------Area
      0 cloud------B0---+\n                  |   |                          |   |\n
      \                 |   |                          |   |\n                  |
      \  |T1                   56kbs|   |\n             56kbs|   |                          |
      \  |T1\n                  |   |                          |   |\n                  |
      \  |       Area 1 cloud       |   |\n                  |   A1-----192.168.192/20-----B1
      \  |\n                  |                                  |\n                  +---A2
      \                       B2---+\n                       |                         |\n
      \                      |      Area 2 cloud       |\n                       +-----192.168.208/22------+\n
      \  The current standard OSPF stub area has no mechanism to support the\n   redistribution
      of routes for the subnets of 192.168.192/20 and\n   192.168.208/22 within a
      stub area or the ability to aggregate a range\n   of external routes in any
      OSPF area.  Any solution to this dilemma\n   must also honor Area 1's path of
      choice to 192.168.192/20 through A0\n   with redundancy through B0 while at
      the same time honoring Area 2's\n   path of choice to 192.168.208/20 through
      B0 with redundancy through\n   A0.\n"
    title: 1.2  Motivation - Corporate Networks
  - contents:
    - "1.3 Proposed Solution\n   This document describes a new optional type of OSPF
      area, somewhat\n   humorously referred to as a \"not-so-stubby\" area (or NSSA),
      which has\n   the capability of importing external routes in a limited fashion.\n
      \  The OSPF specification defines two general classes of area\n   configuration.
      \ The first allows Type-5 LSAs to be flooded throughout\n   the area.  In this
      configuration, Type-5 LSAs may be originated by\n   routers internal to the
      area or flooded into the area by area border\n   routers.  These areas, referred
      to herein as Type-5 capable areas (or\n   just plain areas in the OSPF specification),
      are distinguished by the\n   fact that they can carry transit traffic.  The
      backbone is always a\n   Type-5 capable area.  The second type of area configuration,
      called\n   stub, does not allow Type-5 LSAs to be propagated into/throughout
      the\n   area and instead depends on default routing to external destinations.\n
      \  NSSAs are defined in much the same manner as existing stub areas.  To\n   support
      NSSAs, a new option bit (the \"N\" bit) and a new type of LSA\n   (Type-7) are
      defined.  The \"N\" bit ensures that routers belonging to\n   an NSSA agree
      on its configuration.  Similar to the stub area's use\n   of the \"E\" bit,
      both NSSA neighbors must agree on the setting of the\n   \"N\" bit or the OSPF
      neighbor adjacency will not form.\n   Type-7 LSAs provide for carrying external
      route information within an\n   NSSA. Type-7 LSAs have virtually the same syntax
      as Type-5 LSAs with\n   the obvious exception of the link-state type.  (See
      section 2.3 for\n   more details.)   Both LSAs are considered a type of OSPF
      AS-\n   external-LSA.  There are two major semantic differences between\n   Type-5
      LSAs and Type-7 LSAs.\n      o  Type-7 LSAs may be originated by and advertised
      throughout an\n         NSSA; as with stub areas, Type-5 LSAs are not flooded
      into\n         NSSAs and do not originate there.\n      o  Type-7 LSAs are advertised
      only within a single NSSA; they are\n         not flooded into the backbone
      area or any other area by border\n         routers, though the information that
      they contain may be\n         propagated into the backbone area.  (See Section
      3.2.)\n   In order to allow limited exchange of external information across
      an\n   NSSA border, NSSA border routers will translate selected Type-7 LSAs\n
      \  received from the NSSA into Type-5 LSAs.  These Type-5 LSAs will be\n   flooded
      to all Type-5 capable areas.  NSSA border routers may be\n   configured with
      address ranges so that multiple Type-7 LSAs may be\n   aggregated into a single
      Type-5 LSA.  The NSSA border routers that\n   perform translation are configurable.
      \ In the absence of a configured\n   translator one is elected.\n   In addition,
      an NSSA border router should originate a default LSA (IP\n   network is 0.0.0.0/0)
      into the NSSA.  Default routes are necessary\n   because NSSAs do not receive
      full routing information and must have a\n   default route in order to route
      to AS-external destinations.  Like\n   stub areas, NSSAs may be connected to
      the Area 0 backbone at more\n   than one NSSA border router, but may not be
      used as a transit area.\n   Note that a Type-7 default LSA originated by an
      NSSA border router is\n   never translated into a Type-5 LSA, however, a Type-7
      default LSA\n   originated by an NSSA internal AS boundary router (one that
      is not an\n   NSSA border router) may be translated into a Type-5 LSA.\n   Like
      stub areas, NSSA border routers optionally import summary routes\n   into their
      NSSAs as Type-3 summary-LSAs.  If the import is disabled,\n   particular care
      should be taken to ensure that summary routing is not\n   obscured by an NSSA's
      Type-7 AS-external-LSAs.  This may happen when\n   the AS's other IGPs, like
      RIP and ISIS, leak routing information into\n   the NSSA.  In these cases all
      summary routes should be imported into\n   the NSSA.  The recommended default
      behavior is to import summary\n   routes into NSSAs.  Since Type-5 AS-external-LSAs
      are not flooded\n   into NSSAs, NSSA border routers should not originate Type-4
      summary-\n   LSAs into their NSSAs.  Also an NSSA's border routers never originate\n
      \  Type-4 summary-LSAs for the NSSA's AS boundary routers, since Type-7\n   AS-external-LSAs
      are never flooded beyond the NSSA's border.\n   When summary routes are not
      imported into an NSSA, the default LSA\n   originated into it by its border
      routers must be a Type-3 summary-\n   LSA.  This default summary-LSA insures
      intra-AS connectivity to the\n   rest of the OSPF domain, as its default summary
      route is preferred\n   over the default route of a Type-7 default LSA.  Without
      a default\n   summary route the OSPF domain's inter-area traffic, which is normally\n
      \  forwarded by summary routes, might exit the AS via the default route\n   of
      a Type-7 default LSA originated by an NSSA internal router.  The\n   Type-7
      default LSAs originated by NSSA internal routers and the no-\n   summary option
      are mutually exclusive features. When summary routes\n   are imported into the
      NSSA, the default LSA originated by a NSSA\n   border router into the NSSA should
      be a Type-7 LSA.\n   In our transit topology example the subnets of 130.57 and
      network\n   192.31.114 will still be learned by RIP on router BR18, but now
      both\n   BR10 and BR18 can be in an NSSA and all of BBN Planet's external\n
      \  routes are hidden from BR18; BR10 becomes an NSSA border router and\n   BR18
      becomes an AS boundary router internal to the NSSA.  BR18 will\n   import the
      subnets of 130.57 and network 192.31.114 as Type-7 LSAs\n   into the NSSA.  BR10
      then translates these routes into Type-5 LSAs\n   and floods them into BBN Planet's
      backbone.\n   In our corporate topology example if Area 1 and Area 2 are NSSAs
      the\n   external paths to the subnets of the address ranges 192.168.192/20\n
      \  and 192.168.208/22 can be redistributed as Type-7 LSAs throughout\n   Area
      1 and Area 2 respectively, and then aggregated during the\n   translation process
      into separate Type-5 LSAs that are flooded into\n   Area 0.  A0 may be configured
      as Area 1's translator even though B0\n   is the translator of Area 2.\n"
    title: 1.3 Proposed Solution
  - contents:
    - '2.0  NSSA Intra-Area Implementation Details

      '
    title: 2.0  NSSA Intra-Area Implementation Details
  - contents:
    - "2.1  The N-bit\n   The N-bit ensures that all members of an NSSA agree on the
      area's\n   configuration.  Together, the N-bit and E-bit reflect an interface's\n
      \  (and consequently the interface's associated area) external LSA\n   flooding
      capability.  As explained in [OSPF] Section 10.5, if Type-5\n   LSAs are not
      flooded into/throughout the area, the E-bit must be\n   clear in the option
      field of the received Hello packets.  Interfaces\n   associated with an NSSA
      will not send or receive Type-5 LSAs on that\n   interface but may send and
      receive Type-7 LSAs.  Therefore, if the\n   N-bit is set in the options field,
      the E-bit must be clear.\n   To support the NSSA option an additional check
      must be made in the\n   function that handles the receiving of the Hello packet
      to verify\n   that both the N-bit and the E-bit found in the Hello packet's
      option\n   field match the area type and ExternalRoutingCapability of the area\n
      \  of the receiving interface.  A mismatch in the options causes\n   processing
      of the received Hello packet to stop and the packet to be\n   dropped.\n"
    title: 2.1  The N-bit
  - contents:
    - "2.2  Type-7 Address Ranges\n   NSSA border routers may be configured with Type-7
      address ranges.\n   Each Type-7 address range is defined as an [address,mask]
      pair.  Many\n   separate Type-7 networks may fall into a single Type-7 address
      range,\n   just as a subnetted network is composed of many separate subnets.\n
      \  NSSA border routers may aggregate Type-7 routes by advertising a\n   single
      Type-5 LSA for each Type-7 address range.  The Type-5 LSA\n   resulting from
      a Type-7 address range match will be distributed to\n   all Type-5 capable areas.
      \ Section 3.2 details how Type-5 LSAs are\n   generated from Type-7 address
      ranges.\n   A Type-7 address range includes the following configurable items.\n
      \     o  An [address,mask] pair.\n      o  A status indication of either Advertise
      or DoNotAdvertise.\n      o  An external route tag.\n"
    title: 2.2  Type-7 Address Ranges
  - contents:
    - "2.3  Type-7 LSAs\n   External routes are imported into NSSAs as Type-7 LSAs
      by NSSA AS\n   boundary routers.  An NSSA AS boundary router (ASBR) is a router
      that\n   has an interface associated with the NSSA and is exchanging routing\n
      \  information with routers belonging to another AS.  Like OSPF ASBRs,\n   an
      NSSA router indicates it is an NSSA ASBR by setting the E-bit in\n   its router-LSA.
      \ As with Type-5 LSAs a separate Type-7 LSA is\n   originated for each destination
      network.  To support NSSAs the link-\n   state database must therefore be expanded
      to contain Type-7 LSAs.\n   Type-7 LSAs are identical to Type-5 LSAs except
      for the following\n   (see [OSPF] Section 12.4.4, \"AS external links\").\n
      \     1. The Type field in the LSA header is 7.\n      2. Type-7 LSAs are only
      flooded within the originating NSSA.  The\n         flooding of Type-7 LSAs
      follows the same rules as the flooding\n         of Type-1 and Type-2 LSAs.\n
      \     3. Type-7 LSAs are only listed within the OSPF area data\n         structures
      of their respective NSSAs, making them area\n         specific.  Type-5 LSAs,
      which are flooded to all Type-5 capable\n         areas, have global scope and
      are listed in the OSPF protocol\n         data structure.\n      4. NSSA border
      routers select which Type-7 LSAs are translated\n         into Type-5 LSAs and
      flooded into the OSPF domain's transit\n         topology.\n      5. Type-7
      LSAs have a propagate (P) bit that, when set, tells an\n         NSSA border
      router to translate a Type-7 LSA into a Type-5 LSA.\n      6. Those Type-7 LSAs
      that are to be translated into Type-5 LSAs\n         must have their forwarding
      address set.\n   Type-5 LSAs that are translations of Type-7 LSAs copy the Type-7\n
      \  LSAs' non-zero forwarding addresses.  Only those Type-5 LSAs that are\n   aggregations
      of Type-7 LSAs may have 0.0.0.0 as a forwarding address.\n   (See Section 3.2
      for details.)  Non-zero forwarding addresses produce\n   efficient inter-area
      routing to an NSSA's AS external destinations\n   when it has multiple border
      routers.  Also the non-zero forwarding\n   addresses of Type-7 LSAs ease the
      process of their translation into\n   Type-5 LSAs, as NSSA border routers are
      not required to compute them.\n   Normally the next hop address of an installed
      AS external route\n   learned by an NSSA ASBR from an adjacent AS points at
      one of the\n   adjacent AS's gateway routers.  If this address belongs to a
      network\n   connected to the NSSA ASBR via one of its NSSAs' active interfaces,\n
      \  then the NSSA ASBR copies this next hop address into the forwarding\n   address
      field of the route's Type-7 LSA that is originated into this\n   NSSA, as is
      currently done with Type-5 LSAs. (See [OSPF] Section\n   12.4.4.1.)  For an
      NSSA with no such network the forwarding address\n   field may only be filled
      with an address from one of the its active\n   interfaces or 0.0.0.0.  If the
      P-bit is set, the forwarding address\n   must be non-zero; otherwise it may
      be 0.0.0.0.  If an NSSA requires\n   the P-bit be set and a non-zero forwarding
      address is unavailable,\n   then the route's Type-7 LSA is not originated into
      this NSSA.\n   When a router is forced to pick a forwarding address for a Type-7\n
      \  LSA, preference should be given first to the router's internal\n   addresses
      (provided internal addressing is supported).  If internal\n   addresses are
      not available, preference should be given to the\n   router's active OSPF stub
      network addresses.  These choices avoid the\n   possible extra hop that may
      happen when a transit network's address\n   is used.  When the interface whose
      IP address is the LSA's forwarding\n   address transitions to a Down state (see
      [OSPF] Section 9.3), the\n   router must select a new forwarding address for
      the LSA and then re-\n   originate it.  If one is not available the LSA should
      be flushed.\n   The metrics and path types of Type-5 LSAs are directly comparable\n
      \  with the metrics and path types of Type-7 LSAs.\n"
    title: 2.3  Type-7 LSAs
  - contents:
    - "2.4 Originating Type-7 LSAs\n   NSSA AS boundary routers may only originate
      Type-7 LSAs into NSSAs.\n   An NSSA internal AS boundary router must set the
      P-bit in the LSA\n   header's option field of any Type-7 LSA whose network it
      wants\n   advertised into the OSPF domain's full transit topology.  The LSAs
      of\n   these networks must have a valid non-zero forwarding address.  If the\n
      \  P-bit is clear the LSA is not translated into a Type-5 LSA by NSSA\n   border
      routers.\n   When an NSSA border router originates both a Type-5 LSA and a Type-7\n
      \  LSA for the same network, then the P-bit must be clear in the Type-7\n   LSA
      so that it isn't translated into a Type-5 LSA by another NSSA\n   border router.
      \ If the border router only originates a Type-7 LSA, it\n   may set the P-bit
      so that the network may be aggregated/propagated\n   during Type-7 translation.
      \ If an NSSA's border router originates a\n   Type-5 LSA with a forwarding address
      from the NSSA, it should also\n   originate a Type-7 LSA into the NSSA.  If
      two NSSA routers, both\n   reachable from one another over the NSSA, originate
      functionally\n   equivalent Type-7 LSAs (i.e., same destination, cost and non-zero\n
      \  forwarding address), then the router having the least preferred LSA\n   should
      flush its LSA.  (See [OSPF] Section 12.4.4.1.)  Preference\n   between two Type-7
      LSAs is determined by the following tie breaker\n   rules:\n      1. An LSA
      with the P-bit set is preferred over one with the P-bit\n         clear.\n      2.
      If the P-bit settings are the same, the LSA with the higher\n         router
      ID is preferred.\n   A Type-7 default LSA for the network 0.0.0.0/0 may be originated
      into\n   the NSSA by any NSSA router.  The Type-7 default LSA originated by
      an\n   NSSA border router must have the P-bit clear.  An NSSA ASBR that is\n
      \  not an NSSA border router may originate a Type-7 default LSA with the\n   P-bit
      set.  A Type-7 default LSA may be installed by NSSA border\n   routers if and
      only if its P-bit is set.  (See Appendix E.)\n   NSSA border routers must originate
      an LSA for the default destination\n   into all their directly attached NSSAs
      in order to support intra-AS\n   routing and inter-AS routing.  This default
      destination is advertised\n   in either a Type-3 LSA or a Type-7 LSA, as described
      in Section 2.7.\n   The default LSA's metric should be configurable. For Type-7
      default\n   LSAs, the metric type (1 or 2) should also be configurable.\n"
    title: 2.4 Originating Type-7 LSAs
  - contents:
    - "2.5 Calculating Type-7 AS External Routes\n   This calculation must be run
      when Type-7 LSAs are processed during\n   the AS external route calculation.
      \ This calculation may process\n   Type-5 LSAs, but it is written that way only
      for comparison sake.\n   Non-default Type-7 LSAs with the P-bit clear may be
      installed in the\n   OSPF routing table of NSSA border routers.  Since these
      LSAs are not\n   propagated throughout the OSPF domain, traffic that originates\n
      \  external to an NSSA and that passes through one of the NSSA's border\n   routers
      may be unexpectedly diverted into the NSSA.  (See Appendix\n   E.)\n   An NSSA
      border router should examine both Type-5 LSAs and Type-7 LSAs\n   if either
      Type-5 or Type-7 routes need to be updated or recalculated.\n   This is done
      as part of the AS external route calculation.  An NSSA\n   internal router should
      examine Type-7 LSAs when Type-7 routes need to\n   be recalculated.\n   What
      follows is only a modest modification of [OSPF] Section 16.4.\n   Original paragraphs
      are tagged with [OSPF].  Paragraphs with minor\n   changes are tagged with ~[OSPF].
      \ Paragraphs specific to NSSA are\n   tagged with [NSSA].\n   AS external routes
      are calculated by examining AS-external-LSAs, be\n   they Type-5 or Type-7.
      \ Each of the AS-external-LSAs is considered in\n   turn.  Most AS-external-LSAs
      describe routes to specific IP\n   destinations.  An AS-external-LSA can also
      describe a default route\n   for the Autonomous System (Destination ID = DefaultDestination,\n
      \  network/subnet mask = 0x00000000).  For each AS-external-LSA:\n   ~[OSPF]\n
      \     (1) If the metric specified by the LSA is LSInfinity, or if the\n          age
      of the LSA equals MaxAge, then examine the next LSA.\n          [OSPF]\n      (2)
      If the LSA was originated by the calculating router itself,\n          examine
      the next LSA.\n          [OSPF]\n      (3) Call the destination described by
      the LSA N.  N's address is\n          obtained by masking the LSA's Link State
      ID with the\n          network/subnet mask contained in the body of the LSA.
      \ Look up\n          the routing table entries that match the LSA's type for
      the AS\n          boundary router (ASBR) that originated the LSA.  For a Type-5\n
      \         LSA, routing table entries may only be selected from each\n          attached
      Type-5 capable area.  Since the flooding scope of a\n          Type-7 LSA is
      restricted to the originating NSSA, the routing\n          table entry of its
      ASBR must be found in the originating NSSA.\n          If no entries exist for
      the ASBR (i.e. the ASBR is unreachable\n          over the transit topology
      for a Type-5 LSA, or, for a Type-7\n          LSA, it is unreachable over the
      LSA's originating NSSA), do\n          nothing with this LSA and consider the
      next in the list.\n          [NSSA]\n          Else if the destination is a
      Type-7 default route (destination\n          ID = DefaultDestination) and one
      of the following is true,\n          then do nothing with this LSA and consider
      the next in the\n          list:\n            o  The calculating router is a
      border router and the LSA has\n               its P-bit clear.  Appendix E describes
      a technique\n               whereby an NSSA border router installs a Type-7
      default\n               LSA without propagating it.\n            o  The calculating
      router is a border router and is\n               suppressing the import of summary
      routes as Type-3\n               summary-LSAs.\n            [NSSA]\n          Else,
      this LSA describes an AS external path to destination N.\n          Examine
      the forwarding address specified in the AS-external-\n          LSA.  This indicates
      the IP address to which packets for the\n          destination should be forwarded.\n
      \         [OSPF]\n          If the forwarding address is set to 0.0.0.0 then
      packets\n          should be sent to the ASBR itself.  If the LSA is Type-5,
      from\n          among the multiple non-NSSA routing table entries for the ASBR\n
      \         (both NSSA and non-NSSA ASBR entries might exists on an NSSA\n          border
      router), select the preferred entry as follows:\n          ~[OSPF]\n            If
      RFC1583Compatibility is set to \"disabled\", prune the set\n            of routing
      table entries for the ASBR as described in OSPF\n            Section 16.4.1.
      \ In any case, among the remaining routing\n            table entries, select
      the routing table entry with the least\n            cost; when there are multiple
      least cost routing table\n            entries the entry whose associated area
      has the largest OSPF\n            Area ID (when considered as an unsigned 32-bit
      integer) is\n            chosen.\n            [OSPF]\n          Since a Type-7
      LSA only has area-wide flooding scope, when its\n          forwarding address
      is set to 0.0.0.0, its ASBR's routing table\n          entry must be chosen
      from the originating NSSA.  Here no\n          pruning is necessary since this
      entry always contains non-\n          backbone intra-area paths.\n          [NSSA]\n
      \         If the forwarding address is non-zero look up the forwarding\n          address
      in the routing table.  For a Type-5 LSA the matching\n          routing table
      entry must specify an intra-area or inter-area\n          path through a Type-5
      capable area.  For a Type-7 LSA the\n          matching routing table entry
      must specify an intra-area path\n          through the LSA's originating NSSA.
      \ If no such path exists\n          then do nothing with this LSA and consider
      the next in the\n          list.\n          [NSSA]\n      (4) Let X be the cost
      specified by the preferred routing table\n          entry for the ASBR/forwarding
      address, and Y the cost\n          specified in the LSA.  X is in terms of the
      link state metric,\n          and Y is a type 1 or 2 external metric.\n          [OSPF]\n
      \     (5) Now, look up the routing table entry for the destination N.\n          If
      no entry exists for N, install the AS external path to N,\n          with the
      next hop equal to the list of next hops to the\n          ASBR/forwarding address,
      and advertising router equal to the\n          ASBR.  If the external metric
      type is 1, then the path-type is\n          set to Type-1 external and the cost
      is equal to X + Y.  If the\n          external metric type is 2, the path-type
      is set to Type-2\n          external, the link-state component of the route's
      cost is X,\n          and the type 2 cost is Y.\n          [OSPF]\n      (6)
      Otherwise compare the AS external path described by the LSA\n          with
      the existing paths in N's routing table entry.  If the\n          new path is
      preferred, it replaces the present paths in N's\n          routing table entry.
      \ If the new path is of equal preference,\n          it is added to the present
      paths in N's routing table entry.\n          [OSPF]\n          Preference is
      defined as follows:\n          (a) Intra-area and inter-area paths are always
      preferred over\n              AS external paths.\n              [OSPF]\n          (b)
      Type 1 external paths are always preferred over type 2\n              external
      paths.  When all paths are type 2 external paths,\n              the paths with
      the smallest advertised type 2 metric are\n              always preferred.\n
      \             [OSPF]\n          (c) If the new AS external path is still indistinguishable\n
      \             from the current paths in N's routing table entry, and\n              RFC1583Compatibility
      is set to \"disabled\", select the\n              preferred paths based on the
      intra-AS paths to the\n              ASBR/forwarding addresses, as specified
      in Section 16.4.1.\n              Here intra-NSSA paths are equivalent to the
      intra-area\n              paths of non-backbone regular OSPF areas.\n              [NSSA]\n
      \         (d) If the new AS external path is still indistinguishable\n              from
      the current paths in N's routing table entry, select\n              the preferred
      path based on a least cost comparison.  Type\n              1 external paths
      are compared by looking at the sum of the\n              distance to the ASBR/forwarding
      addresses and the\n              advertised type 1 metric (X+Y).  Type 2 external
      paths\n              advertising equal type 2 metrics are compared by looking\n
      \             at the distance to the ASBR/forwarding addresses.\n              ~[OSPF]\n
      \         (e) If the current LSA is functionally the same as an\n              installed
      LSA (i.e., same destination, cost and non-zero\n              forwarding address)
      then apply the following priorities in\n              deciding which LSA is
      preferred:\n                 1. A Type-7 LSA with the P-bit set.\n                 2.
      A Type-5 LSA.\n                 3. The LSA with the higher router ID.\n              [NSSA]\n"
    title: 2.5 Calculating Type-7 AS External Routes
  - contents:
    - "2.6 Incremental Updates\n   Incremental updates for Type-7 LSAs should be treated
      the same as\n   incremental updates for Type-5 LSAs (see [OSPF] Section 16.6).
      \ When\n   a new instance of a Type-7 LSA is received it is not necessary to\n
      \  recalculate the entire routing table.  Call the destination described\n   by
      the Type-7 LSA N.  N's address is obtained by masking the LSA's\n   Link State
      ID with the network/subnet mask contained in the body of\n   the LSA.  If there
      is already an intra-area or inter-area route to\n   the destination, no recalculation
      is necessary (internal routes take\n   precedence).\n   Otherwise, the procedure
      in the preceding section will have to be\n   performed but only for the external
      routes (Type-5 and Type-7) whose\n   destination is N.  Before this procedure
      is performed, the present\n   routing table entry for N should be invalidated.\n"
    title: 2.6 Incremental Updates
  - contents:
    - "2.7 Optionally Importing Summary Routes\n   In order for OSPF's summary routing
      to not be obscured by an NSSA's\n   Type-7 AS-external-LSAs, all NSSA border
      router implementations must\n   support the optional import of summary routes
      into NSSAs as Type-3\n   summary-LSAs.  The default behavior is to import summary
      routes.  A\n   new area configuration parameter, ImportSummaries, is defined
      in\n   Appendix D.  When ImportSummaries is set to enabled, summary routes\n
      \  are imported.  When it is set to disabled, summary routes are not\n   imported.
      \ The default setting is enabled.\n   When OSPF's summary routes are not imported,
      the default LSA\n   originated by an NSSA border router into the NSSA should
      be a Type-3\n   summary-LSA. This protects the NSSA from routing intra-AS traffic
      out\n   the AS via the default route of a Type-7 default LSA originating from\n
      \  one of the NSSA's internal routers.  When summary routes are imported\n   into
      the NSSA, the default LSA originated by an NSSA border router\n   must not be
      a Type-3 summary-LSA; otherwise its default route would\n   be chosen over the
      potentially more preferred default routes of\n   Type-7 default LSAs.\n"
    title: 2.7 Optionally Importing Summary Routes
  - contents:
    - '3.0 Intra-AS Implementation Details

      '
    title: 3.0 Intra-AS Implementation Details
  - contents:
    - "3.1 Type-7 Translator Election\n   It is not recommended that multiple NSSA
      border routers perform\n   Type-7 to Type-5 translation unless it is required
      to route packets\n   efficiently through Area 0 to an NSSA partitioned by Type-7
      address\n   ranges.  It is normally sufficient to have only one NSSA border\n
      \  router perform the translation.  Excessive numbers of Type-7\n   translators
      unnecessarily increase the size of the OSPF link state\n   data base.\n   A
      new area configuration parameter, NSSATranslatorRole, is defined in\n   Appendix
      D.  It specifies whether or not an NSSA router will\n   unconditionally translate
      Type-7 LSAs to Type-5 LSAs when acting as\n   an NSSA border router. Configuring
      the identity of the translator can\n   be used to bias the routing to aggregated
      destinations. When\n   NSSATranslatorRole is set to Always, Type-7 LSAs are
      always\n   translated regardless of the translator state of other NSSA border\n
      \  routers.  When NSSATranslatorRole is set to Candidate an NSSA border\n   router
      will participate in the translator election process described\n   below.\n   A
      new area parameter, NSSATranslatorState, is maintained in an NSSA's\n   OSPF
      area data structure.  By default all NSSA routers initialize\n   NSSATranslatorState
      to disabled.  When an NSSA border router's\n   NSSATranslatorState changes from
      disabled to either enabled or\n   elected, it begins translating the NSSA's
      Type-7 LSAs into Type-5\n   LSAs.  When its NSSATranslatorState changes from
      either enabled or\n   elected to disabled, it ceases translating the NSSA's
      Type-7 LSAs\n   into Type-5 LSAs. (See paragraphs below.)\n   A new bit, Nt,
      is defined for the router-LSAs of NSSAs.  (See\n   Appendix B.)  By default
      routers clear bit Nt when originating\n   router-LSAs.  However, when an NSSA
      border router has its\n   NSSATranslatorState enabled, it sets bit Nt in the
      router-LSA it\n   originates into the NSSA.  An NSSA router whose NSSATranslatorRole
      is\n   set to Always should re-originate a router-LSA into the NSSA whenever\n
      \  its NSSATranslatorState changes.\n   When an NSSA router with the NSSA's
      NSSATranslatorRole set to Always\n   attains border router status, it should
      change NSSATranslatorState\n   from disabled to enabled.  When it loses border
      router status, it\n   should change NSSATranslatorState from enabled to disabled.\n
      \  All NSSA border routers must set the E-bit in the Type-1 router-LSAs\n   of
      their directly attached non-stub areas, even when they are not\n   translating.
      \ This allows other NSSA border routers to see their ASBR\n   status across
      the AS's transit topology.  Failure to do so may cause\n   the election algorithm
      to elect unnecessary translators.  Every NSSA\n   border router is a potential
      translator.\n   An NSSA border router whose NSSA's NSSATranslatorRole is set
      to\n   Candidate must maintain a list of the NSSA's border routers that are\n
      \  reachable both over the NSSA and as ASBRs over the AS's transit\n   topology.
      \ Any change in this list, or to the Nt bit settings of\n   members of this
      list, causes the NSSA border router to reevaluate its\n   NSSATranslatorState.
      \ If there exists another border router in this\n   list whose router-LSA has
      bit Nt set or who has a higher router ID,\n   then its NSSATranslatorState is
      disabled.  Otherwise its\n   NSSATranslatorState is elected.\n   An elected
      translator will continue to perform translation duties\n   until supplanted
      by a reachable NSSA border router whose Nt bit is\n   set or whose router ID
      is greater.  Such an event may happen when an\n   NSSA router with NSSATranslatorRole
      set to Always regains border\n   router status, or when a partitioned NSSA becomes
      whole.  If an\n   elected translator determines its services are no longer required,
      it\n   continues to perform its translation duties for the additional time\n
      \  interval defined by a new area configuration parameter,\n   TranslatorStabilityInterval.
      \ This minimizes excessive flushing of\n   translated Type-7 LSAs and provides
      for a more stable translator\n   transition.  The default value for the TranslatorStabilityInterval\n
      \  parameter has been defined as 40 seconds. (See Appendix D.)\n"
    title: 3.1 Type-7 Translator Election
  - contents:
    - "3.2 Translating Type-7 LSAs into Type-5 LSAs\n   This step is performed as
      part of the NSSA's Dijkstra calculation\n   after Type-5 and Type-7 routes have
      been calculated.  If the\n   calculating router is currently not an NSSA border
      router translator,\n   then this translation algorithm should be skipped.  Only
      installed\n   Type-7 LSAs and those non-default Type-7 LSAs originated by the\n
      \  router itself should be examined.  Locally sourced Type-7 LSAs should\n   be
      processed first.\n   Note that it is possible for a Type-5 LSA generated by
      translation to\n   supplant a Type-5 LSA originating from a local OSPF external
      source.\n   Future reoriginations of the locally sourced Type-5 LSA should be\n
      \  suppressed until the Type-5 LSA generated by translation is flushed.\n   A
      Type-7 LSA and a Type-7 address range best match one another if\n   there does
      not exist a more specific Type-7 address range that\n   contains the LSA's network.
      \ For each eligible Type-7 LSA perform the\n   following:\n      (1) If the
      Type-7 LSA has the P-bit clear, or its forwarding\n          address is set
      to 0.0.0.0, or the most specific Type-7 address\n          range that subsumes
      the LSA's network has DoNotAdvertise\n          status, then do nothing with
      this Type-7 LSA and consider the\n          next one in the list.  Otherwise
      term the LSA as translatable\n          and proceed with step (2).\n      (2)
      If the Type-7 LSA is not contained in any explicitly\n          configured Type-7
      address range and the calculating router has\n          the highest router ID
      amongst NSSA translators that have\n          originated a functionally equivalent
      Type-5 LSA (i.e. same\n          destination, cost and non-zero forwarding address)
      and that\n          are reachable over area 0 and the NSSA, then a Type-5 LSA\n
      \         should be generated if there is currently no Type-5 LSA\n          originating
      from this router corresponding to the Type-7 LSA's\n          network, or there
      is an existing Type-5 LSA and either it\n          corresponds to a local OSPF
      external source whose path type\n          and metric is less preferred (see
      Section 2.5 step (6), parts\n          (b) and (d)), or it doesn't and the Type-5
      LSA's path type or\n          cost(s) have changed (See Section 2.5 step (5))
      or the\n          forwarding address no longer maps to a translatable Type-7\n
      \         LSA.\n          The newly originated Type-5 LSA will describe the
      same network\n          and have the same network mask, path type, metric, forwarding\n
      \         address and external route tag as the Type-7 LSA.  The\n          advertising
      router field will be the router ID of this NSSA\n          border router.  The
      link-state ID is equal to the LSA's\n          network address (in the case
      of multiple originations of\n          Type-5 LSAs with the same network address
      but different mask,\n          the link-state ID can also have one or more of
      the network's\n          \"host\" bits set).\n      (3) Else the Type-7 LSA
      must be aggregated by the most specific\n          Type-7 address range that
      subsumes it.  If this Type-7 address\n          range has the same [address,mask]
      pair as the LSA's network\n          and no other translatable Type-7 LSA with
      a different network\n          best matches this range, then flag the LSA as
      not contained in\n          any explicitly configured Type-7 address range and
      process the\n          LSA as described in step (2).  Otherwise compute the
      path type\n          and metric for this Type-7 address range as described below.\n
      \         The path type and metric of the Type-7 address range is\n          determined
      from the path types and metrics of those\n          translatable Type-7 LSAs
      that best match the range plus any\n          locally sourced Type-5 LSAs whose
      network has the same\n          [address,mask] pair.  If any of these LSAs have
      a path type of\n          2, the range's path type is 2, otherwise it is 1.
      \ If the\n          range's path type is 1 its metric is the highest cost amongst\n
      \         these LSAs; if the range's path type is 2 its metric is the\n          highest
      Type-2 cost + 1 amongst these LSAs.  (See Section 2.5\n          step (5).)
      \ 1 is added to the Type-2 cost to ensure that the\n          translated Type-5
      LSA does not appear closer on the NSSA\n          border than a translatable
      Type-7 LSA whose network has the\n          same [address,mask] pair and Type-2
      cost.\n          A Type-5 LSA is generated from the Type-7 address range when\n
      \         there is currently no Type-5 LSA originated by this router\n          whose
      network has the same [address,mask] pair as the range or\n          there is
      but either its path type or metric has changed or its\n          forwarding
      address is non-zero.\n          The newly generated Type-5 LSA will have a link-state
      ID equal\n          to the Type-7 address range's address (in the case of multiple\n
      \         originations of Type-5 LSAs with the same network address but\n          different
      mask, the link-state ID can also have one or more of\n          the range's
      \"host\" bits set).  The advertising router field\n          will be the router
      ID of this area border router.  The network\n          mask and the external
      route tag are set to the range's\n          configured values.  The forwarding
      address is set to 0.0.0.0.\n          The path type and metric are set to the
      range's path type and\n          metric as defined and computed above.\n          The
      pending processing of other translation eligible Type-7\n          LSAs that
      best match this Type-7 address range is suppressed.\n          Thus at most
      a single Type-5 LSA is originated for each Type-7\n          address range.\n
      \  For example, given a Type-7 address range of [10.0.0.0, 255.0.0.0]\n   that
      subsumes the following Type-7 routes:\n                 10.1.0.0/24 path type
      1, cost 10\n                 10.2.0.0/24 path type 1, cost 11\n                 10.3.0.0/24
      path type 2, type 2 cost 5\n   a Type-5 LSA would be generated with a path type
      of 2 and a metric 6.\n   Given a Type-7 address range of [10.0.0.0, 255.0.0.0]
      that subsumes\n   the following Type-7 routes:\n                 10.1.0.0/24
      path type 1, cost 10\n                 10.2.0.0/24 path type 1, cost 11\n                 10.3.0.0/24
      path type 1, cost 5\n   a Type-5 LSA will be generated with a path type of 1
      and a metric 11.\n   These Type-7 address range metric and path type rules will
      avoid\n   routing loops in the event that path types 1 and 2 are both used\n
      \  within the area.\n   As with all newly originated Type-5 LSAs, a Type-5 LSA
      that is the\n   result of a Type-7 LSA translation or aggregation is flooded
      to all\n   attached Type-5 capable areas.\n   Like Type-3 address ranges, a
      Type-7 address range performs the dual\n   function of setting propagation policy
      via its\n   Advertise/DoNotAdvertise parameter and aggregation via its network\n
      \  address and mask pair. Unlike the origination of Type-3 summary-LSAs,\n   the
      translation of a Type-7 LSA into a Type-5 LSA may result in more\n   efficient
      routing when the forwarding address is set, as is done\n   during step (2) of
      the translation procedure.\n   Another important feature of this translation
      process is that it\n   allows a Type-7 address range to apply different properties\n
      \  (aggregation, forwarding address, and Advertise/DoNotAdvertise\n   status)
      for the Type-7 routes it subsumes, versus those Type-7 routes\n   subsumed by
      other more specific Type-7 address ranges contained in\n   the Type-7 address
      range.\n"
    title: 3.2 Translating Type-7 LSAs into Type-5 LSAs
  - contents:
    - "3.3 Flushing Translated Type-7 LSAs\n   If an NSSA border router has either
      translated or aggregated an\n   installed Type-7 LSA into a Type-5 LSA that
      should no longer be\n   translated or aggregated, then the Type-5 LSA should
      either be\n   flushed or reoriginated as a translation or aggregation of other\n
      \  Type-7 LSAs.\n   If an NSSA border router is translating Type-7 LSA's into
      Type-5\n   LSA's with NSSATranslatorState set to elected and the NSSA border\n
      \  router has determined that its translator election status has been\n   deposed
      by another NSSA border router (see Section 3.1), then, as\n   soon as the TranslatorStabilityInterval
      has expired without the\n   router reelecting itself as a translator, Type-5
      LSAs that are\n   generated by aggregating Type-7 LSAs into their best matched
      Type-7\n   address ranges (see Section 3.2, Step (3)) are flushed.  Conversely\n
      \  Type-5 LSAs generated by translating Type-7 LSAs are not immediately\n   flushed,
      but are allowed to remain in the OSPF routing domain as if\n   the originator
      is still an elected translator.  This minimizes the\n   flushing and flooding
      impact on the transit topology of an NSSA that\n   changes its translators frequently.\n"
    title: 3.3 Flushing Translated Type-7 LSAs
  - contents:
    - "4.0 Security Considerations\n   There are two types of issues that need be
      addressed when looking at\n   protecting routing protocols from misconfigurations
      and malicious\n   attacks.  The first is authentication and certification of
      routing\n   protocol information.  The second is denial of service attacks\n
      \  resulting from repetitive origination of the same router\n   advertisement
      or origination of a large number of distinct\n   advertisements resulting in
      database overflow.  Note that both of\n   these concerns exist independently
      of a router's support for the NSSA\n   option.\n   The OSPF protocol addresses
      authentication concerns by authenticating\n   OSPF protocol exchanges.  OSPF
      supports multiple types of\n   authentication; the type of authentication in
      use can be configured\n   on a per network segment basis.  One of OSPF's authentication
      types,\n   namely the Cryptographic authentication option, is believed to be\n
      \  secure against passive attacks and provides significant protection\n   against
      active attacks.  When using the Cryptographic authentication\n   option, each
      router appends a \"message digest\" to its transmitted\n   OSPF packets.  Receivers
      then use the shared secret key and the\n   received digest to verify that each
      received OSPF packet is\n   authentic.\n   The quality of the security provided
      by the Cryptographic\n   authentication option depends completely on the strength
      of the\n   message digest algorithm (MD5 is currently the only message digest\n
      \  algorithm specified), the strength of the key being used, and the\n   correct
      implementation of the security mechanism in all communicating\n   OSPF implementations.
      \ It also requires that all parties maintain the\n   secrecy of the shared secret
      key.  None of the standard OSPF\n   authentication types provide confidentiality,
      nor do they protect\n   against traffic analysis.  For more information on the
      standard OSPF\n   security mechanisms, see Sections 8.1, 8.2, and Appendix D
      of [OSPF].\n   [DIGI] describes the extensions to OSPF required to add digital\n
      \  signature authentication to Link State data and to provide a\n   certification
      mechanism for router data.  [DIGI] also describes the\n   added LSA processing
      and key management as well as a method for\n   migration from or co-existence
      with standard OSPF V2.\n   OSPF addresses repetitive origination of advertisements
      by mandating\n   a limit on how frequent new instances of any particular LSA
      can be\n   originated and accepted during the flooding procedure.  The frequency\n
      \  at which new LSA instances may be originated is set to once every\n   MinLSInterval
      seconds, whose value is 5 seconds.  (See [OSPF] Section\n   12.4.)  The frequency
      at which new LSA instances are accepted during\n   flooding is once every MinLSArrival
      seconds, whose value is set to 1\n   second.  (See [OSPF] Section 13, Appendix
      B, and G.1.)\n   Proper operation of the OSPF protocol requires that all OSPF
      routers\n   maintain an identical copy of the OSPF link state database.  However,\n
      \  when the size of the link state database becomes very large, some\n   routers
      may be unable to keep the entire database due to resource\n   shortages; this
      is termed \"database overflow\".  When database\n   overflow is anticipated,
      the routers with limited resources can be\n   accommodated by configuring OSPF
      stub areas and NSSAs.  [OVERFLOW]\n   details a way of gracefully handling unanticipated
      database\n   overflows.\n"
    title: 4.0 Security Considerations
  - contents:
    - "5.0 Acknowledgements\n   This document was produced by the OSPF Working Group,
      chaired by John\n   Moy.\n   In addition, the comments of the following individuals
      are also\n   acknowledged:\n      Antoni Przygienda  Redback Networks, Inc\n
      \     Alex Zinin         cisco\n   It is also noted that comments from\n      Phani
      Jajjarvarpu  cisco\n      Dino Farinacci     cisco\n      Jeff Honig         Cornell
      University\n      Doug Williams      IBM\n   were acknowledged in the predecessor
      of this document, RFC 1587.\n"
    title: 5.0 Acknowledgements
  - contents:
    - "6.0 Contributors\n   This document, RFC 3101, adds new sections, features,
      edits, and\n   revisions to its predecessor, RFC 1587, \"The OSPF NSSA Option\",\n
      \  authored by Rob Coltun, Movaz Networks, and Vince Fuller.  Content\n   from
      RFC 1587 is used throughout RFC 3101.  In addition to adding new\n   features,
      this document makes the NSSA specification consistent with\n   the OSPFv2 specification,
      RFC 2328, authored by John Moy, Sycamore\n   Networks, Inc.  Section 2.5, Calculating
      Type-7 AS External Routes,\n   and Section 2.6,  Incremental Updates, rely heavily
      on text in RFC\n   2328's Section 16.4 and Section 16.6 respectively.  Section
      4.0,\n   Security Considerations, is an edit of similar content in Rob\n   Coltun's
      RFC 2370, \"The OSPF Opaque LSA option\", Section 6.0.\n   Acee Lindem, Redback
      Networks, Inc, is also recognized for the first\n   full known implementation
      of this specification. Acee's\n   implementation resulted in substantive content
      change.\n"
    title: 6.0 Contributors
  - contents:
    - "7.0 References\n   [DIGI]     Murphy, S., Badger, M. and B. Wellington, \"OSPF
      with\n              Digital Signatures\", RFC 2154, June 1997.\n   [MUEX]     Moy,
      J., \"Multicast Extensions to OSPF\", RFC 1584, March\n              1994.\n
      \  [OSPF]     Moy, J., \"OSPF Version 2\", RFC 2328, April 1998.\n   [OPAQUE]
      \  Coltun, R., \"The OSPF Opaque LSA Option\", RFC 2370, July\n              1998.\n
      \  [OVERFLOW] Moy, J., \"OSPF Database Overflow\", RFC 1765, March 1995.\n"
    title: 7.0 References
  title: 1.0  Overview
- contents:
  - "Appendix A: The Options Field\n   The OSPF options field is present in OSPF Hello
    packets, Database\n   Description packets and all link state advertisements.  See
    [OSPF]\n   Appendix A.2 and [OPAQUE] Appendix A.1 for a description of the\n   options
    field.  Six bits are assigned but only two (the E-bit and the\n   N/P bit) are
    described completely in this section.\n                  --------------------------------------\n
    \                 | * | O | DC | EA | N/P | MC | E | * |\n                  --------------------------------------\n
    \                     The Type-7 LSA options field\n      E-bit:  Type-5 AS-external-LSAs
    are not flooded into/through OSPF\n              stub areas and NSSAs.  The E-bit
    ensures that all members\n              of a stub area or NSSA agree on that area
    configuration.\n              The E-bit is meaningful only in OSPF Hello and Database\n
    \             Description packets.  When the E-bit is clear in the Hello\n              packet
    sent out a particular interface, it means that the\n              router will
    neither send nor receive Type-5 AS-external-\n              LSAs on that interface
    (in other words, the interface\n              connects to a stub area or NSSA).
    \ Two routers will not\n              become neighbors unless they agree on the
    state of the E-\n              bit.\n      N-bit:  The N-bit describes the router's
    NSSA capability.  The N-\n              bit is used only in Hello packets and
    ensures that all\n              members of an NSSA agree on that area's configuration.\n
    \             When the N-bit is set in the Hello packet that is sent out\n              a
    particular interface, it means that the router will send\n              and receive
    Type-7 LSAs on that interface.  Two routers\n              will not form an adjacency
    unless they agree on the state\n              of the N-bit.  If the N-bit is set
    in the options field,\n              the E-bit must be clear.\n      P-bit:  The
    P-bit is used only in the Type-7 LSA header.  It flags\n              the NSSA
    border router to translate the Type-7 LSA into a\n              Type-5 LSA.  The
    default setting for the P-bit is clear.\n"
  title: 'Appendix A: The Options Field'
- contents:
  - "Appendix B: Router-LSAs\n   Router-LSAs are the Type-1 LSAs.  Each router in
    an area originates a\n   router-LSA.  The LSA describes the state and cost of
    the router's\n   links (i.e., interfaces) to the area.  All of the router's links
    to\n   the area must be described in a single router-LSA.  For details\n   concerning
    the construction of router-LSAs, see [OSPF] Section\n   12.4.1.\n       0                   1
    \                  2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
    5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |            LS age             |     Options   |       1       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                        Link State ID                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                     Advertising Router                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                     LS sequence number                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |         LS checksum           |             length            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |  0  Nt|W|V|E|B|        0      |            # links            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                          Link ID                              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                         Link Data                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |     Type      |     # TOS     |        TOS 0 metric           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |      TOS      |        0      |            metric             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                              ...                              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |      TOS      |        0      |            metric             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                          Link ID                              |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                         Link Data                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \     |                              ...                              |\n   In
    router-LSAs, the Link State ID field is set to the router's OSPF\n   Router ID.
    \ Router-LSAs are flooded throughout a single area only.\n      bit V\n          When
    set, the router is an endpoint of one or more fully\n          adjacent virtual
    links having the described area as their\n          transit area (V is for virtual
    link endpoint).\n      bit E\n          When set, the router is an AS boundary
    router (E is for\n          external).  ALL NSSA border routers set bit E in those\n
    \         router-LSAs originated into directly attached Type-5 capable\n          areas.
    \ An NSSA's AS boundary routers also set bit E in their\n          router-LSAs
    originated into the NSSA.  (See Section 3.1 for\n          details.)\n      bit
    B\n          When set, the router is an area border router (B is for\n          border).\n
    \     bit W\n          When set, the router is a wild-card multicast receiver
    (W is\n          for wild).\n      bit Nt\n          When set, the router is an
    NSSA border router that is\n          unconditionally translating Type-7 LSAs
    into Type-5 LSAs (Nt\n          stands for NSSA translation).  Note that such
    routers have\n          their NSSATranslatorRole area configuration parameter
    set to\n          Always.  (See Appendix D and Section 3.1.)\n   The remainder
    of the router-LSAs specification is defined in [OSPF]\n   Section A.4.2.\n"
  title: 'Appendix B: Router-LSAs'
- contents:
  - "Appendix C: Type-7 LSA Packet Format\n        0                                 32\n
    \       ------------------------------------\n        |                | Options
    |   7   |\n        |                -------------------\n        |        Link-State
    Header         |\n        |                                  |\n        ------------------------------------\n
    \       | Network Mask                     |\n        ------------------------------------
    \ ______\n        |E| TOS  |        metric           |  .\n        ------------------------------------
    \ .  repeated for each TOS\n        | Forwarding Address               |  .\n
    \       ------------------------------------  .\n        | External Route Tag
    \              |  ______\n        ------------------------------------\n   The
    definitions of the link-state ID, network mask, metrics and\n   external route
    tag are the same as the definitions for Type-5 LSAs\n   (See [OSPF] Appendix A.4.5),
    except for the forwarding address and\n   the N/P-bit.  The Options field must
    have the N/P bit set as\n   described in Appendix A when the originating router
    desires that the\n   external route be propagated throughout the OSPF domain.\n
    \  Forwarding address\n      Data traffic for the advertised destination will
    be forwarded to\n      this address.  If the forwarding address is set to 0.0.0.0,
    data\n      traffic will be forwarded to the LSA's originator (i.e., the\n      responsible
    NSSA AS boundary router).  Normally the next hop\n      address of an installed
    AS external route learned by an NSSA ASBR\n      from an adjacent AS points at
    one of the adjacent AS's gateway\n      routers.  If this address belongs to a
    network connected to the\n      NSSA ASBR via one of its NSSAs' active interfaces,
    then it is the\n      forwarding address for the route's Type-7 LSA originated
    into this\n      NSSA.  For an NSSA with no such network the forwarding address
    is\n      either an address from one of its active interfaces or 0.0.0.0.\n      If
    the P-bit is set, the forwarding address must be non-zero,\n      otherwise it
    may be 0.0.0.0. (See Section 2.3 for details.)\n"
  title: 'Appendix C: Type-7 LSA Packet Format'
- contents:
  - "Appendix D:  Configuration Parameters\n   [OSPF] Appendix C.2 lists the area
    configuration parameters.  The\n   area ID and the list of address ranges for
    Type-3 summary routes\n   remain unchanged.  Section 2.2 of this document lists
    the\n   configuration parameters for Type-7 address ranges.  The following\n   area
    configuration parameters have been added:\n      NSSATranslatorRole\n         Specifies
    whether or not an NSSA border router will\n         unconditionally translate
    Type-7 LSAs into Type-5 LSAs.  When\n         it is set to Always, an NSSA border
    router always translates\n         Type-7 LSAs into Type-5 LSAs regardless of
    the translator state\n         of other NSSA border routers.  When it is set to
    Candidate, an\n         NSSA border router participates in the translator election\n
    \        process described in Section 3.1.  The default setting is\n         Candidate.\n
    \     TranslatorStabilityInterval\n         Defines the length of time an elected
    Type-7 translator will\n         continue to perform its translator duties once
    it has\n         determined that its translator status has been deposed by\n         another
    NSSA border router translator as described in Section\n         3.1 and 3.3.  The
    default setting is 40 seconds.\n      ImportSummaries\n         When set to enabled,
    OSPF's summary routes are imported into\n         the NSSA as Type-3 summary-LSAs.
    \ When set to disabled, summary\n         routes are not imported into the NSSA.
    \ The default setting is\n         enabled.\n   Implementations must provide a
    vehicle for setting the P-bit when\n   external routes are imported into the NSSA
    as Type-7 LSAs.  Without\n   configuration, the default setting of the P-bit is
    clear.  (See\n   Section 2.3 and Appendix B.)\n   For NSSAs the ExternalRoutingCapability
    area configuration parameter\n   must be set to accept Type-7 external routes.
    \ Additionally there\n   must be a way of configuring the metric of the default
    LSA that a\n   border router advertises into its directly attached NSSAs. If a\n
    \  Type-7 default LSA is advertised, its metric type (1 or 2) should\n   also
    be configurable.\n"
  title: 'Appendix D:  Configuration Parameters'
- contents:
  - "Appendix E: The P-bit Policy Paradox.\n   Non-default Type-7 LSAs with the P-bit
    clear may be installed in the\n   OSPF routing table of NSSA border routers.  (See
    Section 2.5.)  These\n   LSAs are not propagated throughout the OSPF domain as
    translated\n   Type-5 LSAs.  (See Section 3.2.)  Thus, traffic that is external
    to\n   an NSSA and that passes through one of the NSSA's border routers may\n
    \  be hijacked into the NSSA by a route installed from a Type-7 LSA with\n   the
    P-bit clear.  This may be contrary to the expected path at the\n   source of the
    traffic.  It may also violate the routing policy\n   intended by the Type-7 LSA's
    clear P-bit.  A Type-7 address range\n   that is configured with DoNotAdvertise
    exhibits the same paradox for\n   any installed Type-7 LSAs it subsumes, regardless
    of the P-bit\n   setting.\n   This paradox is best illustrated by the following
    example.  Consider\n   an OSPF domain (AS 1842) with connections for default Internet\n
    \  routing and to external AS 4156.  NSSA 1 and OSPF Area 2 are\n   partially
    defined in the following diagram:\n                              AS 4156\n                                |\n
    \           Area 2              |\n                                |\n              A2
    \               A0   Area 0      C0-----Internet\n              |                 |
    \               |      Default\n              |                 |                |\n
    \             |                 |                |\n              +-----------------B0---------------+\n
    \                               /\\\n                               /  \\\n                              /
    \   \\\n         Internet------------A1    B1------AS 4156 (P-bit clear)\n         Default
    (P-bit set)\n                                 NSSA 1\n   Here A0, B0, and C0 are
    Area 0 routers, A1 and B1 are NSSA 1 routers,\n   and A2 is an Area 2 router.
    \ B0 is a border router for both NSSA 1\n   and Area 2.\n   If the Type-7 external
    routes imported by B1 for AS 4156 are\n   installed on B0 so that the NSSA 1 tree
    below A1 can take advantage\n   of them, then A2's traffic to AS 4156 is hijacked
    through B0 by B1,\n   rather than its computed path through A0.\n   An NSSA border
    router's installed Type-7 default LSAs will exhibit\n   this paradox when it possesses
    a Type-7 address range [0,0]\n   configured with DoNotAdvertise, as these LSAs
    are not propagated even\n   though their P-bit is set.  In the example above,
    if A1's default is\n   installed on B0, which has a configured Type-7 address
    range [0,0]\n   with DoNotAdvertise set, then A2's Internet traffic is hijacked\n
    \  through B0 by A1 rather than the computed path through C0.\n"
  title: 'Appendix E: The P-bit Policy Paradox.'
- contents:
  - "Appendix F: Differences from RFC 1587\n   This section documents the differences
    between this memo and RFC\n   1587.  All differences are backward-compatible.
    \ Implementations of\n   this memo and of RFC 1587 will interoperate.\n"
  - contents:
    - "F.1 Enhancements to the import of OSPF's summary routes.\n   The import of
      OSPF's summary routes into an NSSA as Type-3 summary-\n   LSAs is now optional.
      \ In RFC 1587 the import of summary routes was\n   mandated in order to guarantee
      that inter-area summary routing was\n   not obscured by an NSSA's Type-7 AS-external-LSAs.
      The current\n   recommended default behavior is to import summary routes.  When\n
      \  summary routes are not imported into an NSSA, the default LSA\n   originated
      by its border routers must be a Type-3 summary-LSA.\n   See Sections 1.3 and
      2.7 for details.\n"
    title: F.1 Enhancements to the import of OSPF's summary routes.
  - contents:
    - "F.2 Changes to Type-7 LSAs.\n   The setting of the forwarding address in Type-7
      LSAs has been further\n   refined.\n   See Section 2.3 for details.\n"
    title: F.2 Changes to Type-7 LSAs.
  - contents:
    - "F.3 Changes to the Type-7 AS external routing calculation.\n   The Type-7 external
      route calculation has been revised.  Most\n   notably:\n      o  The path preference
      defined in [OSPF] Section 16.4.1 has been\n         included.\n      o  A Type-7
      default route with the P-bit clear will not be\n         installed on an NSSA
      border router.  This protects the default\n         routing of other OSPF Areas.
      \ (See Appendix E.)\n      o  The LSA type of two AS-external-LSAs plays no
      role in\n         determining path preference except when the LSAs are\n         functionally
      the same (i.e., same destination, cost and non-\n         zero forwarding address).\n
      \  See Section 2.5 for details.\n"
    title: F.3 Changes to the Type-7 AS external routing calculation.
  - contents:
    - "F.4 Changes to translating Type-7 LSAs into Type-5 LSAs\n   The translator
      election algorithm of RFC 1587 has been updated to\n   close a bug that results
      when the translator with the highest router\n   ID loses connectivity to the
      AS's transit topology.  The default\n   translator election process occurs only
      in the absence of an existing\n   translator.\n   The identity of the translator
      is optionally configurable, with more\n   than one allowed.  This allows the
      network designer to choose the\n   most cost effective intra-AS route for NSSA
      originated Type-5 LSA\n   aggregations of Type-7 LSAs.\n   Self-originated non-default
      Type-7 LSAs are now included in the\n   translation process.\n   The translation
      process has been strengthened to close some of the\n   weak points of RFC 1587.\n
      \  See Sections 3.1 and 3.2 for details.\n"
    title: F.4 Changes to translating Type-7 LSAs into Type-5 LSAs
  - contents:
    - "F.5 Changes to flushing translated Type-7 LSAs\n   An NSSA border router, which
      was elected by the augmented RFC 1587\n   translator selection process defined
      in Section 3.1 and which has\n   been deposed from its translation duties by
      another NSSA border\n   router, flushes its self-originated Type-5 LSAs that
      resulted from\n   the aggregation of Type-7 LSAs.  This prevents these obsolete\n
      \  aggregations from short circuiting the preferred path through the new\n   translator(s).
      \ A deposed translator continues to maintain its self-\n   originated Type-5
      LSAs resulting from translation until they age out\n   normally.\n   See Section
      3.3 for details.\n"
    title: F.5 Changes to flushing translated Type-7 LSAs
  - contents:
    - "F.6 P-bit additions\n   The P-bit default has been defined as clear.  RFC 1587
      had no default\n   setting. (See Appendix C.)\n   A discussion on the packet
      forwarding impact of installing Type-7\n   LSAs with the P-bit clear on NSSA
      border routers has been added as\n   Appendix E.\n"
    title: F.6 P-bit additions
  title: 'Appendix F: Differences from RFC 1587'
- contents:
  - "Author's Addresses\n   Pat Murphy\n   US Geological Survey\n   345 Middlefield
    Road\n   Menlo Park, California 94560\n   Phone: (650) 329-4044\n   EMail: pmurphy@noc.usgs.net\n"
  title: Author's Addresses
- contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2003).  All
    Rights Reserved.\n   This document and translations of it may be copied and furnished
    to\n   others, and derivative works that comment on or otherwise explain it\n
    \  or assist in its implementation may be prepared, copied, published\n   and
    distributed, in whole or in part, without restriction of any\n   kind, provided
    that the above copyright notice and this paragraph are\n   included on all such
    copies and derivative works.  However, this\n   document itself may not be modified
    in any way, such as by removing\n   the copyright notice or references to the
    Internet Society or other\n   Internet organizations, except as needed for the
    purpose of\n   developing Internet standards in which case the procedures for\n
    \  copyrights defined in the Internet Standards process must be\n   followed,
    or as required to translate it into languages other than\n   English.\n   The
    limited permissions granted above are perpetual and will not be\n   revoked by
    the Internet Society or its successors or assigns.\n   This document and the information
    contained herein is provided on an\n   \"AS IS\" basis and THE INTERNET SOCIETY
    AND THE INTERNET ENGINEERING\n   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS
    OR IMPLIED, INCLUDING\n   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
    INFORMATION\n   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES
    OF\n   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.\n"
  title: Full Copyright Statement
- contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided
    by the\n   Internet Society.\n"
  title: Acknowledgement
