- title: __initial_text__
  contents:
  - "          Session Initiation Protocol for Telephones (SIP-T):\n             \
    \          Context and Architectures\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet Best Current Practices\
    \ for the\n   Internet Community, and requests discussion and suggestions for\n\
    \   improvements.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2002).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   The popularity of gateways that interwork between the PSTN (Public\n\
    \   Switched Telephone Network) and SIP networks has motivated the\n   publication\
    \ of a set of common practices that can assure consistent\n   behavior across\
    \ implementations.  This document taxonomizes the uses\n   of PSTN-SIP gateways,\
    \ provides uses cases, and identifies mechanisms\n   necessary for interworking.\
    \  The mechanisms detail how SIP provides\n   for both 'encapsulation' (bridging\
    \ the PSTN signaling across a SIP\n   network) and 'translation' (gatewaying).\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  2\n   2.  SIP-T for ISUP-SIP Interconnections  . . . . . . . .\
    \ . . . . .  4\n   3.  SIP-T Flows  . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .  7\n   3.1 SIP Bridging (PSTN - IP - PSTN)  . . . . . . . . . . . .\
    \ . . .  8\n   3.2 PSTN origination - IP termination  . . . . . . . . . . . .\
    \ . .  9\n   3.3 IP origination - PSTN termination  . . . . . . . . . . . . .\
    \ . 11\n   4.  SIP-T Roles and Behavior . . . . . . . . . . . . . . . . . . .\
    \ 12\n   4.1 Originator . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n\
    \   4.2 Terminator . . . . . . . . . . . . . . . . . . . . . . . . . . 13\n  \
    \ 4.3 Intermediary . . . . . . . . . . . . . . . . . . . . . . . . . 14\n   4.4\
    \ Behavioral Requirements Summary  . . . . . . . . . . . . . . . 15\n   5.  Components\
    \ of the SIP-T Protocol . . . . . . . . . . . . . . . 16\n   5.1 Core SIP . .\
    \ . . . . . . . . . . . . . . . . . . . . . . . . . 16\n   5.2 Encapsulation \
    \ . . . . . . . . . . . . . . . . . . . . . . . . 16\n   5.3 Translation  . .\
    \ . . . . . . . . . . . . . . . . . . . . . . . 16\n   5.4 Support for mid-call\
    \ signaling . . . . . . . . . . . . . . . . 17\n   6.  SIP Content Negotiation\
    \  . . . . . . . . . . . . . . . . . . . 17\n   7.  Security Considerations  .\
    \ . . . . . . . . . . . . . . . . . . 19\n   8.  IANA Considerations  . . . .\
    \ . . . . . . . . . . . . . . . . . 20\n   9.  References . . . . . . . . . .\
    \ . . . . . . . . . . . . . . . . 20\n   10  References . . . . . . . . . . .\
    \ . . . . . . . . . . . . . . . 20\n   A.  Notes  . . . . . . . . . . . . . .\
    \ . . . . . . . . . . . . . . 21\n   B.  Acknowledgments  . . . . . . . . . .\
    \ . . . . . . . . . . . . . 21\n   Authors' Addresses . . . . . . . . . . . .\
    \ . . . . . . . . . . . . 22\n   Full Copyright Statement . . . . . . . . . .\
    \ . . . . . . . . . . . 23\n"
- title: 1. Introduction
  contents:
  - "1. Introduction\n   The Session Initiation Protocol (SIP [1]) is an application-layer\n\
    \   control protocol that can establish, modify and terminate multimedia\n   sessions\
    \ or calls.  These multimedia sessions include multimedia\n   conferences, Internet\
    \ telephony and similar applications.  SIP is one\n   of the key protocols used\
    \ to implement Voice over IP (VoIP).\n   Although performing telephony call signaling\
    \ and transporting the\n   associated audio media over IP yields significant advantages\
    \ over\n   traditional telephony, a VoIP network cannot exist in isolation from\n\
    \   traditional telephone networks.  It is vital for a SIP telephony\n   network\
    \ to interwork with the PSTN.\n   The popularity of gateways that interwork between\
    \ the PSTN and SIP\n   networks has motivated the publication of a set of common\
    \ practices\n   that can assure consistent behavior across implementations.  The\n\
    \   scarcity of SIP expertise outside the IETF suggests that the IETF is\n   the\
    \ best place to stage this work, especially since SIP is in a\n   relative state\
    \ of flux compared to the core protocols of the PSTN.\n   Moreover, the IETF working\
    \ groups that focus on SIP (SIP and SIPPING)\n   are best positioned to ascertain\
    \ whether or not any new extensions to\n   SIP are justified for PSTN interworking.\
    \  This framework addresses\n   the overall context in which PSTN-SIP interworking\
    \ gateways might be\n   deployed, provides use cases and identifies the mechanisms\
    \ necessary\n   for interworking.\n   An important characteristic of any SIP telephony\
    \ network is feature\n   transparency with respect to the PSTN.  Traditional telecom\
    \ services\n   such as call waiting, freephone numbers, etc., implemented in PSTN\n\
    \   protocols such as Signaling System No. 7 (SS7 [6]) should be offered\n   by\
    \ a SIP network in a manner that precludes any debilitating\n   difference in\
    \ user experience while not limiting the flexibility of\n   SIP.  On the one hand,\
    \ it is necessary that SIP support the\n   primitives for the delivery of such\
    \ services where the terminating\n   point is a regular SIP phone (see definition\
    \ in Section 2 below)\n   rather than a device that is fluent in SS7.  However,\
    \ it is also\n   essential that SS7 information be available at gateways, the\
    \ points\n   of SS7-SIP interconnection, to ensure transparency of features not\n\
    \   otherwise supported in SIP.  If possible, SS7 information should be\n   available\
    \ in its entirety and without any loss to trusted parties in\n   the SIP network\
    \ across the PSTN-IP interface; one compelling need to\n   do so also arises from\
    \ the fact that certain networks utilize\n   proprietary SS7 parameters to transmit\
    \ certain information through\n   their networks.\n   Another important characteristic\
    \ of a SIP telephony network is\n   routability of SIP requests - a SIP request\
    \ that sets up a telephone\n   call should contain sufficient information in its\
    \ headers to enable\n   it to be appropriately routed to its destination by proxy\
    \ servers in\n   the SIP network.  Most commonly this entails that parameters\
    \ of a\n   call like the dialed number should be carried over from SS7 signaling\n\
    \   to SIP requests.  Routing in a SIP network may in turn be influenced\n   by\
    \ mechanisms such as TRIP [8] or ENUM [7].\n   The SIP-T (SIP for Telephones)\
    \ effort provides a framework for the\n   integration of legacy telephony signaling\
    \ into SIP messages.  SIP-T\n   provides the above two characteristics through\
    \ techniques known as\n   'encapsulation' and 'translation' respectively.  At\
    \ a SIP-ISUP\n   gateway, SS7 ISUP messages are encapsulated within SIP in order\
    \ that\n   information necessary for services is not discarded in the SIP\n  \
    \ request.  However, intermediaries like proxy servers that make\n   routing decisions\
    \ for SIP requests cannot be expected to understand\n   ISUP, so simultaneously,\
    \ some critical information is translated from\n   an ISUP message into the corresponding\
    \ SIP headers in order to\n   determine how the SIP request will be routed.\n\
    \   While pure SIP has all the requisite instruments for the\n   establishment\
    \ and termination of calls, it does not have any baseline\n   mechanism to carry\
    \ any mid-call information (such as the ISUP INF/INR\n   query) along the SIP\
    \ signaling path during the session.  This mid-\n   call information does not\
    \ result in any change in the state of SIP\n   calls or the parameters of the\
    \ sessions that SIP initiates.  A\n   provision to transmit such optional application-layer\
    \ information is\n   also needed.\n   Problem definition: To provide ISUP transparency\
    \ across SS7-SIP\n   interworking\n   SS7-SIP Interworking Requirements     SIP-T\
    \ Functions\n   ==================================================================\n\
    \   Transparency of ISUP                  Encapsulation of ISUP in the\n   Signaling\
    \                             SIP body\n   Routability of SIP messages with  \
    \    Translation of ISUP information\n   dependencies on ISUP                \
    \  into the SIP header\n   Transfer of mid-call ISUP signaling   Use of the INFO\
    \ Method for mid-\n   messages                              call signaling\n \
    \  Table 1: SIP-T features that fulfill PSTN-IP inter-connection\n           \
    \ Requirements\n   While this document specifies the requirements above, it provide\n\
    \   mechanisms to satisfy them - however, this document does serve as an\n   framework\
    \ for the documents that do provide these mechanisms, all of\n   which are referenced\
    \ in Section 5.\n   Note that many modes of signaling are used in telephony (SS7\
    \ ISUP,\n   BTNUP, Q.931, MF etc.).  This document focuses on SS7 ISUP and aims\n\
    \   to specify the behavior across ISUP-SIP interfaces only.  The scope\n   of\
    \ the SIP-T enterprise may, over time, come to encompass other\n   signaling systems\
    \ as well.\n"
- title: 2. SIP-T for ISUP-SIP Interconnections
  contents:
  - "2. SIP-T for ISUP-SIP Interconnections\n   SIP-T is not a new protocol - it is\
    \ a set of mechanisms for\n   interfacing traditional telephone signaling with\
    \ SIP.  The purpose of\n   SIP-T is to provide protocol translation and feature\
    \ transparency\n   across points of PSTN-SIP interconnection.  It intended for\
    \ use where\n   a VoIP network (a SIP network, for the purposes of this document)\n\
    \   interfaces with the PSTN.\n   Using SIP-T, there are three basic models for\
    \ how calls interact with\n   gateways.  Calls that originate in the PSTN can\
    \ traverse a gateway to\n   terminate at a SIP endpoint, such as an IP phone.\
    \  Conversely, an IP\n   phone can make a call that traverses a gateway to terminate\
    \ in the\n   PSTN.  Finally, an IP network using SIP may serve as a transit\n\
    \   network between gateways - a call may originate and terminate in the\n   PSTN,\
    \ but cross a SIP-based network somewhere in the middle.\n   The SS7 interfaces\
    \ of a particular gateway determine the ISUP\n   variants that that gateway supports.\
    \  Whether or nor a gateway\n   supports a particular version of ISUP determines\
    \ whether it can\n   provide feature transparency while terminating a call.\n\
    \   The following are the primary agents in a SIP-T-enabled network.\n   o  PSTN\
    \ (Public Switched Telephone Network): This refers to the\n      entire interconnected\
    \ collection of local, long-distance and\n      international phone companies.\
    \  In the examples below, the term\n      Local Exchange Carrier (LEC) is used\
    \ to denote a portion (usually,\n      a regional division) of the PSTN.\n   o\
    \  IP endpoints: Any SIP user agent that can act as an originator or\n      recipient\
    \ of calls.  Thus, the following devices are classified as\n      IP endpoints:\n\
    \      *  Gateways: A telephony gateway provides a point of conversion\n     \
    \    between signaling protocols (such as ISUP and SIP) as well as\n         circuit-switch\
    \ and packet-switched audio media.  The term Media\n         Gateway Controller\
    \ (MGC) is also used in the examples and\n         diagrams in this document to\
    \ denote large-scale clusters of\n         decomposed gateways and control logic\
    \ that are frequently\n         deployed today.  So for example, a SIP-ISUP gateway\
    \ speaks ISUP\n         to the PSTN and SIP to the Internet and is responsible\
    \ for\n         converting between the types of signaling, as well as\n      \
    \   interchanging any associated bearer audio media.\n      *  SIP phones: The\
    \ term used to represent all end-user devices\n         that originate or terminate\
    \ SIP VoIP calls.\n      *  Interface points between networks where administrative\
    \ policies\n         are enforced (potentially middleboxes, proxy servers, or\n\
    \         gateways).\n   o  Proxy Servers: A proxy server is a SIP intermediary\
    \ that routes\n      SIP requests to their destinations.  For example, a proxy\
    \ server\n      might direct a SIP request to another proxy, a gateway or a SIP\n\
    \      phone.\n                           ********************\n             \
    \           ***                    ***\n                       *             \
    \            *\n                      *    -------                *\n        \
    \             *     |proxy|                 *\n                    *      -------\
    \                  *\n                |----|                            |----|\n\
    \               /|MGC1|       VoIP Network         |MGC2|\\\n              / \
    \ ----                              ----  \\\n      SS7    /       *         \
    \                      *    \\ SS7\n            /         *           -------\
    \           *      \\\n           /           *          |proxy|          *  \
    \      \\\n       --------         *         -------         *     ---------\n\
    \       | LEC1 |          **                     **      | LEC2  |\n       --------\
    \            *********************        ---------\n   Figure 1: Motivation for\
    \ SIP-T in ISUP-SIP interconnection\n   In Figure 2 a VoIP cloud serves as a transit\
    \ network for telephone\n   calls originating in a pair of LECs, where SIP is\
    \ employed as the\n   VoIP protocol used to set up and tear down these VoIP calls.\
    \  At the\n   edge of the depicted network, an MGC converts the ISUP signals to\
    \ SIP\n   requests,  and sends them to a proxy server which in turn routes\n \
    \  calls on other MGCs.  Although this figure depicts only two MGCs,\n   VoIP\
    \ deployments would commonly have many such points of\n   interconnection with\
    \ the PSTN (usually to diversify among PSTN rate\n   centers).  For a call originating\
    \ from LEC1 and be terminating in\n   LEC2, the originator in SIP-T is the gateway\
    \ that generates the SIP\n   request for a VoIP call, and the terminator is the\
    \ gateway that is\n   the consumer of the SIP request; MGC1 would thus be the\
    \ originator\n   and MGC2, the terminator.  Note that one or more proxies may\
    \ be used\n   to route the call from the originator to the terminator.\n   In\
    \ this flow, in order to seamlessly integrate the IP network with\n   the PSTN,\
    \ it is important to preserve the received SS7 information\n   within SIP requests\
    \ at the originating gateway and reuse this SS7\n   information when signaling\
    \ to the PSTN at the terminating gateway.\n   By encapsulating ISUP information\
    \ in the SIP signaling, a SIP network\n   can ensure that no SS7 information that\
    \ is critical to the\n   instantiation of features is lost when SIP bridges calls\
    \ between two\n   segments of the PSTN.\n   That much said, if only the exchange\
    \ of ISUP between gateways were\n   relevant here, any protocol for the transport\
    \ of signaling\n   information may be used to achieve this, obviating the need\
    \ for SIP\n   and consequently that of SIP-T.  SIP-T is employed in order to\n\
    \   leverage the intrinsic benefits of utilizing SIP: request routing and\n  \
    \ call control leveraging proxy servers (including the use of forking),\n   ease\
    \ of SIP service creation, SIP's capability negotiation systems,\n   and so on.\
    \  Translation of information from the received ISUP message\n   parameters to\
    \ SIP header fields enables SIP intermediaries to\n   consider this information\
    \ as they handle requests.  SIP-T thus\n   facilitates call establishment and\
    \ the enabling of new telephony\n   services over the IP network while simultaneously\
    \ providing a method\n   of feature-rich interconnection with the PSTN.\n   Finally,\
    \ the scenario in Figure 2 is just one of several flows in\n   which SIP-T can\
    \ be used - voice calls do not always both originate\n   and terminate in the\
    \ PSTN (via gateways); SIP phones can also be\n   endpoints in a SIP-T session.\
    \  In subsequent sections, the following\n   possible flows will be further detailed:\n\
    \   1.  PSTN origination - PSTN termination: The originating gateway\n       receives\
    \ ISUP from the PSTN and it preserves this information\n       (via encapsulation\
    \ and translation) in the SIP messages that it\n       transmits towards the terminating\
    \ gateway.  The terminator\n       extracts the ISUP content from the SIP message\
    \ that it receives\n       and it reuses this information in signaling sent to\
    \ the PSTN.\n   2.  PSTN origination - IP termination: The originating gateway\n\
    \       receives ISUP from the PSTN and it preserves this ISUP\n       information\
    \ in the SIP messages (via encapsulation and\n       translation) that it directs\
    \ towards the terminating SIP user\n       agent.  The terminator has no use for\
    \ the encapsulated ISUP and\n       ignores it.\n   3.  IP origination - PSTN\
    \ termination: A SIP phone originates a VoIP\n       call that is routed by one\
    \ or more proxy servers to the\n       appropriate terminating gateway.  The terminating\
    \ gateway\n       converts to ISUP signaling and directs the call to an appropriate\n\
    \       PSTN interface, based on information that is present in the\n       received\
    \ SIP header.\n   4.  IP origination - IP termination: This is a case for pure\
    \ SIP.\n       SIP-T (either encapsulation or translation of ISUP) does not come\n\
    \       into play as there is no PSTN interworking.\n"
- title: 3. SIP-T Flows
  contents:
  - "3. SIP-T Flows\n   The follow sections explore the essential SIP-T flows in detail.\n\
    \   Note that because proxy servers are usually responsible for routing\n   SIP\
    \ requests (based on the Request-URI) the eventual endpoints at\n   which a SIP\
    \ request will terminate is generally not known to the\n   originator.  So the\
    \ originator does not select from the flows\n   described in this section, as\
    \ a matter of static configuration or on\n   a per-call basis - rather, each call\
    \ is routed by the SIP network\n   independently, and it may instantiate any of\
    \ the flows below as the\n   routing logic of the network dictates.\n"
- title: 3.1 SIP Bridging (PSTN - IP - PSTN)
  contents:
  - "3.1 SIP Bridging (PSTN - IP - PSTN)\n                         ********************\n\
    \                      ***                    ***\n                     *    \
    \                     *\n                    *    -------                *\n \
    \                  *     |proxy|                 *\n                  *      -------\
    \                  *\n               |---|                             |---|\n\
    \              /|MGC|       VoIP Network          |MGC|\\\n             /  ---\
    \                               ---  \\\n            /     *                 \
    \              *     \\\n           /       *            -------           * \
    \     \\\n          /          *          |proxy|          *        \\\n     \
    \ --------         *         -------         *     ---------\n      | PSTN | \
    \         ***                    ***      | PSTN  |\n      --------          \
    \  *********************        ---------\n   Figure 2: PSTN origination - PSTN\
    \ termination (SIP Bridging)\n   A scenario in which a SIP network connects two\
    \ segments of the PSTN\n   is referred to as 'SIP bridging'.  When a call destined\
    \ for the SIP\n   network originates in the PSTN, an SS7 ISUP message will eventually\n\
    \   be received by the gateway that is the point of interconnection with\n   the\
    \ PSTN network.  This gateway is from the perspective of the SIP\n   protocol\
    \ the user agent client for this call setup request.\n   Traditional SIP routing\
    \ is used in the IP network to determine the\n   appropriate point of termination\
    \ (in this instance a gateway) and to\n   establish a SIP dialog and begin negotiation\
    \ of a media session\n   between the origination and termination endpoints.  The\
    \ egress\n   gateway then signals ISUP to the PSTN, reusing any encapsulated ISUP\n\
    \   present in the SIP request it receives as appropriate.\n   A very elementary\
    \ call-flow for SIP bridging is shown below.\n       PSTN            MGC#1   Proxy\
    \    MGC#2          PSTN\n       |-------IAM------>|       |        |        \
    \      |\n       |                 |-----INVITE---->|              |\n       |\
    \                 |       |        |-----IAM----->|\n       |                \
    \ |<--100 TRYING---|              |\n       |                 |       |      \
    \  |<----ACM------|\n       |                 |<-----18x-------|             \
    \ |\n       |<------ACM-------|       |        |              |\n       |    \
    \             |       |        |<----ANM------|\n       |                 |<----200\
    \ OK-----|              |\n       |<------ANM-------|       |        |       \
    \       |\n       |                 |------ACK------>|              |\n      \
    \ |====================Conversation=================|\n       |-------REL------>|\
    \       |        |              |\n       |<------RLC-------|------BYE------>|\
    \              |\n       |                 |       |        |-----REL----->|\n\
    \       |                 |<----200 OK-----|              |\n       |        \
    \         |       |        |<----RLC------|\n       |                 |      \
    \ |        |              |\n"
- title: 3.2 PSTN origination - IP termination
  contents:
  - "3.2 PSTN origination - IP termination\n                           ********************\n\
    \                        ***                    ***\n                       *\
    \                         *\n                      *                         \
    \  *\n                     *                             *\n                 \
    \   *                               *\n                |----|                \
    \            |-----|\n               /|MGC |       VoIP Network         |proxy|\\\
    \n              /  ----                              -----  \\\n             /\
    \       *                               *     \\\n            /         *    \
    \                         *       \\\n           /           *               \
    \            *         \\\n      --------         *                         *\
    \     -------------\n      | PSTN |          **                     **      |\
    \ SIP phone |\n      --------            *********************        -------------\n\
    \   Figure 3: PSTN origination - IP termination\n   A call originates from the\
    \ PSTN and terminates at a SIP phone.  Note\n   that in Figure 5, the proxy server\
    \ acts as the registrar for the SIP\n   phone in question.\n   A simple call-flow\
    \ depicting the ISUP and SIP signaling for a PSTN-\n   originated call terminating\
    \ at a SIP endpoint follows:\n   PSTN           MGC                  Proxy   \
    \           SIP phone\n     |----IAM----->|                     |            \
    \         |\n     |             |--------INVITE------>|                     |\n\
    \     |             |                     |-------INVITE------->|\n     |    \
    \         |<------100 TRYING----|                     |\n     |             |\
    \                     |<-------18x----------|\n     |             |<---------18x--------|\
    \                     |\n     |<----ACM-----|                     |          \
    \           |\n     |             |                     |<-------200 OK-------|\n\
    \     |             |<-------200 OK-------|                     |\n     |<----ANM-----|\
    \                     |                     |\n     |             |---------ACK-------->|\
    \                     |\n     |             |                     |---------ACK-------->|\n\
    \     |=====================Conversation========================|\n     |-----REL---->|\
    \                     |                     |\n     |             |----------BYE------->|\
    \                     |\n     |<----RLC-----|                     |---------BYE-------->|\n\
    \     |             |                     |<-------200 OK-------|\n     |    \
    \         |<-------200 OK-------|                     |\n     |             |\
    \                     |                     |\n"
- title: 3.3 IP origination - PSTN termination
  contents:
  - "3.3 IP origination - PSTN termination\n                          ********************\n\
    \                        ***                    ***\n                       *\
    \                         *\n                      *                         \
    \  *\n                     *                             *\n                 \
    \   *                               *\n               |-----|                \
    \            |----|\n              /|proxy|       VoIP Network         |MGC |\\\
    \n             /  -----                              ----  \\\n            / \
    \      *                               *     \\\n           /         *      \
    \                       *       \\\n          /           *                  \
    \         *         \\\n      ------------     *                         *   \
    \  ---------\n      |SIP phone |      **                     **      | PSTN  |\n\
    \      ------------        *********************        ---------\n   Figure 4:\
    \ IP origination - PSTN termination\n   A call originates from a SIP phone and\
    \ terminates in the PSTN.\n   Unlike the previous two flows, there is therefore\
    \ no ISUP\n   encapsulation in the request - the terminating gateway therefore\
    \ only\n   performs translation on the SIP headers to derive values for ISUP\n\
    \   parameters.\n   A simple call-flow illustrating the different legs in the\
    \ call is as\n   shown below.\n        SIP phone         Proxy               \
    \     MGC          PSTN\n     |-----INVITE----->|                       |    \
    \         |\n     |                 |--------INVITE-------->|             |\n\
    \     |<---100 TRYING---|                       |-----IAM---->|\n     |      \
    \           |<------100 TRYING------|             |\n     |                 |\
    \                       |<----ACM-----|\n     |                 |<---------18x----------|\
    \             |\n     |<------18x-------|                       |            \
    \ |\n     |                 |                       |<----ANM-----|\n     |  \
    \               |<--------200 OK--------|             |\n     |<-----200 OK-----|\
    \                       |             |\n     |-------ACK------>|            \
    \           |             |\n     |                 |----------ACK--------->|\
    \             |\n     |========================Conversation===================|\n\
    \     |-------BYE------>|                       |             |\n     |      \
    \           |----------BYE--------->|             |\n     |                 |\
    \                       |-----REL---->|\n     |                 |<--------200\
    \ OK--------|             |\n     |<-----200 OK-----|                       |<----RLC-----|\n"
- title: 4. SIP-T Roles and Behavior
  contents:
  - "4. SIP-T Roles and Behavior\n   There are three distinct sorts of elements (from\
    \ a functional point\n   of view) in a SIP VoIP network that interconnects with\
    \ the PSTN:\n   1.  The originators of SIP signaling\n   2.  The terminators of\
    \ SIP signaling\n   3.  The intermediaries that route SIP requests from the originator\
    \ to\n       the terminator\n   Behavior for the Section 4.1, Section 4.2 and\
    \ Section 4.3\n   intermediary roles in a SIP-T call are described in the following\n\
    \   sections.\n"
- title: 4.1 Originator
  contents:
  - "4.1 Originator\n   The function of the originating user agent client is to generate\
    \ the\n   SIP Call setup requests (i.e., INVITEs).  When a call originates in\n\
    \   the PSTN, a gateway is the UAC; otherwise some native SIP endpoint is\n  \
    \ the UAC.  In either case, note that the originator generally cannot\n   anticipate\
    \ what sort of entity the terminator will be, i.e., whether\n   final destination\
    \ of the request is in a SIP network or the PSTN.\n   In the case of calls originating\
    \ in the PSTN (see Figure 3 and Figure\n   5), the originating gateway takes the\
    \ necessary steps to preserve the\n   ISUP information by encapsulating it in\
    \ the SIP request it creates.\n   The originating gateway is entrusted with the\
    \ responsibility of\n   identifying the version of the ISUP (ETSI, ANSI, etc.)\
    \ that it has\n   received and providing this information in the encapsulated\
    \ ISUP\n   (usually by adding a multipart MIME body with appropriate MIME\n  \
    \ headers).  It then formulates the headers of the SIP INVITE request\n   from\
    \ the parameters of the ISUP that it has received from the PSTN as\n   appropriate\
    \ (see Section 5).  This might, for instance, entail\n   setting the 'To:' header\
    \ field in the INVITE to the reflect dialed\n   number (Called Party Number) of\
    \ the received ISUP IAM.\n   In other cases (like Figure 7), a SIP phone is the\
    \ originator of a\n   VoIP call.  Usually, the SIP phone sends requests to a SIP\
    \ proxy that\n   is responsible for routing the request to an appropriate destination.\n\
    \   There is no ISUP to encapsulate at the user agent client, as there is\n  \
    \ no PSTN interface.  Although the call may terminate in the telephone\n   network\
    \ and need to signal ISUP in order for that to take place, the\n   originator\
    \ has no way to anticipate this and it would be foolhardy to\n   require that\
    \ all SIP VoIP user agents have the capability to generate\n   ISUP.  It is therefore\
    \ not the responsibility of an IP endpoints like\n   a SIP phone to generate encapsulated\
    \ ISUP.  Thus, an originator must\n   generate the SIP signaling while performing\
    \ ISUP encapsulation and\n   translation when possible (meaning when the call\
    \ has originated in\n   the PSTN).\n   Originator requirements: encapsulate ISUP,\
    \ translate information from\n   ISUP to SIP, multipart MIME support (for gateways\
    \ only)\n"
- title: 4.2 Terminator
  contents:
  - "4.2 Terminator\n   The SIP-T terminator is a consumer of the SIP calls.  The\
    \ terminator\n   is a standard SIP UA that can be either a gateway that interworks\n\
    \   with the PSTN or a SIP phone.\n   In case of PSTN terminations (see Figure\
    \ 3 and Figure 7) the egress\n   gateway terminates the call to its PSTN interface.\
    \  The terminator\n   generates the ISUP appropriate for signaling to the PSTN\
    \ from the\n   incoming SIP message.  Values for certain ISUP parameters may be\n\
    \   gleaned from the SIP headers or extracted directly from an\n   encapsulated\
    \ ISUP body.  Generally speaking, a gateway uses any\n   encapsulated ISUP as\
    \ a template for the message it will send, but it\n   overwrites parameter values\
    \ in the template as it translates SIP\n   headers or adds any parameter values\
    \ that reflect its local policies\n   (see Appendix A item 1).\n   In case of\
    \ an IP termination (Figure 5), the SIP UAS that receives\n   SIP messages with\
    \ encapsulated ISUP typically disregards the ISUP\n   message.  This does introduce\
    \ a general requirement, however, that\n   devices like SIP phones handle multipart\
    \ MIME messages and unknown\n   MIME types gracefully (this is a baseline SIP\
    \ requirement, but also a\n   place where vendors have been known to make shortcuts).\n\
    \   Terminator requirements: standard SIP processing, interpretation of\n   encapsulated\
    \ ISUP (for gateways only), support for multipart MIME,\n   graceful handling\
    \ of unknown MIME content (for non-gateways only)\n"
- title: 4.3 Intermediary
  contents:
  - "4.3 Intermediary\n   Intermediaries like proxy servers are entrusted with the\
    \ task of\n   routing messages to one another, as well as gateways and SIP phones.\n\
    \   Each proxy server makes a forwarding decision for a SIP request based\n  \
    \ on values of various headers, or 'routable elements' (including the\n   Request-URI,\
    \ route headers, and potentially many other elements of a\n   SIP request).\n\
    \   SIP-T does introduce some additional considerations for forwarding a\n   request\
    \ that could lead to new features and requirements for\n   intermediaries.  Feature\
    \ transparency of ISUP is central to the\n   notion of SIP-T.  Compatibility between\
    \ the ISUP variants of the\n   originating and terminating PSTN interfaces automatically\
    \ leads to\n   feature transparency.  Thus, proxy servers might take an interest\
    \ in\n   the variants of ISUP that are encapsulated with requests - the\n   variant\
    \ itself could become a routable element.  The termination of a\n   call at a\
    \ point that results in greater proximity to the final\n   destination (rate considerations)\
    \ is also an important consideration.\n   The preference of one over the other\
    \ results in a trade-off between\n   simplicity of operation and cost.  The requirement\
    \ of procuring a\n   reasonable rate may dictate that a SIP-T call spans dissimilar\
    \ PSTN\n   interfaces (SIP bridging across different gateways that don't support\n\
    \   any ISUP variants in common).  In order to optimize for maximum\n   feature\
    \ transparency and rate, some operators of intermediaries might\n   want to consider\
    \ practices along the following lines:\n   a) The need for ISUP feature transparency\
    \ may necessitate ISUP\n      variant translation (conversion), i.e., conversion\
    \ from one\n      variant of ISUP to another in order to facilitate the termination\n\
    \      of that call over a gateway interface that does not support the\n     \
    \ ISUP variant of the originating PSTN interface.  (See Appendix A\n      item\
    \ 2.) Although in theory conversion may be performed at any\n      point in the\
    \ path of the request, it is optimal to perform it at a\n      point that is at\
    \ the greatest proximity to the terminating\n      gateway.  This could be accomplished\
    \ by delivering the call to an\n      application that might perform the conversion\
    \ between variants.\n      Feature transparency in this case is contingent on\
    \ the\n      availability of resources to perform ISUP conversion, and it\n  \
    \    incurs an increase in the call-set up time.\n   b) An alternative would be\
    \ to sacrifice ISUP transparency by handing\n      the call off to a gateway that\
    \ does not support the version of the\n      originating ISUP.  The terminating\
    \ MGC would then just ignore the\n      encapsulated ISUP and use the information\
    \ in the SIP header to\n      terminate the call.\n   So, it may be desirable\
    \ for proxy servers to have the intelligence to\n   make a judicious choice given\
    \ the options available to it.\n   Proxy requirements: ability to route based\
    \ on choice of routable\n   elements\n"
- title: 4.4 Behavioral Requirements Summary
  contents:
  - "4.4 Behavioral Requirements Summary\n   If the SIP-T originator is a gateway\
    \ that received an ISUP request,\n   it must always perform both encapsulation\
    \ and translation ISUP,\n   regardless of where the originator might guess that\
    \ the request will\n   terminate.\n   If the terminator does not understand ISUP,\
    \ it ignores it while\n   performing standard SIP processing.  If the terminator\
    \ does\n   understand ISUP, and needs to signal to the PSTN, it should reuse the\n\
    \   encapsulated ISUP if it understands the variant.  The terminator\n   should\
    \ perform the following steps:\n   o  Extract the ISUP from the message body,\
    \ and use this ISUP as a\n      message template.  Note that if there is no encapsulated\
    \ ISUP in\n      the message, the gateway should use a canonical template for\
    \ the\n      message type in question (a pre-populated ISUP message configured\n\
    \      in the gateway) instead.\n   o  Translate the headers of the SIP request\
    \ into ISUP parameters,\n      overwriting any values in the message template.\n\
    \   o  Apply any local policies in populating parameters.\n   An intermediary\
    \ must be able to route a call based on the choice of\n   routable elements in\
    \ the SIP headers.\n"
- title: 5. Components of the SIP-T Protocol
  contents:
  - "5. Components of the SIP-T Protocol\n   The mechanisms described in the following\
    \ sections are the components\n   of SIP-T that provide the protocol functions\
    \ entailed by the\n   requirements.\n"
- title: 5.1 Core SIP
  contents:
  - "5.1 Core SIP\n   SIP-T uses the methods and procedures of SIP as defined by RFC\
    \ 3261.\n"
- title: 5.2 Encapsulation
  contents:
  - "5.2 Encapsulation\n   Encapsulation of the PSTN signaling is one of the major\
    \ requirements\n   of SIP-T.  SIP-T uses multipart MIME bodies to enable SIP messages\
    \ to\n   contain multiple payloads (Session Description Protocol or SDP [5],\n\
    \   ISUP, etc.).  Numerous ISUP variants are in existence today; the ISUP\n  \
    \ MIME type enable recipients too recognize the ISUP type (and thus\n   determine\
    \ whether or not they support the variant) in the most\n   expeditious possible\
    \ manner.  One scheme for performing ISUP\n   encapsulation using multi-part MIME\
    \ has been described in [2].\n"
- title: 5.3 Translation
  contents:
  - "5.3 Translation\n   Translation encompasses all aspects of signaling protocol\
    \ conversion\n   between SIP and ISUP.  There are essentially two components to\
    \ the\n   problem of translation:\n   1.  ISUP SIP message mapping:  This describes\
    \ a mapping between ISUP\n       and SIP at the message level.  In SIP-T deployments\
    \ gateways are\n       entrusted with the task of generating a specific ISUP message\
    \ for\n       each SIP message received and vice versa.  It is necessary to\n\
    \       specify the rules that govern the mapping between ISUP and SIP\n     \
    \  messages (i.e., what ISUP messages is sent when a particular SIP\n       message\
    \ is received: an IAM must be sent on receipt of an INVITE,\n       a REL for\
    \ BYE, and so on).  A potential mapping between ISUP and\n       SIP messages\
    \ has been described in [10].\n   2.  ISUP parameter-SIP header mapping:  A SIP\
    \ request that is used to\n       set up a telephone call should contain information\
    \ that enables\n       it to be appropriately routed to its destination by proxy\
    \ servers\n       in the SIP network - for example, the telephone number dialed\
    \ by\n       the originating user.  It is important to standardize a set of\n\
    \       practices that defines the procedure for translation of\n       information\
    \ from ISUP to SIP (for example, the Called Party\n       Number in an ISUP IAM\
    \ must be mapped onto the SIP 'To' header\n       field and Request-URI, etc.).\
    \  This issue becomes inherently more\n       complicated by virtue of the fact\
    \ that the headers of a SIP\n       request (especially an INVITE) may be transformed\
    \ by\n       intermediaries, and that consequently, the SIP headers and\n    \
    \   encapsulated ISUP bodies come to express conflicting values -\n       effectively,\
    \ a part of the encapsulated ISUP may be rendered\n       irrelevant and obsolete.\n"
- title: 5.4 Support for mid-call signaling
  contents:
  - "5.4 Support for mid-call signaling\n   Pure SIP does not have any provision for\
    \ carrying any mid-call\n   control information that is generated during a session.\
    \  The INFO [3]\n   method should be used for this purpose.  Note however that\
    \ INFO is\n   not suitable for managing overlap dialing (for one way of\n   implementing\
    \ overlap dialing see [11]).  Also note that the use of\n   INFO for signaling\
    \ mid-call DTMF signals is not recommended (see\n   RFC2833 [9] for a recommended\
    \ mechanism).\n"
- title: 6. SIP Content Negotiation
  contents:
  - "6. SIP Content Negotiation\n   The originator of a SIP-T request might package\
    \ both SDP and ISUP\n   elements into the same SIP message by using the MIME multipart\n\
    \   format.  Traditionally in SIP, if the terminating device does not\n   support\
    \ a multipart payload (multipart/mixed) and/or the ISUP MIME\n   type, it would\
    \ then reject the SIP request with a 415 Unsupported\n   Media Type specifying\
    \ the media types it supports (by default,\n   'application/SDP').  The originator\
    \ would subsequently have to re-\n   send the SIP request after stripping out\
    \ the ISUP payload (i.e.  with\n   only the SDP payload) and this would then be\
    \ accepted.\n   This is a rather cumbersome flow, and it is thus highly desirable\
    \ to\n   have a mechanism by which the originator could signify which bodies\n\
    \   are required and which are optional so that the terminator can\n   silently\
    \ discard optional bodies that it does not understand\n   (allowing a SIP phone\
    \ to ignore an ISUP payload when processing ISUP\n   is not critical).  This is\
    \ contingent upon the terminator having\n   support for a Content-type of multipart/mixed\
    \ and access to the\n   Content-Disposition header to express criticality.\n \
    \  1.  Support for ISUP is optional.  Therefore, UA2 accepts the INVITE\n    \
    \   irrespective of whether it can process the ISUP.\n   UA1                 \
    \   UA2\n   INVITE-->\n      (Content-type:multipart/mixed;\n      Content-type:\
    \ application/sdp;\n      Content-disposition: session; handling=required;\n \
    \     Content-type: application/isup;\n      Content-disposition: signal; handling=optional;)\n\
    \                         <--18x\n   2.  Support for ISUP is preferred.  UA2 does\
    \ not support the ISUP and\n       rejects the INVITE with a 415 Unsupported Media\
    \ Type.  UA1 strips\n       off the ISUP and re-sends the INVITE with SDP only\
    \ and this is\n       the accepted.\n   UA1                    UA2\n   INVITE-->\
    \ (Content-type:multipart/mixed;\n      Content-type: application/sdp;\n     \
    \ Content-disposition: session; handling=required;\n      Content-type: application/isup;\n\
    \      Content-disposition: signal; handling=required;)\n                    \
    \       <--415\n                     (Accept: application/sdp)\n   ACK-->\n  \
    \ INVITE-->\n   (Content-type: application/sdp)\n                           <--18x\n\
    \   3.  Support for ISUP is mandatory for call establishment.  UA2 does\n    \
    \   not support the ISUP and rejects the INVITE with a 415\n       Unsupported\
    \ Media type.  UA1 then directs its request to UA3.\n   UA1                  \
    \  UA2\n   INVITE--> (Content-type:multipart/mixed;\n      Content-type: application/sdp;\n\
    \      Content-disposition: session; handling=required;\n      Content-type: application/isup;\n\
    \      Content-disposition: signal; handling=required;)\n                    \
    \    <--415\n                  (Accept: application/sdp)\n   ACK-->\n   UA1  \
    \                 UA3\n   INVITE--> (Content-type:multipart/mixed;\n       Content-type:\
    \ application/sdp;\n       Content-disposition: session; handling=required;\n\
    \       Content-type: application/isup;\n       Content-disposition: signal; handling=required;)\n\
    \   Note that the exchanges of messages above are not complete; only the\n   messages\
    \ relevant to this discussion are shown.  Specifics of the\n   ISUP MIME type\
    \ can be obtained from [2].  The 'version' and 'base'\n   parameters are not shown\
    \ here, but must be used in accordance with\n   the rules of [2].\n"
- title: 7. Security Considerations
  contents:
  - "7. Security Considerations\n   SIP-T can be employed as an interdomain signaling\
    \ mechanism that may\n   be subject to pre-existing trust relationships between\
    \ administrative\n   domains.  In many legal environments, distribution of ISUP\
    \ is\n   restricted to licensed carriers; SIP-T introduces some challenges in\n\
    \   so far as it bridges carrier signaling with end-user signaling.  Any\n   administrative\
    \ domain implementing SIP-T should have an adequate\n   security apparatus (including\
    \ elements that manage any appropriate\n   policies to manage fraud and billing\
    \ in an interdomain environment)\n   in place to ensure that the transmission\
    \ of ISUP information does not\n   result in any security violations.\n   Transporting\
    \ ISUP in SIP bodies may provide opportunities for abuse,\n   fraud, and privacy\
    \ concerns, especially when SIP-T requests can be\n   generated, inspected or\
    \ modified by arbitrary SIP endpoints.  ISUP\n   MIME bodies should be secured\
    \ (preferably with S/MIME [4]) to\n   alleviate this concern, as is described\
    \ in the Security\n   Considerations of the core SIP specification [1].  Authentication\n\
    \   properties provided by S/MIME would allow the recipient of a SIP-T\n   message\
    \ to ensure that the ISUP MIME body was generated by an\n   authorized entity.\
    \  Encryption would ensure that only carriers\n   possessing a particular decryption\
    \ key are capable of inspecting\n   encapsulated ISUP MIME bodies in a SIP request.\n\
    \   SIP-T endpoints MUST support S/MIME signatures (CMS SignedData), and\n   SHOULD\
    \ support encryption (CMS EnvelopedData).\n"
- title: 8. IANA Considerations
  contents:
  - "8. IANA Considerations\n   This document introduces no new considerations for\
    \ IANA.\n"
- title: Normative References
  contents:
  - "Normative References\n   [1]   Rosenberg, J., Schulzrinne, H., Camarillo, G.,\
    \ Johnston, A.,\n         Peterson, J., Sparks, R., Handley, M. and E. Schooler,\
    \ \"SIP:\n         Session Initiation Protocol\", RFC 3261, May 2002.\n   [2]\
    \   Zimmerer, E., Peterson, J., Vemuri, A., Ong, L., Audet, F.,\n         Watson,\
    \ M. and M. Zonoun, \"MIME media types for ISUP and QSIG\n         objects\",\
    \ RFC 3204, December 2001.\n   [3]   Donovan, S., \"The SIP INFO Method\", RFC\
    \ 2976, October 2000.\n   [4]   Ramsdell, B., \"S/MIME Version 3 Message Specification\"\
    , RFC\n         2633, June 1999.\n   [5]   Handley, M. and V. Jacobson, \"SDP:\
    \ Session Description\n         Protocol\", RFC 2327, April 1998.\n"
- title: Non-Normative References
  contents:
  - "Non-Normative References\n   [6]   International Telecommunications Union, \"\
    Signaling System No.\n         7; ISDN User Part Signaling procedures\", ITU-T\
    \ Q.764, September\n         1997, <http://www.itu.int>.\n   [7]   Faltstrom,\
    \ P., \"E.164 number and DNS\", RFC 2916, September\n         2000.\n   [8]  \
    \ Rosenberg, J., Salama, H. and M. Squire, \"Telephony Routing\n         over\
    \ IP (TRIP)\", RFC 3219, January 2002.\n   [9]   Schulzrinne, H. and S. Petrack,\
    \ \"RTP Payload for DTMF Digits,\n         Telephony Tones and Telephony Signals\"\
    , RFC 2833, May 2000.\n   [10]  Camarillo, G., Roach, A., Peterson, J. and L.\
    \ Ong, \"ISUP to SIP\n         Mapping\",  Work in Progress.\n   [11]  Camarillo,\
    \ G., Roach, A., Peterson, J. and L. Ong, \"Mapping of\n         ISUP Overlap\
    \ Signaling to SIP\", Work in Progress.\n"
- title: Appendix A. Notes
  contents:
  - "Appendix A. Notes\n   1.  Some terminating MGCs may alter the encapsulated ISUP\
    \ in order to\n       remove any conditions specific to the originating circuit;\
    \ for\n       example, continuity test flags in the Nature of Connection\n   \
    \    Indicators, etc.\n   2.  Even so, the relevance of ANSI-specific information\
    \ in an ETSI\n       network (or vice versa) is questionable.  Clearly, the strength\n\
    \       of SIP-T is realized when the encapsulated ISUP involves the\n       usage\
    \ of proprietary parameters.\n"
- title: Appendix B. Acknowledgments
  contents:
  - "Appendix B. Acknowledgments\n   We thank Andrew Dugan, Rob Maidhof, Dave Martin,\
    \ Adam Roach, Jonathan\n   Rosenberg, Dean Willis, Robert F.  Penfield, Steve\
    \ Donovan, Allison\n   Mankin, Scott Bradner and Steve Bellovin for their valuable\
    \ comments.\n   The original 'SIP+' proposal for interconnecting portions of the\
    \ PSTN\n   with SIP bridging was developed by Eric Zimmerer.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Aparna Vemuri-Pattisam\n   Qwest Communications\n   6000\
    \ Parkwood Pl\n   Dublin, OH  43016 US\n   EMail: Aparna.Vemuri@Qwest.com\n  \
    \        vaparna10@yahoo.com\n   Jon Peterson\n   NeuStar, Inc.\n   1800 Sutter\
    \ St\n   Suite 570\n   Concord, CA  94520 US\n   Phone: +1 925/363-8720\n   EMail:\
    \ jon.peterson@neustar.biz\n   URI:   http://www.neustar.biz/\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2002).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
