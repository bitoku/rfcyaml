- contents:
  - '         Virtual Subnet Selection Options for DHCPv4 and DHCPv6

    '
  title: __initial_text__
- contents:
  - "Abstract\n   This memo defines a DHCPv4 Virtual Subnet Selection (VSS) option,
    a\n   DHCPv6 VSS option, and the DHCPv4 VSS and VSS-Control sub-options\n   carried
    in the DHCPv4 Relay Agent Information option.  These are\n   intended for use
    by DHCP clients, relay agents, and proxy clients in\n   situations where VSS information
    needs to be passed to the DHCP\n   server for proper address or prefix allocation
    to take place.\n   For the DHCPv4 option and Relay Agent Information sub-options,
    this\n   memo documents and extends existing usage as per RFC 3942.  This memo\n
    \  updates RFC 3046 regarding details relating to the copying of sub-\n   options
    (see Section 8).\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    5741.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6607.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n   This document may contain
    material from IETF Documents or IETF\n   Contributions published or made publicly
    available before November\n   10, 2008.  The person(s) controlling the copyright
    in some of this\n   material may not have granted the IETF Trust the right to
    allow\n   modifications of such material outside the IETF Standards Process.\n
    \  Without obtaining an adequate license from the person(s) controlling\n   the
    copyright in such materials, this document may not be modified\n   outside the
    IETF Standards Process, and derivative works of it may\n   not be created outside
    the IETF Standards Process, except to format\n   it for publication as an RFC
    or to translate it into languages other\n   than English.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n
    \  2. Terminology .....................................................4\n   3.
    Virtual Subnet Selection Options and Sub-Options: Definitions ...6\n      3.1.
    DHCPv4 Virtual Subnet Selection Option .....................6\n      3.2. DHCPv4
    Virtual Subnet Selection Sub-Option .................6\n      3.3. DHCPv4 Virtual
    Subnet Selection Control Sub-Option .........7\n      3.4. DHCPv6 Virtual Subnet
    Selection Option .....................7\n      3.5. Virtual Subnet Selection Type
    and Information ..............8\n   4. Overview of Virtual Subnet Selection Usage
    ......................8\n      4.1. VPN Assignment by the DHCP Relay Agent .....................9\n
    \     4.2. VPN Assignment by the DHCP Server .........................12\n      4.3.
    Required Support ..........................................14\n      4.4. Alternative
    VPN Assignment Approaches .....................14\n   5. Relay Agent Behavior
    ...........................................15\n      5.1. VPN Assignment by the
    DHCP Server .........................16\n      5.2. DHCP Leasequery ...........................................17\n
    \  6. Client Behavior ................................................17\n   7.
    Server Behavior ................................................19\n      7.1.
    Returning the DHCPv4 or DHCPv6 Option .....................20\n      7.2. Returning
    the DHCPv4 Sub-Option ...........................20\n      7.3. Making Sense of
    Conflicting VSS Information ...............21\n   8. Update to RFC 3046 .............................................22\n
    \  9. Security Considerations ........................................22\n   10.
    IANA Considerations ...........................................23\n   11. Acknowledgments
    ...............................................24\n   12. References ....................................................25\n
    \     12.1. Normative References .....................................25\n      12.2.
    Informative References ...................................25\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   There is a growing use of Virtual Private Network (VPN)\n
    \  configurations.  This growth comes from many areas: individual client\n   systems
    needing to appear to be on the home corporate network even\n   when traveling,
    ISPs providing extranet connectivity for customer\n   companies, etc.  In some
    of these cases, there is a need for the DHCP\n   server to know the VPN (also
    called a \"Virtual Subnet Selector\" or\n   \"VSS\" in this document) from which
    an address, and other resources,\n   should be allocated.\n   This memo defines
    a DHCPv4 Virtual Subnet Selection (VSS) option, a\n   DHCPv6 VSS option, and two
    VSS sub-options carried in the DHCPv4\n   Relay Agent Information option.  These
    are intended for use by DHCP\n   clients, relay agents, and proxy clients in situations
    where VSS\n   information needs to be passed to the DHCP server for proper address\n
    \  or prefix allocation to take place.  If the receiving DHCP server\n   understands
    the VSS option or sub-options, this information may be\n   used in conjunction
    with other information in determining the subnet\n   on which to select an address,
    as well as other information such as\n   DNS server, default router, etc.\n   If
    the allocation is being done through a DHCPv4 relay, then the\n   Relay Agent
    Information sub-options defined here should be included.\n   In some cases, however,
    an IP address is being sought by a DHCPv4\n   proxy on behalf of a client (which
    may be assigned the address via a\n   different protocol).  In this case, there
    is a need to include VSS\n   information relating to the client as a DHCPv4 option.\n
    \  If the allocation is being done through a DHCPv6 relay, then the\n   DHCPv6
    VSS option defined in this document should be included in the\n   Relay-forward
    and Relay-reply messages going between the DHCPv6 relay\n   and server.  In some
    cases, addresses or prefixes are being sought by\n   a DHCPv6 proxy on behalf
    of a client.  In this case, there is a need\n   for the client itself to supply
    the VSS information using the DHCPv6\n   VSS option in the messages that it sends
    to the DHCPv6 server.\n   In the remaining text of this document, when a DHCPv6
    address is\n   indicated, the same information applies to DHCPv6 prefix delegation\n
    \  [RFC3633] as well.\n   In the remaining text of this document, when the term
    \"VSS\n   sub-option\" is used, it refers to the VSS sub-option carried in the\n
    \  DHCPv4 Relay Agent Information option.\n"
  title: 1.  Introduction
- contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\",
    \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\"
    in this\n   document are to be interpreted as described in RFC 2119 [RFC2119].\n
    \  This document uses the following terms:\n   o  DHCP client\n      A DHCP client
    is a host using DHCP to obtain configuration\n      parameters such as a network
    address.\n   o  DHCP proxy\n      A DHCP proxy is a DHCP client that acquires
    IP addresses not for\n      its own use but rather on behalf of another entity.
    \ There are a\n      variety of ways that a DHCP proxy can supply the addresses
    it\n      acquires to other entities that need them.\n   o  DHCP relay agent\n
    \     A DHCP relay agent is an agent that transfers BOOTP and DHCP\n      messages
    between clients and servers residing on different\n      subnets, per [RFC951],
    [RFC1542], and [RFC3315].\n   o  DHCP server\n      A DHCP server is a host that
    returns configuration parameters to\n      DHCP clients.\n   o  DHCPv4 option\n
    \     A DHCPv4 option is an option used to implement a capability\n      defined
    by the DHCPv4 RFCs ([RFC2131] [RFC2132]).  This option has\n      one-octet code
    and size fields.\n   o  DHCPv4 sub-option\n      As used in this document, a DHCPv4
    sub-option refers to a\n      sub-option of the Relay Agent Information option
    [RFC3046].  This\n      sub-option has one-octet code and size fields.\n   o  DHCPv6
    option\n      A DHCPv6 option is an option used to implement a capability\n      defined
    by the DHCPv6 RFC [RFC3315].  This option has two-octet\n      code and size fields.\n
    \  o  Global VPN\n      This term indicates that the address being described belongs
    to\n      the set of addresses not part of any VPN -- in other words, the\n      normal
    address space operated on by DHCP.  This includes private\n      addresses --
    for example, the 10.x.x.x addresses as well as the\n      other private subnets
    that are not routed on the open Internet.\n   o  NVT ASCII identifier\n      A
    Network Virtual Terminal (NVT) identifier is an identifier\n      containing only
    characters from the ASCII repertoire and using the\n      Network Virtual Terminal
    encoding (see Appendix B of [RFC5198]).\n   o  VSS information\n      VSS information
    provides information about a VPN necessary to\n      allocate an address to a
    DHCP client on that VPN and necessary to\n      forward a DHCP reply packet to
    a DHCP client on that VPN.\n   o  VPN\n      This term refers to a virtual private
    network.  A VPN appears to\n      the client to be a private network.\n   o  VPN
    identifier\n      The VPN-ID is defined by [RFC2685] to be a sequence of 7 octets.\n"
  title: 2.  Terminology
- contents:
  - "3.  Virtual Subnet Selection Options and Sub-Options: Definitions\n   The VSS
    options and sub-options contain a generalized way to specify\n   the VSS information
    about a VPN.  There are two options and two\n   sub-options defined in this section.
    \ The actual VSS information is\n   identical for both options and for one of
    the two sub-options.\n"
  - contents:
    - "3.1.  DHCPv4 Virtual Subnet Selection Option\n   The format of the option is
      shown below.\n    0                   1                   2                   3\n
      \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Code      |    Length     |     Type      | VSS Info. ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \          Code     The option code (221).\n           Length   The option length,
      minimum 1 octet.\n           Type and VSS Information -- see Section 3.5.\n"
    title: 3.1.  DHCPv4 Virtual Subnet Selection Option
  - contents:
    - "3.2.  DHCPv4 Virtual Subnet Selection Sub-Option\n   This is a sub-option of
      the Relay Agent Information option [RFC3046].\n   The format of the sub-option
      is shown below.\n    0                   1                   2                   3\n
      \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |     Code      |    Length     |     Type      | VSS Info. ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \          Code     The sub-option code (151).\n           Length   The sub-option
      length, minimum 1 octet.\n           Type and VSS Information -- see Section
      3.5.\n"
    title: 3.2.  DHCPv4 Virtual Subnet Selection Sub-Option
  - contents:
    - "3.3.  DHCPv4 Virtual Subnet Selection Control Sub-Option\n   This is a sub-option
      of the Relay Agent Information option [RFC3046].\n   The format of the sub-option
      is shown below.\n       0                   1\n       0 1 2 3 4 5 6 7 8 9 0
      1 2 3 4 5\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |     Code      |
      \   Length     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n              Code
      \    The sub-option code (152).\n              Length   The sub-option length,
      0.\n   This sub-option only appears in the DHCPv4 Relay Agent Information\n
      \  option.  In a DHCP request, it indicates that a DHCPv4 VSS sub-option\n   is
      also present in the Relay Agent Information option.  In a DHCP\n   reply, if
      it appears in the Relay Agent Information option, it\n   indicates that the
      DHCP server did not understand any DHCPv4 VSS\n   sub-option that also appears
      in the Relay Agent Information option.\n"
    title: 3.3.  DHCPv4 Virtual Subnet Selection Control Sub-Option
  - contents:
    - "3.4.  DHCPv6 Virtual Subnet Selection Option\n   The format of the DHCPv6 VSS
      option is shown below.  This option may\n   be included by a client or relay
      agent (or both).\n    0                   1                   2                   3\n
      \   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |           OPTION_VSS          |           option-len          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  |       Type    |   VSS Information ...                         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \  option-code       OPTION_VSS (68).\n   option-len        The number of octets
      in the option, minimum 1.\n   Type and VSS Information -- see Section 3.5.\n"
    title: 3.4.  DHCPv6 Virtual Subnet Selection Option
  - contents:
    - "3.5.  Virtual Subnet Selection Type and Information\n   All of the (sub-)options
      defined above that carry VSS information use\n   identical payloads consisting
      of a Type value and additional VSS\n   information, as follows:\n       Type
      \    VSS Information Format\n       ------------------------------------------------------------\n
      \       0       Network Virtual Terminal (NVT) ASCII VPN identifier\n        1
      \      RFC 2685 VPN-ID\n        2-254   Unassigned\n        255     Global,
      default VPN\n   o  Type 0 -- Network Virtual Terminal (NVT) ASCII VPN identifier\n
      \     Indicates that the VSS information consists of an NVT ASCII\n      string.
      \ It MUST NOT be terminated with a zero byte.\n   o  Type 1 -- RFC 2685 VPN-ID\n
      \     Indicates that the VSS information consists of an RFC 2685 VPN-ID\n      [RFC2685],
      which is defined to be 7 octets in length.\n   o  Type 255 -- Global, default
      VPN\n      Indicates that there is no explicit, non-default VSS information\n
      \     but rather that this option references the normal, global, default\n      address
      space.  In this case, there MUST NOT be any VSS\n      information included
      in the VSS option or sub-option, and the\n      length of the option or sub-option
      MUST be 1.\n   All other values of the Type field are unassigned.\n"
    title: 3.5.  Virtual Subnet Selection Type and Information
  title: '3.  Virtual Subnet Selection Options and Sub-Options: Definitions'
- contents:
  - "4.  Overview of Virtual Subnet Selection Usage\n   At the highest level, the
    VSS option or sub-option determines the VPN\n   on which a DHCP client is supposed
    to receive an IP address.  How the\n   option or sub-option is entered and processed
    is discussed below, but\n   the point of all of the discussion is to determine
    the VPN on which\n   the DHCP client resides.  This will affect a relay agent,
    in that it\n   will have to ensure that DHCP packets sent to and received from
    the\n   DHCP client flow over the correct VPN.  This will affect the DHCP\n   server
    in that it determines the IP address space used for the IP\n   address allocation.\n
    \  A DHCP server has as part of its configuration some IP address space\n   from
    which it allocates IP addresses to DHCP clients.  These\n   allocations are typically
    for a limited time, and thus the DHCP\n   client gets a lease on the IP address.
    \ In the absence of any VPN\n   information, the IP address space is in the global
    or default VPN\n   used throughout the Internet.  When a DHCP server deals with
    VPN\n   information, each VPN defines a new address space inside the server,\n
    \  one distinct from the global or default IP address space.  A server\n   that
    supports the VSS option or sub-option thereby supports\n   allocation of IP addresses
    from multiple different VPNs.  Supporting\n   IP address allocation from multiple
    different VPNs means that the\n   DHCP server must be prepared to configure multiple
    different address\n   spaces (one per distinct VPN) and allocate IP addresses
    from these\n   different address spaces.\n   These address spaces are typically
    independent, so that the same IP\n   address (consisting of the same string of
    bytes) could be allocated\n   to one client in the global, default VPN, and to
    a different client\n   residing in a different VPN.  There is no conflict in this\n
    \  allocation, since the clients have essentially different addresses,\n   even
    though these addresses consist of the same string of bytes,\n   because the IPv4
    or IPv6 address is qualified by the VPN.\n   Thus, a VSS option or sub-option
    is a way of signaling the use of a\n   VPN other than the global or default VPN.
    \ This brings up the\n   question of who decides what VPN a DHCP client should
    be using.\n   There are three entities that can insert either a VSS option or\n
    \  sub-option into a DHCPv4 packet or DHCPv6 message: a DHCP client, a\n   relay
    agent, or a DHCPv4 or DHCPv6 server.  While all of these\n   entities could include
    a different VSS option or sub-option in every\n   request or response, this situation
    is neither typical nor useful.\n   There are two known paradigms for use of the
    VSS option or\n   sub-option; these are discussed below.\n"
  - contents:
    - "4.1.  VPN Assignment by the DHCP Relay Agent\n   The typical use of the VSS
      option or sub-option is for the relay\n   agent to know the VPN on which the
      DHCP client is operating.  The\n   DHCP client itself does not, in this approach,
      know the VPN on which\n   it resides.  The relay agent is responsible for mediating
      the access\n   between the VPN on which the DHCP client resides and the DHCP
      server.\n   In this situation, the relay agent will insert two DHCPv4\n   Relay
      Agent Information sub-options (one VSS sub-option, and one\n   VSS-Control sub-option)
      into the Relay Agent Information option, or a\n   DHCPv6 VSS option into the
      Relay-forward message of every request it\n   forwards from the DHCP client.
      \ The server will use the DHCPv6 VSS\n   option or DHCPv4 VSS sub-option to
      determine the VPN on which the\n   client resides and will use that VPN information
      to select the\n   address space within its configuration from which to allocate
      an IP\n   address to the DHCP client.\n   When, using this approach, a DHCPv4
      relay agent inserts a VSS\n   sub-option into the Relay Agent Information option,
      it MUST also\n   insert a VSS-Control sub-option into the Relay Agent Information\n
      \  option.  This is to allow the determination of whether or not the\n   DHCPv4
      server actually processes the VSS information provided by the\n   DHCPv4 relay
      agent.  If the DHCPv4 server supports the VSS\n   capabilities described in
      this document, it will remove the\n   VSS-Control sub-option from the Relay
      Agent Information option that\n   it returns to the DHCPv4 relay agent.  See
      Section 5 for more\n   information.\n   In this approach, the relay agent might
      also send a VSS option or\n   sub-option in either a DHCPv4 or DHCPv6 Leasequery
      request [RFC4388]\n   [RFC5007], but in this case, it would use the VSS option
      in the\n   Leasequery request to select the correct address space for the\n
      \  Leasequery.  In this approach, the relay agent would be acting as a\n   DHCP
      client from a leasequery standpoint, but it would not be as if a\n   DHCP client
      were sending in a VSS option in a standard DHCP address\n   allocation request,
      say a DHCPDISCOVER.\n   In this approach, only one relay agent would mediate
      the VPN access\n   for the DHCP client to the DHCP server, and it would be the
      relay\n   agent that inserts the VSS information into the request packet and\n
      \  that would remove it prior to forwarding the response packet.\n   The diagram
      below shows an example of a DHCPv4 client, DHCPv4 relay\n   agent, and DHCPv4
      server.  The DHCPv6 situation is similar but uses\n   the DHCPv6 VSS option.\n
      \                               DHCPv4\n           DHCPv4               Relay
      \                   DHCPv4\n           Client               Agent                    Server\n
      \            |                     |                       |\n             |
      >--DHCPDISCOVER-->  |                       |\n             |    on VPN \"abc\"
      \    |                       |\n             |                     | >--DHCPDISCOVER---->
      \ |\n             |                     |   Relay Agent Info:   |\n             |
      \                    |     VSS type 0:\"abc\"  |\n             |                     |
      \    VSS-Control       |\n             |                     |                       |\n
      \            |                     | <----DHCPOFFER-----<  |\n             |
      \                    |   Relay Agent Info:   |\n             |                     |
      \    VSS type 0:\"abc\"  |\n             |                     |                       |\n
      \            | <---DHCPOFFER----<  |                       |\n             |
      \   on VPN \"abc\"     |                       |\n             |                     |
      \                      |\n             | >--DHCPREQUEST--->  |                       |\n
      \            |    on VPN \"abc\"     |                       |\n             |
      \                    | >--DHCPREQUEST----->  |\n             |                     |
      \  Relay Agent Info:   |\n             |                     |     VSS type
      0:\"abc\"  |\n             |                     |     VSS-Control       |\n
      \            |                     |                       |\n             |
      \                    | <----DHCPACK-------<  |\n             |                     |
      \  Relay Agent Info:   |\n             |                     |     VSS type
      0:\"abc\"  |\n             |                     |                       |\n
      \            | <---DHCPACK------<  |                       |\n             |
      \   on VPN \"abc\"     |                       |\n             |                     |
      \                      |\n            ...                   ...                     ...\n
      \              Figure 4.1-1:  DHCPv4 - Relay Agent Knows VPN\n   The DHCP server
      would know that it should respond to VPN information\n   specified in a VSS
      option or sub-option, and it would be configured\n   with appropriate VPN address
      spaces to service the projected client\n   requirements.  Thus, in this common
      approach, the DHCP client knows\n   nothing of any VPN access, the relay agent
      has been configured in\n   some way that allows it to determine the VPN of the
      DHCP client and\n   transmit that using a VSS option or sub-option to the DHCP
      server,\n   and the DHCP server responds to the VPN specified by the relay agent.\n
      \  There is no conflict between different entities trying to specify\n   different
      VSS information -- each entity knows its role through\n   policy or configuration
      external to this document.\n   If any misconfiguration exists, it SHOULD result
      in a DHCP client\n   being unable to acquire an IP address.  For instance, a
      relay agent\n   that supports VPN access SHOULD couple transmission of VSS options
      or\n   sub-options to the configuration of VPN support and not allow one\n   without
      the other.\n   It is important to ensure that the relay agent and DHCP server
      both\n   support the VSS option and sub-options (for DHCPv4) or the VSS option\n
      \  (for DHCPv6).  Deploying DHCPv4 relay agents that support and emit\n   VSS
      sub-options in concert with DHCPv4 servers that do not support\n   the VSS option
      or sub-option as defined in this document SHOULD NOT\n   be done, as such an
      ensemble will not operate correctly.  Should this\n   situation occur, however,
      the relay agent can detect the problem\n   (since the VSS-Control sub-option
      will appear in the packets it\n   receives from the DHCPv4 server, indicating
      the server did not\n   effectively process the VSS sub-option), and it can issue
      appropriate\n   diagnostic messages.\n"
    title: 4.1.  VPN Assignment by the DHCP Relay Agent
  - contents:
    - "4.2.  VPN Assignment by the DHCP Server\n   In this approach, the DHCP server
      would be configured in some way to\n   know the VPN on which a particular DHCP
      client should be given\n   access.  The DHCP server would in this case include
      the VSS\n   sub-option in the Relay Agent Information option for DHCPv4 or the\n
      \  VSS option in the Relay-reply message for DHCPv6.  The relay agent\n   responsible
      for mediating VPN access would use this information to\n   select the correct
      VPN for the DHCP client.  In the unusual event\n   that there were more than
      one relay agent involved in this\n   transaction, some external configuration
      or policy would be needed to\n   inform the DHCPv6 server into which Relay-reply
      message the VSS\n   option should go.\n   Once the relay agent has placed the
      DHCP client into the proper VPN,\n   it SHOULD begin including VSS information
      in requests that it\n   forwards to the DHCP server.  Since this information
      does not\n   conflict with the DHCP server's idea of the proper VPN for the\n
      \  client, everything works correctly.\n   The diagram below shows this approach
      using DHCPv4.  The DHCPv6\n   situation is similar but uses the DHCPv6 VSS option
      instead.\n                                DHCPv4\n           DHCPv4               Relay
      \                   DHCPv4\n           Client               Agent                    Server\n
      \            |                     |                       |\n             |
      >--DHCPDISCOVER-->  |                       |\n             |    on unknown
      VPN   |                       |\n             |                     | >--DHCPDISCOVER---->
      \ |\n             |                     |                       |\n             |
      \                    | <----DHCPOFFER-----<  |\n             |                     |
      \  Relay Agent Info:   |\n             |                     |     VSS type
      0:\"abc\"  |\n             |                     |                       |\n
      \            | <---DHCPOFFER----<  |                       |\n             |
      \   on VPN \"abc\"     |                       |\n             |                     |
      \                      |\n             | >--DHCPREQUEST--->  |                       |\n
      \            |    on VPN \"abc\"     |                       |\n             |
      \                    | >--DHCPREQUEST----->  |\n             |                     |
      \  Relay Agent Info:   |\n             |                     |     VSS type
      0:\"abc\"  |\n             |                     |     VSS-Control       |\n
      \            |                     |                       |\n             |
      \                    | <----DHCPACK-------<  |\n             |                     |
      \  Relay Agent Info:   |\n             |                     |     VSS type
      0:\"abc\"  |\n             |                     |                       |\n
      \            | <---DHCPACK------<  |                       |\n             |
      \   on VPN \"abc\"     |                       |\n             |                     |
      \                      |\n             |                     |                       |\n
      \           ...                   ...                     ...\n              Figure
      4.2-1:  DHCPv4 - DHCPv4 Server Knows VPN\n   In this approach, the DHCP client
      is again unaware of any VPN\n   activity.  In this case, however, the DHCP server
      knows the VPN for\n   the client, and the relay agent responds to the VSS information\n
      \  specified by the DHCP server.  Similar to the previous approach, each\n   entity
      knows its role through a means external to this document, and\n   no two entities
      try to specify VSS information in conflict.\n   It is important that both the
      relay agent and the DHCP server support\n   the VSS option and sub-options (for
      DHCPv4) and the VSS option (for\n   DHCPv6).  Deploying and configuring VPN
      support in one element and\n   not in the other is not a practical approach.\n"
    title: 4.2.  VPN Assignment by the DHCP Server
  - contents:
    - "4.3.  Required Support\n   DHCP relay agents and servers MUST support the approach
      discussed in\n   Section 4.1.  DHCP relay agents and servers SHOULD support
      the\n   approach discussed in Section 4.2.  DHCP relay agents and servers\n
      \  SHOULD NOT be configured to operate with both approaches\n   simultaneously.\n"
    title: 4.3.  Required Support
  - contents:
    - "4.4.  Alternative VPN Assignment Approaches\n   There are many other approaches
      that can be created with multiple\n   relay agents each inserting VSS information
      into different\n   Relay-forward messages, relay agent VSS information conflicting
      with\n   client VSS information, or DHCP server VSS information conflicting\n
      \  with relay agent and client VSS information.  Since these approaches\n   do
      not describe situations that are useful today, specifying\n   precisely how
      to resolve all of these conflicts is not likely to be\n   valuable in the event
      that these approaches actually become practical\n   in the future.\n   The current
      use of the VSS option and sub-option requires that each\n   entity know the
      part that it plays in dealing with VPN data.  Each\n   entity -- client, relay
      agent or agents, and server -- SHOULD know\n   through some policy or configuration
      beyond the scope of this\n   document whether it is responsible for specifying
      VPN information\n   using the VSS option or sub-option or responsible for responding
      to\n   VSS information specified by another entity, or whether it should\n   simply
      ignore any VSS information that it might see.\n   Some simple conflict-resolution
      approaches are discussed below, in\n   the hopes that they will cover simple
      cases that may arise from\n   situations beyond those envisioned today.  However,
      for more complex\n   situations, or simple situations where appropriate conflict-\n
      \  resolution strategies differ from those discussed in this document, a\n   document
      detailing the usage situations and appropriate conflict-\n   resolution strategies
      SHOULD be created and submitted for discussion\n   and approval.\n"
    title: 4.4.  Alternative VPN Assignment Approaches
  title: 4.  Overview of Virtual Subnet Selection Usage
- contents:
  - "5.  Relay Agent Behavior\n   Implementers MAY provide a policy or configuration
    capability to\n   enable or disable VSS support.\n   A relay agent that receives
    a DHCP request from a DHCP client on a\n   VPN SHOULD include VSS information
    in the DHCP packet prior to\n   forwarding the packet to the DHCP server unless
    inhibited from doing\n   so by configuration information or policy to the contrary.\n
    \  In this situation, a DHCPv4 relay agent MUST include a DHCPv4 VSS\n   sub-option
    in a Relay Agent Information option [RFC3046], while a\n   DHCPv6 relay agent
    MUST include a DHCPv6 VSS option in the\n   Relay-forward message.\n   The value
    placed in the VSS sub-option or option would typically be\n   sufficient for the
    relay agent to properly route any DHCP reply\n   packet returned from the DHCP
    server to the DHCP client for which it\n   is destined.  In some cases, the information
    in the VSS sub-option or\n   option might be an index to some internal table held
    in the relay\n   agent, though this document places no requirement on a relay
    agent to\n   have any such internal state.\n   A DHCPv4 relay agent MUST, in addition,
    include a DHCPv4 VSS-Control\n   sub-option (which has a length of zero) in the\n
    \  Relay Agent Information option [RFC3046] whenever it includes a VSS\n   sub-option
    in the Relay Agent Information option.  The inclusion of\n   the VSS sub-option
    and the VSS-Control sub-option in the\n   Relay Agent Information option will
    allow the DHCPv4 relay agent to\n   determine whether the DHCPv4 server actually
    processed the\n   information in the VSS sub-option when it receives the\n   Relay
    Agent Information option in the reply from the DHCPv4 server.\n   The reason to
    include this additional VSS DHCPv4 sub-option is that\n   [RFC3046] specifies
    (essentially) that a DHCPv4 server should copy\n   all sub-options that it receives
    in a Relay Agent Information option\n   in a request into a corresponding Relay
    Agent Information option in\n   the response.  Thus, a server that didn't support
    the DHCPv4 VSS\n   sub-option would normally just copy it to the response packet,\n
    \  leaving the relay agent to wonder if in fact the DHCPv4 server\n   actually
    used the VSS information when processing the request.\n   To alleviate this potential
    confusion, a DHCPv4 relay agent instead\n   sends in two sub-options: one VSS
    sub-option, and one VSS-Control\n   sub-option.  If both sub-options appear in
    the response from the\n   DHCPv4 server, then the DHCPv4 relay agent MUST assume
    that the\n   DHCPv4 server did not act on the VSS information in the VSS\n   sub-option.
    \ If only the VSS sub-option appears in the response from\n   the DHCPv4 server
    and no VSS-Control sub-option appears in the\n   response from the DHCPv4 server,
    then the relay agent SHOULD assume\n   that the DHCPv4 server acted successfully
    on the VSS sub-option.\n   Any time a relay agent places a VSS option or sub-option
    in a DHCP\n   request, it SHOULD send it only to a DHCP server that supports the\n
    \  VSS option or sub-option, and it MUST check the response to determine\n   if
    the DHCP server actually honored the requested VSS information.\n   In the DHCPv6
    case, the appearance of the option in the Relay-reply\n   packet indicates that
    the DHCPv6 server understood and acted upon the\n   contents of the VSS option
    in the Relay-forward packet.  In the\n   DHCPv4 case, as discussed above, the
    appearance of the VSS sub-option\n   without the appearance of a VSS-Control sub-option
    indicates that the\n   DHCPv4 server successfully acted upon the VSS sub-option.\n
    \  This document does not create a requirement that a relay agent\n   remember
    the contents of a VSS DHCPv4 sub-option or VSS DHCPv6 option\n   sent to a DHCP
    server.  In many cases, the relay agent may simply use\n   the value of the VSS
    option or sub-option returned by the DHCP server\n   to forward the response to
    the DHCP client.  If the VSS information,\n   the IP address allocated, and the
    VPN capabilities of the relay agent\n   all interoperate correctly, then the DHCP
    client will receive a\n   working IP address.  Alternatively, if any of these
    items don't\n   interoperate with the others, the DHCP client will not receive
    a\n   working address.\n   Note that in some environments a relay agent may choose
    to always\n   place a VSS option or sub-option into packets and messages that
    it\n   forwards in order to forestall any attempt by a relay agent closer to\n
    \  the client or the client itself to specify VSS information.  In this\n   case,
    a Type field of 255 is used to denote the global, default VPN.\n   When the Type
    field of 255 is used, there MUST NOT be any additional\n   VSS information in
    the VSS option or sub-option.  In the DHCPv4 case,\n   an additional VSS-Control
    sub-option would be required, as discussed\n   above.\n"
  - contents:
    - "5.1.  VPN Assignment by the DHCP Server\n   In some cases, a DHCP server may
      use the VSS sub-option or option to\n   inform a relay agent that a particular
      DHCP client is associated with\n   a particular VPN.  It does this by sending
      the VSS sub-option or\n   option with the appropriate information to the relay
      agent in the\n   Relay Agent Information option for DHCPv4 or the Relay-reply
      message\n   in DHCPv6.  If the relay agent cannot respond correctly to the DHCP\n
      \  server's requirement to place the DHCP client into that VPN (perhaps\n   because
      it has not been configured with a VPN that matches the VSS\n   information received
      from the DHCP server), it MUST drop the packet\n   and not send it to the DHCP
      client.\n   In this situation, once the relay agent has placed the DHCP client\n
      \  into the VPN specified by the DHCP server, it will insert a VSS\n   option
      or sub-option when forwarding packets from the client.  The\n   DHCP server
      in normal operation will echo this VSS information into\n   the outgoing replies.\n
      \  In the event that the relay agent doesn't include VSS information on\n   subsequent
      requests after the DHCP server has included VSS\n   information in a reply to
      the relay agent, the DHCP server can\n   conclude that the relay agent doesn't
      support VSS processing, and the\n   DHCP server SHOULD stop processing this
      transaction and not respond\n   to the request.\n"
    title: 5.1.  VPN Assignment by the DHCP Server
  - contents:
    - "5.2.  DHCP Leasequery\n   A relay agent sometimes needs to submit a DHCP Leasequery
      [RFC4388]\n   [RFC5007] packet to the DHCP server in order to recover information\n
      \  about existing DHCP-allocated IP addresses on networks other than the\n   normal,
      global VPN.  In the context of a DHCP Leasequery, the relay\n   agent is a direct
      client of the DHCP server and is not relaying a\n   packet for another DHCP
      client.  Thus, the instructions in Section 6\n   (\"Client Behavior\") should
      be followed to include the necessary VSS\n   information.\n"
    title: 5.2.  DHCP Leasequery
  title: 5.  Relay Agent Behavior
- contents:
  - "6.  Client Behavior\n   Typically, DHCPv4 and DHCPv6 clients have no interaction
    with VSS\n   options or sub-options.  The VSS information is handled by exchanges\n
    \  between a DHCPv4 or DHCPv6 relay agent and the corresponding DHCPv4\n   or
    DHCPv6 server.\n   However, there are times when an entity is acting as a DHCPv4
    or\n   DHCPv6 client in that it is communicating directly with a DHCPv4 or\n   DHCPv6
    server.  In these instances -- where communication is\n   occurring without employing
    the DHCPv4 Relay Agent Information option\n   or the DHCPv6 Relay-forward or Relay-reply
    messages -- the entity is\n   acting as a DHCPv4 or DHCPv6 client with regard
    to its communication\n   with the DHCPv4 or DHCPv6 server, but not necessarily
    as a DHCP\n   client that is requesting a DHCPv4 or DHCPv6 address for its own
    use.\n   The client, in this context, may be requesting an IP address for\n   another
    entity, thus acting as a DHCP proxy.  The client may be\n   requesting information
    about another client-to-address binding, using\n   the DHCPv4 [RFC4388] or DHCPv6
    [RFC5007] leasequery protocol.\n   In the rest of this section, the term \"client\"
    refers to an entity\n   communicating VSS information directly to a DHCPv4 or
    DHCPv6 server\n   without using the DHCPv4 Relay Agent Information option or the
    DHCPv6\n   Relay-forward or Relay-reply messages, and there is no requirement\n
    \  that such a client be a traditional DHCPv4 or DHCPv6 client\n   requesting
    an IP address binding for itself.\n   DHCPv4 or DHCPv6 clients will employ the
    VSS option to communicate\n   VSS information to their respective servers.  This
    information MUST\n   be included in every message concerning any IP address on
    a different\n   VPN than the global or default VPN.  A DHCPv4 client will place
    the\n   DHCPv4 VSS option in its packets, and a DHCPv6 client will place the\n
    \  DHCPv6 VSS option in its messages.\n   A DHCPv6 client that needs to place
    a VSS option into a DHCPv6\n   message SHOULD place a single VSS option into the
    DHCPv6 message at\n   the same level as the Client Identifier option.  A DHCPv6
    client MUST\n   NOT include different VSS options in the same DHCPv6 message.\n
    \  Note that -- as mentioned in Section 1 -- throughout this document,\n   when
    a DHCPv6 address is indicated, the same information applies to\n   DHCPv6 prefix
    delegation [RFC3633] as well.\n   Since this option is placed in the packet in
    order to change the VPN\n   on which an IP address is allocated for a particular
    DHCP client, one\n   presumes that an allocation on that VPN is necessary for
    correct\n   operation.  Thus, a client that places this option in a packet and\n
    \  doesn't receive it or receives a different value in a returning\n   packet
    SHOULD drop the packet, since the IP address that was\n   allocated will not be
    in the requested VPN.\n   Clients should be aware that some DHCP servers will
    return a VSS\n   option with different values than the values sent by the client.
    \ In\n   addition, a client may receive a response from a DHCP server with a\n
    \  VSS option when none was sent by the client.\n   Note that when sending a DHCP
    Leasequery request, a relay agent is\n   acting as a DHCP client, and so it SHOULD
    include the respective\n   DHCPv4 or DHCPv6 VSS option in its DHCPv4 or DHCPv6
    Leasequery packet\n   if the DHCP Leasequery request is generated for other than
    the\n   default, global VPN.  It SHOULD NOT include a DHCPv4 sub-option in\n   this
    case.\n"
  title: 6.  Client Behavior
- contents:
  - "7.  Server Behavior\n   A DHCP server receiving the VSS option or sub-option
    SHOULD allocate\n   an IP address (or use the VSS information to access an already\n
    \  allocated IP address) from the VPN specified by the included VSS\n   information.\n
    \  In the case where the Type field of the VSS option or sub-option is\n   255,
    the VSS option denotes the global, default VPN.  In this case,\n   there is no
    explicit VSS information beyond the Type field.\n   This document does not prescribe
    any particular address allocation\n   policy.  A DHCP server may choose to attempt
    to allocate an address\n   using the VSS information and, if this is impossible,
    to not allocate\n   an address.  Alternatively, a DHCP server may choose to attempt\n
    \  address allocation based on the VSS information and, if that is not\n   possible,
    it may fall back to allocating an address on the global or\n   default VPN.  This,
    of course, is also the apparent behavior of any\n   DHCP server that doesn't implement
    support for the VSS option and\n   sub-option.  Thus, DHCP clients and relay agents
    SHOULD be prepared\n   for either of these alternatives.\n   In some cases, a
    DHCP server may use the VSS sub-option or option to\n   inform a relay agent that
    a particular DHCP client is associated with\n   a particular VPN.  It does this
    by sending the VSS sub-option or\n   option with the appropriate information to
    the relay agent in the\n   Relay Agent Information option for DHCPv4 or the Relay-reply
    message\n   in DHCPv6.\n   In this situation, the relay agent will place the client
    in the\n   proper VPN, and then it will insert a VSS option or sub-option in\n
    \  subsequent forwarded requests.  The DHCP server will see this VSS\n   information,
    and since it doesn't conflict in any way with the\n   server's notion of the VPN
    on which the client is supposed to reside,\n   it will process the requests based
    on the VPN specified in the VSS\n   option or sub-option, and echo the same VSS
    information in the\n   outgoing replies.\n   The relay agent receiving a reply
    containing a VSS option should\n   support the VSS option.  Otherwise, the relay
    agent will end up\n   attempting to use the address as though it were a global
    address.\n   Should this happen, the subsequent DHCPREQUEST will not contain any\n
    \  VSS information, in which case the DHCP server SHOULD NOT respond\n   with
    a DHCPACK.\n   If a server uses a different VPN than what was specified in the
    VSS\n   option or sub-option, it SHOULD send back the VPN information using\n
    \  the same type as the received type.  It MAY send back a different\n   type
    if it is not possible to use the same type (such as the RFC2685\n   VPN-ID if
    no ASCII VPN identifier exists).\n   A server that receives a VSS sub-option in
    the DHCPv4\n   Relay Agent Information option and does not receive a VSS-Control\n
    \  sub-option in the Relay Agent Information option MUST process the\n   information
    specified in the VSS sub-option in the same fashion as it\n   would have if it
    received both sub-options.\n"
  - contents:
    - "7.1.  Returning the DHCPv4 or DHCPv6 Option\n   DHCPv4 or DHCPv6 servers receiving
      a VSS option (for sub-option\n   processing, see below) MUST return an instance
      of this option in the\n   reply packet or message if the server successfully
      uses this option\n   to allocate an IP address, and it MUST NOT include an instance
      of\n   this option if the server is unable to support, is not configured to\n
      \  support, or does not implement support for VSS information in general\n   or
      the requested VPN in particular.\n   If they echo the option (based on the criteria
      above), servers SHOULD\n   return an exact copy of the option unless they desire
      to change the\n   VPN on which a client was configured.\n   The appearance of
      the DHCPv4 VSS option code in the DHCPv4 Parameter\n   Request List option [RFC2132]
      should not change the processing or\n   decision to return or not return the
      VSS option as specified in this\n   document.  The appearance of the DHCPv6
      VSS option in the OPTION_ORO\n   [RFC3315] or the OPTION_ERO [RFC4994] should
      not change the\n   processing or decision to return (or not to return) the VSS
      option as\n   specified in this document.\n"
    title: 7.1.  Returning the DHCPv4 or DHCPv6 Option
  - contents:
    - "7.2.  Returning the DHCPv4 Sub-Option\n   The case of the DHCPv4 sub-option
      is a bit more complicated.  Note\n   that [RFC3046] specifies that a DHCPv4
      server that supports the\n   Relay Agent Information option SHALL copy all sub-options
      received in\n   a Relay Agent Information option into any outgoing\n   Relay
      Agent Information option.  Thus, the default behavior for any\n   DHCPv4 server
      is to return any VSS sub-option received to the relay\n   agent whether or not
      the DHCPv4 server understands the VSS\n   sub-option.\n   In order to distinguish
      a DHCPv4 server that is simply copying\n   Relay Agent Information option sub-options
      from an incoming to an\n   outgoing Relay Agent Information option from a DHCPv4
      server that\n   successfully acted upon the information in the VSS sub-option,
      DHCPv4\n   relay agents MUST include a VSS-Control sub-option in the\n   Relay
      Agent Information any time that it includes a VSS sub-option in\n   the Relay
      Agent Information option.\n   A DHCPv4 server that does not support the VSS
      sub-option will copy\n   both sub-options into the outgoing Relay Agent Information
      option,\n   thus signaling to the DHCPv4 relay agent that it did not understand\n
      \  the VSS sub-option.\n   A DHCPv4 server that supports the VSS sub-option\n
      \  o  MUST copy the VSS sub-option into the outgoing\n      Relay Agent Information
      option\n   o  MUST NOT copy the VSS-Control sub-option into the outgoing\n      Relay
      Agent Information option\n   Moreover, if a server uses different VSS information
      to allocate an\n   IP address than it receives in a particular DHCPv4 sub-option,
      it\n   MUST include that alternative VSS information in the VSS sub-option\n
      \  that it returns to the DHCPv4 relay agent instead of the original VSS\n   information
      it was given.\n   If a DHCPv4 server supports this sub-option and for some reason\n
      \  (perhaps administrative control) does not honor this sub-option from\n   the
      request, then it MUST NOT echo either sub-option into the\n   outgoing Relay
      Agent Information option.\n"
    title: 7.2.  Returning the DHCPv4 Sub-Option
  - contents:
    - "7.3.  Making Sense of Conflicting VSS Information\n   It is possible for a
      DHCPv4 server to receive both a VSS option and\n   VSS sub-options in the same
      packet.  Likewise, a DHCPv6 server can\n   receive multiple VSS options in nested
      Relay-forward messages as well\n   as in the client message itself.  In either
      of these cases, the VSS\n   information from the relay agent closest to the
      DHCP server SHOULD be\n   used in preference to all other VSS information received.
      \ In the\n   DHCPv4 case, this means that the VSS sub-option takes precedence
      over\n   the VSS option, and in the DHCPv6 case, this means that the VSS\n   option
      from the outermost Relay-forward message in which a VSS option\n   appears takes
      precedence.\n   The reasoning behind this approach is that the relay agent closer
      to\n   the DHCP server is almost certainly more trusted than the DHCP client\n
      \  or more distant relay agents, and therefore information in the\n   Relay
      Agent Information option or the Relay-forward message is more\n   likely to
      be correct.\n   In general, relay agents SHOULD be aware through configuration
      or\n   policy external to this document whether or not they should be\n   including
      VSS information in packets that they forward, and so these\n   relay agents
      should not specify any conflicting VSS information.\n   In situations where
      multiple VSS options or sub-options appear in the\n   incoming packet or message,
      when the DHCP server constructs the\n   response to be sent to the DHCP client
      or relay agent, all existing\n   VSS options or sub-options MUST be replicated
      in the appropriate\n   places in the response and MUST contain only the VSS
      information that\n   was used by the DHCP server to allocate the IP address
      (with, of\n   course, the exception of a VSS-Control sub-option of a DHCPv4\n
      \  Relay Agent Information option).\n"
    title: 7.3.  Making Sense of Conflicting VSS Information
  title: 7.  Server Behavior
- contents:
  - "8.  Update to RFC 3046\n   This document updates the specification of the\n   Relay
    Agent Information option in Section 2.2 of RFC 3046, in the\n   first sentence
    of the second paragraph, as follows:\n   o  OLD:\n      DHCP servers claiming
    to support the Relay Agent Information\n      option SHALL echo the entire contents
    of the Relay Agent\n      Information option in all replies.\n   o  NEW:\n      DHCP
    servers claiming to support the Relay Agent Information\n      option SHALL echo
    the entire contents of the\n      Relay Agent Information option in all replies,
    except if otherwise\n      specified in the definition of specific Relay Agent
    Information\n      sub-options.\n"
  title: 8.  Update to RFC 3046
- contents:
  - "9.  Security Considerations\n   Message authentication in DHCPv4 for intradomain
    use where the out-\n   of-band exchange of a shared secret is feasible is defined
    in\n   [RFC3118].  Potential exposures to attack are discussed in Section 7\n
    \  of the DHCP protocol specification [RFC2131].\n   Implementations should consider
    using the DHCPv4 Authentication\n   option [RFC3118] to protect DHCPv4 client
    access in order to provide\n   a higher level of security if it is deemed necessary
    in their\n   environment.\n   Message authentication in DHCPv4 relay agents as
    defined in [RFC4030]\n   should be considered for DHCPv4 relay agents employing
    the\n   sub-options defined in this document.  Potential exposures to attack\n
    \  are discussed in Section 7 of the DHCP protocol specification\n   [RFC2131].\n
    \  For use of the VSS option by DHCPv6, the Security Considerations\n   section
    of [RFC3315] details the general threats to DHCPv6, and thus\n   to messages using
    the VSS option.  The \"Authentication of DHCP\n   Messages\" section of [RFC3315]
    describes securing communication\n   between relay agents and servers, as well
    as clients and servers.\n   The VSS option could be used by a client in order
    to obtain an IP\n   address from any VPN.  This option would allow a client to
    perform a\n   more complete address-pool exhaustion attack, since the client would\n
    \  no longer be restricted to attacking address pools on just its local\n   subnet.\n
    \  A DHCP server that implements these VSS options and the VSS\n   sub-option
    should be aware of this possibility and use whatever\n   techniques can be devised
    to prevent such an attack.  Information\n   such as the giaddr in DHCPv4 or link
    address in the Relay-forward\n   DHCPv6 message might be used to detect and prevent
    this sort of\n   attack.\n   One possible defense would be for the DHCP relay
    agent to insert a\n   VSS option or sub-option to override the DHCP client's VSS
    option.\n   Servers that implement the VSS option and sub-option MUST by default\n
    \  disable use of the feature; it must specifically be enabled through\n   configuration.
    \ Moreover, a server SHOULD provide the ability to\n   selectively enable use
    of the feature under restricted conditions,\n   e.g., by enabling use of the option
    only from explicitly configured\n   client-ids, enabling its use only by clients
    on a particular subnet,\n   or restricting the VSSs from which addresses may be
    requested.\n"
  title: 9.  Security Considerations
- contents:
  - "10.  IANA Considerations\n   IANA has assigned DHCPv4 option number 221 to the
    DHCPv4 Virtual\n   Subnet Selection option defined in Section 3.1, in accordance
    with\n   [RFC3942].\n   IANA has assigned sub-option number 151 to the DHCPv4
    Virtual Subnet\n   Selection sub-option defined in Section 3.2 from the DHCP Relay
    Agent\n   Sub-options space [RFC3046], in accordance with the spirit of\n   [RFC3942].
    \ While [RFC3942] doesn't explicitly mention the sub-option\n   space for the
    DHCP Relay Agent Information option [RFC3046],\n   sub-option 151 is already in
    use by existing implementations of this\n   sub-option, and this document is essentially
    upward-compatible with\n   these current implementations.\n   IANA has assigned
    the value of 152 to the DHCPv4 Virtual Subnet\n   Selection Control sub-option
    defined in Section 3.3.\n   IANA has assigned the value of 68 for the DHCPv6 Virtual
    Subnet\n   Selection option defined in Section 3.4 from the DHCP Option Codes\n
    \  registry.\n   The Type byte defined in Section 3.5 defines a number space for
    which\n   IANA has created and will maintain a new sub-registry entitled \"VSS\n
    \  Type Options\".  This sub-registry needs to be related to both the\n   DHCPv4
    and DHCPv6 VSS options and the DHCPv4 Relay Agent Information\n   option sub-option
    (all defined by this document), since the Type byte\n   in these two options and
    the VSS sub-option MUST have identical\n   definitions.\n   New values for the
    Type byte may only be defined by IETF Review, as\n   described in [RFC5226].  Basically,
    this means that they are defined\n   by RFCs approved by the IESG.\n"
  title: 10.  IANA Considerations
- contents:
  - "11.  Acknowledgments\n   Jay Kumarasamy contributed to earlier versions of this
    document.\n   Bernie Volz recommended consolidation of the DHCPv4 option and\n
    \  sub-option documents after extensive review of those former\n   documents,
    and provided valuable assistance in structuring and\n   reviewing this document.
    \ Alper Yegin expressed interest in the\n   DHCPv6 VSS option, resulting in this
    combined document covering all\n   three areas.  Alfred Hoenes provided assistance
    with editorial review\n   and also raised substantive protocol issues.  David
    Hankins and\n   Bernie Volz each raised important protocol issues that resulted
    in a\n   clarified document.  Josh Littlefield provided editorial assistance.\n
    \  Several IESG reviewers took the time to substantially review this\n   document,
    resulting in much-improved clarity.\n"
  title: 11.  Acknowledgments
- contents:
  - '12.  References

    '
  - contents:
    - "12.1.  Normative References\n   [RFC2119]   Bradner, S., \"Key words for use
      in RFCs to Indicate\n               Requirement Levels\", RFC 2119, March 1997.\n
      \  [RFC2131]   Droms, R., \"Dynamic Host Configuration Protocol\",\n               RFC
      2131, March 1997.\n   [RFC2132]   Alexander, S. and R. Droms, \"DHCP Options
      and BOOTP\n               Vendor Extensions\", RFC 2132, March 1997.\n   [RFC2685]
      \  Fox, B. and B. Gleeson, \"Virtual Private Networks\n               Identifier\",
      RFC 2685, September 1999.\n   [RFC3046]   Patrick, M., \"DHCP Relay Agent Information
      Option\",\n               RFC 3046, January 2001.\n   [RFC3315]   Droms, R.,
      Ed., Bound, J., Volz, B., Lemon, T., Perkins,\n               C., and M. Carney,
      \"Dynamic Host Configuration Protocol\n               for IPv6 (DHCPv6)\", RFC
      3315, July 2003.\n   [RFC3633]   Troan, O. and R. Droms, \"IPv6 Prefix Options
      for Dynamic\n               Host Configuration Protocol (DHCP) version 6\",
      RFC 3633,\n               December 2003.\n   [RFC4994]   Zeng, S., Volz, B.,
      Kinnear, K. and J. Brzozowski,\n               \"DHCPv6 Relay Agent Echo Request
      Option\", RFC 4994,\n               September 2007.\n"
    title: 12.1.  Normative References
  - contents:
    - "12.2.  Informative References\n   [RFC951]    Croft, W. and J. Gilmore, \"Bootstrap
      Protocol\", RFC 951,\n               September 1985.\n   [RFC1542]   Wimer,
      W., \"Clarifications and Extensions for the\n               Bootstrap Protocol\",
      RFC 1542, October 1993.\n   [RFC3118]   Droms, R., Ed., and W. Arbaugh, Ed.,
      \"Authentication for\n               DHCP Messages\", RFC 3118, June 2001.\n
      \  [RFC3942]   Volz, B., \"Reclassifying Dynamic Host Configuration\n               Protocol
      version 4 (DHCPv4) Options\", RFC 3942,\n               November 2004.\n   [RFC4030]
      \  Stapp, M. and T. Lemon, \"The Authentication Suboption for\n               the
      Dynamic Host Configuration Protocol (DHCP) Relay\n               Agent Option\",
      RFC 4030, March 2005.\n   [RFC4388]   Woundy, R. and K. Kinnear, \"Dynamic Host
      Configuration\n               Protocol (DHCP) Leasequery\", RFC 4388, February
      2006.\n   [RFC5007]   Brzozowski, J., Kinnear, K., Volz, B., and S. Zeng,\n
      \              \"DHCPv6 Leasequery\", RFC 5007, September 2007.\n   [RFC5198]
      \  Klensin, J. and M. Padlipsky, \"Unicode Format for Network\n               Interchange\",
      RFC 5198, March 2008.\n   [RFC5226]   Narten, T. and H. Alvestrand, \"Guidelines
      for Writing an\n               IANA Considerations Section in RFCs\", BCP 26,
      RFC 5226,\n               May 2008.\n"
    title: 12.2.  Informative References
  title: 12.  References
- contents:
  - "Authors' Addresses\n   Kim Kinnear\n   Cisco Systems\n   1414 Massachusetts Ave.\n
    \  Boxborough, MA  01719\n   Phone: (978) 936-0000\n   EMail: kkinnear@cisco.com\n
    \  Richard Johnson\n   Cisco Systems\n   170 W. Tasman Dr.\n   San Jose, CA  95134\n
    \  Phone: (408) 526-4000\n   EMail: raj@cisco.com\n   Mark Stapp\n   Cisco Systems\n
    \  1414 Massachusetts Ave.\n   Boxborough, MA  01719\n   Phone: (978) 936-0000\n
    \  EMail: mjs@cisco.com\n"
  title: Authors' Addresses
