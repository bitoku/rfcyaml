- title: __initial_text__
  contents:
  - '                 Real-time Inter-network Defense (RID)

    '
- title: Abstract
  contents:
  - "Abstract\n   Network security incidents, such as system compromises, worms,\n\
    \   viruses, phishing incidents, and denial of service, typically result\n   in\
    \ the loss of service, data, and resources both human and system.\n   Network\
    \ providers and Computer Security Incident Response Teams need\n   to be equipped\
    \ and ready to assist in communicating and tracing\n   security incidents with\
    \ tools and procedures in place before the\n   occurrence of an attack.  Real-time\
    \ Inter-network Defense (RID)\n   outlines a proactive inter-network communication\
    \ method to facilitate\n   sharing incident handling data while integrating existing\
    \ detection,\n   tracing, source identification, and mitigation mechanisms for\
    \ a\n   complete incident handling solution.  Combining these capabilities in\n\
    \   a communication system provides a way to achieve higher security\n   levels\
    \ on networks.  Policy guidelines for handling incidents are\n   recommended and\
    \ can be agreed upon by a consortium using the security\n   recommendations and\
    \ considerations.\n   RID has found use within the international research communities,\
    \ but\n   has not been widely adopted in other sectors.  This publication\n  \
    \ provides the specification to those communities that have adopted it,\n   and\
    \ communities currently considering solutions for real-time inter-\n   network\
    \ defense.  The specification may also accelerate development\n   of solutions\
    \ where different transports or message formats are\n   required by leveraging\
    \ the data elements and structures specified\n   here.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6045.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n\
    \      1.1. Normative and Informative ..................................6\n  \
    \    1.2. Terminology ................................................6\n    \
    \  1.3. Attack Types and RID Messaging .............................6\n   2. RID\
    \ Integration with Network Provider Technologies ..............8\n   3. Characteristics\
    \ of Attacks ......................................9\n      3.1. Integrating Trace\
    \ Approaches ..............................11\n      3.2. Superset of Packet Information\
    \ for Traces .................11\n   4. Communication between Network Providers\
    \ ........................12\n      4.1. Inter-Network Provider RID Messaging\
    \ ......................14\n      4.2. RID Network Topology ......................................16\n\
    \      4.3. Message Formats ...........................................17\n  \
    \         4.3.1. RID Data Types .....................................17\n    \
    \              4.3.1.1. Boolean ...................................17\n      \
    \     4.3.2. RID Messages and Transport .........................18\n        \
    \   4.3.3. IODEF-RID Schema ...................................19\n          \
    \        4.3.3.1. RequestStatus Class .......................21\n            \
    \      4.3.3.2. IncidentSource Class ......................23\n              \
    \    4.3.3.3. RIDPolicy Class ...........................24\n           4.3.4.\
    \ RID Namespace ......................................29\n      4.4. RID Messages\
    \ ..............................................29\n           4.4.1. TraceRequest\
    \ .......................................29\n           4.4.2. RequestAuthorization\
    \ ...............................30\n           4.4.3. Result .............................................31\n\
    \           4.4.4. Investigation Request ..............................33\n  \
    \         4.4.5. Report .............................................35\n    \
    \       4.4.6. IncidentQuery ......................................36\n      4.5.\
    \ RID Communication Exchanges ...............................37\n           4.5.1.\
    \ Upstream Trace Communication Flow ..................39\n                  4.5.1.1.\
    \ RID TraceRequest Example ..................40\n                  4.5.1.2. RequestAuthorization\
    \ Message Example ......44\n                  4.5.1.3. Result Message Example\
    \ ....................44\n           4.5.2. Investigation Request Communication\
    \ Flow ...........47\n                  4.5.2.1. Investigation Request Example\
    \ .............48\n                  4.5.2.2. RequestAuthorization Message Example\
    \ ......50\n           4.5.3. Report Communication ...............................51\n\
    \                  4.5.3.1. Report Example ............................51\n  \
    \         4.5.4. IncidentQuery Communication Flow ...................54\n    \
    \              4.5.4.1. IncidentQuery Example .....................54\n   5. RID\
    \ Schema Definition ..........................................55\n   6. Security\
    \ Considerations ........................................60\n      6.1. Message\
    \ Transport .........................................62\n      6.2. Message Delivery\
    \ Protocol - Integrity and Authentication ..63\n      6.3. Transport Communication\
    \ ...................................63\n      6.4. Authentication of RID Protocol\
    \ ............................64\n           6.4.1. Multi-Hop TraceRequest Authentication\
    \ ..............65\n      6.5. Consortiums and Public Key Infrastructures ................66\n\
    \      6.6. Privacy Concerns and System Use Guidelines ................67\n  \
    \ 7. IANA Considerations ............................................72\n   8.\
    \ Summary ........................................................72\n   9. References\
    \ .....................................................73\n      9.1. Normative\
    \ References ......................................73\n      9.2. Informative\
    \ References ....................................74\n   Acknowledgements ..................................................75\n\
    \   Sponsor Information ...............................................75\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Incident handling involves the detection, reporting, identification,\n\
    \   and mitigation of an attack, whether it be a system compromise,\n   socially\
    \ engineered phishing attack, or a denial-of-service (DoS)\n   attack.  When an\
    \ attack is detected, the response may include simply\n   filing a report, notification\
    \ to the source of the attack, a request\n   for mitigation, or the request to\
    \ locate the source.  One of the more\n   difficult cases is that in which the\
    \ source of an attack is unknown,\n   requiring the ability to trace the attack\
    \ traffic iteratively\n   upstream through the network for the possibility of\
    \ any further\n   actions to take place.  In cases when accurate records of an\
    \ active\n   session between the victim system and the attacker or source system\n\
    \   are available, the source is easy to identify.  The problem of\n   tracing\
    \ incidents becomes more difficult when the source is obscured\n   or spoofed,\
    \ logs are deleted, and the number of sources is\n   overwhelming.  If the source\
    \ of an attack is known or identified, it\n   may be desirable to request actions\
    \ be taken to stop or mitigate the\n   effects of the attack.\n   Current approaches\
    \ to mitigating the effects of security incidents\n   are aimed at identifying\
    \ and filtering or rate-limiting packets from\n   attackers who seek to hide the\
    \ origin of their attack by source\n   address spoofing from multiple locations.\
    \  Measures can be taken at\n   network provider (NP) edge routers providing ingress,\
    \ egress, and\n   broadcast filtering as a recommended best practice in [RFC2827].\n\
    \   Network providers have devised solutions, in-house or commercial, to\n   trace\
    \ attacks across their backbone infrastructure to either identify\n   the source\
    \ on their network or on the next upstream network in the\n   path to the source.\
    \  Techniques such as collecting packets as traffic\n   traverses the network\
    \ have been implemented to provide the capability\n   to trace attack traffic\
    \ after an incident has occurred.  Other\n   methods use packet-marking techniques\
    \ or flow-based traffic analysis\n   to trace traffic across the network in real\
    \ time.  The single-network\n   trace mechanisms use similar information across\
    \ the individual\n   networks to trace traffic.  Problems may arise when an attempt\
    \ is\n   made to have a trace continued through the next upstream network\n  \
    \ since the trace mechanism and management may vary.\n   In the case in which\
    \ the traffic traverses multiple networks, there\n   is currently no established\
    \ communication mechanism for continuing\n   the trace.  If the next upstream\
    \ network has been identified, a phone\n   call might be placed to contact the\
    \ network administrators in an\n   attempt to have them continue the trace.  A\
    \ communication mechanism\n   is needed to facilitate the transfer of information\
    \ to continue\n   traces accurately and efficiently to upstream networks.  The\n\
    \   communication mechanism described in this paper, Real-time Inter-\n   network\
    \ Defense (RID), takes into consideration the information\n   needed by various\
    \ single-network trace implementations and the\n   requirement for network providers\
    \ to decide if a TraceRequest should\n   be permitted to continue.  The data in\
    \ RID messages is represented in\n   an Extensible Markup Language (XML) [XML1.0]\
    \ document using the\n   Incident Object Description Exchange Format (IODEF) and\
    \ RID.  By\n   following this model, integration with other aspects of the network\n\
    \   for incident handling is simplified.  Finally, methods are\n   incorporated\
    \ into the communication system to indicate what actions\n   need to be taken\
    \ closest to the source in order to halt or mitigate\n   the effects of the attack\
    \ at hand.  RID is intended to provide a\n   method to communicate the relevant\
    \ information between Computer\n   Security Incident Response Teams (CSIRTs) while\
    \ being compatible with\n   a variety of existing and possible future detection\
    \ tracing and\n   response approaches.\n   At this point, RID has found use within\
    \ the international research\n   communities, but has not been widely adopted\
    \ in other sectors.  This\n   publication provides the specification to those\
    \ communities that have\n   adopted it, and communities currently considering\
    \ solutions for real-\n   time inter-network defense.  The specification may also\
    \ accelerate\n   development of solutions where different transports or message\n\
    \   formats are required by leveraging the data elements and structures\n   specified\
    \ here.\n   Security and privacy considerations are of high concern since\n  \
    \ potentially sensitive information may be passed through RID messages.\n   RID\
    \ messaging takes advantage of XML security and privacy policy\n   information\
    \ set in the RID schema.  The RID schema acts as an XML\n   envelope to support\
    \ the communication of IODEF documents for\n   exchanging or tracing information\
    \ regarding security incidents.  RID\n   messages are encapsulated for transport,\
    \ which is defined in a\n   separate document [RFC6046].  The authentication,\
    \ integrity, and\n   authorization features each layer has to offer are used to\
    \ achieve a\n   necessary level of security.\n"
- title: 1.1.  Normative and Informative
  contents:
  - "1.1.  Normative and Informative\n   The XML schema [XMLschema] and transport\
    \ requirements contained in\n   this document are normative; all other information\
    \ provided is\n   intended as informative.  More specifically, the following sections\n\
    \   of this document are intended as informative: Sections 1, 2, and 3;\n   and\
    \ the sub-sections of 4 including the introduction to 4, 4.1, and\n   4.2.  The\
    \ following sections of this document are normative: The\n   sub-sections of 4\
    \ including 4.3, 4.4, and 4.5; Section 5; and\n   Section 6.\n"
- title: 1.2.  Terminology
  contents:
  - "1.2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"\
    SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\"\
    , and \"OPTIONAL\" in this\n   document are to be interpreted as described in\
    \ [RFC2119].\n"
- title: 1.3.  Attack Types and RID Messaging
  contents:
  - "1.3.  Attack Types and RID Messaging\n   RID messaging is intended for use in\
    \ coordinating incident handling\n   to locate the source of an attack and stop\
    \ or mitigate the effects of\n   the attack.  The attack types include system\
    \ or network compromises,\n   denial-of-service attacks, or other malicious network\
    \ traffic.  RID\n   is essentially a messaging system coordinating attack detection,\n\
    \   tracing mechanisms, and the incident handling responses to locate the\n  \
    \ source of traffic.  If a source address is spoofed, a more detailed\n   trace\
    \ of a packet (RID TraceRequest) would be required to locate the\n   true source.\
    \  If the source address is valid, the incident handling\n   may only involve\
    \ the use of routing information to determine what\n   network provider is closest\
    \ to the source (RID Investigation request)\n   and can assist with the remediation.\
    \  The type of RID message used to\n   locate a source is determined by the validity\
    \ of the source address.\n   RID message types are discussed in Section 4.3.\n\
    \   DoS [DoS] attacks are characterized by large amounts of traffic\n   destined\
    \ for particular Internet locations and can originate from a\n   single or multiple\
    \ sources.  An attack from multiple sources is known\n   as a distributed denial-of-service\
    \ (DDoS) attack.  Because DDoS\n   attacks can originate from multiple sources,\
    \ tracing such an attack\n   can be extremely difficult or nearly impossible.\
    \  Many TraceRequests\n   may be required to accomplish the task and may require\
    \ the use of\n   dedicated network resources to communicate incident handling\n\
    \   information to prevent a DoS attack against the RID system and\n   network\
    \ used for tracing and remediation.  Provisions are suggested\n   to reduce the\
    \ load and prevent the same trace from occurring twice on\n   a single-network\
    \ backbone discussed in Section 4 on communication\n   between NPs.  The attacks\
    \ can be launched from systems across the\n   Internet unified in their efforts\
    \ or by compromised systems enlisted\n   as \"zombies\" that are controlled by\
    \ servers, thereby providing\n   anonymity to the controlling server of the attack.\
    \  This scenario may\n   require multiple RID traces, one to locate the zombies\
    \ and an\n   additional one to locate the controlling server.  DDoS attacks do\
    \ not\n   necessarily spoof the source of an attack since there are a large\n\
    \   number of source addresses, which make it difficult to trace anyway.\n   DDoS\
    \ attacks can also originate from a single system or a subset of\n   systems that\
    \ spoof the source address in packet headers in order to\n   mask the identity\
    \ of the attack source.  In this case, an iterative\n   trace through the upstream\
    \ networks in the path of the attack traffic\n   may be required.\n   RID traces\
    \ may also be used to locate a system used in an attack to\n   compromise another\
    \ system.  Compromising a system can be accomplished\n   through one of many attack\
    \ vectors, using various techniques from a\n   remote host or through local privilege\
    \ escalation attempts.  The\n   attack may exploit a system or application level\
    \ vulnerability that\n   may be the result of a design flaw or a configuration\
    \ issue.  A\n   compromised system, as described above, can be used to later attack\n\
    \   other systems.  A single RID Investigation request may be used in\n   this\
    \ case since it is probable that the source address is valid.\n   Identifying\
    \ the sources of system compromises may be difficult since\n   an attacker may\
    \ access the compromised system from various sources.\n   The attacker may also\
    \ take measures to hide their tracks by deleting\n   log files or by accessing\
    \ the system through a series of compromised\n   hosts.  Iterative RID traces\
    \ may be required for each of the\n   compromised systems used to obscure the\
    \ source of the attack.  If the\n   source address is valid, an Investigation\
    \ request may be used in lieu\n   of a full RID TraceRequest.\n   Once an attack\
    \ has been reported, CSIRTs may want to query other\n   CSIRTs if they have detected\
    \ an attack or simply report that one has\n   taken place.  The Report message\
    \ can be used to file a report without\n   an action taken, and an IncidentQuery\
    \ can be used to ask if an attack\n   has been seen by another CSIRT.\n   System\
    \ compromises may result from other security incident types such\n   as worms,\
    \ Trojans, or viruses.  It is often the case that an incident\n   goes unreported\
    \ even if valid source address information is available\n   because it is difficult\
    \ to take any action to mitigate or stop the\n   attack.  Incident handling is\
    \ a difficult task for an NP and even at\n   some client locations due to network\
    \ size and resource limitations.\n"
- title: 2.  RID Integration with Network Provider Technologies
  contents:
  - "2.  RID Integration with Network Provider Technologies\n   For the purpose of\
    \ this document, a network provider (NP) shall be\n   defined as a backbone infrastructure\
    \ manager of a network.  The\n   network provider's Computer Security Incident\
    \ Response Team shall be\n   referred to as the CSIRT.  The backbone may be that\
    \ of an\n   organization providing network (Internet or private) access to\n \
    \  commercial, personal, government, or educational institutions, or the\n   backbone\
    \ provider of the connected network.  The connected network\n   provider is an\
    \ extension meant to include Intranet and Extranet\n   providers as well as instances\
    \ such as a business or educational\n   institute's private network.\n   NPs typically\
    \ manage and monitor their networks through a centralized\n   network management\
    \ system (NMS).  The acronym \"NMS\" will be used to\n   generically represent\
    \ management systems on a network used for the\n   management of network resources.\
    \  An incident handling system (IHS)\n   is used to communicate RID messages and\
    \ may be integrated with an NMS\n   as well as other components of the network.\
    \  The components of the\n   network that may be integrated through the RID messaging\
    \ system\n   include attack or event detection, network tracing, and network\n\
    \   devices to stop the effects of an attack.\n   The detection of security incidents\
    \ may rely on manual reporting,\n   automated intrusion detection tools, and variations\
    \ in traffic types\n   or levels on a network.  Intrusion detection systems (IDSs)\
    \ may be\n   integrated into the IHS to create IODEF documents or RID messages\
    \ to\n   facilitate security incident handling.  Detection of a security\n   incident\
    \ is outside the scope of this paper; however, it should be\n   possible to integrate\
    \ detection methods with RID messaging.\n   RID messaging in an IHS is intended\
    \ to be flexible in order to\n   accommodate various traceback systems currently\
    \ in use as well as\n   those that may evolve with technology.  RID is intended\
    \ to\n   communicate the necessary information needed by a trace mechanism to\n\
    \   the next upstream NP in the path of a trace.  Therefore, a RID\n   message\
    \ must carry the superset of data required for all tracing\n   systems.  If possible,\
    \ the trace may need to inspect packets to\n   determine a pattern, which could\
    \ assist reverse path identification.\n   This may be accomplished by inspecting\
    \ packet header information such\n   as the source and destination IP addresses,\
    \ ports, and protocol flags\n   to determine if there is a way to distinguish\
    \ the packets being\n   traced from other packets.  A description of the incident\
    \ along with\n   any available automated trace data should trigger an alert to\
    \ the\n   NP's CSIRT for further investigation.  The various technologies used\n\
    \   to trace traffic across a network are described in Section 3.1.\n   Another\
    \ area of integration is the ability to mitigate or stop attack\n   traffic once\
    \ a source has been located.  Any automated solution\n   should consider the possible\
    \ side effects to the network.  A change\n   control process or a central point\
    \ for configuration management might\n   be used to ensure that the security of\
    \ the network and necessary\n   functionality are maintained and that equipment\
    \ configuration changes\n   are documented.  Automated solutions may depend upon\
    \ the capabilities\n   and current configuration management solutions on a particular\n\
    \   network.  The solutions may be based on HTTP/TLS (Transport Layer\n   Security)\
    \ or an appropriate protocol defined in the transport\n   specification.\n"
- title: 3.  Characteristics of Attacks
  contents:
  - "3.  Characteristics of Attacks\n   The goal of tracing a security incident may\
    \ be to identify the source\n   or to find a point on the network as close to\
    \ the origin of the\n   incident as possible.  A security incident may be defined\
    \ as a system\n   compromise, a worm or Trojan infection, or a single- or multiple-\n\
    \   source denial-of-service attack.  Incident tracing can be used to\n   identify\
    \ the source(s) of an attack in order to halt or mitigate the\n   undesired behavior.\
    \  The communication system, RID, described in this\n   paper can be used to trace\
    \ any type of security incident and allows\n   for actions to be taken when the\
    \ source of the attack or a point\n   closer to the source is known or has been\
    \ identified.  The purpose of\n   tracing an attack would be to halt or mitigate\
    \ the effects of the\n   attack through methods such as filtering or rate-limiting\
    \ the traffic\n   close to the source or by using methods such as taking the host\
    \ or\n   network offline.  Care must also be taken to ensure that the system\n\
    \   is not abused and to use proper analysis in determining if attack\n   traffic\
    \ is, in fact, attack traffic at each NP along the path of a\n   trace.\n   Tracing\
    \ security incidents can be a difficult task since attackers go\n   to great lengths\
    \ to obscure their identity.  In the case of a\n   security incident, the true\
    \ source might be identified through an\n   existing established connection to\
    \ the attacker's point of origin.\n   However, the attacker may not connect to\
    \ the compromised system for a\n   long period of time after the initial compromise\
    \ or may access the\n   system through a series of compromised hosts spread across\
    \ the\n   network.  Other methods of obscuring the source may include targeting\n\
    \   the host with the same attack from multiple sources using both valid\n   and\
    \ spoofed source addresses.  This tactic can be used to compromise\n   a machine\
    \ and leave the difficult task of locating the true origin\n   for the administrators.\
    \  Security incidents, including DDoS attacks,\n   can be difficult or nearly\
    \ impossible to trace because of the nature\n   of the attack.  Some of the difficulties\
    \ in tracing attacks include\n   the following:\n   o  the attack originates from\
    \ multiple sources;\n   o  the attack may include various types of traffic meant\
    \ to consume\n      server resources, such as a SYN flood attack without a significant\n\
    \      increase in bandwidth utilization;\n   o  the type of traffic could include\
    \ valid destination services,\n      which cannot be blocked since they are essential\
    \ services to\n      business, such as DNS servers at an NP or HTTP requests sent\
    \ to an\n      organization connected to the Internet;\n   o  the attack may utilize\
    \ varying types of packets including TCP,\n      UDP, ICMP, or other IP protocols;\n\
    \   o  the attack may be from \"zombies\", which then require additional\n   \
    \   searches to locate a controlling server as the true origin of the\n      attack;\n\
    \   o  the attack may use a very small number of packets from any\n      particular\
    \ source, thus making a trace after the fact nearly\n      impossible.\n   If\
    \ the source(s) of the attack cannot be determined from IP address\n   information\
    \ or tracing the increased bandwidth utilization, it may be\n   possible to trace\
    \ the traffic based on the type of packets seen by\n   the client.  In the case\
    \ of packets with spoofed source addresses, it\n   is no longer a trivial task\
    \ to identify the source of an attack.  In\n   the case of an attack using valid\
    \ source addresses, methods such as\n   the traceroute utility can be used to\
    \ fairly accurately identify the\n   path of the traffic between the source and\
    \ destination of an attack.\n   If the true source has been identified, actions\
    \ should be taken to\n   halt or mitigate the effects of the attack by reporting\
    \ the incident\n   to the NP or the upstream NP closest to the source.  In the\
    \ case of a\n   spoofed source address, other methods can be used to trace back\
    \ to\n   the source of an attack.  The methods include packet filtering,\n   packet\
    \ hash comparisons, IP marking techniques, ICMP traceback, and\n   packet flow\
    \ analysis.  As in the case of attack detection, tracing\n   traffic across a\
    \ single network is a function that can be used with\n   RID in order to provide\
    \ the network with the ability to trace spoofed\n   traffic to the source, while\
    \ RID provides all the necessary\n   information to accommodate the approach used\
    \ on any single network to\n   accomplish this task.  RID can also be used to\
    \ report attack traffic\n   close to the source where the IP address used was\
    \ determined to be\n   valid or simply to report that an incident occurred.\n"
- title: 3.1.  Integrating Trace Approaches
  contents:
  - "3.1.  Integrating Trace Approaches\n   There have been many separate research\
    \ initiatives to solve the\n   problem of tracing upstream packets to detect the\
    \ true source of\n   attack traffic.  Upstream packet tracing is currently confined\
    \ to the\n   borders of a network or an NP's network.  Traces require access to\n\
    \   network equipment and resources, thus potentially limiting a trace to\n  \
    \ a specific network.  Once a trace reaches the boundaries of a\n   network, the\
    \ network manager or NP adjacent in the upstream trace\n   must be contacted in\
    \ order to continue the trace.  NPs have been\n   working on individual solutions\
    \ to accomplish upstream tracing within\n   their own network environments.  The\
    \ tracing mechanisms implemented\n   thus far have included proprietary or custom\
    \ solutions requiring\n   specific information such as IP packet header data,\
    \ hash values of\n   the attack packets, or marked packets.  Hash values are used\
    \ to\n   compare a packet against a database of packets that have passed\n   through\
    \ the network as described in \"Hash-Based IP Traceback\"\n   [HASH-IPtrace].\
    \  Other research solutions involve marking packets as\n   explained in \"ICMP\
    \ Traceback Messages\" [ICMPtrace], \"Practical\n   network support for IP traceback\"\
    \ [NTWK-IPtrace], the IP Flow\n   Information eXport (IPFIX) protocol [RFC3917],\
    \ and IP marking\n   [IPtrace].  The single-network traceback solutions were considered\
    \ in\n   developing RID to determine the information needed to accomplish an\n\
    \   inter-network trace where different solutions may be in place.\n"
- title: 3.2.  Superset of Packet Information for Traces
  contents:
  - "3.2.  Superset of Packet Information for Traces\n   In order for network traffic\
    \ to be traced across a network, an\n   example packet from the attack must be\
    \ sent along with the\n   TraceRequest or Investigation request.  According to\
    \ the research for\n   hash-based IP traceback, all of the non-changing fields\
    \ of an IP\n   header along with 8 bytes of payload are required to provide enough\n\
    \   information to uniquely trace the path of a packet.  The non-changing\n  \
    \ fields of the packet header and the 8 bytes of payload are the\n   superset\
    \ of data required by most single-network tracing systems\n   used; limiting the\
    \ shared data to the superset of the packet header\n   and 8 bytes of payload\
    \ prevents the need for sharing potentially\n   sensitive information that may\
    \ be contained in the data portion of a\n   packet.\n   The RecordItem class in\
    \ the IODEF is used to store a hexadecimal\n   formatted packet including all\
    \ packet header information plus 8 bytes\n   of payload, or the entire packet\
    \ contents.  The above trace systems\n   do not require a full packet, but it\
    \ may be useful in some cases, so\n   the option is given to allow a full packet\
    \ to be included in the data\n   model.\n   If a subset of a packet is used, the\
    \ research presented in \"Hash-\n   Based IP Traceback\" [HASH-IPtrace] provides\
    \ guidelines to establish a\n   minimum requirement for distinguishing packets.\
    \  The full packet and\n   content SHOULD be provided, but the minimum requirement\
    \ MUST be\n   provided.  The research from [HASH-IPtrace] found that the first\
    \ 28\n   invariant bytes of a packet (masked IP header plus the first 8 bytes\n\
    \   of the payload) are sufficient to differentiate almost all non-\n   identical\
    \ IPv4 packets.  RID requires the first 28 invariant bytes of\n   an IPv4 packet\
    \ in order to perform a trace.  RID requires the first\n   48 invariant bytes\
    \ for an IPv6 packet in order to distinguish the\n   packet in a trace.  Reference\
    \ [HASH-IPtrace] for additional details.\n   The input mechanism for packets to\
    \ be traced should be flexible to\n   allow intrusion detection systems or packet\
    \ sniffers to provide the\n   information.  The system creating the RID message\
    \ should also use the\n   packet information to populate the Incident class information\
    \ in\n   order to avoid human error and also allow a system administrator to\n\
    \   override the automatically populated information.\n"
- title: 4.  Communication between Network Providers
  contents:
  - "4.  Communication between Network Providers\n   Note: The Introduction, and Sub-sections\
    \ 4.1 and 4.2, are\n   informative, with the exception of references to IODEF/RID\
    \ Transport\n   [RFC6046].  Sub-sections 4.3, 4.4, and 4.5 are normative.\n  \
    \ Expediting the communication between CSIRTs is essential when\n   responding\
    \ to a security-related incident, which may cross network\n   access points (Internet\
    \ backbones) between providers.  As a result of\n   the urgency involved in this\
    \ inter-NP security incident\n   communication, there must be an effective system\
    \ in place to\n   facilitate the interaction.  This communication policy or system\n\
    \   should involve multiple means of communication to avoid a single\n   point\
    \ of failure.  Email is one way to transfer information about the\n   incident,\
    \ packet traces, etc.  However, email may not be received in\n   a timely fashion\
    \ or be acted upon with the same urgency as a phone\n   call or other communication\
    \ mechanism.\n   Each NP should dedicate a phone number to reach a member of their\n\
    \   respective CSIRT.  The phone number could be dedicated to inter-NP\n   incident\
    \ communications and must be a hotline that provides a 24x7\n   live response.\
    \  The phone line should reach someone who would have\n   the authority, expertise,\
    \ and the means to expedite the necessary\n   action to investigate the incident.\
    \  This may be a difficult policy\n   to establish at smaller NPs due to resource\
    \ limitations, so another\n   solution may be necessary.  An outside group may\
    \ be able to serve\n   this function if given the necessary access to the NP's\
    \ network.  The\n   outside resource should be able to mitigate or alleviate the\n\
    \   financial limitations and any lack of experienced resource personnel.\n  \
    \ A technical solution to trace traffic across a single NP may include\n   homegrown\
    \ or commercial systems for which RID messaging must\n   accommodate the input\
    \ requirements.  The IHS used on the NP's\n   backbone by the CSIRT to coordinate\
    \ the trace across the single\n   network requires a method to accept and process\
    \ RID messages and\n   relay TraceRequests to the system, as well as to wait for\
    \ responses\n   from the system to continue the RID request process as appropriate.\n\
    \   In this scenario, each NP would maintain its own RID/IHS and\n   integrate\
    \ with a management station used for network monitoring and\n   analysis.  An\
    \ alternative for NPs lacking sufficient resources may be\n   to have a neutral\
    \ third party with access to the NP's network\n   resources who could be used\
    \ to perform the incident handling\n   functions.  This could be a function of\
    \ a central organization\n   operating as a CSIRT for the Internet as a whole\
    \ or within a\n   consortium that may be able to provide centralized resources.\n\
    \   Consortiums would consist of a group of NPs and/or CSIRTs that agree\n   to\
    \ participate in the RID communication protocol with an agreed-upon\n   policy\
    \ and communication protocol facilitating the secure transport\n   of IODEF/RID\
    \ XML documents.  Transport for RID messages is specified\n   in the IODEF/RID\
    \ Transport [RFC6046] document.\n   One goal of RID is to prevent the need to\
    \ permit access to other\n   networks' equipment through the use of a standard\
    \ messaging mechanism\n   to enable IHSs to communicate incident handling information\
    \ to other\n   networks in a consortium or in neighboring networks.  The third\
    \ party\n   mentioned above may be used in this technical solution to assist in\n\
    \   facilitating incident handling and possibly traceback through smaller\n  \
    \ NPs.  The RID messaging mechanism may be a logical or physical out-\n   of-band\
    \ network to ensure that the communication is secure and\n   unaffected by the\
    \ state of the network under attack.  The two\n   management methods would accommodate\
    \ the needs of larger NPs to\n   maintain full management of their network, and\
    \ the third-party option\n   could be available to smaller NPs who lack the necessary\
    \ human\n   resources to perform incident handling operations.  The first method\n\
    \   enables the individual NPs to involve their network operations staff\n   to\
    \ authorize the continuance of a trace or other necessary response\n   to a RID\
    \ communication request through their network via a\n   notification and alerting\
    \ system.  The out-of-band logical solution\n   for messaging may be permanent\
    \ virtual circuits configured with a\n   small amount of bandwidth dedicated to\
    \ RID communications between\n   NPs.\n   The network used for the communication\
    \ should consist of out-of-band\n   or protected channels (direct communication\
    \ links) or encrypted\n   channels dedicated to the transport of RID messages.\
    \  The\n   communication links would be direct connections between network peers\n\
    \   who have agreed-upon use and abuse policies through the use of a\n   consortium.\
    \  Consortiums might be linked through policy comparisons\n   and additional agreements\
    \ to form a larger web or iterative network\n   of peers that correlates to the\
    \ traffic paths available over the\n   larger web of networks.  The maintenance\
    \ of the individual links is\n   the responsibility of the two network peers hosting\
    \ the link.\n   Contact information, IP addresses of RID systems, and other\n\
    \   information must be coordinated between bilateral peers by a\n   consortium\
    \ and may use existing databases, such as the Routing\n   Arbiter.  The security,\
    \ configuration, and Confidence rating schemes\n   of the RID messaging peers\
    \ must be negotiated by peers and must meet\n   certain overall requirements of\
    \ the fully connected network\n   (Internet, government, education, etc.) through\
    \ the peering and/or a\n   consortium-based agreement.\n   RID messaging established\
    \ with clients of an NP may be negotiated in\n   a contract as part of a value-added\
    \ service or through a service\n   level agreement (SLA).  Further discussion\
    \ is beyond the scope of\n   this document and may be more appropriately handled\
    \ in network\n   peering or service level agreements.\n   Procedures for incident\
    \ handling need to be established and well\n   known by anyone that may be involved\
    \ in incident response.  The\n   procedures should also contain contact information\
    \ for internal\n   escalation procedures, as well as for external assistance groups\
    \ such\n   as a CSIRT, CERT Coordination Center (CERT/CC), Global Information\n\
    \   Assurance Certification (GIAC), and the FBI or other assisting\n   government\
    \ organization in the country of the investigation.\n"
- title: 4.1.  Inter-Network Provider RID Messaging
  contents:
  - "4.1.  Inter-Network Provider RID Messaging\n   In order to implement a messaging\
    \ mechanism between RID communication\n   systems or IHSs, a standard protocol\
    \ and format is required to ensure\n   inter-operability between vendors.  The\
    \ messages would have to meet\n   several requirements in order to be meaningful\
    \ as they traverse\n   multiple networks.  RID provides the framework necessary\
    \ for\n   communication between networks involved in the incident handling,\n\
    \   possible traceback, and mitigation of a security incident.  Several\n   message\
    \ types described in Section 4.3 are necessary to facilitate\n   the handling\
    \ of a security incident.  The message types include the\n   Report, IncidentQuery,\
    \ TraceRequest, RequestAuthorization, Result,\n   and the Investigation request\
    \ message.  The Report message is used\n   when an incident is to be filed on\
    \ a RID system or associated\n   database, where no further action is required.\
    \  An IncidentQuery\n   message is used to request information on a particular\
    \ incident.  A\n   TraceRequest message is used when the source of the traffic\
    \ may have\n   been spoofed.  In that case, each network provider in the upstream\n\
    \   path who receives a TraceRequest will issue a trace across the\n   network\
    \ to determine the upstream source of the traffic.  The\n   RequestAuthorization\
    \ and Result messages are used to communicate the\n   status and result of a TraceRequest\
    \ or Investigation request.  The\n   Investigation request message would only\
    \ involve the RID\n   communication systems along the path to the source of the\
    \ traffic and\n   not the use of network trace systems.  The Investigation request\n\
    \   leverages the bilateral relationships or a consortium's\n   interconnections\
    \ to mitigate or stop problematic traffic close to the\n   source.  Routes could\
    \ determine the fastest path to a known source IP\n   address in the case of an\
    \ Investigation request.  A message sent\n   between RID systems for a TraceRequest\
    \ or an Investigation request to\n   stop traffic at the source through a bordering\
    \ network would require\n   the information enumerated below:\n   1. Enough information\
    \ to enable the network administrators to make a\n      decision about the importance\
    \ of continuing the trace.\n   2. The incident or IP packet information needed\
    \ to carry out the\n      trace or investigation.\n   3. Contact information of\
    \ the origin of the RID communication.  The\n      contact information could be\
    \ provided through the Autonomous\n      System Number (ASN) [RFC1930] or Network\
    \ Information Center (NIC)\n      handle information listed in the Registry for\
    \ Internet Numbers or\n      other Internet databases.\n   4. Network path information\
    \ to help prevent any routing loops through\n      the network from perpetuating\
    \ a trace.  If a RID system receives a\n      TraceRequest containing its own\
    \ information in the path, the trace\n      must cease and the RID system should\
    \ generate an alert to inform\n      the network operations staff that a tracing\
    \ loop exists.\n   5. A unique identifier for a single attack.  This identifier\
    \ should\n      be used to correlate traces to multiple sources in a DDoS attack.\n\
    \   Use of the communication network and the RID protocol must be for\n   pre-approved,\
    \ authorized purposes only.  It is the responsibility of\n   each participating\
    \ party to adhere to guidelines set forth in both a\n   global use policy for\
    \ this system and one established through the\n   peering agreements for each\
    \ bilateral peer or agreed-upon consortium\n   guidelines.  The purpose of such\
    \ policies is to avoid abuse of the\n   system; the policies shall be developed\
    \ by a consortium of\n   participating entities.  The global policy may be dependent\
    \ on the\n   domain it operates under; for example, a government network or a\n\
    \   commercial network such as the Internet would adhere to different\n   guidelines\
    \ to address the individual concerns.  Privacy issues must\n   be considered in\
    \ public networks such as the Internet.  Privacy\n   issues are discussed in the\
    \ Security Considerations section, along\n   with other requirements that must\
    \ be agreed upon by participating\n   entities.\n   RID requests must be legitimate\
    \ security-related incidents and not\n   used for purposes such as sabotage or\
    \ censorship.  An example of such\n   abuse of the system would include a request\
    \ to rate-limit legitimate\n   traffic to prevent information from being shared\
    \ between users on the\n   Internet (restricting access to online versions of\
    \ papers) or\n   restricting access from a competitor's product in order to sabotage\
    \ a\n   business.\n   The RID system should be configurable to either require\
    \ user input or\n   automatically continue traces.  This feature would enable\
    \ a network\n   manager to assess the available resources before continuing a\
    \ trace.\n   A trace initiated from a TraceRequest may cause adverse effects on\
    \ a\n   network.  If the Confidence rating is low, it may not be in the NP's\n\
    \   best interest to continue the trace.  The Confidence ratings must\n   adhere\
    \ to the specifications for selecting the percentage used to\n   avoid abuse of\
    \ the system.  TraceRequests must be issued by\n   authorized individuals from\
    \ the initiating network, set forth in\n   policy guidelines established through\
    \ peering or SLA.\n"
- title: 4.2.  RID Network Topology
  contents:
  - "4.2.  RID Network Topology\n   The most basic topology for communicating RID\
    \ systems would be a\n   direct connection or a bilateral relationship as illustrated\
    \ below.\n         ___________                                  __________\n \
    \        |         |                                  |        |\n         | \
    \ RID    |__________-------------___________|  RID   |\n         |_________| \
    \         | NP Border |           |________|\n                              -------------\n\
    \                      Figure 1.  Direct Peer Topology\n   Within the consortium\
    \ model, several topologies might be agreed upon\n   and used.  One would leverage\
    \ bilateral network peering relationships\n   of the members of the consortium.\
    \  The peers for RID would match that\n   of routing peers, and the logical network\
    \ borders would be used.\n   This approach may be necessary for an iterative trace\
    \ where the\n   source is unknown.  The model would look like the above diagram;\n\
    \   however, there may be an extensive number of interconnections of\n   bilateral\
    \ relationships formed.  Also within a consortium model, it\n   may be useful\
    \ to establish an integrated mesh of networks to pass RID\n   messages.  This\
    \ may be beneficial when the source address is known,\n   and an interconnection\
    \ may provide a faster route to reach the\n   closest upstream peer to the source\
    \ of the attack traffic.  An\n   example is illustrated below.\n     _______ \
    \                    _______                     _______\n     |     |       \
    \              |     |                     |     |\n   __| RID |____-------------____|\
    \ RID |____-------------____| RID |__\n     |_____|    | NP Border |    |_____|\
    \    | NP Border |    |_____|\n        |       -------------               -------------\
    \       |\n        |_______________________________________________________|\n\
    \    Direct connection to network that is not an immediate network peer\n    \
    \                   Figure 2.  Mesh Peer Topology\n   By using a fully meshed\
    \ model in a consortium, broadcasting RID\n   requests would be possible, but\
    \ not advisable.  By broadcasting a\n   request, RID peers that may not have carried\
    \ the attack traffic on\n   their network would be asked to perform a trace for\
    \ the potential of\n   decreasing the time in which the true source was identified.\
    \  As a\n   result, many networks would have utilized unnecessary resources for\
    \ a\n   TraceRequest that may have also been unnecessary.\n"
- title: 4.3.  Message Formats
  contents:
  - "4.3.  Message Formats\n   Section 4.3.2 describes the six RID message types,\
    \ which are based on\n   the IODEF model [RFC5070].  The messages are generated\
    \ and received\n   on RID communication systems on the NP's network.  The messages\
    \ may\n   originate from IODEF messages from intrusion detection servers,\n  \
    \ CSIRTs, analysts, etc.  A RID message uses the IODEF framework with\n   the\
    \ RID extension, which is encapsulated for transport [RFC6046].\n   Each RID message\
    \ type, along with an example, is described in the\n   following sections.  The\
    \ IODEF-RID schema is introduced in\n   Section 4.3.3 to support the RID message\
    \ types in Section 4.3.2.\n"
- title: 4.3.1.  RID Data Types
  contents:
  - "4.3.1.  RID Data Types\n   RID is derived from the IODEF data model and inherits\
    \ all of the data\n   types defined in the IODEF model.  One data type is added\
    \ by RID:\n   BOOLEAN.\n"
- title: 4.3.1.1.  Boolean
  contents:
  - "4.3.1.1.  Boolean\n   A boolean value is represented by the BOOLEAN data type.\n\
    \   The BOOLEAN data type is implemented as \"xs:boolean\" [XMLschema] in\n  \
    \ the schema.\n"
- title: 4.3.2.  RID Messages and Transport
  contents:
  - "4.3.2.  RID Messages and Transport\n   The six RID message types follow:\n  \
    \ 1. TraceRequest.  This message is sent to the RID system next in the\n     \
    \ upstream trace.  It is used to initiate a TraceRequest or to\n      continue\
    \ a TraceRequest to an upstream network closer to the\n      source address of\
    \ the origin of the security incident.  The\n      TraceRequest would trigger\
    \ a traceback on the network to locate\n      the source of the attack traffic.\n\
    \   2. RequestAuthorization.  This message is sent to the initiating RID\n   \
    \   system from each of the upstream NPs' RID systems to provide\n      information\
    \ on the request status in the current network.\n   3. Result.  This message is\
    \ sent to the initiating RID system through\n      the network of RID systems\
    \ in the path of the trace as\n      notification that the source of the attack\
    \ was located.  The\n      Result message is also used to provide the notification\
    \ of actions\n      taken for an Investigation request.\n   4. Investigation.\
    \  This message type is used when the source of the\n      traffic is believed\
    \ not to be spoofed.  The purpose of the\n      Investigation request message\
    \ is to leverage the existing peer\n      relationships in order to notify the\
    \ network provider closest to\n      the source of the valid traffic of a security-related\
    \ incident for\n      any necessary actions to be taken.\n   5. Report.  This\
    \ message is used to report a security incident, for\n      which no action is\
    \ requested.  This may be used for the purpose of\n      correlating attack information\
    \ by CSIRTs, statistics and trending\n      information, etc.\n   6. IncidentQuery.\
    \  This message is used to request information about\n      an incident or incident\
    \ type from a trusted RID system.  The\n      response is provided through the\
    \ Report message.\n   When a system receives a RID message, it must be able to\
    \ determine\n   the type of message and parse it accordingly.  The message type\
    \ is\n   specified in the RIDPolicy class.  The RIDPolicy class may also be\n\
    \   used by the transport protocol to facilitate the communication of\n   security\
    \ incident data to trace, investigate, query, or report\n   information regarding\
    \ security incidents.\n"
- title: 4.3.3.  IODEF-RID Schema
  contents:
  - "4.3.3.  IODEF-RID Schema\n   There are three classes included in the RID extension\
    \ required to\n   facilitate RID communications.  The RequestStatus class is used\
    \ to\n   indicate the approval status of a TraceRequest or Investigation\n   request;\
    \ the IncidentSource class is used to report whether or not a\n   source was found\
    \ and to identify the source host(s) or network(s);\n   and the RIDPolicy class\
    \ provides information on the agreed-upon\n   policies and specifies the type\
    \ of communication message being used.\n   The RID schema acts as an envelope\
    \ for the IODEF schema to facilitate\n   RID communications.  The intent in maintaining\
    \ a separate schema and\n   not using the AdditionalData extension of IODEF is\
    \ the flexibility of\n   sending messages between RID hosts.  Since RID is a separate\
    \ schema\n   that includes the IODEF schema, the RID information acts as an\n\
    \   envelope, and then the RIDPolicy class can be easily extracted for\n   use\
    \ by the transport protocol.  The security requirements of sending\n   incident\
    \ information across the network include the use of\n   encryption.  The RIDPolicy\
    \ information is not required to be\n   encrypted, so separating out this data\
    \ from the IODEF extension\n   removes the need for decrypting and parsing the\
    \ entire IODEF and RID\n   document to determine how it should be handled at each\
    \ RID host.\n   The purpose of the RIDPolicy class is to specify the message type\
    \ for\n   the receiving host, facilitate the policy needs of RID, and provide\n\
    \   routing information in the form of an IP address of the destination\n   RID\
    \ system.\n   The policy information and guidelines are discussed in Section 6.6.\n\
    \   The policy is defined between RID peers and within or between\n   consortiums.\
    \  The RIDPolicy is meant to be a tool to facilitate the\n   defined policies.\
    \  This MUST be used in accordance with policy set\n   between clients, peers,\
    \ consortiums, and/or regions.  Security,\n   privacy, and confidentiality MUST\
    \ be considered as specified in this\n   document.\n   The RID schema is defined\
    \ as follows:\n        +------------------+\n        |        RID       |\n  \
    \      +------------------+\n        | ANY              |\n        |         \
    \         |<>---{0..1}----[ RIDPolicy      ]\n        | ENUM restriction |\n \
    \       | ENUM type        |<>---{0..1}----[ RequestStatus  ]\n        | STRING\
    \ meaning   |\n        |                  |<>---{0..1}----[ IncidentSource ]\n\
    \        +------------------+\n                         Figure 3.  The RID Schema\n\
    \   The aggregate classes that constitute the RID schema in the iodef-rid\n  \
    \ namespace are as follows:\n   RIDPolicy\n      Zero or One.  The RIDPolicy class\
    \ is used by all message types to\n      facilitate policy agreements between\
    \ peers, consortiums, or\n      federations, as well as to properly route messages.\n\
    \   RequestStatus\n      Zero or One.  The RequestStatus class is used only in\n\
    \      RequestAuthorization messages to report back to the originating\n     \
    \ RID system if the trace will be continued by each RID system that\n      received\
    \ a TraceRequest in the path to the source of the traffic.\n   IncidentSource\n\
    \      Zero or One.  The IncidentSource class is used in the Result\n      message\
    \ only.  The IncidentSource provides the information on the\n      identified\
    \ source host or network of an attack trace or\n      investigation.\n   Each\
    \ of the three listed classes may be the only class included in\n   the RID class,\
    \ hence the option for zero or one.  In some cases,\n   RIDPolicy MAY be the only\
    \ class in the RID definition when used by\n   the transport protocol [RFC6046],\
    \ as that information should be as\n   small as possible and may not be encrypted.\
    \  The RequestStatus\n   message MUST be able to stand alone without the need\
    \ for an IODEF\n   document to facilitate the communication, limiting the data\n\
    \   transported to the required elements per [RFC6046].\n"
- title: 4.3.3.1.  RequestStatus Class
  contents:
  - "4.3.3.1.  RequestStatus Class\n   The RequestStatus class is an aggregate class\
    \ in the RID class.\n                    +--------------------------------+\n\
    \                    | RequestStatus                  |\n                    +--------------------------------+\n\
    \                    |                                |\n                    |\
    \ ENUM restriction               |\n                    | ENUM AuthorizationStatus\
    \       |\n                    | ENUM Justification             |\n          \
    \          | STRING ext-AuthorizationStatus |\n                    | STRING ext-Justification\
    \       |\n                    |                                |\n          \
    \          +--------------------------------+\n                    Figure 4. \
    \ The RequestStatus Class\n   The RequestStatus class has five attributes:\n \
    \  restriction\n      OPTIONAL.  ENUM.  This attribute indicates the disclosure\n\
    \      guidelines to which the sender expects the recipient to adhere.\n     \
    \ This guideline provides no real security since it is the choice of\n      the\
    \ recipient of the document to honor it.  This attribute follows\n      the same\
    \ guidelines as \"restriction\" used in IODEF.\n   AuthorizationStatus\n     \
    \ REQUIRED.  ENUM.  The listed values are used to provide a response\n      to\
    \ the requesting CSIRT of the status of a TraceRequest in the\n      current network.\n\
    \      1. Approved.  The trace was approved and will begin in the\n         current\
    \ NP.\n      2. Denied.  The trace was denied in the current NP.  The next\n \
    \        closest NP can use this message to filter traffic from the\n        \
    \ upstream NP using the example packet to help mitigate the\n         effects\
    \ of the attack as close to the source as possible.  The\n         RequestAuthorization\
    \ message must be passed back to the\n         originator and a Result message\
    \ used from the closest NP to the\n         source to indicate actions taken in\
    \ the IODEF History class.\n      3. Pending.  Awaiting approval; a timeout period\
    \ has been reached,\n         which resulted in this Pending status and RequestAuthorization\n\
    \         message being generated.\n      4. ext-value.  An escape value used\
    \ to extend this attribute.  See\n         IODEF [RFC5070], Section 5.1.\n   Justification\n\
    \      OPTIONAL.  ENUM.  Provides a reason for a Denied or Pending\n      message.\n\
    \      1. SystemResource.  A resource issue exists on the systems that\n     \
    \    would be involved in the request.\n      2. Authentication.  The enveloped\
    \ digital signature [RFC3275]\n         failed to validate.\n      3. AuthenticationOrigin.\
    \  The detached digital signature for the\n         original requestor on the\
    \ IP packet failed to validate.\n      4. Encryption.  Unable to decrypt the request.\n\
    \      5. Other.  There were other reasons this request could not be\n       \
    \  processed.\n      6. ext-value.  An escape value used to extend this attribute.\
    \  See\n         IODEF [RFC5070], Section 5.1.\n   AuthorizationStatus-ext\n \
    \     OPTIONAL.  STRING.  A means by which to extend the\n      AuthorizationStatus\
    \ attribute.  See IODEF [RFC5070], Section 5.1.\n   Justification-ext\n      OPTIONAL.\
    \  STRING.  A means by which to extend the Justification\n      attribute.  See\
    \ IODEF [RFC5070], Section 5.1.\n"
- title: 4.3.3.2.  IncidentSource Class
  contents:
  - "4.3.3.2.  IncidentSource Class\n   The IncidentSource class is an aggregate class\
    \ in the RID class.\n       +-------------------+\n       | IncidentSource   \
    \ |\n       +-------------------+\n       |                   |\n       | ENUM\
    \ restriction  |\n       |                   |<>-------------[ SourceFound   \
    \ ]\n       |                   |\n       |                   |<>---{0..*}----[\
    \ Node           ]\n       |                   |\n       +-------------------+\n\
    \                    Figure 5.  The IncidentSource Class\n   The elements that\
    \ constitute the IncidentSource class follow:\n   SourceFound\n      One.  BOOLEAN.\
    \  The Source class indicates if a source was\n      identified.  If the source\
    \ was identified, it is listed in the\n      Node element of this class.\n   \
    \   True.  Source of incident was identified.\n      False.  Source of incident\
    \ was not identified.\n   Node\n      One.  The Node class is used to identify\
    \ a host or network device,\n      in this case to identify the system communicating\
    \ RID messages.\n      The base definition of this class is reused from the IODEF\n\
    \      specification [RFC5070], Section 3.16.\n   The IncidentSource class has\
    \ one attribute:\n   restriction\n      OPTIONAL.  ENUM.  This attribute indicates\
    \ the disclosure\n      guidelines to which the sender expects the recipient to\
    \ adhere.\n      This guideline provides no real security since it is the choice\
    \ of\n      the recipient of the document to honor it.  This attribute follows\n\
    \      the same guidelines as \"restriction\" used in IODEF.\n"
- title: 4.3.3.3.  RIDPolicy Class
  contents:
  - "4.3.3.3.  RIDPolicy Class\n   The RIDPolicy class facilitates the delivery of\
    \ RID messages and is\n   also referenced for transport in the transport document\
    \ [RFC6046].\n       +------------------------+\n       | RIDPolicy          \
    \    |\n       +------------------------+\n       |                        |\n\
    \       | ENUM restriction       |<>-------------[ Node         ]\n       | ENUM\
    \ MsgType           |\n       | ENUM MsgDestination    |<>---{0..1}----[ IncidentID\
    \   ]\n       | ENUM ext-MsgType       |\n       | ENUM ext-MsgDestination|<>---{1..*}----[\
    \ PolicyRegion ]\n       |                        |\n       |                \
    \        |<>---{1..*}----[ TrafficType  ]\n       |                        |\n\
    \       +------------------------+\n                      Figure 6.  The RIDPolicy\
    \ Class\n   The aggregate elements that constitute the RIDPolicy class are as\n\
    \   follows:\n   Node\n      One.  The Node class is used to identify a host or\
    \ network device,\n      in this case to identify the system communicating RID\
    \ messages.\n      The base definition of this class is reused from the IODEF\n\
    \      specification [RFC5070], Section 3.16.\n   IncidentID\n      Zero or one.\
    \  Global reference pointing back to the IncidentID\n      defined in the IODEF\
    \ data model.  The IncidentID includes the name\n      of the CSIRT, an incident\
    \ number, and an instance of that\n      incident.  The instance number is appended\
    \ with a dash separating\n      the values and is used in cases for which it may\
    \ be desirable to\n      group incidents.  Examples of incidents that may be grouped\
    \ would\n      be botnets, DDoS attacks, multiple hops of compromised systems\n\
    \      found during an investigation, etc.\n   PolicyRegion\n      One or many.\
    \  REQUIRED.  The values for the attribute \"region\" are\n      used to determine\
    \ what policy area may require consideration\n      before a trace can be approved.\
    \  The PolicyRegion may include\n      multiple selections from the attribute\
    \ list in order to fit all\n      possible policy considerations when crossing\
    \ regions, consortiums,\n      or networks.\n   region\n      One.  ENUM.\n  \
    \    1. ClientToNP.  An enterprise network initiated the request.\n      2. NPToClient.\
    \  An NP passed a RID request to a client or an\n         enterprise attached\
    \ network to the NP based on the service\n         level agreements.\n      3.\
    \ IntraConsortium.  A trace that should have no restrictions\n         within\
    \ the boundaries of a consortium with the agreed-upon use\n         and abuse\
    \ guidelines.\n      4. PeerToPeer.  A trace that should have no restrictions\
    \ between\n         two peers but may require further evaluation before continuance\n\
    \         beyond that point with the agreed-upon use and abuse\n         guidelines.\n\
    \      5. BetweenConsortiums.  A trace that should have no restrictions\n    \
    \     between consortiums that have established agreed-upon use and\n        \
    \ abuse guidelines.\n      6. AcrossNationalBoundaries.  This selection must be\
    \ set if the\n         trace type is anything but a trace of attack traffic with\n\
    \         malicious intent.  This must also be set if the traffic request\n  \
    \       is based upon regulations of a specific nation that would not\n      \
    \   apply to all nations.  This is different from the\n         \"BetweenConsortiums\"\
    \ setting since it may be possible to have\n         multiple nations as members\
    \ of the same consortium, and this\n         option must be selected if the traffic\
    \ is of a type that may\n         have different restrictions in other nations.\n\
    \      7. ext-value.  An escape value used to extend this attribute.  See\n  \
    \       IODEF [RFC5070], Section 5.1.\n   TrafficType\n      One or many.  REQUIRED.\
    \  The values for the attribute \"type\" are\n      meant to assist in determining\
    \ if a trace is appropriate for the\n      NP receiving the request to continue\
    \ the trace.  Multiple values\n      may be selected for this element; however,\
    \ where possible, it\n      should be restricted to one value that would most\
    \ accurately\n      describe the traffic type.\n   type\n      One.  ENUM.\n \
    \     1. Attack.  This option should only be selected if the traffic is\n    \
    \     related to a network-based attack.  The type of attack MUST\n         also\
    \ be listed in more detail in the IODEF Method and Impact\n         classes for\
    \ further clarification to assist in determining if\n         the trace can be\
    \ continued ([RFC5070], Sections 3.9 and\n         3.10.1).\n      2. Network.\
    \  This option MUST only be selected when the trace is\n         related to NP\
    \ network traffic or routing issues.\n      3. Content.  This category MUST be\
    \ used only in the case in which\n         the request is related to the content\
    \ and regional restrictions\n         on accessing that type of content exist.\
    \  This is not malicious\n         traffic but may include determining what sources\
    \ or\n         destinations accessed certain materials available on the\n    \
    \     Internet, including, but not limited to, news, technology, or\n        \
    \ inappropriate content.\n      4. OfficialBusiness.  This option MUST be used\
    \ if the traffic\n         being traced is requested or is affiliated with any\
    \ government\n         or other official business request.  This would be used\
    \ during\n         an investigation by government authorities or other government\n\
    \         traces to track suspected criminal or other activities.\n      5. Other.\
    \  If this option is selected, a description of the\n         traffic type MUST\
    \ be provided so that policy decisions can be\n         made to continue or stop\
    \ the trace.  The information should be\n         provided in the IODEF message\
    \ in the Expectation class or in\n         the History class using a HistoryItem\
    \ log.\n      6. ext-value.  An escape value used to extend this attribute.  See\n\
    \         IODEF [RFC5070], Section 5.1.\n   The RIDPolicy class has five attributes:\n\
    \   restriction\n      OPTIONAL.  ENUM.  This attribute indicates the disclosure\n\
    \      guidelines to which the sender expects the recipient to adhere.\n     \
    \ This guideline provides no real security since it is the choice of\n      the\
    \ recipient of the document to honor it.  This attribute follows\n      the same\
    \ guidelines as \"restriction\" used in IODEF.\n   MsgType\n      REQUIRED.  ENUM.\
    \  The type of RID message sent.  The six types of\n      messages are described\
    \ in Section 4.3.2 and can be noted as one of\n      the six selections below.\n\
    \      1. TraceRequest.  This message may be used to initiate a\n         TraceRequest\
    \ or to continue a TraceRequest to an upstream\n         network closer to the\
    \ source address of the origin of the\n         security incident.\n      2. RequestAuthorization.\
    \  This message is sent to the initiating\n         RID system from each of the\
    \ upstream RID systems to provide\n         information on the request status\
    \ in the current network.\n      3. Result.  This message indicates that the source\
    \ of the attack\n         was located and the message is sent to the initiating\
    \ RID\n         system through the RID systems in the path of the trace.\n   \
    \   4. Investigation.  This message type is used when the source of\n        \
    \ the traffic is believed to be valid.  The purpose of the\n         Investigation\
    \ request is to leverage the existing peer or\n         consortium relationships\
    \ in order to notify the NP closest to\n         the source of the valid traffic\
    \ that some event occurred, which\n         may be a security-related incident.\n\
    \      5. Report.  This message is used to report a security incident,\n     \
    \    for which no action is requested in the IODEF Expectation\n         class.\
    \  This may be used for the purpose of correlating attack\n         information\
    \ by CSIRTs, statistics and trending information,\n         etc.\n      6. IncidentQuery.\
    \  This message is used to request information\n         from a trusted RID system\
    \ about an incident or incident type.\n      Additionally, there is an extension\
    \ attribute to add new\n      enumerated values:\n      -  ext-value.  An escape\
    \ value used to extend this attribute.  See\n         IODEF [RFC5070], Section\
    \ 5.1.\n   MsgDestination\n      REQUIRED.  ENUM.  The destination required at\
    \ this level may\n      either be the RID messaging system intended to receive\
    \ the\n      request, or, in the case of an Investigation request, the source\n\
    \      of the incident.  In the case of an Investigation request, the RID\n  \
    \    system that can help stop or mitigate the traffic may not be\n      known,\
    \ and the message may have to traverse RID messaging systems\n      by following\
    \ the routing path to the RID system closest to the\n      source of the attack\
    \ traffic.  The Node element lists either the\n      RID system or the IP address\
    \ of the source, and the meaning of the\n      value in the Node element is determined\
    \ by the MsgDestination\n      element.\n      1. RIDSystem.  The address listed\
    \ in the Node element of the\n         RIDPolicy class is the next upstream RID\
    \ system that will\n         receive the RID message.\n      2. SourceOfIncident.\
    \  The address listed in the Node element of\n         the RIDPolicy class is\
    \ the incident source.  The IP address is\n         used to determine the path\
    \ of RID systems that will be used to\n         find the closest RID system to\
    \ the source of an attack in which\n         the IP address used by the source\
    \ is believed to be valid and\n         an Investigation request message is used.\
    \  This is not to be\n         confused with the IncidentSource class, as the\
    \ defined value\n         here is from an initial trace or Investigation request,\
    \ not the\n         source used in a Result message.\n      3. ext-value.  An\
    \ escape value used to extend this attribute.  See\n         IODEF [RFC5070],\
    \ Section 5.1.\n   MsgType-ext\n      OPTIONAL.  STRING.  A means by which to\
    \ extend the MsgType\n      attribute.  See IODEF [RFC5070], Section 5.1.\n  \
    \ MsgDestination-ext\n      OPTIONAL.  STRING.  A means by which to extend the\
    \ MsgDestination\n      attribute.  See IODEF [RFC5070], Section 5.1.\n"
- title: 4.3.4.  RID Namespace
  contents:
  - "4.3.4.  RID Namespace\n   The RID schema declares a namespace of \"iodef-rid-1.0\"\
    \ and registers\n   it per [XMLnames].  Each IODEF-RID document MUST use the \"\
    iodef-\n   rid-1.0\" namespace in the top-level element RID-Document.  It can\
    \ be\n   referenced as follows:\n"
- title: <RID-Document
  contents:
  - "<RID-Document\n   version=\"1.00\" lang=\"en-US\"\n   xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\
    \n   xsi:schemaLocation=http://www.iana.org/assignments/xml-registry/\n      schema/iodef-rid-1.0.xsd\"\
    >\n"
- title: 4.4.  RID Messages
  contents:
  - "4.4.  RID Messages\n   The IODEF model is followed as specified in [RFC5070]\
    \ for each of the\n   RID message types.  The RID schema is used in combination\
    \ with IODEF\n   documents to facilitate RID communications.  Each message type\
    \ varies\n   slightly in format and purpose; hence, the requirements vary and\
    \ are\n   specified for each.  All classes, elements, attributes, etc., that\n\
    \   are defined in the IODEF-Document are valid in the context of a RID\n   message;\
    \ however, some listed as optional in IODEF are mandatory for\n   RID as listed\
    \ for each message type.  The IODEF model MUST be fully\n   implemented to ensure\
    \ proper parsing of all RID messages.\n   Note: The implementation of the RID\
    \ system may obtain some of the\n   information needed to fill in the content\
    \ required for each message\n   type automatically from packet input to the system\
    \ or default\n   information such as that used in the EventData class.\n"
- title: 4.4.1.  TraceRequest
  contents:
  - "4.4.1.  TraceRequest\n   Description: This message or document is sent to the\
    \ network\n   management station next in the upstream trace once the upstream\n\
    \   source of the traffic has been identified.\n   The following information is\
    \ required for TraceRequest messages and\n   is provided through:\n      RID Information:\n\
    \         RIDPolicy\n            RID message type, IncidentID, and destination\n\
    \            policy information\n      IODEF Information:\n         Time Stamps\
    \ (DetectTime, StartTime, EndTime, ReportTime).\n         Incident Identifier\
    \ (Incident class, IncidentID).\n            Trace number - used for multiple\
    \ traces of a single\n            incident; must be noted.\n         Confidence\
    \ rating of security incident (Impact and Confidence\n            class).\n  \
    \       System class is used to list both the Source and Destination\n       \
    \     Information used in the attack and must note if the traffic\n          \
    \  is spoofed, thus requiring an upstream TraceRequest in RID.\n         Expectation\
    \ class should be used to request any specific\n            actions to be taken\
    \ close to the source.\n         Path information of nested RID systems, beginning\
    \ with the\n            request originator used in the trace using IODEF EventData\n\
    \            with category set to \"infrastructure\".\n         Event, Record,\
    \ and RecordItem classes to include example\n            packets and other information\
    \ related to the incident.\n            Note: Event information included here\
    \ requires a second\n            instance of EventData in addition to that used\
    \ to convey NP\n            path contact information.\n      Standards for encryption\
    \ and digital signatures [RFC3275],\n         [XMLsig]:\n         Digital signature\
    \ from initiating RID system, passed to all\n         systems in upstream trace\
    \ using XML digital signature.\n   A DDoS attack can have many sources, resulting\
    \ in multiple traces to\n   locate the sources of the attack.  It may be valid\
    \ to continue\n   multiple traces for a single attack.  The path information would\n\
    \   enable the administrators to determine if the exact trace had already\n  \
    \ passed through a single network.  The Incident Identifier must also\n   be used\
    \ to identify multiple TraceRequests from a single incident.\n   If a single TraceRequest\
    \ results in divergent paths of TraceRequests,\n   a separate instance number\
    \ MUST be used under the same IncidentID.\n   The IncidentID instance number of\
    \ IODEF can be used to correlate\n   related incident data that is part of a larger\
    \ incident.\n"
- title: 4.4.2.  RequestAuthorization
  contents:
  - "4.4.2.  RequestAuthorization\n   Description: This message is sent to the initiating\
    \ RID system from\n   the next upstream NP's RID system to provide information\
    \ on the\n   request status in the current network.\n   The following information\
    \ is required for RequestAuthorization\n   messages and is provided through:\n\
    \      RID Information:\n         RIDPolicy\n            RID message type, IncidentID,\
    \ and destination\n            policy information\n         Status of TraceRequest\n\
    \            RequestStatus class in RID schema\n      Standards for encryption\
    \ and digital signatures [RFC3275],\n         [XMLsig]:\n         Digital signature\
    \ of responding NP for authenticity of Trace\n         Status Message, from the\
    \ NP creating this message using XML\n         digital signature.\n   A message\
    \ is sent back to the initiating RID system of the trace as\n   status notification.\
    \  This message verifies that the next RID system\n   in the path has received\
    \ the message from the previous system in the\n   path.  This message also verifies\
    \ that the trace is now continuing,\n   has stopped, or is pending in the next\
    \ upstream RID system.  The\n   Pending status would be automatically generated\
    \ after a 2-minute\n   timeout without system-predefined or administrator action\
    \ taken to\n   approve or disapprove the trace continuance.  If a Request is denied,\n\
    \   the originator and sending peer (if they are not the same) MUST both\n   receive\
    \ the message.  This enables the sending peer the option to\n   take action to\
    \ stop or mitigate the traffic as close to the source as\n   possible.\n"
- title: 4.4.3.  Result
  contents:
  - "4.4.3.  Result\n   Description: This message indicates that the trace or investigation\n\
    \   has been completed and provides the result.  The Result message\n   includes\
    \ information on whether or not a source was found and the\n   source information\
    \ through the IncidentSource class.  The Result\n   information MUST go back to\
    \ the originating RID system that began the\n   investigation or trace.  An NP\
    \ may use any number of incident\n   handling data sources to ascertain the true\
    \ source of an attack.  All\n   of the possible information sources may or may\
    \ not be readily tied\n   into the RID communications system.\n   The following\
    \ information is required for Result messages and will be\n   provided through:\n\
    \      RID Information:\n         RIDPolicy\n            RID message type, IncidentID,\
    \ and destination\n            policy information\n         Incident Source\n\
    \            The IncidentSource class of the RID schema is used to note\n    \
    \        if a source was identified and provide the source\n            address(es).\n\
    \      IODEF Information:\n         Time Stamps (DetectTime, StartTime, EndTime,\
    \ ReportTime).\n         Incident Identifier (Incident class, IncidentID).\n \
    \           Trace number - used for multiple traces of a single\n            incident;\
    \ must be noted.\n         Confidence rating of security incident (Impact and\
    \ Confidence\n            class).\n         System class is used to list both\
    \ the Source and Destination\n            Information used in the attack and must\
    \ note if the traffic\n            is spoofed, thus requiring an upstream TraceRequest\
    \ in RID.\n         History class \"atype\" attribute is used to note any actions\n\
    \            taken.\n         History class also notes any other background information\n\
    \            including notes about the confidence level or rating of the\n   \
    \         result information.\n         Path information of nested RID systems,\
    \ beginning with the\n            request originator used in the trace using IODEF\
    \ EventData\n            with category set to \"infrastructure\".  The last NP\
    \ listed\n            is the NP that located the source of the traffic (the NP\n\
    \            sending the Result message).\n         Event, Record, and RecordItem\
    \ classes to include example\n            packets and other information related\
    \ to the incident\n            (optional).\n            Note: Event information\
    \ included here requires a second\n            instance of EventData in addition\
    \ to that used to convey NP\n            path contact information.\n      Standards\
    \ for encryption and digital signatures [RFC3275]:\n         Digital signature\
    \ of source NP for authenticity of Result\n         Message, from the NP creating\
    \ this message using XML digital\n         signature.\n   A message is sent back\
    \ to the initiating RID system to notify the\n   associated CSIRT that the source\
    \ has been located.  The actual source\n   information may or may not be included,\
    \ depending on the policy of\n   the network in which the client or host is attached.\
    \  Any action\n   taken by the NP to act upon the discovery of the source of a\
    \ trace\n   should be included.  The NP may be able to automate the adjustment\
    \ of\n   filters at their border router to block outbound access for the\n   machine(s)\
    \ discovered as a part of the attack.  The filters may be\n   comprehensive enough\
    \ to block all Internet access until the host has\n   taken the appropriate action\
    \ to resolve any security issues or to\n   rate-limit the ingress traffic as close\
    \ to the source as possible.\n   Security and privacy considerations discussed\
    \ in Section 6 MUST be\n   taken into account.\n   Note: The History class has\
    \ been expanded in IODEF to accommodate all\n   of the possible actions taken\
    \ as a result of a RID TraceRequest or\n   Investigation request using the \"\
    iodef:atype\", or action type,\n   attribute.  The History class should be used\
    \ to note all actions\n   taken close to the source of a trace or incident using\
    \ the most\n   appropriate option for the type of action along with a description.\n\
    \   The \"atype\" attribute in the Expectation class can also be used to\n   request\
    \ an appropriate action when a TraceRequest or Investigation\n   request is made.\n"
- title: 4.4.4.  Investigation Request
  contents:
  - "4.4.4.  Investigation Request\n   Description: This message type is used when\
    \ the source of the traffic\n   is believed not to be spoofed.  The purpose of\
    \ the Investigation\n   request message is to leverage the existing bilateral\
    \ peer\n   relationships in order to notify the network provider closest to the\n\
    \   source of the valid traffic that some event occurred, which may be a\n   security-related\
    \ incident.\n   The following information is required for Investigation request\n\
    \   messages and is provided through:\n      RID Information:\n         RID Policy\n\
    \            RID message type, IncidentID, and destination\n            policy\
    \ information\n      IODEF Information:\n         Time Stamps (DetectTime, StartTime,\
    \ EndTime, ReportTime).\n         Incident Identifier (Incident class, IncidentID).\n\
    \            Trace number - used for multiple traces of a single\n           \
    \ incident; must be noted.\n         Confidence rating of security incident (Impact\
    \ and Confidence\n            class).\n         System class is used to list both\
    \ the Source and Destination\n            Information used in the attack and must\
    \ note if the traffic\n            is spoofed, thus requiring an upstream TraceRequest\
    \ in RID.\n         Expectation class should be used to request any specific\n\
    \            actions to be taken close to the source.\n         Path information\
    \ of nested RID systems, beginning with the\n            request originator used\
    \ in the trace using IODEF EventData\n            with category set to \"infrastructure\"\
    .\n         Event, Record, and RecordItem classes to include example\n       \
    \     packets and other information related to the incident.\n            Note:\
    \ Event information included here requires a second\n            instance of EventData\
    \ in addition to that used to convey NP\n            path contact information.\n\
    \      Standards for encryption and digital signatures [RFC3275]:\n         Digital\
    \ signature from initiating RID system, passed to all\n         systems in upstream\
    \ trace using XML digital signature.\n   Security considerations would include\
    \ the ability to encrypt\n   [XMLencrypt] the contents of the Investigation request\
    \ message using\n   the public key of the destination RID system.  The incident\
    \ number\n   would increase as if it were a TraceRequest message in order to\n\
    \   ensure uniqueness within the system.  The relaying peers would also\n   append\
    \ their Autonomous System (AS) or RID system information as the\n   request message\
    \ was relayed along the web of network providers so\n   that the Result message\
    \ could utilize the same path as the set of\n   trust relationships for the return\
    \ message, thus indicating any\n   actions taken.  The request would also be recorded\
    \ in the state\n   tables of both the initiating and destination NP RID systems.\
    \  The\n   destination NP is responsible for any actions taken as a result of\n\
    \   the request in adherence to any service level agreements or internal\n   policies.\
    \  The NP should confirm that the traffic actually originated\n   from the suspected\
    \ system before taking any action and confirm the\n   reason for the request.\
    \  The request may be sent directly to a known\n   RID system or routed by the\
    \ source address of the attack using the\n   message destination of RIDPolicy,\
    \ SourceOfIncident.\n   Note: All intermediate parties must be able to view RIDPolicy\n\
    \   information in order to properly direct RID messages.\n"
- title: 4.4.5.  Report
  contents:
  - "4.4.5.  Report\n   Description: This message or document is sent to a RID system\
    \ to\n   provide a report of a security incident.  This message does not\n   require\
    \ any actions to be taken, except to file the report on the\n   receiving RID\
    \ system or associated database.\n   The following information is required for\
    \ Report messages and will be\n   provided through:\n      RID Information:\n\
    \         RID Policy RID message type, IncidentID, and destination\n         \
    \   policy information\n   The following data is recommended if available and\
    \ can be provided\n   through:\n      IODEF Information:\n         Time Stamps\
    \ (DetectTime, StartTime, EndTime, ReportTime).\n         Incident Identifier\
    \ (Incident class, IncidentID).\n            Trace number - used for multiple\
    \ traces of a single\n            incident; must be noted.\n         Confidence\
    \ rating of security incident (Impact and Confidence\n            class).\n  \
    \       System class is used to list both the Source and Destination\n       \
    \     Information used in the attack.\n         Event, Record, and RecordItem\
    \ classes to include example\n            packets and other information related\
    \ to the incident\n            (optional).\n      Standards for encryption and\
    \ digital signatures [RFC3275]:\n         Digital signature from initiating RID\
    \ system, passed to all\n         systems receiving the report using XML digital\
    \ signature.\n   Security considerations would include the ability to encrypt\n\
    \   [XMLencrypt] the contents of the Report message using the public key\n   of\
    \ the destination RID system.  Senders of a Report message should\n   note that\
    \ the information may be used to correlate security incident\n   information for\
    \ the purpose of trending, pattern detection, etc., and\n   may be shared with\
    \ other parties unless otherwise agreed upon with\n   the receiving RID system.\
    \  Therefore, sending parties of a Report\n   message may obfuscate or remove\
    \ destination addresses or other\n   sensitive information before sending a Report\
    \ message.  A Report\n   message may be sent either to file an incident report\
    \ or in response\n   to an IncidentQuery, and data sensitivity must be considered\
    \ in both\n   cases.  The NP path information is not necessary for this message,\
    \ as\n   it will be communicated directly between two trusted RID systems.\n"
- title: 4.4.6.  IncidentQuery
  contents:
  - "4.4.6.  IncidentQuery\n   Description: The IncidentQuery message is used to request\
    \ incident\n   information from a trusted RID system.  The request can include\
    \ the\n   incident number, if known, or detailed information about the\n   incident.\
    \  If the incident number is known, the Report message\n   containing the incident\
    \ information can easily be returned to the\n   trusted requestor using automated\
    \ methods.  If an example packet or\n   other unique information is included in\
    \ the IncidentQuery, the return\n   report may be automated; otherwise, analyst\
    \ intervention may be\n   required.\n   The following information must be used\
    \ for an IncidentQuery message\n   and is provided through:\n      RID Information:\n\
    \         RID Policy\n            RID message type, IncidentID, and destination\n\
    \            policy information\n      IODEF Information (optional):\n       \
    \  Time Stamps (DetectTime, StartTime, EndTime, ReportTime).\n         Incident\
    \ Identifier (Incident class, IncidentID).\n            Trace number - used for\
    \ multiple traces of a single\n            incident; must be noted.\n        \
    \ Confidence rating of security incident (Impact and Confidence\n            class).\n\
    \         System class is used to list both the Source and Destination\n     \
    \       Information used in the attack.\n         Event, Record, and RecordItem\
    \ classes to include example\n            packets and other information related\
    \ to the incident\n            (optional).\n      Standards for encryption and\
    \ digital signatures [RFC3275]:\n         Digital signature from initiating RID\
    \ system, passed to all\n         systems receiving the IncidentQuery using XML\
    \ digital\n         signature.  If a packet is not included, the signature may\
    \ be\n         based on the RIDPolicy class.\n   The proper response to the IncidentQuery\
    \ message is a Report message.\n   Multiple incidents may be returned for a single\
    \ query if an incident\n   type is requested.  In this case, the receiving system\
    \ would send an\n   IODEF document containing multiple incidents or all instances\
    \ of an\n   incident.  The system sending the reply may pre-set a limit to the\n\
    \   number of documents returned in one report.  The recommended limit\n   is\
    \ 5, to prevent the documents from becoming too large.  Other\n   transfer methods\
    \ may be suited better than RID for large transfers of\n   data.  The Confidence\
    \ rating may be used in the IncidentQuery message\n   to select only incidents\
    \ with an equal or higher Confidence rating\n   than what is specified.  This\
    \ may be used for cases when information\n   is gathered on a type of incident\
    \ but not on specifics about a single\n   incident.  Source and Destination Information\
    \ may not be needed if\n   the IncidentQuery is intended to gather data about\
    \ a specific type of\n   incident as well.\n"
- title: 4.5.  RID Communication Exchanges
  contents:
  - "4.5.  RID Communication Exchanges\n   The following section outlines the communication\
    \ flows for RID and\n   also provides examples of messages.  The proper response\
    \ to a\n   TraceRequest is a RequestAuthorization message.  The\n   RequestAuthorization\
    \ message lets the requestor know if the trace\n   will continue through the next\
    \ upstream network.  If there is a\n   problem with the request, such as a failure\
    \ to validate the digital\n   signature or decrypt the request, a RequestAuthorization\
    \ message MUST\n   be sent to the requestor and the downstream peer (if they are\
    \ not one\n   and the same) providing the reason why the message could not be\n\
    \   processed.  Assuming that the trace continued, additional\n   TraceRequests\
    \ with the response of a RequestAuthorization message\n   would occur passing\
    \ the request upstream in the path to the source of\n   the traffic related to\
    \ the incident.  Once a source is found, a\n   Result message is sent to the originator\
    \ of the trace, as determined\n   by the NP path information provided through\
    \ the document instance of\n   EventData, where contact is set to \"infrastructure\"\
    .  The NP path\n   information is also used when sending the RequestAuthorization\n\
    \   messages to the first entry (the trace originator) and the last\n   nested\
    \ entry (the downstream peer).  The Result message is encrypted\n   [XMLencrypt]\
    \ for the originator providing information about the\n   incident source and any\
    \ actions taken.  If the originator fails to\n   decrypt or authenticate the Result\
    \ message, a RequestAuthorization\n   message is sent in response; otherwise,\
    \ no return message is sent.\n   If a RequestAuthorization message is sent with\
    \ the RequestStatus set\n   to Denied, a downstream peer receiving this message\
    \ may choose to\n   take action to stop or mitigate the traffic at that point\
    \ in the\n   network, as close to the source as possible.  If the downstream peer\n\
    \   chooses this option, it would send a Result message to the trace\n   originator.\n\
    \   Note: For each example listed below, [RFC5735] addresses were used.\n   Assume\
    \ that each IP address listed is actually a separate network\n   range held by\
    \ different NPs.  Addresses were used from /27 network\n   ranges.\n"
- title: 4.5.1.  Upstream Trace Communication Flow
  contents:
  - "4.5.1.  Upstream Trace Communication Flow\n   The diagram below outlines the\
    \ RID TraceRequest communication flow\n   between RID systems on different networks\
    \ tracing an attack.\n   Attack Dest      NP-1            NP-2        NP-3   \
    \     Attack Src\n   1. Attack    |  Attack\n      reported  |  detected\n   2.\
    \              Initiate trace\n   3.              Locate origin\n            \
    \       through\n                   upstream NP\n   4.              o---TraceRequest----->\n\
    \   5.                              Trace\n                                  \
    \ Initiated\n   6.              <-RequestAuthorization-o\n   7.              \
    \                Locate origin\n                                   through\n \
    \                                  upstream NP\n   8.                        \
    \      o---TraceRequest--->\n   9.                                           \
    \  Trace Initiated\n   10.             <----------RequestAuthorization----o\n\
    \                                    <---RequestAuth---o\n   11.             \
    \                               Locate attack\n                              \
    \                    source on network   X\n   12.             <------------Result----------------o\n\
    \                Figure 7.  TraceRequest Communication Flow\n   Before a trace\
    \ is initiated, the RID system should verify if an\n   instance of the trace or\
    \ a similar request is not active.  The traces\n   may be resource intensive;\
    \ therefore, providers need to be able to\n   detect potential abuse of the system\
    \ or unintentional resource\n   drains.  Information such as the Source and Destination\
    \ Information,\n   associated packets, and the incident may be desirable to maintain\
    \ for\n   a period of time determined by administrators.\n   The communication\
    \ flow demonstrates that a RequestAuthorization\n   message is sent to both the\
    \ downstream peer and the original\n   requestor.  If a TraceRequest is denied,\
    \ the downstream peer has the\n   option to take an action and respond with a\
    \ Result message.  The\n   originator of the request may follow up with the downstream\
    \ peer of\n   the NP involved using an Investigation request to ensure that an\n\
    \   action is taken if no response is received.  Nothing precludes the\n   originator\
    \ of the request from initiating a new TraceRequest\n   bypassing the NP that\
    \ denied the request, if a trace is needed beyond\n   that point.  Another option\
    \ may be for the initiator to send an\n   Investigation request to an NP upstream\
    \ of the NP that denied the\n   request if enough information was gathered to\
    \ discern the true source\n   of the attack traffic from the incident handling\
    \ information.\n"
- title: 4.5.1.1.  RID TraceRequest Example
  contents:
  - "4.5.1.1.  RID TraceRequest Example\n   The example listed is of a TraceRequest\
    \ based on the incident report\n   example from the IODEF document.  The RID extension\
    \ classes were\n   included as appropriate for a TraceRequest message using the\n\
    \   RIDPolicy class.  The example given is that of a CSIRT reporting a\n   DoS\
    \ attack in progress to the upstream NP.  The request asks the next\n   NP to\
    \ continue the trace and have the traffic mitigated closer to the\n   source of\
    \ the traffic.\n   In the following example, use of [XMLsig] to generate digital\n\
    \   signatures does not currently provide digest algorithm agility, as\n   [XMLsig]\
    \ only supports SHA-1.  A future version of [XMLsig] may\n   support additional\
    \ digest algorithms to support digest algorithm\n   agility.\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"TraceRequest\"\n                       MsgDestination=\"RIDSystem\"\
    >\n    <iodef-rid:PolicyRegion region=\"IntraConsortium\"/>\n    <iodef:Node>\n\
    \      <iodef:Address category=\"ipv4-addr\">192.0.2.3</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#207-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: <!-- IODEF-Document accompanied by the above RID -->
  contents:
  - '<!-- IODEF-Document accompanied by the above RID -->

    '
- title: <iodef:IODEF-Document version="1.00"
  contents:
  - "<iodef:IODEF-Document version=\"1.00\"\n                      xmlns:iodef=\"\
    urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef:Incident restriction=\"need-to-know\"\
    \ purpose=\"traceback\">\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n\
    \      CERT-FOR-OUR-DOMAIN#207-1\n    </iodef:IncidentID>\n    <iodef:DetectTime>2004-02-02T22:49:24+00:00</iodef:DetectTime>\n\
    \    <iodef:StartTime>2004-02-02T22:19:24+00:00</iodef:StartTime>\n    <iodef:ReportTime>2004-02-02T23:20:24+00:00</iodef:ReportTime>\n\
    \    <iodef:Description>Host involved in DoS attack</iodef:Description>\n    <iodef:Assessment>\n\
    \      <iodef:Impact severity=\"low\" completion=\"failed\" type=\"dos\"/>\n \
    \   </iodef:Assessment>\n    <iodef:Contact role=\"creator\" type=\"organization\"\
    >\n      <iodef:ContactName>Constituency-contact for 192.0.2.35\n      </iodef:ContactName>\n\
    \      <iodef:Email>Constituency-contact@192.0.2.35</iodef:Email>\n    </iodef:Contact>\n\
    \    <iodef:EventData>\n      <iodef:Flow>\n        <iodef:System category=\"\
    source\">\n          <iodef:Node>\n            <iodef:Address category=\"ipv4-addr\"\
    >192.0.2.35\n            </iodef:Address>\n          </iodef:Node>\n         \
    \ <iodef:Service>\n            <iodef:port>38765</iodef:port>\n          </iodef:Service>\n\
    \        </iodef:System>\n        <iodef:System category=\"target\">\n       \
    \   <iodef:Node>\n            <iodef:Address category=\"ipv4-addr\">192.0.2.67\n\
    \            </iodef:Address>\n          </iodef:Node>\n          <iodef:Service>\n\
    \            <iodef:port>80</iodef:port>\n          </iodef:Service>\n       \
    \ </iodef:System>\n      </iodef:Flow>\n      <iodef:Expectation severity=\"high\"\
    \ action=\"rate-limit-host\">\n        <iodef:Description>\n          Rate-limit\
    \ traffic close to source\n        </iodef:Description>\n      </iodef:Expectation>\n\
    \      <iodef:Record>\n        <iodef:RecordData>\n          <iodef:Description>\n\
    \            The IPv4 packet included was used in the described attack\n     \
    \     </iodef:Description>\n          <iodef:RecordItem dtype=\"ipv4-packet\"\
    >450000522ad9\n             0000ff06c41fc0a801020a010102976d0050103e020810d9\n\
    \             4a1350021000ad6700005468616e6b20796f7520666f7220\n             6361726566756c6c792072656164696e6720746869732052\n\
    \             46432e0a\n          </iodef:RecordItem>\n        </iodef:RecordData>\n\
    \      </iodef:Record>\n    </iodef:EventData>\n    <iodef:History>\n      <iodef:HistoryItem>\n\
    \        <iodef:DateTime>2001-09-14T08:19:01+00:00</iodef:DateTime>\n        <iodef:IncidentID\
    \ name=\"CSIRT-FOR-OUR-DOMAIN\">\n          CSIRT-FOR-OUR-DOMAIN#207-1\n     \
    \   </iodef:IncidentID>\n        <iodef:Description>\n          Notification sent\
    \ to next upstream NP closer to 192.0.2.35\n        </iodef:Description>\n   \
    \   </iodef:HistoryItem>\n    </iodef:History>\n  </iodef:Incident>\n"
- title: </iodef:IODEF-Document>
  contents:
  - '</iodef:IODEF-Document>

    '
- title: <!-- Digital signature accompanied by above RID and IODEF -->
  contents:
  - '<!-- Digital signature accompanied by above RID and IODEF -->

    '
- title: <Envelope xmlns="urn:envelope"
  contents:
  - "<Envelope xmlns=\"urn:envelope\"\n          xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\"\
    \n          xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\">\n  <iodef:IODEF-Document>\n\
    \    <iodef:Incident>\n      <iodef:EventData>\n        <iodef:Record>\n     \
    \     <iodef:RecordData>\n            <iodef:RecordItem type=\"ipv4-packet\">450000522ad9\n\
    \             0000ff06c41fc0a801020a010102976d0050103e020810d9\n             4a1350021000ad6700005468616e6b20796f7520666f7220\n\
    \             6361726566756c6c792072656164696e6720746869732052\n             46432e0a\n\
    \            </iodef:RecordItem>\n          </iodef:RecordData>\n        </iodef:Record>\n\
    \      </iodef:EventData>\n    </iodef:Incident>\n  </iodef:IODEF-Document>\n\
    \  <Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\">\n    <SignedInfo>\n\
    \      <CanonicalizationMethod\n         Algorithm=\"http://www.w3.org/TR/2001/\n\
    \          REC-xml-c14n-20010315#WithComments\"/>\n      <SignatureMethod\n  \
    \       Algorithm=\"http://www.w3.org/2000/09/xmldsig#dsa-sha1\"/>\n      <Reference\
    \ URI=\"\">\n        <Transforms>\n          <Transform Algorithm=\n         \
    \  \"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/>\n        </Transforms>\n\
    \        <DigestMethod\n           Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"\
    />\n        <DigestValue>KiI5+6SnFAs429VNwsoJjHPplmo=</DigestValue>\n      </Reference>\n\
    \    </SignedInfo>\n    <SignatureValue>\n      VvyXqCzjoW0m2NdxNeToXQcqcSM80W+JMW+Kn01cS3z3KQwCPeswzg==\n\
    \    </SignatureValue>\n    <KeyInfo>\n      <KeyValue>\n        <DSAKeyValue>\n\
    \          <P>/KaCzo4Syrom78z3EQ5SbbB4sF7ey80etKII864WF64B81uRpH5t9j\n       \
    \      QTxeEu0ImbzRMqzVDZkVG9xD7nN1kuFw==</P>\n          <Q>li7dzDacuo67Jg7mtqEm2TRuOMU=</Q>\n\
    \          <G>Z4Rxsnqc9E7pGknFFH2xqaryRPBaQ01khpMdLRQnG541Awtx/XPaF5\n       \
    \      Bpsy4pNWMOHCBiNU0NogpsQW5QvnlMpA==</G>\n          <Y>VFWTD4I/aKni4YhDyYxAJozmj1iAzPLw9Wwd5B+Z9J5E7lHjcAJ+bs\n\
    \             HifTyYdnj+roGzy4o09YntYD8zneQ7lw==</Y>\n        </DSAKeyValue>\n\
    \      </KeyValue>\n    </KeyInfo>\n  </Signature>\n"
- title: </Envelope>
  contents:
  - '</Envelope>

    '
- title: 4.5.1.2.  RequestAuthorization Message Example
  contents:
  - "4.5.1.2.  RequestAuthorization Message Example\n   The example RequestAuthorization\
    \ message is in response to the\n   TraceRequest message listed above.  The NP\
    \ that received the request\n   is responding to approve the trace continuance\
    \ in their network.\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"RequestAuthorization\"\n                       MsgDestination=\"RIDSystem\"\
    >\n    <iodef-rid:PolicyRegion region=\"IntraConsortium\"/>\n    <iodef:Node>\n\
    \      <iodef:Address category=\"ipv4-addr\">192.0.2.67</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#207-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n\
    \  <iodef-rid:RequestStatus AuthorizationStatus=\"Approved\"/>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: 4.5.1.3.  Result Message Example
  contents:
  - "4.5.1.3.  Result Message Example\n   The example Result message is in response\
    \ to the TraceRequest listed\n   above.  This message type only comes after a\
    \ RequestAuthorization\n   within the TraceRequest flow of messages.  It may be\
    \ a direct\n   response to an Investigation request.  This message provides\n\
    \   information about the source of the attack and the actions taken to\n   mitigate\
    \ the traffic.\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"Result\"\n                       MsgDestination=\"RIDSystem\">\n \
    \   <iodef-rid:PolicyRegion region=\"IntraConsortium\"/>\n    <iodef:Node>\n \
    \     <iodef:Address category=\"ipv4-addr\">192.0.2.67</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#207-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n\
    \  <iodef-rid:IncidentSource>\n    <iodef-rid:SourceFound>true</iodef-rid:SourceFound>\n\
    \    <iodef:Node>\n      <iodef:Address category=\"ipv4-addr\">192.0.2.37</iodef:Address>\n\
    \    </iodef:Node>\n  </iodef-rid:IncidentSource>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: <!-- IODEF-Document accompanied by the above RID -->
  contents:
  - '<!-- IODEF-Document accompanied by the above RID -->

    '
- title: <iodef:IODEF-Document version="1.00"
  contents:
  - "<iodef:IODEF-Document version=\"1.00\"\n                      xmlns:iodef=\"\
    urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef:Incident restriction=\"need-to-know\"\
    \ purpose=\"traceback\">\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n\
    \      CERT-FOR-OUR-DOMAIN#207-1\n    </iodef:IncidentID>\n    <iodef:DetectTime>2004-02-02T22:49:24+00:00</iodef:DetectTime>\n\
    \    <iodef:StartTime>2004-02-02T22:19:24+00:00</iodef:StartTime>\n    <iodef:ReportTime>2004-02-02T23:20:24+00:00</iodef:ReportTime>\n\
    \    <iodef:Description>Host involved in DoS attack</iodef:Description>\n    <iodef:Assessment>\n\
    \      <iodef:Impact severity=\"low\" completion=\"failed\" type=\"dos\"/>\n \
    \   </iodef:Assessment>\n    <iodef:Contact role=\"creator\" type=\"organization\"\
    >\n      <iodef:ContactName>Constituency-contact for 192.0.2.35\n      </iodef:ContactName>\n\
    \      <iodef:Email>Constituency-contact@192.0.2.35</iodef:Email>\n    </iodef:Contact>\n\
    \    <iodef:EventData>\n      <iodef:Contact role=\"admin\" type=\"organization\"\
    >\n        <iodef:ContactName>Admin-contact for 192.0.2.35\n        </iodef:ContactName>\n\
    \        <iodef:Email>Admin-contact@10.1.1.2</iodef:Email>\n      </iodef:Contact>\n\
    \      <iodef:Flow>\n        <iodef:System category=\"intermediate\">\n      \
    \    <iodef:Node>\n            <iodef:Address category=\"ipv4-addr\">192.0.2.35\n\
    \            </iodef:Address>\n          </iodef:Node>\n        </iodef:System>\n\
    \      </iodef:Flow>\n      <iodef:EventData>\n        <iodef:Contact role=\"\
    admin\" type=\"organization\">\n          <iodef:ContactName>Admin-contact for\
    \ 192.0.2.3\n          </iodef:ContactName>\n          <iodef:Email>Admin-contact@192.0.2.3</iodef:Email>\n\
    \        </iodef:Contact>\n        <iodef:Flow>\n          <iodef:System category=\"\
    intermediate\">\n            <iodef:Node>\n              <iodef:Address category=\"\
    ipv4-addr\">192.0.2.3\n              </iodef:Address>\n            </iodef:Node>\n\
    \          </iodef:System>\n        </iodef:Flow>\n      </iodef:EventData>\n\
    \    </iodef:EventData>\n    <iodef:EventData>\n      <iodef:Flow>\n        <iodef:System\
    \ category=\"source\">\n          <iodef:Node>\n            <iodef:Address category=\"\
    ipv4-addr\">192.0.2.35\n            </iodef:Address>\n          </iodef:Node>\n\
    \          <iodef:Service>\n            <iodef:port>38765</iodef:port>\n     \
    \     </iodef:Service>\n        </iodef:System>\n        <iodef:System category=\"\
    target\">\n          <iodef:Node>\n            <iodef:Address category=\"ipv4-addr\"\
    >192.0.2.67\n            </iodef:Address>\n          </iodef:Node>\n         \
    \ <iodef:Service>\n            <iodef:port>80</iodef:port>\n          </iodef:Service>\n\
    \        </iodef:System>\n      </iodef:Flow>\n      <iodef:Expectation severity=\"\
    high\" action=\"rate-limit-host\">\n        <iodef:Description>\n          Rate-limit\
    \ traffic close to source\n        </iodef:Description>\n      </iodef:Expectation>\n\
    \      <iodef:Record>\n        <iodef:RecordData>\n          <iodef:Description>\n\
    \            The IPv4 packet included was used in the described attack\n     \
    \     </iodef:Description>\n          <iodef:RecordItem dtype=\"ipv4-packet\"\
    >450000522ad9\n          0000ff06c41fc0a801020a010102976d0050103e020810d9\n  \
    \        4a1350021000ad6700005468616e6b20796f7520666f7220\n          6361726566756c6c792072656164696e6720746869732052\n\
    \          46432e0a\n          </iodef:RecordItem>\n        </iodef:RecordData>\n\
    \      </iodef:Record>\n    </iodef:EventData>\n    <iodef:History>\n      <iodef:HistoryItem>\n\
    \        <iodef:DateTime>2004-02-02T22:53:01+00:00</iodef:DateTime>\n        <iodef:IncidentID\
    \ name=\"CSIRT-FOR-OUR-DOMAIN\">\n          CSIRT-FOR-OUR-DOMAIN#207-1\n     \
    \   </iodef:IncidentID>\n        <iodef:Description>\n          Notification sent\
    \ to next upstream NP closer to 192.0.2.35\n        </iodef:Description>\n   \
    \   </iodef:HistoryItem>\n      <iodef:HistoryItem action=\"rate-limit-host\"\
    >\n        <iodef:DateTime>2004-02-02T23:07:21+00:00</iodef:DateTime>\n      \
    \  <iodef:IncidentID name=\"CSIRT-FOR-NP3\">\n          CSIRT-FOR-NP3#3291-1\n\
    \        </iodef:IncidentID>\n        <iodef:Description>\n          Host rate-limited\
    \ for 24 hours\n        </iodef:Description>\n      </iodef:HistoryItem>\n   \
    \ </iodef:History>\n  </iodef:Incident>\n"
- title: </iodef:IODEF-Document>
  contents:
  - '</iodef:IODEF-Document>

    '
- title: 4.5.2.  Investigation Request Communication Flow
  contents:
  - "4.5.2.  Investigation Request Communication Flow\n   The diagram below outlines\
    \ the RID Investigation request\n   communication flow between RID systems on\
    \ different networks for a\n   security incident with a known source address.\
    \  The proper response\n   to an Investigation request is a Result message.  If\
    \ there is a\n   problem with the request, such as a failure to validate the digital\n\
    \   signature or decrypt the request, a RequestAuthorization message is\n   sent\
    \ to the requestor.  The RequestAuthorization message should\n   provide the reason\
    \ why the message could not be processed.\n     Attack Dest      NP-1        \
    \      NP-2        Attack Src\n     1. Attack    |  Attack\n        reported \
    \ |  detected\n     2.              Determine source\n                     of\
    \ security incident\n     3.              o---Investigation---->\n     4.    \
    \                          Research\n                                     incident\
    \ and\n                                     determine appropriate\n          \
    \                           actions to take\n     5.              <-------Result-------o\n\
    \                Figure 8.  Investigation Communication Flow\n"
- title: 4.5.2.1.  Investigation Request Example
  contents:
  - "4.5.2.1.  Investigation Request Example\n   The following example only includes\
    \ the RID-specific details.  The\n   IODEF and security measures are similar to\
    \ the TraceRequest\n   information, with the exception that the source is known\
    \ and the\n   receiving RID system is known to be close to the source.  The source\n\
    \   known is indicated in the IODEF document, which allows for incident\n   sources\
    \ to be listed as spoofed, if appropriate.\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"Investigation\"\n                       MsgDestination=\"SourceOfIncident\"\
    >\n    <iodef-rid:PolicyRegion region=\"PeerToPeer\"/>\n    <iodef:Node>\n   \
    \   <iodef:Address category=\"ipv4-addr\">192.0.2.98</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#208-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: <!-- IODEF-Document accompanied by the above RID -->
  contents:
  - '<!-- IODEF-Document accompanied by the above RID -->

    '
- title: <iodef:IODEF-Document version="1.00"
  contents:
  - "<iodef:IODEF-Document version=\"1.00\"\n                      xmlns:iodef=\"\
    urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef:Incident restriction=\"need-to-know\"\
    \ purpose=\"other\">\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n  \
    \    CERT-FOR-OUR-DOMAIN#208-1\n    </iodef:IncidentID>\n    <iodef:DetectTime>2004-02-05T08:13:33+00:00</iodef:DetectTime>\n\
    \    <iodef:StartTime>2004-02-05T08:13:31+00:00</iodef:StartTime>\n    <iodef:EndTime>2004-02-05T08:13:33+00:00</iodef:EndTime>\n\
    \    <iodef:ReportTime>2004-02-05T08:13:35+00:00</iodef:ReportTime>\n    <iodef:Description>Host\
    \ involved in DoS attack</iodef:Description>\n    <iodef:Assessment>\n      <iodef:Impact\
    \ severity=\"low\" completion=\"failed\" type=\"recon\"/>\n    </iodef:Assessment>\n\
    \    <iodef:Contact role=\"creator\" type=\"organization\">\n      <iodef:ContactName>Constituency-contact\
    \ for 192.0.2.35\n      </iodef:ContactName>\n      <iodef:Email>Constituency-contact@10.1.1.2</iodef:Email>\n\
    \    </iodef:Contact>\n    <iodef:EventData>\n      <iodef:Flow>\n        <iodef:System\
    \ category=\"source\">\n          <iodef:Node>\n            <iodef:Address category=\"\
    ipv4-addr\">192.0.2.35\n            </iodef:Address>\n          </iodef:Node>\n\
    \          <iodef:Service>\n            <iodef:port>41421</iodef:port>\n     \
    \     </iodef:Service>\n        </iodef:System>\n        <iodef:System category=\"\
    target\">\n          <iodef:Node>\n            <iodef:Address category=\"ipv4-addr\"\
    >192.0.2.67\n            </iodef:Address>\n          </iodef:Node>\n         \
    \ <iodef:Service>\n            <iodef:port>80</iodef:port>\n          </iodef:Service>\n\
    \        </iodef:System>\n      </iodef:Flow>\n      <iodef:Expectation severity=\"\
    high\" action=\"investigate\">\n        <iodef:Description>\n          Investigate\
    \ whether source has been compromised\n        </iodef:Description>\n      </iodef:Expectation>\n\
    \    </iodef:EventData>\n    <iodef:History>\n      <iodef:HistoryItem>\n    \
    \    <iodef:DateTime>2004-02-05T08:19:01+00:00</iodef:DateTime>\n        <iodef:IncidentID\
    \ name=\"CSIRT-FOR-OUR-DOMAIN\">\n          CSIRT-FOR-OUR-DOMAIN#208-1\n     \
    \   </iodef:IncidentID>\n        <iodef:Description>\n          Investigation\
    \ request sent to NP for 192.0.2.35\n        </iodef:Description>\n      </iodef:HistoryItem>\n\
    \    </iodef:History>\n  </iodef:Incident>\n"
- title: </iodef:IODEF-Document>
  contents:
  - '</iodef:IODEF-Document>

    '
- title: 4.5.2.2.  RequestAuthorization Message Example
  contents:
  - "4.5.2.2.  RequestAuthorization Message Example\n   The example RequestAuthorization\
    \ message is in response to the\n   Investigation request listed above.  The NP\
    \ that received the request\n   was unable to validate the digital signature used\
    \ to authenticate the\n   sending RID system.\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"RequestAuthorization\"\n                       MsgDestination=\"RIDSystem\"\
    >\n    <iodef-rid:PolicyRegion region=\"IntraConsortium\"/>\n    <iodef:Node>\n\
    \      <iodef:Address category=\"ipv4-addr\">192.0.2.67</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#208-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n\
    \  <iodef-rid:RequestStatus AuthorizationStatus=\"Denied\"\n                 \
    \          Justification=\"Authentication\"/>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: 4.5.3.  Report Communication
  contents:
  - "4.5.3.  Report Communication\n   The diagram below outlines the RID Report communication\
    \ flow between\n   RID systems on different networks.\n        NP-1          \
    \                 NP-2\n     1. Generate incident information\n        and prepare\
    \ Report message\n     2.              o-------Report------->\n     3.       \
    \                       File report in database\n                   Figure 9.\
    \  Report Communication Flow\n   The Report communication flow is used to provide\
    \ information on\n   specific incidents detected on the network.  Incident information\
    \ may\n   be shared between CSIRTs or participating RID hosts using this\n   format.\
    \  When a report is received, the RID system must verify that\n   the report has\
    \ not already been filed.  The incident number and\n   incident data, such as\
    \ the hexadecimal packet and incident class\n   information, can be used to compare\
    \ with existing database entries.\n   The Report message typically does not have\
    \ a response.  If there is a\n   problem with the Report message, such as a failure\
    \ to validate the\n   digital signature [RFC3275] or decrypt the request, a\n\
    \   RequestAuthorization message is sent to the requestor.  The\n   RequestAuthorization\
    \ message should provide the reason why the\n   message could not be processed.\n"
- title: 4.5.3.1.  Report Example
  contents:
  - "4.5.3.1.  Report Example\n   The following example only includes the RID-specific\
    \ details.  This\n   report is an unsolicited Report message that includes an\
    \ IPv4 packet.\n   The IODEF document and digital signature would be similar to\
    \ the\n   TraceRequest information.\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"Report\" MsgDestination=\"RIDSystem\">\n    <iodef-rid:PolicyRegion\
    \ region=\"PeerToPeer\"/>\n    <iodef:Node>\n      <iodef:Address category=\"\
    ipv4-addr\">192.0.2.130</iodef:Address>\n    </iodef:Node>\n    <iodef-rid:TrafficType\
    \ type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n   \
    \   CERT-FOR-OUR-DOMAIN#209-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: <!-- IODEF-Document accompanied by the above RID -->
  contents:
  - '<!-- IODEF-Document accompanied by the above RID -->

    '
- title: <iodef:IODEF-Document version="1.00"
  contents:
  - "<iodef:IODEF-Document version=\"1.00\"\n                      xmlns:iodef=\"\
    urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef:Incident restriction=\"need-to-know\"\
    \ purpose=\"reporting\">\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\">\n\
    \      CERT-FOR-OUR-DOMAIN#209-1\n    </iodef:IncidentID>\n    <iodef:DetectTime>2004-02-05T10:21:08+00:00</iodef:DetectTime>\n\
    \    <iodef:StartTime>2004-02-05T10:21:05+00:00</iodef:StartTime>\n    <iodef:EndTime>2004-02-05T10:35:00+00:00</iodef:EndTime>\n\
    \    <iodef:ReportTime>2004-02-05T10:27:38+00:00</iodef:ReportTime>\n    <iodef:Description>Host\
    \ illicitly accessed admin account\n    </iodef:Description>\n    <iodef:Assessment>\n\
    \      <iodef:Impact severity=\"high\" completion=\"succeeded\"\n            \
    \        type=\"admin\"/>\n      <iodef:Confidence rating=\"high\"/>\n    </iodef:Assessment>\n\
    \    <iodef:Contact role=\"creator\" type=\"organization\">\n      <iodef:ContactName>Constituency-contact\
    \ for 192.0.2.35\n      </iodef:ContactName>\n      <iodef:Email>Constituency-contact@10.1.1.2</iodef:Email>\n\
    \    </iodef:Contact>\n    <iodef:EventData>\n      <iodef:Flow>\n        <iodef:System\
    \ category=\"source\">\n          <iodef:Node>\n            <iodef:Address category=\"\
    ipv4-addr\">192.0.2.35\n            </iodef:Address>\n          </iodef:Node>\n\
    \          <iodef:Service>\n            <iodef:port>32821</iodef:port>\n     \
    \     </iodef:Service>\n        </iodef:System>\n        <iodef:System category=\"\
    target\">\n          <iodef:Node>\n            <iodef:Address category=\"ipv4-addr\"\
    >192.0.2.67\n            </iodef:Address>\n          </iodef:Node>\n         \
    \ <iodef:Service>\n            <iodef:port>22</iodef:port>\n          </iodef:Service>\n\
    \        </iodef:System>\n      </iodef:Flow>\n    </iodef:EventData>\n    <iodef:History>\n\
    \      <iodef:HistoryItem>\n        <iodef:DateTime>2004-02-05T10:28:00+00:00</iodef:DateTime>\n\
    \        <iodef:IncidentID name=\"CSIRT-FOR-OUR-DOMAIN\">\n          CSIRT-FOR-OUR-DOMAIN#209-1\n\
    \        </iodef:IncidentID>\n        <iodef:Description>\n          Incident\
    \ report sent to NP for 192.0.2.35\n        </iodef:Description>\n      </iodef:HistoryItem>\n\
    \    </iodef:History>\n  </iodef:Incident>\n"
- title: </iodef:IODEF-Document>
  contents:
  - '</iodef:IODEF-Document>

    '
- title: 4.5.4.  IncidentQuery Communication Flow
  contents:
  - "4.5.4.  IncidentQuery Communication Flow\n   The diagram below outlines the RID\
    \ IncidentQuery communication flow\n   between RID systems on different networks.\n\
    \        NP-1                           NP-2\n     1. Generate a request for\n\
    \        information on a specific\n        incident number or incident type\n\
    \     2.              o---IncidentQuery--->\n     3.                         \
    \     Verify policy information\n                                     and determine\
    \ if matches exist\n                                     for requested information\n\
    \     4.              <-------Report------o\n     5.  Associate report to request\n\
    \         by incident number or type\n         and file report(s).\n         \
    \      Figure 10.  IncidentQuery Communication Flow\n   The IncidentQuery message\
    \ communication receives a response of a\n   Report message.  If the Report message\
    \ is empty, the responding host\n   did not have information available to share\
    \ with the requestor.  The\n   incident number and responding RID system, as well\
    \ as the transport,\n   assist in the association of the request and response\
    \ since a report\n   can be filed and is not always solicited.  If there is a\
    \ problem with\n   the IncidentQuery message, such as a failure to validate the\
    \ digital\n   signature or decrypt the request, a RequestAuthorization message\
    \ is\n   sent to the requestor.  The RequestAuthorization message should\n   provide\
    \ the reason why the message could not be processed.\n"
- title: 4.5.4.1.  IncidentQuery Example
  contents:
  - "4.5.4.1.  IncidentQuery Example\n   The IncidentQuery request may be received\
    \ in several formats as a\n   result of the type of query being performed.  If\
    \ the incident number\n   is the only information provided, the IODEF document\
    \ and IP packet\n   data may not be needed to complete the request.  However,\
    \ if a type\n   of incident is requested, the incident number remains NULL, and\
    \ the\n   IP packet data will not be included in the IODEF RecordItem class;\n\
    \   the other incident information is the main source for comparison.  In\n  \
    \ the case in which an incident number may not be the same between\n   CSIRTs,\
    \ the incident number and/or IP packet information can be\n   provided and used\
    \ for comparison on the receiving RID system to\n   generate (a) Report message(s).\n"
- title: <iodef-rid:RID xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<iodef-rid:RID xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n   \
    \            xmlns:iodef=\"urn:ietf:params:xml:ns:iodef-1.0\">\n  <iodef-rid:RIDPolicy\
    \ MsgType=\"IncidentQuery\"\n                       MsgDestination=\"RIDSystem\"\
    >\n    <iodef-rid:PolicyRegion region=\"PeerToPeer\"/>\n    <iodef:Node>\n   \
    \   <iodef:Address category=\"ipv4-addr\">192.0.2.3</iodef:Address>\n    </iodef:Node>\n\
    \    <iodef-rid:TrafficType type=\"Attack\"/>\n    <iodef:IncidentID name=\"CERT-FOR-OUR-DOMAIN\"\
    >\n      CERT-FOR-OUR-DOMAIN#210-1\n    </iodef:IncidentID>\n  </iodef-rid:RIDPolicy>\n"
- title: </iodef-rid:RID>
  contents:
  - '</iodef-rid:RID>

    '
- title: 5.  RID Schema Definition
  contents:
  - '5.  RID Schema Definition

    '
- title: <?xml version="1.0" encoding="UTF-8"?>
  contents:
  - '<?xml version="1.0" encoding="UTF-8"?>

    '
- title: <xs:schema xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-1.0"
  contents:
  - "<xs:schema xmlns:iodef-rid=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\n xmlns:iodef=\"\
    urn:ietf:params:xml:ns:iodef-1.0\"\n xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\
    \n xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"\n targetNamespace=\"urn:ietf:params:xml:ns:iodef-rid-1.0\"\
    \n elementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\">\n"
- title: <xs:import namespace="urn:ietf:params:xml:ns:iodef-1.0"
  contents:
  - "<xs:import namespace=\"urn:ietf:params:xml:ns:iodef-1.0\"\n schemaLocation=\"\
    http://www.iana.org/assignments/xml-registry/\n schema/iodef-rid-1.0.xsd\"/>\n"
- title: <xs:import namespace="http://www.w3.org/2000/09/xmldsig#"
  contents:
  - "<xs:import namespace=\"http://www.w3.org/2000/09/xmldsig#\"\n schemaLocation=\n\
    \ \"http://www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd\"/>\n"
- title: <!-- ****************************************************************
  contents:
  - '<!-- ****************************************************************

    '
- title: '*********************************************************************'
  contents:
  - '*********************************************************************

    '
- title: '***  Real-time Inter-network Defense - RID XML Schema             ***'
  contents:
  - '***  Real-time Inter-network Defense - RID XML Schema             ***

    '
- title: '***    Namespace - iodef-rid, August 2006                         ***'
  contents:
  - '***    Namespace - iodef-rid, August 2006                         ***

    '
- title: '***    The namespace is defined to support transport of IODEF     ***'
  contents:
  - '***    The namespace is defined to support transport of IODEF     ***

    '
- title: '***     documents for exchanging incident information.            ***'
  contents:
  - '***     documents for exchanging incident information.            ***

    '
- title: '*********************************************************************'
  contents:
  - '*********************************************************************

    '
- title: -->
  contents:
  - '-->

    '
- title: <!--RID acts as an envelope for IODEF documents to support the exchange
  contents:
  - "<!--RID acts as an envelope for IODEF documents to support the exchange\n   \
    \ of messages-->\n"
- title: <!--
  contents:
  - '<!--

    '
- title: ====== Real-Time Inter-network Defense - RID ======
  contents:
  - '====== Real-Time Inter-network Defense - RID ======

    '
- title: ====  Suggested definition for RID messaging ======
  contents:
  - "====  Suggested definition for RID messaging ======\n -->\n"
- title: <xs:annotation>
  contents:
  - "<xs:annotation>\n  <xs:documentation>XML Schema wrapper for IODEF</xs:documentation>\n"
- title: </xs:annotation>
  contents:
  - '</xs:annotation>

    '
- title: <xs:element name="RID" type="iodef-rid:RIDType"/>
  contents:
  - "<xs:element name=\"RID\" type=\"iodef-rid:RIDType\"/>\n  <xs:complexType name=\"\
    RIDType\">\n    <xs:sequence>\n      <xs:element ref=\"iodef-rid:RIDPolicy\" minOccurs=\"\
    0\"/>\n      <xs:element ref=\"iodef-rid:RequestStatus\" minOccurs=\"0\"/>\n \
    \     <xs:element ref=\"iodef-rid:IncidentSource\" minOccurs=\"0\"/>\n    </xs:sequence>\n\
    \  </xs:complexType>\n"
- title: <!--Used in RequestAuthorization Message for RID-->
  contents:
  - '<!--Used in RequestAuthorization Message for RID-->

    '
- title: <xs:element name="RequestStatus" type="iodef-rid:RequestStatusType"/>
  contents:
  - "<xs:element name=\"RequestStatus\" type=\"iodef-rid:RequestStatusType\"/>\n \
    \ <xs:complexType name=\"RequestStatusType\">\n     <xs:attribute name=\"AuthorizationStatus\"\
    \ use=\"required\">\n        <xs:simpleType>\n          <xs:restriction base=\"\
    xs:NMTOKEN\">\n          <xs:whiteSpace value=\"collapse\"/>\n            <xs:enumeration\
    \ value=\"Approved\"/>\n            <xs:enumeration value=\"Denied\"/>\n     \
    \       <xs:enumeration value=\"Pending\"/>\n            <xs:enumeration value=\"\
    ext-value\"/>\n          </xs:restriction>\n        </xs:simpleType>\n     </xs:attribute>\n\
    \     <xs:attribute name=\"ext-AuthorizationStatus\"\n                   type=\"\
    xs:string\" use=\"optional\"/>\n     <xs:attribute name=\"Justification\">\n \
    \       <xs:simpleType>\n          <xs:restriction base=\"xs:NMTOKEN\">\n    \
    \      <xs:whiteSpace value=\"collapse\"/>\n            <xs:enumeration value=\"\
    SystemResource\"/>\n            <xs:enumeration value=\"Authentication\"/>\n \
    \           <xs:enumeration value=\"AuthenticationOrigin\"/>\n            <xs:enumeration\
    \ value=\"Encryption\"/>\n            <xs:enumeration value=\"Other\"/>\n    \
    \        <xs:enumeration value=\"ext-value\"/>\n          </xs:restriction>\n\
    \        </xs:simpleType>\n     </xs:attribute>\n     <xs:attribute name=\"ext-Justification\"\
    \n                   type=\"xs:string\" use=\"optional\"/>\n    <xs:attribute\
    \ name=\"restriction\" type=\"iodef:restriction-type\"/>\n  </xs:complexType>\n"
- title: <!--Incident Source Information for Result Message-->
  contents:
  - '<!--Incident Source Information for Result Message-->

    '
- title: <xs:element name="IncidentSource" type="iodef-rid:IncidentSourceType"/>
  contents:
  - "<xs:element name=\"IncidentSource\" type=\"iodef-rid:IncidentSourceType\"/>\n\
    \  <xs:complexType name=\"IncidentSourceType\">\n    <xs:sequence>\n      <xs:element\
    \ ref=\"iodef-rid:SourceFound\"/>\n      <xs:element ref=\"iodef:Node\" minOccurs=\"\
    0\"\n          maxOccurs=\"unbounded\"/>\n    </xs:sequence>\n    <xs:attribute\
    \ name=\"restriction\" type=\"iodef:restriction-type\"/>\n  </xs:complexType>\n\
    \  <xs:element name=\"SourceFound\" type=\"xs:boolean\"/>\n"
- title: <!--
  contents:
  - '<!--

    '
- title: ====== Real-Time Inter-network Defense Policy - RIDPolicy ======
  contents:
  - '====== Real-Time Inter-network Defense Policy - RIDPolicy ======

    '
- title: ======  Definition for RIDPolicy for messaging
  contents:
  - "======  Definition for RIDPolicy for messaging\n -->\n"
- title: <xs:annotation>
  contents:
  - "<xs:annotation>\n <xs:documentation>RID Policy used for transport of\n     messages</xs:documentation>\n"
- title: </xs:annotation>
  contents:
  - '</xs:annotation>

    '
- title: <!-- RIDPolicy information with setting information listed in RID
  contents:
  - "<!-- RIDPolicy information with setting information listed in RID\n     documentation\
    \ -->\n"
- title: <xs:element name="RIDPolicy" type="iodef-rid:RIDPolicyType"/>
  contents:
  - "<xs:element name=\"RIDPolicy\" type=\"iodef-rid:RIDPolicyType\"/>\n  <xs:complexType\
    \ name=\"RIDPolicyType\">\n    <xs:sequence>\n      <xs:element ref=\"iodef-rid:PolicyRegion\"\
    \ maxOccurs=\"unbounded\"/>\n      <xs:element ref=\"iodef:Node\"/>\n      <xs:element\
    \ ref=\"iodef-rid:TrafficType\" maxOccurs=\"unbounded\"/>\n      <xs:element ref=\"\
    iodef:IncidentID\" minOccurs=\"0\"/>\n    </xs:sequence>\n   <xs:attribute name=\"\
    MsgType\" use=\"required\">\n    <xs:simpleType>\n      <xs:restriction base=\"\
    xs:NMTOKEN\">\n      <xs:whiteSpace value=\"collapse\"/>\n        <xs:enumeration\
    \ value=\"TraceRequest\"/>\n        <xs:enumeration value=\"RequestAuthorization\"\
    />\n        <xs:enumeration value=\"Result\"/>\n        <xs:enumeration value=\"\
    Investigation\"/>\n        <xs:enumeration value=\"Report\"/>\n        <xs:enumeration\
    \ value=\"IncidentQuery\"/>\n        <xs:enumeration value=\"ext-value\"/>\n \
    \     </xs:restriction>\n    </xs:simpleType>\n   </xs:attribute>\n  <xs:attribute\
    \ name=\"ext-MsgType\" type=\"xs:string\" use=\"optional\"/>\n  <xs:attribute\
    \ name=\"MsgDestination\" use=\"required\">\n    <xs:simpleType>\n      <xs:restriction\
    \ base=\"xs:NMTOKEN\">\n      <xs:whiteSpace value=\"collapse\"/>\n        <xs:enumeration\
    \ value=\"RIDSystem\"/>\n        <xs:enumeration value=\"SourceOfIncident\"/>\n\
    \        <xs:enumeration value=\"ext-value\"/>\n      </xs:restriction>\n    </xs:simpleType>\n\
    \   </xs:attribute>\n  <xs:attribute name=\"ext-MsgDestination\" type=\"xs:string\"\
    \n                use=\"optional\"/>\n   </xs:complexType>\n  <xs:element name=\"\
    PolicyRegion\">\n    <xs:complexType>\n     <xs:attribute name=\"region\" use=\"\
    required\">\n      <xs:simpleType>\n       <xs:restriction base=\"xs:NMTOKEN\"\
    >\n       <xs:whiteSpace value=\"collapse\"/>\n         <xs:enumeration value=\"\
    ClientToNP\"/>\n         <xs:enumeration value=\"NPToClient\"/>\n         <xs:enumeration\
    \ value=\"IntraConsortium\"/>\n         <xs:enumeration value=\"PeerToPeer\"/>\n\
    \         <xs:enumeration value=\"BetweenConsortiums\"/>\n         <xs:enumeration\
    \ value=\"AcrossNationalBoundaries\"/>\n         <xs:enumeration value=\"ext-value\"\
    />\n       </xs:restriction>\n      </xs:simpleType>\n     </xs:attribute>\n \
    \    <xs:attribute name=\"ext-region\"\n                   type=\"xs:string\"\
    \ use=\"optional\"/>\n    </xs:complexType>\n  </xs:element>\n  <xs:element name=\"\
    TrafficType\" default=\"Attack\">\n    <xs:complexType>\n     <xs:attribute name=\"\
    type\" use=\"required\">\n      <xs:simpleType>\n       <xs:restriction base=\"\
    xs:NMTOKEN\">\n       <xs:whiteSpace value=\"collapse\"/>\n         <xs:enumeration\
    \ value=\"Attack\"/>\n         <xs:enumeration value=\"Network\"/>\n         <xs:enumeration\
    \ value=\"Content\"/>\n         <xs:enumeration value=\"OfficialBusiness\"/>\n\
    \         <xs:enumeration value=\"Other\"/>\n         <xs:enumeration value=\"\
    ext-value\"/>\n       </xs:restriction>\n      </xs:simpleType>\n     </xs:attribute>\n\
    \     <xs:attribute name=\"ext-type\"\n                   type=\"xs:string\" use=\"\
    optional\"/>\n    </xs:complexType>\n  </xs:element>\n"
- title: </xs:schema>
  contents:
  - '</xs:schema>

    '
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   Communication between NPs' RID systems must be\
    \ protected.  RID has\n   many security considerations built into the design of\
    \ the protocol,\n   several of which are described in the following sub-sections.\
    \  For a\n   complete view of security, considerations need to include the\n \
    \  availability, confidentiality, and integrity concerns for the\n   transport,\
    \ storage, and exchange of information.\n   When considering the transport of\
    \ RID messages, an out-of-band\n   network, either logical or physical, would\
    \ prevent outside attacks\n   against RID communication.  An out-of-band connection\
    \ would be ideal,\n   but not necessarily practical.  Authenticated encrypted\
    \ tunnels\n   between RID systems MUST be used to provide confidentiality,\n \
    \  integrity, authenticity, and privacy for the data.  Trust\n   relationships\
    \ are based on consortiums and established trust\n   relationships of public key\
    \ infrastructure (PKI) cross-certifications\n   of consortiums.  By using RIDPolicy\
    \ information, TLS, and the XML\n   security features of encryption [XMLencrypt]\
    \ and digital signatures\n   [RFC3275], [XMLsig], RID takes advantage of existing\
    \ security\n   standards.  The standards provide clear methods to ensure that\n\
    \   messages are secure, authenticated, and authorized, and that the\n   messages\
    \ meet policy and privacy guidelines and maintain integrity.\n   As specified\
    \ in the relevant sections of this document, the XML\n   digital signature [RFC3275]\
    \ and XML encryption [XMLencrypt] are used\n   in the following cases:\n   XML\
    \ Digital Signature\n   o  The originator of the TraceRequest or Investigation\
    \ request MUST\n      use a detached signature to sign at least one of the original\
    \ IP\n      packets included in the RecordItem class data to provide\n      authentication\
    \ to all upstream participants in the trace of the\n      origin.  All IP packets\
    \ provided by the originator may be signed,\n      and additional packets added\
    \ by upstream peers in the trace may be\n      signed by the peer adding the data,\
    \ while maintaining the IP\n      packet and detached signature from the original\
    \ requestor.  This\n      signature MUST be passed to all recipients of the TraceRequest.\n\
    \   o  For all message types, the full IODEF/RID document MUST be signed\n   \
    \   using an enveloped signature by the sending peer to provide\n      authentication\
    \ and integrity to the receiving RID system.\n   XML Encryption\n   o  The IODEF/RID\
    \ document may be encrypted to provide an extra layer\n      of security between\
    \ peers so that the message is not only\n      encrypted for the transport, but\
    \ also while stored.  This behavior\n      would be agreed upon between peers\
    \ or a consortium, or determined\n      on a per-message basis, depending on security\
    \ requirements.  It\n      should be noted that there are cases for transport\
    \ where the\n      RIDPolicy class needs to be presented in clear text, as detailed\n\
    \      in the transport document [RFC6046].\n   o  An Investigation request, or\
    \ any other message type that may be\n      relayed through RID systems other\
    \ than the intended destination as\n      a result of trust relationships, may\
    \ be encrypted for the intended\n      recipient.  This may be necessary if the\
    \ RID network is being used\n      for message transfer, the intermediate parties\
    \ do not need to have\n      knowledge of the request contents, and a direct communication\
    \ path\n      does not exist.  In that case, the RIDPolicy class is used by\n\
    \      intermediate parties and is maintained in clear text.\n   o  The action\
    \ taken in the Result message may be encrypted using the\n      key of the request\
    \ originator.  In that case, the intermediate\n      parties can view the RIDPolicy\
    \ information and know the trace has\n      been completed and do not need to\
    \ see the action.  If the use of\n      encryption were limited to sections of\
    \ the message, the History\n      class information would be encrypted.  Otherwise,\
    \ it is\n      RECOMMENDED to encrypt the entire IODEF/RID document, using an\n\
    \      enveloped signature, for the originator of the request.  The\n      existence\
    \ of the Result message for an incident would tell any\n      intermediate parties\
    \ used in the path of the incident\n      investigation that the incident handling\
    \ has been completed.\n   The formation of policies is a very important aspect\
    \ of using a\n   messaging system like RID to exchange potentially sensitive\n\
    \   information.  Many considerations should be involved for peering\n   parties,\
    \ and some guidelines to protect the data, systems, and\n   transport are covered\
    \ in this section.  Policies established should\n   provide guidelines for communication\
    \ methods, security, and fall-back\n   procedures.\n   The security considerations\
    \ for the storage and exchange of\n   information in RID messaging may include\
    \ adherence to local,\n   regional, or national regulations in addition to the\
    \ obligations to\n   protect client information during an investigation.  RID\
    \ Policy is a\n   necessary tool for listing the requirements of messages to provide\
    \ a\n   method to categorize data elements for proper handling.  Controls are\n\
    \   also provided for the sending entity to protect messages from third\n   parties\
    \ through XML encryption.\n   RID provides a method to exchange incident handling\
    \ request and\n   Report messages to peer networks.  Network administrators, who\
    \ have\n   the ability to base the decision on the available resources and other\n\
    \   factors of their network, maintain control of incident investigations\n  \
    \ within their own network.  Thus, RID provides the ability for\n   participating\
    \ networks to manage their own security controls,\n   leveraging the information\
    \ listed in RIDPolicy.\n"
- title: 6.1.  Message Transport
  contents:
  - "6.1.  Message Transport\n   The transport specifications are fully defined in\
    \ a separate document\n   [RFC6046].  The specified transport protocols MUST use\
    \ encryption to\n   provide an additional level of security and integrity, while\n\
    \   supporting mutual authentication through bi-directional certificate\n   usage.\
    \  Any subsequent transport method defined should take advantage\n   of existing\
    \ standards for ease of implementation and integration of\n   RID systems.  Session\
    \ encryption for the transport of RID messages is\n   enforced in the transport\
    \ specification.  The privacy and security\n   considerations are addressed fully\
    \ in RID to protect sensitive\n   portions of documents and provide a method to\
    \ authenticate the\n   messages.  Therefore, RID messages do not rely on the security\n\
    \   provided by the transport layer alone.  The encryption requirements\n   and\
    \ considerations for RID are discussed at the beginning of\n   Section 6 of this\
    \ document.\n   XML security functions such as the digital signature [RFC3275]\
    \ and\n   encryption [XMLencrypt] provide a standards-based method to encrypt\n\
    \   and digitally sign RID messages.  RID messages specify system use and\n  \
    \ privacy guidelines through the RIDPolicy class.  A public key\n   infrastructure\
    \ (PKI) provides the base for authentication and\n   authorization, encryption,\
    \ and digital signatures to establish trust\n   relationships between members\
    \ of a RID consortium or a peering\n   consortium.\n   XML security functions\
    \ such as the digital signature [RFC3275] and\n   encryption [XMLencrypt] can\
    \ be used within the contents of the\n   message for privacy and security in cases\
    \ for which certain elements\n   must remain encrypted or signed as they traverse\
    \ the path of a trace.\n   For example, the digital signature on a TraceRequest\
    \ can be used to\n   verify the identity of the trace originator.  The use of\
    \ the XML\n   security features in RID messaging is in accordance with the\n \
    \  specifications for the IODEF model; however, the use requirements may\n   differ\
    \ since RID also incorporates communication of security incident\n   information.\n"
- title: 6.2.  Message Delivery Protocol - Integrity and Authentication
  contents:
  - "6.2.  Message Delivery Protocol - Integrity and Authentication\n   The RID protocol\
    \ must be able to guarantee delivery and meet the\n   necessary security requirements\
    \ of a state-of-the-art protocol.  In\n   order to guarantee delivery, TCP should\
    \ be considered as the\n   underlying protocol within the current network standard\
    \ practices.\n   Security considerations must include the integrity, authentication,\n\
    \   privacy, and authorization of the messages sent between RID\n   communication\
    \ systems or IHSs.  The communication between RID systems\n   must be authenticated\
    \ and encrypted to ensure the integrity of the\n   messages and the RID systems\
    \ involved in the trace.  Another concern\n   that needs to be addressed is authentication\
    \ for a request that\n   traverses multiple networks.  In this scenario, systems\
    \ in the path\n   of the multi-hop TraceRequest need to authorize a trace from\
    \ not only\n   their neighbor network, but also from the initiating RID system\
    \ as\n   discussed in Section 6.4.  Several methods can be used to ensure\n  \
    \ integrity and privacy of the communication.\n   The transport mechanism selected\
    \ MUST follow the defined transport\n   protocol [RFC6046] when using RID messaging\
    \ to ensure consistency\n   among the peers.  Consortiums may vary their selected\
    \ transport\n   mechanisms and thus must decide upon a mutual protocol to use\
    \ for\n   transport when communicating with peers in a neighboring consortium\n\
    \   using RID.  RID systems MUST implement and deploy HTTPS as defined in\n  \
    \ the transport document [RFC6046] and optionally support other\n   protocols\
    \ such as the Blocks Extensible Exchange Protocol (BEEP).\n   RID, the XML security\
    \ functions, and transport protocols must\n   properly integrate with a public\
    \ key infrastructure (PKI) managed by\n   the consortium or one managed by a trusted\
    \ entity.  For the Internet,\n   an example of an existing effort that could be\
    \ leveraged to provide\n   the supporting PKI could be the American Registry for\
    \ Internet\n   Numbers (ARIN) and the Regional Internet Registry's (RIR's) PKI\n\
    \   hierarchy.  Security and privacy considerations related to\n   consortiums\
    \ are discussed in Sections 6.5 and 6.6.\n"
- title: 6.3.  Transport Communication
  contents:
  - "6.3.  Transport Communication\n   Out-of-band communications dedicated to NP\
    \ interaction for RID\n   messaging would provide additional security as well\
    \ as guaranteed\n   bandwidth during a denial-of-service attack.  For example,\
    \ an out-of-\n   band channel may consist of logical paths defined over the existing\n\
    \   network.  Out-of-band communications may not be possible between all\n   network\
    \ providers, but should be considered to protect the network\n   management systems\
    \ used for RID messaging.  Methods to protect the\n   data transport may also\
    \ be provided through session encryption.\n   In order to address the integrity\
    \ and authenticity of messages,\n   transport encryption MUST be used to secure\
    \ the traffic sent between\n   RID systems.  Systems with predefined relationships\
    \ for RID would\n   include those who peer within a consortium with agreed-upon\n\
    \   appropriate use regulations and for peering consortiums.  Trust\n   relationships\
    \ may also be defined through a bridged or hierarchical\n   PKI in which both\
    \ peers belong.\n   Systems used to send authenticated RID messages between networks\
    \ MUST\n   use a secured system and interface to connect to a border network's\n\
    \   RID systems.  Each connection to a RID system MUST meet the security\n   requirements\
    \ agreed upon through the consortium regulations, peering,\n   or SLAs.  The RID\
    \ system MUST only listen for and send RID messages\n   on the designated port,\
    \ which also MUST be over an encrypted tunnel\n   meeting the minimum requirement\
    \ of algorithms and key lengths\n   established by the consortium, peering, or\
    \ SLA.  The selected\n   cryptographic algorithms for symmetric encryption, digital\n\
    \   signatures, and hash functions MUST meet minimum security levels of\n   the\
    \ times.  The encryption strength MUST adhere to import and export\n   regulations\
    \ of the involved countries for data exchange.\n"
- title: 6.4.  Authentication of RID Protocol
  contents:
  - "6.4.  Authentication of RID Protocol\n   In order to ensure the authenticity\
    \ of the RID messages, a message\n   authentication scheme is used to secure the\
    \ protocol.  XML security\n   functions utilized in RID require a trust center\
    \ such as a PKI for\n   the distribution of credentials to provide the necessary\
    \ level of\n   security for this protocol.  Layered transport protocols also utilize\n\
    \   encryption and rely on a trust center.  Public key certificate pairs\n   issued\
    \ by a trusted Certification Authority (CA) MAY be used to\n   provide the necessary\
    \ level of authentication and encryption for the\n   RID protocol.  The CA used\
    \ for RID messaging must be trusted by all\n   involved parties and may take advantage\
    \ of similar efforts, such as\n   the Internet2 federated PKI or the ARIN/RIR\
    \ effort to provide a PKI\n   to network providers.  The PKI used for authentication\
    \ would also\n   provide the necessary certificates needed for encryption used\
    \ for the\n   RID transport protocol [RFC6046].\n   The use of pre-shared keys\
    \ may be considered for authentication.  If\n   this option is selected, the specifications\
    \ set forth in \"Pre-Shared\n   Key Ciphersuites for Transport Layer Security\
    \ (TLS)\" [RFC4279] MUST\n   be followed.\n   Hosts receiving a RID message MUST\
    \ be able to verify that the sender\n   of the request is valid and trusted. \
    \ Using digital signatures on a\n   hash of the RID message with an X.509 version\
    \ 3 certificate issued by\n   a trusted party MUST be used to authenticate the\
    \ request.  The X.509\n   version 3 specifications as well as the digital signature\n\
    \   specifications and path validation standards set forth in [RFC5280]\n   MUST\
    \ be followed in order to interoperate with a PKI designed for\n   similar purposes.\
    \  The IODEF specification MUST be followed for\n   digital signatures to provide\
    \ the authentication and integrity\n   aspects required for secure messaging between\
    \ network providers.  The\n   use of digital signatures in RID XML messages MUST\
    \ follow the World\n   Wide Web Consortium (W3C) recommendations for signature\
    \ syntax and\n   processing when either the XML encryption [XMLencrypt] or digital\n\
    \   signature [XMLsig], [RFC3275] is used within a document.  Transport\n   specifications\
    \ are detailed in a separate document [RFC6046].\n   It might be helpful to define\
    \ an extension to the authentication\n   scheme that uses attribute certificates\
    \ [RFC5755] in such a way that\n   an application could automatically determine\
    \ whether human\n   intervention is needed to authorize a request; however, the\n\
    \   specification of such an extension is out of scope for this document.\n"
- title: 6.4.1.  Multi-Hop TraceRequest Authentication
  contents:
  - "6.4.1.  Multi-Hop TraceRequest Authentication\n   Bilateral trust relations between\
    \ network providers ensure the\n   authenticity of requests for TraceRequests\
    \ from immediate peers in\n   the web of networks formed to provide the traceback\
    \ capability.  A\n   network provider several hops into the path of the RID trace\
    \ must\n   trust the information from its own trust relationships as well as the\n\
    \   previous trust relationships in the downstream path.  For practical\n   reasons,\
    \ the NPs may want to prioritize incident handling events\n   based upon the immediate\
    \ peer for a TraceRequest, the originator, and\n   the listed Confidence rating\
    \ for the incident.  In order to provide a\n   higher assurance level of the authenticity\
    \ of the TraceRequest, the\n   originating RID system is included in the TraceRequest\
    \ along with\n   contact information and the information of all RID systems in\
    \ the\n   path the trace has taken.  This information is provided through the\n\
    \   IODEF EventData class nesting the list of systems and contacts\n   involved\
    \ in a trace, while setting the category attribute to\n   \"infrastructure\".\n\
    \   A second measure MUST be taken to ensure the identity of the\n   originating\
    \ RID system.  The originating RID system MUST include a\n   digital signature\
    \ in the TraceRequest sent to all systems in the\n   upstream path.  The digital\
    \ signature from the RID system is\n   performed on the RecordItem class of the\
    \ IODEF following the XML\n   digital signature specifications from W3C [XMLsig]\
    \ using a detached\n   signature.  The signature MUST be passed to all parties\
    \ that receive\n   a TraceRequest, and each party MUST be able to perform full\
    \ path\n   validation on the digital signature.  Full path validation verifies\n\
    \   the chaining relationship to a trusted root and also performs a\n   certificate\
    \ revocation check.  In order to accommodate that\n   requirement, the IP packet\
    \ in the RecordItem data MUST remain\n   unchanged as a request is passed along\
    \ between providers and is the\n   only element for which the signature is applied.\
    \  If additional\n   packets are included in the document at upstream peers, the\
    \ initial\n   packet MUST still remain with the detached signature.  The subsequent\n\
    \   packets may be signed by the peer adding the incident information for\n  \
    \ the investigation.  A second benefit to this requirement is that the\n   integrity\
    \ of the filter used is ensured as it is passed to subsequent\n   NPs in the upstream\
    \ trace of the packet.  The trusted PKI also\n   provides the keys used to digitally\
    \ sign the RecordItem class for\n   TraceRequests to meet the requirement of authenticating\
    \ the original\n   request.  Any host in the path of the trace should be able\
    \ to verify\n   the digital signature using the trusted PKI.\n   In the case in\
    \ which an enterprise network using RID sends a\n   TraceRequest to its provider,\
    \ the signature from the enterprise\n   network MUST be included in the initial\
    \ request.  The NP may generate\n   a new request to send upstream to members\
    \ of the NP consortium to\n   continue the trace.  If the original request is\
    \ sent, the originating\n   NP, acting on behalf of the enterprise network under\
    \ attack, MUST\n   also digitally sign, with an enveloped signature, the full\
    \ IODEF\n   document to assure the authenticity of the TraceRequest.  An NP that\n\
    \   offers RID as a service may be using its own PKI to secure RID\n   communications\
    \ between its RID system and the attached enterprise\n   networks.  NPs participating\
    \ in the trace MUST be able to determine\n   the authenticity of RID requests.\n"
- title: 6.5.  Consortiums and Public Key Infrastructures
  contents:
  - "6.5.  Consortiums and Public Key Infrastructures\n   Consortiums of NPs are an\
    \ ideal way to establish a communication web\n   of trust for RID messaging. \
    \ The consortium could provide centralized\n   resources, such as a PKI, and established\
    \ guidelines for use of the\n   RID protocol.  The consortium would also assist\
    \ in establishing trust\n   relationships between the participating NPs to achieve\
    \ the necessary\n   level of cooperation and experience-sharing among the consortium\n\
    \   entities.  This may be established through PKI certificate policy\n   [RFC3647]\
    \ reviews to determine the appropriate trust levels between\n   organizations\
    \ or entities.  The consortium may also be used for other\n   purposes to better\
    \ facilitate communication among NPs in a common\n   area (Internet, region, government,\
    \ education, private networks,\n   etc.).\n   Using a PKI to distribute certificates\
    \ used by RID systems provides\n   an already established method to link trust\
    \ relationships between NPs\n   of consortiums that would peer with NPs belonging\
    \ to a separate\n   consortium.  In other words, consortiums could peer with other\n\
    \   consortiums to enable communication of RID messages between the\n   participating\
    \ NPs.  The PKI along with Memorandums of Agreement could\n   be used to link\
    \ border directories to share public key information in\n   a bridge, a hierarchy,\
    \ or a single cross-certification relationship.\n   Consortiums also need to establish\
    \ guidelines for each participating\n   NP to adhere to.  The RECOMMENDED guidelines\
    \ include:\n   o  Physical and logical practices to protect RID systems;\n   o\
    \  Network and application layer protection for RID systems and\n      communications;\n\
    \   o  Proper use guidelines for RID systems, messages, and requests; and\n  \
    \ o  A PKI to provide authentication, integrity, and privacy.\n   The functions\
    \ described for a consortium's role would parallel that\n   of a PKI federation.\
    \  The PKI federations that currently exist are\n   responsible for establishing\
    \ security guidelines and PKI trust\n   models.  The trust models are used to\
    \ support applications to share\n   information using trusted methods and protocols.\n\
    \   A PKI can also provide the same level of security for communication\n   between\
    \ an end entity (enterprise, educational, or government\n   customer network)\
    \ and the NP.  The PKI may be a subordinate CA or in\n   the CA hierarchy from\
    \ the NP's consortium to establish the trust\n   relationships necessary as the\
    \ request is made to other connected\n   networks.\n"
- title: 6.6.  Privacy Concerns and System Use Guidelines
  contents:
  - "6.6.  Privacy Concerns and System Use Guidelines\n   Privacy issues raise many\
    \ concerns when information-sharing is\n   required to achieve the goal of stopping\
    \ or mitigating the effects of\n   a security incident.  The RIDPolicy class is\
    \ used to automate the\n   enforcement of the privacy concerns listed within this\
    \ document.  The\n   privacy and system use concerns that MUST be addressed in\
    \ the RID\n   system and other integrated components include the following:\n\
    \   Network Provider Concerns:\n   o  Privacy of data monitored and/or stored\
    \ on IDSs for attack\n      detection.\n   o  Privacy of data monitored and stored\
    \ on systems used to trace\n      traffic across a single network.\n   Customer\
    \ Attached Networks Participating in RID with NP:\n   o  Customer networks may\
    \ include an enterprise, educational,\n      government, or other attached networks\
    \ to an NP participating in\n      RID and MUST be made fully aware of the security\
    \ and privacy\n      considerations for using RID.\n   o  Customers MUST know\
    \ the security and privacy considerations in\n      place by their NP and the\
    \ consortium of which the NP is a member.\n   o  Customers MUST understand that\
    \ their data can and will be sent to\n      other NPs in order to complete a trace\
    \ unless an agreement stating\n      otherwise is made in the service level agreements\
    \ between the\n      customer and NP.\n   Parties Involved in the Attack:\n  \
    \ o  Privacy of the identity of a host involved in an attack.\n   o  Privacy of\
    \ information such as the source and destination used for\n      communication\
    \ purposes over the monitored or RID connected\n      network(s).\n   o  Protection\
    \ of data from being viewed by intermediate parties in\n      the path of an Investigation\
    \ request MUST be considered.\n   Consortium Considerations:\n   o  System use\
    \ restricted to security incident handling within the\n      local region's definitions\
    \ of appropriate traffic for the network\n      monitored and linked via RID in\
    \ a single consortium also abiding\n      by the consortium's use guidelines.\n\
    \   o  System use prohibiting the consortium's participating NPs from\n      inappropriately\
    \ tracing non-attack traffic to locate sources or\n      mitigate traffic unlawfully\
    \ within the jurisdiction or region.\n   Inter-Consortium Considerations:\n  \
    \ o  System use between peering consortiums MUST also adhere to any\n      government\
    \ communication regulations that apply between those two\n      regions, such\
    \ as encryption export and import restrictions.  This\n      may include consortiums\
    \ that are categorized as\n      \"BetweenConsortiums\" or \"AcrossNationalBoundaries\"\
    .\n   o  System use between consortiums MUST NOT request traffic traces and\n\
    \      actions beyond the scope intended and permitted by law or\n      inter-consortium\
    \ agreements.\n   o  System use between consortiums classified as\n      \"AcrossNationalBoundaries\"\
    \ MUST respect national boundary issues\n      and limit requests to appropriate\
    \ system use and not to achieve\n      their own agenda to limit or restrict traffic\
    \ that is otherwise\n      permitted within the country in which the peering consortium\n\
    \      resides.\n   The security and privacy considerations listed above are for\
    \ the\n   consortiums, NPs, and enterprises to agree upon.  The agreed-upon\n\
    \   policies may be facilitated through use of the RIDPolicy class.  Some\n  \
    \ privacy considerations are addressed through the RID guidelines for\n   encryption\
    \ and digital signatures as described at the beginning of\n   Section 6.\n   RID\
    \ is useful in determining the true source of a packet that\n   traverses multiple\
    \ networks or to communicate security incidents and\n   automate the response.\
    \  The information obtained from the trace may\n   determine the identity of the\
    \ source host or the network provider\n   used by the source of the traffic. \
    \ It should be noted that the trace\n   mechanism used across a single-network\
    \ provider may also raise\n   privacy concerns for the clients of the network.\
    \  Methods that may\n   raise concern include those that involve storing packets\
    \ for some\n   length of time in order to trace packets after the fact.  Monitoring\n\
    \   networks for intrusions and for tracing capabilities also raises\n   concerns\
    \ for potentially sensitive valid traffic that may be\n   traversing the monitored\
    \ network.  IDSs and single-network tracing\n   are outside of the scope of this\
    \ document, but the concern should be\n   noted and addressed within the use guidelines\
    \ of the network.  Some\n   IDSs and single-network trace mechanisms attempt to\
    \ properly address\n   these issues.  RID is designed to provide the information\
    \ needed by\n   any single-network trace mechanism.  The provider's choice of\
    \ a\n   single trace mechanism depends on resources, existing solutions, and\n\
    \   local legislation.  Privacy concerns in regard to the single-network\n   trace\
    \ must be dealt with at the client-to-NP level and are out of\n   scope for RID\
    \ messaging.\n   The identity of the true source of an attack packet being traced\n\
    \   through RID could be sensitive.  The true identity listed in a Result\n  \
    \ message can be protected through the use of encryption [XMLencrypt]\n   enveloping\
    \ the IODEF document and RID Result information, using the\n   public encryption\
    \ key of the originating NP.  Alternatively, the\n   action taken may be listed\
    \ without the identity being revealed to the\n   originating NP.  The ultimate\
    \ goal of the RID communication system is\n   to stop or mitigate attack traffic,\
    \ not to ensure that the identity\n   of the attack traffic is known to involved\
    \ parties.  The NP that\n   identifies the source should deal directly with the\
    \ involved parties\n   and proper authorities in order to determine the guidelines\
    \ for the\n   release of such information, if it is regarded as sensitive.  In\
    \ some\n   situations, systems used in attacks are compromised by an unknown\n\
    \   source and, in turn, are used to attack other systems.  In that\n   situation,\
    \ the reputation of a business or organization may be at\n   stake, and the action\
    \ taken may be the only additional information\n   reported in the Result message\
    \ to the originating system.  If the\n   security incident is a minor incident,\
    \ such as a zombie system used\n   in part of a large-scale DDoS attack, ensuring\
    \ the system is taken\n   off the network until it has been fixed may be sufficient.\
    \  The\n   decision is left to the system users and consortiums to determine\n\
    \   appropriate data to be shared given that the goal of the\n   specification\
    \ is to provide the appropriate technical options to\n   remain compliant.  The\
    \ textual descriptions should include details of\n   the incident in order to\
    \ protect the reputation of the unknowing\n   attacker and prevent the need for\
    \ additional investigation.  Local,\n   state, or national laws may dictate the\
    \ appropriate reporting action\n   for specific security incidents.\n   Privacy\
    \ becomes an issue whenever sensitive data traverses a network.\n   For example,\
    \ if an attack occurred between a specific source and\n   destination, then every\
    \ network provider in the path of the trace\n   would become aware that the cyber\
    \ attack occurred.  In a targeted\n   attack, it may not be desirable that information\
    \ about two nation\n   states that are battling a cyber war would become general\
    \ knowledge\n   to all intermediate parties.  However, it is important to allow\
    \ the\n   traces to take place in order to halt the activity since the health\n\
    \   of the networks in the path could also be at stake during the attack.\n  \
    \ This provides a second argument for allowing the Result message to\n   only\
    \ include an action taken and not the identity of the offending\n   host.  In\
    \ the case of an Investigation request, where the originating\n   NP is aware\
    \ of the NP that will receive the request for processing,\n   the free-form text\
    \ areas of the document could be encrypted\n   [XMLencrypt] using the public key\
    \ of the destination NP to ensure\n   that no other NP in the path can read the\
    \ contents.  The encryption\n   would be accomplished through the W3C [XMLencrypt]\
    \ specification for\n   encrypting an element.\n   In some situations, all network\
    \ traffic of a nation may be granted\n   through a single network provider.  In\
    \ that situation, options must\n   support sending Result messages from a downstream\
    \ peer of that\n   network provider.  That option provides an additional level\
    \ of\n   abstraction to hide the identity and the NP of the identified source\n\
    \   of the traffic.  Legal action may override this technical decision\n   after\
    \ the trace has taken place, but that is out of the technical\n   scope of this\
    \ document.\n   Privacy concerns when using an Investigation request to request\n\
    \   action close to the source of valid attack traffic needs to be\n   considered.\
    \  Although the intermediate NPs may relay the request if\n   there is no direct\
    \ trust relationship to the closest NP to the\n   source, the intermediate NPs\
    \ do not require the ability to see the\n   contents of the packet or the text\
    \ description field(s) in the\n   request.  This message type does not require\
    \ any action by the\n   intermediate RID systems, except to relay the packet to\
    \ the next NP\n   in the path.  Therefore, the contents of the request may be\
    \ encrypted\n   for the destination system.  The intermediate NPs would only need\
    \ to\n   know how to direct the request to the manager of the ASN in which the\n\
    \   source IP address belongs.\n   Traces must be legitimate security-related\
    \ incidents and not used for\n   purposes such as sabotage or censorship.  An\
    \ example of such abuse of\n   the system would include a request to block or\
    \ rate-limit legitimate\n   traffic to prevent information from being shared between\
    \ users on the\n   Internet (restricting access to online versions of papers)\
    \ or\n   restricting access from a competitor's product in order to sabotage a\n\
    \   business.\n   Intra-consortium RID communications raise additional issues,\n\
    \   especially when the peering consortiums reside in different regions\n   or\
    \ nations.  TraceRequests and requested actions to mitigate traffic\n   must adhere\
    \ to the appropriate use guidelines and yet prevent abuse\n   of the system. \
    \ First, the peering consortiums MUST identify the\n   types of traffic that can\
    \ be traced between the borders of the\n   participating NPs of each consortium.\
    \  The traffic traced should be\n   limited to security-incident-related traffic.\
    \  Second, the traces\n   permitted within one consortium if passed to a peering\
    \ consortium may\n   infringe upon the peering consortium's freedom of information\
    \ laws.\n   An example would be a consortium in one country permitting a trace\
    \ of\n   traffic containing objectionable material, outlawed within that\n   country.\
    \  The RID trace may be a valid use of the system within the\n   confines of that\
    \ country's network border; however, it may not be\n   permitted to continue across\
    \ network boundaries where such content is\n   permitted under law.  By continuing\
    \ the trace in another country's\n   network, the trace and response could have\
    \ the effect of improperly\n   restricting access to data.  A continued trace\
    \ into a second country\n   may break the laws and regulations of that nation.\
    \  Any such traces\n   MUST cease at the country's border.\n   The privacy concerns\
    \ listed in this section address issues among the\n   trusted parties involved\
    \ in a trace within an NP, a RID consortium,\n   and peering RID consortiums.\
    \  Data used for RID communications must\n   also be protected from parties that\
    \ are not trusted.  This protection\n   is provided through the authentication\
    \ and encryption of documents as\n   they traverse the path of trusted servers.\
    \  Each RID system MUST\n   perform a bi-directional authentication when sending\
    \ a RID message\n   and use the public encryption key of the upstream or downstream\
    \ peer\n   to send a message or document over the network.  This means that the\n\
    \   document is decrypted and re-encrypted at each RID system via TLS\n   over\
    \ the transport protocol [RFC6046].  The RID messages may be\n   decrypted at\
    \ each RID system in order to properly process the request\n   or relay the information.\
    \  Today's processing power is more than\n   sufficient to handle the minimal\
    \ burden of encrypting and decrypting\n   relatively small typical RID messages.\n"
- title: 7.  IANA Considerations
  contents:
  - "7.  IANA Considerations\n   This document uses URNs to describe XML namespaces\
    \ and XML schemas\n   [XMLschema] conforming to a registry mechanism described\
    \ in\n   [RFC3688].\n   Registration request for the iodef-rid namespace:\n  \
    \ URI: urn:ietf:params:xml:ns:iodef-rid-1.0\n   Registrant Contact: See the \"\
    Author's Address\" section of this\n   document.\n   XML: None.  Namespace URIs\
    \ do not represent an XML specification.\n   Registration request for the iodef-rid\
    \ XML schema:\n   URI: urn:ietf:params:xml:schema:iodef-rid-1.0\n   Registrant\
    \ Contact: See the \"Author's Address\" section of this\n   document.\n   XML:\
    \ See Section 5, \"RID Schema Definition\", of this document.\n"
- title: 8.  Summary
  contents:
  - "8.  Summary\n   Security incidents have always been difficult to trace as a result\
    \ of\n   the spoofed sources, resource limitations, and bandwidth utilization\n\
    \   problems.  Incident response is often slow even when the IP address\n   is\
    \ known to be valid because of the resources required to notify the\n   responsible\
    \ party of the attack and then to stop or mitigate the\n   attack traffic.  Methods\
    \ to identify and trace attacks near real time\n   are essential to thwarting\
    \ attack attempts.  Network providers need\n   policies and automated methods\
    \ to combat the hacker's efforts.  NPs\n   need automated monitoring and response\
    \ capabilities to identify and\n   trace attacks quickly without resource-intensive\
    \ side effects.\n   Integration with a centralized communication system to coordinate\
    \ the\n   detection, tracing, and identification of attack sources on a single\n\
    \   network is essential.  RID provides a way to integrate NP resources\n   for\
    \ each aspect of attack detection, tracing, and source\n   identification and\
    \ extends the communication capabilities among\n   network providers.  The communication\
    \ is accomplished through the use\n   of flexible IODEF XML-based documents passed\
    \ between IHSs or RID\n   systems.  A TraceRequest or Investigation request is\
    \ communicated to\n   an upstream NP and may result in an upstream trace or in\
    \ an action to\n   stop or mitigate the attack traffic.  The messages are communicated\n\
    \   among peers with security inherent to the RID messaging scheme\n   provided\
    \ through existing standards such as XML encryption and\n   digital signatures.\
    \  Policy information is carried in the RID message\n   itself through the use\
    \ of the RIDPolicy.  RID provides the timely\n   communication among NPs, which\
    \ is essential for incident handling.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC2119]      Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                  Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC3275]      Eastlake 3rd, D., Reagle, J., and D. Solo,\n\
    \                  \"(Extensible Markup Language) XML-Signature Syntax and\n \
    \                 Processing\", RFC 3275, March 2002.\n   [RFC3688]      Mealling,\
    \ M., \"The IETF XML Registry\", BCP 81, RFC\n                  3688, January\
    \ 2004.\n   [RFC4279]      Eronen, P., Ed., and H. Tschofenig, Ed., \"Pre-Shared\n\
    \                  Key Ciphersuites for Transport Layer Security (TLS)\",\n  \
    \                RFC 4279, December 2005.\n   [RFC5070]      Danyliw, R., Meijer,\
    \ J., and Y. Demchenko, \"The\n                  Incident Object Description Exchange\
    \ Format\", RFC\n                  5070, December 2007.\n   [RFC5280]      Cooper,\
    \ D., Santesson, S., Farrell, S., Boeyen, S.,\n                  Housley, R.,\
    \ and W. Polk, \"Internet X.509 Public Key\n                  Infrastructure Certificate\
    \ and Certificate Revocation\n                  List (CRL) Profile\", RFC 5280,\
    \ May 2008.\n   [RFC5755]      Farrell, S., Housley, R., and S. Turner, \"An Internet\n\
    \                  Attribute Certificate Profile for Authorization\",\n      \
    \            RFC 5755, January 2010.\n   [RFC6046]      Moriarty, K. and B. Trammell,\
    \ \"Transport of Real-Time\n                  Inter-Network Defense (RID) Messages,\"\
    \ RFC 6046,\n                  November 2010.\n   [XML1.0]       \"Extensible\
    \ Markup Language (XML) 1.0 (Second\n                  Edition)\".  W3C Recommendation.\
    \  T. Bray, E. Maler, J.\n                  Paoli, and C.M. Sperberg-McQueen.\
    \  October 2000.\n                  http://www.w3.org/TR/2000/REC-xml-20001006.\n\
    \   [XMLnames]     \"Namespaces in XML 1.0 (Third Edition)\".  W3C\n         \
    \         Recommendation.  T. Bray, D. Hollander, A. Layman, R.\n            \
    \      Tobin, H. Thompson.  December 2009.\n                  http://www.w3.org/TR/REC-xml-names/.\n\
    \   [XMLencrypt]   \"XML Encryption Syntax and Processing\".  W3C\n          \
    \        Recommendation.  T. Imamura, B. Dillaway, and E.\n                  Simon.\
    \  December 2002.\n                  http://www.w3.org/TR/xmlenc-core/.\n   [XMLschema]\
    \    \"XML Schema\".  E. Van der Vlist.  O'Reilly.  2002.\n   [XMLsig]       \"\
    XML-Signature Syntax and Processing (Second\n                  Edition)\".  W3C\
    \ Recommendation.  M. Bartel, J. Boyer,\n                  B. Fox, B. LaMacchia,\
    \ and E. Simon.  June 2008.\n                  http://www.w3.org/TR/xmldsig-core/#sec-Design.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [RFC1930]      Hawkinson, J. and T. Bates, \"\
    Guidelines for creation,\n                  selection, and registration of an\
    \ Autonomous System\n                  (AS)\", BCP 6, RFC 1930, March 1996.\n\
    \   [RFC2827]      Ferguson, P. and D. Senie, \"Network Ingress Filtering:\n \
    \                 Defeating Denial of Service Attacks which employ IP\n      \
    \            Source Address Spoofing\", BCP 38, RFC 2827, May 2000.\n   [RFC3647]\
    \      Chokhani, S., Ford, W., Sabett, R., Merrill, C., and\n                \
    \  S. Wu, \"Internet X.509 Public Key Infrastructure\n                  Certificate\
    \ Policy and Certification Practices\n                  Framework\", RFC 3647,\
    \ November 2003.\n   [RFC3917]      Quittek, J., Zseby, T., Claise, B., and S.\
    \ Zander,\n                  \"Requirements for IP Flow Information Export (IPFIX)\"\
    ,\n                  RFC 3917, October 2004.\n   [RFC5735]      Cotton, M. and\
    \ L. Vegoda, \"Special Use IPv4\n                  Addresses\", BCP 153, RFC 5735,\
    \ January 2010.\n   [IPtrace]      \"Advanced and Authenticated Marking Schemes\
    \ for IP\n                  Traceback\".  D. Song and A. Perrig.  IEEE INFOCOM\n\
    \                  2001.\n   [HASH-IPtrace] \"Hash-Based IP Traceback\".  A. Snoeren,\
    \ C. Partridge,\n                  L. Sanchez, C. Jones, F. Tchakountio, S. Kent,\
    \ and W.\n                  Strayer.  SIGCOMM'01.  August 2001.\n   [ICMPtrace]\
    \    Bellovin, S., Leech, M., and T. Taylor, \"ICMP\n                  Traceback\
    \ Messages\", Work in Progress, February 2003.\n   [NTWK-IPtrace] \"Practical\
    \ network support for IP traceback\".  S.\n                  Savage, D. Wetherall,\
    \ A. Karlin, and T. Anderson.\n                  SIGCOMM'00.  August 2000.\n \
    \  [DoS]          \"Trends in Denial of Service Attack Technology\".  K.\n   \
    \               Houle, G. Weaver, N. Long, and R. Thomas.  CERT\n            \
    \      Coordination Center.  October 2001.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   Many thanks to coworkers and the Internet community for\
    \ reviewing and\n   commenting on the document as well as providing recommendations\
    \ to\n   simplify and secure the protocol: Robert K. Cunningham, Ph.D, Cynthia\n\
    \   D. McLain, Dr. William Streilein, Iljitsch van Beijnum, Steve\n   Bellovin,\
    \ Yuri Demchenko, Jean-Francois Morfin, Stephen Northcutt,\n   Jeffrey Schiller,\
    \ Brian Trammell, Roman Danyliw, Tony Tauber, and\n   Sandra G. Dykes, Ph.D.\n"
- title: Sponsor Information
  contents:
  - "Sponsor Information\n   This work was sponsored by the Air Force under Air Force\
    \ Contract\n   FA8721-05-C-0002, while working at MIT Lincoln Laboratory.\n  \
    \ \"Opinions, interpretations, conclusions, and recommendations are\n   those\
    \ of the author and are not necessarily endorsed by the United\n   States Government\"\
    .\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Kathleen M. Moriarty\n   RSA, The Security Division of EMC\n\
    \   174 Middlesex Turnpike\n   Bedford, MA  01730\n   US\n   EMail: Moriarty_Kathleen@EMC.com\n"
