- title: __initial_text__
  contents:
  - '                       Mobile IPv6 Fast Handovers

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv6 enables a Mobile Node (MN) to maintain its connectivity\n\
    \   to the Internet when moving from one Access Router to another, a\n   process\
    \ referred to as handover.  During handover, there is a period\n   during which\
    \ the Mobile Node is unable to send or receive packets\n   because of link switching\
    \ delay and IP protocol operations.  This\n   \"handover latency\" resulting from\
    \ standard Mobile IPv6 procedures,\n   namely movement detection, new Care-of\
    \ Address configuration, and\n   Binding Update, is often unacceptable to real-time\
    \ traffic such as\n   Voice over IP (VoIP).  Reducing the handover latency could\
    \ be\n   beneficial to non-real-time, throughput-sensitive applications as\n \
    \  well.  This document specifies a protocol to improve handover latency\n   due\
    \ to Mobile IPv6 procedures.  This document does not address\n   improving the\
    \ link switching latency.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................3\n  \
    \ 3. Protocol Overview ...............................................6\n    \
    \  3.1. Addressing the Handover Latency ............................6\n      3.2.\
    \ Protocol Operation .........................................8\n      3.3. Protocol\
    \ Operation during Network-Initiated Handover ......11\n   4. Protocol Details\
    \ ...............................................11\n   5. Other Considerations\
    \ ...........................................15\n      5.1. Handover Capability\
    \ Exchange ..............................15\n      5.2. Determining New Care-of\
    \ Address ...........................16\n      5.3. Prefix Management .........................................16\n\
    \      5.4. Packet Loss ...............................................17\n  \
    \    5.5. DAD Handling ..............................................18\n    \
    \  5.6. Fast or Erroneous Movement ................................19\n   6. Message\
    \ Formats ................................................20\n      6.1. New Neighborhood\
    \ Discovery Messages .......................20\n           6.1.1. Router Solicitation\
    \ for Proxy Advertisement\n                  (RtSolPr) ..........................................20\n\
    \           6.1.2. Proxy Router Advertisement (PrRtAdv) ...............22\n  \
    \    6.2. Inter - Access Router Messages ............................25\n    \
    \       6.2.1. Handover Initiate (HI) .............................25\n      \
    \     6.2.2. Handover Acknowledge (HAck) ........................27\n      6.3.\
    \ New Mobility Header Messages ..............................28\n           6.3.1.\
    \ Fast Binding Update (FBU) ..........................28\n           6.3.2. Fast\
    \ Binding Acknowledgment (FBack) ................30\n      6.4. Unsolicited Neighbor\
    \ Advertisement (UNA) ..................31\n      6.5. New Options ...............................................32\n\
    \           6.5.1. IP Address/Prefix Option ...........................33\n  \
    \         6.5.2. Link-Layer Address (LLA) Option ....................34\n    \
    \       6.5.3. Mobility Header Link-Layer Address (MH-LLA)\n                 \
    \ Option .............................................35\n           6.5.4. Binding\
    \ Authorization Data for FMIPv6 (BADF) .......35\n           6.5.5. Neighbor Advertisement\
    \ Acknowledgment (NAACK) ......36\n   7. Related Protocol and Device Considerations\
    \ .....................37\n   8. Evolution from and Compatibility with RFC 4068\
    \ .................38\n   9. Configurable Parameters ........................................39\n\
    \   10. Security Considerations .......................................39\n  \
    \    10.1. Peer Authorization Database Entries when Using IKEv2 .....41\n    \
    \  10.2. Security Policy Database Entries .........................42\n   11.\
    \ IANA Considerations ...........................................42\n   12. Acknowledgments\
    \ ...............................................43\n   13. References ....................................................44\n\
    \      13.1. Normative References .....................................44\n  \
    \    13.2. Informative References ...................................45\n   Appendix\
    \ A. Contributors ..........................................46\n   Appendix B.\
    \ Changes since RFC 4068 ................................46\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv6 [RFC3775] describes the protocol operations\
    \ for a mobile\n   node to maintain connectivity to the Internet during its handover\n\
    \   from one access router to another.  These operations involve\n   link-layer\
    \ procedures, movement detection, IP address configuration,\n   and location update.\
    \  The combined handover latency is often\n   sufficient to affect real-time applications.\
    \  Throughput-sensitive\n   applications can also benefit from reducing this latency.\
    \  This\n   document describes a protocol to reduce the handover latency.\n  \
    \ This specification addresses the following problems: how to allow a\n   mobile\
    \ node to send packets as soon as it detects a new subnet link\n   and how to\
    \ deliver packets to a mobile node as soon as its attachment\n   is detected by\
    \ the new access router.  The protocol defines IP\n   protocol messages necessary\
    \ for its operation regardless of link\n   technology.  It does this without depending\
    \ on specific link-layer\n   features while allowing link-specific customizations.\
    \  By definition,\n   this specification considers handovers that interwork with\
    \ Mobile IP.\n   Once attached to its new access router, an MN engages in Mobile\
    \ IP\n   operations including Return Routability [RFC3775].  There are no\n  \
    \ special requirements for a mobile node to behave differently with\n   respect\
    \ to its standard Mobile IP operations.\n   This specification is applicable when\
    \ a mobile node has to perform IP\n   layer operations as a result of handovers.\
    \  This specification does\n   not address improving the link switching latency.\
    \  It does not modify\n   or optimize procedures related to signaling with the\
    \ home agent of a\n   mobile node.  Indeed, while targeted for Mobile IPv6, it\
    \ could be\n   used with any mechanism that allows communication to continue despite\n\
    \   movements.  Finally, this specification does not address bulk\n   movement\
    \ of nodes using aggregate prefixes.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [RFC2119].\n   The use of the term, \"silently ignore\" is not defined\
    \ in RFC 2119.\n   However, the term is used in this document and can be similarly\n\
    \   construed.\n   The following terminology and abbreviations are used in this\
    \ document\n   in addition to those defined in [RFC3775].  The reference handover\n\
    \   scenario is illustrated in Figure 1.\n      v             +--------------+\n\
    \   +-+              |  Previous    |         <\n   | | ------------ |    Access\
    \    | ------- >-----\\\n   +-+              |    Router    |         <      \
    \ \\\n       MN           |    (PAR)     |                  \\\n     |       \
    \       +--------------+             +---------------+\n     |               \
    \      ^              IP     | Correspondent |\n     |                     | \
    \         Network    |  Node         |\n     V                     |         \
    \            +---------------+\n                           v                 \
    \         /\n      v             +--------------+                 /\n   +-+  \
    \            |     New      |         <      /\n   | | ------------ |    Access\
    \    | ------- >-----/\n   +-+              |    Router    |         <\n     \
    \  MN           |    (NAR)     |\n                    +--------------+\n     \
    \     Figure 1: Reference Scenario for Handover\n   Mobile Node (MN): A Mobile\
    \ IPv6 host.\n   Access Point (AP): A Layer 2 device connected to an IP subnet\
    \ that\n   offers wireless connectivity to an MN.  An Access Point Identifier\n\
    \   (AP-ID) refers the AP's L2 address.  Sometimes, AP-ID is also\n   referred\
    \ to as a Basic Service Set IDentifier (BSSID).\n   Access Router (AR): The MN's\
    \ default router.\n   Previous Access Router (PAR): The MN's default router prior\
    \ to its\n   handover.\n   New Access Router (NAR): The MN's anticipated default\
    \ router\n   subsequent to its handover.\n   Previous CoA (PCoA): The MN's Care-of\
    \ Address valid on PAR's subnet.\n   New CoA (NCoA): The MN's Care-of Address\
    \ valid on NAR's subnet.\n   Handover: A process of terminating existing connectivity\
    \ and\n   obtaining new IP connectivity.\n   Router Solicitation for Proxy Advertisement\
    \ (RtSolPr): A message from\n   the MN to the PAR requesting information for a\
    \ potential handover.\n   Proxy Router Advertisement (PrRtAdv): A message from\
    \ the PAR to the\n   MN that provides information about neighboring links facilitating\n\
    \   expedited movement detection.  The message can also act as a trigger\n   for\
    \ network-initiated handover.\n   (AP-ID, AR-Info) tuple: Contains an access router's\
    \ L2 and IP\n   addresses, and prefix valid on the interface to which the Access\n\
    \   Point (identified by AP-ID) is attached.  The triplet [Router's L2\n   address,\
    \ Router's IP address, and Prefix] is called \"AR-Info\".  See\n   Section 5.3.\n\
    \   Neighborhood Discovery: The process of resolving neighborhood AP-IDs\n   to\
    \ AR-Info.\n   Assigned Addressing: A particular type of NCoA configuration in\
    \ which\n   the NAR assigns an IPv6 address for the MN.  The method by which NAR\n\
    \   manages its address pool is not specified in this document.\n   Fast Binding\
    \ Update (FBU): A message from the MN instructing its PAR\n   to redirect its\
    \ traffic (toward NAR).\n   Fast Binding Acknowledgment (FBack): A message from\
    \ the PAR in\n   response to an FBU.\n   Predictive Fast Handover: The fast handover\
    \ in which an MN is able to\n   send an FBU when it is attached to the PAR, which\
    \ then establishes\n   forwarding for its traffic (even before the MN attaches\
    \ to the NAR).\n   Reactive Fast Handover: The fast handover in which an MN is\
    \ able to\n   send the FBU only after attaching to the NAR.\n   Unsolicited Neighbor\
    \ Advertisement (UNA): The message in [RFC4861]\n   with 'O' bit cleared.\n  \
    \ Fast Neighbor Advertisement (FNA): This message from RFC 4068\n   [RFC4068]\
    \ is deprecated.  The UNA message above is the preferred\n   message in this specification.\n\
    \   Handover Initiate (HI): A message from the PAR to the NAR regarding\n   an\
    \ MN's handover.\n   Handover Acknowledge (HAck): A message from the NAR to the\
    \ PAR as a\n   response to HI.\n"
- title: 3.  Protocol Overview
  contents:
  - '3.  Protocol Overview

    '
- title: 3.1.  Addressing the Handover Latency
  contents:
  - "3.1.  Addressing the Handover Latency\n   The ability to immediately send packets\
    \ from a new subnet link\n   depends on the \"IP connectivity\" latency, which\
    \ in turn depends on\n   the movement detection latency and the new CoA configuration\
    \ latency.\n   Once an MN is IP-capable on the new subnet link, it can send a\n\
    \   Binding Update to its Home Agent and one or more correspondents.\n   Once\
    \ its correspondents process the Binding Update successfully,\n   which typically\
    \ involves the Return Routability procedure, the MN can\n   receive packets at\
    \ the new CoA.  So, the ability to receive packets\n   from correspondents directly\
    \ at its new CoA depends on the Binding\n   Update latency as well as the IP connectivity\
    \ latency.\n   The protocol enables an MN to quickly detect that it has moved\
    \ to a\n   new subnet by providing the new access point and the associated\n \
    \  subnet prefix information when the MN is still connected to its\n   current\
    \ subnet (i.e., PAR in Figure 1).  For instance, an MN may\n   discover available\
    \ access points using link-layer specific mechanisms\n   (e.g., a \"scan\" in\
    \ Wireless Local Area Network (WLAN)) and then\n   request subnet information\
    \ corresponding to one or more of those\n   discovered access points.  The MN\
    \ may do this after performing router\n   discovery or at any time while connected\
    \ to its current router.  The\n   result of resolving an identifier associated\
    \ with an access point is\n   a [AP-ID, AR-Info] tuple, which an MN can use in\
    \ readily detecting\n   movement.  When attachment to an access point with AP-ID\
    \ takes place,\n   the MN knows the corresponding new router's coordinates including\
    \ its\n   prefix, IP address, and L2 address.  The \"Router Solicitation for\n\
    \   Proxy Advertisement (RtSolPr)\" and \"Proxy Router Advertisement\n   (PrRtAdv)\"\
    \ messages in Section 6.1 are used for aiding movement\n   detection.\n   Through\
    \ the RtSolPr and PrRtAdv messages, the MN also formulates a\n   prospective new\
    \ CoA (NCoA) when it is still present on the PAR's\n   link.  Hence, the latency\
    \ due to new prefix discovery subsequent to\n   handover is eliminated.  Furthermore,\
    \ this prospective address can be\n   used immediately after attaching to the\
    \ new subnet link (i.e., NAR's\n   link) when the MN has received a \"Fast Binding\
    \ Acknowledgment\n   (FBack)\" (see Section 6.3.2) message prior to its movement.\
    \  In the\n   event it moves without receiving an FBack, the MN can still start\n\
    \   using NCoA after announcing its attachment through an unsolicited\n   Neighbor\
    \ Advertisement message (with the 'O' bit set to zero)\n   [RFC4861]; NAR responds\
    \ to this UNA message in case it wishes to\n   provide a different IP address\
    \ to use.  In this way, NCoA\n   configuration latency is reduced.\n   The information\
    \ provided in the PrRtAdv message can be used even when\n   DHCP [RFC3315] is\
    \ used to configure an NCoA on the NAR's link.  In\n   this case, the protocol\
    \ supports forwarding using PCoA, and the MN\n   performs DHCP once it attaches\
    \ to the NAR's link.  The MN still\n   formulates an NCoA for FBU processing;\
    \ however, it MUST NOT send data\n   packets using the NCoA in the FBU.\n   In\
    \ order to reduce the Binding Update latency, the protocol specifies\n   a binding\
    \ between the Previous CoA (PCoA) and NCoA.  An MN sends a\n   \"Fast Binding\
    \ Update\" (see Section 6.3.1) message to its Previous\n   Access Router to establish\
    \ this tunnel.  When feasible, the MN SHOULD\n   send an FBU from the PAR's link.\
    \  Otherwise, the MN should send the\n   FBU immediately after detecting attachment\
    \ to the NAR.  An FBU\n   message MUST contain the Binding Authorization Data\
    \ for FMIPv6 (BADF)\n   option (see Section 6.5.4) in order to ensure that only\
    \ a legitimate\n   MN that owns the PCoA is able to establish a binding.  Subsequent\n\
    \   sections describe the protocol mechanics.  In any case, the result is\n  \
    \ that the PAR begins tunneling packets arriving for PCoA to NCoA.\n   Such a\
    \ tunnel remains active until the MN completes the Binding\n   Update with its\
    \ correspondents.  In the opposite direction, the MN\n   SHOULD reverse tunnel\
    \ packets to the PAR, again until it completes\n   Binding Update.  And, PAR MUST\
    \ forward the inner packet in the tunnel\n   to its destination (i.e., to the\
    \ MN's correspondent).  Such a reverse\n   tunnel ensures that packets containing\
    \ a PCoA as a source IP address\n   are not dropped due to ingress filtering.\
    \  Even though the MN is\n   IP-capable on the new link, it cannot use the NCoA\
    \ directly with its\n   correspondents without the correspondents first establishing\
    \ a\n   binding cache entry (for the NCoA).  Forwarding support for the PCoA\n\
    \   is provided through a reverse tunnel between the MN and the PAR.\n   Setting\
    \ up a tunnel alone does not ensure that the MN receives\n   packets as soon as\
    \ it is attached to a new subnet link, unless the\n   NAR can detect the MN's\
    \ presence.  A neighbor discovery operation\n   involving a neighbor's address\
    \ resolution (i.e., Neighbor\n   Solicitation and Neighbor Advertisement) typically\
    \ results in\n   considerable delay, sometimes lasting multiple seconds.  For\n\
    \   instance, when arriving packets trigger the NAR to send Neighbor\n   Solicitation\
    \ before the MN attaches, subsequent retransmissions of\n   address resolution\
    \ are separated by a default period of one second\n   each.  In order to circumvent\
    \ this delay, an MN announces its\n   attachment immediately with an UNA message\
    \ that allows the NAR to\n   forward packets to the MN right away.  Through tunnel\
    \ establishment\n   for PCoA and fast advertisement, the protocol provides expedited\n\
    \   forwarding of packets to the MN.\n   The protocol also provides the following\
    \ important functionalities.\n   The access routers can exchange messages to confirm\
    \ that a proposed\n   NCoA is acceptable.  For instance, when an MN sends an FBU\
    \ from the\n   PAR's link, FBack can be delivered after the NAR considers the\
    \ NCoA\n   acceptable for use.  This is especially useful when addresses are\n\
    \   assigned by the access router.  The NAR can also rely on its trust\n   relationship\
    \ with the PAR before providing forwarding support for the\n   MN.  That is, it\
    \ may create a forwarding entry for the NCoA, subject\n   to \"approval\" from\
    \ the PAR, which it trusts.  In addition, buffering\n   for handover traffic at\
    \ the NAR may be desirable.  Even though the\n   Neighbor Discovery protocol provides\
    \ a small buffer (typically one or\n   two packets) for packets awaiting address\
    \ resolution, this buffer may\n   be inadequate for traffic, such as VoIP, already\
    \ in progress.  The\n   routers may also wish to maintain a separate buffer for\
    \ servicing the\n   handover traffic.  Finally, the access routers could transfer\n\
    \   network-resident contexts, such as access control, Quality of Service\n  \
    \ (QoS), and header compression, in conjunction with handover (although\n   the\
    \ context transfer process itself is not specified in this\n   document).  For\
    \ all these operations, the protocol provides \"Handover\n   Initiate (HI)\" and\
    \ \"Handover Acknowledge (HAck)\" messages (see\n   Section 6.2).  Both of these\
    \ messages SHOULD be used.  The access\n   routers MUST have the necessary security\
    \ association established by\n   means outside the scope of this document.\n"
- title: 3.2.  Protocol Operation
  contents:
  - "3.2.  Protocol Operation\n   The protocol begins when an MN sends an RtSolPr\
    \ message to its access\n   router to resolve one or more Access Point Identifiers\
    \ to\n   subnet-specific information.  In response, the access router (e.g.,\n\
    \   PAR in Figure 1) sends a PrRtAdv message containing one or more\n   [AP-ID,\
    \ AR-Info] tuples.  The MN may send an RtSolPr at any\n   convenient time, for\
    \ instance as a response to some link-specific\n   event (a \"trigger\") or simply\
    \ after performing router discovery.\n   However, the expectation is that prior\
    \ to sending an RtSolPr, the MN\n   will have discovered the available APs by\
    \ link-specific methods.  The\n   RtSolPr and PrRtAdv messages do not establish\
    \ any state at the access\n   router; their packet formats are defined in Section\
    \ 6.1.\n   With the information provided in the PrRtAdv message, the MN\n   formulates\
    \ a prospective NCoA and sends an FBU message to the PAR.\n   The purpose of the\
    \ FBU is to authorize the PAR to bind the PCoA to\n   the NCoA, so that arriving\
    \ packets can be tunneled to the new\n   location of the MN.  The FBU should be\
    \ sent from the PAR's link\n   whenever feasible.  For instance, an internal link-specific\
    \ trigger\n   could enable FBU transmission from the previous link.\n   When it\
    \ is not feasible, the FBU is sent from the new link.\n   The format and semantics\
    \ of FBU processing are specified in Section\n   6.3.1.  The FBU message MUST\
    \ contain the BADF option (see Section\n   6.5.4) to secure the message.\n   Depending\
    \ on whether an FBack is received on the previous link (which\n   clearly depends\
    \ on whether the FBU was sent in the first place),\n   there are two modes of\
    \ operation.\n      1.  The MN receives FBack on the previous link.  This means\
    \ that\n          packet tunneling is already in progress by the time the MN\n\
    \          handovers to the NAR.  The MN SHOULD send the UNA immediately\n   \
    \       after attaching to the NAR, so that arriving as well as\n          buffered\
    \ packets can be forwarded to the MN right away.\n          Before sending FBack\
    \ to the MN, the PAR can determine whether\n          the NCoA is acceptable to\
    \ the NAR through the exchange of HI\n          and HAck messages.  When assigned\
    \ addressing (i.e., addresses\n          are assigned by the router) is used,\
    \ the proposed NCoA in the\n          FBU is carried in an HI message (from PAR\
    \ to NAR), and NAR MAY\n          assign the proposed NCoA.  Such an assigned\
    \ NCoA MUST be\n          returned in HAck (from NAR to PAR), and PAR MUST in\
    \ turn\n          provide the assigned NCoA in FBack.  If there is an assigned\n\
    \          NCoA returned in FBack, the MN MUST use the assigned address\n    \
    \      (and not the proposed address in FBU) upon attaching to NAR.\n      2.\
    \  The MN does not receive the FBack on the previous link because\n          the\
    \ MN has not sent the FBU or the MN has left the link after\n          sending\
    \ the FBU (which itself may be lost), but before\n          receiving an FBack.\
    \  Without receiving an FBack in the latter\n          case, the MN cannot ascertain\
    \ whether the PAR has processed\n          the FBU successfully.  Hence, the MN\
    \ (re)sends the FBU message\n          to the PAR immediately after sending the\
    \ UNA message.  If the\n          NAR chooses to supply a different IP address\
    \ to use than the\n          NCoA, it MAY send a Router Advertisement with \"\
    Neighbor\n          Advertisement Acknowledge (NAACK)\" option in which it includes\n\
    \          an alternate IP address for the MN to use.  Detailed UNA\n        \
    \  processing rules are specified in Section 6.4.\n   The scenario in which an\
    \ MN sends an FBU and receives an FBack on\n   PAR's link is illustrated in Figure\
    \ 2.  For convenience, this\n   scenario is characterized as the \"predictive\"\
    \ mode of operation.  The\n   scenario in which the MN sends an FBU from the NAR's\
    \ link is\n   illustrated in Figure 3.  For convenience, this scenario is\n  \
    \ characterized as the \"reactive\" mode of operation.  Note that the\n   reactive\
    \ mode also includes the case in which an FBU has been sent\n   from the PAR's\
    \ link but an FBack has not yet been received.  The\n   figure is intended to\
    \ illustrate that the FBU is forwarded through\n   the NAR, but it is processed\
    \ only by the PAR.\n       MN                    PAR                    NAR\n\
    \        |                     |                      |\n        |------RtSolPr------->|\
    \                      |\n        |<-----PrRtAdv--------|                    \
    \  |\n        |                     |                      |\n        |------FBU----------->|----------HI--------->|\n\
    \        |                     |<--------HAck---------|\n        |          <--FBack---|--FBack--->\
    \           |\n        |                     |                      |\n     disconnect\
    \             forward                  |\n        |                   packets\
    \  ===============>|\n        |                     |                      |\n\
    \        |                     |                      |\n   connect          \
    \          |                      |\n        |                     |         \
    \             |\n        |------------UNA --------------------------->|\n    \
    \    |<=================================== deliver packets\n        |        \
    \                                    |\n            Figure 2: Predictive Fast\
    \ Handover\n     MN                    PAR                    NAR\n      |   \
    \                  |                      |\n      |------RtSolPr------->|   \
    \                   |\n      |<-----PrRtAdv--------|                      |\n\
    \      |                     |                      |\n   disconnect         \
    \      |                      |\n      |                     |               \
    \       |\n      |                     |                      |\n   connect  \
    \                |                      |\n      |-------UNA-----------|--------------------->|\n\
    \      |-------FBU-----------|---------------------)|\n      |               \
    \      |<-------FBU----------)|\n      |                     |----------HI--------->|\n\
    \      |                     |<-------HAck----------|\n      |               \
    \      |(HI/HAck if necessary)|\n      |                   forward           \
    \       |\n      |              packets(including FBAck)=====>|\n      |     \
    \                |                      |\n      |<===================================\
    \ deliver packets\n      |                                            |\n    \
    \        Figure 3: Reactive Fast Handover\n   Finally, the PrRtAdv message may\
    \ be sent unsolicited, i.e., without\n   the MN first sending an RtSolPr.  This\
    \ mode is described in Section\n   3.3.\n"
- title: 3.3.  Protocol Operation during Network-Initiated Handover
  contents:
  - "3.3.  Protocol Operation during Network-Initiated Handover\n   In some wireless\
    \ technologies, the handover control may reside in the\n   network even though\
    \ the decision to undergo handover may be mutually\n   arrived at between the\
    \ MN and the network.  In such networks, the PAR\n   can send an unsolicited PrRtAdv\
    \ containing the link-layer address, IP\n   address, and subnet prefix of the\
    \ NAR when the network decides that a\n   handover is imminent.  The MN MUST process\
    \ this PrRtAdv to configure\n   a new Care-of Address on the new subnet, and MUST\
    \ send an FBU to the\n   PAR prior to switching to the new link.  After transmitting\
    \ PrRtAdv,\n   the PAR MUST continue to forward packets to the MN on its current\n\
    \   link until the FBU is received.  The rest of the operation is the\n   same\
    \ as that described in Section 3.2.\n   The unsolicited PrRtAdv also allows the\
    \ network to inform the MN\n   about geographically adjacent subnets without the\
    \ MN having to\n   explicitly request that information.  This can reduce the amount\
    \ of\n   wireless traffic required for the MN to obtain a neighborhood\n   topology\
    \ map of links and subnets.  Such usage of PrRtAdv is\n   decoupled from the actual\
    \ handover; see Section 6.1.2.\n"
- title: 4.  Protocol Details
  contents:
  - "4.  Protocol Details\n   All descriptions refer to Figure 1.\n   After discovering\
    \ one or more nearby access points, the MN sends\n   RtSolPr to the PAR in order\
    \ to resolve access point identifiers to\n   subnet router information.  A convenient\
    \ time to do this is after\n   performing router discovery.  However, the MN can\
    \ send RtSolPr at any\n   time, e.g., when one or more new access points are discovered.\
    \  The\n   MN can also send RtSolPr more than once during its attachment to PAR.\n\
    \   The trigger for sending RtSolPr can originate from a link-specific\n   event,\
    \ such as the promise of a better signal strength from another\n   access point\
    \ coupled with fading signal quality with the current\n   access point.  Such\
    \ events, often broadly referred to as \"L2\n   triggers\", are outside the scope\
    \ of this document.  Nevertheless,\n   they serve as events that invoke this protocol.\
    \  For instance, when a\n   \"link up\" indication is obtained on the new link,\
    \ protocol messages\n   (e.g., UNA) can be transmitted immediately.  Implementations\
    \ SHOULD\n   make use of such triggers whenever available.\n   The RtSolPr message\
    \ contains one or more AP-IDs.  A wildcard requests\n   all available tuples.\n\
    \   As a response to RtSolPr, the PAR sends a PrRtAdv message that\n   indicates\
    \ one of the following possible conditions.\n      1.  If the PAR does not have\
    \ an entry corresponding to the new\n          access point, it MUST respond indicating\
    \ that the new access\n          point is unknown.  The MN MUST stop fast handover\
    \ protocol\n          operations on the current link.  The MN MAY send an FBU\
    \ from\n          its new link.\n      2.  If the new access point is connected\
    \ to the PAR's current\n          interface (to which MN is attached), the PAR\
    \ MUST respond with\n          a Code value indicating that the new access point\
    \ is connected\n          to the current interface, but not send any prefix information.\n\
    \          This scenario could arise, for example, when several wireless\n   \
    \       access points are bridged into a wired network.  No further\n        \
    \  protocol action is necessary.\n      3.  If the new access point is known and\
    \ the PAR has information\n          about it, then the PAR MUST respond indicating\
    \ that the new\n          access point is known and supply the [AP-ID, AR-Info]\
    \ tuple.\n          If the new access point is known, but does not support fast\n\
    \          handover, the PAR MUST indicate this with Code 3 (see Section\n   \
    \       6.1.2).\n      4.  If a wildcard is supplied as an identifier for the\
    \ new access\n          point, the PAR SHOULD supply neighborhood [AP-ID, AR-Info]\n\
    \          tuples that are subject to path MTU restrictions (i.e.,\n         \
    \ provide any 'n' tuples without exceeding the link MTU).\n   When further protocol\
    \ action is necessary, some implementations MAY\n   choose to begin buffering\
    \ copies of incoming packets at the PAR.  If\n   such First in First Out (FIFO)\
    \ buffering is used, the PAR MUST\n   continue forwarding the packets to the PCoA\
    \ (i.e., buffer and\n   forward).  While the protocol does not forbid such an\
    \ implementation\n   support, care must be taken to ensure that the PAR continues\n\
    \   forwarding packets to the PCoA (i.e., uses a buffer and forward\n   approach).\
    \  The PAR SHOULD stop buffering once it begins forwarding\n   packets to the\
    \ NCoA.\n   The method by which access routers exchange information about their\n\
    \   neighbors and thereby allow construction of Proxy Router\n   Advertisements\
    \ with information about neighboring subnets is outside\n   the scope of this\
    \ document.\n   The RtSolPr and PrRtAdv messages MUST be implemented by an MN\
    \ and an\n   access router that supports fast handovers.  However, when the\n\
    \   parameters necessary for the MN to send packets immediately upon\n   attaching\
    \ to the NAR are supplied by the link-layer handover\n   mechanism itself, use\
    \ of the above messages is optional on such\n   links.\n   After a PrRtAdv message\
    \ is processed, the MN sends an FBU at a time\n   determined by link-specific\
    \ events, and includes the proposed NCoA.\n   The MN SHOULD send the FBU from\
    \ the PAR's link whenever\n   \"anticipation\" of handover is feasible.  When\
    \ anticipation is not\n   feasible or when it has not received an FBack, the MN\
    \ sends an FBU\n   immediately after attaching to NAR's link.  In response to\
    \ the FBU,\n   the PAR establishes a binding between the PCoA (\"Home Address\"\
    ) and\n   the NCoA, and sends the FBack to the MN.  Prior to establishing this\n\
    \   binding, the PAR SHOULD send an HI message to the NAR, and receive\n   HAck\
    \ in response.  In order to determine the NAR's address for the HI\n   message,\
    \ the PAR can perform the longest prefix match of NCoA (in\n   FBU) with the prefix\
    \ list of neighboring access routers.  When the\n   source IP address of the FBU\
    \ is the PCoA, i.e., the FBU is sent from\n   the PAR's link, the HI message MUST\
    \ have a Code value set to 0; see\n   Section 6.2.1.  When the source IP address\
    \ of the FBU is not PCoA,\n   i.e., the FBU is sent from the NAR's link, the HI\
    \ message MUST have a\n   Code value of 1; see Section 6.2.1.\n   The HI message\
    \ contains the PCoA, link-layer address, and the NCoA of\n   the MN.  In response\
    \ to processing an HI message with Code 0, the\n   NAR:\n      1.  determines\
    \ whether the NCoA supplied in the HI message is\n          unique before beginning\
    \ to defend it.  It sends a Duplicate\n          Address Detection (DAD) probe\
    \ [RFC4862] for NCoA to verify\n          uniqueness.  However, in deployments\
    \ where the probability of\n          address collisions is considered extremely\
    \ low (and hence not\n          an issue), the parameter DupAddrDetectTransmits\
    \ (see\n          [RFC4862]) is set to zero on the NAR, allowing it to avoid\n\
    \          performing DAD on the NCoA.  The NAR similarly sets\n          DupAddrDetectTransmits\
    \ to zero in other deployments where DAD\n          is not a concern.  Once the\
    \ NCoA is determined to be unique,\n          the NAR starts proxying [RFC4861]\
    \ the address for\n          PROXY_ND_LIFETIME during which the MN is expected\
    \ to connect\n          to the NAR.  In case there is already an NCoA present\
    \ in its\n          data structure (for instance, it has already processed an\
    \ HI\n          message earlier), the NAR MAY verify if the LLA is the same as\n\
    \          its own or that of the MN itself.  If so, the NAR MAY allow\n     \
    \     the use of the NCoA.\n      2.  allocates the NCoA for the MN when assigned\
    \ addressing is\n          used, creates a proxy neighbor cache entry and begins\n\
    \          defending it.  The NAR MAY allocate the NCoA proposed in HI.\n    \
    \  3.  MAY create a host route entry for the PCoA (on the interface\n        \
    \  to which the MN is attaching to) in case the NCoA cannot be\n          accepted\
    \ or assigned.  This host route entry SHOULD be\n          implemented such that\
    \ until the MN's presence is detected,\n          either through explicit announcement\
    \ by the MN or by other\n          means, arriving packets do not invoke neighbor\
    \ discovery.  The\n          NAR SHOULD also set up a reverse tunnel to the PAR\
    \ in this\n          case.\n      4.  provides the status of the handover request\
    \ in the Handover\n          Acknowledge (HAck) message to the PAR.\n   When the\
    \ Code value in HI is 1, the NAR MUST skip the above\n   operations.  Sending\
    \ an HI message with Code 1 allows the NAR to\n   validate the neighbor cache\
    \ entry it creates for the MN during UNA\n   processing.  That is, the NAR can\
    \ make use of the knowledge that its\n   trusted peer (i.e., the PAR) has a trust\
    \ relationship with the MN.\n   If HAck contains an assigned NCoA, the FBack MUST\
    \ include it, and the\n   MN MUST use the address provided in the FBack.  The\
    \ PAR MAY send the\n   FBack to the previous link as well to facilitate faster\
    \ reception in\n   the event that the MN is still present.  The result of the\
    \ FBU and\n   FBack processing is that PAR begins tunneling the MN's packets to\
    \ the\n   NCoA.  If the MN does not receive an FBack message even after\n   retransmitting\
    \ the FBU for FBU_RETRIES, it must assume that fast\n   handover support is not\
    \ available and stop the protocol operation.\n   As soon as the MN establishes\
    \ link connectivity with the NAR, it:\n      1.  sends an UNA message (see Section\
    \ 6.4).  If the MN has not\n          received an FBack by the time UNA is being\
    \ sent, it SHOULD\n          send an FBU message following the UNA message.\n\
    \      2.  joins the all-nodes multicast group and the solicited-node\n      \
    \    multicast group corresponding to the NCoA.\n      3.  starts a DAD probe\
    \ for NCoA, see [RFC4862].\n   When a NAR receives an UNA message, it:\n     \
    \ 1.  deletes its proxy neighbor cache entry, if it exists, updates\n        \
    \  the state to STALE [RFC4861], and forwards arriving and\n          buffered\
    \ packets.\n      2.  updates an entry in INCOMPLETE state [RFC4861], if it exists,\n\
    \          to STALE and forwards arriving and buffered packets.  This\n      \
    \    would be the case if NAR had previously sent a Neighbor\n          Solicitation\
    \ that went unanswered perhaps because the MN had\n          not yet attached\
    \ to the link.\n   The buffer for handover traffic should be linked to this UNA\n\
    \   processing.  The exact mechanism is implementation dependent.\n   The NAR\
    \ may choose to provide a different IP address other than the\n   NCoA.  This\
    \ is possible if it is proxying the NCoA.  In such a case,\n   it:\n      1. \
    \ MAY send a Router Advertisement with the NAACK option in which\n          it\
    \ includes an alternate IP address for use.  This message\n          MUST be sent\
    \ to the source IP address present in UNA using the\n          same Layer 2 address\
    \ present in UNA.\n   If the MN receives an IP address in the NAACK option, it\
    \ MUST use it\n   and send an FBU using the new CoA.  As a special case, the address\n\
    \   supplied in NAACK could be the PCoA itself, in which case the MN MUST\n  \
    \ NOT send any more FBUs.  The Status codes for the NAACK option are\n   specified\
    \ in Section 6.5.5.\n   Once the MN has confirmed its NCoA (either through DAD\
    \ or when\n   provided for by the NAR), it SHOULD send a Neighbor Advertisement\n\
    \   message with the 'O' bit set, to the all-nodes multicast address.\n   This\
    \ message allows MN's neighbors to update their neighbor cache\n   entries.\n\
    \   For data forwarding, the PAR tunnels packets using its global IP\n   address\
    \ valid on the interface to which the MN was attached.  The MN\n   reverse tunnels\
    \ its packets to the same global address of PAR.  The\n   tunnel end-point addresses\
    \ must be configured accordingly.  When the\n   PAR receives a reverse tunneled\
    \ packet, it must verify if a secure\n   binding exists for the MN identified\
    \ by the PCoA in the tunneled\n   packet, before forwarding the packet.\n"
- title: 5.  Other Considerations
  contents:
  - '5.  Other Considerations

    '
- title: 5.1.  Handover Capability Exchange
  contents:
  - "5.1.  Handover Capability Exchange\n   The MN expects a PrRtAdv in response to\
    \ its RtSolPr message.  If the\n   MN does not receive a PrRtAdv message even\
    \ after RTSOLPR_RETRIES, it\n   must assume that the PAR does not support the\
    \ fast handover protocol\n   and stop sending any more RtSolPr messages.\n   Even\
    \ if an MN's current access router is capable of providing fast\n   handover support,\
    \ the new access router to which the MN attaches may\n   be incapable of fast\
    \ handover.  This is indicated to the MN during\n   \"runtime\", through the PrRtAdv\
    \ message with a Code value of 3 (see\n   Section 6.1.2).\n"
- title: 5.2.  Determining New Care-of Address
  contents:
  - "5.2.  Determining New Care-of Address\n   Typically, the MN formulates its prospective\
    \ NCoA using the\n   information provided in a PrRtAdv message and sends the FBU.\
    \  The PAR\n   MUST use the NCoA present in the FBU in its HI message.  The NAR\
    \ MUST\n   verify if the NCoA present in HI is already in use.  In any case, the\n\
    \   NAR MUST respond to HI using a HAck, in which it may include another\n   NCoA\
    \ to use, especially when assigned address configuration is used.\n   If there\
    \ is a CoA present in HAck, the PAR MUST include it in the\n   FBack message.\
    \  However, the MN itself does not have to wait on PAR's\n   link for this exchange\
    \ to take place.  It can handover any time after\n   sending the FBU message;\
    \ sometimes it may be forced to handover\n   without sending the FBU.  In any\
    \ case, it can still confirm using\n   NCoA from NAR's link by sending the UNA\
    \ message.\n   If a PrRtAdv message carries an NCoA, the MN MUST use it as its\n\
    \   prospective NCoA.\n   When DHCP is used, the protocol supports forwarding\
    \ for PCoA only.\n   In this case, the MN MUST perform DHCP operations once it\
    \ attaches to\n   the NAR even though it formulates an NCoA for transmitting the\
    \ FBU.\n   This is indicated in the PrRtAdv message with Code = 5.\n"
- title: 5.3.  Prefix Management
  contents:
  - "5.3.  Prefix Management\n   As defined in Section 2, the Prefix part of \"AR-Info\"\
    \ is the prefix\n   valid on the interface to which the AP is attached.  This\
    \ document\n   does not specify how this Prefix is managed, it's length and\n\
    \   assignment policies.  The protocol operation specified in this\n   document\
    \ works regardless of these considerations.  Often, but not\n   necessarily always,\
    \ this Prefix may be the aggregate prefix (such as\n   /48) valid on the interface.\
    \  In some deployments, each MN may have\n   its own per-mobile prefix (such as\
    \ a /64) used for generating the\n   NCoA.  Some point-to-point links may use\
    \ such a deployment.\n   When per-mobile prefix assignment is used, the \"AR-Info\"\
    \ advertised\n   in PrRtAdv still includes the (aggregate) prefix valid on the\n\
    \   interface to which the target AP is attached, unless the access\n   routers\
    \ communicate with each other (using HI and HAck messages) to\n   manage the per-mobile\
    \ prefix.  The MN still formulates an NCoA using\n   the aggregate prefix.  However,\
    \ an alternate NCoA based on the\n   per-mobile prefix is returned by NAR in the\
    \ HAck message.  This\n   alternate NCoA is provided to the MN in either the FBack\
    \ message or\n   in the NAACK option.\n"
- title: 5.4.  Packet Loss
  contents:
  - "5.4.  Packet Loss\n   Handover involves link switching, which may not be exactly\n\
    \   coordinated with fast handover signaling.  Furthermore, the arrival\n   pattern\
    \ of packets is dependent on many factors, including\n   application characteristics,\
    \ network queuing behaviors, etc.  Hence,\n   packets may arrive at the NAR before\
    \ the MN is able to establish its\n   link there.  These packets will be lost\
    \ unless they are buffered by\n   the NAR.  Similarly, if the MN attaches to the\
    \ NAR and then sends an\n   FBU message, packets arriving at the PAR until the\
    \ FBU is processed\n   will be lost unless they are buffered.  This protocol provides\
    \ an\n   option to indicate request for buffering at the NAR in the HI\n   message.\
    \  When the PAR requests this feature (for the MN), it SHOULD\n   also provide\
    \ its own support for buffering.\n   Whereas buffering can enable a smooth handover,\
    \ the buffer size and\n   the rate at which buffered packets are eventually forwarded\
    \ are\n   important considerations when providing buffering support.  There are\n\
    \   a number of aspects to consider:\n   o  Some applications transmit less data\
    \ over a given period of data\n      than others, and this implies different buffering\
    \ requirements.\n      For instance, Voice over IP typically needs smaller buffers\n\
    \      compared to high-resolution streaming video, as the latter has\n      larger\
    \ packet sizes and higher arrival rates.\n   o  When the mobile node appears on\
    \ the new link, having the buffering\n      router send a large number of packets\
    \ in quick succession may\n      overtax the resources of the router, the mobile\
    \ node itself, or\n      the path between these two.\n      In particular, transmitting\
    \ a large amount of buffered packets in\n      succession can congest the path\
    \ between the buffering router and\n      the mobile node.  Furthermore, nodes\
    \ (such as a base station) on\n      the path between the buffering router and\
    \ the mobile node may drop\n      such packets.  If a base station buffers too\
    \ many such packets,\n      they may contribute to additional jitter for packets\
    \ arriving\n      behind them, which is undesirable for real-time communication.\n\
    \   o  Since routers are not involved in end-to-end communication, they\n    \
    \  have no knowledge of transport conditions.\n   o  The wireless connectivity\
    \ of the mobile node may vary over time.\n      It may achieve a smaller or higher\
    \ bandwidth on the new link,\n      signal strength may be weak at the time it\
    \ just enters the area of\n      this access point, and so on.\n   As a result,\
    \ it is difficult to design an algorithm that would\n   transmit buffered packets\
    \ at appropriate spacing under all scenarios.\n   The purpose of fast handovers\
    \ is to avoid packet loss.  Yet, draining\n   buffered packets too fast can, by\
    \ itself, cause loss of the packets,\n   as well as blocking or loss of following\
    \ packets meant for the mobile\n   node.\n   This specification does not restrict\
    \ implementations from providing\n   specialized buffering support for any specific\
    \ situation.  However,\n   attention must be paid to the rate at which buffered\
    \ packets are\n   forwarded to the MN once attachment is complete.  Routers\n\
    \   implementing this specification MUST implement at least the default\n   algorithm,\
    \ which is based on the original arrival rates of the\n   buffered packets.  A\
    \ maximum of 5 packets MAY be sent one after\n   another, but all subsequent packets\
    \ SHOULD use a sending rate that is\n   determined by metering the rate at which\
    \ packets have entered the\n   buffer, potentially using smoothing techniques\
    \ such as recent\n   activity over a sliding time window and weighted averages\
    \ [RFC3290].\n   It should be noted, however, that this default algorithm is crude\
    \ and\n   may not be suitable for all situations.  Future revisions of this\n\
    \   specification may provide additional algorithms, once enough\n   experience\
    \ of the various conditions in deployed networks is\n   attained.\n"
- title: 5.5.  DAD Handling
  contents:
  - "5.5.  DAD Handling\n   Duplicate Address Detection (DAD) was defined in [RFC4862]\
    \ to avoid\n   address duplication on links when stateless address\n   auto-configuration\
    \ is used.  The use of DAD to verify the uniqueness\n   of an IPv6 address configured\
    \ through stateless auto-configuration\n   adds delays to a handover.  The probability\
    \ of an interface\n   identifier duplication on the same subnet is very low; however,\
    \ it\n   cannot be ignored.  Hence, the protocol specified in this document\n\
    \   SHOULD only be used in deployments where the probability of such\n   address\
    \ collisions is extremely low or it is not a concern (because\n   of the address\
    \ management procedure deployed).  The protocol requires\n   the NAR to send a\
    \ DAD probe before it starts defending the NCoA.\n   However, this DAD delay can\
    \ be turned off by setting\n   DupAddrDetectTransmits to zero on the NAR [RFC4862].\n\
    \   This document specifies messages that can be used to provide\n   duplicate-free\
    \ addresses, but the document does not specify how to\n   create or manage such\
    \ duplicate-free addresses.  In some cases, the\n   NAR may already have the knowledge\
    \ required to assess whether or not\n   the MN's address is a duplicate before\
    \ the MN moves to the new\n   subnet.  For example, in some deployments, the NAR\
    \ may maintain a\n   pool of duplicate-free addresses in a list for handover purposes.\
    \  In\n   such cases, the NAR can provide this disposition in the HAck message\n\
    \   (see Section 6.2.2) or in the NAACK option (see Section 6.5.5).\n"
- title: 5.6.  Fast or Erroneous Movement
  contents:
  - "5.6.  Fast or Erroneous Movement\n   Although this specification is for fast\
    \ handover, the protocol is\n   limited in terms of how fast an MN can move. \
    \ A special case of fast\n   movement is ping-pong, where an MN moves between\
    \ the same two access\n   points rapidly.  Another instance of the same problem\
    \ is erroneous\n   movement, i.e., the MN receives information prior to a handover\
    \ that\n   it is moving to a new access point but it either moves to a different\n\
    \   one or it aborts movement altogether.  All of the above behaviors are\n  \
    \ usually the result of link-layer idiosyncrasies and thus are often\n   resolved\
    \ at the link layer itself.\n   IP layer mobility, however, introduces its own\
    \ limits.  IP layer\n   handovers should occur at a rate suitable for the MN to\
    \ update the\n   binding of, at least, its Home Agent and preferably that of every\
    \ CN\n   with which it is in communication.  An MN that moves faster than\n  \
    \ necessary for this signaling to complete, which may be of the order\n   of few\
    \ seconds, may start losing packets.  The signaling cost over\n   the air interface\
    \ and in the network may increase significantly,\n   especially in the case of\
    \ rapid movement between several access\n   routers.  To avoid the signaling overhead,\
    \ the following measures are\n   suggested.\n   An MN returning to the PAR before\
    \ updating the necessary bindings\n   when present on the NAR MUST send a Fast\
    \ Binding Update with the Home\n   Address equal to the MN's PCoA and a lifetime\
    \ of zero to the PAR.\n   The MN should have a security association with the PAR\
    \ since it\n   performed a fast handover to the NAR.  The PAR, upon receiving\
    \ this\n   Fast Binding Update, will check its set of outgoing (temporary fast\n\
    \   handover) tunnels.  If it finds a match, it SHOULD terminate that\n   tunnel;\
    \ i.e., start delivering packets directly to the node instead.\n   In order for\
    \ the PAR to process such an FBU, the lifetime of the\n   security association\
    \ has to be at least that of the tunnel itself.\n   Temporary tunnels for the\
    \ purposes of fast handovers should use short\n   lifetimes (of the order of at\
    \ most a few tens of seconds or less).\n   The lifetime of such tunnels should\
    \ be enough to allow an MN to\n   update all its active bindings.  The default\
    \ lifetime of the tunnel\n   should be the same as the lifetime value in the FBU\
    \ message.\n   The effect of erroneous movement is typically limited to the loss\
    \ of\n   packets since routing can change and the PAR may forward packets\n  \
    \ toward another router before the MN actually connects to that router.\n   If\
    \ the MN discovers itself on an unanticipated access router, it\n   SHOULD send\
    \ a new Fast Binding Update to the PAR.  This FBU\n   supersedes the existing\
    \ binding at the PAR, and the packets will be\n   redirected to the newly confirmed\
    \ location of the MN.\n"
- title: 6.  Message Formats
  contents:
  - "6.  Message Formats\n   All the ICMPv6 messages have a common Type specified\
    \ in [RFC4443].\n   The messages are distinguished based on the Subtype field\
    \ (see\n   below).  For all the ICMPv6 messages, the checksum is defined in\n\
    \   [RFC4443].\n"
- title: 6.1.  New Neighborhood Discovery Messages
  contents:
  - '6.1.  New Neighborhood Discovery Messages

    '
- title: 6.1.1.  Router Solicitation for Proxy Advertisement (RtSolPr)
  contents:
  - "6.1.1.  Router Solicitation for Proxy Advertisement (RtSolPr)\n   Mobile Nodes\
    \ send Router Solicitation for Proxy Advertisement in\n   order to prompt routers\
    \ for Proxy Router Advertisements.  All the\n   Link-Layer Address options have\
    \ the format defined in Section 6.5.2.\n    0                   1            \
    \       2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |      Code     |             Checksum          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Subtype    |    Reserved   |            Identifier         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n   Figure 4: Router Solicitation\
    \ for Proxy Advertisement (RtSolPr)\n                               Message\n\
    \   IP Fields:\n      Source Address: An IP address assigned to the sending interface.\n\
    \      Destination Address: The address of the access router or the all\n    \
    \  routers multicast address.\n      Hop Limit: 255.  See RFC 2461.\n   ICMP Fields:\n\
    \      Type: 154\n      Code: 0\n      Checksum: The ICMPv6 checksum.\n      Subtype:\
    \ 2\n      Reserved: MUST be set to zero by the sender and ignored by the\n  \
    \    receiver.\n      Identifier: MUST be set by the sender so that replies can\
    \ be\n      matched to this Solicitation.\n   Valid Options:\n      Source Link-Layer\
    \ Address: When known, the link-layer address of\n      the sender SHOULD be included\
    \ using the Link-Layer Address (LLA)\n      option.  See the LLA option format\
    \ below.\n      New Access Point Link-Layer Address: The link-layer address or\n\
    \      identification of the access point for which the MN requests\n      routing\
    \ advertisement information.  It MUST be included in all\n      RtSolPr messages.\
    \  More than one such address or identifier can be\n      present.  This field\
    \ can also be a wildcard address.  See the LLA\n      option below.\n   Future\
    \ versions of this protocol may define new option types.\n   Receivers MUST silently\
    \ ignore any options that they do not recognize\n   and continue processing the\
    \ rest of the message.\n   Including the source LLA option allows the receiver\
    \ to record the\n   sender's L2 address so that neighbor discovery can be avoided\
    \ when\n   the receiver needs to send packets back to the sender (of the RtSolPr\n\
    \   message).\n   When a wildcard is used for New Access Point LLA, no other New\
    \ Access\n   Point LLA options must be present.\n   A Proxy Router Advertisement\
    \ (PrRtAdv) message should be received by\n   the MN in response to an RtSolPr.\
    \  If such a message is not received\n   in a timely manner (no less than twice\
    \ the typical round trip time\n   (RTT) over the access link or 100 milliseconds\
    \ if RTT is not known),\n   it SHOULD resend the RtSolPr message.  Subsequent\
    \ retransmissions can\n   be up to RTSOLPR_RETRIES, but MUST use an exponential\
    \ backoff in\n   which the timeout period (i.e., 2xRTT or 100 milliseconds) is\
    \ doubled\n   prior to each instance of retransmission.  If Proxy Router\n   Advertisement\
    \ is not received by the time the MN disconnects from the\n   PAR, the MN SHOULD\
    \ send an FBU immediately after configuring a new\n   CoA.\n   When RtSolPr messages\
    \ are sent more than once, they MUST be rate\n   limited with MAX_RTSOLPR_RATE\
    \ per second.  During each use of an\n   RtSolPr, exponential backoff is used\
    \ for retransmissions.\n"
- title: 6.1.2.  Proxy Router Advertisement (PrRtAdv)
  contents:
  - "6.1.2.  Proxy Router Advertisement (PrRtAdv)\n   Access routers send Proxy Router\
    \ Advertisement messages gratuitously\n   if the handover is network-initiated\
    \ or as a response to an RtSolPr\n   message from an MN, providing the link-layer\
    \ address, IP address, and\n   subnet prefixes of neighboring routers.  All the\
    \ Link-Layer Address\n   options have the format defined in 6.4.3.\n    0    \
    \               1                   2                   3\n    0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |      Code     |           Checksum            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Subtype    |    Reserved   |           Identifier          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n         Figure 5: Proxy Router\
    \ Advertisement (PrRtAdv) Message\n   IP Fields:\n      Source Address: MUST be\
    \ the link-local address assigned to the\n      interface from which this message\
    \ is sent.\n      Destination Address: The Source Address of an invoking Router\n\
    \      Solicitation for Proxy Advertisement or the address of the node\n     \
    \ the access router is instructing to handover.\n      Hop Limit: 255.  See RFC\
    \ 2461.\n   ICMP Fields:\n      Type: 154\n      Code: 0, 1, 2, 3, 4, or 5.  See\
    \ below.\n      Checksum: The ICMPv6 checksum.\n      Subtype: 3\n      Reserved:\
    \ MUST be set to zero by the sender and ignored by the\n      receiver.\n    \
    \  Identifier: Copied from Router Solicitation for Proxy\n      Advertisement\
    \ or set to zero if unsolicited.\n   Valid Options in the following order:\n \
    \     Source Link-Layer Address: When known, the link-layer address of\n     \
    \ the sender SHOULD be included using the Link-Layer Address option.\n      See\
    \ the LLA option format below.\n      New Access Point Link-Layer Address: The\
    \ link-layer address or\n      identification of the access point is copied from\
    \ RtSolPr message.\n      This option MUST be present.\n      New Router's Link-Layer\
    \ Address: The link-layer address of the\n      access router for which this message\
    \ is proxied for.  This option\n      MUST be included when the Code is 0 or 1.\n\
    \      New Router's IP Address: The IP address of the NAR.  This option\n    \
    \  MUST be included when the Code is 0 or 1.\n      New Router Prefix Information\
    \ Option: Specifies the prefix of the\n      access router the message is proxied\
    \ for and is used for address\n      auto-configuration.  This option MUST be\
    \ included when the Code is\n      0 or 1.  However, when this prefix is the same\
    \ as what is used in\n      the New Router's IP Address option (above), the Prefix\
    \ Information\n      option need not be present.\n      New CoA Option: MAY be\
    \ present when PrRtAdv is sent unsolicited.\n      The PAR MAY compute a new CoA\
    \ using the NAR's prefix information\n      and the MN's L2 address or by any\
    \ other means.\n   Future versions of this protocol may define new option types.\n\
    \   Receivers MUST silently ignore any options they do not recognize and\n   continue\
    \ processing the message.\n   Currently, Code values 0, 1, 2, 3, 4, and 5 are\
    \ defined.\n   A Proxy Router Advertisement with Code 0 means that the MN should\
    \ use\n   the [AP-ID, AR-Info] tuple (present in the options above) for\n   movement\
    \ detection and NCoA formulation.  The Option-Code field in\n   the New Access\
    \ Point LLA option in this case is 1 reflecting the LLA\n   of the access point\
    \ for which the rest of the options are related.\n   Multiple tuples may be present.\n\
    \   A Proxy Router Advertisement with Code 1 means that the message has\n   been\
    \ sent unsolicited.  If a New CoA option is present following the\n   New Router\
    \ Prefix Information option, the MN MUST use the supplied\n   NCoA and send an\
    \ FBU immediately or else stand to lose service.  This\n   message acts as a network-initiated\
    \ handover trigger; see Section\n   3.3.  The Option-Code field in the New Access\
    \ Point LLA option (see\n   below) in this case is 1 reflecting the LLA of the\
    \ access point for\n   which the rest of the options are related.\n   A Proxy\
    \ Router Advertisement with Code 2 means that no new router\n   information is\
    \ present.  Each New Access Point LLA option contains an\n   Option-Code value\
    \ (described below) that indicates a specific\n   outcome.\n      When the Option-Code\
    \ field in the New Access Point LLA option is\n      5, handover to that access\
    \ point does not require a change of CoA.\n      This would be the case, for instance,\
    \ when a number of access\n      points are connected to the same router interface,\
    \ or when network\n      based mobility management mechanisms ensure that the\
    \ specific\n      mobile node always observes the same prefix regardless of whether\n\
    \      there is a separate router attached to the target access point.\n     \
    \ No other options are required in this case.\n      When the Option-Code field\
    \ in the New Access Point LLA option is\n      6, the PAR is not aware of the\
    \ Prefix Information requested.  The\n      MN SHOULD attempt to send an FBU as\
    \ soon as it regains\n      connectivity with the NAR.  No other options are required\
    \ in this\n      case.\n      When the Option-Code field in the New Access Point\
    \ LLA option is\n      7, it means that the NAR does not support fast handover.\
    \  The MN\n      MUST stop fast handover protocol operations.  No other options\
    \ are\n      required in this case.\n   A Proxy Router Advertisement with Code\
    \ 3 means that new router\n   information is only present for a subset of access\
    \ points requested.\n   The Option-Code field values (defined above including\
    \ a value of 1)\n   distinguish different outcomes for individual access points.\n\
    \   A Proxy Router Advertisement with Code 4 means that the subnet\n   information\
    \ regarding neighboring access points is sent unsolicited,\n   but the message\
    \ is not a handover trigger, unlike when the message is\n   sent with Code 1.\
    \  Multiple tuples may be present.\n   A Proxy Router Advertisement with Code\
    \ 5 means that the MN may use\n   the new router information present for detecting\
    \ movement to a new\n   subnet, but the MN must perform DHCP [RFC3315] upon attaching\
    \ to the\n   NAR's link.  The PAR and NAR will forward packets to the PCoA of\
    \ the\n   MN.  The MN must still formulate an NCoA for transmitting FBU (using\n\
    \   the information sent in this message), but that NCoA will not be used\n  \
    \ for forwarding packets.\n   When a wildcard AP identifier is supplied in the\
    \ RtSolPr message, the\n   PrRtAdv message should include any 'n' [Access Point\
    \ Identifier,\n   Link-Layer Address option, Prefix Information Option] tuples\n\
    \   corresponding to the PAR's neighborhood.\n"
- title: 6.2.  Inter - Access Router Messages
  contents:
  - '6.2.  Inter - Access Router Messages

    '
- title: 6.2.1.  Handover Initiate (HI)
  contents:
  - "6.2.1.  Handover Initiate (HI)\n   The Handover Initiate (HI) is an ICMPv6 message\
    \ sent by an Access\n   Router (typically PAR) to another access router (typically\
    \ NAR) to\n   initiate the process of an MN's handover.\n    0               \
    \    1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |      Code     |         Checksum              |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Subtype    |S|U| Reserved  |           Identifier          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n               Figure 6: Handover\
    \ Initiate (HI) Message\n   IP Fields:\n      Source Address: The IP address of\
    \ the PAR\n      Destination Address: The IP address of the NAR\n   ICMP Fields:\n\
    \      Type: 154\n      Code: 0 or 1.  See below\n      Checksum: The ICMPv6 checksum.\n\
    \      Subtype: 4\n      'S' flag: Assigned address configuration flag.  When\
    \ set, this\n      message requests a new CoA to be returned by the destination.\
    \  May\n      be set when Code = 0.  MUST be 0 when Code = 1.\n      'U' flag:\
    \ Buffer flag.  When set, the destination SHOULD buffer\n      any packets toward\
    \ the node indicated in the options of this\n      message.  Used when Code =\
    \ 0, SHOULD be set to 0 when Code = 1.\n      Reserved: MUST be set to zero by\
    \ the sender and ignored by the\n      receiver.\n      Identifier: MUST be set\
    \ by the sender so replies can be matched to\n      this message.\n   Valid Options:\n\
    \      Link-Layer Address of MN: The link-layer address of the MN that is\n  \
    \    undergoing handover to the destination (i.e., NAR).  This option\n      MUST\
    \ be included so that the destination can recognize the MN.\n      Previous Care-of\
    \ Address: The IP address used by the MN while\n      attached to the originating\
    \ router.  This option SHOULD be\n      included so that a host route can be established\
    \ if necessary.\n      New Care-of Address: The IP address the MN wishes to use\
    \ when\n      connected to the destination.  When the 'S' bit is set, the NAR\n\
    \      MAY assign this address.\n   The PAR uses a Code value of 0 when it processes\
    \ an FBU with PCoA as\n   source IP address.  The PAR uses a Code value of 1 when\
    \ it processes\n   an FBU whose source IP address is not PCoA.\n   If a Handover\
    \ Acknowledge (HAck) message is not received as a\n   response in a short time\
    \ period (no less than twice the typical round\n   trip time (RTT) between source\
    \ and destination, or 100 milliseconds\n   if RTT is not known), the Handover\
    \ Initiate SHOULD be resent.\n   Subsequent retransmissions can be up to HI_RETRIES,\
    \ but MUST use\n   exponential backoff in which the timeout period (i.e., 2xRTT\
    \ or 100\n   milliseconds) is doubled during each instance of retransmission.\n"
- title: 6.2.2.  Handover Acknowledge (HAck)
  contents:
  - "6.2.2.  Handover Acknowledge (HAck)\n   The Handover Acknowledgment message is\
    \ a new ICMPv6 message that MUST\n   be sent (typically by the NAR to the PAR)\
    \ as a reply to the Handover\n   Initiate message.\n    0                   1\
    \                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |      Code     |           Checksum            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Subtype    |     Reserved  |           Identifier          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Options ...\n   +-+-+-+-+-+-+-+-+-+-+-+-\n             Figure 7: Handover\
    \ Acknowledge (HAck) Message\n   IP Fields:\n      Source Address: Copied from\
    \ the destination address of the\n      Handover Initiate Message to which this\
    \ message is a response.\n      Destination Address: Copied from the source address\
    \ of the\n      Handover Initiate Message to which this message is a response.\n\
    \   ICMP Fields:\n      Type: 154\n      Code:\n         0: Handover Accepted,\
    \ NCoA valid\n         1: Handover Accepted, NCoA not valid or in use\n      \
    \   2: Handover Accepted, NCoA assigned (used in Assigned\n         addressing)\n\
    \         3: Handover Accepted, use PCoA\n         4: Message sent unsolicited,\
    \ usually to trigger an HI message\n         128: Handover Not Accepted, reason\
    \ unspecified\n         129: Administratively prohibited\n         130: Insufficient\
    \ resources\n      Checksum: The ICMPv6 checksum.\n      Subtype: 5\n      Reserved:\
    \ MUST be set to zero by the sender and ignored by the\n      receiver.\n    \
    \  Identifier: Copied from the corresponding field in the Handover\n      Initiate\
    \ message to which this message is a response.\n   Valid Options:\n      New Care-of\
    \ Address: If the S flag in the Handover Initiate\n      message is set, this\
    \ option MUST be used to provide NCoA the MN\n      should use when connected\
    \ to this router.  This option MAY be\n      included, even when the 'S' bit is\
    \ not set, e.g., Code 2 above.\n      Upon receiving an HI message, the NAR MUST\
    \ respond with a Handover\n      Acknowledge message.  If the 'S' flag is set\
    \ in the HI message,\n      the NAR SHOULD include the New Care-of Address option\
    \ and a Code\n      3.\n      The NAR MAY provide support for the PCoA (instead\
    \ of accepting or\n      assigning an NCoA), establish a host route entry for\
    \ the PCoA, and\n      set up a tunnel to the PAR to forward the MN's packets\
    \ sent with\n      the PCoA as a source IP address.  This host route entry SHOULD\
    \ be\n      used to forward packets once the NAR detects that the particular\n\
    \      MN is attached to its link.  The NAR indicates forwarding support\n   \
    \   for PCoA using Code value 3 in the HAck message.  Subsequently,\n      the\
    \ PAR establishes a tunnel to the NAR in order to forward\n      packets arriving\
    \ for the PCoA.\n      When responding to an HI message containing a Code value\
    \ 1, the\n      Code values 1, 2, and 4 in the HAck message are not relevant.\n\
    \      Finally, the New Access Router can always refuse handover, in\n      which\
    \ case it should indicate the reason in one of the available\n      Code values.\n"
- title: 6.3.  New Mobility Header Messages
  contents:
  - "6.3.  New Mobility Header Messages\n   Mobile IPv6 uses a new IPv6 header type\
    \ called Mobility Header\n   [RFC3775].  The Fast Binding Update, Fast Binding\
    \ Acknowledgment, and\n   the (deprecated) Fast Neighbor Advertisement messages\
    \ use the\n   Mobility Header.\n"
- title: 6.3.1.  Fast Binding Update (FBU)
  contents:
  - "6.3.1.  Fast Binding Update (FBU)\n   The Fast Binding Update message has a Mobility\
    \ Header Type value of\n   8.  The FBU is identical to the Mobile IPv6 Binding\
    \ Update (BU)\n   message.  However, the processing rules are slightly different.\n\
    \                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    \
    \                                 |           Sequence #          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |A|H|L|K|         Reserved        |            Lifetime           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                                 |\n   .\
    \                                                                 .\n   .    \
    \                       Mobility options                      .\n   .        \
    \                                                         .\n   |            \
    \                                                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \             Figure 8:  Fast Binding Update (FBU) Message\n   IP Fields:\n  \
    \       Source Address: The PCoA or NCoA\n         Destination Address: The IP\
    \ address of the Previous Access\n         Router\n      'A' flag: MUST be set\
    \ to one to request that PAR send a Fast\n      Binding Acknowledgment message.\n\
    \      'H' flag: MUST be set to one.  See [RFC3775].\n      'L' flag: See [RFC3775].\n\
    \      'K' flag: See [RFC3775].\n      Reserved: This field is unused.  MUST be\
    \ set to zero.\n      Sequence Number: See [RFC3775].\n      Lifetime: The requested\
    \ time in seconds for which the sender\n      wishes to have a binding.\n    \
    \  Mobility Options: MUST contain an alternate CoA option set to the\n      NCoA\
    \ when an FBU is sent from the PAR's link.  MUST contain the\n      Binding Authorization\
    \ Data for the FMIP (BADF) option.  See\n      Section 6.5.4.  MAY contain the\
    \ Mobility Header LLA option (see\n      Section 6.5.3).\n   The MN sends an FBU\
    \ message any time after receiving a PrRtAdv\n   message.  If the MN moves prior\
    \ to receiving a PrRtAdv message, it\n   SHOULD send an FBU to the PAR after configuring\
    \ the NCoA on the NAR\n   according to Neighbor Discovery and IPv6 Address Configuration\n\
    \   protocols.  When the MN moves without having received a PrRtAdv\n   message,\
    \ it cannot transmit an UNA message upon attaching to the\n   NAR's link.\n  \
    \ The source IP address is the PCoA when the FBU is sent from the PAR's\n   link,\
    \ and the source IP address is the NCoA when the FBU sent from\n   the NAR's link.\
    \  When the source IP address is the PCoA, the MN MUST\n   include the alternate\
    \ CoA option set to NCoA.  The PAR MUST process\n   the FBU even though the address\
    \ in the alternate CoA option is\n   different from that in the source IP address,\
    \ and ensure that the\n   address in the alternate CoA option is used in the New\
    \ CoA option in\n   the HI message to the NAR.\n   The FBU MUST also include the\
    \ Home Address Option set to PCoA.  An\n   FBU message MUST be protected so that\
    \ the PAR is able to determine\n   that the FBU message is sent by an MN that\
    \ legitimately owns the\n   PCoA.\n"
- title: 6.3.2.  Fast Binding Acknowledgment (FBack)
  contents:
  - "6.3.2.  Fast Binding Acknowledgment (FBack)\n   The Fast Binding Acknowledgment\
    \ message has a Mobility Header Type\n   value of 9.  The FBack message is sent\
    \ by the PAR to acknowledge\n   receipt of a Fast Binding Update message in which\
    \ the 'A' bit is set.\n   If PAR sends an HI message to the NAR after processing\
    \ an FBU, the\n   FBack message SHOULD NOT be sent to the MN before the PAR receives\
    \ a\n   HAck message from the NAR.  The PAR MAY send the FBack immediately in\n\
    \   the reactive mode however.  The Fast Binding Acknowledgment MAY also\n   be\
    \ sent to the MN on the old link.\n                                     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                     |     Status      |K|  Reserved |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |            Sequence #           |            Lifetime           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                                 |\n   .\
    \                                                                 .\n   .    \
    \                       Mobility options                      .\n   .        \
    \                                                         .\n   |            \
    \                                                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Figure 9: Fast Binding Acknowledgment (FBack) Message\n   IP Fields:\n\
    \         Source address: The IP address of the Previous Access Router\n     \
    \    Destination Address: The NCoA, and optionally the PCoA\n      Status: 8-bit\
    \ unsigned integer indicating the disposition of the\n      Fast Binding Update.\
    \  Values of the Status field that are less\n      than 128 indicate that the\
    \ Binding Update was accepted by the\n      receiving node.  The following such\
    \ Status values are currently\n      defined:\n         0 Fast Binding Update\
    \ accepted\n         1 Fast Binding Update accepted but NCoA is invalid.  Use\
    \ NCoA\n         supplied in \"alternate\" CoA\n      Values of the Status field\
    \ greater than or equal to 128 indicate\n      that the Binding Update was rejected\
    \ by the receiving node.  The\n      following such Status values are currently\
    \ defined:\n         128: Reason unspecified\n         129: Administratively prohibited\n\
    \         130: Insufficient resources\n         131: Incorrect interface identifier\
    \ length\n      'K' flag: See [RFC3775].\n      Reserved: An unused field.  MUST\
    \ be set to zero.\n      Sequence Number: Copied from the FBU message for use\
    \ by the MN in\n      matching this acknowledgment with an outstanding FBU.\n\
    \      Lifetime: The granted lifetime in seconds for which the sender of\n   \
    \   this message will retain a binding for traffic redirection.\n      Mobility\
    \ Options: MUST contain an \"alternate\" CoA if Status is 1.\n      MUST contain\
    \ the Binding Authorization Data for FMIP (BADF)\n      option.  See 6.4.5.\n"
- title: 6.4.  Unsolicited Neighbor Advertisement (UNA)
  contents:
  - "6.4.  Unsolicited Neighbor Advertisement (UNA)\n   This is the same message as\
    \ in [RFC4861] with the requirement that\n   the 'O' bit is always set to zero.\
    \  Since this is an unsolicited\n   message, the 'S' bit is zero, and since this\
    \ is sent by an MN, the\n   'R' bit is also zero.\n   If the NAR is proxying the\
    \ NCoA (as a result of HI and HAck\n   exchange), then UNA processing has additional\
    \ steps (see below).  If\n   the NAR is not proxying the NCoA (for instance, HI\
    \ and HAck exchange\n   has not taken place), then UNA processing follows the\
    \ same procedure\n   as specified in [RFC4861].  Implementations MAY retransmit\
    \ UNA\n   subject to the specification in Section 7.2.6 of [RFC4861] while\n \
    \  noting that the default RetransTimer value is large for handover\n   purposes.\n\
    \   The Source Address in UNA MUST be the NCoA.  The destination address\n   is\
    \ typically the all-nodes multicast address; however, some\n   deployments may\
    \ not prefer transmission to a multicast address.  In\n   such cases, the destination\
    \ address SHOULD be the NAR's IP address.\n   The Target Address MUST include\
    \ the NCoA, and the Target link-layer\n   address MUST include the MN's LLA.\n\
    \   The MN sends an UNA message to the NAR, as soon as it regains\n   connectivity\
    \ on the new link.  Arriving or buffered packets can be\n   immediately forwarded.\
    \  If the NAR is proxying the NCoA, it creates a\n   neighbor cache entry in STALE\
    \ state but forwards packets as it\n   determines bidirectional reachability according\
    \ to the standard\n   Neighbor Discovery procedure.  If there is an entry in INCOMPLETE\n\
    \   state without a link-layer address, it sets it to STALE, again\n   according\
    \ to the procedure in [RFC4861].\n   The NAR MAY wish to provide a different IP\
    \ address to the MN than the\n   one in the UNA message.  In such a case, the\
    \ NAR MUST delete the\n   proxy entry for the NCoA and send a Router Advertisement\
    \ with the\n   NAACK option containing the new IP address.\n   The combination\
    \ of the NCoA (present in source IP address) and the\n   Link-Layer Address (present\
    \ as a Target LLA) SHOULD be used to\n   distinguish the MN from other nodes.\n"
- title: 6.5.  New Options
  contents:
  - "6.5.  New Options\n   All the options, with the exception of Binding Data Authorization\
    \ for\n   FMIPv6 (BADF) discussed in Section 6.5.4, use Type, Length, and\n  \
    \ Option-Code format shown in Figure 10.\n   The Type values are defined from\
    \ the Neighbor Discovery options\n   space.  The Length field is in units of 8\
    \ octets, except for the\n   Mobility Header Link-Layer Address option, whose\
    \ Length field is in\n   units of octets in accordance with Section 6.2 in [RFC3775].\
    \  And,\n   Option-Code provides additional information for each of the options\n\
    \   (see individual options below).\n    0                   1               \
    \    2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |     Length    |  Option-Code  |               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   ~                                  ...                          ~\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                       Figure 10: Option Format\n"
- title: 6.5.1.  IP Address/Prefix Option
  contents:
  - "6.5.1.  IP Address/Prefix Option\n   This option is sent in the Proxy Router\
    \ Advertisement, the Handover\n   Initiate, and Handover Acknowledge messages.\n\
    \    0                   1                   2                   3\n    0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |   Length      | Option-Code   | Prefix Length |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                             Reserved                          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                                                             +\n   |        \
    \                                                       |\n   +              \
    \               IPv6 Address                      +\n   |                    \
    \                                           |\n   +                          \
    \                                     +\n   |                                \
    \                               |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \               Figure 11: IPv6 Address/Prefix Option\n   Type: 17\n   Length:\
    \ The size of this option in 8 octets including the Type,\n   Option-Code, and\
    \ Length fields.\n   Option-Code:\n         1: Old Care-of Address\n         2:\
    \ New Care-of Address\n         3: NAR's IP address\n         4: NAR's Prefix,\
    \ sent in PrRtAdv.  The Prefix Length field\n         contains the number of valid\
    \ leading bits in the prefix.  The\n         bits in the prefix after the prefix\
    \ length are reserved and\n         MUST be initialized to zero by the sender\
    \ and ignored by the\n         receiver.\n   Prefix Length: 8-bit unsigned integer\
    \ that indicates the length of\n   the IPv6 Address Prefix.  The value ranges\
    \ from 0 to 128.\n   Reserved: MUST be set to zero by the sender and MUST be ignored\
    \ by\n   the receiver.\n   IPv6 address: The IP address defined by the Option-Code\
    \ field.\n"
- title: 6.5.2.  Link-Layer Address (LLA) Option
  contents:
  - "6.5.2.  Link-Layer Address (LLA) Option\n    0                   1          \
    \         2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Type      |    Length     |  Option-Code  |       LLA...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 12: Link-Layer Address Option\n   Type: 19\n   Length:\
    \ The size of this option in 8 octets including the Type,\n   Option-Code, and\
    \ Length fields.\n   Option-Code:\n         0: wildcard requesting resolution\
    \ for all nearby access points\n         1: Link-Layer Address of the New Access\
    \ Point\n         2: Link-Layer Address of the MN\n         3: Link-Layer Address\
    \ of the NAR (i.e., Proxied Originator)\n         4: Link-Layer Address of the\
    \ source of RtSolPr or PrRtAdv\n         message\n         5: The access point\
    \ identified by the LLA belongs to the\n         current interface of the router\n\
    \         6: No prefix information available for the access point\n         identified\
    \ by the LLA\n         7: No fast handovers support available for the access point\n\
    \         identified by the LLA\n      LLA: The variable length link-layer address.\n\
    \   The LLA option does not have a length field for the LLA itself.  The\n   implementations\
    \ must consult the specific link layer over which the\n   protocol is run in order\
    \ to determine the content and length of the\n   LLA.\n   Depending on the size\
    \ of individual LLA option, appropriate padding\n   MUST be used to ensure that\
    \ the entire option size is a multiple of 8\n   octets.\n   The New Access Point\
    \ Link-Layer Address contains the link-layer\n   address of the access point for\
    \ which handover is about to be\n   attempted.  This is used in the Router Solicitation\
    \ for Proxy\n   Advertisement message.\n   The MN Link-Layer Address option contains\
    \ the link-layer address of\n   an MN.  It is used in the Handover Initiate message.\n\
    \   The NAR (i.e., Proxied Originator) Link-Layer Address option contains\n  \
    \ the link-layer address of the access router to which the Proxy Router\n   Solicitation\
    \ message refers.\n"
- title: 6.5.3.  Mobility Header Link-Layer Address (MH-LLA) Option
  contents:
  - "6.5.3.  Mobility Header Link-Layer Address (MH-LLA) Option\n   This option is\
    \ identical to the LLA option, but is carried in the\n   Mobility Header messages,\
    \ e.g., FBU.  In the future, other Mobility\n   Header messages may also make\
    \ use of this option.  The format of the\n   option is shown in Figure 13.  There\
    \ are no alignment requirements\n   for this option.\n    0                  \
    \ 1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                                 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                 |     Type      |     Length    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   | Option-Code   |                  LLA                     ....\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \         Figure 13: Mobility Header Link-Layer Address Option\n   Type: 7\n \
    \  Length: The size of this option in octets not including the Type and\n   Length\
    \ fields.\n   Option-Code: 2 Link-Layer Address of the MN.\n   LLA: The variable\
    \ length link-layer address.\n"
- title: 6.5.4.  Binding Authorization Data for FMIPv6 (BADF)
  contents:
  - "6.5.4.  Binding Authorization Data for FMIPv6 (BADF)\n   This option MUST be\
    \ present in FBU and FBack messages.  The security\n   association between the\
    \ MN and the PAR is established by companion\n   protocols [RFC5269].  This option\
    \ specifies how to compute and verify\n   a Message Authentication Code (MAC)\
    \ using the established security\n   association.\n   The format of this option\
    \ is shown in Figure 14.\n    0                   1                   2      \
    \             3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n                                   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                   |     Type      | Option Length |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                            SPI                                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   +  \
    \                                                             +\n   |        \
    \                 Authenticator                         |\n   +              \
    \                                                 +\n   |                    \
    \                                           |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    Figure 14: Binding Authorization Data for FMIPv6 (BADF) Option\n   Type:\
    \ 21\n   Option Length: The length of the Authenticator in bytes\n   SPI: Security\
    \ Parameter Index.  SPI = 0 is reserved for the\n   Authenticator computed using\
    \ SEND-based handover keys.\n   Authenticator: Same as in RFC 3775, with \"correspondent\"\
    \ replaced by\n   the PAR's IP address, and Kbm replaced by the shared key between\
    \ the\n   MN and the PAR.\n   The default MAC calculation is done using HMAC_SHA1\
    \ with the first 96\n   bits used for the MAC.  Since there is an Option Length\
    \ field,\n   implementations can use other algorithms such as HMAC_SHA256.\n \
    \  This option MUST be the last Mobility Option present.\n"
- title: 6.5.5.  Neighbor Advertisement Acknowledgment (NAACK)
  contents:
  - "6.5.5.  Neighbor Advertisement Acknowledgment (NAACK)\n    0                \
    \   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |      Type     |     Length    | Option-Code   |    Status     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                             Reserved                          |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \        Figure 15: Neighbor Advertisement Acknowledgment Option\n   Type: 20\n\
    \   Length: 8-bit unsigned integer.  Length of the option, in 8 octets.\n   The\
    \ length is 1 when a new CoA is not supplied.  The length is 3 when\n   a new\
    \ CoA is present (immediately following the Reserved field)\n   Option-Code: 0\n\
    \   Status: 8-bit unsigned integer indicating the disposition of the\n   Unsolicited\
    \ Neighbor Advertisement message.  The following Status\n   values are currently\
    \ defined:\n         1: NCoA is invalid, perform address configuration\n     \
    \    2: NCoA is invalid, use the supplied NCoA.  The supplied NCoA\n         (in\
    \ the form of an IP Address Option) MUST be present following\n         the Reserved\
    \ field.\n         3: NCoA is invalid, use NAR's IP address as NCoA in FBU\n \
    \        4: PCoA supplied, do not send FBU\n         128: Link-Layer Address unrecognized\n\
    \      Reserved: MUST be set to zero by the sender and MUST be ignored by\n  \
    \    the receiver.\n   The NAR responds to UNA with the NAACK option to notify\
    \ the MN to use\n   a different NCoA than the one that the MN has used.  If the\
    \ NAR\n   proposes a different NCoA, the Router Advertisement MUST use the\n \
    \  source IP address in the UNA message as the destination address, and\n   use\
    \ the L2 address present in UNA.  The MN MUST use the NCoA if it is\n   supplied\
    \ with the NAACK option.  If the NAACK indicates that the\n   Link-Layer Address\
    \ is unrecognized, for instance, if the MN uses an\n   LLA valid on PAR's link\
    \ but the same LLA is not valid on NAR's link\n   due to a different access technology,\
    \ the MN MUST NOT use the NCoA or\n   the PCoA and SHOULD start immediately the\
    \ process of acquiring a\n   different NCoA at the NAR.\n   In the future, new\
    \ option types may be defined.\n"
- title: 7.  Related Protocol and Device Considerations
  contents:
  - "7.  Related Protocol and Device Considerations\n   The protocol specified here,\
    \ as a design principle, introduces no or\n   minimal changes to related protocols.\
    \  For example, no changes to the\n   base Mobile IPv6 protocol are needed in\
    \ order to implement this\n   protocol.  Similarly, no changes to the IPv6 stateless\
    \ address auto-\n   configuration protocol [RFC4862] and DHCP [RFC3315] are introduced.\n\
    \   The protocol specifies an optional extension to Neighbor Discovery\n   [RFC4861]\
    \ in which an access router may send a router advertisement\n   as a response\
    \ to the UNA message (see Section 6.4).  Other than this\n   extension, the specification\
    \ does not modify Neighbor Discovery\n   behavior (including the procedures performed\
    \ when attached to the PAR\n   and when attaching to the NAR).\n   The protocol\
    \ does not require changes to any intermediate Layer 2\n   device between an MN\
    \ and its access router that supports this\n   specification.  This includes the\
    \ wireless access points, switches,\n   snooping devices, and so on.\n"
- title: 8.  Evolution from and Compatibility with RFC 4068
  contents:
  - "8.  Evolution from and Compatibility with RFC 4068\n   This document has evolved\
    \ from [RFC4068].  Specifically, a new\n   handover key establishment protocol\
    \ (see [RFC5269]) has been defined\n   to enable a security association between\
    \ a mobile node and its access\n   router.  This allows the secure update of the\
    \ routing of packets\n   during a handover.  In the future, new specifications\
    \ may be defined\n   to establish such security associations depending on the\
    \ particular\n   deployment scenario.\n   The protocol has improved from the experiences\
    \ in implementing\n   [RFC4068], and from experimental usage.  The input has improved\
    \ the\n   specification of parameter fields (such as lifetime, codepoints,\n \
    \  etc.)  as well as inclusion of new parameter fields in the existing\n   messages.\
    \  As of this writing, there are two publicly available\n   implementations, [fmipv6]\
    \ and [tarzan], and multiple proprietary\n   implementations.  Some experience\
    \ suggests that the protocol meets\n   the delay and packet loss requirements\
    \ when used appropriately with\n   particular radio access protocols.  For instance,\
    \ see [RFC5184] and\n   [mip6-book].  Nevertheless, it is important to recognize\
    \ that\n   handover performance is a function of both IP layer operations, which\n\
    \   this protocol specifies, and the particular radio access technology\n   itself,\
    \ which this protocol relies upon but does not modify.\n   An existing implementation\
    \ of [RFC4068] needs to be updated in order\n   to support this specification.\
    \  The primary addition is the\n   establishment of a security association between\
    \ an MN and its access\n   router (i.e., MN and PAR).  One way to establish such\
    \ a security\n   association is specified in [RFC5269].  An implementation that\n\
    \   complies with the specification in this document is likely to also\n   work\
    \ with [RFC4068], except for the Binding Authorization Data for\n   FMIPv6 option\
    \ (see Section 6.5.4) that can only be processed when\n   security association\
    \ is in place between a mobile node and its access\n   router.  This specification\
    \ deprecates the Fast Neighbor\n   Advertisement (FNA) message.  However, it is\
    \ acceptable for a NAR to\n   process this message from a mobile node as specified\
    \ in [RFC4068].\n"
- title: 9.  Configurable Parameters
  contents:
  - "9.  Configurable Parameters\n   Mobile nodes rely on configuration parameters\
    \ shown in the table\n   below.  Each mobile node MUST have a configuration mechanism\
    \ to\n   adjust the parameters.  Such a configuration mechanism may be either\n\
    \   local (such as a command line interface) or based on central\n   management\
    \ of a number of mobile nodes.\n   +-------------------+---------------+---------------+\n\
    \   |   Parameter Name  | Default Value |   Definition  |\n   +-------------------+---------------+---------------+\n\
    \   |  RTSOLPR_RETRIES  |       3       | Section 6.1.1 |\n   |  MAX_RTSOLPR_RATE\
    \ |       3       | Section 6.1.1 |\n   |    FBU_RETRIES    |       3       |\
    \ Section 6.3.1 |\n   | PROXY_ND_LIFETIME |  1.5 seconds  | Section 6.2.2 |\n\
    \   |     HI_RETRIES    |       3       | Section 6.2.1 |\n   +-------------------+---------------+---------------+\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   The following security vulnerabilities are identified\
    \ and suggested\n   solutions are mentioned.\n      Insecure FBU: in this case,\
    \ packets meant for one address could be\n      stolen or redirected to some unsuspecting\
    \ node.  This concern is\n      the same as that in an MN and Home Agent relationship.\
    \  Hence, the\n      PAR MUST ensure that the FBU packet arrived from a node that\n\
    \      legitimately owns the PCoA.  The access router and its hosts may\n    \
    \  use any available mechanism to establish a security association\n      that\
    \ MUST be used to secure FBU.  The current version of this\n      protocol relies\
    \ on a companion protocol [RFC5269] to establish\n      such a security association.\
    \  Using the shared handover key from\n      [RFC5269], the Authenticator in BADF\
    \ option (see Section 6.5.4)\n      MUST be computed, and the BADF option included\
    \ in FBU and FBack\n      messages.\n      Secure FBU, malicious or inadvertent\
    \ redirection: in this case,\n      the FBU is secured, but the target of binding\
    \ happens to be an\n      unsuspecting node either due to inadvertent operation\
    \ or due to\n      malicious intent.  This vulnerability can lead to an MN with\
    \ a\n      genuine security association with its access router redirecting\n \
    \     traffic to an incorrect address.\n      However, the target of malicious\
    \ traffic redirection is limited to\n      an interface on an access router with\
    \ which the PAR has a security\n      association.  The PAR MUST verify that the\
    \ NCoA to which PCoA is\n      being bound actually belongs to NAR's prefix. \
    \ In order to do\n      this, HI and HAck message exchanges are to be used.  When\
    \ NAR\n      accepts NCoA in HI (with Code = 0), it proxies NCoA so that any\n\
    \      arriving packets are not sent on the link until the MN attaches\n     \
    \ and announces itself through UNA.  Therefore, any inadvertent or\n      malicious\
    \ redirection to a host is avoided.  It is still possible\n      to jam a NAR's\
    \ buffer with redirected traffic.  However, since a\n      NAR's handover state\
    \ corresponding to an NCoA has a finite (and\n      short) lifetime corresponding\
    \ to a small multiple of anticipated\n      handover latency, the extent of this\
    \ vulnerability is arguably\n      small.\n      Sending an FBU from a NAR's link:\
    \ A malicious node may send an FBU\n      from a NAR's link providing an unsuspecting\
    \ node's address as an\n      NCoA.  This is similar to base Mobile IP where the\
    \ MN can provide\n      some other node's IP address as its CoA to its Home Agent;\
    \ here\n      the PAR acts like a \"temporary Home Agent\" having a security\n\
    \      association with the Mobile Node and providing forwarding support\n   \
    \   for the handover traffic.  As in base Mobile IP, this misdelivery\n      is\
    \ traceable to the MN that has a security association with the\n      router.\
    \  So, it is possible to isolate such an MN if it continues\n      to misbehave.\
    \  Similarly, an MN that has a security association\n      with the PAR may provide\
    \ the LLA of some other node on NAR's link,\n      which can cause misdelivery\
    \ of packets (meant for the NCoA) to an\n      unsuspecting node.  It is possible\
    \ to trace the MN in this case as\n      well.\n   Apart from the above, the RtSolPr\
    \ (Section 6.1.1) and PrRtAdv\n   (Section 6.1.2) messages inherit the weaknesses\
    \ of Neighbor Discovery\n   protocol [RFC4861].  Specifically, when its access\
    \ router is\n   compromised, the MN's RtSolPr message may be answered by an attacker\n\
    \   that provides a rogue router as the resolution.  Should the MN attach\n  \
    \ to such a rogue router, its communication can be compromised.\n   Similarly,\
    \ a network-initiated PrRtAdv message (see Section 3.3) from\n   an attacker could\
    \ cause an MN to handover to a rogue router.  Where\n   these weaknesses are a\
    \ concern, a solution such as Secure Neighbor\n   Discovery (SEND) [RFC3971] SHOULD\
    \ be considered.\n   The protocol provides support for buffering packets during\
    \ an MN's\n   handover.  This is done by securely exchanging the Handover Initiate\n\
    \   (HI) and Handover Acknowledgment (HAck) messages in response to the\n   FBU\
    \ message from an MN.  It is possible that an MN may fail, either\n   inadvertently\
    \ or purposely, to undergo handover to the NAR, which\n   typically provides buffering\
    \ support.  This can cause the NAR to\n   waste its memory containing the buffered\
    \ packets, and in the worst\n   case, could create resource exhaustion concerns.\
    \  Hence,\n   implementations must limit the size of the buffer as a local policy\n\
    \   configuration, which may consider parameters such as the average\n   handover\
    \ delay, expected size of packets, and so on.\n   The Handover Initiate (HI) and\
    \ Handover Acknowledgement (HAck)\n   messages exchanged between the PAR and NAR\
    \ MUST be protected using\n   end-to-end security association(s) offering integrity\
    \ and data origin\n   authentication.\n   The PAR and the NAR MUST implement IPsec\
    \ [RFC4301] for protecting the\n   HI and HAck messages.  IPsec Encapsulating\
    \ Security Payload (ESP)\n   [RFC4303] in transport mode with mandatory integrity\
    \ protection\n   SHOULD be used for protecting the signaling messages.\n   Confidentiality\
    \ protection of these messages is not required.\n   The security associations\
    \ can be created by using either manual IPsec\n   configuration or a dynamic key\
    \ negotiation protocol such as Internet\n   Key Exchange Protocol version 2 (IKEv2)\
    \ [RFC4306].  If IKEv2 is used,\n   the PAR and the NAR can use any of the authentication\
    \ mechanisms, as\n   specified in RFC 4306, for mutual authentication.  However,\
    \ to ensure\n   a baseline interoperability, the implementations MUST support\
    \ shared\n   secrets for mutual authentication.  The following sections describe\n\
    \   the Peer Authorization Database (PAD) and Security Policy Database\n   (SPD)\
    \ entries specified in [RFC4301] when IKEv2 is used for setting\n   up the required\
    \ IPsec security associations.\n"
- title: 10.1.  Peer Authorization Database Entries when Using IKEv2
  contents:
  - "10.1.  Peer Authorization Database Entries when Using IKEv2\n   This section\
    \ describes PAD entries on the PAR and the NAR.  The PAD\n   entries are only\
    \ example configurations.  Note that the PAD is a\n   logical concept and a particular\
    \ PAR or NAR implementation can\n   implement the PAD in any implementation specific\
    \ manner.  The PAD\n   state may also be distributed across various databases\
    \ in a specific\n   implementation.\n   PAR PAD:\n      - IF remote_identity =\
    \ nar_identity_1\n      THEN authenticate (shared secret/certificate/EAP) and\
    \ authorize\n      CHILD_SA for remote address nar_address_1\n   NAR PAD:\n  \
    \    - IF remote_identity = par_identity_1\n      THEN authenticate (shared secret/certificate/EAP)\
    \ and authorize\n      CHILD_SAs for remote address par_address_1\n   The list\
    \ of authentication mechanisms in the above examples is not\n   exhaustive.  There\
    \ could be other credentials used for authentication\n   stored in the PAD.\n"
- title: 10.2.  Security Policy Database Entries
  contents:
  - "10.2.  Security Policy Database Entries\n   This section describes the security\
    \ policy entries on the PAR and the\n   NAR required to protect the HI and HAck\
    \ messages.  The SPD entries\n   are only example configurations.  A particular\
    \ PAR or NAR\n   implementation could configure different SPD entries as long\
    \ as they\n   provide the required security.\n   In the examples shown below,\
    \ the identity of the PAR is assumed to be\n   par_1, the address of the PAR is\
    \ assumed to be par_address_1, and the\n   address of the NAR is assumed to be\
    \ nar_address_1.\n   PAR SPD-S:\n      - IF local_address = par_address_1 & remote_address\
    \ =\n      nar_address_1 & proto = ICMPv6 & local_icmpv6_type = HI &\n      remote_icmpv6_type\
    \ = HAck\n      THEN use SA ESP transport mode Initiate using IDi = par_1 to\n\
    \      address nar_address_1\n   NAR SPD-S:\n      - IF local_address = nar_address_1\
    \ & remote_address =\n      par_address_1 & proto = ICMPv6 & local_icmpv6_type\
    \ = HAck &\n      remote_icmpv6_type = HI\n      THEN use SA ESP transport mode\n"
- title: 11.  IANA Considerations
  contents:
  - "11.  IANA Considerations\n   This document defines a new ICMPv6 message, which\
    \ has been allocated\n   from the ICMPv6 Type registry.\n      154     FMIPv6\
    \ Messages\n   This document creates a new registry for the 'Subtype' field in\
    \ the\n   above ICMPv6 message, called the \"FMIPv6 Message Types\".  IANA has\n\
    \   assigned the following values.\n   +---------+-------------+---------------+\n\
    \   | Subtype | Description |   Reference   |\n   +---------+-------------+---------------+\n\
    \   |   2     |   RtSolPr   | Section 6.1.1 |\n   |   3     |   PrRtAdv   | Section\
    \ 6.1.2 |\n   |   4     |      HI     | Section 6.2.1 |\n   |   5     |     HAck\
    \    | Section 6.2.2 |\n   +---------+-------------+---------------+\n   The values\
    \ '0' and '1' are reserved.  The upper limit is 255.  An RFC\n   is required for\
    \ new message assignment.\n   The document defines a new Mobility Option that\
    \ has received Type\n   assignment from the Mobility Options Type registry.\n\
    \      1.  Binding Authorization Data for FMIPv6 (BADF) option, described\n  \
    \        in Section 6.5.4\n   The document has received Type assignments for the\
    \ following (see\n   [RFC4068]):\n   The document defines the following Neighbor\
    \ Discovery [RFC4861]\n   options that have received Type assignment from IANA.\n\
    \   +---------+-----------------------------------------+---------------+\n  \
    \ |   Type  |               Description               |   Reference   |\n   +---------+-----------------------------------------+---------------+\n\
    \   |    17   |         IP Address/Prefix Option        | Section 6.5.1 |\n  \
    \ |    19   |        Link-layer Address Option        | Section 6.5.2 |\n   |\
    \    20   |  Neighbor Advertisement Acknowledgment  | Section 6.5.5 |\n   |  \
    \       |                  Option                 |               |\n   +---------+-----------------------------------------+---------------+\n\
    \   The document defines the following Mobility Header messages that have\n  \
    \ received Type allocation from the Mobility Header Types registry.\n      1.\
    \  Fast Binding Update, described in Section 6.3.1\n      2.  Fast Binding Acknowledgment,\
    \ described in Section 6.3.2\n   The document defines the following Mobility Option\
    \ that has received\n   Type assignment from the Mobility Options Type registry.\n\
    \      1.  Mobility Header Link-Layer Address option, described in\n         \
    \ Section 6.5.3\n"
- title: 12.  Acknowledgments
  contents:
  - "12.  Acknowledgments\n   The editor would like to thank all those who have provided\
    \ feedback\n   on this specification, but can only mention a few here: Vijay\n\
    \   Devarapalli, Youn-Hee Han, Emil Ivov, Syam Madanapalli, Suvidh\n   Mathur,\
    \ Andre Martin, Javier Martin, Koshiro Mitsuya, Gabriel\n   Montenegro, Takeshi\
    \ Ogawa, Sun Peng, YC Peng, Alex Petrescu, Domagoj\n   Premec, Subba Reddy, K.\
    \ Raghav, Ranjit Wable, and Jonathan Wood.\n   Behcet Sarikaya and Frank Xia are\
    \ acknowledged for the feedback on\n   operation over point-to-point links.  The\
    \ editor would like to\n   acknowledge a contribution from James Kempf to improve\
    \ this\n   specification.  Vijay Devarapalli provided text for the security\n\
    \   configuration between access routers in Section 10.  Thanks to Jari\n   Arkko\
    \ for the detailed AD Review, which has improved this document.\n   The editor\
    \ would also like to thank the [mipshop] working group chair\n   Gabriel Montenegro\
    \ and the erstwhile [mobile ip] working group chairs\n   Basavaraj Patil and Phil\
    \ Roberts for providing much support for this\n   work.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [RFC2119]     Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                 Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [RFC5269]     Kempf, J. and R. Koodli, \"Distributing a Symmetric\
    \ Fast\n                 Mobile IPv6 (FMIPv6) Handover Key Using SEcure Neighbor\n\
    \                 Discovery (SEND)\", RFC 5269, June 2008.\n   [RFC4443]     Conta,\
    \ A., Deering, S., and M. Gupta, Ed., \"Internet\n                 Control Message\
    \ Protocol (ICMPv6) for the Internet\n                 Protocol Version 6 (IPv6)\
    \ Specification\", RFC 4443,\n                 March 2006.\n   [RFC3315]     Droms,\
    \ R., Ed., Bound, J., Volz, B., Lemon, T.,\n                 Perkins, C., and\
    \ M. Carney, \"Dynamic Host Configuration\n                 Protocol for IPv6\
    \ (DHCPv6)\", RFC 3315, July 2003.\n   [RFC3775]     Johnson, D., Perkins, C.,\
    \ and J. Arkko, \"Mobility\n                 Support in IPv6\", RFC 3775, June\
    \ 2004.\n   [RFC4301]     Kent, S. and K. Seo, \"Security Architecture for the\n\
    \                 Internet Protocol\", RFC 4301, December 2005.\n   [RFC4303]\
    \     Kent, S., \"IP Encapsulating Security Payload (ESP)\",\n               \
    \  RFC 4303, December 2005.\n   [RFC4306]     Kaufman, C., Ed., \"Internet Key\
    \ Exchange (IKEv2)\n                 Protocol\", RFC 4306, December 2005.\n  \
    \ [RFC4861]     Narten, T., Nordmark, E., Simpson, W., and H. Soliman,\n     \
    \            \"Neighbor Discovery for IP version 6 (IPv6)\", RFC 4861,\n     \
    \            September 2007.\n   [RFC4862]     Thomson, S., Narten, T., and T.\
    \ Jinmei, \"IPv6 Stateless\n                 Address Autoconfiguration\", RFC\
    \ 4862, September 2007.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [fmipv6]      \"fmipv6.org : Home Page\", <http://fmipv6.org>.\n\
    \   [mip6-book]   Koodli, R. and C. Perkins, \"Mobile Internetworking with\n \
    \                IPv6, Chapter 22, John Wiley & Sons.\", July 2007.\n   [RFC3290]\
    \     Bernet, Y., Blake, S., Grossman, D., and A. Smith, \"An\n              \
    \   Informal Management Model for Diffserv Routers\", RFC\n                 3290,\
    \ May 2002.\n   [RFC3971]     Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,\n\
    \                 \"SEcure Neighbor Discovery (SEND)\", RFC 3971, March\n    \
    \             2005.\n   [RFC4068]     Koodli, R., Ed., \"Fast Handovers for Mobile\
    \ IPv6\", RFC\n                 4068, July 2005.\n   [RFC5184]     Teraoka, F.,\
    \ Gogo, K., Mitsuya, K., Shibui, R., and K.\n                 Mitani, \"Unified\
    \ Layer 2 (L2) Abstractions for Layer 3\n                 (L3)-Driven Fast Handover\"\
    , RFC 5184, May 2008.\n   [tarzan]      \"Nautilus6 - Tarzan\",\n            \
    \     <http://software.nautilus6.org/TARZAN/>.\n"
- title: Appendix A.  Contributors
  contents:
  - "Appendix A.  Contributors\n   This document has its origins in the fast handover\
    \ design team in the\n   erstwhile [mobile ip] working group.  The members of\
    \ this design team\n   in alphabetical order were; Gopal Dommety, Karim El-Malki,\
    \ Mohammed\n   Khalil, Charles Perkins, Hesham Soliman, George Tsirtsis, and Alper\n\
    \   Yegin.\n"
- title: Appendix B.  Changes since RFC 4068
  contents:
  - "Appendix B.  Changes since RFC 4068\n   Following are the major changes and clarifications:\n\
    \   o  Specified security association between the MN and its Access\n      Router\
    \ in the companion document [RFC5269].\n   o  Specified Binding Authorization\
    \ Data for Fast Handovers (BADF)\n      option to carry the security parameters\
    \ used for verifying the\n      authenticity of FBU and FBack messages.  The handover\
    \ key used for\n      computing the Authenticator is specified in companion documents.\n\
    \   o  Specified the security configuration for inter - access router\n      signaling\
    \ (HI, HAck).\n   o  Added a section on prefix management between access routers\
    \ and\n      illustrated protocol operation over point-to-point links.\n   o \
    \ Deprecated FNA, which is a Mobility Header message.  In its place,\n      the\
    \ Unsolicited Neighbor Advertisement (UNA) message from RFC 4861\n      is used.\n\
    \   o  Combined the IPv6 Address Option and IPv6 Prefix Option.\n   o  Added description\
    \ of DAD requirement on NAR when determining NCoA\n      uniqueness in Section\
    \ 4, \"Protocol Details\".\n   o  Added a new code value for gratuitous HAck message\
    \ to trigger a HI\n      message.\n   o  Added Option-Code 5 in PrRtAdv message\
    \ to indicate NETLMM usage.\n   o  Clarified protocol usage when DHCP is used\
    \ for NCoA formulation\n      (Sections 6.1.2, 3.1, and 5.2).  Added a new Code\
    \ value (5) in\n      PrRtAdv (Section 6.1.2).\n   o  Clarified that IPv6 Neighbor\
    \ Discovery operations are a must in\n      Section 7, \"Related Protocol and\
    \ Device Considerations\".\n   o  Clarified \"PAR = temporary HA\" for FBUs sent\
    \ by a genuine MN to an\n      unsuspecting CoA.\n"
- title: Editor's Address
  contents:
  - "Editor's Address\n   Rajeev Koodli\n   Starent Networks\n   USA\n   EMail: rkoodli@starentnetworks.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2008).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
