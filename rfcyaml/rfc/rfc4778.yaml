- title: __initial_text__
  contents:
  - "               Current Operational Security Practices in\n                 Internet\
    \ Service Provider Environments\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The IETF Trust (2007).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document is a survey of the current practices used in today's\n\
    \   large ISP operational networks to secure layer 2 and layer 3\n   infrastructure\
    \ devices.  The information listed here is the result of\n   information gathered\
    \ from people directly responsible for defining\n   and implementing secure infrastructures\
    \ in Internet Service Provider\n   environments.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  2\n     1.1.  Scope  . . . . . . . . . . . . . . . . . . . . .\
    \ . . . . .  2\n     1.2.  Threat Model . . . . . . . . . . . . . . . . . . .\
    \ . . . .  3\n     1.3.  Attack Sources . . . . . . . . . . . . . . . . . . .\
    \ . . .  4\n     1.4.  Operational Security Impact from Threats . . . . . . .\
    \ . .  5\n     1.5.  Document Layout  . . . . . . . . . . . . . . . . . . . .\
    \ .  7\n   2.  Protected Operational Functions  . . . . . . . . . . . . . . .\
    \  8\n     2.1.  Device Physical Access . . . . . . . . . . . . . . . . . .  8\n\
    \     2.2.  Device Management - In-Band and Out-of-Band (OOB)  . . . . 10\n  \
    \   2.3.  Data Path  . . . . . . . . . . . . . . . . . . . . . . . . 16\n    \
    \ 2.4.  Routing Control Plane  . . . . . . . . . . . . . . . . . . 18\n     2.5.\
    \  Software Upgrades and Configuration\n           Integrity/Validation . . .\
    \ . . . . . . . . . . . . . . . . 22\n     2.6.  Logging Considerations . . .\
    \ . . . . . . . . . . . . . . . 26\n     2.7.  Filtering Considerations . . .\
    \ . . . . . . . . . . . . . . 29\n     2.8.  Denial-of-Service Tracking/Tracing\
    \ . . . . . . . . . . . . 30\n   3.  Security Considerations  . . . . . . . .\
    \ . . . . . . . . . . . 32\n   4.  Acknowledgments  . . . . . . . . . . . . .\
    \ . . . . . . . . . . 32\n   5.  References . . . . . . . . . . . . . . . . .\
    \ . . . . . . . . . 33\n     5.1.  Normative References . . . . . . . . . . .\
    \ . . . . . . . . 33\n     5.2.  Informational References . . . . . . . . . .\
    \ . . . . . . . 33\n   Appendix A.  Protocol Specific Attacks . . . . . . . .\
    \ . . . . . . 34\n     A.1.  Layer 2 Attacks  . . . . . . . . . . . . . . . .\
    \ . . . . . 34\n     A.2.  IPv4 Protocol-Based Attacks  . . . . . . . . . . .\
    \ . . . . 34\n     A.3.  IPv6 Attacks . . . . . . . . . . . . . . . . . . . .\
    \ . . . 36\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Security practices are well understood by the network operators\
    \ who\n   have, for many years, gone through the growing pains of securing\n \
    \  their network infrastructures.  However, there does not exist a\n   written\
    \ document that enumerates these security practices.  Network\n   attacks are\
    \ continually increasing and although it is not necessarily\n   the role of an\
    \ ISP to act as the Internet police, each ISP has to\n   ensure that certain security\
    \ practices are followed to ensure that\n   their network is operationally available\
    \ for their customers.  This\n   document is the result of a survey conducted\
    \ to find out what current\n   security practices are being deployed to secure\
    \ network\n   infrastructures.\n"
- title: 1.1.  Scope
  contents:
  - "1.1.  Scope\n   The scope for this survey is restricted to security practices\
    \ that\n   mitigate exposure to risks with the potential to adversely impact\n\
    \   network availability and reliability.  Securing the actual data\n   traffic\
    \ is outside the scope of the conducted survey.  This document\n   focuses solely\
    \ on documenting currently deployed security mechanisms\n   for layer 2 and layer\
    \ 3 network infrastructure devices.  Although\n   primarily focused on IPv4, many\
    \ of the same practices can (and\n   should) apply to IPv6 networks.  Both IPv4\
    \ and IPv6 network\n   infrastructures are taken into account in this survey.\n"
- title: 1.2.  Threat Model
  contents:
  - "1.2.  Threat Model\n   A threat is a potential for a security violation, which\
    \ exists when\n   there is a circumstance, capability, action, or event that could\n\
    \   breach security and cause harm [RFC2828].  Every operational network\n   is\
    \ subject to a multitude of threat actions, or attacks, i.e., an\n   assault on\
    \ system security that derives from an intelligent act that\n   is a deliberate\
    \ attempt to evade security services, and violate the\n   security policy of a\
    \ system [RFC2828].  Many of the threats to a\n   network infrastructure occur\
    \ from an instantiation (or combination)\n   of the following:\n   Reconnaissance:\
    \ An attack whereby information is gathered to\n   ascertain the network topology\
    \ or specific device information, which\n   can be further used to exploit known\
    \ vulnerabilities\n   Man-In-The-Middle: An attack where a malicious user impersonates\n\
    \   either the sender or recipient of a communication stream while\n   inserting,\
    \ modifying, or dropping certain traffic.  This type of\n   attack also covers\
    \ phishing and session hijacks.\n   Protocol Vulnerability Exploitation: An attack\
    \ that takes advantage\n   of known protocol vulnerabilities due to design or\
    \ implementation\n   flaws to cause inappropriate behavior.\n   Message Insertion:\
    \ This can be a valid message (it could be a reply\n   attack, which is a scenario\
    \ where a message is captured and resent at\n   a later time).  A message can\
    \ also be inserted with any of the fields\n   in the message being spoofed, such\
    \ as IP addresses, port numbers,\n   header fields, or even packet content.  Flooding\
    \ is also part of this\n   threat instantiation.\n   Message Diversion/Deletion:\
    \ An attack where legitimate messages are\n   removed before they can reach the\
    \ desired recipient, or are\n   re-directed to a network segment that is normally\
    \ not part of the\n   data path.\n   Message Modification: This is a subset of\
    \ a message insertion attack\n   where a previous message has been captured and\
    \ modified before being\n   retransmitted.  The message can be captured using\
    \ a man-in-the-middle\n   attack or message diversion.\n   Note that sometimes\
    \ denial-of-service attacks are listed as separate\n   categories.  A denial-of-service\
    \ is a consequence of an attack and\n   can be the result of too much traffic\
    \ (i.e., flooding), exploiting\n   protocol exploitation, or inserting/deleting/diverting/modifying\n\
    \   messages.\n"
- title: 1.3.  Attack Sources
  contents:
  - "1.3.  Attack Sources\n   These attacks can be sourced in a variety of ways:\n\
    \   Active vs Passive Attacks\n      An active attack involves writing data to\
    \ the network.  It is\n      common practice in active attacks to disguise one's\
    \ address and\n      conceal the identity of the traffic sender.  A passive attack\n\
    \      involves only reading information off the network.  This is\n      possible\
    \ if the attacker has control of a host in the\n      communications path between\
    \ two victim machines, or has\n      compromised the routing infrastructure to\
    \ specifically arrange\n      that traffic pass through a compromised machine.\
    \  There are also\n      situations where mirrored traffic (often used for debugging,\n\
    \      performance monitoring, or accounting purposes) is diverted to a\n    \
    \  compromised machine, which would not necessarily subvert any\n      existing\
    \ topology, and could be harder to detect.  In general, the\n      goal of a passive\
    \ attack is to obtain information that the sender\n      and receiver would prefer\
    \ to remain private [RFC3552].\n   On-path vs Off-path Attacks\n      In order\
    \ for a datagram to be transmitted from one host to\n      another, it generally\
    \ must traverse some set of intermediate links\n      and routers.  Such routers\
    \ are naturally able to read, modify, or\n      remove any datagram transmitted\
    \ along that path.  This makes it\n      much easier to mount a wide variety of\
    \ attacks if you are on-path.\n      Off-path hosts can transmit arbitrary datagrams\
    \ that appear to\n      come from any host but cannot necessarily receive datagrams\n\
    \      intended for other hosts.  Thus, if an attack depends on being\n      able\
    \ to receive data, off-path hosts must first subvert the\n      topology in order\
    \ to place themselves on-path.  This is by no\n      means impossible, but is\
    \ not necessarily trivial [RFC3552].  A\n      more subtle attack is one where\
    \ the traffic-mirroring capability\n      of a device is hijacked and the traffic\
    \ is diverted to a\n      compromised host since the network topology may not\
    \ need to be\n      subverted.\n   Insider vs Outsider Attacks\n      An \"insider\
    \ attack\" is initiated from inside a given security\n      perimeter by an entity\
    \ that is authorized to access system\n      resources, but uses them in a way\
    \ not approved by those who\n      granted the authorization.  An \"outside attack\"\
    \ is initiated from\n      outside the perimeter by an unauthorized or illegitimate\
    \ user of\n      the system.\n   Deliberate Attacks vs Unintentional Events\n\
    \      A deliberate attack is where a miscreant intentionally performs an\n  \
    \    assault on system security.  However, there are also instances\n      where\
    \ unintentional events cause the same harm, yet are performed\n      without malicious\
    \ intent.  Configuration errors and software bugs\n      can be as devastating\
    \ to network availability as any deliberate\n      attack on the network infrastructure.\n\
    \   The attack source can be a combination of any of the above, all of\n   which\
    \ need to be considered when trying to ascertain the impact any\n   attack can\
    \ have on the availability and reliability of the network.\n   It is nearly impossible\
    \ to stop insider attacks or unintentional\n   events.  However, if appropriate\
    \ monitoring mechanisms are in place,\n   these attacks can also be detected and\
    \ mitigated as with any other\n   attack source.  The amount of effort it takes\
    \ to identify and trace\n   an attack is, of course, dependent on the resourcefulness\
    \ of the\n   attacker.  Any of the specific attacks discussed further in this\n\
    \   document will elaborate on malicious behavior, which are sourced by\n   an\
    \ \"outsider\" and are deliberate attacks.  Some further elaboration\n   will\
    \ be given to the feasibility of passive vs active and on-path vs\n   off-path\
    \ attacks to show the motivation behind deploying certain\n   security features.\n"
- title: 1.4.  Operational Security Impact from Threats
  contents:
  - "1.4.  Operational Security Impact from Threats\n   The main concern for any of\
    \ the potential attack scenarios is the\n   impact and harm it can cause to the\
    \ network infrastructure.  The\n   threat consequences are the security violations\
    \ that results from a\n   threat action, i.e., an attack.  These are typically\
    \ classified as\n   follows:\n   (Unauthorized) Disclosure\n      A circumstance\
    \ or event whereby an entity gains access to data for\n      which the entity\
    \ is not authorized.\n   Deception\n      A circumstance or event that may result\
    \ in an authorized entity\n      receiving false data and believing it to be true.\n\
    \   Disruption\n      A circumstance or event that interrupts or prevents the\
    \ correct\n      operation of system services and functions.  A broad variety\
    \ of\n      attacks, collectively called denial of service attacks, threaten\n\
    \      the availability of systems and bandwidth to legitimate users.\n      Many\
    \ such attacks are designed to consume machine resources,\n      making it difficult\
    \ or impossible to serve legitimate users.\n      Other attacks cause the target\
    \ machine to crash, completely\n      denying service to users.\n   Usurpation\n\
    \      A circumstance or event that results in control of system services\n  \
    \    or functions by an unauthorized entity.  Most network\n      infrastructure\
    \ systems are only intended to be completely\n      accessible to certain authorized\
    \ individuals.  Should an\n      unauthorized person gain access to critical layer\
    \ 2/layer 3\n      infrastructure devices or services, they could cause great\
    \ harm to\n      the reliability and availability of the network.\n   A complete\
    \ description of threat actions that can cause these threat\n   consequences can\
    \ be found in [RFC2828].  Typically, a number of\n   different network attacks\
    \ are used in combination to cause one or\n   more of the above-mentioned threat\
    \ consequences.  An example would be\n   a malicious user who has the capability\
    \ to eavesdrop on traffic.\n   First, he may listen in on traffic for a while,\
    \ doing reconnaissance\n   work and ascertaining which IP addresses belong to\
    \ specific devices,\n   such as routers.  Were this miscreant to obtain information,\
    \ such as\n   a router password sent in cleartext, he can then proceed to\n  \
    \ compromise the actual router.  From there, the miscreant can launch\n   various\
    \ active attacks, such as sending bogus routing updates to\n   redirect traffic\
    \ or capture additional traffic to compromise other\n   network devices.  While\
    \ this document enumerates which\n   countermeasures ISPs are deploying today,\
    \ a useful generic analysis\n   of actual backbone infrastructure attacks and\
    \ the appropriate\n   countermeasures can be found in [RTGWG].\n"
- title: 1.5.  Document Layout
  contents:
  - "1.5.  Document Layout\n   This document is a survey of current operational practices\
    \ that\n   mitigate the risk of being susceptible to any threat actions.  As\n\
    \   such, the main focus is on the currently deployed security practices\n   used\
    \ to detect and/or mitigate attacks.  The top-level categories in\n   this document\
    \ are based on operational functions for ISPs and\n   generally relate to what\
    \ is to be protected.  This is followed by a\n   description of which attacks\
    \ are possible and the security practices\n   currently deployed.  This will provide\
    \ the necessary security\n   services to help mitigate these attacks.  These security\
    \ services are\n   classified as follows:\n   o  User Authentication\n   o  User\
    \ Authorization\n   o  Data Origin Authentication\n   o  Access Control\n   o\
    \  Data Integrity\n   o  Data Confidentiality\n   o  Auditing/Logging\n   o  DoS\
    \ Mitigation\n   In many instances, a specific protocol currently deployed will\
    \ offer\n   a combination of these services.  For example, Authentication,\n \
    \  Authorization, and Accounting (AAA) can offer user authentication,\n   user\
    \ authorization, and audit/logging services, while the Secure\n   SHell (SSH)\
    \ Protocol can provide data origin authentication, data\n   integrity, and data\
    \ confidentiality.  The services offered are more\n   important than the actual\
    \ protocol used.  Note that access control\n   will refer basically to logical\
    \ access control, i.e., filtering.\n   Each section ends with an additional considerations\
    \ section that\n   explains why specific protocols may or may not be used, and\
    \ also\n   gives some information regarding capabilities, which are not possible\n\
    \   today due to bugs or lack of usability.\n"
- title: 2.  Protected Operational Functions
  contents:
  - '2.  Protected Operational Functions

    '
- title: 2.1.  Device Physical Access
  contents:
  - "2.1.  Device Physical Access\n   Device physical access pertains to protecting\
    \ the physical location\n   and access of the layer 2 or layer 3 network infrastructure\
    \ device.\n   Physical security is a large field of study/practice in and of\n\
    \   itself, arguably the largest, oldest, and most well-understood area\n   of\
    \ security.  Although it is important to have contingency plans for\n   natural\
    \ disasters, such as earthquakes and floods, which can cause\n   damage to networking\
    \ devices, this is out of the scope of this\n   document.  Here, we concern ourselves\
    \ with protecting access to the\n   physical location and how a device can be\
    \ further protected from\n   unauthorized access if the physical location has\
    \ been compromised,\n   i.e., protecting the console access.  This is aimed largely\
    \ at\n   stopping an intruder with physical access from gaining operational\n\
    \   control of the device(s).  Note that nothing will stop an attacker\n   with\
    \ physical access from effecting a denial-of-service attack, which\n   can be\
    \ easily accomplished by powering off the device or just\n   unplugging some cables.\n"
- title: 2.1.1.  Threats/Attacks
  contents:
  - "2.1.1.  Threats/Attacks\n   If any intruder gets physical access to a layer 2\
    \ or layer 3 device,\n   the entire network infrastructure can be under the control\
    \ of the\n   intruder.  At a minimum, the intruder can take the compromised device\n\
    \   out of service, causing network disruption, the extent of which\n   depends\
    \ on the network topology.  A worse scenario is where the\n   intruder uses this\
    \ device to crack the console password, gaining\n   complete control of the device\
    \ (perhaps without anyone detecting such\n   a compromise, or to attach another\
    \ network device onto a port and\n   siphon off data with which the intruder can\
    \ ascertain the network\n   topology) and the entire network.\n   The threat of\
    \ gaining physical access can be realized in a variety of\n   ways, even if critical\
    \ devices are under high security.  Cases still\n   occur where attackers have\
    \ impersonated maintenance workers to gain\n   physical access to critical devices\
    \ that have caused major outages\n   and privacy compromises.  Insider attacks\
    \ from authorized personnel\n   also pose a real threat and must be adequately\
    \ recognized and\n   addressed.\n"
- title: 2.1.2.  Security Practices
  contents:
  - "2.1.2.  Security Practices\n   For physical device security, equipment is kept\
    \ in highly restrictive\n   environments.  Only authorized users with card-key\
    \ badges have access\n   to any of the physical locations that contain critical\
    \ network\n   infrastructure devices.  These card-key systems keep track of who\n\
    \   accessed which location and at what time.  Most cardkey systems have\n   a\
    \ fail-back \"master key\" in case the card system is down.  This\n   \"master\
    \ key\" usually has limited access and its use is also carefully\n   logged (which\
    \ should only happen if the card-key system is NOT\n   online/functional).\n \
    \  All console access is always password protected and the login time is\n   set\
    \ to time out after a specified amount of inactivity - typically\n   between 3-10\
    \ minutes.  The type of privileges that you obtain from a\n   console login varies\
    \ between separate vendor devices.  In some cases\n   you get initial basic access\
    \ and need to perform a second\n   authentication step to get more privileged\
    \ access (i.e., enable or\n   root).  In other vendors, you get the more privileged\
    \ access when you\n   log into the console as root, without requiring a second\n\
    \   authentication step.\n   How ISPs manage these logins vary greatly, although\
    \ many of the\n   larger ISPs employ some sort of AAA mechanism to help automate\n\
    \   privilege-level authorization and utilize the automation to bypass\n   the\
    \ need for a second authentication step.  Also, many ISPs define\n   separate\
    \ classes of users to have different privileges while logged\n   onto the console.\
    \  Typically, all console access is provided via an\n   out-of-band (OOB) management\
    \ infrastructure, which is discussed in\n   Section 2.2 of this document.\n"
- title: 2.1.3.  Security Services
  contents:
  - "2.1.3.  Security Services\n   The following security services are offered through\
    \ the use of the\n   practices described in the previous section:\n   o  User\
    \ Authentication - All individuals who have access to the\n      physical facility\
    \ are authenticated.  Console access is\n      authenticated.\n   o  User Authorization\
    \ - An authenticated individual has implicit\n      authorization to perform commands\
    \ on the device.  In some cases,\n      multiple authentication is required to\
    \ differentiate between basic\n      and more privileged access.\n   o  Data Origin\
    \ Authentication - Not applicable.\n   o  Access Control - Not applicable.\n \
    \  o  Data Integrity - Not applicable.\n   o  Data Confidentiality - Not applicable.\n\
    \   o  Auditing/Logging - All access to the physical locations of the\n      infrastructure\
    \ equipment is logged via electronic card-key\n      systems.  All console access\
    \ is logged (refer to Section 2.2 of\n      this document for more details).\n\
    \   o  DoS Mitigation - Not applicable.\n"
- title: 2.1.4.  Additional Considerations
  contents:
  - "2.1.4.  Additional Considerations\n   Physical security is relevant to operational\
    \ security practices as\n   described in this document, mostly from a console-access\
    \ perspective.\n   Most ISPs provide console access via an OOB management\n  \
    \ infrastructure, which is discussed in Section 2.2 of this document.\n   The\
    \ physical and logical authentication and logging systems should be\n   run independently\
    \ of each other and should reside in different\n   physical locations.  These\
    \ systems need to be secured to ensure that\n   they themselves will not be compromised,\
    \ which could give the\n   intruder valuable authentication and logging information.\n\
    \   Social engineering plays a big role in many physical access\n   compromises.\
    \  Most ISPs have set up training classes and awareness\n   programs to educate\
    \ company personnel to deny physical access to\n   people who are not properly\
    \ authenticated or authorized to have\n   physical access to critical infrastructure\
    \ devices.\n"
- title: 2.2.  Device Management - In-Band and Out-of-Band (OOB)
  contents:
  - "2.2.  Device Management - In-Band and Out-of-Band (OOB)\n   In-band management\
    \ is generally considered to be device access, where\n   the control traffic takes\
    \ the same data path as the data that\n   traverses the network.  Out-of-band\
    \ management is generally\n   considered to be device access, where the control\
    \ traffic takes a\n   separate path as the data that traverses the network.  In\
    \ many\n   environments, device management for layer 2 and layer 3\n   infrastructure\
    \ devices is deployed as part of an out-of-band\n   management infrastructure,\
    \ although there are some instances where it\n   is deployed in-band as well.\
    \  Note that while many of the security\n   concerns and practices are the same\
    \ for OOB management and in-band\n   management, most ISPs prefer an OOB management\
    \ system, since access\n   to the devices that make up this management network\
    \ are more\n   vigilantly protected and considered to be less susceptible to\n\
    \   malicious activity.\n   Console access is always architected via an OOB network.\
    \  Presently,\n   the mechanisms used for either in-band management or OOB are\
    \ via\n   virtual terminal access (i.e., Telnet or SSH), Simple Network\n   Management\
    \ Protocol (SNMP), or HTTP.  In all large ISPs that were\n   interviewed, HTTP\
    \ management was never used and was explicitly\n   disabled.  Note that file transfer\
    \ protocols (TFTP, FTP, and SCP)\n   will be covered in Section 2.5 of this document.\n"
- title: 2.2.1.  Threats/Attacks
  contents:
  - "2.2.1.  Threats/Attacks\n   For device management, passive attacks are possible\
    \ if someone has\n   the capability to intercept data between the management device\
    \ and\n   the managed device.  The threat is possible if a single\n   infrastructure\
    \ device is somehow compromised and can act as a network\n   sniffer, or if it\
    \ is possible to insert a new device that acts as a\n   network sniffer.\n   Active\
    \ attacks are possible for both on-path and off-path scenarios.\n   For on-path\
    \ active attacks, the situation is the same as for a\n   passive attack, where\
    \ either a device has to already be compromised\n   or a device can be inserted\
    \ into the path.  For off-path active\n   attacks, where a topology subversion\
    \ is required to reroute traffic\n   and essentially bring the attacker on-path,\
    \ the attack is generally\n   limited to message insertion or modification.\n"
- title: 2.2.1.1.  Confidentiality Violations
  contents:
  - "2.2.1.1.  Confidentiality Violations\n   Confidentiality violations can occur\
    \ when a miscreant intercepts any\n   management data that has been sent in cleartext\
    \ or with weak\n   encryption.  This includes interception of usernames and passwords\n\
    \   with which an intruder can obtain unauthorized access to network\n   devices.\
    \  It can also include other information, such as logging or\n   configuration\
    \ information, if an administrator is remotely viewing\n   local logfiles or configuration\
    \ information.\n"
- title: 2.2.1.2.  Offline Cryptographic Attacks
  contents:
  - "2.2.1.2.  Offline Cryptographic Attacks\n   If username/password information\
    \ was encrypted but the cryptographic\n   mechanism used made it easy to capture\
    \ data and break the encryption\n   key, the device management traffic could be\
    \ compromised.  The traffic\n   would need to be captured either by eavesdropping\
    \ on the network or\n   by being able to divert traffic to a malicious user.\n"
- title: 2.2.1.3.  Replay Attacks
  contents:
  - "2.2.1.3.  Replay Attacks\n   For a replay attack to be successful, the management\
    \ traffic would\n   need to first be captured either on-path or diverted to an\
    \ attacker\n   to later be replayed to the intended recipient.\n"
- title: 2.2.1.4.  Message Insertion/Deletion/Modification
  contents:
  - "2.2.1.4.  Message Insertion/Deletion/Modification\n   Data can be manipulated\
    \ by someone in control of intermediary hosts.\n   Forging data is also possible\
    \ with IP spoofing, where a remote host\n   sends out packets that appear to come\
    \ from another, trusted host.\n"
- title: 2.2.1.5.  Man-In-The-Middle
  contents:
  - "2.2.1.5.  Man-In-The-Middle\n   A man-in-the-middle attack attacks the identity\
    \ of a communicating\n   peer rather than the data stream itself.  The attacker\
    \ intercepts\n   traffic that is sent from a management system to the networking\n\
    \   infrastructure device and traffic that is sent from the network\n   infrastructure\
    \ device to the management system.\n"
- title: 2.2.2.  Security Practices
  contents:
  - "2.2.2.  Security Practices\n   OOB management is done via a terminal server at\
    \ each location.  SSH\n   access is used to get to the terminal server from where\
    \ sessions to\n   the devices are initiated.  Dial-in access is deployed as a\
    \ backup if\n   the network is not available.  However, it is common to use dial-\n\
    \   back, encrypting modems, and/or one-time-password (OTP) modems to\n   avoid\
    \ the security weaknesses of plain dial-in access.\n   All in-band management\
    \ and OOB management access to layer 2 and layer\n   3 devices is authenticated.\
    \  The user authentication and\n   authorization is typically controlled by an\
    \ AAA server (i.e., Remote\n   Authentication Dial-in User Service (RADIUS) and/or\
    \ Terminal Access\n   Controller Access-Control System (TACACS+)).  Credentials\
    \ used to\n   determine the identity of the user vary from static username/password\n\
    \   to one-time username/password schemes such as Secure-ID.  Static\n   username/passwords\
    \ are expired after a specified period of time,\n   usually 30 days.  Every authenticated\
    \ entity via AAA is an individual\n   user for greater granularity of control.\
    \  Note that often the AAA\n   server used for OOB management authentication is\
    \ a separate physical\n   device from the AAA server used for in-band management\
    \ user\n   authentication.  In some deployments, the AAA servers used for device\n\
    \   management authentication/authorization/accounting are on separate\n   networks\
    \ to provide a demarcation for any other authentication\n   functions.\n   For\
    \ backup purposes, there is often a single local database entry for\n   authentication\
    \ that is known to a very limited set of key personnel.\n   It is usually the\
    \ highest privilege-level username/password\n   combination, which in most cases\
    \ is the same across all devices.\n   This local device password is routinely\
    \ regenerated once every 2-3\n   months, and is also regenerated immediately after\
    \ an employee who had\n   access to that password leaves the company or is no\
    \ longer authorized\n   to have knowledge of that password.\n   Each individual\
    \ user in the AAA database is configured with specific\n   authorization capability.\
    \  Specific commands are either individually\n   denied or permitted, depending\
    \ on the capability of the device to be\n   accessed.  Multiple privilege levels\
    \ are deployed.  Most individuals\n   are authorized with basic authorization\
    \ to perform a minimal set of\n   commands, while a subset of individuals are\
    \ authorized to perform\n   more privileged commands.  Securing the AAA server\
    \ is imperative and\n   access to the AAA server itself is strictly controlled.\
    \  When an\n   individual leaves the company, his/her AAA account is immediately\n\
    \   deleted and the TACACS/RADIUS shared secret is reset for all devices.\n  \
    \ Some management functions are performed using command line interface\n   (CLI)\
    \ scripting.  In these scenarios, a dedicated user is used for\n   the identity\
    \ in scripts that perform CLI scripting.  Once\n   authenticated, these scripts\
    \ control which commands are legitimate,\n   depending on authorization rights\
    \ of the authenticated individual.\n   SSH is always used for virtual terminal\
    \ access to provide for an\n   encrypted communication channel.  There are exceptions\
    \ due to\n   equipment limitations which are described in the additional\n   considerations\
    \ section.\n   If SNMP is used for management, it is for read queries only and\n\
    \   restricted to specific hosts.  If possible, the view is also\n   restricted\
    \ to only send the information that the management station\n   needs, rather than\
    \ expose the entire configuration file with the\n   read-only SNMP community.\
    \  The community strings are carefully chosen\n   to be difficult to crack and\
    \ there are procedures in place to change\n   these community strings between\
    \ 30-90 days.  If systems support two\n   SNMP community strings, the old string\
    \ is replaced by first\n   configuring a second, newer community string and then\
    \ migrating over\n   from the currently used string to the newer one.  Most large\
    \ ISPs\n   have multiple SNMP systems accessing their routers so it takes more\n\
    \   then one maintenance period to get all the strings fixed in all the\n   right\
    \ systems.  SNMP RW is not used and is disabled by configuration.\n   Access control\
    \ is strictly enforced for infrastructure devices by\n   using stringent filtering\
    \ rules.  A limited set of IP addresses are\n   allowed to initiate connections\
    \ to the infrastructure devices and are\n   specific to the services to which\
    \ they are to limited (i.e., SSH and\n   SNMP).\n   All device management access\
    \ is audited and any violations trigger\n   alarms that initiate automated email,\
    \ pager, and/or telephone\n   notifications.  AAA servers keep track of the authenticated\
    \ entity as\n   well as all the commands that were carried out on a specific device.\n\
    \   Additionally, the device itself logs any access control violations\n   (i.e.,\
    \ if an SSH request comes in from an IP address that is not\n   explicitly permitted,\
    \ that event is logged so that the offending IP\n   address can be tracked down\
    \ and investigations made as to why it was\n   trying to access a particular infrastructure\
    \ device)\n"
- title: 2.2.3.  Security Services
  contents:
  - "2.2.3.  Security Services\n   The security services offered for device OOB management\
    \ are nearly\n   identical to those of device in-band management.  Due to the\
    \ critical\n   nature of controlling and limiting device access, many ISPs feel\
    \ that\n   physically separating the management traffic from the normal customer\n\
    \   data traffic will provide an added level of risk mitigation and limit\n  \
    \ the potential attack vectors.  The following security services are\n   offered\
    \ through the use of the practices described in the previous\n   section:\n  \
    \ o  User Authentication - All individuals are authenticated via AAA\n      services.\n\
    \   o  User Authorization - All individuals are authorized via AAA\n      services\
    \ to perform specific operations once successfully\n      authenticated.\n   o\
    \  Data Origin Authentication - Management traffic is strictly\n      filtered\
    \ to allow only specific IP addresses to have access to the\n      infrastructure\
    \ devices.  This does not alleviate risk the from\n      spoofed traffic, although\
    \ when combined with edge filtering using\n      BCP38 [RFC2827] and BCP84 [RFC3704]\
    \ guidelines (discussed in\n      Section 2.5), then the risk of spoofing is mitigated,\
    \ barring a\n      compromised internal system.  Also, using SSH for device access\n\
    \      ensures that no one can spoof the traffic during the SSH session.\n   o\
    \  Access Control - Management traffic is filtered to allow only\n      specific\
    \ IP addresses to have access to the infrastructure\n      devices.\n   o  Data\
    \ Integrity - Using SSH provides data integrity and ensures\n      that no one\
    \ has altered the management data in transit.\n   o  Data Confidentiality - Using\
    \ SSH provides data confidentiality.\n   o  Auditing/Logging - Using AAA provides\
    \ an audit trail for who\n      accessed which device and which operations were\
    \ performed.\n   o  DoS Mitigation - Using packet filters to allow only specific\
    \ IP\n      addresses to have access to the infrastructure devices.  This\n  \
    \    limits but does not prevent spoofed DoS attacks directed at an\n      infrastructure\
    \ device.  However, the risk is lowered by using a\n      separate physical network\
    \ for management purposes.\n"
- title: 2.2.4.  Additional Considerations
  contents:
  - "2.2.4.  Additional Considerations\n   Password selection for any device management\
    \ protocol used is\n   critical to ensure that the passwords are hard to guess\
    \ or break\n   using a brute-force attack.\n   IP security (IPsec) is considered\
    \ too difficult to deploy, and the\n   common protocol to provide for confidential\
    \ management access is SSH.\n   There are exceptions for using SSH due to equipment\
    \ limitations since\n   SSH may not be supported on legacy equipment.  In some\
    \ cases,\n   changing the host name of a device requires an SSH rekey event since\n\
    \   the key is based on some combination of host name, Message\n   Authentication\
    \ Code (MAC) address, and time.  Also, in the case where\n   the SSH key is stored\
    \ on a route processor card, a re-keying of SSH\n   would be required whenever\
    \ the route processor card needs to be\n   swapped.  Some providers feel that\
    \ this operational impact exceeds\n   the security necessary and instead use Telnet\
    \ from trusted inside\n   hosts (called 'jumphosts' or 'bastion hosts') to manage\
    \ those\n   devices.  An individual would first SSH to the jumphost and then\n\
    \   Telnet from the jumphost to the actual infrastructure device, fully\n   understanding\
    \ that any passwords will be sent in the clear between\n   the jumphost and the\
    \ device to which it is connecting.  All\n   authentication and authorization\
    \ is still carried out using AAA\n   servers.\n   In instances where Telnet access\
    \ is used, the logs on the AAA servers\n   are more verbose and more attention\
    \ is paid to them to detect any\n   abnormal behavior.  The jumphosts themselves\
    \ are carefully controlled\n   machines and usually have limited access.  Note\
    \ that Telnet is NEVER\n   allowed to an infrastructure device except from specific\
    \ jumphosts;\n   i.e., packet filters are used at the console server and/or\n\
    \   infrastructure device to ensure that Telnet is only allowed from\n   specific\
    \ IP addresses.\n   With thousands of devices to manage, some ISPs have created\
    \ automated\n   mechanisms to authenticate to devices.  As an example, Kerberos\
    \ has\n   been used to automate the authentication process for devices that\n\
    \   have support for Kerberos.  An individual would first log in to a\n   Kerberized\
    \ UNIX server using SSH and generate a Kerberos 'ticket'.\n   This 'ticket' is\
    \ generally set to have a lifespan of 10 hours and is\n   used to automatically\
    \ authenticate the individual to the\n   infrastructure devices.\n   In instances\
    \ where SNMP is used, some legacy devices only support\n   SNMPv1, which then\
    \ requires the provider to mandate its use across\n   all infrastructure devices\
    \ for operational simplicity.  SNMPv2 is\n   primarily deployed since it is easier\
    \ to set up than v3.\n"
- title: 2.3.  Data Path
  contents:
  - "2.3.  Data Path\n   This section refers to how traffic is handled that traverses\
    \ the\n   network infrastructure device.  The primary goal of ISPs is to\n   forward\
    \ customer traffic.  However, due to the large amount of\n   malicious traffic\
    \ that can cause DoS attacks and render the network\n   unavailable, specific\
    \ measures are sometimes deployed to ensure the\n   availability to forward legitimate\
    \ customer traffic.\n"
- title: 2.3.1.  Threats/Attacks
  contents:
  - "2.3.1.  Threats/Attacks\n   Any data traffic can potentially be attack traffic\
    \ and the challenge\n   is to detect and potentially stop forwarding any of the\
    \ malicious\n   traffic.  The deliberately sourced attack traffic can consist\
    \ of\n   packets with spoofed source and/or destination addresses or any other\n\
    \   malformed packet that mangle any portion of a header field to cause\n   protocol-related\
    \ security issues (such as resetting connections,\n   causing unwelcome ICMP redirects,\
    \ creating unwelcome IP options, or\n   packet fragmentations).\n"
- title: 2.3.2.  Security Practices
  contents:
  - "2.3.2.  Security Practices\n   Filtering and rate limiting are the primary mechanism\
    \ to provide risk\n   mitigation of malicious traffic rendering the ISP services\n\
    \   unavailable.  However, filtering and rate limiting of data path\n   traffic\
    \ is deployed in a variety of ways, depending on how automated\n   the process\
    \ is and what the capabilities and performance limitations\n   of the existing\
    \ deployed hardware are.\n   The ISPs that do not have performance issues with\
    \ their equipment\n   follow BCP38 [RFC2827] and BCP84 [RFC3704] guidelines for\
    \ ingress\n   filtering.  BCP38 recommends filtering ingress packets with obviously\n\
    \   spoofed and/or 'reserved' source addresses to limit the effects of\n   denial-of-service\
    \ attacks, while BCP84 extends the recommendation for\n   multi-homed environments.\
    \  Filters are also used to help alleviate\n   issues between service providers.\
    \  Without any filtering, an\n   inter-exchange peer could steal transit just\
    \ by using static routes,\n   and essentially redirect data traffic.  Therefore,\
    \ some ISPs have\n   implemented ingress/egress filters that block unexpected\
    \ source and\n   destination addresses not defined in the above-mentioned documents.\n\
    \   Null routes and black-hole triggered routing [RFC3882] are used to\n   deter\
    \ any detected malicious traffic streams.  These two techniques\n   are described\
    \ in more detail in Section 2.8 below.\n   Most ISPs consider layer 4 filtering\
    \ useful, but it is only\n   implemented if performance limitations allow for\
    \ it.  Since it poses\n   a large administrative overhead and ISPs are very much\
    \ opposed to\n   acting as the Internet firewall, Layer 4 filtering is typically\n\
    \   implemented as a last option.  Netflow is used for tracking traffic\n   flows,\
    \ but there is some concern whether sampling is good enough to\n   detect malicious\
    \ behavior.\n   Unicast Reverse Path Forwarding (RPF) is not consistently\n  \
    \ implemented.  Some ISPs are in the process of doing so, while other\n   ISPs\
    \ think that the perceived benefit of knowing that spoofed traffic\n   comes from\
    \ legitimate addresses are not worth the operational\n   complexity.  Some providers\
    \ have a policy of implementing uRPF at\n   link speeds of Digital Signal 3 (DS3)\
    \ and below, which was due to the\n   fact that all hardware in the network supported\
    \ uRPF for DS3 speeds\n   and below.  At higher-speed links, the uRPF support\
    \ was inconsistent\n   and it was easier for operational people to implement a\
    \ consistent\n   solution.\n"
- title: 2.3.3.  Security Services
  contents:
  - "2.3.3.  Security Services\n   o  User Authentication - Not applicable.\n   o\
    \  User Authorization - Not applicable.\n   o  Data Origin Authentication - When\
    \ IP address filtering per BCP38,\n      BCP84, and uRPF are deployed at network\
    \ edges it can ensure that\n      any spoofed traffic comes from at least a legitimate\
    \ IP address\n      and can be tracked.\n   o  Access Control - IP address filtering\
    \ and layer 4 filtering is\n      used to deny forbidden protocols and limit traffic\
    \ destined for\n      infrastructure device itself.  Filters are also used to\
    \ block\n      unexpected source/destination addresses.\n   o  Data Integrity\
    \ - Not applicable.\n   o  Data Confidentiality - Not applicable.\n   o  Auditing/Logging\
    \ - Filtering exceptions are logged for potential\n      attack traffic.\n   o\
    \  DoS Mitigation - Black-hole triggered filtering and rate-limiting\n      are\
    \ used to limit the risk of DoS attacks.\n"
- title: 2.3.4.  Additional Considerations
  contents:
  - "2.3.4.  Additional Considerations\n   For layer 2 devices, MAC address filtering\
    \ and authentication is not\n   used in large-scale deployments.  This is due\
    \ to the problems it can\n   cause when troubleshooting networking issues.  Port\
    \ security becomes\n   unmanageable at a large scale where thousands of switches\
    \ are\n   deployed.\n   Rate limiting is used by some ISPs, although other ISPs\
    \ believe it is\n   not really useful, since attackers are not well-behaved and\
    \ it\n   doesn't provide any operational benefit over the complexity.  Some\n\
    \   ISPs feel that rate limiting can also make an attacker's job easier\n   by\
    \ requiring the attacker to send less traffic to starve legitimate\n   traffic\
    \ that is part of a rate limiting scheme.  Rate limiting may be\n   improved by\
    \ developing flow-based rate-limiting capabilities with\n   filtering hooks. \
    \ This would improve the performance as well as the\n   granularity over current\
    \ capabilities.\n   Lack of consistency regarding the ability to filter, especially\
    \ with\n   respect to performance issues, cause some ISPs not to implement BCP38\n\
    \   and BCP84 guidelines for ingress filtering.  One such example is at\n   edge\
    \ boxes, where up to 1000 T1s connecting into a router with an\n   OC-12 (Optical\
    \ Carrier) uplink.  Some deployed devices experience a\n   large performance impact\
    \ with filtering, which is unacceptable for\n   passing customer traffic through,\
    \ though ingress filtering (uRPF)\n   might be applicable at the devices that\
    \ are connecting these\n   aggregation routers.  Where performance is not an issue,\
    \ the ISPs\n   make a tradeoff between management versus risk.\n"
- title: 2.4.  Routing Control Plane
  contents:
  - "2.4.  Routing Control Plane\n   The routing control plane deals with all the\
    \ traffic that is part of\n   establishing and maintaining routing protocol information.\n"
- title: 2.4.1.  Threats/Attacks
  contents:
  - "2.4.1.  Threats/Attacks\n   Attacks on the routing control plane can be from\
    \ both passive or\n   active sources.  Passive attacks are possible if someone\
    \ has the\n   capability to intercept data between the communicating routing peers.\n\
    \   This can be accomplished if a single routing peer is somehow\n   compromised\
    \ and can act as a network sniffer, or if it is possible to\n   insert a new device\
    \ that acts as a network sniffer.\n   Active attacks are possible for both on-path\
    \ and off-path scenarios.\n   For on-path active attacks, the situation is the\
    \ same as for a\n   passive attack, where either a device has to already be compromised\n\
    \   or a device can be inserted into the path.  This may lead to an\n   attacker\
    \ impersonating a legitimate routing peer and exchanging\n   routing information.\
    \  Unintentional active attacks are more common\n   due to configuration errors,\
    \ which cause legitimate routing peers to\n   feed invalid routing information\
    \ to other neighboring peers.\n   For off-path active attacks, the attacks are\
    \ generally limited to\n   message insertion or modification, which can divert\
    \ traffic to\n   illegitimate destinations, causing traffic to never reach its\n\
    \   intended destination.\n"
- title: 2.4.1.1.  Confidentiality Violations
  contents:
  - "2.4.1.1.  Confidentiality Violations\n   Confidentiality violations can occur\
    \ when a miscreant intercepts any\n   of the routing update traffic.  This is\
    \ becoming more of a concern\n   because many ISPs are classifying addressing\
    \ schemes and network\n   topologies as private and proprietary information. \
    \ It is also a\n   concern because the routing protocol packets contain information\
    \ that\n   may show ways in which routing sessions could be spoofed or hijacked.\n\
    \   This in turn could lead into a man-in-the-middle attack, where the\n   miscreants\
    \ can insert themselves into the traffic path or divert the\n   traffic path and\
    \ violate the confidentiality of user data.\n"
- title: 2.4.1.2.  Offline Cryptographic Attacks
  contents:
  - "2.4.1.2.  Offline Cryptographic Attacks\n   If any cryptographic mechanism was\
    \ used to provide for data integrity\n   and confidentiality, an offline cryptographic\
    \ attack could\n   potentially compromise the data.  The traffic would need to\
    \ be\n   captured either by eavesdropping on the network or by being able to\n\
    \   divert traffic to a malicious user.  Note that by using\n   cryptographically\
    \ protected routing information, the latter would\n   require the cryptographic\
    \ key to already be compromised anyway, so\n   this attack is only feasible if\
    \ a device was able to eavesdrop and\n   capture the cryptographically protected\
    \ routing information.\n"
- title: 2.4.1.3.  Replay Attacks
  contents:
  - "2.4.1.3.  Replay Attacks\n   For a replay attack to be successful, the routing\
    \ control plane\n   traffic would need to first be captured either on-path or\
    \ diverted to\n   an attacker to later be replayed to the intended recipient.\n\
    \   Additionally, since many of these protocols include replay protection\n  \
    \ mechanisms, these would also need to be subverted, if applicable.\n"
- title: 2.4.1.4.  Message Insertion/Deletion/Modification
  contents:
  - "2.4.1.4.  Message Insertion/Deletion/Modification\n   Routing control plane traffic\
    \ can be manipulated by someone in\n   control of intermediate hosts.  In addition,\
    \ traffic can be injected\n   by forging IP addresses, where a remote router sends\
    \ out packets that\n   appear to come from another, trusted router.  If enough\
    \ traffic is\n   injected to be processed by limited memory routers, it can cause\
    \ a\n   DoS attack.\n"
- title: 2.4.1.5.  Man-In-The-Middle
  contents:
  - "2.4.1.5.  Man-In-The-Middle\n   A man-in-the-middle attack attacks the identity\
    \ of a communicating\n   peer rather than the data stream itself.  The attacker\
    \ intercepts\n   traffic that is sent from one routing peer to the other and\n\
    \   communicates on behalf of one of the peers.  This can lead to a\n   diversion\
    \ of the user traffic to either an unauthorized receiving\n   party or cause legitimate\
    \ traffic to never reach its intended\n   destination.\n"
- title: 2.4.2.  Security Practices
  contents:
  - "2.4.2.  Security Practices\n   Securing the routing control plane takes many\
    \ features, which are\n   generally deployed as a system.  Message Digest 5 (MD5)\n\
    \   authentication is used by some ISPs to validate the sending peer and\n   to\
    \ ensure that the data in transit has not been altered.  Some ISPs\n   only deploy\
    \ MD5 authentication at the customers' request.  Additional\n   sanity checks\
    \ to ensure with reasonable certainty that the received\n   routing update was\
    \ originated by a valid routing peer include route\n   filters and the Generalized\
    \ TTL Security Mechanism (GTSM) feature\n   [RFC3682] (sometimes also referred\
    \ to as the TTL-Hack).  The GTSM\n   feature is used for protocols such as the\
    \ Border Gateway Protocol\n   (BGP), and makes use of a packet's Time To Live\
    \ (TTL) field (IPv4) or\n   Hop Limit (IPv6) to protect communicating peers. \
    \ If GTSM is used, it\n   is typically deployed only in limited scenarios between\
    \ internal BGP\n   peers due to lack of consistent support between vendor products\
    \ and\n   operating system versions.\n   Packet filters are used to limit which\
    \ systems can appear as a valid\n   peer, while route filters are used to limit\
    \ which routes are believed\n   to be from a valid peer.  In the case of BGP routing,\
    \ a variety of\n   policies are deployed to limit the propagation of invalid routing\n\
    \   information.  These include: incoming and outgoing prefix filters for\n  \
    \ BGP customers, incoming and outgoing prefix filters for peers and\n   upstream\
    \ neighbors, incoming AS-PATH filter for BGP customers,\n   outgoing AS-PATH filter\
    \ towards peers and upstream neighbors, route\n   dampening and rejecting selected\
    \ attributes and communities.\n   Consistency between these policies varies greatly\
    \ and there is a\n   definite distinction whether the other end is an end-site\
    \ vs an\n   internal peer vs another big ISP or customer.  Mostly ISPs do\n  \
    \ prefix-filter their end-site customers, but due to the operational\n   constraints\
    \ of maintaining large prefix filter lists, many ISPs are\n   starting to depend\
    \ on BGP AS-PATH filters to/from their peers and\n   upstream neighbors.\n   In\
    \ cases where prefix lists are not used, operators often define a\n   maximum\
    \ prefix limit per peer to prevent misconfiguration (e.g.,\n   unintentional de-aggregation\
    \ or neighbor routing policy\n   mis-configuration) or overload attacks.  ISPs\
    \ need to coordinate with\n   each other what the expected prefix exchange is,\
    \ and increase this\n   number by some sane amount.  It is important for ISPs\
    \ to pad the\n   max-prefix number enough to allow for valid swings in routing\n\
    \   announcements, preventing an unintentional shut down of the BGP\n   session.\
    \  Individual implementation amongst ISPs are unique, and\n   depending on equipment\
    \ supplier(s), different implementation options\n   are available.  Most equipment\
    \ vendors offer implementation options\n   ranging from just logging excessive\
    \ prefixes being received, to\n   automatically shutting down the session.  If\
    \ the option of\n   reestablishing a session after some pre-configured idle timeout\
    \ has\n   been reached is available, it should be understood that automatically\n\
    \   reestablishing the session may potentially introduce instability\n   continuously\
    \ into the overall routing table if a policy\n   mis-configuration on the adjacent\
    \ neighbor is causing the condition.\n   If a serious mis-configuration on a peering\
    \ neighbor has occurred,\n   then automatically shutting down the session and\
    \ leaving it shut down\n   until being manually cleared, is sometimes best and\
    \ allows for\n   operator intervention to correct as needed.\n   Some large ISPs\
    \ require that routes be registered in an Internet\n   Routing Registry (IRR),\
    \ which can then be part of the Routing Assets\n   Database (RADb) - a public\
    \ registry of routing information for\n   networks in the Internet that can be\
    \ used to generate filter lists.\n   Some ISPs, especially in Europe, require\
    \ registered routes before\n   agreeing to become an eBGP peer with someone.\n\
    \   Many ISPs also do not propagate interface IP addresses to further\n   reduce\
    \ attack vectors on routers and connected customers.\n"
- title: 2.4.3.  Security Services
  contents:
  - "2.4.3.  Security Services\n   o  User Authentication - Not applicable.\n   o\
    \  User Authorization - Not applicable.\n   o  Data Origin Authentication - By\
    \ using MD5 authentication and/or\n      the TTL-hack, a routing peer can be reasonably\
    \ certain that\n      traffic originated from a valid peer.\n   o  Access Control\
    \ - Route filters, AS-PATH filters, and prefix limits\n      are used to control\
    \ access to specific parts of the network.\n   o  Data Integrity - By using MD5\
    \ authentication, a peer can be\n      reasonably certain that the data has not\
    \ been modified in transit,\n      but there is no mechanism to prove the validity\
    \ of the routing\n      information itself.\n   o  Data Confidentiality - Not\
    \ implemented.\n   o  Auditing / Logging - Filter exceptions are logged.\n   o\
    \  DoS Mitigation - Many DoS attacks are mitigated using a\n      combination\
    \ of techniques including: MD5 authentication, the GTSM\n      feature, filtering\
    \ routing advertisements to bogons, and filtering\n      routing advertisements\
    \ to one's own network.\n"
- title: 2.4.4.  Additional Considerations
  contents:
  - "2.4.4.  Additional Considerations\n   So far the primary concern to secure the\
    \ routing control plane has\n   been to validate the sending peer and to ensure\
    \ that the data in\n   transit has not been altered.  Although MD5 routing protocol\n\
    \   extensions have been implemented, which can provide both services,\n   they\
    \ are not consistently deployed amongst ISPs.  Two major\n   deployment concerns\
    \ have been implementation issues, where both\n   software bugs and the lack of\
    \ graceful re-keying options have caused\n   significant network down times. \
    \ Also, some ISPs express concern that\n   deploying MD5 authentication will itself\
    \ be a worse DoS attack victim\n   and prefer to use a combination of other risk\
    \ mitigation mechanisms\n   such as GTSM (for BGP) and route filters.  An issue\
    \ with GTSM is that\n   it is not supported on all devices across different vendors'\n\
    \   products.\n   IPsec is not deployed since the operational management aspects\
    \ of\n   ensuring interoperability and reliable configurations is too complex\n\
    \   and time consuming to be operationally viable.  There is also limited\n  \
    \ concern to the confidentiality of the routing information.  The\n   integrity\
    \ and validity of the updates are of much greater concern.\n   There is concern\
    \ for manual or automated actions, which introduce new\n   routes and can affect\
    \ the entire routing domain.\n"
- title: 2.5.  Software Upgrades and Configuration Integrity/Validation
  contents:
  - "2.5.  Software Upgrades and Configuration Integrity/Validation\n   Software upgrades\
    \ and configuration changes are usually performed as\n   part of either in-band\
    \ or OOB management functions.  However, there\n   are additional considerations\
    \ to be taken into account, which are\n   enumerated in this section.\n"
- title: 2.5.1.  Threats/Attacks
  contents:
  - "2.5.1.  Threats/Attacks\n   Attacks performed on system software and configurations\
    \ can be both\n   from passive or active sources.  Passive attacks are possible\
    \ if\n   someone has the capability to intercept data between the network\n  \
    \ infrastructure device and the system which is downloading or\n   uploading the\
    \ software or configuration information.  This can be\n   accomplished if a single\
    \ infrastructure device is somehow compromised\n   and can act as a network sniffer,\
    \ or if it is possible to insert a\n   new device that acts as a network sniffer.\n\
    \   Active attacks are possible for both on-path and off-path scenarios.\n   For\
    \ on-path active attacks, the situation is the same as for a\n   passive attack,\
    \ where either a device has to already be compromised\n   or a device can be inserted\
    \ into the path.  For off-path active\n   attacks, the attacks are generally limited\
    \ to message insertion or\n   modification where the attacker may wish to load\
    \ illegal software or\n   configuration files to an infrastructure device.\n \
    \  Note that similar issues are relevant when software updates are\n   downloaded\
    \ from a vendor site to an ISPs network management system\n   that is responsible\
    \ for software updates and/or configuration\n   information.\n"
- title: 2.5.1.1.  Confidentiality Violations
  contents:
  - "2.5.1.1.  Confidentiality Violations\n   Confidentiality violations can occur\
    \ when a miscreant intercepts any\n   of the software image or configuration information.\
    \  The software\n   image may give an indication of exploits which the device\
    \ is\n   vulnerable to while the configuration information can inadvertently\n\
    \   lead attackers to identify critical infrastructure IP addresses and\n   passwords.\n"
- title: 2.5.1.2.  Offline Cryptographic Attacks
  contents:
  - "2.5.1.2.  Offline Cryptographic Attacks\n   If any cryptographic mechanism was\
    \ used to provide for data integrity\n   and confidentiality, an offline cryptographic\
    \ attack could\n   potentially compromise the data.  The traffic would need to\
    \ be\n   captured either by eavesdropping on the communication path or by\n  \
    \ being able to divert traffic to a malicious user.\n"
- title: 2.5.1.3.  Replay Attacks
  contents:
  - "2.5.1.3.  Replay Attacks\n   For a replay attack to be successful, the software\
    \ image or\n   configuration file would need to first be captured either on-path\
    \ or\n   diverted to an attacker to later be replayed to the intended\n   recipient.\
    \  Additionally, since many protocols do have replay\n   protection capabilities,\
    \ these would have to be subverted as well in\n   applicable situations.\n"
- title: 2.5.1.4.  Message Insertion/Deletion/Modification
  contents:
  - "2.5.1.4.  Message Insertion/Deletion/Modification\n   Software images and configuration\
    \ files can be manipulated by someone\n   in control of intermediate hosts.  By\
    \ forging an IP address and\n   impersonating a valid host which can download\
    \ software images or\n   configuration files, invalid files can be downloaded\
    \ to an\n   infrastructure device.  This can also be the case from trusted\n \
    \  vendors who may unbeknownst to them have compromised trusted hosts.\n   An\
    \ invalid software image or configuration file can cause a device to\n   hang\
    \ and become inoperable.  Spoofed configuration files can be hard\n   to detect,\
    \ especially when the only added command is to allow a\n   miscreant access to\
    \ that device by entering a filter allowing a\n   specific host access and configuring\
    \ a local username/password\n   database entry for authentication to that device.\n"
- title: 2.5.1.5.  Man-In-The-Middle
  contents:
  - "2.5.1.5.  Man-In-The-Middle\n   A man-in-the-middle attack attacks the identity\
    \ of a communicating\n   peer rather than the data stream itself.  The attacker\
    \ intercepts\n   traffic that is sent between the infrastructure device and the\
    \ host\n   used to upload/download the system image or configuration file.\n \
    \  He/she can then act on behalf of one or both of these systems.\n   If an attacker\
    \ obtained a copy of the software image being deployed,\n   he could potentially\
    \ exploit a known vulnerability and gain access to\n   the system.  From a captured\
    \ configuration file, he could obtain\n   confidential network topology information,\
    \ or even more damaging\n   information, if any of the passwords in the configuration\
    \ file were\n   not encrypted.\n"
- title: 2.5.2.  Security Practices
  contents:
  - "2.5.2.  Security Practices\n   Images and configurations are stored on specific\
    \ hosts that have\n   limited access.  All access and activity relating to these\
    \ hosts are\n   authenticated and logged via AAA services.  When uploaded/downloading\n\
    \   any system software or configuration files, either TFTP, FTP, or SCP\n   can\
    \ be used.  Where possible, SCP is used to secure the data transfer\n   and FTP\
    \ is generally never used.  All SCP access is username/password\n   authenticated\
    \ but since this requires an interactive shell, most ISPs\n   will use shared\
    \ key authentication to avoid the interactive shell.\n   While TFTP access does\
    \ not have any security measures, it is still\n   widely used, especially in OOB\
    \ management scenarios.  Some ISPs\n   implement IP-based restriction on the TFTP\
    \ server, while some custom\n   written TFTP servers will support MAC-based authentication.\
    \  The\n   MAC-based authentication is more common when using TFTP to bootstrap\n\
    \   routers remotely.\n   In most environments, scripts are used for maintaining\
    \ the images and\n   configurations of a large number of routers.  To ensure the\
    \ integrity\n   of the configurations, every hour the configuration files are\
    \ polled\n   and compared to the previously polled version to find discrepancies.\n\
    \   In at least one environment these, tools are Kerberized to take\n   advantage\
    \ of automated authentication (not confidentiality).\n   'Rancid' is one popular\
    \ publicly available tool for detecting\n   configuration and system changes.\n\
    \   Filters are used to limit access to uploading/downloading\n   configuration\
    \ files and system images to specific IP addresses and\n   protocols.\n   The\
    \ software images perform Cyclic Redundancy Checks (CRC) and the\n   system binaries\
    \ use the MD5 algorithm to validate integrity.  Many\n   ISPs expressed interest\
    \ in having software image integrity validation\n   based on the MD5 algorithm\
    \ for enhanced security.\n   In all configuration files, most passwords are stored\
    \ in an encrypted\n   format.  Note that the encryption techniques used in varying\
    \ products\n   can vary and that some weaker encryption schemes may be subject\
    \ to\n   off-line dictionary attacks.  This includes passwords for user\n   authentication,\
    \ MD5-authentication shared secrets, AAA server shared\n   secrets, NTP shared\
    \ secrets, etc.  For older software that may not\n   support this functionality,\
    \ configuration files may contain some\n   passwords in readable format.  Most\
    \ ISPs mitigate any risk of\n   password compromise by either storing these configuration\
    \ files\n   without the password lines or by requiring authenticated and\n   authorized\
    \ access to the configuration files that are stored on\n   protected OOB management\
    \ devices.\n   Automated security validation is performed on infrastructure devices\n\
    \   using Network Mapping (Nmap) and Nessus to ensure valid configuration\n  \
    \ against many of the well-known attacks.\n"
- title: 2.5.3.  Security Services
  contents:
  - "2.5.3.  Security Services\n   o  User Authentication - All users are authenticated\
    \ before being\n      able to download/upload any system images or configuration\
    \ files.\n   o  User Authorization - All authenticated users are granted specific\n\
    \      privileges to download or upload system images and/or\n      configuration\
    \ files.\n   o  Data Origin Authentication - Filters are used to limit access\
    \ to\n      uploading/downloading configuration files and system images to\n \
    \     specific IP addresses.\n   o  Access Control - Filters are used to limit\
    \ access to uploading/\n      downloading configuration files and system images\
    \ to specific IP\n      addresses and protocols.\n   o  Data Integrity - All systems\
    \ use either a CRC-check or MD5\n      authentication to ensure data integrity.\
    \  Also, tools such as\n      rancid are used to automatically detect configuration\
    \ changes.\n   o  Data Confidentiality - If the SCP protocol is used then there\
    \ is\n      confidentiality of the downloaded/uploaded configuration files and\n\
    \      system images.\n   o  Auditing/Logging - All access and activity relating\
    \ to\n      downloading/uploading system images and configuration files are\n\
    \      logged via AAA services and filter exception rules.\n   o  DoS Mitigation\
    \ - A combination of filtering and CRC-check/\n      MD5-based integrity checks\
    \ are used to mitigate the risks of DoS\n      attacks.  If the software updates\
    \ and configuration changes are\n      performed via an OOB management system,\
    \ this is also added\n      protection.\n"
- title: 2.5.4.  Additional Considerations
  contents:
  - "2.5.4.  Additional Considerations\n   Where the MD5 algorithm is not used to\
    \ perform data-integrity\n   checking of software images and configuration files,\
    \ ISPs have\n   expressed an interest in having this functionality.  IPsec is\n\
    \   considered too cumbersome and operationally difficult to use for data\n  \
    \ integrity and confidentiality.\n"
- title: 2.6.  Logging Considerations
  contents:
  - "2.6.  Logging Considerations\n   Although logging is part of all the previous\
    \ sections, it is\n   important enough to be covered as a separate item.  The\
    \ main issues\n   revolve around what gets logged, how long are logs kept, and\
    \ what\n   mechanisms are used to secure the logged information while it is in\n\
    \   transit and while it is stored.\n"
- title: 2.6.1.  Threats/Attacks
  contents:
  - "2.6.1.  Threats/Attacks\n   Attacks on the logged data can be both from passive\
    \ or active\n   sources.  Passive attacks are possible if someone has the capability\n\
    \   to intercept data between the recipient logging server and the device\n  \
    \ from which the logged data originated.  This can be accomplished if a\n   single\
    \ infrastructure device is somehow compromised and can act as a\n   network sniffer,\
    \ or if it is possible to insert a new device that\n   acts as a network sniffer.\n\
    \   Active attacks are possible for both on-path and off-path scenarios.\n   For\
    \ on-path active attacks, the situation is the same as for a\n   passive attack,\
    \ where either a device has to already be compromised,\n   or a device can be\
    \ inserted into the path.  For off-path active\n   attacks, the attacks are generally\
    \ limited to message insertion or\n   modification that can alter the logged data\
    \ to keep any compromise\n   from being detected, or to destroy any evidence that\
    \ could be used\n   for criminal prosecution.\n"
- title: 2.6.1.1.  Confidentiality Violations
  contents:
  - "2.6.1.1.  Confidentiality Violations\n   Confidentiality violations can occur\
    \ when a miscreant intercepts any\n   of the logging data that is in transit on\
    \ the network.  This could\n   lead to privacy violations if some of the logged\
    \ data has not been\n   sanitized to disallow any data that could be a violation\
    \ of privacy\n   to be included in the logged data.\n"
- title: 2.6.1.2.  Offline Cryptographic Attacks
  contents:
  - "2.6.1.2.  Offline Cryptographic Attacks\n   If any cryptographic mechanism was\
    \ used to provide for data integrity\n   and confidentiality, an offline cryptographic\
    \ attack could\n   potentially compromise the data.  The traffic would need to\
    \ be\n   captured either by eavesdropping on the network or by being able to\n\
    \   divert traffic to a malicious user.\n"
- title: 2.6.1.3.  Replay Attacks
  contents:
  - "2.6.1.3.  Replay Attacks\n   For a replay attack to be successful, the logging\
    \ data would need to\n   first be captured either on-path or diverted to an attacker\
    \ and later\n   replayed to the recipient.\n"
- title: 2.6.1.4.  Message Insertion/Deletion/Modification
  contents:
  - "2.6.1.4.  Message Insertion/Deletion/Modification\n   Logging data could be injected,\
    \ deleted, or modified by someone in\n   control of intermediate hosts.  Logging\
    \ data can also be injected by\n   forging packets from either legitimate or illegitimate\
    \ IP addresses.\n"
- title: 2.6.1.5.  Man-In-The-Middle
  contents:
  - "2.6.1.5.  Man-In-The-Middle\n   A man-in-the-middle attack attacks the identity\
    \ of a communicating\n   peer rather than the data stream itself.  The attacker\
    \ intercepts\n   traffic that is sent between the infrastructure device and the\n\
    \   logging server or traffic sent between the logging server and the\n   database\
    \ that is used to archive the logged data.  Any unauthorized\n   access to logging\
    \ information could lead to the knowledge of private\n   and proprietary network\
    \ topology information, which could be used to\n   compromise portions of the\
    \ network.  An additional concern is having\n   access to logging information,\
    \ which could be deleted or modified so\n   as to cover any traces of a security\
    \ breach.\n"
- title: 2.6.2.  Security Practices
  contents:
  - "2.6.2.  Security Practices\n   When it comes to filtering, logging is mostly\
    \ performed on an\n   exception auditing basis (i.e., traffic that is NOT allowed\
    \ is\n   logged).  This is to assure that the logging servers are not\n   overwhelmed\
    \ with data, which would render most logs unusable.\n   Typically the data logged\
    \ will contain the source and destination IP\n   addresses and layer 4 port numbers\
    \ as well as a timestamp.  The\n   syslog protocol is used to transfer the logged\
    \ data between the\n   infrastructure device to the syslog server.  Many ISPs\
    \ use the OOB\n   management network to transfer syslog data since there is virtually\n\
    \   no security performed between the syslog server and the device.  All\n   ISPs\
    \ have multiple syslog servers - some ISPs choose to use separate\n   syslog servers\
    \ for varying infrastructure devices (i.e., one syslog\n   server for backbone\
    \ routers, one syslog server for customer edge\n   routers, etc.)\n   The timestamp\
    \ is derived from NTP, which is generally configured as a\n   flat hierarchy at\
    \ stratum1 and stratum2 to have less configuration\n   and less maintenance. \
    \ Consistency of configuration and redundancy is\n   the primary goal.  Each router\
    \ is configured with several stratum1\n   server sources, which are chosen to\
    \ ensure that proper NTP time is\n   available, even in the event of varying network\
    \ outages.\n   In addition to logging filtering exceptions, the following is\n\
    \   typically logged: routing protocol state changes, all device access\n   (regardless\
    \ of authentication success or failure), all commands\n   issued to a device,\
    \ all configuration changes, and all router events\n   (boot-up/flaps).\n   The\
    \ main function of any of these log messages is to see what the\n   device is\
    \ doing as well as to try and ascertain what certain\n   malicious attackers are\
    \ trying to do.  Since syslog is an unreliable\n   protocol, when routers boot\
    \ or lose adjacencies, not all messages\n   will get delivered to the remote syslog\
    \ server.  Some vendors may\n   implement syslog buffering (e.g., buffer the messages\
    \ until you have\n   a route to the syslog destination), but this is not standard.\n\
    \   Therefore, operators often have to look at local syslog information\n   on\
    \ a device (which typically has very little memory allocated to it)\n   to make\
    \ up for the fact that the server-based syslog files can be\n   incomplete.  Some\
    \ ISPs also put in passive devices to see routing\n   updates and withdrawals\
    \ and do not rely solely on the device for log\n   files.  This provides a backup\
    \ mechanism to see what is going on in\n   the network in the event that a device\
    \ may 'forget' to do syslog if\n   the CPU is busy.\n   The logs from the various\
    \ syslog server devices are generally\n   transferred into databases at a set\
    \ interval that can be anywhere\n   from every 10 minutes to every hour.  One\
    \ ISP uses Rsync to push the\n   data into a database, and then the information\
    \ is sorted manually by\n   someone SSH'ing to that database.\n"
- title: 2.6.3.  Security Services
  contents:
  - "2.6.3.  Security Services\n   o  User Authentication - Not applicable.\n   o\
    \  User Authorization - Not applicable.\n   o  Data Origin Authentication - Not\
    \ implemented.\n   o  Access Control - Filtering on logging host and server IP\
    \ address\n      to ensure that syslog information only goes to specific syslog\n\
    \      hosts.\n   o  Data Integrity - Not implemented.\n   o  Data Confidentiality\
    \ - Not implemented.\n   o  Auditing/Logging - This entire section deals with\
    \ logging.\n   o  DoS Mitigation - An OOB management system is used and sometimes\n\
    \      different syslog servers are used for logging information from\n      varying\
    \ equipment.  Exception logging tries to keep information to\n      a minimum.\n"
- title: 2.6.4.  Additional Considerations
  contents:
  - "2.6.4.  Additional Considerations\n   There is no security with syslog and ISPs\
    \ are fully cognizant of\n   this.  IPsec is considered too operationally expensive\
    \ and cumbersome\n   to deploy.  Syslog-ng and stunnel are being looked at for\
    \ providing\n   better authenticated and integrity-protected solutions.  Mechanisms\n\
    \   to prevent unauthorized personnel from tampering with logs is\n   constrained\
    \ to auditing who has access to the logging servers and\n   files.\n   ISPs expressed\
    \ requirements for more than just UDP syslog.\n   Additionally, they would like\
    \ more granular and flexible facilities\n   and priorities, i.e., specific logs\
    \ to specific servers.  Also, a\n   common format for reporting standard events\
    \ so that modifying parsers\n   after each upgrade of a vendor device or software\
    \ is not necessary.\n"
- title: 2.7.  Filtering Considerations
  contents:
  - "2.7.  Filtering Considerations\n   Although filtering has been covered under\
    \ many of the previous\n   sections, this section will provide some more insights\
    \ to the\n   filtering considerations that are currently being taken into account.\n\
    \   Filtering is now being categorized into three specific areas: data\n   plane,\
    \ management plane, and routing control plane.\n"
- title: 2.7.1.  Data Plane Filtering
  contents:
  - "2.7.1.  Data Plane Filtering\n   Data plane filters control the traffic that\
    \ traverses through a\n   device and affects transit traffic.  Most ISPs deploy\
    \ these kinds of\n   filters at customer facing edge devices to mitigate spoofing\
    \ attacks\n   using BCP38 and BCP84 guidelines.\n"
- title: 2.7.2.  Management Plane Filtering
  contents:
  - "2.7.2.  Management Plane Filtering\n   Management filters control the traffic\
    \ to and from a device.  All of\n   the protocols that are used for device management\
    \ fall under this\n   category and include: SSH, Telnet, SNMP, NTP, HTTP, DNS,\
    \ TFTP, FTP,\n   SCP, and Syslog.  This type of traffic is often filtered per\n\
    \   interface and is based on any combination of protocol, source and\n   destination\
    \ IP address, and source and destination port number.  Some\n   devices support\
    \ functionality to apply management filters to the\n   device rather than to the\
    \ specific interfaces (e.g., receive ACL or\n   loopback interface ACL), which\
    \ is gaining wider acceptance.  Note\n   that logging the filtering rules can\
    \ today place a burden on many\n   systems and more granularity is often required\
    \ to more specifically\n   log the required exceptions.\n   Any services that\
    \ are not specifically used are turned off.\n   IPv6 networks require the use\
    \ of specific ICMP messages for proper\n   protocol operation.  Therefore, ICMP\
    \ cannot be completely filtered to\n   and from a device.  Instead, granular ICMPv6\
    \ filtering is always\n   deployed to allow for specific ICMPv6 types to be sourced\
    \ or destined\n   to a network device.  A good guideline for IPv6 filtering is\
    \ in the\n   Recommendations for Filtering ICMPv6 Messages in Firewalls [ICMPv6].\n"
- title: 2.7.3.  Routing Control Plane Filtering
  contents:
  - "2.7.3.  Routing Control Plane Filtering\n   Routing filters are used to control\
    \ the flow of routing information.\n   In IPv6 networks, some providers are liberal\
    \ in accepting /48s due to\n   the still unresolved multihoming issues, while\
    \ others filter at\n   allocation boundaries, which are typically at /32.  Any\
    \ announcement\n   received that is longer than a /48 for IPv6 routing and a /24\
    \ for\n   IPv4 routing is filtered out of eBGP.  Note that this is for\n   non-customer\
    \ traffic.  Most ISPs will accept any agreed upon prefix\n   length from its customer(s).\n"
- title: 2.8.  Denial-of-Service Tracking/Tracing
  contents:
  - "2.8.  Denial-of-Service Tracking/Tracing\n   Denial-of-Service attacks are an\
    \ ever-increasing problem and require\n   vast amounts of resources to combat\
    \ effectively.  Some large ISPs do\n   not concern themselves with attack streams\
    \ that are less than 1G in\n   bandwidth - this is on the larger pipes where 1G\
    \ is essentially less\n   than 5% of an offered load.  This is largely due to\
    \ the large amounts\n   of DoS traffic, which continually requires investigation\
    \ and\n   mitigation.  At last count, the number of hosts making up large\n  \
    \ distributed DoS botnets exceeded 1 million hosts.\n   New techniques are continually\
    \ evolving to automate the process of\n   detecting DoS sources and mitigating\
    \ any adverse effects as quickly\n   as possible.  At this time, ISPs are using\
    \ a variety of mitigation\n   techniques including: sinkhole routing, black hole\
    \ triggered routing,\n   uRPF, rate limiting, and specific control plane traffic\
    \ enhancements.\n   Each of these techniques will be detailed below.\n"
- title: 2.8.1.  Sinkhole Routing
  contents:
  - "2.8.1.  Sinkhole Routing\n   Sinkhole routing refers to injecting a more specific\
    \ route for any\n   known attack traffic, which will ensure that the malicious\
    \ traffic is\n   redirected to a valid device or specific system where it can\
    \ be\n   analyzed.\n"
- title: 2.8.2.  Black Hole Triggered Routing
  contents:
  - "2.8.2.  Black Hole Triggered Routing\n   Black hole triggered routing (also referred\
    \ to as Remote Triggered\n   Black Hole Filtering) is a technique where the BGP\
    \ routing protocol\n   is used to propagate routes which in turn redirects attack\
    \ traffic to\n   the null interface where it is effectively dropped.  This technique\n\
    \   is often used in large routing infrastructures since BGP can\n   propagate\
    \ the information in a fast, effective manner, as opposed to\n   using any packet-based\
    \ filtering techniques on hundreds or thousands\n   of routers (refer to the following\
    \ NANOG presentation for a more\n   complete description http://www.nanog.org/mtg-0402/pdf/morrow.pdf).\n\
    \   Note that this black-holing technique may actually fulfill the goal\n   of\
    \ the attacker if the goal was to instigate black-holing traffic\n   that appeared\
    \ to come from a certain site.  On the other hand, this\n   black hole technique\
    \ can decrease the collateral damage caused by an\n   overly large attack aimed\
    \ at something other than critical services.\n"
- title: 2.8.3.  Unicast Reverse Path Forwarding
  contents:
  - "2.8.3.  Unicast Reverse Path Forwarding\n   Unicast Reverse Path Forwarding (uRPF)\
    \ is a mechanism for validating\n   whether or not an incoming packet has a legitimate\
    \ source address.\n   It has two modes: strict mode and loose mode.  In strict\
    \ mode, uRPF\n   checks whether the incoming packet has a source address that\
    \ matches\n   a prefix in the routing table, and whether the interface expects\
    \ to\n   receive a packet with this source address prefix.  If the incoming\n\
    \   packet fails the unicast RPF check, the packet is not accepted on the\n  \
    \ incoming interface.  Loose mode uRPF is not as specific and the\n   incoming\
    \ packet is accepted if there is any route in the routing\n   table for the source\
    \ address.\n   While BCP84 [RFC3704] and a study on uRPF experiences [BCP84-URPF]\n\
    \   detail how asymmetry, i.e., multiple routes to the source of a\n   packet,\
    \ does not preclude applying feasible paths strict uRPF, it is\n   generally not\
    \ used on interfaces that are likely to have routing\n   asymmetry.  Usually for\
    \ the larger ISPs, uRPF is placed at the\n   customer edge of a network.\n"
- title: 2.8.4.  Rate Limiting
  contents:
  - "2.8.4.  Rate Limiting\n   Rate limiting refers to allocating a specific amount\
    \ of bandwidth or\n   packets per second to specific traffic types.  This technique\
    \ is\n   widely used to mitigate well-known protocol attacks such as the\n   TCP-SYN\
    \ attack, where a large number of resources get allocated for\n   spoofed TCP\
    \ traffic.  Although this technique does not stop an\n   attack, it can sometimes\
    \ lessen the damage and impact on a specific\n   service.  However, it can also\
    \ make the impact of a DoS attack much\n   worse if the rate limiting is impacting\
    \ (i.e., discarding) more\n   legitimate traffic.\n"
- title: 2.8.5.  Specific Control Plane Traffic Enhancements
  contents:
  - "2.8.5.  Specific Control Plane Traffic Enhancements\n   Some ISPs are starting\
    \ to use capabilities that are available from\n   some vendors to simplify the\
    \ filtering and rate limiting of control\n   traffic.  Control traffic here refers\
    \ to the routing control plane\n   and management plane traffic that requires\
    \ CPU cycles.  A DoS attack\n   against any control plane traffic can therefore\
    \ be much more damaging\n   to a critical device than other types of traffic.\
    \  No consistent\n   deployment of this capability was found at the time of this\
    \ writing.\n"
- title: 3.  Security Considerations
  contents:
  - "3.  Security Considerations\n   This entire document deals with current security\
    \ practices in large\n   ISP environments.  It lists specific practices used in\
    \ today's\n   environments and as such, does not in itself pose any security risk.\n"
- title: 4.  Acknowledgments
  contents:
  - "4.  Acknowledgments\n   The editor gratefully acknowledges the contributions\
    \ of: George\n   Jones, who has been instrumental in providing guidance and direction\n\
    \   for this document, and the insightful comments from Ross Callon, Ron\n   Bonica,\
    \ Ryan Mcdowell, Gaurab Upadhaya, Warren Kumari, Pekka Savola,\n   Fernando Gont,\
    \ Chris Morrow, Ted Seely, Donald Smith, and the\n   numerous ISP operators who\
    \ supplied the information that is depicted\n   in this document.\n"
- title: 5.  References
  contents:
  - '5.  References

    '
- title: 5.1.  Normative References
  contents:
  - "5.1.  Normative References\n   [RFC2827]     Ferguson, P. and D. Senie, \"Network\
    \ Ingress Filtering:\n                 Defeating Denial of Service Attacks which\
    \ employ IP\n                 Source Address Spoofing\", BCP 38, RFC 2827, May\
    \ 2000.\n   [RFC2828]     Shirey, R., \"Internet Security Glossary\", RFC 2828,\n\
    \                 May 2000.\n   [RFC3552]     Rescorla, E. and B. Korver, \"Guidelines\
    \ for Writing RFC\n                 Text on Security Considerations\", BCP 72,\
    \ RFC 3552,\n                 July 2003.\n   [RFC3682]     Gill, V., Heasley,\
    \ J., and D. Meyer, \"The Generalized\n                 TTL Security Mechanism\
    \ (GTSM)\", RFC 3682,\n                 February 2004.\n   [RFC3704]     Baker,\
    \ F. and P. Savola, \"Ingress Filtering for\n                 Multihomed Networks\"\
    , BCP 84, RFC 3704, March 2004.\n   [RFC3882]     Turk, D., \"Configuring BGP\
    \ to Block Denial-of-Service\n                 Attacks\", RFC 3882, September\
    \ 2004.\n"
- title: 5.2.  Informational References
  contents:
  - "5.2.  Informational References\n   [BCP84-URPF]  Savola, P., \"Experiences from\
    \ Using Unicast RPF\", Work\n                 in Progress, November 2006.\n  \
    \ [ICMPv6]      Davies, E. and J. Mohacsi, \"Recommendations for\n           \
    \      Filtering ICMPv6 Messages in Firewalls\", Work\n                 in Progress,\
    \ July 2006.\n   [RTGWG]       Savola, P., \"Backbone Infrastructure Attacks and\n\
    \                 Protections\", Work in Progress, July 2006.\n"
- title: Appendix A.  Protocol Specific Attacks
  contents:
  - "Appendix A.  Protocol Specific Attacks\n   This section will list many of the\
    \ traditional protocol-based attacks\n   that have been observed over the years\
    \ to cause malformed packets\n   and/or exploit protocol deficiencies.  Note that\
    \ they all exploit\n   vulnerabilities in the actual protocol itself and often,\
    \ additional\n   authentication and auditing mechanisms are now used to detect\
    \ and\n   mitigate the impact of these attacks.  The list is not exhaustive,\n\
    \   but is a fraction of the representation of what types of attacks are\n   possible\
    \ for varying protocols.\n"
- title: A.1.  Layer 2 Attacks
  contents:
  - "A.1.  Layer 2 Attacks\n   o  ARP Flooding\n"
- title: A.2.  IPv4 Protocol-Based Attacks
  contents:
  - "A.2.  IPv4 Protocol-Based Attacks\n   o  IP Addresses, either source or destination,\
    \ can be spoofed which\n      in turn can circumvent established filtering rules.\n\
    \   o  IP Source Route Option can allows attackers to establish stealth\n    \
    \  TCP connections.\n   o  IP Record Route Option can disclose information about\
    \ the topology\n      of the network.\n   o  IP header that is too long or too\
    \ short can cause DoS attacks to\n      devices.\n   o  IP Timestamp Option can\
    \ leak information that can be used to\n      discern network behavior.\n   o\
    \  Fragmentation attacks which can vary widely - more detailed\n      information\
    \ can be found at http://www-src.lip6.fr/homepages/\n      Fabrice.Legond-Aubry/www.ouah.org/fragma.html.\n\
    \   o  IP ToS field (or the Differentiated Services (DSCP) field) can be\n   \
    \   used to reroute or reclassify traffic based on specified\n      precedence.\n\
    \   o  IP checksum field has been used for scanning purposes, for example\n  \
    \    when some firewalls did not check the checksum and allowed an\n      attacker\
    \ to differentiate when the response came from an end-\n      system, and when\
    \ from a firewall.\n   o  IP TTL field can be used to bypass certain network-based\
    \ intrusion\n      detection systems and to map network behavior.\n"
- title: A.2.1.  Higher Layer Protocol Attacks
  contents:
  - "A.2.1.  Higher Layer Protocol Attacks\n   The following lists additional attacks,\
    \ but does not explicitly\n   numerate them in detail.  It is for informational\
    \ purposes only.\n   o  IGMP oversized packet\n   o  ICMP Source Quench\n   o\
    \  ICMP Mask Request\n   o  ICMP Large Packet (> 1472)\n   o  ICMP Oversized packet\
    \ (>65536)\n   o  ICMP Flood\n   o  ICMP Broadcast w/ Spoofed Source (Smurf Attack)\n\
    \   o  ICMP Error Packet Flood\n   o  ICMP Spoofed Unreachable\n   o  TCP Packet\
    \ without Flag\n   o  TCP Oversized Packet\n   o  TCP FIN bit with no ACK bit\n\
    \   o  TCP Packet with URG/OOB flag (Nuke Attack)\n   o  SYN Fragments\n   o \
    \ SYN Flood\n   o  SYN with IP Spoofing (Land Attack)\n   o  SYN and FIN bits\
    \ set\n   o  TCP port scan attack\n   o  UDP spoofed broadcast echo (Fraggle Attack)\n\
    \   o  UDP attack on diagnostic ports (Pepsi Attack)\n"
- title: A.3.  IPv6 Attacks
  contents:
  - "A.3.  IPv6 Attacks\n   Any of the above-mentioned IPv4 attacks could be used\
    \ in IPv6\n   networks with the exception of any fragmentation and broadcast\n\
    \   traffic, which operate differently in IPv6.  Note that all of these\n   attacks\
    \ are based on either spoofing or misusing any part of the\n   protocol field(s).\n\
    \   Today, IPv6-enabled hosts are starting to be used to create IPv6\n   tunnels,\
    \ which can effectively hide botnet and other malicious\n   traffic if firewalls\
    \ and network flow collection tools are not\n   capable of detecting this traffic.\
    \  The security measures used for\n   protecting IPv6 infrastructures should be\
    \ the same as in IPv4\n   networks, but with additional considerations for IPv6\
    \ network\n   operations, which may be different from IPv4.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Merike Kaeo\n   Double Shot Security, Inc.\n   3518 Fremont\
    \ Avenue North #363\n   Seattle, WA  98103\n   U.S.A.\n   Phone: +1 310 866 0165\n\
    \   EMail: merike@doubleshotsecurity.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
