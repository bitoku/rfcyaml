- title: __initial_text__
  contents:
  - "                Extensible Authentication Protocol (EAP)\n                 Early\
    \ Authentication Problem Statement\n"
- title: Abstract
  contents:
  - "Abstract\n   Extensible Authentication Protocol (EAP) early authentication may\
    \ be\n   defined as the use of EAP by a mobile device to establish\n   authenticated\
    \ keying material on a target attachment point prior to\n   its arrival.  This\
    \ document discusses the EAP early authentication\n   problem in detail.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc5836.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n   This document\
    \ may contain material from IETF Documents or IETF\n   Contributions published\
    \ or made publicly available before November\n   10, 2008.  The person(s) controlling\
    \ the copyright in some of this\n   material may not have granted the IETF Trust\
    \ the right to allow\n   modifications of such material outside the IETF Standards\
    \ Process.\n   Without obtaining an adequate license from the person(s) controlling\n\
    \   the copyright in such materials, this document may not be modified\n   outside\
    \ the IETF Standards Process, and derivative works of it may\n   not be created\
    \ outside the IETF Standards Process, except to format\n   it for publication\
    \ as an RFC or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \ 3. Problem Statement ...............................................6\n    \
    \  3.1. Handover Preparation .......................................6\n      3.2.\
    \ Handover Execution .........................................6\n           3.2.1.\
    \ Examples ............................................7\n      3.3. Solution\
    \ Space .............................................7\n           3.3.1. Context\
    \ Transfer ....................................7\n           3.3.2. Early Authentication\
    \ ................................8\n   4. System Overview .................................................8\n\
    \   5. Topological Classification of Handover Scenarios ................9\n  \
    \ 6. Models of Early Authentication .................................10\n    \
    \  6.1. EAP Pre-Authentication Usage Models .......................10\n      \
    \     6.1.1. The Direct Pre-Authentication Model ................11\n        \
    \   6.1.2. The Indirect Pre-Authentication Usage Model ........11\n      6.2.\
    \ The Authenticated Anticipatory Keying Usage Model .........13\n   7. Architectural\
    \ Considerations ...................................13\n      7.1. Authenticator\
    \ Discovery ...................................13\n      7.2. Context Binding\
    \ ...........................................14\n   8. AAA Issues .....................................................14\n\
    \   9. Security Considerations ........................................16\n  \
    \ 10. Acknowledgments ...............................................17\n   11.\
    \ Contributors ..................................................17\n   12. References\
    \ ....................................................17\n      12.1. Normative\
    \ References .....................................17\n      12.2. Informative\
    \ References ...................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   When a mobile device, during an active communication session,\
    \ moves\n   from one access network to another and changes its attachment point,\n\
    \   the session may be subjected to disruption of service due to the\n   delay\
    \ associated with the handover operation.  The performance\n   requirements of\
    \ a real-time application will vary based on the type\n   of application and its\
    \ characteristics such as delay and packet-loss\n   tolerance.  For Voice over\
    \ IP applications, ITU-T G.114 [ITU]\n   recommends a steady-state end-to-end\
    \ delay of 150 ms as the upper\n   limit and rates 400 ms as generally unacceptable\
    \ delay.  Similarly, a\n   streaming application has tolerable packet-error rates\
    \ ranging from\n   0.1 to 0.00001 with a transfer delay of less than 300 ms. \
    \ Any help\n   that an optimized handoff mechanism can provide toward meeting\
    \ these\n   objectives is useful.  The ultimate objective is to achieve seamless\n\
    \   handover with low latency, even when handover is between different\n   link\
    \ technologies or between different Authentication, Authorization,\n   and Accounting\
    \ (AAA) realms.\n   As a mobile device goes through a handover process, it is\
    \ subjected\n   to delay because of the rebinding of its association at or across\n\
    \   several layers of the protocol stack and because of the additional\n   round\
    \ trips needed for a new EAP exchange.  Delays incurred within\n   each protocol\
    \ layer affect the ongoing multimedia application and\n   data traffic within\
    \ the client [WCM].\n   The handover process often requires authentication and\
    \ authorization\n   for acquisition or modification of resources assigned to the\
    \ mobile\n   device.  In most cases, these authentications and authorizations\n\
    \   require interaction with a central authority in a realm.  In some\n   cases,\
    \ the central authority may be distant from the mobile device.\n   The delay introduced\
    \ due to such an authentication and authorization\n   procedure adds to the handover\
    \ latency and consequently affects\n   ongoing application sessions [MQ7].  The\
    \ discussion in this document\n   is focused on mitigating delay due to EAP authentication.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   AAA\n      Authentication, Authorization, and Accounting\
    \ (see below).  RADIUS\n      [RFC2865] and Diameter [RFC3588] are examples of\
    \ AAA protocols\n      defined in the IETF.\n   AAA realm\n      The set of access\
    \ networks within the scope of a specific AAA\n      server.  Thus, if a mobile\
    \ device moves from one attachment point\n      to another within the same AAA\
    \ realm, it continues to be served by\n      the same AAA server.\n   Accounting\n\
    \      The act of collecting information on resource usage for the\n      purpose\
    \ of trend analysis, auditing, billing, or cost allocation\n      [RFC2989].\n\
    \   Attachment Point\n      A device, such as a wireless access point, that serves\
    \ as a\n      gateway between access clients and a network.  In the context of\n\
    \      this document, an attachment point must also support EAP\n      authenticator\
    \ functionality and may act as a AAA client.\n   Authentication\n      The act\
    \ of verifying a claimed identity, in the form of a\n      preexisting label from\
    \ a mutually known name space, as the\n      originator of a message (message\
    \ authentication) or as the end-\n      point of a channel (entity authentication)\
    \ [RFC2989].\n   Authenticator\n      The end of the link initiating EAP authentication\
    \ [RFC3748].\n   Authorization\n      The act of determining if a particular right,\
    \ such as access to\n      some resource, can be granted to the presenter of a\
    \ particular\n      credential [RFC2989].\n   Candidate Access Network\n     \
    \ An access network that can potentially become the target access\n      network\
    \ for a mobile device.  Multiple access networks may be\n      candidates simultaneously.\n\
    \   Candidate Attachment Point (CAP)\n      An attachment point that can potentially\
    \ become the target\n      attachment point for a mobile device.  Multiple attachment\
    \ points\n      may be candidates simultaneously.\n   Candidate Authenticator\
    \ (CA)\n      The EAP authenticator on the CAP.\n   EAP Server\n      The entity\
    \ that terminates the EAP authentication method with the\n      peer [RFC3748].\
    \  EAP servers are often, but not necessarily,\n      co-located with AAA servers,\
    \ using a AAA protocol to communicate\n      with remote pass-through authenticators.\n\
    \   Inter-AAA-realm Handover (Inter-realm Handover)\n      A handover across multiple\
    \ AAA realms.\n   Inter-Technology Handover\n      A handover across different\
    \ link-layer technologies.\n   Intra-AAA-realm Handover (Intra-realm Handover)\n\
    \      A handover within the same AAA realm.  Intra-AAA-realm handover\n     \
    \ includes a handover across different authenticators within the\n      same AAA\
    \ realm.\n   Intra-Technology Handover\n      A handover within the same link-layer\
    \ technology.\n   Master Session Key (MSK)\n      Keying material that is derived\
    \ between the EAP peer and server\n      and exported by the EAP method [RFC3748].\n\
    \   Peer\n      The entity that responds to the authenticator and requires\n \
    \     authentication [RFC3748].\n   Serving Access Network\n      An access network\
    \ that is currently serving the mobile device.\n   Serving Attachment Point (SAP)\n\
    \      An attachment point that is currently serving the mobile device.\n   Target\
    \ Access Network\n      An access network that has been selected to be the new\
    \ serving\n      access network for a mobile device.\n   Target Attachment Point\
    \ (TAP)\n      An attachment point that has been selected to be the new SAP for\
    \ a\n      mobile device.\n"
- title: 3.  Problem Statement
  contents:
  - "3.  Problem Statement\n   The basic mechanism of handover is a two-step procedure\
    \ involving\n   o  handover preparation and\n   o  handover execution\n"
- title: 3.1.  Handover Preparation
  contents:
  - "3.1.  Handover Preparation\n   Handover preparation includes the discovery of\
    \ candidate attachment\n   points and selection of an appropriate target attachment\
    \ point from\n   the candidate set.  Handover preparation is outside the scope\
    \ of this\n   document.\n"
- title: 3.2.  Handover Execution
  contents:
  - "3.2.  Handover Execution\n   Handover execution consists of setting up Layer\
    \ 2 (L2) and Layer 3\n   (L3) connectivity with the TAP.  Currently, handover\
    \ execution\n   includes network access authentication and authorization performed\n\
    \   directly with the target network; this may include full EAP\n   authentication\
    \ in the absence of any particular optimization for\n   handover key management.\
    \  Following a successful EAP authentication,\n   a secure association procedure\
    \ is typically performed between the\n   mobile device and the TAP to derive a\
    \ new set of link-layer\n   encryption keys from EAP keying material such as the\
    \ MSK.  The\n   handover latency introduced by full EAP authentication has proven\
    \ to\n   be higher than that which is acceptable for real-time application\n \
    \  scenarios [MQ7]; hence, reduction in handover latency due to EAP is a\n   necessary\
    \ objective for such scenarios.\n"
- title: 3.2.1.  Examples
  contents:
  - '3.2.1.  Examples

    '
- title: 3.2.1.1.  IEEE 802.11
  contents:
  - "3.2.1.1.  IEEE 802.11\n   In IEEE 802.11 Wireless Local Area Networks (WLANs)\n\
    \   [IEEE.802-11.2007] network access authentication and authorization\n   involves\
    \ performing a new IEEE 802.1X [IEEE.802-1X.2004] message\n   exchange with the\
    \ authenticator in the TAP to execute an EAP exchange\n   with the authentication\
    \ server [WPA].  There has been some\n   optimization work undertaken by the IEEE,\
    \ but these efforts have been\n   scoped to IEEE link-layer technologies; for\
    \ example, the work done in\n   the IEEE 802.11f [IEEE.802-11F.2003] and 802.11r\
    \ [IEEE.802-11R.2008]\n   Task Groups applies only to intra-technology handovers.\n"
- title: 3.2.1.2.  3GPP TS33.402
  contents:
  - "3.2.1.2.  3GPP TS33.402\n   The Third Generation Partnership Project (3GPP) Technical\n\
    \   Specification 33.402 [TS33.402] defines the authentication and key\n   management\
    \ procedures performed during interworking between non-3GPP\n   access networks\
    \ and the Evolved Packet System (EPS).  Network access\n   authentication and\
    \ authorization happens after the L2 connection is\n   established between the\
    \ mobile device and a non-3GPP target access\n   network, and involves an EAP\
    \ exchange between the mobile device and\n   the 3GPP AAA server via the non-3GPP\
    \ target access network.  These\n   procedures are not really independent of link\
    \ technology, since they\n   assume either that the authenticator lies in the\
    \ EPS network or that\n   separate authentications are performed in the access\
    \ network and then\n   in the EPS network.\n"
- title: 3.3.  Solution Space
  contents:
  - "3.3.  Solution Space\n   As the examples in the preceding sections illustrate,\
    \ a solution is\n   needed to enable EAP early authentication for inter-AAA-realm\n\
    \   handovers and inter-technology handovers.  A search for solutions at\n   the\
    \ IP level may offer the necessary technology independence.\n   Optimized solutions\
    \ for secure inter-authenticator handovers can be\n   seen either as security\
    \ context transfer (e.g., using the EAP\n   Extensions for EAP Re-authentication\
    \ Protocol (ERP)) [RFC5296], or as\n   EAP early authentication.\n"
- title: 3.3.1.  Context Transfer
  contents:
  - "3.3.1.  Context Transfer\n   Security context transfer involves transfer of reusable\
    \ key context\n   to the TAP and can take two forms: horizontal and vertical.\n\
    \   Horizontal security context transfer (e.g., from SAP to TAP) is not\n   recommended\
    \ because of the possibility that the compromise of one\n   attachment point might\
    \ lead to the compromise of another (the\n   so-called domino effect, [RFC4962]).\
    \  Vertical context transfer is\n   similar to the initial establishment of keying\
    \ material on an\n   attachment point in that the keys are sent from a trusted\
    \ server to\n   the TAP as a direct result of a successful authentication.  ERP\n\
    \   specifies vertical context transfer using existing EAP keying\n   material\
    \ obtained from the home AAA server during the initial\n   authentication.  A\
    \ cryptographically independent re-authentication\n   key is derived and transmitted\
    \ to the TAP as a result of successful\n   ERP authentication.  This reduces handover\
    \ delay for intra-realm\n   handovers by eliminating the need to run full EAP\
    \ authentication with\n   the home EAP server.\n   However, in the case of inter-realm\
    \ handover, either ERP is not\n   applicable or an additional optimization mechanism\
    \ is needed to\n   establish a key on the TAP.\n"
- title: 3.3.2.  Early Authentication
  contents:
  - "3.3.2.  Early Authentication\n   In EAP early authentication, AAA-based authentication\
    \ and\n   authorization for a CAP is performed while ongoing data communication\n\
    \   is in progress via the serving access network, the goal being to\n   complete\
    \ AAA signaling for EAP before the mobile device moves.  The\n   applicability\
    \ of EAP early authentication is limited to the scenarios\n   where candidate\
    \ authenticators can be discovered and an accurate\n   prediction of movement\
    \ can be easily made.  In addition, the\n   effectiveness of EAP early authentication\
    \ may be less significant for\n   particular inter-technology-handover scenarios\
    \ where simultaneous use\n   of multiple technologies is not a major concern.\n\
    \   There are also several AAA issues related to EAP early\n   authentication,\
    \ discussed in Section 8.\n"
- title: 4.  System Overview
  contents:
  - "4.  System Overview\n   Figure 1 shows the functional elements that are related\
    \ to EAP early\n   authentication.  These functional elements include a mobile\
    \ device, a\n   SAP, a CAP, and one or more AAA and EAP servers; for the sake\
    \ of\n   convenience, the AAA and EAP servers are represented as being\n   co-located.\
    \  When the SAP and CAP belong to different AAA realms, the\n   CAP may require\
    \ a different set of user credentials than those used\n   by the peer when authenticating\
    \ to the SAP.  Alternatively, the CAP\n   and the SAP may rely on the same AAA\
    \ server, located in the home\n   realm of the mobile device (MD).\n         +------+\
    \      +-------+      +---------+      +---------+\n         |  MD  |------| \
    \ SAP  |------|         |      |         |\n         +------+      +-------+ \
    \     |   IP    |      | EAP/AAA\n            .                         |    \
    \     |------|         |\n            . Move                    | Network |  \
    \    | Server  |\n            v          +-------+      |         |      |   \
    \      |\n                       |  CAP  |------|         |      |         |\n\
    \                       +-------+      +---------+      +---------+\n        \
    \  Figure 1: EAP Early Authentication Functional Elements\n   A mobile device\
    \ is attached to the serving access network.  Before\n   the MD performs handover\
    \ from the serving access network to a\n   candidate access network, it performs\
    \ EAP early authentication with a\n   candidate authenticator via the serving\
    \ access network.  The peer may\n   perform EAP early authentication with one\
    \ or more candidate\n   authenticators.  It is assumed that each attachment point\
    \ has an IP\n   address.  It is assumed that there is at least one CAP in each\n\
    \   candidate access network.  The serving and candidate access networks\n   may\
    \ use different link-layer technologies.\n   Each authenticator is either a standalone\
    \ authenticator or a pass-\n   through authenticator [RFC3748].  When an authenticator\
    \ acts as a\n   standalone authenticator, it also has the functionality of an\
    \ EAP\n   server.  When an authenticator acts as a pass-through authenticator,\n\
    \   it communicates with the EAP server, typically using a AAA transport\n   protocol\
    \ such as RADIUS [RFC2865] or Diameter [RFC3588].\n   If the CAP uses an MSK [RFC5247]\
    \ for generating lower-layer ciphering\n   keys, EAP early authentication is used\
    \ to proactively generate an MSK\n   for the CAP.\n"
- title: 5.  Topological Classification of Handover Scenarios
  contents:
  - "5.  Topological Classification of Handover Scenarios\n   The complexity of the\
    \ authentication and authorization part of\n   handover depends on whether it\
    \ involves a change in EAP server.\n   Consider first the case where the authenticators\
    \ operate in pass-\n   through mode, so that the EAP server is co-located with\
    \ a AAA server.\n   Then, there is a strict hierarchy of complexity, as follows:\n\
    \   1.  inter-attachment-point handover with common AAA server: the CAP\n    \
    \   and SAP are different entities, but the AAA server is the same.\n       There\
    \ are two sub-cases here:\n       (a)  the AAA server is common because both attachment\
    \ points lie\n            within the same network, or\n       (b)  the AAA server\
    \ is common because AAA entities in the serving\n            and candidate networks\
    \ proxy to a AAA server in the home\n            realm.\n   2.  inter-AAA-realm\
    \ handover: the CAP and SAP are different entities,\n       and the respective\
    \ AAA servers also differ.  As a result,\n       authentication in the candidate\
    \ network requires a second set of\n       user credentials.\n   A third case\
    \ is where one or both authenticators are co-located with\n   an EAP server. \
    \ This has some of the characteristics of an inter-AAA-\n   realm handover, but\
    \ offers less flexibility for resolution of the\n   early authentication problem.\n\
    \   Orthogonally to this classification, one can distinguish intra-\n   technology\
    \ handover from inter-technology handover thinking of the\n   link technologies\
    \ involved.  In the inter-technology case, it is\n   highly probable that the\
    \ authenticators will differ.  The most likely\n   cases are 1(b) or 2 in the\
    \ above list.\n"
- title: 6.  Models of Early Authentication
  contents:
  - "6.  Models of Early Authentication\n   As noted in Section 3, there are cases\
    \ where early authentication is\n   applicable while ERP does not work.  This\
    \ section concentrates on\n   providing some models around which we can build\
    \ our analysis of the\n   EAP early authentication problem.  Different usage models\
    \ can be\n   defined depending on whether\n   o  the SAP is not involved in early\
    \ authentication (direct pre-\n      authentication usage model),\n   o  the SAP\
    \ interacts only with the CAP (indirect pre-authentication\n      usage model),\
    \ or\n   o  the SAP interacts with the AAA server (the authenticated\n      anticipatory\
    \ keying usage model).\n   It is assumed that the CAP and SAP are different entities.\
    \  It is\n   further assumed in describing these models that there is no direct\
    \ L2\n   connectivity between the peer and the candidate attachment point.\n"
- title: 6.1.  EAP Pre-Authentication Usage Models
  contents:
  - "6.1.  EAP Pre-Authentication Usage Models\n   In the EAP pre-authentication model,\
    \ the SAP does not interact with\n   the AAA server directly.  Depending on how\
    \ the SAP is involved in the\n   pre-authentication signaling, the EAP pre-authentication\
    \ usage model\n   can be further categorized into the following two sub-models,\
    \ direct\n   and indirect.\n"
- title: 6.1.1.  The Direct Pre-Authentication Model
  contents:
  - "6.1.1.  The Direct Pre-Authentication Model\n   In this model, the SAP is not\
    \ involved in the EAP exchange and only\n   forwards the EAP pre-authentication\
    \ traffic as it would any other\n   data traffic.  The direct pre-authentication\
    \ model is based on the\n   assumption that the MD can discover candidate authenticators\
    \ and\n   establish direct IP communication with them.  It is applicable to any\n\
    \   of the cases described in Section 5.\n           Mobile          Candidate\
    \ Attachment          AAA Server\n           Device              Point(CAP)\n\
    \       +-----------+    +-------------------------+    +------------+\n     \
    \  |           |    |        Candidate        |    |            |\n       |  \
    \ Peer    |    |      Authenticator      |    | EAP Server |\n       |       \
    \    |    |                         |    |            |\n       +-----------+\
    \    +-------------------------+    +------------+\n       | MD-CAP    |<-->|\
    \ MD-CAP    | | CAP-AAA   |<-->| CAP-AAA    |\n       | Signaling |    | Signaling\
    \ | | Signaling |    | Signaling  |\n       +-----------+    +-----------+ +-----------+\
    \    +------------+\n              Figure 2: Direct Pre-Authentication Usage Model\n\
    \   The direct pre-authentication signaling for the usage model is shown\n   in\
    \ Figure 3.\n    Mobile             Serving             Candidate            AAA/EAP\n\
    \    Device         Attachment Point      Authenticator          Server\n    \
    \                    (SAP)\n      |                   |                    | \
    \                  |\n      |                   |                    |       \
    \            |\n      |     EAP over MD-CAP Signaling (L3)     |    EAP over AAA\
    \   |\n      |<------------------+------------------->|<----------------->|\n\
    \      |                   |                    |                   |\n      |\
    \                   |                    |                   |\n     Figure 3:\
    \ Direct Pre-Authentication Signaling for the Usage Model\n"
- title: 6.1.2.  The Indirect Pre-Authentication Usage Model
  contents:
  - "6.1.2.  The Indirect Pre-Authentication Usage Model\n   The indirect pre-authentication\
    \ usage model is illustrated in\n   Figure 4.\n    Mobile Device      Serving\
    \              Candidate          AAA\n        (MD)       Attachment Point   \
    \  Attachment Point      Server\n                        (SAP)               \
    \  (CAP)\n    +----------+                         +----------------+   +--------+\n\
    \    |          |                         |                |   |        |\n  \
    \  | EAP Peer |                         |    Candidate   |   | EAP    |\n    |\
    \          |                         |  Authenticator |   | Server |\n    |  \
    \        |                         |                |   |        |\n    +----------+\
    \   +---------+-------+   +-------+--------+   +--------+\n    |  MD-SAP  |<->|\
    \ MD-SAP  |SAP-CAP|<->|SAP-CAP|CAP-AAA |<->|CAP-AAA |\n    +----------+   +---------+-------+\
    \   +-------+--------+   +--------+\n    {-----------------------------Signaling----------------------------}\n\
    \             Figure 4: Indirect Pre-Authentication Usage Model\n   In the indirect\
    \ pre-authentication model, it is assumed that a trust\n   relationship exists\
    \ between the serving network (or serving AAA\n   realm) and candidate network\
    \ (or candidate AAA realm).  The SAP is\n   involved in EAP pre-authentication\
    \ signaling.  This pre-\n   authentication model is needed if the peer cannot\
    \ discover the\n   candidate authenticators identity or if direct IP communication\n\
    \   between the MD and CAP is not possible due to security or network\n   topology\
    \ issues.\n   The role of the SAP in this pre-authentication model is to forward\n\
    \   EAP pre-authentication signaling between the mobile device and CAP;\n   the\
    \ role of the CAP is to forward EAP pre-authentication signaling\n   between the\
    \ peer (via the SAP) and EAP server and receive the\n   transported keying material.\n\
    \   The pre-authentication signaling for this model is shown in Figure 5.\n  \
    \  Mobile             Serving              Candidate            AAA/EAP\n    Device\
    \         Attachment Point     Attachment Point         Server\n             \
    \           (SAP)                (CAP)\n      |                   |          \
    \          |                   |\n      |     EAP over      |       EAP over \
    \    |   EAP over AAA    |\n      | MD-SAP Signaling  |  SAP-CAP Signaling | \
    \                  |\n      |    (L2 or L3)     |        (L3)        |       \
    \            |\n      |<----------------->|<------------------<|<----------------->|\n\
    \      |                   |                    |                   |\n      |\
    \                   |                    |                   |\n    Figure 5:\
    \ Indirect Pre-Authentication Signaling for the Usage Model\n   In this model,\
    \ the pre-authentication signaling path between a peer\n   and a candidate authenticator\
    \ consists of two segments: peer-to-SAP\n   signaling (over L2 or L3) and SAP-to-CAP\
    \ signaling over L3.\n"
- title: 6.2.  The Authenticated Anticipatory Keying Usage Model
  contents:
  - "6.2.  The Authenticated Anticipatory Keying Usage Model\n   In this model, it\
    \ is assumed that there is no trust relationship\n   between the SAP and the CAP,\
    \ and the SAP is required to interact with\n   the AAA server directly.  The authenticated\
    \ anticipatory keying usage\n   model is illustrated in Figure 6.\n     Mobile\
    \            Serving               AAA Server      Candidate\n     Device    \
    \    Attachment Point                          Attachment\n                  \
    \      (SAP)                                Point (CAP)\n   +---------+   +------------------+\
    \   +-----------------+  +--------+\n   |         |   |                  |   |\
    \                 |  |        |\n   |  Peer   |   |   Authenticator  |   |   EAP\
    \ Server    |  |  AAA   |\n   |         |   |                  |   |         \
    \        |  | Client |\n   +---------+   +------------------+   +-----------------+\
    \  +--------+\n   |  MD-SA  |<->|  MD-SAP |SAP-AAA |<->|SAP-AAA |CAP-AAA |<>|CAP-AAA\
    \ |\n   +---------+   +------------------+   +--------+--------+  +--------+\n\
    \   {------------------------------Signaling---------------------------}\n   \
    \       Figure 6: Authenticated Anticipatory Keying Usage Model\n   The SAP is\
    \ involved in EAP authenticated anticipatory keying\n   signaling.\n   The role\
    \ of the serving attachment point in this usage model is to\n   communicate with\
    \ the peer on one side and exchange authenticated\n   anticipatory keying signaling\
    \ with the EAP server on the other side.\n   The role of the candidate authenticator\
    \ is to receive the transported\n   keying materials from the EAP server and to\
    \ act as the serving\n   attachment point after handover occurs.  The MD-SAP signaling\
    \ is\n   performed over L2 or L3; the SAP-AAA and AAA-CAP segments operate\n \
    \  over L3.\n"
- title: 7.  Architectural Considerations
  contents:
  - "7.  Architectural Considerations\n   There are two architectural issues relating\
    \ to early authentication:\n   authenticator discovery and context binding.\n"
- title: 7.1.  Authenticator Discovery
  contents:
  - "7.1.  Authenticator Discovery\n   In general, early authentication requires the\
    \ identity of a candidate\n   attachment point to be discovered by a peer, by\
    \ a serving attachment\n   point, or by some other entity prior to handover. \
    \ An attachment\n   point discovery protocol is typically defined as a separate\
    \ protocol\n   from an early authentication protocol.  For example, the IEEE 802.21\n\
    \   Information Service (IS) [IEEE.802-21] provides a link-layer-\n   independent\
    \ mechanism for obtaining neighboring network information\n   by defining a set\
    \ of Information Elements (IEs), where one of the IEs\n   is defined to contain\
    \ an IP address of an attachment point.  IEEE\n   802.21 IS queries for such an\
    \ IE may be used as a method for\n   authenticator discovery.\n   If IEEE 802.21\
    \ IS or a similar mechanism is used, authenticator\n   discovery requires a database\
    \ of information regarding the target\n   network; the provisioning of a server\
    \ with such a database is another\n   issue.\n"
- title: 7.2.  Context Binding
  contents:
  - "7.2.  Context Binding\n   When a candidate authenticator uses different EAP transport\
    \ protocols\n   for normal authentication and early authentication, a mechanism\
    \ is\n   needed to bind link-layer-independent context carried over early\n  \
    \ authentication signaling to the link-layer-specific context of the\n   link\
    \ to be established between the peer and the candidate\n   authenticator.  The\
    \ link-layer-independent context includes the\n   identities of the peer and authenticator\
    \ as well as the MSK.  The\n   link-layer-specific context includes link-layer\
    \ addresses of the peer\n   and the candidate authenticator.  Such context binding\
    \ can happen\n   before or after the peer changes its point of attachment.\n \
    \  There are at least two possible approaches to address the context\n   binding\
    \ issue.  The first approach is based on communicating the\n   link-layer context\
    \ as opaque data via early authentication signaling.\n   The second approach is\
    \ based on running EAP over the link layer of\n   the candidate authenticator\
    \ after the peer arrives at the\n   authenticator, using short-term credentials\
    \ generated via early\n   authentication.  In this case, the short-term credentials\
    \ are shared\n   between the peer and the candidate authenticator.  In both\n\
    \   approaches, context binding needs to be securely made between the\n   peer\
    \ and the candidate authenticator.  Also, the peer is not fully\n   authorized\
    \ by the candidate authenticator until the peer completes\n   the link-layer-specific\
    \ secure association procedure with the\n   authenticator using link-layer signaling.\n"
- title: 8.  AAA Issues
  contents:
  - "8.  AAA Issues\n   Most of the AAA documents today do not distinguish between\
    \ a normal\n   authentication and an early authentication, and this creates a\
    \ set of\n   open issues:\n   Early authentication authorization\n      Users\
    \ may not be allowed to have more than one logon session at\n      the time. \
    \ This means that while such users actively engage in a\n      session (as a result\
    \ of a previously valid authentication), they\n      will not be able to perform\
    \ early authentication.  The AAA server\n      currently has no way of distinguishing\
    \ between a normal\n      authentication request and an early authentication request.\n\
    \   Early authentication lifetime\n      Currently, AAA protocols define attributes\
    \ carrying lifetime\n      information for a normal authentication session.  Even\
    \ when a user\n      profile and the AAA server support early authentication,\
    \ the\n      lifetime for an early authentication session is typically valid\n\
    \      only for a short amount of time because the peer has not completed\n  \
    \    its authentication at the target link layer.  It is currently not\n     \
    \ possible for a AAA server to indicate to the AAA client or a peer\n      the\
    \ lifetime of the early authenticated session unless AAA\n      protocols are\
    \ extended to carry early authentication session\n      lifetime information.\
    \  In other words, it is not clear to the peer\n      or the authenticator when\
    \ the early authentication session will\n      expire.\n   Early authentication\
    \ retries\n      It is typically expected that, shortly following the early\n\
    \      authentication process, the peer moves to the new point of\n      attachment\
    \ and converts the early authentication state to a normal\n      authentication\
    \ state (the procedure for which is not the topic of\n      this particular subsection).\
    \  However, if the peer has not yet\n      moved to the new location and realizes\
    \ that the early\n      authentication session is expiring, it may perform another\
    \ early\n      authentication.  Some limiting mechanism is needed to avoid an\n\
    \      unlimited number of early authentication attempts.\n   Completion of network\
    \ attachment\n      Once the peer has successfully attached to the new point of\n\
    \      attachment, it needs to convert its authentication state from\n      early\
    \ authenticated to fully attached and authorized.  If the AAA\n      server needs\
    \ to differentiate between early authentication and\n      normal authentication,\
    \ there may need to be a mechanism within the\n      AAA protocol to provide this\
    \ indication to the AAA server.  This\n      may be important from a billing perspective\
    \ if the billing policy\n      does not charge for an early authenticated peer\
    \ until the peer is\n      fully attached to the target authenticator.\n   Session\
    \ resumption\n      In the case where the peer cycles between a network N1 with\
    \ which\n      it has fully authenticated and another network N2 and then back\
    \ to\n      N1, it should be possible to simply convert the fully\n      authenticated\
    \ state on N1 to an early authenticated state.  The\n      problems around handling\
    \ session lifetime and keying material\n      caching need to be dealt with.\n\
    \   Multiple candidate attachment points\n      There may be situations where\
    \ the peer needs to choose from a\n      number of CAPs.  In such cases, it is\
    \ desirable for the peer to\n      perform early authentication with multiple\
    \ candidate\n      authenticators.  This amplifies the difficulties noted under\
    \ the\n      point \"Early authentication authorization\".\n   Inter-AAA-realm\
    \ handover support\n      There may be situations where the peer moves out of\
    \ the home AAA\n      realm or across different visited AAA realms.  In such cases,\
    \ the\n      early authentication should be performed through the visited AAA\n\
    \      realm with the AAA server in the home AAA realm.  It also requires\n  \
    \    AAA in the visited realm to acquire the identity information of\n      the\
    \ home AAA realms for routing the EAP early authentication\n      traffic.  Knowledge\
    \ of realm identities is required by both the\n      peer and AAA to generate\
    \ the early authentication key for mutual\n      authentication between the peer\
    \ and the visited AAA server.\n   Inter-technology support\n      Current specifications\
    \ on early authentication mostly deal with\n      homogeneous 802.11 networks.\
    \  AAA attributes such as Calling-\n      Station-ID [RADEXT-WLAN] may need to\
    \ be expanded to cover other\n      access technologies.  Furthermore, inter-technology\
    \ handovers may\n      require a change of the peer identifier as part of the\
    \ handover.\n      Investigation on the best type of identifiers for peers that\n\
    \      support multiple access technologies is required.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   This section specifically covers threats introduced\
    \ to the EAP model\n   by early authentication.  Security issues on general EAP\
    \ and handover\n   are described in other documents such as [RFC3748], [RFC4962],\n\
    \   [RFC5169], and [RFC5247].\n   Since early authentication, as described in\
    \ this document, needs to\n   work across multiple attachment points, any solution\
    \ needs to\n   consider the following security threats.\n   First, a resource\
    \ consumption denial-of-service attack is possible,\n   where an attacker that\
    \ is not on the same IP link as the legitimate\n   peer or the candidate authenticator\
    \ may send unprotected early\n   authentication messages to the legitimate peer\
    \ or the candidate\n   authenticator.  As a result, the latter may spend computational\
    \ and\n   bandwidth resources on processing early authentication messages sent\n\
    \   by the attacker.  This attack is possible in both the direct and\n   indirect\
    \ pre-authentication scenarios.  To mitigate this attack, the\n   candidate network\
    \ or authenticator may apply non-cryptographic packet\n   filtering so that only\
    \ early authentication messages received from a\n   specific set of serving networks\
    \ or authenticators are processed.  In\n   addition, a simple solution for the\
    \ peer side would be to let the\n   peer always initiate EAP early authentication\
    \ and not allow EAP early\n   authentication initiation from an authenticator.\n\
    \   Second, consideration for the channel binding problem described in\n   [RFC5247]\
    \ is needed as lack of channel binding may enable an\n   authenticator to impersonate\
    \ another authenticator or communicate\n   incorrect information via out-of-band\
    \ mechanisms (such as via a AAA\n   or lower-layer protocol) [RFC3748].  It should\
    \ be noted that it is\n   relatively easier to launch such an impersonation attack\
    \ for early\n   authentication than normal authentication because an attacker\
    \ does\n   not need to be physically on the same link as the legitimate peer to\n\
    \   send an early authentication trigger to the peer.\n"
- title: 10.  Acknowledgments
  contents:
  - "10.  Acknowledgments\n   The editors would like to thank Preetida Vinayakray,\
    \ Shubhranshu\n   Singh, Ajay Rajkumar, Rafa Marin Lopez, Jong-Hyouk Lee, Maryna\n\
    \   Komarova, Katrin Hoeper, Subir Das, Charles Clancy, Jari Arkko, and\n   Bernard\
    \ Aboba for their valuable input.\n"
- title: 11.  Contributors
  contents:
  - "11.  Contributors\n   The following people all contributed to this document:\
    \ Alper E.\n   Yegin, Tom Taylor, Srinivas Sreemanthula, Madjid Nakhjiri, Mahalingam\n\
    \   Mani, and Ashutosh Dutta.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht,\
    \ J., Carlson, J., and H.\n              Levkowetz, \"Extensible Authentication\
    \ Protocol (EAP)\",\n              RFC 3748, June 2004.\n   [RFC4962]  Housley,\
    \ R. and B. Aboba, \"Guidance for Authentication,\n              Authorization,\
    \ and Accounting (AAA) Key Management\",\n              BCP 132, RFC 4962, July\
    \ 2007.\n   [RFC5247]  Aboba, B., Simon, D., and P. Eronen, \"Extensible\n   \
    \           Authentication Protocol (EAP) Key Management Framework\",\n      \
    \        RFC 5247, August 2008.\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [RFC2865]  Rigney, C., Willens, S., Rubens,\
    \ A., and W.  Simpson,\n              \"Remote Authentication Dial In User Service\
    \ (RADIUS)\",\n              RFC 2865, June 2000.\n   [RFC3588]  Calhoun, P.,\
    \ Loughney, J., Guttman, E., Zorn, G., and J.\n              Arkko, \"Diameter\
    \ Base Protocol\", RFC 3588, September 2003.\n   [RFC5169]  Clancy, T., Nakhjiri,\
    \ M., Narayanan, V., and L.  Dondeti,\n              \"Handover Key Management\
    \ and Re- Authentication Problem\n              Statement\", RFC 5169, March 2008.\n\
    \   [RFC5296]  Narayanan, V. and L. Dondeti, \"EAP Extensions for EAP\n      \
    \        Re-authentication Protocol (ERP)\", RFC 5296, August 2008.\n   [RADEXT-WLAN]\n\
    \              Aboba, B., Malinen, J., Congdon, P., and J.  Salowey,\n       \
    \       \"RADIUS Attributes for IEEE 802 Networks\", Work\n              in Progress,\
    \ February 2010.\n   [RFC2989]  Aboba, B., Calhoun, P., Glass, S., Hiller, T.,\
    \ McCann, P.,\n              Shiino, H., Zorn, G., Dommety, G., C.Perkins, B.Patil,\n\
    \              D.Mitton, S.Manning, M.Beadles, P.Walsh, X.Chen,\n            \
    \  S.Sivalingham, A.Hameed, M.Munson, S.Jacobs, B.Lim,\n              B.Hirschman,\
    \ R.Hsu, Y.Xu, E.Campell, S.Baba, and E.Jaques,\n              \"Criteria for\
    \ Evaluating AAA Protocols for Network\n              Access\", RFC 2989, November\
    \ 2000.\n   [IEEE.802-1X.2004]\n              Institute of Electrical and Electronics\
    \ Engineers,\n              \"Port-Based Network Access Control\", IEEE Standard\
    \ 802.1X,\n              2004.\n   [IEEE.802-21]\n              Institute of Electrical\
    \ and Electronics Engineers,\n              \"Standard for Local and Metropolitan\
    \ Area Networks: Media\n              Independent Handover Services\", IEEE Standard\
    \ 802.21,\n              2008.\n   [IEEE.802-11.2007]\n              Institute\
    \ of Electrical and Electronics Engineers,\n              \"Information technology\
    \ - Telecommunications and\n              information exchange between systems\
    \ - Local and\n              metropolitan area networks - Specific requirements\
    \ - Part\n              11: Wireless LAN Medium Access Control (MAC) and Physical\n\
    \              Layer (PHY) specifications\", IEEE Standard 802.11, 2007.\n   [IEEE.802-11R.2008]\n\
    \              Institute of Electrical and Electronics Engineers,\n          \
    \    \"Information technology - Telecommunications and\n              information\
    \ exchange between systems - Local and\n              metropolitan area networks\
    \ - Specific requirements - Part\n              11: Wireless LAN Medium Access\
    \ Control (MAC) and Physical\n              Layer (PHY) specifications - Amendment\
    \ 2: Fast BSS\n              Transition\", IEEE Standard 802.11R, 2008.\n   [IEEE.802-11F.2003]\n\
    \              Institute of Electrical and Electronics Engineers, \"IEEE\n   \
    \           Trial-Use Recommended Practice for Multi-Vendor Access\n         \
    \     Point Interoperability via an Inter-Access Point Protocol\n            \
    \  Across Distribution Systems Supporting IEEE 802.11\n              Operation\"\
    , IEEE Recommendation 802.11F, 2003.\n   [TS33.402] 3GPP, \"System Architecture\
    \ Evolution (SAE): Security\n              aspects of non-3GPP accesses (Release\
    \ 8)\", 3GPP\n              TS33.402 V8.3.1, 2009.\n   [ITU]      ITU-T, \"General\
    \ Characteristics of International Telephone\n              Connections and International\
    \ Telephone Circuits: One-Way\n              Transmission Time\", ITU-T Recommendation\
    \ G.114, 1998.\n   [WPA]      The Wi-Fi Alliance, \"WPA (Wi-Fi Protected Access)\"\
    ,\n              Wi-Fi WPA v3.1, 2004.\n   [MQ7]      Lopez, R., Dutta, A., Ohba,\
    \ Y., Schulzrinne, H., and A.\n              Skarmeta, \"Network-layer Assisted\
    \ Mechanism to Optimize\n              Authentication Delay During Handoff in\
    \ 802.11 Networks\",\n              The 4th Annual International Conference on\
    \ Mobile and\n              Ubiquitous Systems: Computing, Networking and\n  \
    \            Services (MOBIQUITOUS 2007), 2007.\n   [WCM]      Dutta, A., Famorali,\
    \ D., Das, S., Ohba, Y., and R. Lopez,\n              \"Media-independent pre-authentication\
    \ supporting secure\n              interdomain handover optimization\", IEEE Wireless\n\
    \              Communications Volume 15, Issue 2, April 2008.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Yoshihiro Ohba\n   Toshiba Corporate Research and Development\
    \ Center\n   1 Komukai-Toshiba-cho\n   Saiwai-ku, Kawasaki, Kanagawa,   212-8582\n\
    \   Japan\n   Phone: +81 44 549 2230\n   EMail: yoshihiro.ohba@toshiba.co.jp\n\
    \   Qin Wu (editor)\n   Huawei Technologies Co., Ltd\n   Huawei Nanjing R&D Center,\
    \ Floor 1F, Software Avenue, No.101.,\n   Yuhua District\n   Nanjing, JiangSu\
    \  210012\n   China\n   Phone: +86 25 56622908\n   EMail: sunseawq@huawei.com\n\
    \   Glen Zorn (editor)\n   Network Zen\n   1463 East Republican Street\n   Seattle,\
    \ Washington  98112\n   USA\n   EMail: gwz@net-zen.net\n"
