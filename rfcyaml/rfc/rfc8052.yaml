- contents:
  - "             Group Domain of Interpretation (GDOI) Protocol\n                Support
    for IEC 62351 Security Services\n"
  title: __initial_text__
- contents:
  - "Abstract\n   The IEC 61850 power utility automation family of standards describes\n
    \  methods using Ethernet and IP for distributing control and data\n   frames
    within and between substations.  The IEC 61850-90-5 and IEC\n   62351-9 standards
    specify the use of the Group Domain of\n   Interpretation (GDOI) protocol (RFC
    6407) to distribute security\n   transforms for some IEC 61850 security protocols.
    \ This memo defines\n   GDOI payloads to support those security protocols.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    7841.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc8052.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2017 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .
    . . . . .   2\n     1.1.  Requirements Language . . . . . . . . . . . . . . .
    . . .   4\n     1.2.  Terminology . . . . . . . . . . . . . . . . . . . . . .
    .   4\n     1.3.  Acronyms  . . . . . . . . . . . . . . . . . . . . . . . .   4\n
    \  2.  IEC 61850 Protocol Information  . . . . . . . . . . . . . . .   5\n     2.1.
    \ ID Payload  . . . . . . . . . . . . . . . . . . . . . . .   5\n     2.2.  SA
    TEK Payload  . . . . . . . . . . . . . . . . . . . . .   6\n     2.3.  KD Payload
    \ . . . . . . . . . . . . . . . . . . . . . . .  11\n   3.  Security Considerations
    . . . . . . . . . . . . . . . . . . .  12\n   4.  IANA Considerations . . . .
    . . . . . . . . . . . . . . . . .  14\n   5.  References  . . . . . . . . . .
    . . . . . . . . . . . . . . .  16\n     5.1.  Normative References  . . . . .
    . . . . . . . . . . . . .  16\n     5.2.  Informative References  . . . . . .
    . . . . . . . . . . .  16\n   Appendix A.  Example ID, SA TEK, and KD Payloads
    for IEC 61850  .  19\n   Appendix B.  Implementation Considerations  . . . . .
    . . . . . .  23\n     B.1.  DER Length Fields . . . . . . . . . . . . . . . .
    . . . .  23\n     B.2.  Groups with Multiple Senders  . . . . . . . . . . . .
    . .  23\n   Appendix C.  Data Attribute Format  . . . . . . . . . . . . . . .
    \ 23\n   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  24\n
    \  Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  25\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   Power substations use Generic Object Oriented Substation
    Events\n   (GOOSE) protocol [IEC-61850-8-1] to distribute control information
    to\n   groups of devices using a multicast strategy.  Sources within the\n   power
    substations also distribute IEC 61850-9-2 sampled values data\n   streams [IEC-61850-9-2].
    \ The IEC 62351-9 standard [IEC-62351-9]\n   describes key management methods
    for the security methods protecting\n   these IEC 61850 messages, including methods
    of device authentication\n   and authorization, and methods of policy and keying
    material\n   agreement for IEC 61850 message encryption and data integrity\n   protection.
    \ These key management methods include the use of GDOI\n   [RFC6407] to distribute
    the security policy and session keying\n   material used to protect IEC 61850
    messages when the messages are\n   sent to a group of devices.\n   The protection
    of the messages is defined in IEC 62351-6\n   [IEC-62351-6], IEC 61850-8-1 [IEC-61850-8-1],
    and IEC 61850-9-2\n   [IEC-61850-9-2].  Protected IEC 61850 messages typically
    include the\n   output of a Message Authentication Code (MAC) and may also be\n
    \  encrypted using a symmetric cipher such as the Advanced Encryption\n   Standard
    (AES).\n   Section 5.5.2 of RFC 6407 specifies that the following information\n
    \  needs to be provided in order to fully define a new security\n   protocol:\n
    \  o  The Protocol-ID for the particular security protocol\n   o  The SPI Size\n
    \  o  The method of SPI generation\n   o  The transforms, attributes, and keys
    needed by the security\n      protocol\n   This document defines GDOI payloads
    to distribute policy and keying\n   material to protect IEC 61850 messages and
    defines the necessary\n   information to ensure interoperability between IEC 61850\n
    \  implementations.\n   This memo extends RFC 6407 in order to define extensions
    needed by\n   IEC 62351-9.  With the current IANA registry rules set up by RFC\n
    \  6407, this requires \"Standards Action\" [RFC5226] by the IETF; this\n   document
    satisfies that requirement.  As the relevant IEC\n   specifications are not available
    to the IETF community, it is not\n   possible for this RFC to fully describe the
    security considerations\n   that apply.  Therefore, implementers need to depend
    on the security\n   analysis within the IEC specifications.  As two different
    Standards\n   Development Organizations are involved here, and since group key\n
    \  management is inherently complex, it is possible that some security\n   issues
    have not been identified, so additional analysis of the\n   security of the combined
    set of specifications may be advisable.\n"
  - contents:
    - "1.1.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\",
      \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT
      RECOMMENDED\", \"MAY\", and\n   \"OPTIONAL\" in this document are to be interpreted
      as described in BCP\n   14 [RFC2119] [RFC8174]  when, and only when, they appear
      in all\n   capitals, as shown here.\n"
    title: 1.1.  Requirements Language
  - contents:
    - "1.2.  Terminology\n   The following key terms are used throughout this document:\n
      \  Generic Object Oriented Substation Events:  Power substation control\n         model
      defined as per IEC 61850.\n   IEC 61850 message:  A message in the IEC 61850
      family of protocols\n         carrying control or data frames between substation
      devices.\n"
    title: 1.2.  Terminology
  - contents:
    - "1.3.  Acronyms\n   The following acronyms are used throughout this document:\n
      \  AES     Advanced Encryption Standard\n   GCKS    Group Controller/Key Server\n
      \  GDOI    Group Domain of Interpretation\n   GM      Group Member\n   GOOSE
      \  Generic Object Oriented Substation Events\n   KD      Key Download\n   KEK
      \    Key Encryption Key\n   MAC     Message Authentication Code\n   SA      Security
      Association\n   SPI     Security Parameter Index\n   TEK     Traffic Encryption
      Key\n"
    title: 1.3.  Acronyms
  title: 1.  Introduction
- contents:
  - "2.  IEC 61850 Protocol Information\n   The following subsections describe the
    GDOI payload extensions that\n   are needed in order to distribute security policy
    and keying material\n   for the IEC 62351 Security Services.  The Identification
    (ID) Payload\n   is used to describe an IEC 62351 GDOI group.  The Security\n
    \  Association (SA) Traffic Encryption Key (TEK) payload is used to\n   describe
    the policy defined by a Group Controller/Key Server (GCKS)\n   for a particular
    IEC 62351 traffic selector.  No changes are required\n   to the Key Download (KD)
    Payload, but a mapping of IEC 62351 keys to\n   the KD payload key types is included.\n
    \  All multi-octet fields are in network byte order.\n"
  - contents:
    - "2.1.  ID Payload\n   The ID payload in a GDOI GROUPKEY-PULL exchange allows
      the Group\n   Member (GM) to declare the group it would like to join.  A group
      is\n   defined by an ID payload as defined in GDOI [RFC6407] and reproduced\n
      \  in Figure 1.\n      0                   1                   2                   3\n
      \     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ! Next Payload  !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !    ID Type    !      DOI-Specific ID Data = 0                 !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ~                       Identification Data                     ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \                Figure 1: RFC 6407 Identification Payload\n   An ID Type name
      of ID_OID (value 13) is defined in this memo to\n   specify an Object Identifier
      (OID) [ITU-T-X.683] encoded using\n   Distinguished Encoding Rules (DER) [ITU-T-X.690].
      \ Associated with\n   the OID may be an OID-Specific Payload DER encoded as
      further\n   defining the group.  Several OIDs are specified in [IEC-62351-9]
      for\n   use with IEC 61850.  Each OID represents a GOOSE or Sampled Value\n
      \  protocol, and in some cases IEC 61850 also specifies a particular\n   multicast
      destination address to be described in the OID-Specific\n   Payload field.  The
      format of the ID_OID Identification Data is\n   specified as shown in Figure
      2.\n      0                   1                   2                   3\n      0
      1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !  OID Length   !                       OID                     ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !  OID-Specific Payload Length  !     OID-Specific Payload      ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \                  Figure 2: ID_OID Identification Data\n   The ID_OID Identification
      Data fields are defined as follows:\n   o  OID Length (1 octet) -- Length of
      the OID field.\n   o  OID (variable) -- An ASN.1 ObjectIdentifier encoded using
      DER\n      [ITU-T-X.690].\n   o  OID-Specific Payload Length (2 octets) -- Length
      of the OID-\n      Specific payload.  Set to zero if the OID does not require
      an OID-\n      Specific payload.\n   o  OID-Specific Payload (variable) -- OID-specific
      selector encoded\n      in DER.  If OID-Specific Payload Length is set to zero,
      this field\n      does not appear in the ID payload.\n"
    title: 2.1.  ID Payload
  - contents:
    - "2.2.  SA TEK Payload\n   The SA TEK payload contains security attributes for
      a single set of\n   policy associated with a group TEK.  The type of policy
      to be used\n   with the TEK is described by a Protocol-ID field included in
      the SA\n   TEK.  As shown in Figure 3 reproduced from RFC 6407, each Protocol-ID\n
      \  describes a particular TEK Protocol-Specific Payload definition.\n      0
      \                  1                   2                   3\n      0 1 2 3
      4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ! Next Payload  !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ! Protocol-ID   !       TEK Protocol-Specific Payload           ~\n     +-+-+-+-+-+-+-+-+
      \                                              ~\n     ~                                                               ~\n
      \    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n                     Figure
      3: RFC 6407 SA TEK Payload\n   The Protocol-ID name of GDOI_PROTO_IEC_61850
      (value 3) is defined in\n   this memo for the purposes of distributing IEC 61850
      policy.  A\n   GDOI_PROTO_IEC_61850 SA TEK includes an OID and (optionally)
      an OID-\n   Specific payload that together define the selectors for the network\n
      \  traffic.  The selector fields are followed by security policy fields\n   indicating
      how the specified traffic is to be protected.  The\n   GDOI_PROTO_IEC_61850
      TEK Protocol-Specific Payload is defined as\n   shown in Figure 4.\n      0
      \                  1                   2                   3\n      0 1 2 3
      4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !  OID Length   !                       OID                     ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !  OID-Specific Payload Length  !     OID-Specific Payload      ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !                              SPI                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !           Auth Alg            !            Enc Alg            !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !                    Remaining Lifetime Value                   !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !                      SA Data Attributes                       ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \                   Figure 4: IEC 61850 SA TEK Payload\n   The GDOI_PROTO_IEC_61850
      SA TEK payload fields are defined as\n   follows:\n   o  OID Length (1 octet)
      -- Length of the OID field.\n   o  OID (variable) -- An ASN.1 ObjectIdentifier
      encoded using DER.\n      OIDs defined in IEC 61850 declare the type of IEC
      61850 message to\n      be protected, as defined by [IEC-62351-9].\n   o  OID-Specific
      Payload Length (2 octets) -- Length of the OID-\n      Specific payload.  This
      field is set to zero if the policy does\n      not include an OID-Specific payload.\n
      \  o  OID-Specific Payload (variable) -- The traffic selector (e.g.,\n      multicast
      address) specific to the OID encoded using DER.  Some\n      OID policy settings
      do not require the use of an OID-Specific\n      payload, in which case this
      field is not included in the TEK and\n      the OID-Specific Payload Length
      is set to zero.\n   o  SPI (4 octets) -- Identifier for the Current Key. This
      field\n      represents an SPI.\n   o  Auth Alg (2 octets) -- Authentication
      Algorithm ID.  Valid values\n      are defined in Section 2.2.2.\n   o  Enc
      Alg (2 octets) -- Confidentiality Algorithm ID.  Valid values\n      are defined
      in Section 2.2.3.\n   o  Remaining Lifetime value (4 octets) -- The number of
      seconds\n      remaining before this TEK expires.  A value of zero (0) shall\n
      \     indicate that the TEK does not have an expire time.\n   o  SA Data Attributes
      (variable length) -- Contains zero or more\n      attributes associated with
      this SA.  Section 2.2.4 defines\n      attributes.\n"
    - contents:
      - "2.2.1.  Selectors\n   The OID and (optionally) an OID-Specific payload together
        define the\n   selectors for the network traffic.  While they may match the
        OID and\n   OID-Specific payload that the GM had previously requested in the
        ID\n   payload, there is no guarantee that this will be the case.  Including\n
        \  selectors in the SA TEK is important for at least the following\n   reasons:\n
        \  o  The Key Server (KS) policy may direct the KS to return multiple\n      TEKs,
        each representing different traffic selectors, and it is\n      important
        that every GM receiving the set of TEKs explicitly\n      identify the traffic
        selectors associated with the TEK.\n   o  The KS policy may include the use
        of a GDOI GROUPKEY-PUSH message,\n      which distributes new or replacement
        TEKs to group members.  Since\n      the GROUPKEY-PUSH message does not contain
        an ID payload, the TEK\n      definition must include the traffic selectors.\n"
      title: 2.2.1.  Selectors
    - contents:
      - "2.2.2.  Authentication Algorithms\n   This memo defines the following authentication
        algorithms for use\n   with this TEK.  These algorithms are defined in [IEC-TR-61850-90-5],\n
        \  including requirements on one or more algorithms defined as mandatory\n
        \  to implement.\n   o  NONE.  Specifies that an authentication algorithm
        is not required,\n      or when the accompanying confidentiality algorithm
        includes\n      authentication (e.g., AES-GCM-128).  See Section 3 for cautionary\n
        \     notes regarding using this value without any confidentiality\n      algorithm.\n
        \  o  HMAC-SHA256-128.  Specifies the use of SHA-256 [FIPS180-4]\n      combined
        with HMAC [RFC2104].  The output is truncated to 128\n      bits, as per [RFC2104].
        \ The key size is the size of the hash\n      value produced by SHA-256 (256
        bits).\n   o  HMAC-SHA256.  Specifies the use of SHA-256 [FIPS180-4] combined\n
        \     with HMAC [RFC2104].  The key size is the size of the hash value\n      produced
        by SHA-256 (256 bits).\n   o  AES-GMAC-128.  Specifies the use of AES [FIPS197]
        in the Galois\n      Message Authentication Code (GMAC) mode [SP.800-38D]
        with a\n      128-bit key size.\n   o  AES-GMAC-256.  Specifies the use of
        AES [FIPS197] in the Galois\n      Message Authentication Code (GMAC) mode
        [SP.800-38D] with a\n      256-bit key size.\n"
      title: 2.2.2.  Authentication Algorithms
    - contents:
      - "2.2.3.  Confidentiality Algorithms\n   This memo defines the following confidentiality
        algorithms for use\n   with this TEK.  These algorithms are defined in [IEC-TR-61850-90-5],\n
        \  including requirements on one or more algorithms defined as mandatory\n
        \  to implement.\n   o  NONE.  Specifies that confidentiality is not required.
        \ Note: See\n      Section 3 for guidance on cautionary notes regarding using
        this\n      value.\n   o  AES-CBC-128.  Specifies the use of AES [FIPS197]
        in the Cipher\n      Block Chaining (CBC) mode [SP.800-38A] with a 128-bit
        key size.\n      This encryption algorithm does not provide authentication
        and MUST\n      NOT be used with the NONE authentication algorithm.\n   o
        \ AES-CBC-256.  Specifies the use of AES [FIPS197] in the Cipher\n      Block
        Chaining (CBC) mode [SP.800-38A] with a 256-bit key size.\n      This encryption
        algorithm does not provide authentication and MUST\n      NOT be used with
        the NONE authentication algorithm.\n   o  AES-GCM-128.  Specifies the use
        of AES [FIPS197] in the Galois/\n      Counter Mode (GCM) mode [SP.800-38D]
        with a 128-bit key size.\n      This encryption algorithm provides authentication
        and is used with\n      a NONE authentication algorithm.\n   o  AES-GCM-256.
        \ Specifies the use of AES [FIPS197] in the Galois/\n      Counter Mode (GCM)
        mode [SP.800-38D] with a 256-bit key size.\n      This encryption algorithm
        provides authentication and is used with\n      a NONE authentication algorithm.\n"
      title: 2.2.3.  Confidentiality Algorithms
    - contents:
      - "2.2.4.  SA Attributes\n   The following attributes may be present in an SA
        TEK.  The attributes\n   must follow the format described in Appendix C).\n"
      - contents:
        - "2.2.4.1.  SA Time Activation Delay (SA_ATD)\n   A GCKS will sometimes distribute
          an SA TEK in advance of when it is\n   expected to be used.  This is communicated
          to group members using the\n   SA Activation Time Delay (SA_ATD) attribute.
          \ When a GM receives an\n   SA_TEK with this attribute, it waits for the
          number of seconds\n   contained within the attribute before installing it
          for either\n   transmitting or receiving.\n   This Activation Time Delay
          attribute applies only this SA, and MAY be\n   used in either a GROUPKEY-PULL
          or GROUPKEY-PUSH exchange.  RFC 6407\n   also describes an ACTIVATION_TIME_DELAY
          attribute for the Group\n   Associated Policy (GAP) payload, which is applied
          to all Security\n   Associations and is restricted to use in a GROUPKEY-PUSH
          message.  If\n   both attributes are included in a GROUPKEY-PUSH payload,
          the value\n   contained in SA_ATD will be used.\n"
        title: 2.2.4.1.  SA Time Activation Delay (SA_ATD)
      - contents:
        - "2.2.4.2.  Key Delivery Assurance (SA_KDA)\n   Group policy can include
          notifying a multicast source (\"Publisher\")\n   of an indication of whether
          multicast receivers (\"Subscribers\") have\n   previously received the SA
          TEK.  This notification allows a Publisher\n   to set a policy as to whether
          to activate the new SA TEK or not based\n   on the percentage of Subscribers
          that are able to receive packets\n   protected by the SA TEK.  The attribute
          value is a number between 0\n   and 100 (inclusive).\n"
        title: 2.2.4.2.  Key Delivery Assurance (SA_KDA)
      title: 2.2.4.  SA Attributes
    - contents:
      - "2.2.5.  SPI Discussion\n   As noted in Section 1, RFC 6407 requires that
        characteristics of an\n   SPI must be defined.  An SPI in a GDOI_PROTO_IEC_61850
        SA TEK is\n   represented as a Key Identifier (KeyID).  The SPI size is 4
        octets.\n   The SPI is unilaterally chosen by the GCKS using any method chosen
        by\n   the implementation.  However, an implementation needs to take care\n
        \  not to duplicate an SPI value that is currently in use for a\n   particular
        group.\n"
      title: 2.2.5.  SPI Discussion
    title: 2.2.  SA TEK Payload
  - contents:
    - "2.3.  KD Payload\n   The KD payload contains group keys for the policy specified
      in the SA\n   Payload.  It is comprised of a set of Key Packets, each of which
      hold\n   the keying material associated with an SPI (i.e., an IEC 61850 Key\n
      \  Identifier).  The RFC 6407 KD payload format is reproduced in\n   Figure
      5.\n      0                   1                   2                   3\n      0
      1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ! Next Payload  !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ! Number of Key Packets         !            RESERVED2          !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ~                    Key Packets                                ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \                          Figure 5: KD Payload\n   Each Key Packet holds the
      keying material associated with a\n   particular IEC 61850 Key Identifier, although
      GDOI refers to it as an\n   SPI.  The keying material is described in a set
      of attributes\n   indicating an encryption key, integrity key, etc., in accordance
      with\n   the security policy of the group as defined by the associated SA\n
      \  Payload.  Each Key Packet has the following format, reproduced in\n   Figure
      6.\n      0                   1                   2                   3\n      0
      1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !   KD Type     !   RESERVED    !       Key Packet Length       !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    !    SPI Size   !                   SPI (variable)              ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \    ~                    Key Packet Attributes                      ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
      \                          Figure 6: Key Packet\n   No changes are needed to
      GDOI in order to distribute IEC 61850 keying\n   material, but the keys MUST
      be distributed as defined in Section 5.6\n   of RFC 6407.  The KD Type MUST
      be TEK (1).\n   A key associated with an IEC 61850 authentication algorithm\n
      \  (distributed in the Auth Alg field) MUST be distributed as a\n   TEK_INTEGRITY_KEY
      attribute.  The value of the attribute is\n   interpreted according to the type
      of key distributed in the SA TEK:\n   o  HMAC-SHA256-128, HMAC-SHA256.  The
      value is 32 octets.\n   o  AES-GMAC-128.  The value is 20 octets.  The first
      16 octets are\n      the 128-bit AES key, and the remaining four octets are
      used as the\n      salt value in the nonce.\n   o  AES-GMAC-256.  The value
      is 36 octets.  The first 32 octets are\n      the 256-bit AES key, and the remaining
      four octets are used as the\n      salt value in the nonce.\n   A key associated
      with an IEC 61850 confidentiality algorithm\n   (distributed in the Enc Alg
      SA TEK field) MUST be distributed as a\n   TEK_ALGORITHM_KEY attribute.  The
      value of the attribute is\n   interpreted according to the type of key distributed
      in the SA TEK:\n   o  AES-CBC-128.  The value is 16 octets.\n   o  AES-CBC-256.
      \ The value is 32 octets.\n   o  AES-GCM-128.  The value is 20 octets.  The
      first 16 octets are the\n      128-bit AES key, and the remaining four octets
      are used as the\n      salt value in the nonce.\n   o  AES-GCM-256.  The value
      is 36 octets.  The first 32 octets are the\n      256-bit AES key, and the remaining
      four octets are used as the\n      salt value in the nonce.\n"
    title: 2.3.  KD Payload
  title: 2.  IEC 61850 Protocol Information
- contents:
  - "3.  Security Considerations\n   GDOI is a Security Association (SA) management
    protocol for groups of\n   senders and receivers.  This protocol performs authentication
    of\n   communicating protocol participants (Group Member, Group Controller/\n
    \  Key Server).  GDOI provides confidentiality of key management\n   messages,
    and it provides source authentication of those messages.\n   GDOI includes defenses
    against man-in-middle, connection-hijacking,\n   replay, reflection, and denial-of-service
    (DOS) attacks on unsecured\n   networks.  GDOI assumes that the network is not
    secure and may be\n   under the complete control of an attacker.  The Security\n
    \  Considerations described in RFC 6407 are relevant to the distribution\n   of
    GOOSE and sampled values policy as defined in this memo.\n   Message Authentication
    is an optional property for IEC 62351 Security\n   Services; however, when encryption
    is used, authentication MUST also\n   be provided by using an authenticated encryption
    algorithm such as\n   AES-GCM-128 or by using a specific authentication algorithm
    such as\n   HMAC-SHA-256.  Setting the authentication algorithm to NONE but\n
    \  setting the confidentiality algorithm to an algorithm that does not\n   include
    authentication (i.e., is marked with an N in the\n   \"Authenticated Encryption\"
    column of the \"IEC 62351-9 Confidentiality\n   Values\" registry) is not safe
    and MUST NOT be done.\n   When Message Authentication is used, a common practice
    is to truncate\n   the output of a MAC and include some of the bits in the integrity\n
    \  protection field of the data security transform.  Current guidance in\n   [RFC2104]
    is to truncate no less than half of the length of the hash\n   output.  The authentication
    algorithm HMAC-SHA256-128 defined in this\n   memo truncates the output to exactly
    half of the output, which\n   follows this guidance.\n   Confidentiality is an
    optional security property for IEC 62351\n   Security Services.  Confidentiality
    Algorithm IDs SHOULD be included\n   in the IEC 61850 SA TEK payload if the IEC
    61850 messages are\n   expected to traverse public network links and are not protected
    by\n   another level of encryption (e.g., an encrypted Virtual Private\n   Network).
    \ Current cryptographic advice indicates that the use of\n   AES-CBC-128 for confidentiality
    is sufficient for the foreseeable\n   future [SP.800-131A], but some security
    policies may require the use\n   of AES-CBC-256.\n   IEC 62351 Security Services
    describe a variety of policy choices for\n   protecting network traffic, including
    the option of specifying no\n   protection at all.  This is enabled with the use
    of NONE as an\n   authentication algorithm and/or confidentiality algorithm.  The\n
    \  following guidance is given regarding the use of NONE.\n   o  Setting both
    the authentication algorithm and confidentiality\n      algorithm to NONE is possible
    but NOT RECOMMENDED.  Setting such a\n      policy is sometimes necessary during
    a migration period, when\n      traffic is being protected incrementally and some
    traffic has not\n      yet been scheduled for protection.  Alternatively, site
    security\n      policy for some packet flows requires inspection of packet data
    on\n      the private network followed by network-layer encryption before\n      delivery
    to a public network.\n   o  Setting the confidentiality algorithm to NONE but
    setting the\n      authentication algorithm to a MAC can be an acceptable policy
    in\n      the following conditions: the disclosed information in the data\n      packets
    is comprised of raw data values and the disclosure of the\n      data files is
    believed to be of no more value to an observer than\n      traffic analysis on
    the frequency and size of packets protected\n      for confidentiality.  Alternatively,
    site security policy for some\n      packet flows requires inspection of packet
    data on the private\n      network followed by network-layer encryption before
    delivery to a\n      public network.\n   o  Setting the authentication algorithm
    to NONE but setting the\n      confidentiality algorithm to an algorithm that
    does not include\n      authentication is not safe and MUST NOT be done.\n"
  title: 3.  Security Considerations
- contents:
  - "4.  IANA Considerations\n   The \"Group Domain of Interpretation (GDOI) Payloads\"
    registry\n   [GDOI-REG] has been updated as described below.  The terms \"Expert\n
    \  Review\", \"Reserved\", and \"Private Use\" are used as defined in\n   [RFC5226].\n
    \  o  GDOI_PROTO_IEC_61850 (value 3) has been added to the \"SA TEK\n      Payload
    Values - Protocol-ID\" registry.\n   o  A new \"IEC 62351-9 Authentication Values\"
    registry has been\n      created.  This registry defines Auth Alg values.  Initial
    values\n      for the registry are given below; future assignments are to be\n
    \     made through \"Expert Review\" [RFC5226].\n      Name                         Value\n
    \     ----                         -----\n      Reserved                       0\n
    \     NONE                           1\n      HMAC-SHA256-128                2\n
    \     HMAC-SHA256                    3\n      AES-GMAC-128                   4\n
    \     AES-GMAC-256                   5\n      Unassigned                  6-61439\n
    \     Reserved for Private Use  61440-65535\n   o  A new \"IEC 62351-9 Confidentiality
    Values\" registry has been\n      created.  This registry defines Enc Alg values.
    \ Initial values\n      for the registry are given below; future assignments are
    to be\n      made through \"Expert Review\" [RFC5226].\n      Name                         Value
    \    Authenticated Encryption\n      ----                         -----     ------------------------\n
    \     Reserved                       0\n      NONE                           1\n
    \     AES-CBC-128                    2                 N\n      AES-CBC-256                    3
    \                N\n      AES-GCM-128                    4                 Y\n
    \     AES-GCM-256                    5                 Y\n      Unassigned                  6-61439\n
    \     Reserved for Private Use  61440-65535\n   o  A new \"GDOI SA TEK Attributes\"
    registry has been created.  This\n      registry defines SA TEK attributes.  Initial
    values for the\n      registry are given below; future assignments are to be made\n
    \     through \"Expert Review\" [RFC5226].  In the table, attributes that\n      are
    defined as Type/Value (TV) are marked as Basic (B); attributes\n      that are
    defined as Type/Length/Value (TLV) are marked as Variable\n      (V).\n      Attribute
    \                   Value           Type\n      ---------                    -----
    \          ----\n      Reserved                       0\n      SA_ATD                         1
    \              V\n      SA_KDA                         2               B\n      Unassigned
    \                 3-28671\n      Reserved for Private Use   28672-32767\n   o
    \ A new \"ID Types\" registry has been created for the Identification\n      Payload
    when the DOI is GDOI.  This registry is taken from the\n      \"IPSEC Identification
    Type\" registry for the IPsec DOI\n      [IPSEC-DOI-REG].  Values 1-12 are defined
    identically to the\n      equivalent values in the \"IPSEC Identification Type\"
    registry.\n      Value 13 (ID_OID) is defined in this memo.  Initial values for
    the\n      registry are given below; future assignments are to be made\n      through
    \"Expert Review\" [RFC5226].\n      Name                          Value\n      ----
    \                         -----\n      Reserved                        0\n      ID_IPV4_ADDR
    \                   1\n      ID_FQDN                         2\n      ID_USER_FQDN
    \                   3\n      ID_IPV4_ADDR_SUBNET             4\n      ID_IPV6_ADDR
    \                   5\n      ID_IPV6_ADDR_SUBNET             6\n      ID_IPV4_ADDR_RANGE
    \             7\n      ID_IPV6_ADDR_RANGE              8\n      ID_DER_ASN1_DN
    \                 9\n      ID_DER_ASN1_GN                  10\n      ID_KEY_ID
    \                      11\n      ID_LIST                         12\n      ID_OID
    \                         13\n      Unassigned                   14-61439\n      Reserved
    for Private Use   61440-65535\n"
  title: 4.  IANA Considerations
- contents:
  - '5.  References

    '
  - contents:
    - "5.1.  Normative References\n   [IEC-62351-9]\n              International Electrotechnical
      Commission, \"Power systems\n              management and associated information
      exchange - Data and\n              communications security - Part 9: Cyber security
      key\n              management for power system equipment\", IEC 62351-9:2017,\n
      \             May 2017.\n   [RFC2119]  Bradner, S., \"Key words for use in RFCs
      to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n              DOI
      10.17487/RFC2119, March 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n
      \  [RFC5226]  Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n              IANA
      Considerations Section in RFCs\", BCP 26, RFC 5226,\n              DOI 10.17487/RFC5226,
      May 2008,\n              <http://www.rfc-editor.org/info/rfc5226>.\n   [RFC6407]
      \ Weis, B., Rowles, S., and T. Hardjono, \"The Group Domain\n              of
      Interpretation\", RFC 6407, DOI 10.17487/RFC6407,\n              October 2011,
      <http://www.rfc-editor.org/info/rfc6407>.\n   [RFC8174]  Leiba, B., \"Ambiguity
      of Uppercase vs Lowercase in RFC\n              2119 Key Words\", BCP 14, RFC
      8174, DOI 10.17487/RFC8174,\n              May 2017, <http://www.rfc-editor.org/info/rfc8174>.\n"
    title: 5.1.  Normative References
  - contents:
    - "5.2.  Informative References\n   [FIPS180-4]\n              National Institute
      of Standards and Technology, \"Secure\n              Hash Standard\", FIPS PUB
      180-4,\n              DOI 10.6028/NIST.FIPS.180-4, August 2015,\n              <http://nvlpubs.nist.gov/nistpubs/FIPS/\n
      \             NIST.FIPS.180-4.pdf>.\n   [FIPS197]  National Institute of Standards
      and Technology, \"Advanced\n              Encryption Standard (AES)\", FIPS
      PUB 197, November 2001,\n              <http://csrc.nist.gov/publications/fips/fips197/\n
      \             fips-197.pdf>.\n   [GDOI-REG]\n              IANA, \"Group Domain
      of Interpretation (GDOI) Payloads\",\n              <http://www.iana.org/assignments/gdoi-payloads>.\n
      \  [IEC-61850-8-1]\n              International Electrotechnical Commission,
      \"Communication\n              networks and systems for power utility automation
      - Part\n              8-1: Specific communication service mapping (SCSM) -\n
      \             Mappings to MMS (ISO 9506-1 and ISO 9506-2) and to ISO/IEC\n              8802-3\",
      IEC 61850-8-1, June 2011.\n   [IEC-61850-9-2]\n              International Electrotechnical
      Commission, \"Communication\n              networks and systems for power utility
      automation - Part\n              9-2: Specific communication service mapping
      (SCSM) -\n              Sampled values over ISO/IEC 8802-3\", IEC 61850-2,\n
      \             September 2011.\n   [IEC-62351-6]\n              International
      Electrotechnical Commission, \"Power systems\n              management and associated
      information exchange - Data and\n              communications security - Part
      6: Security for IEC 61850\",\n              IEC 62351-6, June 2007.\n   [IEC-TR-61850-90-5]\n
      \             International Electrotechnical Commission, \"Communication\n              networks
      and systems for power utility automation - Part\n              90-5: Use of
      IEC 61850 to transmit synchrophasor\n              information according to
      IEEE C37.118\", IEC TR 62351-90-5,\n              May 2012.\n   [IPSEC-DOI-REG]\n
      \             IANA, \"'Magic Numbers' for ISAKMP Protocol\",\n              <http://www.iana.org/assignments/isakmp-registry>.\n
      \  [ITU-T-X.683]\n              International Telecommunications Union, \"Information\n
      \             technology - Abstract Syntax Notation One (ASN.1):\n              Parameterization
      of ASN.1 specifications\",\n              ITU-T Recommendation X.683, August
      2015,\n              <https://www.itu.int/rec/T-REC-X.683-201508-I/en>.\n   [ITU-T-X.690]\n
      \             International Telecommunications Union, \"Information\n              technology
      - ASN.1 encoding rules: Specification of Basic\n              Encoding Rules
      (BER), Canonical Encoding Rules (CER) and\n              Distinguished Encoding
      Rules (DER)\", ITU-T Recommendation\n              X.690, August 2015,\n              <https://www.itu.int/rec/T-REC-X.690-201508-I/en>.\n
      \  [RFC2104]  Krawczyk, H., Bellare, M., and R. Canetti, \"HMAC: Keyed-\n              Hashing
      for Message Authentication\", RFC 2104,\n              DOI 10.17487/RFC2104,
      February 1997,\n              <http://www.rfc-editor.org/info/rfc2104>.\n   [SP.800-131A]\n
      \             Barker, E. and A. Roginsky, \"Transitions: Recommendation\n              for
      Transitioning the Use of Cryptographic Algorithms and\n              Key Lengths\",
      NIST Special Publication 800-131A,\n              DOI 10.6028/NIST.SP.800-131Ar1,
      November 2015,\n              <http://nvlpubs.nist.gov/nistpubs/SpecialPublications/\n
      \             NIST.SP.800-131Ar1.pdf>.\n   [SP.800-38A]\n              Dworkin,
      M., \"Recommendation for Block Cipher Modes of\n              Operation: Methods
      and Techniques\", NIST Special\n              Publication 800-38A, DOI 10.6028/NIST.SP.800-38A,
      December\n              2001, <http://nvlpubs.nist.gov/nistpubs/Legacy/SP/\n
      \             nistspecialpublication800-38a.pdf>.\n   [SP.800-38D]\n              Dworkin,
      M., \"Recommendation for Block Cipher Modes of\n              Operation: Galois/Counter
      Mode (GCM) and GMAC\", NIST\n              Special Publication 800-38D, DOI
      10.6028/NIST.SP.800-38D,\n              November 2007,\n              <http://nvlpubs.nist.gov/nistpubs/Legacy/SP/\n
      \             nistspecialpublication800-38d.pdf>.\n"
    title: 5.2.  Informative References
  title: 5.  References
- contents:
  - "Appendix A.  Example ID, SA TEK, and KD Payloads for IEC 61850\n   An Intelligent
    Electronic Device (IED) begins a GROUPKEY-PULL\n   exchange and requests keys
    and security policy for\n   61850_UDP_ADDR_GOOSE (OID = 1.2.840.10070.61850.8.1.2
    as defined in\n   [IEC-61850-9-2]) and IP multicast address 233.252.0.1 encoded
    as\n   specified in [IEC-61850-9-2].\n   OID and OID-Specific Payload protocol
    fields are variable-length\n   fields.  To improve readability, their representations
    in Figures 7\n   and 8 are \"compressed\", as indicated by a trailing \"~\" for
    these\n   fields.  Implementations should be aware that because these fields\n
    \  are variably sized, some payload fields may not be conveniently\n   aligned
    on an even octet.\n   Note: The actual DER for the OID-Specific Payload field
    is defined in\n   [IEC-62351-6].\n      0                   1                   2
    \                  3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
    5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! Next Payload  !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! ID Type=13    !     DOI-Specific ID Data = 0                  !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! OID Len=13    ! OID=<06 0B 2A 86 48 CE 56 83 E3 1A 08 01 02>  ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! OID-Specific Payload Len      ! OID SP=<DER for 233.252.0.1>  ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \                 Figure 7: Sample Identification Payload\n   The Key Server responds
    with the following SA TEK payload including\n   two GDOI_PROTO_IEC_61850 Protocol-Specific
    TEK payloads in the second\n   GROUPKEY-PULL message.  The first one is to be
    activated immediately\n   and has a lifetime of 3600 seconds (0x0E10) remaining.
    \ The second\n   has a lifetime of 12 hours (0xA8C0) and should be activated in
    3300\n   seconds (0x0CE4), which gives a 5-minute (300-second) overlap of the\n
    \  two SAs.\n      0                   1                   2                   3\n
    \     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! Next Payload  !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                             DOI = 2                           !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                         Situation = 0                         !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! SA Attr NP=16 (SA TEK)        !          RESERVED2            !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! NP=16 (SA TEK)!   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! Prot-ID=3     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! OID Len=13    ! OID=<06 0B 2A 86 48 CE 56 83 E3 1A 08 01 02>  ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! OID-Specific Payload Len      !OID SP=<DER for 233.252.0.1>   ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                            SPI=1                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !  AuthAlg=1 (HMAC-SHA256-128)  !    EncAlg=2  (AES-CBC-128)    !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !              Remaining Lifetime=0x0E01                        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! SA Attr NP=16 (SA TEK)        !          RESERVED2            !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! NP=0          !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! Prot-ID=3     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! OID Len=13    ! OID=<06 0B 2A 86 48 CE 56 83 E3 1A 08 01 02>  ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! OID-Specific Payload Len      !OID SP=<DER for 233.252.0.1>   ~\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                            SPI=2                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !       AuthAlg=0 (NONE)        !    EncAlg=4 (AES-GCM-128)     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !              Remaining Lifetime=0xA8C0                        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !       Type=1 (SA_ATD)         !           Length=4            !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                        Value=0x0CE4                           !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \                  Figure 8: Sample IEC 61850 SA Payload\n   The IED acknowledges
    that it is capable and willing to use this\n   policy in the third GROUPKEY-PULL
    message.  In response, the KS sends\n   a KD payload to the requesting IED.  This
    concludes the GROUPKEY-PULL\n   exchange.\n      0                   1                   2
    \                  3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4
    5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! Next Payload  !   RESERVED    !         Payload Length        !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! Number of Key Packets=2       !            RESERVED2          !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !   KD Type=1   !   RESERVED    !        Key Packet Length      !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !   SPI Size=4  !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                            SPI=1                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! TYPE=TEK_INTEGRITY_KEY (2)    ! LENGTH=32 (256-bit key)       !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                                                               !\n     !
    \                                                              !\n     !                                                               !\n
    \    !                        HMAC-SHA256 Key                        !\n     !
    \                                                              !\n     !                                                               !\n
    \    !                                                               !\n     !
    \                                                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! TYPE=TEK_ALGORITHM_KEY (1)    ! LENGTH=16                     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                                                               !\n     !
    \                       AES-CBC-128 Key                        !\n     !                                                               !\n
    \    !                                                               !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !   KD Type=1   !   RESERVED    !        Key Packet Length      !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !   SPI Size=4  !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                            SPI=2                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    ! TYPE=TEK_ALGORITHM_KEY (1)    ! LENGTH=20                     !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \    !                                                               !\n     !
    \                   AES-GCM-128 Key & Salt                     !\n     !                                                               !\n
    \    !                                                               !\n     !
    \                                                              !\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-!\n
    \                       Figure 9: Sample KD Payload\n"
  title: Appendix A.  Example ID, SA TEK, and KD Payloads for IEC 61850
- contents:
  - "Appendix B.  Implementation Considerations\n   Several topics have been suggested
    as useful for implementers.\n"
  - contents:
    - "B.1.  DER Length Fields\n   The ID and SA TEK payloads defined in this memo
      include explicit\n   lengths for fields formatted as DER.  This includes the
      OID Length\n   and OID-Specific Payload Length fields shown in Figures 2 and
      4.\n   Strictly speaking, these lengths are redundant since the length of\n
      \  the DER value is also encoded within the DER fields.  It would be\n   possible
      to determine the lengths of the fields from those encoded\n   values.  However,
      many implementations will find the explicit length\n   fields convenient when
      constructing and sanity checking the GDOI\n   messages including these payloads.
      \ Implementations will thus be\n   spared from manipulating the DER itself when
      performing activities\n   that do not otherwise require parsing in order to
      obtain values\n   therein.\n"
    title: B.1.  DER Length Fields
  - contents:
    - "B.2.  Groups with Multiple Senders\n   GCKS policy may specify more than one
      protected type of IEC 61850\n   message within a GDOI group.  This is represented
      within a GDOI SA\n   Payload by the presence of an SA TEK payload for each multicast
      group\n   that is protected as part of group policy.  The OID contained in each\n
      \  of the SA TEK payloads may be identical, but the value of each OID-\n   Specific
      Payload would be unique.  Typically, the OID-Specific\n   payload defines a
      destination address, and there is typically a\n   single sender to that destination
      address.\n"
    title: B.2.  Groups with Multiple Senders
  title: Appendix B.  Implementation Considerations
- contents:
  - "Appendix C.  Data Attribute Format\n   Data attributes attached to an SA TEK
    following the data attribute\n   format are described in this section.  Data attributes
    can be in\n   Type/Value (TV) format (useful when a value is defined to be less\n
    \  than two octets in size) or in Type/Length/Value (TLV) form.\n                        1
    \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
    6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  !A!       Attribute Type        !    AF=0  Attribute Length     !\n   !F!                             !
    \   AF=1  Attribute Value      !\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \  .                   AF=0  Attribute Value                       .\n   .                   AF=1
    \ Not Transmitted                       .\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
    \                       Figure 10: Data Attributes\n   The Data Attributes fields
    are defined as follows:\n   o  Attribute Type (2 octets) -- Unique identifier
    for each type of\n      attribute.  These attributes are defined as part of the
    DOI-\n      specific information.  The most significant bit, or Attribute\n      Format
    (AF), indicates whether the data attributes follow the\n      Type/Length/Value
    (TLV) format or a shortened Type/Value (TV)\n      format.  If the AF bit is a
    zero (0), then the data attributes are\n      of the Type/Length/Value (TLV) form.
    \ If the AF bit is a one (1),\n      then the data attributes are of the Type/Value
    form.\n   o  Attribute Length (2 octets) -- Length in octets of the Attribute\n
    \     Value.  When the AF bit is a one (1), the Attribute Value is only\n      2
    octets, and the Attribute Length field is not present.\n   o  Attribute Value
    (variable length) -- Value of the attribute\n      associated with the DOI-specific
    Attribute Type.  If the AF bit is\n      a zero (0), this field has a variable
    length defined by the\n      Attribute Length field.  If the AF bit is a one (1),
    the Attribute\n      Value has a length of 2 octets.\n"
  title: Appendix C.  Data Attribute Format
- contents:
  - "Acknowledgements\n   The authors thank Sean Turner, Steffen Fries, Yoav Nir,
    Vincent Roca,\n   Dennis Bourget, and David Boose for their thoughtful reviews,
    each of\n   which resulted in substantial improvements to this memo.  Joe Salowey\n
    \  provided valuable guidance as document shepherd during the\n   publication
    process.  The authors are indebted to Kathleen Moriarty\n   for her agreement
    to sponsor the publication of the document.\n"
  title: Acknowledgements
- contents:
  - "Authors' Addresses\n   Brian Weis\n   Cisco Systems\n   170 W. Tasman Drive\n
    \  San Jose, California  95134-1706\n   United States of America\n   Phone: +1
    408 526 4796\n   Email: bew@cisco.com\n   Maik Seewald\n   Cisco Systems\n   Am
    Soeldnermoos 17\n   D-85399 Hallbergmoos\n   Germany\n   Phone: +49 619 6773 9655\n
    \  Email: maseewal@cisco.com\n   Herb Falk\n   SISCO\n   6605 19-1/2 Mile Road\n
    \  Sterling Heights, MI  48314\n   United States of America\n   Phone: +1 586
    254 0020 x105\n   Email: herb@sisconet.com\n"
  title: Authors' Addresses
