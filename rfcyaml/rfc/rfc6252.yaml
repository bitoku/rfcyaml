- title: __initial_text__
  contents:
  - ''
- title: Internet Research Task Force (IRTF)                        A. Dutta, Ed.
  contents:
  - "Internet Research Task Force (IRTF)                        A. Dutta, Ed.\n  \
    \   A Framework of Media-Independent Pre-Authentication (MPA) for\n          \
    \         Inter-Domain Handover Optimization\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes Media-independent Pre-Authentication (MPA),\
    \ a\n   new handover optimization mechanism that addresses the issues on\n   existing\
    \ mobility management protocols and mobility optimization\n   mechanisms to support\
    \ inter-domain handover.  MPA is a mobile-\n   assisted, secure handover optimization\
    \ scheme that works over any\n   link layer and with any mobility management protocol,\
    \ and is most\n   applicable to supporting optimization during inter-domain handover.\n\
    \   MPA's pre-authentication, pre-configuration, and proactive handover\n   techniques\
    \ allow many of the handoff-related operations to take place\n   before the mobile\
    \ node has moved to the new network.  We describe the\n   details of all the associated\
    \ techniques and their applicability for\n   different scenarios involving various\
    \ mobility protocols during\n   inter-domain handover.  We have implemented the\
    \ MPA mechanism for\n   various network-layer and application-layer mobility protocols,\
    \ and\n   we report a summary of experimental performance results in this\n  \
    \ document.\n   This document is a product of the IP Mobility Optimizations (MOBOPTS)\n\
    \   Research Group.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Research Task Force\n   (IRTF).  The IRTF publishes the results\
    \ of Internet-related research\n   and development activities.  These results\
    \ might not be suitable for\n   deployment.  This RFC represents the consensus\
    \ of the MOBOPTS\n   Research Group of the Internet Research Task Force (IRTF).\
    \  Documents\n   approved for publication by the IRSG are not a candidate for\
    \ any\n   level of Internet Standard; see Section 2 of RFC 5741.\n   Information\
    \ about the current status of this document, any errata,\n   and how to provide\
    \ feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6252.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Specification of Requirements ..............................5\n  \
    \    1.2. Performance Requirements ...................................5\n   2.\
    \ Terminology .....................................................7\n   3. Handover\
    \ Taxonomy ...............................................7\n   4. Related Work\
    \ ...................................................11\n   5. Applicability of\
    \ MPA ...........................................12\n   6. MPA Framework ..................................................13\n\
    \      6.1. Overview ..................................................13\n  \
    \    6.2. Functional Elements .......................................14\n    \
    \  6.3. Basic Communication Flow ..................................16\n   7. MPA\
    \ Operations .................................................20\n      7.1. Discovery\
    \ .................................................21\n      7.2. Pre-Authentication\
    \ in Multiple-CTN Environment ............22\n      7.3. Proactive IP Address\
    \ Acquisition ..........................23\n           7.3.1. PANA-Assisted Proactive\
    \ IP Address Acquisition .....24\n           7.3.2. IKEv2-Assisted Proactive IP\
    \ Address Acquisition ....24\n           7.3.3. Proactive IP Address Acquisition\
    \ Using\n                  DHCPv4 Only ........................................24\n\
    \           7.3.4. Proactive IP Address Acquisition Using Stateless\n        \
    \          Autoconfiguration ..................................26\n      7.4.\
    \ Tunnel Management .........................................26\n      7.5. Binding\
    \ Update ............................................28\n      7.6. Preventing\
    \ Packet Loss ....................................29\n           7.6.1. Packet\
    \ Loss Prevention in Single-Interface MPA .....29\n           7.6.2. Preventing\
    \ Packet Losses for Multiple Interfaces ...29\n           7.6.3. Reachability\
    \ Test ..................................30\n      7.7. Security and Mobility\
    \ .....................................31\n           7.7.1. Link-Layer Security\
    \ and Mobility ...................31\n           7.7.2. IP-Layer Security and\
    \ Mobility .....................32\n      7.8. Authentication in Initial Network\
    \ Attachment ..............33\n   8. Security Considerations ........................................33\n\
    \   9. Acknowledgments ................................................34\n  \
    \ 10. References ....................................................34\n    \
    \  10.1. Normative References .....................................34\n      10.2.\
    \ Informative References ...................................36\n   Appendix A.\
    \ Proactive Duplicate Address Detection .................40\n   Appendix B. Address\
    \ Resolution ....................................41\n   Appendix C. MPA Deployment\
    \ Issues .................................42\n     C.1. Considerations for Failed\
    \ Switching and Switch-Back ........42\n     C.2. Authentication State Management\
    \ ............................43\n     C.3. Pre-Allocation of QoS Resources ............................44\n\
    \     C.4. Resource Allocation Issue during Pre-Authentication ........45\n  \
    \   C.5. Systems Evaluation and Performance Results .................47\n    \
    \   C.5.1. Intra-Technology, Intra-Domain .........................47\n      \
    \ C.5.2. Inter-Technology, Inter-Domain .........................49\n       C.5.3.\
    \ MPA-Assisted Layer 2 Pre-Authentication ................49\n     C.6. Guidelines\
    \ for Handover Preparation ........................54\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   As wireless technologies, including cellular and wireless\
    \ LANs, are\n   becoming popular, supporting terminal handovers across different\n\
    \   types of access networks, such as from a wireless LAN to CDMA or to\n   General\
    \ Packet Radio Service (GPRS), is considered a clear challenge.\n   On the other\
    \ hand, supporting seamless terminal handovers between\n   access networks of\
    \ the same type is still more challenging,\n   especially when the handovers are\
    \ across IP subnets or administrative\n   domains.  To address those challenges,\
    \ it is important to provide\n   terminal mobility that is agnostic to link-layer\
    \ technologies in an\n   optimized and secure fashion without incurring unreasonable\n\
    \   complexity.  In this document, we discuss a framework to support\n   terminal\
    \ mobility that provides seamless handovers with low latency\n   and low loss.\
    \  Seamless handovers are characterized in terms of\n   performance requirements\
    \ as described in Section 1.2.  [MPA-WIRELESS]\n   is an accompanying document\
    \ that describes implementation of a few\n   MPA-based systems, including performance\
    \ results to show how existing\n   protocols could be leveraged to realize the\
    \ functionalities of MPA.\n   Terminal mobility is accomplished by a mobility\
    \ management protocol\n   that maintains a binding between a locator and an identifier\
    \ of a\n   mobile node, where the binding is referred to as the mobility\n   binding.\
    \  The locator of the mobile node may dynamically change when\n   there is a movement\
    \ of the mobile node.  The movement that causes a\n   change of the locator may\
    \ occur when there is a change in attachment\n   point due to physical movement\
    \ or network change.  A mobility\n   management protocol may be defined at any\
    \ layer.  In the rest of this\n   document, the term \"mobility management protocol\"\
    \ refers to a\n   mobility management protocol that operates at the network layer\
    \ or\n   higher.\n   There are several mobility management protocols at different\
    \ layers.\n   Mobile IP [RFC5944] and Mobile IPv6 [RFC3775] are mobility management\n\
    \   protocols that operate at the network layer.  Similarly, MOBIKE\n   (IKEv2\
    \ Mobility and Multihoming) [RFC4555] is an extension to the\n   Internet Key\
    \ Exchange Protocol (IKEv2) that provides the ability to\n   deal with a change\
    \ of an IP address of an IKEv2 end-point.  There are\n   several ongoing activities\
    \ in the IETF to define mobility management\n   protocols at layers higher than\
    \ the network layer.  HIP (Host\n   Identity Protocol) [RFC5201] defines a new\
    \ protocol layer between the\n   network layer and transport layer to provide\
    \ terminal mobility in a\n   way that is transparent to both the network layer\
    \ and transport\n   layer.  Also, SIP-based mobility is an extension to SIP to\
    \ maintain\n   the mobility binding of a SIP user agent [SIPMM].\n   While mobility\
    \ management protocols maintain mobility bindings, these\n   cannot provide seamless\
    \ handover if used in their current form.  An\n   additional optimization mechanism\
    \ is needed to prevent the loss of\n   in-flight packets transmitted during the\
    \ mobile node's binding update\n   procedure and to achieve seamless handovers.\
    \  Such a mechanism is\n   referred to as a mobility optimization mechanism. \
    \ For example,\n   mobility optimization mechanisms for Mobile IPv4 [RFC4881]\
    \ and Mobile\n   IPv6 [RFC5568] are defined to allow neighboring access routers\
    \ to\n   communicate and carry information about mobile terminals.  There are\n\
    \   protocols that are considered as \"helpers\" of mobility optimization\n  \
    \ mechanisms.  The CARD (Candidate Access Router Discovery) protocol\n   [RFC4066]\
    \ is designed to discover neighboring access routers.  CXTP\n   (Context Transfer\
    \ Protocol) [RFC4067] is designed to carry state that\n   is associated with the\
    \ services provided for the mobile node, or\n   context, among access routers.\
    \  In Section 4, we describe some of the\n   fast-handover schemes that attempt\
    \ to reduce the handover delay.\n   There are several issues in existing mobility\
    \ optimization\n   mechanisms.  First, existing mobility optimization mechanisms\
    \ are\n   tightly coupled with specific mobility management protocols.  For\n\
    \   example, it is not possible to use mobility optimization mechanisms\n   designed\
    \ for Mobile IPv4 or Mobile IPv6 with MOBIKE.  What is\n   strongly desired is\
    \ a single, unified mobility optimization mechanism\n   that works with any mobility\
    \ management protocol.  Second, there is\n   no existing mobility optimization\
    \ mechanism that easily supports\n   handovers across administrative domains without\
    \ assuming a\n   pre-established security association between administrative domains.\n\
    \   A mobility optimization mechanism should work across administrative\n   domains\
    \ in a secure manner only based on a trust relationship between\n   a mobile node\
    \ and each administrative domain.  Third, a mobility\n   optimization mechanism\
    \ needs to support not only terminals with\n   multiple interfaces where simultaneous\
    \ connectivity through multiple\n   interfaces or connectivity through a single\
    \ interface can be\n   expected, but also terminals with a single interface.\n\
    \   This document describes a framework of Media-independent\n   Pre-Authentication\
    \ (MPA), a new handover optimization mechanism that\n   addresses all those issues.\
    \  MPA is a mobile-assisted, secure\n   handover optimization scheme that works\
    \ over any link layer and with\n   any mobility management protocol, including\
    \ Mobile IPv4, Mobile IPv6,\n   MOBIKE, HIP, and SIP mobility.  In cases of multiple\
    \ operators\n   without a roaming relationship or without an agreement to participate\n\
    \   in a key management scheme, MPA provides a framework that can perform\n  \
    \ pre-authentication to establish the security mechanisms without\n   assuming\
    \ a common source of trust.  In MPA, the notion of IEEE\n   802.11i pre-authentication\
    \ is extended to work at a higher layer,\n   with additional mechanisms to perform\
    \ early acquisition of an IP\n   address from a network where the mobile node\
    \ may move, as well as\n   proactive handover to the network while the mobile\
    \ node is still\n   attached to the current network.  Since this document focuses\
    \ on the\n   MPA framework, it is left to future work to choose the protocols\
    \ for\n   MPA and define detailed operations.  The accompanying document\n   [MPA-WIRELESS]\
    \ provides one method that describes usage and\n   interactions between existing\
    \ protocols to accomplish MPA\n   functionality.\n   This document represents\
    \ the consensus of the IP Mobility\n   Optimizations (MOBOPTS) Research Group.\
    \  It has been reviewed by\n   Research Group members active in the specific area\
    \ of work.\n"
- title: 1.1.  Specification of Requirements
  contents:
  - "1.1.  Specification of Requirements\n   In this document, several words are used\
    \ to signify the requirements\n   of the specification.  These words are often\
    \ capitalized.  The key\n   words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\", \"SHOULD\",\n   \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this document\n   are to be interpreted as described in [RFC2119].\n"
- title: 1.2.  Performance Requirements
  contents:
  - "1.2.  Performance Requirements\n   In order to provide desirable quality of service\
    \ for interactive\n   Voice over IP (VoIP) and streaming traffic, one needs to\
    \ limit the\n   value of end-to-end delay, jitter, and packet loss to a certain\n\
    \   threshold level.  ITU-T and ITU-E standards define the acceptable\n   values\
    \ for these parameters.  For example, for one-way delay, ITU-T\n   G.114 [RG98]\
    \ recommends 150 ms as the upper limit for most of the\n   applications, and 400\
    \ ms as generally unacceptable delay.  One-way\n   delay tolerance for video conferencing\
    \ is in the range of 200 to\n   300 ms [ITU98].  Also, if an out-of-order packet\
    \ is received after a\n   certain threshold, it is considered lost.  According\
    \ to ETSI TR 101\n   [ETSI], a normal voice conversation can tolerate up to 2%\
    \ packet\n   loss.  But this is the mean packet loss probability and may be\n\
    \   applicable to a scenario when the mobile node is subjected to\n   repeated\
    \ handoff during a normal conversation.  Measurement\n   techniques for delay\
    \ and jitter are described in [RFC2679],\n   [RFC2680], and [RFC2681].\n   In\
    \ the case of interactive VoIP traffic, end-to-end delay affects the\n   jitter\
    \ value, and thus is an important issue to consider.  An end-to-\n   end delay\
    \ consists of several components, such as network delay,\n   operating system\
    \ (OS) delay, codec delay, and application delay.  A\n   complete analysis of\
    \ these delays can be found in [WENYU].  During a\n   mobile node's handover,\
    \ in-flight transient traffic cannot reach the\n   mobile node because of the\
    \ associated handover delay.  These\n   in-flight packets could either be lost\
    \ or buffered.  If the in-flight\n   packets are lost, this packet loss will contribute\
    \ to jitter between\n   the last packet before handoff and the first packet after\
    \ handoff.\n   If these packets are buffered, packet loss is minimized, but there\
    \ is\n   additional jitter for the in-flight packets when these are flushed\n\
    \   after the handoff.  Buffering during handoff avoids the packet loss,\n   but\
    \ at the cost of additional one-way delay.  A tradeoff between one-\n   way delay\
    \ and packet loss is desired based on the type of\n   application.  For example,\
    \ for a streaming application, packet loss\n   can be reduced by increasing the\
    \ playout buffer, resulting in longer\n   one-way packet delay.\n   The handover\
    \ delay is attributed to several factors, such as\n   discovery, configuration,\
    \ authentication, binding update, and media\n   delivery.  Many of the security-related\
    \ procedures, such as handover\n   keying and re-authentication procedures, deal\
    \ with cases where there\n   is a single source of trust at the top, and the underlying\n\
    \   Authentication, Authorization, and Accounting (AAA) domain elements\n   trust\
    \ the top source of trust and the keys it generates and\n   distributes.  In this\
    \ scenario, there is an appreciable delay in\n   re-establishing link-security-related\
    \ parameters, such as\n   authentication, link key management, and access authorization\
    \ during\n   inter-domain handover.  The focus of this document is the design\
    \ of a\n   framework that can reduce the delay due to authentication and other\n\
    \   handoff-related operations such as configuration and binding update.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   Mobility Binding:  A binding between a locator and an identifier\
    \ of a\n      mobile terminal.\n   Mobility Management Protocol (MMP):  A protocol\
    \ that operates at the\n      network layer or above to maintain a binding between\
    \ a locator and\n      an identifier of a mobile node.\n   Binding Update (BU):\
    \  A procedure to update a mobility binding.\n   Media-independent Pre-Authentication\
    \ Mobile Node (MN):  A mobile node\n      using Media-independent Pre-Authentication\
    \ (MPA).  MPA is a\n      mobile-assisted, secure handover optimization scheme\
    \ that works\n      over any link layer and with any mobility management protocol.\
    \  An\n      MPA mobile node is an IP node.  In this document, the term \"mobile\n\
    \      node\" or \"MN\" without a modifier refers to \"MPA mobile node\".  An\n\
    \      MPA mobile node usually has a functionality of a mobile node of a\n   \
    \   mobility management protocol as well.\n   Candidate Target Network (CTN):\
    \  A network to which the mobile node\n      may move in the near future.\n  \
    \ Target Network (TN):  The network to which the mobile node has\n      decided\
    \ to move.  The target network is selected from one or more\n      candidate target\
    \ networks.\n   Proactive Handover Tunnel (PHT):  A bidirectional IP tunnel [RFC2003]\n\
    \      [RFC2473] that is established between the MPA mobile node and an\n    \
    \  access router of a candidate target network.  In this document,\n      the\
    \ term \"tunnel\" without a modifier refers to \"proactive handover\n      tunnel\"\
    .\n   Point of Attachment (PoA):  A link-layer device (e.g., a switch, an\n  \
    \    access point, or a base station) that functions as a link-layer\n      attachment\
    \ point for the MPA mobile node to a network.\n   Care-of Address (CoA):  An IP\
    \ address used by a mobility management\n      protocol as a locator of the MPA\
    \ mobile node.\n"
- title: 3.  Handover Taxonomy
  contents:
  - "3.  Handover Taxonomy\n   Based on the type of movement, type of access network,\
    \ and underlying\n   mobility support, one can primarily define the handover as\
    \ inter-\n   technology, intra-technology, inter-domain, and intra-domain.  We\n\
    \   describe briefly each of these handover processes.  However, our\n   focus\
    \ of the discussion is on inter-domain handover.\n   Inter-technology:  A mobile\
    \ node may be equipped with multiple\n      interfaces, where each interface can\
    \ support a different access\n      technology (e.g., 802.11, CDMA).  A mobile\
    \ node may communicate\n      with one interface at any time in order to conserve\
    \ power.  During\n      the handover, the mobile node may move out of the footprint\
    \ of one\n      access technology (e.g., 802.11) and move into the footprint of\
    \ a\n      different access technology (e.g., CDMA).  This will warrant\n    \
    \  switching of the communicating interface on the mobile node as\n      well.\
    \  This type of inter-technology handover is often called\n      \"vertical handover\"\
    , since the mobile node moves between two\n      different cell sizes.\n   Intra-technology:\
    \  An intra-technology handover is defined as when a\n      mobile node moves\
    \ within the same type of access technology, such\n      as between 802.11[a,b,n]\
    \ and 802.11 [a,b,n] or between CDMA1XRTT\n      and CDMA1EVDO.  In this scenario,\
    \ a mobile node may be equipped\n      with a single interface (with multiple\
    \ PHY types of the same\n      technology) or with multiple interfaces.  An intra-technology\n\
    \      handover may involve intra-subnet or inter-subnet movement and\n      thus\
    \ may need to change its L3 locator, depending upon the type of\n      movement.\n\
    \   Inter-domain:  A domain can be defined in several ways.  But for the\n   \
    \   purposes of roaming, we define \"domain\" as an administrative\n      domain\
    \ that consists of networks managed by a single\n      administrative entity that\
    \ authenticates and authorizes a mobile\n      node for accessing the networks.\
    \  An administrative entity may be\n      a service provider, an enterprise, or\
    \ any organization.  Thus, an\n      inter-domain handover will by default be\
    \ subjected to inter-subnet\n      handover, and in addition it may be subjected\
    \ to either inter-\n      technology or intra-technology handover.  A mobile node\
    \ is\n      subjected to inter-subnet handover when it moves from one subnet\n\
    \      (broadcast domain) to another subnet (broadcast domain).  Inter-\n    \
    \  domain handover will be subjected to all the transition steps a\n      subnet\
    \ handover goes through, and it will be subjected to\n      authentication and\
    \ authorization processes as well.  It is also\n      likely that the type of\
    \ mobility support in each administrative\n      domain will be different.  For\
    \ example, administrative domain A\n      may have Mobile IP version 6 (MIPv6)\
    \ support, while administrative\n      domain B may use Proxy MIPv6 [RFC5213].\n\
    \   Intra-domain:  When a mobile node's movement is confined to movement\n   \
    \   within an administrative domain, it is called \"intra-domain\n      movement\"\
    .  An intra-domain movement may involve intra-subnet,\n      inter-subnet, intra-technology,\
    \ and inter-technology as well.\n   Both inter-domain and intra-domain handovers\
    \ can be subjected to\n   either inter-technology or intra-technology handover\
    \ based on the\n   network access characteristics.  Inter-domain handover requires\n\
    \   authorization for acquisition or modification of resources assigned\n   to\
    \ a mobile node, and the authorization needs interaction with a\n   central authority\
    \ in a domain.  In many cases, an authorization\n   procedure during inter-domain\
    \ handover follows an authentication\n   procedure that also requires interaction\
    \ with a central authority in\n   a domain.  Thus, security associations between\
    \ the network entities,\n   such as routers in the neighboring administrative\
    \ domains, need to be\n   established before any interaction takes place between\
    \ these\n   entities.  Similarly, an inter-domain mobility may involve different\n\
    \   mobility protocols, such as MIPv6 and Proxy MIPv6, in each of its\n   domains.\
    \  In that case, one needs a generalized framework to achieve\n   the optimization\
    \ during inter-domain handover.  Figure 1 shows a\n   typical example of inter-domain\
    \ mobility involving two domains,\n   domain A and domain B.  It illustrates several\
    \ important components,\n   such as a AAA Home server (AAAH); AAA visited servers\
    \ (e.g., AAAV1\n   and AAAV2); an Authentication Agent (AA); a layer 3 point of\n\
    \   attachment, such as an Access Router (AR); and a layer 2 point of\n   attachment,\
    \ such as an Access Point (AP).  Any mobile node may be\n   using a specific mobility\
    \ protocol and associated mobility\n   optimization technique during intra-domain\
    \ movement in either domain.\n   But the same optimization technique may not be\
    \ suitable to support\n   inter-domain handover, independent of whether it uses\
    \ the same or a\n   different mobility protocol in either domain.\n          \
    \              +-----------------------------+\n                        |    \
    \  +--------+             |\n                        |      |        |       \
    \      |\n                        |      | AAAH   ------------------|\n      \
    \                  |      |        |             |   |\n                     \
    \   |      +|-------+             |   |\n                        |       |   \
    \                  |   |\n                        |       |  Home Domain     \
    \   |   |\n                        |       |                     |   |\n     \
    \                   +-------|---------------------+   |\n                    \
    \            |                         |\n                                |  \
    \                       |\n                                |                 \
    \        |\n   +----------------------------|---------+ +-------------|------------+\n\
    \   | Domain A                   |         | | Domain B    |            |\n  \
    \ |                            |         | |            +|-------+    |\n   |\
    \                    +-------|+        | | +-----+    |        |    |\n   |  \
    \                  |        |        | | |     ------ AAAV2  |    |\n   |    \
    \                | AAAV1  |        | | | AA  |    |        |    |\n   |      +--------------\
    \        |        | | +|----+    +--------+    |\n   |      |     |       +--------+\
    \        | |  |                       |\n   |      |AA   |                   \
    \      | |  |---         ----       |\n   |      +--|--+                     \
    \    | | /    \\       /    \\      |\n   |         |              /----\\   \
    \     | || AR   |-----| AR   |     |\n   |        -|--           /      \\   \
    \    | | \\    /       \\    /      |\n   |       /    \\         | AR     | \
    \     | |  -|--         --|-       |\n   |      | AR   -----------      /    \
    \   | |+--|---+  +------|------+ |\n   |       \\    /           \\--|-/     \
    \   | || AP4  |  |  L2 Switch  | |\n   |        -/--         +-----|------+  \
    \ | ||      |  +-|---------|-+ |\n   |        /            |  L2 Switch |   |\
    \ |+------+    |         |   |\n   |       /             +-|-------|--+   | |\
    \        +---|--+ +----|-+ |\n   | +----/-+         +----|-+   +-|----+ | |  \
    \      |      | |      | |\n   | |      |         |      |   |      | | |    \
    \    | AP5  | |AP6   | |\n   | | AP1  |         | AP2  |   | AP3  | | |      \
    \  +----|-+ +------+ |\n   | +------+         +------+   +--|---+ | |        \
    \     |            |\n   +--------------------------------|-----+ +------------\
    \ |------------+\n                                  --|---------            |\n\
    \                              ////            \\\\\\\\   -----|-----\n      \
    \                      //    +------+       ////  +------+ \\\\\\\\\n        \
    \                    |     | MN   ------------->|MN  |     \\\\\\\n          \
    \                 |      |      |    |     |  |      |       |\n             \
    \               |     +------+   |     |   +------+        |\n               \
    \             \\\\                |   //                  |\n                \
    \              \\\\\\\\            \\\\\\/                  ///\n            \
    \                      ------------   \\\\\\\\------------- ////\n           \
    \           Figure 1: Inter-Domain Mobility\n"
- title: 4.  Related Work
  contents:
  - "4.  Related Work\n   While basic mobility management protocols such as Mobile\
    \ IP\n   [RFC5944], Mobile IPv6 [RFC3775], and SIP-Mobility [SIPMM] provide\n\
    \   continuity to TCP and RTP traffic, these are not optimized to reduce\n   the\
    \ handover latency during a mobile node's movement between subnets\n   and domains.\
    \  In general, these mobility management protocols\n   introduce handover delays\
    \ incurred at several layers, such as layer 3\n   and the application layer, for\
    \ updating the mobile node's mobility\n   binding.  These protocols are affected\
    \ by underlying layer 2 delay as\n   well.  As a result, applications using these\
    \ mobility protocols\n   suffer from performance degradation.\n   There have been\
    \ several optimization techniques that apply to current\n   mobility management\
    \ schemes that try to reduce handover delay and\n   packet loss during a mobile\
    \ node's movement between cells, subnets,\n   and domains.  Micro-mobility management\
    \ schemes such as [CELLIP] and\n   [HAWAII], and intra-domain mobility management\
    \ schemes such as\n   [IDMP], [MOBIP-REG], and [RFC5380], provide fast handover\
    \ by limiting\n   the signaling updates within a domain.  Fast Mobile IP protocols\
    \ for\n   IPv4 and IPv6 networks [RFC4881] [RFC5568] utilize mobility\n   information\
    \ made available by link-layer triggers.  Yokota et\n   al. [YOKOTA] propose the\
    \ joint use of an access point and a dedicated\n   Media Access Control (MAC)\
    \ bridge to provide fast handover without\n   altering the MIPv4 specification.\
    \  Shin et al. [MACD] propose a\n   scheme that reduces the delay due to MAC-layer\
    \ handoff by providing a\n   cache-based algorithm.  In this scheme, the mobile\
    \ node caches the\n   neighboring channels that it has already visited and thus\
    \ uses a\n   selective scanning method.  This helps to reduce the associated\n\
    \   scanning time.\n   Some mobility management schemes use dual interfaces, thus\
    \ providing\n   make-before-break [SUM].  In a make-before-break situation,\n\
    \   communication usually continues with one interface when the secondary\n  \
    \ interface is in the process of getting connected.  The IEEE 802.21\n   working\
    \ group is discussing these scenarios in detail [802.21].\n   Providing fast handover\
    \ using a single interface needs more careful\n   design than for a client with\
    \ multiple interfaces.  Dutta et\n   al. [SIPFAST] provide an optimized handover\
    \ scheme for SIP-based\n   mobility management, where the transient traffic is\
    \ forwarded from\n   the old subnet to the new one by using an application-layer\n\
    \   forwarding scheme.  [MITH] provides a fast-handover scheme for the\n   single-interface\
    \ case that uses mobile-initiated tunneling between\n   the old Foreign Agent\
    \ and a new Foreign Agent.  [MITH] defines two\n   types of handover schemes:\
    \ Pre-MIT (Mobile Initiated Tunneling) and\n   Post-MIT (Media Initiated Tunneling).\
    \  The proposed MPA scheme is\n   very similar to Mobile Initiated Tunneling Handoff's\
    \ (MITH's)\n   predictive scheme, where the mobile node communicates with the\n\
    \   Foreign Agent before actually moving to the new network.  However,\n   the\
    \ MPA scheme is not limited to MIP; this scheme takes care of\n   movement between\
    \ domains and performs pre-authentication in addition\n   to proactive handover.\
    \  Thus, MPA reduces the overall delay to a\n   period close to that of link-layer\
    \ handover delay.  Most of the\n   mobility optimization techniques developed\
    \ so far are restricted to a\n   specific type of mobility protocol only.  While\
    \ supporting\n   optimization for inter-domain mobility, these protocols assume\
    \ that\n   there is a pre-established security arrangement between two\n   administrative\
    \ domains.  But this assumption may not always be\n   viable.  Thus, there is\
    \ a need to develop an optimization mechanism\n   that can support inter-domain\
    \ mobility without any underlying\n   constraints or security-related assumptions.\n\
    \   Recently, the HOKEY working group within the IETF has been defining\n   ways\
    \ to expedite the authentication process.  In particular, it has\n   defined pre-authentication\
    \ [RFC5836] and fast re-authentication\n   [RFC5169] mechanisms to expedite the\
    \ authentication and security\n   association process.\n"
- title: 5.  Applicability of MPA
  contents:
  - "5.  Applicability of MPA\n   MPA is more applicable where an accurate prediction\
    \ of movement can\n   be easily made.  For other environments, special care must\
    \ be taken\n   to deal with issues such as pre-authentication to multiple CTNs\n\
    \   (Candidate Target Networks), and failed switching and switching back\n   as\
    \ described in [MPA-WIRELESS].  However, addressing those issues in\n   actual\
    \ deployments may not be easier.  Some of the deployment issues\n   are described\
    \ in Appendix C.\n   The authors of the accompanying document [MPA-WIRELESS] have\
    \ cited\n   several use cases of how MPA can be used to optimize several network-\n\
    \   layer and application-layer mobility protocols.  The effectiveness of\n  \
    \ MPA may be relatively reduced if the network employs network-\n   controlled\
    \ localized mobility management in which the MN does not\n   need to change its\
    \ IP address while moving within the network.  The\n   effectiveness of MPA may\
    \ also be relatively reduced if signaling for\n   network access authentication\
    \ is already optimized for movements\n   within the network, e.g., when simultaneous\
    \ use of multiple\n   interfaces during handover is allowed.  In other words,\
    \ MPA is more\n   viable as a solution for inter-administrative domain predictive\n\
    \   handover without the simultaneous use of multiple interfaces.  Since\n   MPA\
    \ is not tied to a specific mobility protocol, it is also\n   applicable to support\
    \ optimization for inter-domain handover where\n   each domain may be equipped\
    \ with a different mobility protocol.\n   Figure 1 shows an example of inter-domain\
    \ mobility where MPA could be\n   applied.  For example, domain A may support\
    \ just Proxy MIPv6, whereas\n   domain B may support Client Mobile IPv6.  MPA's\
    \ different functional\n   components can provide the desired optimization techniques\n\
    \   proactively.\n"
- title: 6.  MPA Framework
  contents:
  - '6.  MPA Framework

    '
- title: 6.1.  Overview
  contents:
  - "6.1.  Overview\n   Media-independent Pre-Authentication (MPA) is a mobile-assisted,\n\
    \   secure handover optimization scheme that works over any link layer\n   and\
    \ with any mobility management protocol.  With MPA, a mobile node\n   is not only\
    \ able to securely obtain an IP address and other\n   configuration parameters\
    \ for a CTN, but also able to send and receive\n   IP packets using the IP address\
    \ obtained before it actually attaches\n   to the CTN.  This makes it possible\
    \ for the mobile node to complete\n   the binding update of any mobility management\
    \ protocol and use the\n   new CoA before performing a handover at the link layer.\n\
    \   MPA adopts the following basic procedures to provide this\n   functionality.\
    \  The first procedure is referred to as\n   \"pre-authentication\", the second\
    \ procedure is referred to as\n   \"pre-configuration\", and the combination of\
    \ the third and fourth\n   procedures is referred to as \"secure proactive handover\"\
    .  The\n   security association established through pre-authentication is\n  \
    \ referred to as an \"MPA-SA\".\n   This functionality is provided by allowing\
    \ a mobile node that has\n   connectivity to the current network, but is not yet\
    \ attached to a\n   CTN, to\n      (i) establish a security association with the\
    \ CTN to secure the\n      subsequent protocol signaling, then\n      (ii) securely\
    \ execute a configuration protocol to obtain an IP\n      address and other parameters\
    \ from the CTN as well as execute a\n      tunnel management protocol to establish\
    \ a Proactive Handover\n      Tunnel (PHT) [RFC2003] between the mobile node and\
    \ an access\n      router of the CTN, then\n      (iii) send and receive IP packets,\
    \ including signaling messages\n      for the binding update of an MMP and data\
    \ packets transmitted\n      after completion of the binding update, over the\
    \ PHT, using the\n      obtained IP address as the tunnel inner address, and finally\n\
    \      (iv) delete or disable the PHT immediately before attaching to the\n  \
    \    CTN when it becomes the target network, and then re-assign the\n      inner\
    \ address of the deleted or disabled tunnel to its physical\n      interface immediately\
    \ after the mobile node is attached to the\n      target network through the interface.\
    \  Instead of deleting or\n      disabling the tunnel before attaching to the\
    \ target network, the\n      tunnel may be deleted or disabled immediately after\
    \ being attached\n      to the target network.\n   Step (iii) above (i.e., the\
    \ binding update procedure), in particular,\n   makes it possible for the mobile\
    \ node to complete the higher-layer\n   handover before starting a link-layer\
    \ handover.  This means that the\n   mobile node is able to send and receive data\
    \ packets transmitted\n   after completing the binding update over the tunnel,\
    \ while data\n   packets transmitted before completion of the binding update do\
    \ not\n   use the tunnel.\n"
- title: 6.2.  Functional Elements
  contents:
  - "6.2.  Functional Elements\n   In the MPA framework, the following functional\
    \ elements are expected\n   to reside in each CTN to communicate with a mobile\
    \ node: an\n   Authentication Agent (AA), a Configuration Agent (CA), and an Access\n\
    \   Router (AR).  These elements can reside in one or more network\n   devices.\n\
    \   An authentication agent is responsible for pre-authentication.  An\n   authentication\
    \ protocol is executed between the mobile node and the\n   authentication agent\
    \ to establish an MPA-SA.  The authentication\n   protocol MUST be able to establish\
    \ a shared key between the mobile\n   node and the authentication agent and SHOULD\
    \ be able to provide\n   mutual authentication.  The authentication protocol SHOULD\
    \ be able to\n   interact with a AAA protocol, such as RADIUS or Diameter, to\
    \ carry\n   authentication credentials to an appropriate authentication server\
    \ in\n   the AAA infrastructure.  This interaction happens through the\n   authentication\
    \ agent, such as the PANA Authentication Agent (PAA).\n   In turn, the derived\
    \ key is used to derive additional keys that will\n   be applied to protecting\
    \ message exchanges used for pre-configuration\n   and secure proactive handover.\
    \  Other keys that are used for\n   bootstrapping link-layer and/or network-layer\
    \ ciphers MAY also be\n   derived from the MPA-SA.  A protocol that can carry\
    \ the Extensible\n   Authentication Protocol (EAP) [RFC3748] would be suitable\
    \ as an\n   authentication protocol for MPA.\n   A configuration agent is responsible\
    \ for one part of\n   pre-configuration, namely securely executing a configuration\
    \ protocol\n   to deliver an IP address and other configuration parameters to\
    \ the\n   mobile node.  The signaling messages of the configuration protocol\n\
    \   (e.g., DHCP) MUST be protected using a key derived from the key\n   corresponding\
    \ to the MPA-SA.\n   An access router in the MPA framework is a router that is\
    \ responsible\n   for the other part of pre-configuration, i.e., securely executing\
    \ a\n   tunnel management protocol to establish a proactive handover tunnel\n\
    \   to the mobile node.  IP packets transmitted over the proactive\n   handover\
    \ tunnel SHOULD be protected using a key derived from the key\n   corresponding\
    \ to the MPA-SA.  Details of this procedure are described\n   in Section 6.3.\n\
    \   Figure 2 shows the basic functional components of MPA.\n                 \
    \                       +----+\n                                        | CN |\n\
    \                                        +----+\n                            \
    \             /\n                              (Core Network)\n              \
    \               /              \\\n                            /             \
    \   \\\n          +----------------/--------+    +----\\-----------------+\n \
    \         | +-----+                 |    |+-----+               |\n          |\
    \ |     |        +-----+  |    ||     |       +-----+ |\n          | | AA  | \
    \       |CA   |  |    ||AA   |       | CA  | |\n          | +--+--+        +--+--+\
    \  |    |+--+--+       +--+--+ |\n          |    |   +------+   |     |    | \
    \  | +-----+     |    |\n          |    |   | pAR  |   |     |    |   | |nAR \
    \ |     |    |\n          | ---+---+      +---+-----+----+---+-+     +-----+ \
    \   |\n          |        +---+--+         |    |     +-----+          |\n   \
    \       |            |            |    |                      |\n          | \
    \           |            |    |                      |\n          |          \
    \  |            |    |                      |\n          +------------+------------+\
    \    +--------|-------------+\n          Current      |                 Candidate|\
    \ Target Network\n          Network      |                          |\n      \
    \              +------+                  +------+\n                    | oPoA\
    \ |                  | nPoA |\n                    +--.---+                  +--.---+\n\
    \                       .                         .\n                       .\
    \                         .\n                    +------+\n                  \
    \  |  MN  |  ---------->\n                    +------+\n                    Figure\
    \ 2: MPA Functional Components\n"
- title: 6.3.  Basic Communication Flow
  contents:
  - "6.3.  Basic Communication Flow\n   Assume that the mobile node is already connected\
    \ to a point of\n   attachment, say oPoA (old point of attachment), and assigned\
    \ a\n   care-of address, say oCoA (old care-of address).  The communication\n\
    \   flow of MPA is described as follows.  Throughout the communication\n   flow,\
    \ data packet loss should not occur except for the period during\n   the switching\
    \ procedure in Step 5 below, and it is the responsibility\n   of link-layer handover\
    \ to minimize packet loss during this period.\n   Step 1 (pre-authentication phase):\
    \  The mobile node finds a CTN\n      through some discovery process, such as\
    \ IEEE 802.21, and obtains\n      the IP addresses of an authentication agent,\
    \ a configuration\n      agent, and an access router in the CTN (Candidate Target\
    \ Network)\n      by some means.  Details about discovery mechanisms are discussed\n\
    \      in Section 7.1.  The mobile node performs pre-authentication with\n   \
    \   the authentication agent.  As discussed in Section 7.2, the mobile\n     \
    \ node may need to pre-authenticate with multiple candidate target\n      networks.\
    \  The decision regarding with which candidate network the\n      mobile node\
    \ needs to pre-authenticate will depend upon several\n      factors, such as signaling\
    \ overhead, bandwidth requirement\n      (Quality of Service (QoS)), the mobile\
    \ node's location,\n      communication cost, handover robustness, etc.  Determining\
    \ the\n      policy that decides the target network with which the mobile node\n\
    \      should pre-authenticate is out of scope for this document.\n      If the\
    \ pre-authentication is successful, an MPA-SA is created\n      between the mobile\
    \ node and the authentication agent.  Two keys\n      are derived from the MPA-SA,\
    \ namely an MN-CA key and an MN-AR key,\n      which are used to protect subsequent\
    \ signaling messages of a\n      configuration protocol and a tunnel management\
    \ protocol,\n      respectively.  The MN-CA key and the MN-AR key are then securely\n\
    \      delivered to the configuration agent and the access router,\n      respectively.\n\
    \   Step 2 (pre-configuration phase):  The mobile node realizes that its\n   \
    \   point of attachment is likely to change from the oPoA to a new\n      one,\
    \ say nPoA (new point of attachment).  It then performs\n      pre-configuration\
    \ with the configuration agent, using the\n      configuration protocol to obtain\
    \ several configuration parameters\n      such as an IP address, say nCoA (new\
    \ care-of address), and a\n      default router from the CTN.  The mobile node\
    \ then communicates\n      with the access router using the tunnel management\
    \ protocol to\n      establish a proactive handover tunnel.  In the tunnel management\n\
    \      protocol, the mobile node registers the oCoA and the nCoA as the\n    \
    \  tunnel outer address and the tunnel inner address, respectively.\n      The\
    \ signaling messages of the pre-configuration protocol are\n      protected using\
    \ the MN-CA key and the MN-AR key.  When the\n      configuration agent and the\
    \ access router are co-located in the\n      same device, the two protocols may\
    \ be integrated into a single\n      protocol, such as IKEv2.  After completion\
    \ of the tunnel\n      establishment, the mobile node is able to communicate using\
    \ both\n      the oCoA and the nCoA by the end of Step 4.  A configuration\n \
    \     protocol and a tunnel management protocol may be combined in a\n      single\
    \ protocol or executed in different orders depending on the\n      actual protocol(s)\
    \ used for configuration and tunnel management.\n   Step 3 (secure proactive handover\
    \ main phase):  The mobile node\n      decides to switch to the new point of attachment\
    \ by some means.\n      Before the mobile node switches to the new point of attachment,\
    \ it\n      starts secure proactive handover by executing the binding update\n\
    \      operation of a mobility management protocol and transmitting\n      subsequent\
    \ data traffic over the tunnel (main phase).  This\n      proactive binding update\
    \ could be triggered based on certain local\n      policy at the mobile node end,\
    \ after the pre-configuration phase\n      is over.  This local policy could be\
    \ Signal-to-Noise Ratio,\n      location of the mobile node, etc.  In some cases,\
    \ it may cache\n      multiple nCoA addresses and perform simultaneous binding\
    \ with the\n      Correspondent Node (CN) or Home Agent (HA).\n   Step 4 (secure\
    \ proactive handover pre-switching phase):  The mobile\n      node completes the\
    \ binding update and becomes ready to switch to\n      the new point of attachment.\
    \  The mobile node may execute the\n      tunnel management protocol to delete\
    \ or disable the proactive\n      handover tunnel and cache the nCoA after deletion\
    \ or disabling of\n      the tunnel.  This transient tunnel can be deleted prior\
    \ to or\n      after the handover.  The buffering module at the next access\n\
    \      router buffers the packets once the tunnel interface is deleted.\n    \
    \  The decision as to when the mobile node is ready to switch to the\n      new\
    \ point of attachment depends on the handover policy.\n   Step 5 (switching):\
    \  It is expected that a link-layer handover occurs\n      in this step.\n   Step\
    \ 6 (secure proactive handover post-switching phase):  The mobile\n      node\
    \ executes the switching procedure.  Upon successful completion\n      of the\
    \ switching procedure, the mobile node immediately restores\n      the cached\
    \ nCoA and assigns it to the physical interface attached\n      to the new point\
    \ of attachment.  If the proactive handover tunnel\n      was not deleted or disabled\
    \ in Step 4, the tunnel is deleted or\n      disabled as well.  After this, direct\
    \ transmission of data packets\n      using the nCoA is possible without using\
    \ a proactive handover\n      tunnel.\n   Call flow for MPA is shown in Figures\
    \ 3 and 4.\n                                                         IP address(es)\n\
    \                                                          Available for\n   \
    \                                                          Use by MN\n       \
    \                                                            |\n             \
    \              +-----------------------------------+   |\n                   \
    \        |     Candidate Target Network      |   |\n                         \
    \  |     (Future Target Network)       |   |\n             MN       oPoA | nPoA\
    \     AA        CA        AR   |   |\n             |         |   |  |       |\
    \         |         |    |   |\n             |         |   +-----------------------------------+\
    \   |\n             |         |      |       |         |         |        .\n\
    \    +---------------+  |      |       |         |         |        .\n    |(1)\
    \ Found a CTN|  |      |       |         |         |        .\n    +---------------+\
    \  |      |       |         |         |        |\n             |   Pre-authentication\
    \   |         |         |        |\n             |   [authentication protocol]\
    \      |         |        |\n             |<--------+------------->|MN-CA key|\
    \         |        |\n             |         |      |       |-------->|MN-AR key|\
    \        |\n   +-----------------+ |      |       |------------------>|      \
    \  |\n   |(2) Increased    | |      |       |         |         |     [oCoA]\n\
    \   |chance to switch | |      |       |         |         |        |\n   |  \
    \   to CTN      | |      |       |         |         |        |\n   +-----------------+\
    \ |      |       |         |         |        |\n             |         |    \
    \  |       |         |         |        |\n             |   Pre-configuration\
    \    |         |         |        |\n             |   [configuration protocol\
    \ to get nCoA]     |        |\n             |<--------+----------------------->|\
    \         |        |\n             |   Pre-configuration    |         |      \
    \   |        |\n             |   [tunnel management protocol to establish PHT]\
    \     V\n             |<--------+--------------------------------->|\n       \
    \      |         |      |       |         |         |        ^\n   +-----------------+\
    \ |      |       |         |         |        |\n   |(3) Determined   | |    \
    \  |       |         |         |        |\n   |to switch to CTN | |      |   \
    \    |         |         |        |\n   +-----------------+ |      |       | \
    \        |         |        |\n             |         |      |       |       \
    \  |         |        |\n             |   Secure proactive handover main phase\
    \     |        |\n             |   [execution of binding update of MMP and  |\
    \        |\n             |    transmission of data packets through AR | [oCoA,\
    \ nCoA]\n             |    based on nCoA over the PHT]   |         |        |\n\
    \             |<<=======+================================>+--->...  |\n      \
    \       .         .      .       .         .         .        .\n            \
    \ .         .      .       .         .         .        .\n             .    \
    \     .      .       .         .         .        .\n                Figure 3:\
    \ Example Communication Flow (1/2)\n             |         |      |       |  \
    \       |         |        |\n   +----------------+  |      |       |        \
    \ |         |        |\n   |(4) Completion  |  |      |       |         |    \
    \     |        |\n   |of MMP BU and   |  |      |       |         |         |\
    \        |\n   |ready to switch |  |      |       |         |         |      \
    \  |\n   +----------------+  |      |       |         |         |        |\n \
    \            |   Secure proactive handover pre-switching phase     |\n       \
    \      |   [tunnel management protocol to delete PHT]        V\n             |<--------+--------------------------------->|\n\
    \    +---------------+         |       |         |         |\n    |(5)Switching\
    \   |         |       |         |         |\n    +---------------+         | \
    \      |         |         |\n             |                |       |        \
    \ |         |\n    +---------------+         |       |         |         |\n \
    \   |(6) Completion |         |       |         |         |\n    |of switching\
    \   |         |       |         |         |\n    +---------------+         | \
    \      |         |         |\n             o<- Secure proactive handover post-switching\
    \ phase ^\n             |   [Re-assignment of Tunnel Inner Address   |       \
    \ |\n             |                 to the physical I/F]       |        |\n  \
    \           |                |       |         |         |        |\n        \
    \     |   Transmission of data packets through AR  |     [nCoA]\n            \
    \ |   based on nCoA|       |         |         |        |\n             |<---------------+---------------------------+-->...\
    \  |\n             |                |       |         |         |        .\n \
    \               Figure 4: Example Communication Flow (2/2)\n"
- title: 7.  MPA Operations
  contents:
  - "7.  MPA Operations\n   In order to provide an optimized handover for a mobile\
    \ node\n   experiencing rapid movement between subnets and/or domains, one needs\n\
    \   to look into several operations.  These issues include:\n      i) discovery\
    \ of neighboring networking elements,\n      ii) connecting to the right network\
    \ based on certain policy,\n      iii) changing the layer 2 point of attachment,\n\
    \      iv) obtaining an IP address from a DHCP or PPP server,\n      v) confirming\
    \ the uniqueness of the IP address,\n      vi) pre-authenticating with the authentication\
    \ agent,\n      vii) sending the binding update to the Correspondent Host (CH),\n\
    \      viii) obtaining the redirected streaming traffic to the new point\n   \
    \   of attachment,\n      ix) ping-pong effect, and\n      x) probability of moving\
    \ to more than one network and associating\n      with multiple target networks.\n\
    \   We describe these issues in detail in the following paragraphs and\n   describe\
    \ how we have optimized these issues in the case of MPA-based\n   secure proactive\
    \ handover.\n"
- title: 7.1.  Discovery
  contents:
  - "7.1.  Discovery\n   Discovery of neighboring networking elements such as access\
    \ points,\n   access routers, and authentication servers helps expedite the\n\
    \   handover process during a mobile node's movement between networks.\n   After\
    \ discovering the network neighborhood with a desired set of\n   coordinates,\
    \ capabilities, and parameters, the mobile node can\n   perform many of the operations,\
    \ such as pre-authentication, proactive\n   IP address acquisition, proactive\
    \ address resolution, and binding\n   update, while in the previous network.\n\
    \   There are several ways a mobile node can discover neighboring\n   networks.\
    \  The Candidate Access Router Discovery protocol [RFC4066]\n   helps discover\
    \ the candidate access routers in the neighboring\n   networks.  Given a certain\
    \ network domain, SLP (Service Location\n   Protocol) [RFC2608] and DNS help provide\
    \ addresses of the networking\n   components for a given set of services in the\
    \ specific domain.  In\n   some cases, many of the network-layer and upper-layer\
    \ parameters may\n   be sent over link-layer management frames, such as beacons,\
    \ when the\n   mobile node approaches the vicinity of the neighboring networks.\n\
    \   IEEE 802.11u is considering issues such as discovering the\n   neighborhood\
    \ using information contained in the link layer.  However,\n   if the link-layer\
    \ management frames are encrypted by some link-layer\n   security mechanism, then\
    \ the mobile node may not be able to obtain\n   the requisite information before\
    \ establishing link-layer connectivity\n   to the access point.  In addition,\
    \ this may add burden to the\n   bandwidth-constrained wireless medium.  In such\
    \ cases, a higher-layer\n   protocol is preferred to obtain the information regarding\
    \ the\n   neighboring elements.  Some proposals, such as [802.21], help obtain\n\
    \   information about the neighboring networks from a mobility server.\n   When\
    \ the movement is imminent, the mobile node starts the discovery\n   process by\
    \ querying a specific server and obtains the required\n   parameters, such as\
    \ the IP address of the access point, its\n   characteristics, routers, SIP servers,\
    \ or authentication servers of\n   the neighboring networks.  In the event of\
    \ multiple networks, it may\n   obtain the required parameters from more than\
    \ one neighboring network\n   and keep these in a cache.  At some point, the mobile\
    \ node finds\n   several CTNs out of many probable networks and starts the pre-\n\
    \   authentication process by communicating with the required entities in\n  \
    \ the CTNs.  Further details of this scenario are in Section 7.2.\n"
- title: 7.2.  Pre-Authentication in Multiple-CTN Environment
  contents:
  - "7.2.  Pre-Authentication in Multiple-CTN Environment\n   In some cases, although\
    \ a mobile node selects a specific network to\n   be the target network, it may\
    \ actually end up moving into a\n   neighboring network other than the target\
    \ network, due to factors\n   that are beyond the mobile node's control.  Thus,\
    \ it may be useful to\n   perform the pre-authentication with a few probable candidate\
    \ target\n   networks and establish time-bound transient tunnels with the\n  \
    \ respective access routers in those networks.  Thus, in the event of a\n   mobile\
    \ node moving to a candidate target network other than that\n   chosen as the\
    \ target network, it will not be subjected to packet loss\n   due to authentication\
    \ and IP address acquisition delay that could\n   occur if the mobile node did\
    \ not pre-authenticate with that candidate\n   target network.  It may appear\
    \ that by pre-authenticating with a\n   number of candidate target networks and\
    \ reserving the IP addresses,\n   the mobile node is reserving resources that\
    \ could be used otherwise.\n   But since this happens for a time-limited period,\
    \ it should not be a\n   big problem; it depends upon the mobility pattern and\
    \ duration.  The\n   mobile node uses a pre-authentication procedure to obtain\
    \ an IP\n   address proactively and to set up the time-bound tunnels with the\n\
    \   access routers of the candidate target networks.  Also, the MN may\n   retain\
    \ some or all of the nCoAs for future movement.\n   The mobile node may choose\
    \ one of these addresses as the binding\n   update address and send it to the\
    \ CN (Correspondent Node) or HA (Home\n   Agent), and will thus receive the tunneled\
    \ traffic via the target\n   network while in the previous network.  But in some\
    \ instances, the\n   mobile node may eventually end up moving to a network that\
    \ is other\n   than the target network.  Thus, there will be a disruption in traffic\n\
    \   as the mobile node moves to the new network, since the mobile node\n   has\
    \ to go through the process of assigning the new IP address and\n   sending the\
    \ binding update again.  There are two solutions to this\n   problem.  As one\
    \ solution to the problem, the mobile node can take\n   advantage of the simultaneous\
    \ mobility binding and send multiple\n   binding updates to the Correspondent\
    \ Host or HA.  Thus, the\n   Correspondent Host or HA forwards the traffic to\
    \ multiple IP\n   addresses assigned to the virtual interfaces for a specific\
    \ period of\n   time.  This binding update gets refreshed at the CH after the\
    \ mobile\n   node moves to the new network, thus stopping the flow to the other\n\
    \   candidate networks.  RFC 5648 [RFC5648] discusses different scenarios\n  \
    \ of mobility binding with multiple care-of-addresses.  As the second\n   solution,\
    \ in case simultaneous binding is not supported in a specific\n   mobility scheme,\
    \ forwarding of traffic from the previous target\n   network will help take care\
    \ of the transient traffic until the new\n   binding update is sent from the new\
    \ network.\n"
- title: 7.3.  Proactive IP Address Acquisition
  contents:
  - "7.3.  Proactive IP Address Acquisition\n   In general, a mobility management\
    \ protocol works in conjunction with\n   the Foreign Agent or in the co-located\
    \ address mode.  The MPA\n   approach can use both the co-located address mode\
    \ and the Foreign\n   Agent address mode.  We discuss here the address assignment\
    \ component\n   that is used in the co-located address mode.  There are several\
    \ ways\n   a mobile node can obtain an IP address and configure itself.  In some\n\
    \   cases, a mobile node can configure itself statically in the absence\n   of\
    \ any configuration element such as a server or router in the\n   network.  In\
    \ a LAN environment, the mobile node can obtain an IP\n   address from DHCP servers.\
    \  In the case of IPv6 networks, a mobile\n   node has the option of obtaining\
    \ the IP address using stateless\n   autoconfiguration or DHCPv6.  In some wide-area\
    \ networking\n   environments, the mobile node uses PPP (Point-to-Point Protocol)\
    \ to\n   obtain the IP address by communicating with a NAS (Network Access\n \
    \  Server).\n   Each of these processes takes on the order of few hundred\n  \
    \ milliseconds to a few seconds, depending upon the type of IP address\n   acquisition\
    \ process and operating system of the clients and servers.\n   Since IP address\
    \ acquisition is part of the handover process, it adds\n   to the handover delay,\
    \ and thus it is desirable to reduce this delay\n   as much as possible.  There\
    \ are a few optimized techniques available,\n   such as DHCP Rapid Commit [RFC4039]\
    \ and GPS-coordinate-based IP\n   address [GPSIP], that attempt to reduce the\
    \ handover delay due to IP\n   address acquisition time.  However, in all these\
    \ cases, the mobile\n   node also obtains the IP address after it moves to the\
    \ new subnet and\n   incurs some delay because of the signaling handshake between\
    \ the\n   mobile node and the DHCP server.\n   In Fast MIPv6 [RFC5568], through\
    \ the RtSolPr and PrRtAdv messages,\n   the MN also formulates a prospective new\
    \ CoA (nCoA) when it is still\n   present on the Previous Access Router's (pAR's)\
    \ link.  Hence, the\n   latency due to new prefix discovery subsequent to handover\
    \ is\n   eliminated.  However, in this case, both the pAR and the Next Access\n\
    \   Router (nAR) need to cooperate with each other to be able to retrieve\n  \
    \ the prefix from the target network.\n   In the following paragraph, we describe\
    \ a few ways that a mobile node\n   can obtain the IP address proactively from\
    \ the CTN, and the\n   associated tunnel setup procedure.  These can broadly be\
    \ divided into\n   four categories: PANA-assisted proactive IP address acquisition,\n\
    \   IKE-assisted proactive IP address acquisition, proactive IP address\n   acquisition\
    \ using DHCP only, and stateless autoconfiguration.  When\n   DHCP is used for\
    \ address configuration, a DHCP server is assumed to\n   be serving one subnet.\n"
- title: 7.3.1.  PANA-Assisted Proactive IP Address Acquisition
  contents:
  - "7.3.1.  PANA-Assisted Proactive IP Address Acquisition\n   In the case of PANA-assisted\
    \ proactive IP address acquisition, the\n   mobile node obtains an IP address\
    \ proactively from a CTN.  The mobile\n   node makes use of PANA [RFC5191] messages\
    \ to trigger the IP address\n   acquisition process via a DHCP client that is\
    \ co-located with the\n   PANA authentication agent in the access router in the\
    \ CTN acting on\n   behalf of the mobile node.  Upon receiving a PANA message\
    \ from the\n   mobile node, the DHCP client on the authentication agent performs\n\
    \   normal DHCP message exchanges to obtain the IP address from the DHCP\n   server\
    \ in the CTN.  This address is piggy-backed in a PANA message\n   and is delivered\
    \ to the mobile node.  In the case of IPv6, a Router\n   Advertisement (RA) is\
    \ carried as part of the PANA message.  In the\n   case of stateless autoconfiguration,\
    \ the mobile node uses the\n   prefix(es) obtained as part of the RA and its MAC\
    \ address to\n   construct the unique IPv6 address(es) as it would have done in\
    \ the\n   new network.  In the case of stateful address autoconfiguration, a\n\
    \   procedure similar to DHCPv4 can be applied.\n"
- title: 7.3.2.  IKEv2-Assisted Proactive IP Address Acquisition
  contents:
  - "7.3.2.  IKEv2-Assisted Proactive IP Address Acquisition\n   IKEv2-assisted proactive\
    \ IP address acquisition works when an IPsec\n   gateway and a DHCP relay agent\
    \ [RFC3046] are resident within each\n   access router in the CTN.  In this case,\
    \ the IPsec gateway and DHCP\n   relay agent in a CTN help the mobile node acquire\
    \ the IP address from\n   the DHCP server in the CTN.  The MN-AR key established\
    \ during the\n   pre-authentication phase is used as the IKEv2 pre-shared secret\n\
    \   needed to run IKEv2 between the mobile node and the access router.\n   The\
    \ IP address from the CTN is obtained as part of the standard IKEv2\n   procedure,\
    \ using the co-located DHCP relay agent for obtaining the IP\n   address from\
    \ the DHCP server in the target network using standard\n   DHCP.  The obtained\
    \ IP address is sent back to the client in the\n   IKEv2 Configuration Payload\
    \ exchange.  In this case, IKEv2 is also\n   used as the tunnel management protocol\
    \ for a proactive handover\n   tunnel (see Section 7.4).  Alternatively, a VPN\
    \ gateway can dispense\n   the IP address from its IP address pool.\n"
- title: 7.3.3.  Proactive IP Address Acquisition Using DHCPv4 Only
  contents:
  - "7.3.3.  Proactive IP Address Acquisition Using DHCPv4 Only\n   As another alternative,\
    \ DHCP may be used for proactively obtaining an\n   IP address from a CTN without\
    \ relying on PANA or IKEv2-based\n   approaches by allowing direct DHCP communication\
    \ between the mobile\n   node and the DHCP relay agent or DHCP server in the CTN.\
    \  The\n   mechanism described in this section is applicable to DHCPv4 only.\n\
    \   The mobile node sends a unicast DHCP message to the DHCP relay agent\n   or\
    \ DHCP server in the CTN requesting an address, while using the\n   address associated\
    \ with the current physical interface as the source\n   address of the request.\n\
    \   When the message is sent to the DHCP relay agent, the DHCP relay\n   agent\
    \ relays the DHCP messages back and forth between the mobile node\n   and the\
    \ DHCP server.  In the absence of a DHCP relay agent, the\n   mobile node can\
    \ also directly communicate with the DHCP server in the\n   target network.  The\
    \ broadcast option in the client's unicast\n   DISCOVER message should be set\
    \ to 0 so that the relay agent or the\n   DHCP server can send the reply directly\
    \ back to the mobile node using\n   the mobile node's source address.\n   In order\
    \ to prevent malicious nodes from obtaining an IP address from\n   the DHCP server,\
    \ DHCP authentication should be used, or the access\n   router should be configured\
    \ with a filter to block unicast DHCP\n   messages sent to the remote DHCP server\
    \ from mobile nodes that are\n   not pre-authenticated.  When DHCP authentication\
    \ is used, the DHCP\n   authentication key may be derived from the MPA-SA established\
    \ between\n   the mobile node and the authentication agent in the candidate target\n\
    \   network.\n   The proactively obtained IP address is not assigned to the mobile\n\
    \   node's physical interface until the mobile node has moved to the new\n   network.\
    \  The IP address thus obtained proactively from the target\n   network should\
    \ not be assigned to the physical interface but rather\n   to a virtual interface\
    \ of the client.  Thus, such a proactively\n   acquired IP address via direct\
    \ DHCP communication between the mobile\n   node and the DHCP relay agent or the\
    \ DHCP server in the CTN may be\n   carried with additional information that is\
    \ used to distinguish it\n   from other addresses as assigned to the physical\
    \ interface.\n   Upon the mobile node's entry to the new network, the mobile node\
    \ can\n   perform DHCP over the physical interface to the new network to get\n\
    \   other configuration parameters, such as the SIP server or DNS server,\n  \
    \ by using DHCP INFORM.  This should not affect the ongoing\n   communication\
    \ between the mobile node and Correspondent Host.  Also,\n   the mobile node can\
    \ perform DHCP over the physical interface to the\n   new network to extend the\
    \ lease of the address that was proactively\n   obtained before entering the new\
    \ network.\n   In order to maintain the DHCP binding for the mobile node and keep\n\
    \   track of the dispensed IP address before and after the secure\n   proactive\
    \ handover, the same DHCP client identifier needs to be used\n   for the mobile\
    \ node for both DHCP for proactive IP address\n   acquisition and for DHCP performed\
    \ after the mobile node enters the\n   target network.  The DHCP client identifier\
    \ may be the MAC address of\n   the mobile node or some other identifier.\n"
- title: 7.3.4.  Proactive IP Address Acquisition Using Stateless
  contents:
  - "7.3.4.  Proactive IP Address Acquisition Using Stateless\n        Autoconfiguration\n\
    \   For IPv6, a network address is configured either using DHCPv6 or\n   stateless\
    \ autoconfiguration.  In order to obtain the new IP address\n   proactively, the\
    \ router advertisement of the next-hop router can be\n   sent over the established\
    \ tunnel, and a new IPv6 address is generated\n   based on the prefix and MAC\
    \ address of the mobile node.  Generating a\n   CoA from the new network will\
    \ avoid the time needed to obtain an IP\n   address and perform Duplicate Address\
    \ Detection.\n   Duplicate Address Detection and address resolution are part of\
    \ the IP\n   address acquisition process.  As part of the proactive configuration,\n\
    \   these two processes can be done ahead of time.  Details of how these\n   two\
    \ processes can be done proactively are described in Appendix A and\n   Appendix\
    \ B, respectively.\n   In the case of stateless autoconfiguration, the mobile\
    \ node checks to\n   see the prefix of the router advertisement in the new network\
    \ and\n   matches it with the prefix of the newly assigned IP address.  If\n \
    \  these turn out to be the same, then the mobile node does not go\n   through\
    \ the IP address acquisition phase again.\n"
- title: 7.4.  Tunnel Management
  contents:
  - "7.4.  Tunnel Management\n   After an IP address is proactively acquired from\
    \ the DHCP server in a\n   CTN, or via stateless autoconfiguration in the case\
    \ of IPv6, a\n   proactive handover tunnel is established between the mobile node\
    \ and\n   the access router in the CTN.  The mobile node uses the acquired IP\n\
    \   address as the tunnel's inner address.\n   There are several reasons why this\
    \ transient tunnel is established\n   between the nAR and the mobile node in the\
    \ old PoA, unlike the\n   transient tunnel in FMIPv6 (Fast MIPv6) [RFC5568], where\
    \ it is set up\n   between the mobile node's new point of attachment and the old\
    \ access\n   router.\n   In the case of inter-domain handoff, it is important\
    \ that any\n   signaling message between the nPoA and the mobile node needs to\
    \ be\n   secured.  This transient secured tunnel provides the desired\n   functionality,\
    \ including securing the proactive binding update and\n   transient data between\
    \ the end-points before the handover has taken\n   place.  Unlike the proactive\
    \ mode of FMIPv6, transient handover\n   packets are not sent to the pAR, and\
    \ thus a tunnel between the mobile\n   node's new point of attachment and the\
    \ old access router is not\n   needed.\n   In the case of inter-domain handoff,\
    \ the pAR and nAR could logically\n   be far from each other.  Thus, the signaling\
    \ and data during the\n   pre-authentication period will take a longer route,\
    \ and thus may be\n   subjected to longer one-way delay.  Hence, MPA provides\
    \ a tradeoff\n   between larger packet loss or larger one-way packet delay for\
    \ a\n   transient period, when the mobile node is preparing for handoff.\n   The\
    \ proactive handover tunnel is established using a tunnel\n   management protocol.\
    \  When IKEv2 is used for proactive IP address\n   acquisition, IKEv2 is also\
    \ used as the tunnel management protocol.\n   Alternatively, when PANA is used\
    \ for proactive IP address\n   acquisition, PANA may be used as the secure tunnel\
    \ management\n   protocol.\n   Once the proactive handover tunnel is established\
    \ between the mobile\n   node and the access router in the candidate target network,\
    \ the\n   access router also needs to perform proxy address resolution (Proxy\n\
    \   ARP) on behalf of the mobile node so that it can capture any packets\n   destined\
    \ to the mobile node's new address.\n   Since the mobile node needs to be able\
    \ to communicate with the\n   Correspondent Node while in the previous network,\
    \ some or all parts\n   of the binding update and data from the Correspondent\
    \ Node to the\n   mobile node need to be sent back to the mobile node over a proactive\n\
    \   handover tunnel.  Details of these binding update procedures are\n   described\
    \ in Section 7.5.\n   In order for the traffic to be directed to the mobile node\
    \ after the\n   mobile node attaches to the target network, the proactive handover\n\
    \   tunnel needs to be deleted or disabled.  The tunnel management\n   protocol\
    \ used for establishing the tunnel is used for this purpose.\n   Alternatively,\
    \ when PANA is used as the authentication protocol, the\n   tunnel deletion or\
    \ disabling at the access router can be triggered by\n   means of the PANA update\
    \ mechanism as soon as the mobile node moves\n   to the target network.  A link-layer\
    \ trigger ensures that the mobile\n   node is indeed connected to the target network\
    \ and can also be used\n   as the trigger to delete or disable the tunnel.  A\
    \ tunnel management\n   protocol also triggers the router advertisement (RA) from\
    \ the next\n   access router to be sent over the tunnel, as soon as the tunnel\n\
    \   creation is complete.\n"
- title: 7.5.  Binding Update
  contents:
  - "7.5.  Binding Update\n   There are several kinds of binding update mechanisms\
    \ for different\n   mobility management schemes.\n   In the case of Mobile IPv4\
    \ and Mobile IPv6, the mobile node performs\n   a binding update with the Home\
    \ Agent only, if route optimization is\n   not used.  Otherwise, the mobile node\
    \ performs the binding update\n   with both the Home Agent (HA) and Correspondent\
    \ Node (CN).\n   In the case of SIP-based terminal mobility, the mobile node sends\
    \ a\n   binding update using an INVITE to the Correspondent Node and a\n   REGISTER\
    \ message to the Registrar.  Based on the distance between the\n   mobile node\
    \ and the Correspondent Node, the binding update may\n   contribute to the handover\
    \ delay.  SIP-fast handover [SIPFAST]\n   provides several ways of reducing the\
    \ handover delay due to binding\n   update.  In the case of secure proactive handover\
    \ using SIP-based\n   mobility management, we do not encounter the delay due to\
    \ the binding\n   update at all, as it takes place in the previous network.\n\
    \   Thus, this proactive binding update scheme looks more attractive when\n  \
    \ the Correspondent Node is too far from the communicating mobile node.\n   Similarly,\
    \ in the case of Mobile IPv6, the mobile node sends the\n   newly acquired CoA\
    \ from the target network as the binding update to\n   the HA and CN.  Also, all\
    \ signaling messages between the MN and HA\n   and between the MN and CN are passed\
    \ through this proactive tunnel\n   that is set up.  These messages include Binding\
    \ Update (BU); Binding\n   Acknowledgement (BA); and the associated return routability\
    \ messages,\n   such as Home Test Init (HoTI), Home Test (HoT), Care-of Test Init\n\
    \   (CoTI), and Care-of Test (CoT).  In Mobile IPv6, since the receipt of\n  \
    \ an on-link router advertisement is mandatory for the mobile node to\n   detect\
    \ the movement and trigger the binding update, a router\n   advertisement from\
    \ the next access router needs to be advertised over\n   the tunnel.  By proper\
    \ configuration on the nAR, the router\n   advertisement can be sent over the\
    \ tunnel interface to trigger the\n   proactive binding update.  The mobile node\
    \ also needs to make the\n   tunnel interface the active interface, so that it\
    \ can send the\n   binding update using this interface as soon as it receives\
    \ the router\n   advertisement.\n   If the proactive handover tunnel is realized\
    \ as an IPsec tunnel, it\n   will also protect these signaling messages between\
    \ the tunnel end-\n   points and will make the return routability test secured\
    \ as well.\n   Any subsequent data will also be tunneled through, as long as the\n\
    \   mobile node is in the previous network.  The accompanying document\n   [MPA-WIRELESS]\
    \ talks about the details of how binding updates and\n   signaling for return\
    \ routability are sent over the secured tunnel.\n"
- title: 7.6.  Preventing Packet Loss
  contents:
  - "7.6.  Preventing Packet Loss\n   In the MPA case, packet loss due to IP address\
    \ acquisition, secured\n   authentication, and binding update does not occur.\
    \  However,\n   transient packets during link-layer handover can be lost.  Possible\n\
    \   scenarios of packet loss and its prevention are described below.\n"
- title: 7.6.1.  Packet Loss Prevention in Single-Interface MPA
  contents:
  - "7.6.1.  Packet Loss Prevention in Single-Interface MPA\n   For single-interface\
    \ MPA, there may be some transient packets during\n   link-layer handover that\
    \ are directed to the mobile node at the old\n   point of attachment before the\
    \ mobile node is able to attach to the\n   target network.  Those transient packets\
    \ can be lost.  Buffering\n   these packets at the access router of the old point\
    \ of attachment can\n   eliminate packet loss.  Dynamic buffering signals from\
    \ the MN can\n   temporarily hold transient traffic during handover, and then\
    \ these\n   packets can be forwarded to the MN once it attaches to the target\n\
    \   network.  A detailed analysis of the buffering technique can be found\n  \
    \ in [PIMRC06].\n   An alternative method is to use bicasting.  Bicasting helps\
    \ to\n   forward the traffic to two destinations at the same time.  However,\n\
    \   it does not eliminate packet loss if link-layer handover is not\n   seamlessly\
    \ performed.  On the other hand, buffering does not reduce\n   packet delay. \
    \ While packet delay can be compensated by a playout\n   buffer at the receiver\
    \ side for a streaming application, a playout\n   buffer does not help much for\
    \ interactive VoIP applications that\n   cannot tolerate large delay jitters.\
    \  Thus, it is still important to\n   optimize the link-layer handover anyway.\n"
- title: 7.6.2.  Preventing Packet Losses for Multiple Interfaces
  contents:
  - "7.6.2.  Preventing Packet Losses for Multiple Interfaces\n   MPA usage in multi-interface\
    \ handover scenarios involves preparing\n   the second interface for use via the\
    \ current active interface.  This\n   preparation involves pre-authentication\
    \ and provisioning at a target\n   network where the second interface would be\
    \ the eventual active\n   interface.  For example, during inter-technology handover\
    \ from a WiFi\n   to a CDMA network, pre-authentication at the CDMA network can\
    \ be\n   performed via the WiFi interface.  The actual handover occurs when\n\
    \   the CDMA interface becomes the active interface for the MN.\n   In such scenarios,\
    \ if handover occurs while both interfaces are\n   active, there is generally\
    \ no packet loss, since transient packets\n   directed towards the old interface\
    \ will still reach the MN.  However,\n   if sudden disconnection of the current\
    \ active interface is used to\n   initiate handover to the prepared interface,\
    \ then transient packets\n   for the disconnected interface will be lost while\
    \ the MN attempts to\n   be reachable at the prepared interface.  In such cases,\
    \ a specialized\n   form of buffering can be used to eliminate packet loss where\
    \ packets\n   are merely copied at an access router in the current active network\n\
    \   prior to disconnection.  If sudden disconnection does occur, copied\n   packets\
    \ can be forwarded to the MN once the prepared interface\n   becomes the active\
    \ reachable interface.  The copy-and-forward\n   mechanism is not limited to multi-interface\
    \ handover.\n   A notable side-effect of this process is the possible duplication\
    \ of\n   packets during forwarding to the new active interface.  Several\n   approaches\
    \ can be employed to minimize this effect.  Relying on\n   upper-layer protocols\
    \ such as TCP to detect and eliminate duplicates\n   is the most common approach.\
    \  Customized duplicate detection and\n   handling techniques can also be used.\
    \  In general, packet duplication\n   is a well-known issue that can also be handled\
    \ locally by the MN.\n   If the mobile node takes a longer amount of time to detect\
    \ the\n   disconnection event of the current active interface, this can also\n\
    \   have an adverse effect on the length of the handover process.  Thus,\n   it\
    \ becomes necessary to use an optimized scheme of detecting\n   interface disconnection\
    \ in such scenarios.  Use of the current\n   interface to perform pre-authentication\
    \ instead of the new interface\n   is desirable in certain circumstances, such\
    \ as to save battery power,\n   or in cases where the adjacent cells (e.g., WiFi\
    \ or CDMA) are\n   non-overlapping, or in cases when the carrier does not allow\
    \ the\n   simultaneous use of both interfaces.  However, in certain\n   circumstances,\
    \ depending upon the type of target network, only parts\n   of MPA operations\
    \ can be performed (e.g., pre-authentication,\n   pre-configuration, or proactive\
    \ binding update).  In a specific\n   scenario involving handoff between WiFi\
    \ and CDMA networks, some of\n   the PPP context can be set up during the pre-authentication\
    \ period,\n   thus reducing the time for PPP activation.\n"
- title: 7.6.3.  Reachability Test
  contents:
  - "7.6.3.  Reachability Test\n   In addition to previous techniques, the MN may\
    \ also want to ensure\n   reachability of the new point of attachment before switching\
    \ from the\n   old one.  This can be done by exchanging link-layer management\
    \ frames\n   with the new point of attachment.  This reachability check should\
    \ be\n   performed as quickly as possible.  In order to prevent packet loss\n\
    \   during this reachability check, transmission of packets over the link\n  \
    \ between the MN and the old point of attachment should be suspended by\n   buffering\
    \ the packets at both ends of the link during the\n   reachability check.  How\
    \ to perform this buffering is out of scope of\n   this document.  Some of the\
    \ results of using this buffering scheme\n   are explained in the accompanying\
    \ document [MPA-WIRELESS].\n"
- title: 7.7.  Security and Mobility
  contents:
  - "7.7.  Security and Mobility\n   This section describes how MPA can help establish\
    \ layer 2 and layer 3\n   security association in the target networks while the\
    \ mobile node is\n   in the previous network.\n"
- title: 7.7.1.  Link-Layer Security and Mobility
  contents:
  - "7.7.1.  Link-Layer Security and Mobility\n   Using the MPA-SA established between\
    \ the mobile node and the\n   authentication agent for a CTN, during the pre-authentication\
    \ phase,\n   it is possible to bootstrap link-layer security in the CTN while\
    \ the\n   mobile node is in the current network, as described in the following\n\
    \   steps.  Figure 5 shows the sequence of operation.\n   (1)  The authentication\
    \ agent and the mobile node derive a PMK (Pair-\n        wise Master Key) [RFC5247]\
    \ using the MPA-SA that is established\n        as a result of successful pre-authentication.\
    \  Successful\n        operation of EAP and a AAA protocol may be involved during\n\
    \        pre-authentication to establish the MPA-SA.  From the PMK,\n        distinct\
    \ TSKs (Transient Session Keys) [RFC5247] for the mobile\n        node are directly\
    \ or indirectly derived for each point of\n        attachment of the CTN.\n  \
    \ (2)  The authentication agent may install the keys derived from the\n      \
    \  PMK and used for secure association to points of attachment.\n        The derived\
    \ keys may be TSKs or intermediary keys from which\n        TSKs are derived.\n\
    \   (3)  After the mobile node chooses a CTN as the target network and\n     \
    \   switches to a point of attachment in the target network (which\n        now\
    \ becomes the new network for the mobile node), it executes a\n        secure\
    \ association protocol such as the IEEE 802.11i 4-way\n        handshake [802.11],\
    \ using the PMK in order to establish PTKs\n        (Pair-wise Transient Keys)\
    \ and group keys [RFC5247] used for\n        protecting link-layer packets between\
    \ the mobile node and the\n        point of attachment.  No additional execution\
    \ of EAP\n        authentication is needed here.\n   (4)  While the mobile node\
    \ is roaming in the new network, the mobile\n        node only needs to perform\
    \ a secure association protocol with\n        its point of attachment, and no\
    \ additional execution of EAP\n        authentication is needed either.  Integration\
    \ of MPA with link-\n        layer handover optimization mechanisms such as 802.11r\
    \ can be\n        archived this way.\n   The mobile node may need to know the\
    \ link-layer identities of the\n   points of attachment in the CTN to derive TSKs.\n\
    \          _________________        ____________________________\n         | Current\
    \ Network |      |           CTN              |\n         |   ____          |\
    \      |                 ____       |\n         |  |    |      (1) pre-authentication\
    \     |    |      |\n         |  | MN |<------------------------------->| AA |\
    \      |\n         |  |____|         |      |                |____|      |\n \
    \        |    .            |      |                  |         |\n         | \
    \   .            |      |                  |         |\n         |____.____________|\
    \      |                  |         |\n              .movement           |   \
    \               |(2) Keys |\n          ____.___________________|             \
    \     |         |\n         |   _v__                      _____         |    \
    \     |\n         |  |    |(3) secure assoc.   |     |        |         |\n  \
    \       |  | MN |<------------------>| AP1 |<-------+         |\n         |  |____|\
    \                    |_____|        |         |\n         |    .             \
    \                         |         |\n         |    .movement               \
    \               |         |\n         |    .                                 \
    \     |         |\n         |    .                                      |    \
    \     |\n         |   _v__                      _____         |         |\n  \
    \       |  |    |(4) secure assoc.   |     |        |         |\n         |  |\
    \ MN |<------------------>| AP2 |<-------+         |\n         |  |____|     \
    \               |_____|                  |\n         |_____________________________________________________|\n\
    \                Figure 5: Bootstrapping Link-Layer Security\n"
- title: 7.7.2.  IP-Layer Security and Mobility
  contents:
  - "7.7.2.  IP-Layer Security and Mobility\n   IP-layer security is typically maintained\
    \ between the mobile node and\n   the first-hop router, or any other network element\
    \ such as SIP proxy\n   by means of IPsec.  This IPsec SA can be set up either\
    \ in tunnel mode\n   or in ESP mode.  However, as the mobile node moves, the IP\
    \ address of\n   the router and outbound proxy will change in the new network.\
    \  The\n   mobile node's IP address may or may not change, depending upon the\n\
    \   mobility protocol being used.  This will warrant re-establishing a\n   new\
    \ security association between the mobile node and the desired\n   network entity.\
    \  In some cases, such as in a 3GPP/3GPP2 IMS/MMD\n   environment, data traffic\
    \ is not allowed to pass through unless there\n   is an IPsec SA established between\
    \ the mobile node and outbound\n   proxy.  This will of course add unreasonable\
    \ delay to the existing\n   real-time communication during a mobile node's movement.\
    \  In this\n   scenario, key exchange is done as part of a SIP registration that\n\
    \   follows a key exchange procedure called AKA (Authentication and Key\n   Agreement).\n\
    \   MPA can be used to bootstrap this security association as part of\n   pre-authentication\
    \ via the new outbound proxy.  Prior to the\n   movement, if the mobile node can\
    \ pre-register via the new outbound\n   proxy in the target network and completes\
    \ the pre-authentication\n   procedure, then the new SA state between the mobile\
    \ node and new\n   outbound proxy can be established prior to the movement to\
    \ the new\n   network.  A similar approach can also be applied if a key exchange\n\
    \   mechanism other than AKA is used or the network element with which\n   the\
    \ security association has to be established is different than an\n   outbound\
    \ proxy.\n   By having the security association established ahead of time, the\n\
    \   mobile node does not need to be involved in any exchange to set up\n   the\
    \ new security association after the movement.  Any further key\n   exchange will\
    \ be limited to renew the expiry time.  This will reduce\n   the delay for real-time\
    \ communication as well.\n"
- title: 7.8.  Authentication in Initial Network Attachment
  contents:
  - "7.8.  Authentication in Initial Network Attachment\n   When the mobile node initially\
    \ attaches to a network, network access\n   authentication would occur regardless\
    \ of the use of MPA.  The\n   protocol used for network access authentication\
    \ when MPA is used for\n   handover optimization can be a link-layer network access\n\
    \   authentication protocol such as IEEE 802.1X, or a higher-layer\n   network\
    \ access authentication protocol such as PANA.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   This document describes a framework for a secure\
    \ handover\n   optimization mechanism based on performing handover-related signaling\n\
    \   between a mobile node and one or more candidate target networks to\n   which\
    \ the mobile node may move in the future.  This framework\n   involves acquisition\
    \ of the resources from the CTN as well as data\n   packet redirection from the\
    \ CTN to the mobile node in the current\n   network before the mobile node physically\
    \ connects to one of those\n   CTNs.\n   Acquisition of the resources from the\
    \ candidate target networks must\n   be done with appropriate authentication and\
    \ authorization procedures\n   in order to prevent an unauthorized mobile node\
    \ from obtaining the\n   resources.  For this reason, it is important for the\
    \ MPA framework to\n   perform pre-authentication between the mobile node and\
    \ the candidate\n   target networks.  The MN-CA key and the MN-AR key generated\
    \ as a\n   result of successful pre-authentication can protect subsequent\n  \
    \ handover signaling packets and data packets exchanged between the\n   mobile\
    \ node and the MPA functional elements in the CTNs.\n   The MPA framework also\
    \ addresses security issues when the handover is\n   performed across multiple\
    \ administrative domains.  With MPA, it is\n   possible for handover signaling\
    \ to be performed based on direct\n   communication between the mobile node and\
    \ routers or mobility agents\n   in the candidate target networks.  This eliminates\
    \ the need for a\n   context transfer protocol [RFC5247] for which known limitations\
    \ exist\n   in terms of security and authorization.  For this reason, the MPA\n\
    \   framework does not require trust relationships among administrative\n   domains\
    \ or access routers, which makes the framework more deployable\n   in the Internet\
    \ without compromising the security in mobile\n   environments.\n"
- title: 9.  Acknowledgments
  contents:
  - "9.  Acknowledgments\n   We would like to thank Farooq Anjum and Raziq Yaqub for\
    \ their review\n   of this document, and Subir Das for standardization support\
    \ in the\n   IEEE 802.21 working group.\n   The authors would like to acknowledge\
    \ Christian Vogt, Rajeev Koodli,\n   Marco Liebsch, Juergen Schoenwaelder, and\
    \ Charles Perkins for their\n   thorough review of the document and useful feedback.\n\
    \   Author and Editor Ashutosh Dutta would like to thank Telcordia\n   Technologies,\
    \ and author Victor Fajardo would like to thank Toshiba\n   America Research and\
    \ Telcordia Technologies, for supporting the\n   development of their document\
    \ while they were employed in their\n   respective organizations.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC5944]  Perkins, C., Ed., \"IP Mobility Support\
    \ for IPv4, Revised\",\n              RFC 5944, November 2010.\n   [RFC3748] \
    \ Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.\n              Levkowetz,\
    \ Ed., \"Extensible Authentication Protocol\n              (EAP)\", RFC 3748,\
    \ June 2004.\n   [RFC3775]  Johnson, D., Perkins, C., and J. Arkko, \"Mobility\
    \ Support\n              in IPv6\", RFC 3775, June 2004.\n   [RFC2205]  Braden,\
    \ R., Ed., Zhang, L., Berson, S., Herzog, S., and S.\n              Jamin, \"\
    Resource ReSerVation Protocol (RSVP) -- Version 1\n              Functional Specification\"\
    , RFC 2205, September 1997.\n   [RFC5380]  Soliman, H., Castelluccia, C., El Malki,\
    \ K., and L.\n              Bellier, \"Hierarchical Mobile IPv6 (HMIPv6) Mobility\n\
    \              Management\", RFC 5380, October 2008.\n   [RFC5568]  Koodli, R.,\
    \ Ed., \"Mobile IPv6 Fast Handovers\", RFC 5568,\n              July 2009.\n \
    \  [RFC2119]  Bradner, S., \"Key words for use in RFCs to Indicate\n         \
    \     Requirement Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC4555]  Eronen,\
    \ P., \"IKEv2 Mobility and Multihoming Protocol\n              (MOBIKE)\", RFC\
    \ 4555, June 2006.\n   [RFC4881]  El Malki, K., Ed., \"Low-Latency Handoffs in\
    \ Mobile IPv4\",\n              RFC 4881, June 2007.\n   [RFC4066]  Liebsch, M.,\
    \ Ed., Singh, A., Ed., Chaskar, H., Funato, D.,\n              and E. Shim, \"\
    Candidate Access Router Discovery (CARD)\",\n              RFC 4066, July 2005.\n\
    \   [RFC4067]  Loughney, J., Nakhjiri, M., Perkins, C., and R. Koodli,\n     \
    \         \"Context Transfer Protocol (CXTP)\", RFC 4067, July 2005.\n   [RFC5247]\
    \  Aboba, B., Simon, D., and P. Eronen, \"Extensible\n              Authentication\
    \ Protocol (EAP) Key Management Framework\",\n              RFC 5247, August 2008.\n\
    \   [RFC5191]  Forsberg, D., Ohba, Y., Ed., Patil, B., Tschofenig, H.,\n     \
    \         and A. Yegin, \"Protocol for Carrying Authentication for\n         \
    \     Network Access (PANA)\", RFC 5191, May 2008.\n   [RG98]     ITU-T, \"General\
    \ Characteristics of International Telephone\n              Connections and International\
    \ Telephone Circuits: One-Way\n              Transmission Time\", ITU-T Recommendation\
    \ G.114, 1998.\n   [ITU98]    ITU-T, \"The E-Model, a computational model for\
    \ use in\n              transmission planning\", ITU-T Recommendation G.107, 1998.\n\
    \   [ETSI]     ETSI, \"Telecommunications and Internet Protocol\n            \
    \  Harmonization Over Networks (TIPHON) Release 3; End-to-end\n              Quality\
    \ of Service in TIPHON systems; Part 1: General\n              aspects of Quality\
    \ of Service (QoS)\", ETSI TR 101\n              329-1 V3.1.2, 2002.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [RFC5201]      Moskowitz, R., Nikander, P.,\
    \ Jokela, P., Ed., and T.\n                  Henderson, \"Host Identity Protocol\"\
    , RFC 5201,\n                  April 2008.\n   [RFC2679]      Almes, G., Kalidindi,\
    \ S., and M. Zekauskas, \"A One-way\n                  Delay Metric for IPPM\"\
    , RFC 2679, September 1999.\n   [RFC2680]      Almes, G., Kalidindi, S., and M.\
    \ Zekauskas, \"A One-way\n                  Packet Loss Metric for IPPM\", RFC\
    \ 2680,\n                  September 1999.\n   [RFC2681]      Almes, G., Kalidindi,\
    \ S., and M. Zekauskas, \"A\n                  Round-trip Delay Metric for IPPM\"\
    , RFC 2681,\n                  September 1999.\n   [RFC2003]      Perkins, C.,\
    \ \"IP Encapsulation within IP\", RFC 2003,\n                  October 1996.\n\
    \   [RFC2608]      Guttman, E., Perkins, C., Veizades, J., and M. Day,\n     \
    \             \"Service Location Protocol, Version 2\", RFC 2608,\n          \
    \        June 1999.\n   [RFC2473]      Conta, A. and S. Deering, \"Generic Packet\
    \ Tunneling in\n                  IPv6 Specification\", RFC 2473, December 1998.\n\
    \   [RFC3046]      Patrick, M., \"DHCP Relay Agent Information Option\",\n   \
    \               RFC 3046, January 2001.\n   [RFC4039]      Park, S., Kim, P.,\
    \ and B. Volz, \"Rapid Commit Option\n                  for the Dynamic Host Configuration\
    \ Protocol version 4\n                  (DHCPv4)\", RFC 4039, March 2005.\n  \
    \ [RFC5172]      Varada, S., Ed., \"Negotiation for IPv6 Datagram\n          \
    \        Compression Using IPv6 Control Protocol\", RFC 5172,\n              \
    \    March 2008.\n   [RFC5648]      Wakikawa, R., Ed., Devarapalli, V., Tsirtsis,\
    \ G.,\n                  Ernst, T., and K. Nagami, \"Multiple Care-of Addresses\n\
    \                  Registration\", RFC 5648, October 2009.\n   [RFC4429]     \
    \ Moore, N., \"Optimistic Duplicate Address Detection\n                  (DAD)\
    \ for IPv6\", RFC 4429, April 2006.\n   [RFC5836]      Ohba, Y., Ed., Wu, Q.,\
    \ Ed., and G. Zorn, Ed.,\n                  \"Extensible Authentication Protocol\
    \ (EAP) Early\n                  Authentication Problem Statement\", RFC 5836,\n\
    \                  April 2010.\n   [RFC5213]      Gundavelli, S., Ed., Leung,\
    \ K., Devarapalli, V.,\n                  Chowdhury, K., and B. Patil, \"Proxy\
    \ Mobile IPv6\",\n                  RFC 5213, August 2008.\n   [RFC5974]     \
    \ Manner, J., Karagiannis, G., and A. McDonald, \"NSIS\n                  Signaling\
    \ Layer Protocol (NSLP) for Quality-of-Service\n                  Signaling\"\
    , RFC 5974, October 2010.\n   [RFC5169]      Clancy, T., Nakhjiri, M., Narayanan,\
    \ V., and L.\n                  Dondeti, \"Handover Key Management and\n     \
    \             Re-Authentication Problem Statement\", RFC 5169,\n             \
    \     March 2008.\n   [SIPMM]        Schulzrinne, H. and E. Wedlund, \"Application-Layer\n\
    \                  Mobility Using SIP\", ACM MC2R, July 2000.\n   [CELLIP]   \
    \    Campbell, A., Gomez, J., Kim, S., Valko, A., Wan, C.,\n                 \
    \ and Z. Turanyi, \"Design, Implementation, and\n                  Evaluation\
    \ of Cellular IP\", IEEE Personal\n                  Communications, August 2000.\n\
    \   [MOBIQUIT07]   Lopez, R., Dutta, A., Ohba, Y., Schulzrinne, H., and\n    \
    \              A.  Skarmeta, \"Network-layer assisted mechanism to\n         \
    \         optimize authentication delay during handoff in 802.11\n           \
    \       networks\", IEEE Mobiquitous, June 2007.\n   [MISHRA04]     Mishra, A.,\
    \ Shin, M., Petroni, N., Clancy, T., and W.\n                  Arbaugh, \"Proactive\
    \ key distribution using neighbor\n                  graphs\", IEEE Wireless Communications\
    \ Magazine,\n                  February 2004.\n   [SPRINGER07]   Dutta, A., Das,\
    \ S., Famolari, D., Ohba, Y., Taniuchi,\n                  K., Fajardo, V., Lopez,\
    \ R., Kodama, T., Schulzrinne,\n                  H., and A. Skarmeta, \"Seamless\
    \ proactive handover\n                  across heterogeneous access networks\"\
    , Wireless\n                  Personal Communications, November 2007.\n   [HAWAII]\
    \       Ramjee, R., La Porta, T., Thuel, S., Varadhan, K., and\n             \
    \     S.  Wang, \"HAWAII: A Domain-based Approach for\n                  Supporting\
    \ Mobility in Wide-area Wireless networks\",\n                  International\
    \ Conference on Network Protocols ICNP'99.\n   [IDMP]         Das, S., McAuley,\
    \ A., Dutta, A., Misra, A.,\n                  Chakraborty, K., and S. Das, \"\
    IDMP: An Intra-Domain\n                  Mobility Management Protocol for Next\
    \ Generation\n                  Wireless Networks\", IEEE Wireless Communications\n\
    \                  Magazine, October 2000.\n   [MOBIP-REG]    Gustafsson, E.,\
    \ Jonsson, A., and C. Perkins, \"Mobile\n                  IPv4 Regional Registration\"\
    , Work in Progress,\n                  June 2004.\n   [YOKOTA]       Yokota, H.,\
    \ Idoue, A., Hasegawa, T., and T. Kato,\n                  \"Link Layer Assisted\
    \ Mobile IP Fast Handoff Method\n                  over Wireless LAN Networks\"\
    , Proceedings of ACM\n                  MobiCom02, 2002.\n   [MACD]         Shin,\
    \ S., Forte, A., Rawat, A., and H. Schulzrinne,\n                  \"Reducing\
    \ MAC Layer Handoff Latency in IEEE 802.11\n                  Wireless LANs\"\
    , MobiWac Workshop, 2004.\n   [SUM]          Dutta, A., Zhang, T., Madhani, S.,\
    \ Taniuchi, K.,\n                  Fujimoto, K., Katsube, Y., Ohba, Y., and H.\n\
    \                  Schulzrinne, \"Secured Universal Mobility for Wireless\n  \
    \                Internet\", WMASH'04, October 2004.\n   [SIPFAST]      Dutta,\
    \ A., Madhani, S., Chen, W., Altintas, O., and H.\n                  Schulzrinne,\
    \ \"Fast-handoff Schemes for Application\n                  Layer Mobility Management\"\
    , PIMRC 2004.\n   [PIMRC06]      Dutta, A., Berg, E., Famolari, D., Fajardo, V.,\
    \ Ohba,\n                  Y., Taniuchi, K., Kodama, T., and H. Schulzrinne,\n\
    \                  \"Dynamic Buffering Control Scheme for Mobile Handoff\",\n\
    \                  Proceedings of PIMRC 2006, 1-11.\n   [MITH]         Gwon, Y.,\
    \ Fu, G., and R. Jain, \"Fast Handoffs in\n                  Wireless LAN Networks\
    \ using Mobile initiated Tunneling\n                  Handoff Protocol for IPv4\
    \ (MITHv4)\", Wireless\n                  Communications and Networking 2003,\
    \ January 2005.\n   [WENYU]        Jiang, W. and H. Schulzrinne, \"Modeling of\
    \ Packet Loss\n                  and Delay and their Effect on Real-Time Multimedia\n\
    \                  Service Quality\", NOSSDAV 2000, June 2000.\n   [802.21]  \
    \     \"IEEE Standard for Local and Metropolitan Area\n                  Networks:\
    \ Media Independent Handover Services, IEEE\n                  802.21-2008\",\
    \ a contribution to IEEE 802.21 WG,\n                  January 2009.\n   [802.11]\
    \       \"IEEE Wireless LAN Edition A compilation based on IEEE\n            \
    \      Std 802.11-1999(R2003)\", Institute of Electrical and\n               \
    \   Electronics Engineers, September 2003.\n   [GPSIP]        Dutta, A., Madhani,\
    \ S., Chen, W., Altintas, O., and H.\n                  Schulzrinne, \"GPS-IP\
    \ based fast-handoff approaches for\n                  Mobiles\", IEEE Sarnoff\
    \ Symposium 2006.\n   [MAGUIRE]      Vatn, J. and G. Maguire, \"The effect of\
    \ using\n                  co-located care-of addresses on macro handover\n  \
    \                latency\", 14th Nordic Teletraffic Seminar 1998.\n   [MPA-MOBIKE]\
    \   El Mghazli, Y., Bournelle, J., and J. Laganier, \"MPA\n                  using\
    \ IKEv2 and MOBIKE\", Work in Progress, June 2006.\n   [MPA-WIRELESS] Dutta, A.,\
    \ Famolari, D., Das, S., Ohba, Y., Fajardo,\n                  V., Taniuchi, K.,\
    \ Lopez, R., and H. Schulzrinne,\n                  \"Media- Independent Pre-authentication\
    \ Supporting\n                  Secure Interdomain Handover Optimization\", IEEE\n\
    \                  Wireless Communications Magazine, April 2008.\n"
- title: Appendix A.  Proactive Duplicate Address Detection
  contents:
  - "Appendix A.  Proactive Duplicate Address Detection\n   When the DHCP server dispenses\
    \ an IP address, it updates its lease\n   table, so that this same address is\
    \ not given to another client for\n   that specific period of time.  At the same\
    \ time, the client also\n   keeps a lease table locally so that it can renew when\
    \ needed.  In\n   some cases where a network consists of both DHCP and non-DHCP-enabled\n\
    \   clients, there is a probability that another client in the LAN may\n   have\
    \ been configured with an IP address from the DHCP address pool.\n   In such a\
    \ scenario, the server detects a duplicate address based on\n   ARP (Address Resolution\
    \ Protocol) or IPv6 Neighbor Discovery before\n   assigning the IP address.  This\
    \ detection procedure may take from 4\n   sec to 15 sec [MAGUIRE] and will thus\
    \ contribute to a larger handover\n   delay.  In the case of a proactive IP address\
    \ acquisition process,\n   this detection is performed ahead of time and thus\
    \ does not affect\n   the handover delay at all.  By performing the Duplicate\
    \ Address\n   Detection (DAD) ahead of time, we reduce the IP address acquisition\n\
    \   time.\n   The proactive DAD over the candidate target network should be\n\
    \   performed by the nAR on behalf of the mobile node at the time of\n   proactive\
    \ handover tunnel establishment, since DAD over a tunnel is\n   not always performed.\
    \  For example, in the case of IPv6, DAD over an\n   IP-IP tunnel interface is\
    \ turned off in an existing implementation.\n   In the case of IPv6 over PPP [RFC5172],\
    \ the IP Control Protocol\n   (IPCPv6) negotiates the link-local addresses, and\
    \ hence DAD over the\n   tunnel is not needed.  After the mobile node has moved\
    \ to the target\n   network, a DAD procedure may be started because of reassignment\
    \ of\n   the nCoA to the physical interface to the target network.  In that\n\
    \   case, the mobile node should use optimistic DAD [RFC4429] over the\n   physical\
    \ interface so that the nCoA that was used inside the\n   proactive handover tunnel\
    \ before handover can be immediately used\n   over that physical interface after\
    \ handover.  The schemes used for\n   the proactive DAD and optimistic DAD are\
    \ applicable to both stateless\n   and stateful address autoconfiguration schemes\
    \ used for obtaining a\n   nCoA.\n"
- title: Appendix B.  Address Resolution
  contents:
  - "Appendix B.  Address Resolution\n   Address resolution involves updating the\
    \ next access router's\n   neighbor cache.  We briefly describe these two operations\
    \ below.\n   During the process of pre-configuration, the MAC address resolution\n\
    \   mappings needed by the mobile node to communicate with nodes in the\n   target\
    \ network after attaching to the target network can also be\n   known, where the\
    \ communicating nodes may be the access router,\n   authentication agent, configuration\
    \ agent, or Correspondent Node.\n   There are several possible ways of performing\
    \ such proactive MAC\n   address resolution.\n   o  One can use an information\
    \ service mechanism [802.21] to resolve\n      the MAC addresses of the nodes.\
    \  This might require each node in\n      the target network to be involved in\
    \ the information service so\n      that the server of the information service\
    \ can construct the\n      database for proactive MAC address resolution.\n  \
    \ o  One can extend the authentication protocol used for pre-\n      authentication\
    \ or the configuration protocol used for\n      pre-configuration to support proactive\
    \ MAC address resolution.\n      For example, if PANA is used as the authentication\
    \ protocol for\n      pre-authentication, PANA messages may carry attribute-value\
    \ pairs\n      (AVPs) used for proactive address resolution.  In this case, the\n\
    \      PANA authentication agent in the target network may perform\n      address\
    \ resolution on behalf of the mobile node.\n   o  One can also make use of DNS\
    \ to map the MAC address of the\n      specific interface associated with a specific\
    \ IP address of the\n      network element in the target network.  One may define\
    \ a new DNS\n      resource record (RR) to proactively resolve the MAC addresses\
    \ of\n      the nodes in the target network.  But this approach may have its\n\
    \      own limitations, since a MAC address is a resource that is bound\n    \
    \  to an IP address, and not directly to a domain name.\n   When the mobile node\
    \ attaches to the target network, it installs the\n   proactively obtained address\
    \ resolution mappings without necessarily\n   performing address resolution queries\
    \ for the nodes in the target\n   network.\n   On the other hand, the nodes that\
    \ reside in the target network and\n   that are communicating with the mobile\
    \ node should also update their\n   address resolution mappings for the mobile\
    \ node as soon as the mobile\n   node attaches to the target network.  The above\
    \ proactive address\n   resolution methods could also be used for those nodes\
    \ to proactively\n   resolve the MAC address of the mobile node before the mobile\
    \ node\n   attaches to the target network.  However, this is not useful, since\n\
    \   those nodes need to detect the attachment of the mobile node to the\n   target\
    \ network before adopting the proactively resolved address\n   resolution mapping.\
    \  A better approach would be integration of\n   attachment detection and address\
    \ resolution mapping update.  This is\n   based on gratuitously performing address\
    \ resolution [RFC5944],\n   [RFC3775] in which the mobile node sends an ARP Request\
    \ or an ARP\n   Reply in the case of IPv4, or a Neighbor Advertisement in the\
    \ case of\n   IPv6, immediately after the mobile node attaches to the new network,\n\
    \   so that the nodes in the target network can quickly update the\n   address\
    \ resolution mapping for the mobile node.\n"
- title: Appendix C.  MPA Deployment Issues
  contents:
  - "Appendix C.  MPA Deployment Issues\n   In this section, we describe some of the\
    \ deployment issues related to\n   MPA.\n"
- title: C.1.  Considerations for Failed Switching and Switch-Back
  contents:
  - "C.1.  Considerations for Failed Switching and Switch-Back\n   The ping-pong effect\
    \ is one of the common problems found during\n   handover.  The ping-pong effect\
    \ arises when a mobile node is located\n   at the borderline of the cell or decision\
    \ point and a handover\n   procedure is frequently executed.  This results in\
    \ higher call drop\n   probability, lower connection quality, increased signaling\
    \ traffic,\n   and waste of resources.  All of these affect mobility optimization.\n\
    \   Handoff algorithms are the deciding factors for performing the\n   handoff\
    \ between the networks.  Traditionally, these algorithms employ\n   a threshold\
    \ to compare the values of different metrics to decide on\n   the handoff.  These\
    \ metrics include signal strength, path loss,\n   Carrier-to-Interference Ratio\
    \ (CIR), Signal-to-Interference Ratio\n   (SIR), Bit Error Rate (BER), and power\
    \ budget.  In order to avoid the\n   ping-pong effect, some additional parameters\
    \ are employed by the\n   decision algorithm, such as hysteresis margin, dwell\
    \ timers, and\n   averaging window.  For a vehicle moving at a high speed, other\n\
    \   parameters, such as the distance between the mobile node and the\n   point\
    \ of attachment, velocity of the mobile node, location of the\n   mobile node,\
    \ traffic, and bandwidth characteristics are also taken\n   into account to reduce\
    \ the ping-pong effect.  More recently, there\n   are other handoff algorithms\
    \ available that help reduce the ping-pong\n   effect in a heterogeneous network\
    \ environment and that are based on\n   techniques such as hypothesis testing,\
    \ dynamic programming, and\n   pattern recognition techniques.  While it is important\
    \ to devise\n   smart handoff algorithms to reduce the ping-pong effect, it is\
    \ also\n   important to devise methods to recover from this effect.\n   In the\
    \ case of the MPA framework, the ping-pong effect will result in\n   the back-and-forth\
    \ movement of the mobile node between the current\n   network and target network,\
    \ and between the candidate target\n   networks.  MPA in its current form will\
    \ be affected because of the\n   number of tunnels set up between the mobile node\
    \ and neighboring\n   access routers, the number of binding updates, and associated\
    \ handoff\n   latency resulting from the ping-pong situation.  The mobile node's\n\
    \   handoff rate may also contribute to delay and packet loss.  We\n   propose\
    \ a few techniques that will help reduce the probability of the\n   ping-pong\
    \ effect and propose several methods for the MPA framework so\n   that it can\
    \ recover from the packet loss resulting from the ping-pong\n   effect.\n   The\
    \ MPA framework can take advantage of the mobile node's geo-\n   location with\
    \ respect to APs in the neighboring networks using GPS.\n   In order to avoid\
    \ the oscillation between the networks, a location-\n   aware algorithm can be\
    \ derived by using a co-relation between the\n   user's location and cached data\
    \ from the previous handover attempts.\n   In some cases, location may not be\
    \ the only indicator for a handoff\n   decision.  For example, in Manhattan-type\
    \ grid networks, although a\n   mobile node is close to an AP, it may not have\
    \ enough SNR (Signal-to-\n   Noise Ratio) to make a good connection.  Thus, knowledge\
    \ of the\n   mobility pattern, dwell time in a call, and path identification will\n\
    \   help avoid the ping-pong problem to a great extent.\n   In the absence of\
    \ a good handoff algorithm that can avoid the ping-\n   pong effect, it may be\
    \ required to put in place a good recovery\n   mechanism so as to mitigate the\
    \ effect of ping-pong.  It may be\n   necessary to keep the established context\
    \ in the current network for\n   a period of time, so that it can be quickly recovered\
    \ when the mobile\n   node comes back to the network where the context was last\
    \ used.  This\n   context may include security association, IP address used, and\n\
    \   tunnels established.  Bicasting the data to both the previous network\n  \
    \ and the new network for a predefined period will also help the mobile\n   node\
    \ to take care of the lost packets in case the mobile node moves\n   back and\
    \ forth between the networks.  The mobile node can also take\n   certain action,\
    \ after it determines that it is in a stable state with\n   respect to a ping-pong\
    \ situation.\n   When the MPA framework takes advantage of a combination of IKEv2\
    \ and\n   MOBIKE, the ping-pong effect can be reduced further [MPA-MOBIKE].\n"
- title: C.2.  Authentication State Management
  contents:
  - "C.2.  Authentication State Management\n   In the case of pre-authentication with\
    \ multiple target networks, it\n   is useful to maintain the state in the authentication\
    \ agent of each\n   of the neighboring networks for a certain time period.  Thus,\
    \ if the\n   mobile node does move back and forth between neighboring networks,\n\
    \   already-maintained authentication state can be helpful.  We provide\n   some\
    \ highlights on multiple security association state management\n   below.\n  \
    \ A mobile node that has pre-authenticated with an authentication agent\n   in\
    \ a candidate target network and has an MPA-SA may need to continue\n   to keep\
    \ the MPA-SA while it continues to stay in the current network\n   or even after\
    \ it makes a handover to a network that is different from\n   the candidate target\
    \ network.\n   When an MN that has been authenticated and authorized by an\n \
    \  authentication agent in the current network makes a handover to a\n   target\
    \ network, it may want to hold the SA that has been established\n   between the\
    \ MN and the authentication agent for a certain time period\n   so that it does\
    \ not have to go through the entire authentication\n   signaling to create an\
    \ SA from scratch, in case it returns to the\n   previous network.  Such an SA\
    \ being held at the authentication agent\n   after the MN's handover to another\
    \ network is considered as an\n   MPA-SA.  In this case, the authentication agent\
    \ should change the\n   fully authorized state for the MN to an unauthorized state.\
    \  The\n   unauthorized state can be changed to the fully authorized state only\n\
    \   when the MN comes back to the network and provides proof of\n   possession\
    \ of a key associated with the MPA-SA.\n   While an MPA-SA is being held at an\
    \ authentication agent, the MN will\n   need to keep updating the authentication\
    \ agent when an IP address of\n   the MN changes due to a handover, to re-establish\
    \ the new SA.\n"
- title: C.3.  Pre-Allocation of QoS Resources
  contents:
  - "C.3.  Pre-Allocation of QoS Resources\n   In the pre-configuration phase, it\
    \ is also possible to pre-allocate\n   QoS resources that may be used by the mobile\
    \ node not only after\n   handover but also before handover.  When pre-allocated\
    \ QoS resources\n   are used before handover, they are used for application traffic\n\
    \   carried over a proactive handover tunnel.\n   It is possible that QoS resources\
    \ are pre-allocated in an end-to-end\n   fashion.  One method to achieve this\
    \ proactive end-to-end QoS\n   reservation is to execute the NSIS Signaling Layer\
    \ Protocol (NSLP)\n   [RFC5974] or the Resource Reservation Protocol (RSVP) [RFC2205]\
    \ over\n   a proactive handover tunnel where pre-authentication can be used for\n\
    \   bootstrapping a security association for the proactive handover\n   tunnel\
    \ to protect the QoS signaling.  In this case, QoS resources are\n   pre-allocated\
    \ on the path between the Correspondent Node and a target\n   access router and\
    \ can be used continuously before and after handover.\n   On the other hand, duplicate\
    \ pre-allocation of QoS resources between\n   the target access router and the\
    \ mobile node is necessary when using\n   pre-allocated QoS resources before handover,\
    \ due to differences in\n   paths between the target access router and the mobile\
    \ node before and\n   after handover.  QoS resources to be used for the path between\
    \ the\n   target access router and the mobile node after handover may be\n   pre-allocated\
    \ by extending NSLP to work for off-path signaling (Note:\n   this path can be\
    \ viewed as off-path before handover) or by\n   media-specific QoS signaling at\
    \ layer 2.\n"
- title: C.4.  Resource Allocation Issue during Pre-Authentication
  contents:
  - "C.4.  Resource Allocation Issue during Pre-Authentication\n   In the case of\
    \ multiple CTNs, establishing multiple tunnels with the\n   neighboring target\
    \ networks provides some additional benefits.  But\n   it contributes to some\
    \ resource utilization issues as well.  A\n   pre-authentication process with\
    \ multiple candidate target networks\n   can happen in several ways.\n   The very\
    \ basic scheme involves authenticating the mobile node with\n   the multiple authentication\
    \ agents in the neighboring networks, but\n   actual pre-configuration and binding\
    \ update take place only after\n   layer 2 movement to a specific network is complete.\n\
    \   Similarly, in addition to pre-authentication, the mobile node can\n   also\
    \ complete the pre-configuration while in the previous network,\n   but can postpone\
    \ the binding update until after the mobile node has\n   moved.  Like the previous\
    \ case, in this case the mobile node also\n   does not need to set up the pre-configured\
    \ tunnels.  While the pre-\n   authentication process and part of the pre-configuration\
    \ process are\n   taken care of before the mobile node has moved to the new network,\n\
    \   the binding update is actually done after the mobile node has moved.\n   The\
    \ third type of multiple pre-authentication involves all the three\n   steps while\
    \ the mobile node is in the previous networks, such as\n   authentication, configuration,\
    \ and binding update.  But, this\n   specific process utilizes the highest amount\
    \ of resources.  Some of\n   the resources that get used during this process are\
    \ as follows:\n   (1)  Additional signaling for pre-authentication in the neighboring\n\
    \        networks\n   (2)  Holding the IP address of the neighboring networks\
    \ in the mobile\n        node's cache for a certain amount of time.  Additional\n\
    \        processing in the mobile node is needed for storing these IP\n      \
    \  addresses.  In addition, this caching of addresses also uses up\n        the\
    \ temporary IP addresses from the neighboring routers.\n   (3)  There is an additional\
    \ cost associated with setting up\n        additional transient tunnels with the\
    \ target routers in the\n        neighboring networks and the mobile node.\n \
    \  (4)  In the case of a binding update with multiple IP addresses\n        obtained\
    \ from the neighboring networks, multiple transient\n        streams flow between\
    \ the CN and mobile node using these\n        transient tunnels.\n   However,\
    \ there are pros and cons related to sending the binding\n   update after the\
    \ handover.  If the binding update is sent after the\n   mobile node has moved\
    \ to the new network, this will contribute to the\n   delay if the CH or HA is\
    \ far from the MN.  Multiple binding updates\n   can be taken care of in many\
    \ different ways.  We describe a few of\n   these update mechanisms below.\n \
    \  When only pre-authentication and pre-configuration are done ahead of\n   time\
    \ with multiple networks, the mobile node sends one binding update\n   to the\
    \ CN.  In this case, it is important to find out when to send\n   the binding\
    \ update after the layer 2 handoff.\n   In case a binding update with multiple\
    \ contact addresses is sent,\n   multiple media streams stem out of the CN, using\
    \ the transient\n   tunnels.  But in that case, one needs to send another binding\
    \ update\n   after the handover, with the contact address set to the new address\n\
    \   (only one address) where the mobile node has moved.  This way, the\n   mobile\
    \ node stops sending media to other neighboring networks where\n   the mobile\
    \ node did not move.\n   The following is an illustration of this specific case\
    \ that takes\n   care of multiple binding streams, when the mobile node moves\
    \ only to\n   a specific network, but sends multiple binding updates in the\n\
    \   previous network.  The MN sends a binding update to the CH with\n   multiple\
    \ contact addresses, such as c1, c2, and c3, that were\n   obtained from three\
    \ neighboring networks.  This allows the CN to send\n   transient multiple streams\
    \ to the mobile node over the pre-\n   established tunnels.  After the mobile\
    \ node moves to the actual\n   network, it sends another binding update to the\
    \ CN with the care-of\n   address of the mobile node in the network where the\
    \ mobile node has\n   moved.  One issue with multiple streams is consumption of\
    \ extra\n   bandwidth for a small period of time.\n   Alternatively, one can apply\
    \ the buffering technique at the target\n   access router or at the Home Agent.\
    \  Transient data can be forwarded\n   to the mobile node after it has moved.\
    \  Forwarding of data can be\n   triggered by the mobile node either as part of\
    \ Mobile IP registration\n   or as a separate buffering protocol.\n"
- title: C.5.  Systems Evaluation and Performance Results
  contents:
  - "C.5.  Systems Evaluation and Performance Results\n   In this section, we present\
    \ some of the results from MPA\n   implementation when applied to different handover\
    \ scenarios.  We\n   present the summary of results from our experiments using\
    \ MPA\n   techniques for two types of handovers: i) intra-technology and\n   intra-domain,\
    \ and ii) inter-technology and inter-domain.  We also\n   present the results\
    \ of how the MPA can bootstrap layer 2 security for\n   both roaming and non-roaming\
    \ cases.  Detailed procedures and results\n   are explained in [MOBIQUIT07] and\
    \ [SPRINGER07].\n"
- title: C.5.1.  Intra-Technology, Intra-Domain
  contents:
  - "C.5.1.  Intra-Technology, Intra-Domain\n   The results for MIPv6 and SIP mobility\
    \ involving intra-domain\n   mobility are shown in Figures 6 and 7, respectively.\n\
    \                         Buffering    Buffering   Buffering   Buffering\n   \
    \                      (disabled)   (enabled)   (disabled)  (enabled)\n      \
    \                    & RO         & RO        & RO        & RO\n             \
    \            (disabled)   (disabled)  (enabled)   (enabled)\n    -------------------------------------------------------------------\n\
    \    L2 handoff (ms)         4.00        4.33        4.00        4.00\n    L3\
    \ handoff (ms)         1.00        1.00        1.00        1.00\n    Avg. packet\
    \ loss        1.33           0        0.66           0\n    Avg. inter-packet\
    \      16.00       16.00       16.00       16.00\n    arrival interval\n     \
    \   (ms)\n    Avg. inter-packet       n/a        45.33        n/a        66.60\n\
    \    arrival time during\n      handover\n        (ms)\n    Avg. packet jitter\
    \      n/a        29.33        n/a        50.60\n        (ms)\n    Buffering Period\
    \        n/a        50.00        n/a        50.00\n        (ms)\n    Buffered\
    \ Packets        n/a         2.00        n/a         3.00\n   RO = Router Optimization\n\
    \                  Figure 6: Mobile IPv6 with MPA Results\n                  \
    \                    Buffering      Buffering\n                              \
    \        disabled       enabled\n               -----------------------------------------------\n\
    \               L2 handoff (ms)           4.00          5.00\n               L3\
    \ handoff (ms)           1.00          1.00\n               Avg. packet loss \
    \         1.50             0\n               Avg. inter-packet        16.00  \
    \       16.00\n               arrival interval\n                   (ms)\n    \
    \           Avg. inter-packet         n/a          29.00\n               arrival\
    \ time during\n                 handover\n                   (ms)\n          \
    \     Avg. packet jitter        n/a          13.00\n                   (ms)\n\
    \               Buffering Period          n/a          20.00\n               \
    \    (ms)\n               Buffered Packets          n/a           3.00\n     \
    \             Figure 7: SIP Mobility with MPA Results\n   For all measurements,\
    \ we did not experience any performance\n   degradation during handover in terms\
    \ of the audio quality of the\n   voice traffic.\n   With the use of buffering\
    \ during handover, packet loss during the\n   actual L2 and L3 handover is eliminated\
    \ with appropriate and\n   reasonable settings of the buffering period for both\
    \ MIP6 and SIP\n   mobility.  In the case of MIP6, there is not a significant\
    \ difference\n   in results with and without route optimization.  It should be\
    \ noted\n   that results with more samples would be necessary for a more detailed\n\
    \   analysis.\n   In the case of non-MPA-assisted handover, handover delay and\n\
    \   associated packet loss occur from the moment the link-layer handover\n   procedure\
    \ begins, up to successful processing of the binding update.\n   During this process,\
    \ IP address acquisitions via DHCP incur the\n   longest delay.  This is due to\
    \ the detection of duplicate IP\n   addresses in the network before the DHCP request\
    \ completes.  The\n   binding update exchange also experiences a long delay if\
    \ the CN is\n   too far from the MN.  As a result, the non-MPA-assisted handover\
    \ took\n   an average of 4 seconds to complete, with an approximate packet loss\n\
    \   of about 200 packets.  The measurement is based on the same traffic\n   rate\
    \ and traffic source as the MPA-assisted handover.\n"
- title: C.5.2.  Inter-Technology, Inter-Domain
  contents:
  - "C.5.2.  Inter-Technology, Inter-Domain\n   Handoff involving heterogeneous access\
    \ can take place in many\n   different ways.  We limit the experiment to two interfaces,\
    \ and\n   therefore results in several possible setup scenarios, depending upon\n\
    \   the activity of the second interface.  In one scenario, the second\n   interface\
    \ comes up when the link to the first interface goes down.\n   This is a reactive\
    \ scenario and usually gives rise to undesirable\n   packet loss and handoff delay.\
    \  In a second scenario, the second\n   interface is being prepared while the\
    \ mobile node still communicates\n   using the old interface.  Preparation of\
    \ the second interface should\n   include setup of all the required state and\
    \ security associations\n   (e.g., PPP state, the Link Control Protocol (LCP),\
    \ the Challenge\n   Handshake Authentication Protocol (CHAP)).  If such a lengthy\
    \ process\n   is established ahead of time, it reduces the time taken for the\n\
    \   secondary interface to be attached to the network.  After\n   preparation,\
    \ the mobile node decides to use the second interface as\n   the active interface.\
    \  This results in less packet loss, as it uses\n   make-before-break techniques.\
    \  This is a proactive scenario and can\n   have two \"flavors\".  The first is\
    \ where both interfaces are up; the\n   second is when only the old interface\
    \ is up and the prepared\n   interface is brought up only when handoff is about\
    \ to occur.  This\n   scenario may be beneficial from a battery management standpoint.\n\
    \   Devices that operate two interfaces simultaneously can rapidly\n   deplete\
    \ their batteries.  However, by activating the second interface\n   only after\
    \ an appropriate network has been selected, the client may\n   utilize battery\
    \ power effectively.\n   As compared to non-optimized handover that may result\
    \ in a delay of\n   up to 18 sec and loss of 1000 or more packets during the handover\n\
    \   from the wireless LAN (WLAN) to CDMA, we observed 0 packet loss and a\n  \
    \ 50-ms handoff delay between the last pre-handoff packet and the first\n   in-handoff\
    \ packet.  This handoff delay includes the time due to link\n   down detection\
    \ and time needed to delete the tunnel after the mobile\n   node has moved.  However,\
    \ we observed about 10 duplicate packets\n   because of the copy-and-forward mechanism\
    \ at the access routers.  But\n   these duplicate packets are usually handled\
    \ easily by the upper-layer\n   protocols.\n"
- title: C.5.3.  MPA-Assisted Layer 2 Pre-Authentication
  contents:
  - "C.5.3.  MPA-Assisted Layer 2 Pre-Authentication\n   In this section, we discuss\
    \ the results obtained from MPA-assisted\n   layer 2 pre-authentication and compare\
    \ these with EAP authentication\n   and IEEE 802.11i's pre-authentication techniques.\
    \  Figure 8 shows the\n   experimental testbed where we have conducted the MPA-assisted\n\
    \   pre-authentication experiment for bootstrapping layer 2 security as\n   explained\
    \ in Section 7.  By pre-authenticating and pre-configuring\n   the link, the security\
    \ association procedure during handoff reduces\n   to a 4-way handshake only.\
    \  Then the MN moves to the AP and, after\n   association, runs a 4-way handshake\
    \ by using the PSKap (Pre-shared\n   Key at AP) generated during PANA pre-authentication.\
    \  At this point,\n   the handoff is complete.  Details of this experimental testbed\
    \ can be\n   found in [MOBIQUIT07].\n   +----------------------------+-----------+\
    \ +-------------+----------+\n   |                                        | |\
    \                        |\n   |  Home Domain       +-------++          | |  \
    \                      |\n   |                    |        |          | |    \
    \                    |\n   |                    |AAAHome |          | |      \
    \                  |\n   |                    +        |          | |        \
    \                |\n   |                    +-----+--+          | |          \
    \              |\n   |                          |             | |  Network B \
    \            |\n   |   Network A              |             | |              \
    \          |\n   |                        /----\\          | |            /---\\\
    \       |\n   |                       /nAR   \\         | |           /     \\\
    \      |\n   |                      | PAA    |--------+-+----------+ pAR   | \
    \    |\n   |                       \\      /         | |           \\     /  \
    \    |\n   |                        \\----/          | |            \\-+-/   \
    \    |\n   |                           |            | |              |       \
    \  |\n   |             +-------------------|      | |              |         |\n\
    \   |             |       IEEE 802.11i|      | |              |         |\n  \
    \ |           +------+          +------+   | |          +---+--+      |\n   |\
    \           |      |          |      |   | |          |      |      |\n   |  \
    \         |AP2   |          |AP1   |   | |          |AP0   |      |\n   |    \
    \       +------+          +------+   | |          +------+      |\n   |      \
    \     +------+            +-----+  | |           +-----+      |\n   |        \
    \   |      |            |     |  | |           |     |      |\n   |          \
    \ |MN    +----------->|MN   |<+------------- |MN   |      |\n   |           +------+\
    \            +-----+  | |           ++----+      |\n   |----------------------------------------+\
    \ +------------+-----------+\n              Figure 8: Experimental Testbed for\
    \ MPA-Assisted\n                    L2 Pre-Authentication (Non-Roaming)\n    \
    \                    +-----------------------------+\n                       \
    \ |      +--------+             |\n                        |      |        | \
    \            |\n                        |      | AAAH   +             |\n    \
    \                    |      |        |             |\n                       \
    \ |      ++-------+             |\n                        |       |         \
    \            |\n                        |       |  Home AAA Domain    |\n    \
    \                    |       |                     |\n                       \
    \ +-------+---------------------+\n                                |\n       \
    \                         |\n                                |\n             \
    \          RADIUS/  |\n                       Diameter |\n                   \
    \             |\n                                |\n   +----------------------------+-----------+\
    \ +-------------+----------+\n   |                            |           | |\
    \                        |\n   | Roaming            +-------++          | |  \
    \                      |\n   | AAA Domain A       |        |          | |    \
    \                    |\n   |                    | AAAV   |          | |      \
    \                  |\n   |                    +        |          | |        \
    \                |\n   | Network A          +-----+--+          | |  Network B\
    \             |\n   |                          |             | |             \
    \           |\n   |                          |             | |               \
    \         |\n   |                        /----\\          | |            /---\\\
    \       |\n   |                       /nAR   \\         | |           /     \\\
    \      |\n   |                      | PAA    |--------+-+----------+ pAR   | \
    \    |\n   |                       \\      /         | |           \\     /  \
    \    |\n   |                        \\----/          | |            \\-+-/   \
    \    |\n   |                           |            | |              |       \
    \  |\n   |             +-------------------|      | |              |         |\n\
    \   |             |       IEEE 802.11i|      | |              |         |\n  \
    \ |           +------+          +------+   | |          +---+--+      |\n   |\
    \           |      |          |      |   | |          |      |      |\n   |  \
    \         |AP2   |          |AP1   |   | |          |AP0   |      |\n   |    \
    \       +------+          +------+   | |          +------+      |\n   |      \
    \     +------+            +-----+  | |           +-----+      |\n   |        \
    \   |      |            |     |  | |           |     |      |\n   |          \
    \ |MN    +----------->|MN   |<---------------| MN  |      |\n   |           +------+\
    \            +-----+  | |           ++----+      |\n   -----------------------------------------+\
    \ +------------+-----------+\n              Figure 9: Experimental Testbed for\
    \ MPA-Assisted\n                      L2 Pre-Authentication (Roaming)\n   We have\
    \ experimented with three types of movement scenarios involving\n   both non-roaming\
    \ and roaming cases, using the testbeds shown in\n   Figures 8 and 9, respectively.\
    \  In the roaming case, the MN is\n   visiting in a domain different than its\
    \ home domain.  Consequently,\n   the MN needs to contact the AAA server in the\
    \ home domain (AAAH) from\n   its new domain.  For the non-roaming case, we assume\
    \ the MN is moving\n   within its home domain, and only the local AAA server (AAAHome),\n\
    \   which is the home AAA server for the mobile node, is contacted.\n   The first\
    \ scenario does not involve any pre-authentication.  The MN\n   is initially connected\
    \ to AP0 and moves to AP1.  Because neither\n   network-layer authentication nor\
    \ IEEE 802.11i pre-authentication is\n   used, the MN needs to engage in a full\
    \ EAP authentication with AP1 to\n   gain access to the network after the move\
    \ (post-authentication).\n   This experiment shows the effect of the absence of\
    \ any kind of\n   pre-authentication.\n   The second scenario involves 802.11i\
    \ pre-authentication and involves\n   movement between AP1 and AP2.  In this scenario,\
    \ the MN is initially\n   connected to AP2, and starts IEEE 802.11i pre-authentication\
    \ with\n   AP1.  This is an ideal scenario to compare the values obtained from\n\
    \   802.11i pre-authentication with that of network-layer assisted\n   pre-authentication.\
    \  Both scenarios use RADIUS as the AAA protocol\n   (APs implement a RADIUS client).\
    \  The third scenario takes advantage\n   of network-layer assisted link-layer\
    \ pre-authentication.  It involves\n   movement between two APs (e.g., between\
    \ AP0 and AP1) that belong to\n   two different subnets where 802.11i pre-authentication\
    \ is not\n   possible.  Here, Diameter is used as the AAA protocol (PAA implements\n\
    \   a Diameter client).\n   In the third movement scenario, the MN is initially\
    \ connected to AP0.\n   The MN starts PANA pre-authentication with the PAA, which\
    \ is\n   co-located on the AR in the new candidate target network (nAR in\n  \
    \ network A) from the current associated network (network B).  After\n   authentication,\
    \ the PAA proactively installs two keys, PSKap1 and\n   PSKap2, in AP1 and AP2,\
    \ respectively.  By doing the key installations\n   proactively, the PAA preempts\
    \ the process of communicating with the\n   AAA server for the keys after the\
    \ mobile node moves to the new\n   network.  Finally, because PSKap1 is already\
    \ installed, AP1\n   immediately starts the 4-way handshake.  We have used measurement\n\
    \   tools such as ethereal and kismet to analyze the measurements for the\n  \
    \ 4-way handshake and PANA authentication.  These measurements reflect\n   different\
    \ operations involved during network-layer pre-\n   authentication.\n   In our\
    \ experiment, as part of the discovery phase, we assume that the\n   MN is able\
    \ to retrieve the PAA's IP address and all required\n   information about AP1\
    \ and AP2 (e.g., channel, security-related\n   parameters, etc.) at some point\
    \ before the handover.  This avoids the\n   scanning during link-layer handoff.\
    \  We have applied this assumption\n   to all three scenarios.  Because our focus\
    \ is on reducing the time\n   spent on the authentication phase during handoff,\
    \ we do not discuss\n   the details of how we avoid the scanning.\n   =====================================================================\n\
    \   Types    |802.11i            | 802.11i           | MPA-assisted\n        \
    \    |Post-              | Pre-              | Layer 2\n            |authentication\
    \     | authentication    | Pre-authentication\n   =====================================================================\n\
    \   Operation| Non-    | Roaming | Non-    | Roaming |Non-   | Roaming|\n    \
    \        | Roaming |         | Roaming |         |Roaming|        |\n   ===================================================================\n\
    \   Tauth    | 61 ms   |  599 ms | 99 ms   | 638 ms  | 177 ms| 831 ms |\n   -------------------------------------------------------------------\n\
    \   Tconf    | --      |  --     | --      | --      | 16 ms | 17ms   |\n   -------------------------------------------------------------------\n\
    \   Tassoc+  |         |         |         |         |       |        |\n   4way\
    \     | 18 ms   |  17 ms  | 16 ms   | 17 ms   | 16 ms | 17 ms  |\n   ------------------------------------------------------------------|\n\
    \   Total    | 79 ms   |  616 ms | 115 ms  | 655 ms  | 208 ms| 865 ms |\n   ------------------------------------------------------------------|\n\
    \   Time     |         |         |         |         |       |        |\n   affecting|\
    \ 79 ms   |  616 ms | 16 ms   | 17 ms   | 15 ms | 17 ms  |\n   handover |    \
    \     |         |         |         |       |        |\n   ------------------------------------------------------------------|\n\
    \                Figure 10: Results of MPA-Assisted Layer 2\n                \
    \       Pre- and Post-Authentication\n   Figure 10 shows the timing (rounded off\
    \ to the most significant\n   number) associated with some of the handoff operations\
    \ we have\n   measured in the testbed.  We describe each of the timing parameters\n\
    \   below.\n   \"Tauth\" refers to the execution of EAP-Transport Layer Security\
    \ (TLS)\n   authentication.  This time does not distinguish whether this\n   authentication\
    \ was performed during pre-authentication or a typical\n   post-authentication.\n\
    \   \"Tconf\" refers to the time spent during PSK generation and\n   installation\
    \ after EAP authentication is complete.  When network-\n   layer pre-authentication\
    \ is not used, this time is not considered.\n   \"Tassoc+4way\" refers to the\
    \ time dedicated to the completion of the\n   association and the 4-way handshake\
    \ with the target AP after the\n   handoff.\n   The first two columns in the figure\
    \ show the results for non-roaming\n   and roaming cases, respectively, when no\
    \ pre-authentication is used\n   at all.  The second two columns depict the same\
    \ cases when IEEE\n   802.11i pre-authentication is used.  The last two columns\
    \ show when\n   we used network-layer-assisted layer 2 pre-authentication.  When\
    \ pre-\n   authentication is used, only the factor Tassoc+4way affects the\n \
    \  handoff time.  When no pre-authentication is used, the time affecting\n   the\
    \ handoff includes Tauth (the complete EAP-TLS authentication) plus\n   Tassoc+4way.\n\
    \   That is precisely the time affecting the handoff in the case where\n   the\
    \ MN moves from AP0 to AP1 in the absence of pre-authentication.\n   As it is\
    \ seen, these delays are not suitable for real-time\n   applications.  Indeed,\
    \ for the non-roaming case, we obtained a ~80-ms\n   delay for re-establishing\
    \ the connection with target AP1.  It takes\n   about 600 ms to complete the handoff\
    \ when the MN moves to a visited\n   domain and the home AAA server is located\
    \ far away.  However,\n   network-layer pre-authentication is only affected by\
    \ Tassoc+4way\n   (~17 ms) involving any kind of handoff authentication.  As is\n\
    \   evident, IEEE 802.11i pre-authentication provides a comparable\n   benefit\
    \ (~16 ms) in terms of handoff but is limited to cases when APs\n   are in the\
    \ same Distribution System (DS).  Additionally, network-\n   layer pre-authentication\
    \ leverages a single EAP authentication to\n   bootstrap security in several target\
    \ APs by allowing the MN to move\n   among APs under the same PAA without running\
    \ EAP and consequently\n   without contacting the AAA server.  In this sense,\
    \ it extends IEEE\n   802.11r advantages over IEEE 802.11i by allowing inter-subnet\
    \ and\n   inter-domain and even inter-technology handoffs.\n"
- title: C.6.  Guidelines for Handover Preparation
  contents:
  - "C.6.  Guidelines for Handover Preparation\n   In this section, we provide some\
    \ guidelines for the roaming clients\n   that use pre-authentication mechanisms\
    \ to reduce the handoff delay.\n   These guidelines can help determine the extent\
    \ of the\n   pre-authentication operation that is needed based on a specific type\n\
    \   of movement of the client.  IEEE 802.11i and 802.11r take advantage\n   of\
    \ the pre-authentication mechanism at layer 2.  Thus, many of the\n   guidelines\
    \ observed for 802.11i-based pre-authentication and 802.11r-\n   based fast roaming\
    \ could also be applicable to the clients that use\n   MPA-based pre-authentication\
    \ techniques.  However, since MPA\n   operations are not limited to a specific\
    \ subnet and involve inter-\n   subnet and inter-domain handover, the guidelines\
    \ need to take into\n   account other factors, such as movement pattern of the\
    \ mobile node,\n   cell size, etc.\n   The time needed to complete the pre-authentication\
    \ mechanism is an\n   important parameter, since the mobile node needs to determine\
    \ how\n   much ahead of time the mobile node needs to start the\n   pre-authentication\
    \ process so that it can finish the desired\n   operations before the handover\
    \ to the target network starts.  The\n   pre-authentication time will vary, depending\
    \ upon the speed of the\n   mobile node (e.g., pedestrian vs. vehicular) and cell\
    \ sizes (e.g.,\n   WiFi, Cellular).  Cell residence time is defined as the average\
    \ time\n   the mobile node stays in the cell before the next handoff takes\n \
    \  place.  Cell residence time is dependent upon the coverage area and\n   velocity\
    \ of the mobile node.  Thus, cell residence time is an\n   important factor in\
    \ determining the desirable pre-authentication time\n   that a mobile node should\
    \ consider.\n   Since the pre-authentication operation involves six steps as\n\
    \   described in Section 6.3 and each step takes some discrete amount of\n   time,\
    \ only part of these sub-operations may be completed before\n   handoff, depending\
    \ upon the available delay budget.\n   For example, a mobile node could complete\
    \ only network discovery and\n   the network-layer authentication process before\
    \ the handoff and\n   postpone the rest of the operations until after the handover\
    \ is\n   complete.  On the other hand, if it is a slow-moving vehicle and the\n\
    \   adjacent cells are sparsely spaced, a mobile node could complete all\n   the\
    \ desired MPA-related operations.  Finishing all the MPA-related\n   operations\
    \ ahead of time reduces the handoff delay but adds other\n   constraints, such\
    \ as cell residence time.\n   We give a numerical example here, similar to [MISHRA04].\n\
    \      D = Coverage diameter\n      v = Mobile node's velocity\n      RTT = round\
    \ trip time from AP to AAA server, including processing\n      time for authentication\
    \ (Tauth)\n      Tpsk = Time spent to install keys proactively on the target APs\n\
    \   If for a given value of D = 100 ft, Tpsk = 10 ms, and RTT = 100 ms, a\n  \
    \ mobile node needs to execute only the pre-authentication procedure\n   associated\
    \ with MPA, then the following can be calculated for a\n   successful MPA procedure\
    \ before the handoff is complete.\n      2RTT + Tpsk < D/v\n      v = 100 ft/(200\
    \ ms + 10 ms) = ~500 ft/sec\n   Similarly, for a similar cell size, if the mobile\
    \ node is involved in\n   both pre-authentication and pre-configuration operations\
    \ as part of\n   the MPA procedure, and it takes an amount of time Tconf = 190\
    \ ms to\n   complete the layer 3 configuration including IP address\n   configuration,\
    \ then for a successful MPA operation,\n      2RTT + Tpsk + Tconf < D/v\n    \
    \  v = 100 ft/(200 ms + 10 ms + 190 ms) = ~250 ft/sec\n   Thus, compared to only\
    \ the pre-authentication part of the MPA\n   operation, in order to be able to\
    \ complete both pre-authentication\n   and pre-configuration operations successfully,\
    \ either the mobile node\n   needs to move at a slower pace or it needs to expedite\
    \ these\n   operations for this given cell size.  Thus, types of MPA operations\n\
    \   will be constrained by the velocity of the mobile node.\n   As an alternative,\
    \ if a mobile node does complete all of the\n   pre-authentication procedure well\
    \ ahead of time, it uses up the\n   resources accordingly by way of an extra IP\
    \ address, tunnel, and\n   extra bandwidth.  Thus, there is always a tradeoff\
    \ between the\n   performance benefit obtained from the pre-authentication mechanism\n\
    \   and network characteristics, such as movement speed, cell size, and\n   resources\
    \ utilized.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ashutosh Dutta (editor)\n   NIKSUN\n   100 Nassau Park\
    \ Blvd.\n   Princeton, NJ  08540\n   USA\n   EMail: ashutosh.dutta@ieee.org\n\
    \   Victor Fajardo\n   NIKSUN\n   100 Nassau Park Blvd.\n   Princeton, NJ  08540\n\
    \   USA\n   EMail: vf0213@gmail.com\n   Yoshihiro Ohba\n   Corporate R&D Center,\
    \ Toshiba Corporation\n   1 Komukai-Toshiba-cho, Saiwai-ku\n   Kawasaki, Kanagawa\
    \  212-0001\n   Japan\n   EMail: yoshihiro.ohba@toshiba.co.jp\n   Kenichi Taniuchi\n\
    \   Toshiba Corporation\n   2-9 Suehiro-cho\n   Ome, Tokyo  198-8710\n   Japan\n\
    \   EMail: kenichi.taniuchi@toshiba.co.jp\n   Henning Schulzrinne\n   Columbia\
    \ University\n   Department of Computer Science\n   450 Computer Science Building\n\
    \   New York, NY  10027\n   USA\n   Phone: +1 212 939 7004\n   EMail: hgs@cs.columbia.edu\n"
