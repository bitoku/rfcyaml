- title: __initial_text__
  contents:
  - '      Recommendations for the Remediation of Bots in ISP Networks

    '
- title: Abstract
  contents:
  - "Abstract\n   This document contains recommendations on how Internet Service\n\
    \   Providers can use various remediation techniques to manage the\n   effects\
    \ of malicious bot infestations on computers used by their\n   subscribers.  Internet\
    \ users with infected computers are exposed to\n   risks such as loss of personal\
    \ data and increased susceptibility to\n   online fraud.  Such computers can also\
    \ become inadvertent\n   participants in or components of an online crime network,\
    \ spam\n   network, and/or phishing network as well as be used as a part of a\n\
    \   distributed denial-of-service attack.  Mitigating the effects of and\n   remediating\
    \ the installations of malicious bots will make it more\n   difficult for botnets\
    \ to operate and could reduce the level of online\n   crime on the Internet in\
    \ general and/or on a particular Internet\n   Service Provider's network.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6561.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Key Terminology ............................................3\n  \
    \         1.1.1. Malicious Bots, or Bots .............................3\n    \
    \       1.1.2. Bot Networks, or Botnets ............................4\n      \
    \     1.1.3. Host ................................................5\n        \
    \   1.1.4. Malware .............................................5\n          \
    \ 1.1.5. Fast Flux ...........................................5\n   2. Problem\
    \ Statement ...............................................6\n   3. Important\
    \ Notice of Limitations and Scope .......................7\n   4. Detection of\
    \ Bots ...............................................8\n   5. Notification to\
    \ Internet Users .................................12\n      5.1. Email Notification\
    \ ........................................13\n      5.2. Telephone Call Notification\
    \ ...............................13\n      5.3. Postal Mail Notification ..................................14\n\
    \      5.4. Walled Garden Notification ................................14\n  \
    \    5.5. Instant Message Notification ..............................16\n    \
    \  5.6. Short Message Service (SMS) Notification ..................16\n      5.7.\
    \ Web Browser Notification ..................................17\n      5.8. Considerations\
    \ for Notification to Public Network\n           Locations .................................................18\n\
    \      5.9. Considerations for Notification to Network\n           Locations Using\
    \ a Shared IP Address .......................18\n      5.10. Notification and\
    \ End User Expertise ......................19\n   6. Remediation of Hosts Infected\
    \ with a Bot .......................19\n      6.1. Guided Remediation Process\
    \ ................................21\n      6.2. Professionally Assisted Remediation\
    \ Process ...............22\n   7. Failure or Refusal to Remediate ................................23\n\
    \   8. Sharing of Data from the User to the ISP .......................23\n  \
    \ 9. Security Considerations ........................................23\n   10.\
    \ Privacy Considerations ........................................24\n   11. Acknowledgements\
    \ ..............................................24\n   12. Informative References\
    \ ........................................26\n   Appendix A.  Examples of Third-Party\
    \ Malware Lists ................28\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document contains recommendations on how Internet Service\n\
    \   Providers can use various remediation techniques to manage the\n   effects\
    \ of malicious bot infestations on computers used by their\n   subscribers.  Internet\
    \ users with infected computers are exposed to\n   risks such as loss of personal\
    \ data and increased susceptibility to\n   online fraud.  Such computers can also\
    \ become inadvertent\n   participants in or components of an online crime network,\
    \ spam\n   network, and/or phishing network as well as be used as a part of a\n\
    \   distributed denial-of-service attack.  Mitigating the effects of and\n   remediating\
    \ the installations of malicious bots will make it more\n   difficult for botnets\
    \ to operate and could reduce the level of online\n   crime on the Internet in\
    \ general and/or on a particular Internet\n   Service Provider's network.\n"
- title: 1.1.  Key Terminology
  contents:
  - "1.1.  Key Terminology\n   This section defines the key terms used in this document.\n"
- title: 1.1.1.  Malicious Bots, or Bots
  contents:
  - "1.1.1.  Malicious Bots, or Bots\n   A malicious or potentially malicious bot\
    \ (derived from the word\n   \"robot\", hereafter simply referred to as a \"bot\"\
    ) refers to a program\n   that is installed on a system in order to enable that\
    \ system to\n   automatically (or semi-automatically) perform a task or set of\
    \ tasks\n   typically under the command and control of a remote administrator,\
    \ or\n   \"bot master\".  Bots are also known as \"zombies\".  Such bots may have\n\
    \   been installed surreptitiously, without the user's full understanding\n  \
    \ of what the bot will do once installed, unknowingly as part of\n   another software\
    \ installation, under false pretenses, and/or in a\n   variety of other possible\
    \ ways.\n   It is important to note that there are \"good\" bots.  Such good bots\n\
    \   are often found interacting with a computing resource in environments\n  \
    \ such as gaming and Internet Relay Chat (IRC) [RFC1459], where a\n   continual,\
    \ interactive presence can be a requirement for\n   participating in the games.\
    \  Since such good bots are performing\n   useful, lawful, and non-disruptive\
    \ functions, there is no reason for\n   a provider to monitor for their presence\
    \ and/or alert users to their\n   presence.\n   While there may be good, or harmless\
    \ bots, for the purposes of this\n   document, all mention of bots shall assume\
    \ that the bots involved are\n   malicious or potentially malicious in nature.\
    \  Such malicious bots\n   shall generally be assumed to have been deployed without\
    \ the\n   permission or conscious understanding of a particular Internet user.\n\
    \   Thus, without a user's knowledge, bots may transform the user's\n   computing\
    \ device into a platform from which malicious activities can\n   be conducted.\
    \  In addition, included explicitly in this category are\n   potentially malicious\
    \ bots, which may initially appear neutral but\n   may simply be waiting for remote\
    \ instructions to transform and/or\n   otherwise begin engaging in malicious behavior.\
    \  In general,\n   installation of a malicious bot without user knowledge and\
    \ consent is\n   considered in most regions to be unlawful, and the activities\
    \ of\n   malicious bots typically involve unlawful or other maliciously\n   disruptive\
    \ activities.\n"
- title: 1.1.2.  Bot Networks, or Botnets
  contents:
  - "1.1.2.  Bot Networks, or Botnets\n   A \"bot network\", or \"botnet\", is defined\
    \ as a concerted network of\n   bots capable of acting on instructions generated\
    \ remotely.  The\n   malicious activities are either focused on the information\
    \ on the\n   local machine or acting to provide services for remote machines.\n\
    \   Bots are highly customizable so they can be programmed to do many\n   things.\
    \  The major malicious activities include but are not limited\n   to identity\
    \ theft, spam, spim (spam over Instant Messaging (IM)),\n   spit (spam over Internet\
    \ telephony), email address harvesting,\n   distributed denial-of-service (DDoS)\
    \ attacks, key-logging, fraudulent\n   DNS pharming (redirection), hosting proxy\
    \ services, fast flux (see\n   Section 1.1.5) hosting, hosting of illegal content,\
    \ use in man-in-\n   the-middle attacks, and click fraud.\n   Infection vectors\
    \ (infection pathways) include un-patched operating\n   systems, software vulnerabilities\
    \ (which include so-called zero-day\n   vulnerabilities where no patch yet exists),\
    \ weak/non-existent\n   passwords, malicious web sites, un-patched browsers, malware,\n\
    \   vulnerable helper applications, inherently insecure protocols,\n   protocols\
    \ implemented without security features switched on, and\n   social engineering\
    \ techniques to gain access to the user's computer.\n   The detection and destruction\
    \ of bots is an ongoing issue and also a\n   constant battle between the Internet\
    \ security community and network\n   security engineers on the one hand and bot\
    \ developers on the other.\n   Initially, some bots used IRC to communicate but\
    \ were easy to shut\n   down if the command and control server was identified\
    \ and\n   deactivated.  Newer command and control methods have evolved, such\n\
    \   that those currently employed by bot masters make them much more\n   resistant\
    \ to deactivation.  With the introduction of peer-to-peer\n   (P2P) architectures\
    \ and associated protocols, the use of HTTP and\n   other resilient communication\
    \ protocols, and the widespread adoption\n   of encryption, bots are considerably\
    \ more difficult to identify and\n   isolate from typical network usage.  As a\
    \ result, increased reliance\n   is being placed on anomaly detection and behavioral\
    \ analysis, both\n   locally and remotely, to identify bots.\n"
- title: 1.1.3.  Host
  contents:
  - "1.1.3.  Host\n   As used in the context of this document, the host or computer\
    \ of an\n   end user is intended to refer to a computing device that connects\
    \ to\n   the Internet.  This encompasses devices used by Internet users such\n\
    \   as personal computers (including laptops, desktops, and netbooks),\n   mobile\
    \ phones, smart phones, home gateway devices, and other end user\n   computing\
    \ devices that are connected or can connect to the public\n   Internet and/or\
    \ private IP networks.\n   Increasingly, other household systems and devices contain\
    \ embedded\n   hosts that are connected to or can connect to the public Internet\n\
    \   and/or private IP networks.  However, these devices may not be under\n   interactive\
    \ control of the Internet user, such as may be the case\n   with various smart\
    \ home and smart grid devices.\n"
- title: 1.1.4.  Malware
  contents:
  - "1.1.4.  Malware\n   Malware is short for \"malicious software\".  In this case,\
    \ malicious\n   bots are considered a subset of malware.  Other forms of malware\n\
    \   could include viruses and other similar types of software.  Internet\n   users\
    \ can sometimes cause their hosts to be infected with malware,\n   which may include\
    \ a bot or cause a bot to install itself, via\n   inadvertently accessing a specific\
    \ web site, downloading a file, or\n   other activities.\n   In other cases, Internet-connected\
    \ hosts may become infected with\n   malware through externally initiated malicious\
    \ activities such as the\n   exploitation of vulnerabilities or the brute force\
    \ guessing of access\n   credentials.\n"
- title: 1.1.5.  Fast Flux
  contents:
  - "1.1.5.  Fast Flux\n   Domain Name System (DNS) fast fluxing occurs when a domain\
    \ is bound\n   in DNS using A records to multiple IP addresses, each of which\
    \ has a\n   very short Time-to-Live (TTL) value associated with it.  This means\n\
    \   that the domain resolves to varying IP addresses over a short period\n   of\
    \ time.\n   DNS fast flux is typically used in conjunction with proxies that are\n\
    \   normally run on compromised user hosts.  These proxies route the web\n   requests\
    \ to the real host, which serves the data being sought.  The\n   effect of this\
    \ is to make the detection of the real host much more\n   difficult and to ensure\
    \ that the backend or hidden site remains up\n   for as long as possible.\n"
- title: 2.  Problem Statement
  contents:
  - "2.  Problem Statement\n   Hosts used by Internet users, which in this case are\
    \ customers of an\n   Internet Service Provider (ISP), can be infected with malware\
    \ that\n   may contain and/or install one or more bots on a host.  They can\n\
    \   present a major problem for an ISP for a number of reasons (not to\n   mention,\
    \ of course, the problems created for users).  First, these\n   bots can be used\
    \ to send spam, in some cases very large volumes of\n   spam [Spamalytics].  This\
    \ spam can result in extra cost for the ISPs\n   in terms of wasted network, server,\
    \ and/or personnel resources, among\n   many other potential costs and side effects.\
    \  Such spam can also\n   negatively affect the reputation of the ISP, their customers,\
    \ and the\n   email reputation of the IP address space used by the ISP (often\n\
    \   referred to simply as \"IP reputation\").  A further potential\n   complication\
    \ is that IP space compromised by bad reputation may\n   continue to carry this\
    \ bad reputation even when used for entirely\n   innocent purposes following reassignment\
    \ of that IP space.\n   In addition, these bots can act as platforms for directing,\n\
    \   participating in, or otherwise conducting attacks on critical\n   Internet\
    \ infrastructure [Threat-Report].  Bots are frequently used as\n   part of coordinated\
    \ DDoS attacks for criminal, political, or other\n   motivations [Gh0st][Dragon][DDoS].\
    \  For example, bots have been used\n   to attack Internet resources and infrastructure\
    \ ranging from web\n   sites to email servers and DNS servers, as well as the\
    \ critical\n   Internet infrastructure of entire countries [Estonia][Combat-Zone].\n\
    \   Motivations for such coordinated DDoS attacks can range from criminal\n  \
    \ extortion attempts through to online protesting and nationalistic\n   fervor\
    \ [Whiz-Kid].  DDoS attacks may also be motivated by simple\n   personal vendettas\
    \ or by persons simply seeking a cheap thrill at the\n   expense of others.\n\
    \   There is good evidence to suggest that bots are being used in the\n   corporate\
    \ environment for purposes of corporate espionage including\n   the exfiltration\
    \ of corporate financial data and intellectual\n   property.  This also extends\
    \ to the possibility of bots being used\n   for state-sponsored purposes such\
    \ as espionage.\n   While any computing device can be infected with bots, the\
    \ majority of\n   bot infections affect the personal computers used by Internet\
    \ end\n   users.  As a result of the role of ISPs in providing IP connectivity,\n\
    \   among many other services, to Internet users, these ISPs are in a\n   unique\
    \ position to be able to attempt to detect and observe botnets\n   operating in\
    \ their networks.  Furthermore, ISPs may also be in a\n   unique position to be\
    \ able to notify their customers of actual,\n   potential, or likely infection\
    \ by bots or other infection.\n   From the perspective of end users, being notified\
    \ that they may have\n   an infected computer on their network is important information.\
    \  Once\n   they know this, they can take steps to remove the bots, resolve any\n\
    \   problems that may stem from the bot infection, and protect themselves\n  \
    \ against future threats.  It is important to notify users that they\n   may be\
    \ infected with a bot because bots can consume vast amounts of\n   local computing\
    \ and network resources, enable theft of personal\n   information (including personal\
    \ financial information), enable the\n   host to be used for criminal activities\
    \ (that may result in the\n   Internet user being legally culpable), and destroy\
    \ or leave the host\n   in an unrecoverable state via \"kill switch\" bot technologies.\n\
    \   As a result, the intent of this document is to provide guidance to\n   ISPs\
    \ and other organizations for the remediation of hosts infected\n   with bots,\
    \ so as to reduce the size of botnets and minimize the\n   potential harm that\
    \ bots can inflict upon Internet infrastructure in\n   general as well as on individual\
    \ Internet users.  Efforts by ISPs and\n   other organizations can, over time,\
    \ reduce the pool of hosts infected\n   with bots on the Internet, which in turn\
    \ could result in smaller\n   botnets with less capability for disruption.\n \
    \  The potential mitigation of bots is accomplished through a process of\n   detection,\
    \ notification to Internet users, and remediation of bot\n   infections with a\
    \ variety of tools, as described later in this\n   document.\n"
- title: 3.  Important Notice of Limitations and Scope
  contents:
  - "3.  Important Notice of Limitations and Scope\n   The techniques described in\
    \ this document in no way guarantee the\n   remediation of all bots.  Bot removal\
    \ is potentially a task requiring\n   specialized knowledge, skills, and tools;\
    \ it may be beyond the\n   ability of average users.  Attempts at bot removal\
    \ may frequently be\n   unsuccessful, or only partially successful, leaving the\
    \ user's system\n   in an unstable and unsatisfactory state or even in a state\
    \ where it\n   is still infected.  Attempts at bot removal can result in side\n\
    \   effects ranging from a loss of data to partial or complete loss of\n   system\
    \ usability.\n   In general, the only way a user can be sure they have removed\
    \ some of\n   today's increasingly sophisticated malware is by \"nuking-and-paving\"\
    \n   the system: reformatting the drive, reinstalling the operating system\n \
    \  and applications (including all patches) from scratch, and then\n   restoring\
    \ user files from a known clean backup.  However, the\n   introduction of persistent\
    \ memory-based malware may mean that, in\n   some cases, this may not be enough\
    \ and may prove to be more than any\n   end user can be reasonably expected to\
    \ resolve [BIOS].  Experienced\n   users would have to re-flash or re-image persistent\
    \ memory sections\n   or components of their hosts in order to remove persistent\
    \ memory-\n   based malware.  However, in some cases, not even nuking-and-paving\n\
    \   the system will solve the problem, which calls for hard drive\n   replacement\
    \ and/or complete replacement of the host.\n   Devices with embedded operating\
    \ systems, such as video gaming\n   consoles and smart home appliances, will most\
    \ likely be beyond a\n   user's capability to remediate by themselves and could\
    \ therefore\n   require the aid of vendor-specific advice, updates, and tools.\n\
    \   However, in some cases, such devices will have a function or switch\n   to\
    \ enable the user to reset that device to a factory default\n   configuration,\
    \ which may sometimes enable the user to remediate the\n   infection.  Care should\
    \ be taken when imparting remediation advice to\n   Internet users given the increasingly\
    \ wide array of computing devices\n   that can be, or could be, infected by bots\
    \ in the future.\n   This document is not intended to address the issues relating\
    \ to the\n   prevention of bots on an end user device.  This is out of the scope\n\
    \   of this document.\n"
- title: 4.  Detection of Bots
  contents:
  - "4.  Detection of Bots\n   An ISP must first identify that an Internet user is\
    \ infected or\n   likely to have been infected with a bot (a user is assumed to\
    \ be\n   their customer or otherwise connected to the ISP's network).  The ISP\n\
    \   should attempt to detect the presence of bots using methods,\n   processes,\
    \ and tools that maintain the privacy of the personally\n   identifiable information\
    \ (PII) of their customers.  The ISP should\n   not block legitimate traffic in\
    \ the course of bot detection and\n   should instead employ detection methods,\
    \ tools, and processes that\n   seek to be non-disruptive and transparent to Internet\
    \ users and end\n   user applications.\n   Detection methods, tools, and processes\
    \ may include analysis of\n   specific network and/or application traffic flows\
    \ (such as traffic to\n   an email server), analysis of aggregate network and/or\
    \ application\n   traffic data, data feeds received from other ISPs and organizations\n\
    \   (such as lists of the ISP's IP addresses that have been reported to\n   have\
    \ sent spam), feedback from the ISP's customers or other Internet\n   users, as\
    \ well as a wide variety of other possibilities.  In\n   practice, it has proven\
    \ effective to confirm a bot infection through\n   the use of a combination of\
    \ multiple bot detection data points.  This\n   can help to corroborate information\
    \ of varying dependability or\n   consistency, as well as to avoid or minimize\
    \ the possibility of false\n   positive identification of hosts.  Detection should\
    \ also, where\n   possible and feasible, attempt to classify the specific bot\
    \ infection\n   type in order to confirm that it is malicious in nature, estimate\
    \ the\n   variety and severity of threats it may pose (such as spam bot, key-\n\
    \   logging bot, file distribution bot, etc.), and determine potential\n   methods\
    \ for eventual remediation.  However, given the dynamic nature\n   of botnet management\
    \ and the criminal incentives to seek quick\n   financial rewards, botnets frequently\
    \ update or change their core\n   capabilities.  As a consequence, botnets that\
    \ are initially detected\n   and classified by the ISP as made up of one particular\
    \ type of bot\n   need to be continuously monitored and tracked in order to correctly\n\
    \   identify the threat the botnet poses at any particular point in time.\n  \
    \ Detection is also time sensitive.  If complex analysis is required\n   and multiple\
    \ confirmations are needed to verify a bot is indeed\n   present, then it is possible\
    \ that the bot may cause some damage (to\n   either the infected host or a remotely\
    \ targeted system) before it can\n   be stopped.  This means that an ISP needs\
    \ to balance the desire or\n   need to definitively classify and/or confirm the\
    \ presence of a bot,\n   which may take an extended period of time, with the ability\
    \ to\n   predict the likelihood of a bot in a very short period of time.  Such\n\
    \   determinations must have a relatively low false positive rate in\n   order\
    \ to maintain the trust of users.  This \"definitive-versus-\n   likely\" challenge\
    \ is difficult and, when in doubt, ISPs should err on\n   the side of caution\
    \ by communicating that a bot infection has taken\n   place.  This also means\
    \ that Internet users may benefit from the\n   installation of client-based security\
    \ software on their host.  This\n   can enable rapid heuristically based detection\
    \ of bot activity, such\n   as the detection of a bot as it starts to communicate\
    \ with other\n   botnets and execute commands.  Any bot detection system should\
    \ also\n   be capable of adapting, either via manual intervention or\n   automatically,\
    \ in order to cope with a rapidly evolving threat.\n   As noted above, detection\
    \ methods, tools, and processes should ensure\n   that privacy of customers' personally\
    \ identifiable information (PII)\n   is maintained.  This protection afforded\
    \ to PII should also extend to\n   third parties processing data on behalf of\
    \ ISPs.  While bot detection\n   methods, tools, and processes are similar to\
    \ spam and virus defenses\n   deployed by the ISP for the benefit of their customers\
    \ (and may be\n   directly related to those defenses), attempts to detect bots\
    \ should\n   take into account the need of an ISP to take care to ensure any PII\n\
    \   collected or incidentally detected is properly protected.  This is\n   important\
    \ because just as spam defenses may involve scanning the\n   content of email\
    \ messages, which may contain PII, then so too may bot\n   defenses similarly\
    \ come into incidental contact with PII.  The\n   definition of PII varies from\
    \ one jurisdiction to the next so proper\n   care should be taken to ensure that\
    \ any actions taken comply with\n   legislation and good practice in the jurisdiction\
    \ in which the PII is\n   gathered.  Finally, depending upon the geographic region\
    \ within which\n   an ISP operates, certain methods relating to bot detection\
    \ may need\n   to be included in relevant terms of service documents or other\n\
    \   documents that are available to the customers of a particular ISP.\n   There\
    \ are several bot detection methods, tools, and processes that an\n   ISP may\
    \ choose to utilize, as noted in the list below.  It is\n   important to note\
    \ that the technical solutions available are\n   relatively immature and are likely\
    \ to change over time, evolving\n   rapidly in the coming years.  While these\
    \ items are described in\n   relation to ISPs, they may also be applicable to\
    \ organizations\n   operating other networks, such as campus networks and enterprise\n\
    \   networks.\n   a.  Where it is not legally proscribed and an accepted industry\n\
    \       practice in a particular market region, an ISP may in some manner\n  \
    \     \"scan\" its IP space in order to detect un-patched or otherwise\n     \
    \  vulnerable hosts or to detect the signs of infection.  This may\n       provide\
    \ the ISP with the opportunity to easily identify Internet\n       users who appear\
    \ already to be infected or are at great risk of\n       being infected with a\
    \ bot.  ISPs should note that some types of\n       port scanning may leave network\
    \ services in a hung state or\n       render them unusable due to common frailties\
    \ and that many modern\n       firewall and host-based intrusion detection implementations\
    \ may\n       alert the Internet user to the scan.  As a result, the scan may\n\
    \       be interpreted as a malicious attack against the host.\n       Vulnerability\
    \ scanning has a higher probability of leaving\n       accessible network services\
    \ and applications in a damaged state\n       and will often result in a higher\
    \ probability of detection by the\n       Internet user and subsequent interpretation\
    \ as a targeted attack.\n       Depending upon the vulnerability for which an\
    \ ISP may be\n       scanning, some automated methods of vulnerability checking\
    \ may\n       result in data being altered or created afresh on the Internet\n\
    \       user's host, which can be a problem in many legal environments.\n    \
    \   It should also be noted that due to the prevalence of Network\n       Address\
    \ Translation devices, Port Address Translation devices,\n       and/or firewall\
    \ devices in user networks, network-based\n       vulnerability scanning may be\
    \ of limited value.  Thus, while we\n       note that this is one technique that\
    \ may be utilized, it is\n       unlikely to be particularly effective and has\
    \ problematic side\n       effects, which leads the authors to recommend against\
    \ the use of\n       this particular method.\n   b.  An ISP may also communicate\
    \ and share selected data, via feedback\n       loops or other mechanisms, with\
    \ various third parties.  Feedback\n       loops are consistently formatted feeds\
    \ of real-time (or nearly\n       real-time) abuse reports offered by threat data\
    \ clearinghouses,\n       security alert organizations, other ISPs, and other\n\
    \       organizations.  The formats for feedback loops include those\n       defined\
    \ in both the Abuse Reporting Format (ARF) [RFC5965] and\n       the Incident\
    \ Object Description Exchange Format (IODEF)\n       [RFC5070].  The data may\
    \ include, but is not limited to, IP\n       addresses of hosts that appear to\
    \ be either definitely or\n       probably infected, IP addresses, domain names\
    \ or fully qualified\n       domain names (FQDNs) known to host malware and/or\
    \ be involved in\n       the command and control of botnets, recently tested or\
    \ discovered\n       techniques for detecting or remediating bot infections, new\n\
    \       threat vectors, and other relevant information.  A few good\n       examples\
    \ of data sharing are noted in Appendix A.\n   c.  An ISP may use Netflow [RFC3954]\
    \ or other similar passive network\n       monitoring to identify network anomalies\
    \ that may be indicative\n       of botnet attacks or bot communications.  For\
    \ example, an ISP may\n       be able to identify compromised hosts by identifying\
    \ traffic\n       destined to IP addresses associated with the command and control\n\
    \       of botnets or destined to the combination of an IP address and\n     \
    \  control port associated with a command and control network\n       (sometimes\
    \ command and control traffic comes from a host that has\n       legitimate traffic).\
    \  In addition, bots may be identified when a\n       remote host is under a DDoS\
    \ attack, because hosts participating\n       in the attack will likely be infected\
    \ by a bot.  This can often\n       be observed at network borders although ISPs\
    \ should beware of\n       source IP address spoofing techniques that may be employed\
    \ to\n       avoid or confuse detection.\n   d.  An ISP may use DNS-based techniques\
    \ to perform detection.  For\n       example, a given classified bot may be known\
    \ to query a specific\n       list of domain names at specific times or on specific\
    \ dates (in\n       the example of the so-called \"Conficker\" bot (see [Conficker]),\n\
    \       often by matching DNS queries to a well-known list of domains\n      \
    \ associated with malware.  In many cases, such lists are\n       distributed\
    \ by or shared using third parties, such as threat data\n       clearinghouses.\n\
    \   e.  Because hosts infected by bots are frequently used to send spam\n    \
    \   or participate in DDoS attacks, the ISP servicing those hosts\n       will\
    \ normally receive complaints about the malicious network\n       traffic.  Those\
    \ complaints may be sent to role accounts specified\n       in RFC 2142 [RFC2142],\
    \ such as abuse@, or to other relevant\n       addresses such as to abuse or security\
    \ addresses specified by the\n       site as part of its WHOIS (or other) contact\
    \ data.\n   f.  ISPs may also discover likely bot-infected hosts located on other\n\
    \       networks.  Thus, when legally permissible in a particular market\n   \
    \    region, it may be worthwhile for ISPs to share information\n       relating\
    \ to those compromised hosts with the relevant remote\n       network operator,\
    \ security researchers, and blocklist operators.\n   g.  ISPs may operate or subscribe\
    \ to services that provide\n       \"sinkholing\" or \"honeynet\" capabilities.\
    \  This may enable the ISP\n       to obtain near-real-time lists of bot-infected\
    \ hosts as they\n       attempt to join a larger botnet or propagate to other\
    \ hosts on a\n       network.\n   h.  ISP industry associations should examine\
    \ the possibility of\n       collating statistics from ISP members in order to\
    \ provide good\n       statistics about bot infections based on real ISP data.\n\
    \   i.  An Intrusion Detection System (IDS) can be a useful tool to\n       actually\
    \ help identify the malware.  An IDS tool such as Snort\n       (open source IDS\
    \ platform; see [Snort]) can be placed in a walled\n       garden and used to\
    \ analyze end user traffic to confirm malware\n       type.  This will help with\
    \ remediation of the infected device.\n"
- title: 5.  Notification to Internet Users
  contents:
  - "5.  Notification to Internet Users\n   Once an ISP has detected a bot, or the\
    \ strong likelihood of a bot,\n   steps should be undertaken to inform the Internet\
    \ user that they may\n   have a bot-related problem.  An ISP should decide the\
    \ most\n   appropriate method or methods for providing notification to one or\n\
    \   more of their customers or Internet users, depending upon a range of\n   factors\
    \ including the technical capabilities of the ISP, the\n   technical attributes\
    \ of its network, financial considerations,\n   available server resources, available\
    \ organizational resources, the\n   number of likely infected hosts detected at\
    \ any given time, and the\n   severity of any possible threats.  Such notification\
    \ methods may\n   include one or more of the methods described in the following\n\
    \   subsections, as well as other possible methods not described below.\n   It\
    \ is important to note that none of these methods are guaranteed to\n   be one\
    \ hundred percent successful and that each has its own set of\n   limitations.\
    \  In addition, in some cases, an ISP may determine that a\n   combination of\
    \ two or more methods is most appropriate and effective\n   and reduces the chance\
    \ that malware may block a notification.  As\n   such, the authors recommend the\
    \ use of multiple notification methods.\n   Finally, notification is also considered\
    \ time sensitive; if the user\n   does not receive or view the notification in\
    \ a timely fashion, then a\n   particular bot could launch an attack, exploit\
    \ the user, or cause\n   other harm.  If possible, an ISP should establish a preferred\
    \ means\n   of communication when the subscriber first signs up for service. \
    \ As\n   a part of the notification process, ISPs should maintain a record of\n\
    \   the allocation of IP addresses to subscribers for a period long\n   enough\
    \ to allow any commonly used bot detection technology to be able\n   to accurately\
    \ link an infected IP address to a subscriber.  This\n   record should only be\
    \ maintained for a period of time that is\n   necessary to support bot detection,\
    \ but no longer, in order to\n   protect the privacy of the individual subscriber.\n\
    \   One important factor to bear in mind is that notification to end\n   users\
    \ needs to be resistant to potential spoofing.  This should be\n   done to protect,\
    \ as reasonably as possible, against the potential of\n   legitimate notifications\
    \ being spoofed and/or used by parties with\n   intent to perform additional malicious\
    \ attacks against victims of\n   malware or even to deliver additional malware.\n\
    \   It should be possible for the end user to indicate the preferred\n   means\
    \ of notification on an opt-in basis for that notification\n   method.  It is\
    \ recommended that the end user should not be allowed to\n   opt out of notification\
    \ entirely.\n   When users are notified, an ISP should endeavor to give as much\n\
    \   information as possible to the end user regarding which bot detection\n  \
    \ methods are employed at the ISP, consonant with not providing\n   information\
    \ to those creating or deploying the bots so that they\n   would be able to avoid\
    \ detection.\n"
- title: 5.1.  Email Notification
  contents:
  - "5.1.  Email Notification\n   This is a common form of notification used by ISPs.\
    \  One drawback of\n   using email is that it is not guaranteed to be viewed within\
    \ a\n   reasonable time frame, if at all.  The user may be using a different\n\
    \   primary email address than the one they provided to the ISP.  In\n   addition,\
    \ some ISPs do not provide an email account at all as part of\n   a bundle of\
    \ Internet services and/or do not have a need for or method\n   by which to request\
    \ or retain the primary email addresses of Internet\n   users of their networks.\
    \  Another possibility is that the user, their\n   email client, and/or their\
    \ email servers could determine or classify\n   such a notification as spam, which\
    \ could delete the message or\n   otherwise file it in an email folder that the\
    \ user may not check on a\n   regular and/or timely basis.  Bot masters have also\
    \ been known to\n   impersonate the ISP or trusted sender and send fraudulent\
    \ emails to\n   the users.  This technique of social engineering often leads to\
    \ new\n   bot infestations.  Finally, if the user's email credentials are\n  \
    \ compromised, then a hacker and/or a bot could simply access the\n   user's email\
    \ account and delete the email before it is read by the\n   user.\n"
- title: 5.2.  Telephone Call Notification
  contents:
  - "5.2.  Telephone Call Notification\n   A telephone call may be an effective means\
    \ of communication in\n   particularly high-risk situations.  However, telephone\
    \ calls may not\n   be feasible due to the cost of making a large number of calls,\
    \ as\n   measured in either time, money, organizational resources, server\n  \
    \ resources, or some other means.  In addition, there is no guarantee\n   that\
    \ the user will answer their phone.  To the extent that the\n   telephone number\
    \ called by the ISP can be answered by the infected\n   computing device, the\
    \ bot on that host may be able to disconnect,\n   divert, or otherwise interfere\
    \ with an incoming call.  Users may also\n   interpret such a telephone notification\
    \ as a telemarketing call and\n   therefore not welcome it or not accept the call\
    \ at all.  Finally,\n   even if a representative of the ISP is able to connect\
    \ with and speak\n   to a user, that user is very likely to lack the necessary\
    \ technical\n   expertise to understand or be able to effectively deal with the\n\
    \   threat.\n"
- title: 5.3.  Postal Mail Notification
  contents:
  - "5.3.  Postal Mail Notification\n   This form of notification is probably the\
    \ least popular and effective\n   means of communication, due to preparation time,\
    \ delivery time, the\n   cost of printing and paper, and the cost of postage.\n"
- title: 5.4.  Walled Garden Notification
  contents:
  - "5.4.  Walled Garden Notification\n   Placing a user in a walled garden is another\
    \ approach that ISPs may\n   take to notify users.  A \"walled garden\" refers\
    \ to an environment\n   that controls the information and services that a subscriber\
    \ is\n   allowed to utilize and what network access permissions are granted.\n\
    \   A walled garden implementation can range from strict to leaky.  In a\n   strict\
    \ walled garden environment, access to most Internet resources\n   is typically\
    \ limited by the ISP.  In contrast, a leaky walled garden\n   environment permits\
    \ access to all Internet resources, except those\n   deemed malicious, and ensures\
    \ access to those that can be used to\n   notify users of infections.\n   Walled\
    \ gardens are effective because it is possible to notify the\n   user and simultaneously\
    \ block all communication between the bot and\n   the command and control channel.\
    \  While in many cases the user is\n   almost guaranteed to view the notification\
    \ message and take any\n   appropriate remediation actions, this approach can\
    \ pose other\n   challenges.  For example, it is not always the case that a user\
    \ is\n   actively utilizing a host that implements a web browser, has a web\n\
    \   browser actively running on it, or operates another application that\n   uses\
    \ ports that are redirected to the walled garden.  In one example,\n   a user\
    \ could be playing a game online, via the use of a dedicated,\n   Internet-connected\
    \ game console.  In another example, the user may\n   not be using a host with\
    \ a web browser when they are placed in the\n   walled garden and may instead\
    \ be in the course of a telephone\n   conversation or may be expecting to receive\
    \ a call using a Voice over\n   IP (VoIP) device of some type.  As a result, the\
    \ ISP may feel the\n   need to maintain a potentially lengthy white list of domains\
    \ that are\n   not subject to the typical restrictions of a walled garden, which\n\
    \   could well prove to be an onerous task from an operational\n   perspective.\n\
    \   For these reasons, the implementation of a leaky walled garden makes\n   more\
    \ sense, but a leaky walled garden has a different set of\n   drawbacks.  The\
    \ ISP has to assume that the user will eventually use a\n   web browser to acknowledge\
    \ the notification; otherwise, the user will\n   remain in the walled garden and\
    \ not know it.  If the intent of the\n   leaky walled garden is solely to notify\
    \ the user about the bot\n   infection, then the leaky walled garden is not ideal\
    \ because\n   notification is time sensitive, and the user may not receive the\n\
    \   notification until the user invokes a request for the targeted\n   service\
    \ and/or resource.  This means the bot can potentially do more\n   damage.  Additionally,\
    \ the ISP has to identify which services and/or\n   resources to restrict for\
    \ the purposes of notification.  This does\n   not have to be resource specific\
    \ and can be time based and/or policy\n   based.  An example of how notification\
    \ could be made on a timed basis\n   could involve notification for all HTTP requests\
    \ every 10 minutes, or\n   show the notification for one in five HTTP requests.\n\
    \   The ISP has several options to determine when to let the user out of\n   the\
    \ walled garden.  One approach may be to let the user determine\n   when to exit.\
    \  This option is suggested when the primary purpose of\n   the walled garden\
    \ is to notify users and provide information on\n   remediation only, particularly\
    \ since notification is not a guarantee\n   of successful remediation.  It could\
    \ also be the case that, for\n   whatever reason, the user makes the judgment\
    \ that they cannot then\n   take the time to remediate their host and that other\
    \ online\n   activities that they would like to resume are more important.  Exit\n\
    \   from the walled garden may also involve a process to verify that it\n   is\
    \ indeed the user who is requesting exit from the walled garden and\n   not the\
    \ bot.\n   Once the user acknowledges the notification, they may decide either\n\
    \   to remediate and exit the walled garden or to exit the walled garden\n   without\
    \ remediating the issue.  Another approach may be to enforce a\n   stricter policy\
    \ and require the user to clean the host prior to\n   permitting the user to exit\
    \ the walled garden, though this may not be\n   technically feasible depending\
    \ upon the type of bot, obfuscation\n   techniques employed by a bot, and/or a\
    \ range of other factors.  Thus,\n   the ISP may also need to support tools to\
    \ scan the infected host (in\n   the style of a virus scan, rather than a port\
    \ scan) and determine\n   whether it is still infected or rely on user judgment\
    \ that the bot\n   has been disabled or removed.  One challenge with this approach\
    \ is\n   that the user might have multiple hosts sharing a single IP address,\n\
    \   such as via a common home gateway device that performs Network\n   Address\
    \ Translation (NAT).  In such a case, the ISP may need to\n   determine from user\
    \ feedback, or other means, that all affected hosts\n   have been remediated,\
    \ which may or may not be technically feasible.\n   Finally, when a walled garden\
    \ is used, a list of well-known addresses\n   for both operating system vendors\
    \ and security vendors should be\n   created and maintained in a white list that\
    \ permits access to these\n   sites.  This can be important for allowing access\
    \ from the walled\n   garden by end users in search of operating system and application\n\
    \   patches.  It is recommended that walled gardens be seriously\n   considered\
    \ as a method of notification as they are easy to implement\n   and proven to\
    \ be effective as a means of getting end user attention.\n"
- title: 5.5.  Instant Message Notification
  contents:
  - "5.5.  Instant Message Notification\n   IM provides the ISP with a simple means\
    \ to communicate with the user.\n   There are several advantages to using IM that\
    \ make it an attractive\n   option.  If the ISP provides IM service and the user\
    \ subscribes to\n   it, then the user can be notified easily.  IM-based notification\
    \ can\n   be a cost-effective means to communicate with users automatically\n\
    \   from an IM alert system or by a manual process, involving the ISP's\n   support\
    \ staff.  Ideally, the ISP should allow the user to register\n   their IM identity\
    \ in an ISP account management system and grant\n   permission to be contacted\
    \ via this means.  If the IM service\n   provider supports off-line messaging,\
    \ then the user can be notified\n   regardless of whether they are currently logged\
    \ into the IM system.\n   There are several drawbacks with this communications\
    \ method.  There\n   is a high probability that a subscriber may interpret the\n\
    \   communication to be spim and thus ignore it.  Also, not every user\n   uses\
    \ IM and/or the user may not provide their IM identity to the ISP\n   so some\
    \ alternative means have to be used.  Even in those cases where\n   a user does\
    \ have an IM address, they may not be signed onto that IM\n   system when the\
    \ notification is attempted.  There may be a privacy\n   concern on the part of\
    \ users when such an IM notification must be\n   transmitted over a third-party\
    \ network and/or IM service.  As such,\n   should this method be used, the notification\
    \ should be discreet and\n   not include any PII in the notification itself.\n"
- title: 5.6.  Short Message Service (SMS) Notification
  contents:
  - "5.6.  Short Message Service (SMS) Notification\n   SMS allows the ISP to send\
    \ a brief description of the problem to\n   notify the user of the issue, typically\
    \ to a mobile device such as a\n   mobile phone or smart phone.  Ideally, the\
    \ ISP should allow the user\n   to register their mobile number and/or SMS address\
    \ in an ISP account\n   management system and grant permission to be contacted\
    \ via this\n   means.  The primary advantage of SMS is that users are familiar\
    \ with\n   receiving text messages and are likely to read them.  However, users\n\
    \   may not act on the notification immediately if they are not in front\n   of\
    \ their host at the time of the SMS notification.\n   One disadvantage is that\
    \ ISPs may have to follow up with an alternate\n   means of notification if not\
    \ all of the necessary information may be\n   conveyed in one message, given constraints\
    \ on the number of\n   characters in an individual message (typically 140 characters).\n\
    \   Another disadvantage with SMS is the cost associated with it.  The\n   ISP\
    \ has to either build its own SMS gateway to interface with the\n   various wireless\
    \ network service providers or use a third-party SMS\n   clearinghouse (relay)\
    \ to notify users.  In both cases, an ISP may\n   incur fees related to SMS notifications,\
    \ depending upon the method\n   used to send the notifications.  An additional\
    \ downside is that SMS\n   messages sent to a user may result in a charge to the\
    \ user by their\n   wireless provider, depending upon the plan to which they subscribe\n\
    \   and the country in which the user resides.  Another minor\n   disadvantage\
    \ is that it is possible to notify the wrong user if the\n   intended user changes\
    \ their mobile number but forgets to update it\n   with the ISP.\n   There are\
    \ several other drawbacks with this communications method.\n   There is a high\
    \ probability that subscriber may interpret the\n   communication to be spam and\
    \ thus ignore it.  Also, not every user\n   uses SMS, and/or the user may not\
    \ provide their SMS address or mobile\n   number to the ISP.  Even in those cases\
    \ where a user does have an SMS\n   address or mobile number, their device may\
    \ not be powered on or\n   otherwise available on a wireless network when the\
    \ notification is\n   attempted.  There may also be a privacy concern on the part\
    \ of users\n   when such an SMS notification must be transmitted over a third-party\n\
    \   network and/or SMS clearinghouse.  As such, should this method be\n   used,\
    \ the notification should be discreet and not include any PII in\n   the notification\
    \ itself.\n"
- title: 5.7.  Web Browser Notification
  contents:
  - "5.7.  Web Browser Notification\n   Near-real-time notification to the user's\
    \ web browser is another\n   technique that may be utilized for notifying the\
    \ user [RFC6108],\n   though how such a system might operate is outside the scope\
    \ of this\n   document.  Such a notification could have a comparative advantage\n\
    \   over a walled garden notification, in that it does not restrict\n   traffic\
    \ to a specified list of destinations in the same way that a\n   walled garden\
    \ would, by definition.  However, as with a walled garden\n   notification, there\
    \ is no guarantee that a user is making use of a\n   web browser at any given\
    \ time, though such a system could certainly\n   provide a notification when such\
    \ a browser is eventually used.\n   Compared to a walled garden, a web browser\
    \ notification is probably\n   preferred from the perspective of Internet users,\
    \ as it does not have\n   the risk of disrupting non-web sessions, such as online\
    \ games, VoIP\n   calls, etc. (as noted in Section 5.4).\n   There are alternative\
    \ methods of web browser notification offered\n   commercially by a number of\
    \ vendors.  Many of the techniques used are\n   proprietary, and it is not within\
    \ the scope of this document to\n   describe how they are implemented.  These\
    \ techniques have been\n   successfully implemented at several ISPs.\n   It should\
    \ be noted that web notification is only intended to notify\n   devices running\
    \ a web browser.\n"
- title: 5.8.  Considerations for Notification to Public Network Locations
  contents:
  - "5.8.  Considerations for Notification to Public Network Locations\n   Delivering\
    \ a notification to a location that provides a shared public\n   network, such\
    \ as a train station, public square, coffee shop, or\n   similar location may\
    \ be of low value since the users connecting to\n   such networks are typically\
    \ highly transient and generally not known\n   to site or network administrators.\
    \  For example, a system may detect\n   that a host on such a network has a bot,\
    \ but by the time a\n   notification is generated, that user has departed from\
    \ the network\n   and moved elsewhere.\n"
- title: 5.9.  Considerations for Notification to Network Locations Using a
  contents:
  - "5.9.  Considerations for Notification to Network Locations Using a\n      Shared\
    \ IP Address\n   Delivering a notification to a location that accesses the Internet\n\
    \   routed through one or more shared public IP addresses may be of low\n   value\
    \ since it may be quite difficult to differentiate between users\n   when providing\
    \ a notification.  For example, on a business network of\n   500 users, all sharing\
    \ one public IP address, it may be sub-optimal\n   to provide a notification to\
    \ all 500 users if you only need one\n   specific user to be notified and take\
    \ action.  As a result, such\n   networks may find value in establishing a localized\
    \ bot detection and\n   notification system, just as they are likely to also establish\
    \ other\n   localized systems for security, file sharing, email, and so on.\n\
    \   However, should an ISP implement some form of notification to such\n   networks,\
    \ it may be better to simply send notifications to a\n   designated network administrator\
    \ at the site.  In such a case, the\n   local network administrator may like to\
    \ receive additional\n   information in such a notification, such as a date and\
    \ timestamp, the\n   source port of the infected system, and malicious sites and\
    \ ports\n   that may have been visited.\n"
- title: 5.10.  Notification and End User Expertise
  contents:
  - "5.10.  Notification and End User Expertise\n   The ultimate effectiveness of\
    \ any of the aforementioned forms of\n   notification is heavily dependent upon\
    \ both the expertise of the end\n   user and the wording of any such notification.\
    \  For example, while a\n   user may receive and acknowledge a notification, that\
    \ user may lack\n   the necessary technical expertise to understand or be able\
    \ to deal\n   effectively with the threat.  As a result, it is important that\
    \ such\n   notifications use clear and easily understood language, so that the\n\
    \   majority of users (who are non-technical) may understand the\n   notification.\
    \  In addition, a notification should provide easily\n   understood guidance on\
    \ how to remediate a threat as described in\n   Section 6, potentially with one\
    \ path for technical users to take and\n   another for non-technical users.\n"
- title: 6.  Remediation of Hosts Infected with a Bot
  contents:
  - "6.  Remediation of Hosts Infected with a Bot\n   This section covers the different\
    \ options available to remediate a\n   host, which means to remove, disable, or\
    \ otherwise render a bot\n   harmless.  Prior to this step, an ISP has detected\
    \ the bot, notified\n   the user that one of their hosts is infected with a bot,\
    \ and now may\n   provide some recommended means to clean the host.  The generally\n\
    \   recommended approach is to provide the necessary tools and education\n   to\
    \ the user so that they may perform bot remediation themselves,\n   particularly\
    \ given the risks and difficulties inherent in attempting\n   to remove a bot.\n\
    \   For example, this may include the creation of a special web site with\n  \
    \ security-oriented content that is dedicated for this purpose.  This\n   should\
    \ be a well-publicized security web site to which a user with a\n   bot infection\
    \ can be directed to for remediation.  This security web\n   site should clearly\
    \ explain why the user was notified and may include\n   an explanation of what\
    \ bots are and the threats that they pose.\n   There should be a clear explanation\
    \ of the steps that the user should\n   take in order to attempt to clean their\
    \ host and information on how\n   users can keep the host free of future infections.\
    \  The security web\n   site should also have a guided process that takes non-technical\
    \ users\n   through the remediation process, on an easily understood, step-by-\n\
    \   step basis.\n   In terms of the text used to explain what bots are and the\
    \ threats\n   that they pose, something simple such as this may suffice:\n   \
    \   What is a bot?  A bot is a piece of software, generally installed\n      on\
    \ your machine without your knowledge, which either sends spam or\n      tries\
    \ to steal your personal information.  They can be very\n      difficult to spot,\
    \ though you may have noticed that your computer\n      is running much more slowly\
    \ than usual or you may notice regular\n      disk activity even when you are\
    \ not doing anything.  Ignoring this\n      problem is risky to you and your personal\
    \ information.  Thus, bots\n      need to be removed to protect your data and\
    \ your personal\n      information.\n   Many bots are designed to work in a very\
    \ stealthy manner, and as\n   such, there may be a need to make sure that the\
    \ Internet user\n   understands the magnitude of the threat faced despite the\
    \ stealthy\n   nature of the bot.\n   It is also important to note that it may\
    \ not be immediately apparent\n   to the Internet user precisely which devices\
    \ have been infected with\n   a particular bot.  This may be due to the user's\
    \ home network\n   configuration, which may encompass several hosts, where a home\n\
    \   gateway that performs Network Address Translation (NAT) to share a\n   single\
    \ public IP address has been used.  Therefore, any of these\n   devices can be\
    \ infected with a bot.  The consequence of this for an\n   ISP is that remediation\
    \ advice may not ultimately be immediately\n   actionable by the Internet user,\
    \ as that user may need to perform\n   additional investigation within their own\
    \ home network.\n   An added complication is that the user may have a bot infection\
    \ on a\n   device such as a video console, multimedia system, appliance, or\n\
    \   other end user computing device that does not have a typical desktop\n   computing\
    \ interface.  As a result, diligence needs to be taken by the\n   ISP where possible\
    \ such that it can identify and communicate the\n   specific nature of the device\
    \ that has been infected with a bot and\n   provide further appropriate remediation\
    \ advice.  If the ISP cannot\n   pin down the device or identify its type, then\
    \ it should make it\n   clear to the user that any initial advice given is generic\
    \ and\n   further advice can be given (or is available) once the type of\n   infected\
    \ device is known.\n   There are a number of forums that exist online to provide\
    \ security-\n   related support to end users.  These forums are staffed by volunteers\n\
    \   and often are focused around the use of a common tool set to help end\n  \
    \ users to remediate hosts infected with malware.  It may be\n   advantageous\
    \ to ISPs to foster a relationship with one or more\n   forums, perhaps by offering\
    \ free hosting or other forms of\n   sponsorship.\n   It is also important to\
    \ keep in mind that not all users will be\n   technically adept, as noted in Section\
    \ 5.10.  As a result, it may be\n   more effective to provide a range of suggestion\
    \ options for\n   remediation.  This may include, for example, a very detailed\
    \ \"do it\n   yourself\" approach for experts, a simpler guided process for the\n\
    \   average user, and even assisted remediation as described in\n   Section 6.2.\n"
- title: 6.1.  Guided Remediation Process
  contents:
  - "6.1.  Guided Remediation Process\n   Minimally, the Guided Remediation Process\
    \ should include the\n   following goals, with options and/or recommendations\
    \ for achieving\n   them:\n   1.  Back up personal files.  For example:\n    \
    \      Before you start, make sure to back up all of your important\n        \
    \  data.  (You should do this on a regular basis anyway.)  You\n          can\
    \ back up your files manually or using a system backup\n          software utility,\
    \ which may be part of your Operating System\n          (OS).  You can back up\
    \ your files to a USB Thumb Drive (aka\n          USB Key), a writable CD/DVD-ROM,\
    \ an external hard drive, a\n          network file server, or an Internet-based\
    \ backup service.\n       It may be advisable to suggest that the user backup\
    \ is performed\n       onto separate backup media or devices if they suspect bot\n\
    \       infection.\n   2.  Download OS patches and Anti-Virus (A/V) software updates.\
    \  For\n       example, links could be provided to Microsoft Windows updates,\n\
    \       Apple Mac OS updates, or other major operating systems that are\n    \
    \   relevant to users and their devices.\n   3.  Configure the host to automatically\
    \ install updates for the OS,\n       A/V, and other common web browsers such\
    \ as Microsoft Internet\n       Explorer, Mozilla Firefox, Apple Safari, Opera,\
    \ and Google\n       Chrome.\n   4.  Get professional assistance if they are unable\
    \ to remove the bots\n       themselves.  If purchasing professional assistance,\
    \ then the user\n       should be encouraged to predetermine how much they are\
    \ willing to\n       pay for that help.  For example, if the host that is being\n\
    \       remediated is old and can easily be replaced with a new, faster,\n   \
    \    larger, and more reliable system for a certain cost, then it\n       makes\
    \ no sense to spend more than that cost to fix the old host.\n       On the other\
    \ hand, if the customer has a brand-new host, it might\n       make perfect sense\
    \ to spend the money to attempt to remediate it.\n   5.  To continue, regardless\
    \ of whether the user or a knowledgeable\n       technical assistant is working\
    \ on remediating the host, the first\n       task should be to determine which\
    \ of multiple potentially\n       infected machines may be the one that needs\
    \ attention (in the\n       common case of multiple hosts in a home network).\
    \  Sometimes, as\n       in cases where there is only a single directly attached\
    \ host, or\n       the user has been noticing problems with one of their hosts,\
    \ this\n       can be easy.  Other times, it may be more difficult, especially\n\
    \       if there are no clues as to which host is infected.  If the user\n   \
    \    is behind a home gateway/router, then the first task may be to\n       ascertain\
    \ which of the machines is infected.  In some cases, the\n       user may have\
    \ to check all machines to identify the infected one.\n   6.  ISPs may also look\
    \ at offering a CD/DVD with remediation\n       processes and software in the\
    \ event that a host is so badly\n       infected as to be unable to communicate\
    \ over the Internet.\n   7.  User surveys to solicit feedback on whether the notification\
    \ and\n       remediation process is effective and what recommended changes\n\
    \       could be made in order to improve the ease, understandability,\n     \
    \  and effectiveness the remediation process.\n   8.  If the user is interested\
    \ in reporting the host's bot infection\n       to an applicable law enforcement\
    \ authority, then the host\n       effectively becomes a cyber \"crime scene\"\
    , and the infection\n       should not be mitigated unless or until law enforcement\
    \ has\n       collected the necessary evidence.  For individuals in this\n   \
    \    situation, the ISP may wish to provide links to local, state,\n       federal,\
    \ or other relevant computer crime offices.  (Note: Some\n       \"minor\" incidents,\
    \ even if highly traumatic to the user, may not\n       be sufficiently serious\
    \ for law enforcement to commit some of\n       their limited resources to an\
    \ investigation.)  In addition,\n       individual regions may have other, specialized\
    \ computer crime\n       organizations to which these incidents can be reported.\
    \  For\n       example, in the United States, that organization is the Internet\n\
    \       Crime Complaint Center, at http://www.ic3.gov.\n   9.  Users may also\
    \ be interested in links to security expert forums,\n       where other users\
    \ can assist them.\n"
- title: 6.2.  Professionally Assisted Remediation Process
  contents:
  - "6.2.  Professionally Assisted Remediation Process\n   It should be acknowledged\
    \ that, based on the current state of\n   remediation tools and the technical\
    \ abilities of end users, that many\n   users may be unable to remediate on their\
    \ own.  As a result, it is\n   recommended that users have the option for professional\
    \ assistance.\n   This may entail online or telephone assistance for remediation,\
    \ as\n   well as working face to face with a professional who has training and\n\
    \   expertise in the removal of malware.  It should be made clear at the\n   time\
    \ of offering this service that this service is intended for those\n   that do\
    \ not have the skills or confidence to attempt remediation and\n   is not intended\
    \ as an up-sell by the ISP.\n"
- title: 7.  Failure or Refusal to Remediate
  contents:
  - "7.  Failure or Refusal to Remediate\n   ISP systems should track the bot infection\
    \ history of hosts in order\n   to detect when users consistently fail to remediate\
    \ or refuse to take\n   any steps to remediate.  In such cases, ISPs may need\
    \ to consider\n   taking additional steps to protect their network, other users\
    \ and\n   hosts on that network, and other networks.  Such steps may include a\n\
    \   progression of actions up to and including account termination.\n   Refusal\
    \ to remediate can be viewed as a business issue, and as such,\n   no technical\
    \ recommendation is possible.\n"
- title: 8.  Sharing of Data from the User to the ISP
  contents:
  - "8.  Sharing of Data from the User to the ISP\n   As an additional consideration,\
    \ it may be useful to create a process\n   by which users could choose, at their\
    \ option and with their express\n   consent, to share data regarding their bot\
    \ infections with their ISP\n   and/or another authorized third party.  Such third\
    \ parties may\n   include governmental entities that aggregate threat data, such\
    \ as the\n   Internet Crime Complaint Center referred to earlier in this document,\n\
    \   academic institutions, and/or security researchers.  While in many\n   cases\
    \ the information shared with the user's ISP or designated third\n   parties will\
    \ only be used for aggregated statistical analysis, it is\n   also possible that\
    \ certain research needs may be best met with more\n   detailed data.  Thus, any\
    \ such data sharing from a user to the ISP or\n   authorized third party may contain\
    \ some type of personally\n   identifiable information, either by design or inadvertently.\
    \  As a\n   result, any such data sharing should be enabled on an opt-in basis,\n\
    \   where users review and approve of the data being shared and the\n   parties\
    \ with which it is to be shared, unless the ISP is already\n   required to share\
    \ such data in order to comply with local laws and\n   applicable regulations.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   This document describes in detail the numerous\
    \ security risks and\n   concerns relating to botnets.  As such, it has been appropriate\
    \ to\n   include specific information about security in each section above.\n\
    \   This document describes the security risks related to malicious bot\n   infections\
    \ themselves, such as enabling identity theft, theft of\n   authentication credentials,\
    \ and the use of a host to unwittingly\n   participate in a DDoS attack, among\
    \ many other risks.  Finally, the\n   document also describes security risks that\
    \ may relate to the\n   particular methods of communicating a notification to\
    \ Internet users.\n   Bot networks and bot infections pose extremely serious security\n\
    \   risks, so readers should review this document carefully.\n   In addition,\
    \ regarding notifications as described in Section 5, care\n   should be taken\
    \ to assure users that notifications have been provided\n   by a trustworthy site\
    \ and/or party, so that the notification is more\n   difficult for phishers and/or\
    \ malicious parties using social\n   engineering tactics to mimic.  Otherwise,\
    \ care should be taken to\n   ensure that the user has some level of trust that\
    \ the notification is\n   valid and/or that the user has some way to verify via\
    \ some other\n   mechanism or step that the notification is valid.\n"
- title: 10.  Privacy Considerations
  contents:
  - "10.  Privacy Considerations\n   This document describes at a high level the activities\
    \ to which ISPs\n   should be sensitive, i.e., where the collection or communication\
    \ of\n   PII may be possible.  In addition, when performing notifications to\n\
    \   end users (see Section 5), those notifications should not include\n   PII.\n\
    \   As noted in Section 8, any sharing of data from the user to the ISP\n   and/or\
    \ authorized third parties should be done on an opt-in basis.\n   Additionally\
    \ the ISP and or authorized third parties should clearly\n   state what data will\
    \ be shared and with whom the data will be shared.\n   Lastly, as noted in other\
    \ sections, there may be legal requirements\n   in particular legal jurisdictions\
    \ concerning how long any subscriber-\n   related or other data is retained. \
    \ An ISP operating in such a\n   jurisdiction should be aware of these requirements\
    \ and should comply\n   with them.\n"
- title: 11.  Acknowledgements
  contents:
  - "11.  Acknowledgements\n   The authors wish to acknowledge the following individuals\
    \ and groups\n   for performing a detailed review of this document and/or providing\n\
    \   comments and feedback that helped to improve and evolve this\n   document:\n\
    \   Mark Baugher\n   Richard Bennett\n   James Butler\n   Vint Cerf\n   Alissa\
    \ Cooper\n   Jonathan Curtis\n   Jeff Chan\n   Roland Dobbins\n   Dave Farber\n\
    \   Stephen Farrell\n   Eliot Gillum\n   Joel Halpern\n   Joel Jaeggli\n   Scott\
    \ Keoseyan\n   Murray S. Kucherawy\n   The Messaging Anti-Abuse Working Group\
    \ (MAAWG)\n   Jose Nazario\n   Gunter Ollmann\n   David Reed\n   Roger Safian\n\
    \   Donald Smith\n   Joe Stewart\n   Forrest Swick\n   Sean Turner\n   Robb Topolski\n\
    \   Maxim Weinstein\n   Eric Ziegast\n"
- title: 12.  Informative References
  contents:
  - "12.  Informative References\n   [BIOS]     Sacco, A. and A. Ortega, \"Persistent\
    \ BIOS Infection\",\n              March 2009, <http://www.coresecurity.com/files/\n\
    \              attachments/Persistent_BIOS_Infection_CanSecWest09.pdf>.\n   [Combat-Zone]\n\
    \              Alshech, E., \"Cyberspace as a Combat Zone: The Phenomenon\n  \
    \            of Electronic Jihad\", February 2007, <http://\n              www.memrijttm.org/content/en/report.htm?report=1822>.\n\
    \   [Conficker]\n              Porras, P., Saidi, H., and V. Yegneswaran, \"An\
    \ Analysis of\n              Conficker's Logic and Rendezvous Points\", March\
    \ 2009,\n              <http://mtc.sri.com/Conficker/>.\n   [DDoS]     Saafan,\
    \ A., \"Distributed Denial of Service Attacks:\n              Explanation, Classification\
    \ and Suggested Solutions\",\n              March 2009, <www.exploit-db.com/download_pdf/14738/>.\n\
    \   [Dragon]   Nagaraja, S. and R. Anderson, \"The snooping dragon:\n        \
    \      social-malware surveillance of the Tibetan movement\",\n              March\
    \ 2009,\n              <http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-746.pdf>.\n\
    \   [Estonia]  Evron, G., \"Battling Botnets and Online Mobs: Estonia's\n    \
    \          Defense Efforts during the Internet War\", 2008, <http://\n       \
    \       journal.georgetown.edu/wp-content/uploads/9.1-Evron.pdf>.\n   [Gh0st]\
    \    Vallentin, M., Whiteaker, J., and Y. Ben-David, \"The Gh0st\n           \
    \   in the Shell: Network Security in the Himalayas\",\n              February\
    \ 2010, <http://www.infowar-monitor.net/wp-content/\n              uploads/2010/02/cs294-28-paper.pdf>.\n\
    \   [RFC1459]  Oikarinen, J. and D. Reed, \"Internet Relay Chat Protocol\",\n\
    \              RFC 1459, May 1993.\n   [RFC2142]  Crocker, D., \"MAILBOX NAMES\
    \ FOR COMMON SERVICES, ROLES AND\n              FUNCTIONS\", RFC 2142, May 1997.\n\
    \   [RFC3954]  Claise, B., \"Cisco Systems NetFlow Services Export Version\n \
    \             9\", RFC 3954, October 2004.\n   [RFC5070]  Danyliw, R., Meijer,\
    \ J., and Y. Demchenko, \"The Incident\n              Object Description Exchange\
    \ Format\", RFC 5070,\n              December 2007.\n   [RFC5965]  Shafranovich,\
    \ Y., Levine, J., and M. Kucherawy, \"An\n              Extensible Format for\
    \ Email Feedback Reports\", RFC 5965,\n              August 2010.\n   [RFC6108]\
    \  Chung, C., Kasyanov, A., Livingood, J., Mody, N., and B.\n              Van\
    \ Lieu, \"Comcast's Web Notification System Design\",\n              RFC 6108,\
    \ February 2011.\n   [Snort]    Roesch, M., \"Snort Home Page\", March 2009,\n\
    \              <http://www.snort.org/>.\n   [Spamalytics]\n              Kanich,\
    \ C., Kreibich, C., Levchenko, K., Enright, B.,\n              Voelker, G., Paxson,\
    \ V., and S. Savage, \"Spamalytics: An\n              Empirical Analysis of Spam\
    \ Marketing Conversion\",\n              October 2008, <http://www.icir.org/christian/publications/\n\
    \              2008-ccs-spamalytics.pdf>.\n   [Threat-Report]\n              Ahamad,\
    \ M., Amster, D., Barret, M., Cross, T., Heron, G.,\n              Jackson, D.,\
    \ King, J., Lee, W., Naraine, R., Ollman, G.,\n              Ramsey, J., Schmidt,\
    \ H., and P. Traynor, \"Emerging Cyber\n              Threats Report for 2009:\
    \ Data, Mobility and Questions of\n              Responsibility will Drive Cyber\
    \ Threats in 2009 and\n              Beyond\", October 2008, <http://smartech.gatech.edu/\n\
    \              bitstream/1853/26301/1/CyberThreatsReport2009.pdf>.\n   [Whiz-Kid]\
    \ Berinato, S., \"Case Study: How a Bookmaker and a Whiz Kid\n              Took\
    \ On a DDOS-based Online Extortion Attack\", May 2005,\n              <http://www.csoonline.com/article/220336/\n\
    \              How_a_Bookmaker_and_a_Whiz_Kid_Took_On_a_DDOS_based_Online\n  \
    \            _Extortion_Attack>.\n"
- title: Appendix A.  Examples of Third-Party Malware Lists
  contents:
  - "Appendix A.  Examples of Third-Party Malware Lists\n   As noted in Section 4,\
    \ there are many potential third parties that\n   may be willing to share lists\
    \ of infected hosts.  This list is for\n   example purposes only, is not intended\
    \ to be either exclusive or\n   exhaustive, and is subject to change over time.\n\
    \   o  Arbor - Atlas, see http://atlas.arbor.net/\n   o  Internet Systems Consortium\
    \ - Secure Information Exchange (SIE),\n      see https://sie.isc.org/\n   o \
    \ Microsoft - Smart Network Data Services (SNDS), see\n      https://postmaster.live.com/snds/\n\
    \   o  SANS Institute / Internet Storm Center - DShield Distributed\n      Intrusion\
    \ Detection System, see http://www.dshield.org/about.html\n   o  ShadowServer\
    \ Foundation, see http://www.shadowserver.org/\n   o  Spamhaus - Policy Block\
    \ List (PBL), see\n      http://www.spamhaus.org/pbl/\n   o  Spamhaus - Exploits\
    \ Block List (XBL), see\n      http://www.spamhaus.org/xbl/\n   o  Team Cymru\
    \ - Community Services, see http://www.team-cymru.org/\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Jason Livingood\n   Comcast Cable Communications\n   One\
    \ Comcast Center\n   1701 John F. Kennedy Boulevard\n   Philadelphia, PA  19103\n\
    \   USA\n   EMail: jason_livingood@cable.comcast.com\n   URI:   http://www.comcast.com\n\
    \   Nirmal Mody\n   Comcast Cable Communications\n   One Comcast Center\n   1701\
    \ John F. Kennedy Boulevard\n   Philadelphia, PA  19103\n   USA\n   EMail: nirmal_mody@cable.comcast.com\n\
    \   URI:   http://www.comcast.com\n   Mike O'Reirdan\n   Comcast Cable Communications\n\
    \   One Comcast Center\n   1701 John F. Kennedy Boulevard\n   Philadelphia, PA\
    \  19103\n   USA\n   EMail: michael_oreirdan@cable.comcast.com\n   URI:   http://www.comcast.com\n"
