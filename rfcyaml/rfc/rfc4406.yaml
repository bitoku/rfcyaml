- title: __initial_text__
  contents:
  - '                    Sender ID: Authenticating E-Mail

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: IESG Note
  contents:
  - "IESG Note\n   The following documents  (RFC 4405, RFC 4406, RFC 4407, and RFC\
    \ 4408)\n   are published simultaneously as Experimental RFCs, although there\
    \ is\n   no general technical consensus and efforts to reconcile the two\n   approaches\
    \ have failed.  As such, these documents have not received\n   full IETF review\
    \ and are published \"AS-IS\" to document the different\n   approaches as they\
    \ were considered in the MARID working group.\n   The IESG takes no position about\
    \ which approach is to be preferred\n   and cautions the reader that there are\
    \ serious open issues for each\n   approach and concerns about using them in tandem.\
    \  The IESG believes\n   that documenting the different approaches does less harm\
    \ than not\n   documenting them.\n   Note that the Sender ID experiment may use\
    \ DNS records that may have\n   been created for the current SPF experiment or\
    \ earlier versions in\n   this set of experiments.  Depending on the content of\
    \ the record,\n   this may mean that Sender-ID heuristics would be applied incorrectly\n\
    \   to a message.  Depending on the actions associated by the recipient\n   with\
    \ those heuristics, the message may not be delivered or may be\n   discarded on\
    \ receipt.\n   Participants relying on Sender ID experiment DNS records are warned\n\
    \   that they may lose valid messages in this set of circumstances.\n   Participants\
    \ publishing SPF experiment DNS records should consider\n   the advice given in\
    \ section 3.4 of RFC 4406 and may wish to publish\n   both v=spf1 and spf2.0 records\
    \ to avoid the conflict.\n   Participants in the Sender-ID experiment need to\
    \ be aware that the\n   way Resent-* header fields are used will result in failure\
    \ to receive\n   legitimate email when interacting with standards-compliant systems\n\
    \   (specifically automatic forwarders which comply with the standards by\n  \
    \ not adding Resent-* headers, and systems which comply with RFC 822\n   but have\
    \ not yet implemented RFC 2822 Resent-* semantics).  It would\n   be inappropriate\
    \ to advance Sender-ID on the standards track without\n   resolving this interoperability\
    \ problem.\n   The community is invited to observe the success or failure of the\
    \ two\n   approaches during the two years following publication, in order that\n\
    \   a community consensus can be reached in the future.\n"
- title: Abstract
  contents:
  - "Abstract\n   Internet mail suffers from the fact that much unwanted mail is sent\n\
    \   using spoofed addresses -- \"spoofed\" in this case means that the\n   address\
    \ is used without the permission of the domain owner.  This\n   document describes\
    \ a family of tests by which SMTP servers can\n   determine whether an e-mail\
    \ address in a received message was used\n   with the permission of the owner\
    \ of the domain contained in that\n   e-mail address.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Conventions Used in This Document ..........................4\n  \
    \ 2. Problem Statement ...............................................4\n   3.\
    \ SPF 2.0 Records .................................................5\n      3.1.\
    \ Version and Scope ..........................................5\n           3.1.1.\
    \ Minor Version .......................................6\n      3.2. Multiple\
    \ Records ...........................................6\n      3.3. Positional\
    \ Modifiers .......................................7\n      3.4. Compatibility\
    \ ..............................................8\n   4. Decision Model ..................................................8\n\
    \      4.1. Arguments ..................................................9\n  \
    \    4.2. Results ....................................................9\n    \
    \  4.3. Record Lookup ..............................................9\n      4.4.\
    \ Record Selection ...........................................9\n   5. Actions\
    \ Based on the Decision ..................................10\n      5.1. Neutral,\
    \ None, SoftFail, or PermError .....................11\n      5.2. Pass ......................................................11\n\
    \      5.3. Fail ......................................................11\n  \
    \    5.4. TempError .................................................11\n   6.\
    \ Security Considerations ........................................11\n      6.1.\
    \ DNS Attacks ...............................................12\n      6.2. TCP\
    \ Attacks ...............................................12\n      6.3. Forged\
    \ Sender Attacks .....................................12\n      6.4. Address Space\
    \ Hijacking ...................................12\n      6.5. Malicious DNS Attacks\
    \ on Third Parties ....................13\n   7. Implementation Guidance ........................................13\n\
    \      7.1. Simple E-Mailers ..........................................14\n  \
    \    7.2. E-Mail Forwarders .........................................14\n    \
    \  7.3. Mailing List Servers ......................................15\n      7.4.\
    \ Third-Party Mailers .......................................15\n      7.5. MUA\
    \ Implementers ..........................................15\n   8. Acknowledgements\
    \ ...............................................16\n   9. References .....................................................17\n\
    \      9.1. Normative References ......................................17\n  \
    \    9.2. Informative References ....................................17\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Today, a huge majority of unwanted e-mail contains headers\
    \ that lie\n   about the origin of the mail.  This is true of most spam and\n\
    \   substantially all of the virus e-mail that is sent.\n   This document describes\
    \ a mechanism such that receiving Mail Transfer\n   Agents (MTAs), Mail Delivery\
    \ Agents (MDAs), and/or Mail User Agents\n   (MUAs) can recognize mail in the\
    \ above category and take appropriate\n   action.  For example, an MTA might refuse\
    \ to accept a message, an MDA\n   might discard a message rather than placing\
    \ it into a mailbox, and an\n   MUA might render that message in some distinctive\
    \ fashion.\n   In order to avoid further fragmentation of the Internet e-mail\n\
    \   system, it is desirable that the Internet community as a whole come\n   to\
    \ a consensus as to what mail senders should do to make their mail\n   appear\
    \ non-spoofed, and how mail receivers should determine whether\n   mail is spoofed.\
    \  On the other hand, it is not necessary to reach a\n   consensus regarding the\
    \ actions that various parties take once a\n   message has been determined to\
    \ be spoofed.  This can be done\n   unilaterally -- one agent might decide to\
    \ discard a spoofed message\n   whereas another decides to add a disclaimer.\n\
    \   This document defines a pair of closely-related tests.  One validates\n  \
    \ a message's Purported Responsible Address (PRA) as defined in\n   [RFC4407].\
    \  The other validates a message's Reverse-Path (also known\n   as MAIL-FROM address)\
    \ as defined in [RFC4408].\n   An e-mail sender complying with this specification\
    \ SHOULD publish\n   information for both tests, and SHOULD arrange that any mail\
    \ that is\n   sent will pass both tests.  An e-mail receiver complying with this\n\
    \   specification SHOULD perform at least one of these tests.\n"
- title: 1.1.  Conventions Used in This Document
  contents:
  - "1.1.  Conventions Used in This Document\n   In this document, the key words \"\
    MUST\", \"MUST NOT\", \"REQUIRED\",\n   \"SHALL\", \"SHALL NOT\", \"SHOULD\",\
    \ \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\",\n   and \"OPTIONAL\" are to be interpreted\
    \ as described in [RFC2119].\n"
- title: 2.  Problem Statement
  contents:
  - "2.  Problem Statement\n   Briefly stated, the mechanisms of this document allow\
    \ one to answer\n   the following question:\n      When a message is transferred\
    \ via SMTP between two unrelated\n      parties, does the SMTP client host have\
    \ permission to send mail on\n      behalf of a mailbox referenced by the message?\n\
    \   As seen from the question, this mechanism applies to unrelated\n   parties:\
    \  It is useful at the point where a message passes across the\n   Internet from\
    \ one organization to another.  It is beyond the scope of\n   this document to\
    \ describe authentication mechanisms that can be\n   deployed within an organization.\n\
    \   The PRA version of the test seeks to authenticate the mailbox\n   associated\
    \ with the most recent introduction of a message into the\n   mail delivery system.\
    \  In simple cases, this is who the mail is from.\n   However, in the case of\
    \ a third-party mailer, a forwarder, or a\n   mailing list server, the address\
    \ being authenticated is that of the\n   third party, the forwarder, or the mailing\
    \ list.\n   On the other hand, the MAIL-FROM version of the test seeks to\n  \
    \ authenticate the mailbox that would receive Delivery Status\n   Notifications\
    \ (DSNs, or bounces) for the message.  In simple cases,\n   this too is who the\
    \ mail is from.  However, third-party mailers,\n   forwarders, and mailing list\
    \ servers MUST specify an address under\n   their control, and SHOULD arrange\
    \ that DSNs received at this address\n   are forwarded to the original bounce\
    \ address.\n   In both cases, the domain associated with an e-mail address is\
    \ what\n   is authenticated; no attempt is made to authenticate the local-part.\n\
    \   A domain owner gets to determine which SMTP clients speak on behalf\n   of\
    \ addresses within the domain; a responsible domain owner should not\n   authorize\
    \ SMTP clients that will lie about local parts.\n   In the long run, once the\
    \ domain of the sender is authenticated, it\n   will be possible to use that domain\
    \ as part of a mechanism to\n   determine the likelihood that a given message\
    \ is spam, using, for\n   example, reputation and accreditation services. (These\
    \ services are\n   not the subject of the present mechanism, but it should enable\
    \ them.)\n"
- title: 3.  SPF 2.0 Records
  contents:
  - "3.  SPF 2.0 Records\n   Domains declare which hosts are and are not authorized\
    \ to transmit\n   e-mail messages on their behalf by publishing Sender Policy\
    \ Framework\n   (SPF) records in the Domain Name System.  [RFC4408] defines a\
    \ format\n   for these records identified by the version prefix \"v=spf1\".  This\n\
    \   section defines an amended format, identified by the version prefix\n   \"\
    spf2.0\", that allows sending domains to explicitly specify how their\n   records\
    \ should be interpreted, and provides for additional\n   extensibility.  Sending\
    \ domains MAY publish either or both formats.\n   Since the two formats are identical\
    \ in most respects, the following\n   subsections define the \"spf2.0\" format\
    \ relative to [RFC4408].\n"
- title: 3.1.  Version and Scope
  contents:
  - "3.1.  Version and Scope\n   Under Sender ID, receiving domains may perform a\
    \ check of either the\n   PRA identity or the MAIL-FROM identity.  Sending domains\
    \ therefore\n   require a method for declaring whether their published list of\n\
    \   authorized outbound e-mail servers can be used for the PRA check, the\n  \
    \ MAIL-FROM check, or both.\n   This section replaces the definition of the version\
    \ identifier in\n   Section 4.5 of [RFC4408] and adds the concept of SPF record\
    \ scopes.\n   SPF records begin with a version identifier and may also include\
    \ a\n   scope:\n      record      = version terms *SP\n      version     = \"\
    v=spf1\" | ( \"spf2.\" ver-minor scope)\n      ver-minor   = 1*DIGIT\n      scope\
    \       = \"/\" scope-id *( \",\" scope-id )\n      scope-id    = \"mfrom\" /\
    \ \"pra\" / name\n   For example, the SPF record\n          spf2.0/mfrom,pra +mx\
    \ +ip4:192.168.0.100 -all\n   defines an SPF record that can be used for either\
    \ MAIL FROM or PRA\n   checks.\n   This document only defines the existence of\
    \ two scopes: \"mfrom\" and\n   \"pra\".  The details of these two scopes are\
    \ defined in other\n   documents: \"mfrom\" is defined in [RFC4408]; \"pra\" is\
    \ defined in\n   [RFC4407].\n   Other scopes may be defined by future documents\
    \ only.  There is no\n   registry for scopes.  A scope definition must define\
    \ what it\n   identifies as the sending mailbox for a message, how to extract\
    \ that\n   information from a message, how to determine the initial arguments\n\
    \   for the check_host() function, and what the compliant responses to\n   the\
    \ result are.  This ensures that domains with published records and\n   mail receiver\
    \ agree on the semantics of the scope.\n   A compliant domain SHOULD publish authorizations\
    \ for every defined\n   scope.\n"
- title: 3.1.1.  Minor Version
  contents:
  - "3.1.1.  Minor Version\n   All published records that use the \"spf2\" version\
    \ identifier MUST\n   start with \"spf2.0\".  This document only specifies records\
    \ with a\n   minor version of \"0\".\n   Future versions of this document may\
    \ define other minor versions to\n   be used.\n"
- title: 3.2.  Multiple Records
  contents:
  - "3.2.  Multiple Records\n   A domain MAY publish multiple SPF 2.0 records, provided\
    \ that each\n   scope appears in at most one SPF 2.0 record.  In addition, a domain\n\
    \   MAY also publish an SPF record that uses the \"v=spf1\" version\n   identifier\
    \ defined in [RFC4408].  The selection rules in Section 4.4\n   define the precedence\
    \ of these records.\n"
- title: 3.3.  Positional Modifiers
  contents:
  - "3.3.  Positional Modifiers\n   This section replaces Section 4.6.3 of [RFC4408]\
    \ and adds the concept\n   of positional modifiers.\n   Modifiers are key/value\
    \ pairs that affect the evaluation of the\n   check_host() function.\n   Modifiers\
    \ are either global or positional:\n      Global modifiers MAY appear anywhere\
    \ in the record, but SHOULD\n      appear at the end, after all mechanisms and\
    \ positional modifiers.\n      Positional modifiers apply only to the mechanism\
    \ they follow.  It\n      is a syntax error for a positional modifier to appear\
    \ before the\n      first mechanism.\n   Modifiers of either type are also either\
    \ singular or multiple:\n      Singular modifiers may appear only once in the\
    \ record if they are\n      global, or once after each mechanism if they are positional.\n\
    \      Multiple modifiers may appear multiple times in the record if they\n  \
    \    are global, or multiple times after each mechanism if they are\n      positional.\n\
    \   A modifier is not allowed to be defined as both global and\n   positional.\n\
    \   The modifiers \"redirect\" and \"exp\" described in Section 6 of\n   [RFC4408]\
    \ are global and singular.\n   Ordering of modifiers does not matter, except that:\n\
    \   1. positional modifiers must appear after the mechanism they affect\n    \
    \  and before any subsequent mechanisms; and\n   2. when a multiple modifier appears\
    \ more than one time, the ordering\n      of the appearances may be significant\
    \ to the modifier.\n   Other than these constraints, implementations MUST treat\
    \ different\n   orders of modifiers the same.  An intended side effect of these\
    \ rules\n   is that modifiers cannot be defined that modify other modifiers.\n\
    \   These rules allow an implementation to correctly pre-parse a record.\n   Furthermore,\
    \ they are crafted to allow the parsing algorithm to be\n   stable, even when\
    \ new modifiers are introduced.\n   Modifiers that are unrecognized MUST be ignored.\
    \  This allows older\n   implementations to handle records with modifiers that\
    \ were defined\n   after they were written.\n"
- title: 3.4.  Compatibility
  contents:
  - "3.4.  Compatibility\n   Domain administrators complying with this specification\
    \ are required\n   to publish information in DNS regarding their authorized outbound\n\
    \   e-mail servers.  [RFC4408] describes a format for this information\n   identified\
    \ by the version prefix \"v=spf1\".  Many domains have\n   published information\
    \ in DNS using this format.  In order to provide\n   compatibility for these domains,\
    \ Sender ID implementations SHOULD\n   interpret the version prefix \"v=spf1\"\
    \ as equivalent to\n   \"spf2.0/mfrom,pra\", provided no record starting with\
    \ \"spf2.0\" exists.\n   Administrators who have already published \"v=spf1\"\
    \ records SHOULD\n   review these records to determine whether they are also valid\
    \ for use\n   with PRA checks.  If the information in a \"v=spf1\" record is not\n\
    \   correct for a PRA check, administrators SHOULD publish either an\n   \"spf2.0/pra\"\
    \ record with correct information or an \"spf2.0/pra ?all\"\n   record indicating\
    \ that the result of a PRA check is explicitly\n   inconclusive.\n"
- title: 4.  Decision Model
  contents:
  - "4.  Decision Model\n   Sender ID enables receiving e-mail systems to answer the\
    \ following\n   question:\n   Given an e-mail message, and given an IP address\
    \ from which it has\n   been (or will be) received, is the SMTP client at that\
    \ IP address\n   authorized to send that e-mail message?\n   This question will\
    \ usually be asked by an SMTP server as part of\n   deciding whether to accept\
    \ an incoming mail message.  However, this\n   question could also be asked later\
    \ by a different party.  An MUA, for\n   example, could use the result of this\
    \ question to determine how to\n   file or present a message.\n   There are three\
    \ steps to answering this question:\n   1. From an e-mail message, extract the\
    \ address to verify.  The PRA\n      variant of this test does so as specified\
    \ in [RFC4407], or\n      alternatively, using the submitter address as specified\
    \ in\n      [RFC4405].  The MAIL FROM variant of this test does so as\n      specified\
    \ in [RFC4408].\n   2. Extract the domain part of the address determined in step\
    \ 1.\n   3. Call the check_host() function defined in [RFC4408] and modified\n\
    \      by the following subsections.\n   If the Sender ID check is being performed\
    \ by an MTA as part of\n   receiving an e-mail message, and it cannot determine\
    \ an address in\n   step 1 above (because the message or address is malformed),\
    \ then the\n   message SHOULD be rejected with error \"550 5.7.1 Missing Purported\n\
    \   Responsible Address\" or error \"550 5.7.1 Missing Reverse-Path\n   address\"\
    .\n"
- title: 4.1.  Arguments
  contents:
  - "4.1.  Arguments\n   Sender ID modifies the check_host() function by the addition\
    \ of a\n   scope parameter.  Thus, for Sender ID the check_host() function is\n\
    \   called passing the following parameters:\n      a. A scope of \"pra\" (for\
    \ the PRA variant of the test), or \"mfrom\"\n         (for the MAIL FROM variant\
    \ of the test).\n      b. The IP address (either IPv4 or IPv6) from which the\
    \ message is\n         being or has been received.\n      c. The domain from step\
    \ 2 above.\n      d. The address from step 1 above.\n"
- title: 4.2.  Results
  contents:
  - "4.2.  Results\n   The result of the check_host() function is one of the values\n\
    \   \"Neutral\", \"Pass\", \"Fail\", \"SoftFail\", \"None\", \"TempError\", or\n\
    \   \"PermError\".  Section 5 describes how these results are used by MTAs\n \
    \  receiving messages.  This specification imposes no requirements on\n   parties\
    \ performing this test in other environments.\n"
- title: 4.3.  Record Lookup
  contents:
  - "4.3.  Record Lookup\n   SPF records are looked up in DNS in accordance with Section\
    \ 4.4 of\n   [RFC4408].\n   When performing the PRA version of the test, if the\
    \ DNS query returns\n   \"non-existent domain\" (RCODE 3), then check_host() exits\
    \ immediately\n   with the result \"Fail\".\n"
- title: 4.4.  Record Selection
  contents:
  - "4.4.  Record Selection\n   This section replaces the record selection steps described\
    \ in Section\n   4.5 of [RFC4408].\n   Starting with the set of records that were\
    \ returned by the lookup,\n   record selection proceeds in these steps:\n   1.\
    \ If any records of type SPF are in the set, then all records of\n      type TXT\
    \ are discarded.\n   2. Records that do not begin with proper version and scope\
    \ sections\n      are discarded.  The version section for \"spf2\" records contains\
    \ a\n      ver-minor field that is for backward-compatible future extensions.\n\
    \      This field must be well formed for a record to be retained, but is\n  \
    \    otherwise ignored.\n   3. Records that use the \"spf2\" version identifier\
    \ and do not have a\n      scope-id that matches <scope> are discarded.  Note\
    \ that this is a\n      complete string match on the scope-id tokens: If <scope>\
    \ is \"pra\",\n      then the record starting \"spf2.0/mfrom,prattle,fubar\" would\
    \ be\n      discarded, but a record starting \"spf2.0/mfrom,pra,fubar\" would\
    \ be\n      retained.\n   4. If the lookup returned two records, one containing\
    \ the \"v=spf1\"\n      version identifier and the other containing the \"spf2\"\
    \ version\n      identifier, the \"spf2\" version takes precedence for the desired\n\
    \      scope-id.  If the \"spf2\" record does not contain the desired\n      scope-id,\
    \ then the \"v=spf1\" record is selected.\n   5. If an \"spf2\" record does not\
    \ contain the desired scope-id and\n      there is no \"v=spf1\" record for the\
    \ domain, then no record is\n      selected.\n   After the above steps, there\
    \ should be one record remaining and\n   evaluation can proceed.  If there are\
    \ two or more records remaining,\n   then check_host() exits immediately with\
    \ the error \"PermError\".\n   If there are no matching records remaining after\
    \ the initial DNS\n   query or any subsequent optional DNS queries, then check_host()\
    \ exits\n   immediately with the result \"None\".\n"
- title: 5.  Actions Based on the Decision
  contents:
  - "5.  Actions Based on the Decision\n   When the Sender ID test is used by an SMTP\
    \ server as part of\n   receiving a message, the server should take the actions\
    \ described by\n   this section.\n   The check_host() function returns one of\
    \ the following results.  See\n   [RFC4408] for the meaning of these results.\n"
- title: 5.1.  Neutral, None, SoftFail, or PermError
  contents:
  - "5.1.  Neutral, None, SoftFail, or PermError\n   An SMTP server receiving one\
    \ of these results SHOULD NOT reject the\n   message for this reason alone, but\
    \ MAY subject the message to\n   heightened scrutiny by other measures, and MAY\
    \ reject the message as\n   a result of this heightened scrutiny.\n   Such additional\
    \ security measures MAY take into account that a\n   message for which the result\
    \ is \"SoftFail\" is less likely to be\n   authentic than a message for which\
    \ the result is \"Neutral\".\n"
- title: 5.2.  Pass
  contents:
  - "5.2.  Pass\n   An SMTP server receiving this result SHOULD treat the message\
    \ as\n   authentic.  It may accept or reject the message depending on other\n\
    \   policies.\n"
- title: 5.3.  Fail
  contents:
  - "5.3.  Fail\n   When performing the Sender ID test during an SMTP transaction,\
    \ an MTA\n   that chooses to reject a message receiving this result SHOULD reject\n\
    \   the message with a \"550 5.7.1 Sender ID (xxx) yyy - zzz\" SMTP error,\n \
    \  where \"xxx\" is replaced with \"PRA\" or \"MAIL FROM\", \"yyy\" is replaced\n\
    \   with the additional reason returned by the check_host() function, and\n  \
    \ \"zzz\" is replaced with the explanation string returned by the\n   check_host()\
    \ function.\n   When performing the Sender ID test after accepting an e-mail message\n\
    \   for delivery, an MTA that chooses to reject a message receiving this\n   result\
    \ SHOULD NOT deliver the message.  Instead, it should create a\n   DSN message,\
    \ consistent with the usual rules for DSN messages.\n"
- title: 5.4.  TempError
  contents:
  - "5.4.  TempError\n   An SMTP server receiving this result MAY reject the message\
    \ with a\n   \"450 4.4.3 Sender ID check is temporarily unavailable\" error code.\n\
    \   Alternatively, an SMTP server receiving this result MAY accept a\n   message\
    \ and optionally subject it to heightened scrutiny by other\n   anti-spam measures.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   This entire document describes a new mechanism\
    \ for mitigating spoofed\n   e-mail, which is today a pervasive security problem\
    \ in the Internet.\n   Assuming that this mechanism is widely deployed, the following\n\
    \   sections describe counter attacks that could be used to defeat this\n   mechanism.\n"
- title: 6.1.  DNS Attacks
  contents:
  - "6.1.  DNS Attacks\n   The new mechanism is entirely dependent on DNS lookups,\
    \ and is\n   therefore only as secure as DNS.  An attacker bent on spoofing\n\
    \   messages could attempt to get his messages accepted by sending forged\n  \
    \ answers to DNS queries.\n   An MTA could largely defeat such an attack by using\
    \ a properly\n   paranoid DNS resolver.  DNS Security (DNSSEC) may ultimately\
    \ provide\n   a way to completely neutralize this class of attacks.\n"
- title: 6.2.  TCP Attacks
  contents:
  - "6.2.  TCP Attacks\n   This mechanism is designed to be used in conjunction with\
    \ SMTP over\n   TCP.  A sufficiently resourceful attacker might be able to send\
    \ TCP\n   packets with forged from-addresses, and thus execute an entire SMTP\n\
    \   session that appears to come from somewhere other than its true\n   origin.\n\
    \   Such an attack requires guessing what TCP sequence numbers an SMTP\n   server\
    \ will use.  It also requires transmitting completely in the\n   blind -- the\
    \ attack will be unable to hear any of the server's side\n   of the conversation.\n\
    \   Attacks of this sort can be ameliorated if IP gateways refuse to\n   forward\
    \ packets when the source address is clearly bogus.\n"
- title: 6.3.  Forged Sender Attacks
  contents:
  - "6.3.  Forged Sender Attacks\n   This mechanism chooses an address to validate\
    \ either from one of a\n   number of message headers or from the RFC 2821 MAIL\
    \ command, and then\n   uses that address for validation.  A message with a true\
    \ Resent-From\n   header or Return-Path, but a forged From header, will be accepted.\n\
    \   Since many MUAs do not display all of the headers of received\n   messages,\
    \ the message will appear to be forged when displayed.\n   In order to neutralize\
    \ this attack, MUAs will need to start\n   displaying at least the address that\
    \ was verified.  In addition, MTAs\n   could subject messages to heightened scrutiny\
    \ when the validated\n   address differs from the From header.\n"
- title: 6.4.  Address Space Hijacking
  contents:
  - "6.4.  Address Space Hijacking\n   This mechanism assumes the integrity of IP\
    \ address space for\n   determining whether a given client is authorized to send\
    \ messages\n   from a given PRA.  In addition to the TCP attack given in Section\n\
    \   6.2, a sufficiently resourceful attacker might be able to alter the\n   IP\
    \ routing structure to permit two-way communication using a\n   specified IP address.\
    \  It would then be possible to execute an SMTP\n   session that appears to come\
    \ from an authorized address, without the\n   need to guess TCP sequence numbers\
    \ or transmit in the blind.\n   Such an attack might occur if the attacker obtained\
    \ access to a\n   router that participates in external BGP routing.  Such a router\n\
    \   could advertise a more specific route to a rogue SMTP client,\n   temporarily\
    \ overriding the legitimate owner of the address.\n"
- title: 6.5.  Malicious DNS Attacks on Third Parties
  contents:
  - "6.5.  Malicious DNS Attacks on Third Parties\n   There is class of attacks in\
    \ which an attacker A can entice a\n   participant P to send a malicious message\
    \ to a victim V.\n   These attacks are undertaken by A citing the address of V\
    \ in the SMTP\n   MAIL FROM request and then by causing P to generate (or invoke\
    \ the\n   generation of) a Delivery Status Notification 'bounce' message\n   (RFC3464),\
    \ which is sent to the victim V.\n   The attacker relies upon it being common\
    \ practice to copy the\n   original message into the 'bounce' report, thereby\
    \ causing the malice\n   to be sent onward to V.\n   This mode of attack has the\
    \ advantages (to the attacker) of\n   obfuscating the location of the host from\
    \ which the attack was\n   mounted, and of possibly damaging the reputation of\
    \ P by making it\n   appear that P originated or was an active participant in\
    \ the sending\n   of the malicious message.\n   In current practice, A causes\
    \ P to cause the 'bounce' by addressing\n   the original message to a nonexistent\
    \ recipient.\n   Sender ID enables a new variant of this attack.\n   In this variant,\
    \ the attacker A sends a message whose PRA (Section 4)\n   is selected by the\
    \ attacker to be such that, when P undertakes the\n   Sender ID test, a Fail will\
    \ result (Section 5.3).\n   The message will be rejected (as the attacker intended)\
    \ and a\n   malicious 'bounce' message may be generated and sent to the victim\
    \ V.\n"
- title: 7.  Implementation Guidance
  contents:
  - "7.  Implementation Guidance\n   This section describes the actions that certain\
    \ members of the\n   Internet e-mail ecosystem must take to be compliant with\
    \ this\n   specification.\n"
- title: 7.1.  Simple E-Mailers
  contents:
  - "7.1.  Simple E-Mailers\n   A domain that injects original e-mail into the Internet,\
    \ using its\n   own name in From headers, need do nothing to be compliant.  However,\n\
    \   such domains SHOULD publish records in DNS as defined by [RFC4408]\n   and\
    \ this specification.\n   In the majority of cases, the domain's published information\
    \ will be\n   the same for both the PRA and MAIL FROM variants of this test. \
    \ In\n   this case, domains SHOULD publish their information using an SPF\n  \
    \ record with the prefix \"v=spf1\".  Doing so will render their\n   published\
    \ information usable by the older SPF protocol, too.  (See\n   [RFC4408] for information\
    \ on the SPF protocol.)\n"
- title: 7.2.  E-Mail Forwarders
  contents:
  - "7.2.  E-Mail Forwarders\n   In order to pass the PRA variant of the test, a program\
    \ that forwards\n   received mail to other addresses MUST add an appropriate header\
    \ that\n   contains an e-mail address that it is authorized to use.  Such\n  \
    \ programs SHOULD use the Resent-From header for this purpose.\n   In order to\
    \ pass the MAIL FROM variant of the test, a program that\n   forwards received\
    \ mail to other addresses MUST alter the MAIL FROM\n   address to an address under\
    \ its control.  Should that address\n   eventually receive a DSN relating to the\
    \ original message, that DSN\n   SHOULD be forwarded to the original MAIL FROM\
    \ address.  However, if\n   this altered address receives any messages other than\
    \ DSNs related to\n   the original message, these messages MUST NOT be forwarded\
    \ to the\n   original MAIL FROM address; they SHOULD be refused during an SMTP\n\
    \   transaction.\n   In addition, e-mail forwarders SHOULD publish Sender ID records\
    \ for\n   their domains, and SHOULD use MTAs for which the Sender ID check\n \
    \  yields a \"pass\" result.\n   Some of today's forwarders already add an appropriate\
    \ header\n   (although many of them use Sender rather than Resent-From.) Most\
    \ of\n   them do not perform the address-rewriting specified above.\n   Note that\
    \ an e-mail forwarder might receive a single message for two\n   or more recipients,\
    \ each of whom requests forwarding to a new\n   address.  In this case, the forwarder's\
    \ MTA SHOULD transmit the\n   message to each new recipient individually, with\
    \ each copy of the\n   message containing a different newly inserted Resent-From\
    \ header\n   field.\n"
- title: 7.3.  Mailing List Servers
  contents:
  - "7.3.  Mailing List Servers\n   In order to pass the PRA variant of the test,\
    \ a mailing list server\n   MUST add an appropriate header that contains an e-mail\
    \ address that\n   it is authorized to use.  Such programs SHOULD use the Resent-From\n\
    \   header for this purpose.\n   In order to pass the MAIL FROM variant of the\
    \ test, a mailing list\n   server MUST alter the MAIL FROM address to an address\
    \ under its\n   control.\n   In addition, mailing list servers SHOULD publish\
    \ Sender ID records\n   for their domains, and SHOULD use MTAs for which the Sender\
    \ ID check\n   yields a \"pass\" result.\n   Most of today's mailing list software\
    \ already adds an appropriate\n   header (although most of them use Sender rather\
    \ than Resent-From),\n   and most of them already alter the MAIL FROM address.\n"
- title: 7.4.  Third-Party Mailers
  contents:
  - "7.4.  Third-Party Mailers\n   In order to pass the PRA variant of this test,\
    \ a program that sends\n   mail on behalf of another user MUST add an appropriate\
    \ header that\n   contains an e-mail address that it is authorized to use.  Such\n\
    \   programs SHOULD use the Sender header for this purpose.\n   In order to pass\
    \ the MAIL FROM variant of this test, a program that\n   sends mail on behalf\
    \ of another user MUST use a MAIL FROM address\n   that is under its control.\
    \  Defining what the program does with any\n   mail received at that address is\
    \ beyond the scope of this document.\n   In addition, third-party mailers, servers\
    \ SHOULD publish Sender ID\n   records for their domains, and SHOULD use MTAs\
    \ for which the Sender\n   ID check yields a \"pass\" result.\n   Many, but not\
    \ all, of today's third-party mailers are already\n   compliant with the PRA variant\
    \ of the test.  The extent to which\n   mailers are already compliant with the\
    \ MAIL FROM variant of this test\n   is unknown.\n"
- title: 7.5.  MUA Implementers
  contents:
  - "7.5.  MUA Implementers\n   When displaying a received message, an MUA SHOULD\
    \ display the\n   purported responsible address as defined by this document whenever\n\
    \   that address differs from the RFC 2822 From address.  This display\n   SHOULD\
    \ be in addition to the RFC 2822 From address.\n   When a received message contains\
    \ multiple headers that might be used\n   for the purported responsible address\
    \ determination, an MUA should\n   consider displaying all of them.  That is,\
    \ if a message contains\n   several Resent-From's, a Sender, and a From, an MUA\
    \ should consider\n   displaying all of them.\n   Sender ID also does not validate\
    \ the display name that may be\n   transmitted along with an e-mail address. \
    \ The display name is also\n   vulnerable to spoofing and other forms of attacks.\
    \  In order to\n   reduce the occurrence and effectiveness of such attacks, MUA\n\
    \   implementers should consider methods to safeguard the display name.\n   This\
    \ could include the following:\n   * Not presenting the display name to the user\
    \ at all, or not\n     presenting the display name unless the corresponding e-mail\
    \ address\n     is listed in the user's address book.\n   * Treating as suspicious\
    \ any e-mail where the display name is itself\n     in the form of an e-mail address,\
    \ especially when it differs from\n     the actual e-mail address in the header.\n\
    \   * Making it clear to users that the e-mail address has been checked\n    \
    \ rather than the display name.\n"
- title: 8.  Acknowledgements
  contents:
  - "8.  Acknowledgements\n   This design is based on earlier work published in 2003\
    \ in [RMX] and\n   [DMP] drafts (by Hadmut Danisch and Gordon Fecyk, respectively).\
    \  The\n   idea of using a DNS record to check the legitimacy of an e-mail\n \
    \  address traces its ancestry to \"Repudiating Mail From\" draft by Paul\n  \
    \ Vixie [Vixie] (based on suggestion by Jim Miller) and to \"Domain-\n   Authorized\
    \ SMTP Mail\" draft by David Green [Green], who first\n   introduced this idea\
    \ on the namedroppers mailing list in 2002.\n   The current document borrows heavily\
    \ from each of the above, as well\n   as earlier versions of [RFC4408] and [CallerID],\
    \ and incorporates\n   ideas proposed by many members of the MARID working group.\
    \  The\n   contributions of each of the above are gratefully acknowledged.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC2119]   Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n               Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC4405]   Allman E. and H. Katz, \"SMTP Service Extension for\n\
    \               Indicating the Responsible Submitter of an E-Mail\n          \
    \     Message\", RFC 4405, April 2006.\n   [RFC4407]   Lyon, J., \"Purported Responsible\
    \ Address in E-Mail\n               Messages\", RFC 4407, April 2006.\n   [RFC4408]\
    \   Wong, M. and W. Schlitt, \"Sender Policy Framework (SPF)\n               for\
    \ Authorizing Use of Domains in E-Mail\", RFC 4408,\n               April 2006.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [CallerID]  Microsoft Corporation, Caller ID\
    \ for E-Mail Technical\n               Specification, http://www.microsoft.com/mscorp/safety/\n\
    \               technologies/senderid/resources.mspx\n   [DMP]       Fecyk, G.,\
    \ \"Designated Mailers Protocol\",\n               http://www.pan-am.ca/dmp/draft-fecyk-dmp-01.txt,\
    \ December\n               2003.\n   [Green]     David Green, \"Mail-Transmitter\
    \ RR\",\n               http://ops.ietf.org/lists/namedroppers/namedroppers.2002/\n\
    \               msg00656.html, June 2002.\n   [RMX]       H. Danisch, \"The RMX\
    \ DNS RR and method for lightweight\n               SMTP sender authorization\"\
    ,\n               http://www.danisch.de/work/security/txt/\n               draft-danisch-dns-rr-smtp-04.txt\n\
    \   [Vixie]     Paul Vixie, \"Repudiating Mail From\",\n               http://ops.ietf.org/lists/namedroppers/namedroppers.2002/\n\
    \               msg00658.html, June 2002.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Jim Lyon\n   Microsoft Corporation\n   One Microsoft Way\n\
    \   Redmond, WA 98052\n   USA\n   EMail: jimlyon@microsoft.com\n   Meng Weng Wong\n\
    \   Singapore\n   EMail: mengwong@dumbo.pobox.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
