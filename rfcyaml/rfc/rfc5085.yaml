- contents:
  - "      Pseudowire Virtual Circuit Connectivity Verification (VCCV):\n                   A
    Control Channel for Pseudowires\n"
  title: __initial_text__
- contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol
    for the\n   Internet community, and requests discussion and suggestions for\n
    \  improvements.  Please refer to the current edition of the \"Internet\n   Official
    Protocol Standards\" (STD 1) for the standardization state\n   and status of this
    protocol.  Distribution of this memo is unlimited.\n"
  title: Status of This Memo
- contents:
  - "Abstract\n   This document describes Virtual Circuit Connectivity Verification\n
    \  (VCCV), which provides a control channel that is associated with a\n   pseudowire
    (PW), as well as the corresponding operations and\n   management functions (such
    as connectivity verification) to be used\n   over that control channel.  VCCV
    applies to all supported access\n   circuit and transport types currently defined
    for PWs.\n"
  title: Abstract
- contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .
    . . . . . .  3\n     1.1.  Specification of Requirements  . . . . . . . . . .
    . . . .  5\n   2.  Abbreviations  . . . . . . . . . . . . . . . . . . . . . .
    . .  5\n   3.  Overview of VCCV . . . . . . . . . . . . . . . . . . . . . . .
    \ 6\n   4.  CC Types and CV Types  . . . . . . . . . . . . . . . . . . . .  8\n
    \  5.  VCCV Control Channel for MPLS PWs  . . . . . . . . . . . . . . 10\n     5.1.
    \ VCCV Control Channel Types for MPLS  . . . . . . . . . . . 10\n       5.1.1.
    \ In-Band VCCV (Type 1)  . . . . . . . . . . . . . . . . 11\n       5.1.2.  Out-of-Band
    VCCV (Type 2)  . . . . . . . . . . . . . . 12\n       5.1.3.  TTL Expiry VCCV
    (Type 3) . . . . . . . . . . . . . . . 12\n     5.2.  VCCV Connectivity Verification
    Types for MPLS  . . . . . . 13\n       5.2.1.  ICMP Ping  . . . . . . . . . .
    . . . . . . . . . . . . 13\n       5.2.2.  MPLS LSP Ping  . . . . . . . . . .
    . . . . . . . . . . 13\n     5.3.  VCCV Capability Advertisement for MPLS PWs
    . . . . . . . . 13\n       5.3.1.  VCCV Capability Advertisement LDP Sub-TLV  .
    . . . . . 14\n   6.  VCCV Control Channel for L2TPv3/IP PWs . . . . . . . . .
    . . . 15\n     6.1.  VCCV Control Channel Type for L2TPv3 . . . . . . . . . .
    . 16\n     6.2.  VCCV Connectivity Verification Type for L2TPv3 . . . . . . 17\n
    \      6.2.1.  L2TPv3 VCCV using ICMP Ping  . . . . . . . . . . . . . 17\n     6.3.
    \ L2TPv3 VCCV Capability Advertisement for L2TPv3  . . . . . 17\n       6.3.1.
    \ L2TPv3 VCCV Capability AVP . . . . . . . . . . . . . . 17\n   7.  Capability
    Advertisement Selection . . . . . . . . . . . . . . 19\n   8.  IANA Considerations
    \ . . . . . . . . . . . . . . . . . . . . . 19\n     8.1.  VCCV Interface Parameters
    Sub-TLV  . . . . . . . . . . . . 19\n       8.1.1.  MPLS VCCV Control Channel
    (CC) Types . . . . . . . . . 19\n       8.1.2.  MPLS VCCV Connectivity Verification
    (CV) Types . . . . 20\n     8.2.  PW Associated Channel Type . . . . . . . . .
    . . . . . . . 21\n     8.3.  L2TPv3 Assignments . . . . . . . . . . . . . . .
    . . . . . 21\n       8.3.1.  Control Message Attribute Value Pairs (AVPs) . .
    . . . 21\n       8.3.2.  Default L2-Specific Sublayer Bits  . . . . . . . . .
    . 21\n       8.3.3.  ATM-Specific Sublayer Bits . . . . . . . . . . . . . . 21\n
    \      8.3.4.  VCCV Capability AVP Values . . . . . . . . . . . . . . 22\n   9.
    \ Congestion Considerations  . . . . . . . . . . . . . . . . . . 23\n   10. Security
    Considerations  . . . . . . . . . . . . . . . . . . . 24\n   11. Acknowledgements
    . . . . . . . . . . . . . . . . . . . . . . . 25\n   12. References . . . . .
    . . . . . . . . . . . . . . . . . . . . . 26\n     12.1. Normative References
    . . . . . . . . . . . . . . . . . . . 26\n     12.2. Informative References .
    . . . . . . . . . . . . . . . . . 26\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   There is a need for fault detection and diagnostic mechanisms
    that\n   can be used for end-to-end fault detection and diagnostics for a\n   Pseudowire,
    as a means of determining the PW's true operational\n   state.  Operators have
    indicated in [RFC4377] and [RFC3916] that such\n   a tool is required for PW operation
    and maintenance.  This document\n   defines a protocol called Virtual Circuit
    Connectivity Verification\n   (VCCV) that satisfies these requirements.  VCCV
    is, in its simplest\n   description, a control channel between a pseudowire's
    ingress and\n   egress points over which connectivity verification messages can
    be\n   sent.\n   The Pseudowire Edge-to-Edge Emulation (PWE3) Working Group defines
    a\n   mechanism that emulates the essential attributes of a\n   telecommunications
    service (such as a T1 leased line or Frame Relay)\n   over a variety of Packet
    Switched Network (PSN) types [RFC3985].\n   PWE3 is intended to provide only the
    minimum necessary functionality\n   to emulate the service with the required degree
    of faithfulness for\n   the given service definition.  The required functions
    of PWs include\n   encapsulating service-specific bit streams, cells, or PDUs
    arriving\n   at an ingress port and carrying them across an IP path or MPLS\n
    \  tunnel.  In some cases, it is necessary to perform other operations,\n   such
    as managing their timing and order, to emulate the behavior and\n   characteristics
    of the service to the required degree of\n   faithfulness.\n   From the perspective
    of Customer Edge (CE) devices, the PW is\n   characterized as an unshared link
    or circuit of the chosen service.\n   In some cases, there may be deficiencies
    in the PW emulation that\n   impact the traffic carried over a PW and therefore
    limit the\n   applicability of this technology.  These limitations must be fully\n
    \  described in the appropriate service-specific documentation.\n   For each service
    type, there will be one default mode of operation\n   that all PEs offering that
    service type must support.  However,\n   optional modes have been defined to improve
    the faithfulness of the\n   emulated service, as well as to offer a means by which
    older\n   implementations may support these services.\n   Figure 1 depicts the
    architecture of a pseudowire as defined in\n   [RFC3985].  It further depicts
    where the VCCV control channel resides\n   within this architecture, which will
    be discussed in detail shortly.\n            |<-------------- Emulated Service
    ---------------->|\n            |          |<---------- VCCV ---------->|          |\n
    \           |          |<------- Pseudowire ------->|          |\n            |
    \         |                            |          |\n            |          |
    \   |<-- PSN Tunnel -->|    |          |\n            |          V    V                  V
    \   V          |\n            V    AC    +----+                  +----+     AC
    \  V\n      +-----+    |     | PE1|==================| PE2|     |    +-----+\n
    \     |     |----------|............PW1.............|----------|     |\n      |
    CE1 |    |     |    |                  |    |     |    | CE2 |\n      |     |----------|............PW2.............|----------|
    \    |\n      +-----+  ^ |     |    |==================|    |     | ^  +-----+\n
    \           ^  |       +----+                  +----+     | |  ^\n            |
    \ |   Provider Edge 1         Provider Edge 2  |  |\n            |  |                                            |
    \ |\n      Customer |                                            | Customer\n
    \     Edge 1   |                                            | Edge 2\n               |
    \                                           |\n               |                                            |\n
    \        Native service                               Native service\n               Figure
    1: PWE3 VCCV Operation Reference Model\n   From Figure 1, Customer Edge (CE) routers
    CE1 and CE2 are attached to\n   the emulated service via Attachment Circuits (ACs),
    and to each of\n   the Provider Edge (PE) routers (PE1 and PE2, respectively).
    \ An AC\n   can be a Frame Relay Data Link Connection Identifier (DLCI), an ATM\n
    \  Virtual Path Identifier / Virtual Channel Identifier (VPI/VCI), an\n   Ethernet
    port, etc.  The PE devices provide pseudowire emulation,\n   enabling the CEs
    to communicate over the PSN.  A pseudowire exists\n   between these PEs traversing
    the provider network.  VCCV provides\n   several means of creating a control channel
    over the PW, between the\n   PE routers that attach the PW.\n   Figure 2 depicts
    how the VCCV control channel is associated with the\n   pseudowire protocol stack.\n
    \      +-------------+                                +-------------+\n       |
    \ Layer2     |                                |  Layer2     |\n       |  Emulated
    \  |       < Emulated Service >     |  Emulated   |\n       |  Services   |                                |
    \ Services   |\n       +-------------+                                +-------------+\n
    \      |             |            VCCV/PW             |             |\n       |Demultiplexer|
    \      < Control Channel >      |Demultiplexer|\n       +-------------+                                +-------------+\n
    \      |    PSN      |          < PSN Tunnel >        |    PSN      |\n       +-------------+
    \                               +-------------+\n       |  Physical   |                                |
    \ Physical   |\n       +-----+-------+                                +-----+-------+\n
    \            |                                              |\n             |
    \            ____     ___       ____          |\n             |           _/    \\___/
    \  \\    _/    \\__       |\n             |          /               \\__/         \\_
    \    |\n             |         /                               \\    |\n             +--------|
    \     MPLS or IP Network         |---+\n                       \\                               /\n
    \                       \\   ___      ___     __      _/\n                         \\_/
    \  \\____/   \\___/  \\____/\n     Figure 2: PWE3 Protocol Stack Reference Model
    including the VCCV\n                              Control Channel\n   VCCV messages
    are encapsulated using the PWE3 encapsulation as\n   described in Sections 5 and
    6, so that they are handled and processed\n   in the same manner (or in some cases,
    a similar manner) as the PW\n   PDUs for which they provide a control channel.
    \ These VCCV messages\n   are exchanged only after the capability (expressed as
    two VCCV type\n   spaces, namely the VCCV Control Channel and Connectivity Verification\n
    \  Types) and desire to exchange such traffic has been advertised\n   between
    the PEs (see Sections 5.3 and 6.3), and VCCV types chosen.\n"
  - contents:
    - "1.1.  Specification of Requirements\n   The key words \"MUST\", \"MUST NOT\",
      \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\",
      \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described
      in [RFC2119].\n"
    title: 1.1.  Specification of Requirements
  title: 1.  Introduction
- contents:
  - "2.  Abbreviations\n   AC      Attachment Circuit [RFC3985].\n   AVP     Attribute
    Value Pair [RFC3931].\n   CC      Control Channel (used as CC Type).\n   CE      Customer
    Edge.\n   CV      Connectivity Verification (used as CV Type).\n   CW      Control
    Word [RFC3985].\n   L2SS    L2-Specific Sublayer [RFC3931].\n   LCCE    L2TP Control
    Connection Endpoint [RFC3931].\n   OAM     Operation and Maintenance.\n   PE      Provider
    Edge.\n   PSN     Packet Switched Network [RFC3985].\n   PW      Pseudowire [RFC3985].\n
    \  PW-ACH  PW Associated Channel Header [RFC4385].\n   VCCV    Virtual Circuit
    Connectivity Verification.\n"
  title: 2.  Abbreviations
- contents:
  - "3.  Overview of VCCV\n   The goal of VCCV is to verify and further diagnose the
    pseudowire\n   forwarding path.  To this end, VCCV is comprised of different\n
    \  components:\n   o  a means of signaling VCCV capabilities to a peer PE,\n   o
    \ an encapsulation for the VCCV control channel messages that allows\n      the
    receiving PE to intercept, interpret, and process them locally\n      as OAM messages,
    and\n   o  specifications for the operation of the various VCCV operational\n
    \     modes transmitted within the VCCV messages.\n   When a pseudowire is first
    signaled using the Label Distribution\n   Protocol (LDP) [RFC4447] or the Layer
    Two Tunneling Protocol version\n   3 (L2TPv3) [RFC3931], a message is sent from
    the initiating PE to the\n   receiving PE requesting that a pseudowire be set
    up.  This message\n   has been extended to include VCCV capability information
    (see\n   Section 4).  The VCCV capability information indicates to the\n   receiving
    PE which combinations of Control Channel (CC) and\n   Connectivity Verification
    (CV) Types it is capable of receiving.  If\n   the receiving PE agrees to establish
    the PW, it will return its\n   capabilities in the subsequent signaling message
    to indicate which CC\n   and CV Types it is capable of processing.  Precedence
    rules for which\n   CC and CV Type to choose in cases where more than one is specified
    in\n   this message are defined in Section 7 of this document.\n   Once the PW
    is signaled, data for the PW will flow between the PEs\n   terminating the PW.
    \ At this time, the PEs can begin transmitting\n   VCCV messages based on the
    CC and CV Type combinations just\n   discussed.  To this end, VCCV defines an
    encapsulation for these\n   messages that identifies them as belonging to the
    control channel for\n   the PW.  This encapsulation is designed to both allow
    the control\n   channel to be processed functionally in the same manner as the
    data\n   traffic for the PW in order to faithfully test the data plane for the\n
    \  PE, and allow the PE to intercept and process these VCCV messages\n   instead
    of forwarding them out of the AC towards the CE as if they\n   were data traffic.
    \ In this way, the most basic function of the VCCV\n   control channel is to verify
    connectivity of the pseudowire and the\n   data plane used to transport the data
    path for the pseudowire.  It\n   should be noted that because of the number of
    combinations of\n   optional and mandatory data-plane encapsulations for PW data
    traffic,\n   VCCV defines a number of Control Channel (CC) and Connectivity\n
    \  Verification (CV) types in order to support as many of these as\n   possible.
    \ While designed to support most of the existing\n   combinations (both mandatory
    and optional), VCCV does define a\n   default CC and CV Type combination for each
    PW Demultiplexer type, as\n   will be described in detail later in this document.\n
    \  VCCV can be used both as a fault detection and/or a diagnostic tool\n   for
    pseudowires.  For example, an operator can periodically invoke\n   VCCV on a timed,
    on-going basis for proactive connectivity\n   verification on an active pseudowire,
    or on an ad hoc or as-needed\n   basis as a means of manual connectivity verification.
    \ When invoking\n   VCCV, the operator triggers a combination of one of its various
    CC\n   Types and one of its various CV Types.  The CV Types include LSP Ping\n
    \  [RFC4379] for MPLS PWs, and ICMP Ping [RFC0792] [RFC4443] for both\n   MPLS
    and L2TPv3 PWs.  We define a matrix of acceptable CC and CV Type\n   combinations
    further in this specification.\n   The control channel maintained by VCCV can
    additionally carry fault\n   detection status between the endpoints of the pseudowire.\n
    \  Furthermore, this information can then be translated into the native\n   OAM
    status codes used by the native access technologies, such as ATM,\n   Frame-Relay
    or Ethernet.  The specific details of such status\n   interworking is out of the
    scope of this document, and is only noted\n   here to illustrate the utility of
    VCCV for such purposes.  Complete\n   details can be found in [MSG-MAP] and [RFC4447].\n"
  title: 3.  Overview of VCCV
- contents:
  - "4.  CC Types and CV Types\n   The VCCV Control Channel (CC) Type defines several
    possible types of\n   control channel that VCCV can support.  These control channels
    can in\n   turn carry several types of protocols defined by the Connectivity\n
    \  Verification (CV) Type.  VCCV potentially supports multiple CV Types\n   concurrently,
    but it only supports the use of a single CC Type.  The\n   specific type or types
    of VCCV packets that can be accepted and sent\n   by a router are indicated during
    capability advertisement as\n   described in Sections 5.3 and 6.3.  The various
    VCCV CV Types\n   supported are used only when they apply to the context of the
    PW\n   demultiplexer in use.  For example, the LSP Ping CV Type should only\n
    \  be used when MPLS Labels are utilized as PW Demultiplexer.\n   Once a set of
    VCCV capabilities is received and advertised, a CC Type\n   and CV Type(s) that
    match both the received and transmitted\n   capabilities can be selected.  That
    is, a PE router needs to only\n   allow Types that are both received and advertised
    to be selected,\n   performing a logical AND between the received and transmitted
    bitflag\n   fields.  The specific CC Type and CV Type(s) are then chosen within\n
    \  the constraints and rules specified in Section 7.  Once a specific CC\n   Type
    has been chosen (i.e., it matches both the transmitted and\n   received VCCV CC
    capability), transmitted and replied to, this CC\n   Type MUST be the only one
    used until such time as the pseudowire is\n   re-signaled.  In addition, based
    on these rules and the procedures\n   defined in Section 5.2 of [RFC4447], the
    pseudowire MUST be re-\n   signaled if a different set of capabilities types is
    desired.  The\n   relevant portion of Section 5.2 of [RFC4447] is:\n         Interface
    Parameter Sub-TLV\n         Note that as the \"interface parameter sub-TLV\" is
    part of the\n         FEC, the rules of LDP make it impossible to change the\n
    \        interface parameters once the pseudowire has been set up.\n   The CC
    and CV Type indicator fields are defined as 8-bit bitmasks\n   used to indicate
    the specific CC or CV Type or Types (i.e., none,\n   one, or more) of control
    channel packets that may be sent on the VCCV\n   control channel.  These values
    represent the numerical value\n   corresponding to the actual bit being set in
    the bitfield.  The\n   definition of each CC and CV Type is dependent on the PW
    type\n   context, either MPLS or L2TPv3, within which it is defined.\n   Control
    Channel (CC) Types:\n      The defined values for CC Types for MPLS PWs are:\n
    \        MPLS Control Channel (CC) Types:\n         Bit (Value)    Description\n
    \        ============   ==========================================\n         Bit
    0 (0x01) - Type 1: PWE3 Control Word with 0001b as\n                        first
    nibble (PW-ACH, see [RFC4385])\n         Bit 1 (0x02) - Type 2: MPLS Router Alert
    Label\n         Bit 2 (0x04) - Type 3: MPLS PW Label with TTL == 1\n         Bit
    3 (0x08) - Reserved\n         Bit 4 (0x10) - Reserved\n         Bit 5 (0x20) -
    Reserved\n         Bit 6 (0x40) - Reserved\n         Bit 7 (0x80) - Reserved\n
    \     The defined values for CC Types for L2TPv3 PWs are:\n         L2TPv3 Control
    Channel (CC) Types:\n         Bit (Value)    Description\n         ============
    \  ==========================================\n         Bit 0 (0x01) - L2-Specific
    Sublayer with V-bit set\n         Bit 1 (0x02) - Reserved\n         Bit 2 (0x04)
    - Reserved\n         Bit 3 (0x08) - Reserved\n         Bit 4 (0x10) - Reserved\n
    \        Bit 5 (0x20) - Reserved\n         Bit 6 (0x40) - Reserved\n         Bit
    7 (0x80) - Reserved\n   Connectivity Verification (CV) Types:\n      The defined
    values for CV Types for MPLS PWs are:\n         MPLS Connectivity Verification
    (CV) Types:\n         Bit (Value)    Description\n         ============   ==========================================\n
    \        Bit 0 (0x01) - ICMP Ping\n         Bit 1 (0x02) - LSP Ping\n         Bit
    2 (0x04) - Reserved\n         Bit 3 (0x08) - Reserved\n         Bit 4 (0x10) -
    Reserved\n         Bit 5 (0x20) - Reserved\n         Bit 6 (0x40) - Reserved\n
    \        Bit 7 (0x80) - Reserved\n      The defined values for CV Types for L2TPv3
    PWs are:\n         L2TPv3 Connectivity Verification (CV) Types:\n         Bit
    (Value)    Description\n         ============   ==========================================\n
    \        Bit 0 (0x01) - ICMP Ping\n         Bit 1 (0x02) - Reserved\n         Bit
    2 (0x04) - Reserved\n         Bit 3 (0x08) - Reserved\n         Bit 4 (0x10) -
    Reserved\n         Bit 5 (0x20) - Reserved\n         Bit 6 (0x40) - Reserved\n
    \        Bit 7 (0x80) - Reserved\n   If none of the types above are supported,
    the entire CC and CV Type\n   Indicator fields SHOULD be transmitted as 0x00 (i.e.,
    all bits in the\n   bitfield set to 0) to indicate this to the peer.\n   If no
    capability is signaled, then the peer MUST assume that the peer\n   has no VCCV
    capability and follow the procedures specified in this\n   document for this case.\n"
  title: 4.  CC Types and CV Types
- contents:
  - "5.  VCCV Control Channel for MPLS PWs\n   When MPLS is used to transport PW packets,
    VCCV packets are carried\n   over the MPLS LSP as defined in this section.  In
    order to apply IP\n   monitoring tools to a PW, an operator may configure VCCV
    as a control\n   channel for the PW between the PE's endpoints [RFC3985].  Packets\n
    \  sent across this channel from the source PE towards the destination\n   PE
    either as in-band traffic with the PW's data, or out-of-band.  In\n   all cases,
    the control channel traffic is not forwarded past the PE\n   endpoints towards
    the Customer Edge (CE) devices; instead, VCCV\n   messages are intercepted at
    the PE endpoints for exception\n   processing.\n"
  - contents:
    - "5.1.  VCCV Control Channel Types for MPLS\n   As already described in Section
      4, the capability of which control\n   channel types (CC Type) are supported
      is advertised by a PE.  Once\n   the receiving PE has chosen a CC Type mode
      to use, it MUST continue\n   using this mode until such time as the PW is re-signaled.
      \ Thus, if a\n   new CC Type is desired, the PW must be torn-down and re-established.\n
      \  Ideally, such a control channel would be completely in-band (i.e.,\n   following
      the same data-plane faith as PW data).  When a control word\n   is present on
      the PW, it is possible to indicate the control channel\n   by setting a bit
      in the control word header (see Section 5.1.1).\n   Section 5.1.1 through Section
      5.1.3 describe each of the currently\n   defined VCCV Control Channel Types
      (CC Types).\n"
    - contents:
      - "5.1.1.  In-Band VCCV (Type 1)\n   CC Type 1 is also referred to as \"PWE3
        Control Word with 0001b as\n   first nibble\".  It uses the PW Associated
        Channel Header (PW-ACH);\n   see Section 5 of [RFC4385].\n   The PW set-up
        protocol [RFC4447] determines whether a PW uses a\n   control word.  When
        a control word is used, and that CW uses the\n   \"Generic PW MPLS Control
        Word\" format (see Section 3 of [RFC4385]), a\n   Control Channel for use
        of VCCV messages can be created by using the\n   PW Associated Channel CW
        format (see Section 5 of [RFC4385]).\n   The PW Associated Channel for VCCV
        control channel traffic is defined\n   in [RFC4385] as shown in Figure 3:\n
        \     0                   1                   2                   3\n      0
        1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \    |0 0 0 1|Version|   Reserved    |         Channel Type          |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \                 Figure 3: PW Associated Channel Header\n   The first nibble
        is set to 0001b to indicate a channel associated\n   with a pseudowire (see
        Section 5 of [RFC4385] and Section 3.6 of\n   [RFC4446]).  The Version and
        the Reserved fields are set to 0, and\n   the Channel Type is set to 0x0021
        for IPv4 and 0x0057 for IPv6\n   payloads.\n   For example, Figure 4 shows
        how the Ethernet [RFC4448] PW-ACH would\n   be received containing an LSP
        Ping payload corresponding to a choice\n   of CC Type of 0x01 and a CV Type
        of 0x02:\n      0                   1                   2                   3\n
        \     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \    |0 0 0 1|0 0 0 0|0 0 0 0 0 0 0 0|   0x21 (IPv4) or 0x57 (IPv6)  |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \             Figure 4: PW Associated Channel Header for VCCV\n   It should
        be noted that although some PW types are not required to\n   carry the control
        word, this type of VCCV can only be used for those\n   PW types that do employ
        the control word when it is in use.  Further,\n   this CC Type can only be
        used if the PW CW follows the \"Generic PW\n   MPLS Control Word\" format.
        \ This mode of VCCV operation MUST be\n   supported when the control word
        is present.\n"
      title: 5.1.1.  In-Band VCCV (Type 1)
    - contents:
      - "5.1.2.  Out-of-Band VCCV (Type 2)\n   CC Type 2 is also referred to as \"MPLS
        Router Alert Label\".\n   A VCCV control channel can alternatively be created
        by using the MPLS\n   router alert label [RFC3032] immediately above the PW
        label.  It\n   should be noted that this approach could result in a different
        Equal\n   Cost Multi-Path (ECMP) hashing behavior than pseudowire PDUs, and\n
        \  thus result in the VCCV control channel traffic taking a path which\n   differs
        from that of the actual data traffic under test.  Please see\n   Section 2
        of [RFC4928].\n   CC Type 2 can be used whether the PW is set-up with a Control
        Word\n   present or not.\n   This is the preferred mode of VCCV operation
        when the Control Word is\n   not present.\n   If the Control Word is in use
        on this PW, it MUST also be included\n   before the VCCV message.  This is
        done to avoid the different ECMP\n   hashing behavior.  In this case, the
        CW uses the PW-ACH format\n   described in Section 5.1.1 (see Figures 3 and
        4).  If the Control\n   Word is not in use on this PW, the VCCV message follows
        the PW Label\n   directly.\n"
      title: 5.1.2.  Out-of-Band VCCV (Type 2)
    - contents:
      - "5.1.3.  TTL Expiry VCCV (Type 3)\n   CC Type 3 is also referred to as \"MPLS
        PW Label with TTL == 1\".\n   The TTL of the PW label can be set to 1 to force
        the packet to be\n   processed within the destination router's control plane.
        \ This\n   approach could also result in a different ECMP hashing behavior
        and\n   VCCV messages taking a different path than the PW data traffic.\n
        \  CC Type 3 can be used whether the PW is set-up with a Control Word\n   present
        or not.\n   If the Control Word is in use on this PW, it MUST also be included\n
        \  before the VCCV message.  This is done to avoid the different ECMP\n   hashing
        behavior.  In this case, the CW uses the PW-ACH format\n   described in Section
        5.1.1 (see Figures 3 and 4).  If the Control\n   Word is not in use on this
        PW, the VCCV message follows the PW Label\n   directly.\n"
      title: 5.1.3.  TTL Expiry VCCV (Type 3)
    title: 5.1.  VCCV Control Channel Types for MPLS
  - contents:
    - '5.2.  VCCV Connectivity Verification Types for MPLS

      '
    - contents:
      - "5.2.1.  ICMP Ping\n   When this optional connectivity verification mode is
        used, an ICMP\n   Echo packet using the encoding specified in [RFC0792] (ICMPv4)
        or\n   [RFC4443] (ICMPv6) achieves connectivity verification.\n   Implementations
        MUST use ICMPv4 [RFC0792] if the signaling for VCCV\n   used IPv4 addresses,
        or ICMPv6 [RFC4443] if IPv6 addresses were used.\n   If the pseudowire is
        set up statically, then the encoding MUST use\n   that which was used for
        the pseudowire in the configuration.\n"
      title: 5.2.1.  ICMP Ping
    - contents:
      - "5.2.2.  MPLS LSP Ping\n   The LSP Ping header MUST be used in accordance
        with [RFC4379] and\n   MUST also contain the target FEC Stack containing the
        sub-TLV of sub-\n   Type 8 for the \"L2 VPN endpoint\", 9 for \"FEC 128 Pseudowire\n
        \  (deprecated)\", 10 for \"FEC 128 Pseudowire\", or 11 for the \"FEC 129\n
        \  Pseudowire\".  The sub-TLV value indicates the PW to be verified.\n"
      title: 5.2.2.  MPLS LSP Ping
    title: 5.2.  VCCV Connectivity Verification Types for MPLS
  - contents:
    - "5.3.  VCCV Capability Advertisement for MPLS PWs\n   To permit the indication
      of the type or types of PW control\n   channel(s) and connectivity verification
      mode or modes over a\n   particular PW, a VCCV parameter is defined in Section
      5.3.1 that is\n   used as part of the PW establishment signaling.  When a PE
      signals a\n   PW and desires PW OAM for that PW, it MUST indicate this during
      PW\n   establishment using the messages defined in Section 5.3.1.\n   Specifically,
      the PE MUST include the VCCV interface parameter sub-\n   TLV (0x0C) assigned
      in [RFC4446] in the PW set-up message [RFC4447].\n   The decision of the type
      of VCCV control channel is left completely\n   to the receiving control entity,
      although the set of choices is given\n   by the sender in that it indicates
      the control channels and\n   connectivity verification type or types that it
      can understand.  The\n   receiver SHOULD choose a single Control Channel Type
      from the match\n   between the choices sent and received, based on the capability\n
      \  advertisement selection specified in Section 7, and it MUST continue\n   to
      use this type for the duration of the life of the control channel.\n   Changing
      Control Channel Types after one has been established to be\n   in use could
      potentially cause problems at the receiving end and\n   could also lead to interoperability
      issues; thus, it is NOT\n   RECOMMENDED.\n   When a PE sends a label mapping
      message for a PW, it uses the VCCV\n   parameter to indicate the type of OAM
      control channels and\n   connectivity verification type or types it is willing
      to receive and\n   can send on that PW.  A remote PE MUST NOT send VCCV messages
      before\n   the capability of supporting the control channel(s) (and connectivity\n
      \  verification type(s) to be used over them) is signaled.  Then, it can\n   do
      so only on a control channel and using the connectivity\n   verification type(s)
      from the ones indicated.\n   If a PE receives VCCV messages prior to advertising
      capability for\n   this message, it MUST discard these messages and not reply
      to them.\n   In this case, the PE SHOULD increment an error counter and optionally\n
      \  issue a system and/or SNMP notification to indicate to the system\n   administrator
      that this condition exists.\n   When LDP is used as the PW signaling protocol,
      the requesting PE\n   indicates its configured VCCV capability or capabilities
      to the\n   remote PE by including the VCCV parameter with appropriate options
      in\n   the VCCV interface parameter sub-TLV field of the PW ID FEC TLV (FEC\n
      \  128) or in the interface parameter sub-TLV of the Generalized PW ID\n   FEC
      TLV (FEC 129).  These options indicate which control channel and\n   connectivity
      verification types it supports.  The requesting PE MAY\n   indicate that it
      supports multiple control channel options, and in\n   doing so, it agrees to
      support any and all indicated types if\n   transmitted to it.  However, it MUST
      do so in accordance with the\n   rules stipulated in Section 5.3.1 (VCCV Capability
      Advertisement Sub-\n   TLV.)\n   Local policy may direct the PE to support certain
      OAM capability and\n   to indicate it.  The absence of the VCCV parameter indicates
      that no\n   OAM functions are supported by the requesting PE, and thus the\n
      \  receiving PE MUST NOT send any VCCV control channel traffic to it.\n   The
      reception of a VCCV parameter with no options set MUST be ignored\n   as if
      one is not transmitted at all.\n   The receiving PE similarly indicates its
      supported control channel\n   types in the label mapping message.  These may
      or may not be the same\n   as the ones that were sent to it.  The sender should
      examine the set\n   that is returned to understand which control channels it
      may\n   establish with the remote peer, as specified in Sections 4 and 7.\n
      \  Similarly, it MUST NOT send control channel traffic to the remote PE\n   for
      which the remote PE has not indicated it supports.\n"
    - contents:
      - "5.3.1.  VCCV Capability Advertisement LDP Sub-TLV\n   [RFC4447] defines an
        Interface Parameter Sub-TLV field in the LDP PW\n   ID FEC (FEC 128) and an
        Interface Parameters TLV in the LDP\n   Generalized PW ID FEC (FEC 129) to
        signal different capabilities for\n   specific PWs.  An optional sub-TLV parameter
        is defined to indicate\n   the capability of supporting none, one, or more
        control channel and\n   connectivity verification types for VCCV.  This is
        the VCCV parameter\n   field.  If FEC 128 is used, the VCCV parameter field
        is carried in\n   the Interface Parameter sub-TLV field.  If FEC 129 is used,
        it is\n   carried as an Interface Parameter sub-TLV in the Interface Parameters\n
        \  TLV.\n   The VCCV parameter ID is defined as follows in [RFC4446]:\n   Parameter
        ID   Length     Description\n     0x0c           4           VCCV\n   The
        format of the VCCV parameter field is as follows:\n    0                   1
        \                  2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  |      0x0c     |       0x04    |   CC Types    |   CV Types    |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  The Control Channel Type field (CC Type) defines a bitmask used to\n   indicate
        the type of control channel(s) (i.e., none, one, or more)\n   that a router
        is capable of receiving control channel traffic on.  If\n   more than one
        control channel is specified, the router agrees to\n   accept control traffic
        over either control channel; however, see the\n   rules specified in Sections
        4 and 7 for more details.  If none of the\n   types are supported, a CC Type
        Indicator of 0x00 SHOULD be\n   transmitted to indicate this to the peer.
        \ However, if no capability\n   is signaled, then the PE MUST assume that
        its peer is incapable of\n   receiving any of the VCCV CC Types and MUST NOT
        send any OAM control\n   channel traffic to it.  Note that the CC and CV Types
        definitions are\n   consistent regardless of the PW's transport or access
        circuit type.\n   The CC and CV Type values are defined in Section 4.\n"
      title: 5.3.1.  VCCV Capability Advertisement LDP Sub-TLV
    title: 5.3.  VCCV Capability Advertisement for MPLS PWs
  title: 5.  VCCV Control Channel for MPLS PWs
- contents:
  - "6.  VCCV Control Channel for L2TPv3/IP PWs\n   When L2TPv3 is used to set up
    a PW over an IP PSN, VCCV packets are\n   carried over the L2TPv3 session as defined
    in this section.  L2TPv3\n   provides a \"Hello\" keepalive mechanism for the
    L2TPv3 control plane\n   that operates in-band over IP or UDP (see Section 4.4
    of [RFC3931]).\n   This built-in Hello facility provides dead peer and path detection\n
    \  only for the group of sessions associated with the L2TP Control\n   Connection.
    \ VCCV, however, allows individual L2TP sessions to be\n   tested.  This provides
    a more granular mechanism which can be used to\n   troubleshoot potential problems
    within the data plane of L2TP\n   endpoints themselves, or to provide additional
    connection status of\n   individual pseudowires.\n   The capability of which Control
    Channel Type (CC Type) to use is\n   advertised by a PE to indicate which of the
    potentially various\n   control channel types are supported.  Once the receiving
    PE has\n   chosen a mode to use, it MUST continue using this mode until such\n
    \  time as the PW is re-signaled.  Thus, if a new CC Type is desired,\n   the
    PW must be torn down and re-established.\n   An LCCE sends VCCV messages on an
    L2TPv3-signaled pseudowire for\n   fault detection and diagnostic of the L2TPv3
    session.  The VCCV\n   message travels in-band with the Session and follows the
    exact same\n   path as the user data for the session, because the IP header and\n
    \  L2TPv3 Session header are identical.  The egress LCCE of the L2TPv3\n   session
    intercepts and processes the VCCV message, and verifies the\n   signaling and
    forwarding state of the pseudowire on reception of the\n   VCCV message.  It is
    to be noted that the VCCV mechanism for L2TPv3\n   is primarily targeted at verifying
    the pseudowire forwarding and\n   signaling state at the egress LCCE.  It also
    helps when L2TPv3\n   Control Connection and Session paths are not identical.\n"
  - contents:
    - "6.1.  VCCV Control Channel Type for L2TPv3\n   In order to carry VCCV messages
      within an L2TPv3 session data packet,\n   the PW MUST be established such that
      an L2-Specific Sublayer (L2SS)\n   that defines the V-bit is present.  This
      document defines the V-bit\n   for the Default L2-Specific Sublayer [RFC3931]
      and the ATM-Specific\n   Sublayer [RFC4454] using the Bit 0 position (see Sections
      8.3.2 and\n   8.3.3).  The L2-Specific Sublayer presence and type (either the\n
      \  Default or a PW-Specific L2SS) is signaled via the L2-Specific\n   Sublayer
      AVP, Attribute Type 69, as defined in [RFC3931].  The V-bit\n   within the L2-Specific
      Sublayer is used to identify that a VCCV\n   message follows, and when the V-bit
      is set the L2SS has the format\n   shown in Figure 5:\n      0                   1
      \                  2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3
      4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \    |1|0 0 0|Version|   Reserved    |         Channel Type          |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \   Figure 5: L2-Specific Sublayer Format when the V-bit (bit 0) is set\n   The
      VCCV messages are distinguished from user data by the V-bit.  The\n   V-bit
      is set to 1, indicating that a VCCV session message follows.\n   The next three
      bits MUST be set to 0 when sending and ignored upon\n   receipt.  The remaining
      fields comprising 28 bits (i.e., Version,\n   Reserved, and Channel Type) follow
      the same definition, format, and\n   number registry from Section 5 of [RFC4385].\n
      \  The Version and Reserved fields are set to 0.  For the CV Type\n   currently
      defined of ICMP Ping (0x01), the Channel Type can indicate\n   IPv4 (0x0021)
      or IPv6 (0x0057) (see [RFC4385]) as the VCCV payload\n   directly following
      the L2SS.\n"
    title: 6.1.  VCCV Control Channel Type for L2TPv3
  - contents:
    - "6.2.  VCCV Connectivity Verification Type for L2TPv3\n   The VCCV message over
      L2TPv3 directly follows the L2-Specific\n   Sublayer with the V-bit set.  It
      MUST contain an ICMP Echo packet as\n   described in Section 6.2.1.\n"
    - contents:
      - "6.2.1.  L2TPv3 VCCV using ICMP Ping\n   When this connectivity verification
        mode is used, an ICMP Echo packet\n   using the encoding specified in [RFC0792]
        for (ICMPv4) or [RFC4443]\n   (for ICMPv6) achieves connectivity verification.
        \ Implementations\n   MUST use ICMPv4 [RFC0792] if the signaling for the L2TPv3
        PW used\n   IPv4 addresses, or ICMPv6 [RFC4443] if IPv6 addresses were used.
        \ If\n   the pseudowire is set-up statically, then the encoding MUST use that\n
        \  which was used for the pseudowire in the configuration.\n   The ICMP Ping
        packet directly follows the L2SS with the V-bit set.\n   In the ICMP Echo
        request, the IP Header fields MUST have the\n   following values: the destination
        IP address is set to the remote\n   LCCE's IP address for the tunnel endpoint,
        the source IP address is\n   set to the local LCCE's IP address for the tunnel
        endpoint, and the\n   TTL or Hop Limit is set to 1.\n"
      title: 6.2.1.  L2TPv3 VCCV using ICMP Ping
    title: 6.2.  VCCV Connectivity Verification Type for L2TPv3
  - contents:
    - "6.3.  L2TPv3 VCCV Capability Advertisement for L2TPv3\n   A new optional AVP
      is defined in Section 6.3.1 to indicate the VCCV\n   capabilities during session
      establishment.  An LCCE MUST signal its\n   desire to use connectivity verification
      for a particular L2TPv3\n   session and its VCCV capabilities using the VCCV
      Capability AVP.\n   An LCCE MUST NOT send VCCV packets on an L2TPv3 session
      unless it has\n   received VCCV capability by means of the VCCV Capability AVP
      from the\n   remote end.  If an LCCE receives VCCV packets and it is not VCCV\n
      \  capable or it has not sent VCCV capability indication to the remote\n   end,
      it MUST discard these messages.  It should also increment an\n   error counter.
      \ In this case the LCCE MAY optionally issue a system\n   and/or SNMP notification.\n"
    - contents:
      - "6.3.1.  L2TPv3 VCCV Capability AVP\n   The \"VCCV Capability AVP\", Attribute
        Type 96, specifies the VCCV\n   capabilities as a pair of bitflags for the
        Control Channel (CC) and\n   Connectivity Verification (CV) Types.  This AVP
        is exchanged during\n   session establishment (in ICRQ (Incoming-Call-Request),
        ICRP\n   (Incoming-Call-Reply), OCRQ (Outgoing-Call-Request), or OCRP\n   (Outgoing-Call-Reply)
        messages).  The value field has the following\n   format:\n   VCCV Capability
        AVP (ICRQ, ICRP, OCRQ, OCRP)\n       0                   1\n       0 1 2 3
        4 5 6 7 8 9 0 1 2 3 4 5\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |
        \  CC Types    |   CV Types    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \  CC Types:\n      The Control Channel (CC) Types field defines a bitmask
        used to\n      indicate the type of control channel(s) that may be used to\n
        \     receive OAM traffic on for the given Session.  The router agrees\n      to
        accept VCCV traffic at any time over any of the signaled VCCV\n      control
        channel types.  CC Type values are defined in Section 4.\n      Although there
        is only one value defined in this document, the CC\n      Types field is included
        for forward compatibility should further\n      CC Types need to be defined
        in the future.\n      A CC Type of 0x01 may only be requested when there is
        an L2-\n      Specific Sublayer that defines the V-bit present.  If a CC Type
        of\n      0x01 is requested without requesting an L2-Specific Sublayer AVP\n
        \     with an L2SS type that defines the V-bit, the session MUST be\n      disconnected
        with a Call-Disconnect-Notify (CDN) message.\n      If no CC Type is supported,
        a CC Type Indicator of 0x00 SHOULD be\n      sent.\n   CV Types:\n      The
        Connectivity Verification (CV) Types field defines a bitmask\n      used to
        indicate the specific type or types (i.e., none, one, or\n      more) of control
        packets that may be sent on the specified VCCV\n      control channel.  CV
        Type values are defined in Section 4.\n   If no VCCV Capability AVP is signaled,
        then the LCCE MUST assume that\n   the peer is incapable of receiving VCCV
        and MUST NOT send any OAM\n   control channel traffic to it.\n   All L2TP
        AVPs have an M (Mandatory) bit, H (Hidden) bit, Length, and\n   Vendor ID.
        \ The Vendor ID for the VCCV Capability AVP MUST be 0,\n   indicating that
        this is an IETF-defined AVP.  This AVP MAY be hidden\n   (the H bit MAY be
        0 or 1).  The M bit for this AVP SHOULD be set to\n   0.  The Length (before
        hiding) of this AVP is 8.\n"
      title: 6.3.1.  L2TPv3 VCCV Capability AVP
    title: 6.3.  L2TPv3 VCCV Capability Advertisement for L2TPv3
  title: 6.  VCCV Control Channel for L2TPv3/IP PWs
- contents:
  - "7.  Capability Advertisement Selection\n   When a PE receives a VCCV capability
    advertisement, the advertisement\n   may potentially contain more than one CC
    or CV Type.  Only matching\n   capabilities can be selected.  When multiple capabilities
    match, only\n   one CC Type MUST be used.\n   In particular, as already specified,
    once a valid CC Type is used by\n   a PE (traffic sent using that encapsulation),
    the PE MUST NOT send\n   any traffic down another CC Type control channel.\n   For
    cases where multiple CC Types are advertised, the following\n   precedence rules
    apply when choosing the single CC Type to use:\n   1.  Type 1: PWE3 Control Word
    with 0001b as first nibble\n   2.  Type 2: MPLS Router Alert Label\n   3.  Type
    3: MPLS PW Label with TTL == 1\n   For MPLS PWs, the CV Type of LSP Ping (0x02)
    is the default, and the\n   CV Type of ICMP Ping (0x01) is optional.\n"
  title: 7.  Capability Advertisement Selection
- contents:
  - '8.  IANA Considerations

    '
  - contents:
    - "8.1.  VCCV Interface Parameters Sub-TLV\n   The VCCV Interface Parameters Sub-TLV
      codepoint is defined in\n   [RFC4446].  IANA has created and will maintain registries
      for the CC\n   Types and CV Types (bitmasks in the VCCV Parameter ID).  The
      CC Type\n   and CV Type new registries (see Sections 8.1.1 and 8.1.2,\n   respectively)
      have been created in the Pseudo Wires Name Spaces,\n   reachable from [IANA.pwe3-parameters].
      \ The allocations must be done\n   using the \"IETF Consensus\" policy defined
      in [RFC2434].\n"
    - contents:
      - "8.1.1.  MPLS VCCV Control Channel (CC) Types\n   IANA has set up a registry
        of \"MPLS VCCV Control Channel Types\".\n   These are 8 bitfields.  CC Type
        values 0x01, 0x02, and 0x04 are\n   specified in Section 4 of this document.
        \ The remaining bitfield\n   values (0x08, 0x10, 0x20, 0x40, and 0x80) are
        to be assigned by IANA\n   using the \"IETF Consensus\" policy defined in
        [RFC2434].  A VCCV\n   Control Channel Type description and a reference to
        an RFC approved\n   by the IESG are required for any assignment from this
        registry.\n      MPLS Control Channel (CC) Types:\n      Bit (Value)    Description\n
        \     ============   ==========================================\n      Bit
        0 (0x01) - Type 1: PWE3 Control Word with 0001b as\n                     first
        nibble (PW-ACH, see [RFC4385])\n      Bit 1 (0x02) - Type 2: MPLS Router Alert
        Label\n      Bit 2 (0x04) - Type 3: MPLS PW Label with TTL == 1\n      Bit
        3 (0x08) - Reserved\n      Bit 4 (0x10) - Reserved\n      Bit 5 (0x20) - Reserved\n
        \     Bit 6 (0x40) - Reserved\n      Bit 7 (0x80) - Reserved\n   The most
        significant (high order) bit is labeled Bit 7, and the least\n   significant
        (low order) bit is labeled Bit 0, see parenthetical\n   \"Value\".\n"
      title: 8.1.1.  MPLS VCCV Control Channel (CC) Types
    - contents:
      - "8.1.2.  MPLS VCCV Connectivity Verification (CV) Types\n   IANA has set up
        a registry of \"MPLS VCCV Control Verification Types\".\n   These are 8 bitfields.
        \ CV Type values 0x01 and 0x02 are specified in\n   Section 4 of this document.
        \ The remaining bitfield values (0x04,\n   0x08, 0x10, 0x20, 0x40, and 0x80)
        are to be assigned by IANA using\n   the \"IETF Consensus\" policy defined
        in [RFC2434].  A VCCV Control\n   Verification Type description and a reference
        to an RFC approved by\n   the IESG are required for any assignment from this
        registry.\n      MPLS Connectivity Verification (CV) Types:\n      Bit (Value)
        \   Description\n      ============   ==========================================\n
        \     Bit 0 (0x01) - ICMP Ping\n      Bit 1 (0x02) - LSP Ping\n      Bit 2
        (0x04) - Reserved\n      Bit 3 (0x08) - Reserved\n      Bit 4 (0x10) - Reserved\n
        \     Bit 5 (0x20) - Reserved\n      Bit 6 (0x40) - Reserved\n      Bit 7
        (0x80) - Reserved\n   The most significant (high order) bit is labeled Bit
        7, and the least\n   significant (low order) bit is labeled Bit 0, see parenthetical\n
        \  \"Value\".\n"
      title: 8.1.2.  MPLS VCCV Connectivity Verification (CV) Types
    title: 8.1.  VCCV Interface Parameters Sub-TLV
  - contents:
    - "8.2.  PW Associated Channel Type\n   The PW Associated Channel Types used by
      VCCV as defined in Sections\n   5.1.1 and 6.1 rely on previously allocated numbers
      from the\n   Pseudowire Associated Channel Types Registry [RFC4385] in the Pseudo\n
      \  Wires Name Spaces reachable from [IANA.pwe3-parameters].  In\n   particular,
      0x21 (Internet Protocol version 4) MUST be used whenever\n   an IPv4 payload
      follows the Pseudowire Associated Channel Header, or\n   0x57 MUST be used when
      an IPv6 payload follows the Pseudowire\n   Associated Channel Header.\n"
    title: 8.2.  PW Associated Channel Type
  - contents:
    - "8.3.  L2TPv3 Assignments\n   Section 8.3.1 through Section 8.3.3 are registrations
      of new L2TP\n   values for registries already managed by IANA.  Section 8.3.4
      is a\n   new registry that has been added to the existing L2TP name spaces,\n
      \  and will be maintained by IANA accordingly.  The Layer Two Tunneling\n   Protocol
      \"L2TP\" Name Spaces are reachable from\n   [IANA.l2tp-parameters].\n"
    - contents:
      - "8.3.1.  Control Message Attribute Value Pairs (AVPs)\n   An additional AVP
        Attribute is specified in Section 6.3.1.  It was\n   defined by IANA as described
        in Section 2.2 of [RFC3438].\n      Attribute\n      Type        Description\n
        \     ---------   ----------------------------------\n      96          VCCV
        Capability AVP\n"
      title: 8.3.1.  Control Message Attribute Value Pairs (AVPs)
    - contents:
      - "8.3.2.  Default L2-Specific Sublayer Bits\n   The Default L2-Specific Sublayer
        contains 8 bits in the low-order\n   portion of the header.  This document
        defines one reserved bit in the\n   Default L2-Specific Sublayer in Section
        6.1, which was assigned by\n   IANA following IETF Consensus [RFC2434].\n
        \     Default L2-Specific Sublayer bits - per [RFC3931]\n      ---------------------------------\n
        \     Bit 0 - V (VCCV) bit\n"
      title: 8.3.2.  Default L2-Specific Sublayer Bits
    - contents:
      - "8.3.3.  ATM-Specific Sublayer Bits\n   The ATM-Specific Sublayer contains
        8 bits in the low-order portion of\n   the header.  This document defines
        one reserved bit in the ATM-\n   Specific Sublayer in Section 6.1, which was
        assigned by IANA\n   following IETF Consensus [RFC2434].\n      ATM-Specific
        Sublayer bits - per [RFC4454]\n      --------------------------\n      Bit
        0 - V (VCCV) bit\n"
      title: 8.3.3.  ATM-Specific Sublayer Bits
    - contents:
      - "8.3.4.  VCCV Capability AVP Values\n   This is a new registry that IANA maintains
        in the L2TP Name Spaces.\n   IANA created and maintains a registry for the
        CC Types and CV Types\n   bitmasks in the VCCV Capability AVP, defined in
        Section 6.3.1.  The\n   allocations must be done using the \"IETF Consensus\"
        policy defined in\n   [RFC2434].  A VCCV CC or CV Type description and a reference
        to an\n   RFC approved by the IESG are required for any assignment from this\n
        \  registry.\n   IANA has reserved the following bits in this registry:\n
        \     VCCV Capability AVP (Attribute Type 96) Values\n      ---------------------------------------------------\n
        \     L2TPv3 Control Channel (CC) Types:\n         Bit (Value)    Description\n
        \        ============   ==========================================\n         Bit
        0 (0x01) - L2-Specific Sublayer with V-bit set\n         Bit 1 (0x02) - Reserved\n
        \        Bit 2 (0x04) - Reserved\n         Bit 3 (0x08) - Reserved\n         Bit
        4 (0x10) - Reserved\n         Bit 5 (0x20) - Reserved\n         Bit 6 (0x40)
        - Reserved\n         Bit 7 (0x80) - Reserved\n      L2TPv3 Connectivity Verification
        (CV) Types:\n         Bit (Value)    Description\n         ============   ==========================================\n
        \        Bit 0 (0x01) - ICMP Ping\n         Bit 1 (0x02) - Reserved\n         Bit
        2 (0x04) - Reserved\n         Bit 3 (0x08) - Reserved\n         Bit 4 (0x10)
        - Reserved\n         Bit 5 (0x20) - Reserved\n         Bit 6 (0x40) - Reserved\n
        \        Bit 7 (0x80) - Reserved\n   The most significant (high order) bit
        is labeled Bit 7, and the least\n   significant (low order) bit is labeled
        Bit 0, see parenthetical\n   \"Value\".\n"
      title: 8.3.4.  VCCV Capability AVP Values
    title: 8.3.  L2TPv3 Assignments
  title: 8.  IANA Considerations
- contents:
  - "9.  Congestion Considerations\n   The bandwidth resources used by VCCV are recommended
    to be minimal\n   compared to those of the associated PW.  The bandwidth required
    for\n   the VCCV channel is taken outside any allocation for PW data traffic,\n
    \  and can be configurable.  When doing resource reservation or network\n   planning,
    the bandwidth requirements for both PW data and VCCV\n   traffic need to be taken
    into account.\n   VCCV applications (i.e., Connectivity Verification (CV) Types)
    MUST\n   consider congestion and bandwidth usage implications and provide\n   details
    on bandwidth or packet frequency management.  VCCV\n   applications can have built-in
    bandwidth management in their\n   protocols.  Other VCCV applications can have
    their bandwidth\n   configuration-limited, and rate-limiting them can be harmful
    as it\n   could translate to incorrectly declaring connectivity failures.  For\n
    \  all other VCCV applications, outgoing VCCV messages SHOULD be rate-\n   limited
    to prevent aggressive connectivity verification consuming\n   excessive bandwidth,
    causing congestion, becoming denial-of-service\n   attacks, or generating an excessive
    packet rate at the CE-bound PE.\n   If these conditions cannot be followed, an
    adaptive loss-based scheme\n   SHOULD be applied to congestion-control outgoing
    VCCV traffic, so\n   that it competes fairly with TCP within an order of magnitude.
    \ One\n   method of determining an acceptable bandwidth for VCCV is described\n
    \  in [RFC3448] (TFRC); other methods exist.  For example, bandwidth or\n   packet
    frequency management can include any of the following: a\n   negotiation of transmission
    interval/rate, a throttled transmission\n   rate on \"congestion detected\" situations,
    a slow-start after shutdown\n   due to congestion and until basic connectivity
    is verified, and other\n   mechanisms.\n   The ICMP and MPLS LSP PING applications
    SHOULD be rate-limited to\n   below 5% of the bit-rate of the associated PW.  For
    this purpose, the\n   considered bit-rate of a pseudowire is dependent on the
    PW type.  For\n   pseudowires that carry constant bit-rate traffic (e.g., TDM
    PWs) the\n   full bit-rate of the PW is used.  For pseudowires that carry variable\n
    \  bit-rate traffic (e.g., Ethernet PWs), the mean or sustained bit-rate\n   of
    the PW is used.\n   As described in Section 10, incoming VCCV messages can be
    rate-\n   limited as a protection against denial-of-service attacks.  This\n   throttling
    or policing of incoming VCCV messages should not be more\n   stringent than the
    bandwidth allocated to the VCCV channel to prevent\n   false indications of connectivity
    failure.\n"
  title: 9.  Congestion Considerations
- contents:
  - "10.  Security Considerations\n   Routers that implement VCCV create a Control
    Channel (CC) associated\n   with a pseudowire.  This control channel can be signaled
    (e.g., using\n   LDP or L2TPv3 depending on the PWE3) or statically configured.
    \ Over\n   this control channel, VCCV Connectivity Verification (CV) messages\n
    \  are sent.  Therefore, three different areas are of concern from a\n   security
    standpoint.\n   The first area of concern relates to control plane parameter and\n
    \  status message attacks, that is, attacks that concern the signaling\n   of
    VCCV capabilities.  MPLS PW Control Plane security is discussed in\n   Section
    8.2 of [RFC4447].  L2TPv3 PW Control Plane security is\n   discussed in Section
    8.1 of [RFC3931].  The addition of the\n   connectivity verification negotiation
    extensions does not change the\n   security aspects of Section 8.2 of [RFC4447],
    or Section 8.1 of\n   [RFC3931].  Implementation of IP source address filters
    may also aid\n   in deterring these types of attacks.\n   A second area of concern
    centers on data-plane attacks, that is,\n   attacks on the associated channel
    itself.  Routers that implement the\n   VCCV mechanisms are subject to additional
    data-plane denial-of-\n   service attacks as follows:\n      An intruder could
    intercept or inject VCCV packets effectively\n      providing false positives
    or false negatives.\n      An intruder could deliberately flood a peer router
    with VCCV\n      messages to deny services to others.\n      A misconfigured or
    misbehaving device could inadvertently flood a\n      peer router with VCCV messages
    which could result in denial of\n      services.  In particular, if a router has
    either implicitly or\n      explicitly indicated that it cannot support one or
    all of the\n      types of VCCV, but is sent those messages in sufficient quantity,\n
    \     it could result in a denial of service.\n   To protect against these potential
    (deliberate or unintentional)\n   attacks, multiple mitigation techniques can
    be employed:\n      VCCV message throttling mechanisms can be used, especially
    in\n      distributed implementations which have a centralized control-plane\n
    \     processor with various line cards attached by some control-plane\n      data
    path.  In these architectures, VCCV messages may be processed\n      on the central
    processor after being forwarded there by the\n      receiving line card.  In this
    case, the path between the line card\n      and the control processor may become
    saturated if appropriate VCCV\n      traffic throttling is not employed, which
    could lead to a complete\n      denial of service to users of the particular line
    card.  Such\n      filtering is also useful for preventing the processing of unwanted\n
    \     VCCV messages, such as those which are sent on unwanted (and\n      perhaps
    unadvertised) control channel types or VCCV types.\n      Section 8.1 of [RFC4447]
    discusses methods to protect the data\n      plane of MPLS PWs from data-plane
    attacks.  However the\n      implementation of the connectivity verification protocol
    expands\n      the range of possible data-plane attacks.  For this reason\n      implementations
    MUST provide a method to secure the data plane.\n      This can be in the form
    of encryption of the data by running IPsec\n      on MPLS packets encapsulated
    according to [RFC4023], or by\n      providing the ability to architect the MPLS
    network in such a way\n      that no external MPLS packets can be injected (private
    MPLS\n      network).\n      For L2TPv3, data packet spoofing considerations are
    outlined in\n      Section 8.2 of [RFC3931].  While the L2TPv3 Session ID provides\n
    \     traffic separation, the optional Cookie field provides additional\n      protection
    to thwart spoofing attacks.  To maximize protection\n      against a variety of
    data-plane attacks, a 64-bit Cookie can be\n      used.  L2TPv3 can also be run
    over IPsec as detailed in Section\n      4.1.3 of [RFC3931].\n   A third and last
    area of concern relates to the processing of the\n   actual contents of VCCV messages,
    i.e., LSP Ping and ICMP messages.\n   Therefore, the corresponding security considerations
    for these\n   protocols (LSP Ping [RFC4379], ICMPv4 Ping [RFC0792], and ICMPv6
    Ping\n   [RFC4443]) apply as well.\n"
  title: 10.  Security Considerations
- contents:
  - "11.  Acknowledgements\n   The authors would like to thank Hari Rakotoranto, Michel
    Khouderchah,\n   Bertrand Duvivier, Vanson Lim, Chris Metz, W. Mark Townsley,
    Eric\n   Rosen, Dan Tappan, Danny McPherson, Luca Martini, Don O'Connor, Neil\n
    \  Harrison, Danny Prairie, Mustapha Aissaoui, and Vasile Radoaca for\n   their
    valuable comments and suggestions.\n"
  title: 11.  Acknowledgements
- contents:
  - '12.  References

    '
  - contents:
    - "12.1.  Normative References\n   [RFC0792]  Postel, J., \"Internet Control Message
      Protocol\", STD 5,\n              RFC 792, September 1981.\n   [RFC2119]  Bradner,
      S., \"Key words for use in RFCs to Indicate\n              Requirement Levels\",
      BCP 14, RFC 2119, March 1997.\n   [RFC3032]  Rosen, E., Tappan, D., Fedorkow,
      G., Rekhter, Y.,\n              Farinacci, D., Li, T., and A. Conta, \"MPLS
      Label Stack\n              Encoding\", RFC 3032, January 2001.\n   [RFC3931]
      \ Lau, J., Townsley, M., and I. Goyret, \"Layer Two Tunneling\n              Protocol
      - Version 3 (L2TPv3)\", RFC 3931, March 2005.\n   [RFC4379]  Kompella, K. and
      G. Swallow, \"Detecting Multi-Protocol\n              Label Switched (MPLS)
      Data Plane Failures\", RFC 4379,\n              February 2006.\n   [RFC4385]
      \ Bryant, S., Swallow, G., Martini, L., and D. McPherson,\n              \"Pseudowire
      Emulation Edge-to-Edge (PWE3) Control Word for\n              Use over an MPLS
      PSN\", RFC 4385, February 2006.\n   [RFC4443]  Conta, A., Deering, S., and M.
      Gupta, \"Internet Control\n              Message Protocol (ICMPv6) for the Internet
      Protocol\n              Version 6 (IPv6) Specification\", RFC 4443, March 2006.\n
      \  [RFC4446]  Martini, L., \"IANA Allocations for Pseudowire Edge to Edge\n
      \             Emulation (PWE3)\", BCP 116, RFC 4446, April 2006.\n   [RFC4447]
      \ Martini, L., Rosen, E., El-Aawar, N., Smith, T., and G.\n              Heron,
      \"Pseudowire Setup and Maintenance Using the Label\n              Distribution
      Protocol (LDP)\", RFC 4447, April 2006.\n"
    title: 12.1.  Normative References
  - contents:
    - "12.2.  Informative References\n   [IANA.l2tp-parameters]\n              Internet
      Assigned Numbers Authority, \"Layer Two Tunneling\n              Protocol \"L2TP\"\",
      April 2007,\n              <http://www.iana.org/assignments/l2tp-parameters>.\n
      \  [IANA.pwe3-parameters]\n              Internet Assigned Numbers Authority,
      \"Pseudo Wires Name\n              Spaces\", June 2007,\n              <http://www.iana.org/assignments/pwe3-parameters>.\n
      \  [MSG-MAP]  Nadeau, T., \"Pseudo Wire (PW) OAM Message Mapping\",\n              Work
      in Progress, March 2007.\n   [RFC2434]  Narten, T. and H. Alvestrand, \"Guidelines
      for Writing an\n              IANA Considerations Section in RFCs\", BCP 26,
      RFC 2434,\n              October 1998.\n   [RFC3438]  Townsley, W., \"Layer
      Two Tunneling Protocol (L2TP)\n              Internet Assigned Numbers Authority
      (IANA) Considerations\n              Update\", BCP 68, RFC 3438, December 2002.\n
      \  [RFC3448]  Handley, M., Floyd, S., Padhye, J., and J. Widmer, \"TCP\n              Friendly
      Rate Control (TFRC): Protocol Specification\",\n              RFC 3448, January
      2003.\n   [RFC3916]  Xiao, X., McPherson, D., and P. Pate, \"Requirements for\n
      \             Pseudo-Wire Emulation Edge-to-Edge (PWE3)\", RFC 3916,\n              September
      2004.\n   [RFC3985]  Bryant, S. and P. Pate, \"Pseudo Wire Emulation Edge-to-\n
      \             Edge (PWE3) Architecture\", RFC 3985, March 2005.\n   [RFC4023]
      \ Worster, T., Rekhter, Y., and E. Rosen, \"Encapsulating\n              MPLS
      in IP or Generic Routing Encapsulation (GRE)\",\n              RFC 4023, March
      2005.\n   [RFC4377]  Nadeau, T., Morrow, M., Swallow, G., Allan, D., and S.\n
      \             Matsushima, \"Operations and Management (OAM) Requirements\n              for
      Multi-Protocol Label Switched (MPLS) Networks\",\n              RFC 4377, February
      2006.\n   [RFC4448]  Martini, L., Rosen, E., El-Aawar, N., and G. Heron,\n              \"Encapsulation
      Methods for Transport of Ethernet over MPLS\n              Networks\", RFC 4448,
      April 2006.\n   [RFC4454]  Singh, S., Townsley, M., and C. Pignataro, \"Asynchronous\n
      \             Transfer Mode (ATM) over Layer 2 Tunneling Protocol\n              Version
      3 (L2TPv3)\", RFC 4454, May 2006.\n   [RFC4928]  Swallow, G., Bryant, S., and
      L. Andersson, \"Avoiding Equal\n              Cost Multipath Treatment in MPLS
      Networks\", BCP 128,\n              RFC 4928, June 2007.\n"
    title: 12.2.  Informative References
  title: 12.  References
- contents:
  - "Appendix A.  Contributors' Addresses\n   George Swallow\n   Cisco Systems, Inc.\n
    \  300 Beaver Brook Road\n   Boxborough, MA 01719\n   USA\n   EMail: swallow@cisco.com\n
    \  Monique Morrow\n   Cisco Systems, Inc.\n   Glatt-com\n   CH-8301 Glattzentrum\n
    \  Switzerland\n   EMail: mmorrow@cisco.com\n   Yuichi Ikejiri\n   NTT Communication
    Corporation\n   1-1-6, Uchisaiwai-cho, Chiyoda-ku\n   Tokyo 100-8019\n   Shinjuku-ku\n
    \  JAPAN\n   EMail: y.ikejiri@ntt.com\n   Kenji Kumaki\n   KDDI Corporation\n
    \  KDDI Bldg. 2-3-2\n   Nishishinjuku\n   Tokyo 163-8003\n   JAPAN\n   EMail:
    ke-kumaki@kddi.com\n   Peter B. Busschbach\n   Alcatel-Lucent\n   67 Whippany
    Road\n   Whippany, NJ, 07981\n   USA\n   EMail: busschbach@alcatel-lucent.com\n
    \  Rahul Aggarwal\n   Juniper Networks\n   1194 North Mathilda Ave.\n   Sunnyvale,
    CA 94089\n   USA\n   EMail: rahul@juniper.net\n   Luca Martini\n   Cisco Systems,
    Inc.\n   9155 East Nichols Avenue, Suite 400\n   Englewood, CO, 80112\n   USA\n
    \  EMail: lmartini@cisco.com\n"
  title: Appendix A.  Contributors' Addresses
- contents:
  - "Authors' Addresses\n   Thomas D. Nadeau (editor)\n   Cisco Systems, Inc.\n   300
    Beaver Brook Road\n   Boxborough, MA  01719\n   USA\n   EMail: tnadeau@lucidvision.com\n
    \  Carlos Pignataro (editor)\n   Cisco Systems, Inc.\n   7200 Kit Creek Road\n
    \  PO Box 14987\n   Research Triangle Park, NC  27709\n   USA\n   EMail: cpignata@cisco.com\n"
  title: Authors' Addresses
- contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document
    is subject to the rights, licenses and restrictions\n   contained in BCP 78, and
    except as set forth therein, the authors\n   retain all their rights.\n   This
    document and the information contained herein are provided on an\n   \"AS IS\"
    basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n   OR IS SPONSORED
    BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE INTERNET ENGINEERING
    TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED, INCLUDING BUT NOT
    LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION HEREIN WILL NOT INFRINGE
    ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
    PURPOSE.\n"
  title: Full Copyright Statement
- contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or
    scope of any\n   Intellectual Property Rights or other rights that might be claimed
    to\n   pertain to the implementation or use of the technology described in\n   this
    document or the extent to which any license under such rights\n   might or might
    not be available; nor does it represent that it has\n   made any independent effort
    to identify any such rights.  Information\n   on the procedures with respect to
    rights in RFC documents can be\n   found in BCP 78 and BCP 79.\n   Copies of IPR
    disclosures made to the IETF Secretariat and any\n   assurances of licenses to
    be made available, or the result of an\n   attempt made to obtain a general license
    or permission for the use of\n   such proprietary rights by implementers or users
    of this\n   specification can be obtained from the IETF on-line IPR repository
    at\n   http://www.ietf.org/ipr.\n   The IETF invites any interested party to bring
    to its attention any\n   copyrights, patents or patent applications, or other
    proprietary\n   rights that may cover technology that may be required to implement\n
    \  this standard.  Please address the information to the IETF at\n   ietf-ipr@ietf.org.\n"
  title: Intellectual Property
