- title: __initial_text__
  contents:
  - ''
- title: Independent Submission                                          K. Leung
  contents:
  - "Independent Submission                                          K. Leung\n  \
    \               WiMAX Forum / 3GPP2 Proxy Mobile IPv4\n"
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv4 is a standard mobility protocol that enables an IPv4\n\
    \   device to move among networks while maintaining its IP address.  The\n   mobile\
    \ device has the Mobile IPv4 client function to signal its\n   location to the\
    \ routing anchor, known as the Home Agent.  However,\n   there are many IPv4 devices\
    \ without such capability due to various\n   reasons.  This document describes\
    \ Proxy Mobile IPv4 (PMIPv4), a\n   scheme based on having the Mobile IPv4 client\
    \ function in a network\n   entity to provide mobility support for an unaltered\
    \ and mobility-\n   unaware IPv4 device.  This document also describes a particular\n\
    \   application of PMIPv4 as specified in the WiMAX Forum and another\n   application\
    \ that is to be adopted in 3GPP2.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This is a contribution to\
    \ the RFC Series, independently of any other\n   RFC stream.  The RFC Editor has\
    \ chosen to publish this document at\n   its discretion and makes no statement\
    \ about its value for\n   implementation or deployment.  Documents approved for\
    \ publication by\n   the RFC Editor are not a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc5563.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Conventions Used in This Document ...............................4\n  \
    \ 3. Benefits of Proxy Mobile IPv4 ...................................6\n   4.\
    \ Overview of Proxy Mobile IPv4 ...................................7\n      4.1.\
    \ Mobility Signaling for Mobile Device .......................7\n           4.1.1.\
    \ Proxy Registration during Initial Network\n                  Attachment ..........................................8\n\
    \           4.1.2. Proxy Registration Renewal .........................11\n  \
    \         4.1.3. Proxy Handover Support .............................12\n    \
    \       4.1.4. Resource Cleanup ...................................13\n      4.2.\
    \ Establishment of a Bi-Directional Tunnel ..................14\n           4.2.1.\
    \ Packet Forwarding ..................................14\n           4.2.2. Broadcast\
    \ and Multicast ............................14\n           4.2.3. Forwarding between\
    \ Devices on the Same PMA .........15\n      4.3. Security Association between\
    \ the PMA and the HA ...........15\n      4.4. Registration Sequencing ...................................15\n\
    \      4.5. Mobile Device Interface Configuration .....................16\n  \
    \    4.6. Dynamic HA Discovery ......................................16\n   5.\
    \ Proxy Mobile IPv4 Extensions ...................................16\n      5.1.\
    \ PMIPv4 Per-Node Authentication Method Extension ...........17\n      5.2. Proxy\
    \ Mobile IPv4 Interface ID Extension ..................18\n      5.3. Proxy Mobile\
    \ IPv4 Device ID Extension .....................18\n      5.4. Proxy Mobile IPv4\
    \ Subscriber ID Extension .................19\n      5.5. PMIPv4 Access Technology\
    \ Type Extension ...................20\n   6. Appearance of Being at Home Network\
    \ ............................22\n      6.1. ARP Considerations ........................................22\n\
    \      6.2. ICMP Considerations .......................................23\n  \
    \    6.3. DHCP Considerations .......................................23\n    \
    \  6.4. PPP IPCP Considerations ...................................24\n      6.5.\
    \ Link-Local Multicast and Broadcast Considerations .........24\n   7. Proxy Mobility\
    \ Agent Operation .................................24\n   8. Home Agent Operation\
    \ ...........................................25\n      8.1. Processing Proxy Registration\
    \ Requests ....................26\n   9. Mobile Device Operation ........................................26\n\
    \      9.1. Initial Network Access ....................................27\n  \
    \    9.2. Mobile Device Mobility ....................................27\n    \
    \  9.3. Sending and Receiving Packets .............................27\n   10.\
    \ Proxy Mobile IPv4 Use Case in WiMAX ...........................28\n      10.1.\
    \ Proxy Mobile IPv4 Call Flow Examples with Split\n            PMA in WiMAX .............................................31\n\
    \   11. Proxy Mobile IPv4 Use Case in 3GPP2 ...........................33\n  \
    \    11.1. Handover Considerations in 3GPP2 .........................36\n   12.\
    \ IANA Considerations ...........................................37\n      12.1.\
    \ Mobile IPv4 Extension Types ..............................38\n      12.2. Mobile\
    \ IPv4 Error Codes ..................................38\n   13. Security Considerations\
    \ .......................................38\n   14. Acknowledgements ..............................................38\n\
    \   15. References ....................................................39\n  \
    \    15.1. Normative References .....................................39\n    \
    \  15.2. Informative References ...................................39\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   There are many IPv4 devices that do not have or cannot be\
    \ enabled\n   with Mobile IPv4 [RFC3344] functionality.  Yet, mobility for them\
    \ is\n   essential.  Proxy Mobile IPv4 provides mobility support without\n   \"\
    touching\" these devices.  The scheme is based on network entities\n   that perform\
    \ the mobility-management function for a mobile device.\n   The location of the\
    \ device is signaled by the network element on the\n   access network (referred\
    \ to as the Proxy Mobility Agent (PMA)) to\n   inform the network entity on the\
    \ home network (referred to as the\n   Home Agent (HA)) associated with the IPv4\
    \ address used by the device.\n   Mobile IPv4 messaging is used by the PMA and\
    \ HA, which correspond to\n   the RFC 3344 entities Mobile Node (in proxy mode)\
    \ and Home Agent,\n   respectively.\n   These are some examples of Proxy Mobile\
    \ IPv4:\n   1.  A Wireless Local Area Network (WLAN) access point or cellular\n\
    \       base station performs registration with the Home Agent when a\n      \
    \ mobile device is associated on the air-link.\n   2.  An access router or Foreign\
    \ Agent performs registration with the\n       Home Agent when a mobile device\
    \ is detected on the network.\n   Mobile IPv4 is used by the network entities\
    \ because the mobility\n   protocol has the functions needed to set up the route\
    \ and tunneling\n   endpoints for the mobile device's IP address and to deliver\n\
    \   configuration parameters (e.g., DNS server addresses, default\n   gateway)\
    \ for enabling the mobile device's IP stack.  When Mobile IPv4\n   is used in\
    \ this way, the security association is between the PMA and\n   the HA because\
    \ these entities are the signaling endpoints.  Also,\n   when the mobile device\
    \ moves to a new PMA, the sequencing of messages\n   sourced from multiple PMAs\
    \ needs to be handled properly by the HA.\n   This document describes how the\
    \ network entities, PMA and HA, provide\n   mobility management for the mobile\
    \ device.  It is organized to cover\n   the generic functionality of Proxy Mobile\
    \ IPv4 and also the specifics\n   pertaining to WiMAX (Section 10) and 3GPP2 (Section\
    \ 11).\n   Note that Proxy Mobile IPv6 [RFC5213] is an IETF standard for\n   network-based\
    \ mobility management that enables IP mobility for a host\n   without requiring\
    \ its participation in any mobility-related\n   signaling.\n"
- title: 2.  Conventions Used in This Document
  contents:
  - "2.  Conventions Used in This Document\n   The keywords \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n   The following new terminology and abbreviations are\
    \ introduced in\n   this document; all other general mobility-related terms are\
    \ as\n   defined in Mobile IPv4 specification [RFC3344].\n   Mobile Device\n \
    \     The mobile device is used to refer to an IPv4 device with its\n      mobility\
    \ provided by the network.  The mobile device is not\n      required to participate\
    \ in any mobility-related signaling for\n      achieving mobility for an obtained\
    \ IP address.\n   Proxy Mobile IPv4 Client (PMIPv4 Client)\n      This network\
    \ function is responsible for initiating and\n      maintaining the Proxy Mobile\
    \ IPv4 registration on behalf of the\n      mobile device.  Essentially, it performs\
    \ the Mobile IPv4 client\n      function but is hosted in the network.  In some\
    \ cases, this\n      function is collocated with the Foreign Agent; in others,\
    \ it is\n      not.  In both cases, Proxy Mobile IPv4 registration still goes\
    \ via\n      the Foreign Agent at all practical effects, even if it is internal\n\
    \      to the node.\n   Home Agent (HA)\n      The Home Agent that is defined\
    \ in Mobile IPv4 [RFC3344] is used in\n      the Proxy Mobile IPv4 scheme.  It\
    \ is the topological anchor point\n      for the mobile device's home network\
    \ and is the entity that\n      manages the mobile device's reachability state.\
    \  The additional\n      capabilities for supporting Proxy Mobile IPv4 in the\
    \ Home Agent\n      are defined in this document.\n   Foreign Agent (FA)\n   \
    \   The Foreign Agent that is defined in [RFC3344] is used in the\n      Proxy\
    \ Mobile IPv4 scheme.  It is either collocated with or\n      separate from the\
    \ PMIPv4 client.  It serves the purpose of tunnel\n      endpoint from Proxy Mobile\
    \ IPv4 perspective.\n   Access Router (AR)\n      Access Router is a commonly\
    \ used term that refers to the node in\n      the network that connects the hosts\
    \ to the IP network.\n   Proxy Mobility Agent (PMA)\n      Proxy Mobility Agent\
    \ is the logical entity in the network that\n      encompasses both the PMIPv4\
    \ client and the FA functions.  The\n      PMIPv4 client and the FA collocation\
    \ in the Access Router\n      constitute an integrated PMA.  When the PMIPv4 client\
    \ and the FA\n      functions are not collocated in the Access Router, it is referred\n\
    \      to as a split PMA.  A PMIPv4 client may have association with\n      multiple\
    \ FAs, and vice versa.\n   Proxy Registration Request (PRRQ)\n      The Registration\
    \ Request message is sent by the Proxy Mobility\n      Agent to the Home Agent\
    \ in order to set up a mobility binding\n      entry for a mobile device.  The\
    \ message format is identical to\n      that of the Mobile IPv4 Registration Request,\
    \ though the Proxy\n      Mobile IPv4 extensions that are defined in this document\
    \ may be\n      included for enhanced features of network-based mobility\n   \
    \   management.\n   Proxy Registration Reply (PRRP)\n      The Registration Reply\
    \ message is sent by the Home Agent in\n      response to the Proxy Registration\
    \ Request received from the Proxy\n      Mobility Agent.  The message format is\
    \ identical to that of the\n      Mobile IPv4 Registration Reply, though the Proxy\
    \ Mobile IPv4\n      extensions that are defined in this document may be included\
    \ for\n      enhanced features of network-based mobility management.\n"
- title: 3.  Benefits of Proxy Mobile IPv4
  contents:
  - "3.  Benefits of Proxy Mobile IPv4\n   Proxy Mobile IPv4 (PMIPv4) is designed\
    \ to satisfy the requirements\n   listed below.  In addition, while this specification\
    \ and Proxy Mobile\n   IPv4 are not standards, they employ a standard: Mobile\
    \ IPv4.\n   Implementations of Mobile IPv4 can be re-used (i.e., a client-based\n\
    \   mobility protocol can be used \"as-is\" to support network-based\n   mobility).\
    \  However, new PMIPv4 extensions that are added to Mobile\n   IPv4 improves the\
    \ flexibility of the solution.  The practical\n   advantage of having a common\
    \ mobility protocol for both client-based\n   and network-based mobility is that\
    \ a Home Agent can anchor all types\n   of mobile devices, both ones that have\
    \ and ones that lack the Mobile\n   IPv4 function.\n   The network-based mobility\
    \ management solution defined in this\n   document has the following significant\
    \ reasons for its use in any\n   wireless network:\n   1.  Support for Unmodified\
    \ Hosts\n       An overwhelming majority of IPv4 hosts do not have Mobile IPv4\n\
    \       capability.  Providing mobility for them is achievable using\n       Proxy\
    \ Mobile IPv4.  This is accomplished without \"touching\" the\n       user's devices\
    \ by running on a myriad of operating systems and\n       networking stacks.\n\
    \   2.  Re-Use of Existing Home Agent\n       An existing Home Agent implementation\
    \ can be used for network-\n       based mobility as well.  Further enhancements\
    \ are optional and\n       only incremental in nature.  There are many commonalities\
    \ between\n       client-based and network-based mobility, and sharing the same\n\
    \       protocol is a significant benefit.\n   3.  Reduction of Air-Link Resource\
    \ Consumption\n       Mobility-related signaling over the air-link is eliminated.\n\
    \   4.  Support for Heterogeneous Wireless Link Technologies\n       Since Proxy\
    \ Mobile IPv4 is based on an access, technology-\n       independent, mobility\
    \ protocol, it can be used for any type of\n       access network.\n       From\
    \ the network perspective, a mobile device is identified by\n       the Network\
    \ Access Identifier (NAI) and the forwarding is set up\n       between the PMA\
    \ and HA for the mobile device's current point of\n       attachment on the network.\
    \  The mobile device may be attached to\n       multiple networks concurrently,\
    \ although the network treats each\n       access interface independently.  This\
    \ feature can be supported\n       with the use of the PMIPv4 Access Technology\
    \ Type Extension\n       (Section 5.5).\n   5.  Support for IPv4 and IPv6 Hosts\n\
    \       As IPv6 increases in popularity, the host will likely be dual\n      \
    \ stack.  Adding IPv6 support to the host for Proxy Mobile IPv4\n       involves\
    \ the methods defined in [RFC5454].  There are additional\n       enhancements\
    \ needed, which are described in \"Proxy Mobile IPv6\"\n       [RFC5213].  However,\
    \ support for an IPv6 host is out of the scope\n       of this document.\n"
- title: 4.  Overview of Proxy Mobile IPv4
  contents:
  - '4.  Overview of Proxy Mobile IPv4

    '
- title: 4.1.  Mobility Signaling for Mobile Device
  contents:
  - "4.1.  Mobility Signaling for Mobile Device\n   After the mobile device completes\
    \ network-access authentication, the\n   PMA exchanges Proxy Mobile IPv4 registration\
    \ messages with the HA to\n   set up proper routing and tunneling of packets from/to\
    \ the Mobile\n   Node.  The PMIPv4 client is responsible for initiating the Proxy\n\
    \   Mobile IPv4 registration.  For integrated PMA, the PMIPv4 client and\n   the\
    \ FA interaction is all within the node.  In the case of split PMA\n   implementation,\
    \ the interactions between the PMIPv4 client and the FA\n   are exposed.  The\
    \ interface between the PMIP Client and the FA in the\n   split PMA scenario is\
    \ defined in a standards organization\n   specification [NWG] and is consequently\
    \ out of the scope of this\n   document.\n   The following call flows describe\
    \ the operations of Proxy Mobile\n   IPv4.  The initial network attachment, registration\
    \ renewal, and\n   resource cleanup procedures are covered.  Note that the protocols\n\
    \   that interact with Proxy Mobile IP are identified and explained in\n   more\
    \ detail.  The PPP/IPCP (IP Control Protocol) protocol involves a\n   PPP client\
    \ in the mobile device and a Network Access Server (NAS) in\n   the AR.  DHCP\
    \ involves a DHCP client in the MN and a DHCP server in\n   either the AR or the\
    \ HA.  PMIPv4 involves a PMA in the AR and an HA\n   in the router on the home\
    \ network.  The Authentication,\n   Authorization, and Accounting (AAA) protocol\
    \ involves a AAA client in\n   the AR and a AAA server in the network.  The collocation\
    \ of the\n   functional entities in the AR/HA enables parameters to be\n   shared/processed\
    \ among the protocols.\n   When the various network entities are not collocated,\
    \ any sharing of\n   parameters or other state information between them is out\
    \ of the\n   scope of this document.\n"
- title: 4.1.1.  Proxy Registration during Initial Network Attachment
  contents:
  - "4.1.1.  Proxy Registration during Initial Network Attachment\n              \
    \  +----+        +-------+      +-------+      +-----+\n                |    |\
    \        | AR /  |      |       |      |     |\n                | MN |       \
    \ | PMA   |      |  AAA  |      |  HA |\n                |    |        |     \
    \  |      |       |      |     |\n                +----+        +-------+    \
    \  +-------+      +-----+\n                   |               |             |\
    \             |\n                   |     1a        |     1b      |          \
    \   |\n   Authentication  |<------------->|<----------->|             |\n    \
    \               |               |             |             |\n              \
    \     |     2         |             |             |\n              +->  |-------------->|\
    \             |             |\n              |    |               |       3  \
    \   |             |\n              |    |               |-------------------------->|\
    \ <-+\n   Address    |    |               |             |             |   |PMIP\n\
    \   Acquisition|    |               |       4     |             |   |\n      \
    \        |    |               |<--------------------------| <-+\n            \
    \  |    |     5         |             |             |\n              +->  |<--------------|\
    \             |             |\n                   |               |          \
    \   |             |\n                   |     6         |             |      \
    \       |\n   Data Forwarding |<------------->|<=========================>|\n\
    \                   |               |             |             |\n          \
    \          Figure 1: Network Connection Setup\n   The initial network-attachment\
    \ procedure is described below.  There\n   are three distinct phases.  First,\
    \ authentication and authorization\n   happen when the mobile device accesses\
    \ the network.  Then, the mobile\n   device attempts to obtain an IP address.\
    \  This triggers Proxy Mobile\n   IP, which assigns/authorizes the IP address\
    \ and sets up forwarding\n   between the PMA and HA.  The host configuration parameters\
    \ may be\n   passed in the PMIPv4 signaling.  Finally, the mobile device\n   configures\
    \ its IP stack with the IP address and the obtained host\n   configuration.  Packets\
    \ to and from the mobile device transit both\n   the PMA and HA.\n   1a.  The\
    \ mobile device establishes a L2 (Layer 2) link with the base\n        station\
    \ (not shown) and performs access\n        authentication/authorization with the\
    \ AR (Access Router).\n        During this phase, the mobile device may run either\
    \ the\n        Challenge Handshake Authentication Protocol (CHAP) [RFC1994] if\n\
    \        PPP [RFC1661] is used or the Extensible Authentication Protocol\n   \
    \     (EAP) [RFC3748] over foo (foo being the specific access\n        technology,\
    \ or PANA [RFC4058]).  The AR acts as the NAS (Network\n        Access Server)\
    \ in this step.\n   1b.  The AAA client exchanges AAA messages with the AAA\n\
    \        infrastructure to perform authentication and authorization of\n     \
    \   the mobile device.  As part of this step, the AAA server may\n        download\
    \ some information about the mobile device (e.g., the\n        user's profile,\
    \ handset type, assigned Home Agent address, and\n        other capabilities of\
    \ the mobile device).\n   2.   The mobile device requests an IP address via a\
    \ PPP/IPCP\n        [RFC1332] or DHCP [RFC2131].  Specifically for PPP, the PPP\n\
    \        client sends an IPCP Configure-Request to the NAS.  As for DHCP,\n  \
    \      the DHCP client sends the DHCP Discover message to the DHCP\n        relay\
    \ agent/ server.\n        For the DHCP case, the DHCP server or DHCP relay agent\
    \ sends the\n        DHCP Ack message to the DHCP client after PMIPv4 signaling\
    \ has\n        completed.\n   3.   Triggered by step 2, the PMA sends a Proxy\
    \ Registration Request\n        (PRRQ) to the HA.  The HA's IP address is either\
    \ obtained from\n        the AAA server at step 1b or discovered by some other\
    \ method.\n        The PRRQ contains the Care-of Address (CoA) of the PMA (the\n\
    \        collocated FA in this case).  The Home Address field is set to\n    \
    \    zero or the IP address is specified as a hint in the DHCP or\n        IPCP\
    \ message.  The PRRQ MUST be protected by the methods\n        described in the\
    \ Security Considerations (Section 13) of this\n        document.  The derivation\
    \ and distribution of the MN-HA or FA-HA\n        key is outside the scope of\
    \ this document.\n   4.   The Home Agent sets up the mobility binding entry for\
    \ the mobile\n        device after assigning an IP address or authorizing the\n\
    \        requested Home Address.  The Home Agent may also assign a\n        Generic\
    \ Routing Encapsulation (GRE) key in this step (if GRE\n        tunneling is used\
    \ between the PMA and HA).  The HA returns the\n        Home Address and the GRE\
    \ key (if applicable) in the Proxy\n        Registration Reply (PRRP) to the PMA.\
    \  If the requested Home\n        Address is not authorized, the Home Agent denies\
    \ the\n        registration with error code 129 (administratively prohibited).\n\
    \        After the PMA processes the PRRP, the forwarding path for the\n     \
    \   Home Address between the PMA and HA is established.  A GRE\n        tunnel\
    \ may be used between the PMA and the HA [MIP4GREKEY].\n        This event completes\
    \ the Proxy Mobile IPv4 signaling for initial\n        network attachment.\n \
    \  5.   After the Proxy Mobile IPv4 registration exchange, the AR\n        provides\
    \ the IP address to the mobile device in response to step\n        2.  For IPCP,\
    \ the NAS replies to the PPP client with an IPCP\n        Configure-Nak, which\
    \ includes the PMIPv4-assigned Home Address\n        in the IP address configuration\
    \ option and the DNS server\n        address in the IPCP configuration option.\n\
    \        The following procedure happens when the DHCP server is on the\n    \
    \    AR.  The DHCP server sends a DHCP Offer with the PMIPv4-assigned\n      \
    \  Home Address in the yiaddr field to the DHCP client.  The DHCP\n        client\
    \ sends a DHCP Request to the DHCP server, which replies\n        with a DHCP\
    \ Ack.  The host configuration (such as the DNS server\n        address) is included\
    \ in the DHCP options in the message.  Note\n        that the DHCP messages are\
    \ exchanged directly between the DHCP\n        client and the DHCP server.\n \
    \       In the case when AR acts as a DHCP relay agent, the DHCP\n        Discover\
    \ is relayed to the DHCP server on the HA.  The DHCP\n        server sends a DHCP\
    \ Offer with the PMIPv4-assigned Home Address\n        in the yiaddr field to\
    \ the DHCP relay agent, which forwards it\n        to the DHCP client.  The DHCP\
    \ Request and DHCP Ack messages are\n        exchanged between the DHCP client\
    \ and DHCP server via the DHCP\n        relay agent.  Regardless of the sequence\
    \ of PMIPv4 signaling and\n        DHCP exchanges, the interaction between PMIPv4\
    \ and DHCP involves\n        in the same IP address for Home Address field and\
    \ yiaddr field,\n        respectively.\n   6.   At this step, the mobile device's\
    \ IP stack is configured with an\n        IP address that has a forwarding path\
    \ between the AR/PMA and HA.\n        Also, the host configuration (such as DNS\
    \ servers) is configured\n        at this time.  Now that the IPCP or DHCP procedure\
    \ has\n        completed, the mobile device is ready to receive or send IP\n \
    \       packets.  If DHCP is used, the DHCP client renews the IP address\n   \
    \     by sending a DHCP Request directly to the DHCP server.  The\n        lease\
    \ for the IP address is extended when a DHCP Ack from the\n        DHCP server\
    \ is received by the DHCP client.\n"
- title: 4.1.2.  Proxy Registration Renewal
  contents:
  - "4.1.2.  Proxy Registration Renewal\n                    +----+        +-------+\
    \                  +-----+\n                    |    |        | AR /  |      \
    \            |     |\n                    | MN |        | PMA   |            \
    \      |  HA |\n                    |    |        |       |                  |\
    \     |\n                    +----+        +-------+                  +-----+\n\
    \                       |               |                        |\n         \
    \              |               |       1                |\n                  \
    \     |               |----------------------->|\n     PMIPv4            |   \
    \            |                        |\n     Renewal           |            \
    \   |       2                |\n                       |               |<-----------------------|\n\
    \                       |               |                        |\n         \
    \              |               |                        |\n                 Figure\
    \ 2: Network Connection Maintenance\n   The network-connection maintenance procedure\
    \ is described below.  As\n   long as the mobile device remains attached to the\
    \ AR, the Proxy\n   Mobile IPv4 session is maintained by re-registration exchanges\n\
    \   between the AR and HA.\n   1.  Before the PMIPv4 registration lifetime expires,\
    \ and assuming the\n       AR has not received any indication that the mobile\
    \ device\n       detached from the network, the PMA sends a PRRQ to the HA to\n\
    \       extend the duration of the mobility binding of the mobile device.\n  \
    \     This PRRQ is similar to the initial PRRQ (i.e., HA field set to\n      \
    \ the assigned HA, and CoA field set to the PMA), though the Home\n       Address\
    \ field is always set to the assigned IP address of the\n       mobile device.\
    \  The mobile device's IP stack can continue to send\n       and receive IP packets\
    \ using the Home Address anchored at the HA.\n   2.  The HA sends the PRRP in\
    \ response to the PRRQ received from the\n       PMA.  After the PMA processes\
    \ the PRRP, the forwarding path\n       between AR and HA remains intact.\n"
- title: 4.1.3.  Proxy Handover Support
  contents:
  - "4.1.3.  Proxy Handover Support\n                    +----+        +-------+ \
    \     +-------+      +-----+\n                    |    |        | New   |    \
    \  |  Old  |      |     |\n                    | MN |        | AR /  |      |\
    \  AR / |      |  HA |\n                    |    |        | PMA   |      |  PMA\
    \  |      |     |\n                    +----+        +-------+      +-------+\
    \      +-----+\n                       |               |             |       \
    \      |\n                       |     1         |             |             |\n\
    \     Authentication    |<------------->|             |             |\n      \
    \                 |               |             |             |\n            \
    \           |               |       2     |             |\n                  +->\
    \  |               |-------------------------->|\n     PMIPv4       |    |   \
    \            |             |             |\n                  |    |         \
    \      |       3     |             |\n                  +->  |               |<--------------------------|\n\
    \                       |               |             |             |\n      \
    \                 |     4         |             |             |\n     Data Forwarding\
    \   |<------------->|<=========================>|\n                       |  \
    \             |             |             |\n                           Figure\
    \ 3: AR Handover\n   The AR handover procedure is described below.  There are\
    \ three\n   phases.  First, authentication and authorization happen when the\n\
    \   mobile device attaches to the new AR in the network.  The successful\n   authentication\
    \ triggers the Proxy Mobile IPv4 signaling.  In the last\n   phase, the forwarding\
    \ path between the new AR and HA is set up for\n   the mobile device to send and\
    \ receive IP packets using the same Home\n   Address anchored at the HA.\n   1.\
    \  The mobile device establishes L2 link with the base station (not\n       shown)\
    \ and performs access authentication/authorization with the\n       new AR, using\
    \ the security method for network re-attachment.\n   2.  Triggered by successful\
    \ authentication, the PMA sends a PRRQ to\n       the HA.  The HA's IP address\
    \ is typically obtained or is known by\n       the method used for fast re-authentication\
    \ during AR handover\n       (e.g., context transfer between the two ARs), though\
    \ other\n       methods may be used.  The PRRQ contains the CoA of the new PMA.\n\
    \       The Home Address field is set to zero or the assigned IP address\n   \
    \    of the mobile device.  The IP address is also obtained/known by\n       the\
    \ same method mentioned before.\n   3.  The Home Agent updates the existing mobility\
    \ binding entry for\n       the mobile device upon processing the PRRQ.  The Home\
    \ Agent\n       returns the Home Address, fetched from the binding, in the PRRP\n\
    \       to the new PMA.  After the PMA processes the PRRP, the forwarding\n  \
    \     path for the Home Address between the new AR and HA is\n       established.\
    \  The event completes the Proxy Mobile IPv4 signaling\n       for AR handover.\n\
    \   4.  At this step, which happens around the same time as step 2, the\n    \
    \   mobile device's IP stack may detect L2 link going down and up\n       after\
    \ access re-authentication.  The mobile device's IP stack may\n       attempt\
    \ to validate its IP address connectivity.  See Sections\n       6.1, 6.2, and\
    \ 6.3 of this document for considerations on ARP\n       [RFCARP], ICMP [RFCICMP],\
    \ and DHCP [RFC2131], respectively.\n       Because the forwarding path is established\
    \ between the new PMA\n       and HA, the mobile device can receive or send IP\
    \ packets using\n       the Home Address.\n"
- title: 4.1.4.  Resource Cleanup
  contents:
  - "4.1.4.  Resource Cleanup\n                    +----+        +-------+      +-------+\
    \      +-----+\n                    |    |        | New   |      |  Old  |   \
    \   |     |\n                    | MN |        | AR /  |      |  AR / |      |\
    \  HA |\n                    |    |        | PMA   |      |  PMA  |      |   \
    \  |\n                    +----+        +-------+      +-------+      +-----+\n\
    \                       |               |             |             |\n      \
    \                 |               |             |      1      |\n            \
    \      +->  |               |             |<------------|\n                  |\
    \    |               |             |             |\n     Revocation   |    | \
    \              |             o 2           |\n                  |    |       \
    \        |             |             |\n                  |    |             \
    \  |             |      3      |\n                  +->  |               |   \
    \          |------------>|\n                       |               |         \
    \    |             |\n            Figure 4: Registration Revocation for Previous\
    \ PMA\n   The resource cleanup procedure for the old AR is described below.\n\
    \   This cleanup is necessary when the old AR needs to delete its PMIPv4\n   and\
    \ other associated states for a mobile device that has moved to\n   another AR.\
    \  Therefore, this is an optional procedure for Proxy\n   Mobile IP.  The alternative\
    \ method is based on the new PMA notifying\n   the old PMA to clean up resources.\
    \  The alternative method is out of\n   the scope of this document.\n   1.  Triggered\
    \ by the update of the mobility binding entry for a\n       mobile device that\
    \ has moved to a new AR, the HA may send a\n       Registration Revocation (as\
    \ specified in RFC 3543 [RFC3543]) to\n       the old PMA (i.e., specifically\
    \ to the Foreign Agent entity) in\n       order to clean up unused resources in\
    \ an expeditious manner.\n   2.  The old PMA removes the PMIPv4 states for the\
    \ mobile device.\n   3.  The old PMA sends revocation acknowledgement to the HA.\n"
- title: 4.2.  Establishment of a Bi-Directional Tunnel
  contents:
  - "4.2.  Establishment of a Bi-Directional Tunnel\n   The PMA and HA set up a tunnel\
    \ between them for the Home Address\n   after the PMIPv4 registration message\
    \ exchange.\n"
- title: 4.2.1.  Packet Forwarding
  contents:
  - "4.2.1.  Packet Forwarding\n   The bi-directional tunnel between the PMA and the\
    \ HA allows packets\n   to flow in both directions, while the mobile device is\
    \ connected on\n   the visited network.  All traffic to and from the mobile device\n\
    \   travels through this tunnel.\n   While the PMA is serving a mobile device,\
    \ it MUST be able to\n   intercept all packets sent from the mobile device and\
    \ forward them\n   out the tunnel created for supporting that mobile device. \
    \ Typically,\n   forwarding is based on layer 2 information such as the source\
    \ Media\n   Access Control (MAC) address or ingress interface.  This allows\n\
    \   overlapping IP addresses to be supported for the packet from the\n   mobile\
    \ device.  For example, the PMA forwards packets from mobile\n   devices with\
    \ the same IP address to the tunnel associated with each\n   mobile device, based\
    \ on the source MAC address.\n   The PMA de-encapsulates any packets received\
    \ on the tunnel from the\n   HA before forwarding to the mobile device on its\
    \ link.  Typically,\n   the forwarding is based on the destination IP address\
    \ and ingress HA\n   tunnel (which may have a GRE key).  This allows overlapping\
    \ IP\n   addresses to be supported for the packet destined to the mobile\n   device.\
    \  For example, the PMA forwards packets to mobile devices with\n   the same IP\
    \ address to the link associated with each mobile device,\n   based on the GRE\
    \ key value of the tunnel created for the HA that\n   serves these mobile devices.\n\
    \   The tunnel operation between the PMA and HA is the same as between\n   the\
    \ FA and HA in RFC 3344.  The IP TTL (Time to Live), fragmentation,\n   re-assembly,\
    \ etc. logic remain the same.  The tunnel mode is IPinIP\n   by default or GRE\
    \ as an option.\n"
- title: 4.2.2.  Broadcast and Multicast
  contents:
  - "4.2.2.  Broadcast and Multicast\n   Broadcast packet processing for DHCP and\
    \ ARP (Address Resolution\n   Protocol) messages are described in Section 6.3\
    \ and Section 6.1,\n   respectively.  For other types of broadcast packets, the\
    \ PMA and HA\n   process them in accordance to [RFC3344], [RFC3024], and [MIP4MCBC].\n\
    \   Only the Direct Encapsulation Delivery Style is supported, as there\n   is\
    \ no encapsulation for the packets between the mobile device and\n   PMA.\n"
- title: 4.2.3.  Forwarding between Devices on the Same PMA
  contents:
  - "4.2.3.  Forwarding between Devices on the Same PMA\n   When the communication\
    \ peers are both attached to the same PMA, the\n   packet is forwarded as specified\
    \ in Section 4.2.1.  The traffic\n   between them should be routed via the HA\
    \ without taking a local\n   shortcut on the PMA.  This ensures that data-traffic\
    \ enforcement at\n   the HA is not bypassed.\n"
- title: 4.3.  Security Association between the PMA and the HA
  contents:
  - "4.3.  Security Association between the PMA and the HA\n   The security relationship\
    \ for protecting the control message\n   exchanges between the PMA and the HA\
    \ may be either per node (i.e.,\n   same security association for all mobile devices)\
    \ or per MN (i.e.,\n   unique security association per mobile device).  The method\
    \ of\n   obtaining the security association is outside the scope of this\n   document.\n\
    \   For per-node SA support, the FA-HA Authentication extension or IPsec\n   (indicated\
    \ in the PMIPv4 extension) is used to authenticate the\n   signaling messages\
    \ (including Registration Revocation [RFC3543])\n   between PMA and HA.  In the\
    \ case of IPsec, Encapsulating Security\n   Payload (ESP) [RFC4303] in transport\
    \ mode with mandatory integrity\n   protection should be used.  The IPsec endpoints\
    \ are the IP addresses\n   of the PMA and HA.\n   For per-MN SA support, the MN-HA\
    \ Authentication extension and/or MN-\n   AAA Authentication extension are used\
    \ to authenticate the signaling.\n   The creation of the security association\
    \ may be assisted by the AAA\n   server at the time of access authentication.\n"
- title: 4.4.  Registration Sequencing
  contents:
  - "4.4.  Registration Sequencing\n   The Identification field in the registration\
    \ message provides replay\n   protection and sequencing when the timestamp method\
    \ is used.  This\n   mechanism allows the HA to know the sequence of messages\
    \ from the\n   same PMA or different PMAs based on the Identification field. \
    \ The HA\n   can also synchronize the PMA's clock by using the Identification\n\
    \   mismatch error code in the Proxy Registration Reply.  This reply\n   message\
    \ would not be necessary when the PMA's clocks are synchronized\n   using the\
    \ Network Time Protocol [RFC1305] or some other method.  Note\n   that the use\
    \ of nonce for sequencing and replay protection is outside\n   the scope of this\
    \ document.\n   The method above is sufficient when there is a single source for\n\
    \   signaling as in the split PMA case.  However, in the integrated PMA\n   case,\
    \ the Proxy Registration Request is sent from different sources\n   (i.e., different\
    \ PMAs).  If the previous PMA is unaware that the\n   mobile device has moved\
    \ away and continues to send re-registration,\n   then the HA would be misinformed\
    \ on the location of the device.\n   Therefore, an integrated PMA MUST confirm\
    \ that the mobile device is\n   still attached before sending a Proxy Registration\
    \ Request.\n   Note that, for the split PMA model as used in WiMAX Forum (see\n\
    \   Section 10), the PMIPv4 client remains anchored during handover (see\n   Section\
    \ 10.1).  In this case, the PMIPv4 client is the only source of\n   the PRRQ.\
    \  However, there are cases (such as PMIPv4 client relocation\n   and uncontrolled\
    \ handover events) when more than one PMA performs\n   registration.  The same\
    \ method for the integrated PMA is used to\n   ensure proper sequencing of registration\
    \ on the HA.\n"
- title: 4.5.  Mobile Device Interface Configuration
  contents:
  - "4.5.  Mobile Device Interface Configuration\n   Typically, the mobile device's\
    \ interface needs to be configured with\n   an IP address, network prefix, default\
    \ gateway, and DNS server\n   addresses before the network connection can be enabled\
    \ to be used for\n   communication.  For some IP stacks, the default gateway IP\
    \ address\n   has to be on the same subnet as the mobile device's IP address.\
    \  When\n   the Home Agent's IP address is not on the same subnet as the Home\n\
    \   Address, vendor-specific extensions (e.g., [RFC4332]) or other\n   methods\
    \ MAY be used by the PMA to obtain the default gateway.\n"
- title: 4.6.  Dynamic HA Discovery
  contents:
  - "4.6.  Dynamic HA Discovery\n   The PMA can perform dynamic HA discovery by sending\
    \ the registration\n   with Home Agent field set to 0.0.0.0 or 255.255.255.255.\
    \  The Home\n   Agent responds with its IP address in the Home Agent field as\n\
    \   specified in \"Mobile IPv4 Dynamic Home Agent (HA) Assignment\"\n   [RFC4433].\n"
- title: 5.  Proxy Mobile IPv4 Extensions
  contents:
  - "5.  Proxy Mobile IPv4 Extensions\n   The following PMIPv4 extensions are not\
    \ required for base\n   functionality but may be used in some cases where such\
    \ features are\n   applicable.  They are included before the authentication extension\n\
    \   (e.g., MN-HA or FA-HA Authentication extension) in the registration\n   message.\n"
- title: 5.1.  PMIPv4 Per-Node Authentication Method Extension
  contents:
  - "5.1.  PMIPv4 Per-Node Authentication Method Extension\n   The Proxy Mobile IPv4\
    \ Authentication Method extension indicates\n   alternative methods for authenticating\
    \ the registration besides the\n   default MN-HA Authentication extension as specified\
    \ in RFC 3344.\n   This extension MUST be included in the Registration Request\
    \ and\n   Registration Reply when the security association for authenticating\n\
    \   the message is between the PMA and HA on a per-node basis.  This\n   means\
    \ that a common key or set of keys (indexed by the SPI) are used\n   for message\
    \ authentication by the PMA and HA.  The key is independent\n   of the mobile\
    \ device, which is identified in the registration.\n      0               1  \
    \             2               3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |   Sub-Type    |             Length            |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \  Method     |\n     +-+-+-+-+-+-+-+-+\n              PMIPv4 Per-Node Authentication\
    \ Method Extension\n      Type\n         47 (Proxy Mobile IPv4 Non-Skippable Extension)\n\
    \      Sub-Type\n         1 (PMIPv4 Per-Node Authentication Method)\n      Length\n\
    \         1\n      Method\n         An 8-bit field that specifies the authentication\
    \ type for\n         protecting the signaling messages.\n         The values (0\
    \ - 255) are allocated and managed by IANA.  The\n         following values have\
    \ been assigned to the specified method\n         types.\n         0: Reserved\n\
    \         1: FA-HA Authentication\n         2: IPsec Authentication\n"
- title: 5.2.  Proxy Mobile IPv4 Interface ID Extension
  contents:
  - "5.2.  Proxy Mobile IPv4 Interface ID Extension\n   The Proxy Mobile IPv4 Interface\
    \ ID extension identifies the interface\n   address of the device used to attach\
    \ to the network.  The information\n   MAY be included in the Registration Request\
    \ when the PMA is aware of\n   it.\n     0               1               2   \
    \            3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |     Type      |   Length      | Sub-Type      | Identifier ...\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                       PMIPv4 Interface ID Extension\n      Type\n         147\
    \ (Proxy Mobile IPv4 Skippable Extension)\n      Length\n         The length of\
    \ the extension in octets, excluding Type and\n         Length fields.\n     \
    \ Sub-Type\n         1 (PMIPv4 Interface ID)\n      Identifier\n         A variable-length\
    \ octet sequence that contains an identifier of\n         the interface.\n"
- title: 5.3.  Proxy Mobile IPv4 Device ID Extension
  contents:
  - "5.3.  Proxy Mobile IPv4 Device ID Extension\n   The Proxy Mobile IPv4 Device\
    \ ID extension identifies the device used\n   to connect to the network.  The\
    \ information MAY be included in the\n   Registration Request when the PMA is\
    \ aware of it.\n     0               1               2               3\n     0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |     Type      |   Length      | Sub-Type      |    ID-Type    |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           Identifier ...\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                        PMIPv4 Device ID Extension\n      Type\n         147\
    \ (Proxy Mobile IPv4 Skippable Extension)\n      Length\n         The length of\
    \ the extension in octets, excluding Type and\n         Length fields.\n     \
    \ Sub-Type\n         2 (PMIPv4 Device ID)\n      ID-Type\n         An 8-bit field\
    \ that specifies the device ID type.\n         The values (0 - 255) are allocated\
    \ and managed by IANA.  The\n         following values have been assigned to the\
    \ specified device ID\n         types.\n         0: Reserved\n         1: Ethernet\
    \ MAC address\n         2: Mobile Equipment Identifier (MEID)\n         3: International\
    \ Mobile Equipment Identity (IMEI)\n         4: Electronic Serial Number (ESN)\n\
    \      Identifier\n         A variable-length octet sequence that contains an\
    \ identifier of\n         the type indicated by the ID-Type field.\n"
- title: 5.4.  Proxy Mobile IPv4 Subscriber ID Extension
  contents:
  - "5.4.  Proxy Mobile IPv4 Subscriber ID Extension\n   The Proxy Mobile IPv4 Subscriber\
    \ ID extension identifies the mobile\n   subscription.  The information MAY be\
    \ included in the Registration\n   Request when the PMA is aware of it.\n    \
    \ 0               1               2               3\n     0 1 2 3 4 5 6 7 8 9\
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |     Type      |   Length      | Sub-Type      |    ID-Type    |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                           Identifier ...\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                      PMIPv4 Subscriber ID Extension\n      Type\n         147\
    \ (Proxy Mobile IPv4 Skippable Extension)\n      Length\n         The length of\
    \ the extension in octets, excluding Type and\n         Length fields.\n     \
    \ Sub-Type\n         3 (PMIPv4 Subscriber ID)\n      ID-Type\n         An 8-bit\
    \ field that specifies the subscriber ID type.\n         The values (0 - 255)\
    \ are allocated and managed by IANA.  The\n         following values have been\
    \ assigned to the specified subscriber\n         ID types.\n         0: Reserved\n\
    \         1: International Mobile Subscriber Identity (IMSI)\n      Identifier\n\
    \         A variable-length octet sequence that contains an identifier of\n  \
    \       the type indicated by the ID-Type field.\n"
- title: 5.5.  PMIPv4 Access Technology Type Extension
  contents:
  - "5.5.  PMIPv4 Access Technology Type Extension\n   The Proxy Mobile IPv4 Access\
    \ Technology Type extension indicates the\n   type of radio-access technology\
    \ on which the mobile device is\n   attached.  This extension MAY be included\
    \ in the Registration Request\n   when the PMA is aware of the information.  The\
    \ HA can provide\n   mobility on the same access technology type for a mobile\
    \ device with\n   multiple interfaces, assuming each interface is connected on\
    \ a\n   different access technology type.  The HA does not include the\n   extension\
    \ in the associated Registration Reply.\n     0               1              \
    \ 2               3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |     Type      |   Length      | Sub-Type      |   Tech-Type   |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                  PMIPv4 Access Technology Type Extension\n      Type\n     \
    \    147 (Proxy Mobile IPv4 Skippable Extension)\n      Length\n         2\n \
    \     Sub-Type\n         4 (Access Technology Type)\n      Tech-Type\n       \
    \  An 8-bit field that specifies the access technology through\n         which\
    \ the mobile device is connected to the access network.\n         The values (0\
    \ - 255) are allocated and managed by IANA.  The\n         following values have\
    \ been assigned to the specified access\n         technology types.\n        \
    \ 0: Reserved\n         1: 802.3\n         2: 802.11a/b/g\n         3: 802.16e\n\
    \         4: 802.16m\n         5: 3GPP EUTRAN/LTE\n         6: 3GPP UTRAN/GERAN\n\
    \         7: 3GPP2 1xRTT/HRPD\n         8: 3GPP2 UMB\n"
- title: 6.  Appearance of Being at Home Network
  contents:
  - "6.  Appearance of Being at Home Network\n   Since the Mobile Node is not aware\
    \ of its mobility and does not\n   participate in handover signaling, the network\
    \ entities emulate the\n   home network to the mobile device attached on the network.\
    \  From the\n   mobile device's perspective, it operates as if it were at the\
    \ home\n   network.  However, the network is directing the mobile device's\n \
    \  traffic to and from its current location and will continue to do so\n   when\
    \ it moves to a new location.\n   An unmodified mobile device on a shared link\
    \ learns the MAC address\n   of another host on the home network via ARP ([RFCARP]),\
    \ obtains an IP\n   address and other host configuration via DHCP ([RFC2131]),\
    \ and sends\n   link-local multicast and broadcast packets.  The network's response\n\
    \   to the host is equivalent to the situation when a host is on the home\n  \
    \ network.  When the link state changes, some hosts use ARP, ICMP,\n   and/or\
    \ DHCP to detect if it has changed the point of attachment on\n   the network.\n"
- title: 6.1.  ARP Considerations
  contents:
  - "6.1.  ARP Considerations\n   For IEEE 802 type of access networks (e.g., WLAN,\
    \ WiMAX Ethernet\n   Convergence Sublayer), the mobile device sends ARP requests\
    \ for the\n   Corresponding Node (CN) and default gateway on the same network.\
    \  The\n   purpose of maintaining an ARP entry is to allow the delivery of the\n\
    \   packet from the mobile device to the CN using the destination MAC\n   address.\
    \  The ARP procedure for resolving IP and MAC address mapping\n   is not needed\
    \ for 3GPP2's cdma2000 and WiMAX IP Convergence Sublayer\n   networks.\n   The\
    \ access router is always the L2 endpoint for the mobile device.\n   The destination\
    \ MAC address in the packet does not need to be set to\n   the CN's MAC address.\
    \  As long as the packet can be received by the\n   access router, it will be\
    \ forwarded toward the CN via the home\n   network node (further details in Section\
    \ 4.2.1).  The ARP table in\n   the mobile device does not need to be populated\
    \ with CNs' MAC\n   addresses in order for the packet to reach the CNs.\n   A\
    \ mobile device has ARP entries for the default gateway and hosts on\n   the same\
    \ subnet.  Regardless of what the MAC addresses are, the AR\n   receives the packets\
    \ sent from the mobile device.\n"
- title: 6.2.  ICMP Considerations
  contents:
  - "6.2.  ICMP Considerations\n   For movement detection, certain types of network\
    \ stack on the mobile\n   device will send an ICMP request [RFCICMP] to the default\
    \ gateway\n   after detecting the link went down and up.  The IP TTL in the message\n\
    \   is set to 1 to check if the default gateway is still directly\n   reachable\
    \ on the access network.  The PMA MAY send an ICMP reply when\n   it is providing\
    \ Proxy Mobile IPv4 service for the mobile device.\n   This response confirms\
    \ to the mobile device that it has remained on\n   the home network after link\
    \ state change.  This behavior is observed\n   on existing client implementation.\
    \  \"Detecting Network Attachment in\n   IPv4 (DNAv4)\" [RFC4436] can be employed.\n\
    \   General ICMP traffic is handled as normal IP packets and tunneled\n   between\
    \ the PMA and HA.\n"
- title: 6.3.  DHCP Considerations
  contents:
  - "6.3.  DHCP Considerations\n   DHCP [RFC2131] is used to obtain an IP address\
    \ and other host\n   configuration parameters for a mobile device.  The mobile\
    \ device is\n   expected to behave as a normal DHCP client when connected to the\n\
    \   network with Proxy Mobile IPv4 service.  There are two DHCP phases:\n   bootup\
    \ and renewal/release.  The bootup procedure relies on the DHCP\n   relay agent\
    \ to obtain a lease on the IP address for the DHCP client\n   from the DHCP server.\
    \  The DHCP client directly renews and releases\n   the lease with the DHCP server.\n\
    \   In Proxy Mobile IPv4, the mobile device boots up on a network that is\n  \
    \ not the home network associated with the leased IP address.  Also,\n   the mobile\
    \ device can move to other networks that are not related to\n   that IP address.\
    \  Yet, the DHCP client on the mobile device continues\n   to operate as a stationary\
    \ device that is directly on the network\n   associated with its IP address. \
    \ The PMA and HA create the\n   transparency of the remote home network and mobility\
    \ events by\n   providing the expected network response to the DHCP client.\n\
    \   There are several methods for the network infrastructure to interface\n  \
    \ with the mobile device such that the mobile device believes it is\n   always\
    \ fixed on the same network.  The following methods are\n   identified here, though\
    \ others may be used as well.\n   DHCP Server in the AR:\n      The mobile device\
    \ boots up and initiates DHCP.  The procedure is\n      described in Figure 1.\
    \  The DHCP client renews or releases the IP\n      address directly with the\
    \ DHCP server in the AR.  When the mobile\n      device is on a different AR than\
    \ the AR/DHCP server, the DHCP\n      message from the client needs to be able\
    \ to either be forwarded to\n      the DHCP server in the previous AR or handled\
    \ by the DHCP server\n      in the new AR.  When the DHCP lease time expires for\
    \ the mobile\n      device's IP address or the DHCP release message is received\
    \ on the\n      current AR, the AR sends PMIPv4 de-registration to the HA.\n \
    \  DHCP Relay Agent in the AR:\n      The mobile device boots up and initiates\
    \ DHCP.  The procedure is\n      described in Figure 1.  The DHCP client renews\
    \ or releases the IP\n      address directly with the DHCP server in the HA. \
    \ When the mobile\n      device is on a different AR, DHCP messages from the client\
    \ are\n      relayed to the DHCP server in the HA.  When the DHCP lease time\n\
    \      expires for the mobile device's IP address or the DHCP release\n      message\
    \ is received on the HA, the HA deletes the mobility binding\n      entry for\
    \ the mobile device and sends registration revocation\n      [RFC3543] to the\
    \ AR.\n"
- title: 6.4.  PPP IPCP Considerations
  contents:
  - "6.4.  PPP IPCP Considerations\n   When the mobile device accesses the network\
    \ via PPP [RFC1661], LCP\n   (Link Control Protocol) CHAP is used to authenticate\
    \ the user.  After\n   authentication, the NAS (which is the AR/PMA) sends the\
    \ Proxy Mobile\n   IPv4 Registration Request to the HA.  The HA responds with\
    \ the Home\n   Address in the Proxy Registration Reply.  The NAS informs the mobile\n\
    \   device to use the Home Address during IPCP [RFC1332].  When the\n   mobile\
    \ device moves to a new NAS, the same procedure happens and that\n   mobile device\
    \ has the same IP address for communication.\n   The message exchange is illustrated\
    \ in Figure 1.\n"
- title: 6.5.  Link-Local Multicast and Broadcast Considerations
  contents:
  - "6.5.  Link-Local Multicast and Broadcast Considerations\n   Depending on configuration\
    \ policies, the PMA may tunnel all packets\n   destined to Link-Local Multicast\
    \ or Broadcast to the HA.  The HA\n   looks up the hosts that are in the same\
    \ subnet and sends a duplicated\n   packet to each of them.\n"
- title: 7.  Proxy Mobility Agent Operation
  contents:
  - "7.  Proxy Mobility Agent Operation\n   The PMA performs the functions of a Mobile\
    \ Node entity as described\n   in RFC 3344, with the exceptions identified below.\n\
    \   -  No agent discovery (i.e., agent solicitation and advertisement) is\n  \
    \    supported.\n   -  The D-bit (De-encapsulation by MN) in the Registration\
    \ Request is\n      always set to zero.\n   The main responsibility of the PMA\
    \ is to set up and maintain the\n   routing path between itself and the HA for\
    \ a mobile device that is\n   attached on the network.  When it detects a mobile\
    \ device is no\n   longer attached, the routing path is torn down.  It is possible\
    \ that\n   the PMA functions may be split up in implementations such as WiMAX\n\
    \   (Section 10).\n   The PMA needs to know the following information, at a minimum,\
    \ for\n   sending a proxy registration:\n   1.  NAI of the mobile device.\n  \
    \ 2.  MN-HA security association, when per-mobile device security\n       association\
    \ is used.\n   3.  FA-HA Mobility security association or IPsec security association\n\
    \       when per-node security association is used.  Note that these\n       associations\
    \ are specific only between PMA and HA, and are\n       cryptographically unrelated\
    \ to the associations between the MN\n       and other network nodes.\n   4. \
    \ HA Address.\n   This information is typically downloaded from the AAA server\
    \ during\n   access authentication.\n"
- title: 8.  Home Agent Operation
  contents:
  - "8.  Home Agent Operation\n   The Home Agent has the functionality described in\
    \ RFC 3344 [RFC3344].\n   In addition, the following features are introduced by\
    \ Proxy Mobile\n   IPv4:\n   1.  Sequencing between PRRQs from multiple PMAs.\
    \  For the integrated\n       PMA case, there is a period after handover that\
    \ may result in\n       both the new PMA and old PMA sending PRRQs.  It is imperative\n\
    \       that the old PMA confirm that the mobile device is attached\n       before\
    \ sending a PRRQ when the re-registration timer expires.\n       This would ensure\
    \ that the HA only receives registration from the\n       PMA that is serving\
    \ the mobile device.\n   2.  Authentication of PRRQs based on per-node security\
    \ associations\n       (FA-HA AE or IPsec AH/ESP) is applicable in the integrated\
    \ PMA\n       case.  The presence of MN-HA AE or MN-AAA AE in the PRRQ is not\n\
    \       necessary in this case.  Since PMIPv4 is based on signaling\n       between\
    \ the PMA and the HA, the security for the message can be\n       authenticated\
    \ based on the peers' relationship.  The HA can\n       authorize PMIPv4 service\
    \ for the mobile device at the PMA by\n       contacting the AAA server.\n   3.\
    \  The ability to process the Proxy Mobile IPv4 extensions defined\n       in\
    \ this document for enhanced capabilities of PMIPv4.\n"
- title: 8.1.  Processing Proxy Registration Requests
  contents:
  - "8.1.  Processing Proxy Registration Requests\n   When a Proxy Registration Request\
    \ is received, the HA looks up the\n   mobility binding entry indexed by the NAI.\
    \  If the entry exists, HA\n   compares the sequence numbers between the message\
    \ and mobility\n   binding entry (MBE), if present.  If the value in the message\
    \ is zero\n   or greater than or equal to the one in the MBE, HA accepts the\n\
    \   registration.  The HA replies with a sequence number that is one\n   greater\
    \ than the larger value of either the MBE or Proxy Registration\n   Request. \
    \ If the registration is denied, then HA sends error code\n   \"Administratively\
    \ prohibited (65)\".  If the HA is not enabled with\n   Proxy Mobile IPv4 or cannot\
    \ process the Proxy Mobile IPv4 Extensions\n   defined in this document, it sends\
    \ a Registration Reply with error\n   code PMIP_UNSUPPORTED (\"Proxy Registration\
    \ not supported by the HA\").\n   In the case when the PMA is not allowed to send\
    \ a Proxy Registration\n   Request to the HA, the HA sends a Proxy Registration\
    \ Reply with error\n   code PMIP_DISALLOWED (\"Proxy Registrations from this PMA\
    \ are not\n   allowed\").\n   A PMA receiving these error codes SHOULD NOT retry\
    \ sending Proxy\n   Mobile IPv4 messages to the HA that sent replies with these\
    \ error\n   codes.\n"
- title: 9.  Mobile Device Operation
  contents:
  - "9.  Mobile Device Operation\n   As per this specification, a mobile device would\
    \ function as a normal\n   IPv4 host.  The required behavior of the node will\
    \ be consistent with\n   the base IPv4 specification [RFC0791].  The mobile station\
    \ will have\n   the ability to retain its IPv4 address as it moves from one point\
    \ of\n   network attachment to the other without ever requiring it to\n   participate\
    \ in any mobility-related signaling.\n   When booting up for the first time, a\
    \ mobile device obtains an IPv4\n   address using DHCP or IPCP.\n   As the mobile\
    \ device roams, it is always able to communicate using\n   the obtained IP address\
    \ on the home network.  The PMA on the\n   currently attached network signals\
    \ to the HA to ensure a proper\n   forwarding path for the mobile device's traffic.\n"
- title: 9.1.  Initial Network Access
  contents:
  - "9.1.  Initial Network Access\n   When the mobile device accesses the network\
    \ for the first time and\n   attaches to a network on the PMA, it will present\
    \ its identity in the\n   form of an NAI to the network as part of the network-access\n\
    \   authentication process.\n   Once the address configuration is complete, the\
    \ mobile device will\n   always be able to use that IP address anywhere in the\
    \ network.\n"
- title: 9.2.  Mobile Device Mobility
  contents:
  - "9.2.  Mobile Device Mobility\n   When a mobile device moves to a new PMA from\
    \ another PMA, the\n   following occurs:\n   The mobile device may perform a network-access\
    \ authentication with\n   the new AR/PMA.  If the authentication fails, the mobile\
    \ device will\n   not be able to use the link.  After a successful authentication,\
    \ the\n   new PMA will have the identifier and the other profile data of the\n\
    \   mobile device.  The new PMA can also obtain the mobile device's\n   information\
    \ using a context-transfer mechanism, which is out of the\n   scope of this document.\n\
    \   Once the network-access authentication process is complete, the\n   mobile\
    \ device may sense a change in the Link Layer and use ARP, DHCP,\n   and/or ICMP\
    \ to detect if it is still on the same subnet.  These\n   mechanisms are handled\
    \ by the network as described in \"Appearance of\n   Being At Home Network\" (Section\
    \ 6).\n"
- title: 9.3.  Sending and Receiving Packets
  contents:
  - "9.3.  Sending and Receiving Packets\n   All packets that are to be sent from\
    \ the mobile device to the\n   Corresponding Node (CN) will be sent as normal\
    \ IPv4 packets, setting\n   the Source Address of the IPv4 header to the Home\
    \ Address and the\n   Destination Address to the Corresponding Node's IP address.\
    \  In Proxy\n   Mobile IPv4 operation, the default gateway for the mobile device\
    \ is\n   set up to reach the PMA.\n   Similarly, all packets sent to the mobile\
    \ device's IP address by the\n   Corresponding Node will be received by the mobile\
    \ device in the\n   original form (without any tunneling overhead).\n   For Proxy\
    \ Mobile IP, the packet from the mobile device is transported\n   to the HA to\
    \ reach the destination, regardless of the destination IP\n   address.  For a\
    \ CN with an IP address on the same network as the\n   mobile device but that\
    \ is physically located elsewhere, the HA will\n   tunnel the packet to the CN.\
    \  Otherwise, the HA forwards the traffic\n   via normal routing.\n   No special\
    \ operation is required by the mobile device to either send\n   or receive packets.\n\
    \   Mobile devices attached to the same PMA may be using different HAs\n   for\
    \ transporting their traffic.\n"
- title: 10.  Proxy Mobile IPv4 Use Case in WiMAX
  contents:
  - "10.  Proxy Mobile IPv4 Use Case in WiMAX\n   WiMAX Forum Network Working Group\
    \ (NWG) uses the Proxy Mobile IPv4\n   scheme to provide IPv4 connectivity and\
    \ IP mobility.  The relevant\n   specification from WiMAX Forum is [NWG].\n  \
    \ The Proxy Mobile IPv4 protocol is used over NWG reference point 3\n   (R3).\
    \  Most of the Proxy Mobile IPv4 related procedures and\n   requirements are described\
    \ in reference to mobility management over\n   R3.\n   The Proxy Mobile IPv4 use\
    \ case in the WiMAX Forum specification is\n   illustrated in the following diagram:\n\
    \                                            |\n                             \
    \               |            CSN\n                                           \
    \ |\n                                            |\n                     +-------+\
    \              |            +-------+\n                     |       |        \
    \      |            |       |\n                     |AAAV   |--------------|------------|\
    \ AAAH  |\n                     |       |              |            |       |\n\
    \                     |       |              |            |       |\n        \
    \             +-------+              |            +-------+\n                \
    \          |                 |                |\n                          | \
    \                |                |\n                          |             \
    \    |                |\n                  +------------------+      |       \
    \         |\n                  |   +-------+      |      |                |\n\
    \                  |   | NAS   |      |      |                |\n            \
    \      |   | PMIP  | ASN1 |      |                |\n                  |   | Client|\
    \      |      |                |\n                  |   +-------+      |     \
    \ |                |\n                  |       |          |      |          \
    \      |\n                  |       | R4       |      |                |\n   \
    \               |   +-------+      |      |             +------+\n         +----+\
    \   |   | FA,   |      |      |    PMIPv4   |      |\n         | MN |-------|\
    \ DHCP  |---------------------------|  HA  |\n         +----+   |   | Relay/|\
    \      |      |     R3      |      |\n                  |   | Server| ASN2 | \
    \     |             +------+\n                  |   +-------+      |      |\n\
    \                  |                  |      |\n                  +------------------+\n\
    \                     Split PMA\n         Figure 5: WiMAX NWG Network Configuration\
    \ for PMIPv4 Use\n   As shown in the figure above, WiMAX NWG uses the split PMA\
    \ model.\n   The PMIPv4 client is collocated with the NAS in ASN1 (aka,\n   Authenticator\
    \ ASN).  The NWG architecture divides the network into\n   two parts.  The Access\
    \ part is termed the \"Access Service Network\"\n   (ASN).  The Core part is termed\
    \ the \"Connectivity Service Network\"\n   (CSN).  The MN attaches to an 802.16\
    \ radio in the ASN2 (aka, Anchor\n   Data Path Function).  The radio (base station)\
    \ connects to the Anchor\n   Data Path Function (A_DPF) in ASN2, which in turn\
    \ connects to the\n   Authenticator ASN (NAS) in ASN1.  ASN1 authenticates and\
    \ authorizes\n   the MN.  The AAA infrastructure is used to authenticate and authorize\n\
    \   the MN.\n   Note that, during initial network entry by the MN, the PMA can\
    \ be an\n   integrated PMA with all the functions collocated in ASN1.  Due to\n\
    \   mobility, the FA part of the PMA may have to be relocated to a more\n   optimized\
    \ location for better bearer management.  However, to\n   describe the WiMAX specific\
    \ use case for Proxy Mobile IPv4, we will\n   use the split PMA model since it\
    \ is a more generic representation of\n   the WiMAX NWG mobility framework.\n\
    \   The WiMAX NWG specification [NWG] defines a key bootstrapping scheme\n   for\
    \ use with Proxy Mobile IPv4.  The specification uses per-MN\n   security association\
    \ for Proxy Mobile IPv4 operation.  The relevant\n   keys (e.g., MN-HA key) are\
    \ derived using EAP authentication as\n   specified in this document.  For more\
    \ information, please refer to\n   Section 4.3 of [NWG], stage-3 specification.\n\
    \   Mobile IPv4 Registration Revocation is optionally supported in WiMAX.\n  \
    \ The security association for this is per node.  It is provided with\n   FA-HA\
    \ AE.  The FA-HA key is also bootstrapped via the same key\n   hierarchy that\
    \ is described in Section 4.3 of [NWG].\n   The Proxy Mobile IPv4 operation in\
    \ WiMAX NWG is aligned with the\n   basic Proxy Mobile IPv4 operation as described\
    \ in Section 4 of this\n   document.  There are specific considerations for WiMAX\
    \ NWG 1.0.0 use\n   of Proxy Mobile IPv4.  These are listed below:\n   1.  Use\
    \ of per-MS SA for Proxy Mobile IPv4 registration.  In this\n       case, MN-HA\
    \ AE is used.\n   2.  Use of split PMA to handle FA relocation while the PMIPv4\
    \ client\n       remains anchored with the NAS (Authenticator ASN).\n   3.  Only\
    \ the Proxy Mobile IPv4 Access Technology Type extension\n       defined in this\
    \ document is used in the NWG specification [NWG].\n   4.  GRE key identifier\
    \ is optionally used between the HA and the PMA.\n   5.  The PMIPv4 client and\
    \ the FA interact via the WiMAX specific\n       reference point and protocol\
    \ (aka, R4).  For more information,\n       please refer to the NWG specification\
    \ [NWG].\n   6.  In order to handle inter-ASN (inter Access Router) handover and\n\
    \       still allow the MN to use the same DHCP server's IP address that\n   \
    \    was sent in DHCPOFFER/ACK, the DHCP server (aka, proxy) functions\n     \
    \  in the ASN are required to be configured with the same IP\n       address.\n\
    \   7.  The MN - AR (trigger for Proxy Mobile IPv4) interaction is based\n   \
    \    on DHCP.  DHCPDISCOVER from the MN triggers the Proxy Mobile IPv4\n     \
    \  process in the ASN.\n"
- title: 10.1.  Proxy Mobile IPv4 Call Flow Examples with Split PMA in WiMAX
  contents:
  - "10.1.  Proxy Mobile IPv4 Call Flow Examples with Split PMA in WiMAX\n   Since\
    \ WiMAX uses the split PMA model, the call flows involve WiMAX\n   proprietary\
    \ signaling between the PMIPv4 client and FA within the\n   PMA.  The following\
    \ call flows illustrate this.\n                     Split PMA\n              \
    \       +-----------------------------------+\n            +----+   | +------+\
    \     +------+     +-----+ |    +-----+\n            |    |   | | NAS/ |     |\
    \  Old |     | New | |    |     |\n            | MN |   | | PMIP |     |  FA \
    \ |     |  FA | |    | HA  |\n            |    |   | |Client|     |      |   \
    \  |     | |    |     |\n            +----+   | +------+     +------+     +-----+\
    \ |    +-----+\n               |     +----|------------|------------|----+   \
    \    |\n               |          |            |       PMIP Tunnel       |\n \
    \              |          |            |<=======================>|\n         \
    \      |          |            |            |            |\n               | \
    \         |            |  R4 tunnel |            |\n               |         \
    \ |            |<==========>|            |\n               |          |      \
    \ 1    |            |            |\n               |<---------------------------------->|\
    \            |\n               |          |            |            |        \
    \    |\n               |          |            |     2      |            |\n \
    \              |          |            |<---------->|            |\n         \
    \      |          |       3    |            |            |\n               | \
    \         |<----------------------- |            |\n               |         \
    \ |            |            |            |\n               |          |      \
    \ 4    |            |            |\n          +->  |          |------------------------>|\
    \            |\n          |    |          |            |            |     5  \
    \    |\n          |    |          |            |            |----------->|\n \
    \         |    |          |            |            |            |\n   PMIP  \
    \ |    |          |            |            |     6      |\n          |    | \
    \         |            |            |<-----------|\n          |    |         \
    \ |            |            |            |\n          |    |          |      \
    \ 7    |            |            |\n          +->  |          |<------------------------|\
    \            |\n               |          |            |            |        \
    \    |\n               |          |            |     8      |            |\n \
    \              |          |            |<---------->|            |\n         \
    \      |          |            |            |            |\n               | \
    \    9    |            |            |PMIP Tunnel |\n   Data        |<---------------------------------->|<==========>|\n\
    \   Forwarding  |          |            |            |            |\n        Figure\
    \ 6: Proxy Handover Operation in WiMAX with Split PMA\n   In this scenario, the\
    \ MN has moved to a new FA's area (known as the\n   Data Path Function in WiMAX).\
    \  The old FA and the new FA interact\n   with each other and also with the PMIPv4\
    \ client over a WiMAX-\n   specified R4 reference point to perform the handover.\
    \  The steps are\n   described below:\n   1.  The mobile device establishes a\
    \ L2 link with a base station (not\n       shown), which connects to a new FA\
    \ (aka, new Data Path Function\n       in WiMAX).  Note that, in this case, the\
    \ MN does not perform\n       authentication and authorization.  The PMIPv4 tunnel\
    \ remains\n       between the old FA (aka, old Data Path Function in WiMAX). \
    \ The\n       data flows through the PMIPv4 tunnel between the HA and the old\n\
    \       FA, and through the WiMAX-specific R4 tunnel between the old FA\n    \
    \   and the new FA and from the new FA to the MN.\n   2.  The new FA interacts\
    \ with the old FA using a WiMAX-specific R4\n       reference point to initiate\
    \ the handover process.\n   3.  The new FA uses the WiMAX-specific R4 reference\
    \ point to request\n       the PMIPv4 client to begin the PMIPv4 handover.\n \
    \  4.  Triggered by step 3, the PMIPv4 client sends a PRRQ to the new\n      \
    \ FA.  The PRRQ contains the FA-CoA of the new FA.  The Home\n       Address field\
    \ is set to the address of the assigned IP address of\n       the Mobile Node.\
    \  The PRRQ is embedded in the WiMAX-specific R4\n       packet.\n   5.  The new\
    \ FA forwards the PRRQ to the HA.\n   6.  The Home Agent updates the existing\
    \ mobility binding entry for\n       the mobile device upon processing the PRRQ.\
    \  The Home Agent\n       responds back to the new FA with PRRP.\n   7.  The new\
    \ FA forwards the PRRP after encapsulating it in a WiMAX-\n       specific R4\
    \ packet to the PMIPv4 client.\n   8.  The new FA and the old FA exchange WiMAX-specific\
    \ R4 messages\n       between them to confirm the handover.  The old FA cleans\
    \ up its\n       resources for the MN.  The R4 bearer forwarding also stops at\n\
    \       this point.\n   9.  The forward and reverse direction traffic flows via\
    \ the new FA.\n       The handover is complete at this point.\n"
- title: 11.  Proxy Mobile IPv4 Use Case in 3GPP2
  contents:
  - "11.  Proxy Mobile IPv4 Use Case in 3GPP2\n   3GPP2 uses the Proxy Mobile IPv4\
    \ scheme to provide mobility service\n   for the following scenarios (as shown\
    \ in the figures below):\n   1.  Mobility between the base station (BS) and access\
    \ gateway (AGW)\n   2.  Mobility between the AGW and the Home Agent (HA).\n  \
    \ As shown in the diagrams below, in use case 1, the BS acts as the PMA\n   and\
    \ the AGW acts as the HA for Proxy Mobile IPv4 operation.  In use\n   case 2,\
    \ the AGW acts as the PMA while the HA assumes the role of the\n   Home Agent.\n\
    \                     RAN                            Core\n                  +-------+\
    \                       +------+\n      +----+      | BS/   |             PMIPv4\
    \    |      |\n      | MN |------| PMA   |-----------------------| AGW/ |\n  \
    \    +----+      |       |                       |  HA  |\n                  |\
    \       |                       +------+\n                  +-------+\n      \
    \          Integrated PMA\n      Figure 7: 3GPP2's PMIPv4 Use Case 1 - BS-AGW\
    \ Interface Mobility\n                     RAN                            Core\n\
    \                  +-------+                       +------+\n      +----+    \
    \  | AGW/  |             PMIPv4    |      |\n      | MN |------| PMA   |-----------------------|\
    \  HA  |\n      +----+      |       |                       |      |\n       \
    \           |       |                       +------+\n                  +-------+\n\
    \                Integrated PMA\n      Figure 8: 3GPP2's PMIPv4 Use Case 2 - AGW-HA\
    \ Interface Mobility\n   The figure below shows a simplified 3GPP2 architecture.\
    \  For details,\n   please refer to the 3GPP2 Converged Access Network (CAN) architecture\n\
    \   ([3GPP2]).\n                           RAN                    Core\n     \
    \            -----------^------------   -------^-------------\n              \
    \  |                        | |                     |\n                V     \
    \                   V V                     V\n                  +------+    \
    \        +------+           +-----+\n      +----+      |      |  PMIPv4    | \
    \     |  PMIPv4   |     |\n      | MN |------| BS   |------------| AGW  |-----------|\
    \ HA  |\n      +----+      |      |            |      |           |     |\n  \
    \                +------+            +------+           +-----+\n            \
    \      Figure 9: Simplified 3GPP2 Architecture\n   The Proxy Mobile IPv4 usage\
    \ scenario in 3GPP2 (case 1) is illustrated\n   in the following diagram:\n  \
    \       +----+        +-------+      +-------+   +------+\n         |    |   \
    \     |       |      |       |   |      |\n         | MN |        |  BS/  |  \
    \    | HAAA  |   | AGW/ |\n         |    |        |  PMA  |      |       |   |\
    \ HA   |\n         +----+        +-------+      +-------+   +------+\n       \
    \    |               |             |          |\n           |     1a        |\
    \     1b      |          |\n           |<------------->|<----------->|       \
    \   |\n           |               |             |          |\n           |   \
    \  2         |             |          |\n           |-------------->|        \
    \     |          |\n           |               |       3     |          |\n  \
    \         |               |----------------------->|\n           |           \
    \    |             |          |\n           |               |       4     |  \
    \        |\n           |               |<-----------------------|\n          \
    \ |     5         |             |          |\n           |<--------------|   \
    \          |          |\n           |               |             |          |\n\
    \           |     6         |             |          |\n           |<======================================>|\n\
    \           |               |             |          |\n             Figure 10:\
    \ Network Connection Setup (use case 1)\n   Description of the steps:\n   1a.\
    \  MN performs layer 2 establishment with the BS/PMA and performs\n        access\
    \ authentication/authorization.  During this phase, the MN\n        runs EAP over\
    \ Ultra Mobile Broadband (UMB).  The BS acts as the\n        NAS in this phase.\n\
    \   1b.  The BS exchanges AAA messages with the Home AAA server via the\n    \
    \    AR (not shown in the figure) to authenticate the MN.  As part of\n      \
    \  this step, the AR may download some information about the MN\n        (e.g.,\
    \ user's profile, handset type, assigned Home Agent\n        address, and other\
    \ capabilities of the MN).  This information is\n        passed to the PMA/BS\
    \ (as necessary) to set up the PMIPv4 tunnel\n        in the next step(s).\n \
    \  2.   The MN sends layer 2 signaling messages to the BS/PMA to trigger\n   \
    \     the PMIPv4 tunnel setup process.\n   3.   Triggered by step 2, the PMA/BS\
    \ sends a PRRQ to the AGW/HA.  The\n        HA's address is either received at\
    \ step 1b from the Home AAA\n        server (HAAA) or is discovered by other means.\
    \  The PRRQ\n        contains the Care-of Address (CoA) of the PMA (collocated\
    \ FA in\n        this case).  The HoA field is set to all zeros (or all ones).\n\
    \        The PRRQ is protected by the method described in this document.\n   \
    \     The derivation and distribution of the MN-HA or FA-HA key is\n        outside\
    \ the scope of this document.\n   4.   The AGW/HA registers the MN's session,\
    \ assigns a symmetric GRE\n        key, and returns this key in the PRRP to the\
    \ BS/PMA.\n   5.   The BS/PMA responds back to the MN with a layer 2 signaling\n\
    \        message.\n   6.   At this step, the MN is assigned an IP address and\
    \ is connected\n        to the network (via the AGW).\n   In use case 2, the same\
    \ procedures are followed except the PMIPv4\n   tunnel is established between\
    \ the AGW and the HA.  In this case, GRE\n   tunneling may not be used.\n"
- title: 11.1.  Handover Considerations in 3GPP2
  contents:
  - "11.1.  Handover Considerations in 3GPP2\n   There are some special handover considerations\
    \ in 3GPP2's Proxy\n   Mobile IPv4 use case.  Below is an illustration of the\
    \ specific use\n   case:\n      +----+        +-------+      +-------+   +-------+\n\
    \      |    |        |       |      |       |   |       |\n      | MN |      \
    \  | New   |      |  AGW/ |   | Old   |\n      |    |        | PMA/BS|      |\
    \  HA   |   | PMA/BS|\n      +----+        +-------+      +-------+   +-------+\n\
    \        |               |              |          |\n        |              \
    \ |      1       |          |\n        |               |------------->|      \
    \    |\n        |               |              |          |\n        |       \
    \        |              |          |\n        |               |              o\
    \ 2        |\n        |               |              |          |\n        | \
    \              |              |          |\n        |               |      3 \
    \      |          |\n        |               |<-------------|          |\n   \
    \     |               |              |          |\n        |               | \
    \             |          |\n        |               |         4    |         \
    \ |\n        |               |<----------------------->|\n        |          \
    \     |              |          |\n        |               |              |  \
    \        |\n        |               |              |          o  5\n        |\
    \               |              |          |\n        |               |       \
    \       |          |\n         Figure 11: 3GPP2 Registration Revocation for Previous\
    \ PMA\n   Description of the steps:\n   1.  MN attaches to the new BS (L2 gets\
    \ established).  There is an\n       ongoing mobility binding entry (MBE) in the\
    \ AGW for the MN.  The\n       PMA in the new BS sends a PRRQ to the AGW.\n  \
    \ 2.  The AGW receives a Proxy Registration Request for a Mobile Node\n      \
    \ and detects that it has an existing Mobility Binding Entry (MBE).\n       The\
    \ AGW validates the PRRQ from the new BS and updates the MBE\n       for the MN.\
    \  The MBE is kept tentative at this point.\n   3.  The AGW sends a Proxy Registration\
    \ Reply to the new BS.  No\n       Registration Revocation is used in the 3GPP2's\
    \ use case.\n   4.  A 3GPP2's proprietary PMA movement notification message may\
    \ be\n       exchanged between the AGW and the old BS.\n   5.  The MBE update\
    \ with the new BS is committed at this step.\n"
- title: 12.  IANA Considerations
  contents:
  - "12.  IANA Considerations\n   This specification registers 47 for the Proxy Mobile\
    \ IPv4\n   Non-Skippable Extension and 147 for Proxy Mobile IPv4 Skippable\n \
    \  Extension, both of which are described in Section 5.  The ranges for\n   Mobile\
    \ IPv4 [RFC3344] extension types are defined at\n   http://www.iana.org.  This\
    \ specification also creates a new subtype\n   space for the type number of the\
    \ extensions.  The subtype value 1 is\n   defined for the PMIPv4 Non-Skippable\
    \ Extension.  The subtype values 1\n   to 4 are defined for the PMIPv4 Skippable\
    \ Extension.  Similar to the\n   procedures specified for Mobile IPv4 number spaces,\
    \ future\n   allocations from the number space require expert review [RFC5226].\n\
    \   The PMIPv4 Per-Node Authentication Method extension defined in\n   Section\
    \ 5.1 of this document, introduces a new authentication method\n   numbering space,\
    \ where the values from 0 to 2 have been assigned per\n   this document.  Approval\
    \ of new Access Technology type values are to\n   be made through IANA Expert\
    \ Review.\n   The PMIPv4 Device ID extension defined in Section 5.3 of this\n\
    \   document, introduces a new ID type numbering space, where the values\n   from\
    \ 0 to 4 have been assigned per this document.  Approval of new\n   Access Technology\
    \ type values are to be made through IANA Expert\n   Review.\n   The PMIPv4 Subscriber\
    \ ID extension defined in Section 5.4 of this\n   document, introduces a new ID\
    \ type numbering space, where the values\n   from 0 to 1 have been reserved by\
    \ this document.  Approval of new\n   Access Technology type values are to be\
    \ made through IANA Expert\n   Review.\n   The PMIPv4 Access Technology Type extension\
    \ defined in Section 5.5 of\n   this document, introduces a new technology type\
    \ numbering space,\n   where the values from 0 to 8 have been reserved by this\
    \ document.\n   Approval of new Access Technology type values are to be made through\n\
    \   IANA Expert Review.\n"
- title: 12.1.  Mobile IPv4 Extension Types
  contents:
  - "12.1.  Mobile IPv4 Extension Types\n   This document introduces the following\
    \ Mobile IP extension types.\n   Name       : Proxy Mobile IPv4 Non-Skippable\
    \ Extension\n   Type Value : 47\n   Section    : 5\n   Name       : Proxy Mobile\
    \ IPv4 Skippable Extension\n   Type Value : 147\n   Section    : 5\n"
- title: 12.2.  Mobile IPv4 Error Codes
  contents:
  - "12.2.  Mobile IPv4 Error Codes\n   This document introduces the following error\
    \ code that can be\n   returned by the HA in a Proxy Registration Reply.\n   Name\
    \                    Value    First referenced\n   ----                    -----\
    \    ----------------\n   PMIP_UNSUPPORTED         149     Section 8.1 of RFC\
    \ 5563\n   PMIP_DISALLOWED          150     Section 8.1 of RFC 5563\n"
- title: 13.  Security Considerations
  contents:
  - "13.  Security Considerations\n   The functionality in this document is protected\
    \ by the authentication\n   extensions described in RFC 3344 [RFC3344] or IPsec\
    \ [RFC4301].  Each\n   PMA needs to have an security association (e.g., MN-HA,\
    \ FA-HA, IPsec\n   AH/ESP) with the HA to register the MN's IP address.  The security\n\
    \   association can be provisioned by the administrator or dynamically\n   derived.\
    \  The dynamic key derivation and distribution for this scheme\n   is outside\
    \ the scope of this document.\n"
- title: 14.  Acknowledgements
  contents:
  - "14.  Acknowledgements\n   The authors would like to thank the following individuals\
    \ for their\n   review, comments, and suggestions to improve the content of this\n\
    \   document.\n   Shahab Sayeedi (Motorola), Alper Yegin (Samsung), Premec Domagoj\n\
    \   (Siemens), Michael Hammer (Cisco), Jun Wang (Qualcomm), Jayshree\n   Bharatia\
    \ (Nortel), Semyon Mizikovsky (Alcatel-Lucent), Federico De\n   Juan Huarte (Alcatel-Lucent),\
    \ Paula Tjandra (Motorola), Alice Qinxia\n   (Huawei), Howie Koh (Greenpacket),\
    \ John Zhao (Huawei), Pete McCann\n   (Motorola), and Sri Gundavelli (Cisco).\n"
- title: 15.  References
  contents:
  - '15.  References

    '
- title: 15.1.  Normative References
  contents:
  - "15.1.  Normative References\n   [3GPP2]      \"3GPP2 Basic IP Service for Converged\
    \ Access Network\",\n                X.S0054-100-0 Version 2.0, August 2008.\n\
    \   [NWG]        \"WiMAX Forum Network Architecture (Stage 3: Detailed\n     \
    \           Protocols and Procedures)\" Release 1, Version 1.2.3,\n          \
    \      July 2008.\n   [RFC2119]    Bradner, S., \"Key words for use in RFCs to\
    \ Indicate\n                Requirement Levels\", BCP 14, RFC 2119, March 1997.\n\
    \   [RFC2131]    Droms, R., \"Dynamic Host Configuration Protocol\", RFC\n   \
    \             2131, March 1997.\n   [RFC3024]    Montenegro, G., Ed., \"Reverse\
    \ Tunneling for Mobile IP,\n                revised\", RFC 3024, January 2001.\n\
    \   [RFC3344]    Perkins, C., Ed., \"IP Mobility Support for IPv4\", RFC\n   \
    \             3344, August 2002.\n   [RFC3543]    Glass, S. and M. Chandra, \"\
    Registration Revocation in\n                Mobile IPv4\", RFC 3543, August 2003.\n"
- title: 15.2.  Informative References
  contents:
  - "15.2.  Informative References\n   [MIP4GREKEY] Yegani, P., \"GRE Key Extension\
    \ for Mobile IPv4\", Work in\n                Progress, June 2007.\n   [MIP4MCBC]\
    \   Chakrabarti, S., \"IPv4 Mobility extension for Multicast\n               \
    \ and Broadcast Packets\", Work in Progress, November 2007.\n   [RFC0791]    Postel,\
    \ J., \"Internet Protocol\", STD 5, RFC 791,\n                September 1981.\n\
    \   [RFC1305]    Mills, D., \"Network Time Protocol (Version 3)\n            \
    \    Specification, Implementation and Analysis\", RFC 1305,\n               \
    \ March 1992.\n   [RFC1332]    McGregor, G., \"The PPP Internet Protocol Control\n\
    \                Protocol (IPCP)\", RFC 1332, May 1992.\n   [RFC1661]    Simpson,\
    \ W., Ed., \"The Point-to-Point Protocol (PPP)\",\n                STD 51, RFC\
    \ 1661, July 1994.\n   [RFC1994]    Simpson, W., \"PPP Challenge Handshake Authentication\n\
    \                Protocol (CHAP)\", RFC 1994, August 1996.\n   [RFC3748]    Aboba,\
    \ B., Blunk, L., Vollbrecht, J., Carlson, J., and\n                H. Levkowetz,\
    \ Ed., \"Extensible Authentication Protocol\n                (EAP)\", RFC 3748,\
    \ June 2004.\n   [RFC4058]    Yegin, A., Ed., Ohba, Y., Penno, R., Tsirtsis, G.,\
    \ and\n                C. Wang, \"Protocol for Carrying Authentication for\n \
    \               Network Access (PANA) Requirements\", RFC 4058, May 2005.\n  \
    \ [RFC4301]    Kent, S. and K. Seo, \"Security Architecture for the\n        \
    \        Internet Protocol\", RFC 4301, December 2005.\n   [RFC4303]    Kent,\
    \ S., \"IP Encapsulating Security Payload (ESP)\", RFC\n                4303,\
    \ December 2005.\n   [RFC4332]    Leung, K., Patel, A., Tsirtsis, G., and E. Klovning,\n\
    \                \"Cisco's Mobile IPv4 Host Configuration Extensions\", RFC\n\
    \                4332, December 2005.\n   [RFC4433]    Kulkarni, M., Patel, A.,\
    \ and K. Leung, \"Mobile IPv4\n                Dynamic Home Agent (HA) Assignment\"\
    , RFC 4433, March\n                2006.\n   [RFC4436]    Aboba, B., Carlson,\
    \ J., and S. Cheshire, \"Detecting\n                Network Attachment in IPv4\
    \ (DNAv4)\", RFC 4436, March\n                2006.\n   [RFC5213]    Gundavelli,\
    \ S., Ed., Leung, K., Devarapalli, V.,\n                Chowdhury, K., and B.\
    \ Patil, \"Proxy Mobile IPv6\", RFC\n                5213, August 2008.\n   [RFC5226]\
    \    Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n             \
    \   IANA Considerations Section in RFCs\", BCP 26, RFC 5226,\n               \
    \ May 2008.\n   [RFC5454]    Tsirtsis, G., Park, V., and H. Soliman, \"Dual-Stack\n\
    \                Mobile IPv4\", RFC 5454, March 2009.\n   [RFCARP]     Plummer,\
    \ D., \"Ethernet Address Resolution Protocol: Or\n                Converting Network\
    \ Protocol Addresses to 48.bit Ethernet\n                Address for Transmission\
    \ on Ethernet Hardware\", STD 37,\n                RFC 826, November 1982.\n \
    \  [RFCICMP]    Postel, J., \"Internet Control Message Protocol\", STD 5,\n  \
    \              RFC 792, September 1981.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Kent Leung\n   Cisco Systems\n   170 West Tasman Drive\n\
    \   San Jose, CA  95134\n   US\n   EMail: kleung@cisco.com\n   Gopal Dommety\n\
    \   Cisco Systems\n   170 West Tasman Drive\n   San Jose, CA  95134\n   US\n \
    \  EMail: gdommety@cisco.com\n   Parviz Yegani\n   Juniper Networks\n   1194 North\
    \ Mathilda Ave.\n   Sunnyvale, CA 94089-1206\n   EMail: pyegani@juniper.net\n\
    \   Kuntal Chowdhury\n   Starent Networks\n   30 International Place\n   Tewksbury,\
    \ MA  01876\n   USA\n   EMail: kchowdhury@starentnetworks.com\n"
