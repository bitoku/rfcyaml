- title: __initial_text__
  contents:
  - ''
- title: DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)
  contents:
  - 'DomainKeys Identified Mail (DKIM) Author Domain Signing Practices (ADSP)

    '
- title: Abstract
  contents:
  - "Abstract\n   DomainKeys Identified Mail (DKIM) defines a domain-level\n   authentication\
    \ framework for email to permit verification of the\n   source and contents of\
    \ messages.  This document specifies an adjunct\n   mechanism to aid in assessing\
    \ messages that do not contain a DKIM\n   signature for the domain used in the\
    \ author's address.  It defines a\n   record that can advertise whether a domain\
    \ signs its outgoing mail as\n   well as how other hosts can access that record.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Language and Terminology ........................................3\n  \
    \    2.1. Terms Imported from the DKIM Signatures Specification ......3\n    \
    \  2.2. Valid Signature ............................................4\n      2.3.\
    \ Author Address .............................................4\n      2.4. Author\
    \ Domain ..............................................4\n      2.5. Alleged Author\
    \ .............................................4\n      2.6. Author Domain Signing\
    \ Practices ............................4\n      2.7. Author Domain Signature\
    \ ....................................4\n   3. Operation Overview ..............................................5\n\
    \      3.1. ADSP Applicability .........................................5\n  \
    \    3.2. ADSP Usage .................................................6\n    \
    \  3.3. ADSP Results ...............................................6\n   4. Detailed\
    \ Description ............................................7\n      4.1. DNS Representation\
    \ .........................................7\n      4.2. Publication of ADSP Records\
    \ ................................7\n           4.2.1. Record Syntax .......................................7\n\
    \      4.3. ADSP Lookup Procedure ......................................9\n  \
    \ 5. IANA Considerations ............................................10\n    \
    \  5.1. ADSP Specification Tag Registry ...........................10\n      5.2.\
    \ ADSP Outbound Signing Practices Registry ..................11\n      5.3. Authentication-Results\
    \ Method Registry Update .............11\n      5.4. Authentication-Results Result\
    \ Registry Update .............11\n   6. Security Considerations ........................................13\n\
    \      6.1. ADSP Threat Model .........................................14\n  \
    \    6.2. DNS Considerations ........................................14\n    \
    \  6.3. DNS Wildcards .............................................15\n      6.4.\
    \ Inappropriate Application of Author Domain Signatures .....15\n   7. References\
    \ .....................................................16\n      7.1. Normative\
    \ References ......................................16\n      7.2. Informative\
    \ References ....................................16\n   Appendix A.  Lookup Examples\
    \ ......................................17\n     A.1.  Domain and ADSP Exist .....................................17\n\
    \     A.2.  Domain Exists, ADSP Does Not Exist ........................17\n  \
    \   A.3.  Domain Does Not Exist .....................................17\n   Appendix\
    \ B.  Usage Examples .......................................18\n     B.1.  Single\
    \ Location Domains ...................................18\n     B.2.  Bulk Mailing\
    \ Domains ......................................18\n     B.3.  Bulk Mailing Domains\
    \ with Discardable Mail ................19\n     B.4.  Third-Party Senders .....................................19\n\
    \     B.5.  Domains with Independent Users and Liberal Use Policies ...19\n  \
    \   B.6.  Non-Email Domains .......................................20\n   Appendix\
    \ C.  Acknowledgements .....................................20\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   DomainKeys Identified Mail (DKIM) defines a mechanism by\
    \ which email\n   messages can be cryptographically signed, permitting a signing\
    \ domain\n   to claim responsibility for the introduction of a message into the\n\
    \   mail stream.  Message recipients can verify the signature by querying\n  \
    \ the Signer's domain directly to retrieve the appropriate public key,\n   and\
    \ thereby confirm that the message was attested to by a party in\n   possession\
    \ of the private key for the signing domain.\n   However, the legacy of the Internet\
    \ is such that not all messages\n   will be signed, and the absence of a signature\
    \ on a message is not an\n   a priori indication of forgery.  In fact, during\
    \ early phases of\n   deployment, it is very likely that most messages will remain\n\
    \   unsigned.  However, some domains might decide to sign all of their\n   outgoing\
    \ mail, for example, to protect their brand names.  It might\n   be desirable\
    \ for such domains to be able to advertise that fact to\n   other hosts.  This\
    \ is the topic of Author Domain Signing Practices\n   (ADSP).\n   Hosts implementing\
    \ this specification can inquire what Author Domain\n   Signing Practices a domain\
    \ advertises.  This inquiry is called an\n   Author Domain Signing Practices check.\n\
    \   The basic requirements for ADSP are given in [RFC5016].  This\n   document\
    \ refers extensively to [RFC4871] and assumes the reader is\n   familiar with\
    \ it.\n   Requirements Notation:\n      The key words \"MUST\", \"MUST NOT\",\
    \ \"REQUIRED\", \"SHALL\", \"SHALL\n      NOT\", \"SHOULD\", \"SHOULD NOT\", \"\
    RECOMMENDED\", \"MAY\", and \"OPTIONAL\"\n      in this document are to be interpreted\
    \ as described in [RFC2119].\n"
- title: 2.  Language and Terminology
  contents:
  - '2.  Language and Terminology

    '
- title: 2.1.  Terms Imported from the DKIM Signatures Specification
  contents:
  - "2.1.  Terms Imported from the DKIM Signatures Specification\n   Some terminology\
    \ used herein is derived directly from [RFC4871].  In\n   several cases, references\
    \ in that document to \"Sender\" have been\n   changed to \"Author\" here, to\
    \ emphasize the relationship to the Author\n   address(es) in the From: header\
    \ field described in [RFC5322].\n   Briefly,\n   o  A \"Signer\" is the agent\
    \ that signs a message, as defined in\n      Section 2.1 of [RFC4871].\n   o \
    \ A \"Local-part\" is the part of an address preceding the @\n      character,\
    \ as defined in [RFC5322] and used in [RFC4871].\n"
- title: 2.2.  Valid Signature
  contents:
  - "2.2.  Valid Signature\n   A \"Valid Signature\" is any signature on a message\
    \ that correctly\n   verifies using the procedure described in Section 6.1 of\
    \ [RFC4871].\n"
- title: 2.3.  Author Address
  contents:
  - "2.3.  Author Address\n   An \"Author Address\" is an email address in the From:\
    \ header field of\n   a message [RFC5322].  If the From: header field contains\
    \ multiple\n   addresses, the message has multiple Author Addresses.\n"
- title: 2.4.  Author Domain
  contents:
  - "2.4.  Author Domain\n   An \"Author Domain\" is everything to the right of the\
    \ \"@\" in an Author\n   Address (excluding the \"@\" itself).\n"
- title: 2.5.  Alleged Author
  contents:
  - "2.5.  Alleged Author\n   An \"Alleged Author\" is an Author Address of a message;\
    \ it is\n   \"alleged\" because it has not yet been checked.\n"
- title: 2.6.  Author Domain Signing Practices
  contents:
  - "2.6.  Author Domain Signing Practices\n   \"Author Domain Signing Practices\"\
    \ (or just \"practices\") consist of a\n   machine-readable record published by\
    \ the domain of an Alleged Author\n   that includes statements about the domain's\
    \ practices with respect to\n   mail it sends with its domain in the From: line.\n"
- title: 2.7.  Author Domain Signature
  contents:
  - "2.7.  Author Domain Signature\n   An \"Author Domain Signature\" is a Valid Signature\
    \ in which the domain\n   name of the DKIM signing entity, i.e., the d= tag in\
    \ the DKIM-\n   Signature header field, is the same as the domain name in the\
    \ Author\n   Address.  Following [RFC5321], domain name comparisons are case\n\
    \   insensitive.\n   For example, if the From: line address is bob@domain.example,\
    \ and the\n   message has a Valid Signature with the DKIM-Signature header field\n\
    \   containing \"d=domain.example\", then the message has an Author Domain\n \
    \  Signature.\n"
- title: 3.  Operation Overview
  contents:
  - "3.  Operation Overview\n   Domain owners publish ADSP information via a query\
    \ mechanism such as\n   the Domain Name System; specific details are given in\
    \ Section 4.1.\n   Hosts can look up the ADSP information of the domain(s) specified\
    \ by\n   the Author Address(es) as described in Section 4.3.  If a message has\n\
    \   multiple Author Addresses, the ADSP lookups SHOULD be performed\n   independently\
    \ on each address.  This document does not address the\n   process a host might\
    \ use to combine the lookup results.\n"
- title: 3.1.  ADSP Applicability
  contents:
  - "3.1.  ADSP Applicability\n   ADSP as defined in this document is bound to DNS.\
    \  For this reason,\n   ADSP is applicable only to Author Domains with appropriate\
    \ DNS\n   records (i.e., A, AAAA, and/or MX) indicating the possible use of the\n\
    \   domain for email.  The handling of other Author Domains is outside\n   the\
    \ scope of this document.  However, attackers may use such domain\n   names in\
    \ a deliberate attempt to sidestep an organization's ADSP\n   policy statements.\
    \  It is up to the ADSP checker implementation to\n   return an appropriate error\
    \ result for Author Domains outside the\n   scope of ADSP.\n   ADSP applies to\
    \ specific domains, not domain subtrees.  If, for\n   example, an Author Address\
    \ were user@domain.example, the Author\n   Domain would be domain.example, and\
    \ the applicable ADSP record would\n   be at _adsp._domainkey.domain.example.\
    \  An Author Address in a\n   subdomain such as user@sub.domain.example would\
    \ have a different ADSP\n   record at _adsp._domainkey.sub.domain.example.  ADSP\
    \ makes no\n   connection between a domain and its parent or child domains.\n\
    \   Note:   If an organization wants to publish Author Domain Signing\n      \
    \     Practices for all the subdomains it uses, such as host names\n         \
    \  of servers within the domain, it does so by creating ADSP\n           records\
    \ for every _adsp._domainkey.<sub>.domain.example.\n           Wildcards cannot\
    \ be used (see Section 6.3.); however,\n           suitable DNS management tools\
    \ could automate creation of the\n           ADSP records.\n   Note:   The results\
    \ from DNS queries that are intended to validate a\n           domain name unavoidably\
    \ approximate the set of Author Domains\n           that can appear in legitimate\
    \ email.  For example, a DNS A\n           record could belong to a device that\
    \ does not even have an\n           email implementation.  It is up to the checker\
    \ to decide what\n           degree of approximation is acceptable.\n"
- title: 3.2.  ADSP Usage
  contents:
  - "3.2.  ADSP Usage\n   Depending on the Author Domain(s) and the signatures in\
    \ a message, a\n   recipient gets varying amounts of useful information from each\
    \ ADSP\n   lookup.\n   o  If a message has no Valid Signature, the ADSP result\
    \ is directly\n      relevant to the message.\n   o  If a message has an Author\
    \ Domain Signature, ADSP provides no\n      benefit relative to that domain since\
    \ the message is already known\n      to be compliant with any possible ADSP for\
    \ that domain.\n   o  If a message has a Valid Signature other than an Author\
    \ Domain\n      Signature, the receiver can use both the Signature and the ADSP\n\
    \      result in its evaluation of the message.\n"
- title: 3.3.  ADSP Results
  contents:
  - "3.3.  ADSP Results\n   An ADSP lookup for an Author Address produces one of four\
    \ possible\n   results:\n   o  Messages from this domain might or might not have\
    \ an Author Domain\n      Signature.  This is the default if the domain exists\
    \ in the DNS\n      but no ADSP record is found.\n   o  All messages from this\
    \ domain are signed with an Author Domain\n      Signature.\n   o  All messages\
    \ from this domain are signed with an Author Domain\n      Signature and are discardable,\
    \ i.e., if a message arrives without\n      a valid Author Domain Signature, the\
    \ domain encourages the\n      recipient(s) to discard it.\n   o  This domain\
    \ is out of scope, i.e., the domain does not exist in\n      the DNS.\n   An ADSP\
    \ lookup could terminate without producing any result if a DNS\n   lookup results\
    \ in a temporary failure.\n"
- title: 4.  Detailed Description
  contents:
  - '4.  Detailed Description

    '
- title: 4.1.  DNS Representation
  contents:
  - "4.1.  DNS Representation\n   ADSP records are published using the DNS TXT resource\
    \ record type.\n   The RDATA for ADSP resource records is textual in format, with\n\
    \   specific syntax and semantics relating to their role in describing\n   ADSP.\
    \  The \"Tag=Value List\" syntax described in Section 3.2 of\n   [RFC4871] is\
    \ used, modified to use whitespace (WSP) rather than\n   folding whitespace (FWS).\
    \  Records not in compliance with that syntax\n   or the syntax of individual\
    \ tags described in Section 4.3 MUST be\n   ignored (considered equivalent to\
    \ a NODATA result) for purposes of\n   ADSP, although they MAY cause the logging\
    \ of warning messages via an\n   appropriate system logging mechanism.  If the\
    \ RDATA contains multiple\n   character strings, the strings are logically concatenated\
    \ with no\n   delimiters between the strings.\n   Note:   ADSP changes the \"\
    Tag=Value List\" syntax from [RFC4871] to\n           use WSP rather than FWS\
    \ in its DNS records.\n   Domains MUST NOT publish ADSP records with wildcard\
    \ names.  Wildcards\n   within a domain publishing ADSP records pose a particular\
    \ problem, as\n   discussed in more detail in Section 6.3.\n"
- title: 4.2.  Publication of ADSP Records
  contents:
  - "4.2.  Publication of ADSP Records\n   ADSP is intended to apply to all mail sent\
    \ using the domain name\n   string of an Alleged Author.\n"
- title: 4.2.1.  Record Syntax
  contents:
  - "4.2.1.  Record Syntax\n   ADSP records use the \"tag=value\" syntax described\
    \ in Section 3.2 of\n   [RFC4871], modified to use WSP rather than FWS.  Every\
    \ ADSP record\n   MUST start with an outbound signing-practices tag, so the first\
    \ four\n   characters of the record are lowercase \"dkim\", followed by optional\n\
    \   whitespace and \"=\".\n   Tags used in ADSP records are described below. \
    \ Unrecognized tags\n   MUST be ignored.  In the ABNF below, the WSP token is\
    \ imported from\n   [RFC5234].\n   dkim=   Outbound Signing Practices for the\
    \ domain (plain-text;\n           REQUIRED).  Possible values are as follows:\n\
    \           unknown   The domain might sign some or all email.\n           all\
    \       All mail from the domain is signed with an Author\n                  \
    \   Domain Signature.\n           discardable\n                        All mail\
    \ from the domain is signed with an\n                        Author Domain Signature.\
    \  Furthermore, if a\n                        message arrives without a valid\
    \ Author Domain\n                        Signature due to modification in transit,\n\
    \                        submission via a path without access to a\n         \
    \               signing key, or any other reason, the domain\n               \
    \         encourages the recipient(s) to discard it.\n           Any other values\
    \ are treated as \"unknown\".\n   ABNF:\n   ; Copyright (c) 2009 IETF Trust and\
    \ the persons identified as\n   ; authors of the code.  All rights reserved.\n\
    \   ; Redistribution and use in source and binary forms, with or without\n   ;\
    \ modification, are permitted provided that the following conditions\n   ; are\
    \ met:\n   ; - Redistributions of source code must retain the above copyright\n\
    \   ;   notice, this list of conditions and the following disclaimer.\n   ; -\
    \ Redistributions in binary form must reproduce the above copyright\n   ;   notice,\
    \ this list of conditions and the following disclaimer in\n   ;   the documentation\
    \ and/or other materials provided with the\n   ;   distribution.\n   ; - Neither\
    \ the name of Internet Society, IETF or IETF Trust, nor the\n   ;   names of specific\
    \ contributors, may be used to endorse or promote\n   ;   products derived from\
    \ this software without specific prior\n   ;   written permission.\n   ; THIS\
    \ SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n   ; 'AS IS'\
    \ AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n   ; LIMITED TO,\
    \ THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS\n   ; FOR A PARTICULAR\
    \ PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE\n   ; COPYRIGHT OWNER OR CONTRIBUTORS\
    \ BE LIABLE FOR ANY DIRECT,\n   ; INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\
    \ CONSEQUENTIAL DAMAGES\n   ; (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE\
    \ GOODS OR\n   ; SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n\
    \   ;  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n   ; CONTRACT,\
    \ STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR\n   ;  OTHERWISE) ARISING\
    \ IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n   ; EVEN IF ADVISED OF THE POSSIBILITY\
    \ OF SUCH DAMAGE.\n        adsp-dkim-tag = %x64.6b.69.6d *WSP \"=\" *WSP\n   \
    \                     (\"unknown\" / \"all\" / \"discardable\" /\n           \
    \              x-adsp-dkim-tag)\n        x-adsp-dkim-tag = hyphenated-word   ;\
    \ for future extension\n        ; hyphenated-word is defined in RFC 4871\n"
- title: 4.3.  ADSP Lookup Procedure
  contents:
  - "4.3.  ADSP Lookup Procedure\n   Hosts doing an ADSP lookup MUST produce a result\
    \ that is semantically\n   equivalent to applying the following steps in the order\
    \ listed below.\n   In practice, these steps can be performed in parallel in order\
    \ to\n   improve performance.  However, implementations SHOULD avoid doing\n \
    \  unnecessary DNS lookups.\n   For the purposes of this section, a \"valid ADSP\
    \ record\" is one that\n   is both syntactically and semantically correct; in\
    \ particular, it\n   matches the ABNF for a \"tag-list\" and starts with a valid\
    \ \"dkim\" tag.\n   Check Domain Scope:\n      An ADSP checker implementation\
    \ MUST determine whether a given\n      Author Domain is within the scope for\
    \ ADSP.  Given the background\n      in Section 3.1, the checker MUST decide which\
    \ degree of\n      approximation is acceptable.  The checker MUST return an\n\
    \      appropriate error result for Author Domains that are outside the\n    \
    \  scope of ADSP.\n      The host MUST perform a DNS query for a record corresponding\
    \ to\n      the Author Domain (with no prefix).  The type of the query can be\n\
    \      of any type, since this step is only to determine if the domain\n     \
    \ itself exists in DNS.  This query MAY be done in parallel with the\n      query\
    \ to fetch the named ADSP Record.  If the result of this query\n      is that\
    \ the Author Domain does not exist in the DNS (often called\n      an NXDOMAIN\
    \ error, rcode=3 in [RFC1035]), the algorithm MUST\n      terminate with an error\
    \ indicating that the domain is out of\n      scope.  Note that a result with\
    \ rcode=0 but no records (often\n      called NODATA) is not the same as NXDOMAIN.\n\
    \         NON-NORMATIVE DISCUSSION: Any resource record type could be\n      \
    \   used for this query since the existence of a resource record of\n        \
    \ any type will prevent an NXDOMAIN error.  MX is a reasonable\n         choice\
    \ for this purpose because this record type is thought to\n         be the most\
    \ common for domains used in email, and will\n         therefore produce a result\
    \ that can be more readily cached than\n         a negative result.\n      If\
    \ the domain does exist, the checker MAY make more extensive\n      checks to\
    \ verify the existence of the domain, such as the ones\n      described in Section\
    \ 5 of [RFC5321].  If those checks indicate\n      that the Author Domain does\
    \ not exist for mail, e.g., the domain\n      has no MX, A, or AAAA record, the\
    \ checker SHOULD terminate with an\n      error indicating that the domain is\
    \ out of scope.\n   Fetch Named ADSP Record:\n      The host MUST query DNS for\
    \ a TXT record corresponding to the\n      Author Domain prefixed by \"_adsp._domainkey.\"\
    \ (note the trailing\n      dot).\n      If the result of this query is a NOERROR\
    \ response (rcode=0 in\n      [RFC1035]) with an answer that is a single record\
    \ that is a valid\n      ADSP record, use that record, and the algorithm terminates.\n\
    \      If the result of the query is NXDOMAIN or NOERROR with zero\n      records,\
    \ there is no ADSP record.  If the result of the query\n      contains more than\
    \ one record, or a record that is not a valid\n      ADSP record, the ADSP result\
    \ is undefined.\n      If a query results in a \"SERVFAIL\" error response (rcode=2\
    \ in\n      [RFC1035]), the algorithm terminates without returning a result;\n\
    \      possible actions include queuing the message or returning an SMTP\n   \
    \   error indicating a temporary failure.\n   See Appendix A for examples of ADSP\
    \ lookup.\n"
- title: 5.  IANA Considerations
  contents:
  - "5.  IANA Considerations\n   ADSP adds the following namespaces to the IANA registry.\
    \  In all\n   cases, new values are assigned only for values that have been\n\
    \   documented in a published RFC after IETF Review, as specified in\n   [RFC5226].\n"
- title: 5.1.  ADSP Specification Tag Registry
  contents:
  - "5.1.  ADSP Specification Tag Registry\n   An ADSP record provides for a list\
    \ of specification tags.  IANA has\n   established the ADSP Specification Tag\
    \ Registry for specification\n   tags that can be used in ADSP fields.\n   The\
    \ initial entry in the registry is:\n                         +------+-----------------+\n\
    \                         | TYPE | REFERENCE       |\n                       \
    \  +------+-----------------+\n                         | dkim | (RFC 5617)  \
    \    |\n                         +------+-----------------+\n              ADSP\
    \ Specification Tag Registry Initial Values\n"
- title: 5.2.  ADSP Outbound Signing Practices Registry
  contents:
  - "5.2.  ADSP Outbound Signing Practices Registry\n   The \"dkim=\" tag specification,\
    \ defined in Section 4.2.1, provides for\n   a value specifying Outbound Signing\
    \ Practices.  IANA has established\n   the ADSP Outbound Signing Practices Registry\
    \ for Outbound Signing\n   Practices.\n   The initial entries in the registry\
    \ comprise:\n                     +-------------+-----------------+\n        \
    \             | TYPE        | REFERENCE       |\n                     +-------------+-----------------+\n\
    \                     | unknown     | (RFC 5617)      |\n                    \
    \ | all         | (RFC 5617)      |\n                     | discardable | (RFC\
    \ 5617)      |\n                     +-------------+-----------------+\n     \
    \     ADSP Outbound Signing Practices Registry Initial Values\n"
- title: 5.3.  Authentication-Results Method Registry Update
  contents:
  - "5.3.  Authentication-Results Method Registry Update\n   IANA has added the following\
    \ to the Email Authentication Method Name\n   Registry:\n   Method: dkim-adsp\n\
    \   Defined In:  RFC 5617\n   ptype:  header\n   property:  from\n   value:  contents\
    \ of the [RFC5322] From: header field, with comments\n           removed\n"
- title: 5.4.  Authentication-Results Result Registry Update
  contents:
  - "5.4.  Authentication-Results Result Registry Update\n   IANA has added the following\
    \ in the Email Authentication Result Name\n   Registry:\n   Code:     none\n \
    \  Existing/New Code:  existing\n   Defined In:  [RFC5451]\n   Auth Method:  dkim-adsp\
    \ (added)\n   Meaning:  No DKIM Author Domain Signing Practices (ADSP) record\
    \ was\n             published.\n   Code:     pass\n   Existing/New Code:  existing\n\
    \   Defined In:  [RFC5451]\n   Auth Method:  dkim-adsp (added)\n   Meaning:  This\
    \ message had an Author Domain Signature that was\n             validated.  (An\
    \ ADSP check is not strictly required to be\n             performed for this result\
    \ since a valid Author Domain\n             Signature satisfies all possible ADSP\
    \ policies.)\n   Code:     unknown\n   Existing/New Code:  new\n   Defined In:\
    \  RFC 5617\n   Auth Method:  dkim-adsp\n   Meaning:  No valid Author Domain Signature\
    \ was found on the message\n             and the published ADSP was \"unknown\"\
    .\n   Code:     fail\n   Existing/New Code:  existing\n   Defined In:  [RFC5451]\n\
    \   Auth Method:  dkim-adsp (added)\n   Meaning:  No valid Author Domain Signature\
    \ was found on the message\n             and the published ADSP was \"all\".\n\
    \   Code:     discard\n   Existing/New Code:  new\n   Defined In:  RFC 5617\n\
    \   Auth Method:  dkim-adsp\n   Meaning:  No valid Author Domain Signature was\
    \ found on the message\n             and the published ADSP was \"discardable\"\
    .\n   Code:     nxdomain\n   Existing/New Code:  new\n   Defined In:  RFC 5617\n\
    \   Auth Method:  dkim-adsp\n   Meaning:  Evaluating the ADSP for the Author's\
    \ DNS domain indicated\n             that the Author's DNS domain does not exist.\n\
    \   Code:     temperror\n   Existing/New Code:  existing\n   Defined In:  [RFC5451]\n\
    \   Auth Method:  dkim-adsp (added)\n   Meaning:  An ADSP record could not be\
    \ retrieved due to some error\n             that is likely transient in nature,\
    \ such as a temporary DNS\n             error.  A later attempt may produce a\
    \ final result.\n   Code:     permerror\n   Existing/New Code:  existing\n   Defined\
    \ In:  [RFC5451]\n   Auth Method:  dkim-adsp (added)\n   Meaning:  An ADSP record\
    \ could not be retrieved due to some error\n             that is likely not transient\
    \ in nature, such as a permanent\n             DNS error.  A later attempt is\
    \ unlikely to produce a final\n             result.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   Security considerations in the ADSP are mostly\
    \ related to attempts on\n   the part of malicious senders to represent themselves\
    \ as Authors for\n   whom they are not authorized to send mail, often in an attempt\
    \ to\n   defraud either the recipient or an Alleged Author.\n   Additional security\
    \ considerations regarding Author Domain Signing\n   Practices are found in the\
    \ DKIM threat analysis [RFC4686].\n"
- title: 6.1.  ADSP Threat Model
  contents:
  - "6.1.  ADSP Threat Model\n   Email recipients often have a core set of content\
    \ Authors that they\n   already trust.  Common examples include financial institutions\
    \ with\n   which they have an existing relationship and Internet web transaction\n\
    \   sites with which they conduct business.\n   Email abuse often seeks to exploit\
    \ a legitimate email Author's name-\n   recognition among recipients by using\
    \ the Author's domain name in the\n   From: header field.  Especially since many\
    \ popular Mail User Agents\n   (MUAs) do not display the Author's email address,\
    \ there is no\n   empirical evidence of the extent that this particular unauthorized\n\
    \   use of a domain name contributes to recipient deception or that\n   eliminating\
    \ it will have significant effect.\n   However, closing this potential exploit\
    \ could facilitate some types\n   of optimized processing by receive-side message\
    \ filtering engines,\n   since it could permit them to maintain higher-confidence\
    \ assertions\n   about From: header field uses of a domain when the occurrence\
    \ is\n   authorized.\n   Unauthorized uses of domain names occur elsewhere in\
    \ messages, as do\n   unauthorized uses of organizations' names.  These attacks\
    \ are outside\n   the scope of this specification.\n   ADSP does not provide any\
    \ benefit -- nor, indeed, have any effect at\n   all -- unless an external system\
    \ acts upon the verdict, either by\n   treating the message differently during\
    \ the delivery process or by\n   showing some indicator to the end recipient.\
    \  Such a system is out of\n   scope for this specification.\n   ADSP checkers\
    \ may perform multiple DNS lookups per Alleged Author\n   Domain.  Since these\
    \ lookups are driven by domain names in email\n   message headers of possibly\
    \ fraudulent email, legitimate ADSP\n   checkers can become participants in traffic\
    \ multiplication attacks on\n   domains that appear in fraudulent email.\n"
- title: 6.2.  DNS Considerations
  contents:
  - "6.2.  DNS Considerations\n   An attacker might attack the DNS infrastructure\
    \ in an attempt to\n   impersonate ADSP records to influence a receiver's decision\
    \ on how it\n   will handle mail.  However, such an attacker is more likely to\
    \ attack\n   at a higher level, e.g., redirecting A or MX record lookups in order\n\
    \   to capture traffic that was legitimately intended for the target\n   domain.\
    \  These DNS security issues are addressed by DNSSEC [RFC4033].\n   Because ADSP\
    \ operates within the framework of the legacy email\n   system, the default result\
    \ in the absence of an ADSP record is that\n   the domain does not sign all of\
    \ its messages.  It is therefore\n   important that the ADSP clients distinguish\
    \ a DNS failure such as\n   \"SERVFAIL\" from other DNS errors so that appropriate\
    \ actions can be\n   taken.\n"
- title: 6.3.  DNS Wildcards
  contents:
  - "6.3.  DNS Wildcards\n   DNS wildcards (described in [RFC4592]) that exist in\
    \ the DNS\n   hierarchy at or above the domain being checked interfere with the\n\
    \   ability to verify the scope of the ADSP check described in\n   Section 4.3.\
    \  For example, a wildcard record for *.domain.example\n   makes all subdomains\
    \ such as foo.domain.example exist in the DNS.\n   Domains that intend to make\
    \ active use of ADSP by publishing a\n   practice other than unknown are advised\
    \ to avoid the use of wildcards\n   in their hierarchy.\n   If a domain contains\
    \ wildcards, then any name that matches the\n   wildcard can appear to be a valid\
    \ mail domain eligible for ADSP.  But\n   the \"_adsp._domainkey.\" prefix on\
    \ ADSP records does not allow\n   publication of wildcard records that cover ADSP\
    \ records without also\n   covering non-ADSP records, nor does it allow publication\
    \ of wildcard\n   records that cover non-ADSP records without also covering ADSP\n\
    \   records.  A domain that uses ADSP practices other than unknown SHOULD\n  \
    \ NOT publish wildcard records.\n"
- title: 6.4.  Inappropriate Application of Author Domain Signatures
  contents:
  - "6.4.  Inappropriate Application of Author Domain Signatures\n   In one model\
    \ of DKIM usage, a domain signs messages that are in\n   transit through their\
    \ system.  Since any signature whose domain\n   matches the Author Domain is,\
    \ by definition, an Author Domain\n   Signature, it would be unwise to sign mail\
    \ whose Author Domain is the\n   Signer's domain if the mail is not known to meet\
    \ the domain's\n   standards for an Author Domain Signature.\n   One such use\
    \ case is where a domain might apply such a signature\n   following application\
    \ of an Authentication-Results header field as\n   described in Section 7.1 of\
    \ [RFC5451].  This problem can be easily\n   avoided either by not applying a\
    \ signature that might be confused\n   with an Author Domain Signature or by applying\
    \ a signature from some\n   other domain, such as a subdomain of the Author Domain.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC1035]  Mockapetris, P., \"Domain names - implementation\
    \ and\n              specification\", STD 13, RFC 1035, November 1987.\n   [RFC2119]\
    \  Bradner, S., \"Key words for use in RFCs to Indicate\n              Requirement\
    \ Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC4033]  Arends, R., Austein,\
    \ R., Larson, M., Massey, D., and S.\n              Rose, \"DNS Security Introduction\
    \ and Requirements\",\n              RFC 4033, March 2005.\n   [RFC4592]  Lewis,\
    \ E., \"The Role of Wildcards in the Domain Name\n              System\", RFC\
    \ 4592, July 2006.\n   [RFC4871]  Allman, E., Callas, J., Delany, M., Libbey,\
    \ M., Fenton,\n              J., and M. Thomas, \"DomainKeys Identified Mail (DKIM)\n\
    \              Signatures\", RFC 4871, May 2007.\n   [RFC5226]  Narten, T. and\
    \ H. Alvestrand, \"Guidelines for Writing an\n              IANA Considerations\
    \ Section in RFCs\", BCP 26, RFC 5226,\n              May 2008.\n   [RFC5234]\
    \  Crocker, D. and P. Overell, \"Augmented BNF for Syntax\n              Specifications:\
    \ ABNF\", STD 68, RFC 5234, January 2008.\n   [RFC5322]  Resnick, P., Ed., \"\
    Internet Message Format\", RFC 5322,\n              October 2008.\n   [RFC5451]\
    \  Kucherawy, M., \"Message Header Field for Indicating\n              Message\
    \ Authentication Status\", RFC 5451, April 2009.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [RFC4686]  Fenton, J., \"Analysis of Threats\
    \ Motivating DomainKeys\n              Identified Mail (DKIM)\", RFC 4686, September\
    \ 2006.\n   [RFC5016]  Thomas, M., \"Requirements for a DomainKeys Identified\
    \ Mail\n              (DKIM) Signing Practices Protocol\", RFC 5016,\n       \
    \       October 2007.\n   [RFC5321]  Klensin, J., \"Simple Mail Transfer Protocol\"\
    , RFC 5321,\n              October 2008.\n"
- title: Appendix A.  Lookup Examples
  contents:
  - "Appendix A.  Lookup Examples\n   Assume the example domain publishes these DNS\
    \ records (in these\n   examples, the numbers in parentheses are comments to help\
    \ identify\n   the records, not part of the records themselves):\n   aaa.example\
    \                  A     192.0.2.1        (1)\n   _adsp._domainkey.aaa.example\
    \ TXT   \"dkim=all\"       (2)\n   bbb.example                  MX 10 mail.bbb.example\
    \ (3)\n   mail.bbb.example             A     192.0.2.2        (4)\n"
- title: A.1.  Domain and ADSP Exist
  contents:
  - "A.1.  Domain and ADSP Exist\n   A mail message contains this From: header line:\n\
    \   From: bob@aaa.example (Bob the Author)\n   The ADSP lookup first identifies\
    \ the Author Address bob@aaa.example\n   and the Author Domain aaa.example.  It\
    \ does an MX DNS query for\n   aaa.example and gets back a NOERROR result with\
    \ no DNS records.\n   (There's no MX record, but since record (1) exists, the\
    \ name exists\n   in the DNS.)  Since that query didn't return an error, the lookup\n\
    \   proceeds to a TXT DNS query for _adsp._domainkey.aaa.example, which\n   returns\
    \ record (2).  Since this is a valid ADSP record, the result is\n   that all messages\
    \ from this domain are signed.\n"
- title: A.2.  Domain Exists, ADSP Does Not Exist
  contents:
  - "A.2.  Domain Exists, ADSP Does Not Exist\n   A mail message contains this From:\
    \ header line:\n   From: alice@bbb.example (Old-fashioned Alice)\n   The ADSP\
    \ lookup first identifies the Author Address alice@bbb.example\n   and the Author\
    \ Domain bbb.example.  It does an MX DNS query for\n   bbb.example and gets back\
    \ record (3).  Since that query didn't return\n   an error, it then proceeds to\
    \ a TXT DNS query for\n   _adsp._domainkey.bbb.example, which returns NXDOMAIN.\
    \  Since the\n   domain exists but there is no ADSP record, ADSP returns the default\n\
    \   unknown result: messages may or may not have an author domain\n   signature.\n"
- title: A.3.  Domain Does Not Exist
  contents:
  - "A.3.  Domain Does Not Exist\n   A mail message contains this From: header line:\n\
    \   From: frank@ccc.example (Unreliable Frank)\n   The ADSP lookup first identifies\
    \ the Author Address frank@ccc.example\n   and the Author Domain ccc.example.\
    \  It does an MX DNS query for\n   ccc.example and gets back an NXDOMAIN result\
    \ since there are no\n   records at all for ccc.example.  The lookup terminates\
    \ with the\n   result that the domain does not exist in the DNS and so is out\
    \ of\n   scope.\n"
- title: Appendix B.  Usage Examples
  contents:
  - "Appendix B.  Usage Examples\n   These examples are intended to illustrate typical\
    \ uses of ADSP.  They\n   are not intended to be exhaustive or to apply to every\
    \ domain's or\n   mail system's individual situation.\n   Domain managers are\
    \ advised to consider the ways that mail processing\n   can modify messages in\
    \ ways that will invalidate an existing DKIM\n   signature, such as mailing lists,\
    \ courtesy forwarders, and other\n   paths that could add or modify headers, or\
    \ modify the message body.\n   If the modifications invalidate the DKIM signature,\
    \ recipient hosts\n   will consider the mail not to have an Author Domain Signature,\
    \ even\n   though the signature was present when the mail was originally sent.\n"
- title: B.1.  Single Location Domains
  contents:
  - "B.1.  Single Location Domains\n   One common mail system configuration handles\
    \ all of a domain's users'\n   incoming and outgoing mail through a single Mail\
    \ Transport Agent\n   (MTA) or group of MTAs.  With this configuration, the MTA(s)\
    \ can be\n   configured to sign outgoing mail with an Author Domain Signature.\n\
    \   In this situation, it might be appropriate to publish an ADSP record\n   for\
    \ the domain containing \"all\", depending on whether the users also\n   send\
    \ mail through other paths that do not apply an Author Domain\n   Signature. \
    \ Such paths could include MTAs at hotels or hotspot\n   networks used by travelling\
    \ users, web sites that provide \"mail an\n   article\" features, user messages\
    \ sent through mailing lists, or\n   third-party mail clients that support multiple\
    \ user identities.\n"
- title: B.2.  Bulk Mailing Domains
  contents:
  - "B.2.  Bulk Mailing Domains\n   Another common configuration uses a domain solely\
    \ for bulk or\n   broadcast mail, with no individual human users -- again, typically\n\
    \   sending all the mail through a single MTA or group of MTAs that can\n   apply\
    \ an Author Domain Signature.  In this case, the domain's\n   management can be\
    \ confident that all of its outgoing mail will be\n   sent through the signing\
    \ MTA(s).  Lacking individual users, the\n   domain is unlikely to participate\
    \ in mailing lists, but could still\n   send mail through other paths that might\
    \ invalidate signatures.\n   Domain owners often use specialist mailing providers\
    \ to send their\n   bulk mail.  In this case, the mailing provider needs access\
    \ to a\n   suitable signing key in order to apply an Author Domain Signature.\n\
    \   One possible route would be for the domain owner to generate the key\n   and\
    \ give it to the mailing provider.  Another would be for the domain\n   to delegate\
    \ a subdomain to the mailing provider, for example,\n   bigbank.example might\
    \ delegate email.bigbank.example to such a\n   provider; in this case, the provider\
    \ can generate the keys and DKIM\n   DNS records itself and use the subdomain\
    \ in the Author Address in the\n   mail.\n   Regardless of the DNS and key management\
    \ strategy chosen, whoever\n   maintains the DKIM records for the domain could\
    \ also install an ADSP\n   record containing \"all\".\n"
- title: B.3.  Bulk Mailing Domains with Discardable Mail
  contents:
  - "B.3.  Bulk Mailing Domains with Discardable Mail\n   In some cases, a domain\
    \ might sign all of its outgoing mail with an\n   Author Domain Signature and\
    \ prefer that recipient systems discard\n   mail without a valid Author Domain\
    \ Signature in order to avoid having\n   its mail confused with mail sent from\
    \ sources that do not apply an\n   Author Domain Signature.  (In the case of domains\
    \ with tightly\n   controlled outgoing mail, this latter kind of mail is sometimes\n\
    \   loosely called \"forgeries\".)  In such cases, it might be appropriate\n \
    \  to publish an ADSP record containing \"discardable\".  Note that a\n   domain\
    \ SHOULD NOT publish a \"discardable\" record if it wishes to\n   maximize the\
    \ likelihood that mail from the domain is delivered, since\n   it could cause\
    \ some fraction of the mail the domain sends to be\n   discarded.\n"
- title: B.4.  Third-Party Senders
  contents:
  - "B.4.  Third-Party Senders\n   Another common use case is for a third party to\
    \ enter into an\n   agreement whereby that third party will send bulk or other\
    \ mail on\n   behalf of a designated Author or Author Domain, using that domain\
    \ in\n   the [RFC5322] From: or other headers.  Due to the many and varied\n \
    \  complexities of such agreements, third-party signing is not addressed\n   in\
    \ this specification.\n"
- title: B.5.  Domains with Independent Users and Liberal Use Policies
  contents:
  - "B.5.  Domains with Independent Users and Liberal Use Policies\n   When a domain\
    \ has independent users and its usage policy does not\n   explicitly restrict\
    \ them to sending mail only from designated mail\n   servers (e.g., many ISP domains\
    \ and even some corporate domains),\n   then it is only appropriate to publish\
    \ an ADSP record containing\n   \"unknown\".  Publishing either \"all\" or \"\
    discardable\" will likely\n   result in significant breakage because independent\
    \ users are likely\n   to send mail from the external paths enumerated in Appendix\
    \ B.1.\n"
- title: B.6.  Non-Email Domains
  contents:
  - "B.6.  Non-Email Domains\n   If a domain sends no mail at all, it can safely publish\
    \ a\n   \"discardable\" ADSP record, since any mail with an Author Address in\n\
    \   the domain is a forgery.\n"
- title: Appendix C.  Acknowledgements
  contents:
  - "Appendix C.  Acknowledgements\n   This document greatly benefited from comments\
    \ by Steve Atkins, Jon\n   Callas, Dave Crocker, Pasi Eronen, JD Falk, Arvel Hathcock,\
    \ Ellen\n   Siegel, Michael Thomas, and Wietse Venema.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Eric Allman\n   Sendmail, Inc.\n   6475 Christie Ave,\
    \ Suite 350\n   Emeryville, CA  94608\n   Phone: +1 510 594 5501\n   EMail: eric+dkim@sendmail.org\n\
    \   Jim Fenton\n   Cisco Systems, Inc.\n   170 W. Tasman Drive\n   San Jose, CA\
    \  95134-1706\n   Phone: +1 408 526 5914\n   EMail: fenton@cisco.com\n   Mark\
    \ Delany\n   Yahoo! Inc.\n   701 First Avenue\n   Sunnyvale, CA  94089\n   Phone:\
    \ +1 408 349 6831\n   EMail: markd+dkim@yahoo-inc.com\n   John Levine\n   Taughannock\
    \ Networks\n   PO Box 727\n   Trumansburg, NY  14886\n   Phone: +1 831 480 2300\n\
    \   EMail: standards@taugh.com\n   URI:   http://www.taugh.com\n"
