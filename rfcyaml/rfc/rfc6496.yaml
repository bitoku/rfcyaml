- title: __initial_text__
  contents:
  - '      Secure Proxy ND Support for SEcure Neighbor Discovery (SEND)

    '
- title: Abstract
  contents:
  - "Abstract\n   SEcure Neighbor Discovery (SEND) specifies a method for securing\n\
    \   Neighbor Discovery (ND) signaling against specific threats.  As\n   defined\
    \ today, SEND assumes that the node sending an ND message is\n   the owner of\
    \ the address from which the message is sent and/or\n   possesses a key that authorizes\
    \ the node to act as a router, so that\n   it is in possession of the private\
    \ key or keys used to generate the\n   digital signature on each message.  This\
    \ means that the Proxy ND\n   signaling performed by nodes that do not possess\
    \ knowledge of the\n   address owner's private key and/or knowledge of a router's\
    \ key cannot\n   be secured using SEND.  This document extends the current SEND\n\
    \   specification in order to secure Proxy ND operation.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for examination, experimental implementation, and\n   evaluation.\n\
    \   This document defines an Experimental Protocol for the Internet\n   community.\
    \  This document is a product of the Internet Engineering\n   Task Force (IETF).\
    \  It represents the consensus of the IETF\n   community.  It has received public\
    \ review and has been approved for\n   publication by the Internet Engineering\
    \ Steering Group (IESG).  Not\n   all documents approved by the IESG are a candidate\
    \ for any level of\n   Internet Standard; see Section 2 of RFC 5741.\n   Information\
    \ about the current status of this document, any errata,\n   and how to provide\
    \ feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6496.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................2\n\
    \   2. Requirements Notation ...........................................3\n  \
    \ 3. Terminology .....................................................3\n   4.\
    \ Secure Proxy ND Overview ........................................4\n   5. Secure\
    \ Proxy ND Specification ...................................5\n      5.1. Proxy\
    \ Signature Option .....................................6\n      5.2. Modified\
    \ SEND Processing Rules .............................8\n           5.2.1. Processing\
    \ Rules for Senders ........................8\n           5.2.2. Processing Rules\
    \ for Receivers ......................9\n      5.3. Proxying Link-Local Addresses\
    \ .............................11\n   6. Application Scenarios ..........................................11\n\
    \      6.1. Scenario 1: Mobile IPv6 ...................................11\n  \
    \    6.2. Scenario 2: Proxy Mobile IPv6 .............................13\n    \
    \  6.3. Scenario 3: RFC 4389 Neighbor Discovery Proxy .............16\n   7. Backward\
    \ Compatibility with RFC 3971 Nodes and Non-SEND Nodes ..17\n      7.1. Backward\
    \ Compatibility with RFC 3971 Nodes ................17\n      7.2. Backward Compatibility\
    \ with Non-SEND Nodes ................18\n   8. Security Considerations ........................................20\n\
    \   9. IANA Considerations ............................................22\n  \
    \ 10. Acknowledgements ..............................................22\n   11.\
    \ References ....................................................22\n      11.1.\
    \ Normative References .....................................22\n      11.2. Informative\
    \ References ...................................23\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   SEcure Neighbor Discovery (SEND) [RFC3971] specifies a method\
    \ for\n   securing Neighbor Discovery (ND) signaling [RFC4861] against specific\n\
    \   threats [RFC3756].  As defined today, SEND assumes that the node\n   sending\
    \ an ND message is the owner of the address from which the\n   message is sent\
    \ and/or possesses a key that authorizes the node to\n   act as a router, so that\
    \ it is in possession of the private key or\n   keys used to generate the digital\
    \ signature on each message.  This\n   means that the Proxy ND signaling performed\
    \ by nodes that do not\n   possess knowledge of the address owner's private key\
    \ and/or knowledge\n   of a router's key cannot be secured using SEND.\n   This\
    \ document extends the current SEND specification with support for\n   Proxy ND.\
    \  From this point on, we refer to such an extension as\n   \"Secure Proxy ND\
    \ Support for SEND\".\n"
- title: 2.  Requirements Notation
  contents:
  - "2.  Requirements Notation\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 3.  Terminology
  contents:
  - "3.  Terminology\n   Secure ND Proxy\n      A node acting on behalf of another\
    \ node and authorized to secure a\n      Neighbor Discovery Protocol (NDP) message\
    \ without knowing the\n      private key related to the source address of the\
    \ other node or the\n      key related to the router authorization.\n   Proxied\
    \ IPv6 address\n      An IPv6 address that does not belong to the Secure ND Proxy\
    \ and\n      for which the Secure ND Proxy is performing advertisements.\n   Non-SEND\
    \ node\n      An IPv6 node that does not implement the SEND [RFC3971]\n      specification\
    \ but uses the ND protocol defined in [RFC4861] and\n      [RFC4862], without\
    \ additional security.\n   RFC 3971 node\n      An IPv6 node that does not implement\
    \ the specification defined in\n      this document for Secure Proxy ND support\
    \ but uses the SEND\n      specification as defined in [RFC3971].\n   Secure Proxy\
    \ ND (SPND) node\n      An IPv6 node that receives and validates messages according\
    \ to the\n      specification defined in this document for Secure Proxy ND\n \
    \     support.\n   Translated NDP message\n      An NDP message issued by a Secure\
    \ ND Proxy as a result of a\n      received NDP message originated by the owner\
    \ of the address or\n      originated by another node acting on behalf of the\
    \ owner of the\n      address.\n   Synthetic NDP message\n      An NDP message\
    \ issued by a Secure ND Proxy that is not the result\n      of a received NDP\
    \ message.\n"
- title: 4.  Secure Proxy ND Overview
  contents:
  - "4.  Secure Proxy ND Overview\n   The original SEND specification [RFC3971] has\
    \ implicitly assumed that\n   only the node sending an ND message is the owner\
    \ of the address from\n   which the message is sent.  This assumption does not\
    \ allow proxying\n   of ND messages, since the advertiser is required to generate\
    \ a valid\n   RSA Signature option, which in turn requires possession of the\n\
    \   public-private key pair that was used to generate a Cryptographically\n  \
    \ Generated Address (CGA), or that was associated to a router\n   certificate.\n\
    \   To be able to separate the roles of owner and advertiser, the\n   following\
    \ extensions to the SEND protocol are defined:\n   o  A Secure Proxy ND certificate,\
    \ which is a certificate authorizing\n      an entity to act as an ND proxy. \
    \ It is an X.509v3 certificate in\n      which the purpose for which the certificate\
    \ is issued has been\n      specified explicitly, as described in a companion\
    \ document\n      [RFC6494].  Briefly, Secure Proxy ND certificates include one\
    \ or\n      more KeyPurposeId values that can be used for authorizing proxies\n\
    \      to sign Router Advertisement (RA) and Redirect messages, or to\n      sign\
    \ Neighbor Advertisement (NA), Neighbor Solicitation (NS), or\n      Router Solicitation\
    \ (RS) messages on behalf of other nodes.  The\n      inclusion of this value\
    \ allows the certificate owner to perform\n      proxying of SEND messages for\
    \ a range of addresses indicated in\n      the same certificate.  This certificate\
    \ can be exchanged through\n      the Authorization Delegation Discovery process\
    \ defined in\n      [RFC3971].\n   o  A new Neighbor Discovery option called the\
    \ Proxy Signature (PS)\n      option.  This option contains the hash value of\
    \ the public key of\n      the proxy, and the digital signature of the SEND message\
    \ computed\n      with the private key of the proxy.  The hash of the public key\
    \ of\n      the proxy is computed over the public key contained in the Secure\n\
    \      Proxy ND certificate.  When an ND message contains a PS option, it\n  \
    \    MUST NOT contain CGA or RSA Signature options.  The PS option MUST\n    \
    \  be appended to any NDP message (NA, NS, RS, RA, and Redirect) to\n      secure\
    \ it.\n   o  A modification of the SEND processing rules for all ND messages:\n\
    \      NA, NS, RS, RA, and Redirect.  When any of these messages\n      containing\
    \ a PS option is validated, it is considered secure.\n   These extensions are\
    \ applied in the following way:\n   o  A Secure ND Proxy that proxies ND messages\
    \ on behalf of a node can\n      use the PS option to protect the proxied messages.\
    \  This Secure ND\n      Proxy becomes part of the trusted infrastructure just\
    \ like a SEND\n      router.\n   o  The messages to be secured with the PS option\
    \ are built according\n      to [RFC4861] if they are synthesized by the Secure\
    \ ND Proxy, or\n      they result from the processing rules defined in [RFC4389]\
    \ if they\n      are translated ND messages.\n   o  In order to allow nodes to\
    \ successfully validate secured proxied\n      messages, the nodes MUST be aware\
    \ of the Secure Proxy ND\n      certificate (in the format described in [RFC6494])\
    \ and MUST apply\n      the modified processing rules specified in this document.\
    \  We call\n      these nodes 'SPND nodes'.  Note that the rules for generating\
    \ ND\n      messages in SPND nodes do not change, so these nodes behave as\n \
    \     defined in [RFC3971] when they send ND messages.\n   o  To allow SPND nodes\
    \ to know the certification path required to\n      validate the public key of\
    \ the proxy, devices responding to CPS\n      (Certification Path Solicitation)\
    \ messages with CPA (Certification\n      Path Advertisement) messages as defined\
    \ in Section 6 of the SEND\n      specification [RFC3971] are extended to support\
    \ the certificate\n      format specified in [RFC6494], and are configured with\
    \ the\n      appropriate certification path.\n"
- title: 5.  Secure Proxy ND Specification
  contents:
  - "5.  Secure Proxy ND Specification\n   A Secure ND Proxy performs all the operations\
    \ described in the SEND\n   specification [RFC3971] with the addition of new processing\
    \ rules to\n   ensure that the receiving node can identify an authorized proxy\n\
    \   generating a translated or synthetic SEND message for a proxied\n   address.\n\
    \   This is accomplished by signing the message with a private key of the\n  \
    \ authorized Secure ND Proxy.  The signature of the Secure ND Proxy is\n   included\
    \ in a new option called the PS option.  The signature is\n   performed over all\
    \ the Neighbor Discovery Protocol (NDP) options\n   present in the message, and\
    \ the PS option is appended as the last\n   option in the message.\n"
- title: 5.1.  Proxy Signature Option
  contents:
  - "5.1.  Proxy Signature Option\n   The Proxy Signature option allows signatures\
    \ based on public keys to\n   be attached to NDP messages.  The format of the\
    \ PS option is\n   described in the following diagram:\n       0             \
    \      1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |    Length     |          Reserved             |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      |   \
    \                       Key Hash                             |\n      |      \
    \                                                         |\n      |         \
    \                                                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   .                                                               .\n      .\
    \                       Digital Signature                       .\n      .   \
    \                                                            .\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   .                                                               .\n      .\
    \                           Padding                             .\n      .   \
    \                                                            .\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                        Figure 1: PS Option Layout\n   Type\n      32\n   Length\n\
    \      The length of the option (including the Type, Length, Reserved,\n     \
    \ Key Hash, Digital Signature, and Padding fields) in units of\n      8 octets.\n\
    \   Reserved\n      A 16-bit field reserved for future use.  The value MUST be\n\
    \      initialized to zero by the sender, and MUST be ignored by the\n      receiver.\n\
    \   Key Hash\n      A 128-bit field containing the most significant (leftmost)\n\
    \      128 bits of a SHA-1 [SHA1] hash of the public key used for\n      constructing\
    \ the signature.  Its purpose is to associate the\n      signature to a particular\
    \ key known by the receiver.  Such a key\n      MUST be the same one within the\
    \ corresponding Secure Proxy ND\n      certificate.\n   Digital Signature\n  \
    \    A variable-length field containing a PKCS#1 v1.5 signature,\n      constructed\
    \ by using the sender's private key over the following\n      sequence of octets:\n\
    \      1.  The 128-bit CGA Message Type tag [RFC3972] value for Secure\n     \
    \     Proxy ND, 0x09F5 2BE5 3B62 4C76 CB96 4E7F CDC9 2804.  (The tag\n       \
    \   value has been generated randomly by the editor of this\n          specification.)\n\
    \      2.  The 128-bit Source Address field from the IP header.\n      3.  The\
    \ 128-bit Destination Address field from the IP header.\n      4.  The 8-bit Type,\
    \ 8-bit Code, and 16-bit Checksum fields from\n          the ICMP header.\n  \
    \    5.  The NDP message header, starting from the octet after the ICMP\n    \
    \      Checksum field and continuing up to, but not including, NDP\n         \
    \ options.\n      6.  All NDP options preceding the Proxy Signature option.\n\
    \      The signature value is computed with the RSASSA-PKCS1-v1_5\n      algorithm\
    \ and SHA-1 hash, as defined in [RSA].  This field starts\n      after the Key\
    \ Hash field.  The length of the Digital Signature\n      field is determined\
    \ by the ASN.1 BER coding of the PKCS#1 v1.5\n      signature.\n   Padding\n \
    \     This variable-length field contains padding.  The length of the\n      padding\
    \ field is determined by the length of the Proxy Signature\n      option minus\
    \ the length of the other fields.\n"
- title: 5.2.  Modified SEND Processing Rules
  contents:
  - "5.2.  Modified SEND Processing Rules\n   This specification modifies the sender\
    \ and receiver processing rules\n   defined in the SEND specification [RFC3971].\n"
- title: 5.2.1.  Processing Rules for Senders
  contents:
  - "5.2.1.  Processing Rules for Senders\n   A Secure ND Proxy MUST NOT use a key\
    \ to sign NDP message types that\n   do not correspond to the authorization granted\
    \ to the considered key.\n   NA, NS, and RS messages MUST be signed with a key\
    \ corresponding to a\n   Secure Proxy ND certificate with a KeyPurposeId value\
    \ [RFC6494] of\n   id-kp-sendProxiedOwner, and the source addresses of the messages\
    \ MUST\n   be encompassed in the prefix associated to the certificate.  RA and\n\
    \   Redirect messages MUST be signed with a key corresponding to a Secure\n  \
    \ Proxy ND certificate with a KeyPurposeId value of\n   id-kp-sendProxiedRouter.\
    \  The prefix included in the RA message for\n   on-link determination and/or\
    \ stateless address autoconfiguration, and\n   the Target Address of the Redirect\
    \ message, MUST be encompassed in\n   the prefix associated to that certificate.\n\
    \   A secured NDP message sent by a Secure ND Proxy for a proxied address\n  \
    \ MUST contain a PS option and MUST NOT contain either CGA or RSA\n   Signature\
    \ options.  Section 7 discusses in which cases an NDP message\n   has to be secured\
    \ in a scenario including non-SEND nodes.\n   The input of this process is a message\
    \ obtained in either of the\n   following ways:\n   a.  If the Secure ND Proxy\
    \ generates synthetic SEND messages for a\n       proxied address, the message\
    \ MUST be constructed as described in\n       the Neighbor Discovery for IP version\
    \ 6 specification [RFC4861].\n   b.  If the Secure ND Proxy translates secured\
    \ messages, first the\n       authenticity of the intercepted message MUST be\
    \ verified.  If the\n       intercepted message is a SEND message, it MUST be\
    \ validated as\n       specified in Section 5 of the SEND specification [RFC3971].\
    \  If\n       the intercepted message contains a PS option, the authenticity of\n\
    \       the message MUST be verified as detailed in Section 5.2.2 of this\n  \
    \     specification.  After validation, the CGA, RSA, or PS options of\n     \
    \  the original message MUST be removed.  Then, the message to be\n       translated\
    \ MUST be processed according to the ND Proxy\n       specification [RFC4389].\
    \  In this way, it is determined whether\n       the message received should be\
    \ proxied or not; the proxy\n       interface status is updated if needed, the\
    \ outgoing interface is\n       determined, the link-layer header and the link-layer\
    \ address\n       within the payload are modified if required, etc.\n   A Secure\
    \ ND Proxy then modifies the input message as follows:\n   1.  Timestamp and Nonce\
    \ options MUST be included according to the\n       rules specified in SEND [RFC3971].\
    \  The value in the Timestamp\n       option MUST be generated by the proxy. \
    \ If the proxy is\n       translating a message that includes a nonce, the Nonce\
    \ value in\n       the proxied message MUST be the same as in the intercepted\n\
    \       message.  If the proxy is synthesizing a solicitation message,\n     \
    \  the Nonce value MUST be generated by the proxy.  If the proxy is\n       synthesizing\
    \ an advertisement message, the Nonce value MUST\n       correspond to the solicitation\
    \ message to which the proxy is\n       responding.\n   2.  The Proxy Signature\
    \ option MUST be added as the last option in\n       the message.\n   3.  The\
    \ data MUST be signed as explained in Section 5.1.\n"
- title: 5.2.2.  Processing Rules for Receivers
  contents:
  - "5.2.2.  Processing Rules for Receivers\n   Any SEND message without a Proxy Signature\
    \ option MUST be treated as\n   specified in the SEND specification [RFC3971].\n\
    \   A SEND message including a Proxy Signature option MUST be processed\n   as\
    \ specified below:\n   1.  The receiver MUST ignore any RSA and CGA options, as\
    \ well as any\n       options that might come after the first PS option.  The\
    \ options\n       are ignored for both signature verification and NDP processing\n\
    \       purposes.\n   2.  The Key Hash field MUST indicate the use of a known\
    \ public key.\n       A valid certification path (see [RFC6494] Section 9) between\
    \ the\n       receiver's trust anchor and the sender's public key MUST be\n  \
    \     known.  The Secure Proxy ND X.509v3 certificate MUST contain an\n      \
    \ extended key usage extension including the appropriate\n       KeyPurposeId\
    \ value and prefix for the message to validate:\n       *  For RA messages, a\
    \ KeyPurposeId value of\n          id-kp-sendProxiedRouter MUST exist for the\
    \ certificate, and\n          the prefix included in the RA message for on-link\n\
    \          determination and/or stateless address autoconfiguration MUST\n   \
    \       be encompassed in the prefix associated to that certificate.\n       *\
    \  For Redirect messages, a KeyPurposeId value of\n          id-kp-sendProxiedRouter\
    \ MUST exist for the certificate, and\n          the prefix included in the Target\
    \ Address of the Redirect\n          message MUST be encompassed in the prefix\
    \ associated to that\n          certificate.\n       *  For NA, NS, and RS messages,\
    \ a KeyPurposeId value of\n          id-kp-sendProxiedOwner MUST exist for the\
    \ certificate, and the\n          source addresses of the messages MUST be encompassed\
    \ in the\n          prefix associated to the certificate.\n       If any of these\
    \ tests fail, the verification fails.\n   3.  The Digital Signature field MUST\
    \ have correct encoding;\n       otherwise, the verification of the message including\
    \ the PS\n       option fails.\n   4.  The Digital Signature verification MUST\
    \ show that the signature\n       has been calculated as specified in Section\
    \ 5.1; otherwise, the\n       verification of the message including the PS option\
    \ fails.\n   5.  The Nonce option MUST be processed as specified in [RFC3971]\n\
    \       Section 5.3.4, except for replacing 'RSA Signature option' with\n    \
    \   'PS option'; if these tests fail, the verification of the message\n      \
    \ including the PS option fails.\n   6.  The Timestamp option MUST be processed\
    \ as specified in [RFC3971]\n       Section 5.3.4, except for replacing 'RSA Signature\
    \ option' with\n       'PS option'.  If these tests fail, the verification of\
    \ the\n       message including the PS option fails.  The receiver SHOULD store\n\
    \       the peer-related timing information specified in [RFC3971]\n       Sections\
    \ 5.3.4.1 and 5.3.4.2 (RDlast, TSlast) separately for each\n       different proxy\
    \ (which could be identified by the different Key\n       Hash values of the proxied\
    \ message) and separately from the\n       timing information associated to the\
    \ IP address of a node for\n       which the message is proxied.  In this way,\
    \ a message received\n       for the first time from a proxy (i.e., for which\
    \ there is no\n       information stored in the cache) for which the Timestamp\
    \ option\n       is checked SHOULD be checked as a message received from a new\n\
    \       peer (as in [RFC3971] Section 5.3.4.2).\n   7.  Messages with the Override\
    \ bit [RFC4861] set MUST override an\n       existing cache entry regardless of\
    \ whether it was created as a\n       result of an RSA Signature option or a PS\
    \ option validation.\n       When the Override bit is not set, the advertisement\
    \ MUST NOT\n       update a cached link-layer address created securely by means\
    \ of\n       RSA Signature option or PS option validation.\n   Messages for which\
    \ the verification fails MUST be silently discarded\n   if the node has been configured\
    \ to accept only secured ND messages.\n   The messages MAY be accepted if the\
    \ host has been configured to\n   accept both secured and unsecured messages but\
    \ MUST be treated as an\n   unsecured message.\n"
- title: 5.3.  Proxying Link-Local Addresses
  contents:
  - "5.3.  Proxying Link-Local Addresses\n   SEND [RFC3971] relies on certificates\
    \ to prove that routers are\n   authorized to announce a certain prefix.  However,\
    \ Neighbor Discovery\n   [RFC4861] states that routers do not announce the link-local\
    \ prefix\n   (fe80::/64).  Hence, it is not required for a SEND certificate to\n\
    \   hold an X.509 extension for IP addresses that authorizes the\n   fe80::/64\
    \ prefix.  However, some Secure Proxy ND scenarios\n   ([RFC4389], [RFC5213])\
    \ impose providing the proxying function for the\n   link-local address of a node.\
    \  When Secure ND Proxy functionality for\n   a link-local address is required,\
    \ either a list of link-local\n   addresses, or the fe80::/64 prefix MUST be explicitly\
    \ authorized to\n   be proxied in the corresponding certificate.\n"
- title: 6.  Application Scenarios
  contents:
  - "6.  Application Scenarios\n   In this section, we describe three different application\
    \ scenarios\n   for which Secure Proxy ND support for SEND can be applied.  Note\
    \ that\n   the particular way in which Secure Proxy ND support is applied (which\n\
    \   ND messages are proxied, in which direction, how the interaction with\n  \
    \ non-SEND hosts and RFC 3971 hosts is handled, etc.) largely depends\n   on the\
    \ particular scenario considered.  In the first two scenarios\n   presented below,\
    \ ND messages are synthesized on behalf of off-link\n   nodes.  In the third one,\
    \ ND messages are translated from the\n   messages received in other interfaces\
    \ of the proxy.\n"
- title: '6.1.  Scenario 1: Mobile IPv6'
  contents:
  - "6.1.  Scenario 1: Mobile IPv6\n   The description of the problems for deploying\
    \ SEND in this scenario\n   is presented in [RFC5909].\n   The Mobile IPv6 (MIPv6)\
    \ protocol [RFC6275] allows a Mobile Node (MN)\n   to move from one link to another\
    \ while maintaining reachability at a\n   stable address, the so-called MN's Home\
    \ Address (HoA).  When an MN\n   attaches to a foreign network, all the packets\
    \ sent to the MN's HoA\n   by a Correspondent Node (CN) on the home link or a\
    \ router are\n   intercepted by the Home Agent (HA) on that home link, encapsulated,\n\
    \   and tunneled to the MN's registered Care-of Address (CoA).\n   To deploy Secure\
    \ Proxy ND in this scenario, i.e., to secure the HA\n   operation, a Secure Proxy\
    \ ND certificate with a KeyPurposeId value of\n   id-kp-sendProxiedOwner for the\
    \ prefix of the home link is required.\n   The Secure ND Proxy is configured with\
    \ the private key associated to\n   this certificate.  When a NS is intercepted\
    \ by the HA on the home\n   link, the HA checks whether the Target Address within\
    \ the NS matches\n   with any of the MN's Home Addresses in the binding cache,\
    \ and if so,\n   it replies with a Neighbor Advertisement (NA) constructed as\n\
    \   described in [RFC4861], containing its own link-layer address (HA_LL)\n  \
    \ as the Target Link-Layer Address Option (TLLAO).  Then, a timestamp\n   (generated\
    \ by the proxy) and nonce (if appropriate, according to\n   [RFC3971]) MUST be\
    \ included.  Finally, a PS option signing the\n   message MUST be included as\
    \ the last option of the message.\n      Node (N)                Home Agent (HA)\
    \          Mobile Node (MN)\n      on Home Link             on Home Link     \
    \       on Foreign Link\n        |                           |               \
    \           |\n        | SRC = N                   |                         \
    \ |\n        | DST = solicited_node (MN) |                          |\n      \
    \  | ICMPv6 NS                 |                          |\n        | TARGET\
    \ = MN               |                          |\n        | SLLAO = N_LL    \
    \          |                          |\n        | [CGA]                     |\
    \                          |\n        | RSA signature             |          \
    \                |\n        |-------------------------->|                    \
    \      |\n        |                           |                          |\n \
    \       | SRC = HA                  |                          |\n        | DST\
    \ = N                   |                          |\n        | ICMPv6 NA    \
    \             |                          |\n        | TARGET = MN            \
    \   |                          |\n        | TLLAO = HA_LL             |      \
    \                    |\n        | PS signature              |                \
    \          |\n        |<--------------------------|                          |\n\
    \        |                           |                          |\n        | traffic\
    \                   |                          |\n        | dest = MN HoA    \
    \         |                          |\n        |-------------------------->|\
    \                          |\n        |                           |          \
    \                |\n        |                           | tunneled traffic   \
    \      |\n        |                           | dest = MN CoA            |\n \
    \       |                           |------------------------->|\n        |  \
    \                         |                          |\n            Figure 2:\
    \ Proxy ND Role of the Home Agent in MIPv6\n   A node receiving the NA containing\
    \ the PS option (e.g., the CN in the\n   home link, or a router) MUST apply the\
    \ rules defined in\n   Section 5.2.2.  Note that in this case the Override bit\
    \ of the NA\n   message is used to control which messages should prevail on each\n\
    \   case: the message generated by the proxy when the MN moves from the\n   home\
    \ network, or the MN if it comes back to the home link, as defined\n   in the\
    \ MIPv6 specification [RFC6275].\n"
- title: '6.2.  Scenario 2: Proxy Mobile IPv6'
  contents:
  - "6.2.  Scenario 2: Proxy Mobile IPv6\n   Proxy Mobile IPv6 [RFC5213] is a network-based\
    \ mobility management\n   protocol that provides IP mobility management support\
    \ for MNs without\n   requiring that MNs be involved in the mobility-related signaling.\n\
    \   The IP mobility management is totally hidden to the MN in a Proxy\n   Mobile\
    \ IPv6 domain, and it is performed by two functional entities:\n   the Local Mobility\
    \ Anchor (LMA) and the Mobile Access Gateway (MAG).\n   When the MN connects to\
    \ a new access link, it sends a multicast\n   Router Solicitation (RS).  The MAG\
    \ on the new access link, upon\n   detecting the MN's attachment, signals the\
    \ LMA requesting an update\n   of the binding state of the MN (by means of a Proxy\
    \ Binding Update\n   (PBU)).  Once the signaling is completed (it receives a Proxy\
    \ Binding\n   Ack (PBA)), the MAG replies to the MN with a Router Advertisement\n\
    \   (RA) containing the home network prefix(es) that were assigned to\n   that\
    \ mobility session, making the MN believe it is still on the same\n   link, so\
    \ the IPv6 address reconfiguration procedure is not triggered\n   (Figure 3).\n\
    \             MN                   new MAG                  LMA\n            \
    \  |                      |                      |\n          MN Attached    \
    \            |                      |\n              |                      |\
    \                      |\n              |       MN Attached Event from MN/Network\
    \     |\n              |                      |                      |\n     \
    \         | SRC = MN             |                      |\n              | DST\
    \ = all routers    |                      |\n              | ICMPv6 RS       \
    \     |                      |\n              | [CGA]                |       \
    \               |\n              | RSA signature        |                    \
    \  |\n              |--------------------->|                      |\n        \
    \      |                      |                      |\n              |      \
    \                |--- PBU ------------->|\n              |                   \
    \   |                      |\n              |                      |         \
    \         Accept PBU\n              |                      |                 \
    \     |\n              |                      |<------------- PBA ---|\n     \
    \         |                      |                      |\n              |   \
    \              Accept PBA                  |\n              |                \
    \      |                      |\n              |                      |==== Bi-Dir\
    \ Tunnel ===|\n              |                      |                      |\n\
    \              |        SRC = MAG4MN  |                      |\n             \
    \ |            DST = MN  |                      |\n              |           ICMPv6\
    \ RA  |                      |\n              |        SLL = MAG_LL  |       \
    \               |\n              |            PS        |                    \
    \  |\n              |<---------------------|                      |\n        \
    \      |                      |                      |\n              |      \
    \                |                      |\n              |                   \
    \   |                      |\n                Figure 3: Mobile Node's Handover\
    \ in PMIPv6\n   To avoid potential link-local address collisions between the MAG\
    \ and\n   the MN after a handoff to a new link, the Proxy Mobile IPv6\n   specification\
    \ [RFC5213] requires that the MAG's link-local address on\n   the link to which\
    \ the MN is attached be generated by the LMA when the\n   MN first attaches to\
    \ a PMIPv6 domain, and be provided to the new MN's\n   serving MAG after each\
    \ handoff.  Thus, from the MN's point of view,\n   the MAG's link-local address\
    \ remains constant for the duration of\n   that MN's session.\n   The approach\
    \ described above and the current SEND specification are\n   incompatible, since\
    \ sharing the same link-local address on different\n   MAGs would require all\
    \ MAGs of a PMIPv6 domain to construct the CGA\n   and the RSA Signature option\
    \ with the same public-private key pair,\n   which is not an acceptable security\
    \ policy.\n   Using different public-private key pairs on different MAGs would\
    \ mean\n   that different MAGs use different CGAs as link-local addresses.\n \
    \  Thus, the serving MAG's link-local address would change after each\n   handoff\
    \ of the MN, which is in contradiction with the way MAG link-\n   local address\
    \ assignment occurs in a PMIPv6 domain.\n   To provide SEND protection, each MAG\
    \ MUST be configured to act as a\n   proxy by means of a certificate associated\
    \ to the PMIPv6 domain,\n   authorizing each MAG to securely proxy NA and RS messages\
    \ by means of\n   a KeyPurposeId value of id-kp-sendProxiedOwner.  In addition,\
    \ the\n   certificate MUST also authorize the MAG to advertise prefixes by\n \
    \  associating to the same certificate a KeyPurposeId value of\n   id-kp-sendProxiedRouter.\
    \  Note that the inclusion of multiple\n   KeyPurposeId values is supported by\
    \ [RFC6494].\n   When a MAG replies to an RS with an RA, the source address MUST\
    \ be\n   equal to the MAG link-local address associated to the MN in this\n  \
    \ PMIPv6 domain, with its own link-layer address as the source link-\n   layer\
    \ address.  Then, a timestamp (generated by the proxy) and nonce\n   (if appropriate,\
    \ according to [RFC3971]) MUST be included.  Finally,\n   a PS option signing\
    \ the message MUST be included as the last option\n   of the message.  This procedure\
    \ is followed for any other ND message\n   that could be generated by the MAG\
    \ to the MN.\n   A node receiving a message from the MAG containing the PS option\
    \ MUST\n   apply the processing rules defined in Section 5.2.2.  Note that\n \
    \  unsolicited messages sent by the MAG should be validated by the host\n   according\
    \ to timestamp values specific to the MAG serving the link,\n   not to any other\
    \ MAG to which the host has been connected before in\n   other links, according\
    \ to processing step number 6 of Section 5.2.2.\n"
- title: '6.3.  Scenario 3: RFC 4389 Neighbor Discovery Proxy'
  contents:
  - "6.3.  Scenario 3: RFC 4389 Neighbor Discovery Proxy\n   The problems for deploying\
    \ SEND in this scenario are presented in\n   [RFC5909].\n         Link 1     \
    \                                          Link 2\n         Host A           \
    \        ND Proxy (P)                Host B\n           |                    \
    \      |                          |\n           | SRC = A                  | \
    \                         |\n           | DST = solicited_node (B) |         \
    \                 |\n           | ICMPv6 NS                |                 \
    \         |\n           | TARGET = B               |                         \
    \ |\n           | SLLAO = A_LL             |                          |\n    \
    \       |------------------------->|                          |\n           |\
    \                          | SRC = A                  |\n           |        \
    \                  | DST = solicited_node (B) |\n           |                \
    \          | ICMPv6 NS                |\n           |                        \
    \  | TARGET = B               |\n           |                          | SLLAO\
    \ = P_LL             |\n           |                          |------------------------->|\n\
    \           |                          |                          |\n        \
    \   |                          | SRC = B                  |\n           |    \
    \                      | DST = A                  |\n           |            \
    \              | ICMPv6 NA                |\n           |                    \
    \      | TARGET = B               |\n           |                          | TLLAO\
    \ = B_LL             |\n           |                          |<-------------------------|\n\
    \           | SRC = B                  |                          |\n        \
    \   | DST = A                  |                          |\n           | ICMPv6\
    \ NA                |                          |\n           | TARGET = B    \
    \           |                          |\n           | TLLAO = P_LL          \
    \   |                          |\n           |<-------------------------|    \
    \                      |\n           |                          |            \
    \              |\n           Figure 4: RFC 4389 Neighbor Discovery Proxy Operation\n\
    \   The Neighbor Discovery (ND) Proxy specification [RFC4389] provides a\n   method\
    \ by which multiple link-layer segments are bridged into a\n   single segment\
    \ and specifies the IP-layer support that enables\n   bridging under these circumstances.\n\
    \   A Secure ND Proxy MUST parse any IPv6 packet it receives on a proxy\n   interface\
    \ to check whether it contains one of the following NDP\n   messages: NS, NA,\
    \ RS, RA, or Redirect.  The Secure ND Proxy MUST\n   verify the authenticity of\
    \ the received ND message, according to\n   [RFC3971], or according to Section\
    \ 5.2.2 if it contains a PS option.\n   Then, after removing the CGA, RSA, or\
    \ PS options, the message to be\n   translated MUST be processed according to\
    \ the ND Proxy specification\n   [RFC4389].  This includes performing loop prevention\
    \ checks,\n   determining the outgoing interface for the proxied message, changing\n\
    \   the source link-layer address to the address of the outgoing\n   interface,\
    \ changing source link-layer addresses contained in the\n   payload (that is,\
    \ in a Source Link-Layer Address Option (SLLAO) or a\n   Target Link-Layer Address\
    \ Option (TLLAO)), maintaining the\n   destination link-layer address as the address\
    \ in the neighbor entry\n   corresponding to the destination IPv6 address, setting\
    \ the P bit for\n   proxied RA messages, etc.  Note that besides link-layer addresses\
    \ and\n   the P bit of a RA, no other field of the received message is changed\n\
    \   when proxied by an [RFC4389] proxy.\n   When any other IPv6 unicast packet\
    \ is received on a proxy interface,\n   if it is not locally destined, then it\
    \ is forwarded unchanged (other\n   than using a new link-layer header) to the\
    \ proxy interface for which\n   the next-hop address appears in the neighbor cache.\
    \  If no neighbor\n   cache entry is present, the Secure ND Proxy SHOULD queue\
    \ the packet\n   and initiate a Neighbor Discovery signaling as if the NS message\
    \ were\n   locally generated.\n   Note that to be able to sign any NS, NA, RS,\
    \ RA, or Redirect message,\n   the key used MUST correspond to a certificate with\
    \ KeyPurposeId\n   values of id-kp-sendProxiedOwner and id-kp-sendProxiedRouter.\n\
    \   In order to deploy this scenario, nodes in proxied segments MUST know\n  \
    \ the certificate-authorizing proxy operation.  To do so, it could be\n   required\
    \ that at least one device per proxied segment (maybe the\n   proxy itself) be\
    \ configured to propagate the required certification\n   path to authorize proxy\
    \ operation by means of a CPS/CPA exchange.\n"
- title: 7.  Backward Compatibility with RFC 3971 Nodes and Non-SEND Nodes
  contents:
  - "7.  Backward Compatibility with RFC 3971 Nodes and Non-SEND Nodes\n   In this\
    \ section, we discuss the interaction of Secure ND Proxies and\n   SPND nodes\
    \ with RFC 3971 nodes and non-SEND nodes.  As stated in\n   [RFC3971], network\
    \ operators may want to run a mixture of nodes\n   accepting secured and unsecured\
    \ NDP messages at the same time.\n   Secure ND Proxies and SPND nodes SHOULD support\
    \ the use of secured\n   and unsecured NDP messages at the same time.\n"
- title: 7.1.  Backward Compatibility with RFC 3971 Nodes
  contents:
  - "7.1.  Backward Compatibility with RFC 3971 Nodes\n   RFC 3971 nodes, i.e., SEND\
    \ nodes not compliant with the modifications\n   required in Section 5, cannot\
    \ correctly interpret a PS option\n   received in a proxied ND message.  These\
    \ SEND nodes silently discard\n   the PS option, as specified in [RFC4861] for\
    \ any unknown option.  As\n   a result, these messages will be treated as unsecured,\
    \ as described\n   in Section 8 (\"Transitions Issues\") of the SEND specification\n\
    \   [RFC3971].\n   When RFC 3971 nodes and SPND nodes exchange ND messages (without\n\
    \   proxy intervention), in either direction, messages are generated\n   according\
    \ to the SEND specification [RFC3971], so these nodes\n   interoperate seamlessly.\n\
    \   In the scenarios in which the proxy translates ND messages, the\n   messages\
    \ to translate can either be originated in an RFC 3971 node or\n   in an SPND\
    \ node, without interoperability issues (note that the\n   difference between\
    \ RFC 3971 nodes and SPND nodes only affects the\n   ability to process received\
    \ NDP messages containing a PS option, not\n   the way they generate messages\
    \ secured by SEND).\n   A configuration option MAY exist in a Secure ND Proxy\
    \ to specify the\n   RFC 3971 nodes to which it is connected, so that the proxied\
    \ messages\n   sent to these nodes are not processed according to the Secure Proxy\n\
    \   ND specification, for performance reasons.\n"
- title: 7.2.  Backward Compatibility with Non-SEND Nodes
  contents:
  - "7.2.  Backward Compatibility with Non-SEND Nodes\n   Non-SEND nodes receiving\
    \ NDP packets silently discard PS options, as\n   specified in [RFC4861] for any\
    \ unknown option.  Therefore, these\n   nodes interpret messages proxied by a\
    \ Secure ND Proxy as any other ND\n   message.\n   When non-SEND nodes and SPND\
    \ nodes exchange ND messages (without\n   proxy intervention), in either direction,\
    \ the rules specified in\n   Section 8 of [RFC3971] apply.\n   A Secure ND Proxy\
    \ SHOULD support the use of secured and unsecured NDP\n   messages at the same\
    \ time, although it MAY have a configuration that\n   causes proxying to not be\
    \ performed for unsecured NDP messages.  A\n   Secure ND Proxy MAY also have a\
    \ configuration option whereby it\n   disables secure ND proxying completely.\
    \  This configuration SHOULD be\n   switched off by default; that is, security\
    \ is provided by default.\n   In the following paragraphs, we discuss the recommended\
    \ behavior of\n   the Secure ND Proxy regarding the protection level to provide\
    \ to\n   proxied messages in a mixed scenario involving SPND/RFC 3971 nodes\n\
    \   and non-SEND nodes.  In particular, two different situations occur,\n   depending\
    \ on whether the proxied nodes are RFC 3971 or SPND nodes, or\n   non-SEND nodes.\n\
    \   As a rule of thumb, if the proxied nodes can return to the link in\n   which\
    \ the proxy operates, the Secure ND Proxy MUST only generate PS\n   options on\
    \ behalf of nodes with SEND capabilities (i.e., those nodes\n   that could use\
    \ SEND to defend their messages if present on the same\n   link as the proxy --\
    \ in other words, either RFC 3971 nodes or SPND\n   nodes).  This is relevant\
    \ to allow nodes to prefer secured\n   information over an unsecured one, and\
    \ to properly execute the\n   Duplicate Address Detection (DAD) procedure, as\
    \ specified in\n   [RFC3971].  Therefore, in this case, the Secure ND Proxy MUST\n\
    \   synthesize/translate messages containing the PS option for SPND and\n   RFC\
    \ 3971 hosts, and MUST NOT synthesize/translate messages containing\n   the PS\
    \ option for non-SEND nodes.  Note that ND advertisements in\n   response to solicitations\
    \ generated by a Secure ND Proxy must either\n   be secured or not secured, according\
    \ to the previous considerations\n   (i.e., according to the nature of the proxied\
    \ node), and not\n   according to the secure or unsecure nature of the solicitation\n\
    \   message.\n   In order to apply this rule, the Secure ND Proxy needs to know\
    \ the\n   security capabilities of the proxied node.  The way this information\n\
    \   is acquired depends on the application scenario, and it is discussed\n   next:\n\
    \   o  For scenarios in which ND messages are translated for nodes that\n    \
    \  can arrive to the link in which the proxy operates, the rule can\n      be\
    \ easily applied: only for messages validated in the Secure ND\n      Proxy according\
    \ to the SEND specification [RFC3971], or according\n      to Section 5.2.2 of\
    \ this specification for messages containing a\n      PS option (which means that\
    \ another proxy previously checked that\n      the original message was secured),\
    \ the message MUST be proxied\n      securely by the inclusion of a PS option.\
    \  Unsecured ND messages\n      could be proxied if unsecured operation is enabled\
    \ in the proxy,\n      but the message generated by the Secure ND Proxy for the\
    \ received\n      message MUST NOT include a PS option.\n   o  For scenarios in\
    \ which ND messages are synthesized on behalf of\n      remote nodes, different\
    \ considerations should be made according to\n      the particular application\
    \ scenario.\n      *  For MIPv6, if the MN can return to the home link, it is\n\
    \         required that the proxy know whether the node could use SEND to\n  \
    \       defend its address or not.  A HA including the PS option for\n       \
    \  proxying a non-SEND MN would make ND messages sent by the proxy\n         be\
    \ more preferred than an ND message of the non-SEND MN when\n         the MN returns\
    \ to the home link (even if the proxied messages\n         have the Override bit\
    \ set to 1).  Not using the PS option for\n         an RFC 3971 or SPND MN would\
    \ make the address in the home link\n         more vulnerable when the MN is away\
    \ than when it is in the home\n         link, defeating the purpose of the Secure\
    \ Proxy ND mechanism.\n         Therefore, in this case, the HA MUST know the\
    \ SEND capabilities\n         of the MN, MUST use the PS option if the MN is an\
    \ SPND or\n         RFC 3971 host, and MUST NOT use the PS option for non-SEND\n\
    \         hosts.\n      *  For the Proxy Mobile IPv6 scenario, a node moving from\
    \ a link\n         in which the PS option has been used to protect a link-layer\n\
    \         address to a link in which ND messages are not protected by\n      \
    \   SEND would prevent the MN from acquiring the new information\n         until\
    \ the cached information expires.  However, in this case,\n         it is reasonable\
    \ to consider that all MAGs provide the same\n         security for protecting\
    \ ND messages, and that either all MAGs\n         or no MAGs will behave as a\
    \ Secure ND Proxy, so configuration\n         is expected to be easier.\n   A\
    \ configuration option MAY exist in a Secure ND Proxy to specify the\n   non-SEND\
    \ nodes to which it is connected, so that the proxied messages\n   sent to these\
    \ nodes are not processed according to the Secure Proxy\n   ND specification,\
    \ for performance reasons.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   The mechanism described in this document introduces\
    \ a new PS option\n   allowing a Secure ND Proxy to synthesize or translate a\
    \ SEND message\n   for a proxied address, to redirect traffic for given target\n\
    \   addresses, or to advertise prefix information by means of RA\n   messages.\
    \  An SPND node only accepts such a message if it includes a\n   valid PS option\
    \ generated by a properly authorized Secure ND Proxy\n   (with a certificate containing\
    \ a KeyPurposeId with value\n   id-kp-sendProxiedOwner for protecting NA, NS,\
    \ and RS messages, or\n   containing a KeyPurposeId value of id-kp-sendProxiedRouter\
    \ for\n   protecting RA and Redirect messages).  Such a message has protection\n\
    \   against the threats presented in Section 9 of [RFC3971] equivalent to\n  \
    \ a message signed with an RSA Signature option.\n   The security of proxied ND\
    \ messages not including a PS option is the\n   same as an unsecured ND message.\
    \  The security of a proxied ND\n   message received by a non-SEND host or RFC\
    \ 3971 host is the same as\n   an unsecured ND message.\n   When a message including\
    \ a PS option is received by an SPND node, any\n   CGA or RSA options also included\
    \ in the message are removed and the\n   remaining message further processed.\
    \  Although properly formed\n   proxied messages MUST NOT include PS and CGA/RSA\
    \ options at the same\n   time, discarding them if they appear does not affect\
    \ security.  If\n   the PS option is validated, then the information included\
    \ in the\n   message has been validly generated by a proxy, and should be honored\n\
    \   (remember that anti-replay protection is provided by means of Nonce\n   and\
    \ Timestamp options).  If the PS option is not validated, then it\n   is treated\
    \ as an unsecured message.  In any case, there is no gain\n   for an attacker\
    \ from appending false or old CGA/RSA information to a\n   message secured by\
    \ a Secure ND Proxy.\n   A compromised Secure ND Proxy provisioned with an authorization\n\
    \   certificate with a KeyPurposeId value of id-kp-sendProxiedRouter is\n   able,\
    \ like a compromised router, to siphon off traffic from the host,\n   or mount\
    \ a man-in-the-middle attack, for hosts communicating to off-\n   link hosts.\
    \  A compromised Secure ND Proxy provisioned with an\n   authorization certificate\
    \ with a KeyPurposeId value of\n   id-kp-sendProxiedOwner can siphon off traffic\
    \ or mount a man-in-the-\n   middle attack for communication between on-link hosts,\
    \ even if the\n   hosts use SEND.  Note that different application scenarios may\n\
    \   require one type of authorization, the other, or both.  To minimize\n   security\
    \ risks, authorization capabilities MUST NOT exceed the ones\n   strictly required\
    \ by the application scenario to be deployed.\n   The messages for which a Secure\
    \ ND Proxy performs its function and\n   the link for which this function is performed\
    \ MUST be configured\n   appropriately for each proxy and scenario.  This configuration\
    \ is\n   especially relevant if Secure Proxy ND is used for translating ND\n \
    \  messages from one link to another.\n   Section 7 discusses the security considerations\
    \ resulting from the\n   decision to append or omit the PS option, depending on\
    \ the SEND-\n   awareness of the proxied nodes.\n   Protection against replay\
    \ attacks from unsolicited messages such as\n   NA, RA, and Redirects is provided\
    \ by means of the Timestamp option.\n   When Secure ND Proxy is used, each host,\
    \ and each proxy acting on\n   behalf of that host, are considered to be different\
    \ peers in terms of\n   timestamp verification.  Since the information provided\
    \ by the host\n   and a proxy, including different link-layer addresses, may be\n\
    \   different, a replay attack could affect the operation of a third\n   node:\
    \ replaying messages issued by a host that is no longer in the\n   link can prevent\
    \ the use of a proxy, and replaying messages of a\n   proxy when the host is back\
    \ in the link can prevent communication\n   with the host.  This kind of attack\
    \ can be performed until the\n   timestamp of the peer (either the host or a proxy)\
    \ is no longer valid\n   for the receiver.  The window of vulnerability is in\
    \ general larger\n   for the first message received from a new peer than for subsequent\n\
    \   messages received from the same peer (see [RFC3971]).  A more\n   detailed\
    \ analysis of the possible attacks related to the Timestamp\n   option is described\
    \ in Section 6.3 of [RFC5909].\n"
- title: 9.  IANA Considerations
  contents:
  - "9.  IANA Considerations\n   IANA has allocated the following a new IPv6 Neighbor\
    \ Discovery Option\n   type for the PS option, as 32.  The value has been allocated\
    \ from the\n   namespace specified in the IANA \"IPv6 Neighbor Discovery Option\n\
    \   Formats\" registry located at\n   http://www.iana.org/assignments/icmpv6-parameters.\n\
    \   IANA has also allocated the following new 128-bit value under the\n   \"Cryptographically\
    \ Generated Addresses (CGA) Message Type Name Space\"\n   registry [RFC3972]:\n\
    \      0x09F5 2BE5 3B62 4C76 CB96 4E7F CDC9 2804.\n"
- title: 10.  Acknowledgements
  contents:
  - "10.  Acknowledgements\n   The text has benefited from feedback provided by Jari\
    \ Arkko, Jean-\n   Michel Combes, Roque Gagliano, Tony Cheneau, Marcelo Bagnulo,\
    \ Alexey\n   Melnikov, Sandra Murphy, and Sean Turner.\n   The work of Alberto\
    \ Garcia-Martinez was supported in part by the T2C2\n   project (TIN2008-06739-C04-01,\
    \ granted by the Spanish Science and\n   Innovation Ministry).\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC3971]  Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,\n\
    \              \"SEcure Neighbor Discovery (SEND)\", RFC 3971, March 2005.\n \
    \  [RFC3972]  Aura, T., \"Cryptographically Generated Addresses (CGA)\",\n   \
    \           RFC 3972, March 2005.\n   [RFC4389]  Thaler, D., Talwar, M., and C.\
    \ Patel, \"Neighbor Discovery\n              Proxies (ND Proxy)\", RFC 4389, April\
    \ 2006.\n   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,\n\
    \              \"Neighbor Discovery for IP version 6 (IPv6)\", RFC 4861,\n   \
    \           September 2007.\n   [RFC4862]  Thomson, S., Narten, T., and T. Jinmei,\
    \ \"IPv6 Stateless\n              Address Autoconfiguration\", RFC 4862, September\
    \ 2007.\n   [RFC5213]  Gundavelli, S., Ed., Leung, K., Devarapalli, V.,\n    \
    \          Chowdhury, K., and B. Patil, \"Proxy Mobile IPv6\",\n             \
    \ RFC 5213, August 2008.\n   [RFC6275]  Perkins, C., Ed., Johnson, D., and J.\
    \ Arkko, \"Mobility\n              Support in IPv6\", RFC 6275, July 2011.\n \
    \  [RFC6494]  Gagliano, R., Krishnan, S., and A. Kukec, \"Certificate\n      \
    \        Profile and Certificate Management for SEcure Neighbor\n            \
    \  Discovery (SEND)\", RFC 6494, February 2012.\n   [RSA]      RSA Laboratories,\
    \ \"PKCS #1 v2.1: RSA Cryptography\n              Standard\", June 2002.\n   [SHA1]\
    \     National Institute of Standards and Technology, \"Secure\n             \
    \ Hash Standard\", FIPS PUB 180-1 , April 1995.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [RFC3756]  Nikander, P., Ed., Kempf, J., and\
    \ E. Nordmark, \"IPv6\n              Neighbor Discovery (ND) Trust Models and\
    \ Threats\",\n              RFC 3756, May 2004.\n   [RFC5909]  Combes, J-M., Krishnan,\
    \ S., and G. Daley, \"Securing\n              Neighbor Discovery Proxy: Problem\
    \ Statement\", RFC 5909,\n              July 2010.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Suresh Krishnan\n   Ericsson\n   8400 Decarie Blvd.\n\
    \   Town of Mount Royal, QC\n   Canada\n   Phone: +1 514 345 7900 x42871\n   EMail:\
    \ suresh.krishnan@ericsson.com\n   Julien Laganier\n   Juniper Networks\n   1094\
    \ North Mathilda Avenue\n   Sunnyvale, CA  94089\n   USA\n   Phone: +1 408 936\
    \ 0385\n   EMail: julien.ietf@gmail.com\n   Marco Bonola\n   Rome Tor Vergata\
    \ University\n   Via del Politecnico, 1\n   Rome  I-00133\n   Italy\n   Phone:\n\
    \   EMail: marco.bonola@gmail.com\n   Alberto Garcia-Martinez\n   U. Carlos III\
    \ de Madrid\n   Av. Universidad 30\n   Leganes, Madrid  28911\n   Spain\n   Phone:\
    \ +34 91 6248782\n   EMail: alberto@it.uc3m.es\n   URI:   http://www.it.uc3m.es/\n"
