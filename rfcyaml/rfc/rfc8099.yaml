- title: __initial_text__
  contents:
  - '                     OSPF Topology-Transparent Zone

    '
- title: Abstract
  contents:
  - "Abstract\n   This document presents a Topology-Transparent Zone (TTZ) in an OSPF\n\
    \   area.  A TTZ comprises a group of routers and a number of links\n   connecting\
    \ these routers.  Any router outside of the zone is not\n   aware of the zone.\
    \  A TTZ hides the internal topology of the TTZ from\n   the outside.  It does\
    \ not directly advertise any internal information\n   about the TTZ to a router\
    \ outside of the TTZ.  The information about\n   the links and routers such as\
    \ a link down inside the TTZ is not\n   advertised to any router outside of the\
    \ TTZ.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for examination, experimental implementation, and\n   evaluation.\n\
    \   This document defines an Experimental Protocol for the Internet\n   community.\
    \  This document is a product of the Internet Engineering\n   Task Force (IETF).\
    \  It represents the consensus of the IETF\n   community.  It has received public\
    \ review and has been approved for\n   publication by the Internet Engineering\
    \ Steering Group (IESG).  Not\n   all documents approved by the IESG are a candidate\
    \ for any level of\n   Internet Standard; see Section 2 of RFC 7841.\n   Information\
    \ about the current status of this document, any errata,\n   and how to provide\
    \ feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc8099.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2017 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   4\n   2.  Terminology . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .   4\n   3.  Conventions Used in This Document . . . . . . . . . . .\
    \ . . .   5\n   4.  Requirements  . . . . . . . . . . . . . . . . . . . . . .\
    \ . .   5\n   5.  Topology-Transparent Zone . . . . . . . . . . . . . . . . .\
    \ .   5\n     5.1.  Overview of Topology-Transparent Zone . . . . . . . . . .\
    \   5\n     5.2.  TTZ Example . . . . . . . . . . . . . . . . . . . . . . .  \
    \ 6\n   6.  Extensions to OSPF Protocols  . . . . . . . . . . . . . . . .   8\n\
    \     6.1.  General Format of TTZ LSA . . . . . . . . . . . . . . . .   8\n  \
    \   6.2.  TTZ ID TLV  . . . . . . . . . . . . . . . . . . . . . . .   9\n    \
    \ 6.3.  TTZ Router TLV  . . . . . . . . . . . . . . . . . . . . .   9\n     6.4.\
    \  TTZ Options TLV . . . . . . . . . . . . . . . . . . . . .  10\n     6.5.  Link\
    \ Scope TTZ LSA  . . . . . . . . . . . . . . . . . . .  12\n   7.  Constructing\
    \ LSAs for TTZ . . . . . . . . . . . . . . . . . .  12\n     7.1.  TTZ Migration\
    \ Process . . . . . . . . . . . . . . . . . .  13\n   8.  Establishing Adjacencies\
    \  . . . . . . . . . . . . . . . . . .  14\n     8.1.  Discovery of TTZ Neighbors\
    \  . . . . . . . . . . . . . . .  14\n     8.2.  Adjacency between TTZ Edge and\
    \ TTZ-External Router  . . .  17\n   9.  Advertisement of LSAs . . . . . . . .\
    \ . . . . . . . . . . . .  17\n     9.1.  Advertisement of LSAs within TTZ  .\
    \ . . . . . . . . . . .  17\n     9.2.  Advertisement of LSAs through TTZ . .\
    \ . . . . . . . . . .  18\n   10. Computation of Routing Table  . . . . . . .\
    \ . . . . . . . . .  18\n   11. Operations  . . . . . . . . . . . . . . . . .\
    \ . . . . . . . .  18\n     11.1.  Configuring TTZ  . . . . . . . . . . . . .\
    \ . . . . . . .  18\n     11.2.  Migration to TTZ . . . . . . . . . . . . . .\
    \ . . . . . .  19\n     11.3.  Adding a Router into TTZ . . . . . . . . . . .\
    \ . . . . .  21\n   12. Manageability Considerations  . . . . . . . . . . . .\
    \ . . . .  22\n   13. Security Considerations . . . . . . . . . . . . . . . .\
    \ . . .  22\n   14. IANA Considerations . . . . . . . . . . . . . . . . . . .\
    \ . .  22\n   15. References  . . . . . . . . . . . . . . . . . . . . . . . .\
    \ .  23\n     15.1.  Normative References . . . . . . . . . . . . . . . . . .\
    \  23\n     15.2.  Informative References . . . . . . . . . . . . . . . . .  23\n\
    \   Appendix A.  Prototype Implementation . . . . . . . . . . . . . .  24\n  \
    \   A.1.  What Is Implemented and Tested  . . . . . . . . . . . . .  24\n    \
    \ A.2.  Implementation Experience . . . . . . . . . . . . . . . .  25\n   Acknowledgements\
    \  . . . . . . . . . . . . . . . . . . . . . . . .  26\n   Contributors  . . .\
    \ . . . . . . . . . . . . . . . . . . . . . . .  26\n   Authors' Addresses  .\
    \ . . . . . . . . . . . . . . . . . . . . . .  27\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Networks expand as business grows and traffic increases.\
    \  For\n   scalability and manageability, a hierarchical network architecture\
    \ is\n   usually deployed in OSPF networks by regrouping routers into areas,\n\
    \   which is often challenging and causes service interruptions.\n   At first,\
    \ reorganizing a network from one area into multiple areas or\n   from a number\
    \ of existing areas into even more areas is a very\n   challenging and time-consuming\
    \ task since it involves significant\n   network architecture changes.  Considering\
    \ the one area case,\n   originally the network has only one area, which is the\
    \ backbone.\n   This original backbone area will be reorganized into a new backbone\n\
    \   and a number of non-backbone areas.  In general, each of the\n   non-backbone\
    \ areas is connected to the new backbone area through the\n   Area Border Routers\
    \ (ABRs) between the non-backbone and the backbone\n   area (refer to RFC 2328,\
    \ Section 3).  It demands careful redesigning\n   of network topology in advance\
    \ to guarantee backbone area continuity\n   and non-backbone-area reachability,\
    \ and it requires significant\n   modifications of configurations on many routers\
    \ to ensure consistent\n   routing.\n   Second, the services carried by the network\
    \ may be interrupted while\n   the network is being reorganized from one area\
    \ into multiple areas or\n   from a number of existing areas into even more areas\
    \ since every OSPF\n   interface with an area change is going down with its old\
    \ area and\n   then up with a new area.\n   This document presents a Topology-Transparent\
    \ Zone (TTZ) in an OSPF\n   area and describes extensions to OSPFv2 for supporting\
    \ the TTZ, which\n   is scalable and resolves the issues above.  A TTZ hides the\
    \ internal\n   topology of the TTZ from the outside.  It does not directly advertise\n\
    \   any internal information about the TTZ to any router outside of the\n   TTZ.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   TTZ link or TTZ-internal link:\n       A link whose ends\
    \ are within a single TTZ.\n   TTZ-internal router:\n       A router whose links\
    \ are TTZ-internal links inside a single TTZ.\n   TTZ-external router:\n     \
    \  A router outside of a TTZ that has no TTZ-internal links.\n   TTZ-external\
    \ link:\n       A link not configured to be within a TTZ.\n   TTZ edge router:\n\
    \       A router is called a TTZ edge router if some, but not all, of its\n  \
    \     links are within a single TTZ.\n   TTZ router:\n       A TTZ-internal router\
    \ or a TTZ edge router.\n"
- title: 3.  Conventions Used in This Document
  contents:
  - "3.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 4.  Requirements
  contents:
  - "4.  Requirements\n   A Topology-Transparent Zone may be deployed to resolve some\
    \ critical\n   issues in existing networks and future networks.  The requirements\n\
    \   for a TTZ are listed as follows:\n   o  Routers outside a TTZ MUST NOT require\
    \ any changes to operate with\n      the TTZ.\n   o  A TTZ MUST be enclosed in\
    \ a single area.\n   o  A TTZ MUST hide the topology of the TTZ from any router\
    \ outside of\n      the TTZ.\n"
- title: 5.  Topology-Transparent Zone
  contents:
  - '5.  Topology-Transparent Zone

    '
- title: 5.1.  Overview of Topology-Transparent Zone
  contents:
  - "5.1.  Overview of Topology-Transparent Zone\n   A Topology-Transparent Zone is\
    \ identified by a TTZ identifier (ID),\n   and it consists of a group of routers\
    \ and a number of links\n   connecting the routers.  A TTZ MUST be contained within\
    \ an OSPF area.\n   A TTZ ID is a 32-bit number that is unique for identifying\
    \ a TTZ.\n   The TTZ ID SHOULD NOT be 0 in order to avoid confusion with Area\
    \ 0.\n   The same TTZ ID MUST be configured on the routers and/or links that\n\
    \   make up a specific instance of a TTZ.  All TTZ instances in an OSPF\n   area\
    \ MUST be unique.\n   In addition to having similar functions of an OSPF area,\
    \ an OSPF TTZ\n   makes some improvements on an OSPF area, which include:\n  \
    \ o  An OSPF TTZ represents a set of TTZ edge routers, connected by a\n      full\
    \ mesh of virtual connections between them.\n   o  Non-TTZ link-state information\
    \ is handled as normal.  TTZ routers\n      receive the link-state information\
    \ about the topology outside of\n      the TTZ, store the information, and flood\
    \ the information through\n      the TTZ to the routers outside of the TTZ.\n"
- title: 5.2.  TTZ Example
  contents:
  - "5.2.  TTZ Example\n   The figure below shows an area containing a TTZ: TTZ 600.\n\
    \                 TTZ 600                       ---- TTZ-Internal Link\n     \
    \              \\                           ==== Normal Link\n     Area X    \
    \     \\ ^~^~^~^~^~^~^~^~^~^~^~^~\n                     (                    \
    \    )\n    ===[R15]========(==[T61]----[T81]---[T63]==)======[R29]===\n     \
    \   ||         (   |    \\          /    |   )       ||\n        ||         (\
    \   |     \\        /     |   )       ||\n        ||         ( [T75]    \\   \
    \   /      |   )       ||\n        ||         (   |    ___\\    /       |   )\
    \       ||\n        ||         (   |   /   [T71]     [T79]  )       ||\n     \
    \   ||         (   | [T73] /    \\       |   )       ||\n        ||         (\
    \   |      /      \\      |   )       ||\n        ||         (   |     /     \
    \   \\     |   )       ||\n        ||         (   |    /          \\    |   )\
    \       ||\n    ===[R17]========(==[T65]---[T77]----[T67]==)======[R31]===\n \
    \        \\\\          (//                    \\\\)       //\n          ||   \
    \      //v~v~v~v~v~v~v~v~v~v~v~\\\\      ||\n          ||        //          \
    \              \\\\     ||\n          ||       //                          \\\\\
    \    ||\n           \\\\     //                            \\\\  //\n       ======[R23]==============================[R25]=====\n\
    \             //                                     \\\\\n            //    \
    \                                   \\\\\n   All the routers in the figure are\
    \ in area X.  Routers with T (i.e.,\n   T61, T63, T65, T67, T71, T73, T75, T77,\
    \ T79, and T81) are also in TTZ\n   600, which contains the TTZ-internal links\
    \ connecting them.  To\n   create a TTZ, we need to configure it (refer to Section\
    \ 11).\n   There are two types of routers in a TTZ: TTZ-internal and TTZ edge\n\
    \   routers.  TTZ 600 has four TTZ edge routers: T61, T63, T65, and T67.\n   Each\
    \ of them has at least one adjacent router in TTZ 600 and one\n   adjacent router\
    \ outside of TTZ 600.  For instance, router T61 is a\n   TTZ edge router since\
    \ it has an adjacent router, R15, outside of TTZ\n   600 and three adjacent routers\
    \ T71, T75, and T81 in TTZ 600.\n   In addition, TTZ 600 comprises six TTZ-internal\
    \ routers: T71, T73,\n   T75, T77, T79, and T81.  Each of them has all its adjacent\
    \ routers in\n   TTZ 600.  For instance, router T71 is a TTZ-internal router since\
    \ its\n   adjacent routers, T61, T63, T65, T67, and T73, are all in TTZ 600.\n\
    \   It should be noted that, by definition, a TTZ-internal router cannot\n   also\
    \ be an ABR.\n   A TTZ hides the internal topology of the TTZ from the outside.\
    \  It\n   does not directly advertise any internal information about the TTZ to\n\
    \   any router outside of the TTZ.\n   For instance, TTZ 600 does not send the\
    \ information about TTZ-\n   internal router T71 to any router outside of TTZ\
    \ 600; it does not\n   send the information about the link between TTZ routers\
    \ T61 and T71\n   to any router outside of TTZ 600.\n   The figure below illustrates\
    \ area X from the point of view of a\n   router outside of TTZ 600 after TTZ 600\
    \ is created.\n     Area X                                    ==== Normal Link\n\
    \    ===[R15]===========[T61]=========[T63]=========[R29]===\n        ||     \
    \        ||  \\\\      //   ||           ||\n        ||             ||   \\\\\
    \    //    ||           ||\n        ||             ||    \\\\  //     ||     \
    \      ||\n        ||             ||     \\\\//      ||           ||\n       \
    \ ||             ||      //\\      ||           ||\n        ||             ||\
    \     // \\\\     ||           ||\n        ||             ||    //   \\\\    ||\
    \           ||\n        ||             ||   //     \\\\   ||           ||\n  \
    \      ||             ||  //       \\\\  ||           ||\n    ===[R17]===========[T65]=========[T67]=========[R31]===\n\
    \         \\\\           //                  \\\\        //\n          ||    \
    \     //                    \\\\      ||\n          ||        //             \
    \         \\\\     ||\n          ||       //                        \\\\    ||\n\
    \           \\\\     //                          \\\\  //\n       ======[R23]============================[R25]=====\n\
    \             //                                   \\\\\n            //      \
    \                               \\\\\n   From a router outside of the TTZ, a TTZ\
    \ is seen as the TTZ edge\n   routers connected to each other.  For instance,\
    \ router R15 sees that\n   T61, T63, T65, and T67 are connected to each other.\n\
    \   In addition, a router outside of the TTZ sees TTZ edge routers having\n  \
    \ normal connections to the routers outside of the TTZ.  For example,\n   router\
    \ R15 sees that T61, T63, T65, and T67 have the normal\n   connections to R15;\
    \ R29; R17 and R23; and R25 and R31, respectively.\n"
- title: 6.  Extensions to OSPF Protocols
  contents:
  - "6.  Extensions to OSPF Protocols\n   The link-state information about a TTZ includes\
    \ router Link-State\n   Advertisements (LSAs), which can be contained and advertised\
    \ in\n   opaque LSAs [RFC5250] within the TTZ.  Some control information\n   regarding\
    \ a TTZ can also be contained and advertised in opaque LSAs\n   within the TTZ.\
    \  These opaque LSAs are called TTZ opaque LSAs or TTZ\n   LSAs for short.\n"
- title: 6.1.  General Format of TTZ LSA
  contents:
  - "6.1.  General Format of TTZ LSA\n   The following is the general format of a\
    \ TTZ LSA.  It has a Link-\n   State (LS) Type = 10/9 and TTZ LSA Type, and it\
    \ contains a number of\n   TLVs.\n       0                   1               \
    \    2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            LS age             |     Options   | LS Type = 10/9|\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |TTZ\
    \ LSA Type(9)|                   Instance ID                 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                      Advertising Router                       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                      LS Sequence Number                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |         LS checksum           |           Length              |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      ~   \
    \                           TLVs                             ~\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   There are three TTZ LSAs of LS Type 10 defined:\n   o  TTZ router LSA: a TTZ\
    \ LSA containing a TTZ ID TLV and a TTZ Router\n      TLV.\n   o  TTZ control\
    \ LSA: a TTZ LSA containing a TTZ ID TLV and a TTZ\n      Options TLV.\n   o \
    \ TTZ indication LSA: a TTZ LSA containing a TTZ ID TLV with E = 0,\n      which\
    \ indicates that the router originating this LSA is a TTZ-\n      internal router.\n\
    \   There is one TTZ LSA of LS Type 9:\n   o  TTZ discovery LSA: a TTZ LSA containing\
    \ a TTZ ID TLV and an\n      optional TTZ Options TLV.\n"
- title: 6.2.  TTZ ID TLV
  contents:
  - "6.2.  TTZ ID TLV\n   A TTZ ID TLV has the following format.  It contains a TTZ\
    \ ID (refer\n   to Section 5.1) and some flags.  It has the TLV-Length of 8 octets.\n\
    \       0                   1                   2                   3\n      \
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      TTZ ID TLV Type (1)      |        TLV-Length (8)         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                            TTZ ID                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                 Reserved (MUST be zero)                   |E|Z|\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      E\
    \ = 1: Indicating a router is a TTZ edge router\n      Z = 1: Indicating a router\
    \ has migrated to TTZ\n   When a TTZ router originates a TTZ LSA containing a\
    \ TTZ ID TLV, it\n   MUST set flag E to 1 in the TTZ ID TLV if it is a TTZ edge\
    \ router and\n   to 0 if it is a TTZ-internal router.  It MUST set flag Z to 1\
    \ after\n   it has migrated to TTZ and to 0 before it migrates to TTZ or after\
    \ it\n   rolls back from TTZ (refer to Section 6.4).\n"
- title: 6.3.  TTZ Router TLV
  contents:
  - "6.3.  TTZ Router TLV\n   The format of a TTZ Router TLV is as follows.  It has\
    \ the same\n   content as a standard OSPF router LSA (RFC 2328) with the following\n\
    \   modifications.\n       0                   1                   2         \
    \          3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      TTZ RT TLV Type (2)      |          TLV-Length           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     0   |V|E|B|        0      |            # links            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                          Link ID                              |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Link Data                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |     # TOS     |            metric             |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      ~\
    \                              ...                              ~\n      Note:\
    \ TOS = Type of Service\n   For a router link, the existing 8-bit Link Type field\
    \ for a router\n   link is split into two fields as follows:\n         0   1 \
    \  2   3   4   5   6   7\n       +---+---+---+---+---+---+---+---+\n       | I\
    \ |         Type-1            |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  \
    \     I bit flag:\n         1: Router link is a TTZ-internal link.\n         0:\
    \ Router link is a TTZ-external link.\n       Type-1: The kind of the link.  The\
    \ values for Type-1 are the same\n               as those for Type defined in\
    \ RFC 2328, Section 12.4.1.\n   The Link Type field is 8 bits and the values 128-255\
    \ of the field are\n   reserved (refer to [RFC4940]), which allows the reuse of\
    \ the bottom 7\n   bits to indicate the type of TTZ-internal or external link.\n"
- title: 6.4.  TTZ Options TLV
  contents:
  - "6.4.  TTZ Options TLV\n   The format of a TTZ Options TLV is as follows.\n  \
    \     0                   1                   2                   3\n       0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |      TTZ OP TLV Type (3)      |          TLV-Length           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \  OP |                 Reserved (MUST be zero)                 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \       OP Value    Meaning (Operation)\n       0x001 (T):  Advertising TTZ Topology\
    \ Information for Migration\n       0x010 (M):  Migrating to TTZ\n       0x011\
    \ (N):  Advertising Normal Topology Information for Rollback\n       0x100 (R):\
    \  Rolling Back from TTZ\n   An OP field of 3 bits is defined.  It may have a\
    \ value of 0x001 for\n   T, 0x010 for M, 0x011 for N, or 0x100 for R, which indicates\
    \ one of\n   the four operations above.  When any of the other values is received,\n\
    \   it is ignored.\n   Advertising TTZ Topology Information for Migration (T):\n\
    \       After a user configures a TTZ router to advertise TTZ topology\n     \
    \  information, advertising TTZ topology information for migration\n       is\
    \ triggered.  The TTZ router originates a TTZ control LSA having\n       a TTZ\
    \ Options TLV with OP for T.  It also originates its other\n       TTZ LSA such\
    \ as a TTZ router LSA or TTZ indication LSA.  When\n       another TTZ router\
    \ receives the LSA with OP for T, it originates\n       its TTZ LSA as described\
    \ in Section 7.\n   Migrating to TTZ (M):\n       After a user configures a TTZ\
    \ router to migrate to TTZ, migrating\n       to TTZ is triggered.  The TTZ router\
    \ originates a TTZ control LSA\n       having a TTZ Options TLV with OP for M\
    \ and migrates to TTZ.  When\n       another TTZ router receives the LSA with\
    \ OP for M, it also\n       migrates to TTZ.  When a router migrates to TTZ, it\
    \ computes\n       routes using the TTZ topology and the topology outside of the\n\
    \       TTZ.  For a TTZ-internal router, it also updates its TTZ\n       indication\
    \ LSA with Z = 1.  For a TTZ edge router, it updates its\n       TTZ router LSA\
    \ with Z = 1 and its router LSA for virtualizing the\n       TTZ.  A TTZ router\
    \ determines whether it is internal or edge\n       based on configurations (refer\
    \ to Section 11.1).\n   Advertising Normal Topology Information for Rollback (N):\n\
    \       After a user configures a TTZ router to advertise normal topology\n  \
    \     information, advertising Normal topology information for rollback\n    \
    \   is triggered.  The TTZ router originates a TTZ control LSA having\n      \
    \ a TTZ Options TLV with OP for N.  It also advertises its normal\n       LSAs\
    \ such as its normal router LSA and stops advertising its\n       other TTZ LSAs.\
    \  When another TTZ router receives the LSA with OP\n       for N, it forwards\
    \ the LSA, advertises its normal LSAs, and stops\n       advertising its TTZ LSAs.\n\
    \   Rolling back from TTZ (R):\n       After a user configures a TTZ router to\
    \ roll back from TTZ,\n       rolling back from TTZ is triggered.  The TTZ router\
    \ originates a\n       TTZ control LSA having a TTZ Options TLV with OP for R\
    \ and rolls\n       back from TTZ.  When another TTZ router receives the LSA with\
    \ OP\n       for R, it also rolls back from TTZ.\n   After a TTZ router originates\
    \ a TTZ control LSA in response to a\n   configuration described above to control\
    \ TTZ, it flushes the TTZ\n   control LSA if OP in the LSA is set for the configuration\
    \ and the\n   configuration is removed.\n"
- title: 6.5.  Link Scope TTZ LSA
  contents:
  - "6.5.  Link Scope TTZ LSA\n   A TTZ LSA of LS Type 9 has the following format.\n\
    \       0                   1                   2                   3\n      \
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            LS age             |     Options   | LS Type = 9   |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |TTZ\
    \ LSA Type(9)|                   Instance ID                 |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                      Advertising Router                       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                      LS Sequence Number                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |         LS checksum           |           Length              |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      ~   \
    \                        TTZ ID TLV                          ~\n      +---------------------------------------------------------------+\n\
    \      |                                                               |\n   \
    \   ~                        (TTZ Options TLV)                      ~\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   It contains a mandatory TTZ ID TLV, which may be followed by an\n   optional\
    \ TTZ Options TLV.  It is used to discover a TTZ neighbor.\n"
- title: 7.  Constructing LSAs for TTZ
  contents:
  - "7.  Constructing LSAs for TTZ\n   For a TTZ, its topology is represented by the\
    \ LSAs generated by its\n   TTZ routers for the link states in the TTZ, which\
    \ include TTZ router\n   LSAs by TTZ edge routers, TTZ indication LSAs by TTZ-internal\n\
    \   routers, normal router LSAs, and network LSAs.  The TTZ router LSAs\n   and\
    \ TTZ indication LSAs MUST be generated after advertising TTZ\n   topology information\
    \ for migration is triggered.\n   A TTZ edge router generates a TTZ router LSA\
    \ that has a TTZ ID TLV\n   and a TTZ Router TLV.  The former includes the ID\
    \ of the TTZ to which\n   the router belongs and flag E is set to 1, which indicates\
    \ the\n   originator of the LSA is a TTZ edge router.  The TTZ Router TLV\n  \
    \ contains the TTZ-external links to the routers outside of the TTZ and\n   the\
    \ TTZ-internal links to the routers inside of the TTZ as described\n   in Section\
    \ 6.  The TTZ router LSA containing this TLV is constructed\n   and advertised\
    \ within the TTZ.\n   A TTZ-internal router generates a TTZ indication LSA that\
    \ has a TTZ\n   ID TLV containing the ID of the TTZ to which the router belongs\
    \ and\n   flag E is set to 0, which indicates the originator of the LSA is a\n\
    \   TTZ-internal router.  For a TTZ-internal router, its regular router\n   LSA\
    \ is still generated.  If a TTZ router is a Designated Router (DR),\n   it originates\
    \ its regular network LSA.\n   After receiving a trigger to migrate to TTZ such\
    \ as a TTZ control LSA\n   with OP for M, a TTZ edge router MUST originate its\
    \ normal router LSA\n   for virtualizing a TTZ, which comprises three groups of\
    \ links in\n   general.\n   The first group is the router links connecting the\
    \ TTZ-external\n   routers.  These router links are normal router links.  There\
    \ is a\n   router link for every adjacency between this TTZ edge router and a\n\
    \   TTZ-external router.\n   The second group is the \"virtual\" router links\
    \ connecting to the\n   other TTZ edge routers.  For each of the other TTZ edge\
    \ routers,\n   there is a corresponding point-to-point (P2P) router link to it\
    \ from\n   this TTZ edge router.  The cost of the link is the cost of the\n  \
    \ shortest path from this TTZ edge router to the other TTZ edge router\n   within\
    \ the TTZ.\n   In addition, the LSA may contain a third group of links, which\
    \ are\n   the stub links for the loopback addresses inside the TTZ to be\n   accessed\
    \ by nodes outside of the TTZ.\n"
- title: 7.1.  TTZ Migration Process
  contents:
  - "7.1.  TTZ Migration Process\n   After migration to TTZ is triggered, a TTZ router\
    \ computes routes\n   using its TTZ topology (refer to Section 10), and a TTZ\
    \ edge router\n   originates its normal router LSA for virtualizing the TTZ in\
    \ two\n   steps:\n   Step 1:  The router updates its router LSA by adding a P2P\
    \ link to\n      each of the other known edge routers in the TTZ and also by adding\n\
    \      the stub links for the loopback addresses in the TTZ to be\n      accessed\
    \ outside of the TTZ according to configuration policies of\n      operators.\n\
    \   Step 2:  After MaxLSAGenAdvTime (0.3 s) or sr-time + MaxLSAAdvTime\n     \
    \ (0.1 s), it removes the TTZ links from its router LSA, where\n      sr-time\
    \ is the time from updating its router LSA to receiving the\n      ack for its\
    \ router LSA and receiving the updated router LSAs\n      originated by the other\
    \ TTZ edge routers.  In other words, it\n      removes the TTZ links from its\
    \ router LSA after sending its\n      updated router LSA and receiving the updated\
    \ router LSAs\n      originated by the other TTZ edge routers for MaxLSAAdvTime\
    \ or\n      after sending its updated router LSA for MaxLSAGenAdvTime.\n     \
    \ MaxLSAAdvTime and MaxLSAGenAdvTime SHOULD be set to 100 ms and 300\n      ms,\
    \ respectively, but MAY be configurable.  The former is the\n      maximum time\
    \ for an LSA to be advertised to all the routers in an\n      area.  The latter\
    \ is the maximum time for all TTZ router LSAs to\n      be generated by all TTZ\
    \ edge routers and advertised to all the\n      routers in an area after a first\
    \ TTZ router LSA is generated.\n   This is to avoid a possible route down or change\
    \ in a TTZ-external\n   router while the TTZ is being virtualized.  If each TTZ\
    \ edge router\n   originates its router LSA by adding its P2P links to the other\
    \ TTZ\n   edge routers and removing its TTZ links in one step, a route taking\
    \ a\n   path through the TTZ in the TTZ-external router may be down or\n   changed\
    \ before all the router LSAs generated by the TTZ edge routers\n   reach the TTZ-external\
    \ router.  When the TTZ-external router computes\n   routes with some router LSAs\
    \ originated by the TTZ edge routers,\n   bidirectional checks for some of the\
    \ P2P links will fail.  Thus, the\n   route taking the path through the shortest\
    \ path for the P2P link\n   failing the bidirectional check will be down or changed.\n\
    \   To roll back from a TTZ smoothly after receiving a trigger to roll\n   back\
    \ from TTZ, a TTZ edge router MUST originate its normal router LSA\n   in the\
    \ above two steps in a reverse way.\n   Step 1:  Initially, it updates its normal\
    \ router LSA by adding the\n      normal links for the links configured as TTZ\
    \ links into the LSA.\n   Step 2:  It then removes the P2P links to the other\
    \ edge routers of\n      the TTZ for virtualizing the TTZ and the stub links for\
    \ the\n      loopback addresses from its updated router LSA after sending its\n\
    \      updated router LSA and receiving the updated router LSAs\n      originated\
    \ by the other TTZ edge routers for MaxLSAAdvTime or\n      after sending its\
    \ updated router LSA for MaxLSAGenAdvTime.\n"
- title: 8.  Establishing Adjacencies
  contents:
  - "8.  Establishing Adjacencies\n   This section describes the TTZ adjacencies.\n"
- title: 8.1.  Discovery of TTZ Neighbors
  contents:
  - "8.1.  Discovery of TTZ Neighbors\n   When two routers A and B are connected by\
    \ a P2P link and have a\n   normal adjacency, they TTZ discover each other through\
    \ a TTZ LSA of\n   LS Type 9 with a TTZ ID TLV.  We call this LSA D-LSA for short.\n\
    \   If two ends of the link have different TTZ IDs or only one end is\n   configured\
    \ with a TTZ ID, TTZ adjacency over the link MUST NOT be\n   \"formed\".\n   If\
    \ two ends of the link have the same TTZ ID and Z flag value, A and\n   B are\
    \ TTZ neighbors.  The following is a sequence of events related\n   to TTZ for\
    \ this case.\n           A                                         B\n      Configure\
    \ TTZ                             Configure TTZ\n                          D-LSA\
    \ (TTZ ID=100)\n                        ----------------------> Same TTZ ID and\
    \ Z\n                                                A is B's TTZ Neighbor\n \
    \                         D-LSA (TTZ ID=100)\n      Same TTZ ID and Z <----------------------\n\
    \      B is A's TTZ Neighbor\n   A sends B a D-LSA with TTZ ID after the TTZ is\
    \ configured on it.  B\n   sends A a D-LSA with TTZ ID after the TTZ is configured\
    \ on it.\n   When A receives the D-LSA from B and determines they have the same\n\
    \   TTZ ID and Z flag value, B is A's TTZ neighbor.  A also sends B all\n   the\
    \ TTZ LSAs it has and originates its TTZ LSA when one of the\n   following conditions\
    \ is met.\n   o  Z = 0 and there is a TTZ LSA with OP for T.\n   o  Z = 1.\n \
    \  B is symmetric to A and acts similarly to A.\n   If two ends of the link have\
    \ the same TTZ ID but the Z flags are\n   different, a TTZ adjacency over the\
    \ link MUST be \"formed\" in the\n   following steps.  Suppose that A has migrated\
    \ to TTZ and B has not\n   (i.e., flag Z in A's D-LSA is 1, and flag Z in B's\
    \ D-LSA is 0).\n           A                                          B\n    \
    \  Configure TTZ                              Configure TTZ\n                \
    \         D-LSA(TTZ ID=100,Z=1)\n                        ---------------------->\
    \ Same TTZ ID, but\n                                                different\
    \ Z\n                                                A is B's TTZ Neighbor\n \
    \                        D-LSA(TTZ ID=100,Z=0)\n      Same TTZ ID, but <----------------------\n\
    \      different Z\n      B is A's TTZ Neighbor\n                            \
    \   TTZ LSAs\n                       ----------------------->\n              \
    \                 TTZ LSAs\n                       <-----------------------\n\
    \   When A receives the D-LSA from B and determines they have the same\n   TTZ\
    \ ID but its Z = 1 and B's Z = 0, A sends B all the TTZ LSAs it has\n   and triggers\
    \ B to migrate to TTZ.  A updates and sends B its D-LSA by\n   adding a TTZ Options\
    \ TLV with OP for M after sending B all the TTZ\n   LSAs.\n                  \
    \       D-LSA(TTZ ID=100,OP=M)\n      Add TTZ Options  ----------------------->\
    \ Migrate to TTZ\n      TLV with OP for M\n                         D-LSA(TTZ\
    \ ID=100,Z=1)  Migrated to TTZ\n                       <-----------------------\
    \ Set Z=1\n                         D-LSA(TTZ ID=100,Z=1)\n      Remove      \
    \     ----------------------->\n      TTZ Options TLV\n   When B receives the\
    \ D-LSA from A and determines they have the same\n   TTZ ID but its Z = 0 and\
    \ A's Z = 1, B sends A all the TTZ LSAs it\n   has.\n   When B receives the D-LSA\
    \ from A with OP for M, it starts to migrate\n   to TTZ.  B updates and advertises\
    \ its LSAs as needed.\n   After receiving B's D-LSA with Z = 1, A updates and\
    \ sends B its D-LSA\n   by removing the TTZ Options TLV.  It also updates and\
    \ advertises its\n   LSAs as needed.\n   When a number of routers connected through\
    \ a broadcast link have\n   normal adjacencies among them, they also TTZ discover\
    \ each other\n   through D-LSAs.  The Designated Router (DR) for the link MUST\
    \ \"form\"\n   TTZ adjacencies with the other routers if all the routers attached\
    \ to\n   the link have the same TTZ ID configured on the connections to the\n\
    \   link.  Otherwise, the DR MUST NOT \"form\" any TTZ adjacency with any\n  \
    \ router attached to the link.\n   When a number of routers connected through\
    \ a broadcast link have TTZ\n   adjacencies among them, if a misconfigured router\
    \ is introduced on\n   the broadcast link, the DR for the link MUST NOT \"form\"\
    \ any TTZ\n   adjacency with this misconfigured router.\n   For routers connected\
    \ via a link without any adjacency among them,\n   they TTZ discover each other\
    \ through D-LSAs in the same way as\n   described above after they form a normal\
    \ adjacency.\n   A TTZ adjacency over a link MUST be removed when one of the following\n\
    \   events happens.\n   o  TTZ ID on one end of the link is changed to a different\
    \ one.\n   o  TTZ ID on one end of the link is removed.\n   o  The D-LSA is not\
    \ received after the D-LSA-MAX-RETRANSMIT-TIME or\n      is explicitly flushed.\
    \  The D-LSA-MAX-RETRANSMIT-TIME SHOULD be\n      set to 60 minutes, but MAY be\
    \ configurable.\n   o  Normal adjacency over the link is down.\n   When the TTZ\
    \ ID on one end of the link is removed, the corresponding\n   D-LSA is flushed.\n"
- title: 8.2.  Adjacency between TTZ Edge and TTZ-External Router
  contents:
  - "8.2.  Adjacency between TTZ Edge and TTZ-External Router\n   A TTZ edge router\
    \ forms an adjacency with any TTZ-external router to\n   which it is connected.\n\
    \   When the TTZ edge router synchronizes its link-state database with\n   the\
    \ TTZ-external router, it sends the TTZ-external router the\n   information about\
    \ all the LSAs except for the LSAs belonging to the\n   TTZ that are hidden from\
    \ any router outside of the TTZ.\n   At the end of the link-state database synchronization,\
    \ the TTZ edge\n   router originates its own router LSA for virtualizing the TTZ\
    \ and\n   sends this LSA to its adjacent routers, including the TTZ-external\n\
    \   router.\n"
- title: 9.  Advertisement of LSAs
  contents:
  - "9.  Advertisement of LSAs\n   LSAs can be divided into a couple of classes according\
    \ to their\n   Advertisements.  The first class of LSAs is advertised within a\
    \ TTZ.\n   The second is advertised through a TTZ.\n"
- title: 9.1.  Advertisement of LSAs within TTZ
  contents:
  - "9.1.  Advertisement of LSAs within TTZ\n   Any LSA about a link state in a TTZ\
    \ is advertised only within the\n   TTZ.  It is not advertised to any router outside\
    \ of the TTZ.  For\n   example, a router LSA generated for a TTZ-internal router\
    \ is\n   advertised only within the TTZ.\n   Any network LSA generated for a broadcast\
    \ or Non-Broadcast Multi-\n   Access (NBMA) network in a TTZ is advertised only\
    \ within the TTZ.  It\n   is not advertised outside of the TTZ.\n   Any opaque\
    \ LSA generated for a TTZ-internal TE link is advertised\n   only within the TTZ.\n\
    \   After migrating to TTZ, every edge router of a TTZ MUST NOT advertise\n  \
    \ any LSA about a link state in the TTZ to any router outside of the\n   TTZ.\
    \  The TTZ edge router determines whether an LSA is about a TTZ-\n   internal\
    \ link state by checking if the advertising router of the LSA\n   is a TTZ-internal\
    \ router (i.e., there is a TTZ indication LSA\n   generated by the TTZ-internal\
    \ router that has the same advertising\n   router).\n   For any TTZ LSA originated\
    \ by a router within the TTZ, every edge\n   router of the TTZ MUST NOT advertise\
    \ it to any router outside of the\n   TTZ.\n"
- title: 9.2.  Advertisement of LSAs through TTZ
  contents:
  - "9.2.  Advertisement of LSAs through TTZ\n   Any LSA about a link state outside\
    \ of a TTZ received by an edge\n   router of the TTZ is advertised using the TTZ\
    \ as transit.  For\n   example, when an edge router of a TTZ receives an LSA from\
    \ a router\n   outside of the TTZ, it floods it to its neighboring routers both\n\
    \   inside and outside of the TTZ.  This LSA may be any LSA such as a\n   router\
    \ LSA that is advertised within an OSPF area.\n   The routers in the TTZ continue\
    \ to flood the LSA.  When another edge\n   router of the TTZ receives the LSA,\
    \ it floods the LSA to its\n   neighboring routers both inside and outside of\
    \ the TTZ.\n"
- title: 10.  Computation of Routing Table
  contents:
  - "10.  Computation of Routing Table\n   After a router migrates to TTZ, the computation\
    \ of the routing table\n   on the router is the same as that described in RFC\
    \ 2328, Section 16\n   with one exception.  The router in a TTZ ignores the router\
    \ LSAs\n   generated by the TTZ edge routers for virtualizing the TTZ.  It\n \
    \  computes routes using the TTZ router LSAs and the regular LSAs,\n   excluding\
    \ the router LSAs for virtualizing the TTZ.  That is, it\n   computes routes using\
    \ the TTZ topology and the topology outside of\n   the TTZ, excluding the links\
    \ for virtualizing the TTZ.\n"
- title: 11.  Operations
  contents:
  - '11.  Operations

    '
- title: 11.1.  Configuring TTZ
  contents:
  - "11.1.  Configuring TTZ\n   This section proposes some options for configuring\
    \ a TTZ.\n   1.  Configuring TTZ on Every Link in TTZ\n   If every link in a TTZ\
    \ is configured with the same TTZ ID as a TTZ\n   link, the TTZ is determined.\
    \  A router with some links in a TTZ and\n   some links not in this TTZ is a TTZ\
    \ edge router.  A router with all\n   its links in a TTZ is a TTZ-internal router.\n\
    \   2.  Configuring TTZ on Routers in TTZ\n   A same TTZ ID is configured on every\
    \ TTZ-internal router in a TTZ and\n   on every TTZ edge router's links connecting\
    \ to the routers in the\n   TTZ.\n   A router configured with the TTZ ID on some\
    \ of its links is a TTZ\n   edge router.  A router configured with the TTZ ID\
    \ only is a TTZ-\n   internal router.  All the links on a TTZ-internal router\
    \ are TTZ\n   links.  This option is simpler than option 1 above.\n   For a TTZ\
    \ edge router X with different TTZ IDs on its different\n   links, router X connects\
    \ two or more different TTZs.  In this case,\n   router X originates its router\
    \ LSA for virtualizing the TTZs.  This\n   LSA includes the normal links connecting\
    \ to routers outside of these\n   TTZs and the virtual links to the other edge\
    \ routers of each of these\n   TTZs.  Router X also originates its TTZ router\
    \ LSA for each of the\n   TTZs.  The TTZ router LSA for TTZ N includes the links\
    \ to the routers\n   outside of these TTZs, the virtual links to the other edge\
    \ routers of\n   the other TTZs, and the TTZ links to the routers in TTZ N.\n"
- title: 11.2.  Migration to TTZ
  contents:
  - "11.2.  Migration to TTZ\n   For a group of routers and a number of links connecting\
    \ the routers\n   in an area, making them transfer to work as a TTZ without any\
    \ service\n   interruption takes a few steps or stages.\n   At first, a user configures\
    \ the TTZ feature on every router in the\n   TTZ.  In this stage, a router does\
    \ not originate or advertise its TTZ\n   topology information.  It will discover\
    \ its TTZ neighbors.\n   Second, after configuring the TTZ, a user issues a configuration\
    \ on\n   one router in the TTZ, which triggers every router in the TTZ to\n  \
    \ generate and advertise TTZ information among the routers in the TTZ.\n   When\
    \ the router receives the configuration, it originates a TTZ\n   control LSA with\
    \ OP for T (indicating TTZ information generation and\n   advertisement for migration).\
    \  It also originates its TTZ LSA, such\n   as TTZ router LSA or TTZ indication\
    \ LSA, and advertises the LSA to\n   its TTZ neighbors.  When another router in\
    \ the TTZ receives the LSA\n   with OP for T, it originates its TTZ LSA.  In this\
    \ stage, every\n   router in the TTZ has dual roles.  One is to function as a\
    \ normal\n   router.  The other is to generate and advertise TTZ information.\n\
    \   Third, a user checks whether a router in the TTZ is ready for\n   migration\
    \ to TTZ.  A router in the TTZ is ready after it has received\n   all the TTZ\
    \ LSAs, including TTZ router LSAs from TTZ edge routers and\n   TTZ indication\
    \ LSAs from TTZ-internal routers.  This information may\n   be displayed on a\
    \ router through a configuration.\n   Then, a user activates the TTZ through using\
    \ a configuration such as\n   migrate to TTZ on one router in the TTZ.  The router\
    \ migrates to TTZ,\n   generates and advertises a TTZ control LSA with OP for\
    \ M (indicating\n   Migrating to TTZ) after it receives the configuration.  After\
    \ another\n   router in the TTZ receives the TTZ control LSA with OP for M, it\
    \ also\n   migrates to TTZ.  Thus, activating the TTZ on one TTZ router\n   propagates\
    \ to every router in the TTZ, which migrates to TTZ.\n   For an edge router of\
    \ the TTZ, migrating to work as a TTZ router\n   comprises generating a router\
    \ LSA to virtualize the TTZ and flooding\n   this LSA to all its neighboring routers\
    \ in two steps as described in\n   Section 7.\n   In normal operations for migration\
    \ to TTZ and rollback from TTZ, a\n   user issues a series of configurations according\
    \ to certain\n   procedures.  In an abnormal case, for example, two conflicting\n\
    \   configurations are issued on two TTZ routers in a TTZ at the same\n   time,\
    \ and a TTZ router issues an error and logs the error when it\n   detects a conflict.\n\
    \   A conflicting configuration may be detected on a router on which the\n   configuration\
    \ is issued.  Thus, some abnormal cases may be prevented.\n   When a configuration\
    \ for migration/rollback is issued on a router,\n   the router checks whether\
    \ it is in a correct sequence of\n   configurations for migration/rollback through\
    \ using the information\n   it has.  For migrating a part of an area to a TTZ,\
    \ the correct\n   sequence of configurations is in general as follows:\n   1)\
    \ configure TTZ on every router in the part of the area to be\n      migrated\
    \ to TTZ;\n   2) configure on one router in the TTZ to trigger every router in\
    \ the\n      TTZ to generate and advertise TTZ information for migration; and\n\
    \   3) configure on one router in the TTZ to trigger every router in the\n   \
    \   TTZ to migrate to TTZ.\n   After receiving a configuration on a router to\
    \ migrate to TTZ, which\n   is for 3), the router determines whether 2) is performed\
    \ by checking\n   if it has received/originated TTZ LSAs.  If it has not, it issues\
    \ an\n   error to an operator (generation and advertisement of TTZ information\n\
    \   for migration to TTZ is not done yet) and rejects the configuration\n   at\
    \ this time.\n   After a router receives a TTZ LSA with OP for M for 3) from another\n\
    \   router, it determines whether 2) is performed by checking if it has\n   received/originated\
    \ TTZ LSAs.  If it has not, it issues an error and\n   logs the error, and it\
    \ does not migrate to TTZ.  In this case, it\n   does not originate its router\
    \ LSA for virtualizing the TTZ if it is a\n   TTZ edge router.\n   After receiving\
    \ a configuration on a router to generate and advertise\n   TTZ information, which\
    \ is for 2), the router determines whether 1) is\n   performed by checking if\
    \ TTZ is configured on it.  If it is not, it\n   issues an error to an operator\
    \ (TTZ is not configured on it yet) and\n   rejects the configuration at this\
    \ time.\n   For rolling back from TTZ, the correct sequence of configurations\
    \ is\n   below.\n   1) configure on one router in the TTZ to trigger every router\
    \ in the\n      TTZ to advertise normal LSAs and stop advertising TTZ LSAs; and\n\
    \   2) configure on one router in the TTZ to trigger every router in the\n   \
    \   TTZ to roll back from TTZ.\n   After receiving a configuration on a router\
    \ to roll back from TTZ,\n   which is for 2), the router determines whether 1)\
    \ is performed by\n   checking if it has received TTZ LSA with OP for N.  If it\
    \ has not, it\n   issues an error to an operator (advertise normal LSAs and stop\n\
    \   advertising TTZ LSAs as rolling back from TTZ is not done yet) and\n   rejects\
    \ the configuration at this time.\n   After a router receives a TTZ LSA with OP\
    \ for R for 2) from another\n   router, it determines whether 1) is performed\
    \ by checking if it has\n   received TTZ LSA with OP for N.  If it has not, it\
    \ issues an error\n   and logs the error, and it does not roll back from TTZ.\n\
    \   After receiving a configuration on a router to advertise normal LSAs\n   and\
    \ stop advertising TTZ LSAs for rolling back from TTZ, which is for\n   1), the\
    \ router checks whether it has any TTZ LSAs.  If it does not,\n   it issues an\
    \ error to an operator (no TTZ to be rolled back) and\n   rejects the configuration\
    \ at this time.\n"
- title: 11.3.  Adding a Router into TTZ
  contents:
  - "11.3.  Adding a Router into TTZ\n   When a non-TTZ router (say R1) is connected\
    \ via a P2P link to a\n   migrated TTZ router (say T1), and there is a normal\
    \ adjacency between\n   them over the link, a user can configure TTZ on both ends\
    \ of the link\n   to add R1 into the TTZ to which T1 belongs.  They TTZ discover\
    \ each\n   other as described in Section 8.\n   When a number of non-TTZ routers\
    \ are connected via a broadcast or\n   NBMA link to a migrated TTZ router (say\
    \ T1), and there are normal\n   adjacencies among them, a user configures TTZ\
    \ on the connection to\n   the link on every router to add the non-TTZ routers\
    \ into the TTZ to\n   which T1 belongs.  The DR for the link \"forms\" TTZ adjacencies\
    \ with\n   the other routers connected to the link if they all have the same TTZ\n\
    \   ID configured for the link.  This is determined through the TTZ\n   discovery\
    \ process described in Section 8.\n"
- title: 12.  Manageability Considerations
  contents:
  - "12.  Manageability Considerations\n   Section 11 (\"Operations\") outlines the\
    \ configuration process and\n   deployment scenarios for a TTZ.  The configurable\
    \ item is enabling a\n   TTZ on a router and/or an interface on a router.  The\
    \ TTZ function\n   may be controlled by a policy module and assigned a suitable\
    \ user\n   privilege level to enable.  A suitable model may be required to\n \
    \  verify the TTZ status on routers participating in the TTZ, including\n   their\
    \ role as an internal or edge TTZ router.  The mechanisms defined\n   in this\
    \ document do not imply any new liveness detection and\n   monitoring requirements\
    \ in addition to those indicated in [RFC2328].\n"
- title: 13.  Security Considerations
  contents:
  - "13.  Security Considerations\n   A notable beneficial security aspect of TTZ\
    \ is that the TTZ is\n   enclosed in a single area, and TTZ could be used to mask\
    \ the internal\n   topology.  External routers that are not participating in the\
    \ TTZ\n   will not be aware of the internal TTZ topology.  It should be noted\n\
    \   that a malicious node could inject TTZ LSAs with the OP field set to\n   M\
    \ or R, which could trigger the migration into/from a TTZ and may\n   result in\
    \ the isolation of some routers in the network.  Good\n   security practice might\
    \ reuse the OSPF authentication and other\n   security mechanisms described in\
    \ [RFC2328] and [RFC7474] to mitigate\n   this type of risk.\n"
- title: 14.  IANA Considerations
  contents:
  - "14.  IANA Considerations\n   Under the registry name \"Opaque Link-State Advertisements\
    \ (LSA)\n   Option Types\" [RFC5250], IANA has assigned a new Opaque Type registry\n\
    \   value for TTZ LSA as follows:\n     +====================+===============+=======================+\n\
    \     |  Registry Value    |  Opaque Type  |    reference          |\n     +====================+===============+=======================+\n\
    \     |         9          |    TTZ LSA    |    This document      |\n     +--------------------+---------------+-----------------------+\n\
    \   IANA has created and will maintain a new registry:\n   o  OSPFv2 TTZ LSA TLVs\n\
    \   Initial values for the registry are given below.  The future\n   assignments\
    \ are to be made through IETF Review [RFC5226].\n       Value         OSPFv2 TTZ\
    \ LSA TLV Name    Definition\n       -----         -----------------------   \
    \ ----------\n       0             Reserved\n       1             TTZ ID TLV \
    \                see Section 6.2\n       2             TTZ Router TLV        \
    \     see Section 6.3\n       3             TTZ Options TLV            see Section\
    \ 6.4\n       4-32767       Unassigned\n       32768-65535   Reserved\n"
- title: 15.  References
  contents:
  - '15.  References

    '
- title: 15.1.  Normative References
  contents:
  - "15.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n  \
    \            DOI 10.17487/RFC2119, March 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC2328]  Moy, J., \"OSPF Version 2\", STD 54, RFC 2328,\n              DOI\
    \ 10.17487/RFC2328, April 1998,\n              <http://www.rfc-editor.org/info/rfc2328>.\n\
    \   [RFC5250]  Berger, L., Bryskin, I., Zinin, A., and R. Coltun, \"The\n    \
    \          OSPF Opaque LSA Option\", RFC 5250, DOI 10.17487/RFC5250,\n       \
    \       July 2008, <http://www.rfc-editor.org/info/rfc5250>.\n   [RFC7474]  Bhatia,\
    \ M., Hartman, S., Zhang, D., and A. Lindem, Ed.,\n              \"Security Extension\
    \ for OSPFv2 When Using Manual Key\n              Management\", RFC 7474, DOI\
    \ 10.17487/RFC7474, April 2015,\n              <http://www.rfc-editor.org/info/rfc7474>.\n\
    \   [RFC4940]  Kompella, K. and B. Fenner, \"IANA Considerations for\n       \
    \       OSPF\", BCP 130, RFC 4940, DOI 10.17487/RFC4940, July 2007,\n        \
    \      <http://www.rfc-editor.org/info/rfc4940>.\n"
- title: 15.2.  Informative References
  contents:
  - "15.2.  Informative References\n   [RFC5226]  Narten, T. and H. Alvestrand, \"\
    Guidelines for Writing an\n              IANA Considerations Section in RFCs\"\
    , BCP 26, RFC 5226,\n              DOI 10.17487/RFC5226, May 2008,\n         \
    \     <http://www.rfc-editor.org/info/rfc5226>.\n"
- title: Appendix A.  Prototype Implementation
  contents:
  - 'Appendix A.  Prototype Implementation

    '
- title: A.1.  What Is Implemented and Tested
  contents:
  - "A.1.  What Is Implemented and Tested\n   1.  Command-Line Interface (CLI) Commands\
    \ for TTZ\n   The CLIs implemented and tested include:\n   o  the CLIs of the\
    \ simpler option for configuring TTZ, and\n   o  the CLIs for controlling migration\
    \ to TTZ.\n   2.  Extensions to OSPF Protocols for TTZ\n   All the extensions\
    \ defined in \"Extensions to OSPF Protocols\"\n   (Section 6) are implemented\
    \ and tested except for rolling back from\n   TTZ.  The testing results illustrate:\n\
    \   o  As seen from the outside, a TTZ is virtualized as its edge routers\n  \
    \    connected to each other.  Any router outside of the TTZ sees the\n      edge\
    \ routers (as normal routers) connecting to each other and to\n      some other\
    \ routers.\n   o  The link-state information about the routers and links inside\
    \ the\n      TTZ is contained within the TTZ.  It is not advertised to any\n \
    \     router outside of the TTZ.\n   o  TTZ is transparent.  From a router inside\
    \ a TTZ, it sees the\n      topology (link state) outside of the TTZ.  From a\
    \ router outside\n      of the TTZ, it sees the topology beyond the TTZ.  The\
    \ link-state\n      information outside of the TTZ is advertised through the TTZ.\n\
    \   o  TTZ is backward compatible.  Any router outside of a TTZ does not\n   \
    \   need to support or know TTZ.\n   3.  Smooth Migration to TTZ\n   The procedures\
    \ and related protocol extensions for smooth migration\n   to TTZ are implemented\
    \ and tested.  The testing results show:\n   o  A part of an OSPF area is smoothly\
    \ migrated to a TTZ without any\n      routing disruptions.  The routes on every\
    \ router are stable while\n      the part of the area is being migrated to the\
    \ TTZ.\n   o  Migration to TTZ is very easy to operate.\n   4.  Add a Router to\
    \ TTZ\n   Adding a router into TTZ is implemented and tested.  The testing\n \
    \  results illustrate:\n   o  A router can be easily added into a TTZ to become\
    \ a TTZ router.\n   o  The router added into the TTZ is not seen on any router\
    \ outside of\n      the TTZ, but it is a part of the TTZ.\n   5.  Leak TTZ Loopbacks\
    \ Outside\n   Leaking loopback addresses in a TTZ to routers outside of the TTZ\
    \ is\n   implemented and tested.  The testing results illustrate:\n   o  The loopback\
    \ addresses inside the TTZ are advertised to the\n      routers outside of the\
    \ TTZ.\n   o  The loopback addresses are accessible from a router outside of the\n\
    \      TTZ.\n"
- title: A.2.  Implementation Experience
  contents:
  - "A.2.  Implementation Experience\n   The implementation of TTZ reuses the existing\
    \ OSPF code along with\n   additional simple logic.  A couple of engineers started\
    \ to work on\n   implementing the TTZ from the middle of June 2014 and finished\
    \ coding\n   it just before the end of July 2014.  After some testing and bug\n\
    \   fixes, it works as expected.\n   In our implementation, the link-state information\
    \ in a TTZ opaque LSA\n   is stored in the same link-state database as the link-state\n\
    \   information in a normal LSA.  For each TTZ link in the TTZ opaque\n   LSA,\
    \ there is an additional flag, which is used to differentiate\n   between a TTZ\
    \ link and a normal link.\n   Before migration to TTZ, every router in the TTZ\
    \ computes its routing\n   table using the normal links.  After migration to TTZ,\
    \ every router\n   in the TTZ computes its routing table using the TTZ links and\
    \ normal\n   links.  In the case where both the TTZ link and the normal link\n\
    \   exist, the TTZ link is used.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   The authors would like to thank Acee Lindem, Abhay Roy,\
    \ Christian\n   Hopps, Dean Cheng, Russ White, Tony Przygienda, Wenhu Lu, Lin\
    \ Han,\n   Kiran Makhijani, Padmadevi Pillay Esnault, and Yang Yu for their\n\
    \   valuable comments on this specification.\n"
- title: Contributors
  contents:
  - "Contributors\n   The following people contributed significantly to the content\
    \ of this\n   document and should be considered co-authors:\n        Mehmet Toy\n\
    \        United States of America\n        Email: mehmet.toy@verizon.com\n   \
    \     Gregory Cauchie\n        France\n        Email: greg.cauchie@gmail.com\n\
    \        Anil Kumar SN\n        India\n        Email: anil.sn@huawei.com\n   \
    \     Ning So\n        United States of America\n        Email: ningso01@gmail.com\n\
    \        Lei Liu\n        United States of America\n        Email: lliu@us.fujitsu.com\n\
    \   We also acknowledge the contribution of the following individuals:\n     \
    \   Veerendranatha Reddy Vallem\n        India\n        Email: veerendranatharv@huawei.com\n\
    \        William McCall\n        United States of America\n        will.mccall@rightside.co\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Huaimo Chen\n   Huawei Technologies\n   Boston, MA\n \
    \  United States of America\n   Email: huaimo.chen@huawei.com\n   Renwei Li\n\
    \   Huawei Technologies\n   2330 Central expressway\n   Santa Clara, CA\n   United\
    \ States of America\n   Email: renwei.li@huawei.com\n   Alvaro Retana\n   Cisco\
    \ Systems, Inc.\n   7025 Kit Creek Rd.\n   Raleigh, NC  27709\n   United States\
    \ of America\n   Email: aretana@cisco.com\n   Yi Yang\n   Sockrate\n   Cary, NC\n\
    \   United States of America\n   Email: yyang1998@gmail.com\n   Zhiheng Liu\n\
    \   China Mobile\n   No.32 Xuanwumen West Street, Xicheng District\n   Beijing\
    \  100053\n   China\n   Email: liu.cmri@gmail.com\n"
