- title: __initial_text__
  contents:
  - ''
- title: Why the Authentication Data Suboption is Needed for Mobile IPv6 (MIPv6)
  contents:
  - 'Why the Authentication Data Suboption is Needed for Mobile IPv6 (MIPv6)

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ (http://trustee.ietf.org/\n   license-info) in effect on the date of publication\
    \ of this document.\n   Please review these documents carefully, as they describe\
    \ your rights\n   and restrictions with respect to this document.\n"
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv6 defines a set of signaling messages that enable the\n\
    \   mobile node (MN) to authenticate and perform registration with its\n   home\
    \ agent (HA).  These authentication signaling messages between the\n   mobile\
    \ node and home agent are secured by an IPsec security\n   association (SA) that\
    \ is established between the MN and HA.  The MIP6\n   working group has specified\
    \ a mechanism to secure the Binding Update\n   (BU) and Binding Acknowledgement\
    \ (BAck) messages using an\n   authentication option, similar to the authentication\
    \ option in Mobile\n   IPv4, carried within the signaling messages that are exchanged\n\
    \   between the MN and HA to establish a binding.  This document provides\n  \
    \ the justifications as to why the authentication option mechanism is\n   needed\
    \ for Mobile IPv6 deployment in certain environments.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................2\n\
    \   2. Conventions Used in This Document ...............................3\n  \
    \ 3. Background ......................................................3\n   4.\
    \ Applicability Statement .........................................3\n   5. Justification\
    \ for the Use of the Authentication Option ..........5\n      5.1. Motivation\
    \ for Use of the Authentication Option in\n           CDMA2000 ...................................................5\n\
    \      5.2. Additional Arguments for the Use of the\n           Authentication\
    \ Option ......................................6\n   6. Application of Mobile\
    \ IPv6 in CDMA Networks .....................9\n      6.1. IPv4-Based Mobility\
    \ Architecture in CDMA2000 Networks ......9\n      6.2. IPv6-Based Mobility Architecture\
    \ in CDMA2000 Networks .....11\n           6.2.1. Overview of the Mobility Operation\
    \ in\n                  IPv6-Based CDMA2000 Networks .......................11\n\
    \           6.2.2. Authentication and Security Details ................12\n  \
    \ 7. Limitations of the Authentication Protocol Option ..............14\n   8.\
    \ Security Considerations ........................................16\n   9. Conclusion\
    \ .....................................................16\n   10. Acknowledgements\
    \ ..............................................17\n   11. References ....................................................17\n\
    \      11.1. Normative References .....................................17\n  \
    \    11.2. Informative References ...................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Mobile IPv6 relies on the IPsec Security Association between\
    \ the\n   Mobile Node (MN) and the Home Agent (HA) for authentication of the MN\n\
    \   to its HA before a binding cache can be created at the HA.  An\n   alternate\
    \ mechanism that does not rely on the existence of the IPsec\n   SA between the\
    \ MN and HA for authenticating the MN is needed in\n   certain deployment environments.\
    \  Such an alternate mechanism is\n   outlined in [RFC4285].  This document is\
    \ intended to capture for\n   archival purposes the reasoning behind the need\
    \ for the\n   authentication protocol [RFC4285].  It should be noted that the\n\
    \   alternate solution does not imply that the IPsec-based solution will\n   be\
    \ deprecated.  It simply means that in certain deployment scenarios\n   there\
    \ is a need for supporting MIPv6 without an IPsec SA between the\n   MN and HA.\
    \  So the alternate solution is in addition to the IPsec-\n   based mechanism\
    \ specified in the base RFCs, i.e., [RFC3775],\n   [RFC3776], and [RFC4877]. \
    \ It has been noted that some of the\n   challenges of deploying MIPv6 in certain\
    \ types of networks arose from\n   dependence on the Internet Key Exchange (IKE),\
    \ which did not\n   integrate well with an Authentication, Authorization, and\
    \ Accounting\n   (AAA) backend infrastructure.  IKEv2 solves this problem.  However,\n\
    \   at the time of discussion on the need for the authentication\n   protocol,\
    \ \"Mobile IPv6 Operation with IKEv2 and the Revised IPsec\n   Architecture\"\
    \ [RFC4877] was still a work in progress and, as a\n   result, an alternative\
    \ solution was needed.\n   It should be noted that some of the arguments for justifying\
    \ the\n   specification of the authentication protocol have been made redundant\n\
    \   as a result of the specification of Mobile IPv6 operation with IKEv2\n   [RFC4877].\
    \  However, some of the arguments discussed in this document\n   are still applicable\
    \ and justify usage of the authentication protocol\n   in certain deployment environments.\n"
- title: 2.  Conventions Used in This Document
  contents:
  - "2.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n"
- title: 3.  Background
  contents:
  - "3.  Background\n   Mobile IPv6 signaling involves several messages.  These include:\n\
    \   o  The Binding Update/Binding Acknowledgment between the mobile node\n   \
    \   and the home agent.\n   o  The route optimization signaling messages, which\
    \ include the\n      HoTI-HoT (Home Test Init/Home Test), CoTI-CoT (Care-of Test\
    \ Init/\n      Care-of Test), and BU-BAck messages between the MN and CN.  HoTI\n\
    \      and HoT signaling messages are routed through the MN's HA.\n   o  Mobile\
    \ prefix solicitation and advertisements between the MN and\n      HA.\n   o \
    \ Home agent discovery by MNs.\n   The signaling messages between the MN and HA\
    \ are secured using the\n   IPsec SA that is established between these entities.\
    \  The exception\n   to this are the messages involved in the home agent discovery\n\
    \   process.  [RFC4877] specifies the establishment of the IPsec SA using\n  \
    \ IKEv2.\n"
- title: 4.  Applicability Statement
  contents:
  - "4.  Applicability Statement\n   The authentication option specified in \"Authentication\
    \ Protocol for\n   MIPv6\" [RFC4285] provides a solution for MIPv6 deployment\
    \ in\n   environments in which an operator may not require IPsec-based\n   security\
    \ for the signaling.  The reasons for an operator choosing to\n   deploy MIPv6\
    \ without mandating IPsec-based security for signaling\n   messages between the\
    \ MN and HA could be many.  Some of these are, for\n   example:\n   1.  Operators\
    \ deploying MIPv6 in cellular networks may consider IPsec\n       and IKEv2 as\
    \ adding overhead to the limited bandwidth over the\n       air interface.  The\
    \ overhead here is in terms of the bytes that\n       IPsec and IKEv2 introduce\
    \ to the signaling.\n   2.  Operators may consider the number of messages between\
    \ the MN and\n       HA that are required to establish the IPsec SA as too many.\
    \  The\n       number of transactions chew into the capacity of limited\n    \
    \   bandwidth air interfaces when MIPv6 is used in such environments.\n      \
    \ It also adds additional latency to the establishment of the\n       binding.\n\
    \   3.  In many deployments, authentication credentials already exist in\n   \
    \    a AAA server.  These credentials are used for authenticating a\n       user\
    \ and authorizing network access.  The same credentials and\n       security parameters\
    \ cannot be reused for MIPv6 security as well,\n       if IKEv1 is used.\n   4.\
    \  Dynamic assignment of home agents is needed in certain\n       deployments\
    \ to minimize the latency of the backhaul.  This is\n       done by allocating\
    \ an HA in a visited network, for example.\n       Requiring IPsec SAs with home\
    \ agents that are dynamically\n       assigned is an overhead, especially when\
    \ the HA is in a visited\n       network.\n   5.  In certain deployments, signaling\
    \ messages between the MN and HA\n       may be over secure link layers.  The\
    \ lower layers provide\n       ciphering and security for the messages, and hence\
    \ the need for\n       IPsec to do the same for MIPv6 messages does not exist.\n\
    \   One example of networks that have such characteristics are Code\n   Division\
    \ Multiple Access (CDMA) networks as defined in the 3GPP2\n   [3GPP2 X.S0011-002-D]\
    \ specification.  Mobile WiMAX (Worldwide\n   Interoperability for Microwave Access),\
    \ which is based on IEEE\n   802.16e, also specifies in the network architecture\
    \ the use of MIPv6,\n   with the default security for signaling being the authentication\n\
    \   protocol [RFC4285].  The WiMAX network architecture specifications\n   are\
    \ available at [WiMAX-NWG].\n"
- title: 5.  Justification for the Use of the Authentication Option
  contents:
  - "5.  Justification for the Use of the Authentication Option\n   The following\
    \ two sections provide the reasoning for why the\n   authentication option-based\
    \ registration process for Mobile IPv6 is\n   needed.  Section 5.1 provides key\
    \ arguments for the use of the\n   authentication option.  Section 5.2 provides\
    \ further explanation and\n   additional motivations for the authentication option.\n"
- title: 5.1.  Motivation for Use of the Authentication Option in CDMA2000
  contents:
  - "5.1.  Motivation for Use of the Authentication Option in CDMA2000\n      Wireless\
    \ Networks\n   CDMA2000 networks deployed and operational today use Mobile IPv4\
    \ for\n   IP mobility.  Operators have gained a significant amount of\n   operational\
    \ experience in the process of deploying and operating\n   these networks. 3GPP2\
    \ has specified Mobile IPv6 operation in the\n   [3GPP2 X.S0011-002-D] specification.\
    \  The following are the\n   deployment constraints that existing CDMA networks\
    \ have to deal with\n   when deploying mobility service based on IPv6:\n   o \
    \ Operators intend to leverage the Mobile IPv4 deployment and\n      operational\
    \ experience by ensuring that Mobile IPv6 has a similar\n      deployment and\
    \ operating model.\n   o  Operators will have two parallel networks: one that\
    \ offers IPv4\n      mobility with MIPv4 and another providing IPv6 mobility using\n\
    \      MIPv6.\n   o  The same backend subscriber profile database, security keys,\
    \ etc.\n      are intended to be used for both Mobile IPv4 and Mobile IPv6\n \
    \     service.  However, from a security standpoint, the reuse of the\n      same\
    \ keys with multiple algorithms/protocols is a bad idea.\n   o  The same user-configuration\
    \ information, i.e., the identity and\n      keys associated with a user, will\
    \ be used for IP mobility service\n      in IPv4 and/or IPv6 networks.  The only\
    \ security association that\n      is preconfigured is a shared secret between\
    \ the mobile node and\n      the home AAA server.  This is in contrast with an\
    \ earlier version\n      of the Mobile IPv6 model, which required an IPsec SA\
    \ between the\n      MN and HA.  At the time of this writing, the IKEv2-based\
    \ solution\n      for establishing an IPsec SA [RFC4877] was not available.  IKEv2\n\
    \      does enable integration with a AAA backend.\n   o  At the time of specifying\
    \ the authentication protocol, the Mobile\n      IPv6 specification did not support\
    \ the dynamic assignment of home\n      agent and home address.  However, work\
    \ done in the MIP6 working\n      group on bootstrapping of Mobile IPv6 as specified\
    \ in [RFC5026]\n      and \"MIPv6-Bootstrapping for the Integrated Scenario\"\
    \ [BOOT]\n      addresses this deficiency.  The mechanism defined in\n      \"\
    Authentication Protocol for Mobile IPv6\" [RFC4285] is capable of\n      handling\
    \ authentication even in the case of dynamic assignments\n      (and is similar\
    \ to what is used in current MIPv4 deployments).\n   Consequently, MIPv6 as specified\
    \ at the time the authentication\n   protocol was being specified, did not satisfy\
    \ many of the deployment\n   requirements.  \"Authentication Protocol for MIPv6\"\
    \ [RFC4285] along\n   with \"MN Identifier Option for MIPv6\" [RFC4283] are enabling\
    \ the\n   deployment of Mobile IPv6 in a manner that is similar to what is\n \
    \  deployed in CDMA2000 networks today.  This authentication model is\n   very\
    \ similar to the one adopted by the MIP4 WG.  This is explained in\n   detail\
    \ in [3GPP2 X.S0011-002-D].\n   The earlier MIPv6 deployment model, which requires\
    \ an IPsec SA that\n   is either configured manually or established using IKE,\
    \ does not have\n   synergy with the deployment models of 3GPP2 or WiMAX networks.\
    \  This\n   issue has however been alleviated with the publication of RFC 4877,\n\
    \   which enables the establishment of an IPsec SA using IKEv2 and which\n   is\
    \ also able to integrate with the backend AAA infrastructure that is\n   responsible\
    \ for the authentication of the MN in 3GPP2 and WiMAX\n   networks.\n"
- title: 5.2.  Additional Arguments for the Use of the Authentication Option
  contents:
  - "5.2.  Additional Arguments for the Use of the Authentication Option\n   The use\
    \ of IPsec for performing Registration with a home agent is not\n   always an\
    \ optimal solution.  While it is true that IPsec is viewed as\n   an integral\
    \ part of the IPv6 stack, it is still a considerable\n   overhead from a deployment\
    \ perspective of using IPsec as the security\n   mechanism for the signaling messages\
    \ between the MN and HA.  This\n   statement is a result of experience gained\
    \ from deployment of Mobile\n   IPv4.  MIPv4 does not rely on IPsec for securing\
    \ the Registration\n   signaling messages.\n   Deployment of Mobile IPv6 on a\
    \ large scale is possible only when the\n   protocol is flexible for being adapted\
    \ to various scenarios.  The\n   scenario being considered is the deployment in\
    \ CDMA2000 networks or\n   WiMAX networks.  CDMA2000 networks are currently deployed\
    \ in many\n   countries today.  WiMAX deployments in many countries began in 2008.\n\
    \   The packet data network architecture of CDMA2000 [3GPP2\n   X.S0011-002-D]\
    \ includes a MIPv4 foreign agent/home agent and a\n   RADIUS-based AAA infrastructure\
    \ for Authentication, Authorization,\n   and Accounting purposes.  The AAA infrastructure\
    \ provides\n   authentication capability in the case of Mobile IPv4.\n   Typically,\
    \ the mobile node shares a security association with the\n   AAA-Home entity.\
    \  This is the preferred mode of operation over having\n   a shared secret between\
    \ the MN and HA because the AAA-Home entity\n   provides a central location for\
    \ provisioning and administering the\n   shared secrets for a large number of\
    \ mobiles (millions).  This mode\n   of operation also makes dynamic home address\
    \ and dynamic home agent\n   assignment easier.  A similar approach is needed\
    \ for the deployment\n   of Mobile IPv6 in these networks.  There is no practical\
    \ mechanism to\n   use IPsec directly with the AAA infrastructure without the\
    \ use of\n   IKEv2 or some other mechanism that enables the establishment of the\n\
    \   IPsec SA between the MN and HA.\n   Mobile IPv6 as specified in [RFC3775]\
    \ and [RFC3776] is based on a\n   very specific model for deployment.  It anticipates\
    \ the mobile node's\n   having a static home IPv6 address and a designated home\
    \ agent.  This\n   is not practical in most deployment scenarios being considered.\
    \  An\n   IPsec SA is expected to be created via manual keying or established\n\
    \   dynamically via IKE or IKEv2.  These assumptions do not necessarily\n   fit\
    \ in very well for the deployment model envisioned in CDMA2000 or\n   WiMAX networks.\
    \  These limitations have however been overcome as a\n   result of the bootstrapping\
    \ specifications as per [RFC5026] and\n   \"MIPv6-Bootstrapping for the Integrated\
    \ Scenario\" [BOOT].\n   CDMA2000 and WiMAX networks would prefer to allocate\
    \ home addresses\n   to MNs on a dynamic basis.  The advantage of doing so is\
    \ the fact\n   that the HA can be assigned on a link that is close to the MN's\
    \ point\n   of attachment.  While route optimization negates the benefit of\n\
    \   having a home agent on a link close to the MN, it cannot always be\n   guaranteed\
    \ that the MN and correspondent node (CN) will use or\n   support route optimization.\
    \  There may also be instances where the\n   operator prefers to not allow route\
    \ optimization for various reasons,\n   such as accounting aggregation or enforcing\
    \ service contracts.  In\n   such cases, an HA that is close to the MN's point\
    \ of attachment\n   reduces the issues of latency, etc. of forward and reverse\
    \ tunnelling\n   of packets between the MN and HA.\n   CDMA2000 networks that\
    \ are operational today have large numbers of\n   subscribers who are authenticated\
    \ via the AAA infrastructure.\n   Deployment of Mobile IPv6 should leverage the\
    \ existing AAA\n   infrastructure.  The security model needed in these networks\
    \ is an SA\n   between the MN and AAA-Home entity.  This is the primary security\n\
    \   association that should be used for authenticating and authorizing\n   users\
    \ to utilize MIPv6 service.  This SA is then used for\n   establishing session\
    \ keys between the MN and the dynamically assigned\n   HA for authenticating subsequent\
    \ Binding Updates and Binding\n   Acknowledgements between them.  Establishing\
    \ an IPsec SA between the\n   MN and HA using AAA infrastructure was not specified\
    \ for Mobile IPv6\n   at the time the authentication protocol was being specified.\
    \  RFC\n   3776 explains how IKE is used for establishing the SA between the MN\n\
    \   and HA.  [RFC4877] has been published subsequently and hence the\n   issue\
    \ of establishing an IPsec SA dynamically between the MN and HA\n   no longer\
    \ exists.  CDMA2000 network operators would prefer to assign\n   home addresses\
    \ to the MN on a dynamic basis -- preferably using the\n   AAA infrastructure,\
    \ which contains subscriber profile and capability\n   information.  This was\
    \ not possible prior to the specification of the\n   bootstrapping mechanism in\
    \ [RFC5026].\n   A large subset of MNs in CDMA2000 networks do not have IKE\n\
    \   capability.  As a result, the use of RFC 3776 for setting up the\n   MN-HA\
    \ IPsec SA is not an option.  It should also be noted that IKE\n   requires several\
    \ transactions before it is able to establish the\n   IPsec SA.  [RFC4877] specifies\
    \ the establishment of an IPsec SA\n   between the MN and HA using IKEv2.  It\
    \ is possible that not all MNs\n   in a deployment will support IKEv2, and hence\
    \ an alternative\n   mechanism provides the needed flexibility.\n   CDMA2000 network\
    \ operators are extremely conscious in terms of the\n   number of messages sent\
    \ and received over the air interface for\n   signaling.  The overhead associated\
    \ with sending/receiving a large\n   number of signaling messages over the air\
    \ interface has a direct\n   impact on the overall capacity and cost for the operator.\n\
    \   Optimization of the number of messages needed for using a service\n   like\
    \ Mobile IPv6 is of great concern.  As a result, the use of IKE\n   for Mobile\
    \ IPv6 deployment is considered as being suboptimal in\n   certain network architectures\
    \ and deployment scenarios from the\n   perspective of message overhead.\n   Another\
    \ downside of IKE for setting up the IPsec SA between the MN\n   and HA is that\
    \ IKE does not integrate very well with the RADIUS-based\n   AAA backend.  Since\
    \ operators rely on the AAA infrastructure to\n   provision subscribers as well\
    \ as define profiles, keys, etc. in the\n   AAA-Home, there is no getting away\
    \ from the use of AAA in CDMA2000\n   networks.  IKEv2 does address this problem.\
    \  However, from a timeline\n   perspective, the availability of IKEv2 specifications\
    \ for \"Mobile\n   IPv6 Operation with IKEv2 and the Revised IPsec Architecture\"\
    \n   [RFC4877] and its implementations did not meet the need of operators\n  \
    \ that were relying on 3GPP2 specifications.  With the specification of\n   IKEv2\
    \ and publication of RFC 4877, integration with AAA backends is\n   no longer\
    \ an issue.\n   In summary, the model of Mobile IPv6 deployment that mandated\
    \ the\n   existence of an IPsec SA between the MN and HA, as specified in RFCs\n\
    \   3775 and 3776, was too rigid and did not meet the requirements of\n   operators\
    \ building networks based on the CDMA2000 [3GPP2\n   X.S0011-002-D] specifications.\
    \  To address this shortcoming, the\n   authentication protocol [RFC4285] was\
    \ specified.\n"
- title: 6.  Application of Mobile IPv6 in CDMA Networks
  contents:
  - "6.  Application of Mobile IPv6 in CDMA Networks\n   Sections 6.1 and 6.2 describe\
    \ the IPv4- and IPv6-based mobility\n   architectures in CDMA networks, respectively.\
    \  For further details\n   associated with the description below, please refer\
    \ to Section 5,\n   \"MIP6 Operation\", in the 3GPP2 specification [3GPP2 X.S0011-002-D].\n"
- title: 6.1.  IPv4-Based Mobility Architecture in CDMA2000 Networks
  contents:
  - "6.1.  IPv4-Based Mobility Architecture in CDMA2000 Networks\n   The figure below\
    \ shows a high level view of the key network elements\n   that play a role in\
    \ providing IP mobility using Mobile IPv4.\n                 +--------------+\
    \           +----------------------+\n                 |   +------+   |      \
    \     |   +------+           |\n                 |   |      |   |           |\
    \   |      |           |\n                 |   |F-AAA |   |           |   |H-AAAH|\
    \           |\n                 |   |      +-------------------+      |      \
    \     |\n                 |   +---+--+   |           |   +--+---+           |\n\
    \                 |       |      |           |      |               |\n      \
    \           |       |      |           |      |               |\n      +------+\
    \   |   +---+--+   |           |   +--+---+           |\n      |      |   |  \
    \ |      |   |           |   |      |           |\n      |  MN  +- -|- -+ PDSN\
    \ + --  --  --  --  - +  HA  |           |\n      |      |   |   |  /FA |   |\
    \           |   |      |           |\n      +------+   |   +------+   |      \
    \     |   +------+           |\n                 |              |           |\
    \                      |\n                 +--------------+           +----------------------+\n\
    \   Figure 1: CDMA2000 Packet Data Network Architecture with Mobile IPv4\n   The\
    \ CDMA mobility architecture based on MIPv4 is explained below.  In\n   this architecture,\
    \ mobility is tightly integrated with the AAA\n   infrastructure.  The Mobile\
    \ Node is configured with an NAI (Network\n   Access Identifier) and an MN-AAA\
    \ key.  The MN-AAA key is a shared key\n   that is shared between the MN and the\
    \ home AAA server.\n   Below is the access link setup procedure:\n   (1)  Bring\
    \ up the PPP on the MN/PDSN (access router link).  PPP\n        authentication\
    \ is skipped.  Mobile IP authentication is\n        performed via the FA (Foreign\
    \ Agent).\n   (2)  The PDSN (Packet Data Serving Node) sends a Mobile IP challenge\n\
    \        to the MN on the PPP link (RFC 3012).\n   (3)  The MN sends a MIP Registration\
    \ Request (RRQ), which includes\n        the user's NAI, challenge, and MN-AAA\
    \ extension that has a\n        challenge response, and an MN-HA extension, which\
    \ is generated\n        based on the MN-HA key.\n   (4)  The PDSN extracts the\
    \ MIP NAI, challenge, and the response to\n        the challenge, from the MIP\
    \ MN-AAA extension, and sends an\n        Access Request to the F-AAA (challenge/response\
    \ using MD5).\n   (5)  The F-AAA (Foreign AAA) may forward it to the H-AAA (Home\
    \ AAA)\n        if needed (based on realm).\n   (6)  AAA authenticates the CHAP-challenge/response\
    \ and returns\n        \"success\" if authentication succeeds.\n   (7)  The PDSN\
    \ forwards the Registration Request (RRQ) to the HA.\n   (8)  The HA authenticates\
    \ the RRQ (MHAE (Mobile-Home Authentication\n        Extension)).  The HA may\
    \ optionally authenticate with the AAA\n        infrastructure (just like the\
    \ PDSN in #4).\n   (9)  If authentication is successful, the HA creates a binding\
    \ and\n        sends a success Registration Reply (RRP) to the PDSN.\n   (10)\
    \ The PDSN creates a visitor entry and forwards the RRP to the MN.\n"
- title: 6.2.  IPv6-Based Mobility Architecture in CDMA2000 Networks
  contents:
  - "6.2.  IPv6-Based Mobility Architecture in CDMA2000 Networks\n   Due to the need\
    \ for co-existence with MIPv4, and having the same\n   operational model, the\
    \ 3GPP2 standards body is adopting the following\n   mobility architecture for\
    \ MIPv6.\n                        Access Domain                  Home Domain\n\
    \                  +--------------+           +----------------------+\n     \
    \             |   +------+   |           |   +------+           |\n          \
    \        |   |      |   |           |   |      |           |\n               \
    \   |   |F-AAA |   |           |   |H-AAA |           |\n                  | \
    \  |      +-------------------+      |           |\n                  |   +---+--+\
    \   |           |   +--+---+           |\n                  |       |      | \
    \          |      |               |\n                  |       |      |      \
    \     |      |               |\n       +------+   |   +---+--+   |           |\
    \   +--+---+           |\n       |      |   |   |      |   |           |   | \
    \     |           |\n       |  MN  +- -|- -+ PDSN + --  --  --  --  - +  HA  |\
    \           |\n       |      |   |   |  /AR |   |           |   |      |     \
    \      |\n       +------+   |   +------+   |           |   +------+          \
    \ |\n                  |              |           |                      |\n \
    \                 +--------------+           +----------------------+\n   Figure\
    \ 2: CDMA2000 Packet Data Network Architecture with Mobile IPv6\n   The Mobile\
    \ Node is configured with an NAI (Network Access Identifier)\n   and an MN-AAA\
    \ key.  The MN-AAA key is a shared key between the MN and\n   the home AAA server.\n"
- title: 6.2.1.  Overview of the Mobility Operation in IPv6-Based CDMA2000
  contents:
  - "6.2.1.  Overview of the Mobility Operation in IPv6-Based CDMA2000\n        Networks\n\
    \   The following steps explain at a very generic level the operation of\n   IP\
    \ mobility in CDMA2000 networks:\n   (1)  The MN performs link-layer establishment.\
    \  This includes setting\n        up the PPP link.  PPP-CHAP authentication is\
    \ performed.  This is\n        authenticated by the PDSN/AR (Access Router) by\
    \ sending an\n        Access Request to the F-AAA (and to the H-AAA when/if needed).\n\
    \        Optionally, the MN acquires bootstrap information from the Home\n   \
    \     Network (via the PDSN; the PDSN receives this information in\n        Access\
    \ Accept).  The bootstrap information includes home address\n        and home\
    \ agent assignment.  The MN uses stateless DHCPv6\n        [RFC3736] to obtain\
    \ the bootstrap information from the PDSN.\n   (2)  The MN begins to use the home\
    \ address (HoA) that was assigned in\n        step 1.  If no HoA was assigned\
    \ at step 1, the MN generates\n        (auto-configures) an IPv6 global unicast\
    \ address based on the\n        prefix information received at step 1.\n   (3)\
    \  The MN sends a Binding Update to the selected home agent.  In\n        the\
    \ BU, the MN includes the NAI option, timestamp option, and\n        MN-AAA auth\
    \ option.\n   (4)  The HA extracts the NAI, authenticator, etc. from the BU and\n\
    \        sends an Access Request to the Home RADIUS server.\n   (5)  The Home\
    \ RADIUS server authenticates and authorizes the user and\n        sends back\
    \ a RADIUS Access Accept to the HA indicating\n        successful authentication\
    \ and authorization.\n   (6)  The HA performs a replay check with the ID field\
    \ in the received\n        BU.  The HA also performs proxy Duplicate Address Detection\n\
    \        (DAD) on the MN's home address (global) using proxy Neighbor\n      \
    \  Solicitation as specified in [RFC4861].\n   (7)  Assuming that proxy DAD is\
    \ successful, the HA sends back a\n        Binding Acknowledgment to the MN. \
    \ In this BAck message, the HA\n        includes the MN-HA mobility option, NAI\
    \ mobility option, and ID\n        mobility option.\n"
- title: 6.2.2.  Authentication and Security Details
  contents:
  - "6.2.2.  Authentication and Security Details\n   Access Link Setup, Access Authentication,\
    \ and Bootstrapping:\n   (1)  The MN brings up a PPP session.  The PDSN triggers\
    \ the MN to\n        perform CHAP authentication, as part of access authentication,\n\
    \        while bringing up the PPP link.\n   (2)  The MN is authenticated using\
    \ the PPP-CHAP by the H-AAA (Home\n        AAA), via the F-AAA (Foreign AAA).\n\
    \   (3)  The H-AAA may optionally send the HoA and HA IP address to the\n    \
    \    PDSN for bootstrapping the MN (skipping details).\n   Mobile IPv6 Authentication:\n\
    \   The call flow for the initial authentication (the numbers in the\n   parentheses\
    \ correspond to the explanation below):\n     MN                             \
    \       HA                    H-AAA\n      |              BU to HA (4)       \
    \    | RADIUS Access-ReQ(5)\n      |------------------------------------>|------------------->|(6)\n\
    \      | (includes NAI option, MN-ID option, |                    |\n      | Mesg\
    \ ID option, MN-AAA auth option) |RADIUS Access Accept|(7)\n      |\n        \
    \                                    |<-------------------|\n      |         \
    \                            |                    |\n      |                 \
    \            HA/AAAH authenticates MN\n      |\n      |                      \
    \               |(8)\n      |\n      |                                     |\n\
    \      |\n      |              BAck to MN    (9)        |\n      |\n      |<------------------------------------|--------------------|\n\
    \      | (including MN-ID option,            | (10)\n      |  Message ID option,\
    \                 |\n      |  MN-HA auth options)                |           \
    \         |\n             Figure 3: Flow Diagram for Initial Authentication\n\
    \   (4)  The MN sends a Binding Update (BU) to the HA.  The Binding\n        Update\
    \ is authenticated using the MN-AAA option.  The\n        authenticator in the\
    \ MN-AAA option is calculated using the hash\n        of the BU and MN-AAA shared\
    \ key.  It uses the HMAC_SHA1\n        algorithm.  The Security Parameter Index\
    \ (SPI) field in MN-AAA\n        is set to 3 (as per [RFC4285]).  The BU also\
    \ includes the NAI\n        and timestamp, among other details.  The hash of the\
    \ BU includes\n        the 'timestamp' option and thus provides proof of liveness\
    \ to\n        prevent replay.\n   (5)  The HA, on receiving the BU, extracts the\
    \ NAI, timestamp, and\n        authenticator from the MN-AAA option, and generates\
    \ the hash of\n        the BU.  The HA sends an Access Request to the AAA and\
    \ puts this\n        information in 3GPP2-defined VSAs (Vendor Specific Attributes).\n\
    \        The NAI is inserted in the username option in the Access Request\n  \
    \      message.  The other attributes sent are: the timestamp option,\n      \
    \  the hash of the BU (till SPI field of MN-AAA auth option), and\n        the\
    \ authentication data from the MN-AAA auth option.\n   (6)  AAA (RADIUS server\
    \ that interprets these attributes)\n        authenticates the MN based on the\
    \ hash of the BU and the\n        authenticator.  Proceed to step 7.\n   (7) \
    \ AAA calculates a session key based on the MN-AAA shared secret\n        and\
    \ timestamp, and sends this to the HA in an Access Accept (in\n        a 3GPP2-defined\
    \ VSA).\n   (8)  The HA creates a binding and a security association per\n   \
    \     Authentication Protocol for MIPv6 [RFC4285].  The key for this\n       \
    \ association is retrieved from the Access Accept and is referred\n        to\
    \ as the session key.  The HA associates a fixed SPI of 5 with\n        this SA,\
    \ and is associated with the binding for the MN.  (The\n        description of\
    \ this step skips the details for timestamp\n        processing at the HA.)\n\
    \   (9)  The HA sends a Binding Acknowledgement (BAck) to the MN.  The\n     \
    \   BAck has the MN-HA authentication option, authenticated using\n        the\
    \ session key.  This option has the SPI set to 5.\n   (10) On receiving a BAck,\
    \ the MN calculates the session key (using\n        the same method as AAA) and\
    \ associates it with an SPI value of\n        5.\n   The MN derives the session\
    \ key and SA using the timestamp in the BU\n   that the MN sent and the MN-AAA\
    \ shared key.  The MN uses this key to\n   authenticate the MN-HA option in the\
    \ Binding Ack.  If authentication\n   is successful, the MN creates a security\
    \ association with SPI=5.\n   This key is used to authenticate further BUs to\
    \ the HA using the\n   MN-HA auth option.  Once the binding lifetime expires and\
    \ the binding\n   is deleted, the binding as well as the security association\
    \ based on\n   the integrity key is removed at the MN and HA.\n   Migration from\
    \ MobileIPv4 to MobileIPv6 utilizes the same network\n   architecture and, specifically,\
    \ the same AAA infrastructure.  Thus,\n   it is natural to have similar signaling\
    \ in MIPv6 as in MIPv4,\n   specifically the authentication with AAA infrastructure.\n"
- title: 7.  Limitations of the Authentication Protocol Option
  contents:
  - "7.  Limitations of the Authentication Protocol Option\n   While the authentication\
    \ protocol as specified in [RFC4285] provides\n   Mobile IPv6 [RFC3775] deployments\
    \ a certain degree of flexibility, it\n   does have a few disadvantages as well.\
    \  These are:\n   (1)  The route optimization feature specified in RFC 3775 requires\
    \ a\n        secure transport (IPsec/ESP (Encapsulating Security Payload)\n  \
    \      mode) between the MN and HA.  In cases where the authentication\n     \
    \   protocol [RFC4285] is used as the means for securing the MIPv6\n        signaling\
    \ between the MN and HA, route optimization should be\n        switched off unless\
    \ the security of the signaling between the MN\n        and HA can be guaranteed\
    \ via other means (such as link-layer\n        security in the case of 3GPP2 networks).\n\
    \   (2)  The MIPv6 protocol is responsible for the security of the\n        signaling\
    \ messages as opposed to relying on IPsec for providing\n        the security.\n\
    \   (3)  In 3GPP2 networks, link-layer security mechanisms, ingress\n        filtering\
    \ at the PDSN, and various network domain security\n        mechanisms largely\
    \ ensure that reverse tunnelled packets\n        received by the HA do not have\
    \ spoofed source addresses, and\n        that their contents have not been modified.\
    \  This implies the HA\n        can determine the specific MN that sent the packet\
    \ simply by\n        verifying the outer-source IP address matches the currently\n\
    \        registered care-of address.  Authentication of payload packets\n    \
    \    can be necessary for, e.g.:\n        -     Authenticating signaling messages\
    \ other than BU/BAck\n              between the MN and HA, such as ICMPv6, MLD,\
    \ and DHCPv6.\n        -     Enforcing access control to the network behind the\
    \ HA.\n        -     Accounting or other flow-specific processing performed by\n\
    \              the HA.\n              This means the authentication option is\
    \ of limited\n              applicability in environments where the HA can receive\n\
    \              reverse-tunneled packets with spoofed source IP addresses\n   \
    \           and/or modified contents.\n   (4)  As described in [RFC4285], the\
    \ authentication option assumes\n        that the MN-AAA shared key and security\
    \ association are created\n        by out-of-band mechanisms.  These mechanisms\
    \ are specific to\n        specific deployment environments.  IKEv2, on the other\
    \ hand,\n        supports a wide range of authentication mechanisms, such as\n\
    \        certificates and Extensible Authentication Protocol (EAP)\n        methods,\
    \ and is independent of the access network technology\n        being used.  However,\
    \ it would be possible to specify a similar\n        authentication and key management\
    \ protocol for the\n        authentication option in the future.\n   (5)  Sending\
    \ the long-term user identity (NAI) in the clear raises\n        privacy concerns.\
    \  These concerns are addressed by access\n        network and network domain\
    \ security mechanisms in 3GPP2\n        networks, but do limit the applicability\
    \ in networks where\n        sniffing other users' traffic is possible.\n   (6)\
    \  RFC 4285 does not specify a mechanism for creating the MN-HA\n        shared\
    \ key and SA from the MN-AAA SA (unlike similar Mobile IPv4\n        mechanisms\
    \ defined in [RFC3957]), and thus relies on deployment-\n        specific mechanisms\
    \ not standardized in the IETF.\n   (7)  The authentication option does not support\
    \ negotiation of\n        cryptographic algorithms.\n   (8)  The replay protection\
    \ mechanisms in [RFC4285] rely on\n        timestamps, and thus require reasonably\
    \ synchronized clocks (by\n        default, +/- 7 seconds).  This assumes the\
    \ MN implements, and is\n        configured to use, some mechanism for synchronizing\
    \ its clock.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   When MIPv6 signaling messages use IPsec with\
    \ ESP encapsulation, they\n   are accorded privacy on the links over which the\
    \ messages traverse.\n   When MIPv6 signaling messages are secured using the authentication\n\
    \   protocol, such ciphering capability will have to be enabled by the\n   underlying\
    \ link layers.  It should be noted that the MIPv6 signaling\n   messages are susceptible\
    \ to snooping/sniffing when the authentication\n   protocol [RFC4285] is used.\
    \  Route optimization messages need to be\n   secured between the MN and HA and\
    \ this is not possible with the\n   authentication protocol.  However, route optimization\
    \ is not\n   supported in the current specification of the authentication protocol\n\
    \   in [RFC4285].\n   Security issues with RFC 4285 are specifically:\n   1. \
    \ Key length.  This is being addressed in [AUTH-PRO].\n   2.  The keys used for\
    \ securing the signaling between the MN and HA\n       are derived from a security\
    \ association that exists between the\n       MN and AAA.  The MIPv6 keys, which\
    \ are bootstrapped from the MN-\n       AAA SA, are transient.  Limiting the lifetime\
    \ of the keys to\n       shorter periods should be recommended.\n   3.  Location\
    \ privacy is an issue in the absence of lower-layer\n       security in the case\
    \ of shared links.\n"
- title: 9.  Conclusion
  contents:
  - "9.  Conclusion\n   Mobile IPv6 was published as a Standards Track RFC [RFC3775]\
    \ in 2004.\n   Deployment of this protocol on a large scale is in the interest\
    \ of\n   the IETF and the working group, as well as that of many people who\n\
    \   have worked on this.  A rigid model for deployment will cause the\n   protocol\
    \ to be limited to an academic exercise only.  It is extremely\n   critical that\
    \ the working group consider the needs of the industry\n   and the deployment\
    \ scenarios, and address them accordingly.  This\n   document captures the reasoning\
    \ behind the need for the\n   authentication protocol, which has been published\
    \ as RFC 4285.  RFC\n   4877 has alleviated some of the issues that have been\
    \ of primary\n   concern and were motivators for the authentication protocol.\n\
    \   However, the IETF should consider the architectures of networks such\n   as\
    \ 3GPP2 and WiMAX and their security models, and enable deployment\n   of Mobile\
    \ IPv6 without requiring IPsec.\n"
- title: 10.  Acknowledgements
  contents:
  - "10.  Acknowledgements\n   The authors would like to thank Alpesh Patel, AC Mahendra,\
    \ Kuntal\n   Chowdhury, and Vijay Devarapalli for their input and discussions.\n\
    \   Jari Arkko has reviewed the ID and provided valuable feedback.\n   Thomas\
    \ Narten has provided valuable reviews and made significant\n   improvements to\
    \ the text in this document.  In his role as the IETF\n   liaison to 3GPP2, Thomas\
    \ Narten has ensured that the IETF understands\n   the 3GPP2 requirements.  Pasi\
    \ Eronen, in his role as the Security AD,\n   has reviewed and helped improve\
    \ the document.  Vidya Narayanan has\n   reviewed the document from a security\
    \ directorate perspective and\n   provided input that has been incorporated.\n"
- title: 11.  References
  contents:
  - '11.  References

    '
- title: 11.1.  Normative References
  contents:
  - "11.1.  Normative References\n   [RFC2119]              Bradner, S., \"Key words\
    \ for use in RFCs to\n                          Indicate Requirement Levels\"\
    , BCP 14,\n                          RFC 2119, March 1997.\n   [RFC3736]     \
    \         Droms, R., \"Stateless Dynamic Host\n                          Configuration\
    \ Protocol (DHCP) Service for\n                          IPv6\", RFC 3736, April\
    \ 2004.\n   [RFC3775]              Johnson, D., Perkins, C., and J. Arkko,\n \
    \                         \"Mobility Support in IPv6\", RFC 3775,\n          \
    \                June 2004.\n   [RFC3776]              Arkko, J., Devarapalli,\
    \ V., and F. Dupont,\n                          \"Using IPsec to Protect Mobile\
    \ IPv6 Signaling\n                          Between Mobile Nodes and Home Agents\"\
    ,\n                          RFC 3776, June 2004.\n   [RFC4283]              Patel,\
    \ A., Leung, K., Khalil, M., Akhtar, H.,\n                          and K. Chowdhury,\
    \ \"Mobile Node Identifier\n                          Option for Mobile IPv6 (MIPv6)\"\
    , RFC 4283,\n                          November 2005.\n"
- title: 11.2.  Informative References
  contents:
  - "11.2.  Informative References\n   [3GPP2 X.S0011-002-D]  3GPP2 X.S0011-002-D,\
    \ \"cdma2000 Wireless IP\n                          Network Standard: Simple IP\
    \ and Mobile IP\n                          Access Services\", http://www.3gpp2.org/\n\
    \                          Public_html/specs/\n                          X.S0011-002-D_v1.0_060301.pdf,\
    \ February 2006.\n   [AUTH-PRO]             Patel, A., Leung, K., Khalil, M.,\
    \ Akhtar, H.,\n                          and K. Chowdhury, \"Authentication Protocol\
    \ for\n                          Mobile IPv6\", Work in Progress, July 2008.\n\
    \   [BOOT]                 Chowdhury, K. and A. Yegin, \"MIP6-\n             \
    \             Bootstrapping for the Integrated Scenario\",\n                 \
    \         Work in Progress, April 2008.\n   [RFC4861]              Narten, T.,\
    \ Nordmark, E., Simpson, W., and H.\n                          Soliman, \"Neighbor\
    \ Discovery for IP version 6\n                          (IPv6)\", RFC 4861, September\
    \ 2007.\n   [RFC3957]              Perkins, C. and P. Calhoun, \"Authentication,\n\
    \                          Authorization, and Accounting (AAA)\n             \
    \             Registration Keys for Mobile IPv4\", RFC 3957,\n               \
    \           March 2005.\n   [RFC4285]              Patel, A., Leung, K., Khalil,\
    \ M., Akhtar, H.,\n                          and K. Chowdhury, \"Authentication\
    \ Protocol for\n                          Mobile IPv6\", RFC 4285, January 2006.\n\
    \   [RFC4877]              Devarapalli, V. and F. Dupont, \"Mobile IPv6\n    \
    \                      Operation with IKEv2 and the Revised IPsec\n          \
    \                Architecture\", RFC 4877, April 2007.\n   [RFC5026]         \
    \     Giaretta, G., Kempf, J., and V. Devarapalli,\n                         \
    \ \"Mobile IPv6 Bootstrapping in Split Scenario\",\n                         \
    \ RFC 5026, October 2007.\n   [WiMAX-NWG]            \"WiMAX Network Architecture\
    \ - WiMAX End-to-End\n                          Network Systems Architecture\"\
    , May 2008, <http\n                          ://www.wimaxforum.org/documents/documents/\n\
    \                          WiMAX_Forum_Network_Architecture_Stage_2-\n       \
    \                   3_Rel_1v1.2.zip>.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Basavaraj Patil\n   Nokia\n   6021 Connection Drive\n\
    \   Irving, TX  75039\n   USA\n   EMail: basavaraj.patil@nokia.com\n   Gopal Dommety\n\
    \   Cisco\n   170 West Tasman Drive\n   San Jose, CA  95134\n   USA\n   EMail:\
    \ gdommety@cisco.com\n"
