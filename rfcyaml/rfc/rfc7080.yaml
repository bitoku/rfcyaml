- title: __initial_text__
  contents:
  - "          Virtual Private LAN Service (VPLS) Interoperability\n             \
    \        with Provider Backbone Bridges\n"
- title: Abstract
  contents:
  - "Abstract\n   The scalability of Hierarchical Virtual Private LAN Service (H-VPLS)\n\
    \   with Ethernet access networks (RFC 4762) can be improved by\n   incorporating\
    \ Provider Backbone Bridge functionality in the VPLS\n   access.  Provider Backbone\
    \ Bridging has been standardized as IEEE\n   802.1ah-2008.  It aims to improve\
    \ the scalability of Media Access\n   Control (MAC) addresses and service instances\
    \ in Provider Ethernet\n   networks.  This document describes different interoperability\n\
    \   scenarios where Provider Backbone Bridge functionality is used in\n   H-VPLS\
    \ with Ethernet or MPLS access network to attain better\n   scalability in terms\
    \ of number of customer MAC addresses and number\n   of service instances.  The\
    \ document also describes the scenarios and\n   the mechanisms for incorporating\
    \ Provider Backbone Bridge\n   functionality within H-VPLS with existing Ethernet\
    \ access and\n   interoperability among them.  Furthermore, the document discusses\
    \ the\n   migration mechanisms and scenarios by which Provider Backbone Bridge\n\
    \   functionality can be incorporated into H-VPLS with existing MPLS\n   access.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7080.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2013 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................3\n  \
    \ 3. Applicability ...................................................5\n   4.\
    \ H-VPLS with Homogeneous PBBN Access .............................6\n      4.1.\
    \ Service Interfaces and Interworking Options ................8\n      4.2. H-VPLS\
    \ with PBBN Access: Type I Service Interface .........10\n      4.3. H-VPLS with\
    \ PBBN Access: Type II Service Interface ........11\n   5. H-VPLS with Mixed PBBN\
    \ Access and PBN Access ...................14\n      5.1. H-VPLS with Mixed PBBN\
    \ and PBN Access: Modified PBN PE ....15\n      5.2. H-VPLS with Mixed PBBN and\
    \ PBN Access: Regular PBN PE .....16\n   6. H-VPLS with MPLS Access ........................................17\n\
    \      6.1. H-VPLS with MPLS Access: PBB U-PE .........................17\n  \
    \    6.2. H-VPLS with MPLS Access: PBB N-PE .........................19\n   7.\
    \ H-VPLS with MPLS Access: PBB Migration Scenarios ...............21\n      7.1.\
    \ 802.1ad Service Frames over VPLS Core .....................21\n      7.2. PBB\
    \ Service Frames over VPLS Core .........................22\n      7.3. Mixed\
    \ 802.1ad and PBB over VPLS Core ......................23\n   8. Acknowledgments\
    \ ................................................24\n   9. Security Considerations\
    \ ........................................24\n   10. References ....................................................24\n\
    \      10.1. Normative References .....................................24\n  \
    \    10.2. Informative References ...................................25\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The scalability of Hierarchical Virtual Private LAN Service\
    \ (H-VPLS)\n   with Ethernet access networks [RFC4762] can be improved by\n  \
    \ incorporating Provider Backbone Bridge (PBB) functionality in the\n   VPLS access.\
    \  Provider Backbone Bridging has been standardized as\n   IEEE 802.1ah-2008 [802.1ah],\
    \ which is an amendment to IEEE 802.1Q to\n   improve the scalability of Media\
    \ Access Control (MAC) addresses and\n   service instances in Provider Ethernet\
    \ networks.  This document\n   describes interoperability scenarios where IEEE\
    \ 802.1ah functionality\n   is used in H-VPLS with Ethernet or MPLS access network\
    \ to attain\n   better scalability in terms of the number of customer MAC addresses\n\
    \   and the number of services.\n   This document also covers the interoperability\
    \ scenarios for\n   deploying H-VPLS with Provider Backbone Bridging Ethernet\
    \ access when\n   other types of access networks are deployed, including existing\n\
    \   802.1ad Ethernet and MPLS access in either single or multiple service\n  \
    \ domains.  Furthermore, the document explores the scenarios by which\n   an operator\
    \ can gradually migrate an existing H-VPLS network to\n   Provider Backbone Bridging\
    \ over VPLS.\n   Section 2 gives a quick terminology reference and Section 3\n\
    \   highlights the applicability of Provider Backbone Bridging\n   interoperation\
    \ with VPLS.  Section 4 describes H-VPLS with\n   homogeneous Provider Backbone\
    \ Bridge Access Network.  Section 5\n   discusses H-VPLS with mixed 802.1ah/802.1ad\
    \ access.  Section 6\n   focuses on Provider Backbone Bridging in H-VPLS with\
    \ MPLS Access\n   Network including PBB function on U-PE and on N-PE variants.\n\
    \   Finally, Section 7 describes gradual migration scenarios from\n   existing\
    \ H-VPLS to Provider Backbone Bridging over H-VPLS.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   802.1ad: IEEE specification for \"QinQ\" encapsulation and\
    \ bridging of\n      Ethernet frames.\n   802.1ah: IEEE specification for \"MAC\
    \ tunneling\" encapsulation and\n      bridging of frames across a Provider Backbone\
    \ Bridged Network\n      (PBBN).\n   B-BEB: A backbone edge bridge positioned\
    \ at the edge of a PBBN.  It\n      contains a B-component that supports bridging\
    \ in the provider\n      backbone based on B-MAC and B-TAG information.\n   B-MAC:\
    \ The backbone source or destination MAC address fields defined\n      in the\
    \ 802.1ah provider MAC encapsulation header.\n   BCB: A backbone core bridge running\
    \ in the core of a provider\n      backbone bridged network.  It bridges frames\
    \ based on B-TAG\n      information just as an 802.1ad provider bridge will bridge\
    \ frames\n      based on a Service VLAN (S-VLAN) identifier.\n   B-Component:\
    \ The backbone component of a Provider Backbone edge\n      bridge as defined\
    \ in [802.1ah].\n   BEB: A backbone edge bridge positioned at the edge of a provider\n\
    \      backbone bridged network.  It can contain an I-component,\n      B-component,\
    \ or both.\n   B-MACs: Backbone MAC addresses -- outer MAC addresses of a PBB-\n\
    \      encapsulated frame.\n   B-TAG: A field defined in the 802.1ah provider\
    \ MAC encapsulation\n      header that conveys the backbone VLAN identifier information.\
    \  The\n      format of the B-TAG field is the same as that of an 802.1ad S-TAG\n\
    \      field.\n   B-Tagged Service Interface: This is the interface between a\
    \ BEB and\n      BCB in a PBB network.  Frames passed through this interface\n\
    \      contain a B-TAG field.\n   B-VID: This is the specific VLAN identifier\
    \ carried inside a B-TAG\n   C-MACs: Customer MAC addresses are the inner MAC\
    \ addresses of a PBB-\n      encapsulated frame.\n   H-VPLS: Hierarchical Virtual\
    \ Private LAN Service.\n   I-component: A bridging component contained in a backbone\
    \ edge bridge\n      that bridges in the customer space (customer MAC addresses,\n\
    \      S-VLAN).\n   IB-BEB: A backbone edge bridge positioned at the edge of a\
    \ provider\n      backbone bridged network.  It contains an I-component for bridging\n\
    \      in the customer space (customer MAC addresses, S-VLAN IDs) and a\n    \
    \  B-component for bridging the provider's backbone space (B-MAC,\n      B-TAG).\n\
    \   I-BEB: A backbone edge bridge positioned at the edge of a provider\n     \
    \ backbone bridged network.  It contains an I-component for bridging\n      in\
    \ the customer space (customer MAC addresses, S-VLAN IDs).\n   I-SID: The 24-bit\
    \ service instance field carried inside the I-TAG.\n      I-SID defines the service\
    \ instance that the frame should be\n      \"mapped to\".\n   I-TAG: A field defined\
    \ in the 802.1ah provider MAC encapsulation\n      header that conveys the service\
    \ instance information (I-SID)\n      associated with the frame.\n   I-Tagged\
    \ Service Interface: This is the interface defined between the\n      I-component\
    \ and B-component inside an IB-BEB or between two\n      B-BEBs.  Frames passed\
    \ through this interface contain an I-TAG\n      field.\n   N-PE: Network-facing\
    \ Provider Edge\n   PBB: Provider Backbone Bridge\n   PBBN: Provider Backbone\
    \ Bridged Network\n   PBN: Provider Bridged Network.  A network that employs 802.1ad\
    \ (QinQ)\n      technology.\n   S-TAG: A field defined in the 802.1ad QinQ encapsulation\
    \ header that\n      conveys the Service VLAN (S-VLAN) identifier information.\n\
    \   S-Tagged Service Interface: This the interface defined between the\n     \
    \ customer (CE) and the I-BEB or IB-BEB components.  Frames passed\n      through\
    \ this interface contain an S-TAG field.\n   S-VLAN: The specific Service VLAN\
    \ identifier carried inside an S-TAG\n   U-PE: User-facing Provider Edge\n   VPLS:\
    \ Virtual Private LAN Service\n"
- title: 3.  Applicability
  contents:
  - "3.  Applicability\n   [RFC4762] describes a two-tier hierarchical solution for\
    \ VPLS for the\n   purpose of improved pseudowire (PW) scalability.  This improvement\
    \ is\n   achieved by reducing the number of PE devices connected in a full-\n\
    \   mesh topology through connecting CE devices via the lower-tier access\n  \
    \ network, which in turn is connected to the top-tier core network.\n   [RFC4762]\
    \ describes two types of H-VPLS network topologies -- one\n   with an MPLS access\
    \ network and another with an IEEE 802.1ad (QinQ)\n   Ethernet access network.\
    \  In both types of H-VPLS, the learning and\n   forwarding of MAC addresses is\
    \ based on customer MAC addresses\n   (C-MACs), which poses scalability issues\
    \ as the number of VPLS\n   instances (and thus C-MACs) increases.  Furthermore,\
    \ since a set of\n   PWs is maintained on a per customer service instance basis,\
    \ the\n   number of PWs required at N-PE devices is proportional to the number\n\
    \   of customer service instances multiplied by the number of N-PE\n   devices\
    \ in the full-mesh set.  This can result in scalability issues\n   (in terms of\
    \ PW manageability and troubleshooting) as the number of\n   customer service\
    \ instances grows.\n   In addition to the above, H-VPLS with an 802.1ad Ethernet\
    \ access\n   network has another scalability issue in terms of the maximum number\n\
    \   of service instances that can be supported in the access network as\n   described\
    \ in [RFC4762].  Since the number of provider VLANs (S-VLANs)\n   is limited to\
    \ 4094 and each S-VLAN represents a service instance in\n   an 802.1ad network,\
    \ then the maximum number of service instances that\n   can be supported is 4094.\
    \  These issues are highlighted in [RFC6246].\n   This document describes how\
    \ IEEE 802.1ah (aka Provider Backbone\n   Bridges) can be integrated with H-VPLS\
    \ to address these scalability\n   issues.  In the case of H-VPLS with 802.1ah\
    \ Ethernet access, the\n   solution results in better scalability in terms of\
    \ both number of\n   service instances and number of C-MACs in the Ethernet access\
    \ network\n   and the VPLS core network, as well as number of PWs in VPLS core\n\
    \   network.  And in the case of H-VPLS with MPLS access, Provider\n   Backbone\
    \ Bridging functionality can be used at the U-PE or N-PE,\n   which results in\
    \ reduction of customer MAC addresses and the number\n   of PWs in the VPLS core\
    \ network.\n   The interoperability scenarios depicted in this document fall into\n\
    \   the following two categories:\n   -  Scenarios in which Provider Backbone\
    \ Bridging seamlessly works\n      with current VPLS implementations (e.g., Section\
    \ 4.2).\n   -  Scenarios in which VPLS-PE implementations need to be upgraded\
    \ in\n      order to work with Provider Backbone Bridging (e.g., Sections 4.3\n\
    \      and 5.1).\n"
- title: 4.  H-VPLS with Homogeneous PBBN Access
  contents:
  - "4.  H-VPLS with Homogeneous PBBN Access\n   PBBN access offers MAC-address-table\
    \ scalability for H-VPLS PE nodes.\n   This is due to the MAC tunneling encapsulation\
    \ scheme of PBB, which\n   only exposes the provider's own MAC addresses to PE\
    \ nodes (B-MACs of\n   Provider's PBB-capable devices in the access network),\
    \ as opposed to\n   customers' MAC addresses in conventional H-VPLS with MPLS\
    \ or 802.1ad\n   access.\n   PBBN access also offers service-instance scalability\
    \ when compared to\n   H-VPLS with 802.1Q/802.1ad access networks.  This is due\
    \ to the new\n   24-bit service identifier (I-SID) used in PBB encapsulation,\
    \ which\n   allows up to 16M services per PBB access network, compared to 4094\n\
    \   services per 802.1Q/802.1ad access network.\n   Another important advantage\
    \ of PBBN access is that it offers clear\n   separation between the service layer\
    \ (represented by I-SID) and the\n   network layer (represented by B-VLAN).  B-VLANs\
    \ segregate a PBB\n   access network into different broadcast domains and possibly\
    \ unique\n   spanning-tree topologies, with each domain being able to carry\n\
    \   multiple services (i.e., I-SIDs).  In 802.1ad access networks, the\n   network\
    \ and service layers are the same (represented by S-VLAN).\n   This separation\
    \ allows the provider to manage and optimize the PBB\n   access network topology\
    \ independent of the number of service\n   instances that are supported.\n   In\
    \ this section and those following, we look into different flavors\n   of H-VPLS\
    \ with PBBN access.  This section discusses the case in which\n   H-VPLS is deployed\
    \ with homogeneous PBBN access.  Section 5 describes\n   the case in which at\
    \ least one of the access networks has PBN access\n   (QinQ/802.1ad) while the\
    \ others are PBBNs.\n   On a macro scale, a network that employs H-VPLS with PBBN\
    \ access can\n   be represented as shown in Figure 1 below.\n                \
    \           +--------------+\n                           |              |\n  \
    \         +---------+     |    IP/MPLS   |    +---------+\n   +----+  |      \
    \   |   +----+        +----+  |         |  +----+\n   | CE |--|         |   |VPLS|\
    \        |VPLS|  |         |--| CE |\n   +----+  |  PBBN   |---| PE |        |\
    \ PE |--|  PBBN   |  +----+\n   +----+  | 802.1ah |   +----+        +----+  |\
    \ 802.1ah |  +----+\n   | CE |--|         |     |   Backbone   |    |        \
    \ |--| CE |\n   +----+  +---------+     +--------------+    +---------+  +----+\n\
    \                    Figure 1: H-VPLS with PBBN Access\n   In the context of PBBN\
    \ and H-VPLS interoperability, \"I-SID Domain\"\n   and \"B-VLAN Domain\" can\
    \ be defined as follows:\n   -  \"I-SID Domain\" refers to a network administrative\
    \ boundary under\n      which all the PBB BEBs and VPLS-PE devices use the same\
    \ I-SID\n      space.  That is, the I-SID assignment is carried out by the same\n\
    \      administration.  This effectively means that a given service\n      instance\
    \ has the same I-SID designation on all devices within an\n      I-SID Domain.\n\
    \   -  \"B-VLAN Domain\" refers to a network administrative boundary under\n \
    \     which all the PBB BEBs and VPLS-PE devices employ consistent I-SID\n   \
    \   to B-VLAN bundling.  For example, the grouping of I-SIDs to\n      B-VLANs\
    \ is the same in that domain.  Although the two B-VLANs in\n      two PBBNs that\
    \ represent the same group of I-SIDs do not need to\n      use the same B-VID\
    \ value, in practice, they often use the same\n      value because once the I-SID\
    \ grouping is made identical in two\n      PBBNs.  It is very easy to make the\
    \ values of the corresponding\n      B-VIDs identical also.\n   Consequently,\
    \ three different kinds of \"Service Domains\" are defined\n   in the following\
    \ manner:\n   -  Tightly Coupled Service Domain - Different PBBNs' access belonging\n\
    \      to the same I-SID Domain and B-VLAN Domain.  However, the network\n   \
    \   control protocols (e.g., xSTP) run independently in each PBBN\n      access.\n\
    \   -  Loosely Coupled Service Domain - Different PBBNs' access belonging\n  \
    \    to the same I-SID Domain.  However, each PBBN access maintains its\n    \
    \  own independent B-VLAN Domain.  Again, the network control\n      protocols\
    \ (e.g., xSTP) run independently in each PBBN access.\n   -  Different Service\
    \ Domain - In this case, each PBBN access\n      maintains its own independent\
    \ I-SID Domain and B-VLAN Domain, with\n      independent network control protocols\
    \ (e.g., xSTP) in each PBBN\n      access.\n   In general, correct service connectivity\
    \ spanning networks in a\n   Tightly Coupled Service Domain can be achieved via\
    \ B-VID mapping\n   between the networks (often even without B-VID translation).\n\
    \   However, correct service connectivity spanning networks in a Loosely\n   Coupled\
    \ Service Domain requires I-SID to B-VID remapping (i.e.,\n   unbundling and rebundling\
    \ of I-SIDs into B-VIDs).  Furthermore,\n   service connectivity spanning networks\
    \ in Different Service Domains\n   requires both I-SID translation and I-SID to\
    \ B-VID remapping.\n"
- title: 4.1.  Service Interfaces and Interworking Options
  contents:
  - "4.1.  Service Interfaces and Interworking Options\n   Customer devices will interface\
    \ with PBBN edge bridges using existing\n   Ethernet interfaces including IEEE\
    \ 802.1Q and IEEE 802.1ad.  At the\n   PBBN edge, C-MAC frames are encapsulated\
    \ in a PBB header that\n   includes service provider source and destination MAC\
    \ addresses\n   (B-MACs) and are bridged up to the VPLS-PE.  The PBB-encapsulated\n\
    \   C-MAC frame is then injected into the VPLS backbone network,\n   delivered\
    \ to the remote VPLS-PE node(s), and switched onto the remote\n   PBBN access.\
    \  From there, the PBBN bridges the encapsulated frame to\n   a PBBN edge bridge\
    \ where the PBB header is removed and the customer\n   frame is sent to the customer\
    \ domain.\n   Interoperating between PBBN devices and VPLS-PE nodes can leverage\n\
    \   the BEB functions already defined in [802.1ah].  When I-SID\n   visibility\
    \ is required at the VPLS-PE nodes, a new service interface\n   based on I-SID\
    \ tag will need to be defined.\n   Moreover, by mapping a bridge domain (e.g.,\
    \ B-VLAN) to a VPLS\n   instance, and bundling multiple end-customer service instances\n\
    \   (represented by I-SID) over the same bridge domain, service providers\n  \
    \ will be able to significantly reduce the number of full-mesh PWs\n   required\
    \ in the core.  In this case, I-SID visibility is not required\n   on the VPLS-PE\
    \ and the I-SID will serve as the means of\n   multiplexing/de-multiplexing individual\
    \ service instances in the PBBN\n   over a bundle (e.g., B-VLAN).\n   When I-SID\
    \ visibility is expected across the service interface at the\n   VPLS-PE, the\
    \ VPLS-PE can be considered to offer service-level\n   interworking between PBBN\
    \ access and the IP/MPLS core.  Similarly,\n   when the PE is not expected to\
    \ have visibility of the I-SID at the\n   service interface, the VPLS-PE can be\
    \ considered to offer network-\n   level interworking between PBBN access and\
    \ the MPLS core.\n   A VPLS-PE is always part of the IP/MPLS core, and it may\
    \ optionally\n   participate in the control protocols (e.g., xSTP) of the access\n\
    \   network.  When connecting to a PBBN access, the VPLS-PE needs to\n   support\
    \ one of the following two types of service interfaces:\n      -  Type I: B-Tagged\
    \ Service Interface with B-VID as Service\n         Delimiter\n   The PE connects\
    \ to a Backbone Core Bridge (BCB) in the PBBN access.\n   The handoff between\
    \ the BCB and the PE is B-Tagged PBB-encapsulated\n   frames.  The PE is transparent\
    \ to PBB encapsulations and treats these\n   frames as 802.1ad frames since the\
    \ B-VID EtherType is the same as the\n   S-VID EtherType.  The PE does not need\
    \ to support PBB functionality.\n   This corresponds to conventional VPLS-PEs'\
    \ tagged service interface.\n   When using Type I service interface, the PE needs\
    \ to support either\n   raw mode or tagged mode Ethernet PW.  Type I service interface\
    \ is\n   described in detail in Section 4.2.\n      -  Type II: I-Tagged Service\
    \ Interface with I-SID as Service\n         Delimiter\n   The PE connects to a\
    \ B-BEB (backbone edge bridge with B-component) in\n   the PBBN access.  The PE\
    \ itself also supports the B-BEB functionality\n   of [802.1ah].  The handoff\
    \ between the B-BEB in the PBBN access and\n   the PE is an I-Tagged PBB-encapsulated\
    \ frame.  With Type II service\n   interface, the PE supports the existing raw\
    \ mode and tagged mode PW\n   types.  Type II service interface is described in\
    \ detail in Section\n   4.3.\n"
- title: '4.2.  H-VPLS with PBBN Access: Type I Service Interface'
  contents:
  - "4.2.  H-VPLS with PBBN Access: Type I Service Interface\n   This is a B-Tagged\
    \ service interface with B-VID as service delimiter\n   on the VPLS-PE.  It does\
    \ not require any new functionality on the\n   VPLS-PE.  As shown in Figure 2,\
    \ the PE is always part of the IP/MPLS\n   core.  The PE may also be part of the\
    \ PBBN access (e.g., VPLS-PE on\n   right side of Figure 2) by participating in\
    \ network control protocols\n   (e.g., xSTP) of the PBBN access.\n        PBBN\
    \ Access       IP/MPLS Core      PBBN Access\n                        +--------------+\n\
    \        +---------+     |              | +---------------+\n        |       \
    \  |    +----+          | |               |\n        |      +---+   |VPLS|   +-+\
    \    | |    +---+      |\n        |      |BCB|---| PE |---|P|    | |    |BCB|\
    \      |\n        |      +---+  /+----+  /+-+   | |   /+---+      |\n        |+---+\
    \    |  / +----+ /     +----+ /       +---+|\n   +--+ ||IB-| +---+/  |VPLS|/ \
    \ +-+  |VPLS|/  +---+ |IB-|| +--+\n   |CE|-||BEB|-|BCB|---| PE |---|P|--| PE |---|BCB|-|BEB|--|CE|\n\
    \   +--+ |+---+ +---+ ^ +----+   +-+  +----+ ^ +---+ +---+| +--+\n        |  \
    \       |  |  |              | |  |            |\n        +---------+  |  |  \
    \            | +--|------------+\n                     |  +--------------+   \
    \ |\n                     |                      |\n                   Type I\
    \                  Type I\n     Figure 2: H-VPLS with PBBN Access and Type I Service\
    \ Interface\n   Type I service interface is applicable to networks with Tightly\n\
    \   Coupled Service Domains, where both I-SID Domains and B-VLAN Domains\n   are\
    \ the same across all PBBN access networks.\n   The BCB and the VPLS-PE will exchange\
    \ PBB-encapsulated frames that\n   include source and destination B-MACs, a B-VID,\
    \ and an I-SID.  The\n   service delimiter, from the perspective of the VPLS-PE,\
    \ is the B-VID;\n   in fact, this interface operates exactly as a current 802.1Q/ad\n\
    \   interface into a VPLS-PE does today.  With Type I service interface,\n   the\
    \ VPLS-PE can be considered to provide network-level interworking\n   between\
    \ PBBN and MPLS domains, since VPLS-PE does not have visibility\n   of I-SIDs.\n\
    \   The main advantage of this service interface, when compared to other\n   types,\
    \ is that it allows the service provider to save on the number\n   of full-mesh\
    \ PWs required in the core.  This is primarily because\n   multiple service instances\
    \ (I-SIDs) are bundled over a single full-\n   mesh PW corresponding to a bridge\
    \ domain (e.g., B-VID), instead of\n   requiring a dedicated full-mesh PW per\
    \ service instance.  Another\n   advantage is the MAC address scalability in the\
    \ core since the core\n   is not exposed to C-MACs.\n   The disadvantage of this\
    \ interface is the comparably excessive\n   replication required in the core:\
    \ since a group of service instances\n   share the same full-mesh of PWs, an unknown\
    \ unicast, multicast, or\n   broadcast on a single service instance will result\
    \ in a flood over\n   the core.  This, however, can be mitigated via the use of\
    \ flood\n   containment per I-SID (B-MAC multicast pruning).\n   Three different\
    \ modes of operation are supported by Type I service\n   interface:\n   -  Port\
    \ Mode: All traffic over an interface in this mode is mapped to\n      a single\
    \ VPLS instance.  Existing PW signaling and Ethernet raw\n      mode (0x0005)\
    \ PW type, defined in [RFC4447] and [RFC4448], are\n      supported.\n   -  VLAN\
    \ Mode: all traffic associated with a particular VLAN\n      identified by the\
    \ B-VID is mapped to a single VPLS instance.\n      Existing PW signaling and\
    \ Ethernet raw mode (0x0005) PW type,\n      defined in [RFC4447] and [RFC4448],\
    \ are supported.\n   -  VLAN Bundling Mode: all traffic associated with a group\
    \ or range\n      of VLANs or B-VIDs is mapped to a single VPLS instance.  Existing\n\
    \      PW signaling and Ethernet raw mode (0x0005) PW type, defined in\n     \
    \ [RFC4447] and [RFC4448], are supported.\n   For the VLAN mode, it is also possible\
    \ to use Ethernet tagged mode\n   (0x0004) PW, as defined in [RFC4447] and [RFC4448],\
    \ for\n   interoperability with equipment that does not support raw mode.  The\n\
    \   use of raw mode is recommended to be the default though.\n"
- title: '4.3.  H-VPLS with PBBN Access: Type II Service Interface'
  contents:
  - "4.3.  H-VPLS with PBBN Access: Type II Service Interface\n   This is an I-Tagged\
    \ service interface with I-SID as service delimiter\n   on the VPLS-PE.  It requires\
    \ the VPLS-PE to include the B-component\n   of PBB BEB for I-SID processing in\
    \ addition to the capability to map\n   an I-SID Bundle to a VPLS instance.  As\
    \ shown in Figure 3, the PE is\n   always part of the IP/MPLS core and connects\
    \ to one or more B-BEBs in\n   the PBBN access.\n        PBBN Access      IP/MPLS\
    \ Core      PBBN Access\n                       +--------------+\n        +---------+\
    \    |              |    +---------+\n        |         |    |              |\
    \    |         |\n        |      +---+  +-----+         |    |  +---+  |\n   \
    \     |      |B- |  |PE w/| +-+     |    |  |BCB|  |\n        |      |BEB|--|B-BEB|-|P|\
    \     |    |  +---+  |\n        |      +---+ /+-----+ +-+     |    | /   |   |\n\
    \        |+---+ +---+/ +-----+/    +-----+ +---+ +---+|\n   +--+ ||IB-| |B- |\
    \  |PE w/| +-+ |PE w/| |B- | |IB-|| +--+\n   |CE|-||BEB|-|BEB|--|B-BEB|-|P|-|B-BEB|-|BEB|\
    \ |BEB|--|CE|\n   +--+ |+---+ +---+ ^+-----+ +-+ +-----+^+---+ +---+| +--+\n \
    \       |         |  |  |             |  | |         |\n        +---------+  |\
    \  |             |  | +---------+\n                     |  +-------------+  |\n\
    \                     |                   |\n                 Type II        \
    \     Type II\n   Figure 3: H-VPLS with PBBN Access and Type II Service Interface\n\
    \   Type II service interface is applicable to Loosely Coupled Service\n   Domains\
    \ and Different Service Domains.  B-VLAN Domains can be\n   independent and the\
    \ B-VID is always locally significant in each PBBN\n   access: it does not need\
    \ to be transported over the IP/MPLS core.\n   Given the above, it should be apparent\
    \ that Type II service interface\n   is applicable to Tightly Coupled Service\
    \ Domains as well.\n   By definition, the B-BEB connecting to the VPLS-PE will\
    \ remove any\n   B-VLAN tags for frames exiting the PBBN access.  The B-BEB and\n\
    \   VPLS-PE will exchange PBB-encapsulated frames that include source and\n  \
    \ destination B-MACs and an I-SID.  The service delimiter, from the\n   perspective\
    \ of the VPLS-PE, is the I-SID.  Since the PE has\n   visibility of I-SIDs, the\
    \ PE provides service-level interworking\n   between PBBN access and IP/MPLS core.\n\
    \   Type II service interface may operate in I-SID Bundling Mode: all\n   traffic\
    \ associated with a group or range of I-SIDs is mapped to a\n   single VPLS instance.\
    \  The PE maintains a mapping of I-SIDs to a PE\n   local bridge domain (e.g.,\
    \ B-VID).  The VPLS instance is then\n   associated with this bridge domain. \
    \ With Loosely Coupled service\n   Domains, no I-SID translation needs to be performed.\
    \  Type II Service\n   interface also supports Different Service Domains in this\
    \ mode, since\n   the B-BEB link in the PE connecting to the local PBBN can perform\
    \ the\n   translation of PBBN-specific I-SID to a local I-SID within the\n   IP/MPLS\
    \ core, which may then be translated to the other PBBN-specific\n   I-SID on the\
    \ egress PE.  Such translation can also occur in the B-BEB\n   of PBBN access.\
    \  Existing PW signaling and Ethernet raw mode\n   (0x0005), defined in [RFC4447]\
    \ and [RFC4448], is supported.  It is\n   also possible to use a tagged mode (0x0004)\
    \ PW for purpose of\n   interoperability with equipment that does not support\
    \ raw mode.\n   Type II service interface provides operators with the flexibility\
    \ to\n   trade off PW state for multicast flooding containment, since a full-\n\
    \   mesh of PWs can be set up:\n   a. per I-SID,\n   b. per group of I-SIDs, or\n\
    \   c. for all I-SIDs.\n   For (a) and (b), the advantage that Type II service\
    \ interface has\n   compared to Type I is that it can reduce replication in the\
    \ core\n   without the need for a mechanism that provides flood containment per-\n\
    \   I-SID (B-MAC multicast pruning).  This is mainly due to the increased\n  \
    \ segregation of service instances over disjoint full meshes of PWs.\n   For (c),\
    \ both Type II and Type I service interfaces are at par with\n   regard to flood\
    \ containment.\n   For (a) and (b), the disadvantage of this service interface,\
    \ compared\n   to Type I, is that it may require a larger number of full-mesh\
    \ PWs in\n   the core.  For (c), both Type II and Type I service interfaces are\
    \ at\n   par with regard to PW state.  However, for all three scenarios, the\n\
    \   number of full-mesh PWs can still be fewer than the number required\n   by\
    \ H-VPLS without PBBN access, since an I-SID can multiplex many\n   S-VLANs.\n\
    \   It is expected that this interface type will be used for customers\n   with\
    \ significant multicast traffic (but without multicast pruning\n   capability\
    \ in the VPLS-PE) so that a separate VPLS instance is set up\n   per group of\
    \ customers with similar geographic locality (per I-SID\n   group).\n   Note:\
    \ Port mode is not called out in Type II service interface since\n   it requires\
    \ the mapping of I-SIDs to be identical on different\n   I-Tagged interfaces across\
    \ VPLS network.  If this is indeed the case,\n   Port mode defined in Type I service\
    \ interface (Section 4.2) can be\n   used.\n"
- title: 5.  H-VPLS with Mixed PBBN Access and PBN Access
  contents:
  - "5.  H-VPLS with Mixed PBBN Access and PBN Access\n   It is foreseeable that service\
    \ providers will want to interoperate\n   their existing Provider Bridged Networks\
    \ (PBNs) with Provider\n   Backbone Bridged Networks (PBBNs) over H-VPLS.  Figure\
    \ 4 below shows\n   the high-level network topology.\n                       \
    \    +--------------+\n                           |              |\n         \
    \  +---------+     |    IP/MPLS   |    +---------+\n   +----+  |         |   +----+\
    \        +----+  |         |  +----+\n   | CE |--|   PBN   |   |VPLS|        |VPLS|\
    \  |         |--| CE |\n   +----+  |  (QinQ) |---| PE1|        | PE2|--|  PBBN\
    \   |  +----+\n   +----+  | 802.1ad |   +----+        +----+  | 802.1ah |  +----+\n\
    \   | CE |--|         |     |   Backbone   |    |         |--| CE |\n   +----+\
    \  +---------+     +--------------+    +---------+  +----+\n       Figure 4: H-VPLS\
    \ with Mixed PBN and PBBN Access Networks\n   Referring to Figure 4 above, two\
    \ possibilities come into play\n   depending on whether the interworking is carried\
    \ out at PE1 or PE2.\n   These are described in the following subsections.\n"
- title: '5.1.  H-VPLS with Mixed PBBN and PBN Access: Modified PBN PE'
  contents:
  - "5.1.  H-VPLS with Mixed PBBN and PBN Access: Modified PBN PE\n   As shown in\
    \ Figure 5, the operation of VPLS-PE2 (connecting to the\n   PBBN access on the\
    \ right) is no different from what was discussed in\n   Section 4.  Type II service\
    \ interface, as discussed in the above\n   section, is applicable.  It is the\
    \ behavior of VPLS-PE1 (connecting\n   to the PBN access on the left) that is\
    \ the focus of this section.\n         PBN Access       IP/MPLS Core      PBBN\
    \ Access\n          (802.1ad)     +--------------+     (802.1ah)\n           \
    \             |              |    +---------+\n         +---------+    |     \
    \         |    |         |\n         |         |   +-----+         |    |  +---+\
    \  |\n         |      +---+  |PE w/| +-+     |    |  |BCB|  |\n         |    \
    \  |PCB|--|IBBEB|-|P|     |    |  +---+  |\n         |      +---+ /+-----+ +-+\
    \     |    | /   |   |\n         |         | / +-----+/    +-----+ +---+ +---+|\n\
    \    +--+ |+---+ +---+  |PE w/| +-+ |PE w/| |B- | |IB-|| +--+\n    |CE|-||PEB|-|PCB|--|IBBEB|-|P|-|B-BEB|-|BEB|\
    \ |BEB|--|CE|\n    +--+ |+---+ +---+ ^+-----+ +-+ +-----+^+---+ +---+| +--+\n\
    \         |         |  |  |PE1       PE2|  | |         |\n         +---------+\
    \  |  |             |  | +---------+\n                      |  +-------------+\
    \  |\n                      |                   |\n                  S-Tagged\
    \           Type II (I-Tagged)\n   Figure 5: H-VPLS with Mixed PBN and PBBN Access:\
    \ Modified PBN PE\n   Some assumptions made for this topology include:\n   - \
    \ CE is directly connected to PBBN via S-Tagged or port-based\n      interface.\n\
    \   -  I-SID in PBBN access represents the same customer as S-VID in PBN\n   \
    \   access.\n   -  At S-Tagged service interface of PE with IB-BEB functionality\n\
    \      (e.g., PE1 in Figure 5), the only viable service is 1:1 mapping of\n  \
    \    S-VID to I-SID.  However, towards the core network side, the same\n     \
    \ PE can support I-SID bundling into a VPLS instance.\n   -  PE1 participates\
    \ in the local I-SID Domain of the IP/MPLS core so\n      the model accommodates\
    \ for the rest of the PBB network any of the\n      three domain types described\
    \ in Section 4 -- Tightly Coupled,\n      Loosely Coupled, and Different Service\
    \ Domains.\n   -  For ease of provisioning in these disparate access networks,\
    \ it is\n      recommended to use the same I-SID Domain among the PBBN access\n\
    \      networks and the PEs with IB-BEB functionality (those connecting\n    \
    \  to PBN).\n   This topology operates in I-SID Bundling Mode: at a PE connecting\
    \ to\n   PBN access, each S-VID is mapped to an I-SID and subsequently a group\n\
    \   of I-SIDs is mapped to a VPLS instance.  Similarly, at a PE\n   connecting\
    \ to PBBN access, each group of I-SIDs is mapped to a VPLS\n   instance.  Similar\
    \ to Type II service interface, no I-SID translation\n   is performed for the\
    \ I-SID bundling case.  Existing PW signaling and\n   Ethernet raw mode (0x0005)\
    \ PW type, defined in [RFC4447] and\n   [RFC4448], are supported.  It is possible\
    \ to use tagged mode (0x0004)\n   PW for backward compatibility as well.\n"
- title: '5.2.  H-VPLS with Mixed PBBN and PBN Access: Regular PBN PE'
  contents:
  - "5.2.  H-VPLS with Mixed PBBN and PBN Access: Regular PBN PE\n   As shown in Figure\
    \ 6, the operation of VPLS-PE1 (connecting to the\n   PBN access on the left)\
    \ is no different from existing VPLS-PEs.  It\n   is the behavior of VPLS-PE2\
    \ (connecting to the PBBN access on the\n   right) that is the focus of this section.\n\
    \         PBN Access       IP/MPLS Core      PBBN Access\n          (802.1ad)\
    \     +--------------+     (802.1ah)\n                        |              |\
    \    +---------+\n         +---------+    |              |    |         |\n  \
    \       |         |   +-----+         |    |  +---+  |\n         |      +---+\
    \  |  PE | +-+     |    |  |BCB|  |\n         |      |PCB|--|     |-|P|     |\
    \    |  +---+  |\n         |      +---+ /+-----+ +-+     |    | /   |   |\n  \
    \       |         | / +-----+/    +-----+ +---+ +---+|\n    +--+ |+---+ +---+\
    \  |  PE | +-+ |PE w/| |B- | |IB-|| +--+\n    |CE|-||PEB|-|PCB|--|     |-|P|-|IBBEB|-|BEB|\
    \ |BEB|--|CE|\n    +--+ |+---+ +---+ ^+-----+ +-+ +-----+^+---+ +---+| +--+\n\
    \         |         |  |  |PE1       PE2|  | |         |\n         +---------+\
    \  |  |             |  | +---------+\n                      |  +-------------+\
    \  |\n                      |                   |\n                  S-Tagged\
    \           Type II (I-Tagged)\n   Figure 6: H-VPLS with Mixed PBN and PBBN Access:\
    \ Regular PBN PE\n   Some assumptions made for this topology include:\n   -  The\
    \ CE is directly connected to the PBBN access via an S-Tagged or\n      port-based\
    \ Interface.\n   -  The I-SID in the PBBN access represents the same customer\
    \ as the\n      S-VID in the PBN access.\n   -  There is 1:1 mapping between the\
    \ I-SID and the VPLS instance.\n   -  At the S-Tagged service interface of the\
    \ PE connecting to PBN\n      (e.g., PE1 in Figure 6), the PE only provides 1:1\
    \ mapping of S-VID\n      to the VPLS instance.  S-VID bundling is not a viable\
    \ option since\n      it does not correspond to anything in the PBBN access.\n\
    \   -  The PE connecting to the PBBN access (e.g., PE2 in Figure 6),\n      supports\
    \ IB-BEB functionality and the I-component is connected to\n      the VPLS Forwarder\
    \ (i.e., the I-component faces the IP/MPLS core\n      whereas the B-component\
    \ faces the PBBN access network).  One or\n      more I-SIDs can be grouped into\
    \ a B-VID in the PBBN access.\n   -  Since C-VID grouping in different PBBN access\
    \ networks must be\n      consistent, it is assumed that same I-SID Domain is\
    \ used across\n      these PBBN access networks.\n   Unlike the previous case,\
    \ I-SID bundling mode is not supported in\n   this case.  This is primarily because\
    \ the VPLS core operates in the\n   same manner as today.  The PE with IB-BEB\
    \ functionality connecting to\n   PBBN access performs the mapping of each VPLS\
    \ instance to an I-SID\n   and one or more of these I-SIDs may be mapped onto\
    \ a B-VID within the\n   PBBN access network.\n"
- title: 6.  H-VPLS with MPLS Access
  contents:
  - "6.  H-VPLS with MPLS Access\n   In this section, the case of H-VPLS with MPLS\
    \ access network is\n   discussed.  The integration of PBB functionality into\
    \ VPLS-PE for\n   such access networks is described to improve the scalability\
    \ of the\n   network in terms of the number of MAC addresses and service instances\n\
    \   that are supported.\n   For this topology, it is possible to embed PBB functionality\
    \ in\n   either the U-PE or the N-PE.  Both of these cases are described in\n\
    \   the following subsections.\n"
- title: '6.1.  H-VPLS with MPLS Access: PBB U-PE'
  contents:
  - "6.1.  H-VPLS with MPLS Access: PBB U-PE\n   As stated earlier, the objective\
    \ for incorporating PBB function at\n   the U-PE is to improve the scalability\
    \ of H-VPLS networks in terms of\n   the number of MAC addresses and service instances\
    \ that are supported.\n   In current H-VPLS, the N-PE must learn customer MAC\
    \ addresses\n   (C-MACs) of all VPLS instances in which it participates.  This\
    \ can\n   easily add up to hundreds of thousands or even millions of C-MACs at\n\
    \   the N-PE.  When the U-PE performs PBB encapsulation, the N-PE only\n   needs\
    \ to learn the MAC addresses of the U-PEs, which is a significant\n   reduction.\
    \  Furthermore, when PBB encapsulation is used, many I-SIDs\n   are multiplexed\
    \ within a single bridge domain (e.g., B-VLAN).  If the\n   VPLS instance is set\
    \ up per B-VLAN, then one can also achieve a\n   significant reduction in the\
    \ number of full-mesh PWs.  It should be\n   noted that this reduction in full-mesh\
    \ PWs comes at the cost of\n   potentially increased replication over the full-mesh\
    \ of PWs: customer\n   multicast and/or broadcast frames are effectively broadcasted\
    \ within\n   the B-VLAN.  This may result in additional frame replication because\n\
    \   the full-mesh PWs corresponding to a B-VLAN are most likely bigger\n   than\
    \ the full-mesh PWs corresponding to a single I-SID.  However,\n   flood containment\
    \ per I-SID (B-MAC multicast pruning) can be used to\n   remedy this drawback\
    \ and have multicast traffic replicated\n   efficiently for each customer (i.e.,\
    \ for each I-SID).\n   Figure 7 below illustrates the scenario for H-VPLS with\
    \ MPLS access.\n   As illustrated, customer networks or hosts (CE) connect into\
    \ the U-PE\n   nodes using standard Ethernet interfaces [802.1D-REV], [802.1Q],\
    \ or\n   [802.1ad].  The U-PE is connected upstream to one or more VPLS N-PE\n\
    \   nodes by MPLS PWs (per VPLS instance).  These, in turn, are connected\n  \
    \ via a full mesh of PWs (per VPLS instance) traversing the IP/MPLS\n   core.\
    \  The U-PE is outfitted with PBB Backbone Edge Bridge (BEB)\n   functions where\
    \ it can encapsulate/decapsulate customer MAC frames in\n   provider B-MACs and\
    \ perform I-SID translation if needed.\n        PBB                          \
    \                      PBB\n        BEB                  +----------+        \
    \          BEB\n         |                   |          |                   |\n\
    \         |   +-----------+   |    IP    |   +-----------+   |\n         |   |\
    \ MPLS      |   |   MPLS   |   |    MPLS   |   |\n         V   | Access +----+\
    \ |   Core   | +----+ Access |   V\n   +--+  +----+       |VPLS|-|          |-|VPLS|\
    \       +----+  +--+\n   |CE|--|U-PE|       |N-PE| |          | | PE |       |U-PE|--|CE|\n\
    \   +--+  +----+       +----+ |          | +----+       +----+  +--+\n       \
    \      |           |   |          |   |           |\n             +-----------+\
    \   +----------+   +-----------+\n          Figure 7: H-VPLS with MPLS Access\
    \ Network and PBB U-PE\n   The U-PE still provides the same type of services toward\
    \ its\n   customers as before and they are:\n      -  Port mode (either 802.1D,\
    \ 802.1Q, or 802.1ad)\n      -  VLAN mode (either 802.1Q or 802.1ad)\n      -\
    \  VLAN-bundling mode (either 802.1Q or 802.1ad)\n   By incorporating a PBB function,\
    \ the U-PE maps each of these services\n   (for a given customer) onto a single\
    \ I-SID based on the configuration\n   at the U-PE.  Many I-SIDs are multiplexed\
    \ within a single bridge\n   domain (e.g., B-VLAN).  The U-PE can then map a bridge\
    \ domain onto a\n   VPLS instance and the encapsulated frames are sent over the\
    \ PW\n   associated with that VPLS instance.  Furthermore, the entire Ethernet\n\
    \   bridging operation over the VPLS network is performed as defined in\n   [RFC4762].\
    \  In other words, MAC forwarding is based on the B-MAC\n   address space and\
    \ service delimiter is based on VLAN ID, which is\n   B-VID in this case.  There\
    \ is no need to inspect or deal with I-SID\n   values in the VPLS N-PEs.\n   In\
    \ the case of PBB U-PEs in a single I-SID Domain, I-SID assignment\n   is performed\
    \ globally across all MPLS access networks and therefore\n   there is no need\
    \ for I-SID translation.  This scenario supports I-SID\n   bundling mode, and\
    \ it is assumed that the mapping of the I-SIDs to\n   the bridge domain (e.g.,\
    \ B-VLAN) is consistent across all the\n   participating PE devices.  In the case\
    \ of the I-SID bundling mode, a\n   bridge domain (e.g., B-VLAN) is mapped to\
    \ a VPLS instance and an\n   existing Ethernet raw mode (0x0005) or tagged mode\
    \ (0x0004) PW type\n   is used as defined in [RFC4447] and [RFC4448].\n   I-SID\
    \ mode can be considered to be a degenerate case of I-SID\n   bundling where a\
    \ single bridge domain is used per I-SID.  However,\n   that results in an increased\
    \ number of bridge domains and PWs in the\n   PEs.  PBB flood containment (B-MAC\
    \ multicast pruning) per I-SID can\n   be used in conjunction with I-SID bundling\
    \ mode to limit the scope of\n   flooding per I-SID thus removing the need for\
    \ I-SID mode.\n"
- title: '6.2.  H-VPLS with MPLS Access: PBB N-PE'
  contents:
  - "6.2.  H-VPLS with MPLS Access: PBB N-PE\n   In this case, the PBB function is\
    \ incorporated at the N-PE to improve\n   the scalability of H-VPLS networks in\
    \ terms of the numbers of MAC\n   addresses and service instances that are supported.\n\
    \   Customer networks or hosts (CE) connect into the U-PE nodes using\n   standard\
    \ Ethernet interfaces [802.1D-REV], [802.1Q], or [802.1ad].\n   The U-PE is connected\
    \ upstream to one or more VPLS N-PE nodes by MPLS\n   PWs (per customer).  These,\
    \ in turn, are connected via a full mesh of\n   PWs (per customer or group of\
    \ customers) traversing the IP/MPLS core.\n   The U-PE still provides the same\
    \ type of services toward its\n   customers as before and they are:\n      - \
    \ Port mode (either 802.1D, 802.1Q, or 802.1ad)\n      -  VLAN mode (either 802.1Q\
    \ or 802.1ad)\n      -  VLAN-bundling mode (either 802.1Q or 802.1ad)\n   The\
    \ spoke PW from the U-PE to the N-PE is not service multiplexed\n   because there\
    \ is no PBB functionality on the U-PE, i.e., one service\n   per PW.\n       \
    \                  PBB              PBB\n                         BEB +----------+\
    \ BEB\n                           | |          | |\n             +-----------+\
    \ | |    IP    | | +-----------+\n             | MPLS      | V |   MPLS   | V\
    \ |    MPLS   |\n             | Access +----+ |   Core   | +----+ Access |\n \
    \  +--+  +----+       |VPLS|-|          |-|VPLS|       +----+  +--+\n   |CE|--|U-PE|\
    \       |N-PE| |          | | PE |       |U-PE|--|CE|\n   +--+  +----+       +----+\
    \ |          | +----+       +----+  +--+\n             |           |   |     \
    \     |   |           |\n             +-----------+   +----------+   +-----------+\n\
    \       Figure 8: H-VPLS with MPLS Access Network and PBB N-PE\n   By incorporating\
    \ a PBB function, the N-PE maps each of these services\n   (for a given customer)\
    \ onto a single I-SID based on the configuration\n   at the N-PE.  Many I-SIDs\
    \ can be multiplexed within a single bridge\n   domain (e.g., B-VLAN).  The N-PE\
    \ can, then, either map a single I-SID\n   into a VPLS instance or map a bridge\
    \ domain (e.g., B-VLAN) onto a\n   VPLS instance, according to its configuration.\
    \  Next, the\n   encapsulated frames are sent over the set of PWs associated with\
    \ that\n   VPLS instance.\n   In the case of PBB N-PEs in a single I-SID Domain,\
    \ I-SID assignment\n   is performed globally across all MPLS access networks and\
    \ therefore\n   there is no need for I-SID translation.  This scenario supports\
    \ I-SID\n   bundling mode, and it is assumed that the mapping of the I-SIDs to\n\
    \   the bridge domain (e.g., B-VLAN) is consistent across all the\n   participating\
    \ PE devices.  In the case of the I-SID bundling mode, a\n   bridge domain (e.g.,\
    \ B-VLAN) is mapped to a VPLS instance and an\n   existing Ethernet raw mode (0x0005)\
    \ or tagged mode (0x0004) PW type\n   as defined in [RFC4447] and [RFC4448], can\
    \ be used.\n   I-SID mode can be considered to be a degenerate case of I-SID\n\
    \   bundling where a single bridge domain is used per I-SID.  However,\n   that\
    \ results in an increased number of bridge domains and PWs in the\n   PE.  PBB\
    \ flood containment (B-MAC multicast pruning) per I-SID can be\n   used in conjunction\
    \ with I-SID bundling mode to limit the scope of\n   flooding per I-SID thus removing\
    \ the need for I-SID mode.\n"
- title: '7.  H-VPLS with MPLS Access: PBB Migration Scenarios'
  contents:
  - "7.  H-VPLS with MPLS Access: PBB Migration Scenarios\n   Operators and service\
    \ providers that have deployed H-VPLS with either\n   MPLS or Ethernet are unlikely\
    \ to migrate to PBB technology over night\n   because of obvious cost implications.\
    \  Thus, it is imperative to\n   outline migration strategies that will allow\
    \ operators to protect\n   investments in their installed base while still taking\
    \ advantage of\n   the scalability benefits of PBB technology.\n   In the following\
    \ subsections, we explore three different migration\n   scenarios that allow a\
    \ mix of existing H-VPLS access networks to\n   coexist with newer PBB-based access\
    \ networks.  The scenarios differ\n   in whether or not the Ethernet service frames\
    \ passing over the VPLS\n   core are PBB-encapsulated.  The first scenario, in\
    \ Section 7.1,\n   involves passing only frames that are not PBB-encapsulated\
    \ over the\n   core.  The second scenario, in Section 7.2, stipulates passing\
    \ only\n   PBB-encapsulated frames over the core.  Whereas, the final scenario,\n\
    \   in Section 7.3, depicts a core that supports a mix of PBB-\n   encapsulated\
    \ and non-PBB-encapsulated frames.  The advantages and\n   disadvantages of each\
    \ scenario will be discussed in the respective\n   sections.\n"
- title: 7.1.  802.1ad Service Frames over VPLS Core
  contents:
  - "7.1.  802.1ad Service Frames over VPLS Core\n   In this scenario, existing access\
    \ networks are left unchanged.  All\n   N-PEs would forward frames based on C-MACs.\
    \  In other words, Ethernet\n   frames that are traversing the VPLS core (within\
    \ PWs) would use the\n   802.1ad frame format, as in current VPLS.  Hence, the\
    \ N-PEs in\n   existing access networks do not require any modification.  For\
    \ new\n   MPLS access networks that have PBB functions on the U-PE, the\n   corresponding\
    \ N-PE must incorporate built-in IB-BEB functions in\n   order to terminate the\
    \ PBB encapsulation before the frames enter the\n   core.  A key point here is\
    \ that while both the U-PE and N-PE nodes\n   implement PBB IB-BEB functionality,\
    \ the former has the I-component\n   facing the customer (CE) and the B-component\
    \ facing the core; whereas\n   the latter has the I-component facing the core\
    \ and the B-component\n   facing the customer (i.e., access network).\n      \
    \                                    PBB            PBB\n                    \
    \         +----------+ IB-BEB         IB-BEB\n                             | \
    \         | |               |\n             +-----------+   |    IP    | | +-----------+\
    \ |\n             | MPLS      |   |   MPLS   | V |    MPLS   | |\n           \
    \  | Access +----+ |   Core   | +----+ Access | V\n   +--+  +----+       |VPLS|-|\
    \          |-|VPLS|       +----+  +--+\n   |CE|--|U-PE|       |N-PE| |       \
    \   | | PE |       |U-PE|--|CE|\n   +--+  +----+       +----+ |          | +----+\
    \       +----+  +--+\n             | (Existing)|   |          |   |  (New)   \
    \ |\n             +-----------+   +----------+   +-----------+\n   Figure 9: Migration\
    \ with 802.1ad Service Frames over VPLS Core\n   The main advantage of this approach\
    \ is that it requires no change to\n   existing access networks or existing VPLS\
    \ N-PEs.  The main\n   disadvantage is that these N-PEs will not leverage the\
    \ advantages of\n   PBB in terms of MAC address and PW scalability.  It is worth\
    \ noting\n   that this migration scenario is an optimal option for an H-VPLS\n\
    \   deployment with a single PBB-capable access network.  When multiple\n   PBB-capable\
    \ access networks are required, then the scenario in\n   Section 7.3 is preferred,\
    \ as it provides a more scalable and optimal\n   interconnect amongst the PBB-capable\
    \ networks.\n"
- title: 7.2.  PBB Service Frames over VPLS Core
  contents:
  - "7.2.  PBB Service Frames over VPLS Core\n   This scenario requires that the VPLS\
    \ N-PE connecting to existing MPLS\n   access networks be upgraded to incorporate\
    \ IB-BEB functions.  All\n   Ethernet service frames passing over the VPLS core\
    \ would be PBB-\n   encapsulated.  The PBB over MPLS access networks would require\
    \ no\n   special requirements beyond what is captured in Section 6 of this\n \
    \  document.  In this case, both the U-PE and N-PE, which implement\n   IB-BEB\
    \ functionality, have the I-component facing the customer and\n   the B-component\
    \ facing the core.\n                         PBB                             PBB\n\
    \                      IB-BEB +----------+              IB-BEB\n             \
    \              | |          |                 |\n             +-----------+ |\
    \ |    IP    |   +-----------+ |\n             | MPLS      | V |   MPLS   |  \
    \ |    MPLS   | |\n             | Access +----+ |   Core   | +----+ Access | V\n\
    \   +--+  +----+       |VPLS|-|          |-|VPLS|       +----+  +--+\n   |CE|--|U-PE|\
    \       |N-PE| |          | | PE |       |U-PE|--|CE|\n   +--+  +----+       +----+\
    \ |          | +----+       +----+  +--+\n             | (Existing)|   |     \
    \     |   |  (New)    |\n             +-----------+   +----------+   +-----------+\n\
    \    Figure 10: Migration with PBB Service Frames over VPLS Core\n   The main\
    \ advantage of this approach is that it allows better\n   scalability of the VPLS\
    \ N-PEs in terms of MAC address and pseudowire\n   counts.  The disadvantage is\
    \ that it requires upgrading the VPLS\n   N-PEs of all existing MPLS access networks.\n"
- title: 7.3.  Mixed 802.1ad and PBB over VPLS Core
  contents:
  - "7.3.  Mixed 802.1ad and PBB over VPLS Core\n   In this scenario, existing access\
    \ networks are left unchanged, and\n   they exchange Ethernet frames with 802.1ad\
    \ format over the PWs in the\n   core.  The newly added access networks, which\
    \ incorporate PBB\n   functionality exchange Ethernet frames that are PBB-encapsulated\n\
    \   amongst each other over core PWs.  For service connectivity between\n   existing\
    \ access network (non-PBB-capable) and new access network (PBB\n   based), the\
    \ VPLS N-PE of the latter network employs IB-BEB\n   functionality to decapsulate\
    \ the PBB header from frames outbound to\n   the core and encapsulate the PBB\
    \ header for frames inbound from the\n   core.  As a result, a mix of PBB-encapsulated\
    \ and 802.1ad Ethernet\n   service frames are exchanged over the VPLS core.\n\
    \   This mode of operation requires new functionality on the VPLS N-PE of\n  \
    \ the PBB-capable access network, so that the PE can send frames in\n   802.1ad\
    \ format or PBB format, on a per PW basis, depending on the\n   capability of\
    \ the destination access network.  Effectively, the PE\n   would have to incorporate\
    \ B-BEB as well as IB-BEB functions.\n   A given PE needs to be aware of the capability\
    \ of its remote peer in\n   order to determine whether it connects to the right\
    \ PW Forwarder.\n   This can be achieved either via static configuration or by\
    \ extending\n   the VPLS control plane (BGP-based auto-discovery and LDP Signaling)\n\
    \   discussed in [RFC6074].  The latter approach and the details of the\n   extensions\
    \ required are out of scope for this document.\n                             \
    \             PBB\n                                          B-BEB          PBB\n\
    \                             +----------+ IB-BEB         IB-BEB\n           \
    \                  |          | |               |\n             +-----------+\
    \   |    IP    | | +-----------+ |\n             | MPLS      |   |   MPLS   |\
    \ V |    MPLS   | |\n             | Access +----+ |   Core   | +----+ Access |\
    \ V\n   +--+  +----+       |VPLS|-|          |-|VPLS|       +----+  +--+\n   |CE|--|U-PE|\
    \       |N-PE| |          | |N-PE|       |U-PE|--|CE|\n   +--+  +----+       +----+\
    \ |          | +----+       +----+  +--+\n             | (Existing)|   |     \
    \     |   |  (New)    |\n             +-----------+   +----------+   +-----------+\n\
    \                Figure 11: Migration with Mixed 802.1ad and\n               \
    \      PBB Service Frames over VPLS Core\n   The U-PE and N-PE of the PBB-capable\
    \ access network both employ BEB\n   functionality.  The U-PE implements IB-BEB\
    \ functionality where the\n   I-component faces the customer (CE) and the B-component\
    \ faces the\n   core.  The N-PE, on the other hand, implements IB-BEB functionality\n\
    \   with the I-component facing the core and the B-component facing the\n   customer\
    \ (access network).  In addition, the N-PE implements\n   standalone B-BEB functionality.\n\
    \   This scenario combines the advantages of both previous scenarios\n   without\
    \ any of their shortcomings, namely: it does not require any\n   changes to existing\
    \ access networks and it allows the N-PE to\n   leverage the scalability benefits\
    \ of 802.1ah for PBBN to PBBN\n   connectivity.  The disadvantage of this option\
    \ is that it requires\n   new functionality on the N-PE of the PBBN access.  A\
    \ second\n   disadvantage is that this option requires two P2MP LSPs to be set\
    \ up\n   at the ingress N-PE: one for the N-PEs that support PBB encapsulation\n\
    \   and another one for the N-PEs that don't support PBB encapsulation.\n"
- title: 8.  Acknowledgments
  contents:
  - "8.  Acknowledgments\n   The authors would like to thank Chris Metz and Dinesh\
    \ Mohan for their\n   valuable feedback and contributions.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   This document does not introduce any additional\
    \ security aspects\n   beyond those applicable to VPLS/H-VPLS.  VPLS/H-VPLS security\n\
    \   considerations are already covered in [RFC4111] and [RFC4762].\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [802.1ad]    \"IEEE Standard for and metropolitan\
    \ area networks --\n                Virtual Bridged Local Area Networks -- Provider\n\
    \                Bridges\", 802.1ad-2005, August 2005.\n   [802.1ah]    \"IEEE\
    \ Standard for Local and metropolitan area networks\n                -- Virtual\
    \ Bridged Local Area Networks Amendment 7:\n                Provider Backbone\
    \ Bridges\", IEEE Std. 802.1ah-2008,\n                August 2009.\n   [RFC4447]\
    \    Martini, L., Ed., Rosen, E., El-Aawar, N., Smith, T.,\n                and\
    \ G. Heron, \"Pseudowire Setup and Maintenance Using\n                the Label\
    \ Distribution Protocol (LDP)\", RFC 4447, April\n                2006.\n   [RFC4448]\
    \    Martini, L., Ed., Rosen, E., El-Aawar, N., and G. Heron,\n              \
    \  \"Encapsulation Methods for Transport of Ethernet over\n                MPLS\
    \ Networks\", RFC 4448, April 2006.\n   [RFC4762]    Lasserre, M., Ed., and V.\
    \ Kompella, Ed., \"Virtual\n                Private LAN Service (VPLS) Using Label\
    \ Distribution\n                Protocol (LDP) Signaling\", RFC 4762, January\
    \ 2007.\n   [RFC6074]    Rosen, E., Davie, B., Radoaca, V., and W. Luo,\n    \
    \            \"Provisioning, Auto-Discovery, and Signaling in Layer 2\n      \
    \          Virtual Private Networks (L2VPNs)\", RFC 6074, January\n          \
    \      2011.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [802.1Q]     \"IEEE Standard for Local and\
    \ metropolitan area networks\n                - Media Access Control (MAC) Bridges\
    \ and Virtual Bridged\n                Local Area Networks\", IEEE Std 802.1Q(tm),\
    \ 2012 Edition,\n                October 2012.\n   [802.1D-REV] \"IEEE Standard\
    \ for Local and metropolitan area networks\n                Media Access Control\
    \ (MAC) Bridges\", IEEE Std. 802.1D,\n                June 2004.\n   [RFC6246]\
    \    Sajassi, A., Ed., Brockners, F., Mohan, D., Ed., and Y.\n               \
    \ Serbest, \"Virtual Private LAN Service (VPLS)\n                Interoperability\
    \ with Customer Edge (CE) Bridges\", RFC\n                6246, June 2011.\n \
    \  [RFC4111]    Fang, L., Ed., \"Security Framework for Provider-\n          \
    \      Provisioned Virtual Private Networks (PPVPNs)\", RFC\n                4111,\
    \ July 2005.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ali Sajassi\n   Cisco\n   EMail: sajassi@cisco.com\n \
    \  Samer Salam\n   Cisco\n   EMail: ssalam@cisco.com\n   Nabil Bitar\n   Verizon\
    \ Communications\n   EMail : nabil.n.bitar@verizon.com\n   Florin Balus\n   Nuage\
    \ Networks\n   EMail: florin.balus@nuagenetworks.net\n"
