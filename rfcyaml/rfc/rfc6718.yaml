- title: __initial_text__
  contents:
  - '                         Pseudowire Redundancy

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes a framework comprised of a number of\n \
    \  scenarios and associated requirements for pseudowire (PW) redundancy.\n   A\
    \ set of redundant PWs is configured between provider edge (PE) nodes\n   in single-segment\
    \ PW applications or between terminating PE (T-PE)\n   nodes in multi-segment\
    \ PW applications.  In order for the PE/T-PE\n   nodes to indicate the preferred\
    \ PW to use for forwarding PW packets\n   to one another, a new PW status is required\
    \ to indicate the\n   preferential forwarding status of active or standby for\
    \ each PW in\n   the redundant set.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc6718.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2012 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \    2.1. Requirements Language ......................................6\n   3.\
    \ Reference Models ................................................6\n      3.1.\
    \ PE Architecture ............................................6\n      3.2. PW\
    \ Redundancy Network Reference Scenarios ..................7\n           3.2.1.\
    \ PW Redundancy for AC and PE Protection: One\n                  Dual-Homed CE\
    \ with Redundant SS-PWs .................7\n           3.2.2. PW Redundancy for\
    \ AC and PE Protection: Two\n                  Dual-Homed CEs with Redundant SS-PWs\
    \ ................8\n           3.2.3. PW Redundancy for S-PE Protection:\n  \
    \                Single-Homed CEs with Redundant MS-PWs .............10\n    \
    \       3.2.4. PW Redundancy for PE-rs Protection in\n                  H-VPLS\
    \ Using SS-PWs ................................11\n           3.2.5. PW Redundancy\
    \ for PE Protection in a VPLS\n                  Ring Using SS-PWs ..................................13\n\
    \           3.2.6. PW Redundancy for VPLS n-PE Protection\n                  Using\
    \ SS-PWs .......................................14\n   4. Generic PW Redundancy\
    \ Requirements .............................15\n      4.1. Protection Switching\
    \ Requirements .........................15\n      4.2. Operational Requirements\
    \ ..................................15\n   5. Security Considerations ........................................16\n\
    \   6. Contributors ...................................................16\n  \
    \ 7. Acknowledgements ...............................................17\n   8.\
    \ References .....................................................17\n      8.1.\
    \ Normative References ......................................17\n      8.2. Informative\
    \ Reference .....................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The objective of pseudowire (PW) redundancy is to maintain\n\
    \   connectivity across the packet switched network (PSN) used by the\n   emulated\
    \ service if a component in the path of the emulated service\n   fails or a backup\
    \ component is activated.  For example, PW redundancy\n   will enable the correct\
    \ PW to be used for forwarding emulated service\n   packets when the connectivity\
    \ of an attachment circuit (AC) changes\n   due to the failure of an AC or when\
    \ a pseudowire (PW) or packet\n   switched network (PSN) tunnel fails due to the\
    \ failure of a provider\n   edge (PE) node.\n   PW redundancy uses redundant ACs,\
    \ PEs, and PWs to eliminate single\n   points of failure in the path of an emulated\
    \ service.  This is\n   achieved while ensuring that only one path between a pair\
    \ of customer\n   edge (CE) nodes is active at any given time.  Mechanisms that\
    \ rely on\n   more than one active path between the CEs, e.g., 1+1 protection\n\
    \   switching, are out of the scope of this document because they may\n   require\
    \ a permanent bridge to provide traffic replication as well as\n   support for\
    \ a 1+1 protection switching protocol in the CEs.\n   Protection for a PW segment\
    \ can be provided by the PSN layer.  This\n   may be a Resource Reservation Protocol\
    \ with Traffic Engineering\n   (RSVP-TE) label switched path (LSP) with a fast-reroute\
    \ (FRR) backup\n   or an end-to-end backup LSP.  These mechanisms can restore\
    \ PSN\n   connectivity rapidly enough to avoid triggering protection by PW\n \
    \  redundancy.  PSN protection mechanisms cannot protect against the\n   failure\
    \ of a PE node or the failure of the remote AC.  Typically,\n   this is supported\
    \ by dual-homing a CE node to different PE nodes that\n   provide a pseudowire\
    \ emulated service across the PSN.  A set of PW\n   mechanisms that enables a\
    \ primary and one or more backup PWs to\n   terminate on different PE nodes is\
    \ therefore required.  An important\n   requirement is that changes occurring\
    \ on the dual-homed side of the\n   network due to the failure of an AC or PE\
    \ are not propagated to the\n   ACs on the other side of the network.  Furthermore,\
    \ failures in the\n   PSN are not propagated to the attached CEs.\n   In cases\
    \ where PSN protection mechanisms are not able to recover from\n   a PSN failure\
    \ or where a failure of a switching PE (S-PE) may occur,\n   a set of mechanisms\
    \ that supports the operation of a primary and one\n   or more backup PWs via\
    \ a different set of S-PEs or diverse PSN\n   tunnels is therefore required. \
    \ For multi-segment PWs (MS-PWs), the\n   paths of these PWs are diverse in that\
    \ they are switched at different\n   S-PE nodes.\n   In both of these cases, PW\
    \ redundancy is important to maximize the\n   resiliency of the emulated service.\
    \  It supplements PSN protection\n   techniques and can operate in addition to\
    \ or instead of those\n   techniques when they are not available.\n   This document\
    \ describes a framework for these applications and\n   associated operational\
    \ requirements.  The framework utilizes a new PW\n   status, called the 'Preferential\
    \ Forwarding Status' of the PW.  This\n   is separate from the operational states\
    \ defined in RFC 5601\n   [RFC5601].  The mechanisms for PW redundancy are modeled\
    \ on general\n   protection switching principles.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   o  Up PW: A PW that has been configured (label mapping exchanged\n\
    \      between PEs) and is not in any of the PW or AC defect states\n      represented\
    \ by the status codes specified in [RFC4446].  Such a PW\n      is available for\
    \ forwarding traffic.\n   o  Down PW: A PW that either has not been fully configured\
    \ or has\n      been configured and is in any one of the PW or AC defect states\n\
    \      specified in [RFC4446].  Such a PW is not available for forwarding\n  \
    \    traffic.\n   o  Active PW: An up PW used for forwarding Operations,\n   \
    \   Administration, and Maintenance (OAM) as well as user-plane and\n      control-plane\
    \ traffic.\n   o  Standby PW: An up PW that is not used for forwarding user traffic\n\
    \      but may forward OAM and specific control-plane traffic.\n   o  PW Endpoint:\
    \ A PE where a PW terminates on a point where native\n      service processing\
    \ is performed, e.g., a single-segment PW (SS-PW)\n      PE, a multi-segment pseudowire\
    \ (MS-PW) terminating PE (T-PE), or a\n      hierarchical Virtual Private LAN\
    \ Service (VPLS) MTU-s or PE-rs.\n   o  Primary PW: The PW that a PW endpoint\
    \ activates (i.e., uses for\n      forwarding) in preference to any other PW when\
    \ more than one PW\n      qualifies for the active state.  When the primary PW\
    \ comes back up\n      after a failure and qualifies for the active state, the\
    \ PW\n      endpoint always reverts to it.  The designation of primary is\n  \
    \    performed by local configuration for the PW at the PE and is only\n     \
    \ required when revertive behavior is used and is not applicable\n      when non-revertive\
    \ protection switching is used.\n   o  Secondary PW: When it qualifies for the\
    \ active state, a secondary\n      PW is only selected if no primary PW is configured\
    \ or if the\n      configured primary PW does not qualify for active state (e.g.,\
    \ is\n      down).  By default, a PW in a redundancy PW set is considered\n  \
    \    secondary.  There is no revertive mechanism among secondary PWs.\n   o  Revertive\
    \ protection switching: Traffic will be carried by the\n      primary PW if all\
    \ of the following is true: it is up, a wait-to-\n      restore timer expires,\
    \ and the primary PW is made the active PW.\n   o  Non-revertive protection switching:\
    \ Traffic will be carried by the\n      last PW selected as a result of a previous\
    \ active PW entering the\n      operationally down state.\n   o  Manual selection\
    \ of a PW: The ability to manually select the\n      primary/secondary PWs.\n\
    \   o  MTU-s: A hierarchical virtual private LAN service multi-tenant\n      unit\
    \ switch, as defined in RFC 4762 [RFC4762].\n   o  PE-rs: A hierarchical virtual\
    \ private LAN service switch, as\n      defined in RFC 4762.\n   o  n-PE: A network-facing\
    \ provider edge node, as defined in RFC 4026\n      [RFC4026].\n   o  1:1 protection:\
    \ One specific subset of a path for an emulated\n      service, consisting of\
    \ a standby PW and/or AC, protects another\n      specific subset of a path for\
    \ the emulated service.  User traffic\n      is transmitted over only one specific\
    \ subset of the path at a\n      time.\n   o  N:1 protection: N specific subsets\
    \ of paths for an emulated\n      service, consisting of standby PWs and/or ACs,\
    \ protect another\n      specific subset of the path for the emulated service.\
    \  User\n      traffic is transmitted over only one specific subset of the path\n\
    \      at a time.\n   o  1+1 protection: One specific subset of a path for an\
    \ emulated\n      service, consisting of a standby PW and/or AC, protects another\n\
    \      specific subset of a path for the emulated service.  Traffic is\n     \
    \ permanently duplicated at the ingress node on both the currently\n      active\
    \ and standby subsets of the paths.\n   This document uses the term 'PE' to be\
    \ synonymous with both PEs as\n   per RFC 3985 [RFC3985] and T-PEs as per RFC\
    \ 5659 [RFC5659].\n   This document uses the term 'PW' to be synonymous with both\
    \ PWs as\n   per RFC 3985 and SS-PWs, MS-PWs, and PW segments as per RFC 5659.\n"
- title: 2.1.  Requirements Language
  contents:
  - "2.1.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in RFC 2119 [RFC2119].\n"
- title: 3.  Reference Models
  contents:
  - "3.  Reference Models\n   The following sections show the reference architecture\
    \ of the PE for\n   PW redundancy and the usage of the architecture in different\n\
    \   topologies and applications.\n"
- title: 3.1.  PE Architecture
  contents:
  - "3.1.  PE Architecture\n   Figure 1 shows the PE architecture for PW redundancy\
    \ when more than\n   one PW in a redundant set is associated with a single AC.\
    \  This is\n   based on the architecture in Figure 4b of RFC 3985 [RFC3985]. \
    \ The\n   forwarder selects which of the redundant PWs to use based on the\n \
    \  criteria described in this document.\n              +----------------------------------------+\n\
    \              |                PE Device               |\n              +----------------------------------------+\n\
    \     Single   |                 |        Single        | PW Instance\n      AC\
    \      |                 +      PW Instance     X<===========>\n             \
    \ |                 |                      |\n              |                \
    \ |----------------------|\n      <------>o                 |        Single  \
    \      | PW Instance\n              |    Forwarder    +      PW Instance     X<===========>\n\
    \              |                 |                      |\n              |   \
    \              |----------------------|\n              |                 |   \
    \     Single        | PW Instance\n              |                 +      PW Instance\
    \     X<===========>\n              |                 |                      |\n\
    \              +----------------------------------------+\n                Figure\
    \ 1: PE Architecture for PW Redundancy\n"
- title: 3.2.  PW Redundancy Network Reference Scenarios
  contents:
  - "3.2.  PW Redundancy Network Reference Scenarios\n   This section presents a set\
    \ of reference scenarios for PW redundancy.\n   These reference scenarios represent\
    \ example network topologies that\n   illustrate the use of PW redundancy.  They\
    \ can be combined together\n   to create more complex or comprehensive topologies,\
    \ as required by a\n   particular application or deployment.\n"
- title: '3.2.1.  PW Redundancy for AC and PE Protection: One Dual-Homed CE with'
  contents:
  - "3.2.1.  PW Redundancy for AC and PE Protection: One Dual-Homed CE with\n    \
    \    Redundant SS-PWs\n   Figure 2 illustrates an application of single-segment\
    \ pseudowire\n   redundancy where one of the CEs is dual-homed.  This scenario\
    \ is\n   designed to protect the emulated service against a failure of one of\n\
    \   the PEs or ACs attached to the multi-homed CE.  Protection against\n   failures\
    \ of the PSN tunnels is provided using PSN mechanisms such as\n   MPLS fast reroute,\
    \ so that these failures do not impact the PW.\n   CE1 is dual-homed to PE1 and\
    \ PE3.  A dual-homing control protocol,\n   the details of which are outside the\
    \ scope of this document, enables\n   the PEs and CEs to determine which PE (PE1\
    \ or PE3) should forward\n   towards CE1 and therefore which AC CE1 should use\
    \ to forward towards\n   the PSN.\n            |<-------------- Emulated Service\
    \ ---------------->|\n            |                                          \
    \        |\n            |          |<------- Pseudo Wire ------>|          |\n\
    \            |          |                            |          |\n          \
    \  |          |    |<-- PSN Tunnels-->|    |          |\n            |       \
    \   V    V                  V    V          |\n            V    AC    +----+ \
    \                 +----+     AC   V\n      +-----+    |     | PE1|==================|\
    \    |     |    +-----+\n      |     |----------|....|...PW1.(active)...|....|----------|\
    \     |\n      |     |          |    |==================|    |          | CE2\
    \ |\n      | CE1 |          +----+                  |PE2 |          |     |\n\
    \      |     |          +----+                  |    |          +-----+\n    \
    \  |     |          |    |==================|    |\n      |     |----------|....|...PW2.(standby)..|\
    \    |\n      +-----+    |     | PE3|==================|    |\n              \
    \   AC    +----+                  +----+\n             Figure 2: One Dual-Homed\
    \ CE and Redundant SS-PWs\n   In this scenario, only one of the PWs should be\
    \ used for forwarding\n   between PE1/PE3 and PE2.  PW redundancy determines which\
    \ PW to make\n   active based on the forwarding state of the ACs so that only\
    \ one path\n   is available from CE1 to CE2.  This requires an additional PW state\n\
    \   that reflects this forwarding state, which is separate from the\n   operational\
    \ status of the PW.  This is the 'Preferential Forwarding\n   Status'.\n   Consider\
    \ the example where the AC from CE1 to PE1 is initially active\n   and the AC\
    \ from CE1 to PE3 is initially standby.  PW1 is made active\n   and PW2 is made\
    \ standby in order to complete the path to CE2.\n   On failure of the AC between\
    \ CE1 and PE1, the forwarding state of the\n   AC on PE3 transitions to active.\
    \  The preferential forwarding state\n   of PW2 therefore needs to become active,\
    \ and PW1 standby, in order to\n   re-establish connectivity between CE1 and CE2.\
    \  PE3 therefore uses\n   PW2 to forward towards CE2, and PE2 uses PW2 instead\
    \ of PW1 to\n   forward towards CE1.  PW redundancy in this scenario requires\
    \ that\n   the forwarding status of the ACs at PE1 and PE3 be signaled to PE2\
    \ so\n   that PE2 can choose which PW to make active.\n   Changes occurring on\
    \ the dual-homed side of the network due to a\n   failure of the AC or PE are\
    \ not propagated to the ACs on the other\n   side of the network.  Furthermore,\
    \ failures in the PSN are not\n   propagated to the attached CEs.\n"
- title: '3.2.2.  PW Redundancy for AC and PE Protection: Two Dual-Homed CEs with'
  contents:
  - "3.2.2.  PW Redundancy for AC and PE Protection: Two Dual-Homed CEs with\n   \
    \     Redundant SS-PWs\n   Figure 3 illustrates an application of single-segment\
    \ pseudowire\n   redundancy where both of the CEs are dual-homed.  This scenario\
    \ is\n   also designed to protect the emulated service against failures of the\n\
    \   ACs and failures of the PEs.  Both CE1 and CE2 are dual-homed to\n   their\
    \ respective PEs, CE1 to PE1 and PE2, and CE2 to PE3 and PE4.  A\n   dual-homing\
    \ control protocol, the details of which are outside the\n   scope of this document,\
    \ enables the PEs and CEs to determine which\n   PEs should forward towards the\
    \ CEs and therefore which ACs the CEs\n   should use to forward towards the PSN.\n\
    \   Note that the PSN tunnels are not shown in this figure for clarity.\n   However,\
    \ it can be assumed that each of the PWs shown is encapsulated\n   in a separate\
    \ PSN tunnel.  Protection against failures of the PSN\n   tunnels is provided\
    \ using PSN mechanisms such as MPLS fast reroute,\n   so that these failures do\
    \ not impact the PW.\n         |<-------------- Emulated Service ---------------->|\n\
    \         |                                                  |\n         |   \
    \       |<------- Pseudowire ------->|          |\n         |          |     \
    \                       |          |\n         |          |    |<-- PSN Tunnels-->|\
    \    |          |\n         |          V    V                  V    V        \
    \  |\n         V    AC    +----+                  +----+     AC   V\n   +-----+\
    \    |     |....|.......PW1........|....|     |    +-----+\n   |     |----------|\
    \ PE1|......   .........| PE3|----------|     |\n   | CE1 |          +----+  \
    \    \\ /  PW3    +----+          | CE2 |\n   |     |          +----+       X\
    \          +----+          |     |\n   |     |          |    |....../ \\..PW4....|\
    \    |          |     |\n   |     |----------| PE2|                  | PE4|---------\
    \ |     |\n   +-----+    |     |....|.....PW2..........|....|     |    +-----+\n\
    \              AC    +----+                  +----+     AC\n             Figure\
    \ 3: Two Dual-Homed CEs and Redundant SS-PWs\n   PW1 and PW4 connect PE1 to PE3\
    \ and PE4, respectively.  Similarly, PW2\n   and PW3 connect PE2 to PE4 and PE3.\
    \  PW1, PW2, PW3, and PW4 are all\n   up.  In order to support protection for\
    \ the emulated service, only\n   one PW MUST be selected to forward traffic.\n\
    \   If a PW has a preferential forwarding status of 'active', it can be\n   used\
    \ for forwarding traffic.  The actual up PW chosen by the combined\n   set of\
    \ PEs connected to the CEs is determined by considering the\n   preferential forwarding\
    \ status of each PW at each PE.  The mechanisms\n   for communicating the preferential\
    \ forwarding status are outside the\n   scope of this document.  Only one PW is\
    \ used for forwarding.\n   The following failure scenario illustrates the operation\
    \ of PW\n   redundancy in Figure 3.  In the initial steady state, when there are\n\
    \   no failures of the ACs, one of the PWs is chosen as the active PW,\n   and\
    \ all others are chosen as standby.  The dual-homing protocol\n   between CE1\
    \ and PE1/PE2 chooses to use the AC to PE2, while the\n   protocol between CE2\
    \ and PE3/PE4 chooses to use the AC to PE4.\n   Therefore, the PW between PE2\
    \ and PE4 is chosen as the active PW to\n   complete the path between CE1 and\
    \ CE2.\n   On failure of the AC between the dual-homed CE1 and PE2, the\n   preferential\
    \ forwarding status of the PWs at PE1, PE2, PE3 and PE4\n   needs to change so\
    \ as to re-establish a path from CE1 to CE2.\n   Different mechanisms can be used\
    \ to achieve this and these are beyond\n   the scope of this document.  After\
    \ the change in status, the\n   algorithm needs to evaluate and select which PW\
    \ to forward traffic\n   on.  In this application, each dual-homing algorithm,\
    \ i.e., {CE1,\n   PE1, PE2} and {CE2, PE3, PE4}, selects the active AC independently.\n\
    \   There is therefore a need to signal the active status of each AC such\n  \
    \ that the PEs can select a common active PW for forwarding between CE1\n   and\
    \ CE2.\n   Changes occurring on one side of network due to a failure of the AC\n\
    \   or PE are not propagated to the ACs on the other side of the network.\n  \
    \ Furthermore, failures in the PSN are not propagated to the attached\n   CEs.\
    \  Note that end-to-end native service protection switching can\n   also be used\
    \ to protect the emulated service in this scenario.  In\n   this case, PW3 and\
    \ PW4 are not necessary.\n   If the CEs do not perform native service protection\
    \ switching, they\n   may instead use load balancing across the paths between\
    \ the CEs.\n"
- title: '3.2.3.  PW Redundancy for S-PE Protection: Single-Homed CEs with'
  contents:
  - "3.2.3.  PW Redundancy for S-PE Protection: Single-Homed CEs with\n        Redundant\
    \ MS-PWs\n   Figure 4 shows a scenario where both CEs are single-homed, and MS-PW\n\
    \   redundancy is used.  The main objective is to protect the emulated\n   service\
    \ against failures of the S-PEs.\n       Native   |<----------- Pseudowires ----------->|\
    \  Native\n       Service  |                                     |  Service\n\
    \        (AC)    |     |<-PSN1-->|     |<-PSN2-->|     |  (AC)\n          |  \
    \   V     V         V     V         V     V   |\n          |     +-----+     \
    \    +-----+         +-----+   |\n   +----+ |     |T-PE1|=========|S-PE1|=========|T-PE2|\
    \   |   +----+\n   |    |-------|......PW1-Seg1.......|.PW1-Seg2......|-------|\
    \    |\n   | CE1|       |     |=========|     |=========|     |       | CE2|\n\
    \   |    |       +-----+         +-----+         +-----+       |    |\n   +----+\
    \        |.||.|                          |.||.|       +----+\n               \
    \  |.||.|         +-----+          |.||.|\n                 |.||.|=========| \
    \    |========== .||.|\n                 |.||...PW2-Seg1......|.PW2-Seg2...||.|\n\
    \                 |.| ===========|S-PE2|============ |.|\n                 |.|\
    \            +-----+             |.|\n                 |.|============+-----+=============\
    \ .|\n                 |.....PW3-Seg1.|     | PW3-Seg2......|\n              \
    \    ==============|S-PE3|===============\n                                | \
    \    |\n                                +-----+\n              Figure 4: Single-Homed\
    \ CE with Redundant MS-PWs\n   CE1 is connected to T-PE1, and CE2 is connected\
    \ to T-PE2.  There are\n   three multi-segment PWs.  PW1 is switched at S-PE1,\
    \ PW2 is switched\n   at S-PE2, and PW3 is switched at S-PE3.  This scenario provides\
    \ N:1\n   protection for the subset of the path of the emulated service from\n\
    \   T-PE1 to T-PE2.\n   Since there is no multi-homing running on the ACs, the\
    \ T-PE nodes\n   advertise 'active' for the preferential forwarding status based\
    \ on a\n   priority for the PW.  The priority associates a meaning of 'primary\n\
    \   PW' and 'secondary PW' to a PW.  These priorities MUST be used if\n   revertive\
    \ mode is used and the active PW to use for forwarding is\n   determined accordingly.\
    \  The priority can be derived via\n   configuration or based on the value of\
    \ the PW forwarding equivalence\n   class (FEC).  For example, a lower value of\
    \ PWid FEC can be taken as\n   a higher priority.  However, this does not guarantee\
    \ selection of\n   same PW by the T-PEs because of, for example, a mismatch in\
    \ the\n   configuration of the PW priority at each T-PE.  The intent of this\n\
    \   application is for T-PE1 and T-PE2 to synchronize the transmit and\n   receive\
    \ paths of the PW over the network.  In other words, both T-PE\n   nodes are required\
    \ to transmit over the PW segment that is switched\n   by the same S-PE.  This\
    \ is desirable for ease of operation and\n   troubleshooting.\n"
- title: 3.2.4.  PW Redundancy for PE-rs Protection in H-VPLS Using SS-PWs
  contents:
  - "3.2.4.  PW Redundancy for PE-rs Protection in H-VPLS Using SS-PWs\n   The following\
    \ figure (based on the architecture shown in Figure 3 of\n   [RFC4762]) illustrates\
    \ the application of PW redundancy to\n   hierarchical VPLS (H-VPLS).  Note that\
    \ the PSN tunnels are not shown\n   for clarity, and only one PW of a PW group\
    \ is shown.  A multi-tenant\n   unit switch (MTU-s) is dual-homed to two PE router\
    \ switches.  The\n   example here uses SS-PWs, and the objective is to protect\
    \ the\n   emulated service against failures of a PE-rs.\n                    \
    \                       PE1-rs\n                                       +--------+\n\
    \                                       |  VSI   |\n                       Active\
    \ PW       |   --   |\n                        Group..........|../  \\..|.\n \
    \      CE-1                 .          |  \\  /  | .\n        \\             \
    \     .           |   --   |  .\n         \\                .            +--------+\
    \   .\n          \\   MTU-s      .                  .        .     PE3-rs\n  \
    \         +--------+   .                   .         . +--------+\n          \
    \ |   VSI  |  .                    .  H-VPlS  .|  VSI   |\n           |   -- ..|..\
    \                     .   Core    |.. --   |\n           |  /  \\  |         \
    \              .    PWs    |  /  \\  |\n           |  \\  /..|..             \
    \        .           |  \\  /  |\n           |   --   |  .                   \
    \ .          .|.. --   |\n           +--------+   .                   .      \
    \   . +--------+\n          /              .                  .        .\n   \
    \      /                .            +--------+   .\n        /               \
    \   .           |  VSI   |  .\n       CE-2                 .          |   -- \
    \  | .\n                             ..........|../  \\..|.\n                \
    \       Standby PW      |  \\  /  |\n                        Group          |\
    \   --   |\n                                       +--------+\n              \
    \                           PE2-rs\n                Figure 5: MTU-s Dual-Homing\
    \ in H-VPLS Core\n   In Figure 5, the MTU-s is dual-homed to PE1-rs and PE2-rs\
    \ and has\n   spoke PWs to each of them.  The MTU-s needs to choose only one of\
    \ the\n   spoke PWs (the active PW) to forward traffic to one of the PEs and\n\
    \   sets the other PW to standby.  The MTU-s can derive the status of the\n  \
    \ PWs based on local policy configuration.  PE1-rs and PE2-rs are\n   connected\
    \ to the H-VPLS core on the other side of network.  The MTU-s\n   communicates\
    \ the status of its member PWs for a set of virtual\n   switching instances (VSIs)\
    \ that share a common status of active or\n   standby.  Here, the MTU-s controls\
    \ the selection of PWs used to\n   forward traffic.  Signaling using PW grouping\
    \ with a common group-id\n   in the PWid FEC Element, or a Grouping TLV in Generalized\
    \ PWid FEC\n   Element as defined in [RFC4447], to PE1-rs and PE2-rs, is recommended\n\
    \   for improved scaling.\n   Whenever an MTU-s performs a switchover of the active\
    \ PW group, it\n   needs to communicate this status change to the PE2-rs.  That\
    \ is, it\n   informs PE2-rs that the status of the standby PW group has changed\
    \ to\n   active.\n   In this scenario, PE devices are aware of switchovers at\
    \ the MTU-s\n   and could generate Media Access Control (MAC) Address Withdraw\n\
    \   messages to trigger MAC flushing within the H-VPLS full mesh.  By\n   default,\
    \ MTU-s devices should still trigger MAC Address Withdraw\n   messages as defined\
    \ in [RFC4762] to prevent two copies of MAC Address\n   Withdraw messages to be\
    \ sent (one by the MTU-s and another one by the\n   PE-rs).  Mechanisms to disable\
    \ the MAC withdraw trigger in certain\n   devices are out of the scope of this\
    \ document.\n"
- title: 3.2.5.  PW Redundancy for PE Protection in a VPLS Ring Using SS-PWs
  contents:
  - "3.2.5.  PW Redundancy for PE Protection in a VPLS Ring Using SS-PWs\n   The following\
    \ figure illustrates the use of PW redundancy for dual-\n   homed connectivity\
    \ between PEs in a VPLS ring topology.  As above,\n   PSN tunnels are not shown,\
    \ and only one PW of a PW group is shown for\n   clarity.  The example here uses\
    \ SS-PWs, and the objective is to\n   protect the emulated service against failures\
    \ of a PE on the ring.\n               PE1                            PE2\n  \
    \          +--------+                     +--------+\n            |  VSI   | \
    \                    |  VSI   |\n            |   --   |                     |\
    \   --   |\n      ......|../  \\..|.....................|../  \\..|.......\n \
    \           |  \\  /  |     PW Group 1      |  \\  /  |\n            |   --  \
    \ |                     |   --   |\n            +--------+                   \
    \  +--------+\n                 .                              .\n           \
    \      .                              .\n   VPLS Domain A .                  \
    \            . VPLS Domain B\n                 .                             \
    \ .\n                 .                              .\n                 .   \
    \                           .\n            +--------+                     +--------+\n\
    \            |  VSI   |                     |  VSI   |\n            |   --   |\
    \                     |   --   |\n      ......|../  \\..|.....................|../\
    \  \\..|........\n            |  \\  /  |     PW Group 2      |  \\  /  |\n  \
    \          |   --   |                     |   --   |\n            +--------+ \
    \                    +--------+\n               PE3                          \
    \  PE4\n               Figure 6: Redundancy in a VPLS Ring Topology\n   In Figure\
    \ 6, PE1 and PE3 from VPLS domain A are connected to PE2 and\n   PE4 in VPLS domain\
    \ B via PW group 1 and PW group 2.  The PEs are\n   connected to each other in\
    \ such a way as to form a ring topology.\n   Such scenarios may arise in inter-domain\
    \ H-VPLS deployments where the\n   Rapid Spanning Tree Protocol (RSTP) or other\
    \ mechanisms may be used\n   to maintain loop-free connectivity of the PW groups.\n\
    \   [RFC4762] outlines multi-domain VPLS services without specifying how\n   multiple\
    \ redundant border PEs per domain and per VPLS instance can be\n   supported.\
    \  In the example above, PW group 1 may be blocked at PE1 by\n   RSTP, and it\
    \ is desirable to block the group at PE2 by exchanging the\n   PW preferential\
    \ forwarding status of standby.  The details of how PW\n   grouping is achieved\
    \ and used is deployment specific and is outside\n   the scope of this document.\n"
- title: 3.2.6.  PW Redundancy for VPLS n-PE Protection Using SS-PWs
  contents:
  - "3.2.6.  PW Redundancy for VPLS n-PE Protection Using SS-PWs\n               \
    \           |<----- Provider ----->|\n                                    Core\n\
    \                   +------+                      +------+\n                 \
    \  | n-PE |::::::::::::::::::::::| n-PE |\n        Provider   | (P)  |..........\
    \   .........| (P)  |  Provider\n        Access     +------+          . .    \
    \     +------+  Access\n        Network                       X              \
    \      Network\n          (1)      +------+          . .         +------+    (2)\n\
    \                   | n-PE |..........   .........| n-PE |\n                 \
    \  |  (B) |......................| (B)  |\n                   +------+       \
    \               +------+\n                       Figure 7: Bridge Module Model\n\
    \   Figure 7 shows a scenario with two provider access networks.  The\n   example\
    \ here uses SS-PWs, and the objective is to protect the\n   emulated service against\
    \ failures of a network-facing PE (n-PE).\n   Each network has two n-Pes.  These\
    \ n-PEs are connected via a full\n   mesh of PWs for a given VPLS instance.  As\
    \ shown in the figure, only\n   one n-PE in each access network serves as the\
    \ primary PE (P) for that\n   VPLS instance, and the other n-PE serves as the\
    \ backup PE (B).  In\n   this figure, each primary PE has two active PWs originating\
    \ from it.\n   Therefore, when a multicast, broadcast, or unknown unicast frame\n\
    \   arrives at the primary n-PE from the access network side, the n-PE\n   replicates\
    \ the frame over both PWs in the core even though it only\n   needs to send the\
    \ frames over a single PW (shown with :::: in the\n   figure) to the primary n-PE\
    \ on the other side.  This is an\n   unnecessary replication of the customer frames\
    \ that consumes core-\n   network bandwidth (half of the frames get discarded\
    \ at the receiving\n   n-PE).  This issue gets aggravated when there are three\
    \ or more n-PEs\n   per provider access network.  For example, if there are three\
    \ n-PEs\n   or four n-PEs per access network, then 67% or 75% of core bandwidth\n\
    \   for multicast, broadcast, and unknown unicast are wasted,\n   respectively.\n\
    \   In this scenario, the n-PEs can communicate the active or standby\n   status\
    \ of the PWs among them.  This status can be derived from the\n   active or backup\
    \ state of an n-PE for a given VPLS.\n"
- title: 4.  Generic PW Redundancy Requirements
  contents:
  - '4.  Generic PW Redundancy Requirements

    '
- title: 4.1.  Protection Switching Requirements
  contents:
  - "4.1.  Protection Switching Requirements\n   o  Protection architectures such\
    \ as N:1,1:1 or 1+1 are possible. 1:1\n      protection MUST be supported.  The\
    \ N:1 protection case is less\n      efficient in terms of the resources that\
    \ must be allocated; hence,\n      this SHOULD be supported. 1+1 protection MAY\
    \ be used in the\n      scenarios described in the document.  However, the details\
    \ of its\n      usage are outside the scope of this document, as it MAY require\
    \ a\n      1+1 protection switching protocol between the CEs.\n   o  Non-revertive\
    \ behavior MUST be supported, while revertive behavior\n      is OPTIONAL.  This\
    \ avoids the need to designate one PW as primary\n      unless revertive behavior\
    \ is explicitly required.\n   o  Protection switchover can be initiated from a\
    \ PE, e.g., using a\n      manual switchover or a forced switchover, or it may\
    \ be triggered\n      by a signal failure, i.e., a defect in the PW or PSN.  Manual\n\
    \      switchover may be necessary if it is required to disable one PW in\n  \
    \    a redundant set.  Both methods MUST be supported, and signal\n      failure\
    \ triggers MUST be treated with a lower priority than any\n      local or far-end\
    \ forced switch or manual trigger.\n   o  A PE MAY be able to forward packets\
    \ received from a PW with a\n      standby status in order to avoid black holing\
    \ of in-flight packets\n      during switchover.  However, in cases where VPLS\
    \ is used, all VPLS\n      application packets received from standby PWs MUST\
    \ be dropped,\n      except for OAM and control-plane packets.\n"
- title: 4.2.  Operational Requirements
  contents:
  - "4.2.  Operational Requirements\n   o  (T-)PEs involved in protecting a PW SHOULD\
    \ automatically discover\n      and attempt to resolve inconsistencies in the\
    \ configuration of\n      primary/secondary PWs.\n   o  (T-)PEs involved in protecting\
    \ a PW SHOULD automatically discover\n      and attempt to resolve inconsistencies\
    \ in the configuration of\n      revertive/non-revertive protection switching\
    \ mode.\n   o  (T-)PEs that do not automatically discover or resolve\n      inconsistencies\
    \ in the configuration of primary/secondary,\n      revertive/non-revertive, or\
    \ other parameters MUST generate an\n      alarm upon detection of an inconsistent\
    \ configuration.\n   o  (T-)PEs participating in PW redundancy MUST support the\n\
    \      configuration of revertive or non-revertive protection switching\n    \
    \  modes if both modes are supported.\n   o  The MIB(s) MUST support inter-PSN\
    \ monitoring of the PW redundancy\n      configuration, including the protection\
    \ switching mode.\n   o  (T-)PEs participating in PW redundancy SHOULD support\
    \ the local\n      invocation of protection switching.\n   o  (T-)PEs participating\
    \ in PW redundancy SHOULD support the local\n      invocation of a lockout of\
    \ protection switching.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   The PW redundancy method described in this RFC\
    \ will require an\n   extension to the PW setup and maintenance protocol [RFC4447],\
    \ which\n   in turn is carried over the Label Distribution Protocol (LDP)\n  \
    \ [RFC5036].  This PW redundancy method will therefore inherit the\n   security\
    \ mechanisms of the version of LDP implemented in the PEs.\n"
- title: 6.  Contributors
  contents:
  - "6.  Contributors\n   The editors would like to thank Pranjal Kumar Dutta, Marc\
    \ Lasserre,\n   Jonathan Newton, Hamid Ould-Brahim, Olen Stokes, Dave Mcdysan,\
    \ Giles\n   Heron, and Thomas Nadeau, all of whom made a major contribution to\n\
    \   the development of this document.\n   Pranjal Dutta\n   Alcatel-Lucent\n \
    \  EMail: pranjal.dutta@alcatel-lucent.com\n   Marc Lasserre\n   Alcatel-Lucent\n\
    \   EMail: marc.lasserre@alcatel-lucent.com\n   Jonathan Newton\n   Cable & Wireless\n\
    \   EMail: Jonathan.Newton@cw.com\n   Hamid Ould-Brahim\n   EMail: ouldh@yahoo.com\n\
    \   Olen Stokes\n   Extreme Networks\n   EMail: ostokes@extremenetworks.com\n\
    \   Dave McDysan\n   Verizon\n   EMail: dave.mcdysan@verizon.com\n   Giles Heron\n\
    \   Cisco Systems\n   EMail: giles.heron@gmail.com\n   Thomas Nadeau\n   Juniper\
    \ Networks\n   EMail: tnadeau@lucidvision.com\n"
- title: 7.  Acknowledgements
  contents:
  - "7.  Acknowledgements\n   The authors would like to thank Vach Kompella, Kendall\
    \ Harvey,\n   Tiberiu Grigoriu, Neil Hart, Kajal Saha, Florin Balus, and Philippe\n\
    \   Niger for their valuable comments and suggestions.\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.   Normative References
  contents:
  - "8.1.   Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC3985]  Bryant, S. and P. Pate, \"Pseudo Wire Emulation Edge-to-\n\
    \              Edge (PWE3) Architecture\", RFC 3985, March 2005.\n   [RFC4026]\
    \  Andersson, L. and T. Madsen, \"Provider Provisioned Virtual\n             \
    \ Private Network (VPN) Terminology\", RFC 4026, March 2005.\n   [RFC4446]  Martini,\
    \ L., \"IANA Allocations for Pseudowire Edge to Edge\n              Emulation\
    \ (PWE3)\", BCP 116, RFC 4446, April 2006.\n   [RFC4447]  Martini, L., Rosen,\
    \ E., El-Aawar, N., Smith, T., and G.\n              Heron, \"Pseudowire Setup\
    \ and Maintenance Using the Label\n              Distribution Protocol (LDP)\"\
    , RFC 4447, April 2006.\n   [RFC4762]  Lasserre, M. and V. Kompella, \"Virtual\
    \ Private LAN Service\n              (VPLS) Using Label Distribution Protocol\
    \ (LDP) Signaling\",\n              RFC 4762, January 2007.\n   [RFC5036]  Andersson,\
    \ L., Minei, I., and B. Thomas, \"LDP\n              Specification\", RFC 5036,\
    \ October 2007.\n   [RFC5659]  Bocci, M. and S. Bryant, \"An Architecture for\
    \ Multi-\n              Segment Pseudowire Emulation Edge-to-Edge\", RFC 5659,\n\
    \              October 2009.\n"
- title: 8.2.  Informative Reference
  contents:
  - "8.2.  Informative Reference\n   [RFC5601]  Nadeau, T. and D. Zelig, \"Pseudowire\
    \ (PW) Management\n              Information Base (MIB)\", RFC 5601, July 2009.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Praveen Muley\n   Alcatel-Lucent\n   EMail: praveen.muley@alcatel-lucent.com\n\
    \   Mustapha Aissaoui\n   Alcatel-Lucent\n   EMail: mustapha.aissaoui@alcatel-lucent.com\n\
    \   Matthew Bocci\n   Alcatel-Lucent\n   EMail: matthew.bocci@alcatel-lucent.com\n"
