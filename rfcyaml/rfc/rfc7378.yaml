- title: __initial_text__
  contents:
  - '                          Trustworthy Location

    '
- title: Abstract
  contents:
  - "Abstract\n   The trustworthiness of location information is critically important\n\
    \   for some location-based applications, such as emergency calling or\n   roadside\
    \ assistance.\n   This document describes threats to conveying location, particularly\n\
    \   for emergency calls, and describes techniques that improve the\n   reliability\
    \ and security of location information.  It also provides\n   guidelines for assessing\
    \ the trustworthiness of location information.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7378.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2014 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \      1.1. Terminology ................................................3\n  \
    \    1.2. Emergency Services Architecture ............................5\n   2.\
    \ Threat Models ...................................................8\n      2.1.\
    \ Existing Work ..............................................8\n      2.2. Adversary\
    \ Model ............................................9\n      2.3. Location Spoofing\
    \ .........................................10\n      2.4. Identity Spoofing .........................................11\n\
    \   3. Mitigation Techniques ..........................................11\n  \
    \    3.1. Signed Location-by-Value ..................................12\n    \
    \  3.2. Location-by-Reference .....................................15\n      3.3.\
    \ Proxy-Added Location ......................................18\n   4. Location\
    \ Trust Assessment ......................................20\n   5. Security Considerations\
    \ ........................................23\n   6. Privacy Considerations .........................................24\n\
    \   7. Informative References .........................................26\n  \
    \ Acknowledgments ...................................................30\n   Authors'\
    \ Addresses ................................................30\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Several public and commercial services need location information\
    \ to\n   operate.  This includes emergency services (such as fire, ambulance,\n\
    \   and police) as well as commercial services such as food delivery and\n   roadside\
    \ assistance.\n   For circuit-switched calls from landlines, as well as for Voice\
    \ over\n   IP (VoIP) services that only support emergency service calls from\n\
    \   stationary Devices, location provided to the Public Safety Answering\n   Point\
    \ (PSAP) is determined from a lookup using the calling telephone\n   number. \
    \ As a result, for landlines or stationary VoIP, spoofing of\n   caller identification\
    \ can result in the PSAP incorrectly determining\n   the caller's location.  Problems\
    \ relating to calling party number and\n   Caller ID assurance have been analyzed\
    \ by the Secure Telephone\n   Identity Revisited [STIR] working group as described\
    \ in \"Secure\n   Telephone Identity Problem Statement and Requirements\" [RFC7340].\
    \  In\n   addition to the work underway in STIR, other mechanisms exist for\n\
    \   validating caller identification.  For example, as noted in [EENA],\n   one\
    \ mechanism for validating caller identification information (as\n   well as the\
    \ existence of an emergency) is for the PSAP to call the\n   user back, as described\
    \ in [RFC7090].\n   Given the existing work on caller identification, this document\n\
    \   focuses on the additional threats that are introduced by the support\n   of\
    \ IP-based emergency services in nomadic and mobile Devices, in\n   which location\
    \ may be conveyed to the PSAP within the emergency call.\n   Ideally, a call taker\
    \ at a PSAP should be able to assess, in real\n   time, the level of trust that\
    \ can be placed on the information\n   provided within a call.  This includes\
    \ automated location conveyed\n   along with the call and location information\
    \ communicated by the\n   caller, as well as identity information relating to\
    \ the caller or the\n   Device initiating the call.  Where real-time assessment\
    \ is not\n   possible, it is important to be able to determine the source of the\n\
    \   call in a post-incident investigation, so as to be able to enforce\n   accountability.\n\
    \   This document defines terminology (including the meaning of\n   \"trustworthy\
    \ location\") in Section 1.1, reviews existing work in\n   Section 1.2, describes\
    \ threat models in Section 2, outlines potential\n   mitigation techniques in\
    \ Section 3, covers trust assessment in\n   Section 4, and discusses security\
    \ considerations in Section 5.\n"
- title: 1.1.  Terminology
  contents:
  - "1.1.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"\
    SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\"\
    , and \"OPTIONAL\" in this\n   document are to be interpreted as described in\
    \ [RFC2119].\n   We use the definitions of \"Internet Access Provider (IAP)\"\
    , \"Internet\n   Service Provider (ISP)\", and \"Voice Service Provider (VSP)\"\
    \ found in\n   \"Requirements for Emergency Context Resolution with Internet\n\
    \   Technologies\" [RFC5012].\n   [EENA] defines a \"hoax call\" as follows: \"\
    A false or malicious call\n   is when a person deliberately telephones the emergency\
    \ services and\n   tells them there is an emergency when there is not.\"\n   The\
    \ definitions of \"Device\", \"Target\", and \"Location Information\n   Server\"\
    \ (LIS) are taken from \"An Architecture for Location and\n   Location Privacy\
    \ in Internet Applications\" [RFC6280], Section 7.\n   The term \"Device\" denotes\
    \ the physical device, such as a mobile\n   phone, PC, or embedded microcontroller,\
    \ whose location is tracked as\n   a proxy for the location of a Target.\n   The\
    \ term \"Target\" denotes an individual or other entity whose\n   location is\
    \ sought in the Geopriv architecture [RFC6280].  In many\n   cases, the Target\
    \ will be the human user of a Device, or it may be an\n   object such as a vehicle\
    \ or shipping container to which a Device is\n   attached.  In some instances,\
    \ the Target will be the Device itself.\n   The Target is the entity whose privacy\
    \ the architecture described in\n   [RFC6280] seeks to protect.\n   The term \"\
    Location Information Server\" denotes an entity responsible\n   for providing\
    \ Devices within an access network with information about\n   their own locations.\
    \  A Location Information Server uses knowledge of\n   the access network and\
    \ its physical topology to generate and\n   distribute location information to\
    \ Devices.\n   The term \"location determination method\" refers to the mechanism\
    \ used\n   to determine the location of a Target.  This may be something\n   employed\
    \ by a LIS or by the Target itself.  It specifically does not\n   refer to the\
    \ location configuration protocol (LCP) used to deliver\n   location information\
    \ to either the Target or the Recipient.  This\n   term is reused from \"GEOPRIV\
    \ Presence Information Data Format\n   Location Object (PIDF-LO) Usage Clarification,\
    \ Considerations, and\n   Recommendations\" [RFC5491].\n   The term \"source\"\
    \ is used to refer to the LIS, node, or Device from\n   which a Recipient (Target\
    \ or third party) obtains location\n   information.\n   Additionally, the terms\
    \ \"location-by-value\" (LbyV), \"location-by-\n   reference\" (LbyR), \"Location\
    \ Configuration Protocol\", \"Location\n   Dereference Protocol\", and \"Location\
    \ Uniform Resource Identifier\"\n   (URI) are reused from \"Requirements for a\
    \ Location-by-Reference\n   Mechanism\" [RFC5808].\n   \"Trustworthy Location\"\
    \ is defined as location information that can be\n   attributed to a trusted source,\
    \ has been protected against\n   modification in transmit, and has been assessed\
    \ as trustworthy.\n   \"Location Trust Assessment\" refers to the process by which\
    \ the\n   reliability of location information can be assessed.  This topic is\n\
    \   discussed in Section 4.\n   \"Identity Spoofing\" occurs when the attacker\
    \ forges or obscures their\n   identity so as to prevent themselves from being\
    \ identified as the\n   source of the attack.  One class of identity spoofing\
    \ attack involves\n   the forging of call origin identification.\n   The following\
    \ additional terms apply to location spoofing\n   (Section 2.3):\n   With \"Place\
    \ Shifting\", attackers construct a Presence Information\n   Data Format Location\
    \ Object (PIDF-LO) for a location other than where\n   they are currently located.\
    \  In some cases, place shifting can be\n   limited in range (e.g., within the\
    \ coverage area of a particular cell\n   tower).\n   \"Time Shifting\" occurs\
    \ when the attacker uses or reuses location\n   information that was valid in\
    \ the past but is no longer valid because\n   the attacker has moved.\n   \"Location\
    \ Theft\" occurs when the attacker captures a Target's\n   location information\
    \ (possibly including a signature) and presents it\n   as their own.  Location\
    \ theft can occur in a single instance or may\n   be continuous (e.g., where the\
    \ attacker has gained control over the\n   victim's Device).  Location theft may\
    \ also be combined with time\n   shifting to present someone else's location information\
    \ after the\n   original Target has moved.\n"
- title: 1.2.  Emergency Services Architecture
  contents:
  - "1.2.  Emergency Services Architecture\n   This section describes how location\
    \ is utilized in the Internet\n   Emergency Services Architecture, as well as\
    \ the existing work on the\n   problem of hoax calls.\n"
- title: 1.2.1.  Location
  contents:
  - "1.2.1.  Location\n   The Internet architecture for emergency calling is described\
    \ in\n   \"Framework for Emergency Calling Using Internet Multimedia\"\n   [RFC6443].\
    \  Best practices for utilizing the architecture to make\n   emergency calls are\
    \ described in \"Best Current Practice for\n   Communications Services in Support\
    \ of Emergency Calling\" [RFC6881].\n   As noted in \"An Architecture for Location\
    \ and Location Privacy in\n   Internet Applications\" [RFC6280], Section 6.3:\n\
    \      there are three critical steps in the placement of an emergency\n     \
    \ call, each involving location information:\n      1. Determine the location\
    \ of the caller.\n      2. Determine the proper Public Safety Answering Point\
    \ (PSAP) for\n         the caller's location.\n      3. Send a SIP INVITE message,\
    \ including the caller's location, to\n         the PSAP.\n   The conveyance of\
    \ location information within the Session Initiation\n   Protocol (SIP) is described\
    \ in \"Location Conveyance for the Session\n   Initiation Protocol\" [RFC6442].\
    \  Conveyance of location-by-value\n   (LbyV) as well as conveyance of location-by-reference\
    \ (LbyR) are\n   supported.  Section 7 of [RFC6442] (\"Security Considerations\"\
    )\n   discusses privacy, authentication, and integrity concerns relating to\n\
    \   conveyed location.  This includes discussion of transmission-layer\n   security\
    \ for confidentiality and integrity protection of SIP, as well\n   as (undeployed)\
    \ end-to-end security mechanisms for protection of\n   location information (e.g.,\
    \ S/MIME).  Regardless of whether\n   transmission-layer security is utilized,\
    \ location information may be\n   available for inspection by an intermediary\
    \ that -- if it decides\n   that the location value is unacceptable or insufficiently\
    \ accurate --\n   may send an error indication or replace the location, as described\
    \ in\n   [RFC6442], Section 3.4.\n   Although the infrastructure for location-based\
    \ routing described in\n   [RFC6443] was developed for use in emergency services,\
    \ [RFC6442]\n   supports conveyance of location within non-emergency calls as\
    \ well as\n   emergency calls.  Section 1 of \"Implications of 'retransmission-\n\
    \   allowed' for SIP Location Conveyance\" [RFC5606] describes the overall\n \
    \  architecture, as well as non-emergency usage scenarios (note: the\n   [LOC-CONVEY]\
    \ citation in the quote below refers to the document later\n   published as [RFC6442]):\n\
    \      The Presence Information Data Format for Location Objects (PIDF-LO\n  \
    \    [RFC4119]) carries both location information (LI) and policy\n      information\
    \ set by the Rule Maker, as is stipulated in [RFC3693].\n      The policy carried\
    \ along with LI allows the Rule Maker to\n      restrict, among other things,\
    \ the duration for which LI will be\n      retained by recipients and the redistribution\
    \ of LI by recipients.\n      The Session Initiation Protocol [RFC3261] is one\
    \ proposed Using\n      Protocol for PIDF-LO.  The conveyance of PIDF-LO within\
    \ SIP is\n      specified in [LOC-CONVEY].  The common motivation for providing\
    \ LI\n      in SIP is to allow location to be considered in routing the SIP\n\
    \      message.  One example use case would be emergency services, in\n      which\
    \ the location will be used by dispatchers to direct the\n      response.  Another\
    \ use case might be providing location to be used\n      by services associated\
    \ with the SIP session; a location associated\n      with a call to a taxi service,\
    \ for example, might be used to route\n      to a local franchisee of a national\
    \ service and also to route the\n      taxi to pick up the caller.\n"
- title: 1.2.2.  Hoax Calls
  contents:
  - "1.2.2.  Hoax Calls\n   Hoax calls have been a problem for emergency services\
    \ dating back to\n   the time of street corner call boxes.  As the European Emergency\n\
    \   Number Association (EENA) has noted [EENA]:\n      False emergency calls divert\
    \ emergency services away from people\n      who may be in life-threatening situations\
    \ and who need urgent\n      help.  This can mean the difference between life\
    \ and death for\n      someone in trouble.\n   EENA [EENA] has attempted to define\
    \ terminology and describe best\n   current practices for dealing with false emergency\
    \ calls.  Reducing\n   the number of hoax calls represents a challenge, since\
    \ emergency\n   services authorities in most countries are required to answer\
    \ every\n   call (whenever possible).  Where the caller cannot be identified,\
    \ the\n   ability to prosecute is limited.\n   A particularly dangerous form of\
    \ hoax call is \"swatting\" -- a hoax\n   emergency call that draws a response\
    \ from law enforcement prepared\n   for a violent confrontation (e.g., a fake\
    \ hostage situation that\n   results in the dispatching of a \"Special Weapons\
    \ And Tactics\" (SWAT)\n   team).  In 2008, the Federal Bureau of Investigation\
    \ (FBI) issued a\n   warning [Swatting] about an increase in the frequency and\n\
    \   sophistication of these attacks.\n   Many documented cases of \"swatting\"\
    \ (also sometimes referred to as\n   \"SWATing\") involve not only the faking\
    \ of an emergency but also\n   falsification or obfuscation of identity [Swatting]\
    \ [SWATing].  There\n   are a number of techniques by which hoax callers attempt\
    \ to avoid\n   identification, and in general, the ability to identify the caller\n\
    \   appears to influence the incidence of hoax calls.\n   Where a Voice Service\
    \ Provider allows the caller to configure its\n   outbound caller identification\
    \ without checking it against the\n   authenticated identity, forging caller identification\
    \ is trivial.\n   Similarly, where an attacker can gain entry to a Private Branch\n\
    \   Exchange (PBX), they can then subsequently use that access to launch\n   a\
    \ denial-of-service attack against the PSAP or make fraudulent\n   emergency calls.\
    \  Where emergency calls have been allowed from\n   handsets lacking a subscriber\
    \ identification module (SIM) card,\n   so-called non-service initialized (NSI)\
    \ handsets, or where ownership\n   of the SIM card cannot be determined, the frequency\
    \ of hoax calls has\n   often been unacceptably high [TASMANIA] [UK] [SA].\n \
    \  However, there are few documented cases of hoax calls that have\n   arisen\
    \ from conveyance of untrustworthy location information within\n   an emergency\
    \ call, which is the focus of this document.\n"
- title: 2.  Threat Models
  contents:
  - "2.  Threat Models\n   This section reviews existing analyses of the security\
    \ of emergency\n   services, threats to geographic location privacy, threats relating\
    \ to\n   spoofing of caller identification, and threats related to\n   modification\
    \ of location information in transit.  In addition, the\n   threat model applying\
    \ to this work is described.\n"
- title: 2.1.  Existing Work
  contents:
  - "2.1.  Existing Work\n   \"An Architecture for Location and Location Privacy in\
    \ Internet\n   Applications\" [RFC6280] describes an architecture for privacy-\n\
    \   preserving location-based services in the Internet, focusing on\n   authorization,\
    \ security, and privacy requirements for the data\n   formats and protocols used\
    \ by these services.\n   In Section 5 of [RFC6280] (\"An Architecture for Location\
    \ and Location\n   Privacy in Internet Applications\"), mechanisms for ensuring\
    \ the\n   security of the location distribution chain are discussed; these\n \
    \  include mechanisms for hop-by-hop confidentiality and integrity\n   protection\
    \ as well as end-to-end assurance.\n   \"Geopriv Requirements\" [RFC3693] focuses\
    \ on the authorization,\n   security, and privacy requirements of location-dependent\
    \ services,\n   including emergency services.  Section 8 of [RFC3693] includes\n\
    \   discussion of emergency services authentication (Section 8.3), and\n   issues\
    \ relating to identity and anonymity (Section 8.4).\n   \"Threat Analysis of the\
    \ Geopriv Protocol\" [RFC3694] describes threats\n   against geographic location\
    \ privacy, including protocol threats,\n   threats resulting from the storage\
    \ of geographic location data, and\n   threats posed by the abuse of information.\n\
    \   \"Security Threats and Requirements for Emergency Call Marking and\n   Mapping\"\
    \ [RFC5069] reviews security threats associated with the\n   marking of signaling\
    \ messages and the process of mapping locations to\n   Universal Resource Identifiers\
    \ (URIs) that point to PSAPs.  RFC 5069\n   describes attacks on the emergency\
    \ services system, such as\n   attempting to deny system services to all users\
    \ in a given area, to\n   gain fraudulent use of services and to divert emergency\
    \ calls to\n   non-emergency sites.  In addition, it describes attacks against\n\
    \   individuals, including attempts to prevent an individual from\n   receiving\
    \ aid, or to gain information about an emergency, as well as\n   attacks on emergency\
    \ services infrastructure elements, such as\n   mapping discovery and mapping\
    \ servers.\n   \"Secure Telephone Identity Threat Model\" [RFC7375] analyzes threats\n\
    \   relating to impersonation and obscuring of calling party numbers,\n   reviewing\
    \ the capabilities available to attackers, and the scenarios\n   in which attacks\
    \ are launched.\n"
- title: 2.2.  Adversary Model
  contents:
  - "2.2.  Adversary Model\n   To provide a structured analysis, we distinguish between\
    \ three\n   adversary models:\n   External adversary model:  The end host, e.g.,\
    \ an emergency caller\n      whose location is going to be communicated, is honest,\
    \ and the\n      adversary may be located between the end host and the location\n\
    \      server or between the end host and the PSAP.  None of the\n      emergency\
    \ service infrastructure elements act maliciously.\n   Malicious infrastructure\
    \ adversary model:  The emergency call routing\n      elements, such as the Location\
    \ Information Server (LIS), the\n      Location-to-Service Translation (LoST)\
    \ infrastructure (which is\n      used for mapping locations to PSAP addresses),\
    \ or call routing\n      elements, may act maliciously.\n   Malicious end host\
    \ adversary model:  The end host itself acts\n      maliciously, whether the owner\
    \ is aware of this or the end host is\n      acting under the control of a third\
    \ party.\n   Since previous work describes attacks against infrastructure elements\n\
    \   (e.g., location servers, call route servers, mapping servers) or the\n   emergency\
    \ services IP network, as well as threats from attackers\n   attempting to snoop\
    \ location in transit, this document focuses on the\n   threats arising from end\
    \ hosts providing false location information\n   within emergency calls (the malicious\
    \ end host adversary model).\n   Since the focus is on malicious hosts, we do\
    \ not cover threats that\n   may arise from attacks on infrastructure that hosts\
    \ depend on to\n   obtain location.  For example, end hosts may obtain location\
    \ from\n   civilian GPS, which is vulnerable to spoofing [GPSCounter], or from\n\
    \   third-party Location Service Providers (LSPs) that may be vulnerable\n   to\
    \ attack or may not provide location accuracy suitable for emergency\n   purposes.\n\
    \   Also, we do not cover threats arising from inadequate location\n   infrastructure.\
    \  For example, the LIS or end host could base its\n   location determination\
    \ on a stale wiremap or an inaccurate access\n   point location database, leading\
    \ to an inaccurate location estimate.\n   Similarly, a Voice Service Provider\
    \ (VSP) (and, indirectly, a LIS)\n   could utilize the wrong identity (such as\
    \ an IP address) for location\n   lookup, thereby providing the end host with\
    \ misleading location\n   information.\n"
- title: 2.3.  Location Spoofing
  contents:
  - "2.3.  Location Spoofing\n   Where location is attached to the emergency call\
    \ by an end host, the\n   end host can fabricate a PIDF-LO and convey it within\
    \ an emergency\n   call.  The following represent examples of location spoofing:\n\
    \   Place shifting:  Mallory, the adversary, pretends to be at an\n          \
    \          arbitrary location.\n   Time shifting:   Mallory pretends to be at\
    \ a location where she was\n                    a while ago.\n   Location theft:\
    \  Mallory observes or obtains Alice's location and\n                    replays\
    \ it as her own.\n"
- title: 2.4.  Identity Spoofing
  contents:
  - "2.4.  Identity Spoofing\n   While this document does not focus on the problems\
    \ created by\n   determination of location based on spoofed caller identification,\
    \ the\n   ability to ascertain identity is important, since the threat of\n  \
    \ punishment reduces hoax calls.  As an example, calls from pay phones\n   are\
    \ subject to greater scrutiny by the call taker.\n   With calls originating on\
    \ an IP network, at least two forms of\n   identity are relevant, with the distinction\
    \ created by the split\n   between the IAP and the VSP:\n   (a) network access\
    \ identity such as might be determined via\n       authentication (e.g., using\
    \ the Extensible Authentication\n       Protocol (EAP) [RFC3748]);\n   (b) caller\
    \ identity, such as might be determined from authentication\n       of the emergency\
    \ caller at the VoIP application layer.\n   If the adversary did not authenticate\
    \ itself to the VSP, then\n   accountability may depend on verification of the\
    \ network access\n   identity.  However, the network access identity may also\
    \ not have\n   been authenticated, such as in the case where an open IEEE 802.11\n\
    \   Access Point is used to initiate a hoax emergency call.  Although\n   endpoint\
    \ information such as the IP address or Media Access Control\n   (MAC) address\
    \ may have been logged, tying this back to the Device\n   owner may be challenging.\n\
    \   Unlike the existing telephone system, VoIP emergency calls can\n   provide\
    \ an identity that need not necessarily be coupled to a\n   business relationship\
    \ with the IAP, ISP, or VSP.  However, due to the\n   time-critical nature of\
    \ emergency calls, multi-layer authentication\n   is undesirable.  Thus, in most\
    \ cases, only the Device placing the\n   call will be able to be identified. \
    \ Furthermore, deploying\n   additional credentials for emergency service purposes\
    \ (such as\n   certificates) increases costs, introduces a significant\n   administrative\
    \ overhead, and is only useful if widely deployed.\n"
- title: 3.  Mitigation Techniques
  contents:
  - "3.  Mitigation Techniques\n   The sections that follow present three mechanisms\
    \ for mitigating the\n   threats presented in Section 2:\n   1. Signed location-by-value\
    \ (Section 3.1), which provides for\n      authentication and integrity protection\
    \ of the PIDF-LO.  There is\n      only an expired straw-man proposal for this\
    \ mechanism\n      [Loc-Dependability]; thus, as of the time of this writing this\n\
    \      mechanism is not suitable for deployment.\n   2. Location-by-reference\
    \ (Section 3.2), which enables location to be\n      obtained by the PSAP directly\
    \ from the location server, over a\n      confidential and integrity-protected\
    \ channel, avoiding\n      modification by the end host or an intermediary.  This\
    \ mechanism\n      is specified in [RFC6753].\n   3. Proxy-added location (Section\
    \ 3.3), which protects against\n      location forgery by the end host.  This\
    \ mechanism is specified in\n      [RFC6442].\n"
- title: 3.1.  Signed Location-by-Value
  contents:
  - "3.1.  Signed Location-by-Value\n   With location signing, a location server signs\
    \ the location\n   information before it is sent to the Target.  The signed location\n\
    \   information is then sent to the Location Recipient, who verifies it.\n   Figure\
    \ 1 shows the communication model with the Target requesting\n   signed location\
    \ in step (a); the location server returns it in\n   step (b), and it is then\
    \ conveyed to the Location Recipient, who\n   verifies it (step (c)).  For SIP,\
    \ the procedures described in\n   \"Location Conveyance for the Session Initiation\
    \ Protocol\" [RFC6442]\n   are applicable for location conveyance.\n         \
    \          +-----------+               +-----------+\n                   |   \
    \        |               | Location  |\n                   |    LIS    |     \
    \          | Recipient |\n                   |           |               |   \
    \        |\n                   +-+-------+-+               +----+------+\n   \
    \                  ^       |                    --^\n                     |  \
    \     |                  --\n       Geopriv       |Req.   |                --\n\
    \       Location      |Signed |Signed        -- Protocol Conveying\n       Configuration\
    \ |Loc.   |Loc.        --   Location (e.g., SIP)\n       Protocol      |(a)  \
    \  |(b)       --     (c)\n                     |       v        --\n         \
    \          +-+-------+-+    --\n                   | Target /  |  --\n       \
    \            | End Host  +\n                   |           |\n               \
    \    +-----------+\n                        Figure 1: Location Signing\n   A straw-man\
    \ proposal for location signing is provided in \"Digital\n   Signature Methods\
    \ for Location Dependability\" [Loc-Dependability].\n   Note that since [Loc-Dependability]\
    \ is no longer under development,\n   location signing cannot be considered deployable\
    \ at the time of this\n   writing.\n   In order to limit replay attacks, that\
    \ proposal calls for the\n   addition of a \"validity\" element to the PIDF-LO,\
    \ including a \"from\"\n   sub-element containing the time that location information\
    \ was\n   validated by the signer, as well as an \"until\" sub-element containing\n\
    \   the last time that the signature can be considered valid.\n   One of the consequences\
    \ of including an \"until\" element is that even\n   a stationary Target would\
    \ need to periodically obtain a fresh\n   PIDF-LO, or incur the additional delay\
    \ of querying during an\n   emergency call.\n   Although privacy-preserving procedures\
    \ may be disabled for emergency\n   calls, by design, PIDF-LO objects limit the\
    \ information available for\n   real-time attribution.  As noted in [RFC5985],\
    \ Section 6.6:\n      The LIS MUST NOT include any means of identifying the Device\
    \ in\n      the PIDF-LO unless it is able to verify that the identifier is\n \
    \     correct and inclusion of identity is expressly permitted by a Rule\n   \
    \   Maker.  Therefore, PIDF parameters that contain identity are\n      either\
    \ omitted or contain unlinked pseudonyms [RFC3693].  A\n      unique, unlinked\
    \ presentity URI SHOULD be generated by the LIS for\n      the mandatory presence\
    \ \"entity\" attribute of the PIDF document.\n      Optional parameters such as\
    \ the \"contact\" and \"deviceID\" elements\n      [RFC4479] are not used.\n \
    \  Also, the Device referred to in the PIDF-LO may not necessarily be\n   the\
    \ same entity conveying the PIDF-LO to the PSAP.  As noted in\n   [RFC6442], Section\
    \ 1:\n      In no way does this document assume that the SIP user agent client\n\
    \      that sends a request containing a location object is necessarily\n    \
    \  the Target.  The location of a Target conveyed within SIP\n      typically\
    \ corresponds to that of a Device controlled by the\n      Target, for example,\
    \ a mobile phone, but such Devices can be\n      separated from their owners,\
    \ and moreover, in some cases, the user\n      agent may not know its own location.\n\
    \   Without the ability to tie the Target identity to the identity\n   asserted\
    \ in the SIP message, it is possible for an attacker to cut\n   and paste a PIDF-LO\
    \ obtained by a different Device or user into a SIP\n   INVITE and send this to\
    \ the PSAP.  This cut-and-paste attack could\n   succeed even when a PIDF-LO is\
    \ signed or when [RFC4474] is\n   implemented.\n   To address location-spoofing\
    \ attacks, [Loc-Dependability] proposes\n   the addition of an \"identity\" element\
    \ that could include a SIP URI\n   (enabling comparison against the identity asserted\
    \ in the SIP\n   headers) or an X.509v3 certificate.  If the Target was authenticated\n\
    \   by the LIS, an \"authenticated\" attribute is added.  However, because\n \
    \  the inclusion of an \"identity\" element could enable location\n   tracking,\
    \ a \"hash\" element is also proposed that could instead\n   contain a hash of\
    \ the content of the \"identity\" element.  In\n   practice, such a hash would\
    \ not be much better for real-time\n   validation than a pseudonym.\n   Location\
    \ signing cannot deter attacks in which valid location\n   information is provided.\
    \  For example, an attacker in control of\n   compromised hosts could launch a\
    \ denial-of-service attack on the PSAP\n   by initiating a large number of emergency\
    \ calls, each containing\n   valid signed location information.  Since the work\
    \ required to verify\n   the location signature is considerable, this could overwhelm\
    \ the PSAP\n   infrastructure.\n   However, while DDoS attacks are unlikely to\
    \ be deterred by location\n   signing, accurate location information would limit\
    \ the subset of\n   compromised hosts that could be used for an attack, as only\
    \ hosts\n   within the PSAP serving area would be useful in placing emergency\n\
    \   calls.\n   Location signing is also difficult when the host obtains location\
    \ via\n   mechanisms such as GPS, unless trusted computing approaches, with\n\
    \   tamper-proof GPS modules, can be applied.  Otherwise, an end host can\n  \
    \ pretend to have GPS, and the Recipient will need to rely on its\n   ability\
    \ to assess the level of trust that should be placed in the end\n   host location\
    \ claim.\n   Even though location-signing mechanisms have not been standardized,\n\
    \   [NENA-i2], Section 4.7 includes operational recommendations relating\n   to\
    \ location signing:\n      Location configuration and conveyance requirements\
    \ are described\n      in NENA 08-752[27], but guidance is offered here on what\
    \ should be\n      considered when designing mechanisms to report location:\n\
    \      1. The location object should be digitally signed.\n      2. The certificate\
    \ for the signer (LIS operator) should be rooted\n         in VESA.  For this\
    \ purpose, VPC and ERDB operators should issue\n         certificates to LIS operators.\n\
    \      3. The signature should include a timestamp.\n      4. Where possible,\
    \ the Location Object should be refreshed\n         periodically, with the signature\
    \ (and thus the timestamp) being\n         refreshed as a consequence.\n     \
    \ 5. Antispoofing mechanisms should be applied to the Location\n         Reporting\
    \ method.\n   (Note: The term \"Valid Emergency Services Authority\" (VESA) refers\
    \ to\n   the root certificate authority.  \"VPC\" stands for VoIP Positioning\n\
    \   Center, and \"ERDB\" stands for the Emergency Service Zone Routing\n   Database.)\n\
    \   As noted above, signing of location objects implies the development\n   of\
    \ a trust hierarchy that would enable a certificate chain provided\n   by the\
    \ LIS operator to be verified by the PSAP.  Rooting the trust\n   hierarchy in\
    \ the VESA can be accomplished either by having the VESA\n   directly sign the\
    \ LIS certificates or by the creation of intermediate\n   Certificate Authorities\
    \ (CAs) certified by the VESA, which will then\n   issue certificates to the LIS.\
    \  In terms of the workload imposed on\n   the VESA, the latter approach is highly\
    \ preferable.  However, this\n   raises the question of who would operate the\
    \ intermediate CAs and\n   what the expectations would be.\n   In particular,\
    \ the question arises as to the requirements for LIS\n   certificate issuance,\
    \ and how they would compare to requirements for\n   issuance of other certificates\
    \ such as a Secure Socket\n   Layer/Transport Layer Security (SSL/TLS) web certificate.\n"
- title: 3.2.  Location-by-Reference
  contents:
  - "3.2.  Location-by-Reference\n   Location-by-reference was developed so that end\
    \ hosts can avoid\n   having to periodically query the location server for up-to-date\n\
    \   location information in a mobile environment.  Additionally, if\n   operators\
    \ do not want to disclose location information to the end\n   host without charging\
    \ them, location-by-reference provides a\n   reasonable alternative.  Also, since\
    \ location-by-reference enables\n   the PSAP to directly contact the location\
    \ server, it avoids potential\n   attacks by intermediaries.\n   As noted in \"\
    A Location Dereference Protocol Using HTTP-Enabled\n   Location Delivery (HELD)\"\
    \ [RFC6753], a location reference can be\n   obtained via HELD [RFC5985].  In\
    \ addition, \"Location Configuration\n   Extensions for Policy Management\" [RFC7199]\
    \ extends location\n   configuration protocols such as HELD to provide hosts with\
    \ a\n   reference to the rules that apply to a location-by-reference so that\n\
    \   the host can view or set these rules.\n   Figure 2 shows the communication\
    \ model with the Target requesting a\n   location reference in step (a); the location\
    \ server returns the\n   reference and, potentially, the policy in step (b), and\
    \ it is then\n   conveyed to the Location Recipient in step (c).  The Location\n\
    \   Recipient needs to resolve the reference with a request in step (d).\n   Finally,\
    \ location information is returned to the Location Recipient\n   afterwards. \
    \ For location conveyance in SIP, the procedures described\n   in [RFC6442] are\
    \ applicable.\n                   +-----------+  Geopriv      +-----------+\n\
    \                   |           |  Location     | Location  |\n              \
    \     |    LIS    +<------------->+ Recipient |\n                   |        \
    \   | Dereferencing |           |\n                   +-+-------+-+ Protocol (d)\
    \  +----+------+\n                     ^       |                    --^\n    \
    \                 |       |                  --\n       Geopriv       |Req.  \
    \ |LbyR +          --\n       Location      |LbyR   |Policy        -- Protocol\
    \ Conveying\n       Configuration |(a)    |(b)         --   Location (e.g., SIP)\n\
    \       Protocol      |       |          --     (c)\n                     |  \
    \     V        --\n                   +-+-------+-+    --\n                  \
    \ | Target /  |  --\n                   | End Host  +\n                   |  \
    \         |\n                   +-----------+\n                      Figure 2:\
    \ Location-by-Reference\n   Where location-by-reference is provided, the Recipient\
    \ needs to\n   dereference the LbyR in order to obtain location.  The details\
    \ for\n   the dereferencing operations vary with the type of reference, such as\n\
    \   an HTTP, HTTPS, SIP, secure SIP (SIPS), or SIP Presence URI.\n   For location-by-reference,\
    \ the location server needs to maintain one\n   or several URIs for each Target,\
    \ timing out these URIs after a\n   certain amount of time.  References need to\
    \ expire to prevent the\n   Recipient of such a Uniform Resource Locator (URL)\
    \ from being able to\n   permanently track a host and to offer garbage collection\n\
    \   functionality for the location server.\n   Off-path adversaries must be prevented\
    \ from obtaining the Target's\n   location.  The reference contains a randomized\
    \ component that\n   prevents third parties from guessing it.  When the Location\
    \ Recipient\n   fetches up-to-date location information from the location server,\
    \ it\n   can also be assured that the location information is fresh and not\n\
    \   replayed.  However, this does not address location theft.\n   With respect\
    \ to the security of the dereference operation, [RFC6753],\n   Section 6 states:\n\
    \      TLS MUST be used for dereferencing location URIs unless\n      confidentiality\
    \ and integrity are provided by some other\n      mechanism, as discussed in Section\
    \ 3.  Location Recipients MUST\n      authenticate the host identity using the\
    \ domain name included in\n      the location URI, using the procedure described\
    \ in Section 3.1 of\n      [RFC2818].  Local policy determines what a Location\
    \ Recipient does\n      if authentication fails or cannot be attempted.\n    \
    \  The authorization by possession model (Section 4.1) further relies\n      on\
    \ TLS when transmitting the location URI to protect the secrecy\n      of the\
    \ URI.  Possession of such a URI implies the same privacy\n      considerations\
    \ as possession of the PIDF-LO document that the URI\n      references.\n    \
    \  Location URIs MUST only be disclosed to authorized Location\n      Recipients.\
    \  The GEOPRIV architecture [RFC6280] designates the\n      Rule Maker to authorize\
    \ disclosure of the URI.\n      Protection of the location URI is necessary, since\
    \ the policy\n      attached to such a location URI permits anyone who has the\
    \ URI to\n      view the associated location information.  This aspect of security\n\
    \      is covered in more detail in the specification of location\n      conveyance\
    \ protocols, such as [RFC6442].\n   For authorizing access to location-by-reference,\
    \ two authorization\n   models were developed: \"Authorization by Possession\"\
    \ and\n   \"Authorization via Access Control Lists\".  With respect to\n   \"\
    Authorization by Possession\", [RFC6753], Section 4.1 notes:\n      In this model,\
    \ possession -- or knowledge -- of the location URI\n      is used to control\
    \ access to location information.  A location URI\n      might be constructed\
    \ such that it is hard to guess (see C8 of\n      [RFC5808]), and the set of entities\
    \ that it is disclosed to can be\n      limited.  The only authentication this\
    \ would require by the LS is\n      evidence of possession of the URI.  The LS\
    \ could immediately\n      authorize any request that indicates this URI.\n  \
    \    Authorization by possession does not require direct interaction\n      with\
    \ a Rule Maker; it is assumed that the Rule Maker is able to\n      exert control\
    \ over the distribution of the location URI.\n      Therefore, the LIS can operate\
    \ with limited policy input from a\n      Rule Maker.\n      Limited disclosure\
    \ is an important aspect of this authorization\n      model.  The location URI\
    \ is a secret; therefore, ensuring that\n      adversaries are not able to acquire\
    \ this information is paramount.\n      Encryption, such as might be offered by\
    \ TLS [RFC5246] or S/MIME\n      [RFC5751], protects the information from eavesdroppers.\n\
    \      ...\n      Using possession as a basis for authorization means that, once\n\
    \      granted, authorization cannot be easily revoked.  Cancellation of\n   \
    \   a location URI ensures that legitimate users are also affected;\n      application\
    \ of additional policy is theoretically possible but\n      could be technically\
    \ infeasible.  Expiration of location URIs\n      limits the usable time for a\
    \ location URI, requiring that an\n      attacker continue to learn new location\
    \ URIs to retain access to\n      current location information.\n   In situations\
    \ where \"Authorization by Possession\" is not suitable\n   (such as where location\
    \ hiding [RFC6444] is required), the\n   \"Authorization via Access Control Lists\"\
    \ model may be preferred.\n   Without the introduction of a hierarchy, it would\
    \ be necessary for\n   the PSAP to obtain credentials, such as certificates or\
    \ shared\n   symmetric keys, for all the LISs in its coverage area, to enable\
    \ it\n   to successfully dereference LbyRs.  In situations with more than a\n\
    \   few LISs per PSAP, this would present operational challenges.\n   A certificate\
    \ hierarchy providing PSAPs with client certificates\n   chaining to the VESA\
    \ could be used to enable the LIS to authenticate\n   and authorize PSAPs for\
    \ dereferencing.  Note that unlike PIDF-LO\n   signing (which mitigates modification\
    \ of PIDF-LOs), this merely\n   provides the PSAP with access to a (potentially\
    \ unsigned) PIDF-LO,\n   albeit over a protected TLS channel.\n   Another approach\
    \ would be for the local LIS to upload location\n   information to a location\
    \ aggregation point who would in turn manage\n   the relationships with the PSAP.\
    \  This would shift the management\n   burden from the PSAPs to the location aggregation\
    \ points.\n"
- title: 3.3.  Proxy-Added Location
  contents:
  - "3.3.  Proxy-Added Location\n   Instead of relying upon the end host to provide\
    \ location, is possible\n   for a proxy that has the ability to determine the\
    \ location of the end\n   point (e.g., based on the end host IP or MAC address)\
    \ to retrieve and\n   add or override location information.  This requires deployment\
    \ of\n   application-layer entities by ISPs, unlike the two other techniques.\n\
    \   The proxies could be used for emergency or non-emergency\n   communications,\
    \ or both.\n   The use of proxy-added location is primarily applicable in scenarios\n\
    \   where the end host does not provide location.  As noted in [RFC6442],\n  \
    \ Section 4.1:\n      A SIP intermediary SHOULD NOT add location to a SIP request\
    \ that\n      already contains location.  This will quite often lead to\n    \
    \  confusion within LRs.  However, if a SIP intermediary adds\n      location,\
    \ even if location was not previously present in a SIP\n      request, that SIP\
    \ intermediary is fully responsible for addressing\n      the concerns of any\
    \ 424 (Bad Location Information) SIP response it\n      receives about this location\
    \ addition and MUST NOT pass on\n      (upstream) the 424 response.  A SIP intermediary\
    \ that adds a\n      locationValue MUST position the new locationValue as the\
    \ last\n      locationValue within the Geolocation header field of the SIP\n \
    \     request.\n      ...\n      A SIP intermediary MAY add a Geolocation header\
    \ field if one is\n      not present -- for example, when a user agent does not\
    \ support the\n      Geolocation mechanism but their outbound proxy does and knows\
    \ the\n      Target's location, or any of a number of other use cases (see\n \
    \     Section 3).\n   As noted in [RFC6442], Section 3.3:\n      This document\
    \ takes a \"you break it, you bought it\" approach to\n      dealing with second\
    \ locations placed into a SIP request by an\n      intermediary entity.  That\
    \ entity becomes completely responsible\n      for all location within that SIP\
    \ request (more on this in\n      Section 4).\n   While it is possible for the\
    \ proxy to override location included by\n   the end host, [RFC6442], Section\
    \ 3.4 notes the operational\n   limitations:\n      Overriding location information\
    \ provided by the user requires a\n      deployment where an intermediary necessarily\
    \ knows better than an\n      end user -- after all, it could be that Alice has\
    \ an on-board GPS,\n      and the SIP intermediary only knows her nearest cell\
    \ tower.  Which\n      is more accurate location information?  Currently, there\
    \ is no way\n      to tell which entity is more accurate or which is wrong, for\
    \ that\n      matter.  This document will not specify how to indicate which\n\
    \      location is more accurate than another.\n   The disadvantage of this approach\
    \ is the need to deploy application-\n   layer entities, such as SIP proxies,\
    \ at IAPs or associated with IAPs.\n   This requires that a standardized VoIP\
    \ profile be deployed at every\n   end Device and at every IAP.  This might impose\
    \ interoperability\n   challenges.\n   Additionally, the IAP needs to take responsibility\
    \ for emergency\n   calls, even for customers with whom they have no direct or\
    \ indirect\n   relationship.  To provide identity information about the emergency\n\
    \   caller from the VSP, it would be necessary to let the IAP and the VSP\n  \
    \ interact for authentication (see, for example, \"Diameter Session\n   Initiation\
    \ Protocol (SIP) Application\" [RFC4740]).  This interaction\n   along the Authentication,\
    \ Authorization, and Accounting\n   infrastructure is often based on business\
    \ relationships between the\n   involved entities.  An arbitrary IAP and VSP are\
    \ unlikely to have a\n   business relationship.  If the interaction between the\
    \ IAP and the\n   VSP fails due to the lack of a business relationship, then typically\n\
    \   a fall-back would be provided where no emergency caller identity\n   information\
    \ is made available to the PSAP and the emergency call\n   still has to be completed.\n"
- title: 4.  Location Trust Assessment
  contents:
  - "4.  Location Trust Assessment\n   The ability to assess the level of trustworthiness\
    \ of conveyed\n   location information is important, since this makes it possible\
    \ to\n   understand how much value should be placed on location information as\n\
    \   part of the decision-making process.  As an example, if automated\n   location\
    \ information is understood to be highly suspect or is absent,\n   a call taker\
    \ can put more effort into verifying the authenticity of\n   the call and obtaining\
    \ location information from the caller.\n   Location trust assessment has value,\
    \ regardless of whether the\n   location itself is authenticated (e.g., signed\
    \ location) or is\n   obtained directly from the location server (e.g., location-by-\n\
    \   reference) over security transport, since these mechanisms do not\n   provide\
    \ assurance of the validity or provenance of location data.\n   To prevent location-theft\
    \ attacks, the \"entity\" element of the\n   PIDF-LO is of limited value if an\
    \ unlinked pseudonym is provided in\n   this field.  However, if the LIS authenticates\
    \ the Target, then the\n   linkage between the pseudonym and the Target identity\
    \ can be\n   recovered in a post-incident investigation.\n   As noted in [Loc-Dependability],\
    \ if the location object was signed,\n   the Location Recipient has additional\
    \ information on which to base\n   their trust assessment, such as the validity\
    \ of the signature, the\n   identity of the Target, the identity of the LIS, whether\
    \ the LIS\n   authenticated the Target, and the identifier included in the \"\
    entity\"\n   field.\n   Caller accountability is also an important aspect of trust\n\
    \   assessment.  Can the individual purchasing the Device or activating\n   service\
    \ be identified, or did the call originate from a non-service\n   initialized\
    \ (NSI) Device whose owner cannot be determined?  Prior to\n   the call, was the\
    \ caller authenticated at the network or application\n   layer?  In the event\
    \ of a hoax call, can audit logs be made available\n   to an investigator, or\
    \ can information relating to the owner of an\n   unlinked pseudonym be provided,\
    \ enabling investigators to unravel the\n   chain of events that led to the attack?\n\
    \   In practice, the source of the location data is important for\n   location\
    \ trust assessment.  For example, location provided by a\n   Location Information\
    \ Server (LIS) whose administrator has an\n   established history of meeting emergency\
    \ location accuracy\n   requirements (e.g., United States Phase II E-911 location\
    \ accuracy)\n   may be considered more reliable than location information provided\
    \ by\n   a third-party Location Service Provider (LSP) that disclaims use of\n\
    \   location information for emergency purposes.\n   However, even where an LSP\
    \ does not attempt to meet the accuracy\n   requirements for emergency location,\
    \ it still may be able to provide\n   information useful in assessing how reliable\
    \ location information is\n   likely to be.  For example, was location determined\
    \ based on the\n   nearest cell tower or 802.11 Access Point (AP), or was a\n\
    \   triangulation method used?  If based on cell tower or AP location\n   data,\
    \ was the information obtained from an authoritative source\n   (e.g., the tower\
    \ or AP owner), and when was the last time that the\n   location of the tower\
    \ or access point was verified?\n   For real-time validation, information in the\
    \ signaling and media\n   packets can be cross-checked against location information.\
    \  For\n   example, it may be possible to determine the city, state, country,\
    \ or\n   continent associated with the IP address included within SIP Via or\n\
    \   Contact header fields, or the media source address, and compare this\n   against\
    \ the location information reported by the caller or conveyed\n   in the PIDF-LO.\
    \  However, in some situations, only entities close to\n   the caller may be able\
    \ to verify the correctness of location\n   information.\n   Real-time validation\
    \ of the timestamp contained within PIDF-LO\n   objects (reflecting the time at\
    \ which the location was determined) is\n   also challenging.  To address time-shifting\
    \ attacks, the \"timestamp\"\n   element of the PIDF-LO, defined in [RFC3863],\
    \ can be examined and\n   compared against timestamps included within the enclosing\
    \ SIP\n   message, to determine whether the location data is sufficiently\n  \
    \ fresh.  However, the timestamp only represents an assertion by the\n   LIS,\
    \ which may or may not be trustworthy.  For example, the Recipient\n   of the\
    \ signed PIDF-LO may not know whether the LIS supports time\n   synchronization,\
    \ or whether it is possible to reset the LIS clock\n   manually without detection.\
    \  Even if the timestamp was valid at the\n   time location was determined, a\
    \ time period may elapse between when\n   the PIDF-LO was provided and when it\
    \ is conveyed to the Recipient.\n   Periodically refreshing location information\
    \ to renew the timestamp\n   even though the location information itself is unchanged\
    \ puts\n   additional load on LISs.  As a result, Recipients need to validate\n\
    \   the timestamp in order to determine whether it is credible.\n   While this\
    \ document focuses on the discussion of real-time\n   determination of suspicious\
    \ emergency calls, the use of audit logs\n   may help in enforcing accountability\
    \ among emergency callers.  For\n   example, in the event of a hoax call, information\
    \ relating to the\n   owner of the unlinked pseudonym could be provided to investigators,\n\
    \   enabling them to unravel the chain of events that led to the attack.\n   However,\
    \ while auditability is an important deterrent, it is likely\n   to be of most\
    \ benefit in situations where attacks on the emergency\n   services system are\
    \ likely to be relatively infrequent, since the\n   resources required to pursue\
    \ an investigation are likely to be\n   considerable.  However, although real-time\
    \ validation based on\n   PIDF-LO elements is challenging, where LIS audit logs\
    \ are available\n   (such as where a law enforcement agency can present a subpoena),\n\
    \   linking of a pseudonym to the Device obtaining location can be\n   accomplished\
    \ during an investigation.\n   Where attacks are frequent and continuous, automated\
    \ mechanisms are\n   required.  For example, it might be valuable to develop mechanisms\
    \ to\n   exchange audit trail information in a standardized format between\n \
    \  ISPs and PSAPs / VSPs and PSAPs or heuristics to distinguish\n   potentially\
    \ fraudulent emergency calls from real emergencies.  While\n   a Completely Automated\
    \ Public Turing test to tell Computers and\n   Humans Apart (CAPTCHA) may be applied\
    \ to suspicious calls to lower\n   the risk from bot-nets, this is quite controversial\
    \ for emergency\n   services, due to the risk of delaying or rejecting valid calls.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   Although it is important to ensure that location\
    \ information cannot\n   be faked, the mitigation techniques presented in this\
    \ document are\n   not universally applicable.  For example, there will be many\
    \ GPS-\n   enabled Devices that will find it difficult to utilize any of the\n\
    \   solutions described in Section 3.  It is also unlikely that users\n   will\
    \ be willing to upload their location information for\n   \"verification\" to\
    \ a nearby location server located in the access\n   network.\n   This document\
    \ focuses on threats that arise from conveyance of\n   misleading location information,\
    \ rather than caller identification or\n   authentication and integrity protection\
    \ of the messages in which\n   location is conveyed.  Nevertheless, these aspects\
    \ are important.  In\n   some countries, regulators may not require the authenticated\
    \ identity\n   of the emergency caller (e.g., emergency calls placed from Public\n\
    \   Switched Telephone Network (PSTN) pay phones or SIM-less cell\n   phones).\
    \  Furthermore, if identities can easily be crafted (as is the\n   case with many\
    \ VoIP offerings today), then the value of emergency\n   caller authentication\
    \ itself might be limited.  As a result,\n   attackers can forge emergency calls\
    \ with a lower risk of being held\n   accountable, which may encourage hoax calls.\n\
    \   In order to provide authentication and integrity protection for the\n   Session\
    \ Initiation Protocol (SIP) messages conveying location,\n   several security\
    \ approaches are available.  It is possible to ensure\n   that modification of\
    \ the identity and location in transit can be\n   detected by the Location Recipient\
    \ (e.g., the PSAP), using\n   cryptographic mechanisms, as described in \"Enhancements\
    \ for\n   Authenticated Identity Management in the Session Initiation Protocol\n\
    \   (SIP)\" [RFC4474].  However, compatibility with Session Border\n   Controllers\
    \ (SBCs) that modify integrity-protected headers has proven\n   to be an issue\
    \ in practice, and as a result, a revision of [RFC4474]\n   is in progress [SIP-Identity].\
    \  In the absence of an end-to-end\n   solution, SIP over Transport Layer Security\
    \ (TLS) can be used to\n   provide message authentication and integrity protection\
    \ hop by hop.\n   PSAPs remain vulnerable to distributed denial-of-service attacks,\n\
    \   even where the mitigation techniques described in this document are\n   utilized.\
    \  Placing a large number of emergency calls that appear to\n   come from different\
    \ locations is an example of an attack that is\n   difficult to carry out within\
    \ the legacy system but is easier to\n   imagine within IP-based emergency services.\
    \  Also, in the current\n   system, it would be very difficult for an attacker\
    \ from one country\n   to attack the emergency services infrastructure located\
    \ in another\n   country, but this attack is possible within IP-based emergency\n\
    \   services.\n   While manually mounting the attacks described in Section 2 is\n\
    \   non-trivial, the attacks described in this document can be automated.\n  \
    \ While manually carrying out a location theft would require that the\n   attacker\
    \ be in proximity to the location being spoofed, or to collude\n   with another\
    \ end host, an attacker able to run code on an end host\n   can obtain its location\
    \ and cause an emergency call to be made.\n   While manually carrying out a time-shifting\
    \ attack would require that\n   the attacker visit the location and submit it\
    \ before the location\n   information is considered stale, while traveling rapidly\
    \ away from\n   that location to avoid apprehension, these limitations would not\n\
    \   apply to an attacker able to run code on the end host.  While\n   obtaining\
    \ a PIDF-LO from a spoofed IP address requires that the\n   attacker be on the\
    \ path between the HELD requester and the LIS, if\n   the attacker is able to\
    \ run code requesting the PIDF-LO, retrieve it\n   from the LIS, and then make\
    \ an emergency call using it, this attack\n   becomes much easier.  To mitigate\
    \ the risk of automated attacks,\n   service providers can limit the ability of\
    \ untrusted code (such as\n   WebRTC applications written in JavaScript) to make\
    \ emergency calls.\n   Emergency services have three finite resources subject\
    \ to denial-of-\n   service attacks: the network and server infrastructure; call\
    \ takers\n   and dispatchers; and the first responders, such as firefighters and\n\
    \   police officers.  Protecting the network infrastructure is similar to\n  \
    \ protecting other high-value service providers, except that location\n   information\
    \ may be used to filter call setup requests, to weed out\n   requests that are\
    \ out of area.  Even for large cities, PSAPs may only\n   have a handful of call\
    \ takers on duty.  So, even if automated\n   techniques are utilized to evaluate\
    \ the trustworthiness of conveyed\n   location and call takers can, by questioning\
    \ the caller, eliminate\n   many hoax calls, PSAPs can be overwhelmed even by\
    \ a small-scale\n   attack.  Finally, first-responder resources are scarce, particularly\n\
    \   during mass-casualty events.\n"
- title: 6.  Privacy Considerations
  contents:
  - "6.  Privacy Considerations\n   The emergency calling architecture described in\
    \ [RFC6443] utilizes\n   the PIDF-LO format defined in [RFC4119].  As described\
    \ in the\n   location privacy architecture [RFC6280], privacy rules that may\n\
    \   include policy instructions are conveyed along with the location\n   object.\n\
    \   The intent of the location privacy architecture was to provide strong\n  \
    \ privacy protections, as noted in [RFC6280], Section 1.1:\n      A central feature\
    \ of the Geopriv architecture is that location\n      information is always bound\
    \ to privacy rules to ensure that\n      entities that receive location information\
    \ are informed of how\n      they may use it.  These rules can convey simple directives\
    \ (\"do\n      not share my location with others\"), or more robust preferences\n\
    \      (\"allow my spouse to know my exact location all of the time, but\n   \
    \   only allow my boss to know it during work hours\")...  The binding\n     \
    \ of privacy rules to location information can convey users' desire\n      for\
    \ and expectations of privacy, which in turn helps to bolster\n      social and\
    \ legal systems' protection of those expectations.\n   However, in practice this\
    \ architecture has limitations that apply\n   within emergency and non-emergency\
    \ situations.  As noted in\n   Section 1.2.2, concerns about hoax calls have led\
    \ to restrictions on\n   anonymous emergency calls.  Caller identification (potentially\n\
    \   asserted in SIP via P-Asserted-Identity and SIP Identity) may be used\n  \
    \ during emergency calls.  As a result, in many cases location\n   information\
    \ transmitted within SIP messages can be linked to caller\n   identity.  For example,\
    \ in the case of a signed LbyV, there are\n   privacy concerns arising from linking\
    \ the location object to\n   identifiers to prevent replay attacks, as described\
    \ in Section 3.1.\n   The ability to observe location information during emergency\
    \ calls\n   may also represent a privacy risk.  As a result, [RFC6443] requires\n\
    \   transmission-layer security for SIP messages, as well as interactions\n  \
    \ with the location server.  However, even where transmission-layer\n   security\
    \ is used, privacy rules associated with location information\n   may not apply.\n\
    \   In many jurisdictions, an individual requesting emergency assistance\n   is\
    \ assumed to be granting permission to the PSAP, call taker, and\n   first responders\
    \ to obtain their location in order to accelerate\n   dispatch.  As a result,\
    \ privacy policies associated with location are\n   implicitly waived when an\
    \ emergency call is initiated.  In addition,\n   when location information is\
    \ included within SIP messages in either\n   emergency or non-emergency uses,\
    \ SIP entities receiving the SIP\n   message are implicitly assumed to be authorized\
    \ Location Recipients,\n   as noted in [RFC5606], Section 3.2:\n      Consensus\
    \ has emerged that any SIP entity that receives a SIP\n      message containing\
    \ LI through the operation of SIP's normal\n      routing procedures or as a result\
    \ of location-based routing should\n      be considered an authorized recipient\
    \ of that LI.  Because of this\n      presumption, one SIP element may pass the\
    \ LI to another even if\n      the LO it contains has <retransmission-allowed>\
    \ set to \"no\"; this\n      sees the passing of the SIP message as part of the\
    \ delivery to\n      authorized recipients, rather than as retransmission.  SIP\n\
    \      entities are still enjoined from passing these messages\n      outside\
    \ the normal routing to external entities if\n      <retransmission-allowed> is\
    \ set to \"no\", as it is the passing to\n      third parties that <retransmission-allowed>\
    \ is meant to control.\n   Where LbyR is utilized rather than LbyV, it is possible\
    \ to apply more\n   restrictive authorization policies, limiting access to intermediaries\n\
    \   and snoopers.  However, this is not possible if the \"authorization by\n \
    \  possession\" model is used.\n"
- title: 7.  Informative References
  contents:
  - "7.  Informative References\n   [EENA]     EENA, \"False Emergency Calls\", EENA\
    \ Operations Document,\n              Version 1.1, May 2011, <http://www.eena.org/ressource/\n\
    \              static/files/2012_05_04-3.1.2.fc_v1.1.pdf>.\n   [GPSCounter]\n\
    \              Warner, J. and R. Johnston, \"GPS Spoofing\n              Countermeasures\"\
    , Los Alamos research paper LAUR-03-6163,\n              December 2003.\n   [Loc-Dependability]\n\
    \              Thomson, M. and J. Winterbottom, \"Digital Signature\n        \
    \      Methods for Location Dependability\", Work in Progress,\n             \
    \ draft-thomson-geopriv-location-dependability-07,\n              March 2011.\n\
    \   [NENA-i2]  NENA 08-001, \"NENA Interim VoIP Architecture for Enhanced\n  \
    \            9-1-1 Services (i2)\", Version 2, August 2010.\n   [RFC2119]  Bradner,\
    \ S., \"Key words for use in RFCs to Indicate\n              Requirement Levels\"\
    , BCP 14, RFC 2119, March 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC2818]  Rescorla, E., \"HTTP Over TLS\", RFC 2818, May 2000,\n        \
    \      <http://www.rfc-editor.org/info/rfc2818>.\n   [RFC3261]  Rosenberg, J.,\
    \ Schulzrinne, H., Camarillo, G., Johnston,\n              A., Peterson, J., Sparks,\
    \ R., Handley, M., and E.\n              Schooler, \"SIP: Session Initiation Protocol\"\
    , RFC 3261,\n              June 2002, <http://www.rfc-editor.org/info/rfc3261>.\n\
    \   [RFC3693]  Cuellar, J., Morris, J., Mulligan, D., Peterson, J., and\n    \
    \          J. Polk, \"Geopriv Requirements\", RFC 3693, February 2004,\n     \
    \         <http://www.rfc-editor.org/info/rfc3693>.\n   [RFC3694]  Danley, M.,\
    \ Mulligan, D., Morris, J., and J. Peterson,\n              \"Threat Analysis\
    \ of the Geopriv Protocol\", RFC 3694,\n              February 2004, <http://www.rfc-editor.org/info/rfc3694>.\n\
    \   [RFC3748]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.\n   \
    \           Levkowetz, Ed., \"Extensible Authentication Protocol\n           \
    \   (EAP)\", RFC 3748, June 2004,\n              <http://www.rfc-editor.org/info/rfc3748>.\n\
    \   [RFC3863]  Sugano, H., Fujimoto, S., Klyne, G., Bateman, A., Carr,\n     \
    \         W., and J. Peterson, \"Presence Information Data Format\n          \
    \    (PIDF)\", RFC 3863, August 2004,\n              <http://www.rfc-editor.org/info/rfc3863>.\n\
    \   [RFC4119]  Peterson, J., \"A Presence-based GEOPRIV Location Object\n    \
    \          Format\", RFC 4119, December 2005,\n              <http://www.rfc-editor.org/info/rfc4119>.\n\
    \   [RFC4474]  Peterson, J. and C. Jennings, \"Enhancements for\n            \
    \  Authenticated Identity Management in the Session\n              Initiation\
    \ Protocol (SIP)\", RFC 4474, August 2006,\n              <http://www.rfc-editor.org/info/rfc4474>.\n\
    \   [RFC4479]  Rosenberg, J., \"A Data Model for Presence\", RFC 4479,\n     \
    \         July 2006, <http://www.rfc-editor.org/info/rfc4479>.\n   [RFC4740] \
    \ Garcia-Martin, M., Ed., Belinchon, M., Pallares-Lopez, M.,\n              Canales-Valenzuela,\
    \ C., and K. Tammi, \"Diameter Session\n              Initiation Protocol (SIP)\
    \ Application\", RFC 4740,\n              November 2006, <http://www.rfc-editor.org/info/rfc4740>.\n\
    \   [RFC5012]  Schulzrinne, H. and R. Marshall, Ed., \"Requirements for\n    \
    \          Emergency Context Resolution with Internet Technologies\",\n      \
    \        RFC 5012, January 2008,\n              <http://www.rfc-editor.org/info/rfc5012>.\n\
    \   [RFC5069]  Taylor, T., Ed., Tschofenig, H., Schulzrinne, H., and M.\n    \
    \          Shanmugam, \"Security Threats and Requirements for\n              Emergency\
    \ Call Marking and Mapping\", RFC 5069,\n              January 2008, <http://www.rfc-editor.org/info/rfc5069>.\n\
    \   [RFC5246]  Dierks, T. and E. Rescorla, \"The Transport Layer Security\n  \
    \            (TLS) Protocol Version 1.2\", RFC 5246, August 2008,\n          \
    \    <http://www.rfc-editor.org/info/rfc5246>.\n   [RFC5491]  Winterbottom, J.,\
    \ Thomson, M., and H. Tschofenig, \"GEOPRIV\n              Presence Information\
    \ Data Format Location Object (PIDF-LO)\n              Usage Clarification, Considerations,\
    \ and Recommendations\",\n              RFC 5491, March 2009,\n              <http://www.rfc-editor.org/info/rfc5491>.\n\
    \   [RFC5606]  Peterson, J., Hardie, T., and J. Morris, \"Implications of\n  \
    \            'retransmission-allowed' for SIP Location Conveyance\",\n       \
    \       RFC 5606, August 2009,\n              <http://www.rfc-editor.org/info/rfc5606>.\n\
    \   [RFC5751]  Ramsdell, B. and S. Turner, \"Secure/Multipurpose Internet\n  \
    \            Mail Extensions (S/MIME) Version 3.2 Message\n              Specification\"\
    , RFC 5751, January 2010,\n              <http://www.rfc-editor.org/info/rfc5751>.\n\
    \   [RFC5808]  Marshall, R., Ed., \"Requirements for a Location-by-\n        \
    \      Reference Mechanism\", RFC 5808, May 2010,\n              <http://www.rfc-editor.org/info/rfc5808>.\n\
    \   [RFC5985]  Barnes, M., Ed., \"HTTP-Enabled Location Delivery (HELD)\",\n \
    \             RFC 5985, September 2010,\n              <http://www.rfc-editor.org/info/rfc5985>.\n\
    \   [RFC6280]  Barnes, R., Lepinski, M., Cooper, A., Morris, J.,\n           \
    \   Tschofenig, H., and H. Schulzrinne, \"An Architecture for\n              Location\
    \ and Location Privacy in Internet Applications\",\n              BCP 160, RFC\
    \ 6280, July 2011,\n              <http://www.rfc-editor.org/info/rfc6280>.\n\
    \   [RFC6442]  Polk, J., Rosen, B., and J. Peterson, \"Location Conveyance\n \
    \             for the Session Initiation Protocol\", RFC 6442,\n             \
    \ December 2011, <http://www.rfc-editor.org/info/rfc6442>.\n   [RFC6443]  Rosen,\
    \ B., Schulzrinne, H., Polk, J., and A. Newton,\n              \"Framework for\
    \ Emergency Calling Using Internet\n              Multimedia\", RFC 6443, December\
    \ 2011,\n              <http://www.rfc-editor.org/info/rfc6443>.\n   [RFC6444]\
    \  Schulzrinne, H., Liess, L., Tschofenig, H., Stark, B., and\n              A.\
    \  Kuett, \"Location Hiding: Problem Statement and\n              Requirements\"\
    , RFC 6444, January 2012,\n              <http://www.rfc-editor.org/info/rfc6444>.\n\
    \   [RFC6753]  Winterbottom, J., Tschofenig, H., Schulzrinne, H., and M.\n   \
    \           Thomson, \"A Location Dereference Protocol Using HTTP-\n         \
    \     Enabled Location Delivery (HELD)\", RFC 6753, October 2012,\n          \
    \    <http://www.rfc-editor.org/info/rfc6753>.\n   [RFC6881]  Rosen, B. and J.\
    \ Polk, \"Best Current Practice for\n              Communications Services in\
    \ Support of Emergency Calling\",\n              BCP 181, RFC 6881, March 2013,\n\
    \              <http://www.rfc-editor.org/info/rfc6881>.\n   [RFC7090]  Schulzrinne,\
    \ H., Tschofenig, H., Holmberg, C., and M.\n              Patel, \"Public Safety\
    \ Answering Point (PSAP) Callback\",\n              RFC 7090, April 2014,\n  \
    \            <http://www.rfc-editor.org/info/rfc7090>.\n   [RFC7199]  Barnes,\
    \ R., Thomson, M., Winterbottom, J., and H.\n              Tschofenig, \"Location\
    \ Configuration Extensions for Policy\n              Management\", RFC 7199, April\
    \ 2014,\n              <http://www.rfc-editor.org/info/rfc7199>.\n   [RFC7340]\
    \  Peterson, J., Schulzrinne, H., and H. Tschofenig, \"Secure\n              Telephone\
    \ Identity Problem Statement and Requirements\",\n              RFC 7340, September\
    \ 2014,\n              <http://www.rfc-editor.org/info/rfc7340>.\n   [RFC7375]\
    \  Peterson, J., \"Secure Telephone Identity Threat Model\",\n              RFC\
    \ 7375, October 2014,\n              <http://www.rfc-editor.org/info/rfc7375>.\n\
    \   [SA]       \"Saudi Arabia - Illegal sale of SIMs blamed for surge in\n   \
    \           hoax calls\", Arab News, April 5, 2010,\n              <http://www.arabnews.com/node/341463>.\n\
    \   [SIP-Identity]\n              Peterson, J., Jennings, C. and E. Rescorla,\
    \ \"Authenticated\n              Identity Management in the Session Initiation\
    \ Protocol\n              (SIP)\", Work in Progress, draft-ietf-stir-rfc4474bis-02,\n\
    \              October 2014.\n   [STIR]     IETF, \"Secure Telephone Identity\
    \ Revisited (stir) Working\n              Group\", October 2013,\n           \
    \   <http://datatracker.ietf.org/wg/stir/charter/>.\n   [SWATing]  \"SWATing 911\
    \ Calls\", Dispatch Magazine On-Line,\n              April 6, 2013, <http://www.911dispatch.com/\n\
    \              swating-911-calls/>.\n   [Swatting] \"Don't Make the Call: The\
    \ New Phenomenon of 'Swatting'\",\n              Federal Bureau of Investigation,\
    \ February 4, 2008,\n              <http://www.fbi.gov/news/stories/2008/february/\n\
    \              swatting020408>.\n   [TASMANIA] \"Emergency services seek SIM-less\
    \ calls block\", ABC News\n              Online, August 18, 2006, <http://www.abc.net.au/elections/\n\
    \              tas/2006/news/stories/1717956.htm?elections/tas/2006/>.\n   [UK]\
    \       \"Rapper makes thousands of prank 999 emergency calls to UK\n        \
    \      police\", Digital Journal, June 24, 2010,\n              <http://www.digitaljournal.com/article/293796?tp=1>.\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   We would like to thank the members of the IETF ECRIT working\
    \ group,\n   including Marc Linsner and Brian Rosen, for their input at IETF 85\n\
    \   that helped get this document pointed in the right direction.  We\n   would\
    \ also like to thank members of the IETF GEOPRIV working group,\n   including\
    \ Richard Barnes, Matt Lepinski, Andrew Newton, Murugaraj\n   Shanmugam, and Martin\
    \ Thomson for their feedback on previous versions\n   of this document.  Alissa\
    \ Cooper, Adrian Farrel, Pete Resnick, Meral\n   Shirazipour, and Bert Wijnen\
    \ provided helpful review comments during\n   the IETF last call.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Hannes Tschofenig\n   Austria\n   EMail: Hannes.tschofenig@gmx.net\n\
    \   URI:   http://www.tschofenig.priv.at\n   Henning Schulzrinne\n   Columbia\
    \ University\n   Department of Computer Science\n   450 Computer Science Building\n\
    \   New York, NY  10027\n   United States\n   Phone: +1 212 939 7004\n   EMail:\
    \ hgs@cs.columbia.edu\n   URI:   http://www.cs.columbia.edu\n   Bernard Aboba\
    \ (editor)\n   Microsoft Corporation\n   One Microsoft Way\n   Redmond, WA  98052\n\
    \   United States\n   EMail: bernard_aboba@hotmail.com\n"
