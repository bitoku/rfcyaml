- title: __initial_text__
  contents:
  - '               Virtual Router Redundancy Protocol (VRRP)

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2004).  All Rights Reserved.\n"
- title: Abstract
  contents:
  - "Abstract\n   This memo defines the Virtual Router Redundancy Protocol (VRRP).\n\
    \   VRRP specifies an election protocol that dynamically assigns\n   responsibility\
    \ for a virtual router to one of the VRRP routers on a\n   LAN.  The VRRP router\
    \ controlling the IP address(es) associated with\n   a virtual router is called\
    \ the Master, and forwards packets sent to\n   these IP addresses.  The election\
    \ process provides dynamic fail over\n   in the forwarding responsibility should\
    \ the Master become\n   unavailable.  This allows any of the virtual router IP\
    \ addresses on\n   the LAN to be used as the default first hop router by end-hosts.\
    \  The\n   advantage gained from using VRRP is a higher availability default\n\
    \   path without requiring configuration of dynamic routing or router\n   discovery\
    \ protocols on every end-host.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction. . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   2\n       1.1.  Contributors. . . . . . . . . . . . . . . . . .\
    \ . . . .   3\n       1.2.  Scope . . . . . . . . . . . . . . . . . . . . . .\
    \ . . .   4\n       1.3.  Definitions . . . . . . . . . . . . . . . . . . . .\
    \ . .   4\n   2.  Required Features . . . . . . . . . . . . . . . . . . . . .\
    \ .   5\n       2.1.  IP Address Backup . . . . . . . . . . . . . . . . . . .\
    \   5\n       2.2.  Preferred Path Indication . . . . . . . . . . . . . . .  \
    \ 5\n       2.3.  Minimization of Unnecessary Service Disruptions . . . .   5\n\
    \       2.4.  Efficient Operation over Extended LANs. . . . . . . . .   6\n  \
    \ 3.  VRRP Overview . . . . . . . . . . . . . . . . . . . . . . . .   6\n   4.\
    \  Sample Configurations . . . . . . . . . . . . . . . . . . . .   7\n       4.1.\
    \  Sample Configuration 1. . . . . . . . . . . . . . . . .   7\n       4.2.  Sample\
    \ Configuration 2. . . . . . . . . . . . . . . . .   9\n   5.  Protocol. . . .\
    \ . . . . . . . . . . . . . . . . . . . . . . .  10\n       5.1.  VRRP Packet\
    \ Format. . . . . . . . . . . . . . . . . . .  10\n       5.2.  IP Field Descriptions\
    \ . . . . . . . . . . . . . . . . .  10\n       5.3.  VRRP Field Descriptions\
    \ . . . . . . . . . . . . . . . .  11\n   6.  Protocol State Machine. . . . .\
    \ . . . . . . . . . . . . . . .  13\n       6.1.  Parameters per Virtual Router\
    \ . . . . . . . . . . . . .  13\n       6.2.  Timers. . . . . . . . . . . . .\
    \ . . . . . . . . . . . .  14\n       6.3.  State Transition Diagram. . . . .\
    \ . . . . . . . . . . .  15\n       6.4.  State Descriptions. . . . . . . . .\
    \ . . . . . . . . . .  15\n   7.  Sending and Receiving VRRP Packets. . . . .\
    \ . . . . . . . . .  18\n       7.1.  Receiving VRRP Packets. . . . . . . . .\
    \ . . . . . . . .  18\n       7.2.  Transmitting Packets. . . . . . . . . . .\
    \ . . . . . . .  19\n       7.3.  Virtual MAC Address . . . . . . . . . . . .\
    \ . . . . . .  19\n   8.  Operational Issues. . . . . . . . . . . . . . . . .\
    \ . . . . .  20\n       8.1.  ICMP Redirects. . . . . . . . . . . . . . . . .\
    \ . . . .  20\n       8.2.  Host ARP Requests . . . . . . . . . . . . . . . .\
    \ . . .  20\n       8.3.  Proxy ARP . . . . . . . . . . . . . . . . . . . . .\
    \ . .  20\n       8.4.  Potential Forwarding Loop . . . . . . . . . . . . . .\
    \ .  21\n   9.  Operation over FDDI, Token Ring, and ATM LANE . . . . . . . .\
    \  21\n       9.1.  Operation over FDDI . . . . . . . . . . . . . . . . . .  21\n\
    \       9.2.  Operation over Token Ring . . . . . . . . . . . . . . .  21\n  \
    \     9.3.  Operation over ATM LANE . . . . . . . . . . . . . . . .  23\n   10.\
    \ Security Considerations . . . . . . . . . . . . . . . . . . .  23\n   11. Acknowledgements.\
    \ . . . . . . . . . . . . . . . . . . . . . .  24\n   12. References. . . . .\
    \ . . . . . . . . . . . . . . . . . . . . .  24\n       12.1. Normative References.\
    \ . . . . . . . . . . . . . . . . .  24\n       12.2. Informative References.\
    \ . . . . . . . . . . . . . . . .  25\n   13. Changes from RFC2338. . . . . .\
    \ . . . . . . . . . . . . . . .  25\n   14. Editor's Address. . . . . . . . .\
    \ . . . . . . . . . . . . . .  26\n   15. Full Copyright Statement. . . . . .\
    \ . . . . . . . . . . . . .  27\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   There are a number of methods that an end-host can use to\
    \ determine\n   its first hop router towards a particular IP destination.  These\n\
    \   include running (or snooping) a dynamic routing protocol such as\n   Routing\
    \ Information Protocol [RIP] or OSPF version 2 [OSPF], running\n   an ICMP router\
    \ discovery client [DISC] or using a statically\n   configured default route.\n\
    \   Running a dynamic routing protocol on every end-host may be\n   infeasible\
    \ for a number of reasons, including administrative\n   overhead, processing overhead,\
    \ security issues, or lack of a protocol\n   implementation for some platforms.\
    \  Neighbor or router discovery\n   protocols may require active participation\
    \ by all hosts on a network,\n   leading to large timer values to reduce protocol\
    \ overhead in the face\n   of large numbers of hosts.  This can result in a significant\
    \ delay in\n   the detection of a lost (i.e., dead) neighbor, that may introduce\n\
    \   unacceptably long \"black hole\" periods.\n   The use of a statically configured\
    \ default route is quite popular; it\n   minimizes configuration and processing\
    \ overhead on the end-host and\n   is supported by virtually every IP implementation.\
    \  This mode of\n   operation is likely to persist as dynamic host configuration\n\
    \   protocols [DHCP] are deployed, which typically provide configuration\n   for\
    \ an end-host IP address and default gateway.  However, this\n   creates a single\
    \ point of failure.  Loss of the default router\n   results in a catastrophic\
    \ event, isolating all end-hosts that are\n   unable to detect any alternate path\
    \ that may be available.\n   The Virtual Router Redundancy Protocol (VRRP) is\
    \ designed to\n   eliminate the single point of failure inherent in the static\
    \ default\n   routed environment.  VRRP specifies an election protocol that\n\
    \   dynamically assigns responsibility for a virtual router to one of the\n  \
    \ VRRP routers on a LAN.  The VRRP router controlling the IP\n   address(es) associated\
    \ with a virtual router is called the Master,\n   and forwards packets sent to\
    \ these IP addresses.  The election\n   process provides dynamic fail-over in\
    \ the forwarding responsibility\n   should the Master become unavailable.  Any\
    \ of the virtual router's IP\n   addresses on a LAN can then be used as the default\
    \ first hop router\n   by end-hosts.  The advantage gained from using VRRP is\
    \ a higher\n   availability default path without requiring configuration of dynamic\n\
    \   routing or router discovery protocols on every end-host.\n   VRRP provides\
    \ a function similar to the proprietary protocols \"Hot\n   Standby Router Protocol\
    \ (HSRP)\" [HSRP] and \"IP Standby Protocol\"\n   [IPSTB].\n   The key words \"\
    MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\",\
    \ \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this\n   document\
    \ are to be interpreted as described in [RFC2119].\n"
- title: 1.1.  Contributors
  contents:
  - "1.1.  Contributors\n   The following people, who are the authors of the RFC 2338\
    \ that this\n   document is based on and replaces, contributed to the text in\
    \ this\n   document.  They are P. Higginson, R. Hinden, P. Hunt, S. Knight, A.\n\
    \   Lindem, D. Mitzel, M. Shand, D. Weaver, and D. Whipple.  They are not\n  \
    \ listed as authors of the document due to current RFC-Editor policies.\n"
- title: 1.2.  Scope
  contents:
  - "1.2.  Scope\n   The remainder of this document describes the features, design\
    \ goals,\n   and theory of operation of VRRP.  The message formats, protocol\n\
    \   processing rules and state machine that guarantee convergence to a\n   single\
    \ Virtual Router Master are presented.  Finally, operational\n   issues related\
    \ to MAC address mapping, handling of ARP requests,\n   generation of ICMP redirect\
    \ messages, and security issues are\n   addressed.\n   This protocol is intended\
    \ for use with IPv4 routers only.  A separate\n   specification will be produced\
    \ if it is decided that similar\n   functionality is desirable in an IPv6 environment.\n"
- title: 1.3.  Definitions
  contents:
  - "1.3.  Definitions\n   VRRP Router            A router running the Virtual Router\
    \ Redundancy\n                          Protocol.  It may participate in one or\
    \ more\n                          virtual routers.\n   Virtual Router        \
    \ An abstract object managed by VRRP that acts\n                          as a\
    \ default router for hosts on a shared LAN.\n                          It consists\
    \ of a Virtual Router Identifier and\n                          a set of associated\
    \ IP address(es) across a\n                          common LAN.  A VRRP Router\
    \ may backup one or\n                          more virtual routers.\n   IP Address\
    \ Owner       The VRRP router that has the virtual router's\n                \
    \          IP address(es) as real interface address(es).\n                   \
    \       This is the router that, when up, will respond\n                     \
    \     to packets addressed to one of these IP\n                          addresses\
    \ for ICMP pings, TCP connections,\n                          etc.\n   Primary\
    \ IP Address     An IP address selected from the set of real\n               \
    \           interface addresses.  One possible selection\n                   \
    \       algorithm is to always select the first\n                          address.\
    \  VRRP advertisements are always sent\n                          using the primary\
    \ IP address as the source of\n                          the IP packet.\n   Virtual\
    \ Router Master  The VRRP router that is assuming the\n                      \
    \    responsibility of forwarding packets sent to\n                          the\
    \ IP address(es) associated with the virtual\n                          router,\
    \ and answering ARP requests for these\n                          IP addresses.\
    \  Note that if the IP address\n                          owner is available,\
    \ then it will always become\n                          the Master.\n   Virtual\
    \ Router Backup  The set of VRRP routers available to assume\n               \
    \           forwarding responsibility for a virtual router\n                 \
    \         should the current Master fail.\n"
- title: 2.  Required Features
  contents:
  - "2.  Required Features\n   This section outlines the set of features that were\
    \ considered\n   mandatory and that guided the design of VRRP.\n"
- title: 2.1.  IP Address Backup
  contents:
  - "2.1.  IP Address Backup\n   Backup of IP addresses is the primary function of\
    \ the Virtual Router\n   Redundancy Protocol.  While providing election of a Virtual\
    \ Router\n   Master and the additional functionality described below, the protocol\n\
    \   should strive to:\n   -  Minimize the duration of black holes.\n   -  Minimize\
    \ the steady state bandwidth overhead and processing\n      complexity.\n   -\
    \  Function over a wide variety of multiaccess LAN technologies\n      capable\
    \ of supporting IP traffic.\n   -  Provide for election of multiple virtual routers\
    \ on a network for\n      load balancing.\n   -  Support of multiple logical IP\
    \ subnets on a single LAN segment.\n"
- title: 2.2.  Preferred Path Indication
  contents:
  - "2.2.  Preferred Path Indication\n   A simple model of Master election among a\
    \ set of redundant routers is\n   to treat each router with equal preference and\
    \ claim victory after\n   converging to any router as Master.  However, there\
    \ are likely to be\n   many environments where there is a distinct preference\
    \ (or range of\n   preferences) among the set of redundant routers.  For example,\
    \ this\n   preference may be based upon access link cost or speed, router\n  \
    \ performance or reliability, or other policy considerations.  The\n   protocol\
    \ should allow the expression of this relative path preference\n   in an intuitive\
    \ manner, and guarantee Master convergence to the most\n   preferential router\
    \ currently available.\n"
- title: 2.3.  Minimization of Unnecessary Service Disruptions
  contents:
  - "2.3.  Minimization of Unnecessary Service Disruptions\n   Once Master election\
    \ has been performed then any unnecessary\n   transitions between Master and Backup\
    \ routers can result in a\n   disruption in service.  The protocol should ensure\
    \ after Master\n   election that no state transition is triggered by any Backup\
    \ router\n   of equal or lower preference as long as the Master continues to\n\
    \   function properly.\n   Some environments may find it beneficial to avoid the\
    \ state\n   transition triggered when a router becomes available that is\n   preferred\
    \ over the current Master.  It may be useful to support an\n   override of the\
    \ immediate convergence to the preferred path.\n"
- title: 2.4.  Efficient Operation over Extended LANs
  contents:
  - "2.4.  Efficient Operation over Extended LANs\n   Sending IP packets on a multiaccess\
    \ LAN requires mapping from an IP\n   address to a MAC address.  The use of the\
    \ virtual router MAC address\n   in an extended LAN employing learning bridges\
    \ can have a significant\n   effect on the bandwidth overhead of packets sent\
    \ to the virtual\n   router.  If the virtual router MAC address is never used\
    \ as the\n   source address in a link level frame then the station location is\n\
    \   never learned, resulting in flooding of all packets sent to the\n   virtual\
    \ router.  To improve the efficiency in this environment the\n   protocol should:\
    \ 1) use the virtual router MAC as the source in a\n   packet sent by the Master\
    \ to trigger station learning; 2) trigger a\n   message immediately after transitioning\
    \ to Master to update the\n   station learning; and 3) trigger periodic messages\
    \ from the Master to\n   maintain the station learning cache.\n"
- title: 3.  VRRP Overview
  contents:
  - "3.  VRRP Overview\n   VRRP specifies an election protocol to provide the virtual\
    \ router\n   function described earlier.  All protocol messaging is performed\n\
    \   using IP multicast datagrams, thus the protocol can operate over a\n   variety\
    \ of multiaccess LAN technologies supporting IP multicast.\n   Each VRRP virtual\
    \ router has a single well-known MAC address\n   allocated to it.  This document\
    \ currently only details the mapping to\n   networks using the IEEE 802 48-bit\
    \ MAC address.  The virtual router\n   MAC address is used as the source in all\
    \ periodic VRRP messages sent\n   by the Master router to enable bridge learning\
    \ in an extended LAN.\n   A virtual router is defined by its virtual router identifier\
    \ (VRID)\n   and a set of IP addresses.  A VRRP router may associate a virtual\n\
    \   router with its real addresses on an interface, and may also be\n   configured\
    \ with additional virtual router mappings and priority for\n   virtual routers\
    \ it is willing to backup.  The mapping between VRID\n   and addresses must be\
    \ coordinated among all VRRP routers on a LAN.\n   However, there is no restriction\
    \ against reusing a VRID with a\n   different address mapping on different LANs.\
    \  The scope of each\n   virtual router is restricted to a single LAN.\n   To\
    \ minimize network traffic, only the Master for each virtual router\n   sends\
    \ periodic VRRP Advertisement messages.  A Backup router will not\n   attempt\
    \ to preempt the Master unless it has higher priority.  This\n   eliminates service\
    \ disruption unless a more preferred path becomes\n   available.  It's also possible\
    \ to administratively prohibit all\n   preemption attempts.  The only exception\
    \ is that a VRRP router will\n   always become Master of any virtual router associated\
    \ with addresses\n   it owns.  If the Master becomes unavailable then the highest\
    \ priority\n   Backup will transition to Master after a short delay, providing\
    \ a\n   controlled transition of the virtual router responsibility with\n   minimal\
    \ service interruption.\n   The VRRP protocol design provides rapid transition\
    \ from Backup to\n   Master to minimize service interruption, and incorporates\n\
    \   optimizations that reduce protocol complexity while guaranteeing\n   controlled\
    \ Master transition for typical operational scenarios.  The\n   optimizations\
    \ result in an election protocol with minimal runtime\n   state requirements,\
    \ minimal active protocol states, and a single\n   message type and sender.  The\
    \ typical operational scenarios are\n   defined to be two redundant routers and/or\
    \ distinct path preferences\n   among each router.  A side effect when these assumptions\
    \ are violated\n   (i.e., more than two redundant paths all with equal preference)\
    \ is\n   that duplicate packets may be forwarded for a brief period during\n \
    \  Master election.  However, the typical scenario assumptions are\n   likely\
    \ to cover the vast majority of deployments, loss of the Master\n   router is\
    \ infrequent, and the expected duration in Master election\n   convergence is\
    \ quite small ( << 1 second ).  Thus the VRRP\n   optimizations represent significant\
    \ simplifications in the protocol\n   design while incurring an insignificant\
    \ probability of brief network\n   degradation.\n"
- title: 4.  Sample Configurations
  contents:
  - '4.  Sample Configurations

    '
- title: 4.1.  Sample Configuration 1
  contents:
  - "4.1.  Sample Configuration 1\n   The following figure shows a simple network\
    \ with two VRRP routers\n   implementing one virtual router.  Note that this example\
    \ is provided\n   to help understand the protocol, but is not expected to occur\
    \ in\n   actual practice.\n            +-----------+      +-----------+\n    \
    \        |   Rtr1    |      |   Rtr2    |\n            |(MR VRID=1)|      |(BR\
    \ VRID=1)|\n            |           |      |           |\n    VRID=1  +-----------+\
    \      +-----------+\n    IP A ---------->*            *<--------- IP B\n    \
    \                |            |\n                    |            |\n  ------------------+------------+-----+--------+--------+--------+--\n\
    \                                       ^        ^        ^        ^\n       \
    \                                |        |        |        |\n              \
    \                       (IP A)   (IP A)   (IP A)   (IP A)\n                  \
    \                     |        |        |        |\n                         \
    \           +--+--+  +--+--+  +--+--+  +--+--+\n                             \
    \       |  H1 |  |  H2 |  |  H3 |  |  H4 |\n                                 \
    \   +-----+  +-----+  +--+--+  +--+--+\n     Legend:\n              ---+---+---+--\
    \  =  Ethernet, Token Ring, or FDDI\n                           H  =  Host computer\n\
    \                          MR  =  Master Router\n                          BR\
    \  =  Backup Router\n                           *  =  IP Address\n           \
    \             (IP)  =  default router for hosts\n   Eliminating all mention of\
    \ VRRP (VRID=1) from the figure above leaves\n   it as a typical IP deployment.\
    \  Each router is permanently assigned\n   an IP address on the LAN interface\
    \ (Rtr1 is assigned IP A and Rtr2 is\n   assigned IP B), and each host installs\
    \ a static default route through\n   one of the routers (in this example they\
    \ all use Rtr1's IP A).\n   Moving to the VRRP environment, each router has the\
    \ exact same\n   permanently assigned IP address.  Rtr1 is said to be the IP address\n\
    \   owner of IP A, and Rtr2 is the IP address owner of IP B.  A virtual\n   router\
    \ is then defined by associating a unique identifier (the\n   virtual router ID)\
    \ with the address owned by a router.  Finally, the\n   VRRP protocol manages\
    \ virtual router fail over to a backup router.\n   The example above shows a virtual\
    \ router configured to cover the IP\n   address owned by Rtr1 (VRID=1,IP_Address=A).\
    \  When VRRP is enabled on\n   Rtr1 for VRID=1 it will assert itself as Master,\
    \ with priority=255,\n   since it is the IP address owner for the virtual router\
    \ IP address.\n   When VRRP is enabled on Rtr2 for VRID=1 it will transition to\
    \ Backup,\n   with priority=100, since it is not the IP address owner.  If Rtr1\n\
    \   should fail then the VRRP protocol will transition Rtr2 to Master,\n   temporarily\
    \ taking over forwarding responsibility for IP A to provide\n   uninterrupted\
    \ service to the hosts.\n   Note that in this example IP B is not backed up, it\
    \ is only used by\n   Rtr2 as its interface address.  In order to backup IP B,\
    \ a second\n   virtual router must be configured.  This is shown in the next\n\
    \   section.\n"
- title: 4.2.  Sample Configuration 2
  contents:
  - "4.2.  Sample Configuration 2\n   The following figure shows a configuration with\
    \ two virtual routers\n   with the hosts spitting their traffic between them.\
    \  This example is\n   expected to be very common in actual practice.\n      \
    \      +-----------+      +-----------+\n            |   Rtr1    |      |   Rtr2\
    \    |\n            |(MR VRID=1)|      |(BR VRID=1)|\n            |(BR VRID=2)|\
    \      |(MR VRID=2)|\n    VRID=1  +-----------+      +-----------+  VRID=2\n \
    \   IP A ---------->*            *<---------- IP B\n                    |    \
    \        |\n                    |            |\n  ------------------+------------+-----+--------+--------+--------+--\n\
    \                                       ^        ^        ^        ^\n       \
    \                                |        |        |        |\n              \
    \                       (IP A)   (IP A)   (IP B)   (IP B)\n                  \
    \                     |        |        |        |\n                         \
    \           +--+--+  +--+--+  +--+--+  +--+--+\n                             \
    \       |  H1 |  |  H2 |  |  H3 |  |  H4 |\n                                 \
    \   +-----+  +-----+  +--+--+  +--+--+\n     Legend:\n              ---+---+---+--\
    \  =  Ethernet, Token Ring, or FDDI\n                           H  =  Host computer\n\
    \                          MR  =  Master Router\n                          BR\
    \  =  Backup Router\n                           *  =  IP Address\n           \
    \             (IP)  =  default router for hosts\n   In the example above, half\
    \ of the hosts have configured a static\n   route through Rtr1's IP A and half\
    \ are using Rtr2's IP B.  The\n   configuration of virtual router VRID=1 is exactly\
    \ the same as in the\n   first example (see section 4.1), and a second virtual\
    \ router has been\n   added to cover the IP address owned by Rtr2 (VRID=2, IP_Address=B).\n\
    \   In this case Rtr2 will assert itself as Master for VRID=2 while Rtr1\n   will\
    \ act as a backup.  This scenario demonstrates a deployment\n   providing load\
    \ splitting when both routers are available while\n   providing full redundancy\
    \ for robustness.\n"
- title: 5.  Protocol
  contents:
  - "5.  Protocol\n   The purpose of the VRRP packet is to communicate to all VRRP\
    \ routers\n   the priority and the state of the Master router associated with\
    \ the\n   Virtual Router ID.\n   VRRP packets are sent encapsulated in IP packets.\
    \  They are sent to\n   the IPv4 multicast address assigned to VRRP.\n"
- title: 5.1.  VRRP Packet Format
  contents:
  - "5.1.  VRRP Packet Format\n   This section defines the format of the VRRP packet\
    \ and the relevant\n   fields in the IP header.\n    0                   1   \
    \                2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6\
    \ 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |Version| Type  | Virtual Rtr ID|   Priority    | Count IP Addrs|\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |   Auth Type   |   Adver Int   |          Checksum             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                         IP Address (1)                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                            .                                  |\n   |  \
    \                          .                                  |\n   |        \
    \                    .                                  |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                         IP Address (n)                        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                     Authentication Data (1)                   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                     Authentication Data (2)                   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n"
- title: 5.2.  IP Field Descriptions
  contents:
  - '5.2.  IP Field Descriptions

    '
- title: 5.2.1.  Source Address
  contents:
  - "5.2.1.  Source Address\n   The primary IP address of the interface the packet\
    \ is being sent\n   from.\n"
- title: 5.2.2.  Destination Address
  contents:
  - "5.2.2.  Destination Address\n   The IP multicast address as assigned by the IANA\
    \ for VRRP is:\n      224.0.0.18\n   This is a link local scope multicast address.\
    \  Routers MUST NOT\n   forward a datagram with this destination address regardless\
    \ of its\n   TTL.\n"
- title: 5.2.3.  TTL
  contents:
  - "5.2.3.  TTL\n   The TTL MUST be set to 255.  A VRRP router receiving a packet\
    \ with\n   the TTL not equal to 255 MUST discard the packet.\n"
- title: 5.2.4.  Protocol
  contents:
  - "5.2.4.  Protocol\n   The IP protocol number assigned by the IANA for VRRP is\
    \ 112\n   (decimal).\n"
- title: 5.3.  VRRP Field Descriptions
  contents:
  - '5.3.  VRRP Field Descriptions

    '
- title: 5.3.1.  Version
  contents:
  - "5.3.1.  Version\n   The version field specifies the VRRP protocol version of\
    \ this packet.\n   This document defines version 2.\n"
- title: 5.3.2.  Type
  contents:
  - "5.3.2.  Type\n   The type field specifies the type of this VRRP packet.  The\
    \ only\n   packet type defined in this version of the protocol is:\n      1  \
    \    ADVERTISEMENT\n   A packet with unknown type MUST be discarded.\n"
- title: 5.3.3.  Virtual Rtr ID (VRID)
  contents:
  - "5.3.3.  Virtual Rtr ID (VRID)\n   The Virtual Router Identifier (VRID) field\
    \ identifies the virtual\n   router this packet is reporting status for.  Configurable\
    \ item in the\n   range 1-255 (decimal).  There is no default.\n"
- title: 5.3.4.  Priority
  contents:
  - "5.3.4.  Priority\n   The priority field specifies the sending VRRP router's priority\
    \ for\n   the virtual router.  Higher values equal higher priority.  This field\n\
    \   is an 8 bit unsigned integer field.\n   The priority value for the VRRP router\
    \ that owns the IP address(es)\n   associated with the virtual router MUST be\
    \ 255 (decimal).\n   VRRP routers backing up a virtual router MUST use priority\
    \ values\n   between 1-254 (decimal).  The default priority value for VRRP routers\n\
    \   backing up a virtual router is 100 (decimal).\n   The priority value zero\
    \ (0) has special meaning indicating that the\n   current Master has stopped participating\
    \ in VRRP.  This is used to\n   trigger Backup routers to quickly transition to\
    \ Master without having\n   to wait for the current Master to timeout.\n"
- title: 5.3.5.  Count IP Addrs
  contents:
  - "5.3.5.  Count IP Addrs\n   The number of IP addresses contained in this VRRP\
    \ advertisement.\n"
- title: 5.3.6.  Authentication Type
  contents:
  - "5.3.6.  Authentication Type\n   The authentication type field identifies the\
    \ authentication method\n   being utilized.  Authentication type is unique on\
    \ a Virtual Router\n   basis.  The authentication type field is an 8 bit unsigned\
    \ integer.\n   A packet with unknown authentication type or that does not match\
    \ the\n   locally configured authentication method MUST be discarded.\n   Note:\
    \  Earlier version of the VRRP specification had several defined\n   authentication\
    \ types [RFC2338].  These were removed in this\n   specification because operational\
    \ experience showed that they did not\n   provide any real security and would\
    \ only cause multiple masters to be\n   created.\n   The authentication methods\
    \ currently defined are:\n      0 - No Authentication\n      1 - Reserved\n  \
    \    2 - Reserved\n"
- title: 5.3.6.1.  Authentication Type 0 - No Authentication
  contents:
  - "5.3.6.1.  Authentication Type 0 - No Authentication\n   The use of this authentication\
    \ type means that VRRP protocol\n   exchanges are not authenticated.  The contents\
    \ of the Authentication\n   Data field should be set to zero on transmission and\
    \ ignored on\n   reception.\n"
- title: 5.3.6.2.  Authentication Type 1 - Reserved
  contents:
  - "5.3.6.2.  Authentication Type 1 - Reserved\n   This authentication type is reserved\
    \ to maintain backwards\n   compatibility with RFC 2338.\n"
- title: 5.3.6.3.  Authentication Type 2 - Reserved
  contents:
  - "5.3.6.3.  Authentication Type 2 - Reserved\n   This authentication type is reserved\
    \ to maintain backwards\n   compatibility with RFC 2338.\n"
- title: 5.3.7.  Advertisement Interval (Adver Int)
  contents:
  - "5.3.7.  Advertisement Interval (Adver Int)\n   The Advertisement interval indicates\
    \ the time interval (in seconds)\n   between ADVERTISEMENTS.  The default is 1\
    \ second.  This field is used\n   for troubleshooting misconfigured routers.\n"
- title: 5.3.8.  Checksum
  contents:
  - "5.3.8.  Checksum\n   The checksum field is used to detect data corruption in\
    \ the VRRP\n   message.\n   The checksum is the 16-bit one's complement of the\
    \ one's complement\n   sum of the entire VRRP message starting with the version\
    \ field.  For\n   computing the checksum, the checksum field is set to zero. \
    \ See RFC\n   1071 for more detail [CKSM].\n"
- title: 5.3.9.  IP Address(es)
  contents:
  - "5.3.9.  IP Address(es)\n   One or more IP addresses that are associated with\
    \ the virtual router.\n   The number of addresses included is specified in the\
    \ \"Count IP Addrs\"\n   field.  These fields are used for troubleshooting misconfigured\n\
    \   routers.\n"
- title: 5.3.10.  Authentication Data
  contents:
  - "5.3.10.  Authentication Data\n   The authentication string is currently only\
    \ used to maintain\n   backwards compatibility with RFC 2338.  It SHOULD be set\
    \ to zero on\n   transmission and ignored on reception.\n"
- title: 6.  Protocol State Machine
  contents:
  - '6.  Protocol State Machine

    '
- title: 6.1.  Parameters per Virtual Router
  contents:
  - "6.1.  Parameters per Virtual Router\n   VRID                    Virtual Router\
    \ Identifier.  Configurable item\n                           in the range 1-255\
    \ (decimal).  There is no\n                           default.\n   Priority  \
    \              Priority value to be used by this VRRP router\n               \
    \            in Master election for this virtual router.\n                   \
    \        The value of 255 (decimal) is reserved for\n                        \
    \   the router that owns the IP addresses\n                           associated\
    \ with the virtual router.  The\n                           value of 0 (zero)\
    \ is reserved for Master\n                           router to indicate it is\
    \ releasing\n                           responsibility for the virtual router.\
    \  The\n                           range 1-254 (decimal) is available for VRRP\n\
    \                           routers backing up the virtual router.  The\n    \
    \                       default value is 100 (decimal).\n   IP_Addresses     \
    \       One or more IP addresses associated with this\n                      \
    \     virtual router.  Configured item.  No\n                           default.\n\
    \   Advertisement_Interval  Time interval between ADVERTISEMENTS\n           \
    \                (seconds).  Default is 1 second.\n   Skew_Time              \
    \ Time to skew Master_Down_Interval in seconds.\n                           Calculated\
    \ as:\n                             ( (256 - Priority) / 256 )\n   Master_Down_Interval\
    \    Time interval for Backup to declare Master\n                           down\
    \ (seconds).  Calculated as:\n                             (3 * Advertisement_Interval)\
    \ + Skew_time\n   Preempt_Mode            Controls whether a higher priority Backup\n\
    \                           router preempts a lower priority Master.\n       \
    \                    Values are True to allow preemption and False\n         \
    \                  to prohibit preemption.  Default is True.\n               \
    \            Note: Exception is that the router that owns\n                  \
    \         the IP address(es) associated with the\n                           virtual\
    \ router always preempts independent of\n                           the setting\
    \ of this flag.\n   Authentication_Type     Type of authentication being used.\
    \  Values\n                           are defined in section 5.3.6.\n   Authentication_Data\
    \     Authentication data specific to the\n                           Authentication_Type\
    \ being used.\n"
- title: 6.2.  Timers
  contents:
  - "6.2.  Timers\n   Master_Down_Timer       Timer that fires when ADVERTISEMENT\
    \ has not\n                           been heard for Master_Down_Interval.\n \
    \  Adver_Timer             Timer that fires to trigger sending of\n          \
    \                 ADVERTISEMENT based on\n                           Advertisement_Interval.\n"
- title: 6.3.  State Transition Diagram
  contents:
  - "6.3.  State Transition Diagram\n                      +---------------+\n   \
    \        +--------->|               |<-------------+\n           |          |\
    \  Initialize   |              |\n           |   +------|               |----------+\
    \   |\n           |   |      +---------------+          |   |\n           |  \
    \ |                                 |   |\n           |   V                  \
    \               V   |\n   +---------------+                       +---------------+\n\
    \   |               |---------------------->|               |\n   |    Master\
    \     |                       |    Backup     |\n   |               |<----------------------|\
    \               |\n   +---------------+                       +---------------+\n"
- title: 6.4.  State Descriptions
  contents:
  - "6.4.  State Descriptions\n   In the state descriptions below, the state names\
    \ are identified by\n   {state-name}, and the packets are identified by all upper\
    \ case\n   characters.\n   A VRRP router implements an instance of the state machine\
    \ for each\n   virtual router election it is participating in.\n"
- title: 6.4.1.  Initialize
  contents:
  - "6.4.1.  Initialize\n   The purpose of this state is to wait for a Startup event.\
    \  If a\n   Startup event is received, then:\n   -  If the Priority = 255 (i.e.,\
    \ the router owns the IP address(es)\n      associated with the virtual router)\n\
    \      o  Send an ADVERTISEMENT\n      o  Broadcast a gratuitous ARP request containing\
    \ the virtual\n         router MAC address for each IP address associated with\
    \ the\n         virtual router.\n      o  Set the Adver_Timer to Advertisement_Interval\n\
    \      o  Transition to the {Master} state\n      else\n      o  Set the Master_Down_Timer\
    \ to Master_Down_Interval\n      o  Transition to the {Backup} state\n      endif\n"
- title: 6.4.2.  Backup
  contents:
  - "6.4.2.  Backup\n   The purpose of the {Backup} state is to monitor the availability\
    \ and\n   state of the Master Router.\n   While in this state, a VRRP router MUST\
    \ do the following:\n   -  MUST NOT respond to ARP requests for the IP address(s)\
    \ associated\n      with the virtual router.\n   -  MUST discard packets with\
    \ a destination link layer MAC address\n      equal to the virtual router MAC\
    \ address.\n   -  MUST NOT accept packets addressed to the IP address(es) associated\n\
    \      with the virtual router.\n   -  If a Shutdown event is received, then:\n\
    \      o  Cancel the Master_Down_Timer\n      o  Transition to the {Initialize}\
    \ state\n         endif\n   -  If the Master_Down_Timer fires, then:\n      o\
    \  Send an ADVERTISEMENT\n      o  Broadcast a gratuitous ARP request containing\
    \ the virtual\n         router MAC address for each IP address associated with\
    \ the\n         virtual router\n      o  Set the Adver_Timer to Advertisement_Interval\n\
    \      o  Transition to the {Master} state\n         endif\n   -  If an ADVERTISEMENT\
    \ is received, then:\n      If the Priority in the ADVERTISEMENT is Zero, then:\n\
    \      o  Set the Master_Down_Timer to Skew_Time\n         else:\n           \
    \ If Preempt_Mode is False, or If the Priority in the\n            ADVERTISEMENT\
    \ is greater than or equal to the local\n            Priority, then:\n       \
    \      o Reset the Master_Down_Timer to Master_Down_Interval\n            else:\n\
    \             o Discard the ADVERTISEMENT\n            endif\n         endif\n\
    \      endif\n"
- title: 6.4.3.  Master
  contents:
  - "6.4.3.  Master\n   While in the {Master} state the router functions as the forwarding\n\
    \   router for the IP address(es) associated with the virtual router.\n   While\
    \ in this state, a VRRP router MUST do the following:\n   -  MUST respond to ARP\
    \ requests for the IP address(es) associated\n      with the virtual router.\n\
    \   -  MUST forward packets with a destination link layer MAC address\n      equal\
    \ to the virtual router MAC address.\n   -  MUST NOT accept packets addressed\
    \ to the IP address(es) associated\n      with the virtual router if it is not\
    \ the IP address owner.\n   -  MUST accept packets addressed to the IP address(es)\
    \ associated\n      with the virtual router if it is the IP address owner.\n \
    \  -  If a Shutdown event is received, then:\n      o  Cancel the Adver_Timer\n\
    \      o  Send an ADVERTISEMENT with Priority = 0\n      o  Transition to the\
    \ {Initialize} state\n         endif\n      -  If the Adver_Timer fires, then:\n\
    \      o  Send an ADVERTISEMENT o  Reset the Adver_Timer to\n         Advertisement_Interval\n\
    \         endif\n      -  If an ADVERTISEMENT is received, then:\n         If\
    \ the Priority in the ADVERTISEMENT is Zero, then:\n      o  Send an ADVERTISEMENT\n\
    \      o  Reset the Adver_Timer to Advertisement_Interval\n         else:\n  \
    \          If the Priority in the ADVERTISEMENT is greater than the\n        \
    \    local Priority,\n            or\n            If the Priority in the ADVERTISEMENT\
    \ is equal to the local\n            Priority and the primary IP Address of the\
    \ sender is greater\n            than the local primary IP Address, then:\n  \
    \           o Cancel Adver_Timer\n             o Set Master_Down_Timer to Master_Down_Interval\n\
    \             o Transition to the {Backup} state\n            else:\n        \
    \     o Discard ADVERTISEMENT\n            endif\n         endif\n      endif\n"
- title: 7.  Sending and Receiving VRRP Packets
  contents:
  - '7.  Sending and Receiving VRRP Packets

    '
- title: 7.1.  Receiving VRRP Packets
  contents:
  - "7.1.  Receiving VRRP Packets\n   Performed the following functions when a VRRP\
    \ packet is received:\n   -  MUST verify that the IP TTL is 255.\n   -  MUST verify\
    \ the VRRP version is 2.\n   -  MUST verify that the received packet contains\
    \ the complete VRRP\n      packet (including fixed fields, IP Address(es), and\
    \ Authentication\n      Data).\n   -  MUST verify the VRRP checksum.\n   -  MUST\
    \ verify that the VRID is configured on the receiving interface\n      and the\
    \ local router is not the IP Address owner (Priority equals\n      255 (decimal)).\n\
    \   -  MUST verify that the Auth Type matches the locally configured\n      authentication\
    \ method for the virtual router and perform that\n      authentication method.\n\
    \   If any one of the above checks fails, the receiver MUST discard the\n   packet,\
    \ SHOULD log the event and MAY indicate via network management\n   that an error\
    \ occurred.\n   -  MAY verify that \"Count IP Addrs\" and the list of IP Address\n\
    \      matches the IP_Addresses configured for the VRID\n   If the above check\
    \ fails, the receiver SHOULD log the event and MAY\n   indicate via network management\
    \ that a misconfiguration was detected.\n   If the packet was not generated by\
    \ the address owner (Priority does\n   not equal 255 (decimal)), the receiver\
    \ MUST drop the packet,\n   otherwise continue processing.\n   -  MUST verify\
    \ that the Adver Interval in the packet is the same as\n      the locally configured\
    \ for this virtual router\n   If the above check fails, the receiver MUST discard\
    \ the packet,\n   SHOULD log the event and MAY indicate via network management\
    \ that a\n   misconfiguration was detected.\n"
- title: 7.2.  Transmitting VRRP Packets
  contents:
  - "7.2.  Transmitting VRRP Packets\n   The following operations MUST be performed\
    \ when transmitting a VRRP\n   packet.\n   - Fill in the VRRP packet fields with\
    \ the appropriate virtual router\n      configuration state\n   -  Compute the\
    \ VRRP checksum\n   -  Set the source MAC address to Virtual Router MAC Address\n\
    \   -  Set the source IP address to interface primary IP address\n   -  Set the\
    \ IP protocol to VRRP\n   -  Send the VRRP packet to the VRRP IP multicast group\n\
    \   Note: VRRP packets are transmitted with the virtual router MAC\n   address\
    \ as the source MAC address to ensure that learning bridges\n   correctly determine\
    \ the LAN segment the virtual router is attached\n   to.\n"
- title: 7.3.  Virtual Router MAC Address
  contents:
  - "7.3.  Virtual Router MAC Address\n   The virtual router MAC address associated\
    \ with a virtual router is an\n   IEEE 802 MAC Address in the following format:\n\
    \      00-00-5E-00-01-{VRID} (in hex in internet standard bit-order)\n   The first\
    \ three octets are derived from the IANA's OUI.  The next two\n   octets (00-01)\
    \ indicate the address block assigned to the VRRP\n   protocol.  {VRID} is the\
    \ VRRP Virtual Router Identifier.  This\n   mapping provides for up to 255 VRRP\
    \ routers on a network.\n"
- title: 8.  Operational Issues
  contents:
  - '8.  Operational Issues

    '
- title: 8.1.  ICMP Redirects
  contents:
  - "8.1.  ICMP Redirects\n   ICMP Redirects may be used normally when VRRP is running\
    \ between a\n   group of routers.  This allows VRRP to be used in environments\
    \ where\n   the topology is not symmetric.\n   The IP source address of an ICMP\
    \ redirect should be the address the\n   end host used when making its next hop\
    \ routing decision.  If a VRRP\n   router is acting as Master for virtual router(s)\
    \ containing addresses\n   it does not own, then it must determine which virtual\
    \ router the\n   packet was sent to when selecting the redirect source address.\
    \  One\n   method to deduce the virtual router used is to examine the\n   destination\
    \ MAC address in the packet that triggered the redirect.\n   It may be useful\
    \ to disable Redirects for specific cases where VRRP\n   is being used to load\
    \ share traffic between a number of routers in a\n   symmetric topology.\n"
- title: 8.2.  Host ARP Requests
  contents:
  - "8.2.  Host ARP Requests\n   When a host sends an ARP request for one of the virtual\
    \ router IP\n   addresses, the Master virtual router MUST respond to the ARP request\n\
    \   with the virtual MAC address for the virtual router.  The Master\n   virtual\
    \ router MUST NOT respond with its physical MAC address.  This\n   allows the\
    \ client to always use the same MAC address regardless of\n   the current Master\
    \ router.\n   When a VRRP router restarts or boots, it SHOULD not send any ARP\n\
    \   messages with its physical MAC address for the IP address it owns, it\n  \
    \ should only send ARP messages that include Virtual MAC addresses.\n   This may\
    \ entail:\n   -  When configuring an interface, VRRP routers should broadcast\
    \ a\n      gratuitous ARP request containing the virtual router MAC address\n\
    \      for each IP address on that interface.\n   -  At system boot, when initializing\
    \ interfaces for VRRP operation;\n      delay gratuitous ARP requests and ARP\
    \ responses until both the IP\n      address and the virtual router MAC address\
    \ are configured.\n"
- title: 8.3.  Proxy ARP
  contents:
  - "8.3.  Proxy ARP\n   If Proxy ARP is to be used on a VRRP router, then the VRRP\
    \ router\n   must advertise the Virtual Router MAC address in the Proxy ARP\n\
    \   message.  Doing otherwise could cause hosts to learn the real MAC\n   address\
    \ of the VRRP router.\n"
- title: 8.4.  Potential Forwarding Loop
  contents:
  - "8.4.  Potential Forwarding Loop\n   A VRRP router SHOULD not forward packets\
    \ addressed to the IP\n   Address(es) it becomes Master for if it is not the owner.\
    \  Forwarding\n   these packets would result in unnecessary traffic.  Also in\
    \ the case\n   of LANs that receive packets they transmit (e.g., token ring) this\n\
    \   can result in a forwarding loop that is only terminated when the IP\n   TTL\
    \ expires.\n   One such mechanism for VRRP routers is to add/delete a reject host\n\
    \   route for each adopted IP address when transitioning to/from MASTER\n   state.\n"
- title: 9.  Operation over FDDI, Token Ring, and ATM LANE
  contents:
  - '9.  Operation over FDDI, Token Ring, and ATM LANE

    '
- title: 9.1.  Operation over FDDI
  contents:
  - "9.1.  Operation over FDDI\n   FDDI interfaces remove from the FDDI ring frames\
    \ that have a source\n   MAC address matching the device's hardware address. \
    \ Under some\n   conditions, such as router isolations, ring failures, protocol\n\
    \   transitions, etc., VRRP may cause there to be more than one Master\n   router.\
    \  If a Master router installs the virtual router MAC address\n   as the hardware\
    \ address on a FDDI device, then other Masters'\n   ADVERTISEMENTS will be removed\
    \ from the ring during the Master\n   convergence, and convergence will fail.\n\
    \   To avoid this an implementation SHOULD configure the virtual router\n   MAC\
    \ address by adding a unicast MAC filter in the FDDI device, rather\n   than changing\
    \ its hardware MAC address.  This will prevent a Master\n   router from removing\
    \ any ADVERTISEMENTS it did not originate.\n"
- title: 9.2.  Operation over Token Ring
  contents:
  - "9.2.  Operation over Token Ring\n   Token ring has several characteristics that\
    \ make running VRRP\n   difficult.  These include:\n   -  In order to switch to\
    \ a new master located on a different bridge\n      token ring segment from the\
    \ previous master when using source\n      route bridges, a mechanism is required\
    \ to update cached source\n      route information.\n   -  No general multicast\
    \ mechanism supported across old and new token\n      ring adapter implementations.\
    \  While many newer token ring\n      adapters support group addresses, token\
    \ ring functional address\n      support is the only generally available multicast\
    \ mechanism.  Due\n      to the limited number of token ring functional addresses\
    \ these may\n      collide with other usage of the same token ring functional\n\
    \      addresses.\n   Due to these difficulties, the preferred mode of operation\
    \ over token\n   ring will be to use a token ring functional address for the VRID\n\
    \   virtual MAC address.  Token ring functional addresses have the two\n   high\
    \ order bits in the first MAC address octet set to B'1'.  They\n   range from\
    \ 03-00-00-00-00-80 to 03-00-02-00-00-00 (canonical format).\n   However, unlike\
    \ multicast addresses, there is only one unique\n   functional address per bit\
    \ position.  The functional addresses\n   03-00-00-10-00-00 through 03-00-02-00-00-00\
    \ are reserved by the Token\n   Ring Architecture [TKARCH] for user-defined applications.\
    \  However,\n   since there are only 12 user-defined token ring functional addresses,\n\
    \   there may be other non-IP protocols using the same functional\n   address.\
    \  Since the Novell IPX [IPX] protocol uses the\n   03-00-00-10-00-00 functional\
    \ address, operation of VRRP over token\n   ring will avoid use of this functional\
    \ address.  In general, token\n   ring VRRP users will be responsible for resolution\
    \ of other user-\n   defined token ring functional address conflicts.\n   VRIDs\
    \ are mapped directly to token ring functional addresses.  In\n   order to decrease\
    \ the likelihood of functional address conflicts,\n   allocation will begin with\
    \ the largest functional address.  Most\n   non-IP protocols use the first or\
    \ first couple user-defined\n   functional addresses and it is expected that VRRP\
    \ users will choose\n   VRIDs sequentially starting with 1.\n      VRID      Token\
    \ Ring Functional Address\n      ----      -----------------------------\n   \
    \      1             03-00-02-00-00-00\n         2             03-00-04-00-00-00\n\
    \         3             03-00-08-00-00-00\n         4             03-00-10-00-00-00\n\
    \         5             03-00-20-00-00-00\n         6             03-00-40-00-00-00\n\
    \         7             03-00-80-00-00-00\n         8             03-00-00-01-00-00\n\
    \         9             03-00-00-02-00-00\n        10             03-00-00-04-00-00\n\
    \        11             03-00-00-08-00-00\n   Or more succinctly, octets 3 and\
    \ 4 of the functional address are\n   equal to (0x4000 >> (VRID - 1)) in non-canonical\
    \ format.\n   Since a functional address cannot be used as a MAC level source\n\
    \   address, the real MAC address is used as the MAC source address in\n   VRRP\
    \ advertisements.  This is not a problem for bridges since packets\n   addressed\
    \ to functional addresses will be sent on the spanning-tree\n   explorer path\
    \ [802.1D].\n   The functional address mode of operation MUST be implemented by\n\
    \   routers supporting VRRP on token ring.\n   Additionally, routers MAY support\
    \ unicast mode of operation to take\n   advantage of newer token ring adapter\
    \ implementations that support\n   non-promiscuous reception for multiple unicast\
    \ MAC addresses and to\n   avoid both the multicast traffic and usage conflicts\
    \ associated with\n   the use of token ring functional addresses.  Unicast mode\
    \ uses the\n   same mapping of VRIDs to virtual MAC addresses as Ethernet.  However,\n\
    \   one important difference exists.  ARP request/reply packets contain\n   the\
    \ virtual MAC address as the source MAC address.  The reason for\n   this is that\
    \ some token ring driver implementations keep a cache of\n   MAC address/source\
    \ routing information independent of the ARP cache.\n   Hence, these implementations\
    \ need to receive a packet with the\n   virtual MAC address as the source address\
    \ in order to transmit to\n   that MAC address in a source-route bridged network.\n\
    \   Unicast mode on token ring has one limitation that should be\n   considered.\
    \  If there are VRID routers on different source-route\n   bridge segments and\
    \ there are host implementations that keep their\n   source-route information\
    \ in the ARP cache and do not listen to\n   gratuitous ARPs, these hosts will\
    \ not update their ARP source-route\n   information correctly when a switch-over\
    \ occurs.  The only possible\n   solution is to put all routers with the same\
    \ VRID on the same\n   source-bridge segment and use techniques to prevent that\
    \ bridge\n   segment from being a single point of failure.  These techniques are\n\
    \   beyond the scope this document.\n   For both the multicast and unicast mode\
    \ of operation, VRRP\n   advertisements sent to 224.0.0.18 should be encapsulated\
    \ as described\n   in [RFC1469].\n"
- title: 9.3.  Operation over ATM LANE
  contents:
  - "9.3.  Operation over ATM LANE\n   Operation of VRRP over ATM LANE on routers\
    \ with ATM LANE interfaces\n   and/or routers behind proxy LEC's are beyond the\
    \ scope of this\n   document.\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   VRRP does not currently include any type of\
    \ authentication.  Earlier\n   versions of the VRRP specification included several\
    \ types of\n   authentication ranging from none to strong.  Operational experience\n\
    \   and further analysis determined that these did not provide any real\n   measure\
    \ of security.  Due to the nature of the VRRP protocol, even if\n   VRRP messages\
    \ are cryptographically protected, it does not prevent\n   hostile routers from\
    \ behaving as if they are a VRRP master, creating\n   multiple masters.  Authentication\
    \ of VRRP messages could have\n   prevented a hostile router from causing all\
    \ properly functioning\n   routers from going into backup state.  However, having\
    \ multiple\n   masters can cause as much disruption as no routers, which\n   authentication\
    \ cannot prevent.  Also, even if a hostile router could\n   not disrupt VRRP,\
    \ it can disrupt ARP and create the same effect as\n   having all routers go into\
    \ backup.\n   It should be noted that these attacks are not worse and are a subset\n\
    \   of the attacks that any node attached to a LAN can do independently\n   of\
    \ VRRP.  The kind of attacks a malicious node on a LAN can do\n   include promiscuously\
    \ receiving packets for any routers MAC address,\n   sending packets with the\
    \ routers MAC address as the source MAC\n   addresses in the L2 header to tell\
    \ the L2 switches to send packets\n   addressed to the router to the malicious\
    \ node instead of the router,\n   send redirects to tell the hosts to send their\
    \ traffic somewhere\n   else, send unsolicited ARP replies, answer ARP requests,\
    \ etc., etc.\n   All of this can be done independently of implementing VRRP. \
    \ VRRP\n   does not add to these vulnerabilities.\n   Independent of any authentication\
    \ type VRRP includes a mechanism\n   (setting TTL=255, checking on receipt) that\
    \ protects against VRRP\n   packets being injected from another remote network.\
    \  This limits most\n   vulnerabilities to local attacks.\n   VRRP does not provide\
    \ any confidentiality.  Confidentiality is not\n   necessary for the correct operation\
    \ of VRRP and there is no\n   information in the VRRP messages that must be kept\
    \ secret from other\n   nodes on the LAN.\n"
- title: 11.  Acknowledgements
  contents:
  - "11.  Acknowledgements\n   The authors would like to thank Glen Zorn, and Michael\
    \ Lane, Clark\n   Bremer, Hal Peterson, Tony Li, Barbara Denny, Joel Halpern,\
    \ Steve\n   Bellovin, Thomas Narten, Rob Montgomery, Rob Coltun, Radia Perlman,\n\
    \   Russ Housley, Harald Alvestrand, Steve Bellovin, Ned Freed, Ted\n   Hardie,\
    \ Russ Housley, Bert Wijnen, Bill Fenner, and Alex Zinin for\n   their comments\
    \ and suggestions.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [802.1D]  International Standard ISO/IEC 10038:\
    \ 1993, ANSI/IEEE Std\n             802.1D, 1993 edition.\n   [CKSM]    Braden,\
    \ R., Borman, D. and C. Partridge, \"Computing the\n             Internet checksum\"\
    , RFC 1071, September 1988.\n   [HSRP]    Li, T., Cole, B., Morton, P. and D.\
    \ Li, \"Cisco Hot Standby\n             Router Protocol (HSRP)\", RFC 2281, March\
    \ 1998.\n   [IPSTB]   Higginson, P. and M. Shand, \"Development of Router Clusters\n\
    \             to Provide Fast Failover in IP Networks\", Digital Technical\n \
    \            Journal, Volume 9 Number 3, Winter 1997.\n   [IPX]     Novell Incorporated.,\
    \ \"IPX Router Specification\", Version\n             1.10, October 1992.\n  \
    \ [RFC1469] Pusateri, T., \"IP Multicast over Token Ring Local Area\n        \
    \     Networks\", RFC 1469, June 1993.\n   [RFC2119] Bradner, S., \"Key words\
    \ for use in RFCs to Indicate\n             Requirement Levels\", BCP 14, RFC\
    \ 2119, March 1997.\n   [RFC2338] Knight, S., Weaver, D., Whipple, D., Hinden,\
    \ R., Mitzel,\n             D., Hunt, P., Higginson, P., Shand, M. and A. Lindem,\n\
    \             \"Virtual Router Redundancy Protocol\", RFC 2338, April 1998.\n\
    \   [TKARCH]  IBM Token-Ring Network, Architecture Reference, Publication\n  \
    \           SC30-3374-02, Third Edition, (September, 1989).\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [DISC]    Deering, S., Ed., \"ICMP Router Discovery\
    \ Messages\", RFC\n             1256, September 1991.\n   [DHCP]    Droms, R.,\
    \ \"Dynamic Host Configuration Protocol\", RFC 2131,\n             March 1997.\n\
    \   [OSPF]    Moy, J., \"OSPF version 2\", STD 54, RFC 2328, April 1998.\n   [RIP]\
    \     Malkin, G., \"RIP Version 2\", STD 56, RFC 2453, November\n            \
    \ 1998.\n"
- title: 13.  Changes from RFC 2338
  contents:
  - "13.  Changes from RFC 2338\n   -  Moved authors of RFC 2338 to new Contributers\
    \ section to comply\n      with RFC editor policy and listed R. Hinden as Editor.\n\
    \   -  Removed authentication methods from VRRP.  Changes included:\n      o \
    \ Removed the values for password and IPSEC based authentication.\n         The\
    \ fields and values are retained to keep backwards\n         compatibility with\
    \ RFC 2338.\n      o  Removed section on extensible security\n      o  Updated\
    \ security consideration section to remove discussion of\n         different authentication\
    \ methods and added new text explaining\n         motivation for change and describe\
    \ vulnerabilities.\n   -  Revised the section 4 examples text with a clearer description\
    \ of\n      mapping of IP address owner, priorities, etc.\n   -  Clarify the section\
    \ 7.1 text describing address list validation.\n   -  Corrected text in Preempt_Mode\
    \ definition.\n   -  Changed authentication to be per Virtual Router instead of\
    \ per\n      Interface.\n   -  Added new subsection (9.3) stating that VRRP over\
    \ ATM LANE is\n      beyond the scope of this document.\n   -  Clarified text\
    \ describing received packet length check.\n   -  Clarified text describing received\
    \ authentication check.\n   -  Clarified text describing VRID verification check.\n\
    \   -  Added new subsection (8.4) describing need to not forward packets\n   \
    \   for adopted IP addresses.\n   -  Added clarification to the security considerations\
    \ section.\n   -  Added reference for computing the internet checksum.\n   - \
    \ Updated references and author information.\n   -  Various small editorial changes.\n"
- title: 14.  Editor's Address
  contents:
  - "14.  Editor's Address\n   Robert Hinden\n   Nokia\n   313 Fairchild Drive\n \
    \  Mountain View, CA 94043\n   US\n   Phone: +1 650 625-2004\n   EMail: bob.hinden@nokia.com\n"
- title: 15.  Full Copyright Statement
  contents:
  - "15.  Full Copyright Statement\n   Copyright (C) The Internet Society (2004).\
    \  This document is subject\n   to the rights, licenses and restrictions contained\
    \ in BCP 78, and\n   except as set forth therein, the authors retain all their\
    \ rights.\n   This document and the information contained herein are provided\
    \ on an\n   \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE\n   REPRESENTS\
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE\n   INTERNET ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR\n   IMPLIED, INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed\n   to pertain to the implementation or use of the technology\n   described\
    \ in this document or the extent to which any license\n   under such rights might\
    \ or might not be available; nor does it\n   represent that it has made any independent\
    \ effort to identify any\n   such rights.  Information on the procedures with\
    \ respect to\n   rights in RFC documents can be found in BCP 78 and BCP 79.\n\
    \   Copies of IPR disclosures made to the IETF Secretariat and any\n   assurances\
    \ of licenses to be made available, or the result of an\n   attempt made to obtain\
    \ a general license or permission for the use\n   of such proprietary rights by\
    \ implementers or users of this\n   specification can be obtained from the IETF\
    \ on-line IPR repository\n   at http://www.ietf.org/ipr.\n   The IETF invites\
    \ any interested party to bring to its attention\n   any copyrights, patents or\
    \ patent applications, or other\n   proprietary rights that may cover technology\
    \ that may be required\n   to implement this standard.  Please address the information\
    \ to the\n   IETF at ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
