- title: __initial_text__
  contents:
  - '                Point-to-Point Tunneling Protocol (PPTP)

    '
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (1999).  All Rights Reserved.\n"
- title: IESG Note
  contents:
  - "IESG Note\n   The PPTP protocol was developed by a vendor consortium. The\n \
    \  documentation of PPTP is provided as information to the Internet\n   community.\
    \ The PPP WG is currently defining a Standards Track\n   protocol (L2TP) for tunneling\
    \ PPP across packet-switched networks.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies a protocol which allows the Point to Point\n\
    \   Protocol (PPP) to be tunneled through an IP network.  PPTP does not\n   specify\
    \ any changes to the PPP protocol but rather describes a new\n   vehicle for carrying\
    \ PPP.  A client-server architecture is defined in\n   order to decouple functions\
    \ which exist in current Network Access\n   Servers (NAS) and support Virtual\
    \ Private Networks (VPNs).  The PPTP\n   Network Server (PNS) is envisioned to\
    \ run on a general purpose\n   operating system while the client, referred to\
    \ as a PPTP Access\n   Concentrator (PAC) operates on a dial access platform.\
    \  PPTP\n   specifies a call-control and management protocol which allows the\n\
    \   server to control access for dial-in circuit switched calls\n   originating\
    \ from a PSTN or ISDN or to initiate outbound circuit-\n   switched connections.\
    \  PPTP uses an enhanced GRE (Generic Routing\n   Encapsulation) mechanism to\
    \ provide a flow- and congestion-controlled\n   encapsulated datagram service\
    \ for carrying PPP packets.\n"
- title: Specification of Requirements
  contents:
  - "Specification of Requirements\n   In this document, the key words \"MAY\", \"\
    MUST, \"MUST NOT\", \"optional\",\n   \"recommended\", \"SHOULD\", and \"SHOULD\
    \ NOT\" are to be interpreted as\n   described in [12].\n   The words \"silently\
    \ discard\", when used in reference to the behavior\n   of an implementation upon\
    \ receipt of an incoming packet, are to be\n   interpreted as follows: the implementation\
    \ discards the datagram\n   without further processing, and without indicating\
    \ an error to the\n   sender.  The implementation SHOULD provide the capability\
    \ of logging\n   the error, including the contents of the discarded datagram,\
    \ and\n   SHOULD record the event in a statistics counter.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   3\n   1.1.  Protocol Goals and Assumptions . . . . . . . . . . .\
    \ . . .   4\n   1.2.  Terminology  . . . . . . . . . . . . . . . . . . . . . .\
    \ .   5\n   1.3.  Protocol Overview  . . . . . . . . . . . . . . . . . . . . \
    \  6\n   1.3.1.  Control Connection Overview  . . . . . . . . . . . . . .   7\n\
    \   1.3.2.  Tunnel Protocol Overview . . . . . . . . . . . . . . . .   7\n   1.4.\
    \  Message Format and Protocol Extensibility  . . . . . . . .   8\n   2.  Control\
    \ Connection Protocol Specification  . . . . . . . . .  10\n   2.1.  Start-Control-Connection-Request\
    \ . . . . . . . . . . . . .  10\n   2.2.  Start-Control-Connection-Reply . . .\
    \ . . . . . . . . . . .  12\n   2.3.  Stop-Control-Connection-Request  . . . .\
    \ . . . . . . . . .  15\n   2.4.  Stop-Control-Connection-Reply  . . . . . . .\
    \ . . . . . . .  16\n   2.5.  Echo-Request . . . . . . . . . . . . . . . . . .\
    \ . . . . .  17\n   2.6.  Echo-Reply . . . . . . . . . . . . . . . . . . . . .\
    \ . . .  18\n   2.7.  Outgoing-Call-Request  . . . . . . . . . . . . . . . . .\
    \ .  19\n   2.8.  Outgoing-Call-Reply  . . . . . . . . . . . . . . . . . . . \
    \ 22\n   2.9.  Incoming-Call-Request  . . . . . . . . . . . . . . . . . .  25\n\
    \   2.10.  Incoming-Call-Reply . . . . . . . . . . . . . . . . . . .  28\n   2.11.\
    \  Incoming-Call-Connected . . . . . . . . . . . . . . . . .  29\n   2.12.  Call-Clear-Request\
    \  . . . . . . . . . . . . . . . . . . .  31\n   2.13.  Call-Disconnect-Notify\
    \  . . . . . . . . . . . . . . . . .  32\n   2.14.  WAN-Error-Notify  . . . .\
    \ . . . . . . . . . . . . . . . .  33\n   2.15.  Set-Link-Info . . . . . . . .\
    \ . . . . . . . . . . . . . .  35\n   2.16.  General Error Codes . . . . . . .\
    \ . . . . . . . . . . . .  36\n   3.  Control Connection Protocol Operation  .\
    \ . . . . . . . . . .  36\n   3.1.  Control Connection States  . . . . . . . .\
    \ . . . . . . . .  37\n   3.1.1.  Control Connection Originator (may be PAC or\
    \ PNS)  . . .  37\n   3.1.2.  Control connection Receiver (may be PAC or PNS)\
    \  . . . .  39\n   3.1.3.  Start Control Connection Initiation Request Collision\
    \  .  40\n   3.1.4.  Keep Alives and Timers . . . . . . . . . . . . . . . . .\
    \  40\n   3.2.  Call States  . . . . . . . . . . . . . . . . . . . . . . .  41\n\
    \   3.2.1.  Timing considerations  . . . . . . . . . . . . . . . . .  41\n   3.2.2.\
    \  Call ID Values . . . . . . . . . . . . . . . . . . . . .  41\n   3.2.3.  Incoming\
    \ Calls . . . . . . . . . . . . . . . . . . . . .  41\n   3.2.3.1.  PAC Incoming\
    \ Call States . . . . . . . . . . . . . . .  42\n   3.2.3.2.  PNS Incoming Call\
    \ States . . . . . . . . . . . . . . .  43\n   3.2.4.  Outgoing Calls . . . .\
    \ . . . . . . . . . . . . . . . . .  44\n   3.2.4.1.  PAC Outgoing Call States\
    \ . . . . . . . . . . . . . . .  45\n   3.2.4.2.  PNS Outgoing Call States . .\
    \ . . . . . . . . . . . . .  46\n   4.  Tunnel Protocol Operation  . . . . . .\
    \ . . . . . . . . . . .  47\n   4.1.  Enhanced GRE header  . . . . . . . . . .\
    \ . . . . . . . . .  47\n   4.2.  Sliding Window Protocol  . . . . . . . . . .\
    \ . . . . . . .  49\n   4.2.1.  Initial Window Size  . . . . . . . . . . . . .\
    \ . . . . .  49\n   4.2.2.  Closing the Window . . . . . . . . . . . . . . . .\
    \ . . .  49\n   4.2.3.  Opening the Window . . . . . . . . . . . . . . . . . .\
    \ .  50\n   4.2.4.  Window Overflow  . . . . . . . . . . . . . . . . . . . . \
    \ 50\n   4.2.5.  Multi-packet Acknowledgment  . . . . . . . . . . . . . .  50\n\
    \   4.3.  Out-of-sequence Packets  . . . . . . . . . . . . . . . . .  50\n   4.4.\
    \  Acknowledgment Time-Outs . . . . . . . . . . . . . . . . .  51\n   4.4.1. \
    \ Calculating Adaptive Acknowledgment Time-Out . . . . . .  53\n   4.4.2.  Congestion\
    \ Control: Adjusting for Time-Out . . . . . . .  54\n   5.  Security Considerations\
    \  . . . . . . . . . . . . . . . . . .  54\n   6.  Authors' Addresses . . . .\
    \ . . . . . . . . . . . . . . . . .  55\n   7.  References . . . . . . . . . .\
    \ . . . . . . . . . . . . . . .  56\n   8.  Full Copyright Statement . . . . .\
    \ . . . . . . . . . . . . .  57\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   PPTP allows existing Network Access Server (NAS) functions\
    \ to be\n   separated using a client-server architecture. Traditionally, the\n\
    \   following functions are implemented by a NAS:\n      1) Physical native interfacing\
    \ to PSTN or ISDN and control of\n         external modems or terminal adapters.\n\
    \         A NAS may interface directly to a telco analog or digital\n        \
    \ circuit or attach via an external modem or terminal adapter.\n         Control\
    \ of a circuit-switched connection is accomplished with\n         either modem\
    \ control or DSS1 ISDN call control protocols.\n         The NAS, in conjunction\
    \ with the modem or terminal adapters,\n         may perform rate adaption, analog\
    \ to digital conversion, sync\n         to async conversion or a number of other\
    \ alterations of data\n         streams.\n      2) Logical termination of a Point-to-Point-Protocol\
    \ (PPP) Link\n         Control Protocol (LCP) session.\n      3) Participation\
    \ in PPP authentication protocols [3,9,10].\n      4) Channel aggregation and\
    \ bundle management for PPP Multilink\n         Protocol.\n      5) Logical termination\
    \ of various PPP network control protocols\n         (NCP).\n      6) Multiprotocol\
    \ routing and bridging between NAS interfaces.\n   PPTP divides these functions\
    \ between the PAC and PNS. The PAC is\n   responsible for functions 1, 2, and\
    \ possibly 3. The PNS may be\n   responsible for function 3 and is responsible\
    \ for functions 4, 5, and\n   6.  The protocol used to carry PPP protocol data\
    \ units (PDUs) between\n   the PAC and PNS, as well as call control and management\
    \ is addressed\n   by PPTP.\n   The decoupling of NAS functions offers these benefits:\n\
    \      Flexible IP address management. Dial-in users may maintain a\n      single\
    \ IP address as they dial into different PACs as long as they\n      are served\
    \ from a common PNS. If an enterprise network uses\n      unregistered addresses,\
    \ a PNS associated with the enterprise\n      assigns addresses meaningful to\
    \ the private network.\n      Support of non-IP protocols for dial networks behind\
    \ IP networks.\n      This allows Appletalk and IPX, for example to be tunneled\
    \ through\n      an IP-only provider. The PAC need not be capable of processing\n\
    \      these protocols.\n      A solution to the \"multilink hunt-group splitting\"\
    \ problem.\n      Multilink PPP, typically used to aggregate ISDN B channels,\n\
    \      requires that all of the channels composing a multilink bundle be\n   \
    \   grouped at a single NAS.  Since a multilink PPP bundle can be\n      handled\
    \ by a single PNS, the channels comprising the bundle may be\n      spread across\
    \ multiple PACs.\n"
- title: 1.1.  Protocol Goals and Assumptions
  contents:
  - "1.1.  Protocol Goals and Assumptions\n   The PPTP protocol is implemented only\
    \ by the PAC and PNS. No other\n   systems need to be aware of PPTP. Dial networks\
    \ may be connected to a\n   PAC without being aware of PPTP. Standard PPP client\
    \ software should\n   continue to operate on tunneled PPP links.\n   PPTP can\
    \ also be used to tunnel a PPP session over an IP network. In\n   this configuration\
    \ the PPTP tunnel and the PPP session runs between\n   the same two machines with\
    \ the caller acting as a PNS.\n   It is envisioned that there will be a many-to-many\
    \ relationship\n   between PACs and PNSs.  A PAC may provide service to many PNSs.\
    \ For\n   example, an Internet service provider may choose to support PPTP for\n\
    \   a number of private network clients and create VPNs for them. Each\n   private\
    \ network may operate one or more PNSs. A single PNS may\n   associate with many\
    \ PACs to concentrate traffic from a large number\n   of geographically diverse\
    \ sites.\n   PPTP uses an extended version of GRE to carry user PPP packets. These\n\
    \   enhancements allow for low-level congestion and flow control to be\n   provided\
    \ on the tunnels used to carry user data between PAC and PNS.\n   This mechanism\
    \ allows for efficient use of the bandwidth available\n   for the tunnels and\
    \ avoids unnecessary retransmisions and buffer\n   overruns.  PPTP does not dictate\
    \ the particular algorithms to be used\n   for this low level control but it does\
    \ define the parameters that\n   must be communicated in order to allow such algorithms\
    \ to work.\n   Suggested algorithms are included in section 4.\n"
- title: 1.2.  Terminology
  contents:
  - "1.2.  Terminology\n   Analog Channel\n      A circuit-switched communication\
    \ path which is intended to carry\n      3.1 Khz audio in each direction.\n  \
    \ Digital Channel\n      A circuit-switched communication path which is intended\
    \ to carry\n      digital information in each direction.\n   Call\n      A connection\
    \ or attempted connection between two terminal\n      endpoints on a PSTN or ISDN\
    \ -- for example, a telephone call\n      between two modems.\n   Control Connection\n\
    \      A control connection is created for each PAC, PNS pair and\n      operates\
    \ over TCP [4]. The control connection governs aspects of\n      the tunnel and\
    \ of sessions assigned to the tunnel.\n   Dial User\n      An end-system or router\
    \ attached to an on-demand PSTN or ISDN\n      which is either the initiator or\
    \ recipient of a call.\n   Network Access Server (NAS)\n      A device providing\
    \ temporary, on-demand network access to users.\n      This access is point-to-point\
    \ using PSTN or ISDN lines.\n   PPTP Access Concentrator (PAC)\n      A device\
    \ attached to one or more PSTN or ISDN lines capable of PPP\n      operation and\
    \ of handling the PPTP protocol. The PAC need only\n      implement TCP/IP to\
    \ pass traffic to one or more PNSs. It may also\n      tunnel non-IP protocols.\n\
    \   PPTP Network Server (PNS)\n      A PNS is envisioned to operate on general-purpose\
    \ computing/server\n      platforms. The PNS handles the server side of the PPTP\
    \ protocol.\n      Since PPTP relies completely on TCP/IP and is independent of\
    \ the\n      interface hardware, the PNS may use any combination of IP\n     \
    \ interface hardware including LAN and WAN devices.\n   Session\n      PPTP is\
    \ connection-oriented.  The PNS and PAC maintain state for\n      each user that\
    \ is attached to a PAC.  A session is created when\n      end-to-end PPP connection\
    \ is attempted between a dial user and the\n      PNS.  The datagrams related\
    \ to a session are sent over the tunnel\n      between the PAC and PNS.\n   Tunnel\n\
    \      A tunnel is defined by a PNS-PAC pair.  The tunnel protocol is\n      defined\
    \ by a modified version of GRE [1,2].  The tunnel carries\n      PPP datagrams\
    \ between the PAC and the PNS.  Many sessions are\n      multiplexed on a single\
    \ tunnel.  A control connection operating\n      over TCP controls the establishment,\
    \ release, and maintenance of\n      sessions and of the tunnel itself.\n"
- title: 1.3.  Protocol Overview
  contents:
  - "1.3.  Protocol Overview\n   There are two parallel components of PPTP: 1) a Control\
    \ Connection\n   between each PAC-PNS pair operating over TCP and 2) an IP tunnel\n\
    \   operating between the same PAC-PNS pair which is used to transport\n   GRE\
    \ encapsulated PPP packets for user sessions between the pair.\n"
- title: 1.3.1.  Control Connection Overview
  contents:
  - "1.3.1.  Control Connection Overview\n   Before PPP tunneling can occur between\
    \ a PAC and PNS, a control\n   connection must be established between them. The\
    \ control connection\n   is a standard TCP session over which PPTP call control\
    \ and management\n   information is passed. The control session is logically associated\n\
    \   with, but separate from, the sessions being tunneled through a PPTP\n   tunnel.\
    \  For each PAC-PNS pair both a tunnel and a control connection\n   exist. The\
    \ control connection is responsible for establishment,\n   management, and release\
    \ of sessions carried through the tunnel. It is\n   the means by which a PNS is\
    \ notified of an incoming call at an\n   associated PAC, as well as the means\
    \ by which a PAC is instructed to\n   place an outgoing dial call.\n   A control\
    \ connection can be established by either the PNS or the PAC.\n   Following the\
    \ establishment of the required TCP connection, the PNS\n   and PAC establish\
    \ the control connection using the Start-Control-\n   Connection-Request and -Reply\
    \ messages.  These messages are also used\n   to exchange information about basic\
    \ operating capabilities of the PAC\n   and PNS.  Once the control connection\
    \ is established, the PAC or PNS\n   may initiate sessions by requesting outbound\
    \ calls or responding to\n   inbound requests. The control connection may communicate\
    \ changes in\n   operating characteristics of an individual user session with\
    \ a Set-\n   Link-Info message.  Individual sessions may be released by either\
    \ the\n   PAC or PNS, also through Control Connection messages.\n   The control\
    \ connection itself is maintained by keep-alive echo\n   messages.  This ensures\
    \ that a connectivity failure between the PNS\n   and the PAC can be detected\
    \ in a timely manner. Other failures can be\n   reported via the\n   Wan-Error-Notify\
    \ message, also on the control connection.\n   It is intended that the control\
    \ connection will also carry management\n   related messages in the future, such\
    \ as a message allowing the PNS to\n   request the status of a given PAC; these\
    \ message types have not yet\n   been defined.\n"
- title: 1.3.2.  Tunnel Protocol Overview
  contents:
  - "1.3.2.  Tunnel Protocol Overview\n   PPTP requires the establishment of a tunnel\
    \ for each communicating\n   PNS-PAC pair.  This tunnel is used to carry all user\
    \ session PPP\n   packets for sessions involving a given PNS-PAC pair.  A key\
    \ which is\n   present in the GRE header indicates which session a particular\
    \ PPP\n   packet belongs to.\n   In this manner, PPP packets are multiplexed and\
    \ demultiplexed over a\n   single tunnel between a given PNS-PAC pair.  The value\
    \ to use in the\n   key field is established by the call establishment procedure\
    \ which\n   takes place on the control connection.\n   The GRE header also contains\
    \ acknowledgment and sequencing\n   information that is used to perform some level\
    \ of congestion-control\n   and error detection over the tunnel.  Again the control\
    \ connection is\n   used to determine rate and buffering parameters that are used\
    \ to\n   regulate the flow of PPP packets for a particular session over the\n\
    \   tunnel.  PPTP does not specify the particular algorithms to use for\n   congestion-control\
    \ and flow-control.  Suggested algorithms for the\n   determination of adaptive\
    \ time-outs to recover from dropped data or\n   acknowledgments on the tunnel\
    \ are included in section 4.4 of this\n   document.\n"
- title: 1.4.  Message Format and Protocol Extensibility
  contents:
  - "1.4.  Message Format and Protocol Extensibility\n   PPTP defines a set of messages\
    \ sent as TCP data on the control\n   connection between a PNS and a given PAC.\
    \  The TCP session for the\n   control connection is established by initiating\
    \ a TCP connection to\n   port 1723 [6]. The source port is assigned to any unused\
    \ port number.\n   Each PPTP Control Connection message begins with an 8 octet\
    \ fixed\n   header portion.  This fixed header contains the following: the total\n\
    \   length of the message, the PPTP Message Type indicator, and a \"Magic\n  \
    \ Cookie\".\n   Two Control Connection message types are indicated by the PPTP\n\
    \   Message Type field:\n         1 - Control Message\n         2 - Management\
    \ Message\n   Management messages are currently not defined.\n   The Magic Cookie\
    \ is always sent as the constant 0x1A2B3C4D.  Its\n   basic purpose is to allow\
    \ the receiver to ensure that it is properly\n   synchronized with the TCP data\
    \ stream.  It should not be used as a\n   means for resynchronizing the TCP data\
    \ stream in the event that a\n   transmitter issues an improperly formatted message.\
    \  Loss of\n   synchronization must result in immediate closing of the control\n\
    \   connection's TCP session.\n   For clarity, all Control Connection message\
    \ templates in the next\n   section include the entire PPTP Control Connection\
    \ message header.\n   Numbers preceded by 0x are hexadecimal values.\n"
- title: 'The currently defined Control Messages, grouped by function, are:'
  contents:
  - "The currently defined Control Messages, grouped by function, are:\n         Control\
    \ Message                        Message Code\n         (Control Connection Management)\n\
    \         Start-Control-Connection-Request            1\n         Start-Control-Connection-Reply\
    \              2\n         Stop-Control-Connection-Request             3\n   \
    \      Stop-Control-Connection-Reply               4\n         Echo-Request  \
    \                              5\n         Echo-Reply                        \
    \          6\n         (Call Management)\n         Outgoing-Call-Request     \
    \                  7\n         Outgoing-Call-Reply                         8\n\
    \         Incoming-Call-Request                       9\n         Incoming-Call-Reply\
    \                        10\n         Incoming-Call-Connected                \
    \    11\n         Call-Clear-Request                         12\n         Call-Disconnect-Notify\
    \                     13\n         (Error Reporting)\n         WAN-Error-Notify\
    \                           14\n         (PPP Session Control)\n         Set-Link-Info\
    \                              15\n   The Start-Control-Connection-Request and\
    \ -Reply messages determine\n   which version of the Control Connection protocol\
    \ will be used.  The\n   version number field carried in these messages consists\
    \ of a version\n   number in the high octet and a revision number in the low octet.\n\
    \   Version handling is described in section 2. The current value of the\n   version\
    \ number field is 0x0100 for version 1, revision 0.\n   The use of the GRE-like\
    \ header for the encapsulation of PPP user\n   packets is specified in section\
    \ 4.1.\n   The MTU for the user data packets encapsulated in GRE is 1532 octets,\n\
    \   not including the IP and GRE headers.\n"
- title: 2.  Control Connection Protocol Specification
  contents:
  - "2.  Control Connection Protocol Specification\n   Control Connection messages\
    \ are used to establish and clear user\n   sessions.  The first set of Control\
    \ Connection messages are used to\n   maintain the control connection itself.\
    \  The control connection is\n   initiated by either the PNS or PAC after they\
    \ establish the\n   underlying TCP connection.  The procedure and configuration\n\
    \   information required to determine which TCP connections are\n   established\
    \ is not covered by this protocol.\n   The following Control Connection messages\
    \ are all sent as user data\n   on the established TCP connection between a given\
    \ PNS-PAC pair.  Note\n   that care has been taken to ensure that all word (2\
    \ octet) and\n   longword (4 octet) values begin on appropriate boundaries.  All\
    \ data\n   is sent in network order (high order octets first).  Any \"reserved\"\
    \n   fields MUST be sent as 0 values to allow for protocol extensibility.\n"
- title: 2.1.  Start-Control-Connection-Request
  contents:
  - "2.1.  Start-Control-Connection-Request\n   The Start-Control-Connection-Request\
    \ is a PPTP control message used\n   to establish the control connection between\
    \ a PNS and a PAC.  Each\n   PNS-PAC pair requires a dedicated control connection\
    \ to be\n   established.  A control connection must be established before any\n\
    \   other PPTP messages can be issued.  The establishment of the control\n   connection\
    \ can be initiated by either the PNS or PAC.  A procedure\n   which handles the\
    \ occurrence of a collision between PNS and PAC\n   Start-Control-Connection-Requests\
    \ is described in section 3.1.3.\n       0                   1               \
    \    2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |             Length            |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Protocol Version        |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                     Framing Capabilities                      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                      Bearer Capabilities                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Maximum Channels        |       Firmware Revision       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                  Host Name (64 octets)                     +\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                   Vendor String (64 octets)                   +\n      |\
    \                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Length                   Total length in octets of this PPTP\n        \
    \                       message, including the entire PPTP\n                 \
    \              header.\n      PPTP Message Type        1 for Control Message.\n\
    \      Magic Cookie             0x1A2B3C4D. This constant value is used\n    \
    \                           as a sanity check on received messages\n         \
    \                      (see section 1.4).\n      Control Message Type     1 for\
    \ Start-Control-Connection-Request.\n      Reserved0                This field\
    \ MUST be 0.\n      Protocol Version         The version of the PPTP protocol\
    \ that the\n                               sender wishes to use.\n      Reserved1\
    \                This field MUST be 0.\n   Framing Capabilities     A set of bits\
    \ indicating the type of framing\n                            that the sender\
    \ of this message can provide.\n                            The currently defined\
    \ bit settings are:\n                               1 - Asynchronous Framing supported\n\
    \                               2 - Synchronous Framing supported\n   Bearer Capabilities\
    \      A set of bits indicating the bearer\n                            capabilities\
    \ that the sender of this message\n                            can provide.  The\
    \ currently defined bit\n                            settings are:\n         \
    \                      1 - Analog access supported\n                         \
    \      2 - Digital access supported\n   Maximum Channels         The total number\
    \ of individual PPP sessions\n                            this PAC can support.\
    \  In Start-Control-\n                            Connection-Requests issued by\
    \ the PNS, this\n                            value SHOULD be set to 0.  It MUST\
    \ be\n                            ignored by the PAC.\n   Firmware Revision  \
    \      This field contains the firmware revision\n                           \
    \ number of the issuing PAC, when issued by\n                            the PAC,\
    \ or the version of the PNS PPTP\n                            driver if issued\
    \ by the PNS.\n   Host Name                A 64 octet field containing the DNS\
    \ name of\n                            the issuing PAC or PNS.  If less than 64\n\
    \                            octets in length, the remainder of this\n       \
    \                     field SHOULD be filled with octets of value\n          \
    \                  0.\n   Vendor Name              A 64 octet field containing\
    \ a vendor\n                            specific string describing the type of\
    \ PAC\n                            being used, or the type of PNS software\n \
    \                           being used if this request is issued by the\n    \
    \                        PNS.  If less than 64 octets in length, the\n       \
    \                     remainder of this field SHOULD be filled\n             \
    \               with octets of value 0.\n"
- title: 2.2.  Start-Control-Connection-Reply
  contents:
  - "2.2.  Start-Control-Connection-Reply\n   The Start-Control-Connection-Reply is\
    \ a PPTP control message sent in\n   reply to a received Start-Control-Connection-Request\
    \ message.  This\n   message contains a result code indicating the result of the\
    \ control\n   connection establishment attempt.\n       0                   1\
    \                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |             Length            |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Protocol Version        |  Result Code  |  Error Code   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                      Framing Capability                       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                       Bearer Capability                       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |       Maximum Channels        |       Firmware Revision       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                  Host Name (64 octets)                     +\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                   Vendor String (64 octets)                   +\n      |\
    \                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     2 for Start-Control-Connection-Reply.\n   Reserved0\
    \                This field MUST be 0.\n   Protocol Version         The version\
    \ of the PPTP protocol that the\n                            sender wishes to\
    \ use.\n   Result Code              Indicates the result of the command channel\n\
    \                            establishment attempt.  Current valid Result\n  \
    \                          Code values are:\n                                \
    \  1 - Successful channel establishment\n                                  2 -\
    \ General error -- Error Code\n                                      indicates\
    \ the problem\n                                  3 - Command channel already exists;\n\
    \                                  4 - Requester is not authorized to\n      \
    \                                establish a command channel\n               \
    \                   5 - The protocol version of the\n                        \
    \              requester is not supported\n   Error Code               This field\
    \ is set to 0 unless a \"General\n                            Error\" exists,\
    \ in which case Result Code is\n                            set to 2 and this\
    \ field is set to the value\n                            corresponding to the\
    \ general error condition\n                            as specified in section\
    \ 2.2.\n   Framing Capabilities     A set of bits indicating the type of framing\n\
    \                            that the sender of this message can provide.\n  \
    \                          The currently defined bit settings are:\n         \
    \                         1 - Asynchronous Framing supported\n               \
    \                   2 - Synchronous Framing supported.\n   Bearer Capabilities\
    \      A set of bits indicating the bearer\n                            capabilities\
    \ that the sender of this message\n                            can provide.  The\
    \ currently defined bit\n                            settings are:\n         \
    \                         1 - Analog access supported\n                      \
    \            2 - Digital access supported\n   Maximum Channels         The total\
    \ number of individual PPP sessions\n                            this PAC can\
    \ support.  In a Start-Control-\n                            Connection-Reply\
    \ issued by the PNS, this\n                            value SHOULD be set to\
    \ 0 and it must be\n                            ignored by the PAC. The PNS MUST\
    \ NOT use\n                            this value to try to track the remaining\n\
    \                            number of PPP sessions that the PAC will\n      \
    \                      allow.\n   Firmware Revision        This field contains\
    \ the firmware revision\n                            number of the issuing PAC,\
    \ or the version of\n                            the PNS PPTP driver if issued\
    \ by the PNS.\n   Host Name                A 64 octet field containing the DNS\
    \ name of\n                            the issuing PAC or PNS.  If less than 64\n\
    \                            octets in length, the remainder of this\n       \
    \                     field SHOULD be filled with octets of value\n          \
    \                  0.\n   Vendor Name              A 64 octet field containing\
    \ a vendor\n                            specific string describing the type of\
    \ PAC\n                            being used, or the type of PNS software\n \
    \                           being used if this request is issued by the\n    \
    \                        PNS.  If less than 64 octets in length, the\n       \
    \                     remainder of this field SHOULD be filled\n             \
    \               with octets of value 0.\n"
- title: 2.3.  Stop-Control-Connection-Request
  contents:
  - "2.3.  Stop-Control-Connection-Request\n   The Stop-Control-Connection-Request\
    \ is a PPTP control message sent by\n   one peer of a PAC-PNS control connection\
    \ to inform the other peer\n   that the control connection should be closed. \
    \ In addition to closing\n   the control connection, all active user calls are\
    \ implicitly cleared.\n   The reason for issuing this request is indicated in\
    \ the Reason field.\n       0                   1                   2        \
    \           3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |             Length            |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \    Reason     |   Reserved1   |           Reserved2           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     3 for Stop-Control-Connection-Request.\n   Reserved0\
    \                This field MUST be 0.\n   Reason                   Indicates\
    \ the reason for the control\n                            connection being closed.\
    \ Current valid\n                            Reason values are:\n            \
    \                      1 (None) - General request to clear\n                 \
    \                   control connection\n                                  2 (Stop-Protocol)\
    \ - Can't support\n                                    peer's version of the protocol\n\
    \                                  3 (Stop-Local-Shutdown) - Requester is\n  \
    \                                  being shut down\n      Reserved1, Reserved2\
    \     These fields MUST be 0.\n"
- title: 2.4.  Stop-Control-Connection-Reply
  contents:
  - "2.4.  Stop-Control-Connection-Reply\n   The Stop-Control-Connection-Reply is\
    \ a PPTP control message sent by\n   one peer of a PAC-PNS control connection\
    \ upon receipt of a Stop-\n   Control-Connection-Request from the other peer.\n\
    \       0                   1                   2                   3\n      \
    \ 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \  Result Code  |   Error Code  |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     4 for Stop-Control-Connection-Reply.\n   Reserved0\
    \                This field MUST be 0.\n   Result Code              Indicates\
    \ the result of the attempt to close\n                            the control\
    \ connection. Current valid Result\n                            Code values are:\n\
    \                                  1 (OK) - Control connection closed\n      \
    \                            2 (General Error) - Control connection\n        \
    \                            not closed for reason indicated in\n            \
    \                        Error Code\n   Error Code               This field is\
    \ set to 0 unless a \"General\n                            Error\" exists, in\
    \ which case Result Code is\n                            set to 2 and this field\
    \ is set to the value\n                            corresponding to the general\
    \ error condition\n                            as specified in section 2.2.\n\
    \   Reserved1                This field MUST be 0.\n"
- title: 2.5.  Echo-Request
  contents:
  - "2.5.  Echo-Request\n   The Echo-Request is a PPTP control message sent by either\
    \ peer of a\n   PAC-PNS control connection. This control message is used as a\
    \ \"keep-\n   alive\" for the control connection.  The receiving peer issues an\n\
    \   Echo-Reply to each Echo-Request received. As specified in section\n   3.1.4,\
    \ if the sender does not receive an Echo-Reply in response to an\n   Echo-Request,\
    \ it will eventually clear the control connection.\n       0                 \
    \  1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                          Identifier                           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     5 for Echo-Request.\n   Reserved0               \
    \ This field MUST be 0.\n   Identifier               A value set by the sender\
    \ of the Echo-\n                            Request that is used to match the\
    \ reply with\n                            the corresponding request.\n"
- title: 2.6.  Echo-Reply
  contents:
  - "2.6.  Echo-Reply\n   The Echo-Reply is a PPTP control message sent by either\
    \ peer of a\n   PAC-PNS control connection in response to the receipt of an Echo-\n\
    \   Request.\n       0                   1                   2               \
    \    3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |            Length             |      PPTP Message Type        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                         Magic Cookie                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Control Message Type      |           Reserved0           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                          Identifier                           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \  Result Code  |   Error Code  |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     6 for Echo-Reply.\n   Reserved0                This\
    \ field MUST be 0.\n   Identifier               The contents of the identify field\
    \ from the\n                            received Echo-Request is copied to this\n\
    \                            field.\n   Result Code              Indicates the\
    \ result of the receipt of the\n                            Echo-Request. Current\
    \ valid Result Code\n                            values are:\n               \
    \                   1 (OK) - The Echo-Reply is valid\n                       \
    \           2 (General Error) - Echo-Request not\n                           \
    \         accepted for the reason indicated in\n                             \
    \       Error Code\n   Error Code               This field is set to 0 unless\
    \ a \"General\n                            Error\" condition exists, in which\
    \ case\n                            Result Code is set to 2 and this field is\n\
    \                            set to the value corresponding to the\n         \
    \                   general error condition as specified in\n                \
    \            section 2.2.\n   Reserved1                This field MUST be 0.\n"
- title: 2.7.  Outgoing-Call-Request
  contents:
  - "2.7.  Outgoing-Call-Request\n   The Outgoing-Call-Request is a PPTP control message\
    \ sent by the PNS\n   to the PAC to indicate that an outbound call from the PAC\
    \ is to be\n   established.  This request provides the PAC with information required\n\
    \   to make the call. It also provides information to the PAC that is\n   used\
    \ to regulate the transmission of data to the PNS for this session\n   once it\
    \ is established.\n       0                   1                   2          \
    \         3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \            Call ID            |      Call Serial Number       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                          Minimum BPS                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                          Maximum BPS                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                          Bearer Type                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Framing Type                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |   Packet Recv. Window Size    |    Packet Processing Delay    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \      Phone Number Length      |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                   Phone Number (64 octets)                    +\n      |\
    \                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                    Subaddress (64 octets)                     +\n      |\
    \                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     7 for Outgoing-Call-Request.\n   Reserved0      \
    \          This field MUST be 0.\n   Call ID                  A unique identifier,\
    \ unique to a particular\n                            PAC-PNS pair assigned by\
    \ the PNS to this\n                            session.  It is used to multiplex\
    \ and\n                            demultiplex data sent over the tunnel\n   \
    \                         between the PNS and PAC involved in this\n         \
    \                   session.\n   Call Serial Number       An identifier assigned\
    \ by the PNS to this\n                            session for the purpose of identifying\
    \ this\n                            particular session in logged session\n   \
    \                         information.  Unlike the Call ID, both the\n       \
    \                     PNS and PAC associate the same Call Serial\n           \
    \                 Number with a given session. The combination\n             \
    \               of IP address and call serial number SHOULD\n                \
    \            be unique.\n   Minimum BPS              The lowest acceptable line\
    \ speed (in\n                            bits/second) for this session.\n   Maximum\
    \ BPS              The highest acceptable line speed (in\n                   \
    \         bits/second) for this session.\n   Bearer Type              A value\
    \ indicating the bearer capability\n                            required for this\
    \ outgoing call.  The\n                            currently defined values are:\n\
    \                                  1 - Call to be placed on an analog\n      \
    \                                channel\n                                  2\
    \ - Call to be placed on a digital\n                                      channel\n\
    \                                  3 - Call can be placed on any type of\n   \
    \                                   channel\n   Framing Type             A value\
    \ indicating the type of PPP framing\n                            to be used for\
    \ this outgoing call.\n                                  1 - Call to use Asynchronous\
    \ framing\n                                  2 - Call to use Synchronous framing\n\
    \                                  3 - Call can use either type of\n         \
    \                             framing\n   Packet Recv. Window Size The number\
    \ of received data packets the PNS\n                            will buffer for\
    \ this session.\n   Packet Processing Delay  A measure of the packet processing\
    \ delay\n                            that might be imposed on data sent to the\n\
    \                            PNS from the PAC.  This value is specified\n    \
    \                        in units of 1/10 seconds.  For the PNS this\n       \
    \                     number should be very small.  See section\n            \
    \                4.4 for a description of how this value is\n                \
    \            determined and used.\n   Phone Number Length      The actual number\
    \ of valid digits in the\n                            Phone Number field.\n  \
    \ Reserved1                This field MUST be 0.\n   Phone Number            \
    \ The number to be dialed to establish the\n                            outgoing\
    \ session.  For ISDN and analog calls\n                            this field\
    \ is an ASCII string.  If the Phone\n                            Number is less\
    \ than 64 octets in length, the\n                            remainder of this\
    \ field is filled with\n                            octets of value 0.\n   Subaddress\
    \               A 64 octet field used to specify additional\n                \
    \            dialing information.  If the subaddress is\n                    \
    \        less than 64 octets long, the remainder of\n                        \
    \    this field is filled with octets of value 0.\n"
- title: 2.8.  Outgoing-Call-Reply
  contents:
  - "2.8.  Outgoing-Call-Reply\n   The Outgoing-Call-Reply is a PPTP control message\
    \ sent by the PAC to\n   the PNS in response to a received Outgoing-Call-Request\
    \ message.  The\n   reply indicates the result of the outgoing call attempt. \
    \ It also\n   provides information to the PNS about particular parameters used\
    \ for\n   the call.  It provides information to allow the PNS to regulate the\n\
    \   transmission of data to the PAC for this session.\n       0              \
    \     1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |      PPTP Message Type        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \            Call ID            |       Peer's Call ID          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |  Result Code  |  Error Code   |          Cause Code           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Connect Speed                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |   Packet Recv. Window Size    |    Packet Processing Delay    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                      Physical Channel ID                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     8 for Outgoing-Call-Reply.\n   Reserved0        \
    \        This field MUST be 0.\n   Call ID                  A unique identifier\
    \ for the tunnel, assigned\n                            by the PAC to this session.\
    \  It is used to\n                            multiplex and demultiplex data sent\
    \ over the\n                            tunnel between the PNS and PAC involved\
    \ in\n                            this session.\n   Peer's Call ID           This\
    \ field is set to the value received in\n                            the Call\
    \ ID field of the corresponding\n                            Outgoing-Call-Request\
    \ message.  It is used\n                            by the PNS to match the Outgoing-Call-Reply\n\
    \                            with the Outgoing-Call-Request it issued. It\n  \
    \                          also is used as the value sent in the GRE\n       \
    \                     header for mux/demuxing.\n   Result Code              This\
    \ value indicates the result of the\n                            Outgoing-Call-Request\
    \ attempt.  Currently\n                            valid values are:\n       \
    \                           1 (Connected) - Call established with\n          \
    \                          no errors\n                                  2 (General\
    \ Error) - Outgoing Call not\n                                    established\
    \ for the reason indicated\n                                    in Error Code\n\
    \                                  3 (No Carrier) - Outgoing Call failed\n   \
    \                                 due to no carrier detected\n               \
    \                   4 (Busy) - Outgoing Call failed due to\n                 \
    \                   detection of a busy signal\n                             \
    \     5 (No Dial Tone) - Outgoing Call\n                                    failed\
    \ due to lack of a dial tone\n                                  6 (Time-out) -\
    \ Outgoing Call was not\n                                    established within\
    \ time allotted by\n                                    PAC\n                \
    \                  7 (Do Not Accept) - Outgoing Call\n                       \
    \             administratively prohibited\n   Error Code               This field\
    \ is set to 0 unless a \"General\n                            Error\" condition\
    \ exists, in which case\n                            Result Code is set to 2 and\
    \ this field is\n                            set to the value corresponding to\
    \ the\n                            general error condition as specified in\n \
    \                           section 2.2.\n   Cause Code               This field\
    \ gives additional failure\n                            information.  Its value\
    \ can vary depending\n                            upon the type of call attempted.\
    \  For ISDN\n                            call attempts it is the Q.931 cause code.\n\
    \   Connect Speed            The actual connection speed used, in\n          \
    \                  bits/second.\n   Packet Recv. Window Size The number of received\
    \ data packets the PAC\n                            will buffer for this session.\n\
    \   Packet Processing Delay  A measure of the packet processing delay\n      \
    \                      that might be imposed on data sent to the\n           \
    \                 PAC from the PNS.  This value is specified\n               \
    \             in units of 1/10 seconds.  For the PAC, this\n                 \
    \           number is related to the size of the buffer\n                    \
    \        used to hold packets to be sent to the\n                            client\
    \ and to the speed of the link to the\n                            client.  This\
    \ value should be set to the\n                            maximum delay that can\
    \ normally occur\n                            between the time a packet arrives\
    \ at the PAC\n                            and is delivered to the client.  See\
    \ section\n                            4.4 for an example of how this value is\n\
    \                            determined and used.\n   Physical Channel ID    \
    \  This field is set by the PAC in a vendor-\n                            specific\
    \ manner to the physical channel\n                            number used to place\
    \ this call.  It is used\n                            for logging purposes only.\n"
- title: 2.9.  Incoming-Call-Request
  contents:
  - "2.9.  Incoming-Call-Request\n   The Incoming-Call-Request is a PPTP control message\
    \ sent by the PAC\n   to the PNS to indicate that an inbound call is to be established\
    \ from\n   the PAC.  This request provides the PNS with parameter information\n\
    \   for the incoming call.\n   This message is the first in the \"three-way handshake\"\
    \ used by PPTP\n   for establishing incoming calls.  The PAC may defer answering\
    \ the\n   call until it has received an Incoming-Call-Reply from the PNS\n   indicating\
    \ that the call should be established. This mechanism allows\n   the PNS to obtain\
    \ sufficient information about the call before it is\n   answered to determine\
    \ whether the call should be answered or not.\n       0                   1  \
    \                 2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \            Call ID            |      Call Serial Number       |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                       Call Bearer Type                        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                      Physical Channel ID                      |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Dialed Number Length      |     Dialing Number Length     |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                Dialed Number (64 octets)                   +\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                  Dialing Number (64 octets)                   +\n      |\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |                                                               |\n      +\
    \                    Subaddress (64 octets)                     +\n      |   \
    \                                                            |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     9 for Incoming-Call-Request.\n   Reserved0      \
    \          This field MUST be 0.\n   Call ID                  A unique identifier\
    \ for this tunnel,\n                            assigned by the PAC to this session.\
    \  It is\n                            used to multiplex and demultiplex data sent\n\
    \                            over the tunnel between the PNS and PAC\n       \
    \                     involved in this session.\n   Call Serial Number       An\
    \ identifier assigned by the PAC to this\n                            session\
    \ for the purpose of identifying this\n                            particular\
    \ session in logged session\n                            information.  Unlike\
    \ the Call ID, both the\n                            PNS and PAC associate the\
    \ same Call Serial\n                            Number to a given session. The\
    \ combination\n                            of IP address and call serial number\
    \ should\n                            be unique.\n   Bearer Type             \
    \ A value indicating the bearer capability\n                            used for\
    \ this incoming call.  Currently\n                            defined values are:\n\
    \                                  1 - Call is on an analog channel\n        \
    \                          2 - Call is on a digital channel\n   Physical Channel\
    \ ID      This field is set by the PAC in a vendor-\n                        \
    \    specific manner to the number of the\n                            physical\
    \ channel this call arrived on.\n   Dialed Number Length     The actual number\
    \ of valid digits in the\n                            Dialed Number field.\n \
    \  Dialing Number Length    The actual number of valid digits in the\n       \
    \                     Dialing Number field.\n   Dialed Number            The number\
    \ that was dialed by the caller.\n                            For ISDN and analog\
    \ calls this field is an\n                            ASCII string.  If the Dialed\
    \ Number is less\n                            than 64 octets in length, the remainder\
    \ of\n                            this field is filled with octets of value 0.\n\
    \   Dialing Number           The number from which the call was placed.\n    \
    \                        For ISDN and analog calls this field is an\n        \
    \                    ASCII string.  If the Dialing Number is less\n          \
    \                  than 64 octets in length, the remainder of\n              \
    \              this field is filled with octets of value 0.\n   Subaddress   \
    \            A 64 octet field used to specify additional\n                   \
    \         dialing information.  If the subaddress is\n                       \
    \     less than 64 octets long, the remainder of\n                           \
    \ this field is filled with octets of value 0.\n"
- title: 2.10.  Incoming-Call-Reply
  contents:
  - "2.10.  Incoming-Call-Reply\n   The Incoming-Call-Reply is a PPTP control message\
    \ sent by the PNS to\n   the PAC in response to a received Incoming-Call-Request\
    \ message.  The\n   reply indicates the result of the incoming call attempt. \
    \ It also\n   provides information to allow the PAC to regulate the transmission\
    \ of\n   data to the PNS for this session.\n   This message is the second in the\
    \ three-way handshake used by PPTP\n   for establishing incoming calls.  It indicates\
    \ to the PAC whether the\n   call should be answered or not.\n       0       \
    \            1                   2                   3\n       0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |       PPTP Message Type       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \            Call ID            |       Peer's Call ID          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |  Result Code  |  Error Code   |   Packet Recv. Window Size    |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Packet Transmit Delay     |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     10 for Incoming-Call-Reply.\n   Reserved0       \
    \         This field MUST be 0.\n   Call ID                  A unique identifier\
    \ for this tunnel assigned\n                            by the PNS to this session.\
    \  It is used to\n                            multiplex and demultiplex data sent\
    \ over the\n                            tunnel between the PNS and PAC involved\
    \ in\n                            this session.\n   Peer's Call ID           This\
    \ field is set to the value received in\n                            the Call\
    \ ID field of the corresponding\n                            Incoming-Call-Request\
    \ message. It is used by\n                            the PAC to match the Incoming-Call-Reply\n\
    \                            with the Incoming-Call-Request it issued.\n     \
    \                       This value is included in the GRE header of\n        \
    \                    transmitted data packets for this session.\n   Result Code\
    \              This value indicates the result of the\n                      \
    \      Incoming-Call-Request attempt.  Current\n                            valid\
    \ Result Code values are:\n                                  1 (Connect) - The\
    \ PAC should answer\n                                    the incoming call\n \
    \                                 2 (General Error) - The Incoming Call\n    \
    \                                should not be established due to the\n      \
    \                              reason indicated in Error Code\n              \
    \                    3 (Do Not Accept) - The PAC should not\n                \
    \                    accept the incoming call.  It should\n                  \
    \                  hang up or issue a busy indication\n   Error Code         \
    \      This field is set to 0 unless a \"General\n                           \
    \ Error\" condition exists, in which case\n                            Result\
    \ Code is set to 2 and this field is\n                            set to the value\
    \ corresponding to the\n                            general error condition as\
    \ specified in\n                            section 2.2.\n   Packet Recv. Window\
    \ Size The number of received data packets the PAC\n                         \
    \   will buffer for this session.\n   Packet Transmit Delay    A measure of the\
    \ packet processing delay\n                            that might be imposed on\
    \ data sent to the\n                            PAC from the PNS.  This value\
    \ is specified\n                            in units of 1/10 seconds.\n   Reserved1\
    \                This field MUST be 0.\n"
- title: 2.11.  Incoming-Call-Connected
  contents:
  - "2.11.  Incoming-Call-Connected\n   The Incoming-Call-Connected message is a PPTP\
    \ control message sent by\n   the PAC to the PNS in response to a received Incoming-Call-Reply.\
    \  It\n   provides information to the PNS about particular parameters used for\n\
    \   the call.  It also provides information to allow the PNS to regulate\n   the\
    \ transmission of data to the PAC for this session.\n   This message is the third\
    \ in the three-way handshake used by PPTP for\n   establishing incoming calls.\
    \  It provides a mechanism for providing\n   the PNS with additional information\
    \ about the call that cannot, in\n   general, be obtained at the time the Incoming-Call-Request\
    \ is issued\n   by the PAC.\n       0                   1                   2\
    \                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |      PPTP Message Type        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \       Peer's Call ID          |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                         Connect Speed                         |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \   Packet Recv. Window Size    |     Packet Transmit Delay     |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                         Framing Type                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   Length\
    \                   Total length in octets of this PPTP message,\n           \
    \                 including the entire PPTP header.\n   PPTP Message Type    \
    \    1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n   Control\
    \ Message Type     11 for Incoming-Call-Connected.\n   Reserved0             \
    \   This field MUST be 0.\n   Peer's Call ID           This field is set to the\
    \ value received in\n                            the Call ID field of the corresponding\n\
    \                            Incoming-Call-Reply message.  It is used by\n   \
    \                         the PNS to match the Incoming-Call-Connected\n     \
    \                       with the Incoming-Call-Reply it issued.\n   Connect Speed\
    \            The actual connection speed used, in\n                          \
    \  bits/second.\n   Packet Recv. Window Size The number of received data packets\
    \ the PAC\n                            will buffer for this session.\n   Packet\
    \ Transmit Delay    A measure of the packet processing delay\n               \
    \             that might be imposed on data sent to the\n                    \
    \        PAC from the PNS.  This value is specified\n                        \
    \    in units of 1/10 seconds.\n   Framing Type             A value indicating\
    \ the type of PPP framing\n                            being used by this incoming\
    \ call.\n                                  1 - Call uses asynchronous framing\n\
    \                                  2 - Call uses synchronous framing\n"
- title: 2.12.  Call-Clear-Request
  contents:
  - "2.12.  Call-Clear-Request\n   The Call-Clear-Request is a PPTP control message\
    \ sent by the PNS to\n   the PAC indicating that a particular call is to be disconnected.\
    \  The\n   call being cleared can be either an incoming or outgoing call, in any\n\
    \   state.  The PAC responds to this message with a Call-Disconnect-\n   Notify\
    \ message.\n       0                   1                   2                 \
    \  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   \
    \   |            Length             |      PPTP Message Type        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                         Magic Cookie                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \     Control Message Type      |           Reserved0           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Call ID            |           Reserved1           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n   Length\
    \                   Total length in octets of this PPTP message,\n           \
    \                 including the entire PPTP header.\n   PPTP Message Type    \
    \    1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n   Control\
    \ Message Type     12 for Call-Clear-Request.\n   Reserved0                This\
    \ field MUST be 0.\n   Call ID                  The Call ID assigned by the PNS\
    \ to this\n                            call.  This value is used instead of the\n\
    \                            Peer's Call ID because the latter may not be\n  \
    \                          known to the PNS if the call must be aborted\n    \
    \                        during call establishment.\n   Reserved1            \
    \    This field MUST be 0.\n"
- title: 2.13.  Call-Disconnect-Notify
  contents:
  - "2.13.  Call-Disconnect-Notify\n   The Call-Disconnect-Notify message is a PPTP\
    \ control message sent by\n   the PAC to the PNS.  It is issued whenever a call\
    \ is disconnected,\n   due to the receipt by the PAC of a Call-Clear-Request or\
    \ for any\n   other reason.  Its purpose is to inform the PNS of both the\n  \
    \ disconnection and the reason for it.\n       0                   1         \
    \          2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |      PPTP Message Type        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message Type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \            Call ID            |  Result Code  |  Error Code   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |          Cause Code           |           Reserved1           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \           Call Statistics (128 octets)                     +\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     13 for Call-Disconnect-Notify.\n   Reserved0    \
    \            This field MUST be 0.\n   Call ID                  The value of the\
    \ Call ID assigned by the PAC\n                            to this call.  This\
    \ value is used instead of\n                            the Peer's Call ID because\
    \ the latter may\n                            not be known to the PNS if the call\
    \ must be\n                            aborted during call establishment.\n  \
    \ Result Code              This value indicates the reason for the\n         \
    \                   disconnect. Current valid Result Code values\n           \
    \                 are:\n                                  1 (Lost Carrier) - Call\
    \ disconnected\n                                    due to loss of carrier\n \
    \                                 2 (General Error) - Call disconnected\n    \
    \                                for the reason indicated in Error\n         \
    \                           Code\n                                  3 (Admin Shutdown)\
    \ - Call disconnected\n                                    for administrative\
    \ reasons\n                                  4 (Request) - Call disconnected due\
    \ to\n                                    received Call-Clear-Request\n   Error\
    \ Code               This field is set to 0 unless a \"General\n             \
    \               Error\" condition exists, in which case the\n                \
    \            Result Code is set to 2 and this field is\n                     \
    \       set to the value corresponding to the\n                            general\
    \ error condition as specified in\n                            section 2.2.\n\
    \   Cause Code               This field gives additional disconnect\n        \
    \                    information.  Its value varies depending on\n           \
    \                 the type of call being disconnected.  For\n                \
    \            ISDN calls it is the Q.931 cause code.\n   Call Statistics      \
    \    This field is an ASCII string containing\n                            vendor-specific\
    \ call statistics that can be\n                            logged for diagnostic\
    \ purposes.  If the\n                            length of the string is less\
    \ than 128, the\n                            remainder of the field is filled\
    \ with octets\n                            of value 0.\n"
- title: 2.14.  WAN-Error-Notify
  contents:
  - "2.14.  WAN-Error-Notify\n   The WAN-Error-Notify message is a PPTP control message\
    \ sent by the\n   PAC to the PNS to indicate WAN error conditions (conditions\
    \ that\n   occur on the interface supporting PPP).  The counters in this message\n\
    \   are cumulative.  This message should only be sent when an error\n   occurs,\
    \ and not more than once every 60 seconds.  The counters are\n   reset when a\
    \ new call is established.\n       0                   1                   2 \
    \                  3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4\
    \ 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |      PPTP Message Type        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Peer's Call ID         |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                          CRC Errors                           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                        Framing Errors                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                       Hardware Overruns                       |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                        Buffer Overruns                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                        Time-out Errors                        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                       Alignment Errors                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     14 for WAN-Error-Notify.\n   Reserved0          \
    \      This field MUST be 0.\n   Peer's Call ID           Th Call ID assigned\
    \ by the PNS to this call.\n   CRC Errors               Number of PPP frames received\
    \ with CRC\n                            errors since session was established.\n\
    \   Framing Errors           Number of improperly framed PPP packets\n       \
    \                     received.\n   Hardware Overruns        Number of receive\
    \ buffer over-runs since\n                            session was established.\n\
    \   Buffer Overruns          Number of buffer over-runs detected since\n     \
    \                       session was established.\n   Time-out Errors         \
    \ Number of time-outs since call was\n                            established.\n\
    \   Alignment Errors         Number of alignment errors since call was\n     \
    \                       established.\n"
- title: 2.15.  Set-Link-Info
  contents:
  - "2.15.  Set-Link-Info\n   The Set-Link-Info message is a PPTP control message\
    \ sent by the PNS\n   to the PAC to set PPP-negotiated options.  Because these\
    \ options can\n   change at any time during the life of the call, the PAC must\
    \ be able\n   to update its internal call information dynamically and perform\
    \ PPP\n   negotiation on an active PPP session.\n       0                   1\
    \                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |            Length             |      PPTP Message Type        |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Magic Cookie                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Control Message type      |           Reserved0           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \        Peer's Call ID         |           Reserved1           |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                           Send ACCM                           |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                         Receive ACCM                          |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Length                   Total length in octets of this PPTP message,\n  \
    \                          including the entire PPTP header.\n   PPTP Message\
    \ Type        1 for Control Message.\n   Magic Cookie             0x1A2B3C4D.\n\
    \   Control Message Type     15 for Set-Link-Info.\n   Reserved0             \
    \   This field MUST be 0.\n   Peer's Call ID           The value of the Call ID\
    \ assigned by the PAC\n                            to this call.\n   Reserved1\
    \                This field MUST be 0.\n   Send ACCM                The send ACCM\
    \ value the client should use to\n                            process outgoing\
    \ PPP packets.  The default\n                            value used by the client\
    \ until this message\n                            is received is 0XFFFFFFFF. \
    \ See [7].\n   Receive ACCM             The receive ACCM value the client should\
    \ use\n                            to process incoming PPP packets. The default\n\
    \                            value used by the client until this message\n   \
    \                         is received is 0XFFFFFFFF.  See [7].\n"
- title: 2.16.  General Error Codes
  contents:
  - "2.16.  General Error Codes\n   General error codes pertain to types of errors\
    \ which are not specific\n   to any particular PPTP request, but rather to protocol\
    \ or message\n   format errors.  If a PPTP reply indicates in its Result Code\
    \ that a\n   general error occurred, the General Error value should be examined\
    \ to\n   determined what the error was.  The currently defined General Error\n\
    \   codes and their meanings are:\n      0 (None)          - No general error\n\
    \      1 (Not-Connected) - No control connection exists yet for this\n       \
    \                   PAC-PNS pair\n      2 (Bad-Format)    - Length is wrong or\
    \ Magic Cookie value is\n                          incorrect\n      3 (Bad-Value)\
    \     - One of the field values was out of range or\n                        \
    \  reserved field was non-zero\n      4 (No-Resource)   - Insufficient resources\
    \ to handle this command\n                          now\n      5 (Bad-Call ID)\
    \    - The Call ID is invalid in this context\n      6 (PAC-Error)     - A generic\
    \ vendor-specific error occurred in\n                          the PAC\n"
- title: 3.  Control Connection Protocol Operation
  contents:
  - "3.  Control Connection Protocol Operation\n   This section describes the operation\
    \ of various PPTP control\n   connection functions and the Control Connection\
    \ messages which are\n   used to support them.  The protocol operation of the\
    \ control\n   connection is simplified because TCP is used to provide a reliable\n\
    \   transport mechanism.  Ordering and retransmission of messages is not\n   a\
    \ concern at this level.  The TCP connection itself, however, can\n   close at\
    \ any time and an appropriate error recovery mechanism must be\n   provided to\
    \ handle this case.\n   Some error recovery procedures are common to all states\
    \ of the\n   control connection.  If an expected reply does not arrive within\
    \ 60\n   seconds, the control connection is closed, unless otherwise\n   specified.\
    \  Appropriate logging should be implemented for easy\n   determination of the\
    \ problems and the reasons for closing the control\n   connection.\n   Receipt\
    \ of an invalid or malformed Control Connection message should\n   be logged appropriately,\
    \ and the control connection should be closed\n   and restarted to ensure recovery\
    \ into a known state.\n"
- title: 3.1.  Control Connection States
  contents:
  - "3.1.  Control Connection States\n   The control connection relies on a standard\
    \ TCP connection for its\n   service.  The PPTP control connection protocol is\
    \ not distinguishable\n   between the PNS and PAC, but is distinguishable between\
    \ the\n   originator and receiver. The originating peer is the one which first\n\
    \   attempts the TCP open. Since either PAC or PNS may originate a\n   connection,\
    \ it is possible for a TCP collision to occur.  See section\n   3.1.3 for a description\
    \ of this situation.\n"
- title: 3.1.1.  Control Connection Originator (may be PAC or PNS)
  contents:
  - "3.1.1.  Control Connection Originator (may be PAC or PNS)\n                TCP\
    \ Open Indication\n                /Send Start Control\n                  Connection\
    \ Request       +-----------------+\n     +------------------------------------>|\
    \  wait_ctl_reply |\n     |                                     +-----------------+\n\
    \     |     Collision/See (4.1.3) Close TCP   V  V  V   Receive Start Ctl\n  \
    \   |       +-------------------------------+  |  |   Connection Reply\n     |\
    \       |                                  |  |   Version OK\n     ^       V \
    \                                 |  V\n"
- title: +-----------------+          Receive Start Ctl  | +-----------------+
  contents:
  - '+-----------------+          Receive Start Ctl  | +-----------------+

    '
- title: '|      idle       |          Connection Reply   | |   established   |'
  contents:
  - '|      idle       |          Connection Reply   | |   established   |

    '
- title: +-----------------+          Version Not OK     | +-----------------+
  contents:
  - "+-----------------+          Version Not OK     | +-----------------+\n     ^\
    \                                          |  V   Local Terminate\n     |    \
    \     Receive Stop Control             |  |   /Send Stop\n     |         Connection\
    \ Request               |  |    Control Request\n     |         /Send Stop Control\
    \ Reply         V  V\n     |          Close TCP                  +-----------------+\n\
    \     +-------------------------------------| wait_stop_reply |\n            \
    \                               +-----------------+\n   idle\n      The control\
    \ connection originator attempts to open a TCP\n      connection to the peer during\
    \ idle state. When the TCP connection\n      is open, the originator transmits\
    \ a send Start-Control-\n      Connection-Request and then enters the wait_ctl_reply\
    \ state.\n   wait_ctl_reply\n      The originator checks to see if another TCP\
    \ connection has been\n      requested from the same peer, and if so, handles\
    \ the collision\n      situation described in section 3.1.3.\n      When a Start-Control-Connection-Reply\
    \ is received, it is examined\n      for a compatible version. If the version\
    \ of the reply is lower\n      than the version sent in the request, the older\
    \ (lower) version\n      should be used provided it is supported.  If the version\
    \ in the\n      reply is earlier and supported, the originator moves to the\n\
    \      established state. If the version is earlier and not supported, a\n   \
    \   Stop-Control-Connection-Request SHOULD be sent to the peer and the\n     \
    \ originator moves into the wait_stop_reply state.\n   established\n      An established\
    \ connection may be terminated by either a local\n      condition or the receipt\
    \ of a Stop-Control-Connection-Request. In\n      the event of a local termination,\
    \ the originator MUST send a\n      Stop-Control-Connection-Request and enter\
    \ the wait_stop_reply\n      state.\n      If the originator receives a Stop-Control-Connection-Request\
    \ it\n      SHOULD send a Stop-Control-Connection-Reply and close the TCP\n  \
    \    connection making sure that the final TCP information has been\n      \"\
    pushed\" properly.\n   wait_stop_reply\n      If a Stop-Control-Connection-Reply\
    \ is received, the TCP connection\n      SHOULD be closed and the control connection\
    \ becomes idle.\n"
- title: 3.1.2.  Control connection Receiver (may be PAC or PNS)
  contents:
  - '3.1.2.  Control connection Receiver (may be PAC or PNS)

    '
- title: Receive Start Control Connection Request
  contents:
  - 'Receive Start Control Connection Request

    '
- title: Version Not OK/Send Start Control Connection
  contents:
  - 'Version Not OK/Send Start Control Connection

    '
- title: Reply with Error
  contents:
  - "Reply with Error\n  +--------+\n  |        |         Receive Control Connection\
    \ Request Version OK\n  |        |         /Send Start Control Connection Reply\n\
    \  |        |   +----------------------------------------+\n  ^        V   ^ \
    \                                       V\n"
- title: +-----------------+             Receive Start Ctl    +-----------------+
  contents:
  - '+-----------------+             Receive Start Ctl    +-----------------+

    '
- title: '|      Idle       |             Connection Request   |   Established   |'
  contents:
  - '|      Idle       |             Connection Request   |   Established   |

    '
- title: +-----------------+             /Send Stop Reply     +-----------------+
  contents:
  - "+-----------------+             /Send Stop Reply     +-----------------+\n  \
    \      ^      ^                 Close TCP           V  V Local Terminate\n   \
    \     |      +-------------------------------------+  | /Send Stop\n        |\
    \                                               |  Control Conn.\n        |  \
    \                                             V  Request\n        |          \
    \                           +-----------------+\n        +-------------------------------------|\
    \ Wait-Stop-Reply |\n                 Receive Stop Control         +-----------------+\n\
    \                 Connection Reply\n                 /Close TCP\n   idle\n   \
    \   The control connection receiver waits for a TCP open attempt on\n      port\
    \ 1723. When notified of an open TCP connection, it should\n      prepare to receive\
    \ PPTP messages.  When a Start-Control-\n      Connection-Request is received\
    \ its version field should be\n      examined. If the version is earlier than\
    \ the receiver's version\n      and the earlier version can be supported by the\
    \ receiver, the\n      receiver SHOULD send a Start-Control-Connection-Reply.\
    \ If the\n      version is earlier than the receiver's version and the version\n\
    \      cannot be supported, the receiver SHOULD send a Start-Connection-\n   \
    \   Reply message, close the TCP connection and remain in the idle\n      state.\
    \  If the receiver's version is the same as earlier than the\n      peer's, the\
    \ receiver SHOULD send a Start-Control-Connection-Reply\n      with the receiver's\
    \ version and enter the established state.\n   established\n      An established\
    \ connection may be terminated by either a local\n      condition or the reception\
    \ of a Stop-Control-Connection-Request.\n      In the event of a local termination,\
    \ the originator MUST send a\n      Stop-Control-Connection-Request and enter\
    \ the wait_stop_reply\n      state.\n      If the originator receives a Stop-Control-Connection-Request\
    \ it\n      SHOULD send a Stop-Control-Connection-Reply and close the TCP\n  \
    \    connection, making sure that the final TCP information has been\n      \"\
    pushed\" properly.\n   wait_stop_reply\n      If a Stop-Control-Connection-Reply\
    \ is received, the TCP connection\n      SHOULD be closed and the control connection\
    \ becomes idle.\n"
- title: 3.1.3.  Start Control Connection Initiation Request Collision
  contents:
  - "3.1.3.  Start Control Connection Initiation Request Collision\n   A PAC and PNS\
    \ must have only one control connection between them. It\n   is possible, however,\
    \ for a PNS and a PAC to simultaneously attempt\n   to establish a control connection\
    \ to each other. When a Start-\n   Control-Connection-Request is received on one\
    \ TCP connection and\n   another Start-Control-Connection-Request has already\
    \ been sent on\n   another TCP connection to the same peer, a collision has occurred.\n\
    \   The \"winner\" of the initiation race is the peer with the higher IP\n   address\
    \ (compared as 32 bit unsigned values, network number more\n   significant). For\
    \ example, if the peers 192.33.45.17 and 192.33.45.89\n   collide, the latter\
    \ will be declared the winner.  The loser will\n   immediately close the TCP connection\
    \ it initiated, without sending\n   any further PPTP control messages on it and\
    \ will respond to the\n   winner's request with a Start-Control-Connection-Reply\
    \ message. The\n   winner will wait for the Start-Control-Connection-Reply on\
    \ the\n   connection it initiated and also wait for a TCP termination\n   indication\
    \ on the connection the loser opened.  The winner MUST NOT\n   send any messages\
    \ on the connection the loser initiated.\n"
- title: 3.1.4.  Keep Alives and Timers
  contents:
  - "3.1.4.  Keep Alives and Timers\n   A control connection SHOULD be closed by closing\
    \ the underlying TCP\n   connection under the following circumstances:\n   1.\
    \ If a control connection is not in the established state (i.e.,\n      Start-Control-Connection-Request\
    \ and Start-Control-Connection-\n      Reply have not been exchanged), a control\
    \ connection SHOULD be\n      closed after 60 seconds by a peer waiting for a\
    \ Start-Control-\n      Connection-Request or Start-Control-Connection-Reply message.\n\
    \   2. If a peer's control connection is in the established state and has\n  \
    \    not received a control message for 60 seconds, it SHOULD send a\n      Echo-Request\
    \ message. If an Echo-Reply is not received 60 seconds\n      after the Echo-Request\
    \ message transmission, the control\n      connection SHOULD be closed.\n"
- title: 3.2.  Call States
  contents:
  - '3.2.  Call States

    '
- title: 3.2.1.  Timing considerations
  contents:
  - "3.2.1.  Timing considerations\n   Because of the real-time nature of telephone\
    \ signaling, both the PNS\n   and PAC should be implemented with multi-threaded\
    \ architectures such\n   that messages related to multiple calls are not serialized\
    \ and\n   blocked. The transit delay between the PAC and PNS should not exceed\n\
    \   one second. The call and connection state figures do not specify\n   exceptions\
    \ caused by timers. The implicit assumption is that since\n   the TCP-based control\
    \ connection is being verified with keep-alives,\n   there is less need to maintain\
    \ strict timers for call control\n   messages.\n   Establishing outbound international\
    \ calls, including the modem\n   training and negotiation sequences, may take\
    \ in excess of 1 minute so\n   the use of short timers is discouraged.\n   If\
    \ a state transition does not occur within 1 minute (except for\n   connections\
    \ in the idle or established states), the integrity of the\n   protocol processing\
    \ between the peers is suspect and the ENTIRE\n   CONTROL CONNECTION should be\
    \ closed and restarted. All Call IDs are\n   logically released whenever a control\
    \ connection is started. This\n   presumably also helps in preventing toll calls\
    \ from being \"lost\" and\n   never cleared.\n"
- title: 3.2.2.  Call ID Values
  contents:
  - "3.2.2.  Call ID Values\n   Each peer assigns a Call ID value to each user session\
    \ it requests or\n   accepts. This Call ID value MUST be unique for the tunnel\
    \ between the\n   PNS and PAC to which it belongs. Tunnels to other peers can\
    \ use the\n   same Call ID number so the receiver of a packet on a tunnel needs\
    \ to\n   associate a user session with a particular tunnel and Call ID.  It is\n\
    \   suggested that the number of potential Call ID values for each tunnel\n  \
    \ be at least twice as large as the maximum number of calls expected on\n   a\
    \ given tunnel.\n   A session is defined by the triple (PAC, PNS, Call ID).\n"
- title: 3.2.3.  Incoming Calls
  contents:
  - "3.2.3.  Incoming Calls\n   An Incoming-Call-Request message is generated by the\
    \ PAC when an\n   associated telephone line rings. The PAC selects a Call ID and\
    \ serial\n   number and indicates the call bearer type.  Modems should always\n\
    \   indicate analog call type.  ISDN calls should indicate digital when\n   unrestricted\
    \ digital service or rate adaption is used and analog if\n   digital modems are\
    \ involved. Dialing number, dialed number, and\n   subaddress may be included\
    \ in the message if they are available from\n   the telephone network.\n   Once\
    \ the PAC sends the Incoming-Call-Request, it waits for a response\n   from the\
    \ PNS but does not answer the call from the telephone network.\n   The PNS may\
    \ choose not to accept the call if:\n      -  No resources are available to handle\
    \ more sessions\n      -  The dialed, dialing, or subaddress fields are not indicative\
    \ of\n         an authorized user\n      -  The bearer service is not authorized\
    \ or supported\n   If the PNS chooses to accept the call, it responds with an\
    \ Incoming-\n   Call-Reply which also indicates window sizes (see section 4.2).\
    \ When\n   the PAC receives the Outgoing-Call-Reply, it attempts to connect the\n\
    \   call, assuming the calling party has not hung up. A final call\n   connected\
    \ message from the PAC to the PNS indicates that the call\n   states for both\
    \ the PAC and the PNS should enter the established\n   state.\n   When the dialed-in\
    \ client hangs up, the call is cleared normally and\n   the PAC sends a Call-Disconnect-Notify\
    \ message. If the PNS wishes to\n   clear a call, it sends a Call-Clear-Request\
    \ message and then waits\n   for a Call-Disconnect-Notify.\n"
- title: 3.2.3.1.  PAC Incoming Call States
  contents:
  - "3.2.3.1.  PAC Incoming Call States\n    Ring/Send Incoming Call Request     \
    \     +-----------------+\n  +----------------------------------------->|    wait_reply\
    \   |\n  |                                          +-----------------+\n  | \
    \          Receive Incoming Call Reply    V  V  V\n  |           Not Accepting\
    \                  |  |  |   Receive Incoming\n  |         +--------------------------------+\
    \  |  |   Call Reply Accept-\n  |         |    +------------------------------+\
    \  |   ing/Answer call;\n  |         |    |     Abort/Send Call             |\
    \   Send Call\n  ^         V    V     Disconnect Notify           V   Connected\n"
- title: +-----------------+                              +-----------------+
  contents:
  - '+-----------------+                              +-----------------+

    '
- title: '|      idle       |<-----------------------------|   established   |'
  contents:
  - '|      idle       |<-----------------------------|   established   |

    '
- title: +-----------------+  Receive Clear Call Request  +-----------------+
  contents:
  - "+-----------------+  Receive Clear Call Request  +-----------------+\n      \
    \               or telco call dropped\n                     or local disconnect\n\
    \                     /Send Call Disconnect Notify\n"
- title: 'The states associated with the PAC for incoming calls are:'
  contents:
  - "The states associated with the PAC for incoming calls are:\n   idle\n      The\
    \ PAC detects an incoming call on one of its telco interfaces.\n      Typically\
    \ this means an analog line is ringing or an ISDN TE has\n      detected an incoming\
    \ Q.931 SETUP message. The PAC sends an\n      Incoming-Call-Request message and\
    \ moves to the wait_reply state.\n   wait_reply\n      The PAC receives an Incoming-Call-Reply\
    \ message indicating non-\n      willingness to accept the call (general error\
    \ or don't accept) and\n      moves back into the idle state. If the reply message\
    \ indicates\n      that the call is accepted, the PAC sends an Incoming-Call-\n\
    \      Connected message and enters the established state.\n   established\n \
    \     Data is exchanged over the tunnel.  The call may be cleared\n      following:\n\
    \         An event on the telco connection. The PAC sends a\n         Call-Disconnect-Notify\
    \ message\n         Receipt of a Call-Clear-Request.  The PAC sends a\n      \
    \   Call-Disconnect-Notify message\n         A local reason. The PAC sends a Call-Disconnect-Notify\
    \ message.\n"
- title: 3.2.3.2.  PNS Incoming Call States
  contents:
  - "3.2.3.2.  PNS Incoming Call States\n  Receive Incoming Call Request\n  /Send\
    \ Incoming Call Reply                  +-----------------+\n   Not Accepting if\
    \ Error                    |   Wait-Connect  |\n  +-----+                    \
    \                +-----------------+\n  |     |     Receive Incoming Call Req.\
    \     ^  V  V\n  |     |     /Send Incoming Call Reply OK   |  |  |   Receive\
    \ Incoming\n  |     |   +--------------------------------+  |  |   Call Connect\n\
    \  ^     V   ^    V------------------------------+  V\n"
- title: +-----------------+  Receive Call Disconnect     +-----------------+
  contents:
  - '+-----------------+  Receive Call Disconnect     +-----------------+

    '
- title: '|      Idle       |  Notify                   +- |   Established   |'
  contents:
  - '|      Idle       |  Notify                   +- |   Established   |

    '
- title: +-----------------+                           |  +-----------------+
  contents:
  - "+-----------------+                           |  +-----------------+\n      \
    \  ^        ^                            |   V   Local Terminate\n        |  \
    \      +----------------------------+   |   /Send Call Clear\n        |      \
    \      Receive Call Disconnect      |    Request\n        |            Notify\
    \                       V\n        |                                      +-----------------+\n\
    \        +--------------------------------------| Wait-Disconnect |\n        \
    \             Receive Call Disconnect   +-----------------+\n                \
    \     Notify\n"
- title: 'The states associated with the PNS for incoming calls are:'
  contents:
  - "The states associated with the PNS for incoming calls are:\n   idle\n      An\
    \ Incoming-Call-Request message is received. If the request is\n      not acceptable,\
    \ an Incoming-Call-Reply is sent back to the PAC and\n      the PNS remains in\
    \ the idle state.  If the Incoming-Call-Request\n      message is acceptable,\
    \ an Incoming-Call-Reply is sent indicating\n      accept in the result code.\
    \ The session moves to the wait_connect\n      state.\n   wait_connect\n     \
    \ If the session is connected on the PAC, the PAC sends an incoming\n      call\
    \ connect message to the PNS which then moves into established\n      state. The\
    \ PAC may send a Call-Disconnect-Notify to indicate that\n      the incoming caller\
    \ could not be connected.  This could happen,\n      for example, if a telephone\
    \ user accidently places a standard\n      voice call to a PAC resulting in a\
    \ handshake failure on the called\n      modem.\n   established\n      The session\
    \ is terminated either by receipt of a Call-Disconnect-\n      Notify message\
    \ from the PAC or by sending a Call-Clear-Request.\n      Once a Call-Clear-Request\
    \ has been sent, the session enters the\n      wait_disconnect state.\n   wait_disconnect\n\
    \      Once a Call-Disconnect-Notify is received the session moves back\n    \
    \  to the idle state.\n"
- title: 3.2.4.  Outgoing Calls
  contents:
  - "3.2.4.  Outgoing Calls\n   Outgoing messages are initiated by a PNS and instruct\
    \ a PAC to place\n   a call on a telco interface. There are only two messages\
    \ for outgoing\n   calls: Outgoing-Call-Request and Outgoing-Call-Reply. The PNS\
    \ sends\n   an Outgoing-Call-Request specifying the dialed party phone number\
    \ and\n   subaddress as well as speed and window parameters. The PAC MUST\n  \
    \ respond to the Outgoing-Call-Request message with an Outgoing-Call-\n   Reply\
    \ message once the PAC determines that:\n      The call has been successfully\
    \ connected\n      A call failure has occurred for reasons such as: no interfaces\
    \ are\n      available for dial-out, the called party is busy or does not\n  \
    \    answer, or no dial tone is detected on the interface chosen for\n      dialing\n"
- title: 3.2.4.1.  PAC Outgoing Call States
  contents:
  - '3.2.4.1.  PAC Outgoing Call States

    '
- title: Receive Outgoing Call Request in Error
  contents:
  - 'Receive Outgoing Call Request in Error

    '
- title: /Send Outgoing Call Reply with Error
  contents:
  - "/Send Outgoing Call Reply with Error\n  |--------+\n  |        |         Receive\
    \ Outgoing Call Request No Error\n  |        |         /Off Hook; Dial\n  |  \
    \      |   +-----------------------------------------\n  ^        V   ^      \
    \                                  V\n"
- title: +-----------------+           Incomplete Call        +-----------------+
  contents:
  - '+-----------------+           Incomplete Call        +-----------------+

    '
- title: '|      idle       |           /Send Outgoing Call    |   wait_cs_ans   |'
  contents:
  - '|      idle       |           /Send Outgoing Call    |   wait_cs_ans   |

    '
- title: +-----------------+            Reply with Error      +-----------------+
  contents:
  - "+-----------------+            Reply with Error      +-----------------+\n  \
    \      ^      ^           or Recv. Call Clear Req.  V  V Telco Answer\n      \
    \  |      |              /Send Disconnect Notify|  | /Send Outgoing\n        |\
    \      +-------------------------------------+  |  Call Reply.\n        |    \
    \                                           V\n        |                     \
    \                +-----------------+\n        +-------------------------------------|\
    \   established   |\n                 Receive Call Clear Request   +-----------------+\n\
    \                 or local terminate\n                 or telco disconnect\n \
    \                /Hangup call and send\n                 Call Disconnect Notify\n\
    \   The states associated with the PAC for outgoing calls are:\n   idle\n    \
    \  Received Outgoing-Call-Request. If this is received in error,\n      respond\
    \ with an Outgoing-Call-Reply with error condition set.\n      Otherwise, allocate\
    \ physical channel to dial on. Place the\n      outbound call, wait for a connection,\
    \ and move to the wait_cs_ans\n      state.\n   wait_cs_ans\n      If the call\
    \ is incomplete, send an Outgoing-Call-Reply with a\n      non-zero Error Code.\
    \ If a timer expires on an outbound call, send\n      back an Outgoing-Call-Reply\
    \ with a non-zero Error Code. If a\n      circuit switched connection is established,\
    \ send an Outgoing-\n      Call-Reply indicating success.\n   established\n  \
    \    If a Call-Clear-Request is received, the telco call SHOULD be\n      released\
    \ via appropriate mechanisms and a Call-Disconnect-Notify\n      message SHOULD\
    \ BE sent to the PNS. If the call is disconnected by\n      the client or by the\
    \ telco interface, a Call-Disconnect-Notify\n      message SHOULD be sent to the\
    \ PNS.\n"
- title: 3.2.4.2.  PNS Outgoing Call States
  contents:
  - "3.2.4.2.  PNS Outgoing Call States\n                Open Indication         \
    \                     Abort/Send\n                /Send Outgoing Call        \
    \                  Call Clear\n                 Request                  +-----------------+Request\n\
    \        +-------------------------------->|    Wait-Reply   |----------+\n  \
    \      |                                 +-----------------+          |\n    \
    \    |     Receive Outgoing Call Reply   V     V   Receive Outgoing |\n      \
    \  |     with Error                    |     |   Call Reply       |\n        |\
    \   +-------------------------------+     |   No Error         |\n        ^  \
    \ V                                     V                    |\n"
- title: +-----------------+                              +-----------------+   |
  contents:
  - '+-----------------+                              +-----------------+   |

    '
- title: '|      Idle       |<-----------------------------|   Established   |   |'
  contents:
  - '|      Idle       |<-----------------------------|   Established   |   |

    '
- title: +-----------------+    Receive Call Disconnect   +-----------------+   |
  contents:
  - "+-----------------+    Receive Call Disconnect   +-----------------+   |\n  \
    \      ^              Notify                     V   Local Terminate  |\n    \
    \    |                                         |   /Send Call Clear |\n      \
    \  |                                         |    Request         |\n        |\
    \     Receive Call Disconnect             V                    |\n        |  \
    \   Notify                      +-----------------+          |\n        +---------------------------------|\
    \ Wait-Disconnect |<---------+\n                                          +-----------------+\n"
- title: 'The states associated with the PNS for outgoing calls are:'
  contents:
  - "The states associated with the PNS for outgoing calls are:\n   idle\n      An\
    \ Outgoing-Call-Request message is sent to the PAC and the\n      session moves\
    \ into the wait_reply state.\n   wait_reply\n      An Outgoing-Call-Reply is received\
    \ which indicates an error. The\n      session returns to idle state. No telco\
    \ call is active. If the\n      Outgoing-Call-Reply does not indicate an error,\
    \ the telco call is\n      connected and the session moves to the established\
    \ state.\n   established\n      If a Call-Disconnect-Notify is received, the telco\
    \ call has been\n      terminated for the reason indicated in the Result and Cause\
    \ Codes.\n      The session moves back to the idle state. If the PNS chooses to\n\
    \      terminate the session, it sends a Call-Clear-Request to the PAC\n     \
    \ and then enters the wait_disconnect state.\n   wait_disconnect\n      A session\
    \ disconnection is waiting to be confirmed by the PAC.\n      Once the PNS receives\
    \ the Call-Disconnect-Notify message, the\n      session enters idle state.\n"
- title: 4.  Tunnel Protocol Operation
  contents:
  - "4.  Tunnel Protocol Operation\n   The user data carried by the PPTP protocol\
    \ are PPP data packets.  PPP\n   packets are carried between the PAC and PNS,\
    \ encapsulated in GRE\n   packets which in turn are carried over IP.  The encapsulated\
    \ PPP\n   packets are essentially PPP data packets less any media specific\n \
    \  framing elements.  No HDLC flags, bit insertion, control characters,\n   or\
    \ control character escapes are included. No CRCs are sent through\n   the tunnel.\
    \ The IP packets transmitted over the tunnels between a PAC\n   and PNS has the\
    \ following general structure:\n      +--------------------------------+\n   \
    \   |          Media Header          |\n      +--------------------------------+\n\
    \      |           IP Header            |\n      +--------------------------------+\n\
    \      |           GRE Header           |\n      +--------------------------------+\n\
    \      |           PPP Packet           |\n      +--------------------------------+\n"
- title: 4.1.  Enhanced GRE header
  contents:
  - "4.1.  Enhanced GRE header\n   The GRE header used in PPTP is enhanced slightly\
    \ from that specified\n   in the current GRE protocol specification [1,2].  The\
    \ main difference\n   involves the definition of a new Acknowledgment Number field,\
    \ used to\n   determine if a particular GRE packet or set of packets has arrived\
    \ at\n   the remote end of the tunnel.  This Acknowledgment capability is not\n\
    \   used in conjunction with any retransmission of user data packets.  It\n  \
    \ is used instead to determine the rate at which user data packets are\n   to\
    \ be transmitted over the tunnel for a given user session.  The\n   format of\
    \ the enhanced GRE header is as follows:\n    0                   1          \
    \         2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0\
    \ 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |C|R|K|S|s|Recur|A| Flags | Ver |         Protocol Type         |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |    Key (HW) Payload Length    |       Key (LW) Call ID        |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                  Sequence Number (Optional)                   |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |               Acknowledgment Number (Optional)                |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   C\n      (Bit 0) Checksum Present.  Set to zero (0).\n   R\n      (Bit 1)\
    \ Routing Present.  Set to zero (0).\n   K\n      (Bit 2) Key Present.  Set to\
    \ one (1).\n   S\n      (Bit 3) Sequence Number Present.  Set to one (1) if a\
    \ payload\n      (data) packet is present.  Set to zero (0) if payload is not\n\
    \      present (GRE packet is an Acknowledgment only).\n   s\n      (Bit 4) Strict\
    \ source route present.  Set to zero (0).\n   Recur\n      (Bits 5-7) Recursion\
    \ control.  Set to zero (0).\n   A\n      (Bit 8) Acknowledgment sequence number\
    \ present.  Set to one (1) if\n      packet contains Acknowledgment Number to\
    \ be used for acknowledging\n      previously transmitted data.\n   Flags\n  \
    \    (Bits 9-12) Must be set to zero (0).\n   Ver\n      (Bits 13-15) Must contain\
    \ 1 (enhanced GRE).\n   Protocol Type\n      Set to hex 880B [8].\n   Key\n  \
    \    Use of the Key field is up to the implementation.  PPTP uses it as\n    \
    \  follows:\n         Payload Length\n            (High 2 octets of Key) Size\
    \ of the payload, not including\n            the GRE header\n         Call ID\n\
    \            (Low 2 octets) Contains the Peer's Call ID for the session\n    \
    \        to which this packet belongs.\n         Sequence Number\n           \
    \ Contains the sequence number of the payload.  Present if S\n            bit\
    \ (Bit 3) is one (1).\n         Acknowledgment Number\n            Contains the\
    \ sequence number of the highest numbered GRE\n            packet received by\
    \ the sending peer for this user session.\n            Present if A bit (Bit 8)\
    \ is one (1).\n         The payload section contains a PPP data packet without\
    \ any\n         media specific framing elements.\n         The sequence numbers\
    \ involved are per packet sequence numbers.\n         The sequence number for\
    \ each user session is set to zero at\n         session startup.  Each packet\
    \ sent for a given user session\n         which contains a payload (and has the\
    \ S bit (Bit 3) set to one)\n         is assigned the next consecutive sequence\
    \ number for that\n         session.\n         This protocol allows acknowledgments\
    \ to be carried with the\n         data and makes the overall protocol more efficient,\
    \ which in\n         turn requires less buffering of packets.\n"
- title: 4.2.  Sliding Window Protocol
  contents:
  - "4.2.  Sliding Window Protocol\n   The sliding window protocol used on the PPTP\
    \ data path is used for\n   flow control by each side of the data exchange.  The\
    \ enhanced GRE\n   protocol allows packet acknowledgments to be piggybacked on\
    \ data\n   packets.  Acknowledgments can also be sent separately from data\n \
    \  packets.  Again, the main purpose of the sliding window protocol is\n   for\
    \ flow control--retransmissions are not performed by the tunnel\n   peers.\n"
- title: 4.2.1.  Initial Window Size
  contents:
  - "4.2.1.  Initial Window Size\n   Although each side has indicated the maximum\
    \ size of its receive\n   window, it is recommended that a conservative approach\
    \ be taken when\n   beginning to transmit data.  The initial window size on the\n\
    \   transmitter is set to half the maximum size the receiver requested,\n   with\
    \ a minimum size of one packet.  The transmitter stops sending\n   packets when\
    \ the number of packets awaiting acknowledgment is equal\n   to the current window\
    \ size.  As the receiver successfully digests\n   each window, the window size\
    \ on the transmitter is bumped up by one\n   packet until the maximum is reached.\
    \  This method prevents a system\n   from flooding an already congested network\
    \ because no history has\n   been established.\n"
- title: 4.2.2.  Closing the Window
  contents:
  - "4.2.2.  Closing the Window\n   When a time-out does occur on a packet, the sender\
    \ adjusts the size\n   of the transmit window down to one half its value when\
    \ it failed.\n   Fractions are rounded up, and the minimum window size is one.\n"
- title: 4.2.3.  Opening the Window
  contents:
  - "4.2.3.  Opening the Window\n   With every successful transmission of a window's\
    \ worth of packets\n   without a time-out, the transmit window size is increased\
    \ by one\n   packet until it reaches the maximum window size that was sent by\
    \ the\n   other side when the call was connected.  As stated earlier, no\n   retransmission\
    \ is done on a time-out. After a time-out, the\n   transmission resumes with the\
    \ window starting at one half the size of\n   the transmit window when the time-out\
    \ occurred and adjusting upward\n   by one each time the transmit window is filled\
    \ with packets that are\n   all acknowledged without time-outs.\n"
- title: 4.2.4.  Window Overflow
  contents:
  - "4.2.4.  Window Overflow\n   When a receiver's window overflows with too many\
    \ incoming packets,\n   excess packets are thrown away.  This situation should\
    \ not arise if\n   the sliding window procedures are being properly followed by\
    \ the\n   transmitter and receiver. It is assumed that, on the transmit side,\n\
    \   packets are buffered for transmission and are no longer accepted from\n  \
    \ the packet source when the transmit buffer fills.\n"
- title: 4.2.5.  Multi-packet Acknowledgment
  contents:
  - "4.2.5.  Multi-packet Acknowledgment\n   One feature of the PPTP sliding window\
    \ protocol is that it allows the\n   acknowledgment of multiple packets with a\
    \ single acknowledgment. All\n   outstanding packets with a sequence number lower\
    \ or equal to the\n   acknowledgment number are considered acknowledged. Time-out\n\
    \   calculations are performed using the time the packet corresponding to\n  \
    \ the highest sequence number being acknowledged was transmitted.\n   Adaptive\
    \ time-out calculations are only performed when an\n   Acknowledgment is received.\
    \  When multi-packet acknowledgments are\n   used, the overhead of the adaptive\
    \ time-out algorithm is reduced. The\n   PAC is not required to transmit multi-packet\
    \ acknowledgments; it can\n   instead acknowledge each packet individually as\
    \ it is delivered to\n   the PPP client.\n"
- title: 4.3.  Out-of-sequence Packets
  contents:
  - "4.3.  Out-of-sequence Packets\n   Occasionally packets lose their sequencing\
    \ across a complicated\n   internetwork.  Say, for example that a PNS sends packets\
    \ 0 to 5 to a\n   PAC.  Because of rerouting in the internetwork, packet 4 arrives\
    \ at\n   the PAC before packet 3. The PAC acknowledges packet 4, and may\n   assume\
    \ packet 3 is lost. This acknowledgment grants window credit\n   beyond packet\
    \ 4.\n   When the PAC does receive packet 3, it MUST not attempt to transmit\n\
    \   it to the corresponding PPP client.  To do so could cause problems,\n   as\
    \ proper PPP protocol operation is premised upon receiving packets\n   in sequence.\
    \  PPP does properly deal with the loss of packets, but\n   not with reordering\
    \ so out of sequence packets between the PNS and\n   PAC MUST be silently discarded,\
    \ or they may be reordered by the\n   receiver.  When packet 5 comes in, it is\
    \ acknowledged by the PAC\n   since it has a higher sequence number than 4, which\
    \ was the last\n   highest packet acknowledged by the PAC.  Packets with duplicate\n\
    \   sequence numbers should never occur since the PAC and PNS never\n   retransmit\
    \ GRE packets.  A robust implementation will silently\n   discard duplicate GRE\
    \ packets, should it receive any.\n"
- title: 4.4.  Acknowledgment Time-Outs
  contents:
  - "4.4.  Acknowledgment Time-Outs\n   PPTP uses sliding windows and time-outs to\
    \ provide both user session\n   flow-control across the internetwork and to perform\
    \ efficient data\n   buffering to keep the PAC-PNS data channels full without\
    \ causing\n   receive buffer overflow.  PPTP requires that a time-out be used\
    \ to\n   recover from dropped data or acknowledgment packets.  The exact\n   implementation\
    \ of the time-out is vendor-specific.  It is suggested\n   that an adaptive time-out\
    \ be implemented with backoff for congestion\n   control.  The time-out mechanism\
    \ proposed here has the following\n   properties:\n      Independent time-outs\
    \ for each session. A device (PAC or PNS) will\n      have to maintain and calculate\
    \ time-outs for every active session.\n      An administrator-adjustable maximum\
    \ time-out, MaxTimeOut, unique\n      to each device.\n      An adaptive time-out\
    \ mechanism that compensates for changing\n      throughput.  To reduce packet\
    \ processing overhead, vendors may\n      choose not to recompute the adaptive\
    \ time-out for every received\n      acknowledgment.  The result of this overhead\
    \ reduction is that the\n      time-out will not respond as quickly to rapid network\
    \ changes.\n      Timer backoff on time-out to reduce congestion. The backed-off\n\
    \      timer value is limited by the configurable maximum time-out value.\n  \
    \    Timer backoff is done every time an acknowledgment time-out\n      occurs.\n\
    \   In general, this mechanism has the desirable behavior of quickly\n   backing\
    \ off upon a time-out and of slowly decreasing the time-out\n   value as packets\
    \ are delivered without time-outs.\n   Some definitions:\n      Packet Processing\
    \ Delay (PPD) is the amount of time required for\n      each side to process the\
    \ maximum amount of data buffered in their\n      receive packet sliding window.\
    \ The PPD is the value exchanged\n      between the PAC and PNS when a call is\
    \ established. For the PNS,\n      this number should be small.  For a PAC making\
    \ modem connections,\n      this number could be significant.\n      Sample is\
    \ the actual amount of time incurred receiving an\n      acknowledgment for a\
    \ packet. The Sample is measured, not\n      calculated.\n      Round-Trip Time\
    \ (RTT) is the estimated round-trip time for an\n      Acknowledgment to be received\
    \ for a given transmitted packet. When\n      the network link is a local network,\
    \ this delay will be minimal\n      (if not zero). When the network link is the\
    \ Internet, this delay\n      could be substantial and vary widely. RTT is adaptive:\
    \ it will\n      adjust to include the PPD and whatever shifting network delays\n\
    \      contribute to the time between a packet being transmitted and\n      receiving\
    \ its acknowledgment.\n      Adaptive Time-Out (ATO) is the time that must elapse\
    \ before an\n      acknowledgment is considered lost.  After a time-out, the sliding\n\
    \      window is partially closed and the ATO is backed off.\n   The Packet Processing\
    \ Delay (PPD) parameter is a 16-bit word\n   exchanged during the Call Control\
    \ phase that represents tenths of a\n   second (64 means 6.4 seconds). The protocol\
    \ only specifies that the\n   parameter is exchanged, it does not specify how\
    \ it is calculated. The\n   way values for PPD are calculated is implementation-dependent\
    \ and\n   need not be variable (static time-outs are allowed). The PPD must be\n\
    \   exchanged in the call connect sequences, even if it remains constant\n   in\
    \ an implementation. One possible way to calculate the PPD is:\n   PPD' = ((PPP_MAX_DATA_MTU\
    \ - Header) * WindowSize * 8) / ConnectRate\n   PPD = PPD' + PACFudge\n   Header\
    \ is the total size of the IP and GRE headers, which is 36. The\n   MTU is the\
    \ overall MTU for the internetwork link between the PAC and\n   PNS.  WindowSize\
    \ represents the number of packets in the sliding\n   window, and is implementation-dependent.\
    \ The latency of the\n   internetwork could be used to pick a window size sufficient\
    \ to keep\n   the current session's pipe full. The constant 8 converts octets\
    \ to\n   bits (assuming ConnectRate is in bits per second).  If ConnectRate is\n\
    \   in bytes per second, omit the 8.  PACFudge is not required but can be\n  \
    \ used to take overall processing overhead of the PAC into account.\n   The value\
    \ of PPD is used to seed the adaptive algorithm with the\n   initial RTT[n-1]\
    \ value.\n"
- title: 4.4.1.  Calculating Adaptive Acknowledgment Time-Out
  contents:
  - "4.4.1.  Calculating Adaptive Acknowledgment Time-Out\n   We still must decide\
    \ how much time to allow for acknowledgments to\n   return. If the time-out is\
    \ set too high, we may wait an unnecessarily\n   long time for dropped packets.\
    \ If the time-out is too short, we may\n   time out just before the acknowledgment\
    \ arrives. The acknowledgment\n   time-out should also be reasonable and responsive\
    \ to changing network\n   conditions.\n   The suggested adaptive algorithm detailed\
    \ below is based on the TCP\n   1989 implementation and is explained in [11].\
    \  'n' means this\n   iteration of the calculation, and 'n-1' refers to values\
    \ from the\n   last calculation.\n      DIFF[n] = SAMPLE[n] - RTT[n-1]\n     \
    \ DEV[n] = DEV[n-1] + (beta * (|DIFF[n]| - DEV[n-1]))\n      RTT[n] = RTT[n-1]\
    \ + (alpha * DIFF[n])\n      ATO[n] = MAX (MinTimeOut, MIN (RTT[n] +\n       \
    \        (chi * DEV[n]), MaxTimeOut))\n      DIFF represents the error between\
    \ the last estimated round-trip\n      time and the measured time. DIFF is calculated\
    \ on each iteration.\n      DEV is the estimated mean deviation. This approximates\
    \ the\n      standard deviation.  DEV is calculated on each iteration and\n  \
    \    stored for use in the next iteration. Initially, it is set to 0.\n      RTT\
    \ is the estimated round-trip time of an average packet. RTT is\n      ycalculated\
    \ on each iteration and stored for use in the next\n      iteration.  Initially,\
    \ it is set to PPD.\n      ATO is the adaptive time-out for the next transmitted\
    \ packet. ATO\n      is calculated on each iteration.  Its value is limited, by\
    \ the MIN\n      function, to be a maximum of the configured MaxTimeOut value.\n\
    \      Alpha is the gain for the average and is typically 1/8 (0.125).\n     \
    \ Beta is the gain for the deviation and is typically 1/4 (0.250).\n      Chi\
    \ is the gain for the time-out and is typically set to 4.\n   To eliminate division\
    \ operations for fractional gain elements, the\n   entire set of equations can\
    \ be scaled. With the suggested gain\n   constants, they should be scaled by 8\
    \ to eliminate all division.  To\n   simplify calculations, all gain values are\
    \ kept to powers of two so\n   that shift operations can be used in place of multiplication\
    \ or\n   division.\n"
- title: '4.4.2.  Congestion Control: Adjusting for Time-Out'
  contents:
  - "4.4.2.  Congestion Control: Adjusting for Time-Out\n   This section describes\
    \ how the calculation of ATO is modified in the\n   case where a time-out does\
    \ occur.  When a time-out occurs, the time-\n   out value should be adjusted rapidly\
    \ upward.  Although the GRE\n   packets are not retransmitted when a time-out\
    \ occurs, the time-out\n   should be adjusted up toward a maximum limit.  To compensate\
    \ for\n   shifting internetwork time delays, a strategy must be employed to\n\
    \   increase the time-out when it expires (notice that in addition to\n   increasing\
    \ the time-out, we are also shrinking the size of the window\n   as described\
    \ in the next section).  For an interval in which a time-\n   out occurs, the\
    \ new\n   ATO is calculated as:\n      RTT[n] = delta * RTT[n-1]\n      DEV[n]\
    \ = DEV[n-1]\n      ATO[n] = MAX (MinTimeOut, MIN (RTT[n] +\n               (chi\
    \ * DEV[n]), MaxTimeOut))\n   In this calculation of ATO, only the two values\
    \ that both contribute\n   to ATO and are stored for the next iteration are calculated.\
    \  RTT is\n   scaled by delta, and DEV is unmodified.  DIFF is not carried forward\n\
    \   and is not used in this scenario.  A value of 2 for Delta, the time-\n   out\
    \ gain factor for RTT, is suggested.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   The security of user data passed over the tunneled\
    \ PPP connection is\n   addressed by PPP, as is authentication of the PPP peers.\n\
    \   Because the PPTP control channel messages are neither authenticated\n   nor\
    \ integrity protected, it might be possible for an attacker to\n   hijack the\
    \ underlying TCP connection.  It is also possible to\n   manufacture false control\
    \ channel messages and alter genuine messages\n   in transit without detection.\n\
    \   The GRE packets forming the tunnel itself are not cryptographically\n   protected.\
    \  Because the PPP negotiations are carried out over the\n   tunnel, it may be\
    \ possible for an attacker to eavesdrop on and modify\n   those negotiations.\n\
    \   Unless the PPP payload data is cryptographically protected, it can be\n  \
    \ captured and read or modified.\n"
- title: 6.  Authors' Addresses
  contents:
  - "6.  Authors' Addresses\n   Kory Hamzeh\n   Ascend Communications\n   1275 Harbor\
    \ Bay Parkway\n   Alameda, CA 94502\n   EMail: kory@ascend.com\n   Gurdeep Singh\
    \ Pall\n   Microsoft Corporation\n   Redmond, WA\n   EMail: gurdeep@microsoft.com\n\
    \   William Verthein\n   U.S. Robotics/3Com\n   Jeff Taarud\n   Copper Mountain\
    \ Networks\n   W. Andrew Little\n   ECI Telematics\n   Glen Zorn\n   Microsoft\
    \ Corporation\n   Redmond, WA\n   EMail: glennz@microsoft.com\n"
- title: 7.  References
  contents:
  - "7.  References\n   [1]  Hanks, S., Li, T., Farinacci, D. and P. Traina, \"Generic\
    \ Routing\n        Encapsulation (GRE)\", RFC 1701, October 1994.\n   [2]  Hanks,\
    \ S., Li, T., Farinacci, D. and P. Traina, \"Generic Routing\n        Encapsulation\
    \ (GRE) over IPv4 Networks\", RFC 1702, October 1994.\n   [3]  Lloyd, B. and W.\
    \ Simpson, \"PPP Authentication Protocols\", RFC\n        1334, October 1992.\n\
    \   [4]  Postel, J., \"Transmission Control Protocol\", STD 7, RFC 793,\n    \
    \    September 1981.\n   [5]  Postel, J., \"User Data Protocol\", STD 6, RFC 768,\
    \ August 1980.\n   [6]  Reynolds, J. and J. Postel, \"Assigned Numbers\", STD\
    \ 2, RFC 1700,\n        October 1994.  See also: http://www.iana.org/numbers.html\n\
    \   [7]  Simpson, W., editor, \"The Point-to-Point Protocol (PPP)\", STD\n   \
    \     51, RFC 1661, July 1994.\n   [8]  Ethertype for PPP, Reserved with Xerox\
    \ Corporation.\n   [9]  Simpson, W., \"PPP Challenge Handshake Authentication\
    \ Protocol\n        (CHAP)\", RFC 1994, August 1996.\n   [10] Blunk, L. and J\
    \ Vollbrecht, \"PPP Extensible Authentication\n        Protocol (EAP)\", RFC 2284,\
    \ March 1998.\n   [11] Stevens, R., \"TCP/IP Illustrated, Volume 1\", p. 300,\
    \ Addison-\n        Wesley, 1994.\n   [12] Bradner, S., \"Key words for use in\
    \ RFCs to Indicate Requirement\n        Levels\", BCP 14, RFC 2119, March 1997.\n"
- title: 8. Full Copyright Statement
  contents:
  - "8. Full Copyright Statement\n   Copyright (C) The Internet Society (1999).  All\
    \ Rights Reserved.\n   This document and translations of it may be copied and\
    \ furnished to\n   others, and derivative works that comment on or otherwise explain\
    \ it\n   or assist in its implementation may be prepared, copied, published\n\
    \   and distributed, in whole or in part, without restriction of any\n   kind,\
    \ provided that the above copyright notice and this paragraph are\n   included\
    \ on all such copies and derivative works.  However, this\n   document itself\
    \ may not be modified in any way, such as by removing\n   the copyright notice\
    \ or references to the Internet Society or other\n   Internet organizations, except\
    \ as needed for the purpose of\n   developing Internet standards in which case\
    \ the procedures for\n   copyrights defined in the Internet Standards process\
    \ must be\n   followed, or as required to translate it into languages other than\n\
    \   English.\n   The limited permissions granted above are perpetual and will\
    \ not be\n   revoked by the Internet Society or its successors or assigns.\n \
    \  This document and the information contained herein is provided on an\n   \"\
    AS IS\" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING\n   TASK FORCE\
    \ DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING\n   BUT NOT LIMITED\
    \ TO ANY WARRANTY THAT THE USE OF THE INFORMATION\n   HEREIN WILL NOT INFRINGE\
    \ ANY RIGHTS OR ANY IMPLIED WARRANTIES OF\n   MERCHANTABILITY OR FITNESS FOR A\
    \ PARTICULAR PURPOSE.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
