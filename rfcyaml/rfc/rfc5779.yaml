- contents:
  - "         Diameter Proxy Mobile IPv6: Mobile Access Gateway and\n         Local
    Mobility Anchor Interaction with Diameter Server\n"
  title: __initial_text__
- contents:
  - "Abstract\n   This specification defines Authentication, Authorization, and\n
    \  Accounting (AAA) interactions between Proxy Mobile IPv6 entities\n   (both
    Mobile Access Gateway and Local Mobility Anchor) and a AAA\n   server within a
    Proxy Mobile IPv6 Domain.  These AAA interactions are\n   primarily used to download
    and update mobile node specific policy\n   profile information between Proxy Mobile
    IPv6 entities and a remote\n   policy store.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    5741.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc5779.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1. Introduction ....................................................4\n
    \  2. Terminology and Abbreviations ...................................4\n   3.
    Solution Overview ...............................................5\n   4. Generic
    Application Support and Command Codes ...................6\n      4.1. MAG-to-HAAA
    Interface ......................................6\n      4.2. LMA-to-HAAA Interface
    ......................................7\n           4.2.1. General Operation and
    Authorization of PBU ..........7\n           4.2.2. Updating LMA Address to HAAA
    ........................8\n           4.2.3. Mobile Node Address Update and Assignment
    ...........8\n   5. Attribute Value Pair Definitions ................................9\n
    \     5.1. MIP6-Agent-Info AVP ........................................9\n      5.2.
    PMIP6-IPv4-Home-Address AVP ...............................10\n      5.3. MIP6-Home-Link-Prefix
    AVP .................................10\n      5.4. PMIP6-DHCP-Server-Address
    AVP .............................10\n      5.5. MIP6-Feature-Vector AVP ...................................10\n
    \     5.6. Mobile-Node-Identifier AVP ................................11\n      5.7.
    Calling-Station-Id AVP ....................................12\n      5.8. Service-Selection
    AVP .....................................12\n      5.9. Service-Configuration
    AVP .................................13\n   6. Proxy Mobile IPv6 Session Management
    ...........................13\n      6.1. Session-Termination-Request ...............................14\n
    \     6.2. Session-Termination-Answer ................................14\n      6.3.
    Abort-Session-Request .....................................14\n      6.4. Abort-Session-Answer
    ......................................14\n   7. Attribute Value Pair Occurrence
    Tables .........................14\n      7.1. MAG-to-HAAA Interface .....................................15\n
    \     7.2. LMA-to-HAAA Interface .....................................15\n   8.
    Example Signaling Flows ........................................15\n   9. IANA
    Considerations ............................................17\n      9.1. Attribute
    Value Pair Codes ................................17\n      9.2. Namespaces ................................................17\n
    \  10. Security Considerations .......................................17\n   11.
    Acknowledgements ..............................................17\n   12. References
    ....................................................18\n      12.1. Normative
    References .....................................18\n      12.2. Informative References
    ...................................18\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   This specification defines Authentication, Authorization,
    and\n   Accounting (AAA) interactions between a Mobile Access Gateway (MAG)\n
    \  and a AAA server, and between a Local Mobility Anchor (LMA) and a AAA\n   server
    within a Proxy Mobile IPv6 (PMIPv6) Domain [RFC5213].  These\n   AAA interactions
    are primarily used to download and update mobile\n   node (MN) specific policy
    profile information between PMIPv6 entities\n   (a MAG and an LMA) and a remote
    policy store.\n   Dynamic assignment and downloading of an MN's policy profile\n
    \  information to a MAG from a remote policy store is a desirable\n   feature
    to ease the deployment and network maintenance of larger\n   PMIPv6 domains.  For
    this purpose, the same AAA infrastructure that\n   is used for authenticating
    and authorizing the MN for a network\n   access can be leveraged to download some
    or all of the necessary\n   policy profile information to the MAG.\n   Once the
    network has authenticated the MN, the MAG sends a Proxy\n   Binding Update (PBU)
    to the LMA in order to set up a mobility session\n   on behalf of the MN.  When
    the LMA receives the PBU, the LMA may need\n   to authorize the received PBU against
    the AAA infrastructure.  The\n   same AAA infrastructure that can be used for
    the authorization of the\n   PBU, is also used to update the remote policy store
    with the LMA-\n   provided MN specific mobility session-related information.\n
    \  In the context of this specification, the home AAA (HAAA) server\n   functionality
    is co-located with the remote policy store.  The NAS\n   functionality may be
    co-located with the MAG function in the network\n   access router.  Diameter [RFC3588]
    is the used AAA protocol.\n"
  title: 1.  Introduction
- contents:
  - "2.  Terminology and Abbreviations\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\",
    \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\",
    and \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC
    2119 [RFC2119].\n   The general terminology used in this document can be found
    in\n   [RFC5213] and [NETLMM-PMIP6].  The following additional or clarified\n
    \  terms are also used in this document:\n   Network Access Server (NAS):\n      A
    device that provides an access service for a user to a network.\n      In the
    context of this document, the NAS may be integrated into or\n      co-located
    to a MAG.  The NAS contains a Diameter client function.\n   Home AAA (HAAA):\n
    \     An Authentication, Authorization, and Accounting (AAA) server\n      located
    in user's home network.  A HAAA is essentially a Diameter\n      server.\n"
  title: 2.  Terminology and Abbreviations
- contents:
  - "3.  Solution Overview\n   This document addresses the AAA interactions and AAA-based
    session\n   management functionality needed in the PMIPv6 Domain.  This document\n
    \  defines Diameter-based AAA interactions between the MAG and the HAAA,\n   and
    between the LMA and the HAAA.\n   The policy profile is downloaded from the HAAA
    to the MAG during the\n   MN attachment to the PMIPv6 Domain.  Figure 1 shows
    the participating\n   network entities.  This document, however, concentrates
    on the MAG,\n   LMA, and the HAAA (the home Diameter server).\n    +--------+\n
    \   | HAAA & | Diameter +-----+\n    | Policy |<---(2)-->| LMA |\n    | Store
    \ |          +-----+\n    +--------+             | <--- LMA-Address\n         ^
    \                |\n         |               // \\\\\n     +---|-------------
    //---\\\\----------------+\n    (    |  IPv4/IPv6  //     \\\\                )\n
    \   (    |   Network  //       \\\\               )\n     +---|-----------//---------\\\\-------------+\n
    \        |          //           \\\\\n     Diameter      // <- Tunnel1  \\\\
    <- Tunnel2\n        (1)       //               \\\\\n         |        |- MAG1-Address
    \  |- MAG2-Address\n         |     +----+             +----+\n         +---->|MAG1|
    \            |MAG2|\n               +----+             +----+\n                  |
    \                |\n                  |                 |\n                [MN1]
    \            [MN2]\n   Legend:\n     (1): MAG-to-HAAA interaction is described
    in Section 7.1\n     (2): LMA-to-HAAA interaction is described in Section 7.2\n
    \             Figure 1: Proxy Mobile IPv6 Domain Interaction\n                         with
    Diameter HAAA Server\n   When an MN attaches to a PMIPv6 Domain, a network access\n
    \  authentication procedure is usually started.  The choice of the\n   authentication
    mechanism is specific to the access network\n   deployment, but could be based
    on the Extensible Authentication\n   Protocol (EAP) [RFC3748].  During the network
    access authentication\n   procedure, the MAG acting as a NAS queries the HAAA
    through the AAA\n   infrastructure using the Diameter protocol.  If the HAAA detects
    that\n   the subscriber is also authorized for the PMIPv6 service, PMIPv6\n   specific
    information is returned along with the successful network\n   access authentication
    answer to the MAG.\n   After the MN has been successfully authenticated, the MAG
    sends a PBU\n   to the LMA based on the MN's policy profile information.  Upon\n
    \  receiving the PBU, the LMA interacts with the HAAA and fetches the\n   relevant
    parts of the subscriber policy profile and authorization\n   information related
    to the mobility service session.  In this\n   specification, the HAAA has the
    role of the PMIPv6 remote policy\n   store.\n"
  title: 3.  Solution Overview
- contents:
  - "4.  Generic Application Support and Command Codes\n   This specification does
    not define new Application-IDs or Command\n   Codes for the MAG-to-HAAA or for
    the LMA-to-HAAA Diameter\n   connections.  Rather, this specification is generic
    to any Diameter\n   application (and their commands) that is suitable for a network\n
    \  access authentication and authorization.  Example applications\n   include
    NASREQ [RFC4005] and EAP [RFC4072].\n"
  - contents:
    - "4.1.  MAG-to-HAAA Interface\n   The MAG-to-HAAA interactions are primarily
      used for bootstrapping\n   PMIPv6 mobility service session when an MN attaches
      and authenticates\n   to a PMIPv6 Domain.  This includes the bootstrapping of
      PMIPv6\n   session-related information.  The same interface may also be used
      for\n   accounting.  The MAG acts as a Diameter client.\n   Whenever the MAG
      sends a Diameter request message to the HAAA, the\n   User-Name AVP SHOULD contain
      the MN's identity unless the identity is\n   being suppressed for policy reasons
      -- for example, when identity\n   hiding is in effect.  The MN identity, if
      available, MUST be in\n   Network Access Identifier (NAI) [RFC4282] format.
      \ At minimum, the\n   home realm of the MN MUST be available at the MAG when
      the network\n   access authentication takes place.  Otherwise, the MAG is not
      able to\n   route the Diameter request messages towards the correct HAAA.  The
      MN\n   identity used on the MAG-to-HAAA interface and in the User-Name AVP\n
      \  MAY entirely be related to the network access authentication, and\n   therefore
      not suitable to be used as the MN-ID mobility option value\n   in the subsequent
      PBU / Proxy Binding Acknowledgement (PBA) messages.\n   See the related discussion
      on MN identities in Sections 4.2 and 5.6.\n   For the session management and
      service authorization purposes,\n   session state SHOULD be maintained on the
      MAG-to-HAAA interface.  See\n   the discussion in Section 5.8.\n"
    title: 4.1.  MAG-to-HAAA Interface
  - contents:
    - "4.2.  LMA-to-HAAA Interface\n   The LMA-to-HAAA interface may be used for multiple
      purposes.  These\n   include the authorization of the incoming PBU, updating
      the LMA\n   address to the HAAA, delegating the assignment of the MN-HNP (home\n
      \  network prefix) or the IPv4-HoA (home address) to the HAAA, and for\n   accounting
      and PMIPv6 session management.  The primary purpose of\n   this interface is
      to update the HAAA with the LMA address information\n   in case of dynamically
      assigned LMA, and exchange the MN address\n   assignment information between
      the LMA and the HAAA.\n   The LMA-to-HAAA interface description is intended
      for different types\n   of deployments and architectures.  Therefore, this specification
      only\n   outlines AVPs and considerations that the deployment specific\n   Diameter
      applications need to take into account from the PMIPv6 and\n   LMA's point of
      view.\n"
    - contents:
      - "4.2.1.  General Operation and Authorization of PBU\n   Whenever the LMA sends
        a Diameter request message to the HAAA, the\n   User-Name AVP SHOULD contain
        the MN's identity.  The LMA-provided\n   identity in the User-Name AVP is
        strongly RECOMMENDED to be the same\n   as the MN's identity information in
        the PBU MN-ID [RFC4283] [RFC5213]\n   mobility option.  The identity SHOULD
        also be the same as used on the\n   MAG-to-HAAA interface, but in case those
        identities differ the HAAA\n   MUST have a mechanism of mapping the MN identity
        used on the MAG-to-\n   HAAA interface to the identity used on the LMA-to-HAAA
        interface.\n   If the PBU contains the MN Link-Layer Identifier option, the
        Calling-\n   Station-Id AVP SHOULD be included in the request message containing\n
        \  the received link-layer identifier.  Furthermore, if the PBU contains\n
        \  the Service Selection mobility option [RFC5149], the Service-\n   Selection
        AVP SHOULD be included in the request message containing\n   the received
        service identifier.  Both the MN link-layer identifier\n   and the service
        selection can be used to provide more information for\n   the PBU authorization
        step in the HAAA.\n   The Auth-Request-Type AVP MUST be set to the value AUTHORIZE_ONLY.\n
        \  The Diameter session-related aspects discussed in Section 6 need to\n   be
        taken into consideration when designing the Diameter application\n   for the
        LMA-to-HAAA interface.  If the HAAA is not able to authorize\n   the subscriber's
        mobility service session, then the reply message to\n   the LMA MUST have
        the Result-Code AVP set to value\n   DIAMETER_AUTHORIZATION_REJECTED (5003)
        indicating a permanent\n   failure.  A failed authorization obviously results
        in a rejection of\n   the PBU, and a PBA with an appropriate error Status
        Value MUST be\n   sent back to the MAG.\n   The authorization step MUST be
        performed at least for the initial PBU\n   session up to a mobility session,
        when the LMA-to-HAAA interface is\n   deployed.  For the subsequent re-registration
        and handover PBUs, the\n   authorization step MAY be repeated (in this case,
        the LMA-to-HAAA\n   interface should also maintain an authorization session
        state).\n"
      title: 4.2.1.  General Operation and Authorization of PBU
    - contents:
      - "4.2.2.  Updating LMA Address to HAAA\n   In case of a dynamic LMA discovery
        and assignment [NETLMM-LMA], the\n   HAAA and the remote policy store may
        need to be updated with the\n   selected LMA address information.  The update
        can be done during the\n   PBU authorization step using the LMA-to-HAAA interface.
        \ This\n   specification uses the MIP6-Agent-Info AVP and its MIP-Home-Agent-\n
        \  Address and MIP-Home-Agent-Host sub-AVPs for carrying the LMA's\n   address
        information from the LMA to the HAAA.  The LMA address\n   information in
        the request message MUST contain the IP address of the\n   LMA or the Fully
        Qualified Domain Name (FQDN) identifying uniquely\n   the LMA, or both.  The
        LMA address information refers to the PMIPv6\n   part of the LMA, not necessarily
        the LMA part interfacing with the\n   AAA infrastructure.\n   This specification
        does not define any HAAA-initiated LMA relocation\n   functionality.  Therefore,
        when the MIP6-Agent-Info AVP is included\n   in Diameter answer messages sent
        from the HAAA to the LMA, the HAAA\n   indicates this by setting the MIP-Home-Agent-Address
        AVP to all\n   zeroes address (e.g., 0::0) and not including the MIP-Home-Agent-Host\n
        \  AVP.\n"
      title: 4.2.2.  Updating LMA Address to HAAA
    - contents:
      - "4.2.3.  Mobile Node Address Update and Assignment\n   The LMA and the HAAA
        use the MIP6-Home-Link-Prefix AVP to exchange\n   the MN-HNP when appropriate.
        \ Similarly, the LMA and the HAAA use the\n   PMIP6-IPv4-Home-Address AVP
        to exchange the IPv4-MN-HoA when\n   appropriate.  These AVPs are encapsulated
        inside the MIP6-Agent-Info\n   AVP.  The MN address information exchange is
        again done during the\n   PBU authorization step.  The HAAA MAY also use the
        LMA-provided MN\n   address information as a part of the information used
        to authorize\n   the PBU.\n   Which entity is actually responsible for the
        address management is\n   deployment specific within the PMIPv6 Domain and
        MUST be pre-agreed\n   on per deployment basis.  When the LMA is responsible
        for the address\n   management, the MIP6-Agent-Info AVP is used to inform
        the HAAA and\n   the remote policy store of the MN-HNP/IPv4-MN-HoA assigned
        to the MN.\n   It is also possible that the LMA delegates the address management
        to\n   the HAAA.  In this case, the MN-HNP/IPv4-MN-HoA are set to undefined\n
        \  addresses (as described in Section 5.1) in the Diameter request\n   message
        sent from the LMA to the HAAA.  The LMA expects to receive\n   the HAAA assigned
        HNP/IPv4-MN-HoA in the corresponding Diameter\n   answer message.\n"
      title: 4.2.3.  Mobile Node Address Update and Assignment
    title: 4.2.  LMA-to-HAAA Interface
  title: 4.  Generic Application Support and Command Codes
- contents:
  - "5.  Attribute Value Pair Definitions\n   This section describes Attribute Value
    Pairs (AVPs) defined by this\n   specification or re-used from existing specifications
    in a PMIPv6\n   specific way.  Derived Diameter AVP Data Formats such as Address
    and\n   UTF8String are defined in Section 4.3 of [RFC3588].  Grouped AVP\n   values
    are defined in Section 4.4 of [RFC3588].\n"
  - contents:
    - "5.1.  MIP6-Agent-Info AVP\n   The MIP6-Agent-Info grouped AVP (AVP Code 486)
      is defined in\n   [RFC5447].  The AVP is used to carry LMA addressing-related\n
      \  information and an MN-HNP.  This specification extends the MIP6-\n   Agent-Info
      with the PMIP6-IPv4-Home-Address AVP using the Diameter\n   extensibility rules
      defined in [RFC3588].  The PMIP6-IPv4-Home-\n   Address AVP contains the IPv4-MN-HoA.\n
      \  The extended MIP6-Agent-Info AVP results in the following grouped\n   AVP.
      \ The grouped AVP has the following modified ABNF (as defined in\n   [RFC3588]):\n
      \      MIP6-Agent-Info ::= < AVP-Header: 486 >\n                         *2[
      MIP-Home-Agent-Address ]\n                           [ MIP-Home-Agent-Host ]\n
      \                          [ MIP6-Home-Link-Prefix ]\n                           [
      PMIP6-IPv4-Home-Address ]\n                         * [ AVP ]\n   If the MIP-Home-Agent-Address
      is set to all zeroes address (e.g.,\n   0::0), the receiver of the MIP6-Agent-Info
      AVP MUST ignore the MIP-\n   Home-Agent-Address AVP.\n"
    title: 5.1.  MIP6-Agent-Info AVP
  - contents:
    - "5.2.  PMIP6-IPv4-Home-Address AVP\n   The PMIP6-IPv4-Home-Address AVP (AVP
      Code 505) is of type Address and\n   contains an IPv4 address.  This AVP is
      used to carry the IPv4-MN-HoA,\n   if available, from the HAAA to the MAG.  This
      AVP SHOULD only be\n   present when the MN is statically provisioned with the
      IPv4-MN-HoA.\n   Note that proactive dynamic assignment of the IPv4-MN-HoA by
      the HAAA\n   may result in unnecessary reservation of IPv4 address resources,\n
      \  because the MN may considerably delay or completely bypass its IPv4\n   address
      configuration.\n   The PMIP6-IPv4-Home-Address AVP is also used on the LMA-to-HAAA\n
      \  interface.  The AVP contains the IPv4-MN-HoA assigned to the MN.  If\n   the
      LMA delegates the assignment of the IPv4-MN-HoA to the HAAA, the\n   AVP MUST
      contain all zeroes IPv4 address (i.e., 0.0.0.0) in the\n   request message.
      \ If the LMA delegated the IPv4-MN-HoA assignment to\n   the HAAA, then the
      AVP contains the HAAA assigned IPv4-MN-HoA in the\n   response message.\n"
    title: 5.2.  PMIP6-IPv4-Home-Address AVP
  - contents:
    - "5.3.  MIP6-Home-Link-Prefix AVP\n   The MIP6-Home-Link-Prefix AVP (AVP Code
      125) is defined in [RFC5447].\n   This AVP is used to carry the MN-HNP, if available,
      from the HAAA to\n   the MAG.  The low 64 bits of the prefix MUST be all zeroes.\n
      \  The MIP6-Home-Link-Prefix AVP is also used on the LMA-to-HAAA\n   interface.
      \ The AVP contains the prefix assigned to the MN.  If the\n   LMA delegates
      the assignment of the MN-HNP to the HAAA, the AVP MUST\n   contain all zeroes
      address (i.e., 0::0) in the request message.  If\n   the LMA delegated the MN-HNP
      assignment to the HAAA, then the AVP\n   contains the HAAA-assigned MN-HNP in
      the response message.\n"
    title: 5.3.  MIP6-Home-Link-Prefix AVP
  - contents:
    - "5.4.  PMIP6-DHCP-Server-Address AVP\n   The PMIP6-DHCP-Server-Address AVP (AVP
      Code 504) is of type Address\n   and contains the IP address of the Dynamic
      Host Configuration\n   Protocol (DHCP) server assigned to the MAG serving the
      newly attached\n   MN.  If the AVP contains a DHCPv4 [RFC2131] server address,
      then the\n   Address type MUST be IPv4.  If the AVP contains a DHCPv6 [RFC3315]\n
      \  server address, then the Address type MUST be IPv6.  The HAAA MAY\n   assign
      a DHCP server to the MAG in deployments where the MAG acts as\n   a DHCP Relay
      [NETLMM-PMIP6].\n"
    title: 5.4.  PMIP6-DHCP-Server-Address AVP
  - contents:
    - "5.5.  MIP6-Feature-Vector AVP\n   The MIP6-Feature-Vector AVP is originally
      defined in [RFC5447].  This\n   document defines new capability flag bits according
      to the IANA rules\n   in RFC 5447.\n   PMIP6_SUPPORTED (0x0000010000000000)\n
      \     When the MAG/NAS sets this bit in the MIP6-Feature-Vector AVP, it\n      is
      an indication to the HAAA that the NAS supports PMIPv6.  When\n      the HAAA
      sets this bit in the response MIP6-Feature-Vector AVP, it\n      indicates that
      the HAAA also has PMIPv6 support.  This capability\n      bit can also be used
      to allow PMIPv6 mobility support in a\n      subscription granularity.\n   IP4_HOA_SUPPORTED
      (0x0000020000000000)\n      Assignment of the IPv4-MN-HoA is supported.  When
      the MAG sets\n      this bit in the MIP6-Feature-Vector AVP, it indicates that
      the MAG\n      implements a minimal functionality of a DHCP server (and a relay)\n
      \     and is able to deliver IPv4-MN-HoA to the MN.  When the HAAA sets\n      this
      bit in the response MIP6-Feature-Vector AVP, it indicates\n      that the HAAA
      has authorized the use of IPv4-MN-HoA for the MN.\n      If this bit is unset
      in the returned MIP6-Feature-Vector AVP, the\n      HAAA does not authorize
      the configuration of IPv4 address.\n   LOCAL_MAG_ROUTING_SUPPORTED (0x0000040000000000)\n
      \     Direct routing of IP packets between MNs anchored to the same MAG\n      is
      supported as described in Sections 6.10.3 and 9.2 of [RFC5213].\n      When
      a MAG sets this bit in the MIP6-Feature-Vector, it indicates\n      that routing
      IP packets between MNs anchored to the same MAG is\n      supported, without
      reverse tunneling packets via the LMA or\n      requiring any Route Optimization-related
      signaling (e.g., the\n      Return Routability Procedure in [RFC3775]) prior
      direct routing.\n      If this bit is cleared in the returned MIP6-Feature-Vector
      AVP,\n      the HAAA does not authorize direct routing of packets between MNs\n
      \     anchored to the same MAG.  The MAG SHOULD support this policy\n      feature
      on a per-MN and per-subscription basis.\n   The MIP6-Feature-Vector AVP is also
      used on the LMA-to-HAAA\n   interface.  Using the capability announcement AVP
      it is possible to\n   perform a simple capability negotiation between the LMA
      and the HAAA.\n   Those capabilities that are announced by both parties are
      also known\n   to be mutually supported.  The capabilities listed in earlier
      are\n   also supported in the LMA-to-HAAA interface.  The LMA-to-HAAA\n   interface
      does not define any new capability values.\n"
    title: 5.5.  MIP6-Feature-Vector AVP
  - contents:
    - "5.6.  Mobile-Node-Identifier AVP\n   The Mobile-Node-Identifier AVP (AVP Code
      506) is of type UTF8String\n   and contains the mobile node identifier (MN-Identifier;
      see\n   [RFC5213]) in the NAI [RFC4282] format.  This AVP is used on the MAG-\n
      \  to-HAAA interface.  The Mobile-Node-Identifier AVP is designed for\n   deployments
      where the MAG does not have a way to find out such MN\n   identity that could
      be used in subsequent PBU/PBA exchanges (e.g.,\n   due to identity hiding during
      the network access authentication) or\n   the HAAA wants to assign periodically
      changing identities to the MN.\n   The Mobile-Node-Identifier AVP is returned
      in the answer message that\n   ends a successful authentication (and possibly
      an authorization)\n   exchange between the MAG and the HAAA, assuming the HAAA
      is also able\n   to provide the MAG with the MN-Identifier in the first place.
      \ The\n   MAG MUST use the received MN-Identifier, if it has not been able to\n
      \  get the mobile node identifier through other means.  If the MAG\n   already
      has a valid mobile node identifier, then the MAG MUST\n   silently discard the
      received MN-Identifier.\n"
    title: 5.6.  Mobile-Node-Identifier AVP
  - contents:
    - "5.7.  Calling-Station-Id AVP\n   The Calling-Station-Id AVP (AVP Code 31) is
      of type UTF8String and\n   contains a link-layer identifier of the MN.  This
      identifier\n   corresponds to the link-layer identifier as defined in RFC 5213,\n
      \  Sections 2.2 and 8.6.  The Link-Layer Identifier is encoded in ASCII\n   format
      (upper case only), with octet values separated by a \"-\".\n   Example: \"00-23-32-C9-79-38\".
      \ The encoding is actually the same as\n   the MAC address encoding in Section
      3.21 of RFC 3580.\n"
    title: 5.7.  Calling-Station-Id AVP
  - contents:
    - "5.8.  Service-Selection AVP\n   The Service-Selection AVP (AVP Code 493) is
      of type UTF8String and\n   contains an LMA-provided service identifier on the
      LMA-to-HAAA\n   interface.  This AVP is re-used from [RFC5778].  The service\n
      \  identifier may be used to assist the PBU authorization and the\n   assignment
      of the MN-HNP and the IPv4-MN-HoA as described in RFC 5149\n   [RFC5149].  The
      identifier MUST be unique within the PMIPv6 Domain.\n   In the absence of the
      Service-Selection AVP in the request message,\n   the HAAA may want to inform
      the LMA of the default service\n   provisioned to the MN and include the Service-Selection
      AVP in the\n   response message.\n   It is also possible that the MAG receives
      the service selection\n   information from the MN, for example, via some lower
      layer mechanism.\n   In this case, the MAG MUST include the Service-Selection
      AVP also in\n   the MAG-to-HAAA request messages.  In the absence of the Service-\n
      \  Selection AVP in the MAG-to-HAAA request messages, the HAAA may want\n   to
      inform the MAG of the default service provisioned to the MN and\n   include
      the Service-Selection AVP in the response message.\n   Whenever the Service-Selection
      AVP is included either in a request\n   message or in a response message, and
      the AAA interaction with HAAA\n   completes successfully, it is an indication
      that the HAAA also\n   authorized the MN to some service.  This should be taken
      into account\n   when considering what to include in the Auth-Request-Type AVP.\n
      \  The service selection concept supports signaling one service at time.\n   However,
      the MN policy profile MAY support multiple services being\n   used simultaneously.
      \ For this purpose, the HAAA MAY return multiple\n   LMA and service pairs (see
      Section 5.9) to the MAG in a response\n   message that ends a successful authentication
      (and possibly an\n   authorization) exchange between the MAG and the HAAA.  Whenever
      the\n   MN initiates an additional mobility session to another service (using\n
      \  a link layer or deployment specific method), the provisioned service\n   information
      is already contained in the MAG.  Therefore, there is no\n   need for additional
      AAA signaling between the MAG and the HAAA.\n"
    title: 5.8.  Service-Selection AVP
  - contents:
    - "5.9.  Service-Configuration AVP\n   The Service-Configuration AVP (AVP Code
      507) is of type Grouped and\n   contains a service and an LMA pair.  The HAAA
      can use this AVP to\n   inform the MAG of the MN's subscribed services and LMAs
      where those\n   services are hosted in.\n       Service-Configuration ::= <
      AVP-Header: 507 >\n                                 [ MIP6-Agent-Info ]\n                                 [
      Service-Selection ]\n                               * [ AVP ]\n"
    title: 5.9.  Service-Configuration AVP
  title: 5.  Attribute Value Pair Definitions
- contents:
  - "6.  Proxy Mobile IPv6 Session Management\n   Concerning a PMIPv6 mobility session,
    the HAAA, the MAG, and the LMA\n   Diameter entities SHOULD be stateful and maintain
    the corresponding\n   Authorization Session State Machine defined in [RFC3588].
    \ If a state\n   is maintained, then a PMIPv6 mobility session that can be identified\n
    \  by any of the Binding Cache Entry (BCE) Lookup Keys described in RFC\n   5213
    (see Sections 5.4.1.1, 5.4.1.2, and 5.4.1.3) MUST map to a\n   single Diameter
    Session-Id.  If the PMIPv6 Domain allows further\n   separation of sessions, for
    example, identified by the RFC 5213 BCE\n   Lookup Keys and the service selection
    combination (see Section 5.8\n   and [RFC5149]), then a single Diameter Session-Id
    MUST map to a\n   PMIPv6 mobility session identified by the RFC 5213 BCE Lookup
    Keys\n   and the selected service.\n   If both the MAG-to-HAAA and the LMA-to-HAAA
    interfaces are deployed\n   in a PMIPv6 Domain, and a state is maintained on both
    interfaces,\n   then one PMIPv6 mobility session would have two distinct Diameter\n
    \  sessions on the HAAA.  The HAAA needs to be aware of this deployment\n   possibility
    and SHOULD allow multiple Diameter sessions for the same\n   PMIPv6 mobility session.\n
    \  Diameter session termination-related commands described in the\n   following
    sections may be exchanged between the LMA and the HAAA, or\n   between the MAG
    and the HAAA.  The actual PMIPv6 session termination\n   procedures take place
    at the PMIPv6 protocol level and are described\n   in more detail in RFC 5213
    and [MEXT-BINDING].\n"
  - contents:
    - "6.1.  Session-Termination-Request\n   The LMA or the MAG MAY send the Session-Termination-Request
      (STR)\n   command [RFC3588] to inform the HAAA that the termination of an\n
      \  ongoing PMIPv6 session is in progress.\n"
    title: 6.1.  Session-Termination-Request
  - contents:
    - "6.2.  Session-Termination-Answer\n   The Session-Termination-Answer (STA) [RFC3588]
      is sent by the HAAA to\n   acknowledge the termination of a PMIPv6 session.\n"
    title: 6.2.  Session-Termination-Answer
  - contents:
    - "6.3.  Abort-Session-Request\n   The HAAA MAY send the Abort-Session-Request
      (ASR) command [RFC3588]\n   to the LMA or to the MAG and request termination
      of a PMIPv6 session.\n"
    title: 6.3.  Abort-Session-Request
  - contents:
    - "6.4.  Abort-Session-Answer\n   The Abort-Session-Answer (ASA) command [RFC3588]
      is sent by the LMA\n   or the MAG to acknowledge the termination of a PMIPv6
      session.\n"
    title: 6.4.  Abort-Session-Answer
  title: 6.  Proxy Mobile IPv6 Session Management
- contents:
  - "7.  Attribute Value Pair Occurrence Tables\n   The following tables list the
    PMIPv6 MAG-to-HAAA interface and LMA-\n   to-HAAA interface AVPs including those
    that are defined in [RFC5447].\n   Figure 2 contains the AVPs and their occurrences
    on the MAG-to-HAAA\n   interface.  The AVPs that are part of grouped AVP are not
    listed in\n   the table; rather, only the grouped AVP is listed.\n"
  - contents:
    - "7.1.  MAG-to-HAAA Interface\n                                     +---------------+\n
      \                                    |  Command-Code |\n                                     |-------+-------+\n
      \     Attribute Name                 |  REQ  |  ANS  |\n      -------------------------------+-------+-------+\n
      \     PMIP6-DHCP-Server-Address      |   0   |  0+   |\n      MIP6-Agent-Info
      \               |  0+   |  0+   |\n      MIP6-Feature-Vector            |  0-1
      \ |  0-1  |\n      Mobile-Node-Identifier         |  0-1  |  0-1  |\n      Calling-Station-Id
      \            |  0-1  |   0   |\n      Service-Selection              |  0-1
      \ |   0   |\n      Service-Configuration          |   0   |  0+   |\n                                     +-------+-------+\n
      \        Figure 2: MAG-to-HAAA Interface Generic Diameter Request\n                         and
      Answer Commands AVPs\n"
    title: 7.1.  MAG-to-HAAA Interface
  - contents:
    - "7.2.  LMA-to-HAAA Interface\n                                     +---------------+\n
      \                                    |  Command-Code |\n                                     |-------+-------+\n
      \     Attribute Name                 |  REQ  |  ANS  |\n      -------------------------------+-------+-------+\n
      \     MIP6-Agent-Info                |  0-1  |  0-1  |\n      MIP6-Feature-Vector
      \           |  0-1  |  0-1  |\n      Calling-Station-Id             |  0-1  |
      \  0   |\n      Service-Selection              |  0-1  |  0-1  |\n      User-Name
      \                     |  0-1  |  0-1  |\n                                     +-------+-------+\n
      \        Figure 3: LMA-to-HAAA Interface Generic Diameter Request\n                         and
      Answer Commands AVPs\n"
    title: 7.2.  LMA-to-HAAA Interface
  title: 7.  Attribute Value Pair Occurrence Tables
- contents:
  - "8.  Example Signaling Flows\n   Figure 4 shows a signaling flow example during
    PMIPv6 bootstrapping\n   using the AAA interactions defined in this specification.
    \ In step\n   (1) of this example, the MN is authenticated to the PMIPv6 Domain\n
    \  using EAP-based authentication.  The MAG to the HAAA signaling uses\n   the
    Diameter EAP Application.  During step (2), the LMA uses the\n   Diameter NASREQ
    application to authorize the MN with the HAAA server.\n   The MAG-to-HAAA AVPs,
    as listed in Section 7.1, are used during step\n   (1).  These AVPs are included
    only in the Diameter EAP Request (DER)\n   message which starts the EAP exchange
    and in the corresponding\n   Diameter EAP Answer (DEA) message which successfully
    completes this\n   EAP exchange.  The LMA-to-HAAA AVPs, as listed in Section 7.2,
    are\n   used during step (2).  Step (2) is used to authorize the MN request\n
    \  for the mobility service and update the HAAA server with the assigned\n   LMA
    information.  In addition, this step may be used to dynamically\n   assist in
    the assignment of the MN-HNP.\n   MN                 MAG/NAS                LMA
    \                 HAAA\n   |                     |                    |                    |\n
    \  | L2 attach           |                    |                    |\n   |-------------------->|
    \                   |                    |\n   | EAP/req-identity    |                    |
    \                   |\n   |<--------------------|                    |                    |\n
    \  | EAP/res-identity    | DER + MAG-to-HAAA AVPs                  | s\n   |-------------------->|---------------------------------------->|
    t\n   | EAP/req #1          | DEA (EAP request #1)                    | e\n   |<--------------------|<----------------------------------------|
    p\n   | EAP/res #2          | DER (EAP response #2)                   |\n   |-------------------->|---------------------------------------->|
    1\n   :                     :                    :                    :\n   :
    \                    :                    :                    :\n   | EAP/res
    #N          | DER (EAP response #N)                   |\n   |-------------------->|---------------------------------------->|\n
    \  | EAP/success         | DEA (EAP success) + MAG-to-HAAA AVPs    |\n   |<--------------------|<----------------------------------------|\n
    \  :                     :                    :                    :\n   :                     :
    \                   :                    :\n   |                     | PMIPv6
    PBU         | AAR +              | s\n   |                     |------------------->|
    LMA-to-HAAA AVPs   | t\n   |                     |                    |------------------->|
    e\n   |                     |                    | AAA +              | p\n   |
    \                    |                    | LMA-to-HAAA AVPs   |\n   |                     |
    PMIPv6 PBA         |<-------------------| 2\n   | RA                  |<-------------------|
    \                   |\n   |<--------------------|                    |                    |\n
    \  :                     :                    :                    :\n   :                     :
    \                   :                    :\n   | IP connectivity     | PMIPv6
    tunnel up   |                    |\n   |---------------------|====================|
    \                   |\n   |                     |                    |                    |\n
    \       Figure 4: MAG and LMA Signaling Interaction with AAA Server\n                        during
    PMIPv6 Bootstrapping\n"
  title: 8.  Example Signaling Flows
- contents:
  - '9.  IANA Considerations

    '
  - contents:
    - "9.1.  Attribute Value Pair Codes\n   This specification defines the following
      new AVPs:\n     PMIP6-DHCP-Server-Address   504\n     PMIP6-IPv4-Home-Address
      \    505\n     Mobile-Node-Identifier      506\n     Service-Configuration       507\n"
    title: 9.1.  Attribute Value Pair Codes
  - contents:
    - "9.2.  Namespaces\n   This specification defines new values to the Mobility
      Capability\n   registry (see [RFC5447]) for use with the MIP6-Feature-Vector
      AVP:\n   Token                            | Value                | Description\n
      \  ---------------------------------+----------------------+------------\n   PMIP6_SUPPORTED
      \                 | 0x0000010000000000   | [RFC5779]\n   IP4_HOA_SUPPORTED                |
      0x0000020000000000   | [RFC5779]\n   LOCAL_MAG_ROUTING_SUPPORTED      | 0x0000040000000000
      \  | [RFC5779]\n"
    title: 9.2.  Namespaces
  title: 9.  IANA Considerations
- contents:
  - "10.  Security Considerations\n   The security considerations of the Diameter
    Base protocol [RFC3588],\n   Diameter EAP application [RFC4072], Diameter NASREQ
    application\n   [RFC4005], and Diameter Mobile IPv6 integrated scenario bootstrapping\n
    \  [RFC5447] are applicable to this document.\n   In general, the Diameter messages
    may be transported between the LMA\n   and the Diameter server via one or more
    AAA brokers or Diameter\n   agents.  In this case, the LMA to the Diameter server
    AAA\n   communication rely on the security properties of the intermediate AAA\n
    \  brokers and Diameter agents (such as proxies).\n"
  title: 10.  Security Considerations
- contents:
  - "11.  Acknowledgements\n   Jouni Korhonen would like to thank the TEKES GIGA program
    MERCoNe-\n   project for providing funding to work on this document while he was\n
    \  with TeliaSonera.  The authors also thank Pasi Eronen, Peter McCann,\n   Spencer
    Dawkins, and Marco Liebsch for their detailed reviews of this\n   document.\n"
  title: 11.  Acknowledgements
- contents:
  - '12.  References

    '
  - contents:
    - "12.1.  Normative References\n   [RFC2119]       Bradner, S., \"Key words for
      use in RFCs to Indicate\n                   Requirement Levels\", BCP 14, RFC
      2119, March 1997.\n   [RFC3588]       Calhoun, P., Loughney, J., Guttman, E.,
      Zorn, G., and\n                   J. Arkko, \"Diameter Base Protocol\", RFC
      3588,\n                   September 2003.\n   [RFC4005]       Calhoun, P., Zorn,
      G., Spence, D., and D. Mitton,\n                   \"Diameter Network Access
      Server Application\",\n                   RFC 4005, August 2005.\n   [RFC4072]
      \      Eronen, P., Hiller, T., and G. Zorn, \"Diameter\n                   Extensible
      Authentication Protocol (EAP)\n                   Application\", RFC 4072, August
      2005.\n   [RFC4282]       Aboba, B., Beadles, M., Arkko, J., and P. Eronen,\n
      \                  \"The Network Access Identifier\", RFC 4282,\n                   December
      2005.\n   [RFC5213]       Gundavelli, S., Leung, K., Devarapalli, V.,\n                   Chowdhury,
      K., and B. Patil, \"Proxy Mobile IPv6\",\n                   RFC 5213, August
      2008.\n   [RFC5447]       Korhonen, J., Bournelle, J., Tschofenig, H., Perkins,\n
      \                  C., and K. Chowdhury, \"Diameter Mobile IPv6: Support\n                   for
      Network Access Server to Diameter Server\n                   Interaction\",
      RFC 5447, February 2009.\n   [RFC5778]       Korhonen, J., Ed., Tschofenig,
      H., Bournelle, J.,\n                   Giaretta, G., and M. Nakhjiri, \"Diameter
      Mobile IPv6:\n                   Support for Home Agent to Diameter Server\n
      \                  Interaction\", RFC 5778, February 2010.\n"
    title: 12.1.  Normative References
  - contents:
    - "12.2.  Informative References\n   [MEXT-BINDING]  Muhanna, A., Khalil, M.,
      Gundavelli, S., Chowdhury,\n                   K., and P. Yegani, \"Binding
      Revocation for IPv6\n                   Mobility\", Work in Progress, October
      2009.\n   [NETLMM-LMA]    Korhonen, J. and V. Devarapalli, \"LMA Discovery for\n
      \                  Proxy Mobile IPv6\", Work in Progress, September 2009.\n
      \  [NETLMM-PMIP6]  Wakikawa, R. and S. Gundavelli, \"IPv4 Support for\n                   Proxy
      Mobile IPv6\", Work in Progress, September 2009.\n   [RFC2131]       Droms,
      R., \"Dynamic Host Configuration Protocol\",\n                   RFC 2131, March
      1997.\n   [RFC3315]       Droms, R., Bound, J., Volz, B., Lemon, T., Perkins,\n
      \                  C., and M. Carney, \"Dynamic Host Configuration\n                   Protocol
      for IPv6 (DHCPv6)\", RFC 3315, July 2003.\n   [RFC3748]       Aboba, B., Blunk,
      L., Vollbrecht, J., Carlson, J.,\n                   and H. Levkowetz, \"Extensible
      Authentication Protocol\n                   (EAP)\", RFC 3748, June 2004.\n
      \  [RFC3775]       Johnson, D., Perkins, C., and J. Arkko, \"Mobility\n                   Support
      in IPv6\", RFC 3775, June 2004.\n   [RFC4283]       Patel, A., Leung, K., Khalil,
      M., Akhtar, H., and K.\n                   Chowdhury, \"Mobile Node Identifier
      Option for Mobile\n                   IPv6 (MIPv6)\", RFC 4283, November 2005.\n
      \  [RFC5149]       Korhonen, J., Nilsson, U., and V. Devarapalli,\n                   \"Service
      Selection for Mobile IPv6\", RFC 5149,\n                   February 2008.\n"
    title: 12.2.  Informative References
  title: 12.  References
- contents:
  - "Authors' Addresses\n   Jouni Korhonen (editor)\n   Nokia Siemens Network\n   Linnoitustie
    6\n   Espoo  FI-02600\n   Finland\n   EMail: jouni.nospam@gmail.com\n   Julien
    Bournelle\n   Orange Labs\n   38-4O rue du general Leclerc\n   Issy-Les-Moulineaux
    \ 92794\n   France\n   EMail: julien.bournelle@orange-ftgroup.com\n   Kuntal Chowdhury\n
    \  Cisco Systems\n   30 International Place\n   Tewksbury, MA  01876\n   USA\n
    \  EMail: kchowdhury@cisco.com\n   Ahmad Muhanna\n   Ericsson, Inc.\n   2201 Lakeside
    Blvd.\n   Richardson, TX  75082\n   USA\n   EMail: Ahmad.muhanna@ericsson.com\n
    \  Ulrike Meyer\n   RWTH Aachen\n   EMail: meyer@umic.rwth-aachen.de\n"
  title: Authors' Addresses
