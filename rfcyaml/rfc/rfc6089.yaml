- contents:
  - ' Flow Bindings in Mobile IPv6 and Network Mobility (NEMO) Basic Support

    '
  title: __initial_text__
- contents:
  - "Abstract\n   This document introduces extensions to Mobile IPv6 that allow nodes\n
    \  to bind one or more flows to a care-of address.  These extensions\n   allow
    multihomed nodes to instruct home agents and other Mobile IPv6\n   entities to
    direct inbound flows to specific addresses.\n"
  title: Abstract
- contents:
  - "Status of This Memo\n   This is an Internet Standards Track document.\n   This
    document is a product of the Internet Engineering Task Force\n   (IETF).  It represents
    the consensus of the IETF community.  It has\n   received public review and has
    been approved for publication by the\n   Internet Engineering Steering Group (IESG).
    \ Further information on\n   Internet Standards is available in Section 2 of RFC
    5741.\n   Information about the current status of this document, any errata,\n
    \  and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6089.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified
    as the\n   document authors.  All rights reserved.\n   This document is subject
    to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n
    \  (http://trustee.ietf.org/license-info) in effect on the date of\n   publication
    of this document.  Please review these documents\n   carefully, as they describe
    your rights and restrictions with respect\n   to this document.  Code Components
    extracted from this document must\n   include Simplified BSD License text as described
    in Section 4.e of\n   the Trust Legal Provisions and are provided without warranty
    as\n   described in the Simplified BSD License.\n"
  title: Copyright Notice
- contents:
  - "Table of Contents\n   1.  Introduction . . . . . . . . . . . . . . . . . . .
    . . . . . .  3\n   2.  Requirements Notation  . . . . . . . . . . . . . . . .
    . . . .  4\n   3.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .
    . .  4\n   4.  Mobile IPv6 Extensions . . . . . . . . . . . . . . . . . . . .
    \ 5\n     4.1.  Definition Update for Binding Identifier Mobility\n           Option
    . . . . . . . . . . . . . . . . . . . . . . . . . .  5\n     4.2.  Flow Identification
    Mobility Option  . . . . . . . . . . .  5\n       4.2.1.  Flow Identification
    Sub-Options Definition . . . . . .  7\n       4.2.2.  Flow Summary Mobility Option
    . . . . . . . . . . . . . 11\n     4.3.  Flow Bindings Entries List and Its Relationship
    to\n           Binding Cache  . . . . . . . . . . . . . . . . . . . . . . 12\n
    \  5.  Protocol Operations  . . . . . . . . . . . . . . . . . . . . . 14\n     5.1.
    \ General  . . . . . . . . . . . . . . . . . . . . . . . . . 14\n       5.1.1.
    \ Preferred Care-of Address  . . . . . . . . . . . . . . 15\n     5.2.  Mobile
    Node Considerations . . . . . . . . . . . . . . . . 15\n       5.2.1.  Sending
    BU with BID Options  . . . . . . . . . . . . . 15\n       5.2.2.  Sending BU with
    Flow Identification Mobility\n               Options  . . . . . . . . . . . .
    . . . . . . . . . . . 16\n       5.2.3.  Sending BU with a Flow Summary Option
    \ . . . . . . . . 17\n       5.2.4.  Removing Flow Bindings . . . . . . . . .
    . . . . . . . 18\n       5.2.5.  Returning Home . . . . . . . . . . . . . . .
    . . . . . 18\n       5.2.6.  Receiving Binding Acknowledgements . . . . . . .
    . . . 19\n       5.2.7.  Return Routability Procedure . . . . . . . . . . . .
    . 19\n     5.3.  HA, MAP, and CN Considerations . . . . . . . . . . . . . . 19\n
    \      5.3.1.  Handling Binding Identifier Mobility Options . . . . . 20\n       5.3.2.
    \ Handling Flow Identification Mobility Options  . . . . 20\n       5.3.3.  Handling
    Flow Summary Mobility Option  . . . . . . . . 23\n       5.3.4.  Flow Binding
    Removals  . . . . . . . . . . . . . . . . 23\n       5.3.5.  Sending Binding Acknowledgements
    . . . . . . . . . . . 24\n       5.3.6.  Packet Processing  . . . . . . . . .
    . . . . . . . . . 24\n   6.  MTU Considerations . . . . . . . . . . . . . . .
    . . . . . . . 25\n   7.  Security considerations  . . . . . . . . . . . . . .
    . . . . . 26\n   8.  IANA Considerations  . . . . . . . . . . . . . . . . . .
    . . . 27\n   9.  Contributors . . . . . . . . . . . . . . . . . . . . . . . .
    . 28\n   10. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 29\n
    \  11. References . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n     11.1.
    Normative References . . . . . . . . . . . . . . . . . . . 29\n     11.2. Informative
    References . . . . . . . . . . . . . . . . . . 29\n"
  title: Table of Contents
- contents:
  - "1.  Introduction\n   Mobile IPv6 [RFC3775], Dual-Stack MIPv6 (DSMIPv6) [RFC5555],
    and\n   Network Mobility (NEMO) Basic Support [RFC3963] allow a mobile node /\n
    \  mobile router to manage its mobility using the binding update\n   message,
    which binds one care-of address to one home address and\n   associated mobile
    networks.  The binding update message can be sent\n   to the home agent.  In Mobile
    IPv6, the binding update can also be\n   sent to a correspondent node or to a
    mobility anchor point (see\n   [RFC5380]).  The semantics of the binding update
    are limited to\n   care-of address changes.  That is, [RFC3775], [RFC5555], and\n
    \  [RFC3963] do not allow a mobile node / mobile router to bind more\n   than
    one address to the home address.  In [RFC5648], Mobile IPv6 and\n   NEMO Basic
    Support are extended to allow the binding of more than one\n   care-of address
    to a home address.  This specification further\n   extends Mobile IPv6, DSMIPv6,
    and NEMO Basic Support to allow them to\n   specify policies associated with each
    binding.  A policy can contain\n   a request for special treatment of a particular
    IPv4 or IPv6 flow,\n   which is viewed as a group of packets matching a traffic
    selector.\n   Hence, this specification allows a mobile node / mobile router to\n
    \  bind a particular flow to a care-of address without affecting other\n   flows
    using the same home address.  In addition, this specification\n   allows to bind
    a particular flow to a particular care-of address\n   directly with correspondent
    node and mobility agents (i.e., home\n   agents [RFC3775] and mobility anchor
    points [RFC5380]).\n   In this document, a flow is defined as a set of IP packets
    matching a\n   traffic selector.  A traffic selector can identify the source and\n
    \  destination IP addresses, transport protocol number, the source and\n   destination
    port numbers and other fields in IP and higher-layer\n   headers.  This specification
    does not define traffic selectors, which\n   are going to be defined in other
    specifications.  This specification,\n   however, does define the traffic selector
    sub-option format to be\n   used for any specific traffic selector.\n   Using
    the flow identifier option introduced in this specification, a\n   mobile node
    / mobile router can bind one or more flows to a care-of\n   address while maintaining
    the reception of other flows on another\n   care-of address.  The mobile node
    / mobile router assembles the flow\n   binding requests based on local policies,
    link characteristics, and\n   the types of applications running at the time.  Such
    policies are\n   outside the scope of this document.\n   It should be noted that
    the flow identification mobility option can\n   be associated with any binding
    update, whether it is sent to a\n   mobility agent or a correspondent node.\n
    \  Note that per-packet load balancing may have negative impacts on TCP\n   congestion
    avoidance mechanisms as it is desirable to maintain order\n   between packets
    belonging to the same TCP connection.  This behavior\n   is specified in [RFC2702].
    \ Other negative impacts are also foreseen\n   for other types of real-time connections
    due to the potential\n   variations in round-trip time between packets.  Moreover,
    per-packet\n   load-balancing will negatively affect traffic with anti-replay\n
    \  protection mechanisms.  Hence, per-packet load balancing is not\n   envisioned
    in this specification.\n   In the rest of the document, the term \"mobile node\"
    is used to\n   designate either a mobile node as defined in [RFC3775] and [RFC5648],\n
    \  or a mobile router as defined in [RFC3963] unless stated otherwise.\n"
  title: 1.  Introduction
- contents:
  - "2.  Requirements Notation\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\",
    \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\",
    and \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n"
  title: 2.  Requirements Notation
- contents:
  - "3.  Terminology\n   Terms used in this document are defined in [RFC3753] and
    [RFC4885].\n   The following terms are also used in this document:\n      Flow:
    A flow is a sequence of packets for which the mobile node\n      (MN) desires
    special handling either by the home agent (HA), the\n      corresponding node
    (CN) or the mobility anchor point (MAP).\n      Traffic Selector: One or more
    parameters that can be matched\n      against fields in the packet's headers for
    the purpose of\n      classifying a packet.  Examples of such parameters include
    the\n      source and destination IP addresses, transport protocol number,\n      the
    source and destination port numbers, and other fields in IP\n      and higher-layer
    headers.\n      Flow binding: It consists of a traffic selector, and one or more\n
    \     binding identifiers (BIDs).  IP packets from one or more flows\n      that
    match the traffic selector associated with the flow binding\n      are forwarded
    to the BIDs associated with the same flow binding.\n      Flow Identifier: A flow
    identifier uniquely identifies a flow\n      binding associated with a mobile
    node.  It is generated by a\n      mobile node and is cached in the table of flow
    binding entries\n      maintained by the MN, HA, CN, or MAP.\n"
  title: 3.  Terminology
- contents:
  - "4.  Mobile IPv6 Extensions\n   This section introduces extensions to Mobile IPv6
    that are necessary\n   for supporting the flow binding mechanism described in
    this document.\n"
  - contents:
    - "4.1.  Definition Update for Binding Identifier Mobility Option\n   This specification
      updates the definition of the Binding Identifier\n   Mobility option defined
      in [RFC5648], as follows:\n                            1                   2
      \                  3\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
      3 4 5 6 7 8 9 0 1\n                                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \                                      |   Type = 35   |     Length    |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \      |       Binding ID (BID)        |     Status    |H|   BID-PRI   |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-------------------------------+\n
      \      +                                                               +\n       :
      \                IPv4 or IPv6 Care-of Address (CoA)            :\n       +                                                               +\n
      \      +---------------------------------------------------------------+\n             Figure
      1: The Binding Identifier Mobility Option\n      BID-PRI\n         This is a
      7-bit unsigned integer placing each BID to a relative\n         priority (PRI)
      with other registered BIDs.  Value '0' is\n         reserved and MUST NOT be
      used.  A lower number in this field\n         indicates a higher priority, while
      BIDs with the same BID-PRI\n         value have equal priority meaning that,
      the BID used is an\n         implementation issue.  This is consistent with
      current practice\n         in packet classifiers.\n"
    title: 4.1.  Definition Update for Binding Identifier Mobility Option
  - contents:
    - "4.2.  Flow Identification Mobility Option\n   The flow identification mobility
      option is a new mobility option\n   [RFC3775], and it is included in the binding
      update and\n   acknowledgement messages.  This option contains information that\n
      \  allows the receiver of a binding update to install policies on a\n   traffic
      flow and route it to a given care-of address.  Multiple\n   options may exist
      within the same binding update message.  The\n   alignment requirement for this
      option is 2n.\n        0                   1                   2                   3\n
      \       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \      | Option Type   |  Option Len   |              FID              |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \      |              FID-PRI          |   Reserved    |     Status    |\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \      |   Sub-options (optional) ...\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
      \            Figure 2: The Flow Identification Mobility Option\n      Option
      Type\n         45\n      Option Len\n         Length of the option in octets
      as per [RFC3775].\n      FID\n         The Flow Identifier field is a 16-bit
      unsigned integer that\n         includes the unique identifier for the flow
      binding.  This\n         field is used to refer to an existing flow binding
      or to create\n         a new flow binding.  The value of this field is set by
      the\n         mobile node.  FID = 0 is reserved and MUST NOT be used.\n      FID-PRI\n
      \        This is a 16-bit unsigned integer priority field to indicate\n         the
      priority of a particular option.  This field is needed in\n         cases where
      two different flow descriptions in two different\n         options overlap.
      \ The priority field decides which policy\n         should be executed in those
      cases.  A lower number in this\n         field indicates a higher priority.
      \ Value '0' is reserved and\n         MUST NOT be used.  FID-PRI MUST be unique
      to each of the flows\n         pertaining to a given MN.  In other words, two
      FIDs MUST NOT be\n         associated with the same FID-PRI value.\n      Status\n
      \        This 8-bit unsigned integer field indicates the success or\n         failure
      of the flow binding operation for the particular flow\n         in the option.
      \ This field is not relevant to the binding\n         update message as a whole
      or to other flow identification\n         options.  This field is only relevant
      when included in the\n         Binding Acknowledgement message and must be ignored
      in the\n         binding update message.  The following values are reserved
      for\n         the Status field within the flow identification mobility\n         option:\n
      \           0 Flow binding successful\n            128 Administratively prohibited\n
      \           129 Flow binding rejected, reason unspecified\n            130 Flow
      identification mobility option malformed\n            131 BID not found\n            132
      FID not found\n            133 Traffic selector format not supported\n      Sub-options
      (optional)\n         Zero or more sub-options, defined in Section 4.2.1.\n"
    - contents:
      - "4.2.1.  Flow Identification Sub-Options Definition\n   Flow identification
        sub-options are encoded within the remaining\n   space of the flow identification
        mobility option, using a sub-option\n   type-length-value (TLV) format as
        follows:\n       0                   1                   2                   3\n
        \      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \     | Sub-Opt Type  |Sub-Opt Length |   Sub-Option Data...\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \             Figure 3: Flow Identification Sub-Option Format\n      Sub-Opt
        Type\n         8-bit unsigned integer indicating the sub-option Type.  When\n
        \        processing a flow identification mobility option containing an\n
        \        option for which the sub-option Type value is not recognized by\n
        \        the receiver, the receiver MUST silently ignore and skip over\n         the
        sub-option, correctly handling any remaining sub-options in\n         the
        same option.\n      Sub-Opt Len\n         8-bit unsigned integer, representing
        the length in octets of\n         the flow identification sub-option.  This
        field indicates the\n         length of the sub-option not including the Sub-Opt
        Type and\n         Sub-Opt Length fields.  Note that Sub-Opt Type '0'\n         (Section
        4.2.1.1) is a special case that does not take a Sub-\n         Opt Length
        field.\n      Sub-Option Data\n         A variable length field that contains
        data specific to the sub-\n         option.\n   The following subsections
        specify the sub-option Types that are\n   currently defined for use in the
        flow identification option.\n   Implementations MUST silently ignore any sub-options
        that they do not\n   understand.\n   These sub-options may have alignment
        requirements.  Following the\n   convention in [RFC3775], regarding mobility
        options, these sub-\n   options are aligned in a packet so that multi-octet
        values within the\n   sub-option Data field of each sub-option fall on natural
        boundaries\n   (i.e., fields of width n octets are placed at an integer multiple
        of\n   n octets from the start of the header, for n = 1, 2, 4, or 8).\n"
      - contents:
        - "4.2.1.1.  Pad1\n   The Pad1 sub-option does not have any alignment requirements.
          \ Its\n   format is as follows:\n          0\n          0 1 2 3 4 5 6 7\n
          \        +-+-+-+-+-+-+-+-+\n         | Sub-Opt Type  |\n         +-+-+-+-+-+-+-+-+\n
          \  Sub-Opt Type\n      0\n   NOTE: The format of the Pad1 sub-option is
          a special case -- it has\n   neither sub-option Length nor sub-option Data
          fields.\n   The Pad1 sub-option is used to insert one octet of padding in
          the\n   flow identification option.  If more than one octet of padding is\n
          \  required, the PadN sub-option, described next, should be used rather\n
          \  than multiple Pad1 sub-options.\n"
        title: 4.2.1.1.  Pad1
      - contents:
        - "4.2.1.2.  PadN\n   The PadN sub-option does not have any alignment requirements.
          \ Its\n   format is as follows:\n          0                   1\n          0
          1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
          - - - - - - - -\n         | Sub-Opt Type  | Sub-Opt Len   | Option Data\n
          \        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- - - - - - - - -\n   Sub-Opt
          Type\n      1\n   Sub-Opt Len\n      Set to the length of the sub-option.\n
          \  Sub-Opt Data\n      0 or more bytes set to 0 by the sender and ignored
          by the\n      receiver.\n   The PadN sub-option is used to insert two or
          more octets of padding\n   in the flow identification mobility option.  For
          N octets of padding,\n   the sub-option Length field contains the value
          N, and the sub-option\n   Data field consists of N-2 zero-valued octets.
          \ PadN sub-option Data\n   MUST be ignored by the receiver.\n"
        title: 4.2.1.2.  PadN
      - contents:
        - "4.2.1.3.  Binding Reference Sub-Option\n   This section introduces the
          binding reference sub-option, included in\n   the flow identification mobility
          option.  A node MUST NOT include\n   more than one binding reference sub-options
          in a given flow binding\n   identification option.  The binding reference
          sub-option includes one\n   or more BIDs defined in Multiple Care-of Addresses
          (MCoA) [RFC5648].\n   This sub-option associates the flow described in a
          flow\n   identification mobility option with one or more registered BIDs.\n
          \  When binding a flow using this sub-option, the binding identifier\n   mobility
          option, defined in [RFC5648], MUST be included in either the\n   same or
          an earlier binding update (BU).  The binding reference sub-\n   option is
          shown below.  The alignment requirement for this sub-option\n   is 2n.\n
          \       0                   1                   2                   3\n
          \       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n
          \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
          \      |Sub-Opt Type   |  Sub-Opt Len  |              BID              |\n
          \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
          \      |     BID  ........\n       +-+-+-+-+-+-+-+-+-+-\n                Figure
          4: The Binding Reference Sub-Option\n      Sub-Opt Type\n         2\n      Sub-Opt
          Len\n         Variable\n      BID\n         A 16-bit unsigned integer indicating
          the BID that the mobile\n         node wants to associate with the flow
          identification option.\n         One or more BID fields can be included
          in this sub-option.\n         Since each BID is 2 bytes long, the value
          of the Sub-opt Len\n         field indicates the number of BIDs present.
          \ Number of BIDs =\n         Sub-Opt Len/2.\n"
        title: 4.2.1.3.  Binding Reference Sub-Option
      - contents:
        - "4.2.1.4.  Traffic Selector Sub-Option\n   The traffic selector sub-option
          includes the parameters used to match\n   packets for a specific flow binding.
          \ A node MUST NOT include more\n   than one traffic selector sub-option
          in a given flow binding\n   identification option.\n        0                   1
          \                  2                   3\n        0 1 2 3 4 5 6 7 8 9 0
          1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
          \      |Sub-Opt Type   |  Sub-Opt Len  |   TS Format   |   Reserved    |\n
          \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
          \      |  Traffic Selector ...\n       +-+-+-+-+-+-+-+-+-+-+-+\n                 Figure
          5: The Traffic Selector Sub-Option\n   Sub-Opt Type\n      3\n   Sub-Opt
          Len\n      Variable\n   TS Format\n      An 8-bit unsigned integer indicating
          the Traffic Selector Format.\n      Value \"0\" is reserved and MUST NOT
          be used.\n   Reserved\n      An 8-bit reserved field.  It MUST be set to
          zero by the sender and\n      ignored by the receiver.\n   Traffic Selector\n
          \     A variable-length field, the format and content of which is out of\n
          \     scope for this specification.  The traffic selector defined in\n      [RFC6088]
          is mandatory to implement.\n"
        title: 4.2.1.4.  Traffic Selector Sub-Option
      title: 4.2.1.  Flow Identification Sub-Options Definition
    - contents:
      - "4.2.2.  Flow Summary Mobility Option\n   The flow summary mobility option
        is a new mobility option [RFC3775],\n   which includes one or more flow identifiers
        (FIDs) for the purpose of\n   refreshing their state.  The alignment requirement
        for this option is\n   2n.\n        0                   1                   2
        \                  3\n        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        2 3 4 5 6 7 8 9 0 1\n       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \      | Option Type   |  Option Len   |              FID              |\n
        \      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n
        \      |     FID  ........\n       +-+-+-+-+-+-+-+-+-+-\n                Figure
        6: The Flow Summary Mobility Option\n      Option Type\n         44\n      Option
        Length\n         Length of the option in octets as per [RFC3775].\n      FID\n
        \        A 16-bit unsigned integer indicating a registered FID.  One or\n
        \        more FID fields can be included in this option.  Number of FIDs\n
        \        = Option Len/2.\n"
      title: 4.2.2.  Flow Summary Mobility Option
    title: 4.2.  Flow Identification Mobility Option
  - contents:
    - "4.3.  Flow Bindings Entries List and Its Relationship to Binding Cache\n   The
      conceptual Mobile IPv6 binding cache was defined in [RFC3775] to\n   identify
      the mobile IP state maintained by the mobile node, mobility\n   agent, and correspondent
      node.  The binding cache includes, among\n   others, the mobile node's home
      address, the registered care-of\n   address, and the lifetime of the binding.
      \ The binding cache has been\n   extended by [RFC5648] to include more than
      one care-of addresses and\n   to associate each of them with a binding identifier
      (BID).\n   This specification does not modify the Mobile IPv6 binding cache
      any\n   further.\n   Flow bindings can be thought of as a conceptual list of
      entries that\n   is separate from the binding cache.  The flow bindings list
      contains\n   an entry for each of the registered flow bindings.  Flow binding\n
      \  entries point to an entry in the binding cache by means of the BID.\n   Each
      flow binding entry includes the following parameters:\n   o  FID (Flow Identifier):
      For a given mobile node, identified by its\n      primary home address, the
      FID MUST uniquely identify an entry,\n      i.e., a unique flow binding.  Each
      mobile node can only have a\n      single entry identified by a given FID at
      any one time.  A given\n      FID number space is used for all the addresses
      associated to a\n      given MN by the HA (e.g., via [RFC3963]).  Different
      mobile nodes\n      use the same FID number space.\n   o  A Traffic Selector:
      Included in a traffic selector sub-option.\n   o  BID(s): The list of BIDs associated
      with the entry as defined by\n      the binding reference sub-option included
      in the FID option that\n      created it.\n   o  Active/Inactive flag: This
      flag indicates whether the entry is\n      active or inactive.\n   o  FID-PRI:
      This field indicates the priority of the flow binding and\n      is used to
      break the tie between overlapping flow bindings.\n   The flow bindings list
      is associated with a given mobile node, and\n   the correspondent binding cache.
      \ An entry in the flow bindings list,\n   however, is identified by the FID
      and the list is ordered according\n   to the FID-PRI field as defined in the
      FID option that created each\n   entry.\n   A valid BID is required to make
      the entry 'Active'.  If all of the\n   BIDs pointed to by a given entry are
      deregistered [RFC5648], the flow\n   binding entry becomes 'Inactive', in other
      words it does not affect\n   data traffic.  Note that an entry becomes 'Inactive'
      only if all of\n   the BIDs are deregistered.  If only some of the BIDs are
      still valid,\n   the invalid BIDs are simply ignored.\n   Also, note that the
      state described in this section is maintained by\n   the mobile node as well
      as in mobility agents and correspondent\n   nodes.  As such, the mobile node
      is fully aware of which BIDs are\n   valid at any time and which flow binding
      entries are active/inactive.\n   Section 5 defines how these flow binding entries
      are manipulated by\n   the mobile node in detail.\n   As an example, the following
      represents an ordered flow binding entry\n   table for a mobile node that has
      registered multiple care-of\n   addresses and flow bindings.\n          FID-PRI
      \    FID    Traffic Selector    BIDs      A/I\n          -------     ---    ----------------
      \   ----    -------\n             10        4           TCP            2       Active\n
      \            30        2       srcAddr=IPy        4      Inactive\n             40
      \       5           UDP           1,3      Active\n                       Ordered
      Flow Binding Entries\n   According to the above list of flow binding entries,
      all TCP traffic\n   will match the first entry, and will be forwarded to BID2,\n
      \  corresponding to a given care-of address (IP3), as shown below.\n   The second
      entry is marked as 'Inactive' since the BID 4 does not\n   exist in the ordered
      list of BID entries below.  Inactive entries do\n   not affect traffic, i.e.,
      packets are not matched against them.\n   Any UDP traffic that does not match
      any of the earlier entries will\n   match the third rule, at which point it
      will be replicated and\n   forwarded to BIDs 1 and 3, corresponding to care-of
      addresses IP1 and\n   IP2 shown below.\n   Finally, any remaining packets that
      do not match any of the entries\n   above will be simply forwarded to the care-of
      address indicated by\n   the highest order BID in the table below.  In the example,
      such\n   packets will be forwarded to BID1 corresponding to care-of address\n
      \  IP1.\n                       BID-PRI          BID        CoA\n                      ---------
      \        ---        ---\n                          20             1         IP1\n
      \                         30             3         IP2\n                          30
      \            2         IP3\n                            Ordered BID Entries\n
      \  Mobility agent and corresponding node implementations should take\n   care
      to avoid flow binding rules affecting the fundamental operation\n   of Mobile
      IPv6 and its extensions.  In particular, flow binding rules\n   MUST NOT apply
      to Mobile IPv6 signaling generated by mobility agents\n   and corresponding
      nodes communicating with a given mobile node, since\n   that could adversely
      affect the operation of the protocol.  Other,\n   non-MIPv6 traffic generated
      by these entities SHOULD be matched\n   against the mobile node's flow binding
      rules as normal.\n"
    title: 4.3.  Flow Bindings Entries List and Its Relationship to Binding Cache
  title: 4.  Mobile IPv6 Extensions
- contents:
  - '5.  Protocol Operations

    '
  - contents:
    - "5.1.  General\n   This specification introduces a flow bindings list of entries
      and an\n   ordered list of flow binding identifiers, allowing mobile nodes to\n
      \  associate flow binding policies with the registered care-of\n   addresses.\n
      \  The flow identification mobility option defines how the mobile node\n   can
      control a set of flow binding entries maintained in a mobility\n   agent, or
      correspondent node.\n   This specification allows mobile nodes to direct flows
      to a\n   particular care-of address.  The granularity of what constitutes a\n
      \  flow depends on the traffic selector used.\n   The remainder of this section
      discusses how mobile nodes can use the\n   options and sub-options defined in
      this document when sending binding\n   updates to the correspondent node, home
      agent, or mobility anchor\n   point.  In addition, refresh, deletion, and modification
      of flow\n   binding entries are all discussed below.\n"
    - contents:
      - "5.1.1.  Preferred Care-of Address\n   Any node that supports this specification
        MUST maintain an ordered\n   list of care-of addresses for each mobile node
        for which it maintains\n   a list of flow bindings.  The ordered list of care-of
        addresses is\n   built based on the BID-PRI field of the binding identifier
        mobility\n   option (see Section 4.1).\n   The ordered list of BIDs is used
        to determine how to forward a packet\n   to a given mobile node when the packet
        does not match any of the flow\n   binding entries defined in Section 4.3.
        \ A packet that does not match\n   any of the flow binding entries SHOULD
        be forwarded to the care-of\n   address identified by the BID with the highest
        priority, i.e., lowest\n   BID-PRI value.\n"
      title: 5.1.1.  Preferred Care-of Address
    title: 5.1.  General
  - contents:
    - "5.2.  Mobile Node Considerations\n   This specification allows the mobile node
      to maintain several\n   bindings with its mobility agent and correspondent nodes,
      and it\n   allows it to direct packets to different care-of addresses according\n
      \  to flow bindings.\n   The mobility agent and correspondent node list of flow
      bindings is\n   manipulated by the mobile node, via flow identification and
      flow\n   summary mobility options included in binding update messages.  Each\n
      \  flow binding update can add, modify, refresh, or delete a given\n   binding.
      \ More than one flow identification mobility option MAY be\n   included in the
      same binding update, but each of them MUST include a\n   different FID.  In
      other words, two flow identification options in\n   the same message cannot
      be about the same flow binding.\n   All flow binding state MUST be refreshed
      in every binding update the\n   mobile node sends.  Any previously registered
      flow binding that is\n   not included in a given binding update will be deleted.
      \ So, any flow\n   bindings that are not added or modified by a flow identification\n
      \  mobility option, but have previously registered and need to be\n   maintained,
      MUST be included in a flow summary mobility option.\n"
    - contents:
      - "5.2.1.  Sending BU with BID Options\n   This specification (see Section 4.1)
        updates the definition of the\n   binding identifier mobility option, originally
        defined in [RFC5648].\n   According to this specification, the BID option
        includes a BID-PRI\n   field assigning each registered care-of address a priority,
        and thus\n   places them in an ordered list, as also described in Section
        4.3.\n   To ensure backwards compatibility with [RFC5648], for the purpose
        of\n   this specification, the field BID-PRI MUST NOT be set to zero.\n   Receiver
        implementation of this specification will take a BID-PRI\n   field of value
        zero as an indication that this is a BID option of the\n   format defined
        in [RFC5648].\n   Mobile nodes supporting this specification MUST use the
        BID option\n   format defined in Section 4.1.  Mobile nodes MUST also register
        all\n   care-of addresses using the updated BID option format, either in the\n
        \  same BU as any flow identification mobility options using them or in\n
        \  earlier BUs.\n"
      title: 5.2.1.  Sending BU with BID Options
    - contents:
      - '5.2.2.  Sending BU with Flow Identification Mobility Options

        '
      - contents:
        - "5.2.2.1.  New Flow Bindings\n   When adding a new flow binding, a mobile
          node sends the flow\n   identification mobility option in the binding update,
          with the FID\n   field set to a value that is not already present in the
          list of flow\n   binding entries maintained by the receiver.  The care-of
          address(es)\n   associated with each flow identification mobility option
          in the\n   binding update must be logically registered by this binding update,\n
          \  or must have already been registered by the receiver of the binding\n
          \  update in an earlier binding update, as defined in Section 5.2.1.\n   The
          flow identification mobility option MUST include a unique flow\n   identifier
          in the FID field.  The FID need only be unique for the\n   receiver of the
          binding update and for the same sender, i.e., the\n   same FID can be used
          across different receivers of the binding\n   update, for the same sender.
          \ The FID-PRI field is set to the desired\n   unique priority of the FID,
          defining the order of the flow binding to\n   be added in the list of flow
          binding entries, as defined in\n   Section 4.3.  The Status field is set
          to zero in all binding update\n   messages.\n   Since this flow identification
          mobility option is requesting the\n   addition of a new flow binding in
          the list of flow bindings\n   maintained by the receiver, the mobile node
          MUST include exactly one\n   traffic selector sub-option (see Section 4.2.1.4)
          describing the flow\n   associated with the new flow binding.  The TS Format
          field of the\n   traffic selector sub-option MUST be set to the non-zero
          value of the\n   format used by the mobile node.\n   The mobile node MUST
          also include exactly one BID reference sub-\n   option (see Section 4.2.1.3)
          to associate the flow binding with a\n   given set of BIDs and corresponding
          CoAs.\n"
        title: 5.2.2.1.  New Flow Bindings
      - contents:
        - "5.2.2.2.  Updating Flow Bindings\n   Flow binding modification is essentially
          a process where parameters\n   associated with an existing flow binding
          in the list of flow binding\n   entries are replaced by parameters included
          in the flow\n   identification mobility option, and the same FID is maintained.
          \ With\n   this procedure, the mobile node can change the priority, the
          BID(s),\n   and/or the traffic selector associated with a flow binding.\n
          \  To modify an existing flow binding, the mobile node MUST send a\n   binding
          update with a flow identification option, with the FID field\n   set to
          one of the FID values already in the list of flow binding\n   entries.  The
          FID-PRI field MUST be set to the priority value for the\n   flow binding
          entry.  The Status field is set to zero since this\n   option is in a binding
          update.\n   The mobile node MAY include exactly one traffic selector sub-option\n
          \  (see Section 4.2.1.4) describing the updated flow to be associated\n
          \  with the flow binding.  The mobile node MAY, however, omit the\n   traffic
          selector sub-option if it wants the traffic selector\n   currently associated
          with the flow binding entry identified by the\n   FID field to be maintained.\n
          \  The mobile node MAY include exactly one binding reference sub-option\n
          \  (see Section 4.2.1.3) to associate the existing flow binding with a\n
          \  new set of CoAs.  The mobile node MAY omit the binding reference sub-\n
          \  option if it wants the BIDs currently associated with the flow\n   binding
          entry identified by the FID field to be maintained.\n   Note that it is
          also possible for the mobile node to effectively\n   modify the effect of
          a flow binding entry without actually changing\n   the entry itself.  This
          can be done by changing the CoA associated\n   with a given BID, which is
          a process defined in detail in [RFC5648].\n"
        title: 5.2.2.2.  Updating Flow Bindings
      title: 5.2.2.  Sending BU with Flow Identification Mobility Options
    - contents:
      - "5.2.3.  Sending BU with a Flow Summary Option\n   When the mobile node sends
        a binding update, it MUST refresh all flow\n   bindings it wants to maintain
        even if it does not want to change any\n   of their parameters.\n   To refresh
        an existing flow binding, the mobile node MUST send a\n   binding update with
        a flow summary option.  The flow summary option\n   MUST include one or more
        FID fields, as indicated in Section 4.2.2.\n   Each FID field included MUST
        be set to one of the FID values already\n   in the list of flow binding entries.
        \ Each flow summary mobility\n   option can identify up to 127 FIDs, so more
        than one such option can\n   be included in a binding update message as required.
        \ A given FID\n   SHOULD NOT be included more than once in all of the flow
        summary\n   mobility options included in a given binding update message.\n
        \  Any flow bindings (active or inactive) that are not identified in a\n   binding
        update will be removed from the list of flow binding entries.\n   Note that
        any inactive flow bindings, i.e., flow bindings without\n   associated BIDs
        that are marked as 'Inactive' in the list of flow\n   binding entries (see
        Section 4.3), MUST also be refreshed, or\n   modified, to be maintained.  If
        they are not included in a BU\n   message, they will be removed.\n"
      title: 5.2.3.  Sending BU with a Flow Summary Option
    - contents:
      - "5.2.4.  Removing Flow Bindings\n   Removal of flow binding entries is performed
        implicitly by omission\n   of a given FID from a binding update.\n   To remove
        a flow binding, the MN simply sends a binding update\n   message that includes
        flow identification and flow summary mobility\n   options for all the FIDs
        that need to be refreshed, modified, or\n   added, and simply omits any FIDs
        that need to be removed.\n   Note that a mobile node can also render a flow
        binding inactive by\n   removing the BIDs associated with it, without removing
        the flow\n   binding itself.  The procedure for removing a BID is defined
        in\n   detail in [RFC5648].\n   When all the BIDs associated with a flow binding
        are removed, the\n   flow binding MUST be marked as 'Inactive' in the list
        of flow binding\n   entries, as shown in Section 4.3.  In other words, the
        state\n   associated with the flow binding MUST be maintained, but it no longer\n
        \  affects the mobile node's traffic.  The MN can return an inactive\n   flow
        binding to the active state by using the flow binding\n   modification process,
        described in Section 5.2.2.2, to associate it\n   again with one or more valid
        BIDs.\n"
      title: 5.2.4.  Removing Flow Bindings
    - contents:
      - "5.2.5.  Returning Home\n   This specification is compatible with the home
        registration\n   procedures defined in [RFC3775] and [RFC5648].  More specifically,
        if\n   the mobile node performs a deregistration in the [RFC3775] style, all\n
        \  of its bindings, including flow bindings are deleted.  If the mobile\n
        \  node, however, performs a home registration in the [RFC5648] style,\n   then
        the home link is associated with a specific BID and so, as far\n   as this
        specification is concerned, it is treated as any other link\n   associated
        with a given BID.\n"
      title: 5.2.5.  Returning Home
    - contents:
      - "5.2.6.  Receiving Binding Acknowledgements\n   According to [RFC3775], all
        nodes are required to silently ignore\n   mobility options not understood
        while processing binding updates.  As\n   such, a mobile node receiving a
        Binding Acknowledgement message in\n   response to the transmission of a binding
        update message MUST\n   determine if the Binding Acknowledgement message contains
        a copy of\n   every flow identification mobility options included in the binding\n
        \  update.  A Binding Acknowledgement without flow identification\n   option(s),
        in response to a binding update with flow identification\n   mobility option,
        would indicate the inability (or unwillingness) on\n   behalf of the source
        node to support the extensions presented in this\n   document.\n   If a received
        Binding Acknowledgement contains a copy of each flow\n   identification mobility
        option that was sent within the binding\n   update, the Status field of each
        flow identification option indicates\n   the status of the flow binding on
        the distant node.\n"
      title: 5.2.6.  Receiving Binding Acknowledgements
    - contents:
      - "5.2.7.  Return Routability Procedure\n   A mobile node may perform route
        optimization with correspondent\n   nodes, as defined in [RFC3775].  Route
        optimization allows a mobile\n   node to bind a care-of address to a home
        address in order to allow\n   the correspondent node to direct the traffic
        to the current location\n   of the mobile node.  Before sending a binding
        update to correspondent\n   node, the Return Routability Procedure needs to
        be performed between\n   the mobile node and the correspondent node.  This
        procedure is not\n   affected by the extensions defined in this document.\n"
      title: 5.2.7.  Return Routability Procedure
    title: 5.2.  Mobile Node Considerations
  - contents:
    - "5.3.  HA, MAP, and CN Considerations\n   This specification allows the mobility
      agents (home agents and\n   mobility anchor points), and correspondent nodes
      to maintain several\n   flow bindings for a given home address and to direct
      packets to\n   different care-of addresses according to flow bindings.  This
      section\n   details the home agent operations necessary to implement this\n
      \  specification.  These operations are identical for MAPs and CNs,\n   unless
      otherwise stated.\n   Note that route optimization is only defined for mobile
      nodes (MIPv6\n   [RFC3775]) and not mobile routers (NEMOv6 [RFC3963]).  Thus,
      these\n   sections only apply to correspondent nodes with respect to mobile\n
      \  nodes and not mobile routers.\n"
    - contents:
      - "5.3.1.  Handling Binding Identifier Mobility Options\n   This specification
        (see Section 4.1) updates the definition of the\n   binding identifier mobility
        option, originally defined in [RFC5648].\n   According to this specification,
        the BID option includes a BID-PRI\n   field assigning each registered care-of
        address a priority, and thus\n   places them in an ordered list (see Section
        4.3).\n   Home agents receiving BUs including BID options and flow\n   identification
        options MUST logically process BID options first.\n   This is because BID
        reference sub-options included in the flow\n   identification mobility options
        might refer to BIDs defined in BID\n   options included in the same message.\n
        \  The BID option is processed as defined in [RFC5648], but then the BID\n
        \  to care-of address mapping is placed in an ordered list according to\n
        \  the BID-PRI field of the BID option.\n   Binding identifier registrations
        and deregistrations indirectly\n   affect the MN's flow binding entries.  The
        home agent MUST update the\n   flow binding entries table accordingly as BIDs
        are added or removed\n   (as per [RFC5648]).  For example, as discussed in
        Section 4.3, if all\n   of the BIDs associated with a given flow binding entry
        are removed\n   (i.e., become invalid) the entry MUST be marked as 'Inactive'.
        \ While\n   if any of the invalid BIDs associated with an inactive flow binding\n
        \  entry are registered (i.e., become valid), the entry MUST be marked\n   as
        'Active'.\n"
      title: 5.3.1.  Handling Binding Identifier Mobility Options
    - contents:
      - "5.3.2.  Handling Flow Identification Mobility Options\n   When the home agent
        receives a binding update that includes at least\n   one flow identification
        mobility option, it first performs the\n   operation described in section
        10.3.1 of RFC 3775, followed by the\n   operations defined in Section 5.3.1
        of this document.\n   Home agents that do not support this specification will
        ignore the\n   flow identification mobility options and all their sub-options,\n
        \  having no effect on the operation of the rest of the protocol.\n   If the
        binding update is accepted, and the home agent is willing to\n   support flow
        bindings for this MN, the home agent checks the flow\n   identification mobility
        options.\n   If more than one flow identification mobility option in the same
        BU\n   has the same value in the FID field, all the flow identification\n
        \  mobility options MUST be rejected.\n   If all FID fields have different
        values the flow identification\n   mobility options can be processed further
        and in any order, as\n   defined by the following subsections.\n"
      - contents:
        - "5.3.2.1.  Handling New FIDs\n   If the FID field of the flow identification
          mobility option is not\n   already present in the list of flow binding entries
          for this mobile\n   node, then this is a request for a new entry.\n      If
          the flow identification mobility option does not include a\n      traffic
          selector sub-option, the home agent MUST reject this\n      request by copying
          the flow identification mobility option in the\n      Binding Acknowledgement
          (BA) and setting the Status field to the\n      value defined in Figure
          2 for \"Flow identification option\n      malformed\".\n      If the flow
          identification option does include a traffic selector\n      sub-option,
          but the format indicated in the TS Format field is not\n      supported,
          the home agent MUST reject this request by copying the\n      flow identification
          mobility option in the BA, and setting the\n      Status field to the value
          defined in Figure 2 for \"Traffic\n      Selector format not supported\".\n
          \  Then, the home agent MUST check the binding reference sub-option.\n      If
          the binding reference sub-option is not included, the home\n      agent
          MUST reject this request by copying the flow identification\n      mobility
          option in the BA and setting the Status field to the\n      value defined
          for \"Flow identification mobility option malformed\"\n      in Section
          4.2.\n      If the binding reference sub-option is present and includes
          one or\n      more BIDs that are not present in the binding cache of the
          mobile\n      node, the home agent MUST reject this request by copying the
          flow\n      identification option in the BA and setting the Status field
          to\n      the value defined for \"BID not found\" in Section 4.2.\n      If
          the binding reference sub-option is present and includes one or\n      more
          BIDs, and the BIDs exist in the mobile node's binding cache,\n      the
          home agent SHOULD add a new entry in the mobile node's list of\n      flow
          binding entries, as defined below.\n   When the home agent decides to add
          an entry in the mobile node's list\n   of flow binding entries, as discussed
          above, it MUST do it according\n   to the following rules: the entry MUST
          be placed according to the\n   order indicated by the FID-PRI field of the
          flow identification\n   mobility option and it MUST include:\n      the
          FID as a key to the entry,\n      the traffic selector included in the corresponding
          sub-option,\n      the BIDs indicated in the binding reference sub-option,
          and\n      the entry MUST be marked as 'Active', as shown in Section 4.3.\n"
        title: 5.3.2.1.  Handling New FIDs
      - contents:
        - "5.3.2.2.  Handling Known FIDs\n   If the FID field of the flow identification
          mobility option is\n   already present in the list of flow binding entries
          for this mobile\n   node, then this is a request to update the existing
          entry.\n   The flow binding modification is essentially a process where\n
          \  parameters associated with an existing flow binding entry are\n   replaced
          by the parameters included in a flow identification mobility\n   option
          with the same FID as the existing entry.\n   The home agent MUST change
          the priority of the entry according to the\n   FID-PRI field of the flow
          identification mobility option.\n   Since this flow identification mobility
          option is designed to update\n   an existing entry, it may or may not include
          a traffic selector sub-\n   option.  Specifically:\n      if a traffic selector
          sub-option is not included in the flow\n      identification mobility option,
          then the traffic selector already\n      associated with entry MUST be maintained;\n
          \     otherwise, the traffic selector in the entry MUST be replaced by\n
          \     the traffic selector in the sub-option.\n   Since this flow identification
          mobility option is designed to update\n   an existing entry, it may or may
          not include a binding reference sub-\n   option.  Specifically:\n      if
          a binding reference sub-option is not included in the flow\n      identification
          mobility option, then the BIDs already associated\n      with entry MUST
          be maintained;\n      otherwise, the BIDs in the entry MUST be replaced
          by the BIDs in\n      the sub-option.\n"
        title: 5.3.2.2.  Handling Known FIDs
      title: 5.3.2.  Handling Flow Identification Mobility Options
    - contents:
      - "5.3.3.  Handling Flow Summary Mobility Option\n   When the home agent receives
        a binding update that includes flow\n   summary mobility options, it first
        performs the operation described\n   so far in Section 5.3.\n   If the value
        of any of the FID fields included in a flow summary\n   mobility option is
        not present in the list of flow binding entries\n   for this mobile node,
        the home agent MUST reject this flow binding\n   refresh by including a flow
        identification mobility option in the BA\n   for each FID that is not found,
        and by setting the FID field to the\n   value of the FID that is not found
        and the Status field to the value\n   defined for \"FID not found\" in Section
        4.2.\n   If the value of the FID field is present in the mobile nodes list
        of\n   flow binding entries the, home agent SHOULD refresh the flow binding\n
        \  entry identified by the FID without changing any of the other\n   parameters
        associated with it.\n   If a given FID is included more than once in the same
        or different\n   flow summary mobility options in the same binding update
        message, the\n   duplicates can be simply ignored.\n   Note that, an [RFC3775]
        deregistration binding update (with a zero\n   lifetime) would result in deleting
        all bindings, including all flow\n   bindings regardless of the presence of
        flow summary mobility options.\n   A binding update (with a zero lifetime)
        would result in deleting all\n   bindings, including all flow bindings regardless
        of the presence of\n   flow summary mobility options.  A specific binding
        deregistration,\n   however, as defined in [RFC5648] (with lifetime of zero
        and one or\n   more binding identifier mobility options identifying specific
        BIDs)\n   does not remove all the bindings for the MN, and thus it SHOULD\n
        \  include flow summary mobility options to maintain the flow bindings\n   that
        need to be preserved.\n"
      title: 5.3.3.  Handling Flow Summary Mobility Option
    - contents:
      - "5.3.4.  Flow Binding Removals\n   Removal of flow bindings is performed implicitly
        by omission of a\n   given FID from a binding update.\n   When a valid binding
        update is received, any registered FIDs that are\n   not explicitly referred
        to in a flow identification mobility option\n   or in a flow summary mobility
        option, in the same binding update,\n   MUST be removed from the list of flow
        binding entries for the mobile\n   node.\n"
      title: 5.3.4.  Flow Binding Removals
    - contents:
      - "5.3.5.  Sending Binding Acknowledgements\n   Upon the reception of a binding
        update, the home agent is required to\n   send back a Binding Acknowledgement.
        \ The status code in the Binding\n   Acknowledgement must be set as recommended
        in [RFC3775].  This status\n   code does not give information on the success
        or failure of flow\n   bindings.\n   In order to inform the mobile node about
        the status of the flow\n   binding(s) requested by a mobile node, flow identification
        options\n   SHOULD be included in the Binding Acknowledgement message.\n   Specifically,
        the home agent SHOULD copy each flow identification\n   mobility option received
        in the binding update and set its status\n   code to an appropriate value.
        \ Note that the home agent does not need\n   to respond specifically regarding
        FIDs included in a flow summary\n   mobility option but only to those in flow
        identification mobility\n   options.  If an operation requested in a flow
        identification option\n   by a mobile node is performed successfully by the
        home agent, the\n   Status field on the copied flow identification mobility
        option in the\n   BA, SHOULD be set to the value defined for \"Flow binding
        successful\"\n   in Section 4.2; otherwise, it SHOULD be set to one of the
        rejection\n   codes also defined in Section 4.2.  Section 5.3.2 identifies
        a number\n   of cases where specific error codes should be used.\n   Home
        agents that support this specification MAY refuse to maintain\n   flow bindings
        by setting the Status field of any flow identification\n   mobility options
        to the value defined for \"Administratively\n   prohibited\" in Section 4.2,
        or by just ignoring all the flow binding\n   options.\n   Note that BID options
        and their Status field are handled as defined\n   in [RFC5648].  The BID-PRI
        field in a BID option included in the\n   Binding Acknowledgement is copied
        from the BID-PRI field of the\n   corresponding BID option in the binding
        request.\n"
      title: 5.3.5.  Sending Binding Acknowledgements
    - contents:
      - "5.3.6.  Packet Processing\n   This section defines packet processing rules
        according to this\n   specification.  This specification does not change any
        of the packet\n   interception rules defined in [RFC3775] and [RFC5555].  These
        rules\n   apply to HAs, MAPs, and CNs as part of the routing process for any\n
        \  packet with a destination address set to a valid home address of the\n
        \  mobile node.  For nodes other than CNs, this also applies to packets\n
        \  with a destination address set to an address under any of the\n   registered
        prefixes.  These rules apply equally to IPv6 packets as\n   well as to IPv4
        packets as per [RFC5555].\n   Before a packet is forwarded to the mobile node,
        it MUST be matched\n   against the ordered list of flow bindings stored in
        the list of flow\n   binding entries for this mobile node (see Section 4.3).
        \ A match is\n   attempted with the traffic selector included in the first
        line\n   (highest order) of the table.  The first entry that creates a match\n
        \  defines how the packet is routed.  When a packet matches the traffic\n
        \  selector of a given entry, a copy of the packet is forwarded to each\n
        \  of the care-of addresses associated with the BIDs indicated in the\n   same
        line of the table.\n   If any of the BIDs indicated does not correspond to
        a valid care-of\n   address, e.g., the BID was deregistered then, that BID
        has no effect\n   on the traffic.  In other words, packets matching the flow
        binding\n   are forwarded to the remaining BIDs, pointing to registered care-of\n
        \  addresses.  If none of the BIDs pointed to in a flow binding entry is\n
        \  valid, then the entry is considered to be inactive (as defined in\n   Section
        4.3) and is skipped.  In other words, packets should not be\n   matched against
        that entry.\n   If a packet does not match any of the active flow binding
        entries for\n   the given MN, the packet SHOULD be forwarded to the highest
        order\n   care-of address, i.e., the one associated with the BID with the\n
        \  lowest BID-PRI.\n   If a packet is fragmented, only the first fragment
        contains all IP\n   and transport layer headers, while subsequent fragments
        only contain\n   an IP header without transport layer headers.  For this reason,
        it is\n   possible that subsequent fragments do not match the same traffic\n
        \  selector as the initial fragment of such a packet.  Unless specific\n   measures
        are taken, the likely outcome is that the initial fragment\n   is routed as
        the MN intended while subsequent fragments are routed\n   differently, and
        probably based on the default flow binding.  HAs,\n   MAPs, and CNs SHOULD
        take care to forward all fragments of a given\n   packet the same way, and
        in accordance to the flow binding matching\n   the first fragment of said
        packet.  This should be possible given the\n   fact that fragment headers
        include enough information to identify a\n   fragment as part of a specific
        packet, but the details of how this is\n   ensured are implementation specific
        and are not defined in this\n   specification.\n"
      title: 5.3.6.  Packet Processing
    title: 5.3.  HA, MAP, and CN Considerations
  title: 5.  Protocol Operations
- contents:
  - "6.  MTU Considerations\n   The options and sub-options defined in this specification
    add to\n   those defined in [RFC3775] and other related specifications, all of\n
    \  which potentially add to the size of binding update messages.\n   Implementations
    SHOULD take care to minimize fragmentation by forming\n   binding updates that
    are shorter than what the path MTU allows\n   whenever possible.\n   This specification
    offers a number of mechanisms for reducing the\n   size of binding updates.  The
    operations defined in this\n   specification that require the most verbose options
    are those\n   registering new BIDs, Section 4.1, and identifying new flows,\n
    \  Section 4.2.1.4.  Implementations are encouraged to keep binding\n   updates
    to sizes below that of the path's MTU by making full use of\n   the BID reference
    sub-option, Section 4.2.1.3, and flow summary\n   option, Section 4.2.2, which
    allows them to refer to already\n   registered care-of addresses and flow bindings,
    while registering new\n   ones in subsequent binding update messages.\n"
  title: 6.  MTU Considerations
- contents:
  - "7.  Security considerations\n   This document introduces a new option that adds
    more granularity to\n   the binding update and acknowledgement messages defined
    in [RFC3775],\n   [RFC5555], and [RFC3963], so it inherits the security considerations\n
    \  discussed in these documents.  The new option allows the mobile node\n   to
    associate some flows to one interface and other flows to another\n   interface.
    \ Since the flow identification mobility option is part of\n   the mobility header,
    it uses the same security as the binding update,\n   whether it is sent to a mobility
    agent or to a correspondent node.\n   This specification does not open up new
    fundamental lines of attack\n   on communications between the MN and its correspondent
    nodes.\n   However, it allows attacks of a finer granularity than those on the\n
    \  binding update.  For instance, the attacker can divert or replicate\n   flows
    of special interest to the attacker to an address of the\n   attacker's choosing,
    if the attacker is able to impersonate the MN or\n   modify a binding update sent
    by the MN.  Hence, it becomes doubly\n   critical that authentication and integrity
    services are applied to\n   binding updates.\n   Finally, when the optional anti-replay
    feature of Encapsulating\n   Security Payload (ESP) [RFC4303] is employed and
    packets to/from\n   different CoAs are sent on the same security association (SA),
    some\n   packets could be discarded at the receiver due to the windowing\n   mechanism
    used by this feature.  Therefore, a sender SHOULD put\n   traffic to/from different
    CoAs, but with the same HoA in the selector\n   values, on different SAs to support
    Multiple Care-of Addresses\n   appropriately.  To permit this, the IPsec implementation
    SHOULD\n   establish and maintain multiple SAs between a given sender and\n   receiver,
    with the same selectors.  Distribution of traffic among\n   these parallel SAs
    to support Multiple Care-of Addresses is locally\n   determined by the sender
    and is not negotiated by the Internet Key\n   Exchange version 2 (IKEv2) protocol
    [RFC5996].  The receiver will\n   process the packets from the different SAs without
    prejudice.\n"
  title: 7.  Security considerations
- contents:
  - "8.  IANA Considerations\n   This specification requires the following IANA assignments
    on\n   existing namespaces as well as the creation of some new namespaces.\n      New
    Mobility Options [RFC3775]: This registry is available from\n      http://www.iana.org
    under \"Mobile IPv6 parameters\".  The following\n      type numbers have been
    assigned for:\n         44 Flow Identification Mobility Option, defined in Section
    4.2\n         45 Flow Summary Mobility Option, defined in Section 4.2.2\n      A
    new \"Flow Identification Mobility Option Status Codes\" namespace\n      has
    been created.  The following 'Status' codes are defined in\n      this specification,
    in Section 4.2:\n         0 Flow binding successful\n         1-127 Unassigned.
    \ Available for success codes to be allocated\n         via Standards Action or
    IESG Approval as per [RFC5226].\n         128 Administratively prohibited\n         129
    Flow binding rejected, reason unspecified\n         130 Flow identification mobility
    option malformed\n         131 BID not found\n         132 FID not found\n         133
    Traffic selector format not supported\n         134-250 Unassigned.  Available
    for reject codes to be allocated\n         via Standards Action or IESG Approval
    as per [RFC5226].\n         251-255 Reserved for experimental use.  This small
    number of\n         status codes should be sufficient for experiments with\n         currently
    unforeseen error conditions.\n      A new \"Flow Identification Sub-Options\"
    namespace for the flow\n      identification mobility option has been created.
    \ The sub-option\n      space is defined in Figure 3.  The following sub-option
    Type\n      values are defined in this specification:\n         0 Pad\n         1
    PadN\n         2 BID Reference\n         3 Traffic Selector\n         4-250 Unassigned.
    \ Available for allocation based on Standards\n         Action or IESG Approval
    as per [RFC5226].\n         251-255 Reserved for experimental use.  This small
    number of\n         sub-option Types should be sufficient for experiments with\n
    \        additional parameters associated with a flow.\n      A new \"Traffic
    Selector Format\" namespace for the traffic selector\n      sub-option has been
    created.  The traffic selector format space is\n      defined by the TS Format
    field in Figure 5.  The following values\n      are defined in this specification:\n
    \        0 Reserved\n         1-250 Unassigned.  Available for allocation based
    on Standards\n         Action or IESG Approval as per [RFC5226].\n         251-255
    Reserved for experimental use.  This small number of\n         traffic selector
    format types should be sufficient for\n         experiments with different ways
    of representing a traffic\n         selector.\n   Similar to the procedures specified
    for Mobile IPv6 [RFC3775] number\n   spaces, future allocations from the new number
    spaces requires\n   Standards Action or IESG Approval as per [RFC5226].\n"
  title: 8.  IANA Considerations
- contents:
  - "9.  Contributors\n   We would like to explicitly acknowledge the following person
    who\n   coauthored one of the documents used as source material for this\n   document.\n
    \     Nikolaus A. Fikouras, niko@comnets.uni-bremen.de\n"
  title: 9.  Contributors
- contents:
  - "10.  Acknowledgements\n   We would also like to acknowledge the following people
    in\n   alphabetical order for their contributions to this specification: C.\n
    \  Castelluccia, D. Craig, K. ElMalki, K. Georgios, C. Goerg, C. Kaas-\n   Petersen,
    J. Laganier, T. Noel, V. Park, F.-N.  Pavlidou, P. Stupar.\n   Also, Gabor Fekete
    for the analysis that led to the inclusion of the\n   BID reference sub-option,
    and Henrik Levkowetz for suggesting support\n   for other ways of describing flows.\n"
  title: 10.  Acknowledgements
- contents:
  - '11.  References

    '
  - contents:
    - "11.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use
      in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March
      1997.\n   [RFC3775]  Johnson, D., Perkins, C., and J. Arkko, \"Mobility Support\n
      \             in IPv6\", RFC 3775, June 2004.\n   [RFC3963]  Devarapalli, V.,
      Wakikawa, R., Petrescu, A., and P.\n              Thubert, \"Network Mobility
      (NEMO) Basic Support Protocol\",\n              RFC 3963, January 2005.\n   [RFC5226]
      \ Narten, T. and H. Alvestrand, \"Guidelines for Writing an\n              IANA
      Considerations Section in RFCs\", BCP 26, RFC 5226,\n              May 2008.\n
      \  [RFC5555]  Soliman, H., \"Mobile IPv6 Support for Dual Stack Hosts and\n
      \             Routers\", RFC 5555, June 2009.\n   [RFC5648]  Wakikawa, R., Devarapalli,
      V., Tsirtsis, G., Ernst, T.,\n              and K. Nagami, \"Multiple Care-of
      Addresses Registration\",\n              RFC 5648, October 2009.\n   [RFC6088]
      \ Tsirtsis, G., Giaretta, G., Soliman, H., and N. Montavont,\n              \"Traffic
      Selectors for Flow Bindings\", RFC 6088,\n              January 2011.\n"
    title: 11.1.  Normative References
  - contents:
    - "11.2.  Informative References\n   [RFC2702]  Awduche, D., Malcolm, J., Agogbua,
      J., O'Dell, M., and J.\n              McManus, \"Requirements for Traffic Engineering
      Over MPLS\",\n              RFC 2702, September 1999.\n   [RFC3753]  Manner,
      J. and M. Kojo, \"Mobility Related Terminology\",\n              RFC 3753, June
      2004.\n   [RFC4303]  Kent, S., \"IP Encapsulating Security Payload (ESP)\",\n
      \             RFC 4303, December 2005.\n   [RFC4885]  Ernst, T. and H-Y. Lach,
      \"Network Mobility Support\n              Terminology\", RFC 4885, July 2007.\n
      \  [RFC5380]  Soliman, H., Castelluccia, C., ElMalki, K., and L.\n              Bellier,
      \"Hierarchical Mobile IPv6 (HMIPv6) Mobility\n              Management\", RFC
      5380, October 2008.\n   [RFC5996]  Kaufman, C., Hoffman, P., Nir, Y., and P.
      Eronen,\n              \"Internet Key Exchange Protocol Version 2 (IKEv2)\",\n
      \             RFC 5996, September 2010.\n"
    title: 11.2.  Informative References
  title: 11.  References
- contents:
  - "Authors' Addresses\n   George Tsirtsis\n   Qualcomm\n   EMail: tsirtsis@qualcomm.com\n
    \  Hesham Soliman\n   Elevate Technologies\n   EMail: hesham@elevatemobile.com\n
    \  Nicolas Montavont\n   Institut Telecom / Telecom Bretagne\n   2, rue de la
    chataigneraie\n   Cesson Sevigne  35576\n   France\n   Phone: (+33) 2 99 12 70
    23\n   EMail: nicolas.montavont@telecom-bretagne.eu\n   URI:   http://www.rennes.enst-bretagne.fr/~nmontavo//\n
    \  Gerardo Giaretta\n   Qualcomm\n   EMail: gerardog@qualcomm.com\n   Koojana
    Kuladinithi\n   University of Bremen\n   ComNets-ikom\n   Otto-Hahn-Allee NW 1\n
    \  Bremen, Bremen  28359\n   Germany\n   Phone: +49-421-218-8264\n   Fax:   +49-421-218-3601\n
    \  EMail: koo@comnets.uni-bremen.de\n   URI:   http://www.comnets.uni-bremen.de/~koo/\n"
  title: Authors' Addresses
