- title: __initial_text__
  contents:
  - "        Profile for Datagram Congestion Control Protocol (DCCP)\n Congestion\
    \ ID 4: TCP-Friendly Rate Control for Small Packets (TFRC-SP)\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies a profile for Congestion Control Identifier\n\
    \   4, the small-packet variant of TCP-Friendly Rate Control (TFRC), in\n   the\
    \ Datagram Congestion Control Protocol (DCCP).  CCID 4 is for\n   experimental\
    \ use, and uses TFRC-SP (RFC 4828), a variant of TFRC\n   designed for applications\
    \ that send small packets.  CCID 4 is\n   considered experimental because TFRC-SP\
    \ is itself experimental, and\n   is not proposed for widespread deployment in\
    \ the global Internet at\n   this time.  The goal for TFRC-SP is to achieve roughly\
    \ the same\n   bandwidth in bits per second (bps) as a TCP flow using packets\
    \ of up\n   to 1500 bytes but experiencing the same level of congestion.  CCID\
    \ 4\n   is for use for senders that send small packets and would like a TCP-\n\
    \   friendly sending rate, possibly with Explicit Congestion Notification\n  \
    \ (ECN), while minimizing abrupt rate changes.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2009 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\
    \ in effect on the date of\n   publication of this document (http://trustee.ietf.org/license-info).\n\
    \   Please review these documents carefully, as they describe your rights\n  \
    \ and restrictions with respect to this document.\n   This document may contain\
    \ material from IETF Documents or IETF\n   Contributions published or made publicly\
    \ available before November\n   10, 2008.  The person(s) controlling the copyright\
    \ in some of this\n   material may not have granted the IETF Trust the right to\
    \ allow\n   modifications of such material outside the IETF Standards Process.\n\
    \   Without obtaining an adequate license from the person(s) controlling\n   the\
    \ copyright in such materials, this document may not be modified\n   outside the\
    \ IETF Standards Process, and derivative works of it may\n   not be created outside\
    \ the IETF Standards Process, except to format\n   it for publication as an RFC\
    \ or to translate it into languages other\n   than English.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Conventions .....................................................4\n  \
    \ 3. Usage ...........................................................4\n    \
    \  3.1. Relationship with TFRC and TFRC-SP .........................5\n      3.2.\
    \ Example Half-Connection ....................................5\n   4. Connection\
    \ Establishment ........................................6\n   5. Congestion Control\
    \ on Data Packets ..............................6\n      5.1. Response to Idle\
    \ and Application-Limited Periods ...........7\n      5.2. Response to Data Dropped\
    \ and Slow Receiver .................7\n      5.3. Packet Sizes ...............................................7\n\
    \   6. Acknowledgements ................................................8\n  \
    \    6.1. Loss Interval Definition ...................................8\n    \
    \  6.2. Congestion Control on Acknowledgements .....................8\n      6.3.\
    \ Acknowledgements of Acknowledgements .......................8\n      6.4. Quiescence\
    \ .................................................8\n   7. Explicit Congestion\
    \ Notification ................................8\n   8. Options and Features ............................................9\n\
    \      8.1. Window Counter Value ......................................10\n  \
    \    8.2. Elapsed Time Options ......................................10\n    \
    \  8.3. Receive Rate Option .......................................10\n      8.4.\
    \ Send Loss Event Rate Feature ..............................10\n      8.5. Loss\
    \ Event Rate Option ....................................11\n      8.6. Loss Intervals\
    \ Option .....................................11\n      8.7. Dropped Packets Option\
    \ ....................................11\n           8.7.1. Example ............................................13\n\
    \   9. Verifying Congestion Control Compliance with ECN ...............14\n  \
    \    9.1. Verifying the ECN Nonce Echo ..............................14\n    \
    \  9.2. Verifying the Reported Loss Intervals and Loss\n           Event Rate\
    \ ................................................14\n   10. Implementation Issues\
    \ .........................................14\n      10.1. Timestamp Usage ..........................................14\n\
    \      10.2. Determining Loss Events at the Receiver ..................15\n  \
    \    10.3. Sending Feedback Packets .................................15\n   11.\
    \ Design Considerations .........................................15\n      11.1.\
    \ The Field Size in the Loss Intervals Option ..............15\n      11.2. The\
    \ Field Size in the Dropped Packets Option .............16\n   12. Experimental\
    \ Status of This Document ..........................17\n   13. Security Considerations\
    \ .......................................17\n   14. IANA Considerations ...........................................17\n\
    \      14.1. Reset Codes ..............................................17\n  \
    \    14.2. Option Types .............................................17\n    \
    \  14.3. Feature Numbers ..........................................18\n   15.\
    \ Thanks ........................................................18\n   16. References\
    \ ....................................................18\n      16.1. Normative\
    \ References .....................................18\n      16.2. Informative\
    \ References ...................................19\n"
- title: List of Tables
  contents:
  - "List of Tables\n   Table 1: DCCP CCID 4 Options .......................................9\n\
    \   Table 2: DCCP CCID 4 Feature Numbers ...............................9\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document specifies an experimental profile for Congestion\n\
    \   Control Identifier 4, TCP-Friendly Rate Control for Small Packets\n   (TFRC-SP),\
    \ in the Datagram Congestion Control Protocol (DCCP)\n   [RFC4340].  CCID 4 is\
    \ a modified version of Congestion Control\n   Identifier 3, CCID 3, which has\
    \ been specified in [RFC4342].  This\n   document assumes that the reader is familiar\
    \ with CCID 3, instead of\n   repeating from that document unnecessarily.\n  \
    \ CCID 3 uses TCP-Friendly Rate Control (TFRC), which is now specified\n   in\
    \ RFC 5348 [RFC5348].  CCID 4 differs from CCID 3 in that CCID 4\n   uses TFRC-SP\
    \ [RFC4828], an experimental, small-packet variant of\n   TFRC.  The original\
    \ specification of TFRC, RFC 3448 [RFC3448], has\n   been obsoleted by RFC 5348.\
    \  The CCID 3 and TFRC-SP documents both\n   predate RFC 5348 and refer instead\
    \ to RFC 3448 for the specification\n   of TFRC.  However, this document assumes\
    \ that RFC 5348 will be used\n   instead of RFC 3448 for the specification of\
    \ TFRC.\n   CCID 4 differs from CCID 3 only in the following respects:\n   o \
    \ Header size: For TFRC-SP, the allowed transmit rate in bytes per\n      second\
    \ is reduced by a factor that accounts for packet header\n      size.  This is\
    \ specified for TFRC-SP in Section 4.2 of [RFC4828],\n      and described for\
    \ CCID 4 in Section 5 below.\n   o  Maximum sending rate: TFRC-SP enforces a minimum\
    \ interval of 10\n      milliseconds between data packets.  This is specified\
    \ for TFRC-SP\n      in Section 4.3 of [RFC4828], and described for CCID 4 in\
    \ Section 5\n      below.\n   o  Loss rates for short loss intervals: For short\
    \ loss intervals of\n      at most two round-trip times (RTTs), the loss rate\
    \ is computed by\n      counting the actual number of packets lost or marked.\
    \  For such a\n      short loss interval with N data packets, including K lost\
    \ or\n      marked data packets, the loss interval length is calculated as\n \
    \     N/K, instead of as N.  This is specified for TFRC-SP in Section\n      4.4\
    \ of [RFC4828].  If the sender is computing the loss event rate,\n      the Dropped\
    \ Packets option specified in Section 8.7 is required,\n      in addition to the\
    \ default CCID 3's Loss Intervals option.\n      Section 8.7 describes the use\
    \ of the Dropped Packets option in\n      calculating the loss event rate.  The\
    \ computation of the loss rate\n      by the receiver for the Loss Event Rate\
    \ option is described for\n      CCID 4 in Section 8.4 below.\n   o  The nominal\
    \ segment size: In TFRC-SP, the nominal segment size\n      used by the TCP throughput\
    \ equation is set to 1460 bytes.  This is\n      specified for TFRC-SP in Section\
    \ 4.5 of [RFC4828], and described\n      for CCID 4 in Section 5 below.\n"
- title: 2.  Conventions
  contents:
  - "2.  Conventions\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n\
    \   Additional terminology is described in Section 2 of [RFC4342].\n"
- title: 3.  Usage
  contents:
  - "3.  Usage\n   Like CCID 3, CCID 4's congestion control is appropriate for flows\n\
    \   that would prefer to minimize abrupt changes in the sending rate,\n   including\
    \ streaming media applications with small or moderate\n   receiver buffering before\
    \ playback.\n   CCID 4 is designed to be used either by applications that use\
    \ a small\n   fixed segment size, or by applications that change their sending\
    \ rate\n   by varying the segment size.  If CCID 4 is used by an application\n\
    \   that varies its segment size in response to changes in the allowed\n   sending\
    \ rate in bps, we note that CCID 4 doesn't dictate the segment\n   size to be\
    \ used by the application; this is done by the application\n   itself.  The CCID\
    \ 4 sender determines the allowed sending rate in\n   bps, in response to on-going\
    \ feedback from the CCID 4 receiver, and\n   the application can use information\
    \ about the current allowed sending\n   rate to decide whether to change the current\
    \ segment size.\n   We note that in some environments, there will be a feedback\
    \ loop,\n   with changes in the packet size or in the sending rate in bps\n  \
    \ affecting congestion along the path, therefore affecting the allowed\n   sending\
    \ rate in the future.\n"
- title: 3.1.  Relationship with TFRC and TFRC-SP
  contents:
  - "3.1.  Relationship with TFRC and TFRC-SP\n   The congestion control mechanisms\
    \ described here follow the TFRC-SP\n   mechanism specified in [RFC4828].  As\
    \ with CCID 3, conformant CCID 4\n   implementations MAY track updates to the\
    \ TCP throughput equation\n   directly, as updates are standardized in the IETF,\
    \ rather than\n   waiting for revisions of this document.  This document is based\
    \ on\n   CCID 3 [RFC4342], TFRC, and TFRC-SP.  For TFRC, RFC 3448 [RFC3448]\n\
    \   has been obsoleted by RFC 5348 [RFC5348].\n"
- title: 3.2.  Example Half-Connection
  contents:
  - "3.2.  Example Half-Connection\n   This example shows the typical progress of\
    \ a half-connection using\n   CCID 4's TFRC Congestion Control, not including\
    \ connection initiation\n   and termination.  The example is informative, not\
    \ normative.  This\n   example differs from that for CCID 3 in [RFC4342] only\
    \ in one\n   respect; with CCID 4, the allowed transmit rate is determined by\n\
    \   [RFC4828] as well as by [RFC5348].\n   1. The sender transmits DCCP-Data packets,\
    \ where the sending rate is\n      governed by the allowed transmit rate as specified\
    \ in [RFC4828].\n      Each DCCP-Data packet has a sequence number, and the DCCP\
    \ header's\n      CCVal field contains the window counter value, used by the\n\
    \      receiver in determining when multiple losses belong in a single\n     \
    \ loss event.\n      In the typical case of an ECN-capable half-connection, each\
    \ DCCP-\n      Data and DCCP-DataAck packet is sent as ECN-capable, with either\n\
    \      the ECT(0) or the ECT(1) codepoint set.  The use of the ECN Nonce\n   \
    \   with TFRC is described in Section 9.\n   2. The receiver sends DCCP-Ack packets,\
    \ acknowledging the data\n      packets at least once per round-trip time, unless\
    \ the sender is\n      sending at a rate of less than one packet per round-trip\
    \ time\n      [RFC5348] (Section 6).  Each DCCP-Ack packet uses a sequence\n \
    \     number, identifying the most recent packet received from the\n      sender\
    \ and includes feedback about the recent loss intervals\n      experienced by\
    \ the receiver.\n   3. The sender continues sending DCCP-Data packets as controlled\
    \ by\n      the allowed transmit rate.  Upon receiving DCCP-Ack packets, the\n\
    \      sender updates its allowed transmit rate as specified in [RFC5348]\n  \
    \    (Section 4.3) and [RFC4828].  This update is based upon a loss\n      event\
    \ rate calculated by the sender, based on the receiver's\n      loss-interval\
    \ feedback.  If it prefers, the sender can also use a\n      loss event rate calculated\
    \ and reported by the receiver.\n   4. The sender estimates round-trip times and\
    \ calculates a nofeedback\n      time, as specified in [RFC5348] (Section 4.4).\
    \  If no feedback is\n      received from the receiver in that time (at least\
    \ four round-trip\n      times), the sender halves its sending rate.\n"
- title: 4.  Connection Establishment
  contents:
  - "4.  Connection Establishment\n   The connection establishment is as specified\
    \ in Section 4 of\n   [RFC4342].\n"
- title: 5.  Congestion Control on Data Packets
  contents:
  - "5.  Congestion Control on Data Packets\n   CCID 4 uses the congestion control\
    \ mechanisms of TFRC [RFC5348] and\n   TFRC-SP [RFC4828].  [RFC4828] MUST be considered\
    \ normative except\n   where specifically indicated.\n   Loss Event Rate\n   As\
    \ with CCID 3, the basic operation of CCID 4 centers around the\n   calculation\
    \ of a loss event rate: the number of loss events as a\n   fraction of the number\
    \ of packets transmitted, weighted over the last\n   several loss intervals. \
    \ For CCID 4, this loss event rate, a round-\n   trip time estimate, and a nominal\
    \ packet size of 1460 bytes are\n   plugged into the TCP throughput equation,\
    \ as specified in RFC 5348\n   (Section 3.1) and [RFC4828].\n   Because CCID 4\
    \ is intended for applications that send small packets,\n   the allowed transmit\
    \ rate derived from the TCP throughput equation is\n   reduced by a factor that\
    \ accounts for packet header size, as\n   specified in Section 4.2 of [RFC4828].\
    \  The header size on data\n   packets is estimated as 36 bytes (20 bytes for\
    \ the IPv4 header and 16\n   bytes for the DCCP-Data header with 48-bit sequence\
    \ numbers).  If the\n   DCCP sender is sending N-byte data packets, the allowed\
    \ transmit rate\n   is reduced by N/(N+36).  CCID 4 senders are limited to this\
    \ fair\n   rate.  The header size would be 32 bytes instead of 36 bytes when\n\
    \   24-bit sequence numbers were used in the DCCP-Data header.\n   As explained\
    \ in Section 4.2 of [RFC4828], the actual header could be\n   larger or smaller\
    \ than the assumed value due to IP or DCCP options,\n   IPv6, IP tunnels, header\
    \ compression, and the like.  Because we are\n   only aiming at rough fairness,\
    \ and at a rough incentive for\n   applications, the default use of a 32-byte\
    \ or 36-byte header in the\n   calculations of the header bandwidth is sufficient\
    \ for both IPv4 and\n   IPv6.\n   If the sender is calculating the loss event\
    \ rate itself, the loss\n   event rate can be calculated using recent loss interval\
    \ lengths\n   reported by the receiver.  Loss intervals are precisely defined\
    \ in\n   Section 6.1 of [RFC4342], with the modification in [RFC4828] (Section\n\
    \   3) for loss intervals of at most two round-trip times.  In summary, a\n  \
    \ loss interval is up to 1 RTT of possibly lost or ECN-marked data\n   packets,\
    \ followed by an arbitrary number of non-dropped, non-marked\n   data packets.\
    \  The CCID 3 Loss Intervals option is used to report\n   loss interval lengths;\
    \ see Section 8.6.\n   For loss intervals of at most two round-trip times, CCID\
    \ 4 calculates\n   the loss event rate for that interval by counting the number\
    \ of\n   packets lost or marked, as described in Section 4.4 of [RFC4828].\n \
    \  Thus, for such a short loss interval with N data packets, including K\n   lost\
    \ or marked data packets, the loss interval length is calculated\n   as N/K, instead\
    \ as N.  The Dropped Packets option is used to report\n   K, the count of lost\
    \ or marked data packets.\n   Unlike CCID 3, the CCID 4 sender enforces a minimum\
    \ interval of 10 ms\n   between data packets, regardless of the allowed transmit\
    \ rate.  If\n   operating system scheduling granularity makes this impractical,\
    \ up to\n   one additional packet MAY be sent per timeslice, providing that no\n\
    \   more than three packets are sent in any 30 ms interval.\n   Other Congestion\
    \ Control Mechanisms\n   The other congestion control mechanisms such as slow-start\
    \ and\n   feedback packets are exactly as in CCID 3, and are described in the\n\
    \   subsection on \"Other Congestion Control Mechanisms\" of Section 5 in\n  \
    \ [RFC4342].\n"
- title: 5.1.  Response to Idle and Application-Limited Periods
  contents:
  - "5.1.  Response to Idle and Application-Limited Periods\n   This is described\
    \ in Section 5.1 of [RFC4342].  If Faster Restart is\n   standardized in the IETF\
    \ for TFRC [KFS07], then Faster Restart MAY be\n   implemented in CCID4 without\
    \ having to wait for an explicit update to\n   this document.\n"
- title: 5.2.  Response to Data Dropped and Slow Receiver
  contents:
  - "5.2.  Response to Data Dropped and Slow Receiver\n   This is described in Section\
    \ 5.2 of [RFC4342].\n"
- title: 5.3.  Packet Sizes
  contents:
  - "5.3.  Packet Sizes\n   CCID 4 is intended for applications that use a fixed small\
    \ segment\n   size, or that vary their segment size in response to congestion.\n\
    \   The CCID 4 sender uses a segment size of 1460 bytes in the TCP\n   throughput\
    \ equation.  This gives the CCID 4 sender roughly the same\n   sending rate in\
    \ bytes per second as a TFRC flow using 1460-byte\n   segments but experiencing\
    \ the same packet drop rate.\n"
- title: 6.  Acknowledgements
  contents:
  - "6.  Acknowledgements\n   The acknowledgements are as specified in Section 6 of\
    \ [RFC4342] with\n   the exception of the Loss Interval lengths specified below.\n"
- title: 6.1.  Loss Interval Definition
  contents:
  - "6.1.  Loss Interval Definition\n   The loss interval definition is as defined\
    \ in Section 6.1 of\n   [RFC4342], except as specified below.  Section 6.1.1 of\
    \ RFC 4342\n   specifies that for all loss intervals except the first one, the\
    \ data\n   length equals the sequence length minus the number of non-data\n  \
    \ packets the sender transmitted during the loss interval, with a\n   minimum\
    \ data length of one packet.  For short loss intervals of at\n   most two round-trip\
    \ times, TFRC-SP computes the loss interval length\n   as the data length divided\
    \ by the number of dropped or marked data\n   packets (rather than as the data\
    \ length of the loss interval).\n   Section 5.4 of RFC 4342 describes when to\
    \ use the most recent loss\n   interval in the calculation of the average loss\
    \ interval.  [RFC4828]\n   adds to this procedure the restriction that the most\
    \ recent loss\n   interval is only used in the calculation of the average loss\
    \ interval\n   if the most recent loss interval is greater than two round-trip\n\
    \   times.  The pseudocode is given in Section 3 of [RFC4828].\n"
- title: 6.2.  Congestion Control on Acknowledgements
  contents:
  - "6.2.  Congestion Control on Acknowledgements\n   The congestion control on acknowledgements\
    \ is as specified in Section\n   6.2 of [RFC4342].\n"
- title: 6.3.  Acknowledgements of Acknowledgements
  contents:
  - "6.3.  Acknowledgements of Acknowledgements\n   Procedures for the acknowledgement\
    \ of acknowledgements are as\n   specified in Section 6.3 of [RFC4342].\n"
- title: 6.4.  Quiescence
  contents:
  - "6.4.  Quiescence\n   The procedure for detecting that the sender has gone quiescent\
    \ is as\n   specified in Section 6.4 of [RFC4342].\n"
- title: 7.  Explicit Congestion Notification
  contents:
  - "7.  Explicit Congestion Notification\n   Procedures for the use of Explicit Congestion\
    \ Notification (ECN) are\n   as specified in Section 7 of [RFC4342].\n"
- title: 8.  Options and Features
  contents:
  - "8.  Options and Features\n   CCID 4 can make use of DCCP's Ack Vector, Timestamp,\
    \ Timestamp Echo,\n   and Elapsed Time options, and its Send Ack Vector and ECN\
    \ Incapable\n   features.  CCID 4 also imports the currently defined CCID-3-specific\n\
    \   options and features [RFC4342], augmented by the Dropped Packets\n   option\
    \ specified in this document.  Each CCID4-specific option and\n   feature contains\
    \ the same data as the corresponding CCID 3 option or\n   feature, and is interpreted\
    \ in the same way, except as specified\n   elsewhere in this document (or in a\
    \ subsequent IETF standards-track\n   RFC that updates or obsoletes this specification).\n\
    \                Option                        DCCP-   Section\n       Type  \
    \   Length     Meaning            Data?  Reference\n       -----    ------   \
    \  -------            -----  ---------\n      128-183              Unassigned\n\
    \      184-190              Reserved for\n                            experimental\n\
    \                            and testing use\n        191                Unassigned\n\
    \        192        6       Loss Event Rate      N      8.5\n        193     variable\
    \   Loss Intervals       N      8.6\n        194        6       Receive Rate \
    \        N      8.3\n        195     variable   Dropped Packets      N      8.7\n\
    \      196-247              Unassigned\n      248-254              Reserved for\n\
    \                            experimental\n                            and testing\
    \ use\n        255                Unassigned\n                         Table 1:\
    \ DCCP CCID 4 Options\n   The \"DCCP-Data?\" column indicates that all currently\
    \ defined CCID4-\n   specific options MUST be ignored when they occur on DCCP-Data\n\
    \   packets.\n   As with CCID 3, the following CCID-specific features are also\n\
    \   defined.\n      Number   Meaning                  Rule   Value  Req'd Reference\n\
    \      ------   -------                  -----  -----  ----- ---------\n     \
    \ 128-183  Unassigned\n      184-190  Reserved for experimental\n            \
    \    and testing use\n        191    Unassigned\n        192    Send Loss Event\
    \ Rate      SP      0      N      8.4\n      193-247  Unassigned\n      248-254\
    \  Reserved for experimental\n                and testing use\n        255   \
    \ Unassigned\n                     Table 2: DCCP CCID 4 Feature Numbers\n   More\
    \ information is available in Section 8 of [RFC4342].\n"
- title: 8.1.  Window Counter Value
  contents:
  - "8.1.  Window Counter Value\n   The use of the Window Counter Value in the DCCP\
    \ generic header's\n   CCVal field is as specified in Section 8.1 of [RFC4342].\
    \  In addition\n   to their use described in CCID 3, the CCVal counters are used\
    \ by the\n   receiver in CCID 4 to determine when the length of a loss interval\
    \ is\n   at most two round-trip times.  None of these procedures require the\n\
    \   receiver to maintain an explicit estimate of the round-trip time.\n   However,\
    \ Section 8.1 of [RFC4342] gives a procedure that implementors\n   may use if\
    \ they wish to keep such an RTT estimate using CCVal.\n"
- title: 8.2.  Elapsed Time Options
  contents:
  - "8.2.  Elapsed Time Options\n   The use of the Elapsed Time option is defined\
    \ in Section 8.2 of\n   [RFC4342].\n"
- title: 8.3.  Receive Rate Option
  contents:
  - "8.3.  Receive Rate Option\n   The Receive Rate option is as specified in Section\
    \ 8.3 of [RFC4342].\n"
- title: 8.4.  Send Loss Event Rate Feature
  contents:
  - "8.4.  Send Loss Event Rate Feature\n   The Send Loss Event Rate feature is as\
    \ defined in Section 8.4 of\n   [RFC4342].\n   See [RFC5348], Section 5, and [RFC4828],\
    \ Section 4.4, for a normative\n   calculation of the loss event rate.  Section\
    \ 4.4 of [RFC4828]\n   modifies the calculation of the loss interval size for\
    \ loss intervals\n   of at most two round-trip times.\n   If the CCID 4 receiver\
    \ is using the Loss Event Rate option, the\n   receiver needs to be able to determine\
    \ if a loss interval is short,\n   of at most two round-trip times.  The receiver\
    \ can heuristically\n   detect a short loss interval by using the Window Counter\
    \ in arriving\n   data packets.  The sender increases the Window Counter by 1\
    \ every\n   quarter of a round-trip time, with the caveat that the Window Counter\n\
    \   is never increased by more than five, modulo 16, from one data packet\n  \
    \ to the next.  Using the Window Counter to detect loss intervals of at\n   most\
    \ two round-trip times could result in some false positives, with\n   some longer\
    \ loss intervals incorrectly identified as short ones.  For\n   example, if the\
    \ loss interval contained data packets with only two\n   Window Counter values,\
    \ say, k and k+5, then the receiver could not\n   tell if the loss interval was\
    \ at most two round-trip times long or\n   not.  Similarly, if the sender sent\
    \ data packets with Window Counter\n   values of 4, 8, 12, 0, 5, but the packets\
    \ with Window Counter values\n   of 8, 12, and 0 were lost in the network, then\
    \ the receiver would\n   only receive data packets with Window Counter values\
    \ of 4 and 5, and\n   would incorrectly infer that the loss interval was at most\
    \ two round-\n   trip times.\n"
- title: 8.5.  Loss Event Rate Option
  contents:
  - "8.5.  Loss Event Rate Option\n   The Loss Event Rate option is as specified in\
    \ Section 8.5 of\n   [RFC4342].\n   See [RFC5348] (Section 5) and [RFC4828] for\
    \ a normative calculation\n   of the loss event rate.\n"
- title: 8.6.  Loss Intervals Option
  contents:
  - "8.6.  Loss Intervals Option\n   The Loss Intervals option is as specified in\
    \ Section 8.6 of\n   [RFC4342].\n"
- title: 8.7.  Dropped Packets Option
  contents:
  - "8.7.  Dropped Packets Option\n   This section describes the Dropped Packets option,\
    \ a mechanism for\n   reporting the number of lost and marked packets per loss\
    \ interval.\n   By reporting both the Loss Intervals and Dropped Packets options\
    \ on\n   the feedback packets, the receiver gives the sender sufficient\n   information\
    \ to calculate the loss event rate, or to verify the\n   calculation of the reported\
    \ loss event rate, if the sender so\n   desires.\n   The core information reported\
    \ by CCID 4 receivers is a list of recent\n   loss intervals, where a loss interval\
    \ begins with a lost or ECN-\n   marked data packet; continues with at most one\
    \ round-trip time's\n   worth of packets that may or may not be lost or marked;\
    \ and completes\n   with an arbitrarily long series of non-dropped, non-marked\
    \ data\n   packets.  Loss intervals model the congestion behavior of TCP NewReno\n\
    \   senders, which reduce their sending rate at most once per window of\n   data\
    \ packets.  Consequently, the number of packets lost in a loss\n   interval is\
    \ not important for either TCP's or TFRC's congestion\n   response.  CCID 3's\
    \ Loss Intervals option reports the length of each\n   loss interval's lossy part,\
    \ not the number of packets that were\n   actually lost or marked in that lossy\
    \ part.\n   However, for computing the loss event rate for periods that include\n\
    \   short loss intervals the TFRC-SP sender needs to know the number of\n   packets\
    \ lost or marked in a loss interval, over and above the length\n   of the loss\
    \ interval in packets.  The Dropped Packets option, a\n   CCID4-specific option,\
    \ reports this information.  Together with the\n   existing Loss Intervals option,\
    \ the Dropped Packets option allows the\n   CCID 4 sender to discover exactly\
    \ how many packets were dropped from\n   each loss interval.  The receiver reports\
    \ the number of lost or\n   marked packets in its recently observed loss intervals\
    \ using the\n   Dropped Packets option.\n   The Dropped Packets Option is specified\
    \ as follows:\n      +--------+--------+-------...-------+--------+-------\n \
    \     |11000011| Length |   Drop Count    | More Drop Counts...\n      +--------+--------+-------...-------+--------+-------\n\
    \       Type=195               3 bytes\n            Figure 1: Dropped Packets\
    \ Option\n   The Dropped Packets option contains information about one to 84\n\
    \   consecutive loss intervals, always including the most recent loss\n   interval.\
    \  As with the Loss Intervals option, intervals are listed in\n   reverse chronological\
    \ order.  Should more than 84 loss intervals need\n   to be reported, multiple\
    \ Dropped Packets options can be sent; the\n   second option begins where the\
    \ first left off, and so forth.\n   One Drop Count is specified per loss interval.\
    \  Drop Count is a 24-\n   bit number that equals the number of packets, lost\
    \ or received, ECN-\n   marked during the corresponding loss interval.  By definition,\
    \ this\n   number MUST NOT exceed the corresponding loss interval's Loss Length.\n\
    \   CCID 4 receivers MUST report Dropped Packets options with every\n   feedback\
    \ packet.  Any packet containing a Loss Intervals option MUST\n   also contain\
    \ a Dropped Packets option covering the same loss\n   intervals.  If a feedback\
    \ packet does not include a relevant Dropped\n   Packets option, and the CCID\
    \ 4 sender is computing the loss event\n   rate itself, the sender MUST treat\
    \ the relevant loss intervals' Drop\n   Counts as equal to the corresponding Loss\
    \ Lengths, as specified\n   below.\n   Consider a CCID 4 receiver.  As specified\
    \ in Section 8.6.1 of RFC\n   4342, the receiver sends the Loss Intervals option\
    \ for all intervals\n   that have not been acknowledged by the sender.  When this\
    \ receiver\n   sends a feedback packet containing information about the N most\n\
    \   recent loss intervals (packaged in one or more Loss Intervals\n   options),\
    \ then the receiver includes on the same feedback packet one\n   or more Dropped\
    \ Packets options covering exactly those N loss\n   intervals.  CCID 4 senders\
    \ MUST ignore Drop Counts information for\n   loss intervals not covered by a\
    \ Loss Intervals option on the same\n   feedback packet.  Conversely, a CCID 4\
    \ sender might want to\n   interpolate Drop Counts information for a loss interval\
    \ not covered\n   by any Dropped Packets options; such a sender MUST use the\n\
    \   corresponding loss interval's Loss Length as its Drop Count.\n   Each loss\
    \ interval's Drop Count MUST, by definition, be less than or\n   equal to its\
    \ Loss Length.  A Drop Count that exceeds the\n   corresponding Loss Length MUST\
    \ be treated as equal to the Loss\n   Length.\n"
- title: 8.7.1.  Example
  contents:
  - "8.7.1.  Example\n   Consider the following sequence of packets, where \"-\" represents\
    \ a\n   safely delivered packet and \"*\" represents a lost or marked packet.\n\
    \   This sequence is repeated from [RFC4342].\n      Sequence\n       Numbers:\
    \ 0         10        20        30        40  44\n                |         |\
    \         |         |         |   |\n                ----------*--------***-*--------*----------*-\n\
    \      Figure 2:  Sequence of Delivered (-) and Lost (*) Packets\n   Assuming\
    \ that packet 43 was lost, not marked, this sequence might be\n   divided into\
    \ loss intervals as follows:\n      0         10        20        30        40\
    \  44\n      |         |         |         |         |   |\n      ----------*--------***-*--------*----------*-\n\
    \      \\________/\\_______/\\___________/\\_________/\n          L0       L1\
    \         L2          L3\n      Figure 3:  Loss Intervals for the Packet Sequence\n\
    \   A Loss Intervals option sent on a packet with Acknowledgement Number\n   44\
    \ to acknowledge this set of loss intervals might contain the bytes\n   193,39,2,\
    \ 0,0,10, 128,0,1, 0,0,10, 0,0,8, 0,0,5, 0,0,10, 0,0,8,\n   0,0,1, 0,0,8, 0,0,10,\
    \ 128,0,0, 0,0,15; for interpretation of this\n   option, see [RFC4342].  A Dropped\
    \ Packets option sent in tandem on\n   this packet would contain the bytes 195,14,\
    \ 0,0,1, 0,0,4, 0,0,1,\n   0,0,0.  This is interpreted as follows.\n   195 The\
    \ Dropped Packets option number.\n   14       The length of the option, including\
    \ option type and length\n            bytes.  This option contains information\
    \ about (14 - 2)/3 =\n            4 loss intervals.  Note that the two most recent\
    \ sequence\n            numbers are not yet part of any loss interval -- the Loss\n\
    \            Intervals option includes them in its Skip Length -- and are\n  \
    \          thus not included in the Dropped Packets option.\n   0,0,1    These\
    \ bytes define the Drop Count for L3, which is 1.  As\n            required, the\
    \ Drop Count is less than or equal to L3's Loss\n            Length, which is\
    \ also 1.\n   0,0,4    The Drop Count for L2 is 4.\n   0,0,1    The Drop Count\
    \ for L1 is 1.\n   0,0,0    Finally, the Drop Count for L0 is 0.\n"
- title: 9.  Verifying Congestion Control Compliance with ECN
  contents:
  - "9.  Verifying Congestion Control Compliance with ECN\n   Verifying congestion\
    \ control compliance with ECN is as discussed in\n   Section 9 of [RFC4342].\n"
- title: 9.1.  Verifying the ECN Nonce Echo
  contents:
  - "9.1.  Verifying the ECN Nonce Echo\n   Procedures for verifying the ECN Nonce\
    \ Echo are as specified in\n   Section 9.1 of [RFC4342].\n"
- title: 9.2.  Verifying the Reported Loss Intervals and Loss Event Rate
  contents:
  - "9.2.  Verifying the Reported Loss Intervals and Loss Event Rate\n   Section 9.2\
    \ of [RFC4342] discusses the sender's possible verification\n   of loss intervals\
    \ and loss event rate information reported by the\n   receiver.\n"
- title: 10.  Implementation Issues
  contents:
  - '10.  Implementation Issues

    '
- title: 10.1.  Timestamp Usage
  contents:
  - "10.1.  Timestamp Usage\n   The use of the Timestamp option is as discussed in\
    \ Section 10.1 of\n   [RFC4342].\n"
- title: 10.2.  Determining Loss Events at the Receiver
  contents:
  - "10.2.  Determining Loss Events at the Receiver\n   The use of the window counter\
    \ by the receiver to determine if\n   multiple lost packets belong to the same\
    \ loss event is as described\n   in Section 10.2 of [RFC4342].\n"
- title: 10.3.  Sending Feedback Packets
  contents:
  - "10.3.  Sending Feedback Packets\n   The procedure for sending feedback packets\
    \ is as described in Section\n   10.3 of [RFC4342].\n"
- title: 11.  Design Considerations
  contents:
  - "11.  Design Considerations\n   This section discusses design considerations for\
    \ the field sizes in\n   the Loss Intervals and Dropped Packets options.\n"
- title: 11.1.  The Field Size in the Loss Intervals Option
  contents:
  - "11.1.  The Field Size in the Loss Intervals Option\n   Section 8.6 of RFC 4342\
    \ specifies a Loss Intervals option with three\n   fields for each loss interval,\
    \ for reporting the Lossless Length,\n   Loss Length, and Data Length.  Each field\
    \ is specified to be three\n   bytes.  Section 8.6 of this document specifies\
    \ that CCID 4 use the\n   same Loss Intervals option as CCID 3, with the same\
    \ field sizes.\n   This has the significant advantage of minimizing the implementation\n\
    \   differences between CCID 3 and CCID 4.  However, it has been\n   suggested\
    \ that CCID 4 *could* use a Loss Intervals option with\n   smaller field sizes,\
    \ since a CCID 4 sender enforces a minimum\n   interval of 10 ms between data\
    \ packets.  This section explains the\n   reason for CCID 4 to use the same Loss\
    \ Intervals option as specified\n   for CCID 3.\n   The Lossless Length field\
    \ reports the number of packets in the loss\n   intervals' lossless part, and\
    \ the Loss Length field reports the\n   number of packets in the loss interval's\
    \ lossy part.  The Data Length\n   field reports the number of packets in the\
    \ loss interval's data\n   length (excluding non-data packets).  A two-byte Data\
    \ Length field\n   can report a data length of 65,536 packets, corresponding to\
    \ a loss\n   event rate of 0.00002; this is enough to give the CCID 4 sender an\n\
    \   allowed sending rate of roughly 250 packets per RTT, which is enough\n   for\
    \ a connection with a round-trip time of at most 2.5 seconds.  For\n   a CCID\
    \ 4 connection with a larger round-trip time, the three-byte\n   Lossless Length\
    \ and Data Length fields would be needed.\n   For the Loss Length field in the\
    \ Loss Intervals option, reporting the\n   number of packets in the one-RTT lossy\
    \ part of the loss interval, a\n   one-byte field would not be sufficient for\
    \ a CCID 4 connection with a\n   long RTT (three seconds or longer).  For the\
    \ Loss Length field, a\n   two-byte field should be sufficient for CCID 4.  However,\
    \ our\n   judgement is that the advantages of using the same Loss Intervals\n\
    \   option as in CCID 3 outweigh any advantages of using a CCID 4 Loss\n   Intervals\
    \ option that uses eight bytes instead of nine bytes for\n   reporting the fields\
    \ for each loss interval.\n"
- title: 11.2.  The Field Size in the Dropped Packets Option
  contents:
  - "11.2.  The Field Size in the Dropped Packets Option\n   Section 8.7 specifies\
    \ the Dropped Packets option for reporting the\n   number of lost or marked packets\
    \ per loss interval, allocating three\n   bytes for the drop count field for each\
    \ loss interval reported.  The\n   three-byte field is partly for simplicity,\
    \ to give the same field\n   size as the fields in the Loss Intervals option specified\
    \ in RFC\n   4342.  It has been suggested that CCID 4 *could* use a smaller field\n\
    \   size for the Dropped Packets option.  This section discusses the\n   issue\
    \ of the size of the drop count field in the Dropped Packets\n   option.\n   It\
    \ is not necessary to specify a three-byte field for the Dropped\n   Packets option.\
    \  A one-byte field would allow a reported drop count\n   of 255, and a two-byte\
    \ field would allow a reported drop count of\n   65,535.  A two-byte field would\
    \ clearly be sufficient for the drop\n   count field for CCID 4.\n   In fact,\
    \ a one-byte field would *probably* be adequate for reporting\n   the drop count\
    \ for a loss interval in a CCID 4 connection.  Because a\n   CCID 4 sender enforces\
    \ a minimum interval of 10 ms between data\n   packets, a sender would need a\
    \ round-trip time of over 2.55 seconds\n   to have more than 255 packets lost\
    \ or marked in a single loss\n   interval;  round-trip times of greater than three\
    \ seconds are not\n   unusual for some flows traversing satellite links.  The\
    \ drop count\n   field is used in CCID 4 to compute the actual loss rate for short\n\
    \   loss intervals, rather than using the loss event rate that is used\n   for\
    \ longer loss intervals.  If a loss interval of at most two round-\n   trip times\
    \ included N packets sent, with more than 255 of those\n   packets lost or marked,\
    \ a drop count field of one byte would allow a\n   drop count of at most 255 to\
    \ be reported, resulting in a computed\n   loss rate for that interval of 255/N.\
    \  This loss rate might be less\n   than the actual loss rate, but it is significantly\
    \ higher than the\n   loss event rate of 1/N, and should be sufficient to prevent\
    \ a steady-\n   state condition of a CCID 4 connection with multiple packets dropped\n\
    \   each round-trip time.  Thus, a one-byte field would probably be\n   adequate\
    \ for reporting the drop count for a loss interval in a CCID 4\n   connection.\
    \  However, at the moment this document specifies a three-\n   byte field, for\
    \ consistency with the field size in the Loss Intervals\n   option.\n"
- title: 12.  Experimental Status of This Document
  contents:
  - "12.  Experimental Status of This Document\n   TFRC-SP is a congestion control\
    \ mechanism defined in RFC 4828.\n   Section 10 of [RFC4828] describes why TFRC-SP\
    \ is currently specified\n   as experimental and why it is not intended for widespread\
    \ deployment\n   at this time in the global Internet.  Since TFRC-SP is Experimental,\n\
    \   CCID 4 is therefore also considered experimental.  If the IETF\n   publishes\
    \ a Standards-Track RFC that changes the status of TFRC-SP,\n   then CCID 4 should\
    \ then be updated to reflect the change of status.\n"
- title: 13.  Security Considerations
  contents:
  - "13.  Security Considerations\n   Security considerations include those discussed\
    \ in Section 11 of\n   [RFC4342].  There are no new security considerations introduced\
    \ by\n   CCID 4.\n"
- title: 14.  IANA Considerations
  contents:
  - "14.  IANA Considerations\n   This specification defines the value 4 in the DCCP\
    \ CCID namespace\n   managed by IANA.  This is a permanent codepoint, as is needed\
    \ for\n   experimentation across the Internet using different codebases.\n   CCID\
    \ 4 also uses three sets of numbers whose values have been\n   allocated by IANA,\
    \ namely CCID4-specific Reset Codes, option types,\n   and feature numbers.  This\
    \ document makes no particular allocations\n   from the Reset Code range, except\
    \ for experimental and testing use\n   [RFC3692].  We refer to the Standards Action\
    \ policy outlined in\n   [RFC5226].\n"
- title: 14.1.  Reset Codes
  contents:
  - "14.1.  Reset Codes\n   Each entry in the DCCP CCID 4 Reset Code registry contains\
    \ a CCID4-\n   specific Reset Code, which is a number in the range 128-255; a\
    \ short\n   description of the Reset Code; and a reference to the RFC defining\n\
    \   the Reset Code.  Reset Codes 184-190 and 248-254 are permanently\n   reserved\
    \ for experimental and testing use.  The remaining Reset Codes\n   -- 128-183,\
    \ 191-247, and 255 -- are currently reserved, and should be\n   allocated with\
    \ the Standards Action policy, which requires IESG\n   review and approval and\
    \ Standards-Track IETF RFC publication.\n"
- title: 14.2.  Option Types
  contents:
  - "14.2.  Option Types\n   Each entry in the DCCP CCID 4 option type registry contains\
    \ a CCID4-\n   specific option type, which is a number in the range 128-255; the\n\
    \   name of the option, such as \"Loss Intervals\"; and a reference to the\n \
    \  RFC defining the option type.  The registry is initially populated\n   using\
    \ the values in Table 1, in Section 8.  This includes the value\n   195 allocated\
    \ for the Dropped Packets option.  This document\n   allocates option types 192-195,\
    \ and option types 184-190 and 248-254\n   are permanently reserved for experimental\
    \ and testing use.  The\n   remaining option types -- 128-183, 191, 196-247, and\
    \ 255 -- are\n   currently reserved, and should be allocated with the Standards\
    \ Action\n   policy, which requires IESG review and approval and Standards-Track\n\
    \   IETF RFC publication.\n"
- title: 14.3.  Feature Numbers
  contents:
  - "14.3.  Feature Numbers\n   Each entry in the DCCP CCID 4 feature number registry\
    \ contains a\n   CCID4-specific feature number, which is a number in the range\
    \ 128-\n   255; the name of the feature, such as \"Send Loss Event Rate\"; and\
    \ a\n   reference to the RFC defining the feature number.  The registry is\n \
    \  initially populated using the values in Table 2, in Section 8.  This\n   document\
    \ allocates feature number 192, and feature numbers 184-190\n   and 248-254 are\
    \ permanently reserved for experimental and testing\n   use.  The remaining feature\
    \ numbers -- 128-183, 191, 193-247, and 255\n   -- are currently reserved, and\
    \ should be allocated with the Standards\n   Action policy, which requires IESG\
    \ review and approval and Standards-\n   Track IETF RFC publication.\n"
- title: 15.  Thanks
  contents:
  - "15.  Thanks\n   We thank Gorry Fairhurst, Alfred Hoenes, Ian McDonald, Gerrit\
    \ Renker,\n   and Leandro Sales for feedback on this document.\n"
- title: 16.  References
  contents:
  - '16.  References

    '
- title: 16.1.  Normative References
  contents:
  - "16.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC3448]  Handley, M., Floyd, S., Padhye, J., and J. Widmer, \"TCP\n\
    \              Friendly Rate Control (TFRC): Protocol Specification\", RFC\n \
    \             3448, January 2003.\n   [RFC3692]  Narten, T., \"Assigning Experimental\
    \ and Testing Numbers\n              Considered Useful\", BCP 82, RFC 3692, January\
    \ 2004.\n   [RFC4340]  Kohler, E., Handley, M., and S. Floyd, \"Datagram\n   \
    \           Congestion Control Protocol (DCCP)\", RFC 4340, March 2006.\n   [RFC4342]\
    \  Floyd, S., Kohler, E., and J. Padhye, \"Profile for\n              Datagram\
    \ Congestion Control Protocol (DCCP) Congestion\n              Control ID 3: TCP-Friendly\
    \ Rate Control (TFRC)\", RFC 4342,\n              March 2006.\n   [RFC4828]  Floyd,\
    \ S. and E. Kohler, \"TCP Friendly Rate Control\n              (TFRC): The Small-Packet\
    \ (SP) Variant\", RFC 4828, April\n              2007.\n   [RFC5226]  Narten,\
    \ T. and H. Alvestrand, \"Guidelines for Writing an\n              IANA Considerations\
    \ Section in RFCs\", BCP 26, RFC 5226,\n              May 2008.\n   [RFC5348]\
    \  Floyd, S., Handley, M., Padhye, J., and J. Widmer, \"TCP\n              Friendly\
    \ Rate Control (TFRC): Protocol Specification\", RFC\n              5348, September\
    \ 2008.\n"
- title: 16.2.  Informative References
  contents:
  - "16.2.  Informative References\n   [KFS07]    Kohler, E., Floyd, S., and A. Sathiaseelan,\
    \ \"Faster\n              Restart for TCP Friendly Rate Control (TFRC)\", Work\
    \ in\n              Progress, July 2008.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Sally Floyd\n   ICSI Center for Internet Research\n  \
    \ 1947 Center Street, Suite 600\n   Berkeley, CA 94704\n   USA\n   EMail:  floyd@icir.org\n\
    \   Eddie Kohler\n   4531C Boelter Hall\n   UCLA Computer Science Department\n\
    \   Los Angeles, CA 90095\n   USA\n   EMail: kohler@cs.ucla.edu\n"
