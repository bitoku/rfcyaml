- title: __initial_text__
  contents:
  - '              Effects of Pervasive Encryption on Operators

    '
- title: Abstract
  contents:
  - "Abstract\n   Pervasive monitoring attacks on the privacy of Internet users are\
    \ of\n   serious concern to both user and operator communities.  RFC 7258\n  \
    \ discusses the critical need to protect users' privacy when developing\n   IETF\
    \ specifications and also recognizes that making networks\n   unmanageable to\
    \ mitigate pervasive monitoring is not an acceptable\n   outcome: an appropriate\
    \ balance is needed.  This document discusses\n   current security and network\
    \ operations as well as management\n   practices that may be impacted by the shift\
    \ to increased use of\n   encryption to help guide protocol development in support\
    \ of\n   manageable and secure networks.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It has been approved for\
    \ publication by the Internet\n   Engineering Steering Group (IESG).  Not all\
    \ documents approved by the\n   IESG are candidates for any level of Internet\
    \ Standard; see Section 2\n   of RFC 7841.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   https://www.rfc-editor.org/info/rfc8404.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2018 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (https://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   3\n     1.1.  Additional Background on Encryption Changes . . .\
    \ . . . .   5\n     1.2.  Examples of Attempts to Preserve Functions  . . . .\
    \ . . .   7\n   2.  Network Service Provider Monitoring Practices . . . . . .\
    \ . .   8\n     2.1.  Passive Monitoring  . . . . . . . . . . . . . . . . . .\
    \ .   8\n       2.1.1.  Traffic Surveys . . . . . . . . . . . . . . . . . . .\
    \   8\n       2.1.2.  Troubleshooting . . . . . . . . . . . . . . . . . . .  \
    \ 9\n       2.1.3.  Traffic-Analysis Fingerprinting . . . . . . . . . . .  11\n\
    \     2.2.  Traffic Optimization and Management . . . . . . . . . . .  12\n  \
    \     2.2.1.  Load Balancers  . . . . . . . . . . . . . . . . . . .  12\n    \
    \   2.2.2.  Differential Treatment Based on Deep Packet\n               Inspection\
    \ (DPI)  . . . . . . . . . . . . . . . . . .  14\n       2.2.3.  Network-Congestion\
    \ Management . . . . . . . . . . . .  16\n       2.2.4.  Performance-Enhancing\
    \ Proxies . . . . . . . . . . . .  16\n       2.2.5.  Caching and Content Replication\
    \ near the Network Edge  17\n       2.2.6.  Content Compression . . . . . . .\
    \ . . . . . . . . . .  18\n       2.2.7.  Service Function Chaining . . . . .\
    \ . . . . . . . . .  18\n     2.3.  Content Filtering, Network Access, and Accounting\
    \ . . . .  19\n       2.3.1.  Content Filtering . . . . . . . . . . . . . . .\
    \ . . .  19\n       2.3.2.  Network Access and Data Usage . . . . . . . . . .\
    \ . .  20\n       2.3.3.  Application Layer Gateways (ALGs) . . . . . . . . .\
    \ .  21\n       2.3.4.  HTTP Header Insertion . . . . . . . . . . . . . . . .\
    \  22\n   3.  Encryption in Hosting and Application SP Environments . . . .  23\n\
    \     3.1.  Management-Access Security  . . . . . . . . . . . . . . .  23\n  \
    \     3.1.1.  Monitoring Customer Access  . . . . . . . . . . . . .  24\n    \
    \   3.1.2.  SP Content Monitoring of Applications . . . . . . . .  24\n     3.2.\
    \  Hosted Applications . . . . . . . . . . . . . . . . . . .  26\n       3.2.1.\
    \  Monitoring Managed Applications . . . . . . . . . . .  27\n       3.2.2.  Mail\
    \ Service Providers  . . . . . . . . . . . . . . .  27\n     3.3.  Data Storage\
    \  . . . . . . . . . . . . . . . . . . . . . .  28\n       3.3.1.  Object-Level\
    \ Encryption . . . . . . . . . . . . . . .  28\n       3.3.2.  Disk Encryption,\
    \ Data at Rest (DAR) . . . . . . . . .  29\n       3.3.3.  Cross-Data-Center Replication\
    \ Services  . . . . . . .  29\n   4.  Encryption for Enterprises  . . . . . .\
    \ . . . . . . . . . . .  30\n     4.1.  Monitoring Practices of the Enterprise\
    \  . . . . . . . . .  30\n       4.1.1.  Security Monitoring in the Enterprise\
    \ . . . . . . . .  31\n       4.1.2.  Monitoring Application Performance in the\
    \ Enterprise   32\n       4.1.3.  Diagnostics and Troubleshooting for Enterprise\n\
    \               Networks  . . . . . . . . . . . . . . . . . . . . . .  33\n  \
    \   4.2.  Techniques for Monitoring Internet-Session Traffic  . . .  34\n   5.\
    \  Security Monitoring for Specific Attack Types . . . . . . . .  36\n     5.1.\
    \  Mail Abuse and Spam . . . . . . . . . . . . . . . . . . .  37\n     5.2.  Denial\
    \ of Service . . . . . . . . . . . . . . . . . . . .  37\n     5.3.  Phishing\
    \  . . . . . . . . . . . . . . . . . . . . . . . .  38\n     5.4.  Botnets . .\
    \ . . . . . . . . . . . . . . . . . . . . . . .  39\n     5.5.  Malware . . .\
    \ . . . . . . . . . . . . . . . . . . . . . .  39\n     5.6.  Spoofed-Source IP\
    \ Address Protection  . . . . . . . . . .  39\n     5.7.  Further Work  . . .\
    \ . . . . . . . . . . . . . . . . . . .  39\n   6.  Application-Based Flow Information\
    \ Visible to a Network . . .  40\n     6.1.  IP Flow Information Export  . . .\
    \ . . . . . . . . . . . .  40\n     6.2.  TLS Server Name Indication  . . . .\
    \ . . . . . . . . . . .  40\n     6.3.  Application-Layer Protocol Negotiation\
    \ (ALPN) . . . . . .  41\n     6.4.  Content Length, Bitrate, and Pacing . . .\
    \ . . . . . . . .  42\n   7.  Effect of Encryption on the Evolution of Mobile\
    \ Networks  . .  42\n   8.  Response to Increased Encryption and Looking Forward\
    \  . . . .  43\n   9.  Security Considerations . . . . . . . . . . . . . . . .\
    \ . . .  43\n   10. IANA Considerations . . . . . . . . . . . . . . . . . . .\
    \ . .  44\n   11. Informative References  . . . . . . . . . . . . . . . . . .\
    \ .  44\n   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .\
    \  53\n   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  53\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   In response to pervasive monitoring revelations and the\
    \ IETF\n   consensus that pervasive monitoring is an attack [RFC7258], efforts\n\
    \   are underway to increase encryption of Internet traffic.  Pervasive\n   monitoring\
    \ is of serious concern to users, operators, and application\n   providers.  RFC\
    \ 7258 discusses the critical need to protect users'\n   privacy when developing\
    \ IETF specifications and also recognizes that\n   making networks unmanageable\
    \ to mitigate pervasive monitoring is not\n   an acceptable outcome; rather, an\
    \ appropriate balance would emerge\n   over time.\n   This document describes\
    \ practices currently used by network operators\n   to manage, operate, and secure\
    \ their networks and how those practices\n   may be impacted by a shift to increased\
    \ use of encryption.  It\n   provides network operators' perspectives about the\
    \ motivations and\n   objectives of those practices as well as effects anticipated\
    \ by\n   operators as use of encryption increases.  It is a summary of\n   concerns\
    \ of the operational community as they transition to managing\n   networks with\
    \ less visibility.  This document does not endorse the\n   use of the practices\
    \ described herein, nor does it aim to provide a\n   comprehensive treatment of\
    \ the effects of current practices, some of\n   which have been considered controversial\
    \ from a technical or business\n   perspectives or contradictory to previous IETF\
    \ statements (e.g.,\n   [RFC1958], [RFC1984], and [RFC2804]).  The following RFCs\
    \ consider\n   the end-to-end (e2e) architectural principle to be a guiding\n\
    \   principle for the development of Internet protocols [RFC2775]\n   [RFC3724]\
    \ [RFC7754].\n   This document aims to help IETF participants understand network\n\
    \   operators' perspectives about the impact of pervasive encryption,\n   both\
    \ opportunistic and strong end-to-end encryption, on operational\n   practices.\
    \  The goal is to help inform future protocol development to\n   ensure that operational\
    \ impact is part of the conversation.  Perhaps\n   new methods could be developed\
    \ to accomplish some of the goals of\n   current practices despite changes in\
    \ the extent to which cleartext\n   will be available to network operators (including\
    \ methods that rely\n   on network endpoints where applicable).  Discussion of\
    \ current\n   practices and the potential future changes is provided as a\n  \
    \ prerequisite to potential future cross-industry and cross-layer work\n   to\
    \ support the ongoing evolution towards a functional Internet with\n   pervasive\
    \ encryption.\n   Traditional network management, planning, security operations,\
    \ and\n   performance optimization have been developed on the Internet where a\n\
    \   large majority of data traffic flows without encryption.  While\n   unencrypted\
    \ traffic has made information that aids operations and\n   troubleshooting at\
    \ all layers accessible, it has also made pervasive\n   monitoring by unseen parties\
    \ possible.  With broad support and\n   increased awareness of the need to consider\
    \ privacy in all aspects\n   across the Internet, it is important to catalog existing\
    \ management,\n   operational, and security practices that have depended upon\
    \ the\n   availability of cleartext to function and to explore if critical\n \
    \  operational practices can be met by less-invasive means.\n   This document\
    \ refers to several different forms of Service Providers\n   (SPs).  For example,\
    \ network service providers (or network operators)\n   provide IP-packet transport\
    \ primarily, though they may bundle other\n   services with packet transport.\
    \  Alternatively, application service\n   providers primarily offer systems that\
    \ participate as an endpoint in\n   communications with the application user and\
    \ hosting service\n   providers lease computing, storage, and communications systems\
    \ in\n   data centers.  In practice, many companies perform two or more\n   service\
    \ provider roles but may be historically associated with one.\n   This document\
    \ includes a sampling of current practices and does not\n   attempt to describe\
    \ every nuance.  Some sections cover technologies\n   used over a broad spectrum\
    \ of devices and use cases.\n"
- title: 1.1.  Additional Background on Encryption Changes
  contents:
  - "1.1.  Additional Background on Encryption Changes\n   Pervasive encryption in\
    \ this document refers to all types of session\n   encryption including Transport\
    \ Layer Security (TLS), IP Security\n   (IPsec), TCPcrypt [TCPcrypt], QUIC [QUIC]\
    \ (IETF's specification of\n   Google's QUIC), and others that are increasingly\
    \ deployed.  It is\n   well understood that session encryption helps to prevent\
    \ both passive\n   and active attacks on transport protocols; more on pervasive\n\
    \   monitoring can be found in \"Confidentiality in the Face of Pervasive\n  \
    \ Surveillance: A Threat Model and Problem Statement\" [RFC7624].\n   Active attacks\
    \ have long been a motivation for increased encryption,\n   and preventing pervasive\
    \ monitoring became a focus just a few years\n   ago.  As such, the Internet Architecture\
    \ Board (IAB) released a\n   statement advocating for increased use of encryption\
    \ in November 2014\n   (see <https://www.iab.org/2014/11/14/iab-statement-on-internet-\n\
    \   confidentiality/>).  Perspectives on encryption paradigms have\n   shifted\
    \ over time to make ease of deployment a high priority and to\n   balance that\
    \ against providing the maximum possible level of\n   security, regardless of\
    \ deployment considerations.\n   One such shift is documented in Opportunistic\
    \ Security (OS)\n   [RFC7435], which suggests that when use of authenticated encryption\n\
    \   is not possible, cleartext sessions should be upgraded to\n   unauthenticated\
    \ session encryption, rather than no encryption.  OS\n   encourages upgrading\
    \ from cleartext but cannot require or guarantee\n   such upgrades.  Once OS is\
    \ used, it allows for an evolution to\n   authenticated encryption.  These efforts\
    \ are necessary to improve an\n   end user's expectation of privacy, making pervasive\
    \ monitoring cost\n   prohibitive.  With OS in use, active attacks are still possible\
    \ on\n   unauthenticated sessions.  OS has been implemented as NULL\n   Authentication\
    \ with IPsec [RFC7619], and there are a number of\n   infrastructure use cases\
    \ such as server-to-server encryption where\n   this mode is deployed.  While\
    \ OS is helpful in reducing pervasive\n   monitoring by increasing the cost to\
    \ monitor, it is recognized that\n   risk profiles for some applications require\
    \ authenticated and secure\n   session encryption as well prevention of active\
    \ attacks.  IPsec, and\n   other session encryption protocols, with authentication\
    \ has many\n   useful applications, and usage has increased for infrastructure\n\
    \   applications such as for virtual private networks between data\n   centers.\
    \  OS, as well as other protocol developments like the\n   Automated Certificate\
    \ Management Environment (ACME), have increased\n   the usage of session encryption\
    \ on the Internet.\n   Risk profiles vary and so do the types of session encryption\n\
    \   deployed.  To understand the scope of changes in visibility, a few\n   examples\
    \ are highlighted.  Work continues to improve the\n   implementation, development,\
    \ and configuration of TLS and DTLS\n   sessions to prevent active attacks used\
    \ to monitor or intercept\n   session data.  The changes from TLS 1.2 to 1.3 enhance\
    \ the security\n   of TLS, while hiding more of the session negotiation and providing\n\
    \   less visibility on the wire.  The Using TLS in Applications (UTA)\n   Working\
    \ Group has been publishing documentation to improve the\n   security of TLS and\
    \ DTLS sessions.  They have documented the known\n   attack vectors in [RFC7457],\
    \ have documented best practices for TLS\n   and DTLS in [RFC7525], and have other\
    \ documents in development.  The\n   recommendations from these documents were\
    \ built upon for TLS 1.3 to\n   provide a more inherently secure end-to-end protocol.\n\
    \   In addition to encrypted website access (HTTP over TLS), there are\n   other\
    \ well-deployed application-level transport encryption efforts\n   such as MTA-to-MTA\
    \ (mail transfer agent) session encryption transport\n   for email (SMTP over\
    \ TLS) and gateway-to-gateway for instant\n   messaging (the Extensible Messaging\
    \ and Presence Protocol (XMPP) over\n   TLS).  Although this does provide protection\
    \ from transport-layer\n   attacks, the servers could be a point of vulnerability\
    \ if user-to-\n   user encryption is not provided for these messaging protocols.\n\
    \   User-to-user content encryption schemes, such as S/MIME and Pretty\n   Good\
    \ Privacy (PGP) for email and Off-the-Record (OTR) encryption for\n   XMPP are\
    \ used by those interested in protecting their data as it\n   crosses intermediary\
    \ servers, preventing transport-layer attacks by\n   providing an end-to-end solution.\
    \  User-to-user schemes are under\n   review, and additional options will emerge\
    \ to ease the configuration\n   requirements, making this type of option more\
    \ accessible to\n   non-technical users interested in protecting their privacy.\n\
    \   Increased use of encryption, either opportunistic or authenticated,\n   at\
    \ the transport, network, or application layer, impacts how networks\n   are operated,\
    \ managed, and secured.  In some cases, new methods to\n   operate, manage, and\
    \ secure networks will evolve in response.  In\n   other cases, currently available\
    \ capabilities for monitoring or\n   troubleshooting networks could become unavailable.\
    \  This document\n   lists a collection of functions currently employed by network\n\
    \   operators that may be impacted by the shift to increased use of\n   encryption.\
    \  This document does not attempt to specify responses or\n   solutions to these\
    \ impacts; it documents the current state.\n"
- title: 1.2.  Examples of Attempts to Preserve Functions
  contents:
  - "1.2.  Examples of Attempts to Preserve Functions\n   Following the Snowden [Snowden]\
    \ revelations, application service\n   providers (Yahoo, Google, etc.) responded\
    \ by encrypting traffic\n   between their data centers (IPsec) to prevent passive\
    \ monitoring from\n   taking place unbeknownst to them.  Infrastructure traffic\
    \ carried\n   over the public Internet has been encrypted for some time; this\n\
    \   change for universal encryption was specific to their private\n   backbones.\
    \  Large mail service providers also began to encrypt\n   session transport (TLS)\
    \ to hosted mail services.  This and other\n   increases in the use of encryption\
    \ had the immediate effect of\n   providing confidentiality and integrity for\
    \ protected data, but it\n   created a problem for some network-management functions.\
    \  Operators\n   could no longer gain access to some session streams resulting\
    \ in\n   actions by several to regain their operational practices that\n   previously\
    \ depended on cleartext data sessions.\n   The Electronic Frontier Foundation\
    \ (EFF) reported [EFF2014] several\n   network service providers using a downgrade\
    \ attack to prevent the use\n   of SMTP over TLS by breaking STARTTLS (Section\
    \ 3.2 of [RFC7525]),\n   essentially preventing the negotiation process resulting\
    \ in fallback\n   to the use of cleartext.  There have already been documented\
    \ cases of\n   service providers preventing STARTTLS to avoid session encryption\n\
    \   negotiation on some sessions.  Doing so allows them to inject a super\n  \
    \ cookie that enables advertisers to track users; these actions are\n   also considered\
    \ an attack.  These serve as examples of undesirable\n   behavior that could be\
    \ prevented through upfront discussions in\n   protocol work for operators and\
    \ protocol designers to understand the\n   implications of such actions.  In other\
    \ cases, some service providers\n   and enterprises have relied on middleboxes\
    \ having access to cleartext\n   for load-balancing, monitoring for attack traffic,\
    \ meeting regulatory\n   requirements, or other purposes.  The implications for\
    \ enterprises\n   that own the data on their networks or that have explicit agreements\n\
    \   that permit the monitoring of user traffic are very different from\n   those\
    \ for service providers who may be accessing content in a way\n   that violates\
    \ privacy considerations.  Additionally, service provider\n   equipment is designed\
    \ for accessing only the headers exposed for the\n   data-link, network, and transport\
    \ layers.  Delving deeper into\n   packets is possible, but there is typically\
    \ a high degree of accuracy\n   from the header information and packet sizes when\
    \ limited to header\n   information from these three layers.  Service providers\
    \ also have the\n   option of adding routing overlay protocols to traffic.  These\n\
    \   middlebox implementations, performing functions either considered\n   legitimate\
    \ by the IETF or not, have been impacted by increases in\n   encrypted traffic.\
    \  Only methods keeping with the goal of balancing\n   network management and\
    \ pervasive monitoring mitigation as discussed\n   in [RFC7258] should be considered\
    \ in work toward a solution resulting\n   from this document.\n   It is well known\
    \ that national surveillance programs monitor traffic\n   for criminal activities\
    \ [JNSLP] [RFC2804] [RFC7258].  Governments\n   vary on their balance between\
    \ monitoring versus the protection of\n   user privacy, data, and assets.  Those\
    \ that favor unencrypted access\n   to data ignore the real need to protect users'\
    \ identities, financial\n   transactions, and intellectual property (which require\
    \ security and\n   encryption to prevent crime).  A clear understanding of technology,\n\
    \   encryption, and monitoring goals will aid in the development of\n   solutions\
    \ as work continues towards finding an appropriate balance\n   that allows for\
    \ management while protecting user privacy with strong\n   encryption solutions.\n"
- title: 2.  Network Service Provider Monitoring Practices
  contents:
  - "2.  Network Service Provider Monitoring Practices\n   Service providers, for\
    \ this definition, include the backbone ISPs as\n   well as those providing infrastructure\
    \ at scale for core Internet use\n   (hosted infrastructure and services such\
    \ as email).\n   Network service providers use various techniques to operate,\
    \ manage,\n   and secure their networks.  The following subsections detail the\n\
    \   purpose of several techniques as well as which protocol fields are\n   used\
    \ to accomplish each task.  In response to increased encryption of\n   these fields,\
    \ some network service providers may be tempted to\n   undertake undesirable security\
    \ practices in order to gain access to\n   the fields in unencrypted data flows.\
    \  To avoid this situation, new\n   methods could be developed to accomplish the\
    \ same goals without\n   service providers having the ability to see session data.\n"
- title: 2.1.  Passive Monitoring
  contents:
  - '2.1.  Passive Monitoring

    '
- title: 2.1.1.  Traffic Surveys
  contents:
  - "2.1.1.  Traffic Surveys\n   Internet traffic surveys are useful in many pursuits,\
    \ such as input\n   for studies of the Center for Applied Internet Data Analysis\
    \ (CAIDA)\n   [CAIDA], network planning, and optimization.  Tracking the trends\
    \ in\n   Internet traffic growth, from earlier peer-to-peer communication to\n\
    \   the extensive adoption of unicast video streaming applications, has\n   relied\
    \ on a view of traffic composition with a particular level of\n   assumed accuracy,\
    \ based on access to cleartext by those conducting\n   the surveys.\n   Passive\
    \ monitoring makes inferences about observed traffic using the\n   maximal information\
    \ available and is subject to inaccuracies stemming\n   from incomplete sampling\
    \ (of packets in a stream) or loss due to\n   monitoring-system overload.  When\
    \ encryption conceals more layers in\n   each packet, reliance on pattern inferences\
    \ and other heuristics\n   grows and accuracy suffers.  For example, the traffic\
    \ patterns\n   between server and browser are dependent on browser supplier and\n\
    \   version, even when the sessions use the same server application\n   (e.g.,\
    \ web email access).  It remains to be seen whether more complex\n   inferences\
    \ can be mastered to produce the same monitoring accuracy.\n"
- title: 2.1.2.  Troubleshooting
  contents:
  - "2.1.2.  Troubleshooting\n   Network operators use protocol-dissecting analyzers\
    \ when responding\n   to customer problems, to identify the presence of attack\
    \ traffic, and\n   to identify root causes of the problem such as misconfiguration.\
    \  In\n   limited cases, packet captures may also be used when a customer\n  \
    \ approves of access to their packets or provides packet captures close\n   to\
    \ the endpoint.  The protocol dissection is generally limited to\n   supporting\
    \ protocols (e.g., DNS and DHCP), network and transport\n   (e.g., IP and TCP),\
    \ and some higher-layer protocols (e.g., RTP and\n   the RTP Control Protocol\
    \ (RTCP)).  Troubleshooting will move closer\n   to the endpoint with increased\
    \ encryption and adjustments in\n   practices to effectively troubleshoot using\
    \ a 5-tuple may require\n   education.  Packet-loss investigations, and those\
    \ where access is\n   limited to a 2-tuple (IPsec tunnel mode), rely on network\
    \ and\n   transport-layer headers taken at the endpoint.  In this case,\n   captures\
    \ on intermediate nodes are not reliable as there are far too\n   many cases of\
    \ aggregate interfaces and alternate paths in service\n   provider networks.\n\
    \   Network operators are often the first ones called upon to investigate\n  \
    \ application problems (e.g., \"my HD video is choppy\"), to first rule\n   out\
    \ network and network services as a cause for the underlying issue.\n   When diagnosing\
    \ a customer problem, the starting point may be a\n   particular application that\
    \ isn't working.  The ability to identify\n   the problem application's traffic\
    \ is important, and packet capture\n   provided from the customer close to the\
    \ edge may be used for this\n   purpose; IP address filtering is not useful for\
    \ applications using\n   Content Delivery Networks (CDNs) or cloud providers.\
    \  After\n   identifying the traffic, an operator may analyze the traffic\n  \
    \ characteristics and routing of the traffic.  This diagnostic step is\n   important\
    \ to help determine the root cause before exploring if the\n   issue is directly\
    \ with the application.\n   For example, by investigating packet loss (from TCP\
    \ sequence and\n   acknowledgement numbers), Round-Trip Time (RTT) (from TCP timestamp\n\
    \   options or application-layer transactions, e.g., DNS or HTTP response\n  \
    \ time), TCP receive-window size, packet corruption (from checksum\n   verification),\
    \ inefficient fragmentation, or application-layer\n   problems, the operator can\
    \ narrow the problem to a portion of the\n   network, server overload, client\
    \ or server misconfiguration, etc.\n   Network operators may also be able to identify\
    \ the presence of attack\n   traffic as not conforming to the application the\
    \ user claims to be\n   using.  In many instances, the exposed packet header is\
    \ sufficient\n   for this type of troubleshooting.\n   One way of quickly excluding\
    \ the network as the bottleneck during\n   troubleshooting is to check whether\
    \ the speed is limited by the\n   endpoints.  For example, the connection speed\
    \ might instead be\n   limited by suboptimal TCP options, the sender's congestion\
    \ window,\n   the sender temporarily running out of data to send, the sender\n\
    \   waiting for the receiver to send another request, or the receiver\n   closing\
    \ the receive window.  All this information can be derived from\n   the cleartext\
    \ TCP header.\n   Packet captures and protocol-dissecting analyzers have been\
    \ important\n   tools.  Automated monitoring has also been used to proactively\n\
    \   identify poor network conditions, leading to maintenance and network\n   upgrades\
    \ before user experience declines.  For example, findings of\n   loss and jitter\
    \ in Voice over IP (VoIP) traffic can be a predictor of\n   future customer dissatisfaction\
    \ (supported by metadata from RTP/RTCP)\n   [RFC3550], or increases in DNS response\
    \ time can generally make\n   interactive web browsing appear sluggish.  But,\
    \ to detect such\n   problems, the application or service stream must first be\n\
    \   distinguished from others.\n   When increased encryption is used, operators\
    \ lose a source of data\n   that may be used to debug user issues.  For example,\
    \ IPsec obscures\n   TCP and RTP header information, while TLS and the Secure\
    \ Real-time\n   Transport Protocol (SRTP) do not.  Because of this, application-\n\
    \   server operators using increased encryption might be called upon more\n  \
    \ frequently to assist with debugging and troubleshooting; thus, they\n   may\
    \ want to consider what tools can be put in the hands of their\n   clients or\
    \ network operators.\n   Further, the performance of some services can be more\
    \ efficiently\n   managed and repaired when information on user transactions is\n\
    \   available to the service provider.  It may be possible to continue\n   transaction-monitoring\
    \ activities without cleartext access to the\n   application layers of interest;\
    \ however, inaccuracy will increase and\n   efficiency of repair activities will\
    \ decrease.  For example, an\n   application-protocol error or failure would be\
    \ opaque to network\n   troubleshooters when transport encryption is applied,\
    \ making root\n   cause location more difficult and, therefore, increasing the\
    \ time to\n   repair.  Repair time directly reduces the availability of the\n\
    \   service, and most network operators have made availability a key\n   metric\
    \ in their Service Level Agreements (SLAs) and/or subscription\n   rebates.  Also,\
    \ there may be more cases of user-communication\n   failures when the additional\
    \ encryption processes are introduced\n   (e.g., key management at large scale),\
    \ leading to more customer\n   service contacts and (at the same time) less information\
    \ available to\n   network-operation repair teams.\n   In mobile networks, knowledge\
    \ about TCP's stream transfer progress\n   (by observing ACKs, retransmissions,\
    \ packet drops, and the Sector\n   Utilization Level, etc.) is further used to\
    \ measure the performance\n   of network segments (sector, eNodeB (eNB), etc.).\
    \  This information\n   is used as key performance indicators (KPIs) and for the\
    \ estimation\n   of user/service key quality indicators at network edges for circuit\n\
    \   emulation (CEM) as well as input for mitigation methods.  If the\n   makeup\
    \ of active services per user and per sector are not visible to\n   a server that\
    \ provides Internet Access Point Names (APNs), it cannot\n   perform mitigation\
    \ functions based on network segment view.\n   It is important to note that the\
    \ push for encryption by application\n   providers has been motivated by the application\
    \ of the described\n   techniques.  Although network operators have noted performance\n\
    \   improvements with network-based optimization or enhancement of user\n   traffic\
    \ (otherwise, deployment would not have occurred), application\n   providers have\
    \ likewise noted some degraded performance and/or user\n   experience, and such\
    \ cases may result in additional operator\n   troubleshooting.  Further, encrypted\
    \ application streams might avoid\n   outdated optimization or enhancement techniques,\
    \ where they exist.\n   A gap exists for vendors where built-in diagnostics and\n\
    \   serviceability are not adequate to provide detailed logging and\n   debugging\
    \ capabilities that, when possible, could be accessed with\n   cleartext network\
    \ parameters.  In addition to traditional logging and\n   debugging methods, packet\
    \ tracing and inspection along the service\n   path provides operators the visibility\
    \ to continue to diagnose\n   problems reported both internally and by their customers.\
    \  Logging of\n   service path upon exit for routing overlay protocols will assist\
    \ with\n   policy management and troubleshooting capabilities for traffic flows\n\
    \   on encrypted networks.  Protocol trace logging and protocol data unit\n  \
    \ (PDU) logging should also be considered to improve visibility to\n   monitor\
    \ and troubleshoot application-level traffic.  Additional work\n   on this gap\
    \ would assist network operators to better troubleshoot and\n   manage networks\
    \ with increasing amounts of encrypted traffic.\n"
- title: 2.1.3.  Traffic-Analysis Fingerprinting
  contents:
  - "2.1.3.  Traffic-Analysis Fingerprinting\n   Fingerprinting is used in traffic\
    \ analysis and monitoring to identify\n   traffic streams that match certain patterns.\
    \  This technique can be\n   used with both cleartext and encrypted sessions.\
    \  Some Distributed\n   Denial-of-Service (DDoS) prevention techniques at the\
    \ network-\n   provider level rely on the ability to fingerprint traffic in order\
    \ to\n   mitigate the effect of this type of attack.  Thus, fingerprinting may\n\
    \   be an aspect of an attack or part of attack countermeasures.\n   A common,\
    \ early trigger for DDoS mitigation includes observing\n   uncharacteristic traffic\
    \ volumes or sources, congestion, or\n   degradation of a given network or service.\
    \  One approach to mitigate\n   such an attack involves distinguishing attacker\
    \ traffic from\n   legitimate user traffic.  The ability to examine layers and\
    \ payloads\n   above transport provides an increased range of filtering\n   opportunities\
    \ at each layer in the clear.  If fewer layers are in the\n   clear, this means\
    \ that there are reduced filtering opportunities\n   available to mitigate attacks.\
    \  However, fingerprinting is still\n   possible.\n   Passive monitoring of network\
    \ traffic can lead to invasion of privacy\n   by external actors at the endpoints\
    \ of the monitored traffic.\n   Encryption of traffic end to end is one method\
    \ to obfuscate some of\n   the potentially identifying information.  For example,\
    \ browser\n   fingerprints are comprised of many characteristics, including User\n\
    \   Agents, HTTP Accept headers, browser plug-in details, screen size and\n  \
    \ color details, system fonts, and time zones.  A monitoring system\n   could\
    \ easily identify a specific browser, and by correlating other\n   information,\
    \ identify a specific user.\n"
- title: 2.2.  Traffic Optimization and Management
  contents:
  - '2.2.  Traffic Optimization and Management

    '
- title: 2.2.1.  Load Balancers
  contents:
  - "2.2.1.  Load Balancers\n   A standalone load balancer is a function one can take\
    \ off the shelf,\n   place in front of a pool of servers, and configure appropriately,\
    \ and\n   it will balance the traffic load among servers in the pool.  This is\n\
    \   a typical setup for load balancers.  Standalone load balancers rely\n   on\
    \ the plainly observable information in the packets they are\n   forwarding and\
    \ industry-accepted standards in interpreting the\n   plainly observable information.\
    \  Typically, this is a 5-tuple of the\n   connection.  This type of configuration\
    \ terminates TLS sessions at\n   the load balancer, making it the endpoint instead\
    \ of the server.\n   Standalone load balancers are considered middleboxes, but\
    \ they are an\n   integral part of server infrastructure that scales.\n   In contrast,\
    \ an integrated load balancer is developed to be an\n   integral part of the service\
    \ provided by the server pool behind that\n   load balancer.  These load balancers\
    \ can communicate state with their\n   pool of servers to better route flows to\
    \ the appropriate servers.\n   They rely on non-standard, system-specific information\
    \ and\n   operational knowledge shared between the load balancer and its\n   servers.\n\
    \   Both standalone and integrated load balancers can be deployed in\n   pools\
    \ for redundancy and load sharing.  For high availability, it is\n   important\
    \ that when packets belonging to a flow start to arrive at a\n   different load\
    \ balancer in the load-balancer pool, the packets\n   continue to be forwarded\
    \ to the original server in the server pool.\n   The importance of this requirement\
    \ increases as the chance of such a\n   load balancer change event increases.\n\
    \   Mobile operators deploy integrated load balancers to assist with\n   maintaining\
    \ connection state as devices migrate.  With the\n   proliferation of mobile connected\
    \ devices, there is an acute need for\n   connection-oriented protocols that maintain\
    \ connections after a\n   network migration by an endpoint.  This connection persistence\n\
    \   provides an additional challenge for multihomed anycast-based\n   services\
    \ typically employed by large content owners and CDNs.  The\n   challenge is that\
    \ a migration to a different network in the middle of\n   the connection greatly\
    \ increases the chances of the packets routed to\n   a different anycast point\
    \ of presence (POP) due to the new network's\n   different connectivity and Internet\
    \ peering arrangements.  The load\n   balancer in the new POP, potentially thousands\
    \ of miles away, will\n   not have information about the new flow and would not\
    \ be able to\n   route it back to the original POP.\n   To help with the endpoint\
    \ network migration challenges, anycast\n   service operations are likely to employ\
    \ integrated load balancers\n   that, in cooperation with their pool servers,\
    \ are able to ensure that\n   client-to-server packets contain some additional\
    \ identification in\n   plainly observable parts of the packets (in addition to\
    \ the 5-tuple).\n   As noted in Section 2 of [RFC7258], careful consideration\
    \ in protocol\n   design to mitigate pervasive monitoring is important, while\
    \ ensuring\n   manageability of the network.\n   An area for further research\
    \ includes end-to-end solutions that would\n   provide a simpler architecture\
    \ and that may solve the issue with CDN\n   anycast.  In this case, connections\
    \ would be migrated to a CDN\n   unicast address.\n   Current protocols, such\
    \ as TCP, allow the development of stateless\n   integrated load balancers by\
    \ availing such load balancers of\n   additional plaintext information in client-to-server\
    \ packets.  In\n   case of TCP, such information can be encoded by having server-\n\
    \   generated sequence numbers (that are ACKed by the client), segment\n   values,\
    \ lengths of the packet sent, etc.  The use of some of these\n   mechanisms for\
    \ load balancing negates some of the security\n   assumptions associated with\
    \ those primitives (e.g., that an off-path\n   attacker guessing valid sequence\
    \ numbers for a flow is hard).\n   Another possibility is a dedicated mechanism\
    \ for storing load-\n   balancer state, such as QUIC's proposed connection ID\
    \ to provide\n   visibility to the load balancer.  An identifier could be used\
    \ for\n   tracking purposes, but this may provide an option that is an\n   improvement\
    \ from bolting it on to an unrelated transport signal.\n   This method allows\
    \ for tight control by one of the endpoints and can\n   be rotated to avoid roving\
    \ client linkability: in other words, being\n   a specific, separate signal, it\
    \ can be governed in a way that is\n   finely targeted at that specific use case.\n\
    \   Some integrated load balancers have the ability to use additional\n   plainly\
    \ observable information even for today's protocols that are\n   not network-migration\
    \ tolerant.  This additional information allows\n   for improved availability\
    \ and scalability of the load-balancing\n   operation.  For example, BGP reconvergence\
    \ can cause a flow to switch\n   anycast POPs, even without a network change by\
    \ any endpoint.\n   Additionally, a system that is able to encode the identity\
    \ of the\n   pool server in plaintext information available in each incoming\n\
    \   packet is able to provide stateless load balancing.  This ability\n   confers\
    \ great reliability and scalability advantages, even if the\n   flow remains in\
    \ a single POP, because the load-balancing system is\n   not required to keep\
    \ state of each flow.  Even more importantly,\n   there's no requirement to continuously\
    \ synchronize such state among\n   the pool of load balancers.  An integrated\
    \ load balancer repurposing\n   limited existing bits in transport-flow state\
    \ must maintain and\n   synchronize per-flow state occasionally: using the sequence\
    \ number as\n   a cookie only works for so long given that there aren't that many\n\
    \   bits available to divide across a pool of machines.\n   Mobile operators apply\
    \ 3GPP Self-Organizing Networks (SONs) for\n   intelligent workflows such as content-aware\
    \ Mobility Load Balancing\n   (MLB).  Where network load balancers have been configured\
    \ to route\n   according to application-layer semantics, an encrypted payload\
    \ is\n   effectively invisible.  This has resulted in practices of\n   intercepting\
    \ TLS in front of load balancers to regain that\n   visibility, but at a cost\
    \ to security and privacy.\n   In future Network Function Virtualization (NFV)\
    \ architectures, load-\n   balancing functions are likely to be more prevalent\
    \ (deployed at\n   locations throughout operators' networks).  NFV environments\
    \ will\n   require some type of identifier (IPv6 flow identifiers, the proposed\n\
    \   QUIC connection ID, etc.) for managing traffic using encrypted\n   tunnels.\
    \  The shift to increased encryption will have an impact on\n   visibility of\
    \ flow information and will require adjustments to\n   perform similar load-balancing\
    \ functions within an NFV.\n"
- title: 2.2.2.  Differential Treatment Based on Deep Packet Inspection (DPI)
  contents:
  - "2.2.2.  Differential Treatment Based on Deep Packet Inspection (DPI)\n   Data\
    \ transfer capacity resources in cellular radio networks tend to\n   be more constrained\
    \ than in fixed networks.  This is a result of\n   variance in radio signal strength\
    \ as a user moves around a cell, the\n   rapid ingress and egress of connections\
    \ as users hand off between\n   adjacent cells, and temporary congestion at a\
    \ cell.  Mobile networks\n   alleviate this by queuing traffic according to its\
    \ required bandwidth\n   and acceptable latency: for example, a user is unlikely\
    \ to notice a\n   20 ms delay when receiving a simple web page or email, or an\
    \ instant\n   message response, but will very likely notice a rebuffering pause\
    \ in\n   a video playback or a VoIP call de-jitter buffer.  Ideally, the\n   scheduler\
    \ manages the queue so that each user has an acceptable\n   experience as conditions\
    \ vary, but inferences of the traffic type\n   have been used to make bearer assignments\
    \ and set scheduler priority.\n   Deep Packet Inspection (DPI) allows identification\
    \ of applications\n   based on payload signatures, in contrast to trusting well-known\
    \ port\n   numbers.  Application- and transport-layer encryption make the\n  \
    \ traffic type estimation more complex and less accurate; therefore, it\n   may\
    \ not be effectual to use this information as input for queue\n   management.\
    \  With the use of WebSockets [RFC6455], for example, many\n   forms of communications\
    \ (from isochronous/real-time to bulk/elastic\n   file transfer) will take place\
    \ over HTTP port 80 or port 443, so only\n   the messages and higher-layer data\
    \ will make application\n   differentiation possible.  If the monitoring system\
    \ sees only \"HTTP\n   port 443\", it cannot distinguish application streams that\
    \ would\n   benefit from priority queuing from others that would not.\n   Mobile\
    \ networks especially rely on content-/application-based\n   prioritization of\
    \ Over-the-Top (OTT) services -- each application\n   type or service has different\
    \ delay/loss/throughput expectations, and\n   each type of stream will be unknown\
    \ to an edge device if encrypted.\n   This impedes dynamic QoS adaptation.  An\
    \ alternate way to achieve\n   encrypted application separation is possible when\
    \ the User Equipment\n   (UE) requests a dedicated bearer for the specific application\
    \ stream\n   (known by the UE), using a mechanism such as the one described in\n\
    \   Section 6.5 of 3GPP TS 24.301 [TS3GPP].  The UE's request includes\n   the\
    \ Quality Class Indicator (QCI) appropriate for each application,\n   based on\
    \ their different delay/loss/throughput expectations.\n   However, UE requests\
    \ for dedicated bearers and QCI may not be\n   supported at the subscriber's service\
    \ level, or in all mobile\n   networks.\n   These effects and potential alternative\
    \ solutions have been discussed\n   at the accord BoF [ACCORD] at IETF 95.\n \
    \  This section does not consider traffic discrimination by service\n   providers\
    \ related to Net Neutrality, where traffic may be favored\n   according to the\
    \ service provider's preference as opposed to the\n   user's preference.  These\
    \ use cases are considered out of scope for\n   this document as controversial\
    \ practices.\n"
- title: 2.2.3.  Network-Congestion Management
  contents:
  - "2.2.3.  Network-Congestion Management\n   For 3GPP User Plane Congestion Management\
    \ (UPCON) [UPCON], the\n   ability to understand content and manage networks during\
    \ periods of\n   congestion is the focus.  Mitigating techniques such as deferred\n\
    \   download, off-peak acceleration, and outbound roamers are a few\n   examples\
    \ of the areas explored in the associated 3GPP documents.  The\n   documents describe\
    \ the issues, describe the data utilized in managing\n   congestion, and make\
    \ policy recommendations.\n"
- title: 2.2.4.  Performance-Enhancing Proxies
  contents:
  - "2.2.4.  Performance-Enhancing Proxies\n   Performance-enhancing TCP proxies may\
    \ perform local retransmission at\n   the network edge; this also applies to mobile\
    \ networks.  In TCP,\n   duplicated ACKs are detected and potentially concealed\
    \ when the proxy\n   retransmits a segment that was lost on the mobile link without\n\
    \   involvement of the far end (see Section 2.1.1 of [RFC3135] and\n   Section\
    \ 3.5 of [MIDDLEBOXES]).\n   Operators report that this optimization at network\
    \ edges improves\n   real-time transmission over long-delay Internet paths or\
    \ networks\n   with large capacity variation (such as mobile/cellular networks).\n\
    \   However, such optimizations can also cause problems with performance,\n  \
    \ for example, if the characteristics of some packet streams begin to\n   vary\
    \ significantly from those considered in the proxy design.\n   In general, some\
    \ operators have stated that performance-enhancing\n   proxies have a lower RTT\
    \ to the client; therefore, they determine the\n   responsiveness of flow control.\
    \  A lower RTT makes the flow-control\n   loop more responsive to changes in the\
    \ mobile-network conditions and\n   enables faster adaptation in a delay- and\
    \ capacity-varying network\n   due to user mobility.\n   Further, some use service-provider-operated\
    \ proxies to reduce the\n   control delay between the sender and a receiver on\
    \ a mobile network\n   where resources are limited.  The RTT determines how quickly\
    \ a user's\n   attempt to cancel a video is recognized and, therefore, how quickly\n\
    \   the traffic is stopped, thus keeping unwanted video packets from\n   entering\
    \ the radio-scheduler queue.  If impacted by encryption,\n   performance-enhancing\
    \ proxies could make use of routing overlay\n   protocols to accomplish the same\
    \ task, but this results in additional\n   overhead.\n   An application-type-aware\
    \ network edge (middlebox) can further\n   control pacing, limit simultaneous\
    \ HD videos, or prioritize active\n   videos against new videos, etc.  Services\
    \ at this more granular level\n   are limited with the use of encryption.\n  \
    \ Performance-enhancing proxies are primarily used on long-delay links\n   (satellite)\
    \ with access to the TCP header to provide an early ACK and\n   make the long-delay\
    \ link of the path seem shorter.  With some\n   specific forms of flow control,\
    \ TCP can be more efficient than\n   alternatives such as proxies.  The editors\
    \ cannot cite research on\n   this point specific to the performance-enhancing\
    \ proxies described,\n   but they agree this area could be explored to determine\
    \ if flow-\n   control modifications could preserve the end-to-end performance\
    \ on\n   long-delay path sessions where the TCP header is exposed.\n"
- title: 2.2.5.  Caching and Content Replication near the Network Edge
  contents:
  - "2.2.5.  Caching and Content Replication near the Network Edge\n   The features\
    \ and efficiency of some Internet services can be\n   augmented through analysis\
    \ of user flows and the applications they\n   provide.  For example, network caching\
    \ of popular content at a\n   location close to the requesting user can improve\
    \ delivery efficiency\n   (both in terms of lower request response times and reduced\
    \ use of\n   links on the international Internet when content is remotely\n  \
    \ located), and service providers through an authorized agreement\n   acting on\
    \ their behalf use DPI in combination with content-\n   distribution networks\
    \ to determine if they can intervene effectively.\n   Encryption of packet contents\
    \ at a given protocol layer usually makes\n   DPI processing of that layer and\
    \ higher layers impossible.  That\n   being said, it should be noted that some\
    \ content providers prevent\n   caching to control content delivery through the\
    \ use of encrypted\n   end-to-end sessions.  CDNs vary in their deployment options\
    \ of end-\n   to-end encryption.  The business risk of losing control of content\
    \ is\n   a motivation outside of privacy and pervasive monitoring that is\n  \
    \ driving end-to-end encryption for these content providers.\n   It should be\
    \ noted that caching was first supported in [RFC1945] and\n   continued in the\
    \ recent update of \"Hypertext Transfer Protocol\n   (HTTP/1.1): Caching\" [RFC7234].\
    \  Some operators also operate\n   transparent caches that neither the user nor\
    \ the origin opt-in.  The\n   use of these caches is controversial within the\
    \ IETF and is generally\n   precluded by the use of HTTPS.\n   Content replication\
    \ in caches (for example, live video and content\n   protected by Digital Rights\
    \ Management (DRM)) is used to most\n   efficiently utilize the available limited\
    \ bandwidth and thereby\n   maximize the user's Quality of Experience (QoE). \
    \ Especially in\n   mobile networks, duplicating every stream through the transit\
    \ network\n   increases backhaul cost for live TV. 3GPP Enhanced Multimedia\n\
    \   Broadcast/Multicast Services (eMBMS) utilize trusted edge proxies to\n   facilitate\
    \ delivering the same stream to different users, using\n   either unicast or multicast\
    \ depending on channel conditions to the\n   user.  There are ongoing efforts\
    \ to support multicast inside carrier\n   networks while preserving end-to-end\
    \ security: Automatic Multicast\n   Tunneling (AMT), for instance, allows CDNs\
    \ to deliver a single\n   (potentially encrypted) copy of a live stream to a carrier\
    \ network\n   over the public Internet and for the carrier to then distribute\
    \ that\n   live stream as efficiently as possible within its own network using\n\
    \   multicast.\n   Alternate approaches are in the early phase of being explored\
    \ to\n   allow caching of encrypted content.  These solutions require\n   cooperation\
    \ from content owners and fall outside the scope of what is\n   covered in this\
    \ document.  Content delegation allows for replication\n   with possible benefits,\
    \ but any form of delegation has the potential\n   to affect the expectation of\
    \ client-server confidentiality.\n"
- title: 2.2.6.  Content Compression
  contents:
  - "2.2.6.  Content Compression\n   In addition to caching, various applications\
    \ exist to provide data\n   compression in order to conserve the life of the user's\
    \ mobile data\n   plan or make delivery over the mobile link more efficient. \
    \ The\n   compression proxy access can be built into a specific user-level\n \
    \  application, such as a browser, or it can be available to all\n   applications\
    \ using a system-level application.  The primary method is\n   for the mobile\
    \ application to connect to a centralized server as a\n   transparent proxy (user\
    \ does not opt-in), with the data channel\n   between the client application and\
    \ the server using compression to\n   minimize bandwidth utilization.  The effectiveness\
    \ of such systems\n   depends on the server having access to unencrypted data\
    \ flows.\n   Aggregated data stream content compression that spans objects and\n\
    \   data sources that can be treated as part of a unified compression\n   scheme\
    \ (e.g., through the use of a shared segment store) is often\n   effective at\
    \ providing data offload when there is a network element\n   close to the receiver\
    \ that has access to see all the content.\n"
- title: 2.2.7.  Service Function Chaining
  contents:
  - "2.2.7.  Service Function Chaining\n   Service Function Chaining (SFC) is defined\
    \ in RFC 7665 [RFC7665] and\n   RFC 8300 [RFC8300].  As discussed in RFC 7498\
    \ [RFC7498], common SFC\n   deployments may use classifiers to direct traffic\
    \ into VLANs instead\n   of using a Network Service Header (NSH), as defined in\
    \ RFC 8300\n   [RFC8300].  As described in RFC 7665 [RFC7665], the ordered steering\n\
    \   of traffic to support specific optimizations depends upon the ability\n  \
    \ of a classifier to determine the microflows.  RFC 2474 [RFC2474]\n   defines\
    \ the following:\n      Microflow: a single instance of an application-to-application\
    \ flow\n      of packets which is identified by source address, destination\n\
    \      address, protocol id, and source port, destination port (where\n      applicable).\n\
    \   SFC currently depends upon a classifier to at least identify the\n   microflow.\
    \  As the classifier's visibility is reduced from a 5-tuple\n   to a 2-tuple,\
    \ or if information above the transport layer becomes\n   inaccessible, then the\
    \ SFC classifier is not able to perform its job,\n   and the service functions\
    \ of the path may be adversely affected.\n   There are also mechanisms provided\
    \ to protect security and privacy.\n   In the SFC case, the layer below a network\
    \ service header can be\n   protected with session encryption.  A goal is protecting\
    \ end-user\n   data, while retaining the intended functions of RFC 7665 [RFC7665]\
    \ at\n   the same time.\n"
- title: 2.3.  Content Filtering, Network Access, and Accounting
  contents:
  - "2.3.  Content Filtering, Network Access, and Accounting\n   Mobile networks and\
    \ many ISPs operate under the regulations of their\n   licensing government authority.\
    \  These regulations include Lawful\n   Intercept, adherence to Codes of Practice\
    \ on content filtering, and\n   application of court order filters.  Such regulations\
    \ assume network\n   access to provide content filtering and accounting, as discussed\n\
    \   below.  As previously stated, the intent of this document is to\n   document\
    \ existing practices; the development of IETF protocols\n   follows the guiding\
    \ principles of [RFC1984] and [RFC2804] and\n   explicitly does not support tools\
    \ and methods that could be used for\n   wiretapping and censorship.\n"
- title: 2.3.1.  Content Filtering
  contents:
  - "2.3.1.  Content Filtering\n   There are numerous reasons why service providers\
    \ might block content:\n   to comply with requests from law enforcement or regulatory\n\
    \   authorities, to effectuate parental controls, to enforce content-\n   based\
    \ billing, or for other reasons, possibly considered\n   inappropriate by some.\
    \  See RFC 7754 [RFC7754] for a survey of\n   Internet filtering techniques and\
    \ motivations and the IAB consensus\n   on those mechanisms.  This section is\
    \ intended to document a\n   selection of current content-blocking practices by\
    \ operators and the\n   effects of encryption on those practices.  Content blocking\
    \ may also\n   happen at endpoints or at the edge of enterprise networks, but\
    \ those\n   scenarios are not addressed in this section.\n   In a mobile network,\
    \ content filtering usually occurs in the core\n   network.  With other networks,\
    \ content filtering could occur in the\n   core network or at the edge.  A proxy\
    \ is installed that analyzes the\n   transport metadata of the content users are\
    \ viewing and filters\n   content based on either a blacklist of sites or the\
    \ user's predefined\n   profile (e.g., for age-sensitive content).  Although filtering\
    \ can be\n   done by many methods, one commonly used method involves a trigger\n\
    \   based on the proxy identifying a DNS lookup of a host name in a URL\n   that\
    \ appears on a blacklist being used by the operator.  The\n   subsequent requests\
    \ to that domain will be rerouted to a proxy that\n   checks whether the full\
    \ URL matches a blocked URL on the list, and it\n   will return a 404 if a match\
    \ is found.  All other requests should\n   complete.  This technique does not\
    \ work in situations where DNS\n   traffic is encrypted (e.g., by employing [RFC7858]).\
    \  This method is\n   also used by other types of network providers enabling traffic\n\
    \   inspection, but not modification.\n   Content filtering via a proxy can also\
    \ utilize an intercepting\n   certificate where the client's session is terminated\
    \ at the proxy\n   enabling for cleartext inspection of the traffic.  A new session\
    \ is\n   created from the intercepting device to the client's destination;\n \
    \  this is an opt-in strategy for the client, where the endpoint is\n   configured\
    \ to trust the intercepting certificate.  Changes to TLS 1.3\n   do not impact\
    \ this more invasive method of interception, which has\n   the potential to expose\
    \ every HTTPS session to an active man in the\n   middle (MITM).\n   Another form\
    \ of content filtering is called parental control, where\n   some users are deliberately\
    \ denied access to age-sensitive content as\n   a feature to the service subscriber.\
    \  Some sites involve a mixture of\n   universal and age-sensitive content and\
    \ filtering software.  In these\n   cases, more-granular (application-layer) metadata\
    \ may be used to\n   analyze and block traffic.  Methods that accessed cleartext\n\
    \   application-layer metadata no longer work when sessions are\n   encrypted.\
    \  This type of granular filtering could occur at the\n   endpoint or as a proxy\
    \ service.  However, the lack of ability to\n   efficiently manage endpoints as\
    \ a service reduces network service\n   providers' ability to offer parental control.\n"
- title: 2.3.2.  Network Access and Data Usage
  contents:
  - "2.3.2.  Network Access and Data Usage\n   Approved access to a network is a prerequisite\
    \ to requests for\n   Internet traffic.\n   However, there are cases (beyond parental\
    \ control) when a network\n   service provider currently redirects customer requests\
    \ for content\n   (affecting content accessibility):\n   1.  The network service\
    \ provider is performing the accounting and\n       billing for the content provider,\
    \ and the customer has not (yet)\n       purchased the requested content.\n  \
    \ 2.  Further content may not be allowed as the customer has reached\n       their\
    \ usage limit and needs to purchase additional data service,\n       which is\
    \ the usual billing approach in mobile networks.\n   Currently, some network service\
    \ providers redirect the customer using\n   HTTP redirect to a captive portal\
    \ page that explains to those\n   customers the reason for the blockage and the\
    \ steps to proceed.\n   [RFC6108] describes one viable web notification system.\
    \  When the\n   HTTP headers and content are encrypted, this appropriately prevents\n\
    \   mobile carriers from intercepting the traffic and performing an HTTP\n   redirect.\
    \  As a result, some mobile carriers block customer's\n   encrypted requests,\
    \ which impacts customer experience because the\n   blocking reason must be conveyed\
    \ by some other means.  The customer\n   may need to call customer care to find\
    \ out the reason and/or resolve\n   the issue, possibly extending the time needed\
    \ to restore their\n   network access.  While there are well-deployed alternate\
    \ SMS-based\n   solutions that do not involve out-of-specification protocol\n\
    \   interception, this is still an unsolved problem for non-SMS users.\n   Further,\
    \ when the requested service is about to consume the remainder\n   of the user's\
    \ plan limits, the transmission could be terminated and\n   advance notifications\
    \ may be sent to the user by their service\n   provider to warn the user ahead\
    \ of the exhausted plan.  If web\n   content is encrypted, the network provider\
    \ cannot know the data\n   transfer size at request time.  Lacking this visibility\
    \ of the\n   application type and content size, the network would continue the\n\
    \   transmission and stop the transfer when the limit was reached.  A\n   partial\
    \ transfer may not be usable by the client wasting both network\n   and user resources,\
    \ possibly leading to customer complaints.  The\n   content provider does not\
    \ know a user's service plans or current\n   usage and cannot warn the user of\
    \ plan exhaustion.\n   In addition, some mobile network operators sell tariffs\
    \ that allow\n   free-data access to certain sites, known as 'zero rating'.  A\
    \ session\n   to visit such a site incurs no additional cost or data usage to\
    \ the\n   user.  For some implementations, zero rating is impacted if\n   encryption\
    \ hides the details of the content domain from the network.\n"
- title: 2.3.3.  Application Layer Gateways (ALGs)
  contents:
  - "2.3.3.  Application Layer Gateways (ALGs)\n   Application Layer Gateways (ALGs)\
    \ assist applications to set\n   connectivity across Network Address Translators\
    \ (NATs), firewalls,\n   and/or load balancers for specific applications running\
    \ across mobile\n   networks.  Section 2.9 of [RFC2663] describes the role of\
    \ ALGs and\n   their interaction with NAT and/or application payloads.  ALGs are\n\
    \   deployed with an aim to improve connectivity.  However, it is an IETF\n  \
    \ best common practice recommendation that ALGs for UDP-based protocols\n   be\
    \ turned off [RFC4787].\n   One example of an ALG in current use is aimed at video\
    \ applications\n   that use the Real-Time Streaming Protocol (RTSP) [RFC7826]\
    \ primary\n   stream as a means to identify related RTP/RTCP [RFC3550] flows at\n\
    \   setup.  The ALG in this case relies on the 5-tuple flow information\n   derived\
    \ from RTSP to provision NAT or other middleboxes and provide\n   connectivity.\
    \  Implementations vary, and two examples follow:\n   1.  Parse the content of\
    \ the RTSP stream and identify the 5-tuple of\n       the supporting streams as\
    \ they are being negotiated.\n   2.  Intercept and modify the 5-tuple information\
    \ of the supporting\n       media streams as they are being negotiated on the\
    \ RTSP stream,\n       which is more intrusive to the media streams.\n   When\
    \ RTSP-stream content is encrypted, the 5-tuple information within\n   the payload\
    \ is not visible to these ALG implementations; therefore,\n   they cannot provision\
    \ their associated middleboxes with that\n   information.\n   The deployment of\
    \ IPv6 may well reduce the need for NAT and the\n   corresponding requirement\
    \ for ALGs.\n"
- title: 2.3.4.  HTTP Header Insertion
  contents:
  - "2.3.4.  HTTP Header Insertion\n   Some mobile carriers use HTTP header insertion\
    \ (see Section 3.2.1 of\n   [RFC7230]) to provide information about their customers\
    \ to third\n   parties or to their own internal systems [Enrich].  Third parties\
    \ use\n   the inserted information for analytics, customization, advertising,\n\
    \   cross-site tracking of users, customer billing, or selectively\n   allowing\
    \ or blocking content.  HTTP header insertion is also used to\n   pass information\
    \ internally between a mobile service provider's\n   sub-systems, thus keeping\
    \ the internal systems loosely coupled.  When\n   HTTP connections are encrypted\
    \ to protect user privacy, mobile\n   network service providers cannot insert\
    \ headers to accomplish the,\n   sometimes considered controversial, functions\
    \ above.\n   Guidance from the Internet Architecture Board has been provided in\n\
    \   \"Design Considerations for Metadata Insertion\" [RFC8165].  The\n   guidance\
    \ asserts that designs that share metadata only by explicit\n   actions at the\
    \ host are preferable to designs in which middleboxes\n   insert metadata.  Alternate\
    \ notification methods that follow this and\n   other guidance would be helpful\
    \ to mobile carriers.\n"
- title: 3.  Encryption in Hosting and Application SP Environments
  contents:
  - "3.  Encryption in Hosting and Application SP Environments\n   Hosted environments\
    \ have had varied requirements in the past for\n   encryption, with many businesses\
    \ choosing to use these services\n   primarily for data and applications that\
    \ are not business or privacy\n   sensitive.  A shift prior to the revelations\
    \ on surveillance/passive\n   monitoring began where businesses were asking for\
    \ hosted environments\n   to provide higher levels of security so that additional\
    \ applications\n   and service could be hosted externally.  Businesses understanding\
    \ the\n   threats of monitoring in hosted environments increased that pressure\n\
    \   to provide more secure access and session encryption to protect the\n   management\
    \ of hosted environments as well as the data and\n   applications.\n"
- title: 3.1.  Management-Access Security
  contents:
  - "3.1.  Management-Access Security\n   Hosted environments may have multiple levels\
    \ of management access,\n   where some may be strictly for the Hosting service\
    \ provider\n   (infrastructure that may be shared among customers), and some may\
    \ be\n   accessed by a specific customer for application management.  In some\n\
    \   cases, there are multiple levels of hosting service providers,\n   further\
    \ complicating the security of management infrastructure and\n   the associated\
    \ requirements.\n   Hosting service provider management access is typically segregated\n\
    \   from other traffic with a control channel and may or may not be\n   encrypted\
    \ depending upon the isolation characteristics of the\n   management session.\
    \  Customer access may be through a dedicated\n   connection, but discussion for\
    \ that connection method is out of scope\n   for this document.\n   In overlay\
    \ networks (e.g., Virtual eXtensible Local Area Network\n   (VXLAN), Geneve, etc.)\
    \ that are used to provide hosted services,\n   management access for a customer\
    \ to support application management\n   may depend upon the security mechanisms\
    \ available as part of that\n   overlay network.  While overlay-network data encapsulations\
    \ may be\n   used to indicate the desired isolation, this is not sufficient to\n\
    \   prevent deliberate attacks that are aware of the use of the overlay\n   network.\
    \  [GENEVE-REQS] describes requirements to handle attacks.  It\n   is possible\
    \ to use an overlay header in combination with IPsec or\n   other encrypted traffic\
    \ sessions, but this adds the requirement for\n   authentication infrastructure\
    \ and may reduce packet transfer\n   performance.  The use of an overlay header\
    \ may also be deployed as a\n   mechanism to manage encrypted traffic streams\
    \ on the network-by-\n   network service providers.  Additional extension mechanisms\
    \ to\n   provide integrity and/or privacy protections are being investigated\n\
    \   for overlay encapsulations.  Section 7 of [RFC7348] describes some of\n  \
    \ the security issues possible when deploying VXLAN on Layer 2\n   networks. \
    \ Rogue endpoints can join the multicast groups that carry\n   broadcast traffic,\
    \ for example.\n"
- title: 3.1.1.  Monitoring Customer Access
  contents:
  - "3.1.1.  Monitoring Customer Access\n   Hosted applications that allow some level\
    \ of customer-management\n   access may also require monitoring by the hosting\
    \ service provider.\n   Monitoring could include access-control restrictions such\
    \ as\n   authentication, authorization, and accounting for filtering and\n   firewall\
    \ rules to ensure they are continuously met.  Customer access\n   may occur on\
    \ multiple levels, including user-level and administrative\n   access.  The hosting\
    \ service provider may need to monitor access\n   through either session monitoring\
    \ or log evaluation to ensure\n   security SLAs for access management are met.\
    \  The use of session\n   encryption to access hosted environments limits access\
    \ restrictions\n   to the metadata described below.  Monitoring and filtering\
    \ may occur\n   at a:\n   2-tuple:  IP level with source and destination IP addresses\
    \ alone, or\n   5-tuple:  IP and protocol level with a source IP address, destination\n\
    \      IP address, protocol number, source port number, and destination\n    \
    \  port number.\n   Session encryption at the application level, for example,\
    \ TLS,\n   currently allows access to the 5-tuple.  IP-level encryption, such\
    \ as\n   IPsec in tunnel mode, prevents access to the original 5-tuple and may\n\
    \   limit the ability to restrict traffic via filtering techniques.  This\n  \
    \ shift may not impact all hosting service provider solutions as\n   alternate\
    \ controls may be used to authenticate sessions, or access\n   may require that\
    \ clients access such services by first connecting to\n   the organization before\
    \ accessing the hosted application.  Shifts in\n   access may be required to maintain\
    \ equivalent access-control\n   management.  Logs may also be used for monitoring\
    \ that access-control\n   restrictions are met, but would be limited to the data\
    \ that could be\n   observed due to encryption at the point of log generation.\
    \  Log\n   analysis is out of scope for this document.\n"
- title: 3.1.2.  SP Content Monitoring of Applications
  contents:
  - "3.1.2.  SP Content Monitoring of Applications\n   The following observations\
    \ apply to any IT organization that is\n   responsible for delivering services,\
    \ whether to third parties, for\n   example, as a web-based service, or to internal\
    \ customers in an\n   enterprise, e.g., a data-processing system that forms a\
    \ part of the\n   enterprise's business.\n   Organizations responsible for the\
    \ operation of a data center have\n   many processes that access the contents\
    \ of IP packets (passive\n   methods of measurement, as defined in [RFC7799]).\
    \  These processes\n   are typically for service assurance or security purposes\
    \ as part of\n   their data-center operations.\n   Examples include:\n      -\
    \ Network-Performance Monitoring / Application-Performance\n        Monitoring\n\
    \      - Intrusion defense/prevention systems\n      - Malware detection\n   \
    \   - Fraud monitoring\n      - Application DDOS protection\n      - Cyber-attack\
    \ investigation\n      - Proof of regulatory compliance\n      - Data leakage\
    \ prevention\n   Many application service providers simply terminate sessions\
    \ to/from\n   the Internet at the edge of the data center in the form of SSL/TLS\n\
    \   offload in the load balancer.  Not only does this reduce the load on\n   application\
    \ servers, it simplifies the processes to enable monitoring\n   of the session\
    \ content.\n   However, in some situations, encryption deeper in the data center\
    \ may\n   be necessary to protect personal information or in order to meet\n \
    \  industry regulations, e.g., those set out by the Payment Card\n   Industry\
    \ (PCI).  In such situations, various methods have been used\n   to allow service\
    \ assurance and security processes to access\n   unencrypted data.  These include\
    \ SSL/TLS decryption in dedicated\n   units, which then forward packets to SP-controlled\
    \ tools, or real-\n   time or post-capture decryption in the tools themselves.\
    \  A number of\n   these tools provide passive decryption by providing the monitoring\n\
    \   device with the server's private key.  The move to increased use of\n   the\
    \ forward-secret key exchange mechanism impacts the use of these\n   techniques.\n\
    \   Operators of data centers may also maintain packet recordings in\n   order\
    \ to be able to investigate attacks, breaches of internal\n   processes, etc.\
    \  In some industries, organizations may be legally\n   required to maintain such\
    \ information for compliance purposes.\n   Investigations of this nature have\
    \ used access to the unencrypted\n   contents of the packet.  Alternate methods\
    \ to investigate attacks or\n   breaches of process will rely on endpoint information,\
    \ such as logs.\n   As previously noted, logs often lack complete information,\
    \ and this\n   is seen as a concern resulting in some relying on session access\
    \ for\n   additional information.\n   Application service providers may offer\
    \ content-level monitoring\n   options to detect intellectual property leakage\
    \ or other attacks.  In\n   service provider environments where Data Loss Prevention\
    \ (DLP) has\n   been implemented on the basis of the service provider having\n\
    \   cleartext access to session streams, the use of encrypted streams\n   prevents\
    \ these implementations from conducting content searches for\n   the keywords\
    \ or phrases configured in the DLP system.  DLP is often\n   used to prevent the\
    \ leakage of Personally Identifiable Information\n   (PII) as well as financial\
    \ account information, Personal Health\n   Information (PHI), and PCI.  If session\
    \ encryption is terminated at a\n   gateway prior to accessing these services,\
    \ DLP on session data can\n   still be performed.  The decision of where to terminate\
    \ encryption to\n   hosted environments will be a risk decision made between the\n\
    \   application service provider and customer organization according to\n   their\
    \ priorities.  DLP can be performed at the server for the hosted\n   application\
    \ and on an end user's system in an organization as\n   alternate or additional\
    \ monitoring points of content; however, this\n   is not frequently done in a\
    \ service provider environment.\n   Application service providers, by their very\
    \ nature, control the\n   application endpoint.  As such, much of the information\
    \ gleaned from\n   sessions is still available on that endpoint.  However, when\
    \ a gap\n   exists in the application's logging and debugging capabilities, it\n\
    \   has led the application service provider to access data in transport\n   for\
    \ monitoring and debugging.\n"
- title: 3.2.  Hosted Applications
  contents:
  - "3.2.  Hosted Applications\n   Organizations are increasingly using hosted applications\
    \ rather than\n   in-house solutions that require maintenance of equipment and\n\
    \   software.  Examples include Enterprise Resource Planning (ERP)\n   solutions,\
    \ payroll service, time and attendance, travel and expense\n   reporting, among\
    \ others.  Organizations may require some level of\n   management access to these\
    \ hosted applications and will typically\n   require session encryption or a dedicated\
    \ channel for this activity.\n   In other cases, hosted applications may be fully\
    \ managed by a hosting\n   service provider with SLA expectations for availability\
    \ and\n   performance as well as for security functions including malware\n  \
    \ detection.  Due to the sensitive nature of these hosted environments,\n   the\
    \ use of encryption is already prevalent.  Any impact may be\n   similar to an\
    \ enterprise with tools being used inside of the hosted\n   environment to monitor\
    \ traffic.  Additional concerns were not\n   reported in the call for contributions.\n"
- title: 3.2.1.  Monitoring Managed Applications
  contents:
  - "3.2.1.  Monitoring Managed Applications\n   Performance, availability, and other\
    \ aspects of an SLA are often\n   collected through passive monitoring.  For example:\n\
    \   o  Availability: ability to establish connections with hosts to\n      access\
    \ applications and to discern the difference between network-\n      or host-related\
    \ causes of unavailability.\n   o  Performance: ability to complete transactions\
    \ within a target\n      response time and to discern the difference between network-\
    \ or\n      host-related causes of excess response time.\n   Here, as with all\
    \ passive monitoring, the accuracy of inferences is\n   dependent on the cleartext\
    \ information available, and encryption\n   would tend to reduce the information\
    \ and, therefore, the accuracy of\n   each inference.  Passive measurement of\
    \ some metrics will be\n   impossible with encryption that prevents inferring-packet\n\
    \   correspondence across multiple observation points, such as for\n   packet-loss\
    \ metrics.\n   Application logging currently lacks detail sufficient to make\n\
    \   accurate inferences in an environment with increased encryption, and\n   so\
    \ this constitutes a gap for passive performance monitoring (which\n   could be\
    \ closed if log details are enhanced in the future).\n"
- title: 3.2.2.  Mail Service Providers
  contents:
  - "3.2.2.  Mail Service Providers\n   Mail (application) service providers vary\
    \ in what services they\n   offer.  Options may include a fully hosted solution\
    \ where mail is\n   stored external to an organization's environment on mail service\n\
    \   provider equipment or the service offering may be limited to monitor\n   incoming\
    \ mail to remove spam (Section 5.1), phishing attacks\n   (Section 5.3), and malware\
    \ (Section 5.6) before mail is directed to\n   the organization's equipment. \
    \ In both of these cases, content of the\n   messages and headers is monitored\
    \ to detect and remove messages that\n   are undesirable or that may be considered\
    \ an attack.\n   STARTTLS should have zero effect on anti-spam efforts for SMTP\n\
    \   traffic.  Anti-spam services could easily be performed on an SMTP\n   gateway,\
    \ eliminating the need for TLS decryption services.  The\n   impact to anti-spam\
    \ service providers should be limited to a change\n   in tools, where middleboxes\
    \ were deployed to perform these functions.\n   Many efforts are emerging to improve\
    \ user-to-user encryption,\n   including promotion of PGP and newer efforts such\
    \ as Dark Mail\n   [DarkMail].  Of course, content-based spam filtering will not\
    \ be\n   possible on encrypted content.\n"
- title: 3.3.  Data Storage
  contents:
  - "3.3.  Data Storage\n   Numerous service offerings exist that provide hosted storage\n\
    \   solutions.  This section describes the various offerings and details\n   the\
    \ monitoring for each type of service and how encryption may impact\n   the operational\
    \ and security monitoring performed.\n   Trends in data storage encryption for\
    \ hosted environments include a\n   range of options.  The following list is intentionally\
    \ high-level to\n   describe the types of encryption used in coordination with\
    \ data\n   storage that may be hosted remotely, meaning the storage is\n   physically\
    \ located in an external data center requiring transport\n   over the Internet.\
    \  Options for monitoring will vary with each\n   encryption approach described\
    \ below.  In most cases, solutions have\n   been identified to provide encryption\
    \ while ensuring management\n   capabilities were maintained through logging or\
    \ other means.\n"
- title: 3.3.1.  Object-Level Encryption
  contents:
  - "3.3.1.  Object-Level Encryption\n   For higher security and/or privacy of data\
    \ and applications, options\n   that provide end-to-end encryption of the data\
    \ from the user's\n   desktop or server to the storage platform may be preferred.\
    \  This\n   description includes any solution that encrypts data at the object\n\
    \   level, not the transport level.  Encryption of data may be performed\n   with\
    \ libraries on the system or at the application level, which\n   includes file-encryption\
    \ services via a file manager.  Object-level\n   encryption is useful when data\
    \ storage is hosted or scenarios when\n   the storage location is determined based\
    \ on capacity or based on a\n   set of parameters to automate decisions.  This\
    \ could mean that large\n   datasets accessed infrequently could be sent to an\
    \ off-site storage\n   platform at an external hosting service, data accessed\
    \ frequently may\n   be stored locally, or the decision of where to store datasets\
    \ could\n   be based on the transaction type.  Object-level encryption is grouped\n\
    \   separately for the purpose of this document since data may be stored\n   in\
    \ multiple locations including off-site remote storage platforms.\n   If session\
    \ encryption is also used, the protocol is likely to be TLS.\n   Impacts to monitoring\
    \ may include access to content inspection for\n   data-leakage prevention and\
    \ similar technologies, depending on their\n   placement in the network.\n"
- title: 3.3.1.1.  Monitoring for Hosted Storage
  contents:
  - "3.3.1.1.  Monitoring for Hosted Storage\n   Monitoring of hosted storage solutions\
    \ that use host-level (object)\n   encryption is described in this subsection.\
    \  Host-level encryption\n   can be employed for backup services and occasionally\
    \ for external\n   storage services (operated by a third party) when internal\
    \ storage\n   limits are exceeded.\n   Monitoring of data flows to hosted storage\
    \ solutions is performed for\n   security and operational purposes.  The security\
    \ monitoring may be to\n   detect anomalies in the data flows that could include\
    \ changes to\n   destination, the amount of data transferred, or alterations in\
    \ the\n   size and frequency of flows.  Operational considerations include\n \
    \  capacity and availability monitoring.\n"
- title: 3.3.2.  Disk Encryption, Data at Rest (DAR)
  contents:
  - "3.3.2.  Disk Encryption, Data at Rest (DAR)\n   There are multiple ways to achieve\
    \ full disk encryption for stored\n   data.  Encryption may be performed on data\
    \ to be stored while in\n   transit close to the storage media with solutions\
    \ like Controller\n   Based Encryption (CBE) or in the drive system with Self-Encrypting\n\
    \   Drives (SEDs).  Session encryption is typically coupled with\n   encryption\
    \ of these data at rest (DAR) solutions to also protect data\n   in transit. \
    \ Transport encryption is likely via TLS.\n"
- title: 3.3.2.1.  Monitoring Session Flows for DAR Solutions
  contents:
  - "3.3.2.1.  Monitoring Session Flows for DAR Solutions\n   Monitoring for transport\
    \ of data-to-storage platforms, where object-\n   level encryption is performed\
    \ close to or on the storage platform, is\n   similar to that described in Section\
    \ 3.3.1.1.  The primary difference\n   for these solutions is the possible exposure\
    \ of sensitive\n   information, which could include privacy-related data, financial\n\
    \   information, or intellectual property if session encryption via TLS\n   is\
    \ not deployed.  Session encryption is typically used with these\n   solutions,\
    \ but that decision would be based on a risk assessment.\n   There are use cases\
    \ where DAR or disk-level encryption is required.\n   Examples include preventing\
    \ exposure of data if physical disks are\n   stolen or lost.  In the case where\
    \ TLS is in use, monitoring and the\n   exposure of data is limited to a 5-tuple.\n"
- title: 3.3.3.  Cross-Data-Center Replication Services
  contents:
  - "3.3.3.  Cross-Data-Center Replication Services\n   Storage services also include\
    \ data replication, which may occur\n   between data centers and may leverage\
    \ Internet connections to tunnel\n   traffic.  The traffic may use an Internet\
    \ Small Computer System\n   Interface (iSCSI) [RFC7143] or Fibre Channel over\
    \ TCP/IP (FCIP)\n   [RFC7146] encapsulated in IPsec.  Either transport or tunnel\
    \ mode may\n   be used for IPsec depending upon the termination points of the\
    \ IPsec\n   session, if it is from the storage platform itself or from a gateway\n\
    \   device at the edge of the data center, respectively.\n"
- title: 3.3.3.1.  Monitoring IPsec for Data Replication Services
  contents:
  - "3.3.3.1.  Monitoring IPsec for Data Replication Services\n   The monitoring of\
    \ data flows between data centers (for data\n   replication) may be performed\
    \ for security and operational purposes\n   and would typically concentrate more\
    \ on operational aspects since\n   these flows are essentially virtual private\
    \ networks (VPNs) between\n   data centers.  Operational considerations include\
    \ capacity and\n   availability monitoring.  The security monitoring may be to\
    \ detect\n   anomalies in the data flows, similar to what was described in\n \
    \  Section 3.3.1.1.  If IPsec tunnel mode is in use, monitoring is\n   limited\
    \ to a 2-tuple; with transport mode, it's limited to a 5-tuple.\n"
- title: 4.  Encryption for Enterprises
  contents:
  - "4.  Encryption for Enterprises\n   Encryption of network traffic within the private\
    \ enterprise is a\n   growing trend, particularly in industries with audit and\
    \ regulatory\n   requirements.  Some enterprise-internal networks are almost\n\
    \   completely TLS and/or IPsec encrypted.\n   For each type of monitoring, different\
    \ techniques and access to parts\n   of the data stream are part of current practice.\
    \  As we transition to\n   an increased use of encryption, alternate methods of\
    \ monitoring for\n   operational purposes may be necessary to reduce the practice\
    \ of\n   breaking encryption (other policies may apply in some enterprise\n  \
    \ settings).\n"
- title: 4.1.  Monitoring Practices of the Enterprise
  contents:
  - "4.1.  Monitoring Practices of the Enterprise\n   Large corporate enterprises\
    \ are the owners of the platforms, data,\n   and network infrastructure that provide\
    \ critical business services to\n   their user communities.  As such, these enterprises\
    \ are responsible\n   for all aspects of the performance, availability, security,\
    \ and\n   quality of experience for all user sessions.  In many such\n   enterprises,\
    \ users are required to consent to the enterprise\n   monitoring all their activities\
    \ as a condition of employment.\n   Subsections of Section 4 discuss techniques\
    \ that access data beyond\n   the data-link, network, and transport-level headers\
    \ typically used in\n   service provider networks since the corporate enterprise\
    \ owns the\n   data.  These responsibilities break down into three basic areas:\n\
    \   1.  Security Monitoring and Control\n   2.  Application-Performance Monitoring\
    \ and Reporting\n   3.  Network Diagnostics and Troubleshooting\n   In each of\
    \ the above areas, technical support teams utilize\n   collection, monitoring,\
    \ and diagnostic systems.  Some organizations\n   currently use attack methods\
    \ such as replicated TLS server RSA\n   private keys to decrypt passively monitored\
    \ copies of encrypted TLS\n   packet streams.\n   For an enterprise to avoid costly\
    \ application down time and deliver\n   expected levels of performance, protection,\
    \ and availability, some\n   forms of traffic analysis, sometimes including examination\
    \ of packet\n   payloads, are currently used.\n"
- title: 4.1.1.  Security Monitoring in the Enterprise
  contents:
  - "4.1.1.  Security Monitoring in the Enterprise\n   Enterprise users are subject\
    \ to the policies of their organization\n   and the jurisdictions in which the\
    \ enterprise operates.  As such,\n   proxies may be in use to:\n   1.  intercept\
    \ outbound session traffic to monitor for intellectual\n       property leakage\
    \ (by users, malware, and trojans),\n   2.  detect viruses/malware entering the\
    \ network via email or web\n       traffic,\n   3.  detect malware/trojans in\
    \ action, possibly connecting to remote\n       hosts,\n   4.  detect attacks\
    \ (cross-site scripting and other common web-related\n       attacks),\n   5.\
    \  track misuse and abuse by employees,\n   6.  restrict the types of protocols\
    \ permitted to/from the entire\n       corporate environment, and\n   7.  detect\
    \ and defend against Internet DDoS attacks, including both\n       volumetric\
    \ and Layer 7 attacks.\n   A significant portion of malware hides its activity\
    \ within TLS or\n   other encryption protocols.  This includes lateral movement,\
    \ Command\n   and Control (C&C), and Data Exfiltration.\n   The impact to a fully\
    \ encrypted internal network would include cost\n   and possible loss of detection\
    \ capabilities associated with the\n   transformation of the network architecture\
    \ and tools for monitoring.\n   The capabilities of detection through traffic\
    \ fingerprinting,\n   logging, host-level transaction monitoring, and flow analysis\
    \ would\n   vary depending on access to a 2-tuple or 5-tuple in the network as\n\
    \   well.\n   Security monitoring in the enterprise may also be performed at the\n\
    \   endpoint with numerous current solutions that mitigate the same\n   problems\
    \ as some of the above-mentioned solutions.  Since the\n   software agents operate\
    \ on the device, they are able to monitor\n   traffic before it is encrypted,\
    \ monitor for behavior changes and lock\n   down devices to use only the expected\
    \ set of applications.  Session\n   encryption does not affect these solutions.\
    \  Some might argue that\n   scaling is an issue in the enterprise, but some large\
    \ enterprises\n   have used these tools effectively.\n   Use of bring-your-own-device\
    \ (BYOD) policies within organizations may\n   limit the scope of monitoring permitted\
    \ with these alternate\n   solutions.  Network endpoint assessment (NEA) or the\
    \ use of virtual\n   hosts could help to bridge the monitoring gap.\n"
- title: 4.1.2.  Monitoring Application Performance in the Enterprise
  contents:
  - "4.1.2.  Monitoring Application Performance in the Enterprise\n   There are two\
    \ main goals of monitoring:\n   1.  Assess traffic volume on a per-application\
    \ basis for billing,\n       capacity planning, optimization of geographical location\
    \ for\n       servers or proxies, and other goals.\n   2.  Assess performance\
    \ in terms of application response time and\n       user-perceived response time.\n\
    \   Network-based application-performance monitoring tracks application\n   response\
    \ time by user and by URL, which is the information that the\n   application owners\
    \ and the lines of business request.  CDNs add\n   complexity in determining the\
    \ ultimate endpoint destination.  By\n   their very nature, such information is\
    \ obscured by CDNs and encrypted\n   protocols, adding a new challenge for troubleshooting\
    \ network and\n   application problems.  URL identification allows the application\n\
    \   support team to do granular, code-level troubleshooting at multiple\n   tiers\
    \ of an application.\n   New methodologies to monitor user-perceived response\
    \ time and to\n   separate network from server time are evolving.  For example,\
    \ the\n   IPv6 Destination Option Header (DOH) implementation of Performance\n\
    \   and Diagnostic Metrics (PDM) [RFC8250] will provide this.  Using PDM\n   with\
    \ IPsec Encapsulating Security Payload (ESP) Transport Mode\n   requires placement\
    \ of the PDM DOH within the ESP-encrypted payload to\n   avoid leaking timing\
    \ and sequence number information that could be\n   useful to an attacker.  Use\
    \ of PDM DOH also may introduce some\n   security weaknesses, including a timing\
    \ attack, as described in\n   Section 4 of [RFC8250].  For these and other reasons,\
    \ [RFC8250]\n   requires that the PDM DOH option be explicitly turned on by\n\
    \   administrative action in each host where this measurement feature\n   will\
    \ be used.\n"
- title: 4.1.3.  Diagnostics and Troubleshooting for Enterprise Networks
  contents:
  - "4.1.3.  Diagnostics and Troubleshooting for Enterprise Networks\n   One primary\
    \ key to network troubleshooting is the ability to follow a\n   transaction through\
    \ the various tiers of an application in order to\n   isolate the fault domain.\
    \  A variety of factors relating to the\n   structure of the modern data center\
    \ and multi-tiered application have\n   made it difficult to follow a transaction\
    \ in network traces without\n   the ability to examine some of the packet payload.\
    \  Alternate\n   methods, such as log analysis, need improvement to fill this\
    \ gap.\n"
- title: 4.1.3.1.  Address Sharing (NAT)
  contents:
  - "4.1.3.1.  Address Sharing (NAT)\n   CDNs, NATs, and Network Address and Port\
    \ Translators (NAPTs) obscure\n   the ultimate endpoint designation (see [RFC6269]\
    \ for types of address\n   sharing and a list of issues).  Troubleshooting a problem\
    \ for a\n   specific end user requires finding information such as the IP address\n\
    \   and other identifying information so that their problem can be\n   resolved\
    \ in a timely manner.\n   NAT is also frequently used by lower layers of the data-center\n\
    \   infrastructure.  Firewalls, load balancers, web servers, app servers,\n  \
    \ and middleware servers all regularly NAT the source IP of packets.\n   Combine\
    \ this with the fact that users are often allocated randomly by\n   load balancers\
    \ to all these devices, and the network troubleshooter\n   is often left with\
    \ very few options in today's environment due to\n   poor logging implementations\
    \ in applications.  As such, network\n   troubleshooting is used to trace packets\
    \ at a particular layer,\n   decrypt them, and look at the payload to find a user\
    \ session.\n   This kind of bulk packet capture and bulk decryption is frequently\n\
    \   used when troubleshooting a large and complex application.  Endpoints\n  \
    \ typically don't have the capacity to handle this level of network\n   packet\
    \ capture, so out-of-band networks of robust packet brokers and\n   network sniffers\
    \ that use techniques such as copies of TLS RSA\n   private keys accomplish this\
    \ task today.\n"
- title: 4.1.3.2.  TCP Pipelining / Session Multiplexing
  contents:
  - "4.1.3.2.  TCP Pipelining / Session Multiplexing\n   TCP pipelining / session\
    \ multiplexing used mainly by middleboxes\n   today allows for multiple end-user\
    \ sessions to share the same TCP\n   connection.  This raises several points of\
    \ interest with an increased\n   use of encryption.  TCP session multiplexing\
    \ should still be possible\n   when TLS or TCPcrypt is in use since the TCP header\
    \ information is\n   exposed, leaving the 5-tuple accessible.  The use of TCP\
    \ session\n   multiplexing of an IP-layer encryption, e.g., IPsec, that only\n\
    \   exposes a 2-tuple would not be possible.  Troubleshooting\n   capabilities\
    \ with encrypted sessions from the middlebox may limit\n   troubleshooting to\
    \ the use of logs from the endpoints performing the\n   TCP multiplexing or from\
    \ the middleboxes prior to any additional\n   encryption that may be added to\
    \ tunnel the TCP multiplexed traffic.\n   Increased use of HTTP/2 will likely\
    \ further increase the prevalence\n   of session multiplexing, both on the Internet\
    \ and in the private data\n   center.  HTTP pipelining requires both the client\
    \ and server to\n   participate; visibility of packets once encrypted will hide\
    \ the use\n   of HTTP pipelining for any monitoring that takes place outside of\
    \ the\n   endpoint or proxy solution.  Since HTTP pipelining is between a\n  \
    \ client and server, logging capabilities may require improvement in\n   some\
    \ servers and clients for debugging purposes if this is not\n   already possible.\
    \  Visibility for middleboxes includes anything\n   exposed by TLS and the 5-tuple.\n"
- title: 4.1.3.3.  HTTP Service Calls
  contents:
  - "4.1.3.3.  HTTP Service Calls\n   When an application server makes an HTTP service\
    \ call to back-end\n   services on behalf of a user session, it uses a completely\
    \ different\n   URL and a completely different TCP connection.  Troubleshooting\
    \ via\n   network trace involves matching up the user request with the HTTP\n\
    \   service call.  Some organizations do this today by decrypting the TLS\n  \
    \ packet and inspecting the payload.  Logging has not been adequate for\n   their\
    \ purposes.\n"
- title: 4.1.3.4.  Application-Layer Data
  contents:
  - "4.1.3.4.  Application-Layer Data\n   Many applications use text formats such\
    \ as XML to transport data or\n   application-level information.  When transaction\
    \ failures occur and\n   the logs are inadequate to determine the cause, network\
    \ and\n   application teams work together, each having a different view of the\n\
    \   transaction failure.  Using this troubleshooting method, the network\n   packet\
    \ is correlated with the actual problem experienced by an\n   application to find\
    \ a root cause.  The inability to access the\n   payload prevents this method\
    \ of troubleshooting.\n"
- title: 4.2.  Techniques for Monitoring Internet-Session Traffic
  contents:
  - "4.2.  Techniques for Monitoring Internet-Session Traffic\n   Corporate networks\
    \ commonly monitor outbound session traffic to\n   detect or prevent attacks as\
    \ well as to guarantee service-level\n   expectations.  In some cases, alternate\
    \ options are available when\n   encryption is in use through a proxy or a shift\
    \ to monitoring at the\n   endpoint.  In both cases, scaling is a concern, and\
    \ advancements to\n   support this shift in monitoring practices will assist the\
    \ deployment\n   of end-to-end encryption.\n   Some DLP tools intercept traffic\
    \ at the Internet gateway or proxy\n   services with the ability to MITM encrypted\
    \ session traffic (HTTP/\n   TLS).  These tools may monitor for key words important\
    \ to the\n   enterprise including business-sensitive information such as trade\n\
    \   secrets, financial data, PII, or PHI.  Various techniques are used to\n  \
    \ intercept HTTP/TLS sessions for DLP and other purposes and can be\n   misused\
    \ as described in \"Summarizing Known Attacks on Transport Layer\n   Security\
    \ (TLS) and Datagram TLS (DTLS)\" [RFC7457] (see Section 2.8).\n   Note: many\
    \ corporate policies allow access to personal financial and\n   other sites for\
    \ users without interception.  Another option is to\n   terminate a TLS session\
    \ prior to the point where monitoring is\n   performed.  Aside from exposing user\
    \ information to the enterprise,\n   MITM devices often are subject to severe\
    \ security defects, which can\n   lead to exposure of user data to attackers outside\
    \ the enterprise\n   user data [UserData].  In addition, implementation errors\
    \ in\n   middleboxes have led to major difficulties in deploying new versions\n\
    \   of security protocols such as TLS [Ben17a] [Ben17b] [Res17a]\n   [Res17b].\n\
    \   Monitoring traffic patterns for anomalous behavior such as increased\n   flows\
    \ of traffic that could be bursty at odd times or flows to\n   unusual destinations\
    \ (small or large amounts of traffic) is common.\n   This traffic may or may not\
    \ be encrypted, and various methods of\n   encryption or just obfuscation may\
    \ be used.\n   Web-filtering devices are sometimes used to allow only access to\n\
    \   well-known sites found to be legitimate and free of malware on last\n   check\
    \ by a web-filtering service company.  One common example of web\n   filtering\
    \ in a corporate environment is blocking access to sites that\n   are not well\
    \ known to these tools for the purpose of blocking\n   malware; this may be noticeable\
    \ to those in research who are unable\n   to access colleagues' individual sites\
    \ or new websites that have not\n   yet been screened.  In situations where new\
    \ sites are required for\n   access, they can typically be added after notification\
    \ by the user or\n   log alerts and review.  Account access for personal mail\
    \ may be\n   blocked in corporate settings to prevent another vector for malware\n\
    \   from entering as well as to prevent intellectual property leaks out\n   of\
    \ the network.  This method remains functional with increased use of\n   encryption\
    \ and may be more effective at preventing malware from\n   entering the network.\
    \  Some enterprises may be more aggressive in\n   their filtering and monitoring\
    \ policy, causing undesirable outcomes.\n   Web-filtering solutions monitor and\
    \ potentially restrict access based\n   on the destination URL (when available),\
    \ server name, IP address, or\n   DNS name.  A complete URL may be used in cases\
    \ where access\n   restrictions vary for content on a particular site or for the\
    \ sites\n   hosted on a particular server.  In some cases, the enterprise may\
    \ use\n   a proxy to access this additional information based on their policy.\n\
    \   This type of restriction is intended to be transparent to users in a\n   corporate\
    \ setting as the typical corporate user does not access sites\n   that are not\
    \ well known to these tools.  However, the mechanisms that\n   these web filters\
    \ use to do monitoring and enforcement have the\n   potential to cause access\
    \ issues or other user-visible failures.\n   Desktop DLP tools are used in some\
    \ corporate environments as well.\n   Since these tools reside on the desktop,\
    \ they can intercept traffic\n   before it is encrypted and may provide a continued\
    \ method for\n   monitoring leakage of intellectual property from the desktop\
    \ to the\n   Internet or attached devices.\n   DLP tools can also be deployed\
    \ by network service providers, as they\n   have the vantage point of monitoring\
    \ all traffic paired with\n   destinations off the enterprise network.  This makes\
    \ an effective\n   solution for enterprises that allow \"bring-your-own\" devices\
    \ when the\n   traffic is not encrypted and for devices outside the desktop category\n\
    \   (such as mobile phones) that are used on corporate networks\n   nonetheless.\n\
    \   Enterprises may wish to reduce the traffic on their Internet access\n   facilities\
    \ by monitoring requests for within-policy content and\n   caching it.  In this\
    \ case, repeated requests for Internet content\n   spawned by URLs in email trade\
    \ newsletters or other sources can be\n   served within the enterprise network.\
    \  Gradual deployment of end-to-\n   end encryption would tend to reduce the cacheable\
    \ content over time,\n   owing to concealment of critical headers and payloads.\
    \  Many forms of\n   enterprise-performance management may be similarly affected.\
    \  It\n   should be noted that transparent caching is considered an anti-\n  \
    \ pattern.\n"
- title: 5.  Security Monitoring for Specific Attack Types
  contents:
  - "5.  Security Monitoring for Specific Attack Types\n   Effective incident response\
    \ today requires collaboration at Internet\n   scale.  This section will only\
    \ focus on efforts of collaboration at\n   Internet scale that are dedicated to\
    \ specific attack types.  They may\n   require new monitoring and detection techniques\
    \ in an increasingly\n   encrypted Internet.  As mentioned previously, some service\
    \ providers\n   have been interfering with STARTTLS to prevent session encryption\
    \ to\n   be able to perform functions they are used to (injecting ads,\n   monitoring,\
    \ etc.).  By detailing the current monitoring methods used\n   for attack detection\
    \ and response, this information can be used to\n   devise new monitoring methods\
    \ that will be effective in the changed\n   Internet via collaboration and innovation.\n\
    \   Changes to improve encryption or to deploy OS methods have little\n   impact\
    \ on the detection of malicious actors.  Malicious actors have\n   had access\
    \ to strong encryption for quite some time.  Incident\n   responders, in many\
    \ cases, have developed techniques to locate\n   malicious traffic within encrypted\
    \ sessions.  The following section\n   will note some examples where detection\
    \ and mitigation of such\n   traffic has been successful.\n"
- title: 5.1.  Mail Abuse and Spam
  contents:
  - "5.1.  Mail Abuse and Spam\n   The largest operational effort to prevent mail\
    \ abuse is through the\n   Messaging, Malware, Mobile Anti-Abuse Working Group\
    \ (M3AAWG)\n   [M3AAWG].  Mail abuse is combatted directly with mail administrators\n\
    \   who can shut down or stop continued mail abuse originating from\n   large-scale\
    \ providers that participate in using the Abuse Reporting\n   Format (ARF) agents\
    \ standardized in the IETF [RFC5965] [RFC6430]\n   [RFC6590] [RFC6591] [RFC6650]\
    \ [RFC6651] [RFC6652].  The ARF agent\n   directly reports abuse messages to the\
    \ appropriate service provider\n   who can take action to stop or mitigate the\
    \ abuse.  Since this\n   technique uses the actual message, the use of SMTP over\
    \ TLS between\n   mail gateways will not affect its usefulness.  As mentioned\n\
    \   previously, SMTP over TLS only protects data while in transit, and\n   the\
    \ messages may be exposed on mail servers or mail gateways if a\n   user-to-user\
    \ encryption method is not used.  Current user-to-user\n   message encryption\
    \ methods on email (S/MIME and PGP) do not encrypt\n   the email header information\
    \ used by ARF and the service provider\n   operators in their efforts to mitigate\
    \ abuse.\n   Another effort, \"Domain-based Message Authentication, Reporting,\
    \ and\n   Conformance (DMARC)\" [RFC7489], is a mechanism for policy\n   distribution\
    \ that enables increasingly strict handling of messages\n   that fail authentication\
    \ checks, ranging from no action, through\n   altered delivery, up to message\
    \ rejection.  DMARC is also not\n   affected by the use of STARTTLS.\n"
- title: 5.2.  Denial of Service
  contents:
  - "5.2.  Denial of Service\n   Responses to Denial-of-Service (DoS) attacks are\
    \ typically\n   coordinated by the service provider community with a few key vendors\n\
    \   who have tools to assist in the mitigation efforts.  Traffic patterns\n  \
    \ are determined from each DoS attack to stop or rate limit the traffic\n   flows\
    \ with patterns unique to that DoS attack.\n   Data types used in monitoring traffic\
    \ for DDoS are described in the\n   documents in development by the DDoS Open\
    \ Threat Signaling (DOTS)\n   [DOTS] Working Group.  The impact of encryption\
    \ can be understood\n   from their documented use cases [DDOS-USECASE].\n   Data\
    \ types used in DDoS attacks have been detailed in the Incident\n   Object Description\
    \ Exchange Format (IODEF) Guidance document (see\n   [RFC8274], Appendix B.2)\
    \ with the help of several members of the\n   service provider community.  The\
    \ examples provided are intended to\n   help identify the useful data in detecting\
    \ and mitigating these\n   attacks independent of the transport and protocol descriptions\
    \ in the\n   documents.\n"
- title: 5.3.  Phishing
  contents:
  - "5.3.  Phishing\n   Investigations and responses to phishing attacks follow well-known\n\
    \   patterns, requiring access to specific fields in email headers as\n   well\
    \ as content from the body of the message.  When reporting\n   phishing attacks,\
    \ the recipient has access to each field as well as\n   the body to make content\
    \ reporting possible, even when end-to-end\n   encryption is used.  The email\
    \ header information is useful to\n   identify the mail servers and accounts used\
    \ to generate or relay the\n   attack messages in order to take the appropriate\
    \ actions.  The\n   content of the message often includes an embedded attack that\
    \ may be\n   in an infected file or may be a link that results in the download\
    \ of\n   malware to the user's system.\n   Administrators often find it helpful\
    \ to use header information to\n   track down similar messages in their mail queue\
    \ or in users' inboxes\n   to prevent further infection.  Combinations of To:,\
    \ From:, Subject:,\n   and Received: from header information might be used for\
    \ this purpose.\n   Administrators may also search for document attachments of\
    \ the same\n   name or size or that contain a file with a matching hash to a known\n\
    \   phishing attack.  Administrators might also add URLs contained in\n   messages\
    \ to block lists locally, or this may also be done by browser\n   vendors through\
    \ larger-scale efforts like that of the Anti-Phishing\n   Working Group (APWG).\
    \  See \"Coordinating Attack Response at Internet\n   Scale (CARIS) Workshop Report\"\
    \ [RFC8073] for additional information\n   and pointers to the APWG's efforts\
    \ on anti-phishing.\n   A full list of the fields used in phishing attack incident\
    \ responses\n   can be found in RFC 5901.  Future plans to increase privacy\n\
    \   protections may limit some of these capabilities if some email header\n  \
    \ fields are encrypted, such as the To:, From:, and Subject: header\n   fields.\
    \  This does not mean that those fields should not be\n   encrypted, only that\
    \ we should be aware of how they are currently\n   used.\n   Some products protect\
    \ users from phishing by maintaining lists of\n   known phishing domains (such\
    \ as misspelled bank names) and blocking\n   access.  This can be done by observing\
    \ DNS, cleartext HTTP, or Server\n   Name Indication (SNI) in TLS, in addition\
    \ to analyzing email.\n   Alternate options to detect and prevent phishing attacks\
    \ may be\n   needed.  More recent examples of data exchanged in spear phishing\n\
    \   attacks has been detailed in the IODEF Guidance document (see\n   [RFC8274],\
    \ Appendix B.3).\n"
- title: 5.4.  Botnets
  contents:
  - "5.4.  Botnets\n   Botnet detection and mitigation is complex as botnets may involve\n\
    \   hundreds or thousands of hosts with numerous C&C servers.  The\n   techniques\
    \ and data used to monitor and detect each may vary.\n   Connections to C&C servers\
    \ are typically encrypted; therefore, a move\n   to an increasingly encrypted\
    \ Internet may not affect the detection\n   and sharing methods used.\n"
- title: 5.5.  Malware
  contents:
  - "5.5.  Malware\n   Techniques for the detection and monitoring of malware vary.\
    \  As\n   mentioned in Section 4, malware monitoring may occur at gateways to\n\
    \   the organization analyzing email and web traffic.  These services can\n  \
    \ also be provided by service providers, changing the scale and\n   location of\
    \ this type of monitoring.  Additionally, incident\n   responders may identify\
    \ attributes unique to types of malware to help\n   track down instances by their\
    \ communication patterns on the Internet\n   or by alterations to hosts and servers.\n\
    \   Data types used in malware investigations have been summarized in an\n   example\
    \ of the IODEF Guidance document (see [RFC8274], Appendix B.3).\n"
- title: 5.6.  Spoofed-Source IP Address Protection
  contents:
  - "5.6.  Spoofed-Source IP Address Protection\n   The IETF has reacted to spoofed-source\
    \ IP address-based attacks,\n   recommending the use of network ingress filtering\
    \ in BCP 38 [RFC2827]\n   and of the unicast Reverse Path Forwarding (uRPF) mechanism\n\
    \   [RFC3704].  But uRPF suffers from limitations regarding its\n   granularity:\
    \ a malicious node can still use a spoofed IP address\n   included inside the\
    \ prefix assigned to its link.  Source Address\n   Validation Improvement (SAVI)\
    \ mechanisms try to solve this issue.\n   Basically, a SAVI mechanism is based\
    \ on the monitoring of a specific\n   address assignment/management protocol (e.g.,\
    \ Stateless Address\n   Autoconfiguration (SLAAC) [RFC4862], Secure Neighbor Discovery\
    \ (SEND)\n   [RFC3971], and DHCPv4/v6 [RFC2131][RFC3315]) and, according to this\n\
    \   monitoring, sets up a filtering policy allowing only the IP flows\n   with\
    \ a correct source IP address (i.e., any packet with a source IP\n   address from\
    \ a node not owning it is dropped).  The encryption of\n   parts of the address\
    \ assignment/management protocols, critical for\n   SAVI mechanisms, can result\
    \ in a dysfunction of the SAVI mechanisms.\n"
- title: 5.7.  Further Work
  contents:
  - "5.7.  Further Work\n   Although incident response work will continue, new methods\
    \ to prevent\n   system compromise through security automation and continuous\n\
    \   monitoring [SACM] may provide alternate approaches where system\n   security\
    \ is maintained as a preventative measure.\n"
- title: 6.  Application-Based Flow Information Visible to a Network
  contents:
  - "6.  Application-Based Flow Information Visible to a Network\n   This section\
    \ describes specific techniques used in monitoring\n   applications that are visible\
    \ to the network if a 5-tuple is exposed\n   and as such can potentially be used\
    \ as input for future network-\n   management approaches.  It also includes an\
    \ overview of IP Flow\n   Information Export (IPFIX), a flow-based protocol used\
    \ to export\n   information about network flows.\n"
- title: 6.1.  IP Flow Information Export
  contents:
  - "6.1.  IP Flow Information Export\n   Many of the accounting, monitoring, and\
    \ measurement tasks described\n   in this document, especially in Sections 2.3.2,\
    \ 3.1.1, 4.1.3, 4.2,\n   and 5.2, use the IPFIX protocol [RFC7011] for export\
    \ and storage of\n   the monitored information.  IPFIX evolved from the widely\
    \ deployed\n   NetFlow protocol [RFC3954], which exports information about flows\n\
    \   identified by 5-tuple.  While NetFlow was largely concerned with\n   exporting\
    \ per-flow byte and packet counts for accounting purposes,\n   IPFIX's extensible\
    \ Information Model [RFC7012] provides a variety of\n   Information Elements (IEs)\
    \ [IPFIX-IANA] for representing information\n   above and below the traditional\
    \ network-layer flow information.\n   Enterprise-specific IEs allow exporter vendors\
    \ to define their own\n   non-standard IEs as well, and many of these are driven\
    \ by header and\n   payload inspection at the Metering Process.\n   While the\
    \ deployment of encryption has no direct effect on the use of\n   IPFIX, certain\
    \ defined IEs may become unavailable when the Metering\n   Process observing the\
    \ traffic cannot decrypt former cleartext\n   information.  For example, HTTPS\
    \ renders HTTP header analysis\n   impossible, so IEs derived from the header\
    \ (e.g., httpContentType,\n   httpUserAgent) cannot be exported.\n   The collection\
    \ of IPFIX data itself, of course, provides a point of\n   centralization for\
    \ information that is potentially business and\n   privacy critical.  The IPFIX\
    \ File Format specification [RFC5655]\n   recommends encryption for this data\
    \ at rest, and the IP Flow\n   Anonymization specification [RFC6235] defines a\
    \ metadata format for\n   describing the anonymization functions applied to an\
    \ IPFIX dataset,\n   if anonymization is employed for data sharing of IPFIX information\n\
    \   between enterprises or network operators.\n"
- title: 6.2.  TLS Server Name Indication
  contents:
  - "6.2.  TLS Server Name Indication\n   When initiating the TLS handshake, the client\
    \ may provide an\n   extension field (server_name) that indicates the server to\
    \ which it\n   is attempting a secure connection.  TLS SNI was standardized in\
    \ 2003\n   to enable servers to present the \"correct TLS certificate\" to clients\n\
    \   in a deployment of multiple virtual servers hosted by the same server\n  \
    \ infrastructure and IP address.  Although this is an optional\n   extension,\
    \ it is today supported by all modern browsers, web servers,\n   and developer\
    \ libraries.  Akamai [Nygren] reports that many of their\n   customers see client\
    \ TLS SNI usage over 99%.  It should be noted that\n   HTTP/2 introduces the Alt-SVC\
    \ method for upgrading the connection\n   from HTTP/1 to either unencrypted or\
    \ encrypted HTTP/2.  If the\n   initial HTTP/1 request is unencrypted, the destination\
    \ alternate\n   service name can be identified before the communication is\n \
    \  potentially upgraded to encrypted HTTP/2 transport.  HTTP/2 requires\n   the\
    \ TLS implementation to support the SNI extension (see Section 9.2\n   of [RFC7540]).\
    \  It is also worth noting that [RFC7838] \"allows an\n   origin server to nominate\
    \ additional means of interacting with it on\n   the network\", while [RFC8164]\
    \ allows for a URI to be accessed with\n   HTTP/2 and TLS using Opportunistic\
    \ Security (on an experimental\n   basis).\n   This information is only available\
    \ if the client populates the SNI\n   extension.  Doing so is an optional part\
    \ of the TLS standard, and as\n   stated above, this has been implemented by all\
    \ major browsers.  Due\n   to its optional nature, though, existing network filters\
    \ that examine\n   a TLS ClientHello for an SNI extension cannot expect to always\
    \ find\n   one.  \"SNI Encryption in TLS Through Tunneling\" [SNI-TLS] has been\n\
    \   adopted by the TLS Working Group, which provides solutions to encrypt\n  \
    \ SNI.  As such, there will be an option to encrypt SNI in future\n   versions\
    \ of TLS.  The per-domain nature of SNI may not reveal the\n   specific service\
    \ or media type being accessed, especially where the\n   domain is of a provider\
    \ offering a range of email, video, web pages,\n   etc.  For example, certain\
    \ blog or social network feeds may be deemed\n   \"adult content\", but the SNI\
    \ will only indicate the server domain\n   rather than a URL path.\n   There are\
    \ additional issues for identification of content using SNI:\n   [RFC7540] includes\
    \ connection coalescing, [RFC8336] defines the\n   ORIGIN frame, and the proposal\
    \ outlined in [HTTP2-CERTS] will\n   increase the difficulty of passive monitoring.\n"
- title: 6.3.  Application-Layer Protocol Negotiation (ALPN)
  contents:
  - "6.3.  Application-Layer Protocol Negotiation (ALPN)\n   ALPN is a TLS extension\
    \ that may be used to indicate the application\n   protocol within the TLS session.\
    \  This is likely to be of more value\n   to the network where it indicates a\
    \ protocol dedicated to a\n   particular traffic type (such as video streaming)\
    \ rather than a\n   multi-use protocol.  ALPN is used as part of HTTP/2 'h2',\
    \ but will\n   not indicate the traffic types that may make up streams within\
    \ an\n   HTTP/2 multiplex.  ALPN is sent cleartext in the ClientHello, and the\n\
    \   server returns it in Encrypted Extensions in TLS 1.3.\n"
- title: 6.4.  Content Length, Bitrate, and Pacing
  contents:
  - "6.4.  Content Length, Bitrate, and Pacing\n   The content length of encrypted\
    \ traffic is effectively the same as\n   that of the cleartext.  Although block\
    \ ciphers utilize padding, this\n   makes a negligible difference.  Bitrate and\
    \ pacing are generally\n   application specific and do not change much when the\
    \ content is\n   encrypted.  Multiplexed formats (such as HTTP/2 and QUIC [QUIC])\
    \ may,\n   however, incorporate several application streams over one connection,\n\
    \   which makes the bitrate/pacing no longer application specific.  Also,\n  \
    \ packet padding is available in HTTP/2, TLS 1.3, and many other\n   protocols.\
    \  Traffic analysis is made more difficult by such\n   countermeasures.\n"
- title: 7.  Effect of Encryption on the Evolution of Mobile Networks
  contents:
  - "7.  Effect of Encryption on the Evolution of Mobile Networks\n   Transport header\
    \ encryption prevents the use of transit proxies in\n   the center of the network\
    \ and the use of some edge proxies by\n   preventing the proxies from taking action\
    \ on the stream.  It may be\n   that the claimed benefits of such proxies could\
    \ be achieved by\n   end-to-end client and server optimizations, distribution\
    \ using CDNs,\n   plus the ability to continue connections across different access\n\
    \   technologies (across dynamic user IP addresses).  The following\n   aspects\
    \ should be considered in this approach:\n   1.  In a wireless mobile network,\
    \ the delay and channel capacity per\n       user and sector varies due to coverage,\
    \ contention, user\n       mobility, scheduling balances fairness, capacity, and\
    \ service\n       QoE.  If most users are at the cell edge, the controller cannot\n\
    \       use more-complex Quadrature Amplitude Modulation (QAM), thus\n       reducing\
    \ total cell capacity; similarly, if a Universal Mobile\n       Telecommunications\
    \ System (UMTS) edge is serving some number of\n       CS-Voice Calls, the remaining\
    \ capacity for packet services is\n       reduced.\n   2.  Mobile wireless networks\
    \ service inbound roamers (users of\n       Operator A in the foreign network\
    \ of Operator B) by backhauling\n       their traffic through the network (from\
    \ Operator B to Operator A)\n       and then serving them through the P-Gateway\
    \ (PGW), General Packet\n       Radio Service (GPRS) Support Node (GGSN), CDN,\
    \ etc., of Operator\n       A (the user's home operator).  Increasing window sizes\
    \ to\n       compensate for the path RTT will have the limitations outlined\n\
    \       earlier for TCP.  The outbound roamer scenario has a similar TCP\n   \
    \    performance impact.\n   3.  Issues in deploying CDNs in Radio Access Networks\
    \ (RANs) include\n       decreasing the client-server control loop that requires\
    \ deploying\n       CDNs / Cloud functions that terminate encryption closer to\
    \ the\n       edge.  In Cellular RAN, the user IP traffic is encapsulated into\n\
    \       GPRS Tunneling Protocol-User Plane (GTP-U in UMTS and LTE)\n       tunnels\
    \ to handle user mobility; the tunnels terminate in\n       APN/GGSN/PGW that\
    \ are in central locations.  One user's traffic\n       may flow through one or\
    \ more APN's (for example, Internet APN,\n       Roaming APN for Operator X, Video-Service\
    \ APN, OnDeckAPN, etc.).\n       The scope of operator private IP addresses may\
    \ be limited to\n       specific APNs.  Since CDNs generally operate on user IP\
    \ flows,\n       deploying them would require enhancing them with tunnel\n   \
    \    translation, tunnel-management functions, etc.\n   4.  While CDNs that decrypt\
    \ flows or split connection proxies\n       (similar to split TCP) could be deployed\
    \ closer to the edges to\n       reduce control-loop RTT, with transport header\
    \ encryption, such\n       CDNs perform optimization functions only for partner\
    \ client\n       flows.  Therefore, content from some Small-Medium Businesses\n\
    \       (SMBs) would not get such CDN benefits.\n"
- title: 8.  Response to Increased Encryption and Looking Forward
  contents:
  - "8.  Response to Increased Encryption and Looking Forward\n   As stated in [RFC7258],\
    \ \"an appropriate balance [between network\n   management and pervasive monitoring\
    \ mitigations] will emerge over\n   time as real instances of this tension are\
    \ considered.\"  Numerous\n   operators made it clear in their response to this\
    \ document that they\n   fully support strong encryption and providing privacy\
    \ for end users;\n   this is a common goal.  Operators recognize that not all\
    \ the\n   practices documented need to be supported going forward, either\n  \
    \ because of the risk to end-user privacy or because alternate\n   technologies\
    \ and tools have already emerged.  This document is\n   intended to support network\
    \ engineers and other innovators to work\n   toward solving network and security\
    \ management problems with protocol\n   designers and application developers in\
    \ new ways that facilitate\n   adoption of strong encryption rather than preventing\
    \ the use of\n   encryption.  By having the discussions on network and security\n\
    \   management practices with application developers and protocol\n   designers,\
    \ each side of the debate can understand each other's goals,\n   work toward alternate\
    \ solutions, and disband with practices that\n   should no longer be supported.\
    \  A goal of this document is to assist\n   the IETF in understanding some of\
    \ the current practices so as to\n   identify new work items for IETF-related\
    \ use cases that can\n   facilitate the adoption of strong session encryption\
    \ and support\n   network and security management.\n"
- title: 9.  Security Considerations
  contents:
  - "9.  Security Considerations\n   There are no additional security considerations\
    \ as this is a summary\n   and does not include a new protocol or functionality.\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document has no IANA actions.\n"
- title: 11.  Informative References
  contents:
  - "11.  Informative References\n   [ACCORD]   IETF, \"Alternatives to Content Classification\
    \ for Operator\n              Resource Deployment (accord) (BOF)\", IETF-95 Proceedings,\n\
    \              April 2016,\n              <https://www.ietf.org/proceedings/95/accord.html>.\n\
    \   [Ben17a]   Benjamin, D., \"Chrome Data\", Presentation before the TLS\n  \
    \            WG at IETF 100, November 2017,\n              <https://datatracker.ietf.org/meeting/100/materials/\n\
    \              slides-100-tls-sessa-tls13/>.\n   [Ben17b]   Benjamin, D., \"Subject:\
    \ Additional TLS 1.3 results from\n              Chrome\", message to the TLS\
    \ mailing list, 18 December\n              2017, <https://www.ietf.org/mail-archive/web/tls/current/\n\
    \              msg25168.html>.\n   [CAIDA]    CAIDA, \"The CAIDA USCD Anonymized\
    \ Internet Traces 2016\n              Dataset\", <http://www.caida.org/data/passive/\n\
    \              passive_2016_dataset.xml>.\n   [DarkMail] \"Dark Mail Technical\
    \ Alliance\", <https://darkmail.info/>.\n   [DDOS-USECASE]\n              Dobbins,\
    \ R., Migault, D., Fouant, S., Moskowitz, R.,\n              Teague, N., Xia,\
    \ L., and K. Nishizuka, \"Use cases for DDoS\n              Open Threat Signaling\"\
    , Work in Progress, draft-ietf-dots-\n              use-cases-16, July 2018.\n\
    \   [DOTS]     IETF, \"DDoS Open Threat Signaling (dots)\",\n              <https://datatracker.ietf.org/wg/dots/charter>.\n\
    \   [EFF2014]  Hoffman-Andrews, J., \"ISPs Removing Their Customers' Email\n \
    \             Encryption\", November 2014,\n              <https://www.eff.org/deeplinks/2014/11/\n\
    \              starttls-downgrade-attacks>.\n   [Enrich]   Narseo Vallina-Rodriguez,\
    \ N., Sundaresan, S., Kreibich,\n              C., and V. Paxson, \"Header Enrichment\
    \ or ISP Enrichment:\n              Emerging Privacy Threats in Mobile Networks\"\
    , Proceedings\n              of the ACM SIGCOMM Workshop on Hot Topics in Middleboxes\n\
    \              and Network Function Virtualization, pp. 23-30,\n             \
    \ DOI 10.1145/2785989.2786002, August 2015.\n   [GENEVE-REQS]\n              Migault,\
    \ D., Boutros, S., Wing, D., and S. Krishnan,\n              \"Geneve Protocol\
    \ Security Requirements\", Work in\n              Progress, draft-mglt-nvo3-geneve-security-requirements-03,\n\
    \              February 2018.\n   [HTTP2-CERTS]\n              Bishop, M., Sullivan,\
    \ N., and M. Thomson, \"Secondary\n              Certificate Authentication in\
    \ HTTP/2\", Work in Progress,\n              draft-ietf-httpbis-http2-secondary-certs-02,\
    \ June 2018.\n   [IPFIX-IANA]\n              IANA, \"IP Flow Information Export\
    \ (IPFIX) Entities\",\n              <https://www.iana.org/assignments/ipfix/>.\n\
    \   [JNSLP]    Eskens, S., \"10 Standards for Oversight and Transparency\n   \
    \           of National Intelligence Services\", Surveillance, Vol. 8,\n     \
    \         No. 3, July 2016, <http://jnslp.com/?s=10+Standards+for+Ov\n       \
    \       ersight+and+Transparency+of+National>.\n   [M3AAWG]   M3AAWG, \"Messaging,\
    \ Malware and Mobile Anti-Abuse Working\n              Group (M3AAWG)\", <https://www.maawg.org/>.\n\
    \   [MIDDLEBOXES]\n              Dolson, D., Snellman, J., Boucadair, M., and\
    \ C. Jacquenet,\n              \"An Inventory of Transport-centric Functions Provided\
    \ by\n              Middleboxes\", Work in Progress, draft-dolson-transport-\n\
    \              middlebox-03, June 2018.\n   [Nygren]   Nygren, E., \"Reaching\
    \ toward Universal TLS SNI\",\n              Akamai Technologies, March 2017,\n\
    \              <https://blogs.akamai.com/2017/03/\n              reaching-toward-universal-tls-sni.html>.\n\
    \   [QUIC]     IETF, \"QUIC (quic)\",\n              <https://datatracker.ietf.org/wg/quic/charter/>.\n\
    \   [Res17a]   Rescorla, E., \"Subject: Preliminary data on Firefox TLS\n    \
    \          1.3 Middlebox experiment\", message to the TLS mailing\n          \
    \    list, 5 December 2017, <https://www.ietf.org/mail-archive/\n            \
    \  web/tls/current/msg25091.html>.\n   [Res17b]   Rescorla, E., \"Subject: More\
    \ compatibility measurement\n              results\", message to the TLS mailing\
    \ list, 22 December\n              2017, <https://www.ietf.org/mail-archive/web/tls/current/\n\
    \              msg25179.html>.\n   [RFC1945]  Berners-Lee, T., Fielding, R., and\
    \ H. Frystyk, \"Hypertext\n              Transfer Protocol -- HTTP/1.0\", RFC\
    \ 1945,\n              DOI 10.17487/RFC1945, May 1996,\n              <https://www.rfc-editor.org/info/rfc1945>.\n\
    \   [RFC1958]  Carpenter, B., Ed., \"Architectural Principles of the\n       \
    \       Internet\", RFC 1958, DOI 10.17487/RFC1958, June 1996,\n             \
    \ <https://www.rfc-editor.org/info/rfc1958>.\n   [RFC1984]  IAB and IESG, \"IAB\
    \ and IESG Statement on Cryptographic\n              Technology and the Internet\"\
    , BCP 200, RFC 1984,\n              DOI 10.17487/RFC1984, August 1996,\n     \
    \         <https://www.rfc-editor.org/info/rfc1984>.\n   [RFC2131]  Droms, R.,\
    \ \"Dynamic Host Configuration Protocol\",\n              RFC 2131, DOI 10.17487/RFC2131,\
    \ March 1997,\n              <https://www.rfc-editor.org/info/rfc2131>.\n   [RFC2474]\
    \  Nichols, K., Blake, S., Baker, F., and D. Black,\n              \"Definition\
    \ of the Differentiated Services Field (DS\n              Field) in the IPv4 and\
    \ IPv6 Headers\", RFC 2474,\n              DOI 10.17487/RFC2474, December 1998,\n\
    \              <https://www.rfc-editor.org/info/rfc2474>.\n   [RFC2663]  Srisuresh,\
    \ P. and M. Holdrege, \"IP Network Address\n              Translator (NAT) Terminology\
    \ and Considerations\",\n              RFC 2663, DOI 10.17487/RFC2663, August\
    \ 1999,\n              <https://www.rfc-editor.org/info/rfc2663>.\n   [RFC2775]\
    \  Carpenter, B., \"Internet Transparency\", RFC 2775,\n              DOI 10.17487/RFC2775,\
    \ February 2000,\n              <https://www.rfc-editor.org/info/rfc2775>.\n \
    \  [RFC2804]  IAB and IESG, \"IETF Policy on Wiretapping\", RFC 2804,\n      \
    \        DOI 10.17487/RFC2804, May 2000,\n              <https://www.rfc-editor.org/info/rfc2804>.\n\
    \   [RFC2827]  Ferguson, P. and D. Senie, \"Network Ingress Filtering:\n     \
    \         Defeating Denial of Service Attacks which employ IP Source\n       \
    \       Address Spoofing\", BCP 38, RFC 2827, DOI 10.17487/RFC2827,\n        \
    \      May 2000, <https://www.rfc-editor.org/info/rfc2827>.\n   [RFC3135]  Border,\
    \ J., Kojo, M., Griner, J., Montenegro, G., and Z.\n              Shelby, \"Performance\
    \ Enhancing Proxies Intended to\n              Mitigate Link-Related Degradations\"\
    , RFC 3135,\n              DOI 10.17487/RFC3135, June 2001,\n              <https://www.rfc-editor.org/info/rfc3135>.\n\
    \   [RFC3315]  Droms, R., Ed., Bound, J., Volz, B., Lemon, T., Perkins,\n    \
    \          C., and M. Carney, \"Dynamic Host Configuration Protocol\n        \
    \      for IPv6 (DHCPv6)\", RFC 3315, DOI 10.17487/RFC3315, July\n           \
    \   2003, <https://www.rfc-editor.org/info/rfc3315>.\n   [RFC3550]  Schulzrinne,\
    \ H., Casner, S., Frederick, R., and V.\n              Jacobson, \"RTP: A Transport\
    \ Protocol for Real-Time\n              Applications\", STD 64, RFC 3550, DOI\
    \ 10.17487/RFC3550,\n              July 2003, <https://www.rfc-editor.org/info/rfc3550>.\n\
    \   [RFC3704]  Baker, F. and P. Savola, \"Ingress Filtering for Multihomed\n \
    \             Networks\", BCP 84, RFC 3704, DOI 10.17487/RFC3704, March\n    \
    \          2004, <https://www.rfc-editor.org/info/rfc3704>.\n   [RFC3724]  Kempf,\
    \ J., Ed., Austein, R., Ed., and IAB, \"The Rise of\n              the Middle\
    \ and the Future of End-to-End: Reflections on\n              the Evolution of\
    \ the Internet Architecture\", RFC 3724,\n              DOI 10.17487/RFC3724,\
    \ March 2004,\n              <https://www.rfc-editor.org/info/rfc3724>.\n   [RFC3954]\
    \  Claise, B., Ed., \"Cisco Systems NetFlow Services Export\n              Version\
    \ 9\", RFC 3954, DOI 10.17487/RFC3954, October 2004,\n              <https://www.rfc-editor.org/info/rfc3954>.\n\
    \   [RFC3971]  Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,\n       \
    \       \"SEcure Neighbor Discovery (SEND)\", RFC 3971,\n              DOI 10.17487/RFC3971,\
    \ March 2005,\n              <https://www.rfc-editor.org/info/rfc3971>.\n   [RFC4787]\
    \  Audet, F., Ed. and C. Jennings, \"Network Address\n              Translation\
    \ (NAT) Behavioral Requirements for Unicast\n              UDP\", BCP 127, RFC\
    \ 4787, DOI 10.17487/RFC4787, January\n              2007, <https://www.rfc-editor.org/info/rfc4787>.\n\
    \   [RFC4862]  Thomson, S., Narten, T., and T. Jinmei, \"IPv6 Stateless\n    \
    \          Address Autoconfiguration\", RFC 4862,\n              DOI 10.17487/RFC4862,\
    \ September 2007,\n              <https://www.rfc-editor.org/info/rfc4862>.\n\
    \   [RFC5655]  Trammell, B., Boschi, E., Mark, L., Zseby, T., and A.\n       \
    \       Wagner, \"Specification of the IP Flow Information Export\n          \
    \    (IPFIX) File Format\", RFC 5655, DOI 10.17487/RFC5655,\n              October\
    \ 2009, <https://www.rfc-editor.org/info/rfc5655>.\n   [RFC5965]  Shafranovich,\
    \ Y., Levine, J., and M. Kucherawy, \"An\n              Extensible Format for\
    \ Email Feedback Reports\", RFC 5965,\n              DOI 10.17487/RFC5965, August\
    \ 2010,\n              <https://www.rfc-editor.org/info/rfc5965>.\n   [RFC6108]\
    \  Chung, C., Kasyanov, A., Livingood, J., Mody, N., and B.\n              Van\
    \ Lieu, \"Comcast's Web Notification System Design\",\n              RFC 6108,\
    \ DOI 10.17487/RFC6108, February 2011,\n              <https://www.rfc-editor.org/info/rfc6108>.\n\
    \   [RFC6235]  Boschi, E. and B. Trammell, \"IP Flow Anonymization\n         \
    \     Support\", RFC 6235, DOI 10.17487/RFC6235, May 2011,\n              <https://www.rfc-editor.org/info/rfc6235>.\n\
    \   [RFC6269]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and\n    \
    \          P. Roberts, \"Issues with IP Address Sharing\", RFC 6269,\n       \
    \       DOI 10.17487/RFC6269, June 2011,\n              <https://www.rfc-editor.org/info/rfc6269>.\n\
    \   [RFC6430]  Li, K. and B. Leiba, \"Email Feedback Report Type Value:\n    \
    \          not-spam\", RFC 6430, DOI 10.17487/RFC6430, November 2011,\n      \
    \        <https://www.rfc-editor.org/info/rfc6430>.\n   [RFC6455]  Fette, I. and\
    \ A. Melnikov, \"The WebSocket Protocol\",\n              RFC 6455, DOI 10.17487/RFC6455,\
    \ December 2011,\n              <https://www.rfc-editor.org/info/rfc6455>.\n \
    \  [RFC6590]  Falk, J., Ed. and M. Kucherawy, Ed., \"Redaction of\n          \
    \    Potentially Sensitive Data from Mail Abuse Reports\",\n              RFC\
    \ 6590, DOI 10.17487/RFC6590, April 2012,\n              <https://www.rfc-editor.org/info/rfc6590>.\n\
    \   [RFC6591]  Fontana, H., \"Authentication Failure Reporting Using the\n   \
    \           Abuse Reporting Format\", RFC 6591, DOI 10.17487/RFC6591,\n      \
    \        April 2012, <https://www.rfc-editor.org/info/rfc6591>.\n   [RFC6650]\
    \  Falk, J. and M. Kucherawy, Ed., \"Creation and Use of Email\n             \
    \ Feedback Reports: An Applicability Statement for the Abuse\n              Reporting\
    \ Format (ARF)\", RFC 6650, DOI 10.17487/RFC6650,\n              June 2012, <https://www.rfc-editor.org/info/rfc6650>.\n\
    \   [RFC6651]  Kucherawy, M., \"Extensions to DomainKeys Identified Mail\n   \
    \           (DKIM) for Failure Reporting\", RFC 6651,\n              DOI 10.17487/RFC6651,\
    \ June 2012,\n              <https://www.rfc-editor.org/info/rfc6651>.\n   [RFC6652]\
    \  Kitterman, S., \"Sender Policy Framework (SPF)\n              Authentication\
    \ Failure Reporting Using the Abuse Reporting\n              Format\", RFC 6652,\
    \ DOI 10.17487/RFC6652, June 2012,\n              <https://www.rfc-editor.org/info/rfc6652>.\n\
    \   [RFC7011]  Claise, B., Ed., Trammell, B., Ed., and P. Aitken,\n          \
    \    \"Specification of the IP Flow Information Export (IPFIX)\n             \
    \ Protocol for the Exchange of Flow Information\", STD 77,\n              RFC\
    \ 7011, DOI 10.17487/RFC7011, September 2013,\n              <https://www.rfc-editor.org/info/rfc7011>.\n\
    \   [RFC7012]  Claise, B., Ed. and B. Trammell, Ed., \"Information Model\n   \
    \           for IP Flow Information Export (IPFIX)\", RFC 7012,\n            \
    \  DOI 10.17487/RFC7012, September 2013,\n              <https://www.rfc-editor.org/info/rfc7012>.\n\
    \   [RFC7143]  Chadalapaka, M., Satran, J., Meth, K., and D. Black,\n        \
    \      \"Internet Small Computer System Interface (iSCSI) Protocol\n         \
    \     (Consolidated)\", RFC 7143, DOI 10.17487/RFC7143, April\n              2014,\
    \ <https://www.rfc-editor.org/info/rfc7143>.\n   [RFC7146]  Black, D. and P. Koning,\
    \ \"Securing Block Storage Protocols\n              over IP: RFC 3723 Requirements\
    \ Update for IPsec v3\",\n              RFC 7146, DOI 10.17487/RFC7146, April\
    \ 2014,\n              <https://www.rfc-editor.org/info/rfc7146>.\n   [RFC7230]\
    \  Fielding, R., Ed. and J. Reschke, Ed., \"Hypertext Transfer\n             \
    \ Protocol (HTTP/1.1): Message Syntax and Routing\",\n              RFC 7230,\
    \ DOI 10.17487/RFC7230, June 2014,\n              <https://www.rfc-editor.org/info/rfc7230>.\n\
    \   [RFC7234]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,\n     \
    \         Ed., \"Hypertext Transfer Protocol (HTTP/1.1): Caching\",\n        \
    \      RFC 7234, DOI 10.17487/RFC7234, June 2014,\n              <https://www.rfc-editor.org/info/rfc7234>.\n\
    \   [RFC7258]  Farrell, S. and H. Tschofenig, \"Pervasive Monitoring Is an\n \
    \             Attack\", BCP 188, RFC 7258, DOI 10.17487/RFC7258, May\n       \
    \       2014, <https://www.rfc-editor.org/info/rfc7258>.\n   [RFC7348]  Mahalingam,\
    \ M., Dutt, D., Duda, K., Agarwal, P., Kreeger,\n              L., Sridhar, T.,\
    \ Bursell, M., and C. Wright, \"Virtual\n              eXtensible Local Area Network\
    \ (VXLAN): A Framework for\n              Overlaying Virtualized Layer 2 Networks\
    \ over Layer 3\n              Networks\", RFC 7348, DOI 10.17487/RFC7348, August\
    \ 2014,\n              <https://www.rfc-editor.org/info/rfc7348>.\n   [RFC7435]\
    \  Dukhovni, V., \"Opportunistic Security: Some Protection\n              Most\
    \ of the Time\", RFC 7435, DOI 10.17487/RFC7435,\n              December 2014,\
    \ <https://www.rfc-editor.org/info/rfc7435>.\n   [RFC7457]  Sheffer, Y., Holz,\
    \ R., and P. Saint-Andre, \"Summarizing\n              Known Attacks on Transport\
    \ Layer Security (TLS) and\n              Datagram TLS (DTLS)\", RFC 7457, DOI\
    \ 10.17487/RFC7457,\n              February 2015, <https://www.rfc-editor.org/info/rfc7457>.\n\
    \   [RFC7489]  Kucherawy, M., Ed. and E. Zwicky, Ed., \"Domain-based\n       \
    \       Message Authentication, Reporting, and Conformance\n              (DMARC)\"\
    , RFC 7489, DOI 10.17487/RFC7489, March 2015,\n              <https://www.rfc-editor.org/info/rfc7489>.\n\
    \   [RFC7498]  Quinn, P., Ed. and T. Nadeau, Ed., \"Problem Statement for\n  \
    \            Service Function Chaining\", RFC 7498,\n              DOI 10.17487/RFC7498,\
    \ April 2015,\n              <https://www.rfc-editor.org/info/rfc7498>.\n   [RFC7525]\
    \  Sheffer, Y., Holz, R., and P. Saint-Andre,\n              \"Recommendations\
    \ for Secure Use of Transport Layer\n              Security (TLS) and Datagram\
    \ Transport Layer Security\n              (DTLS)\", BCP 195, RFC 7525, DOI 10.17487/RFC7525,\
    \ May\n              2015, <https://www.rfc-editor.org/info/rfc7525>.\n   [RFC7540]\
    \  Belshe, M., Peon, R., and M. Thomson, Ed., \"Hypertext\n              Transfer\
    \ Protocol Version 2 (HTTP/2)\", RFC 7540,\n              DOI 10.17487/RFC7540,\
    \ May 2015,\n              <https://www.rfc-editor.org/info/rfc7540>.\n   [RFC7619]\
    \  Smyslov, V. and P. Wouters, \"The NULL Authentication\n              Method\
    \ in the Internet Key Exchange Protocol Version 2\n              (IKEv2)\", RFC\
    \ 7619, DOI 10.17487/RFC7619, August 2015,\n              <https://www.rfc-editor.org/info/rfc7619>.\n\
    \   [RFC7624]  Barnes, R., Schneier, B., Jennings, C., Hardie, T.,\n         \
    \     Trammell, B., Huitema, C., and D. Borkmann,\n              \"Confidentiality\
    \ in the Face of Pervasive Surveillance: A\n              Threat Model and Problem\
    \ Statement\", RFC 7624,\n              DOI 10.17487/RFC7624, August 2015,\n \
    \             <https://www.rfc-editor.org/info/rfc7624>.\n   [RFC7665]  Halpern,\
    \ J., Ed. and C. Pignataro, Ed., \"Service Function\n              Chaining (SFC)\
    \ Architecture\", RFC 7665,\n              DOI 10.17487/RFC7665, October 2015,\n\
    \              <https://www.rfc-editor.org/info/rfc7665>.\n   [RFC7754]  Barnes,\
    \ R., Cooper, A., Kolkman, O., Thaler, D., and E.\n              Nordmark, \"\
    Technical Considerations for Internet Service\n              Blocking and Filtering\"\
    , RFC 7754, DOI 10.17487/RFC7754,\n              March 2016, <https://www.rfc-editor.org/info/rfc7754>.\n\
    \   [RFC7799]  Morton, A., \"Active and Passive Metrics and Methods (with\n  \
    \            Hybrid Types In-Between)\", RFC 7799, DOI 10.17487/RFC7799,\n   \
    \           May 2016, <https://www.rfc-editor.org/info/rfc7799>.\n   [RFC7826]\
    \  Schulzrinne, H., Rao, A., Lanphier, R., Westerlund, M.,\n              and\
    \ M. Stiemerling, Ed., \"Real-Time Streaming Protocol\n              Version 2.0\"\
    , RFC 7826, DOI 10.17487/RFC7826, December\n              2016, <https://www.rfc-editor.org/info/rfc7826>.\n\
    \   [RFC7838]  Nottingham, M., McManus, P., and J. Reschke, \"HTTP\n         \
    \     Alternative Services\", RFC 7838, DOI 10.17487/RFC7838,\n              April\
    \ 2016, <https://www.rfc-editor.org/info/rfc7838>.\n   [RFC7858]  Hu, Z., Zhu,\
    \ L., Heidemann, J., Mankin, A., Wessels, D.,\n              and P. Hoffman, \"\
    Specification for DNS over Transport\n              Layer Security (TLS)\", RFC\
    \ 7858, DOI 10.17487/RFC7858, May\n              2016, <https://www.rfc-editor.org/info/rfc7858>.\n\
    \   [RFC8073]  Moriarty, K. and M. Ford, \"Coordinating Attack Response at\n \
    \             Internet Scale (CARIS) Workshop Report\", RFC 8073,\n          \
    \    DOI 10.17487/RFC8073, March 2017,\n              <https://www.rfc-editor.org/info/rfc8073>.\n\
    \   [RFC8164]  Nottingham, M. and M. Thomson, \"Opportunistic Security for\n \
    \             HTTP/2\", RFC 8164, DOI 10.17487/RFC8164, May 2017,\n          \
    \    <https://www.rfc-editor.org/info/rfc8164>.\n   [RFC8165]  Hardie, T., \"\
    Design Considerations for Metadata\n              Insertion\", RFC 8165, DOI 10.17487/RFC8165,\
    \ May 2017,\n              <https://www.rfc-editor.org/info/rfc8165>.\n   [RFC8250]\
    \  Elkins, N., Hamilton, R., and M. Ackermann, \"IPv6\n              Performance\
    \ and Diagnostic Metrics (PDM) Destination\n              Option\", RFC 8250,\
    \ DOI 10.17487/RFC8250, September 2017,\n              <https://www.rfc-editor.org/info/rfc8250>.\n\
    \   [RFC8274]  Kampanakis, P. and M. Suzuki, \"Incident Object Description\n \
    \             Exchange Format Usage Guidance\", RFC 8274,\n              DOI 10.17487/RFC8274,\
    \ November 2017,\n              <https://www.rfc-editor.org/info/rfc8274>.\n \
    \  [RFC8300]  Quinn, P., Ed., Elzur, U., Ed., and C. Pignataro, Ed.,\n       \
    \       \"Network Service Header (NSH)\", RFC 8300,\n              DOI 10.17487/RFC8300,\
    \ January 2018,\n              <https://www.rfc-editor.org/info/rfc8300>.\n  \
    \ [RFC8336]  Nottingham, M. and E. Nygren, \"The ORIGIN HTTP/2 Frame\",\n    \
    \          RFC 8336, DOI 10.17487/RFC8336, March 2018,\n              <https://www.rfc-editor.org/info/rfc8336>.\n\
    \   [SACM]     IETF, \"Security Automation and Continuous Monitoring\n       \
    \       (sacm)\", <https://datatracker.ietf.org/wg/sacm/charter/>.\n   [SNI-TLS]\
    \  Huitema, C. and E. Rescorla, \"Issues and Requirements for\n              SNI\
    \ Encryption in TLS\", Work in Progress, draft-ietf-tls-\n              sni-encryption-03,\
    \ May 2018.\n   [Snowden]  Verble, J., \"The NSA and Edward Snowden: Surveillance\
    \ in\n              the 21st Century\", SIGCAS Computer & Society, Vol. 44,\n\
    \              No. 3, DOI 10.1145/2684097.2684101, September 2014,\n         \
    \     <http://www.jjsylvia.com/bigdatacourse/wp-content/\n              uploads/2016/04/p14-verble-1.pdf>.\n\
    \   [TCPcrypt]\n              IETF, \"TCP Increased Security (tcpinc)\",\n   \
    \           <https://datatracker.ietf.org/wg/tcpinc/charter>.\n   [TS3GPP]   3GPP,\
    \ \"Non-Access-Stratum (NAS) protocol for Evolved\n              Packet System\
    \ (EPS); Stage 3\", 3GPP TS 24.301, version\n              15.2.0, March 2018.\n\
    \   [UPCON]    3GPP, \"User Plane Congestion Management\", 3GPP Rel-13,\n    \
    \          September 2014, <http://www.3gpp.org/DynaReport/\n              FeatureOrStudyItemFile-570029.htm>.\n\
    \   [UserData]\n              Durumeric, Z., Ma, Z., Springall, D., Barnes, R.,\n\
    \              Sullivan, N., Bursztein, E., Bailey, M., Alex Halderman,\n    \
    \          J., and V. Paxson, \"The Security Impact of HTTPS\n              Interception\"\
    , Network and Distributed Systems Symposium,\n              February 2017,\n \
    \             <http://dx.doi.org/10.14722/ndss.2017.23456>.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   Thanks to our reviewers, Natasha Rooney, Kevin Smith, Ashutosh\
    \ Dutta,\n   Brandon Williams, Jean-Michel Combes, Nalini Elkins, Paul Barrett,\n\
    \   Badri Subramanyan, Igor Lubashev, Suresh Krishnan, Dave Dolson,\n   Mohamed\
    \ Boucadair, Stephen Farrell, Warren Kumari, Alia Atlas, Roman\n   Danyliw, Mirja\
    \ Kuehlewind, Ines Robles, Joe Clarke, Kyle Rose,\n   Christian Huitema, and Chris\
    \ Morrow for their editorial and content\n   suggestions.  Surya K. Kovvali provided\
    \ material for Section 7.\n   Chris Morrow and Nik Teague provided reviews and\
    \ updates specific to\n   the DoS fingerprinting text.  Brian Trammell provided\
    \ the IPFIX text.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Kathleen Moriarty (editor)\n   Dell EMC\n   176 South\
    \ St\n   Hopkinton, MA\n   United States of America\n   Email: Kathleen.Moriarty@dell.com\n\
    \   Al Morton (editor)\n   AT&T Labs\n   200 Laurel Avenue South\n   Middletown,\
    \ NJ  07748\n   United States of America\n   Phone: +1 732 420 1571\n   Fax: \
    \  +1 732 368 1192\n   Email: acm@research.att.com\n"
