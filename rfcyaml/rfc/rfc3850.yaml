- title: __initial_text__
  contents:
  - "   Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1\n      \
    \                    Certificate Handling\n"
- title: Status of this Memo
  contents:
  - "Status of this Memo\n   This document specifies an Internet standards track protocol\
    \ for the\n   Internet community, and requests discussion and suggestions for\n\
    \   improvements.  Please refer to the current edition of the \"Internet\n   Official\
    \ Protocol Standards\" (STD 1) for the standardization state\n   and status of\
    \ this protocol.  Distribution of this memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2004).\n"
- title: Abstract
  contents:
  - "Abstract\n   This document specifies conventions for X.509 certificate usage\
    \ by\n   Secure/Multipurpose Internet Mail Extensions (S/MIME) agents.  S/MIME\n\
    \   provides a method to send and receive secure MIME messages, and\n   certificates\
    \ are an integral part of S/MIME agent processing.  S/MIME\n   agents validate\
    \ certificates as described in RFC 3280, the Internet\n   X.509 Public Key Infrastructure\
    \ Certificate and CRL Profile.  S/MIME\n   agents must meet the certificate processing\
    \ requirements in this\n   document as well as those in RFC 3280.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Overview . . . . . . . . . . . . . . . . . . . . .\
    \ . . . . . .  2\n       1.1.  Definitions. . . . . . . . . . . . . . . . . .\
    \ . . . . .  2\n       1.2.  Compatibility with Prior Practice of S/MIME. . .\
    \ . . . .  3\n       1.3.  Terminology. . . . . . . . . . . . . . . . . . . .\
    \ . . .  3\n       1.4.  Changes Since S/MIME v3 (RFC 2632) . . . . . . . . .\
    \ . .  3\n   2.  CMS Options. . . . . . . . . . . . . . . . . . . . . . . . .\
    \ .  4\n       2.1 . CertificateRevocationLists . . . . . . . . . . . . . . .\
    \  4\n       2.2.  CertificateChoices . . . . . . . . . . . . . . . . . . .  4\n\
    \       2.3.  CertificateSet . . . . . . . . . . . . . . . . . . . . .  5\n  \
    \ 3. Using Distinguished Names for Internet Mail . . . . . . . . . .  6\n   4.\
    \  Certificate Processing . . . . . . . . . . . . . . . . . . . .  7\n       4.1.\
    \  Certificate Revocation Lists . . . . . . . . . . . . . .  8\n       4.2.  Certification\
    \ Path Validation. . . . . . . . . . . . . .  8\n       4.3.  Certificate and\
    \ CRL Signing Algorithms . . . . . . . . .  9\n       4.4.  PKIX Certificate Extensions.\
    \ . . . . . . . . . . . . . .  9\n   5.  Security Considerations. . . . . . .\
    \ . . . . . . . . . . . . . 11\n   A.  References . . . . . . . . . . . . . .\
    \ . . . . . . . . . . . . 13\n       A.1.  Normative References . . . . . . .\
    \ . . . . . . . . . . . 13\n       A.2.  Informative References . . . . . . .\
    \ . . . . . . . . . . 14\n   B.  Acknowledgements . . . . . . . . . . . . . .\
    \ . . . . . . . . . 15\n   C.  Editor's Address . . . . . . . . . . . . . . .\
    \ . . . . . . . . 15\n   Full Copyright Statement . . . . . . . . . . . . . .\
    \ . . . . . . . 16\n"
- title: 1.  Overview
  contents:
  - "1.  Overview\n   S/MIME (Secure/Multipurpose Internet Mail Extensions), described\
    \ in\n   [SMIME-MSG], provides a method to send and receive secure MIME\n   messages.\
    \  Before using a public key to provide security services,\n   the S/MIME agent\
    \ MUST verify that the public key is valid.  S/MIME\n   agents MUST use PKIX certificates\
    \ to validate public keys as\n   described in the Internet X.509 Public Key Infrastructure\
    \ (PKIX)\n   Certificate and CRL Profile [KEYM].  S/MIME agents MUST meet the\n\
    \   certificate processing requirements documented in this document in\n   addition\
    \ to those stated in [KEYM].\n   This specification is compatible with the Cryptographic\
    \ Message\n   Syntax [CMS] in that it uses the data types defined by CMS.  It\
    \ also\n   inherits all the varieties of architectures for certificate-based key\n\
    \   management supported by CMS.\n"
- title: 1.1.  Definitions
  contents:
  - "1.1.  Definitions\n   For the purposes of this document, the following definitions\
    \ apply.\n   ASN.1: Abstract Syntax Notation One, as defined in ITU-T X.208\n\
    \   [X.208-88].\n   Attribute Certificate (AC): An X.509 AC is a separate structure\
    \ from\n   a subject's public key X.509 Certificate.  A subject may have\n   multiple\
    \ X.509 ACs associated with each of its public key X.509\n   Certificates.  Each\
    \ X.509 AC binds one or more Attributes with one of\n   the subject's public key\
    \ X.509 Certificates.  The X.509 AC syntax is\n   defined in [ACAUTH].\n   Certificate:\
    \  A type that binds an entity's name to a public key with\n   a digital signature.\
    \  This type is defined in the Internet X.509\n   Public Key Infrastructure (PKIX)\
    \ Certificate and CRL Profile [KEYM].\n   This type also contains the distinguished\
    \ name of the certificate\n   issuer (the signer), an issuer-specific serial number,\
    \ the issuer's\n   signature algorithm identifier, a validity period, and extensions\n\
    \   also defined in that document.\n   Certificate Revocation List (CRL): A type\
    \ that contains information\n   about certificates whose validity an issuer has\
    \ prematurely revoked.\n   The information consists of an issuer name, the time\
    \ of issue, the\n   next scheduled time of issue, a list of certificate serial\
    \ numbers\n   and their associated revocation times, and extensions as defined\
    \ in\n   [KEYM].  The CRL is signed by the issuer.  The type intended by this\n\
    \   specification is the one defined in [KEYM].\n   Receiving agent: software\
    \ that interprets and processes S/MIME CMS\n   objects, MIME body parts that contain\
    \ CMS objects, or both.\n   Sending agent: software that creates S/MIME CMS objects,\
    \ MIME body\n   parts that contain CMS objects, or both.\n   S/MIME agent: user\
    \ software that is a receiving agent, a sending\n   agent, or both.\n"
- title: 1.2.  Compatibility with Prior Practice of S/MIME
  contents:
  - "1.2.  Compatibility with Prior Practice of S/MIME\n   S/MIME version 3.1 agents\
    \ should attempt to have the greatest\n   interoperability possible with agents\
    \ for prior versions of S/MIME.\n   S/MIME version 2 is described in RFC 2311\
    \ through RFC 2315, inclusive\n   and S/MIME version 3 is described in RFC 2630\
    \ through RFC 2634\n   inclusive.  RFC 2311 also has historical information about\
    \ the\n   development of S/MIME.\n"
- title: 1.3.  Terminology
  contents:
  - "1.3.  Terminology\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"\
    SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\"\
    , and \"OPTIONAL\" in this\n   document are to be interpreted as described in\
    \ [MUSTSHOULD].\n"
- title: 1.4.  Changes Since S/MIME v3 (RFC 2632)
  contents:
  - "1.4.  Changes Since S/MIME v3 (RFC 2632)\n   Version 1 and Version 2 CRLs MUST\
    \ be supported.\n   Multiple CA certificates with the same subject and public\
    \ key, but\n   with overlapping validity periods, MUST be supported.\n   Version\
    \ 2 attribute certificates SHOULD be supported, and version 1\n   attributes certificates\
    \ MUST NOT be used.\n   The use of the MD2 digest algorithm for certificate signatures\
    \ is\n   discouraged and security language added.\n   Clarified use of email address\
    \ use in certificates.  Certificates\n   that do not contain an email address\
    \ have no requirements for\n   verifying the email address associated with the\
    \ certificate.\n   Receiving agents SHOULD display certificate information when\n\
    \   displaying the results of signature verification.\n   Receiving agents MUST\
    \ NOT accept a signature made with a certificate\n   that does not have the digitalSignature\
    \ or nonRepudiation bit set.\n   Clarifications for the interpretation of the\
    \ key usage and extended\n   key usage extensions.\n"
- title: 2.  CMS Options
  contents:
  - "2.  CMS Options\n   The CMS message format allows for a wide variety of options\
    \ in\n   content and algorithm support.  This section puts forth a number of\n\
    \   support requirements and recommendations in order to achieve a base\n   level\
    \ of interoperability among all S/MIME implementations.  Most of\n   the CMS format\
    \ for S/MIME messages is defined in [SMIME-MSG].\n"
- title: 2.1.  CertificateRevocationLists
  contents:
  - "2.1.  CertificateRevocationLists\n   Receiving agents MUST support the Certificate\
    \ Revocation List (CRL)\n   format defined in [KEYM].  If sending agents include\
    \ CRLs in outgoing\n   messages, the CRL format defined in [KEYM] MUST be used.\
    \  In all\n   cases, both v1 and v2 CRLs MUST be supported.\n   All agents MUST\
    \ be capable of performing revocation checks using CRLs\n   as specified in [KEYM].\
    \  All agents MUST perform revocation status\n   checking in accordance with [KEYM].\
    \  Receiving agents MUST recognize\n   CRLs in received S/MIME messages.\n   Agents\
    \ SHOULD store CRLs received in messages for use in processing\n   later messages.\n"
- title: 2.2.  CertificateChoices
  contents:
  - "2.2.  CertificateChoices\n   Receiving agents MUST support v1 X.509 and v3 X.509\
    \ identity\n   certificates as profiled in [KEYM].  End entity certificates MAY\n\
    \   include an Internet mail address, as described in section 3.\n   Receiving\
    \ agents SHOULD support X.509 version 2 attribute\n   certificates.  See [ACAUTH]\
    \ for details about the profile for\n   attribute certificates.\n"
- title: 2.2.1.  Historical Note About CMS Certificates
  contents:
  - "2.2.1.  Historical Note About CMS Certificates\n   The CMS message format supports\
    \ a choice of certificate formats for\n   public key content types: PKIX, PKCS\
    \ #6 Extended Certificates [PKCS6]\n   and PKIX Attribute Certificates.\n   The\
    \ PKCS #6 format is not in widespread use.  In addition, PKIX\n   certificate\
    \ extensions address much of the same functionality and\n   flexibility as was\
    \ intended in the PKCS #6.  Thus, sending and\n   receiving agents MUST NOT use\
    \ PKCS #6 extended certificates.\n   X.509 version 1 attribute certificates are\
    \ also not widely\n   implemented, and have been superseded with version 2 attribute\n\
    \   certificates.  Sending agents MUST NOT send version 1 attribute\n   certificates.\n"
- title: 2.3.  CertificateSet
  contents:
  - "2.3.  CertificateSet\n   Receiving agents MUST be able to handle an arbitrary\
    \ number of\n   certificates of arbitrary relationship to the message sender and\
    \ to\n   each other in arbitrary order.  In many cases, the certificates\n   included\
    \ in a signed message may represent a chain of certification\n   from the sender\
    \ to a particular root.  There may be, however,\n   situations where the certificates\
    \ in a signed message may be\n   unrelated and included for convenience.\n   Sending\
    \ agents SHOULD include any certificates for the user's public\n   key(s) and\
    \ associated issuer certificates.  This increases the\n   likelihood that the\
    \ intended recipient can establish trust in the\n   originator's public key(s).\
    \  This is especially important when\n   sending a message to recipients that\
    \ may not have access to the\n   sender's public key through any other means or\
    \ when sending a signed\n   message to a new recipient.  The inclusion of certificates\
    \ in\n   outgoing messages can be omitted if S/MIME objects are sent within a\n\
    \   group of correspondents that has established access to each other's\n   certificates\
    \ by some other means such as a shared directory or manual\n   certificate distribution.\
    \  Receiving S/MIME agents SHOULD be able to\n   handle messages without certificates\
    \ using a database or directory\n   lookup scheme.\n   A sending agent SHOULD\
    \ include at least one chain of certificates up\n   to, but not including, a Certificate\
    \ Authority (CA) that it believes\n   that the recipient may trust as authoritative.\
    \  A receiving agent\n   MUST be able to handle an arbitrarily large number of\
    \ certificates\n   and chains.\n   Agents MAY send CA certificates, that is, certificates\
    \ which can be\n   considered the \"root\" of other chains, and which MAY be self-signed.\n\
    \   Note that receiving agents SHOULD NOT simply trust any self-signed\n   certificates\
    \ as valid CAs, but SHOULD use some other mechanism to\n   determine if this is\
    \ a CA that should be trusted.  Also note that\n   when certificates contain DSA\
    \ public keys the parameters may be\n   located in the root certificate.  This\
    \ would require that the\n   recipient possess both the end-entity certificate\
    \ as well as the root\n   certificate to perform a signature verification, and\
    \ is a valid\n   example of a case where transmitting the root certificate may\
    \ be\n   required.\n   Receiving agents MUST support chaining based on the distinguished\n\
    \   name fields.  Other methods of building certificate chains MAY be\n   supported.\n\
    \   Receiving agents SHOULD support the decoding of X.509 attribute\n   certificates\
    \ included in CMS objects.  All other issues regarding the\n   generation and\
    \ use of X.509 attribute certificates are outside of the\n   scope of this specification.\
    \  One specification that addresses\n   attribute certificate use is defined in\
    \ [SECLABEL].\n"
- title: 3.  Using Distinguished Names for Internet Mail
  contents:
  - "3.  Using Distinguished Names for Internet Mail\n   End-entity certificates MAY\
    \ contain an Internet mail address as\n   described in [RFC-2822].  The address\
    \ must be an \"addr-spec\" as\n   defined in Section 3.4.1 of that specification.\
    \  The email address\n   SHOULD be in the subjectAltName extension, and SHOULD\
    \ NOT be in the\n   subject distinguished name.\n   Receiving agents MUST recognize\
    \ and accept certificates that contain\n   no email address.  Agents are allowed\
    \ to provide an alternative\n   mechanism for associating an email address with\
    \ a certificate that\n   does not contain an email address, such as through the\
    \ use of the\n   agent's address book, if available.  Receiving agents MUST recognize\n\
    \   email addresses in the subjectAltName field.  Receiving agents MUST\n   recognize\
    \ email addresses in the Distinguished Name field in the PKCS\n   #9 [PKCS9] emailAddress\
    \ attribute:\n   pkcs-9-at-emailAddress OBJECT IDENTIFIER ::=\n     {iso(1) member-body(2)\
    \ us(840) rsadsi(113549) pkcs(1) pkcs-9(9) 1 }\n   Note that this attribute MUST\
    \ be encoded as IA5String.\n   Sending agents SHOULD make the address in the From\
    \ or Sender header\n   in a mail message match an Internet mail address in the\
    \ signer's\n   certificate.  Receiving agents MUST check that the address in the\n\
    \   From or Sender header of a mail message matches an Internet mail\n   address,\
    \ if present, in the signer's certificate, if mail addresses\n   are present in\
    \ the certificate.  A receiving agent SHOULD provide\n   some explicit alternate\
    \ processing of the message if this comparison\n   fails, which may be to display\
    \ a message that shows the recipient the\n   addresses in the certificate or other\
    \ certificate details.\n   A receiving agent SHOULD display a subject name or\
    \ other certificate\n   details when displaying an indication of successful or\
    \ unsuccessful\n   signature verification.\n   All subject and issuer names MUST\
    \ be populated (i.e., not an empty\n   SEQUENCE) in S/MIME-compliant X.509 identity\
    \ certificates, except\n   that the subject DN in a user's (i.e., end-entity)\
    \ certificate MAY be\n   an empty SEQUENCE in which case the subjectAltName extension\
    \ will\n   include the subject's identifier and MUST be marked as critical.\n"
- title: 4.  Certificate Processing
  contents:
  - "4.  Certificate Processing\n   A receiving agent needs to provide some certificate\
    \ retrieval\n   mechanism in order to gain access to certificates for recipients\
    \ of\n   digital envelopes.  There are many ways to implement certificate\n  \
    \ retrieval mechanisms.  X.500 directory service is an excellent\n   example of\
    \ a certificate retrieval-only mechanism that is compatible\n   with classic X.500\
    \ Distinguished Names.  Another method under\n   consideration by the IETF is\
    \ to provide certificate retrieval\n   services as part of the existing Domain\
    \ Name System (DNS).  Until\n   such mechanisms are widely used, their utility\
    \ may be limited by the\n   small number of correspondent's certificates that\
    \ can be retrieved.\n   At a minimum, for initial S/MIME deployment, a user agent\
    \ could\n   automatically generate a message to an intended recipient requesting\n\
    \   that recipient's certificate in a signed return message.\n   Receiving and\
    \ sending agents SHOULD also provide a mechanism to allow\n   a user to \"store\
    \ and protect\" certificates for correspondents in such\n   a way so as to guarantee\
    \ their later retrieval.  In many\n   environments, it may be desirable to link\
    \ the certificate\n   retrieval/storage mechanisms together in some sort of certificate\n\
    \   database.  In its simplest form, a certificate database would be\n   local\
    \ to a particular user and would function in a similar way as an\n   \"address\
    \ book\" that stores a user's frequent correspondents.  In this\n   way, the certificate\
    \ retrieval mechanism would be limited to the\n   certificates that a user has\
    \ stored (presumably from incoming\n   messages).  A comprehensive certificate\
    \ retrieval/storage solution\n   may combine two or more mechanisms to allow the\
    \ greatest flexibility\n   and utility to the user.  For instance, a secure Internet\
    \ mail agent\n   may resort to checking a centralized certificate retrieval mechanism\n\
    \   for a certificate if it can not be found in a user's local\n   certificate\
    \ storage/retrieval database.\n   Receiving and sending agents SHOULD provide\
    \ a mechanism for the\n   import and export of certificates, using a CMS certs-only\
    \ message.\n   This allows for import and export of full certificate chains as\n\
    \   opposed to just a single certificate.  This is described in [SMIME-\n   MSG].\n\
    \   Agents MUST handle multiple valid Certification Authority (CA)\n   certificates\
    \ containing the same subject name and the same public\n   keys but with overlapping\
    \ validity intervals.\n"
- title: 4.1.  Certificate Revocation Lists
  contents:
  - "4.1.  Certificate Revocation Lists\n   In general, it is always better to get\
    \ the latest CRL information\n   from a CA than to get information stored away\
    \ from incoming messages.\n   A receiving agent SHOULD have access to some certificate\
    \ revocation\n   list (CRL) retrieval mechanism in order to gain access to certificate\n\
    \   revocation information when validating certification paths.  A\n   receiving\
    \ or sending agent SHOULD also provide a mechanism to allow a\n   user to store\
    \ incoming certificate revocation information for\n   correspondents in such a\
    \ way so as to guarantee its later retrieval.\n   Receiving and sending agents\
    \ SHOULD retrieve and utilize CRL\n   information every time a certificate is\
    \ verified as part of a\n   certification path validation even if the certificate\
    \ was already\n   verified in the past.  However, in many instances (such as off-line\n\
    \   verification) access to the latest CRL information may be difficult\n   or\
    \ impossible.  The use of CRL information, therefore, may be\n   dictated by the\
    \ value of the information that is protected.  The\n   value of the CRL information\
    \ in a particular context is beyond the\n   scope of this specification but may\
    \ be governed by the policies\n   associated with particular certification paths.\n\
    \   All agents MUST be capable of performing revocation checks using CRLs\n  \
    \ as specified in [KEYM].  All agents MUST perform revocation status\n   checking\
    \ in accordance with [KEYM].  Receiving agents MUST recognize\n   CRLs in received\
    \ S/MIME messages.\n"
- title: 4.2.  Certification Path Validation
  contents:
  - "4.2.  Certification Path Validation\n   In creating a user agent for secure messaging,\
    \ certificate, CRL, and\n   certification path validation SHOULD be highly automated\
    \ while still\n   acting in the best interests of the user.  Certificate, CRL,\
    \ and path\n   validation MUST be performed as per [KEYM] when validating a\n\
    \   correspondent's public key.  This is necessary before using a public\n   key\
    \ to provide security services such as: verifying a signature;\n   encrypting\
    \ a content-encryption key (ex: RSA); or forming a pairwise\n   symmetric key\
    \ (ex: Diffie-Hellman) to be used to encrypt or decrypt a\n   content-encryption\
    \ key.\n   Certificates and CRLs are made available to the path validation\n \
    \  procedure in two ways: a) incoming messages, and b) certificate and\n   CRL\
    \ retrieval mechanisms.  Certificates and CRLs in incoming messages\n   are not\
    \ required to be in any particular order nor are they required\n   to be in any\
    \ way related to the sender or recipient of the message\n   (although in most\
    \ cases they will be related to the sender).\n   Incoming certificates and CRLs\
    \ SHOULD be cached for use in path\n   validation and optionally stored for later\
    \ use.  This temporary\n   certificate and CRL cache SHOULD be used to augment\
    \ any other\n   certificate and CRL retrieval mechanisms for path validation on\n\
    \   incoming signed messages.\n"
- title: 4.3.  Certificate and CRL Signing Algorithms
  contents:
  - "4.3.  Certificate and CRL Signing Algorithms\n   Certificates and Certificate\
    \ Revocation Lists (CRLs) are signed by\n   the certificate issuer.  A receiving\
    \ agent MUST be capable of\n   verifying the signatures on certificates and CRLs\
    \ made with\n   id-dsa-with-sha1 [CMSALG].\n   A receiving agent MUST be capable\
    \ of verifying the signatures on\n   certificates and CRLs made with md5WithRSAEncryption\
    \ and\n   sha1WithRSAEncryption signature algorithms with key sizes from 512\n\
    \   bits to 2048 bits described in [CMSALG].\n   Because of the security issues\
    \ surrounding MD2 [RC95], and in light\n   of current use, md2WithRSAEncryption\
    \ MAY be supported.\n"
- title: 4.4.  PKIX Certificate Extensions
  contents:
  - "4.4.  PKIX Certificate Extensions\n   PKIX describes an extensible framework\
    \ in which the basic certificate\n   information can be extended and how such\
    \ extensions can be used to\n   control the process of issuing and validating\
    \ certificates.  The PKIX\n   Working Group has ongoing efforts to identify and\
    \ create extensions\n   which have value in particular certification environments.\
    \  Further,\n   there are active efforts underway to issue PKIX certificates for\n\
    \   business purposes.  This document identifies the minimum required set\n  \
    \ of certificate extensions which have the greatest value in the S/MIME\n   environment.\
    \  The syntax and semantics of all the identified\n   extensions are defined in\
    \ [KEYM].\n   Sending and receiving agents MUST correctly handle the basic\n \
    \  constraints, key usage, authority key identifier, subject key\n   identifier,\
    \ and subject alternative names certificate extensions when\n   they appear in\
    \ end-entity and CA certificates.  Some mechanism SHOULD\n   exist to gracefully\
    \ handle other certificate extensions when they\n   appear in end-entity or CA\
    \ certificates.\n   Certificates issued for the S/MIME environment SHOULD NOT\
    \ contain any\n   critical extensions (extensions that have the critical field\
    \ set to\n   TRUE) other than those listed here.  These extensions SHOULD be\n\
    \   marked as non-critical unless the proper handling of the extension is\n  \
    \ deemed critical to the correct interpretation of the associated\n   certificate.\
    \  Other extensions may be included, but those extensions\n   SHOULD NOT be marked\
    \ as critical.\n   Interpretation and syntax for all extensions MUST follow [KEYM],\n\
    \   unless otherwise specified here.\n"
- title: 4.4.1.  Basic Constraints Certificate Extension
  contents:
  - "4.4.1.  Basic Constraints Certificate Extension\n   The basic constraints extension\
    \ serves to delimit the role and\n   position that an issuing authority or end-entity\
    \ certificate plays in\n   a certification path.\n   For example, certificates\
    \ issued to CAs and subordinate CAs contain a\n   basic constraint extension that\
    \ identifies them as issuing authority\n   certificates.  End-entity certificates\
    \ contain an extension that\n   constrains the certificate from being an issuing\
    \ authority\n   certificate.\n   Certificates SHOULD contain a basicConstraints\
    \ extension in CA\n   certificates, and SHOULD NOT contain that extension in end\
    \ entity\n   certificates.\n"
- title: 4.4.2.  Key Usage Certificate Extension
  contents:
  - "4.4.2.  Key Usage Certificate Extension\n   The key usage extension serves to\
    \ limit the technical purposes for\n   which a public key listed in a valid certificate\
    \ may be used.\n   Issuing authority certificates may contain a key usage extension\
    \ that\n   restricts the key to signing certificates, certificate revocation\n\
    \   lists and other data.\n   For example, a certification authority may create\
    \ subordinate issuer\n   certificates which contain a key usage extension which\
    \ specifies that\n   the corresponding public key can be used to sign end user\n\
    \   certificates and sign CRLs.\n   If a key usage extension is included in a\
    \ PKIX certificate, then it\n   MUST be marked as critical.\n   S/MIME receiving\
    \ agents MUST NOT accept the signature of a message if\n   it was verified using\
    \ a certificate which contains the key usage\n   extension without either the\
    \ digitalSignature or nonRepudiation bit\n   set.  Sometimes S/MIME is used as\
    \ a secure message transport for\n   applications beyond interpersonal messaging.\
    \  In such cases, the\n   S/MIME-enabled application can specify additional requirements\n\
    \   concerning the digitalSignature or nonRepudiation bits within this\n   extension.\n\
    \   If the key usage extension is not specified, receiving clients MUST\n   presume\
    \ that the digitalSignature and nonRepudiation bits are set.\n"
- title: 4.4.3.  Subject Alternative Name Extension
  contents:
  - "4.4.3.  Subject Alternative Name Extension\n   The subject alternative name extension\
    \ is used in S/MIME as the\n   preferred means to convey the RFC-2822 email address(es)\
    \ that\n   correspond(s) to the entity for this certificate.  Any RFC-2822 email\n\
    \   addresses present MUST be encoded using the rfc822Name CHOICE of the\n   GeneralName\
    \ type.  Since the SubjectAltName type is a SEQUENCE OF\n   GeneralName, multiple\
    \ RFC-2822 email addresses MAY be present.\n"
- title: 4.4.4.  Extended Key Usage Extension
  contents:
  - "4.4.4.  Extended Key Usage Extension\n   The extended key usage extension also\
    \ serves to limit the technical\n   purposes for which a public key listed in\
    \ a valid certificate may be\n   used.  The set of technical purposes for the\
    \ certificate therefore\n   are the intersection of the uses indicated in the\
    \ key usage and\n   extended key usage extensions.\n   For example, if the certificate\
    \ contains a key usage extension\n   indicating digital signature and an extended\
    \ key usage extension\n   which includes the email protection OID, then the certificate\
    \ may be\n   used for signing but not encrypting S/MIME messages.  If the\n  \
    \ certificate contains a key usage extension indicating digital\n   signature,\
    \ but no extended key usage extension then the certificate\n   may also be used\
    \ to sign but not encrypt S/MIME messages.\n   If the extended key usage extension\
    \ is present in the certificate\n   then interpersonal message S/MIME receiving\
    \ agents MUST check that it\n   contains either the emailProtection or the anyExtendedKeyUsage\
    \ OID as\n   defined in [KEYM].  S/MIME uses other than interpersonal messaging\n\
    \   MAY require the explicit presence of the extended key usage extension\n  \
    \ or other OIDs to be present in the extension or both.\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   All of the security issues faced by any cryptographic\
    \ application\n   must be faced by a S/MIME agent.  Among these issues are protecting\n\
    \   the user's private key, preventing various attacks, and helping the\n   user\
    \ avoid mistakes such as inadvertently encrypting a message for\n   the wrong\
    \ recipient.  The entire list of security considerations is\n   beyond the scope\
    \ of this document, but some significant concerns are\n   listed here.\n   When\
    \ processing certificates, there are many situations where the\n   processing\
    \ might fail.  Because the processing may be done by a user\n   agent, a security\
    \ gateway, or other program, there is no single way\n   to handle such failures.\
    \  Just because the methods to handle the\n   failures has not been listed, however,\
    \ the reader should not assume\n   that they are not important.  The opposite\
    \ is true: if a certificate\n   is not provably valid and associated with the\
    \ message, the processing\n   software should take immediate and noticeable steps\
    \ to inform the end\n   user about it.\n   Some of the many places where signature\
    \ and certificate checking\n   might fail include:\n   -  no Internet mail addresses\
    \ in a certificate matches the sender of\n      a message, if the certificate\
    \ contains at least one mail address\n   -  no certificate chain leads to a trusted\
    \ CA\n   -  no ability to check the CRL for a certificate\n   -  an invalid CRL\
    \ was received\n   -  the CRL being checked is expired\n   -  the certificate\
    \ is expired\n   -  the certificate has been revoked\n   There are certainly other\
    \ instances where a certificate may be\n   invalid, and it is the responsibility\
    \ of the processing software to\n   check them all thoroughly, and to decide what\
    \ to do if the check\n   fails.\n   At the Selected Areas in Cryptography '95\
    \ conference in May 1995,\n   Rogier and Chauvaud presented an attack on MD2 that\
    \ can nearly find\n   collisions [RC95].  Collisions occur when one can find two\
    \ different\n   messages that generate the same message digest.  A checksum operation\n\
    \   in MD2 is the only remaining obstacle to the success of the attack.\n   For\
    \ this reason, the use of MD2 for new applications is discouraged.\n   It is still\
    \ reasonable to use MD2 to verify existing signatures, as\n   the ability to find\
    \ collisions in MD2 does not enable an attacker to\n   find new messages having\
    \ a previously computed hash value.\n   It is possible for there to be multiple\
    \ unexpired CRLs for a CA.  If\n   an agent is consulting CRLs for certificate\
    \ validation, it SHOULD\n   make sure that the most recently issued CRL for that\
    \ CA is consulted,\n   since an S/MIME message sender could deliberately include\
    \ an older\n   unexpired CRL in an S/MIME message.  This older CRL might not include\n\
    \   recent revoked certificates, which might lead an agent to accept a\n   certificate\
    \ that has been revoked in a subsequent CRL.\n   When determining the time for\
    \ a certificate validity check, agents\n   have to be careful to use a reliable\
    \ time.  Unless it is from a\n   trusted agent, this time MUST NOT be the SigningTime\
    \ attribute found\n   in an S/MIME message.  For most sending agents, the SigningTime\n\
    \   attribute could be deliberately set to direct the receiving agent to\n   check\
    \ a CRL that could have out-of-date revocation status for a\n   certificate, or\
    \ cause an improper result when checking the Validity\n   field of a certificate.\n"
- title: A.  References
  contents:
  - 'A.  References

    '
- title: A.1.  Normative References
  contents:
  - "A.1.  Normative References\n   [ACAUTH]     Farrell, S. and R. Housley, \"An\
    \ Internet Attribute\n                Certificate Profile for Authorization\"\
    , RFC 3281, April\n                2002.\n   [CMS]        Housely, R., \"Cryptographic\
    \ Message Syntax (CMS)\", RFC\n                3852, July 2004.\n   [CMSALG] \
    \    Housley, R., \"Cryptographic Message Syntax (CMS)\n                Algorithms\"\
    , RFC 3370, August 2002.\n   [KEYM]       Housley, R., Polk, W., Ford, W., and\
    \ D. Solo, \"Internet\n                X.509 Public Key Infrastructure Certificate\
    \ and\n                Certificate Revocation List (CRL) Profile\", RFC 3280,\n\
    \                April 2002.\n   [KEYMALG]    Bassham, L., Polk, W., and R. Housley,\
    \ \"Algorithms and\n                Identifiers for the Internet X.509 Public\
    \ Key\n                Infrastructure Certificate and Certificate Revocation\n\
    \                List (CRL) Profile\", RFC 3279, April 2002.\n   [MUSTSHOULD]\
    \ Bradner, S., \"Key words for use in RFCs to Indicate\n                Requirement\
    \ Levels\", BCP 14, RFC 2119, March 1997.\n   [PKCS9]      Nystrom, M. and B.\
    \ Kaliski, \"PKCS #9: Selected Object\n                Classes and Attribute Types\
    \ Version 2.0\", RFC 2985,\n                November 2000.\n   [RFC-2822],  Resnick,\
    \ P., \"Internet Message Format\", RFC 2822, April\n                2001.\n  \
    \ [SMIME-MSG]  Ramsdell, B., Ed., \"S/MIME Version 3.1 Message\n             \
    \   Specification\", RFC 3851, July 2004.\n   [x.208-88]   ITU-T. Recommendation\
    \ X.208: Specification of Abstract\n                Syntax Notation One (ASN.1).\
    \ 1988.\n"
- title: A.2.  Informative References
  contents:
  - "A.2.  Informative References\n   [CERTV2]     Dusse, S., Hoffman, P., Ramsdell,\
    \ B., and J. Weinstein,\n                \"S/MIME Version 2 Certificate Handling\"\
    , RFC 2312, March\n                1998.\n   [PKCS6]      RSA Laboratories, \"\
    PKCS #6: Extended-Certificate Syntax\n                Standard\", November 1993.\n\
    \   [RC95]       Rogier, N. and Chauvaud, P., \"The compression function\n   \
    \             of MD2 is not collision free,\" Presented at Selected\n        \
    \        Areas in Cryptography '95, May 1995.\n   [SECLABEL]   Nicolls, W., \"\
    Implementing Company Classification Policy\n                with the S/MIME Security\
    \ Label\", RFC 3114, May 2002.\n   [X.500]      ITU-T Recommendation X.500 (1997)\
    \ | ISO/IEC 9594-1:1997,\n                Information technology - Open Systems\
    \ Interconnection -\n                The Directory:  Overview of concepts, models\
    \ and\n                services.\n   [X.501]      ITU-T Recommendation X.501 (1997)\
    \ | ISO/IEC 9594-2:1997,\n                Information technology - Open Systems\
    \ Interconnection -\n                The Directory:  Models.\n   [X.509]     \
    \ ITU-T Recommendation X.509 (1997) | ISO/IEC 9594-8:1997,\n                Information\
    \ technology - Open Systems Interconnection -\n                The Directory:\
    \  Authentication framework.\n   [X.520]      ITU-T Recommendation X.520 (1997)\
    \ | ISO/IEC 9594-6:1997,\n                Information technology - Open Systems\
    \ Interconnection -\n                The Directory:  Selected attribute types.\n"
- title: B.  Acknowledgements
  contents:
  - "B.  Acknowledgements\n   Many thanks go out to the other authors of the S/MIME\
    \ v2 RFC: Steve\n   Dusse, Paul Hoffman and Jeff Weinstein.  Without v2, there\
    \ wouldn't\n   be a v3.\n   A number of the members of the S/MIME Working Group\
    \ have also worked\n   very hard and contributed to this document.  Any list of\
    \ people is\n   doomed to omission and for that I apologize.  In alphabetical\
    \ order,\n   the following people stand out in my mind due to the fact that they\n\
    \   made direct contributions to this document.\n   Bill Flanigan\n   Trevor Freeman\n\
    \   Elliott Ginsburg\n   Paul Hoffman\n   Russ Housley\n   David P. Kemp\n   Michael\
    \ Myers\n   John Pawling\n   Denis Pinkas\n   Jim Schaad\n"
- title: C.  Editor's Address
  contents:
  - "C.  Editor's Address\n   Blake Ramsdell\n   Sendmail, Inc.\n   704 228th Ave\
    \ NE #775\n   Sammamish, WA  98074\n   EMail: blake@sendmail.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2004).  This\
    \ document is subject\n   to the rights, licenses and restrictions contained in\
    \ BCP 78, and\n   except as set forth therein, the authors retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at ietf-\n   ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is currently provided\
    \ by the\n   Internet Society.\n"
