- title: __initial_text__
  contents:
  - '                       Mobile IPv4 Fast Handovers

    '
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo defines an Experimental Protocol for the Internet\n\
    \   community.  It does not specify an Internet standard of any kind.\n   Discussion\
    \ and suggestions for improvement are requested.\n   Distribution of this memo\
    \ is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document adapts the Mobile IPv6 Fast Handovers to improve delay\n\
    \   and packet loss resulting from Mobile IPv4 handover operations.\n   Specifically,\
    \ this document addresses movement detection, IP address\n   configuration, and\
    \ location update latencies during a handover.  For\n   reducing the IP address\
    \ configuration latency, the document proposes\n   that the new Care-of Address\
    \ is always made to be the new access\n   router's IP address.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \ 3. Factors Affecting Handover ......................................5\n   4.\
    \ Protocol ........................................................6\n      4.1.\
    \ Overview ...................................................6\n      4.2. Operation\
    \ ..................................................7\n   5. Message Formats ................................................10\n\
    \      5.1. Fast Binding Update (FBU) .................................10\n  \
    \    5.2. Fast Binding Acknowledgment (FBAck) .......................12\n    \
    \  5.3. Router Solicitation for Proxy Advertisement (RtSolPr) .....13\n      5.4.\
    \ Proxy Router Advertisement (PrRtAdv) ......................14\n      5.5. Handover\
    \ Initiate (HI) ....................................17\n      5.6. Handover Acknowledge\
    \ (HAck) ...............................19\n   6. Option Formats .................................................20\n\
    \      6.1. Link-Layer Address Option Format ..........................20\n  \
    \    6.2. New IPv4 Address Option Format ............................22\n    \
    \  6.3. New Router Prefix Information Option ......................22\n   7. Security\
    \ Considerations ........................................23\n   8. IANA Considerations\
    \ ............................................24\n   9. Acknowledgments ................................................25\n\
    \   10. References ....................................................25\n  \
    \    10.1. Normative References .....................................25\n    \
    \  10.2. Informative References ...................................26\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document adapts the fast handover specification [rfc4068]\
    \ to\n   IPv4 networks.  The fast handover protocol specified in this document\n\
    \   is particularly interesting for operation over links such as IEEE 802\n  \
    \ wireless links.  Fast handovers are not typically needed for wired\n   media\
    \ due to the relatively large delays attributable to establishing\n   new connections\
    \ in today's wired networks.  Mobile IPv4 [rfc3344]\n   registration messages\
    \ are reused (with new type numbers) in this\n   document to enable faster implementation\
    \ using existing Mobile IPv4\n   software.  This document does not require link-layer\
    \ triggers for\n   protocol operation, but performance will typically be enhanced\
    \ by\n   using the appropriate triggers when they are available.  This\n   document\
    \ assumes that the reader is familiar with the basic operation\n   and terminology\
    \ of Mobile IPv4 [rfc3344] and Fast Handovers for\n   Mobile IPv6 [rfc4068].\n\
    \   The active agents that enable continued packet delivery to a mobile\n   node\
    \ (MN) are the access routers on the networks that the mobile node\n   connects\
    \ to.  Handover means that the mobile node changes its network\n   connection,\
    \ and we consider the scenario in which this change means\n   change in access\
    \ routers.  The mobile node utilizes the access\n   routers as default routers\
    \ in the normal sense, but also as partners\n   in mobility management.  Thus,\
    \ when the mobile node moves to a new\n   network, it processes handover-related\
    \ signaling in order to identify\n   and develop a relationship with a new access\
    \ router.  In this\n   document, we call the previous access router PAR and the\
    \ new access\n   router NAR, consistent with the terminology in [rfc4068].  Unless\n\
    \   otherwise mentioned, a PAR is also a Previous Foreign Agent (PFA) and\n  \
    \ a NAR is also a New Foreign Agent (NFA).\n   On a particular network, a mobile\
    \ node may obtain its IP address via\n   DHCP [rfc2131] (i.e., Co-located Care-of\
    \ Address) or use the Foreign\n   Agent CoA.  During a handover, the new CoA (NCoA)\
    \ is always made to\n   be that of NAR.  This allows a mobile node to receive\
    \ and send\n   packets using its previous CoA (PCoA), so that delays resulting\
    \ from\n   IP configuration (such as DHCP address acquisition delay) subsequent\n\
    \   to attaching to the new link are disengaged from affecting the\n   existing\
    \ sessions.\n   Unlike in Mobile IPv6, a Mobile IPv4 host may rely on its Foreign\n\
    \   Agent to provide a Care-of Address.  Using the protocol specified in\n   this\
    \ document, the binding at the PAR is always established between\n   the on-link\
    \ address the mobile node is using and a new CoA that it\n   can use on the NAR's\
    \ link.  When FA-CoA is used, the on-link address\n   is the MN's home address,\
    \ not the FA-CoA itself, which needs to be\n   bound to the NCoA.  So, when we\
    \ say \"a binding is established between\n   PCoA and NCoA\", it is actually the\
    \ home address of the mobile node\n   that is bound to the NCoA in the FA-CoA\
    \ mode.\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"\
    SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"\
    OPTIONAL\" in this\n   document are to be interpreted as described in [RFC2119].\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   The terminology used in this document in based on [rfc4068]\
    \ and\n   [rfc3344].  We provide some definitions below for convenience.\n   \
    \   Mobile Node (MN): A Mobile IPv4 host.\n      Access Point (AP): A Layer 2\
    \ device connected to an IP subnet that\n      offers wireless connectivity to\
    \ an MN.  An Access Point Identifier\n      (AP-ID) refers to the AP's L2 address.\
    \  Sometimes, AP-ID is also\n      referred to as a Base Station Subsystem ID\
    \ (BSSID).\n      Access Router (AR): The MN's default router.\n      Previous\
    \ Access Router (PAR): The MN's default router prior to its\n      handover.\n\
    \      New Access Router (NAR): The MN's default router subsequent to its\n  \
    \    handover.\n      Previous CoA (PCoA): The IP address of the MN valid on PAR's\n\
    \      subnet.\n      New CoA (NCoA): The MN's Care-of Address valid on NAR's\
    \ subnet.\n      Handover: A process of terminating existing connectivity and\n\
    \      obtaining new IP connectivity.\n      (AP-ID, AR-Info) tuple: Contains\
    \ an access router's L2 and IP\n      addresses, and the prefix valid on the interface\
    \ to which the\n      Access Point (identified by AP-ID) is attached.  The triplet\n\
    \      [Router's L2 address, Router's IP address, Prefix] is called\n      \"\
    AR-Info\".\n"
- title: 3.  Factors Affecting Handover
  contents:
  - "3.  Factors Affecting Handover\n   Both link-layer operations and IP-layer procedures\
    \ affect the\n   perceived handover performance.  However, the overall performance\
    \ is\n   also (always) a function of specific implementation of the technology\n\
    \   as well as the system configuration.  This document only specifies IP\n  \
    \ layer protocol operations.  The purpose of this section is to provide\n   an\
    \ illustration of events that affect handover performance, but it is\n   purely\
    \ informative.\n   The IP-layer handover delay and packet loss are influenced\
    \ by\n   latencies due to movement detection, IP address configuration, and\n\
    \   the Mobile IP registration procedure.  Movement detection latency\n   comes\
    \ from the need to reliably detect movement to a new subnet.\n   This is a function\
    \ of the frequency of router advertisements as well\n   as default agent reachability.\
    \  IP address configuration latency\n   depends on the particular IP CoA being\
    \ used.  If co-located mode with\n   DHCP is used, the latency is quite likely\
    \ going to be higher and\n   potentially unacceptable for real-time applications\
    \ such as Voice\n   over IP.  Finally, the Mobile IP registration procedure introduces\
    \ a\n   round-trip of delay between the Mobile Node and its Home Agent over\n\
    \   the Internet.  This delay is incurred after the mobile node performs\n   movement\
    \ detection and IP configuration.\n   Underlying the IP operations are link-layer\
    \ procedures.  These are\n   technology-specific.  For instance, in IEEE 802.11,\
    \ the handover\n   operation typically involves scanning access points over all\n\
    \   available channels, selecting a suitable access point, and\n   associating\
    \ with it.  It may also involve performing access control\n   operations such\
    \ as those specified in IEEE 802.1X [ieee-802.1x].\n   These delays contribute\
    \ to the handover performance.  See [fh-ccr]\n   and Chapters 20 and 22 in [mi-book].\
    \  Optimizations are being\n   proposed for standardization in IEEE; for instance,\
    \ see\n   [ieee-802.11r] and [ieee-802.21].  Together with appropriate\n   implementation\
    \ techniques, these optimizations can provide the\n   required level of delay\
    \ support at the link-layer for real-time\n   applications.\n"
- title: 4.  Protocol
  contents:
  - '4.  Protocol

    '
- title: 4.1.  Overview
  contents:
  - "4.1.  Overview\n   The design of the protocol is the same as for Mobile IPv6\
    \ [rfc4068].\n   Readers should consult [rfc4068] for details; here we provide\
    \ a\n   summary.\n   The protocol avoids the delay due to movement detection and\
    \ IP\n   configuration and disengages Mobile IP registration delay from the\n\
    \   time-critical path.  The protocol provides the surrounding network\n   neighborhood\
    \ information so that a mobile node can determine whether\n   it is moving to\
    \ a new subnet even before the handover.  The\n   information provided and the\
    \ signaling exchanged between the local\n   mobility agents allow the mobile node\
    \ to send and receive packets\n   immediately after handover.  In order to disengage\
    \ the Mobile IP\n   registration latency, the protocol provides routing support\
    \ for the\n   continued use of a mobile node's previous CoA.\n   After a mobile\
    \ node obtains its IPv4 Care-of Address, it builds a\n   neighborhood access point\
    \ and subnet map using the Router\n   Solicitation for Proxy Advertisement (RtSolPr)\
    \ and Proxy Router\n   Advertisement (PrRtAdv) messages.  The mobile node may\
    \ scan for\n   access points (APs) based on the configuration policy in operation\n\
    \   for its wireless network interface.  If a scan detects a new AP, the\n   mobile\
    \ node resolves the corresponding AP Identifier to subnet\n   information using\
    \ the RtSolPr and PrRtAdv messages mentioned above.\n   At some point, the mobile\
    \ node decides to undergo handover.  It sends\n   a Fast Binding Update (FBU)\
    \ message to PAR from the previous link or\n   from the new link.  An FBU message\
    \ enables creation of a binding\n   between the mobile node's previous CoA and\
    \ the new CoA.\n   The coordination between the access routers is done by way\
    \ of the\n   Handover Initiate (HI) and Handover Acknowledge (HAck) messages\n\
    \   defined in [rfc4068].  After these signals have been exchanged\n   between\
    \ the previous and new access routers (PAR and NAR), data\n   arriving at PAR\
    \ will be tunneled to NAR for delivery to the newly\n   arrived mobile node. \
    \ The purpose of HI is to securely deliver the\n   routing parameters for establishing\
    \ this tunnel.  The tunnel is\n   created by the access routers in response to\
    \ the delivery of the FBU\n   from the mobile node.\n"
- title: 4.2.  Operation
  contents:
  - "4.2.  Operation\n   In response to a handover trigger or indication, the mobile\
    \ node\n   sends a Fast Binding Update message to the Previous Access Router\n\
    \   (PAR) (see Section 5.1).  Depending on the Mobile IP mode of\n   operation,\
    \ the source IP address is either the Home Address (in FA\n   CoA mode) or co-located\
    \ CoA (in CCoA mode).  The FBU message SHOULD\n   (when possible) be sent while\
    \ the mobile node is still connected to\n   PAR.  When sent in this \"predictive\"\
    \ mode, the fields in the FBU MUST\n   be set as follows:\n      The Home Address\
    \ field is either the Home Address or the co-\n      located CoA whenever the\
    \ mobile node has a co-located CoA.\n      The Home Agent field is set to PAR's\
    \ IP address.\n      The Care-of Address field is the NAR's IP address (as discovered\n\
    \      via a PrRtAdv message).\n      The fields in the IP header MUST be set\
    \ as follows:\n      The Destination IP address is PAR's IP address.\n      The\
    \ Source IP address is either the Home Address or the co-located\n      CoA whenever\
    \ the mobile node has a co-located CoA.\n   As a result of processing the FBU,\
    \ PAR creates a binding between the\n   address given by the mobile node in the\
    \ Home Address field and NAR's\n   IP address in its routing table.  The PAR sends\
    \ an FBack message (see\n   Section 5.2) as a response to the mobile node.\n \
    \  The timeline for the predictive mode of operation (adapted from\n   [rfc4068])\
    \ is shown in Figure 1.\n             MN                    PAR              \
    \    NAR\n              |                     |                    |\n       \
    \       |------RtSolPr------->|                    |\n              |<-----PrRtAdv--------|\
    \                    |\n              |                     |                \
    \    |\n              |------FBU----------->|--------HI--------->|\n         \
    \     |                     |<------HAck---------|\n              |          <--FBack---|--FBack--->\
    \         |\n              |                     |                    |\n    \
    \       disconnect             forward                |\n              |     \
    \              packets===============>|\n              |                     |\
    \                    |\n              |                     |                \
    \    |\n          connect                   |                    |\n         \
    \     |                     |                    |\n              |--------- FBU\
    \ --------------------------->|\n              |<===================================\
    \ deliver packets\n              |                     |              (including\
    \ FBack)\n              |                     |<-----FBU-----------|\n       \
    \          Figure 1: Predictive Fast Handover\n   The mobile node sends the FBU,\
    \ regardless of its previous\n   transmission, when attachment to a new link is\
    \ detected.  This\n   minimally allows NAR to detect the mobile node's attachment,\
    \ but also\n   the retransmission of FBU when an FBack has not been received yet.\n\
    \   When sent in this \"reactive\" mode, the Destination IP address in the\n \
    \  IP header MUST be NAR's IP address; the rest of the fields in the FBU\n   are\
    \ the same as in the \"predictive\" case.\n   When NAR receives FBU, it may already\
    \ have processed the HI message\n   and created a host route entry for the mobile\
    \ node, using either the\n   home address or the co-located care-of address as\
    \ provided by PAR.\n   In that case, NAR SHOULD immediately forward arriving and\
    \ buffered\n   packets as well as the FBAck message.  In any case, NAR MUST forward\n\
    \   the contents of the FBU message, starting from the Type field, to\n   PAR;\
    \ the Source and Destination IP addresses in the new packet now\n   contain the\
    \ IP addresses of NAR and PAR, respectively.\n   The reactive mode of operation\
    \ (adapted from [rfc4068]) is\n   illustrated in Figure 2.  Even though the Figure\
    \ does not show the HI\n   and HAck messages illustrated in Figure 1, these messages\
    \ could\n   already have been exchanged (in the case when the PAR has already\n\
    \   processed the FBU sent from the previous link); if not, the PAR sends\n  \
    \ a HI message to the NAR.  The FBack packet is forwarded by the NAR to\n   the\
    \ MN along with the data packets.\n                 MN                    PAR\
    \                  NAR\n                  |                     |            \
    \        |\n                  |------RtSolPr------->|                    |\n \
    \                 |<-----PrRtAdv--------|                    |\n             \
    \     |                     |                    |\n               disconnect\
    \               |                    |\n                  |                  \
    \   |                    |\n                  |                     |        \
    \            |\n               connect                  |                    |\n\
    \                  |-----------FBU-------|------------------->|\n            \
    \      |                     |<-----FBU-----------|\n                  |     \
    \                |------FBack-------->|\n                  |                 \
    \  forward                |\n                  |                   packets===============>|\n\
    \                  |                     |                    |\n            \
    \      |<=================================== deliver packets\n               \
    \   |                                    (including FBack)\n                 \
    \ |                                          |\n                       Figure\
    \ 2: Reactive Fast Handover\n   The Handover Initiate (HI) and Handover Acknowledge\
    \ (HAck) messages\n   serve to establish a bidirectional tunnel between the routers\
    \ to\n   support packet forwarding for PCoA.  The tunnel itself is established\n\
    \   as a response to the FBU message.  The PAR sends the HI message with\n   Code\
    \ = 0 when it receives FBU with source IP address set to PCoA.\n   The PAR sends\
    \ HI with Code = 1 when it receives FBU with source IP\n   address not set to\
    \ PCoA (i.e., when received from NAR).  This allows\n   NAR to disambiguate HI\
    \ message processing sent as a response to\n   predictive and reactive modes of\
    \ operation.  If NAR receives a HI\n   message with Code = 1, and it has already\
    \ set up a host route entry\n   and a reverse tunnel for PCoA, it SHOULD still\
    \ respond with a HAck\n   message, using an appropriate Code value defined in\
    \ Section 5.6.\n   The protocol provides an option for NAR to return NCoA for\
    \ use by the\n   mobile node.  When NAR can provide an NCoA for exclusive use\
    \ of the\n   mobile node, the address is supplied in the HAck message.  The PAR\n\
    \   includes this NCoA in FBack.  Exactly how NAR manages the address\n   pool\
    \ from which it supplies NCoA is not specified in this document.\n   Nevertheless,\
    \ the MN should be prepared to use this address instead\n   of performing DHCP\
    \ or similar operations to obtain an IPv4 address.\n   Even though the mobile\
    \ node can obtain this NCoA from the NAR, it is\n   unaware of the address at\
    \ the time it sends an FBU.  Hence, it binds\n   PCoA to NAR's IP address as before.\n"
- title: 5.  Message Formats
  contents:
  - "5.  Message Formats\n   This section specifies the formats for messages used\
    \ in this\n   protocol.  The Code values below are the same as those in [rfc4068],\n\
    \   and do not require any assignment from IANA.\n"
- title: 5.1.  Fast Binding Update (FBU)
  contents:
  - "5.1.  Fast Binding Update (FBU)\n   The FBU format is bitwise identical to the\
    \ Registration Request\n   format in [rfc3344].  The same destination port number,\
    \ 434, is used,\n   but the FBU and FBAck messages in this specification have\
    \ new message\n   type numbers.\n       0                   1                \
    \   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |x|x|D|M|G|r|T|x| reserved  |     Lifetime      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                          Home Address                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                           Home Agent                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                        Care-of Address                        |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                         Identification                        +\n      |\
    \                                                               |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      | Extensions ...\n      +-+-+-+-+-+-+-+-\n                Figure 3: Fast\
    \ Binding Update (FBU) Message\n      IP Fields:\n         Source address: The\
    \ interface address from which the message is\n         sent.  Either PCoA (co-located\
    \ or Home Address), or NAR's IP\n         address (when forwarded from NAR to\
    \ PAR).\n         Destination Address: The IP address of the Previous Access\n\
    \         Router (PAR) or the New Access Router (NAR).\n         Source Port:\
    \ variable\n         Destination port: 434\n      Message Fields:\n         Type:\
    \ 20\n         Flags: See [rfc3344].  The 'S' and 'B' flags in [rfc3344] are\n\
    \         sent as zero, and ignored on reception.\n         reserved: Sent as\
    \ zero, ignored on reception\n         Lifetime: The number of seconds remaining\
    \ before the binding\n         expires.  This value MUST NOT exceed 10 seconds.\n\
    \         Home Address: MUST be either the co-located CoA or the Home\n      \
    \   Address itself (in FA-CoA mode)\n         Home Agent: The Previous Access\
    \ Router's global IP address\n         Care-of Address: The New Access Router's\
    \ global IP address.\n         Even when a New CoA is provided to the MN (see\
    \ Section 5.4),\n         NAR's IP address MUST be used for this field.\n    \
    \     Identification: a 64-bit number used for matching an FBU with\n        \
    \ FBack.  Identical to usage in [rfc3344]\n         Extensions: MUST contain the\
    \ MN-PAR Authentication Extension\n         (see Section 8)\n   The MN-PAR Authentication\
    \ Extension is the Generalized Mobile IP\n   Authentication Extension in [rfc4721]\
    \ with a new Subtype for MN-PAR\n   Authentication.  The Authenticator field in\
    \ the Generalized Mobile IP\n   Authentication Extension is calculated using a\
    \ shared key between the\n   MN and the PAR.  However, the key distribution itself\
    \ is beyond the\n   scope of this document, and is assumed to be performed by\
    \ other means\n   (for example, using [rfc3957]).\n"
- title: 5.2.  Fast Binding Acknowledgment (FBAck)
  contents:
  - "5.2.  Fast Binding Acknowledgment (FBAck)\n   The FBAck format is bitwise identical\
    \ to the Registration Reply\n   format in [rfc3344].\n       0               \
    \    1                   2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1\
    \ 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |     Code      | reserved  |     Lifetime      |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                          Home Address                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                           Home Agent                          |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                      Identification                        +\n      |      \
    \                                                         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      | Extensions ...\n      +-+-+-+-+-+-+-+-\n              Figure 4: Fast\
    \ Binding Acknowledgment (FBAck)\n      IP Fields:\n         Message Source address:\
    \ Typically copied from the destination\n         address of the FBU message\n\
    \         Destination Address: Copied from the Source IP address in FBU\n    \
    \     message\n         Source Port: variable\n         Destination port: Copied\
    \ from the source port in FBU message\n      Message Fields:\n         Type: 21\n\
    \         Code: Indicates the result of processing FBU message.\n            0:\
    \ FBU Accepted\n            1: FBU Accepted, NCoA supplied\n            128: FBU\
    \ Not Accepted, reason unspecified\n            129: Administratively prohibited\n\
    \            130: Insufficient resources\n         reserved: Sent as zero, ignored\
    \ on reception\n         Lifetime: The granted number of seconds remaining before\n\
    \         binding expires.\n         Home Address: either the co-located CoA or\
    \ the Home Address\n         itself (in FA-Coa mode)\n         Home Agent: The\
    \ Previous Access Router's global IP address\n         Identification: a 64-bit\
    \ number used for matching FBU.  Copied\n         from the field in FBU for which\
    \ this FBack is a reply.\n         Extensions: The MN-PAR Authentication extension\
    \ MUST be present\n         (see Section 8).  In addition, a New IPv4 Address\
    \ Option, with\n         Option-Code 2, MUST be present when NAR supplies the\
    \ NCoA (see\n         Section 6.2).\n"
- title: 5.3.  Router Solicitation for Proxy Advertisement (RtSolPr)
  contents:
  - "5.3.  Router Solicitation for Proxy Advertisement (RtSolPr)\n   Mobile Nodes\
    \ send Router Solicitation for Proxy Advertisement in\n   order to prompt routers\
    \ for Proxy Router Advertisements.  All the\n   link-layer address options have\
    \ the format defined in Section 6.1.\n   The message format and processing rules\
    \ are identical to those\n   defined in [rfc4068].\n      0                  \
    \ 1                   2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |     Code      |          Checksum             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \ Subtype     |   Reserved    |          Identifier           |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |   Options ...\n     +-+-+-+-+-+-+-+-+-+-+-+-\n      Figure 5: Router Solicitation\
    \ for Proxy Advertisement (RtSolPr)\n                                  Message\n\
    \      IP Fields:\n         Source Address: An IP address assigned to the sending\
    \ interface\n         Destination Address: The address of the Access Router or\
    \ the\n         all routers multicast address.\n         Time-to-Live: At least\
    \ 1.  See [rfc1256].\n      ICMP Fields:\n         Type: 41.  See Section 3 in\
    \ [rfc4065].\n         Code: 0\n         Checksum: The 16-bit one's complement\
    \ of the one's complement\n         sum of the ICMP message, starting with the\
    \ ICMP Type.  For\n         computing the checksum, the Checksum and the Reserved\
    \ fields\n         are set to 0.  See [rfc1256].\n         Subtype: 6\n      \
    \   Reserved: MUST be set to zero by the sender and ignored by the\n         receiver.\n\
    \         Identifier: MUST be set by the sender so that replies can be\n     \
    \    matched to this Solicitation.\n      Valid Options:\n         New Access\
    \ Point Link-layer Address: The link-layer address or\n         identification\
    \ of the access point for which the MN requests\n         routing advertisement\
    \ information.  It MUST be included in all\n         RtSolPr messages.  More than\
    \ one such address or identifier can\n         be present.  This field can also\
    \ be a wildcard address (see\n         Section 6.1).\n"
- title: 5.4.  Proxy Router Advertisement (PrRtAdv)
  contents:
  - "5.4.  Proxy Router Advertisement (PrRtAdv)\n   Access routers send out a Proxy\
    \ Router Advertisement message\n   gratuitously if the handover is network-initiated\
    \ or as a response to\n   RtSolPr message from a mobile node, providing the link-layer\
    \ address,\n   IP address, and subnet prefixes of neighboring access routers.\
    \  All\n   the link-layer address options have the format defined in Section\n\
    \   6.1.\n   The message format and processing rules are identical to those\n\
    \   defined in [rfc4068].\n      0                   1                   2   \
    \                3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |     Code      |          Checksum             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \ Subtype     |   Reserved    |          Identifier           |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |   Options ...\n     +-+-+-+-+-+-+-+-+-+-+-+-\n          Figure 6: Proxy\
    \ Router Advertisement (PrRtAdv) Message\n      IP Fields:\n         Source Address:\
    \ An IP address assigned to the sending interface\n         Destination Address:\
    \ The Source Address of an invoking Router\n         Solicitation for Proxy Advertisement\
    \ or the address of the node\n         the Access Router is instructing to handover.\n\
    \         Time-to-Live: At least 1.  See [rfc1256].\n      ICMP Fields:\n    \
    \     Type: 41.  See Section 3 in [rfc4065].\n         Code 0, 1, 2, 3, or 4.\
    \  See below.\n         Checksum: The 16-bit one's complement of the one's complement\n\
    \         sum of the ICMP message, starting with the ICMP Type.  For\n       \
    \  computing the checksum, the Checksum and the Reserved fields\n         are\
    \ set to 0.  See [rfc1256].\n         Subtype: 7\n         Reserved: MUST be set\
    \ to zero by the sender and ignored by the\n         receiver.\n         Identifier:\
    \ Copied from Router Solicitation for Proxy\n         Advertisement or set to\
    \ Zero if unsolicited.\n      Valid Options in the following order:\n        \
    \ New Access Point Link-layer Address: The link-layer address\n         (LLA)\
    \ or identification of the access point.  When there is no\n         wildcard\
    \ in RtSolPr, this is copied from the LLA (for which the\n         router is supplying\
    \ the [AP-ID, AR-Info] tuple) present in\n         RtSolPr.  When a wildcard is\
    \ present in RtSolPr, PAR uses its\n         neighborhood information to populate\
    \ this field.  This option\n         MUST be present.\n         New Router's Link-layer\
    \ Address: The link-layer address of the\n         Access Router for which this\
    \ message is proxied.  This option\n         MUST be included when Code is 0 or\
    \ 1.\n         New Router's IP Address: The IP address of NAR.  This option\n\
    \         MUST be included when Code is 0 or 1.\n         New Router Prefix Information\
    \ Option: The number of leading\n         bits that define the network number\
    \ of the corresponding\n         Router's IP Address option (see above).\n   \
    \      New CoA Option: MAY be present, typically when PrRtAdv is sent\n      \
    \   unsolicited.  PAR MAY compute new CoA by communicating with the\n        \
    \ NAR or by means not specified in this document.  In any case,\n         the\
    \ MN should be prepared to use this address instead of\n         performing DHCP\
    \ or similar operations to obtain an IPv4\n         address.  Even when it uses\
    \ the New CoA provided, the MN MUST\n         bind its current on-link address\
    \ (PCoA) to that of NAR in the\n         FBU message.\n   A PrRtAdv with Code\
    \ 0 means that the MN should use the [AP-ID,\n   AR-Info] tuple present in the\
    \ options above.  In this case, the\n   Option-Code field (see Section 6.1) in\
    \ the New AP LLA option is 1,\n   reflecting the LLA of the access point for which\
    \ the rest of the\n   options are related, and the Option-Code for the New Router's\
    \ LLA\n   option is 3.  Multiple tuples may be present.\n   A PrRtAdv with Code\
    \ 1 means that the message is sent unsolicited.  If\n   a New IPv4 option (see\
    \ Figure 10) is present following the New Router\n   Prefix Information option\
    \ (see Section 6.3), the MN SHOULD use the\n   supplied NCoA and send the FBU\
    \ immediately or else stand to lose\n   service.  This message acts as a network-initiated\
    \ handover trigger.\n   The Option-Code field (see Section 6.1) in the New AP\
    \ LLA option in\n   this case is 1 reflecting the LLA of the access point for\
    \ which the\n   rest of the options are related.\n   A Proxy Router Advertisement\
    \ with Code 2 means that no new router\n   information is present.  The LLA option\
    \ contains an Option-Code value\n   that indicates a specific reason (see Section\
    \ 6.1).\n   A Proxy Router Advertisement with Code 3 means that new router\n \
    \  information is only present for a subset of access points requested.\n   The\
    \ Option-Code values in the LLA option distinguish different\n   outcomes (see\
    \ Section 6.1).\n   A Proxy Router Advertisement with Code 4 means that the subnet\n\
    \   information regarding neighboring access points is sent unsolicited,\n   but\
    \ the message is not a handover trigger, unlike when the message is\n   sent with\
    \ Code 1.  Multiple tuples may be present.\n   When a wildcard AP identifier is\
    \ supplied in the RtSolPr message, the\n   PrRtAdv message should include all\
    \ available [Access Point\n   Identifier, Link-Layer Address option, Prefix Information\
    \ Option]\n   tuples corresponding to the PAR's neighborhood.\n   The New CoA\
    \ option may also be used when the PrRtAdv is sent as a\n   response to a RtSolPr\
    \ message.  However, the solicited RtSolPr and\n   PrRtAdv exchange for neighborhood\
    \ discovery is logically decoupled\n   from the actual handover phase involving\
    \ the FBU and FBack messages\n   (above) as well as HI and HAck messages (see\
    \ below).  This means the\n   access routers have to carefully manage the supplied\
    \ address due to\n   the relative scarcity of addresses in IPv4.\n"
- title: 5.5.  Handover Initiate (HI)
  contents:
  - "5.5.  Handover Initiate (HI)\n   The Handover Initiate (HI) is an ICMP message\
    \ sent by an Access\n   Router (typically PAR) to another Access Router (typically\
    \ NAR) to\n   initiate the process of a mobile node's handover.\n   The message\
    \ format and processing rules are identical to those\n   defined in [rfc4068].\n\
    \      0                   1                   2                   3\n      0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |     Code      |          Checksum             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \ Subtype     |S|U| Reserved  |          Identifier           |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |   Options ...\n     +-+-+-+-+-+-+-+-+-+-+-+-\n                 Figure\
    \ 7:  Handover Initiate (HI) Message\n      IP Fields:\n         Source Address:\
    \ The IP address of the PAR\n         Destination Address: The IP address of the\
    \ NAR\n         Time-to-Live: At least 1.  See [rfc1256].\n      ICMP Fields:\n\
    \         Type: 41.  See Section 3 in [rfc4065].\n         Code: 0 or 1.  See\
    \ below\n         Checksum: The 16-bit one's complement of the one's complement\n\
    \         sum of the ICMP message, starting with the ICMP Type.  For\n       \
    \  computing the checksum, the Checksum and the Reserved fields\n         are\
    \ set to 0.  See [rfc1256].\n         Subtype: 8\n         S: Assigned address\
    \ configuration flag.  When set, this message\n         requests a new CoA to\
    \ be returned by the destination.  May be\n         set when Code = 0.  MUST be\
    \ 0 when Code = 1.\n         U: Buffer flag.  When set, the destination SHOULD\
    \ buffer any\n         packets towards the node indicated in the options of this\n\
    \         message.  Used when Code = 0, SHOULD be set to 0 when Code = 1.\n  \
    \       Reserved: MUST be set to zero by the sender and ignored by the\n     \
    \    receiver.\n         Identifier: MUST be set by the sender so replies can\
    \ be matched\n         to this message.\n      Valid Options:\n         Link-layer\
    \ address of MN: The link-layer address of the MN that\n         is undergoing\
    \ handover to the destination (i.e., NAR).  This\n         option MUST be included\
    \ so that the destination can recognize\n         the MN.\n         Previous Care-of\
    \ Address: The IP address used by the MN while\n         attached to the originating\
    \ router.  This option MUST be\n         included so that a host route can be\
    \ established on the NAR.\n         New Care-of Address: This option MAY be present\
    \ when the MN\n         wishes to use a new IP address when connected to the\n\
    \         destination.  When the 'S' bit is set, NAR MAY provide this\n      \
    \   address in HAck, in which case the MN should be prepared to use\n        \
    \ this address instead of performing DHCP or similar operations\n         to obtain\
    \ an IPv4 address.\n   PAR uses Code = 0 when it processes the FBU received with\
    \ PCoA as\n   source IP address.  PAR uses Code = 1 when the FBU is received with\n\
    \   NAR's IP address as the source IP address.\n"
- title: 5.6.  Handover Acknowledge (HAck)
  contents:
  - "5.6.  Handover Acknowledge (HAck)\n   The Handover Acknowledgment message is\
    \ a new ICMP message that MUST\n   be sent (typically by NAR to PAR) as a reply\
    \ to the Handover Initiate\n   (HI) (see Section 5.5) message.\n   The message\
    \ format and processing rules are identical to those\n   defined in [rfc4068].\n\
    \      0                   1                   2                   3\n      0\
    \ 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |     Code      |          Checksum             |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \ Subtype     |    Reserved   |          Identifier           |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |   Options ...\n     +-+-+-+-+-+-+-+-+-+-+-+-\n                 Figure\
    \ 8:  Handover Acknowledge (HAck) Message\n      IP Fields:\n         Source Address:\
    \ Copied from the destination address of the\n         Handover Initiate Message\
    \ to which this message is a response.\n         Destination Address: Copied from\
    \ the source address of the\n         Handover Initiate Message to which this\
    \ message is a response.\n         Time-to-Live: At least 1.  See [rfc1256].\n\
    \      ICMP Fields:\n         Type: 41.  See Section 3 in [rfc4065].\n       \
    \  Code:\n            0: Handover Accepted\n            1: Handover Accepted,\
    \ NCoA not valid\n            2: Handover Accepted, NCoA in use\n            3:\
    \ Handover Accepted, NCoA assigned (used in Assigned\n               addressing)\n\
    \            4: Handover Accepted, NCoA not assigned\n            128: Handover\
    \ Not Accepted, reason unspecified\n            129: Administratively prohibited\n\
    \            130: Insufficient resources\n         Checksum: The 16-bit one's\
    \ complement of the one's complement\n         sum of the ICMP message, starting\
    \ with the ICMP Type.  For\n         computing the checksum, the Checksum and\
    \ the Reserved fields\n         are set to 0.  See [rfc1256].\n         Subtype:\
    \ 9\n         Reserved: MUST be set to zero by the sender and ignored by the\n\
    \         receiver.\n         Identifier: Copied from the corresponding field\
    \ in the Handover\n         Initiate message this message is in response to.\n\
    \      Valid Options:\n         New Care-of Address: If the 'S' flag in the HI\
    \ message is set,\n         this option MUST be used to provide NCoA the MN should\
    \ use when\n         connected to this router.  This option MAY be included even\n\
    \         when 'S' bit is not set, e.g., Code 2 above.  The MN should be\n   \
    \      prepared to use this address instead of performing DHCP or\n         similar\
    \ operations to obtain an IPv4 address.\n   The Code 0 is the expected average\
    \ case of a handover being accepted\n   and the routing support provided for the\
    \ use of PCoA.  The rest of\n   the Code values pertain to the use of NCoA (which\
    \ is common in\n   [rfc4068]).  Code values 1 and 2 are for cases when the MN\
    \ proposes\n   an NCoA and the NAR provides a response.  Code 3 is when the NAR\n\
    \   provides NCoA (which could be the same as that proposed by the MN).\n   Code\
    \ 4 is when the NAR does not provide NCoA, but instead provides\n   routing support\
    \ for PCoA.\n"
- title: 6.  Option Formats
  contents:
  - "6.  Option Formats\n   The options in this section are specified as extensions\
    \ for the HI\n   and HAck messages, as well as for the PrRtSol and PrRtAdv messages.\n\
    \   The Option-Code values below are the same as those in [rfc4068], and\n   do\
    \ not require any assignment from IANA.\n"
- title: 6.1.  Link-Layer Address Option Format
  contents:
  - "6.1.  Link-Layer Address Option Format\n      0                   1         \
    \          2                   3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8\
    \ 9 0 1 2 3 4 5 6 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |    Length     |  Option-Code  |     LLA ...\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                Figure 9: Link-Layer Address Option Format\n      Fields:\n \
    \        Type: 20\n         Option-Code:\n            0: Wildcard requesting resolution\
    \ for all nearby access\n               points\n            1: Link-Layer Address\
    \ of the New Access Point\n            2: Link-Layer Address of the MN\n     \
    \       3: Link-Layer Address of the NAR\n            4: Link-Layer Address of\
    \ the source of the RtSolPr or\n               PrRtAdv message\n            5:\
    \ The access point identified by the LLA belongs to the\n               current\
    \ interface of the router\n            6: No prefix information available for\
    \ the access point\n               identified by the LLA\n            7: No fast\
    \ handovers support available for the access point\n               identified\
    \ by the LLA\n         Length: The length of the option (including the Type, Length\n\
    \         and Option-Code fields) in units of 8 octets.\n         Link-Layer Address:\
    \ The variable-length link-layer address.\n         The content and format of\
    \ this field (including byte and bit\n         ordering) depends on the specific\
    \ link-layer in use.\n   There is no length field for the LLA itself.  Implementations\
    \ MUST\n   determine the length of the LLA based on the specific link technology\n\
    \   where the protocol is run.  The total size of the LLA option itself\n   MUST\
    \ be a multiple of 8 octets.  Hence, padding may be necessary\n   depending on\
    \ the size of the LLA used.  In such a case, the padN\n   option [rfc2460] MUST\
    \ be used.  As an example, when the LLA is 6\n   bytes (meaning 7 bytes of padding\
    \ is necessary to bring the LLA\n   option length to 2), the padN option will\
    \ have a length field of 5\n   and 5 bytes of zero-valued octets (see [rfc2460]).\n"
- title: 6.2.  New IPv4 Address Option Format
  contents:
  - "6.2.  New IPv4 Address Option Format\n   This option is used to provide the new\
    \ router's IPv4 address or the\n   NCoA in PrRtAdv, as well as PCoA and NCoA in\
    \ HI and HAck messages.\n      0                   1                   2     \
    \              3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6\
    \ 7 8 9 0 1\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |     Type      |    Length     |  Option-Code  |    Reserved   |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |  \
    \                    New IPv4 Address                         |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 10: New IPv4 Address Option Format\n      Fields:\n \
    \        Type: 21\n         Length: The length of the option (including the Type,\
    \ Length\n         and Option-Code fields) in units of 8 octets.\n         Option-Code:\n\
    \            1: Previous CoA\n            2: New CoA\n            3: NAR's IP\
    \ Address\n         Reserved: Set to zero.\n         New IPv4 Address: NAR's IPv4\
    \ address or the NCoA assigned by\n         NAR.\n"
- title: 6.3.  New Router Prefix Information Option
  contents:
  - "6.3.  New Router Prefix Information Option\n   This option is used in the PrRtAdv\
    \ message.\n      0                   1                   2                  \
    \ 3\n      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n \
    \    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n     |\
    \     Type      |    Length     |  Option-Code  | Prefix-Length |\n     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \     |                           Reserved                            |\n    \
    \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n        \
    \  Figure 11: New Router Prefix Information Option Format\n      Fields:\n   \
    \      Type: 22\n         Length: The length of the option (including the Type,\
    \ Length\n         and Option-Code fields) in units of 8 octets.\n         Option-Code:\
    \ 0\n         Prefix-Length The number of leading bits that define the\n     \
    \    network number of the corresponding Router's IP Address option.\n       \
    \  Reserved: Set to zero.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   As outlined in [rfc4068], the following vulnerabilities\
    \ are\n   identified and the solutions mentioned.\n   Insecure FBU:\n   Failure\
    \ to protect the FBU message could result in packets meant for\n   an address\
    \ being stolen or redirected to some unsuspecting node.\n   This concern is similar\
    \ to that in Mobile Node and Home Agent\n   relationship.\n   Hence, the FBU and\
    \ FBack messages MUST be protected using a security\n   association shared between\
    \ a mobile node and its access router.  In\n   particular, the MN-PAR Authentication\
    \ Extension MUST be present in\n   each of these messages.  This document does\
    \ not specify how the\n   security association is established between an MN and\
    \ the AR/FA.\n   Secure FBU, malicious or inadvertent redirection:\n   Even if\
    \ the MN-PAR authentication extension is present in an FBU, an\n   MN may inadvertently\
    \ or maliciously attempt to bind its PCoA to an\n   unintended address on NAR's\
    \ link, and cause traffic flooding to an\n   unsuspecting node.\n   This vulnerability\
    \ is avoided by always binding the PCoA to the NAR's\n   IP address, even when\
    \ the NAR supplies an NCoA to use for the MN.  It\n   is still possible to jam\
    \ NAR's buffer with redirected traffic.\n   However, the handover state corresponding\
    \ to the MN's PCoA has a\n   finite lifetime, and can be configured to be a few\
    \ multiples of the\n   anticipated handover latency.  Hence, the extent of this\n\
    \   vulnerability is small.  It is possible to trace the culprit MN with\n   an\
    \ established security association at the access router.\n   Communication between\
    \ the access routers:\n   The access routers communicate using HI and HAck messages\
    \ in order to\n   establish a temporary routing path for the MN undergoing handover.\n\
    \   This message exchange needs to be secured to ensure routing updates\n   take\
    \ place as intended.\n   The HI and HAck messages need to be secured using a preexisting\n\
    \   security association between the access routers to ensure at least\n   message\
    \ integrity and authentication, and SHOULD also include\n   encryption.  IPsec\
    \ ESP SHOULD be used.\n"
- title: 8.  IANA Considerations
  contents:
  - "8.  IANA Considerations\n   The IANA assignments made for messages, extensions,\
    \ and options\n   specified in this document are described in the following paragraphs.\n\
    \   This document defines two new messages that use the Mobile IPv4\n   control\
    \ message format [rfc3344].  These message details are as\n   follows:\n     \
    \              +------+-------------+-------------+\n                   | Type\
    \ | Description |  Reference  |\n                   +------+-------------+-------------+\n\
    \                   |  20  |     FBU     | Section 5.1 |\n                   |\
    \  21  |    FBAck    | Section 5.2 |\n                   +------+-------------+-------------+\n\
    \   This document defines four new experimental ICMP messages that use\n   the\
    \ ICMP Type 41 for IPv4.  See Section 3 in [rfc4065].  The new\n   messages specified\
    \ in this document have been assigned Subtypes from\n   the registry in [rfc4065]:\n\
    \                  +---------+-------------+-------------+\n                 \
    \ | Subtype | Description |  Reference  |\n                  +---------+-------------+-------------+\n\
    \                  |    6    |   RtSolPr   | Section 5.3 |\n                 \
    \ |    7    |   PrRtAdv   | Section 5.4 |\n                  |    8    |     \
    \ HI     | Section 5.5 |\n                  |    9    |     HAck    | Section\
    \ 5.6 |\n                  +---------+-------------+-------------+\n   This document\
    \ defines three new options that have been assigned Types\n   from the Mobile\
    \ IP Extensions for ICMP Router Discovery messages\n   [rfc3344].  These options\
    \ are as follows:\n                 +------+------------------+-------------+\n\
    \                 | Type |    Description   |  Reference  |\n                \
    \ +------+------------------+-------------+\n                 |  20  |       \
    \ LLA       | Section 6.1 |\n                 |  21  | New IPv4 Address | Section\
    \ 6.2 |\n                 |  22  |  NAR Prefix Info | Section 6.3 |\n        \
    \         +------+------------------+-------------+\n   The MN-PAR Authentication\
    \ Extension described in Sections 5.1 and 5.2\n   is a Generalized Mobile IP Authentication\
    \ Extension defined in\n   Section 5 of [rfc4721].  The MN-PAR Authentication\
    \ has been assigned\n   a Subtype from the registry specified in [rfc4721].  The\
    \ Extension\n   details are as follows:\n      +---------+-----------------------+--------------------------+\n\
    \      | Subtype |      Description      |         Reference        |\n      +---------+-----------------------+--------------------------+\n\
    \      |    4    | MN-PAR Auth Extension |        Section 5.1       |\n      +---------+-----------------------+--------------------------+\n"
- title: 9.  Acknowledgments
  contents:
  - "9.  Acknowledgments\n   Thanks to all those who expressed interest in having\
    \ a Fast Handovers\n   for Mobile IPv4 protocol along the lines of [rfc4068].\
    \  Thanks to\n   Vijay Devarapalli, Kent Leung, and Domagoj Premec for their review\n\
    \   and input.  Kumar Viswanath and Uday Mohan implemented an early\n   version\
    \ of this protocol.  Many thanks to Alex Petrescu for his\n   thorough review\
    \ that improved this document.  Thanks to Pete McCann\n   for the proofreading,\
    \ and to Jari Arkko for the review, which have\n   helped improve this document.\
    \  Thanks to Francis Dupont and Hannes\n   Tschofenig for the GEN-ART and TSV-DIR\
    \ reviews.\n   Sending FBU from the new link (i.e., reactive mode) is similar\
    \ to\n   using the extension defined in [mip4-ro]; however, this document also\n\
    \   addresses movement detection and router discovery latencies.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [RFC2119]      Bradner, S., \"Key words for use\
    \ in RFCs to Indicate\n                  Requirement Levels\", BCP 14, RFC 2119,\
    \ March 1997.\n   [rfc1256]      Deering, S., Ed., \"ICMP Router Discovery Messages\"\
    ,\n                  RFC 1256, September 1991.\n   [rfc2460]      Deering, S.\
    \ and R. Hinden, \"Internet Protocol, Version\n                  6 (IPv6) Specification\"\
    , RFC 2460, December 1998.\n   [rfc3344]      Perkins, C., Ed., \"IP Mobility\
    \ Support for IPv4\", RFC\n                  3344, August 2002.\n   [rfc4065]\
    \      Kempf, J., \"Instructions for Seamoby and Experimental\n              \
    \    Mobility Protocol IANA Allocations\", RFC 4065, July\n                  2005.\n\
    \   [rfc4068]      Koodli, R., Ed., \"Fast Handovers for Mobile IPv6\", RFC\n\
    \                  4068, July 2005.\n   [rfc4721]      Perkins, C., Calhoun, P.,\
    \ and J. Bharatia, \"Mobile\n                  IPv4 Challenge/Response Extensions\
    \ (Revised)\", RFC\n                  4721, January 2007.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [fh-ccr]       R. Koodli and C. E. Perkins,\
    \ \"Fast Handovers and\n                  Context Transfers in Mobile Networks\"\
    , ACM Computer\n                  Communications Review Special Issue on Wireless\n\
    \                  Extensions to the Internet, October 2001.\n   [ieee-802.11r]\
    \ IEEE, \"IEEE Standard for Local and Metropolitan Area\n                  Networks:\
    \  Fast Roaming/Fast BSS Transition, IEEE Std\n                  802.11r\", September\
    \ 2006.\n   [ieee-802.1x]  IEEE, \"IEEE Standards for Local and Metropolitan Area\n\
    \                  Networks: Port-based Network Access Control, IEEE Std\n   \
    \               802.1X-2001\", June 2001.\n   [ieee-802.21]  The IEEE 802.21 group,\
    \ http://www.ieee802.org/21.\n   [mi-book]      R. Koodli and C. E. Perkins, \"\
    Mobile Internetworking\n                  with IPv6: Concepts, Principles and\
    \ Practices\", John\n                  Wiley & Sons, June 2007.\n   [mip4-ro]\
    \      Perkins, C. and D. Johnson, \"Route Optimization in\n                 \
    \ Mobile IP\", Work in Progress, September 2001.\n   [rfc2131]      Droms, R.,\
    \ \"Dynamic Host Configuration Protocol\", RFC\n                  2131, March\
    \ 1997.\n   [rfc3957]      Perkins, C. and P. Calhoun, \"Authentication,\n   \
    \               Authorization, and Accounting (AAA) Registration Keys\n      \
    \            for Mobile IPv4\", RFC 3957, March 2005.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Rajeev Koodli\n   Nokia Siemens Networks\n   313 Fairchild\
    \ Driive\n   Mountain View, CA 94043\n   USA\n   EMail: rajeev.koodli@nokia.com\n\
    \   Charles Perkins\n   Nokia Siemens Networks\n   313 Fairchild Driive\n   Mountain\
    \ View, CA 94043\n   USA\n   EMail: charles.perkins@nokia.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2007).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
