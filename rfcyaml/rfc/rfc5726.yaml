- title: __initial_text__
  contents:
  - ''
- title: Internet Research Task Force (IRTF)                               Y. Qiu
  contents:
  - "Internet Research Task Force (IRTF)                               Y. Qiu\n  \
    \               Mobile IPv6 Location Privacy Solutions\n"
- title: Abstract
  contents:
  - "Abstract\n   Mobile IPv6 (RFC 3775) enables a mobile node to remain reachable\n\
    \   while it roams on the Internet.  However, the location and movement\n   of\
    \ the mobile node can be revealed by the IP addresses used in\n   signaling or\
    \ data packets.  In this document, we consider the Mobile\n   IPv6 location privacy\
    \ problem described in RFC 4882, and propose\n   efficient and secure techniques\
    \ to protect location privacy of the\n   mobile node.  This document is a product\
    \ of the IP Mobility\n   Optimizations (MobOpts) Research Group.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for examination, experimental implementation, and\n   evaluation.\n\
    \   This document defines an Experimental Protocol for the Internet\n   community.\
    \  This document is a product of the Internet Research Task\n   Force (IRTF).\
    \  The IRTF publishes the results of Internet-related\n   research and development\
    \ activities.  These results might not be\n   suitable for deployment.  This RFC\
    \ represents the consensus of the IP\n   Mobility Optimizations Research Group\
    \ of the Internet Research Task\n   Force (IRTF).  Documents approved for publication\
    \ by the IRSG are not\n   a candidate for any level of Internet Standard; see\
    \ Section 2 of RFC\n   5741.\n   Information about the current status of this\
    \ document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc5726.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2010 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................5\n\
    \   2. Conventions and Terminology .....................................6\n  \
    \    2.1. Conventions ................................................6\n    \
    \  2.2. Terminology ................................................6\n   3. Requirements\
    \ ....................................................8\n   4. Solution Overview\
    \ ...............................................9\n   5. Reverse-Tunneled Correspondent\
    \ Binding Update ..................11\n      5.1. The Procedure .............................................12\n\
    \      5.2. Route-Optimized Payload Packets ...........................14\n  \
    \    5.3. Mobile Node Operation .....................................15\n    \
    \       5.3.1. Conceptual Data Structures .........................15\n      \
    \     5.3.2. Reverse-Tunneled Correspondent Binding\n                  Update\
    \ to the Correspondent Node ...................15\n           5.3.3. Reverse-Tunneled\
    \ Correspondent Binding\n                  Acknowledgement from the Correspondent\
    \ Node ........16\n           5.3.4. Route-Optimized Payload Packets ....................16\n\
    \           5.3.5. Receiving ICMP Error Message .......................17\n  \
    \         5.3.6. Binding Error from the Correspondent Node ..........17\n    \
    \       5.3.7. Binding Refresh Request from the\n                  Correspondent\
    \ Node .................................17\n      5.4. Home Agent Operation ......................................17\n\
    \      5.5. Correspondent Node Operation ..............................18\n  \
    \         5.5.1. Conceptual Data Structures .........................18\n    \
    \       5.5.2. Reverse-Tunneled Correspondent Binding\n                  Update\
    \ from the Mobile Node ........................18\n           5.5.3. Reverse-tunneled\
    \ Correspondent Binding\n                  Acknowledgement to the Mobile Node\
    \ .................18\n           5.5.4. Route-Optimized Payload Packets ....................18\n\
    \           5.5.5. ICMP Error Message to the Mobile Node ..............19\n  \
    \         5.5.6. Binding Error to the Mobile Node ...................19\n    \
    \       5.5.7. Binding Refresh Request to the Mobile Node .........19\n      5.6.\
    \ Summary ...................................................20\n   6. IP Address\
    \ Location Privacy Solution Using the Pseudo\n      Home Address ...................................................20\n\
    \      6.1. Home Binding Update .......................................20\n  \
    \         6.1.1. Pseudo Home Address Registration ...................20\n    \
    \       6.1.2. Home De-Registration ...............................21\n      6.2.\
    \ Correspondent Binding Update Using the Pseudo Home\n           Address ...................................................22\n\
    \           6.2.1. Return Routability Procedure .......................22\n  \
    \         6.2.2. Route-Optimized Correspondent Binding Update .......24\n    \
    \       6.2.3. Reverse-tunneled Correspondent Binding Update ......25\n      \
    \     6.2.4. Using Different Pseudo Home Addresses with\n                  Different\
    \ Correspondent Nodes ......................25\n      6.3. Payload Packets ...........................................25\n\
    \           6.3.1. Reverse Tunneling Mode .............................25\n  \
    \         6.3.2. Route Optimization Mode ............................26\n    \
    \  6.4. Prefix Discovery ..........................................26\n      6.5.\
    \ Mobile Node Operation .....................................26\n           6.5.1.\
    \ Conceptual Data Structures .........................26\n           6.5.2. Binding\
    \ Update to the Home Agent ...................27\n           6.5.3. Binding Acknowledgement\
    \ from the Home Agent ........27\n           6.5.4. Home Test Init to the Home\
    \ Agent ...................28\n           6.5.5. Home Test from the Home Agent\
    \ ......................28\n           6.5.6. Route-Optimized Payload Packets\
    \ ....................29\n           6.5.7. Receiving Binding Refresh Request\
    \ ..................29\n      6.6. Home Agent Operation ......................................29\n\
    \           6.6.1. Conceptual Data Structures .........................30\n  \
    \         6.6.2. Binding Update from the Mobile Node ................30\n    \
    \       6.6.3. Binding Acknowledgement to the Mobile Node .........31\n      \
    \     6.6.4. Home Test Init from the Mobile Node ................31\n        \
    \   6.6.5. Home Test to the Mobile Node .......................32\n      6.7.\
    \ Correspondent Node Operation ..............................32\n   7. Extensions\
    \ to Mobile IPv6 ......................................32\n      7.1. Encrypted\
    \ Home Address Destination Option .................32\n      7.2. Encrypted Home\
    \ Address Routing Header .....................33\n      7.3. Pseudo Home Address\
    \ Mobility Option .......................34\n      7.4. Pseudo Home Address Acknowledgement\
    \ Mobility Option .......35\n   8. Security Considerations ........................................37\n\
    \      8.1. Home Binding Update .......................................37\n  \
    \    8.2. Correspondent Binding Update ..............................38\n    \
    \  8.3. Route-Optimized Payload Packets ...........................38\n   9. Related\
    \ Work ...................................................39\n   10. IANA Considerations\
    \ ...........................................40\n   11. Conclusion ....................................................40\n\
    \   12. Acknowledgements ..............................................41\n  \
    \ 13. References ....................................................41\n    \
    \  13.1. Normative References .....................................41\n      13.2.\
    \ Informative References ...................................42\n   Appendix A.\
    \ Profiling Attack: Discussion ..........................44\n     A.1. The Care-of\
    \ Address ........................................44\n     A.2. Profiling on the\
    \ Encrypted Home Address ....................44\n     A.3. The IPsec SPI ..............................................45\n\
    \     A.4. The IPsec Sequence Number ..................................45\n  \
    \   A.5. The Regular Interval of Signaling Messages..................46\n    \
    \ A.6. The Sequence Number in the Binding Update Message ..........46\n     A.7.\
    \ Multiple Concurrent Sessions ...............................46\n     A.8. Summary\
    \ ....................................................47\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The IP address location privacy problem is concerned with\
    \ unwittingly\n   revealing the current location of a mobile node to eavesdroppers\
    \ and\n   to communicating parties.  In the presence of mobility as specified\n\
    \   in Mobile IPv6 [6], there are two related problems: disclosing the\n   care-of\
    \ address to a correspondent node, and revealing the home\n   address to an eavesdropper\
    \ (please see the terminology below).  A\n   detailed description of the location\
    \ privacy problem can be found in\n   RFC 4882 [11].  This document assumes that\
    \ the reader is familiar\n   with the basic operation of Mobile IPv6 specified\
    \ in RFC 3775, as\n   well as the location privacy problem described in RFC 4882.\n\
    \   In order to protect location privacy, a mobile node must not disclose\n  \
    \ the binding between its care-of address and its home address.  In\n   this document,\
    \ we propose a set of extensions to the Mobile IPv6\n   specification to address\
    \ the IP address location privacy problem.\n   Related to the IP address location\
    \ privacy is \"profiling\", where the\n   activities of a mobile node are linked\
    \ and then analyzed.  Profiled\n   activities may contribute to compromising a\
    \ mobile node's location\n   privacy, especially when combined with additional\
    \ information.\n   Furthermore, once location privacy is compromised, it may lead\
    \ to\n   more targeted profiling.  Solutions to thwart profiling are\n   important;\
    \ however, they are not central to this document.  We\n   discuss profiling in\
    \ the appendix.\n   We propose two IP address location privacy solutions in this\n\
    \   document.  With the first solution (as described in Section 5), the\n   mobile\
    \ node can communicate with the correspondent node by using the\n   real home\
    \ address without location privacy being breached by\n   eavesdroppers.  This\
    \ is done by using parameters generated during the\n   return routability procedure\
    \ to mask the real home address, which\n   provides an evolution towards location\
    \ privacy protection based on\n   return routability messages already specified\
    \ in RFC 3775.  With the\n   second solution (as described in Section 6), an IPsec\
    \ tunnel mode\n   security association with a non-null encryption algorithm is\n\
    \   negotiated to encrypt signaling messages (including the real home\n   address\
    \ therein) exchanged between the mobile node and the home\n   agent, for example,\
    \ during the home binding update procedure.\n   Furthermore, during the return\
    \ routability procedure and the\n   correspondent binding update procedure, a\
    \ \"pseudo home address\" (the\n   definition of this new term and many other\
    \ commonly used mobility\n   related terms is provided in Section 2) is used to\
    \ replace the real\n   home address in various messages, which allows the mobile\
    \ node to\n   hide its real home address from both the correspondent node and\n\
    \   eavesdroppers without the need for additional extensions to the\n   correspondent\
    \ node.  Moreover, the mobile node may mask the pseudo\n   home address by using\
    \ the mechanism specified in Section 5 to further\n   enhance location privacy\
    \ protection.  Each of these two solutions can\n   be implemented on its own without\
    \ relying on the other.\n   The solutions presented in this document are designed\
    \ based on the\n   following assumptions.  First, we focus on location privacy\
    \ issues\n   arising when the mobile node attaches to a foreign link; location\n\
    \   privacy issues when the mobile node attaches to its home link, if\n   any,\
    \ are outside the scope of this document.  Second, we assume that\n   IPsec [2]\
    \ is used to secure mobility signaling messages exchanged\n   between the mobile\
    \ node and the home agent; therefore, location\n   privacy solutions when other\
    \ security mechanisms are used are beyond\n   the scope of this document.  Third,\
    \ we assume that eavesdroppers are\n   passive attackers, e.g., an eavesdropper\
    \ along the path traversed by\n   traffic flows from or to the mobile node.  We\
    \ make this assumption\n   because messages generated by active attackers can\
    \ either be\n   discarded based on local policy at a mobile node or the mobile\
    \ node\n   could choose to treat such messages like those of any other\n   correspondent\
    \ nodes.  Thus, specific threats to location privacy\n   posed by active attackers\
    \ are also beyond the scope of this document.\n   Fourth, in order to simplify\
    \ analysis, we assume that both the\n   correspondent node and the home agent\
    \ are fixed nodes; if either is\n   mobile, the same analysis and solutions for\
    \ the mobile node may also\n   apply.  Finally, the same solution applies to each\
    \ of the care-of\n   addresses if a mobile node maintains more than one care-of\
    \ address.\n   This document represents the consensus of the MobOpts Research\
    \ Group.\n   It has been reviewed by the Research Group members active in the\n\
    \   specific area of work.  At the request of their chairs, this document\n  \
    \ has been comprehensively reviewed by multiple active contributors to\n   the\
    \ IETF Mobile IP related working groups.\n"
- title: 2.  Conventions and Terminology
  contents:
  - '2.  Conventions and Terminology

    '
- title: 2.1.  Conventions
  contents:
  - "2.1.  Conventions\n   The keywords \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\"\
    , \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and\
    \ \"OPTIONAL\" in this\n   document are to be interpreted as described in RFC\
    \ 2119 [1].\n"
- title: 2.2.  Terminology
  contents:
  - "2.2.  Terminology\n   In this document, we introduce two new terms, \"pseudo\
    \ home address\"\n   and \"encrypted home address\".  The definition of these\
    \ two terms is\n   provided in the following.\n   o  Pseudo Home Address (pHoA):\
    \ A unicast IPv6 address formed to\n      replace the real home address used in\
    \ certain Mobile IPv6\n      signaling or data packets.  Without explicit indication,\
    \ the\n      pseudo home address looks like a regular IPv6 address [5].\n   o\
    \  Encrypted Home Address (eHoA): The output when applying an\n      encryption\
    \ algorithm to the real home address or the pseudo home\n      address with additional\
    \ inputs, e.g., a key.  The real home\n      address can be recovered from the\
    \ encrypted home address by using\n      a decryption algorithm.\n   In addition,\
    \ we use commonly adopted mobility-related terms as\n   defined in [6] and [11]\
    \ throughout this document.  Some of these\n   terms are provided below for easier\
    \ reference.  Nevertheless, we\n   assume that readers are familiar with the basic\
    \ operation of the\n   Mobile IPv6 protocol as defined in RFC 3775 [6], RFC 3776\
    \ [7], and\n   RFC 4877 [8].\n   o  Mobile Node (MN): A Mobile IPv6 compliant\
    \ mobile node that can\n      roam on the Internet\n   o  Correspondent Node (CN):\
    \ An IPv6 node that communicates with the\n      mobile node\n   o  Home Network:\
    \ The network where the mobile node is normally\n      present when it is not\
    \ roaming\n   o  Visited Network: The network that the mobile node uses to access\n\
    \      the Internet when it is roaming\n   o  Home Agent (HA): A router on the\
    \ mobile node's home network that\n      provides forwarding support when the\
    \ mobile node is roaming\n   o  Home Address (HoA): The mobile node's unicast\
    \ IP address valid on\n      its home network\n   o  Care-of Address (CoA): The\
    \ mobile node's unicast IP address valid\n      on the visited network\n   o \
    \ Return Routability (RR): A procedure which enables secure binding\n      between\
    \ the care-of address and the home address when no pre-\n      existing security\
    \ association exists between the mobile node and\n      the correspondent node\n\
    \   o  Home Test Init (HoTI) / Home Test (HoT) / Care-of Test Init (CoTI)\n  \
    \    / Care-of Test (CoT): Messages used during the return routability\n     \
    \ procedure\n   o  Binding Update (BU): A message used by the mobile node to securely\n\
    \      bind its care-of address to its home address at the correspondent\n   \
    \   node or the home agent\n   o  Binding Acknowledgement (BA): A response to\
    \ the Binding Update\n   o  Message Authentication Code (MAC): The value, which\
    \ is computed\n      using HMAC_SHA1 in this document, that protects both a message's\n\
    \      integrity and its authenticity\n   o  Route Optimization: A mechanism that\
    \ allows direct routing of\n      packets between a roaming mobile node and its\
    \ correspondent node,\n      without having to traverse the home network\n   o\
    \  Reverse Tunneling or Bidirectional Tunneling: A mechanism used for\n      packet\
    \ forwarding between a roaming mobile node and its\n      correspondent node via\
    \ its home agent\n"
- title: 3.  Requirements
  contents:
  - "3.  Requirements\n   In this section, we describe the requirements that should\
    \ be met by\n   the Mobile IPv6 location privacy solutions, hereafter referred\
    \ to as\n   \"the solution\".  These are some of the basic requirements set forth\n\
    \   in order to make the solution readily implementable by those familiar\n  \
    \ with Mobile IPv6 and the related security protocols used with it\n   (such as\
    \ IKEv2 [4] and IPsec).\n   R01: The solution must follow the framework and architecture\
    \ of IPv6\n        and Mobile IPv6 (as specified in RFC 3775, RFC 3776, and RFC\n\
    \        4877).\n   R02: The solution must not interfere with the operation of\
    \ IPsec.\n        This means that the principles and the operation specified in\n\
    \        RFC 3776 and RFC 4877 need to be followed.  For example, the\n      \
    \  IPsec security association and policy must be identified by the\n        real\
    \ home address.\n   R03: The solution should provide back-compatibility in order\
    \ for\n        different Mobile IPv6 entities to work together even though they\n\
    \        may have different capabilities.  This requires the mobile node\n   \
    \     to be able to detect whether the home agent or the correspondent\n     \
    \   node supports the use of the location privacy solutions.\n   R04: The overhead\
    \ resulting from the solution, in terms of payloads\n        or messages transmitted\
    \ and memory, should be kept minimal.\n"
- title: 4.  Solution Overview
  contents:
  - "4.  Solution Overview\n   The IP address location privacy solutions proposed\
    \ in this document\n   intend to conceal the binding between the mobile node's\
    \ real home\n   address and its care-of address from eavesdroppers and the\n \
    \  correspondent node.  In this section, we present an overview of the\n   proposed\
    \ solutions.\n   With the Mobile IPv6 specification, during the home binding update\n\
    \   procedure, both the real home address and the care-of address are in\n   the\
    \ cleartext when either the IPsec tunnel mode or the IPsec\n   transport mode\
    \ is used with no encryption.  As described in\n   Section 6.1, the solution to\
    \ prevent the real home address being\n   leaked to eavesdroppers on the MN-HA\
    \ path during the home binding\n   update procedure is to set up an IPsec tunnel\
    \ mode security\n   association with a non-null encryption algorithm to encrypt\
    \ home\n   binding signaling messages and the real home address therein.  This\n\
    \   method is also used to enable location privacy protection during\n   other\
    \ mobility signaling message exchanges between the home agent and\n   the mobile\
    \ node, such as the prefix discovery procedure (see\n   Section 6.4).\n   When\
    \ communicating with the correspondent node with the reverse\n   tunneling mode,\
    \ the mobile node can hide its current location from\n   the correspondent node\
    \ and eavesdroppers along the HA-CN path, since\n   the care-of address is not\
    \ included in payload packets transmitted on\n   that path.  Also, an IPsec security\
    \ association with a non-null\n   encryption algorithm established between the\
    \ mobile node and the home\n   agent can conceal the real home address carried\
    \ in payload packets\n   from eavesdroppers along the MN-HA path.\n   In order\
    \ to communicate with a correspondent node in the route\n   optimization mode,\
    \ the mobile node needs to perform the return\n   routability procedure followed\
    \ by the correspondent binding update\n   procedure.  With the current Mobile\
    \ IPv6 specification, the real home\n   address and the care-of address in the\
    \ correspondent Binding Update\n   message and payload packets are visible to\
    \ eavesdroppers.  Therefore,\n   in order to send and receive packets through\
    \ the optimized route and\n   protect location privacy at the same time, the mobile\
    \ node needs to\n   disclose its care-of address and conceal its real home address.\n\
    \   There are two different scenarios and we propose a different solution\n  \
    \ for each scenario.\n   One scenario is that the correspondent node is able to\
    \ obtain the\n   mobile node's real home address and initiates communication with\
    \ the\n   mobile node by using the real home address.  In this case, the mobile\n\
    \   node needs to continue to use the real home address with the\n   correspondent\
    \ node in order to maintain session continuity, and to\n   conceal the real home\
    \ address from eavesdroppers.  The solution for\n   this scenario (hereinafter\
    \ referred to as \"reverse-tunneled\n   correspondent binding update\") is described\
    \ in Section 5.  With this\n   solution, the mobile node exchanges the same return\
    \ routability\n   signaling messages as defined in RFC 3775 with the correspondent\
    \ node\n   and then derives a privacy management key from keygen tokens and uses\n\
    \   this key to encrypt the real home address.  Finally, it reverse-\n   tunnels\
    \ an extended correspondent Binding Update message via the home\n   agent to register\
    \ the encrypted home address and the real home\n   address at the correspondent\
    \ node.  After the correspondent\n   registration, the mobile node and the correspondent\
    \ node use the\n   registered encrypted home address, instead of the real home\
    \ address\n   in payload packets exchanged via the optimized route.  The encrypted\n\
    \   home address is different for different correspondent nodes since the\n  \
    \ privacy management key would be different.\n   The other scenario is that the\
    \ mobile node prefers to conceal its\n   real home address from both the correspondent\
    \ node and the\n   eavesdroppers (typically the mobile node initiates communication\
    \ in\n   this case, since the correspondent node does not know the real home\n\
    \   address).  The solution for this scenario is described in\n   Section 6.2.\
    \  With this solution, the mobile node first obtains a\n   home keygen token generated\
    \ based on the pseudo home address during\n   the home address test procedure.\
    \  Subsequently, the mobile node sends\n   the correspondent Binding Update message\
    \ to register the binding\n   between the pseudo home address and the care-of\
    \ address at the\n   correspondent node via the optimized route.  After the correspondent\n\
    \   registration, the mobile node and the correspondent node use the\n   registered\
    \ pseudo home address, instead of the real home address, in\n   payload packets\
    \ exchanged via the optimized route.  Note that the use\n   of the pseudo home\
    \ address is completely transparent to the\n   correspondent node.\n   Furthermore,\
    \ it is feasible to throttle \"profiling\" on the pseudo\n   home address by using\
    \ a combination of these two solutions.  That is,\n   the mobile node uses the\
    \ pseudo home address in the extended home\n   address test procedure to obtain\
    \ a home keygen token; then, it uses\n   the pseudo home address instead of the\
    \ real home address in the\n   reverse-tunneled correspondent binding update procedure.\
    \  With this\n   solution, the encrypted pseudo home address used in route optimized\n\
    \   payload packets looks different to eavesdroppers each time, after a\n   new\
    \ round of the return routability procedure is completed.\n   Before a pseudo\
    \ home address is used with a correspondent node, it\n   MUST be registered with\
    \ the home agent during the home registration\n   procedure.  The mobile node\
    \ indicates the requested pseudo home\n   address in a new mobility option, called\
    \ the Pseudo Home Address\n   option (see Section 7.3), carried in the home Binding\
    \ Update message,\n   and the home agent indicates the status of pseudo home address\n\
    \   registration in another new mobility option, called Pseudo Home\n   Address\
    \ Acknowledgement option (see Section 7.4), carried in the home\n   Binding Acknowledgement\
    \ message.  The pseudo home address MUST be\n   routable in order for the home\
    \ agent to intercept packets destined at\n   this pseudo home address.  It is\
    \ statistically difficult for other\n   nodes to derive the real home address\
    \ from the pseudo home address.\n   A detailed description of pseudo home address\
    \ generation is provided\n   in Section 6.1.1.1.\n   With extensions introduced\
    \ in this document, a mobile node is able to\n   discover whether the home agent\
    \ and the correspondent node support\n   the location privacy solutions or not.\
    \  When present in the home\n   Binding Update message, the Pseudo Home Address\
    \ mobility option\n   indicates that the mobile node requests the use of the location\n\
    \   privacy solutions.  If such a Binding Update message is valid and the\n  \
    \ home agent supports the location privacy solutions for this\n   particular mobile\
    \ node, it responds with the Pseudo Home Address\n   Acknowledgement mobility\
    \ option in the Binding Acknowledgement\n   message.  Otherwise, if the home agent\
    \ does not support the location\n   privacy solutions, it does not include the\
    \ Pseudo Home Address\n   Acknowledgement mobility option in the Binding Acknowledgement\n\
    \   message.  Similarly, the presence of the Encrypted Home Address\n   destination\
    \ option in the correspondent Binding Update message\n   indicates to the correspondent\
    \ node that the mobile node requests the\n   use of the location privacy solutions.\
    \  If such a Binding Update\n   message is valid and the correspondent node supports\
    \ the location\n   privacy solutions for this particular mobile node, it responds\
    \ with\n   the Encrypted Home Address routing header in the correspondent\n  \
    \ Binding Acknowledgement message to the mobile node.  If the\n   correspondent\
    \ node does not support the location privacy solutions,\n   it rejects the mobile\
    \ node's request by returning an ICMP Parameter\n   Problem message with Code\
    \ value set to 2.  Furthermore, a home agent\n   that recognizes such extensions\
    \ but does not wish to provide location\n   privacy protection MAY redirect the\
    \ mobile node to another home\n   agent.  If the request for using the location\
    \ privacy solutions is\n   rejected, the mobile node may either proceed without\
    \ location privacy\n   protection, or try with a different home agent or a correspondent\n\
    \   node, or abort the operation.\n"
- title: 5.  Reverse-Tunneled Correspondent Binding Update
  contents:
  - "5.  Reverse-Tunneled Correspondent Binding Update\n   In this section, we describe\
    \ a solution that protects location\n   privacy against eavesdroppers when the\
    \ mobile node uses the real home\n   address during communication with the correspondent\
    \ node via the\n   optimized route.  Note that this solution does not require\
    \ any change\n   to return routability signaling messages.  The detailed description\n\
    \   is as follows.\n"
- title: 5.1.  The Procedure
  contents:
  - "5.1.  The Procedure\n   After the return routability procedure is completed,\
    \ if the mobile\n   node needs to protect location privacy, and at the same time\
    \ still\n   uses the real home address with the correspondent node, the mobile\n\
    \   node derives a privacy management key, Kpm, from the Kbm, where Kpm =\n  \
    \ HMAC_SHA1 (Kbm, 0).  The mobile node uses Kpm to generate the\n   encrypted\
    \ home address as follows.\n      encrypted home address = Enc(Kpm, the home address)\n\
    \      Where Enc() is a symmetric key encryption algorithm.  AES is the\n    \
    \  default encryption algorithm.\n   Kpm changes upon every change of Kbm, which\
    \ itself changes when\n   return routability is run (e.g., upon change of care-of\
    \ address,\n   expiry of keygen token, etc.).  So, Kpm is not re-used when a care-of\n\
    \   address changes.\n   The mobile node generates a correspondent Binding Update\
    \ message and\n   reverse-tunnels this message to the correspondent node via the\
    \ home\n   agent.  The format of this message after encapsulation is:\n      \
    \ IPv6 header (source = care-of address,\n                    destination = home\
    \ agent)\n       ESP header in tunnel mode\n       IPv6 header (source = home\
    \ address,\n                    destination = correspondent node)\n       Destination\
    \ option header\n           Encrypted Home Address option (encrypted home address)\n\
    \       Parameters:\n           Alternative Care-of Address option (care-of address)\n\
    \           sequence number (within the Binding Update message header)\n     \
    \      home nonce index (within the Nonce Indices option)\n           care-of\
    \ nonce index (within the Nonce Indices option)\n           First (96, HMAC_SHA1\
    \ (Kbm, (care-of address | correspondent\n               | BU)))\n   This packet\
    \ is protected by the IPsec security association with a\n   non-null encryption\
    \ algorithm.  If the home agent can process this\n   packet successfully, it forwards\
    \ the following packet to the\n   correspondent node.\n       IPv6 header (source\
    \ = home address,\n                    destination = correspondent node)\n   \
    \    Destination option header\n           Encrypted Home Address option (encrypted\
    \ home address)\n       Parameters:\n           Alternative Care-of Address option\
    \ (care-of address)\n           sequence number (within the Binding Update message\
    \ header)\n           home nonce index (within the Nonce Indices option)\n   \
    \        care-of nonce index (within the Nonce Indices option)\n           First\
    \ (96, HMAC_SHA1 (Kbm, (care-of address | correspondent\n               | BU)))\n\
    \   After receiving a reverse-tunneled correspondent Binding Update\n   message,\
    \ the correspondent node performs the operation as described\n   in Section 5.5.\
    \  If the correspondent Binding Update message is\n   processed successfully and\
    \ an acknowledgement is requested, the\n   correspondent node constructs a Binding\
    \ Acknowledgement message shown\n   below.\n       IPv6 header (source = correspondent\
    \ node,\n                    destination = home address)\n       Encrypted Home\
    \ Address routing header\n           encrypted home address\n       Parameters:\n\
    \           sequence number (within the Binding Update message header)\n     \
    \      First (96, HMAC_SHA1 (Kbm, (care-of address | correspondent\n         \
    \      | BA)))\n   Upon receiving this Binding Acknowledgement message, the home\
    \ agent\n   applies the IPsec security association with a non-null encryption\n\
    \   algorithm to this message and forwards the following packet to the\n   mobile\
    \ node.\n       IPv6 header (source = home agent,\n                    destination\
    \ = care-of address)\n       ESP header in tunnel mode\n       IPv6 header (source\
    \ = correspondent node,\n                    destination = home address)\n   \
    \    Encrypted Home Address routing header\n           encrypted home address\n\
    \       Parameters:\n           sequence number (within the Binding Update message\
    \ header)\n           First (96, HMAC_SHA1 (Kbm, (care-of address | correspondent\n\
    \               | BA)))\n   The reverse-tunneled correspondent binding update\
    \ procedure is\n   completed after the mobile node processes the received Binding\n\
    \   Acknowledgement message.  Note that when the mobile node communicates\n  \
    \ with a different correspondent node, the encrypted home address looks\n   different.\n\
    \   To delete an established Binding Cache entry at the correspondent\n   node,\
    \ the mobile node reverse-tunnels the following Binding Update\n   message via\
    \ the home agent.  Note that the Encrypted Home Address\n   option is optional\
    \ during the correspondent binding de-registration\n   and only the home keygen\
    \ token is used to generate Kbm and Kpm, if\n   needed, in this case.\n      \
    \ IPv6 header (source = care-of address,\n                    destination = home\
    \ agent)\n       ESP header in tunnel mode\n       IPv6 header (source = home\
    \ address,\n                    destination = correspondent node)\n       Destination\
    \ option header (optional)\n           Encrypted Home Address option (encrypted\
    \ home address)\n       Parameters:\n           Alternative Care-of Address option\
    \ (care-of address)\n           sequence number (within the Binding Update message\
    \ header)\n           home nonce index (within the Nonce Indices option)\n   \
    \        care-of nonce index (within the Nonce Indices option)\n           First\
    \ (96, HMAC_SHA1 (Kbm, (care-of address | correspondent\n               | BU)))\n\
    \   If an acknowledgement is requested, the correspondent node returns\n   the\
    \ following Binding Acknowledgement message to the mobile node.\n       IPv6 header\
    \ (source = correspondent node,\n                    destination = home address)\n\
    \       Encrypted Home Address routing header (optional)\n           encrypted\
    \ home address\n       Parameters:\n           sequence number (within the Binding\
    \ Update message header)\n           First (96, HMAC_SHA1 (Kbm, (care-of address\
    \ | correspondent\n               | BA)))\n   Since the destination IP address\
    \ in this message is the home address,\n   the home agent will receive this message\
    \ and forward it to the mobile\n   node via the reverse tunnel.\n"
- title: 5.2.  Route-Optimized Payload Packets
  contents:
  - "5.2.  Route-Optimized Payload Packets\n   After the correspondent registration\
    \ is completed successfully,\n   subsequent payload packets are exchanged via\
    \ the optimized route\n   between the mobile node and the correspondent node.\
    \  In such packets,\n   only the encrypted home address carried in the Encrypted\
    \ Home Address\n   destination option and the Encrypted Home Address routing header\
    \ are\n   visible to eavesdroppers.\n   The format of payload packets sent from\
    \ the mobile node to the\n   correspondent node is:\n       IPv6 header (source\
    \ = care-of address,\n                    destination = correspondent node)\n\
    \       Destination option header\n           Encrypted Home Address option (encrypted\
    \ home address)\n       Payload\n   The format of payload packets sent from the\
    \ correspondent node to the\n   mobile node is:\n       IPv6 header (source =\
    \ correspondent node,\n                    destination = care-of address)\n  \
    \     Encrypted Home Address routing header\n           encrypted home address\n\
    \       Payload\n"
- title: 5.3.  Mobile Node Operation
  contents:
  - '5.3.  Mobile Node Operation

    '
- title: 5.3.1.  Conceptual Data Structures
  contents:
  - "5.3.1.  Conceptual Data Structures\n   The Binding Update List entry for the\
    \ correspondent registration is\n   extended with a new field to store the current\
    \ encrypted home address\n   used with a particular correspondent node.  The encrypted\
    \ home\n   address is stored when the mobile node sends a reverse-tunneled\n \
    \  correspondent Binding Update message, and the state of the\n   corresponding\
    \ Binding Update List entry is updated when the mobile\n   node successfully processes\
    \ the correspondent Binding Acknowledgement\n   message.  Note that the encrypted\
    \ home address field is not valid in\n   the Binding Update List entry for the\
    \ home registration.\n   Given that the encrypted home address is 128 bits long,\
    \ it is\n   expected that each encrypted home address or the combination of the\n\
    \   encrypted home address and the correspondent node's IP address stored\n  \
    \ in the Binding Update List is unique.  Therefore, the mobile node can\n   use\
    \ the encrypted home address (or use it together with the\n   correspondent node's\
    \ IP address) as a primary key to look up the\n   Binding Update List.\n"
- title: 5.3.2.  Reverse-Tunneled Correspondent Binding Update to the
  contents:
  - "5.3.2.  Reverse-Tunneled Correspondent Binding Update to the\n        Correspondent\
    \ Node\n   After the return routability procedure, if the mobile node chooses\
    \ to\n   use the location privacy solution with the correspondent node, e.g.,\n\
    \   based on the mobile node's configuration, it generates the encrypted\n   home\
    \ address, updates or creates a new correspondent Binding Update\n   List entry\
    \ to store the encrypted home address, then forwards the\n   correspondent Binding\
    \ Update message through the reverse tunnel\n   established with the home agent.\
    \  Note that the MAC is generated in\n   the same way as specified in RFC 3775,\
    \ and it does not cover the\n   encrypted home address.\n"
- title: 5.3.3.  Reverse-Tunneled Correspondent Binding Acknowledgement from the
  contents:
  - "5.3.3.  Reverse-Tunneled Correspondent Binding Acknowledgement from the\n   \
    \     Correspondent Node\n   When the mobile node receives a Binding Acknowledgement\
    \ message from\n   the correspondent node in response to a previously sent reverse-\n\
    \   tunneled correspondent Binding Update message, if this Binding\n   Acknowledgement\
    \ message contains an Encrypted Home Address routing\n   header, the mobile node\
    \ considers that the correspondent node\n   supports the location privacy solution.\
    \  The mobile node\n   authenticates this message based on RFC 3775.  If authentication\
    \ is\n   successful, the mobile node decrypts the encrypted home address and\n\
    \   compares the result with the real home address, or compares the\n   encrypted\
    \ home address with the one stored in the Binding Update List\n   entry.  If they\
    \ match, the mobile node considers that the\n   correspondent registration is\
    \ successful and updates the state of the\n   corresponding Binding Update List\
    \ entry.  If they do not match, the\n   mobile node MAY start the correspondent\
    \ binding update procedure\n   again.\n"
- title: 5.3.4.  Route-Optimized Payload Packets
  contents:
  - "5.3.4.  Route-Optimized Payload Packets\n   In order to maintain session continuity,\
    \ upper layers of the IP stack\n   in the mobile node still use the real home\
    \ address, even after the\n   reverse-tunneled correspondent registration.\n \
    \  A possible way of implementation is as follows.  When the Mobile IP\n   sublayer\
    \ at the mobile node receives a packet from the upper layer,\n   the normal processing\
    \ as specified in RFC 3775 is performed.\n   Subsequently, the Home Address option\
    \ is replaced with the Encrypted\n   Home Address option carrying the encrypted\
    \ home address stored in the\n   corresponding Binding Update List entry, and\
    \ then the mobile node\n   forwards the packet to the correspondent node via the\
    \ optimized\n   route.\n   On the other hand, when the mobile node receives a\
    \ payload packet\n   carrying the Encrypted Home Address routing header, the mobile\
    \ node\n   uses the encrypted home address (optionally together with the IP\n\
    \   address of the correspondent node) to look up the Binding Update\n   List.\
    \  If an entry is found, the mobile node accepts this packet,\n   replaces the\
    \ Encrypted Home Address option with the Home Address\n   option carrying the\
    \ real home address, and continues with processing\n   based on RFC 3775.  If\
    \ no entry is found, the mobile node silently\n   drops the received packet.\n"
- title: 5.3.5.  Receiving ICMP Error Message
  contents:
  - "5.3.5.  Receiving ICMP Error Message\n   The mobile node may receive an ICMP\
    \ Parameter Problem, Code 2,\n   message forwarded by the home agent via the bidirectional\
    \ tunnel, for\n   example, when the correspondent node does not support the use\
    \ of the\n   Encrypted Home Address option.  If such a message is received, the\n\
    \   mobile node SHOULD not attempt to use the location privacy solution\n   with\
    \ the correspondent node.  The mobile node may choose either not\n   to communicate\
    \ with the correspondent node, or to communicate without\n   location privacy\
    \ protection.\n"
- title: 5.3.6.  Binding Error from the Correspondent Node
  contents:
  - "5.3.6.  Binding Error from the Correspondent Node\n   When the mobile node communicates\
    \ with a correspondent node by using\n   the encrypted home address, a Binding\
    \ Error message with the Status\n   field set as 1 (unknown binding for Home Address\
    \ destination option)\n   may be received by the mobile node if there is no valid\
    \ Binding Cache\n   entry established at the correspondent node.  Note that we\
    \ do not\n   specify a new Status value to be used in this case because the\n\
    \   implementation of the Binding Update List entry can contain an\n   indication\
    \ of whether an encrypted home address is currently used\n   with the correspondent\
    \ node.  Upon receiving the Binding Error\n   message, the mobile node can find\
    \ out which encrypted home address is\n   invalid by looking at the Home Address\
    \ field of the Binding Error\n   message.  The mobile node may then perform the\
    \ correspondent binding\n   update procedure to establish a valid binding for\
    \ the encrypted home\n   address.\n"
- title: 5.3.7.  Binding Refresh Request from the Correspondent Node
  contents:
  - "5.3.7.  Binding Refresh Request from the Correspondent Node\n   When the mobile\
    \ node receives a Binding Refresh Request message sent\n   from the correspondent\
    \ node and forwarded by the home agent via the\n   bidirectional tunnel, the mobile\
    \ node needs to perform the\n   correspondent binding update procedure to refresh\
    \ the binding for the\n   encrypted home address at the correspondent node.\n"
- title: 5.4.  Home Agent Operation
  contents:
  - "5.4.  Home Agent Operation\n   With the solution described in this section (i.e.,\
    \ Section 5), there\n   is no new home agent operation to be specified.  That\
    \ is, the home\n   agent behaves based on RFC 3775 when processing signaling or\
    \ data\n   packets.\n"
- title: 5.5.  Correspondent Node Operation
  contents:
  - '5.5.  Correspondent Node Operation

    '
- title: 5.5.1.  Conceptual Data Structures
  contents:
  - "5.5.1.  Conceptual Data Structures\n   The Binding Cache entry is extended with\
    \ a new field to store the\n   current encrypted home address used with a particular\
    \ mobile node.\n   The encrypted home address is stored when the correspondent\
    \ node\n   successfully processes a reverse-tunneled correspondent Binding\n \
    \  Update message.\n   Given that the encrypted home address is 128 bits long,\
    \ it is\n   expected that each encrypted home address or the combination of the\n\
    \   care-of address and the encrypted home address stored in the Binding\n   Cache\
    \ entry is unique.  Therefore, the correspondent node can use the\n   encrypted\
    \ home address (or use it together with the care-of address)\n   as a primary\
    \ key to look up the Binding Cache.\n"
- title: 5.5.2.  Reverse-Tunneled Correspondent Binding Update from the Mobile
  contents:
  - "5.5.2.  Reverse-Tunneled Correspondent Binding Update from the Mobile\n     \
    \   Node\n   When receiving a reverse-tunneled Binding Update message with the\n\
    \   Encrypted Home Address option, if the correspondent node supports the\n  \
    \ location privacy solution, it verifies the message by using the same\n   method\
    \ as defined in RFC 3775.  If this verification succeeds, the\n   correspondent\
    \ node generates Kpm and uses it to decrypt the encrypted\n   home address, and\
    \ compares the result with the source IP address.  If\n   they match, the correspondent\
    \ node stores the encrypted home address\n   in the corresponding Binding Cache\
    \ entry.\n"
- title: 5.5.3.  Reverse-tunneled Correspondent Binding Acknowledgement to the
  contents:
  - "5.5.3.  Reverse-tunneled Correspondent Binding Acknowledgement to the\n     \
    \   Mobile Node\n   If an acknowledgement to the reverse-tunneled correspondent\
    \ Binding\n   Update message is requested by the mobile node, the correspondent\n\
    \   node returns a Binding Acknowledgement message with the Encrypted\n   Home\
    \ Address routing header, if it supports the location privacy\n   solution.  The\
    \ MAC in the Binding Acknowledgement message is\n   generated in the same way\
    \ as specified in RFC 3775 and does not cover\n   the encrypted home address carried\
    \ in the Encrypted Home Address\n   routing header.\n"
- title: 5.5.4.  Route-Optimized Payload Packets
  contents:
  - "5.5.4.  Route-Optimized Payload Packets\n   In order to maintain session continuity,\
    \ upper layers of the IP stack\n   in the correspondent node still use the real\
    \ home address, even after\n   the reverse-tunneled correspondent registration.\n\
    \   A possible way of implementation is as follows.  When the IP layer at\n  \
    \ the correspondent node finishes processing the packet received from\n   the\
    \ upper layer based on RFC 3775, the Type 2 routing header together\n   with the\
    \ real home address therein is replaced with the Encrypted\n   Home Address routing\
    \ header with the encrypted home address found in\n   the corresponding Binding\
    \ Cache entry.  Then, this packet is\n   forwarded to the mobile node via the\
    \ optimized route.\n   On the other hand, when the correspondent node receives\
    \ a payload\n   packet with the Encrypted Home Address option, it uses the encrypted\n\
    \   home address (optionally together with the care-of address of the\n   mobile\
    \ node) to look up the Binding Cache.  If there is an entry, the\n   correspondent\
    \ node replaces the Encrypted Home Address option with\n   the Home Address option\
    \ carrying the real home address before\n   forwarding the packet to the upper\
    \ layer.  If no matching entry is\n   found, the correspondent node sends a Binding\
    \ Error message to the\n   source IP address, i.e., the care-of address of the\
    \ mobile node.\n"
- title: 5.5.5.  ICMP Error Message to the Mobile Node
  contents:
  - "5.5.5.  ICMP Error Message to the Mobile Node\n   When receiving a reverse-tunneled\
    \ correspondent Binding Update\n   message with the Encrypted Home Address option,\
    \ if the correspondent\n   node does not support location privacy extensions,\
    \ it sends an ICMP\n   Parameter Problem, Code 2, message to the source IP address\
    \ (i.e.,\n   the home address of the mobile node) and the home agent then forwards\n\
    \   this ICMP message to the mobile node via the bidirectional tunnel.\n"
- title: 5.5.6.  Binding Error to the Mobile Node
  contents:
  - "5.5.6.  Binding Error to the Mobile Node\n   When the correspondent node receives\
    \ a payload packet with the\n   Encrypted Home Address option for which there\
    \ is no valid Binding\n   Cache entry, it returns a Binding Error message with\
    \ the Status code\n   set as 1 back to the source IP address of the packet.  Furthermore,\n\
    \   the Home Address field in the Binding Error message MUST be copied\n   from\
    \ the Encrypted Home Address field in the Encrypted Home Address\n   destination\
    \ option of the offending packet, or set to the unspecified\n   address if no\
    \ such option appears in the packet.\n"
- title: 5.5.7.  Binding Refresh Request to the Mobile Node
  contents:
  - "5.5.7.  Binding Refresh Request to the Mobile Node\n   When the correspondent\
    \ node realizes that a Binding Cache entry is\n   about to expire, it sends a\
    \ Binding Refresh Request message to the\n   real home address of the mobile node\
    \ stored in the Binding Cache\n   entry.\n"
- title: 5.6.  Summary
  contents:
  - "5.6.  Summary\n   With the solution in Section 5, the real home address is visible\
    \ in\n   the Binding Update and Binding Acknowledgement messages along the\n \
    \  HA-CN path.  Like Mobile IPv6 itself, it has not been designed to\n   change\
    \ the communications between the home network and the\n   correspondent node;\
    \ the same issues would affect non-mobile hosts as\n   well.  This solution meets\
    \ all the requirements set forth for the\n   location privacy solutions and provides\
    \ a simple way to provide\n   location privacy protection while allowing the use\
    \ of the real home\n   address with the correspondent node.\n"
- title: 6.  IP Address Location Privacy Solution Using the Pseudo Home Address
  contents:
  - '6.  IP Address Location Privacy Solution Using the Pseudo Home Address

    '
- title: 6.1.  Home Binding Update
  contents:
  - "6.1.  Home Binding Update\n   When the mobile node attaches to a foreign link,\
    \ it first performs\n   the home binding update procedure for the real home address\
    \ with the\n   home agent, as specified in RFC 3775.  For hiding the real home\n\
    \   address, we require the use of IPsec Encapsulating Security Payload\n   (ESP)\
    \ [3] in tunnel mode.  In order to provide location privacy, a\n   non-null encryption\
    \ transform must be used so that the real home\n   address is encrypted and encapsulated,\
    \ and made invisible to\n   eavesdroppers on the MN-HA path.  The packet formats\
    \ and processing\n   rules are the same as specified in RFC 3775 and RFC 4877.\n"
- title: 6.1.1.  Pseudo Home Address Registration
  contents:
  - '6.1.1.  Pseudo Home Address Registration

    '
- title: 6.1.1.1.  Generation
  contents:
  - "6.1.1.1.  Generation\n   To protect location privacy in the route optimization\
    \ mode, the\n   mobile node replaces the real home address used in certain signaling\n\
    \   and payload packets with the pseudo home address.  Different from the\n  \
    \ encrypted home address, the pseudo home address needs to be routable\n   so\
    \ that the home agent can intercept packets with the pseudo home\n   address used\
    \ as the destination address.  The pseudo home address is\n   generated by concatenating\
    \ one of the home network prefixes with a\n   random bit string.  There are many\
    \ ways to generate such a random bit\n   string, for example, by using a random\
    \ number generator or a secure\n   encryption or hash algorithm.\n   Using the\
    \ pseudo home address instead of the real home address even\n   in return routability\
    \ and binding update to the correspondent has the\n   following advantages.  First,\
    \ the pseudo home address does not reveal\n   the identity of a mobile node since\
    \ it is not (or should not be)\n   publicly known.  Hence, the signaling on the\
    \ HA-CN is path is more\n   secure since attackers will not be able to determine\
    \ the identity of\n   the mobile node based on the pseudo home address.  Second,\
    \ the mobile\n   node can communicate with a correspondent without disclosing\
    \ its real\n   home address.  Finally, the chosen pseudo home address can be\n\
    \   different with different correspondents for both signaling and data\n   traffic\
    \ purposes.\n   The prefix used to form the pseudo home address MUST be managed\
    \ by\n   the same home agent so that it can forward the return routability\n \
    \  messages.  Even though it does not have to be the same as that used\n   in\
    \ the real home address, the prefix is highly recommended to be\n   different.\
    \  For instance, a home agent may use a different prefix\n   pool for location\
    \ privacy purposes for a set of mobile nodes.  This\n   ensures that the real\
    \ home address and the pseudo home address are\n   not co-related (assuming the\
    \ mobile node chooses different interface\n   identifiers (IIDs)).\n"
- title: 6.1.1.2.  Registration
  contents:
  - "6.1.1.2.  Registration\n   The mobile node MUST register the pseudo home address\
    \ to be used with\n   the home agent before actually using it with a correspondent\
    \ node.\n   To do so, the mobile node indicates a pseudo home address in the\n\
    \   Pseudo Home Address mobility option in the Binding Update message\n   sent\
    \ to the home agent.  If the home agent supports the location\n   privacy solution,\
    \ it performs the Duplicate Address Detection to\n   detect whether this pseudo\
    \ home address conflicts with other pseudo\n   home addresses submitted from different\
    \ mobile nodes.  Based on the\n   result, the home agent indicates whether to\
    \ accept the pseudo home\n   address by setting the appropriate status code in\
    \ the Pseudo Home\n   Address Acknowledgement option in the Binding Acknowledgement\n\
    \   message.  If the home agent prefers the use of a different home\n   network\
    \ prefix from that of the requested pseudo home address, the\n   home agent returns\
    \ the new pseudo home address in the Pseudo Home\n   Address Acknowledgement mobility\
    \ option to the mobile node.\n   The mobile node MAY register the pseudo home\
    \ address when it is about\n   to communicate with a correspondent node with location\
    \ privacy\n   protection.  The default lifetime of registered pseudo home addresses\n\
    \   is the same as the Home Binding Cache entry; however, a mobile node\n   may\
    \ choose any value and a home agent may grant any value.  The\n   mobile node\
    \ can add or delete any pseudo home address by using the\n   Pseudo Home Address\
    \ mobility option in the home Binding Update\n   message.  The home agent does\
    \ not have to recover the real home\n   address from the pseudo home address.\n"
- title: 6.1.2.  Home De-Registration
  contents:
  - "6.1.2.  Home De-Registration\n   When the mobile node returns to its home link,\
    \ the home de-\n   registration procedure is the same as specified in RFC 3775,\
    \ i.e.,\n   the real home address is used as the source IP address in the Binding\n\
    \   Update message and the destination IP address in the Binding\n   Acknowledgement\
    \ message.  The de-registration of the real home\n   address results in automatic\
    \ de-registration of all pseudo home\n   addresses.  When the mobile node decides\
    \ to disconnect from the home\n   agent while at its foreign link, the format\
    \ of the Binding Update and\n   Acknowledgement is the same as that defined for\
    \ the home\n   registration, except that the Lifetime field is set to zero.  The\n\
    \   home agent deletes the corresponding Binding Cache entry including\n   the\
    \ registered pseudo home address, if any.\n"
- title: 6.2.  Correspondent Binding Update Using the Pseudo Home Address
  contents:
  - '6.2.  Correspondent Binding Update Using the Pseudo Home Address

    '
- title: 6.2.1.  Return Routability Procedure
  contents:
  - "6.2.1.  Return Routability Procedure\n   The location privacy solution specified\
    \ in this section does not\n   introduce any change to the care-of address test\
    \ procedure as\n   specified in RFC 3775.  In the following, we highlight the\
    \ extensions\n   to the home address test procedure, during which the mobile node\n\
    \   obtains a home keygen token generated based on the pseudo home\n   address.\n\
    \   The mobile node generates and sends a Home Test Init message to the\n   home\
    \ agent.  The format of this message is:\n       IPv6 header (source = care-of\
    \ address, destination = home agent)\n       ESP header in tunnel mode\n     \
    \  IPv6 header (source = home address, destination = correspondent)\n       Mobility\
    \ Header (HoTI)\n           Home Init Cookie\n           Pseudo Home Address mobility\
    \ option (pseudo home address)\n   The difference from what is specified in RFC\
    \ 3775 is that the mobile\n   node includes a Pseudo Home Address mobility option\
    \ (see Section 7.3)\n   in the Home Test Init message.  A new option for carrying\
    \ the pseudo\n   home address is necessary because the security association between\n\
    \   the mobile node and the home agent is based on the real home address.\n  \
    \ The pseudo home address contained in the Pseudo Home Address option\n   is selected\
    \ by the mobile node from a set of pseudo home addresses\n   that have been registered\
    \ with the home agent during the home\n   registration procedure.  Note that the\
    \ Home Test Init message is\n   protected by an IPsec security association in\
    \ the ESP tunnel mode\n   with a non-null encryption algorithm and a non-null\
    \ authentication\n   algorithm, as specified in RFC 3776.\n   When receiving a\
    \ Home Test Init message, the home agent performs the\n   operation as specified\
    \ in Section 6.6.4.  If this operation succeeds\n   when the Pseudo Home Address\
    \ mobility option is present in the Home\n   Test Init message, the home agent\
    \ generates a Home Test Init message\n   and forwards it to the correspondent\
    \ node.  As shown in the\n   following, the pseudo home address carried in the\
    \ Pseudo Home Address\n   mobility option is used as the source IP address in\
    \ the forwarded\n   Home Test Init message.\n       IPv6 header (source = pseudo\
    \ home address,\n                    destination = correspondent)\n       Mobility\
    \ Header (HoTI)\n           Home Init Cookie\n   The forwarded Home Test Init\
    \ message looks the same to the\n   correspondent node as what is specified in\
    \ RFC 3775 and the\n   correspondent node does not realize that the pseudo home\
    \ address is\n   used, and just generates a home keygen token using the same algorithm\n\
    \   as specified in RFC 3775.\n      home keygen token =\n          First (64,\
    \ HMAC_SHA1 (Kcn, (pseudo home address | nonce | 0)))\n   The correspondent node\
    \ then replies with a Home Test message.  As\n   shown in the following, the format\
    \ of this message is the same as\n   that specified in RFC 3776, and the pseudo\
    \ home address is used as\n   the destination IP address.\n       IPv6 header\
    \ (source = correspondent,\n                    destination = pseudo home address)\n\
    \       Mobility Header (HoT)\n           Home Init Cookie\n           Home Keygen\
    \ Token\n           Home Nonce Index\n   When the home agent intercepts the Home\
    \ Test message using proxy\n   Neighbor Discovery, it performs the operation as\
    \ specified in\n   Section 6.6.5.  If this operation succeeds, the home agent\
    \ generates\n   the following Home Test message and forwards to the mobile node.\n\
    \       IPv6 header (source = home agent, destination = care-of address)\n   \
    \    ESP header in tunnel mode\n       IPv6 header (source = correspondent, destination\
    \ = home address)\n       Mobility Header (HoT)\n           Home Init Cookie\n\
    \           Home Keygen Token\n           Home Nonce Index\n           Pseudo\
    \ Home Address Acknowledgement mobility option\n              (pseudo home address)\n\
    \   When the mobile node receives the Home Test message, it performs\n   operation\
    \ as specified in Section 6.5.5.  If such operation succeeds,\n   the mobile node\
    \ obtains a home keygen token computed using the pseudo\n   home address.  After\
    \ the care-of address test is completed, the\n   mobile node hashes the care-of\
    \ keygen token and the home keygen token\n   together to generate Kbm using the\
    \ same method as specified in RFC\n   3775.\n"
- title: 6.2.2.  Route-Optimized Correspondent Binding Update
  contents:
  - "6.2.2.  Route-Optimized Correspondent Binding Update\n   In this procedure, the\
    \ mobile node MUST use the same pseudo home\n   address used during the home address\
    \ test procedure.  The pseudo home\n   address is carried in the Home Address\
    \ option in the correspondent\n   Binding Update message.\n       IPv6 header\
    \ (source = care-of address,\n                    destination = correspondent)\n\
    \       Destination option header\n           Home Address destination option\
    \ (pseudo home address)\n       Parameters:\n           sequence number (within\
    \ the Binding Update message header)\n           home nonce index (within the\
    \ Nonce Indices option)\n           care-of nonce index (within the Nonce Indices\
    \ option)\n           First (96, HMAC_SHA1 (Kbm, (care-of address | correspondent\n\
    \           | BU)))\n   When the correspondent node receives the Binding Update\
    \ message, it\n   performs the same operation as specified in RFC 3775.  If such\n\
    \   operation succeeds and an acknowledgement is requested by the mobile\n   node,\
    \ the correspondent node replies with the following Binding\n   Acknowledgement\
    \ message.\n       IPv6 header (source = correspondent,\n                    destination\
    \ = care-of address)\n       Parameters:\n           sequence number (within the\
    \ Binding Update message header)\n           First (96, HMAC_SHA1 (Kbm, (care-of\
    \ address | correspondent\n           | BA)))\n   After the mobile node receives\
    \ the Binding Acknowledgement message\n   indicating that the correspondent registration\
    \ succeeds, the mobile\n   node can now use the pseudo home address for communicating\
    \ with the\n   correspondent node.\n   Such a Binding Update message may also\
    \ be used by the mobile node to\n   delete a previously established binding at\
    \ the correspondent node.\n   In this case, similar to what is specified in RFC\
    \ 3775, Kbm is\n   generated exclusively from the home keygen token that is based\
    \ on the\n   pseudo home address.\n"
- title: 6.2.3.  Reverse-tunneled Correspondent Binding Update
  contents:
  - "6.2.3.  Reverse-tunneled Correspondent Binding Update\n   The mobile node may\
    \ choose to use reverse tunneling for sending the\n   Binding Update.  The format\
    \ of messages during such a procedure is\n   similar to what is described in Sections\
    \ 5 and 6.2.1, except that a\n   pseudo home address is used in place of the real\
    \ home address.  The\n   Encrypted Home Address destination and the Encrypted\
    \ Home Address\n   routing header SHOULD be used to carry the encrypted pseudo\
    \ home\n   address.\n"
- title: 6.2.4.  Using Different Pseudo Home Addresses with Different
  contents:
  - "6.2.4.  Using Different Pseudo Home Addresses with Different\n        Correspondent\
    \ Nodes\n   Based on its configuration and policy, the mobile node can choose\
    \ to\n   use the same or different pseudo home addresses when communicating\n\
    \   with different correspondent nodes.  Using a different pseudo home\n   address\
    \ with each correspondent node may help prevent the mobile\n   node's activities\
    \ from being linked and correlated.  To do so, the\n   mobile node selects a different\
    \ but already registered pseudo home\n   address and repeats the return routability\
    \ procedure and the\n   correspondent binding update procedure with each correspondent\
    \ node.\n   In addition, if the mobile node prefers, it MAY use different pseudo\n\
    \   home addresses for different sessions with the same correspondent\n   node.\
    \  This typically requires additional configuration at the mobile\n   node that\
    \ associates a specific session (for example, identified by\n   the port number\
    \ and the protocol number, among others) with a\n   specific pseudo home address.\
    \  This document does not address details\n   of this solution.\n"
- title: 6.3.  Payload Packets
  contents:
  - '6.3.  Payload Packets

    '
- title: 6.3.1.  Reverse Tunneling Mode
  contents:
  - "6.3.1.  Reverse Tunneling Mode\n   The format of payload packets reverse-tunneled\
    \ via the home agent is\n   the same as that specified for the home address test\
    \ procedure in\n   Section 6.2.1.\n"
- title: 6.3.2.  Route Optimization Mode
  contents:
  - "6.3.2.  Route Optimization Mode\n   When the route-optimized correspondent binding\
    \ update procedure is\n   performed, the format of payload packets exchanged between\
    \ the mobile\n   node and the correspondent node is the same as specified in RFC\
    \ 3775.\n   The operation of the mobile node when communicating with the\n   correspondent\
    \ node via the route optimization mode is described in\n   Section 6.5.6.\n  \
    \ When the reverse tunneled correspondent binding update procedure is\n   performed,\
    \ the format of payload packets exchanged between the mobile\n   node and the\
    \ correspondent node is the same as specified in Section\n   5, except that the\
    \ encrypted pseudo home address SHOULD be included\n   in the Encrypted Home Address\
    \ destination option and the Encrypted\n   Home Address routing header.\n"
- title: 6.4.  Prefix Discovery
  contents:
  - "6.4.  Prefix Discovery\n   The solution to protect location privacy during the\
    \ prefix discovery\n   procedure is similar to that used during the home binding\
    \ update\n   procedure.\n"
- title: 6.5.  Mobile Node Operation
  contents:
  - "6.5.  Mobile Node Operation\n   In this section, we describe the mobile node's\
    \ operation when the\n   location privacy solution is used.\n"
- title: 6.5.1.  Conceptual Data Structures
  contents:
  - '6.5.1.  Conceptual Data Structures

    '
- title: 6.5.1.1.  Pseudo Home Address Table
  contents:
  - "6.5.1.1.  Pseudo Home Address Table\n   We introduce a new data structure, called\
    \ Pseudo Home Address table,\n   to record the information of pseudo home addresses.\
    \  The mobile node\n   may maintain a Pseudo Home Address table for each home\
    \ agent it\n   registers with.  Each entry in the table contains a pseudo home\n\
    \   address and its associated state, i.e., \"unconfirmed\" or \"confirmed\".\n\
    \   The mobile node creates or updates entries in the Pseudo Home Address\n  \
    \ table when sending the home Binding Update message or receiving the\n   home\
    \ Binding Acknowledgement message.  The pseudo home address can be\n   used as\
    \ a key to search the table.  There MUST NOT be any duplicated\n   pseudo home\
    \ addresses stored in the Pseudo Home Address table.\n"
- title: 6.5.1.2.  Binding Update List
  contents:
  - "6.5.1.2.  Binding Update List\n   The Binding Update List entry is extended with\
    \ a field, called Pseudo\n   Home Address.  This field MAY be implemented as a\
    \ pointer that points\n   to a corresponding entry in the Pseudo Home Address\
    \ table.  This\n   pointer is initialized as NULL when the Binding Update List\
    \ entry is\n   created (for example, when the mobile node sends a Binding Update\n\
    \   message or a Home Test Init message to the home agent).  For the\n   binding\
    \ sent to a specific home agent, the Pseudo Home Address field\n   points to the\
    \ first entry in the Pseudo Home Address table (or NULL\n   if the table is empty),\
    \ so that the mobile node can access all the\n   pseudo home addresses registered\
    \ at this home agent; on the other\n   hand, for the binding sent to a specific\
    \ correspondent node, the\n   Pseudo Home Address field points to the Pseudo Home\
    \ Address table\n   entry that contains the actual pseudo home address used with\
    \ this\n   correspondent node (or NULL if no pseudo home address is used with\n\
    \   this correspondent node).\n"
- title: 6.5.2.  Binding Update to the Home Agent
  contents:
  - "6.5.2.  Binding Update to the Home Agent\n   The mobile node may decide to perform\
    \ the home registration with\n   location privacy protection, for example, when\
    \ it attaches to a\n   foreign link or when it needs to extend the lifetime of\
    \ a registered\n   home binding.\n   Since IPsec tunnel mode is used, the mobile\
    \ node MUST negotiate a\n   non-null encryption algorithm (for example, during\
    \ the bootstrapping)\n   and use it to protect the home Binding Update message\
    \ as specified in\n   RFC 3775 and RFC 4877.  In addition, the mobile node can\
    \ register a\n   pseudo home address as described above.  If the mobile node does\
    \ not\n   wish to register the pseudo home address at this point, but wishes to\n\
    \   discover whether the home agent supports the location privacy\n   solution,\
    \ the mobile node includes a Pseudo Home Address mobility\n   option without the\
    \ Pseudo Home Address field in the Binding Update\n   message sent to the home\
    \ agent.\n   After sending the home de-registration binding update message, in\n\
    \   addition to the operation specified in RFC 3775, the mobile node MUST\n  \
    \ stop using any data structure specific to the location privacy\n   solution\
    \ and MAY delete them after the Binding Acknowledgement\n   message is processed\
    \ successfully.\n"
- title: 6.5.3.  Binding Acknowledgement from the Home Agent
  contents:
  - "6.5.3.  Binding Acknowledgement from the Home Agent\n   With IPsec tunnel mode,\
    \ the mobile node follows the rules specified\n   in RFC 3775 and RFC 4877 to\
    \ process the Binding Acknowledgement\n   message.\n   In addition, if one or\
    \ more Pseudo Home Address Acknowledgement\n   mobility options are present in\
    \ the Binding Acknowledgement message,\n   the mobile node checks the Status field\
    \ in each option.  If the\n   Status field in one option is 0 (Success), the pseudo\
    \ home address,\n   if not already present, is added into the Pseudo Home Address\
    \ table,\n   and the state of the corresponding entry is set to \"confirmed\"\
    .\n   Otherwise, the mobile node deletes any existing pseudo home address\n  \
    \ with the \"unconfirmed\" state (i.e., either an error code or no\n   acknowledgement\
    \ for such a pseudo home address is received) from the\n   Pseudo Home Address\
    \ table.\n   The mobile node considers that the home agent supports the location\n\
    \   privacy solution, if a valid Pseudo Home Address Acknowledgement\n   mobility\
    \ option with or without a Pseudo Home Address field is\n   received.\n   Note\
    \ that the mobile node MUST determine whether the home\n   registration succeeds\
    \ or not based on what is specified RFC 3775.\n"
- title: 6.5.4.  Home Test Init to the Home Agent
  contents:
  - "6.5.4.  Home Test Init to the Home Agent\n   To enable location privacy protection\
    \ during communication with the\n   correspondent node in the route optimization\
    \ mode, the mobile node\n   generates a Home Test Init message based on what is\
    \ specified in RFC\n   3775 and RFC 3776.  In addition, if the return routability\
    \ procedure\n   is for a new session with the correspondent node, the mobile node\n\
    \   selects any pseudo home address from those already registered with\n   the\
    \ home agent and stored in the Pseudo Home Address table;\n   otherwise, the mobile\
    \ node must use the same pseudo home address as\n   used with the same correspondent\
    \ node before.  The selected pseudo\n   home address is carried in the Pseudo\
    \ Home Address mobility option of\n   the generated Home Test Init message.  This\
    \ Home Test Init message is\n   protected by an IPsec security association with\
    \ a non-null encryption\n   algorithm.\n   After sending the Home Test Init message\
    \ to the home agent, if there\n   is no Binding Update List entry existing for\
    \ the correspondent node,\n   the mobile node creates one entry that points to\
    \ the pseudo home\n   address used; otherwise, the mobile node updates the existing\
    \ entry.\n"
- title: 6.5.5.  Home Test from the Home Agent
  contents:
  - "6.5.5.  Home Test from the Home Agent\n   When the mobile node receives a Home\
    \ Test message from the home\n   agent, it processes the packet based on processing\
    \ rules specified in\n   RFC 3775 and RFC 3776.  If this is a valid packet and\
    \ there is a\n   Pseudo Home Address Acknowledgement option included, the mobile\
    \ node\n   examines the Status field inside this mobility option as follows:\n\
    \   o  If the Status field indicates that the home address test procedure\n  \
    \    using the pseudo home address succeeds (the Status field is 0), in\n    \
    \  addition to what is specified in RFC 3775, the mobile node\n      prepares\
    \ to use the pseudo home address carried in the Pseudo Home\n      Address Acknowledgement\
    \ option for the correspondent registration.\n   o  If the Status field indicates\
    \ that the home address test procedure\n      using the pseudo home address fails\
    \ (the Status field is larger\n      than 127), the mobile node can take steps\
    \ to correct the cause of\n      the error and retransmit the Home Test Init message,\
    \ subject to\n      the retransmission limit specified in RFC 3775.  If this is\
    \ not\n      done or it fails, then the mobile node SHOULD record in its\n   \
    \   Binding Update List that the future home address test procedure\n      SHOULD\
    \ NOT use the pseudo home address with this correspondent\n      node.\n"
- title: 6.5.6.  Route-Optimized Payload Packets
  contents:
  - "6.5.6.  Route-Optimized Payload Packets\n   After the mobile node completes the\
    \ route-optimized correspondent\n   registration procedure using the pseudo home\
    \ address, payload packets\n   are sent to the correspondent node with the pseudo\
    \ home address in\n   the Home Address destination option.\n   The packet processing\
    \ rules when sending and receiving route-\n   optimized packets are the same as\
    \ in RFC 3775 except that pseudo home\n   addresses are used.  In addition, if\
    \ encrypted pseudo home addresses\n   are used, both the mobile node and the correspondent\
    \ node need to\n   replace the encrypted address with the pseudo home address\
    \ before\n   passing them to the upper layers.\n   In the case that the mobile\
    \ node masks the pseudo home address and\n   uses the reverse-tunneled correspondent\
    \ binding update procedure, the\n   mobile node performs the operation specified\
    \ in Section 5.3.4, except\n   that the pseudo home address rather than the real\
    \ home address is\n   expected.\n"
- title: 6.5.7.  Receiving Binding Refresh Request
  contents:
  - "6.5.7.  Receiving Binding Refresh Request\n   When the Mobile Node receives a\
    \ Binding Refresh Request message from\n   a correspondent node, the destination\
    \ IP address may be the pseudo\n   home address.  In this case, the mobile node\
    \ needs to check the\n   corresponding Binding Update List entry for the correspondent\
    \ node.\n   If the pseudo home address is invalid, the mobile node silently\n\
    \   discards this message.  Otherwise, the mobile node refreshes the\n   binding\
    \ with the correspondent node by using the same pseudo home\n   address.\n"
- title: 6.6.  Home Agent Operation
  contents:
  - "6.6.  Home Agent Operation\n   In this section, we describe the home agent's\
    \ operation when the\n   location privacy solution is used.\n"
- title: 6.6.1.  Conceptual Data Structures
  contents:
  - "6.6.1.  Conceptual Data Structures\n   The Binding Cache entry is extended with\
    \ a field that points to a\n   list of currently accepted pseudo home addresses.\
    \  Note that each\n   registered pseudo home address MUST be unique and all the\
    \ registered\n   pseudo home addresses SHOULD be organized in such a way that\
    \ the\n   associated Binding Cache entry can be quickly located when a pseudo\n\
    \   home address is used as the key to look up the Binding Cache.\n"
- title: 6.6.2.  Binding Update from the Mobile Node
  contents:
  - "6.6.2.  Binding Update from the Mobile Node\n   If the received Binding Update\
    \ message contains one or more Pseudo\n   Home Address mobility options, the home\
    \ agent MUST ignore such an\n   option if it does not recognize it.  If the home\
    \ agent recognizes\n   such an option, a Pseudo Home Address Acknowledgement mobility\
    \ option\n   is generated and some fields therein are set as follows:\n   o  If\
    \ the Pseudo Home Address field received is empty, the Status\n      field is\
    \ set to 0 (Success), and the Pseudo Home Address field is\n      empty.\n   o\
    \  If the Pseudo Home Address field received is set to all zero, the\n      Status\
    \ field is set is 0 (Success), and a pseudo home address\n      SHOULD be included\
    \ in the Pseudo Home Address field, if the home\n      agent supports the dynamic\
    \ pseudo home address assignment;\n      otherwise, the Status field is set to\
    \ 132 (Dynamic pseudo home\n      address assignment not available) and the Pseudo\
    \ Home Address\n      field is empty.\n   o  The Pseudo Home Address field received\
    \ may contain an IPv6\n      address.  If the format of such an IP address is\
    \ incorrect, the\n      Status field is set to 130 (Incorrect pseudo home address).\
    \  If\n      such an IP address is invalid, for example, the prefix is not a\n\
    \      valid home network prefix or this is detected as a duplicated IP\n    \
    \  address, the Status field is set to 131 (Invalid pseudo home\n      address).\
    \  In both cases, the Pseudo Home Address field is empty.\n      If the home agent\
    \ suggests a different pseudo home address, the\n      Status field is set to\
    \ 0 (Success), and the new pseudo home\n      address is included in the Pseudo\
    \ Home Address field.  Otherwise,\n      if the home agent accepts the requested\
    \ pseudo home address, the\n      Status field is set as 0 (Success), and the\
    \ same IP address is\n      included in the Pseudo Home Address field.\n   o \
    \ If the home agent does not allow the mobile node to use the pseudo\n      home\
    \ address with the correspondent node, the Status field SHOULD\n      be set as\
    \ 129 (Administratively prohibited) and the Pseudo Home\n      Address field is\
    \ empty.\n   o  In case that the home agent does not accept the Pseudo Home\n\
    \      Address mobility option for all other reasons, the Status field\n     \
    \ SHOULD be set as 128 (Failure, reason unspecified) and the Pseudo\n      Home\
    \ Address is empty.\n   When receiving a Binding Update message protected with\
    \ the IPsec\n   tunnel mode, the home agent performs the operation specified in\
    \ RFC\n   4877.\n   When receiving and successfully processing a Binding Update\
    \ message\n   for de-registration from the mobile node, in addition to what is\n\
    \   specified in RFC 3775, the home agent MUST delete data structures\n   related\
    \ to the location privacy extension.\n"
- title: 6.6.3.  Binding Acknowledgement to the Mobile Node
  contents:
  - "6.6.3.  Binding Acknowledgement to the Mobile Node\n   When sending a Binding\
    \ Acknowledgement message protected with the\n   IPsec tunnel mode, the home agent\
    \ performs the operation specified in\n   RFC 4877.\n   The processing rules related\
    \ to the Pseudo Home Address\n   Acknowledgement mobility option are described\
    \ in Section 6.6.2.\n"
- title: 6.6.4.  Home Test Init from the Mobile Node
  contents:
  - "6.6.4.  Home Test Init from the Mobile Node\n   When receiving a Home Test Init\
    \ message from the mobile node, the\n   home agent first verifies this message\
    \ based on the IPsec processing\n   rules as specified in RFC 3776.  If the verification\
    \ fails, the home\n   agent acts based on such IPsec processing rules.  Otherwise,\
    \ if the\n   Pseudo Home Address option does not exist in the Home Test Init\n\
    \   message, the home agent performs the operation as specified in RFC\n   3775.\
    \  Otherwise, the following operation is performed.\n   1.  The home agent looks\
    \ up its Binding Cache by using the real home\n       address as a key.  If the\
    \ pseudo home address carried in the\n       Pseudo Home Address option does not\
    \ match any pseudo home address\n       associated with the corresponding Binding\
    \ Cache entry (including\n       when the Pseudo Home Address field is set as\
    \ zero), it MUST\n       reject the Home Test Init message by sending back a Home\
    \ Test\n       message including the Pseudo Home Address Acknowledgement option\n\
    \       with the Status field set as 131 (Invalid pseudo home address).\n   2.\
    \  Otherwise, the home agent constructs a Home Test Init message\n       with\
    \ the pseudo home address as the source IP address, and\n       forwards the Home\
    \ Test Init message to the correspondent node.\n"
- title: 6.6.5.  Home Test to the Mobile Node
  contents:
  - "6.6.5.  Home Test to the Mobile Node\n   When the home agent intercepts a Home\
    \ Test message using proxy\n   Neighbor Discovery, if the destination IP address\
    \ matches with one of\n   the real home addresses, the home agent performs the\
    \ operation as\n   specified in RFC 3775.  Otherwise, the home agent uses the\n\
    \   destination IP address to look up the Binding Cache to find if there\n   is\
    \ a matched pseudo home addresses.  If not, the home agent discards\n   this message\
    \ silently.  When a matching pseudo home address is found,\n   the home agent\
    \ generates a Home Test message with a Pseudo Home\n   Address Acknowledgement\
    \ option and sends it to the mobile node.\n   Inside the Pseudo Home Address Acknowledgement\
    \ option, the Status\n   field is set to zero (Success) and the Pseudo Home Address\
    \ field is\n   filled with the found pseudo home address.\n"
- title: 6.7.  Correspondent Node Operation
  contents:
  - "6.7.  Correspondent Node Operation\n   With the solution described in this section,\
    \ when the correspondent\n   node is involved in the route-optimized correspondent\
    \ binding update\n   procedure, there is no new operation if only pseudo home\
    \ addresses\n   are used without encryption.  This specification recommends using\n\
    \   encrypted pseudo home addresses to thwart revealing any prefix\n   information\
    \ about a mobile node.  The additional operations are the\n   same as specified\
    \ in Section 5.5, except that the pseudo home\n   address, instead of the real\
    \ home address, is used.\n"
- title: 7.  Extensions to Mobile IPv6
  contents:
  - "7.  Extensions to Mobile IPv6\n   This section describes the experimental extensions\
    \ to Mobile IPv6\n   used in this document.  For experimentation purposes, the\n\
    \   experimental IPv6 Option Type, the experimental IPv6 Routing Header\n   Type,\
    \ and the experimental Mobility Option Type as defined in RFC\n   4727 [12] and\
    \ RFC 5096 [13] can be used in the Encrypted Home Address\n   destination option,\
    \ the Encrypted Home Address routing header, the\n   Pseudo Home Address mobility\
    \ option, and the Pseudo Home Address\n   Acknowledgement mobility option.  In\
    \ the following, we describe the\n   format of each extension for illustration\
    \ purpose.\n"
- title: 7.1.  Encrypted Home Address Destination Option
  contents:
  - "7.1.  Encrypted Home Address Destination Option\n   This option is used in the\
    \ Destination Option extension header (Next\n   Header value = 60).\n       0\
    \                   1                   2                   3\n       0 1 2 3\
    \ 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n                  \
    \                    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n                     \
    \                 |  Option Type  | Option Length |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                                                               +\n      |\
    \                                                               |\n      +   \
    \                 Encrypted Home Address                     +\n      |      \
    \                                                         |\n      +         \
    \                                                      +\n      |            \
    \                                                   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Option Type\n         A type for identifying the use of the encrypted home\
    \ address in\n         this option.  Implementations of this RFC can use the value\n\
    \         0xFE.  This value is reserved in RFC 4727 for all experiments\n    \
    \     involving IPv6 destination options.\n      Encrypted Home Address\n    \
    \     The encrypted home address generated from a either real or\n         pseudo\
    \ home address.\n   The processing of other fields in the Encrypted Home Address\
    \ option\n   is the same as that of those fields in the Home Address option\n\
    \   described in RFC 3775.  Note that if the Encrypted Home Address\n   option\
    \ is present in a packet, the encrypted home address therein\n   MUST NOT be treated\
    \ as the real source IP address by the receiver.\n"
- title: 7.2.  Encrypted Home Address Routing Header
  contents:
  - "7.2.  Encrypted Home Address Routing Header\n   The encrypted home address is\
    \ carried in this routing header.\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |  Next Header  | Hdr Ext Len=2 | Routing Type  |Segments Left=1|\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                                                            +\n      |      \
    \                                                         |\n      +         \
    \          Encrypted Home Address                      +\n      |            \
    \                                                   |\n      +               \
    \                                                +\n      |                  \
    \                                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Routing Type\n         A type for identifying the use of the encrypted\
    \ home address in\n         this option.  Implementations of this RFC can use\
    \ the value\n         0xFE.  This value is reserved in RFC 4727 for all experiments\n\
    \         involving IPv6 routing header.\n      Encrypted Home Address\n     \
    \    The encrypted home address generated from a either real or\n         pseudo\
    \ home address.\n   The processing of other fields in the Encrypted Home Address\
    \ routing\n   header is the same as described in RFC 3775.  Note that if this\n\
    \   routing header is present in a packet, the encrypted home address\n   therein\
    \ MUST NOT be treated as the real destination IP address by the\n   receiver.\n"
- title: 7.3.  Pseudo Home Address Mobility Option
  contents:
  - "7.3.  Pseudo Home Address Mobility Option\n   This mobility option is included\
    \ in the mobility header, including\n   the Binding Update message and the Home\
    \ Test Init message, and\n   carries zero or one pseudo home address.  The alignment\
    \ requirement\n   for this option is 4n.\n       0                   1       \
    \            2                   3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7\
    \ 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |   Length      |A|   Reserved  | Prefix length |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |\
    \                                                               |\n      +   \
    \                                                            +\n      |      \
    \                                                         |\n      +         \
    \            Pseudo Home Address                       +\n      |            \
    \                                                   |\n      +               \
    \                                                +\n      |                  \
    \                                             |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Type\n         A unique type (together with the 'A' bit in the Reserved\
    \ field)\n         for identifying the Pseudo Home Address Acknowledgement\n \
    \        mobility option.  For experimental purpose, the value of this\n     \
    \    type is 18 as reserved in RFC 5096.\n      Length\n         The length of\
    \ the Pseudo Home Address mobility option excluding\n         the Type field and\
    \ the Length field.  It MUST be 2 when the\n         Pseudo Home Address field\
    \ is not present; otherwise, it MUST be\n         18.\n      Reserved Field\n\
    \         The 'A' bit, which MUST be set to zero to indicate that this is\n  \
    \       a Pseudo Home Address mobility option.  The rest of bits MUST\n      \
    \   be set as zero by the sender and ignored by the receiver.\n      Prefix Length\n\
    \         The length of the home network prefix of the included pseudo\n     \
    \    home address.  When the Pseudo Home Address field is not\n         present,\
    \ the Prefix Length field MUST be set as zero.\n      Pseudo Home Address\n  \
    \       If present, the field contains a pseudo home address that the\n      \
    \   mobile node wants to use for location privacy protection or\n         zero\
    \ if the mobile node requests a pseudo home address from the\n         home agent.\
    \  This field is not present if the mobile node only\n         intends to discover\
    \ whether the home agent supports the\n         location privacy solutions.  The\
    \ Length field is used to detect\n         whether the Pseudo Home Address field\
    \ is present in the Pseudo\n         Home Address mobility option.\n"
- title: 7.4.  Pseudo Home Address Acknowledgement Mobility Option
  contents:
  - "7.4.  Pseudo Home Address Acknowledgement Mobility Option\n   This mobility option\
    \ is included in the mobility header, including\n   the Binding Acknowledgement\
    \ message and the Home Test message sent to\n   the mobile node, and carries zero\
    \ or one pseudo home address.  This\n   mobility option is used to indicate the\
    \ status of the pseudo home\n   address registration and/or whether the home agent\
    \ supports the\n   location privacy solutions.  The alignment requirement for\
    \ this\n   option is 2n.\n       0                   1                   2   \
    \                3\n       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\
    \ 6 7 8 9 0 1\n                                      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                                      |     Type      |    Length     |\n   \
    \   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n      |A|\
    \   Reserved  | Prefix length |    Status     |   Reserved    |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |                                                               |\n   \
    \   +                                                               +\n      |\
    \                                                               |\n      +   \
    \                  Pseudo Home Address                       +\n      |      \
    \                                                         |\n      +         \
    \                                                      +\n      |            \
    \                                                   |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      Type\n         A unique type (together with the 'A' bit in the Reserved\
    \ field)\n         for identifying the Pseudo Home Address Acknowledgement\n \
    \        mobility option.  For experimental purpose, the value of this\n     \
    \    type is 18 as reserved in RFC 5096.\n      Length\n         The length of\
    \ the Pseudo Home Address Acknowledgement mobility\n         option excluding\
    \ the Type field and the Length field.  It MUST\n         be 4 when the Pseudo\
    \ Home Address field is not present;\n         otherwise, it MUST be 20.\n   \
    \   Reserved\n         The 'A' bit, which MUST be set to one to indicate that\
    \ this is\n         a Pseudo Home Address Acknowledgement mobility option.  The\n\
    \         rest of bits MUST be set as zero by the sender and ignored by\n    \
    \     the receiver.\n      Prefix Length\n         The length of the home network\
    \ prefix of the included pseudo\n         home address.  When the Pseudo Home\
    \ Address field is not\n         present, the Prefix Length MUST be set as zero.\n\
    \      Status\n         It indicates the status of the pseudo home address\n \
    \        registration.  Values from 0 to 127 indicate success.  Higher\n     \
    \    values indicate failure.  The following values are reserved:\n          \
    \      0   Success\n                128 Failure, reason unspecified\n        \
    \        129 Administratively prohibited\n                130 Incorrect pseudo\
    \ home address\n                131 Invalid pseudo home address\n            \
    \    132 Dynamic pseudo home address assignment not available\n      Reserved\n\
    \         This field is reserved for future use.  It MUST be set to zero\n   \
    \      by the sender and ignored by the receiver.\n      Pseudo Home Address\n\
    \         If present, the field contains a pseudo home address that the\n    \
    \     home agent registers for the mobile node to use for location\n         privacy\
    \ protection.  This field is not present when the home\n         agent only needs\
    \ to indicate that it supports the location\n         privacy solutions as a response\
    \ to the query from the mobile\n         node.  The Length field is used to detect\
    \ whether the Pseudo\n         Home Address field is present in the Pseudo Home\
    \ Address\n         Acknowledgement mobility option.\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   The solutions proposed in this document address\
    \ one of the security\n   issues in the mobile environment, i.e., location privacy.\
    \  Throughout\n   the document, we provide a detailed analysis of how the proposed\n\
    \   solutions address the location privacy problem.  We carefully design\n   such\
    \ solutions to make sure that they fit well into the Mobile IPv6\n   framework;\
    \ therefore, the same threat analysis, security mechanisms\n   (such as IPsec,\
    \ the sequence number in binding signaling messages,\n   the return routability\
    \ procedure), and considerations as described in\n   RFC 3775 still apply.  Nevertheless,\
    \ in the following we provide an\n   in-depth analysis on security threats involving\
    \ the use of the\n   location privacy solutions and demonstrate that the proposed\n\
    \   solutions do not introduce any new vulnerability or weaken the\n   strength\
    \ of security protection of the original Mobile IPv6 protocol.\n"
- title: 8.1.  Home Binding Update
  contents:
  - "8.1.  Home Binding Update\n   Given the strong security of the cryptography algorithm\
    \ used to\n   generate the encrypted home address, eavesdroppers are unable to\n\
    \   derive the real home address from the encrypted home address and thus\n  \
    \ to correlate the care-of address with the real home address.\n   Moreover, the\
    \ encrypted home address can be updated to prevent\n   eavesdroppers from linking\
    \ the mobile node's ongoing activities.\n   During the pseudo home address registration,\
    \ the home agent verifies\n   that the requested pseudo home address is not in\
    \ use by other mobile\n   nodes; therefore, the other mobile node cannot, inadvertently\
    \ or\n   maliciously, intercept ongoing sessions of a victim mobile node by\n\
    \   registering the same pseudo home address.\n   A mobile node may attempt to\
    \ register a large number of pseudo home\n   addresses that may exhaust the pool\
    \ of available pseudo home\n   addresses and prevent other mobile nodes using\
    \ location privacy\n   protection.  The home agent MUST limit the number of pseudo\
    \ home\n   addresses that can be requested by a mobile node.  Also, with the\n\
    \   IPsec security association between the home agent and the mobile\n   node,\
    \ if any misuse of the pseudo home address registration is\n   detected, the home\
    \ agent can identify the malicious mobile node and\n   take further actions.\n"
- title: 8.2.  Correspondent Binding Update
  contents:
  - "8.2.  Correspondent Binding Update\n   The return routability procedure using\
    \ the pseudo home address\n   follows the same principle of the original return\
    \ routability\n   procedure, i.e., the message exchange verifies that the mobile\
    \ node\n   is reachable at both the pseudo home address and the care-of address\n\
    \   (this is because the pseudo home address is required to be routable).\n  \
    \ Furthermore, the extended return routability procedure also utilizes\n   the\
    \ same security mechanisms as defined in RFC 3775, such as the\n   nonce, the\
    \ node key, and the sequence number, to protect against\n   attacks.  Overall,\
    \ it provides the same security strength as the\n   original return routability\
    \ procedure.\n   The reverse-tunneled correspondent binding update procedure does\
    \ not\n   weaken security either.  Although the real home address is\n   transferred\
    \ in cleartext on the HA-CN path, eavesdroppers on this\n   path can already perform\
    \ more serious attacks against the mobile node\n   with the Mobile IPv6 protocol.\n"
- title: 8.3.  Route-Optimized Payload Packets
  contents:
  - "8.3.  Route-Optimized Payload Packets\n   Using the Encrypted Home Address option\
    \ in route-optimized packets\n   results in the same security implications when\
    \ the Home Address\n   option is used in such packets.  For example, the Encrypted\
    \ Home\n   Address option may be used by attackers to launch reflection attacks,\n\
    \   e.g., by indicating the IP address of a victim node in the Encrypted\n   Home\
    \ Address option.  Similar to the processing rule for the Home\n   Address option\
    \ specified in RFC 3775, this document restricts the use\n   of the Encrypted\
    \ Home Address option: it can be used only if there is\n   an established Binding\
    \ Cache entry containing the encrypted (pseudo)\n   home address.\n   With the\
    \ proposed location privacy solutions, the Encrypted Home\n   Address routing\
    \ header is used to carry the encrypted (pseudo) home\n   address.  The same threats\
    \ specified in RFC 3775 for the Type 2\n   routing header are also possible when\
    \ the routing header carries the\n   encrypted (pseudo) home address.  Similar\
    \ processing rules are also\n   used in this document to address such a threat:\
    \ if the encrypted\n   (pseudo) home address in the Encrypted Home Address routing\
    \ header\n   does not match with that stored in the Binding Update List entry,\
    \ the\n   packet will be dropped.\n"
- title: 9.  Related Work
  contents:
  - "9.  Related Work\n   Our work benefits from previous work and discussion on this\
    \ topic.\n   Similar to the concept of the pseudo home address, many documents\n\
    \   have proposed using a temporary identity to replace the mobile node's\n  \
    \ home address in the IPsec security association, Mobile IPv6 signaling\n   messages,\
    \ and data packets.  However, the details of how to generate\n   and update this\
    \ identity are absent.  In the following, we provide a\n   survey of related work.\n\
    \   RFC 4941 [10] specifies a mechanism to generate randomized interface\n   identifiers,\
    \ which can be used to update the care-of address and the\n   home address.  However,\
    \ with our solution, the prefix of a pseudo\n   home address can be different\
    \ from that of the real home address and\n   other pseudo home addresses, which\
    \ prevents eavesdroppers from\n   correlating and analyzing IP traffic based on\
    \ a common prefix.\n   Furthermore, we also discuss the interval of IP address\
    \ update in the\n   mobility scenario in order to resist the profiling attack\
    \ both\n   effectively and efficiently.\n   In [16], the authors propose using\
    \ a temporary identity, called the\n   Temporary Mobile Identifier (TMI), to replace\
    \ the home address, and\n   discussed the feasibility of utilizing the Crypto-Based\
    \ Identifier\n   (CBID), Cryptographically Generated Addresses (CGA), or Mobility\n\
    \   Anchor Point (MAP) to further protect location privacy.  However, as\n   a\
    \ 128-bit random number, the TMI is not routable; therefore, it is\n   not suitable\
    \ to be the source IP address in the Home Test Init\n   message forwarded by the\
    \ home agent to the correspondent node.\n   Otherwise, the home agent cannot receive\
    \ the Home Test message from\n   the correspondent node.  Furthermore, the document\
    \ does not specify\n   how to update the TMI to address the profiling attack.\n\
    \   In [14], the authors propose a mechanism that uses an identity as the\n  \
    \ home address and periodically updates such an identity by using a key\n   and\
    \ a previous identity as inputs to a cryptography algorithm.\n   In [15], the\
    \ authors propose to update the mobile node's home address\n   periodically to\
    \ hide its movement.  The new home address is generated\n   from the current local\
    \ network prefix, the Binding Update session\n   key, and the previous home address,\
    \ and updated every time when the\n   return routability procedure is performed.\
    \  The generated home\n   address is random, routable, recognizable, and recoverable.\n\
    \   In [18], the authors propose a mechanism to achieve both route\n   optimization\
    \ and location privacy at the same time.  This is done by\n   discovering a tunneling\
    \ agent near the correspondent node and\n   bidirectionally tunneling data traffic\
    \ between the mobile node and\n   the tunneling agent.\n"
- title: 10.  IANA Considerations
  contents:
  - "10.  IANA Considerations\n   This document creates a new registry \"Pseudo Home\
    \ Address\n   Acknowledgement Status Codes\" for the Status field in the Pseudo\
    \ Home\n   Address Acknowledgement mobility option.  The current values are\n\
    \   described in Section 7.4 and are the following:\n      0   Success\n     \
    \ 128 Failure, reason unspecified\n      129 Administratively prohibited\n   \
    \   130 Incorrect pseudo home address\n      131 Invalid pseudo home address\n\
    \      132 Dynamic pseudo home address assignment not available\n"
- title: 11.  Conclusion
  contents:
  - "11.  Conclusion\n   In this document, we have proposed solutions to address location\n\
    \   privacy issues in the context of mobility.  The main idea is to hide\n   the\
    \ binding between the home address and the care-of address from\n   eavesdroppers\
    \ and the correspondent node.  We have described two\n   methods.  The first method\
    \ extends the return routability to hide the\n   real home address in Binding\
    \ Update and data packets.  This method\n   uses the real home address in return\
    \ routability signaling, and does\n   not require any changes to the home agent.\
    \  The second method uses\n   pseudo home addresses starting from return routability\
    \ signaling, and\n   requires some extensions to the home agent operation.  This\
    \ method\n   protects revealing the real home address on the HA-CN path.  The\
    \ two\n   methods provide a means to hide the real home address from\n   eavesdroppers,\
    \ and the second method can also hide it from the\n   correspondents.\n   The\
    \ solutions we have proposed are for the basic Mobile IPv6 protocol\n   as specified\
    \ in RFC 3775.  Recently, many extensions to Mobile IPv6\n   have been proposed,\
    \ such as the NEMO Basic Support protocol [19],\n   Dual Stack Mobile IPv6 Support\
    \ [20], Multiple Care-of Addresses\n   Registration [21], Binding Revocation [22],\
    \ Generic Signaling Message\n   [23].  It is expected that the proposed location\
    \ privacy solutions\n   can be applied with some modifications, if needed, to\
    \ address\n   location privacy issues when these extensions are used.  One of\
    \ our\n   future works is to clarify related issues, if any, when the location\n\
    \   privacy solutions are used with new Mobile IPv6 extensions.\n"
- title: 12.  Acknowledgements
  contents:
  - "12.  Acknowledgements\n   The authors would like to thank the co-authors of previous\
    \ documents\n   from which this document is derived: Vijay Devarapalli, Hannu\
    \ Flinck,\n   Charlie Perkins, Feng Bao, Robert Deng, James Kempf, and Jianying\n\
    \   Zhou.  In addition, sincere appreciation is also extended to Claude\n   Castelluccia,\
    \ Francis Dupont, Gabriel Montenegro, Greg Daley, Kilian\n   Weniger, Takashi\
    \ Aramaki, Wassim Haddad, Heejin Jang, and Michael\n   Welzl for their valuable\
    \ contributions, review, and discussion.  Work\n   by Fan Zhao was done while\
    \ he was at University of California, Davis\n   and Marvell Semiconductor, Inc.\n"
- title: 13.  References
  contents:
  - '13.  References

    '
- title: 13.1.  Normative References
  contents:
  - "13.1.  Normative References\n   [1]   Bradner, S., \"Key words for use in RFCs\
    \ to Indicate Requirement\n         Levels\", BCP 14, RFC 2119, March 1997.\n\
    \   [2]   Kent, S. and K. Seo, \"Security Architecture for the Internet\n    \
    \     Protocol\", RFC 4301, December 2005.\n   [3]   Kent, S., \"IP Encapsulating\
    \ Security Payload (ESP)\", RFC 4303,\n         December 2005.\n   [4]   Kaufman,\
    \ C., \"Internet Key Exchange (IKEv2) Protocol\",\n         RFC 4306, December\
    \ 2005.\n   [5]   Deering, S. and R. Hinden, \"Internet Protocol, Version 6 (IPv6)\n\
    \         Specification\", RFC 2460, December 1998.\n   [6]   Johnson, D., Perkins,\
    \ C., and J. Arkko, \"Mobility Support in\n         IPv6\", RFC 3775, June 2004.\n\
    \   [7]   Arkko, J., Devarapalli, V., and F. Dupont, \"Using IPsec to\n      \
    \   Protect Mobile IPv6 Signaling Between Mobile Nodes and Home\n         Agents\"\
    , RFC 3776, June 2004.\n   [8]   Devarapalli, V. and F. Dupont, \"Mobile IPv6\
    \ Operation with\n         IKEv2 and the revised IPsec Architecture\", RFC 4877,\n\
    \         April 2007.\n   [9]   Hinden, R. and S. Deering, \"IP Version 6 Addressing\n\
    \         Architecture\", RFC 4291, February 2006.\n   [10]  Narten, T., Draves,\
    \ R., and S. Krishnan, \"Privacy Extensions\n         for Stateless Address Autoconfiguration\
    \ in IPv6\", RFC 4941,\n         September 2007.\n   [11]  Koodli, R., \"IP Address\
    \ Location Privacy and Mobile IPv6:\n         Problem Statement\", RFC 4882, March\
    \ 2007.\n   [12]  Fenner, B., \"Experimental Values in IPv4, IPv6, ICMPv4, ICMPv6,\n\
    \         UDP, and TCP Headers\", RFC 4727, November 2006.\n   [13]  Devarapalli,\
    \ V., \"Mobile IPv6 Experimental Messages\", RFC 5096,\n         December 2007.\n"
- title: 13.2.  Informative References
  contents:
  - "13.2.  Informative References\n   [14]  Bao, F., Deng, R., Kempf, J., Qiu, Y.,\
    \ and J. Zhou, \"Protocol\n         for Protecting Movement of Mobile Nodes in\
    \ Mobile IPv6\", Work\n         in Progress, March 2005.\n   [15]  Bao, F., Deng,\
    \ R., Kempf, J., Qiu, Y., and J. Zhou, \"Protocol\n         for Hiding Movement\
    \ of Mobile Nodes in Mobile IPv6\", Work\n         in Progress, March 2005.\n\
    \   [16]  Castelluccia, C., Dupont, F., and G. Montenegro, \"A Simple\n      \
    \   Privacy Extension for Mobile IPv6\", Work in Progress,\n         July 2006.\n\
    \   [17]  Daley, G., \"Location Privacy and Mobile IPv6\", Work\n         in Progress,\
    \ January 2004.\n   [18]  Weniger, K. and T. Aramaki, \"Route Optimization and\
    \ Location\n         Privacy using Tunneling Agents (ROTA)\", Work in Progress,\n\
    \         October 2005.\n   [19]  Devarapalli, V., Wakikawa, R., Petrescu, A.,\
    \ and P. Thubert,\n         \"Network Mobility (NEMO) Basic Support Protocol\"\
    , RFC 3963,\n         January 2005.\n   [20]  Soliman, H., \"Mobile IPv6 Support\
    \ for Dual Stack Hosts and\n         Routers\", RFC 5555, June 2009.\n   [21]\
    \  Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T., and K.\n         Nagami,\
    \ \"Multiple Care-of Addresses Registration\", RFC 5648,\n         October 2009.\n\
    \   [22]  Muhanna, A., Khalil, M., Gundavelli, S., Chowdhury, K., and P.\n   \
    \      Yegani, \"Binding Revocation for IPv6 Mobility\", Work\n         in Progress,\
    \ October 2009.\n   [23]  Haley, B. and S. Gundavelli, \"Mobile IPv6 Generic Signaling\n\
    \         Message\", Work in Progress, August 2008.\n"
- title: 'Appendix A.  Profiling Attack: Discussion'
  contents:
  - "Appendix A.  Profiling Attack: Discussion\n   Profiling attacks pose a significant\
    \ threat to user privacy.  By\n   collecting and analyzing (either online or offline)\
    \ IP traffic,\n   attackers can obtain sensitive user information.  In the context\
    \ of\n   mobility, although the profiling attack does not directly lead to\n \
    \  compromise of location privacy in the way the disclosure of the\n   binding\
    \ between the home address and the care-of address does,\n   attackers can infer\
    \ the mobile node's roaming and track its movement\n   (i.e., handover) by profiling\
    \ the mobile node's communication based\n   on certain fields in IP packets, such\
    \ as a constant IPsec SPI used\n   during the home registration.  The more information\
    \ collected, the\n   higher probability location privacy is compromised, which\
    \ in return\n   results in more targeted profiling.\n   We have taken the profiling\
    \ problem into consideration when designing\n   the solution to IP address location\
    \ privacy; however, not all aspects\n   of profiling attacks are addressed since\
    \ the profiling problem spans\n   multiple protocol layers.  In the following,\
    \ we provide a broad\n   discussion on the profiling attack and protection mechanisms.\
    \  Our\n   discussion is organized based on how profiling attacks can be\n   performed.\
    \  Note that the following sections are not sorted based on\n   any criteria or\
    \ may not exhaustively list all the possible attack\n   means (for example, profiling\
    \ attacks based on upper-layer payloads\n   in data packets are not discussed).\n"
- title: A.1.  The Care-of Address
  contents:
  - "A.1.  The Care-of Address\n   Eavesdroppers on the MN-HA path and/or the MN-CN\
    \ path can profile the\n   mobile node's communication by collecting packets with\
    \ the same\n   care-of address.  It is recommended that the mobile node periodically\n\
    \   updates its care-of address by using DHCPv6 or IPv6 address privacy\n   extension,\
    \ even if it does not change its current attachment point.\n   Furthermore, it\
    \ is even better to change the network prefix of the\n   care-of address periodically,\
    \ since eavesdroppers may profile IP\n   packets based on the common network prefix.\n\
    \   Since the binding update procedure needs to be performed once the\n   care-of\
    \ address is changed, in order to reduce signaling overheads,\n   the mobile node\
    \ may choose to change its care-of address when the\n   Binding Cache entry at\
    \ the home agent or the correspondent node is\n   about to expire.\n"
- title: A.2.  Profiling on the Encrypted Home Address
  contents:
  - "A.2.  Profiling on the Encrypted Home Address\n   Generated from either a real\
    \ or pseudo home address, the encrypted\n   home address can be dynamically updated,\
    \ because a new key is\n   generated when a new round of the return routability\
    \ procedure is\n   performed, which makes the encrypted home address look different\
    \ in\n   subsequent Binding Update and Acknowledgement messages.\n   Nevertheless,\
    \ the same encrypted home address is used in payload\n   packets forwarded via\
    \ the optimized route before the next round of\n   the return routability procedure.\
    \  Given the cost and overhead of\n   updating the encrypted home address, the\
    \ proposed location privacy\n   solutions still provide a reasonable level of\
    \ protection against such\n   profiling attacks.\n"
- title: A.3.  The IPsec SPI
  contents:
  - "A.3.  The IPsec SPI\n   Eavesdroppers on the MN-HA path can profile the mobile\
    \ node's\n   communication based on the SPI of an IPsec security association that\n\
    \   is for protecting the home Binding Update and Acknowledgement message\n  \
    \ or for protecting bidirectional-tunneled payload packets.\n   To resist this\
    \ kind of profiling attack, the IPsec SPI needs to be\n   periodically updated.\
    \  One way is that the mobile node and the home\n   agent rekey the IPsec security\
    \ association or perform re-\n   authentication periodically.  This may result\
    \ in more signaling\n   overhead.  Another way is that the mobile node or the\
    \ home agent\n   generates a new SPI and then notifies each other by exchanging\
    \ the\n   Binding Update and Acknowledgement messages protected by an existing\n\
    \   IPsec security association with a non-null encryption algorithm.  In\n   this\
    \ way, the information of the new SPI is hidden from\n   eavesdroppers.  The new\
    \ SPI MUST not conflict with other existing\n   SPIs; and if the conflict is detected\
    \ on one end point, another SPI\n   MUST be generated and be synchronized with\
    \ the other end point.  The\n   new SPI is applied to the next packet that needs\
    \ to be protected by\n   this IPsec security association.  This solution requires\
    \ close\n   interaction between Mobile IP and IPsec.  For example, when the home\n\
    \   agent receives a new SPI suggested by the mobile node, it needs to\n   change\
    \ the corresponding Security Association Database (SAD) entry.\n"
- title: A.4.  The IPsec Sequence Number
  contents:
  - "A.4.  The IPsec Sequence Number\n   The IPsec sequence number is required to\
    \ be larger than that in the\n   previous valid IPsec packet if the anti-replay\
    \ service is enabled.\n   However, if the increment of the IPsec sequence number\
    \ is fixed (for\n   example, the IPsec sequence number is sequentially increased),\
    \ it is\n   possible for eavesdroppers to identify a sequence of IPsec packets\n\
    \   that are from/to the same mobile node and to track the mobile node's\n   activities.\
    \  One possible solution is to randomize the increment of\n   the IPsec sequence\
    \ number on both end points (i.e., the mobile node\n   and the home agent) of\
    \ the IPsec security association.  The algorithm\n   to generate randomness is\
    \ implementation specific.  It can be, for\n   example, any random number generator,\
    \ and independently chosen by\n   each end point.\n"
- title: A.5.  The Regular Interval of Signaling Messages
  contents:
  - "A.5.  The Regular Interval of Signaling Messages\n   As described in RFC 3775,\
    \ certain signaling messages may be exchanged\n   on a regular basis.  For example,\
    \ the correspondent registration\n   needs to be performed every MAX_RR_BINDING_LIFETIME\
    \ seconds and the\n   home binding update procedure needs to be performed regularly,\
    \ if the\n   lifetime of the home Binding Cache entry is fixed.  Such timing\n\
    \   allows eavesdroppers to perform traffic analyses and correlate\n   different\
    \ messages.  Due to background traffic and routing dynamics,\n   the timing of\
    \ messages observed by an eavesdropper at a certain\n   vantage point may be irregular.\
    \  Nevertheless, a better solution is\n   to randomize the lifetime of the Binding\
    \ Cache entry in the home\n   agent and the correspondent node.\n"
- title: A.6.  The Sequence Number in the Binding Update Message
  contents:
  - "A.6.  The Sequence Number in the Binding Update Message\n   RFC 3775 requires\
    \ that the sequence number in the Binding Update\n   message be larger than that\
    \ in the previous valid Binding Update\n   message for a particular mobile node.\
    \  However, if the increment of\n   the sequence number in the home or correspondent\
    \ Binding Update\n   message is fixed (for example, the sequence number is sequentially\n\
    \   increased), it is possible for eavesdroppers on the MN-HA or MN-CN\n   path\
    \ to identify a sequence of Binding Update messages that are from\n   the same\
    \ mobile node and to track the mobile node's movement.  One\n   possible solution\
    \ is that the mobile node randomizes the increment of\n   the sequence number\
    \ used in subsequent Binding Update messages.  The\n   algorithm to generate randomness\
    \ is implementation specific.  It can\n   be, for example, any random number generator.\
    \  Note that such an\n   algorithm is not needed when the sequence number is encrypted,\
    \ for\n   example, when the home Binding Update message is protected by an\n \
    \  IPsec tunnel mode security association.\n"
- title: A.7.  Multiple Concurrent Sessions
  contents:
  - "A.7.  Multiple Concurrent Sessions\n   It is possible for (colluded) eavesdroppers\
    \ to correlate the mobile\n   node's different sessions with the same or different\
    \ correspondent\n   nodes, for example, based on the same pseudo home address\
    \ and/or the\n   same care-of address.  A possible solution is to use different\
    \ pseudo\n   home addresses and different care-of addresses in different sessions.\n\
    \   Note that the mobile node may also use the same pseudo home address\n   with\
    \ different correspondent nodes, if the pseudo home address is\n   masked by different\
    \ privacy management keys generated during the\n   return routability procedure\
    \ with different correspondent nodes.  In\n   this way, the encrypted pseudo home\
    \ addresses used with different\n   correspondent nodes look different to eavesdroppers.\n"
- title: A.8.  Summary
  contents:
  - "A.8.  Summary\n   As discussed above, there exist multiple means for eavesdroppers\
    \ to\n   correlate observed activities.  For example, some IP fields, which\n\
    \   contain certain constant values and remain unchanged for a long time,\n  \
    \ allow eavesdroppers to identify and link the mobile node's activities\n   deterministically.\
    \  Other means may be less reliable when used for\n   traffic analysis and correlation;\
    \ nevertheless, they provide\n   additional hints to malicious attackers.\n  \
    \ The solution to the profiling attack is to update certain IP fields\n   periodically.\
    \  Generally, the more frequently, the higher the\n   probability that the profiling\
    \ attack is resisted and also the higher\n   the cost in terms of communication\
    \ and processing overheads and\n   complexity.  As eavesdroppers can profile activities\
    \ based on\n   multiple fields, it may not be cost-effective to update some fields\n\
    \   more frequently than others.  Furthermore, it may reduce some\n   overheads,\
    \ if all the related IP fields are updated together with the\n   same frequency.\n\
    \   The profiling attack is a complicated issue.  A complete solution\n   would\
    \ have to consider tradeoffs of many different factors, such as\n   complexity,\
    \ effectiveness, and efficiency.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Ying Qiu\n   Institute for Infocomm Research, Singapore\n\
    \   1 Fusionopolis Way\n   #21-01 Connexis (South Tower)\n   Singapore  138632\n\
    \   Phone: +65-6408 2053\n   EMail: qiuying@i2r.a-star.edu.sg\n   Fan Zhao (editor)\n\
    \   Google Inc.\n   1600 Amphitheatre Parkway\n   Mountain View, CA  94043\n \
    \  US\n   EMail: fanzhao@google.com\n   Rajeev Koodli\n   Cisco Systems\n   EMail:\
    \ rkoodli@cisco.com\n"
