- title: __initial_text__
  contents:
  - '    Security Threats for the Neighborhood Discovery Protocol (NHDP)

    '
- title: Abstract
  contents:
  - "Abstract\n   This document analyzes common security threats of the Neighborhood\n\
    \   Discovery Protocol (NHDP) and describes their potential impacts on\n   Mobile\
    \ Ad Hoc Network (MANET) routing protocols using NHDP.  This\n   document is not\
    \ intended to propose solutions to the threats\n   described.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7186.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2014 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   3\n   2.  Terminology . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .   4\n   3.  NHDP Threat Overview  . . . . . . . . . . . . . . . . .\
    \ . . .   4\n   4.  Detailed Threat Description . . . . . . . . . . . . . . .\
    \ . .   5\n     4.1.  Jamming . . . . . . . . . . . . . . . . . . . . . . . .\
    \ .   5\n     4.2.  Denial-of-Service Attack  . . . . . . . . . . . . . . . .\
    \   5\n     4.3.  Eavesdropping and Traffic Analysis  . . . . . . . . . . .  \
    \ 6\n     4.4.  Incorrect HELLO Message Generation  . . . . . . . . . . .   7\n\
    \       4.4.1.  Identity Spoofing . . . . . . . . . . . . . . . . . .   7\n  \
    \     4.4.2.  Link Spoofing . . . . . . . . . . . . . . . . . . . .   8\n    \
    \ 4.5.  Replay Attack . . . . . . . . . . . . . . . . . . . . . .   9\n     4.6.\
    \  Message Timing Attacks  . . . . . . . . . . . . . . . . .   9\n       4.6.1.\
    \  Interval Time Attack  . . . . . . . . . . . . . . . .  10\n       4.6.2.  Validity\
    \ Time Attack  . . . . . . . . . . . . . . . .  10\n     4.7.  Indirect Channel\
    \ Overloading  . . . . . . . . . . . . . .  10\n     4.8.  Attack on Link Quality\
    \ Update . . . . . . . . . . . . . .  11\n   5.  Impact of Inconsistent Information\
    \ Bases on Protocols using\n       NHDP  . . . . . . . . . . . . . . . . . . .\
    \ . . . . . . . . .  12\n     5.1.  MPR Calculation . . . . . . . . . . . . .\
    \ . . . . . . . .  12\n       5.1.1.  Flooding Disruption due to Identity Spoofing\
    \  . . . .  12\n       5.1.2.  Flooding Disruption due to Link Spoofing  . . .\
    \ . . .  13\n       5.1.3.  Broadcast Storm . . . . . . . . . . . . . . . . .\
    \ . .  14\n     5.2.  Routing Loops . . . . . . . . . . . . . . . . . . . . .\
    \ .  15\n     5.3.  Invalid or Nonexistent Paths to Destinations  . . . . . .\
    \  16\n     5.4.  Data Sinkhole . . . . . . . . . . . . . . . . . . . . . .  16\n\
    \   6.  Future Work . . . . . . . . . . . . . . . . . . . . . . . . .  16\n  \
    \ 7.  Security Considerations . . . . . . . . . . . . . . . . . . .  17\n   8.\
    \  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  18\n   9.  References\
    \  . . . . . . . . . . . . . . . . . . . . . . . . .  18\n     9.1.  Normative\
    \ References  . . . . . . . . . . . . . . . . . .  18\n     9.2.  Informative\
    \ References  . . . . . . . . . . . . . . . . .  18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The Neighborhood Discovery Protocol (NHDP) [RFC6130] allows\
    \ routers\n   to acquire topological information up to two hops away from\n  \
    \ themselves, by way of periodic HELLO message exchanges.  The\n   information\
    \ acquired by NHDP is used by other protocols, such as the\n   Optimized Link\
    \ State Routing Protocol version 2 (OLSRv2) [RFC7181]\n   and Simplified Multicast\
    \ Forwarding (SMF) [RFC6621].  The topology\n   information, acquired by way of\
    \ NHDP, serves these routing protocols\n   by detecting and maintaining local\
    \ 1-hop and 2-hop neighborhood\n   information.\n   As NHDP is typically used\
    \ in wireless environments, it is potentially\n   exposed to different kinds of\
    \ security threats, some of which are of\n   particular significance as compared\
    \ to wired networks.  As radio\n   signals can be received as well as transmitted\
    \ by any compatible\n   wireless device within radio range, there is commonly\
    \ no physical\n   protection as otherwise known for wired networks.  NHDP does\
    \ not\n   define any explicit security measures for protecting the integrity of\n\
    \   the information it acquires; however, it suggests that the integrity\n   protection\
    \ be addressed in a fashion appropriate to the deployment of\n   the network.\n\
    \   This document is based on the assumption that no additional security\n   mechanism\
    \ such as IPsec is used in the IP layer, as not all MANET\n   deployments may\
    \ be able to accommodate such common IP protection\n   mechanisms (e.g., because\
    \ of limited resources of MANET routers).\n   The document analyzes possible attacks\
    \ on and misconfigurations of\n   NHDP and outlines the consequences of such attacks/misconfigurations\n\
    \   to the state maintained by NHDP in each router (and, thus, made\n   available\
    \ to protocols using this state).\n   This document is not intended to propose\
    \ solutions to the threats\n   described.  [RFC7185] provides further information\
    \ on how to enable\n   integrity protection to NHDP, which can help mitigating\
    \ the threats\n   described related to identity spoofing.\n   It should be noted\
    \ that many NHDP implementations are configurable,\n   and so an attack on the\
    \ configuration system (such as [RFC6779]) can\n   be used to adversely affect\
    \ the operation of an NHDP implementation.\n   The NHDP MIB module [RFC6779] might\
    \ help monitoring some of the\n   security attacks mentioned in this document.\
    \  [MGMT-SNAP] provides a\n   snapshot of OLSRv2-routed MANET management as currently\
    \ deployed,\n   while [MANET-MGMT] is intended to provide specific guidelines\
    \ on\n   MANET network management considering the various MIB modules that\n \
    \  have been written.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   This document uses the terminology and notation defined in\n\
    \   \"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format\"\n   [RFC5444],\
    \ \"Mobile Ad Hoc Network (MANET) Neighborhood Discovery\n   Protocol (NHDP)\"\
    \ [RFC6130], and \"Internet Security Glossary, Version\n   2\" [RFC4949].\n  \
    \ Additionally, this document introduces the following terminology:\n   NHDP router:\
    \  A MANET router, running NHDP as specified in [RFC6130].\n   Attacker:  A device\
    \ that is present in the network and intentionally\n      seeks to compromise\
    \ the information bases in NHDP routers.\n   Compromised NHDP router:  An attacker\
    \ that is present in the network\n      and generates syntactically correct NHDP\
    \ control messages.\n      Control messages emitted by a compromised NHDP router\
    \ may contain\n      additional information, or omit information, as compared\
    \ to a\n      control message generated by a non-compromised NHDP router located\n\
    \      in the same topological position in the network.\n   Legitimate NHDP router:\
    \  An NHDP router that is not a compromised\n      NHDP router.\n"
- title: 3.  NHDP Threat Overview
  contents:
  - "3.  NHDP Threat Overview\n   NHDP defines a HELLO messages exchange, enabling\
    \ each NHDP router to\n   acquire topological information describing its 1-hop\
    \ and 2-hop\n   neighbors, and specifies information bases for recording this\n\
    \   information.\n   An NHDP router periodically transmits HELLO messages using\
    \ a link-\n   local multicast on each of its interfaces with a hop-limit of 1\n\
    \   (i.e., HELLOs are never forwarded).  In these HELLO messages, an NHDP\n  \
    \ router announces the IP addresses as heard, symmetric, or lost\n   neighbor\
    \ interface addresses.\n   An Attacker has several ways of harming this neighbor\
    \ discovery\n   process: it can announce \"wrong\" information about its identity,\n\
    \   postulate nonexistent links, and replay HELLO messages.  These\n   attacks\
    \ are presented in detail in Section 4.\n   The different ways of attacking an\
    \ NHDP deployment may eventually\n   lead to inconsistent information bases, not\
    \ accurately reflecting the\n   correct topology of the MANET.  The consequence\
    \ is that protocols\n   using NHDP will base their operation on incorrect information,\n\
    \   causing routing protocols to not be able to calculate correct (or\n   any)\
    \ paths, degrade the performance of flooding operations based on\n   reduced relay\
    \ sets, etc.  These consequences to protocols using NHDP\n   are described in\
    \ detail in Section 5.\n"
- title: 4.  Detailed Threat Description
  contents:
  - "4.  Detailed Threat Description\n   For each threat, a description of the mechanism\
    \ of the corresponding\n   attack is given, followed by a description of how the\
    \ attack affects\n   NHDP.  The impacts from each attack on protocols using NHDP\
    \ are given\n   in Section 5.\n   For simplicity in the description, the examples\
    \ given assume that\n   NHDP routers have a single interface with a single IP\
    \ address\n   configured.  All the attacks apply, however, for NHDP routers with\n\
    \   multiple interfaces and multiple addresses as well.\n"
- title: 4.1.  Jamming
  contents:
  - "4.1.  Jamming\n   One vulnerability, common for all protocols operating a wireless\
    \ ad\n   hoc network, is that of \"jamming\", i.e., that a device generates\n\
    \   massive amounts of interfering radio transmissions, which will\n   prevent\
    \ legitimate traffic (e.g., control traffic as well as data\n   traffic) on part\
    \ of a network.  Jamming is a form of interference and\n   overload with the threat\
    \ consequence of disruption [RFC4593].\n   Depending on lower layers, this may\
    \ not affect transmissions: HELLO\n   messages from an NHDP router with \"jammed\"\
    \ interfaces may be received\n   by other NHDP routers.  As NHDP identifies whether\
    \ a link to a\n   neighbor is unidirectional or bidirectional, a routing protocol\
    \ that\n   uses NHDP for neighborhood discovery may ignore a link from a jammed\n\
    \   NHDP router to a non-jammed NHDP router.  The jammed router (a router\n  \
    \ with jammed carrier) would appear simply as \"disconnected\" for the\n   unjammed\
    \ part of the network, which is able to maintain accurate\n   topology maps.\n\
    \   If a considerable amount of HELLO messages are lost or corrupted due\n   to\
    \ collisions caused by a jamming attack, neighbor NHDP routers are\n   not able\
    \ to establish links between themselves any more.  Thus, NHDP\n   will present\
    \ empty information bases to the protocols using it.\n"
- title: 4.2.  Denial-of-Service Attack
  contents:
  - "4.2.  Denial-of-Service Attack\n   A denial-of-service (DoS) attack can be a\
    \ result of misconfiguration\n   of legitimate NHDP routers (e.g., very short\
    \ HELLO transmission\n   interval) or malicious behavior of compromised NHDP routers\n\
    \   [ACCT2012], so-called Byzantine routers [RFC4593].  DoS is a form of\n   interference\
    \ and overload with the threat consequence of disruption\n   [RFC4593].\n   By\
    \ transmitting a huge amount of HELLO messages in a short period of\n   time,\
    \ NHDP routers can increase channel occupation as described in\n   Section 4.1.\
    \  Furthermore, a compromised NHDP router can spoof a\n   large amount of different\
    \ IP addresses and send HELLOs to its\n   neighbors to fill their Link/Neighbor\
    \ Sets.  This may result in\n   memory overflow, and it makes the processing of\
    \ legitimate HELLO\n   messages impossible.  A compromised NHDP router can also\
    \ use link\n   spoofing in its HELLO messages, generating huge 2-hop Sets in\n\
    \   adjacent NHDP routers and therefore potentially a memory overflow.\n   Moreover,\
    \ protocols such as SMF and OLSRv2, using the 2-hop\n   information for multipoint\
    \ relay (MPR) calculation, may exhaust the\n   available computational resources\
    \ of the router if the Neighbor Set\n   and 2-hop Sets have too many entries.\n\
    \   By exhausting the memory, CPU, and/or channel resources of a router\n   in\
    \ a DoS attack or a misconfiguration, NHDP routers may not be able\n   to accomplish\
    \ their specified tasks of exchanging 1-hop and 2-hop\n   neighborhood information,\
    \ and thereby disturbing the operation of\n   routing protocols using NHDP.\n\
    \   In some MANETs, the routers are powered by battery.  Another\n   consequence\
    \ of a DoS attack in such networks is that the power will\n   be drained quickly\
    \ by unnecessary processing, transmitting, and\n   receiving of messages.\n"
- title: 4.3.  Eavesdropping and Traffic Analysis
  contents:
  - "4.3.  Eavesdropping and Traffic Analysis\n   Eavesdropping, sometimes referred\
    \ to as sniffing, is a common and\n   easy passive attack in a wireless environment.\
    \  Once a packet is\n   transmitted, any adjacent NHDP router can potentially\
    \ obtain a copy,\n   for immediate or later processing.  Neither the source nor\
    \ the\n   intended destination can detect this.  A malicious NHDP router can\n\
    \   eavesdrop on the NHDP message exchange and thus learn the local\n   topology.\
    \  It may also eavesdrop on data traffic to learn source and\n   destination addresses\
    \ of data packets, or other header information,\n   as well as the packet payload.\n\
    \   Eavesdropping does not pose a direct threat to the network or to\n   NHDP,\
    \ in as much as that it does not alter the information recorded\n   by NHDP in\
    \ its information bases and presented to other protocols.\n   However, eavesdropping\
    \ can provide network information required for\n   enabling other attacks, such\
    \ as the identity of communicating NHDP\n   routers, detection of link characteristics,\
    \ and NHDP router\n   configuration.  The compromised NHDP routers may use the\
    \ obtained\n   information to launch subsequent attacks, and they may also share\n\
    \   NHDP routing information with other NHDP or non-NHDP entities.\n   [RFC4593]\
    \ would categorize the threat consequence as disclosure.\n   Traffic analysis\
    \ normally follows eavesdropping, which is the process\n   of intercepting messages\
    \ in order to deduce information from\n   communication patterns.  It can be performed\
    \ even when HELLO messages\n   are encrypted (encryption is not a part of NHDP),\
    \ for example:\n   o  Triggered HELLO messages: an attacker could figure out that\n\
    \      messages are triggered and determine that there was a change of\n     \
    \ symmetric neighbors of an NHDP router sending the HELLO (as well\n      get\
    \ the frequency).\n   o  Message size: the message grows exactly by x bytes per\
    \ neighbor.\n      Depending on which cipher is used for the encryption, some\n\
    \      information about the size could be inferred, and thus the number\n   \
    \   of neighbors could be guessed.\n   [RFC4593] would categorize the threat consequence\
    \ as disclosure.\n"
- title: 4.4.  Incorrect HELLO Message Generation
  contents:
  - "4.4.  Incorrect HELLO Message Generation\n   An NHDP router performs two distinct\
    \ tasks: it periodically generates\n   HELLO messages, and it processes incoming\
    \ HELLO messages from\n   neighbor NHDP routers.  This section describes security\
    \ attacks\n   involving the HELLO generation.\n"
- title: 4.4.1.  Identity Spoofing
  contents:
  - "4.4.1.  Identity Spoofing\n   Identity spoofing implies that a compromised NHDP\
    \ router sends HELLO\n   messages, pretending to have the identity of another\
    \ NHDP router, or\n   even a router that does not exist in the networks.  A compromised\n\
    \   NHDP router can accomplish this by using an IP address, which is not\n   its\
    \ own, in an address block of a HELLO message, and associating this\n   address\
    \ with a LOCAL_IF Address Block TLV [IJNSIA2010].\n   An NHDP router receiving\
    \ that HELLO message from a neighbor will\n   assume that it originated from the\
    \ NHDP router with the spoofed\n   interface address.  As a consequence, it will\
    \ add a Link Tuple to\n   that neighbor with the spoofed address, and include\
    \ it in its next\n   HELLO messages as a heard neighbor (and possibly as a symmetric\n\
    \   neighbor after another HELLO exchange).\n   Identity spoofing is particularly\
    \ harmful if a compromised NHDP\n   router spoofs the identity of another NHDP\
    \ router that exists in the\n   same routing domain.  With respect to NHDP, such\
    \ a duplicated,\n   spoofed address can lead to an inconsistent state up to two\
    \ hops from\n   an NHDP router.  [RFC4593] would categorize the threat consequences\n\
    \   as disclosure and deception.\n   Figure 1 depicts a simple example.  In that\
    \ example, NHDP router A is\n   in radio range of NHDP router C, but not of the\
    \ compromised NHDP\n   router X.  If X spoofs the address of A, that can lead\
    \ to conflicts\n   for a routing protocol that uses NHDP, and therefore for wrong\
    \ path\n   calculations as well as incorrect data traffic forwarding.\n   .---.\
    \    .---.    .---.\n   | A |----| C |----| X |\n   '---'    '---'    '---'\n\
    \                                 Figure 1\n   Figure 2 depicts another example.\
    \  In this example, NHDP router A is\n   two hops away from NHDP router C, reachable\
    \ through NHDP router B.\n   If the compromised NHDP router X spoofs the address\
    \ of A, NHDP router\n   D will take A as its 1-hop neighbor, and C may think that\
    \ A is indeed\n   reachable through D.\n   .---.    .---.    .---.    .---.  \
    \  .---.\n   | A |----| B |----| C |----| D |----| X |\n   '---'    '---'    '---'\
    \    '---'    '---'\n                                 Figure 2\n"
- title: 4.4.2.  Link Spoofing
  contents:
  - "4.4.2.  Link Spoofing\n   Similar to identity spoofing, link spoofing implies\
    \ that a\n   compromised NHDP router sends HELLO messages, signaling an incorrect\n\
    \   set of neighbors.  This is sometimes referred to as falsification\n   [RFC4593],\
    \ and in NHDP it may take either of two forms:\n   o  A compromised NHDP router\
    \ can postulate addresses of non-present\n      neighbor NHDP routers in an address\
    \ block of a HELLO, associated\n      with LINK_STATUS TLVs.\n   o  A compromised\
    \ NHDP router can \"ignore\" otherwise existing\n      neighbors by not advertising\
    \ them in its HELLO messages.\n   The effect of link spoofing with respect to\
    \ NHDP are twofold,\n   depending on the two cases mentioned above:\n   o  If\
    \ the compromised NHDP router ignores existing neighbors in its\n      advertisements,\
    \ links will be missing in the information bases\n      maintained by other routers,\
    \ and there may not be any connectivity\n      for these NHDP routers to or from\
    \ other NHDP routers in the MANET.\n   o  On the other hand, if the compromised\
    \ NHDP router advertises\n      nonexistent links, this will lead to inclusion\
    \ of topological\n      information in the information base, describing nonexistent\
    \ links\n      in the network (which, then, may be used by other protocols using\n\
    \      NHDP in place of other, existing, links).\n   [RFC4593] would categorize\
    \ the threat consequences as usurpation,\n   deception, and disruption.\n"
- title: 4.5.  Replay Attack
  contents:
  - "4.5.  Replay Attack\n   A replay attack implies that control traffic from one\
    \ region of the\n   network is recorded and replayed in a different region at\
    \ (almost)\n   the same time, or in the same region at a different time.  This\
    \ may,\n   for example, happen when two compromised NHDP routers collaborate on\n\
    \   an attack, one recording traffic in its proximity and tunneling it to\n  \
    \ the other compromised NHDP router, which replays the traffic.  In a\n   protocol\
    \ where links are discovered by testing reception, this will\n   result in extraneous\
    \ link creation (basically, a \"virtual\" link\n   between the two compromised\
    \ NHDP routers will appear in the\n   information bases of neighboring NHDP routers).\
    \  [RFC4593] would\n   categorize this as a falsification and interference threat\
    \ with\n   threat consequences of usurpation, deception, and disruption.\n   While\
    \ this situation may result from an attack, it may also be\n   intentional: if\
    \ data traffic is also relayed over the \"virtual\" link,\n   the link being detected\
    \ is indeed valid for use.  This is, for\n   instance, used in wireless repeaters.\
    \  If data traffic is not carried\n   over the virtual link, an imaginary, useless\
    \ link between the two\n   compromised NHDP routers has been advertised and is\
    \ being recorded in\n   the information bases of their neighboring NHDP routers.\n\
    \   Compared to incorrect HELLO message attacks described in Section 4.4,\n  \
    \ the messages used in replay attacks are legitimate messages sent out\n   by\
    \ (non-malicious) NHDP routers and replayed at a later time or\n   different locality\
    \ by malicious routers.  This makes this kind of\n   attack harder to be detect\
    \ and to counteract; integrity checks cannot\n   help in this case, as the original\
    \ message's Integrity Check Value\n   (ICV) was correctly calculated.\n"
- title: 4.6.  Message Timing Attacks
  contents:
  - "4.6.  Message Timing Attacks\n   In NHDP, each HELLO message contains a \"validity\
    \ time\" (the amount of\n   time that information in that control message should\
    \ be considered\n   valid before being discarded) and may contain an \"interval\
    \ time\"\n   field (the amount of time until the next control message of the same\n\
    \   type should be expected) [RFC5497].\n"
- title: 4.6.1.  Interval Time Attack
  contents:
  - "4.6.1.  Interval Time Attack\n   A use of the expected interval between two successive\
    \ HELLO messages\n   is for determining the link quality in NHDP: if messages\
    \ are not\n   received within the expected intervals (e.g., a certain fraction\
    \ of\n   messages are missing), then this may be used to exclude a link from\n\
    \   being considered as useful, even if (some) bidirectional\n   communication\
    \ has been verified.  If a compromised NHDP router X\n   spoofs the identity of\
    \ an existing NHDP router A and sends HELLOs\n   indicating a low interval time,\
    \ an NHDP router B receiving this HELLO\n   will expect the following HELLO to\
    \ arrive within the interval time\n   indicated.  If that expectation is not met,\
    \ the link quality for the\n   link A-B will be decreased.  Thus, X may cause\
    \ NHDP router B's\n   estimate of the link quality for the link A-B to fall below\
    \ the\n   minimum considered useful, so the link would not be used\n   [CPSCOM2011].\
    \  [RFC4593] would categorize the threat consequence as\n   usurpation.\n"
- title: 4.6.2.  Validity Time Attack
  contents:
  - "4.6.2.  Validity Time Attack\n   A compromised NHDP router X can spoof the identity\
    \ of an NHDP router\n   A and send a HELLO using a low validity time (e.g., 1\
    \ ms).  A\n   receiving NHDP router B will discard the information upon expiration\n\
    \   of that interval, i.e., a link between NHDP router A and B will be\n   \"\
    torn down\" by X.  The sending of a low validity time can be caused\n   by intended\
    \ malicious behaviors or simply misconfiguration in the\n   NHDP routers.  [RFC4593]\
    \ would categorize the threat consequence as\n   usurpation.\n"
- title: 4.7.  Indirect Channel Overloading
  contents:
  - "4.7.  Indirect Channel Overloading\n   Indirect Channel Overloading is when a\
    \ compromised NHDP router X by\n   its actions causes other legitimate NHDP routers\
    \ to generate\n   inordinate amounts of control traffic.  This increases channel\n\
    \   occupation and the overhead in each receiving NHDP router that\n   processes\
    \ this control traffic.  With this traffic originating from\n   legitimate NHDP\
    \ routers, the malicious device may remain undetected\n   in the wider network.\
    \  It is a form of interference and overload with\n   the threat consequence of\
    \ disruption [RFC4593].\n   Figure 3 illustrates Indirect Channel Overloading\
    \ with NHDP.  A\n   compromised NHDP router X advertises a symmetric spoofed link\
    \ to the\n   nonexistent NHDP router B (at time t0).  Router A selects X as MPR\n\
    \   upon reception of the HELLO then triggers a HELLO at t1.  Overhearing\n  \
    \ this triggered HELLO, the attacker sends another HELLO at t2,\n   advertising\
    \ the link to B as lost; this causes NHDP router A to\n   deselect the attacker\
    \ as MPR, and to send another triggered message\n   at t3.  The cycle may be repeated,\
    \ where the link X-B is advertised\n   alternately as LOST and SYM.\n        \
    \        MPRs(X)                   MPRs()\n   .---.        .---.        .---.\
    \        .---.\n   | A |        | A |        | A |        | A |\n   '---'    \
    \    '---'        '---'        '---'\n     |            |            |       \
    \     |\n     | SYM(B)     |            | LOST(B)    |\n     |            |  \
    \          |            |\n   .---.        .---.        .---.        .---.\n \
    \  | X |        | X |        | X |        | X |\n   '---'        '---'       \
    \ '---'        '---'\n     .            .\n     .            .\n     .       \
    \     .\n   .....        .....\n   . B .        . B .\n   .....        .....\n\
    \    t0           t1           t2           t3\n                             \
    \    Figure 3\n"
- title: 4.8.  Attack on Link Quality Update
  contents:
  - "4.8.  Attack on Link Quality Update\n   According to NHDP [RFC6130]:\n      Link\
    \ quality is a mechanism whereby a router MAY take\n      considerations other\
    \ than message exchange into account for\n      determining when a link is and\
    \ is not a candidate for being\n      considered as HEARD or SYMMETRIC.  As such,\
    \ it is a \"link\n      admission\" mechanism.\n   Section 14.4 of NHDP [RFC6130]\
    \ then lists several examples of which\n   information can be used to update link\
    \ quality.  One of the listed\n   examples uses packet exchanges between neighbor\
    \ routers (as described\n   in [RFC5444]), e.g., an NHDP router may update the\
    \ link quality of a\n   neighbor based on receipt or loss of packets if they include\
    \ a\n   sequential packet sequence number.\n   NHDP does not specify how to acquire\
    \ link quality updates\n   normatively; however, attack vectors may be introduced\
    \ if an\n   implementation chooses to calculate link quality based on packet\n\
    \   sequence numbers.  The consequences of such threats would depend on\n   specific\
    \ implementations.  For example, if the link quality update is\n   based on a\
    \ sequential packet sequence number from neighbor routers, a\n   compromised NHDP\
    \ router can spoof packets appearing to be from\n   another legitimate NHDP router\
    \ that skips some packet sequence\n   numbers.  The NHDP router receiving the\
    \ spoofed packets may degrade\n   the link quality as it appears that several\
    \ packets have been\n   dropped.  Eventually, the router may remove the neighbor\
    \ when the\n   link quality drops below HYST_REJECT.\n"
- title: 5.  Impact of Inconsistent Information Bases on Protocols using NHDP
  contents:
  - "5.  Impact of Inconsistent Information Bases on Protocols using NHDP\n   This\
    \ section describes the impact on protocols that use NHDP when\n   NHDP fails\
    \ to obtain and represent accurate information, possibly as\n   a consequence\
    \ of the attacks described in Section 4.  This\n   description emphasizes the\
    \ impacts on the MANET protocols OLSRv2\n   [RFC7181] and SMF [RFC6621].\n"
- title: 5.1.  MPR Calculation
  contents:
  - "5.1.  MPR Calculation\n   MPR selection (as used in [RFC7181] and [RFC6621],\
    \ for example) uses\n   information about a router's 1-hop and 2-hop neighborhood,\
    \ assuming\n   that (i) this information is accurate, and (ii) each 1-hop neighbor\n\
    \   is apt to act as MPR, depending on the willingness it reports.  Thus,\n  \
    \ a compromised NHDP router may seek to manipulate the 1-hop and 2-hop\n   neighborhood\
    \ information in a router so as to cause the MPR selection\n   to fail, leading\
    \ to a flooding disruption of traffic control\n   messages.  This can result in\
    \ incomplete topology advertisement or\n   can degrade the optimized flooding\
    \ to classical flooding.\n"
- title: 5.1.1.  Flooding Disruption due to Identity Spoofing
  contents:
  - "5.1.1.  Flooding Disruption due to Identity Spoofing\n   A compromised NHDP router\
    \ can spoof the identify of other routers in\n   order to disrupt the MPR selection,\
    \ so as to prevent certain parts of\n   the network from receiving flooded traffic\
    \ [IJNSIA2010].\n   In Figure 4, a compromised NHDP router X spoofs the identity\
    \ of B.\n   The link between X and C is correctly detected and listed in X's\n\
    \   HELLOs.  Router A will receive HELLOs indicating links from B:{B-E},\n   X:{X-C,\
    \ X-E}, and D:{D-E, D-C}, respectively.  For router A, X and D\n   are equal candidates\
    \ for MPR selection.  To make sure the X can be\n   selected as MPR for router\
    \ A, X can set its willingness to the\n   maximum value.\n   .---.    .---.  \
    \  .---.\n   | E |----| D |----| C |\n   '---'    '---'    '---'\n     |     \
    \   |        .\n     |        |        .\n   .---.    .---.    .---.\n   | B |----|\
    \ A |----| X |\n   '---'    '---'    '---'\n                     spoofs B\n  \
    \                               Figure 4\n   If B and X (i) accept MPR selection\
    \ and (ii) forward flooded traffic\n   as if they were both B, identity spoofing\
    \ by X is harmless.  However,\n   if X does not forward flooded traffic (i.e.,\
    \ does not accept MPR\n   selection), its presence entails flooding disruption:\
    \ selecting B\n   over D renders C unreachable by flooded traffic.\n         \
    \             .---.\n                      | D |\n                      '---'\n\
    \                        |\n                        |\n    .---.    .---.    .---.\
    \    .---.    .---.\n    | X |----| A |----| B |----| C |----| E |...\n    '---'\
    \    '---'    '---'    '---'    '---'\n   spoofs E\n                         \
    \        Figure 5\n   In Figure 5, the compromised NHDP router X spoofs the identity\
    \ of E,\n   i.e., routers A and C both receive HELLOs from a router identifying\n\
    \   itself as E.  For router B, routers A and C present the same neighbor\n  \
    \ sets and are equal candidates for MPR selection.  If router B selects\n   only\
    \ router A as MPR, C will not relay flooded traffic from B or\n   transiting via\
    \ B, and router X (and routers to the \"right\" of it)\n   will not receive flooded\
    \ traffic.\n"
- title: 5.1.2.  Flooding Disruption due to Link Spoofing
  contents:
  - "5.1.2.  Flooding Disruption due to Link Spoofing\n   A compromised NHDP router\
    \ can also spoof links to other NHDP routers,\n   thereby making itself appear\
    \ as the most appealing candidate to be\n   MPR for its neighbors, possibly to\
    \ the exclusion of other NHDP\n   routers in the neighborhood.  (In particular,\
    \ this can occur if the\n   compromised NHDP router spoofs links to all other\
    \ NHDP routers in the\n   neighborhood, plus to one NHDP router outside the neighborhood.)\
    \  By\n   thus excluding other legitimate NHDP routers from being selected as\n\
    \   MPR, the compromised NHDP router will receive and be expected to\n   relay\
    \ all flooded traffic (e.g., traffic control messages in OLSRv2\n   or data traffic\
    \ in SMF) that it can then drop or otherwise\n   manipulate.\n   In the network\
    \ in Figure 6, the compromised NHDP router X spoofs\n   links to the existing\
    \ router C, as well as to a fictitious W.  Router\n   A receives HELLOs from X\
    \ and B, reporting X: {X-C, X-W}, B: {B-C}.\n   All else being equal, X appears\
    \ a better choice for MPR than B, as X\n   appears to cover all neighbors of B,\
    \ plus W.\n                               ,---.    .....\n                   \
    \            | S |    . C .\n                               '---'    .....\n \
    \                                |        .\n                                \
    \ |        .\n    .---.    .---.    .---.    .---.    .---.\n    | D |----| C\
    \ |----| B |----| A |----| X |\n    '---'    '---'    '---'    '---'    '---'\n\
    \                                          .\n                               \
    \           .\n                                        .....\n               \
    \                         . W .\n                                        .....\n\
    \                                 Figure 6\n   As router A will not select B as\
    \ MPR, B will not relay flooded\n   messages received from router A.  The NHDP\
    \ routers on the left of B\n   (starting with C) will, thus, not receive any flooded\
    \ messages from\n   router A or transiting router A (e.g., a message originating\
    \ from S).\n"
- title: 5.1.3.  Broadcast Storm
  contents:
  - "5.1.3.  Broadcast Storm\n   A compromised NHDP router may attack the network\
    \ by attempting to\n   degrade the performance of optimized flooding algorithms\
    \ so as to be\n   equivalent to classic flooding.  This can be achieved by forcing\
    \ an\n   NHDP router into choosing all its 1-hop neighbors as MPRs.  In\n   MANETs,\
    \ a broadcast storm caused by classic flooding is a serious\n   problem that can\
    \ result in redundancy, contention, and collisions\n   [MOBICOM99].\n   As shown\
    \ in Figure 7, the compromised NHDP router X spoofs the\n   identity of NHDP router\
    \ B and, spoofs a link to router Y {B-Y} (Y\n   does not have to exist).  By doing\
    \ so, the legitimate NHDP router A\n   has to select the legitimate NHDP router\
    \ B as its MPR in order for it\n   to reach all its 2-hop neighbors.  The compromised\
    \ NHDP router Y can\n   perform this identity-and-link spoofing for all of NHDP\
    \ router A's\n   1-hop neighbors, thereby forcing NHDP router A to select all\
    \ its\n   neighbors as MPR and disabling the optimization sought by the MPR\n\
    \   mechanism.\n   .---.\n   | B |\n   '---'\n     |\n     |\n   .---.    .---.\
    \      .....\n   | A |----| X | .  . . Y .\n   '---'    '---'      .....\n   \
    \         spoofs B\n                                 Figure 7\n"
- title: 5.2.  Routing Loops
  contents:
  - "5.2.  Routing Loops\n   Inconsistent information bases, provided by NHDP to other\
    \ protocols,\n   can also cause routing loops.  In Figure 8, the compromised NHDP\n\
    \   router X spoofs the identity of NHDP router E.  NHDP router D has\n   data\
    \ traffic to send to NHDP router A.  The topology recorded in the\n   information\
    \ base of router D indicates that the shortest path to\n   router A is {D->E->A},\
    \ because of the link {A-E} reported by X.\n   Therefore, the data traffic will\
    \ be routed to NHDP router E.  As the\n   link {A-E} does not exist in NHDP router\
    \ E's information bases, it\n   will identify the next hop for data traffic to\
    \ NHDP router A as being\n   NHDP router D.  A loop between the NHDP routers D\
    \ and E is thus\n   created.\n         .---.    .---.    .---.    .---.    .---.\n\
    \         | A |----| B |----| C |----| D |----| E |\n         '---'    '---' \
    \   '---'    '---'    '---'\n           |\n           |\n         .---.\n    \
    \     | X |\n         '---'\n         spoofs E\n                             \
    \    Figure 8\n"
- title: 5.3.  Invalid or Nonexistent Paths to Destinations
  contents:
  - "5.3.  Invalid or Nonexistent Paths to Destinations\n   By reporting inconsistent\
    \ topology information in NHDP, the invalid\n   links and routers can be propagated\
    \ as link state information with\n   traffic control messages and results in route\
    \ failure.  As\n   illustrated in Figure 8, if NHDP router B tries to send data\
    \ packets\n   to NHDP router E, it will choose router A as its next hop, based\
    \ on\n   the information about the nonexistent link {A-E} reported by the\n  \
    \ compromised NHDP router X.\n"
- title: 5.4.  Data Sinkhole
  contents:
  - "5.4.  Data Sinkhole\n   With the ability to spoof multiple identities of legitimate\
    \ NHDP\n   routers (by eavesdropping, for example), the compromised NHDP router\n\
    \   can represent a \"data sinkhole\" for its 1-hop and 2-hop neighbors.\n   Data\
    \ packets that come across its neighbors may be forwarded to the\n   compromised\
    \ NHDP router instead of to the real destination.  The\n   packet can then be\
    \ dropped, manipulated, duplicated, etc., by the\n   compromised NHDP router.\
    \  As shown in Figure 8, if the compromised\n   NHDP router X spoofs the identity\
    \ of NHDP router E, all the data\n   packets to E that cross NHDP routers A and\
    \ B will be sent to NHDP\n   router X, instead of to E.\n"
- title: 6.  Future Work
  contents:
  - "6.  Future Work\n   This document does not propose solutions to mitigate the\
    \ security\n   threats described in Section 4.  However, this section aims at\n\
    \   driving new work by suggesting which threats discussed in Section 4\n   could\
    \ be addressed by deployments or applications.\n   o  Section 4.1: Jamming - If\
    \ a single router or a small area of the\n      MANET is jammed, protocols could\
    \ be specified that increase link\n      metrics in NHDP for the jammed links.\
    \  When a routing protocol\n      such as OLSRv2 uses NHDP for neighborhood discovery,\
    \ other paths\n      leading \"around\" the jammed area would be preferred, and\
    \ therefore\n      would mitigate the threat to some extent.\n   o  Section 4.2:\
    \ DoS - A DoS attack using a massive amount of HELLO\n      messages can be mitigated\
    \ by admitting only trusted routers to the\n      network.  [RFC7185] specifies\
    \ a mechanism for adding Integrity\n      Check Values (ICVs) to HELLO messages\
    \ and therefore providing an\n      admittance mechanism for NHDP routers to a\
    \ MANET.  (Note that\n      adding ICVs creates a new DoS attack vector, as ICV\
    \ verification\n      requires CPU and memory resources.)  However, using ICVs\
    \ does not\n      address the problem of compromised routers.  Detecting compromised\n\
    \      routers could be addressed in new work.  [RFC7185] mandates\n      implementation\
    \ of a security mechanism that is based on shared\n      keys and makes excluding\
    \ single compromised routers difficult;\n      work could be done to facilitate\
    \ revocation mechanisms in certain\n      MANET use cases where routers have sufficient\
    \ capabilities to\n      support asymmetric keys.\n   o  Section 4.3: Eavesdropping\
    \ - [RFC7185] adds ICVs to HELLO messages\n      but does not encrypt them.  Therefore,\
    \ eavesdropping of control\n      traffic is not mitigated.  Future work could\
    \ provide encryption of\n      control traffic for sensitive MANET topologies.\
    \  Note that, other\n      than using a single shared secret key, providing encryption\
    \ of\n      traffic among a set of neighbors (when that set is potentially\n \
    \     undetermined) is nontrivial, especially without multiplying\n      overheads.\
    \  With traffic analysis, attackers could still deduce\n      the network information\
    \ like HELLO message triggering and HELLO\n      message size, even though the\
    \ HELLO messages are encrypted.\n   o  Section 4.4.2: Link spoofing - [RFC7185]\
    \ provides certain\n      protection against link spoofing, but an NHDP router\
    \ has to\n      \"trust\" the originator of a HELLO that the advertised links\
    \ are\n      correct.  For example, if a router A reports a link to B, routers\n\
    \      receiving HELLOs from A have to trust that B is actually a\n      (symmetric)\
    \ neighbor of A.  New protocol work could address\n      protection of links without\
    \ overly increasing the space and time\n      overheads.  An immediate suggestion\
    \ for deployments is to protect\n      routers against being compromised and to\
    \ distribute keys only to\n      trusted routers.\n   o  Section 4.5: Replay Attacks\
    \ - [RFC7185] uses ICVs and timestamps\n      to provide some protection against\
    \ replay attacks.  It is still\n      feasible to replay control messages within\
    \ a limited time.  A\n      suggestion for deployments is to provide time synchronization\n\
    \      between routers.  New work could provide time synchronization\n      mechanisms\
    \ for certain MANET use cases or specify a mechanism\n      using nonces instead\
    \ of timestamps in HELLO messages.\n   o  Section 4.4.1: Identity spoofing; Section\
    \ 4.6: Message timing\n      attacks; Section 4.7: Indirect channel overloading;\
    \ and\n      Section 4.8: Attack on link quality update - [RFC7185] provides\n\
    \      protection against these attacks, assuming the routers are not\n      compromised.\n"
- title: 7.  Security Considerations
  contents:
  - "7.  Security Considerations\n   This document does not specify a protocol or\
    \ a procedure.  The\n   document, however, reflects on security considerations\
    \ for NHDP and\n   MANET routing protocols using NHDP for neighborhood discovery.\n"
- title: 8.  Acknowledgments
  contents:
  - "8.  Acknowledgments\n   The authors would like to gratefully acknowledge the\
    \ following people\n   for valuable comments and technical discussions: Teco Boot,\
    \ Henning\n   Rogge, Christopher Dearlove, John Dowdell, Joseph Macker, and all\
    \ the\n   other participants of the IETF MANET working group.\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC5444]  Clausen, T., Dearlove, C., Dean, J.,\
    \ and C. Adjih,\n              \"Generalized Mobile Ad Hoc Network (MANET) Packet/Message\n\
    \              Format\", RFC 5444, February 2009.\n   [RFC5497]  Clausen, T. and\
    \ C. Dearlove, \"Representing Multi-Value\n              Time in Mobile Ad Hoc\
    \ Networks (MANETs)\", RFC 5497, March\n              2009.\n   [RFC6130]  Clausen,\
    \ T., Dearlove, C., and J. Dean, \"Mobile Ad Hoc\n              Network (MANET)\
    \ Neighborhood Discovery Protocol (NHDP)\",\n              RFC 6130, April 2011.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [ACCT2012] Jhaveri, R. and S. Patel, \"DoS Attacks\
    \ in Mobile Ad Hoc\n              Networks: A Survey\", Second International Conference\
    \ on\n              Advanced Computing & Communication Technologies (ACCT),\n\
    \              January 2012.\n   [CPSCOM2011]\n              Yi, J., Clausen,\
    \ T., and U. Herberg, \"Vulnerability\n              Analysis of the Simple Multicast\
    \ Forwarding (SMF) Protocol\n              for Mobile Ad Hoc Networks\", Proceedings\
    \ of the IEEE\n              International Conference on Cyber, Physical, and\
    \ Social\n              Computing (CPSCom), October 2011.\n   [IJNSIA2010]\n \
    \             Herberg, U. and T. Clausen, \"Security Issues in the\n         \
    \     Optimized Link State Routing Protocol version 2\",\n              International\
    \ Journal of Network Security & Its\n              Applications, April 2010.\n\
    \   [MANET-MGMT]\n              Nguyen, J., Cole, R., Herberg, U., Yi, J., and\
    \ J. Dean,\n              \"Network Management of Mobile Ad hoc Networks (MANET):\n\
    \              Architecture, Use Cases, and Applicability\", Work in\n       \
    \       Progress, February 2013.\n   [MGMT-SNAP]\n              Clausen, T. and\
    \ U. Herberg, \"Snapshot of OLSRv2-Routed\n              MANET Management\", Work\
    \ in Progress, February 2014.\n   [MOBICOM99]\n              Ni, S., Tseng, Y.,\
    \ Chen, Y., and J. Sheu, \"The Broadcast\n              Storm Problem in a Mobile\
    \ Ad Hoc Network\", Proceedings of\n              the 5th annual ACM/IEEE international\
    \ conference on Mobile\n              computing and networking, 1999.\n   [RFC4593]\
    \  Barbir, A., Murphy, S., and Y. Yang, \"Generic Threats to\n              Routing\
    \ Protocols\", RFC 4593, October 2006.\n   [RFC4949]  Shirey, R., \"Internet Security\
    \ Glossary, Version 2\", RFC\n              4949, August 2007.\n   [RFC6621] \
    \ Macker, J., \"Simplified Multicast Forwarding\", RFC 6621,\n              May\
    \ 2012.\n   [RFC6779]  Herberg, U., Cole, R., and I. Chakeres, \"Definition of\n\
    \              Managed Objects for the Neighborhood Discovery Protocol\",\n  \
    \            RFC 6779, October 2012.\n   [RFC7181]  Clausen, T., Dearlove, C.,\
    \ Jacquet, P., and U. Herberg,\n              \"The Optimized Link State Routing\
    \ Protocol Version 2\", RFC\n              7181, April 2014.\n   [RFC7185]  Herberg,\
    \ U., Dearlove, C., and T. Clausen, \"Integrity\n              Protection for\
    \ the Neighborhood Discovery Protocol (NHDP)\n              and Optimized Link\
    \ State Routing Protocol Version 2\n              (OLSRv2)\", RFC 7185, April\
    \ 2014.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Jiazi Yi\n   LIX, Ecole Polytechnique\n   91128 Palaiseau\
    \ Cedex\n   France\n   Phone: +33 1 77 57 80 85\n   EMail: jiazi@jiaziyi.com\n\
    \   URI:   http://www.jiaziyi.com/\n   Ulrich Herberg\n   Fujitsu Laboratories\
    \ of America\n   1240 E Arques Ave\n   Sunnyvale, CA  94085\n   USA\n   EMail:\
    \ ulrich@herberg.name\n   URI:   http://www.herberg.name/\n   Thomas Heide Clausen\n\
    \   LIX, Ecole Polytechnique\n   91128 Palaiseau Cedex\n   France\n   Phone: +33\
    \ 6 6058 9349\n   EMail: T.Clausen@computer.org\n   URI:   http://www.thomasclausen.org/\n"
