- title: __initial_text__
  contents:
  - "                Security and Privacy Considerations for\n                   IPv6\
    \ Address Generation Mechanisms\n"
- title: Abstract
  contents:
  - "Abstract\n   This document discusses privacy and security considerations for\n\
    \   several IPv6 address generation mechanisms, both standardized and\n   non-standardized.\
    \  It evaluates how different mechanisms mitigate\n   different threats and the\
    \ trade-offs that implementors, developers,\n   and users face in choosing different\
    \ addresses or address generation\n   mechanisms.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7721.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2016 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   3\n   2.  Terminology . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .   4\n   3.  Weaknesses in IEEE-Identifier-Based IIDs  . . . . . . .\
    \ . . .   5\n     3.1.  Correlation of Activities over Time . . . . . . . . .\
    \ . .   5\n     3.2.  Location Tracking . . . . . . . . . . . . . . . . . . .\
    \ .   6\n     3.3.  Address Scanning  . . . . . . . . . . . . . . . . . . . .\
    \   7\n     3.4.  Device-Specific Vulnerability Exploitation  . . . . . . .  \
    \ 7\n   4.  Privacy and Security Properties of Address Generation\n       Mechanisms\
    \  . . . . . . . . . . . . . . . . . . . . . . . . .   7\n     4.1.  IEEE-Identifier-Based\
    \ IIDs  . . . . . . . . . . . . . . .  10\n     4.2.  Static, Manually Configured\
    \ IIDs  . . . . . . . . . . . .  10\n     4.3.  Constant, Semantically Opaque\
    \ IIDs  . . . . . . . . . . .  10\n     4.4.  Cryptographically Generated IIDs\
    \  . . . . . . . . . . . .  10\n     4.5.  Stable, Semantically Opaque IIDs  .\
    \ . . . . . . . . . . .  11\n     4.6.  Temporary IIDs  . . . . . . . . . . .\
    \ . . . . . . . . . .  11\n     4.7.  DHCPv6 Generation of IIDs . . . . . . .\
    \ . . . . . . . . .  12\n     4.8.  Transition and Coexistence Technologies .\
    \ . . . . . . . .  12\n   5.  Miscellaneous Issues with IPv6 Addressing . . .\
    \ . . . . . . .  13\n     5.1.  Network Operation . . . . . . . . . . . . . .\
    \ . . . . . .  13\n     5.2.  Compliance  . . . . . . . . . . . . . . . . . .\
    \ . . . . .  13\n     5.3.  Intellectual Property Rights (IPRs) . . . . . . .\
    \ . . . .  13\n   6.  Security Considerations . . . . . . . . . . . . . . . .\
    \ . . .  13\n   7.  References  . . . . . . . . . . . . . . . . . . . . . . .\
    \ . .  14\n     7.1.  Normative References  . . . . . . . . . . . . . . . . .\
    \ .  14\n     7.2.  Informative References  . . . . . . . . . . . . . . . . .\
    \  15\n   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  18\n\
    \   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   IPv6 was designed to improve upon IPv4 in many respects,\
    \ and\n   mechanisms for address assignment were one such area for improvement.\n\
    \   In addition to static address assignment and DHCP, stateless\n   autoconfiguration\
    \ was developed as a less intensive, fate-shared\n   means of performing address\
    \ assignment.  With stateless\n   autoconfiguration, routers advertise on-link\
    \ prefixes and hosts\n   generate their own Interface Identifiers (IIDs) to complete\
    \ their\n   addresses.  [RFC7136] clarifies that the IID should be treated as\
    \ an\n   opaque value, while [RFC7421] provides an analysis of the 64-bit\n  \
    \ boundary in IPv6 addressing (e.g., the implications of the IID length\n   on\
    \ security and privacy).  Over the years, many IID generation\n   techniques have\
    \ been defined, both standardized and non-standardized:\n   o  Manual configuration\
    \ [RFC7707]\n      *  IPv4 address\n      *  Service port\n      *  Wordy\n  \
    \    *  Low-byte\n   o  Stateless Address Autoconfiguration (SLAAC)\n      * \
    \ IEEE 802 48-bit Media Access Control (MAC) or IEEE 64-bit\n         Extended\
    \ Unique Identifier (EUI-64) [RFC2464]\n      *  Cryptographically generated [RFC3972]\n\
    \      *  Temporary (also known as \"privacy addresses\") [RFC4941]\n      * \
    \ Constant, semantically opaque (also known as \"random\")\n         [Microsoft]\n\
    \      *  Stable, semantically opaque [RFC7217]\n   o  DHCPv6 based [RFC3315]\n\
    \   o  Specified by transition/co-existence technologies\n      *  Derived from\
    \ an IPv4 address (e.g., [RFC5214], [RFC6052])\n      *  Derived from an IPv4\
    \ address and port set ID (e.g., [RFC7596],\n         [RFC7597], [RFC7599])\n\
    \      *  Derived from an IPv4 address and port (e.g., [RFC4380])\n   Deriving\
    \ the IID from a globally unique IEEE identifier [RFC2464]\n   [RFC4862] was one\
    \ of the earliest mechanisms developed (and\n   originally specified in [RFC1971]\
    \ and [RFC1972]).  A number of\n   privacy and security issues related to the\
    \ IIDs derived from IEEE\n   identifiers were discovered after their standardization,\
    \ and many of\n   the mechanisms developed later aimed to mitigate some or all\
    \ of these\n   weaknesses.  This document identifies four types of attacks against\n\
    \   IEEE-identifier-based IIDs and discusses how other existing\n   techniques\
    \ for generating IIDs do or do not mitigate those attacks.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   This section clarifies the terminology used throughout this\
    \ document.\n   Public address:\n      An address that has been published in a\
    \ directory or other public\n      location, such as the DNS, a SIP proxy [RFC3261],\
    \ an application-\n      specific Distributed Hash Table (DHT), or a publicly\
    \ available\n      URI.  A host's public addresses are intended to be discoverable\
    \ by\n      third parties.\n   Stable address:\n      An address that does not\
    \ vary over time within the same IPv6 link.\n      Note that [RFC4941] refers\
    \ to these as \"public\" addresses, but\n      \"stable\" is used here for reasons\
    \ explained in Section 4.\n   Temporary address:\n      An address that varies\
    \ over time within the same IPv6 link.\n   Constant IID:\n      An IPv6 interface\
    \ identifier that is globally stable.  That is,\n      the Interface ID will remain\
    \ constant even if the node moves from\n      one IPv6 link to another.\n   Stable\
    \ IID:\n      An IPv6 interface identifier that is stable within some specified\n\
    \      context.  For example, an Interface ID can be globally stable\n      (constant)\
    \ or could be stable per IPv6 link (meaning that the\n      Interface ID will\
    \ remain unchanged as long as the node stays on\n      the same IPv6 link but\
    \ may change when the node moves from one\n      IPv6 link to another).\n   Temporary\
    \ IID:\n      An IPv6 interface identifier that varies over time.\n   The key\
    \ words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"\
    SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"NOT RECOMMENDED\", \"MAY\", and\n\
    \   \"OPTIONAL\" in this document are to be interpreted as described in\n   [RFC2119].\
    \  These words take their normative meanings only when they\n   are presented\
    \ in ALL UPPERCASE.\n"
- title: 3.  Weaknesses in IEEE-Identifier-Based IIDs
  contents:
  - "3.  Weaknesses in IEEE-Identifier-Based IIDs\n   There are a number of privacy\
    \ and security implications that exist\n   for hosts that use IEEE-identifier-based\
    \ IIDs.  This section\n   discusses four generic attack types: correlation of\
    \ activities over\n   time, location tracking, address scanning, and device-specific\n\
    \   vulnerability exploitation.  The first three of these rely on the\n   attacker\
    \ first gaining knowledge of the IID of the target host.  This\n   could be achieved\
    \ by a number of different entities: the operator of\n   a server to which the\
    \ host connects, such as a web server or a peer-\n   to-peer server; an entity\
    \ that connects to the same IPv6 link as the\n   target (such as a conference\
    \ network or any public network); a\n   passive observer of traffic that the host\
    \ broadcasts; or an entity\n   that is on path to the destinations with which\
    \ the host communicates,\n   such as a network operator.\n"
- title: 3.1.  Correlation of Activities over Time
  contents:
  - "3.1.  Correlation of Activities over Time\n   As with other identifiers, an IPv6\
    \ address can be used to correlate\n   the activities of a host for at least as\
    \ long as the lifetime of the\n   address.  The correlation made possible by IEEE-identifier-based\
    \ IIDs\n   is of particular concern since they last roughly for the lifetime of\n\
    \   a device's network interface, allowing correlation on the order of\n   years.\n\
    \   As [RFC4941] explains,\n      [t]he use of a non-changing interface identifier\
    \ to form addresses\n      is a specific instance of the more general case where\
    \ a constant\n      identifier is reused over an extended period of time and in\n\
    \      multiple independent activities.  Anytime the same identifier is\n    \
    \  used in multiple contexts, it becomes possible for that identifier\n      to\
    \ be used to correlate seemingly unrelated activity. ... The use\n      of a constant\
    \ identifier within an address is of special concern\n      because addresses\
    \ are a fundamental requirement of communication\n      and cannot easily be hidden\
    \ from eavesdroppers and other parties.\n      Even when higher layers encrypt\
    \ their payloads, addresses in\n      packet headers appear in the clear.\n  \
    \ IP addresses are just one example of information that can be used to\n   correlate\
    \ activities over time.  DNS names, cookies [RFC6265],\n   browser fingerprints\
    \ [Panopticlick], and application-layer usernames\n   can all be used to link\
    \ a host's activities together.  Although IEEE-\n   identifier-based IIDs are\
    \ likely to last at least as long or longer\n   than these other identifiers,\
    \ IIDs generated in other ways may have\n   shorter or longer lifetimes than these\
    \ identifiers depending on how\n   they are generated.  Therefore, the extent\
    \ to which a host's\n   activities can be correlated depends on whether the host\
    \ uses\n   multiple identifiers together and the lifetimes of all of those\n \
    \  identifiers.  Frequently refreshing an IPv6 address may not mitigate\n   correlation\
    \ if an attacker has access to other longer-lived\n   identifiers for a particular\
    \ host.  This is an important caveat to\n   keep in mind throughout the discussion\
    \ of correlation in this\n   document.  For further discussion of correlation,\
    \ see Section 5.2.1\n   of [RFC6973].\n   As noted in [RFC4941], in some cases\
    \ correlation is just as feasible\n   for a host using an IPv4 address as for\
    \ a host using an IEEE\n   identifier to generate its IID in its IPv6 address.\
    \  Hosts that use\n   static IPv4 addressing or who are consistently allocated\
    \ the same\n   address via DHCPv4 can be tracked as described above.  However,\
    \ the\n   widespread use of both NAT and DHCPv4 implementations that assign the\n\
    \   same host a different address upon lease expiration mitigates this\n   threat\
    \ in the IPv4 case as compared to the IEEE identifier case in\n   IPv6.\n"
- title: 3.2.  Location Tracking
  contents:
  - "3.2.  Location Tracking\n   Because the IPv6 address structure is divided between\
    \ a topological\n   portion and an interface identifier portion, an interface\
    \ identifier\n   that remains constant when a host connects to different IPv6\
    \ links\n   (as an IEEE-identifier-based IID does) provides a way for observers\n\
    \   to track the movements of that host.  In a passive attack on a mobile\n  \
    \ host, a server that receives connections from the same host over time\n   would\
    \ be able to determine the host's movements as its prefix\n   changes.\n   Active\
    \ attacks are also possible.  An attacker that first learns the\n   host's interface\
    \ identifier by being connected to the same IPv6 link,\n   running a server that\
    \ the host connects to, or being on path to the\n   host's communications could\
    \ subsequently probe other networks for the\n   presence of the same interface\
    \ identifier by sending a probe packet\n   (e.g., ICMPv6 Echo Request, or any\
    \ other probe packet).  Even if the\n   host does not respond, the first-hop router\
    \ will usually respond with\n   an ICMP Destination Unreachable/Address Unreachable\
    \ (type 1, code 3)\n   when the host is not present and be silent when the host\
    \ is present.\n   Location tracking based on IP address is generally not possible\
    \ in\n   IPv4 since hosts get assigned wholly new addresses when they change\n\
    \   networks.\n"
- title: 3.3.  Address Scanning
  contents:
  - "3.3.  Address Scanning\n   The structure of IEEE-based identifiers used for address\
    \ generation\n   can be leveraged by an attacker to reduce the target search space\n\
    \   [RFC7707].  The 24-bit Organizationally Unique Identifier (OUI) of\n   MAC\
    \ addresses, together with the fixed value (0xff, 0xfe) used to\n   form a Modified\
    \ EUI-64 interface identifier, greatly help to reduce\n   the search space, making\
    \ it easier for an attacker to scan for\n   individual addresses using widely\
    \ known popular OUIs.  This erases\n   much of the protection against address\
    \ scanning that the larger IPv6\n   address space could provide as compared to\
    \ IPv4.\n"
- title: 3.4.  Device-Specific Vulnerability Exploitation
  contents:
  - "3.4.  Device-Specific Vulnerability Exploitation\n   IPv6 addresses that embed\
    \ IEEE identifiers leak information about the\n   device (e.g., Network Interface\
    \ Card vendor, or even Operating System\n   and/or software type), which could\
    \ be leveraged by an attacker with\n   knowledge of device- or software-specific\
    \ vulnerabilities to quickly\n   find possible targets.  Attackers can exploit\
    \ vulnerabilities in\n   hosts whose IIDs they have previously obtained or scan\
    \ an address\n   space to find potential targets.\n"
- title: 4.  Privacy and Security Properties of Address Generation Mechanisms
  contents:
  - "4.  Privacy and Security Properties of Address Generation Mechanisms\n   Analysis\
    \ of the extent to which a particular host is protected\n   against the attacks\
    \ described in Section 3 depends on how each of a\n   host's addresses is generated\
    \ and used.  In some scenarios, a host\n   configures a single global address\
    \ and uses it for all\n   communications.  In other scenarios, a host configures\
    \ multiple\n   addresses using different mechanisms and may use any or all of\
    \ them.\n   [RFC3041] (later obsoleted by [RFC4941]) sought to address some of\n\
    \   the problems described in Section 3 by defining \"temporary addresses\"\n\
    \   for outbound connections.  Temporary addresses are meant to\n   supplement\
    \ the other addresses that a device might use, not to\n   replace them.  They\
    \ use IIDs that are randomly generated and change\n   daily by default.  The idea\
    \ was for temporary addresses to be used\n   for outgoing connections (e.g., web\
    \ browsing) while maintaining the\n   ability to use a stable address when more\
    \ address stability is\n   desired (e.g., for IPv6 addresses published in the\
    \ DNS).\n   [RFC3484] originally specified that stable addresses be used for\n\
    \   outbound connections unless an application explicitly prefers\n   temporary\
    \ addresses.  The default preference for stable addresses was\n   established\
    \ to avoid applications potentially failing due to the\n   short lifetime of temporary\
    \ addresses or the possibility of a reverse\n   look-up failure or error.  However,\
    \ [RFC3484] allowed that\n   \"implementations for which privacy considerations\
    \ outweigh these\n   application-compatibility concerns MAY reverse the sense\
    \ of this\n   rule\" and instead prefer by default temporary addresses rather\
    \ than\n   stable addresses.  Indeed, most implementations (notably including\n\
    \   Windows) chose to default to temporary addresses for outbound\n   connections\
    \ since privacy was considered more important (and few\n   applications supported\
    \ IPv6 at the time, so application compatibility\n   concerns were minimal). \
    \ [RFC6724] then obsoleted [RFC3484] and\n   changed the default to match what\
    \ implementations actually did.\n   The envisioned relationship in [RFC3484] between\
    \ stability of an\n   address and its use in \"public\" can be misleading when\
    \ conducting\n   privacy analysis.  The stability of an address and the extent\
    \ to\n   which it is linkable to some other public identifier are independent\n\
    \   of one another.  For example, there is nothing that prevents a host\n   from\
    \ publishing a temporary address in a public place, such as the\n   DNS.  Publishing\
    \ both a stable address and a temporary address in the\n   DNS or elsewhere where\
    \ they can be linked together by a public\n   identifier allows the host's activities\
    \ when using either address to\n   be correlated together.\n   Moreover, because\
    \ temporary addresses were designed to supplement\n   other addresses generated\
    \ by a host, the host may still configure a\n   more stable address even if it\
    \ only ever intentionally uses temporary\n   addresses (as source addresses) for\
    \ communication to off-link\n   destinations.  An attacker can probe for the stable\
    \ address even if\n   it is never used as such a source address or advertised\
    \ outside the\n   link (e.g., in DNS or SIP).\n   This section compares the privacy\
    \ and security properties of a\n   variety of IID generation mechanisms and their\
    \ possible usage\n   scenarios, including scenarios in which a single mechanism\
    \ is used to\n   generate all of a host's IIDs and those in which temporary addresses\n\
    \   are used together with addresses generated using a different IID\n   generation\
    \ mechanism.  The analysis of the exposure of each IID type\n   to correlation\
    \ assumes that IPv6 prefixes are shared by a reasonably\n   large number of nodes.\
    \  As [RFC4941] notes, if a very small number of\n   nodes (say, only one) use\
    \ a particular prefix for an extended period\n   of time, the prefix itself can\
    \ be used to correlate the host's\n   activities regardless of how the IID is\
    \ generated.  For example,\n   [RFC3314] recommends that prefixes be uniquely\
    \ assigned to mobile\n   handsets where IPv6 is used within General Packet Radio\
    \ Service\n   (GPRS).  In cases where this advice is followed and prefixes persist\n\
    \   for extended periods of time (or get reassigned to the same handsets\n   whenever\
    \ those handsets reconnect to the same network router), hosts'\n   activities\
    \ could be correlatable for longer periods than the analysis\n   below would suggest.\n\
    \   The table below provides a summary of the whole analysis.  A \"No\"\n   entry\
    \ indicates that the attack is prevented from being carried out\n   on the basis\
    \ of the IID, but the host may still be vulnerable\n   depending on how it employs\
    \ other protocols.\n   +--------------+-------------+----------+-------------+-------------+\n\
    \   | Mechanism(s) | Correlation | Location | Address     | Device      |\n  \
    \ |              |             | tracking | scanning    | exploits    |\n   +--------------+-------------+----------+-------------+-------------+\n\
    \   | IEEE         | For device  | For      | Possible    | Possible    |\n  \
    \ | identifier   | lifetime    | device   |             |             |\n   |\
    \              |             | lifetime |             |             |\n   |  \
    \            |             |          |             |             |\n   | Static\
    \       | For address | For      | Depends on  | Depends on  |\n   | manual  \
    \     | lifetime    | address  | generation  | generation  |\n   |           \
    \   |             | lifetime | mechanism   | mechanism   |\n   |             \
    \ |             |          |             |             |\n   | Constant,    |\
    \ For address | For      | No          | No          |\n   | semantically | lifetime\
    \    | address  |             |             |\n   | opaque       |           \
    \  | lifetime |             |             |\n   |              |             |\
    \          |             |             |\n   | CGA          | For         | No\
    \       | No          | No          |\n   |              | lifetime of |     \
    \     |             |             |\n   |              | (modifier   |       \
    \   |             |             |\n   |              | block +     |         \
    \ |             |             |\n   |              | public key) |          |\
    \             |             |\n   |              |             |          |  \
    \           |             |\n   | Stable,      | Within      | No       | No \
    \         | No          |\n   | semantically | single IPv6 |          |      \
    \       |             |\n   | opaque       | link        |          |        \
    \     |             |\n   |              |             |          |          \
    \   |             |\n   | Temporary    | For temp    | No       | No         \
    \ | No          |\n   |              | address     |          |             |\
    \             |\n   |              | lifetime    |          |             |  \
    \           |\n   |              |             |          |             |    \
    \         |\n   | DHCPv6       | For lease   | No       | Depends on  | No   \
    \       |\n   |              | lifetime    |          | generation  |        \
    \     |\n   |              |             |          | mechanism   |          \
    \   |\n   +--------------+-------------+----------+-------------+-------------+\n\
    \   Table 1: Privacy and Security Properties of IID Generation Mechanisms\n"
- title: 4.1.  IEEE-Identifier-Based IIDs
  contents:
  - "4.1.  IEEE-Identifier-Based IIDs\n   As discussed in Section 3, addresses that\
    \ use IIDs based on IEEE\n   identifiers are vulnerable to all four attacks. \
    \ They allow\n   correlation and location tracking for the lifetime of the device\n\
    \   since IEEE identifiers last that long and their structure makes\n   address\
    \ scanning and device exploits possible.\n"
- title: 4.2.  Static, Manually Configured IIDs
  contents:
  - "4.2.  Static, Manually Configured IIDs\n   Because static, manually configured\
    \ IIDs are stable, both correlation\n   and location tracking are possible for\
    \ the life of the address.\n   The extent to which location tracking can be successfully\
    \ performed\n   depends, to some extent, on the uniqueness of the employed IID.\
    \  For\n   example, one would expect \"low byte\" IIDs to be more widely reused\n\
    \   than, for example, IIDs where the whole 64 bits follow some pattern\n   that\
    \ is unique to a specific organization.  Widely reused IIDs will\n   typically\
    \ lead to false positives when performing location tracking.\n   Whether manually\
    \ configured addresses are vulnerable to address\n   scanning and device exploits\
    \ depends on the specifics of how the IIDs\n   are generated.\n"
- title: 4.3.  Constant, Semantically Opaque IIDs
  contents:
  - "4.3.  Constant, Semantically Opaque IIDs\n   Although a mechanism to generate\
    \ a constant, semantically opaque IID\n   has not been standardized, it has been\
    \ in wide use for many years on\n   at least one platform (Windows).  Windows\
    \ uses the random generation\n   mechanism described in [RFC4941] in lieu of generating\
    \ an IEEE-\n   identifier-based IID.  This mitigates the device-specific\n   exploitation\
    \ and address-scanning attacks but still allows\n   correlation and location tracking\
    \ because the IID is constant across\n   IPv6 links and time.\n"
- title: 4.4.  Cryptographically Generated IIDs
  contents:
  - "4.4.  Cryptographically Generated IIDs\n   Cryptographically Generated Addresses\
    \ (CGAs) [RFC3972] bind a hash of\n   the host's public key to an IPv6 address\
    \ in the SEcure Neighbor\n   Discovery (SEND) protocol [RFC3971].  CGAs may be\
    \ regenerated for\n   each subnet prefix, but this is not required given that\
    \ they are\n   computationally expensive to generate.  A host using a CGA can\
    \ be\n   correlated for as long as the lifetime of the combination of the\n  \
    \ public key and the chosen modifier block since it is possible to\n   rotate\
    \ modifier blocks without generating new public keys.  Because\n   the cryptographic\
    \ hash of the host's public key uses the subnet\n   prefix as an input, even if\
    \ the host does not generate a new public\n   key or modifier block when it moves\
    \ to a different IPv6 link, its\n   location cannot be tracked via the IID.  CGAs\
    \ do not allow device-\n   specific exploitation or address-scanning attacks.\n"
- title: 4.5.  Stable, Semantically Opaque IIDs
  contents:
  - "4.5.  Stable, Semantically Opaque IIDs\n   [RFC7217] specifies an algorithm that\
    \ generates, for each network\n   interface, a unique random IID per IPv6 link.\
    \  The aforementioned\n   algorithm is employed not only for global unicast addresses,\
    \ but also\n   for unique local unicast addresses and link-local unicast addresses\n\
    \   since these addresses may leak out via application protocols (e.g.,\n   IPv6\
    \ addresses embedded in email headers).\n   A host that stays connected to the\
    \ same IPv6 link could therefore be\n   tracked at length, whereas a mobile host's\
    \ activities could only be\n   correlated for the duration of each network connection.\
    \  Location\n   tracking is not possible with these addresses.  They also do not\n\
    \   allow device-specific exploitation or address-scanning attacks.\n"
- title: 4.6.  Temporary IIDs
  contents:
  - "4.6.  Temporary IIDs\n   A host that uses only a temporary address mitigates\
    \ all four threats.\n   Its activities may only be correlated for the lifetime\
    \ of a single\n   temporary address.\n   A host that configures both an IEEE-identifier-based\
    \ IID and\n   temporary addresses makes the host vulnerable to the same attacks\
    \ as\n   if temporary addresses were not in use, although the viability of\n \
    \  some of them depends on how the host uses each address.  An attacker\n   can\
    \ correlate all of the host's activities for which it uses its\n   IEEE-identifier-based\
    \ IID.  Once an attacker has obtained the IEEE-\n   identifier-based IID, location\
    \ tracking becomes possible on other\n   IPv6 links even if the host only makes\
    \ use of temporary addresses on\n   those other IPv6 links; the attacker can actively\
    \ probe the other\n   IPv6 links for the presence of the IEEE-identifier-based\
    \ IID.\n   Device-specific vulnerabilities can still be exploited.  Address\n\
    \   scanning is also still possible because the IEEE-identifier-based\n   address\
    \ can be probed.\n   If the host instead generates a constant, semantically opaque\
    \ IID to\n   use in a stable address for server-like connections together with\n\
    \   temporary addresses for outbound connections (as is the default in\n   Windows),\
    \ it sees some improvements over the previous scenario.  The\n   address-scanning\
    \ attacks and device-specific exploitation attacks are\n   no longer possible\
    \ because the OUI is no longer embedded in any of\n   the host's addresses.  However,\
    \ correlation of some activities across\n   time and location tracking are both\
    \ still possible because the\n   semantically opaque IID is constant.  And once\
    \ an attacker has\n   obtained the host's semantically opaque IID, location tracking\
    \ is\n   possible on any network by probing for that IID, even if the host\n \
    \  only uses temporary addresses on those networks.  However, if the\n   host\
    \ generates but never uses a constant, semantically opaque IID, it\n   mitigates\
    \ all four threats.\n   When used together with temporary addresses, the stable,\
    \ semantically\n   opaque IID generation mechanism [RFC7217] improves upon the\
    \ previous\n   scenario by limiting the potential for correlation to the lifetime\
    \ of\n   the stable address (which may still be lengthy for hosts that are not\n\
    \   mobile) and by eliminating the possibility for location tracking\n   (since\
    \ a different IID is generated for each subnet prefix).  As in\n   the previous\
    \ scenario, a host that configures but does not use a\n   stable, semantically\
    \ opaque address mitigates all four threats.\n"
- title: 4.7.  DHCPv6 Generation of IIDs
  contents:
  - "4.7.  DHCPv6 Generation of IIDs\n   The security and privacy implications of\
    \ DHCPv6-based addresses will\n   typically depend on whether the client requests\
    \ an IA_NA (Identity\n   Association for Non-temporary Addresses) or an IA_TA\
    \ (Identity\n   Association for Temporary Addresses) [RFC3315] and the specific\n\
    \   DHCPv6 server software being employed.\n   DHCPv6 temporary addresses have\
    \ the same properties as SLAAC\n   temporary addresses (see Section 4.6).  On\
    \ the other hand, the\n   properties of DHCPv6 non-temporary addresses typically\
    \ depend on the\n   specific DHCPv6 server software being employed.  Recent releases\
    \ of\n   most popular DHCPv6 server software typically lease random addresses\n\
    \   with a similar lease time as that of IPv4.  Thus, these addresses can\n  \
    \ be considered to be \"stable, semantically opaque\".  [DHCPv6-IID]\n   specifies\
    \ an algorithm that can be employed by DHCPv6 servers to\n   generate \"stable,\
    \ semantically opaque\" addresses.\n   On the other hand, some DHCPv6 software\
    \ leases sequential addresses\n   (typically low-byte addresses).  These addresses\
    \ can be considered to\n   be stable addresses.  The drawback of this address\
    \ generation scheme\n   compared to \"stable, semantically opaque\" addresses\
    \ is that, since\n   they follow specific patterns, they enable IPv6 address scans.\n"
- title: 4.8.  Transition and Coexistence Technologies
  contents:
  - "4.8.  Transition and Coexistence Technologies\n   Addresses specified based on\
    \ transition or coexistence technologies\n   that embed an IPv4 address within\
    \ an IPv6 address are not included in\n   Table 1 because their privacy and security\
    \ properties are inherited\n   from the embedded address.  For example, Teredo\
    \ [RFC4380] specifies a\n   means to generate an IPv6 address from the underlying\
    \ IPv4 address\n   and port, leaving many other bits set to zero.  This makes\
    \ it\n   relatively easy for an attacker to scan for IPv6 addresses by\n   guessing\
    \ the Teredo client's IPv4 address and port (which for many\n   NATs is not randomized).\
    \  For this reason, popular implementations\n   (e.g., Windows) began deviating\
    \ from the standard by including 12\n   random bits in place of zero bits.  This\
    \ modification was later\n   standardized in [RFC5991].\n   Some other transition\
    \ technologies (e.g., [RFC5214], [RFC6052])\n   specify means to generate an IPv6\
    \ address from an underlying IPv4\n   address without a port.  Such mechanisms\
    \ thus make it much easier for\n   an attacker to conduct an address scan than\
    \ for mechanisms that\n   require finding a port number as well.\n   Finally,\
    \ still other mechanisms (e.g., [RFC7596], [RFC7597],\n   [RFC7599]) are somewhere\
    \ in between, using an IPv4 address and a port\n   set ID (which for many NATs\
    \ is not randomized).  In general, such\n   mechanisms are thus typically as easy\
    \ to scan as in the Teredo\n   example above without the 12-bit mitigation.\n"
- title: 5.  Miscellaneous Issues with IPv6 Addressing
  contents:
  - '5.  Miscellaneous Issues with IPv6 Addressing

    '
- title: 5.1.  Network Operation
  contents:
  - "5.1.  Network Operation\n   It is generally agreed that IPv6 addresses that vary\
    \ over time in a\n   specific IPv6 link tend to increase the complexity of event\
    \ logging,\n   trouble-shooting, enforcement of access controls and quality of\n\
    \   service, etc.  As a result, some organizations disable the use of\n   temporary\
    \ addresses [RFC4941] even at the expense of reduced privacy\n   [Broersma].\n"
- title: 5.2.  Compliance
  contents:
  - "5.2.  Compliance\n   Some IPv6 compliance testing suites required (and might\
    \ still\n   require) implementations to support IEEE-identifier-based IIDs in\n\
    \   order to be approved as compliant.  This document recommends that\n   compliance\
    \ testing suites be relaxed to allow other forms of address\n   generation that\
    \ are more amenable to privacy.\n"
- title: 5.3.  Intellectual Property Rights (IPRs)
  contents:
  - "5.3.  Intellectual Property Rights (IPRs)\n   Some IPv6 addressing techniques\
    \ might be covered by Intellectual\n   Property rights, which might limit their\
    \ implementation in different\n   operating systems.  [CGA-IPR] and [KAME-CGA]\
    \ discuss the IPRs on\n   CGAs.\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   This whole document concerns the privacy and\
    \ security properties of\n   different IPv6 address generation mechanisms.\n"
- title: 7.  References
  contents:
  - '7.  References

    '
- title: 7.1.  Normative References
  contents:
  - "7.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119,\n  \
    \            DOI 10.17487/RFC2119, March 1997,\n              <http://www.rfc-editor.org/info/rfc2119>.\n\
    \   [RFC2464]  Crawford, M., \"Transmission of IPv6 Packets over Ethernet\n  \
    \            Networks\", RFC 2464, DOI 10.17487/RFC2464, December 1998,\n    \
    \          <http://www.rfc-editor.org/info/rfc2464>.\n   [RFC3315]  Droms, R.,\
    \ Ed., Bound, J., Volz, B., Lemon, T., Perkins,\n              C., and M. Carney,\
    \ \"Dynamic Host Configuration Protocol\n              for IPv6 (DHCPv6)\", RFC\
    \ 3315, DOI 10.17487/RFC3315, July\n              2003, <http://www.rfc-editor.org/info/rfc3315>.\n\
    \   [RFC3971]  Arkko, J., Ed., Kempf, J., Zill, B., and P. Nikander,\n       \
    \       \"SEcure Neighbor Discovery (SEND)\", RFC 3971,\n              DOI 10.17487/RFC3971,\
    \ March 2005,\n              <http://www.rfc-editor.org/info/rfc3971>.\n   [RFC3972]\
    \  Aura, T., \"Cryptographically Generated Addresses (CGA)\",\n              RFC\
    \ 3972, DOI 10.17487/RFC3972, March 2005,\n              <http://www.rfc-editor.org/info/rfc3972>.\n\
    \   [RFC4380]  Huitema, C., \"Teredo: Tunneling IPv6 over UDP through\n      \
    \        Network Address Translations (NATs)\", RFC 4380,\n              DOI 10.17487/RFC4380,\
    \ February 2006,\n              <http://www.rfc-editor.org/info/rfc4380>.\n  \
    \ [RFC4862]  Thomson, S., Narten, T., and T. Jinmei, \"IPv6 Stateless\n      \
    \        Address Autoconfiguration\", RFC 4862,\n              DOI 10.17487/RFC4862,\
    \ September 2007,\n              <http://www.rfc-editor.org/info/rfc4862>.\n \
    \  [RFC4941]  Narten, T., Draves, R., and S. Krishnan, \"Privacy\n           \
    \   Extensions for Stateless Address Autoconfiguration in\n              IPv6\"\
    , RFC 4941, DOI 10.17487/RFC4941, September 2007,\n              <http://www.rfc-editor.org/info/rfc4941>.\n\
    \   [RFC5991]  Thaler, D., Krishnan, S., and J. Hoagland, \"Teredo\n         \
    \     Security Updates\", RFC 5991, DOI 10.17487/RFC5991,\n              September\
    \ 2010, <http://www.rfc-editor.org/info/rfc5991>.\n   [RFC6724]  Thaler, D., Ed.,\
    \ Draves, R., Matsumoto, A., and T. Chown,\n              \"Default Address Selection\
    \ for Internet Protocol Version 6\n              (IPv6)\", RFC 6724, DOI 10.17487/RFC6724,\
    \ September 2012,\n              <http://www.rfc-editor.org/info/rfc6724>.\n \
    \  [RFC7136]  Carpenter, B. and S. Jiang, \"Significance of IPv6\n           \
    \   Interface Identifiers\", RFC 7136, DOI 10.17487/RFC7136,\n              February\
    \ 2014, <http://www.rfc-editor.org/info/rfc7136>.\n   [RFC7217]  Gont, F., \"\
    A Method for Generating Semantically Opaque\n              Interface Identifiers\
    \ with IPv6 Stateless Address\n              Autoconfiguration (SLAAC)\", RFC\
    \ 7217,\n              DOI 10.17487/RFC7217, April 2014,\n              <http://www.rfc-editor.org/info/rfc7217>.\n"
- title: 7.2.  Informative References
  contents:
  - "7.2.  Informative References\n   [Broersma] Broersma, R., \"IPv6 Everywhere:\
    \ Living with a Fully\n              IPv6-enabled environment\",  Australian IPv6\
    \ Summit 2010,\n              Melbourne, VIC Australia, October 2010,\n      \
    \        <http://www.ipv6.org.au/10ipv6summit/talks/\n              Ron_Broersma.pdf>.\n\
    \   [CGA-IPR]  IETF, \"IPR Details: Microsoft's Statement about IPR\n        \
    \      claimed in RFC 3972\", November 2005,\n              <https://datatracker.ietf.org/ipr/676/>.\n\
    \   [DHCPv6-IID]\n              Gont, F. and W. Liu, \"A Method for Generating\
    \ Semantically\n              Opaque Interface Identifiers with Dynamic Host\n\
    \              Configuration Protocol for IPv6 (DHCPv6)\", Work in\n         \
    \     Progress, draft-ietf-dhc-stable-privacy-addresses-02,\n              April\
    \ 2015.\n   [KAME-CGA] The KAME Project, \"The KAME IPR policy and concerns of\n\
    \              some technologies which have IPR claims\", November 2005,\n   \
    \           <http://www.kame.net/newsletter/20040525/>.\n   [Microsoft]\n    \
    \          Microsoft, \"IPv6 interface identifiers\", 2013,\n              <http://www.microsoft.com/resources/documentation/\n\
    \              windows/xp/all/proddocs/en-us/\n              sag_ip_v6_imp_addr7.mspx?mfr=true>.\n\
    \   [Panopticlick]\n              Electronic Frontier Foundation, \"Panopticlick\"\
    , 2011,\n              <http://panopticlick.eff.org>.\n   [RFC1971]  Thomson,\
    \ S. and T. Narten, \"IPv6 Stateless Address\n              Autoconfiguration\"\
    , RFC 1971, DOI 10.17487/RFC1971, August\n              1996, <http://www.rfc-editor.org/info/rfc1971>.\n\
    \   [RFC1972]  Crawford, M., \"A Method for the Transmission of IPv6\n       \
    \       Packets over Ethernet Networks\", RFC 1972,\n              DOI 10.17487/RFC1972,\
    \ August 1996,\n              <http://www.rfc-editor.org/info/rfc1972>.\n   [RFC3041]\
    \  Narten, T. and R. Draves, \"Privacy Extensions for\n              Stateless\
    \ Address Autoconfiguration in IPv6\", RFC 3041,\n              DOI 10.17487/RFC3041,\
    \ January 2001,\n              <http://www.rfc-editor.org/info/rfc3041>.\n   [RFC3261]\
    \  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,\n              A.,\
    \ Peterson, J., Sparks, R., Handley, M., and E.\n              Schooler, \"SIP:\
    \ Session Initiation Protocol\", RFC 3261,\n              DOI 10.17487/RFC3261,\
    \ June 2002,\n              <http://www.rfc-editor.org/info/rfc3261>.\n   [RFC3314]\
    \  Wasserman, M., Ed., \"Recommendations for IPv6 in Third\n              Generation\
    \ Partnership Project (3GPP) Standards\",\n              RFC 3314, DOI 10.17487/RFC3314,\
    \ September 2002,\n              <http://www.rfc-editor.org/info/rfc3314>.\n \
    \  [RFC3484]  Draves, R., \"Default Address Selection for Internet\n         \
    \     Protocol version 6 (IPv6)\", RFC 3484,\n              DOI 10.17487/RFC3484,\
    \ February 2003,\n              <http://www.rfc-editor.org/info/rfc3484>.\n  \
    \ [RFC5214]  Templin, F., Gleeson, T., and D. Thaler, \"Intra-Site\n         \
    \     Automatic Tunnel Addressing Protocol (ISATAP)\", RFC 5214,\n           \
    \   DOI 10.17487/RFC5214, March 2008,\n              <http://www.rfc-editor.org/info/rfc5214>.\n\
    \   [RFC6052]  Bao, C., Huitema, C., Bagnulo, M., Boucadair, M., and X.\n    \
    \          Li, \"IPv6 Addressing of IPv4/IPv6 Translators\", RFC 6052,\n     \
    \         DOI 10.17487/RFC6052, October 2010,\n              <http://www.rfc-editor.org/info/rfc6052>.\n\
    \   [RFC6265]  Barth, A., \"HTTP State Management Mechanism\", RFC 6265,\n   \
    \           DOI 10.17487/RFC6265, April 2011,\n              <http://www.rfc-editor.org/info/rfc6265>.\n\
    \   [RFC6973]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,\n        \
    \      Morris, J., Hansen, M., and R. Smith, \"Privacy\n              Considerations\
    \ for Internet Protocols\", RFC 6973,\n              DOI 10.17487/RFC6973, July\
    \ 2013,\n              <http://www.rfc-editor.org/info/rfc6973>.\n   [RFC7421]\
    \  Carpenter, B., Ed., Chown, T., Gont, F., Jiang, S.,\n              Petrescu,\
    \ A., and A. Yourtchenko, \"Analysis of the 64-bit\n              Boundary in\
    \ IPv6 Addressing\", RFC 7421,\n              DOI 10.17487/RFC7421, January 2015,\n\
    \              <http://www.rfc-editor.org/info/rfc7421>.\n   [RFC7596]  Cui, Y.,\
    \ Sun, Q., Boucadair, M., Tsou, T., Lee, Y., and I.\n              Farrer, \"\
    Lightweight 4over6: An Extension to the Dual-\n              Stack Lite Architecture\"\
    , RFC 7596, DOI 10.17487/RFC7596,\n              July 2015, <http://www.rfc-editor.org/info/rfc7596>.\n\
    \   [RFC7597]  Troan, O., Ed., Dec, W., Li, X., Bao, C., Matsushima, S.,\n   \
    \           Murakami, T., and T. Taylor, Ed., \"Mapping of Address and\n     \
    \         Port with Encapsulation (MAP-E)\", RFC 7597,\n              DOI 10.17487/RFC7597,\
    \ July 2015,\n              <http://www.rfc-editor.org/info/rfc7597>.\n   [RFC7599]\
    \  Li, X., Bao, C., Dec, W., Ed., Troan, O., Matsushima, S.,\n              and\
    \ T. Murakami, \"Mapping of Address and Port using\n              Translation\
    \ (MAP-T)\", RFC 7599, DOI 10.17487/RFC7599, July\n              2015, <http://www.rfc-editor.org/info/rfc7599>.\n\
    \   [RFC7707]  Gont, F. and T. Chown, \"Network Reconnaissance in IPv6\n     \
    \         Networks\", RFC 7707, DOI 10.17487/RFC7707, March 2016,\n          \
    \    <http://www.rfc-editor.org/info/rfc7707>.\n"
- title: Acknowledgements
  contents:
  - "Acknowledgements\n   The authors would like to thank Bernard Aboba, Brian Carpenter,\
    \ Tim\n   Chown, Lorenzo Colitti, Rich Draves, Robert Hinden, Robert Moskowitz,\n\
    \   Erik Nordmark, Mark Smith, Ole Troan, and James Woodyatt for\n   providing\
    \ valuable comments on earlier draft versions of this\n   document.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Alissa Cooper\n   Cisco\n   707 Tasman Drive\n   Milpitas,\
    \ CA  95035\n   United States\n   Phone: +1-408-902-3950\n   Email: alcoop@cisco.com\n\
    \   URI:   https://www.cisco.com/\n   Fernando Gont\n   Huawei Technologies\n\
    \   Evaristo Carriego 2644\n   Haedo, Provincia de Buenos Aires  1706\n   Argentina\n\
    \   Phone: +54 11 4650 8472\n   Email: fgont@si6networks.com\n   URI:   http://www.si6networks.com\n\
    \   Dave Thaler\n   Microsoft\n   One Microsoft Way\n   Redmond, WA  98052\n \
    \  United States\n   Phone: +1 425 703 8835\n   Email: dthaler@microsoft.com\n"
