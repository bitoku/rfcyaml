- title: __initial_text__
  contents:
  - '                IP Router Alert Considerations and Usage

    '
- title: Abstract
  contents:
  - "Abstract\n   The IP Router Alert Option is an IP option that alerts transit\n\
    \   routers to more closely examine the contents of an IP packet.  The\n   Resource\
    \ reSerVation Protocol (RSVP), Pragmatic General Multicast\n   (PGM), the Internet\
    \ Group Management Protocol (IGMP), Multicast\n   Listener Discovery (MLD), Multicast\
    \ Router Discovery (MRD), and\n   General Internet Signaling Transport (GIST)\
    \ are some of the protocols\n   that make use of the IP Router Alert Option. \
    \ This document discusses\n   security aspects and usage guidelines around the\
    \ use of the current\n   IP Router Alert Option, thereby updating RFC 2113 and\
    \ RFC 2711.\n   Specifically, it provides recommendations against using the Router\n\
    \   Alert in the end-to-end open Internet and identifies controlled\n   environments\
    \ where protocols depending on Router Alert can be used\n   safely.  It also provides\
    \ recommendations about protection approaches\n   for service providers.  Finally,\
    \ it provides brief guidelines for\n   Router Alert implementation on routers.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo documents an Internet Best Current Practice.\n\
    \   This document is a product of the Internet Engineering Task Force\n   (IETF).\
    \  It represents the consensus of the IETF community.  It has\n   received public\
    \ review and has been approved for publication by the\n   Internet Engineering\
    \ Steering Group (IESG).  Further information on\n   BCPs is available in Section\
    \ 2 of RFC 5741.\n   Information about the current status of this document, any\
    \ errata,\n   and how to provide feedback on it may be obtained at\n   http://www.rfc-editor.org/info/rfc6398.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2011 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Terminology .....................................................4\n  \
    \    2.1. Conventions Used in This Document ..........................4\n   3.\
    \ Security Concerns of Router Alert ...............................5\n   4. Guidelines\
    \ for Use of Router Alert ..............................7\n      4.1. Use of Router\
    \ Alert End to End in the Internet\n           (Router Alert in Peer Model) ...............................7\n\
    \      4.2. Use of Router Alert in Controlled Environments .............9\n  \
    \         4.2.1. Use of Router Alert within an Administrative\n              \
    \    Domain ..............................................9\n           4.2.2.\
    \ Use of Router Alert in Overlay Model ...............11\n      4.3. Router Alert\
    \ Protection Approaches for Service Providers ..13\n   5. Guidelines for Router\
    \ Alert Implementation .....................15\n   6. Security Considerations\
    \ ........................................16\n   7. Contributors ...................................................16\n\
    \   8. Acknowledgments ................................................16\n  \
    \ 9. References .....................................................17\n    \
    \  9.1. Normative References ......................................17\n      9.2.\
    \ Informative References ....................................17\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   [RFC2113] and [RFC2711] define the IPv4 and IPv6 Router\
    \ Alert Options\n   (RAOs), respectively.  In this document, we collectively refer\
    \ to\n   those options as the IP Router Alert.  The IP Router Alert Option is\n\
    \   an IP option that alerts transit routers to more closely examine the\n   contents\
    \ of an IP packet.\n   Some of the protocols that make use of the IP Router Alert\
    \ are the\n   Resource reSerVation Protocol (RSVP) ([RFC2205], [RFC3175],\n  \
    \ [RFC3209]), Pragmatic General Multicast (PGM) ([RFC3208]), the\n   Internet\
    \ Group Management Protocol (IGMP) ([RFC3376]), Multicast\n   Listener Discovery\
    \ (MLD) ([RFC2710], [RFC3810]), Multicast Router\n   Discovery (MRD) ([RFC4286]),\
    \ and Next Steps in Signaling (NSIS)\n   General Internet Signaling Transport\
    \ (GIST) ([RFC5971]).\n   Section 3 describes the security concerns associated\
    \ with the use of\n   the Router Alert Option.\n   Section 4 provides guidelines\
    \ for the use of Router Alert.  More\n   specifically, Section 4.1 recommends\
    \ that Router Alert not be used\n   for end-to-end applications over the Internet,\
    \ while Section 4.2\n   presents controlled environments where applications/protocols\
    \ relying\n   on IP Router Alert can be deployed effectively and safely.\n   Section\
    \ 4.3 provides recommendations on protection approaches to be\n   used by service\
    \ providers in order to protect their network from\n   Router-Alert-based attacks.\n\
    \   Finally, Section 5 provides generic recommendations for router\n   implementation\
    \ of Router Alert, aiming at increasing protection\n   against attacks.\n   This\
    \ document discusses considerations and practices based on the\n   current specifications\
    \ of IP Router Alert ([RFC2113], [RFC2711]).\n   Possible future enhancements\
    \ to the specifications of IP Router Alert\n   (in view of reducing the security\
    \ risks associated with the use of IP\n   Router Alert) are outside the scope\
    \ of this document.  One such\n   proposal is discussed in [RAO-EXT], but at the\
    \ time of this writing,\n   the IETF has not adopted any extensions for this purpose.\n\
    \   The IPv6 base specification [RFC2460] defines the hop-by-hop options\n   extension\
    \ header.  The hop-by-hop options header is used to carry\n   optional information\
    \ that must be examined by every node along a\n   packet's delivery path.  The\
    \ IPv6 Router Alert Option is one\n   particular hop-by-hop option.  Similar security\
    \ concerns to those\n   discussed in this document for the IPv6 Router Alert apply\
    \ more\n   generically to the concept of the IPv6 hop-by-hop options extension\n\
    \   header.  However, thoroughly addressing the broader concept of the\n   IPv6\
    \ hop-by-hop option would require additional material so as to\n   cover additional\
    \ considerations associated with it (e.g., the\n   effectiveness of the attack\
    \ could depend on how many options are\n   included and on the range to which\
    \ the option-type value belongs), so\n   this is kept outside the scope of this\
    \ document.  A detailed\n   discussion about security risks and proposed remedies\
    \ associated with\n   the IPv6 hop-by-hop option can be found in [IPv6-HOPBYHOP].\n\
    \   The IPv4 base specification [RFC0791] defines a general notion of\n   IPv4\
    \ options that can be included in the IPv4 header (without\n   distinguishing\
    \ between the hop-by-hop and end-to-end options).  The\n   IPv4 Router Alert Option\
    \ is one particular IPv4 option.  Security\n   concerns similar to those discussed\
    \ in this document for the IPv4\n   Router Alert apply more generically to the\
    \ concept of the IPv4\n   option.  However, thoroughly addressing the security\
    \ concerns of the\n   broader concept of the IPv4 option is kept outside the scope\
    \ of this\n   document, because it would require additional material so as to\
    \ cover\n   additional considerations associated with it (such as lack of option\n\
    \   ordering, etc.), and because other IPv4 options are often blocked in\n   firewalls\
    \ and not very widely used, so the practical risks they\n   present are largely\
    \ nonexistent.\n"
- title: 2.  Terminology
  contents:
  - "2.  Terminology\n   For readability, this document uses the following loosely\
    \ defined\n   terms:\n   o  Fast path: Hardware or Application-Specific Integrated\
    \ Circuit\n      (ASIC) processing path for packets.  This is the nominal\n  \
    \    processing path within a router for IP datagrams.\n   o  Slow path: Software\
    \ processing path for packets.  This is a sub-\n      nominal processing path\
    \ for packets that require special\n      processing or differ from assumptions\
    \ made in fast-path\n      heuristics.\n   o  Next level protocol: The protocol\
    \ transported in the IP datagram.\n      In IPv4 [RFC0791], the next level protocol\
    \ is identified by the\n      IANA protocol number conveyed in the 8-bit \"Protocol\"\
    \ field in the\n      IPv4 header.  In IPv6 [RFC2460], the next level protocol\
    \ is\n      identified by the IANA protocol number conveyed in the 8-bit \"Next\n\
    \      Header\" field in the IPv6 header.\n"
- title: 2.1.  Conventions Used in This Document
  contents:
  - "2.1.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 3.  Security Concerns of Router Alert
  contents:
  - "3.  Security Concerns of Router Alert\n   The IP Router Alert Option is defined\
    \ ([RFC2113], [RFC2711]) as a\n   mechanism that alerts transit routers to more\
    \ closely examine the\n   contents of an IP packet.  [RFC4081] and [RFC2711] mention\
    \ the\n   security risks associated with the use of the IP Router Alert:\n   flooding\
    \ a router with bogus (or simply undesired) IP datagrams that\n   contain the\
    \ IP Router Alert could impact operation of the router in\n   undesirable ways.\
    \  For example, if the router punts the datagrams\n   containing the IP Router\
    \ Alert Option to the slow path, such an\n   attack could consume a significant\
    \ share of the router's slow path\n   and could also lead to packet drops in the\
    \ slow path (affecting\n   operation of all other applications and protocols operating\
    \ in the\n   slow path), thereby resulting in a denial of service (DoS)\n   ([RFC4732]).\n\
    \   Furthermore, [RFC2113] specifies no (and [RFC2711] specifies a very\n   limited)\
    \ mechanism for identifying different users of IP Router\n   Alert.  As a result,\
    \ many fast switching implementations of IP Router\n   Alert punt most/all packets\
    \ marked with IP Router Alert into the slow\n   path (unless configured to systematically\
    \ ignore or drop all Router\n   Alert packets).  However, some existing deployed\
    \ IP routers can and\n   do process IP packets containing the Router Alert Option\
    \ inside the\n   fast path.\n   Some IP Router Alert implementations are able\
    \ to take into account\n   the next level protocol as a discriminator for the\
    \ punting decision\n   for different protocols using IP Router Alert.  However,\
    \ this still\n   only allows very coarse triage among various protocols using\
    \ IP\n   Router Alert, for two reasons.  First, the next level protocol is the\n\
    \   same when IP Router Alert is used for different applications of the\n   same\
    \ protocol (e.g., RSVP vs. RSVP - Traffic Engineering (RSVP-TE)),\n   or when\
    \ IP Router Alert is used for different contexts of the same\n   application (e.g.,\
    \ different levels of RSVP aggregation [RFC3175]).\n   Thus, it is not always\
    \ possible to achieve the necessary triage in\n   the fast path across IP Router\
    \ Alert packets from different\n   applications or from different contexts of\
    \ an application.  Secondly,\n   some protocols requiring punting might be carried\
    \ over a transport\n   protocol (e.g., TCP or UDP), possibly because (1) they\
    \ require the\n   services of that transport protocol, (2) the protocol does not\n\
    \   justify allocation of a scarce next level protocol value, or (3) not\n   relying\
    \ on a very widely deployed transport protocol is likely to\n   result in deployment\
    \ issues due to common middlebox behaviors (e.g.,\n   firewalls or NATs discarding\
    \ packets of \"unknown\" protocols).  Thus,\n   considering the next level protocol\
    \ alone in the fast path is not\n   sufficient to allow triage in the fast path\
    \ of IP Router Alert\n   packets from different protocols sharing the same transport\
    \ protocol.\n   Therefore, it is generally not possible to ensure that only the\
    \ IP\n   Router Alert packets for next level protocols of interest are punted\n\
    \   to the slow path while other IP Router Alert packets are efficiently\n   forwarded\
    \ (i.e., in the fast path).\n   Some IP Router Alert implementations are able\
    \ to take into account\n   the Value field inside the Router Alert Option.  However,\
    \ only one\n   value (zero) was defined in [RFC2113], and no IANA registry for\
    \ IPv4\n   Router Alert values was available until recently ([RFC5350]).  So\n\
    \   this did not allow most IPv4 Router Alert implementations to support\n   useful\
    \ classification based on the Value field in the fast path.\n   Also, while [RFC2113]\
    \ states that unknown values should be ignored\n   (i.e., the packets should be\
    \ forwarded as normal IP traffic), it has\n   been reported that some existing\
    \ implementations simply ignore the\n   Value field completely (i.e., process\
    \ any packet with an IPv4 Router\n   Alert regardless of its option value).  An\
    \ IANA registry for further\n   allocation of IPv4 Router Alert values has been\
    \ introduced recently\n   ([RFC5350]), but this would only allow coarse-grain\
    \ classification,\n   if supported by implementations.  For IPv6, [RFC2711] states\
    \ that\n   \"the Value field can be used by an implementation to speed processing\n\
    \   of the datagram within the transit router\" and defines an IANA\n   registry\
    \ for these values.  But again, this only allows coarse-grain\n   classification.\
    \  Besides, some existing IPv6 Router Alert\n   implementations are reported to\
    \ depart from that behavior.\n   [RFC2711] mentions that limiting, by rate or\
    \ some other means, the\n   use of the IP Router Alert Option is a way of protecting\
    \ against a\n   potential attack.  However, if rate limiting is used as a protection\n\
    \   mechanism, but if the granularity of the rate limiting is not fine\n   enough\
    \ to distinguish IP Router Alert packets of interest from\n   unwanted IP Router\
    \ Alert packets, an IP Router Alert attack could\n   still severely degrade operation\
    \ of protocols of interest that depend\n   on the use of IP Router Alert.\n  \
    \ In a nutshell, the IP Router Alert Option does not provide a\n   convenient\
    \ universal mechanism to accurately and reliably distinguish\n   between IP Router\
    \ Alert packets of interest and unwanted IP Router\n   Alert packets.  This, in\
    \ turn, creates a security concern when the IP\n   Router Alert Option is used,\
    \ because, short of appropriate router-\n   implementation-specific mechanisms,\
    \ the router slow path is at risk\n   of being flooded by unwanted traffic.\n\
    \   Note that service providers commonly allow external parties to\n   communicate\
    \ with a control plane application in their routers, such\n   as with BGP peering.\
    \  Depending on the actual environment and BGP\n   security practices, with BGP\
    \ peering, the resulting DoS attack vector\n   is similar to or somewhat less\
    \ serious than it would be with the\n   Router Alert Option for a number of reasons,\
    \ including the following:\n   o  With BGP, edge routers only exchange control\
    \ plane information\n      with pre-identified peers and can easily filter out\
    \ any control\n      plane traffic coming from other peers or non-authenticated\
    \ peers,\n      while the Router Alert Option can be received in a datagram with\n\
    \      any source address and any destination address.  However, we note\n   \
    \   that the effectiveness of such BGP filtering is dependent on\n      proper\
    \ security practices; poor BGP security practices (such as\n      infrequent or\
    \ nonexistent update of BGP peers' authentication\n      keys) create vulnerabilities\
    \ through which the BGP authentication\n      mechanisms can be compromised.\n\
    \   o  With BGP peering, the control plane hole is only open on the edge\n   \
    \   routers, and core routers are completely isolated from any direct\n      control\
    \ plane exchange with entities outside the administrative\n      domain.  Thus,\
    \ with BGP, a DoS attack would only affect the edge\n      routers, while with\
    \ the Router Alert Option, the attack could\n      propagate to core routers.\
    \  However, in some BGP environments, the\n      distinction between edge and\
    \ core routers is not strict, and many/\n      most/all routers act as both edge\
    \ and core routers; in such BGP\n      environments, a large part of the network\
    \ is exposed to direct\n      control plane exchanges with entities outside the\
    \ administrative\n      domain (as it would be with Router Alert).\n   o  With\
    \ BGP, the BGP policy control would typically prevent re-\n      injection of\
    \ undesirable information out of the attacked device,\n      while with the Router\
    \ Alert Option, the non-filtered attacking\n      messages would typically be\
    \ forwarded downstream.  However, we\n      note that there have been real-life\
    \ occurrences of situations\n      where incorrect information was propagated\
    \ through the BGP system,\n      causing widespread problems.\n"
- title: 4.  Guidelines for Use of Router Alert
  contents:
  - '4.  Guidelines for Use of Router Alert

    '
- title: 4.1.  Use of Router Alert End to End in the Internet (Router Alert in
  contents:
  - "4.1.  Use of Router Alert End to End in the Internet (Router Alert in\n     \
    \ Peer Model)\n   Because of the security concerns associated with Router Alert\n\
    \   discussed in Section 3, network operators SHOULD actively protect\n   themselves\
    \ against externally generated IP Router Alert packets.\n   Because there are\
    \ no convenient universal mechanisms to triage\n   between desired and undesired\
    \ Router Alert packets, network operators\n   currently often protect themselves\
    \ in ways that isolate them from\n   externally generated IP Router Alert packets.\
    \  This might be achieved\n   by tunneling IP Router Alert packets [RFC6178] so\
    \ that the IP Router\n   Alert Option is hidden through that network, or it might\
    \ be achieved\n   via mechanisms resulting in occasional (e.g., rate limiting)\
    \ or\n   systematic drop of IP Router Alert packets.\n   Thus, applications and\
    \ protocols SHOULD NOT be deployed with a\n   dependency on processing of the\
    \ Router Alert Option (as currently\n   specified) across independent administrative\
    \ domains in the Internet.\n   Figure 1 illustrates such a hypothetical use of\
    \ Router Alert end to\n   end in the Internet.  We refer to such a model of Router\
    \ Alert Option\n   use as a \"Peer Model\" Router Alert Option use, since core\
    \ routers in\n   different administrative domains would partake in processing\
    \ of\n   Router Alert Option datagrams associated with the same signaling\n  \
    \ flow.\n       --------         --------          --------          --------\n\
    \      /   A    \\       /   B    \\        /   C    \\        /   D    \\\n \
    \     | (*)    |       | (*)    |        | (*)    |        | (*)    |\n      |\
    \ | |<============>| |<=============>| |<=============>| |    |\n      |  -  \
    \   |       |  -     |        |  -     |        |  -     |\n      \\        /\
    \       \\        /        \\        /        \\        /\n       --------   \
    \      --------          --------          --------\n       (*) closer examination\
    \ of Router Alert Option datagrams\n       <==>  flow of Router Alert Option datagrams\n\
    \       Figure 1: Use of Router Alert End to End in the Open Internet\n      \
    \                 (Router Alert in Peer Model)\n   While this recommendation is\
    \ framed here specifically in the context\n   of Router Alert, the fundamental\
    \ security risk that network operators\n   want to preclude is to allow devices/protocols\
    \ that are outside of\n   their administrative domain (and therefore not controlled)\
    \ to tap\n   into the control plane of their core routers.  Similar security\n\
    \   concerns would probably result whether this control plane access is\n   provided\
    \ through the Router Alert Option or provided by any other\n   mechanism (e.g.,\
    \ deep packet inspection).  In other words, the\n   fundamental security concern\
    \ is associated with the notion of end-to-\n   end signaling in a Peer Model across\
    \ domains in the Internet.  As a\n   result, it is expected that network operators\
    \ would typically not\n   want to have their core routers partake in end-to-end\
    \ signaling with\n   external uncontrolled devices through the open Internet,\
    \ and\n   therefore prevent deployment of end-to-end signaling in a Peer Model\n\
    \   through their network (regardless of whether that signaling uses\n   Router\
    \ Alert or not).\n"
- title: 4.2.  Use of Router Alert in Controlled Environments
  contents:
  - '4.2.  Use of Router Alert in Controlled Environments

    '
- title: 4.2.1.  Use of Router Alert within an Administrative Domain
  contents:
  - "4.2.1.  Use of Router Alert within an Administrative Domain\n   In some controlled\
    \ environments, such as within a given\n   administrative domain, the network\
    \ administrator can determine that\n   IP Router Alert packets will only be received\
    \ from trusted well-\n   behaved devices or can establish that specific protection\
    \ mechanisms\n   (e.g., RAO filtering and rate limiting) against the plausible\
    \ RAO-\n   based DoS attacks are sufficient.  In that case, an application\n \
    \  relying on exchange and handling of RAO packets (e.g., RSVP) can be\n   safely\
    \ deployed within the controlled network.  A private enterprise\n   network firewalled\
    \ from the Internet and using RSVP reservations for\n   voice and video flows\
    \ might be an example of such a controlled\n   environment.  Such an environment\
    \ is illustrated in Figure 2.\n      -------------------------          --------\
    \          --------\n     /            A            \\        /   B    \\    \
    \    /   C    \\\n     | (*)              (*)    |   --   |        |        |\
    \        |\n     | | |<============>| |    |--|FW|--|        |--------|      \
    \  |\n     |  -                -     |   --   |        |        |        |\n \
    \    \\                         /        \\        /        \\        /\n    \
    \  -------------------------          --------          --------\n      (*) closer\
    \ examination of Router Alert Option datagrams\n      <==>  flow of Router Alert\
    \ Option datagrams\n      FW: Firewall\n      Figure 2: Use of Router Alert within\
    \ an Administrative Domain -\n          Private Enterprise Network Firewalled\
    \ from the Internet\n                        and Using RSVP Reservations\n   In\
    \ some controlled environments, several administrative domains have\n   a special\
    \ relationship whereby they cooperate very tightly and\n   effectively operate\
    \ as a single trust domain.  In that case, one\n   domain is willing to trust\
    \ another with respect to the traffic\n   injected across the boundary.  In other\
    \ words, a downstream domain is\n   willing to trust that the traffic injected\
    \ at the boundary has been\n   properly validated/filtered by the upstream domain.\
    \  Where it has\n   been established that such trust can be applied to Router\
    \ Alert\n   Option packets, an application relying on exchange and handling of\n\
    \   RAO packets (e.g., RSVP) can be safely deployed within such a\n   controlled\
    \ environment.  The entity within a company responsible for\n   operating multimedia\
    \ endpoints and the entity within the same company\n   responsible for operating\
    \ the network might be an example of such a\n   controlled environment.  For example,\
    \ they might collaborate so that\n   RSVP reservations can be used for video flows\
    \ from endpoints to\n   endpoints through the network.\n   In some environments,\
    \ the network administrator can reliably ensure\n   that Router Alert packets\
    \ from any untrusted device (e.g., from\n   external routers) are prevented from\
    \ entering a trusted area (e.g.,\n   the internal routers).  For example, this\
    \ might be achieved by\n   ensuring that routers straddling the trust boundary\
    \ (e.g., edge\n   routers) always encapsulate those packets (without setting IP\
    \ Router\n   Alert -or equivalent- in the encapsulating header) through the\n\
    \   trusted area (as discussed in [RFC6178]).  In such environments, the\n   risks\
    \ of DoS attacks through the IP Router Alert vector are removed\n   (or greatly\
    \ reduced) in the trusted area even if IP Router Alert is\n   used inside the\
    \ trusted area (say, for RSVP-TE).  Thus, an\n   application relying on IP Router\
    \ Alert can be safely deployed within\n   the trusted area.  A service provider\
    \ running RSVP-TE within its\n   network might be an example of such a protected\
    \ environment.  Such an\n   environment is illustrated in Figure 3.\n      --------\
    \         --------------------------          --------\n     /   A    \\     \
    \  /             B            \\        /   C    \\\n     |        |       | \
    \ (*)               (*)   |        |        |\n     |        |-------TT | |<=============>|\
    \ |  TT------- |        |\n     |        |       |   -                 -    |\
    \        |        |\n     \\        /       \\                          /    \
    \    \\        /\n      --------         --------------------------          --------\n\
    \      (*) closer examination of Router Alert Option datagrams\n      <==>  flow\
    \ of Router Alert Option datagrams\n      TT: Tunneling of Router Alert Option\
    \ datagrams\n      Figure 3: Use of Router Alert within an Administrative Domain\
    \ -\n            Service Provider Running RSVP-TE within Its Network\n"
- title: 4.2.2.  Use of Router Alert in Overlay Model
  contents:
  - "4.2.2.  Use of Router Alert in Overlay Model\n   In some controlled environment:\n\
    \   o  The sites of a network A are interconnected through a service\n      provider\
    \ network B.\n   o  The service provider network B protects itself from IP Router\n\
    \      Alert messages without dropping those messages when they transit\n    \
    \  over the network (for example, using mechanisms discussed in\n      [RFC6178]).\n\
    \   In such a controlled environment, an application relying on exchange\n   and\
    \ handling of RAO packets (e.g., RSVP) in the network A sites (but\n   not inside\
    \ network B) can be safely deployed.  We refer to such a\n   deployment as a use\
    \ of Router Alert in a Water-Tight Overlay --\n   \"Overlay\", because Router\
    \ Alert Option datagrams are used in network\n   A on top of, and completely transparently\
    \ to, network B; and\n   \"Water-Tight\", because Router Alert Option datagrams\
    \ from network A\n   cannot leak inside network B.  A private enterprise intranet\
    \ realized\n   as a Virtual Private Network (VPN) over a service provider network\n\
    \   and using RSVP to perform reservations within the enterprise sites\n   for\
    \ voice and video flows might be an example of such a controlled\n   environment.\
    \  Such an environment is illustrated in Figure 4.\n          --------       \
    \                         --------\n         /   A    \\                     \
    \         /   A    \\\n         | (*)    |                              |   (*)\
    \  |\n         | | |<=====================================>| |  |\n         |\
    \  -     |                              |    -   |\n         \\        /     \
    \                         \\        /\n          --------                    \
    \            --------\n                \\                                 /\n\
    \                 \\   -------------------------   /\n                  \\ / \
    \          B             \\ /\n                   \\|                        \
    \ |/\n                    TT                       TT\n                    | \
    \                        |\n                    \\                         /\n\
    \                     -------------------------\n        (*) closer examination\
    \ of Router Alert Option datagrams\n        <==>  flow of Router Alert Option\
    \ datagrams\n        TT: Tunneling of Router Alert Option datagrams\n        \
    \   Figure 4: Use of Router Alert in Water-Tight Overlay\n   In the controlled\
    \ environment described above, an application relying\n   on exchange and handling\
    \ of RAO packets (e.g., RSVP-TE) in the\n   service provider network B (but not\
    \ in network A) can also be safely\n   deployed simultaneously.  Such an environment\
    \ with independent,\n   isolated deployment of Router Alert in overlay at two\
    \ levels is\n   illustrated in Figure 5.\n          --------                 \
    \               --------\n         /   A    \\                              /\
    \   A    \\\n         | (*)    |                              |   (*)  |\n   \
    \      | | |<=====================================>| |  |\n         |  -     |\
    \                              |    -   |\n         \\        /              \
    \                \\        /\n          --------                             \
    \   --------\n                \\                                 /\n         \
    \        \\   -------------------------   /\n                  \\ /          \
    \ B             \\ /\n                   \\|  (*)              (*)   |/\n    \
    \                TT | |<============>| | TT\n                    |   -       \
    \         -    |\n                    \\                         /\n         \
    \            -------------------------\n      (*) closer examination of Router\
    \ Alert Option datagrams\n      <==>  flow of Router Alert Option datagrams\n\
    \      TT: Tunneling of Router Alert Option datagrams\n    Figure 5: Use of Router\
    \ Alert in Water-Tight Overlay at Two Levels\n   In some controlled environment:\n\
    \   o  The sites of a network A are interconnected through a service\n      provider\
    \ network B.\n   o  The service provider B processes Router Alert packets on the\
    \ edge\n      routers and protects these edge routers against RAO-based attacks\n\
    \      using mechanisms such as (possibly per port) RAO rate limiting and\n  \
    \    filtering.\n   o  The service provider network B protects its core routers\
    \ from\n      Router Alert messages without dropping those messages when they\n\
    \      transit over the network (for example, using mechanisms discussed\n   \
    \   in [RFC6178]).\n   In such a controlled environment, an application relying\
    \ on exchange\n   and handling of RAO packets (e.g., RSVP) in the network A sites\
    \ and\n   in network B's edges (but not in the core of network B) can be safely\n\
    \   deployed.  We refer to such a deployment as a use of Router Alert in\n   a\
    \ Leak-Controlled Overlay -- \"Overlay\", because Router Alert Option\n   datagrams\
    \ are used in network A on top of, and completely\n   transparently to, network\
    \ B's core; and \"Leak-Controlled\", because\n   Router Alert Option datagrams\
    \ from network A leak inside network B's\n   edges but not inside network B's\
    \ core.  A private enterprise\n   intranet, whose sites are interconnected through\
    \ a service provider\n   network, using RSVP for voice and video within network\
    \ A sites as\n   well as on network B's edge to extend the reservation onto the\n\
    \   attachment links between networks A and B (as specified in\n   [RFC6016]),\
    \ might be an example of such a controlled environment.\n   Such an environment\
    \ is illustrated in Figure 6.\n          --------                            \
    \    --------\n         /   A    \\                              /   A    \\\n\
    \         |        |                              |        |\n         |     \
    \   |   ------------------------   |        |\n         | (*)    |  /(*)     \
    \         (*)    \\  |   (*)  |\n         | | |<======>| |<============>| |<=========>|\
    \ |  |\n         |  -     |  | -                -     |  |    -   |\n        \
    \ \\        /  |  \\    -     -   /      |  \\        /\n          --------  \
    \ |   TT-| |   | |-TT      |   --------\n                     |       -     -\
    \          |\n                     \\                        /\n             \
    \         ------------------------\n        (*) closer examination of Router Alert\
    \ Option datagrams\n        <==>  flow of Router Alert Option datagrams\n    \
    \    TT: Tunneling of Router Alert Option datagrams\n         Figure 6: Use of\
    \ Router Alert in Leak-Controlled Overlay\n"
- title: 4.3.  Router Alert Protection Approaches for Service Providers
  contents:
  - "4.3.  Router Alert Protection Approaches for Service Providers\n   Section 3\
    \ discusses the security risks associated with the use of the\n   IP Router Alert\
    \ and how it opens up a DoS vector in the router\n   control plane.  Thus, a service\
    \ provider MUST implement strong\n   protection of its network against attacks\
    \ based on IP Router Alert.\n   As discussed in Section 4.2.2, some applications\
    \ can benefit from the\n   use of IP Router Alert packets in an Overlay Model\
    \ (i.e., where\n   Router Alert packets are exchanged transparently on top of\
    \ a service\n   provider).  Thus, a service provider protecting its network from\n\
    \   attacks based on IP Router Alert SHOULD use mechanisms that avoid (or\n  \
    \ at least minimize) the dropping of end-to-end IP Router Alert packets\n   (other\
    \ than those involved in an attack).\n   For example, if the service provider\
    \ does not run any protocol\n   depending on IP Router Alert within its network,\
    \ it might elect to\n   simply turn off punting/processing of IP Router Alert\
    \ packets on its\n   routers; this will ensure that end-to-end IP Router Alert\
    \ packets\n   transit transparently and safely through its network.\n   As another\
    \ example, using protection mechanisms such as selective\n   filtering and rate\
    \ limiting (which Section 5 suggests be supported by\n   IP Router Alert implementations),\
    \ a service provider can protect the\n   operation of a protocol depending on\
    \ IP Router Alert within its\n   network (e.g., RSVP-TE) while at the same time\
    \ transporting IP Router\n   Alert packets carrying another protocol that might\
    \ be used end to\n   end.  Note that the service provider might additionally use\
    \ protocol-\n   specific mechanisms that reduce the dependency on Router Alert\
    \ for\n   operation of this protocol inside the service provider environment;\n\
    \   use of RSVP refresh reduction mechanisms ([RFC2961]) would be an\n   example\
    \ of such mechanisms in the case where the service provider is\n   running RSVP-TE\
    \ within its network, since this allows the refresh of\n   existing Path and Resv\
    \ states without the use of the IP Router Alert\n   Option.\n   As yet another\
    \ example, using mechanisms such as those discussed in\n   [RFC6178], a service\
    \ provider can safely protect the operation of a\n   protocol depending on IP\
    \ Router Alert within its network (e.g.,\n   RSVP-TE) while at the same time safely\
    \ transporting IP Router Alert\n   packets carrying another protocol that might\
    \ be used end to end\n   (e.g., IPv4/IPv6 RSVP).  We observe that while tunneling\
    \ of Router\n   Alert Option datagrams over an MPLS backbone as discussed in\n\
    \   [RFC6178] is well understood, tunneling Router Alert Option datagrams\n  \
    \ over a non-MPLS IP backbone presents a number of issues (in\n   particular,\
    \ for determining where to forward the encapsulated\n   datagram) and is not common\
    \ practice at the time of writing this\n   document.\n   As a last resort, if\
    \ the service provider does not have any means to\n   safely transport end-to-end\
    \ IP Router Alert Option packets over its\n   network, the service provider can\
    \ drop those packets.  It must be\n   noted that this has the undesirable consequence\
    \ of preventing the use\n   of the Router Alert Option in the Overlay Model on\
    \ top of that\n   network, and therefore prevents users of that network from deploying\n\
    \   a number of valid applications/protocols in their environment.\n"
- title: 5.  Guidelines for Router Alert Implementation
  contents:
  - "5.  Guidelines for Router Alert Implementation\n   A router implementation of\
    \ the IP Router Alert Option SHOULD include\n   protection mechanisms against\
    \ Router-Alert-based DoS attacks as\n   appropriate for their targeted deployment\
    \ environments.  For example,\n   this can include the ability of an edge router\
    \ to \"tunnel\" received\n   IP Router Alert Option packets when forwarding those\
    \ packets over the\n   core, as discussed in [RFC6178].  As another example, although\
    \ not\n   always available from current implementations, new implementations\n\
    \   MAY include protection mechanisms such as selective (possibly\n   dynamic)\
    \ filtering and rate limiting of IP Router Alert Option\n   packets.\n   In particular,\
    \ router implementations of the IP Router Alert Option\n   SHOULD offer the configuration\
    \ option to simply ignore the presence\n   of \"IP Router Alert\" in IPv4 and\
    \ IPv6 packets.  As discussed in\n   Section 4.3, that permits IP Router Alert\
    \ packets to transit a\n   network segment without presenting an adverse operational\
    \ security\n   risk to that particular network segment, provided the operator\
    \ of\n   that network segment does not ever use the IP Router Alert messages\n\
    \   for any purpose.\n   If an IP packet contains the IP Router Alert Option,\
    \ but the next\n   level protocol is not explicitly identified as a protocol of\
    \ interest\n   by the router examining the packet, the behavior is not explicitly\n\
    \   defined by [RFC2113].  However, the behavior is implied, and, for\n   example,\
    \ the definition of RSVP in [RFC2205] assumes that the packet\n   will be forwarded\
    \ using normal forwarding based on the destination IP\n   address.  Thus, a router\
    \ implementation SHOULD forward within the\n   \"fast path\" (subject to all normal\
    \ policies and forwarding rules) a\n   packet carrying the IP Router Alert Option\
    \ containing a next level\n   protocol that is not a protocol of interest to that\
    \ router.  The \"not\n   punting\" behavior protects the router from DoS attacks\
    \ using IP\n   Router Alert packets of a protocol unknown to the router.  The\n\
    \   \"forwarding\" behavior contributes to transparent end-to-end transport\n\
    \   of IP Router Alert packets (e.g., to facilitate their use by end-to-\n   end\
    \ applications).\n   Similarly, an implementation MAY support selective forwarding\
    \ within\n   the fast path (subject to all normal policies and forwarding rules)\n\
    \   or punting of a packet with the IP Router Alert Option, based on the\n   Value\
    \ field of the Router Alert Option.  This would allow router\n   protection against\
    \ DoS attacks using IP Router Alert packets with a\n   value that is not relevant\
    \ for that router (e.g., nesting levels of\n   aggregated RSVP reservation [RFC5350]).\n"
- title: 6.  Security Considerations
  contents:
  - "6.  Security Considerations\n   This document expands the security considerations\
    \ of [RFC2113] and\n   [RFC2711], which define the IPv4 and IPv6 RAOs, respectively,\
    \ by\n   discussing security risks associated with usage of the current IP\n \
    \  Router Alert Option and associated practices.  See [RFC4081] for\n   additional\
    \ security considerations.\n"
- title: 7.  Contributors
  contents:
  - "7.  Contributors\n   The contributors to this document (in addition to the editor)\
    \ are:\n      Reshad Rahman\n      Cisco Systems\n      rrahman@cisco.com\n  \
    \    David Ward\n      Juniper Networks\n      dward@juniper.net\n      Ashok\
    \ Narayanan\n      Cisco Systems\n      ashokn@cisco.com\n      Adrian Farrel\n\
    \      OldDog Consulting\n      adrian@olddog.co.uk\n      Tony Li\n      Cisco\
    \ Systems\n      tony.li@tony.li\n"
- title: 8.  Acknowledgments
  contents:
  - "8.  Acknowledgments\n   The editor and contributors would like to thank Dave\
    \ Oran, Magnus\n   Westerlund, John Scudder, Ron Bonica, Ross Callon, Alfred Hines,\n\
    \   Carlos Pignataro, Roland Bless, Jari Arkko, and Ran Atkinson for\n   their\
    \ comments.  This document also benefited from discussions with\n   Jukka Manner\
    \ and Suresh Krishnan.  The discussion about use of the\n   Value field in the\
    \ IPv4 Router Alert is borrowed from a similar\n   discussion in [RFC5971].\n"
- title: 9.  References
  contents:
  - '9.  References

    '
- title: 9.1.  Normative References
  contents:
  - "9.1.  Normative References\n   [RFC0791]  Postel, J., \"Internet Protocol\",\
    \ STD 5, RFC 791,\n              September 1981.\n   [RFC2113]  Katz, D., \"IP\
    \ Router Alert Option\", RFC 2113,\n              February 1997.\n   [RFC2119]\
    \  Bradner, S., \"Key words for use in RFCs to Indicate\n              Requirement\
    \ Levels\", BCP 14, RFC 2119, March 1997.\n   [RFC2460]  Deering, S. and R. Hinden,\
    \ \"Internet Protocol, Version 6\n              (IPv6) Specification\", RFC 2460,\
    \ December 1998.\n   [RFC2711]  Partridge, C. and A. Jackson, \"IPv6 Router Alert\
    \ Option\",\n              RFC 2711, October 1999.\n   [RFC5350]  Manner, J. and\
    \ A. McDonald, \"IANA Considerations for the\n              IPv4 and IPv6 Router\
    \ Alert Options\", RFC 5350,\n              September 2008.\n"
- title: 9.2.  Informative References
  contents:
  - "9.2.  Informative References\n   [IPv6-HOPBYHOP]\n              Krishnan, S.,\
    \ \"The case against Hop-by-Hop options\", Work\n              in Progress, October\
    \ 2010.\n   [RAO-EXT]  Narayanan, A., Le Faucheur, F., Ward, D., and R. Rahman,\n\
    \              \"IP Router Alert Option Extension\", Work in Progress,\n     \
    \         March 2009.\n   [RFC2205]  Braden, R., Ed., Zhang, L., Berson, S., Herzog,\
    \ S., and S.\n              Jamin, \"Resource ReSerVation Protocol (RSVP) -- Version\
    \ 1\n              Functional Specification\", RFC 2205, September 1997.\n   [RFC2710]\
    \  Deering, S., Fenner, W., and B. Haberman, \"Multicast\n              Listener\
    \ Discovery (MLD) for IPv6\", RFC 2710,\n              October 1999.\n   [RFC2961]\
    \  Berger, L., Gan, D., Swallow, G., Pan, P., Tommasi, F.,\n              and\
    \ S. Molendini, \"RSVP Refresh Overhead Reduction\n              Extensions\"\
    , RFC 2961, April 2001.\n   [RFC3175]  Baker, F., Iturralde, C., Le Faucheur,\
    \ F., and B. Davie,\n              \"Aggregation of RSVP for IPv4 and IPv6 Reservations\"\
    ,\n              RFC 3175, September 2001.\n   [RFC3208]  Speakman, T., Crowcroft,\
    \ J., Gemmell, J., Farinacci, D.,\n              Lin, S., Leshchiner, D., Luby,\
    \ M., Montgomery, T., Rizzo,\n              L., Tweedly, A., Bhaskar, N., Edmonstone,\
    \ R.,\n              Sumanasekera, R., and L. Vicisano, \"PGM Reliable Transport\n\
    \              Protocol Specification\", RFC 3208, December 2001.\n   [RFC3209]\
    \  Awduche, D., Berger, L., Gan, D., Li, T., Srinivasan, V.,\n              and\
    \ G. Swallow, \"RSVP-TE: Extensions to RSVP for LSP\n              Tunnels\",\
    \ RFC 3209, December 2001.\n   [RFC3376]  Cain, B., Deering, S., Kouvelas, I.,\
    \ Fenner, B., and A.\n              Thyagarajan, \"Internet Group Management Protocol,\n\
    \              Version 3\", RFC 3376, October 2002.\n   [RFC3810]  Vida, R., Ed.,\
    \ and L. Costa, Ed., \"Multicast Listener\n              Discovery Version 2 (MLDv2)\
    \ for IPv6\", RFC 3810,\n              June 2004.\n   [RFC4081]  Tschofenig, H.\
    \ and D. Kroeselberg, \"Security Threats for\n              Next Steps in Signaling\
    \ (NSIS)\", RFC 4081, June 2005.\n   [RFC4286]  Haberman, B. and J. Martin, \"\
    Multicast Router Discovery\",\n              RFC 4286, December 2005.\n   [RFC4732]\
    \  Handley, M., Ed., Rescorla, E., Ed., and IAB, \"Internet\n              Denial-of-Service\
    \ Considerations\", RFC 4732,\n              December 2006.\n   [RFC5971]  Schulzrinne,\
    \ H. and R. Hancock, \"GIST: General Internet\n              Signalling Transport\"\
    , RFC 5971, October 2010.\n   [RFC6016]  Davie, B., Le Faucheur, F., and A. Narayanan,\
    \ \"Support for\n              the Resource Reservation Protocol (RSVP) in Layer\
    \ 3 VPNs\",\n              RFC 6016, October 2010.\n   [RFC6178]  Smith, D., Mullooly,\
    \ J., Jaeger, W., and T. Scholl, \"Label\n              Edge Router Forwarding\
    \ of IPv4 Option Packets\", RFC 6178,\n              March 2011.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Francois Le Faucheur (editor)\n   Cisco Systems\n   Greenside,\
    \ 400 Avenue de Roumanille\n   Sophia Antipolis  06410\n   France\n   Phone: +33\
    \ 4 97 23 26 19\n   EMail: flefauch@cisco.com\n"
