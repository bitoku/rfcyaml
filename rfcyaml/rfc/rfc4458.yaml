- title: __initial_text__
  contents:
  - "        Session Initiation Protocol (SIP) URIs for Applications\n         such\
    \ as Voicemail and Interactive Voice Response (IVR)\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
- title: Abstract
  contents:
  - "Abstract\n   The Session Initiation Protocol (SIP) is often used to initiate\n\
    \   connections to applications such as voicemail or interactive voice\n   recognition\
    \ systems.  This specification describes a convention for\n   forming SIP service\
    \ URIs that request particular services based on\n   redirecting targets from\
    \ such applications.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................3\n\
    \   2. Mechanism (User Agent Server and Proxy) .........................4\n  \
    \    2.1. Target .....................................................4\n    \
    \  2.2. Cause ......................................................4\n      2.3.\
    \ Retrieving Messages ........................................5\n   3. Interaction\
    \ with Request History Information ....................5\n   4. Limitations of\
    \ Voicemail URI ....................................6\n   5. Syntax ..........................................................6\n\
    \   6. Examples ........................................................7\n  \
    \    6.1. Proxy Forwards Busy to Voicemail ...........................7\n    \
    \  6.2. Endpoint Forwards Busy to Voicemail ........................9\n      6.3.\
    \ Endpoint Forwards Busy to TDM via a Gateway ...............11\n      6.4. Endpoint\
    \ Forwards Busy to Voicemail with History Info .....13\n      6.5. Zero Configuration\
    \ UM System ..............................14\n      6.6. Call Coverage .............................................15\n\
    \   7. IANA Considerations ............................................15\n  \
    \ 8. Security Considerations ........................................16\n    \
    \  8.1. Integrity Protection of Forwarding in SIP .................16\n      8.2.\
    \ Privacy Related Issues on the Second Call Leg .............17\n   9. Acknowledgements\
    \ ...............................................18\n   10. References ....................................................18\n\
    \      10.1. Normative References .....................................18\n  \
    \    10.2. Informative References ...................................18\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   Many applications such as Unified Messaging (UM) systems\
    \ and\n   Interactive Voice Recognition (IVR) systems have been developed out\n\
    \   of traditional telephony.  They can be used for storing and\n   interacting\
    \ with voice, video, faxes, email, and instant messaging\n   services.  Users\
    \ often use SIP to initiate communications with these\n   applications.  When\
    \ a SIP call is routed to an application, it is\n   necessary that the application\
    \ be able to obtain several bits of\n   information from the session initiation\
    \ message so that it can\n   deliver the desired services.\n   For the purpose\
    \ of this document, we will use UM as the main example,\n   but other applications\
    \ may use the mechanism defined in this\n   document.  The UM needs to know what\
    \ mailbox should be used and\n   possible reasons for the type of service desired\
    \ from the UM.  Many\n   voicemail systems provide different greetings depending\
    \ whether the\n   call went to voicemail because the user was busy or because\
    \ the user\n   did not answer.  All of this information can be delivered in existing\n\
    \   SIP signaling from the call control that retargets the call to the\n   UM,\
    \ but there are no conventions for describing how the desired\n   mailbox and\
    \ the service requested are expressed.  It would be\n   possible for every vendor\
    \ to make this configurable so that any site\n   could get it to work; however,\
    \ this approach is unrealistic for\n   achieving interoperability among call control,\
    \ gateway, and unified\n   messaging systems from different vendors.  This specification\n\
    \   describes a convention for describing this mailbox and service\n   information\
    \ in the SIP URI so that vendors and operators can build\n   interoperable systems.\n\
    \   If there were no need to interoperate with Time Division Multiplexing\n  \
    \ (TDM)-based voicemail systems or to allow TDM systems to use VoIP\n   unified\
    \ messaging systems, this problem would be a little easier to\n   solve.  The\
    \ problem that is introduced in the Voice over IP (VoIP) to\n   TDM case is as\
    \ follows.  The SIP system needs to tell a Public\n   Switched Telephone Network\
    \ (PSTN) gateway both the subscriber's\n   mailbox identifier (which typically\
    \ looks like a phone number) and\n   the address of the voicemail system in the\
    \ TDM network (again a phone\n   number).\n   The question has been asked why\
    \ the To header cannot be used to\n   specify which mailbox to use.  One problem\
    \ is that the call control\n   proxies cannot modify the To header, and the User\
    \ Agent Clients\n   (UACs) often set it incorrectly because they do not have information\n\
    \   about the subscribers in the domain they are trying to call.  This\n   happens\
    \ because the routing of the call often translates the URI\n   multiple times\
    \ before it results in an identifier for the desired\n   user that is valid in\
    \ the namespace that the UM system understands.\n"
- title: 2.  Mechanism (User Agent Server and Proxy)
  contents:
  - "2.  Mechanism (User Agent Server and Proxy)\n   The mechanism works by encoding\
    \ the information for the desired\n   service in the SIP Request-URI that is sent\
    \ to the UM system.  Two\n   chunks of information are encoded, the first being\
    \ the target mailbox\n   to use and the second being the SIP status code that\
    \ caused this\n   retargeting and that indicates the desired service.  The userinfo\
    \ and\n   hostport parts of the Request-URI will identify the voicemail\n   service,\
    \ the target mailbox can be put in the target parameter, and\n   the reason can\
    \ be put in the cause parameter.  For example, if the\n   proxy wished to use\
    \ Bob's mailbox because his phone was busy, the URI\n   sent to the UM system\
    \ could be something like:\n     sip:voicemail@example.com;target=bob%40example.com;cause=486\n"
- title: 2.1.  Target
  contents:
  - "2.1.  Target\n   Target is a URI parameter that indicates the address of the\n\
    \   retargeting entity: in the context of UM, this can be the mailbox\n   number.\
    \  For example, in the case of a voicemail system on the PSTN,\n   the user portion\
    \ will contain the phone number of the voicemail\n   system, while the target\
    \ will contain the phone number of the\n   subscriber's mailbox.\n"
- title: 2.2.  Cause
  contents:
  - "2.2.  Cause\n   Cause is a URI parameter that is used to indicate the service\
    \ that\n   the User Agent Server (UAS) receiving the message should perform.\n\
    \   The following values for this URI parameter are defined:\n               \
    \ +---------------------------------+-------+\n                | Redirecting Reason\
    \              | Value |\n                +---------------------------------+-------+\n\
    \                | Unknown/Not available           | 404   |\n               \
    \ | User busy                       | 486   |\n                | No reply    \
    \                    | 408   |\n                | Unconditional              \
    \     | 302   |\n                | Deflection during alerting      | 487   |\n\
    \                | Deflection immediate response   | 480   |\n               \
    \ | Mobile subscriber not reachable | 503   |\n                +---------------------------------+-------+\n\
    \   The mapping to PSTN protocols is important both for gateways that\n   connect\
    \ the IP network to existing TDM customer's equipment, such as\n   Private Branch\
    \ Exchanges (PBXs) and voicemail systems, and for\n   gateways that connect the\
    \ IP network to the PSTN network.  Integrated\n   Services Digital Network User\
    \ Part (ISUP) has signaling encodings for\n   this information that can be treated\
    \ as roughly equivalent for the\n   purposes here.  For this reason, this specification\
    \ uses the names of\n   Redirecting Reason values defined in ITU-T Q.732.2-5 [8].\
    \  In this\n   specification, the Redirecting Reason Values are referred to as\n\
    \   \"Causes\".  It should be understood that the term \"Cause\" has nothing\n\
    \   to do with PSTN \"Cause values\" (as per ITU-T Q.850 [9] and RFC 3398\n  \
    \ [5]) but are instead mapped to ITU-T Q.732.2-5 Redirecting Reasons.\n   Since\
    \ ISUP interoperates with other PSTN networks, such as Q.931 [10]\n   and QSIG\
    \ [11], using well-known rules, it makes sense to use the ISUP\n   names as the\
    \ most appropriate superset.  If no appropriate mapping to\n   a cause value defined\
    \ in this specification exists in a network, it\n   would be mapped to 302 \"\
    Unconditional\".  Similarly, if the mapping\n   occurs from one of the causes\
    \ defined in this specification to a PSTN\n   system that does not have an equivalent\
    \ reason value, it would be\n   mapped to that network's equivalent of \"Unconditional\"\
    .  If a new\n   cause parameter needs to be defined, this specification will have\
    \ to\n   be updated.\n   The user portion of the URI SHOULD be used as the address\
    \ of the\n   voicemail system on the PSTN, while the target SHOULD be mapped to\n\
    \   the original redirecting number on the PSTN side.\n   The redirection counters\
    \ SHOULD be set to one unless additional\n   information is available.\n"
- title: 2.3.  Retrieving Messages
  contents:
  - "2.3.  Retrieving Messages\n   The UM system MAY use the fact that the From header\
    \ is the same as\n   the URI target as a hint that the user wishes to retrieve\
    \ messages.\n"
- title: 3.  Interaction with Request History Information
  contents:
  - "3.  Interaction with Request History Information\n   The Request History mechanism\
    \ [6] provides more information relating\n   to multiple retargetings.  It is\
    \ reasonable to have systems in which\n   both the information in this specification\
    \ and the History\n   information are included and one or both are used.\n   History-Info\
    \ specifies a means of providing the UAS and UAC with\n   information about the\
    \ retargeting of a request.  This information\n   includes the initial Request-URI\
    \ and any retarget-to URIs.  This\n   information is placed in the History-Info\
    \ header field, which, except\n   where prevented by privacy considerations, is\
    \ built up as the request\n   progresses and, upon reaching the UAS, is returned\
    \ in certain\n   responses.\n   History-Info, when deployed at relevant SIP entities,\
    \ is intended to\n   provide a comprehensive trace of retargeting for a SIP request,\
    \ along\n   with the SIP response codes that led to retargeting.\n   History-Info\
    \ can complement this specification.  In particular, when\n   a proxy inserts\
    \ a URI containing the parameters defined in this\n   specification into the Request-URI\
    \ of a forwarded request, the proxy\n   can also insert a History-Info header\
    \ field entry into the forwarded\n   request, and the URI in that entry will incorporate\
    \ these parameters.\n   Therefore, even if the Request-URI is replaced as a result\
    \ of\n   rerouting by a downstream proxy, the History-Info header field will\n\
    \   still contain these parameters, which may be of use to the UAS.\n   Consequently,\
    \ UASes that make use of this information may find the\n   information in the\
    \ History-Info header and/or in the Request-URI,\n   depending on the capability\
    \ of the proxy to support generation of\n   History-Info or on the behavior of\
    \ downstream proxies; therefore,\n   applications need to take this into account.\n"
- title: 4.  Limitations of Voicemail URI
  contents:
  - "4.  Limitations of Voicemail URI\n   This specification requires the proxy that\
    \ is requesting the service\n   to understand whether the UM system it is targeting\
    \ supports the\n   syntax defined in this specification.  Today, this information\
    \ is\n   provided to the proxy by configuration.  For practical purposes, this\n\
    \   means that the approach is unlikely to work in cases in which the\n   proxy\
    \ is not configured with information about the UM system or in\n   which the UM\
    \ is not in the same administrative domain.\n   This approach only works when\
    \ the service that the call control wants\n   applied is fairly simple.  For example,\
    \ it does not allow the proxy\n   to express information like \"Do not offer to\
    \ connect to the target's\n   colleague because that address has already been\
    \ tried\".\n   The limitations discussed in this section are addressed by History-\n\
    \   Info [6].\n"
- title: 5.  Syntax
  contents:
  - "5.  Syntax\n   The ABNF[4] grammar for these parameters is shown below.  The\n\
    \   definitions of pvalue and Status-Code are defined in the ABNF in RFC\n   3261[1].\n\
    \     target-param      =  \"target\" EQUAL pvalue\n     cause-param       = \
    \ \"cause\" EQUAL Status-Code\n   Note that the ABNF requires some characters\
    \ to be escaped if they\n   occur in the value of the target parameters.  For\
    \ example, the \"@\"\n   character needs to be escaped.\n"
- title: 6.  Examples
  contents:
  - "6.  Examples\n   This section provides some example use cases for the solution\n\
    \   proposed in this document.  For the purpose of this document, UM is\n   used\
    \ as the main example, but other applications may use this\n   mechanism.  The\
    \ examples are intended to highlight the potential\n   applicability of this solution\
    \ and are not intended to limit its\n   applicability.\n   Also, the examples\
    \ show just service retargeting on busy, but can\n   easily be adapted to show\
    \ other forms of retargeting.\n   In several of the examples, the URIs are broken\
    \ across more than one\n   line.  This was only done for formatting and is not\
    \ a valid SIP\n   message.  Some of the characters in the URIs are not correctly\n\
    \   escaped to improve readability.  The examples are all shown using\n   sip:\
    \ with UDP transport, for readability.  It should be understood\n   that using\
    \ sips: with TLS transport is preferable.\n"
- title: 6.1.  Proxy Forwards Busy to Voicemail
  contents:
  - "6.1.  Proxy Forwards Busy to Voicemail\n   In this example, Alice calls Bob.\
    \  Bob's proxy determines that Bob is\n   busy, and the proxy forwards the call\
    \ to Bob's voicemail.  Alice's\n   phone is at 192.0.2.1, while Bob's phone is\
    \ at 192.0.2.2.  The\n   important thing to note is the URI in message F7.\n \
    \    Alice            Proxy           Bob             voicemail\n       |    \
    \            |              |                   |\n       |    INVITE F1   | \
    \             |                   |\n       |--------------->|   INVITE F2  |\
    \                   |\n       |                |------------->|              \
    \     |\n       |(100 Trying) F3 |              |                   |\n      \
    \ |<---------------|  486 Busy F4 |                   |\n       |            \
    \    |<-------------|                   |\n       |                |     ACK F5\
    \   |                   |\n       |                |------------->|          \
    \         |\n       |(181 Call is Being Forwarded) F6                   |\n  \
    \     |<---------------|              |    INVITE F7      |\n       |        \
    \        |--------------------------------->|\n                    * Rest of flow\
    \ not shown *\n    F1: INVITE 192.0.2.1 -> proxy.example.com\n    INVITE sip:+15555551002@example.com;user=phone\
    \  SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From:\
    \ Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n    To: sip:+15555551002@example.com;user=phone\n\
    \    Call-ID: c3x842276298220188511\n    CSeq: 1 INVITE\n    Max-Forwards: 70\n\
    \    Contact: <sip:alice@192.0.2.1>\n    Content-Type: application/sdp\n    Content-Length:\
    \ *Body length goes here*\n    * SDP goes here*\n    F2: INVITE proxy.example.com\
    \ -> 192.0.2.2\n    INVITE sip:+15555551002@192.0.2.2 SIP/2.0\n    Via: SIP/2.0/TCP\
    \ 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-1\n    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n\
    \    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n    To:\
    \ sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n    F4: 486 192.0.2.2 -> proxy.example.com\n    SIP/2.0\
    \ 486 Busy Here\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-1\n\
    \    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone;tag=09xde23d80\n    Call-ID:\
    \ c3x842276298220188511\n    CSeq: 1 INVITE\n    Content-Length: 0\n    F7: INVITE\
    \ proxy.example.com -> um.example.com\n    INVITE sip:voicemail@example.com;\\\
    \n           target=sip:+15555551002%40example.com;user=phone;\\\n           cause=486\
    \  SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-2\n   \
    \ Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n"
- title: 6.2.  Endpoint Forwards Busy to Voicemail
  contents:
  - "6.2.  Endpoint Forwards Busy to Voicemail\n   In this example, Alice calls Bob.\
    \  Bob is busy, but forwards the\n   session directly to his voicemail.  Alice's\
    \ phone is at 192.0.2.1,\n   while Bob's phone is at 192.0.2.2.  The important\
    \ thing to note is\n   the URI in the Contact in message F3.\n     Alice     \
    \       Proxy           Bob             voicemail\n       |                | \
    \             |                   |\n       |    INVITE F1   |              |\
    \                   |\n       |--------------->|   INVITE F2  |              \
    \     |\n       |                |------------->|                   |\n      \
    \ |                | 302 Moved F3 |                   |\n       |  302 Moved \
    \ F4 |<-------------|                   |\n       |<---------------|         \
    \     |                   |\n       |      ACK F5    |              |        \
    \           |\n       |--------------->|     ACK F6   |                   |\n\
    \       |                |------------->|                   |\n       |      \
    \                INVITE F7                    |\n       |-------------------------------------------------->|\n\
    \                   * Rest of flow not shown *\n    F1: INVITE 192.0.2.1 -> proxy.example.com\n\
    \    INVITE sip:+15555551002@example.com;user=phone  SIP/2.0\n    Via: SIP/2.0/TCP\
    \ 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n    F2: INVITE proxy.example.com -> 192.0.2.2\n    INVITE\
    \ sip:line1@192.0.2.2 SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-1\n\
    \    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n    F3: 302 192.0.2.2 -> proxy.example.com\n    SIP/2.0\
    \ 302 Moved Temporarily\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-1\n\
    \    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone;tag=09xde23d80\n    Call-ID:\
    \ c3x842276298220188511\n    CSeq: 1 INVITE\n    Contact: <sip: voicemail@example.com;\\\
    \n           target=sip:+15555551002%40example.com;user=phone;\\\n           cause=486;>\n\
    \    Content-Length: 0\n    F7: INVITE proxy.example.com -> um.example.com\n \
    \   INVITE sip: voicemail@example.com;\\\n           target=sip:+15555551002%40example.com;user=phone;\\\
    \n           cause=486  SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-2\n\
    \    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n"
- title: 6.3.  Endpoint Forwards Busy to TDM via a Gateway
  contents:
  - "6.3.  Endpoint Forwards Busy to TDM via a Gateway\n   In this example, the voicemail\
    \ is reached via a gateway to a TDM\n   network.  Bob's number is +1 555 555-1002,\
    \ while voicemail's number\n   on the TDM network is +1-555-555-2000.\n   The\
    \ call flow is the same as in Section 6.2 except for the Contact\n   URI in F4\
    \ and the Request URI in F7.\n     Alice            Proxy           Bob      \
    \       voicemail\n       |                |              |                  \
    \ |\n       |    INVITE F1   |              |                   |\n       |--------------->|\
    \   INVITE F2  |                   |\n       |                |------------->|\
    \                   |\n       |(100 Trying) F3 |              |              \
    \     |\n       |<---------------| 302 Moved F4 |                   |\n      \
    \ |                |<-------------|                   |\n       |            \
    \    |     ACK F5   |                   |\n       |                |------------->|\
    \                   |\n       |(181 Call is Being Forwarded) F6              \
    \     |\n       |<---------------|              |    INVITE F7      |\n      \
    \ |                |--------------------------------->|\n                    *\
    \ Rest of flow not shown *\n    F4: 486 192.0.2.2 -> proxy.example.com\n    SIP/2.0\
    \ 302 Moved temporarily\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-1\n\
    \    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone;tag=09xde23d80\n    Call-ID:\
    \ c3x842276298220188511\n    CSeq: 1 INVITE\n    Contact: <sip:+15555552000@example.com;user=phone;\\\
    \n              target=tel:+15555551002;cause=486>\n    Content-Length: 0\n  \
    \  F7: INVITE proxy.example.com -> gw.example.com\n    INVITE sip:+15555552000@example.com;user=phone;\\\
    \n           target=tel:+15555551002;cause=486\\\n           SIP/2.0\n    Via:\
    \ SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-2\n    Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n\
    \    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n    To:\
    \ sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1;transport=tcp>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n"
- title: 6.4.  Endpoint Forwards Busy to Voicemail with History Info
  contents:
  - "6.4.  Endpoint Forwards Busy to Voicemail with History Info\n   This example\
    \ illustrates how History Info works in conjunction with\n   service retargeting.\
    \  The scenario is the same as Section 6.1.\n    F1: INVITE 192.0.2.1 -> proxy.example.com\n\
    \    INVITE sip:+15555551002@example.com;user=phone  SIP/2.0\n    Via: SIP/2.0/TCP\
    \ 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    History-Info: <sip:+15555551002@example.com;user=phone >;index=1\n    Content-Type:\
    \ application/sdp\n    Content-Length: *Body length goes here*\n    * SDP goes\
    \ here*\n    F2: INVITE proxy.example.com -> 192.0.2.2\n    INVITE sip:line1@192.0.2.2\
    \ SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-1\n    Via:\
    \ SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    History-Info: <sip:+15555551002@example.com;user=phone >;index=1,\n     \
    \             <sip:line1@192.0.2.4>;index=1.1\n    Content-Type: application/sdp\n\
    \    Content-Length: *Body length goes here*\n    * SDP goes here*\n    F7: INVITE\
    \ proxy.example.com -> um.example.com\n    INVITE sip: voicemail@example.com;\\\
    \n           target=sip:+15555551002%40example.com;user=phone;\\\n           cause=486\
    \  SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-2\n   \
    \ Via: SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    History-Info: <sip:+15555551002@example.com;user=phone >;index=1,\n     \
    \             <sip:line1@192.0.2.4?Reason=SIP%3Bcause%3D302;\\\n             \
    \      text=\"Moved Temporarily\">;index=1.1\n                  <sip: voicemail@example.com;\\\
    \n                   target=sip:+15555551002%40example.com;user=phone;\\\n   \
    \                cause=486>;index=2\n    Contact: <sip:alice@192.0.2.1>\n    Content-Type:\
    \ application/sdp\n    Content-Length: *Body length goes here*\n    * SDP goes\
    \ here*\n"
- title: 6.5.  Zero Configuration UM System
  contents:
  - "6.5.  Zero Configuration UM System\n   In this example, the UM system has no\
    \ configuration information\n   specific to any user.  The proxy is configured\
    \ to pass a URI that\n   provides the prompt to play and an email address in the\
    \ user portion\n   of the URI to which the recorded message is to be sent.\n \
    \  The call flow is the same as in Section 6.1, except that the URI in\n   F7\
    \ changes to specify the user part as Bob's email address, and the\n   Netann\
    \ [7] URI play parameter specifies where the greeting to play\n   can be fetched\
    \ from.\n    F7: INVITE proxy.example.com -> voicemail.example.com\n    INVITE\
    \ sip:voicemail@example.com;target=mailto:bob%40example.com;\\\n       cause=486;play=http://www.example.com/bob/busy.wav\
    \ SIP/2.0\n    Via: SIP/2.0/TCP 192.0.2.4:5060;branch=z9hG4bK-ik80k7g-2\n    Via:\
    \ SIP/2.0/TCP 192.0.2.1:5060;branch=z9hG4bK-74bf9\n    From: Alice <sip:+15555551001@example.com;user=phone>;tag=9fxced76sl\n\
    \    To: sip:+15555551002@example.com;user=phone\n    Call-ID: c3x842276298220188511\n\
    \    CSeq: 1 INVITE\n    Max-Forwards: 70\n    Contact: <sip:alice@192.0.2.1>\n\
    \    Content-Type: application/sdp\n    Content-Length: *Body length goes here*\n\
    \    * SDP goes here*\n   In addition, if the proxy wished to indicate a Voice\
    \ XML (VXML)\n   script that the UM should execute, it could add a parameter to\
    \ the\n   URI in the above message that looked like:\n    voicexml=http://www.example.com/bob/busy.vxml\n"
- title: 6.6.  Call Coverage
  contents:
  - "6.6.  Call Coverage\n   In a Call Coverage example, a user on the PSTN calls\
    \ an 800 number.\n   The gateway sends this to the proxy, which recognizes that\
    \ the\n   helpdesk is the target.  Alice and Bob are staffing the help desk and\n\
    \   are tried sequentially, but neither answers, so the call is forwarded\n  \
    \ to the helpdesk's voicemail.\n   The details of this flow are trivial and not\
    \ shown.  The key item in\n   this example is that the INVITE to Alice and Bob\
    \ looks as follows:\n     INVITE sip:voicemail@example.com;target=helpdesk%40example.com;\\\
    \n            cause=302 SIP/2.0\n"
- title: 7.  IANA Considerations
  contents:
  - "7.  IANA Considerations\n   This specification adds two new values to the IANA\
    \ registration in\n   the \"SIP/SIPS URI Parameters\" registry as defined in [3].\n\
    \      Parameter Name  Predefined Values  Reference\n      ____________________________________________\n\
    \      target          No                 [RFC4458]\n      cause           Yes\
    \                [RFC4458]\n"
- title: 8.  Security Considerations
  contents:
  - "8.  Security Considerations\n   This document discusses transactions involving\
    \ at least three\n   parties, which increases the complexity of the privacy issues.\n\
    \   The new URI parameters defined in this document are generally sent\n   from\
    \ a Proxy or call control system to a Unified Messaging (UM)\n   system or to\
    \ a gateway to the PSTN and then to a voicemail system.\n   These new parameters\
    \ tell the UM what service the proxy wishes to\n   have performed.  Just as any\
    \ message sent from the proxy to the UM\n   needs to be integrity protected, these\
    \ messages need to be integrity\n   protected to stop attackers from, for example,\
    \ causing a voicemail\n   meant for a company's CEO to go to an attacker's mailbox.\
    \  RFC 3261\n   provides a TLS mechanism suitable for performing this integrity\n\
    \   protection.\n   The signaling from the Proxy to the UM or gateway will reveal\
    \ who is\n   calling whom and possibly some information about a user's presence\n\
    \   based on whether the call was answered or sent to voicemail.  This\n   information\
    \ can be protected by encrypting the SIP traffic between\n   the Proxy and UM\
    \ or gateway.  Again, RFC 3261 contains mechanisms for\n   accomplishing this\
    \ using TLS.\n   Implementations should implement and use TLS.\n"
- title: 8.1.  Integrity Protection of Forwarding in SIP
  contents:
  - "8.1.  Integrity Protection of Forwarding in SIP\n   The forwarding of a call\
    \ in SIP brings up a very strange trust issue.\n   Consider the normal case --\
    \ A calls B and the call gets forwarded to\n   C by a network element in B's domain,\
    \ and then C answers the call.  A\n   has called B but ended up talking to C.\
    \  This scenario may be hard to\n   separate from a man-in-the-middle attack.\n\
    \   There are two possible solutions.  One is that B sends back\n   information\
    \ to A saying don't call me, call C, and signs it as B.\n   The problem is that\
    \ this solution involves revealing that B has\n   forwarded to C, which B often\
    \ may not want to do.  For example, B may\n   be a work phone that has been forwarded\
    \ to a mobile or home phone.\n   The user does not want to reveal their mobile\
    \ or home phone number\n   but, even more importantly, does not want to reveal\
    \ that they are not\n   in the office.\n   The other possible solution is that\
    \ A needs to trust B only to\n   forward to a trusted identity.  This requires\
    \ a hop-by-hop transitive\n   trust such that each hop will only send to a trusted\
    \ next hop and\n   each hop will only do things that the user at that hop desired.\
    \  This\n   solution is enforced in SIP using the SIPS URI and TLS-based\n   hop-by-hop\
    \ security.  It protects from an off-axis attack, but if one\n   of the hops is\
    \ not trustworthy, the call may be diverted to an\n   attacker.\n   Any redirection\
    \ of a call to an attacker's mailbox is serious.  It is\n   trivial for an attacker\
    \ to make its mailbox seem very much like the\n   real mailbox and forward the\
    \ messages to the real mailbox so that the\n   fact that the messages have been\
    \ intercepted or even tampered with\n   escapes detection.  Approaches such as\
    \ the SIPS URL and the\n   History-Info[6] can help protect against these attacks.\n"
- title: 8.2.  Privacy Related Issues on the Second Call Leg
  contents:
  - "8.2.  Privacy Related Issues on the Second Call Leg\n   In the case where A calls\
    \ B and gets redirected to C, occasionally\n   people suggest that there is a\
    \ requirement for the call leg from B to\n   C to be anonymous.  The SIP case\
    \ is not the PSTN, and there is no\n   call leg from B to C; instead, there is\
    \ a VoIP session between A and\n   C.  If A has put a To header field value containing\
    \ B in the initial\n   invite message, unless something special is done about\
    \ it, C would\n   see that To header field value.  If the person who answers phone\
    \ C\n   says \"I think you dialed the wrong number; who were you trying to\n \
    \  reach?\", A will probably specify B.\n   If A does not want C to see that the\
    \ call was to B, A needs a special\n   relationship with the forwarding Proxy\
    \ to induce it not to reveal\n   that information.  The call should go through\
    \ an anonymization\n   service that provides session or user level privacy (as\
    \ described in\n   RFC 3323 [2]) service before going to C.  It is not hard to\
    \ figure\n   out how to meet this requirement, but it is unclear why anyone would\n\
    \   want this service.\n   The scenario in which B wants to make sure that C does\
    \ not see that\n   the call was to B is easier to deal with but a bit weird. \
    \ The usual\n   argument is that Bill wants to forward his phone to Monica but\
    \ does\n   not want Monica to find out his phone number.  It is hard to imagine\n\
    \   that Monica would want to accept all Bill's calls without knowing how\n  \
    \ to call Bill to complain.  The only person Monica will be able to\n   complain\
    \ to is Hillary, when she tries to call Bill.  Several popular\n   web portals\
    \ will send SMS alert messages about things like stock\n   prices and weather\
    \ to mobile phone users today.  Some of these\n   contain no information about\
    \ the account on the web portal that\n   initiated them, making it nearly impossible\
    \ for the mobile phone\n   owner to stop them.  This anonymous message forwarding\
    \ has turned out\n   to be a really bad idea even where no malice is present.\
    \  Clearly\n   some people are fairly dubious about the need for this, but never\n\
    \   mind: let's look at how it is solved.\n   In the general case, the proxy needs\
    \ to route the call through an\n   anonymization service and everything will be\
    \ cleaned up.  Any\n   anonymization service that performs the \"Privacy: Header\"\
    \ Service in\n   RFC 3323 [2] must remove the cause and target URI parameters\
    \ from the\n   URI.  Privacy of the parameters, when they form part of a URI within\n\
    \   the History-Info header, is covered in History-Info [6].\n   This specification\
    \ does not discuss the security considerations of\n   mapping to a PSTN Gateway.\
    \  Security implications of mapping to ISUP,\n   for example, are discussed in\
    \ RFC 3398 [5].\n"
- title: 9.  Acknowledgements
  contents:
  - "9.  Acknowledgements\n   Many thanks to Mary Barnes, Steve Levy, Dean Willis,\
    \ Allison Mankin,\n   Martin Dolly, Paul Kyzivat, Erick Sasaki, Lyndsay Campbell,\
    \ Keith\n   Drage, Miguel Garcia, Sebastien Garcin, Roland Jesske, Takumi Ohba,\n\
    \   and Rohan Mahy.\n"
- title: 10.  References
  contents:
  - '10.  References

    '
- title: 10.1.  Normative References
  contents:
  - "10.1.  Normative References\n   [1]  Rosenberg, J., Schulzrinne, H., Camarillo,\
    \ G., Johnston, A.,\n        Peterson, J., Sparks, R., Handley, M., and E. Schooler,\
    \ \"SIP:\n        Session Initiation Protocol\", RFC 3261, June 2002.\n   [2]\
    \  Peterson, J., \"A Privacy Mechanism for the Session Initiation\n        Protocol\
    \ (SIP)\", RFC 3323, November 2002.\n   [3]  Camarillo, G., \"The Internet Assigned\
    \ Number Authority (IANA)\n        Uniform Resource Identifier (URI) Parameter\
    \ Registry for the\n        Session Initiation Protocol (SIP)\", BCP 99, RFC 3969,\n\
    \        December 2004.\n   [4]  Crocker, D. and P. Overell, \"Augmented BNF for\
    \ Syntax\n        Specifications: ABNF\", RFC 4234, October 2005.\n"
- title: 10.2.  Informative References
  contents:
  - "10.2.  Informative References\n   [5]   Camarillo, G., Roach, A., Peterson, J.,\
    \ and L. Ong, \"Integrated\n         Services Digital Network (ISDN) User Part\
    \ (ISUP) to Session\n         Initiation Protocol (SIP) Mapping\", RFC 3398, December\
    \ 2002.\n   [6]   Barnes, M., \"An Extension to the Session Initiation Protocol\n\
    \         (SIP) for Request History Information\", RFC 4244,\n         November\
    \ 2005.\n   [7]   Burger, E., Van Dyke, J., and A. Spitzer, \"Basic Network Media\n\
    \         Services with SIP\", RFC 4240, December 2005.\n   [8]   \"Stage 3 description\
    \ for call offering supplementary services\n         using signalling system No.\
    \ 7: Call diversion services\", ITU-T\n         Recommendation Q.732.2-5, December\
    \ 1999.\n   [9]   \"Usage of cause and location in the Digital Subscriber\n  \
    \       Signalling System No. 1 and the Signalling System No. 7 ISDN\n       \
    \  User Part\", ITU-T Recommendation Q.850, May 1998.\n   [10]  \"ISDN user-network\
    \ interface layer 3 specification for basic\n         call control\", ITU-T Recommendation\
    \ Q.931, May 1998.\n   [11]  \"Information technology - Telecommunications and\
    \ information\n         exchange between systems - Private Integrated Services\
    \ Network\n         - Circuit mode bearer services - Inter-exchange signalling\n\
    \         procedures and protocol\", ISO/IEC 11572, March 2000.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Cullen Jennings\n   Cisco Systems\n   170 West Tasman\
    \ Drive\n   Mailstop SJC-21/2\n   San Jose, CA  95134\n   USA\n   Phone: +1 408\
    \ 421-9990\n   EMail: fluffy@cisco.com\n   Francois Audet\n   Nortel Networks\n\
    \   4655 Great America Parkway\n   Santa Clara, CA  95054\n   US\n   Phone: +1\
    \ 408 495 3756\n   EMail: audet@nortel.com\n   John Elwell\n   Siemens plc\n \
    \  Technology Drive\n   Beeston, Nottingham  NG9 1LA\n   UK\n   EMail: john.elwell@siemens.com\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This\
    \ document is subject to the rights, licenses and restrictions\n   contained in\
    \ BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING\
    \ TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT\
    \ LIMITED TO ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT\
    \ INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS\
    \ FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
- title: Acknowledgement
  contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n\
    \   Administrative Support Activity (IASA).\n"
