Abstract This document specifies the Session Initiation Protocol (SIP) P User Database Private Header (P header).
This header field is used in the 3rd Generation Partnership Project (3GPP) IMS (IP Multimedia Subsystem) to provide SIP registrars and SIP proxy servers with the address of the database that contains the user profile of the user that generated a particular request.
The 3rd Generation Partnership Project (3GPP) IMS (IP Multimedia Subsystem) uses the Session Initiation Protocol (SIP)
[2] as its main signalling protocol.
(For more information on the IMS, a detailed description can be found in 3GPP TS 23.228 [5] and 3GPP TS 24.229 [6].)
3GPP has identified a set of requirements that can be met, according to the procedures in RFC 3427 [3], by defining a new SIP Private Header (P header).
The remainder of this document is organized as follows.
Section 2 describes the scenarios considered by 3GPP and Section 3 discusses the requirements derived from these scenarios.
Section 4 defines the P User Database header field, which meets those requirements, and Section 5 discusses the applicability and scope of this new header field.
Section 6 registers the P User Database header field with the IANA and Section 7 discusses the security properties of the environment where this header field is intended to be used.
In the 3GPP IMS, there are two scenarios where a set of proxies handling a request need to consult the same user database.
These scenarios consist of a user registering to the IMS network and an unregistered user receiving an incoming request that triggers a service (e.g., a voice mail service).
User Registering to the IMS
In the 3GPP IMS, SIP REGISTER requests generated by a User Agent (UA) traverse a set of SIP proxy servers before reaching the SIP registrar.
A REGISTER request sent by a UA is routed to the outbound proxy of the UA, which is referred to as the P CSCF (Proxy  Call/Session Control Function).
The P CSCF routes the REGISTER request to another proxy, which is referred to as the I CSCF (Interrogating CSCF) and is always located in the home domain of the user.
I CSCF consults the user database of the domain, which is referred to as the Home Subscriber Server (HSS), in order to choose the registrar that will process the REGISTER request.
With the information received from the HSS, the
I CSCF routes the REGISTER request to the appropriate registrar, which is referred to as the S CSCF (Serving CSCF).
At this point, the S CSCF needs to contact the same HSS that was previously contacted by the
I CSCF in order to fetch the user profile of the user that generated the REGISTER request.
The interface between the I CSCF and the HSS and between the S CSCF and the HSS is called Cx interface and is based on Diameter [4].
When there is a single HSS (i.e., user database) handling all the users in the domain, both the I CSCF and the S CSCF can be configured with its address so that they contact it when necessary.
However, some domains have several HSSs, each of which handles a particular set of users.
When dealing with a REGISTER request, the I CSCF and the S CSCF need to discover which is the HSS that contains the profile of the user that generated the REGISTER request.
In networks with more than one HSS, a Diameter redirect agent referred to as the Subscription Locator Function (SLF) is implemented.
The interface between the I CSCF and the SLF and between the S CSCF and the SLF is called Dx interface and, like the CX interface, is based on Diameter.
The SLF provides the I CSCF and the S
CSCF with the address of the HSS that handles the user they are dealing with.
Therefore, in a network with more than one HSS, the SLF is consulted twice per REGISTER request, first by the I CSCF, and later by the S CSCF.
If the I CSCF could provide the S CSCF with the address of the HSS handling the user that generated the REGISTER request, the S CSCF could contact directly that HSS.
That is, the S CSCF would not need to contact the SLF in order to obtain the address of the HSS.
Incoming Request for an Unregistered User
In the 3GPP IMS, incoming requests for a user traverse an
I CSCF in the home domain of the user.
I CSCF consults the HSS, using the Diameter based Cx interface, in order to decide which S CSCF should handle the request.
After consulting the HSS, the I CSCF forwards the request to a S CSCF, which is also located in the home domain of the user.
If the user the request is addressed to is registered to the IMS network,
the S CSCF receiving the request knows which HSS handles the user.
The S CSCF stored this information when the user registered.
However, if the user is not registered, the S CSCF needs to consult the SLF (assuming more than one HSS in the network) in order to discover the HSS handling the user.
Therefore, like in the previous scenario, in a network with more than one HSS, the SLF is consulted twice per incoming request addresses to an unregistered user.
CSCF, and later by the S CSCF.
If the I CSCF could provide the S CSCF with the address of the HSS handling the user that generated the request, the S CSCF could contact directly that HSS.
That is, the S CSCF would not need to contact the SLF in order to obtain the address of the HSS.
This section lists the requirements derived from the previous scenarios: 1.
It is necessary to optimize the registration process in the 3GPP IMS by reducing the time it takes for a UA to register to the IMS network.
It is necessary to optimize the handling of incoming requests to unregistered users in the 3GPP IMS by reducing the time it takes for a domain to handle these requests.
It is necessary to improve the scalability of SLFs in the 3GPP IMS by reducing the amount of traffic
the SLF of a network needs to handle.
P User Database Header Field Definition
This document defines the SIP P User Database P header.
This header field can be added to requests routed from an I CSCF to an S CSCF.
The P User Database P header contains the address of the HSS handling the user that generated the request.
The augmented Backus Naur Form (BNF)
RAQUOT DiameterURI is defined in RFC 3588 [4].
HCOLON, LAQUOT, RAQUOT, and generic param are defined in RFC 3261 [2].
The following is an example of a P User Database header field: P User Database: <aaa://host.example.com;transport
According to RFC 3427 [3], P headers have a limited applicability.
Specifications of P headers such as this RFC need to clearly document the useful scope of the proposal, and explain its limitations and why it is not suitable for the general use of SIP on the Internet.
The P User Database header field is intended to be used in 3GPP IMS networks.
This header field carries the address of a user database, which is referred to as HSS, between two proxies, which are referred to as I CSCF
the S CSCF belong to the same administrative domain and share a common frame of reference to the user database.
I CSCF inserts the P User Database header field into a SIP request and the S CSCF removes it before routing the request further.
When SIP is used on the Internet, there are typically no proxies querying a user database between the UA sending a REGISTER request and the registrar.
Consequently, the P User Database header field does not seem useful in a general Internet environment.
This document defines a new SIP header field: P User Database.
This header field has been registered by the IANA in the SIP Parameters registry under the Header Fields subregistry.
The P User Database defined in this document is to be used in an environment where elements are trusted and where attackers are not supposed to have access to the protocol messages between those elements.
Traffic protection between network elements is sometimes achieved by using IP Security (IPsec) and sometimes by physically protecting the network.
In any case, the environment where the P User Database header field will be used ensures the integrity and the confidentiality of the contents of this header field.
There is a slight security risk if a P User Database header field is allowed to propagate out of the administrative domain where it was generated.
No user sensitive information would be revealed by such a breach, but this could result in disclosure of information about the topology of the operator network that goes beyond the level of disclosure explicit in SIP messages without this extension.
Consequently, operators need to ensure that the P User Database header field is removed from requests before these are sent to another administrative domain.
