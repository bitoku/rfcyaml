- contents:
  - "                      Improved Arcfour Modes for\n            the Secure Shell
    (SSH) Transport Layer Protocol\n"
  title: __initial_text__
- contents:
  - "Status of This Memo\n   This document specifies an Internet standards track protocol
    for the\n   Internet community, and requests discussion and suggestions for\n
    \  improvements.  Please refer to the current edition of the \"Internet\n   Official
    Protocol Standards\" (STD 1) for the standardization state\n   and status of this
    protocol.  Distribution of this memo is unlimited.\n"
  title: Status of This Memo
- contents:
  - "Copyright Notice\n   Copyright (C) The Internet Society (2006).\n"
  title: Copyright Notice
- contents:
  - "Abstract\n   This document specifies methods of using the Arcfour cipher in the\n
    \  Secure Shell (SSH) protocol that mitigate the weakness of the\n   cipher's
    key-scheduling algorithm.\n"
  title: Abstract
- contents:
  - "1.  Introduction\n   Secure Shell (SSH) [RFC4251] is a secure remote-login protocol.
    \ It\n   allows for the use of an extensible variety of symmetric cipher\n   algorithms
    to provide confidentiality for data in transit.  One of\n   the algorithms specified
    in the base protocol is \"arcfour\", which\n   specifies the use of Arcfour (also
    known as RC4), a fast stream\n   cipher.  As [RFC4253] says, though, \"Arcfour
    (and RC4) has problems\n   with weak keys, and should be used with caution.\"
    \ These problems are\n   described in more detail in [MANTIN01], along with a
    recommendation\n   to discard the first 1536 bytes of keystream so as to ensure
    that the\n   cipher's internal state is thoroughly mixed.  This document specifies\n
    \  new cipher algorithms for SSH that follow this recommendation.\n"
  title: 1.  Introduction
- contents:
  - "2.  Conventions Used in this Document\n   The key words \"MUST\", \"MUST NOT\",
    \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\",
    \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described
    in [RFC2119].\n"
  title: 2.  Conventions Used in this Document
- contents:
  - "3.  Applicability Statement\n   Implementations of Arcfour are typically slightly
    faster and much\n   smaller than those of any other encryption algorithm currently\n
    \  defined for SSH.  This must be balanced, though, against the known\n   security
    problems with Arcfour described in Section 5.  In most\n   cases, where speed
    and code size are not critical issues, the\n   algorithms specified by [RFC4344]
    should be used instead.\n"
  title: 3.  Applicability Statement
- contents:
  - "4.  Algorithm Definitions\n   The \"arcfour128\" algorithm is the RC4 cipher,
    as described in\n   [SCHNEIER], using a 128-bit key.  The first 1536 bytes of
    keystream\n   generated by the cipher MUST be discarded, and the first byte of
    the\n   first encrypted packet MUST be encrypted using the 1537th byte of\n   keystream.\n
    \  The \"arcfour256\" algorithm is the same, but uses a 256-bit key.\n"
  title: 4.  Algorithm Definitions
- contents:
  - "5.  Security Considerations\n   The security considerations in [RFC4251] apply.\n
    \  The discarded bytes of keystream MUST be kept secret and MUST NOT be\n   transmitted
    over the network.  The contents of these bytes could\n   reveal information about
    the key.\n   There are two classes of attack on Arcfour described in [MIRONOV].\n
    \  Strong distinguishers distinguish an Arcfour keystream from\n   randomness
    at the start of the stream and are defended against by the\n   algorithm defined
    in this document.  Weak distinguishers can operate\n   on any part of the keystream,
    and the best ones, described in [FMcG]\n   and [MANTIN05], can use data from multiple,
    different keystreams.  A\n   consequence of this is that encrypting the same data
    (for instance, a\n   password) sufficiently many times in separate Arcfour keystreams
    can\n   be sufficient to leak information about it to an adversary.  It is\n   thus
    RECOMMENDED that Arcfour (either in the form described here or\n   that described
    in [RFC4251]) not be used for high-volume password-\n   authenticated connections.\n"
  title: 5.  Security Considerations
- contents:
  - "6.  IANA Considerations\n   The IANA has assigned the Encryption Algorithm Names
    \"arcfour128\" and\n   \"arcfour256\" in accordance with [RFC4250].\n"
  title: 6.  IANA Considerations
- contents:
  - '7.  References

    '
  - contents:
    - "7.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use
      in RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March
      1997.\n   [RFC4250]  Lehtinen, S. and C. Lonvick, Ed., \"The Secure Shell (SSH)\n
      \             Protocol Assigned Numbers\", RFC 4250, January 2006.\n   [RFC4251]
      \ Ylonen, T. and C. Lonvick, Ed., \"The Secure Shell (SSH)\n              Protocol
      Architecture\", RFC 4251, January 2006.\n   [RFC4253]  Ylonen, T. and C. Lonvick,
      Ed., \"The Secure Shell (SSH)\n              Transport Layer Protocol\", RFC
      4253, January 2006\n   [RFC4344]  Bellare, M., Kohno, T., and C. Namprempre,
      \"The Secure\n              Shell (SSH) Transport Layer Encryption Modes\",
      RFC 4344,\n              January 2006.\n   [SCHNEIER] Schneier, B., \"Applied
      Cryptography Second Edition:\n              protocols algorithms and source
      in code in C\", John Wiley\n              and Sons, New York, NY, 1996.\n"
    title: 7.1.  Normative References
  - contents:
    - "7.2.  Informative References\n   [FMcG]     Fluhrer, S. and D. McGrew, \"Statistical
      Analysis of the\n              Alleged RC4 Keystream Generator\", Fast Software\n
      \             Encryption:  7th International Workshop, FSE 2000, April\n              2000,
      <http://www.mindspring.com/~dmcgrew/rc4-03.pdf>.\n   [MANTIN01] Mantin, I.,
      \"Analysis of the Stream Cipher RC4\", M.Sc.\n              Thesis, Weizmann
      Institute of Science, 2001, <http://\n              www.wisdom.weizmann.ac.il/~itsik/RC4/Papers/Mantin1.zip>.\n
      \  [MIRONOV]  Mironov, I., \"(Not So) Random Shuffles of RC4\", Advances\n              in
      Cryptology -- CRYPTO 2002: 22nd Annual International\n              Cryptology
      Conference, August 2002,\n              <http://eprint.iacr.org/2002/067.pdf>.\n
      \  [MANTIN05] Mantin, I., \"Predicting and Distinguishing Attacks on RC4\n              Keystream
      Generator\", Advances in Cryptology -- EUROCRYPT\n              2005: 24th Annual
      International Conference on the Theory\n              and Applications of Cryptographic
      Techniques, May 2005.\n"
    title: 7.2.  Informative References
  title: 7.  References
- contents:
  - "Author's Address\n   Ben Harris\n   2a Eachard Road\n   CAMBRIDGE\n   CB3 0HY\n
    \  UNITED KINGDOM\n   EMail: bjh21@bjh21.me.uk\n"
  title: Author's Address
- contents:
  - "Trademark Notice\n   \"RC4\" and \"SSH\" are registered trademarks in the United
    States.\n"
  title: Trademark Notice
- contents:
  - "Full Copyright Statement\n   Copyright (C) The Internet Society (2006).\n   This
    document is subject to the rights, licenses and restrictions\n   contained in
    BCP 78, and except as set forth therein, the authors\n   retain all their rights.\n
    \  This document and the information contained herein are provided on an\n   \"AS
    IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n   OR IS SPONSORED
    BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET\n   ENGINEERING TASK FORCE
    DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,\n   INCLUDING BUT NOT LIMITED TO
    ANY WARRANTY THAT THE USE OF THE\n   INFORMATION HEREIN WILL NOT INFRINGE ANY
    RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
    PURPOSE.\n"
  title: Full Copyright Statement
- contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or
    scope of any\n   Intellectual Property Rights or other rights that might be claimed
    to\n   pertain to the implementation or use of the technology described in\n   this
    document or the extent to which any license under such rights\n   might or might
    not be available; nor does it represent that it has\n   made any independent effort
    to identify any such rights.  Information\n   on the procedures with respect to
    rights in RFC documents can be\n   found in BCP 78 and BCP 79.\n   Copies of IPR
    disclosures made to the IETF Secretariat and any\n   assurances of licenses to
    be made available, or the result of an\n   attempt made to obtain a general license
    or permission for the use of\n   such proprietary rights by implementers or users
    of this\n   specification can be obtained from the IETF on-line IPR repository
    at\n   http://www.ietf.org/ipr.\n   The IETF invites any interested party to bring
    to its attention any\n   copyrights, patents or patent applications, or other
    proprietary\n   rights that may cover technology that may be required to implement\n
    \  this standard.  Please address the information to the IETF at\n   ietf-ipr@ietf.org.\n"
  title: Intellectual Property
- contents:
  - "Acknowledgement\n   Funding for the RFC Editor function is provided by the IETF\n
    \  Administrative Support Activity (IASA).\n"
  title: Acknowledgement
