- title: __initial_text__
  contents:
  - "                  Dynamic Authorization Extensions to\n          Remote Authentication\
    \ Dial In User Service (RADIUS)\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This memo provides information for the Internet community.\
    \  It does\n   not specify an Internet standard of any kind.  Distribution of\
    \ this\n   memo is unlimited.\n"
- title: Abstract
  contents:
  - "Abstract\n   This document describes a currently deployed extension to the Remote\n\
    \   Authentication Dial In User Service (RADIUS) protocol, allowing\n   dynamic\
    \ changes to a user session, as implemented by network access\n   server products.\
    \  This includes support for disconnecting users and\n   changing authorizations\
    \ applicable to a user session.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1. Introduction ....................................................2\n\
    \      1.1. Applicability ..............................................3\n  \
    \    1.2. Requirements Language ......................................4\n    \
    \  1.3. Terminology ................................................4\n   2. Overview\
    \ ........................................................4\n      2.1. Disconnect\
    \ Messages (DMs) ..................................5\n      2.2. Change-of-Authorization\
    \ (CoA) Messages .....................5\n      2.3. Packet Format ..............................................6\n\
    \   3. Attributes .....................................................10\n  \
    \    3.1. Proxy State ...............................................12\n    \
    \  3.2. Authorize Only ............................................13\n      3.3.\
    \ State .....................................................14\n      3.4. Message-Authenticator\
    \ .....................................15\n      3.5. Error-Cause ...............................................16\n\
    \      3.6. Table of Attributes .......................................20\n  \
    \ 4. Diameter Considerations ........................................24\n   5.\
    \ IANA Considerations ............................................26\n   6. Security\
    \ Considerations ........................................26\n      6.1. Authorization\
    \ Issues ......................................26\n      6.2. IPsec Usage Guidelines\
    \ ....................................27\n      6.3. Replay Protection .........................................28\n\
    \   7. Example Traces .................................................28\n  \
    \ 8. References .....................................................29\n    \
    \  8.1. Normative References ......................................29\n      8.2.\
    \ Informative References ....................................30\n   9. Acknowledgments\
    \ ................................................30\n   Appendix A ........................................................31\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The RADIUS protocol, defined in [RFC2865], does not support\n\
    \   unsolicited messages sent from the RADIUS server to the Network\n   Access\
    \ Server (NAS).\n   However, there are many instances in which it is desirable\
    \ for\n   changes to be made to session characteristics, without requiring the\n\
    \   NAS to initiate the exchange.  For example, it may be desirable for\n   administrators\
    \ to be able to terminate user session(s) in progress.\n   Alternatively, if the\
    \ user changes authorization level, this may\n   require that authorization attributes\
    \ be added/deleted from user\n   session(s).\n   To overcome these limitations,\
    \ several vendors have implemented\n   additional RADIUS commands in order to\
    \ enable unsolicited messages to\n   be sent to the NAS.  These extended commands\
    \ provide support for\n   Disconnect and Change-of-Authorization (CoA) packets.\
    \  Disconnect\n   packets cause user session(s) to be terminated immediately,\
    \ whereas\n   CoA packets modify session authorization attributes such as data\n\
    \   filters.\n"
- title: 1.1.  Applicability
  contents:
  - "1.1.  Applicability\n   This protocol is being recommended for publication as\
    \ an\n   Informational RFC rather than as a standards-track RFC because of\n \
    \  problems that cannot be fixed without creating incompatibilities with\n   deployed\
    \ implementations.  This includes security vulnerabilities, as\n   well as semantic\
    \ ambiguities resulting from the design of the\n   Change-of-Authorization (CoA)\
    \ commands.  While fixes are recommended,\n   they cannot be made mandatory since\
    \ this would be incompatible with\n   existing implementations.\n   Existing implementations\
    \ of this protocol do not support\n   authorization checks, so that an ISP sharing\
    \ a NAS with another ISP\n   could disconnect or change authorizations for another\
    \ ISP's users.\n   In order to remedy this problem, a \"Reverse Path Forwarding\"\
    \ check is\n   described; see Section 6.1 for details.\n   Existing implementations\
    \ utilize per-packet authentication and\n   integrity protection algorithms with\
    \ known weaknesses [MD5Attack].\n   To provide stronger per-packet authentication\
    \ and integrity\n   protection, the use of IPsec is recommended.  See Section\
    \ 6.2 for\n   details.\n   Existing implementations lack replay protection.  In\
    \ order to support\n   replay detection, it is recommended that an Event-Timestamp\
    \ Attribute\n   be added to all packets in situations where IPsec replay protection\n\
    \   is not employed.  See Section 6.3 for details.\n   The approach taken with\
    \ CoA commands in existing implementations\n   results in a semantic ambiguity.\
    \  Existing implementations of the\n   CoA-Request identify the affected session,\
    \ as well as supply the\n   authorization changes.  Since RADIUS Attributes included\
    \ within\n   existing implementations of the CoA-Request can be used for session\n\
    \   identification or authorization change, it may not be clear which\n   function\
    \ a given attribute is serving.\n   The problem does not exist within the Diameter\
    \ protocol [RFC3588], in\n   which server-initiated authorization change is initiated\
    \ using a\n   Re-Auth-Request (RAR) command identifying the session via User-Name\n\
    \   and Session-Id Attribute Value Pairs (AVPs) and containing a\n   Re-Auth-Request-Type\
    \ AVP with value \"AUTHORIZE_ONLY\".  This results\n   in initiation of a standard\
    \ Request/Response sequence where\n   authorization changes are supplied.  As\
    \ a result, in no command can\n   Diameter AVPs have multiple potential meanings.\n"
- title: 1.2.  Requirements Language
  contents:
  - "1.2.  Requirements Language\n   The key words \"MUST\", \"MUST NOT\", \"REQUIRED\"\
    , \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"\
    MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 1.3.  Terminology
  contents:
  - "1.3.  Terminology\n   This document frequently uses the following terms:\n  \
    \ Dynamic Authorization Client (DAC)\n        The entity originating Change of\
    \ Authorization (CoA) Requests or\n        Disconnect-Requests.  While it is possible\
    \ that the DAC is\n        co-resident with a RADIUS authentication or accounting\
    \ server,\n        this need not necessarily be the case.\n   Dynamic Authorization\
    \ Server (DAS)\n        The entity receiving CoA-Request or Disconnect-Request\
    \ packets.\n        The DAS may be a NAS or a RADIUS proxy.\n   Network Access\
    \ Server (NAS)\n        The device providing access to the network.\n   service\n\
    \        The NAS provides a service to the user, such as IEEE 802 or\n       \
    \ Point-to-Point Protocol (PPP).\n   session\n        Each service provided by\
    \ the NAS to a user constitutes a\n        session, with the beginning of the\
    \ session defined as the point\n        where service is first provided and the\
    \ end of the session\n        defined as the point where service is ended.  A\
    \ user may have\n        multiple sessions in parallel or series if the NAS supports\n\
    \        that.\n   silently discard\n        This means the implementation discards\
    \ the packet without\n        further processing.  The implementation SHOULD provide\
    \ the\n        capability of logging the error, including the contents of the\n\
    \        silently discarded packet, and SHOULD record the event in a\n       \
    \ statistics counter.\n"
- title: 2.  Overview
  contents:
  - "2.  Overview\n   This section describes the most commonly implemented features\
    \ of\n   Disconnect and Change-of-Authorization (CoA) packets.\n"
- title: 2.1.  Disconnect Messages (DMs)
  contents:
  - "2.1.  Disconnect Messages (DMs)\n   A Disconnect-Request packet is sent by the\
    \ Dynamic Authorization\n   Client in order to terminate user session(s) on a\
    \ NAS and discard all\n   associated session context.  The Disconnect-Request\
    \ packet is sent to\n   UDP port 3799, and identifies the NAS as well as the user\
    \ session(s)\n   to be terminated by inclusion of the identification attributes\n\
    \   described in Section 3.\n   +----------+                          +----------+\n\
    \   |          |   Disconnect-Request     |          |\n   |          |   <--------------------\
    \  |          |\n   |    NAS   |                          |    DAC   |\n   | \
    \         |   Disconnect-ACK/NAK     |          |\n   |          |   --------------------->\
    \ |          |\n   +----------+                          +----------+\n   The\
    \ NAS responds to a Disconnect-Request packet sent by a Dynamic\n   Authorization\
    \ Client with a Disconnect-ACK if all associated session\n   context is discarded\
    \ and the user session(s) are no longer connected,\n   or a Disconnect-NAK, if\
    \ the NAS was unable to disconnect one or more\n   sessions and discard all associated\
    \ session context.  A Disconnect-\n   ACK MAY contain the Acct-Terminate-Cause\
    \ (49) Attribute [RFC2866]\n   with the value set to 6 for Admin-Reset.\n"
- title: 2.2.  Change-of-Authorization (CoA) Messages
  contents:
  - "2.2.  Change-of-Authorization (CoA) Messages\n   CoA-Request packets contain\
    \ information for dynamically changing\n   session authorizations.  Typically,\
    \ this is used to change data\n   filters.  The data filters can be of either\
    \ the ingress or egress\n   kind, and are sent in addition to the identification\
    \ attributes as\n   described in Section 3.  The port used and packet format (described\n\
    \   in Section 2.3) are the same as those for Disconnect-Request packets.\n  \
    \ The following attributes MAY be sent in a CoA-Request:\n   Filter-ID (11) -\
    \        Indicates the name of a data filter list\n                          \
    \ to be applied for the session(s) that the\n                           identification\
    \ attributes map to.\n   NAS-Filter-Rule (92) -  Provides a filter list to be\
    \ applied for\n                           the session(s) that the identification\n\
    \                           attributes map to [RFC4849].\n   +----------+    \
    \                      +----------+\n   |          |      CoA-Request        \
    \ |          |\n   |          |  <--------------------   |          |\n   |  \
    \ NAS    |                          |    DAC   |\n   |          |     CoA-ACK/NAK\
    \          |          |\n   |          |   ---------------------> |          |\n\
    \   +----------+                          +----------+\n   The NAS responds to\
    \ a CoA-Request sent by a Dynamic Authorization\n   Client with a CoA-ACK if the\
    \ NAS is able to successfully change the\n   authorizations for the user session(s),\
    \ or a CoA-NAK if the CoA-\n   Request is unsuccessful.  A NAS MUST respond to\
    \ a CoA-Request\n   including a Service-Type Attribute with an unsupported value\
    \ with a\n   CoA-NAK; an Error-Cause Attribute with value \"Unsupported Service\"\
    \n   SHOULD be included.\n"
- title: 2.3.  Packet Format
  contents:
  - "2.3.  Packet Format\n   For either Disconnect-Request or CoA-Request packets\
    \ UDP port 3799 is\n   used as the destination port.  For responses, the source\
    \ and\n   destination ports are reversed.  Exactly one RADIUS packet is\n   encapsulated\
    \ in the UDP Data field.\n   A summary of the data format is shown below.  The\
    \ fields are\n   transmitted from left to right.\n   The packet format consists\
    \ of the following fields: Code, Identifier,\n   Length, Authenticator, and Attributes\
    \ in Type-Length-Value (TLV)\n   format.  All fields hold the same meaning as\
    \ those described in\n   RADIUS [RFC2865].  The Authenticator field MUST be calculated\
    \ in the\n   same way as is specified for an Accounting-Request in [RFC2866].\n\
    \    0                   1                   2                   3\n    0 1 2\
    \ 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |     Code      |  Identifier   |            Length             |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |                                                               |\n   |  \
    \                       Authenticator                         |\n   |        \
    \                                                       |\n   |              \
    \                                                 |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   |  Attributes ...\n   +-+-+-+-+-+-+-+-+-+-+-+-+-\n   Code\n      The Code\
    \ field is one octet, and identifies the type of RADIUS\n      packet.  Packets\
    \ received with an invalid Code field MUST be\n      silently discarded.  RADIUS\
    \ codes (decimal) for this extension are\n      assigned as follows:\n      40\
    \ - Disconnect-Request [RFC3575]\n      41 - Disconnect-ACK [RFC3575]\n      42\
    \ - Disconnect-NAK [RFC3575]\n      43 - CoA-Request [RFC3575]\n      44 - CoA-ACK\
    \ [RFC3575]\n      45 - CoA-NAK [RFC3575]\n   Identifier\n      The Identifier\
    \ field is one octet, and aids in matching requests\n      and replies.  A Dynamic\
    \ Authorization Server implementing this\n      specification MUST be capable\
    \ of detecting a duplicate request if\n      it has the same source IP address,\
    \ source UDP port, and Identifier\n      within a short span of time.\n      The\
    \ responsibility for retransmission of Disconnect-Request and\n      CoA-Request\
    \ packets lies with the Dynamic Authorization Client.\n      If after sending\
    \ these packets, the Dynamic Authorization Client\n      does not receive a response,\
    \ it will retransmit.\n      The Identifier field MUST be changed whenever the\
    \ content of the\n      Attributes field changes, or whenever a valid reply has\
    \ been\n      received for a previous request.  For retransmissions where the\n\
    \      contents are identical, the Identifier MUST remain unchanged.\n      If\
    \ the Dynamic Authorization Client is retransmitting a\n      Disconnect-Request\
    \ or CoA-Request to the same Dynamic\n      Authorization Server as before, and\
    \ the attributes haven't\n      changed, the same Request Authenticator, Identifier,\
    \ and source\n      port MUST be used.  If any attributes have changed, a new\n\
    \      Authenticator and Identifier MUST be used.\n      If the Request to a primary\
    \ Dynamic Authorization Server fails, a\n      secondary Dynamic Authorization\
    \ Server must be queried, if\n      available; issues relating to failover algorithms\
    \ are described in\n      [RFC3539].  Since this represents a new request, a new\
    \ Request\n      Authenticator and Identifier MUST be used.  However, where the\n\
    \      Dynamic Authorization Client is sending directly to the NAS,\n      failover\
    \ typically does not make sense, since CoA-Request or\n      Disconnect-Request\
    \ packets need to be delivered to the NAS where\n      the session resides.\n\
    \   Length\n      The Length field is two octets.  It indicates the length of\
    \ the\n      packet including the Code, Identifier, Length, Authenticator, and\n\
    \      Attribute fields.  Octets outside the range of the Length field\n     \
    \ MUST be treated as padding and ignored on reception.  If the\n      packet is\
    \ shorter than the Length field indicates, it MUST be\n      silently discarded.\
    \  The minimum length is 20 and maximum length\n      is 4096.\n   Authenticator\n\
    \      The Authenticator field is sixteen (16) octets.  The most\n      significant\
    \ octet is transmitted first.  This value is used to\n      authenticate packets\
    \ between the Dynamic Authorization Client and\n      the Dynamic Authorization\
    \ Server.\n      Request Authenticator\n         In Request packets, the Authenticator\
    \ value is a 16-octet MD5\n         [RFC1321] checksum, called the Request Authenticator.\
    \  The\n         Request Authenticator is calculated the same way as for an\n\
    \         Accounting-Request, specified in [RFC2866].\n         Note that the\
    \ Request Authenticator of a CoA-Request or\n         Disconnect-Request cannot\
    \ be computed the same way as the\n         Request Authenticator of a RADIUS\
    \ Access-Request, because there\n         is no User-Password Attribute in a CoA-Request\
    \ or Disconnect-\n         Request.\n      Response Authenticator\n         The\
    \ Authenticator field in a Response packet (e.g.,\n         Disconnect-ACK, Disconnect-NAK,\
    \ CoA-ACK, or CoA-NAK) is called\n         the Response Authenticator, and contains\
    \ a one-way MD5 hash\n         calculated over a stream of octets consisting of\
    \ the Code,\n         Identifier, Length, the Request Authenticator field from\
    \ the\n         packet being replied to, and the response attributes if any,\n\
    \         followed by the shared secret.  The resulting 16-octet MD5 hash\n  \
    \       value is stored in the Authenticator field of the Response\n         packet.\n\
    \      Administrative note: As noted in [RFC2865], Section 3, the secret\n   \
    \   (password shared between the Dynamic Authorization Client and the\n      Dynamic\
    \ Authorization Server) SHOULD be at least as large and\n      unguessable as\
    \ a well-chosen password.  The Dynamic Authorization\n      Server MUST use the\
    \ source IP address of the RADIUS UDP packet to\n      decide which shared secret\
    \ to use, so that requests can be\n      proxied.\n   Attributes\n      In CoA-Request\
    \ and Disconnect-Request packets, all attributes MUST\n      be treated as mandatory.\
    \  If one or more authorization changes\n      specified in a CoA-Request cannot\
    \ be carried out, the NAS MUST\n      send a CoA-NAK.  A NAS MUST respond to a\
    \ CoA-Request containing\n      one or more unsupported attributes or Attribute\
    \ values with a\n      CoA-NAK; an Error-Cause Attribute with value 401 (Unsupported\n\
    \      Attribute) or 407 (Invalid Attribute Value) MAY be included.  A\n     \
    \ NAS MUST respond to a Disconnect-Request containing one or more\n      unsupported\
    \ attributes or Attribute values with a Disconnect-NAK;\n      an Error-Cause\
    \ Attribute with value 401 (Unsupported Attribute) or\n      407 (Invalid Attribute\
    \ Value) MAY be included.\n      State changes resulting from a CoA-Request MUST\
    \ be atomic: if the\n      CoA-Request is successful for all matching sessions,\
    \ the NAS MUST\n      send a CoA-ACK in reply, and all requested authorization\
    \ changes\n      MUST be made.  If the CoA-Request is unsuccessful for any matching\n\
    \      sessions, the NAS MUST send a CoA-NAK in reply, and the requested\n   \
    \   authorization changes MUST NOT be made for any of the matching\n      sessions.\
    \  Similarly, a state change MUST NOT occur as a result of\n      a Disconnect-Request\
    \ that is unsuccessful with respect to any of\n      the matching sessions; a\
    \ NAS MUST send a Disconnect-NAK in reply\n      if any of the matching sessions\
    \ cannot be successfully terminated.\n      A NAS that does not support dynamic\
    \ authorization changes applying\n      to multiple sessions MUST send a CoA-NAK\
    \ or Disconnect-NAK in\n      reply; an Error-Cause Attribute with value 508 (Multiple\
    \ Session\n      Selection Unsupported) SHOULD be included.\n      Within this\
    \ specification, attributes can be used for\n      identification, authorization,\
    \ or other purposes.  RADIUS\n      Attribute specifications created after publication\
    \ of this\n      document SHOULD state whether an attribute can be included in\
    \ CoA\n      or Disconnect messages, and if so, which messages it can be\n   \
    \   included in and whether it serves as an identification or\n      authorization\
    \ attribute.\n      Even if a NAS implements an attribute for use with RADIUS\n\
    \      authentication and accounting, it is possible that it will not\n      support\
    \ inclusion of that attribute within CoA-Request and\n      Disconnect-Request\
    \ packets, given the difference in attribute\n      semantics.  This is true even\
    \ for attributes specified as\n      allowable within Access-Accept packets (such\
    \ as those defined\n      within [RFC2865], [RFC2868], [RFC2869], [RFC3162], [RFC3579],\n\
    \      [RFC4372], [RFC4675], [RFC4818], and [RFC4849]).\n"
- title: 3.  Attributes
  contents:
  - "3.  Attributes\n   In Disconnect-Request and CoA-Request packets, certain attributes\
    \ are\n   used to uniquely identify the NAS as well as user session(s) on the\n\
    \   NAS.  The combination of NAS and session identification attributes\n   included\
    \ in a CoA-Request or Disconnect-Request packet MUST match at\n   least one session\
    \ in order for a Request to be successful; otherwise\n   a Disconnect-NAK or CoA-NAK\
    \ MUST be sent.  If all NAS identification\n   attributes match, and more than\
    \ one session matches all of the\n   session identification attributes, then a\
    \ CoA-Request or Disconnect-\n   Request MUST apply to all matching sessions.\n\
    \   Identification attributes include NAS and session identification\n   attributes,\
    \ as described below.\n     NAS identification attributes\n     Attribute    \
    \          #   Reference  Description\n     ---------             ---  ---------\
    \  -----------\n     NAS-IP-Address         4   [RFC2865]  The IPv4 address of\
    \ the NAS.\n     NAS-Identifier        32   [RFC2865]  String identifying the\
    \ NAS.\n     NAS-IPv6-Address      95   [RFC3162]  The IPv6 address of the NAS.\n\
    \     Session identification attributes\n     Attribute              #   Reference\
    \  Description\n     ---------             ---  ---------  -----------\n     User-Name\
    \              1   [RFC2865]  The name of the user\n                         \
    \                  associated with one or\n                                  \
    \         more sessions.\n     NAS-Port               5   [RFC2865]  The port\
    \ on which a\n                                           session is terminated.\n\
    \     Framed-IP-Address      8   [RFC2865]  The IPv4 address associated\n    \
    \                                       with a session.\n     Vendor-Specific\
    \       26   [RFC2865]  One or more vendor-specific\n                        \
    \                   identification attributes.\n     Called-Station-Id     30\
    \   [RFC2865]  The link address to which\n                                   \
    \        a session is connected.\n     Calling-Station-Id    31   [RFC2865]  The\
    \ link address from which\n                                           one or more\
    \ sessions are\n                                           connected.\n     Acct-Session-Id\
    \       44   [RFC2866]  The identifier uniquely\n                            \
    \               identifying a session\n                                      \
    \     on the NAS.\n     Acct-Multi-Session-Id 50   [RFC2866]  The identifier uniquely\n\
    \                                           identifying related sessions.\n  \
    \   NAS-Port-Id           87   [RFC2869]  String identifying the port\n      \
    \                                     where a session is.\n     Chargeable-User-\
    \      89   [RFC4372]  The CUI associated with one\n     Identity            \
    \                  or more sessions.  Needed\n                               \
    \            where a privacy Network\n                                       \
    \    Access Identifier (NAI) is\n                                           used,\
    \ since in this case the\n                                           User-Name\
    \ (e.g., \"anonymous\")\n                                           may not identify\
    \ sessions\n                                           belonging to a given user.\n\
    \     Framed-Interface-Id   96   [RFC3162]  The IPv6 Interface Identifier\n  \
    \                                         associated with a session,\n       \
    \                                    always sent with\n                      \
    \                     Framed-IPv6-Prefix.\n     Framed-IPv6-Prefix    97   [RFC3162]\
    \  The IPv6 prefix associated\n                                           with\
    \ a session, always sent\n                                           with Framed-Interface-Id.\n\
    \   To address security concerns described in Section 6.1, either the\n   User-Name\
    \ or Chargeable-User-Identity attribute SHOULD be present in\n   Disconnect-Request\
    \ and CoA-Request packets.\n   Where a Diameter client utilizes the same Session-Id\
    \ for both\n   authorization and accounting, inclusion of an Acct-Session-Id\n\
    \   Attribute in a Disconnect-Request or CoA-Request can assist with\n   Diameter/RADIUS\
    \ translation, since Diameter RAR and ASR commands\n   include a Session-Id AVP.\
    \  An Acct-Session-Id Attribute SHOULD be\n   included in Disconnect-Request and\
    \ CoA-Request packets.\n   A NAS implementing this specification SHOULD send an\
    \ Acct-Session-Id\n   or Acct-Multi-Session-Id Attribute within an Access-Request.\
    \  Where\n   an Acct-Session-Id or Acct-Multi-Session-Id Attribute is not included\n\
    \   within an Access-Request, the Dynamic Authorization Client will not\n   know\
    \ the Acct-Session-Id or Acct-Multi-Session-Id of the session it\n   is attempting\
    \ to target, unless it also has access to the accounting\n   data for that session.\n\
    \   Where an Acct-Session-Id or Acct-Multi-Session-Id Attribute is not\n   present\
    \ in a CoA-Request or Disconnect-Request, it is possible that\n   the User-Name\
    \ or Chargeable-User-Identity attributes will not be\n   sufficient to uniquely\
    \ identify a single session (e.g., if the same\n   user has multiple sessions\
    \ on the NAS, or if the privacy NAI is\n   used).  In this case, if it is desired\
    \ to identify a single session,\n   session identification MAY be performed by\
    \ using one or more of the\n   Framed-IP-Address, Framed-IPv6-Prefix/Framed-Interface-Id,\
    \ Called-\n   Station-Id, Calling-Station-Id, NAS-Port, and NAS-Port-Id attributes.\n\
    \   To assist RADIUS proxies in routing Request packets to their\n   destination,\
    \ one or more of the NAS-IP-Address or NAS-IPv6-Address\n   attributes SHOULD\
    \ be present in CoA-Request and Disconnect-Request\n   packets; the NAS-Identifier\
    \ Attribute MAY be present.  Impersonation\n   issues with NAS Identification\
    \ attributes are discussed in [RFC3579],\n   Section 4.3.7.\n   A Disconnect-Request\
    \ MUST contain only NAS and session identification\n   attributes.  If other attributes\
    \ are included in a Disconnect-\n   Request, implementations MUST send a Disconnect-NAK;\
    \ an Error-Cause\n   Attribute with value \"Unsupported Attribute\" MAY be included.\n\
    \   The DAC may require access to data from RADIUS authentication or\n   accounting\
    \ packets.  It uses this data to compose compliant CoA-\n   Request or Disconnect-Request\
    \ packets.  For example, as described in\n   Section 3.3, a CoA-Request packet\
    \ containing a Service-Type Attribute\n   with a value of \"Authorize Only\" is\
    \ required to contain a State\n   Attribute.  The NAS will subsequently transmit\
    \ this attribute to the\n   RADIUS server in an Access-Request.  In order for\
    \ the DAC to include\n   a State Attribute that the RADIUS server will subsequently\
    \ accept,\n   some coordination between the two parties may be required.\n   This\
    \ coordination can be achieved in multiple ways.  The DAC may be\n   co-located\
    \ with a RADIUS server, in which case it is presumed to have\n   access to the\
    \ necessary data.  The RADIUS server may also store that\n   information in a\
    \ common database.  The DAC can then be separated from\n   the RADIUS server,\
    \ so long as it has access to that common database.\n   Where the DAC is not co-located\
    \ with a RADIUS server, and does not\n   have access to a common database, the\
    \ DAC SHOULD send CoA-Request or\n   Disconnect-Request packets to a RADIUS server\
    \ acting as a proxy,\n   rather than sending them directly to the NAS.\n   A RADIUS\
    \ server receiving a CoA-Request or Disconnect-Request packet\n   from the DAC\
    \ MAY then add or update attributes (such as adding NAS or\n   session identification\
    \ attributes or appending a State Attribute),\n   prior to forwarding the packet.\
    \  Having CoA/Disconnect-Requests\n   forwarded by a RADIUS server can also enable\
    \ upstream RADIUS proxies\n   to perform a Reverse Path Forwarding (RPF) check\
    \ (see Section 6.1).\n"
- title: 3.1.  Proxy State
  contents:
  - "3.1.  Proxy State\n   If there are any Proxy-State attributes in a Disconnect-Request\
    \ or\n   CoA-Request received from the Dynamic Authorization Client, the\n   Dynamic\
    \ Authorization Server MUST include those Proxy-State\n   attributes in its response\
    \ to the Dynamic Authorization Client.\n   A forwarding proxy or NAS MUST NOT\
    \ modify existing Proxy-State,\n   State, or Class attributes present in the packet.\
    \  The forwarding\n   proxy or NAS MUST treat any Proxy-State attributes already\
    \ in the\n   packet as opaque data.  Its operation MUST NOT depend on the content\n\
    \   of Proxy-State attributes added by previous proxies.  The forwarding\n   proxy\
    \ MUST NOT modify any other Proxy-State attributes that were in\n   the packet;\
    \ it may choose not to forward them, but it MUST NOT change\n   their contents.\
    \  If the forwarding proxy omits the Proxy-State\n   attributes in the request,\
    \ it MUST attach them to the response before\n   sending it.\n   When the proxy\
    \ forwards a Disconnect-Request or CoA-Request, it MAY\n   add a Proxy-State Attribute,\
    \ but it MUST NOT add more than one.  If a\n   Proxy-State Attribute is added\
    \ to a packet when forwarding the\n   packet, the Proxy-State Attribute MUST be\
    \ added after any existing\n   Proxy-State attributes.  The forwarding proxy MUST\
    \ NOT change the\n   order of any attributes of the same type, including Proxy-State.\n\
    \   Other attributes can be placed before, after, or even between the\n   Proxy-State\
    \ attributes.\n   When the proxy receives a response to a CoA-Request or Disconnect-\n\
    \   Request, it MUST remove its own Proxy-State Attribute (the last\n   Proxy-State\
    \ in the packet) before forwarding the response.  Since\n   Disconnect and CoA\
    \ responses are authenticated on the entire packet\n   contents, the stripping\
    \ of the Proxy-State Attribute invalidates the\n   integrity check, so the proxy\
    \ MUST recompute it.\n"
- title: 3.2.  Authorize Only
  contents:
  - "3.2.  Authorize Only\n   To simplify translation between RADIUS and Diameter,\
    \ Dynamic\n   Authorization Clients can include a Service-Type Attribute with\
    \ value\n   \"Authorize Only\" within a CoA-Request; see Section 4 for details\
    \ on\n   Diameter considerations.  Support for a CoA-Request including a\n   Service-Type\
    \ Attribute with value \"Authorize Only\" is OPTIONAL on the\n   NAS and Dynamic\
    \ Authorization Client.  A Service-Type Attribute MUST\n   NOT be included within\
    \ a Disconnect-Request.\n   A NAS MUST respond to a CoA-Request including a Service-Type\n\
    \   Attribute with value \"Authorize Only\" with a CoA-NAK; a CoA-ACK MUST\n \
    \  NOT be sent.  If the NAS does not support a Service-Type value of\n   \"Authorize\
    \ Only\", then it MUST respond with a CoA-NAK; an Error-Cause\n   Attribute with\
    \ a value of 405 (Unsupported Service) SHOULD be\n   included.\n   A CoA-Request\
    \ containing a Service-Type Attribute with value\n   \"Authorize Only\" MUST in\
    \ addition contain only NAS or session\n   identification attributes, as well\
    \ as a State Attribute.  If other\n   attributes are included in such a CoA-Request,\
    \ a CoA-NAK MUST be\n   sent; an Error-Cause Attribute with value 401 (Unsupported\
    \ Attribute)\n   SHOULD be included.\n   If a CoA-Request packet including a Service-Type\
    \ value of \"Authorize\n   Only\" is successfully processed, the NAS MUST respond\
    \ with a CoA-NAK\n   containing a Service-Type Attribute with value \"Authorize\
    \ Only\", and\n   an Error-Cause Attribute with value 507 (Request Initiated).\
    \  The NAS\n   then MUST send an Access-Request to the RADIUS server including\
    \ a\n   Service-Type Attribute with value \"Authorize Only\", along with a\n \
    \  State Attribute.  This Access-Request SHOULD contain the NAS\n   identification\
    \ attributes from the CoA-Request, as well as the\n   session identification attributes\
    \ from the CoA-Request permitted in\n   an Access-Request; it also MAY contain\
    \ other attributes permitted in\n   an Access-Request.\n   As noted in [RFC2869],\
    \ Section 5.19, a Message-Authenticator\n   attribute SHOULD be included in an\
    \ Access-Request that does not\n   contain a User-Password, CHAP-Password, ARAP-Password,\
    \ or EAP-Message\n   Attribute.  The RADIUS server then will respond to the Access-Request\n\
    \   with an Access-Accept to (re-)authorize the session or an Access-\n   Reject\
    \ to refuse to (re-)authorize it.\n"
- title: 3.3.  State
  contents:
  - "3.3.  State\n   The State Attribute is available to be sent by the Dynamic\n\
    \   Authorization Client to the NAS in a CoA-Request packet and MUST be\n   sent\
    \ unmodified from the NAS to the Dynamic Authorization Client in a\n   subsequent\
    \ ACK or NAK packet.\n   [RFC2865], Section 5.44 states:\n      An Access-Request\
    \ MUST contain either a User-Password or a\n      CHAP-Password or State.  An\
    \ Access-Request MUST NOT contain both a\n      User-Password and a CHAP-Password.\
    \  If future extensions allow\n      other kinds of authentication information\
    \ to be conveyed, the\n      attribute for that can be used in an Access-Request\
    \ instead of\n      User-Password or CHAP-Password.\n   In order to satisfy the\
    \ requirements of [RFC2865], Section 5.44, an\n   Access-Request with Service-Type\
    \ Attribute with value \"Authorize\n   Only\" MUST contain a State Attribute.\n\
    \   In order to provide a State Attribute to the NAS, a Dynamic\n   Authorization\
    \ Client sending a CoA-Request with a Service-Type\n   Attribute with a value\
    \ of \"Authorize Only\" MUST include a State\n   Attribute, and the NAS MUST send\
    \ the State Attribute unmodified to\n   the RADIUS server in the resulting Access-Request,\
    \ if any.  A NAS\n   receiving a CoA-Request containing a Service-Type Attribute\
    \ with a\n   value of \"Authorize Only\" but lacking a State Attribute MUST send\
    \ a\n   CoA-NAK and SHOULD include an Error-Cause Attribute with a value of\n\
    \   402 (Missing Attribute).\n   The State Attribute is also available to be sent\
    \ by the Dynamic\n   Authorization Client to the NAS in a CoA-Request that also\
    \ includes a\n   Termination-Action Attribute with the value of RADIUS-Request.\
    \  If\n   the NAS performs the Termination-Action by sending a new Access-\n \
    \  Request upon termination of the current session, it MUST include the\n   State\
    \ Attribute unchanged in that Access-Request.  In either usage,\n   the Dynamic\
    \ Authorization Server MUST NOT interpret the Attribute\n   locally.  A CoA-Request\
    \ packet MUST have only zero or one State\n   Attribute.  Usage of the State Attribute\
    \ is implementation dependent.\n"
- title: 3.4.  Message-Authenticator
  contents:
  - "3.4.  Message-Authenticator\n   The Message-Authenticator Attribute MAY be used\
    \ to authenticate and\n   integrity-protect CoA-Request, CoA-ACK, CoA-NAK, Disconnect-Request,\n\
    \   Disconnect-ACK, and Disconnect-NAK packets in order to prevent\n   spoofing.\n\
    \   A Dynamic Authorization Server receiving a CoA-Request or\n   Disconnect-Request\
    \ with a Message-Authenticator Attribute present\n   MUST calculate the correct\
    \ value of the Message-Authenticator and\n   silently discard the packet if it\
    \ does not match the value sent.  A\n   Dynamic Authorization Client receiving\
    \ a CoA/Disconnect-ACK or\n   CoA/Disconnect-NAK with a Message-Authenticator\
    \ Attribute present\n   MUST calculate the correct value of the Message-Authenticator\
    \ and\n   silently discard the packet if it does not match the value sent.\n \
    \  When a Message-Authenticator Attribute is included within a CoA-\n   Request\
    \ or Disconnect-Request, it is calculated as follows:\n      Message-Authenticator\
    \ = HMAC-MD5 (Type, Identifier, Length,\n      Request Authenticator, Attributes)\n\
    \      When the HMAC-MD5 message integrity check is calculated the\n      Request\
    \ Authenticator field and Message-Authenticator Attribute\n      MUST each be\
    \ considered to be sixteen octets of zero.  The\n      Message-Authenticator Attribute\
    \ is calculated and inserted in the\n      packet before the Request Authenticator\
    \ is calculated.\n      When a Message-Authenticator Attribute is included within\
    \ a CoA-\n      ACK, CoA-NAK, Disconnect-ACK, or Disconnect-NAK, it is calculated\n\
    \      as follows:\n         Message-Authenticator = HMAC-MD5 (Type, Identifier,\
    \ Length,\n         Request Authenticator, Attributes)\n      When the HMAC-MD5\
    \ message integrity check is calculated, the\n      Message-Authenticator Attribute\
    \ MUST be considered to be sixteen\n      octets of zero.  The Request Authenticator\
    \ is taken from the\n      corresponding CoA/Disconnect-Request.  The Message-Authenticator\n\
    \      is calculated and inserted in the packet before the Response\n      Authenticator\
    \ is calculated.\n"
- title: 3.5.  Error-Cause
  contents:
  - "3.5.  Error-Cause\n   Description\n      It is possible that a Dynamic Authorization\
    \ Server cannot honor\n      Disconnect-Request or CoA-Request packets for some\
    \ reason.  The\n      Error-Cause Attribute provides more detail on the cause\
    \ of the\n      problem.  It MAY be included within CoA-NAK and Disconnect-NAK\n\
    \      packets.\n      A summary of the Error-Cause Attribute format is shown\
    \ below.  The\n      fields are transmitted from left to right.\n       0    \
    \               1                   2                   3\n       0 1 2 3 4 5\
    \ 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \      |     Type      |    Length     |             Value\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Value (cont)         |\n      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \   Type\n      101 for Error-Cause\n   Length\n      6\n   Value\n      The Value\
    \ field is four octets, containing an integer specifying\n      the cause of the\
    \ error.  Values 0-199 and 300-399 are reserved.\n      Values 200-299 represent\
    \ successful completion, so that these\n      values may only be sent within CoA-ACK\
    \ or Disconnect-ACK packets\n      and MUST NOT be sent within a CoA-NAK or Disconnect-NAK\
    \ packet.\n      Values 400-499 represent fatal errors committed by the Dynamic\n\
    \      Authorization Client, so that they MAY be sent within CoA-NAK or\n    \
    \  Disconnect-NAK packets, and MUST NOT be sent within CoA-ACK or\n      Disconnect-ACK\
    \ packets.  Values 500-599 represent fatal errors\n      occurring on a Dynamic\
    \ Authorization Server, so that they MAY be\n      sent within CoA-NAK and Disconnect-NAK\
    \ packets, and MUST NOT be\n      sent within CoA-ACK or Disconnect-ACK packets.\
    \  Error-Cause values\n      SHOULD be logged by the Dynamic Authorization Client.\
    \  Error-Code\n      values (expressed in decimal) include:\n       #     Value\n\
    \      ---    -----\n      201    Residual Session Context Removed\n      202\
    \    Invalid EAP Packet (Ignored)\n      401    Unsupported Attribute\n      402\
    \    Missing Attribute\n      403    NAS Identification Mismatch\n      404  \
    \  Invalid Request\n      405    Unsupported Service\n      406    Unsupported\
    \ Extension\n      407    Invalid Attribute Value\n      501    Administratively\
    \ Prohibited\n      502    Request Not Routable (Proxy)\n      503    Session\
    \ Context Not Found\n      504    Session Context Not Removable\n      505   \
    \ Other Proxy Processing Error\n      506    Resources Unavailable\n      507\
    \    Request Initiated\n      508    Multiple Session Selection Unsupported\n\
    \      \"Residual Session Context Removed\" is sent in response to a\n      Disconnect-Request\
    \ if one or more user sessions are no longer\n      active, but residual session\
    \ context was found and successfully\n      removed.  This value is only sent\
    \ within a Disconnect-ACK and MUST\n      NOT be sent within a CoA-ACK, Disconnect-NAK,\
    \ or CoA-NAK.\n      \"Invalid EAP Packet (Ignored)\" is a non-fatal error that\
    \ MUST NOT\n      be sent by implementations of this specification.\n      \"\
    Unsupported Attribute\" is a fatal error sent if a Request\n      contains an\
    \ attribute (such as a Vendor-Specific or EAP-Message\n      Attribute) that is\
    \ not supported.\n      \"Missing Attribute\" is a fatal error sent if critical\
    \ attributes\n      (such as NAS or session identification attributes) are missing\n\
    \      from a Request.\n      \"NAS Identification Mismatch\" is a fatal error\
    \ sent if one or more\n      NAS identification attributes (see Section 3) do\
    \ not match the\n      identity of the NAS receiving the Request.\n      \"Invalid\
    \ Request\" is a fatal error sent if some other aspect of\n      the Request is\
    \ invalid, such as if one or more attributes (such as\n      EAP-Message Attribute(s))\
    \ are not formatted properly.\n      \"Unsupported Service\" is a fatal error\
    \ sent if a Service-Type\n      Attribute included with the Request is sent with\
    \ an invalid or\n      unsupported value.  This error cannot be sent in response\
    \ to a\n      Disconnect-Request.\n      \"Unsupported Extension\" is a fatal\
    \ error sent due to lack of\n      support for an extension such as Disconnect\
    \ and/or CoA packets.\n      This will typically be sent by a proxy receiving\
    \ an ICMP port\n      unreachable message after attempting to forward a CoA-Request\
    \ or\n      Disconnect-Request to the NAS.\n      \"Invalid Attribute Value\"\
    \ is a fatal error sent if a CoA-Request\n      or Disconnect-Request contains\
    \ an attribute with an unsupported\n      value.\n      \"Administratively Prohibited\"\
    \ is a fatal error sent if the NAS is\n      configured to prohibit honoring of\
    \ CoA-Request or Disconnect-\n      Request packets for the specified session.\n\
    \      \"Request Not Routable\" is a fatal error that MAY be sent by a\n     \
    \ proxy and MUST NOT be sent by a NAS.  It indicates that the proxy\n      was\
    \ unable to determine how to route a CoA-Request or Disconnect-\n      Request\
    \ to the NAS.  For example, this can occur if the required\n      entries are\
    \ not present in the proxy's realm routing table.\n      \"Session Context Not\
    \ Found\" is a fatal error sent if the session\n      context identified in the\
    \ CoA-Request or Disconnect-Request does\n      not exist on the NAS.\n      \"\
    Session Context Not Removable\" is a fatal error sent in response\n      to a\
    \ Disconnect-Request if the NAS was able to locate the session\n      context,\
    \ but could not remove it for some reason.  It MUST NOT be\n      sent within\
    \ a CoA-ACK, CoA-NAK, or Disconnect-ACK, only within a\n      Disconnect-NAK.\n\
    \      \"Other Proxy Processing Error\" is a fatal error sent in response\n  \
    \    to a CoA or Disconnect-Request that could not be processed by a\n      proxy,\
    \ for reasons other than routing.\n      \"Resources Unavailable\" is a fatal\
    \ error sent when a CoA or\n      Disconnect-Request could not be honored due\
    \ to lack of available\n      NAS resources (memory, non-volatile storage, etc.).\n\
    \      \"Request Initiated\" is a fatal error sent by a NAS in response to\n \
    \     a CoA-Request including a Service-Type Attribute with a value of\n     \
    \ \"Authorize Only\".  It indicates that the CoA-Request has not been\n      honored,\
    \ but that the NAS is sending one or more RADIUS Access-\n      Requests including\
    \ a Service-Type Attribute with value \"Authorize\n      Only\" to the RADIUS\
    \ server.\n      \"Multiple Session Selection Unsupported\" is a fatal error sent\
    \ by\n      a NAS in response to a CoA-Request or Disconnect-Request whose\n \
    \     session identification attributes match multiple sessions, where\n     \
    \ the NAS does not support Requests applying to multiple sessions.\n"
- title: 3.6.  Table of Attributes
  contents:
  - "3.6.  Table of Attributes\n   The following table provides a guide to which attributes\
    \ may be found\n   in which packets, and in what quantity.\n   Change-of-Authorization\
    \ Messages\n   Request   ACK      NAK   #   Attribute\n   0-1       0        0\
    \     1   User-Name (Note 1)\n   0-1       0        0     4   NAS-IP-Address (Note\
    \ 1)\n   0-1       0        0     5   NAS-Port (Note 1)\n   0-1       0      \
    \  0-1   6   Service-Type\n   0-1       0        0     7   Framed-Protocol (Note\
    \ 3)\n   0-1       0        0     8   Framed-IP-Address (Notes 1, 6)\n   0-1 \
    \      0        0     9   Framed-IP-Netmask (Note 3)\n   0-1       0        0\
    \    10   Framed-Routing (Note 3)\n   0+        0        0    11   Filter-ID (Note\
    \ 3)\n   0-1       0        0    12   Framed-MTU (Note 3)\n   0+        0    \
    \    0    13   Framed-Compression (Note 3)\n   0+        0        0    14   Login-IP-Host\
    \ (Note 3)\n   0-1       0        0    15   Login-Service (Note 3)\n   0-1   \
    \    0        0    16   Login-TCP-Port (Note 3)\n   0+        0        0    18\
    \   Reply-Message (Note 2)\n   0-1       0        0    19   Callback-Number (Note\
    \ 3)\n   0-1       0        0    20   Callback-Id (Note 3)\n   0+        0   \
    \     0    22   Framed-Route (Note 3)\n   0-1       0        0    23   Framed-IPX-Network\
    \ (Note 3)\n   0-1       0-1      0-1  24   State\n   0+        0        0   \
    \ 25   Class (Note 3)\n   0+        0        0    26   Vendor-Specific (Note 7)\n\
    \   0-1       0        0    27   Session-Timeout (Note 3)\n   0-1       0    \
    \    0    28   Idle-Timeout (Note 3)\n   0-1       0        0    29   Termination-Action\
    \ (Note 3)\n   Request   ACK      NAK   #   Attribute\n   Request   ACK      NAK\
    \   #   Attribute\n   0-1       0        0    30   Called-Station-Id (Note 1)\n\
    \   0-1       0        0    31   Calling-Station-Id (Note 1)\n   0-1       0 \
    \       0    32   NAS-Identifier (Note 1)\n   0+        0+       0+   33   Proxy-State\n\
    \   0-1       0        0    34   Login-LAT-Service (Note 3)\n   0-1       0  \
    \      0    35   Login-LAT-Node (Note 3)\n   0-1       0        0    36   Login-LAT-Group\
    \ (Note 3)\n   0-1       0        0    37   Framed-AppleTalk-Link (Note 3)\n \
    \  0+        0        0    38   Framed-AppleTalk-Network (Note 3)\n   0-1    \
    \   0        0    39   Framed-AppleTalk-Zone (Note 3)\n   0-1       0        0\
    \    44   Acct-Session-Id (Note 1)\n   0-1       0        0    50   Acct-Multi-Session-Id\
    \ (Note 1)\n   0-1       0-1      0-1  55   Event-Timestamp\n   0+        0  \
    \      0    56   Egress-VLANID (Note 3)\n   0-1       0        0    57   Ingress-Filters\
    \ (Note 3)\n   0+        0        0    58   Egress-VLAN-Name (Note 3)\n   0-1\
    \       0        0    59   User-Priority-Table (Note 3)\n   0-1       0      \
    \  0    61   NAS-Port-Type (Note 3)\n   0-1       0        0    62   Port-Limit\
    \ (Note 3)\n   0-1       0        0    63   Login-LAT-Port (Note 3)\n   0+   \
    \     0        0    64   Tunnel-Type (Note 5)\n   0+        0        0    65 \
    \  Tunnel-Medium-Type (Note 5)\n   0+        0        0    66   Tunnel-Client-Endpoint\
    \ (Note 5)\n   0+        0        0    67   Tunnel-Server-Endpoint (Note 5)\n\
    \   0+        0        0    69   Tunnel-Password (Note 5)\n   0-1       0    \
    \    0    71   ARAP-Features (Note 3)\n   0-1       0        0    72   ARAP-Zone-Access\
    \ (Note 3)\n   0+        0        0    78   Configuration-Token (Note 3)\n   0+\
    \        0-1      0    79   EAP-Message (Note 2)\n   0-1       0-1      0-1  80\
    \   Message-Authenticator\n   0+        0        0    81   Tunnel-Private-Group-ID\
    \ (Note 5)\n   0+        0        0    82   Tunnel-Assignment-ID (Note 5)\n  \
    \ 0+        0        0    83   Tunnel-Preference (Note 5)\n   0-1       0    \
    \    0    85   Acct-Interim-Interval (Note 3)\n   0-1       0        0    87 \
    \  NAS-Port-Id (Note 1)\n   0-1       0        0    88   Framed-Pool (Note 3)\n\
    \   0-1       0        0    89   Chargeable-User-Identity (Note 1)\n   0+    \
    \    0        0    90   Tunnel-Client-Auth-ID (Note 5)\n   0+        0       \
    \ 0    91   Tunnel-Server-Auth-ID (Note 5)\n   0-1       0        0    92   NAS-Filter-Rule\
    \ (Note 3)\n   0         0        0    94   Originating-Line-Info\n   0-1    \
    \   0        0    95   NAS-IPv6-Address (Note 1)\n   0-1       0        0    96\
    \   Framed-Interface-Id (Notes 1, 6)\n   0+        0        0    97   Framed-IPv6-Prefix\
    \ (Notes 1, 6)\n   0+        0        0    98   Login-IPv6-Host (Note 3)\n   0+\
    \        0        0    99   Framed-IPv6-Route (Note 3)\n   Request   ACK     \
    \ NAK   #   Attribute\n   Request   ACK      NAK   #   Attribute\n   0-1     \
    \  0        0   100   Framed-IPv6-Pool (Note 3)\n   0         0        0+  101\
    \   Error-Cause\n   0+        0        0   123   Delegated-IPv6-Prefix (Note 3)\n\
    \   Request   ACK      NAK   #   Attribute\n   Disconnect Messages\n   Request\
    \   ACK      NAK   #   Attribute\n   0-1       0        0     1   User-Name (Note\
    \ 1)\n   0-1       0        0     4   NAS-IP-Address (Note 1)\n   0-1       0\
    \        0     5   NAS-Port (Note 1)\n   0         0        0     6   Service-Type\n\
    \   0         0        0     8   Framed-IP-Address (Note 1)\n   0+        0  \
    \      0    18   Reply-Message (Note 2)\n   0         0        0    24   State\n\
    \   0+        0        0    25   Class (Note 4)\n   0+        0        0    26\
    \   Vendor-Specific (Note 7)\n   0-1       0        0    30   Called-Station-Id\
    \ (Note 1)\n   0-1       0        0    31   Calling-Station-Id (Note 1)\n   0-1\
    \       0        0    32   NAS-Identifier (Note 1)\n   0+        0+       0+ \
    \  33   Proxy-State\n   0-1       0        0    44   Acct-Session-Id (Note 1)\n\
    \   0-1       0-1      0    49   Acct-Terminate-Cause\n   0-1       0        0\
    \    50   Acct-Multi-Session-Id (Note 1)\n   0-1       0-1      0-1  55   Event-Timestamp\n\
    \   0         0        0    61   NAS-Port-Type\n   0+        0-1      0    79\
    \   EAP-Message (Note 2)\n   0-1       0-1      0-1  80   Message-Authenticator\n\
    \   0-1       0        0    87   NAS-Port-Id (Note 1)\n   0-1       0        0\
    \    89   Chargeable-User-Identity (Note 1)\n   0-1       0        0    95   NAS-IPv6-Address\
    \ (Note 1)\n   0         0        0    96   Framed-Interface-Id (Note 1)\n   0\
    \         0        0    97   Framed-IPv6-Prefix (Note 1)\n   0         0     \
    \   0+  101   Error-Cause\n   Request   ACK      NAK   #   Attribute\n   The following\
    \ defines the meaning of the above table entries:\n   0    This attribute MUST\
    \ NOT be present in packet.\n   0+   Zero or more instances of this attribute\
    \ MAY be present in\n        packet.\n   0-1  Zero or one instance of this attribute\
    \ MAY be present in packet.\n   1    Exactly one instance of this attribute MUST\
    \ be present in\n        packet.\n   (Note 1) Where NAS or session identification\
    \ attributes are included\n   in Disconnect-Request or CoA-Request packets, they\
    \ are used for\n   identification purposes only.  These attributes MUST NOT be\
    \ used for\n   purposes other than identification (e.g., within CoA-Request packets\n\
    \   to request authorization changes).\n   (Note 2) The Reply-Message Attribute\
    \ is used to present a displayable\n   message to the user.  The message is only\
    \ displayed as a result of a\n   successful Disconnect-Request or CoA-Request\
    \ (where a Disconnect-ACK\n   or CoA-ACK is subsequently sent).  Where Extension\
    \ Authentication\n   Protocol (EAP) is used for authentication, an EAP-\n   Message/Notification-Request\
    \ Attribute is sent instead, and\n   Disconnect-ACK or CoA-ACK packets contain\
    \ an EAP-\n   Message/Notification-Response Attribute.\n   (Note 3) When included\
    \ within a CoA-Request, these attributes\n   represent an authorization change\
    \ request.  When one of these\n   attributes is omitted from a CoA-Request, the\
    \ NAS assumes that the\n   attribute value is to remain unchanged.  Attributes\
    \ included in a\n   CoA-Request replace all existing values of the same attribute(s).\n\
    \   (Note 4) When included within a successful Disconnect-Request (where\n   a\
    \ Disconnect-ACK is subsequently sent), the Class Attribute SHOULD be\n   sent\
    \ unmodified by the NAS to the RADIUS accounting server in the\n   Accounting\
    \ Stop packet.  If the Disconnect-Request is unsuccessful,\n   then the Class\
    \ Attribute is not processed.\n   (Note 5) When included within a CoA-Request,\
    \ these attributes\n   represent an authorization change request.  Where tunnel\
    \ attributes\n   are included within a successful CoA-Request, all existing tunnel\n\
    \   attributes are removed and replaced by the new attribute(s).\n   (Note 6)\
    \ Since the Framed-IP-Address, Framed-IPv6-Prefix, and\n   Framed-Interface-Id\
    \ attributes are used for session identification,\n   renumbering cannot be accomplished\
    \ by including values of these\n   attributes within a CoA-Request.  Instead,\
    \ a CoA-Request including a\n   Service-Type Attribute with a value of \"Authorize\
    \ Only\" is sent; new\n   values can be supplied in an Access-Accept sent in response\
    \ to the\n   ensuing Access-Request.  Note that renumbering will not be possible\n\
    \   in all situations.  For example, in order to change an IP address,\n   IPCP\
    \ or IPv6CP re-negotiation could be required, which is not\n   supported by all\
    \ PPP implementations.\n   (Note 7) Within Disconnect-Request packets, Vendor-Specific\n\
    \   Attributes (VSAs) MAY be used for session identification.  Within\n   CoA-Request\
    \ packets, VSAs MAY be used for either session\n   identification or authorization\
    \ change.  However, the same Attribute\n   MUST NOT be used for both purposes\
    \ simultaneously.\n"
- title: 4.  Diameter Considerations
  contents:
  - "4.  Diameter Considerations\n   Due to differences in handling change-of-authorization\
    \ requests in\n   RADIUS and Diameter, it may be difficult or impossible for a\n\
    \   Diameter/RADIUS gateway to successfully translate a Diameter\n   Re-Auth-Request\
    \ (RAR) to a CoA-Request and vice versa.  For example,\n   since a CoA-Request\
    \ only initiates an authorization change but does\n   not initiate re-authentication,\
    \ a RAR command containing a\n   Re-Auth-Request-Type AVP with value \"AUTHORIZE_AUTHENTICATE\"\
    \ cannot\n   be directly translated to a CoA-Request.  A Diameter/RADIUS gateway\n\
    \   receiving a CoA-Request containing authorization changes will need to\n  \
    \ translate this into two Diameter exchanges.  First, the\n   Diameter/RADIUS\
    \ gateway will issue a RAR command including a\n   Session-Id AVP and a Re-Auth-Request-Type\
    \ AVP with value \"AUTHORIZE\n   ONLY\".  Then the Diameter/RADIUS gateway will\
    \ respond to the ensuing\n   access request with a response including the authorization\
    \ attributes\n   gleaned from the CoA-Request.  To enable translation, the CoA-Request\n\
    \   SHOULD include a Acct-Session-Id Attribute.  If the Diameter client\n   uses\
    \ the same Session-Id for both authorization and accounting, then\n   the Diameter/RADIUS\
    \ gateway can copy the contents of the Acct-\n   Session-Id Attribute into the\
    \ Session-Id AVP;  otherwise, it will\n   need to map the Acct-Session-Id value\
    \ to an equivalent Session-Id for\n   use within a RAR command.\n   Where an Acct-Session-Id\
    \ Attribute is not present in a CoA-Request or\n   Disconnect-Request, a Diameter/RADIUS\
    \ gateway will either need to\n   determine the appropriate Acct-Session-Id or,\
    \ if it cannot do so, it\n   can send a CoA-NAK or Disconnect-NAK in reply, possibly\
    \ including an\n   Error-Cause Attribute with a value of 508 (Multiple Session\
    \ Selection\n   Unsupported).\n   To simplify translation between RADIUS and Diameter,\
    \ Dynamic\n   Authorization Clients can include a Service-Type Attribute with\
    \ value\n   \"Authorize Only\" within a CoA-Request, as described in Section 3.2.\n\
    \   A Diameter/RADIUS gateway receiving a CoA-Request containing a\n   Service-Type\
    \ Attribute with a value \"Authorize Only\" translates this\n   to a RAR with\
    \ Re-Auth-Request-Type AVP with value \"AUTHORIZE ONLY\".\n   The received RAA\
    \ is then translated to a CoA-NAK with a Service-Type\n   Attribute with value\
    \ \"Authorize Only\".  If the Result-Code AVP in the\n   RAA has a value in the\
    \ success category, then an Error-Cause\n   Attribute with value \"Request Initiated\"\
    \ is included in the CoA-NAK.\n   If the Result-Code AVP in the RAA has a value\
    \ indicating a Protocol\n   Error or a Transient or Permanent Failure, then an\
    \ alternate Error-\n   Cause Attribute is returned as suggested below.\n   Within\
    \ Diameter, a server can request that a session be aborted by\n   sending an Abort-Session-Request\
    \ (ASR), identifying the session to be\n   terminated using Session-ID and User-Name\
    \ AVPs.  The ASR command is\n   translated to a Disconnect-Request containing\
    \ Acct-Session-Id and\n   User-Name attributes.  If the Diameter client utilizes\
    \ the same\n   Session-Id in both authorization and accounting, then the value\
    \ of\n   the Session-ID AVP may be placed in the Acct-Session-Id Attribute;\n\
    \   otherwise the value of the Session-ID AVP will need to be mapped to\n   an\
    \ appropriate Acct-Session-Id Attribute.  To enable translation of a\n   Disconnect-Request\
    \ to an ASR, an Acct-Session-Id Attribute SHOULD be\n   present.\n   If the Diameter\
    \ client utilizes the same Session-Id in both\n   authorization and accounting,\
    \ then the value of the Acct-Session-Id\n   Attribute may be placed into the Session-ID\
    \ AVP within the ASR;\n   otherwise the value of the Acct-Session-Id Attribute\
    \ will need to be\n   mapped to an appropriate Session-ID AVP.\n   An Abort-Session-Answer\
    \ (ASA) command is sent in response to an ASR\n   in order to indicate the disposition\
    \ of the request.  A\n   Diameter/RADIUS gateway receiving a Disconnect-ACK translates\
    \ this to\n   an ASA command with a Result-Code AVP of \"DIAMETER_SUCCESS\". \
    \ A\n   Disconnect-NAK received from the NAS is translated to an ASA command\n\
    \   with a Result-Code AVP that depends on the value of the Error-Cause\n   Attribute.\
    \  Suggested translations between Error-Cause Attribute\n   values and Result-Code\
    \ AVP values are included below:\n    #    Error-Cause Attribute Value   Result-Code\
    \ AVP\n   ---   ---------------------------  ------------------------\n   201\
    \   Residual Session Context     DIAMETER_SUCCESS\n         Removed\n   202  \
    \ Invalid EAP Packet           DIAMETER_LIMITED_SUCCESS\n         (Ignored)\n\
    \   401   Unsupported Attribute        DIAMETER_AVP_UNSUPPORTED\n   402   Missing\
    \ Attribute            DIAMETER_MISSING_AVP\n   403   NAS Identification     \
    \      DIAMETER_REALM_NOT_SERVED\n         Mismatch\n   404   Invalid Request\
    \              DIAMETER_UNABLE_TO_COMPLY\n   405   Unsupported Service       \
    \   DIAMETER_COMMAND_UNSUPPORTED\n   406   Unsupported Extension        DIAMETER_APPLICATION_UNSUPPORTED\n\
    \   407   Invalid Attribute Value      DIAMETER_INVALID_AVP_VALUE\n   501   Administratively\
    \             DIAMETER_AUTHORIZATION_REJECTED\n         Prohibited\n   502   Request\
    \ Not Routable (Proxy) DIAMETER_UNABLE_TO_DELIVER\n   503   Session Context Not\
    \ Found    DIAMETER_UNKNOWN_SESSION_ID\n   504   Session Context Not         \
    \ DIAMETER_AUTHORIZATION_REJECTED\n         Removable\n   505   Other Proxy Processing\
    \       DIAMETER_UNABLE_TO_COMPLY\n         Error\n   506   Resources Unavailable\
    \        DIAMETER_RESOURCES_EXCEEDED\n   507   Request Initiated            DIAMETER_SUCCESS\n\
    \   Since both the ASR/ASA and Disconnect-Request/Disconnect-\n   NAK/Disconnect-ACK\
    \ exchanges involve just a request and response,\n   inclusion of an \"Authorize\
    \ Only\" Service-Type within a Disconnect-\n   Request is not needed to assist\
    \ in Diameter/RADIUS translation, and\n   may make translation more difficult.\
    \  As a result, as noted in\n   Section 3.2, the Service-Type Attribute MUST NOT\
    \ be used within a\n   Disconnect-Request.\n"
- title: 5.  IANA Considerations
  contents:
  - "5.  IANA Considerations\n   This document uses the RADIUS [RFC2865] namespace;\
    \ see\n   <http://www.iana.org/assignments/radius-types>.  In addition to the\n\
    \   allocations already made in [RFC3575] and [RFC3576], this\n   specification\
    \ allocates additional values of the Error-Cause\n   Attribute (101):\n    # \
    \   Value\n   ---   -----\n   407   Invalid Attribute Value\n   508   Multiple\
    \ Session Selection Unsupported\n"
- title: 6.  Security Considerations
  contents:
  - '6.  Security Considerations

    '
- title: 6.1.  Authorization Issues
  contents:
  - "6.1.  Authorization Issues\n   Where a NAS is shared by multiple providers, it\
    \ is undesirable for\n   one provider to be able to send Disconnect-Requests or\
    \ CoA-Requests\n   affecting the sessions of another provider.\n   A Dynamic Authorization\
    \ Server MUST silently discard Disconnect-\n   Request or CoA-Request packets\
    \ from untrusted sources.  In situations\n   where the Dynamic Authorization Client\
    \ is co-resident with a RADIUS\n   authentication or accounting server, a proxy\
    \ MAY perform a \"reverse\n   path forwarding\" (RPF) check to verify that a Disconnect-Request\
    \ or\n   CoA-Request originates from an authorized Dynamic Authorization\n   Client.\
    \  In addition, it SHOULD be possible to explicitly authorize\n   additional sources\
    \ of Disconnect-Request or CoA-Request packets\n   relating to certain classes\
    \ of sessions.  For example, a particular\n   source can be explicitly authorized\
    \ to send CoA-Request packets\n   relating to users within a set of realms.\n\
    \   To perform the RPF check, the Dynamic Authorization Server uses the\n   session\
    \ identification attributes included in Disconnect-Request or\n   CoA-Request\
    \ packets, in order to determine the RADIUS server(s) to\n   which an equivalent\
    \ Access-Request could be routed.  If the source\n   address of the Disconnect-Request\
    \ or CoA-Request is within this set,\n   then the CoA-Request or Disconnect-Request\
    \ is forwarded; otherwise it\n   MUST be silently discarded.\n   Typically, the\
    \ Dynamic Authorization Server will extract the realm\n   from the Network Access\
    \ Identifier [RFC4282] included within the\n   User-Name or Chargeable-User-Identity\
    \ Attribute, and determine the\n   corresponding RADIUS servers in the realm routing\
    \ tables.  If the\n   Dynamic Authorization Server maintains long-term session\
    \ state, it\n   MAY perform the authorization check based on the session\n   identification\
    \ attributes in the CoA-Request.  The session\n   identification attributes can\
    \ be used to tie a session to a\n   particular proxy or set of proxies, as with\
    \ the NAI realm.\n   Where no proxy is present, the RPF check can only be performed\
    \ by the\n   NAS if it maintains its own a realm routing table.  If the NAS does\n\
    \   not maintain a realm routing table (e.g., it selects forwarding\n   proxies\
    \ based on primary/secondary configuration and/or liveness\n   checks), then an\
    \ RPF check cannot be performed.\n   Since authorization to send a Disconnect-Request\
    \ or CoA-Request is\n   determined based on the source address and the corresponding\
    \ shared\n   secret, the Dynamic Authorization Server SHOULD configure a different\n\
    \   shared secret for each Dynamic Authorization Client.\n"
- title: 6.2.  IPsec Usage Guidelines
  contents:
  - "6.2.  IPsec Usage Guidelines\n   In addition to security vulnerabilities unique\
    \ to Disconnect or CoA\n   packets, the protocol exchanges described in this document\
    \ are\n   susceptible to the same vulnerabilities as RADIUS [RFC2865].  It is\n\
    \   RECOMMENDED that IPsec be employed to afford better security,\n   utilizing\
    \ the profile described in [RFC3579], Section 4.2.\n   For Dynamic Authorization\
    \ Servers implementing this specification,\n   the IPsec policy would be \"Require\
    \ IPsec, from any to me, destination\n   port UDP 3799\".  This causes the Dynamic\
    \ Authorization Server to\n   require use of IPsec.  If some Dynamic Authorization\
    \ Clients do not\n   support IPsec, then a more granular policy will be required:\
    \ \"Require\n   IPsec, from IPsec-Capable-DAC to me\".\n   For Dynamic Authorization\
    \ Clients implementing this specification,\n   the IPsec policy would be \"Initiate\
    \ IPsec, from me to any,\n   destination port UDP 3799\".  This causes the Dynamic\
    \ Authorization\n   Client to initiate IPsec when sending Dynamic Authorization\
    \ traffic\n   to any Dynamic Authorization Server.  If some Dynamic Authorization\n\
    \   Servers contacted by the Dynamic Authorization Client do not support\n   IPsec,\
    \ then a more granular policy will be required, such as\n   \"Initiate IPsec,\
    \ from me to IPsec-Capable-DAS, destination port UDP\n   3799\".\n"
- title: 6.3.  Replay Protection
  contents:
  - "6.3.  Replay Protection\n   Where IPsec replay protection is not used, an Event-Timestamp\
    \ (55)\n   [RFC2869] Attribute SHOULD be included within CoA-Request and\n   Disconnect-Request\
    \ packets, and MAY be included within CoA-ACK, CoA-\n   NAK, Disconnect-ACK, and\
    \ Disconnect-NAK packets.\n   When the Event-Timestamp Attribute is present, both\
    \ the Dynamic\n   Authorization Server and the Dynamic Authorization Client MUST\
    \ check\n   that the Event-Timestamp Attribute is current within an acceptable\n\
    \   time window.  If the Event-Timestamp Attribute is not current, then\n   the\
    \ packet MUST be silently discarded.  This implies the need for\n   loose time\
    \ synchronization within the network, which can be achieved\n   by a variety of\
    \ means, including Simple Network Time Protocol (SNTP),\n   as described in [RFC4330].\
    \  Implementations SHOULD be configurable to\n   discard CoA-Request or Disconnect-Request\
    \ packets not containing an\n   Event-Timestamp Attribute.\n   If the Event-Timestamp\
    \ Attribute is included, it represents the time\n   at which the original packet\
    \ was sent, and therefore it SHOULD NOT be\n   updated when the packet is retransmitted.\
    \  If the Event-Timestamp\n   Attribute is not updated, this implies that the\
    \ Identifier is not\n   changed in retransmitted packets.  As a result, the ability\
    \ to detect\n   replay within the time window is dependent on support for duplicate\n\
    \   detection within that same window.  As noted in Section 2.3,\n   duplicate\
    \ detection is REQUIRED for Dynamic Authorization Servers\n   implementing this\
    \ specification.\n   The time window used for duplicate detection MUST be the\
    \ same as the\n   window used to detect a stale Event-Timestamp Attribute.  Since\
    \ the\n   RADIUS Identifier cannot be repeated within the selected time window,\n\
    \   no more than 256 Requests can be accepted within the time window.  As\n  \
    \ a result, the chosen time window will depend on the expected maximum\n   volume\
    \ of CoA/Disconnect-Requests, so that unnecessary discards can\n   be avoided.\
    \  A default time window of 300 seconds should be adequate\n   in many circumstances.\n"
- title: 7.  Example Traces
  contents:
  - "7.  Example Traces\n   Disconnect Request with User-Name:\n       0: xxxx xxxx\
    \ xxxx xxxx xxxx 2801 001c 1b23    .B.....$.-(....#\n      16: 624c 3543 ceba\
    \ 55f1 be55 a714 ca5e 0108    bL5C..U..U...^..\n      32: 6d63 6869 6261\n   Disconnect\
    \ Request with Acct-Session-ID:\n       0: xxxx xxxx xxxx xxxx xxxx 2801 001e\
    \ ad0d    .B..... ~.(.....\n      16: 8e53 55b6 bd02 a0cb ace6 4e38 77bd 2c0a\
    \    .SU.......N8w.,.\n      32: 3930 3233 3435 3637                        90234567\n\
    \   Disconnect Request with Framed-IP-Address:\n       0: xxxx xxxx xxxx xxxx\
    \ xxxx 2801 001a 0bda    .B.....\"2.(.....\n      16: 33fe 765b 05f0 fd9c c32a\
    \ 2f6b 5182 0806    3.v[.....*/kQ...\n      32: 0a00 0203\n"
- title: 8.  References
  contents:
  - '8.  References

    '
- title: 8.1.  Normative References
  contents:
  - "8.1.  Normative References\n   [RFC1321]   Rivest, R., \"The MD5 Message-Digest\
    \ Algorithm\", RFC 1321,\n               April 1992.\n   [RFC2119]   Bradner,\
    \ S., \"Key words for use in RFCs to Indicate\n               Requirement Levels\"\
    , RFC 2119, March 1997.\n   [RFC2865]   Rigney, C., Rubens, A., Simpson, W. and\
    \ S. Willens,\n               \"Remote Authentication Dial In User Service (RADIUS)\"\
    ,\n               RFC 2865, June 2000.\n   [RFC2866]   Rigney, C., \"RADIUS Accounting\"\
    , RFC 2866, June 2000.\n   [RFC2869]   Rigney, C., Willats W. and P. Calhoun,\
    \ \"RADIUS\n               Extensions\", RFC 2869, June 2000.\n   [RFC3162]  \
    \ Aboba, B., Zorn, G. and D. Mitton, \"RADIUS and IPv6\", RFC\n              \
    \ 3162, August 2001.\n   [RFC3575]   Aboba, B., \"IANA Considerations for RADIUS\"\
    , RFC 3575,\n               July 2003.\n   [RFC3579]   Aboba, B. and P. Calhoun,\
    \ \"RADIUS Support for Extensible\n               Authentication Protocol (EAP)\"\
    , RFC 3579, September 2003.\n   [RFC4282]   Aboba, B., Beadles, M., Arkko, J.\
    \ and P. Eronen,  \"The\n               Network Access Identifier\", RFC 4282,\
    \ December 2005.\n"
- title: 8.2.  Informative References
  contents:
  - "8.2.  Informative References\n   [MD5Attack] Dobbertin, H., \"The Status of MD5\
    \ After a Recent Attack\",\n               CryptoBytes Vol.2 No.2, Summer 1996.\n\
    \   [RFC2868]   Zorn, G., Leifer, D., Rubens, A., Shriver, J., Holdrege,\n   \
    \            M.  and I. Goyret, \"RADIUS Attributes for Tunnel Protocol\n    \
    \           Support\", RFC 2868, June 2000.\n   [RFC3539]   Aboba,  B. and J.\
    \ Wood, \"Authentication, Authorization\n               and Accounting Transport\
    \ Profile\", RFC 3539, June 2003.\n   [RFC3576]   Chiba, M., Dommety, G., Eklund,\
    \ M., Mitton, D. and B.\n               Aboba, \"Dynamic Authorization Extensions\
    \ to Remote\n               Authentication Dial In User Service (RADIUS)\", RFC\
    \ 3576,\n               July 2003.\n   [RFC3588]   Calhoun, P., Loughney, J.,\
    \  Guttman, E., Zorn, G. and J.\n               Arkko, \"Diameter Base Protocol\"\
    , RFC 3588, September\n               2003.\n   [RFC4330]   Mills, D., \"Simple\
    \ Network Time Protocol (SNTP) Version 4\n               for IPv4, IPv6 and OSI\"\
    , RFC 4330, January 2006.\n   [RFC4372]   Adrangi, F., Lior, A., Korhonen, J.\
    \ and J. Loughney,\n               \"Chargeable User Identity\", RFC 4372, January\
    \ 2006.\n   [RFC4675]   Congdon, P., Sanchez, M. and B. Aboba, \"RADIUS Attributes\n\
    \               for Virtual LAN and Priority Support\", RFC 4675,\n          \
    \     September 2006.\n   [RFC4818]   Salowey, J. and R. Droms, \"RADIUS Delegated-IPv6-Prefix\n\
    \               Attribute\", RFC 4818, April 2007.\n   [RFC4849]   Congdon, P.,\
    \ Sanchez, M. and B. Aboba, \"RADIUS Filter\n               Rule Attribute\",\
    \ RFC 4849, April 2007.\n"
- title: 9.  Acknowledgments
  contents:
  - "9.  Acknowledgments\n   This protocol was first developed and distributed by\
    \ Ascend\n   Communications.  Example code was distributed in their free server\n\
    \   kit.\n   The authors would like to acknowledge valuable suggestions and\n\
    \   feedback from Avi Lior, Randy Bush, Steve Bellovin, Glen Zorn, Mark\n   Jones,\
    \ Claudio Lapidus, Anurag Batta, Kuntal Chowdhury, Tim Moore,\n   Russ Housley,\
    \ Joe Salowey, Alan DeKok, and David Nelson.\n"
- title: Appendix A.  Changes from RFC 3576
  contents:
  - "Appendix A.  Changes from RFC 3576\n   This Appendix lists the major changes\
    \ between [RFC3576] and this\n   document.  Minor changes, including style, grammar,\
    \ spelling, and\n   editorial changes, are not mentioned here.\n   o The term\
    \ \"Dynamic Authorization Client\" is used instead of RADIUS\n   server where\
    \ it applies to the originator of CoA-Request and\n   Disconnect-Request packets.\
    \  The term \"Dynamic Authorization Server\"\n   is used instead of NAS where\
    \ it applies to the receiver of CoA-\n   Request and Disconnect-Request packets.\
    \  Definitions of these terms\n   have been added (Section 1.3).\n   o  Added\
    \ requirement for duplicate detection on the Dynamic\n      Authorization Server\
    \ (Section 2.3).\n   o  Clarified expected behavior when session identification\
    \ attributes\n      match more than one session (Sections 2.3, 3, 3.5, 4).\n \
    \  o  Added Chargeable-User-Identity as a session identification\n      attribute.\
    \  Removed NAS-Port-Type as a session identification\n      attribute (Section\
    \ 3).\n   o  Added recommendation that an Acct-Session-Id or Acct-Multi-\n   \
    \   Session-Id Attribute be included in an Access-Request (Section 3).\n   o \
    \ Added discussion of scenarios in which the \"Dynamic Authorization\n      Client\"\
    \ and RADIUS server are not co-located (Section 3).\n   o  Added details relating\
    \ to handling of the Proxy-State Attribute\n      (Section 3.1).\n   o  Added\
    \ clarification that support for a Service-Type Attribute with\n      value \"\
    Authorize Only\" is optional on both the NAS and Dynamic\n      Authorization\
    \ Client (Section 3.2).  Use of the Service-Type\n      Attribute within a Disconnect-Request\
    \ is prohibited (Sections 3.2,\n      3.6).\n   o  Added requirement for inclusion\
    \ of the State Attribute in CoA-\n      Request packets including a Service-Type\
    \ Attribute with a value of\n      \"Authorize Only\" (Section 3.3).\n   o  Added\
    \ clarification on the calculation of the Message-\n      Authenticator Attribute\
    \ (Section 3.4).\n   o  Additional Error-Cause Attribute values are allocated\
    \ for Invalid\n      Attribute Value (407) and Multiple Session Selection\n  \
    \    Identification (508) (Sections 3.5, 4).\n   o  Updated the CoA-Request Attribute\
    \ Table to include Filter-Rule,\n      Delegated-IPv6-Prefix, Egress-VLANID, Ingress-Filters,\
    \ Egress-\n      VLAN-Name, and User-Priority attributes (Section 3.6).\n   o\
    \  Added the Chargeable-User-Identity Attribute to both the CoA-\n      Request\
    \ and Disconnect-Request Attribute table (Section 3.6).\n   o  Use of Vendor-Specific\
    \ Attributes (VSAs) for session\n      identification and authorization change\
    \ has been clarified\n      (Section 3.6).\n   o  Added Note 6 on the use of the\
    \ CoA-Request for renumbering, and\n      Note 7 on the use of Vendor-Specific\
    \ attributes (Section 3.6).\n   o  Added Diameter Considerations (Section 4).\n\
    \   o  Event-Timestamp Attribute should not be recalculated on\n      retransmission.\
    \  The implications for replay and duplicate\n      detection are discussed (Section\
    \ 6.3).\n   o  Operation of the Reverse Path Forwarding (RPF) check has been\n\
    \      clarified.  Use of the RPF check is optional rather than\n      recommended\
    \ by default (Section 6.1).\n   o  Text on impersonation (included in [RFC3579],\
    \ Section 4.3.7) and\n      IPsec operation (included in [RFC3579], Section 4.2)\
    \ has been\n      removed, and is now referenced.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Murtaza Chiba\n   Cisco Systems, Inc.\n   170 West Tasman\
    \ Dr.\n   San Jose CA, 95134\n   EMail: mchiba@cisco.com\n   Phone: +1 408 525\
    \ 7198\n   Gopal Dommety\n   Cisco Systems, Inc.\n   170 West Tasman Dr.\n   San\
    \ Jose, CA 95134\n   EMail: gdommety@cisco.com\n   Phone: +1 408 525 1404\n  \
    \ Mark Eklund\n   Cisco Systems, Inc.\n   170 West Tasman Dr.\n   San Jose, CA\
    \ 95134\n   EMail: meklund@cisco.com\n   Phone: +1 865 671 6255\n   David Mitton\n\
    \   RSA, Security Division of EMC\n   174 Middlesex Turnpike\n   Bedford, MA 01730\n\
    \   EMail: david@mitton.com\n   Bernard Aboba\n   Microsoft Corporation\n   One\
    \ Microsoft Way\n   Redmond, WA 98052\n   EMail: bernarda@microsoft.com\n   Phone:\
    \ +1 425 706 6605\n   Fax:   +1 425 936 7329\n"
- title: Full Copyright Statement
  contents:
  - "Full Copyright Statement\n   Copyright (C) The IETF Trust (2008).\n   This document\
    \ is subject to the rights, licenses and restrictions\n   contained in BCP 78,\
    \ and except as set forth therein, the authors\n   retain all their rights.\n\
    \   This document and the information contained herein are provided on an\n  \
    \ \"AS IS\" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS\n  \
    \ OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND\n   THE\
    \ INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS\n   OR IMPLIED,\
    \ INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF\n   THE INFORMATION\
    \ HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED\n   WARRANTIES OF MERCHANTABILITY\
    \ OR FITNESS FOR A PARTICULAR PURPOSE.\n"
- title: Intellectual Property
  contents:
  - "Intellectual Property\n   The IETF takes no position regarding the validity or\
    \ scope of any\n   Intellectual Property Rights or other rights that might be\
    \ claimed to\n   pertain to the implementation or use of the technology described\
    \ in\n   this document or the extent to which any license under such rights\n\
    \   might or might not be available; nor does it represent that it has\n   made\
    \ any independent effort to identify any such rights.  Information\n   on the\
    \ procedures with respect to rights in RFC documents can be\n   found in BCP 78\
    \ and BCP 79.\n   Copies of IPR disclosures made to the IETF Secretariat and any\n\
    \   assurances of licenses to be made available, or the result of an\n   attempt\
    \ made to obtain a general license or permission for the use of\n   such proprietary\
    \ rights by implementers or users of this\n   specification can be obtained from\
    \ the IETF on-line IPR repository at\n   http://www.ietf.org/ipr.\n   The IETF\
    \ invites any interested party to bring to its attention any\n   copyrights, patents\
    \ or patent applications, or other proprietary\n   rights that may cover technology\
    \ that may be required to implement\n   this standard.  Please address the information\
    \ to the IETF at\n   ietf-ipr@ietf.org.\n"
