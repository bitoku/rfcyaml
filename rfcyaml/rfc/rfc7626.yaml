- title: __initial_text__
  contents:
  - '                       DNS Privacy Considerations

    '
- title: Abstract
  contents:
  - "Abstract\n   This document describes the privacy issues associated with the use\
    \ of\n   the DNS by Internet users.  It is intended to be an analysis of the\n\
    \   present situation and does not prescribe solutions.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This document is a product\
    \ of the Internet Engineering Task Force\n   (IETF).  It represents the consensus\
    \ of the IETF community.  It has\n   received public review and has been approved\
    \ for publication by the\n   Internet Engineering Steering Group (IESG).  Not\
    \ all documents\n   approved by the IESG are a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7626.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2015 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.  Code Components\
    \ extracted from this document must\n   include Simplified BSD License text as\
    \ described in Section 4.e of\n   the Trust Legal Provisions and are provided\
    \ without warranty as\n   described in the Simplified BSD License.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   2\n   2.  Risks . . . . . . . . . . . . . . . . . . . . . . . .\
    \ . . . .   4\n     2.1.  The Alleged Public Nature of DNS Data . . . . . . .\
    \ . . .   4\n     2.2.  Data in the DNS Request . . . . . . . . . . . . . . .\
    \ . .   5\n     2.3.  Cache Snooping  . . . . . . . . . . . . . . . . . . . .\
    \ .   6\n     2.4.  On the Wire . . . . . . . . . . . . . . . . . . . . . . .\
    \   7\n     2.5.  In the Servers  . . . . . . . . . . . . . . . . . . . . .  \
    \ 8\n       2.5.1.  In the Recursive Resolvers  . . . . . . . . . . . . .   8\n\
    \       2.5.2.  In the Authoritative Name Servers . . . . . . . . . .   9\n  \
    \     2.5.3.  Rogue Servers . . . . . . . . . . . . . . . . . . . .  10\n    \
    \ 2.6.  Re-identification and Other Inferences  . . . . . . . . .  11\n     2.7.\
    \  More Information  . . . . . . . . . . . . . . . . . . . .  11\n   3.  Actual\
    \ \"Attacks\"  . . . . . . . . . . . . . . . . . . . . . .  11\n   4.  Legalities\
    \  . . . . . . . . . . . . . . . . . . . . . . . . .  12\n   5.  Security Considerations\
    \ . . . . . . . . . . . . . . . . . . .  12\n   6.  References  . . . . . . .\
    \ . . . . . . . . . . . . . . . . . .  12\n     6.1.  Normative References  .\
    \ . . . . . . . . . . . . . . . . .  12\n     6.2.  Informative References  .\
    \ . . . . . . . . . . . . . . . .  13\n   Acknowledgments . . . . . . . . . .\
    \ . . . . . . . . . . . . . . .  17\n   Author's Address  . . . . . . . . . .\
    \ . . . . . . . . . . . . . .  17\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   This document is an analysis of the DNS privacy issues,\
    \ in the spirit\n   of Section 8 of [RFC6973].\n   The Domain Name System is specified\
    \ in [RFC1034], [RFC1035], and many\n   later RFCs, which have never been consolidated.\
    \  It is one of the\n   most important infrastructure components of the Internet\
    \ and often\n   ignored or misunderstood by Internet users (and even by many\n\
    \   professionals).  Almost every activity on the Internet starts with a\n   DNS\
    \ query (and often several).  Its use has many privacy implications\n   and this\
    \ is an attempt at a comprehensive and accurate list.\n   Let us begin with a\
    \ simplified reminder of how the DNS works.  (See\n   also [DNS-TERMS].)  A client,\
    \ the stub resolver, issues a DNS query\n   to a server, called the recursive\
    \ resolver (also called caching\n   resolver or full resolver or recursive name\
    \ server).  Let's use the\n   query \"What are the AAAA records for www.example.com?\"\
    \ as an example.\n   AAAA is the QTYPE (Query Type), and www.example.com is the\
    \ QNAME\n   (Query Name).  (The description that follows assumes a cold cache,\n\
    \   for instance, because the server just started.)  The recursive\n   resolver\
    \ will first query the root name servers.  In most cases, the\n   root name servers\
    \ will send a referral.  In this example, the\n   referral will be to the .com\
    \ name servers.  The resolver repeats the\n   query to one of the .com name servers.\
    \  The .com name servers, in\n   turn, will refer to the example.com name servers.\
    \  The example.com\n   name server will then return the answer.  The root name\
    \ servers, the\n   name servers of .com, and the name servers of example.com are\
    \ called\n   authoritative name servers.  It is important, when analyzing the\n\
    \   privacy issues, to remember that the question asked to all these name\n  \
    \ servers is always the original question, not a derived question.  The\n   question\
    \ sent to the root name servers is \"What are the AAAA records\n   for www.example.com?\"\
    , not \"What are the name servers of .com?\".  By\n   repeating the full question,\
    \ instead of just the relevant part of the\n   question to the next in line, the\
    \ DNS provides more information than\n   necessary to the name server.\n   Because\
    \ DNS relies on caching heavily, the algorithm described just\n   above is actually\
    \ a bit more complicated, and not all questions are\n   sent to the authoritative\
    \ name servers.  If a few seconds later the\n   stub resolver asks the recursive\
    \ resolver, \"What are the SRV records\n   of _xmpp-server._tcp.example.com?\"\
    , the recursive resolver will\n   remember that it knows the name servers of example.com\
    \ and will just\n   query them, bypassing the root and .com.  Because there is\
    \ typically\n   no caching in the stub resolver, the recursive resolver, unlike\
    \ the\n   authoritative servers, sees all the DNS traffic.  (Applications, like\n\
    \   web browsers, may have some form of caching that does not follow DNS\n   rules,\
    \ for instance, because it may ignore the TTL.  So, the\n   recursive resolver\
    \ does not see all the name resolution activity.)\n   It should be noted that\
    \ DNS recursive resolvers sometimes forward\n   requests to other recursive resolvers,\
    \ typically bigger machines,\n   with a larger and more shared cache (and the\
    \ query hierarchy can be\n   even deeper, with more than two levels of recursive\
    \ resolvers).  From\n   the point of view of privacy, these forwarders are like\
    \ resolvers,\n   except that they do not see all of the requests being made (due\
    \ to\n   caching in the first resolver).\n   Almost all this DNS traffic is currently\
    \ sent in clear (unencrypted).\n   There are a few cases where there is some channel\
    \ encryption, for\n   instance, in an IPsec VPN, at least between the stub resolver\
    \ and the\n   resolver.\n   Today, almost all DNS queries are sent over UDP [thomas-ditl-tcp].\n\
    \   This has practical consequences when considering encryption of the\n   traffic\
    \ as a possible privacy technique.  Some encryption solutions\n   are only designed\
    \ for TCP, not UDP.\n   Another important point to keep in mind when analyzing\
    \ the privacy\n   issues of DNS is the fact that DNS requests received by a server\
    \ are\n   triggered by different reasons.  Let's assume an eavesdropper wants\n\
    \   to know which web page is viewed by a user.  For a typical web page,\n   there\
    \ are three sorts of DNS requests being issued:\n      Primary request: this is\
    \ the domain name in the URL that the user\n      typed, selected from a bookmark,\
    \ or chose by clicking on an\n      hyperlink.  Presumably, this is what is of\
    \ interest for the\n      eavesdropper.\n      Secondary requests: these are the\
    \ additional requests performed by\n      the user agent (here, the web browser)\
    \ without any direct\n      involvement or knowledge of the user.  For the Web,\
    \ they are\n      triggered by embedded content, Cascading Style Sheets (CSS),\n\
    \      JavaScript code, embedded images, etc.  In some cases, there can\n    \
    \  be dozens of domain names in different contexts on a single web\n      page.\n\
    \      Tertiary requests: these are the additional requests performed by\n   \
    \   the DNS system itself.  For instance, if the answer to a query is\n      a\
    \ referral to a set of name servers, and the glue records are not\n      returned,\
    \ the resolver will have to do additional requests to turn\n      the name servers'\
    \ names into IP addresses.  Similarly, even if\n      glue records are returned,\
    \ a careful recursive server will do\n      tertiary requests to verify the IP\
    \ addresses of those records.\n   It can be noted also that, in the case of a\
    \ typical web browser, more\n   DNS requests than strictly necessary are sent,\
    \ for instance, to\n   prefetch resources that the user may query later or when\n\
    \   autocompleting the URL in the address bar.  Both are a big privacy\n   concern\
    \ since they may leak information even about non-explicit\n   actions.  For instance,\
    \ just reading a local HTML page, even without\n   selecting the hyperlinks, may\
    \ trigger DNS requests.\n   For privacy-related terms, we will use the terminology\
    \ from\n   [RFC6973].\n"
- title: 2.  Risks
  contents:
  - "2.  Risks\n   This document focuses mostly on the study of privacy risks for\
    \ the\n   end user (the one performing DNS requests).  We consider the risks of\n\
    \   pervasive surveillance [RFC7258] as well as risks coming from a more\n   focused\
    \ surveillance.  Privacy risks for the holder of a zone (the\n   risk that someone\
    \ gets the data) are discussed in [RFC5936] and\n   [RFC5155].  Non-privacy risks\
    \ (such as cache poisoning) are out of\n   scope.\n"
- title: 2.1.  The Alleged Public Nature of DNS Data
  contents:
  - "2.1.  The Alleged Public Nature of DNS Data\n   It has long been claimed that\
    \ \"the data in the DNS is public\".  While\n   this sentence makes sense for\
    \ an Internet-wide lookup system, there\n   are multiple facets to the data and\
    \ metadata involved that deserve a\n   more detailed look.  First, access control\
    \ lists and private\n   namespaces notwithstanding, the DNS operates under the\
    \ assumption\n   that public-facing authoritative name servers will respond to\
    \ \"usual\"\n   DNS queries for any zone they are authoritative for without further\n\
    \   authentication or authorization of the client (resolver).  Due to the\n  \
    \ lack of search capabilities, only a given QNAME will reveal the\n   resource\
    \ records associated with that name (or that name's non-\n   existence).  In other\
    \ words: one needs to know what to ask for, in\n   order to receive a response.\
    \  The zone transfer QTYPE [RFC5936] is\n   often blocked or restricted to authenticated/authorized\
    \ access to\n   enforce this difference (and maybe for other reasons).\n   Another\
    \ differentiation to be considered is between the DNS data\n   itself and a particular\
    \ transaction (i.e., a DNS name lookup).  DNS\n   data and the results of a DNS\
    \ query are public, within the boundaries\n   described above, and may not have\
    \ any confidentiality requirements.\n   However, the same is not true of a single\
    \ transaction or a sequence\n   of transactions; that transaction is not / should\
    \ not be public.  A\n   typical example from outside the DNS world is: the web\
    \ site of\n   Alcoholics Anonymous is public; the fact that you visit it should\
    \ not\n   be.\n"
- title: 2.2.  Data in the DNS Request
  contents:
  - "2.2.  Data in the DNS Request\n   The DNS request includes many fields, but two\
    \ of them seem\n   particularly relevant for the privacy issues: the QNAME and\
    \ the\n   source IP address. \"source IP address\" is used in a loose sense of\n\
    \   \"source IP address + maybe source port\", because the port is also in\n \
    \  the request and can be used to differentiate between several users\n   sharing\
    \ an IP address (behind a Carrier-Grade NAT (CGN), for instance\n   [RFC6269]).\n\
    \   The QNAME is the full name sent by the user.  It gives information\n   about\
    \ what the user does (\"What are the MX records of example.net?\"\n   means he\
    \ probably wants to send email to someone at example.net,\n   which may be a domain\
    \ used by only a few persons and is therefore\n   very revealing about communication\
    \ relationships).  Some QNAMEs are\n   more sensitive than others.  For instance,\
    \ querying the A record of a\n   well-known web statistics domain reveals very\
    \ little (everybody\n   visits web sites that use this analytics service), but\
    \ querying the A\n   record of www.verybad.example where verybad.example is the\
    \ domain of\n   an organization that some people find offensive or objectionable\
    \ may\n   create more problems for the user.  Also, sometimes, the QNAME embeds\n\
    \   the software one uses, which could be a privacy issue.  For instance,\n  \
    \ _ldap._tcp.Default-First-Site-Name._sites.gc._msdcs.example.org.\n   There are\
    \ also some BitTorrent clients that query an SRV record for\n   _bittorrent-tracker._tcp.domain.example.\n\
    \   Another important thing about the privacy of the QNAME is the future\n   usages.\
    \  Today, the lack of privacy is an obstacle to putting\n   potentially sensitive\
    \ or personally identifiable data in the DNS.  At\n   the moment, your DNS traffic\
    \ might reveal that you are doing email\n   but not with whom.  If your Mail User\
    \ Agent (MUA) starts looking up\n   Pretty Good Privacy (PGP) keys in the DNS\
    \ [DANE-OPENPGPKEY], then\n   privacy becomes a lot more important.  And email\
    \ is just an example;\n   there would be other really interesting uses for a more\
    \ privacy-\n   friendly DNS.\n   For the communication between the stub resolver\
    \ and the recursive\n   resolver, the source IP address is the address of the\
    \ user's machine.\n   Therefore, all the issues and warnings about collection\
    \ of IP\n   addresses apply here.  For the communication between the recursive\n\
    \   resolver and the authoritative name servers, the source IP address\n   has\
    \ a different meaning; it does not have the same status as the\n   source address\
    \ in an HTTP connection.  It is now the IP address of\n   the recursive resolver\
    \ that, in a way, \"hides\" the real user.\n   However, hiding does not always\
    \ work.  Sometimes [CLIENT-SUBNET] is\n   used (see its privacy analysis in [denis-edns-client-subnet]).\n\
    \   Sometimes the end user has a personal recursive resolver on her\n   machine.\
    \  In both cases, the IP address is as sensitive as it is for\n   HTTP [sidn-entrada].\n\
    \   A note about IP addresses: there is currently no IETF document that\n   describes\
    \ in detail all the privacy issues around IP addressing.  In\n   the meantime,\
    \ the discussion here is intended to include both IPv4\n   and IPv6 source addresses.\
    \  For a number of reasons, their assignment\n   and utilization characteristics\
    \ are different, which may have\n   implications for details of information leakage\
    \ associated with the\n   collection of source addresses.  (For example, a specific\
    \ IPv6 source\n   address seen on the public Internet is less likely than an IPv4\n\
    \   address to originate behind a CGN or other NAT.)  However, for both\n   IPv4\
    \ and IPv6 addresses, it's important to note that source addresses\n   are propagated\
    \ with queries and comprise metadata about the host,\n   user, or application\
    \ that originated them.\n"
- title: 2.3.  Cache Snooping
  contents:
  - "2.3.  Cache Snooping\n   The content of recursive resolvers' caches can reveal\
    \ data about the\n   clients using it (the privacy risks depend on the number\
    \ of clients).\n   This information can sometimes be examined by sending DNS queries\n\
    \   with RD=0 to inspect cache content, particularly looking at the DNS\n   TTLs\
    \ [grangeia.snooping].  Since this also is a reconnaissance\n   technique for\
    \ subsequent cache poisoning attacks, some counter\n   measures have already been\
    \ developed and deployed.\n"
- title: 2.4.  On the Wire
  contents:
  - "2.4.  On the Wire\n   DNS traffic can be seen by an eavesdropper like any other\
    \ traffic.\n   It is typically not encrypted.  (DNSSEC, specified in [RFC4033],\n\
    \   explicitly excludes confidentiality from its goals.)  So, if an\n   initiator\
    \ starts an HTTPS communication with a recipient, while the\n   HTTP traffic will\
    \ be encrypted, the DNS exchange prior to it will not\n   be.  When other protocols\
    \ will become more and more privacy-aware and\n   secured against surveillance,\
    \ the DNS may become \"the weakest link\"\n   in privacy.\n   An important specificity\
    \ of the DNS traffic is that it may take a\n   different path than the communication\
    \ between the initiator and the\n   recipient.  For instance, an eavesdropper\
    \ may be unable to tap the\n   wire between the initiator and the recipient but\
    \ may have access to\n   the wire going to the recursive resolver, or to the authoritative\n\
    \   name servers.\n   The best place to tap, from an eavesdropper's point of view,\
    \ is\n   clearly between the stub resolvers and the recursive resolvers,\n   because\
    \ traffic is not limited by DNS caching.\n   The attack surface between the stub\
    \ resolver and the rest of the\n   world can vary widely depending upon how the\
    \ end user's computer is\n   configured.  By order of increasing attack surface:\n\
    \      The recursive resolver can be on the end user's computer.  In\n      (currently)\
    \ a small number of cases, individuals may choose to\n      operate their own\
    \ DNS resolver on their local machine.  In this\n      case, the attack surface\
    \ for the connection between the stub\n      resolver and the caching resolver\
    \ is limited to that single\n      machine.\n      The recursive resolver may\
    \ be at the local network edge.  For\n      many/most enterprise networks and\
    \ for some residential users, the\n      caching resolver may exist on a server\
    \ at the edge of the local\n      network.  In this case, the attack surface is\
    \ the local network.\n      Note that in large enterprise networks, the DNS resolver\
    \ may not\n      be located at the edge of the local network but rather at the\
    \ edge\n      of the overall enterprise network.  In this case, the enterprise\n\
    \      network could be thought of as similar to the Internet Access\n      Provider\
    \ (IAP) network referenced below.\n      The recursive resolver can be in the\
    \ IAP premises.  For most\n      residential users and potentially other networks,\
    \ the typical case\n      is for the end user's computer to be configured (typically\n\
    \      automatically through DHCP) with the addresses of the DNS\n      recursive\
    \ resolvers at the IAP.  The attack surface for on-the-\n      wire attacks is\
    \ therefore from the end-user system across the\n      local network and across\
    \ the IAP network to the IAP's recursive\n      resolvers.\n      The recursive\
    \ resolver can be a public DNS service.  Some machines\n      may be configured\
    \ to use public DNS resolvers such as those\n      operated today by Google Public\
    \ DNS or OpenDNS.  The end user may\n      have configured their machine to use\
    \ these DNS recursive resolvers\n      themselves -- or their IAP may have chosen\
    \ to use the public DNS\n      resolvers rather than operating their own resolvers.\
    \  In this\n      case, the attack surface is the entire public Internet between\
    \ the\n      end user's connection and the public DNS service.\n"
- title: 2.5.  In the Servers
  contents:
  - "2.5.  In the Servers\n   Using the terminology of [RFC6973], the DNS servers\
    \ (recursive\n   resolvers and authoritative servers) are enablers: they facilitate\n\
    \   communication between an initiator and a recipient without being\n   directly\
    \ in the communications path.  As a result, they are often\n   forgotten in risk\
    \ analysis.  But, to quote again [RFC6973], \"Although\n   [...] enablers may\
    \ not generally be considered as attackers, they may\n   all pose privacy threats\
    \ (depending on the context) because they are\n   able to observe, collect, process,\
    \ and transfer privacy-relevant\n   data.\"  In [RFC6973] parlance, enablers become\
    \ observers when they\n   start collecting data.\n   Many programs exist to collect\
    \ and analyze DNS data at the servers --\n   from the \"query log\" of some programs\
    \ like BIND to tcpdump and more\n   sophisticated programs like PacketQ [packetq]\
    \ [packetq-list] and\n   DNSmezzo [dnsmezzo].  The organization managing the DNS\
    \ server can\n   use this data itself, or it can be part of a surveillance program\n\
    \   like PRISM [prism] and pass data to an outside observer.\n   Sometimes, this\
    \ data is kept for a long time and/or distributed to\n   third parties for research\
    \ purposes [ditl] [day-at-root], security\n   analysis, or surveillance tasks.\
    \  These uses are sometimes under some\n   sort of contract, with various limitations,\
    \ for instance, on\n   redistribution, given the sensitive nature of the data.\
    \  Also, there\n   are observation points in the network that gather DNS data\
    \ and then\n   make it accessible to third parties for research or security purposes\n\
    \   (\"passive DNS\" [passive-dns]).\n"
- title: 2.5.1.  In the Recursive Resolvers
  contents:
  - "2.5.1.  In the Recursive Resolvers\n   Recursive Resolvers see all the traffic\
    \ since there is typically no\n   caching before them.  To summarize: your recursive\
    \ resolver knows a\n   lot about you.  The resolver of a large IAP, or a large\
    \ public\n   resolver, can collect data from many users.  You may get an idea\
    \ of\n   the data collected by reading the privacy policy of a big public\n  \
    \ resolver, e.g., <https://developers.google.com/speed/public-dns/\n   privacy>.\n"
- title: 2.5.2.  In the Authoritative Name Servers
  contents:
  - "2.5.2.  In the Authoritative Name Servers\n   Unlike what happens for recursive\
    \ resolvers, observation capabilities\n   of authoritative name servers are limited\
    \ by caching; they see only\n   the requests for which the answer was not in the\
    \ cache.  For\n   aggregated statistics (\"What is the percentage of LOC queries?\"\
    ),\n   this is sufficient, but it prevents an observer from seeing\n   everything.\
    \  Still, the authoritative name servers see a part of the\n   traffic, and this\
    \ subset may be sufficient to violate some privacy\n   expectations.\n   Also,\
    \ the end user typically has some legal/contractual link with the\n   recursive\
    \ resolver (he has chosen the IAP, or he has chosen to use a\n   given public\
    \ resolver), while having no control and perhaps no\n   awareness of the role\
    \ of the authoritative name servers and their\n   observation abilities.\n   As\
    \ noted before, using a local resolver or a resolver close to the\n   machine\
    \ decreases the attack surface for an on-the-wire eavesdropper.\n   But it may\
    \ decrease privacy against an observer located on an\n   authoritative name server.\
    \  This authoritative name server will see\n   the IP address of the end client\
    \ instead of the address of a big\n   recursive resolver shared by many users.\n\
    \   This \"protection\", when using a large resolver with many clients, is\n \
    \  no longer present if [CLIENT-SUBNET] is used because, in this case,\n   the\
    \ authoritative name server sees the original IP address (or\n   prefix, depending\
    \ on the setup).\n   As of today, all the instances of one root name server, L-root,\n\
    \   receive together around 50,000 queries per second.  While most of it\n   is\
    \ \"junk\" (errors on the Top-Level Domain (TLD) name), it gives an\n   idea of\
    \ the amount of big data that pours into name servers.  (And\n   even \"junk\"\
    \ can leak information; for instance, if there is a typing\n   error in the TLD,\
    \ the user will send data to a TLD that is not the\n   usual one.)\n   Many domains,\
    \ including TLDs, are partially hosted by third-party\n   servers, sometimes in\
    \ a different country.  The contracts between the\n   domain manager and these\
    \ servers may or may not take privacy into\n   account.  Whatever the contract,\
    \ the third-party hoster may be honest\n   or not but, in any case, it will have\
    \ to follow its local laws.  So,\n   requests to a given ccTLD may go to servers\
    \ managed by organizations\n   outside of the ccTLD's country.  End users may\
    \ not anticipate that,\n   when doing a security analysis.\n   Also, it seems\
    \ (see the survey described in [aeris-dns]) that there\n   is a strong concentration\
    \ of authoritative name servers among\n   \"popular\" domains (such as the Alexa\
    \ Top N list).  For instance,\n   among the Alexa Top 100K, one DNS provider hosts\
    \ today 10% of the\n   domains.  The ten most important DNS providers host together\
    \ one\n   third of the domains.  With the control (or the ability to sniff the\n\
    \   traffic) of a few name servers, you can gather a lot of information.\n"
- title: 2.5.3.  Rogue Servers
  contents:
  - "2.5.3.  Rogue Servers\n   The previous paragraphs discussed DNS privacy, assuming\
    \ that all the\n   traffic was directed to the intended servers and that the potential\n\
    \   attacker was purely passive.  But, in reality, we can have active\n   attackers\
    \ redirecting the traffic, not to change it but just to\n   observe it.\n   For\
    \ instance, a rogue DHCP server, or a trusted DHCP server that has\n   had its\
    \ configuration altered by malicious parties, can direct you to\n   a rogue recursive\
    \ resolver.  Most of the time, it seems to be done to\n   divert traffic by providing\
    \ lies for some domain names.  But it could\n   be used just to capture the traffic\
    \ and gather information about you.\n   Other attacks, besides using DHCP, are\
    \ possible.  The traffic from a\n   DNS client to a DNS server can be intercepted\
    \ along its way from\n   originator to intended source, for instance, by transparent\
    \ DNS\n   proxies in the network that will divert the traffic intended for a\n\
    \   legitimate DNS server.  This rogue server can masquerade as the\n   intended\
    \ server and respond with data to the client.  (Rogue servers\n   that inject\
    \ malicious data are possible, but it is a separate problem\n   not relevant to\
    \ privacy.)  A rogue server may respond correctly for a\n   long period of time,\
    \ thereby foregoing detection.  This may be done\n   for what could be claimed\
    \ to be good reasons, such as optimization or\n   caching, but it leads to a reduction\
    \ of privacy compared to if there\n   was no attacker present.  Also, malware\
    \ like DNSchanger [dnschanger]\n   can change the recursive resolver in the machine's\
    \ configuration, or\n   the routing itself can be subverted (for instance,\n \
    \  [ripe-atlas-turkey]).\n   A practical consequence of this section is that solutions\
    \ for DNS\n   privacy may have to address authentication of the server, not just\n\
    \   passive sniffing.\n"
- title: 2.6.  Re-identification and Other Inferences
  contents:
  - "2.6.  Re-identification and Other Inferences\n   An observer has access not only\
    \ to the data he/she directly collects\n   but also to the results of various\
    \ inferences about this data.\n   For instance, a user can be re-identified via\
    \ DNS queries.  If the\n   adversary knows a user's identity and can watch their\
    \ DNS queries for\n   a period, then that same adversary may be able to re-identify\
    \ the\n   user solely based on their pattern of DNS queries later on regardless\n\
    \   of the location from which the user makes those queries.  For\n   example,\
    \ one study [herrmann-reidentification] found that such re-\n   identification\
    \ is possible so that \"73.1% of all day-to-day links\n   were correctly established,\
    \ i.e. user u was either re-identified\n   unambiguously (1) or the classifier\
    \ correctly reported that u was not\n   present on day t+1 any more (2).\"  While\
    \ that study related to web\n   browsing behavior, equally characteristic patterns\
    \ may be produced\n   even in machine-to-machine communications or without a user\
    \ taking\n   specific actions, e.g., at reboot time if a characteristic set of\n\
    \   services are accessed by the device.\n   For instance, one could imagine that\
    \ an intelligence agency\n   identifies people going to a site by putting in a\
    \ very long DNS name\n   and looking for queries of a specific length.  Such traffic\
    \ analysis\n   could weaken some privacy solutions.\n   The IAB privacy and security\
    \ program also have a work in progress\n   [RFC7624] that considers such inference-based\
    \ attacks in a more\n   general framework.\n"
- title: 2.7.  More Information
  contents:
  - "2.7.  More Information\n   Useful background information can also be found in\
    \ [tor-leak] (about\n   the risk of privacy leak through DNS) and in a few academic\
    \ papers:\n   [yanbin-tsudik], [castillo-garcia], [fangming-hori-sakurai], and\n\
    \   [federrath-fuchs-herrmann-piosecny].\n"
- title: 3.  Actual "Attacks"
  contents:
  - "3.  Actual \"Attacks\"\n   A very quick examination of DNS traffic may lead to\
    \ the false\n   conclusion that extracting the needle from the haystack is difficult.\n\
    \   \"Interesting\" primary DNS requests are mixed with useless (for the\n   eavesdropper)\
    \ secondary and tertiary requests (see the terminology in\n   Section 1).  But,\
    \ in this time of \"big data\" processing, powerful\n   techniques now exist to\
    \ get from the raw data to what the\n   eavesdropper is actually interested in.\n\
    \   Many research papers about malware detection use DNS traffic to\n   detect\
    \ \"abnormal\" behavior that can be traced back to the activity of\n   malware\
    \ on infected machines.  Yes, this research was done for the\n   good, but technically\
    \ it is a privacy attack and it demonstrates the\n   power of the observation\
    \ of DNS traffic.  See [dns-footprint],\n   [dagon-malware], and [darkreading-dns].\n\
    \   Passive DNS systems [passive-dns] allow reconstruction of the data of\n  \
    \ sometimes an entire zone.  They are used for many reasons -- some\n   good,\
    \ some bad.  Well-known passive DNS systems keep only the DNS\n   responses, and\
    \ not the source IP address of the client, precisely for\n   privacy reasons.\
    \  Other passive DNS systems may not be so careful.\n   And there is still the\
    \ potential problems with revealing QNAMEs.\n   The revelations (from the Edward\
    \ Snowden documents, which were leaked\n   from the National Security Agency (NSA))\
    \ of the MORECOWBELL\n   surveillance program [morecowbell], which uses the DNS,\
    \ both\n   passively and actively, to surreptitiously gather information about\n\
    \   the users, is another good example showing that the lack of privacy\n   protections\
    \ in the DNS is actively exploited.\n"
- title: 4.  Legalities
  contents:
  - "4.  Legalities\n   To our knowledge, there are no specific privacy laws for DNS\
    \ data, in\n   any country.  Interpreting general privacy laws like\n   [data-protection-directive]\
    \ (European Union) in the context of DNS\n   traffic data is not an easy task,\
    \ and we do not know a court\n   precedent here.  See an interesting analysis\
    \ in [sidn-entrada].\n"
- title: 5.  Security Considerations
  contents:
  - "5.  Security Considerations\n   This document is entirely about security, more\
    \ precisely privacy.  It\n   just lays out the problem; it does not try to set\
    \ requirements (with\n   the choices and compromises they imply), much less define\
    \ solutions.\n   Possible solutions to the issues described here are discussed\
    \ in\n   other documents (currently too many to all be mentioned); see, for\n\
    \   instance, [QNAME-MINIMIZATION] for the minimization of data or\n   [TLS-FOR-DNS]\
    \ about encryption.\n"
- title: 6.  References
  contents:
  - '6.  References

    '
- title: 6.1.  Normative References
  contents:
  - "6.1.  Normative References\n   [RFC1034]  Mockapetris, P., \"Domain names - concepts\
    \ and facilities\",\n              STD 13, RFC 1034, DOI 10.17487/RFC1034, November\
    \ 1987,\n              <http://www.rfc-editor.org/info/rfc1034>.\n   [RFC1035]\
    \  Mockapetris, P., \"Domain names - implementation and\n              specification\"\
    , STD 13, RFC 1035, DOI 10.17487/RFC1035,\n              November 1987, <http://www.rfc-editor.org/info/rfc1035>.\n\
    \   [RFC6973]  Cooper, A., Tschofenig, H., Aboba, B., Peterson, J.,\n        \
    \      Morris, J., Hansen, M., and R. Smith, \"Privacy\n              Considerations\
    \ for Internet Protocols\", RFC 6973,\n              DOI 10.17487/RFC6973, July\
    \ 2013,\n              <http://www.rfc-editor.org/info/rfc6973>.\n   [RFC7258]\
    \  Farrell, S. and H. Tschofenig, \"Pervasive Monitoring Is an\n             \
    \ Attack\", BCP 188, RFC 7258, DOI 10.17487/RFC7258, May\n              2014,\
    \ <http://www.rfc-editor.org/info/rfc7258>.\n"
- title: 6.2.  Informative References
  contents:
  - "6.2.  Informative References\n   [aeris-dns]\n              Vinot, N., \"Vie\
    \ privee: et le DNS alors?\", (In French),\n              2015,\n            \
    \  <https://blog.imirhil.fr/vie-privee-et-le-dns-alors.html>.\n   [castillo-garcia]\n\
    \              Castillo-Perez, S. and J. Garcia-Alfaro, \"Anonymous\n        \
    \      Resolution of DNS Queries\", 2008,\n              <http://deic.uab.es/~joaquin/papers/is08.pdf>.\n\
    \   [CLIENT-SUBNET]\n              Contavalli, C., Gaast, W., Lawrence, D., and\
    \ W. Kumari,\n              \"Client Subnet in DNS Queries\", Work in Progress,\n\
    \              draft-ietf-dnsop-edns-client-subnet-02, July 2015.\n   [dagon-malware]\n\
    \              Dagon, D., \"Corrupted DNS Resolution Paths: The Rise of a\n  \
    \            Malicious Resolution Authority\", ISC/OARC Workshop, 2007,\n    \
    \          <https://www.dns-oarc.net/files/workshop-2007/\n              Dagon-Resolution-corruption.pdf>.\n\
    \   [DANE-OPENPGPKEY]\n              Wouters, P., \"Using DANE to Associate OpenPGP\
    \ public keys\n              with email addresses\", Work in Progress,\n     \
    \         draft-ietf-dane-openpgpkey-03, April 2015.\n   [darkreading-dns]\n \
    \             Lemos, R., \"Got Malware? Three Signs Revealed In DNS\n        \
    \      Traffic\", InformationWeek Dark Reading, May 2013,\n              <http://www.darkreading.com/analytics/security-monitoring/\n\
    \              got-malware-three-signs-revealed-in-dns-traffic/d/\n          \
    \    d-id/1139680>.\n   [data-protection-directive]\n              European Parliament,\
    \ \"Directive 95/46/EC of the European\n              Pariament and of the council\
    \ on the protection of\n              individuals with regard to the processing\
    \ of personal data\n              and on the free movement of such data\", Official\
    \ Journal L\n              281, pp. 0031 - 0050, November 1995,\n            \
    \  <http://eur-lex.europa.eu/LexUriServ/\n              LexUriServ.do?uri=CELEX:31995L0046:EN:HTML>.\n\
    \   [day-at-root]\n              Castro, S., Wessels, D., Fomenkov, M., and K.\
    \ Claffy, \"A\n              Day at the Root of the Internet\", ACM SIGCOMM Computer\n\
    \              Communication Review, Vol. 38, Number 5, DOI\n              10.1145/1452335.1452341,\
    \ October 2008,\n              <http://www.sigcomm.org/sites/default/files/ccr/\n\
    \              papers/2008/October/1452335-1452341.pdf>.\n   [denis-edns-client-subnet]\n\
    \              Denis, F., \"Security and privacy issues of edns-client-\n    \
    \          subnet\", August 2013, <https://00f.net/2013/08/07/\n             \
    \ edns-client-subnet/>.\n   [ditl]     CAIDA, \"A Day in the Life of the Internet\
    \ (DITL)\", 2002,\n              <http://www.caida.org/projects/ditl/>.\n   [dns-footprint]\n\
    \              Stoner, E., \"DNS Footprint of Malware\", OARC Workshop,\n    \
    \          October 2010, <https://www.dns-oarc.net/files/\n              workshop-201010/OARC-ers-20101012.pdf>.\n\
    \   [DNS-TERMS]\n              Hoffman, P., Sullivan, A., and K. Fujiwara, \"\
    DNS\n              Terminology\", Work in Progress,\n              draft-ietf-dnsop-dns-terminology-03,\
    \ June 2015.\n   [dnschanger]\n              Wikipedia, \"DNSChanger\", October\
    \ 2013,\n              <https://en.wikipedia.org/w/\n              index.php?title=DNSChanger&oldid=578749672>.\n\
    \   [dnsmezzo] Bortzmeyer, S., \"DNSmezzo\", 2009,\n              <http://www.dnsmezzo.net/>.\n\
    \   [fangming-hori-sakurai]\n              Fangming, Z., Hori, Y., and K. Sakurai,\
    \ \"Analysis of\n              Privacy Disclosure in DNS Query\", 2007 International\n\
    \              Conference on Multimedia and Ubiquitous Engineering (MUE\n    \
    \          2007), Seoul, Korea, ISBN: 0-7695-2777-9, pp. 952-957,\n          \
    \    DOI 10.1109/MUE.2007.84, April 2007,\n              <http://dl.acm.org/citation.cfm?id=1262690.1262986>.\n\
    \   [federrath-fuchs-herrmann-piosecny]\n              Federrath, H., Fuchs, K.,\
    \ Herrmann, D., and C. Piosecny,\n              \"Privacy-Preserving DNS: Analysis\
    \ of Broadcast, Range\n              Queries and Mix-based Protection Methods\"\
    , Computer\n              Security ESORICS 2011, Springer, page(s) 665-683, ISBN\n\
    \              978-3-642-23821-5, 2011,\n              <https://svs.informatik.uni-hamburg.de/publications/2011/\n\
    \              2011-09-14_FFHP_PrivacyPreservingDNS_ESORICS2011.pdf>.\n   [grangeia.snooping]\n\
    \              Grangeia, L., \"DNS Cache Snooping or Snooping the Cache\n    \
    \          for Fun and Profit\", February 2004,\n              <http://www.msit2005.mut.ac.th/msit_media/1_2551/nete4630/\n\
    \              materials/20080718130017Hc.pdf>.\n   [herrmann-reidentification]\n\
    \              Herrmann, D., Gerber, C., Banse, C., and H. Federrath,\n      \
    \        \"Analyzing Characteristic Host Access Patterns for\n              Re-Identification\
    \ of Web User Sessions\",\n              DOI 10.1007/978-3-642-27937-9_10, 2012,\n\
    \              <http://epub.uni-regensburg.de/21103/1/\n              Paper_PUL_nordsec_published.pdf>.\n\
    \   [morecowbell]\n              Grothoff, C., Wachs, M., Ermert, M., and J. Appelbaum,\n\
    \              \"NSA's MORECOWBELL: Knell for DNS\", GNUnet e.V., January\n  \
    \            2015, <https://gnunet.org/morecowbell>.\n   [packetq]  Dot SE, \"\
    PacketQ, a simple tool to make SQL-queries\n              against PCAP-files\"\
    , 2011,\n              <https://github.com/dotse/packetq/wiki>.\n   [packetq-list]\n\
    \              PacketQ, \"PacketQ Mailing List\",\n              <http://lists.iis.se/mailman/listinfo/packetq>.\n\
    \   [passive-dns]\n              Weimer, F., \"Passive DNS Replication\", April\
    \ 2005,\n              <http://www.enyo.de/fw/software/dnslogger/#2>.\n   [prism]\
    \    Wikipedia, \"PRISM (surveillance program)\", July 2015,\n              <https://en.wikipedia.org/w/index.php?title=PRISM_\n\
    \              (surveillance_program)&oldid=673789455>.\n   [QNAME-MINIMIZATION]\n\
    \              Bortzmeyer, S., \"DNS query name minimisation to improve\n    \
    \          privacy\", Work in Progress,\n              draft-ietf-dnsop-qname-minimisation-04,\
    \ June 2015.\n   [RFC4033]  Arends, R., Austein, R., Larson, M., Massey, D., and\
    \ S.\n              Rose, \"DNS Security Introduction and Requirements\",\n  \
    \            RFC 4033, DOI 10.17487/RFC4033, March 2005,\n              <http://www.rfc-editor.org/info/rfc4033>.\n\
    \   [RFC5155]  Laurie, B., Sisson, G., Arends, R., and D. Blacka, \"DNS\n    \
    \          Security (DNSSEC) Hashed Authenticated Denial of\n              Existence\"\
    , RFC 5155, DOI 10.17487/RFC5155, March 2008,\n              <http://www.rfc-editor.org/info/rfc5155>.\n\
    \   [RFC5936]  Lewis, E. and A. Hoenes, Ed., \"DNS Zone Transfer Protocol\n  \
    \            (AXFR)\", RFC 5936, DOI 10.17487/RFC5936, June 2010,\n          \
    \    <http://www.rfc-editor.org/info/rfc5936>.\n   [RFC6269]  Ford, M., Ed., Boucadair,\
    \ M., Durand, A., Levis, P., and\n              P. Roberts, \"Issues with IP Address\
    \ Sharing\", RFC 6269,\n              DOI 10.17487/RFC6269, June 2011,\n     \
    \         <http://www.rfc-editor.org/info/rfc6269>.\n   [RFC7624]  Barnes, R.,\
    \ Schneier, B., Jennings, C., Hardie, T.,\n              Trammell, B., Huitema,\
    \ C., and D. Borkmann,\n              \"Confidentiality in the Face of Pervasive\
    \ Surveillance: A\n              Threat Model and Problem Statement\", RFC 7624,\n\
    \              DOI 10.17487/RFC7624, August 2015,\n              <http://www.rfc-editor.org/info/rfc7624>.\n\
    \   [ripe-atlas-turkey]\n              Aben, E., \"A RIPE Atlas View of Internet\
    \ Meddling in\n              Turkey\", March 2014,\n              <https://labs.ripe.net/Members/emileaben/\n\
    \              a-ripe-atlas-view-of-internet-meddling-in-turkey>.\n   [sidn-entrada]\n\
    \              Hesselman, C., Jansen, J., Wullink, M., Vink, K., and M.\n    \
    \          Simon, \"A privacy framework for 'DNS big data'\n              applications\"\
    , November 2014,\n              <https://www.sidnlabs.nl/uploads/tx_sidnpublications/\n\
    \              SIDN_Labs_Privacyraamwerk_Position_Paper_V1.4_ENG.pdf>.\n   [thomas-ditl-tcp]\n\
    \              Thomas, M. and D. Wessels, \"An Analysis of TCP Traffic in\n  \
    \            Root Server DITL Data\", DNS-OARC 2014 Fall Workshop,\n         \
    \     October 2014, <https://indico.dns-oarc.net/event/20/\n              session/2/contribution/15/material/slides/1.pdf>.\n\
    \   [TLS-FOR-DNS]\n              Zi, Z., Zhu, L., Heidemann, J., Mankin, A., Wessels,\
    \ D.,\n              and P. Hoffman, \"TLS for DNS: Initiation and Performance\n\
    \              Considerations\", Work in Progress, draft-ietf-dprive-\n      \
    \        start-tls-for-dns-01, July 2015.\n   [tor-leak] Tor, \"DNS leaks in Tor\"\
    , 2013,\n              <https://www.torproject.org/docs/\n              faq.html.en#WarningsAboutSOCKSandDNSInformationLeaks>.\n\
    \   [yanbin-tsudik]\n              Yanbin, L. and G. Tsudik, \"Towards Plugging\
    \ Privacy Leaks\n              in the Domain Name System\", October 2009,\n  \
    \            <http://arxiv.org/abs/0910.2472>.\n"
- title: Acknowledgments
  contents:
  - "Acknowledgments\n   Thanks to Nathalie Boulvard and to the CENTR members for\
    \ the original\n   work that led to this document.  Thanks to Ondrej Sury for\
    \ the\n   interesting discussions.  Thanks to Mohsen Souissi and John Heidemann\n\
    \   for proofreading and to Paul Hoffman, Matthijs Mekking, Marcos Sanz,\n   Tim\
    \ Wicinski, Francis Dupont, Allison Mankin, and Warren Kumari for\n   proofreading,\
    \ providing technical remarks, and making many\n   readability improvements. \
    \ Thanks to Dan York, Suzanne Woolf, Tony\n   Finch, Stephen Farrell, Peter Koch,\
    \ Simon Josefsson, and Frank Denis\n   for good written contributions.  And thanks\
    \ to the IESG members for\n   the last remarks.\n"
- title: Author's Address
  contents:
  - "Author's Address\n   Stephane Bortzmeyer\n   AFNIC\n   1, rue Stephenson\n  \
    \ Montigny-le-Bretonneux  78180\n   France\n   Phone: +33 1 39 30 83 46\n   Email:\
    \ bortzmeyer+ietf@nic.fr\n   URI:   http://www.afnic.fr/\n"
