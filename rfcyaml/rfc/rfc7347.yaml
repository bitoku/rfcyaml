- title: __initial_text__
  contents:
  - ''
- title: Independent Submission                              H. van Helvoort, Ed.
  contents:
  - "Independent Submission                              H. van Helvoort, Ed.\n  \
    \            Pre-standard Linear Protection Switching in\n                   \
    \ MPLS Transport Profile (MPLS-TP)\n"
- title: Abstract
  contents:
  - "Abstract\n   The IETF Standards Track solution for MPLS Transport Profile\n \
    \  (MPLS-TP) Linear Protection is provided in RFCs 6378, 7271, and 7324.\n   This\
    \ document describes the pre-standard implementation of MPLS-TP\n   Linear Protection\
    \ that has been deployed by several network operators\n   using equipment from\
    \ multiple vendors.  At the time of publication,\n   these pre-standard implementations\
    \ were still in operation carrying\n   live traffic.\n   The specified mechanism\
    \ supports 1+1 unidirectional/bidirectional\n   protection switching and 1:1 bidirectional\
    \ protection switching.  It\n   is purely supported by the MPLS-TP data plane\
    \ and can work without\n   any control plane.\n"
- title: Status of This Memo
  contents:
  - "Status of This Memo\n   This document is not an Internet Standards Track specification;\
    \ it is\n   published for informational purposes.\n   This is a contribution to\
    \ the RFC Series, independently of any other\n   RFC stream.  The RFC Editor has\
    \ chosen to publish this document at\n   its discretion and makes no statement\
    \ about its value for\n   implementation or deployment.  Documents approved for\
    \ publication by\n   the RFC Editor are not a candidate for any level of Internet\n\
    \   Standard; see Section 2 of RFC 5741.\n   Information about the current status\
    \ of this document, any errata,\n   and how to provide feedback on it may be obtained\
    \ at\n   http://www.rfc-editor.org/info/rfc7347.\n"
- title: Copyright Notice
  contents:
  - "Copyright Notice\n   Copyright (c) 2014 IETF Trust and the persons identified\
    \ as the\n   document authors.  All rights reserved.\n   This document is subject\
    \ to BCP 78 and the IETF Trust's Legal\n   Provisions Relating to IETF Documents\n\
    \   (http://trustee.ietf.org/license-info) in effect on the date of\n   publication\
    \ of this document.  Please review these documents\n   carefully, as they describe\
    \ your rights and restrictions with respect\n   to this document.\n"
- title: Table of Contents
  contents:
  - "Table of Contents\n   1.  Introduction  . . . . . . . . . . . . . . . . . . .\
    \ . . . . .   4\n   2.  Conventions Used in This Document . . . . . . . . . .\
    \ . . . .   5\n   3.  Acronyms  . . . . . . . . . . . . . . . . . . . . . . .\
    \ . . .   5\n   4.  Linear Protection-Switching Overview  . . . . . . . . . .\
    \ . .   6\n     4.1.  Protection Architecture Types . . . . . . . . . . . . .\
    \ .   6\n       4.1.1.  1+1 Architecture  . . . . . . . . . . . . . . . . . .\
    \   6\n       4.1.2.  1:1 Architecture  . . . . . . . . . . . . . . . . . .  \
    \ 6\n       4.1.3.  1:n Architecture  . . . . . . . . . . . . . . . . . .   7\n\
    \     4.2.  Protection Switching Type . . . . . . . . . . . . . . . .   7\n  \
    \   4.3.  Protection Operation Type . . . . . . . . . . . . . . . .   7\n   5.\
    \  Protection-Switching Trigger Conditions . . . . . . . . . . .   8\n     5.1.\
    \  Fault Conditions  . . . . . . . . . . . . . . . . . . . .   8\n     5.2.  External\
    \ Commands . . . . . . . . . . . . . . . . . . . .   8\n       5.2.1.  End-to-End\
    \ Commands . . . . . . . . . . . . . . . . .   8\n       5.2.2.  Local Commands\
    \  . . . . . . . . . . . . . . . . . . .   9\n   6.  Protection-Switching Schemes\
    \  . . . . . . . . . . . . . . . .  10\n     6.1.  1+1 Unidirectional Protection\
    \ Switching . . . . . . . . .  10\n     6.2.  1+1 Bidirectional Protection Switching\
    \  . . . . . . . . .  11\n     6.3.  1:1 Bidirectional Protection Switching  .\
    \ . . . . . . . .  12\n   7.  APS Protocol  . . . . . . . . . . . . . . . . .\
    \ . . . . . . .  13\n     7.1.  APS PDU Format  . . . . . . . . . . . . . . .\
    \ . . . . . .  13\n     7.2.  APS Transmission  . . . . . . . . . . . . . . .\
    \ . . . . .  16\n     7.3.  Hold-Off Timer  . . . . . . . . . . . . . . . . .\
    \ . . . .  17\n     7.4.  WTR Timer . . . . . . . . . . . . . . . . . . . . .\
    \ . . .  17\n     7.5.   Command Acceptance and Retention . . . . . . . . . .\
    \ . .  18\n     7.6.  Exercise Operation  . . . . . . . . . . . . . . . . . .\
    \ .  18\n   8.  Protection-Switching Logic  . . . . . . . . . . . . . . . . .\
    \  19\n     8.1.  Principle of Operation  . . . . . . . . . . . . . . . . .  19\n\
    \     8.2.  Equal Priority Requests . . . . . . . . . . . . . . . . .  21\n  \
    \   8.3.  Signal Degrade of the Protection Transport Entity . . . .  22\n   9.\
    \  Protection-Switching State Transition Tables  . . . . . . . .  22\n   10. Security\
    \ Considerations . . . . . . . . . . . . . . . . . . .  24\n   11. Acknowledgements\
    \  . . . . . . . . . . . . . . . . . . . . . .  24\n   12. References  . . . .\
    \ . . . . . . . . . . . . . . . . . . . . .  24\n     12.1.  Normative References\
    \ . . . . . . . . . . . . . . . . . .  24\n     12.2.  Informative References\
    \ . . . . . . . . . . . . . . . . .  25\n   Appendix A.  Operation Examples of\
    \ the APS Protocol . . . . . . .  26\n"
- title: 1.  Introduction
  contents:
  - "1.  Introduction\n   The IETF Standards Track solution for MPLS Transport Profile\n\
    \   (MPLS-TP) Linear Protection is provided in [RFC6378], [RFC7271], and\n   [RFC7324].\n\
    \   This document describes the pre-standard implementation of MPLS-TP\n   Linear\
    \ Protection that has been deployed by several network operators\n   using equipment\
    \ from multiple vendors.  At the time of publication,\n   these pre-standard implementations\
    \ were still in operation carrying\n   live traffic.\n   This implementation was\
    \ considered in the MPLS WG; however, a\n   different path was chosen.\n   This\
    \ document may be useful in the future if a vendor or operator is\n   trying to\
    \ interwork with a different vendor or operator who has\n   deployed the pre-standard\
    \ implementation, and it provides a permanent\n   record of the pre-standard implementation.\
    \  It is also worth noting\n   that the experience gained during deployment of\
    \ the implementations\n   of this document was used to refine [RFC7271].\n   MPLS-TP\
    \ is defined as the transport profile of MPLS technology to\n   allow its deployment\
    \ in transport networks.  A typical feature of a\n   transport network is that\
    \ it can provide fast protection switching\n   for end-to-end transport paths\
    \ and transport path segments.  The\n   protection-switching time is generally\
    \ required to be less than 50 ms\n   to meet the strict requirements of services\
    \ such as voice, private\n   line, etc.\n   The goal of a linear protection-switching\
    \ mechanism is to satisfy the\n   requirement of fast protection switching for\
    \ an MPLS-TP network.\n   Linear protection switching means that, for one or more\
    \ working\n   transport entities (working paths), there is one protection transport\n\
    \   entity (protection path), which is disjoint from any of the working\n   transport\
    \ entities, ready to take over the service transmission when\n   a working transport\
    \ entity has failed.\n   This document specifies a 1+1 unidirectional protection-switching\n\
    \   mechanism for a unidirectional transport entity (either point to\n   point\
    \ or point to multipoint) as well as a bidirectional point-to-\n   point transport\
    \ entity and a 1+1/1:1 bidirectional protection-\n   switching mechanism for a\
    \ point-to-point bidirectional transport\n   entity.  Since bidirectional protection\
    \ switching needs the\n   coordination of the two endpoints of the transport entity,\
    \ this\n   document also specifies the Automatic Protection Switching (APS)\n\
    \   protocol, which is used for this purpose.\n   The linear protection mechanism\
    \ described in this document is\n   applicable to both Label Switched Paths (LSPs)\
    \ and Pseudowires (PWs).\n   The APS protocol specified in this document is based\
    \ on the same\n   principles and behavior of the APS protocol designed for Synchronous\n\
    \   Optical Network (SONET) [T1.105.01] / Synchronous Digital Hierarchy\n   (SDH)\
    \ [G.841], Optical Transport Network (OTN) [G.873.1], and\n   Ethernet [G.8031]\
    \ and provides commonality with the established\n   operation models utilized\
    \ in transport network technologies (e.g.,\n   SDH/SONET, OTN, and Ethernet).\n"
- title: 2.  Conventions Used in This Document
  contents:
  - "2.  Conventions Used in This Document\n   The key words \"MUST\", \"MUST NOT\"\
    , \"REQUIRED\", \"SHALL\", \"SHALL NOT\",\n   \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\"\
    , \"MAY\", and \"OPTIONAL\" in this\n   document are to be interpreted as described\
    \ in [RFC2119].\n"
- title: 3.  Acronyms
  contents:
  - "3.  Acronyms\n   This document uses the following acronyms:\n   APS     Automatic\
    \ Protection Switching\n   DNR     Do not Revert\n   EXER    Exercise\n   G-ACh\
    \   Generic Associated Channel\n   FS      Forced Switch\n   LO      Lockout of\
    \ Protection\n   LSP     Label Switched Path\n   MPLS-TP MPLS Transport Profile\n\
    \   MS      Manual Switch\n   MS-P    Manual Switch to Protection transport entity\n\
    \   MS-W    Manual Switch to Working transport entity\n   NR      No Request\n\
    \   OAM     Operations, Administration, and Maintenance\n   OTN     Optical Transport\
    \ Network\n   PDU     Protocol Data Unit\n   PW      Pseudowire\n   RR      Reverse\
    \ Request\n   SD      Signal Degrade\n   SD-P    Signal Degrade on Protection\
    \ transport entity\n   SD-W    Signal Degrade on Working transport entity\n  \
    \ SDH     Synchronous Digital Hierarchy\n   SF      Signal Fail\n   SF-P    Signal\
    \ Fail on Protection transport entity\n   SF-W    Signal Fail on Working transport\
    \ entity\n   SONET   Synchronous Optical Network\n   WTR     Wait to Restore\n"
- title: 4.  Linear Protection-Switching Overview
  contents:
  - "4.  Linear Protection-Switching Overview\n   To guarantee the protection-switching\
    \ time for a working transport\n   entity, its protection transport entity is\
    \ always preconfigured\n   before the failure occurs.  Normally, traffic will\
    \ be transmitted and\n   received on the working transport entity.  Switching\
    \ to the\n   protection transport entity is usually triggered by link or node\n\
    \   failure, external commands, etc.  Note that external commands are\n   often\
    \ used in transport networks by operators, and they are very\n   useful in cases\
    \ of service adjustment, path maintenance, etc.\n"
- title: 4.1.  Protection Architecture Types
  contents:
  - '4.1.  Protection Architecture Types

    '
- title: 4.1.1.  1+1 Architecture
  contents:
  - "4.1.1.  1+1 Architecture\n   In the 1+1 architecture, the protection transport\
    \ entity is\n   associated with a working transport entity.  The normal traffic\
    \ is\n   permanently bridged onto both the working transport entity and the\n\
    \   protection transport entity at the source endpoint of the protected\n   domain.\
    \  The normal traffic on working and protection transport\n   entities is transmitted\
    \ simultaneously to the destination sink\n   endpoint of the protected domain,\
    \ where a selection between the\n   working and protection transport entity is\
    \ made based on\n   predetermined criteria, such as signal fail and signal degrade\n\
    \   indications.\n"
- title: 4.1.2.  1:1 Architecture
  contents:
  - "4.1.2.  1:1 Architecture\n   In the 1:1 architecture, the protection transport\
    \ entity is\n   associated with a working transport entity.  When the working\n\
    \   transport entity is determined to be impaired, the normal traffic\n   MUST\
    \ be transferred from the working to the protection transport\n   entity at both\
    \ the source and sink endpoints of the protected domain.\n   The selection between\
    \ the working and protection transport entities\n   is made based on predetermined\
    \ criteria, such as signal fail and\n   signal degrade indications from the working\
    \ or protection transport\n   entity.\n   The bridge at the source endpoint can\
    \ be realized in two ways: it is\n   either a selector bridge or a broadcast bridge.\
    \  With a selector\n   bridge, the normal traffic is connected either to the working\n\
    \   transport entity or the protection transport entity.  With a\n   broadcast\
    \ bridge, the normal traffic is permanently connected to the\n   working transport\
    \ entity, and in case a protection switch is active,\n   it is also connected\
    \ to the protection transport entity.  The\n   broadcast bridge is recommended\
    \ to be used in revertive mode only.\n"
- title: 4.1.3.  1:n Architecture
  contents:
  - "4.1.3.  1:n Architecture\n   Details for the 1:n protection-switching architecture\
    \ are out of\n   scope of this document and will be provided in a different document\n\
    \   in the future.\n   It is worth noting that the APS protocol defined here is\
    \ capable of\n   supporting 1:n operations.\n"
- title: 4.2.  Protection Switching Type
  contents:
  - "4.2.  Protection Switching Type\n   The linear protection-switching types can\
    \ be a unidirectional\n   switching type or a bidirectional switching type.\n\
    \   o  Unidirectional switching type: Only the affected direction of the\n   \
    \   working transport entity is switched to the protection transport\n      entity;\
    \ the selectors at each endpoint operate independently.\n      This switching\
    \ type is recommended to be used for 1+1 protection\n      in this document.\n\
    \   o  Bidirectional switching type: Both directions of the working\n      transport\
    \ entity, including the affected direction and the\n      unaffected direction,\
    \ are switched to the protection transport\n      entity.  For bidirectional switching,\
    \ the APS protocol is required\n      to coordinate the two endpoints so that\
    \ both have the same bridge\n      and selector settings, even for a unidirectional\
    \ failure.  This\n      type is applicable for 1+1 and 1:1 protection.\n"
- title: 4.3.  Protection Operation Type
  contents:
  - "4.3.  Protection Operation Type\n   The linear protection operation types can\
    \ be a non-revertive\n   operation type or a revertive operation type.\n   o \
    \ Non-revertive operation: The normal traffic will not be switched\n      back\
    \ to the working transport entity even after a protection\n      switching cause\
    \ has cleared.  This is generally accomplished by\n      replacing the previous\
    \ switch request with a \"Do not Revert (DNR)\"\n      request, which has a low\
    \ priority.\n   o  Revertive operation: The normal traffic is restored to the\
    \ working\n      transport entity after the condition(s) causing the protection\n\
    \      switching has cleared.  In the case of clearing a command (e.g.,\n    \
    \  Forced Switch), this happens immediately.  In the case of clearing\n      a\
    \ defect, this generally happens after the expiry of a \"Wait to\n      Restore\
    \ (WTR)\" timer, which is used to avoid chattering of\n      selectors in the\
    \ case of intermittent defects.\n"
- title: 5.  Protection-Switching Trigger Conditions
  contents:
  - '5.  Protection-Switching Trigger Conditions

    '
- title: 5.1.  Fault Conditions
  contents:
  - "5.1.  Fault Conditions\n   Fault conditions mean the requests generated by the\
    \ local Operations,\n   Administration, and Maintenance (OAM) function.\n   o\
    \  Signal Fail (SF): If an endpoint detects a failure by an OAM\n      function\
    \ or other mechanism, it will submit a local signal failure\n      (local SF)\
    \ to the APS module to request a protection switch.  The\n      local SF could\
    \ be on the working transport entity (Signal Fail on\n      Working transport\
    \ entity (SF-W)) or the protection transport\n      entity (Signal Fail on Protection\
    \ transport entity (SF-P)).\n   o  Signal Degrade (SD): If an endpoint detects\
    \ signal degradation by\n      an OAM function or other mechanism, it will submit\
    \ a local signal\n      degrade (local SD) to the APS module to request a protection\n\
    \      switching.  The local SD could be on the working transport entity\n   \
    \   (Signal Degrade on Working transport entity (SD-W)) or the\n      protection\
    \ transport entity (Signal Degrade on Protection\n      transport entity (SD-P)).\n"
- title: 5.2.  External Commands
  contents:
  - "5.2.  External Commands\n   The external command issues an appropriate external\
    \ request to the\n   protection process.\n"
- title: 5.2.1.  End-to-End Commands
  contents:
  - "5.2.1.  End-to-End Commands\n   These commands are applied to both local and\
    \ remote nodes.  When the\n   APS protocol is present, these commands, except\
    \ the Clear command,\n   are signaled to the far end of the connection.  In bidirectional\n\
    \   switching, these commands affect the bridge and selector at both\n   ends.\n\
    \   o  Lockout of Protection (LO): This command is used to provide the\n     \
    \ operator a tool for temporarily disabling access to the protection\n      transport\
    \ entity.\n   o  Manual Switch (MS): This command is used to provide the operator\
    \ a\n      tool for temporarily switching normal traffic to the working\n    \
    \  transport entity (Manual Switch to Working transport entity (MS-\n      W))\
    \ or to the protection transport entity (Manual Switch to\n      Protection transport\
    \ entity (MS-P)), unless a higher priority\n      switch request (i.e., LO, FS,\
    \ or SF) is in effect.\n   o  Forced Switch (FS): This command is used to provide\
    \ the operator a\n      tool for temporarily switching normal traffic from the\
    \ working\n      transport entity to the protection transport entity, unless a\n\
    \      higher priority switch request (i.e., LO or SF-P) is in effect.\n   o \
    \ Exercise (EXER): Exercise is a command to test if the APS\n      communication\
    \ is operating correctly.  The EXER command SHALL NOT\n      affect the state\
    \ of the protection selector and bridge.\n   o  Clear: This command between management\
    \ and the local protection\n      process is not a request sent by APS to other\
    \ endpoints.  It is\n      used to clear the active near-end external command\
    \ or WTR state.\n"
- title: 5.2.2.  Local Commands
  contents:
  - "5.2.2.  Local Commands\n   These commands apply only to the near end (local node)\
    \ of the\n   protection group.  Even when an APS protocol is supported, they are\n\
    \   not signaled to the far end.\n   o  Freeze: This command freezes the state\
    \ of the protection group.\n      Until the freeze is cleared, additional near-end\
    \ commands are\n      rejected, and condition changes and received APS information\
    \ are\n      ignored.  When the Freeze command is cleared, the state of the\n\
    \      protection group is recomputed based on the condition and received\n  \
    \    APS information.\n      Because the freeze is local, if the freeze is issued\
    \ at one end\n      only, a failure of protocol can occur as the other end is\
    \ open to\n      accept any operator command or fault condition.\n   o  Clear\
    \ Freeze: This command clears the local freeze.\n"
- title: 6.  Protection-Switching Schemes
  contents:
  - '6.  Protection-Switching Schemes

    '
- title: 6.1.  1+1 Unidirectional Protection Switching
  contents:
  - "6.1.  1+1 Unidirectional Protection Switching\n     +-----------+           \
    \                            +-----------+\n     |           |---------------------------------------|\
    \           |\n     |          -+---------------------------------------+-   \
    \       |\n     |         / |---------------------------------------| \\     \
    \    |\n     |        /  |       Working transport entity        |  \\       \
    \ |\n   --+------->   |                                       |   --------+->\n\
    \     |        \\  |                                       |           |\n   \
    \  |         \\ |---------------------------------------|           |\n     |\
    \          -+---------------------------------------|           |\n     |  source\
    \   |---------------------------------------|    sink   |\n     +-----------+\
    \       Protection transport entity     +-----------+\n                      \
    \      (normal condition)\n     +-----------+                                \
    \       +-----------+\n     |           |---------------------------------------|\
    \           |\n     |          -+------------------XX-------------------+    \
    \       |\n     |         / |---------------------------------------|        \
    \   |\n     |        /  |   Working transport entity (failure)  |           |\n\
    \   --|------->   |                                       |   --------+->\n  \
    \   |        \\  |                                       |  /        |\n     |\
    \         \\ |---------------------------------------| /         |\n     |   \
    \       -+---------------------------------------+-          |\n     |  source\
    \   |---------------------------------------|    sink   |\n     +-----------+\
    \     Protection transport entity       +-----------+\n                      \
    \     (failure condition)\n         Figure 1: 1+1 Unidirectional Linear Protection\
    \ Switching\n   1+1 unidirectional protection switching is the simplest protection\n\
    \   switching mechanism.  The normal traffic is permanently bridged on\n   both\
    \ the working and protection transport entities at the source\n   endpoint of\
    \ the protected domain.  In the normal condition, the sink\n   endpoint receives\
    \ traffic from the working transport entity.  If the\n   sink endpoint detects\
    \ a failure on the working transport entity, it\n   will switch to receive traffic\
    \ from the protection transport entity.\n   1+1 unidirectional protection switching\
    \ is recommended to be used for\n   unidirectional transport.\n   Note that 1+1\
    \ unidirectional protection switching does not use the\n   APS coordination protocol\
    \ since it only performs protection switching\n   based on the local request.\n"
- title: 6.2.  1+1 Bidirectional Protection Switching
  contents:
  - "6.2.  1+1 Bidirectional Protection Switching\n     +-----------+            \
    \                           +-----------+\n     |           |---------------------------------------|\
    \           |\n     |          -+<--------------------------------------+-   \
    \       |\n     |         / +-------------------------------------->+ \\     \
    \    |\n     | sink   / /|---------------------------------------|\\ \\   sink\
    \ |\n   <-+-------/ / |        Working transport entity       | --\\-------+->\n\
    \   --+-------->  |                                       |    <------+--\n  \
    \   | source  \\ |                                       |   / source|\n     |\
    \          \\|---------------------------------------|  /        |\n     |   \
    \        +-------------------------------------->| /         |\n     |       \
    \    |<--------------------------------------+-          |\n     | APS <...................................................>\
    \ APS |\n     |           |---------------------------------------+          \
    \ |\n     +-----------+      Protection transport entity      +-----------+\n\
    \                            (normal condition)\n     +-----------+          \
    \                             +-----------+\n     |           |---------------------------------------|\
    \           |\n     |           +<----------------XX--------------------+-   \
    \       |\n     |           +-------------------------------------->+ \\     \
    \    |\n     |          /|---------------------------------------|  \\       \
    \ |\n     | source  / |   Working transport entity (failure)  |   \\ source|\n\
    \   --+-------->  |                                       |    \\<-----+--\n \
    \  <-+-------  \\ |                                       |  --/------+->\n  \
    \   | sink  \\  \\|---------------------------------------| / /  sink |\n    \
    \ |        \\  +-------------------------------------->+- /        |\n     | \
    \        --+<--------------------------------------+-/         |\n     | APS <...................................................>\
    \ APS |\n     |           |---------------------------------------+          \
    \ |\n     +-----------+      Protection transport entity      +-----------+\n\
    \                             (failure condition)\n          Figure 2: 1+1 Bidirectional\
    \ Linear Protection Switching\n   In 1+1 bidirectional protection switching, for\
    \ each direction, the\n   normal traffic is permanently bridged on both the working\
    \ and\n   protection transport entities at the source endpoint of the protected\n\
    \   domain.  In the normal condition, for each direction, the sink\n   endpoint\
    \ receives traffic from the working transport entity.\n   If the sink endpoint\
    \ detects a failure on the working transport\n   entity, it will switch to receive\
    \ traffic from the protection\n   transport entity.  It will also send an APS\
    \ message to inform the\n   sink endpoint on the other direction to switch to\
    \ receive traffic\n   from the protection transport entity.\n   The APS mechanism\
    \ is necessary to coordinate the two endpoints of the\n   transport entity and\
    \ to implement 1+1 bidirectional protection\n   switching even for a unidirectional\
    \ failure.\n"
- title: 6.3.  1:1 Bidirectional Protection Switching
  contents:
  - "6.3.  1:1 Bidirectional Protection Switching\n     +-----------+            \
    \                           +-----------+\n     |           |---------------------------------------|\
    \           |\n     |          -+<--------------------------------------+-   \
    \       |\n     |         / +-------------------------------------->+ \\     \
    \    |\n     | sink   / /|---------------------------------------|\\ \\  source|\n\
    \   <-+-------/ / |        Working transport entity       | \\ <-------+--\n \
    \  --+-------->  |                                       |  ---------+->\n   \
    \  | source    |                                       |      sink |\n     | \
    \          |---------------------------------------|           |\n     |     \
    \      |                                       |           |\n     |         \
    \  |                                       |           |\n     | APS <...................................................>\
    \ APS |\n     |           |---------------------------------------|          \
    \ |\n     +-----------+      Protection transport entity      +-----------+\n\
    \                           (normal condition)\n     +-----------+           \
    \                            +-----------+\n     |           |---------------------------------------|\
    \           |\n     |           |                 \\/                    |   \
    \        |\n     |           |                 /\\                    |      \
    \     |\n     |           |---------------------------------------|          \
    \ |\n     | source    |   Working transport entity (failure)  |      sink |\n\
    \   --+------->   |                                       |   --------+->\n  \
    \ <-+------- \\  |                                       |  / <------+--\n   \
    \  | sink  \\ \\ |---------------------------------------| / / source|\n     |\
    \        \\ -+-------------------------------------->+- /        |\n     |   \
    \      --+<--------------------------------------+--         |\n     | APS <...................................................>\
    \ APS |\n     |           |---------------------------------------+          \
    \ |\n     +-----------+      Protection transport entity      +-----------+\n\
    \                           (failure condition)\n          Figure 3: 1:1 Bidirectional\
    \ Linear Protection Switching\n   In 1:1 bidirectional protection switching, for\
    \ each direction, the\n   source endpoint sends traffic on either the working\
    \ transport entity\n   or the protection transport entity.  The sink endpoint\
    \ receives the\n   traffic from the same transport entity on which the source\
    \ endpoint\n   sends the traffic.\n   In the normal condition, for each direction,\
    \ the source and sink\n   endpoints send and receive traffic from the working\
    \ transport entity.\n   If the sink endpoint detects a failure on the working\
    \ transport\n   entity, it will switch to send and receive traffic from the\n\
    \   protection transport entity.  It will also send an APS message to\n   inform\
    \ the sink endpoint on another direction to switch to send and\n   receive traffic\
    \ from the protection transport entity.\n   The APS mechanism is necessary to\
    \ coordinate the two endpoints of the\n   transport entity and implement 1:1 bidirectional\
    \ protection switching\n   even for a unidirectional failure.\n"
- title: 7.  APS Protocol
  contents:
  - "7.  APS Protocol\n   This APS protocol is based upon the APS protocol defined\
    \ in\n   Section 11 of [G.8031].  See that reference for further definition of\n\
    \   the Protocol Data Unit (PDU) fields and protocol details beyond the\n   description\
    \ in this document.\n"
- title: 7.1.  APS PDU Format
  contents:
  - "7.1.  APS PDU Format\n   APS packets MUST be sent over a Generic Associated Channel\
    \ (G-ACh) as\n   defined in [RFC5586].\n   The format of APS PDU is specified\
    \ in Figure 4 below.\n     0                   1                   2         \
    \          3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9\
    \ 0 1\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |0 0 0 1|0 0 0 0|0 0 0 0 0 0 0 0|     Channel Type (=0x7FFA)    |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    | MEL | Version |    OpCode     |     Flags     |   TLV Offset  |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |                  APS Specific Information                     |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \    |    End TLV    |\n    +-+-+-+-+-+-+-+-+\n                         Figure\
    \ 4: APS PDU Format\n   The following values MUST be used for APS PDU:\n   o \
    \ Channel Type: The Channel Type MUST be configurable by the\n      implementation.\
    \  During deployment, the local system administrator\n      provisioned the value\
    \ 0x7FFA.  This is a code point value in the\n      range of experimental Channel\
    \ Types as described in RFC 5586,\n      Section 10.\n   o  Maintenance Entity\
    \ group Level (MEL): The MEL value to set and\n      check MUST be configurable.\
    \  The DEFAULT value MUST be \"111\".\n      With co-routed bidirectional transport\
    \ paths, the configured MEL\n      MUST be the same in both directions.\n   o\
    \  Version: 0x00\n   o  OpCode: 0x27 (=0d39)\n   o  Flags: 0x00\n   o  TLV Offset:\
    \ 4\n   o  End TLV: 0x00\n   The format of the APS-specific information is defined\
    \ in Figure 5.\n     0                   1                   2               \
    \    3\n     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n\
    \    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n    |Request|Pr.Type|\
    \   Requested   |   Bridged     | |             |\n    |   /   |-+-+-+-|     \
    \          |               |T|  Reserved(0)|\n    | State |A|B|D|R|    Signal\
    \     |    Signal     | |             |\n    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\
    \                 Figure 5: APS-Specific Information Format\n   All bits defined\
    \ as \"Reserved\" MUST be transmitted as 0 and ignored\n   on reception.\n   o\
    \  Request/State:\n      The four bits indicate the protection-switching request\
    \ type.  See\n      Figure 6 for the code of each request/state type.\n      In\
    \ case that there are multiple protection-switching requests,\n      only the\
    \ protection-switching request with the highest priority\n      MUST be processed.\n\
    \          +------------------------------------+---------------+\n          |\
    \            Request/State           | Code/Priority |\n          +------------------------------------+---------------+\n\
    \          |Lockout of Protection (LO)          | 1111 (highest)|\n          +------------------------------------+---------------+\n\
    \          |Signal Fail on Protection (SF-P)    | 1110          |\n          +------------------------------------+---------------+\n\
    \          |Forced Switch (FS)                  | 1101          |\n          +------------------------------------+---------------+\n\
    \          |Signal Fail on Working (SF-W)       | 1011          |\n          +------------------------------------+---------------+\n\
    \          |Signal Degrade (SD)                 | 1001          |\n          +------------------------------------+---------------+\n\
    \          |Manual Switch (MS)                  | 0111          |\n          +------------------------------------+---------------+\n\
    \          |Wait to Restore (WTR)               | 0101          |\n          +------------------------------------+---------------+\n\
    \          |Exercise (EXER)                     | 0100          |\n          +------------------------------------+---------------+\n\
    \          |Reverse Request (RR)                | 0010          |\n          +------------------------------------+---------------+\n\
    \          |Do Not Revert (DNR)                 | 0001          |\n          +------------------------------------+---------------+\n\
    \          |No Request (NR)                     | 0000 (lowest) |\n          +------------------------------------+---------------+\n\
    \           Figure 6: Protection-Switching Request Code/Priority\n   o  Protection\
    \ Type (Pr.Type):\n      The four bits are used to specify the protection type.\n\
    \      A: reserved (set by default to 1)\n      B: 0 - 1+1 (permanent bridge)\n\
    \      1 - 1:1 (no permanent bridge)\n      D: 0 - Unidirectional switching\n\
    \      1 - Bidirectional switching\n      R: 0 - Non-revertive operation\n   \
    \   1 - Revertive operation\n   o  Requested Signal:\n      This byte is used\
    \ to indicate the traffic that the near-end\n      requests to be carried over\
    \ the protection entity.\n      value = 0: Null traffic\n      value = 1: Normal\
    \ traffic 1\n      value = 2~255: Reserved\n   o  Bridged Signal:\n      This\
    \ byte is used to indicate the traffic that is bridged onto the\n      protection\
    \ entity.\n      value = 0: Null traffic\n      value = 1: Normal traffic 1\n\
    \      value = 2~255: Reserved\n   o  Bridge Type (T):\n      This bit is used\
    \ to further specify the type of non-permanent\n      bridge for 1:1 protection\
    \ switching.\n      value = 0: Selector bridge\n      value = 1: Broadcast bridge\n\
    \   o  Reserved:\n      This field MUST be set to zero.\n"
- title: 7.2.  APS Transmission
  contents:
  - "7.2.  APS Transmission\n   The APS message MUST be transported on the protection\
    \ transport\n   entity by encapsulation with the protection transport entity label\n\
    \   (the label of the LSP used to transport protection traffic).  If an\n   endpoint\
    \ receives APS-specific information from the working transport\n   entity, it\
    \ MUST ignore this information and MUST report the failure\n   of protocol defect\
    \ (see Section 8.1) to the operator.\n   A new APS packet MUST be transmitted\
    \ immediately when a change in the\n   transmitted status occurs.  The first three\
    \ APS packets MUST be\n   transmitted as fast as possible only if the APS information\
    \ to be\n   transmitted has been changed so that fast protection switching is\n\
    \   possible, even if one or two APS packets are lost or corrupted.  The\n   interval\
    \ of the first three APS packets SHOULD be 3.3 ms.  APS\n   packets after the\
    \ first three MUST be transmitted with the interval\n   of 5 seconds.\n   If no\
    \ valid APS-specific information is received, the last valid\n   received information\
    \ remains applicable.\n"
- title: 7.3.  Hold-Off Timer
  contents:
  - "7.3.  Hold-Off Timer\n   In order to coordinate timing of protection switches\
    \ at multiple\n   layers, a hold-off timer MAY be required.  The purpose is to\
    \ allow a\n   server-layer protection switch to have a chance to fix the problem\n\
    \   before switching at a client layer.\n   Each selector SHOULD have a provisioned\
    \ hold-off timer.  The\n   suggested range of the hold-off timer is 0 to 10 seconds\
    \ in steps of\n   100 ms (accuracy of +/-5 ms).\n   When a new defect or more\
    \ severe defect occurs (new SF or SD) on the\n   active transport entity (the\
    \ transport entity that currently carries\n   and selects traffic), this event\
    \ will not be reported immediately to\n   protection switching if the provisioned\
    \ hold-off timer value is non-\n   zero.  Instead, the hold-off timer SHALL be\
    \ started.  When the hold-\n   off timer expires, it SHALL be checked whether\
    \ a defect still exists\n   on the transport entity that started the timer.  If\
    \ it does, that\n   defect SHALL be reported to protection switching.  The defect\
    \ need\n   not be the same one that started the timer.\n   This hold-off timer\
    \ mechanism SHALL be applied for both working and\n   protection transport entities.\n"
- title: 7.4.  WTR Timer
  contents:
  - "7.4.  WTR Timer\n   In revertive mode of operation, to prevent frequent operation\
    \ of the\n   protection switch due to an intermittent defect, a failed working\n\
    \   transport entity MUST become fault free.  After the failed working\n   transport\
    \ entity meets this criterion, a fixed period of time SHALL\n   elapse before\
    \ a normal traffic signal uses it again.  This period,\n   called a WTR period,\
    \ MAY be configured by the operator in 1 minute\n   steps between 5 and 12 minutes;\
    \ the default value is 5 minutes.  An\n   SF or SD condition will override the\
    \ WTR.  To activate the WTR timer\n   appropriately, even when both ends concurrently\
    \ detect clearance of\n   SF-W and SD-W, when the local state transits from SF-W\
    \ or SD-W to No\n   Request (NR) with the requested signal number 1, the previous\
    \ local\n   state, SF-W or SD-W, MUST be memorized.  If both the local state and\n\
    \   far-end state are NR with the requested signal number 1, the local\n   state\
    \ transits to WTR only when the previous local state is SF-W or\n   SD-W.  Otherwise,\
    \ the local state transits to NR with the requested\n   signal number 0.\n   In\
    \ revertive mode of operation, when the protection is no longer\n   requested,\
    \ i.e., the failed working transport entity is no longer in\n   SF or SD condition\
    \ (and assuming no other requesting transport\n   entities), a local WTR state\
    \ will be activated.  Since this state\n   becomes the highest in priority, it\
    \ is indicated on the APS signal\n   and maintains the normal traffic signal from\
    \ the previously failed\n   working transport entity on the protection transport\
    \ entity.  This\n   state SHALL normally time out and become an NR state.  The\
    \ WTR timer\n   deactivates earlier when any request of higher priority request\n\
    \   preempts this state.\n"
- title: 7.5.  Command Acceptance and Retention
  contents:
  - "7.5.  Command Acceptance and Retention\n   The commands Clear, LO, FS, MS, and\
    \ EXER are accepted or rejected in\n   the context of previous commands, the condition\
    \ of the working and\n   protection entities in the protection group, and (in\
    \ bidirectional\n   switching only) the APS information received.\n   The Clear\
    \ command MUST be only valid if a near-end LO, FS, MS, or\n   EXER command is\
    \ in effect or if a WTR state is present at the near\n   end and rejected otherwise.\
    \  This command will remove the near-end\n   command or WTR state, allowing the\
    \ next lower-priority condition or\n   (in bidirectional switching) APS request\
    \ to be asserted.\n   Other commands MUST be rejected unless they are higher priority\
    \ than\n   the previously existing command, condition, or (in bidirectional\n\
    \   switching) APS request.  If a new command is accepted, any previous,\n   lower-priority\
    \ command that is overridden MUST be forgotten.  If a\n   higher priority command\
    \ overrides a lower-priority condition or (in\n   bidirectional switching) APS\
    \ request, that other request will be\n   reasserted if it still exists at the\
    \ time the command is cleared.  If\n   a command is overridden by a condition\
    \ or (in bidirectional\n   switching) APS request, that command MUST be forgotten.\n"
- title: 7.6.  Exercise Operation
  contents:
  - "7.6.  Exercise Operation\n   Exercise is a command to test if the APS communication\
    \ is operating\n   correctly.  It is lower priority than any \"real\" switch request.\
    \  It\n   is only valid in bidirectional switching, since this is the only\n \
    \  place where you can get a meaningful test by looking for a response.\n   The\
    \ Exercise command SHALL issue the command with the same requested\n   and bridged\
    \ signal numbers of the NR, Reverse Request (RR), or DNR\n   request that it replaces.\
    \  The valid response will be an RR with the\n   corresponding requested and bridged\
    \ signal numbers.  When Exercise\n   commands are input at both ends, an EXER,\
    \ instead of RR, MUST be\n   transmitted from both ends.  The standard response\
    \ to DNR MUST be DNR\n   rather than NR.  When the exercise command is cleared,\
    \ it MUST be\n   replaced with NR or RR if the requested signal number is 0 and\
    \ DNR or\n   RR if the requested signal number is 1.\n"
- title: 8.  Protection-Switching Logic
  contents:
  - '8.  Protection-Switching Logic

    '
- title: 8.1.  Principle of Operation
  contents:
  - "8.1.  Principle of Operation\n                +-------------+ Persistent +----------+\n\
    \    SF,SD       | Hold-off    | fault      | Local    |\n    ----------->| timer\
    \ logic |----------->| request  |\n                +-------------+           \
    \ | logic    |\n    Other local requests ----------------->|          |\n    (LO,\
    \ FS, MS, EXER, Clear)              +----------+\n                           \
    \                    |\n                                               | Highest\n\
    \                                               | local request\n            \
    \                                   |\n    Remote APS                        \
    \         V\n    message       +-------+ Remote APS    +----------------+\n  \
    \  ------------->|  APS  | request/state |  APS process   |\n    (received   \
    \  | check |-------------->|  logic         |\n    from far end) +-------+   \
    \            +----------------+\n                    |   ^                   |\
    \            |\n                    |   |                   | Signaled   |\n \
    \                   |   |                   | APS        |\n                 \
    \   |   | Txed              |            |\n                    |   | \"Requested\
    \        V            |\n                    |   | Signal\"         +-----------+\
    \  |\n                    |   +-----------------| APS mess. |  |\n           \
    \         |                     | generator |  |\n                    |      \
    \               +-----------+  |\n                    |                      \
    \ |            |\n                    V                       |            |\n\
    \                Failure of                  V            |\n                protocol\
    \                  APS message    |\n                detection               \
    \                 V\n                                                    Set local\n\
    \                                                    bridge/selector\n       \
    \            Figure 7: Protection-Switching Logic\n   Figure 7 describes the protection-switching\
    \ logic.\n   One or more local protection-switching requests may be active.  The\n\
    \   \"local request logic\" determines which of these requests is highest\n  \
    \ using the order of priority given in Figure 6.  This highest local\n   request\
    \ information SHALL be passed on to the \"APS process logic\".\n   Note that an\
    \ accepted Clear command, clearance of SF or SD, or\n   expiration of the WTR\
    \ timer SHALL NOT be processed by the local\n   request logic but SHALL be considered\
    \ as the highest local request\n   and submitted to the APS process logic for\
    \ processing.\n   The remote APS message is received from the far end and is subjected\n\
    \   to the validity check and mismatch detection in \"APS check\".  Failure\n\
    \   of protocol situations are as follows:\n   o  The \"B\" field mismatch due\
    \ to incompatible provisioning;\n   o  The reception of the APS message from the\
    \ working entity due to\n      working/protection configuration mismatch;\n  \
    \ o  No match in sent \"Requested Signal\" and received \"Requested\n      Signal\"\
    \ for more than 50 ms;\n   o  No APS message is received on the protection transport\
    \ entity\n      during at least 3.5 times the long APS interval (e.g., at least\n\
    \      17.5 seconds), and there is no defect on the protection transport\n   \
    \   entity.\n   Provided the \"B\" field matches:\n   o  If the \"D\" bit mismatches,\
    \ the bidirectional side will fall back\n      to unidirectional switching.\n\
    \   o  If the \"R\" bit mismatches, one side will clear switches to WTR and\n\
    \      the other will clear to DNR.  The two sides will interwork and the\n  \
    \    traffic is protected.\n   o  If the \"T\" bit mismatches, the side using\
    \ a broadcast bridge will\n      fall back to using a selector bridge.\n   The\
    \ APS message with invalid information MUST be ignored, and the\n   last valid\
    \ received information remains applicable.\n   The linear protection-switching\
    \ algorithm SHALL commence immediately\n   every time one of the input signals\
    \ changes, i.e., when the status of\n   any local request changes, or when different\
    \ APS-specific information\n   is received from the far end.  The consequent actions\
    \ of the\n   algorithm are also initiated immediately, i.e., change the local\n\
    \   bridge/selector position (if necessary), transmit new APS-specific\n   information\
    \ (if necessary), or detect the failure of protocol defect\n   if the protection\
    \ switching is not completed within 50 ms.\n   The state transition is calculated\
    \ in the \"APS process logic\" based\n   on the highest local request, the request\
    \ of the last received\n   \"Request/State\" information, and state transition\
    \ tables defined in\n   Section 9, as follows:\n   o  If the highest local request\
    \ is Clear, clearance of SF or SD, or\n      expiration of WTR, a state transition\
    \ is calculated first based on\n      the highest local request and state machine\
    \ table for local\n      requests to obtain an intermediate state.  This intermediate\
    \ state\n      is the final state in case of clearance of SF-P; otherwise,\n \
    \     starting at this intermediate state, the last received far-end\n      request\
    \ and the state machine table for far-end requests are used\n      to calculate\
    \ the final state.\n   o  If the highest local request is neither Clear nor clearance\
    \ of SF\n      or of SD nor expiration of WTR, the APS process logic compares\
    \ the\n      highest local request with the request of the last received\n   \
    \   \"Request/State\" information based on Figure 6.\n      1.  If the highest\
    \ local request has higher or equal priority, it\n          is used with the state\
    \ transition table for local requests\n          defined in Section 9 to determine\
    \ the final state; otherwise,\n      2.  The request of the last received \"Request/State\"\
    \ information\n          is used with the state transition table for far-end requests\n\
    \          defined in Section 9 to determine the final state.\n   The \"APS message\
    \ generator\" generates APS-specific information with\n   the signaled APS information\
    \ for the final state from the state\n   transition calculation (with coding as\
    \ described in Figure 5).\n"
- title: 8.2.  Equal Priority Requests
  contents:
  - "8.2.  Equal Priority Requests\n   In general, once a switch has been completed\
    \ due to a request, it\n   will not be overridden by another request of the same\
    \ priority\n   (first-come, first-served policy).  Equal priority requests from\
    \ both\n   sides of a bidirectional protection group are both considered valid,\n\
    \   as follows:\n   o  If the local state is NR, with the requested signal number\
    \ 1, and\n      the far-end state is NR, with the requested signal number 0, the\n\
    \      local state transits to NR with the requested signal number 0.\n      This\
    \ applies to the case when the remote request for switching to\n      the protection\
    \ transport entity has been cleared.\n   o  If both the local and far-end states\
    \ are NR, with the requested\n      signal number 1, the local state transits\
    \ to the appropriate new\n      state (DNR state for non-revertive mode and WTR\
    \ state for\n      revertive mode).  This applies to the case when the old request\n\
    \      has been cleared at both ends.\n   o  If both the local and far-end states\
    \ are RR, with the same\n      requested signal number, both ends transit to the\
    \ appropriate new\n      state according to the requested signal number.  This\
    \ applies to\n      the case of concurrent deactivation of EXER from both ends.\n\
    \   o  In other cases, no state transition occurs, even if equal priority\n  \
    \    requests are activated from both ends.  Note that if MSs are\n      issued\
    \ simultaneously to both working and protection transport\n      entities, either\
    \ as local or far-end requests, the MS to the\n      working transport entity\
    \ is considered as having higher priority\n      than the MS to the protection\
    \ transport entity.\n"
- title: 8.3.  Signal Degrade of the Protection Transport Entity
  contents:
  - "8.3.  Signal Degrade of the Protection Transport Entity\n   Signal degrade on\
    \ the protection transport entity has the same\n   priority as signal degrade\
    \ on the working transport entity.  As a\n   result, if an SD condition affects\
    \ both transport entities, the first\n   SD detected MUST NOT be overridden by\
    \ the second SD detected.  If the\n   SD is detected simultaneously, either as\
    \ local or far-end requests on\n   both working and protection transport entities,\
    \ then the SD on the\n   standby transport entity MUST be considered as having\
    \ higher priority\n   than the SD on the active transport entity, and the normal\
    \ traffic\n   signal continues to be selected from the active transport entity\n\
    \   (i.e., no unnecessary protection switching is performed).\n   In the preceding\
    \ sentence, \"simultaneously\" relates to the occurrence\n   of SD on both the\
    \ active and standby transport entities at input to\n   the protection-switching\
    \ process at the same time, or as long as an\n   SD request has not been acknowledged\
    \ by the remote end in\n   bidirectional protection switching.\n"
- title: 9.  Protection-Switching State Transition Tables
  contents:
  - "9.  Protection-Switching State Transition Tables\n   In this section, state transition\
    \ tables for the following protection\n   switching configurations are described.\n\
    \   o  1:1 bidirectional (revertive mode, non-revertive mode);\n   o  1+1 bidirectional\
    \ (revertive mode, non-revertive mode);\n   o  1+1 unidirectional (revertive mode,\
    \ non-revertive mode).\n   Note that any other global or local request that is\
    \ not described in\n   state transition tables does not trigger any state transition.\n\
    \   The states specified in the state transition tables can be described\n   as\
    \ follows:\n   o  NR: NR is the state entered by the local priority under all\n\
    \      conditions where no local protection-switching requests (including\n  \
    \    WTR and DNR) are active.  NR can also indicate that the highest\n      local\
    \ request is overridden by the far-end request, whose priority\n      is higher\
    \ than the highest local request.  Normal traffic signal\n      is selected from\
    \ the corresponding transport entity.\n   o  LO, SF-P, SD-P: The access by the\
    \ normal traffic to the protection\n      transport entity is NOT allowed in this\
    \ state.  The normal traffic\n      is carried by the working transport entity,\
    \ regardless of the\n      fault/degrade condition possibly present (due to the\
    \ highest\n      priority of the switching triggers leading to this state).\n\
    \   o  FS, SF-W, SD-W, MS-W, MS-P: A switching trigger NOT resulting in\n    \
    \  the protection transport entity unavailability is present.  The\n      normal\
    \ traffic is selected either from the corresponding working\n      transport entity\
    \ or from the protection transport entity,\n      according to the behavior of\
    \ the specific switching trigger.\n   o  WTR: In revertive operation, after the\
    \ clearing of an SF-W or SD-\n      W, this maintains normal traffic as selected\
    \ from the protection\n      transport entity until the WTR timer expires or another\
    \ request\n      with higher priority, including the Clear command, is received.\n\
    \      This is used to prevent frequent operation of the selector in the\n   \
    \   case of intermittent failures.\n   o  DNR: In non-revertive operation, this\
    \ is used to maintain a normal\n      traffic to be selected from the protection\
    \ transport entity.\n   o  EXER: Exercise of the APS protocol.\n   o  RR: The\
    \ near end will enter and signal Reverse Request only in\n      response to an\
    \ EXER from the far end.\n   [State transition tables are shown at the end of\
    \ the PDF form of this\n   document.]\n"
- title: 10.  Security Considerations
  contents:
  - "10.  Security Considerations\n   MPLS-TP is a subset of MPLS and so builds upon\
    \ many of the aspects of\n   the security model of MPLS.  MPLS networks make the\
    \ assumption that\n   it is very hard to inject traffic into a network and equally\
    \ hard to\n   cause traffic to be directed outside the network.  The control-plane\n\
    \   protocols utilize hop-by-hop security and assume a \"chain-of-trust\"\n  \
    \ model such that end-to-end control-plane security is not used.  For\n   more\
    \ information on the generic aspects of MPLS security, see\n   [RFC5920].\n  \
    \ This document describes a protocol carried in the G-ACh [RFC5586] and\n   so\
    \ is dependent on the security of the G-ACh, itself.  The G-ACh is a\n   generalization\
    \ of the associated channel defined in [RFC4385].  Thus,\n   this document relies\
    \ heavily on the security mechanisms provided for\n   the associated channel and\
    \ described in those two documents.\n"
- title: 11.  Acknowledgements
  contents:
  - "11.  Acknowledgements\n   The authors would like to thank Hao Long, Vincenzo\
    \ Sestito, Italo\n   Busi, Igor Umansky, and Andy Malis for their input to and\
    \ review of\n   the current document.\n"
- title: 12.  References
  contents:
  - '12.  References

    '
- title: 12.1.  Normative References
  contents:
  - "12.1.  Normative References\n   [RFC2119]  Bradner, S., \"Key words for use in\
    \ RFCs to Indicate\n              Requirement Levels\", BCP 14, RFC 2119, March\
    \ 1997.\n   [RFC4385]  Bryant, S., Swallow, G., Martini, L., and D. McPherson,\n\
    \              \"Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for\n \
    \             Use over an MPLS PSN\", RFC 4385, February 2006.\n   [RFC5586] \
    \ Bocci, M., Vigoureux, M., and S. Bryant, \"MPLS Generic\n              Associated\
    \ Channel\", RFC 5586, June 2009.\n   [RFC5920]  Fang, L., \"Security Framework\
    \ for MPLS and GMPLS\n              Networks\", RFC 5920, July 2010.\n   [G.841]\
    \    International Telecommunications Union, \"Types and\n              characteristics\
    \ of SDH network protection architectures\",\n              ITU-T Recommendation\
    \ G.841, October 1998.\n   [G.873.1]  International Telecommunications Union,\
    \ \"Optical Transport\n              Network (OTN): Linear protection\", ITU-T\
    \ Recommendation\n              G.873.1, May 2014.\n   [G.8031]   International\
    \ Telecommunications Union, \"Ethernet linear\n              protection switching\"\
    , ITU-T Recommendation G.8031/Y.1342,\n              June 2011.\n   [T1.105.01]\n\
    \              American National Standards Institute, \"Synchronous\n        \
    \      Optical Network (SONET) - Automatic Protection Switching\",\n         \
    \     ANSI 0900105.01:2000 (R2010), March 2000.\n"
- title: 12.2.  Informative References
  contents:
  - "12.2.  Informative References\n   [RFC6378]  Weingarten, Y., Bryant, S., Osborne,\
    \ E., Sprecher, N., and\n              A. Fulignoli, \"MPLS Transport Profile\
    \ (MPLS-TP) Linear\n              Protection\", RFC 6378, October 2011.\n   [RFC7271]\
    \  Ryoo, J., Gray, E., van Helvoort, H., D'Alessandro, A.,\n              Cheung,\
    \ T., and E. Osborne, \"MPLS Transport Profile (MPLS-\n              TP) Linear\
    \ Protection to Match the Operational\n              Expectations of Synchronous\
    \ Digital Hierarchy, Optical\n              Transport Network, and Ethernet Transport\
    \ Network\n              Operators\", RFC 7271, June 2014.\n   [RFC7324]  Osborne,\
    \ E., \"Updates to MPLS Transport Profile Linear\n              Protection\",\
    \ RFC 7324, July 2014.\n"
- title: Appendix A.  Operation Examples of the APS Protocol
  contents:
  - "Appendix A.  Operation Examples of the APS Protocol\n   The sequence diagrams\
    \ shown in this section are only a few examples\n   of the APS operations.  The\
    \ first APS message, which differs from the\n   previous APS message, is shown.\
    \  The operation of hold-off timer is\n   omitted.  The fields whose values are\
    \ changed during APS packet\n   exchange are shown in the APS packet exchange.\
    \  They are Request/\n   State, requested traffic, and bridged traffic.  For an\
    \ example,\n   SF(0,1) represents an APS packet with the following field values:\n\
    \   Request/State = SF, Requested Signal = 0, and Bridged Signal = 1.\n   The\
    \ values of the other fields remain unchanged from the initial\n   configuration.\
    \  The signal numbers 0 and 1 refer to null signal and\n   normal traffic signal,\
    \ respectively.  W(A->Z) and P(A->Z) indicate\n   the working and protection paths\
    \ in the direction of A to Z,\n   respectively.\n   Example 1. 1:1 bidirectional\
    \ protection switching (revertive mode) -\n   Unidirectional SF case\n       \
    \                A                  Z\n                       |              \
    \    |\n                   (1) |---- NR(0,0)----->|\n                       |<-----\
    \ NR(0,0)----|\n                       |                  |\n                \
    \       |                  |\n                   (2) | (SF on W(Z->A))  |\n  \
    \                     |---- SF(1,1)----->| (3)\n                       |<-----\
    \ NR(1,1)----|\n                   (4) |                  |\n                \
    \       |                  |\n                   (5) | (Recovery)       |\n  \
    \                     |---- WTR(1,1)---->|\n                      /|         \
    \         |\n             WTR timer |                  |\n                   \
    \   \\|                  |\n                   (6) |---- NR(0,0)----->| (7)\n\
    \                   (8) |<----- NR(0,0)----|\n                       |       \
    \           |\n   (1)  The protected domain is operating without any defect, and\
    \ the\n        working entity is used for delivering the normal traffic.\n   (2)\
    \  Signal Fail occurs on the working entity in the Z to A\n        direction.\
    \  Selector and bridge of node A select protection\n        entity.  Node A generates\
    \ an SF(1,1) message.\n   (3)  Upon receiving SF(1,1), node Z sets selector and\
    \ bridge to\n        protection entity.  As there is no local request in node\
    \ Z, node\n        Z generates an NR(1,1) message.\n   (4)  Node A confirms that\
    \ the far end is also selecting protection\n        entity.\n   (5)  Node A detects\
    \ clearing of the SF condition, starts the WTR\n        timer, and sends a WTR(1,1)\
    \ message.\n   (6)  At expiration of the WTR timer, node A sets selector and bridge\n\
    \        to working entity and sends an NR(0,0) message.\n   (7)  Node Z is notified\
    \ that the far-end request has been cleared and\n        sets selector and bridge\
    \ to working entity.\n   (8)  It is confirmed that the far end is also selecting\
    \ working\n        entity.\n   Example 2. 1:1 bidirectional protection switching\
    \ (revertive mode) -\n   Bidirectional SF case\n                       A     \
    \             Z\n                       |                  |\n               \
    \    (1) |---- NR(0,0)----->| (1)\n                       |<----- NR(0,0)----|\n\
    \                       |                  |\n                       |       \
    \           |\n                   (2) | (SF on W(Z<->A)) | (2)\n             \
    \          |<---- SF(1,1)---->|\n                   (3) |                  | (3)\n\
    \                       |                  |\n                   (4) |    (Recovery)\
    \    | (4)\n                       |<---- NR(1,1)---->|\n                   (5)\
    \ |<--- WTR(1,1)---->| (5)\n                      /|                  |\\\n  \
    \           WTR timer |                  | WTR timer\n                      \\\
    |                  |/\n                   (6) |<---- NR(1,1)---->| (6)\n     \
    \              (7) |<----- NR(0,0)--->| (7)\n                   (8) |        \
    \          | (8)\n   (1)  The protected domain is operating without any defect,\
    \ and the\n        working entity is used for delivering the normal traffic.\n\
    \   (2)  Nodes A and Z detect local SF conditions on the working entity,\n   \
    \     set selector and bridge to protection entity, and generate\n        SF(1,1)\
    \ messages.\n   (3)  Upon receiving SF(1,1), each node confirms that the far end\
    \ is\n        also selecting protection entity.\n   (4)  Each node detects clearing\
    \ of the SF condition and sends an\n        NR(1,1) message as the last received\
    \ APS message was SF.\n   (5)  Upon receiving NR(1,1), each node starts the WTR\
    \ timer and sends\n        WTR(1,1).\n   (6)  At expiration of the WTR timer,\
    \ each node sends NR(1,1) as the\n        last received APS message was WTR.\n\
    \   (7)  Upon receiving NR(1,1), each node sets selector and bridge to\n     \
    \   working entity and sends an NR(0,0) message.\n   (8)  It is confirmed that\
    \ the far end is also selecting working\n        entity.\n   Example 3. 1:1 bidirectional\
    \ protection switching (revertive mode) -\n   Bidirectional SF case - Inconsistent\
    \ WTR timers\n                       A                  Z\n                  \
    \     |                  |\n                   (1) |---- NR(0,0)----->| (1)\n\
    \                       |<----- NR(0,0)----|\n                       |       \
    \           |\n                       |                  |\n                 \
    \  (2) | (SF on W(Z<->A)) | (2)\n                       |<---- SF(1,1)---->|\n\
    \                   (3) |                  | (3)\n                       |   \
    \               |\n                   (4) |    (Recovery)    | (4)\n         \
    \              |<---- NR(1,1)---->|\n                   (5) |<--- WTR(1,1)---->|\
    \ (5)\n                      /|                  |\\\n             WTR timer |\
    \                  | |\n                      \\|                  | WTR timer\n\
    \                   (6) |----- NR(1,1)---->| | (7)\n                       | \
    \                 |/\n                   (9) |<----- NR(0,0)----| (8)\n      \
    \                 |---- NR(0,0)----->| (10)\n   (1)   The protected domain is\
    \ operating without any defect, and the\n         working entity is used for delivering\
    \ the normal traffic.\n   (2)   Nodes A and Z detect local SF conditions on the\
    \ working entity,\n         set selector and bridge to protection entity, and\
    \ generate\n         SF(1,1) messages.\n   (3)   Upon receiving SF(1,1), each\
    \ node confirms that the far end is\n         also selecting protection entity.\n\
    \   (4)   Each node detects clearing of the SF condition and sends an\n      \
    \   NR(1,1) message as the last received APS message was SF.\n   (5)   Upon receiving\
    \ NR(1,1), each node starts the WTR timer and\n         sends WTR(1,1).\n   (6)\
    \   At expiration of the WTR timer in node A, node A sends an\n         NR(1,1)\
    \ message as the last received APS message was WTR.\n   (7)   At node Z, the received\
    \ NR(1,1) is ignored as the local WTR has\n         a higher priority.\n   (8)\
    \   At expiration of the WTR timer in node Z, node Z sets selector\n         and\
    \ bridge to working entity and sends an NR(0,0) message.\n   (9)   Upon receiving\
    \ NR(0,0), node A sets selector and bridge to\n         working entity and sends\
    \ an NR(0,0) message.\n   (10)  It is confirmed that the far end is also selecting\
    \ working\n         entity.\n   Example 4. 1:1 bidirectional protection switching\
    \ (non-revertive\n   mode) - Unidirectional SF on working followed by unidirectional\
    \ SF on\n   protection\n                       A                  Z\n        \
    \               |                  |\n                   (1) |---- NR(0,0)----->|\
    \ (1)\n                       |<----- NR(0,0)----|\n                       | \
    \                 |\n                       |                  |\n           \
    \        (2) | (SF on W(Z->A))  |\n                       |----- SF(1,1)---->|\
    \ (3)\n                   (4) |<----- NR(1,1)----|\n                       | \
    \                 |\n                       |                  |\n           \
    \        (5) |    (Recovery)    |\n                       |----- DNR(1,1)--->|\
    \ (6)\n                       |<--- DNR(1,1)---->|\n                       | \
    \                 |\n                       |                  |\n           \
    \            | (SF on P(A->Z))  | (7)\n                   (8) |<--- SF-P(0,0)----|\n\
    \                       |---- NR(0,0)----->|\n                       |       \
    \           |\n                       |                  |\n                 \
    \      |     (Recovery)   | (9)\n                       |<----- NR(0,0)----|\n\
    \                       |                  |\n   (1)  The protected domain is\
    \ operating without any defect, and the\n        working entity is used for delivering\
    \ the normal traffic.\n   (2)  Signal Fail occurs on the working entity in the\
    \ Z to A\n        direction.  Selector and bridge of node A select the protection\n\
    \        entity.  Node A generates an SF(1,1) message.\n   (3)  Upon receiving\
    \ SF(1,1), node Z sets selector and bridge to\n        protection entity.  As\
    \ there is no local request in node Z, node\n        Z generates an NR(1,1) message.\n\
    \   (4)  Node A confirms that the far end is also selecting protection\n     \
    \   entity.\n   (5)  Node A detects clearing of the SF condition and sends a DNR(1,1)\n\
    \        message.\n   (6)  Upon receiving DNR(1,1), node Z also generates a DNR(1,1)\n\
    \        message.\n   (7)  Signal Fail occurs on the protection entity in the\
    \ A to Z\n        direction.  Selector and bridge of node Z select the working\n\
    \        entity.  Node Z generates an SF-P(0,0) message.\n   (8)  Upon receiving\
    \ SF-P(0,0), node A sets selector and bridge to\n        working entity and generates\
    \ an NR(0,0) message.\n   (9)  Node Z detects clearing of the SF condition and\
    \ sends an NR(0,0)\n        message.\n   Exmaple 5. 1:1 bidirectional protection\
    \ switching (non-revertive\n   mode) - Bidirectional SF on working followed by\
    \ bidirectional SF on\n   protection\n                       A               \
    \   Z\n                       |                  |\n                   (1) |----\
    \ NR(0,0)----->| (1)\n                       |<----- NR(0,0)----|\n          \
    \             |                  |\n                       |                 \
    \ |\n                   (2) | (SF on W(A<->Z)) | (2)\n                   (3) |<----\
    \ SF(1,1)---->| (3)\n                       |                  |\n           \
    \            |                  |\n                   (4) |    (Recovery)    |\
    \ (4)\n                   (5) |<---- NR(1,1)---->| (5)\n                     \
    \  |<--- DNR(1,1)---->|\n                       |                  |\n       \
    \                |                  |\n                   (6) | (SF on P(A<->Z))\
    \ | (6)\n                   (7) |<--- SF-P(0,0)--->| (7)\n                   \
    \    |                  |\n                       |                  |\n     \
    \              (8) |     (Recovery)   | (8)\n                       |<---- NR(0,0)---->|\n\
    \                       |                  |\n   (1)  The protected domain is\
    \ operating without any defect, and the\n        working entity is used for delivering\
    \ the normal traffic.\n   (2)  Nodes A and Z detect local SF conditions on the\
    \ working entity,\n        set selector and bridge to protection entity, and generate\n\
    \        SF(1,1) messages.\n   (3)  Upon receiving SF(1,1), each node confirms\
    \ that the far end is\n        also selecting protection entity.\n   (4)  Each\
    \ node detects clearing of the SF condition and sends an\n        NR(1,1) message\
    \ as the last received APS message was SF.\n   (5)  Upon receiving NR(1,1), each\
    \ node sends DNR(1,1).\n   (6)  Signal Fail occurs on the protection entity in\
    \ both directions.\n        Selector and bridge of each node selects the working\
    \ entity.\n        Each node generates an SF-P(0,0) message.\n   (7)  Upon receiving\
    \ SF-P(0,0), each node confirms that the far end is\n        also selecting working\
    \ entity.\n   (8)  Each node detects clearing of the SF condition and sends an\n\
    \        NR(0,0) message.\n"
- title: Authors' Addresses
  contents:
  - "Authors' Addresses\n   Huub van Helvoort (editor)\n   Huawei Technologies\n \
    \  EMail: huub@van-helvoort.eu\n   Jeong-dong Ryoo (editor)\n   ETRI\n   EMail:\
    \ ryoo@etri.re.kr\n   Haiyan Zhang\n   Huawei Technologies\n   EMail: zhanghaiyan@huawei.com\n\
    \   Feng Huang\n   Philips\n   EMail: feng.huang@philips.com\n   Han Li\n   China\
    \ Mobile\n   EMail: lihan@chinamobile.com\n   Alessandro D'Alessandro\n   Telecom\
    \ Italia\n   EMail: alessandro.dalessandro@telecomitalia.it\n"
